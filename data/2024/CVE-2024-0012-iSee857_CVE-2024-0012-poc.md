# CVE-2024-0012

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0012-0xjessie21_CVE-2024-0012.md](../2024/CVE-2024-0012-0xjessie21_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，未经身份验证的攻击者可以获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 11.2受影响版本

**利用条件:** 需要网络可以访问PAN-OS管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果具有对管理 Web 界面的网络访问权限，则可以获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他经过身份验证的权限提升漏洞。根据搜索结果和漏洞描述，该漏洞的风险在于允许未经授权的访问和控制。漏洞利用代码通过构造特定的HTTP请求绕过身份验证，然后在目标系统上执行任意命令。由于攻击者可以执行任意命令，因此存在植入后门的风险。 

**漏洞利用方式：**

1.  **利用createRemoteAppwebSession.php 创建初始会话:** 通过构造包含命令注入Payload的POST请求发送到`/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`，其中`X-PAN-AUTHCHECK` header设置为 `off`，并在`user`字段中注入恶意命令。该请求会将命令执行的结果写入`/var/appweb/htdocs/unauth/watchTowr.php`。
2.  **触发命令执行:**  利用index.php页面来触发执行`/var/appweb/htdocs/unauth/watchTowr.php`中的命令。

**投毒风险分析:**
代码本身是漏洞利用的PoC，实现了利用漏洞执行命令的功能。
*   PoC 中有向`/var/appweb/htdocs/unauth/`写入php文件的操作，如果服务器本身存在文件写入的权限问题，可能导致扩大攻击面。
*   PoC允许执行任意命令，如果攻击者在`--command`或者`--reverse-shell`中构造恶意的指令，可能会对目标造成更大的危害。
因此，存在一定的投毒风险，评估为10%。

**项目地址:** [0xjessie21/CVE-2024-0012](https://github.com/0xjessie21/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #2

**来源**: [CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md](../2024/CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** 高危，允许未授权的攻击者获取管理员权限，执行任意命令，篡改配置。

**影响版本:** 10.2, 11.0, 11.1, and 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 需要网络访问到 PAN-OS 管理 Web 界面，且管理界面可以从互联网或不受信任的网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能够访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或利用其他经过身份验证的提权漏洞，例如 CVE-2024-9474。

**漏洞利用方式：**

1.  **会话创建：**  攻击者首先发送一个特制的 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map` 路径，其中包含一个命令注入payload，这个payload的作用是向`/var/appweb/htdocs/unauth/watchTowr.php`写入系统信息。此请求设置 `X-PAN-AUTHCHECK: off` 头部，绕过身份验证检查。如果成功，服务器会返回一个 PHPSESSID cookie。
2.  **命令执行触发：**  攻击者使用获得的 PHPSESSID cookie 发送一个 GET 请求到 `/index.php/.js.map` 路径，同样设置 `X-PAN-AUTHCHECK: off` 头部。这个请求会触发之前注入的命令的执行。
3.  **执行验证：**  攻击者通过访问 `/unauth/watchTowr.php` 路径来验证命令是否成功执行。如果该文件存在且包含预期的系统信息，则表明漏洞利用成功。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的利用是有效的。漏洞库中明确指出存在针对该漏洞的威胁活动。POC 代码的实现方式与 WatchTowr Labs 的分析报告相符，进一步证实了其有效性。CISA 将该漏洞添加到了已知被利用的漏洞目录中，表明该漏洞正在被积极利用。

**投毒风险评估：**

该 POC 代码本身旨在利用漏洞，将 `uname -a` 命令的输出写入一个 Web 可访问的文件。虽然此操作本身具有一定的风险，因为它允许未经身份验证的访问者查看系统信息，但该 POC 代码的主要目的是验证漏洞的存在。代码本身较为简短，主要功能集中在利用漏洞上，不包含明显的恶意代码或者后门。投毒风险较低，估计为 1%。如果使用者不仔细审查，直接使用，可能会暴露一些系统信息，但不会直接导致系统被完全控制，因此投毒风险较低。

**缓解措施：**

*   限制管理 Web 界面的访问，仅允许来自受信任的内部 IP 地址的访问。
*   升级到已修复漏洞的 PAN-OS 版本 (10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本)。
*   部署威胁防御签名（如果可用）以检测和阻止针对此漏洞的攻击（Threat IDs 95746, 95747, 95752, 95753, 95759, 和 95763）。

**项目地址:** [Sachinart/CVE-2024-0012-POC](https://github.com/Sachinart/CVE-2024-0012-POC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #3

**来源**: [CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md](../2024/CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md)

## CVE-2024-0012 & CVE-2024-9474 Palo Alto PAN-OS 身份验证绕过和命令执行

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过 + 命令执行

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (参考漏洞库信息)

**利用条件:** 需要网络访问 PAN-OS 管理 Web 界面，且管理界面暴露在不受信任的网络中（例如互联网）。 根据漏洞库信息，仅允许受信任的内部IP地址访问管理界面可大大降低风险。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞利用结合了 CVE-2024-0012（身份验证绕过）和 CVE-2024-9474（命令执行和权限提升）。

**利用方式：**

1.  **身份验证绕过 (CVE-2024-0012)：** 攻击者无需身份验证即可访问 PAN-OS 管理 Web 界面。
2.  **获取 PHPSESSID：**  攻击者通过发送特制的 POST 请求到 `createRemoteAppwebSession.php` 获取有效的 `PHPSESSID`。
3.  **命令注入 (CVE-2024-9474)：** 攻击者使用获得的 `PHPSESSID`，通过在 `user` 参数中注入 shell 命令，利用 `createRemoteAppwebSession.php` 执行任意命令。
4.  **反弹 Shell：** 攻击者构造一个反弹 shell 的 payload，该 payload 经过两次 Base64 编码。
5.  **分块上传：** 因为命令长度限制，payload 被分割成多个小块，然后通过多个 POST 请求上传到目标服务器，存储为临时文件。
6.  **组合 Payload：** 上传完成后，攻击者使用 shell 命令将这些小块文件组合成一个完整的文件 `enc.txt`。
7.  **双重解码：** 攻击者对 `enc.txt` 中的内容进行双重 Base64 解码，并将结果保存到 `shell.sh` 文件中。
8.  **执行 Shell：** 攻击者赋予 `shell.sh` 可执行权限并执行它，从而建立反弹 shell 连接到攻击者的监听器。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用。提供的 PoC 代码实现了漏洞利用的完整流程，包括身份验证绕过、命令注入和反弹 shell。因此，该PoC代码被认为是有效的。

**投毒风险：**

虽然PoC的主要功能是利用漏洞，但仍存在一定的投毒风险。

*   **临时文件残留：**  该PoC在目标系统上创建临时文件（`c_*.tmp`, `enc.txt`, `shell.sh`），如果利用失败或被中断，这些文件可能会残留，占用磁盘空间或泄露信息。
*   **命令执行风险：**  即使没有成功建立反弹 shell，PoC执行的中间命令可能对系统造成意外影响。
*   **依赖性问题：** 该PoC 依赖于目标系统上存在 `bash`，`base64`，`cat`，`echo`，`tr`，`chmod` 命令。 如果目标系统缺少这些命令,会导致POC 利用失败.

**投毒风险评估：**

该PoC的主要目的是进行漏洞利用，而非进行恶意破坏。 但也存在一定的风险。 投毒风险大概为10%。

**项目地址:** [TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC](https://github.com/TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #4

**来源**: [CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md](../2024/CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备的管理 Web 界面需要能通过网络访问。如果管理界面仅允许受信任的内部 IP 地址访问，风险将大大降低。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他已通过身份验证的权限提升漏洞（如 CVE-2024-9474）。

**漏洞利用方式：**

1.  攻击者发送特制的 HTTP 请求到目标 PAN-OS 设备的管理 Web 界面。
2.  该请求利用身份验证绕过漏洞，使攻击者无需有效凭据即可获得管理员权限。
3.  获得管理员权限后，攻击者可以执行任意命令，读取敏感信息，修改设备配置，甚至可能通过其他漏洞进一步入侵系统。

根据提供的漏洞利用代码 `exploit.py`，该 PoC 包含两种模式：扫描模式和利用模式。

*   **扫描模式：** 用于批量扫描目标 URL，检测是否存在 CVE-2024-0012 漏洞。它向 `/php/ztp_gate.php/.js.map` 发送 GET 请求，如果状态码为 200 且响应中包含 "Zero Touch Provisioning"，则判定存在漏洞。
*   **利用模式：** 允许攻击者在目标系统上执行任意命令。它通过向 `/php/utils/createRemoteAppwebSession.php/peppa.js.map` 发送 POST 请求，并在 `user` 参数中注入命令。然后，它尝试提取 `PHPSESSID`，并利用此会话 ID 访问受保护的页面。命令输出会被写入`/var/appweb/htdocs/unauth/{output_name}`，然后通过 GET 请求 `/unauth/{output_name}` 检索。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用，并且存在公开可用的 PoC，所以该 POC 代码具有有效性。

**投毒风险：**

该PoC代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **命令注入：** 利用模式允许执行任意命令，这意味着如果攻击者使用该 PoC 对目标系统进行攻击，他们可以安装后门、植入恶意软件，或进行其他恶意活动。
*   **未经验证的 PoC：** README.md 文件明确指出 “Untested POC”，这意味着代码可能存在未知的错误或缺陷，可能导致目标系统不稳定或崩溃。
*   **随机文件名：**PoC代码使用随机文件名存储命令输出，虽然在一定程度上防止了文件名冲突，但也可能被攻击者滥用，例如，通过生成大量随机文件来耗尽磁盘空间。

综合考虑，该 PoC 存在一定的投毒风险，大约占比 10%。用户应谨慎使用，并充分了解其潜在风险。

**修复建议：**

*   升级到 PAN-OS 10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本。
*   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
*   如果启用了威胁防御订阅，请启用并配置相关的威胁 ID (95746, 95747, 95752, 95753, 95759, 和 95763) 以阻止利用此漏洞的攻击。

**项目地址:** [VegetableLasagne/CVE-2024-0012](https://github.com/VegetableLasagne/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #5

**来源**: [CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md](../2024/CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (详见漏洞库信息)

**利用条件:** 目标PAN-OS管理Web界面可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果可以访问管理 Web 界面，便能够获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他需要身份验证的提权漏洞，例如 CVE-2024-9474。\n\n**有效性：**\n根据搜索结果和漏洞库信息，该漏洞已经被积极利用。漏洞库信息中的 "exploits" 字段显示 Palo Alto Networks 观察到利用此漏洞的威胁活动。多个搜索结果（例如，Arctic Wolf 的博客文章）也证实了该漏洞正在被利用。因此，利用代码的有效性很高。\n\n**投毒风险：**\n提供的漏洞利用代码仅为 Apache License 2.0 许可协议的文本。它本身不是可执行代码，因此不存在投毒风险。投毒风险为0%。\n\n**利用方式：**\n1.  **访问管理Web界面：** 攻击者需要能够通过网络访问目标 PAN-OS 设备的管理 Web 界面。\n2.  **身份验证绕过：** 利用漏洞绕过身份验证机制。根据漏洞信息，可能涉及发送特制的 HTTP 请求或利用身份验证过程中的缺陷。具体绕过方法需要根据完整的PoC来分析，这里仅有license文件，无法推断。\n3.  **获取管理员权限：** 成功绕过身份验证后，攻击者将获得 PAN-OS 管理员权限。\n4.  **执行恶意操作：** 获得管理员权限后，攻击者可以执行各种恶意操作，包括：\n    *   执行任意命令。\n    *   篡改防火墙配置。\n    *   利用其他漏洞进一步攻击。\n\n**缓解措施：**\n*   限制管理界面访问：根据 Palo Alto Networks 的最佳实践指南，仅允许受信任的内部 IP 地址访问管理 Web 界面。\n*   应用威胁防御：如果拥有威胁防御订阅，可以使用威胁 ID 95746、95747、95752、95753、95759 和 95763 阻止攻击。\n*   及时更新：升级到已修复此漏洞的 PAN-OS 版本 (10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本)。

**项目地址:** [XiaomingX/cve-2024-0012-poc](https://github.com/XiaomingX/cve-2024-0012-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #6

**来源**: [CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md](../2024/CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用（如CVE-2024-9474）

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 (受影响版本低于已修复版本)

**利用条件:** 需要网络访问目标PAN-OS设备的管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012是Palo Alto Networks PAN-OS软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理Web界面，可以获取PAN-OS管理员权限，执行管理操作，篡改配置或利用其他身份验证的权限提升漏洞。根据漏洞描述和搜索结果，该漏洞影响特定版本的PAN-OS，且存在在野利用。提供的POC代码（`cve-2024-0012-gui.py`）利用了此漏洞。利用方式如下：

1.  **创建初始会话：**  通过`createRemoteAppwebSession.php`端点，设置`X-PAN-AUTHCHECK`为`off`，并且在POST数据中，将`user`参数设置为包含命令注入的恶意代码。攻击者可以通过这个方式在目标机器上写入一个PHP文件，例如`cve.php`。命令通过反引号执行，将结果写入PHP文件。
2.  **触发执行：**  使用创建的`PHPSESSID` cookie，访问`/index.php/.js.map`端点，触发之前注入的命令执行。
3.  **验证执行：**  访问`/unauth/cve.php`，检查命令是否成功执行，并获取命令输出。

**投毒风险分析：**

查看`cve-2024-0012-gui.py`脚本，发现其主要功能是利用漏洞进行命令注入和验证，基本符合漏洞利用的逻辑。`self.command_input = QLineEdit()` 允许用户输入命令，增加了灵活性，但也引入了一定的风险，使用者可能使用恶意命令。但是从代码逻辑上，此仓库直接投毒的可能性较低。`README.md`文件仅包含漏洞描述和作者信息，无恶意代码。

总而言之，考虑到代码的开源性质，以及主要功能符合漏洞利用的预期，投毒的概率较低，但是命令的执行权交给了用户，如果用户使用了恶意命令，也可能造成危害。因此投毒风险评估为10%。

**项目地址:** [dcollaoa/cve-2024-0012-gui-poc](https://github.com/dcollaoa/cve-2024-0012-gui-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #7

**来源**: [CVE-2024-0012-greaselovely_CVE-2024-0012.md](../2024/CVE-2024-0012-greaselovely_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** Critical, allows unauthenticated remote attackers to gain administrator privileges.

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 software before the fixed versions.

**利用条件:** The management web interface must be accessible over the network, especially from the internet.

**POC 可用性:** Yes

**投毒风险:** 10%

## 详情

CVE-2024-0012 is an authentication bypass vulnerability in Palo Alto Networks PAN-OS. An unauthenticated attacker with network access to the management web interface can gain PAN-OS administrator privileges. 

**有效性：**
根据漏洞库信息、搜索引擎结果（尤其是来自Palo Alto Networks自身以及Arctic Wolf等安全公司的报告）以及提供的PoC代码，此漏洞是真实且已被利用的。PoC代码通过检查特定URL的响应状态码、Header以及页面内容是否包含`Zero Touch Provisioning`和`window.Pan`等特征字符串来判断目标是否存在漏洞，表明PoC的有效性。

**投毒风险：**
PoC代码主要用于检测漏洞是否存在，其本身功能相对简单，未发现明显的恶意代码。代码中使用的`requests`库可能存在潜在风险，如果被替换为恶意版本，可能导致信息泄露或代码执行。LICENSE文件采用MIT开源协议，允许修改和再分发，这也会增加潜在的投毒风险。考虑到requests库的潜在风险和开源协议的开放性，投毒风险评定为10%。

**利用方式：**
1.  **网络访问:** 攻击者需要能够通过网络访问目标Palo Alto Networks设备的管理Web界面。
2.  **漏洞触发:** 攻击者发送特制的HTTP请求到目标设备的管理Web界面，绕过身份验证。
3.  **权限提升:** 成功绕过身份验证后，攻击者获得PAN-OS管理员权限，可以执行任意管理操作，篡改配置或利用其他漏洞。
4. **后续利用:** 可能会结合 CVE-2024-9474 进一步利用， 执行任意命令。

**项目地址:** [greaselovely/CVE-2024-0012](https://github.com/greaselovely/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #8

**来源**: [CVE-2024-0012-iSee857_CVE-2024-0012-poc.md](../2024/CVE-2024-0012-iSee857_CVE-2024-0012-poc.md)

# CVE-2024-0012

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0012-0xjessie21_CVE-2024-0012.md](../2024/CVE-2024-0012-0xjessie21_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，未经身份验证的攻击者可以获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 11.2受影响版本

**利用条件:** 需要网络可以访问PAN-OS管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果具有对管理 Web 界面的网络访问权限，则可以获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他经过身份验证的权限提升漏洞。根据搜索结果和漏洞描述，该漏洞的风险在于允许未经授权的访问和控制。漏洞利用代码通过构造特定的HTTP请求绕过身份验证，然后在目标系统上执行任意命令。由于攻击者可以执行任意命令，因此存在植入后门的风险。 

**漏洞利用方式：**

1.  **利用createRemoteAppwebSession.php 创建初始会话:** 通过构造包含命令注入Payload的POST请求发送到`/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`，其中`X-PAN-AUTHCHECK` header设置为 `off`，并在`user`字段中注入恶意命令。该请求会将命令执行的结果写入`/var/appweb/htdocs/unauth/watchTowr.php`。
2.  **触发命令执行:**  利用index.php页面来触发执行`/var/appweb/htdocs/unauth/watchTowr.php`中的命令。

**投毒风险分析:**
代码本身是漏洞利用的PoC，实现了利用漏洞执行命令的功能。
*   PoC 中有向`/var/appweb/htdocs/unauth/`写入php文件的操作，如果服务器本身存在文件写入的权限问题，可能导致扩大攻击面。
*   PoC允许执行任意命令，如果攻击者在`--command`或者`--reverse-shell`中构造恶意的指令，可能会对目标造成更大的危害。
因此，存在一定的投毒风险，评估为10%。

**项目地址:** [0xjessie21/CVE-2024-0012](https://github.com/0xjessie21/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #2

**来源**: [CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md](../2024/CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** 高危，允许未授权的攻击者获取管理员权限，执行任意命令，篡改配置。

**影响版本:** 10.2, 11.0, 11.1, and 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 需要网络访问到 PAN-OS 管理 Web 界面，且管理界面可以从互联网或不受信任的网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能够访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或利用其他经过身份验证的提权漏洞，例如 CVE-2024-9474。

**漏洞利用方式：**

1.  **会话创建：**  攻击者首先发送一个特制的 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map` 路径，其中包含一个命令注入payload，这个payload的作用是向`/var/appweb/htdocs/unauth/watchTowr.php`写入系统信息。此请求设置 `X-PAN-AUTHCHECK: off` 头部，绕过身份验证检查。如果成功，服务器会返回一个 PHPSESSID cookie。
2.  **命令执行触发：**  攻击者使用获得的 PHPSESSID cookie 发送一个 GET 请求到 `/index.php/.js.map` 路径，同样设置 `X-PAN-AUTHCHECK: off` 头部。这个请求会触发之前注入的命令的执行。
3.  **执行验证：**  攻击者通过访问 `/unauth/watchTowr.php` 路径来验证命令是否成功执行。如果该文件存在且包含预期的系统信息，则表明漏洞利用成功。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的利用是有效的。漏洞库中明确指出存在针对该漏洞的威胁活动。POC 代码的实现方式与 WatchTowr Labs 的分析报告相符，进一步证实了其有效性。CISA 将该漏洞添加到了已知被利用的漏洞目录中，表明该漏洞正在被积极利用。

**投毒风险评估：**

该 POC 代码本身旨在利用漏洞，将 `uname -a` 命令的输出写入一个 Web 可访问的文件。虽然此操作本身具有一定的风险，因为它允许未经身份验证的访问者查看系统信息，但该 POC 代码的主要目的是验证漏洞的存在。代码本身较为简短，主要功能集中在利用漏洞上，不包含明显的恶意代码或者后门。投毒风险较低，估计为 1%。如果使用者不仔细审查，直接使用，可能会暴露一些系统信息，但不会直接导致系统被完全控制，因此投毒风险较低。

**缓解措施：**

*   限制管理 Web 界面的访问，仅允许来自受信任的内部 IP 地址的访问。
*   升级到已修复漏洞的 PAN-OS 版本 (10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本)。
*   部署威胁防御签名（如果可用）以检测和阻止针对此漏洞的攻击（Threat IDs 95746, 95747, 95752, 95753, 95759, 和 95763）。

**项目地址:** [Sachinart/CVE-2024-0012-POC](https://github.com/Sachinart/CVE-2024-0012-POC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #3

**来源**: [CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md](../2024/CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md)

## CVE-2024-0012 & CVE-2024-9474 Palo Alto PAN-OS 身份验证绕过和命令执行

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过 + 命令执行

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (参考漏洞库信息)

**利用条件:** 需要网络访问 PAN-OS 管理 Web 界面，且管理界面暴露在不受信任的网络中（例如互联网）。 根据漏洞库信息，仅允许受信任的内部IP地址访问管理界面可大大降低风险。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞利用结合了 CVE-2024-0012（身份验证绕过）和 CVE-2024-9474（命令执行和权限提升）。

**利用方式：**

1.  **身份验证绕过 (CVE-2024-0012)：** 攻击者无需身份验证即可访问 PAN-OS 管理 Web 界面。
2.  **获取 PHPSESSID：**  攻击者通过发送特制的 POST 请求到 `createRemoteAppwebSession.php` 获取有效的 `PHPSESSID`。
3.  **命令注入 (CVE-2024-9474)：** 攻击者使用获得的 `PHPSESSID`，通过在 `user` 参数中注入 shell 命令，利用 `createRemoteAppwebSession.php` 执行任意命令。
4.  **反弹 Shell：** 攻击者构造一个反弹 shell 的 payload，该 payload 经过两次 Base64 编码。
5.  **分块上传：** 因为命令长度限制，payload 被分割成多个小块，然后通过多个 POST 请求上传到目标服务器，存储为临时文件。
6.  **组合 Payload：** 上传完成后，攻击者使用 shell 命令将这些小块文件组合成一个完整的文件 `enc.txt`。
7.  **双重解码：** 攻击者对 `enc.txt` 中的内容进行双重 Base64 解码，并将结果保存到 `shell.sh` 文件中。
8.  **执行 Shell：** 攻击者赋予 `shell.sh` 可执行权限并执行它，从而建立反弹 shell 连接到攻击者的监听器。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用。提供的 PoC 代码实现了漏洞利用的完整流程，包括身份验证绕过、命令注入和反弹 shell。因此，该PoC代码被认为是有效的。

**投毒风险：**

虽然PoC的主要功能是利用漏洞，但仍存在一定的投毒风险。

*   **临时文件残留：**  该PoC在目标系统上创建临时文件（`c_*.tmp`, `enc.txt`, `shell.sh`），如果利用失败或被中断，这些文件可能会残留，占用磁盘空间或泄露信息。
*   **命令执行风险：**  即使没有成功建立反弹 shell，PoC执行的中间命令可能对系统造成意外影响。
*   **依赖性问题：** 该PoC 依赖于目标系统上存在 `bash`，`base64`，`cat`，`echo`，`tr`，`chmod` 命令。 如果目标系统缺少这些命令,会导致POC 利用失败.

**投毒风险评估：**

该PoC的主要目的是进行漏洞利用，而非进行恶意破坏。 但也存在一定的风险。 投毒风险大概为10%。

**项目地址:** [TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC](https://github.com/TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #4

**来源**: [CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md](../2024/CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备的管理 Web 界面需要能通过网络访问。如果管理界面仅允许受信任的内部 IP 地址访问，风险将大大降低。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他已通过身份验证的权限提升漏洞（如 CVE-2024-9474）。

**漏洞利用方式：**

1.  攻击者发送特制的 HTTP 请求到目标 PAN-OS 设备的管理 Web 界面。
2.  该请求利用身份验证绕过漏洞，使攻击者无需有效凭据即可获得管理员权限。
3.  获得管理员权限后，攻击者可以执行任意命令，读取敏感信息，修改设备配置，甚至可能通过其他漏洞进一步入侵系统。

根据提供的漏洞利用代码 `exploit.py`，该 PoC 包含两种模式：扫描模式和利用模式。

*   **扫描模式：** 用于批量扫描目标 URL，检测是否存在 CVE-2024-0012 漏洞。它向 `/php/ztp_gate.php/.js.map` 发送 GET 请求，如果状态码为 200 且响应中包含 "Zero Touch Provisioning"，则判定存在漏洞。
*   **利用模式：** 允许攻击者在目标系统上执行任意命令。它通过向 `/php/utils/createRemoteAppwebSession.php/peppa.js.map` 发送 POST 请求，并在 `user` 参数中注入命令。然后，它尝试提取 `PHPSESSID`，并利用此会话 ID 访问受保护的页面。命令输出会被写入`/var/appweb/htdocs/unauth/{output_name}`，然后通过 GET 请求 `/unauth/{output_name}` 检索。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用，并且存在公开可用的 PoC，所以该 POC 代码具有有效性。

**投毒风险：**

该PoC代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **命令注入：** 利用模式允许执行任意命令，这意味着如果攻击者使用该 PoC 对目标系统进行攻击，他们可以安装后门、植入恶意软件，或进行其他恶意活动。
*   **未经验证的 PoC：** README.md 文件明确指出 “Untested POC”，这意味着代码可能存在未知的错误或缺陷，可能导致目标系统不稳定或崩溃。
*   **随机文件名：**PoC代码使用随机文件名存储命令输出，虽然在一定程度上防止了文件名冲突，但也可能被攻击者滥用，例如，通过生成大量随机文件来耗尽磁盘空间。

综合考虑，该 PoC 存在一定的投毒风险，大约占比 10%。用户应谨慎使用，并充分了解其潜在风险。

**修复建议：**

*   升级到 PAN-OS 10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本。
*   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
*   如果启用了威胁防御订阅，请启用并配置相关的威胁 ID (95746, 95747, 95752, 95753, 95759, 和 95763) 以阻止利用此漏洞的攻击。

**项目地址:** [VegetableLasagne/CVE-2024-0012](https://github.com/VegetableLasagne/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #5

**来源**: [CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md](../2024/CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (详见漏洞库信息)

**利用条件:** 目标PAN-OS管理Web界面可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果可以访问管理 Web 界面，便能够获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他需要身份验证的提权漏洞，例如 CVE-2024-9474。\n\n**有效性：**\n根据搜索结果和漏洞库信息，该漏洞已经被积极利用。漏洞库信息中的 "exploits" 字段显示 Palo Alto Networks 观察到利用此漏洞的威胁活动。多个搜索结果（例如，Arctic Wolf 的博客文章）也证实了该漏洞正在被利用。因此，利用代码的有效性很高。\n\n**投毒风险：**\n提供的漏洞利用代码仅为 Apache License 2.0 许可协议的文本。它本身不是可执行代码，因此不存在投毒风险。投毒风险为0%。\n\n**利用方式：**\n1.  **访问管理Web界面：** 攻击者需要能够通过网络访问目标 PAN-OS 设备的管理 Web 界面。\n2.  **身份验证绕过：** 利用漏洞绕过身份验证机制。根据漏洞信息，可能涉及发送特制的 HTTP 请求或利用身份验证过程中的缺陷。具体绕过方法需要根据完整的PoC来分析，这里仅有license文件，无法推断。\n3.  **获取管理员权限：** 成功绕过身份验证后，攻击者将获得 PAN-OS 管理员权限。\n4.  **执行恶意操作：** 获得管理员权限后，攻击者可以执行各种恶意操作，包括：\n    *   执行任意命令。\n    *   篡改防火墙配置。\n    *   利用其他漏洞进一步攻击。\n\n**缓解措施：**\n*   限制管理界面访问：根据 Palo Alto Networks 的最佳实践指南，仅允许受信任的内部 IP 地址访问管理 Web 界面。\n*   应用威胁防御：如果拥有威胁防御订阅，可以使用威胁 ID 95746、95747、95752、95753、95759 和 95763 阻止攻击。\n*   及时更新：升级到已修复此漏洞的 PAN-OS 版本 (10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本)。

**项目地址:** [XiaomingX/cve-2024-0012-poc](https://github.com/XiaomingX/cve-2024-0012-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #6

**来源**: [CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md](../2024/CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用（如CVE-2024-9474）

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 (受影响版本低于已修复版本)

**利用条件:** 需要网络访问目标PAN-OS设备的管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012是Palo Alto Networks PAN-OS软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理Web界面，可以获取PAN-OS管理员权限，执行管理操作，篡改配置或利用其他身份验证的权限提升漏洞。根据漏洞描述和搜索结果，该漏洞影响特定版本的PAN-OS，且存在在野利用。提供的POC代码（`cve-2024-0012-gui.py`）利用了此漏洞。利用方式如下：

1.  **创建初始会话：**  通过`createRemoteAppwebSession.php`端点，设置`X-PAN-AUTHCHECK`为`off`，并且在POST数据中，将`user`参数设置为包含命令注入的恶意代码。攻击者可以通过这个方式在目标机器上写入一个PHP文件，例如`cve.php`。命令通过反引号执行，将结果写入PHP文件。
2.  **触发执行：**  使用创建的`PHPSESSID` cookie，访问`/index.php/.js.map`端点，触发之前注入的命令执行。
3.  **验证执行：**  访问`/unauth/cve.php`，检查命令是否成功执行，并获取命令输出。

**投毒风险分析：**

查看`cve-2024-0012-gui.py`脚本，发现其主要功能是利用漏洞进行命令注入和验证，基本符合漏洞利用的逻辑。`self.command_input = QLineEdit()` 允许用户输入命令，增加了灵活性，但也引入了一定的风险，使用者可能使用恶意命令。但是从代码逻辑上，此仓库直接投毒的可能性较低。`README.md`文件仅包含漏洞描述和作者信息，无恶意代码。

总而言之，考虑到代码的开源性质，以及主要功能符合漏洞利用的预期，投毒的概率较低，但是命令的执行权交给了用户，如果用户使用了恶意命令，也可能造成危害。因此投毒风险评估为10%。

**项目地址:** [dcollaoa/cve-2024-0012-gui-poc](https://github.com/dcollaoa/cve-2024-0012-gui-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #7

**来源**: [CVE-2024-0012-greaselovely_CVE-2024-0012.md](../2024/CVE-2024-0012-greaselovely_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** Critical, allows unauthenticated remote attackers to gain administrator privileges.

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 software before the fixed versions.

**利用条件:** The management web interface must be accessible over the network, especially from the internet.

**POC 可用性:** Yes

**投毒风险:** 10%

## 详情

CVE-2024-0012 is an authentication bypass vulnerability in Palo Alto Networks PAN-OS. An unauthenticated attacker with network access to the management web interface can gain PAN-OS administrator privileges. 

**有效性：**
根据漏洞库信息、搜索引擎结果（尤其是来自Palo Alto Networks自身以及Arctic Wolf等安全公司的报告）以及提供的PoC代码，此漏洞是真实且已被利用的。PoC代码通过检查特定URL的响应状态码、Header以及页面内容是否包含`Zero Touch Provisioning`和`window.Pan`等特征字符串来判断目标是否存在漏洞，表明PoC的有效性。

**投毒风险：**
PoC代码主要用于检测漏洞是否存在，其本身功能相对简单，未发现明显的恶意代码。代码中使用的`requests`库可能存在潜在风险，如果被替换为恶意版本，可能导致信息泄露或代码执行。LICENSE文件采用MIT开源协议，允许修改和再分发，这也会增加潜在的投毒风险。考虑到requests库的潜在风险和开源协议的开放性，投毒风险评定为10%。

**利用方式：**
1.  **网络访问:** 攻击者需要能够通过网络访问目标Palo Alto Networks设备的管理Web界面。
2.  **漏洞触发:** 攻击者发送特制的HTTP请求到目标设备的管理Web界面，绕过身份验证。
3.  **权限提升:** 成功绕过身份验证后，攻击者获得PAN-OS管理员权限，可以执行任意管理操作，篡改配置或利用其他漏洞。
4. **后续利用:** 可能会结合 CVE-2024-9474 进一步利用， 执行任意命令。

**项目地址:** [greaselovely/CVE-2024-0012](https://github.com/greaselovely/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #8

**来源**: [CVE-2024-0012-iSee857_CVE-2024-0012-poc.md](../2024/CVE-2024-0012-iSee857_CVE-2024-0012-poc.md)

# CVE-2024-0012

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0012-0xjessie21_CVE-2024-0012.md](../2024/CVE-2024-0012-0xjessie21_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，未经身份验证的攻击者可以获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 11.2受影响版本

**利用条件:** 需要网络可以访问PAN-OS管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果具有对管理 Web 界面的网络访问权限，则可以获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他经过身份验证的权限提升漏洞。根据搜索结果和漏洞描述，该漏洞的风险在于允许未经授权的访问和控制。漏洞利用代码通过构造特定的HTTP请求绕过身份验证，然后在目标系统上执行任意命令。由于攻击者可以执行任意命令，因此存在植入后门的风险。 

**漏洞利用方式：**

1.  **利用createRemoteAppwebSession.php 创建初始会话:** 通过构造包含命令注入Payload的POST请求发送到`/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`，其中`X-PAN-AUTHCHECK` header设置为 `off`，并在`user`字段中注入恶意命令。该请求会将命令执行的结果写入`/var/appweb/htdocs/unauth/watchTowr.php`。
2.  **触发命令执行:**  利用index.php页面来触发执行`/var/appweb/htdocs/unauth/watchTowr.php`中的命令。

**投毒风险分析:**
代码本身是漏洞利用的PoC，实现了利用漏洞执行命令的功能。
*   PoC 中有向`/var/appweb/htdocs/unauth/`写入php文件的操作，如果服务器本身存在文件写入的权限问题，可能导致扩大攻击面。
*   PoC允许执行任意命令，如果攻击者在`--command`或者`--reverse-shell`中构造恶意的指令，可能会对目标造成更大的危害。
因此，存在一定的投毒风险，评估为10%。

**项目地址:** [0xjessie21/CVE-2024-0012](https://github.com/0xjessie21/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #2

**来源**: [CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md](../2024/CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** 高危，允许未授权的攻击者获取管理员权限，执行任意命令，篡改配置。

**影响版本:** 10.2, 11.0, 11.1, and 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 需要网络访问到 PAN-OS 管理 Web 界面，且管理界面可以从互联网或不受信任的网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能够访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或利用其他经过身份验证的提权漏洞，例如 CVE-2024-9474。

**漏洞利用方式：**

1.  **会话创建：**  攻击者首先发送一个特制的 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map` 路径，其中包含一个命令注入payload，这个payload的作用是向`/var/appweb/htdocs/unauth/watchTowr.php`写入系统信息。此请求设置 `X-PAN-AUTHCHECK: off` 头部，绕过身份验证检查。如果成功，服务器会返回一个 PHPSESSID cookie。
2.  **命令执行触发：**  攻击者使用获得的 PHPSESSID cookie 发送一个 GET 请求到 `/index.php/.js.map` 路径，同样设置 `X-PAN-AUTHCHECK: off` 头部。这个请求会触发之前注入的命令的执行。
3.  **执行验证：**  攻击者通过访问 `/unauth/watchTowr.php` 路径来验证命令是否成功执行。如果该文件存在且包含预期的系统信息，则表明漏洞利用成功。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的利用是有效的。漏洞库中明确指出存在针对该漏洞的威胁活动。POC 代码的实现方式与 WatchTowr Labs 的分析报告相符，进一步证实了其有效性。CISA 将该漏洞添加到了已知被利用的漏洞目录中，表明该漏洞正在被积极利用。

**投毒风险评估：**

该 POC 代码本身旨在利用漏洞，将 `uname -a` 命令的输出写入一个 Web 可访问的文件。虽然此操作本身具有一定的风险，因为它允许未经身份验证的访问者查看系统信息，但该 POC 代码的主要目的是验证漏洞的存在。代码本身较为简短，主要功能集中在利用漏洞上，不包含明显的恶意代码或者后门。投毒风险较低，估计为 1%。如果使用者不仔细审查，直接使用，可能会暴露一些系统信息，但不会直接导致系统被完全控制，因此投毒风险较低。

**缓解措施：**

*   限制管理 Web 界面的访问，仅允许来自受信任的内部 IP 地址的访问。
*   升级到已修复漏洞的 PAN-OS 版本 (10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本)。
*   部署威胁防御签名（如果可用）以检测和阻止针对此漏洞的攻击（Threat IDs 95746, 95747, 95752, 95753, 95759, 和 95763）。

**项目地址:** [Sachinart/CVE-2024-0012-POC](https://github.com/Sachinart/CVE-2024-0012-POC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #3

**来源**: [CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md](../2024/CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md)

## CVE-2024-0012 & CVE-2024-9474 Palo Alto PAN-OS 身份验证绕过和命令执行

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过 + 命令执行

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (参考漏洞库信息)

**利用条件:** 需要网络访问 PAN-OS 管理 Web 界面，且管理界面暴露在不受信任的网络中（例如互联网）。 根据漏洞库信息，仅允许受信任的内部IP地址访问管理界面可大大降低风险。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞利用结合了 CVE-2024-0012（身份验证绕过）和 CVE-2024-9474（命令执行和权限提升）。

**利用方式：**

1.  **身份验证绕过 (CVE-2024-0012)：** 攻击者无需身份验证即可访问 PAN-OS 管理 Web 界面。
2.  **获取 PHPSESSID：**  攻击者通过发送特制的 POST 请求到 `createRemoteAppwebSession.php` 获取有效的 `PHPSESSID`。
3.  **命令注入 (CVE-2024-9474)：** 攻击者使用获得的 `PHPSESSID`，通过在 `user` 参数中注入 shell 命令，利用 `createRemoteAppwebSession.php` 执行任意命令。
4.  **反弹 Shell：** 攻击者构造一个反弹 shell 的 payload，该 payload 经过两次 Base64 编码。
5.  **分块上传：** 因为命令长度限制，payload 被分割成多个小块，然后通过多个 POST 请求上传到目标服务器，存储为临时文件。
6.  **组合 Payload：** 上传完成后，攻击者使用 shell 命令将这些小块文件组合成一个完整的文件 `enc.txt`。
7.  **双重解码：** 攻击者对 `enc.txt` 中的内容进行双重 Base64 解码，并将结果保存到 `shell.sh` 文件中。
8.  **执行 Shell：** 攻击者赋予 `shell.sh` 可执行权限并执行它，从而建立反弹 shell 连接到攻击者的监听器。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用。提供的 PoC 代码实现了漏洞利用的完整流程，包括身份验证绕过、命令注入和反弹 shell。因此，该PoC代码被认为是有效的。

**投毒风险：**

虽然PoC的主要功能是利用漏洞，但仍存在一定的投毒风险。

*   **临时文件残留：**  该PoC在目标系统上创建临时文件（`c_*.tmp`, `enc.txt`, `shell.sh`），如果利用失败或被中断，这些文件可能会残留，占用磁盘空间或泄露信息。
*   **命令执行风险：**  即使没有成功建立反弹 shell，PoC执行的中间命令可能对系统造成意外影响。
*   **依赖性问题：** 该PoC 依赖于目标系统上存在 `bash`，`base64`，`cat`，`echo`，`tr`，`chmod` 命令。 如果目标系统缺少这些命令,会导致POC 利用失败.

**投毒风险评估：**

该PoC的主要目的是进行漏洞利用，而非进行恶意破坏。 但也存在一定的风险。 投毒风险大概为10%。

**项目地址:** [TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC](https://github.com/TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #4

**来源**: [CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md](../2024/CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备的管理 Web 界面需要能通过网络访问。如果管理界面仅允许受信任的内部 IP 地址访问，风险将大大降低。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他已通过身份验证的权限提升漏洞（如 CVE-2024-9474）。

**漏洞利用方式：**

1.  攻击者发送特制的 HTTP 请求到目标 PAN-OS 设备的管理 Web 界面。
2.  该请求利用身份验证绕过漏洞，使攻击者无需有效凭据即可获得管理员权限。
3.  获得管理员权限后，攻击者可以执行任意命令，读取敏感信息，修改设备配置，甚至可能通过其他漏洞进一步入侵系统。

根据提供的漏洞利用代码 `exploit.py`，该 PoC 包含两种模式：扫描模式和利用模式。

*   **扫描模式：** 用于批量扫描目标 URL，检测是否存在 CVE-2024-0012 漏洞。它向 `/php/ztp_gate.php/.js.map` 发送 GET 请求，如果状态码为 200 且响应中包含 "Zero Touch Provisioning"，则判定存在漏洞。
*   **利用模式：** 允许攻击者在目标系统上执行任意命令。它通过向 `/php/utils/createRemoteAppwebSession.php/peppa.js.map` 发送 POST 请求，并在 `user` 参数中注入命令。然后，它尝试提取 `PHPSESSID`，并利用此会话 ID 访问受保护的页面。命令输出会被写入`/var/appweb/htdocs/unauth/{output_name}`，然后通过 GET 请求 `/unauth/{output_name}` 检索。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用，并且存在公开可用的 PoC，所以该 POC 代码具有有效性。

**投毒风险：**

该PoC代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **命令注入：** 利用模式允许执行任意命令，这意味着如果攻击者使用该 PoC 对目标系统进行攻击，他们可以安装后门、植入恶意软件，或进行其他恶意活动。
*   **未经验证的 PoC：** README.md 文件明确指出 “Untested POC”，这意味着代码可能存在未知的错误或缺陷，可能导致目标系统不稳定或崩溃。
*   **随机文件名：**PoC代码使用随机文件名存储命令输出，虽然在一定程度上防止了文件名冲突，但也可能被攻击者滥用，例如，通过生成大量随机文件来耗尽磁盘空间。

综合考虑，该 PoC 存在一定的投毒风险，大约占比 10%。用户应谨慎使用，并充分了解其潜在风险。

**修复建议：**

*   升级到 PAN-OS 10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本。
*   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
*   如果启用了威胁防御订阅，请启用并配置相关的威胁 ID (95746, 95747, 95752, 95753, 95759, 和 95763) 以阻止利用此漏洞的攻击。

**项目地址:** [VegetableLasagne/CVE-2024-0012](https://github.com/VegetableLasagne/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #5

**来源**: [CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md](../2024/CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (详见漏洞库信息)

**利用条件:** 目标PAN-OS管理Web界面可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果可以访问管理 Web 界面，便能够获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他需要身份验证的提权漏洞，例如 CVE-2024-9474。\n\n**有效性：**\n根据搜索结果和漏洞库信息，该漏洞已经被积极利用。漏洞库信息中的 "exploits" 字段显示 Palo Alto Networks 观察到利用此漏洞的威胁活动。多个搜索结果（例如，Arctic Wolf 的博客文章）也证实了该漏洞正在被利用。因此，利用代码的有效性很高。\n\n**投毒风险：**\n提供的漏洞利用代码仅为 Apache License 2.0 许可协议的文本。它本身不是可执行代码，因此不存在投毒风险。投毒风险为0%。\n\n**利用方式：**\n1.  **访问管理Web界面：** 攻击者需要能够通过网络访问目标 PAN-OS 设备的管理 Web 界面。\n2.  **身份验证绕过：** 利用漏洞绕过身份验证机制。根据漏洞信息，可能涉及发送特制的 HTTP 请求或利用身份验证过程中的缺陷。具体绕过方法需要根据完整的PoC来分析，这里仅有license文件，无法推断。\n3.  **获取管理员权限：** 成功绕过身份验证后，攻击者将获得 PAN-OS 管理员权限。\n4.  **执行恶意操作：** 获得管理员权限后，攻击者可以执行各种恶意操作，包括：\n    *   执行任意命令。\n    *   篡改防火墙配置。\n    *   利用其他漏洞进一步攻击。\n\n**缓解措施：**\n*   限制管理界面访问：根据 Palo Alto Networks 的最佳实践指南，仅允许受信任的内部 IP 地址访问管理 Web 界面。\n*   应用威胁防御：如果拥有威胁防御订阅，可以使用威胁 ID 95746、95747、95752、95753、95759 和 95763 阻止攻击。\n*   及时更新：升级到已修复此漏洞的 PAN-OS 版本 (10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本)。

**项目地址:** [XiaomingX/cve-2024-0012-poc](https://github.com/XiaomingX/cve-2024-0012-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #6

**来源**: [CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md](../2024/CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用（如CVE-2024-9474）

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 (受影响版本低于已修复版本)

**利用条件:** 需要网络访问目标PAN-OS设备的管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012是Palo Alto Networks PAN-OS软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理Web界面，可以获取PAN-OS管理员权限，执行管理操作，篡改配置或利用其他身份验证的权限提升漏洞。根据漏洞描述和搜索结果，该漏洞影响特定版本的PAN-OS，且存在在野利用。提供的POC代码（`cve-2024-0012-gui.py`）利用了此漏洞。利用方式如下：

1.  **创建初始会话：**  通过`createRemoteAppwebSession.php`端点，设置`X-PAN-AUTHCHECK`为`off`，并且在POST数据中，将`user`参数设置为包含命令注入的恶意代码。攻击者可以通过这个方式在目标机器上写入一个PHP文件，例如`cve.php`。命令通过反引号执行，将结果写入PHP文件。
2.  **触发执行：**  使用创建的`PHPSESSID` cookie，访问`/index.php/.js.map`端点，触发之前注入的命令执行。
3.  **验证执行：**  访问`/unauth/cve.php`，检查命令是否成功执行，并获取命令输出。

**投毒风险分析：**

查看`cve-2024-0012-gui.py`脚本，发现其主要功能是利用漏洞进行命令注入和验证，基本符合漏洞利用的逻辑。`self.command_input = QLineEdit()` 允许用户输入命令，增加了灵活性，但也引入了一定的风险，使用者可能使用恶意命令。但是从代码逻辑上，此仓库直接投毒的可能性较低。`README.md`文件仅包含漏洞描述和作者信息，无恶意代码。

总而言之，考虑到代码的开源性质，以及主要功能符合漏洞利用的预期，投毒的概率较低，但是命令的执行权交给了用户，如果用户使用了恶意命令，也可能造成危害。因此投毒风险评估为10%。

**项目地址:** [dcollaoa/cve-2024-0012-gui-poc](https://github.com/dcollaoa/cve-2024-0012-gui-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #7

**来源**: [CVE-2024-0012-greaselovely_CVE-2024-0012.md](../2024/CVE-2024-0012-greaselovely_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** Critical, allows unauthenticated remote attackers to gain administrator privileges.

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 software before the fixed versions.

**利用条件:** The management web interface must be accessible over the network, especially from the internet.

**POC 可用性:** Yes

**投毒风险:** 10%

## 详情

CVE-2024-0012 is an authentication bypass vulnerability in Palo Alto Networks PAN-OS. An unauthenticated attacker with network access to the management web interface can gain PAN-OS administrator privileges. 

**有效性：**
根据漏洞库信息、搜索引擎结果（尤其是来自Palo Alto Networks自身以及Arctic Wolf等安全公司的报告）以及提供的PoC代码，此漏洞是真实且已被利用的。PoC代码通过检查特定URL的响应状态码、Header以及页面内容是否包含`Zero Touch Provisioning`和`window.Pan`等特征字符串来判断目标是否存在漏洞，表明PoC的有效性。

**投毒风险：**
PoC代码主要用于检测漏洞是否存在，其本身功能相对简单，未发现明显的恶意代码。代码中使用的`requests`库可能存在潜在风险，如果被替换为恶意版本，可能导致信息泄露或代码执行。LICENSE文件采用MIT开源协议，允许修改和再分发，这也会增加潜在的投毒风险。考虑到requests库的潜在风险和开源协议的开放性，投毒风险评定为10%。

**利用方式：**
1.  **网络访问:** 攻击者需要能够通过网络访问目标Palo Alto Networks设备的管理Web界面。
2.  **漏洞触发:** 攻击者发送特制的HTTP请求到目标设备的管理Web界面，绕过身份验证。
3.  **权限提升:** 成功绕过身份验证后，攻击者获得PAN-OS管理员权限，可以执行任意管理操作，篡改配置或利用其他漏洞。
4. **后续利用:** 可能会结合 CVE-2024-9474 进一步利用， 执行任意命令。

**项目地址:** [greaselovely/CVE-2024-0012](https://github.com/greaselovely/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #8

**来源**: [CVE-2024-0012-iSee857_CVE-2024-0012-poc.md](../2024/CVE-2024-0012-iSee857_CVE-2024-0012-poc.md)

# CVE-2024-0012

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0012-0xjessie21_CVE-2024-0012.md](../2024/CVE-2024-0012-0xjessie21_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，未经身份验证的攻击者可以获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 11.2受影响版本

**利用条件:** 需要网络可以访问PAN-OS管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果具有对管理 Web 界面的网络访问权限，则可以获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他经过身份验证的权限提升漏洞。根据搜索结果和漏洞描述，该漏洞的风险在于允许未经授权的访问和控制。漏洞利用代码通过构造特定的HTTP请求绕过身份验证，然后在目标系统上执行任意命令。由于攻击者可以执行任意命令，因此存在植入后门的风险。 

**漏洞利用方式：**

1.  **利用createRemoteAppwebSession.php 创建初始会话:** 通过构造包含命令注入Payload的POST请求发送到`/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`，其中`X-PAN-AUTHCHECK` header设置为 `off`，并在`user`字段中注入恶意命令。该请求会将命令执行的结果写入`/var/appweb/htdocs/unauth/watchTowr.php`。
2.  **触发命令执行:**  利用index.php页面来触发执行`/var/appweb/htdocs/unauth/watchTowr.php`中的命令。

**投毒风险分析:**
代码本身是漏洞利用的PoC，实现了利用漏洞执行命令的功能。
*   PoC 中有向`/var/appweb/htdocs/unauth/`写入php文件的操作，如果服务器本身存在文件写入的权限问题，可能导致扩大攻击面。
*   PoC允许执行任意命令，如果攻击者在`--command`或者`--reverse-shell`中构造恶意的指令，可能会对目标造成更大的危害。
因此，存在一定的投毒风险，评估为10%。

**项目地址:** [0xjessie21/CVE-2024-0012](https://github.com/0xjessie21/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #2

**来源**: [CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md](../2024/CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** 高危，允许未授权的攻击者获取管理员权限，执行任意命令，篡改配置。

**影响版本:** 10.2, 11.0, 11.1, and 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 需要网络访问到 PAN-OS 管理 Web 界面，且管理界面可以从互联网或不受信任的网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能够访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或利用其他经过身份验证的提权漏洞，例如 CVE-2024-9474。

**漏洞利用方式：**

1.  **会话创建：**  攻击者首先发送一个特制的 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map` 路径，其中包含一个命令注入payload，这个payload的作用是向`/var/appweb/htdocs/unauth/watchTowr.php`写入系统信息。此请求设置 `X-PAN-AUTHCHECK: off` 头部，绕过身份验证检查。如果成功，服务器会返回一个 PHPSESSID cookie。
2.  **命令执行触发：**  攻击者使用获得的 PHPSESSID cookie 发送一个 GET 请求到 `/index.php/.js.map` 路径，同样设置 `X-PAN-AUTHCHECK: off` 头部。这个请求会触发之前注入的命令的执行。
3.  **执行验证：**  攻击者通过访问 `/unauth/watchTowr.php` 路径来验证命令是否成功执行。如果该文件存在且包含预期的系统信息，则表明漏洞利用成功。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的利用是有效的。漏洞库中明确指出存在针对该漏洞的威胁活动。POC 代码的实现方式与 WatchTowr Labs 的分析报告相符，进一步证实了其有效性。CISA 将该漏洞添加到了已知被利用的漏洞目录中，表明该漏洞正在被积极利用。

**投毒风险评估：**

该 POC 代码本身旨在利用漏洞，将 `uname -a` 命令的输出写入一个 Web 可访问的文件。虽然此操作本身具有一定的风险，因为它允许未经身份验证的访问者查看系统信息，但该 POC 代码的主要目的是验证漏洞的存在。代码本身较为简短，主要功能集中在利用漏洞上，不包含明显的恶意代码或者后门。投毒风险较低，估计为 1%。如果使用者不仔细审查，直接使用，可能会暴露一些系统信息，但不会直接导致系统被完全控制，因此投毒风险较低。

**缓解措施：**

*   限制管理 Web 界面的访问，仅允许来自受信任的内部 IP 地址的访问。
*   升级到已修复漏洞的 PAN-OS 版本 (10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本)。
*   部署威胁防御签名（如果可用）以检测和阻止针对此漏洞的攻击（Threat IDs 95746, 95747, 95752, 95753, 95759, 和 95763）。

**项目地址:** [Sachinart/CVE-2024-0012-POC](https://github.com/Sachinart/CVE-2024-0012-POC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #3

**来源**: [CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md](../2024/CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md)

## CVE-2024-0012 & CVE-2024-9474 Palo Alto PAN-OS 身份验证绕过和命令执行

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过 + 命令执行

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (参考漏洞库信息)

**利用条件:** 需要网络访问 PAN-OS 管理 Web 界面，且管理界面暴露在不受信任的网络中（例如互联网）。 根据漏洞库信息，仅允许受信任的内部IP地址访问管理界面可大大降低风险。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞利用结合了 CVE-2024-0012（身份验证绕过）和 CVE-2024-9474（命令执行和权限提升）。

**利用方式：**

1.  **身份验证绕过 (CVE-2024-0012)：** 攻击者无需身份验证即可访问 PAN-OS 管理 Web 界面。
2.  **获取 PHPSESSID：**  攻击者通过发送特制的 POST 请求到 `createRemoteAppwebSession.php` 获取有效的 `PHPSESSID`。
3.  **命令注入 (CVE-2024-9474)：** 攻击者使用获得的 `PHPSESSID`，通过在 `user` 参数中注入 shell 命令，利用 `createRemoteAppwebSession.php` 执行任意命令。
4.  **反弹 Shell：** 攻击者构造一个反弹 shell 的 payload，该 payload 经过两次 Base64 编码。
5.  **分块上传：** 因为命令长度限制，payload 被分割成多个小块，然后通过多个 POST 请求上传到目标服务器，存储为临时文件。
6.  **组合 Payload：** 上传完成后，攻击者使用 shell 命令将这些小块文件组合成一个完整的文件 `enc.txt`。
7.  **双重解码：** 攻击者对 `enc.txt` 中的内容进行双重 Base64 解码，并将结果保存到 `shell.sh` 文件中。
8.  **执行 Shell：** 攻击者赋予 `shell.sh` 可执行权限并执行它，从而建立反弹 shell 连接到攻击者的监听器。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用。提供的 PoC 代码实现了漏洞利用的完整流程，包括身份验证绕过、命令注入和反弹 shell。因此，该PoC代码被认为是有效的。

**投毒风险：**

虽然PoC的主要功能是利用漏洞，但仍存在一定的投毒风险。

*   **临时文件残留：**  该PoC在目标系统上创建临时文件（`c_*.tmp`, `enc.txt`, `shell.sh`），如果利用失败或被中断，这些文件可能会残留，占用磁盘空间或泄露信息。
*   **命令执行风险：**  即使没有成功建立反弹 shell，PoC执行的中间命令可能对系统造成意外影响。
*   **依赖性问题：** 该PoC 依赖于目标系统上存在 `bash`，`base64`，`cat`，`echo`，`tr`，`chmod` 命令。 如果目标系统缺少这些命令,会导致POC 利用失败.

**投毒风险评估：**

该PoC的主要目的是进行漏洞利用，而非进行恶意破坏。 但也存在一定的风险。 投毒风险大概为10%。

**项目地址:** [TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC](https://github.com/TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #4

**来源**: [CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md](../2024/CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备的管理 Web 界面需要能通过网络访问。如果管理界面仅允许受信任的内部 IP 地址访问，风险将大大降低。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他已通过身份验证的权限提升漏洞（如 CVE-2024-9474）。

**漏洞利用方式：**

1.  攻击者发送特制的 HTTP 请求到目标 PAN-OS 设备的管理 Web 界面。
2.  该请求利用身份验证绕过漏洞，使攻击者无需有效凭据即可获得管理员权限。
3.  获得管理员权限后，攻击者可以执行任意命令，读取敏感信息，修改设备配置，甚至可能通过其他漏洞进一步入侵系统。

根据提供的漏洞利用代码 `exploit.py`，该 PoC 包含两种模式：扫描模式和利用模式。

*   **扫描模式：** 用于批量扫描目标 URL，检测是否存在 CVE-2024-0012 漏洞。它向 `/php/ztp_gate.php/.js.map` 发送 GET 请求，如果状态码为 200 且响应中包含 "Zero Touch Provisioning"，则判定存在漏洞。
*   **利用模式：** 允许攻击者在目标系统上执行任意命令。它通过向 `/php/utils/createRemoteAppwebSession.php/peppa.js.map` 发送 POST 请求，并在 `user` 参数中注入命令。然后，它尝试提取 `PHPSESSID`，并利用此会话 ID 访问受保护的页面。命令输出会被写入`/var/appweb/htdocs/unauth/{output_name}`，然后通过 GET 请求 `/unauth/{output_name}` 检索。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用，并且存在公开可用的 PoC，所以该 POC 代码具有有效性。

**投毒风险：**

该PoC代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **命令注入：** 利用模式允许执行任意命令，这意味着如果攻击者使用该 PoC 对目标系统进行攻击，他们可以安装后门、植入恶意软件，或进行其他恶意活动。
*   **未经验证的 PoC：** README.md 文件明确指出 “Untested POC”，这意味着代码可能存在未知的错误或缺陷，可能导致目标系统不稳定或崩溃。
*   **随机文件名：**PoC代码使用随机文件名存储命令输出，虽然在一定程度上防止了文件名冲突，但也可能被攻击者滥用，例如，通过生成大量随机文件来耗尽磁盘空间。

综合考虑，该 PoC 存在一定的投毒风险，大约占比 10%。用户应谨慎使用，并充分了解其潜在风险。

**修复建议：**

*   升级到 PAN-OS 10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本。
*   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
*   如果启用了威胁防御订阅，请启用并配置相关的威胁 ID (95746, 95747, 95752, 95753, 95759, 和 95763) 以阻止利用此漏洞的攻击。

**项目地址:** [VegetableLasagne/CVE-2024-0012](https://github.com/VegetableLasagne/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #5

**来源**: [CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md](../2024/CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (详见漏洞库信息)

**利用条件:** 目标PAN-OS管理Web界面可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果可以访问管理 Web 界面，便能够获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他需要身份验证的提权漏洞，例如 CVE-2024-9474。\n\n**有效性：**\n根据搜索结果和漏洞库信息，该漏洞已经被积极利用。漏洞库信息中的 "exploits" 字段显示 Palo Alto Networks 观察到利用此漏洞的威胁活动。多个搜索结果（例如，Arctic Wolf 的博客文章）也证实了该漏洞正在被利用。因此，利用代码的有效性很高。\n\n**投毒风险：**\n提供的漏洞利用代码仅为 Apache License 2.0 许可协议的文本。它本身不是可执行代码，因此不存在投毒风险。投毒风险为0%。\n\n**利用方式：**\n1.  **访问管理Web界面：** 攻击者需要能够通过网络访问目标 PAN-OS 设备的管理 Web 界面。\n2.  **身份验证绕过：** 利用漏洞绕过身份验证机制。根据漏洞信息，可能涉及发送特制的 HTTP 请求或利用身份验证过程中的缺陷。具体绕过方法需要根据完整的PoC来分析，这里仅有license文件，无法推断。\n3.  **获取管理员权限：** 成功绕过身份验证后，攻击者将获得 PAN-OS 管理员权限。\n4.  **执行恶意操作：** 获得管理员权限后，攻击者可以执行各种恶意操作，包括：\n    *   执行任意命令。\n    *   篡改防火墙配置。\n    *   利用其他漏洞进一步攻击。\n\n**缓解措施：**\n*   限制管理界面访问：根据 Palo Alto Networks 的最佳实践指南，仅允许受信任的内部 IP 地址访问管理 Web 界面。\n*   应用威胁防御：如果拥有威胁防御订阅，可以使用威胁 ID 95746、95747、95752、95753、95759 和 95763 阻止攻击。\n*   及时更新：升级到已修复此漏洞的 PAN-OS 版本 (10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本)。

**项目地址:** [XiaomingX/cve-2024-0012-poc](https://github.com/XiaomingX/cve-2024-0012-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #6

**来源**: [CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md](../2024/CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用（如CVE-2024-9474）

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 (受影响版本低于已修复版本)

**利用条件:** 需要网络访问目标PAN-OS设备的管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012是Palo Alto Networks PAN-OS软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理Web界面，可以获取PAN-OS管理员权限，执行管理操作，篡改配置或利用其他身份验证的权限提升漏洞。根据漏洞描述和搜索结果，该漏洞影响特定版本的PAN-OS，且存在在野利用。提供的POC代码（`cve-2024-0012-gui.py`）利用了此漏洞。利用方式如下：

1.  **创建初始会话：**  通过`createRemoteAppwebSession.php`端点，设置`X-PAN-AUTHCHECK`为`off`，并且在POST数据中，将`user`参数设置为包含命令注入的恶意代码。攻击者可以通过这个方式在目标机器上写入一个PHP文件，例如`cve.php`。命令通过反引号执行，将结果写入PHP文件。
2.  **触发执行：**  使用创建的`PHPSESSID` cookie，访问`/index.php/.js.map`端点，触发之前注入的命令执行。
3.  **验证执行：**  访问`/unauth/cve.php`，检查命令是否成功执行，并获取命令输出。

**投毒风险分析：**

查看`cve-2024-0012-gui.py`脚本，发现其主要功能是利用漏洞进行命令注入和验证，基本符合漏洞利用的逻辑。`self.command_input = QLineEdit()` 允许用户输入命令，增加了灵活性，但也引入了一定的风险，使用者可能使用恶意命令。但是从代码逻辑上，此仓库直接投毒的可能性较低。`README.md`文件仅包含漏洞描述和作者信息，无恶意代码。

总而言之，考虑到代码的开源性质，以及主要功能符合漏洞利用的预期，投毒的概率较低，但是命令的执行权交给了用户，如果用户使用了恶意命令，也可能造成危害。因此投毒风险评估为10%。

**项目地址:** [dcollaoa/cve-2024-0012-gui-poc](https://github.com/dcollaoa/cve-2024-0012-gui-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #7

**来源**: [CVE-2024-0012-greaselovely_CVE-2024-0012.md](../2024/CVE-2024-0012-greaselovely_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** Critical, allows unauthenticated remote attackers to gain administrator privileges.

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 software before the fixed versions.

**利用条件:** The management web interface must be accessible over the network, especially from the internet.

**POC 可用性:** Yes

**投毒风险:** 10%

## 详情

CVE-2024-0012 is an authentication bypass vulnerability in Palo Alto Networks PAN-OS. An unauthenticated attacker with network access to the management web interface can gain PAN-OS administrator privileges. 

**有效性：**
根据漏洞库信息、搜索引擎结果（尤其是来自Palo Alto Networks自身以及Arctic Wolf等安全公司的报告）以及提供的PoC代码，此漏洞是真实且已被利用的。PoC代码通过检查特定URL的响应状态码、Header以及页面内容是否包含`Zero Touch Provisioning`和`window.Pan`等特征字符串来判断目标是否存在漏洞，表明PoC的有效性。

**投毒风险：**
PoC代码主要用于检测漏洞是否存在，其本身功能相对简单，未发现明显的恶意代码。代码中使用的`requests`库可能存在潜在风险，如果被替换为恶意版本，可能导致信息泄露或代码执行。LICENSE文件采用MIT开源协议，允许修改和再分发，这也会增加潜在的投毒风险。考虑到requests库的潜在风险和开源协议的开放性，投毒风险评定为10%。

**利用方式：**
1.  **网络访问:** 攻击者需要能够通过网络访问目标Palo Alto Networks设备的管理Web界面。
2.  **漏洞触发:** 攻击者发送特制的HTTP请求到目标设备的管理Web界面，绕过身份验证。
3.  **权限提升:** 成功绕过身份验证后，攻击者获得PAN-OS管理员权限，可以执行任意管理操作，篡改配置或利用其他漏洞。
4. **后续利用:** 可能会结合 CVE-2024-9474 进一步利用， 执行任意命令。

**项目地址:** [greaselovely/CVE-2024-0012](https://github.com/greaselovely/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #8

**来源**: [CVE-2024-0012-iSee857_CVE-2024-0012-poc.md](../2024/CVE-2024-0012-iSee857_CVE-2024-0012-poc.md)

# CVE-2024-0012

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0012-0xjessie21_CVE-2024-0012.md](../2024/CVE-2024-0012-0xjessie21_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，未经身份验证的攻击者可以获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 11.2受影响版本

**利用条件:** 需要网络可以访问PAN-OS管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果具有对管理 Web 界面的网络访问权限，则可以获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他经过身份验证的权限提升漏洞。根据搜索结果和漏洞描述，该漏洞的风险在于允许未经授权的访问和控制。漏洞利用代码通过构造特定的HTTP请求绕过身份验证，然后在目标系统上执行任意命令。由于攻击者可以执行任意命令，因此存在植入后门的风险。 

**漏洞利用方式：**

1.  **利用createRemoteAppwebSession.php 创建初始会话:** 通过构造包含命令注入Payload的POST请求发送到`/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`，其中`X-PAN-AUTHCHECK` header设置为 `off`，并在`user`字段中注入恶意命令。该请求会将命令执行的结果写入`/var/appweb/htdocs/unauth/watchTowr.php`。
2.  **触发命令执行:**  利用index.php页面来触发执行`/var/appweb/htdocs/unauth/watchTowr.php`中的命令。

**投毒风险分析:**
代码本身是漏洞利用的PoC，实现了利用漏洞执行命令的功能。
*   PoC 中有向`/var/appweb/htdocs/unauth/`写入php文件的操作，如果服务器本身存在文件写入的权限问题，可能导致扩大攻击面。
*   PoC允许执行任意命令，如果攻击者在`--command`或者`--reverse-shell`中构造恶意的指令，可能会对目标造成更大的危害。
因此，存在一定的投毒风险，评估为10%。

**项目地址:** [0xjessie21/CVE-2024-0012](https://github.com/0xjessie21/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #2

**来源**: [CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md](../2024/CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** 高危，允许未授权的攻击者获取管理员权限，执行任意命令，篡改配置。

**影响版本:** 10.2, 11.0, 11.1, and 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 需要网络访问到 PAN-OS 管理 Web 界面，且管理界面可以从互联网或不受信任的网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能够访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或利用其他经过身份验证的提权漏洞，例如 CVE-2024-9474。

**漏洞利用方式：**

1.  **会话创建：**  攻击者首先发送一个特制的 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map` 路径，其中包含一个命令注入payload，这个payload的作用是向`/var/appweb/htdocs/unauth/watchTowr.php`写入系统信息。此请求设置 `X-PAN-AUTHCHECK: off` 头部，绕过身份验证检查。如果成功，服务器会返回一个 PHPSESSID cookie。
2.  **命令执行触发：**  攻击者使用获得的 PHPSESSID cookie 发送一个 GET 请求到 `/index.php/.js.map` 路径，同样设置 `X-PAN-AUTHCHECK: off` 头部。这个请求会触发之前注入的命令的执行。
3.  **执行验证：**  攻击者通过访问 `/unauth/watchTowr.php` 路径来验证命令是否成功执行。如果该文件存在且包含预期的系统信息，则表明漏洞利用成功。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的利用是有效的。漏洞库中明确指出存在针对该漏洞的威胁活动。POC 代码的实现方式与 WatchTowr Labs 的分析报告相符，进一步证实了其有效性。CISA 将该漏洞添加到了已知被利用的漏洞目录中，表明该漏洞正在被积极利用。

**投毒风险评估：**

该 POC 代码本身旨在利用漏洞，将 `uname -a` 命令的输出写入一个 Web 可访问的文件。虽然此操作本身具有一定的风险，因为它允许未经身份验证的访问者查看系统信息，但该 POC 代码的主要目的是验证漏洞的存在。代码本身较为简短，主要功能集中在利用漏洞上，不包含明显的恶意代码或者后门。投毒风险较低，估计为 1%。如果使用者不仔细审查，直接使用，可能会暴露一些系统信息，但不会直接导致系统被完全控制，因此投毒风险较低。

**缓解措施：**

*   限制管理 Web 界面的访问，仅允许来自受信任的内部 IP 地址的访问。
*   升级到已修复漏洞的 PAN-OS 版本 (10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本)。
*   部署威胁防御签名（如果可用）以检测和阻止针对此漏洞的攻击（Threat IDs 95746, 95747, 95752, 95753, 95759, 和 95763）。

**项目地址:** [Sachinart/CVE-2024-0012-POC](https://github.com/Sachinart/CVE-2024-0012-POC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #3

**来源**: [CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md](../2024/CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md)

## CVE-2024-0012 & CVE-2024-9474 Palo Alto PAN-OS 身份验证绕过和命令执行

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过 + 命令执行

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (参考漏洞库信息)

**利用条件:** 需要网络访问 PAN-OS 管理 Web 界面，且管理界面暴露在不受信任的网络中（例如互联网）。 根据漏洞库信息，仅允许受信任的内部IP地址访问管理界面可大大降低风险。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞利用结合了 CVE-2024-0012（身份验证绕过）和 CVE-2024-9474（命令执行和权限提升）。

**利用方式：**

1.  **身份验证绕过 (CVE-2024-0012)：** 攻击者无需身份验证即可访问 PAN-OS 管理 Web 界面。
2.  **获取 PHPSESSID：**  攻击者通过发送特制的 POST 请求到 `createRemoteAppwebSession.php` 获取有效的 `PHPSESSID`。
3.  **命令注入 (CVE-2024-9474)：** 攻击者使用获得的 `PHPSESSID`，通过在 `user` 参数中注入 shell 命令，利用 `createRemoteAppwebSession.php` 执行任意命令。
4.  **反弹 Shell：** 攻击者构造一个反弹 shell 的 payload，该 payload 经过两次 Base64 编码。
5.  **分块上传：** 因为命令长度限制，payload 被分割成多个小块，然后通过多个 POST 请求上传到目标服务器，存储为临时文件。
6.  **组合 Payload：** 上传完成后，攻击者使用 shell 命令将这些小块文件组合成一个完整的文件 `enc.txt`。
7.  **双重解码：** 攻击者对 `enc.txt` 中的内容进行双重 Base64 解码，并将结果保存到 `shell.sh` 文件中。
8.  **执行 Shell：** 攻击者赋予 `shell.sh` 可执行权限并执行它，从而建立反弹 shell 连接到攻击者的监听器。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用。提供的 PoC 代码实现了漏洞利用的完整流程，包括身份验证绕过、命令注入和反弹 shell。因此，该PoC代码被认为是有效的。

**投毒风险：**

虽然PoC的主要功能是利用漏洞，但仍存在一定的投毒风险。

*   **临时文件残留：**  该PoC在目标系统上创建临时文件（`c_*.tmp`, `enc.txt`, `shell.sh`），如果利用失败或被中断，这些文件可能会残留，占用磁盘空间或泄露信息。
*   **命令执行风险：**  即使没有成功建立反弹 shell，PoC执行的中间命令可能对系统造成意外影响。
*   **依赖性问题：** 该PoC 依赖于目标系统上存在 `bash`，`base64`，`cat`，`echo`，`tr`，`chmod` 命令。 如果目标系统缺少这些命令,会导致POC 利用失败.

**投毒风险评估：**

该PoC的主要目的是进行漏洞利用，而非进行恶意破坏。 但也存在一定的风险。 投毒风险大概为10%。

**项目地址:** [TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC](https://github.com/TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #4

**来源**: [CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md](../2024/CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备的管理 Web 界面需要能通过网络访问。如果管理界面仅允许受信任的内部 IP 地址访问，风险将大大降低。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他已通过身份验证的权限提升漏洞（如 CVE-2024-9474）。

**漏洞利用方式：**

1.  攻击者发送特制的 HTTP 请求到目标 PAN-OS 设备的管理 Web 界面。
2.  该请求利用身份验证绕过漏洞，使攻击者无需有效凭据即可获得管理员权限。
3.  获得管理员权限后，攻击者可以执行任意命令，读取敏感信息，修改设备配置，甚至可能通过其他漏洞进一步入侵系统。

根据提供的漏洞利用代码 `exploit.py`，该 PoC 包含两种模式：扫描模式和利用模式。

*   **扫描模式：** 用于批量扫描目标 URL，检测是否存在 CVE-2024-0012 漏洞。它向 `/php/ztp_gate.php/.js.map` 发送 GET 请求，如果状态码为 200 且响应中包含 "Zero Touch Provisioning"，则判定存在漏洞。
*   **利用模式：** 允许攻击者在目标系统上执行任意命令。它通过向 `/php/utils/createRemoteAppwebSession.php/peppa.js.map` 发送 POST 请求，并在 `user` 参数中注入命令。然后，它尝试提取 `PHPSESSID`，并利用此会话 ID 访问受保护的页面。命令输出会被写入`/var/appweb/htdocs/unauth/{output_name}`，然后通过 GET 请求 `/unauth/{output_name}` 检索。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用，并且存在公开可用的 PoC，所以该 POC 代码具有有效性。

**投毒风险：**

该PoC代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **命令注入：** 利用模式允许执行任意命令，这意味着如果攻击者使用该 PoC 对目标系统进行攻击，他们可以安装后门、植入恶意软件，或进行其他恶意活动。
*   **未经验证的 PoC：** README.md 文件明确指出 “Untested POC”，这意味着代码可能存在未知的错误或缺陷，可能导致目标系统不稳定或崩溃。
*   **随机文件名：**PoC代码使用随机文件名存储命令输出，虽然在一定程度上防止了文件名冲突，但也可能被攻击者滥用，例如，通过生成大量随机文件来耗尽磁盘空间。

综合考虑，该 PoC 存在一定的投毒风险，大约占比 10%。用户应谨慎使用，并充分了解其潜在风险。

**修复建议：**

*   升级到 PAN-OS 10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本。
*   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
*   如果启用了威胁防御订阅，请启用并配置相关的威胁 ID (95746, 95747, 95752, 95753, 95759, 和 95763) 以阻止利用此漏洞的攻击。

**项目地址:** [VegetableLasagne/CVE-2024-0012](https://github.com/VegetableLasagne/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #5

**来源**: [CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md](../2024/CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (详见漏洞库信息)

**利用条件:** 目标PAN-OS管理Web界面可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果可以访问管理 Web 界面，便能够获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他需要身份验证的提权漏洞，例如 CVE-2024-9474。\n\n**有效性：**\n根据搜索结果和漏洞库信息，该漏洞已经被积极利用。漏洞库信息中的 "exploits" 字段显示 Palo Alto Networks 观察到利用此漏洞的威胁活动。多个搜索结果（例如，Arctic Wolf 的博客文章）也证实了该漏洞正在被利用。因此，利用代码的有效性很高。\n\n**投毒风险：**\n提供的漏洞利用代码仅为 Apache License 2.0 许可协议的文本。它本身不是可执行代码，因此不存在投毒风险。投毒风险为0%。\n\n**利用方式：**\n1.  **访问管理Web界面：** 攻击者需要能够通过网络访问目标 PAN-OS 设备的管理 Web 界面。\n2.  **身份验证绕过：** 利用漏洞绕过身份验证机制。根据漏洞信息，可能涉及发送特制的 HTTP 请求或利用身份验证过程中的缺陷。具体绕过方法需要根据完整的PoC来分析，这里仅有license文件，无法推断。\n3.  **获取管理员权限：** 成功绕过身份验证后，攻击者将获得 PAN-OS 管理员权限。\n4.  **执行恶意操作：** 获得管理员权限后，攻击者可以执行各种恶意操作，包括：\n    *   执行任意命令。\n    *   篡改防火墙配置。\n    *   利用其他漏洞进一步攻击。\n\n**缓解措施：**\n*   限制管理界面访问：根据 Palo Alto Networks 的最佳实践指南，仅允许受信任的内部 IP 地址访问管理 Web 界面。\n*   应用威胁防御：如果拥有威胁防御订阅，可以使用威胁 ID 95746、95747、95752、95753、95759 和 95763 阻止攻击。\n*   及时更新：升级到已修复此漏洞的 PAN-OS 版本 (10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本)。

**项目地址:** [XiaomingX/cve-2024-0012-poc](https://github.com/XiaomingX/cve-2024-0012-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #6

**来源**: [CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md](../2024/CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用（如CVE-2024-9474）

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 (受影响版本低于已修复版本)

**利用条件:** 需要网络访问目标PAN-OS设备的管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012是Palo Alto Networks PAN-OS软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理Web界面，可以获取PAN-OS管理员权限，执行管理操作，篡改配置或利用其他身份验证的权限提升漏洞。根据漏洞描述和搜索结果，该漏洞影响特定版本的PAN-OS，且存在在野利用。提供的POC代码（`cve-2024-0012-gui.py`）利用了此漏洞。利用方式如下：

1.  **创建初始会话：**  通过`createRemoteAppwebSession.php`端点，设置`X-PAN-AUTHCHECK`为`off`，并且在POST数据中，将`user`参数设置为包含命令注入的恶意代码。攻击者可以通过这个方式在目标机器上写入一个PHP文件，例如`cve.php`。命令通过反引号执行，将结果写入PHP文件。
2.  **触发执行：**  使用创建的`PHPSESSID` cookie，访问`/index.php/.js.map`端点，触发之前注入的命令执行。
3.  **验证执行：**  访问`/unauth/cve.php`，检查命令是否成功执行，并获取命令输出。

**投毒风险分析：**

查看`cve-2024-0012-gui.py`脚本，发现其主要功能是利用漏洞进行命令注入和验证，基本符合漏洞利用的逻辑。`self.command_input = QLineEdit()` 允许用户输入命令，增加了灵活性，但也引入了一定的风险，使用者可能使用恶意命令。但是从代码逻辑上，此仓库直接投毒的可能性较低。`README.md`文件仅包含漏洞描述和作者信息，无恶意代码。

总而言之，考虑到代码的开源性质，以及主要功能符合漏洞利用的预期，投毒的概率较低，但是命令的执行权交给了用户，如果用户使用了恶意命令，也可能造成危害。因此投毒风险评估为10%。

**项目地址:** [dcollaoa/cve-2024-0012-gui-poc](https://github.com/dcollaoa/cve-2024-0012-gui-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #7

**来源**: [CVE-2024-0012-greaselovely_CVE-2024-0012.md](../2024/CVE-2024-0012-greaselovely_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** Critical, allows unauthenticated remote attackers to gain administrator privileges.

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 software before the fixed versions.

**利用条件:** The management web interface must be accessible over the network, especially from the internet.

**POC 可用性:** Yes

**投毒风险:** 10%

## 详情

CVE-2024-0012 is an authentication bypass vulnerability in Palo Alto Networks PAN-OS. An unauthenticated attacker with network access to the management web interface can gain PAN-OS administrator privileges. 

**有效性：**
根据漏洞库信息、搜索引擎结果（尤其是来自Palo Alto Networks自身以及Arctic Wolf等安全公司的报告）以及提供的PoC代码，此漏洞是真实且已被利用的。PoC代码通过检查特定URL的响应状态码、Header以及页面内容是否包含`Zero Touch Provisioning`和`window.Pan`等特征字符串来判断目标是否存在漏洞，表明PoC的有效性。

**投毒风险：**
PoC代码主要用于检测漏洞是否存在，其本身功能相对简单，未发现明显的恶意代码。代码中使用的`requests`库可能存在潜在风险，如果被替换为恶意版本，可能导致信息泄露或代码执行。LICENSE文件采用MIT开源协议，允许修改和再分发，这也会增加潜在的投毒风险。考虑到requests库的潜在风险和开源协议的开放性，投毒风险评定为10%。

**利用方式：**
1.  **网络访问:** 攻击者需要能够通过网络访问目标Palo Alto Networks设备的管理Web界面。
2.  **漏洞触发:** 攻击者发送特制的HTTP请求到目标设备的管理Web界面，绕过身份验证。
3.  **权限提升:** 成功绕过身份验证后，攻击者获得PAN-OS管理员权限，可以执行任意管理操作，篡改配置或利用其他漏洞。
4. **后续利用:** 可能会结合 CVE-2024-9474 进一步利用， 执行任意命令。

**项目地址:** [greaselovely/CVE-2024-0012](https://github.com/greaselovely/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #8

**来源**: [CVE-2024-0012-iSee857_CVE-2024-0012-poc.md](../2024/CVE-2024-0012-iSee857_CVE-2024-0012-poc.md)

# CVE-2024-0012

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0012-0xjessie21_CVE-2024-0012.md](../2024/CVE-2024-0012-0xjessie21_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，未经身份验证的攻击者可以获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 11.2受影响版本

**利用条件:** 需要网络可以访问PAN-OS管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果具有对管理 Web 界面的网络访问权限，则可以获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他经过身份验证的权限提升漏洞。根据搜索结果和漏洞描述，该漏洞的风险在于允许未经授权的访问和控制。漏洞利用代码通过构造特定的HTTP请求绕过身份验证，然后在目标系统上执行任意命令。由于攻击者可以执行任意命令，因此存在植入后门的风险。 

**漏洞利用方式：**

1.  **利用createRemoteAppwebSession.php 创建初始会话:** 通过构造包含命令注入Payload的POST请求发送到`/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`，其中`X-PAN-AUTHCHECK` header设置为 `off`，并在`user`字段中注入恶意命令。该请求会将命令执行的结果写入`/var/appweb/htdocs/unauth/watchTowr.php`。
2.  **触发命令执行:**  利用index.php页面来触发执行`/var/appweb/htdocs/unauth/watchTowr.php`中的命令。

**投毒风险分析:**
代码本身是漏洞利用的PoC，实现了利用漏洞执行命令的功能。
*   PoC 中有向`/var/appweb/htdocs/unauth/`写入php文件的操作，如果服务器本身存在文件写入的权限问题，可能导致扩大攻击面。
*   PoC允许执行任意命令，如果攻击者在`--command`或者`--reverse-shell`中构造恶意的指令，可能会对目标造成更大的危害。
因此，存在一定的投毒风险，评估为10%。

**项目地址:** [0xjessie21/CVE-2024-0012](https://github.com/0xjessie21/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #2

**来源**: [CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md](../2024/CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** 高危，允许未授权的攻击者获取管理员权限，执行任意命令，篡改配置。

**影响版本:** 10.2, 11.0, 11.1, and 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 需要网络访问到 PAN-OS 管理 Web 界面，且管理界面可以从互联网或不受信任的网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能够访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或利用其他经过身份验证的提权漏洞，例如 CVE-2024-9474。

**漏洞利用方式：**

1.  **会话创建：**  攻击者首先发送一个特制的 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map` 路径，其中包含一个命令注入payload，这个payload的作用是向`/var/appweb/htdocs/unauth/watchTowr.php`写入系统信息。此请求设置 `X-PAN-AUTHCHECK: off` 头部，绕过身份验证检查。如果成功，服务器会返回一个 PHPSESSID cookie。
2.  **命令执行触发：**  攻击者使用获得的 PHPSESSID cookie 发送一个 GET 请求到 `/index.php/.js.map` 路径，同样设置 `X-PAN-AUTHCHECK: off` 头部。这个请求会触发之前注入的命令的执行。
3.  **执行验证：**  攻击者通过访问 `/unauth/watchTowr.php` 路径来验证命令是否成功执行。如果该文件存在且包含预期的系统信息，则表明漏洞利用成功。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的利用是有效的。漏洞库中明确指出存在针对该漏洞的威胁活动。POC 代码的实现方式与 WatchTowr Labs 的分析报告相符，进一步证实了其有效性。CISA 将该漏洞添加到了已知被利用的漏洞目录中，表明该漏洞正在被积极利用。

**投毒风险评估：**

该 POC 代码本身旨在利用漏洞，将 `uname -a` 命令的输出写入一个 Web 可访问的文件。虽然此操作本身具有一定的风险，因为它允许未经身份验证的访问者查看系统信息，但该 POC 代码的主要目的是验证漏洞的存在。代码本身较为简短，主要功能集中在利用漏洞上，不包含明显的恶意代码或者后门。投毒风险较低，估计为 1%。如果使用者不仔细审查，直接使用，可能会暴露一些系统信息，但不会直接导致系统被完全控制，因此投毒风险较低。

**缓解措施：**

*   限制管理 Web 界面的访问，仅允许来自受信任的内部 IP 地址的访问。
*   升级到已修复漏洞的 PAN-OS 版本 (10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本)。
*   部署威胁防御签名（如果可用）以检测和阻止针对此漏洞的攻击（Threat IDs 95746, 95747, 95752, 95753, 95759, 和 95763）。

**项目地址:** [Sachinart/CVE-2024-0012-POC](https://github.com/Sachinart/CVE-2024-0012-POC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #3

**来源**: [CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md](../2024/CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md)

## CVE-2024-0012 & CVE-2024-9474 Palo Alto PAN-OS 身份验证绕过和命令执行

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过 + 命令执行

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (参考漏洞库信息)

**利用条件:** 需要网络访问 PAN-OS 管理 Web 界面，且管理界面暴露在不受信任的网络中（例如互联网）。 根据漏洞库信息，仅允许受信任的内部IP地址访问管理界面可大大降低风险。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞利用结合了 CVE-2024-0012（身份验证绕过）和 CVE-2024-9474（命令执行和权限提升）。

**利用方式：**

1.  **身份验证绕过 (CVE-2024-0012)：** 攻击者无需身份验证即可访问 PAN-OS 管理 Web 界面。
2.  **获取 PHPSESSID：**  攻击者通过发送特制的 POST 请求到 `createRemoteAppwebSession.php` 获取有效的 `PHPSESSID`。
3.  **命令注入 (CVE-2024-9474)：** 攻击者使用获得的 `PHPSESSID`，通过在 `user` 参数中注入 shell 命令，利用 `createRemoteAppwebSession.php` 执行任意命令。
4.  **反弹 Shell：** 攻击者构造一个反弹 shell 的 payload，该 payload 经过两次 Base64 编码。
5.  **分块上传：** 因为命令长度限制，payload 被分割成多个小块，然后通过多个 POST 请求上传到目标服务器，存储为临时文件。
6.  **组合 Payload：** 上传完成后，攻击者使用 shell 命令将这些小块文件组合成一个完整的文件 `enc.txt`。
7.  **双重解码：** 攻击者对 `enc.txt` 中的内容进行双重 Base64 解码，并将结果保存到 `shell.sh` 文件中。
8.  **执行 Shell：** 攻击者赋予 `shell.sh` 可执行权限并执行它，从而建立反弹 shell 连接到攻击者的监听器。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用。提供的 PoC 代码实现了漏洞利用的完整流程，包括身份验证绕过、命令注入和反弹 shell。因此，该PoC代码被认为是有效的。

**投毒风险：**

虽然PoC的主要功能是利用漏洞，但仍存在一定的投毒风险。

*   **临时文件残留：**  该PoC在目标系统上创建临时文件（`c_*.tmp`, `enc.txt`, `shell.sh`），如果利用失败或被中断，这些文件可能会残留，占用磁盘空间或泄露信息。
*   **命令执行风险：**  即使没有成功建立反弹 shell，PoC执行的中间命令可能对系统造成意外影响。
*   **依赖性问题：** 该PoC 依赖于目标系统上存在 `bash`，`base64`，`cat`，`echo`，`tr`，`chmod` 命令。 如果目标系统缺少这些命令,会导致POC 利用失败.

**投毒风险评估：**

该PoC的主要目的是进行漏洞利用，而非进行恶意破坏。 但也存在一定的风险。 投毒风险大概为10%。

**项目地址:** [TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC](https://github.com/TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #4

**来源**: [CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md](../2024/CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备的管理 Web 界面需要能通过网络访问。如果管理界面仅允许受信任的内部 IP 地址访问，风险将大大降低。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他已通过身份验证的权限提升漏洞（如 CVE-2024-9474）。

**漏洞利用方式：**

1.  攻击者发送特制的 HTTP 请求到目标 PAN-OS 设备的管理 Web 界面。
2.  该请求利用身份验证绕过漏洞，使攻击者无需有效凭据即可获得管理员权限。
3.  获得管理员权限后，攻击者可以执行任意命令，读取敏感信息，修改设备配置，甚至可能通过其他漏洞进一步入侵系统。

根据提供的漏洞利用代码 `exploit.py`，该 PoC 包含两种模式：扫描模式和利用模式。

*   **扫描模式：** 用于批量扫描目标 URL，检测是否存在 CVE-2024-0012 漏洞。它向 `/php/ztp_gate.php/.js.map` 发送 GET 请求，如果状态码为 200 且响应中包含 "Zero Touch Provisioning"，则判定存在漏洞。
*   **利用模式：** 允许攻击者在目标系统上执行任意命令。它通过向 `/php/utils/createRemoteAppwebSession.php/peppa.js.map` 发送 POST 请求，并在 `user` 参数中注入命令。然后，它尝试提取 `PHPSESSID`，并利用此会话 ID 访问受保护的页面。命令输出会被写入`/var/appweb/htdocs/unauth/{output_name}`，然后通过 GET 请求 `/unauth/{output_name}` 检索。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用，并且存在公开可用的 PoC，所以该 POC 代码具有有效性。

**投毒风险：**

该PoC代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **命令注入：** 利用模式允许执行任意命令，这意味着如果攻击者使用该 PoC 对目标系统进行攻击，他们可以安装后门、植入恶意软件，或进行其他恶意活动。
*   **未经验证的 PoC：** README.md 文件明确指出 “Untested POC”，这意味着代码可能存在未知的错误或缺陷，可能导致目标系统不稳定或崩溃。
*   **随机文件名：**PoC代码使用随机文件名存储命令输出，虽然在一定程度上防止了文件名冲突，但也可能被攻击者滥用，例如，通过生成大量随机文件来耗尽磁盘空间。

综合考虑，该 PoC 存在一定的投毒风险，大约占比 10%。用户应谨慎使用，并充分了解其潜在风险。

**修复建议：**

*   升级到 PAN-OS 10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本。
*   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
*   如果启用了威胁防御订阅，请启用并配置相关的威胁 ID (95746, 95747, 95752, 95753, 95759, 和 95763) 以阻止利用此漏洞的攻击。

**项目地址:** [VegetableLasagne/CVE-2024-0012](https://github.com/VegetableLasagne/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #5

**来源**: [CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md](../2024/CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (详见漏洞库信息)

**利用条件:** 目标PAN-OS管理Web界面可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果可以访问管理 Web 界面，便能够获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他需要身份验证的提权漏洞，例如 CVE-2024-9474。\n\n**有效性：**\n根据搜索结果和漏洞库信息，该漏洞已经被积极利用。漏洞库信息中的 "exploits" 字段显示 Palo Alto Networks 观察到利用此漏洞的威胁活动。多个搜索结果（例如，Arctic Wolf 的博客文章）也证实了该漏洞正在被利用。因此，利用代码的有效性很高。\n\n**投毒风险：**\n提供的漏洞利用代码仅为 Apache License 2.0 许可协议的文本。它本身不是可执行代码，因此不存在投毒风险。投毒风险为0%。\n\n**利用方式：**\n1.  **访问管理Web界面：** 攻击者需要能够通过网络访问目标 PAN-OS 设备的管理 Web 界面。\n2.  **身份验证绕过：** 利用漏洞绕过身份验证机制。根据漏洞信息，可能涉及发送特制的 HTTP 请求或利用身份验证过程中的缺陷。具体绕过方法需要根据完整的PoC来分析，这里仅有license文件，无法推断。\n3.  **获取管理员权限：** 成功绕过身份验证后，攻击者将获得 PAN-OS 管理员权限。\n4.  **执行恶意操作：** 获得管理员权限后，攻击者可以执行各种恶意操作，包括：\n    *   执行任意命令。\n    *   篡改防火墙配置。\n    *   利用其他漏洞进一步攻击。\n\n**缓解措施：**\n*   限制管理界面访问：根据 Palo Alto Networks 的最佳实践指南，仅允许受信任的内部 IP 地址访问管理 Web 界面。\n*   应用威胁防御：如果拥有威胁防御订阅，可以使用威胁 ID 95746、95747、95752、95753、95759 和 95763 阻止攻击。\n*   及时更新：升级到已修复此漏洞的 PAN-OS 版本 (10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本)。

**项目地址:** [XiaomingX/cve-2024-0012-poc](https://github.com/XiaomingX/cve-2024-0012-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #6

**来源**: [CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md](../2024/CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用（如CVE-2024-9474）

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 (受影响版本低于已修复版本)

**利用条件:** 需要网络访问目标PAN-OS设备的管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012是Palo Alto Networks PAN-OS软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理Web界面，可以获取PAN-OS管理员权限，执行管理操作，篡改配置或利用其他身份验证的权限提升漏洞。根据漏洞描述和搜索结果，该漏洞影响特定版本的PAN-OS，且存在在野利用。提供的POC代码（`cve-2024-0012-gui.py`）利用了此漏洞。利用方式如下：

1.  **创建初始会话：**  通过`createRemoteAppwebSession.php`端点，设置`X-PAN-AUTHCHECK`为`off`，并且在POST数据中，将`user`参数设置为包含命令注入的恶意代码。攻击者可以通过这个方式在目标机器上写入一个PHP文件，例如`cve.php`。命令通过反引号执行，将结果写入PHP文件。
2.  **触发执行：**  使用创建的`PHPSESSID` cookie，访问`/index.php/.js.map`端点，触发之前注入的命令执行。
3.  **验证执行：**  访问`/unauth/cve.php`，检查命令是否成功执行，并获取命令输出。

**投毒风险分析：**

查看`cve-2024-0012-gui.py`脚本，发现其主要功能是利用漏洞进行命令注入和验证，基本符合漏洞利用的逻辑。`self.command_input = QLineEdit()` 允许用户输入命令，增加了灵活性，但也引入了一定的风险，使用者可能使用恶意命令。但是从代码逻辑上，此仓库直接投毒的可能性较低。`README.md`文件仅包含漏洞描述和作者信息，无恶意代码。

总而言之，考虑到代码的开源性质，以及主要功能符合漏洞利用的预期，投毒的概率较低，但是命令的执行权交给了用户，如果用户使用了恶意命令，也可能造成危害。因此投毒风险评估为10%。

**项目地址:** [dcollaoa/cve-2024-0012-gui-poc](https://github.com/dcollaoa/cve-2024-0012-gui-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #7

**来源**: [CVE-2024-0012-greaselovely_CVE-2024-0012.md](../2024/CVE-2024-0012-greaselovely_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** Critical, allows unauthenticated remote attackers to gain administrator privileges.

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 software before the fixed versions.

**利用条件:** The management web interface must be accessible over the network, especially from the internet.

**POC 可用性:** Yes

**投毒风险:** 10%

## 详情

CVE-2024-0012 is an authentication bypass vulnerability in Palo Alto Networks PAN-OS. An unauthenticated attacker with network access to the management web interface can gain PAN-OS administrator privileges. 

**有效性：**
根据漏洞库信息、搜索引擎结果（尤其是来自Palo Alto Networks自身以及Arctic Wolf等安全公司的报告）以及提供的PoC代码，此漏洞是真实且已被利用的。PoC代码通过检查特定URL的响应状态码、Header以及页面内容是否包含`Zero Touch Provisioning`和`window.Pan`等特征字符串来判断目标是否存在漏洞，表明PoC的有效性。

**投毒风险：**
PoC代码主要用于检测漏洞是否存在，其本身功能相对简单，未发现明显的恶意代码。代码中使用的`requests`库可能存在潜在风险，如果被替换为恶意版本，可能导致信息泄露或代码执行。LICENSE文件采用MIT开源协议，允许修改和再分发，这也会增加潜在的投毒风险。考虑到requests库的潜在风险和开源协议的开放性，投毒风险评定为10%。

**利用方式：**
1.  **网络访问:** 攻击者需要能够通过网络访问目标Palo Alto Networks设备的管理Web界面。
2.  **漏洞触发:** 攻击者发送特制的HTTP请求到目标设备的管理Web界面，绕过身份验证。
3.  **权限提升:** 成功绕过身份验证后，攻击者获得PAN-OS管理员权限，可以执行任意管理操作，篡改配置或利用其他漏洞。
4. **后续利用:** 可能会结合 CVE-2024-9474 进一步利用， 执行任意命令。

**项目地址:** [greaselovely/CVE-2024-0012](https://github.com/greaselovely/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #8

**来源**: [CVE-2024-0012-iSee857_CVE-2024-0012-poc.md](../2024/CVE-2024-0012-iSee857_CVE-2024-0012-poc.md)

# CVE-2024-0012

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0012-0xjessie21_CVE-2024-0012.md](../2024/CVE-2024-0012-0xjessie21_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，未经身份验证的攻击者可以获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 11.2受影响版本

**利用条件:** 需要网络可以访问PAN-OS管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果具有对管理 Web 界面的网络访问权限，则可以获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他经过身份验证的权限提升漏洞。根据搜索结果和漏洞描述，该漏洞的风险在于允许未经授权的访问和控制。漏洞利用代码通过构造特定的HTTP请求绕过身份验证，然后在目标系统上执行任意命令。由于攻击者可以执行任意命令，因此存在植入后门的风险。 

**漏洞利用方式：**

1.  **利用createRemoteAppwebSession.php 创建初始会话:** 通过构造包含命令注入Payload的POST请求发送到`/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`，其中`X-PAN-AUTHCHECK` header设置为 `off`，并在`user`字段中注入恶意命令。该请求会将命令执行的结果写入`/var/appweb/htdocs/unauth/watchTowr.php`。
2.  **触发命令执行:**  利用index.php页面来触发执行`/var/appweb/htdocs/unauth/watchTowr.php`中的命令。

**投毒风险分析:**
代码本身是漏洞利用的PoC，实现了利用漏洞执行命令的功能。
*   PoC 中有向`/var/appweb/htdocs/unauth/`写入php文件的操作，如果服务器本身存在文件写入的权限问题，可能导致扩大攻击面。
*   PoC允许执行任意命令，如果攻击者在`--command`或者`--reverse-shell`中构造恶意的指令，可能会对目标造成更大的危害。
因此，存在一定的投毒风险，评估为10%。

**项目地址:** [0xjessie21/CVE-2024-0012](https://github.com/0xjessie21/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #2

**来源**: [CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md](../2024/CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** 高危，允许未授权的攻击者获取管理员权限，执行任意命令，篡改配置。

**影响版本:** 10.2, 11.0, 11.1, and 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 需要网络访问到 PAN-OS 管理 Web 界面，且管理界面可以从互联网或不受信任的网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能够访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或利用其他经过身份验证的提权漏洞，例如 CVE-2024-9474。

**漏洞利用方式：**

1.  **会话创建：**  攻击者首先发送一个特制的 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map` 路径，其中包含一个命令注入payload，这个payload的作用是向`/var/appweb/htdocs/unauth/watchTowr.php`写入系统信息。此请求设置 `X-PAN-AUTHCHECK: off` 头部，绕过身份验证检查。如果成功，服务器会返回一个 PHPSESSID cookie。
2.  **命令执行触发：**  攻击者使用获得的 PHPSESSID cookie 发送一个 GET 请求到 `/index.php/.js.map` 路径，同样设置 `X-PAN-AUTHCHECK: off` 头部。这个请求会触发之前注入的命令的执行。
3.  **执行验证：**  攻击者通过访问 `/unauth/watchTowr.php` 路径来验证命令是否成功执行。如果该文件存在且包含预期的系统信息，则表明漏洞利用成功。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的利用是有效的。漏洞库中明确指出存在针对该漏洞的威胁活动。POC 代码的实现方式与 WatchTowr Labs 的分析报告相符，进一步证实了其有效性。CISA 将该漏洞添加到了已知被利用的漏洞目录中，表明该漏洞正在被积极利用。

**投毒风险评估：**

该 POC 代码本身旨在利用漏洞，将 `uname -a` 命令的输出写入一个 Web 可访问的文件。虽然此操作本身具有一定的风险，因为它允许未经身份验证的访问者查看系统信息，但该 POC 代码的主要目的是验证漏洞的存在。代码本身较为简短，主要功能集中在利用漏洞上，不包含明显的恶意代码或者后门。投毒风险较低，估计为 1%。如果使用者不仔细审查，直接使用，可能会暴露一些系统信息，但不会直接导致系统被完全控制，因此投毒风险较低。

**缓解措施：**

*   限制管理 Web 界面的访问，仅允许来自受信任的内部 IP 地址的访问。
*   升级到已修复漏洞的 PAN-OS 版本 (10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本)。
*   部署威胁防御签名（如果可用）以检测和阻止针对此漏洞的攻击（Threat IDs 95746, 95747, 95752, 95753, 95759, 和 95763）。

**项目地址:** [Sachinart/CVE-2024-0012-POC](https://github.com/Sachinart/CVE-2024-0012-POC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #3

**来源**: [CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md](../2024/CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md)

## CVE-2024-0012 & CVE-2024-9474 Palo Alto PAN-OS 身份验证绕过和命令执行

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过 + 命令执行

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (参考漏洞库信息)

**利用条件:** 需要网络访问 PAN-OS 管理 Web 界面，且管理界面暴露在不受信任的网络中（例如互联网）。 根据漏洞库信息，仅允许受信任的内部IP地址访问管理界面可大大降低风险。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞利用结合了 CVE-2024-0012（身份验证绕过）和 CVE-2024-9474（命令执行和权限提升）。

**利用方式：**

1.  **身份验证绕过 (CVE-2024-0012)：** 攻击者无需身份验证即可访问 PAN-OS 管理 Web 界面。
2.  **获取 PHPSESSID：**  攻击者通过发送特制的 POST 请求到 `createRemoteAppwebSession.php` 获取有效的 `PHPSESSID`。
3.  **命令注入 (CVE-2024-9474)：** 攻击者使用获得的 `PHPSESSID`，通过在 `user` 参数中注入 shell 命令，利用 `createRemoteAppwebSession.php` 执行任意命令。
4.  **反弹 Shell：** 攻击者构造一个反弹 shell 的 payload，该 payload 经过两次 Base64 编码。
5.  **分块上传：** 因为命令长度限制，payload 被分割成多个小块，然后通过多个 POST 请求上传到目标服务器，存储为临时文件。
6.  **组合 Payload：** 上传完成后，攻击者使用 shell 命令将这些小块文件组合成一个完整的文件 `enc.txt`。
7.  **双重解码：** 攻击者对 `enc.txt` 中的内容进行双重 Base64 解码，并将结果保存到 `shell.sh` 文件中。
8.  **执行 Shell：** 攻击者赋予 `shell.sh` 可执行权限并执行它，从而建立反弹 shell 连接到攻击者的监听器。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用。提供的 PoC 代码实现了漏洞利用的完整流程，包括身份验证绕过、命令注入和反弹 shell。因此，该PoC代码被认为是有效的。

**投毒风险：**

虽然PoC的主要功能是利用漏洞，但仍存在一定的投毒风险。

*   **临时文件残留：**  该PoC在目标系统上创建临时文件（`c_*.tmp`, `enc.txt`, `shell.sh`），如果利用失败或被中断，这些文件可能会残留，占用磁盘空间或泄露信息。
*   **命令执行风险：**  即使没有成功建立反弹 shell，PoC执行的中间命令可能对系统造成意外影响。
*   **依赖性问题：** 该PoC 依赖于目标系统上存在 `bash`，`base64`，`cat`，`echo`，`tr`，`chmod` 命令。 如果目标系统缺少这些命令,会导致POC 利用失败.

**投毒风险评估：**

该PoC的主要目的是进行漏洞利用，而非进行恶意破坏。 但也存在一定的风险。 投毒风险大概为10%。

**项目地址:** [TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC](https://github.com/TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #4

**来源**: [CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md](../2024/CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备的管理 Web 界面需要能通过网络访问。如果管理界面仅允许受信任的内部 IP 地址访问，风险将大大降低。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他已通过身份验证的权限提升漏洞（如 CVE-2024-9474）。

**漏洞利用方式：**

1.  攻击者发送特制的 HTTP 请求到目标 PAN-OS 设备的管理 Web 界面。
2.  该请求利用身份验证绕过漏洞，使攻击者无需有效凭据即可获得管理员权限。
3.  获得管理员权限后，攻击者可以执行任意命令，读取敏感信息，修改设备配置，甚至可能通过其他漏洞进一步入侵系统。

根据提供的漏洞利用代码 `exploit.py`，该 PoC 包含两种模式：扫描模式和利用模式。

*   **扫描模式：** 用于批量扫描目标 URL，检测是否存在 CVE-2024-0012 漏洞。它向 `/php/ztp_gate.php/.js.map` 发送 GET 请求，如果状态码为 200 且响应中包含 "Zero Touch Provisioning"，则判定存在漏洞。
*   **利用模式：** 允许攻击者在目标系统上执行任意命令。它通过向 `/php/utils/createRemoteAppwebSession.php/peppa.js.map` 发送 POST 请求，并在 `user` 参数中注入命令。然后，它尝试提取 `PHPSESSID`，并利用此会话 ID 访问受保护的页面。命令输出会被写入`/var/appweb/htdocs/unauth/{output_name}`，然后通过 GET 请求 `/unauth/{output_name}` 检索。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用，并且存在公开可用的 PoC，所以该 POC 代码具有有效性。

**投毒风险：**

该PoC代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **命令注入：** 利用模式允许执行任意命令，这意味着如果攻击者使用该 PoC 对目标系统进行攻击，他们可以安装后门、植入恶意软件，或进行其他恶意活动。
*   **未经验证的 PoC：** README.md 文件明确指出 “Untested POC”，这意味着代码可能存在未知的错误或缺陷，可能导致目标系统不稳定或崩溃。
*   **随机文件名：**PoC代码使用随机文件名存储命令输出，虽然在一定程度上防止了文件名冲突，但也可能被攻击者滥用，例如，通过生成大量随机文件来耗尽磁盘空间。

综合考虑，该 PoC 存在一定的投毒风险，大约占比 10%。用户应谨慎使用，并充分了解其潜在风险。

**修复建议：**

*   升级到 PAN-OS 10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本。
*   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
*   如果启用了威胁防御订阅，请启用并配置相关的威胁 ID (95746, 95747, 95752, 95753, 95759, 和 95763) 以阻止利用此漏洞的攻击。

**项目地址:** [VegetableLasagne/CVE-2024-0012](https://github.com/VegetableLasagne/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #5

**来源**: [CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md](../2024/CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (详见漏洞库信息)

**利用条件:** 目标PAN-OS管理Web界面可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果可以访问管理 Web 界面，便能够获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他需要身份验证的提权漏洞，例如 CVE-2024-9474。\n\n**有效性：**\n根据搜索结果和漏洞库信息，该漏洞已经被积极利用。漏洞库信息中的 "exploits" 字段显示 Palo Alto Networks 观察到利用此漏洞的威胁活动。多个搜索结果（例如，Arctic Wolf 的博客文章）也证实了该漏洞正在被利用。因此，利用代码的有效性很高。\n\n**投毒风险：**\n提供的漏洞利用代码仅为 Apache License 2.0 许可协议的文本。它本身不是可执行代码，因此不存在投毒风险。投毒风险为0%。\n\n**利用方式：**\n1.  **访问管理Web界面：** 攻击者需要能够通过网络访问目标 PAN-OS 设备的管理 Web 界面。\n2.  **身份验证绕过：** 利用漏洞绕过身份验证机制。根据漏洞信息，可能涉及发送特制的 HTTP 请求或利用身份验证过程中的缺陷。具体绕过方法需要根据完整的PoC来分析，这里仅有license文件，无法推断。\n3.  **获取管理员权限：** 成功绕过身份验证后，攻击者将获得 PAN-OS 管理员权限。\n4.  **执行恶意操作：** 获得管理员权限后，攻击者可以执行各种恶意操作，包括：\n    *   执行任意命令。\n    *   篡改防火墙配置。\n    *   利用其他漏洞进一步攻击。\n\n**缓解措施：**\n*   限制管理界面访问：根据 Palo Alto Networks 的最佳实践指南，仅允许受信任的内部 IP 地址访问管理 Web 界面。\n*   应用威胁防御：如果拥有威胁防御订阅，可以使用威胁 ID 95746、95747、95752、95753、95759 和 95763 阻止攻击。\n*   及时更新：升级到已修复此漏洞的 PAN-OS 版本 (10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本)。

**项目地址:** [XiaomingX/cve-2024-0012-poc](https://github.com/XiaomingX/cve-2024-0012-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #6

**来源**: [CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md](../2024/CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用（如CVE-2024-9474）

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 (受影响版本低于已修复版本)

**利用条件:** 需要网络访问目标PAN-OS设备的管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012是Palo Alto Networks PAN-OS软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理Web界面，可以获取PAN-OS管理员权限，执行管理操作，篡改配置或利用其他身份验证的权限提升漏洞。根据漏洞描述和搜索结果，该漏洞影响特定版本的PAN-OS，且存在在野利用。提供的POC代码（`cve-2024-0012-gui.py`）利用了此漏洞。利用方式如下：

1.  **创建初始会话：**  通过`createRemoteAppwebSession.php`端点，设置`X-PAN-AUTHCHECK`为`off`，并且在POST数据中，将`user`参数设置为包含命令注入的恶意代码。攻击者可以通过这个方式在目标机器上写入一个PHP文件，例如`cve.php`。命令通过反引号执行，将结果写入PHP文件。
2.  **触发执行：**  使用创建的`PHPSESSID` cookie，访问`/index.php/.js.map`端点，触发之前注入的命令执行。
3.  **验证执行：**  访问`/unauth/cve.php`，检查命令是否成功执行，并获取命令输出。

**投毒风险分析：**

查看`cve-2024-0012-gui.py`脚本，发现其主要功能是利用漏洞进行命令注入和验证，基本符合漏洞利用的逻辑。`self.command_input = QLineEdit()` 允许用户输入命令，增加了灵活性，但也引入了一定的风险，使用者可能使用恶意命令。但是从代码逻辑上，此仓库直接投毒的可能性较低。`README.md`文件仅包含漏洞描述和作者信息，无恶意代码。

总而言之，考虑到代码的开源性质，以及主要功能符合漏洞利用的预期，投毒的概率较低，但是命令的执行权交给了用户，如果用户使用了恶意命令，也可能造成危害。因此投毒风险评估为10%。

**项目地址:** [dcollaoa/cve-2024-0012-gui-poc](https://github.com/dcollaoa/cve-2024-0012-gui-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #7

**来源**: [CVE-2024-0012-greaselovely_CVE-2024-0012.md](../2024/CVE-2024-0012-greaselovely_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** Critical, allows unauthenticated remote attackers to gain administrator privileges.

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 software before the fixed versions.

**利用条件:** The management web interface must be accessible over the network, especially from the internet.

**POC 可用性:** Yes

**投毒风险:** 10%

## 详情

CVE-2024-0012 is an authentication bypass vulnerability in Palo Alto Networks PAN-OS. An unauthenticated attacker with network access to the management web interface can gain PAN-OS administrator privileges. 

**有效性：**
根据漏洞库信息、搜索引擎结果（尤其是来自Palo Alto Networks自身以及Arctic Wolf等安全公司的报告）以及提供的PoC代码，此漏洞是真实且已被利用的。PoC代码通过检查特定URL的响应状态码、Header以及页面内容是否包含`Zero Touch Provisioning`和`window.Pan`等特征字符串来判断目标是否存在漏洞，表明PoC的有效性。

**投毒风险：**
PoC代码主要用于检测漏洞是否存在，其本身功能相对简单，未发现明显的恶意代码。代码中使用的`requests`库可能存在潜在风险，如果被替换为恶意版本，可能导致信息泄露或代码执行。LICENSE文件采用MIT开源协议，允许修改和再分发，这也会增加潜在的投毒风险。考虑到requests库的潜在风险和开源协议的开放性，投毒风险评定为10%。

**利用方式：**
1.  **网络访问:** 攻击者需要能够通过网络访问目标Palo Alto Networks设备的管理Web界面。
2.  **漏洞触发:** 攻击者发送特制的HTTP请求到目标设备的管理Web界面，绕过身份验证。
3.  **权限提升:** 成功绕过身份验证后，攻击者获得PAN-OS管理员权限，可以执行任意管理操作，篡改配置或利用其他漏洞。
4. **后续利用:** 可能会结合 CVE-2024-9474 进一步利用， 执行任意命令。

**项目地址:** [greaselovely/CVE-2024-0012](https://github.com/greaselovely/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #8

**来源**: [CVE-2024-0012-iSee857_CVE-2024-0012-poc.md](../2024/CVE-2024-0012-iSee857_CVE-2024-0012-poc.md)

# CVE-2024-0012

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0012-0xjessie21_CVE-2024-0012.md](../2024/CVE-2024-0012-0xjessie21_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，未经身份验证的攻击者可以获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 11.2受影响版本

**利用条件:** 需要网络可以访问PAN-OS管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果具有对管理 Web 界面的网络访问权限，则可以获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他经过身份验证的权限提升漏洞。根据搜索结果和漏洞描述，该漏洞的风险在于允许未经授权的访问和控制。漏洞利用代码通过构造特定的HTTP请求绕过身份验证，然后在目标系统上执行任意命令。由于攻击者可以执行任意命令，因此存在植入后门的风险。 

**漏洞利用方式：**

1.  **利用createRemoteAppwebSession.php 创建初始会话:** 通过构造包含命令注入Payload的POST请求发送到`/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`，其中`X-PAN-AUTHCHECK` header设置为 `off`，并在`user`字段中注入恶意命令。该请求会将命令执行的结果写入`/var/appweb/htdocs/unauth/watchTowr.php`。
2.  **触发命令执行:**  利用index.php页面来触发执行`/var/appweb/htdocs/unauth/watchTowr.php`中的命令。

**投毒风险分析:**
代码本身是漏洞利用的PoC，实现了利用漏洞执行命令的功能。
*   PoC 中有向`/var/appweb/htdocs/unauth/`写入php文件的操作，如果服务器本身存在文件写入的权限问题，可能导致扩大攻击面。
*   PoC允许执行任意命令，如果攻击者在`--command`或者`--reverse-shell`中构造恶意的指令，可能会对目标造成更大的危害。
因此，存在一定的投毒风险，评估为10%。

**项目地址:** [0xjessie21/CVE-2024-0012](https://github.com/0xjessie21/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #2

**来源**: [CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md](../2024/CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** 高危，允许未授权的攻击者获取管理员权限，执行任意命令，篡改配置。

**影响版本:** 10.2, 11.0, 11.1, and 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 需要网络访问到 PAN-OS 管理 Web 界面，且管理界面可以从互联网或不受信任的网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能够访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或利用其他经过身份验证的提权漏洞，例如 CVE-2024-9474。

**漏洞利用方式：**

1.  **会话创建：**  攻击者首先发送一个特制的 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map` 路径，其中包含一个命令注入payload，这个payload的作用是向`/var/appweb/htdocs/unauth/watchTowr.php`写入系统信息。此请求设置 `X-PAN-AUTHCHECK: off` 头部，绕过身份验证检查。如果成功，服务器会返回一个 PHPSESSID cookie。
2.  **命令执行触发：**  攻击者使用获得的 PHPSESSID cookie 发送一个 GET 请求到 `/index.php/.js.map` 路径，同样设置 `X-PAN-AUTHCHECK: off` 头部。这个请求会触发之前注入的命令的执行。
3.  **执行验证：**  攻击者通过访问 `/unauth/watchTowr.php` 路径来验证命令是否成功执行。如果该文件存在且包含预期的系统信息，则表明漏洞利用成功。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的利用是有效的。漏洞库中明确指出存在针对该漏洞的威胁活动。POC 代码的实现方式与 WatchTowr Labs 的分析报告相符，进一步证实了其有效性。CISA 将该漏洞添加到了已知被利用的漏洞目录中，表明该漏洞正在被积极利用。

**投毒风险评估：**

该 POC 代码本身旨在利用漏洞，将 `uname -a` 命令的输出写入一个 Web 可访问的文件。虽然此操作本身具有一定的风险，因为它允许未经身份验证的访问者查看系统信息，但该 POC 代码的主要目的是验证漏洞的存在。代码本身较为简短，主要功能集中在利用漏洞上，不包含明显的恶意代码或者后门。投毒风险较低，估计为 1%。如果使用者不仔细审查，直接使用，可能会暴露一些系统信息，但不会直接导致系统被完全控制，因此投毒风险较低。

**缓解措施：**

*   限制管理 Web 界面的访问，仅允许来自受信任的内部 IP 地址的访问。
*   升级到已修复漏洞的 PAN-OS 版本 (10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本)。
*   部署威胁防御签名（如果可用）以检测和阻止针对此漏洞的攻击（Threat IDs 95746, 95747, 95752, 95753, 95759, 和 95763）。

**项目地址:** [Sachinart/CVE-2024-0012-POC](https://github.com/Sachinart/CVE-2024-0012-POC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #3

**来源**: [CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md](../2024/CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md)

## CVE-2024-0012 & CVE-2024-9474 Palo Alto PAN-OS 身份验证绕过和命令执行

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过 + 命令执行

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (参考漏洞库信息)

**利用条件:** 需要网络访问 PAN-OS 管理 Web 界面，且管理界面暴露在不受信任的网络中（例如互联网）。 根据漏洞库信息，仅允许受信任的内部IP地址访问管理界面可大大降低风险。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞利用结合了 CVE-2024-0012（身份验证绕过）和 CVE-2024-9474（命令执行和权限提升）。

**利用方式：**

1.  **身份验证绕过 (CVE-2024-0012)：** 攻击者无需身份验证即可访问 PAN-OS 管理 Web 界面。
2.  **获取 PHPSESSID：**  攻击者通过发送特制的 POST 请求到 `createRemoteAppwebSession.php` 获取有效的 `PHPSESSID`。
3.  **命令注入 (CVE-2024-9474)：** 攻击者使用获得的 `PHPSESSID`，通过在 `user` 参数中注入 shell 命令，利用 `createRemoteAppwebSession.php` 执行任意命令。
4.  **反弹 Shell：** 攻击者构造一个反弹 shell 的 payload，该 payload 经过两次 Base64 编码。
5.  **分块上传：** 因为命令长度限制，payload 被分割成多个小块，然后通过多个 POST 请求上传到目标服务器，存储为临时文件。
6.  **组合 Payload：** 上传完成后，攻击者使用 shell 命令将这些小块文件组合成一个完整的文件 `enc.txt`。
7.  **双重解码：** 攻击者对 `enc.txt` 中的内容进行双重 Base64 解码，并将结果保存到 `shell.sh` 文件中。
8.  **执行 Shell：** 攻击者赋予 `shell.sh` 可执行权限并执行它，从而建立反弹 shell 连接到攻击者的监听器。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用。提供的 PoC 代码实现了漏洞利用的完整流程，包括身份验证绕过、命令注入和反弹 shell。因此，该PoC代码被认为是有效的。

**投毒风险：**

虽然PoC的主要功能是利用漏洞，但仍存在一定的投毒风险。

*   **临时文件残留：**  该PoC在目标系统上创建临时文件（`c_*.tmp`, `enc.txt`, `shell.sh`），如果利用失败或被中断，这些文件可能会残留，占用磁盘空间或泄露信息。
*   **命令执行风险：**  即使没有成功建立反弹 shell，PoC执行的中间命令可能对系统造成意外影响。
*   **依赖性问题：** 该PoC 依赖于目标系统上存在 `bash`，`base64`，`cat`，`echo`，`tr`，`chmod` 命令。 如果目标系统缺少这些命令,会导致POC 利用失败.

**投毒风险评估：**

该PoC的主要目的是进行漏洞利用，而非进行恶意破坏。 但也存在一定的风险。 投毒风险大概为10%。

**项目地址:** [TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC](https://github.com/TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #4

**来源**: [CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md](../2024/CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备的管理 Web 界面需要能通过网络访问。如果管理界面仅允许受信任的内部 IP 地址访问，风险将大大降低。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他已通过身份验证的权限提升漏洞（如 CVE-2024-9474）。

**漏洞利用方式：**

1.  攻击者发送特制的 HTTP 请求到目标 PAN-OS 设备的管理 Web 界面。
2.  该请求利用身份验证绕过漏洞，使攻击者无需有效凭据即可获得管理员权限。
3.  获得管理员权限后，攻击者可以执行任意命令，读取敏感信息，修改设备配置，甚至可能通过其他漏洞进一步入侵系统。

根据提供的漏洞利用代码 `exploit.py`，该 PoC 包含两种模式：扫描模式和利用模式。

*   **扫描模式：** 用于批量扫描目标 URL，检测是否存在 CVE-2024-0012 漏洞。它向 `/php/ztp_gate.php/.js.map` 发送 GET 请求，如果状态码为 200 且响应中包含 "Zero Touch Provisioning"，则判定存在漏洞。
*   **利用模式：** 允许攻击者在目标系统上执行任意命令。它通过向 `/php/utils/createRemoteAppwebSession.php/peppa.js.map` 发送 POST 请求，并在 `user` 参数中注入命令。然后，它尝试提取 `PHPSESSID`，并利用此会话 ID 访问受保护的页面。命令输出会被写入`/var/appweb/htdocs/unauth/{output_name}`，然后通过 GET 请求 `/unauth/{output_name}` 检索。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用，并且存在公开可用的 PoC，所以该 POC 代码具有有效性。

**投毒风险：**

该PoC代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **命令注入：** 利用模式允许执行任意命令，这意味着如果攻击者使用该 PoC 对目标系统进行攻击，他们可以安装后门、植入恶意软件，或进行其他恶意活动。
*   **未经验证的 PoC：** README.md 文件明确指出 “Untested POC”，这意味着代码可能存在未知的错误或缺陷，可能导致目标系统不稳定或崩溃。
*   **随机文件名：**PoC代码使用随机文件名存储命令输出，虽然在一定程度上防止了文件名冲突，但也可能被攻击者滥用，例如，通过生成大量随机文件来耗尽磁盘空间。

综合考虑，该 PoC 存在一定的投毒风险，大约占比 10%。用户应谨慎使用，并充分了解其潜在风险。

**修复建议：**

*   升级到 PAN-OS 10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本。
*   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
*   如果启用了威胁防御订阅，请启用并配置相关的威胁 ID (95746, 95747, 95752, 95753, 95759, 和 95763) 以阻止利用此漏洞的攻击。

**项目地址:** [VegetableLasagne/CVE-2024-0012](https://github.com/VegetableLasagne/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #5

**来源**: [CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md](../2024/CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (详见漏洞库信息)

**利用条件:** 目标PAN-OS管理Web界面可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果可以访问管理 Web 界面，便能够获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他需要身份验证的提权漏洞，例如 CVE-2024-9474。\n\n**有效性：**\n根据搜索结果和漏洞库信息，该漏洞已经被积极利用。漏洞库信息中的 "exploits" 字段显示 Palo Alto Networks 观察到利用此漏洞的威胁活动。多个搜索结果（例如，Arctic Wolf 的博客文章）也证实了该漏洞正在被利用。因此，利用代码的有效性很高。\n\n**投毒风险：**\n提供的漏洞利用代码仅为 Apache License 2.0 许可协议的文本。它本身不是可执行代码，因此不存在投毒风险。投毒风险为0%。\n\n**利用方式：**\n1.  **访问管理Web界面：** 攻击者需要能够通过网络访问目标 PAN-OS 设备的管理 Web 界面。\n2.  **身份验证绕过：** 利用漏洞绕过身份验证机制。根据漏洞信息，可能涉及发送特制的 HTTP 请求或利用身份验证过程中的缺陷。具体绕过方法需要根据完整的PoC来分析，这里仅有license文件，无法推断。\n3.  **获取管理员权限：** 成功绕过身份验证后，攻击者将获得 PAN-OS 管理员权限。\n4.  **执行恶意操作：** 获得管理员权限后，攻击者可以执行各种恶意操作，包括：\n    *   执行任意命令。\n    *   篡改防火墙配置。\n    *   利用其他漏洞进一步攻击。\n\n**缓解措施：**\n*   限制管理界面访问：根据 Palo Alto Networks 的最佳实践指南，仅允许受信任的内部 IP 地址访问管理 Web 界面。\n*   应用威胁防御：如果拥有威胁防御订阅，可以使用威胁 ID 95746、95747、95752、95753、95759 和 95763 阻止攻击。\n*   及时更新：升级到已修复此漏洞的 PAN-OS 版本 (10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本)。

**项目地址:** [XiaomingX/cve-2024-0012-poc](https://github.com/XiaomingX/cve-2024-0012-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #6

**来源**: [CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md](../2024/CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用（如CVE-2024-9474）

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 (受影响版本低于已修复版本)

**利用条件:** 需要网络访问目标PAN-OS设备的管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012是Palo Alto Networks PAN-OS软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理Web界面，可以获取PAN-OS管理员权限，执行管理操作，篡改配置或利用其他身份验证的权限提升漏洞。根据漏洞描述和搜索结果，该漏洞影响特定版本的PAN-OS，且存在在野利用。提供的POC代码（`cve-2024-0012-gui.py`）利用了此漏洞。利用方式如下：

1.  **创建初始会话：**  通过`createRemoteAppwebSession.php`端点，设置`X-PAN-AUTHCHECK`为`off`，并且在POST数据中，将`user`参数设置为包含命令注入的恶意代码。攻击者可以通过这个方式在目标机器上写入一个PHP文件，例如`cve.php`。命令通过反引号执行，将结果写入PHP文件。
2.  **触发执行：**  使用创建的`PHPSESSID` cookie，访问`/index.php/.js.map`端点，触发之前注入的命令执行。
3.  **验证执行：**  访问`/unauth/cve.php`，检查命令是否成功执行，并获取命令输出。

**投毒风险分析：**

查看`cve-2024-0012-gui.py`脚本，发现其主要功能是利用漏洞进行命令注入和验证，基本符合漏洞利用的逻辑。`self.command_input = QLineEdit()` 允许用户输入命令，增加了灵活性，但也引入了一定的风险，使用者可能使用恶意命令。但是从代码逻辑上，此仓库直接投毒的可能性较低。`README.md`文件仅包含漏洞描述和作者信息，无恶意代码。

总而言之，考虑到代码的开源性质，以及主要功能符合漏洞利用的预期，投毒的概率较低，但是命令的执行权交给了用户，如果用户使用了恶意命令，也可能造成危害。因此投毒风险评估为10%。

**项目地址:** [dcollaoa/cve-2024-0012-gui-poc](https://github.com/dcollaoa/cve-2024-0012-gui-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #7

**来源**: [CVE-2024-0012-greaselovely_CVE-2024-0012.md](../2024/CVE-2024-0012-greaselovely_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** Critical, allows unauthenticated remote attackers to gain administrator privileges.

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 software before the fixed versions.

**利用条件:** The management web interface must be accessible over the network, especially from the internet.

**POC 可用性:** Yes

**投毒风险:** 10%

## 详情

CVE-2024-0012 is an authentication bypass vulnerability in Palo Alto Networks PAN-OS. An unauthenticated attacker with network access to the management web interface can gain PAN-OS administrator privileges. 

**有效性：**
根据漏洞库信息、搜索引擎结果（尤其是来自Palo Alto Networks自身以及Arctic Wolf等安全公司的报告）以及提供的PoC代码，此漏洞是真实且已被利用的。PoC代码通过检查特定URL的响应状态码、Header以及页面内容是否包含`Zero Touch Provisioning`和`window.Pan`等特征字符串来判断目标是否存在漏洞，表明PoC的有效性。

**投毒风险：**
PoC代码主要用于检测漏洞是否存在，其本身功能相对简单，未发现明显的恶意代码。代码中使用的`requests`库可能存在潜在风险，如果被替换为恶意版本，可能导致信息泄露或代码执行。LICENSE文件采用MIT开源协议，允许修改和再分发，这也会增加潜在的投毒风险。考虑到requests库的潜在风险和开源协议的开放性，投毒风险评定为10%。

**利用方式：**
1.  **网络访问:** 攻击者需要能够通过网络访问目标Palo Alto Networks设备的管理Web界面。
2.  **漏洞触发:** 攻击者发送特制的HTTP请求到目标设备的管理Web界面，绕过身份验证。
3.  **权限提升:** 成功绕过身份验证后，攻击者获得PAN-OS管理员权限，可以执行任意管理操作，篡改配置或利用其他漏洞。
4. **后续利用:** 可能会结合 CVE-2024-9474 进一步利用， 执行任意命令。

**项目地址:** [greaselovely/CVE-2024-0012](https://github.com/greaselovely/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #8

**来源**: [CVE-2024-0012-iSee857_CVE-2024-0012-poc.md](../2024/CVE-2024-0012-iSee857_CVE-2024-0012-poc.md)

# CVE-2024-0012

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0012-0xjessie21_CVE-2024-0012.md](../2024/CVE-2024-0012-0xjessie21_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，未经身份验证的攻击者可以获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 11.2受影响版本

**利用条件:** 需要网络可以访问PAN-OS管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果具有对管理 Web 界面的网络访问权限，则可以获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他经过身份验证的权限提升漏洞。根据搜索结果和漏洞描述，该漏洞的风险在于允许未经授权的访问和控制。漏洞利用代码通过构造特定的HTTP请求绕过身份验证，然后在目标系统上执行任意命令。由于攻击者可以执行任意命令，因此存在植入后门的风险。 

**漏洞利用方式：**

1.  **利用createRemoteAppwebSession.php 创建初始会话:** 通过构造包含命令注入Payload的POST请求发送到`/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`，其中`X-PAN-AUTHCHECK` header设置为 `off`，并在`user`字段中注入恶意命令。该请求会将命令执行的结果写入`/var/appweb/htdocs/unauth/watchTowr.php`。
2.  **触发命令执行:**  利用index.php页面来触发执行`/var/appweb/htdocs/unauth/watchTowr.php`中的命令。

**投毒风险分析:**
代码本身是漏洞利用的PoC，实现了利用漏洞执行命令的功能。
*   PoC 中有向`/var/appweb/htdocs/unauth/`写入php文件的操作，如果服务器本身存在文件写入的权限问题，可能导致扩大攻击面。
*   PoC允许执行任意命令，如果攻击者在`--command`或者`--reverse-shell`中构造恶意的指令，可能会对目标造成更大的危害。
因此，存在一定的投毒风险，评估为10%。

**项目地址:** [0xjessie21/CVE-2024-0012](https://github.com/0xjessie21/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #2

**来源**: [CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md](../2024/CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** 高危，允许未授权的攻击者获取管理员权限，执行任意命令，篡改配置。

**影响版本:** 10.2, 11.0, 11.1, and 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 需要网络访问到 PAN-OS 管理 Web 界面，且管理界面可以从互联网或不受信任的网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能够访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或利用其他经过身份验证的提权漏洞，例如 CVE-2024-9474。

**漏洞利用方式：**

1.  **会话创建：**  攻击者首先发送一个特制的 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map` 路径，其中包含一个命令注入payload，这个payload的作用是向`/var/appweb/htdocs/unauth/watchTowr.php`写入系统信息。此请求设置 `X-PAN-AUTHCHECK: off` 头部，绕过身份验证检查。如果成功，服务器会返回一个 PHPSESSID cookie。
2.  **命令执行触发：**  攻击者使用获得的 PHPSESSID cookie 发送一个 GET 请求到 `/index.php/.js.map` 路径，同样设置 `X-PAN-AUTHCHECK: off` 头部。这个请求会触发之前注入的命令的执行。
3.  **执行验证：**  攻击者通过访问 `/unauth/watchTowr.php` 路径来验证命令是否成功执行。如果该文件存在且包含预期的系统信息，则表明漏洞利用成功。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的利用是有效的。漏洞库中明确指出存在针对该漏洞的威胁活动。POC 代码的实现方式与 WatchTowr Labs 的分析报告相符，进一步证实了其有效性。CISA 将该漏洞添加到了已知被利用的漏洞目录中，表明该漏洞正在被积极利用。

**投毒风险评估：**

该 POC 代码本身旨在利用漏洞，将 `uname -a` 命令的输出写入一个 Web 可访问的文件。虽然此操作本身具有一定的风险，因为它允许未经身份验证的访问者查看系统信息，但该 POC 代码的主要目的是验证漏洞的存在。代码本身较为简短，主要功能集中在利用漏洞上，不包含明显的恶意代码或者后门。投毒风险较低，估计为 1%。如果使用者不仔细审查，直接使用，可能会暴露一些系统信息，但不会直接导致系统被完全控制，因此投毒风险较低。

**缓解措施：**

*   限制管理 Web 界面的访问，仅允许来自受信任的内部 IP 地址的访问。
*   升级到已修复漏洞的 PAN-OS 版本 (10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本)。
*   部署威胁防御签名（如果可用）以检测和阻止针对此漏洞的攻击（Threat IDs 95746, 95747, 95752, 95753, 95759, 和 95763）。

**项目地址:** [Sachinart/CVE-2024-0012-POC](https://github.com/Sachinart/CVE-2024-0012-POC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #3

**来源**: [CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md](../2024/CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md)

## CVE-2024-0012 & CVE-2024-9474 Palo Alto PAN-OS 身份验证绕过和命令执行

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过 + 命令执行

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (参考漏洞库信息)

**利用条件:** 需要网络访问 PAN-OS 管理 Web 界面，且管理界面暴露在不受信任的网络中（例如互联网）。 根据漏洞库信息，仅允许受信任的内部IP地址访问管理界面可大大降低风险。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞利用结合了 CVE-2024-0012（身份验证绕过）和 CVE-2024-9474（命令执行和权限提升）。

**利用方式：**

1.  **身份验证绕过 (CVE-2024-0012)：** 攻击者无需身份验证即可访问 PAN-OS 管理 Web 界面。
2.  **获取 PHPSESSID：**  攻击者通过发送特制的 POST 请求到 `createRemoteAppwebSession.php` 获取有效的 `PHPSESSID`。
3.  **命令注入 (CVE-2024-9474)：** 攻击者使用获得的 `PHPSESSID`，通过在 `user` 参数中注入 shell 命令，利用 `createRemoteAppwebSession.php` 执行任意命令。
4.  **反弹 Shell：** 攻击者构造一个反弹 shell 的 payload，该 payload 经过两次 Base64 编码。
5.  **分块上传：** 因为命令长度限制，payload 被分割成多个小块，然后通过多个 POST 请求上传到目标服务器，存储为临时文件。
6.  **组合 Payload：** 上传完成后，攻击者使用 shell 命令将这些小块文件组合成一个完整的文件 `enc.txt`。
7.  **双重解码：** 攻击者对 `enc.txt` 中的内容进行双重 Base64 解码，并将结果保存到 `shell.sh` 文件中。
8.  **执行 Shell：** 攻击者赋予 `shell.sh` 可执行权限并执行它，从而建立反弹 shell 连接到攻击者的监听器。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用。提供的 PoC 代码实现了漏洞利用的完整流程，包括身份验证绕过、命令注入和反弹 shell。因此，该PoC代码被认为是有效的。

**投毒风险：**

虽然PoC的主要功能是利用漏洞，但仍存在一定的投毒风险。

*   **临时文件残留：**  该PoC在目标系统上创建临时文件（`c_*.tmp`, `enc.txt`, `shell.sh`），如果利用失败或被中断，这些文件可能会残留，占用磁盘空间或泄露信息。
*   **命令执行风险：**  即使没有成功建立反弹 shell，PoC执行的中间命令可能对系统造成意外影响。
*   **依赖性问题：** 该PoC 依赖于目标系统上存在 `bash`，`base64`，`cat`，`echo`，`tr`，`chmod` 命令。 如果目标系统缺少这些命令,会导致POC 利用失败.

**投毒风险评估：**

该PoC的主要目的是进行漏洞利用，而非进行恶意破坏。 但也存在一定的风险。 投毒风险大概为10%。

**项目地址:** [TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC](https://github.com/TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #4

**来源**: [CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md](../2024/CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备的管理 Web 界面需要能通过网络访问。如果管理界面仅允许受信任的内部 IP 地址访问，风险将大大降低。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他已通过身份验证的权限提升漏洞（如 CVE-2024-9474）。

**漏洞利用方式：**

1.  攻击者发送特制的 HTTP 请求到目标 PAN-OS 设备的管理 Web 界面。
2.  该请求利用身份验证绕过漏洞，使攻击者无需有效凭据即可获得管理员权限。
3.  获得管理员权限后，攻击者可以执行任意命令，读取敏感信息，修改设备配置，甚至可能通过其他漏洞进一步入侵系统。

根据提供的漏洞利用代码 `exploit.py`，该 PoC 包含两种模式：扫描模式和利用模式。

*   **扫描模式：** 用于批量扫描目标 URL，检测是否存在 CVE-2024-0012 漏洞。它向 `/php/ztp_gate.php/.js.map` 发送 GET 请求，如果状态码为 200 且响应中包含 "Zero Touch Provisioning"，则判定存在漏洞。
*   **利用模式：** 允许攻击者在目标系统上执行任意命令。它通过向 `/php/utils/createRemoteAppwebSession.php/peppa.js.map` 发送 POST 请求，并在 `user` 参数中注入命令。然后，它尝试提取 `PHPSESSID`，并利用此会话 ID 访问受保护的页面。命令输出会被写入`/var/appweb/htdocs/unauth/{output_name}`，然后通过 GET 请求 `/unauth/{output_name}` 检索。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用，并且存在公开可用的 PoC，所以该 POC 代码具有有效性。

**投毒风险：**

该PoC代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **命令注入：** 利用模式允许执行任意命令，这意味着如果攻击者使用该 PoC 对目标系统进行攻击，他们可以安装后门、植入恶意软件，或进行其他恶意活动。
*   **未经验证的 PoC：** README.md 文件明确指出 “Untested POC”，这意味着代码可能存在未知的错误或缺陷，可能导致目标系统不稳定或崩溃。
*   **随机文件名：**PoC代码使用随机文件名存储命令输出，虽然在一定程度上防止了文件名冲突，但也可能被攻击者滥用，例如，通过生成大量随机文件来耗尽磁盘空间。

综合考虑，该 PoC 存在一定的投毒风险，大约占比 10%。用户应谨慎使用，并充分了解其潜在风险。

**修复建议：**

*   升级到 PAN-OS 10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本。
*   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
*   如果启用了威胁防御订阅，请启用并配置相关的威胁 ID (95746, 95747, 95752, 95753, 95759, 和 95763) 以阻止利用此漏洞的攻击。

**项目地址:** [VegetableLasagne/CVE-2024-0012](https://github.com/VegetableLasagne/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #5

**来源**: [CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md](../2024/CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (详见漏洞库信息)

**利用条件:** 目标PAN-OS管理Web界面可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果可以访问管理 Web 界面，便能够获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他需要身份验证的提权漏洞，例如 CVE-2024-9474。\n\n**有效性：**\n根据搜索结果和漏洞库信息，该漏洞已经被积极利用。漏洞库信息中的 "exploits" 字段显示 Palo Alto Networks 观察到利用此漏洞的威胁活动。多个搜索结果（例如，Arctic Wolf 的博客文章）也证实了该漏洞正在被利用。因此，利用代码的有效性很高。\n\n**投毒风险：**\n提供的漏洞利用代码仅为 Apache License 2.0 许可协议的文本。它本身不是可执行代码，因此不存在投毒风险。投毒风险为0%。\n\n**利用方式：**\n1.  **访问管理Web界面：** 攻击者需要能够通过网络访问目标 PAN-OS 设备的管理 Web 界面。\n2.  **身份验证绕过：** 利用漏洞绕过身份验证机制。根据漏洞信息，可能涉及发送特制的 HTTP 请求或利用身份验证过程中的缺陷。具体绕过方法需要根据完整的PoC来分析，这里仅有license文件，无法推断。\n3.  **获取管理员权限：** 成功绕过身份验证后，攻击者将获得 PAN-OS 管理员权限。\n4.  **执行恶意操作：** 获得管理员权限后，攻击者可以执行各种恶意操作，包括：\n    *   执行任意命令。\n    *   篡改防火墙配置。\n    *   利用其他漏洞进一步攻击。\n\n**缓解措施：**\n*   限制管理界面访问：根据 Palo Alto Networks 的最佳实践指南，仅允许受信任的内部 IP 地址访问管理 Web 界面。\n*   应用威胁防御：如果拥有威胁防御订阅，可以使用威胁 ID 95746、95747、95752、95753、95759 和 95763 阻止攻击。\n*   及时更新：升级到已修复此漏洞的 PAN-OS 版本 (10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本)。

**项目地址:** [XiaomingX/cve-2024-0012-poc](https://github.com/XiaomingX/cve-2024-0012-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #6

**来源**: [CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md](../2024/CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用（如CVE-2024-9474）

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 (受影响版本低于已修复版本)

**利用条件:** 需要网络访问目标PAN-OS设备的管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012是Palo Alto Networks PAN-OS软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理Web界面，可以获取PAN-OS管理员权限，执行管理操作，篡改配置或利用其他身份验证的权限提升漏洞。根据漏洞描述和搜索结果，该漏洞影响特定版本的PAN-OS，且存在在野利用。提供的POC代码（`cve-2024-0012-gui.py`）利用了此漏洞。利用方式如下：

1.  **创建初始会话：**  通过`createRemoteAppwebSession.php`端点，设置`X-PAN-AUTHCHECK`为`off`，并且在POST数据中，将`user`参数设置为包含命令注入的恶意代码。攻击者可以通过这个方式在目标机器上写入一个PHP文件，例如`cve.php`。命令通过反引号执行，将结果写入PHP文件。
2.  **触发执行：**  使用创建的`PHPSESSID` cookie，访问`/index.php/.js.map`端点，触发之前注入的命令执行。
3.  **验证执行：**  访问`/unauth/cve.php`，检查命令是否成功执行，并获取命令输出。

**投毒风险分析：**

查看`cve-2024-0012-gui.py`脚本，发现其主要功能是利用漏洞进行命令注入和验证，基本符合漏洞利用的逻辑。`self.command_input = QLineEdit()` 允许用户输入命令，增加了灵活性，但也引入了一定的风险，使用者可能使用恶意命令。但是从代码逻辑上，此仓库直接投毒的可能性较低。`README.md`文件仅包含漏洞描述和作者信息，无恶意代码。

总而言之，考虑到代码的开源性质，以及主要功能符合漏洞利用的预期，投毒的概率较低，但是命令的执行权交给了用户，如果用户使用了恶意命令，也可能造成危害。因此投毒风险评估为10%。

**项目地址:** [dcollaoa/cve-2024-0012-gui-poc](https://github.com/dcollaoa/cve-2024-0012-gui-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #7

**来源**: [CVE-2024-0012-greaselovely_CVE-2024-0012.md](../2024/CVE-2024-0012-greaselovely_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** Critical, allows unauthenticated remote attackers to gain administrator privileges.

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 software before the fixed versions.

**利用条件:** The management web interface must be accessible over the network, especially from the internet.

**POC 可用性:** Yes

**投毒风险:** 10%

## 详情

CVE-2024-0012 is an authentication bypass vulnerability in Palo Alto Networks PAN-OS. An unauthenticated attacker with network access to the management web interface can gain PAN-OS administrator privileges. 

**有效性：**
根据漏洞库信息、搜索引擎结果（尤其是来自Palo Alto Networks自身以及Arctic Wolf等安全公司的报告）以及提供的PoC代码，此漏洞是真实且已被利用的。PoC代码通过检查特定URL的响应状态码、Header以及页面内容是否包含`Zero Touch Provisioning`和`window.Pan`等特征字符串来判断目标是否存在漏洞，表明PoC的有效性。

**投毒风险：**
PoC代码主要用于检测漏洞是否存在，其本身功能相对简单，未发现明显的恶意代码。代码中使用的`requests`库可能存在潜在风险，如果被替换为恶意版本，可能导致信息泄露或代码执行。LICENSE文件采用MIT开源协议，允许修改和再分发，这也会增加潜在的投毒风险。考虑到requests库的潜在风险和开源协议的开放性，投毒风险评定为10%。

**利用方式：**
1.  **网络访问:** 攻击者需要能够通过网络访问目标Palo Alto Networks设备的管理Web界面。
2.  **漏洞触发:** 攻击者发送特制的HTTP请求到目标设备的管理Web界面，绕过身份验证。
3.  **权限提升:** 成功绕过身份验证后，攻击者获得PAN-OS管理员权限，可以执行任意管理操作，篡改配置或利用其他漏洞。
4. **后续利用:** 可能会结合 CVE-2024-9474 进一步利用， 执行任意命令。

**项目地址:** [greaselovely/CVE-2024-0012](https://github.com/greaselovely/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #8

**来源**: [CVE-2024-0012-iSee857_CVE-2024-0012-poc.md](../2024/CVE-2024-0012-iSee857_CVE-2024-0012-poc.md)

# CVE-2024-0012

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0012-0xjessie21_CVE-2024-0012.md](../2024/CVE-2024-0012-0xjessie21_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，未经身份验证的攻击者可以获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 11.2受影响版本

**利用条件:** 需要网络可以访问PAN-OS管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果具有对管理 Web 界面的网络访问权限，则可以获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他经过身份验证的权限提升漏洞。根据搜索结果和漏洞描述，该漏洞的风险在于允许未经授权的访问和控制。漏洞利用代码通过构造特定的HTTP请求绕过身份验证，然后在目标系统上执行任意命令。由于攻击者可以执行任意命令，因此存在植入后门的风险。 

**漏洞利用方式：**

1.  **利用createRemoteAppwebSession.php 创建初始会话:** 通过构造包含命令注入Payload的POST请求发送到`/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`，其中`X-PAN-AUTHCHECK` header设置为 `off`，并在`user`字段中注入恶意命令。该请求会将命令执行的结果写入`/var/appweb/htdocs/unauth/watchTowr.php`。
2.  **触发命令执行:**  利用index.php页面来触发执行`/var/appweb/htdocs/unauth/watchTowr.php`中的命令。

**投毒风险分析:**
代码本身是漏洞利用的PoC，实现了利用漏洞执行命令的功能。
*   PoC 中有向`/var/appweb/htdocs/unauth/`写入php文件的操作，如果服务器本身存在文件写入的权限问题，可能导致扩大攻击面。
*   PoC允许执行任意命令，如果攻击者在`--command`或者`--reverse-shell`中构造恶意的指令，可能会对目标造成更大的危害。
因此，存在一定的投毒风险，评估为10%。

**项目地址:** [0xjessie21/CVE-2024-0012](https://github.com/0xjessie21/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #2

**来源**: [CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md](../2024/CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** 高危，允许未授权的攻击者获取管理员权限，执行任意命令，篡改配置。

**影响版本:** 10.2, 11.0, 11.1, and 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 需要网络访问到 PAN-OS 管理 Web 界面，且管理界面可以从互联网或不受信任的网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能够访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或利用其他经过身份验证的提权漏洞，例如 CVE-2024-9474。

**漏洞利用方式：**

1.  **会话创建：**  攻击者首先发送一个特制的 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map` 路径，其中包含一个命令注入payload，这个payload的作用是向`/var/appweb/htdocs/unauth/watchTowr.php`写入系统信息。此请求设置 `X-PAN-AUTHCHECK: off` 头部，绕过身份验证检查。如果成功，服务器会返回一个 PHPSESSID cookie。
2.  **命令执行触发：**  攻击者使用获得的 PHPSESSID cookie 发送一个 GET 请求到 `/index.php/.js.map` 路径，同样设置 `X-PAN-AUTHCHECK: off` 头部。这个请求会触发之前注入的命令的执行。
3.  **执行验证：**  攻击者通过访问 `/unauth/watchTowr.php` 路径来验证命令是否成功执行。如果该文件存在且包含预期的系统信息，则表明漏洞利用成功。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的利用是有效的。漏洞库中明确指出存在针对该漏洞的威胁活动。POC 代码的实现方式与 WatchTowr Labs 的分析报告相符，进一步证实了其有效性。CISA 将该漏洞添加到了已知被利用的漏洞目录中，表明该漏洞正在被积极利用。

**投毒风险评估：**

该 POC 代码本身旨在利用漏洞，将 `uname -a` 命令的输出写入一个 Web 可访问的文件。虽然此操作本身具有一定的风险，因为它允许未经身份验证的访问者查看系统信息，但该 POC 代码的主要目的是验证漏洞的存在。代码本身较为简短，主要功能集中在利用漏洞上，不包含明显的恶意代码或者后门。投毒风险较低，估计为 1%。如果使用者不仔细审查，直接使用，可能会暴露一些系统信息，但不会直接导致系统被完全控制，因此投毒风险较低。

**缓解措施：**

*   限制管理 Web 界面的访问，仅允许来自受信任的内部 IP 地址的访问。
*   升级到已修复漏洞的 PAN-OS 版本 (10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本)。
*   部署威胁防御签名（如果可用）以检测和阻止针对此漏洞的攻击（Threat IDs 95746, 95747, 95752, 95753, 95759, 和 95763）。

**项目地址:** [Sachinart/CVE-2024-0012-POC](https://github.com/Sachinart/CVE-2024-0012-POC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #3

**来源**: [CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md](../2024/CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md)

## CVE-2024-0012 & CVE-2024-9474 Palo Alto PAN-OS 身份验证绕过和命令执行

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过 + 命令执行

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (参考漏洞库信息)

**利用条件:** 需要网络访问 PAN-OS 管理 Web 界面，且管理界面暴露在不受信任的网络中（例如互联网）。 根据漏洞库信息，仅允许受信任的内部IP地址访问管理界面可大大降低风险。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞利用结合了 CVE-2024-0012（身份验证绕过）和 CVE-2024-9474（命令执行和权限提升）。

**利用方式：**

1.  **身份验证绕过 (CVE-2024-0012)：** 攻击者无需身份验证即可访问 PAN-OS 管理 Web 界面。
2.  **获取 PHPSESSID：**  攻击者通过发送特制的 POST 请求到 `createRemoteAppwebSession.php` 获取有效的 `PHPSESSID`。
3.  **命令注入 (CVE-2024-9474)：** 攻击者使用获得的 `PHPSESSID`，通过在 `user` 参数中注入 shell 命令，利用 `createRemoteAppwebSession.php` 执行任意命令。
4.  **反弹 Shell：** 攻击者构造一个反弹 shell 的 payload，该 payload 经过两次 Base64 编码。
5.  **分块上传：** 因为命令长度限制，payload 被分割成多个小块，然后通过多个 POST 请求上传到目标服务器，存储为临时文件。
6.  **组合 Payload：** 上传完成后，攻击者使用 shell 命令将这些小块文件组合成一个完整的文件 `enc.txt`。
7.  **双重解码：** 攻击者对 `enc.txt` 中的内容进行双重 Base64 解码，并将结果保存到 `shell.sh` 文件中。
8.  **执行 Shell：** 攻击者赋予 `shell.sh` 可执行权限并执行它，从而建立反弹 shell 连接到攻击者的监听器。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用。提供的 PoC 代码实现了漏洞利用的完整流程，包括身份验证绕过、命令注入和反弹 shell。因此，该PoC代码被认为是有效的。

**投毒风险：**

虽然PoC的主要功能是利用漏洞，但仍存在一定的投毒风险。

*   **临时文件残留：**  该PoC在目标系统上创建临时文件（`c_*.tmp`, `enc.txt`, `shell.sh`），如果利用失败或被中断，这些文件可能会残留，占用磁盘空间或泄露信息。
*   **命令执行风险：**  即使没有成功建立反弹 shell，PoC执行的中间命令可能对系统造成意外影响。
*   **依赖性问题：** 该PoC 依赖于目标系统上存在 `bash`，`base64`，`cat`，`echo`，`tr`，`chmod` 命令。 如果目标系统缺少这些命令,会导致POC 利用失败.

**投毒风险评估：**

该PoC的主要目的是进行漏洞利用，而非进行恶意破坏。 但也存在一定的风险。 投毒风险大概为10%。

**项目地址:** [TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC](https://github.com/TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #4

**来源**: [CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md](../2024/CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备的管理 Web 界面需要能通过网络访问。如果管理界面仅允许受信任的内部 IP 地址访问，风险将大大降低。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他已通过身份验证的权限提升漏洞（如 CVE-2024-9474）。

**漏洞利用方式：**

1.  攻击者发送特制的 HTTP 请求到目标 PAN-OS 设备的管理 Web 界面。
2.  该请求利用身份验证绕过漏洞，使攻击者无需有效凭据即可获得管理员权限。
3.  获得管理员权限后，攻击者可以执行任意命令，读取敏感信息，修改设备配置，甚至可能通过其他漏洞进一步入侵系统。

根据提供的漏洞利用代码 `exploit.py`，该 PoC 包含两种模式：扫描模式和利用模式。

*   **扫描模式：** 用于批量扫描目标 URL，检测是否存在 CVE-2024-0012 漏洞。它向 `/php/ztp_gate.php/.js.map` 发送 GET 请求，如果状态码为 200 且响应中包含 "Zero Touch Provisioning"，则判定存在漏洞。
*   **利用模式：** 允许攻击者在目标系统上执行任意命令。它通过向 `/php/utils/createRemoteAppwebSession.php/peppa.js.map` 发送 POST 请求，并在 `user` 参数中注入命令。然后，它尝试提取 `PHPSESSID`，并利用此会话 ID 访问受保护的页面。命令输出会被写入`/var/appweb/htdocs/unauth/{output_name}`，然后通过 GET 请求 `/unauth/{output_name}` 检索。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用，并且存在公开可用的 PoC，所以该 POC 代码具有有效性。

**投毒风险：**

该PoC代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **命令注入：** 利用模式允许执行任意命令，这意味着如果攻击者使用该 PoC 对目标系统进行攻击，他们可以安装后门、植入恶意软件，或进行其他恶意活动。
*   **未经验证的 PoC：** README.md 文件明确指出 “Untested POC”，这意味着代码可能存在未知的错误或缺陷，可能导致目标系统不稳定或崩溃。
*   **随机文件名：**PoC代码使用随机文件名存储命令输出，虽然在一定程度上防止了文件名冲突，但也可能被攻击者滥用，例如，通过生成大量随机文件来耗尽磁盘空间。

综合考虑，该 PoC 存在一定的投毒风险，大约占比 10%。用户应谨慎使用，并充分了解其潜在风险。

**修复建议：**

*   升级到 PAN-OS 10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本。
*   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
*   如果启用了威胁防御订阅，请启用并配置相关的威胁 ID (95746, 95747, 95752, 95753, 95759, 和 95763) 以阻止利用此漏洞的攻击。

**项目地址:** [VegetableLasagne/CVE-2024-0012](https://github.com/VegetableLasagne/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #5

**来源**: [CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md](../2024/CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (详见漏洞库信息)

**利用条件:** 目标PAN-OS管理Web界面可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果可以访问管理 Web 界面，便能够获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他需要身份验证的提权漏洞，例如 CVE-2024-9474。\n\n**有效性：**\n根据搜索结果和漏洞库信息，该漏洞已经被积极利用。漏洞库信息中的 "exploits" 字段显示 Palo Alto Networks 观察到利用此漏洞的威胁活动。多个搜索结果（例如，Arctic Wolf 的博客文章）也证实了该漏洞正在被利用。因此，利用代码的有效性很高。\n\n**投毒风险：**\n提供的漏洞利用代码仅为 Apache License 2.0 许可协议的文本。它本身不是可执行代码，因此不存在投毒风险。投毒风险为0%。\n\n**利用方式：**\n1.  **访问管理Web界面：** 攻击者需要能够通过网络访问目标 PAN-OS 设备的管理 Web 界面。\n2.  **身份验证绕过：** 利用漏洞绕过身份验证机制。根据漏洞信息，可能涉及发送特制的 HTTP 请求或利用身份验证过程中的缺陷。具体绕过方法需要根据完整的PoC来分析，这里仅有license文件，无法推断。\n3.  **获取管理员权限：** 成功绕过身份验证后，攻击者将获得 PAN-OS 管理员权限。\n4.  **执行恶意操作：** 获得管理员权限后，攻击者可以执行各种恶意操作，包括：\n    *   执行任意命令。\n    *   篡改防火墙配置。\n    *   利用其他漏洞进一步攻击。\n\n**缓解措施：**\n*   限制管理界面访问：根据 Palo Alto Networks 的最佳实践指南，仅允许受信任的内部 IP 地址访问管理 Web 界面。\n*   应用威胁防御：如果拥有威胁防御订阅，可以使用威胁 ID 95746、95747、95752、95753、95759 和 95763 阻止攻击。\n*   及时更新：升级到已修复此漏洞的 PAN-OS 版本 (10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本)。

**项目地址:** [XiaomingX/cve-2024-0012-poc](https://github.com/XiaomingX/cve-2024-0012-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #6

**来源**: [CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md](../2024/CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用（如CVE-2024-9474）

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 (受影响版本低于已修复版本)

**利用条件:** 需要网络访问目标PAN-OS设备的管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012是Palo Alto Networks PAN-OS软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理Web界面，可以获取PAN-OS管理员权限，执行管理操作，篡改配置或利用其他身份验证的权限提升漏洞。根据漏洞描述和搜索结果，该漏洞影响特定版本的PAN-OS，且存在在野利用。提供的POC代码（`cve-2024-0012-gui.py`）利用了此漏洞。利用方式如下：

1.  **创建初始会话：**  通过`createRemoteAppwebSession.php`端点，设置`X-PAN-AUTHCHECK`为`off`，并且在POST数据中，将`user`参数设置为包含命令注入的恶意代码。攻击者可以通过这个方式在目标机器上写入一个PHP文件，例如`cve.php`。命令通过反引号执行，将结果写入PHP文件。
2.  **触发执行：**  使用创建的`PHPSESSID` cookie，访问`/index.php/.js.map`端点，触发之前注入的命令执行。
3.  **验证执行：**  访问`/unauth/cve.php`，检查命令是否成功执行，并获取命令输出。

**投毒风险分析：**

查看`cve-2024-0012-gui.py`脚本，发现其主要功能是利用漏洞进行命令注入和验证，基本符合漏洞利用的逻辑。`self.command_input = QLineEdit()` 允许用户输入命令，增加了灵活性，但也引入了一定的风险，使用者可能使用恶意命令。但是从代码逻辑上，此仓库直接投毒的可能性较低。`README.md`文件仅包含漏洞描述和作者信息，无恶意代码。

总而言之，考虑到代码的开源性质，以及主要功能符合漏洞利用的预期，投毒的概率较低，但是命令的执行权交给了用户，如果用户使用了恶意命令，也可能造成危害。因此投毒风险评估为10%。

**项目地址:** [dcollaoa/cve-2024-0012-gui-poc](https://github.com/dcollaoa/cve-2024-0012-gui-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #7

**来源**: [CVE-2024-0012-greaselovely_CVE-2024-0012.md](../2024/CVE-2024-0012-greaselovely_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** Critical, allows unauthenticated remote attackers to gain administrator privileges.

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 software before the fixed versions.

**利用条件:** The management web interface must be accessible over the network, especially from the internet.

**POC 可用性:** Yes

**投毒风险:** 10%

## 详情

CVE-2024-0012 is an authentication bypass vulnerability in Palo Alto Networks PAN-OS. An unauthenticated attacker with network access to the management web interface can gain PAN-OS administrator privileges. 

**有效性：**
根据漏洞库信息、搜索引擎结果（尤其是来自Palo Alto Networks自身以及Arctic Wolf等安全公司的报告）以及提供的PoC代码，此漏洞是真实且已被利用的。PoC代码通过检查特定URL的响应状态码、Header以及页面内容是否包含`Zero Touch Provisioning`和`window.Pan`等特征字符串来判断目标是否存在漏洞，表明PoC的有效性。

**投毒风险：**
PoC代码主要用于检测漏洞是否存在，其本身功能相对简单，未发现明显的恶意代码。代码中使用的`requests`库可能存在潜在风险，如果被替换为恶意版本，可能导致信息泄露或代码执行。LICENSE文件采用MIT开源协议，允许修改和再分发，这也会增加潜在的投毒风险。考虑到requests库的潜在风险和开源协议的开放性，投毒风险评定为10%。

**利用方式：**
1.  **网络访问:** 攻击者需要能够通过网络访问目标Palo Alto Networks设备的管理Web界面。
2.  **漏洞触发:** 攻击者发送特制的HTTP请求到目标设备的管理Web界面，绕过身份验证。
3.  **权限提升:** 成功绕过身份验证后，攻击者获得PAN-OS管理员权限，可以执行任意管理操作，篡改配置或利用其他漏洞。
4. **后续利用:** 可能会结合 CVE-2024-9474 进一步利用， 执行任意命令。

**项目地址:** [greaselovely/CVE-2024-0012](https://github.com/greaselovely/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #8

**来源**: [CVE-2024-0012-iSee857_CVE-2024-0012-poc.md](../2024/CVE-2024-0012-iSee857_CVE-2024-0012-poc.md)

# CVE-2024-0012

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0012-0xjessie21_CVE-2024-0012.md](../2024/CVE-2024-0012-0xjessie21_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，未经身份验证的攻击者可以获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 11.2受影响版本

**利用条件:** 需要网络可以访问PAN-OS管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果具有对管理 Web 界面的网络访问权限，则可以获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他经过身份验证的权限提升漏洞。根据搜索结果和漏洞描述，该漏洞的风险在于允许未经授权的访问和控制。漏洞利用代码通过构造特定的HTTP请求绕过身份验证，然后在目标系统上执行任意命令。由于攻击者可以执行任意命令，因此存在植入后门的风险。 

**漏洞利用方式：**

1.  **利用createRemoteAppwebSession.php 创建初始会话:** 通过构造包含命令注入Payload的POST请求发送到`/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`，其中`X-PAN-AUTHCHECK` header设置为 `off`，并在`user`字段中注入恶意命令。该请求会将命令执行的结果写入`/var/appweb/htdocs/unauth/watchTowr.php`。
2.  **触发命令执行:**  利用index.php页面来触发执行`/var/appweb/htdocs/unauth/watchTowr.php`中的命令。

**投毒风险分析:**
代码本身是漏洞利用的PoC，实现了利用漏洞执行命令的功能。
*   PoC 中有向`/var/appweb/htdocs/unauth/`写入php文件的操作，如果服务器本身存在文件写入的权限问题，可能导致扩大攻击面。
*   PoC允许执行任意命令，如果攻击者在`--command`或者`--reverse-shell`中构造恶意的指令，可能会对目标造成更大的危害。
因此，存在一定的投毒风险，评估为10%。

**项目地址:** [0xjessie21/CVE-2024-0012](https://github.com/0xjessie21/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #2

**来源**: [CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md](../2024/CVE-2024-0012-Sachinart_CVE-2024-0012-POC.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** 高危，允许未授权的攻击者获取管理员权限，执行任意命令，篡改配置。

**影响版本:** 10.2, 11.0, 11.1, and 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 需要网络访问到 PAN-OS 管理 Web 界面，且管理界面可以从互联网或不受信任的网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能够访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或利用其他经过身份验证的提权漏洞，例如 CVE-2024-9474。

**漏洞利用方式：**

1.  **会话创建：**  攻击者首先发送一个特制的 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map` 路径，其中包含一个命令注入payload，这个payload的作用是向`/var/appweb/htdocs/unauth/watchTowr.php`写入系统信息。此请求设置 `X-PAN-AUTHCHECK: off` 头部，绕过身份验证检查。如果成功，服务器会返回一个 PHPSESSID cookie。
2.  **命令执行触发：**  攻击者使用获得的 PHPSESSID cookie 发送一个 GET 请求到 `/index.php/.js.map` 路径，同样设置 `X-PAN-AUTHCHECK: off` 头部。这个请求会触发之前注入的命令的执行。
3.  **执行验证：**  攻击者通过访问 `/unauth/watchTowr.php` 路径来验证命令是否成功执行。如果该文件存在且包含预期的系统信息，则表明漏洞利用成功。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的利用是有效的。漏洞库中明确指出存在针对该漏洞的威胁活动。POC 代码的实现方式与 WatchTowr Labs 的分析报告相符，进一步证实了其有效性。CISA 将该漏洞添加到了已知被利用的漏洞目录中，表明该漏洞正在被积极利用。

**投毒风险评估：**

该 POC 代码本身旨在利用漏洞，将 `uname -a` 命令的输出写入一个 Web 可访问的文件。虽然此操作本身具有一定的风险，因为它允许未经身份验证的访问者查看系统信息，但该 POC 代码的主要目的是验证漏洞的存在。代码本身较为简短，主要功能集中在利用漏洞上，不包含明显的恶意代码或者后门。投毒风险较低，估计为 1%。如果使用者不仔细审查，直接使用，可能会暴露一些系统信息，但不会直接导致系统被完全控制，因此投毒风险较低。

**缓解措施：**

*   限制管理 Web 界面的访问，仅允许来自受信任的内部 IP 地址的访问。
*   升级到已修复漏洞的 PAN-OS 版本 (10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本)。
*   部署威胁防御签名（如果可用）以检测和阻止针对此漏洞的攻击（Threat IDs 95746, 95747, 95752, 95753, 95759, 和 95763）。

**项目地址:** [Sachinart/CVE-2024-0012-POC](https://github.com/Sachinart/CVE-2024-0012-POC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #3

**来源**: [CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md](../2024/CVE-2024-0012-TalatumLabs_CVE-2024-0012_CVE-2024-9474_PoC.md)

## CVE-2024-0012 & CVE-2024-9474 Palo Alto PAN-OS 身份验证绕过和命令执行

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过 + 命令执行

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (参考漏洞库信息)

**利用条件:** 需要网络访问 PAN-OS 管理 Web 界面，且管理界面暴露在不受信任的网络中（例如互联网）。 根据漏洞库信息，仅允许受信任的内部IP地址访问管理界面可大大降低风险。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞利用结合了 CVE-2024-0012（身份验证绕过）和 CVE-2024-9474（命令执行和权限提升）。

**利用方式：**

1.  **身份验证绕过 (CVE-2024-0012)：** 攻击者无需身份验证即可访问 PAN-OS 管理 Web 界面。
2.  **获取 PHPSESSID：**  攻击者通过发送特制的 POST 请求到 `createRemoteAppwebSession.php` 获取有效的 `PHPSESSID`。
3.  **命令注入 (CVE-2024-9474)：** 攻击者使用获得的 `PHPSESSID`，通过在 `user` 参数中注入 shell 命令，利用 `createRemoteAppwebSession.php` 执行任意命令。
4.  **反弹 Shell：** 攻击者构造一个反弹 shell 的 payload，该 payload 经过两次 Base64 编码。
5.  **分块上传：** 因为命令长度限制，payload 被分割成多个小块，然后通过多个 POST 请求上传到目标服务器，存储为临时文件。
6.  **组合 Payload：** 上传完成后，攻击者使用 shell 命令将这些小块文件组合成一个完整的文件 `enc.txt`。
7.  **双重解码：** 攻击者对 `enc.txt` 中的内容进行双重 Base64 解码，并将结果保存到 `shell.sh` 文件中。
8.  **执行 Shell：** 攻击者赋予 `shell.sh` 可执行权限并执行它，从而建立反弹 shell 连接到攻击者的监听器。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用。提供的 PoC 代码实现了漏洞利用的完整流程，包括身份验证绕过、命令注入和反弹 shell。因此，该PoC代码被认为是有效的。

**投毒风险：**

虽然PoC的主要功能是利用漏洞，但仍存在一定的投毒风险。

*   **临时文件残留：**  该PoC在目标系统上创建临时文件（`c_*.tmp`, `enc.txt`, `shell.sh`），如果利用失败或被中断，这些文件可能会残留，占用磁盘空间或泄露信息。
*   **命令执行风险：**  即使没有成功建立反弹 shell，PoC执行的中间命令可能对系统造成意外影响。
*   **依赖性问题：** 该PoC 依赖于目标系统上存在 `bash`，`base64`，`cat`，`echo`，`tr`，`chmod` 命令。 如果目标系统缺少这些命令,会导致POC 利用失败.

**投毒风险评估：**

该PoC的主要目的是进行漏洞利用，而非进行恶意破坏。 但也存在一定的风险。 投毒风险大概为10%。

**项目地址:** [TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC](https://github.com/TalatumLabs/CVE-2024-0012_CVE-2024-9474_PoC)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #4

**来源**: [CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md](../2024/CVE-2024-0012-VegetableLasagne_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备的管理 Web 界面需要能通过网络访问。如果管理界面仅允许受信任的内部 IP 地址访问，风险将大大降低。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理 Web 界面，可以利用此漏洞获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他已通过身份验证的权限提升漏洞（如 CVE-2024-9474）。

**漏洞利用方式：**

1.  攻击者发送特制的 HTTP 请求到目标 PAN-OS 设备的管理 Web 界面。
2.  该请求利用身份验证绕过漏洞，使攻击者无需有效凭据即可获得管理员权限。
3.  获得管理员权限后，攻击者可以执行任意命令，读取敏感信息，修改设备配置，甚至可能通过其他漏洞进一步入侵系统。

根据提供的漏洞利用代码 `exploit.py`，该 PoC 包含两种模式：扫描模式和利用模式。

*   **扫描模式：** 用于批量扫描目标 URL，检测是否存在 CVE-2024-0012 漏洞。它向 `/php/ztp_gate.php/.js.map` 发送 GET 请求，如果状态码为 200 且响应中包含 "Zero Touch Provisioning"，则判定存在漏洞。
*   **利用模式：** 允许攻击者在目标系统上执行任意命令。它通过向 `/php/utils/createRemoteAppwebSession.php/peppa.js.map` 发送 POST 请求，并在 `user` 参数中注入命令。然后，它尝试提取 `PHPSESSID`，并利用此会话 ID 访问受保护的页面。命令输出会被写入`/var/appweb/htdocs/unauth/{output_name}`，然后通过 GET 请求 `/unauth/{output_name}` 检索。

**有效性：**

根据搜索引擎结果，该漏洞已被积极利用，并且存在公开可用的 PoC，所以该 POC 代码具有有效性。

**投毒风险：**

该PoC代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **命令注入：** 利用模式允许执行任意命令，这意味着如果攻击者使用该 PoC 对目标系统进行攻击，他们可以安装后门、植入恶意软件，或进行其他恶意活动。
*   **未经验证的 PoC：** README.md 文件明确指出 “Untested POC”，这意味着代码可能存在未知的错误或缺陷，可能导致目标系统不稳定或崩溃。
*   **随机文件名：**PoC代码使用随机文件名存储命令输出，虽然在一定程度上防止了文件名冲突，但也可能被攻击者滥用，例如，通过生成大量随机文件来耗尽磁盘空间。

综合考虑，该 PoC 存在一定的投毒风险，大约占比 10%。用户应谨慎使用，并充分了解其潜在风险。

**修复建议：**

*   升级到 PAN-OS 10.2.12-h2, PAN-OS 11.0.6-h1, PAN-OS 11.1.5-h1, PAN-OS 11.2.4-h1 或更高版本。
*   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
*   如果启用了威胁防御订阅，请启用并配置相关的威胁 ID (95746, 95747, 95752, 95753, 95759, 和 95763) 以阻止利用此漏洞的攻击。

**项目地址:** [VegetableLasagne/CVE-2024-0012](https://github.com/VegetableLasagne/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #5

**来源**: [CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md](../2024/CVE-2024-0012-XiaomingX_cve-2024-0012-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (详见漏洞库信息)

**利用条件:** 目标PAN-OS管理Web界面可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果可以访问管理 Web 界面，便能够获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他需要身份验证的提权漏洞，例如 CVE-2024-9474。\n\n**有效性：**\n根据搜索结果和漏洞库信息，该漏洞已经被积极利用。漏洞库信息中的 "exploits" 字段显示 Palo Alto Networks 观察到利用此漏洞的威胁活动。多个搜索结果（例如，Arctic Wolf 的博客文章）也证实了该漏洞正在被利用。因此，利用代码的有效性很高。\n\n**投毒风险：**\n提供的漏洞利用代码仅为 Apache License 2.0 许可协议的文本。它本身不是可执行代码，因此不存在投毒风险。投毒风险为0%。\n\n**利用方式：**\n1.  **访问管理Web界面：** 攻击者需要能够通过网络访问目标 PAN-OS 设备的管理 Web 界面。\n2.  **身份验证绕过：** 利用漏洞绕过身份验证机制。根据漏洞信息，可能涉及发送特制的 HTTP 请求或利用身份验证过程中的缺陷。具体绕过方法需要根据完整的PoC来分析，这里仅有license文件，无法推断。\n3.  **获取管理员权限：** 成功绕过身份验证后，攻击者将获得 PAN-OS 管理员权限。\n4.  **执行恶意操作：** 获得管理员权限后，攻击者可以执行各种恶意操作，包括：\n    *   执行任意命令。\n    *   篡改防火墙配置。\n    *   利用其他漏洞进一步攻击。\n\n**缓解措施：**\n*   限制管理界面访问：根据 Palo Alto Networks 的最佳实践指南，仅允许受信任的内部 IP 地址访问管理 Web 界面。\n*   应用威胁防御：如果拥有威胁防御订阅，可以使用威胁 ID 95746、95747、95752、95753、95759 和 95763 阻止攻击。\n*   及时更新：升级到已修复此漏洞的 PAN-OS 版本 (10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本)。

**项目地址:** [XiaomingX/cve-2024-0012-poc](https://github.com/XiaomingX/cve-2024-0012-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #6

**来源**: [CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md](../2024/CVE-2024-0012-dcollaoa_cve-2024-0012-gui-poc.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用（如CVE-2024-9474）

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 (受影响版本低于已修复版本)

**利用条件:** 需要网络访问目标PAN-OS设备的管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012是Palo Alto Networks PAN-OS软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理Web界面，可以获取PAN-OS管理员权限，执行管理操作，篡改配置或利用其他身份验证的权限提升漏洞。根据漏洞描述和搜索结果，该漏洞影响特定版本的PAN-OS，且存在在野利用。提供的POC代码（`cve-2024-0012-gui.py`）利用了此漏洞。利用方式如下：

1.  **创建初始会话：**  通过`createRemoteAppwebSession.php`端点，设置`X-PAN-AUTHCHECK`为`off`，并且在POST数据中，将`user`参数设置为包含命令注入的恶意代码。攻击者可以通过这个方式在目标机器上写入一个PHP文件，例如`cve.php`。命令通过反引号执行，将结果写入PHP文件。
2.  **触发执行：**  使用创建的`PHPSESSID` cookie，访问`/index.php/.js.map`端点，触发之前注入的命令执行。
3.  **验证执行：**  访问`/unauth/cve.php`，检查命令是否成功执行，并获取命令输出。

**投毒风险分析：**

查看`cve-2024-0012-gui.py`脚本，发现其主要功能是利用漏洞进行命令注入和验证，基本符合漏洞利用的逻辑。`self.command_input = QLineEdit()` 允许用户输入命令，增加了灵活性，但也引入了一定的风险，使用者可能使用恶意命令。但是从代码逻辑上，此仓库直接投毒的可能性较低。`README.md`文件仅包含漏洞描述和作者信息，无恶意代码。

总而言之，考虑到代码的开源性质，以及主要功能符合漏洞利用的预期，投毒的概率较低，但是命令的执行权交给了用户，如果用户使用了恶意命令，也可能造成危害。因此投毒风险评估为10%。

**项目地址:** [dcollaoa/cve-2024-0012-gui-poc](https://github.com/dcollaoa/cve-2024-0012-gui-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #7

**来源**: [CVE-2024-0012-greaselovely_CVE-2024-0012.md](../2024/CVE-2024-0012-greaselovely_CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** Authentication Bypass

**影响应用:** PAN-OS

**危害等级:** Critical, allows unauthenticated remote attackers to gain administrator privileges.

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 software before the fixed versions.

**利用条件:** The management web interface must be accessible over the network, especially from the internet.

**POC 可用性:** Yes

**投毒风险:** 10%

## 详情

CVE-2024-0012 is an authentication bypass vulnerability in Palo Alto Networks PAN-OS. An unauthenticated attacker with network access to the management web interface can gain PAN-OS administrator privileges. 

**有效性：**
根据漏洞库信息、搜索引擎结果（尤其是来自Palo Alto Networks自身以及Arctic Wolf等安全公司的报告）以及提供的PoC代码，此漏洞是真实且已被利用的。PoC代码通过检查特定URL的响应状态码、Header以及页面内容是否包含`Zero Touch Provisioning`和`window.Pan`等特征字符串来判断目标是否存在漏洞，表明PoC的有效性。

**投毒风险：**
PoC代码主要用于检测漏洞是否存在，其本身功能相对简单，未发现明显的恶意代码。代码中使用的`requests`库可能存在潜在风险，如果被替换为恶意版本，可能导致信息泄露或代码执行。LICENSE文件采用MIT开源协议，允许修改和再分发，这也会增加潜在的投毒风险。考虑到requests库的潜在风险和开源协议的开放性，投毒风险评定为10%。

**利用方式：**
1.  **网络访问:** 攻击者需要能够通过网络访问目标Palo Alto Networks设备的管理Web界面。
2.  **漏洞触发:** 攻击者发送特制的HTTP请求到目标设备的管理Web界面，绕过身份验证。
3.  **权限提升:** 成功绕过身份验证后，攻击者获得PAN-OS管理员权限，可以执行任意管理操作，篡改配置或利用其他漏洞。
4. **后续利用:** 可能会结合 CVE-2024-9474 进一步利用， 执行任意命令。

**项目地址:** [greaselovely/CVE-2024-0012](https://github.com/greaselovely/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #8

**来源**: [CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md](../2024/CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 管理 Web 界面可以通过网络访问，特别是来自互联网的访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能访问管理 Web 界面，就可以获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或者利用其他需要身份验证的提权漏洞（如 CVE-2024-9474）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用漏洞绕过管理 Web 界面的身份验证机制，无需提供有效的用户名和密码。
2.  **权限提升：** 成功绕过身份验证后，攻击者获得管理员权限。
3.  **恶意操作：** 攻击者可以使用管理员权限执行各种恶意操作，包括：
    *   篡改防火墙配置。
    *   执行任意命令。
    *   利用其他漏洞。

**POC 分析：**

提供的 POC 代码 (`cve-2024-0012-pan-os-poc.py`) 旨在验证漏洞的存在。该 POC 脚本执行以下步骤：

1.  **创建初始会话：** 使用包含命令注入 payload 的 `X-PAN-AUTHCHECK: off` 头发送 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`， 注入的命令将系统信息写入 `/var/appweb/htdocs/unauth/watchTowr.php` 文件。
2.  **触发执行：** 通过包含会话 ID 的 cookie，发送 GET 请求到 `/index.php/.js.map`，触发命令执行。
3.  **验证执行：** 检查 `/unauth/watchTowr.php` 是否存在且包含系统信息，以验证命令是否成功执行。

**投毒风险：**

POC 本身主要用于验证漏洞的存在。该POC 在`/var/appweb/htdocs/unauth/watchTowr.php`下创建了一个php文件，这个文件本身可以被用于后续的攻击.POC中注入的命令是将系统信息写入文件，但是完全可以替换成其他恶意命令.  因此虽然POC本身不是恶意代码, 但在后续使用时存在被滥用的风险。 仓库本身作者隐藏的投毒代码的可能性较低, 为10%.

**有效性：**

根据漏洞信息和 POC 代码，该漏洞是有效的，并且已经被观察到在野外被利用。

**项目地址:** [punitdarji/Paloalto-CVE-2024-0012](https://github.com/punitdarji/Paloalto-CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #9

**来源**: [CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md](../2024/CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 受影响版本

**利用条件:** 需要网络访问管理Web界面，特别是当管理界面暴露在互联网上时

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过网络访问管理 Web 界面，获得 PAN-OS 管理员权限。利用方式如下：

1.  **漏洞描述：** 攻击者可以绕过身份验证，从而执行管理操作，篡改配置或利用其他经过身份验证的权限提升漏洞（例如 CVE-2024-9474）。
2.  **影响范围：** PAN-OS 10.2, 11.0, 11.1 和 11.2 版本受影响。 Cloud NGFW 和 Prisma Access 不受此漏洞影响。
3.  **利用条件：** 攻击者需要能够通过网络访问 PAN-OS 的管理 Web 界面。如果管理界面暴露在互联网上，风险最高。限制仅从受信任的内部 IP 地址访问管理界面可以大大降低风险。
4.  **POC 验证：** 提供的 POC 代码 (`palo-alto-vpn-CVE-2024-0012-check-wt.yaml`) 是一个 Nuclei 模板，用于检测目标是否存在 CVE-2024-0012 漏洞。它通过发送一个带有 `X-PAN-AUTHCHECK: off` 头的 GET 请求到 `/php/utils/CmsGetDeviceSoftwareVersion.php/.js.map` 路径来尝试绕过身份验证。如果服务器返回状态码 200，并且响应头包含特定的字段（如 `Expires: 0`, `PHPSESSID=`, `application/json`）以及响应正文中包含字符串 "0.0.0"，则认为目标存在漏洞。
5.  **投毒风险分析：**
    *   POC 代码本身主要用于漏洞检测，目的是验证漏洞是否存在。`README.md` 仅提供漏洞信息和作者信息。
    *   虽然 POC 代码的目的是检测，但如果被恶意修改，例如在检测的同时执行某些恶意操作（例如，修改防火墙规则），则存在投毒的潜在风险。但当前提供的代码不具备该功能。仓库中其他文件主要是描述信息，没有发现明显的恶意代码。基于以上分析，投毒风险较低，估计约为 5%。 风险主要在于未来可能出现的恶意变种或二次修改。
6.  **缓解措施：**
    *   升级到已修复的 PAN-OS 版本（10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本）。
    *   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
    *   如果使用威胁防御订阅，可以使用威胁 ID 95746, 95747, 95752, 95753, 95759 和 95763 (在 Applications and Threats 内容版本 8915-9075 及更高版本中可用) 来阻止攻击。确保所有列出的威胁 ID 都设置为阻止模式，并通过 DP 端口路由 MGT 端口的入站流量，替换入站流量管理的证书，解密到管理界面的入站流量，并在到管理服务的入站流量上启用威胁防御。

**项目地址:** [watchtowrlabs/palo-alto-panos-cve-2024-0012](https://github.com/watchtowrlabs/palo-alto-panos-cve-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---



---

## POC #9

**来源**: [CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md](../2024/CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 管理 Web 界面可以通过网络访问，特别是来自互联网的访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能访问管理 Web 界面，就可以获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或者利用其他需要身份验证的提权漏洞（如 CVE-2024-9474）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用漏洞绕过管理 Web 界面的身份验证机制，无需提供有效的用户名和密码。
2.  **权限提升：** 成功绕过身份验证后，攻击者获得管理员权限。
3.  **恶意操作：** 攻击者可以使用管理员权限执行各种恶意操作，包括：
    *   篡改防火墙配置。
    *   执行任意命令。
    *   利用其他漏洞。

**POC 分析：**

提供的 POC 代码 (`cve-2024-0012-pan-os-poc.py`) 旨在验证漏洞的存在。该 POC 脚本执行以下步骤：

1.  **创建初始会话：** 使用包含命令注入 payload 的 `X-PAN-AUTHCHECK: off` 头发送 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`， 注入的命令将系统信息写入 `/var/appweb/htdocs/unauth/watchTowr.php` 文件。
2.  **触发执行：** 通过包含会话 ID 的 cookie，发送 GET 请求到 `/index.php/.js.map`，触发命令执行。
3.  **验证执行：** 检查 `/unauth/watchTowr.php` 是否存在且包含系统信息，以验证命令是否成功执行。

**投毒风险：**

POC 本身主要用于验证漏洞的存在。该POC 在`/var/appweb/htdocs/unauth/watchTowr.php`下创建了一个php文件，这个文件本身可以被用于后续的攻击.POC中注入的命令是将系统信息写入文件，但是完全可以替换成其他恶意命令.  因此虽然POC本身不是恶意代码, 但在后续使用时存在被滥用的风险。 仓库本身作者隐藏的投毒代码的可能性较低, 为10%.

**有效性：**

根据漏洞信息和 POC 代码，该漏洞是有效的，并且已经被观察到在野外被利用。

**项目地址:** [punitdarji/Paloalto-CVE-2024-0012](https://github.com/punitdarji/Paloalto-CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #10

**来源**: [CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md](../2024/CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 受影响版本

**利用条件:** 需要网络访问管理Web界面，特别是当管理界面暴露在互联网上时

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过网络访问管理 Web 界面，获得 PAN-OS 管理员权限。利用方式如下：

1.  **漏洞描述：** 攻击者可以绕过身份验证，从而执行管理操作，篡改配置或利用其他经过身份验证的权限提升漏洞（例如 CVE-2024-9474）。
2.  **影响范围：** PAN-OS 10.2, 11.0, 11.1 和 11.2 版本受影响。 Cloud NGFW 和 Prisma Access 不受此漏洞影响。
3.  **利用条件：** 攻击者需要能够通过网络访问 PAN-OS 的管理 Web 界面。如果管理界面暴露在互联网上，风险最高。限制仅从受信任的内部 IP 地址访问管理界面可以大大降低风险。
4.  **POC 验证：** 提供的 POC 代码 (`palo-alto-vpn-CVE-2024-0012-check-wt.yaml`) 是一个 Nuclei 模板，用于检测目标是否存在 CVE-2024-0012 漏洞。它通过发送一个带有 `X-PAN-AUTHCHECK: off` 头的 GET 请求到 `/php/utils/CmsGetDeviceSoftwareVersion.php/.js.map` 路径来尝试绕过身份验证。如果服务器返回状态码 200，并且响应头包含特定的字段（如 `Expires: 0`, `PHPSESSID=`, `application/json`）以及响应正文中包含字符串 "0.0.0"，则认为目标存在漏洞。
5.  **投毒风险分析：**
    *   POC 代码本身主要用于漏洞检测，目的是验证漏洞是否存在。`README.md` 仅提供漏洞信息和作者信息。
    *   虽然 POC 代码的目的是检测，但如果被恶意修改，例如在检测的同时执行某些恶意操作（例如，修改防火墙规则），则存在投毒的潜在风险。但当前提供的代码不具备该功能。仓库中其他文件主要是描述信息，没有发现明显的恶意代码。基于以上分析，投毒风险较低，估计约为 5%。 风险主要在于未来可能出现的恶意变种或二次修改。
6.  **缓解措施：**
    *   升级到已修复的 PAN-OS 版本（10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本）。
    *   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
    *   如果使用威胁防御订阅，可以使用威胁 ID 95746, 95747, 95752, 95753, 95759 和 95763 (在 Applications and Threats 内容版本 8915-9075 及更高版本中可用) 来阻止攻击。确保所有列出的威胁 ID 都设置为阻止模式，并通过 DP 端口路由 MGT 端口的入站流量，替换入站流量管理的证书，解密到管理界面的入站流量，并在到管理服务的入站流量上启用威胁防御。

**项目地址:** [watchtowrlabs/palo-alto-panos-cve-2024-0012](https://github.com/watchtowrlabs/palo-alto-panos-cve-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---



---

## POC #9

**来源**: [CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md](../2024/CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 管理 Web 界面可以通过网络访问，特别是来自互联网的访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能访问管理 Web 界面，就可以获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或者利用其他需要身份验证的提权漏洞（如 CVE-2024-9474）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用漏洞绕过管理 Web 界面的身份验证机制，无需提供有效的用户名和密码。
2.  **权限提升：** 成功绕过身份验证后，攻击者获得管理员权限。
3.  **恶意操作：** 攻击者可以使用管理员权限执行各种恶意操作，包括：
    *   篡改防火墙配置。
    *   执行任意命令。
    *   利用其他漏洞。

**POC 分析：**

提供的 POC 代码 (`cve-2024-0012-pan-os-poc.py`) 旨在验证漏洞的存在。该 POC 脚本执行以下步骤：

1.  **创建初始会话：** 使用包含命令注入 payload 的 `X-PAN-AUTHCHECK: off` 头发送 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`， 注入的命令将系统信息写入 `/var/appweb/htdocs/unauth/watchTowr.php` 文件。
2.  **触发执行：** 通过包含会话 ID 的 cookie，发送 GET 请求到 `/index.php/.js.map`，触发命令执行。
3.  **验证执行：** 检查 `/unauth/watchTowr.php` 是否存在且包含系统信息，以验证命令是否成功执行。

**投毒风险：**

POC 本身主要用于验证漏洞的存在。该POC 在`/var/appweb/htdocs/unauth/watchTowr.php`下创建了一个php文件，这个文件本身可以被用于后续的攻击.POC中注入的命令是将系统信息写入文件，但是完全可以替换成其他恶意命令.  因此虽然POC本身不是恶意代码, 但在后续使用时存在被滥用的风险。 仓库本身作者隐藏的投毒代码的可能性较低, 为10%.

**有效性：**

根据漏洞信息和 POC 代码，该漏洞是有效的，并且已经被观察到在野外被利用。

**项目地址:** [punitdarji/Paloalto-CVE-2024-0012](https://github.com/punitdarji/Paloalto-CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #10

**来源**: [CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md](../2024/CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 受影响版本

**利用条件:** 需要网络访问管理Web界面，特别是当管理界面暴露在互联网上时

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过网络访问管理 Web 界面，获得 PAN-OS 管理员权限。利用方式如下：

1.  **漏洞描述：** 攻击者可以绕过身份验证，从而执行管理操作，篡改配置或利用其他经过身份验证的权限提升漏洞（例如 CVE-2024-9474）。
2.  **影响范围：** PAN-OS 10.2, 11.0, 11.1 和 11.2 版本受影响。 Cloud NGFW 和 Prisma Access 不受此漏洞影响。
3.  **利用条件：** 攻击者需要能够通过网络访问 PAN-OS 的管理 Web 界面。如果管理界面暴露在互联网上，风险最高。限制仅从受信任的内部 IP 地址访问管理界面可以大大降低风险。
4.  **POC 验证：** 提供的 POC 代码 (`palo-alto-vpn-CVE-2024-0012-check-wt.yaml`) 是一个 Nuclei 模板，用于检测目标是否存在 CVE-2024-0012 漏洞。它通过发送一个带有 `X-PAN-AUTHCHECK: off` 头的 GET 请求到 `/php/utils/CmsGetDeviceSoftwareVersion.php/.js.map` 路径来尝试绕过身份验证。如果服务器返回状态码 200，并且响应头包含特定的字段（如 `Expires: 0`, `PHPSESSID=`, `application/json`）以及响应正文中包含字符串 "0.0.0"，则认为目标存在漏洞。
5.  **投毒风险分析：**
    *   POC 代码本身主要用于漏洞检测，目的是验证漏洞是否存在。`README.md` 仅提供漏洞信息和作者信息。
    *   虽然 POC 代码的目的是检测，但如果被恶意修改，例如在检测的同时执行某些恶意操作（例如，修改防火墙规则），则存在投毒的潜在风险。但当前提供的代码不具备该功能。仓库中其他文件主要是描述信息，没有发现明显的恶意代码。基于以上分析，投毒风险较低，估计约为 5%。 风险主要在于未来可能出现的恶意变种或二次修改。
6.  **缓解措施：**
    *   升级到已修复的 PAN-OS 版本（10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本）。
    *   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
    *   如果使用威胁防御订阅，可以使用威胁 ID 95746, 95747, 95752, 95753, 95759 和 95763 (在 Applications and Threats 内容版本 8915-9075 及更高版本中可用) 来阻止攻击。确保所有列出的威胁 ID 都设置为阻止模式，并通过 DP 端口路由 MGT 端口的入站流量，替换入站流量管理的证书，解密到管理界面的入站流量，并在到管理服务的入站流量上启用威胁防御。

**项目地址:** [watchtowrlabs/palo-alto-panos-cve-2024-0012](https://github.com/watchtowrlabs/palo-alto-panos-cve-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---



---

## POC #9

**来源**: [CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md](../2024/CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 管理 Web 界面可以通过网络访问，特别是来自互联网的访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能访问管理 Web 界面，就可以获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或者利用其他需要身份验证的提权漏洞（如 CVE-2024-9474）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用漏洞绕过管理 Web 界面的身份验证机制，无需提供有效的用户名和密码。
2.  **权限提升：** 成功绕过身份验证后，攻击者获得管理员权限。
3.  **恶意操作：** 攻击者可以使用管理员权限执行各种恶意操作，包括：
    *   篡改防火墙配置。
    *   执行任意命令。
    *   利用其他漏洞。

**POC 分析：**

提供的 POC 代码 (`cve-2024-0012-pan-os-poc.py`) 旨在验证漏洞的存在。该 POC 脚本执行以下步骤：

1.  **创建初始会话：** 使用包含命令注入 payload 的 `X-PAN-AUTHCHECK: off` 头发送 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`， 注入的命令将系统信息写入 `/var/appweb/htdocs/unauth/watchTowr.php` 文件。
2.  **触发执行：** 通过包含会话 ID 的 cookie，发送 GET 请求到 `/index.php/.js.map`，触发命令执行。
3.  **验证执行：** 检查 `/unauth/watchTowr.php` 是否存在且包含系统信息，以验证命令是否成功执行。

**投毒风险：**

POC 本身主要用于验证漏洞的存在。该POC 在`/var/appweb/htdocs/unauth/watchTowr.php`下创建了一个php文件，这个文件本身可以被用于后续的攻击.POC中注入的命令是将系统信息写入文件，但是完全可以替换成其他恶意命令.  因此虽然POC本身不是恶意代码, 但在后续使用时存在被滥用的风险。 仓库本身作者隐藏的投毒代码的可能性较低, 为10%.

**有效性：**

根据漏洞信息和 POC 代码，该漏洞是有效的，并且已经被观察到在野外被利用。

**项目地址:** [punitdarji/Paloalto-CVE-2024-0012](https://github.com/punitdarji/Paloalto-CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #10

**来源**: [CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md](../2024/CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 受影响版本

**利用条件:** 需要网络访问管理Web界面，特别是当管理界面暴露在互联网上时

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过网络访问管理 Web 界面，获得 PAN-OS 管理员权限。利用方式如下：

1.  **漏洞描述：** 攻击者可以绕过身份验证，从而执行管理操作，篡改配置或利用其他经过身份验证的权限提升漏洞（例如 CVE-2024-9474）。
2.  **影响范围：** PAN-OS 10.2, 11.0, 11.1 和 11.2 版本受影响。 Cloud NGFW 和 Prisma Access 不受此漏洞影响。
3.  **利用条件：** 攻击者需要能够通过网络访问 PAN-OS 的管理 Web 界面。如果管理界面暴露在互联网上，风险最高。限制仅从受信任的内部 IP 地址访问管理界面可以大大降低风险。
4.  **POC 验证：** 提供的 POC 代码 (`palo-alto-vpn-CVE-2024-0012-check-wt.yaml`) 是一个 Nuclei 模板，用于检测目标是否存在 CVE-2024-0012 漏洞。它通过发送一个带有 `X-PAN-AUTHCHECK: off` 头的 GET 请求到 `/php/utils/CmsGetDeviceSoftwareVersion.php/.js.map` 路径来尝试绕过身份验证。如果服务器返回状态码 200，并且响应头包含特定的字段（如 `Expires: 0`, `PHPSESSID=`, `application/json`）以及响应正文中包含字符串 "0.0.0"，则认为目标存在漏洞。
5.  **投毒风险分析：**
    *   POC 代码本身主要用于漏洞检测，目的是验证漏洞是否存在。`README.md` 仅提供漏洞信息和作者信息。
    *   虽然 POC 代码的目的是检测，但如果被恶意修改，例如在检测的同时执行某些恶意操作（例如，修改防火墙规则），则存在投毒的潜在风险。但当前提供的代码不具备该功能。仓库中其他文件主要是描述信息，没有发现明显的恶意代码。基于以上分析，投毒风险较低，估计约为 5%。 风险主要在于未来可能出现的恶意变种或二次修改。
6.  **缓解措施：**
    *   升级到已修复的 PAN-OS 版本（10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本）。
    *   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
    *   如果使用威胁防御订阅，可以使用威胁 ID 95746, 95747, 95752, 95753, 95759 和 95763 (在 Applications and Threats 内容版本 8915-9075 及更高版本中可用) 来阻止攻击。确保所有列出的威胁 ID 都设置为阻止模式，并通过 DP 端口路由 MGT 端口的入站流量，替换入站流量管理的证书，解密到管理界面的入站流量，并在到管理服务的入站流量上启用威胁防御。

**项目地址:** [watchtowrlabs/palo-alto-panos-cve-2024-0012](https://github.com/watchtowrlabs/palo-alto-panos-cve-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---



---

## POC #9

**来源**: [CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md](../2024/CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 管理 Web 界面可以通过网络访问，特别是来自互联网的访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能访问管理 Web 界面，就可以获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或者利用其他需要身份验证的提权漏洞（如 CVE-2024-9474）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用漏洞绕过管理 Web 界面的身份验证机制，无需提供有效的用户名和密码。
2.  **权限提升：** 成功绕过身份验证后，攻击者获得管理员权限。
3.  **恶意操作：** 攻击者可以使用管理员权限执行各种恶意操作，包括：
    *   篡改防火墙配置。
    *   执行任意命令。
    *   利用其他漏洞。

**POC 分析：**

提供的 POC 代码 (`cve-2024-0012-pan-os-poc.py`) 旨在验证漏洞的存在。该 POC 脚本执行以下步骤：

1.  **创建初始会话：** 使用包含命令注入 payload 的 `X-PAN-AUTHCHECK: off` 头发送 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`， 注入的命令将系统信息写入 `/var/appweb/htdocs/unauth/watchTowr.php` 文件。
2.  **触发执行：** 通过包含会话 ID 的 cookie，发送 GET 请求到 `/index.php/.js.map`，触发命令执行。
3.  **验证执行：** 检查 `/unauth/watchTowr.php` 是否存在且包含系统信息，以验证命令是否成功执行。

**投毒风险：**

POC 本身主要用于验证漏洞的存在。该POC 在`/var/appweb/htdocs/unauth/watchTowr.php`下创建了一个php文件，这个文件本身可以被用于后续的攻击.POC中注入的命令是将系统信息写入文件，但是完全可以替换成其他恶意命令.  因此虽然POC本身不是恶意代码, 但在后续使用时存在被滥用的风险。 仓库本身作者隐藏的投毒代码的可能性较低, 为10%.

**有效性：**

根据漏洞信息和 POC 代码，该漏洞是有效的，并且已经被观察到在野外被利用。

**项目地址:** [punitdarji/Paloalto-CVE-2024-0012](https://github.com/punitdarji/Paloalto-CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #10

**来源**: [CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md](../2024/CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 受影响版本

**利用条件:** 需要网络访问管理Web界面，特别是当管理界面暴露在互联网上时

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过网络访问管理 Web 界面，获得 PAN-OS 管理员权限。利用方式如下：

1.  **漏洞描述：** 攻击者可以绕过身份验证，从而执行管理操作，篡改配置或利用其他经过身份验证的权限提升漏洞（例如 CVE-2024-9474）。
2.  **影响范围：** PAN-OS 10.2, 11.0, 11.1 和 11.2 版本受影响。 Cloud NGFW 和 Prisma Access 不受此漏洞影响。
3.  **利用条件：** 攻击者需要能够通过网络访问 PAN-OS 的管理 Web 界面。如果管理界面暴露在互联网上，风险最高。限制仅从受信任的内部 IP 地址访问管理界面可以大大降低风险。
4.  **POC 验证：** 提供的 POC 代码 (`palo-alto-vpn-CVE-2024-0012-check-wt.yaml`) 是一个 Nuclei 模板，用于检测目标是否存在 CVE-2024-0012 漏洞。它通过发送一个带有 `X-PAN-AUTHCHECK: off` 头的 GET 请求到 `/php/utils/CmsGetDeviceSoftwareVersion.php/.js.map` 路径来尝试绕过身份验证。如果服务器返回状态码 200，并且响应头包含特定的字段（如 `Expires: 0`, `PHPSESSID=`, `application/json`）以及响应正文中包含字符串 "0.0.0"，则认为目标存在漏洞。
5.  **投毒风险分析：**
    *   POC 代码本身主要用于漏洞检测，目的是验证漏洞是否存在。`README.md` 仅提供漏洞信息和作者信息。
    *   虽然 POC 代码的目的是检测，但如果被恶意修改，例如在检测的同时执行某些恶意操作（例如，修改防火墙规则），则存在投毒的潜在风险。但当前提供的代码不具备该功能。仓库中其他文件主要是描述信息，没有发现明显的恶意代码。基于以上分析，投毒风险较低，估计约为 5%。 风险主要在于未来可能出现的恶意变种或二次修改。
6.  **缓解措施：**
    *   升级到已修复的 PAN-OS 版本（10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本）。
    *   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
    *   如果使用威胁防御订阅，可以使用威胁 ID 95746, 95747, 95752, 95753, 95759 和 95763 (在 Applications and Threats 内容版本 8915-9075 及更高版本中可用) 来阻止攻击。确保所有列出的威胁 ID 都设置为阻止模式，并通过 DP 端口路由 MGT 端口的入站流量，替换入站流量管理的证书，解密到管理界面的入站流量，并在到管理服务的入站流量上启用威胁防御。

**项目地址:** [watchtowrlabs/palo-alto-panos-cve-2024-0012](https://github.com/watchtowrlabs/palo-alto-panos-cve-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---



---

## POC #9

**来源**: [CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md](../2024/CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 管理 Web 界面可以通过网络访问，特别是来自互联网的访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能访问管理 Web 界面，就可以获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或者利用其他需要身份验证的提权漏洞（如 CVE-2024-9474）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用漏洞绕过管理 Web 界面的身份验证机制，无需提供有效的用户名和密码。
2.  **权限提升：** 成功绕过身份验证后，攻击者获得管理员权限。
3.  **恶意操作：** 攻击者可以使用管理员权限执行各种恶意操作，包括：
    *   篡改防火墙配置。
    *   执行任意命令。
    *   利用其他漏洞。

**POC 分析：**

提供的 POC 代码 (`cve-2024-0012-pan-os-poc.py`) 旨在验证漏洞的存在。该 POC 脚本执行以下步骤：

1.  **创建初始会话：** 使用包含命令注入 payload 的 `X-PAN-AUTHCHECK: off` 头发送 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`， 注入的命令将系统信息写入 `/var/appweb/htdocs/unauth/watchTowr.php` 文件。
2.  **触发执行：** 通过包含会话 ID 的 cookie，发送 GET 请求到 `/index.php/.js.map`，触发命令执行。
3.  **验证执行：** 检查 `/unauth/watchTowr.php` 是否存在且包含系统信息，以验证命令是否成功执行。

**投毒风险：**

POC 本身主要用于验证漏洞的存在。该POC 在`/var/appweb/htdocs/unauth/watchTowr.php`下创建了一个php文件，这个文件本身可以被用于后续的攻击.POC中注入的命令是将系统信息写入文件，但是完全可以替换成其他恶意命令.  因此虽然POC本身不是恶意代码, 但在后续使用时存在被滥用的风险。 仓库本身作者隐藏的投毒代码的可能性较低, 为10%.

**有效性：**

根据漏洞信息和 POC 代码，该漏洞是有效的，并且已经被观察到在野外被利用。

**项目地址:** [punitdarji/Paloalto-CVE-2024-0012](https://github.com/punitdarji/Paloalto-CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #10

**来源**: [CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md](../2024/CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 受影响版本

**利用条件:** 需要网络访问管理Web界面，特别是当管理界面暴露在互联网上时

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过网络访问管理 Web 界面，获得 PAN-OS 管理员权限。利用方式如下：

1.  **漏洞描述：** 攻击者可以绕过身份验证，从而执行管理操作，篡改配置或利用其他经过身份验证的权限提升漏洞（例如 CVE-2024-9474）。
2.  **影响范围：** PAN-OS 10.2, 11.0, 11.1 和 11.2 版本受影响。 Cloud NGFW 和 Prisma Access 不受此漏洞影响。
3.  **利用条件：** 攻击者需要能够通过网络访问 PAN-OS 的管理 Web 界面。如果管理界面暴露在互联网上，风险最高。限制仅从受信任的内部 IP 地址访问管理界面可以大大降低风险。
4.  **POC 验证：** 提供的 POC 代码 (`palo-alto-vpn-CVE-2024-0012-check-wt.yaml`) 是一个 Nuclei 模板，用于检测目标是否存在 CVE-2024-0012 漏洞。它通过发送一个带有 `X-PAN-AUTHCHECK: off` 头的 GET 请求到 `/php/utils/CmsGetDeviceSoftwareVersion.php/.js.map` 路径来尝试绕过身份验证。如果服务器返回状态码 200，并且响应头包含特定的字段（如 `Expires: 0`, `PHPSESSID=`, `application/json`）以及响应正文中包含字符串 "0.0.0"，则认为目标存在漏洞。
5.  **投毒风险分析：**
    *   POC 代码本身主要用于漏洞检测，目的是验证漏洞是否存在。`README.md` 仅提供漏洞信息和作者信息。
    *   虽然 POC 代码的目的是检测，但如果被恶意修改，例如在检测的同时执行某些恶意操作（例如，修改防火墙规则），则存在投毒的潜在风险。但当前提供的代码不具备该功能。仓库中其他文件主要是描述信息，没有发现明显的恶意代码。基于以上分析，投毒风险较低，估计约为 5%。 风险主要在于未来可能出现的恶意变种或二次修改。
6.  **缓解措施：**
    *   升级到已修复的 PAN-OS 版本（10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本）。
    *   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
    *   如果使用威胁防御订阅，可以使用威胁 ID 95746, 95747, 95752, 95753, 95759 和 95763 (在 Applications and Threats 内容版本 8915-9075 及更高版本中可用) 来阻止攻击。确保所有列出的威胁 ID 都设置为阻止模式，并通过 DP 端口路由 MGT 端口的入站流量，替换入站流量管理的证书，解密到管理界面的入站流量，并在到管理服务的入站流量上启用威胁防御。

**项目地址:** [watchtowrlabs/palo-alto-panos-cve-2024-0012](https://github.com/watchtowrlabs/palo-alto-panos-cve-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---



---

## POC #9

**来源**: [CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md](../2024/CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 管理 Web 界面可以通过网络访问，特别是来自互联网的访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能访问管理 Web 界面，就可以获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或者利用其他需要身份验证的提权漏洞（如 CVE-2024-9474）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用漏洞绕过管理 Web 界面的身份验证机制，无需提供有效的用户名和密码。
2.  **权限提升：** 成功绕过身份验证后，攻击者获得管理员权限。
3.  **恶意操作：** 攻击者可以使用管理员权限执行各种恶意操作，包括：
    *   篡改防火墙配置。
    *   执行任意命令。
    *   利用其他漏洞。

**POC 分析：**

提供的 POC 代码 (`cve-2024-0012-pan-os-poc.py`) 旨在验证漏洞的存在。该 POC 脚本执行以下步骤：

1.  **创建初始会话：** 使用包含命令注入 payload 的 `X-PAN-AUTHCHECK: off` 头发送 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`， 注入的命令将系统信息写入 `/var/appweb/htdocs/unauth/watchTowr.php` 文件。
2.  **触发执行：** 通过包含会话 ID 的 cookie，发送 GET 请求到 `/index.php/.js.map`，触发命令执行。
3.  **验证执行：** 检查 `/unauth/watchTowr.php` 是否存在且包含系统信息，以验证命令是否成功执行。

**投毒风险：**

POC 本身主要用于验证漏洞的存在。该POC 在`/var/appweb/htdocs/unauth/watchTowr.php`下创建了一个php文件，这个文件本身可以被用于后续的攻击.POC中注入的命令是将系统信息写入文件，但是完全可以替换成其他恶意命令.  因此虽然POC本身不是恶意代码, 但在后续使用时存在被滥用的风险。 仓库本身作者隐藏的投毒代码的可能性较低, 为10%.

**有效性：**

根据漏洞信息和 POC 代码，该漏洞是有效的，并且已经被观察到在野外被利用。

**项目地址:** [punitdarji/Paloalto-CVE-2024-0012](https://github.com/punitdarji/Paloalto-CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #10

**来源**: [CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md](../2024/CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 受影响版本

**利用条件:** 需要网络访问管理Web界面，特别是当管理界面暴露在互联网上时

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过网络访问管理 Web 界面，获得 PAN-OS 管理员权限。利用方式如下：

1.  **漏洞描述：** 攻击者可以绕过身份验证，从而执行管理操作，篡改配置或利用其他经过身份验证的权限提升漏洞（例如 CVE-2024-9474）。
2.  **影响范围：** PAN-OS 10.2, 11.0, 11.1 和 11.2 版本受影响。 Cloud NGFW 和 Prisma Access 不受此漏洞影响。
3.  **利用条件：** 攻击者需要能够通过网络访问 PAN-OS 的管理 Web 界面。如果管理界面暴露在互联网上，风险最高。限制仅从受信任的内部 IP 地址访问管理界面可以大大降低风险。
4.  **POC 验证：** 提供的 POC 代码 (`palo-alto-vpn-CVE-2024-0012-check-wt.yaml`) 是一个 Nuclei 模板，用于检测目标是否存在 CVE-2024-0012 漏洞。它通过发送一个带有 `X-PAN-AUTHCHECK: off` 头的 GET 请求到 `/php/utils/CmsGetDeviceSoftwareVersion.php/.js.map` 路径来尝试绕过身份验证。如果服务器返回状态码 200，并且响应头包含特定的字段（如 `Expires: 0`, `PHPSESSID=`, `application/json`）以及响应正文中包含字符串 "0.0.0"，则认为目标存在漏洞。
5.  **投毒风险分析：**
    *   POC 代码本身主要用于漏洞检测，目的是验证漏洞是否存在。`README.md` 仅提供漏洞信息和作者信息。
    *   虽然 POC 代码的目的是检测，但如果被恶意修改，例如在检测的同时执行某些恶意操作（例如，修改防火墙规则），则存在投毒的潜在风险。但当前提供的代码不具备该功能。仓库中其他文件主要是描述信息，没有发现明显的恶意代码。基于以上分析，投毒风险较低，估计约为 5%。 风险主要在于未来可能出现的恶意变种或二次修改。
6.  **缓解措施：**
    *   升级到已修复的 PAN-OS 版本（10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本）。
    *   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
    *   如果使用威胁防御订阅，可以使用威胁 ID 95746, 95747, 95752, 95753, 95759 和 95763 (在 Applications and Threats 内容版本 8915-9075 及更高版本中可用) 来阻止攻击。确保所有列出的威胁 ID 都设置为阻止模式，并通过 DP 端口路由 MGT 端口的入站流量，替换入站流量管理的证书，解密到管理界面的入站流量，并在到管理服务的入站流量上启用威胁防御。

**项目地址:** [watchtowrlabs/palo-alto-panos-cve-2024-0012](https://github.com/watchtowrlabs/palo-alto-panos-cve-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---



---

## POC #9

**来源**: [CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md](../2024/CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 管理 Web 界面可以通过网络访问，特别是来自互联网的访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能访问管理 Web 界面，就可以获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或者利用其他需要身份验证的提权漏洞（如 CVE-2024-9474）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用漏洞绕过管理 Web 界面的身份验证机制，无需提供有效的用户名和密码。
2.  **权限提升：** 成功绕过身份验证后，攻击者获得管理员权限。
3.  **恶意操作：** 攻击者可以使用管理员权限执行各种恶意操作，包括：
    *   篡改防火墙配置。
    *   执行任意命令。
    *   利用其他漏洞。

**POC 分析：**

提供的 POC 代码 (`cve-2024-0012-pan-os-poc.py`) 旨在验证漏洞的存在。该 POC 脚本执行以下步骤：

1.  **创建初始会话：** 使用包含命令注入 payload 的 `X-PAN-AUTHCHECK: off` 头发送 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`， 注入的命令将系统信息写入 `/var/appweb/htdocs/unauth/watchTowr.php` 文件。
2.  **触发执行：** 通过包含会话 ID 的 cookie，发送 GET 请求到 `/index.php/.js.map`，触发命令执行。
3.  **验证执行：** 检查 `/unauth/watchTowr.php` 是否存在且包含系统信息，以验证命令是否成功执行。

**投毒风险：**

POC 本身主要用于验证漏洞的存在。该POC 在`/var/appweb/htdocs/unauth/watchTowr.php`下创建了一个php文件，这个文件本身可以被用于后续的攻击.POC中注入的命令是将系统信息写入文件，但是完全可以替换成其他恶意命令.  因此虽然POC本身不是恶意代码, 但在后续使用时存在被滥用的风险。 仓库本身作者隐藏的投毒代码的可能性较低, 为10%.

**有效性：**

根据漏洞信息和 POC 代码，该漏洞是有效的，并且已经被观察到在野外被利用。

**项目地址:** [punitdarji/Paloalto-CVE-2024-0012](https://github.com/punitdarji/Paloalto-CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #10

**来源**: [CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md](../2024/CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 受影响版本

**利用条件:** 需要网络访问管理Web界面，特别是当管理界面暴露在互联网上时

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过网络访问管理 Web 界面，获得 PAN-OS 管理员权限。利用方式如下：

1.  **漏洞描述：** 攻击者可以绕过身份验证，从而执行管理操作，篡改配置或利用其他经过身份验证的权限提升漏洞（例如 CVE-2024-9474）。
2.  **影响范围：** PAN-OS 10.2, 11.0, 11.1 和 11.2 版本受影响。 Cloud NGFW 和 Prisma Access 不受此漏洞影响。
3.  **利用条件：** 攻击者需要能够通过网络访问 PAN-OS 的管理 Web 界面。如果管理界面暴露在互联网上，风险最高。限制仅从受信任的内部 IP 地址访问管理界面可以大大降低风险。
4.  **POC 验证：** 提供的 POC 代码 (`palo-alto-vpn-CVE-2024-0012-check-wt.yaml`) 是一个 Nuclei 模板，用于检测目标是否存在 CVE-2024-0012 漏洞。它通过发送一个带有 `X-PAN-AUTHCHECK: off` 头的 GET 请求到 `/php/utils/CmsGetDeviceSoftwareVersion.php/.js.map` 路径来尝试绕过身份验证。如果服务器返回状态码 200，并且响应头包含特定的字段（如 `Expires: 0`, `PHPSESSID=`, `application/json`）以及响应正文中包含字符串 "0.0.0"，则认为目标存在漏洞。
5.  **投毒风险分析：**
    *   POC 代码本身主要用于漏洞检测，目的是验证漏洞是否存在。`README.md` 仅提供漏洞信息和作者信息。
    *   虽然 POC 代码的目的是检测，但如果被恶意修改，例如在检测的同时执行某些恶意操作（例如，修改防火墙规则），则存在投毒的潜在风险。但当前提供的代码不具备该功能。仓库中其他文件主要是描述信息，没有发现明显的恶意代码。基于以上分析，投毒风险较低，估计约为 5%。 风险主要在于未来可能出现的恶意变种或二次修改。
6.  **缓解措施：**
    *   升级到已修复的 PAN-OS 版本（10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本）。
    *   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
    *   如果使用威胁防御订阅，可以使用威胁 ID 95746, 95747, 95752, 95753, 95759 和 95763 (在 Applications and Threats 内容版本 8915-9075 及更高版本中可用) 来阻止攻击。确保所有列出的威胁 ID 都设置为阻止模式，并通过 DP 端口路由 MGT 端口的入站流量，替换入站流量管理的证书，解密到管理界面的入站流量，并在到管理服务的入站流量上启用威胁防御。

**项目地址:** [watchtowrlabs/palo-alto-panos-cve-2024-0012](https://github.com/watchtowrlabs/palo-alto-panos-cve-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---



---

## POC #9

**来源**: [CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md](../2024/CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 管理 Web 界面可以通过网络访问，特别是来自互联网的访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能访问管理 Web 界面，就可以获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或者利用其他需要身份验证的提权漏洞（如 CVE-2024-9474）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用漏洞绕过管理 Web 界面的身份验证机制，无需提供有效的用户名和密码。
2.  **权限提升：** 成功绕过身份验证后，攻击者获得管理员权限。
3.  **恶意操作：** 攻击者可以使用管理员权限执行各种恶意操作，包括：
    *   篡改防火墙配置。
    *   执行任意命令。
    *   利用其他漏洞。

**POC 分析：**

提供的 POC 代码 (`cve-2024-0012-pan-os-poc.py`) 旨在验证漏洞的存在。该 POC 脚本执行以下步骤：

1.  **创建初始会话：** 使用包含命令注入 payload 的 `X-PAN-AUTHCHECK: off` 头发送 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`， 注入的命令将系统信息写入 `/var/appweb/htdocs/unauth/watchTowr.php` 文件。
2.  **触发执行：** 通过包含会话 ID 的 cookie，发送 GET 请求到 `/index.php/.js.map`，触发命令执行。
3.  **验证执行：** 检查 `/unauth/watchTowr.php` 是否存在且包含系统信息，以验证命令是否成功执行。

**投毒风险：**

POC 本身主要用于验证漏洞的存在。该POC 在`/var/appweb/htdocs/unauth/watchTowr.php`下创建了一个php文件，这个文件本身可以被用于后续的攻击.POC中注入的命令是将系统信息写入文件，但是完全可以替换成其他恶意命令.  因此虽然POC本身不是恶意代码, 但在后续使用时存在被滥用的风险。 仓库本身作者隐藏的投毒代码的可能性较低, 为10%.

**有效性：**

根据漏洞信息和 POC 代码，该漏洞是有效的，并且已经被观察到在野外被利用。

**项目地址:** [punitdarji/Paloalto-CVE-2024-0012](https://github.com/punitdarji/Paloalto-CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #10

**来源**: [CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md](../2024/CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 受影响版本

**利用条件:** 需要网络访问管理Web界面，特别是当管理界面暴露在互联网上时

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过网络访问管理 Web 界面，获得 PAN-OS 管理员权限。利用方式如下：

1.  **漏洞描述：** 攻击者可以绕过身份验证，从而执行管理操作，篡改配置或利用其他经过身份验证的权限提升漏洞（例如 CVE-2024-9474）。
2.  **影响范围：** PAN-OS 10.2, 11.0, 11.1 和 11.2 版本受影响。 Cloud NGFW 和 Prisma Access 不受此漏洞影响。
3.  **利用条件：** 攻击者需要能够通过网络访问 PAN-OS 的管理 Web 界面。如果管理界面暴露在互联网上，风险最高。限制仅从受信任的内部 IP 地址访问管理界面可以大大降低风险。
4.  **POC 验证：** 提供的 POC 代码 (`palo-alto-vpn-CVE-2024-0012-check-wt.yaml`) 是一个 Nuclei 模板，用于检测目标是否存在 CVE-2024-0012 漏洞。它通过发送一个带有 `X-PAN-AUTHCHECK: off` 头的 GET 请求到 `/php/utils/CmsGetDeviceSoftwareVersion.php/.js.map` 路径来尝试绕过身份验证。如果服务器返回状态码 200，并且响应头包含特定的字段（如 `Expires: 0`, `PHPSESSID=`, `application/json`）以及响应正文中包含字符串 "0.0.0"，则认为目标存在漏洞。
5.  **投毒风险分析：**
    *   POC 代码本身主要用于漏洞检测，目的是验证漏洞是否存在。`README.md` 仅提供漏洞信息和作者信息。
    *   虽然 POC 代码的目的是检测，但如果被恶意修改，例如在检测的同时执行某些恶意操作（例如，修改防火墙规则），则存在投毒的潜在风险。但当前提供的代码不具备该功能。仓库中其他文件主要是描述信息，没有发现明显的恶意代码。基于以上分析，投毒风险较低，估计约为 5%。 风险主要在于未来可能出现的恶意变种或二次修改。
6.  **缓解措施：**
    *   升级到已修复的 PAN-OS 版本（10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本）。
    *   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
    *   如果使用威胁防御订阅，可以使用威胁 ID 95746, 95747, 95752, 95753, 95759 和 95763 (在 Applications and Threats 内容版本 8915-9075 及更高版本中可用) 来阻止攻击。确保所有列出的威胁 ID 都设置为阻止模式，并通过 DP 端口路由 MGT 端口的入站流量，替换入站流量管理的证书，解密到管理界面的入站流量，并在到管理服务的入站流量上启用威胁防御。

**项目地址:** [watchtowrlabs/palo-alto-panos-cve-2024-0012](https://github.com/watchtowrlabs/palo-alto-panos-cve-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---



---

## POC #9

**来源**: [CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md](../2024/CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 管理 Web 界面可以通过网络访问，特别是来自互联网的访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能访问管理 Web 界面，就可以获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或者利用其他需要身份验证的提权漏洞（如 CVE-2024-9474）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用漏洞绕过管理 Web 界面的身份验证机制，无需提供有效的用户名和密码。
2.  **权限提升：** 成功绕过身份验证后，攻击者获得管理员权限。
3.  **恶意操作：** 攻击者可以使用管理员权限执行各种恶意操作，包括：
    *   篡改防火墙配置。
    *   执行任意命令。
    *   利用其他漏洞。

**POC 分析：**

提供的 POC 代码 (`cve-2024-0012-pan-os-poc.py`) 旨在验证漏洞的存在。该 POC 脚本执行以下步骤：

1.  **创建初始会话：** 使用包含命令注入 payload 的 `X-PAN-AUTHCHECK: off` 头发送 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`， 注入的命令将系统信息写入 `/var/appweb/htdocs/unauth/watchTowr.php` 文件。
2.  **触发执行：** 通过包含会话 ID 的 cookie，发送 GET 请求到 `/index.php/.js.map`，触发命令执行。
3.  **验证执行：** 检查 `/unauth/watchTowr.php` 是否存在且包含系统信息，以验证命令是否成功执行。

**投毒风险：**

POC 本身主要用于验证漏洞的存在。该POC 在`/var/appweb/htdocs/unauth/watchTowr.php`下创建了一个php文件，这个文件本身可以被用于后续的攻击.POC中注入的命令是将系统信息写入文件，但是完全可以替换成其他恶意命令.  因此虽然POC本身不是恶意代码, 但在后续使用时存在被滥用的风险。 仓库本身作者隐藏的投毒代码的可能性较低, 为10%.

**有效性：**

根据漏洞信息和 POC 代码，该漏洞是有效的，并且已经被观察到在野外被利用。

**项目地址:** [punitdarji/Paloalto-CVE-2024-0012](https://github.com/punitdarji/Paloalto-CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #10

**来源**: [CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md](../2024/CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 受影响版本

**利用条件:** 需要网络访问管理Web界面，特别是当管理界面暴露在互联网上时

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过网络访问管理 Web 界面，获得 PAN-OS 管理员权限。利用方式如下：

1.  **漏洞描述：** 攻击者可以绕过身份验证，从而执行管理操作，篡改配置或利用其他经过身份验证的权限提升漏洞（例如 CVE-2024-9474）。
2.  **影响范围：** PAN-OS 10.2, 11.0, 11.1 和 11.2 版本受影响。 Cloud NGFW 和 Prisma Access 不受此漏洞影响。
3.  **利用条件：** 攻击者需要能够通过网络访问 PAN-OS 的管理 Web 界面。如果管理界面暴露在互联网上，风险最高。限制仅从受信任的内部 IP 地址访问管理界面可以大大降低风险。
4.  **POC 验证：** 提供的 POC 代码 (`palo-alto-vpn-CVE-2024-0012-check-wt.yaml`) 是一个 Nuclei 模板，用于检测目标是否存在 CVE-2024-0012 漏洞。它通过发送一个带有 `X-PAN-AUTHCHECK: off` 头的 GET 请求到 `/php/utils/CmsGetDeviceSoftwareVersion.php/.js.map` 路径来尝试绕过身份验证。如果服务器返回状态码 200，并且响应头包含特定的字段（如 `Expires: 0`, `PHPSESSID=`, `application/json`）以及响应正文中包含字符串 "0.0.0"，则认为目标存在漏洞。
5.  **投毒风险分析：**
    *   POC 代码本身主要用于漏洞检测，目的是验证漏洞是否存在。`README.md` 仅提供漏洞信息和作者信息。
    *   虽然 POC 代码的目的是检测，但如果被恶意修改，例如在检测的同时执行某些恶意操作（例如，修改防火墙规则），则存在投毒的潜在风险。但当前提供的代码不具备该功能。仓库中其他文件主要是描述信息，没有发现明显的恶意代码。基于以上分析，投毒风险较低，估计约为 5%。 风险主要在于未来可能出现的恶意变种或二次修改。
6.  **缓解措施：**
    *   升级到已修复的 PAN-OS 版本（10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本）。
    *   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
    *   如果使用威胁防御订阅，可以使用威胁 ID 95746, 95747, 95752, 95753, 95759 和 95763 (在 Applications and Threats 内容版本 8915-9075 及更高版本中可用) 来阻止攻击。确保所有列出的威胁 ID 都设置为阻止模式，并通过 DP 端口路由 MGT 端口的入站流量，替换入站流量管理的证书，解密到管理界面的入站流量，并在到管理服务的入站流量上启用威胁防御。

**项目地址:** [watchtowrlabs/palo-alto-panos-cve-2024-0012](https://github.com/watchtowrlabs/palo-alto-panos-cve-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---



---

## POC #9

**来源**: [CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md](../2024/CVE-2024-0012-punitdarji_Paloalto-CVE-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 (受影响版本详见漏洞库信息)

**利用条件:** 管理 Web 界面可以通过网络访问，特别是来自互联网的访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果能访问管理 Web 界面，就可以获得 PAN-OS 管理员权限，执行管理操作，篡改配置，或者利用其他需要身份验证的提权漏洞（如 CVE-2024-9474）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用漏洞绕过管理 Web 界面的身份验证机制，无需提供有效的用户名和密码。
2.  **权限提升：** 成功绕过身份验证后，攻击者获得管理员权限。
3.  **恶意操作：** 攻击者可以使用管理员权限执行各种恶意操作，包括：
    *   篡改防火墙配置。
    *   执行任意命令。
    *   利用其他漏洞。

**POC 分析：**

提供的 POC 代码 (`cve-2024-0012-pan-os-poc.py`) 旨在验证漏洞的存在。该 POC 脚本执行以下步骤：

1.  **创建初始会话：** 使用包含命令注入 payload 的 `X-PAN-AUTHCHECK: off` 头发送 POST 请求到 `/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`， 注入的命令将系统信息写入 `/var/appweb/htdocs/unauth/watchTowr.php` 文件。
2.  **触发执行：** 通过包含会话 ID 的 cookie，发送 GET 请求到 `/index.php/.js.map`，触发命令执行。
3.  **验证执行：** 检查 `/unauth/watchTowr.php` 是否存在且包含系统信息，以验证命令是否成功执行。

**投毒风险：**

POC 本身主要用于验证漏洞的存在。该POC 在`/var/appweb/htdocs/unauth/watchTowr.php`下创建了一个php文件，这个文件本身可以被用于后续的攻击.POC中注入的命令是将系统信息写入文件，但是完全可以替换成其他恶意命令.  因此虽然POC本身不是恶意代码, 但在后续使用时存在被滥用的风险。 仓库本身作者隐藏的投毒代码的可能性较低, 为10%.

**有效性：**

根据漏洞信息和 POC 代码，该漏洞是有效的，并且已经被观察到在野外被利用。

**项目地址:** [punitdarji/Paloalto-CVE-2024-0012](https://github.com/punitdarji/Paloalto-CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

## POC #10

**来源**: [CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md](../2024/CVE-2024-0012-watchtowrlabs_palo-alto-panos-cve-2024-0012.md)

## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 和 11.2 受影响版本

**利用条件:** 需要网络访问管理Web界面，特别是当管理界面暴露在互联网上时

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过网络访问管理 Web 界面，获得 PAN-OS 管理员权限。利用方式如下：

1.  **漏洞描述：** 攻击者可以绕过身份验证，从而执行管理操作，篡改配置或利用其他经过身份验证的权限提升漏洞（例如 CVE-2024-9474）。
2.  **影响范围：** PAN-OS 10.2, 11.0, 11.1 和 11.2 版本受影响。 Cloud NGFW 和 Prisma Access 不受此漏洞影响。
3.  **利用条件：** 攻击者需要能够通过网络访问 PAN-OS 的管理 Web 界面。如果管理界面暴露在互联网上，风险最高。限制仅从受信任的内部 IP 地址访问管理界面可以大大降低风险。
4.  **POC 验证：** 提供的 POC 代码 (`palo-alto-vpn-CVE-2024-0012-check-wt.yaml`) 是一个 Nuclei 模板，用于检测目标是否存在 CVE-2024-0012 漏洞。它通过发送一个带有 `X-PAN-AUTHCHECK: off` 头的 GET 请求到 `/php/utils/CmsGetDeviceSoftwareVersion.php/.js.map` 路径来尝试绕过身份验证。如果服务器返回状态码 200，并且响应头包含特定的字段（如 `Expires: 0`, `PHPSESSID=`, `application/json`）以及响应正文中包含字符串 "0.0.0"，则认为目标存在漏洞。
5.  **投毒风险分析：**
    *   POC 代码本身主要用于漏洞检测，目的是验证漏洞是否存在。`README.md` 仅提供漏洞信息和作者信息。
    *   虽然 POC 代码的目的是检测，但如果被恶意修改，例如在检测的同时执行某些恶意操作（例如，修改防火墙规则），则存在投毒的潜在风险。但当前提供的代码不具备该功能。仓库中其他文件主要是描述信息，没有发现明显的恶意代码。基于以上分析，投毒风险较低，估计约为 5%。 风险主要在于未来可能出现的恶意变种或二次修改。
6.  **缓解措施：**
    *   升级到已修复的 PAN-OS 版本（10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 及更高版本）。
    *   限制对管理 Web 界面的访问，仅允许受信任的内部 IP 地址访问。
    *   如果使用威胁防御订阅，可以使用威胁 ID 95746, 95747, 95752, 95753, 95759 和 95763 (在 Applications and Threats 内容版本 8915-9075 及更高版本中可用) 来阻止攻击。确保所有列出的威胁 ID 都设置为阻止模式，并通过 DP 端口路由 MGT 端口的入站流量，替换入站流量管理的证书，解密到管理界面的入站流量，并在到管理服务的入站流量上启用威胁防御。

**项目地址:** [watchtowrlabs/palo-alto-panos-cve-2024-0012](https://github.com/watchtowrlabs/palo-alto-panos-cve-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)

---

