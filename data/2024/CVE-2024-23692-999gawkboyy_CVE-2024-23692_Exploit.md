# CVE-2024-23692

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md](../2024/CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行受影响版本的 Rejetto HTTP File Server，并允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞在受影响的系统上执行任意命令。

**1. 有效性：**
   - 提供的 PoC 代码（`CVE-2024-23692.sh` 和 `CVE-2024-23692.yaml`）看起来是有效的。 `CVE-2024-23692.sh` 是一个 Bash 脚本，它构造一个包含命令的恶意 URL，并使用 `curl` 发送请求，最后解析响应以获取命令输出。 `CVE-2024-23692.yaml` 是一个 Nuclei 模板，用于检测此漏洞，使用 `interactsh-url` 验证是否存在漏洞。
   - 搜索结果中提及了 Metasploit 模块，表明漏洞是可利用的。

**2. 投毒风险：**
   - `CVE-2024-23692.sh` 脚本使用 `iconv` 和 `base64` 对命令进行编码，这可能会被误认为是试图隐藏恶意代码。但是，此编码过程对于确保命令正确地作为模板注入的一部分发送是必要的。
   -Nuclei 模板文件(`CVE-2024-23692.yaml`)，通过 interactsh 进行验证，不太可能包含恶意代码，属于常见的漏洞验证方式
   - 考虑到脚本的功能和用途，投毒风险较低，但仍存在一定风险，例如，脚本可能依赖外部资源，或者作者未来可能修改脚本。所以，投毒风险估计为10%。

**3. 利用方式：**
   - 攻击者构造包含恶意命令的特殊 HTTP 请求，利用模板注入漏洞。
   - `CVE-2024-23692.sh` 脚本自动执行此过程：
      1.  使用 `iconv` 将命令转换为 UTF-16LE 编码。
      2.  使用 `base64` 对 UTF-16LE 编码的命令进行编码。
      3.  将编码后的命令插入到特制的 URL 中。
      4.  使用 `curl` 发送 GET 请求到目标服务器。
      5.  解析响应以提取命令的输出。
   - Nuclei 模板通过 dns 探测验证漏洞。

**项目地址:** [0x20c/CVE-2024-23692-EXP](https://github.com/0x20c/CVE-2024-23692-EXP)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #2

**来源**: [CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md](../2024/CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md)

# CVE-2024-23692

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md](../2024/CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行受影响版本的 Rejetto HTTP File Server，并允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞在受影响的系统上执行任意命令。

**1. 有效性：**
   - 提供的 PoC 代码（`CVE-2024-23692.sh` 和 `CVE-2024-23692.yaml`）看起来是有效的。 `CVE-2024-23692.sh` 是一个 Bash 脚本，它构造一个包含命令的恶意 URL，并使用 `curl` 发送请求，最后解析响应以获取命令输出。 `CVE-2024-23692.yaml` 是一个 Nuclei 模板，用于检测此漏洞，使用 `interactsh-url` 验证是否存在漏洞。
   - 搜索结果中提及了 Metasploit 模块，表明漏洞是可利用的。

**2. 投毒风险：**
   - `CVE-2024-23692.sh` 脚本使用 `iconv` 和 `base64` 对命令进行编码，这可能会被误认为是试图隐藏恶意代码。但是，此编码过程对于确保命令正确地作为模板注入的一部分发送是必要的。
   -Nuclei 模板文件(`CVE-2024-23692.yaml`)，通过 interactsh 进行验证，不太可能包含恶意代码，属于常见的漏洞验证方式
   - 考虑到脚本的功能和用途，投毒风险较低，但仍存在一定风险，例如，脚本可能依赖外部资源，或者作者未来可能修改脚本。所以，投毒风险估计为10%。

**3. 利用方式：**
   - 攻击者构造包含恶意命令的特殊 HTTP 请求，利用模板注入漏洞。
   - `CVE-2024-23692.sh` 脚本自动执行此过程：
      1.  使用 `iconv` 将命令转换为 UTF-16LE 编码。
      2.  使用 `base64` 对 UTF-16LE 编码的命令进行编码。
      3.  将编码后的命令插入到特制的 URL 中。
      4.  使用 `curl` 发送 GET 请求到目标服务器。
      5.  解析响应以提取命令的输出。
   - Nuclei 模板通过 dns 探测验证漏洞。

**项目地址:** [0x20c/CVE-2024-23692-EXP](https://github.com/0x20c/CVE-2024-23692-EXP)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #2

**来源**: [CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md](../2024/CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md)

# CVE-2024-23692

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md](../2024/CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行受影响版本的 Rejetto HTTP File Server，并允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞在受影响的系统上执行任意命令。

**1. 有效性：**
   - 提供的 PoC 代码（`CVE-2024-23692.sh` 和 `CVE-2024-23692.yaml`）看起来是有效的。 `CVE-2024-23692.sh` 是一个 Bash 脚本，它构造一个包含命令的恶意 URL，并使用 `curl` 发送请求，最后解析响应以获取命令输出。 `CVE-2024-23692.yaml` 是一个 Nuclei 模板，用于检测此漏洞，使用 `interactsh-url` 验证是否存在漏洞。
   - 搜索结果中提及了 Metasploit 模块，表明漏洞是可利用的。

**2. 投毒风险：**
   - `CVE-2024-23692.sh` 脚本使用 `iconv` 和 `base64` 对命令进行编码，这可能会被误认为是试图隐藏恶意代码。但是，此编码过程对于确保命令正确地作为模板注入的一部分发送是必要的。
   -Nuclei 模板文件(`CVE-2024-23692.yaml`)，通过 interactsh 进行验证，不太可能包含恶意代码，属于常见的漏洞验证方式
   - 考虑到脚本的功能和用途，投毒风险较低，但仍存在一定风险，例如，脚本可能依赖外部资源，或者作者未来可能修改脚本。所以，投毒风险估计为10%。

**3. 利用方式：**
   - 攻击者构造包含恶意命令的特殊 HTTP 请求，利用模板注入漏洞。
   - `CVE-2024-23692.sh` 脚本自动执行此过程：
      1.  使用 `iconv` 将命令转换为 UTF-16LE 编码。
      2.  使用 `base64` 对 UTF-16LE 编码的命令进行编码。
      3.  将编码后的命令插入到特制的 URL 中。
      4.  使用 `curl` 发送 GET 请求到目标服务器。
      5.  解析响应以提取命令的输出。
   - Nuclei 模板通过 dns 探测验证漏洞。

**项目地址:** [0x20c/CVE-2024-23692-EXP](https://github.com/0x20c/CVE-2024-23692-EXP)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #2

**来源**: [CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md](../2024/CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md)

# CVE-2024-23692

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md](../2024/CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行受影响版本的 Rejetto HTTP File Server，并允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞在受影响的系统上执行任意命令。

**1. 有效性：**
   - 提供的 PoC 代码（`CVE-2024-23692.sh` 和 `CVE-2024-23692.yaml`）看起来是有效的。 `CVE-2024-23692.sh` 是一个 Bash 脚本，它构造一个包含命令的恶意 URL，并使用 `curl` 发送请求，最后解析响应以获取命令输出。 `CVE-2024-23692.yaml` 是一个 Nuclei 模板，用于检测此漏洞，使用 `interactsh-url` 验证是否存在漏洞。
   - 搜索结果中提及了 Metasploit 模块，表明漏洞是可利用的。

**2. 投毒风险：**
   - `CVE-2024-23692.sh` 脚本使用 `iconv` 和 `base64` 对命令进行编码，这可能会被误认为是试图隐藏恶意代码。但是，此编码过程对于确保命令正确地作为模板注入的一部分发送是必要的。
   -Nuclei 模板文件(`CVE-2024-23692.yaml`)，通过 interactsh 进行验证，不太可能包含恶意代码，属于常见的漏洞验证方式
   - 考虑到脚本的功能和用途，投毒风险较低，但仍存在一定风险，例如，脚本可能依赖外部资源，或者作者未来可能修改脚本。所以，投毒风险估计为10%。

**3. 利用方式：**
   - 攻击者构造包含恶意命令的特殊 HTTP 请求，利用模板注入漏洞。
   - `CVE-2024-23692.sh` 脚本自动执行此过程：
      1.  使用 `iconv` 将命令转换为 UTF-16LE 编码。
      2.  使用 `base64` 对 UTF-16LE 编码的命令进行编码。
      3.  将编码后的命令插入到特制的 URL 中。
      4.  使用 `curl` 发送 GET 请求到目标服务器。
      5.  解析响应以提取命令的输出。
   - Nuclei 模板通过 dns 探测验证漏洞。

**项目地址:** [0x20c/CVE-2024-23692-EXP](https://github.com/0x20c/CVE-2024-23692-EXP)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #2

**来源**: [CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md](../2024/CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md)

# CVE-2024-23692

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md](../2024/CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行受影响版本的 Rejetto HTTP File Server，并允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞在受影响的系统上执行任意命令。

**1. 有效性：**
   - 提供的 PoC 代码（`CVE-2024-23692.sh` 和 `CVE-2024-23692.yaml`）看起来是有效的。 `CVE-2024-23692.sh` 是一个 Bash 脚本，它构造一个包含命令的恶意 URL，并使用 `curl` 发送请求，最后解析响应以获取命令输出。 `CVE-2024-23692.yaml` 是一个 Nuclei 模板，用于检测此漏洞，使用 `interactsh-url` 验证是否存在漏洞。
   - 搜索结果中提及了 Metasploit 模块，表明漏洞是可利用的。

**2. 投毒风险：**
   - `CVE-2024-23692.sh` 脚本使用 `iconv` 和 `base64` 对命令进行编码，这可能会被误认为是试图隐藏恶意代码。但是，此编码过程对于确保命令正确地作为模板注入的一部分发送是必要的。
   -Nuclei 模板文件(`CVE-2024-23692.yaml`)，通过 interactsh 进行验证，不太可能包含恶意代码，属于常见的漏洞验证方式
   - 考虑到脚本的功能和用途，投毒风险较低，但仍存在一定风险，例如，脚本可能依赖外部资源，或者作者未来可能修改脚本。所以，投毒风险估计为10%。

**3. 利用方式：**
   - 攻击者构造包含恶意命令的特殊 HTTP 请求，利用模板注入漏洞。
   - `CVE-2024-23692.sh` 脚本自动执行此过程：
      1.  使用 `iconv` 将命令转换为 UTF-16LE 编码。
      2.  使用 `base64` 对 UTF-16LE 编码的命令进行编码。
      3.  将编码后的命令插入到特制的 URL 中。
      4.  使用 `curl` 发送 GET 请求到目标服务器。
      5.  解析响应以提取命令的输出。
   - Nuclei 模板通过 dns 探测验证漏洞。

**项目地址:** [0x20c/CVE-2024-23692-EXP](https://github.com/0x20c/CVE-2024-23692-EXP)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #2

**来源**: [CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md](../2024/CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md)

# CVE-2024-23692

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md](../2024/CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行受影响版本的 Rejetto HTTP File Server，并允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞在受影响的系统上执行任意命令。

**1. 有效性：**
   - 提供的 PoC 代码（`CVE-2024-23692.sh` 和 `CVE-2024-23692.yaml`）看起来是有效的。 `CVE-2024-23692.sh` 是一个 Bash 脚本，它构造一个包含命令的恶意 URL，并使用 `curl` 发送请求，最后解析响应以获取命令输出。 `CVE-2024-23692.yaml` 是一个 Nuclei 模板，用于检测此漏洞，使用 `interactsh-url` 验证是否存在漏洞。
   - 搜索结果中提及了 Metasploit 模块，表明漏洞是可利用的。

**2. 投毒风险：**
   - `CVE-2024-23692.sh` 脚本使用 `iconv` 和 `base64` 对命令进行编码，这可能会被误认为是试图隐藏恶意代码。但是，此编码过程对于确保命令正确地作为模板注入的一部分发送是必要的。
   -Nuclei 模板文件(`CVE-2024-23692.yaml`)，通过 interactsh 进行验证，不太可能包含恶意代码，属于常见的漏洞验证方式
   - 考虑到脚本的功能和用途，投毒风险较低，但仍存在一定风险，例如，脚本可能依赖外部资源，或者作者未来可能修改脚本。所以，投毒风险估计为10%。

**3. 利用方式：**
   - 攻击者构造包含恶意命令的特殊 HTTP 请求，利用模板注入漏洞。
   - `CVE-2024-23692.sh` 脚本自动执行此过程：
      1.  使用 `iconv` 将命令转换为 UTF-16LE 编码。
      2.  使用 `base64` 对 UTF-16LE 编码的命令进行编码。
      3.  将编码后的命令插入到特制的 URL 中。
      4.  使用 `curl` 发送 GET 请求到目标服务器。
      5.  解析响应以提取命令的输出。
   - Nuclei 模板通过 dns 探测验证漏洞。

**项目地址:** [0x20c/CVE-2024-23692-EXP](https://github.com/0x20c/CVE-2024-23692-EXP)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #2

**来源**: [CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md](../2024/CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md)

# CVE-2024-23692

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md](../2024/CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行受影响版本的 Rejetto HTTP File Server，并允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞在受影响的系统上执行任意命令。

**1. 有效性：**
   - 提供的 PoC 代码（`CVE-2024-23692.sh` 和 `CVE-2024-23692.yaml`）看起来是有效的。 `CVE-2024-23692.sh` 是一个 Bash 脚本，它构造一个包含命令的恶意 URL，并使用 `curl` 发送请求，最后解析响应以获取命令输出。 `CVE-2024-23692.yaml` 是一个 Nuclei 模板，用于检测此漏洞，使用 `interactsh-url` 验证是否存在漏洞。
   - 搜索结果中提及了 Metasploit 模块，表明漏洞是可利用的。

**2. 投毒风险：**
   - `CVE-2024-23692.sh` 脚本使用 `iconv` 和 `base64` 对命令进行编码，这可能会被误认为是试图隐藏恶意代码。但是，此编码过程对于确保命令正确地作为模板注入的一部分发送是必要的。
   -Nuclei 模板文件(`CVE-2024-23692.yaml`)，通过 interactsh 进行验证，不太可能包含恶意代码，属于常见的漏洞验证方式
   - 考虑到脚本的功能和用途，投毒风险较低，但仍存在一定风险，例如，脚本可能依赖外部资源，或者作者未来可能修改脚本。所以，投毒风险估计为10%。

**3. 利用方式：**
   - 攻击者构造包含恶意命令的特殊 HTTP 请求，利用模板注入漏洞。
   - `CVE-2024-23692.sh` 脚本自动执行此过程：
      1.  使用 `iconv` 将命令转换为 UTF-16LE 编码。
      2.  使用 `base64` 对 UTF-16LE 编码的命令进行编码。
      3.  将编码后的命令插入到特制的 URL 中。
      4.  使用 `curl` 发送 GET 请求到目标服务器。
      5.  解析响应以提取命令的输出。
   - Nuclei 模板通过 dns 探测验证漏洞。

**项目地址:** [0x20c/CVE-2024-23692-EXP](https://github.com/0x20c/CVE-2024-23692-EXP)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #2

**来源**: [CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md](../2024/CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md)

# CVE-2024-23692

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md](../2024/CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行受影响版本的 Rejetto HTTP File Server，并允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞在受影响的系统上执行任意命令。

**1. 有效性：**
   - 提供的 PoC 代码（`CVE-2024-23692.sh` 和 `CVE-2024-23692.yaml`）看起来是有效的。 `CVE-2024-23692.sh` 是一个 Bash 脚本，它构造一个包含命令的恶意 URL，并使用 `curl` 发送请求，最后解析响应以获取命令输出。 `CVE-2024-23692.yaml` 是一个 Nuclei 模板，用于检测此漏洞，使用 `interactsh-url` 验证是否存在漏洞。
   - 搜索结果中提及了 Metasploit 模块，表明漏洞是可利用的。

**2. 投毒风险：**
   - `CVE-2024-23692.sh` 脚本使用 `iconv` 和 `base64` 对命令进行编码，这可能会被误认为是试图隐藏恶意代码。但是，此编码过程对于确保命令正确地作为模板注入的一部分发送是必要的。
   -Nuclei 模板文件(`CVE-2024-23692.yaml`)，通过 interactsh 进行验证，不太可能包含恶意代码，属于常见的漏洞验证方式
   - 考虑到脚本的功能和用途，投毒风险较低，但仍存在一定风险，例如，脚本可能依赖外部资源，或者作者未来可能修改脚本。所以，投毒风险估计为10%。

**3. 利用方式：**
   - 攻击者构造包含恶意命令的特殊 HTTP 请求，利用模板注入漏洞。
   - `CVE-2024-23692.sh` 脚本自动执行此过程：
      1.  使用 `iconv` 将命令转换为 UTF-16LE 编码。
      2.  使用 `base64` 对 UTF-16LE 编码的命令进行编码。
      3.  将编码后的命令插入到特制的 URL 中。
      4.  使用 `curl` 发送 GET 请求到目标服务器。
      5.  解析响应以提取命令的输出。
   - Nuclei 模板通过 dns 探测验证漏洞。

**项目地址:** [0x20c/CVE-2024-23692-EXP](https://github.com/0x20c/CVE-2024-23692-EXP)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #2

**来源**: [CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md](../2024/CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md)

# CVE-2024-23692

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md](../2024/CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行受影响版本的 Rejetto HTTP File Server，并允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞在受影响的系统上执行任意命令。

**1. 有效性：**
   - 提供的 PoC 代码（`CVE-2024-23692.sh` 和 `CVE-2024-23692.yaml`）看起来是有效的。 `CVE-2024-23692.sh` 是一个 Bash 脚本，它构造一个包含命令的恶意 URL，并使用 `curl` 发送请求，最后解析响应以获取命令输出。 `CVE-2024-23692.yaml` 是一个 Nuclei 模板，用于检测此漏洞，使用 `interactsh-url` 验证是否存在漏洞。
   - 搜索结果中提及了 Metasploit 模块，表明漏洞是可利用的。

**2. 投毒风险：**
   - `CVE-2024-23692.sh` 脚本使用 `iconv` 和 `base64` 对命令进行编码，这可能会被误认为是试图隐藏恶意代码。但是，此编码过程对于确保命令正确地作为模板注入的一部分发送是必要的。
   -Nuclei 模板文件(`CVE-2024-23692.yaml`)，通过 interactsh 进行验证，不太可能包含恶意代码，属于常见的漏洞验证方式
   - 考虑到脚本的功能和用途，投毒风险较低，但仍存在一定风险，例如，脚本可能依赖外部资源，或者作者未来可能修改脚本。所以，投毒风险估计为10%。

**3. 利用方式：**
   - 攻击者构造包含恶意命令的特殊 HTTP 请求，利用模板注入漏洞。
   - `CVE-2024-23692.sh` 脚本自动执行此过程：
      1.  使用 `iconv` 将命令转换为 UTF-16LE 编码。
      2.  使用 `base64` 对 UTF-16LE 编码的命令进行编码。
      3.  将编码后的命令插入到特制的 URL 中。
      4.  使用 `curl` 发送 GET 请求到目标服务器。
      5.  解析响应以提取命令的输出。
   - Nuclei 模板通过 dns 探测验证漏洞。

**项目地址:** [0x20c/CVE-2024-23692-EXP](https://github.com/0x20c/CVE-2024-23692-EXP)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #2

**来源**: [CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md](../2024/CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md)

# CVE-2024-23692

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md](../2024/CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行受影响版本的 Rejetto HTTP File Server，并允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞在受影响的系统上执行任意命令。

**1. 有效性：**
   - 提供的 PoC 代码（`CVE-2024-23692.sh` 和 `CVE-2024-23692.yaml`）看起来是有效的。 `CVE-2024-23692.sh` 是一个 Bash 脚本，它构造一个包含命令的恶意 URL，并使用 `curl` 发送请求，最后解析响应以获取命令输出。 `CVE-2024-23692.yaml` 是一个 Nuclei 模板，用于检测此漏洞，使用 `interactsh-url` 验证是否存在漏洞。
   - 搜索结果中提及了 Metasploit 模块，表明漏洞是可利用的。

**2. 投毒风险：**
   - `CVE-2024-23692.sh` 脚本使用 `iconv` 和 `base64` 对命令进行编码，这可能会被误认为是试图隐藏恶意代码。但是，此编码过程对于确保命令正确地作为模板注入的一部分发送是必要的。
   -Nuclei 模板文件(`CVE-2024-23692.yaml`)，通过 interactsh 进行验证，不太可能包含恶意代码，属于常见的漏洞验证方式
   - 考虑到脚本的功能和用途，投毒风险较低，但仍存在一定风险，例如，脚本可能依赖外部资源，或者作者未来可能修改脚本。所以，投毒风险估计为10%。

**3. 利用方式：**
   - 攻击者构造包含恶意命令的特殊 HTTP 请求，利用模板注入漏洞。
   - `CVE-2024-23692.sh` 脚本自动执行此过程：
      1.  使用 `iconv` 将命令转换为 UTF-16LE 编码。
      2.  使用 `base64` 对 UTF-16LE 编码的命令进行编码。
      3.  将编码后的命令插入到特制的 URL 中。
      4.  使用 `curl` 发送 GET 请求到目标服务器。
      5.  解析响应以提取命令的输出。
   - Nuclei 模板通过 dns 探测验证漏洞。

**项目地址:** [0x20c/CVE-2024-23692-EXP](https://github.com/0x20c/CVE-2024-23692-EXP)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #2

**来源**: [CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md](../2024/CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md)

# CVE-2024-23692

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md](../2024/CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行受影响版本的 Rejetto HTTP File Server，并允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞在受影响的系统上执行任意命令。

**1. 有效性：**
   - 提供的 PoC 代码（`CVE-2024-23692.sh` 和 `CVE-2024-23692.yaml`）看起来是有效的。 `CVE-2024-23692.sh` 是一个 Bash 脚本，它构造一个包含命令的恶意 URL，并使用 `curl` 发送请求，最后解析响应以获取命令输出。 `CVE-2024-23692.yaml` 是一个 Nuclei 模板，用于检测此漏洞，使用 `interactsh-url` 验证是否存在漏洞。
   - 搜索结果中提及了 Metasploit 模块，表明漏洞是可利用的。

**2. 投毒风险：**
   - `CVE-2024-23692.sh` 脚本使用 `iconv` 和 `base64` 对命令进行编码，这可能会被误认为是试图隐藏恶意代码。但是，此编码过程对于确保命令正确地作为模板注入的一部分发送是必要的。
   -Nuclei 模板文件(`CVE-2024-23692.yaml`)，通过 interactsh 进行验证，不太可能包含恶意代码，属于常见的漏洞验证方式
   - 考虑到脚本的功能和用途，投毒风险较低，但仍存在一定风险，例如，脚本可能依赖外部资源，或者作者未来可能修改脚本。所以，投毒风险估计为10%。

**3. 利用方式：**
   - 攻击者构造包含恶意命令的特殊 HTTP 请求，利用模板注入漏洞。
   - `CVE-2024-23692.sh` 脚本自动执行此过程：
      1.  使用 `iconv` 将命令转换为 UTF-16LE 编码。
      2.  使用 `base64` 对 UTF-16LE 编码的命令进行编码。
      3.  将编码后的命令插入到特制的 URL 中。
      4.  使用 `curl` 发送 GET 请求到目标服务器。
      5.  解析响应以提取命令的输出。
   - Nuclei 模板通过 dns 探测验证漏洞。

**项目地址:** [0x20c/CVE-2024-23692-EXP](https://github.com/0x20c/CVE-2024-23692-EXP)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #2

**来源**: [CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md](../2024/CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md)

# CVE-2024-23692

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md](../2024/CVE-2024-23692-0x20c_CVE-2024-23692-EXP.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行受影响版本的 Rejetto HTTP File Server，并允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞在受影响的系统上执行任意命令。

**1. 有效性：**
   - 提供的 PoC 代码（`CVE-2024-23692.sh` 和 `CVE-2024-23692.yaml`）看起来是有效的。 `CVE-2024-23692.sh` 是一个 Bash 脚本，它构造一个包含命令的恶意 URL，并使用 `curl` 发送请求，最后解析响应以获取命令输出。 `CVE-2024-23692.yaml` 是一个 Nuclei 模板，用于检测此漏洞，使用 `interactsh-url` 验证是否存在漏洞。
   - 搜索结果中提及了 Metasploit 模块，表明漏洞是可利用的。

**2. 投毒风险：**
   - `CVE-2024-23692.sh` 脚本使用 `iconv` 和 `base64` 对命令进行编码，这可能会被误认为是试图隐藏恶意代码。但是，此编码过程对于确保命令正确地作为模板注入的一部分发送是必要的。
   -Nuclei 模板文件(`CVE-2024-23692.yaml`)，通过 interactsh 进行验证，不太可能包含恶意代码，属于常见的漏洞验证方式
   - 考虑到脚本的功能和用途，投毒风险较低，但仍存在一定风险，例如，脚本可能依赖外部资源，或者作者未来可能修改脚本。所以，投毒风险估计为10%。

**3. 利用方式：**
   - 攻击者构造包含恶意命令的特殊 HTTP 请求，利用模板注入漏洞。
   - `CVE-2024-23692.sh` 脚本自动执行此过程：
      1.  使用 `iconv` 将命令转换为 UTF-16LE 编码。
      2.  使用 `base64` 对 UTF-16LE 编码的命令进行编码。
      3.  将编码后的命令插入到特制的 URL 中。
      4.  使用 `curl` 发送 GET 请求到目标服务器。
      5.  解析响应以提取命令的输出。
   - Nuclei 模板通过 dns 探测验证漏洞。

**项目地址:** [0x20c/CVE-2024-23692-EXP](https://github.com/0x20c/CVE-2024-23692-EXP)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #2

**来源**: [CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md](../2024/CVE-2024-23692-999gawkboyy_CVE-2024-23692_Exploit.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程未授权执行任意代码

**影响版本:** <= 2.3m

**利用条件:** 需要目标服务器运行Rejetto HFS 2.3m或更早版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m及更早版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过构造特制的HTTP请求，在受影响的系统上执行任意命令。

**有效性评估：**
提供的POC代码（poc.py）通过构造包含恶意命令的HTTP请求，利用模板引擎的缺陷来执行系统命令。该POC使用`curl`命令发送HTTP请求，并解析响应以提取命令执行的结果。从代码结构来看，POC的基本逻辑是正确的，应该能够有效利用该漏洞。

**投毒风险分析：**
POC代码本身主要功能是发送请求并提取回显，没有发现明显的恶意代码。 但是，`Readme.md` 文件中含有韩文，提示用户使用该代码的法律责任由用户承担，且提示该代码仅用于教育目的，这可能暗示作者对潜在的恶意使用行为不负责任。需要注意的是，POC代码利用了powershell执行命令，如果服务器安全配置较弱，存在被滥用的可能。因此存在较小投毒风险，可能性约为10%。

**利用方式：**
1.  攻击者首先需要找到运行着Rejetto HFS 2.3m或更早版本的服务器，并且该服务器对外开放了HTTP服务端口。
2.  然后，攻击者可以使用POC脚本（poc.py），指定目标URL和要执行的命令。
3.  POC脚本会构造一个包含恶意命令的HTTP GET请求，该请求利用了HFS的模板注入漏洞。
4.  HFS服务器在处理该请求时，会将恶意命令传递给底层操作系统执行。
5.  POC脚本会解析服务器的响应，提取命令执行的结果并输出。

**项目地址:** [999gawkboyy/CVE-2024-23692_Exploit](https://github.com/999gawkboyy/CVE-2024-23692_Exploit)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #3

**来源**: [CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md](../2024/CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server Template Injection RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行存在漏洞的Rejetto HFS，并能通过网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在服务器上执行任意命令。由于Rejetto HFS已经停止维护，无法通过官方补丁修复此漏洞。

**有效性分析：**
提供的POC代码（hfs.go）利用了该模板注入漏洞，允许攻击者执行命令、执行DNSLog检测等操作。

**投毒风险分析：**
检查了提供的代码仓库，没有发现明显的恶意代码，但是存在以下几点潜在的投毒风险：
1.  **DNSLog配置：** 默认使用ceye.io，如果ceye.io被恶意利用，可能会导致信息泄露。
2.  **代码依赖：** 依赖gopkg.in/ini.v1，此依赖如果存在漏洞，可能会被利用。
3.  **命令执行：** 命令执行本身就存在风险，如果目标系统权限过高，可能会导致严重的安全问题。
4.  **网络请求：** 攻击代码中会发出网络请求，具有一定的流量特征，可以分析网络流量判断是否存在恶意行为。
因此，整体投毒的概率较低，估计为5%。

**利用方式：**
1.  攻击者首先需要确定目标系统运行的是存在漏洞的Rejetto HFS 2.3m。
2.  攻击者可以利用POC代码，通过`-u`参数指定目标URL。
3.  可以使用`-cmd`参数进入命令行模式，执行任意命令。 例如: `go run hfs.go -u http://127.0.0.1 -cmd`。
4.  可以使用`-dns`参数进行DNSLog检测，验证漏洞是否存在。 例如: `go run hfs.go -u http://127.0.0.1 -dns` 或者 `go run hfs.go -u http://127.0.0.1 -dns -d abc.cn`。
5.  如果需要使用代理，可以通过`-p`参数指定代理服务器地址。 例如: `go run hfs.go -u http://127.0.0.1 -cmd -p http://user:pass@127.0.0.1:8080`。

**缓解措施：**
由于Rejetto HFS已经停止维护，建议用户停止使用该软件，并迁移到其他安全的文件服务器软件。

**项目地址:** [BBD-YZZ/CVE-2024-23692](https://github.com/BBD-YZZ/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #4

**来源**: [CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md](../2024/CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行受影响版本的 Rejetto HFS，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。攻击者可以通过构造特定的 HTTP 请求，在服务器上执行任意命令。\n\n**有效性：**\n提供的 PoC 代码 `CVE-2024-23692.sh` 似乎有效。它构造一个包含恶意模板注入的 HTTP GET 请求，利用 `nc` (netcat) 发送到目标服务器，然后显示响应。脚本接受目标 IP 地址、端口和要执行的命令作为参数。 README.md 文件也提供了使用示例，表明可以执行系统命令或部署反向 shell。\n\n**投毒风险：**\n评估投毒风险时，需要考虑以下几点：\n1.  **代码来源：** 代码来自非官方渠道（GitHub 上的个人仓库）。虽然该漏洞本身是真实存在的，但脚本可能包含恶意代码。\n2.  **脚本功能：** 脚本使用 `nc` 工具发送构造的 HTTP 请求。恶意代码可能被隐藏在构造的请求本身（例如，试图下载和执行其他恶意程序），或者在利用成功后执行其他操作。\n3.  **代码审查：** 快速审查脚本发现其核心功能是利用漏洞。投毒代码可能存在于不明显之处，例如对命令执行结果的篡改或者植入后门。\n4.  **网络行为：** 脚本中使用了`nc`，正常使用是发送恶意请求，如果存在其他网络连接行为，需要特别关注\n\n基于上述分析，认为存在10%的投毒风险。风险主要来自于脚本可能尝试利用漏洞植入后门或者执行其他恶意活动。\n\n**利用方式：**\n1.  **构造恶意 HTTP 请求：** PoC 脚本构造一个带有精心设计的查询字符串的 HTTP GET 请求。该查询字符串包含一个模板注入，允许执行服务器端代码。关键参数是 `cmd`，它包含要执行的命令。\n2.  **发送请求：** 脚本使用 `nc` 工具将构造的 HTTP 请求发送到目标服务器。\n3.  **执行命令：** 如果服务器存在漏洞，它将解析并执行注入的模板，从而执行 `cmd` 参数中指定的命令。\n4.  **获取结果：** 服务器的响应包含命令执行的结果。PoC 脚本捕获并显示此响应。

**项目地址:** [Mr-r00t11/CVE-2024-23692](https://github.com/Mr-r00t11/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #5

**来源**: [CVE-2024-23692-NingXin2002_HFS2.3_poc.md](../2024/CVE-2024-23692-NingXin2002_HFS2.3_poc.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程、未经身份验证的攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标服务器运行Rejetto HTTP File Server 2.3m或更早版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的一个模板注入漏洞。攻击者可以通过发送特制的HTTP请求，利用模板引擎的漏洞执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响所有2.3m及以下版本。PoC代码通过构造包含恶意代码的URL，发送到目标服务器。URL中的`cmd=whoami`部分展示了执行命令的能力。虽然PoC主要功能是验证漏洞，但需要人工审查和小心使用以防止潜在的恶意利用. 

**有效性：** 根据漏洞库信息，搜索引擎结果和POC代码，可以确定该POC代码有效。 多个信息源都表明可以通过特制的HTTP请求执行任意命令。

**投毒风险：** 该仓库的投毒风险较低，估计为10%。主要原因：

1.  **PoC的直接性：** PoC的主要目的是验证漏洞的存在，而不是植入后门。代码功能相对简单，直接发送包含命令的HTTP请求。
2.  **命令执行：** PoC中使用的`whoami`命令用于验证，但如果将命令替换为例如下载并执行恶意脚本的命令，则可能存在风险。
3.  **依赖性：** 该PoC只依赖于requests库，没有使用其他的隐蔽的第三方依赖，降低了引入恶意代码的风险。

**利用方式：** 漏洞利用方式如下：

1.  **确定目标：** 确定目标服务器上运行着存在漏洞的Rejetto HTTP File Server版本（<=2.3m）。
2.  **构造恶意URL：**  使用类似PoC中的URL，将`cmd=whoami`替换为需要执行的系统命令。
3.  **发送HTTP请求：**  通过GET请求将构造的URL发送到目标服务器。
4.  **执行命令：**  目标服务器执行URL中指定的命令。

**项目地址:** [NingXin2002/HFS2.3_poc](https://github.com/NingXin2002/HFS2.3_poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #6

**来源**: [CVE-2024-23692-Tupler_CVE-2024-23692-exp.md](../2024/CVE-2024-23692-Tupler_CVE-2024-23692-exp.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m (实际影响到2.4 RC7)

**利用条件:** 目标服务器运行存在漏洞的 Rejetto HFS 服务，攻击者能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 2.3m 及更早版本（实际影响到 2.4 RC7）中的一个模板注入漏洞。此漏洞允许未经身份验证的远程攻击者通过发送特制的 HTTP 请求在受影响的系统上执行任意命令。

**有效性:**
提供的 Python POC 代码 `CVE-2024-23692.py` 看起来有效。代码首先建立与目标服务器的 TCP 连接。 然后它接收用户输入的命令,将其进行 URL 编码，并将其嵌入到一个精心构造的 HTTP GET 请求中。 该请求利用模板注入漏洞在服务器端执行命令。服务器的响应被解析，提取命令执行的结果并打印给用户。代码通过对返回内容进行正则匹配提取执行结果，并避免直接输出所有返回内容来降低风险。

**投毒风险:**
对提供的 POC 代码 `CVE-2024-23692.py` 和 `README.md` 进行分析后，未发现明显的恶意代码或投毒迹象。 代码的功能符合漏洞利用的预期行为，没有发现尝试执行与漏洞利用无关的恶意操作的代码。

**利用方式:**
1.  **目标确认:** 确定目标服务器上运行着易受攻击的 Rejetto HFS 版本 (<= 2.3m, 实际影响到 2.4 RC7).
2.  **构造Payload:** 构造包含恶意命令的 HTTP GET 请求。 POC代码中cmd参数即是需要执行的命令,该命令会被进行URL编码后插入请求中。
3.  **发送请求:** 将构造的 HTTP 请求发送到目标服务器。
4.  **执行命令:** HFS 处理请求时，会执行注入的命令。 `{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`这部分是payload的关键。 {.exec}调用执行外部命令, {.?cmd.}是用户可控的命令，timeout=15限制超时时间，out=abc.将输出重定向到文件abc.，RESULT和====用于标记输出结果，方便提取。
5.  **获取结果:**  从服务器的响应中提取命令执行的结果。POC代码中对返回内容进行正则匹配，提取RESULT和====之间的内容。

**结论:**
该漏洞利用是有效的，并且能够实现远程代码执行。提供的代码中未发现投毒风险。 通过构造特定的请求，攻击者可以在目标系统上执行任意命令，导致严重的安全风险。 根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [Tupler/CVE-2024-23692-exp](https://github.com/Tupler/CVE-2024-23692-exp)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #7

**来源**: [CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md](../2024/CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md)

## CVE-2024-23692-Rejetto HFS 2.3m 远程命令执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程命令执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行受影响版本的Rejetto HTTP File Server，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意命令。利用方式如下：

1.  **漏洞描述：** 漏洞位于服务器处理模板的环节，攻击者通过构造恶意输入，将命令注入到模板中，由服务器执行。
2.  **漏洞利用方式：** 攻击者发送包含恶意模板代码的HTTP GET请求，服务器解析该请求时，会将恶意代码作为命令执行。
3.  **POC分析：** 提供的Go代码通过`zmap`扫描指定端口，然后使用HTTP GET请求，通过在URL中拼接经过编码的恶意命令来利用漏洞。POC首先检测目标是否为HFS服务，如果是则执行预定义的命令，例如 `ping wlccwlc.dnslog.cn` 和 `whoami`。
4.  **投毒风险分析：** 风险较低。主要风险来自以下几点：
    *   POC中执行的命令可以被修改，攻击者可以利用该POC执行任意恶意命令。
    *   `hfs.go`本身没有发现明显的投毒代码。代码逻辑相对清晰，主要功能是发送HTTP请求并处理响应。
    *   `README.md`文件中包含TG链接，存在一定的恶意引流风险，诱导用户加入恶意社群。

**项目地址:** [WanLiChangChengWanLiChang/CVE-2024-23692-RCE](https://github.com/WanLiChangChengWanLiChang/CVE-2024-23692-RCE)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #8

**来源**: [CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md](../2024/CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要网络访问 Rejetto HFS 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在目标系统上执行任意命令，无需身份验证。漏洞利用方式为通过构造包含恶意代码的HTTP请求，利用HFS模板引擎的缺陷执行命令。提供的代码段只是 Apache License 2.0 的许可证文本，本身不包含任何漏洞利用代码，因此无法评估其有效性。根据搜索结果，该漏洞已经有公开的利用方法，并且Metasploit中已经有相关的利用模块。由于提供的代码只是许可证，所以其中不存在投毒代码的风险。漏洞利用的关键在于构造恶意的HTTP请求，请求中包含可以被HFS服务器解释执行的模板注入代码。从CISA已收录该漏洞的情况来看，此漏洞非常活跃，请尽快进行修复。

**项目地址:** [XiaomingX/cve-2024-23692-poc](https://github.com/XiaomingX/cve-2024-23692-poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #9

**来源**: [CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md](../2024/CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入/远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，允许未授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HFS 2.3m，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中的一个模板注入漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求来执行任意命令。漏洞利用代码通过构造包含恶意payload的GET请求，该payload利用模板引擎的特性执行操作系统命令。payload的形式为 `/?search=%25x%25url%25:%host%}{.exec|cmd.}{.break.}`，其中`cmd`是要执行的命令。检测脚本使用相同的payload，但只是验证服务是否返回200 OK，表明存在漏洞。

**有效性：** 根据漏洞描述、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码很可能是有效的。漏洞信息明确指出存在远程代码执行漏洞，搜索引擎结果证实了这一点，漏洞利用代码也实现了构造恶意请求并执行命令的功能。

**投毒风险：** 提供的代码主要是利用漏洞执行命令，并没有发现明显的恶意代码。但仍然存在微小的风险：

*   **依赖风险：** 代码使用了标准库如socket和sys，风险较低。
*   **命令执行风险：** `cmd`参数由用户提供，如果用户不小心执行了恶意命令，可能会导致问题。但是，这不是代码本身的投毒，而是用户使用不当造成的。
*   **网络连接风险：** 虽然有超时设置，但如果目标服务器被攻陷，可能被用于DDoS等攻击。

考虑到以上因素，投毒风险评估为5%。

**利用方式：**

1.  **确定目标：** 找到运行Rejetto HTTP File Server 2.3m的目标IP地址和端口。
2.  **构造恶意请求：** 使用提供的exploit.py脚本，指定目标IP地址、端口以及要执行的命令。
3.  **发送请求：** 脚本将构造包含恶意payload的HTTP GET请求，并发送到目标服务器。
4.  **执行命令：** 如果目标服务器存在漏洞，服务器将执行payload中的命令。
5.  **验证结果：** 脚本会打印服务器的响应。如果返回“200 OK”，则表示漏洞利用可能成功。弹出计算器或者其他命令执行的反馈需要根据具体环境判断。

**项目地址:** [jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS](https://github.com/jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #10

**来源**: [CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md](../2024/CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行Rejetto HFS 2.3m，且攻击者可以发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的HTTP请求来执行任意命令。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被广泛确认存在并且有公开的PoC。提供的PoC代码（CVE-2024-23692.py）尝试利用该漏洞，发送包含恶意模板注入payload的HTTP GET请求，如果服务器存在漏洞，将执行`ipconfig /all` 命令 (windows系统)或者 `systeminfo` 命令。PoC通过检查响应文本中“RESULT”字符串的出现次数来判断漏洞是否存在。 Burp Suite的POC也验证了此漏洞. 因此，PoC代码是有效的。

**投毒风险分析：**

查看提供的python POC代码，没有发现任何恶意代码，例如反弹shell或下载执行其他文件的行为。也没有发现任何试图修改本地文件或窃取敏感信息的代码。PoC脚本功能相对简单，主要用于验证目标是否存在漏洞。 `README.md` 文件中仅包含 HTTP 请求的 PoC 示例和截图，没有发现潜在的投毒代码。综合判断，该仓库中存在作者隐藏的投毒代码的可能性极低。因此，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** 漏洞出现在HFS处理模板时，没有对用户输入进行充分的过滤和转义，导致攻击者可以通过构造恶意的模板代码来执行任意命令。
2.  **攻击方式：** 攻击者通过发送包含特定payload的HTTP请求到目标服务器。
3.  **Payload构造：** PoC中使用的payload是`/?s=%0A&cmd=ipconfig+/all&search=%25xxx%25url:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`。该payload利用了HFS的模板引擎，`{.exec|{.?cmd.}`部分会执行`cmd`参数指定的命令，并将结果输出。
4.  **命令执行：**  服务器在解析该请求时，会执行`cmd`参数指定的命令（例如 `ipconfig /all`），并将命令执行的结果嵌入到响应中返回给攻击者。
5.  **漏洞验证：**  PoC通过检查响应中特定字符串（例如 `RESULT`）的出现次数来判断漏洞是否存在。

**项目地址:** [k3lpi3b4nsh33/CVE-2024-23692](https://github.com/k3lpi3b4nsh33/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #11

**来源**: [CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md](../2024/CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入 (SSTI)

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程未授权代码执行

**影响版本:** <= 2.3m, 2.4.0 RC7 (测试版本)

**利用条件:** 目标系统运行受影响版本的Rejetto HFS，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 中存在的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。

**有效性：**
根据提供的 Metasploit 模块的 README 文件以及漏洞库信息，该漏洞的 POC 代码是有效的。该 POC 已经在 2.4.0 RC7 和 2.3m 版本上进行了测试，并且成功地执行了远程代码。

**投毒风险：**
提供的代码片段主要是一个 Metasploit 模块的 README，展示了如何使用该模块进行漏洞利用。它包含设置 RHOSTS、RPORT、LHOST 和 LPORT 等参数的示例，以及如何执行 check 和 exploit 命令。由于该代码只是一个使用说明，并且Metasploit是可信的项目，因此，投毒的可能性非常低。

**利用方式：**
攻击者通过构造包含恶意模板代码的HTTP请求，将其发送到存在漏洞的Rejetto HFS服务器。服务器在处理该请求时，会将恶意模板代码解析并执行，从而导致任意代码执行。从Metasploit模块的使用方式可以看出，攻击者可以利用这个漏洞直接获取Meterpreter会话。

**参考：**
*   漏洞库信息
*   搜索引擎结果
*   漏洞利用代码（Metasploit模块README）

**项目地址:** [pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692](https://github.com/pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #12

**来源**: [CVE-2024-23692-vanboomqi_CVE-2024-23692.md](../2024/CVE-2024-23692-vanboomqi_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未授权的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行 Rejetto HFS 2.3m 且网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。根据提供的漏洞利用代码，攻击者通过构造特定的 URL，在URL中嵌入恶意命令，由于程序没有充分过滤模板注入，导致命令在服务器端执行。 

**有效性：**
提供的 POC 代码看起来是有效的。它构造了一个包含恶意命令的 HTTP GET 请求，并使用 `http.client` 库发送请求。代码还包含对响应进行 gzip 解压缩以及检测字符编码的功能，提高了在不同环境下的适应性。代码还实现了重试机制以应对间歇性连接问题。

**投毒风险：**
该漏洞利用代码的投毒风险较低。`LICENSE` 文件表明代码遵循 MIT 许可协议，允许自由使用和修改。`exploit.py` 脚本的主要功能是利用漏洞，没有发现明显的恶意代码。尽管如此，始终建议审查任何第三方代码以确保安全。

**利用方式：**
1.  **漏洞定位：**  该漏洞存在于 Rejetto HTTP File Server 的模板处理功能中。
2.  **攻击向量：**  攻击者通过构造包含恶意代码的 HTTP 请求，特别是 URL 中的参数，来触发模板注入。
3.  **命令执行：**  恶意代码被服务器解析并执行，导致远程命令执行。
4.  **响应处理：**  攻击者通过检查服务器的响应来判断漏洞是否利用成功，并获取命令执行的结果。

**项目地址:** [vanboomqi/CVE-2024-23692](https://github.com/vanboomqi/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #13

**来源**: [CVE-2024-23692-verylazytech_CVE-2024-23692.md](../2024/CVE-2024-23692-verylazytech_CVE-2024-23692.md)

## CVE-2024-23692 Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令。

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HTTP File Server 2.3m，且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出存在私有漏洞利用，搜索结果中也包含了利用该漏洞的攻击案例和检测规则。提供的POC代码也证明了可以执行任意命令。

**投毒风险：**
分析提供的POC代码(`/tmp/39e8ac14437cd2343ad255450790e37a/CVE-2024-23692.sh`)，主要功能是构造并发送包含恶意命令的HTTP请求，并解析响应结果。代码中使用了`iconv`和`base64`对命令进行编码，以绕过可能的过滤。代码的目的是利用模板注入漏洞执行系统命令，没有发现明显的恶意投毒代码。LICENSE文件也声明了是MIT开源协议，作者是允许对代码进行修改的。但是, 鉴于任何从互联网下载的代码都存在潜在风险，因此应该谨慎使用，并在受控环境中进行测试，以及对代码进行审查。

**利用方式：**
利用方式是通过向目标 Rejetto HTTP File Server 发送特制的 HTTP GET 请求。这个请求的 `n` 参数和 `cmd` 参数包含经过编码的恶意命令。服务器会解析这些参数，并通过模板注入漏洞执行命令。POC代码中的关键步骤如下：

1.  构造包含命令的payload，使用powershell执行命令。
2.  使用`iconv -t UTF-16LE` 将命令转换为UTF-16LE编码，防止乱码。
3.  使用 `base64 -w 0` 对UTF-16LE编码后的命令进行Base64编码。
4.  构造完整的URL，包含服务器地址和payload。
5.  使用 `curl` 发送请求。
6.  从响应中提取命令执行结果，提取开始和结束标识符`[S]`之间的内容。
7.  输出提取到的命令执行结果。

综上所述，该漏洞利用有效，但使用时应注意潜在风险。

**项目地址:** [verylazytech/CVE-2024-23692](https://github.com/verylazytech/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---



---

## POC #3

**来源**: [CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md](../2024/CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server Template Injection RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行存在漏洞的Rejetto HFS，并能通过网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在服务器上执行任意命令。由于Rejetto HFS已经停止维护，无法通过官方补丁修复此漏洞。

**有效性分析：**
提供的POC代码（hfs.go）利用了该模板注入漏洞，允许攻击者执行命令、执行DNSLog检测等操作。

**投毒风险分析：**
检查了提供的代码仓库，没有发现明显的恶意代码，但是存在以下几点潜在的投毒风险：
1.  **DNSLog配置：** 默认使用ceye.io，如果ceye.io被恶意利用，可能会导致信息泄露。
2.  **代码依赖：** 依赖gopkg.in/ini.v1，此依赖如果存在漏洞，可能会被利用。
3.  **命令执行：** 命令执行本身就存在风险，如果目标系统权限过高，可能会导致严重的安全问题。
4.  **网络请求：** 攻击代码中会发出网络请求，具有一定的流量特征，可以分析网络流量判断是否存在恶意行为。
因此，整体投毒的概率较低，估计为5%。

**利用方式：**
1.  攻击者首先需要确定目标系统运行的是存在漏洞的Rejetto HFS 2.3m。
2.  攻击者可以利用POC代码，通过`-u`参数指定目标URL。
3.  可以使用`-cmd`参数进入命令行模式，执行任意命令。 例如: `go run hfs.go -u http://127.0.0.1 -cmd`。
4.  可以使用`-dns`参数进行DNSLog检测，验证漏洞是否存在。 例如: `go run hfs.go -u http://127.0.0.1 -dns` 或者 `go run hfs.go -u http://127.0.0.1 -dns -d abc.cn`。
5.  如果需要使用代理，可以通过`-p`参数指定代理服务器地址。 例如: `go run hfs.go -u http://127.0.0.1 -cmd -p http://user:pass@127.0.0.1:8080`。

**缓解措施：**
由于Rejetto HFS已经停止维护，建议用户停止使用该软件，并迁移到其他安全的文件服务器软件。

**项目地址:** [BBD-YZZ/CVE-2024-23692](https://github.com/BBD-YZZ/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #4

**来源**: [CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md](../2024/CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行受影响版本的 Rejetto HFS，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。攻击者可以通过构造特定的 HTTP 请求，在服务器上执行任意命令。\n\n**有效性：**\n提供的 PoC 代码 `CVE-2024-23692.sh` 似乎有效。它构造一个包含恶意模板注入的 HTTP GET 请求，利用 `nc` (netcat) 发送到目标服务器，然后显示响应。脚本接受目标 IP 地址、端口和要执行的命令作为参数。 README.md 文件也提供了使用示例，表明可以执行系统命令或部署反向 shell。\n\n**投毒风险：**\n评估投毒风险时，需要考虑以下几点：\n1.  **代码来源：** 代码来自非官方渠道（GitHub 上的个人仓库）。虽然该漏洞本身是真实存在的，但脚本可能包含恶意代码。\n2.  **脚本功能：** 脚本使用 `nc` 工具发送构造的 HTTP 请求。恶意代码可能被隐藏在构造的请求本身（例如，试图下载和执行其他恶意程序），或者在利用成功后执行其他操作。\n3.  **代码审查：** 快速审查脚本发现其核心功能是利用漏洞。投毒代码可能存在于不明显之处，例如对命令执行结果的篡改或者植入后门。\n4.  **网络行为：** 脚本中使用了`nc`，正常使用是发送恶意请求，如果存在其他网络连接行为，需要特别关注\n\n基于上述分析，认为存在10%的投毒风险。风险主要来自于脚本可能尝试利用漏洞植入后门或者执行其他恶意活动。\n\n**利用方式：**\n1.  **构造恶意 HTTP 请求：** PoC 脚本构造一个带有精心设计的查询字符串的 HTTP GET 请求。该查询字符串包含一个模板注入，允许执行服务器端代码。关键参数是 `cmd`，它包含要执行的命令。\n2.  **发送请求：** 脚本使用 `nc` 工具将构造的 HTTP 请求发送到目标服务器。\n3.  **执行命令：** 如果服务器存在漏洞，它将解析并执行注入的模板，从而执行 `cmd` 参数中指定的命令。\n4.  **获取结果：** 服务器的响应包含命令执行的结果。PoC 脚本捕获并显示此响应。

**项目地址:** [Mr-r00t11/CVE-2024-23692](https://github.com/Mr-r00t11/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #5

**来源**: [CVE-2024-23692-NingXin2002_HFS2.3_poc.md](../2024/CVE-2024-23692-NingXin2002_HFS2.3_poc.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程、未经身份验证的攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标服务器运行Rejetto HTTP File Server 2.3m或更早版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的一个模板注入漏洞。攻击者可以通过发送特制的HTTP请求，利用模板引擎的漏洞执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响所有2.3m及以下版本。PoC代码通过构造包含恶意代码的URL，发送到目标服务器。URL中的`cmd=whoami`部分展示了执行命令的能力。虽然PoC主要功能是验证漏洞，但需要人工审查和小心使用以防止潜在的恶意利用. 

**有效性：** 根据漏洞库信息，搜索引擎结果和POC代码，可以确定该POC代码有效。 多个信息源都表明可以通过特制的HTTP请求执行任意命令。

**投毒风险：** 该仓库的投毒风险较低，估计为10%。主要原因：

1.  **PoC的直接性：** PoC的主要目的是验证漏洞的存在，而不是植入后门。代码功能相对简单，直接发送包含命令的HTTP请求。
2.  **命令执行：** PoC中使用的`whoami`命令用于验证，但如果将命令替换为例如下载并执行恶意脚本的命令，则可能存在风险。
3.  **依赖性：** 该PoC只依赖于requests库，没有使用其他的隐蔽的第三方依赖，降低了引入恶意代码的风险。

**利用方式：** 漏洞利用方式如下：

1.  **确定目标：** 确定目标服务器上运行着存在漏洞的Rejetto HTTP File Server版本（<=2.3m）。
2.  **构造恶意URL：**  使用类似PoC中的URL，将`cmd=whoami`替换为需要执行的系统命令。
3.  **发送HTTP请求：**  通过GET请求将构造的URL发送到目标服务器。
4.  **执行命令：**  目标服务器执行URL中指定的命令。

**项目地址:** [NingXin2002/HFS2.3_poc](https://github.com/NingXin2002/HFS2.3_poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #6

**来源**: [CVE-2024-23692-Tupler_CVE-2024-23692-exp.md](../2024/CVE-2024-23692-Tupler_CVE-2024-23692-exp.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m (实际影响到2.4 RC7)

**利用条件:** 目标服务器运行存在漏洞的 Rejetto HFS 服务，攻击者能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 2.3m 及更早版本（实际影响到 2.4 RC7）中的一个模板注入漏洞。此漏洞允许未经身份验证的远程攻击者通过发送特制的 HTTP 请求在受影响的系统上执行任意命令。

**有效性:**
提供的 Python POC 代码 `CVE-2024-23692.py` 看起来有效。代码首先建立与目标服务器的 TCP 连接。 然后它接收用户输入的命令,将其进行 URL 编码，并将其嵌入到一个精心构造的 HTTP GET 请求中。 该请求利用模板注入漏洞在服务器端执行命令。服务器的响应被解析，提取命令执行的结果并打印给用户。代码通过对返回内容进行正则匹配提取执行结果，并避免直接输出所有返回内容来降低风险。

**投毒风险:**
对提供的 POC 代码 `CVE-2024-23692.py` 和 `README.md` 进行分析后，未发现明显的恶意代码或投毒迹象。 代码的功能符合漏洞利用的预期行为，没有发现尝试执行与漏洞利用无关的恶意操作的代码。

**利用方式:**
1.  **目标确认:** 确定目标服务器上运行着易受攻击的 Rejetto HFS 版本 (<= 2.3m, 实际影响到 2.4 RC7).
2.  **构造Payload:** 构造包含恶意命令的 HTTP GET 请求。 POC代码中cmd参数即是需要执行的命令,该命令会被进行URL编码后插入请求中。
3.  **发送请求:** 将构造的 HTTP 请求发送到目标服务器。
4.  **执行命令:** HFS 处理请求时，会执行注入的命令。 `{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`这部分是payload的关键。 {.exec}调用执行外部命令, {.?cmd.}是用户可控的命令，timeout=15限制超时时间，out=abc.将输出重定向到文件abc.，RESULT和====用于标记输出结果，方便提取。
5.  **获取结果:**  从服务器的响应中提取命令执行的结果。POC代码中对返回内容进行正则匹配，提取RESULT和====之间的内容。

**结论:**
该漏洞利用是有效的，并且能够实现远程代码执行。提供的代码中未发现投毒风险。 通过构造特定的请求，攻击者可以在目标系统上执行任意命令，导致严重的安全风险。 根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [Tupler/CVE-2024-23692-exp](https://github.com/Tupler/CVE-2024-23692-exp)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #7

**来源**: [CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md](../2024/CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md)

## CVE-2024-23692-Rejetto HFS 2.3m 远程命令执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程命令执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行受影响版本的Rejetto HTTP File Server，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意命令。利用方式如下：

1.  **漏洞描述：** 漏洞位于服务器处理模板的环节，攻击者通过构造恶意输入，将命令注入到模板中，由服务器执行。
2.  **漏洞利用方式：** 攻击者发送包含恶意模板代码的HTTP GET请求，服务器解析该请求时，会将恶意代码作为命令执行。
3.  **POC分析：** 提供的Go代码通过`zmap`扫描指定端口，然后使用HTTP GET请求，通过在URL中拼接经过编码的恶意命令来利用漏洞。POC首先检测目标是否为HFS服务，如果是则执行预定义的命令，例如 `ping wlccwlc.dnslog.cn` 和 `whoami`。
4.  **投毒风险分析：** 风险较低。主要风险来自以下几点：
    *   POC中执行的命令可以被修改，攻击者可以利用该POC执行任意恶意命令。
    *   `hfs.go`本身没有发现明显的投毒代码。代码逻辑相对清晰，主要功能是发送HTTP请求并处理响应。
    *   `README.md`文件中包含TG链接，存在一定的恶意引流风险，诱导用户加入恶意社群。

**项目地址:** [WanLiChangChengWanLiChang/CVE-2024-23692-RCE](https://github.com/WanLiChangChengWanLiChang/CVE-2024-23692-RCE)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #8

**来源**: [CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md](../2024/CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要网络访问 Rejetto HFS 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在目标系统上执行任意命令，无需身份验证。漏洞利用方式为通过构造包含恶意代码的HTTP请求，利用HFS模板引擎的缺陷执行命令。提供的代码段只是 Apache License 2.0 的许可证文本，本身不包含任何漏洞利用代码，因此无法评估其有效性。根据搜索结果，该漏洞已经有公开的利用方法，并且Metasploit中已经有相关的利用模块。由于提供的代码只是许可证，所以其中不存在投毒代码的风险。漏洞利用的关键在于构造恶意的HTTP请求，请求中包含可以被HFS服务器解释执行的模板注入代码。从CISA已收录该漏洞的情况来看，此漏洞非常活跃，请尽快进行修复。

**项目地址:** [XiaomingX/cve-2024-23692-poc](https://github.com/XiaomingX/cve-2024-23692-poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #9

**来源**: [CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md](../2024/CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入/远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，允许未授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HFS 2.3m，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中的一个模板注入漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求来执行任意命令。漏洞利用代码通过构造包含恶意payload的GET请求，该payload利用模板引擎的特性执行操作系统命令。payload的形式为 `/?search=%25x%25url%25:%host%}{.exec|cmd.}{.break.}`，其中`cmd`是要执行的命令。检测脚本使用相同的payload，但只是验证服务是否返回200 OK，表明存在漏洞。

**有效性：** 根据漏洞描述、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码很可能是有效的。漏洞信息明确指出存在远程代码执行漏洞，搜索引擎结果证实了这一点，漏洞利用代码也实现了构造恶意请求并执行命令的功能。

**投毒风险：** 提供的代码主要是利用漏洞执行命令，并没有发现明显的恶意代码。但仍然存在微小的风险：

*   **依赖风险：** 代码使用了标准库如socket和sys，风险较低。
*   **命令执行风险：** `cmd`参数由用户提供，如果用户不小心执行了恶意命令，可能会导致问题。但是，这不是代码本身的投毒，而是用户使用不当造成的。
*   **网络连接风险：** 虽然有超时设置，但如果目标服务器被攻陷，可能被用于DDoS等攻击。

考虑到以上因素，投毒风险评估为5%。

**利用方式：**

1.  **确定目标：** 找到运行Rejetto HTTP File Server 2.3m的目标IP地址和端口。
2.  **构造恶意请求：** 使用提供的exploit.py脚本，指定目标IP地址、端口以及要执行的命令。
3.  **发送请求：** 脚本将构造包含恶意payload的HTTP GET请求，并发送到目标服务器。
4.  **执行命令：** 如果目标服务器存在漏洞，服务器将执行payload中的命令。
5.  **验证结果：** 脚本会打印服务器的响应。如果返回“200 OK”，则表示漏洞利用可能成功。弹出计算器或者其他命令执行的反馈需要根据具体环境判断。

**项目地址:** [jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS](https://github.com/jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #10

**来源**: [CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md](../2024/CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行Rejetto HFS 2.3m，且攻击者可以发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的HTTP请求来执行任意命令。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被广泛确认存在并且有公开的PoC。提供的PoC代码（CVE-2024-23692.py）尝试利用该漏洞，发送包含恶意模板注入payload的HTTP GET请求，如果服务器存在漏洞，将执行`ipconfig /all` 命令 (windows系统)或者 `systeminfo` 命令。PoC通过检查响应文本中“RESULT”字符串的出现次数来判断漏洞是否存在。 Burp Suite的POC也验证了此漏洞. 因此，PoC代码是有效的。

**投毒风险分析：**

查看提供的python POC代码，没有发现任何恶意代码，例如反弹shell或下载执行其他文件的行为。也没有发现任何试图修改本地文件或窃取敏感信息的代码。PoC脚本功能相对简单，主要用于验证目标是否存在漏洞。 `README.md` 文件中仅包含 HTTP 请求的 PoC 示例和截图，没有发现潜在的投毒代码。综合判断，该仓库中存在作者隐藏的投毒代码的可能性极低。因此，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** 漏洞出现在HFS处理模板时，没有对用户输入进行充分的过滤和转义，导致攻击者可以通过构造恶意的模板代码来执行任意命令。
2.  **攻击方式：** 攻击者通过发送包含特定payload的HTTP请求到目标服务器。
3.  **Payload构造：** PoC中使用的payload是`/?s=%0A&cmd=ipconfig+/all&search=%25xxx%25url:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`。该payload利用了HFS的模板引擎，`{.exec|{.?cmd.}`部分会执行`cmd`参数指定的命令，并将结果输出。
4.  **命令执行：**  服务器在解析该请求时，会执行`cmd`参数指定的命令（例如 `ipconfig /all`），并将命令执行的结果嵌入到响应中返回给攻击者。
5.  **漏洞验证：**  PoC通过检查响应中特定字符串（例如 `RESULT`）的出现次数来判断漏洞是否存在。

**项目地址:** [k3lpi3b4nsh33/CVE-2024-23692](https://github.com/k3lpi3b4nsh33/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #11

**来源**: [CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md](../2024/CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入 (SSTI)

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程未授权代码执行

**影响版本:** <= 2.3m, 2.4.0 RC7 (测试版本)

**利用条件:** 目标系统运行受影响版本的Rejetto HFS，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 中存在的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。

**有效性：**
根据提供的 Metasploit 模块的 README 文件以及漏洞库信息，该漏洞的 POC 代码是有效的。该 POC 已经在 2.4.0 RC7 和 2.3m 版本上进行了测试，并且成功地执行了远程代码。

**投毒风险：**
提供的代码片段主要是一个 Metasploit 模块的 README，展示了如何使用该模块进行漏洞利用。它包含设置 RHOSTS、RPORT、LHOST 和 LPORT 等参数的示例，以及如何执行 check 和 exploit 命令。由于该代码只是一个使用说明，并且Metasploit是可信的项目，因此，投毒的可能性非常低。

**利用方式：**
攻击者通过构造包含恶意模板代码的HTTP请求，将其发送到存在漏洞的Rejetto HFS服务器。服务器在处理该请求时，会将恶意模板代码解析并执行，从而导致任意代码执行。从Metasploit模块的使用方式可以看出，攻击者可以利用这个漏洞直接获取Meterpreter会话。

**参考：**
*   漏洞库信息
*   搜索引擎结果
*   漏洞利用代码（Metasploit模块README）

**项目地址:** [pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692](https://github.com/pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #12

**来源**: [CVE-2024-23692-vanboomqi_CVE-2024-23692.md](../2024/CVE-2024-23692-vanboomqi_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未授权的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行 Rejetto HFS 2.3m 且网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。根据提供的漏洞利用代码，攻击者通过构造特定的 URL，在URL中嵌入恶意命令，由于程序没有充分过滤模板注入，导致命令在服务器端执行。 

**有效性：**
提供的 POC 代码看起来是有效的。它构造了一个包含恶意命令的 HTTP GET 请求，并使用 `http.client` 库发送请求。代码还包含对响应进行 gzip 解压缩以及检测字符编码的功能，提高了在不同环境下的适应性。代码还实现了重试机制以应对间歇性连接问题。

**投毒风险：**
该漏洞利用代码的投毒风险较低。`LICENSE` 文件表明代码遵循 MIT 许可协议，允许自由使用和修改。`exploit.py` 脚本的主要功能是利用漏洞，没有发现明显的恶意代码。尽管如此，始终建议审查任何第三方代码以确保安全。

**利用方式：**
1.  **漏洞定位：**  该漏洞存在于 Rejetto HTTP File Server 的模板处理功能中。
2.  **攻击向量：**  攻击者通过构造包含恶意代码的 HTTP 请求，特别是 URL 中的参数，来触发模板注入。
3.  **命令执行：**  恶意代码被服务器解析并执行，导致远程命令执行。
4.  **响应处理：**  攻击者通过检查服务器的响应来判断漏洞是否利用成功，并获取命令执行的结果。

**项目地址:** [vanboomqi/CVE-2024-23692](https://github.com/vanboomqi/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #13

**来源**: [CVE-2024-23692-verylazytech_CVE-2024-23692.md](../2024/CVE-2024-23692-verylazytech_CVE-2024-23692.md)

## CVE-2024-23692 Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令。

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HTTP File Server 2.3m，且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出存在私有漏洞利用，搜索结果中也包含了利用该漏洞的攻击案例和检测规则。提供的POC代码也证明了可以执行任意命令。

**投毒风险：**
分析提供的POC代码(`/tmp/39e8ac14437cd2343ad255450790e37a/CVE-2024-23692.sh`)，主要功能是构造并发送包含恶意命令的HTTP请求，并解析响应结果。代码中使用了`iconv`和`base64`对命令进行编码，以绕过可能的过滤。代码的目的是利用模板注入漏洞执行系统命令，没有发现明显的恶意投毒代码。LICENSE文件也声明了是MIT开源协议，作者是允许对代码进行修改的。但是, 鉴于任何从互联网下载的代码都存在潜在风险，因此应该谨慎使用，并在受控环境中进行测试，以及对代码进行审查。

**利用方式：**
利用方式是通过向目标 Rejetto HTTP File Server 发送特制的 HTTP GET 请求。这个请求的 `n` 参数和 `cmd` 参数包含经过编码的恶意命令。服务器会解析这些参数，并通过模板注入漏洞执行命令。POC代码中的关键步骤如下：

1.  构造包含命令的payload，使用powershell执行命令。
2.  使用`iconv -t UTF-16LE` 将命令转换为UTF-16LE编码，防止乱码。
3.  使用 `base64 -w 0` 对UTF-16LE编码后的命令进行Base64编码。
4.  构造完整的URL，包含服务器地址和payload。
5.  使用 `curl` 发送请求。
6.  从响应中提取命令执行结果，提取开始和结束标识符`[S]`之间的内容。
7.  输出提取到的命令执行结果。

综上所述，该漏洞利用有效，但使用时应注意潜在风险。

**项目地址:** [verylazytech/CVE-2024-23692](https://github.com/verylazytech/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---



---

## POC #3

**来源**: [CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md](../2024/CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server Template Injection RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行存在漏洞的Rejetto HFS，并能通过网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在服务器上执行任意命令。由于Rejetto HFS已经停止维护，无法通过官方补丁修复此漏洞。

**有效性分析：**
提供的POC代码（hfs.go）利用了该模板注入漏洞，允许攻击者执行命令、执行DNSLog检测等操作。

**投毒风险分析：**
检查了提供的代码仓库，没有发现明显的恶意代码，但是存在以下几点潜在的投毒风险：
1.  **DNSLog配置：** 默认使用ceye.io，如果ceye.io被恶意利用，可能会导致信息泄露。
2.  **代码依赖：** 依赖gopkg.in/ini.v1，此依赖如果存在漏洞，可能会被利用。
3.  **命令执行：** 命令执行本身就存在风险，如果目标系统权限过高，可能会导致严重的安全问题。
4.  **网络请求：** 攻击代码中会发出网络请求，具有一定的流量特征，可以分析网络流量判断是否存在恶意行为。
因此，整体投毒的概率较低，估计为5%。

**利用方式：**
1.  攻击者首先需要确定目标系统运行的是存在漏洞的Rejetto HFS 2.3m。
2.  攻击者可以利用POC代码，通过`-u`参数指定目标URL。
3.  可以使用`-cmd`参数进入命令行模式，执行任意命令。 例如: `go run hfs.go -u http://127.0.0.1 -cmd`。
4.  可以使用`-dns`参数进行DNSLog检测，验证漏洞是否存在。 例如: `go run hfs.go -u http://127.0.0.1 -dns` 或者 `go run hfs.go -u http://127.0.0.1 -dns -d abc.cn`。
5.  如果需要使用代理，可以通过`-p`参数指定代理服务器地址。 例如: `go run hfs.go -u http://127.0.0.1 -cmd -p http://user:pass@127.0.0.1:8080`。

**缓解措施：**
由于Rejetto HFS已经停止维护，建议用户停止使用该软件，并迁移到其他安全的文件服务器软件。

**项目地址:** [BBD-YZZ/CVE-2024-23692](https://github.com/BBD-YZZ/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #4

**来源**: [CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md](../2024/CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行受影响版本的 Rejetto HFS，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。攻击者可以通过构造特定的 HTTP 请求，在服务器上执行任意命令。\n\n**有效性：**\n提供的 PoC 代码 `CVE-2024-23692.sh` 似乎有效。它构造一个包含恶意模板注入的 HTTP GET 请求，利用 `nc` (netcat) 发送到目标服务器，然后显示响应。脚本接受目标 IP 地址、端口和要执行的命令作为参数。 README.md 文件也提供了使用示例，表明可以执行系统命令或部署反向 shell。\n\n**投毒风险：**\n评估投毒风险时，需要考虑以下几点：\n1.  **代码来源：** 代码来自非官方渠道（GitHub 上的个人仓库）。虽然该漏洞本身是真实存在的，但脚本可能包含恶意代码。\n2.  **脚本功能：** 脚本使用 `nc` 工具发送构造的 HTTP 请求。恶意代码可能被隐藏在构造的请求本身（例如，试图下载和执行其他恶意程序），或者在利用成功后执行其他操作。\n3.  **代码审查：** 快速审查脚本发现其核心功能是利用漏洞。投毒代码可能存在于不明显之处，例如对命令执行结果的篡改或者植入后门。\n4.  **网络行为：** 脚本中使用了`nc`，正常使用是发送恶意请求，如果存在其他网络连接行为，需要特别关注\n\n基于上述分析，认为存在10%的投毒风险。风险主要来自于脚本可能尝试利用漏洞植入后门或者执行其他恶意活动。\n\n**利用方式：**\n1.  **构造恶意 HTTP 请求：** PoC 脚本构造一个带有精心设计的查询字符串的 HTTP GET 请求。该查询字符串包含一个模板注入，允许执行服务器端代码。关键参数是 `cmd`，它包含要执行的命令。\n2.  **发送请求：** 脚本使用 `nc` 工具将构造的 HTTP 请求发送到目标服务器。\n3.  **执行命令：** 如果服务器存在漏洞，它将解析并执行注入的模板，从而执行 `cmd` 参数中指定的命令。\n4.  **获取结果：** 服务器的响应包含命令执行的结果。PoC 脚本捕获并显示此响应。

**项目地址:** [Mr-r00t11/CVE-2024-23692](https://github.com/Mr-r00t11/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #5

**来源**: [CVE-2024-23692-NingXin2002_HFS2.3_poc.md](../2024/CVE-2024-23692-NingXin2002_HFS2.3_poc.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程、未经身份验证的攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标服务器运行Rejetto HTTP File Server 2.3m或更早版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的一个模板注入漏洞。攻击者可以通过发送特制的HTTP请求，利用模板引擎的漏洞执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响所有2.3m及以下版本。PoC代码通过构造包含恶意代码的URL，发送到目标服务器。URL中的`cmd=whoami`部分展示了执行命令的能力。虽然PoC主要功能是验证漏洞，但需要人工审查和小心使用以防止潜在的恶意利用. 

**有效性：** 根据漏洞库信息，搜索引擎结果和POC代码，可以确定该POC代码有效。 多个信息源都表明可以通过特制的HTTP请求执行任意命令。

**投毒风险：** 该仓库的投毒风险较低，估计为10%。主要原因：

1.  **PoC的直接性：** PoC的主要目的是验证漏洞的存在，而不是植入后门。代码功能相对简单，直接发送包含命令的HTTP请求。
2.  **命令执行：** PoC中使用的`whoami`命令用于验证，但如果将命令替换为例如下载并执行恶意脚本的命令，则可能存在风险。
3.  **依赖性：** 该PoC只依赖于requests库，没有使用其他的隐蔽的第三方依赖，降低了引入恶意代码的风险。

**利用方式：** 漏洞利用方式如下：

1.  **确定目标：** 确定目标服务器上运行着存在漏洞的Rejetto HTTP File Server版本（<=2.3m）。
2.  **构造恶意URL：**  使用类似PoC中的URL，将`cmd=whoami`替换为需要执行的系统命令。
3.  **发送HTTP请求：**  通过GET请求将构造的URL发送到目标服务器。
4.  **执行命令：**  目标服务器执行URL中指定的命令。

**项目地址:** [NingXin2002/HFS2.3_poc](https://github.com/NingXin2002/HFS2.3_poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #6

**来源**: [CVE-2024-23692-Tupler_CVE-2024-23692-exp.md](../2024/CVE-2024-23692-Tupler_CVE-2024-23692-exp.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m (实际影响到2.4 RC7)

**利用条件:** 目标服务器运行存在漏洞的 Rejetto HFS 服务，攻击者能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 2.3m 及更早版本（实际影响到 2.4 RC7）中的一个模板注入漏洞。此漏洞允许未经身份验证的远程攻击者通过发送特制的 HTTP 请求在受影响的系统上执行任意命令。

**有效性:**
提供的 Python POC 代码 `CVE-2024-23692.py` 看起来有效。代码首先建立与目标服务器的 TCP 连接。 然后它接收用户输入的命令,将其进行 URL 编码，并将其嵌入到一个精心构造的 HTTP GET 请求中。 该请求利用模板注入漏洞在服务器端执行命令。服务器的响应被解析，提取命令执行的结果并打印给用户。代码通过对返回内容进行正则匹配提取执行结果，并避免直接输出所有返回内容来降低风险。

**投毒风险:**
对提供的 POC 代码 `CVE-2024-23692.py` 和 `README.md` 进行分析后，未发现明显的恶意代码或投毒迹象。 代码的功能符合漏洞利用的预期行为，没有发现尝试执行与漏洞利用无关的恶意操作的代码。

**利用方式:**
1.  **目标确认:** 确定目标服务器上运行着易受攻击的 Rejetto HFS 版本 (<= 2.3m, 实际影响到 2.4 RC7).
2.  **构造Payload:** 构造包含恶意命令的 HTTP GET 请求。 POC代码中cmd参数即是需要执行的命令,该命令会被进行URL编码后插入请求中。
3.  **发送请求:** 将构造的 HTTP 请求发送到目标服务器。
4.  **执行命令:** HFS 处理请求时，会执行注入的命令。 `{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`这部分是payload的关键。 {.exec}调用执行外部命令, {.?cmd.}是用户可控的命令，timeout=15限制超时时间，out=abc.将输出重定向到文件abc.，RESULT和====用于标记输出结果，方便提取。
5.  **获取结果:**  从服务器的响应中提取命令执行的结果。POC代码中对返回内容进行正则匹配，提取RESULT和====之间的内容。

**结论:**
该漏洞利用是有效的，并且能够实现远程代码执行。提供的代码中未发现投毒风险。 通过构造特定的请求，攻击者可以在目标系统上执行任意命令，导致严重的安全风险。 根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [Tupler/CVE-2024-23692-exp](https://github.com/Tupler/CVE-2024-23692-exp)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #7

**来源**: [CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md](../2024/CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md)

## CVE-2024-23692-Rejetto HFS 2.3m 远程命令执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程命令执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行受影响版本的Rejetto HTTP File Server，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意命令。利用方式如下：

1.  **漏洞描述：** 漏洞位于服务器处理模板的环节，攻击者通过构造恶意输入，将命令注入到模板中，由服务器执行。
2.  **漏洞利用方式：** 攻击者发送包含恶意模板代码的HTTP GET请求，服务器解析该请求时，会将恶意代码作为命令执行。
3.  **POC分析：** 提供的Go代码通过`zmap`扫描指定端口，然后使用HTTP GET请求，通过在URL中拼接经过编码的恶意命令来利用漏洞。POC首先检测目标是否为HFS服务，如果是则执行预定义的命令，例如 `ping wlccwlc.dnslog.cn` 和 `whoami`。
4.  **投毒风险分析：** 风险较低。主要风险来自以下几点：
    *   POC中执行的命令可以被修改，攻击者可以利用该POC执行任意恶意命令。
    *   `hfs.go`本身没有发现明显的投毒代码。代码逻辑相对清晰，主要功能是发送HTTP请求并处理响应。
    *   `README.md`文件中包含TG链接，存在一定的恶意引流风险，诱导用户加入恶意社群。

**项目地址:** [WanLiChangChengWanLiChang/CVE-2024-23692-RCE](https://github.com/WanLiChangChengWanLiChang/CVE-2024-23692-RCE)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #8

**来源**: [CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md](../2024/CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要网络访问 Rejetto HFS 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在目标系统上执行任意命令，无需身份验证。漏洞利用方式为通过构造包含恶意代码的HTTP请求，利用HFS模板引擎的缺陷执行命令。提供的代码段只是 Apache License 2.0 的许可证文本，本身不包含任何漏洞利用代码，因此无法评估其有效性。根据搜索结果，该漏洞已经有公开的利用方法，并且Metasploit中已经有相关的利用模块。由于提供的代码只是许可证，所以其中不存在投毒代码的风险。漏洞利用的关键在于构造恶意的HTTP请求，请求中包含可以被HFS服务器解释执行的模板注入代码。从CISA已收录该漏洞的情况来看，此漏洞非常活跃，请尽快进行修复。

**项目地址:** [XiaomingX/cve-2024-23692-poc](https://github.com/XiaomingX/cve-2024-23692-poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #9

**来源**: [CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md](../2024/CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入/远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，允许未授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HFS 2.3m，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中的一个模板注入漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求来执行任意命令。漏洞利用代码通过构造包含恶意payload的GET请求，该payload利用模板引擎的特性执行操作系统命令。payload的形式为 `/?search=%25x%25url%25:%host%}{.exec|cmd.}{.break.}`，其中`cmd`是要执行的命令。检测脚本使用相同的payload，但只是验证服务是否返回200 OK，表明存在漏洞。

**有效性：** 根据漏洞描述、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码很可能是有效的。漏洞信息明确指出存在远程代码执行漏洞，搜索引擎结果证实了这一点，漏洞利用代码也实现了构造恶意请求并执行命令的功能。

**投毒风险：** 提供的代码主要是利用漏洞执行命令，并没有发现明显的恶意代码。但仍然存在微小的风险：

*   **依赖风险：** 代码使用了标准库如socket和sys，风险较低。
*   **命令执行风险：** `cmd`参数由用户提供，如果用户不小心执行了恶意命令，可能会导致问题。但是，这不是代码本身的投毒，而是用户使用不当造成的。
*   **网络连接风险：** 虽然有超时设置，但如果目标服务器被攻陷，可能被用于DDoS等攻击。

考虑到以上因素，投毒风险评估为5%。

**利用方式：**

1.  **确定目标：** 找到运行Rejetto HTTP File Server 2.3m的目标IP地址和端口。
2.  **构造恶意请求：** 使用提供的exploit.py脚本，指定目标IP地址、端口以及要执行的命令。
3.  **发送请求：** 脚本将构造包含恶意payload的HTTP GET请求，并发送到目标服务器。
4.  **执行命令：** 如果目标服务器存在漏洞，服务器将执行payload中的命令。
5.  **验证结果：** 脚本会打印服务器的响应。如果返回“200 OK”，则表示漏洞利用可能成功。弹出计算器或者其他命令执行的反馈需要根据具体环境判断。

**项目地址:** [jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS](https://github.com/jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #10

**来源**: [CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md](../2024/CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行Rejetto HFS 2.3m，且攻击者可以发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的HTTP请求来执行任意命令。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被广泛确认存在并且有公开的PoC。提供的PoC代码（CVE-2024-23692.py）尝试利用该漏洞，发送包含恶意模板注入payload的HTTP GET请求，如果服务器存在漏洞，将执行`ipconfig /all` 命令 (windows系统)或者 `systeminfo` 命令。PoC通过检查响应文本中“RESULT”字符串的出现次数来判断漏洞是否存在。 Burp Suite的POC也验证了此漏洞. 因此，PoC代码是有效的。

**投毒风险分析：**

查看提供的python POC代码，没有发现任何恶意代码，例如反弹shell或下载执行其他文件的行为。也没有发现任何试图修改本地文件或窃取敏感信息的代码。PoC脚本功能相对简单，主要用于验证目标是否存在漏洞。 `README.md` 文件中仅包含 HTTP 请求的 PoC 示例和截图，没有发现潜在的投毒代码。综合判断，该仓库中存在作者隐藏的投毒代码的可能性极低。因此，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** 漏洞出现在HFS处理模板时，没有对用户输入进行充分的过滤和转义，导致攻击者可以通过构造恶意的模板代码来执行任意命令。
2.  **攻击方式：** 攻击者通过发送包含特定payload的HTTP请求到目标服务器。
3.  **Payload构造：** PoC中使用的payload是`/?s=%0A&cmd=ipconfig+/all&search=%25xxx%25url:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`。该payload利用了HFS的模板引擎，`{.exec|{.?cmd.}`部分会执行`cmd`参数指定的命令，并将结果输出。
4.  **命令执行：**  服务器在解析该请求时，会执行`cmd`参数指定的命令（例如 `ipconfig /all`），并将命令执行的结果嵌入到响应中返回给攻击者。
5.  **漏洞验证：**  PoC通过检查响应中特定字符串（例如 `RESULT`）的出现次数来判断漏洞是否存在。

**项目地址:** [k3lpi3b4nsh33/CVE-2024-23692](https://github.com/k3lpi3b4nsh33/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #11

**来源**: [CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md](../2024/CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入 (SSTI)

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程未授权代码执行

**影响版本:** <= 2.3m, 2.4.0 RC7 (测试版本)

**利用条件:** 目标系统运行受影响版本的Rejetto HFS，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 中存在的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。

**有效性：**
根据提供的 Metasploit 模块的 README 文件以及漏洞库信息，该漏洞的 POC 代码是有效的。该 POC 已经在 2.4.0 RC7 和 2.3m 版本上进行了测试，并且成功地执行了远程代码。

**投毒风险：**
提供的代码片段主要是一个 Metasploit 模块的 README，展示了如何使用该模块进行漏洞利用。它包含设置 RHOSTS、RPORT、LHOST 和 LPORT 等参数的示例，以及如何执行 check 和 exploit 命令。由于该代码只是一个使用说明，并且Metasploit是可信的项目，因此，投毒的可能性非常低。

**利用方式：**
攻击者通过构造包含恶意模板代码的HTTP请求，将其发送到存在漏洞的Rejetto HFS服务器。服务器在处理该请求时，会将恶意模板代码解析并执行，从而导致任意代码执行。从Metasploit模块的使用方式可以看出，攻击者可以利用这个漏洞直接获取Meterpreter会话。

**参考：**
*   漏洞库信息
*   搜索引擎结果
*   漏洞利用代码（Metasploit模块README）

**项目地址:** [pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692](https://github.com/pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #12

**来源**: [CVE-2024-23692-vanboomqi_CVE-2024-23692.md](../2024/CVE-2024-23692-vanboomqi_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未授权的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行 Rejetto HFS 2.3m 且网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。根据提供的漏洞利用代码，攻击者通过构造特定的 URL，在URL中嵌入恶意命令，由于程序没有充分过滤模板注入，导致命令在服务器端执行。 

**有效性：**
提供的 POC 代码看起来是有效的。它构造了一个包含恶意命令的 HTTP GET 请求，并使用 `http.client` 库发送请求。代码还包含对响应进行 gzip 解压缩以及检测字符编码的功能，提高了在不同环境下的适应性。代码还实现了重试机制以应对间歇性连接问题。

**投毒风险：**
该漏洞利用代码的投毒风险较低。`LICENSE` 文件表明代码遵循 MIT 许可协议，允许自由使用和修改。`exploit.py` 脚本的主要功能是利用漏洞，没有发现明显的恶意代码。尽管如此，始终建议审查任何第三方代码以确保安全。

**利用方式：**
1.  **漏洞定位：**  该漏洞存在于 Rejetto HTTP File Server 的模板处理功能中。
2.  **攻击向量：**  攻击者通过构造包含恶意代码的 HTTP 请求，特别是 URL 中的参数，来触发模板注入。
3.  **命令执行：**  恶意代码被服务器解析并执行，导致远程命令执行。
4.  **响应处理：**  攻击者通过检查服务器的响应来判断漏洞是否利用成功，并获取命令执行的结果。

**项目地址:** [vanboomqi/CVE-2024-23692](https://github.com/vanboomqi/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #13

**来源**: [CVE-2024-23692-verylazytech_CVE-2024-23692.md](../2024/CVE-2024-23692-verylazytech_CVE-2024-23692.md)

## CVE-2024-23692 Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令。

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HTTP File Server 2.3m，且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出存在私有漏洞利用，搜索结果中也包含了利用该漏洞的攻击案例和检测规则。提供的POC代码也证明了可以执行任意命令。

**投毒风险：**
分析提供的POC代码(`/tmp/39e8ac14437cd2343ad255450790e37a/CVE-2024-23692.sh`)，主要功能是构造并发送包含恶意命令的HTTP请求，并解析响应结果。代码中使用了`iconv`和`base64`对命令进行编码，以绕过可能的过滤。代码的目的是利用模板注入漏洞执行系统命令，没有发现明显的恶意投毒代码。LICENSE文件也声明了是MIT开源协议，作者是允许对代码进行修改的。但是, 鉴于任何从互联网下载的代码都存在潜在风险，因此应该谨慎使用，并在受控环境中进行测试，以及对代码进行审查。

**利用方式：**
利用方式是通过向目标 Rejetto HTTP File Server 发送特制的 HTTP GET 请求。这个请求的 `n` 参数和 `cmd` 参数包含经过编码的恶意命令。服务器会解析这些参数，并通过模板注入漏洞执行命令。POC代码中的关键步骤如下：

1.  构造包含命令的payload，使用powershell执行命令。
2.  使用`iconv -t UTF-16LE` 将命令转换为UTF-16LE编码，防止乱码。
3.  使用 `base64 -w 0` 对UTF-16LE编码后的命令进行Base64编码。
4.  构造完整的URL，包含服务器地址和payload。
5.  使用 `curl` 发送请求。
6.  从响应中提取命令执行结果，提取开始和结束标识符`[S]`之间的内容。
7.  输出提取到的命令执行结果。

综上所述，该漏洞利用有效，但使用时应注意潜在风险。

**项目地址:** [verylazytech/CVE-2024-23692](https://github.com/verylazytech/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---



---

## POC #3

**来源**: [CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md](../2024/CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server Template Injection RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行存在漏洞的Rejetto HFS，并能通过网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在服务器上执行任意命令。由于Rejetto HFS已经停止维护，无法通过官方补丁修复此漏洞。

**有效性分析：**
提供的POC代码（hfs.go）利用了该模板注入漏洞，允许攻击者执行命令、执行DNSLog检测等操作。

**投毒风险分析：**
检查了提供的代码仓库，没有发现明显的恶意代码，但是存在以下几点潜在的投毒风险：
1.  **DNSLog配置：** 默认使用ceye.io，如果ceye.io被恶意利用，可能会导致信息泄露。
2.  **代码依赖：** 依赖gopkg.in/ini.v1，此依赖如果存在漏洞，可能会被利用。
3.  **命令执行：** 命令执行本身就存在风险，如果目标系统权限过高，可能会导致严重的安全问题。
4.  **网络请求：** 攻击代码中会发出网络请求，具有一定的流量特征，可以分析网络流量判断是否存在恶意行为。
因此，整体投毒的概率较低，估计为5%。

**利用方式：**
1.  攻击者首先需要确定目标系统运行的是存在漏洞的Rejetto HFS 2.3m。
2.  攻击者可以利用POC代码，通过`-u`参数指定目标URL。
3.  可以使用`-cmd`参数进入命令行模式，执行任意命令。 例如: `go run hfs.go -u http://127.0.0.1 -cmd`。
4.  可以使用`-dns`参数进行DNSLog检测，验证漏洞是否存在。 例如: `go run hfs.go -u http://127.0.0.1 -dns` 或者 `go run hfs.go -u http://127.0.0.1 -dns -d abc.cn`。
5.  如果需要使用代理，可以通过`-p`参数指定代理服务器地址。 例如: `go run hfs.go -u http://127.0.0.1 -cmd -p http://user:pass@127.0.0.1:8080`。

**缓解措施：**
由于Rejetto HFS已经停止维护，建议用户停止使用该软件，并迁移到其他安全的文件服务器软件。

**项目地址:** [BBD-YZZ/CVE-2024-23692](https://github.com/BBD-YZZ/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #4

**来源**: [CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md](../2024/CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行受影响版本的 Rejetto HFS，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。攻击者可以通过构造特定的 HTTP 请求，在服务器上执行任意命令。\n\n**有效性：**\n提供的 PoC 代码 `CVE-2024-23692.sh` 似乎有效。它构造一个包含恶意模板注入的 HTTP GET 请求，利用 `nc` (netcat) 发送到目标服务器，然后显示响应。脚本接受目标 IP 地址、端口和要执行的命令作为参数。 README.md 文件也提供了使用示例，表明可以执行系统命令或部署反向 shell。\n\n**投毒风险：**\n评估投毒风险时，需要考虑以下几点：\n1.  **代码来源：** 代码来自非官方渠道（GitHub 上的个人仓库）。虽然该漏洞本身是真实存在的，但脚本可能包含恶意代码。\n2.  **脚本功能：** 脚本使用 `nc` 工具发送构造的 HTTP 请求。恶意代码可能被隐藏在构造的请求本身（例如，试图下载和执行其他恶意程序），或者在利用成功后执行其他操作。\n3.  **代码审查：** 快速审查脚本发现其核心功能是利用漏洞。投毒代码可能存在于不明显之处，例如对命令执行结果的篡改或者植入后门。\n4.  **网络行为：** 脚本中使用了`nc`，正常使用是发送恶意请求，如果存在其他网络连接行为，需要特别关注\n\n基于上述分析，认为存在10%的投毒风险。风险主要来自于脚本可能尝试利用漏洞植入后门或者执行其他恶意活动。\n\n**利用方式：**\n1.  **构造恶意 HTTP 请求：** PoC 脚本构造一个带有精心设计的查询字符串的 HTTP GET 请求。该查询字符串包含一个模板注入，允许执行服务器端代码。关键参数是 `cmd`，它包含要执行的命令。\n2.  **发送请求：** 脚本使用 `nc` 工具将构造的 HTTP 请求发送到目标服务器。\n3.  **执行命令：** 如果服务器存在漏洞，它将解析并执行注入的模板，从而执行 `cmd` 参数中指定的命令。\n4.  **获取结果：** 服务器的响应包含命令执行的结果。PoC 脚本捕获并显示此响应。

**项目地址:** [Mr-r00t11/CVE-2024-23692](https://github.com/Mr-r00t11/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #5

**来源**: [CVE-2024-23692-NingXin2002_HFS2.3_poc.md](../2024/CVE-2024-23692-NingXin2002_HFS2.3_poc.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程、未经身份验证的攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标服务器运行Rejetto HTTP File Server 2.3m或更早版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的一个模板注入漏洞。攻击者可以通过发送特制的HTTP请求，利用模板引擎的漏洞执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响所有2.3m及以下版本。PoC代码通过构造包含恶意代码的URL，发送到目标服务器。URL中的`cmd=whoami`部分展示了执行命令的能力。虽然PoC主要功能是验证漏洞，但需要人工审查和小心使用以防止潜在的恶意利用. 

**有效性：** 根据漏洞库信息，搜索引擎结果和POC代码，可以确定该POC代码有效。 多个信息源都表明可以通过特制的HTTP请求执行任意命令。

**投毒风险：** 该仓库的投毒风险较低，估计为10%。主要原因：

1.  **PoC的直接性：** PoC的主要目的是验证漏洞的存在，而不是植入后门。代码功能相对简单，直接发送包含命令的HTTP请求。
2.  **命令执行：** PoC中使用的`whoami`命令用于验证，但如果将命令替换为例如下载并执行恶意脚本的命令，则可能存在风险。
3.  **依赖性：** 该PoC只依赖于requests库，没有使用其他的隐蔽的第三方依赖，降低了引入恶意代码的风险。

**利用方式：** 漏洞利用方式如下：

1.  **确定目标：** 确定目标服务器上运行着存在漏洞的Rejetto HTTP File Server版本（<=2.3m）。
2.  **构造恶意URL：**  使用类似PoC中的URL，将`cmd=whoami`替换为需要执行的系统命令。
3.  **发送HTTP请求：**  通过GET请求将构造的URL发送到目标服务器。
4.  **执行命令：**  目标服务器执行URL中指定的命令。

**项目地址:** [NingXin2002/HFS2.3_poc](https://github.com/NingXin2002/HFS2.3_poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #6

**来源**: [CVE-2024-23692-Tupler_CVE-2024-23692-exp.md](../2024/CVE-2024-23692-Tupler_CVE-2024-23692-exp.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m (实际影响到2.4 RC7)

**利用条件:** 目标服务器运行存在漏洞的 Rejetto HFS 服务，攻击者能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 2.3m 及更早版本（实际影响到 2.4 RC7）中的一个模板注入漏洞。此漏洞允许未经身份验证的远程攻击者通过发送特制的 HTTP 请求在受影响的系统上执行任意命令。

**有效性:**
提供的 Python POC 代码 `CVE-2024-23692.py` 看起来有效。代码首先建立与目标服务器的 TCP 连接。 然后它接收用户输入的命令,将其进行 URL 编码，并将其嵌入到一个精心构造的 HTTP GET 请求中。 该请求利用模板注入漏洞在服务器端执行命令。服务器的响应被解析，提取命令执行的结果并打印给用户。代码通过对返回内容进行正则匹配提取执行结果，并避免直接输出所有返回内容来降低风险。

**投毒风险:**
对提供的 POC 代码 `CVE-2024-23692.py` 和 `README.md` 进行分析后，未发现明显的恶意代码或投毒迹象。 代码的功能符合漏洞利用的预期行为，没有发现尝试执行与漏洞利用无关的恶意操作的代码。

**利用方式:**
1.  **目标确认:** 确定目标服务器上运行着易受攻击的 Rejetto HFS 版本 (<= 2.3m, 实际影响到 2.4 RC7).
2.  **构造Payload:** 构造包含恶意命令的 HTTP GET 请求。 POC代码中cmd参数即是需要执行的命令,该命令会被进行URL编码后插入请求中。
3.  **发送请求:** 将构造的 HTTP 请求发送到目标服务器。
4.  **执行命令:** HFS 处理请求时，会执行注入的命令。 `{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`这部分是payload的关键。 {.exec}调用执行外部命令, {.?cmd.}是用户可控的命令，timeout=15限制超时时间，out=abc.将输出重定向到文件abc.，RESULT和====用于标记输出结果，方便提取。
5.  **获取结果:**  从服务器的响应中提取命令执行的结果。POC代码中对返回内容进行正则匹配，提取RESULT和====之间的内容。

**结论:**
该漏洞利用是有效的，并且能够实现远程代码执行。提供的代码中未发现投毒风险。 通过构造特定的请求，攻击者可以在目标系统上执行任意命令，导致严重的安全风险。 根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [Tupler/CVE-2024-23692-exp](https://github.com/Tupler/CVE-2024-23692-exp)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #7

**来源**: [CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md](../2024/CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md)

## CVE-2024-23692-Rejetto HFS 2.3m 远程命令执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程命令执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行受影响版本的Rejetto HTTP File Server，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意命令。利用方式如下：

1.  **漏洞描述：** 漏洞位于服务器处理模板的环节，攻击者通过构造恶意输入，将命令注入到模板中，由服务器执行。
2.  **漏洞利用方式：** 攻击者发送包含恶意模板代码的HTTP GET请求，服务器解析该请求时，会将恶意代码作为命令执行。
3.  **POC分析：** 提供的Go代码通过`zmap`扫描指定端口，然后使用HTTP GET请求，通过在URL中拼接经过编码的恶意命令来利用漏洞。POC首先检测目标是否为HFS服务，如果是则执行预定义的命令，例如 `ping wlccwlc.dnslog.cn` 和 `whoami`。
4.  **投毒风险分析：** 风险较低。主要风险来自以下几点：
    *   POC中执行的命令可以被修改，攻击者可以利用该POC执行任意恶意命令。
    *   `hfs.go`本身没有发现明显的投毒代码。代码逻辑相对清晰，主要功能是发送HTTP请求并处理响应。
    *   `README.md`文件中包含TG链接，存在一定的恶意引流风险，诱导用户加入恶意社群。

**项目地址:** [WanLiChangChengWanLiChang/CVE-2024-23692-RCE](https://github.com/WanLiChangChengWanLiChang/CVE-2024-23692-RCE)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #8

**来源**: [CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md](../2024/CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要网络访问 Rejetto HFS 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在目标系统上执行任意命令，无需身份验证。漏洞利用方式为通过构造包含恶意代码的HTTP请求，利用HFS模板引擎的缺陷执行命令。提供的代码段只是 Apache License 2.0 的许可证文本，本身不包含任何漏洞利用代码，因此无法评估其有效性。根据搜索结果，该漏洞已经有公开的利用方法，并且Metasploit中已经有相关的利用模块。由于提供的代码只是许可证，所以其中不存在投毒代码的风险。漏洞利用的关键在于构造恶意的HTTP请求，请求中包含可以被HFS服务器解释执行的模板注入代码。从CISA已收录该漏洞的情况来看，此漏洞非常活跃，请尽快进行修复。

**项目地址:** [XiaomingX/cve-2024-23692-poc](https://github.com/XiaomingX/cve-2024-23692-poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #9

**来源**: [CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md](../2024/CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入/远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，允许未授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HFS 2.3m，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中的一个模板注入漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求来执行任意命令。漏洞利用代码通过构造包含恶意payload的GET请求，该payload利用模板引擎的特性执行操作系统命令。payload的形式为 `/?search=%25x%25url%25:%host%}{.exec|cmd.}{.break.}`，其中`cmd`是要执行的命令。检测脚本使用相同的payload，但只是验证服务是否返回200 OK，表明存在漏洞。

**有效性：** 根据漏洞描述、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码很可能是有效的。漏洞信息明确指出存在远程代码执行漏洞，搜索引擎结果证实了这一点，漏洞利用代码也实现了构造恶意请求并执行命令的功能。

**投毒风险：** 提供的代码主要是利用漏洞执行命令，并没有发现明显的恶意代码。但仍然存在微小的风险：

*   **依赖风险：** 代码使用了标准库如socket和sys，风险较低。
*   **命令执行风险：** `cmd`参数由用户提供，如果用户不小心执行了恶意命令，可能会导致问题。但是，这不是代码本身的投毒，而是用户使用不当造成的。
*   **网络连接风险：** 虽然有超时设置，但如果目标服务器被攻陷，可能被用于DDoS等攻击。

考虑到以上因素，投毒风险评估为5%。

**利用方式：**

1.  **确定目标：** 找到运行Rejetto HTTP File Server 2.3m的目标IP地址和端口。
2.  **构造恶意请求：** 使用提供的exploit.py脚本，指定目标IP地址、端口以及要执行的命令。
3.  **发送请求：** 脚本将构造包含恶意payload的HTTP GET请求，并发送到目标服务器。
4.  **执行命令：** 如果目标服务器存在漏洞，服务器将执行payload中的命令。
5.  **验证结果：** 脚本会打印服务器的响应。如果返回“200 OK”，则表示漏洞利用可能成功。弹出计算器或者其他命令执行的反馈需要根据具体环境判断。

**项目地址:** [jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS](https://github.com/jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #10

**来源**: [CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md](../2024/CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行Rejetto HFS 2.3m，且攻击者可以发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的HTTP请求来执行任意命令。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被广泛确认存在并且有公开的PoC。提供的PoC代码（CVE-2024-23692.py）尝试利用该漏洞，发送包含恶意模板注入payload的HTTP GET请求，如果服务器存在漏洞，将执行`ipconfig /all` 命令 (windows系统)或者 `systeminfo` 命令。PoC通过检查响应文本中“RESULT”字符串的出现次数来判断漏洞是否存在。 Burp Suite的POC也验证了此漏洞. 因此，PoC代码是有效的。

**投毒风险分析：**

查看提供的python POC代码，没有发现任何恶意代码，例如反弹shell或下载执行其他文件的行为。也没有发现任何试图修改本地文件或窃取敏感信息的代码。PoC脚本功能相对简单，主要用于验证目标是否存在漏洞。 `README.md` 文件中仅包含 HTTP 请求的 PoC 示例和截图，没有发现潜在的投毒代码。综合判断，该仓库中存在作者隐藏的投毒代码的可能性极低。因此，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** 漏洞出现在HFS处理模板时，没有对用户输入进行充分的过滤和转义，导致攻击者可以通过构造恶意的模板代码来执行任意命令。
2.  **攻击方式：** 攻击者通过发送包含特定payload的HTTP请求到目标服务器。
3.  **Payload构造：** PoC中使用的payload是`/?s=%0A&cmd=ipconfig+/all&search=%25xxx%25url:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`。该payload利用了HFS的模板引擎，`{.exec|{.?cmd.}`部分会执行`cmd`参数指定的命令，并将结果输出。
4.  **命令执行：**  服务器在解析该请求时，会执行`cmd`参数指定的命令（例如 `ipconfig /all`），并将命令执行的结果嵌入到响应中返回给攻击者。
5.  **漏洞验证：**  PoC通过检查响应中特定字符串（例如 `RESULT`）的出现次数来判断漏洞是否存在。

**项目地址:** [k3lpi3b4nsh33/CVE-2024-23692](https://github.com/k3lpi3b4nsh33/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #11

**来源**: [CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md](../2024/CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入 (SSTI)

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程未授权代码执行

**影响版本:** <= 2.3m, 2.4.0 RC7 (测试版本)

**利用条件:** 目标系统运行受影响版本的Rejetto HFS，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 中存在的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。

**有效性：**
根据提供的 Metasploit 模块的 README 文件以及漏洞库信息，该漏洞的 POC 代码是有效的。该 POC 已经在 2.4.0 RC7 和 2.3m 版本上进行了测试，并且成功地执行了远程代码。

**投毒风险：**
提供的代码片段主要是一个 Metasploit 模块的 README，展示了如何使用该模块进行漏洞利用。它包含设置 RHOSTS、RPORT、LHOST 和 LPORT 等参数的示例，以及如何执行 check 和 exploit 命令。由于该代码只是一个使用说明，并且Metasploit是可信的项目，因此，投毒的可能性非常低。

**利用方式：**
攻击者通过构造包含恶意模板代码的HTTP请求，将其发送到存在漏洞的Rejetto HFS服务器。服务器在处理该请求时，会将恶意模板代码解析并执行，从而导致任意代码执行。从Metasploit模块的使用方式可以看出，攻击者可以利用这个漏洞直接获取Meterpreter会话。

**参考：**
*   漏洞库信息
*   搜索引擎结果
*   漏洞利用代码（Metasploit模块README）

**项目地址:** [pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692](https://github.com/pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #12

**来源**: [CVE-2024-23692-vanboomqi_CVE-2024-23692.md](../2024/CVE-2024-23692-vanboomqi_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未授权的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行 Rejetto HFS 2.3m 且网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。根据提供的漏洞利用代码，攻击者通过构造特定的 URL，在URL中嵌入恶意命令，由于程序没有充分过滤模板注入，导致命令在服务器端执行。 

**有效性：**
提供的 POC 代码看起来是有效的。它构造了一个包含恶意命令的 HTTP GET 请求，并使用 `http.client` 库发送请求。代码还包含对响应进行 gzip 解压缩以及检测字符编码的功能，提高了在不同环境下的适应性。代码还实现了重试机制以应对间歇性连接问题。

**投毒风险：**
该漏洞利用代码的投毒风险较低。`LICENSE` 文件表明代码遵循 MIT 许可协议，允许自由使用和修改。`exploit.py` 脚本的主要功能是利用漏洞，没有发现明显的恶意代码。尽管如此，始终建议审查任何第三方代码以确保安全。

**利用方式：**
1.  **漏洞定位：**  该漏洞存在于 Rejetto HTTP File Server 的模板处理功能中。
2.  **攻击向量：**  攻击者通过构造包含恶意代码的 HTTP 请求，特别是 URL 中的参数，来触发模板注入。
3.  **命令执行：**  恶意代码被服务器解析并执行，导致远程命令执行。
4.  **响应处理：**  攻击者通过检查服务器的响应来判断漏洞是否利用成功，并获取命令执行的结果。

**项目地址:** [vanboomqi/CVE-2024-23692](https://github.com/vanboomqi/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #13

**来源**: [CVE-2024-23692-verylazytech_CVE-2024-23692.md](../2024/CVE-2024-23692-verylazytech_CVE-2024-23692.md)

## CVE-2024-23692 Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令。

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HTTP File Server 2.3m，且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出存在私有漏洞利用，搜索结果中也包含了利用该漏洞的攻击案例和检测规则。提供的POC代码也证明了可以执行任意命令。

**投毒风险：**
分析提供的POC代码(`/tmp/39e8ac14437cd2343ad255450790e37a/CVE-2024-23692.sh`)，主要功能是构造并发送包含恶意命令的HTTP请求，并解析响应结果。代码中使用了`iconv`和`base64`对命令进行编码，以绕过可能的过滤。代码的目的是利用模板注入漏洞执行系统命令，没有发现明显的恶意投毒代码。LICENSE文件也声明了是MIT开源协议，作者是允许对代码进行修改的。但是, 鉴于任何从互联网下载的代码都存在潜在风险，因此应该谨慎使用，并在受控环境中进行测试，以及对代码进行审查。

**利用方式：**
利用方式是通过向目标 Rejetto HTTP File Server 发送特制的 HTTP GET 请求。这个请求的 `n` 参数和 `cmd` 参数包含经过编码的恶意命令。服务器会解析这些参数，并通过模板注入漏洞执行命令。POC代码中的关键步骤如下：

1.  构造包含命令的payload，使用powershell执行命令。
2.  使用`iconv -t UTF-16LE` 将命令转换为UTF-16LE编码，防止乱码。
3.  使用 `base64 -w 0` 对UTF-16LE编码后的命令进行Base64编码。
4.  构造完整的URL，包含服务器地址和payload。
5.  使用 `curl` 发送请求。
6.  从响应中提取命令执行结果，提取开始和结束标识符`[S]`之间的内容。
7.  输出提取到的命令执行结果。

综上所述，该漏洞利用有效，但使用时应注意潜在风险。

**项目地址:** [verylazytech/CVE-2024-23692](https://github.com/verylazytech/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---



---

## POC #3

**来源**: [CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md](../2024/CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server Template Injection RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行存在漏洞的Rejetto HFS，并能通过网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在服务器上执行任意命令。由于Rejetto HFS已经停止维护，无法通过官方补丁修复此漏洞。

**有效性分析：**
提供的POC代码（hfs.go）利用了该模板注入漏洞，允许攻击者执行命令、执行DNSLog检测等操作。

**投毒风险分析：**
检查了提供的代码仓库，没有发现明显的恶意代码，但是存在以下几点潜在的投毒风险：
1.  **DNSLog配置：** 默认使用ceye.io，如果ceye.io被恶意利用，可能会导致信息泄露。
2.  **代码依赖：** 依赖gopkg.in/ini.v1，此依赖如果存在漏洞，可能会被利用。
3.  **命令执行：** 命令执行本身就存在风险，如果目标系统权限过高，可能会导致严重的安全问题。
4.  **网络请求：** 攻击代码中会发出网络请求，具有一定的流量特征，可以分析网络流量判断是否存在恶意行为。
因此，整体投毒的概率较低，估计为5%。

**利用方式：**
1.  攻击者首先需要确定目标系统运行的是存在漏洞的Rejetto HFS 2.3m。
2.  攻击者可以利用POC代码，通过`-u`参数指定目标URL。
3.  可以使用`-cmd`参数进入命令行模式，执行任意命令。 例如: `go run hfs.go -u http://127.0.0.1 -cmd`。
4.  可以使用`-dns`参数进行DNSLog检测，验证漏洞是否存在。 例如: `go run hfs.go -u http://127.0.0.1 -dns` 或者 `go run hfs.go -u http://127.0.0.1 -dns -d abc.cn`。
5.  如果需要使用代理，可以通过`-p`参数指定代理服务器地址。 例如: `go run hfs.go -u http://127.0.0.1 -cmd -p http://user:pass@127.0.0.1:8080`。

**缓解措施：**
由于Rejetto HFS已经停止维护，建议用户停止使用该软件，并迁移到其他安全的文件服务器软件。

**项目地址:** [BBD-YZZ/CVE-2024-23692](https://github.com/BBD-YZZ/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #4

**来源**: [CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md](../2024/CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行受影响版本的 Rejetto HFS，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。攻击者可以通过构造特定的 HTTP 请求，在服务器上执行任意命令。\n\n**有效性：**\n提供的 PoC 代码 `CVE-2024-23692.sh` 似乎有效。它构造一个包含恶意模板注入的 HTTP GET 请求，利用 `nc` (netcat) 发送到目标服务器，然后显示响应。脚本接受目标 IP 地址、端口和要执行的命令作为参数。 README.md 文件也提供了使用示例，表明可以执行系统命令或部署反向 shell。\n\n**投毒风险：**\n评估投毒风险时，需要考虑以下几点：\n1.  **代码来源：** 代码来自非官方渠道（GitHub 上的个人仓库）。虽然该漏洞本身是真实存在的，但脚本可能包含恶意代码。\n2.  **脚本功能：** 脚本使用 `nc` 工具发送构造的 HTTP 请求。恶意代码可能被隐藏在构造的请求本身（例如，试图下载和执行其他恶意程序），或者在利用成功后执行其他操作。\n3.  **代码审查：** 快速审查脚本发现其核心功能是利用漏洞。投毒代码可能存在于不明显之处，例如对命令执行结果的篡改或者植入后门。\n4.  **网络行为：** 脚本中使用了`nc`，正常使用是发送恶意请求，如果存在其他网络连接行为，需要特别关注\n\n基于上述分析，认为存在10%的投毒风险。风险主要来自于脚本可能尝试利用漏洞植入后门或者执行其他恶意活动。\n\n**利用方式：**\n1.  **构造恶意 HTTP 请求：** PoC 脚本构造一个带有精心设计的查询字符串的 HTTP GET 请求。该查询字符串包含一个模板注入，允许执行服务器端代码。关键参数是 `cmd`，它包含要执行的命令。\n2.  **发送请求：** 脚本使用 `nc` 工具将构造的 HTTP 请求发送到目标服务器。\n3.  **执行命令：** 如果服务器存在漏洞，它将解析并执行注入的模板，从而执行 `cmd` 参数中指定的命令。\n4.  **获取结果：** 服务器的响应包含命令执行的结果。PoC 脚本捕获并显示此响应。

**项目地址:** [Mr-r00t11/CVE-2024-23692](https://github.com/Mr-r00t11/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #5

**来源**: [CVE-2024-23692-NingXin2002_HFS2.3_poc.md](../2024/CVE-2024-23692-NingXin2002_HFS2.3_poc.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程、未经身份验证的攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标服务器运行Rejetto HTTP File Server 2.3m或更早版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的一个模板注入漏洞。攻击者可以通过发送特制的HTTP请求，利用模板引擎的漏洞执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响所有2.3m及以下版本。PoC代码通过构造包含恶意代码的URL，发送到目标服务器。URL中的`cmd=whoami`部分展示了执行命令的能力。虽然PoC主要功能是验证漏洞，但需要人工审查和小心使用以防止潜在的恶意利用. 

**有效性：** 根据漏洞库信息，搜索引擎结果和POC代码，可以确定该POC代码有效。 多个信息源都表明可以通过特制的HTTP请求执行任意命令。

**投毒风险：** 该仓库的投毒风险较低，估计为10%。主要原因：

1.  **PoC的直接性：** PoC的主要目的是验证漏洞的存在，而不是植入后门。代码功能相对简单，直接发送包含命令的HTTP请求。
2.  **命令执行：** PoC中使用的`whoami`命令用于验证，但如果将命令替换为例如下载并执行恶意脚本的命令，则可能存在风险。
3.  **依赖性：** 该PoC只依赖于requests库，没有使用其他的隐蔽的第三方依赖，降低了引入恶意代码的风险。

**利用方式：** 漏洞利用方式如下：

1.  **确定目标：** 确定目标服务器上运行着存在漏洞的Rejetto HTTP File Server版本（<=2.3m）。
2.  **构造恶意URL：**  使用类似PoC中的URL，将`cmd=whoami`替换为需要执行的系统命令。
3.  **发送HTTP请求：**  通过GET请求将构造的URL发送到目标服务器。
4.  **执行命令：**  目标服务器执行URL中指定的命令。

**项目地址:** [NingXin2002/HFS2.3_poc](https://github.com/NingXin2002/HFS2.3_poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #6

**来源**: [CVE-2024-23692-Tupler_CVE-2024-23692-exp.md](../2024/CVE-2024-23692-Tupler_CVE-2024-23692-exp.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m (实际影响到2.4 RC7)

**利用条件:** 目标服务器运行存在漏洞的 Rejetto HFS 服务，攻击者能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 2.3m 及更早版本（实际影响到 2.4 RC7）中的一个模板注入漏洞。此漏洞允许未经身份验证的远程攻击者通过发送特制的 HTTP 请求在受影响的系统上执行任意命令。

**有效性:**
提供的 Python POC 代码 `CVE-2024-23692.py` 看起来有效。代码首先建立与目标服务器的 TCP 连接。 然后它接收用户输入的命令,将其进行 URL 编码，并将其嵌入到一个精心构造的 HTTP GET 请求中。 该请求利用模板注入漏洞在服务器端执行命令。服务器的响应被解析，提取命令执行的结果并打印给用户。代码通过对返回内容进行正则匹配提取执行结果，并避免直接输出所有返回内容来降低风险。

**投毒风险:**
对提供的 POC 代码 `CVE-2024-23692.py` 和 `README.md` 进行分析后，未发现明显的恶意代码或投毒迹象。 代码的功能符合漏洞利用的预期行为，没有发现尝试执行与漏洞利用无关的恶意操作的代码。

**利用方式:**
1.  **目标确认:** 确定目标服务器上运行着易受攻击的 Rejetto HFS 版本 (<= 2.3m, 实际影响到 2.4 RC7).
2.  **构造Payload:** 构造包含恶意命令的 HTTP GET 请求。 POC代码中cmd参数即是需要执行的命令,该命令会被进行URL编码后插入请求中。
3.  **发送请求:** 将构造的 HTTP 请求发送到目标服务器。
4.  **执行命令:** HFS 处理请求时，会执行注入的命令。 `{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`这部分是payload的关键。 {.exec}调用执行外部命令, {.?cmd.}是用户可控的命令，timeout=15限制超时时间，out=abc.将输出重定向到文件abc.，RESULT和====用于标记输出结果，方便提取。
5.  **获取结果:**  从服务器的响应中提取命令执行的结果。POC代码中对返回内容进行正则匹配，提取RESULT和====之间的内容。

**结论:**
该漏洞利用是有效的，并且能够实现远程代码执行。提供的代码中未发现投毒风险。 通过构造特定的请求，攻击者可以在目标系统上执行任意命令，导致严重的安全风险。 根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [Tupler/CVE-2024-23692-exp](https://github.com/Tupler/CVE-2024-23692-exp)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #7

**来源**: [CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md](../2024/CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md)

## CVE-2024-23692-Rejetto HFS 2.3m 远程命令执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程命令执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行受影响版本的Rejetto HTTP File Server，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意命令。利用方式如下：

1.  **漏洞描述：** 漏洞位于服务器处理模板的环节，攻击者通过构造恶意输入，将命令注入到模板中，由服务器执行。
2.  **漏洞利用方式：** 攻击者发送包含恶意模板代码的HTTP GET请求，服务器解析该请求时，会将恶意代码作为命令执行。
3.  **POC分析：** 提供的Go代码通过`zmap`扫描指定端口，然后使用HTTP GET请求，通过在URL中拼接经过编码的恶意命令来利用漏洞。POC首先检测目标是否为HFS服务，如果是则执行预定义的命令，例如 `ping wlccwlc.dnslog.cn` 和 `whoami`。
4.  **投毒风险分析：** 风险较低。主要风险来自以下几点：
    *   POC中执行的命令可以被修改，攻击者可以利用该POC执行任意恶意命令。
    *   `hfs.go`本身没有发现明显的投毒代码。代码逻辑相对清晰，主要功能是发送HTTP请求并处理响应。
    *   `README.md`文件中包含TG链接，存在一定的恶意引流风险，诱导用户加入恶意社群。

**项目地址:** [WanLiChangChengWanLiChang/CVE-2024-23692-RCE](https://github.com/WanLiChangChengWanLiChang/CVE-2024-23692-RCE)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #8

**来源**: [CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md](../2024/CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要网络访问 Rejetto HFS 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在目标系统上执行任意命令，无需身份验证。漏洞利用方式为通过构造包含恶意代码的HTTP请求，利用HFS模板引擎的缺陷执行命令。提供的代码段只是 Apache License 2.0 的许可证文本，本身不包含任何漏洞利用代码，因此无法评估其有效性。根据搜索结果，该漏洞已经有公开的利用方法，并且Metasploit中已经有相关的利用模块。由于提供的代码只是许可证，所以其中不存在投毒代码的风险。漏洞利用的关键在于构造恶意的HTTP请求，请求中包含可以被HFS服务器解释执行的模板注入代码。从CISA已收录该漏洞的情况来看，此漏洞非常活跃，请尽快进行修复。

**项目地址:** [XiaomingX/cve-2024-23692-poc](https://github.com/XiaomingX/cve-2024-23692-poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #9

**来源**: [CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md](../2024/CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入/远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，允许未授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HFS 2.3m，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中的一个模板注入漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求来执行任意命令。漏洞利用代码通过构造包含恶意payload的GET请求，该payload利用模板引擎的特性执行操作系统命令。payload的形式为 `/?search=%25x%25url%25:%host%}{.exec|cmd.}{.break.}`，其中`cmd`是要执行的命令。检测脚本使用相同的payload，但只是验证服务是否返回200 OK，表明存在漏洞。

**有效性：** 根据漏洞描述、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码很可能是有效的。漏洞信息明确指出存在远程代码执行漏洞，搜索引擎结果证实了这一点，漏洞利用代码也实现了构造恶意请求并执行命令的功能。

**投毒风险：** 提供的代码主要是利用漏洞执行命令，并没有发现明显的恶意代码。但仍然存在微小的风险：

*   **依赖风险：** 代码使用了标准库如socket和sys，风险较低。
*   **命令执行风险：** `cmd`参数由用户提供，如果用户不小心执行了恶意命令，可能会导致问题。但是，这不是代码本身的投毒，而是用户使用不当造成的。
*   **网络连接风险：** 虽然有超时设置，但如果目标服务器被攻陷，可能被用于DDoS等攻击。

考虑到以上因素，投毒风险评估为5%。

**利用方式：**

1.  **确定目标：** 找到运行Rejetto HTTP File Server 2.3m的目标IP地址和端口。
2.  **构造恶意请求：** 使用提供的exploit.py脚本，指定目标IP地址、端口以及要执行的命令。
3.  **发送请求：** 脚本将构造包含恶意payload的HTTP GET请求，并发送到目标服务器。
4.  **执行命令：** 如果目标服务器存在漏洞，服务器将执行payload中的命令。
5.  **验证结果：** 脚本会打印服务器的响应。如果返回“200 OK”，则表示漏洞利用可能成功。弹出计算器或者其他命令执行的反馈需要根据具体环境判断。

**项目地址:** [jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS](https://github.com/jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #10

**来源**: [CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md](../2024/CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行Rejetto HFS 2.3m，且攻击者可以发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的HTTP请求来执行任意命令。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被广泛确认存在并且有公开的PoC。提供的PoC代码（CVE-2024-23692.py）尝试利用该漏洞，发送包含恶意模板注入payload的HTTP GET请求，如果服务器存在漏洞，将执行`ipconfig /all` 命令 (windows系统)或者 `systeminfo` 命令。PoC通过检查响应文本中“RESULT”字符串的出现次数来判断漏洞是否存在。 Burp Suite的POC也验证了此漏洞. 因此，PoC代码是有效的。

**投毒风险分析：**

查看提供的python POC代码，没有发现任何恶意代码，例如反弹shell或下载执行其他文件的行为。也没有发现任何试图修改本地文件或窃取敏感信息的代码。PoC脚本功能相对简单，主要用于验证目标是否存在漏洞。 `README.md` 文件中仅包含 HTTP 请求的 PoC 示例和截图，没有发现潜在的投毒代码。综合判断，该仓库中存在作者隐藏的投毒代码的可能性极低。因此，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** 漏洞出现在HFS处理模板时，没有对用户输入进行充分的过滤和转义，导致攻击者可以通过构造恶意的模板代码来执行任意命令。
2.  **攻击方式：** 攻击者通过发送包含特定payload的HTTP请求到目标服务器。
3.  **Payload构造：** PoC中使用的payload是`/?s=%0A&cmd=ipconfig+/all&search=%25xxx%25url:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`。该payload利用了HFS的模板引擎，`{.exec|{.?cmd.}`部分会执行`cmd`参数指定的命令，并将结果输出。
4.  **命令执行：**  服务器在解析该请求时，会执行`cmd`参数指定的命令（例如 `ipconfig /all`），并将命令执行的结果嵌入到响应中返回给攻击者。
5.  **漏洞验证：**  PoC通过检查响应中特定字符串（例如 `RESULT`）的出现次数来判断漏洞是否存在。

**项目地址:** [k3lpi3b4nsh33/CVE-2024-23692](https://github.com/k3lpi3b4nsh33/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #11

**来源**: [CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md](../2024/CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入 (SSTI)

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程未授权代码执行

**影响版本:** <= 2.3m, 2.4.0 RC7 (测试版本)

**利用条件:** 目标系统运行受影响版本的Rejetto HFS，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 中存在的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。

**有效性：**
根据提供的 Metasploit 模块的 README 文件以及漏洞库信息，该漏洞的 POC 代码是有效的。该 POC 已经在 2.4.0 RC7 和 2.3m 版本上进行了测试，并且成功地执行了远程代码。

**投毒风险：**
提供的代码片段主要是一个 Metasploit 模块的 README，展示了如何使用该模块进行漏洞利用。它包含设置 RHOSTS、RPORT、LHOST 和 LPORT 等参数的示例，以及如何执行 check 和 exploit 命令。由于该代码只是一个使用说明，并且Metasploit是可信的项目，因此，投毒的可能性非常低。

**利用方式：**
攻击者通过构造包含恶意模板代码的HTTP请求，将其发送到存在漏洞的Rejetto HFS服务器。服务器在处理该请求时，会将恶意模板代码解析并执行，从而导致任意代码执行。从Metasploit模块的使用方式可以看出，攻击者可以利用这个漏洞直接获取Meterpreter会话。

**参考：**
*   漏洞库信息
*   搜索引擎结果
*   漏洞利用代码（Metasploit模块README）

**项目地址:** [pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692](https://github.com/pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #12

**来源**: [CVE-2024-23692-vanboomqi_CVE-2024-23692.md](../2024/CVE-2024-23692-vanboomqi_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未授权的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行 Rejetto HFS 2.3m 且网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。根据提供的漏洞利用代码，攻击者通过构造特定的 URL，在URL中嵌入恶意命令，由于程序没有充分过滤模板注入，导致命令在服务器端执行。 

**有效性：**
提供的 POC 代码看起来是有效的。它构造了一个包含恶意命令的 HTTP GET 请求，并使用 `http.client` 库发送请求。代码还包含对响应进行 gzip 解压缩以及检测字符编码的功能，提高了在不同环境下的适应性。代码还实现了重试机制以应对间歇性连接问题。

**投毒风险：**
该漏洞利用代码的投毒风险较低。`LICENSE` 文件表明代码遵循 MIT 许可协议，允许自由使用和修改。`exploit.py` 脚本的主要功能是利用漏洞，没有发现明显的恶意代码。尽管如此，始终建议审查任何第三方代码以确保安全。

**利用方式：**
1.  **漏洞定位：**  该漏洞存在于 Rejetto HTTP File Server 的模板处理功能中。
2.  **攻击向量：**  攻击者通过构造包含恶意代码的 HTTP 请求，特别是 URL 中的参数，来触发模板注入。
3.  **命令执行：**  恶意代码被服务器解析并执行，导致远程命令执行。
4.  **响应处理：**  攻击者通过检查服务器的响应来判断漏洞是否利用成功，并获取命令执行的结果。

**项目地址:** [vanboomqi/CVE-2024-23692](https://github.com/vanboomqi/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #13

**来源**: [CVE-2024-23692-verylazytech_CVE-2024-23692.md](../2024/CVE-2024-23692-verylazytech_CVE-2024-23692.md)

## CVE-2024-23692 Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令。

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HTTP File Server 2.3m，且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出存在私有漏洞利用，搜索结果中也包含了利用该漏洞的攻击案例和检测规则。提供的POC代码也证明了可以执行任意命令。

**投毒风险：**
分析提供的POC代码(`/tmp/39e8ac14437cd2343ad255450790e37a/CVE-2024-23692.sh`)，主要功能是构造并发送包含恶意命令的HTTP请求，并解析响应结果。代码中使用了`iconv`和`base64`对命令进行编码，以绕过可能的过滤。代码的目的是利用模板注入漏洞执行系统命令，没有发现明显的恶意投毒代码。LICENSE文件也声明了是MIT开源协议，作者是允许对代码进行修改的。但是, 鉴于任何从互联网下载的代码都存在潜在风险，因此应该谨慎使用，并在受控环境中进行测试，以及对代码进行审查。

**利用方式：**
利用方式是通过向目标 Rejetto HTTP File Server 发送特制的 HTTP GET 请求。这个请求的 `n` 参数和 `cmd` 参数包含经过编码的恶意命令。服务器会解析这些参数，并通过模板注入漏洞执行命令。POC代码中的关键步骤如下：

1.  构造包含命令的payload，使用powershell执行命令。
2.  使用`iconv -t UTF-16LE` 将命令转换为UTF-16LE编码，防止乱码。
3.  使用 `base64 -w 0` 对UTF-16LE编码后的命令进行Base64编码。
4.  构造完整的URL，包含服务器地址和payload。
5.  使用 `curl` 发送请求。
6.  从响应中提取命令执行结果，提取开始和结束标识符`[S]`之间的内容。
7.  输出提取到的命令执行结果。

综上所述，该漏洞利用有效，但使用时应注意潜在风险。

**项目地址:** [verylazytech/CVE-2024-23692](https://github.com/verylazytech/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---



---

## POC #3

**来源**: [CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md](../2024/CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server Template Injection RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行存在漏洞的Rejetto HFS，并能通过网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在服务器上执行任意命令。由于Rejetto HFS已经停止维护，无法通过官方补丁修复此漏洞。

**有效性分析：**
提供的POC代码（hfs.go）利用了该模板注入漏洞，允许攻击者执行命令、执行DNSLog检测等操作。

**投毒风险分析：**
检查了提供的代码仓库，没有发现明显的恶意代码，但是存在以下几点潜在的投毒风险：
1.  **DNSLog配置：** 默认使用ceye.io，如果ceye.io被恶意利用，可能会导致信息泄露。
2.  **代码依赖：** 依赖gopkg.in/ini.v1，此依赖如果存在漏洞，可能会被利用。
3.  **命令执行：** 命令执行本身就存在风险，如果目标系统权限过高，可能会导致严重的安全问题。
4.  **网络请求：** 攻击代码中会发出网络请求，具有一定的流量特征，可以分析网络流量判断是否存在恶意行为。
因此，整体投毒的概率较低，估计为5%。

**利用方式：**
1.  攻击者首先需要确定目标系统运行的是存在漏洞的Rejetto HFS 2.3m。
2.  攻击者可以利用POC代码，通过`-u`参数指定目标URL。
3.  可以使用`-cmd`参数进入命令行模式，执行任意命令。 例如: `go run hfs.go -u http://127.0.0.1 -cmd`。
4.  可以使用`-dns`参数进行DNSLog检测，验证漏洞是否存在。 例如: `go run hfs.go -u http://127.0.0.1 -dns` 或者 `go run hfs.go -u http://127.0.0.1 -dns -d abc.cn`。
5.  如果需要使用代理，可以通过`-p`参数指定代理服务器地址。 例如: `go run hfs.go -u http://127.0.0.1 -cmd -p http://user:pass@127.0.0.1:8080`。

**缓解措施：**
由于Rejetto HFS已经停止维护，建议用户停止使用该软件，并迁移到其他安全的文件服务器软件。

**项目地址:** [BBD-YZZ/CVE-2024-23692](https://github.com/BBD-YZZ/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #4

**来源**: [CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md](../2024/CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行受影响版本的 Rejetto HFS，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。攻击者可以通过构造特定的 HTTP 请求，在服务器上执行任意命令。\n\n**有效性：**\n提供的 PoC 代码 `CVE-2024-23692.sh` 似乎有效。它构造一个包含恶意模板注入的 HTTP GET 请求，利用 `nc` (netcat) 发送到目标服务器，然后显示响应。脚本接受目标 IP 地址、端口和要执行的命令作为参数。 README.md 文件也提供了使用示例，表明可以执行系统命令或部署反向 shell。\n\n**投毒风险：**\n评估投毒风险时，需要考虑以下几点：\n1.  **代码来源：** 代码来自非官方渠道（GitHub 上的个人仓库）。虽然该漏洞本身是真实存在的，但脚本可能包含恶意代码。\n2.  **脚本功能：** 脚本使用 `nc` 工具发送构造的 HTTP 请求。恶意代码可能被隐藏在构造的请求本身（例如，试图下载和执行其他恶意程序），或者在利用成功后执行其他操作。\n3.  **代码审查：** 快速审查脚本发现其核心功能是利用漏洞。投毒代码可能存在于不明显之处，例如对命令执行结果的篡改或者植入后门。\n4.  **网络行为：** 脚本中使用了`nc`，正常使用是发送恶意请求，如果存在其他网络连接行为，需要特别关注\n\n基于上述分析，认为存在10%的投毒风险。风险主要来自于脚本可能尝试利用漏洞植入后门或者执行其他恶意活动。\n\n**利用方式：**\n1.  **构造恶意 HTTP 请求：** PoC 脚本构造一个带有精心设计的查询字符串的 HTTP GET 请求。该查询字符串包含一个模板注入，允许执行服务器端代码。关键参数是 `cmd`，它包含要执行的命令。\n2.  **发送请求：** 脚本使用 `nc` 工具将构造的 HTTP 请求发送到目标服务器。\n3.  **执行命令：** 如果服务器存在漏洞，它将解析并执行注入的模板，从而执行 `cmd` 参数中指定的命令。\n4.  **获取结果：** 服务器的响应包含命令执行的结果。PoC 脚本捕获并显示此响应。

**项目地址:** [Mr-r00t11/CVE-2024-23692](https://github.com/Mr-r00t11/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #5

**来源**: [CVE-2024-23692-NingXin2002_HFS2.3_poc.md](../2024/CVE-2024-23692-NingXin2002_HFS2.3_poc.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程、未经身份验证的攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标服务器运行Rejetto HTTP File Server 2.3m或更早版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的一个模板注入漏洞。攻击者可以通过发送特制的HTTP请求，利用模板引擎的漏洞执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响所有2.3m及以下版本。PoC代码通过构造包含恶意代码的URL，发送到目标服务器。URL中的`cmd=whoami`部分展示了执行命令的能力。虽然PoC主要功能是验证漏洞，但需要人工审查和小心使用以防止潜在的恶意利用. 

**有效性：** 根据漏洞库信息，搜索引擎结果和POC代码，可以确定该POC代码有效。 多个信息源都表明可以通过特制的HTTP请求执行任意命令。

**投毒风险：** 该仓库的投毒风险较低，估计为10%。主要原因：

1.  **PoC的直接性：** PoC的主要目的是验证漏洞的存在，而不是植入后门。代码功能相对简单，直接发送包含命令的HTTP请求。
2.  **命令执行：** PoC中使用的`whoami`命令用于验证，但如果将命令替换为例如下载并执行恶意脚本的命令，则可能存在风险。
3.  **依赖性：** 该PoC只依赖于requests库，没有使用其他的隐蔽的第三方依赖，降低了引入恶意代码的风险。

**利用方式：** 漏洞利用方式如下：

1.  **确定目标：** 确定目标服务器上运行着存在漏洞的Rejetto HTTP File Server版本（<=2.3m）。
2.  **构造恶意URL：**  使用类似PoC中的URL，将`cmd=whoami`替换为需要执行的系统命令。
3.  **发送HTTP请求：**  通过GET请求将构造的URL发送到目标服务器。
4.  **执行命令：**  目标服务器执行URL中指定的命令。

**项目地址:** [NingXin2002/HFS2.3_poc](https://github.com/NingXin2002/HFS2.3_poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #6

**来源**: [CVE-2024-23692-Tupler_CVE-2024-23692-exp.md](../2024/CVE-2024-23692-Tupler_CVE-2024-23692-exp.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m (实际影响到2.4 RC7)

**利用条件:** 目标服务器运行存在漏洞的 Rejetto HFS 服务，攻击者能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 2.3m 及更早版本（实际影响到 2.4 RC7）中的一个模板注入漏洞。此漏洞允许未经身份验证的远程攻击者通过发送特制的 HTTP 请求在受影响的系统上执行任意命令。

**有效性:**
提供的 Python POC 代码 `CVE-2024-23692.py` 看起来有效。代码首先建立与目标服务器的 TCP 连接。 然后它接收用户输入的命令,将其进行 URL 编码，并将其嵌入到一个精心构造的 HTTP GET 请求中。 该请求利用模板注入漏洞在服务器端执行命令。服务器的响应被解析，提取命令执行的结果并打印给用户。代码通过对返回内容进行正则匹配提取执行结果，并避免直接输出所有返回内容来降低风险。

**投毒风险:**
对提供的 POC 代码 `CVE-2024-23692.py` 和 `README.md` 进行分析后，未发现明显的恶意代码或投毒迹象。 代码的功能符合漏洞利用的预期行为，没有发现尝试执行与漏洞利用无关的恶意操作的代码。

**利用方式:**
1.  **目标确认:** 确定目标服务器上运行着易受攻击的 Rejetto HFS 版本 (<= 2.3m, 实际影响到 2.4 RC7).
2.  **构造Payload:** 构造包含恶意命令的 HTTP GET 请求。 POC代码中cmd参数即是需要执行的命令,该命令会被进行URL编码后插入请求中。
3.  **发送请求:** 将构造的 HTTP 请求发送到目标服务器。
4.  **执行命令:** HFS 处理请求时，会执行注入的命令。 `{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`这部分是payload的关键。 {.exec}调用执行外部命令, {.?cmd.}是用户可控的命令，timeout=15限制超时时间，out=abc.将输出重定向到文件abc.，RESULT和====用于标记输出结果，方便提取。
5.  **获取结果:**  从服务器的响应中提取命令执行的结果。POC代码中对返回内容进行正则匹配，提取RESULT和====之间的内容。

**结论:**
该漏洞利用是有效的，并且能够实现远程代码执行。提供的代码中未发现投毒风险。 通过构造特定的请求，攻击者可以在目标系统上执行任意命令，导致严重的安全风险。 根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [Tupler/CVE-2024-23692-exp](https://github.com/Tupler/CVE-2024-23692-exp)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #7

**来源**: [CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md](../2024/CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md)

## CVE-2024-23692-Rejetto HFS 2.3m 远程命令执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程命令执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行受影响版本的Rejetto HTTP File Server，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意命令。利用方式如下：

1.  **漏洞描述：** 漏洞位于服务器处理模板的环节，攻击者通过构造恶意输入，将命令注入到模板中，由服务器执行。
2.  **漏洞利用方式：** 攻击者发送包含恶意模板代码的HTTP GET请求，服务器解析该请求时，会将恶意代码作为命令执行。
3.  **POC分析：** 提供的Go代码通过`zmap`扫描指定端口，然后使用HTTP GET请求，通过在URL中拼接经过编码的恶意命令来利用漏洞。POC首先检测目标是否为HFS服务，如果是则执行预定义的命令，例如 `ping wlccwlc.dnslog.cn` 和 `whoami`。
4.  **投毒风险分析：** 风险较低。主要风险来自以下几点：
    *   POC中执行的命令可以被修改，攻击者可以利用该POC执行任意恶意命令。
    *   `hfs.go`本身没有发现明显的投毒代码。代码逻辑相对清晰，主要功能是发送HTTP请求并处理响应。
    *   `README.md`文件中包含TG链接，存在一定的恶意引流风险，诱导用户加入恶意社群。

**项目地址:** [WanLiChangChengWanLiChang/CVE-2024-23692-RCE](https://github.com/WanLiChangChengWanLiChang/CVE-2024-23692-RCE)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #8

**来源**: [CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md](../2024/CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要网络访问 Rejetto HFS 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在目标系统上执行任意命令，无需身份验证。漏洞利用方式为通过构造包含恶意代码的HTTP请求，利用HFS模板引擎的缺陷执行命令。提供的代码段只是 Apache License 2.0 的许可证文本，本身不包含任何漏洞利用代码，因此无法评估其有效性。根据搜索结果，该漏洞已经有公开的利用方法，并且Metasploit中已经有相关的利用模块。由于提供的代码只是许可证，所以其中不存在投毒代码的风险。漏洞利用的关键在于构造恶意的HTTP请求，请求中包含可以被HFS服务器解释执行的模板注入代码。从CISA已收录该漏洞的情况来看，此漏洞非常活跃，请尽快进行修复。

**项目地址:** [XiaomingX/cve-2024-23692-poc](https://github.com/XiaomingX/cve-2024-23692-poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #9

**来源**: [CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md](../2024/CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入/远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，允许未授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HFS 2.3m，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中的一个模板注入漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求来执行任意命令。漏洞利用代码通过构造包含恶意payload的GET请求，该payload利用模板引擎的特性执行操作系统命令。payload的形式为 `/?search=%25x%25url%25:%host%}{.exec|cmd.}{.break.}`，其中`cmd`是要执行的命令。检测脚本使用相同的payload，但只是验证服务是否返回200 OK，表明存在漏洞。

**有效性：** 根据漏洞描述、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码很可能是有效的。漏洞信息明确指出存在远程代码执行漏洞，搜索引擎结果证实了这一点，漏洞利用代码也实现了构造恶意请求并执行命令的功能。

**投毒风险：** 提供的代码主要是利用漏洞执行命令，并没有发现明显的恶意代码。但仍然存在微小的风险：

*   **依赖风险：** 代码使用了标准库如socket和sys，风险较低。
*   **命令执行风险：** `cmd`参数由用户提供，如果用户不小心执行了恶意命令，可能会导致问题。但是，这不是代码本身的投毒，而是用户使用不当造成的。
*   **网络连接风险：** 虽然有超时设置，但如果目标服务器被攻陷，可能被用于DDoS等攻击。

考虑到以上因素，投毒风险评估为5%。

**利用方式：**

1.  **确定目标：** 找到运行Rejetto HTTP File Server 2.3m的目标IP地址和端口。
2.  **构造恶意请求：** 使用提供的exploit.py脚本，指定目标IP地址、端口以及要执行的命令。
3.  **发送请求：** 脚本将构造包含恶意payload的HTTP GET请求，并发送到目标服务器。
4.  **执行命令：** 如果目标服务器存在漏洞，服务器将执行payload中的命令。
5.  **验证结果：** 脚本会打印服务器的响应。如果返回“200 OK”，则表示漏洞利用可能成功。弹出计算器或者其他命令执行的反馈需要根据具体环境判断。

**项目地址:** [jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS](https://github.com/jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #10

**来源**: [CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md](../2024/CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行Rejetto HFS 2.3m，且攻击者可以发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的HTTP请求来执行任意命令。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被广泛确认存在并且有公开的PoC。提供的PoC代码（CVE-2024-23692.py）尝试利用该漏洞，发送包含恶意模板注入payload的HTTP GET请求，如果服务器存在漏洞，将执行`ipconfig /all` 命令 (windows系统)或者 `systeminfo` 命令。PoC通过检查响应文本中“RESULT”字符串的出现次数来判断漏洞是否存在。 Burp Suite的POC也验证了此漏洞. 因此，PoC代码是有效的。

**投毒风险分析：**

查看提供的python POC代码，没有发现任何恶意代码，例如反弹shell或下载执行其他文件的行为。也没有发现任何试图修改本地文件或窃取敏感信息的代码。PoC脚本功能相对简单，主要用于验证目标是否存在漏洞。 `README.md` 文件中仅包含 HTTP 请求的 PoC 示例和截图，没有发现潜在的投毒代码。综合判断，该仓库中存在作者隐藏的投毒代码的可能性极低。因此，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** 漏洞出现在HFS处理模板时，没有对用户输入进行充分的过滤和转义，导致攻击者可以通过构造恶意的模板代码来执行任意命令。
2.  **攻击方式：** 攻击者通过发送包含特定payload的HTTP请求到目标服务器。
3.  **Payload构造：** PoC中使用的payload是`/?s=%0A&cmd=ipconfig+/all&search=%25xxx%25url:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`。该payload利用了HFS的模板引擎，`{.exec|{.?cmd.}`部分会执行`cmd`参数指定的命令，并将结果输出。
4.  **命令执行：**  服务器在解析该请求时，会执行`cmd`参数指定的命令（例如 `ipconfig /all`），并将命令执行的结果嵌入到响应中返回给攻击者。
5.  **漏洞验证：**  PoC通过检查响应中特定字符串（例如 `RESULT`）的出现次数来判断漏洞是否存在。

**项目地址:** [k3lpi3b4nsh33/CVE-2024-23692](https://github.com/k3lpi3b4nsh33/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #11

**来源**: [CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md](../2024/CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入 (SSTI)

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程未授权代码执行

**影响版本:** <= 2.3m, 2.4.0 RC7 (测试版本)

**利用条件:** 目标系统运行受影响版本的Rejetto HFS，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 中存在的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。

**有效性：**
根据提供的 Metasploit 模块的 README 文件以及漏洞库信息，该漏洞的 POC 代码是有效的。该 POC 已经在 2.4.0 RC7 和 2.3m 版本上进行了测试，并且成功地执行了远程代码。

**投毒风险：**
提供的代码片段主要是一个 Metasploit 模块的 README，展示了如何使用该模块进行漏洞利用。它包含设置 RHOSTS、RPORT、LHOST 和 LPORT 等参数的示例，以及如何执行 check 和 exploit 命令。由于该代码只是一个使用说明，并且Metasploit是可信的项目，因此，投毒的可能性非常低。

**利用方式：**
攻击者通过构造包含恶意模板代码的HTTP请求，将其发送到存在漏洞的Rejetto HFS服务器。服务器在处理该请求时，会将恶意模板代码解析并执行，从而导致任意代码执行。从Metasploit模块的使用方式可以看出，攻击者可以利用这个漏洞直接获取Meterpreter会话。

**参考：**
*   漏洞库信息
*   搜索引擎结果
*   漏洞利用代码（Metasploit模块README）

**项目地址:** [pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692](https://github.com/pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #12

**来源**: [CVE-2024-23692-vanboomqi_CVE-2024-23692.md](../2024/CVE-2024-23692-vanboomqi_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未授权的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行 Rejetto HFS 2.3m 且网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。根据提供的漏洞利用代码，攻击者通过构造特定的 URL，在URL中嵌入恶意命令，由于程序没有充分过滤模板注入，导致命令在服务器端执行。 

**有效性：**
提供的 POC 代码看起来是有效的。它构造了一个包含恶意命令的 HTTP GET 请求，并使用 `http.client` 库发送请求。代码还包含对响应进行 gzip 解压缩以及检测字符编码的功能，提高了在不同环境下的适应性。代码还实现了重试机制以应对间歇性连接问题。

**投毒风险：**
该漏洞利用代码的投毒风险较低。`LICENSE` 文件表明代码遵循 MIT 许可协议，允许自由使用和修改。`exploit.py` 脚本的主要功能是利用漏洞，没有发现明显的恶意代码。尽管如此，始终建议审查任何第三方代码以确保安全。

**利用方式：**
1.  **漏洞定位：**  该漏洞存在于 Rejetto HTTP File Server 的模板处理功能中。
2.  **攻击向量：**  攻击者通过构造包含恶意代码的 HTTP 请求，特别是 URL 中的参数，来触发模板注入。
3.  **命令执行：**  恶意代码被服务器解析并执行，导致远程命令执行。
4.  **响应处理：**  攻击者通过检查服务器的响应来判断漏洞是否利用成功，并获取命令执行的结果。

**项目地址:** [vanboomqi/CVE-2024-23692](https://github.com/vanboomqi/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #13

**来源**: [CVE-2024-23692-verylazytech_CVE-2024-23692.md](../2024/CVE-2024-23692-verylazytech_CVE-2024-23692.md)

## CVE-2024-23692 Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令。

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HTTP File Server 2.3m，且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出存在私有漏洞利用，搜索结果中也包含了利用该漏洞的攻击案例和检测规则。提供的POC代码也证明了可以执行任意命令。

**投毒风险：**
分析提供的POC代码(`/tmp/39e8ac14437cd2343ad255450790e37a/CVE-2024-23692.sh`)，主要功能是构造并发送包含恶意命令的HTTP请求，并解析响应结果。代码中使用了`iconv`和`base64`对命令进行编码，以绕过可能的过滤。代码的目的是利用模板注入漏洞执行系统命令，没有发现明显的恶意投毒代码。LICENSE文件也声明了是MIT开源协议，作者是允许对代码进行修改的。但是, 鉴于任何从互联网下载的代码都存在潜在风险，因此应该谨慎使用，并在受控环境中进行测试，以及对代码进行审查。

**利用方式：**
利用方式是通过向目标 Rejetto HTTP File Server 发送特制的 HTTP GET 请求。这个请求的 `n` 参数和 `cmd` 参数包含经过编码的恶意命令。服务器会解析这些参数，并通过模板注入漏洞执行命令。POC代码中的关键步骤如下：

1.  构造包含命令的payload，使用powershell执行命令。
2.  使用`iconv -t UTF-16LE` 将命令转换为UTF-16LE编码，防止乱码。
3.  使用 `base64 -w 0` 对UTF-16LE编码后的命令进行Base64编码。
4.  构造完整的URL，包含服务器地址和payload。
5.  使用 `curl` 发送请求。
6.  从响应中提取命令执行结果，提取开始和结束标识符`[S]`之间的内容。
7.  输出提取到的命令执行结果。

综上所述，该漏洞利用有效，但使用时应注意潜在风险。

**项目地址:** [verylazytech/CVE-2024-23692](https://github.com/verylazytech/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---



---

## POC #3

**来源**: [CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md](../2024/CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server Template Injection RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行存在漏洞的Rejetto HFS，并能通过网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在服务器上执行任意命令。由于Rejetto HFS已经停止维护，无法通过官方补丁修复此漏洞。

**有效性分析：**
提供的POC代码（hfs.go）利用了该模板注入漏洞，允许攻击者执行命令、执行DNSLog检测等操作。

**投毒风险分析：**
检查了提供的代码仓库，没有发现明显的恶意代码，但是存在以下几点潜在的投毒风险：
1.  **DNSLog配置：** 默认使用ceye.io，如果ceye.io被恶意利用，可能会导致信息泄露。
2.  **代码依赖：** 依赖gopkg.in/ini.v1，此依赖如果存在漏洞，可能会被利用。
3.  **命令执行：** 命令执行本身就存在风险，如果目标系统权限过高，可能会导致严重的安全问题。
4.  **网络请求：** 攻击代码中会发出网络请求，具有一定的流量特征，可以分析网络流量判断是否存在恶意行为。
因此，整体投毒的概率较低，估计为5%。

**利用方式：**
1.  攻击者首先需要确定目标系统运行的是存在漏洞的Rejetto HFS 2.3m。
2.  攻击者可以利用POC代码，通过`-u`参数指定目标URL。
3.  可以使用`-cmd`参数进入命令行模式，执行任意命令。 例如: `go run hfs.go -u http://127.0.0.1 -cmd`。
4.  可以使用`-dns`参数进行DNSLog检测，验证漏洞是否存在。 例如: `go run hfs.go -u http://127.0.0.1 -dns` 或者 `go run hfs.go -u http://127.0.0.1 -dns -d abc.cn`。
5.  如果需要使用代理，可以通过`-p`参数指定代理服务器地址。 例如: `go run hfs.go -u http://127.0.0.1 -cmd -p http://user:pass@127.0.0.1:8080`。

**缓解措施：**
由于Rejetto HFS已经停止维护，建议用户停止使用该软件，并迁移到其他安全的文件服务器软件。

**项目地址:** [BBD-YZZ/CVE-2024-23692](https://github.com/BBD-YZZ/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #4

**来源**: [CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md](../2024/CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行受影响版本的 Rejetto HFS，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。攻击者可以通过构造特定的 HTTP 请求，在服务器上执行任意命令。\n\n**有效性：**\n提供的 PoC 代码 `CVE-2024-23692.sh` 似乎有效。它构造一个包含恶意模板注入的 HTTP GET 请求，利用 `nc` (netcat) 发送到目标服务器，然后显示响应。脚本接受目标 IP 地址、端口和要执行的命令作为参数。 README.md 文件也提供了使用示例，表明可以执行系统命令或部署反向 shell。\n\n**投毒风险：**\n评估投毒风险时，需要考虑以下几点：\n1.  **代码来源：** 代码来自非官方渠道（GitHub 上的个人仓库）。虽然该漏洞本身是真实存在的，但脚本可能包含恶意代码。\n2.  **脚本功能：** 脚本使用 `nc` 工具发送构造的 HTTP 请求。恶意代码可能被隐藏在构造的请求本身（例如，试图下载和执行其他恶意程序），或者在利用成功后执行其他操作。\n3.  **代码审查：** 快速审查脚本发现其核心功能是利用漏洞。投毒代码可能存在于不明显之处，例如对命令执行结果的篡改或者植入后门。\n4.  **网络行为：** 脚本中使用了`nc`，正常使用是发送恶意请求，如果存在其他网络连接行为，需要特别关注\n\n基于上述分析，认为存在10%的投毒风险。风险主要来自于脚本可能尝试利用漏洞植入后门或者执行其他恶意活动。\n\n**利用方式：**\n1.  **构造恶意 HTTP 请求：** PoC 脚本构造一个带有精心设计的查询字符串的 HTTP GET 请求。该查询字符串包含一个模板注入，允许执行服务器端代码。关键参数是 `cmd`，它包含要执行的命令。\n2.  **发送请求：** 脚本使用 `nc` 工具将构造的 HTTP 请求发送到目标服务器。\n3.  **执行命令：** 如果服务器存在漏洞，它将解析并执行注入的模板，从而执行 `cmd` 参数中指定的命令。\n4.  **获取结果：** 服务器的响应包含命令执行的结果。PoC 脚本捕获并显示此响应。

**项目地址:** [Mr-r00t11/CVE-2024-23692](https://github.com/Mr-r00t11/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #5

**来源**: [CVE-2024-23692-NingXin2002_HFS2.3_poc.md](../2024/CVE-2024-23692-NingXin2002_HFS2.3_poc.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程、未经身份验证的攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标服务器运行Rejetto HTTP File Server 2.3m或更早版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的一个模板注入漏洞。攻击者可以通过发送特制的HTTP请求，利用模板引擎的漏洞执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响所有2.3m及以下版本。PoC代码通过构造包含恶意代码的URL，发送到目标服务器。URL中的`cmd=whoami`部分展示了执行命令的能力。虽然PoC主要功能是验证漏洞，但需要人工审查和小心使用以防止潜在的恶意利用. 

**有效性：** 根据漏洞库信息，搜索引擎结果和POC代码，可以确定该POC代码有效。 多个信息源都表明可以通过特制的HTTP请求执行任意命令。

**投毒风险：** 该仓库的投毒风险较低，估计为10%。主要原因：

1.  **PoC的直接性：** PoC的主要目的是验证漏洞的存在，而不是植入后门。代码功能相对简单，直接发送包含命令的HTTP请求。
2.  **命令执行：** PoC中使用的`whoami`命令用于验证，但如果将命令替换为例如下载并执行恶意脚本的命令，则可能存在风险。
3.  **依赖性：** 该PoC只依赖于requests库，没有使用其他的隐蔽的第三方依赖，降低了引入恶意代码的风险。

**利用方式：** 漏洞利用方式如下：

1.  **确定目标：** 确定目标服务器上运行着存在漏洞的Rejetto HTTP File Server版本（<=2.3m）。
2.  **构造恶意URL：**  使用类似PoC中的URL，将`cmd=whoami`替换为需要执行的系统命令。
3.  **发送HTTP请求：**  通过GET请求将构造的URL发送到目标服务器。
4.  **执行命令：**  目标服务器执行URL中指定的命令。

**项目地址:** [NingXin2002/HFS2.3_poc](https://github.com/NingXin2002/HFS2.3_poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #6

**来源**: [CVE-2024-23692-Tupler_CVE-2024-23692-exp.md](../2024/CVE-2024-23692-Tupler_CVE-2024-23692-exp.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m (实际影响到2.4 RC7)

**利用条件:** 目标服务器运行存在漏洞的 Rejetto HFS 服务，攻击者能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 2.3m 及更早版本（实际影响到 2.4 RC7）中的一个模板注入漏洞。此漏洞允许未经身份验证的远程攻击者通过发送特制的 HTTP 请求在受影响的系统上执行任意命令。

**有效性:**
提供的 Python POC 代码 `CVE-2024-23692.py` 看起来有效。代码首先建立与目标服务器的 TCP 连接。 然后它接收用户输入的命令,将其进行 URL 编码，并将其嵌入到一个精心构造的 HTTP GET 请求中。 该请求利用模板注入漏洞在服务器端执行命令。服务器的响应被解析，提取命令执行的结果并打印给用户。代码通过对返回内容进行正则匹配提取执行结果，并避免直接输出所有返回内容来降低风险。

**投毒风险:**
对提供的 POC 代码 `CVE-2024-23692.py` 和 `README.md` 进行分析后，未发现明显的恶意代码或投毒迹象。 代码的功能符合漏洞利用的预期行为，没有发现尝试执行与漏洞利用无关的恶意操作的代码。

**利用方式:**
1.  **目标确认:** 确定目标服务器上运行着易受攻击的 Rejetto HFS 版本 (<= 2.3m, 实际影响到 2.4 RC7).
2.  **构造Payload:** 构造包含恶意命令的 HTTP GET 请求。 POC代码中cmd参数即是需要执行的命令,该命令会被进行URL编码后插入请求中。
3.  **发送请求:** 将构造的 HTTP 请求发送到目标服务器。
4.  **执行命令:** HFS 处理请求时，会执行注入的命令。 `{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`这部分是payload的关键。 {.exec}调用执行外部命令, {.?cmd.}是用户可控的命令，timeout=15限制超时时间，out=abc.将输出重定向到文件abc.，RESULT和====用于标记输出结果，方便提取。
5.  **获取结果:**  从服务器的响应中提取命令执行的结果。POC代码中对返回内容进行正则匹配，提取RESULT和====之间的内容。

**结论:**
该漏洞利用是有效的，并且能够实现远程代码执行。提供的代码中未发现投毒风险。 通过构造特定的请求，攻击者可以在目标系统上执行任意命令，导致严重的安全风险。 根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [Tupler/CVE-2024-23692-exp](https://github.com/Tupler/CVE-2024-23692-exp)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #7

**来源**: [CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md](../2024/CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md)

## CVE-2024-23692-Rejetto HFS 2.3m 远程命令执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程命令执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行受影响版本的Rejetto HTTP File Server，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意命令。利用方式如下：

1.  **漏洞描述：** 漏洞位于服务器处理模板的环节，攻击者通过构造恶意输入，将命令注入到模板中，由服务器执行。
2.  **漏洞利用方式：** 攻击者发送包含恶意模板代码的HTTP GET请求，服务器解析该请求时，会将恶意代码作为命令执行。
3.  **POC分析：** 提供的Go代码通过`zmap`扫描指定端口，然后使用HTTP GET请求，通过在URL中拼接经过编码的恶意命令来利用漏洞。POC首先检测目标是否为HFS服务，如果是则执行预定义的命令，例如 `ping wlccwlc.dnslog.cn` 和 `whoami`。
4.  **投毒风险分析：** 风险较低。主要风险来自以下几点：
    *   POC中执行的命令可以被修改，攻击者可以利用该POC执行任意恶意命令。
    *   `hfs.go`本身没有发现明显的投毒代码。代码逻辑相对清晰，主要功能是发送HTTP请求并处理响应。
    *   `README.md`文件中包含TG链接，存在一定的恶意引流风险，诱导用户加入恶意社群。

**项目地址:** [WanLiChangChengWanLiChang/CVE-2024-23692-RCE](https://github.com/WanLiChangChengWanLiChang/CVE-2024-23692-RCE)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #8

**来源**: [CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md](../2024/CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要网络访问 Rejetto HFS 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在目标系统上执行任意命令，无需身份验证。漏洞利用方式为通过构造包含恶意代码的HTTP请求，利用HFS模板引擎的缺陷执行命令。提供的代码段只是 Apache License 2.0 的许可证文本，本身不包含任何漏洞利用代码，因此无法评估其有效性。根据搜索结果，该漏洞已经有公开的利用方法，并且Metasploit中已经有相关的利用模块。由于提供的代码只是许可证，所以其中不存在投毒代码的风险。漏洞利用的关键在于构造恶意的HTTP请求，请求中包含可以被HFS服务器解释执行的模板注入代码。从CISA已收录该漏洞的情况来看，此漏洞非常活跃，请尽快进行修复。

**项目地址:** [XiaomingX/cve-2024-23692-poc](https://github.com/XiaomingX/cve-2024-23692-poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #9

**来源**: [CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md](../2024/CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入/远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，允许未授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HFS 2.3m，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中的一个模板注入漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求来执行任意命令。漏洞利用代码通过构造包含恶意payload的GET请求，该payload利用模板引擎的特性执行操作系统命令。payload的形式为 `/?search=%25x%25url%25:%host%}{.exec|cmd.}{.break.}`，其中`cmd`是要执行的命令。检测脚本使用相同的payload，但只是验证服务是否返回200 OK，表明存在漏洞。

**有效性：** 根据漏洞描述、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码很可能是有效的。漏洞信息明确指出存在远程代码执行漏洞，搜索引擎结果证实了这一点，漏洞利用代码也实现了构造恶意请求并执行命令的功能。

**投毒风险：** 提供的代码主要是利用漏洞执行命令，并没有发现明显的恶意代码。但仍然存在微小的风险：

*   **依赖风险：** 代码使用了标准库如socket和sys，风险较低。
*   **命令执行风险：** `cmd`参数由用户提供，如果用户不小心执行了恶意命令，可能会导致问题。但是，这不是代码本身的投毒，而是用户使用不当造成的。
*   **网络连接风险：** 虽然有超时设置，但如果目标服务器被攻陷，可能被用于DDoS等攻击。

考虑到以上因素，投毒风险评估为5%。

**利用方式：**

1.  **确定目标：** 找到运行Rejetto HTTP File Server 2.3m的目标IP地址和端口。
2.  **构造恶意请求：** 使用提供的exploit.py脚本，指定目标IP地址、端口以及要执行的命令。
3.  **发送请求：** 脚本将构造包含恶意payload的HTTP GET请求，并发送到目标服务器。
4.  **执行命令：** 如果目标服务器存在漏洞，服务器将执行payload中的命令。
5.  **验证结果：** 脚本会打印服务器的响应。如果返回“200 OK”，则表示漏洞利用可能成功。弹出计算器或者其他命令执行的反馈需要根据具体环境判断。

**项目地址:** [jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS](https://github.com/jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #10

**来源**: [CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md](../2024/CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行Rejetto HFS 2.3m，且攻击者可以发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的HTTP请求来执行任意命令。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被广泛确认存在并且有公开的PoC。提供的PoC代码（CVE-2024-23692.py）尝试利用该漏洞，发送包含恶意模板注入payload的HTTP GET请求，如果服务器存在漏洞，将执行`ipconfig /all` 命令 (windows系统)或者 `systeminfo` 命令。PoC通过检查响应文本中“RESULT”字符串的出现次数来判断漏洞是否存在。 Burp Suite的POC也验证了此漏洞. 因此，PoC代码是有效的。

**投毒风险分析：**

查看提供的python POC代码，没有发现任何恶意代码，例如反弹shell或下载执行其他文件的行为。也没有发现任何试图修改本地文件或窃取敏感信息的代码。PoC脚本功能相对简单，主要用于验证目标是否存在漏洞。 `README.md` 文件中仅包含 HTTP 请求的 PoC 示例和截图，没有发现潜在的投毒代码。综合判断，该仓库中存在作者隐藏的投毒代码的可能性极低。因此，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** 漏洞出现在HFS处理模板时，没有对用户输入进行充分的过滤和转义，导致攻击者可以通过构造恶意的模板代码来执行任意命令。
2.  **攻击方式：** 攻击者通过发送包含特定payload的HTTP请求到目标服务器。
3.  **Payload构造：** PoC中使用的payload是`/?s=%0A&cmd=ipconfig+/all&search=%25xxx%25url:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`。该payload利用了HFS的模板引擎，`{.exec|{.?cmd.}`部分会执行`cmd`参数指定的命令，并将结果输出。
4.  **命令执行：**  服务器在解析该请求时，会执行`cmd`参数指定的命令（例如 `ipconfig /all`），并将命令执行的结果嵌入到响应中返回给攻击者。
5.  **漏洞验证：**  PoC通过检查响应中特定字符串（例如 `RESULT`）的出现次数来判断漏洞是否存在。

**项目地址:** [k3lpi3b4nsh33/CVE-2024-23692](https://github.com/k3lpi3b4nsh33/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #11

**来源**: [CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md](../2024/CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入 (SSTI)

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程未授权代码执行

**影响版本:** <= 2.3m, 2.4.0 RC7 (测试版本)

**利用条件:** 目标系统运行受影响版本的Rejetto HFS，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 中存在的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。

**有效性：**
根据提供的 Metasploit 模块的 README 文件以及漏洞库信息，该漏洞的 POC 代码是有效的。该 POC 已经在 2.4.0 RC7 和 2.3m 版本上进行了测试，并且成功地执行了远程代码。

**投毒风险：**
提供的代码片段主要是一个 Metasploit 模块的 README，展示了如何使用该模块进行漏洞利用。它包含设置 RHOSTS、RPORT、LHOST 和 LPORT 等参数的示例，以及如何执行 check 和 exploit 命令。由于该代码只是一个使用说明，并且Metasploit是可信的项目，因此，投毒的可能性非常低。

**利用方式：**
攻击者通过构造包含恶意模板代码的HTTP请求，将其发送到存在漏洞的Rejetto HFS服务器。服务器在处理该请求时，会将恶意模板代码解析并执行，从而导致任意代码执行。从Metasploit模块的使用方式可以看出，攻击者可以利用这个漏洞直接获取Meterpreter会话。

**参考：**
*   漏洞库信息
*   搜索引擎结果
*   漏洞利用代码（Metasploit模块README）

**项目地址:** [pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692](https://github.com/pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #12

**来源**: [CVE-2024-23692-vanboomqi_CVE-2024-23692.md](../2024/CVE-2024-23692-vanboomqi_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未授权的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行 Rejetto HFS 2.3m 且网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。根据提供的漏洞利用代码，攻击者通过构造特定的 URL，在URL中嵌入恶意命令，由于程序没有充分过滤模板注入，导致命令在服务器端执行。 

**有效性：**
提供的 POC 代码看起来是有效的。它构造了一个包含恶意命令的 HTTP GET 请求，并使用 `http.client` 库发送请求。代码还包含对响应进行 gzip 解压缩以及检测字符编码的功能，提高了在不同环境下的适应性。代码还实现了重试机制以应对间歇性连接问题。

**投毒风险：**
该漏洞利用代码的投毒风险较低。`LICENSE` 文件表明代码遵循 MIT 许可协议，允许自由使用和修改。`exploit.py` 脚本的主要功能是利用漏洞，没有发现明显的恶意代码。尽管如此，始终建议审查任何第三方代码以确保安全。

**利用方式：**
1.  **漏洞定位：**  该漏洞存在于 Rejetto HTTP File Server 的模板处理功能中。
2.  **攻击向量：**  攻击者通过构造包含恶意代码的 HTTP 请求，特别是 URL 中的参数，来触发模板注入。
3.  **命令执行：**  恶意代码被服务器解析并执行，导致远程命令执行。
4.  **响应处理：**  攻击者通过检查服务器的响应来判断漏洞是否利用成功，并获取命令执行的结果。

**项目地址:** [vanboomqi/CVE-2024-23692](https://github.com/vanboomqi/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #13

**来源**: [CVE-2024-23692-verylazytech_CVE-2024-23692.md](../2024/CVE-2024-23692-verylazytech_CVE-2024-23692.md)

## CVE-2024-23692 Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令。

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HTTP File Server 2.3m，且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出存在私有漏洞利用，搜索结果中也包含了利用该漏洞的攻击案例和检测规则。提供的POC代码也证明了可以执行任意命令。

**投毒风险：**
分析提供的POC代码(`/tmp/39e8ac14437cd2343ad255450790e37a/CVE-2024-23692.sh`)，主要功能是构造并发送包含恶意命令的HTTP请求，并解析响应结果。代码中使用了`iconv`和`base64`对命令进行编码，以绕过可能的过滤。代码的目的是利用模板注入漏洞执行系统命令，没有发现明显的恶意投毒代码。LICENSE文件也声明了是MIT开源协议，作者是允许对代码进行修改的。但是, 鉴于任何从互联网下载的代码都存在潜在风险，因此应该谨慎使用，并在受控环境中进行测试，以及对代码进行审查。

**利用方式：**
利用方式是通过向目标 Rejetto HTTP File Server 发送特制的 HTTP GET 请求。这个请求的 `n` 参数和 `cmd` 参数包含经过编码的恶意命令。服务器会解析这些参数，并通过模板注入漏洞执行命令。POC代码中的关键步骤如下：

1.  构造包含命令的payload，使用powershell执行命令。
2.  使用`iconv -t UTF-16LE` 将命令转换为UTF-16LE编码，防止乱码。
3.  使用 `base64 -w 0` 对UTF-16LE编码后的命令进行Base64编码。
4.  构造完整的URL，包含服务器地址和payload。
5.  使用 `curl` 发送请求。
6.  从响应中提取命令执行结果，提取开始和结束标识符`[S]`之间的内容。
7.  输出提取到的命令执行结果。

综上所述，该漏洞利用有效，但使用时应注意潜在风险。

**项目地址:** [verylazytech/CVE-2024-23692](https://github.com/verylazytech/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---



---

## POC #3

**来源**: [CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md](../2024/CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server Template Injection RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行存在漏洞的Rejetto HFS，并能通过网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在服务器上执行任意命令。由于Rejetto HFS已经停止维护，无法通过官方补丁修复此漏洞。

**有效性分析：**
提供的POC代码（hfs.go）利用了该模板注入漏洞，允许攻击者执行命令、执行DNSLog检测等操作。

**投毒风险分析：**
检查了提供的代码仓库，没有发现明显的恶意代码，但是存在以下几点潜在的投毒风险：
1.  **DNSLog配置：** 默认使用ceye.io，如果ceye.io被恶意利用，可能会导致信息泄露。
2.  **代码依赖：** 依赖gopkg.in/ini.v1，此依赖如果存在漏洞，可能会被利用。
3.  **命令执行：** 命令执行本身就存在风险，如果目标系统权限过高，可能会导致严重的安全问题。
4.  **网络请求：** 攻击代码中会发出网络请求，具有一定的流量特征，可以分析网络流量判断是否存在恶意行为。
因此，整体投毒的概率较低，估计为5%。

**利用方式：**
1.  攻击者首先需要确定目标系统运行的是存在漏洞的Rejetto HFS 2.3m。
2.  攻击者可以利用POC代码，通过`-u`参数指定目标URL。
3.  可以使用`-cmd`参数进入命令行模式，执行任意命令。 例如: `go run hfs.go -u http://127.0.0.1 -cmd`。
4.  可以使用`-dns`参数进行DNSLog检测，验证漏洞是否存在。 例如: `go run hfs.go -u http://127.0.0.1 -dns` 或者 `go run hfs.go -u http://127.0.0.1 -dns -d abc.cn`。
5.  如果需要使用代理，可以通过`-p`参数指定代理服务器地址。 例如: `go run hfs.go -u http://127.0.0.1 -cmd -p http://user:pass@127.0.0.1:8080`。

**缓解措施：**
由于Rejetto HFS已经停止维护，建议用户停止使用该软件，并迁移到其他安全的文件服务器软件。

**项目地址:** [BBD-YZZ/CVE-2024-23692](https://github.com/BBD-YZZ/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #4

**来源**: [CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md](../2024/CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行受影响版本的 Rejetto HFS，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。攻击者可以通过构造特定的 HTTP 请求，在服务器上执行任意命令。\n\n**有效性：**\n提供的 PoC 代码 `CVE-2024-23692.sh` 似乎有效。它构造一个包含恶意模板注入的 HTTP GET 请求，利用 `nc` (netcat) 发送到目标服务器，然后显示响应。脚本接受目标 IP 地址、端口和要执行的命令作为参数。 README.md 文件也提供了使用示例，表明可以执行系统命令或部署反向 shell。\n\n**投毒风险：**\n评估投毒风险时，需要考虑以下几点：\n1.  **代码来源：** 代码来自非官方渠道（GitHub 上的个人仓库）。虽然该漏洞本身是真实存在的，但脚本可能包含恶意代码。\n2.  **脚本功能：** 脚本使用 `nc` 工具发送构造的 HTTP 请求。恶意代码可能被隐藏在构造的请求本身（例如，试图下载和执行其他恶意程序），或者在利用成功后执行其他操作。\n3.  **代码审查：** 快速审查脚本发现其核心功能是利用漏洞。投毒代码可能存在于不明显之处，例如对命令执行结果的篡改或者植入后门。\n4.  **网络行为：** 脚本中使用了`nc`，正常使用是发送恶意请求，如果存在其他网络连接行为，需要特别关注\n\n基于上述分析，认为存在10%的投毒风险。风险主要来自于脚本可能尝试利用漏洞植入后门或者执行其他恶意活动。\n\n**利用方式：**\n1.  **构造恶意 HTTP 请求：** PoC 脚本构造一个带有精心设计的查询字符串的 HTTP GET 请求。该查询字符串包含一个模板注入，允许执行服务器端代码。关键参数是 `cmd`，它包含要执行的命令。\n2.  **发送请求：** 脚本使用 `nc` 工具将构造的 HTTP 请求发送到目标服务器。\n3.  **执行命令：** 如果服务器存在漏洞，它将解析并执行注入的模板，从而执行 `cmd` 参数中指定的命令。\n4.  **获取结果：** 服务器的响应包含命令执行的结果。PoC 脚本捕获并显示此响应。

**项目地址:** [Mr-r00t11/CVE-2024-23692](https://github.com/Mr-r00t11/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #5

**来源**: [CVE-2024-23692-NingXin2002_HFS2.3_poc.md](../2024/CVE-2024-23692-NingXin2002_HFS2.3_poc.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程、未经身份验证的攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标服务器运行Rejetto HTTP File Server 2.3m或更早版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的一个模板注入漏洞。攻击者可以通过发送特制的HTTP请求，利用模板引擎的漏洞执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响所有2.3m及以下版本。PoC代码通过构造包含恶意代码的URL，发送到目标服务器。URL中的`cmd=whoami`部分展示了执行命令的能力。虽然PoC主要功能是验证漏洞，但需要人工审查和小心使用以防止潜在的恶意利用. 

**有效性：** 根据漏洞库信息，搜索引擎结果和POC代码，可以确定该POC代码有效。 多个信息源都表明可以通过特制的HTTP请求执行任意命令。

**投毒风险：** 该仓库的投毒风险较低，估计为10%。主要原因：

1.  **PoC的直接性：** PoC的主要目的是验证漏洞的存在，而不是植入后门。代码功能相对简单，直接发送包含命令的HTTP请求。
2.  **命令执行：** PoC中使用的`whoami`命令用于验证，但如果将命令替换为例如下载并执行恶意脚本的命令，则可能存在风险。
3.  **依赖性：** 该PoC只依赖于requests库，没有使用其他的隐蔽的第三方依赖，降低了引入恶意代码的风险。

**利用方式：** 漏洞利用方式如下：

1.  **确定目标：** 确定目标服务器上运行着存在漏洞的Rejetto HTTP File Server版本（<=2.3m）。
2.  **构造恶意URL：**  使用类似PoC中的URL，将`cmd=whoami`替换为需要执行的系统命令。
3.  **发送HTTP请求：**  通过GET请求将构造的URL发送到目标服务器。
4.  **执行命令：**  目标服务器执行URL中指定的命令。

**项目地址:** [NingXin2002/HFS2.3_poc](https://github.com/NingXin2002/HFS2.3_poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #6

**来源**: [CVE-2024-23692-Tupler_CVE-2024-23692-exp.md](../2024/CVE-2024-23692-Tupler_CVE-2024-23692-exp.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m (实际影响到2.4 RC7)

**利用条件:** 目标服务器运行存在漏洞的 Rejetto HFS 服务，攻击者能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 2.3m 及更早版本（实际影响到 2.4 RC7）中的一个模板注入漏洞。此漏洞允许未经身份验证的远程攻击者通过发送特制的 HTTP 请求在受影响的系统上执行任意命令。

**有效性:**
提供的 Python POC 代码 `CVE-2024-23692.py` 看起来有效。代码首先建立与目标服务器的 TCP 连接。 然后它接收用户输入的命令,将其进行 URL 编码，并将其嵌入到一个精心构造的 HTTP GET 请求中。 该请求利用模板注入漏洞在服务器端执行命令。服务器的响应被解析，提取命令执行的结果并打印给用户。代码通过对返回内容进行正则匹配提取执行结果，并避免直接输出所有返回内容来降低风险。

**投毒风险:**
对提供的 POC 代码 `CVE-2024-23692.py` 和 `README.md` 进行分析后，未发现明显的恶意代码或投毒迹象。 代码的功能符合漏洞利用的预期行为，没有发现尝试执行与漏洞利用无关的恶意操作的代码。

**利用方式:**
1.  **目标确认:** 确定目标服务器上运行着易受攻击的 Rejetto HFS 版本 (<= 2.3m, 实际影响到 2.4 RC7).
2.  **构造Payload:** 构造包含恶意命令的 HTTP GET 请求。 POC代码中cmd参数即是需要执行的命令,该命令会被进行URL编码后插入请求中。
3.  **发送请求:** 将构造的 HTTP 请求发送到目标服务器。
4.  **执行命令:** HFS 处理请求时，会执行注入的命令。 `{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`这部分是payload的关键。 {.exec}调用执行外部命令, {.?cmd.}是用户可控的命令，timeout=15限制超时时间，out=abc.将输出重定向到文件abc.，RESULT和====用于标记输出结果，方便提取。
5.  **获取结果:**  从服务器的响应中提取命令执行的结果。POC代码中对返回内容进行正则匹配，提取RESULT和====之间的内容。

**结论:**
该漏洞利用是有效的，并且能够实现远程代码执行。提供的代码中未发现投毒风险。 通过构造特定的请求，攻击者可以在目标系统上执行任意命令，导致严重的安全风险。 根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [Tupler/CVE-2024-23692-exp](https://github.com/Tupler/CVE-2024-23692-exp)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #7

**来源**: [CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md](../2024/CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md)

## CVE-2024-23692-Rejetto HFS 2.3m 远程命令执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程命令执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行受影响版本的Rejetto HTTP File Server，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意命令。利用方式如下：

1.  **漏洞描述：** 漏洞位于服务器处理模板的环节，攻击者通过构造恶意输入，将命令注入到模板中，由服务器执行。
2.  **漏洞利用方式：** 攻击者发送包含恶意模板代码的HTTP GET请求，服务器解析该请求时，会将恶意代码作为命令执行。
3.  **POC分析：** 提供的Go代码通过`zmap`扫描指定端口，然后使用HTTP GET请求，通过在URL中拼接经过编码的恶意命令来利用漏洞。POC首先检测目标是否为HFS服务，如果是则执行预定义的命令，例如 `ping wlccwlc.dnslog.cn` 和 `whoami`。
4.  **投毒风险分析：** 风险较低。主要风险来自以下几点：
    *   POC中执行的命令可以被修改，攻击者可以利用该POC执行任意恶意命令。
    *   `hfs.go`本身没有发现明显的投毒代码。代码逻辑相对清晰，主要功能是发送HTTP请求并处理响应。
    *   `README.md`文件中包含TG链接，存在一定的恶意引流风险，诱导用户加入恶意社群。

**项目地址:** [WanLiChangChengWanLiChang/CVE-2024-23692-RCE](https://github.com/WanLiChangChengWanLiChang/CVE-2024-23692-RCE)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #8

**来源**: [CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md](../2024/CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要网络访问 Rejetto HFS 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在目标系统上执行任意命令，无需身份验证。漏洞利用方式为通过构造包含恶意代码的HTTP请求，利用HFS模板引擎的缺陷执行命令。提供的代码段只是 Apache License 2.0 的许可证文本，本身不包含任何漏洞利用代码，因此无法评估其有效性。根据搜索结果，该漏洞已经有公开的利用方法，并且Metasploit中已经有相关的利用模块。由于提供的代码只是许可证，所以其中不存在投毒代码的风险。漏洞利用的关键在于构造恶意的HTTP请求，请求中包含可以被HFS服务器解释执行的模板注入代码。从CISA已收录该漏洞的情况来看，此漏洞非常活跃，请尽快进行修复。

**项目地址:** [XiaomingX/cve-2024-23692-poc](https://github.com/XiaomingX/cve-2024-23692-poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #9

**来源**: [CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md](../2024/CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入/远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，允许未授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HFS 2.3m，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中的一个模板注入漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求来执行任意命令。漏洞利用代码通过构造包含恶意payload的GET请求，该payload利用模板引擎的特性执行操作系统命令。payload的形式为 `/?search=%25x%25url%25:%host%}{.exec|cmd.}{.break.}`，其中`cmd`是要执行的命令。检测脚本使用相同的payload，但只是验证服务是否返回200 OK，表明存在漏洞。

**有效性：** 根据漏洞描述、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码很可能是有效的。漏洞信息明确指出存在远程代码执行漏洞，搜索引擎结果证实了这一点，漏洞利用代码也实现了构造恶意请求并执行命令的功能。

**投毒风险：** 提供的代码主要是利用漏洞执行命令，并没有发现明显的恶意代码。但仍然存在微小的风险：

*   **依赖风险：** 代码使用了标准库如socket和sys，风险较低。
*   **命令执行风险：** `cmd`参数由用户提供，如果用户不小心执行了恶意命令，可能会导致问题。但是，这不是代码本身的投毒，而是用户使用不当造成的。
*   **网络连接风险：** 虽然有超时设置，但如果目标服务器被攻陷，可能被用于DDoS等攻击。

考虑到以上因素，投毒风险评估为5%。

**利用方式：**

1.  **确定目标：** 找到运行Rejetto HTTP File Server 2.3m的目标IP地址和端口。
2.  **构造恶意请求：** 使用提供的exploit.py脚本，指定目标IP地址、端口以及要执行的命令。
3.  **发送请求：** 脚本将构造包含恶意payload的HTTP GET请求，并发送到目标服务器。
4.  **执行命令：** 如果目标服务器存在漏洞，服务器将执行payload中的命令。
5.  **验证结果：** 脚本会打印服务器的响应。如果返回“200 OK”，则表示漏洞利用可能成功。弹出计算器或者其他命令执行的反馈需要根据具体环境判断。

**项目地址:** [jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS](https://github.com/jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #10

**来源**: [CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md](../2024/CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行Rejetto HFS 2.3m，且攻击者可以发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的HTTP请求来执行任意命令。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被广泛确认存在并且有公开的PoC。提供的PoC代码（CVE-2024-23692.py）尝试利用该漏洞，发送包含恶意模板注入payload的HTTP GET请求，如果服务器存在漏洞，将执行`ipconfig /all` 命令 (windows系统)或者 `systeminfo` 命令。PoC通过检查响应文本中“RESULT”字符串的出现次数来判断漏洞是否存在。 Burp Suite的POC也验证了此漏洞. 因此，PoC代码是有效的。

**投毒风险分析：**

查看提供的python POC代码，没有发现任何恶意代码，例如反弹shell或下载执行其他文件的行为。也没有发现任何试图修改本地文件或窃取敏感信息的代码。PoC脚本功能相对简单，主要用于验证目标是否存在漏洞。 `README.md` 文件中仅包含 HTTP 请求的 PoC 示例和截图，没有发现潜在的投毒代码。综合判断，该仓库中存在作者隐藏的投毒代码的可能性极低。因此，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** 漏洞出现在HFS处理模板时，没有对用户输入进行充分的过滤和转义，导致攻击者可以通过构造恶意的模板代码来执行任意命令。
2.  **攻击方式：** 攻击者通过发送包含特定payload的HTTP请求到目标服务器。
3.  **Payload构造：** PoC中使用的payload是`/?s=%0A&cmd=ipconfig+/all&search=%25xxx%25url:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`。该payload利用了HFS的模板引擎，`{.exec|{.?cmd.}`部分会执行`cmd`参数指定的命令，并将结果输出。
4.  **命令执行：**  服务器在解析该请求时，会执行`cmd`参数指定的命令（例如 `ipconfig /all`），并将命令执行的结果嵌入到响应中返回给攻击者。
5.  **漏洞验证：**  PoC通过检查响应中特定字符串（例如 `RESULT`）的出现次数来判断漏洞是否存在。

**项目地址:** [k3lpi3b4nsh33/CVE-2024-23692](https://github.com/k3lpi3b4nsh33/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #11

**来源**: [CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md](../2024/CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入 (SSTI)

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程未授权代码执行

**影响版本:** <= 2.3m, 2.4.0 RC7 (测试版本)

**利用条件:** 目标系统运行受影响版本的Rejetto HFS，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 中存在的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。

**有效性：**
根据提供的 Metasploit 模块的 README 文件以及漏洞库信息，该漏洞的 POC 代码是有效的。该 POC 已经在 2.4.0 RC7 和 2.3m 版本上进行了测试，并且成功地执行了远程代码。

**投毒风险：**
提供的代码片段主要是一个 Metasploit 模块的 README，展示了如何使用该模块进行漏洞利用。它包含设置 RHOSTS、RPORT、LHOST 和 LPORT 等参数的示例，以及如何执行 check 和 exploit 命令。由于该代码只是一个使用说明，并且Metasploit是可信的项目，因此，投毒的可能性非常低。

**利用方式：**
攻击者通过构造包含恶意模板代码的HTTP请求，将其发送到存在漏洞的Rejetto HFS服务器。服务器在处理该请求时，会将恶意模板代码解析并执行，从而导致任意代码执行。从Metasploit模块的使用方式可以看出，攻击者可以利用这个漏洞直接获取Meterpreter会话。

**参考：**
*   漏洞库信息
*   搜索引擎结果
*   漏洞利用代码（Metasploit模块README）

**项目地址:** [pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692](https://github.com/pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #12

**来源**: [CVE-2024-23692-vanboomqi_CVE-2024-23692.md](../2024/CVE-2024-23692-vanboomqi_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未授权的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行 Rejetto HFS 2.3m 且网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。根据提供的漏洞利用代码，攻击者通过构造特定的 URL，在URL中嵌入恶意命令，由于程序没有充分过滤模板注入，导致命令在服务器端执行。 

**有效性：**
提供的 POC 代码看起来是有效的。它构造了一个包含恶意命令的 HTTP GET 请求，并使用 `http.client` 库发送请求。代码还包含对响应进行 gzip 解压缩以及检测字符编码的功能，提高了在不同环境下的适应性。代码还实现了重试机制以应对间歇性连接问题。

**投毒风险：**
该漏洞利用代码的投毒风险较低。`LICENSE` 文件表明代码遵循 MIT 许可协议，允许自由使用和修改。`exploit.py` 脚本的主要功能是利用漏洞，没有发现明显的恶意代码。尽管如此，始终建议审查任何第三方代码以确保安全。

**利用方式：**
1.  **漏洞定位：**  该漏洞存在于 Rejetto HTTP File Server 的模板处理功能中。
2.  **攻击向量：**  攻击者通过构造包含恶意代码的 HTTP 请求，特别是 URL 中的参数，来触发模板注入。
3.  **命令执行：**  恶意代码被服务器解析并执行，导致远程命令执行。
4.  **响应处理：**  攻击者通过检查服务器的响应来判断漏洞是否利用成功，并获取命令执行的结果。

**项目地址:** [vanboomqi/CVE-2024-23692](https://github.com/vanboomqi/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #13

**来源**: [CVE-2024-23692-verylazytech_CVE-2024-23692.md](../2024/CVE-2024-23692-verylazytech_CVE-2024-23692.md)

## CVE-2024-23692 Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令。

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HTTP File Server 2.3m，且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出存在私有漏洞利用，搜索结果中也包含了利用该漏洞的攻击案例和检测规则。提供的POC代码也证明了可以执行任意命令。

**投毒风险：**
分析提供的POC代码(`/tmp/39e8ac14437cd2343ad255450790e37a/CVE-2024-23692.sh`)，主要功能是构造并发送包含恶意命令的HTTP请求，并解析响应结果。代码中使用了`iconv`和`base64`对命令进行编码，以绕过可能的过滤。代码的目的是利用模板注入漏洞执行系统命令，没有发现明显的恶意投毒代码。LICENSE文件也声明了是MIT开源协议，作者是允许对代码进行修改的。但是, 鉴于任何从互联网下载的代码都存在潜在风险，因此应该谨慎使用，并在受控环境中进行测试，以及对代码进行审查。

**利用方式：**
利用方式是通过向目标 Rejetto HTTP File Server 发送特制的 HTTP GET 请求。这个请求的 `n` 参数和 `cmd` 参数包含经过编码的恶意命令。服务器会解析这些参数，并通过模板注入漏洞执行命令。POC代码中的关键步骤如下：

1.  构造包含命令的payload，使用powershell执行命令。
2.  使用`iconv -t UTF-16LE` 将命令转换为UTF-16LE编码，防止乱码。
3.  使用 `base64 -w 0` 对UTF-16LE编码后的命令进行Base64编码。
4.  构造完整的URL，包含服务器地址和payload。
5.  使用 `curl` 发送请求。
6.  从响应中提取命令执行结果，提取开始和结束标识符`[S]`之间的内容。
7.  输出提取到的命令执行结果。

综上所述，该漏洞利用有效，但使用时应注意潜在风险。

**项目地址:** [verylazytech/CVE-2024-23692](https://github.com/verylazytech/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---



---

## POC #3

**来源**: [CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md](../2024/CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server Template Injection RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行存在漏洞的Rejetto HFS，并能通过网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在服务器上执行任意命令。由于Rejetto HFS已经停止维护，无法通过官方补丁修复此漏洞。

**有效性分析：**
提供的POC代码（hfs.go）利用了该模板注入漏洞，允许攻击者执行命令、执行DNSLog检测等操作。

**投毒风险分析：**
检查了提供的代码仓库，没有发现明显的恶意代码，但是存在以下几点潜在的投毒风险：
1.  **DNSLog配置：** 默认使用ceye.io，如果ceye.io被恶意利用，可能会导致信息泄露。
2.  **代码依赖：** 依赖gopkg.in/ini.v1，此依赖如果存在漏洞，可能会被利用。
3.  **命令执行：** 命令执行本身就存在风险，如果目标系统权限过高，可能会导致严重的安全问题。
4.  **网络请求：** 攻击代码中会发出网络请求，具有一定的流量特征，可以分析网络流量判断是否存在恶意行为。
因此，整体投毒的概率较低，估计为5%。

**利用方式：**
1.  攻击者首先需要确定目标系统运行的是存在漏洞的Rejetto HFS 2.3m。
2.  攻击者可以利用POC代码，通过`-u`参数指定目标URL。
3.  可以使用`-cmd`参数进入命令行模式，执行任意命令。 例如: `go run hfs.go -u http://127.0.0.1 -cmd`。
4.  可以使用`-dns`参数进行DNSLog检测，验证漏洞是否存在。 例如: `go run hfs.go -u http://127.0.0.1 -dns` 或者 `go run hfs.go -u http://127.0.0.1 -dns -d abc.cn`。
5.  如果需要使用代理，可以通过`-p`参数指定代理服务器地址。 例如: `go run hfs.go -u http://127.0.0.1 -cmd -p http://user:pass@127.0.0.1:8080`。

**缓解措施：**
由于Rejetto HFS已经停止维护，建议用户停止使用该软件，并迁移到其他安全的文件服务器软件。

**项目地址:** [BBD-YZZ/CVE-2024-23692](https://github.com/BBD-YZZ/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #4

**来源**: [CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md](../2024/CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行受影响版本的 Rejetto HFS，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。攻击者可以通过构造特定的 HTTP 请求，在服务器上执行任意命令。\n\n**有效性：**\n提供的 PoC 代码 `CVE-2024-23692.sh` 似乎有效。它构造一个包含恶意模板注入的 HTTP GET 请求，利用 `nc` (netcat) 发送到目标服务器，然后显示响应。脚本接受目标 IP 地址、端口和要执行的命令作为参数。 README.md 文件也提供了使用示例，表明可以执行系统命令或部署反向 shell。\n\n**投毒风险：**\n评估投毒风险时，需要考虑以下几点：\n1.  **代码来源：** 代码来自非官方渠道（GitHub 上的个人仓库）。虽然该漏洞本身是真实存在的，但脚本可能包含恶意代码。\n2.  **脚本功能：** 脚本使用 `nc` 工具发送构造的 HTTP 请求。恶意代码可能被隐藏在构造的请求本身（例如，试图下载和执行其他恶意程序），或者在利用成功后执行其他操作。\n3.  **代码审查：** 快速审查脚本发现其核心功能是利用漏洞。投毒代码可能存在于不明显之处，例如对命令执行结果的篡改或者植入后门。\n4.  **网络行为：** 脚本中使用了`nc`，正常使用是发送恶意请求，如果存在其他网络连接行为，需要特别关注\n\n基于上述分析，认为存在10%的投毒风险。风险主要来自于脚本可能尝试利用漏洞植入后门或者执行其他恶意活动。\n\n**利用方式：**\n1.  **构造恶意 HTTP 请求：** PoC 脚本构造一个带有精心设计的查询字符串的 HTTP GET 请求。该查询字符串包含一个模板注入，允许执行服务器端代码。关键参数是 `cmd`，它包含要执行的命令。\n2.  **发送请求：** 脚本使用 `nc` 工具将构造的 HTTP 请求发送到目标服务器。\n3.  **执行命令：** 如果服务器存在漏洞，它将解析并执行注入的模板，从而执行 `cmd` 参数中指定的命令。\n4.  **获取结果：** 服务器的响应包含命令执行的结果。PoC 脚本捕获并显示此响应。

**项目地址:** [Mr-r00t11/CVE-2024-23692](https://github.com/Mr-r00t11/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #5

**来源**: [CVE-2024-23692-NingXin2002_HFS2.3_poc.md](../2024/CVE-2024-23692-NingXin2002_HFS2.3_poc.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程、未经身份验证的攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标服务器运行Rejetto HTTP File Server 2.3m或更早版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的一个模板注入漏洞。攻击者可以通过发送特制的HTTP请求，利用模板引擎的漏洞执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响所有2.3m及以下版本。PoC代码通过构造包含恶意代码的URL，发送到目标服务器。URL中的`cmd=whoami`部分展示了执行命令的能力。虽然PoC主要功能是验证漏洞，但需要人工审查和小心使用以防止潜在的恶意利用. 

**有效性：** 根据漏洞库信息，搜索引擎结果和POC代码，可以确定该POC代码有效。 多个信息源都表明可以通过特制的HTTP请求执行任意命令。

**投毒风险：** 该仓库的投毒风险较低，估计为10%。主要原因：

1.  **PoC的直接性：** PoC的主要目的是验证漏洞的存在，而不是植入后门。代码功能相对简单，直接发送包含命令的HTTP请求。
2.  **命令执行：** PoC中使用的`whoami`命令用于验证，但如果将命令替换为例如下载并执行恶意脚本的命令，则可能存在风险。
3.  **依赖性：** 该PoC只依赖于requests库，没有使用其他的隐蔽的第三方依赖，降低了引入恶意代码的风险。

**利用方式：** 漏洞利用方式如下：

1.  **确定目标：** 确定目标服务器上运行着存在漏洞的Rejetto HTTP File Server版本（<=2.3m）。
2.  **构造恶意URL：**  使用类似PoC中的URL，将`cmd=whoami`替换为需要执行的系统命令。
3.  **发送HTTP请求：**  通过GET请求将构造的URL发送到目标服务器。
4.  **执行命令：**  目标服务器执行URL中指定的命令。

**项目地址:** [NingXin2002/HFS2.3_poc](https://github.com/NingXin2002/HFS2.3_poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #6

**来源**: [CVE-2024-23692-Tupler_CVE-2024-23692-exp.md](../2024/CVE-2024-23692-Tupler_CVE-2024-23692-exp.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m (实际影响到2.4 RC7)

**利用条件:** 目标服务器运行存在漏洞的 Rejetto HFS 服务，攻击者能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 2.3m 及更早版本（实际影响到 2.4 RC7）中的一个模板注入漏洞。此漏洞允许未经身份验证的远程攻击者通过发送特制的 HTTP 请求在受影响的系统上执行任意命令。

**有效性:**
提供的 Python POC 代码 `CVE-2024-23692.py` 看起来有效。代码首先建立与目标服务器的 TCP 连接。 然后它接收用户输入的命令,将其进行 URL 编码，并将其嵌入到一个精心构造的 HTTP GET 请求中。 该请求利用模板注入漏洞在服务器端执行命令。服务器的响应被解析，提取命令执行的结果并打印给用户。代码通过对返回内容进行正则匹配提取执行结果，并避免直接输出所有返回内容来降低风险。

**投毒风险:**
对提供的 POC 代码 `CVE-2024-23692.py` 和 `README.md` 进行分析后，未发现明显的恶意代码或投毒迹象。 代码的功能符合漏洞利用的预期行为，没有发现尝试执行与漏洞利用无关的恶意操作的代码。

**利用方式:**
1.  **目标确认:** 确定目标服务器上运行着易受攻击的 Rejetto HFS 版本 (<= 2.3m, 实际影响到 2.4 RC7).
2.  **构造Payload:** 构造包含恶意命令的 HTTP GET 请求。 POC代码中cmd参数即是需要执行的命令,该命令会被进行URL编码后插入请求中。
3.  **发送请求:** 将构造的 HTTP 请求发送到目标服务器。
4.  **执行命令:** HFS 处理请求时，会执行注入的命令。 `{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`这部分是payload的关键。 {.exec}调用执行外部命令, {.?cmd.}是用户可控的命令，timeout=15限制超时时间，out=abc.将输出重定向到文件abc.，RESULT和====用于标记输出结果，方便提取。
5.  **获取结果:**  从服务器的响应中提取命令执行的结果。POC代码中对返回内容进行正则匹配，提取RESULT和====之间的内容。

**结论:**
该漏洞利用是有效的，并且能够实现远程代码执行。提供的代码中未发现投毒风险。 通过构造特定的请求，攻击者可以在目标系统上执行任意命令，导致严重的安全风险。 根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [Tupler/CVE-2024-23692-exp](https://github.com/Tupler/CVE-2024-23692-exp)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #7

**来源**: [CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md](../2024/CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md)

## CVE-2024-23692-Rejetto HFS 2.3m 远程命令执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程命令执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行受影响版本的Rejetto HTTP File Server，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意命令。利用方式如下：

1.  **漏洞描述：** 漏洞位于服务器处理模板的环节，攻击者通过构造恶意输入，将命令注入到模板中，由服务器执行。
2.  **漏洞利用方式：** 攻击者发送包含恶意模板代码的HTTP GET请求，服务器解析该请求时，会将恶意代码作为命令执行。
3.  **POC分析：** 提供的Go代码通过`zmap`扫描指定端口，然后使用HTTP GET请求，通过在URL中拼接经过编码的恶意命令来利用漏洞。POC首先检测目标是否为HFS服务，如果是则执行预定义的命令，例如 `ping wlccwlc.dnslog.cn` 和 `whoami`。
4.  **投毒风险分析：** 风险较低。主要风险来自以下几点：
    *   POC中执行的命令可以被修改，攻击者可以利用该POC执行任意恶意命令。
    *   `hfs.go`本身没有发现明显的投毒代码。代码逻辑相对清晰，主要功能是发送HTTP请求并处理响应。
    *   `README.md`文件中包含TG链接，存在一定的恶意引流风险，诱导用户加入恶意社群。

**项目地址:** [WanLiChangChengWanLiChang/CVE-2024-23692-RCE](https://github.com/WanLiChangChengWanLiChang/CVE-2024-23692-RCE)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #8

**来源**: [CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md](../2024/CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要网络访问 Rejetto HFS 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在目标系统上执行任意命令，无需身份验证。漏洞利用方式为通过构造包含恶意代码的HTTP请求，利用HFS模板引擎的缺陷执行命令。提供的代码段只是 Apache License 2.0 的许可证文本，本身不包含任何漏洞利用代码，因此无法评估其有效性。根据搜索结果，该漏洞已经有公开的利用方法，并且Metasploit中已经有相关的利用模块。由于提供的代码只是许可证，所以其中不存在投毒代码的风险。漏洞利用的关键在于构造恶意的HTTP请求，请求中包含可以被HFS服务器解释执行的模板注入代码。从CISA已收录该漏洞的情况来看，此漏洞非常活跃，请尽快进行修复。

**项目地址:** [XiaomingX/cve-2024-23692-poc](https://github.com/XiaomingX/cve-2024-23692-poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #9

**来源**: [CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md](../2024/CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入/远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，允许未授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HFS 2.3m，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中的一个模板注入漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求来执行任意命令。漏洞利用代码通过构造包含恶意payload的GET请求，该payload利用模板引擎的特性执行操作系统命令。payload的形式为 `/?search=%25x%25url%25:%host%}{.exec|cmd.}{.break.}`，其中`cmd`是要执行的命令。检测脚本使用相同的payload，但只是验证服务是否返回200 OK，表明存在漏洞。

**有效性：** 根据漏洞描述、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码很可能是有效的。漏洞信息明确指出存在远程代码执行漏洞，搜索引擎结果证实了这一点，漏洞利用代码也实现了构造恶意请求并执行命令的功能。

**投毒风险：** 提供的代码主要是利用漏洞执行命令，并没有发现明显的恶意代码。但仍然存在微小的风险：

*   **依赖风险：** 代码使用了标准库如socket和sys，风险较低。
*   **命令执行风险：** `cmd`参数由用户提供，如果用户不小心执行了恶意命令，可能会导致问题。但是，这不是代码本身的投毒，而是用户使用不当造成的。
*   **网络连接风险：** 虽然有超时设置，但如果目标服务器被攻陷，可能被用于DDoS等攻击。

考虑到以上因素，投毒风险评估为5%。

**利用方式：**

1.  **确定目标：** 找到运行Rejetto HTTP File Server 2.3m的目标IP地址和端口。
2.  **构造恶意请求：** 使用提供的exploit.py脚本，指定目标IP地址、端口以及要执行的命令。
3.  **发送请求：** 脚本将构造包含恶意payload的HTTP GET请求，并发送到目标服务器。
4.  **执行命令：** 如果目标服务器存在漏洞，服务器将执行payload中的命令。
5.  **验证结果：** 脚本会打印服务器的响应。如果返回“200 OK”，则表示漏洞利用可能成功。弹出计算器或者其他命令执行的反馈需要根据具体环境判断。

**项目地址:** [jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS](https://github.com/jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #10

**来源**: [CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md](../2024/CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行Rejetto HFS 2.3m，且攻击者可以发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的HTTP请求来执行任意命令。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被广泛确认存在并且有公开的PoC。提供的PoC代码（CVE-2024-23692.py）尝试利用该漏洞，发送包含恶意模板注入payload的HTTP GET请求，如果服务器存在漏洞，将执行`ipconfig /all` 命令 (windows系统)或者 `systeminfo` 命令。PoC通过检查响应文本中“RESULT”字符串的出现次数来判断漏洞是否存在。 Burp Suite的POC也验证了此漏洞. 因此，PoC代码是有效的。

**投毒风险分析：**

查看提供的python POC代码，没有发现任何恶意代码，例如反弹shell或下载执行其他文件的行为。也没有发现任何试图修改本地文件或窃取敏感信息的代码。PoC脚本功能相对简单，主要用于验证目标是否存在漏洞。 `README.md` 文件中仅包含 HTTP 请求的 PoC 示例和截图，没有发现潜在的投毒代码。综合判断，该仓库中存在作者隐藏的投毒代码的可能性极低。因此，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** 漏洞出现在HFS处理模板时，没有对用户输入进行充分的过滤和转义，导致攻击者可以通过构造恶意的模板代码来执行任意命令。
2.  **攻击方式：** 攻击者通过发送包含特定payload的HTTP请求到目标服务器。
3.  **Payload构造：** PoC中使用的payload是`/?s=%0A&cmd=ipconfig+/all&search=%25xxx%25url:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`。该payload利用了HFS的模板引擎，`{.exec|{.?cmd.}`部分会执行`cmd`参数指定的命令，并将结果输出。
4.  **命令执行：**  服务器在解析该请求时，会执行`cmd`参数指定的命令（例如 `ipconfig /all`），并将命令执行的结果嵌入到响应中返回给攻击者。
5.  **漏洞验证：**  PoC通过检查响应中特定字符串（例如 `RESULT`）的出现次数来判断漏洞是否存在。

**项目地址:** [k3lpi3b4nsh33/CVE-2024-23692](https://github.com/k3lpi3b4nsh33/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #11

**来源**: [CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md](../2024/CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入 (SSTI)

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程未授权代码执行

**影响版本:** <= 2.3m, 2.4.0 RC7 (测试版本)

**利用条件:** 目标系统运行受影响版本的Rejetto HFS，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 中存在的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。

**有效性：**
根据提供的 Metasploit 模块的 README 文件以及漏洞库信息，该漏洞的 POC 代码是有效的。该 POC 已经在 2.4.0 RC7 和 2.3m 版本上进行了测试，并且成功地执行了远程代码。

**投毒风险：**
提供的代码片段主要是一个 Metasploit 模块的 README，展示了如何使用该模块进行漏洞利用。它包含设置 RHOSTS、RPORT、LHOST 和 LPORT 等参数的示例，以及如何执行 check 和 exploit 命令。由于该代码只是一个使用说明，并且Metasploit是可信的项目，因此，投毒的可能性非常低。

**利用方式：**
攻击者通过构造包含恶意模板代码的HTTP请求，将其发送到存在漏洞的Rejetto HFS服务器。服务器在处理该请求时，会将恶意模板代码解析并执行，从而导致任意代码执行。从Metasploit模块的使用方式可以看出，攻击者可以利用这个漏洞直接获取Meterpreter会话。

**参考：**
*   漏洞库信息
*   搜索引擎结果
*   漏洞利用代码（Metasploit模块README）

**项目地址:** [pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692](https://github.com/pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #12

**来源**: [CVE-2024-23692-vanboomqi_CVE-2024-23692.md](../2024/CVE-2024-23692-vanboomqi_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未授权的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行 Rejetto HFS 2.3m 且网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。根据提供的漏洞利用代码，攻击者通过构造特定的 URL，在URL中嵌入恶意命令，由于程序没有充分过滤模板注入，导致命令在服务器端执行。 

**有效性：**
提供的 POC 代码看起来是有效的。它构造了一个包含恶意命令的 HTTP GET 请求，并使用 `http.client` 库发送请求。代码还包含对响应进行 gzip 解压缩以及检测字符编码的功能，提高了在不同环境下的适应性。代码还实现了重试机制以应对间歇性连接问题。

**投毒风险：**
该漏洞利用代码的投毒风险较低。`LICENSE` 文件表明代码遵循 MIT 许可协议，允许自由使用和修改。`exploit.py` 脚本的主要功能是利用漏洞，没有发现明显的恶意代码。尽管如此，始终建议审查任何第三方代码以确保安全。

**利用方式：**
1.  **漏洞定位：**  该漏洞存在于 Rejetto HTTP File Server 的模板处理功能中。
2.  **攻击向量：**  攻击者通过构造包含恶意代码的 HTTP 请求，特别是 URL 中的参数，来触发模板注入。
3.  **命令执行：**  恶意代码被服务器解析并执行，导致远程命令执行。
4.  **响应处理：**  攻击者通过检查服务器的响应来判断漏洞是否利用成功，并获取命令执行的结果。

**项目地址:** [vanboomqi/CVE-2024-23692](https://github.com/vanboomqi/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #13

**来源**: [CVE-2024-23692-verylazytech_CVE-2024-23692.md](../2024/CVE-2024-23692-verylazytech_CVE-2024-23692.md)

## CVE-2024-23692 Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令。

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HTTP File Server 2.3m，且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出存在私有漏洞利用，搜索结果中也包含了利用该漏洞的攻击案例和检测规则。提供的POC代码也证明了可以执行任意命令。

**投毒风险：**
分析提供的POC代码(`/tmp/39e8ac14437cd2343ad255450790e37a/CVE-2024-23692.sh`)，主要功能是构造并发送包含恶意命令的HTTP请求，并解析响应结果。代码中使用了`iconv`和`base64`对命令进行编码，以绕过可能的过滤。代码的目的是利用模板注入漏洞执行系统命令，没有发现明显的恶意投毒代码。LICENSE文件也声明了是MIT开源协议，作者是允许对代码进行修改的。但是, 鉴于任何从互联网下载的代码都存在潜在风险，因此应该谨慎使用，并在受控环境中进行测试，以及对代码进行审查。

**利用方式：**
利用方式是通过向目标 Rejetto HTTP File Server 发送特制的 HTTP GET 请求。这个请求的 `n` 参数和 `cmd` 参数包含经过编码的恶意命令。服务器会解析这些参数，并通过模板注入漏洞执行命令。POC代码中的关键步骤如下：

1.  构造包含命令的payload，使用powershell执行命令。
2.  使用`iconv -t UTF-16LE` 将命令转换为UTF-16LE编码，防止乱码。
3.  使用 `base64 -w 0` 对UTF-16LE编码后的命令进行Base64编码。
4.  构造完整的URL，包含服务器地址和payload。
5.  使用 `curl` 发送请求。
6.  从响应中提取命令执行结果，提取开始和结束标识符`[S]`之间的内容。
7.  输出提取到的命令执行结果。

综上所述，该漏洞利用有效，但使用时应注意潜在风险。

**项目地址:** [verylazytech/CVE-2024-23692](https://github.com/verylazytech/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---



---

## POC #3

**来源**: [CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md](../2024/CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server Template Injection RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行存在漏洞的Rejetto HFS，并能通过网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在服务器上执行任意命令。由于Rejetto HFS已经停止维护，无法通过官方补丁修复此漏洞。

**有效性分析：**
提供的POC代码（hfs.go）利用了该模板注入漏洞，允许攻击者执行命令、执行DNSLog检测等操作。

**投毒风险分析：**
检查了提供的代码仓库，没有发现明显的恶意代码，但是存在以下几点潜在的投毒风险：
1.  **DNSLog配置：** 默认使用ceye.io，如果ceye.io被恶意利用，可能会导致信息泄露。
2.  **代码依赖：** 依赖gopkg.in/ini.v1，此依赖如果存在漏洞，可能会被利用。
3.  **命令执行：** 命令执行本身就存在风险，如果目标系统权限过高，可能会导致严重的安全问题。
4.  **网络请求：** 攻击代码中会发出网络请求，具有一定的流量特征，可以分析网络流量判断是否存在恶意行为。
因此，整体投毒的概率较低，估计为5%。

**利用方式：**
1.  攻击者首先需要确定目标系统运行的是存在漏洞的Rejetto HFS 2.3m。
2.  攻击者可以利用POC代码，通过`-u`参数指定目标URL。
3.  可以使用`-cmd`参数进入命令行模式，执行任意命令。 例如: `go run hfs.go -u http://127.0.0.1 -cmd`。
4.  可以使用`-dns`参数进行DNSLog检测，验证漏洞是否存在。 例如: `go run hfs.go -u http://127.0.0.1 -dns` 或者 `go run hfs.go -u http://127.0.0.1 -dns -d abc.cn`。
5.  如果需要使用代理，可以通过`-p`参数指定代理服务器地址。 例如: `go run hfs.go -u http://127.0.0.1 -cmd -p http://user:pass@127.0.0.1:8080`。

**缓解措施：**
由于Rejetto HFS已经停止维护，建议用户停止使用该软件，并迁移到其他安全的文件服务器软件。

**项目地址:** [BBD-YZZ/CVE-2024-23692](https://github.com/BBD-YZZ/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #4

**来源**: [CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md](../2024/CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行受影响版本的 Rejetto HFS，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。攻击者可以通过构造特定的 HTTP 请求，在服务器上执行任意命令。\n\n**有效性：**\n提供的 PoC 代码 `CVE-2024-23692.sh` 似乎有效。它构造一个包含恶意模板注入的 HTTP GET 请求，利用 `nc` (netcat) 发送到目标服务器，然后显示响应。脚本接受目标 IP 地址、端口和要执行的命令作为参数。 README.md 文件也提供了使用示例，表明可以执行系统命令或部署反向 shell。\n\n**投毒风险：**\n评估投毒风险时，需要考虑以下几点：\n1.  **代码来源：** 代码来自非官方渠道（GitHub 上的个人仓库）。虽然该漏洞本身是真实存在的，但脚本可能包含恶意代码。\n2.  **脚本功能：** 脚本使用 `nc` 工具发送构造的 HTTP 请求。恶意代码可能被隐藏在构造的请求本身（例如，试图下载和执行其他恶意程序），或者在利用成功后执行其他操作。\n3.  **代码审查：** 快速审查脚本发现其核心功能是利用漏洞。投毒代码可能存在于不明显之处，例如对命令执行结果的篡改或者植入后门。\n4.  **网络行为：** 脚本中使用了`nc`，正常使用是发送恶意请求，如果存在其他网络连接行为，需要特别关注\n\n基于上述分析，认为存在10%的投毒风险。风险主要来自于脚本可能尝试利用漏洞植入后门或者执行其他恶意活动。\n\n**利用方式：**\n1.  **构造恶意 HTTP 请求：** PoC 脚本构造一个带有精心设计的查询字符串的 HTTP GET 请求。该查询字符串包含一个模板注入，允许执行服务器端代码。关键参数是 `cmd`，它包含要执行的命令。\n2.  **发送请求：** 脚本使用 `nc` 工具将构造的 HTTP 请求发送到目标服务器。\n3.  **执行命令：** 如果服务器存在漏洞，它将解析并执行注入的模板，从而执行 `cmd` 参数中指定的命令。\n4.  **获取结果：** 服务器的响应包含命令执行的结果。PoC 脚本捕获并显示此响应。

**项目地址:** [Mr-r00t11/CVE-2024-23692](https://github.com/Mr-r00t11/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #5

**来源**: [CVE-2024-23692-NingXin2002_HFS2.3_poc.md](../2024/CVE-2024-23692-NingXin2002_HFS2.3_poc.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程、未经身份验证的攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标服务器运行Rejetto HTTP File Server 2.3m或更早版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的一个模板注入漏洞。攻击者可以通过发送特制的HTTP请求，利用模板引擎的漏洞执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响所有2.3m及以下版本。PoC代码通过构造包含恶意代码的URL，发送到目标服务器。URL中的`cmd=whoami`部分展示了执行命令的能力。虽然PoC主要功能是验证漏洞，但需要人工审查和小心使用以防止潜在的恶意利用. 

**有效性：** 根据漏洞库信息，搜索引擎结果和POC代码，可以确定该POC代码有效。 多个信息源都表明可以通过特制的HTTP请求执行任意命令。

**投毒风险：** 该仓库的投毒风险较低，估计为10%。主要原因：

1.  **PoC的直接性：** PoC的主要目的是验证漏洞的存在，而不是植入后门。代码功能相对简单，直接发送包含命令的HTTP请求。
2.  **命令执行：** PoC中使用的`whoami`命令用于验证，但如果将命令替换为例如下载并执行恶意脚本的命令，则可能存在风险。
3.  **依赖性：** 该PoC只依赖于requests库，没有使用其他的隐蔽的第三方依赖，降低了引入恶意代码的风险。

**利用方式：** 漏洞利用方式如下：

1.  **确定目标：** 确定目标服务器上运行着存在漏洞的Rejetto HTTP File Server版本（<=2.3m）。
2.  **构造恶意URL：**  使用类似PoC中的URL，将`cmd=whoami`替换为需要执行的系统命令。
3.  **发送HTTP请求：**  通过GET请求将构造的URL发送到目标服务器。
4.  **执行命令：**  目标服务器执行URL中指定的命令。

**项目地址:** [NingXin2002/HFS2.3_poc](https://github.com/NingXin2002/HFS2.3_poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #6

**来源**: [CVE-2024-23692-Tupler_CVE-2024-23692-exp.md](../2024/CVE-2024-23692-Tupler_CVE-2024-23692-exp.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m (实际影响到2.4 RC7)

**利用条件:** 目标服务器运行存在漏洞的 Rejetto HFS 服务，攻击者能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 2.3m 及更早版本（实际影响到 2.4 RC7）中的一个模板注入漏洞。此漏洞允许未经身份验证的远程攻击者通过发送特制的 HTTP 请求在受影响的系统上执行任意命令。

**有效性:**
提供的 Python POC 代码 `CVE-2024-23692.py` 看起来有效。代码首先建立与目标服务器的 TCP 连接。 然后它接收用户输入的命令,将其进行 URL 编码，并将其嵌入到一个精心构造的 HTTP GET 请求中。 该请求利用模板注入漏洞在服务器端执行命令。服务器的响应被解析，提取命令执行的结果并打印给用户。代码通过对返回内容进行正则匹配提取执行结果，并避免直接输出所有返回内容来降低风险。

**投毒风险:**
对提供的 POC 代码 `CVE-2024-23692.py` 和 `README.md` 进行分析后，未发现明显的恶意代码或投毒迹象。 代码的功能符合漏洞利用的预期行为，没有发现尝试执行与漏洞利用无关的恶意操作的代码。

**利用方式:**
1.  **目标确认:** 确定目标服务器上运行着易受攻击的 Rejetto HFS 版本 (<= 2.3m, 实际影响到 2.4 RC7).
2.  **构造Payload:** 构造包含恶意命令的 HTTP GET 请求。 POC代码中cmd参数即是需要执行的命令,该命令会被进行URL编码后插入请求中。
3.  **发送请求:** 将构造的 HTTP 请求发送到目标服务器。
4.  **执行命令:** HFS 处理请求时，会执行注入的命令。 `{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`这部分是payload的关键。 {.exec}调用执行外部命令, {.?cmd.}是用户可控的命令，timeout=15限制超时时间，out=abc.将输出重定向到文件abc.，RESULT和====用于标记输出结果，方便提取。
5.  **获取结果:**  从服务器的响应中提取命令执行的结果。POC代码中对返回内容进行正则匹配，提取RESULT和====之间的内容。

**结论:**
该漏洞利用是有效的，并且能够实现远程代码执行。提供的代码中未发现投毒风险。 通过构造特定的请求，攻击者可以在目标系统上执行任意命令，导致严重的安全风险。 根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [Tupler/CVE-2024-23692-exp](https://github.com/Tupler/CVE-2024-23692-exp)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #7

**来源**: [CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md](../2024/CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md)

## CVE-2024-23692-Rejetto HFS 2.3m 远程命令执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程命令执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行受影响版本的Rejetto HTTP File Server，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意命令。利用方式如下：

1.  **漏洞描述：** 漏洞位于服务器处理模板的环节，攻击者通过构造恶意输入，将命令注入到模板中，由服务器执行。
2.  **漏洞利用方式：** 攻击者发送包含恶意模板代码的HTTP GET请求，服务器解析该请求时，会将恶意代码作为命令执行。
3.  **POC分析：** 提供的Go代码通过`zmap`扫描指定端口，然后使用HTTP GET请求，通过在URL中拼接经过编码的恶意命令来利用漏洞。POC首先检测目标是否为HFS服务，如果是则执行预定义的命令，例如 `ping wlccwlc.dnslog.cn` 和 `whoami`。
4.  **投毒风险分析：** 风险较低。主要风险来自以下几点：
    *   POC中执行的命令可以被修改，攻击者可以利用该POC执行任意恶意命令。
    *   `hfs.go`本身没有发现明显的投毒代码。代码逻辑相对清晰，主要功能是发送HTTP请求并处理响应。
    *   `README.md`文件中包含TG链接，存在一定的恶意引流风险，诱导用户加入恶意社群。

**项目地址:** [WanLiChangChengWanLiChang/CVE-2024-23692-RCE](https://github.com/WanLiChangChengWanLiChang/CVE-2024-23692-RCE)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #8

**来源**: [CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md](../2024/CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要网络访问 Rejetto HFS 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在目标系统上执行任意命令，无需身份验证。漏洞利用方式为通过构造包含恶意代码的HTTP请求，利用HFS模板引擎的缺陷执行命令。提供的代码段只是 Apache License 2.0 的许可证文本，本身不包含任何漏洞利用代码，因此无法评估其有效性。根据搜索结果，该漏洞已经有公开的利用方法，并且Metasploit中已经有相关的利用模块。由于提供的代码只是许可证，所以其中不存在投毒代码的风险。漏洞利用的关键在于构造恶意的HTTP请求，请求中包含可以被HFS服务器解释执行的模板注入代码。从CISA已收录该漏洞的情况来看，此漏洞非常活跃，请尽快进行修复。

**项目地址:** [XiaomingX/cve-2024-23692-poc](https://github.com/XiaomingX/cve-2024-23692-poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #9

**来源**: [CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md](../2024/CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入/远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，允许未授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HFS 2.3m，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中的一个模板注入漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求来执行任意命令。漏洞利用代码通过构造包含恶意payload的GET请求，该payload利用模板引擎的特性执行操作系统命令。payload的形式为 `/?search=%25x%25url%25:%host%}{.exec|cmd.}{.break.}`，其中`cmd`是要执行的命令。检测脚本使用相同的payload，但只是验证服务是否返回200 OK，表明存在漏洞。

**有效性：** 根据漏洞描述、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码很可能是有效的。漏洞信息明确指出存在远程代码执行漏洞，搜索引擎结果证实了这一点，漏洞利用代码也实现了构造恶意请求并执行命令的功能。

**投毒风险：** 提供的代码主要是利用漏洞执行命令，并没有发现明显的恶意代码。但仍然存在微小的风险：

*   **依赖风险：** 代码使用了标准库如socket和sys，风险较低。
*   **命令执行风险：** `cmd`参数由用户提供，如果用户不小心执行了恶意命令，可能会导致问题。但是，这不是代码本身的投毒，而是用户使用不当造成的。
*   **网络连接风险：** 虽然有超时设置，但如果目标服务器被攻陷，可能被用于DDoS等攻击。

考虑到以上因素，投毒风险评估为5%。

**利用方式：**

1.  **确定目标：** 找到运行Rejetto HTTP File Server 2.3m的目标IP地址和端口。
2.  **构造恶意请求：** 使用提供的exploit.py脚本，指定目标IP地址、端口以及要执行的命令。
3.  **发送请求：** 脚本将构造包含恶意payload的HTTP GET请求，并发送到目标服务器。
4.  **执行命令：** 如果目标服务器存在漏洞，服务器将执行payload中的命令。
5.  **验证结果：** 脚本会打印服务器的响应。如果返回“200 OK”，则表示漏洞利用可能成功。弹出计算器或者其他命令执行的反馈需要根据具体环境判断。

**项目地址:** [jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS](https://github.com/jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #10

**来源**: [CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md](../2024/CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行Rejetto HFS 2.3m，且攻击者可以发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的HTTP请求来执行任意命令。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被广泛确认存在并且有公开的PoC。提供的PoC代码（CVE-2024-23692.py）尝试利用该漏洞，发送包含恶意模板注入payload的HTTP GET请求，如果服务器存在漏洞，将执行`ipconfig /all` 命令 (windows系统)或者 `systeminfo` 命令。PoC通过检查响应文本中“RESULT”字符串的出现次数来判断漏洞是否存在。 Burp Suite的POC也验证了此漏洞. 因此，PoC代码是有效的。

**投毒风险分析：**

查看提供的python POC代码，没有发现任何恶意代码，例如反弹shell或下载执行其他文件的行为。也没有发现任何试图修改本地文件或窃取敏感信息的代码。PoC脚本功能相对简单，主要用于验证目标是否存在漏洞。 `README.md` 文件中仅包含 HTTP 请求的 PoC 示例和截图，没有发现潜在的投毒代码。综合判断，该仓库中存在作者隐藏的投毒代码的可能性极低。因此，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** 漏洞出现在HFS处理模板时，没有对用户输入进行充分的过滤和转义，导致攻击者可以通过构造恶意的模板代码来执行任意命令。
2.  **攻击方式：** 攻击者通过发送包含特定payload的HTTP请求到目标服务器。
3.  **Payload构造：** PoC中使用的payload是`/?s=%0A&cmd=ipconfig+/all&search=%25xxx%25url:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`。该payload利用了HFS的模板引擎，`{.exec|{.?cmd.}`部分会执行`cmd`参数指定的命令，并将结果输出。
4.  **命令执行：**  服务器在解析该请求时，会执行`cmd`参数指定的命令（例如 `ipconfig /all`），并将命令执行的结果嵌入到响应中返回给攻击者。
5.  **漏洞验证：**  PoC通过检查响应中特定字符串（例如 `RESULT`）的出现次数来判断漏洞是否存在。

**项目地址:** [k3lpi3b4nsh33/CVE-2024-23692](https://github.com/k3lpi3b4nsh33/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #11

**来源**: [CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md](../2024/CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入 (SSTI)

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程未授权代码执行

**影响版本:** <= 2.3m, 2.4.0 RC7 (测试版本)

**利用条件:** 目标系统运行受影响版本的Rejetto HFS，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 中存在的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。

**有效性：**
根据提供的 Metasploit 模块的 README 文件以及漏洞库信息，该漏洞的 POC 代码是有效的。该 POC 已经在 2.4.0 RC7 和 2.3m 版本上进行了测试，并且成功地执行了远程代码。

**投毒风险：**
提供的代码片段主要是一个 Metasploit 模块的 README，展示了如何使用该模块进行漏洞利用。它包含设置 RHOSTS、RPORT、LHOST 和 LPORT 等参数的示例，以及如何执行 check 和 exploit 命令。由于该代码只是一个使用说明，并且Metasploit是可信的项目，因此，投毒的可能性非常低。

**利用方式：**
攻击者通过构造包含恶意模板代码的HTTP请求，将其发送到存在漏洞的Rejetto HFS服务器。服务器在处理该请求时，会将恶意模板代码解析并执行，从而导致任意代码执行。从Metasploit模块的使用方式可以看出，攻击者可以利用这个漏洞直接获取Meterpreter会话。

**参考：**
*   漏洞库信息
*   搜索引擎结果
*   漏洞利用代码（Metasploit模块README）

**项目地址:** [pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692](https://github.com/pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #12

**来源**: [CVE-2024-23692-vanboomqi_CVE-2024-23692.md](../2024/CVE-2024-23692-vanboomqi_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未授权的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行 Rejetto HFS 2.3m 且网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。根据提供的漏洞利用代码，攻击者通过构造特定的 URL，在URL中嵌入恶意命令，由于程序没有充分过滤模板注入，导致命令在服务器端执行。 

**有效性：**
提供的 POC 代码看起来是有效的。它构造了一个包含恶意命令的 HTTP GET 请求，并使用 `http.client` 库发送请求。代码还包含对响应进行 gzip 解压缩以及检测字符编码的功能，提高了在不同环境下的适应性。代码还实现了重试机制以应对间歇性连接问题。

**投毒风险：**
该漏洞利用代码的投毒风险较低。`LICENSE` 文件表明代码遵循 MIT 许可协议，允许自由使用和修改。`exploit.py` 脚本的主要功能是利用漏洞，没有发现明显的恶意代码。尽管如此，始终建议审查任何第三方代码以确保安全。

**利用方式：**
1.  **漏洞定位：**  该漏洞存在于 Rejetto HTTP File Server 的模板处理功能中。
2.  **攻击向量：**  攻击者通过构造包含恶意代码的 HTTP 请求，特别是 URL 中的参数，来触发模板注入。
3.  **命令执行：**  恶意代码被服务器解析并执行，导致远程命令执行。
4.  **响应处理：**  攻击者通过检查服务器的响应来判断漏洞是否利用成功，并获取命令执行的结果。

**项目地址:** [vanboomqi/CVE-2024-23692](https://github.com/vanboomqi/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #13

**来源**: [CVE-2024-23692-verylazytech_CVE-2024-23692.md](../2024/CVE-2024-23692-verylazytech_CVE-2024-23692.md)

## CVE-2024-23692 Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令。

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HTTP File Server 2.3m，且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出存在私有漏洞利用，搜索结果中也包含了利用该漏洞的攻击案例和检测规则。提供的POC代码也证明了可以执行任意命令。

**投毒风险：**
分析提供的POC代码(`/tmp/39e8ac14437cd2343ad255450790e37a/CVE-2024-23692.sh`)，主要功能是构造并发送包含恶意命令的HTTP请求，并解析响应结果。代码中使用了`iconv`和`base64`对命令进行编码，以绕过可能的过滤。代码的目的是利用模板注入漏洞执行系统命令，没有发现明显的恶意投毒代码。LICENSE文件也声明了是MIT开源协议，作者是允许对代码进行修改的。但是, 鉴于任何从互联网下载的代码都存在潜在风险，因此应该谨慎使用，并在受控环境中进行测试，以及对代码进行审查。

**利用方式：**
利用方式是通过向目标 Rejetto HTTP File Server 发送特制的 HTTP GET 请求。这个请求的 `n` 参数和 `cmd` 参数包含经过编码的恶意命令。服务器会解析这些参数，并通过模板注入漏洞执行命令。POC代码中的关键步骤如下：

1.  构造包含命令的payload，使用powershell执行命令。
2.  使用`iconv -t UTF-16LE` 将命令转换为UTF-16LE编码，防止乱码。
3.  使用 `base64 -w 0` 对UTF-16LE编码后的命令进行Base64编码。
4.  构造完整的URL，包含服务器地址和payload。
5.  使用 `curl` 发送请求。
6.  从响应中提取命令执行结果，提取开始和结束标识符`[S]`之间的内容。
7.  输出提取到的命令执行结果。

综上所述，该漏洞利用有效，但使用时应注意潜在风险。

**项目地址:** [verylazytech/CVE-2024-23692](https://github.com/verylazytech/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---



---

## POC #3

**来源**: [CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md](../2024/CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server Template Injection RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行存在漏洞的Rejetto HFS，并能通过网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在服务器上执行任意命令。由于Rejetto HFS已经停止维护，无法通过官方补丁修复此漏洞。

**有效性分析：**
提供的POC代码（hfs.go）利用了该模板注入漏洞，允许攻击者执行命令、执行DNSLog检测等操作。

**投毒风险分析：**
检查了提供的代码仓库，没有发现明显的恶意代码，但是存在以下几点潜在的投毒风险：
1.  **DNSLog配置：** 默认使用ceye.io，如果ceye.io被恶意利用，可能会导致信息泄露。
2.  **代码依赖：** 依赖gopkg.in/ini.v1，此依赖如果存在漏洞，可能会被利用。
3.  **命令执行：** 命令执行本身就存在风险，如果目标系统权限过高，可能会导致严重的安全问题。
4.  **网络请求：** 攻击代码中会发出网络请求，具有一定的流量特征，可以分析网络流量判断是否存在恶意行为。
因此，整体投毒的概率较低，估计为5%。

**利用方式：**
1.  攻击者首先需要确定目标系统运行的是存在漏洞的Rejetto HFS 2.3m。
2.  攻击者可以利用POC代码，通过`-u`参数指定目标URL。
3.  可以使用`-cmd`参数进入命令行模式，执行任意命令。 例如: `go run hfs.go -u http://127.0.0.1 -cmd`。
4.  可以使用`-dns`参数进行DNSLog检测，验证漏洞是否存在。 例如: `go run hfs.go -u http://127.0.0.1 -dns` 或者 `go run hfs.go -u http://127.0.0.1 -dns -d abc.cn`。
5.  如果需要使用代理，可以通过`-p`参数指定代理服务器地址。 例如: `go run hfs.go -u http://127.0.0.1 -cmd -p http://user:pass@127.0.0.1:8080`。

**缓解措施：**
由于Rejetto HFS已经停止维护，建议用户停止使用该软件，并迁移到其他安全的文件服务器软件。

**项目地址:** [BBD-YZZ/CVE-2024-23692](https://github.com/BBD-YZZ/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #4

**来源**: [CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md](../2024/CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行受影响版本的 Rejetto HFS，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。攻击者可以通过构造特定的 HTTP 请求，在服务器上执行任意命令。\n\n**有效性：**\n提供的 PoC 代码 `CVE-2024-23692.sh` 似乎有效。它构造一个包含恶意模板注入的 HTTP GET 请求，利用 `nc` (netcat) 发送到目标服务器，然后显示响应。脚本接受目标 IP 地址、端口和要执行的命令作为参数。 README.md 文件也提供了使用示例，表明可以执行系统命令或部署反向 shell。\n\n**投毒风险：**\n评估投毒风险时，需要考虑以下几点：\n1.  **代码来源：** 代码来自非官方渠道（GitHub 上的个人仓库）。虽然该漏洞本身是真实存在的，但脚本可能包含恶意代码。\n2.  **脚本功能：** 脚本使用 `nc` 工具发送构造的 HTTP 请求。恶意代码可能被隐藏在构造的请求本身（例如，试图下载和执行其他恶意程序），或者在利用成功后执行其他操作。\n3.  **代码审查：** 快速审查脚本发现其核心功能是利用漏洞。投毒代码可能存在于不明显之处，例如对命令执行结果的篡改或者植入后门。\n4.  **网络行为：** 脚本中使用了`nc`，正常使用是发送恶意请求，如果存在其他网络连接行为，需要特别关注\n\n基于上述分析，认为存在10%的投毒风险。风险主要来自于脚本可能尝试利用漏洞植入后门或者执行其他恶意活动。\n\n**利用方式：**\n1.  **构造恶意 HTTP 请求：** PoC 脚本构造一个带有精心设计的查询字符串的 HTTP GET 请求。该查询字符串包含一个模板注入，允许执行服务器端代码。关键参数是 `cmd`，它包含要执行的命令。\n2.  **发送请求：** 脚本使用 `nc` 工具将构造的 HTTP 请求发送到目标服务器。\n3.  **执行命令：** 如果服务器存在漏洞，它将解析并执行注入的模板，从而执行 `cmd` 参数中指定的命令。\n4.  **获取结果：** 服务器的响应包含命令执行的结果。PoC 脚本捕获并显示此响应。

**项目地址:** [Mr-r00t11/CVE-2024-23692](https://github.com/Mr-r00t11/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #5

**来源**: [CVE-2024-23692-NingXin2002_HFS2.3_poc.md](../2024/CVE-2024-23692-NingXin2002_HFS2.3_poc.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程、未经身份验证的攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标服务器运行Rejetto HTTP File Server 2.3m或更早版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的一个模板注入漏洞。攻击者可以通过发送特制的HTTP请求，利用模板引擎的漏洞执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响所有2.3m及以下版本。PoC代码通过构造包含恶意代码的URL，发送到目标服务器。URL中的`cmd=whoami`部分展示了执行命令的能力。虽然PoC主要功能是验证漏洞，但需要人工审查和小心使用以防止潜在的恶意利用. 

**有效性：** 根据漏洞库信息，搜索引擎结果和POC代码，可以确定该POC代码有效。 多个信息源都表明可以通过特制的HTTP请求执行任意命令。

**投毒风险：** 该仓库的投毒风险较低，估计为10%。主要原因：

1.  **PoC的直接性：** PoC的主要目的是验证漏洞的存在，而不是植入后门。代码功能相对简单，直接发送包含命令的HTTP请求。
2.  **命令执行：** PoC中使用的`whoami`命令用于验证，但如果将命令替换为例如下载并执行恶意脚本的命令，则可能存在风险。
3.  **依赖性：** 该PoC只依赖于requests库，没有使用其他的隐蔽的第三方依赖，降低了引入恶意代码的风险。

**利用方式：** 漏洞利用方式如下：

1.  **确定目标：** 确定目标服务器上运行着存在漏洞的Rejetto HTTP File Server版本（<=2.3m）。
2.  **构造恶意URL：**  使用类似PoC中的URL，将`cmd=whoami`替换为需要执行的系统命令。
3.  **发送HTTP请求：**  通过GET请求将构造的URL发送到目标服务器。
4.  **执行命令：**  目标服务器执行URL中指定的命令。

**项目地址:** [NingXin2002/HFS2.3_poc](https://github.com/NingXin2002/HFS2.3_poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #6

**来源**: [CVE-2024-23692-Tupler_CVE-2024-23692-exp.md](../2024/CVE-2024-23692-Tupler_CVE-2024-23692-exp.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m (实际影响到2.4 RC7)

**利用条件:** 目标服务器运行存在漏洞的 Rejetto HFS 服务，攻击者能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 2.3m 及更早版本（实际影响到 2.4 RC7）中的一个模板注入漏洞。此漏洞允许未经身份验证的远程攻击者通过发送特制的 HTTP 请求在受影响的系统上执行任意命令。

**有效性:**
提供的 Python POC 代码 `CVE-2024-23692.py` 看起来有效。代码首先建立与目标服务器的 TCP 连接。 然后它接收用户输入的命令,将其进行 URL 编码，并将其嵌入到一个精心构造的 HTTP GET 请求中。 该请求利用模板注入漏洞在服务器端执行命令。服务器的响应被解析，提取命令执行的结果并打印给用户。代码通过对返回内容进行正则匹配提取执行结果，并避免直接输出所有返回内容来降低风险。

**投毒风险:**
对提供的 POC 代码 `CVE-2024-23692.py` 和 `README.md` 进行分析后，未发现明显的恶意代码或投毒迹象。 代码的功能符合漏洞利用的预期行为，没有发现尝试执行与漏洞利用无关的恶意操作的代码。

**利用方式:**
1.  **目标确认:** 确定目标服务器上运行着易受攻击的 Rejetto HFS 版本 (<= 2.3m, 实际影响到 2.4 RC7).
2.  **构造Payload:** 构造包含恶意命令的 HTTP GET 请求。 POC代码中cmd参数即是需要执行的命令,该命令会被进行URL编码后插入请求中。
3.  **发送请求:** 将构造的 HTTP 请求发送到目标服务器。
4.  **执行命令:** HFS 处理请求时，会执行注入的命令。 `{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`这部分是payload的关键。 {.exec}调用执行外部命令, {.?cmd.}是用户可控的命令，timeout=15限制超时时间，out=abc.将输出重定向到文件abc.，RESULT和====用于标记输出结果，方便提取。
5.  **获取结果:**  从服务器的响应中提取命令执行的结果。POC代码中对返回内容进行正则匹配，提取RESULT和====之间的内容。

**结论:**
该漏洞利用是有效的，并且能够实现远程代码执行。提供的代码中未发现投毒风险。 通过构造特定的请求，攻击者可以在目标系统上执行任意命令，导致严重的安全风险。 根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [Tupler/CVE-2024-23692-exp](https://github.com/Tupler/CVE-2024-23692-exp)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #7

**来源**: [CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md](../2024/CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md)

## CVE-2024-23692-Rejetto HFS 2.3m 远程命令执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程命令执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行受影响版本的Rejetto HTTP File Server，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意命令。利用方式如下：

1.  **漏洞描述：** 漏洞位于服务器处理模板的环节，攻击者通过构造恶意输入，将命令注入到模板中，由服务器执行。
2.  **漏洞利用方式：** 攻击者发送包含恶意模板代码的HTTP GET请求，服务器解析该请求时，会将恶意代码作为命令执行。
3.  **POC分析：** 提供的Go代码通过`zmap`扫描指定端口，然后使用HTTP GET请求，通过在URL中拼接经过编码的恶意命令来利用漏洞。POC首先检测目标是否为HFS服务，如果是则执行预定义的命令，例如 `ping wlccwlc.dnslog.cn` 和 `whoami`。
4.  **投毒风险分析：** 风险较低。主要风险来自以下几点：
    *   POC中执行的命令可以被修改，攻击者可以利用该POC执行任意恶意命令。
    *   `hfs.go`本身没有发现明显的投毒代码。代码逻辑相对清晰，主要功能是发送HTTP请求并处理响应。
    *   `README.md`文件中包含TG链接，存在一定的恶意引流风险，诱导用户加入恶意社群。

**项目地址:** [WanLiChangChengWanLiChang/CVE-2024-23692-RCE](https://github.com/WanLiChangChengWanLiChang/CVE-2024-23692-RCE)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #8

**来源**: [CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md](../2024/CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要网络访问 Rejetto HFS 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在目标系统上执行任意命令，无需身份验证。漏洞利用方式为通过构造包含恶意代码的HTTP请求，利用HFS模板引擎的缺陷执行命令。提供的代码段只是 Apache License 2.0 的许可证文本，本身不包含任何漏洞利用代码，因此无法评估其有效性。根据搜索结果，该漏洞已经有公开的利用方法，并且Metasploit中已经有相关的利用模块。由于提供的代码只是许可证，所以其中不存在投毒代码的风险。漏洞利用的关键在于构造恶意的HTTP请求，请求中包含可以被HFS服务器解释执行的模板注入代码。从CISA已收录该漏洞的情况来看，此漏洞非常活跃，请尽快进行修复。

**项目地址:** [XiaomingX/cve-2024-23692-poc](https://github.com/XiaomingX/cve-2024-23692-poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #9

**来源**: [CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md](../2024/CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入/远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，允许未授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HFS 2.3m，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中的一个模板注入漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求来执行任意命令。漏洞利用代码通过构造包含恶意payload的GET请求，该payload利用模板引擎的特性执行操作系统命令。payload的形式为 `/?search=%25x%25url%25:%host%}{.exec|cmd.}{.break.}`，其中`cmd`是要执行的命令。检测脚本使用相同的payload，但只是验证服务是否返回200 OK，表明存在漏洞。

**有效性：** 根据漏洞描述、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码很可能是有效的。漏洞信息明确指出存在远程代码执行漏洞，搜索引擎结果证实了这一点，漏洞利用代码也实现了构造恶意请求并执行命令的功能。

**投毒风险：** 提供的代码主要是利用漏洞执行命令，并没有发现明显的恶意代码。但仍然存在微小的风险：

*   **依赖风险：** 代码使用了标准库如socket和sys，风险较低。
*   **命令执行风险：** `cmd`参数由用户提供，如果用户不小心执行了恶意命令，可能会导致问题。但是，这不是代码本身的投毒，而是用户使用不当造成的。
*   **网络连接风险：** 虽然有超时设置，但如果目标服务器被攻陷，可能被用于DDoS等攻击。

考虑到以上因素，投毒风险评估为5%。

**利用方式：**

1.  **确定目标：** 找到运行Rejetto HTTP File Server 2.3m的目标IP地址和端口。
2.  **构造恶意请求：** 使用提供的exploit.py脚本，指定目标IP地址、端口以及要执行的命令。
3.  **发送请求：** 脚本将构造包含恶意payload的HTTP GET请求，并发送到目标服务器。
4.  **执行命令：** 如果目标服务器存在漏洞，服务器将执行payload中的命令。
5.  **验证结果：** 脚本会打印服务器的响应。如果返回“200 OK”，则表示漏洞利用可能成功。弹出计算器或者其他命令执行的反馈需要根据具体环境判断。

**项目地址:** [jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS](https://github.com/jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #10

**来源**: [CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md](../2024/CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行Rejetto HFS 2.3m，且攻击者可以发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的HTTP请求来执行任意命令。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被广泛确认存在并且有公开的PoC。提供的PoC代码（CVE-2024-23692.py）尝试利用该漏洞，发送包含恶意模板注入payload的HTTP GET请求，如果服务器存在漏洞，将执行`ipconfig /all` 命令 (windows系统)或者 `systeminfo` 命令。PoC通过检查响应文本中“RESULT”字符串的出现次数来判断漏洞是否存在。 Burp Suite的POC也验证了此漏洞. 因此，PoC代码是有效的。

**投毒风险分析：**

查看提供的python POC代码，没有发现任何恶意代码，例如反弹shell或下载执行其他文件的行为。也没有发现任何试图修改本地文件或窃取敏感信息的代码。PoC脚本功能相对简单，主要用于验证目标是否存在漏洞。 `README.md` 文件中仅包含 HTTP 请求的 PoC 示例和截图，没有发现潜在的投毒代码。综合判断，该仓库中存在作者隐藏的投毒代码的可能性极低。因此，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** 漏洞出现在HFS处理模板时，没有对用户输入进行充分的过滤和转义，导致攻击者可以通过构造恶意的模板代码来执行任意命令。
2.  **攻击方式：** 攻击者通过发送包含特定payload的HTTP请求到目标服务器。
3.  **Payload构造：** PoC中使用的payload是`/?s=%0A&cmd=ipconfig+/all&search=%25xxx%25url:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`。该payload利用了HFS的模板引擎，`{.exec|{.?cmd.}`部分会执行`cmd`参数指定的命令，并将结果输出。
4.  **命令执行：**  服务器在解析该请求时，会执行`cmd`参数指定的命令（例如 `ipconfig /all`），并将命令执行的结果嵌入到响应中返回给攻击者。
5.  **漏洞验证：**  PoC通过检查响应中特定字符串（例如 `RESULT`）的出现次数来判断漏洞是否存在。

**项目地址:** [k3lpi3b4nsh33/CVE-2024-23692](https://github.com/k3lpi3b4nsh33/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #11

**来源**: [CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md](../2024/CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入 (SSTI)

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程未授权代码执行

**影响版本:** <= 2.3m, 2.4.0 RC7 (测试版本)

**利用条件:** 目标系统运行受影响版本的Rejetto HFS，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 中存在的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。

**有效性：**
根据提供的 Metasploit 模块的 README 文件以及漏洞库信息，该漏洞的 POC 代码是有效的。该 POC 已经在 2.4.0 RC7 和 2.3m 版本上进行了测试，并且成功地执行了远程代码。

**投毒风险：**
提供的代码片段主要是一个 Metasploit 模块的 README，展示了如何使用该模块进行漏洞利用。它包含设置 RHOSTS、RPORT、LHOST 和 LPORT 等参数的示例，以及如何执行 check 和 exploit 命令。由于该代码只是一个使用说明，并且Metasploit是可信的项目，因此，投毒的可能性非常低。

**利用方式：**
攻击者通过构造包含恶意模板代码的HTTP请求，将其发送到存在漏洞的Rejetto HFS服务器。服务器在处理该请求时，会将恶意模板代码解析并执行，从而导致任意代码执行。从Metasploit模块的使用方式可以看出，攻击者可以利用这个漏洞直接获取Meterpreter会话。

**参考：**
*   漏洞库信息
*   搜索引擎结果
*   漏洞利用代码（Metasploit模块README）

**项目地址:** [pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692](https://github.com/pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #12

**来源**: [CVE-2024-23692-vanboomqi_CVE-2024-23692.md](../2024/CVE-2024-23692-vanboomqi_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未授权的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行 Rejetto HFS 2.3m 且网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。根据提供的漏洞利用代码，攻击者通过构造特定的 URL，在URL中嵌入恶意命令，由于程序没有充分过滤模板注入，导致命令在服务器端执行。 

**有效性：**
提供的 POC 代码看起来是有效的。它构造了一个包含恶意命令的 HTTP GET 请求，并使用 `http.client` 库发送请求。代码还包含对响应进行 gzip 解压缩以及检测字符编码的功能，提高了在不同环境下的适应性。代码还实现了重试机制以应对间歇性连接问题。

**投毒风险：**
该漏洞利用代码的投毒风险较低。`LICENSE` 文件表明代码遵循 MIT 许可协议，允许自由使用和修改。`exploit.py` 脚本的主要功能是利用漏洞，没有发现明显的恶意代码。尽管如此，始终建议审查任何第三方代码以确保安全。

**利用方式：**
1.  **漏洞定位：**  该漏洞存在于 Rejetto HTTP File Server 的模板处理功能中。
2.  **攻击向量：**  攻击者通过构造包含恶意代码的 HTTP 请求，特别是 URL 中的参数，来触发模板注入。
3.  **命令执行：**  恶意代码被服务器解析并执行，导致远程命令执行。
4.  **响应处理：**  攻击者通过检查服务器的响应来判断漏洞是否利用成功，并获取命令执行的结果。

**项目地址:** [vanboomqi/CVE-2024-23692](https://github.com/vanboomqi/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #13

**来源**: [CVE-2024-23692-verylazytech_CVE-2024-23692.md](../2024/CVE-2024-23692-verylazytech_CVE-2024-23692.md)

## CVE-2024-23692 Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令。

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HTTP File Server 2.3m，且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出存在私有漏洞利用，搜索结果中也包含了利用该漏洞的攻击案例和检测规则。提供的POC代码也证明了可以执行任意命令。

**投毒风险：**
分析提供的POC代码(`/tmp/39e8ac14437cd2343ad255450790e37a/CVE-2024-23692.sh`)，主要功能是构造并发送包含恶意命令的HTTP请求，并解析响应结果。代码中使用了`iconv`和`base64`对命令进行编码，以绕过可能的过滤。代码的目的是利用模板注入漏洞执行系统命令，没有发现明显的恶意投毒代码。LICENSE文件也声明了是MIT开源协议，作者是允许对代码进行修改的。但是, 鉴于任何从互联网下载的代码都存在潜在风险，因此应该谨慎使用，并在受控环境中进行测试，以及对代码进行审查。

**利用方式：**
利用方式是通过向目标 Rejetto HTTP File Server 发送特制的 HTTP GET 请求。这个请求的 `n` 参数和 `cmd` 参数包含经过编码的恶意命令。服务器会解析这些参数，并通过模板注入漏洞执行命令。POC代码中的关键步骤如下：

1.  构造包含命令的payload，使用powershell执行命令。
2.  使用`iconv -t UTF-16LE` 将命令转换为UTF-16LE编码，防止乱码。
3.  使用 `base64 -w 0` 对UTF-16LE编码后的命令进行Base64编码。
4.  构造完整的URL，包含服务器地址和payload。
5.  使用 `curl` 发送请求。
6.  从响应中提取命令执行结果，提取开始和结束标识符`[S]`之间的内容。
7.  输出提取到的命令执行结果。

综上所述，该漏洞利用有效，但使用时应注意潜在风险。

**项目地址:** [verylazytech/CVE-2024-23692](https://github.com/verylazytech/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---



---

## POC #3

**来源**: [CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md](../2024/CVE-2024-23692-BBD-YZZ_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server Template Injection RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行存在漏洞的Rejetto HFS，并能通过网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在服务器上执行任意命令。由于Rejetto HFS已经停止维护，无法通过官方补丁修复此漏洞。

**有效性分析：**
提供的POC代码（hfs.go）利用了该模板注入漏洞，允许攻击者执行命令、执行DNSLog检测等操作。

**投毒风险分析：**
检查了提供的代码仓库，没有发现明显的恶意代码，但是存在以下几点潜在的投毒风险：
1.  **DNSLog配置：** 默认使用ceye.io，如果ceye.io被恶意利用，可能会导致信息泄露。
2.  **代码依赖：** 依赖gopkg.in/ini.v1，此依赖如果存在漏洞，可能会被利用。
3.  **命令执行：** 命令执行本身就存在风险，如果目标系统权限过高，可能会导致严重的安全问题。
4.  **网络请求：** 攻击代码中会发出网络请求，具有一定的流量特征，可以分析网络流量判断是否存在恶意行为。
因此，整体投毒的概率较低，估计为5%。

**利用方式：**
1.  攻击者首先需要确定目标系统运行的是存在漏洞的Rejetto HFS 2.3m。
2.  攻击者可以利用POC代码，通过`-u`参数指定目标URL。
3.  可以使用`-cmd`参数进入命令行模式，执行任意命令。 例如: `go run hfs.go -u http://127.0.0.1 -cmd`。
4.  可以使用`-dns`参数进行DNSLog检测，验证漏洞是否存在。 例如: `go run hfs.go -u http://127.0.0.1 -dns` 或者 `go run hfs.go -u http://127.0.0.1 -dns -d abc.cn`。
5.  如果需要使用代理，可以通过`-p`参数指定代理服务器地址。 例如: `go run hfs.go -u http://127.0.0.1 -cmd -p http://user:pass@127.0.0.1:8080`。

**缓解措施：**
由于Rejetto HFS已经停止维护，建议用户停止使用该软件，并迁移到其他安全的文件服务器软件。

**项目地址:** [BBD-YZZ/CVE-2024-23692](https://github.com/BBD-YZZ/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #4

**来源**: [CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md](../2024/CVE-2024-23692-Mr-r00t11_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行受影响版本的 Rejetto HFS，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。攻击者可以通过构造特定的 HTTP 请求，在服务器上执行任意命令。\n\n**有效性：**\n提供的 PoC 代码 `CVE-2024-23692.sh` 似乎有效。它构造一个包含恶意模板注入的 HTTP GET 请求，利用 `nc` (netcat) 发送到目标服务器，然后显示响应。脚本接受目标 IP 地址、端口和要执行的命令作为参数。 README.md 文件也提供了使用示例，表明可以执行系统命令或部署反向 shell。\n\n**投毒风险：**\n评估投毒风险时，需要考虑以下几点：\n1.  **代码来源：** 代码来自非官方渠道（GitHub 上的个人仓库）。虽然该漏洞本身是真实存在的，但脚本可能包含恶意代码。\n2.  **脚本功能：** 脚本使用 `nc` 工具发送构造的 HTTP 请求。恶意代码可能被隐藏在构造的请求本身（例如，试图下载和执行其他恶意程序），或者在利用成功后执行其他操作。\n3.  **代码审查：** 快速审查脚本发现其核心功能是利用漏洞。投毒代码可能存在于不明显之处，例如对命令执行结果的篡改或者植入后门。\n4.  **网络行为：** 脚本中使用了`nc`，正常使用是发送恶意请求，如果存在其他网络连接行为，需要特别关注\n\n基于上述分析，认为存在10%的投毒风险。风险主要来自于脚本可能尝试利用漏洞植入后门或者执行其他恶意活动。\n\n**利用方式：**\n1.  **构造恶意 HTTP 请求：** PoC 脚本构造一个带有精心设计的查询字符串的 HTTP GET 请求。该查询字符串包含一个模板注入，允许执行服务器端代码。关键参数是 `cmd`，它包含要执行的命令。\n2.  **发送请求：** 脚本使用 `nc` 工具将构造的 HTTP 请求发送到目标服务器。\n3.  **执行命令：** 如果服务器存在漏洞，它将解析并执行注入的模板，从而执行 `cmd` 参数中指定的命令。\n4.  **获取结果：** 服务器的响应包含命令执行的结果。PoC 脚本捕获并显示此响应。

**项目地址:** [Mr-r00t11/CVE-2024-23692](https://github.com/Mr-r00t11/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #5

**来源**: [CVE-2024-23692-NingXin2002_HFS2.3_poc.md](../2024/CVE-2024-23692-NingXin2002_HFS2.3_poc.md)

## CVE-2024-23692-Rejetto HTTP File Server-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程、未经身份验证的攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标服务器运行Rejetto HTTP File Server 2.3m或更早版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的一个模板注入漏洞。攻击者可以通过发送特制的HTTP请求，利用模板引擎的漏洞执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响所有2.3m及以下版本。PoC代码通过构造包含恶意代码的URL，发送到目标服务器。URL中的`cmd=whoami`部分展示了执行命令的能力。虽然PoC主要功能是验证漏洞，但需要人工审查和小心使用以防止潜在的恶意利用. 

**有效性：** 根据漏洞库信息，搜索引擎结果和POC代码，可以确定该POC代码有效。 多个信息源都表明可以通过特制的HTTP请求执行任意命令。

**投毒风险：** 该仓库的投毒风险较低，估计为10%。主要原因：

1.  **PoC的直接性：** PoC的主要目的是验证漏洞的存在，而不是植入后门。代码功能相对简单，直接发送包含命令的HTTP请求。
2.  **命令执行：** PoC中使用的`whoami`命令用于验证，但如果将命令替换为例如下载并执行恶意脚本的命令，则可能存在风险。
3.  **依赖性：** 该PoC只依赖于requests库，没有使用其他的隐蔽的第三方依赖，降低了引入恶意代码的风险。

**利用方式：** 漏洞利用方式如下：

1.  **确定目标：** 确定目标服务器上运行着存在漏洞的Rejetto HTTP File Server版本（<=2.3m）。
2.  **构造恶意URL：**  使用类似PoC中的URL，将`cmd=whoami`替换为需要执行的系统命令。
3.  **发送HTTP请求：**  通过GET请求将构造的URL发送到目标服务器。
4.  **执行命令：**  目标服务器执行URL中指定的命令。

**项目地址:** [NingXin2002/HFS2.3_poc](https://github.com/NingXin2002/HFS2.3_poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #6

**来源**: [CVE-2024-23692-Tupler_CVE-2024-23692-exp.md](../2024/CVE-2024-23692-Tupler_CVE-2024-23692-exp.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m (实际影响到2.4 RC7)

**利用条件:** 目标服务器运行存在漏洞的 Rejetto HFS 服务，攻击者能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 2.3m 及更早版本（实际影响到 2.4 RC7）中的一个模板注入漏洞。此漏洞允许未经身份验证的远程攻击者通过发送特制的 HTTP 请求在受影响的系统上执行任意命令。

**有效性:**
提供的 Python POC 代码 `CVE-2024-23692.py` 看起来有效。代码首先建立与目标服务器的 TCP 连接。 然后它接收用户输入的命令,将其进行 URL 编码，并将其嵌入到一个精心构造的 HTTP GET 请求中。 该请求利用模板注入漏洞在服务器端执行命令。服务器的响应被解析，提取命令执行的结果并打印给用户。代码通过对返回内容进行正则匹配提取执行结果，并避免直接输出所有返回内容来降低风险。

**投毒风险:**
对提供的 POC 代码 `CVE-2024-23692.py` 和 `README.md` 进行分析后，未发现明显的恶意代码或投毒迹象。 代码的功能符合漏洞利用的预期行为，没有发现尝试执行与漏洞利用无关的恶意操作的代码。

**利用方式:**
1.  **目标确认:** 确定目标服务器上运行着易受攻击的 Rejetto HFS 版本 (<= 2.3m, 实际影响到 2.4 RC7).
2.  **构造Payload:** 构造包含恶意命令的 HTTP GET 请求。 POC代码中cmd参数即是需要执行的命令,该命令会被进行URL编码后插入请求中。
3.  **发送请求:** 将构造的 HTTP 请求发送到目标服务器。
4.  **执行命令:** HFS 处理请求时，会执行注入的命令。 `{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`这部分是payload的关键。 {.exec}调用执行外部命令, {.?cmd.}是用户可控的命令，timeout=15限制超时时间，out=abc.将输出重定向到文件abc.，RESULT和====用于标记输出结果，方便提取。
5.  **获取结果:**  从服务器的响应中提取命令执行的结果。POC代码中对返回内容进行正则匹配，提取RESULT和====之间的内容。

**结论:**
该漏洞利用是有效的，并且能够实现远程代码执行。提供的代码中未发现投毒风险。 通过构造特定的请求，攻击者可以在目标系统上执行任意命令，导致严重的安全风险。 根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [Tupler/CVE-2024-23692-exp](https://github.com/Tupler/CVE-2024-23692-exp)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #7

**来源**: [CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md](../2024/CVE-2024-23692-WanLiChangChengWanLiChang_CVE-2024-23692-RCE.md)

## CVE-2024-23692-Rejetto HFS 2.3m 远程命令执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程命令执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行受影响版本的Rejetto HTTP File Server，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意命令。利用方式如下：

1.  **漏洞描述：** 漏洞位于服务器处理模板的环节，攻击者通过构造恶意输入，将命令注入到模板中，由服务器执行。
2.  **漏洞利用方式：** 攻击者发送包含恶意模板代码的HTTP GET请求，服务器解析该请求时，会将恶意代码作为命令执行。
3.  **POC分析：** 提供的Go代码通过`zmap`扫描指定端口，然后使用HTTP GET请求，通过在URL中拼接经过编码的恶意命令来利用漏洞。POC首先检测目标是否为HFS服务，如果是则执行预定义的命令，例如 `ping wlccwlc.dnslog.cn` 和 `whoami`。
4.  **投毒风险分析：** 风险较低。主要风险来自以下几点：
    *   POC中执行的命令可以被修改，攻击者可以利用该POC执行任意恶意命令。
    *   `hfs.go`本身没有发现明显的投毒代码。代码逻辑相对清晰，主要功能是发送HTTP请求并处理响应。
    *   `README.md`文件中包含TG链接，存在一定的恶意引流风险，诱导用户加入恶意社群。

**项目地址:** [WanLiChangChengWanLiChang/CVE-2024-23692-RCE](https://github.com/WanLiChangChengWanLiChang/CVE-2024-23692-RCE)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #8

**来源**: [CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md](../2024/CVE-2024-23692-XiaomingX_cve-2024-23692-poc.md)

## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要网络访问 Rejetto HFS 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在目标系统上执行任意命令，无需身份验证。漏洞利用方式为通过构造包含恶意代码的HTTP请求，利用HFS模板引擎的缺陷执行命令。提供的代码段只是 Apache License 2.0 的许可证文本，本身不包含任何漏洞利用代码，因此无法评估其有效性。根据搜索结果，该漏洞已经有公开的利用方法，并且Metasploit中已经有相关的利用模块。由于提供的代码只是许可证，所以其中不存在投毒代码的风险。漏洞利用的关键在于构造恶意的HTTP请求，请求中包含可以被HFS服务器解释执行的模板注入代码。从CISA已收录该漏洞的情况来看，此漏洞非常活跃，请尽快进行修复。

**项目地址:** [XiaomingX/cve-2024-23692-poc](https://github.com/XiaomingX/cve-2024-23692-poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #9

**来源**: [CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md](../2024/CVE-2024-23692-jakabakos_CVE-2024-23692-RCE-in-Rejetto-HFS.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入/远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，允许未授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HFS 2.3m，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中的一个模板注入漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求来执行任意命令。漏洞利用代码通过构造包含恶意payload的GET请求，该payload利用模板引擎的特性执行操作系统命令。payload的形式为 `/?search=%25x%25url%25:%host%}{.exec|cmd.}{.break.}`，其中`cmd`是要执行的命令。检测脚本使用相同的payload，但只是验证服务是否返回200 OK，表明存在漏洞。

**有效性：** 根据漏洞描述、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码很可能是有效的。漏洞信息明确指出存在远程代码执行漏洞，搜索引擎结果证实了这一点，漏洞利用代码也实现了构造恶意请求并执行命令的功能。

**投毒风险：** 提供的代码主要是利用漏洞执行命令，并没有发现明显的恶意代码。但仍然存在微小的风险：

*   **依赖风险：** 代码使用了标准库如socket和sys，风险较低。
*   **命令执行风险：** `cmd`参数由用户提供，如果用户不小心执行了恶意命令，可能会导致问题。但是，这不是代码本身的投毒，而是用户使用不当造成的。
*   **网络连接风险：** 虽然有超时设置，但如果目标服务器被攻陷，可能被用于DDoS等攻击。

考虑到以上因素，投毒风险评估为5%。

**利用方式：**

1.  **确定目标：** 找到运行Rejetto HTTP File Server 2.3m的目标IP地址和端口。
2.  **构造恶意请求：** 使用提供的exploit.py脚本，指定目标IP地址、端口以及要执行的命令。
3.  **发送请求：** 脚本将构造包含恶意payload的HTTP GET请求，并发送到目标服务器。
4.  **执行命令：** 如果目标服务器存在漏洞，服务器将执行payload中的命令。
5.  **验证结果：** 脚本会打印服务器的响应。如果返回“200 OK”，则表示漏洞利用可能成功。弹出计算器或者其他命令执行的反馈需要根据具体环境判断。

**项目地址:** [jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS](https://github.com/jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #10

**来源**: [CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md](../2024/CVE-2024-23692-k3lpi3b4nsh33_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行Rejetto HFS 2.3m，且攻击者可以发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的HTTP请求来执行任意命令。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被广泛确认存在并且有公开的PoC。提供的PoC代码（CVE-2024-23692.py）尝试利用该漏洞，发送包含恶意模板注入payload的HTTP GET请求，如果服务器存在漏洞，将执行`ipconfig /all` 命令 (windows系统)或者 `systeminfo` 命令。PoC通过检查响应文本中“RESULT”字符串的出现次数来判断漏洞是否存在。 Burp Suite的POC也验证了此漏洞. 因此，PoC代码是有效的。

**投毒风险分析：**

查看提供的python POC代码，没有发现任何恶意代码，例如反弹shell或下载执行其他文件的行为。也没有发现任何试图修改本地文件或窃取敏感信息的代码。PoC脚本功能相对简单，主要用于验证目标是否存在漏洞。 `README.md` 文件中仅包含 HTTP 请求的 PoC 示例和截图，没有发现潜在的投毒代码。综合判断，该仓库中存在作者隐藏的投毒代码的可能性极低。因此，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** 漏洞出现在HFS处理模板时，没有对用户输入进行充分的过滤和转义，导致攻击者可以通过构造恶意的模板代码来执行任意命令。
2.  **攻击方式：** 攻击者通过发送包含特定payload的HTTP请求到目标服务器。
3.  **Payload构造：** PoC中使用的payload是`/?s=%0A&cmd=ipconfig+/all&search=%25xxx%25url:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`。该payload利用了HFS的模板引擎，`{.exec|{.?cmd.}`部分会执行`cmd`参数指定的命令，并将结果输出。
4.  **命令执行：**  服务器在解析该请求时，会执行`cmd`参数指定的命令（例如 `ipconfig /all`），并将命令执行的结果嵌入到响应中返回给攻击者。
5.  **漏洞验证：**  PoC通过检查响应中特定字符串（例如 `RESULT`）的出现次数来判断漏洞是否存在。

**项目地址:** [k3lpi3b4nsh33/CVE-2024-23692](https://github.com/k3lpi3b4nsh33/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #11

**来源**: [CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md](../2024/CVE-2024-23692-pradeepboo_Rejetto-HFS-2.x-RCE-CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入 (SSTI)

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程未授权代码执行

**影响版本:** <= 2.3m, 2.4.0 RC7 (测试版本)

**利用条件:** 目标系统运行受影响版本的Rejetto HFS，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server (HFS) 中存在的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。

**有效性：**
根据提供的 Metasploit 模块的 README 文件以及漏洞库信息，该漏洞的 POC 代码是有效的。该 POC 已经在 2.4.0 RC7 和 2.3m 版本上进行了测试，并且成功地执行了远程代码。

**投毒风险：**
提供的代码片段主要是一个 Metasploit 模块的 README，展示了如何使用该模块进行漏洞利用。它包含设置 RHOSTS、RPORT、LHOST 和 LPORT 等参数的示例，以及如何执行 check 和 exploit 命令。由于该代码只是一个使用说明，并且Metasploit是可信的项目，因此，投毒的可能性非常低。

**利用方式：**
攻击者通过构造包含恶意模板代码的HTTP请求，将其发送到存在漏洞的Rejetto HFS服务器。服务器在处理该请求时，会将恶意模板代码解析并执行，从而导致任意代码执行。从Metasploit模块的使用方式可以看出，攻击者可以利用这个漏洞直接获取Meterpreter会话。

**参考：**
*   漏洞库信息
*   搜索引擎结果
*   漏洞利用代码（Metasploit模块README）

**项目地址:** [pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692](https://github.com/pradeepboo/Rejetto-HFS-2.x-RCE-CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #12

**来源**: [CVE-2024-23692-vanboomqi_CVE-2024-23692.md](../2024/CVE-2024-23692-vanboomqi_CVE-2024-23692.md)

## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未授权的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行 Rejetto HFS 2.3m 且网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。根据提供的漏洞利用代码，攻击者通过构造特定的 URL，在URL中嵌入恶意命令，由于程序没有充分过滤模板注入，导致命令在服务器端执行。 

**有效性：**
提供的 POC 代码看起来是有效的。它构造了一个包含恶意命令的 HTTP GET 请求，并使用 `http.client` 库发送请求。代码还包含对响应进行 gzip 解压缩以及检测字符编码的功能，提高了在不同环境下的适应性。代码还实现了重试机制以应对间歇性连接问题。

**投毒风险：**
该漏洞利用代码的投毒风险较低。`LICENSE` 文件表明代码遵循 MIT 许可协议，允许自由使用和修改。`exploit.py` 脚本的主要功能是利用漏洞，没有发现明显的恶意代码。尽管如此，始终建议审查任何第三方代码以确保安全。

**利用方式：**
1.  **漏洞定位：**  该漏洞存在于 Rejetto HTTP File Server 的模板处理功能中。
2.  **攻击向量：**  攻击者通过构造包含恶意代码的 HTTP 请求，特别是 URL 中的参数，来触发模板注入。
3.  **命令执行：**  恶意代码被服务器解析并执行，导致远程命令执行。
4.  **响应处理：**  攻击者通过检查服务器的响应来判断漏洞是否利用成功，并获取命令执行的结果。

**项目地址:** [vanboomqi/CVE-2024-23692](https://github.com/vanboomqi/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

## POC #13

**来源**: [CVE-2024-23692-verylazytech_CVE-2024-23692.md](../2024/CVE-2024-23692-verylazytech_CVE-2024-23692.md)

## CVE-2024-23692 Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令。

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HTTP File Server 2.3m，且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出存在私有漏洞利用，搜索结果中也包含了利用该漏洞的攻击案例和检测规则。提供的POC代码也证明了可以执行任意命令。

**投毒风险：**
分析提供的POC代码(`/tmp/39e8ac14437cd2343ad255450790e37a/CVE-2024-23692.sh`)，主要功能是构造并发送包含恶意命令的HTTP请求，并解析响应结果。代码中使用了`iconv`和`base64`对命令进行编码，以绕过可能的过滤。代码的目的是利用模板注入漏洞执行系统命令，没有发现明显的恶意投毒代码。LICENSE文件也声明了是MIT开源协议，作者是允许对代码进行修改的。但是, 鉴于任何从互联网下载的代码都存在潜在风险，因此应该谨慎使用，并在受控环境中进行测试，以及对代码进行审查。

**利用方式：**
利用方式是通过向目标 Rejetto HTTP File Server 发送特制的 HTTP GET 请求。这个请求的 `n` 参数和 `cmd` 参数包含经过编码的恶意命令。服务器会解析这些参数，并通过模板注入漏洞执行命令。POC代码中的关键步骤如下：

1.  构造包含命令的payload，使用powershell执行命令。
2.  使用`iconv -t UTF-16LE` 将命令转换为UTF-16LE编码，防止乱码。
3.  使用 `base64 -w 0` 对UTF-16LE编码后的命令进行Base64编码。
4.  构造完整的URL，包含服务器地址和payload。
5.  使用 `curl` 发送请求。
6.  从响应中提取命令执行结果，提取开始和结束标识符`[S]`之间的内容。
7.  输出提取到的命令执行结果。

综上所述，该漏洞利用有效，但使用时应注意潜在风险。

**项目地址:** [verylazytech/CVE-2024-23692](https://github.com/verylazytech/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)

---

