# CVE-2024-43425

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-43425-RedTeamPentesting_moodle-rce-calculatedquestions.md](../2024/CVE-2024-43425-RedTeamPentesting_moodle-rce-calculatedquestions.md)

## CVE-2024-43425-Moodle-远程代码执行

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件等

**影响版本:** 4.1.x (< 4.1.12), 4.2.x (< 4.2.9), 4.3.x (< 4.3.6), 4.4.x (< 4.4.2)

**利用条件:** 需要能够添加/更新问题（calculated question types），默认情况下未经身份验证的攻击者利用难度较高，但如果允许匿名用户创建包含恶意代码的问题，则可能被远程利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-43425 是 Moodle 中计算问题类型中的一个远程代码执行漏洞。攻击者可以通过在计算问题中插入恶意代码来利用此漏洞，从而在服务器上执行任意代码。

**有效性：**
提供的 POC 代码通过 `validation.php` 和 `validation-fixed.php` 演示了漏洞的存在。`validation.php` 文件使用了存在漏洞的验证逻辑，可以执行 PHP 代码，而 `validation-fixed.php` 文件则修复了此漏洞，会返回错误信息。

**投毒风险：**
尽管该仓库主要是为了测试输入验证逻辑，并提供了修复后的验证代码，但仍然存在一定的投毒风险。`xor-generator.py` 脚本虽然本身用于生成函数名称的混淆表达式，但如果攻击者修改该脚本生成包含恶意代码的表达式，则可能被用于恶意目的。总体来看，投毒风险较低，约为10%。主要的风险在于用户可能不理解这些脚本的含义，直接使用。

**利用方式：**
1.  攻击者需要具有添加或更新“计算问题”的权限。在某些配置下，未授权用户可能具备此权限。
2.  攻击者构造包含恶意 PHP 代码的表达式，例如 `(1)->{phpinfo()}` 或使用 `xor-generator.py` 生成的混淆表达式。
3.  将此恶意表达式插入到“计算问题”的公式或答案字段中。
4.  当 Moodle 处理该“计算问题”时，由于存在漏洞的验证逻辑，恶意 PHP 代码将被执行，导致远程代码执行。

**项目地址:** [RedTeamPentesting/moodle-rce-calculatedquestions](https://github.com/RedTeamPentesting/moodle-rce-calculatedquestions)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

## POC #2

**来源**: [CVE-2024-43425-Snizi_Moodle-CVE-2024-43425-Exploit.md](../2024/CVE-2024-43425-Snizi_Moodle-CVE-2024-43425-Exploit.md)

## CVE-2024-43425-Moodle-RCE

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.1.12, 4.2 < 4.2.9, 4.3 < 4.3.6, 4.4 < 4.4.2

**利用条件:** 需要能够添加/更新问题的权限，可能需要登录。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-43425是Moodle中计算题型处理不当导致远程代码执行漏洞。攻击者通过构造恶意的计算题，可以在服务器上执行任意代码。根据漏洞库信息，利用此漏洞需要能够添加/更新问题的权限，这意味着攻击者可能需要首先获得Moodle账户或者具有相应权限。搜索引擎结果显示，该漏洞已被公开讨论，并且存在可用的利用代码。提供的漏洞利用代码是一个Python脚本，它尝试利用该漏洞。代码首先进行登录，然后提取`sesskey`和`course_id`，最后创建一个包含恶意代码的计算题。由于代码中存在许多步骤来获取凭据和权限，并且可能需要在问题创建页面修改特定值，因此利用成功率可能不高。但是，只要Moodle实例存在漏洞并且攻击者具有必要的权限，该漏洞就可以被成功利用。在提供的漏洞利用代码中，风险较低，但不能完全排除作者植入后门代码的可能性。代码整体结构较为清晰，没有明显的恶意行为，但仍然需要人工代码审计。

**项目地址:** [Snizi/Moodle-CVE-2024-43425-Exploit](https://github.com/Snizi/Moodle-CVE-2024-43425-Exploit)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

## POC #3

**来源**: [CVE-2024-43425-Tnot123_cve-2024-43425.md](../2024/CVE-2024-43425-Tnot123_cve-2024-43425.md)

# CVE-2024-43425

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-43425-RedTeamPentesting_moodle-rce-calculatedquestions.md](../2024/CVE-2024-43425-RedTeamPentesting_moodle-rce-calculatedquestions.md)

## CVE-2024-43425-Moodle-远程代码执行

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件等

**影响版本:** 4.1.x (< 4.1.12), 4.2.x (< 4.2.9), 4.3.x (< 4.3.6), 4.4.x (< 4.4.2)

**利用条件:** 需要能够添加/更新问题（calculated question types），默认情况下未经身份验证的攻击者利用难度较高，但如果允许匿名用户创建包含恶意代码的问题，则可能被远程利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-43425 是 Moodle 中计算问题类型中的一个远程代码执行漏洞。攻击者可以通过在计算问题中插入恶意代码来利用此漏洞，从而在服务器上执行任意代码。

**有效性：**
提供的 POC 代码通过 `validation.php` 和 `validation-fixed.php` 演示了漏洞的存在。`validation.php` 文件使用了存在漏洞的验证逻辑，可以执行 PHP 代码，而 `validation-fixed.php` 文件则修复了此漏洞，会返回错误信息。

**投毒风险：**
尽管该仓库主要是为了测试输入验证逻辑，并提供了修复后的验证代码，但仍然存在一定的投毒风险。`xor-generator.py` 脚本虽然本身用于生成函数名称的混淆表达式，但如果攻击者修改该脚本生成包含恶意代码的表达式，则可能被用于恶意目的。总体来看，投毒风险较低，约为10%。主要的风险在于用户可能不理解这些脚本的含义，直接使用。

**利用方式：**
1.  攻击者需要具有添加或更新“计算问题”的权限。在某些配置下，未授权用户可能具备此权限。
2.  攻击者构造包含恶意 PHP 代码的表达式，例如 `(1)->{phpinfo()}` 或使用 `xor-generator.py` 生成的混淆表达式。
3.  将此恶意表达式插入到“计算问题”的公式或答案字段中。
4.  当 Moodle 处理该“计算问题”时，由于存在漏洞的验证逻辑，恶意 PHP 代码将被执行，导致远程代码执行。

**项目地址:** [RedTeamPentesting/moodle-rce-calculatedquestions](https://github.com/RedTeamPentesting/moodle-rce-calculatedquestions)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

## POC #2

**来源**: [CVE-2024-43425-Snizi_Moodle-CVE-2024-43425-Exploit.md](../2024/CVE-2024-43425-Snizi_Moodle-CVE-2024-43425-Exploit.md)

## CVE-2024-43425-Moodle-RCE

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.1.12, 4.2 < 4.2.9, 4.3 < 4.3.6, 4.4 < 4.4.2

**利用条件:** 需要能够添加/更新问题的权限，可能需要登录。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-43425是Moodle中计算题型处理不当导致远程代码执行漏洞。攻击者通过构造恶意的计算题，可以在服务器上执行任意代码。根据漏洞库信息，利用此漏洞需要能够添加/更新问题的权限，这意味着攻击者可能需要首先获得Moodle账户或者具有相应权限。搜索引擎结果显示，该漏洞已被公开讨论，并且存在可用的利用代码。提供的漏洞利用代码是一个Python脚本，它尝试利用该漏洞。代码首先进行登录，然后提取`sesskey`和`course_id`，最后创建一个包含恶意代码的计算题。由于代码中存在许多步骤来获取凭据和权限，并且可能需要在问题创建页面修改特定值，因此利用成功率可能不高。但是，只要Moodle实例存在漏洞并且攻击者具有必要的权限，该漏洞就可以被成功利用。在提供的漏洞利用代码中，风险较低，但不能完全排除作者植入后门代码的可能性。代码整体结构较为清晰，没有明显的恶意行为，但仍然需要人工代码审计。

**项目地址:** [Snizi/Moodle-CVE-2024-43425-Exploit](https://github.com/Snizi/Moodle-CVE-2024-43425-Exploit)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

## POC #3

**来源**: [CVE-2024-43425-Tnot123_cve-2024-43425.md](../2024/CVE-2024-43425-Tnot123_cve-2024-43425.md)

# CVE-2024-43425

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-43425-RedTeamPentesting_moodle-rce-calculatedquestions.md](../2024/CVE-2024-43425-RedTeamPentesting_moodle-rce-calculatedquestions.md)

## CVE-2024-43425-Moodle-远程代码执行

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件等

**影响版本:** 4.1.x (< 4.1.12), 4.2.x (< 4.2.9), 4.3.x (< 4.3.6), 4.4.x (< 4.4.2)

**利用条件:** 需要能够添加/更新问题（calculated question types），默认情况下未经身份验证的攻击者利用难度较高，但如果允许匿名用户创建包含恶意代码的问题，则可能被远程利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-43425 是 Moodle 中计算问题类型中的一个远程代码执行漏洞。攻击者可以通过在计算问题中插入恶意代码来利用此漏洞，从而在服务器上执行任意代码。

**有效性：**
提供的 POC 代码通过 `validation.php` 和 `validation-fixed.php` 演示了漏洞的存在。`validation.php` 文件使用了存在漏洞的验证逻辑，可以执行 PHP 代码，而 `validation-fixed.php` 文件则修复了此漏洞，会返回错误信息。

**投毒风险：**
尽管该仓库主要是为了测试输入验证逻辑，并提供了修复后的验证代码，但仍然存在一定的投毒风险。`xor-generator.py` 脚本虽然本身用于生成函数名称的混淆表达式，但如果攻击者修改该脚本生成包含恶意代码的表达式，则可能被用于恶意目的。总体来看，投毒风险较低，约为10%。主要的风险在于用户可能不理解这些脚本的含义，直接使用。

**利用方式：**
1.  攻击者需要具有添加或更新“计算问题”的权限。在某些配置下，未授权用户可能具备此权限。
2.  攻击者构造包含恶意 PHP 代码的表达式，例如 `(1)->{phpinfo()}` 或使用 `xor-generator.py` 生成的混淆表达式。
3.  将此恶意表达式插入到“计算问题”的公式或答案字段中。
4.  当 Moodle 处理该“计算问题”时，由于存在漏洞的验证逻辑，恶意 PHP 代码将被执行，导致远程代码执行。

**项目地址:** [RedTeamPentesting/moodle-rce-calculatedquestions](https://github.com/RedTeamPentesting/moodle-rce-calculatedquestions)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

## POC #2

**来源**: [CVE-2024-43425-Snizi_Moodle-CVE-2024-43425-Exploit.md](../2024/CVE-2024-43425-Snizi_Moodle-CVE-2024-43425-Exploit.md)

## CVE-2024-43425-Moodle-RCE

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.1.12, 4.2 < 4.2.9, 4.3 < 4.3.6, 4.4 < 4.4.2

**利用条件:** 需要能够添加/更新问题的权限，可能需要登录。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-43425是Moodle中计算题型处理不当导致远程代码执行漏洞。攻击者通过构造恶意的计算题，可以在服务器上执行任意代码。根据漏洞库信息，利用此漏洞需要能够添加/更新问题的权限，这意味着攻击者可能需要首先获得Moodle账户或者具有相应权限。搜索引擎结果显示，该漏洞已被公开讨论，并且存在可用的利用代码。提供的漏洞利用代码是一个Python脚本，它尝试利用该漏洞。代码首先进行登录，然后提取`sesskey`和`course_id`，最后创建一个包含恶意代码的计算题。由于代码中存在许多步骤来获取凭据和权限，并且可能需要在问题创建页面修改特定值，因此利用成功率可能不高。但是，只要Moodle实例存在漏洞并且攻击者具有必要的权限，该漏洞就可以被成功利用。在提供的漏洞利用代码中，风险较低，但不能完全排除作者植入后门代码的可能性。代码整体结构较为清晰，没有明显的恶意行为，但仍然需要人工代码审计。

**项目地址:** [Snizi/Moodle-CVE-2024-43425-Exploit](https://github.com/Snizi/Moodle-CVE-2024-43425-Exploit)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

## POC #3

**来源**: [CVE-2024-43425-Tnot123_cve-2024-43425.md](../2024/CVE-2024-43425-Tnot123_cve-2024-43425.md)

# CVE-2024-43425

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-43425-RedTeamPentesting_moodle-rce-calculatedquestions.md](../2024/CVE-2024-43425-RedTeamPentesting_moodle-rce-calculatedquestions.md)

## CVE-2024-43425-Moodle-远程代码执行

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件等

**影响版本:** 4.1.x (< 4.1.12), 4.2.x (< 4.2.9), 4.3.x (< 4.3.6), 4.4.x (< 4.4.2)

**利用条件:** 需要能够添加/更新问题（calculated question types），默认情况下未经身份验证的攻击者利用难度较高，但如果允许匿名用户创建包含恶意代码的问题，则可能被远程利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-43425 是 Moodle 中计算问题类型中的一个远程代码执行漏洞。攻击者可以通过在计算问题中插入恶意代码来利用此漏洞，从而在服务器上执行任意代码。

**有效性：**
提供的 POC 代码通过 `validation.php` 和 `validation-fixed.php` 演示了漏洞的存在。`validation.php` 文件使用了存在漏洞的验证逻辑，可以执行 PHP 代码，而 `validation-fixed.php` 文件则修复了此漏洞，会返回错误信息。

**投毒风险：**
尽管该仓库主要是为了测试输入验证逻辑，并提供了修复后的验证代码，但仍然存在一定的投毒风险。`xor-generator.py` 脚本虽然本身用于生成函数名称的混淆表达式，但如果攻击者修改该脚本生成包含恶意代码的表达式，则可能被用于恶意目的。总体来看，投毒风险较低，约为10%。主要的风险在于用户可能不理解这些脚本的含义，直接使用。

**利用方式：**
1.  攻击者需要具有添加或更新“计算问题”的权限。在某些配置下，未授权用户可能具备此权限。
2.  攻击者构造包含恶意 PHP 代码的表达式，例如 `(1)->{phpinfo()}` 或使用 `xor-generator.py` 生成的混淆表达式。
3.  将此恶意表达式插入到“计算问题”的公式或答案字段中。
4.  当 Moodle 处理该“计算问题”时，由于存在漏洞的验证逻辑，恶意 PHP 代码将被执行，导致远程代码执行。

**项目地址:** [RedTeamPentesting/moodle-rce-calculatedquestions](https://github.com/RedTeamPentesting/moodle-rce-calculatedquestions)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

## POC #2

**来源**: [CVE-2024-43425-Snizi_Moodle-CVE-2024-43425-Exploit.md](../2024/CVE-2024-43425-Snizi_Moodle-CVE-2024-43425-Exploit.md)

## CVE-2024-43425-Moodle-RCE

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.1.12, 4.2 < 4.2.9, 4.3 < 4.3.6, 4.4 < 4.4.2

**利用条件:** 需要能够添加/更新问题的权限，可能需要登录。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-43425是Moodle中计算题型处理不当导致远程代码执行漏洞。攻击者通过构造恶意的计算题，可以在服务器上执行任意代码。根据漏洞库信息，利用此漏洞需要能够添加/更新问题的权限，这意味着攻击者可能需要首先获得Moodle账户或者具有相应权限。搜索引擎结果显示，该漏洞已被公开讨论，并且存在可用的利用代码。提供的漏洞利用代码是一个Python脚本，它尝试利用该漏洞。代码首先进行登录，然后提取`sesskey`和`course_id`，最后创建一个包含恶意代码的计算题。由于代码中存在许多步骤来获取凭据和权限，并且可能需要在问题创建页面修改特定值，因此利用成功率可能不高。但是，只要Moodle实例存在漏洞并且攻击者具有必要的权限，该漏洞就可以被成功利用。在提供的漏洞利用代码中，风险较低，但不能完全排除作者植入后门代码的可能性。代码整体结构较为清晰，没有明显的恶意行为，但仍然需要人工代码审计。

**项目地址:** [Snizi/Moodle-CVE-2024-43425-Exploit](https://github.com/Snizi/Moodle-CVE-2024-43425-Exploit)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

## POC #3

**来源**: [CVE-2024-43425-Tnot123_cve-2024-43425.md](../2024/CVE-2024-43425-Tnot123_cve-2024-43425.md)

# CVE-2024-43425

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-43425-RedTeamPentesting_moodle-rce-calculatedquestions.md](../2024/CVE-2024-43425-RedTeamPentesting_moodle-rce-calculatedquestions.md)

## CVE-2024-43425-Moodle-远程代码执行

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件等

**影响版本:** 4.1.x (< 4.1.12), 4.2.x (< 4.2.9), 4.3.x (< 4.3.6), 4.4.x (< 4.4.2)

**利用条件:** 需要能够添加/更新问题（calculated question types），默认情况下未经身份验证的攻击者利用难度较高，但如果允许匿名用户创建包含恶意代码的问题，则可能被远程利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-43425 是 Moodle 中计算问题类型中的一个远程代码执行漏洞。攻击者可以通过在计算问题中插入恶意代码来利用此漏洞，从而在服务器上执行任意代码。

**有效性：**
提供的 POC 代码通过 `validation.php` 和 `validation-fixed.php` 演示了漏洞的存在。`validation.php` 文件使用了存在漏洞的验证逻辑，可以执行 PHP 代码，而 `validation-fixed.php` 文件则修复了此漏洞，会返回错误信息。

**投毒风险：**
尽管该仓库主要是为了测试输入验证逻辑，并提供了修复后的验证代码，但仍然存在一定的投毒风险。`xor-generator.py` 脚本虽然本身用于生成函数名称的混淆表达式，但如果攻击者修改该脚本生成包含恶意代码的表达式，则可能被用于恶意目的。总体来看，投毒风险较低，约为10%。主要的风险在于用户可能不理解这些脚本的含义，直接使用。

**利用方式：**
1.  攻击者需要具有添加或更新“计算问题”的权限。在某些配置下，未授权用户可能具备此权限。
2.  攻击者构造包含恶意 PHP 代码的表达式，例如 `(1)->{phpinfo()}` 或使用 `xor-generator.py` 生成的混淆表达式。
3.  将此恶意表达式插入到“计算问题”的公式或答案字段中。
4.  当 Moodle 处理该“计算问题”时，由于存在漏洞的验证逻辑，恶意 PHP 代码将被执行，导致远程代码执行。

**项目地址:** [RedTeamPentesting/moodle-rce-calculatedquestions](https://github.com/RedTeamPentesting/moodle-rce-calculatedquestions)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

## POC #2

**来源**: [CVE-2024-43425-Snizi_Moodle-CVE-2024-43425-Exploit.md](../2024/CVE-2024-43425-Snizi_Moodle-CVE-2024-43425-Exploit.md)

## CVE-2024-43425-Moodle-RCE

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.1.12, 4.2 < 4.2.9, 4.3 < 4.3.6, 4.4 < 4.4.2

**利用条件:** 需要能够添加/更新问题的权限，可能需要登录。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-43425是Moodle中计算题型处理不当导致远程代码执行漏洞。攻击者通过构造恶意的计算题，可以在服务器上执行任意代码。根据漏洞库信息，利用此漏洞需要能够添加/更新问题的权限，这意味着攻击者可能需要首先获得Moodle账户或者具有相应权限。搜索引擎结果显示，该漏洞已被公开讨论，并且存在可用的利用代码。提供的漏洞利用代码是一个Python脚本，它尝试利用该漏洞。代码首先进行登录，然后提取`sesskey`和`course_id`，最后创建一个包含恶意代码的计算题。由于代码中存在许多步骤来获取凭据和权限，并且可能需要在问题创建页面修改特定值，因此利用成功率可能不高。但是，只要Moodle实例存在漏洞并且攻击者具有必要的权限，该漏洞就可以被成功利用。在提供的漏洞利用代码中，风险较低，但不能完全排除作者植入后门代码的可能性。代码整体结构较为清晰，没有明显的恶意行为，但仍然需要人工代码审计。

**项目地址:** [Snizi/Moodle-CVE-2024-43425-Exploit](https://github.com/Snizi/Moodle-CVE-2024-43425-Exploit)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

## POC #3

**来源**: [CVE-2024-43425-aayush256-sys_Moodle-authenticated-RCE.md](../2024/CVE-2024-43425-aayush256-sys_Moodle-authenticated-RCE.md)

## CVE-2024-43425-Moodle-RCE

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，允许攻击者在服务器上执行任意命令

**影响版本:** Moodle 4.1 to 4.1.11, 4.2 to 4.2.8, 4.3 to 4.3.5, 4.4 to 4.4.1

**利用条件:** 需要有效的Moodle账户，并且该账户需要拥有添加/更新问题的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Moodle的计算题型中，攻击者可以通过利用不安全的题库编辑功能，构造恶意数据，实现在服务器上执行任意代码。利用方式如下：

1.  **获取登录Token：** 首先通过GET请求登录页面`/login/index.php`，从响应中提取`logintoken`。
2.  **登录Moodle：** 使用提取的`logintoken`，以及用户名和密码，通过POST请求`/login/index.php`进行登录。
3.  **获取Sesskey：** 登录成功后，通过GET请求`/my/courses.php`，提取`sesskey`。
4.  **获取Course ID：** 使用`sesskey`，通过POST请求`/lib/ajax/service.php`获取课程ID。
5.  **创建恶意问题：**  构造包含恶意代码的题目，通过POST请求`/question/bank/editquestion/question.php`创建。
6.  **触发执行：**  当Moodle处理该题目时，恶意代码将被执行，从而实现远程代码执行。

**关于投毒风险：**

虽然该POC代码可以利用，但代码中存在一定的投毒风险。主要体现在以下几个方面：
*   **依赖安装风险**：`requirements.txt` 文件中可能包含恶意依赖包，这些包在安装后可能执行恶意代码。但就当前提供的代码来看，该风险较低，因为利用的是Moodle自身的漏洞。
*   **代码执行风险**：`exploit.py`脚本本身可能存在漏洞，允许攻击者通过修改脚本的参数或逻辑来执行恶意操作，例如删除文件或修改数据库信息，该风险较低。
总体而言，投毒风险较低，但使用者仍然需要对代码进行审查和验证，确保其安全性。

**项目地址:** [aayush256-sys/Moodle-authenticated-RCE](https://github.com/aayush256-sys/Moodle-authenticated-RCE)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

## POC #4

**来源**: [CVE-2024-43425-aninfosec_CVE-2024-43425-Poc.md](../2024/CVE-2024-43425-aninfosec_CVE-2024-43425-Poc.md)

## CVE-2024-43425-Moodle-远程代码执行

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可完全控制服务器，窃取信息，安装勒索软件等

**影响版本:** 4.1.x < 4.1.12, 4.2.x < 4.2.9, 4.3.x < 4.3.6, 4.4.x < 4.4.2

**利用条件:** 需要攻击者拥有教师或管理员权限，能够编辑quiz。需要知道cmid(quiz模块ID) 和 courseid。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-43425 存在于 Moodle 的 calculated question 类型中。攻击者可以通过构造包含恶意代码的 calculated question，利用 dataset wizard 功能执行任意代码。

**有效性:** 根据rapid7的漏洞利用模块描述和提供的POC代码，该漏洞利用是有效的，通过上传一个精心构造的计算问题，包含一个系统命令执行的payload，然后通过Dataset Wizard触发该Payload，从而执行任意命令。

**投毒风险:**  README.md中说明了payload，`answer[0] = "(1)->{system($_GET[chr(97)])}"` ，`chr(97)`是`a`的ASCII码。该payload会将接收到的a参数的内容当做系统命令执行。查看`exploit.py`脚本，并未发现有其他恶意代码。但是脚本的编写风格和变量命名稍显粗糙，存在一定风险，作者可能会通过微妙的修改，例如在请求头中添加恶意header等手段进行投毒。因此，该POC代码存在一定的投毒风险，预估为10%。使用时务必进行代码审计。

**利用方式:**
1.  获取登录token。
2.  使用用户名和密码登录Moodle系统，建立有效的MoodleSession。
3.  从quiz编辑页面提取sesskey, ctxid, 和 category。
4.  上传一个精心构造的包含RCE payload的calculated question。
5.  通过dataset wizard页面触发payload，执行任意系统命令。

**项目地址:** [aninfosec/CVE-2024-43425-Poc](https://github.com/aninfosec/CVE-2024-43425-Poc)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---



---

## POC #4

**来源**: [CVE-2024-43425-aayush256-sys_Moodle-authenticated-RCE.md](../2024/CVE-2024-43425-aayush256-sys_Moodle-authenticated-RCE.md)

## CVE-2024-43425-Moodle-RCE

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，允许攻击者在服务器上执行任意命令

**影响版本:** Moodle 4.1 to 4.1.11, 4.2 to 4.2.8, 4.3 to 4.3.5, 4.4 to 4.4.1

**利用条件:** 需要有效的Moodle账户，并且该账户需要拥有添加/更新问题的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Moodle的计算题型中，攻击者可以通过利用不安全的题库编辑功能，构造恶意数据，实现在服务器上执行任意代码。利用方式如下：

1.  **获取登录Token：** 首先通过GET请求登录页面`/login/index.php`，从响应中提取`logintoken`。
2.  **登录Moodle：** 使用提取的`logintoken`，以及用户名和密码，通过POST请求`/login/index.php`进行登录。
3.  **获取Sesskey：** 登录成功后，通过GET请求`/my/courses.php`，提取`sesskey`。
4.  **获取Course ID：** 使用`sesskey`，通过POST请求`/lib/ajax/service.php`获取课程ID。
5.  **创建恶意问题：**  构造包含恶意代码的题目，通过POST请求`/question/bank/editquestion/question.php`创建。
6.  **触发执行：**  当Moodle处理该题目时，恶意代码将被执行，从而实现远程代码执行。

**关于投毒风险：**

虽然该POC代码可以利用，但代码中存在一定的投毒风险。主要体现在以下几个方面：
*   **依赖安装风险**：`requirements.txt` 文件中可能包含恶意依赖包，这些包在安装后可能执行恶意代码。但就当前提供的代码来看，该风险较低，因为利用的是Moodle自身的漏洞。
*   **代码执行风险**：`exploit.py`脚本本身可能存在漏洞，允许攻击者通过修改脚本的参数或逻辑来执行恶意操作，例如删除文件或修改数据库信息，该风险较低。
总体而言，投毒风险较低，但使用者仍然需要对代码进行审查和验证，确保其安全性。

**项目地址:** [aayush256-sys/Moodle-authenticated-RCE](https://github.com/aayush256-sys/Moodle-authenticated-RCE)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

## POC #5

**来源**: [CVE-2024-43425-aninfosec_CVE-2024-43425-Poc.md](../2024/CVE-2024-43425-aninfosec_CVE-2024-43425-Poc.md)

## CVE-2024-43425-Moodle-远程代码执行

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可完全控制服务器，窃取信息，安装勒索软件等

**影响版本:** 4.1.x < 4.1.12, 4.2.x < 4.2.9, 4.3.x < 4.3.6, 4.4.x < 4.4.2

**利用条件:** 需要攻击者拥有教师或管理员权限，能够编辑quiz。需要知道cmid(quiz模块ID) 和 courseid。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-43425 存在于 Moodle 的 calculated question 类型中。攻击者可以通过构造包含恶意代码的 calculated question，利用 dataset wizard 功能执行任意代码。

**有效性:** 根据rapid7的漏洞利用模块描述和提供的POC代码，该漏洞利用是有效的，通过上传一个精心构造的计算问题，包含一个系统命令执行的payload，然后通过Dataset Wizard触发该Payload，从而执行任意命令。

**投毒风险:**  README.md中说明了payload，`answer[0] = "(1)->{system($_GET[chr(97)])}"` ，`chr(97)`是`a`的ASCII码。该payload会将接收到的a参数的内容当做系统命令执行。查看`exploit.py`脚本，并未发现有其他恶意代码。但是脚本的编写风格和变量命名稍显粗糙，存在一定风险，作者可能会通过微妙的修改，例如在请求头中添加恶意header等手段进行投毒。因此，该POC代码存在一定的投毒风险，预估为10%。使用时务必进行代码审计。

**利用方式:**
1.  获取登录token。
2.  使用用户名和密码登录Moodle系统，建立有效的MoodleSession。
3.  从quiz编辑页面提取sesskey, ctxid, 和 category。
4.  上传一个精心构造的包含RCE payload的calculated question。
5.  通过dataset wizard页面触发payload，执行任意系统命令。

**项目地址:** [aninfosec/CVE-2024-43425-Poc](https://github.com/aninfosec/CVE-2024-43425-Poc)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---



---

## POC #4

**来源**: [CVE-2024-43425-aayush256-sys_Moodle-authenticated-RCE.md](../2024/CVE-2024-43425-aayush256-sys_Moodle-authenticated-RCE.md)

## CVE-2024-43425-Moodle-RCE

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，允许攻击者在服务器上执行任意命令

**影响版本:** Moodle 4.1 to 4.1.11, 4.2 to 4.2.8, 4.3 to 4.3.5, 4.4 to 4.4.1

**利用条件:** 需要有效的Moodle账户，并且该账户需要拥有添加/更新问题的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Moodle的计算题型中，攻击者可以通过利用不安全的题库编辑功能，构造恶意数据，实现在服务器上执行任意代码。利用方式如下：

1.  **获取登录Token：** 首先通过GET请求登录页面`/login/index.php`，从响应中提取`logintoken`。
2.  **登录Moodle：** 使用提取的`logintoken`，以及用户名和密码，通过POST请求`/login/index.php`进行登录。
3.  **获取Sesskey：** 登录成功后，通过GET请求`/my/courses.php`，提取`sesskey`。
4.  **获取Course ID：** 使用`sesskey`，通过POST请求`/lib/ajax/service.php`获取课程ID。
5.  **创建恶意问题：**  构造包含恶意代码的题目，通过POST请求`/question/bank/editquestion/question.php`创建。
6.  **触发执行：**  当Moodle处理该题目时，恶意代码将被执行，从而实现远程代码执行。

**关于投毒风险：**

虽然该POC代码可以利用，但代码中存在一定的投毒风险。主要体现在以下几个方面：
*   **依赖安装风险**：`requirements.txt` 文件中可能包含恶意依赖包，这些包在安装后可能执行恶意代码。但就当前提供的代码来看，该风险较低，因为利用的是Moodle自身的漏洞。
*   **代码执行风险**：`exploit.py`脚本本身可能存在漏洞，允许攻击者通过修改脚本的参数或逻辑来执行恶意操作，例如删除文件或修改数据库信息，该风险较低。
总体而言，投毒风险较低，但使用者仍然需要对代码进行审查和验证，确保其安全性。

**项目地址:** [aayush256-sys/Moodle-authenticated-RCE](https://github.com/aayush256-sys/Moodle-authenticated-RCE)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

## POC #5

**来源**: [CVE-2024-43425-aninfosec_CVE-2024-43425-Poc.md](../2024/CVE-2024-43425-aninfosec_CVE-2024-43425-Poc.md)

## CVE-2024-43425-Moodle-远程代码执行

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可完全控制服务器，窃取信息，安装勒索软件等

**影响版本:** 4.1.x < 4.1.12, 4.2.x < 4.2.9, 4.3.x < 4.3.6, 4.4.x < 4.4.2

**利用条件:** 需要攻击者拥有教师或管理员权限，能够编辑quiz。需要知道cmid(quiz模块ID) 和 courseid。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-43425 存在于 Moodle 的 calculated question 类型中。攻击者可以通过构造包含恶意代码的 calculated question，利用 dataset wizard 功能执行任意代码。

**有效性:** 根据rapid7的漏洞利用模块描述和提供的POC代码，该漏洞利用是有效的，通过上传一个精心构造的计算问题，包含一个系统命令执行的payload，然后通过Dataset Wizard触发该Payload，从而执行任意命令。

**投毒风险:**  README.md中说明了payload，`answer[0] = "(1)->{system($_GET[chr(97)])}"` ，`chr(97)`是`a`的ASCII码。该payload会将接收到的a参数的内容当做系统命令执行。查看`exploit.py`脚本，并未发现有其他恶意代码。但是脚本的编写风格和变量命名稍显粗糙，存在一定风险，作者可能会通过微妙的修改，例如在请求头中添加恶意header等手段进行投毒。因此，该POC代码存在一定的投毒风险，预估为10%。使用时务必进行代码审计。

**利用方式:**
1.  获取登录token。
2.  使用用户名和密码登录Moodle系统，建立有效的MoodleSession。
3.  从quiz编辑页面提取sesskey, ctxid, 和 category。
4.  上传一个精心构造的包含RCE payload的calculated question。
5.  通过dataset wizard页面触发payload，执行任意系统命令。

**项目地址:** [aninfosec/CVE-2024-43425-Poc](https://github.com/aninfosec/CVE-2024-43425-Poc)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---



---

## POC #4

**来源**: [CVE-2024-43425-aayush256-sys_Moodle-authenticated-RCE.md](../2024/CVE-2024-43425-aayush256-sys_Moodle-authenticated-RCE.md)

## CVE-2024-43425-Moodle-RCE

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，允许攻击者在服务器上执行任意命令

**影响版本:** Moodle 4.1 to 4.1.11, 4.2 to 4.2.8, 4.3 to 4.3.5, 4.4 to 4.4.1

**利用条件:** 需要有效的Moodle账户，并且该账户需要拥有添加/更新问题的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Moodle的计算题型中，攻击者可以通过利用不安全的题库编辑功能，构造恶意数据，实现在服务器上执行任意代码。利用方式如下：

1.  **获取登录Token：** 首先通过GET请求登录页面`/login/index.php`，从响应中提取`logintoken`。
2.  **登录Moodle：** 使用提取的`logintoken`，以及用户名和密码，通过POST请求`/login/index.php`进行登录。
3.  **获取Sesskey：** 登录成功后，通过GET请求`/my/courses.php`，提取`sesskey`。
4.  **获取Course ID：** 使用`sesskey`，通过POST请求`/lib/ajax/service.php`获取课程ID。
5.  **创建恶意问题：**  构造包含恶意代码的题目，通过POST请求`/question/bank/editquestion/question.php`创建。
6.  **触发执行：**  当Moodle处理该题目时，恶意代码将被执行，从而实现远程代码执行。

**关于投毒风险：**

虽然该POC代码可以利用，但代码中存在一定的投毒风险。主要体现在以下几个方面：
*   **依赖安装风险**：`requirements.txt` 文件中可能包含恶意依赖包，这些包在安装后可能执行恶意代码。但就当前提供的代码来看，该风险较低，因为利用的是Moodle自身的漏洞。
*   **代码执行风险**：`exploit.py`脚本本身可能存在漏洞，允许攻击者通过修改脚本的参数或逻辑来执行恶意操作，例如删除文件或修改数据库信息，该风险较低。
总体而言，投毒风险较低，但使用者仍然需要对代码进行审查和验证，确保其安全性。

**项目地址:** [aayush256-sys/Moodle-authenticated-RCE](https://github.com/aayush256-sys/Moodle-authenticated-RCE)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

## POC #5

**来源**: [CVE-2024-43425-aninfosec_CVE-2024-43425-Poc.md](../2024/CVE-2024-43425-aninfosec_CVE-2024-43425-Poc.md)

## CVE-2024-43425-Moodle-远程代码执行

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可完全控制服务器，窃取信息，安装勒索软件等

**影响版本:** 4.1.x < 4.1.12, 4.2.x < 4.2.9, 4.3.x < 4.3.6, 4.4.x < 4.4.2

**利用条件:** 需要攻击者拥有教师或管理员权限，能够编辑quiz。需要知道cmid(quiz模块ID) 和 courseid。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-43425 存在于 Moodle 的 calculated question 类型中。攻击者可以通过构造包含恶意代码的 calculated question，利用 dataset wizard 功能执行任意代码。

**有效性:** 根据rapid7的漏洞利用模块描述和提供的POC代码，该漏洞利用是有效的，通过上传一个精心构造的计算问题，包含一个系统命令执行的payload，然后通过Dataset Wizard触发该Payload，从而执行任意命令。

**投毒风险:**  README.md中说明了payload，`answer[0] = "(1)->{system($_GET[chr(97)])}"` ，`chr(97)`是`a`的ASCII码。该payload会将接收到的a参数的内容当做系统命令执行。查看`exploit.py`脚本，并未发现有其他恶意代码。但是脚本的编写风格和变量命名稍显粗糙，存在一定风险，作者可能会通过微妙的修改，例如在请求头中添加恶意header等手段进行投毒。因此，该POC代码存在一定的投毒风险，预估为10%。使用时务必进行代码审计。

**利用方式:**
1.  获取登录token。
2.  使用用户名和密码登录Moodle系统，建立有效的MoodleSession。
3.  从quiz编辑页面提取sesskey, ctxid, 和 category。
4.  上传一个精心构造的包含RCE payload的calculated question。
5.  通过dataset wizard页面触发payload，执行任意系统命令。

**项目地址:** [aninfosec/CVE-2024-43425-Poc](https://github.com/aninfosec/CVE-2024-43425-Poc)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---



---

## POC #4

**来源**: [CVE-2024-43425-aayush256-sys_Moodle-authenticated-RCE.md](../2024/CVE-2024-43425-aayush256-sys_Moodle-authenticated-RCE.md)

## CVE-2024-43425-Moodle-RCE

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，允许攻击者在服务器上执行任意命令

**影响版本:** Moodle 4.1 to 4.1.11, 4.2 to 4.2.8, 4.3 to 4.3.5, 4.4 to 4.4.1

**利用条件:** 需要有效的Moodle账户，并且该账户需要拥有添加/更新问题的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Moodle的计算题型中，攻击者可以通过利用不安全的题库编辑功能，构造恶意数据，实现在服务器上执行任意代码。利用方式如下：

1.  **获取登录Token：** 首先通过GET请求登录页面`/login/index.php`，从响应中提取`logintoken`。
2.  **登录Moodle：** 使用提取的`logintoken`，以及用户名和密码，通过POST请求`/login/index.php`进行登录。
3.  **获取Sesskey：** 登录成功后，通过GET请求`/my/courses.php`，提取`sesskey`。
4.  **获取Course ID：** 使用`sesskey`，通过POST请求`/lib/ajax/service.php`获取课程ID。
5.  **创建恶意问题：**  构造包含恶意代码的题目，通过POST请求`/question/bank/editquestion/question.php`创建。
6.  **触发执行：**  当Moodle处理该题目时，恶意代码将被执行，从而实现远程代码执行。

**关于投毒风险：**

虽然该POC代码可以利用，但代码中存在一定的投毒风险。主要体现在以下几个方面：
*   **依赖安装风险**：`requirements.txt` 文件中可能包含恶意依赖包，这些包在安装后可能执行恶意代码。但就当前提供的代码来看，该风险较低，因为利用的是Moodle自身的漏洞。
*   **代码执行风险**：`exploit.py`脚本本身可能存在漏洞，允许攻击者通过修改脚本的参数或逻辑来执行恶意操作，例如删除文件或修改数据库信息，该风险较低。
总体而言，投毒风险较低，但使用者仍然需要对代码进行审查和验证，确保其安全性。

**项目地址:** [aayush256-sys/Moodle-authenticated-RCE](https://github.com/aayush256-sys/Moodle-authenticated-RCE)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

## POC #5

**来源**: [CVE-2024-43425-aninfosec_CVE-2024-43425-Poc.md](../2024/CVE-2024-43425-aninfosec_CVE-2024-43425-Poc.md)

## CVE-2024-43425-Moodle-远程代码执行

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可完全控制服务器，窃取信息，安装勒索软件等

**影响版本:** 4.1.x < 4.1.12, 4.2.x < 4.2.9, 4.3.x < 4.3.6, 4.4.x < 4.4.2

**利用条件:** 需要攻击者拥有教师或管理员权限，能够编辑quiz。需要知道cmid(quiz模块ID) 和 courseid。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-43425 存在于 Moodle 的 calculated question 类型中。攻击者可以通过构造包含恶意代码的 calculated question，利用 dataset wizard 功能执行任意代码。

**有效性:** 根据rapid7的漏洞利用模块描述和提供的POC代码，该漏洞利用是有效的，通过上传一个精心构造的计算问题，包含一个系统命令执行的payload，然后通过Dataset Wizard触发该Payload，从而执行任意命令。

**投毒风险:**  README.md中说明了payload，`answer[0] = "(1)->{system($_GET[chr(97)])}"` ，`chr(97)`是`a`的ASCII码。该payload会将接收到的a参数的内容当做系统命令执行。查看`exploit.py`脚本，并未发现有其他恶意代码。但是脚本的编写风格和变量命名稍显粗糙，存在一定风险，作者可能会通过微妙的修改，例如在请求头中添加恶意header等手段进行投毒。因此，该POC代码存在一定的投毒风险，预估为10%。使用时务必进行代码审计。

**利用方式:**
1.  获取登录token。
2.  使用用户名和密码登录Moodle系统，建立有效的MoodleSession。
3.  从quiz编辑页面提取sesskey, ctxid, 和 category。
4.  上传一个精心构造的包含RCE payload的calculated question。
5.  通过dataset wizard页面触发payload，执行任意系统命令。

**项目地址:** [aninfosec/CVE-2024-43425-Poc](https://github.com/aninfosec/CVE-2024-43425-Poc)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)

---

