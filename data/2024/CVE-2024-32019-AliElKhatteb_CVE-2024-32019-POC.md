# CVE-2024-32019

> ðŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-localæƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´rootæƒé™èŽ·å–

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯netdataä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚è¯¥æ¼æ´žæ˜¯ç”±äºŽndsudoä»¥rootæƒé™è¿è¡Œï¼Œå¹¶ä¸”å…¶æœç´¢è·¯å¾„å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æŒ‡å‘æ¶æ„ç¨‹åºçš„è·¯å¾„æ·»åŠ åˆ°ndsudoçš„æœç´¢è·¯å¾„ä¸­ï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æå‡æƒé™çš„ä»£ç ã€‚
2.  æ”»å‡»è€…ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•æ·»åŠ åˆ°PATHä¸­ã€‚
3.  æ”»å‡»è€…è§¦å‘ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç”±äºŽPATHè¢«ä¿®æ”¹ï¼Œndsudoä¼šæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
4.  æ”»å‡»è€…èŽ·å¾—rootæƒé™ã€‚

æ ¹æ®æä¾›çš„æ¼æ´žåˆ©ç”¨ä»£ç `/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`ï¼Œè¯¥ä»£ç å®žé™…ä¸Šæ˜¯é’ˆå¯¹XWikiçš„æ¼æ´žåˆ©ç”¨è„šæœ¬ï¼Œä¸ŽCVE-2024-32019æ¼æ´žæè¿°ä¸ç¬¦ã€‚å› æ­¤ï¼Œæä¾›çš„ä»£ç **ä¸èƒ½**ç›´æŽ¥ç”¨äºŽåˆ©ç”¨CVE-2024-32019ã€‚

**æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼š**
ç”±äºŽåªæä¾›äº†`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`å’Œ`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»…ä»Žè¿™ä¸¤ä¸ªæ–‡ä»¶æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ä»£ç ã€‚`exploitXWiki.py` æœ¬èº«æ˜¯æ¼æ´žåˆ©ç”¨ä»£ç ï¼Œå¹¶éžæ¶æ„åŽé—¨ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žï¼Œé£Žé™©æ¦‚çŽ‡ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**æ¥æº**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> ðŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-localæƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´rootæƒé™èŽ·å–

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯netdataä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚è¯¥æ¼æ´žæ˜¯ç”±äºŽndsudoä»¥rootæƒé™è¿è¡Œï¼Œå¹¶ä¸”å…¶æœç´¢è·¯å¾„å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æŒ‡å‘æ¶æ„ç¨‹åºçš„è·¯å¾„æ·»åŠ åˆ°ndsudoçš„æœç´¢è·¯å¾„ä¸­ï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æå‡æƒé™çš„ä»£ç ã€‚
2.  æ”»å‡»è€…ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•æ·»åŠ åˆ°PATHä¸­ã€‚
3.  æ”»å‡»è€…è§¦å‘ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç”±äºŽPATHè¢«ä¿®æ”¹ï¼Œndsudoä¼šæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
4.  æ”»å‡»è€…èŽ·å¾—rootæƒé™ã€‚

æ ¹æ®æä¾›çš„æ¼æ´žåˆ©ç”¨ä»£ç `/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`ï¼Œè¯¥ä»£ç å®žé™…ä¸Šæ˜¯é’ˆå¯¹XWikiçš„æ¼æ´žåˆ©ç”¨è„šæœ¬ï¼Œä¸ŽCVE-2024-32019æ¼æ´žæè¿°ä¸ç¬¦ã€‚å› æ­¤ï¼Œæä¾›çš„ä»£ç **ä¸èƒ½**ç›´æŽ¥ç”¨äºŽåˆ©ç”¨CVE-2024-32019ã€‚

**æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼š**
ç”±äºŽåªæä¾›äº†`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`å’Œ`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»…ä»Žè¿™ä¸¤ä¸ªæ–‡ä»¶æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ä»£ç ã€‚`exploitXWiki.py` æœ¬èº«æ˜¯æ¼æ´žåˆ©ç”¨ä»£ç ï¼Œå¹¶éžæ¶æ„åŽé—¨ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žï¼Œé£Žé™©æ¦‚çŽ‡ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**æ¥æº**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> ðŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-localæƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´rootæƒé™èŽ·å–

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯netdataä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚è¯¥æ¼æ´žæ˜¯ç”±äºŽndsudoä»¥rootæƒé™è¿è¡Œï¼Œå¹¶ä¸”å…¶æœç´¢è·¯å¾„å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æŒ‡å‘æ¶æ„ç¨‹åºçš„è·¯å¾„æ·»åŠ åˆ°ndsudoçš„æœç´¢è·¯å¾„ä¸­ï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æå‡æƒé™çš„ä»£ç ã€‚
2.  æ”»å‡»è€…ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•æ·»åŠ åˆ°PATHä¸­ã€‚
3.  æ”»å‡»è€…è§¦å‘ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç”±äºŽPATHè¢«ä¿®æ”¹ï¼Œndsudoä¼šæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
4.  æ”»å‡»è€…èŽ·å¾—rootæƒé™ã€‚

æ ¹æ®æä¾›çš„æ¼æ´žåˆ©ç”¨ä»£ç `/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`ï¼Œè¯¥ä»£ç å®žé™…ä¸Šæ˜¯é’ˆå¯¹XWikiçš„æ¼æ´žåˆ©ç”¨è„šæœ¬ï¼Œä¸ŽCVE-2024-32019æ¼æ´žæè¿°ä¸ç¬¦ã€‚å› æ­¤ï¼Œæä¾›çš„ä»£ç **ä¸èƒ½**ç›´æŽ¥ç”¨äºŽåˆ©ç”¨CVE-2024-32019ã€‚

**æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼š**
ç”±äºŽåªæä¾›äº†`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`å’Œ`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»…ä»Žè¿™ä¸¤ä¸ªæ–‡ä»¶æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ä»£ç ã€‚`exploitXWiki.py` æœ¬èº«æ˜¯æ¼æ´žåˆ©ç”¨ä»£ç ï¼Œå¹¶éžæ¶æ„åŽé—¨ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žï¼Œé£Žé™©æ¦‚çŽ‡ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**æ¥æº**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> ðŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-localæƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´rootæƒé™èŽ·å–

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯netdataä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚è¯¥æ¼æ´žæ˜¯ç”±äºŽndsudoä»¥rootæƒé™è¿è¡Œï¼Œå¹¶ä¸”å…¶æœç´¢è·¯å¾„å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æŒ‡å‘æ¶æ„ç¨‹åºçš„è·¯å¾„æ·»åŠ åˆ°ndsudoçš„æœç´¢è·¯å¾„ä¸­ï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æå‡æƒé™çš„ä»£ç ã€‚
2.  æ”»å‡»è€…ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•æ·»åŠ åˆ°PATHä¸­ã€‚
3.  æ”»å‡»è€…è§¦å‘ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç”±äºŽPATHè¢«ä¿®æ”¹ï¼Œndsudoä¼šæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
4.  æ”»å‡»è€…èŽ·å¾—rootæƒé™ã€‚

æ ¹æ®æä¾›çš„æ¼æ´žåˆ©ç”¨ä»£ç `/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`ï¼Œè¯¥ä»£ç å®žé™…ä¸Šæ˜¯é’ˆå¯¹XWikiçš„æ¼æ´žåˆ©ç”¨è„šæœ¬ï¼Œä¸ŽCVE-2024-32019æ¼æ´žæè¿°ä¸ç¬¦ã€‚å› æ­¤ï¼Œæä¾›çš„ä»£ç **ä¸èƒ½**ç›´æŽ¥ç”¨äºŽåˆ©ç”¨CVE-2024-32019ã€‚

**æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼š**
ç”±äºŽåªæä¾›äº†`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`å’Œ`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»…ä»Žè¿™ä¸¤ä¸ªæ–‡ä»¶æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ä»£ç ã€‚`exploitXWiki.py` æœ¬èº«æ˜¯æ¼æ´žåˆ©ç”¨ä»£ç ï¼Œå¹¶éžæ¶æ„åŽé—¨ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žï¼Œé£Žé™©æ¦‚çŽ‡ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**æ¥æº**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> ðŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-localæƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´rootæƒé™èŽ·å–

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯netdataä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚è¯¥æ¼æ´žæ˜¯ç”±äºŽndsudoä»¥rootæƒé™è¿è¡Œï¼Œå¹¶ä¸”å…¶æœç´¢è·¯å¾„å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æŒ‡å‘æ¶æ„ç¨‹åºçš„è·¯å¾„æ·»åŠ åˆ°ndsudoçš„æœç´¢è·¯å¾„ä¸­ï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æå‡æƒé™çš„ä»£ç ã€‚
2.  æ”»å‡»è€…ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•æ·»åŠ åˆ°PATHä¸­ã€‚
3.  æ”»å‡»è€…è§¦å‘ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç”±äºŽPATHè¢«ä¿®æ”¹ï¼Œndsudoä¼šæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
4.  æ”»å‡»è€…èŽ·å¾—rootæƒé™ã€‚

æ ¹æ®æä¾›çš„æ¼æ´žåˆ©ç”¨ä»£ç `/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`ï¼Œè¯¥ä»£ç å®žé™…ä¸Šæ˜¯é’ˆå¯¹XWikiçš„æ¼æ´žåˆ©ç”¨è„šæœ¬ï¼Œä¸ŽCVE-2024-32019æ¼æ´žæè¿°ä¸ç¬¦ã€‚å› æ­¤ï¼Œæä¾›çš„ä»£ç **ä¸èƒ½**ç›´æŽ¥ç”¨äºŽåˆ©ç”¨CVE-2024-32019ã€‚

**æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼š**
ç”±äºŽåªæä¾›äº†`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`å’Œ`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»…ä»Žè¿™ä¸¤ä¸ªæ–‡ä»¶æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ä»£ç ã€‚`exploitXWiki.py` æœ¬èº«æ˜¯æ¼æ´žåˆ©ç”¨ä»£ç ï¼Œå¹¶éžæ¶æ„åŽé—¨ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žï¼Œé£Žé™©æ¦‚çŽ‡ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**æ¥æº**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> ðŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-localæƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´rootæƒé™èŽ·å–

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯netdataä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚è¯¥æ¼æ´žæ˜¯ç”±äºŽndsudoä»¥rootæƒé™è¿è¡Œï¼Œå¹¶ä¸”å…¶æœç´¢è·¯å¾„å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æŒ‡å‘æ¶æ„ç¨‹åºçš„è·¯å¾„æ·»åŠ åˆ°ndsudoçš„æœç´¢è·¯å¾„ä¸­ï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æå‡æƒé™çš„ä»£ç ã€‚
2.  æ”»å‡»è€…ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•æ·»åŠ åˆ°PATHä¸­ã€‚
3.  æ”»å‡»è€…è§¦å‘ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç”±äºŽPATHè¢«ä¿®æ”¹ï¼Œndsudoä¼šæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
4.  æ”»å‡»è€…èŽ·å¾—rootæƒé™ã€‚

æ ¹æ®æä¾›çš„æ¼æ´žåˆ©ç”¨ä»£ç `/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`ï¼Œè¯¥ä»£ç å®žé™…ä¸Šæ˜¯é’ˆå¯¹XWikiçš„æ¼æ´žåˆ©ç”¨è„šæœ¬ï¼Œä¸ŽCVE-2024-32019æ¼æ´žæè¿°ä¸ç¬¦ã€‚å› æ­¤ï¼Œæä¾›çš„ä»£ç **ä¸èƒ½**ç›´æŽ¥ç”¨äºŽåˆ©ç”¨CVE-2024-32019ã€‚

**æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼š**
ç”±äºŽåªæä¾›äº†`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`å’Œ`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»…ä»Žè¿™ä¸¤ä¸ªæ–‡ä»¶æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ä»£ç ã€‚`exploitXWiki.py` æœ¬èº«æ˜¯æ¼æ´žåˆ©ç”¨ä»£ç ï¼Œå¹¶éžæ¶æ„åŽé—¨ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žï¼Œé£Žé™©æ¦‚çŽ‡ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**æ¥æº**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> ðŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-localæƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´rootæƒé™èŽ·å–

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯netdataä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚è¯¥æ¼æ´žæ˜¯ç”±äºŽndsudoä»¥rootæƒé™è¿è¡Œï¼Œå¹¶ä¸”å…¶æœç´¢è·¯å¾„å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æŒ‡å‘æ¶æ„ç¨‹åºçš„è·¯å¾„æ·»åŠ åˆ°ndsudoçš„æœç´¢è·¯å¾„ä¸­ï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æå‡æƒé™çš„ä»£ç ã€‚
2.  æ”»å‡»è€…ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•æ·»åŠ åˆ°PATHä¸­ã€‚
3.  æ”»å‡»è€…è§¦å‘ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç”±äºŽPATHè¢«ä¿®æ”¹ï¼Œndsudoä¼šæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
4.  æ”»å‡»è€…èŽ·å¾—rootæƒé™ã€‚

æ ¹æ®æä¾›çš„æ¼æ´žåˆ©ç”¨ä»£ç `/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`ï¼Œè¯¥ä»£ç å®žé™…ä¸Šæ˜¯é’ˆå¯¹XWikiçš„æ¼æ´žåˆ©ç”¨è„šæœ¬ï¼Œä¸ŽCVE-2024-32019æ¼æ´žæè¿°ä¸ç¬¦ã€‚å› æ­¤ï¼Œæä¾›çš„ä»£ç **ä¸èƒ½**ç›´æŽ¥ç”¨äºŽåˆ©ç”¨CVE-2024-32019ã€‚

**æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼š**
ç”±äºŽåªæä¾›äº†`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`å’Œ`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»…ä»Žè¿™ä¸¤ä¸ªæ–‡ä»¶æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ä»£ç ã€‚`exploitXWiki.py` æœ¬èº«æ˜¯æ¼æ´žåˆ©ç”¨ä»£ç ï¼Œå¹¶éžæ¶æ„åŽé—¨ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žï¼Œé£Žé™©æ¦‚çŽ‡ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**æ¥æº**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> ðŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-localæƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´rootæƒé™èŽ·å–

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯netdataä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚è¯¥æ¼æ´žæ˜¯ç”±äºŽndsudoä»¥rootæƒé™è¿è¡Œï¼Œå¹¶ä¸”å…¶æœç´¢è·¯å¾„å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æŒ‡å‘æ¶æ„ç¨‹åºçš„è·¯å¾„æ·»åŠ åˆ°ndsudoçš„æœç´¢è·¯å¾„ä¸­ï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æå‡æƒé™çš„ä»£ç ã€‚
2.  æ”»å‡»è€…ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•æ·»åŠ åˆ°PATHä¸­ã€‚
3.  æ”»å‡»è€…è§¦å‘ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç”±äºŽPATHè¢«ä¿®æ”¹ï¼Œndsudoä¼šæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
4.  æ”»å‡»è€…èŽ·å¾—rootæƒé™ã€‚

æ ¹æ®æä¾›çš„æ¼æ´žåˆ©ç”¨ä»£ç `/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`ï¼Œè¯¥ä»£ç å®žé™…ä¸Šæ˜¯é’ˆå¯¹XWikiçš„æ¼æ´žåˆ©ç”¨è„šæœ¬ï¼Œä¸ŽCVE-2024-32019æ¼æ´žæè¿°ä¸ç¬¦ã€‚å› æ­¤ï¼Œæä¾›çš„ä»£ç **ä¸èƒ½**ç›´æŽ¥ç”¨äºŽåˆ©ç”¨CVE-2024-32019ã€‚

**æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼š**
ç”±äºŽåªæä¾›äº†`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`å’Œ`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»…ä»Žè¿™ä¸¤ä¸ªæ–‡ä»¶æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ä»£ç ã€‚`exploitXWiki.py` æœ¬èº«æ˜¯æ¼æ´žåˆ©ç”¨ä»£ç ï¼Œå¹¶éžæ¶æ„åŽé—¨ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žï¼Œé£Žé™©æ¦‚çŽ‡ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**æ¥æº**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> ðŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-localæƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´rootæƒé™èŽ·å–

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯netdataä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚è¯¥æ¼æ´žæ˜¯ç”±äºŽndsudoä»¥rootæƒé™è¿è¡Œï¼Œå¹¶ä¸”å…¶æœç´¢è·¯å¾„å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æŒ‡å‘æ¶æ„ç¨‹åºçš„è·¯å¾„æ·»åŠ åˆ°ndsudoçš„æœç´¢è·¯å¾„ä¸­ï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æå‡æƒé™çš„ä»£ç ã€‚
2.  æ”»å‡»è€…ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•æ·»åŠ åˆ°PATHä¸­ã€‚
3.  æ”»å‡»è€…è§¦å‘ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç”±äºŽPATHè¢«ä¿®æ”¹ï¼Œndsudoä¼šæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
4.  æ”»å‡»è€…èŽ·å¾—rootæƒé™ã€‚

æ ¹æ®æä¾›çš„æ¼æ´žåˆ©ç”¨ä»£ç `/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`ï¼Œè¯¥ä»£ç å®žé™…ä¸Šæ˜¯é’ˆå¯¹XWikiçš„æ¼æ´žåˆ©ç”¨è„šæœ¬ï¼Œä¸ŽCVE-2024-32019æ¼æ´žæè¿°ä¸ç¬¦ã€‚å› æ­¤ï¼Œæä¾›çš„ä»£ç **ä¸èƒ½**ç›´æŽ¥ç”¨äºŽåˆ©ç”¨CVE-2024-32019ã€‚

**æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼š**
ç”±äºŽåªæä¾›äº†`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`å’Œ`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»…ä»Žè¿™ä¸¤ä¸ªæ–‡ä»¶æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ä»£ç ã€‚`exploitXWiki.py` æœ¬èº«æ˜¯æ¼æ´žåˆ©ç”¨ä»£ç ï¼Œå¹¶éžæ¶æ„åŽé—¨ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žï¼Œé£Žé™©æ¦‚çŽ‡ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**æ¥æº**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> ðŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-localæƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´rootæƒé™èŽ·å–

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯netdataä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚è¯¥æ¼æ´žæ˜¯ç”±äºŽndsudoä»¥rootæƒé™è¿è¡Œï¼Œå¹¶ä¸”å…¶æœç´¢è·¯å¾„å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æŒ‡å‘æ¶æ„ç¨‹åºçš„è·¯å¾„æ·»åŠ åˆ°ndsudoçš„æœç´¢è·¯å¾„ä¸­ï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æå‡æƒé™çš„ä»£ç ã€‚
2.  æ”»å‡»è€…ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•æ·»åŠ åˆ°PATHä¸­ã€‚
3.  æ”»å‡»è€…è§¦å‘ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç”±äºŽPATHè¢«ä¿®æ”¹ï¼Œndsudoä¼šæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
4.  æ”»å‡»è€…èŽ·å¾—rootæƒé™ã€‚

æ ¹æ®æä¾›çš„æ¼æ´žåˆ©ç”¨ä»£ç `/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`ï¼Œè¯¥ä»£ç å®žé™…ä¸Šæ˜¯é’ˆå¯¹XWikiçš„æ¼æ´žåˆ©ç”¨è„šæœ¬ï¼Œä¸ŽCVE-2024-32019æ¼æ´žæè¿°ä¸ç¬¦ã€‚å› æ­¤ï¼Œæä¾›çš„ä»£ç **ä¸èƒ½**ç›´æŽ¥ç”¨äºŽåˆ©ç”¨CVE-2024-32019ã€‚

**æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼š**
ç”±äºŽåªæä¾›äº†`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`å’Œ`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»…ä»Žè¿™ä¸¤ä¸ªæ–‡ä»¶æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ä»£ç ã€‚`exploitXWiki.py` æœ¬èº«æ˜¯æ¼æ´žåˆ©ç”¨ä»£ç ï¼Œå¹¶éžæ¶æ„åŽé—¨ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žï¼Œé£Žé™©æ¦‚çŽ‡ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**æ¥æº**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> ðŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-localæƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´rootæƒé™èŽ·å–

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯netdataä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚è¯¥æ¼æ´žæ˜¯ç”±äºŽndsudoä»¥rootæƒé™è¿è¡Œï¼Œå¹¶ä¸”å…¶æœç´¢è·¯å¾„å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æŒ‡å‘æ¶æ„ç¨‹åºçš„è·¯å¾„æ·»åŠ åˆ°ndsudoçš„æœç´¢è·¯å¾„ä¸­ï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æå‡æƒé™çš„ä»£ç ã€‚
2.  æ”»å‡»è€…ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•æ·»åŠ åˆ°PATHä¸­ã€‚
3.  æ”»å‡»è€…è§¦å‘ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç”±äºŽPATHè¢«ä¿®æ”¹ï¼Œndsudoä¼šæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
4.  æ”»å‡»è€…èŽ·å¾—rootæƒé™ã€‚

æ ¹æ®æä¾›çš„æ¼æ´žåˆ©ç”¨ä»£ç `/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`ï¼Œè¯¥ä»£ç å®žé™…ä¸Šæ˜¯é’ˆå¯¹XWikiçš„æ¼æ´žåˆ©ç”¨è„šæœ¬ï¼Œä¸ŽCVE-2024-32019æ¼æ´žæè¿°ä¸ç¬¦ã€‚å› æ­¤ï¼Œæä¾›çš„ä»£ç **ä¸èƒ½**ç›´æŽ¥ç”¨äºŽåˆ©ç”¨CVE-2024-32019ã€‚

**æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼š**
ç”±äºŽåªæä¾›äº†`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`å’Œ`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»…ä»Žè¿™ä¸¤ä¸ªæ–‡ä»¶æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ä»£ç ã€‚`exploitXWiki.py` æœ¬èº«æ˜¯æ¼æ´žåˆ©ç”¨ä»£ç ï¼Œå¹¶éžæ¶æ„åŽé—¨ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žï¼Œé£Žé™©æ¦‚çŽ‡ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**æ¥æº**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> ðŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-localæƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´rootæƒé™èŽ·å–

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯netdataä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚è¯¥æ¼æ´žæ˜¯ç”±äºŽndsudoä»¥rootæƒé™è¿è¡Œï¼Œå¹¶ä¸”å…¶æœç´¢è·¯å¾„å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æŒ‡å‘æ¶æ„ç¨‹åºçš„è·¯å¾„æ·»åŠ åˆ°ndsudoçš„æœç´¢è·¯å¾„ä¸­ï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æå‡æƒé™çš„ä»£ç ã€‚
2.  æ”»å‡»è€…ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•æ·»åŠ åˆ°PATHä¸­ã€‚
3.  æ”»å‡»è€…è§¦å‘ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç”±äºŽPATHè¢«ä¿®æ”¹ï¼Œndsudoä¼šæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
4.  æ”»å‡»è€…èŽ·å¾—rootæƒé™ã€‚

æ ¹æ®æä¾›çš„æ¼æ´žåˆ©ç”¨ä»£ç `/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`ï¼Œè¯¥ä»£ç å®žé™…ä¸Šæ˜¯é’ˆå¯¹XWikiçš„æ¼æ´žåˆ©ç”¨è„šæœ¬ï¼Œä¸ŽCVE-2024-32019æ¼æ´žæè¿°ä¸ç¬¦ã€‚å› æ­¤ï¼Œæä¾›çš„ä»£ç **ä¸èƒ½**ç›´æŽ¥ç”¨äºŽåˆ©ç”¨CVE-2024-32019ã€‚

**æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼š**
ç”±äºŽåªæä¾›äº†`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`å’Œ`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»…ä»Žè¿™ä¸¤ä¸ªæ–‡ä»¶æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ä»£ç ã€‚`exploitXWiki.py` æœ¬èº«æ˜¯æ¼æ´žåˆ©ç”¨ä»£ç ï¼Œå¹¶éžæ¶æ„åŽé—¨ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žï¼Œé£Žé™©æ¦‚çŽ‡ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**æ¥æº**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> ðŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-localæƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´rootæƒé™èŽ·å–

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯netdataä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚è¯¥æ¼æ´žæ˜¯ç”±äºŽndsudoä»¥rootæƒé™è¿è¡Œï¼Œå¹¶ä¸”å…¶æœç´¢è·¯å¾„å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æŒ‡å‘æ¶æ„ç¨‹åºçš„è·¯å¾„æ·»åŠ åˆ°ndsudoçš„æœç´¢è·¯å¾„ä¸­ï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æå‡æƒé™çš„ä»£ç ã€‚
2.  æ”»å‡»è€…ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•æ·»åŠ åˆ°PATHä¸­ã€‚
3.  æ”»å‡»è€…è§¦å‘ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç”±äºŽPATHè¢«ä¿®æ”¹ï¼Œndsudoä¼šæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
4.  æ”»å‡»è€…èŽ·å¾—rootæƒé™ã€‚

æ ¹æ®æä¾›çš„æ¼æ´žåˆ©ç”¨ä»£ç `/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`ï¼Œè¯¥ä»£ç å®žé™…ä¸Šæ˜¯é’ˆå¯¹XWikiçš„æ¼æ´žåˆ©ç”¨è„šæœ¬ï¼Œä¸ŽCVE-2024-32019æ¼æ´žæè¿°ä¸ç¬¦ã€‚å› æ­¤ï¼Œæä¾›çš„ä»£ç **ä¸èƒ½**ç›´æŽ¥ç”¨äºŽåˆ©ç”¨CVE-2024-32019ã€‚

**æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼š**
ç”±äºŽåªæä¾›äº†`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`å’Œ`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»…ä»Žè¿™ä¸¤ä¸ªæ–‡ä»¶æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ä»£ç ã€‚`exploitXWiki.py` æœ¬èº«æ˜¯æ¼æ´žåˆ©ç”¨ä»£ç ï¼Œå¹¶éžæ¶æ„åŽé—¨ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žï¼Œé£Žé™©æ¦‚çŽ‡ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**æ¥æº**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> ðŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-localæƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´rootæƒé™èŽ·å–

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯netdataä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚è¯¥æ¼æ´žæ˜¯ç”±äºŽndsudoä»¥rootæƒé™è¿è¡Œï¼Œå¹¶ä¸”å…¶æœç´¢è·¯å¾„å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æŒ‡å‘æ¶æ„ç¨‹åºçš„è·¯å¾„æ·»åŠ åˆ°ndsudoçš„æœç´¢è·¯å¾„ä¸­ï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æå‡æƒé™çš„ä»£ç ã€‚
2.  æ”»å‡»è€…ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•æ·»åŠ åˆ°PATHä¸­ã€‚
3.  æ”»å‡»è€…è§¦å‘ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç”±äºŽPATHè¢«ä¿®æ”¹ï¼Œndsudoä¼šæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
4.  æ”»å‡»è€…èŽ·å¾—rootæƒé™ã€‚

æ ¹æ®æä¾›çš„æ¼æ´žåˆ©ç”¨ä»£ç `/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`ï¼Œè¯¥ä»£ç å®žé™…ä¸Šæ˜¯é’ˆå¯¹XWikiçš„æ¼æ´žåˆ©ç”¨è„šæœ¬ï¼Œä¸ŽCVE-2024-32019æ¼æ´žæè¿°ä¸ç¬¦ã€‚å› æ­¤ï¼Œæä¾›çš„ä»£ç **ä¸èƒ½**ç›´æŽ¥ç”¨äºŽåˆ©ç”¨CVE-2024-32019ã€‚

**æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼š**
ç”±äºŽåªæä¾›äº†`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`å’Œ`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»…ä»Žè¿™ä¸¤ä¸ªæ–‡ä»¶æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ä»£ç ã€‚`exploitXWiki.py` æœ¬èº«æ˜¯æ¼æ´žåˆ©ç”¨ä»£ç ï¼Œå¹¶éžæ¶æ„åŽé—¨ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žï¼Œé£Žé™©æ¦‚çŽ‡ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**æ¥æº**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> ðŸ“¦ è¯¥CVEæœ‰ **9** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-localæƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´rootæƒé™èŽ·å–

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯netdataä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚è¯¥æ¼æ´žæ˜¯ç”±äºŽndsudoä»¥rootæƒé™è¿è¡Œï¼Œå¹¶ä¸”å…¶æœç´¢è·¯å¾„å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æŒ‡å‘æ¶æ„ç¨‹åºçš„è·¯å¾„æ·»åŠ åˆ°ndsudoçš„æœç´¢è·¯å¾„ä¸­ï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æå‡æƒé™çš„ä»£ç ã€‚
2.  æ”»å‡»è€…ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•æ·»åŠ åˆ°PATHä¸­ã€‚
3.  æ”»å‡»è€…è§¦å‘ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç”±äºŽPATHè¢«ä¿®æ”¹ï¼Œndsudoä¼šæ‰§è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
4.  æ”»å‡»è€…èŽ·å¾—rootæƒé™ã€‚

æ ¹æ®æä¾›çš„æ¼æ´žåˆ©ç”¨ä»£ç `/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`ï¼Œè¯¥ä»£ç å®žé™…ä¸Šæ˜¯é’ˆå¯¹XWikiçš„æ¼æ´žåˆ©ç”¨è„šæœ¬ï¼Œä¸ŽCVE-2024-32019æ¼æ´žæè¿°ä¸ç¬¦ã€‚å› æ­¤ï¼Œæä¾›çš„ä»£ç **ä¸èƒ½**ç›´æŽ¥ç”¨äºŽåˆ©ç”¨CVE-2024-32019ã€‚

**æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼š**
ç”±äºŽåªæä¾›äº†`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`å’Œ`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»…ä»Žè¿™ä¸¤ä¸ªæ–‡ä»¶æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ä»£ç ã€‚`exploitXWiki.py` æœ¬èº«æ˜¯æ¼æ´žåˆ©ç”¨ä»£ç ï¼Œå¹¶éžæ¶æ„åŽé—¨ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žï¼Œé£Žé™©æ¦‚çŽ‡ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**æ¥æº**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯æå‡è‡³rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 åŠ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”å…·æœ‰æœ¬åœ°shellè®¿é—®æƒé™ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 å­˜åœ¨äºŽNetdataçš„`ndsudo`å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·æ˜¯å…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¼æ´žåŽŸå› æ˜¯`ndsudo`çš„æœç´¢è·¯å¾„ç”±`PATH`çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨å‰é¢ï¼Œå½“`ndsudo`æ‰§è¡Œä¿¡ä»»çš„å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œå®žçŽ°æœ¬åœ°ææƒã€‚æä¾›çš„POCä»£ç é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´žï¼š

1.  **ç¼–è¯‘æ¶æ„payload:**  `poc.c` ç¼–è¯‘æˆ `nvme`ï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯æ‰§è¡Œ `/bin/bash`ï¼Œå¹¶è®¾ç½® UID å’Œ GID ä¸º 0ï¼Œå³rootæƒé™ã€‚
2.  **ä¼ è¾“payloadåˆ°ç›®æ ‡ç³»ç»Ÿ:**  å°†ç¼–è¯‘å¥½çš„`nvme`ä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„`/tmp`ç›®å½•ã€‚
3.  **å‡†å¤‡payloadæ‰§è¡Œ:**  ç»™`/tmp/nvme`æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽå°†`/tmp`æ·»åŠ åˆ°`PATH`çŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ã€‚
4.  **è§¦å‘`ndsudo`æ‰§è¡Œpayload:** è¿è¡Œ`./ndsudo nvme-list`ï¼Œ`ndsudo`ä¼šæ‰§è¡Œ`/tmp/nvme`ï¼Œç”±äºŽè¯¥ç¨‹åºä¼šå°†æƒé™æå‡ä¸ºrootï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥èŽ·å¾—root shellã€‚

**æœ‰æ•ˆæ€§ï¼š** è¯¥POCä»£ç æè¿°çš„åˆ©ç”¨æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„`poc.c`ä»£ç åŠŸèƒ½æ¸…æ™°ï¼Œä»…ä¸ºæ‰§è¡Œ`/bin/bash`å¹¶æå‡æƒé™ï¼Œä¸å­˜åœ¨éšè—çš„æŠ•æ¯’ä»£ç ã€‚READMEæ–‡ä»¶æè¿°äº†å®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`PATH`çŽ¯å¢ƒå˜é‡ï¼Œæ¬ºéª—`ndsudo`æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #3

**æ¥æº**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦netdata agentå­˜åœ¨æ¼æ´žç‰ˆæœ¬ä¸”ndsudoè¢«è°ƒç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata Agentä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªrootç”¨æˆ·æ‹¥æœ‰çš„ã€è®¾ç½®äº†SUIDä½çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒæœ¬åº”åªè¿è¡Œä¸€ç»„å—é™çš„å¤–éƒ¨å‘½ä»¤ï¼Œä½†æ˜¯å…¶æœç´¢è·¯å¾„ç”±PATHçŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æŒ‡å®šndsudoæŸ¥æ‰¾è¿™äº›å‘½ä»¤çš„ä½ç½®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯æ”»å‡»è€…å…·æœ‰å†™æƒé™çš„ç›®å½•ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ”¾ç½®æ¶æ„ç¨‹åºå¹¶ä»¥rootæƒé™æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´žæè¿°å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žå­˜åœ¨åˆ©ç”¨ä»·å€¼ï¼Œé€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æ‰§è¡Œæ¶æ„ç¨‹åºè¾¾åˆ°ææƒæ•ˆæžœã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„ä»£ç ä»…ä¸ºGNU GENERAL PUBLIC LICENSEï¼Œæ˜¯å¼€æºåè®®è®¸å¯ï¼Œä¸åŒ…å«ç›´æŽ¥çš„æ”»å‡»payloadæˆ–æ¶æ„ä»£ç ã€‚ä½†licenseæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ä»£ç ï¼Œå¦‚æžœç»“åˆç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œåè®®å†…å®¹ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åˆ›å»ºä¸€ä¸ªåˆæ³•çš„ç¨‹åºï¼Œä½†å…¶è¡Œä¸ºè¿åäº†åè®®æ¡æ¬¾ï¼Œä»Žè€Œé€ æˆæŸå®³ã€‚æ­¤ä»“åº“ä¸­å‘çŽ°ç›´æŽ¥æŠ•æ¯’ä»£ç çš„æ¦‚çŽ‡è¾ƒä½Žï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æ»¥ç”¨é£Žé™©ï¼Œä¼°è®¡æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„Netdata Agentç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 1.44.0-60, < 1.45.3ï¼‰ã€‚
2.  æŸ¥æ‰¾ndsudoå·¥å…·çš„ä½ç½®ã€‚
3.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å‘½ä»¤çš„ç›®å½•ï¼Œä¾‹å¦‚/tmp/evilã€‚
4.  å°†æ¶æ„ç¨‹åºï¼ˆå¦‚åå¼¹shellï¼‰æ”¾ç½®åˆ°/tmp/evilç›®å½•ä¸‹ï¼Œå¹¶å‘½åä¸ºndsudoå°è¯•æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œ`ping`ï¼Œ`date` ç­‰, å…·ä½“å–å†³äºŽ ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼‰ã€‚
5.  ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†/tmp/evilæ·»åŠ åˆ°PATHçš„æœ€å‰é¢ï¼š`export PATH=/tmp/evil:$PATH`ã€‚
6.  è¿è¡Œndsudoï¼Œå®ƒå°†æ‰§è¡Œ/tmp/evilç›®å½•ä¸‹çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**æ¥æº**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡PATHåŠ«æŒæ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata Agentå­˜åœ¨ndsudoï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠå¯æŽ§çš„PATHçŽ¯å¢ƒå˜é‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdataä¸­`ndsudo`å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´žã€‚`ndsudo`æ˜¯ä¸€ä¸ªå…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨`PATH`çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨`PATH`çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆäºŽç³»ç»Ÿç›®å½•çš„ä½ç½®ï¼Œè¯±ä½¿`ndsudo`æ‰§è¡Œè¯¥æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**
1.  æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„`ndsudo`å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶(ä¾‹å¦‚`nvme`)ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œæ”»å‡»è€…å¸Œæœ›æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚æä¾›çš„`payload.c`æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªroot shellã€‚
3.  ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†å½“å‰ç›®å½•(æˆ–åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•)æ·»åŠ åˆ°`PATH`çš„å¼€å¤´ã€‚
4.  è°ƒç”¨`ndsudo`ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ƒå…è®¸æ‰§è¡Œçš„å‘½ä»¤(ä¾‹å¦‚`nvme-list`)ã€‚ç”±äºŽ`PATH`å·²ç»è¢«ä¿®æ”¹ï¼Œ`ndsudo`ä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„`nvme`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»Žè€Œä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºŽæŸ¥æ‰¾`ndsudo`ï¼Œåˆ›å»ºä¸€ä¸ª`nvme` payloadï¼Œä¿®æ”¹`PATH`ï¼Œç„¶åŽæ‰§è¡Œ`ndsudo`ã€‚README.mdæ–‡ä»¶æè¿°äº†å¦‚ä½•ç¼–è¯‘`payload.c`å¹¶ä½¿ç”¨è„šæœ¬ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
æŸ¥çœ‹äº†æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ²¡æœ‰å‘çŽ°ä»»ä½•æŠ•æ¯’ä»£ç ã€‚å…¶ä¸­ï¼ŒCVE-2024-32019.shè„šæœ¬ç”¨äºŽåˆ©ç”¨æ¼æ´žï¼Œpayload.cç”¨äºŽç¼–è¯‘æ¶æ„payloadï¼ŒREADME.mdæ–‡ä»¶æè¿°äº†æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ï¼Œéƒ½æ˜¯æ­£å¸¸çš„åˆ©ç”¨ä»£ç ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**æ¥æº**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata ndsudoå·¥å…·ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªSUID rootçš„ç¨‹åºï¼Œä½†å®ƒä½¿ç”¨äº†PATHçŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡æŒ‡å‘ä¸€ä¸ªè‡ªå·±å¯æŽ§çš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹æ”¾ç½®æ¶æ„ç¨‹åºï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žæ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ£€æŸ¥ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨`/opt`ç›®å½•ä¸‹çš„`ndsudo`ç¨‹åºï¼Œå¹¶ä¸”ç¡®è®¤è¯¥ç¨‹åºæ˜¯å¦ä¸ºrootæ‰€æœ‰ä¸”è®¾ç½®äº†SUIDæƒé™ã€‚åŒæ—¶ï¼Œä½¿ç”¨`strings`å‘½ä»¤æ£€æŸ¥`ndsudo`ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨å¯¹`nvme`ã€`smartctl`ã€`hdparm`æˆ–`sensors`ç­‰å¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¯´æ˜Žè¯¥ç¨‹åºå¯èƒ½å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚
2.  **æ¶æ„ç¨‹åºç¼–è¯‘ï¼š** ç¼–è¯‘ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯è®¾ç½®UIDå’ŒGIDä¸º0ï¼Œç„¶åŽæ‰§è¡Œ`/bin/bash`ï¼Œä»Žè€ŒèŽ·å–root shellã€‚
3.  **æ¶æ„ç¨‹åºä¸Šä¼ ï¼š** é€šè¿‡SFTPå°†ç¼–è¯‘å¥½çš„æ¶æ„ç¨‹åºä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæ”»å‡»è€…å¯æŽ§çš„ç›®å½•ï¼Œä¾‹å¦‚`/tmp`ã€‚
4.  **çŽ¯å¢ƒå˜é‡ä¿®æ”¹ï¼š** ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æ”»å‡»è€…å¯æŽ§çš„ç›®å½•æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ï¼Œç¡®ä¿`ndsudo`ç¨‹åºåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶é¦–å…ˆåœ¨è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ã€‚
5.  **æ¼æ´žè§¦å‘ï¼š** æ‰§è¡Œ`ndsudo`ç¨‹åºï¼Œå½“å®ƒè°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…ä¸Šä¼ çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å–rootæƒé™ã€‚
6.  **äº¤äº’å¼Shellï¼š** æ¼æ´žåˆ©ç”¨ä»£ç æä¾›äº¤äº’å¼shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æ­¤POCä»£ç æœ¬èº«ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œå®žçŽ°æœ¬åœ°ææƒã€‚ä½†æ˜¯ï¼Œè¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ï¼š

*   **ç¼–è¯‘å’Œä¼ è¾“æ¶æ„ä»£ç ï¼š** è„šæœ¬ä¼šè‡ªåŠ¨ç¼–è¯‘Cä»£ç ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚è™½ç„¶Cä»£ç çš„å†…å®¹æ˜¯ææƒï¼Œä½†å¦‚æžœæ¶æ„æ”»å‡»è€…ä¿®æ”¹äº†Cä»£ç ï¼Œå°±å¯èƒ½åŒ…å«å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åŽé—¨ã€æ”¶é›†ä¿¡æ¯ç­‰ã€‚
*   **è¿œç¨‹æ‰§è¡Œä»£ç ï¼š**  è„šæœ¬é€šè¿‡sshæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£Žé™©ï¼Œå¯èƒ½æ‰§è¡Œé¢å¤–çš„æ¶æ„æ“ä½œã€‚
*   **æ®‹ç•™æ–‡ä»¶ï¼š** ç¼–è¯‘åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸Šä¼ çš„æ¶æ„ç¨‹åºå¯èƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç•™ä¸‹ç—•è¿¹ï¼Œå¦‚æžœè¿™äº›æ–‡ä»¶è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å®‰å…¨é—®é¢˜ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é£Žé™©ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œè¯¥POCä»£ç çš„é£Žé™©ä»ç„¶å¯æŽ§ï¼Œä¸»è¦é£Žé™©é›†ä¸­åœ¨ä»£ç çš„ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨ä¸Šã€‚ä¸ºäº†é™ä½Žé£Žé™©ï¼Œå»ºè®®ä»Žå¯ä¿¡çš„æ¥æºèŽ·å–POCä»£ç ï¼Œå¹¶ä»”ç»†æ£€æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿å…¶æ²¡æœ‰æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œåœ¨æµ‹è¯•å®ŒæˆåŽï¼Œåº”åŠæ—¶æ¸…ç†ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ®‹ç•™æ–‡ä»¶ã€‚

æŠ•æ¯’é£Žé™©é¢„ä¼°ä¸º10%ï¼Œå› ä¸ºä»£ç ç›¸å¯¹ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´žéªŒè¯å’Œåˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨è¢«ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**æ¥æº**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°shellè®¿é—®ï¼Œèƒ½å¤Ÿæ‰§è¡Œndsudoå‘½ä»¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2024-32019 æ˜¯ Netdata ä¸­ ndsudo å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudo æ˜¯ä¸€ä¸ª SUID root çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„è„šæœ¬æ”¾ç½®åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆçº§æ›´é«˜çš„ç›®å½•ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ nvmeï¼‰ï¼Œæ¥æ¬ºéª— ndsudo æ‰§è¡Œè¯¥æ¶æ„è„šæœ¬å¹¶èŽ·å¾— root æƒé™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æè¿°äº†ä¸€ç§åˆ©ç”¨æ­¤æ¼æ´žçš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1.  åˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼ˆpoc.pyï¼‰ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
2.  å°†æ­¤è„šæœ¬é‡å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ nvmeï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ ndsudo nvme-listï¼Œè¿™å°†å¯¼è‡´ ndsudo æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“æœ¬èº«æŠ•æ¯’é£Žé™©è¾ƒä½Žã€‚`poc.py` ä»£ç éžå¸¸ç®€å•ï¼Œä»…åŒ…å«ææƒæ‰§è¡Œbashçš„ä»£ç ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„ä»£ç ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¸…æ™°çš„æ¼æ´žåˆ©ç”¨è¯´æ˜Žã€‚ä½†ç”¨æˆ·ä»ç„¶éœ€è¦æ³¨æ„ï¼Œåœ¨å®žé™…çŽ¯å¢ƒä¸­ï¼Œä»Žä¸å¯ä¿¡çš„æ¥æºä¸‹è½½æˆ–å¤åˆ¶æ¼æ´žåˆ©ç”¨ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£Žé™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå†æ‰§è¡Œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žåŽŸç†ï¼š** `ndsudo` ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢å‘½ä»¤çš„è·¯å¾„ä¾èµ–äºŽç”¨æˆ·çš„ `PATH` çŽ¯å¢ƒå˜é‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   åˆ›å»ºæ¶æ„è„šæœ¬ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
    *   å°†æ­¤è„šæœ¬é‡å‘½åä¸º `ndsudo` å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆé€šè¿‡ `ndsudo --help` æŸ¥çœ‹ï¼‰ã€‚
    *   å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œç¡®ä¿æ¶æ„è„šæœ¬ä¼˜å…ˆè¢«æœç´¢åˆ°ã€‚
    *   è¿è¡Œ `ndsudo <allowed_command>`ï¼Œè¿™å°†å¯¼è‡´ `ndsudo` æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´žåˆ©ç”¨è¾ƒä¸ºç®€å•ï¼ŒPOC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä½†åº”æ³¨æ„æ¥æºä¸æ˜Žçš„exploitä»£ç çš„æ½œåœ¨æŠ•æ¯’é£Žé™©ã€‚è¯¥æ¼æ´žå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡æ“çºµ `PATH` çŽ¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨ SUID ç¨‹åº `ndsudo` æå‡è‡³ root æƒé™ã€‚åŠ¡å¿…åŠæ—¶å‡çº§ Netdata ç‰ˆæœ¬ä»¥ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**æ¥æº**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœ¬åœ°ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata agentè¿è¡Œåœ¨å—å½±å“ç‰ˆæœ¬ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰§è¡Œæœ¬åœ°ä»£ç ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·æ‹¥æœ‰ SUID æƒé™ï¼Œå…è®¸æ‰§è¡ŒæŸäº›ç‰¹æƒå‘½ä»¤ã€‚æ¼æ´žçš„æ ¹æºåœ¨äºŽ `ndsudo` ä½¿ç”¨ä¸å®‰å…¨çš„ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ PATH ä¸­æ’å…¥æ¶æ„ç¨‹åºï¼Œè®© `ndsudo` æ‰§è¡Œæ”»å‡»è€…æŽ§åˆ¶çš„ä»£ç ï¼Œä»Žè€Œæå‡æƒé™åˆ° rootã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾ `ndsudo` è·¯å¾„ï¼š** é€šå¸¸ä½äºŽ `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`ï¼Œä½†éœ€è¦é€šè¿‡ `find` å‘½ä»¤ç¡®è®¤ã€‚
2.  **åˆ›å»ºæ¶æ„ç¨‹åºï¼š** åˆ›å»ºä¸€ä¸ª C ç¨‹åºï¼Œè¯¥ç¨‹åºè°ƒç”¨ `setuid(0)` å’Œ `setgid(0)` è®¾ç½®ç”¨æˆ·å’Œç»„ ID ä¸º rootï¼Œç„¶åŽæ‰§è¡Œä¸€ä¸ª shell (ä¾‹å¦‚ `/bin/bash -p`)ã€‚éœ€è¦ä½¿ç”¨ `gcc` ç¼–è¯‘è¯¥ç¨‹åºï¼Œä¾‹å¦‚å‘½åä¸º `arcconf`ã€‚
3.  **ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼š** å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ¶æ„ç¨‹åºä½äºŽ `/tmp` ç›®å½•ä¸‹ï¼Œåˆ™æ‰§è¡Œ `PATH=/tmp:$PATH`ã€‚
4.  **æ‰§è¡Œ `ndsudo` å‘½ä»¤ï¼š** ä½¿ç”¨ `ndsudo` æ‰§è¡Œå®ƒæ”¯æŒçš„å‘½ä»¤ï¼Œä½†è¯¥å‘½ä»¤ä¾èµ–äºŽæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`ã€‚`ndsudo` ä¼šå°è¯•æ‰§è¡Œ `arcconf`ï¼Œä½†ç”±äºŽ PATH çŽ¯å¢ƒå˜é‡è¢«ä¿®æ”¹ï¼Œå®ƒä¼šæ‰§è¡Œæ”»å‡»è€…åœ¨ `/tmp` ç›®å½•ä¸‹åˆ›å»ºçš„æ¶æ„ç¨‹åºã€‚
5.  **èŽ·å¾— root shellï¼š** å¦‚æžœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…å°†èŽ·å¾—ä¸€ä¸ª root shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æä¾›çš„ POC ä»£ç ä¸­ï¼Œ`arcconf.c` çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªææƒçš„ shellï¼Œæ²¡æœ‰æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ ä½†ä»Ž github ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ `arcconf` æ—¶ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½åœ¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä»Ž github ä¸Šä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ½œåœ¨é£Žé™©ï¼Œæ•…æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**æ¥æº**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo æœ¬åœ°æƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·æå‡è‡³ root æƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 å’Œ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Netdataï¼Œä¸” ndsudo å·¥å…·è®¾ç½®äº† SUID root æƒé™ï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ ndsudoã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å®ƒä½¿ç”¨ `PATH` çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ `PATH` çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘æ¶æ„ç›®å½•çš„è·¯å¾„ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªä¸Ž `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤åŒåçš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œä»¥ root æƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§:**

æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´žã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåå¼¹ shellï¼‰çš„ç›®å½•ã€‚
2.  å°†æ¶æ„ç¨‹åºå‘½åä¸º `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œ`nvme-list`ï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ `ndsudo` å‘½ä»¤ã€‚`ndsudo` å°†æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€Œä½¿æ”»å‡»è€…èŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©:**

æ ¹æ®æä¾›çš„ä»£ç åˆ†æžï¼Œè¯¥ä»“åº“ä¼¼ä¹Žä¸»è¦æä¾›äº†ä¸€ä¸ª checker è„šæœ¬æ¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œç®¡ç†å‘˜è¯†åˆ«å’ŒéªŒè¯æ¼æ´žæ˜¯å¦å­˜åœ¨ï¼Œæ—¨åœ¨å¸®åŠ©é˜²å¾¡è€…è¯„ä¼°é£Žé™©å’ŒéªŒè¯è¡¥ä¸ï¼Œè€Œä¸æ˜¯æä¾›æ­¦å™¨åŒ–çš„ PoCã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žã€‚

æ£€æŸ¥å™¨ä»£ç ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (æˆ–å®‰è£…ä½ç½®) çš„ SUID/æ‰€æœ‰æƒã€‚
*   `PATH` ä¸­æ—©äºŽå¸¸è§ç³»ç»Ÿè·¯å¾„çš„å¯å†™ç›®å½•ã€‚
*   `ndsudo` å°è¯•æ‰§è¡Œçš„ç™½åå•å­å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚
*   å¯é€‰åœ°è¿è¡Œ `ndsudo --test <subcommand>` æ¥æ‰“å°å·²è§£æžçš„å‘½ä»¤è€Œä¸æ‰§è¡Œå®ƒ (è°¨æ…Žä½¿ç”¨ï¼Œå…ˆé˜…è¯»ä»£ç )ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º 0%**ã€‚


**é¡¹ç›®åœ°å€:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**æ¥æº**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´žèŽ·å–rootæƒé™ã€‚

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”æ”»å‡»è€…éœ€è¦å…·æœ‰æœ¬åœ°ä½Žæƒé™è´¦å·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ netdata çš„ ndsudo å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢è·¯å¾„ç”± PATH çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨ ndsudo æœç´¢è·¯å¾„ä¸­ï¼Œå½“ ndsudo è°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª C ç¨‹åºï¼Œç¼–è¯‘åŽå¯ä»¥ç›´æŽ¥æ‰§è¡Œä¸€ä¸ªå…·æœ‰ root æƒé™çš„ bash shellã€‚æ”»å‡»è€…éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«æ­¤æ¶æ„ç¨‹åºçš„å¯å†™ç›®å½•ï¼Œç„¶åŽä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ­¤ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚ä¹‹åŽï¼Œå½“ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

ä»£ç ä¸­æ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚å®ƒåªæ˜¯ç®€å•åœ°è®¾ç½® uid å’Œ gid ä¸º 0ï¼Œç„¶åŽæ‰§è¡Œ /bin/bashã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º0%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1.  åˆ©ç”¨éœ€è¦å…ˆèŽ·å¾—ä¸€ä¸ªnetdataè½¯ä»¶çš„ä½Žæƒé™è´¦å·ã€‚
2.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ POC ä¸­çš„ C ç¨‹åºç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„å¯å†™ç›®å½•ã€‚
3.  ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†è¯¥ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚
4.  è§¦å‘ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤ï¼Œè¿™å°†å¯¼è‡´æ¶æ„ç¨‹åºä»¥ root æƒé™æ‰§è¡Œï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

**é¡¹ç›®åœ°å€:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**æ¥æº**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯æå‡è‡³rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 åŠ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”å…·æœ‰æœ¬åœ°shellè®¿é—®æƒé™ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 å­˜åœ¨äºŽNetdataçš„`ndsudo`å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·æ˜¯å…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¼æ´žåŽŸå› æ˜¯`ndsudo`çš„æœç´¢è·¯å¾„ç”±`PATH`çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨å‰é¢ï¼Œå½“`ndsudo`æ‰§è¡Œä¿¡ä»»çš„å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œå®žçŽ°æœ¬åœ°ææƒã€‚æä¾›çš„POCä»£ç é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´žï¼š

1.  **ç¼–è¯‘æ¶æ„payload:**  `poc.c` ç¼–è¯‘æˆ `nvme`ï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯æ‰§è¡Œ `/bin/bash`ï¼Œå¹¶è®¾ç½® UID å’Œ GID ä¸º 0ï¼Œå³rootæƒé™ã€‚
2.  **ä¼ è¾“payloadåˆ°ç›®æ ‡ç³»ç»Ÿ:**  å°†ç¼–è¯‘å¥½çš„`nvme`ä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„`/tmp`ç›®å½•ã€‚
3.  **å‡†å¤‡payloadæ‰§è¡Œ:**  ç»™`/tmp/nvme`æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽå°†`/tmp`æ·»åŠ åˆ°`PATH`çŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ã€‚
4.  **è§¦å‘`ndsudo`æ‰§è¡Œpayload:** è¿è¡Œ`./ndsudo nvme-list`ï¼Œ`ndsudo`ä¼šæ‰§è¡Œ`/tmp/nvme`ï¼Œç”±äºŽè¯¥ç¨‹åºä¼šå°†æƒé™æå‡ä¸ºrootï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥èŽ·å¾—root shellã€‚

**æœ‰æ•ˆæ€§ï¼š** è¯¥POCä»£ç æè¿°çš„åˆ©ç”¨æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„`poc.c`ä»£ç åŠŸèƒ½æ¸…æ™°ï¼Œä»…ä¸ºæ‰§è¡Œ`/bin/bash`å¹¶æå‡æƒé™ï¼Œä¸å­˜åœ¨éšè—çš„æŠ•æ¯’ä»£ç ã€‚READMEæ–‡ä»¶æè¿°äº†å®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`PATH`çŽ¯å¢ƒå˜é‡ï¼Œæ¬ºéª—`ndsudo`æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**æ¥æº**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦netdata agentå­˜åœ¨æ¼æ´žç‰ˆæœ¬ä¸”ndsudoè¢«è°ƒç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata Agentä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªrootç”¨æˆ·æ‹¥æœ‰çš„ã€è®¾ç½®äº†SUIDä½çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒæœ¬åº”åªè¿è¡Œä¸€ç»„å—é™çš„å¤–éƒ¨å‘½ä»¤ï¼Œä½†æ˜¯å…¶æœç´¢è·¯å¾„ç”±PATHçŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æŒ‡å®šndsudoæŸ¥æ‰¾è¿™äº›å‘½ä»¤çš„ä½ç½®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯æ”»å‡»è€…å…·æœ‰å†™æƒé™çš„ç›®å½•ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ”¾ç½®æ¶æ„ç¨‹åºå¹¶ä»¥rootæƒé™æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´žæè¿°å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žå­˜åœ¨åˆ©ç”¨ä»·å€¼ï¼Œé€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æ‰§è¡Œæ¶æ„ç¨‹åºè¾¾åˆ°ææƒæ•ˆæžœã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„ä»£ç ä»…ä¸ºGNU GENERAL PUBLIC LICENSEï¼Œæ˜¯å¼€æºåè®®è®¸å¯ï¼Œä¸åŒ…å«ç›´æŽ¥çš„æ”»å‡»payloadæˆ–æ¶æ„ä»£ç ã€‚ä½†licenseæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ä»£ç ï¼Œå¦‚æžœç»“åˆç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œåè®®å†…å®¹ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åˆ›å»ºä¸€ä¸ªåˆæ³•çš„ç¨‹åºï¼Œä½†å…¶è¡Œä¸ºè¿åäº†åè®®æ¡æ¬¾ï¼Œä»Žè€Œé€ æˆæŸå®³ã€‚æ­¤ä»“åº“ä¸­å‘çŽ°ç›´æŽ¥æŠ•æ¯’ä»£ç çš„æ¦‚çŽ‡è¾ƒä½Žï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æ»¥ç”¨é£Žé™©ï¼Œä¼°è®¡æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„Netdata Agentç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 1.44.0-60, < 1.45.3ï¼‰ã€‚
2.  æŸ¥æ‰¾ndsudoå·¥å…·çš„ä½ç½®ã€‚
3.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å‘½ä»¤çš„ç›®å½•ï¼Œä¾‹å¦‚/tmp/evilã€‚
4.  å°†æ¶æ„ç¨‹åºï¼ˆå¦‚åå¼¹shellï¼‰æ”¾ç½®åˆ°/tmp/evilç›®å½•ä¸‹ï¼Œå¹¶å‘½åä¸ºndsudoå°è¯•æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œ`ping`ï¼Œ`date` ç­‰, å…·ä½“å–å†³äºŽ ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼‰ã€‚
5.  ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†/tmp/evilæ·»åŠ åˆ°PATHçš„æœ€å‰é¢ï¼š`export PATH=/tmp/evil:$PATH`ã€‚
6.  è¿è¡Œndsudoï¼Œå®ƒå°†æ‰§è¡Œ/tmp/evilç›®å½•ä¸‹çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**æ¥æº**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡PATHåŠ«æŒæ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata Agentå­˜åœ¨ndsudoï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠå¯æŽ§çš„PATHçŽ¯å¢ƒå˜é‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdataä¸­`ndsudo`å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´žã€‚`ndsudo`æ˜¯ä¸€ä¸ªå…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨`PATH`çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨`PATH`çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆäºŽç³»ç»Ÿç›®å½•çš„ä½ç½®ï¼Œè¯±ä½¿`ndsudo`æ‰§è¡Œè¯¥æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**
1.  æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„`ndsudo`å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶(ä¾‹å¦‚`nvme`)ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œæ”»å‡»è€…å¸Œæœ›æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚æä¾›çš„`payload.c`æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªroot shellã€‚
3.  ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†å½“å‰ç›®å½•(æˆ–åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•)æ·»åŠ åˆ°`PATH`çš„å¼€å¤´ã€‚
4.  è°ƒç”¨`ndsudo`ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ƒå…è®¸æ‰§è¡Œçš„å‘½ä»¤(ä¾‹å¦‚`nvme-list`)ã€‚ç”±äºŽ`PATH`å·²ç»è¢«ä¿®æ”¹ï¼Œ`ndsudo`ä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„`nvme`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»Žè€Œä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºŽæŸ¥æ‰¾`ndsudo`ï¼Œåˆ›å»ºä¸€ä¸ª`nvme` payloadï¼Œä¿®æ”¹`PATH`ï¼Œç„¶åŽæ‰§è¡Œ`ndsudo`ã€‚README.mdæ–‡ä»¶æè¿°äº†å¦‚ä½•ç¼–è¯‘`payload.c`å¹¶ä½¿ç”¨è„šæœ¬ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
æŸ¥çœ‹äº†æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ²¡æœ‰å‘çŽ°ä»»ä½•æŠ•æ¯’ä»£ç ã€‚å…¶ä¸­ï¼ŒCVE-2024-32019.shè„šæœ¬ç”¨äºŽåˆ©ç”¨æ¼æ´žï¼Œpayload.cç”¨äºŽç¼–è¯‘æ¶æ„payloadï¼ŒREADME.mdæ–‡ä»¶æè¿°äº†æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ï¼Œéƒ½æ˜¯æ­£å¸¸çš„åˆ©ç”¨ä»£ç ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**æ¥æº**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata ndsudoå·¥å…·ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªSUID rootçš„ç¨‹åºï¼Œä½†å®ƒä½¿ç”¨äº†PATHçŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡æŒ‡å‘ä¸€ä¸ªè‡ªå·±å¯æŽ§çš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹æ”¾ç½®æ¶æ„ç¨‹åºï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žæ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ£€æŸ¥ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨`/opt`ç›®å½•ä¸‹çš„`ndsudo`ç¨‹åºï¼Œå¹¶ä¸”ç¡®è®¤è¯¥ç¨‹åºæ˜¯å¦ä¸ºrootæ‰€æœ‰ä¸”è®¾ç½®äº†SUIDæƒé™ã€‚åŒæ—¶ï¼Œä½¿ç”¨`strings`å‘½ä»¤æ£€æŸ¥`ndsudo`ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨å¯¹`nvme`ã€`smartctl`ã€`hdparm`æˆ–`sensors`ç­‰å¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¯´æ˜Žè¯¥ç¨‹åºå¯èƒ½å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚
2.  **æ¶æ„ç¨‹åºç¼–è¯‘ï¼š** ç¼–è¯‘ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯è®¾ç½®UIDå’ŒGIDä¸º0ï¼Œç„¶åŽæ‰§è¡Œ`/bin/bash`ï¼Œä»Žè€ŒèŽ·å–root shellã€‚
3.  **æ¶æ„ç¨‹åºä¸Šä¼ ï¼š** é€šè¿‡SFTPå°†ç¼–è¯‘å¥½çš„æ¶æ„ç¨‹åºä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæ”»å‡»è€…å¯æŽ§çš„ç›®å½•ï¼Œä¾‹å¦‚`/tmp`ã€‚
4.  **çŽ¯å¢ƒå˜é‡ä¿®æ”¹ï¼š** ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æ”»å‡»è€…å¯æŽ§çš„ç›®å½•æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ï¼Œç¡®ä¿`ndsudo`ç¨‹åºåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶é¦–å…ˆåœ¨è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ã€‚
5.  **æ¼æ´žè§¦å‘ï¼š** æ‰§è¡Œ`ndsudo`ç¨‹åºï¼Œå½“å®ƒè°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…ä¸Šä¼ çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å–rootæƒé™ã€‚
6.  **äº¤äº’å¼Shellï¼š** æ¼æ´žåˆ©ç”¨ä»£ç æä¾›äº¤äº’å¼shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æ­¤POCä»£ç æœ¬èº«ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œå®žçŽ°æœ¬åœ°ææƒã€‚ä½†æ˜¯ï¼Œè¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ï¼š

*   **ç¼–è¯‘å’Œä¼ è¾“æ¶æ„ä»£ç ï¼š** è„šæœ¬ä¼šè‡ªåŠ¨ç¼–è¯‘Cä»£ç ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚è™½ç„¶Cä»£ç çš„å†…å®¹æ˜¯ææƒï¼Œä½†å¦‚æžœæ¶æ„æ”»å‡»è€…ä¿®æ”¹äº†Cä»£ç ï¼Œå°±å¯èƒ½åŒ…å«å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åŽé—¨ã€æ”¶é›†ä¿¡æ¯ç­‰ã€‚
*   **è¿œç¨‹æ‰§è¡Œä»£ç ï¼š**  è„šæœ¬é€šè¿‡sshæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£Žé™©ï¼Œå¯èƒ½æ‰§è¡Œé¢å¤–çš„æ¶æ„æ“ä½œã€‚
*   **æ®‹ç•™æ–‡ä»¶ï¼š** ç¼–è¯‘åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸Šä¼ çš„æ¶æ„ç¨‹åºå¯èƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç•™ä¸‹ç—•è¿¹ï¼Œå¦‚æžœè¿™äº›æ–‡ä»¶è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å®‰å…¨é—®é¢˜ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é£Žé™©ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œè¯¥POCä»£ç çš„é£Žé™©ä»ç„¶å¯æŽ§ï¼Œä¸»è¦é£Žé™©é›†ä¸­åœ¨ä»£ç çš„ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨ä¸Šã€‚ä¸ºäº†é™ä½Žé£Žé™©ï¼Œå»ºè®®ä»Žå¯ä¿¡çš„æ¥æºèŽ·å–POCä»£ç ï¼Œå¹¶ä»”ç»†æ£€æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿å…¶æ²¡æœ‰æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œåœ¨æµ‹è¯•å®ŒæˆåŽï¼Œåº”åŠæ—¶æ¸…ç†ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ®‹ç•™æ–‡ä»¶ã€‚

æŠ•æ¯’é£Žé™©é¢„ä¼°ä¸º10%ï¼Œå› ä¸ºä»£ç ç›¸å¯¹ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´žéªŒè¯å’Œåˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨è¢«ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**æ¥æº**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°shellè®¿é—®ï¼Œèƒ½å¤Ÿæ‰§è¡Œndsudoå‘½ä»¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2024-32019 æ˜¯ Netdata ä¸­ ndsudo å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudo æ˜¯ä¸€ä¸ª SUID root çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„è„šæœ¬æ”¾ç½®åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆçº§æ›´é«˜çš„ç›®å½•ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ nvmeï¼‰ï¼Œæ¥æ¬ºéª— ndsudo æ‰§è¡Œè¯¥æ¶æ„è„šæœ¬å¹¶èŽ·å¾— root æƒé™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æè¿°äº†ä¸€ç§åˆ©ç”¨æ­¤æ¼æ´žçš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1.  åˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼ˆpoc.pyï¼‰ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
2.  å°†æ­¤è„šæœ¬é‡å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ nvmeï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ ndsudo nvme-listï¼Œè¿™å°†å¯¼è‡´ ndsudo æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“æœ¬èº«æŠ•æ¯’é£Žé™©è¾ƒä½Žã€‚`poc.py` ä»£ç éžå¸¸ç®€å•ï¼Œä»…åŒ…å«ææƒæ‰§è¡Œbashçš„ä»£ç ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„ä»£ç ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¸…æ™°çš„æ¼æ´žåˆ©ç”¨è¯´æ˜Žã€‚ä½†ç”¨æˆ·ä»ç„¶éœ€è¦æ³¨æ„ï¼Œåœ¨å®žé™…çŽ¯å¢ƒä¸­ï¼Œä»Žä¸å¯ä¿¡çš„æ¥æºä¸‹è½½æˆ–å¤åˆ¶æ¼æ´žåˆ©ç”¨ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£Žé™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå†æ‰§è¡Œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žåŽŸç†ï¼š** `ndsudo` ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢å‘½ä»¤çš„è·¯å¾„ä¾èµ–äºŽç”¨æˆ·çš„ `PATH` çŽ¯å¢ƒå˜é‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   åˆ›å»ºæ¶æ„è„šæœ¬ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
    *   å°†æ­¤è„šæœ¬é‡å‘½åä¸º `ndsudo` å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆé€šè¿‡ `ndsudo --help` æŸ¥çœ‹ï¼‰ã€‚
    *   å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œç¡®ä¿æ¶æ„è„šæœ¬ä¼˜å…ˆè¢«æœç´¢åˆ°ã€‚
    *   è¿è¡Œ `ndsudo <allowed_command>`ï¼Œè¿™å°†å¯¼è‡´ `ndsudo` æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´žåˆ©ç”¨è¾ƒä¸ºç®€å•ï¼ŒPOC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä½†åº”æ³¨æ„æ¥æºä¸æ˜Žçš„exploitä»£ç çš„æ½œåœ¨æŠ•æ¯’é£Žé™©ã€‚è¯¥æ¼æ´žå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡æ“çºµ `PATH` çŽ¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨ SUID ç¨‹åº `ndsudo` æå‡è‡³ root æƒé™ã€‚åŠ¡å¿…åŠæ—¶å‡çº§ Netdata ç‰ˆæœ¬ä»¥ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**æ¥æº**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœ¬åœ°ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata agentè¿è¡Œåœ¨å—å½±å“ç‰ˆæœ¬ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰§è¡Œæœ¬åœ°ä»£ç ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·æ‹¥æœ‰ SUID æƒé™ï¼Œå…è®¸æ‰§è¡ŒæŸäº›ç‰¹æƒå‘½ä»¤ã€‚æ¼æ´žçš„æ ¹æºåœ¨äºŽ `ndsudo` ä½¿ç”¨ä¸å®‰å…¨çš„ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ PATH ä¸­æ’å…¥æ¶æ„ç¨‹åºï¼Œè®© `ndsudo` æ‰§è¡Œæ”»å‡»è€…æŽ§åˆ¶çš„ä»£ç ï¼Œä»Žè€Œæå‡æƒé™åˆ° rootã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾ `ndsudo` è·¯å¾„ï¼š** é€šå¸¸ä½äºŽ `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`ï¼Œä½†éœ€è¦é€šè¿‡ `find` å‘½ä»¤ç¡®è®¤ã€‚
2.  **åˆ›å»ºæ¶æ„ç¨‹åºï¼š** åˆ›å»ºä¸€ä¸ª C ç¨‹åºï¼Œè¯¥ç¨‹åºè°ƒç”¨ `setuid(0)` å’Œ `setgid(0)` è®¾ç½®ç”¨æˆ·å’Œç»„ ID ä¸º rootï¼Œç„¶åŽæ‰§è¡Œä¸€ä¸ª shell (ä¾‹å¦‚ `/bin/bash -p`)ã€‚éœ€è¦ä½¿ç”¨ `gcc` ç¼–è¯‘è¯¥ç¨‹åºï¼Œä¾‹å¦‚å‘½åä¸º `arcconf`ã€‚
3.  **ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼š** å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ¶æ„ç¨‹åºä½äºŽ `/tmp` ç›®å½•ä¸‹ï¼Œåˆ™æ‰§è¡Œ `PATH=/tmp:$PATH`ã€‚
4.  **æ‰§è¡Œ `ndsudo` å‘½ä»¤ï¼š** ä½¿ç”¨ `ndsudo` æ‰§è¡Œå®ƒæ”¯æŒçš„å‘½ä»¤ï¼Œä½†è¯¥å‘½ä»¤ä¾èµ–äºŽæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`ã€‚`ndsudo` ä¼šå°è¯•æ‰§è¡Œ `arcconf`ï¼Œä½†ç”±äºŽ PATH çŽ¯å¢ƒå˜é‡è¢«ä¿®æ”¹ï¼Œå®ƒä¼šæ‰§è¡Œæ”»å‡»è€…åœ¨ `/tmp` ç›®å½•ä¸‹åˆ›å»ºçš„æ¶æ„ç¨‹åºã€‚
5.  **èŽ·å¾— root shellï¼š** å¦‚æžœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…å°†èŽ·å¾—ä¸€ä¸ª root shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æä¾›çš„ POC ä»£ç ä¸­ï¼Œ`arcconf.c` çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªææƒçš„ shellï¼Œæ²¡æœ‰æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ ä½†ä»Ž github ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ `arcconf` æ—¶ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½åœ¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä»Ž github ä¸Šä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ½œåœ¨é£Žé™©ï¼Œæ•…æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**æ¥æº**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo æœ¬åœ°æƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·æå‡è‡³ root æƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 å’Œ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Netdataï¼Œä¸” ndsudo å·¥å…·è®¾ç½®äº† SUID root æƒé™ï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ ndsudoã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å®ƒä½¿ç”¨ `PATH` çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ `PATH` çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘æ¶æ„ç›®å½•çš„è·¯å¾„ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªä¸Ž `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤åŒåçš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œä»¥ root æƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§:**

æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´žã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåå¼¹ shellï¼‰çš„ç›®å½•ã€‚
2.  å°†æ¶æ„ç¨‹åºå‘½åä¸º `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œ`nvme-list`ï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ `ndsudo` å‘½ä»¤ã€‚`ndsudo` å°†æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€Œä½¿æ”»å‡»è€…èŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©:**

æ ¹æ®æä¾›çš„ä»£ç åˆ†æžï¼Œè¯¥ä»“åº“ä¼¼ä¹Žä¸»è¦æä¾›äº†ä¸€ä¸ª checker è„šæœ¬æ¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œç®¡ç†å‘˜è¯†åˆ«å’ŒéªŒè¯æ¼æ´žæ˜¯å¦å­˜åœ¨ï¼Œæ—¨åœ¨å¸®åŠ©é˜²å¾¡è€…è¯„ä¼°é£Žé™©å’ŒéªŒè¯è¡¥ä¸ï¼Œè€Œä¸æ˜¯æä¾›æ­¦å™¨åŒ–çš„ PoCã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žã€‚

æ£€æŸ¥å™¨ä»£ç ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (æˆ–å®‰è£…ä½ç½®) çš„ SUID/æ‰€æœ‰æƒã€‚
*   `PATH` ä¸­æ—©äºŽå¸¸è§ç³»ç»Ÿè·¯å¾„çš„å¯å†™ç›®å½•ã€‚
*   `ndsudo` å°è¯•æ‰§è¡Œçš„ç™½åå•å­å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚
*   å¯é€‰åœ°è¿è¡Œ `ndsudo --test <subcommand>` æ¥æ‰“å°å·²è§£æžçš„å‘½ä»¤è€Œä¸æ‰§è¡Œå®ƒ (è°¨æ…Žä½¿ç”¨ï¼Œå…ˆé˜…è¯»ä»£ç )ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º 0%**ã€‚


**é¡¹ç›®åœ°å€:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**æ¥æº**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´žèŽ·å–rootæƒé™ã€‚

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”æ”»å‡»è€…éœ€è¦å…·æœ‰æœ¬åœ°ä½Žæƒé™è´¦å·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ netdata çš„ ndsudo å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢è·¯å¾„ç”± PATH çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨ ndsudo æœç´¢è·¯å¾„ä¸­ï¼Œå½“ ndsudo è°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª C ç¨‹åºï¼Œç¼–è¯‘åŽå¯ä»¥ç›´æŽ¥æ‰§è¡Œä¸€ä¸ªå…·æœ‰ root æƒé™çš„ bash shellã€‚æ”»å‡»è€…éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«æ­¤æ¶æ„ç¨‹åºçš„å¯å†™ç›®å½•ï¼Œç„¶åŽä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ­¤ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚ä¹‹åŽï¼Œå½“ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

ä»£ç ä¸­æ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚å®ƒåªæ˜¯ç®€å•åœ°è®¾ç½® uid å’Œ gid ä¸º 0ï¼Œç„¶åŽæ‰§è¡Œ /bin/bashã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º0%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1.  åˆ©ç”¨éœ€è¦å…ˆèŽ·å¾—ä¸€ä¸ªnetdataè½¯ä»¶çš„ä½Žæƒé™è´¦å·ã€‚
2.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ POC ä¸­çš„ C ç¨‹åºç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„å¯å†™ç›®å½•ã€‚
3.  ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†è¯¥ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚
4.  è§¦å‘ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤ï¼Œè¿™å°†å¯¼è‡´æ¶æ„ç¨‹åºä»¥ root æƒé™æ‰§è¡Œï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

**é¡¹ç›®åœ°å€:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**æ¥æº**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯æå‡è‡³rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 åŠ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”å…·æœ‰æœ¬åœ°shellè®¿é—®æƒé™ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 å­˜åœ¨äºŽNetdataçš„`ndsudo`å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·æ˜¯å…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¼æ´žåŽŸå› æ˜¯`ndsudo`çš„æœç´¢è·¯å¾„ç”±`PATH`çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨å‰é¢ï¼Œå½“`ndsudo`æ‰§è¡Œä¿¡ä»»çš„å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œå®žçŽ°æœ¬åœ°ææƒã€‚æä¾›çš„POCä»£ç é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´žï¼š

1.  **ç¼–è¯‘æ¶æ„payload:**  `poc.c` ç¼–è¯‘æˆ `nvme`ï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯æ‰§è¡Œ `/bin/bash`ï¼Œå¹¶è®¾ç½® UID å’Œ GID ä¸º 0ï¼Œå³rootæƒé™ã€‚
2.  **ä¼ è¾“payloadåˆ°ç›®æ ‡ç³»ç»Ÿ:**  å°†ç¼–è¯‘å¥½çš„`nvme`ä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„`/tmp`ç›®å½•ã€‚
3.  **å‡†å¤‡payloadæ‰§è¡Œ:**  ç»™`/tmp/nvme`æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽå°†`/tmp`æ·»åŠ åˆ°`PATH`çŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ã€‚
4.  **è§¦å‘`ndsudo`æ‰§è¡Œpayload:** è¿è¡Œ`./ndsudo nvme-list`ï¼Œ`ndsudo`ä¼šæ‰§è¡Œ`/tmp/nvme`ï¼Œç”±äºŽè¯¥ç¨‹åºä¼šå°†æƒé™æå‡ä¸ºrootï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥èŽ·å¾—root shellã€‚

**æœ‰æ•ˆæ€§ï¼š** è¯¥POCä»£ç æè¿°çš„åˆ©ç”¨æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„`poc.c`ä»£ç åŠŸèƒ½æ¸…æ™°ï¼Œä»…ä¸ºæ‰§è¡Œ`/bin/bash`å¹¶æå‡æƒé™ï¼Œä¸å­˜åœ¨éšè—çš„æŠ•æ¯’ä»£ç ã€‚READMEæ–‡ä»¶æè¿°äº†å®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`PATH`çŽ¯å¢ƒå˜é‡ï¼Œæ¬ºéª—`ndsudo`æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**æ¥æº**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦netdata agentå­˜åœ¨æ¼æ´žç‰ˆæœ¬ä¸”ndsudoè¢«è°ƒç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata Agentä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªrootç”¨æˆ·æ‹¥æœ‰çš„ã€è®¾ç½®äº†SUIDä½çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒæœ¬åº”åªè¿è¡Œä¸€ç»„å—é™çš„å¤–éƒ¨å‘½ä»¤ï¼Œä½†æ˜¯å…¶æœç´¢è·¯å¾„ç”±PATHçŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æŒ‡å®šndsudoæŸ¥æ‰¾è¿™äº›å‘½ä»¤çš„ä½ç½®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯æ”»å‡»è€…å…·æœ‰å†™æƒé™çš„ç›®å½•ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ”¾ç½®æ¶æ„ç¨‹åºå¹¶ä»¥rootæƒé™æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´žæè¿°å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žå­˜åœ¨åˆ©ç”¨ä»·å€¼ï¼Œé€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æ‰§è¡Œæ¶æ„ç¨‹åºè¾¾åˆ°ææƒæ•ˆæžœã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„ä»£ç ä»…ä¸ºGNU GENERAL PUBLIC LICENSEï¼Œæ˜¯å¼€æºåè®®è®¸å¯ï¼Œä¸åŒ…å«ç›´æŽ¥çš„æ”»å‡»payloadæˆ–æ¶æ„ä»£ç ã€‚ä½†licenseæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ä»£ç ï¼Œå¦‚æžœç»“åˆç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œåè®®å†…å®¹ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åˆ›å»ºä¸€ä¸ªåˆæ³•çš„ç¨‹åºï¼Œä½†å…¶è¡Œä¸ºè¿åäº†åè®®æ¡æ¬¾ï¼Œä»Žè€Œé€ æˆæŸå®³ã€‚æ­¤ä»“åº“ä¸­å‘çŽ°ç›´æŽ¥æŠ•æ¯’ä»£ç çš„æ¦‚çŽ‡è¾ƒä½Žï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æ»¥ç”¨é£Žé™©ï¼Œä¼°è®¡æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„Netdata Agentç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 1.44.0-60, < 1.45.3ï¼‰ã€‚
2.  æŸ¥æ‰¾ndsudoå·¥å…·çš„ä½ç½®ã€‚
3.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å‘½ä»¤çš„ç›®å½•ï¼Œä¾‹å¦‚/tmp/evilã€‚
4.  å°†æ¶æ„ç¨‹åºï¼ˆå¦‚åå¼¹shellï¼‰æ”¾ç½®åˆ°/tmp/evilç›®å½•ä¸‹ï¼Œå¹¶å‘½åä¸ºndsudoå°è¯•æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œ`ping`ï¼Œ`date` ç­‰, å…·ä½“å–å†³äºŽ ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼‰ã€‚
5.  ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†/tmp/evilæ·»åŠ åˆ°PATHçš„æœ€å‰é¢ï¼š`export PATH=/tmp/evil:$PATH`ã€‚
6.  è¿è¡Œndsudoï¼Œå®ƒå°†æ‰§è¡Œ/tmp/evilç›®å½•ä¸‹çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**æ¥æº**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡PATHåŠ«æŒæ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata Agentå­˜åœ¨ndsudoï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠå¯æŽ§çš„PATHçŽ¯å¢ƒå˜é‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdataä¸­`ndsudo`å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´žã€‚`ndsudo`æ˜¯ä¸€ä¸ªå…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨`PATH`çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨`PATH`çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆäºŽç³»ç»Ÿç›®å½•çš„ä½ç½®ï¼Œè¯±ä½¿`ndsudo`æ‰§è¡Œè¯¥æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**
1.  æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„`ndsudo`å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶(ä¾‹å¦‚`nvme`)ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œæ”»å‡»è€…å¸Œæœ›æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚æä¾›çš„`payload.c`æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªroot shellã€‚
3.  ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†å½“å‰ç›®å½•(æˆ–åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•)æ·»åŠ åˆ°`PATH`çš„å¼€å¤´ã€‚
4.  è°ƒç”¨`ndsudo`ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ƒå…è®¸æ‰§è¡Œçš„å‘½ä»¤(ä¾‹å¦‚`nvme-list`)ã€‚ç”±äºŽ`PATH`å·²ç»è¢«ä¿®æ”¹ï¼Œ`ndsudo`ä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„`nvme`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»Žè€Œä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºŽæŸ¥æ‰¾`ndsudo`ï¼Œåˆ›å»ºä¸€ä¸ª`nvme` payloadï¼Œä¿®æ”¹`PATH`ï¼Œç„¶åŽæ‰§è¡Œ`ndsudo`ã€‚README.mdæ–‡ä»¶æè¿°äº†å¦‚ä½•ç¼–è¯‘`payload.c`å¹¶ä½¿ç”¨è„šæœ¬ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
æŸ¥çœ‹äº†æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ²¡æœ‰å‘çŽ°ä»»ä½•æŠ•æ¯’ä»£ç ã€‚å…¶ä¸­ï¼ŒCVE-2024-32019.shè„šæœ¬ç”¨äºŽåˆ©ç”¨æ¼æ´žï¼Œpayload.cç”¨äºŽç¼–è¯‘æ¶æ„payloadï¼ŒREADME.mdæ–‡ä»¶æè¿°äº†æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ï¼Œéƒ½æ˜¯æ­£å¸¸çš„åˆ©ç”¨ä»£ç ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**æ¥æº**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata ndsudoå·¥å…·ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªSUID rootçš„ç¨‹åºï¼Œä½†å®ƒä½¿ç”¨äº†PATHçŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡æŒ‡å‘ä¸€ä¸ªè‡ªå·±å¯æŽ§çš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹æ”¾ç½®æ¶æ„ç¨‹åºï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žæ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ£€æŸ¥ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨`/opt`ç›®å½•ä¸‹çš„`ndsudo`ç¨‹åºï¼Œå¹¶ä¸”ç¡®è®¤è¯¥ç¨‹åºæ˜¯å¦ä¸ºrootæ‰€æœ‰ä¸”è®¾ç½®äº†SUIDæƒé™ã€‚åŒæ—¶ï¼Œä½¿ç”¨`strings`å‘½ä»¤æ£€æŸ¥`ndsudo`ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨å¯¹`nvme`ã€`smartctl`ã€`hdparm`æˆ–`sensors`ç­‰å¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¯´æ˜Žè¯¥ç¨‹åºå¯èƒ½å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚
2.  **æ¶æ„ç¨‹åºç¼–è¯‘ï¼š** ç¼–è¯‘ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯è®¾ç½®UIDå’ŒGIDä¸º0ï¼Œç„¶åŽæ‰§è¡Œ`/bin/bash`ï¼Œä»Žè€ŒèŽ·å–root shellã€‚
3.  **æ¶æ„ç¨‹åºä¸Šä¼ ï¼š** é€šè¿‡SFTPå°†ç¼–è¯‘å¥½çš„æ¶æ„ç¨‹åºä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæ”»å‡»è€…å¯æŽ§çš„ç›®å½•ï¼Œä¾‹å¦‚`/tmp`ã€‚
4.  **çŽ¯å¢ƒå˜é‡ä¿®æ”¹ï¼š** ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æ”»å‡»è€…å¯æŽ§çš„ç›®å½•æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ï¼Œç¡®ä¿`ndsudo`ç¨‹åºåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶é¦–å…ˆåœ¨è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ã€‚
5.  **æ¼æ´žè§¦å‘ï¼š** æ‰§è¡Œ`ndsudo`ç¨‹åºï¼Œå½“å®ƒè°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…ä¸Šä¼ çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å–rootæƒé™ã€‚
6.  **äº¤äº’å¼Shellï¼š** æ¼æ´žåˆ©ç”¨ä»£ç æä¾›äº¤äº’å¼shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æ­¤POCä»£ç æœ¬èº«ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œå®žçŽ°æœ¬åœ°ææƒã€‚ä½†æ˜¯ï¼Œè¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ï¼š

*   **ç¼–è¯‘å’Œä¼ è¾“æ¶æ„ä»£ç ï¼š** è„šæœ¬ä¼šè‡ªåŠ¨ç¼–è¯‘Cä»£ç ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚è™½ç„¶Cä»£ç çš„å†…å®¹æ˜¯ææƒï¼Œä½†å¦‚æžœæ¶æ„æ”»å‡»è€…ä¿®æ”¹äº†Cä»£ç ï¼Œå°±å¯èƒ½åŒ…å«å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åŽé—¨ã€æ”¶é›†ä¿¡æ¯ç­‰ã€‚
*   **è¿œç¨‹æ‰§è¡Œä»£ç ï¼š**  è„šæœ¬é€šè¿‡sshæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£Žé™©ï¼Œå¯èƒ½æ‰§è¡Œé¢å¤–çš„æ¶æ„æ“ä½œã€‚
*   **æ®‹ç•™æ–‡ä»¶ï¼š** ç¼–è¯‘åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸Šä¼ çš„æ¶æ„ç¨‹åºå¯èƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç•™ä¸‹ç—•è¿¹ï¼Œå¦‚æžœè¿™äº›æ–‡ä»¶è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å®‰å…¨é—®é¢˜ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é£Žé™©ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œè¯¥POCä»£ç çš„é£Žé™©ä»ç„¶å¯æŽ§ï¼Œä¸»è¦é£Žé™©é›†ä¸­åœ¨ä»£ç çš„ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨ä¸Šã€‚ä¸ºäº†é™ä½Žé£Žé™©ï¼Œå»ºè®®ä»Žå¯ä¿¡çš„æ¥æºèŽ·å–POCä»£ç ï¼Œå¹¶ä»”ç»†æ£€æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿å…¶æ²¡æœ‰æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œåœ¨æµ‹è¯•å®ŒæˆåŽï¼Œåº”åŠæ—¶æ¸…ç†ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ®‹ç•™æ–‡ä»¶ã€‚

æŠ•æ¯’é£Žé™©é¢„ä¼°ä¸º10%ï¼Œå› ä¸ºä»£ç ç›¸å¯¹ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´žéªŒè¯å’Œåˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨è¢«ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**æ¥æº**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°shellè®¿é—®ï¼Œèƒ½å¤Ÿæ‰§è¡Œndsudoå‘½ä»¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2024-32019 æ˜¯ Netdata ä¸­ ndsudo å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudo æ˜¯ä¸€ä¸ª SUID root çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„è„šæœ¬æ”¾ç½®åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆçº§æ›´é«˜çš„ç›®å½•ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ nvmeï¼‰ï¼Œæ¥æ¬ºéª— ndsudo æ‰§è¡Œè¯¥æ¶æ„è„šæœ¬å¹¶èŽ·å¾— root æƒé™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æè¿°äº†ä¸€ç§åˆ©ç”¨æ­¤æ¼æ´žçš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1.  åˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼ˆpoc.pyï¼‰ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
2.  å°†æ­¤è„šæœ¬é‡å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ nvmeï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ ndsudo nvme-listï¼Œè¿™å°†å¯¼è‡´ ndsudo æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“æœ¬èº«æŠ•æ¯’é£Žé™©è¾ƒä½Žã€‚`poc.py` ä»£ç éžå¸¸ç®€å•ï¼Œä»…åŒ…å«ææƒæ‰§è¡Œbashçš„ä»£ç ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„ä»£ç ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¸…æ™°çš„æ¼æ´žåˆ©ç”¨è¯´æ˜Žã€‚ä½†ç”¨æˆ·ä»ç„¶éœ€è¦æ³¨æ„ï¼Œåœ¨å®žé™…çŽ¯å¢ƒä¸­ï¼Œä»Žä¸å¯ä¿¡çš„æ¥æºä¸‹è½½æˆ–å¤åˆ¶æ¼æ´žåˆ©ç”¨ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£Žé™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå†æ‰§è¡Œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žåŽŸç†ï¼š** `ndsudo` ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢å‘½ä»¤çš„è·¯å¾„ä¾èµ–äºŽç”¨æˆ·çš„ `PATH` çŽ¯å¢ƒå˜é‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   åˆ›å»ºæ¶æ„è„šæœ¬ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
    *   å°†æ­¤è„šæœ¬é‡å‘½åä¸º `ndsudo` å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆé€šè¿‡ `ndsudo --help` æŸ¥çœ‹ï¼‰ã€‚
    *   å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œç¡®ä¿æ¶æ„è„šæœ¬ä¼˜å…ˆè¢«æœç´¢åˆ°ã€‚
    *   è¿è¡Œ `ndsudo <allowed_command>`ï¼Œè¿™å°†å¯¼è‡´ `ndsudo` æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´žåˆ©ç”¨è¾ƒä¸ºç®€å•ï¼ŒPOC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä½†åº”æ³¨æ„æ¥æºä¸æ˜Žçš„exploitä»£ç çš„æ½œåœ¨æŠ•æ¯’é£Žé™©ã€‚è¯¥æ¼æ´žå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡æ“çºµ `PATH` çŽ¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨ SUID ç¨‹åº `ndsudo` æå‡è‡³ root æƒé™ã€‚åŠ¡å¿…åŠæ—¶å‡çº§ Netdata ç‰ˆæœ¬ä»¥ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**æ¥æº**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœ¬åœ°ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata agentè¿è¡Œåœ¨å—å½±å“ç‰ˆæœ¬ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰§è¡Œæœ¬åœ°ä»£ç ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·æ‹¥æœ‰ SUID æƒé™ï¼Œå…è®¸æ‰§è¡ŒæŸäº›ç‰¹æƒå‘½ä»¤ã€‚æ¼æ´žçš„æ ¹æºåœ¨äºŽ `ndsudo` ä½¿ç”¨ä¸å®‰å…¨çš„ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ PATH ä¸­æ’å…¥æ¶æ„ç¨‹åºï¼Œè®© `ndsudo` æ‰§è¡Œæ”»å‡»è€…æŽ§åˆ¶çš„ä»£ç ï¼Œä»Žè€Œæå‡æƒé™åˆ° rootã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾ `ndsudo` è·¯å¾„ï¼š** é€šå¸¸ä½äºŽ `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`ï¼Œä½†éœ€è¦é€šè¿‡ `find` å‘½ä»¤ç¡®è®¤ã€‚
2.  **åˆ›å»ºæ¶æ„ç¨‹åºï¼š** åˆ›å»ºä¸€ä¸ª C ç¨‹åºï¼Œè¯¥ç¨‹åºè°ƒç”¨ `setuid(0)` å’Œ `setgid(0)` è®¾ç½®ç”¨æˆ·å’Œç»„ ID ä¸º rootï¼Œç„¶åŽæ‰§è¡Œä¸€ä¸ª shell (ä¾‹å¦‚ `/bin/bash -p`)ã€‚éœ€è¦ä½¿ç”¨ `gcc` ç¼–è¯‘è¯¥ç¨‹åºï¼Œä¾‹å¦‚å‘½åä¸º `arcconf`ã€‚
3.  **ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼š** å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ¶æ„ç¨‹åºä½äºŽ `/tmp` ç›®å½•ä¸‹ï¼Œåˆ™æ‰§è¡Œ `PATH=/tmp:$PATH`ã€‚
4.  **æ‰§è¡Œ `ndsudo` å‘½ä»¤ï¼š** ä½¿ç”¨ `ndsudo` æ‰§è¡Œå®ƒæ”¯æŒçš„å‘½ä»¤ï¼Œä½†è¯¥å‘½ä»¤ä¾èµ–äºŽæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`ã€‚`ndsudo` ä¼šå°è¯•æ‰§è¡Œ `arcconf`ï¼Œä½†ç”±äºŽ PATH çŽ¯å¢ƒå˜é‡è¢«ä¿®æ”¹ï¼Œå®ƒä¼šæ‰§è¡Œæ”»å‡»è€…åœ¨ `/tmp` ç›®å½•ä¸‹åˆ›å»ºçš„æ¶æ„ç¨‹åºã€‚
5.  **èŽ·å¾— root shellï¼š** å¦‚æžœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…å°†èŽ·å¾—ä¸€ä¸ª root shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æä¾›çš„ POC ä»£ç ä¸­ï¼Œ`arcconf.c` çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªææƒçš„ shellï¼Œæ²¡æœ‰æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ ä½†ä»Ž github ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ `arcconf` æ—¶ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½åœ¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä»Ž github ä¸Šä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ½œåœ¨é£Žé™©ï¼Œæ•…æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**æ¥æº**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo æœ¬åœ°æƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·æå‡è‡³ root æƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 å’Œ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Netdataï¼Œä¸” ndsudo å·¥å…·è®¾ç½®äº† SUID root æƒé™ï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ ndsudoã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å®ƒä½¿ç”¨ `PATH` çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ `PATH` çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘æ¶æ„ç›®å½•çš„è·¯å¾„ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªä¸Ž `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤åŒåçš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œä»¥ root æƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§:**

æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´žã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåå¼¹ shellï¼‰çš„ç›®å½•ã€‚
2.  å°†æ¶æ„ç¨‹åºå‘½åä¸º `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œ`nvme-list`ï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ `ndsudo` å‘½ä»¤ã€‚`ndsudo` å°†æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€Œä½¿æ”»å‡»è€…èŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©:**

æ ¹æ®æä¾›çš„ä»£ç åˆ†æžï¼Œè¯¥ä»“åº“ä¼¼ä¹Žä¸»è¦æä¾›äº†ä¸€ä¸ª checker è„šæœ¬æ¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œç®¡ç†å‘˜è¯†åˆ«å’ŒéªŒè¯æ¼æ´žæ˜¯å¦å­˜åœ¨ï¼Œæ—¨åœ¨å¸®åŠ©é˜²å¾¡è€…è¯„ä¼°é£Žé™©å’ŒéªŒè¯è¡¥ä¸ï¼Œè€Œä¸æ˜¯æä¾›æ­¦å™¨åŒ–çš„ PoCã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žã€‚

æ£€æŸ¥å™¨ä»£ç ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (æˆ–å®‰è£…ä½ç½®) çš„ SUID/æ‰€æœ‰æƒã€‚
*   `PATH` ä¸­æ—©äºŽå¸¸è§ç³»ç»Ÿè·¯å¾„çš„å¯å†™ç›®å½•ã€‚
*   `ndsudo` å°è¯•æ‰§è¡Œçš„ç™½åå•å­å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚
*   å¯é€‰åœ°è¿è¡Œ `ndsudo --test <subcommand>` æ¥æ‰“å°å·²è§£æžçš„å‘½ä»¤è€Œä¸æ‰§è¡Œå®ƒ (è°¨æ…Žä½¿ç”¨ï¼Œå…ˆé˜…è¯»ä»£ç )ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º 0%**ã€‚


**é¡¹ç›®åœ°å€:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**æ¥æº**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´žèŽ·å–rootæƒé™ã€‚

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”æ”»å‡»è€…éœ€è¦å…·æœ‰æœ¬åœ°ä½Žæƒé™è´¦å·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ netdata çš„ ndsudo å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢è·¯å¾„ç”± PATH çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨ ndsudo æœç´¢è·¯å¾„ä¸­ï¼Œå½“ ndsudo è°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª C ç¨‹åºï¼Œç¼–è¯‘åŽå¯ä»¥ç›´æŽ¥æ‰§è¡Œä¸€ä¸ªå…·æœ‰ root æƒé™çš„ bash shellã€‚æ”»å‡»è€…éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«æ­¤æ¶æ„ç¨‹åºçš„å¯å†™ç›®å½•ï¼Œç„¶åŽä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ­¤ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚ä¹‹åŽï¼Œå½“ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

ä»£ç ä¸­æ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚å®ƒåªæ˜¯ç®€å•åœ°è®¾ç½® uid å’Œ gid ä¸º 0ï¼Œç„¶åŽæ‰§è¡Œ /bin/bashã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º0%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1.  åˆ©ç”¨éœ€è¦å…ˆèŽ·å¾—ä¸€ä¸ªnetdataè½¯ä»¶çš„ä½Žæƒé™è´¦å·ã€‚
2.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ POC ä¸­çš„ C ç¨‹åºç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„å¯å†™ç›®å½•ã€‚
3.  ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†è¯¥ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚
4.  è§¦å‘ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤ï¼Œè¿™å°†å¯¼è‡´æ¶æ„ç¨‹åºä»¥ root æƒé™æ‰§è¡Œï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

**é¡¹ç›®åœ°å€:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**æ¥æº**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯æå‡è‡³rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 åŠ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”å…·æœ‰æœ¬åœ°shellè®¿é—®æƒé™ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 å­˜åœ¨äºŽNetdataçš„`ndsudo`å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·æ˜¯å…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¼æ´žåŽŸå› æ˜¯`ndsudo`çš„æœç´¢è·¯å¾„ç”±`PATH`çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨å‰é¢ï¼Œå½“`ndsudo`æ‰§è¡Œä¿¡ä»»çš„å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œå®žçŽ°æœ¬åœ°ææƒã€‚æä¾›çš„POCä»£ç é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´žï¼š

1.  **ç¼–è¯‘æ¶æ„payload:**  `poc.c` ç¼–è¯‘æˆ `nvme`ï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯æ‰§è¡Œ `/bin/bash`ï¼Œå¹¶è®¾ç½® UID å’Œ GID ä¸º 0ï¼Œå³rootæƒé™ã€‚
2.  **ä¼ è¾“payloadåˆ°ç›®æ ‡ç³»ç»Ÿ:**  å°†ç¼–è¯‘å¥½çš„`nvme`ä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„`/tmp`ç›®å½•ã€‚
3.  **å‡†å¤‡payloadæ‰§è¡Œ:**  ç»™`/tmp/nvme`æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽå°†`/tmp`æ·»åŠ åˆ°`PATH`çŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ã€‚
4.  **è§¦å‘`ndsudo`æ‰§è¡Œpayload:** è¿è¡Œ`./ndsudo nvme-list`ï¼Œ`ndsudo`ä¼šæ‰§è¡Œ`/tmp/nvme`ï¼Œç”±äºŽè¯¥ç¨‹åºä¼šå°†æƒé™æå‡ä¸ºrootï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥èŽ·å¾—root shellã€‚

**æœ‰æ•ˆæ€§ï¼š** è¯¥POCä»£ç æè¿°çš„åˆ©ç”¨æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„`poc.c`ä»£ç åŠŸèƒ½æ¸…æ™°ï¼Œä»…ä¸ºæ‰§è¡Œ`/bin/bash`å¹¶æå‡æƒé™ï¼Œä¸å­˜åœ¨éšè—çš„æŠ•æ¯’ä»£ç ã€‚READMEæ–‡ä»¶æè¿°äº†å®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`PATH`çŽ¯å¢ƒå˜é‡ï¼Œæ¬ºéª—`ndsudo`æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**æ¥æº**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦netdata agentå­˜åœ¨æ¼æ´žç‰ˆæœ¬ä¸”ndsudoè¢«è°ƒç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata Agentä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªrootç”¨æˆ·æ‹¥æœ‰çš„ã€è®¾ç½®äº†SUIDä½çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒæœ¬åº”åªè¿è¡Œä¸€ç»„å—é™çš„å¤–éƒ¨å‘½ä»¤ï¼Œä½†æ˜¯å…¶æœç´¢è·¯å¾„ç”±PATHçŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æŒ‡å®šndsudoæŸ¥æ‰¾è¿™äº›å‘½ä»¤çš„ä½ç½®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯æ”»å‡»è€…å…·æœ‰å†™æƒé™çš„ç›®å½•ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ”¾ç½®æ¶æ„ç¨‹åºå¹¶ä»¥rootæƒé™æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´žæè¿°å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žå­˜åœ¨åˆ©ç”¨ä»·å€¼ï¼Œé€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æ‰§è¡Œæ¶æ„ç¨‹åºè¾¾åˆ°ææƒæ•ˆæžœã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„ä»£ç ä»…ä¸ºGNU GENERAL PUBLIC LICENSEï¼Œæ˜¯å¼€æºåè®®è®¸å¯ï¼Œä¸åŒ…å«ç›´æŽ¥çš„æ”»å‡»payloadæˆ–æ¶æ„ä»£ç ã€‚ä½†licenseæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ä»£ç ï¼Œå¦‚æžœç»“åˆç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œåè®®å†…å®¹ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åˆ›å»ºä¸€ä¸ªåˆæ³•çš„ç¨‹åºï¼Œä½†å…¶è¡Œä¸ºè¿åäº†åè®®æ¡æ¬¾ï¼Œä»Žè€Œé€ æˆæŸå®³ã€‚æ­¤ä»“åº“ä¸­å‘çŽ°ç›´æŽ¥æŠ•æ¯’ä»£ç çš„æ¦‚çŽ‡è¾ƒä½Žï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æ»¥ç”¨é£Žé™©ï¼Œä¼°è®¡æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„Netdata Agentç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 1.44.0-60, < 1.45.3ï¼‰ã€‚
2.  æŸ¥æ‰¾ndsudoå·¥å…·çš„ä½ç½®ã€‚
3.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å‘½ä»¤çš„ç›®å½•ï¼Œä¾‹å¦‚/tmp/evilã€‚
4.  å°†æ¶æ„ç¨‹åºï¼ˆå¦‚åå¼¹shellï¼‰æ”¾ç½®åˆ°/tmp/evilç›®å½•ä¸‹ï¼Œå¹¶å‘½åä¸ºndsudoå°è¯•æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œ`ping`ï¼Œ`date` ç­‰, å…·ä½“å–å†³äºŽ ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼‰ã€‚
5.  ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†/tmp/evilæ·»åŠ åˆ°PATHçš„æœ€å‰é¢ï¼š`export PATH=/tmp/evil:$PATH`ã€‚
6.  è¿è¡Œndsudoï¼Œå®ƒå°†æ‰§è¡Œ/tmp/evilç›®å½•ä¸‹çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**æ¥æº**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡PATHåŠ«æŒæ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata Agentå­˜åœ¨ndsudoï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠå¯æŽ§çš„PATHçŽ¯å¢ƒå˜é‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdataä¸­`ndsudo`å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´žã€‚`ndsudo`æ˜¯ä¸€ä¸ªå…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨`PATH`çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨`PATH`çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆäºŽç³»ç»Ÿç›®å½•çš„ä½ç½®ï¼Œè¯±ä½¿`ndsudo`æ‰§è¡Œè¯¥æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**
1.  æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„`ndsudo`å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶(ä¾‹å¦‚`nvme`)ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œæ”»å‡»è€…å¸Œæœ›æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚æä¾›çš„`payload.c`æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªroot shellã€‚
3.  ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†å½“å‰ç›®å½•(æˆ–åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•)æ·»åŠ åˆ°`PATH`çš„å¼€å¤´ã€‚
4.  è°ƒç”¨`ndsudo`ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ƒå…è®¸æ‰§è¡Œçš„å‘½ä»¤(ä¾‹å¦‚`nvme-list`)ã€‚ç”±äºŽ`PATH`å·²ç»è¢«ä¿®æ”¹ï¼Œ`ndsudo`ä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„`nvme`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»Žè€Œä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºŽæŸ¥æ‰¾`ndsudo`ï¼Œåˆ›å»ºä¸€ä¸ª`nvme` payloadï¼Œä¿®æ”¹`PATH`ï¼Œç„¶åŽæ‰§è¡Œ`ndsudo`ã€‚README.mdæ–‡ä»¶æè¿°äº†å¦‚ä½•ç¼–è¯‘`payload.c`å¹¶ä½¿ç”¨è„šæœ¬ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
æŸ¥çœ‹äº†æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ²¡æœ‰å‘çŽ°ä»»ä½•æŠ•æ¯’ä»£ç ã€‚å…¶ä¸­ï¼ŒCVE-2024-32019.shè„šæœ¬ç”¨äºŽåˆ©ç”¨æ¼æ´žï¼Œpayload.cç”¨äºŽç¼–è¯‘æ¶æ„payloadï¼ŒREADME.mdæ–‡ä»¶æè¿°äº†æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ï¼Œéƒ½æ˜¯æ­£å¸¸çš„åˆ©ç”¨ä»£ç ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**æ¥æº**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata ndsudoå·¥å…·ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªSUID rootçš„ç¨‹åºï¼Œä½†å®ƒä½¿ç”¨äº†PATHçŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡æŒ‡å‘ä¸€ä¸ªè‡ªå·±å¯æŽ§çš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹æ”¾ç½®æ¶æ„ç¨‹åºï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žæ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ£€æŸ¥ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨`/opt`ç›®å½•ä¸‹çš„`ndsudo`ç¨‹åºï¼Œå¹¶ä¸”ç¡®è®¤è¯¥ç¨‹åºæ˜¯å¦ä¸ºrootæ‰€æœ‰ä¸”è®¾ç½®äº†SUIDæƒé™ã€‚åŒæ—¶ï¼Œä½¿ç”¨`strings`å‘½ä»¤æ£€æŸ¥`ndsudo`ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨å¯¹`nvme`ã€`smartctl`ã€`hdparm`æˆ–`sensors`ç­‰å¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¯´æ˜Žè¯¥ç¨‹åºå¯èƒ½å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚
2.  **æ¶æ„ç¨‹åºç¼–è¯‘ï¼š** ç¼–è¯‘ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯è®¾ç½®UIDå’ŒGIDä¸º0ï¼Œç„¶åŽæ‰§è¡Œ`/bin/bash`ï¼Œä»Žè€ŒèŽ·å–root shellã€‚
3.  **æ¶æ„ç¨‹åºä¸Šä¼ ï¼š** é€šè¿‡SFTPå°†ç¼–è¯‘å¥½çš„æ¶æ„ç¨‹åºä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæ”»å‡»è€…å¯æŽ§çš„ç›®å½•ï¼Œä¾‹å¦‚`/tmp`ã€‚
4.  **çŽ¯å¢ƒå˜é‡ä¿®æ”¹ï¼š** ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æ”»å‡»è€…å¯æŽ§çš„ç›®å½•æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ï¼Œç¡®ä¿`ndsudo`ç¨‹åºåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶é¦–å…ˆåœ¨è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ã€‚
5.  **æ¼æ´žè§¦å‘ï¼š** æ‰§è¡Œ`ndsudo`ç¨‹åºï¼Œå½“å®ƒè°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…ä¸Šä¼ çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å–rootæƒé™ã€‚
6.  **äº¤äº’å¼Shellï¼š** æ¼æ´žåˆ©ç”¨ä»£ç æä¾›äº¤äº’å¼shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æ­¤POCä»£ç æœ¬èº«ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œå®žçŽ°æœ¬åœ°ææƒã€‚ä½†æ˜¯ï¼Œè¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ï¼š

*   **ç¼–è¯‘å’Œä¼ è¾“æ¶æ„ä»£ç ï¼š** è„šæœ¬ä¼šè‡ªåŠ¨ç¼–è¯‘Cä»£ç ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚è™½ç„¶Cä»£ç çš„å†…å®¹æ˜¯ææƒï¼Œä½†å¦‚æžœæ¶æ„æ”»å‡»è€…ä¿®æ”¹äº†Cä»£ç ï¼Œå°±å¯èƒ½åŒ…å«å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åŽé—¨ã€æ”¶é›†ä¿¡æ¯ç­‰ã€‚
*   **è¿œç¨‹æ‰§è¡Œä»£ç ï¼š**  è„šæœ¬é€šè¿‡sshæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£Žé™©ï¼Œå¯èƒ½æ‰§è¡Œé¢å¤–çš„æ¶æ„æ“ä½œã€‚
*   **æ®‹ç•™æ–‡ä»¶ï¼š** ç¼–è¯‘åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸Šä¼ çš„æ¶æ„ç¨‹åºå¯èƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç•™ä¸‹ç—•è¿¹ï¼Œå¦‚æžœè¿™äº›æ–‡ä»¶è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å®‰å…¨é—®é¢˜ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é£Žé™©ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œè¯¥POCä»£ç çš„é£Žé™©ä»ç„¶å¯æŽ§ï¼Œä¸»è¦é£Žé™©é›†ä¸­åœ¨ä»£ç çš„ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨ä¸Šã€‚ä¸ºäº†é™ä½Žé£Žé™©ï¼Œå»ºè®®ä»Žå¯ä¿¡çš„æ¥æºèŽ·å–POCä»£ç ï¼Œå¹¶ä»”ç»†æ£€æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿å…¶æ²¡æœ‰æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œåœ¨æµ‹è¯•å®ŒæˆåŽï¼Œåº”åŠæ—¶æ¸…ç†ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ®‹ç•™æ–‡ä»¶ã€‚

æŠ•æ¯’é£Žé™©é¢„ä¼°ä¸º10%ï¼Œå› ä¸ºä»£ç ç›¸å¯¹ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´žéªŒè¯å’Œåˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨è¢«ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**æ¥æº**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°shellè®¿é—®ï¼Œèƒ½å¤Ÿæ‰§è¡Œndsudoå‘½ä»¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2024-32019 æ˜¯ Netdata ä¸­ ndsudo å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudo æ˜¯ä¸€ä¸ª SUID root çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„è„šæœ¬æ”¾ç½®åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆçº§æ›´é«˜çš„ç›®å½•ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ nvmeï¼‰ï¼Œæ¥æ¬ºéª— ndsudo æ‰§è¡Œè¯¥æ¶æ„è„šæœ¬å¹¶èŽ·å¾— root æƒé™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æè¿°äº†ä¸€ç§åˆ©ç”¨æ­¤æ¼æ´žçš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1.  åˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼ˆpoc.pyï¼‰ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
2.  å°†æ­¤è„šæœ¬é‡å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ nvmeï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ ndsudo nvme-listï¼Œè¿™å°†å¯¼è‡´ ndsudo æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“æœ¬èº«æŠ•æ¯’é£Žé™©è¾ƒä½Žã€‚`poc.py` ä»£ç éžå¸¸ç®€å•ï¼Œä»…åŒ…å«ææƒæ‰§è¡Œbashçš„ä»£ç ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„ä»£ç ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¸…æ™°çš„æ¼æ´žåˆ©ç”¨è¯´æ˜Žã€‚ä½†ç”¨æˆ·ä»ç„¶éœ€è¦æ³¨æ„ï¼Œåœ¨å®žé™…çŽ¯å¢ƒä¸­ï¼Œä»Žä¸å¯ä¿¡çš„æ¥æºä¸‹è½½æˆ–å¤åˆ¶æ¼æ´žåˆ©ç”¨ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£Žé™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå†æ‰§è¡Œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žåŽŸç†ï¼š** `ndsudo` ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢å‘½ä»¤çš„è·¯å¾„ä¾èµ–äºŽç”¨æˆ·çš„ `PATH` çŽ¯å¢ƒå˜é‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   åˆ›å»ºæ¶æ„è„šæœ¬ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
    *   å°†æ­¤è„šæœ¬é‡å‘½åä¸º `ndsudo` å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆé€šè¿‡ `ndsudo --help` æŸ¥çœ‹ï¼‰ã€‚
    *   å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œç¡®ä¿æ¶æ„è„šæœ¬ä¼˜å…ˆè¢«æœç´¢åˆ°ã€‚
    *   è¿è¡Œ `ndsudo <allowed_command>`ï¼Œè¿™å°†å¯¼è‡´ `ndsudo` æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´žåˆ©ç”¨è¾ƒä¸ºç®€å•ï¼ŒPOC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä½†åº”æ³¨æ„æ¥æºä¸æ˜Žçš„exploitä»£ç çš„æ½œåœ¨æŠ•æ¯’é£Žé™©ã€‚è¯¥æ¼æ´žå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡æ“çºµ `PATH` çŽ¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨ SUID ç¨‹åº `ndsudo` æå‡è‡³ root æƒé™ã€‚åŠ¡å¿…åŠæ—¶å‡çº§ Netdata ç‰ˆæœ¬ä»¥ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**æ¥æº**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœ¬åœ°ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata agentè¿è¡Œåœ¨å—å½±å“ç‰ˆæœ¬ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰§è¡Œæœ¬åœ°ä»£ç ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·æ‹¥æœ‰ SUID æƒé™ï¼Œå…è®¸æ‰§è¡ŒæŸäº›ç‰¹æƒå‘½ä»¤ã€‚æ¼æ´žçš„æ ¹æºåœ¨äºŽ `ndsudo` ä½¿ç”¨ä¸å®‰å…¨çš„ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ PATH ä¸­æ’å…¥æ¶æ„ç¨‹åºï¼Œè®© `ndsudo` æ‰§è¡Œæ”»å‡»è€…æŽ§åˆ¶çš„ä»£ç ï¼Œä»Žè€Œæå‡æƒé™åˆ° rootã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾ `ndsudo` è·¯å¾„ï¼š** é€šå¸¸ä½äºŽ `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`ï¼Œä½†éœ€è¦é€šè¿‡ `find` å‘½ä»¤ç¡®è®¤ã€‚
2.  **åˆ›å»ºæ¶æ„ç¨‹åºï¼š** åˆ›å»ºä¸€ä¸ª C ç¨‹åºï¼Œè¯¥ç¨‹åºè°ƒç”¨ `setuid(0)` å’Œ `setgid(0)` è®¾ç½®ç”¨æˆ·å’Œç»„ ID ä¸º rootï¼Œç„¶åŽæ‰§è¡Œä¸€ä¸ª shell (ä¾‹å¦‚ `/bin/bash -p`)ã€‚éœ€è¦ä½¿ç”¨ `gcc` ç¼–è¯‘è¯¥ç¨‹åºï¼Œä¾‹å¦‚å‘½åä¸º `arcconf`ã€‚
3.  **ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼š** å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ¶æ„ç¨‹åºä½äºŽ `/tmp` ç›®å½•ä¸‹ï¼Œåˆ™æ‰§è¡Œ `PATH=/tmp:$PATH`ã€‚
4.  **æ‰§è¡Œ `ndsudo` å‘½ä»¤ï¼š** ä½¿ç”¨ `ndsudo` æ‰§è¡Œå®ƒæ”¯æŒçš„å‘½ä»¤ï¼Œä½†è¯¥å‘½ä»¤ä¾èµ–äºŽæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`ã€‚`ndsudo` ä¼šå°è¯•æ‰§è¡Œ `arcconf`ï¼Œä½†ç”±äºŽ PATH çŽ¯å¢ƒå˜é‡è¢«ä¿®æ”¹ï¼Œå®ƒä¼šæ‰§è¡Œæ”»å‡»è€…åœ¨ `/tmp` ç›®å½•ä¸‹åˆ›å»ºçš„æ¶æ„ç¨‹åºã€‚
5.  **èŽ·å¾— root shellï¼š** å¦‚æžœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…å°†èŽ·å¾—ä¸€ä¸ª root shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æä¾›çš„ POC ä»£ç ä¸­ï¼Œ`arcconf.c` çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªææƒçš„ shellï¼Œæ²¡æœ‰æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ ä½†ä»Ž github ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ `arcconf` æ—¶ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½åœ¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä»Ž github ä¸Šä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ½œåœ¨é£Žé™©ï¼Œæ•…æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**æ¥æº**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo æœ¬åœ°æƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·æå‡è‡³ root æƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 å’Œ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Netdataï¼Œä¸” ndsudo å·¥å…·è®¾ç½®äº† SUID root æƒé™ï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ ndsudoã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å®ƒä½¿ç”¨ `PATH` çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ `PATH` çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘æ¶æ„ç›®å½•çš„è·¯å¾„ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªä¸Ž `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤åŒåçš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œä»¥ root æƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§:**

æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´žã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåå¼¹ shellï¼‰çš„ç›®å½•ã€‚
2.  å°†æ¶æ„ç¨‹åºå‘½åä¸º `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œ`nvme-list`ï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ `ndsudo` å‘½ä»¤ã€‚`ndsudo` å°†æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€Œä½¿æ”»å‡»è€…èŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©:**

æ ¹æ®æä¾›çš„ä»£ç åˆ†æžï¼Œè¯¥ä»“åº“ä¼¼ä¹Žä¸»è¦æä¾›äº†ä¸€ä¸ª checker è„šæœ¬æ¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œç®¡ç†å‘˜è¯†åˆ«å’ŒéªŒè¯æ¼æ´žæ˜¯å¦å­˜åœ¨ï¼Œæ—¨åœ¨å¸®åŠ©é˜²å¾¡è€…è¯„ä¼°é£Žé™©å’ŒéªŒè¯è¡¥ä¸ï¼Œè€Œä¸æ˜¯æä¾›æ­¦å™¨åŒ–çš„ PoCã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žã€‚

æ£€æŸ¥å™¨ä»£ç ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (æˆ–å®‰è£…ä½ç½®) çš„ SUID/æ‰€æœ‰æƒã€‚
*   `PATH` ä¸­æ—©äºŽå¸¸è§ç³»ç»Ÿè·¯å¾„çš„å¯å†™ç›®å½•ã€‚
*   `ndsudo` å°è¯•æ‰§è¡Œçš„ç™½åå•å­å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚
*   å¯é€‰åœ°è¿è¡Œ `ndsudo --test <subcommand>` æ¥æ‰“å°å·²è§£æžçš„å‘½ä»¤è€Œä¸æ‰§è¡Œå®ƒ (è°¨æ…Žä½¿ç”¨ï¼Œå…ˆé˜…è¯»ä»£ç )ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º 0%**ã€‚


**é¡¹ç›®åœ°å€:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**æ¥æº**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´žèŽ·å–rootæƒé™ã€‚

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”æ”»å‡»è€…éœ€è¦å…·æœ‰æœ¬åœ°ä½Žæƒé™è´¦å·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ netdata çš„ ndsudo å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢è·¯å¾„ç”± PATH çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨ ndsudo æœç´¢è·¯å¾„ä¸­ï¼Œå½“ ndsudo è°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª C ç¨‹åºï¼Œç¼–è¯‘åŽå¯ä»¥ç›´æŽ¥æ‰§è¡Œä¸€ä¸ªå…·æœ‰ root æƒé™çš„ bash shellã€‚æ”»å‡»è€…éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«æ­¤æ¶æ„ç¨‹åºçš„å¯å†™ç›®å½•ï¼Œç„¶åŽä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ­¤ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚ä¹‹åŽï¼Œå½“ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

ä»£ç ä¸­æ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚å®ƒåªæ˜¯ç®€å•åœ°è®¾ç½® uid å’Œ gid ä¸º 0ï¼Œç„¶åŽæ‰§è¡Œ /bin/bashã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º0%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1.  åˆ©ç”¨éœ€è¦å…ˆèŽ·å¾—ä¸€ä¸ªnetdataè½¯ä»¶çš„ä½Žæƒé™è´¦å·ã€‚
2.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ POC ä¸­çš„ C ç¨‹åºç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„å¯å†™ç›®å½•ã€‚
3.  ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†è¯¥ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚
4.  è§¦å‘ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤ï¼Œè¿™å°†å¯¼è‡´æ¶æ„ç¨‹åºä»¥ root æƒé™æ‰§è¡Œï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

**é¡¹ç›®åœ°å€:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**æ¥æº**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯æå‡è‡³rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 åŠ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”å…·æœ‰æœ¬åœ°shellè®¿é—®æƒé™ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 å­˜åœ¨äºŽNetdataçš„`ndsudo`å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·æ˜¯å…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¼æ´žåŽŸå› æ˜¯`ndsudo`çš„æœç´¢è·¯å¾„ç”±`PATH`çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨å‰é¢ï¼Œå½“`ndsudo`æ‰§è¡Œä¿¡ä»»çš„å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œå®žçŽ°æœ¬åœ°ææƒã€‚æä¾›çš„POCä»£ç é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´žï¼š

1.  **ç¼–è¯‘æ¶æ„payload:**  `poc.c` ç¼–è¯‘æˆ `nvme`ï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯æ‰§è¡Œ `/bin/bash`ï¼Œå¹¶è®¾ç½® UID å’Œ GID ä¸º 0ï¼Œå³rootæƒé™ã€‚
2.  **ä¼ è¾“payloadåˆ°ç›®æ ‡ç³»ç»Ÿ:**  å°†ç¼–è¯‘å¥½çš„`nvme`ä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„`/tmp`ç›®å½•ã€‚
3.  **å‡†å¤‡payloadæ‰§è¡Œ:**  ç»™`/tmp/nvme`æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽå°†`/tmp`æ·»åŠ åˆ°`PATH`çŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ã€‚
4.  **è§¦å‘`ndsudo`æ‰§è¡Œpayload:** è¿è¡Œ`./ndsudo nvme-list`ï¼Œ`ndsudo`ä¼šæ‰§è¡Œ`/tmp/nvme`ï¼Œç”±äºŽè¯¥ç¨‹åºä¼šå°†æƒé™æå‡ä¸ºrootï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥èŽ·å¾—root shellã€‚

**æœ‰æ•ˆæ€§ï¼š** è¯¥POCä»£ç æè¿°çš„åˆ©ç”¨æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„`poc.c`ä»£ç åŠŸèƒ½æ¸…æ™°ï¼Œä»…ä¸ºæ‰§è¡Œ`/bin/bash`å¹¶æå‡æƒé™ï¼Œä¸å­˜åœ¨éšè—çš„æŠ•æ¯’ä»£ç ã€‚READMEæ–‡ä»¶æè¿°äº†å®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`PATH`çŽ¯å¢ƒå˜é‡ï¼Œæ¬ºéª—`ndsudo`æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**æ¥æº**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦netdata agentå­˜åœ¨æ¼æ´žç‰ˆæœ¬ä¸”ndsudoè¢«è°ƒç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata Agentä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªrootç”¨æˆ·æ‹¥æœ‰çš„ã€è®¾ç½®äº†SUIDä½çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒæœ¬åº”åªè¿è¡Œä¸€ç»„å—é™çš„å¤–éƒ¨å‘½ä»¤ï¼Œä½†æ˜¯å…¶æœç´¢è·¯å¾„ç”±PATHçŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æŒ‡å®šndsudoæŸ¥æ‰¾è¿™äº›å‘½ä»¤çš„ä½ç½®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯æ”»å‡»è€…å…·æœ‰å†™æƒé™çš„ç›®å½•ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ”¾ç½®æ¶æ„ç¨‹åºå¹¶ä»¥rootæƒé™æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´žæè¿°å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žå­˜åœ¨åˆ©ç”¨ä»·å€¼ï¼Œé€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æ‰§è¡Œæ¶æ„ç¨‹åºè¾¾åˆ°ææƒæ•ˆæžœã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„ä»£ç ä»…ä¸ºGNU GENERAL PUBLIC LICENSEï¼Œæ˜¯å¼€æºåè®®è®¸å¯ï¼Œä¸åŒ…å«ç›´æŽ¥çš„æ”»å‡»payloadæˆ–æ¶æ„ä»£ç ã€‚ä½†licenseæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ä»£ç ï¼Œå¦‚æžœç»“åˆç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œåè®®å†…å®¹ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åˆ›å»ºä¸€ä¸ªåˆæ³•çš„ç¨‹åºï¼Œä½†å…¶è¡Œä¸ºè¿åäº†åè®®æ¡æ¬¾ï¼Œä»Žè€Œé€ æˆæŸå®³ã€‚æ­¤ä»“åº“ä¸­å‘çŽ°ç›´æŽ¥æŠ•æ¯’ä»£ç çš„æ¦‚çŽ‡è¾ƒä½Žï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æ»¥ç”¨é£Žé™©ï¼Œä¼°è®¡æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„Netdata Agentç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 1.44.0-60, < 1.45.3ï¼‰ã€‚
2.  æŸ¥æ‰¾ndsudoå·¥å…·çš„ä½ç½®ã€‚
3.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å‘½ä»¤çš„ç›®å½•ï¼Œä¾‹å¦‚/tmp/evilã€‚
4.  å°†æ¶æ„ç¨‹åºï¼ˆå¦‚åå¼¹shellï¼‰æ”¾ç½®åˆ°/tmp/evilç›®å½•ä¸‹ï¼Œå¹¶å‘½åä¸ºndsudoå°è¯•æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œ`ping`ï¼Œ`date` ç­‰, å…·ä½“å–å†³äºŽ ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼‰ã€‚
5.  ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†/tmp/evilæ·»åŠ åˆ°PATHçš„æœ€å‰é¢ï¼š`export PATH=/tmp/evil:$PATH`ã€‚
6.  è¿è¡Œndsudoï¼Œå®ƒå°†æ‰§è¡Œ/tmp/evilç›®å½•ä¸‹çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**æ¥æº**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡PATHåŠ«æŒæ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata Agentå­˜åœ¨ndsudoï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠå¯æŽ§çš„PATHçŽ¯å¢ƒå˜é‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdataä¸­`ndsudo`å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´žã€‚`ndsudo`æ˜¯ä¸€ä¸ªå…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨`PATH`çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨`PATH`çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆäºŽç³»ç»Ÿç›®å½•çš„ä½ç½®ï¼Œè¯±ä½¿`ndsudo`æ‰§è¡Œè¯¥æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**
1.  æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„`ndsudo`å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶(ä¾‹å¦‚`nvme`)ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œæ”»å‡»è€…å¸Œæœ›æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚æä¾›çš„`payload.c`æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªroot shellã€‚
3.  ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†å½“å‰ç›®å½•(æˆ–åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•)æ·»åŠ åˆ°`PATH`çš„å¼€å¤´ã€‚
4.  è°ƒç”¨`ndsudo`ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ƒå…è®¸æ‰§è¡Œçš„å‘½ä»¤(ä¾‹å¦‚`nvme-list`)ã€‚ç”±äºŽ`PATH`å·²ç»è¢«ä¿®æ”¹ï¼Œ`ndsudo`ä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„`nvme`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»Žè€Œä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºŽæŸ¥æ‰¾`ndsudo`ï¼Œåˆ›å»ºä¸€ä¸ª`nvme` payloadï¼Œä¿®æ”¹`PATH`ï¼Œç„¶åŽæ‰§è¡Œ`ndsudo`ã€‚README.mdæ–‡ä»¶æè¿°äº†å¦‚ä½•ç¼–è¯‘`payload.c`å¹¶ä½¿ç”¨è„šæœ¬ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
æŸ¥çœ‹äº†æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ²¡æœ‰å‘çŽ°ä»»ä½•æŠ•æ¯’ä»£ç ã€‚å…¶ä¸­ï¼ŒCVE-2024-32019.shè„šæœ¬ç”¨äºŽåˆ©ç”¨æ¼æ´žï¼Œpayload.cç”¨äºŽç¼–è¯‘æ¶æ„payloadï¼ŒREADME.mdæ–‡ä»¶æè¿°äº†æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ï¼Œéƒ½æ˜¯æ­£å¸¸çš„åˆ©ç”¨ä»£ç ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**æ¥æº**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata ndsudoå·¥å…·ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªSUID rootçš„ç¨‹åºï¼Œä½†å®ƒä½¿ç”¨äº†PATHçŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡æŒ‡å‘ä¸€ä¸ªè‡ªå·±å¯æŽ§çš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹æ”¾ç½®æ¶æ„ç¨‹åºï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žæ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ£€æŸ¥ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨`/opt`ç›®å½•ä¸‹çš„`ndsudo`ç¨‹åºï¼Œå¹¶ä¸”ç¡®è®¤è¯¥ç¨‹åºæ˜¯å¦ä¸ºrootæ‰€æœ‰ä¸”è®¾ç½®äº†SUIDæƒé™ã€‚åŒæ—¶ï¼Œä½¿ç”¨`strings`å‘½ä»¤æ£€æŸ¥`ndsudo`ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨å¯¹`nvme`ã€`smartctl`ã€`hdparm`æˆ–`sensors`ç­‰å¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¯´æ˜Žè¯¥ç¨‹åºå¯èƒ½å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚
2.  **æ¶æ„ç¨‹åºç¼–è¯‘ï¼š** ç¼–è¯‘ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯è®¾ç½®UIDå’ŒGIDä¸º0ï¼Œç„¶åŽæ‰§è¡Œ`/bin/bash`ï¼Œä»Žè€ŒèŽ·å–root shellã€‚
3.  **æ¶æ„ç¨‹åºä¸Šä¼ ï¼š** é€šè¿‡SFTPå°†ç¼–è¯‘å¥½çš„æ¶æ„ç¨‹åºä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæ”»å‡»è€…å¯æŽ§çš„ç›®å½•ï¼Œä¾‹å¦‚`/tmp`ã€‚
4.  **çŽ¯å¢ƒå˜é‡ä¿®æ”¹ï¼š** ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æ”»å‡»è€…å¯æŽ§çš„ç›®å½•æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ï¼Œç¡®ä¿`ndsudo`ç¨‹åºåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶é¦–å…ˆåœ¨è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ã€‚
5.  **æ¼æ´žè§¦å‘ï¼š** æ‰§è¡Œ`ndsudo`ç¨‹åºï¼Œå½“å®ƒè°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…ä¸Šä¼ çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å–rootæƒé™ã€‚
6.  **äº¤äº’å¼Shellï¼š** æ¼æ´žåˆ©ç”¨ä»£ç æä¾›äº¤äº’å¼shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æ­¤POCä»£ç æœ¬èº«ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œå®žçŽ°æœ¬åœ°ææƒã€‚ä½†æ˜¯ï¼Œè¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ï¼š

*   **ç¼–è¯‘å’Œä¼ è¾“æ¶æ„ä»£ç ï¼š** è„šæœ¬ä¼šè‡ªåŠ¨ç¼–è¯‘Cä»£ç ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚è™½ç„¶Cä»£ç çš„å†…å®¹æ˜¯ææƒï¼Œä½†å¦‚æžœæ¶æ„æ”»å‡»è€…ä¿®æ”¹äº†Cä»£ç ï¼Œå°±å¯èƒ½åŒ…å«å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åŽé—¨ã€æ”¶é›†ä¿¡æ¯ç­‰ã€‚
*   **è¿œç¨‹æ‰§è¡Œä»£ç ï¼š**  è„šæœ¬é€šè¿‡sshæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£Žé™©ï¼Œå¯èƒ½æ‰§è¡Œé¢å¤–çš„æ¶æ„æ“ä½œã€‚
*   **æ®‹ç•™æ–‡ä»¶ï¼š** ç¼–è¯‘åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸Šä¼ çš„æ¶æ„ç¨‹åºå¯èƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç•™ä¸‹ç—•è¿¹ï¼Œå¦‚æžœè¿™äº›æ–‡ä»¶è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å®‰å…¨é—®é¢˜ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é£Žé™©ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œè¯¥POCä»£ç çš„é£Žé™©ä»ç„¶å¯æŽ§ï¼Œä¸»è¦é£Žé™©é›†ä¸­åœ¨ä»£ç çš„ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨ä¸Šã€‚ä¸ºäº†é™ä½Žé£Žé™©ï¼Œå»ºè®®ä»Žå¯ä¿¡çš„æ¥æºèŽ·å–POCä»£ç ï¼Œå¹¶ä»”ç»†æ£€æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿å…¶æ²¡æœ‰æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œåœ¨æµ‹è¯•å®ŒæˆåŽï¼Œåº”åŠæ—¶æ¸…ç†ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ®‹ç•™æ–‡ä»¶ã€‚

æŠ•æ¯’é£Žé™©é¢„ä¼°ä¸º10%ï¼Œå› ä¸ºä»£ç ç›¸å¯¹ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´žéªŒè¯å’Œåˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨è¢«ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**æ¥æº**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°shellè®¿é—®ï¼Œèƒ½å¤Ÿæ‰§è¡Œndsudoå‘½ä»¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2024-32019 æ˜¯ Netdata ä¸­ ndsudo å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudo æ˜¯ä¸€ä¸ª SUID root çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„è„šæœ¬æ”¾ç½®åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆçº§æ›´é«˜çš„ç›®å½•ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ nvmeï¼‰ï¼Œæ¥æ¬ºéª— ndsudo æ‰§è¡Œè¯¥æ¶æ„è„šæœ¬å¹¶èŽ·å¾— root æƒé™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æè¿°äº†ä¸€ç§åˆ©ç”¨æ­¤æ¼æ´žçš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1.  åˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼ˆpoc.pyï¼‰ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
2.  å°†æ­¤è„šæœ¬é‡å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ nvmeï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ ndsudo nvme-listï¼Œè¿™å°†å¯¼è‡´ ndsudo æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“æœ¬èº«æŠ•æ¯’é£Žé™©è¾ƒä½Žã€‚`poc.py` ä»£ç éžå¸¸ç®€å•ï¼Œä»…åŒ…å«ææƒæ‰§è¡Œbashçš„ä»£ç ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„ä»£ç ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¸…æ™°çš„æ¼æ´žåˆ©ç”¨è¯´æ˜Žã€‚ä½†ç”¨æˆ·ä»ç„¶éœ€è¦æ³¨æ„ï¼Œåœ¨å®žé™…çŽ¯å¢ƒä¸­ï¼Œä»Žä¸å¯ä¿¡çš„æ¥æºä¸‹è½½æˆ–å¤åˆ¶æ¼æ´žåˆ©ç”¨ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£Žé™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå†æ‰§è¡Œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žåŽŸç†ï¼š** `ndsudo` ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢å‘½ä»¤çš„è·¯å¾„ä¾èµ–äºŽç”¨æˆ·çš„ `PATH` çŽ¯å¢ƒå˜é‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   åˆ›å»ºæ¶æ„è„šæœ¬ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
    *   å°†æ­¤è„šæœ¬é‡å‘½åä¸º `ndsudo` å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆé€šè¿‡ `ndsudo --help` æŸ¥çœ‹ï¼‰ã€‚
    *   å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œç¡®ä¿æ¶æ„è„šæœ¬ä¼˜å…ˆè¢«æœç´¢åˆ°ã€‚
    *   è¿è¡Œ `ndsudo <allowed_command>`ï¼Œè¿™å°†å¯¼è‡´ `ndsudo` æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´žåˆ©ç”¨è¾ƒä¸ºç®€å•ï¼ŒPOC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä½†åº”æ³¨æ„æ¥æºä¸æ˜Žçš„exploitä»£ç çš„æ½œåœ¨æŠ•æ¯’é£Žé™©ã€‚è¯¥æ¼æ´žå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡æ“çºµ `PATH` çŽ¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨ SUID ç¨‹åº `ndsudo` æå‡è‡³ root æƒé™ã€‚åŠ¡å¿…åŠæ—¶å‡çº§ Netdata ç‰ˆæœ¬ä»¥ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**æ¥æº**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœ¬åœ°ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata agentè¿è¡Œåœ¨å—å½±å“ç‰ˆæœ¬ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰§è¡Œæœ¬åœ°ä»£ç ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·æ‹¥æœ‰ SUID æƒé™ï¼Œå…è®¸æ‰§è¡ŒæŸäº›ç‰¹æƒå‘½ä»¤ã€‚æ¼æ´žçš„æ ¹æºåœ¨äºŽ `ndsudo` ä½¿ç”¨ä¸å®‰å…¨çš„ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ PATH ä¸­æ’å…¥æ¶æ„ç¨‹åºï¼Œè®© `ndsudo` æ‰§è¡Œæ”»å‡»è€…æŽ§åˆ¶çš„ä»£ç ï¼Œä»Žè€Œæå‡æƒé™åˆ° rootã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾ `ndsudo` è·¯å¾„ï¼š** é€šå¸¸ä½äºŽ `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`ï¼Œä½†éœ€è¦é€šè¿‡ `find` å‘½ä»¤ç¡®è®¤ã€‚
2.  **åˆ›å»ºæ¶æ„ç¨‹åºï¼š** åˆ›å»ºä¸€ä¸ª C ç¨‹åºï¼Œè¯¥ç¨‹åºè°ƒç”¨ `setuid(0)` å’Œ `setgid(0)` è®¾ç½®ç”¨æˆ·å’Œç»„ ID ä¸º rootï¼Œç„¶åŽæ‰§è¡Œä¸€ä¸ª shell (ä¾‹å¦‚ `/bin/bash -p`)ã€‚éœ€è¦ä½¿ç”¨ `gcc` ç¼–è¯‘è¯¥ç¨‹åºï¼Œä¾‹å¦‚å‘½åä¸º `arcconf`ã€‚
3.  **ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼š** å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ¶æ„ç¨‹åºä½äºŽ `/tmp` ç›®å½•ä¸‹ï¼Œåˆ™æ‰§è¡Œ `PATH=/tmp:$PATH`ã€‚
4.  **æ‰§è¡Œ `ndsudo` å‘½ä»¤ï¼š** ä½¿ç”¨ `ndsudo` æ‰§è¡Œå®ƒæ”¯æŒçš„å‘½ä»¤ï¼Œä½†è¯¥å‘½ä»¤ä¾èµ–äºŽæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`ã€‚`ndsudo` ä¼šå°è¯•æ‰§è¡Œ `arcconf`ï¼Œä½†ç”±äºŽ PATH çŽ¯å¢ƒå˜é‡è¢«ä¿®æ”¹ï¼Œå®ƒä¼šæ‰§è¡Œæ”»å‡»è€…åœ¨ `/tmp` ç›®å½•ä¸‹åˆ›å»ºçš„æ¶æ„ç¨‹åºã€‚
5.  **èŽ·å¾— root shellï¼š** å¦‚æžœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…å°†èŽ·å¾—ä¸€ä¸ª root shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æä¾›çš„ POC ä»£ç ä¸­ï¼Œ`arcconf.c` çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªææƒçš„ shellï¼Œæ²¡æœ‰æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ ä½†ä»Ž github ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ `arcconf` æ—¶ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½åœ¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä»Ž github ä¸Šä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ½œåœ¨é£Žé™©ï¼Œæ•…æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**æ¥æº**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo æœ¬åœ°æƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·æå‡è‡³ root æƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 å’Œ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Netdataï¼Œä¸” ndsudo å·¥å…·è®¾ç½®äº† SUID root æƒé™ï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ ndsudoã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å®ƒä½¿ç”¨ `PATH` çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ `PATH` çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘æ¶æ„ç›®å½•çš„è·¯å¾„ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªä¸Ž `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤åŒåçš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œä»¥ root æƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§:**

æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´žã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåå¼¹ shellï¼‰çš„ç›®å½•ã€‚
2.  å°†æ¶æ„ç¨‹åºå‘½åä¸º `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œ`nvme-list`ï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ `ndsudo` å‘½ä»¤ã€‚`ndsudo` å°†æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€Œä½¿æ”»å‡»è€…èŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©:**

æ ¹æ®æä¾›çš„ä»£ç åˆ†æžï¼Œè¯¥ä»“åº“ä¼¼ä¹Žä¸»è¦æä¾›äº†ä¸€ä¸ª checker è„šæœ¬æ¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œç®¡ç†å‘˜è¯†åˆ«å’ŒéªŒè¯æ¼æ´žæ˜¯å¦å­˜åœ¨ï¼Œæ—¨åœ¨å¸®åŠ©é˜²å¾¡è€…è¯„ä¼°é£Žé™©å’ŒéªŒè¯è¡¥ä¸ï¼Œè€Œä¸æ˜¯æä¾›æ­¦å™¨åŒ–çš„ PoCã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žã€‚

æ£€æŸ¥å™¨ä»£ç ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (æˆ–å®‰è£…ä½ç½®) çš„ SUID/æ‰€æœ‰æƒã€‚
*   `PATH` ä¸­æ—©äºŽå¸¸è§ç³»ç»Ÿè·¯å¾„çš„å¯å†™ç›®å½•ã€‚
*   `ndsudo` å°è¯•æ‰§è¡Œçš„ç™½åå•å­å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚
*   å¯é€‰åœ°è¿è¡Œ `ndsudo --test <subcommand>` æ¥æ‰“å°å·²è§£æžçš„å‘½ä»¤è€Œä¸æ‰§è¡Œå®ƒ (è°¨æ…Žä½¿ç”¨ï¼Œå…ˆé˜…è¯»ä»£ç )ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º 0%**ã€‚


**é¡¹ç›®åœ°å€:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**æ¥æº**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´žèŽ·å–rootæƒé™ã€‚

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”æ”»å‡»è€…éœ€è¦å…·æœ‰æœ¬åœ°ä½Žæƒé™è´¦å·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ netdata çš„ ndsudo å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢è·¯å¾„ç”± PATH çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨ ndsudo æœç´¢è·¯å¾„ä¸­ï¼Œå½“ ndsudo è°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª C ç¨‹åºï¼Œç¼–è¯‘åŽå¯ä»¥ç›´æŽ¥æ‰§è¡Œä¸€ä¸ªå…·æœ‰ root æƒé™çš„ bash shellã€‚æ”»å‡»è€…éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«æ­¤æ¶æ„ç¨‹åºçš„å¯å†™ç›®å½•ï¼Œç„¶åŽä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ­¤ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚ä¹‹åŽï¼Œå½“ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

ä»£ç ä¸­æ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚å®ƒåªæ˜¯ç®€å•åœ°è®¾ç½® uid å’Œ gid ä¸º 0ï¼Œç„¶åŽæ‰§è¡Œ /bin/bashã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º0%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1.  åˆ©ç”¨éœ€è¦å…ˆèŽ·å¾—ä¸€ä¸ªnetdataè½¯ä»¶çš„ä½Žæƒé™è´¦å·ã€‚
2.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ POC ä¸­çš„ C ç¨‹åºç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„å¯å†™ç›®å½•ã€‚
3.  ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†è¯¥ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚
4.  è§¦å‘ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤ï¼Œè¿™å°†å¯¼è‡´æ¶æ„ç¨‹åºä»¥ root æƒé™æ‰§è¡Œï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

**é¡¹ç›®åœ°å€:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**æ¥æº**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯æå‡è‡³rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 åŠ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”å…·æœ‰æœ¬åœ°shellè®¿é—®æƒé™ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 å­˜åœ¨äºŽNetdataçš„`ndsudo`å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·æ˜¯å…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¼æ´žåŽŸå› æ˜¯`ndsudo`çš„æœç´¢è·¯å¾„ç”±`PATH`çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨å‰é¢ï¼Œå½“`ndsudo`æ‰§è¡Œä¿¡ä»»çš„å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œå®žçŽ°æœ¬åœ°ææƒã€‚æä¾›çš„POCä»£ç é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´žï¼š

1.  **ç¼–è¯‘æ¶æ„payload:**  `poc.c` ç¼–è¯‘æˆ `nvme`ï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯æ‰§è¡Œ `/bin/bash`ï¼Œå¹¶è®¾ç½® UID å’Œ GID ä¸º 0ï¼Œå³rootæƒé™ã€‚
2.  **ä¼ è¾“payloadåˆ°ç›®æ ‡ç³»ç»Ÿ:**  å°†ç¼–è¯‘å¥½çš„`nvme`ä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„`/tmp`ç›®å½•ã€‚
3.  **å‡†å¤‡payloadæ‰§è¡Œ:**  ç»™`/tmp/nvme`æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽå°†`/tmp`æ·»åŠ åˆ°`PATH`çŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ã€‚
4.  **è§¦å‘`ndsudo`æ‰§è¡Œpayload:** è¿è¡Œ`./ndsudo nvme-list`ï¼Œ`ndsudo`ä¼šæ‰§è¡Œ`/tmp/nvme`ï¼Œç”±äºŽè¯¥ç¨‹åºä¼šå°†æƒé™æå‡ä¸ºrootï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥èŽ·å¾—root shellã€‚

**æœ‰æ•ˆæ€§ï¼š** è¯¥POCä»£ç æè¿°çš„åˆ©ç”¨æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„`poc.c`ä»£ç åŠŸèƒ½æ¸…æ™°ï¼Œä»…ä¸ºæ‰§è¡Œ`/bin/bash`å¹¶æå‡æƒé™ï¼Œä¸å­˜åœ¨éšè—çš„æŠ•æ¯’ä»£ç ã€‚READMEæ–‡ä»¶æè¿°äº†å®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`PATH`çŽ¯å¢ƒå˜é‡ï¼Œæ¬ºéª—`ndsudo`æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**æ¥æº**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦netdata agentå­˜åœ¨æ¼æ´žç‰ˆæœ¬ä¸”ndsudoè¢«è°ƒç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata Agentä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªrootç”¨æˆ·æ‹¥æœ‰çš„ã€è®¾ç½®äº†SUIDä½çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒæœ¬åº”åªè¿è¡Œä¸€ç»„å—é™çš„å¤–éƒ¨å‘½ä»¤ï¼Œä½†æ˜¯å…¶æœç´¢è·¯å¾„ç”±PATHçŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æŒ‡å®šndsudoæŸ¥æ‰¾è¿™äº›å‘½ä»¤çš„ä½ç½®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯æ”»å‡»è€…å…·æœ‰å†™æƒé™çš„ç›®å½•ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ”¾ç½®æ¶æ„ç¨‹åºå¹¶ä»¥rootæƒé™æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´žæè¿°å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žå­˜åœ¨åˆ©ç”¨ä»·å€¼ï¼Œé€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æ‰§è¡Œæ¶æ„ç¨‹åºè¾¾åˆ°ææƒæ•ˆæžœã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„ä»£ç ä»…ä¸ºGNU GENERAL PUBLIC LICENSEï¼Œæ˜¯å¼€æºåè®®è®¸å¯ï¼Œä¸åŒ…å«ç›´æŽ¥çš„æ”»å‡»payloadæˆ–æ¶æ„ä»£ç ã€‚ä½†licenseæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ä»£ç ï¼Œå¦‚æžœç»“åˆç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œåè®®å†…å®¹ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åˆ›å»ºä¸€ä¸ªåˆæ³•çš„ç¨‹åºï¼Œä½†å…¶è¡Œä¸ºè¿åäº†åè®®æ¡æ¬¾ï¼Œä»Žè€Œé€ æˆæŸå®³ã€‚æ­¤ä»“åº“ä¸­å‘çŽ°ç›´æŽ¥æŠ•æ¯’ä»£ç çš„æ¦‚çŽ‡è¾ƒä½Žï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æ»¥ç”¨é£Žé™©ï¼Œä¼°è®¡æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„Netdata Agentç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 1.44.0-60, < 1.45.3ï¼‰ã€‚
2.  æŸ¥æ‰¾ndsudoå·¥å…·çš„ä½ç½®ã€‚
3.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å‘½ä»¤çš„ç›®å½•ï¼Œä¾‹å¦‚/tmp/evilã€‚
4.  å°†æ¶æ„ç¨‹åºï¼ˆå¦‚åå¼¹shellï¼‰æ”¾ç½®åˆ°/tmp/evilç›®å½•ä¸‹ï¼Œå¹¶å‘½åä¸ºndsudoå°è¯•æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œ`ping`ï¼Œ`date` ç­‰, å…·ä½“å–å†³äºŽ ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼‰ã€‚
5.  ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†/tmp/evilæ·»åŠ åˆ°PATHçš„æœ€å‰é¢ï¼š`export PATH=/tmp/evil:$PATH`ã€‚
6.  è¿è¡Œndsudoï¼Œå®ƒå°†æ‰§è¡Œ/tmp/evilç›®å½•ä¸‹çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**æ¥æº**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡PATHåŠ«æŒæ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata Agentå­˜åœ¨ndsudoï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠå¯æŽ§çš„PATHçŽ¯å¢ƒå˜é‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdataä¸­`ndsudo`å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´žã€‚`ndsudo`æ˜¯ä¸€ä¸ªå…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨`PATH`çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨`PATH`çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆäºŽç³»ç»Ÿç›®å½•çš„ä½ç½®ï¼Œè¯±ä½¿`ndsudo`æ‰§è¡Œè¯¥æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**
1.  æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„`ndsudo`å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶(ä¾‹å¦‚`nvme`)ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œæ”»å‡»è€…å¸Œæœ›æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚æä¾›çš„`payload.c`æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªroot shellã€‚
3.  ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†å½“å‰ç›®å½•(æˆ–åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•)æ·»åŠ åˆ°`PATH`çš„å¼€å¤´ã€‚
4.  è°ƒç”¨`ndsudo`ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ƒå…è®¸æ‰§è¡Œçš„å‘½ä»¤(ä¾‹å¦‚`nvme-list`)ã€‚ç”±äºŽ`PATH`å·²ç»è¢«ä¿®æ”¹ï¼Œ`ndsudo`ä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„`nvme`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»Žè€Œä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºŽæŸ¥æ‰¾`ndsudo`ï¼Œåˆ›å»ºä¸€ä¸ª`nvme` payloadï¼Œä¿®æ”¹`PATH`ï¼Œç„¶åŽæ‰§è¡Œ`ndsudo`ã€‚README.mdæ–‡ä»¶æè¿°äº†å¦‚ä½•ç¼–è¯‘`payload.c`å¹¶ä½¿ç”¨è„šæœ¬ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
æŸ¥çœ‹äº†æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ²¡æœ‰å‘çŽ°ä»»ä½•æŠ•æ¯’ä»£ç ã€‚å…¶ä¸­ï¼ŒCVE-2024-32019.shè„šæœ¬ç”¨äºŽåˆ©ç”¨æ¼æ´žï¼Œpayload.cç”¨äºŽç¼–è¯‘æ¶æ„payloadï¼ŒREADME.mdæ–‡ä»¶æè¿°äº†æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ï¼Œéƒ½æ˜¯æ­£å¸¸çš„åˆ©ç”¨ä»£ç ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**æ¥æº**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata ndsudoå·¥å…·ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªSUID rootçš„ç¨‹åºï¼Œä½†å®ƒä½¿ç”¨äº†PATHçŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡æŒ‡å‘ä¸€ä¸ªè‡ªå·±å¯æŽ§çš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹æ”¾ç½®æ¶æ„ç¨‹åºï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žæ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ£€æŸ¥ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨`/opt`ç›®å½•ä¸‹çš„`ndsudo`ç¨‹åºï¼Œå¹¶ä¸”ç¡®è®¤è¯¥ç¨‹åºæ˜¯å¦ä¸ºrootæ‰€æœ‰ä¸”è®¾ç½®äº†SUIDæƒé™ã€‚åŒæ—¶ï¼Œä½¿ç”¨`strings`å‘½ä»¤æ£€æŸ¥`ndsudo`ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨å¯¹`nvme`ã€`smartctl`ã€`hdparm`æˆ–`sensors`ç­‰å¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¯´æ˜Žè¯¥ç¨‹åºå¯èƒ½å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚
2.  **æ¶æ„ç¨‹åºç¼–è¯‘ï¼š** ç¼–è¯‘ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯è®¾ç½®UIDå’ŒGIDä¸º0ï¼Œç„¶åŽæ‰§è¡Œ`/bin/bash`ï¼Œä»Žè€ŒèŽ·å–root shellã€‚
3.  **æ¶æ„ç¨‹åºä¸Šä¼ ï¼š** é€šè¿‡SFTPå°†ç¼–è¯‘å¥½çš„æ¶æ„ç¨‹åºä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæ”»å‡»è€…å¯æŽ§çš„ç›®å½•ï¼Œä¾‹å¦‚`/tmp`ã€‚
4.  **çŽ¯å¢ƒå˜é‡ä¿®æ”¹ï¼š** ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æ”»å‡»è€…å¯æŽ§çš„ç›®å½•æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ï¼Œç¡®ä¿`ndsudo`ç¨‹åºåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶é¦–å…ˆåœ¨è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ã€‚
5.  **æ¼æ´žè§¦å‘ï¼š** æ‰§è¡Œ`ndsudo`ç¨‹åºï¼Œå½“å®ƒè°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…ä¸Šä¼ çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å–rootæƒé™ã€‚
6.  **äº¤äº’å¼Shellï¼š** æ¼æ´žåˆ©ç”¨ä»£ç æä¾›äº¤äº’å¼shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æ­¤POCä»£ç æœ¬èº«ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œå®žçŽ°æœ¬åœ°ææƒã€‚ä½†æ˜¯ï¼Œè¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ï¼š

*   **ç¼–è¯‘å’Œä¼ è¾“æ¶æ„ä»£ç ï¼š** è„šæœ¬ä¼šè‡ªåŠ¨ç¼–è¯‘Cä»£ç ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚è™½ç„¶Cä»£ç çš„å†…å®¹æ˜¯ææƒï¼Œä½†å¦‚æžœæ¶æ„æ”»å‡»è€…ä¿®æ”¹äº†Cä»£ç ï¼Œå°±å¯èƒ½åŒ…å«å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åŽé—¨ã€æ”¶é›†ä¿¡æ¯ç­‰ã€‚
*   **è¿œç¨‹æ‰§è¡Œä»£ç ï¼š**  è„šæœ¬é€šè¿‡sshæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£Žé™©ï¼Œå¯èƒ½æ‰§è¡Œé¢å¤–çš„æ¶æ„æ“ä½œã€‚
*   **æ®‹ç•™æ–‡ä»¶ï¼š** ç¼–è¯‘åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸Šä¼ çš„æ¶æ„ç¨‹åºå¯èƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç•™ä¸‹ç—•è¿¹ï¼Œå¦‚æžœè¿™äº›æ–‡ä»¶è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å®‰å…¨é—®é¢˜ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é£Žé™©ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œè¯¥POCä»£ç çš„é£Žé™©ä»ç„¶å¯æŽ§ï¼Œä¸»è¦é£Žé™©é›†ä¸­åœ¨ä»£ç çš„ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨ä¸Šã€‚ä¸ºäº†é™ä½Žé£Žé™©ï¼Œå»ºè®®ä»Žå¯ä¿¡çš„æ¥æºèŽ·å–POCä»£ç ï¼Œå¹¶ä»”ç»†æ£€æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿å…¶æ²¡æœ‰æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œåœ¨æµ‹è¯•å®ŒæˆåŽï¼Œåº”åŠæ—¶æ¸…ç†ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ®‹ç•™æ–‡ä»¶ã€‚

æŠ•æ¯’é£Žé™©é¢„ä¼°ä¸º10%ï¼Œå› ä¸ºä»£ç ç›¸å¯¹ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´žéªŒè¯å’Œåˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨è¢«ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**æ¥æº**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°shellè®¿é—®ï¼Œèƒ½å¤Ÿæ‰§è¡Œndsudoå‘½ä»¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2024-32019 æ˜¯ Netdata ä¸­ ndsudo å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudo æ˜¯ä¸€ä¸ª SUID root çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„è„šæœ¬æ”¾ç½®åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆçº§æ›´é«˜çš„ç›®å½•ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ nvmeï¼‰ï¼Œæ¥æ¬ºéª— ndsudo æ‰§è¡Œè¯¥æ¶æ„è„šæœ¬å¹¶èŽ·å¾— root æƒé™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æè¿°äº†ä¸€ç§åˆ©ç”¨æ­¤æ¼æ´žçš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1.  åˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼ˆpoc.pyï¼‰ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
2.  å°†æ­¤è„šæœ¬é‡å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ nvmeï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ ndsudo nvme-listï¼Œè¿™å°†å¯¼è‡´ ndsudo æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“æœ¬èº«æŠ•æ¯’é£Žé™©è¾ƒä½Žã€‚`poc.py` ä»£ç éžå¸¸ç®€å•ï¼Œä»…åŒ…å«ææƒæ‰§è¡Œbashçš„ä»£ç ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„ä»£ç ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¸…æ™°çš„æ¼æ´žåˆ©ç”¨è¯´æ˜Žã€‚ä½†ç”¨æˆ·ä»ç„¶éœ€è¦æ³¨æ„ï¼Œåœ¨å®žé™…çŽ¯å¢ƒä¸­ï¼Œä»Žä¸å¯ä¿¡çš„æ¥æºä¸‹è½½æˆ–å¤åˆ¶æ¼æ´žåˆ©ç”¨ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£Žé™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå†æ‰§è¡Œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žåŽŸç†ï¼š** `ndsudo` ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢å‘½ä»¤çš„è·¯å¾„ä¾èµ–äºŽç”¨æˆ·çš„ `PATH` çŽ¯å¢ƒå˜é‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   åˆ›å»ºæ¶æ„è„šæœ¬ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
    *   å°†æ­¤è„šæœ¬é‡å‘½åä¸º `ndsudo` å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆé€šè¿‡ `ndsudo --help` æŸ¥çœ‹ï¼‰ã€‚
    *   å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œç¡®ä¿æ¶æ„è„šæœ¬ä¼˜å…ˆè¢«æœç´¢åˆ°ã€‚
    *   è¿è¡Œ `ndsudo <allowed_command>`ï¼Œè¿™å°†å¯¼è‡´ `ndsudo` æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´žåˆ©ç”¨è¾ƒä¸ºç®€å•ï¼ŒPOC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä½†åº”æ³¨æ„æ¥æºä¸æ˜Žçš„exploitä»£ç çš„æ½œåœ¨æŠ•æ¯’é£Žé™©ã€‚è¯¥æ¼æ´žå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡æ“çºµ `PATH` çŽ¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨ SUID ç¨‹åº `ndsudo` æå‡è‡³ root æƒé™ã€‚åŠ¡å¿…åŠæ—¶å‡çº§ Netdata ç‰ˆæœ¬ä»¥ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**æ¥æº**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœ¬åœ°ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata agentè¿è¡Œåœ¨å—å½±å“ç‰ˆæœ¬ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰§è¡Œæœ¬åœ°ä»£ç ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·æ‹¥æœ‰ SUID æƒé™ï¼Œå…è®¸æ‰§è¡ŒæŸäº›ç‰¹æƒå‘½ä»¤ã€‚æ¼æ´žçš„æ ¹æºåœ¨äºŽ `ndsudo` ä½¿ç”¨ä¸å®‰å…¨çš„ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ PATH ä¸­æ’å…¥æ¶æ„ç¨‹åºï¼Œè®© `ndsudo` æ‰§è¡Œæ”»å‡»è€…æŽ§åˆ¶çš„ä»£ç ï¼Œä»Žè€Œæå‡æƒé™åˆ° rootã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾ `ndsudo` è·¯å¾„ï¼š** é€šå¸¸ä½äºŽ `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`ï¼Œä½†éœ€è¦é€šè¿‡ `find` å‘½ä»¤ç¡®è®¤ã€‚
2.  **åˆ›å»ºæ¶æ„ç¨‹åºï¼š** åˆ›å»ºä¸€ä¸ª C ç¨‹åºï¼Œè¯¥ç¨‹åºè°ƒç”¨ `setuid(0)` å’Œ `setgid(0)` è®¾ç½®ç”¨æˆ·å’Œç»„ ID ä¸º rootï¼Œç„¶åŽæ‰§è¡Œä¸€ä¸ª shell (ä¾‹å¦‚ `/bin/bash -p`)ã€‚éœ€è¦ä½¿ç”¨ `gcc` ç¼–è¯‘è¯¥ç¨‹åºï¼Œä¾‹å¦‚å‘½åä¸º `arcconf`ã€‚
3.  **ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼š** å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ¶æ„ç¨‹åºä½äºŽ `/tmp` ç›®å½•ä¸‹ï¼Œåˆ™æ‰§è¡Œ `PATH=/tmp:$PATH`ã€‚
4.  **æ‰§è¡Œ `ndsudo` å‘½ä»¤ï¼š** ä½¿ç”¨ `ndsudo` æ‰§è¡Œå®ƒæ”¯æŒçš„å‘½ä»¤ï¼Œä½†è¯¥å‘½ä»¤ä¾èµ–äºŽæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`ã€‚`ndsudo` ä¼šå°è¯•æ‰§è¡Œ `arcconf`ï¼Œä½†ç”±äºŽ PATH çŽ¯å¢ƒå˜é‡è¢«ä¿®æ”¹ï¼Œå®ƒä¼šæ‰§è¡Œæ”»å‡»è€…åœ¨ `/tmp` ç›®å½•ä¸‹åˆ›å»ºçš„æ¶æ„ç¨‹åºã€‚
5.  **èŽ·å¾— root shellï¼š** å¦‚æžœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…å°†èŽ·å¾—ä¸€ä¸ª root shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æä¾›çš„ POC ä»£ç ä¸­ï¼Œ`arcconf.c` çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªææƒçš„ shellï¼Œæ²¡æœ‰æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ ä½†ä»Ž github ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ `arcconf` æ—¶ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½åœ¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä»Ž github ä¸Šä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ½œåœ¨é£Žé™©ï¼Œæ•…æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**æ¥æº**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo æœ¬åœ°æƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·æå‡è‡³ root æƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 å’Œ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Netdataï¼Œä¸” ndsudo å·¥å…·è®¾ç½®äº† SUID root æƒé™ï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ ndsudoã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å®ƒä½¿ç”¨ `PATH` çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ `PATH` çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘æ¶æ„ç›®å½•çš„è·¯å¾„ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªä¸Ž `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤åŒåçš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œä»¥ root æƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§:**

æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´žã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåå¼¹ shellï¼‰çš„ç›®å½•ã€‚
2.  å°†æ¶æ„ç¨‹åºå‘½åä¸º `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œ`nvme-list`ï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ `ndsudo` å‘½ä»¤ã€‚`ndsudo` å°†æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€Œä½¿æ”»å‡»è€…èŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©:**

æ ¹æ®æä¾›çš„ä»£ç åˆ†æžï¼Œè¯¥ä»“åº“ä¼¼ä¹Žä¸»è¦æä¾›äº†ä¸€ä¸ª checker è„šæœ¬æ¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œç®¡ç†å‘˜è¯†åˆ«å’ŒéªŒè¯æ¼æ´žæ˜¯å¦å­˜åœ¨ï¼Œæ—¨åœ¨å¸®åŠ©é˜²å¾¡è€…è¯„ä¼°é£Žé™©å’ŒéªŒè¯è¡¥ä¸ï¼Œè€Œä¸æ˜¯æä¾›æ­¦å™¨åŒ–çš„ PoCã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žã€‚

æ£€æŸ¥å™¨ä»£ç ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (æˆ–å®‰è£…ä½ç½®) çš„ SUID/æ‰€æœ‰æƒã€‚
*   `PATH` ä¸­æ—©äºŽå¸¸è§ç³»ç»Ÿè·¯å¾„çš„å¯å†™ç›®å½•ã€‚
*   `ndsudo` å°è¯•æ‰§è¡Œçš„ç™½åå•å­å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚
*   å¯é€‰åœ°è¿è¡Œ `ndsudo --test <subcommand>` æ¥æ‰“å°å·²è§£æžçš„å‘½ä»¤è€Œä¸æ‰§è¡Œå®ƒ (è°¨æ…Žä½¿ç”¨ï¼Œå…ˆé˜…è¯»ä»£ç )ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º 0%**ã€‚


**é¡¹ç›®åœ°å€:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**æ¥æº**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´žèŽ·å–rootæƒé™ã€‚

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”æ”»å‡»è€…éœ€è¦å…·æœ‰æœ¬åœ°ä½Žæƒé™è´¦å·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ netdata çš„ ndsudo å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢è·¯å¾„ç”± PATH çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨ ndsudo æœç´¢è·¯å¾„ä¸­ï¼Œå½“ ndsudo è°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª C ç¨‹åºï¼Œç¼–è¯‘åŽå¯ä»¥ç›´æŽ¥æ‰§è¡Œä¸€ä¸ªå…·æœ‰ root æƒé™çš„ bash shellã€‚æ”»å‡»è€…éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«æ­¤æ¶æ„ç¨‹åºçš„å¯å†™ç›®å½•ï¼Œç„¶åŽä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ­¤ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚ä¹‹åŽï¼Œå½“ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

ä»£ç ä¸­æ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚å®ƒåªæ˜¯ç®€å•åœ°è®¾ç½® uid å’Œ gid ä¸º 0ï¼Œç„¶åŽæ‰§è¡Œ /bin/bashã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º0%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1.  åˆ©ç”¨éœ€è¦å…ˆèŽ·å¾—ä¸€ä¸ªnetdataè½¯ä»¶çš„ä½Žæƒé™è´¦å·ã€‚
2.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ POC ä¸­çš„ C ç¨‹åºç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„å¯å†™ç›®å½•ã€‚
3.  ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†è¯¥ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚
4.  è§¦å‘ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤ï¼Œè¿™å°†å¯¼è‡´æ¶æ„ç¨‹åºä»¥ root æƒé™æ‰§è¡Œï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

**é¡¹ç›®åœ°å€:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**æ¥æº**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯æå‡è‡³rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 åŠ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”å…·æœ‰æœ¬åœ°shellè®¿é—®æƒé™ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 å­˜åœ¨äºŽNetdataçš„`ndsudo`å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·æ˜¯å…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¼æ´žåŽŸå› æ˜¯`ndsudo`çš„æœç´¢è·¯å¾„ç”±`PATH`çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨å‰é¢ï¼Œå½“`ndsudo`æ‰§è¡Œä¿¡ä»»çš„å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œå®žçŽ°æœ¬åœ°ææƒã€‚æä¾›çš„POCä»£ç é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´žï¼š

1.  **ç¼–è¯‘æ¶æ„payload:**  `poc.c` ç¼–è¯‘æˆ `nvme`ï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯æ‰§è¡Œ `/bin/bash`ï¼Œå¹¶è®¾ç½® UID å’Œ GID ä¸º 0ï¼Œå³rootæƒé™ã€‚
2.  **ä¼ è¾“payloadåˆ°ç›®æ ‡ç³»ç»Ÿ:**  å°†ç¼–è¯‘å¥½çš„`nvme`ä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„`/tmp`ç›®å½•ã€‚
3.  **å‡†å¤‡payloadæ‰§è¡Œ:**  ç»™`/tmp/nvme`æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽå°†`/tmp`æ·»åŠ åˆ°`PATH`çŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ã€‚
4.  **è§¦å‘`ndsudo`æ‰§è¡Œpayload:** è¿è¡Œ`./ndsudo nvme-list`ï¼Œ`ndsudo`ä¼šæ‰§è¡Œ`/tmp/nvme`ï¼Œç”±äºŽè¯¥ç¨‹åºä¼šå°†æƒé™æå‡ä¸ºrootï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥èŽ·å¾—root shellã€‚

**æœ‰æ•ˆæ€§ï¼š** è¯¥POCä»£ç æè¿°çš„åˆ©ç”¨æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„`poc.c`ä»£ç åŠŸèƒ½æ¸…æ™°ï¼Œä»…ä¸ºæ‰§è¡Œ`/bin/bash`å¹¶æå‡æƒé™ï¼Œä¸å­˜åœ¨éšè—çš„æŠ•æ¯’ä»£ç ã€‚READMEæ–‡ä»¶æè¿°äº†å®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`PATH`çŽ¯å¢ƒå˜é‡ï¼Œæ¬ºéª—`ndsudo`æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**æ¥æº**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦netdata agentå­˜åœ¨æ¼æ´žç‰ˆæœ¬ä¸”ndsudoè¢«è°ƒç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata Agentä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªrootç”¨æˆ·æ‹¥æœ‰çš„ã€è®¾ç½®äº†SUIDä½çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒæœ¬åº”åªè¿è¡Œä¸€ç»„å—é™çš„å¤–éƒ¨å‘½ä»¤ï¼Œä½†æ˜¯å…¶æœç´¢è·¯å¾„ç”±PATHçŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æŒ‡å®šndsudoæŸ¥æ‰¾è¿™äº›å‘½ä»¤çš„ä½ç½®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯æ”»å‡»è€…å…·æœ‰å†™æƒé™çš„ç›®å½•ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ”¾ç½®æ¶æ„ç¨‹åºå¹¶ä»¥rootæƒé™æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´žæè¿°å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žå­˜åœ¨åˆ©ç”¨ä»·å€¼ï¼Œé€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æ‰§è¡Œæ¶æ„ç¨‹åºè¾¾åˆ°ææƒæ•ˆæžœã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„ä»£ç ä»…ä¸ºGNU GENERAL PUBLIC LICENSEï¼Œæ˜¯å¼€æºåè®®è®¸å¯ï¼Œä¸åŒ…å«ç›´æŽ¥çš„æ”»å‡»payloadæˆ–æ¶æ„ä»£ç ã€‚ä½†licenseæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ä»£ç ï¼Œå¦‚æžœç»“åˆç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œåè®®å†…å®¹ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åˆ›å»ºä¸€ä¸ªåˆæ³•çš„ç¨‹åºï¼Œä½†å…¶è¡Œä¸ºè¿åäº†åè®®æ¡æ¬¾ï¼Œä»Žè€Œé€ æˆæŸå®³ã€‚æ­¤ä»“åº“ä¸­å‘çŽ°ç›´æŽ¥æŠ•æ¯’ä»£ç çš„æ¦‚çŽ‡è¾ƒä½Žï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æ»¥ç”¨é£Žé™©ï¼Œä¼°è®¡æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„Netdata Agentç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 1.44.0-60, < 1.45.3ï¼‰ã€‚
2.  æŸ¥æ‰¾ndsudoå·¥å…·çš„ä½ç½®ã€‚
3.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å‘½ä»¤çš„ç›®å½•ï¼Œä¾‹å¦‚/tmp/evilã€‚
4.  å°†æ¶æ„ç¨‹åºï¼ˆå¦‚åå¼¹shellï¼‰æ”¾ç½®åˆ°/tmp/evilç›®å½•ä¸‹ï¼Œå¹¶å‘½åä¸ºndsudoå°è¯•æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œ`ping`ï¼Œ`date` ç­‰, å…·ä½“å–å†³äºŽ ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼‰ã€‚
5.  ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†/tmp/evilæ·»åŠ åˆ°PATHçš„æœ€å‰é¢ï¼š`export PATH=/tmp/evil:$PATH`ã€‚
6.  è¿è¡Œndsudoï¼Œå®ƒå°†æ‰§è¡Œ/tmp/evilç›®å½•ä¸‹çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**æ¥æº**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡PATHåŠ«æŒæ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata Agentå­˜åœ¨ndsudoï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠå¯æŽ§çš„PATHçŽ¯å¢ƒå˜é‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdataä¸­`ndsudo`å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´žã€‚`ndsudo`æ˜¯ä¸€ä¸ªå…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨`PATH`çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨`PATH`çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆäºŽç³»ç»Ÿç›®å½•çš„ä½ç½®ï¼Œè¯±ä½¿`ndsudo`æ‰§è¡Œè¯¥æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**
1.  æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„`ndsudo`å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶(ä¾‹å¦‚`nvme`)ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œæ”»å‡»è€…å¸Œæœ›æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚æä¾›çš„`payload.c`æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªroot shellã€‚
3.  ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†å½“å‰ç›®å½•(æˆ–åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•)æ·»åŠ åˆ°`PATH`çš„å¼€å¤´ã€‚
4.  è°ƒç”¨`ndsudo`ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ƒå…è®¸æ‰§è¡Œçš„å‘½ä»¤(ä¾‹å¦‚`nvme-list`)ã€‚ç”±äºŽ`PATH`å·²ç»è¢«ä¿®æ”¹ï¼Œ`ndsudo`ä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„`nvme`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»Žè€Œä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºŽæŸ¥æ‰¾`ndsudo`ï¼Œåˆ›å»ºä¸€ä¸ª`nvme` payloadï¼Œä¿®æ”¹`PATH`ï¼Œç„¶åŽæ‰§è¡Œ`ndsudo`ã€‚README.mdæ–‡ä»¶æè¿°äº†å¦‚ä½•ç¼–è¯‘`payload.c`å¹¶ä½¿ç”¨è„šæœ¬ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
æŸ¥çœ‹äº†æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ²¡æœ‰å‘çŽ°ä»»ä½•æŠ•æ¯’ä»£ç ã€‚å…¶ä¸­ï¼ŒCVE-2024-32019.shè„šæœ¬ç”¨äºŽåˆ©ç”¨æ¼æ´žï¼Œpayload.cç”¨äºŽç¼–è¯‘æ¶æ„payloadï¼ŒREADME.mdæ–‡ä»¶æè¿°äº†æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ï¼Œéƒ½æ˜¯æ­£å¸¸çš„åˆ©ç”¨ä»£ç ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**æ¥æº**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata ndsudoå·¥å…·ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªSUID rootçš„ç¨‹åºï¼Œä½†å®ƒä½¿ç”¨äº†PATHçŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡æŒ‡å‘ä¸€ä¸ªè‡ªå·±å¯æŽ§çš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹æ”¾ç½®æ¶æ„ç¨‹åºï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žæ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ£€æŸ¥ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨`/opt`ç›®å½•ä¸‹çš„`ndsudo`ç¨‹åºï¼Œå¹¶ä¸”ç¡®è®¤è¯¥ç¨‹åºæ˜¯å¦ä¸ºrootæ‰€æœ‰ä¸”è®¾ç½®äº†SUIDæƒé™ã€‚åŒæ—¶ï¼Œä½¿ç”¨`strings`å‘½ä»¤æ£€æŸ¥`ndsudo`ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨å¯¹`nvme`ã€`smartctl`ã€`hdparm`æˆ–`sensors`ç­‰å¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¯´æ˜Žè¯¥ç¨‹åºå¯èƒ½å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚
2.  **æ¶æ„ç¨‹åºç¼–è¯‘ï¼š** ç¼–è¯‘ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯è®¾ç½®UIDå’ŒGIDä¸º0ï¼Œç„¶åŽæ‰§è¡Œ`/bin/bash`ï¼Œä»Žè€ŒèŽ·å–root shellã€‚
3.  **æ¶æ„ç¨‹åºä¸Šä¼ ï¼š** é€šè¿‡SFTPå°†ç¼–è¯‘å¥½çš„æ¶æ„ç¨‹åºä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæ”»å‡»è€…å¯æŽ§çš„ç›®å½•ï¼Œä¾‹å¦‚`/tmp`ã€‚
4.  **çŽ¯å¢ƒå˜é‡ä¿®æ”¹ï¼š** ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æ”»å‡»è€…å¯æŽ§çš„ç›®å½•æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ï¼Œç¡®ä¿`ndsudo`ç¨‹åºåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶é¦–å…ˆåœ¨è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ã€‚
5.  **æ¼æ´žè§¦å‘ï¼š** æ‰§è¡Œ`ndsudo`ç¨‹åºï¼Œå½“å®ƒè°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…ä¸Šä¼ çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å–rootæƒé™ã€‚
6.  **äº¤äº’å¼Shellï¼š** æ¼æ´žåˆ©ç”¨ä»£ç æä¾›äº¤äº’å¼shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æ­¤POCä»£ç æœ¬èº«ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œå®žçŽ°æœ¬åœ°ææƒã€‚ä½†æ˜¯ï¼Œè¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ï¼š

*   **ç¼–è¯‘å’Œä¼ è¾“æ¶æ„ä»£ç ï¼š** è„šæœ¬ä¼šè‡ªåŠ¨ç¼–è¯‘Cä»£ç ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚è™½ç„¶Cä»£ç çš„å†…å®¹æ˜¯ææƒï¼Œä½†å¦‚æžœæ¶æ„æ”»å‡»è€…ä¿®æ”¹äº†Cä»£ç ï¼Œå°±å¯èƒ½åŒ…å«å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åŽé—¨ã€æ”¶é›†ä¿¡æ¯ç­‰ã€‚
*   **è¿œç¨‹æ‰§è¡Œä»£ç ï¼š**  è„šæœ¬é€šè¿‡sshæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£Žé™©ï¼Œå¯èƒ½æ‰§è¡Œé¢å¤–çš„æ¶æ„æ“ä½œã€‚
*   **æ®‹ç•™æ–‡ä»¶ï¼š** ç¼–è¯‘åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸Šä¼ çš„æ¶æ„ç¨‹åºå¯èƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç•™ä¸‹ç—•è¿¹ï¼Œå¦‚æžœè¿™äº›æ–‡ä»¶è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å®‰å…¨é—®é¢˜ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é£Žé™©ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œè¯¥POCä»£ç çš„é£Žé™©ä»ç„¶å¯æŽ§ï¼Œä¸»è¦é£Žé™©é›†ä¸­åœ¨ä»£ç çš„ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨ä¸Šã€‚ä¸ºäº†é™ä½Žé£Žé™©ï¼Œå»ºè®®ä»Žå¯ä¿¡çš„æ¥æºèŽ·å–POCä»£ç ï¼Œå¹¶ä»”ç»†æ£€æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿å…¶æ²¡æœ‰æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œåœ¨æµ‹è¯•å®ŒæˆåŽï¼Œåº”åŠæ—¶æ¸…ç†ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ®‹ç•™æ–‡ä»¶ã€‚

æŠ•æ¯’é£Žé™©é¢„ä¼°ä¸º10%ï¼Œå› ä¸ºä»£ç ç›¸å¯¹ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´žéªŒè¯å’Œåˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨è¢«ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**æ¥æº**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°shellè®¿é—®ï¼Œèƒ½å¤Ÿæ‰§è¡Œndsudoå‘½ä»¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2024-32019 æ˜¯ Netdata ä¸­ ndsudo å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudo æ˜¯ä¸€ä¸ª SUID root çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„è„šæœ¬æ”¾ç½®åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆçº§æ›´é«˜çš„ç›®å½•ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ nvmeï¼‰ï¼Œæ¥æ¬ºéª— ndsudo æ‰§è¡Œè¯¥æ¶æ„è„šæœ¬å¹¶èŽ·å¾— root æƒé™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æè¿°äº†ä¸€ç§åˆ©ç”¨æ­¤æ¼æ´žçš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1.  åˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼ˆpoc.pyï¼‰ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
2.  å°†æ­¤è„šæœ¬é‡å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ nvmeï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ ndsudo nvme-listï¼Œè¿™å°†å¯¼è‡´ ndsudo æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“æœ¬èº«æŠ•æ¯’é£Žé™©è¾ƒä½Žã€‚`poc.py` ä»£ç éžå¸¸ç®€å•ï¼Œä»…åŒ…å«ææƒæ‰§è¡Œbashçš„ä»£ç ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„ä»£ç ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¸…æ™°çš„æ¼æ´žåˆ©ç”¨è¯´æ˜Žã€‚ä½†ç”¨æˆ·ä»ç„¶éœ€è¦æ³¨æ„ï¼Œåœ¨å®žé™…çŽ¯å¢ƒä¸­ï¼Œä»Žä¸å¯ä¿¡çš„æ¥æºä¸‹è½½æˆ–å¤åˆ¶æ¼æ´žåˆ©ç”¨ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£Žé™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå†æ‰§è¡Œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žåŽŸç†ï¼š** `ndsudo` ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢å‘½ä»¤çš„è·¯å¾„ä¾èµ–äºŽç”¨æˆ·çš„ `PATH` çŽ¯å¢ƒå˜é‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   åˆ›å»ºæ¶æ„è„šæœ¬ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
    *   å°†æ­¤è„šæœ¬é‡å‘½åä¸º `ndsudo` å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆé€šè¿‡ `ndsudo --help` æŸ¥çœ‹ï¼‰ã€‚
    *   å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œç¡®ä¿æ¶æ„è„šæœ¬ä¼˜å…ˆè¢«æœç´¢åˆ°ã€‚
    *   è¿è¡Œ `ndsudo <allowed_command>`ï¼Œè¿™å°†å¯¼è‡´ `ndsudo` æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´žåˆ©ç”¨è¾ƒä¸ºç®€å•ï¼ŒPOC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä½†åº”æ³¨æ„æ¥æºä¸æ˜Žçš„exploitä»£ç çš„æ½œåœ¨æŠ•æ¯’é£Žé™©ã€‚è¯¥æ¼æ´žå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡æ“çºµ `PATH` çŽ¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨ SUID ç¨‹åº `ndsudo` æå‡è‡³ root æƒé™ã€‚åŠ¡å¿…åŠæ—¶å‡çº§ Netdata ç‰ˆæœ¬ä»¥ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**æ¥æº**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœ¬åœ°ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata agentè¿è¡Œåœ¨å—å½±å“ç‰ˆæœ¬ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰§è¡Œæœ¬åœ°ä»£ç ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·æ‹¥æœ‰ SUID æƒé™ï¼Œå…è®¸æ‰§è¡ŒæŸäº›ç‰¹æƒå‘½ä»¤ã€‚æ¼æ´žçš„æ ¹æºåœ¨äºŽ `ndsudo` ä½¿ç”¨ä¸å®‰å…¨çš„ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ PATH ä¸­æ’å…¥æ¶æ„ç¨‹åºï¼Œè®© `ndsudo` æ‰§è¡Œæ”»å‡»è€…æŽ§åˆ¶çš„ä»£ç ï¼Œä»Žè€Œæå‡æƒé™åˆ° rootã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾ `ndsudo` è·¯å¾„ï¼š** é€šå¸¸ä½äºŽ `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`ï¼Œä½†éœ€è¦é€šè¿‡ `find` å‘½ä»¤ç¡®è®¤ã€‚
2.  **åˆ›å»ºæ¶æ„ç¨‹åºï¼š** åˆ›å»ºä¸€ä¸ª C ç¨‹åºï¼Œè¯¥ç¨‹åºè°ƒç”¨ `setuid(0)` å’Œ `setgid(0)` è®¾ç½®ç”¨æˆ·å’Œç»„ ID ä¸º rootï¼Œç„¶åŽæ‰§è¡Œä¸€ä¸ª shell (ä¾‹å¦‚ `/bin/bash -p`)ã€‚éœ€è¦ä½¿ç”¨ `gcc` ç¼–è¯‘è¯¥ç¨‹åºï¼Œä¾‹å¦‚å‘½åä¸º `arcconf`ã€‚
3.  **ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼š** å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ¶æ„ç¨‹åºä½äºŽ `/tmp` ç›®å½•ä¸‹ï¼Œåˆ™æ‰§è¡Œ `PATH=/tmp:$PATH`ã€‚
4.  **æ‰§è¡Œ `ndsudo` å‘½ä»¤ï¼š** ä½¿ç”¨ `ndsudo` æ‰§è¡Œå®ƒæ”¯æŒçš„å‘½ä»¤ï¼Œä½†è¯¥å‘½ä»¤ä¾èµ–äºŽæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`ã€‚`ndsudo` ä¼šå°è¯•æ‰§è¡Œ `arcconf`ï¼Œä½†ç”±äºŽ PATH çŽ¯å¢ƒå˜é‡è¢«ä¿®æ”¹ï¼Œå®ƒä¼šæ‰§è¡Œæ”»å‡»è€…åœ¨ `/tmp` ç›®å½•ä¸‹åˆ›å»ºçš„æ¶æ„ç¨‹åºã€‚
5.  **èŽ·å¾— root shellï¼š** å¦‚æžœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…å°†èŽ·å¾—ä¸€ä¸ª root shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æä¾›çš„ POC ä»£ç ä¸­ï¼Œ`arcconf.c` çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªææƒçš„ shellï¼Œæ²¡æœ‰æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ ä½†ä»Ž github ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ `arcconf` æ—¶ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½åœ¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä»Ž github ä¸Šä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ½œåœ¨é£Žé™©ï¼Œæ•…æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**æ¥æº**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo æœ¬åœ°æƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·æå‡è‡³ root æƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 å’Œ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Netdataï¼Œä¸” ndsudo å·¥å…·è®¾ç½®äº† SUID root æƒé™ï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ ndsudoã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å®ƒä½¿ç”¨ `PATH` çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ `PATH` çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘æ¶æ„ç›®å½•çš„è·¯å¾„ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªä¸Ž `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤åŒåçš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œä»¥ root æƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§:**

æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´žã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåå¼¹ shellï¼‰çš„ç›®å½•ã€‚
2.  å°†æ¶æ„ç¨‹åºå‘½åä¸º `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œ`nvme-list`ï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ `ndsudo` å‘½ä»¤ã€‚`ndsudo` å°†æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€Œä½¿æ”»å‡»è€…èŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©:**

æ ¹æ®æä¾›çš„ä»£ç åˆ†æžï¼Œè¯¥ä»“åº“ä¼¼ä¹Žä¸»è¦æä¾›äº†ä¸€ä¸ª checker è„šæœ¬æ¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œç®¡ç†å‘˜è¯†åˆ«å’ŒéªŒè¯æ¼æ´žæ˜¯å¦å­˜åœ¨ï¼Œæ—¨åœ¨å¸®åŠ©é˜²å¾¡è€…è¯„ä¼°é£Žé™©å’ŒéªŒè¯è¡¥ä¸ï¼Œè€Œä¸æ˜¯æä¾›æ­¦å™¨åŒ–çš„ PoCã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žã€‚

æ£€æŸ¥å™¨ä»£ç ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (æˆ–å®‰è£…ä½ç½®) çš„ SUID/æ‰€æœ‰æƒã€‚
*   `PATH` ä¸­æ—©äºŽå¸¸è§ç³»ç»Ÿè·¯å¾„çš„å¯å†™ç›®å½•ã€‚
*   `ndsudo` å°è¯•æ‰§è¡Œçš„ç™½åå•å­å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚
*   å¯é€‰åœ°è¿è¡Œ `ndsudo --test <subcommand>` æ¥æ‰“å°å·²è§£æžçš„å‘½ä»¤è€Œä¸æ‰§è¡Œå®ƒ (è°¨æ…Žä½¿ç”¨ï¼Œå…ˆé˜…è¯»ä»£ç )ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º 0%**ã€‚


**é¡¹ç›®åœ°å€:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**æ¥æº**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´žèŽ·å–rootæƒé™ã€‚

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”æ”»å‡»è€…éœ€è¦å…·æœ‰æœ¬åœ°ä½Žæƒé™è´¦å·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ netdata çš„ ndsudo å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢è·¯å¾„ç”± PATH çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨ ndsudo æœç´¢è·¯å¾„ä¸­ï¼Œå½“ ndsudo è°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª C ç¨‹åºï¼Œç¼–è¯‘åŽå¯ä»¥ç›´æŽ¥æ‰§è¡Œä¸€ä¸ªå…·æœ‰ root æƒé™çš„ bash shellã€‚æ”»å‡»è€…éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«æ­¤æ¶æ„ç¨‹åºçš„å¯å†™ç›®å½•ï¼Œç„¶åŽä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ­¤ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚ä¹‹åŽï¼Œå½“ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

ä»£ç ä¸­æ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚å®ƒåªæ˜¯ç®€å•åœ°è®¾ç½® uid å’Œ gid ä¸º 0ï¼Œç„¶åŽæ‰§è¡Œ /bin/bashã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º0%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1.  åˆ©ç”¨éœ€è¦å…ˆèŽ·å¾—ä¸€ä¸ªnetdataè½¯ä»¶çš„ä½Žæƒé™è´¦å·ã€‚
2.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ POC ä¸­çš„ C ç¨‹åºç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„å¯å†™ç›®å½•ã€‚
3.  ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†è¯¥ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚
4.  è§¦å‘ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤ï¼Œè¿™å°†å¯¼è‡´æ¶æ„ç¨‹åºä»¥ root æƒé™æ‰§è¡Œï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

**é¡¹ç›®åœ°å€:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**æ¥æº**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯æå‡è‡³rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 åŠ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”å…·æœ‰æœ¬åœ°shellè®¿é—®æƒé™ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 å­˜åœ¨äºŽNetdataçš„`ndsudo`å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·æ˜¯å…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¼æ´žåŽŸå› æ˜¯`ndsudo`çš„æœç´¢è·¯å¾„ç”±`PATH`çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨å‰é¢ï¼Œå½“`ndsudo`æ‰§è¡Œä¿¡ä»»çš„å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œå®žçŽ°æœ¬åœ°ææƒã€‚æä¾›çš„POCä»£ç é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´žï¼š

1.  **ç¼–è¯‘æ¶æ„payload:**  `poc.c` ç¼–è¯‘æˆ `nvme`ï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯æ‰§è¡Œ `/bin/bash`ï¼Œå¹¶è®¾ç½® UID å’Œ GID ä¸º 0ï¼Œå³rootæƒé™ã€‚
2.  **ä¼ è¾“payloadåˆ°ç›®æ ‡ç³»ç»Ÿ:**  å°†ç¼–è¯‘å¥½çš„`nvme`ä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„`/tmp`ç›®å½•ã€‚
3.  **å‡†å¤‡payloadæ‰§è¡Œ:**  ç»™`/tmp/nvme`æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽå°†`/tmp`æ·»åŠ åˆ°`PATH`çŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ã€‚
4.  **è§¦å‘`ndsudo`æ‰§è¡Œpayload:** è¿è¡Œ`./ndsudo nvme-list`ï¼Œ`ndsudo`ä¼šæ‰§è¡Œ`/tmp/nvme`ï¼Œç”±äºŽè¯¥ç¨‹åºä¼šå°†æƒé™æå‡ä¸ºrootï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥èŽ·å¾—root shellã€‚

**æœ‰æ•ˆæ€§ï¼š** è¯¥POCä»£ç æè¿°çš„åˆ©ç”¨æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„`poc.c`ä»£ç åŠŸèƒ½æ¸…æ™°ï¼Œä»…ä¸ºæ‰§è¡Œ`/bin/bash`å¹¶æå‡æƒé™ï¼Œä¸å­˜åœ¨éšè—çš„æŠ•æ¯’ä»£ç ã€‚READMEæ–‡ä»¶æè¿°äº†å®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`PATH`çŽ¯å¢ƒå˜é‡ï¼Œæ¬ºéª—`ndsudo`æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**æ¥æº**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦netdata agentå­˜åœ¨æ¼æ´žç‰ˆæœ¬ä¸”ndsudoè¢«è°ƒç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata Agentä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªrootç”¨æˆ·æ‹¥æœ‰çš„ã€è®¾ç½®äº†SUIDä½çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒæœ¬åº”åªè¿è¡Œä¸€ç»„å—é™çš„å¤–éƒ¨å‘½ä»¤ï¼Œä½†æ˜¯å…¶æœç´¢è·¯å¾„ç”±PATHçŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æŒ‡å®šndsudoæŸ¥æ‰¾è¿™äº›å‘½ä»¤çš„ä½ç½®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯æ”»å‡»è€…å…·æœ‰å†™æƒé™çš„ç›®å½•ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ”¾ç½®æ¶æ„ç¨‹åºå¹¶ä»¥rootæƒé™æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´žæè¿°å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žå­˜åœ¨åˆ©ç”¨ä»·å€¼ï¼Œé€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æ‰§è¡Œæ¶æ„ç¨‹åºè¾¾åˆ°ææƒæ•ˆæžœã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„ä»£ç ä»…ä¸ºGNU GENERAL PUBLIC LICENSEï¼Œæ˜¯å¼€æºåè®®è®¸å¯ï¼Œä¸åŒ…å«ç›´æŽ¥çš„æ”»å‡»payloadæˆ–æ¶æ„ä»£ç ã€‚ä½†licenseæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ä»£ç ï¼Œå¦‚æžœç»“åˆç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œåè®®å†…å®¹ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åˆ›å»ºä¸€ä¸ªåˆæ³•çš„ç¨‹åºï¼Œä½†å…¶è¡Œä¸ºè¿åäº†åè®®æ¡æ¬¾ï¼Œä»Žè€Œé€ æˆæŸå®³ã€‚æ­¤ä»“åº“ä¸­å‘çŽ°ç›´æŽ¥æŠ•æ¯’ä»£ç çš„æ¦‚çŽ‡è¾ƒä½Žï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æ»¥ç”¨é£Žé™©ï¼Œä¼°è®¡æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„Netdata Agentç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 1.44.0-60, < 1.45.3ï¼‰ã€‚
2.  æŸ¥æ‰¾ndsudoå·¥å…·çš„ä½ç½®ã€‚
3.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å‘½ä»¤çš„ç›®å½•ï¼Œä¾‹å¦‚/tmp/evilã€‚
4.  å°†æ¶æ„ç¨‹åºï¼ˆå¦‚åå¼¹shellï¼‰æ”¾ç½®åˆ°/tmp/evilç›®å½•ä¸‹ï¼Œå¹¶å‘½åä¸ºndsudoå°è¯•æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œ`ping`ï¼Œ`date` ç­‰, å…·ä½“å–å†³äºŽ ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼‰ã€‚
5.  ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†/tmp/evilæ·»åŠ åˆ°PATHçš„æœ€å‰é¢ï¼š`export PATH=/tmp/evil:$PATH`ã€‚
6.  è¿è¡Œndsudoï¼Œå®ƒå°†æ‰§è¡Œ/tmp/evilç›®å½•ä¸‹çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**æ¥æº**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡PATHåŠ«æŒæ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata Agentå­˜åœ¨ndsudoï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠå¯æŽ§çš„PATHçŽ¯å¢ƒå˜é‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdataä¸­`ndsudo`å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´žã€‚`ndsudo`æ˜¯ä¸€ä¸ªå…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨`PATH`çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨`PATH`çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆäºŽç³»ç»Ÿç›®å½•çš„ä½ç½®ï¼Œè¯±ä½¿`ndsudo`æ‰§è¡Œè¯¥æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**
1.  æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„`ndsudo`å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶(ä¾‹å¦‚`nvme`)ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œæ”»å‡»è€…å¸Œæœ›æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚æä¾›çš„`payload.c`æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªroot shellã€‚
3.  ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†å½“å‰ç›®å½•(æˆ–åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•)æ·»åŠ åˆ°`PATH`çš„å¼€å¤´ã€‚
4.  è°ƒç”¨`ndsudo`ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ƒå…è®¸æ‰§è¡Œçš„å‘½ä»¤(ä¾‹å¦‚`nvme-list`)ã€‚ç”±äºŽ`PATH`å·²ç»è¢«ä¿®æ”¹ï¼Œ`ndsudo`ä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„`nvme`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»Žè€Œä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºŽæŸ¥æ‰¾`ndsudo`ï¼Œåˆ›å»ºä¸€ä¸ª`nvme` payloadï¼Œä¿®æ”¹`PATH`ï¼Œç„¶åŽæ‰§è¡Œ`ndsudo`ã€‚README.mdæ–‡ä»¶æè¿°äº†å¦‚ä½•ç¼–è¯‘`payload.c`å¹¶ä½¿ç”¨è„šæœ¬ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
æŸ¥çœ‹äº†æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ²¡æœ‰å‘çŽ°ä»»ä½•æŠ•æ¯’ä»£ç ã€‚å…¶ä¸­ï¼ŒCVE-2024-32019.shè„šæœ¬ç”¨äºŽåˆ©ç”¨æ¼æ´žï¼Œpayload.cç”¨äºŽç¼–è¯‘æ¶æ„payloadï¼ŒREADME.mdæ–‡ä»¶æè¿°äº†æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ï¼Œéƒ½æ˜¯æ­£å¸¸çš„åˆ©ç”¨ä»£ç ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**æ¥æº**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata ndsudoå·¥å…·ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªSUID rootçš„ç¨‹åºï¼Œä½†å®ƒä½¿ç”¨äº†PATHçŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡æŒ‡å‘ä¸€ä¸ªè‡ªå·±å¯æŽ§çš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹æ”¾ç½®æ¶æ„ç¨‹åºï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žæ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ£€æŸ¥ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨`/opt`ç›®å½•ä¸‹çš„`ndsudo`ç¨‹åºï¼Œå¹¶ä¸”ç¡®è®¤è¯¥ç¨‹åºæ˜¯å¦ä¸ºrootæ‰€æœ‰ä¸”è®¾ç½®äº†SUIDæƒé™ã€‚åŒæ—¶ï¼Œä½¿ç”¨`strings`å‘½ä»¤æ£€æŸ¥`ndsudo`ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨å¯¹`nvme`ã€`smartctl`ã€`hdparm`æˆ–`sensors`ç­‰å¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¯´æ˜Žè¯¥ç¨‹åºå¯èƒ½å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚
2.  **æ¶æ„ç¨‹åºç¼–è¯‘ï¼š** ç¼–è¯‘ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯è®¾ç½®UIDå’ŒGIDä¸º0ï¼Œç„¶åŽæ‰§è¡Œ`/bin/bash`ï¼Œä»Žè€ŒèŽ·å–root shellã€‚
3.  **æ¶æ„ç¨‹åºä¸Šä¼ ï¼š** é€šè¿‡SFTPå°†ç¼–è¯‘å¥½çš„æ¶æ„ç¨‹åºä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæ”»å‡»è€…å¯æŽ§çš„ç›®å½•ï¼Œä¾‹å¦‚`/tmp`ã€‚
4.  **çŽ¯å¢ƒå˜é‡ä¿®æ”¹ï¼š** ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æ”»å‡»è€…å¯æŽ§çš„ç›®å½•æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ï¼Œç¡®ä¿`ndsudo`ç¨‹åºåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶é¦–å…ˆåœ¨è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ã€‚
5.  **æ¼æ´žè§¦å‘ï¼š** æ‰§è¡Œ`ndsudo`ç¨‹åºï¼Œå½“å®ƒè°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…ä¸Šä¼ çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å–rootæƒé™ã€‚
6.  **äº¤äº’å¼Shellï¼š** æ¼æ´žåˆ©ç”¨ä»£ç æä¾›äº¤äº’å¼shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æ­¤POCä»£ç æœ¬èº«ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œå®žçŽ°æœ¬åœ°ææƒã€‚ä½†æ˜¯ï¼Œè¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ï¼š

*   **ç¼–è¯‘å’Œä¼ è¾“æ¶æ„ä»£ç ï¼š** è„šæœ¬ä¼šè‡ªåŠ¨ç¼–è¯‘Cä»£ç ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚è™½ç„¶Cä»£ç çš„å†…å®¹æ˜¯ææƒï¼Œä½†å¦‚æžœæ¶æ„æ”»å‡»è€…ä¿®æ”¹äº†Cä»£ç ï¼Œå°±å¯èƒ½åŒ…å«å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åŽé—¨ã€æ”¶é›†ä¿¡æ¯ç­‰ã€‚
*   **è¿œç¨‹æ‰§è¡Œä»£ç ï¼š**  è„šæœ¬é€šè¿‡sshæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£Žé™©ï¼Œå¯èƒ½æ‰§è¡Œé¢å¤–çš„æ¶æ„æ“ä½œã€‚
*   **æ®‹ç•™æ–‡ä»¶ï¼š** ç¼–è¯‘åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸Šä¼ çš„æ¶æ„ç¨‹åºå¯èƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç•™ä¸‹ç—•è¿¹ï¼Œå¦‚æžœè¿™äº›æ–‡ä»¶è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å®‰å…¨é—®é¢˜ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é£Žé™©ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œè¯¥POCä»£ç çš„é£Žé™©ä»ç„¶å¯æŽ§ï¼Œä¸»è¦é£Žé™©é›†ä¸­åœ¨ä»£ç çš„ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨ä¸Šã€‚ä¸ºäº†é™ä½Žé£Žé™©ï¼Œå»ºè®®ä»Žå¯ä¿¡çš„æ¥æºèŽ·å–POCä»£ç ï¼Œå¹¶ä»”ç»†æ£€æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿å…¶æ²¡æœ‰æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œåœ¨æµ‹è¯•å®ŒæˆåŽï¼Œåº”åŠæ—¶æ¸…ç†ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ®‹ç•™æ–‡ä»¶ã€‚

æŠ•æ¯’é£Žé™©é¢„ä¼°ä¸º10%ï¼Œå› ä¸ºä»£ç ç›¸å¯¹ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´žéªŒè¯å’Œåˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨è¢«ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**æ¥æº**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°shellè®¿é—®ï¼Œèƒ½å¤Ÿæ‰§è¡Œndsudoå‘½ä»¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2024-32019 æ˜¯ Netdata ä¸­ ndsudo å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudo æ˜¯ä¸€ä¸ª SUID root çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„è„šæœ¬æ”¾ç½®åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆçº§æ›´é«˜çš„ç›®å½•ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ nvmeï¼‰ï¼Œæ¥æ¬ºéª— ndsudo æ‰§è¡Œè¯¥æ¶æ„è„šæœ¬å¹¶èŽ·å¾— root æƒé™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æè¿°äº†ä¸€ç§åˆ©ç”¨æ­¤æ¼æ´žçš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1.  åˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼ˆpoc.pyï¼‰ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
2.  å°†æ­¤è„šæœ¬é‡å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ nvmeï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ ndsudo nvme-listï¼Œè¿™å°†å¯¼è‡´ ndsudo æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“æœ¬èº«æŠ•æ¯’é£Žé™©è¾ƒä½Žã€‚`poc.py` ä»£ç éžå¸¸ç®€å•ï¼Œä»…åŒ…å«ææƒæ‰§è¡Œbashçš„ä»£ç ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„ä»£ç ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¸…æ™°çš„æ¼æ´žåˆ©ç”¨è¯´æ˜Žã€‚ä½†ç”¨æˆ·ä»ç„¶éœ€è¦æ³¨æ„ï¼Œåœ¨å®žé™…çŽ¯å¢ƒä¸­ï¼Œä»Žä¸å¯ä¿¡çš„æ¥æºä¸‹è½½æˆ–å¤åˆ¶æ¼æ´žåˆ©ç”¨ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£Žé™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå†æ‰§è¡Œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žåŽŸç†ï¼š** `ndsudo` ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢å‘½ä»¤çš„è·¯å¾„ä¾èµ–äºŽç”¨æˆ·çš„ `PATH` çŽ¯å¢ƒå˜é‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   åˆ›å»ºæ¶æ„è„šæœ¬ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
    *   å°†æ­¤è„šæœ¬é‡å‘½åä¸º `ndsudo` å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆé€šè¿‡ `ndsudo --help` æŸ¥çœ‹ï¼‰ã€‚
    *   å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œç¡®ä¿æ¶æ„è„šæœ¬ä¼˜å…ˆè¢«æœç´¢åˆ°ã€‚
    *   è¿è¡Œ `ndsudo <allowed_command>`ï¼Œè¿™å°†å¯¼è‡´ `ndsudo` æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´žåˆ©ç”¨è¾ƒä¸ºç®€å•ï¼ŒPOC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä½†åº”æ³¨æ„æ¥æºä¸æ˜Žçš„exploitä»£ç çš„æ½œåœ¨æŠ•æ¯’é£Žé™©ã€‚è¯¥æ¼æ´žå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡æ“çºµ `PATH` çŽ¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨ SUID ç¨‹åº `ndsudo` æå‡è‡³ root æƒé™ã€‚åŠ¡å¿…åŠæ—¶å‡çº§ Netdata ç‰ˆæœ¬ä»¥ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**æ¥æº**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœ¬åœ°ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata agentè¿è¡Œåœ¨å—å½±å“ç‰ˆæœ¬ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰§è¡Œæœ¬åœ°ä»£ç ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·æ‹¥æœ‰ SUID æƒé™ï¼Œå…è®¸æ‰§è¡ŒæŸäº›ç‰¹æƒå‘½ä»¤ã€‚æ¼æ´žçš„æ ¹æºåœ¨äºŽ `ndsudo` ä½¿ç”¨ä¸å®‰å…¨çš„ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ PATH ä¸­æ’å…¥æ¶æ„ç¨‹åºï¼Œè®© `ndsudo` æ‰§è¡Œæ”»å‡»è€…æŽ§åˆ¶çš„ä»£ç ï¼Œä»Žè€Œæå‡æƒé™åˆ° rootã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾ `ndsudo` è·¯å¾„ï¼š** é€šå¸¸ä½äºŽ `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`ï¼Œä½†éœ€è¦é€šè¿‡ `find` å‘½ä»¤ç¡®è®¤ã€‚
2.  **åˆ›å»ºæ¶æ„ç¨‹åºï¼š** åˆ›å»ºä¸€ä¸ª C ç¨‹åºï¼Œè¯¥ç¨‹åºè°ƒç”¨ `setuid(0)` å’Œ `setgid(0)` è®¾ç½®ç”¨æˆ·å’Œç»„ ID ä¸º rootï¼Œç„¶åŽæ‰§è¡Œä¸€ä¸ª shell (ä¾‹å¦‚ `/bin/bash -p`)ã€‚éœ€è¦ä½¿ç”¨ `gcc` ç¼–è¯‘è¯¥ç¨‹åºï¼Œä¾‹å¦‚å‘½åä¸º `arcconf`ã€‚
3.  **ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼š** å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ¶æ„ç¨‹åºä½äºŽ `/tmp` ç›®å½•ä¸‹ï¼Œåˆ™æ‰§è¡Œ `PATH=/tmp:$PATH`ã€‚
4.  **æ‰§è¡Œ `ndsudo` å‘½ä»¤ï¼š** ä½¿ç”¨ `ndsudo` æ‰§è¡Œå®ƒæ”¯æŒçš„å‘½ä»¤ï¼Œä½†è¯¥å‘½ä»¤ä¾èµ–äºŽæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`ã€‚`ndsudo` ä¼šå°è¯•æ‰§è¡Œ `arcconf`ï¼Œä½†ç”±äºŽ PATH çŽ¯å¢ƒå˜é‡è¢«ä¿®æ”¹ï¼Œå®ƒä¼šæ‰§è¡Œæ”»å‡»è€…åœ¨ `/tmp` ç›®å½•ä¸‹åˆ›å»ºçš„æ¶æ„ç¨‹åºã€‚
5.  **èŽ·å¾— root shellï¼š** å¦‚æžœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…å°†èŽ·å¾—ä¸€ä¸ª root shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æä¾›çš„ POC ä»£ç ä¸­ï¼Œ`arcconf.c` çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªææƒçš„ shellï¼Œæ²¡æœ‰æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ ä½†ä»Ž github ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ `arcconf` æ—¶ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½åœ¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä»Ž github ä¸Šä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ½œåœ¨é£Žé™©ï¼Œæ•…æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**æ¥æº**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo æœ¬åœ°æƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·æå‡è‡³ root æƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 å’Œ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Netdataï¼Œä¸” ndsudo å·¥å…·è®¾ç½®äº† SUID root æƒé™ï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ ndsudoã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å®ƒä½¿ç”¨ `PATH` çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ `PATH` çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘æ¶æ„ç›®å½•çš„è·¯å¾„ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªä¸Ž `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤åŒåçš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œä»¥ root æƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§:**

æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´žã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåå¼¹ shellï¼‰çš„ç›®å½•ã€‚
2.  å°†æ¶æ„ç¨‹åºå‘½åä¸º `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œ`nvme-list`ï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ `ndsudo` å‘½ä»¤ã€‚`ndsudo` å°†æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€Œä½¿æ”»å‡»è€…èŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©:**

æ ¹æ®æä¾›çš„ä»£ç åˆ†æžï¼Œè¯¥ä»“åº“ä¼¼ä¹Žä¸»è¦æä¾›äº†ä¸€ä¸ª checker è„šæœ¬æ¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œç®¡ç†å‘˜è¯†åˆ«å’ŒéªŒè¯æ¼æ´žæ˜¯å¦å­˜åœ¨ï¼Œæ—¨åœ¨å¸®åŠ©é˜²å¾¡è€…è¯„ä¼°é£Žé™©å’ŒéªŒè¯è¡¥ä¸ï¼Œè€Œä¸æ˜¯æä¾›æ­¦å™¨åŒ–çš„ PoCã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žã€‚

æ£€æŸ¥å™¨ä»£ç ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (æˆ–å®‰è£…ä½ç½®) çš„ SUID/æ‰€æœ‰æƒã€‚
*   `PATH` ä¸­æ—©äºŽå¸¸è§ç³»ç»Ÿè·¯å¾„çš„å¯å†™ç›®å½•ã€‚
*   `ndsudo` å°è¯•æ‰§è¡Œçš„ç™½åå•å­å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚
*   å¯é€‰åœ°è¿è¡Œ `ndsudo --test <subcommand>` æ¥æ‰“å°å·²è§£æžçš„å‘½ä»¤è€Œä¸æ‰§è¡Œå®ƒ (è°¨æ…Žä½¿ç”¨ï¼Œå…ˆé˜…è¯»ä»£ç )ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º 0%**ã€‚


**é¡¹ç›®åœ°å€:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**æ¥æº**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´žèŽ·å–rootæƒé™ã€‚

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”æ”»å‡»è€…éœ€è¦å…·æœ‰æœ¬åœ°ä½Žæƒé™è´¦å·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ netdata çš„ ndsudo å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢è·¯å¾„ç”± PATH çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨ ndsudo æœç´¢è·¯å¾„ä¸­ï¼Œå½“ ndsudo è°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª C ç¨‹åºï¼Œç¼–è¯‘åŽå¯ä»¥ç›´æŽ¥æ‰§è¡Œä¸€ä¸ªå…·æœ‰ root æƒé™çš„ bash shellã€‚æ”»å‡»è€…éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«æ­¤æ¶æ„ç¨‹åºçš„å¯å†™ç›®å½•ï¼Œç„¶åŽä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ­¤ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚ä¹‹åŽï¼Œå½“ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

ä»£ç ä¸­æ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚å®ƒåªæ˜¯ç®€å•åœ°è®¾ç½® uid å’Œ gid ä¸º 0ï¼Œç„¶åŽæ‰§è¡Œ /bin/bashã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º0%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1.  åˆ©ç”¨éœ€è¦å…ˆèŽ·å¾—ä¸€ä¸ªnetdataè½¯ä»¶çš„ä½Žæƒé™è´¦å·ã€‚
2.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ POC ä¸­çš„ C ç¨‹åºç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„å¯å†™ç›®å½•ã€‚
3.  ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†è¯¥ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚
4.  è§¦å‘ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤ï¼Œè¿™å°†å¯¼è‡´æ¶æ„ç¨‹åºä»¥ root æƒé™æ‰§è¡Œï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

**é¡¹ç›®åœ°å€:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**æ¥æº**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯æå‡è‡³rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 åŠ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”å…·æœ‰æœ¬åœ°shellè®¿é—®æƒé™ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 å­˜åœ¨äºŽNetdataçš„`ndsudo`å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·æ˜¯å…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¼æ´žåŽŸå› æ˜¯`ndsudo`çš„æœç´¢è·¯å¾„ç”±`PATH`çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨å‰é¢ï¼Œå½“`ndsudo`æ‰§è¡Œä¿¡ä»»çš„å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œå®žçŽ°æœ¬åœ°ææƒã€‚æä¾›çš„POCä»£ç é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´žï¼š

1.  **ç¼–è¯‘æ¶æ„payload:**  `poc.c` ç¼–è¯‘æˆ `nvme`ï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯æ‰§è¡Œ `/bin/bash`ï¼Œå¹¶è®¾ç½® UID å’Œ GID ä¸º 0ï¼Œå³rootæƒé™ã€‚
2.  **ä¼ è¾“payloadåˆ°ç›®æ ‡ç³»ç»Ÿ:**  å°†ç¼–è¯‘å¥½çš„`nvme`ä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„`/tmp`ç›®å½•ã€‚
3.  **å‡†å¤‡payloadæ‰§è¡Œ:**  ç»™`/tmp/nvme`æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽå°†`/tmp`æ·»åŠ åˆ°`PATH`çŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ã€‚
4.  **è§¦å‘`ndsudo`æ‰§è¡Œpayload:** è¿è¡Œ`./ndsudo nvme-list`ï¼Œ`ndsudo`ä¼šæ‰§è¡Œ`/tmp/nvme`ï¼Œç”±äºŽè¯¥ç¨‹åºä¼šå°†æƒé™æå‡ä¸ºrootï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥èŽ·å¾—root shellã€‚

**æœ‰æ•ˆæ€§ï¼š** è¯¥POCä»£ç æè¿°çš„åˆ©ç”¨æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„`poc.c`ä»£ç åŠŸèƒ½æ¸…æ™°ï¼Œä»…ä¸ºæ‰§è¡Œ`/bin/bash`å¹¶æå‡æƒé™ï¼Œä¸å­˜åœ¨éšè—çš„æŠ•æ¯’ä»£ç ã€‚READMEæ–‡ä»¶æè¿°äº†å®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`PATH`çŽ¯å¢ƒå˜é‡ï¼Œæ¬ºéª—`ndsudo`æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**æ¥æº**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦netdata agentå­˜åœ¨æ¼æ´žç‰ˆæœ¬ä¸”ndsudoè¢«è°ƒç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata Agentä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªrootç”¨æˆ·æ‹¥æœ‰çš„ã€è®¾ç½®äº†SUIDä½çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒæœ¬åº”åªè¿è¡Œä¸€ç»„å—é™çš„å¤–éƒ¨å‘½ä»¤ï¼Œä½†æ˜¯å…¶æœç´¢è·¯å¾„ç”±PATHçŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æŒ‡å®šndsudoæŸ¥æ‰¾è¿™äº›å‘½ä»¤çš„ä½ç½®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯æ”»å‡»è€…å…·æœ‰å†™æƒé™çš„ç›®å½•ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ”¾ç½®æ¶æ„ç¨‹åºå¹¶ä»¥rootæƒé™æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´žæè¿°å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žå­˜åœ¨åˆ©ç”¨ä»·å€¼ï¼Œé€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æ‰§è¡Œæ¶æ„ç¨‹åºè¾¾åˆ°ææƒæ•ˆæžœã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„ä»£ç ä»…ä¸ºGNU GENERAL PUBLIC LICENSEï¼Œæ˜¯å¼€æºåè®®è®¸å¯ï¼Œä¸åŒ…å«ç›´æŽ¥çš„æ”»å‡»payloadæˆ–æ¶æ„ä»£ç ã€‚ä½†licenseæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ä»£ç ï¼Œå¦‚æžœç»“åˆç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œåè®®å†…å®¹ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åˆ›å»ºä¸€ä¸ªåˆæ³•çš„ç¨‹åºï¼Œä½†å…¶è¡Œä¸ºè¿åäº†åè®®æ¡æ¬¾ï¼Œä»Žè€Œé€ æˆæŸå®³ã€‚æ­¤ä»“åº“ä¸­å‘çŽ°ç›´æŽ¥æŠ•æ¯’ä»£ç çš„æ¦‚çŽ‡è¾ƒä½Žï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æ»¥ç”¨é£Žé™©ï¼Œä¼°è®¡æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„Netdata Agentç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 1.44.0-60, < 1.45.3ï¼‰ã€‚
2.  æŸ¥æ‰¾ndsudoå·¥å…·çš„ä½ç½®ã€‚
3.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å‘½ä»¤çš„ç›®å½•ï¼Œä¾‹å¦‚/tmp/evilã€‚
4.  å°†æ¶æ„ç¨‹åºï¼ˆå¦‚åå¼¹shellï¼‰æ”¾ç½®åˆ°/tmp/evilç›®å½•ä¸‹ï¼Œå¹¶å‘½åä¸ºndsudoå°è¯•æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œ`ping`ï¼Œ`date` ç­‰, å…·ä½“å–å†³äºŽ ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼‰ã€‚
5.  ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†/tmp/evilæ·»åŠ åˆ°PATHçš„æœ€å‰é¢ï¼š`export PATH=/tmp/evil:$PATH`ã€‚
6.  è¿è¡Œndsudoï¼Œå®ƒå°†æ‰§è¡Œ/tmp/evilç›®å½•ä¸‹çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**æ¥æº**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡PATHåŠ«æŒæ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata Agentå­˜åœ¨ndsudoï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠå¯æŽ§çš„PATHçŽ¯å¢ƒå˜é‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdataä¸­`ndsudo`å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´žã€‚`ndsudo`æ˜¯ä¸€ä¸ªå…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨`PATH`çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨`PATH`çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆäºŽç³»ç»Ÿç›®å½•çš„ä½ç½®ï¼Œè¯±ä½¿`ndsudo`æ‰§è¡Œè¯¥æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**
1.  æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„`ndsudo`å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶(ä¾‹å¦‚`nvme`)ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œæ”»å‡»è€…å¸Œæœ›æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚æä¾›çš„`payload.c`æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªroot shellã€‚
3.  ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†å½“å‰ç›®å½•(æˆ–åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•)æ·»åŠ åˆ°`PATH`çš„å¼€å¤´ã€‚
4.  è°ƒç”¨`ndsudo`ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ƒå…è®¸æ‰§è¡Œçš„å‘½ä»¤(ä¾‹å¦‚`nvme-list`)ã€‚ç”±äºŽ`PATH`å·²ç»è¢«ä¿®æ”¹ï¼Œ`ndsudo`ä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„`nvme`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»Žè€Œä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºŽæŸ¥æ‰¾`ndsudo`ï¼Œåˆ›å»ºä¸€ä¸ª`nvme` payloadï¼Œä¿®æ”¹`PATH`ï¼Œç„¶åŽæ‰§è¡Œ`ndsudo`ã€‚README.mdæ–‡ä»¶æè¿°äº†å¦‚ä½•ç¼–è¯‘`payload.c`å¹¶ä½¿ç”¨è„šæœ¬ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
æŸ¥çœ‹äº†æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ²¡æœ‰å‘çŽ°ä»»ä½•æŠ•æ¯’ä»£ç ã€‚å…¶ä¸­ï¼ŒCVE-2024-32019.shè„šæœ¬ç”¨äºŽåˆ©ç”¨æ¼æ´žï¼Œpayload.cç”¨äºŽç¼–è¯‘æ¶æ„payloadï¼ŒREADME.mdæ–‡ä»¶æè¿°äº†æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ï¼Œéƒ½æ˜¯æ­£å¸¸çš„åˆ©ç”¨ä»£ç ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**æ¥æº**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata ndsudoå·¥å…·ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªSUID rootçš„ç¨‹åºï¼Œä½†å®ƒä½¿ç”¨äº†PATHçŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡æŒ‡å‘ä¸€ä¸ªè‡ªå·±å¯æŽ§çš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹æ”¾ç½®æ¶æ„ç¨‹åºï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žæ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ£€æŸ¥ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨`/opt`ç›®å½•ä¸‹çš„`ndsudo`ç¨‹åºï¼Œå¹¶ä¸”ç¡®è®¤è¯¥ç¨‹åºæ˜¯å¦ä¸ºrootæ‰€æœ‰ä¸”è®¾ç½®äº†SUIDæƒé™ã€‚åŒæ—¶ï¼Œä½¿ç”¨`strings`å‘½ä»¤æ£€æŸ¥`ndsudo`ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨å¯¹`nvme`ã€`smartctl`ã€`hdparm`æˆ–`sensors`ç­‰å¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¯´æ˜Žè¯¥ç¨‹åºå¯èƒ½å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚
2.  **æ¶æ„ç¨‹åºç¼–è¯‘ï¼š** ç¼–è¯‘ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯è®¾ç½®UIDå’ŒGIDä¸º0ï¼Œç„¶åŽæ‰§è¡Œ`/bin/bash`ï¼Œä»Žè€ŒèŽ·å–root shellã€‚
3.  **æ¶æ„ç¨‹åºä¸Šä¼ ï¼š** é€šè¿‡SFTPå°†ç¼–è¯‘å¥½çš„æ¶æ„ç¨‹åºä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæ”»å‡»è€…å¯æŽ§çš„ç›®å½•ï¼Œä¾‹å¦‚`/tmp`ã€‚
4.  **çŽ¯å¢ƒå˜é‡ä¿®æ”¹ï¼š** ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æ”»å‡»è€…å¯æŽ§çš„ç›®å½•æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ï¼Œç¡®ä¿`ndsudo`ç¨‹åºåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶é¦–å…ˆåœ¨è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ã€‚
5.  **æ¼æ´žè§¦å‘ï¼š** æ‰§è¡Œ`ndsudo`ç¨‹åºï¼Œå½“å®ƒè°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…ä¸Šä¼ çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å–rootæƒé™ã€‚
6.  **äº¤äº’å¼Shellï¼š** æ¼æ´žåˆ©ç”¨ä»£ç æä¾›äº¤äº’å¼shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æ­¤POCä»£ç æœ¬èº«ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œå®žçŽ°æœ¬åœ°ææƒã€‚ä½†æ˜¯ï¼Œè¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ï¼š

*   **ç¼–è¯‘å’Œä¼ è¾“æ¶æ„ä»£ç ï¼š** è„šæœ¬ä¼šè‡ªåŠ¨ç¼–è¯‘Cä»£ç ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚è™½ç„¶Cä»£ç çš„å†…å®¹æ˜¯ææƒï¼Œä½†å¦‚æžœæ¶æ„æ”»å‡»è€…ä¿®æ”¹äº†Cä»£ç ï¼Œå°±å¯èƒ½åŒ…å«å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åŽé—¨ã€æ”¶é›†ä¿¡æ¯ç­‰ã€‚
*   **è¿œç¨‹æ‰§è¡Œä»£ç ï¼š**  è„šæœ¬é€šè¿‡sshæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£Žé™©ï¼Œå¯èƒ½æ‰§è¡Œé¢å¤–çš„æ¶æ„æ“ä½œã€‚
*   **æ®‹ç•™æ–‡ä»¶ï¼š** ç¼–è¯‘åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸Šä¼ çš„æ¶æ„ç¨‹åºå¯èƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç•™ä¸‹ç—•è¿¹ï¼Œå¦‚æžœè¿™äº›æ–‡ä»¶è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å®‰å…¨é—®é¢˜ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é£Žé™©ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œè¯¥POCä»£ç çš„é£Žé™©ä»ç„¶å¯æŽ§ï¼Œä¸»è¦é£Žé™©é›†ä¸­åœ¨ä»£ç çš„ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨ä¸Šã€‚ä¸ºäº†é™ä½Žé£Žé™©ï¼Œå»ºè®®ä»Žå¯ä¿¡çš„æ¥æºèŽ·å–POCä»£ç ï¼Œå¹¶ä»”ç»†æ£€æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿å…¶æ²¡æœ‰æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œåœ¨æµ‹è¯•å®ŒæˆåŽï¼Œåº”åŠæ—¶æ¸…ç†ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ®‹ç•™æ–‡ä»¶ã€‚

æŠ•æ¯’é£Žé™©é¢„ä¼°ä¸º10%ï¼Œå› ä¸ºä»£ç ç›¸å¯¹ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´žéªŒè¯å’Œåˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨è¢«ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**æ¥æº**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°shellè®¿é—®ï¼Œèƒ½å¤Ÿæ‰§è¡Œndsudoå‘½ä»¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2024-32019 æ˜¯ Netdata ä¸­ ndsudo å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudo æ˜¯ä¸€ä¸ª SUID root çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„è„šæœ¬æ”¾ç½®åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆçº§æ›´é«˜çš„ç›®å½•ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ nvmeï¼‰ï¼Œæ¥æ¬ºéª— ndsudo æ‰§è¡Œè¯¥æ¶æ„è„šæœ¬å¹¶èŽ·å¾— root æƒé™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æè¿°äº†ä¸€ç§åˆ©ç”¨æ­¤æ¼æ´žçš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1.  åˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼ˆpoc.pyï¼‰ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
2.  å°†æ­¤è„šæœ¬é‡å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ nvmeï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ ndsudo nvme-listï¼Œè¿™å°†å¯¼è‡´ ndsudo æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“æœ¬èº«æŠ•æ¯’é£Žé™©è¾ƒä½Žã€‚`poc.py` ä»£ç éžå¸¸ç®€å•ï¼Œä»…åŒ…å«ææƒæ‰§è¡Œbashçš„ä»£ç ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„ä»£ç ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¸…æ™°çš„æ¼æ´žåˆ©ç”¨è¯´æ˜Žã€‚ä½†ç”¨æˆ·ä»ç„¶éœ€è¦æ³¨æ„ï¼Œåœ¨å®žé™…çŽ¯å¢ƒä¸­ï¼Œä»Žä¸å¯ä¿¡çš„æ¥æºä¸‹è½½æˆ–å¤åˆ¶æ¼æ´žåˆ©ç”¨ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£Žé™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå†æ‰§è¡Œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žåŽŸç†ï¼š** `ndsudo` ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢å‘½ä»¤çš„è·¯å¾„ä¾èµ–äºŽç”¨æˆ·çš„ `PATH` çŽ¯å¢ƒå˜é‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   åˆ›å»ºæ¶æ„è„šæœ¬ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
    *   å°†æ­¤è„šæœ¬é‡å‘½åä¸º `ndsudo` å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆé€šè¿‡ `ndsudo --help` æŸ¥çœ‹ï¼‰ã€‚
    *   å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œç¡®ä¿æ¶æ„è„šæœ¬ä¼˜å…ˆè¢«æœç´¢åˆ°ã€‚
    *   è¿è¡Œ `ndsudo <allowed_command>`ï¼Œè¿™å°†å¯¼è‡´ `ndsudo` æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´žåˆ©ç”¨è¾ƒä¸ºç®€å•ï¼ŒPOC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä½†åº”æ³¨æ„æ¥æºä¸æ˜Žçš„exploitä»£ç çš„æ½œåœ¨æŠ•æ¯’é£Žé™©ã€‚è¯¥æ¼æ´žå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡æ“çºµ `PATH` çŽ¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨ SUID ç¨‹åº `ndsudo` æå‡è‡³ root æƒé™ã€‚åŠ¡å¿…åŠæ—¶å‡çº§ Netdata ç‰ˆæœ¬ä»¥ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**æ¥æº**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœ¬åœ°ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata agentè¿è¡Œåœ¨å—å½±å“ç‰ˆæœ¬ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰§è¡Œæœ¬åœ°ä»£ç ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·æ‹¥æœ‰ SUID æƒé™ï¼Œå…è®¸æ‰§è¡ŒæŸäº›ç‰¹æƒå‘½ä»¤ã€‚æ¼æ´žçš„æ ¹æºåœ¨äºŽ `ndsudo` ä½¿ç”¨ä¸å®‰å…¨çš„ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ PATH ä¸­æ’å…¥æ¶æ„ç¨‹åºï¼Œè®© `ndsudo` æ‰§è¡Œæ”»å‡»è€…æŽ§åˆ¶çš„ä»£ç ï¼Œä»Žè€Œæå‡æƒé™åˆ° rootã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾ `ndsudo` è·¯å¾„ï¼š** é€šå¸¸ä½äºŽ `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`ï¼Œä½†éœ€è¦é€šè¿‡ `find` å‘½ä»¤ç¡®è®¤ã€‚
2.  **åˆ›å»ºæ¶æ„ç¨‹åºï¼š** åˆ›å»ºä¸€ä¸ª C ç¨‹åºï¼Œè¯¥ç¨‹åºè°ƒç”¨ `setuid(0)` å’Œ `setgid(0)` è®¾ç½®ç”¨æˆ·å’Œç»„ ID ä¸º rootï¼Œç„¶åŽæ‰§è¡Œä¸€ä¸ª shell (ä¾‹å¦‚ `/bin/bash -p`)ã€‚éœ€è¦ä½¿ç”¨ `gcc` ç¼–è¯‘è¯¥ç¨‹åºï¼Œä¾‹å¦‚å‘½åä¸º `arcconf`ã€‚
3.  **ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼š** å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ¶æ„ç¨‹åºä½äºŽ `/tmp` ç›®å½•ä¸‹ï¼Œåˆ™æ‰§è¡Œ `PATH=/tmp:$PATH`ã€‚
4.  **æ‰§è¡Œ `ndsudo` å‘½ä»¤ï¼š** ä½¿ç”¨ `ndsudo` æ‰§è¡Œå®ƒæ”¯æŒçš„å‘½ä»¤ï¼Œä½†è¯¥å‘½ä»¤ä¾èµ–äºŽæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`ã€‚`ndsudo` ä¼šå°è¯•æ‰§è¡Œ `arcconf`ï¼Œä½†ç”±äºŽ PATH çŽ¯å¢ƒå˜é‡è¢«ä¿®æ”¹ï¼Œå®ƒä¼šæ‰§è¡Œæ”»å‡»è€…åœ¨ `/tmp` ç›®å½•ä¸‹åˆ›å»ºçš„æ¶æ„ç¨‹åºã€‚
5.  **èŽ·å¾— root shellï¼š** å¦‚æžœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…å°†èŽ·å¾—ä¸€ä¸ª root shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æä¾›çš„ POC ä»£ç ä¸­ï¼Œ`arcconf.c` çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªææƒçš„ shellï¼Œæ²¡æœ‰æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ ä½†ä»Ž github ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ `arcconf` æ—¶ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½åœ¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä»Ž github ä¸Šä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ½œåœ¨é£Žé™©ï¼Œæ•…æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**æ¥æº**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo æœ¬åœ°æƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·æå‡è‡³ root æƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 å’Œ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Netdataï¼Œä¸” ndsudo å·¥å…·è®¾ç½®äº† SUID root æƒé™ï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ ndsudoã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å®ƒä½¿ç”¨ `PATH` çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ `PATH` çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘æ¶æ„ç›®å½•çš„è·¯å¾„ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªä¸Ž `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤åŒåçš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œä»¥ root æƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§:**

æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´žã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåå¼¹ shellï¼‰çš„ç›®å½•ã€‚
2.  å°†æ¶æ„ç¨‹åºå‘½åä¸º `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œ`nvme-list`ï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ `ndsudo` å‘½ä»¤ã€‚`ndsudo` å°†æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€Œä½¿æ”»å‡»è€…èŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©:**

æ ¹æ®æä¾›çš„ä»£ç åˆ†æžï¼Œè¯¥ä»“åº“ä¼¼ä¹Žä¸»è¦æä¾›äº†ä¸€ä¸ª checker è„šæœ¬æ¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œç®¡ç†å‘˜è¯†åˆ«å’ŒéªŒè¯æ¼æ´žæ˜¯å¦å­˜åœ¨ï¼Œæ—¨åœ¨å¸®åŠ©é˜²å¾¡è€…è¯„ä¼°é£Žé™©å’ŒéªŒè¯è¡¥ä¸ï¼Œè€Œä¸æ˜¯æä¾›æ­¦å™¨åŒ–çš„ PoCã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žã€‚

æ£€æŸ¥å™¨ä»£ç ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (æˆ–å®‰è£…ä½ç½®) çš„ SUID/æ‰€æœ‰æƒã€‚
*   `PATH` ä¸­æ—©äºŽå¸¸è§ç³»ç»Ÿè·¯å¾„çš„å¯å†™ç›®å½•ã€‚
*   `ndsudo` å°è¯•æ‰§è¡Œçš„ç™½åå•å­å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚
*   å¯é€‰åœ°è¿è¡Œ `ndsudo --test <subcommand>` æ¥æ‰“å°å·²è§£æžçš„å‘½ä»¤è€Œä¸æ‰§è¡Œå®ƒ (è°¨æ…Žä½¿ç”¨ï¼Œå…ˆé˜…è¯»ä»£ç )ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º 0%**ã€‚


**é¡¹ç›®åœ°å€:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**æ¥æº**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´žèŽ·å–rootæƒé™ã€‚

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”æ”»å‡»è€…éœ€è¦å…·æœ‰æœ¬åœ°ä½Žæƒé™è´¦å·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ netdata çš„ ndsudo å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢è·¯å¾„ç”± PATH çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨ ndsudo æœç´¢è·¯å¾„ä¸­ï¼Œå½“ ndsudo è°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª C ç¨‹åºï¼Œç¼–è¯‘åŽå¯ä»¥ç›´æŽ¥æ‰§è¡Œä¸€ä¸ªå…·æœ‰ root æƒé™çš„ bash shellã€‚æ”»å‡»è€…éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«æ­¤æ¶æ„ç¨‹åºçš„å¯å†™ç›®å½•ï¼Œç„¶åŽä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ­¤ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚ä¹‹åŽï¼Œå½“ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

ä»£ç ä¸­æ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚å®ƒåªæ˜¯ç®€å•åœ°è®¾ç½® uid å’Œ gid ä¸º 0ï¼Œç„¶åŽæ‰§è¡Œ /bin/bashã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º0%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1.  åˆ©ç”¨éœ€è¦å…ˆèŽ·å¾—ä¸€ä¸ªnetdataè½¯ä»¶çš„ä½Žæƒé™è´¦å·ã€‚
2.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ POC ä¸­çš„ C ç¨‹åºç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„å¯å†™ç›®å½•ã€‚
3.  ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†è¯¥ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚
4.  è§¦å‘ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤ï¼Œè¿™å°†å¯¼è‡´æ¶æ„ç¨‹åºä»¥ root æƒé™æ‰§è¡Œï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

**é¡¹ç›®åœ°å€:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**æ¥æº**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯æå‡è‡³rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 åŠ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”å…·æœ‰æœ¬åœ°shellè®¿é—®æƒé™ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 å­˜åœ¨äºŽNetdataçš„`ndsudo`å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·æ˜¯å…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¼æ´žåŽŸå› æ˜¯`ndsudo`çš„æœç´¢è·¯å¾„ç”±`PATH`çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨å‰é¢ï¼Œå½“`ndsudo`æ‰§è¡Œä¿¡ä»»çš„å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œå®žçŽ°æœ¬åœ°ææƒã€‚æä¾›çš„POCä»£ç é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´žï¼š

1.  **ç¼–è¯‘æ¶æ„payload:**  `poc.c` ç¼–è¯‘æˆ `nvme`ï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯æ‰§è¡Œ `/bin/bash`ï¼Œå¹¶è®¾ç½® UID å’Œ GID ä¸º 0ï¼Œå³rootæƒé™ã€‚
2.  **ä¼ è¾“payloadåˆ°ç›®æ ‡ç³»ç»Ÿ:**  å°†ç¼–è¯‘å¥½çš„`nvme`ä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„`/tmp`ç›®å½•ã€‚
3.  **å‡†å¤‡payloadæ‰§è¡Œ:**  ç»™`/tmp/nvme`æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽå°†`/tmp`æ·»åŠ åˆ°`PATH`çŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ã€‚
4.  **è§¦å‘`ndsudo`æ‰§è¡Œpayload:** è¿è¡Œ`./ndsudo nvme-list`ï¼Œ`ndsudo`ä¼šæ‰§è¡Œ`/tmp/nvme`ï¼Œç”±äºŽè¯¥ç¨‹åºä¼šå°†æƒé™æå‡ä¸ºrootï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥èŽ·å¾—root shellã€‚

**æœ‰æ•ˆæ€§ï¼š** è¯¥POCä»£ç æè¿°çš„åˆ©ç”¨æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„`poc.c`ä»£ç åŠŸèƒ½æ¸…æ™°ï¼Œä»…ä¸ºæ‰§è¡Œ`/bin/bash`å¹¶æå‡æƒé™ï¼Œä¸å­˜åœ¨éšè—çš„æŠ•æ¯’ä»£ç ã€‚READMEæ–‡ä»¶æè¿°äº†å®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`PATH`çŽ¯å¢ƒå˜é‡ï¼Œæ¬ºéª—`ndsudo`æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**æ¥æº**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦netdata agentå­˜åœ¨æ¼æ´žç‰ˆæœ¬ä¸”ndsudoè¢«è°ƒç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata Agentä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªrootç”¨æˆ·æ‹¥æœ‰çš„ã€è®¾ç½®äº†SUIDä½çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒæœ¬åº”åªè¿è¡Œä¸€ç»„å—é™çš„å¤–éƒ¨å‘½ä»¤ï¼Œä½†æ˜¯å…¶æœç´¢è·¯å¾„ç”±PATHçŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æŒ‡å®šndsudoæŸ¥æ‰¾è¿™äº›å‘½ä»¤çš„ä½ç½®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯æ”»å‡»è€…å…·æœ‰å†™æƒé™çš„ç›®å½•ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ”¾ç½®æ¶æ„ç¨‹åºå¹¶ä»¥rootæƒé™æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´žæè¿°å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žå­˜åœ¨åˆ©ç”¨ä»·å€¼ï¼Œé€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æ‰§è¡Œæ¶æ„ç¨‹åºè¾¾åˆ°ææƒæ•ˆæžœã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„ä»£ç ä»…ä¸ºGNU GENERAL PUBLIC LICENSEï¼Œæ˜¯å¼€æºåè®®è®¸å¯ï¼Œä¸åŒ…å«ç›´æŽ¥çš„æ”»å‡»payloadæˆ–æ¶æ„ä»£ç ã€‚ä½†licenseæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ä»£ç ï¼Œå¦‚æžœç»“åˆç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œåè®®å†…å®¹ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åˆ›å»ºä¸€ä¸ªåˆæ³•çš„ç¨‹åºï¼Œä½†å…¶è¡Œä¸ºè¿åäº†åè®®æ¡æ¬¾ï¼Œä»Žè€Œé€ æˆæŸå®³ã€‚æ­¤ä»“åº“ä¸­å‘çŽ°ç›´æŽ¥æŠ•æ¯’ä»£ç çš„æ¦‚çŽ‡è¾ƒä½Žï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æ»¥ç”¨é£Žé™©ï¼Œä¼°è®¡æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„Netdata Agentç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 1.44.0-60, < 1.45.3ï¼‰ã€‚
2.  æŸ¥æ‰¾ndsudoå·¥å…·çš„ä½ç½®ã€‚
3.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å‘½ä»¤çš„ç›®å½•ï¼Œä¾‹å¦‚/tmp/evilã€‚
4.  å°†æ¶æ„ç¨‹åºï¼ˆå¦‚åå¼¹shellï¼‰æ”¾ç½®åˆ°/tmp/evilç›®å½•ä¸‹ï¼Œå¹¶å‘½åä¸ºndsudoå°è¯•æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œ`ping`ï¼Œ`date` ç­‰, å…·ä½“å–å†³äºŽ ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼‰ã€‚
5.  ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†/tmp/evilæ·»åŠ åˆ°PATHçš„æœ€å‰é¢ï¼š`export PATH=/tmp/evil:$PATH`ã€‚
6.  è¿è¡Œndsudoï¼Œå®ƒå°†æ‰§è¡Œ/tmp/evilç›®å½•ä¸‹çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**æ¥æº**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡PATHåŠ«æŒæ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata Agentå­˜åœ¨ndsudoï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠå¯æŽ§çš„PATHçŽ¯å¢ƒå˜é‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdataä¸­`ndsudo`å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´žã€‚`ndsudo`æ˜¯ä¸€ä¸ªå…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨`PATH`çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨`PATH`çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆäºŽç³»ç»Ÿç›®å½•çš„ä½ç½®ï¼Œè¯±ä½¿`ndsudo`æ‰§è¡Œè¯¥æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**
1.  æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„`ndsudo`å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶(ä¾‹å¦‚`nvme`)ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œæ”»å‡»è€…å¸Œæœ›æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚æä¾›çš„`payload.c`æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªroot shellã€‚
3.  ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†å½“å‰ç›®å½•(æˆ–åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•)æ·»åŠ åˆ°`PATH`çš„å¼€å¤´ã€‚
4.  è°ƒç”¨`ndsudo`ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ƒå…è®¸æ‰§è¡Œçš„å‘½ä»¤(ä¾‹å¦‚`nvme-list`)ã€‚ç”±äºŽ`PATH`å·²ç»è¢«ä¿®æ”¹ï¼Œ`ndsudo`ä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„`nvme`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»Žè€Œä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºŽæŸ¥æ‰¾`ndsudo`ï¼Œåˆ›å»ºä¸€ä¸ª`nvme` payloadï¼Œä¿®æ”¹`PATH`ï¼Œç„¶åŽæ‰§è¡Œ`ndsudo`ã€‚README.mdæ–‡ä»¶æè¿°äº†å¦‚ä½•ç¼–è¯‘`payload.c`å¹¶ä½¿ç”¨è„šæœ¬ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
æŸ¥çœ‹äº†æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ²¡æœ‰å‘çŽ°ä»»ä½•æŠ•æ¯’ä»£ç ã€‚å…¶ä¸­ï¼ŒCVE-2024-32019.shè„šæœ¬ç”¨äºŽåˆ©ç”¨æ¼æ´žï¼Œpayload.cç”¨äºŽç¼–è¯‘æ¶æ„payloadï¼ŒREADME.mdæ–‡ä»¶æè¿°äº†æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ï¼Œéƒ½æ˜¯æ­£å¸¸çš„åˆ©ç”¨ä»£ç ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**æ¥æº**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata ndsudoå·¥å…·ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªSUID rootçš„ç¨‹åºï¼Œä½†å®ƒä½¿ç”¨äº†PATHçŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡æŒ‡å‘ä¸€ä¸ªè‡ªå·±å¯æŽ§çš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹æ”¾ç½®æ¶æ„ç¨‹åºï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žæ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ£€æŸ¥ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨`/opt`ç›®å½•ä¸‹çš„`ndsudo`ç¨‹åºï¼Œå¹¶ä¸”ç¡®è®¤è¯¥ç¨‹åºæ˜¯å¦ä¸ºrootæ‰€æœ‰ä¸”è®¾ç½®äº†SUIDæƒé™ã€‚åŒæ—¶ï¼Œä½¿ç”¨`strings`å‘½ä»¤æ£€æŸ¥`ndsudo`ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨å¯¹`nvme`ã€`smartctl`ã€`hdparm`æˆ–`sensors`ç­‰å¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¯´æ˜Žè¯¥ç¨‹åºå¯èƒ½å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚
2.  **æ¶æ„ç¨‹åºç¼–è¯‘ï¼š** ç¼–è¯‘ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯è®¾ç½®UIDå’ŒGIDä¸º0ï¼Œç„¶åŽæ‰§è¡Œ`/bin/bash`ï¼Œä»Žè€ŒèŽ·å–root shellã€‚
3.  **æ¶æ„ç¨‹åºä¸Šä¼ ï¼š** é€šè¿‡SFTPå°†ç¼–è¯‘å¥½çš„æ¶æ„ç¨‹åºä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæ”»å‡»è€…å¯æŽ§çš„ç›®å½•ï¼Œä¾‹å¦‚`/tmp`ã€‚
4.  **çŽ¯å¢ƒå˜é‡ä¿®æ”¹ï¼š** ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æ”»å‡»è€…å¯æŽ§çš„ç›®å½•æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ï¼Œç¡®ä¿`ndsudo`ç¨‹åºåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶é¦–å…ˆåœ¨è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ã€‚
5.  **æ¼æ´žè§¦å‘ï¼š** æ‰§è¡Œ`ndsudo`ç¨‹åºï¼Œå½“å®ƒè°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…ä¸Šä¼ çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å–rootæƒé™ã€‚
6.  **äº¤äº’å¼Shellï¼š** æ¼æ´žåˆ©ç”¨ä»£ç æä¾›äº¤äº’å¼shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æ­¤POCä»£ç æœ¬èº«ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œå®žçŽ°æœ¬åœ°ææƒã€‚ä½†æ˜¯ï¼Œè¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ï¼š

*   **ç¼–è¯‘å’Œä¼ è¾“æ¶æ„ä»£ç ï¼š** è„šæœ¬ä¼šè‡ªåŠ¨ç¼–è¯‘Cä»£ç ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚è™½ç„¶Cä»£ç çš„å†…å®¹æ˜¯ææƒï¼Œä½†å¦‚æžœæ¶æ„æ”»å‡»è€…ä¿®æ”¹äº†Cä»£ç ï¼Œå°±å¯èƒ½åŒ…å«å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åŽé—¨ã€æ”¶é›†ä¿¡æ¯ç­‰ã€‚
*   **è¿œç¨‹æ‰§è¡Œä»£ç ï¼š**  è„šæœ¬é€šè¿‡sshæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£Žé™©ï¼Œå¯èƒ½æ‰§è¡Œé¢å¤–çš„æ¶æ„æ“ä½œã€‚
*   **æ®‹ç•™æ–‡ä»¶ï¼š** ç¼–è¯‘åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸Šä¼ çš„æ¶æ„ç¨‹åºå¯èƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç•™ä¸‹ç—•è¿¹ï¼Œå¦‚æžœè¿™äº›æ–‡ä»¶è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å®‰å…¨é—®é¢˜ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é£Žé™©ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œè¯¥POCä»£ç çš„é£Žé™©ä»ç„¶å¯æŽ§ï¼Œä¸»è¦é£Žé™©é›†ä¸­åœ¨ä»£ç çš„ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨ä¸Šã€‚ä¸ºäº†é™ä½Žé£Žé™©ï¼Œå»ºè®®ä»Žå¯ä¿¡çš„æ¥æºèŽ·å–POCä»£ç ï¼Œå¹¶ä»”ç»†æ£€æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿å…¶æ²¡æœ‰æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œåœ¨æµ‹è¯•å®ŒæˆåŽï¼Œåº”åŠæ—¶æ¸…ç†ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ®‹ç•™æ–‡ä»¶ã€‚

æŠ•æ¯’é£Žé™©é¢„ä¼°ä¸º10%ï¼Œå› ä¸ºä»£ç ç›¸å¯¹ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´žéªŒè¯å’Œåˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨è¢«ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**æ¥æº**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°shellè®¿é—®ï¼Œèƒ½å¤Ÿæ‰§è¡Œndsudoå‘½ä»¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2024-32019 æ˜¯ Netdata ä¸­ ndsudo å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudo æ˜¯ä¸€ä¸ª SUID root çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„è„šæœ¬æ”¾ç½®åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆçº§æ›´é«˜çš„ç›®å½•ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ nvmeï¼‰ï¼Œæ¥æ¬ºéª— ndsudo æ‰§è¡Œè¯¥æ¶æ„è„šæœ¬å¹¶èŽ·å¾— root æƒé™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æè¿°äº†ä¸€ç§åˆ©ç”¨æ­¤æ¼æ´žçš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1.  åˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼ˆpoc.pyï¼‰ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
2.  å°†æ­¤è„šæœ¬é‡å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ nvmeï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ ndsudo nvme-listï¼Œè¿™å°†å¯¼è‡´ ndsudo æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“æœ¬èº«æŠ•æ¯’é£Žé™©è¾ƒä½Žã€‚`poc.py` ä»£ç éžå¸¸ç®€å•ï¼Œä»…åŒ…å«ææƒæ‰§è¡Œbashçš„ä»£ç ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„ä»£ç ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¸…æ™°çš„æ¼æ´žåˆ©ç”¨è¯´æ˜Žã€‚ä½†ç”¨æˆ·ä»ç„¶éœ€è¦æ³¨æ„ï¼Œåœ¨å®žé™…çŽ¯å¢ƒä¸­ï¼Œä»Žä¸å¯ä¿¡çš„æ¥æºä¸‹è½½æˆ–å¤åˆ¶æ¼æ´žåˆ©ç”¨ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£Žé™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå†æ‰§è¡Œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žåŽŸç†ï¼š** `ndsudo` ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢å‘½ä»¤çš„è·¯å¾„ä¾èµ–äºŽç”¨æˆ·çš„ `PATH` çŽ¯å¢ƒå˜é‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   åˆ›å»ºæ¶æ„è„šæœ¬ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
    *   å°†æ­¤è„šæœ¬é‡å‘½åä¸º `ndsudo` å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆé€šè¿‡ `ndsudo --help` æŸ¥çœ‹ï¼‰ã€‚
    *   å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œç¡®ä¿æ¶æ„è„šæœ¬ä¼˜å…ˆè¢«æœç´¢åˆ°ã€‚
    *   è¿è¡Œ `ndsudo <allowed_command>`ï¼Œè¿™å°†å¯¼è‡´ `ndsudo` æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´žåˆ©ç”¨è¾ƒä¸ºç®€å•ï¼ŒPOC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä½†åº”æ³¨æ„æ¥æºä¸æ˜Žçš„exploitä»£ç çš„æ½œåœ¨æŠ•æ¯’é£Žé™©ã€‚è¯¥æ¼æ´žå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡æ“çºµ `PATH` çŽ¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨ SUID ç¨‹åº `ndsudo` æå‡è‡³ root æƒé™ã€‚åŠ¡å¿…åŠæ—¶å‡çº§ Netdata ç‰ˆæœ¬ä»¥ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**æ¥æº**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœ¬åœ°ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata agentè¿è¡Œåœ¨å—å½±å“ç‰ˆæœ¬ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰§è¡Œæœ¬åœ°ä»£ç ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·æ‹¥æœ‰ SUID æƒé™ï¼Œå…è®¸æ‰§è¡ŒæŸäº›ç‰¹æƒå‘½ä»¤ã€‚æ¼æ´žçš„æ ¹æºåœ¨äºŽ `ndsudo` ä½¿ç”¨ä¸å®‰å…¨çš„ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ PATH ä¸­æ’å…¥æ¶æ„ç¨‹åºï¼Œè®© `ndsudo` æ‰§è¡Œæ”»å‡»è€…æŽ§åˆ¶çš„ä»£ç ï¼Œä»Žè€Œæå‡æƒé™åˆ° rootã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾ `ndsudo` è·¯å¾„ï¼š** é€šå¸¸ä½äºŽ `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`ï¼Œä½†éœ€è¦é€šè¿‡ `find` å‘½ä»¤ç¡®è®¤ã€‚
2.  **åˆ›å»ºæ¶æ„ç¨‹åºï¼š** åˆ›å»ºä¸€ä¸ª C ç¨‹åºï¼Œè¯¥ç¨‹åºè°ƒç”¨ `setuid(0)` å’Œ `setgid(0)` è®¾ç½®ç”¨æˆ·å’Œç»„ ID ä¸º rootï¼Œç„¶åŽæ‰§è¡Œä¸€ä¸ª shell (ä¾‹å¦‚ `/bin/bash -p`)ã€‚éœ€è¦ä½¿ç”¨ `gcc` ç¼–è¯‘è¯¥ç¨‹åºï¼Œä¾‹å¦‚å‘½åä¸º `arcconf`ã€‚
3.  **ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼š** å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ¶æ„ç¨‹åºä½äºŽ `/tmp` ç›®å½•ä¸‹ï¼Œåˆ™æ‰§è¡Œ `PATH=/tmp:$PATH`ã€‚
4.  **æ‰§è¡Œ `ndsudo` å‘½ä»¤ï¼š** ä½¿ç”¨ `ndsudo` æ‰§è¡Œå®ƒæ”¯æŒçš„å‘½ä»¤ï¼Œä½†è¯¥å‘½ä»¤ä¾èµ–äºŽæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`ã€‚`ndsudo` ä¼šå°è¯•æ‰§è¡Œ `arcconf`ï¼Œä½†ç”±äºŽ PATH çŽ¯å¢ƒå˜é‡è¢«ä¿®æ”¹ï¼Œå®ƒä¼šæ‰§è¡Œæ”»å‡»è€…åœ¨ `/tmp` ç›®å½•ä¸‹åˆ›å»ºçš„æ¶æ„ç¨‹åºã€‚
5.  **èŽ·å¾— root shellï¼š** å¦‚æžœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…å°†èŽ·å¾—ä¸€ä¸ª root shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æä¾›çš„ POC ä»£ç ä¸­ï¼Œ`arcconf.c` çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªææƒçš„ shellï¼Œæ²¡æœ‰æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ ä½†ä»Ž github ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ `arcconf` æ—¶ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½åœ¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä»Ž github ä¸Šä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ½œåœ¨é£Žé™©ï¼Œæ•…æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**æ¥æº**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo æœ¬åœ°æƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·æå‡è‡³ root æƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 å’Œ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Netdataï¼Œä¸” ndsudo å·¥å…·è®¾ç½®äº† SUID root æƒé™ï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ ndsudoã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å®ƒä½¿ç”¨ `PATH` çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ `PATH` çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘æ¶æ„ç›®å½•çš„è·¯å¾„ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªä¸Ž `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤åŒåçš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œä»¥ root æƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§:**

æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´žã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåå¼¹ shellï¼‰çš„ç›®å½•ã€‚
2.  å°†æ¶æ„ç¨‹åºå‘½åä¸º `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œ`nvme-list`ï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ `ndsudo` å‘½ä»¤ã€‚`ndsudo` å°†æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€Œä½¿æ”»å‡»è€…èŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©:**

æ ¹æ®æä¾›çš„ä»£ç åˆ†æžï¼Œè¯¥ä»“åº“ä¼¼ä¹Žä¸»è¦æä¾›äº†ä¸€ä¸ª checker è„šæœ¬æ¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œç®¡ç†å‘˜è¯†åˆ«å’ŒéªŒè¯æ¼æ´žæ˜¯å¦å­˜åœ¨ï¼Œæ—¨åœ¨å¸®åŠ©é˜²å¾¡è€…è¯„ä¼°é£Žé™©å’ŒéªŒè¯è¡¥ä¸ï¼Œè€Œä¸æ˜¯æä¾›æ­¦å™¨åŒ–çš„ PoCã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žã€‚

æ£€æŸ¥å™¨ä»£ç ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (æˆ–å®‰è£…ä½ç½®) çš„ SUID/æ‰€æœ‰æƒã€‚
*   `PATH` ä¸­æ—©äºŽå¸¸è§ç³»ç»Ÿè·¯å¾„çš„å¯å†™ç›®å½•ã€‚
*   `ndsudo` å°è¯•æ‰§è¡Œçš„ç™½åå•å­å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚
*   å¯é€‰åœ°è¿è¡Œ `ndsudo --test <subcommand>` æ¥æ‰“å°å·²è§£æžçš„å‘½ä»¤è€Œä¸æ‰§è¡Œå®ƒ (è°¨æ…Žä½¿ç”¨ï¼Œå…ˆé˜…è¯»ä»£ç )ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º 0%**ã€‚


**é¡¹ç›®åœ°å€:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**æ¥æº**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´žèŽ·å–rootæƒé™ã€‚

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”æ”»å‡»è€…éœ€è¦å…·æœ‰æœ¬åœ°ä½Žæƒé™è´¦å·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ netdata çš„ ndsudo å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢è·¯å¾„ç”± PATH çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨ ndsudo æœç´¢è·¯å¾„ä¸­ï¼Œå½“ ndsudo è°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª C ç¨‹åºï¼Œç¼–è¯‘åŽå¯ä»¥ç›´æŽ¥æ‰§è¡Œä¸€ä¸ªå…·æœ‰ root æƒé™çš„ bash shellã€‚æ”»å‡»è€…éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«æ­¤æ¶æ„ç¨‹åºçš„å¯å†™ç›®å½•ï¼Œç„¶åŽä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ­¤ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚ä¹‹åŽï¼Œå½“ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

ä»£ç ä¸­æ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚å®ƒåªæ˜¯ç®€å•åœ°è®¾ç½® uid å’Œ gid ä¸º 0ï¼Œç„¶åŽæ‰§è¡Œ /bin/bashã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º0%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1.  åˆ©ç”¨éœ€è¦å…ˆèŽ·å¾—ä¸€ä¸ªnetdataè½¯ä»¶çš„ä½Žæƒé™è´¦å·ã€‚
2.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ POC ä¸­çš„ C ç¨‹åºç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„å¯å†™ç›®å½•ã€‚
3.  ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†è¯¥ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚
4.  è§¦å‘ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤ï¼Œè¿™å°†å¯¼è‡´æ¶æ„ç¨‹åºä»¥ root æƒé™æ‰§è¡Œï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

**é¡¹ç›®åœ°å€:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**æ¥æº**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯æå‡è‡³rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 åŠ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”å…·æœ‰æœ¬åœ°shellè®¿é—®æƒé™ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 å­˜åœ¨äºŽNetdataçš„`ndsudo`å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·æ˜¯å…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¼æ´žåŽŸå› æ˜¯`ndsudo`çš„æœç´¢è·¯å¾„ç”±`PATH`çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨å‰é¢ï¼Œå½“`ndsudo`æ‰§è¡Œä¿¡ä»»çš„å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œå®žçŽ°æœ¬åœ°ææƒã€‚æä¾›çš„POCä»£ç é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´žï¼š

1.  **ç¼–è¯‘æ¶æ„payload:**  `poc.c` ç¼–è¯‘æˆ `nvme`ï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯æ‰§è¡Œ `/bin/bash`ï¼Œå¹¶è®¾ç½® UID å’Œ GID ä¸º 0ï¼Œå³rootæƒé™ã€‚
2.  **ä¼ è¾“payloadåˆ°ç›®æ ‡ç³»ç»Ÿ:**  å°†ç¼–è¯‘å¥½çš„`nvme`ä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„`/tmp`ç›®å½•ã€‚
3.  **å‡†å¤‡payloadæ‰§è¡Œ:**  ç»™`/tmp/nvme`æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽå°†`/tmp`æ·»åŠ åˆ°`PATH`çŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ã€‚
4.  **è§¦å‘`ndsudo`æ‰§è¡Œpayload:** è¿è¡Œ`./ndsudo nvme-list`ï¼Œ`ndsudo`ä¼šæ‰§è¡Œ`/tmp/nvme`ï¼Œç”±äºŽè¯¥ç¨‹åºä¼šå°†æƒé™æå‡ä¸ºrootï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥èŽ·å¾—root shellã€‚

**æœ‰æ•ˆæ€§ï¼š** è¯¥POCä»£ç æè¿°çš„åˆ©ç”¨æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„`poc.c`ä»£ç åŠŸèƒ½æ¸…æ™°ï¼Œä»…ä¸ºæ‰§è¡Œ`/bin/bash`å¹¶æå‡æƒé™ï¼Œä¸å­˜åœ¨éšè—çš„æŠ•æ¯’ä»£ç ã€‚READMEæ–‡ä»¶æè¿°äº†å®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`PATH`çŽ¯å¢ƒå˜é‡ï¼Œæ¬ºéª—`ndsudo`æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**æ¥æº**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦netdata agentå­˜åœ¨æ¼æ´žç‰ˆæœ¬ä¸”ndsudoè¢«è°ƒç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata Agentä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªrootç”¨æˆ·æ‹¥æœ‰çš„ã€è®¾ç½®äº†SUIDä½çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒæœ¬åº”åªè¿è¡Œä¸€ç»„å—é™çš„å¤–éƒ¨å‘½ä»¤ï¼Œä½†æ˜¯å…¶æœç´¢è·¯å¾„ç”±PATHçŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æŒ‡å®šndsudoæŸ¥æ‰¾è¿™äº›å‘½ä»¤çš„ä½ç½®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯æ”»å‡»è€…å…·æœ‰å†™æƒé™çš„ç›®å½•ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ”¾ç½®æ¶æ„ç¨‹åºå¹¶ä»¥rootæƒé™æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´žæè¿°å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žå­˜åœ¨åˆ©ç”¨ä»·å€¼ï¼Œé€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æ‰§è¡Œæ¶æ„ç¨‹åºè¾¾åˆ°ææƒæ•ˆæžœã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„ä»£ç ä»…ä¸ºGNU GENERAL PUBLIC LICENSEï¼Œæ˜¯å¼€æºåè®®è®¸å¯ï¼Œä¸åŒ…å«ç›´æŽ¥çš„æ”»å‡»payloadæˆ–æ¶æ„ä»£ç ã€‚ä½†licenseæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ä»£ç ï¼Œå¦‚æžœç»“åˆç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œåè®®å†…å®¹ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åˆ›å»ºä¸€ä¸ªåˆæ³•çš„ç¨‹åºï¼Œä½†å…¶è¡Œä¸ºè¿åäº†åè®®æ¡æ¬¾ï¼Œä»Žè€Œé€ æˆæŸå®³ã€‚æ­¤ä»“åº“ä¸­å‘çŽ°ç›´æŽ¥æŠ•æ¯’ä»£ç çš„æ¦‚çŽ‡è¾ƒä½Žï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æ»¥ç”¨é£Žé™©ï¼Œä¼°è®¡æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„Netdata Agentç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 1.44.0-60, < 1.45.3ï¼‰ã€‚
2.  æŸ¥æ‰¾ndsudoå·¥å…·çš„ä½ç½®ã€‚
3.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å‘½ä»¤çš„ç›®å½•ï¼Œä¾‹å¦‚/tmp/evilã€‚
4.  å°†æ¶æ„ç¨‹åºï¼ˆå¦‚åå¼¹shellï¼‰æ”¾ç½®åˆ°/tmp/evilç›®å½•ä¸‹ï¼Œå¹¶å‘½åä¸ºndsudoå°è¯•æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œ`ping`ï¼Œ`date` ç­‰, å…·ä½“å–å†³äºŽ ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼‰ã€‚
5.  ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†/tmp/evilæ·»åŠ åˆ°PATHçš„æœ€å‰é¢ï¼š`export PATH=/tmp/evil:$PATH`ã€‚
6.  è¿è¡Œndsudoï¼Œå®ƒå°†æ‰§è¡Œ/tmp/evilç›®å½•ä¸‹çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**æ¥æº**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡PATHåŠ«æŒæ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata Agentå­˜åœ¨ndsudoï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠå¯æŽ§çš„PATHçŽ¯å¢ƒå˜é‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdataä¸­`ndsudo`å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´žã€‚`ndsudo`æ˜¯ä¸€ä¸ªå…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨`PATH`çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨`PATH`çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆäºŽç³»ç»Ÿç›®å½•çš„ä½ç½®ï¼Œè¯±ä½¿`ndsudo`æ‰§è¡Œè¯¥æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**
1.  æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„`ndsudo`å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶(ä¾‹å¦‚`nvme`)ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œæ”»å‡»è€…å¸Œæœ›æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚æä¾›çš„`payload.c`æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªroot shellã€‚
3.  ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†å½“å‰ç›®å½•(æˆ–åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•)æ·»åŠ åˆ°`PATH`çš„å¼€å¤´ã€‚
4.  è°ƒç”¨`ndsudo`ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ƒå…è®¸æ‰§è¡Œçš„å‘½ä»¤(ä¾‹å¦‚`nvme-list`)ã€‚ç”±äºŽ`PATH`å·²ç»è¢«ä¿®æ”¹ï¼Œ`ndsudo`ä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„`nvme`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»Žè€Œä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºŽæŸ¥æ‰¾`ndsudo`ï¼Œåˆ›å»ºä¸€ä¸ª`nvme` payloadï¼Œä¿®æ”¹`PATH`ï¼Œç„¶åŽæ‰§è¡Œ`ndsudo`ã€‚README.mdæ–‡ä»¶æè¿°äº†å¦‚ä½•ç¼–è¯‘`payload.c`å¹¶ä½¿ç”¨è„šæœ¬ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
æŸ¥çœ‹äº†æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ²¡æœ‰å‘çŽ°ä»»ä½•æŠ•æ¯’ä»£ç ã€‚å…¶ä¸­ï¼ŒCVE-2024-32019.shè„šæœ¬ç”¨äºŽåˆ©ç”¨æ¼æ´žï¼Œpayload.cç”¨äºŽç¼–è¯‘æ¶æ„payloadï¼ŒREADME.mdæ–‡ä»¶æè¿°äº†æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ï¼Œéƒ½æ˜¯æ­£å¸¸çš„åˆ©ç”¨ä»£ç ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**æ¥æº**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata ndsudoå·¥å…·ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªSUID rootçš„ç¨‹åºï¼Œä½†å®ƒä½¿ç”¨äº†PATHçŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡æŒ‡å‘ä¸€ä¸ªè‡ªå·±å¯æŽ§çš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹æ”¾ç½®æ¶æ„ç¨‹åºï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žæ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ£€æŸ¥ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨`/opt`ç›®å½•ä¸‹çš„`ndsudo`ç¨‹åºï¼Œå¹¶ä¸”ç¡®è®¤è¯¥ç¨‹åºæ˜¯å¦ä¸ºrootæ‰€æœ‰ä¸”è®¾ç½®äº†SUIDæƒé™ã€‚åŒæ—¶ï¼Œä½¿ç”¨`strings`å‘½ä»¤æ£€æŸ¥`ndsudo`ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨å¯¹`nvme`ã€`smartctl`ã€`hdparm`æˆ–`sensors`ç­‰å¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¯´æ˜Žè¯¥ç¨‹åºå¯èƒ½å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚
2.  **æ¶æ„ç¨‹åºç¼–è¯‘ï¼š** ç¼–è¯‘ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯è®¾ç½®UIDå’ŒGIDä¸º0ï¼Œç„¶åŽæ‰§è¡Œ`/bin/bash`ï¼Œä»Žè€ŒèŽ·å–root shellã€‚
3.  **æ¶æ„ç¨‹åºä¸Šä¼ ï¼š** é€šè¿‡SFTPå°†ç¼–è¯‘å¥½çš„æ¶æ„ç¨‹åºä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæ”»å‡»è€…å¯æŽ§çš„ç›®å½•ï¼Œä¾‹å¦‚`/tmp`ã€‚
4.  **çŽ¯å¢ƒå˜é‡ä¿®æ”¹ï¼š** ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æ”»å‡»è€…å¯æŽ§çš„ç›®å½•æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ï¼Œç¡®ä¿`ndsudo`ç¨‹åºåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶é¦–å…ˆåœ¨è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ã€‚
5.  **æ¼æ´žè§¦å‘ï¼š** æ‰§è¡Œ`ndsudo`ç¨‹åºï¼Œå½“å®ƒè°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…ä¸Šä¼ çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å–rootæƒé™ã€‚
6.  **äº¤äº’å¼Shellï¼š** æ¼æ´žåˆ©ç”¨ä»£ç æä¾›äº¤äº’å¼shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æ­¤POCä»£ç æœ¬èº«ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œå®žçŽ°æœ¬åœ°ææƒã€‚ä½†æ˜¯ï¼Œè¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ï¼š

*   **ç¼–è¯‘å’Œä¼ è¾“æ¶æ„ä»£ç ï¼š** è„šæœ¬ä¼šè‡ªåŠ¨ç¼–è¯‘Cä»£ç ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚è™½ç„¶Cä»£ç çš„å†…å®¹æ˜¯ææƒï¼Œä½†å¦‚æžœæ¶æ„æ”»å‡»è€…ä¿®æ”¹äº†Cä»£ç ï¼Œå°±å¯èƒ½åŒ…å«å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åŽé—¨ã€æ”¶é›†ä¿¡æ¯ç­‰ã€‚
*   **è¿œç¨‹æ‰§è¡Œä»£ç ï¼š**  è„šæœ¬é€šè¿‡sshæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£Žé™©ï¼Œå¯èƒ½æ‰§è¡Œé¢å¤–çš„æ¶æ„æ“ä½œã€‚
*   **æ®‹ç•™æ–‡ä»¶ï¼š** ç¼–è¯‘åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸Šä¼ çš„æ¶æ„ç¨‹åºå¯èƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç•™ä¸‹ç—•è¿¹ï¼Œå¦‚æžœè¿™äº›æ–‡ä»¶è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å®‰å…¨é—®é¢˜ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é£Žé™©ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œè¯¥POCä»£ç çš„é£Žé™©ä»ç„¶å¯æŽ§ï¼Œä¸»è¦é£Žé™©é›†ä¸­åœ¨ä»£ç çš„ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨ä¸Šã€‚ä¸ºäº†é™ä½Žé£Žé™©ï¼Œå»ºè®®ä»Žå¯ä¿¡çš„æ¥æºèŽ·å–POCä»£ç ï¼Œå¹¶ä»”ç»†æ£€æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿å…¶æ²¡æœ‰æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œåœ¨æµ‹è¯•å®ŒæˆåŽï¼Œåº”åŠæ—¶æ¸…ç†ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ®‹ç•™æ–‡ä»¶ã€‚

æŠ•æ¯’é£Žé™©é¢„ä¼°ä¸º10%ï¼Œå› ä¸ºä»£ç ç›¸å¯¹ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´žéªŒè¯å’Œåˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨è¢«ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**æ¥æº**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°shellè®¿é—®ï¼Œèƒ½å¤Ÿæ‰§è¡Œndsudoå‘½ä»¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2024-32019 æ˜¯ Netdata ä¸­ ndsudo å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudo æ˜¯ä¸€ä¸ª SUID root çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„è„šæœ¬æ”¾ç½®åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆçº§æ›´é«˜çš„ç›®å½•ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ nvmeï¼‰ï¼Œæ¥æ¬ºéª— ndsudo æ‰§è¡Œè¯¥æ¶æ„è„šæœ¬å¹¶èŽ·å¾— root æƒé™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æè¿°äº†ä¸€ç§åˆ©ç”¨æ­¤æ¼æ´žçš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1.  åˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼ˆpoc.pyï¼‰ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
2.  å°†æ­¤è„šæœ¬é‡å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ nvmeï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ ndsudo nvme-listï¼Œè¿™å°†å¯¼è‡´ ndsudo æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“æœ¬èº«æŠ•æ¯’é£Žé™©è¾ƒä½Žã€‚`poc.py` ä»£ç éžå¸¸ç®€å•ï¼Œä»…åŒ…å«ææƒæ‰§è¡Œbashçš„ä»£ç ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„ä»£ç ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¸…æ™°çš„æ¼æ´žåˆ©ç”¨è¯´æ˜Žã€‚ä½†ç”¨æˆ·ä»ç„¶éœ€è¦æ³¨æ„ï¼Œåœ¨å®žé™…çŽ¯å¢ƒä¸­ï¼Œä»Žä¸å¯ä¿¡çš„æ¥æºä¸‹è½½æˆ–å¤åˆ¶æ¼æ´žåˆ©ç”¨ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£Žé™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå†æ‰§è¡Œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žåŽŸç†ï¼š** `ndsudo` ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢å‘½ä»¤çš„è·¯å¾„ä¾èµ–äºŽç”¨æˆ·çš„ `PATH` çŽ¯å¢ƒå˜é‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   åˆ›å»ºæ¶æ„è„šæœ¬ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
    *   å°†æ­¤è„šæœ¬é‡å‘½åä¸º `ndsudo` å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆé€šè¿‡ `ndsudo --help` æŸ¥çœ‹ï¼‰ã€‚
    *   å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œç¡®ä¿æ¶æ„è„šæœ¬ä¼˜å…ˆè¢«æœç´¢åˆ°ã€‚
    *   è¿è¡Œ `ndsudo <allowed_command>`ï¼Œè¿™å°†å¯¼è‡´ `ndsudo` æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´žåˆ©ç”¨è¾ƒä¸ºç®€å•ï¼ŒPOC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä½†åº”æ³¨æ„æ¥æºä¸æ˜Žçš„exploitä»£ç çš„æ½œåœ¨æŠ•æ¯’é£Žé™©ã€‚è¯¥æ¼æ´žå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡æ“çºµ `PATH` çŽ¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨ SUID ç¨‹åº `ndsudo` æå‡è‡³ root æƒé™ã€‚åŠ¡å¿…åŠæ—¶å‡çº§ Netdata ç‰ˆæœ¬ä»¥ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**æ¥æº**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœ¬åœ°ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata agentè¿è¡Œåœ¨å—å½±å“ç‰ˆæœ¬ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰§è¡Œæœ¬åœ°ä»£ç ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·æ‹¥æœ‰ SUID æƒé™ï¼Œå…è®¸æ‰§è¡ŒæŸäº›ç‰¹æƒå‘½ä»¤ã€‚æ¼æ´žçš„æ ¹æºåœ¨äºŽ `ndsudo` ä½¿ç”¨ä¸å®‰å…¨çš„ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ PATH ä¸­æ’å…¥æ¶æ„ç¨‹åºï¼Œè®© `ndsudo` æ‰§è¡Œæ”»å‡»è€…æŽ§åˆ¶çš„ä»£ç ï¼Œä»Žè€Œæå‡æƒé™åˆ° rootã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾ `ndsudo` è·¯å¾„ï¼š** é€šå¸¸ä½äºŽ `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`ï¼Œä½†éœ€è¦é€šè¿‡ `find` å‘½ä»¤ç¡®è®¤ã€‚
2.  **åˆ›å»ºæ¶æ„ç¨‹åºï¼š** åˆ›å»ºä¸€ä¸ª C ç¨‹åºï¼Œè¯¥ç¨‹åºè°ƒç”¨ `setuid(0)` å’Œ `setgid(0)` è®¾ç½®ç”¨æˆ·å’Œç»„ ID ä¸º rootï¼Œç„¶åŽæ‰§è¡Œä¸€ä¸ª shell (ä¾‹å¦‚ `/bin/bash -p`)ã€‚éœ€è¦ä½¿ç”¨ `gcc` ç¼–è¯‘è¯¥ç¨‹åºï¼Œä¾‹å¦‚å‘½åä¸º `arcconf`ã€‚
3.  **ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼š** å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ¶æ„ç¨‹åºä½äºŽ `/tmp` ç›®å½•ä¸‹ï¼Œåˆ™æ‰§è¡Œ `PATH=/tmp:$PATH`ã€‚
4.  **æ‰§è¡Œ `ndsudo` å‘½ä»¤ï¼š** ä½¿ç”¨ `ndsudo` æ‰§è¡Œå®ƒæ”¯æŒçš„å‘½ä»¤ï¼Œä½†è¯¥å‘½ä»¤ä¾èµ–äºŽæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`ã€‚`ndsudo` ä¼šå°è¯•æ‰§è¡Œ `arcconf`ï¼Œä½†ç”±äºŽ PATH çŽ¯å¢ƒå˜é‡è¢«ä¿®æ”¹ï¼Œå®ƒä¼šæ‰§è¡Œæ”»å‡»è€…åœ¨ `/tmp` ç›®å½•ä¸‹åˆ›å»ºçš„æ¶æ„ç¨‹åºã€‚
5.  **èŽ·å¾— root shellï¼š** å¦‚æžœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…å°†èŽ·å¾—ä¸€ä¸ª root shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æä¾›çš„ POC ä»£ç ä¸­ï¼Œ`arcconf.c` çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªææƒçš„ shellï¼Œæ²¡æœ‰æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ ä½†ä»Ž github ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ `arcconf` æ—¶ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½åœ¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä»Ž github ä¸Šä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ½œåœ¨é£Žé™©ï¼Œæ•…æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**æ¥æº**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo æœ¬åœ°æƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·æå‡è‡³ root æƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 å’Œ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Netdataï¼Œä¸” ndsudo å·¥å…·è®¾ç½®äº† SUID root æƒé™ï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ ndsudoã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å®ƒä½¿ç”¨ `PATH` çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ `PATH` çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘æ¶æ„ç›®å½•çš„è·¯å¾„ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªä¸Ž `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤åŒåçš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œä»¥ root æƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§:**

æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´žã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåå¼¹ shellï¼‰çš„ç›®å½•ã€‚
2.  å°†æ¶æ„ç¨‹åºå‘½åä¸º `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œ`nvme-list`ï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ `ndsudo` å‘½ä»¤ã€‚`ndsudo` å°†æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€Œä½¿æ”»å‡»è€…èŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©:**

æ ¹æ®æä¾›çš„ä»£ç åˆ†æžï¼Œè¯¥ä»“åº“ä¼¼ä¹Žä¸»è¦æä¾›äº†ä¸€ä¸ª checker è„šæœ¬æ¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œç®¡ç†å‘˜è¯†åˆ«å’ŒéªŒè¯æ¼æ´žæ˜¯å¦å­˜åœ¨ï¼Œæ—¨åœ¨å¸®åŠ©é˜²å¾¡è€…è¯„ä¼°é£Žé™©å’ŒéªŒè¯è¡¥ä¸ï¼Œè€Œä¸æ˜¯æä¾›æ­¦å™¨åŒ–çš„ PoCã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žã€‚

æ£€æŸ¥å™¨ä»£ç ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (æˆ–å®‰è£…ä½ç½®) çš„ SUID/æ‰€æœ‰æƒã€‚
*   `PATH` ä¸­æ—©äºŽå¸¸è§ç³»ç»Ÿè·¯å¾„çš„å¯å†™ç›®å½•ã€‚
*   `ndsudo` å°è¯•æ‰§è¡Œçš„ç™½åå•å­å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚
*   å¯é€‰åœ°è¿è¡Œ `ndsudo --test <subcommand>` æ¥æ‰“å°å·²è§£æžçš„å‘½ä»¤è€Œä¸æ‰§è¡Œå®ƒ (è°¨æ…Žä½¿ç”¨ï¼Œå…ˆé˜…è¯»ä»£ç )ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º 0%**ã€‚


**é¡¹ç›®åœ°å€:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**æ¥æº**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´žèŽ·å–rootæƒé™ã€‚

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”æ”»å‡»è€…éœ€è¦å…·æœ‰æœ¬åœ°ä½Žæƒé™è´¦å·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ netdata çš„ ndsudo å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢è·¯å¾„ç”± PATH çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨ ndsudo æœç´¢è·¯å¾„ä¸­ï¼Œå½“ ndsudo è°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª C ç¨‹åºï¼Œç¼–è¯‘åŽå¯ä»¥ç›´æŽ¥æ‰§è¡Œä¸€ä¸ªå…·æœ‰ root æƒé™çš„ bash shellã€‚æ”»å‡»è€…éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«æ­¤æ¶æ„ç¨‹åºçš„å¯å†™ç›®å½•ï¼Œç„¶åŽä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ­¤ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚ä¹‹åŽï¼Œå½“ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

ä»£ç ä¸­æ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚å®ƒåªæ˜¯ç®€å•åœ°è®¾ç½® uid å’Œ gid ä¸º 0ï¼Œç„¶åŽæ‰§è¡Œ /bin/bashã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º0%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1.  åˆ©ç”¨éœ€è¦å…ˆèŽ·å¾—ä¸€ä¸ªnetdataè½¯ä»¶çš„ä½Žæƒé™è´¦å·ã€‚
2.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ POC ä¸­çš„ C ç¨‹åºç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„å¯å†™ç›®å½•ã€‚
3.  ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†è¯¥ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚
4.  è§¦å‘ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤ï¼Œè¿™å°†å¯¼è‡´æ¶æ„ç¨‹åºä»¥ root æƒé™æ‰§è¡Œï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

**é¡¹ç›®åœ°å€:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**æ¥æº**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯æå‡è‡³rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 åŠ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”å…·æœ‰æœ¬åœ°shellè®¿é—®æƒé™ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 å­˜åœ¨äºŽNetdataçš„`ndsudo`å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·æ˜¯å…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¼æ´žåŽŸå› æ˜¯`ndsudo`çš„æœç´¢è·¯å¾„ç”±`PATH`çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨å‰é¢ï¼Œå½“`ndsudo`æ‰§è¡Œä¿¡ä»»çš„å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œå®žçŽ°æœ¬åœ°ææƒã€‚æä¾›çš„POCä»£ç é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´žï¼š

1.  **ç¼–è¯‘æ¶æ„payload:**  `poc.c` ç¼–è¯‘æˆ `nvme`ï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯æ‰§è¡Œ `/bin/bash`ï¼Œå¹¶è®¾ç½® UID å’Œ GID ä¸º 0ï¼Œå³rootæƒé™ã€‚
2.  **ä¼ è¾“payloadåˆ°ç›®æ ‡ç³»ç»Ÿ:**  å°†ç¼–è¯‘å¥½çš„`nvme`ä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„`/tmp`ç›®å½•ã€‚
3.  **å‡†å¤‡payloadæ‰§è¡Œ:**  ç»™`/tmp/nvme`æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽå°†`/tmp`æ·»åŠ åˆ°`PATH`çŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ã€‚
4.  **è§¦å‘`ndsudo`æ‰§è¡Œpayload:** è¿è¡Œ`./ndsudo nvme-list`ï¼Œ`ndsudo`ä¼šæ‰§è¡Œ`/tmp/nvme`ï¼Œç”±äºŽè¯¥ç¨‹åºä¼šå°†æƒé™æå‡ä¸ºrootï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥èŽ·å¾—root shellã€‚

**æœ‰æ•ˆæ€§ï¼š** è¯¥POCä»£ç æè¿°çš„åˆ©ç”¨æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„`poc.c`ä»£ç åŠŸèƒ½æ¸…æ™°ï¼Œä»…ä¸ºæ‰§è¡Œ`/bin/bash`å¹¶æå‡æƒé™ï¼Œä¸å­˜åœ¨éšè—çš„æŠ•æ¯’ä»£ç ã€‚READMEæ–‡ä»¶æè¿°äº†å®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`PATH`çŽ¯å¢ƒå˜é‡ï¼Œæ¬ºéª—`ndsudo`æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**æ¥æº**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦netdata agentå­˜åœ¨æ¼æ´žç‰ˆæœ¬ä¸”ndsudoè¢«è°ƒç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata Agentä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªrootç”¨æˆ·æ‹¥æœ‰çš„ã€è®¾ç½®äº†SUIDä½çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒæœ¬åº”åªè¿è¡Œä¸€ç»„å—é™çš„å¤–éƒ¨å‘½ä»¤ï¼Œä½†æ˜¯å…¶æœç´¢è·¯å¾„ç”±PATHçŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æŒ‡å®šndsudoæŸ¥æ‰¾è¿™äº›å‘½ä»¤çš„ä½ç½®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯æ”»å‡»è€…å…·æœ‰å†™æƒé™çš„ç›®å½•ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ”¾ç½®æ¶æ„ç¨‹åºå¹¶ä»¥rootæƒé™æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´žæè¿°å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žå­˜åœ¨åˆ©ç”¨ä»·å€¼ï¼Œé€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æ‰§è¡Œæ¶æ„ç¨‹åºè¾¾åˆ°ææƒæ•ˆæžœã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„ä»£ç ä»…ä¸ºGNU GENERAL PUBLIC LICENSEï¼Œæ˜¯å¼€æºåè®®è®¸å¯ï¼Œä¸åŒ…å«ç›´æŽ¥çš„æ”»å‡»payloadæˆ–æ¶æ„ä»£ç ã€‚ä½†licenseæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ä»£ç ï¼Œå¦‚æžœç»“åˆç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œåè®®å†…å®¹ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åˆ›å»ºä¸€ä¸ªåˆæ³•çš„ç¨‹åºï¼Œä½†å…¶è¡Œä¸ºè¿åäº†åè®®æ¡æ¬¾ï¼Œä»Žè€Œé€ æˆæŸå®³ã€‚æ­¤ä»“åº“ä¸­å‘çŽ°ç›´æŽ¥æŠ•æ¯’ä»£ç çš„æ¦‚çŽ‡è¾ƒä½Žï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æ»¥ç”¨é£Žé™©ï¼Œä¼°è®¡æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„Netdata Agentç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 1.44.0-60, < 1.45.3ï¼‰ã€‚
2.  æŸ¥æ‰¾ndsudoå·¥å…·çš„ä½ç½®ã€‚
3.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å‘½ä»¤çš„ç›®å½•ï¼Œä¾‹å¦‚/tmp/evilã€‚
4.  å°†æ¶æ„ç¨‹åºï¼ˆå¦‚åå¼¹shellï¼‰æ”¾ç½®åˆ°/tmp/evilç›®å½•ä¸‹ï¼Œå¹¶å‘½åä¸ºndsudoå°è¯•æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œ`ping`ï¼Œ`date` ç­‰, å…·ä½“å–å†³äºŽ ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼‰ã€‚
5.  ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†/tmp/evilæ·»åŠ åˆ°PATHçš„æœ€å‰é¢ï¼š`export PATH=/tmp/evil:$PATH`ã€‚
6.  è¿è¡Œndsudoï¼Œå®ƒå°†æ‰§è¡Œ/tmp/evilç›®å½•ä¸‹çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**æ¥æº**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡PATHåŠ«æŒæ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata Agentå­˜åœ¨ndsudoï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠå¯æŽ§çš„PATHçŽ¯å¢ƒå˜é‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdataä¸­`ndsudo`å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´žã€‚`ndsudo`æ˜¯ä¸€ä¸ªå…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨`PATH`çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨`PATH`çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆäºŽç³»ç»Ÿç›®å½•çš„ä½ç½®ï¼Œè¯±ä½¿`ndsudo`æ‰§è¡Œè¯¥æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**
1.  æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„`ndsudo`å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶(ä¾‹å¦‚`nvme`)ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œæ”»å‡»è€…å¸Œæœ›æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚æä¾›çš„`payload.c`æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªroot shellã€‚
3.  ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†å½“å‰ç›®å½•(æˆ–åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•)æ·»åŠ åˆ°`PATH`çš„å¼€å¤´ã€‚
4.  è°ƒç”¨`ndsudo`ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ƒå…è®¸æ‰§è¡Œçš„å‘½ä»¤(ä¾‹å¦‚`nvme-list`)ã€‚ç”±äºŽ`PATH`å·²ç»è¢«ä¿®æ”¹ï¼Œ`ndsudo`ä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„`nvme`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»Žè€Œä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºŽæŸ¥æ‰¾`ndsudo`ï¼Œåˆ›å»ºä¸€ä¸ª`nvme` payloadï¼Œä¿®æ”¹`PATH`ï¼Œç„¶åŽæ‰§è¡Œ`ndsudo`ã€‚README.mdæ–‡ä»¶æè¿°äº†å¦‚ä½•ç¼–è¯‘`payload.c`å¹¶ä½¿ç”¨è„šæœ¬ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
æŸ¥çœ‹äº†æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ²¡æœ‰å‘çŽ°ä»»ä½•æŠ•æ¯’ä»£ç ã€‚å…¶ä¸­ï¼ŒCVE-2024-32019.shè„šæœ¬ç”¨äºŽåˆ©ç”¨æ¼æ´žï¼Œpayload.cç”¨äºŽç¼–è¯‘æ¶æ„payloadï¼ŒREADME.mdæ–‡ä»¶æè¿°äº†æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ï¼Œéƒ½æ˜¯æ­£å¸¸çš„åˆ©ç”¨ä»£ç ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**æ¥æº**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata ndsudoå·¥å…·ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªSUID rootçš„ç¨‹åºï¼Œä½†å®ƒä½¿ç”¨äº†PATHçŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡æŒ‡å‘ä¸€ä¸ªè‡ªå·±å¯æŽ§çš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹æ”¾ç½®æ¶æ„ç¨‹åºï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žæ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ£€æŸ¥ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨`/opt`ç›®å½•ä¸‹çš„`ndsudo`ç¨‹åºï¼Œå¹¶ä¸”ç¡®è®¤è¯¥ç¨‹åºæ˜¯å¦ä¸ºrootæ‰€æœ‰ä¸”è®¾ç½®äº†SUIDæƒé™ã€‚åŒæ—¶ï¼Œä½¿ç”¨`strings`å‘½ä»¤æ£€æŸ¥`ndsudo`ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨å¯¹`nvme`ã€`smartctl`ã€`hdparm`æˆ–`sensors`ç­‰å¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¯´æ˜Žè¯¥ç¨‹åºå¯èƒ½å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚
2.  **æ¶æ„ç¨‹åºç¼–è¯‘ï¼š** ç¼–è¯‘ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯è®¾ç½®UIDå’ŒGIDä¸º0ï¼Œç„¶åŽæ‰§è¡Œ`/bin/bash`ï¼Œä»Žè€ŒèŽ·å–root shellã€‚
3.  **æ¶æ„ç¨‹åºä¸Šä¼ ï¼š** é€šè¿‡SFTPå°†ç¼–è¯‘å¥½çš„æ¶æ„ç¨‹åºä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæ”»å‡»è€…å¯æŽ§çš„ç›®å½•ï¼Œä¾‹å¦‚`/tmp`ã€‚
4.  **çŽ¯å¢ƒå˜é‡ä¿®æ”¹ï¼š** ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æ”»å‡»è€…å¯æŽ§çš„ç›®å½•æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ï¼Œç¡®ä¿`ndsudo`ç¨‹åºåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶é¦–å…ˆåœ¨è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ã€‚
5.  **æ¼æ´žè§¦å‘ï¼š** æ‰§è¡Œ`ndsudo`ç¨‹åºï¼Œå½“å®ƒè°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…ä¸Šä¼ çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å–rootæƒé™ã€‚
6.  **äº¤äº’å¼Shellï¼š** æ¼æ´žåˆ©ç”¨ä»£ç æä¾›äº¤äº’å¼shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æ­¤POCä»£ç æœ¬èº«ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œå®žçŽ°æœ¬åœ°ææƒã€‚ä½†æ˜¯ï¼Œè¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ï¼š

*   **ç¼–è¯‘å’Œä¼ è¾“æ¶æ„ä»£ç ï¼š** è„šæœ¬ä¼šè‡ªåŠ¨ç¼–è¯‘Cä»£ç ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚è™½ç„¶Cä»£ç çš„å†…å®¹æ˜¯ææƒï¼Œä½†å¦‚æžœæ¶æ„æ”»å‡»è€…ä¿®æ”¹äº†Cä»£ç ï¼Œå°±å¯èƒ½åŒ…å«å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åŽé—¨ã€æ”¶é›†ä¿¡æ¯ç­‰ã€‚
*   **è¿œç¨‹æ‰§è¡Œä»£ç ï¼š**  è„šæœ¬é€šè¿‡sshæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£Žé™©ï¼Œå¯èƒ½æ‰§è¡Œé¢å¤–çš„æ¶æ„æ“ä½œã€‚
*   **æ®‹ç•™æ–‡ä»¶ï¼š** ç¼–è¯‘åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸Šä¼ çš„æ¶æ„ç¨‹åºå¯èƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç•™ä¸‹ç—•è¿¹ï¼Œå¦‚æžœè¿™äº›æ–‡ä»¶è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å®‰å…¨é—®é¢˜ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é£Žé™©ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œè¯¥POCä»£ç çš„é£Žé™©ä»ç„¶å¯æŽ§ï¼Œä¸»è¦é£Žé™©é›†ä¸­åœ¨ä»£ç çš„ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨ä¸Šã€‚ä¸ºäº†é™ä½Žé£Žé™©ï¼Œå»ºè®®ä»Žå¯ä¿¡çš„æ¥æºèŽ·å–POCä»£ç ï¼Œå¹¶ä»”ç»†æ£€æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿å…¶æ²¡æœ‰æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œåœ¨æµ‹è¯•å®ŒæˆåŽï¼Œåº”åŠæ—¶æ¸…ç†ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ®‹ç•™æ–‡ä»¶ã€‚

æŠ•æ¯’é£Žé™©é¢„ä¼°ä¸º10%ï¼Œå› ä¸ºä»£ç ç›¸å¯¹ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´žéªŒè¯å’Œåˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨è¢«ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**æ¥æº**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°shellè®¿é—®ï¼Œèƒ½å¤Ÿæ‰§è¡Œndsudoå‘½ä»¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2024-32019 æ˜¯ Netdata ä¸­ ndsudo å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudo æ˜¯ä¸€ä¸ª SUID root çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„è„šæœ¬æ”¾ç½®åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆçº§æ›´é«˜çš„ç›®å½•ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ nvmeï¼‰ï¼Œæ¥æ¬ºéª— ndsudo æ‰§è¡Œè¯¥æ¶æ„è„šæœ¬å¹¶èŽ·å¾— root æƒé™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æè¿°äº†ä¸€ç§åˆ©ç”¨æ­¤æ¼æ´žçš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1.  åˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼ˆpoc.pyï¼‰ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
2.  å°†æ­¤è„šæœ¬é‡å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ nvmeï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ ndsudo nvme-listï¼Œè¿™å°†å¯¼è‡´ ndsudo æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“æœ¬èº«æŠ•æ¯’é£Žé™©è¾ƒä½Žã€‚`poc.py` ä»£ç éžå¸¸ç®€å•ï¼Œä»…åŒ…å«ææƒæ‰§è¡Œbashçš„ä»£ç ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„ä»£ç ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¸…æ™°çš„æ¼æ´žåˆ©ç”¨è¯´æ˜Žã€‚ä½†ç”¨æˆ·ä»ç„¶éœ€è¦æ³¨æ„ï¼Œåœ¨å®žé™…çŽ¯å¢ƒä¸­ï¼Œä»Žä¸å¯ä¿¡çš„æ¥æºä¸‹è½½æˆ–å¤åˆ¶æ¼æ´žåˆ©ç”¨ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£Žé™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå†æ‰§è¡Œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žåŽŸç†ï¼š** `ndsudo` ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢å‘½ä»¤çš„è·¯å¾„ä¾èµ–äºŽç”¨æˆ·çš„ `PATH` çŽ¯å¢ƒå˜é‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   åˆ›å»ºæ¶æ„è„šæœ¬ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
    *   å°†æ­¤è„šæœ¬é‡å‘½åä¸º `ndsudo` å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆé€šè¿‡ `ndsudo --help` æŸ¥çœ‹ï¼‰ã€‚
    *   å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œç¡®ä¿æ¶æ„è„šæœ¬ä¼˜å…ˆè¢«æœç´¢åˆ°ã€‚
    *   è¿è¡Œ `ndsudo <allowed_command>`ï¼Œè¿™å°†å¯¼è‡´ `ndsudo` æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´žåˆ©ç”¨è¾ƒä¸ºç®€å•ï¼ŒPOC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä½†åº”æ³¨æ„æ¥æºä¸æ˜Žçš„exploitä»£ç çš„æ½œåœ¨æŠ•æ¯’é£Žé™©ã€‚è¯¥æ¼æ´žå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡æ“çºµ `PATH` çŽ¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨ SUID ç¨‹åº `ndsudo` æå‡è‡³ root æƒé™ã€‚åŠ¡å¿…åŠæ—¶å‡çº§ Netdata ç‰ˆæœ¬ä»¥ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**æ¥æº**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœ¬åœ°ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata agentè¿è¡Œåœ¨å—å½±å“ç‰ˆæœ¬ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰§è¡Œæœ¬åœ°ä»£ç ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·æ‹¥æœ‰ SUID æƒé™ï¼Œå…è®¸æ‰§è¡ŒæŸäº›ç‰¹æƒå‘½ä»¤ã€‚æ¼æ´žçš„æ ¹æºåœ¨äºŽ `ndsudo` ä½¿ç”¨ä¸å®‰å…¨çš„ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ PATH ä¸­æ’å…¥æ¶æ„ç¨‹åºï¼Œè®© `ndsudo` æ‰§è¡Œæ”»å‡»è€…æŽ§åˆ¶çš„ä»£ç ï¼Œä»Žè€Œæå‡æƒé™åˆ° rootã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾ `ndsudo` è·¯å¾„ï¼š** é€šå¸¸ä½äºŽ `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`ï¼Œä½†éœ€è¦é€šè¿‡ `find` å‘½ä»¤ç¡®è®¤ã€‚
2.  **åˆ›å»ºæ¶æ„ç¨‹åºï¼š** åˆ›å»ºä¸€ä¸ª C ç¨‹åºï¼Œè¯¥ç¨‹åºè°ƒç”¨ `setuid(0)` å’Œ `setgid(0)` è®¾ç½®ç”¨æˆ·å’Œç»„ ID ä¸º rootï¼Œç„¶åŽæ‰§è¡Œä¸€ä¸ª shell (ä¾‹å¦‚ `/bin/bash -p`)ã€‚éœ€è¦ä½¿ç”¨ `gcc` ç¼–è¯‘è¯¥ç¨‹åºï¼Œä¾‹å¦‚å‘½åä¸º `arcconf`ã€‚
3.  **ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼š** å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ¶æ„ç¨‹åºä½äºŽ `/tmp` ç›®å½•ä¸‹ï¼Œåˆ™æ‰§è¡Œ `PATH=/tmp:$PATH`ã€‚
4.  **æ‰§è¡Œ `ndsudo` å‘½ä»¤ï¼š** ä½¿ç”¨ `ndsudo` æ‰§è¡Œå®ƒæ”¯æŒçš„å‘½ä»¤ï¼Œä½†è¯¥å‘½ä»¤ä¾èµ–äºŽæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`ã€‚`ndsudo` ä¼šå°è¯•æ‰§è¡Œ `arcconf`ï¼Œä½†ç”±äºŽ PATH çŽ¯å¢ƒå˜é‡è¢«ä¿®æ”¹ï¼Œå®ƒä¼šæ‰§è¡Œæ”»å‡»è€…åœ¨ `/tmp` ç›®å½•ä¸‹åˆ›å»ºçš„æ¶æ„ç¨‹åºã€‚
5.  **èŽ·å¾— root shellï¼š** å¦‚æžœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…å°†èŽ·å¾—ä¸€ä¸ª root shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æä¾›çš„ POC ä»£ç ä¸­ï¼Œ`arcconf.c` çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªææƒçš„ shellï¼Œæ²¡æœ‰æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ ä½†ä»Ž github ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ `arcconf` æ—¶ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½åœ¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä»Ž github ä¸Šä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ½œåœ¨é£Žé™©ï¼Œæ•…æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**æ¥æº**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo æœ¬åœ°æƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·æå‡è‡³ root æƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 å’Œ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Netdataï¼Œä¸” ndsudo å·¥å…·è®¾ç½®äº† SUID root æƒé™ï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ ndsudoã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å®ƒä½¿ç”¨ `PATH` çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ `PATH` çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘æ¶æ„ç›®å½•çš„è·¯å¾„ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªä¸Ž `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤åŒåçš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œä»¥ root æƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§:**

æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´žã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåå¼¹ shellï¼‰çš„ç›®å½•ã€‚
2.  å°†æ¶æ„ç¨‹åºå‘½åä¸º `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œ`nvme-list`ï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ `ndsudo` å‘½ä»¤ã€‚`ndsudo` å°†æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€Œä½¿æ”»å‡»è€…èŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©:**

æ ¹æ®æä¾›çš„ä»£ç åˆ†æžï¼Œè¯¥ä»“åº“ä¼¼ä¹Žä¸»è¦æä¾›äº†ä¸€ä¸ª checker è„šæœ¬æ¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œç®¡ç†å‘˜è¯†åˆ«å’ŒéªŒè¯æ¼æ´žæ˜¯å¦å­˜åœ¨ï¼Œæ—¨åœ¨å¸®åŠ©é˜²å¾¡è€…è¯„ä¼°é£Žé™©å’ŒéªŒè¯è¡¥ä¸ï¼Œè€Œä¸æ˜¯æä¾›æ­¦å™¨åŒ–çš„ PoCã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žã€‚

æ£€æŸ¥å™¨ä»£ç ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (æˆ–å®‰è£…ä½ç½®) çš„ SUID/æ‰€æœ‰æƒã€‚
*   `PATH` ä¸­æ—©äºŽå¸¸è§ç³»ç»Ÿè·¯å¾„çš„å¯å†™ç›®å½•ã€‚
*   `ndsudo` å°è¯•æ‰§è¡Œçš„ç™½åå•å­å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚
*   å¯é€‰åœ°è¿è¡Œ `ndsudo --test <subcommand>` æ¥æ‰“å°å·²è§£æžçš„å‘½ä»¤è€Œä¸æ‰§è¡Œå®ƒ (è°¨æ…Žä½¿ç”¨ï¼Œå…ˆé˜…è¯»ä»£ç )ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º 0%**ã€‚


**é¡¹ç›®åœ°å€:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**æ¥æº**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´žèŽ·å–rootæƒé™ã€‚

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”æ”»å‡»è€…éœ€è¦å…·æœ‰æœ¬åœ°ä½Žæƒé™è´¦å·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ netdata çš„ ndsudo å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢è·¯å¾„ç”± PATH çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨ ndsudo æœç´¢è·¯å¾„ä¸­ï¼Œå½“ ndsudo è°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª C ç¨‹åºï¼Œç¼–è¯‘åŽå¯ä»¥ç›´æŽ¥æ‰§è¡Œä¸€ä¸ªå…·æœ‰ root æƒé™çš„ bash shellã€‚æ”»å‡»è€…éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«æ­¤æ¶æ„ç¨‹åºçš„å¯å†™ç›®å½•ï¼Œç„¶åŽä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ­¤ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚ä¹‹åŽï¼Œå½“ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

ä»£ç ä¸­æ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚å®ƒåªæ˜¯ç®€å•åœ°è®¾ç½® uid å’Œ gid ä¸º 0ï¼Œç„¶åŽæ‰§è¡Œ /bin/bashã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º0%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1.  åˆ©ç”¨éœ€è¦å…ˆèŽ·å¾—ä¸€ä¸ªnetdataè½¯ä»¶çš„ä½Žæƒé™è´¦å·ã€‚
2.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ POC ä¸­çš„ C ç¨‹åºç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„å¯å†™ç›®å½•ã€‚
3.  ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†è¯¥ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚
4.  è§¦å‘ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤ï¼Œè¿™å°†å¯¼è‡´æ¶æ„ç¨‹åºä»¥ root æƒé™æ‰§è¡Œï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

**é¡¹ç›®åœ°å€:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**æ¥æº**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯æå‡è‡³rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 åŠ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”å…·æœ‰æœ¬åœ°shellè®¿é—®æƒé™ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 å­˜åœ¨äºŽNetdataçš„`ndsudo`å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·æ˜¯å…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¼æ´žåŽŸå› æ˜¯`ndsudo`çš„æœç´¢è·¯å¾„ç”±`PATH`çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨å‰é¢ï¼Œå½“`ndsudo`æ‰§è¡Œä¿¡ä»»çš„å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œå®žçŽ°æœ¬åœ°ææƒã€‚æä¾›çš„POCä»£ç é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´žï¼š

1.  **ç¼–è¯‘æ¶æ„payload:**  `poc.c` ç¼–è¯‘æˆ `nvme`ï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯æ‰§è¡Œ `/bin/bash`ï¼Œå¹¶è®¾ç½® UID å’Œ GID ä¸º 0ï¼Œå³rootæƒé™ã€‚
2.  **ä¼ è¾“payloadåˆ°ç›®æ ‡ç³»ç»Ÿ:**  å°†ç¼–è¯‘å¥½çš„`nvme`ä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„`/tmp`ç›®å½•ã€‚
3.  **å‡†å¤‡payloadæ‰§è¡Œ:**  ç»™`/tmp/nvme`æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽå°†`/tmp`æ·»åŠ åˆ°`PATH`çŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ã€‚
4.  **è§¦å‘`ndsudo`æ‰§è¡Œpayload:** è¿è¡Œ`./ndsudo nvme-list`ï¼Œ`ndsudo`ä¼šæ‰§è¡Œ`/tmp/nvme`ï¼Œç”±äºŽè¯¥ç¨‹åºä¼šå°†æƒé™æå‡ä¸ºrootï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥èŽ·å¾—root shellã€‚

**æœ‰æ•ˆæ€§ï¼š** è¯¥POCä»£ç æè¿°çš„åˆ©ç”¨æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„`poc.c`ä»£ç åŠŸèƒ½æ¸…æ™°ï¼Œä»…ä¸ºæ‰§è¡Œ`/bin/bash`å¹¶æå‡æƒé™ï¼Œä¸å­˜åœ¨éšè—çš„æŠ•æ¯’ä»£ç ã€‚READMEæ–‡ä»¶æè¿°äº†å®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`PATH`çŽ¯å¢ƒå˜é‡ï¼Œæ¬ºéª—`ndsudo`æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**æ¥æº**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦netdata agentå­˜åœ¨æ¼æ´žç‰ˆæœ¬ä¸”ndsudoè¢«è°ƒç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata Agentä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªrootç”¨æˆ·æ‹¥æœ‰çš„ã€è®¾ç½®äº†SUIDä½çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒæœ¬åº”åªè¿è¡Œä¸€ç»„å—é™çš„å¤–éƒ¨å‘½ä»¤ï¼Œä½†æ˜¯å…¶æœç´¢è·¯å¾„ç”±PATHçŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æŒ‡å®šndsudoæŸ¥æ‰¾è¿™äº›å‘½ä»¤çš„ä½ç½®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯æ”»å‡»è€…å…·æœ‰å†™æƒé™çš„ç›®å½•ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ”¾ç½®æ¶æ„ç¨‹åºå¹¶ä»¥rootæƒé™æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´žæè¿°å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žå­˜åœ¨åˆ©ç”¨ä»·å€¼ï¼Œé€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æ‰§è¡Œæ¶æ„ç¨‹åºè¾¾åˆ°ææƒæ•ˆæžœã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„ä»£ç ä»…ä¸ºGNU GENERAL PUBLIC LICENSEï¼Œæ˜¯å¼€æºåè®®è®¸å¯ï¼Œä¸åŒ…å«ç›´æŽ¥çš„æ”»å‡»payloadæˆ–æ¶æ„ä»£ç ã€‚ä½†licenseæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ä»£ç ï¼Œå¦‚æžœç»“åˆç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œåè®®å†…å®¹ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åˆ›å»ºä¸€ä¸ªåˆæ³•çš„ç¨‹åºï¼Œä½†å…¶è¡Œä¸ºè¿åäº†åè®®æ¡æ¬¾ï¼Œä»Žè€Œé€ æˆæŸå®³ã€‚æ­¤ä»“åº“ä¸­å‘çŽ°ç›´æŽ¥æŠ•æ¯’ä»£ç çš„æ¦‚çŽ‡è¾ƒä½Žï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æ»¥ç”¨é£Žé™©ï¼Œä¼°è®¡æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„Netdata Agentç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 1.44.0-60, < 1.45.3ï¼‰ã€‚
2.  æŸ¥æ‰¾ndsudoå·¥å…·çš„ä½ç½®ã€‚
3.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å‘½ä»¤çš„ç›®å½•ï¼Œä¾‹å¦‚/tmp/evilã€‚
4.  å°†æ¶æ„ç¨‹åºï¼ˆå¦‚åå¼¹shellï¼‰æ”¾ç½®åˆ°/tmp/evilç›®å½•ä¸‹ï¼Œå¹¶å‘½åä¸ºndsudoå°è¯•æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œ`ping`ï¼Œ`date` ç­‰, å…·ä½“å–å†³äºŽ ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼‰ã€‚
5.  ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†/tmp/evilæ·»åŠ åˆ°PATHçš„æœ€å‰é¢ï¼š`export PATH=/tmp/evil:$PATH`ã€‚
6.  è¿è¡Œndsudoï¼Œå®ƒå°†æ‰§è¡Œ/tmp/evilç›®å½•ä¸‹çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**æ¥æº**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡PATHåŠ«æŒæ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata Agentå­˜åœ¨ndsudoï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠå¯æŽ§çš„PATHçŽ¯å¢ƒå˜é‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdataä¸­`ndsudo`å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´žã€‚`ndsudo`æ˜¯ä¸€ä¸ªå…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨`PATH`çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨`PATH`çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆäºŽç³»ç»Ÿç›®å½•çš„ä½ç½®ï¼Œè¯±ä½¿`ndsudo`æ‰§è¡Œè¯¥æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**
1.  æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„`ndsudo`å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶(ä¾‹å¦‚`nvme`)ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œæ”»å‡»è€…å¸Œæœ›æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚æä¾›çš„`payload.c`æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªroot shellã€‚
3.  ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†å½“å‰ç›®å½•(æˆ–åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•)æ·»åŠ åˆ°`PATH`çš„å¼€å¤´ã€‚
4.  è°ƒç”¨`ndsudo`ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ƒå…è®¸æ‰§è¡Œçš„å‘½ä»¤(ä¾‹å¦‚`nvme-list`)ã€‚ç”±äºŽ`PATH`å·²ç»è¢«ä¿®æ”¹ï¼Œ`ndsudo`ä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„`nvme`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»Žè€Œä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºŽæŸ¥æ‰¾`ndsudo`ï¼Œåˆ›å»ºä¸€ä¸ª`nvme` payloadï¼Œä¿®æ”¹`PATH`ï¼Œç„¶åŽæ‰§è¡Œ`ndsudo`ã€‚README.mdæ–‡ä»¶æè¿°äº†å¦‚ä½•ç¼–è¯‘`payload.c`å¹¶ä½¿ç”¨è„šæœ¬ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
æŸ¥çœ‹äº†æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ²¡æœ‰å‘çŽ°ä»»ä½•æŠ•æ¯’ä»£ç ã€‚å…¶ä¸­ï¼ŒCVE-2024-32019.shè„šæœ¬ç”¨äºŽåˆ©ç”¨æ¼æ´žï¼Œpayload.cç”¨äºŽç¼–è¯‘æ¶æ„payloadï¼ŒREADME.mdæ–‡ä»¶æè¿°äº†æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ï¼Œéƒ½æ˜¯æ­£å¸¸çš„åˆ©ç”¨ä»£ç ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**æ¥æº**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata ndsudoå·¥å…·ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªSUID rootçš„ç¨‹åºï¼Œä½†å®ƒä½¿ç”¨äº†PATHçŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡æŒ‡å‘ä¸€ä¸ªè‡ªå·±å¯æŽ§çš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹æ”¾ç½®æ¶æ„ç¨‹åºï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žæ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ£€æŸ¥ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨`/opt`ç›®å½•ä¸‹çš„`ndsudo`ç¨‹åºï¼Œå¹¶ä¸”ç¡®è®¤è¯¥ç¨‹åºæ˜¯å¦ä¸ºrootæ‰€æœ‰ä¸”è®¾ç½®äº†SUIDæƒé™ã€‚åŒæ—¶ï¼Œä½¿ç”¨`strings`å‘½ä»¤æ£€æŸ¥`ndsudo`ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨å¯¹`nvme`ã€`smartctl`ã€`hdparm`æˆ–`sensors`ç­‰å¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¯´æ˜Žè¯¥ç¨‹åºå¯èƒ½å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚
2.  **æ¶æ„ç¨‹åºç¼–è¯‘ï¼š** ç¼–è¯‘ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯è®¾ç½®UIDå’ŒGIDä¸º0ï¼Œç„¶åŽæ‰§è¡Œ`/bin/bash`ï¼Œä»Žè€ŒèŽ·å–root shellã€‚
3.  **æ¶æ„ç¨‹åºä¸Šä¼ ï¼š** é€šè¿‡SFTPå°†ç¼–è¯‘å¥½çš„æ¶æ„ç¨‹åºä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæ”»å‡»è€…å¯æŽ§çš„ç›®å½•ï¼Œä¾‹å¦‚`/tmp`ã€‚
4.  **çŽ¯å¢ƒå˜é‡ä¿®æ”¹ï¼š** ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æ”»å‡»è€…å¯æŽ§çš„ç›®å½•æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ï¼Œç¡®ä¿`ndsudo`ç¨‹åºåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶é¦–å…ˆåœ¨è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ã€‚
5.  **æ¼æ´žè§¦å‘ï¼š** æ‰§è¡Œ`ndsudo`ç¨‹åºï¼Œå½“å®ƒè°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…ä¸Šä¼ çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å–rootæƒé™ã€‚
6.  **äº¤äº’å¼Shellï¼š** æ¼æ´žåˆ©ç”¨ä»£ç æä¾›äº¤äº’å¼shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æ­¤POCä»£ç æœ¬èº«ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œå®žçŽ°æœ¬åœ°ææƒã€‚ä½†æ˜¯ï¼Œè¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ï¼š

*   **ç¼–è¯‘å’Œä¼ è¾“æ¶æ„ä»£ç ï¼š** è„šæœ¬ä¼šè‡ªåŠ¨ç¼–è¯‘Cä»£ç ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚è™½ç„¶Cä»£ç çš„å†…å®¹æ˜¯ææƒï¼Œä½†å¦‚æžœæ¶æ„æ”»å‡»è€…ä¿®æ”¹äº†Cä»£ç ï¼Œå°±å¯èƒ½åŒ…å«å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åŽé—¨ã€æ”¶é›†ä¿¡æ¯ç­‰ã€‚
*   **è¿œç¨‹æ‰§è¡Œä»£ç ï¼š**  è„šæœ¬é€šè¿‡sshæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£Žé™©ï¼Œå¯èƒ½æ‰§è¡Œé¢å¤–çš„æ¶æ„æ“ä½œã€‚
*   **æ®‹ç•™æ–‡ä»¶ï¼š** ç¼–è¯‘åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸Šä¼ çš„æ¶æ„ç¨‹åºå¯èƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç•™ä¸‹ç—•è¿¹ï¼Œå¦‚æžœè¿™äº›æ–‡ä»¶è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å®‰å…¨é—®é¢˜ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é£Žé™©ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œè¯¥POCä»£ç çš„é£Žé™©ä»ç„¶å¯æŽ§ï¼Œä¸»è¦é£Žé™©é›†ä¸­åœ¨ä»£ç çš„ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨ä¸Šã€‚ä¸ºäº†é™ä½Žé£Žé™©ï¼Œå»ºè®®ä»Žå¯ä¿¡çš„æ¥æºèŽ·å–POCä»£ç ï¼Œå¹¶ä»”ç»†æ£€æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿å…¶æ²¡æœ‰æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œåœ¨æµ‹è¯•å®ŒæˆåŽï¼Œåº”åŠæ—¶æ¸…ç†ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ®‹ç•™æ–‡ä»¶ã€‚

æŠ•æ¯’é£Žé™©é¢„ä¼°ä¸º10%ï¼Œå› ä¸ºä»£ç ç›¸å¯¹ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´žéªŒè¯å’Œåˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨è¢«ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**æ¥æº**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°shellè®¿é—®ï¼Œèƒ½å¤Ÿæ‰§è¡Œndsudoå‘½ä»¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2024-32019 æ˜¯ Netdata ä¸­ ndsudo å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudo æ˜¯ä¸€ä¸ª SUID root çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„è„šæœ¬æ”¾ç½®åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆçº§æ›´é«˜çš„ç›®å½•ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ nvmeï¼‰ï¼Œæ¥æ¬ºéª— ndsudo æ‰§è¡Œè¯¥æ¶æ„è„šæœ¬å¹¶èŽ·å¾— root æƒé™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æè¿°äº†ä¸€ç§åˆ©ç”¨æ­¤æ¼æ´žçš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1.  åˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼ˆpoc.pyï¼‰ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
2.  å°†æ­¤è„šæœ¬é‡å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ nvmeï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ ndsudo nvme-listï¼Œè¿™å°†å¯¼è‡´ ndsudo æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“æœ¬èº«æŠ•æ¯’é£Žé™©è¾ƒä½Žã€‚`poc.py` ä»£ç éžå¸¸ç®€å•ï¼Œä»…åŒ…å«ææƒæ‰§è¡Œbashçš„ä»£ç ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„ä»£ç ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¸…æ™°çš„æ¼æ´žåˆ©ç”¨è¯´æ˜Žã€‚ä½†ç”¨æˆ·ä»ç„¶éœ€è¦æ³¨æ„ï¼Œåœ¨å®žé™…çŽ¯å¢ƒä¸­ï¼Œä»Žä¸å¯ä¿¡çš„æ¥æºä¸‹è½½æˆ–å¤åˆ¶æ¼æ´žåˆ©ç”¨ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£Žé™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå†æ‰§è¡Œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žåŽŸç†ï¼š** `ndsudo` ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢å‘½ä»¤çš„è·¯å¾„ä¾èµ–äºŽç”¨æˆ·çš„ `PATH` çŽ¯å¢ƒå˜é‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   åˆ›å»ºæ¶æ„è„šæœ¬ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
    *   å°†æ­¤è„šæœ¬é‡å‘½åä¸º `ndsudo` å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆé€šè¿‡ `ndsudo --help` æŸ¥çœ‹ï¼‰ã€‚
    *   å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œç¡®ä¿æ¶æ„è„šæœ¬ä¼˜å…ˆè¢«æœç´¢åˆ°ã€‚
    *   è¿è¡Œ `ndsudo <allowed_command>`ï¼Œè¿™å°†å¯¼è‡´ `ndsudo` æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´žåˆ©ç”¨è¾ƒä¸ºç®€å•ï¼ŒPOC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä½†åº”æ³¨æ„æ¥æºä¸æ˜Žçš„exploitä»£ç çš„æ½œåœ¨æŠ•æ¯’é£Žé™©ã€‚è¯¥æ¼æ´žå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡æ“çºµ `PATH` çŽ¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨ SUID ç¨‹åº `ndsudo` æå‡è‡³ root æƒé™ã€‚åŠ¡å¿…åŠæ—¶å‡çº§ Netdata ç‰ˆæœ¬ä»¥ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**æ¥æº**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœ¬åœ°ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata agentè¿è¡Œåœ¨å—å½±å“ç‰ˆæœ¬ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰§è¡Œæœ¬åœ°ä»£ç ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·æ‹¥æœ‰ SUID æƒé™ï¼Œå…è®¸æ‰§è¡ŒæŸäº›ç‰¹æƒå‘½ä»¤ã€‚æ¼æ´žçš„æ ¹æºåœ¨äºŽ `ndsudo` ä½¿ç”¨ä¸å®‰å…¨çš„ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ PATH ä¸­æ’å…¥æ¶æ„ç¨‹åºï¼Œè®© `ndsudo` æ‰§è¡Œæ”»å‡»è€…æŽ§åˆ¶çš„ä»£ç ï¼Œä»Žè€Œæå‡æƒé™åˆ° rootã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾ `ndsudo` è·¯å¾„ï¼š** é€šå¸¸ä½äºŽ `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`ï¼Œä½†éœ€è¦é€šè¿‡ `find` å‘½ä»¤ç¡®è®¤ã€‚
2.  **åˆ›å»ºæ¶æ„ç¨‹åºï¼š** åˆ›å»ºä¸€ä¸ª C ç¨‹åºï¼Œè¯¥ç¨‹åºè°ƒç”¨ `setuid(0)` å’Œ `setgid(0)` è®¾ç½®ç”¨æˆ·å’Œç»„ ID ä¸º rootï¼Œç„¶åŽæ‰§è¡Œä¸€ä¸ª shell (ä¾‹å¦‚ `/bin/bash -p`)ã€‚éœ€è¦ä½¿ç”¨ `gcc` ç¼–è¯‘è¯¥ç¨‹åºï¼Œä¾‹å¦‚å‘½åä¸º `arcconf`ã€‚
3.  **ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼š** å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ¶æ„ç¨‹åºä½äºŽ `/tmp` ç›®å½•ä¸‹ï¼Œåˆ™æ‰§è¡Œ `PATH=/tmp:$PATH`ã€‚
4.  **æ‰§è¡Œ `ndsudo` å‘½ä»¤ï¼š** ä½¿ç”¨ `ndsudo` æ‰§è¡Œå®ƒæ”¯æŒçš„å‘½ä»¤ï¼Œä½†è¯¥å‘½ä»¤ä¾èµ–äºŽæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`ã€‚`ndsudo` ä¼šå°è¯•æ‰§è¡Œ `arcconf`ï¼Œä½†ç”±äºŽ PATH çŽ¯å¢ƒå˜é‡è¢«ä¿®æ”¹ï¼Œå®ƒä¼šæ‰§è¡Œæ”»å‡»è€…åœ¨ `/tmp` ç›®å½•ä¸‹åˆ›å»ºçš„æ¶æ„ç¨‹åºã€‚
5.  **èŽ·å¾— root shellï¼š** å¦‚æžœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…å°†èŽ·å¾—ä¸€ä¸ª root shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æä¾›çš„ POC ä»£ç ä¸­ï¼Œ`arcconf.c` çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªææƒçš„ shellï¼Œæ²¡æœ‰æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ ä½†ä»Ž github ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ `arcconf` æ—¶ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½åœ¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä»Ž github ä¸Šä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ½œåœ¨é£Žé™©ï¼Œæ•…æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**æ¥æº**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo æœ¬åœ°æƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·æå‡è‡³ root æƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 å’Œ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Netdataï¼Œä¸” ndsudo å·¥å…·è®¾ç½®äº† SUID root æƒé™ï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ ndsudoã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å®ƒä½¿ç”¨ `PATH` çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ `PATH` çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘æ¶æ„ç›®å½•çš„è·¯å¾„ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªä¸Ž `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤åŒåçš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œä»¥ root æƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§:**

æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´žã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåå¼¹ shellï¼‰çš„ç›®å½•ã€‚
2.  å°†æ¶æ„ç¨‹åºå‘½åä¸º `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œ`nvme-list`ï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ `ndsudo` å‘½ä»¤ã€‚`ndsudo` å°†æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€Œä½¿æ”»å‡»è€…èŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©:**

æ ¹æ®æä¾›çš„ä»£ç åˆ†æžï¼Œè¯¥ä»“åº“ä¼¼ä¹Žä¸»è¦æä¾›äº†ä¸€ä¸ª checker è„šæœ¬æ¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œç®¡ç†å‘˜è¯†åˆ«å’ŒéªŒè¯æ¼æ´žæ˜¯å¦å­˜åœ¨ï¼Œæ—¨åœ¨å¸®åŠ©é˜²å¾¡è€…è¯„ä¼°é£Žé™©å’ŒéªŒè¯è¡¥ä¸ï¼Œè€Œä¸æ˜¯æä¾›æ­¦å™¨åŒ–çš„ PoCã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žã€‚

æ£€æŸ¥å™¨ä»£ç ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (æˆ–å®‰è£…ä½ç½®) çš„ SUID/æ‰€æœ‰æƒã€‚
*   `PATH` ä¸­æ—©äºŽå¸¸è§ç³»ç»Ÿè·¯å¾„çš„å¯å†™ç›®å½•ã€‚
*   `ndsudo` å°è¯•æ‰§è¡Œçš„ç™½åå•å­å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚
*   å¯é€‰åœ°è¿è¡Œ `ndsudo --test <subcommand>` æ¥æ‰“å°å·²è§£æžçš„å‘½ä»¤è€Œä¸æ‰§è¡Œå®ƒ (è°¨æ…Žä½¿ç”¨ï¼Œå…ˆé˜…è¯»ä»£ç )ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º 0%**ã€‚


**é¡¹ç›®åœ°å€:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**æ¥æº**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´žèŽ·å–rootæƒé™ã€‚

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”æ”»å‡»è€…éœ€è¦å…·æœ‰æœ¬åœ°ä½Žæƒé™è´¦å·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ netdata çš„ ndsudo å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢è·¯å¾„ç”± PATH çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨ ndsudo æœç´¢è·¯å¾„ä¸­ï¼Œå½“ ndsudo è°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª C ç¨‹åºï¼Œç¼–è¯‘åŽå¯ä»¥ç›´æŽ¥æ‰§è¡Œä¸€ä¸ªå…·æœ‰ root æƒé™çš„ bash shellã€‚æ”»å‡»è€…éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«æ­¤æ¶æ„ç¨‹åºçš„å¯å†™ç›®å½•ï¼Œç„¶åŽä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ­¤ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚ä¹‹åŽï¼Œå½“ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

ä»£ç ä¸­æ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚å®ƒåªæ˜¯ç®€å•åœ°è®¾ç½® uid å’Œ gid ä¸º 0ï¼Œç„¶åŽæ‰§è¡Œ /bin/bashã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º0%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1.  åˆ©ç”¨éœ€è¦å…ˆèŽ·å¾—ä¸€ä¸ªnetdataè½¯ä»¶çš„ä½Žæƒé™è´¦å·ã€‚
2.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ POC ä¸­çš„ C ç¨‹åºç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„å¯å†™ç›®å½•ã€‚
3.  ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†è¯¥ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚
4.  è§¦å‘ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤ï¼Œè¿™å°†å¯¼è‡´æ¶æ„ç¨‹åºä»¥ root æƒé™æ‰§è¡Œï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

**é¡¹ç›®åœ°å€:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**æ¥æº**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯æå‡è‡³rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 åŠ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”å…·æœ‰æœ¬åœ°shellè®¿é—®æƒé™ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 å­˜åœ¨äºŽNetdataçš„`ndsudo`å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·æ˜¯å…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¼æ´žåŽŸå› æ˜¯`ndsudo`çš„æœç´¢è·¯å¾„ç”±`PATH`çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨å‰é¢ï¼Œå½“`ndsudo`æ‰§è¡Œä¿¡ä»»çš„å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œå®žçŽ°æœ¬åœ°ææƒã€‚æä¾›çš„POCä»£ç é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´žï¼š

1.  **ç¼–è¯‘æ¶æ„payload:**  `poc.c` ç¼–è¯‘æˆ `nvme`ï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯æ‰§è¡Œ `/bin/bash`ï¼Œå¹¶è®¾ç½® UID å’Œ GID ä¸º 0ï¼Œå³rootæƒé™ã€‚
2.  **ä¼ è¾“payloadåˆ°ç›®æ ‡ç³»ç»Ÿ:**  å°†ç¼–è¯‘å¥½çš„`nvme`ä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„`/tmp`ç›®å½•ã€‚
3.  **å‡†å¤‡payloadæ‰§è¡Œ:**  ç»™`/tmp/nvme`æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽå°†`/tmp`æ·»åŠ åˆ°`PATH`çŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ã€‚
4.  **è§¦å‘`ndsudo`æ‰§è¡Œpayload:** è¿è¡Œ`./ndsudo nvme-list`ï¼Œ`ndsudo`ä¼šæ‰§è¡Œ`/tmp/nvme`ï¼Œç”±äºŽè¯¥ç¨‹åºä¼šå°†æƒé™æå‡ä¸ºrootï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥èŽ·å¾—root shellã€‚

**æœ‰æ•ˆæ€§ï¼š** è¯¥POCä»£ç æè¿°çš„åˆ©ç”¨æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„`poc.c`ä»£ç åŠŸèƒ½æ¸…æ™°ï¼Œä»…ä¸ºæ‰§è¡Œ`/bin/bash`å¹¶æå‡æƒé™ï¼Œä¸å­˜åœ¨éšè—çš„æŠ•æ¯’ä»£ç ã€‚READMEæ–‡ä»¶æè¿°äº†å®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`PATH`çŽ¯å¢ƒå˜é‡ï¼Œæ¬ºéª—`ndsudo`æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**æ¥æº**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦netdata agentå­˜åœ¨æ¼æ´žç‰ˆæœ¬ä¸”ndsudoè¢«è°ƒç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata Agentä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªrootç”¨æˆ·æ‹¥æœ‰çš„ã€è®¾ç½®äº†SUIDä½çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒæœ¬åº”åªè¿è¡Œä¸€ç»„å—é™çš„å¤–éƒ¨å‘½ä»¤ï¼Œä½†æ˜¯å…¶æœç´¢è·¯å¾„ç”±PATHçŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æŒ‡å®šndsudoæŸ¥æ‰¾è¿™äº›å‘½ä»¤çš„ä½ç½®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯æ”»å‡»è€…å…·æœ‰å†™æƒé™çš„ç›®å½•ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ”¾ç½®æ¶æ„ç¨‹åºå¹¶ä»¥rootæƒé™æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´žæè¿°å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žå­˜åœ¨åˆ©ç”¨ä»·å€¼ï¼Œé€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æ‰§è¡Œæ¶æ„ç¨‹åºè¾¾åˆ°ææƒæ•ˆæžœã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„ä»£ç ä»…ä¸ºGNU GENERAL PUBLIC LICENSEï¼Œæ˜¯å¼€æºåè®®è®¸å¯ï¼Œä¸åŒ…å«ç›´æŽ¥çš„æ”»å‡»payloadæˆ–æ¶æ„ä»£ç ã€‚ä½†licenseæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ä»£ç ï¼Œå¦‚æžœç»“åˆç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œåè®®å†…å®¹ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åˆ›å»ºä¸€ä¸ªåˆæ³•çš„ç¨‹åºï¼Œä½†å…¶è¡Œä¸ºè¿åäº†åè®®æ¡æ¬¾ï¼Œä»Žè€Œé€ æˆæŸå®³ã€‚æ­¤ä»“åº“ä¸­å‘çŽ°ç›´æŽ¥æŠ•æ¯’ä»£ç çš„æ¦‚çŽ‡è¾ƒä½Žï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æ»¥ç”¨é£Žé™©ï¼Œä¼°è®¡æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„Netdata Agentç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 1.44.0-60, < 1.45.3ï¼‰ã€‚
2.  æŸ¥æ‰¾ndsudoå·¥å…·çš„ä½ç½®ã€‚
3.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å‘½ä»¤çš„ç›®å½•ï¼Œä¾‹å¦‚/tmp/evilã€‚
4.  å°†æ¶æ„ç¨‹åºï¼ˆå¦‚åå¼¹shellï¼‰æ”¾ç½®åˆ°/tmp/evilç›®å½•ä¸‹ï¼Œå¹¶å‘½åä¸ºndsudoå°è¯•æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œ`ping`ï¼Œ`date` ç­‰, å…·ä½“å–å†³äºŽ ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼‰ã€‚
5.  ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†/tmp/evilæ·»åŠ åˆ°PATHçš„æœ€å‰é¢ï¼š`export PATH=/tmp/evil:$PATH`ã€‚
6.  è¿è¡Œndsudoï¼Œå®ƒå°†æ‰§è¡Œ/tmp/evilç›®å½•ä¸‹çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**æ¥æº**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡PATHåŠ«æŒæ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata Agentå­˜åœ¨ndsudoï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠå¯æŽ§çš„PATHçŽ¯å¢ƒå˜é‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdataä¸­`ndsudo`å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´žã€‚`ndsudo`æ˜¯ä¸€ä¸ªå…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨`PATH`çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨`PATH`çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆäºŽç³»ç»Ÿç›®å½•çš„ä½ç½®ï¼Œè¯±ä½¿`ndsudo`æ‰§è¡Œè¯¥æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**
1.  æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„`ndsudo`å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶(ä¾‹å¦‚`nvme`)ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œæ”»å‡»è€…å¸Œæœ›æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚æä¾›çš„`payload.c`æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªroot shellã€‚
3.  ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†å½“å‰ç›®å½•(æˆ–åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•)æ·»åŠ åˆ°`PATH`çš„å¼€å¤´ã€‚
4.  è°ƒç”¨`ndsudo`ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ƒå…è®¸æ‰§è¡Œçš„å‘½ä»¤(ä¾‹å¦‚`nvme-list`)ã€‚ç”±äºŽ`PATH`å·²ç»è¢«ä¿®æ”¹ï¼Œ`ndsudo`ä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„`nvme`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»Žè€Œä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºŽæŸ¥æ‰¾`ndsudo`ï¼Œåˆ›å»ºä¸€ä¸ª`nvme` payloadï¼Œä¿®æ”¹`PATH`ï¼Œç„¶åŽæ‰§è¡Œ`ndsudo`ã€‚README.mdæ–‡ä»¶æè¿°äº†å¦‚ä½•ç¼–è¯‘`payload.c`å¹¶ä½¿ç”¨è„šæœ¬ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
æŸ¥çœ‹äº†æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ²¡æœ‰å‘çŽ°ä»»ä½•æŠ•æ¯’ä»£ç ã€‚å…¶ä¸­ï¼ŒCVE-2024-32019.shè„šæœ¬ç”¨äºŽåˆ©ç”¨æ¼æ´žï¼Œpayload.cç”¨äºŽç¼–è¯‘æ¶æ„payloadï¼ŒREADME.mdæ–‡ä»¶æè¿°äº†æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ï¼Œéƒ½æ˜¯æ­£å¸¸çš„åˆ©ç”¨ä»£ç ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**æ¥æº**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata ndsudoå·¥å…·ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªSUID rootçš„ç¨‹åºï¼Œä½†å®ƒä½¿ç”¨äº†PATHçŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡æŒ‡å‘ä¸€ä¸ªè‡ªå·±å¯æŽ§çš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹æ”¾ç½®æ¶æ„ç¨‹åºï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žæ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ£€æŸ¥ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨`/opt`ç›®å½•ä¸‹çš„`ndsudo`ç¨‹åºï¼Œå¹¶ä¸”ç¡®è®¤è¯¥ç¨‹åºæ˜¯å¦ä¸ºrootæ‰€æœ‰ä¸”è®¾ç½®äº†SUIDæƒé™ã€‚åŒæ—¶ï¼Œä½¿ç”¨`strings`å‘½ä»¤æ£€æŸ¥`ndsudo`ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨å¯¹`nvme`ã€`smartctl`ã€`hdparm`æˆ–`sensors`ç­‰å¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¯´æ˜Žè¯¥ç¨‹åºå¯èƒ½å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚
2.  **æ¶æ„ç¨‹åºç¼–è¯‘ï¼š** ç¼–è¯‘ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯è®¾ç½®UIDå’ŒGIDä¸º0ï¼Œç„¶åŽæ‰§è¡Œ`/bin/bash`ï¼Œä»Žè€ŒèŽ·å–root shellã€‚
3.  **æ¶æ„ç¨‹åºä¸Šä¼ ï¼š** é€šè¿‡SFTPå°†ç¼–è¯‘å¥½çš„æ¶æ„ç¨‹åºä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæ”»å‡»è€…å¯æŽ§çš„ç›®å½•ï¼Œä¾‹å¦‚`/tmp`ã€‚
4.  **çŽ¯å¢ƒå˜é‡ä¿®æ”¹ï¼š** ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æ”»å‡»è€…å¯æŽ§çš„ç›®å½•æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ï¼Œç¡®ä¿`ndsudo`ç¨‹åºåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶é¦–å…ˆåœ¨è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ã€‚
5.  **æ¼æ´žè§¦å‘ï¼š** æ‰§è¡Œ`ndsudo`ç¨‹åºï¼Œå½“å®ƒè°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…ä¸Šä¼ çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å–rootæƒé™ã€‚
6.  **äº¤äº’å¼Shellï¼š** æ¼æ´žåˆ©ç”¨ä»£ç æä¾›äº¤äº’å¼shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æ­¤POCä»£ç æœ¬èº«ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œå®žçŽ°æœ¬åœ°ææƒã€‚ä½†æ˜¯ï¼Œè¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ï¼š

*   **ç¼–è¯‘å’Œä¼ è¾“æ¶æ„ä»£ç ï¼š** è„šæœ¬ä¼šè‡ªåŠ¨ç¼–è¯‘Cä»£ç ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚è™½ç„¶Cä»£ç çš„å†…å®¹æ˜¯ææƒï¼Œä½†å¦‚æžœæ¶æ„æ”»å‡»è€…ä¿®æ”¹äº†Cä»£ç ï¼Œå°±å¯èƒ½åŒ…å«å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åŽé—¨ã€æ”¶é›†ä¿¡æ¯ç­‰ã€‚
*   **è¿œç¨‹æ‰§è¡Œä»£ç ï¼š**  è„šæœ¬é€šè¿‡sshæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£Žé™©ï¼Œå¯èƒ½æ‰§è¡Œé¢å¤–çš„æ¶æ„æ“ä½œã€‚
*   **æ®‹ç•™æ–‡ä»¶ï¼š** ç¼–è¯‘åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸Šä¼ çš„æ¶æ„ç¨‹åºå¯èƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç•™ä¸‹ç—•è¿¹ï¼Œå¦‚æžœè¿™äº›æ–‡ä»¶è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å®‰å…¨é—®é¢˜ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é£Žé™©ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œè¯¥POCä»£ç çš„é£Žé™©ä»ç„¶å¯æŽ§ï¼Œä¸»è¦é£Žé™©é›†ä¸­åœ¨ä»£ç çš„ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨ä¸Šã€‚ä¸ºäº†é™ä½Žé£Žé™©ï¼Œå»ºè®®ä»Žå¯ä¿¡çš„æ¥æºèŽ·å–POCä»£ç ï¼Œå¹¶ä»”ç»†æ£€æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿å…¶æ²¡æœ‰æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œåœ¨æµ‹è¯•å®ŒæˆåŽï¼Œåº”åŠæ—¶æ¸…ç†ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ®‹ç•™æ–‡ä»¶ã€‚

æŠ•æ¯’é£Žé™©é¢„ä¼°ä¸º10%ï¼Œå› ä¸ºä»£ç ç›¸å¯¹ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´žéªŒè¯å’Œåˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨è¢«ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**æ¥æº**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°shellè®¿é—®ï¼Œèƒ½å¤Ÿæ‰§è¡Œndsudoå‘½ä»¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2024-32019 æ˜¯ Netdata ä¸­ ndsudo å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudo æ˜¯ä¸€ä¸ª SUID root çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„è„šæœ¬æ”¾ç½®åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆçº§æ›´é«˜çš„ç›®å½•ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ nvmeï¼‰ï¼Œæ¥æ¬ºéª— ndsudo æ‰§è¡Œè¯¥æ¶æ„è„šæœ¬å¹¶èŽ·å¾— root æƒé™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æè¿°äº†ä¸€ç§åˆ©ç”¨æ­¤æ¼æ´žçš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1.  åˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼ˆpoc.pyï¼‰ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
2.  å°†æ­¤è„šæœ¬é‡å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ nvmeï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ ndsudo nvme-listï¼Œè¿™å°†å¯¼è‡´ ndsudo æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“æœ¬èº«æŠ•æ¯’é£Žé™©è¾ƒä½Žã€‚`poc.py` ä»£ç éžå¸¸ç®€å•ï¼Œä»…åŒ…å«ææƒæ‰§è¡Œbashçš„ä»£ç ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„ä»£ç ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¸…æ™°çš„æ¼æ´žåˆ©ç”¨è¯´æ˜Žã€‚ä½†ç”¨æˆ·ä»ç„¶éœ€è¦æ³¨æ„ï¼Œåœ¨å®žé™…çŽ¯å¢ƒä¸­ï¼Œä»Žä¸å¯ä¿¡çš„æ¥æºä¸‹è½½æˆ–å¤åˆ¶æ¼æ´žåˆ©ç”¨ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£Žé™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå†æ‰§è¡Œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žåŽŸç†ï¼š** `ndsudo` ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢å‘½ä»¤çš„è·¯å¾„ä¾èµ–äºŽç”¨æˆ·çš„ `PATH` çŽ¯å¢ƒå˜é‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   åˆ›å»ºæ¶æ„è„šæœ¬ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
    *   å°†æ­¤è„šæœ¬é‡å‘½åä¸º `ndsudo` å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆé€šè¿‡ `ndsudo --help` æŸ¥çœ‹ï¼‰ã€‚
    *   å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œç¡®ä¿æ¶æ„è„šæœ¬ä¼˜å…ˆè¢«æœç´¢åˆ°ã€‚
    *   è¿è¡Œ `ndsudo <allowed_command>`ï¼Œè¿™å°†å¯¼è‡´ `ndsudo` æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´žåˆ©ç”¨è¾ƒä¸ºç®€å•ï¼ŒPOC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä½†åº”æ³¨æ„æ¥æºä¸æ˜Žçš„exploitä»£ç çš„æ½œåœ¨æŠ•æ¯’é£Žé™©ã€‚è¯¥æ¼æ´žå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡æ“çºµ `PATH` çŽ¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨ SUID ç¨‹åº `ndsudo` æå‡è‡³ root æƒé™ã€‚åŠ¡å¿…åŠæ—¶å‡çº§ Netdata ç‰ˆæœ¬ä»¥ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**æ¥æº**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœ¬åœ°ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata agentè¿è¡Œåœ¨å—å½±å“ç‰ˆæœ¬ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰§è¡Œæœ¬åœ°ä»£ç ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·æ‹¥æœ‰ SUID æƒé™ï¼Œå…è®¸æ‰§è¡ŒæŸäº›ç‰¹æƒå‘½ä»¤ã€‚æ¼æ´žçš„æ ¹æºåœ¨äºŽ `ndsudo` ä½¿ç”¨ä¸å®‰å…¨çš„ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ PATH ä¸­æ’å…¥æ¶æ„ç¨‹åºï¼Œè®© `ndsudo` æ‰§è¡Œæ”»å‡»è€…æŽ§åˆ¶çš„ä»£ç ï¼Œä»Žè€Œæå‡æƒé™åˆ° rootã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾ `ndsudo` è·¯å¾„ï¼š** é€šå¸¸ä½äºŽ `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`ï¼Œä½†éœ€è¦é€šè¿‡ `find` å‘½ä»¤ç¡®è®¤ã€‚
2.  **åˆ›å»ºæ¶æ„ç¨‹åºï¼š** åˆ›å»ºä¸€ä¸ª C ç¨‹åºï¼Œè¯¥ç¨‹åºè°ƒç”¨ `setuid(0)` å’Œ `setgid(0)` è®¾ç½®ç”¨æˆ·å’Œç»„ ID ä¸º rootï¼Œç„¶åŽæ‰§è¡Œä¸€ä¸ª shell (ä¾‹å¦‚ `/bin/bash -p`)ã€‚éœ€è¦ä½¿ç”¨ `gcc` ç¼–è¯‘è¯¥ç¨‹åºï¼Œä¾‹å¦‚å‘½åä¸º `arcconf`ã€‚
3.  **ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼š** å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ¶æ„ç¨‹åºä½äºŽ `/tmp` ç›®å½•ä¸‹ï¼Œåˆ™æ‰§è¡Œ `PATH=/tmp:$PATH`ã€‚
4.  **æ‰§è¡Œ `ndsudo` å‘½ä»¤ï¼š** ä½¿ç”¨ `ndsudo` æ‰§è¡Œå®ƒæ”¯æŒçš„å‘½ä»¤ï¼Œä½†è¯¥å‘½ä»¤ä¾èµ–äºŽæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`ã€‚`ndsudo` ä¼šå°è¯•æ‰§è¡Œ `arcconf`ï¼Œä½†ç”±äºŽ PATH çŽ¯å¢ƒå˜é‡è¢«ä¿®æ”¹ï¼Œå®ƒä¼šæ‰§è¡Œæ”»å‡»è€…åœ¨ `/tmp` ç›®å½•ä¸‹åˆ›å»ºçš„æ¶æ„ç¨‹åºã€‚
5.  **èŽ·å¾— root shellï¼š** å¦‚æžœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…å°†èŽ·å¾—ä¸€ä¸ª root shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æä¾›çš„ POC ä»£ç ä¸­ï¼Œ`arcconf.c` çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªææƒçš„ shellï¼Œæ²¡æœ‰æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ ä½†ä»Ž github ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ `arcconf` æ—¶ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½åœ¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä»Ž github ä¸Šä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ½œåœ¨é£Žé™©ï¼Œæ•…æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**æ¥æº**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo æœ¬åœ°æƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·æå‡è‡³ root æƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 å’Œ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Netdataï¼Œä¸” ndsudo å·¥å…·è®¾ç½®äº† SUID root æƒé™ï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ ndsudoã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å®ƒä½¿ç”¨ `PATH` çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ `PATH` çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘æ¶æ„ç›®å½•çš„è·¯å¾„ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªä¸Ž `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤åŒåçš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œä»¥ root æƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§:**

æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´žã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåå¼¹ shellï¼‰çš„ç›®å½•ã€‚
2.  å°†æ¶æ„ç¨‹åºå‘½åä¸º `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œ`nvme-list`ï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ `ndsudo` å‘½ä»¤ã€‚`ndsudo` å°†æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€Œä½¿æ”»å‡»è€…èŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©:**

æ ¹æ®æä¾›çš„ä»£ç åˆ†æžï¼Œè¯¥ä»“åº“ä¼¼ä¹Žä¸»è¦æä¾›äº†ä¸€ä¸ª checker è„šæœ¬æ¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œç®¡ç†å‘˜è¯†åˆ«å’ŒéªŒè¯æ¼æ´žæ˜¯å¦å­˜åœ¨ï¼Œæ—¨åœ¨å¸®åŠ©é˜²å¾¡è€…è¯„ä¼°é£Žé™©å’ŒéªŒè¯è¡¥ä¸ï¼Œè€Œä¸æ˜¯æä¾›æ­¦å™¨åŒ–çš„ PoCã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žã€‚

æ£€æŸ¥å™¨ä»£ç ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (æˆ–å®‰è£…ä½ç½®) çš„ SUID/æ‰€æœ‰æƒã€‚
*   `PATH` ä¸­æ—©äºŽå¸¸è§ç³»ç»Ÿè·¯å¾„çš„å¯å†™ç›®å½•ã€‚
*   `ndsudo` å°è¯•æ‰§è¡Œçš„ç™½åå•å­å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚
*   å¯é€‰åœ°è¿è¡Œ `ndsudo --test <subcommand>` æ¥æ‰“å°å·²è§£æžçš„å‘½ä»¤è€Œä¸æ‰§è¡Œå®ƒ (è°¨æ…Žä½¿ç”¨ï¼Œå…ˆé˜…è¯»ä»£ç )ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º 0%**ã€‚


**é¡¹ç›®åœ°å€:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**æ¥æº**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´žèŽ·å–rootæƒé™ã€‚

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”æ”»å‡»è€…éœ€è¦å…·æœ‰æœ¬åœ°ä½Žæƒé™è´¦å·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ netdata çš„ ndsudo å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢è·¯å¾„ç”± PATH çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨ ndsudo æœç´¢è·¯å¾„ä¸­ï¼Œå½“ ndsudo è°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª C ç¨‹åºï¼Œç¼–è¯‘åŽå¯ä»¥ç›´æŽ¥æ‰§è¡Œä¸€ä¸ªå…·æœ‰ root æƒé™çš„ bash shellã€‚æ”»å‡»è€…éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«æ­¤æ¶æ„ç¨‹åºçš„å¯å†™ç›®å½•ï¼Œç„¶åŽä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ­¤ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚ä¹‹åŽï¼Œå½“ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

ä»£ç ä¸­æ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚å®ƒåªæ˜¯ç®€å•åœ°è®¾ç½® uid å’Œ gid ä¸º 0ï¼Œç„¶åŽæ‰§è¡Œ /bin/bashã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º0%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1.  åˆ©ç”¨éœ€è¦å…ˆèŽ·å¾—ä¸€ä¸ªnetdataè½¯ä»¶çš„ä½Žæƒé™è´¦å·ã€‚
2.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ POC ä¸­çš„ C ç¨‹åºç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„å¯å†™ç›®å½•ã€‚
3.  ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†è¯¥ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚
4.  è§¦å‘ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤ï¼Œè¿™å°†å¯¼è‡´æ¶æ„ç¨‹åºä»¥ root æƒé™æ‰§è¡Œï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

**é¡¹ç›®åœ°å€:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**æ¥æº**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯æå‡è‡³rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 åŠ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”å…·æœ‰æœ¬åœ°shellè®¿é—®æƒé™ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 å­˜åœ¨äºŽNetdataçš„`ndsudo`å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·æ˜¯å…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¼æ´žåŽŸå› æ˜¯`ndsudo`çš„æœç´¢è·¯å¾„ç”±`PATH`çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨å‰é¢ï¼Œå½“`ndsudo`æ‰§è¡Œä¿¡ä»»çš„å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œå®žçŽ°æœ¬åœ°ææƒã€‚æä¾›çš„POCä»£ç é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´žï¼š

1.  **ç¼–è¯‘æ¶æ„payload:**  `poc.c` ç¼–è¯‘æˆ `nvme`ï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯æ‰§è¡Œ `/bin/bash`ï¼Œå¹¶è®¾ç½® UID å’Œ GID ä¸º 0ï¼Œå³rootæƒé™ã€‚
2.  **ä¼ è¾“payloadåˆ°ç›®æ ‡ç³»ç»Ÿ:**  å°†ç¼–è¯‘å¥½çš„`nvme`ä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„`/tmp`ç›®å½•ã€‚
3.  **å‡†å¤‡payloadæ‰§è¡Œ:**  ç»™`/tmp/nvme`æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽå°†`/tmp`æ·»åŠ åˆ°`PATH`çŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ã€‚
4.  **è§¦å‘`ndsudo`æ‰§è¡Œpayload:** è¿è¡Œ`./ndsudo nvme-list`ï¼Œ`ndsudo`ä¼šæ‰§è¡Œ`/tmp/nvme`ï¼Œç”±äºŽè¯¥ç¨‹åºä¼šå°†æƒé™æå‡ä¸ºrootï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥èŽ·å¾—root shellã€‚

**æœ‰æ•ˆæ€§ï¼š** è¯¥POCä»£ç æè¿°çš„åˆ©ç”¨æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„`poc.c`ä»£ç åŠŸèƒ½æ¸…æ™°ï¼Œä»…ä¸ºæ‰§è¡Œ`/bin/bash`å¹¶æå‡æƒé™ï¼Œä¸å­˜åœ¨éšè—çš„æŠ•æ¯’ä»£ç ã€‚READMEæ–‡ä»¶æè¿°äº†å®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`PATH`çŽ¯å¢ƒå˜é‡ï¼Œæ¬ºéª—`ndsudo`æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**æ¥æº**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦netdata agentå­˜åœ¨æ¼æ´žç‰ˆæœ¬ä¸”ndsudoè¢«è°ƒç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata Agentä¸­ndsudoå·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªrootç”¨æˆ·æ‹¥æœ‰çš„ã€è®¾ç½®äº†SUIDä½çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒæœ¬åº”åªè¿è¡Œä¸€ç»„å—é™çš„å¤–éƒ¨å‘½ä»¤ï¼Œä½†æ˜¯å…¶æœç´¢è·¯å¾„ç”±PATHçŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æŒ‡å®šndsudoæŸ¥æ‰¾è¿™äº›å‘½ä»¤çš„ä½ç½®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯æ”»å‡»è€…å…·æœ‰å†™æƒé™çš„ç›®å½•ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ”¾ç½®æ¶æ„ç¨‹åºå¹¶ä»¥rootæƒé™æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´žæè¿°å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žå­˜åœ¨åˆ©ç”¨ä»·å€¼ï¼Œé€šè¿‡æŽ§åˆ¶PATHçŽ¯å¢ƒå˜é‡æ¥æ‰§è¡Œæ¶æ„ç¨‹åºè¾¾åˆ°ææƒæ•ˆæžœã€‚

**æŠ•æ¯’é£Žé™©ï¼š** æä¾›çš„ä»£ç ä»…ä¸ºGNU GENERAL PUBLIC LICENSEï¼Œæ˜¯å¼€æºåè®®è®¸å¯ï¼Œä¸åŒ…å«ç›´æŽ¥çš„æ”»å‡»payloadæˆ–æ¶æ„ä»£ç ã€‚ä½†licenseæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ä»£ç ï¼Œå¦‚æžœç»“åˆç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œåè®®å†…å®¹ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åˆ›å»ºä¸€ä¸ªåˆæ³•çš„ç¨‹åºï¼Œä½†å…¶è¡Œä¸ºè¿åäº†åè®®æ¡æ¬¾ï¼Œä»Žè€Œé€ æˆæŸå®³ã€‚æ­¤ä»“åº“ä¸­å‘çŽ°ç›´æŽ¥æŠ•æ¯’ä»£ç çš„æ¦‚çŽ‡è¾ƒä½Žï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æ»¥ç”¨é£Žé™©ï¼Œä¼°è®¡æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„Netdata Agentç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 1.44.0-60, < 1.45.3ï¼‰ã€‚
2.  æŸ¥æ‰¾ndsudoå·¥å…·çš„ä½ç½®ã€‚
3.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å‘½ä»¤çš„ç›®å½•ï¼Œä¾‹å¦‚/tmp/evilã€‚
4.  å°†æ¶æ„ç¨‹åºï¼ˆå¦‚åå¼¹shellï¼‰æ”¾ç½®åˆ°/tmp/evilç›®å½•ä¸‹ï¼Œå¹¶å‘½åä¸ºndsudoå°è¯•æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œ`ping`ï¼Œ`date` ç­‰, å…·ä½“å–å†³äºŽ ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼‰ã€‚
5.  ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†/tmp/evilæ·»åŠ åˆ°PATHçš„æœ€å‰é¢ï¼š`export PATH=/tmp/evil:$PATH`ã€‚
6.  è¿è¡Œndsudoï¼Œå®ƒå°†æ‰§è¡Œ/tmp/evilç›®å½•ä¸‹çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**é¡¹ç›®åœ°å€:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**æ¥æº**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡PATHåŠ«æŒæ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata Agentå­˜åœ¨ndsudoï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠå¯æŽ§çš„PATHçŽ¯å¢ƒå˜é‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdataä¸­`ndsudo`å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´žã€‚`ndsudo`æ˜¯ä¸€ä¸ªå…·æœ‰SUID rootæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨`PATH`çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨`PATH`çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆäºŽç³»ç»Ÿç›®å½•çš„ä½ç½®ï¼Œè¯±ä½¿`ndsudo`æ‰§è¡Œè¯¥æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**
1.  æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„`ndsudo`å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶(ä¾‹å¦‚`nvme`)ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œæ”»å‡»è€…å¸Œæœ›æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚æä¾›çš„`payload.c`æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªroot shellã€‚
3.  ä¿®æ”¹`PATH`çŽ¯å¢ƒå˜é‡ï¼Œå°†å½“å‰ç›®å½•(æˆ–åŒ…å«æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•)æ·»åŠ åˆ°`PATH`çš„å¼€å¤´ã€‚
4.  è°ƒç”¨`ndsudo`ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ƒå…è®¸æ‰§è¡Œçš„å‘½ä»¤(ä¾‹å¦‚`nvme-list`)ã€‚ç”±äºŽ`PATH`å·²ç»è¢«ä¿®æ”¹ï¼Œ`ndsudo`ä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„`nvme`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»Žè€Œä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºŽæŸ¥æ‰¾`ndsudo`ï¼Œåˆ›å»ºä¸€ä¸ª`nvme` payloadï¼Œä¿®æ”¹`PATH`ï¼Œç„¶åŽæ‰§è¡Œ`ndsudo`ã€‚README.mdæ–‡ä»¶æè¿°äº†å¦‚ä½•ç¼–è¯‘`payload.c`å¹¶ä½¿ç”¨è„šæœ¬ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
æŸ¥çœ‹äº†æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ²¡æœ‰å‘çŽ°ä»»ä½•æŠ•æ¯’ä»£ç ã€‚å…¶ä¸­ï¼ŒCVE-2024-32019.shè„šæœ¬ç”¨äºŽåˆ©ç”¨æ¼æ´žï¼Œpayload.cç”¨äºŽç¼–è¯‘æ¶æ„payloadï¼ŒREADME.mdæ–‡ä»¶æè¿°äº†æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ï¼Œéƒ½æ˜¯æ­£å¸¸çš„åˆ©ç”¨ä»£ç ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**æ¥æº**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³root

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œä¸”ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Netdata

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2024-32019æ˜¯Netdata ndsudoå·¥å…·ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudoæ˜¯ä¸€ä¸ªSUID rootçš„ç¨‹åºï¼Œä½†å®ƒä½¿ç”¨äº†PATHçŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡æŒ‡å‘ä¸€ä¸ªè‡ªå·±å¯æŽ§çš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹æ”¾ç½®æ¶æ„ç¨‹åºï¼Œå½“ndsudoæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾—rootæƒé™ã€‚

**æ¼æ´žåˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žæ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ£€æŸ¥ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨`/opt`ç›®å½•ä¸‹çš„`ndsudo`ç¨‹åºï¼Œå¹¶ä¸”ç¡®è®¤è¯¥ç¨‹åºæ˜¯å¦ä¸ºrootæ‰€æœ‰ä¸”è®¾ç½®äº†SUIDæƒé™ã€‚åŒæ—¶ï¼Œä½¿ç”¨`strings`å‘½ä»¤æ£€æŸ¥`ndsudo`ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨å¯¹`nvme`ã€`smartctl`ã€`hdparm`æˆ–`sensors`ç­‰å¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¯´æ˜Žè¯¥ç¨‹åºå¯èƒ½å—åˆ°PATHçŽ¯å¢ƒå˜é‡çš„å½±å“ã€‚
2.  **æ¶æ„ç¨‹åºç¼–è¯‘ï¼š** ç¼–è¯‘ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºçš„åŠŸèƒ½æ˜¯è®¾ç½®UIDå’ŒGIDä¸º0ï¼Œç„¶åŽæ‰§è¡Œ`/bin/bash`ï¼Œä»Žè€ŒèŽ·å–root shellã€‚
3.  **æ¶æ„ç¨‹åºä¸Šä¼ ï¼š** é€šè¿‡SFTPå°†ç¼–è¯‘å¥½çš„æ¶æ„ç¨‹åºä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæ”»å‡»è€…å¯æŽ§çš„ç›®å½•ï¼Œä¾‹å¦‚`/tmp`ã€‚
4.  **çŽ¯å¢ƒå˜é‡ä¿®æ”¹ï¼š** ä¿®æ”¹PATHçŽ¯å¢ƒå˜é‡ï¼Œå°†æ”»å‡»è€…å¯æŽ§çš„ç›®å½•æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡çš„æœ€å‰é¢ï¼Œç¡®ä¿`ndsudo`ç¨‹åºåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶é¦–å…ˆåœ¨è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ã€‚
5.  **æ¼æ´žè§¦å‘ï¼š** æ‰§è¡Œ`ndsudo`ç¨‹åºï¼Œå½“å®ƒè°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…ä¸Šä¼ çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å–rootæƒé™ã€‚
6.  **äº¤äº’å¼Shellï¼š** æ¼æ´žåˆ©ç”¨ä»£ç æä¾›äº¤äº’å¼shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æ­¤POCä»£ç æœ¬èº«ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œå®žçŽ°æœ¬åœ°ææƒã€‚ä½†æ˜¯ï¼Œè¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ï¼š

*   **ç¼–è¯‘å’Œä¼ è¾“æ¶æ„ä»£ç ï¼š** è„šæœ¬ä¼šè‡ªåŠ¨ç¼–è¯‘Cä»£ç ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚è™½ç„¶Cä»£ç çš„å†…å®¹æ˜¯ææƒï¼Œä½†å¦‚æžœæ¶æ„æ”»å‡»è€…ä¿®æ”¹äº†Cä»£ç ï¼Œå°±å¯èƒ½åŒ…å«å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åŽé—¨ã€æ”¶é›†ä¿¡æ¯ç­‰ã€‚
*   **è¿œç¨‹æ‰§è¡Œä»£ç ï¼š**  è„šæœ¬é€šè¿‡sshæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£Žé™©ï¼Œå¯èƒ½æ‰§è¡Œé¢å¤–çš„æ¶æ„æ“ä½œã€‚
*   **æ®‹ç•™æ–‡ä»¶ï¼š** ç¼–è¯‘åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸Šä¼ çš„æ¶æ„ç¨‹åºå¯èƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç•™ä¸‹ç—•è¿¹ï¼Œå¦‚æžœè¿™äº›æ–‡ä»¶è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å®‰å…¨é—®é¢˜ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é£Žé™©ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œè¯¥POCä»£ç çš„é£Žé™©ä»ç„¶å¯æŽ§ï¼Œä¸»è¦é£Žé™©é›†ä¸­åœ¨ä»£ç çš„ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨ä¸Šã€‚ä¸ºäº†é™ä½Žé£Žé™©ï¼Œå»ºè®®ä»Žå¯ä¿¡çš„æ¥æºèŽ·å–POCä»£ç ï¼Œå¹¶ä»”ç»†æ£€æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿å…¶æ²¡æœ‰æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œåœ¨æµ‹è¯•å®ŒæˆåŽï¼Œåº”åŠæ—¶æ¸…ç†ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ®‹ç•™æ–‡ä»¶ã€‚

æŠ•æ¯’é£Žé™©é¢„ä¼°ä¸º10%ï¼Œå› ä¸ºä»£ç ç›¸å¯¹ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´žéªŒè¯å’Œåˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨è¢«ç¯¡æ”¹å’Œæ¶æ„åˆ©ç”¨çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**æ¥æº**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudoæœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æœ¬åœ°shellè®¿é—®ï¼Œèƒ½å¤Ÿæ‰§è¡Œndsudoå‘½ä»¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2024-32019 æ˜¯ Netdata ä¸­ ndsudo å·¥å…·çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´žã€‚ndsudo æ˜¯ä¸€ä¸ª SUID root çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å®ƒä½¿ç”¨ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å°†æ¶æ„è„šæœ¬æ”¾ç½®åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ä¼˜å…ˆçº§æ›´é«˜çš„ç›®å½•ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ nvmeï¼‰ï¼Œæ¥æ¬ºéª— ndsudo æ‰§è¡Œè¯¥æ¶æ„è„šæœ¬å¹¶èŽ·å¾— root æƒé™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æè¿°äº†ä¸€ç§åˆ©ç”¨æ­¤æ¼æ´žçš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1.  åˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼ˆpoc.pyï¼‰ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
2.  å°†æ­¤è„šæœ¬é‡å‘½åä¸º ndsudo å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ nvmeï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ ndsudo nvme-listï¼Œè¿™å°†å¯¼è‡´ ndsudo æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“æœ¬èº«æŠ•æ¯’é£Žé™©è¾ƒä½Žã€‚`poc.py` ä»£ç éžå¸¸ç®€å•ï¼Œä»…åŒ…å«ææƒæ‰§è¡Œbashçš„ä»£ç ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„ä»£ç ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¸…æ™°çš„æ¼æ´žåˆ©ç”¨è¯´æ˜Žã€‚ä½†ç”¨æˆ·ä»ç„¶éœ€è¦æ³¨æ„ï¼Œåœ¨å®žé™…çŽ¯å¢ƒä¸­ï¼Œä»Žä¸å¯ä¿¡çš„æ¥æºä¸‹è½½æˆ–å¤åˆ¶æ¼æ´žåˆ©ç”¨ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£Žé™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå†æ‰§è¡Œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žåŽŸç†ï¼š** `ndsudo` ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢å‘½ä»¤çš„è·¯å¾„ä¾èµ–äºŽç”¨æˆ·çš„ `PATH` çŽ¯å¢ƒå˜é‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   åˆ›å»ºæ¶æ„è„šæœ¬ï¼Œè¯¥è„šæœ¬æ‰§è¡Œææƒæ“ä½œï¼ˆä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ª root shellï¼‰ã€‚
    *   å°†æ­¤è„šæœ¬é‡å‘½åä¸º `ndsudo` å…è®¸æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆé€šè¿‡ `ndsudo --help` æŸ¥çœ‹ï¼‰ã€‚
    *   å°†åŒ…å«æ¶æ„è„šæœ¬çš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œç¡®ä¿æ¶æ„è„šæœ¬ä¼˜å…ˆè¢«æœç´¢åˆ°ã€‚
    *   è¿è¡Œ `ndsudo <allowed_command>`ï¼Œè¿™å°†å¯¼è‡´ `ndsudo` æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´žåˆ©ç”¨è¾ƒä¸ºç®€å•ï¼ŒPOC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä½†åº”æ³¨æ„æ¥æºä¸æ˜Žçš„exploitä»£ç çš„æ½œåœ¨æŠ•æ¯’é£Žé™©ã€‚è¯¥æ¼æ´žå…è®¸ä½Žæƒé™ç”¨æˆ·é€šè¿‡æ“çºµ `PATH` çŽ¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨ SUID ç¨‹åº `ndsudo` æå‡è‡³ root æƒé™ã€‚åŠ¡å¿…åŠæ—¶å‡çº§ Netdata ç‰ˆæœ¬ä»¥ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**æ¥æº**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœ¬åœ°ç”¨æˆ·èŽ·å¾—rootæƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Netdata agentè¿è¡Œåœ¨å—å½±å“ç‰ˆæœ¬ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰§è¡Œæœ¬åœ°ä»£ç ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·æ‹¥æœ‰ SUID æƒé™ï¼Œå…è®¸æ‰§è¡ŒæŸäº›ç‰¹æƒå‘½ä»¤ã€‚æ¼æ´žçš„æ ¹æºåœ¨äºŽ `ndsudo` ä½¿ç”¨ä¸å®‰å…¨çš„ PATH çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ PATH ä¸­æ’å…¥æ¶æ„ç¨‹åºï¼Œè®© `ndsudo` æ‰§è¡Œæ”»å‡»è€…æŽ§åˆ¶çš„ä»£ç ï¼Œä»Žè€Œæå‡æƒé™åˆ° rootã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾ `ndsudo` è·¯å¾„ï¼š** é€šå¸¸ä½äºŽ `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`ï¼Œä½†éœ€è¦é€šè¿‡ `find` å‘½ä»¤ç¡®è®¤ã€‚
2.  **åˆ›å»ºæ¶æ„ç¨‹åºï¼š** åˆ›å»ºä¸€ä¸ª C ç¨‹åºï¼Œè¯¥ç¨‹åºè°ƒç”¨ `setuid(0)` å’Œ `setgid(0)` è®¾ç½®ç”¨æˆ·å’Œç»„ ID ä¸º rootï¼Œç„¶åŽæ‰§è¡Œä¸€ä¸ª shell (ä¾‹å¦‚ `/bin/bash -p`)ã€‚éœ€è¦ä½¿ç”¨ `gcc` ç¼–è¯‘è¯¥ç¨‹åºï¼Œä¾‹å¦‚å‘½åä¸º `arcconf`ã€‚
3.  **ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼š** å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ¶æ„ç¨‹åºä½äºŽ `/tmp` ç›®å½•ä¸‹ï¼Œåˆ™æ‰§è¡Œ `PATH=/tmp:$PATH`ã€‚
4.  **æ‰§è¡Œ `ndsudo` å‘½ä»¤ï¼š** ä½¿ç”¨ `ndsudo` æ‰§è¡Œå®ƒæ”¯æŒçš„å‘½ä»¤ï¼Œä½†è¯¥å‘½ä»¤ä¾èµ–äºŽæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`ã€‚`ndsudo` ä¼šå°è¯•æ‰§è¡Œ `arcconf`ï¼Œä½†ç”±äºŽ PATH çŽ¯å¢ƒå˜é‡è¢«ä¿®æ”¹ï¼Œå®ƒä¼šæ‰§è¡Œæ”»å‡»è€…åœ¨ `/tmp` ç›®å½•ä¸‹åˆ›å»ºçš„æ¶æ„ç¨‹åºã€‚
5.  **èŽ·å¾— root shellï¼š** å¦‚æžœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…å°†èŽ·å¾—ä¸€ä¸ª root shellã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

æä¾›çš„ POC ä»£ç ä¸­ï¼Œ`arcconf.c` çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªææƒçš„ shellï¼Œæ²¡æœ‰æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ ä½†ä»Ž github ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ `arcconf` æ—¶ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½åœ¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä»Ž github ä¸Šä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ½œåœ¨é£Žé™©ï¼Œæ•…æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**æ¥æº**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo æœ¬åœ°æƒé™æå‡

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸ä½Žæƒé™ç”¨æˆ·æå‡è‡³ root æƒé™

**å½±å“ç‰ˆæœ¬:** >= 1.44.0-60, < 1.45.0-169 å’Œ >= 1.45.0, < 1.45.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Netdataï¼Œä¸” ndsudo å·¥å…·è®¾ç½®äº† SUID root æƒé™ï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ ndsudoã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ Netdata çš„ `ndsudo` å·¥å…·ä¸­ã€‚è¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å®ƒä½¿ç”¨ `PATH` çŽ¯å¢ƒå˜é‡æ¥æŸ¥æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ `PATH` çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘æ¶æ„ç›®å½•çš„è·¯å¾„ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªä¸Ž `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤åŒåçš„æ¶æ„ç¨‹åºï¼Œä»Žè€Œä»¥ root æƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§:**

æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´žã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåå¼¹ shellï¼‰çš„ç›®å½•ã€‚
2.  å°†æ¶æ„ç¨‹åºå‘½åä¸º `ndsudo` å°è¯•æ‰§è¡Œçš„å‘½ä»¤ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œ`nvme-list`ï¼‰ã€‚
3.  å°†åŒ…å«æ¶æ„ç¨‹åºçš„ç›®å½•æ·»åŠ åˆ° `PATH` çŽ¯å¢ƒå˜é‡çš„å¼€å¤´ã€‚
4.  è¿è¡Œ `ndsudo` å‘½ä»¤ã€‚`ndsudo` å°†æ‰§è¡Œæ¶æ„ç¨‹åºï¼Œä»Žè€Œä½¿æ”»å‡»è€…èŽ·å¾— root æƒé™ã€‚

**æŠ•æ¯’é£Žé™©:**

æ ¹æ®æä¾›çš„ä»£ç åˆ†æžï¼Œè¯¥ä»“åº“ä¼¼ä¹Žä¸»è¦æä¾›äº†ä¸€ä¸ª checker è„šæœ¬æ¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œç®¡ç†å‘˜è¯†åˆ«å’ŒéªŒè¯æ¼æ´žæ˜¯å¦å­˜åœ¨ï¼Œæ—¨åœ¨å¸®åŠ©é˜²å¾¡è€…è¯„ä¼°é£Žé™©å’ŒéªŒè¯è¡¥ä¸ï¼Œè€Œä¸æ˜¯æä¾›æ­¦å™¨åŒ–çš„ PoCã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£Žé™©è¾ƒä½Žã€‚

æ£€æŸ¥å™¨ä»£ç ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (æˆ–å®‰è£…ä½ç½®) çš„ SUID/æ‰€æœ‰æƒã€‚
*   `PATH` ä¸­æ—©äºŽå¸¸è§ç³»ç»Ÿè·¯å¾„çš„å¯å†™ç›®å½•ã€‚
*   `ndsudo` å°è¯•æ‰§è¡Œçš„ç™½åå•å­å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚
*   å¯é€‰åœ°è¿è¡Œ `ndsudo --test <subcommand>` æ¥æ‰“å°å·²è§£æžçš„å‘½ä»¤è€Œä¸æ‰§è¡Œå®ƒ (è°¨æ…Žä½¿ç”¨ï¼Œå…ˆé˜…è¯»ä»£ç )ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º 0%**ã€‚


**é¡¹ç›®åœ°å€:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**æ¥æº**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-æœ¬åœ°ææƒ

**æ¼æ´žç¼–å·:** CVE-2024-32019

**æ¼æ´žç±»åž‹:** æœ¬åœ°ææƒ

**å½±å“åº”ç”¨:** netdata

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´žèŽ·å–rootæƒé™ã€‚

**å½±å“ç‰ˆæœ¬:** >= 1.45.0, < 1.45.3 å’Œ >= 1.44.0-60, < 1.45.0-169

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„netdataï¼Œä¸”æ”»å‡»è€…éœ€è¦å…·æœ‰æœ¬åœ°ä½Žæƒé™è´¦å·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2024-32019 æ¼æ´žå­˜åœ¨äºŽ netdata çš„ ndsudo å·¥å…·ä¸­ï¼Œè¯¥å·¥å…·ä»¥ root æƒé™è¿è¡Œï¼Œä½†å…¶æœç´¢è·¯å¾„ç”± PATH çŽ¯å¢ƒå˜é‡æŽ§åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ¶æ„ç¨‹åºæ”¾ç½®åœ¨ ndsudo æœç´¢è·¯å¾„ä¸­ï¼Œå½“ ndsudo è°ƒç”¨å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root æƒé™ã€‚

æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª C ç¨‹åºï¼Œç¼–è¯‘åŽå¯ä»¥ç›´æŽ¥æ‰§è¡Œä¸€ä¸ªå…·æœ‰ root æƒé™çš„ bash shellã€‚æ”»å‡»è€…éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«æ­¤æ¶æ„ç¨‹åºçš„å¯å†™ç›®å½•ï¼Œç„¶åŽä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†æ­¤ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚ä¹‹åŽï¼Œå½“ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œæ”»å‡»è€…æ”¾ç½®çš„æ¶æ„ç¨‹åºï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

ä»£ç ä¸­æ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚å®ƒåªæ˜¯ç®€å•åœ°è®¾ç½® uid å’Œ gid ä¸º 0ï¼Œç„¶åŽæ‰§è¡Œ /bin/bashã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º0%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1.  åˆ©ç”¨éœ€è¦å…ˆèŽ·å¾—ä¸€ä¸ªnetdataè½¯ä»¶çš„ä½Žæƒé™è´¦å·ã€‚
2.  åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ç¨‹åºï¼ˆä¾‹å¦‚ POC ä¸­çš„ C ç¨‹åºç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„å¯å†™ç›®å½•ã€‚
3.  ä¿®æ”¹ PATH çŽ¯å¢ƒå˜é‡ï¼Œå°†è¯¥ç›®å½•æ·»åŠ åˆ° PATH çš„æœ€å‰é¢ã€‚
4.  è§¦å‘ ndsudo æ‰§è¡Œä»»ä½•å¤–éƒ¨å‘½ä»¤ï¼Œè¿™å°†å¯¼è‡´æ¶æ„ç¨‹åºä»¥ root æƒé™æ‰§è¡Œï¼Œä»Žè€ŒèŽ·å¾— root shellã€‚

**é¡¹ç›®åœ°å€:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**æ¼æ´žè¯¦æƒ…:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

