# CVE-2024-32019

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-local权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** netdata

**危害等级:** 高危，可导致root权限获取

**影响版本:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统运行受影响版本的netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是netdata中ndsudo工具的一个本地权限提升漏洞。该漏洞是由于ndsudo以root权限运行，并且其搜索路径受到PATH环境变量的影响。攻击者可以通过修改PATH环境变量，将指向恶意程序的路径添加到ndsudo的搜索路径中，当ndsudo执行外部命令时，会优先执行攻击者提供的恶意程序，从而获得root权限。

漏洞利用方式：
1.  攻击者创建一个恶意的可执行文件，该文件包含提升权限的代码。
2.  攻击者修改PATH环境变量，将包含恶意可执行文件的目录添加到PATH中。
3.  攻击者触发ndsudo执行外部命令。由于PATH被修改，ndsudo会执行攻击者提供的恶意可执行文件。
4.  攻击者获得root权限。

根据提供的漏洞利用代码`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`，该代码实际上是针对XWiki的漏洞利用脚本，与CVE-2024-32019漏洞描述不符。因此，提供的代码**不能**直接用于利用CVE-2024-32019。

**投毒风险评估：**
由于只提供了`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`和`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` 两个文件，仅从这两个文件无法判断是否存在投毒代码。`exploitXWiki.py` 本身是漏洞利用代码，并非恶意后门。因此，可以认为该代码仓库中存在作者隐藏的投毒代码的风险较低，风险概率为 0%。

**项目地址:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**来源**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-local权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** netdata

**危害等级:** 高危，可导致root权限获取

**影响版本:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统运行受影响版本的netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是netdata中ndsudo工具的一个本地权限提升漏洞。该漏洞是由于ndsudo以root权限运行，并且其搜索路径受到PATH环境变量的影响。攻击者可以通过修改PATH环境变量，将指向恶意程序的路径添加到ndsudo的搜索路径中，当ndsudo执行外部命令时，会优先执行攻击者提供的恶意程序，从而获得root权限。

漏洞利用方式：
1.  攻击者创建一个恶意的可执行文件，该文件包含提升权限的代码。
2.  攻击者修改PATH环境变量，将包含恶意可执行文件的目录添加到PATH中。
3.  攻击者触发ndsudo执行外部命令。由于PATH被修改，ndsudo会执行攻击者提供的恶意可执行文件。
4.  攻击者获得root权限。

根据提供的漏洞利用代码`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`，该代码实际上是针对XWiki的漏洞利用脚本，与CVE-2024-32019漏洞描述不符。因此，提供的代码**不能**直接用于利用CVE-2024-32019。

**投毒风险评估：**
由于只提供了`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`和`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` 两个文件，仅从这两个文件无法判断是否存在投毒代码。`exploitXWiki.py` 本身是漏洞利用代码，并非恶意后门。因此，可以认为该代码仓库中存在作者隐藏的投毒代码的风险较低，风险概率为 0%。

**项目地址:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**来源**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-local权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** netdata

**危害等级:** 高危，可导致root权限获取

**影响版本:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统运行受影响版本的netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是netdata中ndsudo工具的一个本地权限提升漏洞。该漏洞是由于ndsudo以root权限运行，并且其搜索路径受到PATH环境变量的影响。攻击者可以通过修改PATH环境变量，将指向恶意程序的路径添加到ndsudo的搜索路径中，当ndsudo执行外部命令时，会优先执行攻击者提供的恶意程序，从而获得root权限。

漏洞利用方式：
1.  攻击者创建一个恶意的可执行文件，该文件包含提升权限的代码。
2.  攻击者修改PATH环境变量，将包含恶意可执行文件的目录添加到PATH中。
3.  攻击者触发ndsudo执行外部命令。由于PATH被修改，ndsudo会执行攻击者提供的恶意可执行文件。
4.  攻击者获得root权限。

根据提供的漏洞利用代码`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`，该代码实际上是针对XWiki的漏洞利用脚本，与CVE-2024-32019漏洞描述不符。因此，提供的代码**不能**直接用于利用CVE-2024-32019。

**投毒风险评估：**
由于只提供了`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`和`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` 两个文件，仅从这两个文件无法判断是否存在投毒代码。`exploitXWiki.py` 本身是漏洞利用代码，并非恶意后门。因此，可以认为该代码仓库中存在作者隐藏的投毒代码的风险较低，风险概率为 0%。

**项目地址:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**来源**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-local权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** netdata

**危害等级:** 高危，可导致root权限获取

**影响版本:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统运行受影响版本的netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是netdata中ndsudo工具的一个本地权限提升漏洞。该漏洞是由于ndsudo以root权限运行，并且其搜索路径受到PATH环境变量的影响。攻击者可以通过修改PATH环境变量，将指向恶意程序的路径添加到ndsudo的搜索路径中，当ndsudo执行外部命令时，会优先执行攻击者提供的恶意程序，从而获得root权限。

漏洞利用方式：
1.  攻击者创建一个恶意的可执行文件，该文件包含提升权限的代码。
2.  攻击者修改PATH环境变量，将包含恶意可执行文件的目录添加到PATH中。
3.  攻击者触发ndsudo执行外部命令。由于PATH被修改，ndsudo会执行攻击者提供的恶意可执行文件。
4.  攻击者获得root权限。

根据提供的漏洞利用代码`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`，该代码实际上是针对XWiki的漏洞利用脚本，与CVE-2024-32019漏洞描述不符。因此，提供的代码**不能**直接用于利用CVE-2024-32019。

**投毒风险评估：**
由于只提供了`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`和`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` 两个文件，仅从这两个文件无法判断是否存在投毒代码。`exploitXWiki.py` 本身是漏洞利用代码，并非恶意后门。因此，可以认为该代码仓库中存在作者隐藏的投毒代码的风险较低，风险概率为 0%。

**项目地址:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**来源**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-local权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** netdata

**危害等级:** 高危，可导致root权限获取

**影响版本:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统运行受影响版本的netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是netdata中ndsudo工具的一个本地权限提升漏洞。该漏洞是由于ndsudo以root权限运行，并且其搜索路径受到PATH环境变量的影响。攻击者可以通过修改PATH环境变量，将指向恶意程序的路径添加到ndsudo的搜索路径中，当ndsudo执行外部命令时，会优先执行攻击者提供的恶意程序，从而获得root权限。

漏洞利用方式：
1.  攻击者创建一个恶意的可执行文件，该文件包含提升权限的代码。
2.  攻击者修改PATH环境变量，将包含恶意可执行文件的目录添加到PATH中。
3.  攻击者触发ndsudo执行外部命令。由于PATH被修改，ndsudo会执行攻击者提供的恶意可执行文件。
4.  攻击者获得root权限。

根据提供的漏洞利用代码`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`，该代码实际上是针对XWiki的漏洞利用脚本，与CVE-2024-32019漏洞描述不符。因此，提供的代码**不能**直接用于利用CVE-2024-32019。

**投毒风险评估：**
由于只提供了`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`和`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` 两个文件，仅从这两个文件无法判断是否存在投毒代码。`exploitXWiki.py` 本身是漏洞利用代码，并非恶意后门。因此，可以认为该代码仓库中存在作者隐藏的投毒代码的风险较低，风险概率为 0%。

**项目地址:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**来源**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-local权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** netdata

**危害等级:** 高危，可导致root权限获取

**影响版本:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统运行受影响版本的netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是netdata中ndsudo工具的一个本地权限提升漏洞。该漏洞是由于ndsudo以root权限运行，并且其搜索路径受到PATH环境变量的影响。攻击者可以通过修改PATH环境变量，将指向恶意程序的路径添加到ndsudo的搜索路径中，当ndsudo执行外部命令时，会优先执行攻击者提供的恶意程序，从而获得root权限。

漏洞利用方式：
1.  攻击者创建一个恶意的可执行文件，该文件包含提升权限的代码。
2.  攻击者修改PATH环境变量，将包含恶意可执行文件的目录添加到PATH中。
3.  攻击者触发ndsudo执行外部命令。由于PATH被修改，ndsudo会执行攻击者提供的恶意可执行文件。
4.  攻击者获得root权限。

根据提供的漏洞利用代码`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`，该代码实际上是针对XWiki的漏洞利用脚本，与CVE-2024-32019漏洞描述不符。因此，提供的代码**不能**直接用于利用CVE-2024-32019。

**投毒风险评估：**
由于只提供了`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`和`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` 两个文件，仅从这两个文件无法判断是否存在投毒代码。`exploitXWiki.py` 本身是漏洞利用代码，并非恶意后门。因此，可以认为该代码仓库中存在作者隐藏的投毒代码的风险较低，风险概率为 0%。

**项目地址:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**来源**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-local权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** netdata

**危害等级:** 高危，可导致root权限获取

**影响版本:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统运行受影响版本的netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是netdata中ndsudo工具的一个本地权限提升漏洞。该漏洞是由于ndsudo以root权限运行，并且其搜索路径受到PATH环境变量的影响。攻击者可以通过修改PATH环境变量，将指向恶意程序的路径添加到ndsudo的搜索路径中，当ndsudo执行外部命令时，会优先执行攻击者提供的恶意程序，从而获得root权限。

漏洞利用方式：
1.  攻击者创建一个恶意的可执行文件，该文件包含提升权限的代码。
2.  攻击者修改PATH环境变量，将包含恶意可执行文件的目录添加到PATH中。
3.  攻击者触发ndsudo执行外部命令。由于PATH被修改，ndsudo会执行攻击者提供的恶意可执行文件。
4.  攻击者获得root权限。

根据提供的漏洞利用代码`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`，该代码实际上是针对XWiki的漏洞利用脚本，与CVE-2024-32019漏洞描述不符。因此，提供的代码**不能**直接用于利用CVE-2024-32019。

**投毒风险评估：**
由于只提供了`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`和`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` 两个文件，仅从这两个文件无法判断是否存在投毒代码。`exploitXWiki.py` 本身是漏洞利用代码，并非恶意后门。因此，可以认为该代码仓库中存在作者隐藏的投毒代码的风险较低，风险概率为 0%。

**项目地址:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**来源**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-local权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** netdata

**危害等级:** 高危，可导致root权限获取

**影响版本:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统运行受影响版本的netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是netdata中ndsudo工具的一个本地权限提升漏洞。该漏洞是由于ndsudo以root权限运行，并且其搜索路径受到PATH环境变量的影响。攻击者可以通过修改PATH环境变量，将指向恶意程序的路径添加到ndsudo的搜索路径中，当ndsudo执行外部命令时，会优先执行攻击者提供的恶意程序，从而获得root权限。

漏洞利用方式：
1.  攻击者创建一个恶意的可执行文件，该文件包含提升权限的代码。
2.  攻击者修改PATH环境变量，将包含恶意可执行文件的目录添加到PATH中。
3.  攻击者触发ndsudo执行外部命令。由于PATH被修改，ndsudo会执行攻击者提供的恶意可执行文件。
4.  攻击者获得root权限。

根据提供的漏洞利用代码`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`，该代码实际上是针对XWiki的漏洞利用脚本，与CVE-2024-32019漏洞描述不符。因此，提供的代码**不能**直接用于利用CVE-2024-32019。

**投毒风险评估：**
由于只提供了`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`和`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` 两个文件，仅从这两个文件无法判断是否存在投毒代码。`exploitXWiki.py` 本身是漏洞利用代码，并非恶意后门。因此，可以认为该代码仓库中存在作者隐藏的投毒代码的风险较低，风险概率为 0%。

**项目地址:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**来源**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-local权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** netdata

**危害等级:** 高危，可导致root权限获取

**影响版本:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统运行受影响版本的netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是netdata中ndsudo工具的一个本地权限提升漏洞。该漏洞是由于ndsudo以root权限运行，并且其搜索路径受到PATH环境变量的影响。攻击者可以通过修改PATH环境变量，将指向恶意程序的路径添加到ndsudo的搜索路径中，当ndsudo执行外部命令时，会优先执行攻击者提供的恶意程序，从而获得root权限。

漏洞利用方式：
1.  攻击者创建一个恶意的可执行文件，该文件包含提升权限的代码。
2.  攻击者修改PATH环境变量，将包含恶意可执行文件的目录添加到PATH中。
3.  攻击者触发ndsudo执行外部命令。由于PATH被修改，ndsudo会执行攻击者提供的恶意可执行文件。
4.  攻击者获得root权限。

根据提供的漏洞利用代码`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`，该代码实际上是针对XWiki的漏洞利用脚本，与CVE-2024-32019漏洞描述不符。因此，提供的代码**不能**直接用于利用CVE-2024-32019。

**投毒风险评估：**
由于只提供了`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`和`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` 两个文件，仅从这两个文件无法判断是否存在投毒代码。`exploitXWiki.py` 本身是漏洞利用代码，并非恶意后门。因此，可以认为该代码仓库中存在作者隐藏的投毒代码的风险较低，风险概率为 0%。

**项目地址:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**来源**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-local权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** netdata

**危害等级:** 高危，可导致root权限获取

**影响版本:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统运行受影响版本的netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是netdata中ndsudo工具的一个本地权限提升漏洞。该漏洞是由于ndsudo以root权限运行，并且其搜索路径受到PATH环境变量的影响。攻击者可以通过修改PATH环境变量，将指向恶意程序的路径添加到ndsudo的搜索路径中，当ndsudo执行外部命令时，会优先执行攻击者提供的恶意程序，从而获得root权限。

漏洞利用方式：
1.  攻击者创建一个恶意的可执行文件，该文件包含提升权限的代码。
2.  攻击者修改PATH环境变量，将包含恶意可执行文件的目录添加到PATH中。
3.  攻击者触发ndsudo执行外部命令。由于PATH被修改，ndsudo会执行攻击者提供的恶意可执行文件。
4.  攻击者获得root权限。

根据提供的漏洞利用代码`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`，该代码实际上是针对XWiki的漏洞利用脚本，与CVE-2024-32019漏洞描述不符。因此，提供的代码**不能**直接用于利用CVE-2024-32019。

**投毒风险评估：**
由于只提供了`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`和`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` 两个文件，仅从这两个文件无法判断是否存在投毒代码。`exploitXWiki.py` 本身是漏洞利用代码，并非恶意后门。因此，可以认为该代码仓库中存在作者隐藏的投毒代码的风险较低，风险概率为 0%。

**项目地址:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**来源**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-local权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** netdata

**危害等级:** 高危，可导致root权限获取

**影响版本:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统运行受影响版本的netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是netdata中ndsudo工具的一个本地权限提升漏洞。该漏洞是由于ndsudo以root权限运行，并且其搜索路径受到PATH环境变量的影响。攻击者可以通过修改PATH环境变量，将指向恶意程序的路径添加到ndsudo的搜索路径中，当ndsudo执行外部命令时，会优先执行攻击者提供的恶意程序，从而获得root权限。

漏洞利用方式：
1.  攻击者创建一个恶意的可执行文件，该文件包含提升权限的代码。
2.  攻击者修改PATH环境变量，将包含恶意可执行文件的目录添加到PATH中。
3.  攻击者触发ndsudo执行外部命令。由于PATH被修改，ndsudo会执行攻击者提供的恶意可执行文件。
4.  攻击者获得root权限。

根据提供的漏洞利用代码`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`，该代码实际上是针对XWiki的漏洞利用脚本，与CVE-2024-32019漏洞描述不符。因此，提供的代码**不能**直接用于利用CVE-2024-32019。

**投毒风险评估：**
由于只提供了`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`和`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` 两个文件，仅从这两个文件无法判断是否存在投毒代码。`exploitXWiki.py` 本身是漏洞利用代码，并非恶意后门。因此，可以认为该代码仓库中存在作者隐藏的投毒代码的风险较低，风险概率为 0%。

**项目地址:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**来源**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-local权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** netdata

**危害等级:** 高危，可导致root权限获取

**影响版本:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统运行受影响版本的netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是netdata中ndsudo工具的一个本地权限提升漏洞。该漏洞是由于ndsudo以root权限运行，并且其搜索路径受到PATH环境变量的影响。攻击者可以通过修改PATH环境变量，将指向恶意程序的路径添加到ndsudo的搜索路径中，当ndsudo执行外部命令时，会优先执行攻击者提供的恶意程序，从而获得root权限。

漏洞利用方式：
1.  攻击者创建一个恶意的可执行文件，该文件包含提升权限的代码。
2.  攻击者修改PATH环境变量，将包含恶意可执行文件的目录添加到PATH中。
3.  攻击者触发ndsudo执行外部命令。由于PATH被修改，ndsudo会执行攻击者提供的恶意可执行文件。
4.  攻击者获得root权限。

根据提供的漏洞利用代码`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`，该代码实际上是针对XWiki的漏洞利用脚本，与CVE-2024-32019漏洞描述不符。因此，提供的代码**不能**直接用于利用CVE-2024-32019。

**投毒风险评估：**
由于只提供了`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`和`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` 两个文件，仅从这两个文件无法判断是否存在投毒代码。`exploitXWiki.py` 本身是漏洞利用代码，并非恶意后门。因此，可以认为该代码仓库中存在作者隐藏的投毒代码的风险较低，风险概率为 0%。

**项目地址:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**来源**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-local权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** netdata

**危害等级:** 高危，可导致root权限获取

**影响版本:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统运行受影响版本的netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是netdata中ndsudo工具的一个本地权限提升漏洞。该漏洞是由于ndsudo以root权限运行，并且其搜索路径受到PATH环境变量的影响。攻击者可以通过修改PATH环境变量，将指向恶意程序的路径添加到ndsudo的搜索路径中，当ndsudo执行外部命令时，会优先执行攻击者提供的恶意程序，从而获得root权限。

漏洞利用方式：
1.  攻击者创建一个恶意的可执行文件，该文件包含提升权限的代码。
2.  攻击者修改PATH环境变量，将包含恶意可执行文件的目录添加到PATH中。
3.  攻击者触发ndsudo执行外部命令。由于PATH被修改，ndsudo会执行攻击者提供的恶意可执行文件。
4.  攻击者获得root权限。

根据提供的漏洞利用代码`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`，该代码实际上是针对XWiki的漏洞利用脚本，与CVE-2024-32019漏洞描述不符。因此，提供的代码**不能**直接用于利用CVE-2024-32019。

**投毒风险评估：**
由于只提供了`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`和`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` 两个文件，仅从这两个文件无法判断是否存在投毒代码。`exploitXWiki.py` 本身是漏洞利用代码，并非恶意后门。因此，可以认为该代码仓库中存在作者隐藏的投毒代码的风险较低，风险概率为 0%。

**项目地址:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**来源**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

# CVE-2024-32019

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md](../2024/CVE-2024-32019-80Ottanta80_CVE-2024-32019-PoC.md)

## CVE-2024-32019-netdata-local权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** netdata

**危害等级:** 高危，可导致root权限获取

**影响版本:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统运行受影响版本的netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是netdata中ndsudo工具的一个本地权限提升漏洞。该漏洞是由于ndsudo以root权限运行，并且其搜索路径受到PATH环境变量的影响。攻击者可以通过修改PATH环境变量，将指向恶意程序的路径添加到ndsudo的搜索路径中，当ndsudo执行外部命令时，会优先执行攻击者提供的恶意程序，从而获得root权限。

漏洞利用方式：
1.  攻击者创建一个恶意的可执行文件，该文件包含提升权限的代码。
2.  攻击者修改PATH环境变量，将包含恶意可执行文件的目录添加到PATH中。
3.  攻击者触发ndsudo执行外部命令。由于PATH被修改，ndsudo会执行攻击者提供的恶意可执行文件。
4.  攻击者获得root权限。

根据提供的漏洞利用代码`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`，该代码实际上是针对XWiki的漏洞利用脚本，与CVE-2024-32019漏洞描述不符。因此，提供的代码**不能**直接用于利用CVE-2024-32019。

**投毒风险评估：**
由于只提供了`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`和`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` 两个文件，仅从这两个文件无法判断是否存在投毒代码。`exploitXWiki.py` 本身是漏洞利用代码，并非恶意后门。因此，可以认为该代码仓库中存在作者隐藏的投毒代码的风险较低，风险概率为 0%。

**项目地址:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #2

**来源**: [CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AliElKhatteb_CVE-2024-32019-POC.md)

## CVE-2024-32019 - Netdata ndsudo 本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata agent运行在受影响的版本，且攻击者需要能够写入文件系统并执行程序。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32019 漏洞是 Netdata Agent 中 `ndsudo` 工具的本地提权漏洞。`ndsudo` 是一个 SUID root 的程序，用于以 root 权限执行某些命令。漏洞的根源在于 `ndsudo` 使用了用户可控的 `PATH` 环境变量来查找要执行的命令。攻击者可以通过在 `PATH` 中添加一个指向恶意目录的路径，然后在该目录中放置一个与 `ndsudo` 将要执行的命令同名的恶意程序，当 `ndsudo` 尝试执行该命令时，实际上会执行攻击者的恶意程序，从而获得 root 权限。

**漏洞利用有效性：**

提供的 PoC 代码是有效的。它包含一个 exploit.c 文件，编译后会生成一个可执行文件。这个可执行文件会将当前用户的 UID 和 GID 设置为 0 (root)，然后执行一个反弹 shell 到攻击者指定的 IP 地址和端口上。利用步骤如下：

1.  编译 exploit.c 文件。
2.  将编译后的可执行文件上传到目标机器上，并赋予执行权限。
3.  修改 `PATH` 环境变量，使其包含可执行文件所在的目录。
4.  调用 `ndsudo` 执行 `nvme-list` 命令，由于 `PATH` 被修改，`ndsudo` 实际上会执行攻击者上传的可执行文件，从而获得 root 权限。

**投毒风险分析：**

PoC 代码本身存在一定投毒风险，风险评估为10%。主要风险点在于 `exploit.c` 文件中的硬编码 IP 地址 `ADD_YOU_IP_ADDRESS` 和端口 `9001`。如果攻击者直接使用这个 PoC，而没有修改 IP 地址，可能会导致攻击失败，甚至暴露攻击者的 IP 地址。此外，反弹 shell 的方式本身也可能被防火墙或其他安全设备阻止。另外一种风险在于编译过程中可能引入恶意代码。总体来说，风险较低，但使用者应谨慎。

**漏洞利用方式：**

1.  **编译恶意程序：** 攻击者编写一个恶意程序，例如反弹 shell 或执行任意命令。  PoC 中的 `exploit.c` 就是这样一个恶意程序。
2.  **上传恶意程序：** 将编译后的恶意程序上传到目标机器上，攻击者具有写入权限的目录。
3.  **修改 PATH 环境变量：**  修改 `PATH` 环境变量，将包含恶意程序的目录添加到 `PATH` 的最前面。  例如 `PATH=$(pwd):$PATH`。
4.  **触发 ndsudo：**  调用 `ndsudo` 执行某个允许的命令，例如 `nvme-list`。 由于 `PATH` 被篡改，`ndsudo` 将会执行攻击者上传的恶意程序，而不是原有的系统命令。
5.  **获得 root 权限：**  恶意程序被执行，攻击者获得 root 权限。

**项目地址:** [AliElKhatteb/CVE-2024-32019-POC](https://github.com/AliElKhatteb/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #3

**来源**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 及 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的netdata，且具有本地shell访问权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 存在于Netdata的`ndsudo`工具中，该工具是具有SUID root权限的可执行文件。漏洞原因是`ndsudo`的搜索路径由`PATH`环境变量控制，攻击者可以通过修改`PATH`环境变量，将恶意程序放置在前面，当`ndsudo`执行信任的命令时，会执行攻击者放置的恶意程序，从而实现本地提权。提供的POC代码通过以下步骤利用该漏洞：

1.  **编译恶意payload:**  `poc.c` 编译成 `nvme`，该程序的功能是执行 `/bin/bash`，并设置 UID 和 GID 为 0，即root权限。
2.  **传输payload到目标系统:**  将编译好的`nvme`上传到目标系统的`/tmp`目录。
3.  **准备payload执行:**  给`/tmp/nvme`添加可执行权限，然后将`/tmp`添加到`PATH`环境变量的最前面。
4.  **触发`ndsudo`执行payload:** 运行`./ndsudo nvme-list`，`ndsudo`会执行`/tmp/nvme`，由于该程序会将权限提升为root，因此攻击者可以获得root shell。

**有效性：** 该POC代码描述的利用方式是有效的。

**投毒风险：** 提供的`poc.c`代码功能清晰，仅为执行`/bin/bash`并提升权限，不存在隐藏的投毒代码。README文件描述了完整的利用过程。因此，投毒风险为0%。

**利用方式：** 攻击者通过控制`PATH`环境变量，欺骗`ndsudo`执行恶意程序，从而获得root权限。

**项目地址:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**来源**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.44.0-60, < 1.45.3

**利用条件:** 需要netdata agent存在漏洞版本且ndsudo被调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019是Netdata Agent中ndsudo工具的一个本地权限提升漏洞。ndsudo是一个root用户拥有的、设置了SUID位的可执行文件。它本应只运行一组受限的外部命令，但是其搜索路径由PATH环境变量控制。攻击者可以通过控制PATH环境变量来指定ndsudo查找这些命令的位置，如果这个位置是攻击者具有写权限的目录，那么攻击者就可以放置恶意程序并以root权限执行。

**有效性：** 根据漏洞描述和搜索结果，该漏洞存在利用价值，通过控制PATH环境变量来执行恶意程序达到提权效果。

**投毒风险：** 提供的代码仅为GNU GENERAL PUBLIC LICENSE，是开源协议许可，不包含直接的攻击payload或恶意代码。但license本身也是一种代码，如果结合特定的上下文，协议内容也可能被滥用。例如，攻击者可能创建一个合法的程序，但其行为违反了协议条款，从而造成损害。此仓库中发现直接投毒代码的概率较低，但存在潜在的滥用风险，估计投毒风险为5%。

**利用方式：**
1.  确定目标系统上运行的Netdata Agent版本在受影响范围内（>= 1.44.0-60, < 1.45.3）。
2.  查找ndsudo工具的位置。
3.  创建一个包含恶意命令的目录，例如/tmp/evil。
4.  将恶意程序（如反弹shell）放置到/tmp/evil目录下，并命名为ndsudo尝试执行的命令（例如，`ping`，`date` 等, 具体取决于 ndsudo 允许执行的命令）。
5.  修改PATH环境变量，将/tmp/evil添加到PATH的最前面：`export PATH=/tmp/evil:$PATH`。
6.  运行ndsudo，它将执行/tmp/evil目录下的恶意程序，从而获得root权限。

**项目地址:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**来源**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户通过PATH劫持执行任意代码

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata Agent存在ndsudo，且版本在受影响范围内，以及可控的PATH环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是Netdata中`ndsudo`工具的一个本地提权漏洞。`ndsudo`是一个具有SUID root权限的可执行文件，但它使用`PATH`环境变量来查找要执行的命令。攻击者可以通过将恶意可执行文件放置在`PATH`环境变量中优先于系统目录的位置，诱使`ndsudo`执行该恶意程序，从而获得root权限。

**漏洞利用方式：**
1.  查找具有SUID权限的`ndsudo`可执行文件的路径。
2.  创建一个恶意的可执行文件(例如`nvme`)，该文件执行攻击者希望执行的任意代码。提供的`payload.c`是一个简单的示例，它会生成一个root shell。
3.  修改`PATH`环境变量，将当前目录(或包含恶意可执行文件的目录)添加到`PATH`的开头。
4.  调用`ndsudo`，并指定一个它允许执行的命令(例如`nvme-list`)。由于`PATH`已经被修改，`ndsudo`会执行攻击者放置的恶意`nvme`可执行文件，从而以root权限执行任意代码。

**有效性：**
提供的PoC代码是有效的。它包含一个shell脚本，用于查找`ndsudo`，创建一个`nvme` payload，修改`PATH`，然后执行`ndsudo`。README.md文件描述了如何编译`payload.c`并使用脚本。

**投毒风险：**
查看了提供的三个文件内容，没有发现任何投毒代码。其中，CVE-2024-32019.sh脚本用于利用漏洞，payload.c用于编译恶意payload，README.md文件描述了漏洞和利用方法，都是正常的利用代码。
因此，投毒风险为0%。

**项目地址:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**来源**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统安装了受影响版本的Netdata

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32019是Netdata ndsudo工具中的一个本地权限提升漏洞。ndsudo是一个SUID root的程序，但它使用了PATH环境变量来查找要执行的外部命令，攻击者可以通过修改PATH环境变量指向一个自己可控的目录，并在该目录下放置恶意程序，当ndsudo执行外部命令时，会执行攻击者放置的恶意程序，从而获得root权限。

**漏洞利用方式：**

1.  **漏洞检测：** 首先，检查目标系统上是否存在`/opt`目录下的`ndsudo`程序，并且确认该程序是否为root所有且设置了SUID权限。同时，使用`strings`命令检查`ndsudo`程序中是否存在对`nvme`、`smartctl`、`hdparm`或`sensors`等外部命令的调用，如果存在，则说明该程序可能受到PATH环境变量的影响。
2.  **恶意程序编译：** 编译一个C程序，该程序的功能是设置UID和GID为0，然后执行`/bin/bash`，从而获取root shell。
3.  **恶意程序上传：** 通过SFTP将编译好的恶意程序上传到目标系统上的一个攻击者可控的目录，例如`/tmp`。
4.  **环境变量修改：** 修改PATH环境变量，将攻击者可控的目录添加到PATH环境变量的最前面，确保`ndsudo`程序在执行外部命令时首先在该目录下查找。
5.  **漏洞触发：** 执行`ndsudo`程序，当它调用外部命令时，会执行攻击者上传的恶意程序，从而获取root权限。
6.  **交互式Shell：** 漏洞利用代码提供交互式shell。

**投毒风险分析：**

此POC代码本身主要目的是为了验证漏洞，实现本地提权。但是，该脚本包含以下潜在的投毒风险：

*   **编译和传输恶意代码：** 脚本会自动编译C代码生成二进制文件，并上传到目标机器。虽然C代码的内容是提权，但如果恶意攻击者修改了C代码，就可能包含其他恶意行为，例如植入后门、收集信息等。
*   **远程执行代码：**  脚本通过ssh执行远程命令，存在被篡改的风险，可能执行额外的恶意操作。
*   **残留文件：** 编译后的二进制文件和上传的恶意程序可能在目标系统上留下痕迹，如果这些文件被恶意利用，可能会导致进一步的安全问题。

尽管存在这些风险，但总体来说，该POC代码的风险仍然可控，主要风险集中在代码的篡改和恶意利用上。为了降低风险，建议从可信的来源获取POC代码，并仔细检查代码内容，确保其没有恶意行为。此外，在测试完成后，应及时清理目标系统上的残留文件。

投毒风险预估为10%，因为代码相对简洁，主要功能是漏洞验证和利用，但仍然存在被篡改和恶意利用的可能性。

**项目地址:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**来源**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地shell访问，能够执行ndsudo命令

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-32019 是 Netdata 中 ndsudo 工具的一个本地权限提升漏洞。ndsudo 是一个 SUID root 的可执行文件，但它使用 PATH 环境变量来查找要执行的命令。攻击者可以通过将恶意脚本放置在 PATH 环境变量中优先级更高的目录中，并将其命名为 ndsudo 允许执行的命令（例如 nvme），来欺骗 ndsudo 执行该恶意脚本并获得 root 权限。

**有效性：**

提供的 POC 代码描述了一种利用此漏洞的有效方法。它包括以下步骤：

1.  创建一个恶意脚本（poc.py），该脚本执行提权操作（例如，启动一个 root shell）。
2.  将此脚本重命名为 ndsudo 允许执行的命令之一（例如 nvme）。
3.  将包含恶意脚本的目录添加到 PATH 环境变量的开头。
4.  运行 ndsudo nvme-list，这将导致 ndsudo 执行恶意脚本，从而获得 root 权限。

**投毒风险：**

提供的代码仓库本身投毒风险较低。`poc.py` 代码非常简单，仅包含提权执行bash的代码，不太可能存在隐藏的恶意代码。`README.md` 文件提供了清晰的漏洞利用说明。但用户仍然需要注意，在实际环境中，从不可信的来源下载或复制漏洞利用代码都存在一定的风险，需要仔细检查代码是否存在恶意行为，再执行。

**利用方式：**

1.  **漏洞原理：** `ndsudo` 以 root 权限运行，但其搜索命令的路径依赖于用户的 `PATH` 环境变量。
2.  **攻击步骤：**
    *   创建恶意脚本，该脚本执行提权操作（例如，启动一个 root shell）。
    *   将此脚本重命名为 `ndsudo` 允许执行的命令之一（通过 `ndsudo --help` 查看）。
    *   将包含恶意脚本的目录添加到 `PATH` 环境变量的开头，确保恶意脚本优先被搜索到。
    *   运行 `ndsudo <allowed_command>`，这将导致 `ndsudo` 执行恶意脚本，从而获得 root 权限。

**总结：**

该漏洞利用较为简单，POC 代码的有效性较高，但应注意来源不明的exploit代码的潜在投毒风险。该漏洞允许低权限用户通过操纵 `PATH` 环境变量，利用 SUID 程序 `ndsudo` 提升至 root 权限。务必及时升级 Netdata 版本以修复此漏洞。

**项目地址:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**来源**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata agent运行在受影响版本，且攻击者能够执行本地代码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具拥有 SUID 权限，允许执行某些特权命令。漏洞的根源在于 `ndsudo` 使用不安全的 PATH 环境变量来查找要执行的命令，攻击者可以通过在 PATH 中插入恶意程序，让 `ndsudo` 执行攻击者控制的代码，从而提升权限到 root。

**利用方式：**

1.  **查找 `ndsudo` 路径：** 通常位于 `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`，但需要通过 `find` 命令确认。
2.  **创建恶意程序：** 创建一个 C 程序，该程序调用 `setuid(0)` 和 `setgid(0)` 设置用户和组 ID 为 root，然后执行一个 shell (例如 `/bin/bash -p`)。需要使用 `gcc` 编译该程序，例如命名为 `arcconf`。
3.  **修改 PATH 环境变量：** 将包含恶意程序的目录添加到 PATH 环境变量的开头。例如，如果恶意程序位于 `/tmp` 目录下，则执行 `PATH=/tmp:$PATH`。
4.  **执行 `ndsudo` 命令：** 使用 `ndsudo` 执行它支持的命令，但该命令依赖于攻击者放置的恶意程序。例如，`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`。`ndsudo` 会尝试执行 `arcconf`，但由于 PATH 环境变量被修改，它会执行攻击者在 `/tmp` 目录下创建的恶意程序。
5.  **获得 root shell：** 如果一切顺利，攻击者将获得一个 root shell。

**投毒风险分析：**

提供的 POC 代码中，`arcconf.c` 的目的是创建一个提权的 shell，没有明显的投毒行为。 但从 github 下载预编译二进制文件 `arcconf` 时，存在一定的投毒风险。攻击者可能在预编译的二进制文件中植入恶意代码。考虑到从 github 上下载的二进制文件存在潜在风险，故投毒风险评估为5%。

**项目地址:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**来源**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo 本地权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户提升至 root 权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 和 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的 Netdata，且 ndsudo 工具设置了 SUID root 权限，并且攻击者可以执行 ndsudo。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具以 root 权限运行，但它使用 `PATH` 环境变量来查找要执行的命令。攻击者可以通过在 `PATH` 环境变量中添加一个指向恶意目录的路径，并在该目录中放置一个与 `ndsudo` 尝试执行的命令同名的恶意程序，从而以 root 权限执行任意代码。

**有效性:**

提供的 POC 代码是有效的。它展示了如何利用此漏洞。

**利用方式:**

1.  创建一个包含恶意程序（例如，反弹 shell）的目录。
2.  将恶意程序命名为 `ndsudo` 尝试执行的命令之一（例如，`nvme-list`）。
3.  将包含恶意程序的目录添加到 `PATH` 环境变量的开头。
4.  运行 `ndsudo` 命令。`ndsudo` 将执行恶意程序，从而使攻击者获得 root 权限。

**投毒风险:**

根据提供的代码分析，该仓库似乎主要提供了一个 checker 脚本来帮助安全研究人员和管理员识别和验证漏洞是否存在，旨在帮助防御者评估风险和验证补丁，而不是提供武器化的 PoC。因此，该仓库中存在作者隐藏的投毒代码的风险较低。

检查器代码会检查以下内容：

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (或安装位置) 的 SUID/所有权。
*   `PATH` 中早于常见系统路径的可写目录。
*   `ndsudo` 尝试执行的白名单子命令是否存在。
*   可选地运行 `ndsudo --test <subcommand>` 来打印已解析的命令而不执行它 (谨慎使用，先阅读代码)。

因此，**投毒风险评估为 0%**。


**项目地址:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**来源**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，攻击者可利用此漏洞获取root权限。

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 目标系统上运行受影响版本的netdata，且攻击者需要具有本地低权限账号。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 netdata 的 ndsudo 工具中，该工具以 root 权限运行，但其搜索路径由 PATH 环境变量控制。攻击者可以通过修改 PATH 环境变量，将恶意程序放置在 ndsudo 搜索路径中，当 ndsudo 调用外部命令时，会执行攻击者放置的恶意程序，从而获得 root 权限。

提供的 POC 代码是一个 C 程序，编译后可以直接执行一个具有 root 权限的 bash shell。攻击者需要首先创建一个包含此恶意程序的可写目录，然后修改 PATH 环境变量，将此目录添加到 PATH 的最前面。之后，当 ndsudo 执行任何外部命令时，都会首先执行攻击者放置的恶意程序，从而获得 root shell。

代码中没有发现明显的投毒行为。它只是简单地设置 uid 和 gid 为 0，然后执行 /bin/bash。因此，投毒风险评估为0%。

利用方式总结：
1.  利用需要先获得一个netdata软件的低权限账号。
2.  创建一个包含恶意程序（例如 POC 中的 C 程序编译后的可执行文件）的可写目录。
3.  修改 PATH 环境变量，将该目录添加到 PATH 的最前面。
4.  触发 ndsudo 执行任何外部命令，这将导致恶意程序以 root 权限执行，从而获得 root shell。

**项目地址:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**来源**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 及 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的netdata，且具有本地shell访问权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 存在于Netdata的`ndsudo`工具中，该工具是具有SUID root权限的可执行文件。漏洞原因是`ndsudo`的搜索路径由`PATH`环境变量控制，攻击者可以通过修改`PATH`环境变量，将恶意程序放置在前面，当`ndsudo`执行信任的命令时，会执行攻击者放置的恶意程序，从而实现本地提权。提供的POC代码通过以下步骤利用该漏洞：

1.  **编译恶意payload:**  `poc.c` 编译成 `nvme`，该程序的功能是执行 `/bin/bash`，并设置 UID 和 GID 为 0，即root权限。
2.  **传输payload到目标系统:**  将编译好的`nvme`上传到目标系统的`/tmp`目录。
3.  **准备payload执行:**  给`/tmp/nvme`添加可执行权限，然后将`/tmp`添加到`PATH`环境变量的最前面。
4.  **触发`ndsudo`执行payload:** 运行`./ndsudo nvme-list`，`ndsudo`会执行`/tmp/nvme`，由于该程序会将权限提升为root，因此攻击者可以获得root shell。

**有效性：** 该POC代码描述的利用方式是有效的。

**投毒风险：** 提供的`poc.c`代码功能清晰，仅为执行`/bin/bash`并提升权限，不存在隐藏的投毒代码。README文件描述了完整的利用过程。因此，投毒风险为0%。

**利用方式：** 攻击者通过控制`PATH`环境变量，欺骗`ndsudo`执行恶意程序，从而获得root权限。

**项目地址:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**来源**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.44.0-60, < 1.45.3

**利用条件:** 需要netdata agent存在漏洞版本且ndsudo被调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019是Netdata Agent中ndsudo工具的一个本地权限提升漏洞。ndsudo是一个root用户拥有的、设置了SUID位的可执行文件。它本应只运行一组受限的外部命令，但是其搜索路径由PATH环境变量控制。攻击者可以通过控制PATH环境变量来指定ndsudo查找这些命令的位置，如果这个位置是攻击者具有写权限的目录，那么攻击者就可以放置恶意程序并以root权限执行。

**有效性：** 根据漏洞描述和搜索结果，该漏洞存在利用价值，通过控制PATH环境变量来执行恶意程序达到提权效果。

**投毒风险：** 提供的代码仅为GNU GENERAL PUBLIC LICENSE，是开源协议许可，不包含直接的攻击payload或恶意代码。但license本身也是一种代码，如果结合特定的上下文，协议内容也可能被滥用。例如，攻击者可能创建一个合法的程序，但其行为违反了协议条款，从而造成损害。此仓库中发现直接投毒代码的概率较低，但存在潜在的滥用风险，估计投毒风险为5%。

**利用方式：**
1.  确定目标系统上运行的Netdata Agent版本在受影响范围内（>= 1.44.0-60, < 1.45.3）。
2.  查找ndsudo工具的位置。
3.  创建一个包含恶意命令的目录，例如/tmp/evil。
4.  将恶意程序（如反弹shell）放置到/tmp/evil目录下，并命名为ndsudo尝试执行的命令（例如，`ping`，`date` 等, 具体取决于 ndsudo 允许执行的命令）。
5.  修改PATH环境变量，将/tmp/evil添加到PATH的最前面：`export PATH=/tmp/evil:$PATH`。
6.  运行ndsudo，它将执行/tmp/evil目录下的恶意程序，从而获得root权限。

**项目地址:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**来源**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户通过PATH劫持执行任意代码

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata Agent存在ndsudo，且版本在受影响范围内，以及可控的PATH环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是Netdata中`ndsudo`工具的一个本地提权漏洞。`ndsudo`是一个具有SUID root权限的可执行文件，但它使用`PATH`环境变量来查找要执行的命令。攻击者可以通过将恶意可执行文件放置在`PATH`环境变量中优先于系统目录的位置，诱使`ndsudo`执行该恶意程序，从而获得root权限。

**漏洞利用方式：**
1.  查找具有SUID权限的`ndsudo`可执行文件的路径。
2.  创建一个恶意的可执行文件(例如`nvme`)，该文件执行攻击者希望执行的任意代码。提供的`payload.c`是一个简单的示例，它会生成一个root shell。
3.  修改`PATH`环境变量，将当前目录(或包含恶意可执行文件的目录)添加到`PATH`的开头。
4.  调用`ndsudo`，并指定一个它允许执行的命令(例如`nvme-list`)。由于`PATH`已经被修改，`ndsudo`会执行攻击者放置的恶意`nvme`可执行文件，从而以root权限执行任意代码。

**有效性：**
提供的PoC代码是有效的。它包含一个shell脚本，用于查找`ndsudo`，创建一个`nvme` payload，修改`PATH`，然后执行`ndsudo`。README.md文件描述了如何编译`payload.c`并使用脚本。

**投毒风险：**
查看了提供的三个文件内容，没有发现任何投毒代码。其中，CVE-2024-32019.sh脚本用于利用漏洞，payload.c用于编译恶意payload，README.md文件描述了漏洞和利用方法，都是正常的利用代码。
因此，投毒风险为0%。

**项目地址:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**来源**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统安装了受影响版本的Netdata

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32019是Netdata ndsudo工具中的一个本地权限提升漏洞。ndsudo是一个SUID root的程序，但它使用了PATH环境变量来查找要执行的外部命令，攻击者可以通过修改PATH环境变量指向一个自己可控的目录，并在该目录下放置恶意程序，当ndsudo执行外部命令时，会执行攻击者放置的恶意程序，从而获得root权限。

**漏洞利用方式：**

1.  **漏洞检测：** 首先，检查目标系统上是否存在`/opt`目录下的`ndsudo`程序，并且确认该程序是否为root所有且设置了SUID权限。同时，使用`strings`命令检查`ndsudo`程序中是否存在对`nvme`、`smartctl`、`hdparm`或`sensors`等外部命令的调用，如果存在，则说明该程序可能受到PATH环境变量的影响。
2.  **恶意程序编译：** 编译一个C程序，该程序的功能是设置UID和GID为0，然后执行`/bin/bash`，从而获取root shell。
3.  **恶意程序上传：** 通过SFTP将编译好的恶意程序上传到目标系统上的一个攻击者可控的目录，例如`/tmp`。
4.  **环境变量修改：** 修改PATH环境变量，将攻击者可控的目录添加到PATH环境变量的最前面，确保`ndsudo`程序在执行外部命令时首先在该目录下查找。
5.  **漏洞触发：** 执行`ndsudo`程序，当它调用外部命令时，会执行攻击者上传的恶意程序，从而获取root权限。
6.  **交互式Shell：** 漏洞利用代码提供交互式shell。

**投毒风险分析：**

此POC代码本身主要目的是为了验证漏洞，实现本地提权。但是，该脚本包含以下潜在的投毒风险：

*   **编译和传输恶意代码：** 脚本会自动编译C代码生成二进制文件，并上传到目标机器。虽然C代码的内容是提权，但如果恶意攻击者修改了C代码，就可能包含其他恶意行为，例如植入后门、收集信息等。
*   **远程执行代码：**  脚本通过ssh执行远程命令，存在被篡改的风险，可能执行额外的恶意操作。
*   **残留文件：** 编译后的二进制文件和上传的恶意程序可能在目标系统上留下痕迹，如果这些文件被恶意利用，可能会导致进一步的安全问题。

尽管存在这些风险，但总体来说，该POC代码的风险仍然可控，主要风险集中在代码的篡改和恶意利用上。为了降低风险，建议从可信的来源获取POC代码，并仔细检查代码内容，确保其没有恶意行为。此外，在测试完成后，应及时清理目标系统上的残留文件。

投毒风险预估为10%，因为代码相对简洁，主要功能是漏洞验证和利用，但仍然存在被篡改和恶意利用的可能性。

**项目地址:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**来源**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地shell访问，能够执行ndsudo命令

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-32019 是 Netdata 中 ndsudo 工具的一个本地权限提升漏洞。ndsudo 是一个 SUID root 的可执行文件，但它使用 PATH 环境变量来查找要执行的命令。攻击者可以通过将恶意脚本放置在 PATH 环境变量中优先级更高的目录中，并将其命名为 ndsudo 允许执行的命令（例如 nvme），来欺骗 ndsudo 执行该恶意脚本并获得 root 权限。

**有效性：**

提供的 POC 代码描述了一种利用此漏洞的有效方法。它包括以下步骤：

1.  创建一个恶意脚本（poc.py），该脚本执行提权操作（例如，启动一个 root shell）。
2.  将此脚本重命名为 ndsudo 允许执行的命令之一（例如 nvme）。
3.  将包含恶意脚本的目录添加到 PATH 环境变量的开头。
4.  运行 ndsudo nvme-list，这将导致 ndsudo 执行恶意脚本，从而获得 root 权限。

**投毒风险：**

提供的代码仓库本身投毒风险较低。`poc.py` 代码非常简单，仅包含提权执行bash的代码，不太可能存在隐藏的恶意代码。`README.md` 文件提供了清晰的漏洞利用说明。但用户仍然需要注意，在实际环境中，从不可信的来源下载或复制漏洞利用代码都存在一定的风险，需要仔细检查代码是否存在恶意行为，再执行。

**利用方式：**

1.  **漏洞原理：** `ndsudo` 以 root 权限运行，但其搜索命令的路径依赖于用户的 `PATH` 环境变量。
2.  **攻击步骤：**
    *   创建恶意脚本，该脚本执行提权操作（例如，启动一个 root shell）。
    *   将此脚本重命名为 `ndsudo` 允许执行的命令之一（通过 `ndsudo --help` 查看）。
    *   将包含恶意脚本的目录添加到 `PATH` 环境变量的开头，确保恶意脚本优先被搜索到。
    *   运行 `ndsudo <allowed_command>`，这将导致 `ndsudo` 执行恶意脚本，从而获得 root 权限。

**总结：**

该漏洞利用较为简单，POC 代码的有效性较高，但应注意来源不明的exploit代码的潜在投毒风险。该漏洞允许低权限用户通过操纵 `PATH` 环境变量，利用 SUID 程序 `ndsudo` 提升至 root 权限。务必及时升级 Netdata 版本以修复此漏洞。

**项目地址:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**来源**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata agent运行在受影响版本，且攻击者能够执行本地代码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具拥有 SUID 权限，允许执行某些特权命令。漏洞的根源在于 `ndsudo` 使用不安全的 PATH 环境变量来查找要执行的命令，攻击者可以通过在 PATH 中插入恶意程序，让 `ndsudo` 执行攻击者控制的代码，从而提升权限到 root。

**利用方式：**

1.  **查找 `ndsudo` 路径：** 通常位于 `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`，但需要通过 `find` 命令确认。
2.  **创建恶意程序：** 创建一个 C 程序，该程序调用 `setuid(0)` 和 `setgid(0)` 设置用户和组 ID 为 root，然后执行一个 shell (例如 `/bin/bash -p`)。需要使用 `gcc` 编译该程序，例如命名为 `arcconf`。
3.  **修改 PATH 环境变量：** 将包含恶意程序的目录添加到 PATH 环境变量的开头。例如，如果恶意程序位于 `/tmp` 目录下，则执行 `PATH=/tmp:$PATH`。
4.  **执行 `ndsudo` 命令：** 使用 `ndsudo` 执行它支持的命令，但该命令依赖于攻击者放置的恶意程序。例如，`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`。`ndsudo` 会尝试执行 `arcconf`，但由于 PATH 环境变量被修改，它会执行攻击者在 `/tmp` 目录下创建的恶意程序。
5.  **获得 root shell：** 如果一切顺利，攻击者将获得一个 root shell。

**投毒风险分析：**

提供的 POC 代码中，`arcconf.c` 的目的是创建一个提权的 shell，没有明显的投毒行为。 但从 github 下载预编译二进制文件 `arcconf` 时，存在一定的投毒风险。攻击者可能在预编译的二进制文件中植入恶意代码。考虑到从 github 上下载的二进制文件存在潜在风险，故投毒风险评估为5%。

**项目地址:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**来源**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo 本地权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户提升至 root 权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 和 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的 Netdata，且 ndsudo 工具设置了 SUID root 权限，并且攻击者可以执行 ndsudo。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具以 root 权限运行，但它使用 `PATH` 环境变量来查找要执行的命令。攻击者可以通过在 `PATH` 环境变量中添加一个指向恶意目录的路径，并在该目录中放置一个与 `ndsudo` 尝试执行的命令同名的恶意程序，从而以 root 权限执行任意代码。

**有效性:**

提供的 POC 代码是有效的。它展示了如何利用此漏洞。

**利用方式:**

1.  创建一个包含恶意程序（例如，反弹 shell）的目录。
2.  将恶意程序命名为 `ndsudo` 尝试执行的命令之一（例如，`nvme-list`）。
3.  将包含恶意程序的目录添加到 `PATH` 环境变量的开头。
4.  运行 `ndsudo` 命令。`ndsudo` 将执行恶意程序，从而使攻击者获得 root 权限。

**投毒风险:**

根据提供的代码分析，该仓库似乎主要提供了一个 checker 脚本来帮助安全研究人员和管理员识别和验证漏洞是否存在，旨在帮助防御者评估风险和验证补丁，而不是提供武器化的 PoC。因此，该仓库中存在作者隐藏的投毒代码的风险较低。

检查器代码会检查以下内容：

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (或安装位置) 的 SUID/所有权。
*   `PATH` 中早于常见系统路径的可写目录。
*   `ndsudo` 尝试执行的白名单子命令是否存在。
*   可选地运行 `ndsudo --test <subcommand>` 来打印已解析的命令而不执行它 (谨慎使用，先阅读代码)。

因此，**投毒风险评估为 0%**。


**项目地址:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**来源**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，攻击者可利用此漏洞获取root权限。

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 目标系统上运行受影响版本的netdata，且攻击者需要具有本地低权限账号。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 netdata 的 ndsudo 工具中，该工具以 root 权限运行，但其搜索路径由 PATH 环境变量控制。攻击者可以通过修改 PATH 环境变量，将恶意程序放置在 ndsudo 搜索路径中，当 ndsudo 调用外部命令时，会执行攻击者放置的恶意程序，从而获得 root 权限。

提供的 POC 代码是一个 C 程序，编译后可以直接执行一个具有 root 权限的 bash shell。攻击者需要首先创建一个包含此恶意程序的可写目录，然后修改 PATH 环境变量，将此目录添加到 PATH 的最前面。之后，当 ndsudo 执行任何外部命令时，都会首先执行攻击者放置的恶意程序，从而获得 root shell。

代码中没有发现明显的投毒行为。它只是简单地设置 uid 和 gid 为 0，然后执行 /bin/bash。因此，投毒风险评估为0%。

利用方式总结：
1.  利用需要先获得一个netdata软件的低权限账号。
2.  创建一个包含恶意程序（例如 POC 中的 C 程序编译后的可执行文件）的可写目录。
3.  修改 PATH 环境变量，将该目录添加到 PATH 的最前面。
4.  触发 ndsudo 执行任何外部命令，这将导致恶意程序以 root 权限执行，从而获得 root shell。

**项目地址:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**来源**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 及 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的netdata，且具有本地shell访问权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 存在于Netdata的`ndsudo`工具中，该工具是具有SUID root权限的可执行文件。漏洞原因是`ndsudo`的搜索路径由`PATH`环境变量控制，攻击者可以通过修改`PATH`环境变量，将恶意程序放置在前面，当`ndsudo`执行信任的命令时，会执行攻击者放置的恶意程序，从而实现本地提权。提供的POC代码通过以下步骤利用该漏洞：

1.  **编译恶意payload:**  `poc.c` 编译成 `nvme`，该程序的功能是执行 `/bin/bash`，并设置 UID 和 GID 为 0，即root权限。
2.  **传输payload到目标系统:**  将编译好的`nvme`上传到目标系统的`/tmp`目录。
3.  **准备payload执行:**  给`/tmp/nvme`添加可执行权限，然后将`/tmp`添加到`PATH`环境变量的最前面。
4.  **触发`ndsudo`执行payload:** 运行`./ndsudo nvme-list`，`ndsudo`会执行`/tmp/nvme`，由于该程序会将权限提升为root，因此攻击者可以获得root shell。

**有效性：** 该POC代码描述的利用方式是有效的。

**投毒风险：** 提供的`poc.c`代码功能清晰，仅为执行`/bin/bash`并提升权限，不存在隐藏的投毒代码。README文件描述了完整的利用过程。因此，投毒风险为0%。

**利用方式：** 攻击者通过控制`PATH`环境变量，欺骗`ndsudo`执行恶意程序，从而获得root权限。

**项目地址:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**来源**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.44.0-60, < 1.45.3

**利用条件:** 需要netdata agent存在漏洞版本且ndsudo被调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019是Netdata Agent中ndsudo工具的一个本地权限提升漏洞。ndsudo是一个root用户拥有的、设置了SUID位的可执行文件。它本应只运行一组受限的外部命令，但是其搜索路径由PATH环境变量控制。攻击者可以通过控制PATH环境变量来指定ndsudo查找这些命令的位置，如果这个位置是攻击者具有写权限的目录，那么攻击者就可以放置恶意程序并以root权限执行。

**有效性：** 根据漏洞描述和搜索结果，该漏洞存在利用价值，通过控制PATH环境变量来执行恶意程序达到提权效果。

**投毒风险：** 提供的代码仅为GNU GENERAL PUBLIC LICENSE，是开源协议许可，不包含直接的攻击payload或恶意代码。但license本身也是一种代码，如果结合特定的上下文，协议内容也可能被滥用。例如，攻击者可能创建一个合法的程序，但其行为违反了协议条款，从而造成损害。此仓库中发现直接投毒代码的概率较低，但存在潜在的滥用风险，估计投毒风险为5%。

**利用方式：**
1.  确定目标系统上运行的Netdata Agent版本在受影响范围内（>= 1.44.0-60, < 1.45.3）。
2.  查找ndsudo工具的位置。
3.  创建一个包含恶意命令的目录，例如/tmp/evil。
4.  将恶意程序（如反弹shell）放置到/tmp/evil目录下，并命名为ndsudo尝试执行的命令（例如，`ping`，`date` 等, 具体取决于 ndsudo 允许执行的命令）。
5.  修改PATH环境变量，将/tmp/evil添加到PATH的最前面：`export PATH=/tmp/evil:$PATH`。
6.  运行ndsudo，它将执行/tmp/evil目录下的恶意程序，从而获得root权限。

**项目地址:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**来源**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户通过PATH劫持执行任意代码

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata Agent存在ndsudo，且版本在受影响范围内，以及可控的PATH环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是Netdata中`ndsudo`工具的一个本地提权漏洞。`ndsudo`是一个具有SUID root权限的可执行文件，但它使用`PATH`环境变量来查找要执行的命令。攻击者可以通过将恶意可执行文件放置在`PATH`环境变量中优先于系统目录的位置，诱使`ndsudo`执行该恶意程序，从而获得root权限。

**漏洞利用方式：**
1.  查找具有SUID权限的`ndsudo`可执行文件的路径。
2.  创建一个恶意的可执行文件(例如`nvme`)，该文件执行攻击者希望执行的任意代码。提供的`payload.c`是一个简单的示例，它会生成一个root shell。
3.  修改`PATH`环境变量，将当前目录(或包含恶意可执行文件的目录)添加到`PATH`的开头。
4.  调用`ndsudo`，并指定一个它允许执行的命令(例如`nvme-list`)。由于`PATH`已经被修改，`ndsudo`会执行攻击者放置的恶意`nvme`可执行文件，从而以root权限执行任意代码。

**有效性：**
提供的PoC代码是有效的。它包含一个shell脚本，用于查找`ndsudo`，创建一个`nvme` payload，修改`PATH`，然后执行`ndsudo`。README.md文件描述了如何编译`payload.c`并使用脚本。

**投毒风险：**
查看了提供的三个文件内容，没有发现任何投毒代码。其中，CVE-2024-32019.sh脚本用于利用漏洞，payload.c用于编译恶意payload，README.md文件描述了漏洞和利用方法，都是正常的利用代码。
因此，投毒风险为0%。

**项目地址:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**来源**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统安装了受影响版本的Netdata

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32019是Netdata ndsudo工具中的一个本地权限提升漏洞。ndsudo是一个SUID root的程序，但它使用了PATH环境变量来查找要执行的外部命令，攻击者可以通过修改PATH环境变量指向一个自己可控的目录，并在该目录下放置恶意程序，当ndsudo执行外部命令时，会执行攻击者放置的恶意程序，从而获得root权限。

**漏洞利用方式：**

1.  **漏洞检测：** 首先，检查目标系统上是否存在`/opt`目录下的`ndsudo`程序，并且确认该程序是否为root所有且设置了SUID权限。同时，使用`strings`命令检查`ndsudo`程序中是否存在对`nvme`、`smartctl`、`hdparm`或`sensors`等外部命令的调用，如果存在，则说明该程序可能受到PATH环境变量的影响。
2.  **恶意程序编译：** 编译一个C程序，该程序的功能是设置UID和GID为0，然后执行`/bin/bash`，从而获取root shell。
3.  **恶意程序上传：** 通过SFTP将编译好的恶意程序上传到目标系统上的一个攻击者可控的目录，例如`/tmp`。
4.  **环境变量修改：** 修改PATH环境变量，将攻击者可控的目录添加到PATH环境变量的最前面，确保`ndsudo`程序在执行外部命令时首先在该目录下查找。
5.  **漏洞触发：** 执行`ndsudo`程序，当它调用外部命令时，会执行攻击者上传的恶意程序，从而获取root权限。
6.  **交互式Shell：** 漏洞利用代码提供交互式shell。

**投毒风险分析：**

此POC代码本身主要目的是为了验证漏洞，实现本地提权。但是，该脚本包含以下潜在的投毒风险：

*   **编译和传输恶意代码：** 脚本会自动编译C代码生成二进制文件，并上传到目标机器。虽然C代码的内容是提权，但如果恶意攻击者修改了C代码，就可能包含其他恶意行为，例如植入后门、收集信息等。
*   **远程执行代码：**  脚本通过ssh执行远程命令，存在被篡改的风险，可能执行额外的恶意操作。
*   **残留文件：** 编译后的二进制文件和上传的恶意程序可能在目标系统上留下痕迹，如果这些文件被恶意利用，可能会导致进一步的安全问题。

尽管存在这些风险，但总体来说，该POC代码的风险仍然可控，主要风险集中在代码的篡改和恶意利用上。为了降低风险，建议从可信的来源获取POC代码，并仔细检查代码内容，确保其没有恶意行为。此外，在测试完成后，应及时清理目标系统上的残留文件。

投毒风险预估为10%，因为代码相对简洁，主要功能是漏洞验证和利用，但仍然存在被篡改和恶意利用的可能性。

**项目地址:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**来源**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地shell访问，能够执行ndsudo命令

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-32019 是 Netdata 中 ndsudo 工具的一个本地权限提升漏洞。ndsudo 是一个 SUID root 的可执行文件，但它使用 PATH 环境变量来查找要执行的命令。攻击者可以通过将恶意脚本放置在 PATH 环境变量中优先级更高的目录中，并将其命名为 ndsudo 允许执行的命令（例如 nvme），来欺骗 ndsudo 执行该恶意脚本并获得 root 权限。

**有效性：**

提供的 POC 代码描述了一种利用此漏洞的有效方法。它包括以下步骤：

1.  创建一个恶意脚本（poc.py），该脚本执行提权操作（例如，启动一个 root shell）。
2.  将此脚本重命名为 ndsudo 允许执行的命令之一（例如 nvme）。
3.  将包含恶意脚本的目录添加到 PATH 环境变量的开头。
4.  运行 ndsudo nvme-list，这将导致 ndsudo 执行恶意脚本，从而获得 root 权限。

**投毒风险：**

提供的代码仓库本身投毒风险较低。`poc.py` 代码非常简单，仅包含提权执行bash的代码，不太可能存在隐藏的恶意代码。`README.md` 文件提供了清晰的漏洞利用说明。但用户仍然需要注意，在实际环境中，从不可信的来源下载或复制漏洞利用代码都存在一定的风险，需要仔细检查代码是否存在恶意行为，再执行。

**利用方式：**

1.  **漏洞原理：** `ndsudo` 以 root 权限运行，但其搜索命令的路径依赖于用户的 `PATH` 环境变量。
2.  **攻击步骤：**
    *   创建恶意脚本，该脚本执行提权操作（例如，启动一个 root shell）。
    *   将此脚本重命名为 `ndsudo` 允许执行的命令之一（通过 `ndsudo --help` 查看）。
    *   将包含恶意脚本的目录添加到 `PATH` 环境变量的开头，确保恶意脚本优先被搜索到。
    *   运行 `ndsudo <allowed_command>`，这将导致 `ndsudo` 执行恶意脚本，从而获得 root 权限。

**总结：**

该漏洞利用较为简单，POC 代码的有效性较高，但应注意来源不明的exploit代码的潜在投毒风险。该漏洞允许低权限用户通过操纵 `PATH` 环境变量，利用 SUID 程序 `ndsudo` 提升至 root 权限。务必及时升级 Netdata 版本以修复此漏洞。

**项目地址:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**来源**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata agent运行在受影响版本，且攻击者能够执行本地代码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具拥有 SUID 权限，允许执行某些特权命令。漏洞的根源在于 `ndsudo` 使用不安全的 PATH 环境变量来查找要执行的命令，攻击者可以通过在 PATH 中插入恶意程序，让 `ndsudo` 执行攻击者控制的代码，从而提升权限到 root。

**利用方式：**

1.  **查找 `ndsudo` 路径：** 通常位于 `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`，但需要通过 `find` 命令确认。
2.  **创建恶意程序：** 创建一个 C 程序，该程序调用 `setuid(0)` 和 `setgid(0)` 设置用户和组 ID 为 root，然后执行一个 shell (例如 `/bin/bash -p`)。需要使用 `gcc` 编译该程序，例如命名为 `arcconf`。
3.  **修改 PATH 环境变量：** 将包含恶意程序的目录添加到 PATH 环境变量的开头。例如，如果恶意程序位于 `/tmp` 目录下，则执行 `PATH=/tmp:$PATH`。
4.  **执行 `ndsudo` 命令：** 使用 `ndsudo` 执行它支持的命令，但该命令依赖于攻击者放置的恶意程序。例如，`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`。`ndsudo` 会尝试执行 `arcconf`，但由于 PATH 环境变量被修改，它会执行攻击者在 `/tmp` 目录下创建的恶意程序。
5.  **获得 root shell：** 如果一切顺利，攻击者将获得一个 root shell。

**投毒风险分析：**

提供的 POC 代码中，`arcconf.c` 的目的是创建一个提权的 shell，没有明显的投毒行为。 但从 github 下载预编译二进制文件 `arcconf` 时，存在一定的投毒风险。攻击者可能在预编译的二进制文件中植入恶意代码。考虑到从 github 上下载的二进制文件存在潜在风险，故投毒风险评估为5%。

**项目地址:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**来源**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo 本地权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户提升至 root 权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 和 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的 Netdata，且 ndsudo 工具设置了 SUID root 权限，并且攻击者可以执行 ndsudo。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具以 root 权限运行，但它使用 `PATH` 环境变量来查找要执行的命令。攻击者可以通过在 `PATH` 环境变量中添加一个指向恶意目录的路径，并在该目录中放置一个与 `ndsudo` 尝试执行的命令同名的恶意程序，从而以 root 权限执行任意代码。

**有效性:**

提供的 POC 代码是有效的。它展示了如何利用此漏洞。

**利用方式:**

1.  创建一个包含恶意程序（例如，反弹 shell）的目录。
2.  将恶意程序命名为 `ndsudo` 尝试执行的命令之一（例如，`nvme-list`）。
3.  将包含恶意程序的目录添加到 `PATH` 环境变量的开头。
4.  运行 `ndsudo` 命令。`ndsudo` 将执行恶意程序，从而使攻击者获得 root 权限。

**投毒风险:**

根据提供的代码分析，该仓库似乎主要提供了一个 checker 脚本来帮助安全研究人员和管理员识别和验证漏洞是否存在，旨在帮助防御者评估风险和验证补丁，而不是提供武器化的 PoC。因此，该仓库中存在作者隐藏的投毒代码的风险较低。

检查器代码会检查以下内容：

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (或安装位置) 的 SUID/所有权。
*   `PATH` 中早于常见系统路径的可写目录。
*   `ndsudo` 尝试执行的白名单子命令是否存在。
*   可选地运行 `ndsudo --test <subcommand>` 来打印已解析的命令而不执行它 (谨慎使用，先阅读代码)。

因此，**投毒风险评估为 0%**。


**项目地址:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**来源**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，攻击者可利用此漏洞获取root权限。

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 目标系统上运行受影响版本的netdata，且攻击者需要具有本地低权限账号。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 netdata 的 ndsudo 工具中，该工具以 root 权限运行，但其搜索路径由 PATH 环境变量控制。攻击者可以通过修改 PATH 环境变量，将恶意程序放置在 ndsudo 搜索路径中，当 ndsudo 调用外部命令时，会执行攻击者放置的恶意程序，从而获得 root 权限。

提供的 POC 代码是一个 C 程序，编译后可以直接执行一个具有 root 权限的 bash shell。攻击者需要首先创建一个包含此恶意程序的可写目录，然后修改 PATH 环境变量，将此目录添加到 PATH 的最前面。之后，当 ndsudo 执行任何外部命令时，都会首先执行攻击者放置的恶意程序，从而获得 root shell。

代码中没有发现明显的投毒行为。它只是简单地设置 uid 和 gid 为 0，然后执行 /bin/bash。因此，投毒风险评估为0%。

利用方式总结：
1.  利用需要先获得一个netdata软件的低权限账号。
2.  创建一个包含恶意程序（例如 POC 中的 C 程序编译后的可执行文件）的可写目录。
3.  修改 PATH 环境变量，将该目录添加到 PATH 的最前面。
4.  触发 ndsudo 执行任何外部命令，这将导致恶意程序以 root 权限执行，从而获得 root shell。

**项目地址:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**来源**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 及 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的netdata，且具有本地shell访问权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 存在于Netdata的`ndsudo`工具中，该工具是具有SUID root权限的可执行文件。漏洞原因是`ndsudo`的搜索路径由`PATH`环境变量控制，攻击者可以通过修改`PATH`环境变量，将恶意程序放置在前面，当`ndsudo`执行信任的命令时，会执行攻击者放置的恶意程序，从而实现本地提权。提供的POC代码通过以下步骤利用该漏洞：

1.  **编译恶意payload:**  `poc.c` 编译成 `nvme`，该程序的功能是执行 `/bin/bash`，并设置 UID 和 GID 为 0，即root权限。
2.  **传输payload到目标系统:**  将编译好的`nvme`上传到目标系统的`/tmp`目录。
3.  **准备payload执行:**  给`/tmp/nvme`添加可执行权限，然后将`/tmp`添加到`PATH`环境变量的最前面。
4.  **触发`ndsudo`执行payload:** 运行`./ndsudo nvme-list`，`ndsudo`会执行`/tmp/nvme`，由于该程序会将权限提升为root，因此攻击者可以获得root shell。

**有效性：** 该POC代码描述的利用方式是有效的。

**投毒风险：** 提供的`poc.c`代码功能清晰，仅为执行`/bin/bash`并提升权限，不存在隐藏的投毒代码。README文件描述了完整的利用过程。因此，投毒风险为0%。

**利用方式：** 攻击者通过控制`PATH`环境变量，欺骗`ndsudo`执行恶意程序，从而获得root权限。

**项目地址:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**来源**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.44.0-60, < 1.45.3

**利用条件:** 需要netdata agent存在漏洞版本且ndsudo被调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019是Netdata Agent中ndsudo工具的一个本地权限提升漏洞。ndsudo是一个root用户拥有的、设置了SUID位的可执行文件。它本应只运行一组受限的外部命令，但是其搜索路径由PATH环境变量控制。攻击者可以通过控制PATH环境变量来指定ndsudo查找这些命令的位置，如果这个位置是攻击者具有写权限的目录，那么攻击者就可以放置恶意程序并以root权限执行。

**有效性：** 根据漏洞描述和搜索结果，该漏洞存在利用价值，通过控制PATH环境变量来执行恶意程序达到提权效果。

**投毒风险：** 提供的代码仅为GNU GENERAL PUBLIC LICENSE，是开源协议许可，不包含直接的攻击payload或恶意代码。但license本身也是一种代码，如果结合特定的上下文，协议内容也可能被滥用。例如，攻击者可能创建一个合法的程序，但其行为违反了协议条款，从而造成损害。此仓库中发现直接投毒代码的概率较低，但存在潜在的滥用风险，估计投毒风险为5%。

**利用方式：**
1.  确定目标系统上运行的Netdata Agent版本在受影响范围内（>= 1.44.0-60, < 1.45.3）。
2.  查找ndsudo工具的位置。
3.  创建一个包含恶意命令的目录，例如/tmp/evil。
4.  将恶意程序（如反弹shell）放置到/tmp/evil目录下，并命名为ndsudo尝试执行的命令（例如，`ping`，`date` 等, 具体取决于 ndsudo 允许执行的命令）。
5.  修改PATH环境变量，将/tmp/evil添加到PATH的最前面：`export PATH=/tmp/evil:$PATH`。
6.  运行ndsudo，它将执行/tmp/evil目录下的恶意程序，从而获得root权限。

**项目地址:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**来源**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户通过PATH劫持执行任意代码

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata Agent存在ndsudo，且版本在受影响范围内，以及可控的PATH环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是Netdata中`ndsudo`工具的一个本地提权漏洞。`ndsudo`是一个具有SUID root权限的可执行文件，但它使用`PATH`环境变量来查找要执行的命令。攻击者可以通过将恶意可执行文件放置在`PATH`环境变量中优先于系统目录的位置，诱使`ndsudo`执行该恶意程序，从而获得root权限。

**漏洞利用方式：**
1.  查找具有SUID权限的`ndsudo`可执行文件的路径。
2.  创建一个恶意的可执行文件(例如`nvme`)，该文件执行攻击者希望执行的任意代码。提供的`payload.c`是一个简单的示例，它会生成一个root shell。
3.  修改`PATH`环境变量，将当前目录(或包含恶意可执行文件的目录)添加到`PATH`的开头。
4.  调用`ndsudo`，并指定一个它允许执行的命令(例如`nvme-list`)。由于`PATH`已经被修改，`ndsudo`会执行攻击者放置的恶意`nvme`可执行文件，从而以root权限执行任意代码。

**有效性：**
提供的PoC代码是有效的。它包含一个shell脚本，用于查找`ndsudo`，创建一个`nvme` payload，修改`PATH`，然后执行`ndsudo`。README.md文件描述了如何编译`payload.c`并使用脚本。

**投毒风险：**
查看了提供的三个文件内容，没有发现任何投毒代码。其中，CVE-2024-32019.sh脚本用于利用漏洞，payload.c用于编译恶意payload，README.md文件描述了漏洞和利用方法，都是正常的利用代码。
因此，投毒风险为0%。

**项目地址:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**来源**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统安装了受影响版本的Netdata

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32019是Netdata ndsudo工具中的一个本地权限提升漏洞。ndsudo是一个SUID root的程序，但它使用了PATH环境变量来查找要执行的外部命令，攻击者可以通过修改PATH环境变量指向一个自己可控的目录，并在该目录下放置恶意程序，当ndsudo执行外部命令时，会执行攻击者放置的恶意程序，从而获得root权限。

**漏洞利用方式：**

1.  **漏洞检测：** 首先，检查目标系统上是否存在`/opt`目录下的`ndsudo`程序，并且确认该程序是否为root所有且设置了SUID权限。同时，使用`strings`命令检查`ndsudo`程序中是否存在对`nvme`、`smartctl`、`hdparm`或`sensors`等外部命令的调用，如果存在，则说明该程序可能受到PATH环境变量的影响。
2.  **恶意程序编译：** 编译一个C程序，该程序的功能是设置UID和GID为0，然后执行`/bin/bash`，从而获取root shell。
3.  **恶意程序上传：** 通过SFTP将编译好的恶意程序上传到目标系统上的一个攻击者可控的目录，例如`/tmp`。
4.  **环境变量修改：** 修改PATH环境变量，将攻击者可控的目录添加到PATH环境变量的最前面，确保`ndsudo`程序在执行外部命令时首先在该目录下查找。
5.  **漏洞触发：** 执行`ndsudo`程序，当它调用外部命令时，会执行攻击者上传的恶意程序，从而获取root权限。
6.  **交互式Shell：** 漏洞利用代码提供交互式shell。

**投毒风险分析：**

此POC代码本身主要目的是为了验证漏洞，实现本地提权。但是，该脚本包含以下潜在的投毒风险：

*   **编译和传输恶意代码：** 脚本会自动编译C代码生成二进制文件，并上传到目标机器。虽然C代码的内容是提权，但如果恶意攻击者修改了C代码，就可能包含其他恶意行为，例如植入后门、收集信息等。
*   **远程执行代码：**  脚本通过ssh执行远程命令，存在被篡改的风险，可能执行额外的恶意操作。
*   **残留文件：** 编译后的二进制文件和上传的恶意程序可能在目标系统上留下痕迹，如果这些文件被恶意利用，可能会导致进一步的安全问题。

尽管存在这些风险，但总体来说，该POC代码的风险仍然可控，主要风险集中在代码的篡改和恶意利用上。为了降低风险，建议从可信的来源获取POC代码，并仔细检查代码内容，确保其没有恶意行为。此外，在测试完成后，应及时清理目标系统上的残留文件。

投毒风险预估为10%，因为代码相对简洁，主要功能是漏洞验证和利用，但仍然存在被篡改和恶意利用的可能性。

**项目地址:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**来源**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地shell访问，能够执行ndsudo命令

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-32019 是 Netdata 中 ndsudo 工具的一个本地权限提升漏洞。ndsudo 是一个 SUID root 的可执行文件，但它使用 PATH 环境变量来查找要执行的命令。攻击者可以通过将恶意脚本放置在 PATH 环境变量中优先级更高的目录中，并将其命名为 ndsudo 允许执行的命令（例如 nvme），来欺骗 ndsudo 执行该恶意脚本并获得 root 权限。

**有效性：**

提供的 POC 代码描述了一种利用此漏洞的有效方法。它包括以下步骤：

1.  创建一个恶意脚本（poc.py），该脚本执行提权操作（例如，启动一个 root shell）。
2.  将此脚本重命名为 ndsudo 允许执行的命令之一（例如 nvme）。
3.  将包含恶意脚本的目录添加到 PATH 环境变量的开头。
4.  运行 ndsudo nvme-list，这将导致 ndsudo 执行恶意脚本，从而获得 root 权限。

**投毒风险：**

提供的代码仓库本身投毒风险较低。`poc.py` 代码非常简单，仅包含提权执行bash的代码，不太可能存在隐藏的恶意代码。`README.md` 文件提供了清晰的漏洞利用说明。但用户仍然需要注意，在实际环境中，从不可信的来源下载或复制漏洞利用代码都存在一定的风险，需要仔细检查代码是否存在恶意行为，再执行。

**利用方式：**

1.  **漏洞原理：** `ndsudo` 以 root 权限运行，但其搜索命令的路径依赖于用户的 `PATH` 环境变量。
2.  **攻击步骤：**
    *   创建恶意脚本，该脚本执行提权操作（例如，启动一个 root shell）。
    *   将此脚本重命名为 `ndsudo` 允许执行的命令之一（通过 `ndsudo --help` 查看）。
    *   将包含恶意脚本的目录添加到 `PATH` 环境变量的开头，确保恶意脚本优先被搜索到。
    *   运行 `ndsudo <allowed_command>`，这将导致 `ndsudo` 执行恶意脚本，从而获得 root 权限。

**总结：**

该漏洞利用较为简单，POC 代码的有效性较高，但应注意来源不明的exploit代码的潜在投毒风险。该漏洞允许低权限用户通过操纵 `PATH` 环境变量，利用 SUID 程序 `ndsudo` 提升至 root 权限。务必及时升级 Netdata 版本以修复此漏洞。

**项目地址:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**来源**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata agent运行在受影响版本，且攻击者能够执行本地代码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具拥有 SUID 权限，允许执行某些特权命令。漏洞的根源在于 `ndsudo` 使用不安全的 PATH 环境变量来查找要执行的命令，攻击者可以通过在 PATH 中插入恶意程序，让 `ndsudo` 执行攻击者控制的代码，从而提升权限到 root。

**利用方式：**

1.  **查找 `ndsudo` 路径：** 通常位于 `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`，但需要通过 `find` 命令确认。
2.  **创建恶意程序：** 创建一个 C 程序，该程序调用 `setuid(0)` 和 `setgid(0)` 设置用户和组 ID 为 root，然后执行一个 shell (例如 `/bin/bash -p`)。需要使用 `gcc` 编译该程序，例如命名为 `arcconf`。
3.  **修改 PATH 环境变量：** 将包含恶意程序的目录添加到 PATH 环境变量的开头。例如，如果恶意程序位于 `/tmp` 目录下，则执行 `PATH=/tmp:$PATH`。
4.  **执行 `ndsudo` 命令：** 使用 `ndsudo` 执行它支持的命令，但该命令依赖于攻击者放置的恶意程序。例如，`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`。`ndsudo` 会尝试执行 `arcconf`，但由于 PATH 环境变量被修改，它会执行攻击者在 `/tmp` 目录下创建的恶意程序。
5.  **获得 root shell：** 如果一切顺利，攻击者将获得一个 root shell。

**投毒风险分析：**

提供的 POC 代码中，`arcconf.c` 的目的是创建一个提权的 shell，没有明显的投毒行为。 但从 github 下载预编译二进制文件 `arcconf` 时，存在一定的投毒风险。攻击者可能在预编译的二进制文件中植入恶意代码。考虑到从 github 上下载的二进制文件存在潜在风险，故投毒风险评估为5%。

**项目地址:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**来源**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo 本地权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户提升至 root 权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 和 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的 Netdata，且 ndsudo 工具设置了 SUID root 权限，并且攻击者可以执行 ndsudo。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具以 root 权限运行，但它使用 `PATH` 环境变量来查找要执行的命令。攻击者可以通过在 `PATH` 环境变量中添加一个指向恶意目录的路径，并在该目录中放置一个与 `ndsudo` 尝试执行的命令同名的恶意程序，从而以 root 权限执行任意代码。

**有效性:**

提供的 POC 代码是有效的。它展示了如何利用此漏洞。

**利用方式:**

1.  创建一个包含恶意程序（例如，反弹 shell）的目录。
2.  将恶意程序命名为 `ndsudo` 尝试执行的命令之一（例如，`nvme-list`）。
3.  将包含恶意程序的目录添加到 `PATH` 环境变量的开头。
4.  运行 `ndsudo` 命令。`ndsudo` 将执行恶意程序，从而使攻击者获得 root 权限。

**投毒风险:**

根据提供的代码分析，该仓库似乎主要提供了一个 checker 脚本来帮助安全研究人员和管理员识别和验证漏洞是否存在，旨在帮助防御者评估风险和验证补丁，而不是提供武器化的 PoC。因此，该仓库中存在作者隐藏的投毒代码的风险较低。

检查器代码会检查以下内容：

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (或安装位置) 的 SUID/所有权。
*   `PATH` 中早于常见系统路径的可写目录。
*   `ndsudo` 尝试执行的白名单子命令是否存在。
*   可选地运行 `ndsudo --test <subcommand>` 来打印已解析的命令而不执行它 (谨慎使用，先阅读代码)。

因此，**投毒风险评估为 0%**。


**项目地址:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**来源**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，攻击者可利用此漏洞获取root权限。

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 目标系统上运行受影响版本的netdata，且攻击者需要具有本地低权限账号。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 netdata 的 ndsudo 工具中，该工具以 root 权限运行，但其搜索路径由 PATH 环境变量控制。攻击者可以通过修改 PATH 环境变量，将恶意程序放置在 ndsudo 搜索路径中，当 ndsudo 调用外部命令时，会执行攻击者放置的恶意程序，从而获得 root 权限。

提供的 POC 代码是一个 C 程序，编译后可以直接执行一个具有 root 权限的 bash shell。攻击者需要首先创建一个包含此恶意程序的可写目录，然后修改 PATH 环境变量，将此目录添加到 PATH 的最前面。之后，当 ndsudo 执行任何外部命令时，都会首先执行攻击者放置的恶意程序，从而获得 root shell。

代码中没有发现明显的投毒行为。它只是简单地设置 uid 和 gid 为 0，然后执行 /bin/bash。因此，投毒风险评估为0%。

利用方式总结：
1.  利用需要先获得一个netdata软件的低权限账号。
2.  创建一个包含恶意程序（例如 POC 中的 C 程序编译后的可执行文件）的可写目录。
3.  修改 PATH 环境变量，将该目录添加到 PATH 的最前面。
4.  触发 ndsudo 执行任何外部命令，这将导致恶意程序以 root 权限执行，从而获得 root shell。

**项目地址:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**来源**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 及 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的netdata，且具有本地shell访问权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 存在于Netdata的`ndsudo`工具中，该工具是具有SUID root权限的可执行文件。漏洞原因是`ndsudo`的搜索路径由`PATH`环境变量控制，攻击者可以通过修改`PATH`环境变量，将恶意程序放置在前面，当`ndsudo`执行信任的命令时，会执行攻击者放置的恶意程序，从而实现本地提权。提供的POC代码通过以下步骤利用该漏洞：

1.  **编译恶意payload:**  `poc.c` 编译成 `nvme`，该程序的功能是执行 `/bin/bash`，并设置 UID 和 GID 为 0，即root权限。
2.  **传输payload到目标系统:**  将编译好的`nvme`上传到目标系统的`/tmp`目录。
3.  **准备payload执行:**  给`/tmp/nvme`添加可执行权限，然后将`/tmp`添加到`PATH`环境变量的最前面。
4.  **触发`ndsudo`执行payload:** 运行`./ndsudo nvme-list`，`ndsudo`会执行`/tmp/nvme`，由于该程序会将权限提升为root，因此攻击者可以获得root shell。

**有效性：** 该POC代码描述的利用方式是有效的。

**投毒风险：** 提供的`poc.c`代码功能清晰，仅为执行`/bin/bash`并提升权限，不存在隐藏的投毒代码。README文件描述了完整的利用过程。因此，投毒风险为0%。

**利用方式：** 攻击者通过控制`PATH`环境变量，欺骗`ndsudo`执行恶意程序，从而获得root权限。

**项目地址:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**来源**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.44.0-60, < 1.45.3

**利用条件:** 需要netdata agent存在漏洞版本且ndsudo被调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019是Netdata Agent中ndsudo工具的一个本地权限提升漏洞。ndsudo是一个root用户拥有的、设置了SUID位的可执行文件。它本应只运行一组受限的外部命令，但是其搜索路径由PATH环境变量控制。攻击者可以通过控制PATH环境变量来指定ndsudo查找这些命令的位置，如果这个位置是攻击者具有写权限的目录，那么攻击者就可以放置恶意程序并以root权限执行。

**有效性：** 根据漏洞描述和搜索结果，该漏洞存在利用价值，通过控制PATH环境变量来执行恶意程序达到提权效果。

**投毒风险：** 提供的代码仅为GNU GENERAL PUBLIC LICENSE，是开源协议许可，不包含直接的攻击payload或恶意代码。但license本身也是一种代码，如果结合特定的上下文，协议内容也可能被滥用。例如，攻击者可能创建一个合法的程序，但其行为违反了协议条款，从而造成损害。此仓库中发现直接投毒代码的概率较低，但存在潜在的滥用风险，估计投毒风险为5%。

**利用方式：**
1.  确定目标系统上运行的Netdata Agent版本在受影响范围内（>= 1.44.0-60, < 1.45.3）。
2.  查找ndsudo工具的位置。
3.  创建一个包含恶意命令的目录，例如/tmp/evil。
4.  将恶意程序（如反弹shell）放置到/tmp/evil目录下，并命名为ndsudo尝试执行的命令（例如，`ping`，`date` 等, 具体取决于 ndsudo 允许执行的命令）。
5.  修改PATH环境变量，将/tmp/evil添加到PATH的最前面：`export PATH=/tmp/evil:$PATH`。
6.  运行ndsudo，它将执行/tmp/evil目录下的恶意程序，从而获得root权限。

**项目地址:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**来源**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户通过PATH劫持执行任意代码

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata Agent存在ndsudo，且版本在受影响范围内，以及可控的PATH环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是Netdata中`ndsudo`工具的一个本地提权漏洞。`ndsudo`是一个具有SUID root权限的可执行文件，但它使用`PATH`环境变量来查找要执行的命令。攻击者可以通过将恶意可执行文件放置在`PATH`环境变量中优先于系统目录的位置，诱使`ndsudo`执行该恶意程序，从而获得root权限。

**漏洞利用方式：**
1.  查找具有SUID权限的`ndsudo`可执行文件的路径。
2.  创建一个恶意的可执行文件(例如`nvme`)，该文件执行攻击者希望执行的任意代码。提供的`payload.c`是一个简单的示例，它会生成一个root shell。
3.  修改`PATH`环境变量，将当前目录(或包含恶意可执行文件的目录)添加到`PATH`的开头。
4.  调用`ndsudo`，并指定一个它允许执行的命令(例如`nvme-list`)。由于`PATH`已经被修改，`ndsudo`会执行攻击者放置的恶意`nvme`可执行文件，从而以root权限执行任意代码。

**有效性：**
提供的PoC代码是有效的。它包含一个shell脚本，用于查找`ndsudo`，创建一个`nvme` payload，修改`PATH`，然后执行`ndsudo`。README.md文件描述了如何编译`payload.c`并使用脚本。

**投毒风险：**
查看了提供的三个文件内容，没有发现任何投毒代码。其中，CVE-2024-32019.sh脚本用于利用漏洞，payload.c用于编译恶意payload，README.md文件描述了漏洞和利用方法，都是正常的利用代码。
因此，投毒风险为0%。

**项目地址:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**来源**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统安装了受影响版本的Netdata

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32019是Netdata ndsudo工具中的一个本地权限提升漏洞。ndsudo是一个SUID root的程序，但它使用了PATH环境变量来查找要执行的外部命令，攻击者可以通过修改PATH环境变量指向一个自己可控的目录，并在该目录下放置恶意程序，当ndsudo执行外部命令时，会执行攻击者放置的恶意程序，从而获得root权限。

**漏洞利用方式：**

1.  **漏洞检测：** 首先，检查目标系统上是否存在`/opt`目录下的`ndsudo`程序，并且确认该程序是否为root所有且设置了SUID权限。同时，使用`strings`命令检查`ndsudo`程序中是否存在对`nvme`、`smartctl`、`hdparm`或`sensors`等外部命令的调用，如果存在，则说明该程序可能受到PATH环境变量的影响。
2.  **恶意程序编译：** 编译一个C程序，该程序的功能是设置UID和GID为0，然后执行`/bin/bash`，从而获取root shell。
3.  **恶意程序上传：** 通过SFTP将编译好的恶意程序上传到目标系统上的一个攻击者可控的目录，例如`/tmp`。
4.  **环境变量修改：** 修改PATH环境变量，将攻击者可控的目录添加到PATH环境变量的最前面，确保`ndsudo`程序在执行外部命令时首先在该目录下查找。
5.  **漏洞触发：** 执行`ndsudo`程序，当它调用外部命令时，会执行攻击者上传的恶意程序，从而获取root权限。
6.  **交互式Shell：** 漏洞利用代码提供交互式shell。

**投毒风险分析：**

此POC代码本身主要目的是为了验证漏洞，实现本地提权。但是，该脚本包含以下潜在的投毒风险：

*   **编译和传输恶意代码：** 脚本会自动编译C代码生成二进制文件，并上传到目标机器。虽然C代码的内容是提权，但如果恶意攻击者修改了C代码，就可能包含其他恶意行为，例如植入后门、收集信息等。
*   **远程执行代码：**  脚本通过ssh执行远程命令，存在被篡改的风险，可能执行额外的恶意操作。
*   **残留文件：** 编译后的二进制文件和上传的恶意程序可能在目标系统上留下痕迹，如果这些文件被恶意利用，可能会导致进一步的安全问题。

尽管存在这些风险，但总体来说，该POC代码的风险仍然可控，主要风险集中在代码的篡改和恶意利用上。为了降低风险，建议从可信的来源获取POC代码，并仔细检查代码内容，确保其没有恶意行为。此外，在测试完成后，应及时清理目标系统上的残留文件。

投毒风险预估为10%，因为代码相对简洁，主要功能是漏洞验证和利用，但仍然存在被篡改和恶意利用的可能性。

**项目地址:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**来源**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地shell访问，能够执行ndsudo命令

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-32019 是 Netdata 中 ndsudo 工具的一个本地权限提升漏洞。ndsudo 是一个 SUID root 的可执行文件，但它使用 PATH 环境变量来查找要执行的命令。攻击者可以通过将恶意脚本放置在 PATH 环境变量中优先级更高的目录中，并将其命名为 ndsudo 允许执行的命令（例如 nvme），来欺骗 ndsudo 执行该恶意脚本并获得 root 权限。

**有效性：**

提供的 POC 代码描述了一种利用此漏洞的有效方法。它包括以下步骤：

1.  创建一个恶意脚本（poc.py），该脚本执行提权操作（例如，启动一个 root shell）。
2.  将此脚本重命名为 ndsudo 允许执行的命令之一（例如 nvme）。
3.  将包含恶意脚本的目录添加到 PATH 环境变量的开头。
4.  运行 ndsudo nvme-list，这将导致 ndsudo 执行恶意脚本，从而获得 root 权限。

**投毒风险：**

提供的代码仓库本身投毒风险较低。`poc.py` 代码非常简单，仅包含提权执行bash的代码，不太可能存在隐藏的恶意代码。`README.md` 文件提供了清晰的漏洞利用说明。但用户仍然需要注意，在实际环境中，从不可信的来源下载或复制漏洞利用代码都存在一定的风险，需要仔细检查代码是否存在恶意行为，再执行。

**利用方式：**

1.  **漏洞原理：** `ndsudo` 以 root 权限运行，但其搜索命令的路径依赖于用户的 `PATH` 环境变量。
2.  **攻击步骤：**
    *   创建恶意脚本，该脚本执行提权操作（例如，启动一个 root shell）。
    *   将此脚本重命名为 `ndsudo` 允许执行的命令之一（通过 `ndsudo --help` 查看）。
    *   将包含恶意脚本的目录添加到 `PATH` 环境变量的开头，确保恶意脚本优先被搜索到。
    *   运行 `ndsudo <allowed_command>`，这将导致 `ndsudo` 执行恶意脚本，从而获得 root 权限。

**总结：**

该漏洞利用较为简单，POC 代码的有效性较高，但应注意来源不明的exploit代码的潜在投毒风险。该漏洞允许低权限用户通过操纵 `PATH` 环境变量，利用 SUID 程序 `ndsudo` 提升至 root 权限。务必及时升级 Netdata 版本以修复此漏洞。

**项目地址:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**来源**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata agent运行在受影响版本，且攻击者能够执行本地代码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具拥有 SUID 权限，允许执行某些特权命令。漏洞的根源在于 `ndsudo` 使用不安全的 PATH 环境变量来查找要执行的命令，攻击者可以通过在 PATH 中插入恶意程序，让 `ndsudo` 执行攻击者控制的代码，从而提升权限到 root。

**利用方式：**

1.  **查找 `ndsudo` 路径：** 通常位于 `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`，但需要通过 `find` 命令确认。
2.  **创建恶意程序：** 创建一个 C 程序，该程序调用 `setuid(0)` 和 `setgid(0)` 设置用户和组 ID 为 root，然后执行一个 shell (例如 `/bin/bash -p`)。需要使用 `gcc` 编译该程序，例如命名为 `arcconf`。
3.  **修改 PATH 环境变量：** 将包含恶意程序的目录添加到 PATH 环境变量的开头。例如，如果恶意程序位于 `/tmp` 目录下，则执行 `PATH=/tmp:$PATH`。
4.  **执行 `ndsudo` 命令：** 使用 `ndsudo` 执行它支持的命令，但该命令依赖于攻击者放置的恶意程序。例如，`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`。`ndsudo` 会尝试执行 `arcconf`，但由于 PATH 环境变量被修改，它会执行攻击者在 `/tmp` 目录下创建的恶意程序。
5.  **获得 root shell：** 如果一切顺利，攻击者将获得一个 root shell。

**投毒风险分析：**

提供的 POC 代码中，`arcconf.c` 的目的是创建一个提权的 shell，没有明显的投毒行为。 但从 github 下载预编译二进制文件 `arcconf` 时，存在一定的投毒风险。攻击者可能在预编译的二进制文件中植入恶意代码。考虑到从 github 上下载的二进制文件存在潜在风险，故投毒风险评估为5%。

**项目地址:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**来源**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo 本地权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户提升至 root 权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 和 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的 Netdata，且 ndsudo 工具设置了 SUID root 权限，并且攻击者可以执行 ndsudo。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具以 root 权限运行，但它使用 `PATH` 环境变量来查找要执行的命令。攻击者可以通过在 `PATH` 环境变量中添加一个指向恶意目录的路径，并在该目录中放置一个与 `ndsudo` 尝试执行的命令同名的恶意程序，从而以 root 权限执行任意代码。

**有效性:**

提供的 POC 代码是有效的。它展示了如何利用此漏洞。

**利用方式:**

1.  创建一个包含恶意程序（例如，反弹 shell）的目录。
2.  将恶意程序命名为 `ndsudo` 尝试执行的命令之一（例如，`nvme-list`）。
3.  将包含恶意程序的目录添加到 `PATH` 环境变量的开头。
4.  运行 `ndsudo` 命令。`ndsudo` 将执行恶意程序，从而使攻击者获得 root 权限。

**投毒风险:**

根据提供的代码分析，该仓库似乎主要提供了一个 checker 脚本来帮助安全研究人员和管理员识别和验证漏洞是否存在，旨在帮助防御者评估风险和验证补丁，而不是提供武器化的 PoC。因此，该仓库中存在作者隐藏的投毒代码的风险较低。

检查器代码会检查以下内容：

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (或安装位置) 的 SUID/所有权。
*   `PATH` 中早于常见系统路径的可写目录。
*   `ndsudo` 尝试执行的白名单子命令是否存在。
*   可选地运行 `ndsudo --test <subcommand>` 来打印已解析的命令而不执行它 (谨慎使用，先阅读代码)。

因此，**投毒风险评估为 0%**。


**项目地址:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**来源**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，攻击者可利用此漏洞获取root权限。

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 目标系统上运行受影响版本的netdata，且攻击者需要具有本地低权限账号。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 netdata 的 ndsudo 工具中，该工具以 root 权限运行，但其搜索路径由 PATH 环境变量控制。攻击者可以通过修改 PATH 环境变量，将恶意程序放置在 ndsudo 搜索路径中，当 ndsudo 调用外部命令时，会执行攻击者放置的恶意程序，从而获得 root 权限。

提供的 POC 代码是一个 C 程序，编译后可以直接执行一个具有 root 权限的 bash shell。攻击者需要首先创建一个包含此恶意程序的可写目录，然后修改 PATH 环境变量，将此目录添加到 PATH 的最前面。之后，当 ndsudo 执行任何外部命令时，都会首先执行攻击者放置的恶意程序，从而获得 root shell。

代码中没有发现明显的投毒行为。它只是简单地设置 uid 和 gid 为 0，然后执行 /bin/bash。因此，投毒风险评估为0%。

利用方式总结：
1.  利用需要先获得一个netdata软件的低权限账号。
2.  创建一个包含恶意程序（例如 POC 中的 C 程序编译后的可执行文件）的可写目录。
3.  修改 PATH 环境变量，将该目录添加到 PATH 的最前面。
4.  触发 ndsudo 执行任何外部命令，这将导致恶意程序以 root 权限执行，从而获得 root shell。

**项目地址:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**来源**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 及 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的netdata，且具有本地shell访问权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 存在于Netdata的`ndsudo`工具中，该工具是具有SUID root权限的可执行文件。漏洞原因是`ndsudo`的搜索路径由`PATH`环境变量控制，攻击者可以通过修改`PATH`环境变量，将恶意程序放置在前面，当`ndsudo`执行信任的命令时，会执行攻击者放置的恶意程序，从而实现本地提权。提供的POC代码通过以下步骤利用该漏洞：

1.  **编译恶意payload:**  `poc.c` 编译成 `nvme`，该程序的功能是执行 `/bin/bash`，并设置 UID 和 GID 为 0，即root权限。
2.  **传输payload到目标系统:**  将编译好的`nvme`上传到目标系统的`/tmp`目录。
3.  **准备payload执行:**  给`/tmp/nvme`添加可执行权限，然后将`/tmp`添加到`PATH`环境变量的最前面。
4.  **触发`ndsudo`执行payload:** 运行`./ndsudo nvme-list`，`ndsudo`会执行`/tmp/nvme`，由于该程序会将权限提升为root，因此攻击者可以获得root shell。

**有效性：** 该POC代码描述的利用方式是有效的。

**投毒风险：** 提供的`poc.c`代码功能清晰，仅为执行`/bin/bash`并提升权限，不存在隐藏的投毒代码。README文件描述了完整的利用过程。因此，投毒风险为0%。

**利用方式：** 攻击者通过控制`PATH`环境变量，欺骗`ndsudo`执行恶意程序，从而获得root权限。

**项目地址:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**来源**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.44.0-60, < 1.45.3

**利用条件:** 需要netdata agent存在漏洞版本且ndsudo被调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019是Netdata Agent中ndsudo工具的一个本地权限提升漏洞。ndsudo是一个root用户拥有的、设置了SUID位的可执行文件。它本应只运行一组受限的外部命令，但是其搜索路径由PATH环境变量控制。攻击者可以通过控制PATH环境变量来指定ndsudo查找这些命令的位置，如果这个位置是攻击者具有写权限的目录，那么攻击者就可以放置恶意程序并以root权限执行。

**有效性：** 根据漏洞描述和搜索结果，该漏洞存在利用价值，通过控制PATH环境变量来执行恶意程序达到提权效果。

**投毒风险：** 提供的代码仅为GNU GENERAL PUBLIC LICENSE，是开源协议许可，不包含直接的攻击payload或恶意代码。但license本身也是一种代码，如果结合特定的上下文，协议内容也可能被滥用。例如，攻击者可能创建一个合法的程序，但其行为违反了协议条款，从而造成损害。此仓库中发现直接投毒代码的概率较低，但存在潜在的滥用风险，估计投毒风险为5%。

**利用方式：**
1.  确定目标系统上运行的Netdata Agent版本在受影响范围内（>= 1.44.0-60, < 1.45.3）。
2.  查找ndsudo工具的位置。
3.  创建一个包含恶意命令的目录，例如/tmp/evil。
4.  将恶意程序（如反弹shell）放置到/tmp/evil目录下，并命名为ndsudo尝试执行的命令（例如，`ping`，`date` 等, 具体取决于 ndsudo 允许执行的命令）。
5.  修改PATH环境变量，将/tmp/evil添加到PATH的最前面：`export PATH=/tmp/evil:$PATH`。
6.  运行ndsudo，它将执行/tmp/evil目录下的恶意程序，从而获得root权限。

**项目地址:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**来源**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户通过PATH劫持执行任意代码

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata Agent存在ndsudo，且版本在受影响范围内，以及可控的PATH环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是Netdata中`ndsudo`工具的一个本地提权漏洞。`ndsudo`是一个具有SUID root权限的可执行文件，但它使用`PATH`环境变量来查找要执行的命令。攻击者可以通过将恶意可执行文件放置在`PATH`环境变量中优先于系统目录的位置，诱使`ndsudo`执行该恶意程序，从而获得root权限。

**漏洞利用方式：**
1.  查找具有SUID权限的`ndsudo`可执行文件的路径。
2.  创建一个恶意的可执行文件(例如`nvme`)，该文件执行攻击者希望执行的任意代码。提供的`payload.c`是一个简单的示例，它会生成一个root shell。
3.  修改`PATH`环境变量，将当前目录(或包含恶意可执行文件的目录)添加到`PATH`的开头。
4.  调用`ndsudo`，并指定一个它允许执行的命令(例如`nvme-list`)。由于`PATH`已经被修改，`ndsudo`会执行攻击者放置的恶意`nvme`可执行文件，从而以root权限执行任意代码。

**有效性：**
提供的PoC代码是有效的。它包含一个shell脚本，用于查找`ndsudo`，创建一个`nvme` payload，修改`PATH`，然后执行`ndsudo`。README.md文件描述了如何编译`payload.c`并使用脚本。

**投毒风险：**
查看了提供的三个文件内容，没有发现任何投毒代码。其中，CVE-2024-32019.sh脚本用于利用漏洞，payload.c用于编译恶意payload，README.md文件描述了漏洞和利用方法，都是正常的利用代码。
因此，投毒风险为0%。

**项目地址:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**来源**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统安装了受影响版本的Netdata

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32019是Netdata ndsudo工具中的一个本地权限提升漏洞。ndsudo是一个SUID root的程序，但它使用了PATH环境变量来查找要执行的外部命令，攻击者可以通过修改PATH环境变量指向一个自己可控的目录，并在该目录下放置恶意程序，当ndsudo执行外部命令时，会执行攻击者放置的恶意程序，从而获得root权限。

**漏洞利用方式：**

1.  **漏洞检测：** 首先，检查目标系统上是否存在`/opt`目录下的`ndsudo`程序，并且确认该程序是否为root所有且设置了SUID权限。同时，使用`strings`命令检查`ndsudo`程序中是否存在对`nvme`、`smartctl`、`hdparm`或`sensors`等外部命令的调用，如果存在，则说明该程序可能受到PATH环境变量的影响。
2.  **恶意程序编译：** 编译一个C程序，该程序的功能是设置UID和GID为0，然后执行`/bin/bash`，从而获取root shell。
3.  **恶意程序上传：** 通过SFTP将编译好的恶意程序上传到目标系统上的一个攻击者可控的目录，例如`/tmp`。
4.  **环境变量修改：** 修改PATH环境变量，将攻击者可控的目录添加到PATH环境变量的最前面，确保`ndsudo`程序在执行外部命令时首先在该目录下查找。
5.  **漏洞触发：** 执行`ndsudo`程序，当它调用外部命令时，会执行攻击者上传的恶意程序，从而获取root权限。
6.  **交互式Shell：** 漏洞利用代码提供交互式shell。

**投毒风险分析：**

此POC代码本身主要目的是为了验证漏洞，实现本地提权。但是，该脚本包含以下潜在的投毒风险：

*   **编译和传输恶意代码：** 脚本会自动编译C代码生成二进制文件，并上传到目标机器。虽然C代码的内容是提权，但如果恶意攻击者修改了C代码，就可能包含其他恶意行为，例如植入后门、收集信息等。
*   **远程执行代码：**  脚本通过ssh执行远程命令，存在被篡改的风险，可能执行额外的恶意操作。
*   **残留文件：** 编译后的二进制文件和上传的恶意程序可能在目标系统上留下痕迹，如果这些文件被恶意利用，可能会导致进一步的安全问题。

尽管存在这些风险，但总体来说，该POC代码的风险仍然可控，主要风险集中在代码的篡改和恶意利用上。为了降低风险，建议从可信的来源获取POC代码，并仔细检查代码内容，确保其没有恶意行为。此外，在测试完成后，应及时清理目标系统上的残留文件。

投毒风险预估为10%，因为代码相对简洁，主要功能是漏洞验证和利用，但仍然存在被篡改和恶意利用的可能性。

**项目地址:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**来源**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地shell访问，能够执行ndsudo命令

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-32019 是 Netdata 中 ndsudo 工具的一个本地权限提升漏洞。ndsudo 是一个 SUID root 的可执行文件，但它使用 PATH 环境变量来查找要执行的命令。攻击者可以通过将恶意脚本放置在 PATH 环境变量中优先级更高的目录中，并将其命名为 ndsudo 允许执行的命令（例如 nvme），来欺骗 ndsudo 执行该恶意脚本并获得 root 权限。

**有效性：**

提供的 POC 代码描述了一种利用此漏洞的有效方法。它包括以下步骤：

1.  创建一个恶意脚本（poc.py），该脚本执行提权操作（例如，启动一个 root shell）。
2.  将此脚本重命名为 ndsudo 允许执行的命令之一（例如 nvme）。
3.  将包含恶意脚本的目录添加到 PATH 环境变量的开头。
4.  运行 ndsudo nvme-list，这将导致 ndsudo 执行恶意脚本，从而获得 root 权限。

**投毒风险：**

提供的代码仓库本身投毒风险较低。`poc.py` 代码非常简单，仅包含提权执行bash的代码，不太可能存在隐藏的恶意代码。`README.md` 文件提供了清晰的漏洞利用说明。但用户仍然需要注意，在实际环境中，从不可信的来源下载或复制漏洞利用代码都存在一定的风险，需要仔细检查代码是否存在恶意行为，再执行。

**利用方式：**

1.  **漏洞原理：** `ndsudo` 以 root 权限运行，但其搜索命令的路径依赖于用户的 `PATH` 环境变量。
2.  **攻击步骤：**
    *   创建恶意脚本，该脚本执行提权操作（例如，启动一个 root shell）。
    *   将此脚本重命名为 `ndsudo` 允许执行的命令之一（通过 `ndsudo --help` 查看）。
    *   将包含恶意脚本的目录添加到 `PATH` 环境变量的开头，确保恶意脚本优先被搜索到。
    *   运行 `ndsudo <allowed_command>`，这将导致 `ndsudo` 执行恶意脚本，从而获得 root 权限。

**总结：**

该漏洞利用较为简单，POC 代码的有效性较高，但应注意来源不明的exploit代码的潜在投毒风险。该漏洞允许低权限用户通过操纵 `PATH` 环境变量，利用 SUID 程序 `ndsudo` 提升至 root 权限。务必及时升级 Netdata 版本以修复此漏洞。

**项目地址:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**来源**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata agent运行在受影响版本，且攻击者能够执行本地代码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具拥有 SUID 权限，允许执行某些特权命令。漏洞的根源在于 `ndsudo` 使用不安全的 PATH 环境变量来查找要执行的命令，攻击者可以通过在 PATH 中插入恶意程序，让 `ndsudo` 执行攻击者控制的代码，从而提升权限到 root。

**利用方式：**

1.  **查找 `ndsudo` 路径：** 通常位于 `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`，但需要通过 `find` 命令确认。
2.  **创建恶意程序：** 创建一个 C 程序，该程序调用 `setuid(0)` 和 `setgid(0)` 设置用户和组 ID 为 root，然后执行一个 shell (例如 `/bin/bash -p`)。需要使用 `gcc` 编译该程序，例如命名为 `arcconf`。
3.  **修改 PATH 环境变量：** 将包含恶意程序的目录添加到 PATH 环境变量的开头。例如，如果恶意程序位于 `/tmp` 目录下，则执行 `PATH=/tmp:$PATH`。
4.  **执行 `ndsudo` 命令：** 使用 `ndsudo` 执行它支持的命令，但该命令依赖于攻击者放置的恶意程序。例如，`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`。`ndsudo` 会尝试执行 `arcconf`，但由于 PATH 环境变量被修改，它会执行攻击者在 `/tmp` 目录下创建的恶意程序。
5.  **获得 root shell：** 如果一切顺利，攻击者将获得一个 root shell。

**投毒风险分析：**

提供的 POC 代码中，`arcconf.c` 的目的是创建一个提权的 shell，没有明显的投毒行为。 但从 github 下载预编译二进制文件 `arcconf` 时，存在一定的投毒风险。攻击者可能在预编译的二进制文件中植入恶意代码。考虑到从 github 上下载的二进制文件存在潜在风险，故投毒风险评估为5%。

**项目地址:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**来源**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo 本地权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户提升至 root 权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 和 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的 Netdata，且 ndsudo 工具设置了 SUID root 权限，并且攻击者可以执行 ndsudo。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具以 root 权限运行，但它使用 `PATH` 环境变量来查找要执行的命令。攻击者可以通过在 `PATH` 环境变量中添加一个指向恶意目录的路径，并在该目录中放置一个与 `ndsudo` 尝试执行的命令同名的恶意程序，从而以 root 权限执行任意代码。

**有效性:**

提供的 POC 代码是有效的。它展示了如何利用此漏洞。

**利用方式:**

1.  创建一个包含恶意程序（例如，反弹 shell）的目录。
2.  将恶意程序命名为 `ndsudo` 尝试执行的命令之一（例如，`nvme-list`）。
3.  将包含恶意程序的目录添加到 `PATH` 环境变量的开头。
4.  运行 `ndsudo` 命令。`ndsudo` 将执行恶意程序，从而使攻击者获得 root 权限。

**投毒风险:**

根据提供的代码分析，该仓库似乎主要提供了一个 checker 脚本来帮助安全研究人员和管理员识别和验证漏洞是否存在，旨在帮助防御者评估风险和验证补丁，而不是提供武器化的 PoC。因此，该仓库中存在作者隐藏的投毒代码的风险较低。

检查器代码会检查以下内容：

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (或安装位置) 的 SUID/所有权。
*   `PATH` 中早于常见系统路径的可写目录。
*   `ndsudo` 尝试执行的白名单子命令是否存在。
*   可选地运行 `ndsudo --test <subcommand>` 来打印已解析的命令而不执行它 (谨慎使用，先阅读代码)。

因此，**投毒风险评估为 0%**。


**项目地址:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**来源**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，攻击者可利用此漏洞获取root权限。

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 目标系统上运行受影响版本的netdata，且攻击者需要具有本地低权限账号。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 netdata 的 ndsudo 工具中，该工具以 root 权限运行，但其搜索路径由 PATH 环境变量控制。攻击者可以通过修改 PATH 环境变量，将恶意程序放置在 ndsudo 搜索路径中，当 ndsudo 调用外部命令时，会执行攻击者放置的恶意程序，从而获得 root 权限。

提供的 POC 代码是一个 C 程序，编译后可以直接执行一个具有 root 权限的 bash shell。攻击者需要首先创建一个包含此恶意程序的可写目录，然后修改 PATH 环境变量，将此目录添加到 PATH 的最前面。之后，当 ndsudo 执行任何外部命令时，都会首先执行攻击者放置的恶意程序，从而获得 root shell。

代码中没有发现明显的投毒行为。它只是简单地设置 uid 和 gid 为 0，然后执行 /bin/bash。因此，投毒风险评估为0%。

利用方式总结：
1.  利用需要先获得一个netdata软件的低权限账号。
2.  创建一个包含恶意程序（例如 POC 中的 C 程序编译后的可执行文件）的可写目录。
3.  修改 PATH 环境变量，将该目录添加到 PATH 的最前面。
4.  触发 ndsudo 执行任何外部命令，这将导致恶意程序以 root 权限执行，从而获得 root shell。

**项目地址:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**来源**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 及 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的netdata，且具有本地shell访问权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 存在于Netdata的`ndsudo`工具中，该工具是具有SUID root权限的可执行文件。漏洞原因是`ndsudo`的搜索路径由`PATH`环境变量控制，攻击者可以通过修改`PATH`环境变量，将恶意程序放置在前面，当`ndsudo`执行信任的命令时，会执行攻击者放置的恶意程序，从而实现本地提权。提供的POC代码通过以下步骤利用该漏洞：

1.  **编译恶意payload:**  `poc.c` 编译成 `nvme`，该程序的功能是执行 `/bin/bash`，并设置 UID 和 GID 为 0，即root权限。
2.  **传输payload到目标系统:**  将编译好的`nvme`上传到目标系统的`/tmp`目录。
3.  **准备payload执行:**  给`/tmp/nvme`添加可执行权限，然后将`/tmp`添加到`PATH`环境变量的最前面。
4.  **触发`ndsudo`执行payload:** 运行`./ndsudo nvme-list`，`ndsudo`会执行`/tmp/nvme`，由于该程序会将权限提升为root，因此攻击者可以获得root shell。

**有效性：** 该POC代码描述的利用方式是有效的。

**投毒风险：** 提供的`poc.c`代码功能清晰，仅为执行`/bin/bash`并提升权限，不存在隐藏的投毒代码。README文件描述了完整的利用过程。因此，投毒风险为0%。

**利用方式：** 攻击者通过控制`PATH`环境变量，欺骗`ndsudo`执行恶意程序，从而获得root权限。

**项目地址:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**来源**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.44.0-60, < 1.45.3

**利用条件:** 需要netdata agent存在漏洞版本且ndsudo被调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019是Netdata Agent中ndsudo工具的一个本地权限提升漏洞。ndsudo是一个root用户拥有的、设置了SUID位的可执行文件。它本应只运行一组受限的外部命令，但是其搜索路径由PATH环境变量控制。攻击者可以通过控制PATH环境变量来指定ndsudo查找这些命令的位置，如果这个位置是攻击者具有写权限的目录，那么攻击者就可以放置恶意程序并以root权限执行。

**有效性：** 根据漏洞描述和搜索结果，该漏洞存在利用价值，通过控制PATH环境变量来执行恶意程序达到提权效果。

**投毒风险：** 提供的代码仅为GNU GENERAL PUBLIC LICENSE，是开源协议许可，不包含直接的攻击payload或恶意代码。但license本身也是一种代码，如果结合特定的上下文，协议内容也可能被滥用。例如，攻击者可能创建一个合法的程序，但其行为违反了协议条款，从而造成损害。此仓库中发现直接投毒代码的概率较低，但存在潜在的滥用风险，估计投毒风险为5%。

**利用方式：**
1.  确定目标系统上运行的Netdata Agent版本在受影响范围内（>= 1.44.0-60, < 1.45.3）。
2.  查找ndsudo工具的位置。
3.  创建一个包含恶意命令的目录，例如/tmp/evil。
4.  将恶意程序（如反弹shell）放置到/tmp/evil目录下，并命名为ndsudo尝试执行的命令（例如，`ping`，`date` 等, 具体取决于 ndsudo 允许执行的命令）。
5.  修改PATH环境变量，将/tmp/evil添加到PATH的最前面：`export PATH=/tmp/evil:$PATH`。
6.  运行ndsudo，它将执行/tmp/evil目录下的恶意程序，从而获得root权限。

**项目地址:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**来源**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户通过PATH劫持执行任意代码

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata Agent存在ndsudo，且版本在受影响范围内，以及可控的PATH环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是Netdata中`ndsudo`工具的一个本地提权漏洞。`ndsudo`是一个具有SUID root权限的可执行文件，但它使用`PATH`环境变量来查找要执行的命令。攻击者可以通过将恶意可执行文件放置在`PATH`环境变量中优先于系统目录的位置，诱使`ndsudo`执行该恶意程序，从而获得root权限。

**漏洞利用方式：**
1.  查找具有SUID权限的`ndsudo`可执行文件的路径。
2.  创建一个恶意的可执行文件(例如`nvme`)，该文件执行攻击者希望执行的任意代码。提供的`payload.c`是一个简单的示例，它会生成一个root shell。
3.  修改`PATH`环境变量，将当前目录(或包含恶意可执行文件的目录)添加到`PATH`的开头。
4.  调用`ndsudo`，并指定一个它允许执行的命令(例如`nvme-list`)。由于`PATH`已经被修改，`ndsudo`会执行攻击者放置的恶意`nvme`可执行文件，从而以root权限执行任意代码。

**有效性：**
提供的PoC代码是有效的。它包含一个shell脚本，用于查找`ndsudo`，创建一个`nvme` payload，修改`PATH`，然后执行`ndsudo`。README.md文件描述了如何编译`payload.c`并使用脚本。

**投毒风险：**
查看了提供的三个文件内容，没有发现任何投毒代码。其中，CVE-2024-32019.sh脚本用于利用漏洞，payload.c用于编译恶意payload，README.md文件描述了漏洞和利用方法，都是正常的利用代码。
因此，投毒风险为0%。

**项目地址:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**来源**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统安装了受影响版本的Netdata

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32019是Netdata ndsudo工具中的一个本地权限提升漏洞。ndsudo是一个SUID root的程序，但它使用了PATH环境变量来查找要执行的外部命令，攻击者可以通过修改PATH环境变量指向一个自己可控的目录，并在该目录下放置恶意程序，当ndsudo执行外部命令时，会执行攻击者放置的恶意程序，从而获得root权限。

**漏洞利用方式：**

1.  **漏洞检测：** 首先，检查目标系统上是否存在`/opt`目录下的`ndsudo`程序，并且确认该程序是否为root所有且设置了SUID权限。同时，使用`strings`命令检查`ndsudo`程序中是否存在对`nvme`、`smartctl`、`hdparm`或`sensors`等外部命令的调用，如果存在，则说明该程序可能受到PATH环境变量的影响。
2.  **恶意程序编译：** 编译一个C程序，该程序的功能是设置UID和GID为0，然后执行`/bin/bash`，从而获取root shell。
3.  **恶意程序上传：** 通过SFTP将编译好的恶意程序上传到目标系统上的一个攻击者可控的目录，例如`/tmp`。
4.  **环境变量修改：** 修改PATH环境变量，将攻击者可控的目录添加到PATH环境变量的最前面，确保`ndsudo`程序在执行外部命令时首先在该目录下查找。
5.  **漏洞触发：** 执行`ndsudo`程序，当它调用外部命令时，会执行攻击者上传的恶意程序，从而获取root权限。
6.  **交互式Shell：** 漏洞利用代码提供交互式shell。

**投毒风险分析：**

此POC代码本身主要目的是为了验证漏洞，实现本地提权。但是，该脚本包含以下潜在的投毒风险：

*   **编译和传输恶意代码：** 脚本会自动编译C代码生成二进制文件，并上传到目标机器。虽然C代码的内容是提权，但如果恶意攻击者修改了C代码，就可能包含其他恶意行为，例如植入后门、收集信息等。
*   **远程执行代码：**  脚本通过ssh执行远程命令，存在被篡改的风险，可能执行额外的恶意操作。
*   **残留文件：** 编译后的二进制文件和上传的恶意程序可能在目标系统上留下痕迹，如果这些文件被恶意利用，可能会导致进一步的安全问题。

尽管存在这些风险，但总体来说，该POC代码的风险仍然可控，主要风险集中在代码的篡改和恶意利用上。为了降低风险，建议从可信的来源获取POC代码，并仔细检查代码内容，确保其没有恶意行为。此外，在测试完成后，应及时清理目标系统上的残留文件。

投毒风险预估为10%，因为代码相对简洁，主要功能是漏洞验证和利用，但仍然存在被篡改和恶意利用的可能性。

**项目地址:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**来源**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地shell访问，能够执行ndsudo命令

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-32019 是 Netdata 中 ndsudo 工具的一个本地权限提升漏洞。ndsudo 是一个 SUID root 的可执行文件，但它使用 PATH 环境变量来查找要执行的命令。攻击者可以通过将恶意脚本放置在 PATH 环境变量中优先级更高的目录中，并将其命名为 ndsudo 允许执行的命令（例如 nvme），来欺骗 ndsudo 执行该恶意脚本并获得 root 权限。

**有效性：**

提供的 POC 代码描述了一种利用此漏洞的有效方法。它包括以下步骤：

1.  创建一个恶意脚本（poc.py），该脚本执行提权操作（例如，启动一个 root shell）。
2.  将此脚本重命名为 ndsudo 允许执行的命令之一（例如 nvme）。
3.  将包含恶意脚本的目录添加到 PATH 环境变量的开头。
4.  运行 ndsudo nvme-list，这将导致 ndsudo 执行恶意脚本，从而获得 root 权限。

**投毒风险：**

提供的代码仓库本身投毒风险较低。`poc.py` 代码非常简单，仅包含提权执行bash的代码，不太可能存在隐藏的恶意代码。`README.md` 文件提供了清晰的漏洞利用说明。但用户仍然需要注意，在实际环境中，从不可信的来源下载或复制漏洞利用代码都存在一定的风险，需要仔细检查代码是否存在恶意行为，再执行。

**利用方式：**

1.  **漏洞原理：** `ndsudo` 以 root 权限运行，但其搜索命令的路径依赖于用户的 `PATH` 环境变量。
2.  **攻击步骤：**
    *   创建恶意脚本，该脚本执行提权操作（例如，启动一个 root shell）。
    *   将此脚本重命名为 `ndsudo` 允许执行的命令之一（通过 `ndsudo --help` 查看）。
    *   将包含恶意脚本的目录添加到 `PATH` 环境变量的开头，确保恶意脚本优先被搜索到。
    *   运行 `ndsudo <allowed_command>`，这将导致 `ndsudo` 执行恶意脚本，从而获得 root 权限。

**总结：**

该漏洞利用较为简单，POC 代码的有效性较高，但应注意来源不明的exploit代码的潜在投毒风险。该漏洞允许低权限用户通过操纵 `PATH` 环境变量，利用 SUID 程序 `ndsudo` 提升至 root 权限。务必及时升级 Netdata 版本以修复此漏洞。

**项目地址:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**来源**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata agent运行在受影响版本，且攻击者能够执行本地代码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具拥有 SUID 权限，允许执行某些特权命令。漏洞的根源在于 `ndsudo` 使用不安全的 PATH 环境变量来查找要执行的命令，攻击者可以通过在 PATH 中插入恶意程序，让 `ndsudo` 执行攻击者控制的代码，从而提升权限到 root。

**利用方式：**

1.  **查找 `ndsudo` 路径：** 通常位于 `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`，但需要通过 `find` 命令确认。
2.  **创建恶意程序：** 创建一个 C 程序，该程序调用 `setuid(0)` 和 `setgid(0)` 设置用户和组 ID 为 root，然后执行一个 shell (例如 `/bin/bash -p`)。需要使用 `gcc` 编译该程序，例如命名为 `arcconf`。
3.  **修改 PATH 环境变量：** 将包含恶意程序的目录添加到 PATH 环境变量的开头。例如，如果恶意程序位于 `/tmp` 目录下，则执行 `PATH=/tmp:$PATH`。
4.  **执行 `ndsudo` 命令：** 使用 `ndsudo` 执行它支持的命令，但该命令依赖于攻击者放置的恶意程序。例如，`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`。`ndsudo` 会尝试执行 `arcconf`，但由于 PATH 环境变量被修改，它会执行攻击者在 `/tmp` 目录下创建的恶意程序。
5.  **获得 root shell：** 如果一切顺利，攻击者将获得一个 root shell。

**投毒风险分析：**

提供的 POC 代码中，`arcconf.c` 的目的是创建一个提权的 shell，没有明显的投毒行为。 但从 github 下载预编译二进制文件 `arcconf` 时，存在一定的投毒风险。攻击者可能在预编译的二进制文件中植入恶意代码。考虑到从 github 上下载的二进制文件存在潜在风险，故投毒风险评估为5%。

**项目地址:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**来源**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo 本地权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户提升至 root 权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 和 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的 Netdata，且 ndsudo 工具设置了 SUID root 权限，并且攻击者可以执行 ndsudo。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具以 root 权限运行，但它使用 `PATH` 环境变量来查找要执行的命令。攻击者可以通过在 `PATH` 环境变量中添加一个指向恶意目录的路径，并在该目录中放置一个与 `ndsudo` 尝试执行的命令同名的恶意程序，从而以 root 权限执行任意代码。

**有效性:**

提供的 POC 代码是有效的。它展示了如何利用此漏洞。

**利用方式:**

1.  创建一个包含恶意程序（例如，反弹 shell）的目录。
2.  将恶意程序命名为 `ndsudo` 尝试执行的命令之一（例如，`nvme-list`）。
3.  将包含恶意程序的目录添加到 `PATH` 环境变量的开头。
4.  运行 `ndsudo` 命令。`ndsudo` 将执行恶意程序，从而使攻击者获得 root 权限。

**投毒风险:**

根据提供的代码分析，该仓库似乎主要提供了一个 checker 脚本来帮助安全研究人员和管理员识别和验证漏洞是否存在，旨在帮助防御者评估风险和验证补丁，而不是提供武器化的 PoC。因此，该仓库中存在作者隐藏的投毒代码的风险较低。

检查器代码会检查以下内容：

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (或安装位置) 的 SUID/所有权。
*   `PATH` 中早于常见系统路径的可写目录。
*   `ndsudo` 尝试执行的白名单子命令是否存在。
*   可选地运行 `ndsudo --test <subcommand>` 来打印已解析的命令而不执行它 (谨慎使用，先阅读代码)。

因此，**投毒风险评估为 0%**。


**项目地址:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**来源**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，攻击者可利用此漏洞获取root权限。

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 目标系统上运行受影响版本的netdata，且攻击者需要具有本地低权限账号。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 netdata 的 ndsudo 工具中，该工具以 root 权限运行，但其搜索路径由 PATH 环境变量控制。攻击者可以通过修改 PATH 环境变量，将恶意程序放置在 ndsudo 搜索路径中，当 ndsudo 调用外部命令时，会执行攻击者放置的恶意程序，从而获得 root 权限。

提供的 POC 代码是一个 C 程序，编译后可以直接执行一个具有 root 权限的 bash shell。攻击者需要首先创建一个包含此恶意程序的可写目录，然后修改 PATH 环境变量，将此目录添加到 PATH 的最前面。之后，当 ndsudo 执行任何外部命令时，都会首先执行攻击者放置的恶意程序，从而获得 root shell。

代码中没有发现明显的投毒行为。它只是简单地设置 uid 和 gid 为 0，然后执行 /bin/bash。因此，投毒风险评估为0%。

利用方式总结：
1.  利用需要先获得一个netdata软件的低权限账号。
2.  创建一个包含恶意程序（例如 POC 中的 C 程序编译后的可执行文件）的可写目录。
3.  修改 PATH 环境变量，将该目录添加到 PATH 的最前面。
4.  触发 ndsudo 执行任何外部命令，这将导致恶意程序以 root 权限执行，从而获得 root shell。

**项目地址:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**来源**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 及 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的netdata，且具有本地shell访问权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 存在于Netdata的`ndsudo`工具中，该工具是具有SUID root权限的可执行文件。漏洞原因是`ndsudo`的搜索路径由`PATH`环境变量控制，攻击者可以通过修改`PATH`环境变量，将恶意程序放置在前面，当`ndsudo`执行信任的命令时，会执行攻击者放置的恶意程序，从而实现本地提权。提供的POC代码通过以下步骤利用该漏洞：

1.  **编译恶意payload:**  `poc.c` 编译成 `nvme`，该程序的功能是执行 `/bin/bash`，并设置 UID 和 GID 为 0，即root权限。
2.  **传输payload到目标系统:**  将编译好的`nvme`上传到目标系统的`/tmp`目录。
3.  **准备payload执行:**  给`/tmp/nvme`添加可执行权限，然后将`/tmp`添加到`PATH`环境变量的最前面。
4.  **触发`ndsudo`执行payload:** 运行`./ndsudo nvme-list`，`ndsudo`会执行`/tmp/nvme`，由于该程序会将权限提升为root，因此攻击者可以获得root shell。

**有效性：** 该POC代码描述的利用方式是有效的。

**投毒风险：** 提供的`poc.c`代码功能清晰，仅为执行`/bin/bash`并提升权限，不存在隐藏的投毒代码。README文件描述了完整的利用过程。因此，投毒风险为0%。

**利用方式：** 攻击者通过控制`PATH`环境变量，欺骗`ndsudo`执行恶意程序，从而获得root权限。

**项目地址:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**来源**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.44.0-60, < 1.45.3

**利用条件:** 需要netdata agent存在漏洞版本且ndsudo被调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019是Netdata Agent中ndsudo工具的一个本地权限提升漏洞。ndsudo是一个root用户拥有的、设置了SUID位的可执行文件。它本应只运行一组受限的外部命令，但是其搜索路径由PATH环境变量控制。攻击者可以通过控制PATH环境变量来指定ndsudo查找这些命令的位置，如果这个位置是攻击者具有写权限的目录，那么攻击者就可以放置恶意程序并以root权限执行。

**有效性：** 根据漏洞描述和搜索结果，该漏洞存在利用价值，通过控制PATH环境变量来执行恶意程序达到提权效果。

**投毒风险：** 提供的代码仅为GNU GENERAL PUBLIC LICENSE，是开源协议许可，不包含直接的攻击payload或恶意代码。但license本身也是一种代码，如果结合特定的上下文，协议内容也可能被滥用。例如，攻击者可能创建一个合法的程序，但其行为违反了协议条款，从而造成损害。此仓库中发现直接投毒代码的概率较低，但存在潜在的滥用风险，估计投毒风险为5%。

**利用方式：**
1.  确定目标系统上运行的Netdata Agent版本在受影响范围内（>= 1.44.0-60, < 1.45.3）。
2.  查找ndsudo工具的位置。
3.  创建一个包含恶意命令的目录，例如/tmp/evil。
4.  将恶意程序（如反弹shell）放置到/tmp/evil目录下，并命名为ndsudo尝试执行的命令（例如，`ping`，`date` 等, 具体取决于 ndsudo 允许执行的命令）。
5.  修改PATH环境变量，将/tmp/evil添加到PATH的最前面：`export PATH=/tmp/evil:$PATH`。
6.  运行ndsudo，它将执行/tmp/evil目录下的恶意程序，从而获得root权限。

**项目地址:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**来源**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户通过PATH劫持执行任意代码

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata Agent存在ndsudo，且版本在受影响范围内，以及可控的PATH环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是Netdata中`ndsudo`工具的一个本地提权漏洞。`ndsudo`是一个具有SUID root权限的可执行文件，但它使用`PATH`环境变量来查找要执行的命令。攻击者可以通过将恶意可执行文件放置在`PATH`环境变量中优先于系统目录的位置，诱使`ndsudo`执行该恶意程序，从而获得root权限。

**漏洞利用方式：**
1.  查找具有SUID权限的`ndsudo`可执行文件的路径。
2.  创建一个恶意的可执行文件(例如`nvme`)，该文件执行攻击者希望执行的任意代码。提供的`payload.c`是一个简单的示例，它会生成一个root shell。
3.  修改`PATH`环境变量，将当前目录(或包含恶意可执行文件的目录)添加到`PATH`的开头。
4.  调用`ndsudo`，并指定一个它允许执行的命令(例如`nvme-list`)。由于`PATH`已经被修改，`ndsudo`会执行攻击者放置的恶意`nvme`可执行文件，从而以root权限执行任意代码。

**有效性：**
提供的PoC代码是有效的。它包含一个shell脚本，用于查找`ndsudo`，创建一个`nvme` payload，修改`PATH`，然后执行`ndsudo`。README.md文件描述了如何编译`payload.c`并使用脚本。

**投毒风险：**
查看了提供的三个文件内容，没有发现任何投毒代码。其中，CVE-2024-32019.sh脚本用于利用漏洞，payload.c用于编译恶意payload，README.md文件描述了漏洞和利用方法，都是正常的利用代码。
因此，投毒风险为0%。

**项目地址:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**来源**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统安装了受影响版本的Netdata

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32019是Netdata ndsudo工具中的一个本地权限提升漏洞。ndsudo是一个SUID root的程序，但它使用了PATH环境变量来查找要执行的外部命令，攻击者可以通过修改PATH环境变量指向一个自己可控的目录，并在该目录下放置恶意程序，当ndsudo执行外部命令时，会执行攻击者放置的恶意程序，从而获得root权限。

**漏洞利用方式：**

1.  **漏洞检测：** 首先，检查目标系统上是否存在`/opt`目录下的`ndsudo`程序，并且确认该程序是否为root所有且设置了SUID权限。同时，使用`strings`命令检查`ndsudo`程序中是否存在对`nvme`、`smartctl`、`hdparm`或`sensors`等外部命令的调用，如果存在，则说明该程序可能受到PATH环境变量的影响。
2.  **恶意程序编译：** 编译一个C程序，该程序的功能是设置UID和GID为0，然后执行`/bin/bash`，从而获取root shell。
3.  **恶意程序上传：** 通过SFTP将编译好的恶意程序上传到目标系统上的一个攻击者可控的目录，例如`/tmp`。
4.  **环境变量修改：** 修改PATH环境变量，将攻击者可控的目录添加到PATH环境变量的最前面，确保`ndsudo`程序在执行外部命令时首先在该目录下查找。
5.  **漏洞触发：** 执行`ndsudo`程序，当它调用外部命令时，会执行攻击者上传的恶意程序，从而获取root权限。
6.  **交互式Shell：** 漏洞利用代码提供交互式shell。

**投毒风险分析：**

此POC代码本身主要目的是为了验证漏洞，实现本地提权。但是，该脚本包含以下潜在的投毒风险：

*   **编译和传输恶意代码：** 脚本会自动编译C代码生成二进制文件，并上传到目标机器。虽然C代码的内容是提权，但如果恶意攻击者修改了C代码，就可能包含其他恶意行为，例如植入后门、收集信息等。
*   **远程执行代码：**  脚本通过ssh执行远程命令，存在被篡改的风险，可能执行额外的恶意操作。
*   **残留文件：** 编译后的二进制文件和上传的恶意程序可能在目标系统上留下痕迹，如果这些文件被恶意利用，可能会导致进一步的安全问题。

尽管存在这些风险，但总体来说，该POC代码的风险仍然可控，主要风险集中在代码的篡改和恶意利用上。为了降低风险，建议从可信的来源获取POC代码，并仔细检查代码内容，确保其没有恶意行为。此外，在测试完成后，应及时清理目标系统上的残留文件。

投毒风险预估为10%，因为代码相对简洁，主要功能是漏洞验证和利用，但仍然存在被篡改和恶意利用的可能性。

**项目地址:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**来源**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地shell访问，能够执行ndsudo命令

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-32019 是 Netdata 中 ndsudo 工具的一个本地权限提升漏洞。ndsudo 是一个 SUID root 的可执行文件，但它使用 PATH 环境变量来查找要执行的命令。攻击者可以通过将恶意脚本放置在 PATH 环境变量中优先级更高的目录中，并将其命名为 ndsudo 允许执行的命令（例如 nvme），来欺骗 ndsudo 执行该恶意脚本并获得 root 权限。

**有效性：**

提供的 POC 代码描述了一种利用此漏洞的有效方法。它包括以下步骤：

1.  创建一个恶意脚本（poc.py），该脚本执行提权操作（例如，启动一个 root shell）。
2.  将此脚本重命名为 ndsudo 允许执行的命令之一（例如 nvme）。
3.  将包含恶意脚本的目录添加到 PATH 环境变量的开头。
4.  运行 ndsudo nvme-list，这将导致 ndsudo 执行恶意脚本，从而获得 root 权限。

**投毒风险：**

提供的代码仓库本身投毒风险较低。`poc.py` 代码非常简单，仅包含提权执行bash的代码，不太可能存在隐藏的恶意代码。`README.md` 文件提供了清晰的漏洞利用说明。但用户仍然需要注意，在实际环境中，从不可信的来源下载或复制漏洞利用代码都存在一定的风险，需要仔细检查代码是否存在恶意行为，再执行。

**利用方式：**

1.  **漏洞原理：** `ndsudo` 以 root 权限运行，但其搜索命令的路径依赖于用户的 `PATH` 环境变量。
2.  **攻击步骤：**
    *   创建恶意脚本，该脚本执行提权操作（例如，启动一个 root shell）。
    *   将此脚本重命名为 `ndsudo` 允许执行的命令之一（通过 `ndsudo --help` 查看）。
    *   将包含恶意脚本的目录添加到 `PATH` 环境变量的开头，确保恶意脚本优先被搜索到。
    *   运行 `ndsudo <allowed_command>`，这将导致 `ndsudo` 执行恶意脚本，从而获得 root 权限。

**总结：**

该漏洞利用较为简单，POC 代码的有效性较高，但应注意来源不明的exploit代码的潜在投毒风险。该漏洞允许低权限用户通过操纵 `PATH` 环境变量，利用 SUID 程序 `ndsudo` 提升至 root 权限。务必及时升级 Netdata 版本以修复此漏洞。

**项目地址:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**来源**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata agent运行在受影响版本，且攻击者能够执行本地代码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具拥有 SUID 权限，允许执行某些特权命令。漏洞的根源在于 `ndsudo` 使用不安全的 PATH 环境变量来查找要执行的命令，攻击者可以通过在 PATH 中插入恶意程序，让 `ndsudo` 执行攻击者控制的代码，从而提升权限到 root。

**利用方式：**

1.  **查找 `ndsudo` 路径：** 通常位于 `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`，但需要通过 `find` 命令确认。
2.  **创建恶意程序：** 创建一个 C 程序，该程序调用 `setuid(0)` 和 `setgid(0)` 设置用户和组 ID 为 root，然后执行一个 shell (例如 `/bin/bash -p`)。需要使用 `gcc` 编译该程序，例如命名为 `arcconf`。
3.  **修改 PATH 环境变量：** 将包含恶意程序的目录添加到 PATH 环境变量的开头。例如，如果恶意程序位于 `/tmp` 目录下，则执行 `PATH=/tmp:$PATH`。
4.  **执行 `ndsudo` 命令：** 使用 `ndsudo` 执行它支持的命令，但该命令依赖于攻击者放置的恶意程序。例如，`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`。`ndsudo` 会尝试执行 `arcconf`，但由于 PATH 环境变量被修改，它会执行攻击者在 `/tmp` 目录下创建的恶意程序。
5.  **获得 root shell：** 如果一切顺利，攻击者将获得一个 root shell。

**投毒风险分析：**

提供的 POC 代码中，`arcconf.c` 的目的是创建一个提权的 shell，没有明显的投毒行为。 但从 github 下载预编译二进制文件 `arcconf` 时，存在一定的投毒风险。攻击者可能在预编译的二进制文件中植入恶意代码。考虑到从 github 上下载的二进制文件存在潜在风险，故投毒风险评估为5%。

**项目地址:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**来源**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo 本地权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户提升至 root 权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 和 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的 Netdata，且 ndsudo 工具设置了 SUID root 权限，并且攻击者可以执行 ndsudo。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具以 root 权限运行，但它使用 `PATH` 环境变量来查找要执行的命令。攻击者可以通过在 `PATH` 环境变量中添加一个指向恶意目录的路径，并在该目录中放置一个与 `ndsudo` 尝试执行的命令同名的恶意程序，从而以 root 权限执行任意代码。

**有效性:**

提供的 POC 代码是有效的。它展示了如何利用此漏洞。

**利用方式:**

1.  创建一个包含恶意程序（例如，反弹 shell）的目录。
2.  将恶意程序命名为 `ndsudo` 尝试执行的命令之一（例如，`nvme-list`）。
3.  将包含恶意程序的目录添加到 `PATH` 环境变量的开头。
4.  运行 `ndsudo` 命令。`ndsudo` 将执行恶意程序，从而使攻击者获得 root 权限。

**投毒风险:**

根据提供的代码分析，该仓库似乎主要提供了一个 checker 脚本来帮助安全研究人员和管理员识别和验证漏洞是否存在，旨在帮助防御者评估风险和验证补丁，而不是提供武器化的 PoC。因此，该仓库中存在作者隐藏的投毒代码的风险较低。

检查器代码会检查以下内容：

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (或安装位置) 的 SUID/所有权。
*   `PATH` 中早于常见系统路径的可写目录。
*   `ndsudo` 尝试执行的白名单子命令是否存在。
*   可选地运行 `ndsudo --test <subcommand>` 来打印已解析的命令而不执行它 (谨慎使用，先阅读代码)。

因此，**投毒风险评估为 0%**。


**项目地址:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**来源**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，攻击者可利用此漏洞获取root权限。

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 目标系统上运行受影响版本的netdata，且攻击者需要具有本地低权限账号。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 netdata 的 ndsudo 工具中，该工具以 root 权限运行，但其搜索路径由 PATH 环境变量控制。攻击者可以通过修改 PATH 环境变量，将恶意程序放置在 ndsudo 搜索路径中，当 ndsudo 调用外部命令时，会执行攻击者放置的恶意程序，从而获得 root 权限。

提供的 POC 代码是一个 C 程序，编译后可以直接执行一个具有 root 权限的 bash shell。攻击者需要首先创建一个包含此恶意程序的可写目录，然后修改 PATH 环境变量，将此目录添加到 PATH 的最前面。之后，当 ndsudo 执行任何外部命令时，都会首先执行攻击者放置的恶意程序，从而获得 root shell。

代码中没有发现明显的投毒行为。它只是简单地设置 uid 和 gid 为 0，然后执行 /bin/bash。因此，投毒风险评估为0%。

利用方式总结：
1.  利用需要先获得一个netdata软件的低权限账号。
2.  创建一个包含恶意程序（例如 POC 中的 C 程序编译后的可执行文件）的可写目录。
3.  修改 PATH 环境变量，将该目录添加到 PATH 的最前面。
4.  触发 ndsudo 执行任何外部命令，这将导致恶意程序以 root 权限执行，从而获得 root shell。

**项目地址:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**来源**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 及 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的netdata，且具有本地shell访问权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 存在于Netdata的`ndsudo`工具中，该工具是具有SUID root权限的可执行文件。漏洞原因是`ndsudo`的搜索路径由`PATH`环境变量控制，攻击者可以通过修改`PATH`环境变量，将恶意程序放置在前面，当`ndsudo`执行信任的命令时，会执行攻击者放置的恶意程序，从而实现本地提权。提供的POC代码通过以下步骤利用该漏洞：

1.  **编译恶意payload:**  `poc.c` 编译成 `nvme`，该程序的功能是执行 `/bin/bash`，并设置 UID 和 GID 为 0，即root权限。
2.  **传输payload到目标系统:**  将编译好的`nvme`上传到目标系统的`/tmp`目录。
3.  **准备payload执行:**  给`/tmp/nvme`添加可执行权限，然后将`/tmp`添加到`PATH`环境变量的最前面。
4.  **触发`ndsudo`执行payload:** 运行`./ndsudo nvme-list`，`ndsudo`会执行`/tmp/nvme`，由于该程序会将权限提升为root，因此攻击者可以获得root shell。

**有效性：** 该POC代码描述的利用方式是有效的。

**投毒风险：** 提供的`poc.c`代码功能清晰，仅为执行`/bin/bash`并提升权限，不存在隐藏的投毒代码。README文件描述了完整的利用过程。因此，投毒风险为0%。

**利用方式：** 攻击者通过控制`PATH`环境变量，欺骗`ndsudo`执行恶意程序，从而获得root权限。

**项目地址:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**来源**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.44.0-60, < 1.45.3

**利用条件:** 需要netdata agent存在漏洞版本且ndsudo被调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019是Netdata Agent中ndsudo工具的一个本地权限提升漏洞。ndsudo是一个root用户拥有的、设置了SUID位的可执行文件。它本应只运行一组受限的外部命令，但是其搜索路径由PATH环境变量控制。攻击者可以通过控制PATH环境变量来指定ndsudo查找这些命令的位置，如果这个位置是攻击者具有写权限的目录，那么攻击者就可以放置恶意程序并以root权限执行。

**有效性：** 根据漏洞描述和搜索结果，该漏洞存在利用价值，通过控制PATH环境变量来执行恶意程序达到提权效果。

**投毒风险：** 提供的代码仅为GNU GENERAL PUBLIC LICENSE，是开源协议许可，不包含直接的攻击payload或恶意代码。但license本身也是一种代码，如果结合特定的上下文，协议内容也可能被滥用。例如，攻击者可能创建一个合法的程序，但其行为违反了协议条款，从而造成损害。此仓库中发现直接投毒代码的概率较低，但存在潜在的滥用风险，估计投毒风险为5%。

**利用方式：**
1.  确定目标系统上运行的Netdata Agent版本在受影响范围内（>= 1.44.0-60, < 1.45.3）。
2.  查找ndsudo工具的位置。
3.  创建一个包含恶意命令的目录，例如/tmp/evil。
4.  将恶意程序（如反弹shell）放置到/tmp/evil目录下，并命名为ndsudo尝试执行的命令（例如，`ping`，`date` 等, 具体取决于 ndsudo 允许执行的命令）。
5.  修改PATH环境变量，将/tmp/evil添加到PATH的最前面：`export PATH=/tmp/evil:$PATH`。
6.  运行ndsudo，它将执行/tmp/evil目录下的恶意程序，从而获得root权限。

**项目地址:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**来源**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户通过PATH劫持执行任意代码

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata Agent存在ndsudo，且版本在受影响范围内，以及可控的PATH环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是Netdata中`ndsudo`工具的一个本地提权漏洞。`ndsudo`是一个具有SUID root权限的可执行文件，但它使用`PATH`环境变量来查找要执行的命令。攻击者可以通过将恶意可执行文件放置在`PATH`环境变量中优先于系统目录的位置，诱使`ndsudo`执行该恶意程序，从而获得root权限。

**漏洞利用方式：**
1.  查找具有SUID权限的`ndsudo`可执行文件的路径。
2.  创建一个恶意的可执行文件(例如`nvme`)，该文件执行攻击者希望执行的任意代码。提供的`payload.c`是一个简单的示例，它会生成一个root shell。
3.  修改`PATH`环境变量，将当前目录(或包含恶意可执行文件的目录)添加到`PATH`的开头。
4.  调用`ndsudo`，并指定一个它允许执行的命令(例如`nvme-list`)。由于`PATH`已经被修改，`ndsudo`会执行攻击者放置的恶意`nvme`可执行文件，从而以root权限执行任意代码。

**有效性：**
提供的PoC代码是有效的。它包含一个shell脚本，用于查找`ndsudo`，创建一个`nvme` payload，修改`PATH`，然后执行`ndsudo`。README.md文件描述了如何编译`payload.c`并使用脚本。

**投毒风险：**
查看了提供的三个文件内容，没有发现任何投毒代码。其中，CVE-2024-32019.sh脚本用于利用漏洞，payload.c用于编译恶意payload，README.md文件描述了漏洞和利用方法，都是正常的利用代码。
因此，投毒风险为0%。

**项目地址:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**来源**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统安装了受影响版本的Netdata

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32019是Netdata ndsudo工具中的一个本地权限提升漏洞。ndsudo是一个SUID root的程序，但它使用了PATH环境变量来查找要执行的外部命令，攻击者可以通过修改PATH环境变量指向一个自己可控的目录，并在该目录下放置恶意程序，当ndsudo执行外部命令时，会执行攻击者放置的恶意程序，从而获得root权限。

**漏洞利用方式：**

1.  **漏洞检测：** 首先，检查目标系统上是否存在`/opt`目录下的`ndsudo`程序，并且确认该程序是否为root所有且设置了SUID权限。同时，使用`strings`命令检查`ndsudo`程序中是否存在对`nvme`、`smartctl`、`hdparm`或`sensors`等外部命令的调用，如果存在，则说明该程序可能受到PATH环境变量的影响。
2.  **恶意程序编译：** 编译一个C程序，该程序的功能是设置UID和GID为0，然后执行`/bin/bash`，从而获取root shell。
3.  **恶意程序上传：** 通过SFTP将编译好的恶意程序上传到目标系统上的一个攻击者可控的目录，例如`/tmp`。
4.  **环境变量修改：** 修改PATH环境变量，将攻击者可控的目录添加到PATH环境变量的最前面，确保`ndsudo`程序在执行外部命令时首先在该目录下查找。
5.  **漏洞触发：** 执行`ndsudo`程序，当它调用外部命令时，会执行攻击者上传的恶意程序，从而获取root权限。
6.  **交互式Shell：** 漏洞利用代码提供交互式shell。

**投毒风险分析：**

此POC代码本身主要目的是为了验证漏洞，实现本地提权。但是，该脚本包含以下潜在的投毒风险：

*   **编译和传输恶意代码：** 脚本会自动编译C代码生成二进制文件，并上传到目标机器。虽然C代码的内容是提权，但如果恶意攻击者修改了C代码，就可能包含其他恶意行为，例如植入后门、收集信息等。
*   **远程执行代码：**  脚本通过ssh执行远程命令，存在被篡改的风险，可能执行额外的恶意操作。
*   **残留文件：** 编译后的二进制文件和上传的恶意程序可能在目标系统上留下痕迹，如果这些文件被恶意利用，可能会导致进一步的安全问题。

尽管存在这些风险，但总体来说，该POC代码的风险仍然可控，主要风险集中在代码的篡改和恶意利用上。为了降低风险，建议从可信的来源获取POC代码，并仔细检查代码内容，确保其没有恶意行为。此外，在测试完成后，应及时清理目标系统上的残留文件。

投毒风险预估为10%，因为代码相对简洁，主要功能是漏洞验证和利用，但仍然存在被篡改和恶意利用的可能性。

**项目地址:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**来源**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地shell访问，能够执行ndsudo命令

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-32019 是 Netdata 中 ndsudo 工具的一个本地权限提升漏洞。ndsudo 是一个 SUID root 的可执行文件，但它使用 PATH 环境变量来查找要执行的命令。攻击者可以通过将恶意脚本放置在 PATH 环境变量中优先级更高的目录中，并将其命名为 ndsudo 允许执行的命令（例如 nvme），来欺骗 ndsudo 执行该恶意脚本并获得 root 权限。

**有效性：**

提供的 POC 代码描述了一种利用此漏洞的有效方法。它包括以下步骤：

1.  创建一个恶意脚本（poc.py），该脚本执行提权操作（例如，启动一个 root shell）。
2.  将此脚本重命名为 ndsudo 允许执行的命令之一（例如 nvme）。
3.  将包含恶意脚本的目录添加到 PATH 环境变量的开头。
4.  运行 ndsudo nvme-list，这将导致 ndsudo 执行恶意脚本，从而获得 root 权限。

**投毒风险：**

提供的代码仓库本身投毒风险较低。`poc.py` 代码非常简单，仅包含提权执行bash的代码，不太可能存在隐藏的恶意代码。`README.md` 文件提供了清晰的漏洞利用说明。但用户仍然需要注意，在实际环境中，从不可信的来源下载或复制漏洞利用代码都存在一定的风险，需要仔细检查代码是否存在恶意行为，再执行。

**利用方式：**

1.  **漏洞原理：** `ndsudo` 以 root 权限运行，但其搜索命令的路径依赖于用户的 `PATH` 环境变量。
2.  **攻击步骤：**
    *   创建恶意脚本，该脚本执行提权操作（例如，启动一个 root shell）。
    *   将此脚本重命名为 `ndsudo` 允许执行的命令之一（通过 `ndsudo --help` 查看）。
    *   将包含恶意脚本的目录添加到 `PATH` 环境变量的开头，确保恶意脚本优先被搜索到。
    *   运行 `ndsudo <allowed_command>`，这将导致 `ndsudo` 执行恶意脚本，从而获得 root 权限。

**总结：**

该漏洞利用较为简单，POC 代码的有效性较高，但应注意来源不明的exploit代码的潜在投毒风险。该漏洞允许低权限用户通过操纵 `PATH` 环境变量，利用 SUID 程序 `ndsudo` 提升至 root 权限。务必及时升级 Netdata 版本以修复此漏洞。

**项目地址:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**来源**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata agent运行在受影响版本，且攻击者能够执行本地代码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具拥有 SUID 权限，允许执行某些特权命令。漏洞的根源在于 `ndsudo` 使用不安全的 PATH 环境变量来查找要执行的命令，攻击者可以通过在 PATH 中插入恶意程序，让 `ndsudo` 执行攻击者控制的代码，从而提升权限到 root。

**利用方式：**

1.  **查找 `ndsudo` 路径：** 通常位于 `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`，但需要通过 `find` 命令确认。
2.  **创建恶意程序：** 创建一个 C 程序，该程序调用 `setuid(0)` 和 `setgid(0)` 设置用户和组 ID 为 root，然后执行一个 shell (例如 `/bin/bash -p`)。需要使用 `gcc` 编译该程序，例如命名为 `arcconf`。
3.  **修改 PATH 环境变量：** 将包含恶意程序的目录添加到 PATH 环境变量的开头。例如，如果恶意程序位于 `/tmp` 目录下，则执行 `PATH=/tmp:$PATH`。
4.  **执行 `ndsudo` 命令：** 使用 `ndsudo` 执行它支持的命令，但该命令依赖于攻击者放置的恶意程序。例如，`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`。`ndsudo` 会尝试执行 `arcconf`，但由于 PATH 环境变量被修改，它会执行攻击者在 `/tmp` 目录下创建的恶意程序。
5.  **获得 root shell：** 如果一切顺利，攻击者将获得一个 root shell。

**投毒风险分析：**

提供的 POC 代码中，`arcconf.c` 的目的是创建一个提权的 shell，没有明显的投毒行为。 但从 github 下载预编译二进制文件 `arcconf` 时，存在一定的投毒风险。攻击者可能在预编译的二进制文件中植入恶意代码。考虑到从 github 上下载的二进制文件存在潜在风险，故投毒风险评估为5%。

**项目地址:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**来源**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo 本地权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户提升至 root 权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 和 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的 Netdata，且 ndsudo 工具设置了 SUID root 权限，并且攻击者可以执行 ndsudo。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具以 root 权限运行，但它使用 `PATH` 环境变量来查找要执行的命令。攻击者可以通过在 `PATH` 环境变量中添加一个指向恶意目录的路径，并在该目录中放置一个与 `ndsudo` 尝试执行的命令同名的恶意程序，从而以 root 权限执行任意代码。

**有效性:**

提供的 POC 代码是有效的。它展示了如何利用此漏洞。

**利用方式:**

1.  创建一个包含恶意程序（例如，反弹 shell）的目录。
2.  将恶意程序命名为 `ndsudo` 尝试执行的命令之一（例如，`nvme-list`）。
3.  将包含恶意程序的目录添加到 `PATH` 环境变量的开头。
4.  运行 `ndsudo` 命令。`ndsudo` 将执行恶意程序，从而使攻击者获得 root 权限。

**投毒风险:**

根据提供的代码分析，该仓库似乎主要提供了一个 checker 脚本来帮助安全研究人员和管理员识别和验证漏洞是否存在，旨在帮助防御者评估风险和验证补丁，而不是提供武器化的 PoC。因此，该仓库中存在作者隐藏的投毒代码的风险较低。

检查器代码会检查以下内容：

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (或安装位置) 的 SUID/所有权。
*   `PATH` 中早于常见系统路径的可写目录。
*   `ndsudo` 尝试执行的白名单子命令是否存在。
*   可选地运行 `ndsudo --test <subcommand>` 来打印已解析的命令而不执行它 (谨慎使用，先阅读代码)。

因此，**投毒风险评估为 0%**。


**项目地址:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**来源**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，攻击者可利用此漏洞获取root权限。

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 目标系统上运行受影响版本的netdata，且攻击者需要具有本地低权限账号。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 netdata 的 ndsudo 工具中，该工具以 root 权限运行，但其搜索路径由 PATH 环境变量控制。攻击者可以通过修改 PATH 环境变量，将恶意程序放置在 ndsudo 搜索路径中，当 ndsudo 调用外部命令时，会执行攻击者放置的恶意程序，从而获得 root 权限。

提供的 POC 代码是一个 C 程序，编译后可以直接执行一个具有 root 权限的 bash shell。攻击者需要首先创建一个包含此恶意程序的可写目录，然后修改 PATH 环境变量，将此目录添加到 PATH 的最前面。之后，当 ndsudo 执行任何外部命令时，都会首先执行攻击者放置的恶意程序，从而获得 root shell。

代码中没有发现明显的投毒行为。它只是简单地设置 uid 和 gid 为 0，然后执行 /bin/bash。因此，投毒风险评估为0%。

利用方式总结：
1.  利用需要先获得一个netdata软件的低权限账号。
2.  创建一个包含恶意程序（例如 POC 中的 C 程序编译后的可执行文件）的可写目录。
3.  修改 PATH 环境变量，将该目录添加到 PATH 的最前面。
4.  触发 ndsudo 执行任何外部命令，这将导致恶意程序以 root 权限执行，从而获得 root shell。

**项目地址:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**来源**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 及 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的netdata，且具有本地shell访问权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 存在于Netdata的`ndsudo`工具中，该工具是具有SUID root权限的可执行文件。漏洞原因是`ndsudo`的搜索路径由`PATH`环境变量控制，攻击者可以通过修改`PATH`环境变量，将恶意程序放置在前面，当`ndsudo`执行信任的命令时，会执行攻击者放置的恶意程序，从而实现本地提权。提供的POC代码通过以下步骤利用该漏洞：

1.  **编译恶意payload:**  `poc.c` 编译成 `nvme`，该程序的功能是执行 `/bin/bash`，并设置 UID 和 GID 为 0，即root权限。
2.  **传输payload到目标系统:**  将编译好的`nvme`上传到目标系统的`/tmp`目录。
3.  **准备payload执行:**  给`/tmp/nvme`添加可执行权限，然后将`/tmp`添加到`PATH`环境变量的最前面。
4.  **触发`ndsudo`执行payload:** 运行`./ndsudo nvme-list`，`ndsudo`会执行`/tmp/nvme`，由于该程序会将权限提升为root，因此攻击者可以获得root shell。

**有效性：** 该POC代码描述的利用方式是有效的。

**投毒风险：** 提供的`poc.c`代码功能清晰，仅为执行`/bin/bash`并提升权限，不存在隐藏的投毒代码。README文件描述了完整的利用过程。因此，投毒风险为0%。

**利用方式：** 攻击者通过控制`PATH`环境变量，欺骗`ndsudo`执行恶意程序，从而获得root权限。

**项目地址:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**来源**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.44.0-60, < 1.45.3

**利用条件:** 需要netdata agent存在漏洞版本且ndsudo被调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019是Netdata Agent中ndsudo工具的一个本地权限提升漏洞。ndsudo是一个root用户拥有的、设置了SUID位的可执行文件。它本应只运行一组受限的外部命令，但是其搜索路径由PATH环境变量控制。攻击者可以通过控制PATH环境变量来指定ndsudo查找这些命令的位置，如果这个位置是攻击者具有写权限的目录，那么攻击者就可以放置恶意程序并以root权限执行。

**有效性：** 根据漏洞描述和搜索结果，该漏洞存在利用价值，通过控制PATH环境变量来执行恶意程序达到提权效果。

**投毒风险：** 提供的代码仅为GNU GENERAL PUBLIC LICENSE，是开源协议许可，不包含直接的攻击payload或恶意代码。但license本身也是一种代码，如果结合特定的上下文，协议内容也可能被滥用。例如，攻击者可能创建一个合法的程序，但其行为违反了协议条款，从而造成损害。此仓库中发现直接投毒代码的概率较低，但存在潜在的滥用风险，估计投毒风险为5%。

**利用方式：**
1.  确定目标系统上运行的Netdata Agent版本在受影响范围内（>= 1.44.0-60, < 1.45.3）。
2.  查找ndsudo工具的位置。
3.  创建一个包含恶意命令的目录，例如/tmp/evil。
4.  将恶意程序（如反弹shell）放置到/tmp/evil目录下，并命名为ndsudo尝试执行的命令（例如，`ping`，`date` 等, 具体取决于 ndsudo 允许执行的命令）。
5.  修改PATH环境变量，将/tmp/evil添加到PATH的最前面：`export PATH=/tmp/evil:$PATH`。
6.  运行ndsudo，它将执行/tmp/evil目录下的恶意程序，从而获得root权限。

**项目地址:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**来源**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户通过PATH劫持执行任意代码

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata Agent存在ndsudo，且版本在受影响范围内，以及可控的PATH环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是Netdata中`ndsudo`工具的一个本地提权漏洞。`ndsudo`是一个具有SUID root权限的可执行文件，但它使用`PATH`环境变量来查找要执行的命令。攻击者可以通过将恶意可执行文件放置在`PATH`环境变量中优先于系统目录的位置，诱使`ndsudo`执行该恶意程序，从而获得root权限。

**漏洞利用方式：**
1.  查找具有SUID权限的`ndsudo`可执行文件的路径。
2.  创建一个恶意的可执行文件(例如`nvme`)，该文件执行攻击者希望执行的任意代码。提供的`payload.c`是一个简单的示例，它会生成一个root shell。
3.  修改`PATH`环境变量，将当前目录(或包含恶意可执行文件的目录)添加到`PATH`的开头。
4.  调用`ndsudo`，并指定一个它允许执行的命令(例如`nvme-list`)。由于`PATH`已经被修改，`ndsudo`会执行攻击者放置的恶意`nvme`可执行文件，从而以root权限执行任意代码。

**有效性：**
提供的PoC代码是有效的。它包含一个shell脚本，用于查找`ndsudo`，创建一个`nvme` payload，修改`PATH`，然后执行`ndsudo`。README.md文件描述了如何编译`payload.c`并使用脚本。

**投毒风险：**
查看了提供的三个文件内容，没有发现任何投毒代码。其中，CVE-2024-32019.sh脚本用于利用漏洞，payload.c用于编译恶意payload，README.md文件描述了漏洞和利用方法，都是正常的利用代码。
因此，投毒风险为0%。

**项目地址:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**来源**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统安装了受影响版本的Netdata

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32019是Netdata ndsudo工具中的一个本地权限提升漏洞。ndsudo是一个SUID root的程序，但它使用了PATH环境变量来查找要执行的外部命令，攻击者可以通过修改PATH环境变量指向一个自己可控的目录，并在该目录下放置恶意程序，当ndsudo执行外部命令时，会执行攻击者放置的恶意程序，从而获得root权限。

**漏洞利用方式：**

1.  **漏洞检测：** 首先，检查目标系统上是否存在`/opt`目录下的`ndsudo`程序，并且确认该程序是否为root所有且设置了SUID权限。同时，使用`strings`命令检查`ndsudo`程序中是否存在对`nvme`、`smartctl`、`hdparm`或`sensors`等外部命令的调用，如果存在，则说明该程序可能受到PATH环境变量的影响。
2.  **恶意程序编译：** 编译一个C程序，该程序的功能是设置UID和GID为0，然后执行`/bin/bash`，从而获取root shell。
3.  **恶意程序上传：** 通过SFTP将编译好的恶意程序上传到目标系统上的一个攻击者可控的目录，例如`/tmp`。
4.  **环境变量修改：** 修改PATH环境变量，将攻击者可控的目录添加到PATH环境变量的最前面，确保`ndsudo`程序在执行外部命令时首先在该目录下查找。
5.  **漏洞触发：** 执行`ndsudo`程序，当它调用外部命令时，会执行攻击者上传的恶意程序，从而获取root权限。
6.  **交互式Shell：** 漏洞利用代码提供交互式shell。

**投毒风险分析：**

此POC代码本身主要目的是为了验证漏洞，实现本地提权。但是，该脚本包含以下潜在的投毒风险：

*   **编译和传输恶意代码：** 脚本会自动编译C代码生成二进制文件，并上传到目标机器。虽然C代码的内容是提权，但如果恶意攻击者修改了C代码，就可能包含其他恶意行为，例如植入后门、收集信息等。
*   **远程执行代码：**  脚本通过ssh执行远程命令，存在被篡改的风险，可能执行额外的恶意操作。
*   **残留文件：** 编译后的二进制文件和上传的恶意程序可能在目标系统上留下痕迹，如果这些文件被恶意利用，可能会导致进一步的安全问题。

尽管存在这些风险，但总体来说，该POC代码的风险仍然可控，主要风险集中在代码的篡改和恶意利用上。为了降低风险，建议从可信的来源获取POC代码，并仔细检查代码内容，确保其没有恶意行为。此外，在测试完成后，应及时清理目标系统上的残留文件。

投毒风险预估为10%，因为代码相对简洁，主要功能是漏洞验证和利用，但仍然存在被篡改和恶意利用的可能性。

**项目地址:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**来源**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地shell访问，能够执行ndsudo命令

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-32019 是 Netdata 中 ndsudo 工具的一个本地权限提升漏洞。ndsudo 是一个 SUID root 的可执行文件，但它使用 PATH 环境变量来查找要执行的命令。攻击者可以通过将恶意脚本放置在 PATH 环境变量中优先级更高的目录中，并将其命名为 ndsudo 允许执行的命令（例如 nvme），来欺骗 ndsudo 执行该恶意脚本并获得 root 权限。

**有效性：**

提供的 POC 代码描述了一种利用此漏洞的有效方法。它包括以下步骤：

1.  创建一个恶意脚本（poc.py），该脚本执行提权操作（例如，启动一个 root shell）。
2.  将此脚本重命名为 ndsudo 允许执行的命令之一（例如 nvme）。
3.  将包含恶意脚本的目录添加到 PATH 环境变量的开头。
4.  运行 ndsudo nvme-list，这将导致 ndsudo 执行恶意脚本，从而获得 root 权限。

**投毒风险：**

提供的代码仓库本身投毒风险较低。`poc.py` 代码非常简单，仅包含提权执行bash的代码，不太可能存在隐藏的恶意代码。`README.md` 文件提供了清晰的漏洞利用说明。但用户仍然需要注意，在实际环境中，从不可信的来源下载或复制漏洞利用代码都存在一定的风险，需要仔细检查代码是否存在恶意行为，再执行。

**利用方式：**

1.  **漏洞原理：** `ndsudo` 以 root 权限运行，但其搜索命令的路径依赖于用户的 `PATH` 环境变量。
2.  **攻击步骤：**
    *   创建恶意脚本，该脚本执行提权操作（例如，启动一个 root shell）。
    *   将此脚本重命名为 `ndsudo` 允许执行的命令之一（通过 `ndsudo --help` 查看）。
    *   将包含恶意脚本的目录添加到 `PATH` 环境变量的开头，确保恶意脚本优先被搜索到。
    *   运行 `ndsudo <allowed_command>`，这将导致 `ndsudo` 执行恶意脚本，从而获得 root 权限。

**总结：**

该漏洞利用较为简单，POC 代码的有效性较高，但应注意来源不明的exploit代码的潜在投毒风险。该漏洞允许低权限用户通过操纵 `PATH` 环境变量，利用 SUID 程序 `ndsudo` 提升至 root 权限。务必及时升级 Netdata 版本以修复此漏洞。

**项目地址:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**来源**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata agent运行在受影响版本，且攻击者能够执行本地代码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具拥有 SUID 权限，允许执行某些特权命令。漏洞的根源在于 `ndsudo` 使用不安全的 PATH 环境变量来查找要执行的命令，攻击者可以通过在 PATH 中插入恶意程序，让 `ndsudo` 执行攻击者控制的代码，从而提升权限到 root。

**利用方式：**

1.  **查找 `ndsudo` 路径：** 通常位于 `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`，但需要通过 `find` 命令确认。
2.  **创建恶意程序：** 创建一个 C 程序，该程序调用 `setuid(0)` 和 `setgid(0)` 设置用户和组 ID 为 root，然后执行一个 shell (例如 `/bin/bash -p`)。需要使用 `gcc` 编译该程序，例如命名为 `arcconf`。
3.  **修改 PATH 环境变量：** 将包含恶意程序的目录添加到 PATH 环境变量的开头。例如，如果恶意程序位于 `/tmp` 目录下，则执行 `PATH=/tmp:$PATH`。
4.  **执行 `ndsudo` 命令：** 使用 `ndsudo` 执行它支持的命令，但该命令依赖于攻击者放置的恶意程序。例如，`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`。`ndsudo` 会尝试执行 `arcconf`，但由于 PATH 环境变量被修改，它会执行攻击者在 `/tmp` 目录下创建的恶意程序。
5.  **获得 root shell：** 如果一切顺利，攻击者将获得一个 root shell。

**投毒风险分析：**

提供的 POC 代码中，`arcconf.c` 的目的是创建一个提权的 shell，没有明显的投毒行为。 但从 github 下载预编译二进制文件 `arcconf` 时，存在一定的投毒风险。攻击者可能在预编译的二进制文件中植入恶意代码。考虑到从 github 上下载的二进制文件存在潜在风险，故投毒风险评估为5%。

**项目地址:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**来源**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo 本地权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户提升至 root 权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 和 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的 Netdata，且 ndsudo 工具设置了 SUID root 权限，并且攻击者可以执行 ndsudo。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具以 root 权限运行，但它使用 `PATH` 环境变量来查找要执行的命令。攻击者可以通过在 `PATH` 环境变量中添加一个指向恶意目录的路径，并在该目录中放置一个与 `ndsudo` 尝试执行的命令同名的恶意程序，从而以 root 权限执行任意代码。

**有效性:**

提供的 POC 代码是有效的。它展示了如何利用此漏洞。

**利用方式:**

1.  创建一个包含恶意程序（例如，反弹 shell）的目录。
2.  将恶意程序命名为 `ndsudo` 尝试执行的命令之一（例如，`nvme-list`）。
3.  将包含恶意程序的目录添加到 `PATH` 环境变量的开头。
4.  运行 `ndsudo` 命令。`ndsudo` 将执行恶意程序，从而使攻击者获得 root 权限。

**投毒风险:**

根据提供的代码分析，该仓库似乎主要提供了一个 checker 脚本来帮助安全研究人员和管理员识别和验证漏洞是否存在，旨在帮助防御者评估风险和验证补丁，而不是提供武器化的 PoC。因此，该仓库中存在作者隐藏的投毒代码的风险较低。

检查器代码会检查以下内容：

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (或安装位置) 的 SUID/所有权。
*   `PATH` 中早于常见系统路径的可写目录。
*   `ndsudo` 尝试执行的白名单子命令是否存在。
*   可选地运行 `ndsudo --test <subcommand>` 来打印已解析的命令而不执行它 (谨慎使用，先阅读代码)。

因此，**投毒风险评估为 0%**。


**项目地址:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**来源**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，攻击者可利用此漏洞获取root权限。

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 目标系统上运行受影响版本的netdata，且攻击者需要具有本地低权限账号。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 netdata 的 ndsudo 工具中，该工具以 root 权限运行，但其搜索路径由 PATH 环境变量控制。攻击者可以通过修改 PATH 环境变量，将恶意程序放置在 ndsudo 搜索路径中，当 ndsudo 调用外部命令时，会执行攻击者放置的恶意程序，从而获得 root 权限。

提供的 POC 代码是一个 C 程序，编译后可以直接执行一个具有 root 权限的 bash shell。攻击者需要首先创建一个包含此恶意程序的可写目录，然后修改 PATH 环境变量，将此目录添加到 PATH 的最前面。之后，当 ndsudo 执行任何外部命令时，都会首先执行攻击者放置的恶意程序，从而获得 root shell。

代码中没有发现明显的投毒行为。它只是简单地设置 uid 和 gid 为 0，然后执行 /bin/bash。因此，投毒风险评估为0%。

利用方式总结：
1.  利用需要先获得一个netdata软件的低权限账号。
2.  创建一个包含恶意程序（例如 POC 中的 C 程序编译后的可执行文件）的可写目录。
3.  修改 PATH 环境变量，将该目录添加到 PATH 的最前面。
4.  触发 ndsudo 执行任何外部命令，这将导致恶意程序以 root 权限执行，从而获得 root shell。

**项目地址:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**来源**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 及 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的netdata，且具有本地shell访问权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 存在于Netdata的`ndsudo`工具中，该工具是具有SUID root权限的可执行文件。漏洞原因是`ndsudo`的搜索路径由`PATH`环境变量控制，攻击者可以通过修改`PATH`环境变量，将恶意程序放置在前面，当`ndsudo`执行信任的命令时，会执行攻击者放置的恶意程序，从而实现本地提权。提供的POC代码通过以下步骤利用该漏洞：

1.  **编译恶意payload:**  `poc.c` 编译成 `nvme`，该程序的功能是执行 `/bin/bash`，并设置 UID 和 GID 为 0，即root权限。
2.  **传输payload到目标系统:**  将编译好的`nvme`上传到目标系统的`/tmp`目录。
3.  **准备payload执行:**  给`/tmp/nvme`添加可执行权限，然后将`/tmp`添加到`PATH`环境变量的最前面。
4.  **触发`ndsudo`执行payload:** 运行`./ndsudo nvme-list`，`ndsudo`会执行`/tmp/nvme`，由于该程序会将权限提升为root，因此攻击者可以获得root shell。

**有效性：** 该POC代码描述的利用方式是有效的。

**投毒风险：** 提供的`poc.c`代码功能清晰，仅为执行`/bin/bash`并提升权限，不存在隐藏的投毒代码。README文件描述了完整的利用过程。因此，投毒风险为0%。

**利用方式：** 攻击者通过控制`PATH`环境变量，欺骗`ndsudo`执行恶意程序，从而获得root权限。

**项目地址:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**来源**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.44.0-60, < 1.45.3

**利用条件:** 需要netdata agent存在漏洞版本且ndsudo被调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019是Netdata Agent中ndsudo工具的一个本地权限提升漏洞。ndsudo是一个root用户拥有的、设置了SUID位的可执行文件。它本应只运行一组受限的外部命令，但是其搜索路径由PATH环境变量控制。攻击者可以通过控制PATH环境变量来指定ndsudo查找这些命令的位置，如果这个位置是攻击者具有写权限的目录，那么攻击者就可以放置恶意程序并以root权限执行。

**有效性：** 根据漏洞描述和搜索结果，该漏洞存在利用价值，通过控制PATH环境变量来执行恶意程序达到提权效果。

**投毒风险：** 提供的代码仅为GNU GENERAL PUBLIC LICENSE，是开源协议许可，不包含直接的攻击payload或恶意代码。但license本身也是一种代码，如果结合特定的上下文，协议内容也可能被滥用。例如，攻击者可能创建一个合法的程序，但其行为违反了协议条款，从而造成损害。此仓库中发现直接投毒代码的概率较低，但存在潜在的滥用风险，估计投毒风险为5%。

**利用方式：**
1.  确定目标系统上运行的Netdata Agent版本在受影响范围内（>= 1.44.0-60, < 1.45.3）。
2.  查找ndsudo工具的位置。
3.  创建一个包含恶意命令的目录，例如/tmp/evil。
4.  将恶意程序（如反弹shell）放置到/tmp/evil目录下，并命名为ndsudo尝试执行的命令（例如，`ping`，`date` 等, 具体取决于 ndsudo 允许执行的命令）。
5.  修改PATH环境变量，将/tmp/evil添加到PATH的最前面：`export PATH=/tmp/evil:$PATH`。
6.  运行ndsudo，它将执行/tmp/evil目录下的恶意程序，从而获得root权限。

**项目地址:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**来源**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户通过PATH劫持执行任意代码

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata Agent存在ndsudo，且版本在受影响范围内，以及可控的PATH环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是Netdata中`ndsudo`工具的一个本地提权漏洞。`ndsudo`是一个具有SUID root权限的可执行文件，但它使用`PATH`环境变量来查找要执行的命令。攻击者可以通过将恶意可执行文件放置在`PATH`环境变量中优先于系统目录的位置，诱使`ndsudo`执行该恶意程序，从而获得root权限。

**漏洞利用方式：**
1.  查找具有SUID权限的`ndsudo`可执行文件的路径。
2.  创建一个恶意的可执行文件(例如`nvme`)，该文件执行攻击者希望执行的任意代码。提供的`payload.c`是一个简单的示例，它会生成一个root shell。
3.  修改`PATH`环境变量，将当前目录(或包含恶意可执行文件的目录)添加到`PATH`的开头。
4.  调用`ndsudo`，并指定一个它允许执行的命令(例如`nvme-list`)。由于`PATH`已经被修改，`ndsudo`会执行攻击者放置的恶意`nvme`可执行文件，从而以root权限执行任意代码。

**有效性：**
提供的PoC代码是有效的。它包含一个shell脚本，用于查找`ndsudo`，创建一个`nvme` payload，修改`PATH`，然后执行`ndsudo`。README.md文件描述了如何编译`payload.c`并使用脚本。

**投毒风险：**
查看了提供的三个文件内容，没有发现任何投毒代码。其中，CVE-2024-32019.sh脚本用于利用漏洞，payload.c用于编译恶意payload，README.md文件描述了漏洞和利用方法，都是正常的利用代码。
因此，投毒风险为0%。

**项目地址:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**来源**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统安装了受影响版本的Netdata

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32019是Netdata ndsudo工具中的一个本地权限提升漏洞。ndsudo是一个SUID root的程序，但它使用了PATH环境变量来查找要执行的外部命令，攻击者可以通过修改PATH环境变量指向一个自己可控的目录，并在该目录下放置恶意程序，当ndsudo执行外部命令时，会执行攻击者放置的恶意程序，从而获得root权限。

**漏洞利用方式：**

1.  **漏洞检测：** 首先，检查目标系统上是否存在`/opt`目录下的`ndsudo`程序，并且确认该程序是否为root所有且设置了SUID权限。同时，使用`strings`命令检查`ndsudo`程序中是否存在对`nvme`、`smartctl`、`hdparm`或`sensors`等外部命令的调用，如果存在，则说明该程序可能受到PATH环境变量的影响。
2.  **恶意程序编译：** 编译一个C程序，该程序的功能是设置UID和GID为0，然后执行`/bin/bash`，从而获取root shell。
3.  **恶意程序上传：** 通过SFTP将编译好的恶意程序上传到目标系统上的一个攻击者可控的目录，例如`/tmp`。
4.  **环境变量修改：** 修改PATH环境变量，将攻击者可控的目录添加到PATH环境变量的最前面，确保`ndsudo`程序在执行外部命令时首先在该目录下查找。
5.  **漏洞触发：** 执行`ndsudo`程序，当它调用外部命令时，会执行攻击者上传的恶意程序，从而获取root权限。
6.  **交互式Shell：** 漏洞利用代码提供交互式shell。

**投毒风险分析：**

此POC代码本身主要目的是为了验证漏洞，实现本地提权。但是，该脚本包含以下潜在的投毒风险：

*   **编译和传输恶意代码：** 脚本会自动编译C代码生成二进制文件，并上传到目标机器。虽然C代码的内容是提权，但如果恶意攻击者修改了C代码，就可能包含其他恶意行为，例如植入后门、收集信息等。
*   **远程执行代码：**  脚本通过ssh执行远程命令，存在被篡改的风险，可能执行额外的恶意操作。
*   **残留文件：** 编译后的二进制文件和上传的恶意程序可能在目标系统上留下痕迹，如果这些文件被恶意利用，可能会导致进一步的安全问题。

尽管存在这些风险，但总体来说，该POC代码的风险仍然可控，主要风险集中在代码的篡改和恶意利用上。为了降低风险，建议从可信的来源获取POC代码，并仔细检查代码内容，确保其没有恶意行为。此外，在测试完成后，应及时清理目标系统上的残留文件。

投毒风险预估为10%，因为代码相对简洁，主要功能是漏洞验证和利用，但仍然存在被篡改和恶意利用的可能性。

**项目地址:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**来源**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地shell访问，能够执行ndsudo命令

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-32019 是 Netdata 中 ndsudo 工具的一个本地权限提升漏洞。ndsudo 是一个 SUID root 的可执行文件，但它使用 PATH 环境变量来查找要执行的命令。攻击者可以通过将恶意脚本放置在 PATH 环境变量中优先级更高的目录中，并将其命名为 ndsudo 允许执行的命令（例如 nvme），来欺骗 ndsudo 执行该恶意脚本并获得 root 权限。

**有效性：**

提供的 POC 代码描述了一种利用此漏洞的有效方法。它包括以下步骤：

1.  创建一个恶意脚本（poc.py），该脚本执行提权操作（例如，启动一个 root shell）。
2.  将此脚本重命名为 ndsudo 允许执行的命令之一（例如 nvme）。
3.  将包含恶意脚本的目录添加到 PATH 环境变量的开头。
4.  运行 ndsudo nvme-list，这将导致 ndsudo 执行恶意脚本，从而获得 root 权限。

**投毒风险：**

提供的代码仓库本身投毒风险较低。`poc.py` 代码非常简单，仅包含提权执行bash的代码，不太可能存在隐藏的恶意代码。`README.md` 文件提供了清晰的漏洞利用说明。但用户仍然需要注意，在实际环境中，从不可信的来源下载或复制漏洞利用代码都存在一定的风险，需要仔细检查代码是否存在恶意行为，再执行。

**利用方式：**

1.  **漏洞原理：** `ndsudo` 以 root 权限运行，但其搜索命令的路径依赖于用户的 `PATH` 环境变量。
2.  **攻击步骤：**
    *   创建恶意脚本，该脚本执行提权操作（例如，启动一个 root shell）。
    *   将此脚本重命名为 `ndsudo` 允许执行的命令之一（通过 `ndsudo --help` 查看）。
    *   将包含恶意脚本的目录添加到 `PATH` 环境变量的开头，确保恶意脚本优先被搜索到。
    *   运行 `ndsudo <allowed_command>`，这将导致 `ndsudo` 执行恶意脚本，从而获得 root 权限。

**总结：**

该漏洞利用较为简单，POC 代码的有效性较高，但应注意来源不明的exploit代码的潜在投毒风险。该漏洞允许低权限用户通过操纵 `PATH` 环境变量，利用 SUID 程序 `ndsudo` 提升至 root 权限。务必及时升级 Netdata 版本以修复此漏洞。

**项目地址:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**来源**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata agent运行在受影响版本，且攻击者能够执行本地代码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具拥有 SUID 权限，允许执行某些特权命令。漏洞的根源在于 `ndsudo` 使用不安全的 PATH 环境变量来查找要执行的命令，攻击者可以通过在 PATH 中插入恶意程序，让 `ndsudo` 执行攻击者控制的代码，从而提升权限到 root。

**利用方式：**

1.  **查找 `ndsudo` 路径：** 通常位于 `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`，但需要通过 `find` 命令确认。
2.  **创建恶意程序：** 创建一个 C 程序，该程序调用 `setuid(0)` 和 `setgid(0)` 设置用户和组 ID 为 root，然后执行一个 shell (例如 `/bin/bash -p`)。需要使用 `gcc` 编译该程序，例如命名为 `arcconf`。
3.  **修改 PATH 环境变量：** 将包含恶意程序的目录添加到 PATH 环境变量的开头。例如，如果恶意程序位于 `/tmp` 目录下，则执行 `PATH=/tmp:$PATH`。
4.  **执行 `ndsudo` 命令：** 使用 `ndsudo` 执行它支持的命令，但该命令依赖于攻击者放置的恶意程序。例如，`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`。`ndsudo` 会尝试执行 `arcconf`，但由于 PATH 环境变量被修改，它会执行攻击者在 `/tmp` 目录下创建的恶意程序。
5.  **获得 root shell：** 如果一切顺利，攻击者将获得一个 root shell。

**投毒风险分析：**

提供的 POC 代码中，`arcconf.c` 的目的是创建一个提权的 shell，没有明显的投毒行为。 但从 github 下载预编译二进制文件 `arcconf` 时，存在一定的投毒风险。攻击者可能在预编译的二进制文件中植入恶意代码。考虑到从 github 上下载的二进制文件存在潜在风险，故投毒风险评估为5%。

**项目地址:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**来源**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo 本地权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户提升至 root 权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 和 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的 Netdata，且 ndsudo 工具设置了 SUID root 权限，并且攻击者可以执行 ndsudo。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具以 root 权限运行，但它使用 `PATH` 环境变量来查找要执行的命令。攻击者可以通过在 `PATH` 环境变量中添加一个指向恶意目录的路径，并在该目录中放置一个与 `ndsudo` 尝试执行的命令同名的恶意程序，从而以 root 权限执行任意代码。

**有效性:**

提供的 POC 代码是有效的。它展示了如何利用此漏洞。

**利用方式:**

1.  创建一个包含恶意程序（例如，反弹 shell）的目录。
2.  将恶意程序命名为 `ndsudo` 尝试执行的命令之一（例如，`nvme-list`）。
3.  将包含恶意程序的目录添加到 `PATH` 环境变量的开头。
4.  运行 `ndsudo` 命令。`ndsudo` 将执行恶意程序，从而使攻击者获得 root 权限。

**投毒风险:**

根据提供的代码分析，该仓库似乎主要提供了一个 checker 脚本来帮助安全研究人员和管理员识别和验证漏洞是否存在，旨在帮助防御者评估风险和验证补丁，而不是提供武器化的 PoC。因此，该仓库中存在作者隐藏的投毒代码的风险较低。

检查器代码会检查以下内容：

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (或安装位置) 的 SUID/所有权。
*   `PATH` 中早于常见系统路径的可写目录。
*   `ndsudo` 尝试执行的白名单子命令是否存在。
*   可选地运行 `ndsudo --test <subcommand>` 来打印已解析的命令而不执行它 (谨慎使用，先阅读代码)。

因此，**投毒风险评估为 0%**。


**项目地址:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**来源**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，攻击者可利用此漏洞获取root权限。

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 目标系统上运行受影响版本的netdata，且攻击者需要具有本地低权限账号。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 netdata 的 ndsudo 工具中，该工具以 root 权限运行，但其搜索路径由 PATH 环境变量控制。攻击者可以通过修改 PATH 环境变量，将恶意程序放置在 ndsudo 搜索路径中，当 ndsudo 调用外部命令时，会执行攻击者放置的恶意程序，从而获得 root 权限。

提供的 POC 代码是一个 C 程序，编译后可以直接执行一个具有 root 权限的 bash shell。攻击者需要首先创建一个包含此恶意程序的可写目录，然后修改 PATH 环境变量，将此目录添加到 PATH 的最前面。之后，当 ndsudo 执行任何外部命令时，都会首先执行攻击者放置的恶意程序，从而获得 root shell。

代码中没有发现明显的投毒行为。它只是简单地设置 uid 和 gid 为 0，然后执行 /bin/bash。因此，投毒风险评估为0%。

利用方式总结：
1.  利用需要先获得一个netdata软件的低权限账号。
2.  创建一个包含恶意程序（例如 POC 中的 C 程序编译后的可执行文件）的可写目录。
3.  修改 PATH 环境变量，将该目录添加到 PATH 的最前面。
4.  触发 ndsudo 执行任何外部命令，这将导致恶意程序以 root 权限执行，从而获得 root shell。

**项目地址:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**来源**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 及 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的netdata，且具有本地shell访问权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 存在于Netdata的`ndsudo`工具中，该工具是具有SUID root权限的可执行文件。漏洞原因是`ndsudo`的搜索路径由`PATH`环境变量控制，攻击者可以通过修改`PATH`环境变量，将恶意程序放置在前面，当`ndsudo`执行信任的命令时，会执行攻击者放置的恶意程序，从而实现本地提权。提供的POC代码通过以下步骤利用该漏洞：

1.  **编译恶意payload:**  `poc.c` 编译成 `nvme`，该程序的功能是执行 `/bin/bash`，并设置 UID 和 GID 为 0，即root权限。
2.  **传输payload到目标系统:**  将编译好的`nvme`上传到目标系统的`/tmp`目录。
3.  **准备payload执行:**  给`/tmp/nvme`添加可执行权限，然后将`/tmp`添加到`PATH`环境变量的最前面。
4.  **触发`ndsudo`执行payload:** 运行`./ndsudo nvme-list`，`ndsudo`会执行`/tmp/nvme`，由于该程序会将权限提升为root，因此攻击者可以获得root shell。

**有效性：** 该POC代码描述的利用方式是有效的。

**投毒风险：** 提供的`poc.c`代码功能清晰，仅为执行`/bin/bash`并提升权限，不存在隐藏的投毒代码。README文件描述了完整的利用过程。因此，投毒风险为0%。

**利用方式：** 攻击者通过控制`PATH`环境变量，欺骗`ndsudo`执行恶意程序，从而获得root权限。

**项目地址:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**来源**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.44.0-60, < 1.45.3

**利用条件:** 需要netdata agent存在漏洞版本且ndsudo被调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019是Netdata Agent中ndsudo工具的一个本地权限提升漏洞。ndsudo是一个root用户拥有的、设置了SUID位的可执行文件。它本应只运行一组受限的外部命令，但是其搜索路径由PATH环境变量控制。攻击者可以通过控制PATH环境变量来指定ndsudo查找这些命令的位置，如果这个位置是攻击者具有写权限的目录，那么攻击者就可以放置恶意程序并以root权限执行。

**有效性：** 根据漏洞描述和搜索结果，该漏洞存在利用价值，通过控制PATH环境变量来执行恶意程序达到提权效果。

**投毒风险：** 提供的代码仅为GNU GENERAL PUBLIC LICENSE，是开源协议许可，不包含直接的攻击payload或恶意代码。但license本身也是一种代码，如果结合特定的上下文，协议内容也可能被滥用。例如，攻击者可能创建一个合法的程序，但其行为违反了协议条款，从而造成损害。此仓库中发现直接投毒代码的概率较低，但存在潜在的滥用风险，估计投毒风险为5%。

**利用方式：**
1.  确定目标系统上运行的Netdata Agent版本在受影响范围内（>= 1.44.0-60, < 1.45.3）。
2.  查找ndsudo工具的位置。
3.  创建一个包含恶意命令的目录，例如/tmp/evil。
4.  将恶意程序（如反弹shell）放置到/tmp/evil目录下，并命名为ndsudo尝试执行的命令（例如，`ping`，`date` 等, 具体取决于 ndsudo 允许执行的命令）。
5.  修改PATH环境变量，将/tmp/evil添加到PATH的最前面：`export PATH=/tmp/evil:$PATH`。
6.  运行ndsudo，它将执行/tmp/evil目录下的恶意程序，从而获得root权限。

**项目地址:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**来源**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户通过PATH劫持执行任意代码

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata Agent存在ndsudo，且版本在受影响范围内，以及可控的PATH环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是Netdata中`ndsudo`工具的一个本地提权漏洞。`ndsudo`是一个具有SUID root权限的可执行文件，但它使用`PATH`环境变量来查找要执行的命令。攻击者可以通过将恶意可执行文件放置在`PATH`环境变量中优先于系统目录的位置，诱使`ndsudo`执行该恶意程序，从而获得root权限。

**漏洞利用方式：**
1.  查找具有SUID权限的`ndsudo`可执行文件的路径。
2.  创建一个恶意的可执行文件(例如`nvme`)，该文件执行攻击者希望执行的任意代码。提供的`payload.c`是一个简单的示例，它会生成一个root shell。
3.  修改`PATH`环境变量，将当前目录(或包含恶意可执行文件的目录)添加到`PATH`的开头。
4.  调用`ndsudo`，并指定一个它允许执行的命令(例如`nvme-list`)。由于`PATH`已经被修改，`ndsudo`会执行攻击者放置的恶意`nvme`可执行文件，从而以root权限执行任意代码。

**有效性：**
提供的PoC代码是有效的。它包含一个shell脚本，用于查找`ndsudo`，创建一个`nvme` payload，修改`PATH`，然后执行`ndsudo`。README.md文件描述了如何编译`payload.c`并使用脚本。

**投毒风险：**
查看了提供的三个文件内容，没有发现任何投毒代码。其中，CVE-2024-32019.sh脚本用于利用漏洞，payload.c用于编译恶意payload，README.md文件描述了漏洞和利用方法，都是正常的利用代码。
因此，投毒风险为0%。

**项目地址:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**来源**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统安装了受影响版本的Netdata

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32019是Netdata ndsudo工具中的一个本地权限提升漏洞。ndsudo是一个SUID root的程序，但它使用了PATH环境变量来查找要执行的外部命令，攻击者可以通过修改PATH环境变量指向一个自己可控的目录，并在该目录下放置恶意程序，当ndsudo执行外部命令时，会执行攻击者放置的恶意程序，从而获得root权限。

**漏洞利用方式：**

1.  **漏洞检测：** 首先，检查目标系统上是否存在`/opt`目录下的`ndsudo`程序，并且确认该程序是否为root所有且设置了SUID权限。同时，使用`strings`命令检查`ndsudo`程序中是否存在对`nvme`、`smartctl`、`hdparm`或`sensors`等外部命令的调用，如果存在，则说明该程序可能受到PATH环境变量的影响。
2.  **恶意程序编译：** 编译一个C程序，该程序的功能是设置UID和GID为0，然后执行`/bin/bash`，从而获取root shell。
3.  **恶意程序上传：** 通过SFTP将编译好的恶意程序上传到目标系统上的一个攻击者可控的目录，例如`/tmp`。
4.  **环境变量修改：** 修改PATH环境变量，将攻击者可控的目录添加到PATH环境变量的最前面，确保`ndsudo`程序在执行外部命令时首先在该目录下查找。
5.  **漏洞触发：** 执行`ndsudo`程序，当它调用外部命令时，会执行攻击者上传的恶意程序，从而获取root权限。
6.  **交互式Shell：** 漏洞利用代码提供交互式shell。

**投毒风险分析：**

此POC代码本身主要目的是为了验证漏洞，实现本地提权。但是，该脚本包含以下潜在的投毒风险：

*   **编译和传输恶意代码：** 脚本会自动编译C代码生成二进制文件，并上传到目标机器。虽然C代码的内容是提权，但如果恶意攻击者修改了C代码，就可能包含其他恶意行为，例如植入后门、收集信息等。
*   **远程执行代码：**  脚本通过ssh执行远程命令，存在被篡改的风险，可能执行额外的恶意操作。
*   **残留文件：** 编译后的二进制文件和上传的恶意程序可能在目标系统上留下痕迹，如果这些文件被恶意利用，可能会导致进一步的安全问题。

尽管存在这些风险，但总体来说，该POC代码的风险仍然可控，主要风险集中在代码的篡改和恶意利用上。为了降低风险，建议从可信的来源获取POC代码，并仔细检查代码内容，确保其没有恶意行为。此外，在测试完成后，应及时清理目标系统上的残留文件。

投毒风险预估为10%，因为代码相对简洁，主要功能是漏洞验证和利用，但仍然存在被篡改和恶意利用的可能性。

**项目地址:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**来源**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地shell访问，能够执行ndsudo命令

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-32019 是 Netdata 中 ndsudo 工具的一个本地权限提升漏洞。ndsudo 是一个 SUID root 的可执行文件，但它使用 PATH 环境变量来查找要执行的命令。攻击者可以通过将恶意脚本放置在 PATH 环境变量中优先级更高的目录中，并将其命名为 ndsudo 允许执行的命令（例如 nvme），来欺骗 ndsudo 执行该恶意脚本并获得 root 权限。

**有效性：**

提供的 POC 代码描述了一种利用此漏洞的有效方法。它包括以下步骤：

1.  创建一个恶意脚本（poc.py），该脚本执行提权操作（例如，启动一个 root shell）。
2.  将此脚本重命名为 ndsudo 允许执行的命令之一（例如 nvme）。
3.  将包含恶意脚本的目录添加到 PATH 环境变量的开头。
4.  运行 ndsudo nvme-list，这将导致 ndsudo 执行恶意脚本，从而获得 root 权限。

**投毒风险：**

提供的代码仓库本身投毒风险较低。`poc.py` 代码非常简单，仅包含提权执行bash的代码，不太可能存在隐藏的恶意代码。`README.md` 文件提供了清晰的漏洞利用说明。但用户仍然需要注意，在实际环境中，从不可信的来源下载或复制漏洞利用代码都存在一定的风险，需要仔细检查代码是否存在恶意行为，再执行。

**利用方式：**

1.  **漏洞原理：** `ndsudo` 以 root 权限运行，但其搜索命令的路径依赖于用户的 `PATH` 环境变量。
2.  **攻击步骤：**
    *   创建恶意脚本，该脚本执行提权操作（例如，启动一个 root shell）。
    *   将此脚本重命名为 `ndsudo` 允许执行的命令之一（通过 `ndsudo --help` 查看）。
    *   将包含恶意脚本的目录添加到 `PATH` 环境变量的开头，确保恶意脚本优先被搜索到。
    *   运行 `ndsudo <allowed_command>`，这将导致 `ndsudo` 执行恶意脚本，从而获得 root 权限。

**总结：**

该漏洞利用较为简单，POC 代码的有效性较高，但应注意来源不明的exploit代码的潜在投毒风险。该漏洞允许低权限用户通过操纵 `PATH` 环境变量，利用 SUID 程序 `ndsudo` 提升至 root 权限。务必及时升级 Netdata 版本以修复此漏洞。

**项目地址:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**来源**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata agent运行在受影响版本，且攻击者能够执行本地代码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具拥有 SUID 权限，允许执行某些特权命令。漏洞的根源在于 `ndsudo` 使用不安全的 PATH 环境变量来查找要执行的命令，攻击者可以通过在 PATH 中插入恶意程序，让 `ndsudo` 执行攻击者控制的代码，从而提升权限到 root。

**利用方式：**

1.  **查找 `ndsudo` 路径：** 通常位于 `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`，但需要通过 `find` 命令确认。
2.  **创建恶意程序：** 创建一个 C 程序，该程序调用 `setuid(0)` 和 `setgid(0)` 设置用户和组 ID 为 root，然后执行一个 shell (例如 `/bin/bash -p`)。需要使用 `gcc` 编译该程序，例如命名为 `arcconf`。
3.  **修改 PATH 环境变量：** 将包含恶意程序的目录添加到 PATH 环境变量的开头。例如，如果恶意程序位于 `/tmp` 目录下，则执行 `PATH=/tmp:$PATH`。
4.  **执行 `ndsudo` 命令：** 使用 `ndsudo` 执行它支持的命令，但该命令依赖于攻击者放置的恶意程序。例如，`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`。`ndsudo` 会尝试执行 `arcconf`，但由于 PATH 环境变量被修改，它会执行攻击者在 `/tmp` 目录下创建的恶意程序。
5.  **获得 root shell：** 如果一切顺利，攻击者将获得一个 root shell。

**投毒风险分析：**

提供的 POC 代码中，`arcconf.c` 的目的是创建一个提权的 shell，没有明显的投毒行为。 但从 github 下载预编译二进制文件 `arcconf` 时，存在一定的投毒风险。攻击者可能在预编译的二进制文件中植入恶意代码。考虑到从 github 上下载的二进制文件存在潜在风险，故投毒风险评估为5%。

**项目地址:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**来源**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo 本地权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户提升至 root 权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 和 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的 Netdata，且 ndsudo 工具设置了 SUID root 权限，并且攻击者可以执行 ndsudo。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具以 root 权限运行，但它使用 `PATH` 环境变量来查找要执行的命令。攻击者可以通过在 `PATH` 环境变量中添加一个指向恶意目录的路径，并在该目录中放置一个与 `ndsudo` 尝试执行的命令同名的恶意程序，从而以 root 权限执行任意代码。

**有效性:**

提供的 POC 代码是有效的。它展示了如何利用此漏洞。

**利用方式:**

1.  创建一个包含恶意程序（例如，反弹 shell）的目录。
2.  将恶意程序命名为 `ndsudo` 尝试执行的命令之一（例如，`nvme-list`）。
3.  将包含恶意程序的目录添加到 `PATH` 环境变量的开头。
4.  运行 `ndsudo` 命令。`ndsudo` 将执行恶意程序，从而使攻击者获得 root 权限。

**投毒风险:**

根据提供的代码分析，该仓库似乎主要提供了一个 checker 脚本来帮助安全研究人员和管理员识别和验证漏洞是否存在，旨在帮助防御者评估风险和验证补丁，而不是提供武器化的 PoC。因此，该仓库中存在作者隐藏的投毒代码的风险较低。

检查器代码会检查以下内容：

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (或安装位置) 的 SUID/所有权。
*   `PATH` 中早于常见系统路径的可写目录。
*   `ndsudo` 尝试执行的白名单子命令是否存在。
*   可选地运行 `ndsudo --test <subcommand>` 来打印已解析的命令而不执行它 (谨慎使用，先阅读代码)。

因此，**投毒风险评估为 0%**。


**项目地址:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**来源**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，攻击者可利用此漏洞获取root权限。

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 目标系统上运行受影响版本的netdata，且攻击者需要具有本地低权限账号。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 netdata 的 ndsudo 工具中，该工具以 root 权限运行，但其搜索路径由 PATH 环境变量控制。攻击者可以通过修改 PATH 环境变量，将恶意程序放置在 ndsudo 搜索路径中，当 ndsudo 调用外部命令时，会执行攻击者放置的恶意程序，从而获得 root 权限。

提供的 POC 代码是一个 C 程序，编译后可以直接执行一个具有 root 权限的 bash shell。攻击者需要首先创建一个包含此恶意程序的可写目录，然后修改 PATH 环境变量，将此目录添加到 PATH 的最前面。之后，当 ndsudo 执行任何外部命令时，都会首先执行攻击者放置的恶意程序，从而获得 root shell。

代码中没有发现明显的投毒行为。它只是简单地设置 uid 和 gid 为 0，然后执行 /bin/bash。因此，投毒风险评估为0%。

利用方式总结：
1.  利用需要先获得一个netdata软件的低权限账号。
2.  创建一个包含恶意程序（例如 POC 中的 C 程序编译后的可执行文件）的可写目录。
3.  修改 PATH 环境变量，将该目录添加到 PATH 的最前面。
4.  触发 ndsudo 执行任何外部命令，这将导致恶意程序以 root 权限执行，从而获得 root shell。

**项目地址:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**来源**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 及 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的netdata，且具有本地shell访问权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 存在于Netdata的`ndsudo`工具中，该工具是具有SUID root权限的可执行文件。漏洞原因是`ndsudo`的搜索路径由`PATH`环境变量控制，攻击者可以通过修改`PATH`环境变量，将恶意程序放置在前面，当`ndsudo`执行信任的命令时，会执行攻击者放置的恶意程序，从而实现本地提权。提供的POC代码通过以下步骤利用该漏洞：

1.  **编译恶意payload:**  `poc.c` 编译成 `nvme`，该程序的功能是执行 `/bin/bash`，并设置 UID 和 GID 为 0，即root权限。
2.  **传输payload到目标系统:**  将编译好的`nvme`上传到目标系统的`/tmp`目录。
3.  **准备payload执行:**  给`/tmp/nvme`添加可执行权限，然后将`/tmp`添加到`PATH`环境变量的最前面。
4.  **触发`ndsudo`执行payload:** 运行`./ndsudo nvme-list`，`ndsudo`会执行`/tmp/nvme`，由于该程序会将权限提升为root，因此攻击者可以获得root shell。

**有效性：** 该POC代码描述的利用方式是有效的。

**投毒风险：** 提供的`poc.c`代码功能清晰，仅为执行`/bin/bash`并提升权限，不存在隐藏的投毒代码。README文件描述了完整的利用过程。因此，投毒风险为0%。

**利用方式：** 攻击者通过控制`PATH`环境变量，欺骗`ndsudo`执行恶意程序，从而获得root权限。

**项目地址:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**来源**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.44.0-60, < 1.45.3

**利用条件:** 需要netdata agent存在漏洞版本且ndsudo被调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019是Netdata Agent中ndsudo工具的一个本地权限提升漏洞。ndsudo是一个root用户拥有的、设置了SUID位的可执行文件。它本应只运行一组受限的外部命令，但是其搜索路径由PATH环境变量控制。攻击者可以通过控制PATH环境变量来指定ndsudo查找这些命令的位置，如果这个位置是攻击者具有写权限的目录，那么攻击者就可以放置恶意程序并以root权限执行。

**有效性：** 根据漏洞描述和搜索结果，该漏洞存在利用价值，通过控制PATH环境变量来执行恶意程序达到提权效果。

**投毒风险：** 提供的代码仅为GNU GENERAL PUBLIC LICENSE，是开源协议许可，不包含直接的攻击payload或恶意代码。但license本身也是一种代码，如果结合特定的上下文，协议内容也可能被滥用。例如，攻击者可能创建一个合法的程序，但其行为违反了协议条款，从而造成损害。此仓库中发现直接投毒代码的概率较低，但存在潜在的滥用风险，估计投毒风险为5%。

**利用方式：**
1.  确定目标系统上运行的Netdata Agent版本在受影响范围内（>= 1.44.0-60, < 1.45.3）。
2.  查找ndsudo工具的位置。
3.  创建一个包含恶意命令的目录，例如/tmp/evil。
4.  将恶意程序（如反弹shell）放置到/tmp/evil目录下，并命名为ndsudo尝试执行的命令（例如，`ping`，`date` 等, 具体取决于 ndsudo 允许执行的命令）。
5.  修改PATH环境变量，将/tmp/evil添加到PATH的最前面：`export PATH=/tmp/evil:$PATH`。
6.  运行ndsudo，它将执行/tmp/evil目录下的恶意程序，从而获得root权限。

**项目地址:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**来源**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户通过PATH劫持执行任意代码

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata Agent存在ndsudo，且版本在受影响范围内，以及可控的PATH环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是Netdata中`ndsudo`工具的一个本地提权漏洞。`ndsudo`是一个具有SUID root权限的可执行文件，但它使用`PATH`环境变量来查找要执行的命令。攻击者可以通过将恶意可执行文件放置在`PATH`环境变量中优先于系统目录的位置，诱使`ndsudo`执行该恶意程序，从而获得root权限。

**漏洞利用方式：**
1.  查找具有SUID权限的`ndsudo`可执行文件的路径。
2.  创建一个恶意的可执行文件(例如`nvme`)，该文件执行攻击者希望执行的任意代码。提供的`payload.c`是一个简单的示例，它会生成一个root shell。
3.  修改`PATH`环境变量，将当前目录(或包含恶意可执行文件的目录)添加到`PATH`的开头。
4.  调用`ndsudo`，并指定一个它允许执行的命令(例如`nvme-list`)。由于`PATH`已经被修改，`ndsudo`会执行攻击者放置的恶意`nvme`可执行文件，从而以root权限执行任意代码。

**有效性：**
提供的PoC代码是有效的。它包含一个shell脚本，用于查找`ndsudo`，创建一个`nvme` payload，修改`PATH`，然后执行`ndsudo`。README.md文件描述了如何编译`payload.c`并使用脚本。

**投毒风险：**
查看了提供的三个文件内容，没有发现任何投毒代码。其中，CVE-2024-32019.sh脚本用于利用漏洞，payload.c用于编译恶意payload，README.md文件描述了漏洞和利用方法，都是正常的利用代码。
因此，投毒风险为0%。

**项目地址:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**来源**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统安装了受影响版本的Netdata

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32019是Netdata ndsudo工具中的一个本地权限提升漏洞。ndsudo是一个SUID root的程序，但它使用了PATH环境变量来查找要执行的外部命令，攻击者可以通过修改PATH环境变量指向一个自己可控的目录，并在该目录下放置恶意程序，当ndsudo执行外部命令时，会执行攻击者放置的恶意程序，从而获得root权限。

**漏洞利用方式：**

1.  **漏洞检测：** 首先，检查目标系统上是否存在`/opt`目录下的`ndsudo`程序，并且确认该程序是否为root所有且设置了SUID权限。同时，使用`strings`命令检查`ndsudo`程序中是否存在对`nvme`、`smartctl`、`hdparm`或`sensors`等外部命令的调用，如果存在，则说明该程序可能受到PATH环境变量的影响。
2.  **恶意程序编译：** 编译一个C程序，该程序的功能是设置UID和GID为0，然后执行`/bin/bash`，从而获取root shell。
3.  **恶意程序上传：** 通过SFTP将编译好的恶意程序上传到目标系统上的一个攻击者可控的目录，例如`/tmp`。
4.  **环境变量修改：** 修改PATH环境变量，将攻击者可控的目录添加到PATH环境变量的最前面，确保`ndsudo`程序在执行外部命令时首先在该目录下查找。
5.  **漏洞触发：** 执行`ndsudo`程序，当它调用外部命令时，会执行攻击者上传的恶意程序，从而获取root权限。
6.  **交互式Shell：** 漏洞利用代码提供交互式shell。

**投毒风险分析：**

此POC代码本身主要目的是为了验证漏洞，实现本地提权。但是，该脚本包含以下潜在的投毒风险：

*   **编译和传输恶意代码：** 脚本会自动编译C代码生成二进制文件，并上传到目标机器。虽然C代码的内容是提权，但如果恶意攻击者修改了C代码，就可能包含其他恶意行为，例如植入后门、收集信息等。
*   **远程执行代码：**  脚本通过ssh执行远程命令，存在被篡改的风险，可能执行额外的恶意操作。
*   **残留文件：** 编译后的二进制文件和上传的恶意程序可能在目标系统上留下痕迹，如果这些文件被恶意利用，可能会导致进一步的安全问题。

尽管存在这些风险，但总体来说，该POC代码的风险仍然可控，主要风险集中在代码的篡改和恶意利用上。为了降低风险，建议从可信的来源获取POC代码，并仔细检查代码内容，确保其没有恶意行为。此外，在测试完成后，应及时清理目标系统上的残留文件。

投毒风险预估为10%，因为代码相对简洁，主要功能是漏洞验证和利用，但仍然存在被篡改和恶意利用的可能性。

**项目地址:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**来源**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地shell访问，能够执行ndsudo命令

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-32019 是 Netdata 中 ndsudo 工具的一个本地权限提升漏洞。ndsudo 是一个 SUID root 的可执行文件，但它使用 PATH 环境变量来查找要执行的命令。攻击者可以通过将恶意脚本放置在 PATH 环境变量中优先级更高的目录中，并将其命名为 ndsudo 允许执行的命令（例如 nvme），来欺骗 ndsudo 执行该恶意脚本并获得 root 权限。

**有效性：**

提供的 POC 代码描述了一种利用此漏洞的有效方法。它包括以下步骤：

1.  创建一个恶意脚本（poc.py），该脚本执行提权操作（例如，启动一个 root shell）。
2.  将此脚本重命名为 ndsudo 允许执行的命令之一（例如 nvme）。
3.  将包含恶意脚本的目录添加到 PATH 环境变量的开头。
4.  运行 ndsudo nvme-list，这将导致 ndsudo 执行恶意脚本，从而获得 root 权限。

**投毒风险：**

提供的代码仓库本身投毒风险较低。`poc.py` 代码非常简单，仅包含提权执行bash的代码，不太可能存在隐藏的恶意代码。`README.md` 文件提供了清晰的漏洞利用说明。但用户仍然需要注意，在实际环境中，从不可信的来源下载或复制漏洞利用代码都存在一定的风险，需要仔细检查代码是否存在恶意行为，再执行。

**利用方式：**

1.  **漏洞原理：** `ndsudo` 以 root 权限运行，但其搜索命令的路径依赖于用户的 `PATH` 环境变量。
2.  **攻击步骤：**
    *   创建恶意脚本，该脚本执行提权操作（例如，启动一个 root shell）。
    *   将此脚本重命名为 `ndsudo` 允许执行的命令之一（通过 `ndsudo --help` 查看）。
    *   将包含恶意脚本的目录添加到 `PATH` 环境变量的开头，确保恶意脚本优先被搜索到。
    *   运行 `ndsudo <allowed_command>`，这将导致 `ndsudo` 执行恶意脚本，从而获得 root 权限。

**总结：**

该漏洞利用较为简单，POC 代码的有效性较高，但应注意来源不明的exploit代码的潜在投毒风险。该漏洞允许低权限用户通过操纵 `PATH` 环境变量，利用 SUID 程序 `ndsudo` 提升至 root 权限。务必及时升级 Netdata 版本以修复此漏洞。

**项目地址:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**来源**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata agent运行在受影响版本，且攻击者能够执行本地代码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具拥有 SUID 权限，允许执行某些特权命令。漏洞的根源在于 `ndsudo` 使用不安全的 PATH 环境变量来查找要执行的命令，攻击者可以通过在 PATH 中插入恶意程序，让 `ndsudo` 执行攻击者控制的代码，从而提升权限到 root。

**利用方式：**

1.  **查找 `ndsudo` 路径：** 通常位于 `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`，但需要通过 `find` 命令确认。
2.  **创建恶意程序：** 创建一个 C 程序，该程序调用 `setuid(0)` 和 `setgid(0)` 设置用户和组 ID 为 root，然后执行一个 shell (例如 `/bin/bash -p`)。需要使用 `gcc` 编译该程序，例如命名为 `arcconf`。
3.  **修改 PATH 环境变量：** 将包含恶意程序的目录添加到 PATH 环境变量的开头。例如，如果恶意程序位于 `/tmp` 目录下，则执行 `PATH=/tmp:$PATH`。
4.  **执行 `ndsudo` 命令：** 使用 `ndsudo` 执行它支持的命令，但该命令依赖于攻击者放置的恶意程序。例如，`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`。`ndsudo` 会尝试执行 `arcconf`，但由于 PATH 环境变量被修改，它会执行攻击者在 `/tmp` 目录下创建的恶意程序。
5.  **获得 root shell：** 如果一切顺利，攻击者将获得一个 root shell。

**投毒风险分析：**

提供的 POC 代码中，`arcconf.c` 的目的是创建一个提权的 shell，没有明显的投毒行为。 但从 github 下载预编译二进制文件 `arcconf` 时，存在一定的投毒风险。攻击者可能在预编译的二进制文件中植入恶意代码。考虑到从 github 上下载的二进制文件存在潜在风险，故投毒风险评估为5%。

**项目地址:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**来源**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo 本地权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户提升至 root 权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 和 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的 Netdata，且 ndsudo 工具设置了 SUID root 权限，并且攻击者可以执行 ndsudo。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具以 root 权限运行，但它使用 `PATH` 环境变量来查找要执行的命令。攻击者可以通过在 `PATH` 环境变量中添加一个指向恶意目录的路径，并在该目录中放置一个与 `ndsudo` 尝试执行的命令同名的恶意程序，从而以 root 权限执行任意代码。

**有效性:**

提供的 POC 代码是有效的。它展示了如何利用此漏洞。

**利用方式:**

1.  创建一个包含恶意程序（例如，反弹 shell）的目录。
2.  将恶意程序命名为 `ndsudo` 尝试执行的命令之一（例如，`nvme-list`）。
3.  将包含恶意程序的目录添加到 `PATH` 环境变量的开头。
4.  运行 `ndsudo` 命令。`ndsudo` 将执行恶意程序，从而使攻击者获得 root 权限。

**投毒风险:**

根据提供的代码分析，该仓库似乎主要提供了一个 checker 脚本来帮助安全研究人员和管理员识别和验证漏洞是否存在，旨在帮助防御者评估风险和验证补丁，而不是提供武器化的 PoC。因此，该仓库中存在作者隐藏的投毒代码的风险较低。

检查器代码会检查以下内容：

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (或安装位置) 的 SUID/所有权。
*   `PATH` 中早于常见系统路径的可写目录。
*   `ndsudo` 尝试执行的白名单子命令是否存在。
*   可选地运行 `ndsudo --test <subcommand>` 来打印已解析的命令而不执行它 (谨慎使用，先阅读代码)。

因此，**投毒风险评估为 0%**。


**项目地址:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**来源**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，攻击者可利用此漏洞获取root权限。

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 目标系统上运行受影响版本的netdata，且攻击者需要具有本地低权限账号。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 netdata 的 ndsudo 工具中，该工具以 root 权限运行，但其搜索路径由 PATH 环境变量控制。攻击者可以通过修改 PATH 环境变量，将恶意程序放置在 ndsudo 搜索路径中，当 ndsudo 调用外部命令时，会执行攻击者放置的恶意程序，从而获得 root 权限。

提供的 POC 代码是一个 C 程序，编译后可以直接执行一个具有 root 权限的 bash shell。攻击者需要首先创建一个包含此恶意程序的可写目录，然后修改 PATH 环境变量，将此目录添加到 PATH 的最前面。之后，当 ndsudo 执行任何外部命令时，都会首先执行攻击者放置的恶意程序，从而获得 root shell。

代码中没有发现明显的投毒行为。它只是简单地设置 uid 和 gid 为 0，然后执行 /bin/bash。因此，投毒风险评估为0%。

利用方式总结：
1.  利用需要先获得一个netdata软件的低权限账号。
2.  创建一个包含恶意程序（例如 POC 中的 C 程序编译后的可执行文件）的可写目录。
3.  修改 PATH 环境变量，将该目录添加到 PATH 的最前面。
4.  触发 ndsudo 执行任何外部命令，这将导致恶意程序以 root 权限执行，从而获得 root shell。

**项目地址:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---



---

## POC #3

**来源**: [CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-AzureADTrent_CVE-2024-32019-POC.md)

## CVE-2024-32019-netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 及 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的netdata，且具有本地shell访问权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 存在于Netdata的`ndsudo`工具中，该工具是具有SUID root权限的可执行文件。漏洞原因是`ndsudo`的搜索路径由`PATH`环境变量控制，攻击者可以通过修改`PATH`环境变量，将恶意程序放置在前面，当`ndsudo`执行信任的命令时，会执行攻击者放置的恶意程序，从而实现本地提权。提供的POC代码通过以下步骤利用该漏洞：

1.  **编译恶意payload:**  `poc.c` 编译成 `nvme`，该程序的功能是执行 `/bin/bash`，并设置 UID 和 GID 为 0，即root权限。
2.  **传输payload到目标系统:**  将编译好的`nvme`上传到目标系统的`/tmp`目录。
3.  **准备payload执行:**  给`/tmp/nvme`添加可执行权限，然后将`/tmp`添加到`PATH`环境变量的最前面。
4.  **触发`ndsudo`执行payload:** 运行`./ndsudo nvme-list`，`ndsudo`会执行`/tmp/nvme`，由于该程序会将权限提升为root，因此攻击者可以获得root shell。

**有效性：** 该POC代码描述的利用方式是有效的。

**投毒风险：** 提供的`poc.c`代码功能清晰，仅为执行`/bin/bash`并提升权限，不存在隐藏的投毒代码。README文件描述了完整的利用过程。因此，投毒风险为0%。

**利用方式：** 攻击者通过控制`PATH`环境变量，欺骗`ndsudo`执行恶意程序，从而获得root权限。

**项目地址:** [AzureADTrent/CVE-2024-32019-POC](https://github.com/AzureADTrent/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #4

**来源**: [CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md](../2024/CVE-2024-32019-C0deInBlack_CVE-2024-32019-poc.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.44.0-60, < 1.45.3

**利用条件:** 需要netdata agent存在漏洞版本且ndsudo被调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019是Netdata Agent中ndsudo工具的一个本地权限提升漏洞。ndsudo是一个root用户拥有的、设置了SUID位的可执行文件。它本应只运行一组受限的外部命令，但是其搜索路径由PATH环境变量控制。攻击者可以通过控制PATH环境变量来指定ndsudo查找这些命令的位置，如果这个位置是攻击者具有写权限的目录，那么攻击者就可以放置恶意程序并以root权限执行。

**有效性：** 根据漏洞描述和搜索结果，该漏洞存在利用价值，通过控制PATH环境变量来执行恶意程序达到提权效果。

**投毒风险：** 提供的代码仅为GNU GENERAL PUBLIC LICENSE，是开源协议许可，不包含直接的攻击payload或恶意代码。但license本身也是一种代码，如果结合特定的上下文，协议内容也可能被滥用。例如，攻击者可能创建一个合法的程序，但其行为违反了协议条款，从而造成损害。此仓库中发现直接投毒代码的概率较低，但存在潜在的滥用风险，估计投毒风险为5%。

**利用方式：**
1.  确定目标系统上运行的Netdata Agent版本在受影响范围内（>= 1.44.0-60, < 1.45.3）。
2.  查找ndsudo工具的位置。
3.  创建一个包含恶意命令的目录，例如/tmp/evil。
4.  将恶意程序（如反弹shell）放置到/tmp/evil目录下，并命名为ndsudo尝试执行的命令（例如，`ping`，`date` 等, 具体取决于 ndsudo 允许执行的命令）。
5.  修改PATH环境变量，将/tmp/evil添加到PATH的最前面：`export PATH=/tmp/evil:$PATH`。
6.  运行ndsudo，它将执行/tmp/evil目录下的恶意程序，从而获得root权限。

**项目地址:** [C0deInBlack/CVE-2024-32019-poc](https://github.com/C0deInBlack/CVE-2024-32019-poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #5

**来源**: [CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md](../2024/CVE-2024-32019-T1erno_CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户通过PATH劫持执行任意代码

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata Agent存在ndsudo，且版本在受影响范围内，以及可控的PATH环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是Netdata中`ndsudo`工具的一个本地提权漏洞。`ndsudo`是一个具有SUID root权限的可执行文件，但它使用`PATH`环境变量来查找要执行的命令。攻击者可以通过将恶意可执行文件放置在`PATH`环境变量中优先于系统目录的位置，诱使`ndsudo`执行该恶意程序，从而获得root权限。

**漏洞利用方式：**
1.  查找具有SUID权限的`ndsudo`可执行文件的路径。
2.  创建一个恶意的可执行文件(例如`nvme`)，该文件执行攻击者希望执行的任意代码。提供的`payload.c`是一个简单的示例，它会生成一个root shell。
3.  修改`PATH`环境变量，将当前目录(或包含恶意可执行文件的目录)添加到`PATH`的开头。
4.  调用`ndsudo`，并指定一个它允许执行的命令(例如`nvme-list`)。由于`PATH`已经被修改，`ndsudo`会执行攻击者放置的恶意`nvme`可执行文件，从而以root权限执行任意代码。

**有效性：**
提供的PoC代码是有效的。它包含一个shell脚本，用于查找`ndsudo`，创建一个`nvme` payload，修改`PATH`，然后执行`ndsudo`。README.md文件描述了如何编译`payload.c`并使用脚本。

**投毒风险：**
查看了提供的三个文件内容，没有发现任何投毒代码。其中，CVE-2024-32019.sh脚本用于利用漏洞，payload.c用于编译恶意payload，README.md文件描述了漏洞和利用方法，都是正常的利用代码。
因此，投毒风险为0%。

**项目地址:** [T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC](https://github.com/T1erno/CVE-2024-32019-Netdata-ndsudo-Privilege-Escalation-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #6

**来源**: [CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md](../2024/CVE-2024-32019-dollarboysushil_CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，本地权限提升至root

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统安装了受影响版本的Netdata

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32019是Netdata ndsudo工具中的一个本地权限提升漏洞。ndsudo是一个SUID root的程序，但它使用了PATH环境变量来查找要执行的外部命令，攻击者可以通过修改PATH环境变量指向一个自己可控的目录，并在该目录下放置恶意程序，当ndsudo执行外部命令时，会执行攻击者放置的恶意程序，从而获得root权限。

**漏洞利用方式：**

1.  **漏洞检测：** 首先，检查目标系统上是否存在`/opt`目录下的`ndsudo`程序，并且确认该程序是否为root所有且设置了SUID权限。同时，使用`strings`命令检查`ndsudo`程序中是否存在对`nvme`、`smartctl`、`hdparm`或`sensors`等外部命令的调用，如果存在，则说明该程序可能受到PATH环境变量的影响。
2.  **恶意程序编译：** 编译一个C程序，该程序的功能是设置UID和GID为0，然后执行`/bin/bash`，从而获取root shell。
3.  **恶意程序上传：** 通过SFTP将编译好的恶意程序上传到目标系统上的一个攻击者可控的目录，例如`/tmp`。
4.  **环境变量修改：** 修改PATH环境变量，将攻击者可控的目录添加到PATH环境变量的最前面，确保`ndsudo`程序在执行外部命令时首先在该目录下查找。
5.  **漏洞触发：** 执行`ndsudo`程序，当它调用外部命令时，会执行攻击者上传的恶意程序，从而获取root权限。
6.  **交互式Shell：** 漏洞利用代码提供交互式shell。

**投毒风险分析：**

此POC代码本身主要目的是为了验证漏洞，实现本地提权。但是，该脚本包含以下潜在的投毒风险：

*   **编译和传输恶意代码：** 脚本会自动编译C代码生成二进制文件，并上传到目标机器。虽然C代码的内容是提权，但如果恶意攻击者修改了C代码，就可能包含其他恶意行为，例如植入后门、收集信息等。
*   **远程执行代码：**  脚本通过ssh执行远程命令，存在被篡改的风险，可能执行额外的恶意操作。
*   **残留文件：** 编译后的二进制文件和上传的恶意程序可能在目标系统上留下痕迹，如果这些文件被恶意利用，可能会导致进一步的安全问题。

尽管存在这些风险，但总体来说，该POC代码的风险仍然可控，主要风险集中在代码的篡改和恶意利用上。为了降低风险，建议从可信的来源获取POC代码，并仔细检查代码内容，确保其没有恶意行为。此外，在测试完成后，应及时清理目标系统上的残留文件。

投毒风险预估为10%，因为代码相对简洁，主要功能是漏洞验证和利用，但仍然存在被篡改和恶意利用的可能性。

**项目地址:** [dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation](https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #7

**来源**: [CVE-2024-32019-hexared_CVE-2024-32019_poc.md](../2024/CVE-2024-32019-hexared_CVE-2024-32019_poc.md)

## CVE-2024-32019-Netdata-ndsudo本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地shell访问，能够执行ndsudo命令

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-32019 是 Netdata 中 ndsudo 工具的一个本地权限提升漏洞。ndsudo 是一个 SUID root 的可执行文件，但它使用 PATH 环境变量来查找要执行的命令。攻击者可以通过将恶意脚本放置在 PATH 环境变量中优先级更高的目录中，并将其命名为 ndsudo 允许执行的命令（例如 nvme），来欺骗 ndsudo 执行该恶意脚本并获得 root 权限。

**有效性：**

提供的 POC 代码描述了一种利用此漏洞的有效方法。它包括以下步骤：

1.  创建一个恶意脚本（poc.py），该脚本执行提权操作（例如，启动一个 root shell）。
2.  将此脚本重命名为 ndsudo 允许执行的命令之一（例如 nvme）。
3.  将包含恶意脚本的目录添加到 PATH 环境变量的开头。
4.  运行 ndsudo nvme-list，这将导致 ndsudo 执行恶意脚本，从而获得 root 权限。

**投毒风险：**

提供的代码仓库本身投毒风险较低。`poc.py` 代码非常简单，仅包含提权执行bash的代码，不太可能存在隐藏的恶意代码。`README.md` 文件提供了清晰的漏洞利用说明。但用户仍然需要注意，在实际环境中，从不可信的来源下载或复制漏洞利用代码都存在一定的风险，需要仔细检查代码是否存在恶意行为，再执行。

**利用方式：**

1.  **漏洞原理：** `ndsudo` 以 root 权限运行，但其搜索命令的路径依赖于用户的 `PATH` 环境变量。
2.  **攻击步骤：**
    *   创建恶意脚本，该脚本执行提权操作（例如，启动一个 root shell）。
    *   将此脚本重命名为 `ndsudo` 允许执行的命令之一（通过 `ndsudo --help` 查看）。
    *   将包含恶意脚本的目录添加到 `PATH` 环境变量的开头，确保恶意脚本优先被搜索到。
    *   运行 `ndsudo <allowed_command>`，这将导致 `ndsudo` 执行恶意脚本，从而获得 root 权限。

**总结：**

该漏洞利用较为简单，POC 代码的有效性较高，但应注意来源不明的exploit代码的潜在投毒风险。该漏洞允许低权限用户通过操纵 `PATH` 环境变量，利用 SUID 程序 `ndsudo` 提升至 root 权限。务必及时升级 Netdata 版本以修复此漏洞。

**项目地址:** [hexared/CVE-2024-32019_poc](https://github.com/hexared/CVE-2024-32019_poc)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #8

**来源**: [CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md](../2024/CVE-2024-32019-juanbelin_CVE-2024-32019-POC.md)

## CVE-2024-32019-Netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** Netdata

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** >= 1.45.0, < 1.45.3, >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要Netdata agent运行在受影响版本，且攻击者能够执行本地代码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具拥有 SUID 权限，允许执行某些特权命令。漏洞的根源在于 `ndsudo` 使用不安全的 PATH 环境变量来查找要执行的命令，攻击者可以通过在 PATH 中插入恶意程序，让 `ndsudo` 执行攻击者控制的代码，从而提升权限到 root。

**利用方式：**

1.  **查找 `ndsudo` 路径：** 通常位于 `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo`，但需要通过 `find` 命令确认。
2.  **创建恶意程序：** 创建一个 C 程序，该程序调用 `setuid(0)` 和 `setgid(0)` 设置用户和组 ID 为 root，然后执行一个 shell (例如 `/bin/bash -p`)。需要使用 `gcc` 编译该程序，例如命名为 `arcconf`。
3.  **修改 PATH 环境变量：** 将包含恶意程序的目录添加到 PATH 环境变量的开头。例如，如果恶意程序位于 `/tmp` 目录下，则执行 `PATH=/tmp:$PATH`。
4.  **执行 `ndsudo` 命令：** 使用 `ndsudo` 执行它支持的命令，但该命令依赖于攻击者放置的恶意程序。例如，`/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-pd-info`。`ndsudo` 会尝试执行 `arcconf`，但由于 PATH 环境变量被修改，它会执行攻击者在 `/tmp` 目录下创建的恶意程序。
5.  **获得 root shell：** 如果一切顺利，攻击者将获得一个 root shell。

**投毒风险分析：**

提供的 POC 代码中，`arcconf.c` 的目的是创建一个提权的 shell，没有明显的投毒行为。 但从 github 下载预编译二进制文件 `arcconf` 时，存在一定的投毒风险。攻击者可能在预编译的二进制文件中植入恶意代码。考虑到从 github 上下载的二进制文件存在潜在风险，故投毒风险评估为5%。

**项目地址:** [juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #9

**来源**: [CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md](../2024/CVE-2024-32019-sPhyos_cve-2024-32019-PoC.md)

## CVE-2024-32019 - Netdata ndsudo 本地权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户提升至 root 权限

**影响版本:** >= 1.44.0-60, < 1.45.0-169 和 >= 1.45.0, < 1.45.3

**利用条件:** 目标系统安装了受影响版本的 Netdata，且 ndsudo 工具设置了 SUID root 权限，并且攻击者可以执行 ndsudo。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 Netdata 的 `ndsudo` 工具中。该工具以 root 权限运行，但它使用 `PATH` 环境变量来查找要执行的命令。攻击者可以通过在 `PATH` 环境变量中添加一个指向恶意目录的路径，并在该目录中放置一个与 `ndsudo` 尝试执行的命令同名的恶意程序，从而以 root 权限执行任意代码。

**有效性:**

提供的 POC 代码是有效的。它展示了如何利用此漏洞。

**利用方式:**

1.  创建一个包含恶意程序（例如，反弹 shell）的目录。
2.  将恶意程序命名为 `ndsudo` 尝试执行的命令之一（例如，`nvme-list`）。
3.  将包含恶意程序的目录添加到 `PATH` 环境变量的开头。
4.  运行 `ndsudo` 命令。`ndsudo` 将执行恶意程序，从而使攻击者获得 root 权限。

**投毒风险:**

根据提供的代码分析，该仓库似乎主要提供了一个 checker 脚本来帮助安全研究人员和管理员识别和验证漏洞是否存在，旨在帮助防御者评估风险和验证补丁，而不是提供武器化的 PoC。因此，该仓库中存在作者隐藏的投毒代码的风险较低。

检查器代码会检查以下内容：

*   `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo` (或安装位置) 的 SUID/所有权。
*   `PATH` 中早于常见系统路径的可写目录。
*   `ndsudo` 尝试执行的白名单子命令是否存在。
*   可选地运行 `ndsudo --test <subcommand>` 来打印已解析的命令而不执行它 (谨慎使用，先阅读代码)。

因此，**投毒风险评估为 0%**。


**项目地址:** [sPhyos/cve-2024-32019-PoC](https://github.com/sPhyos/cve-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

## POC #10

**来源**: [CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md](../2024/CVE-2024-32019-x0da6h_POC-for-CVE-2024-32019.md)

## CVE-2024-32019-netdata-本地提权

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地提权

**影响应用:** netdata

**危害等级:** 高危，攻击者可利用此漏洞获取root权限。

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 目标系统上运行受影响版本的netdata，且攻击者需要具有本地低权限账号。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019 漏洞存在于 netdata 的 ndsudo 工具中，该工具以 root 权限运行，但其搜索路径由 PATH 环境变量控制。攻击者可以通过修改 PATH 环境变量，将恶意程序放置在 ndsudo 搜索路径中，当 ndsudo 调用外部命令时，会执行攻击者放置的恶意程序，从而获得 root 权限。

提供的 POC 代码是一个 C 程序，编译后可以直接执行一个具有 root 权限的 bash shell。攻击者需要首先创建一个包含此恶意程序的可写目录，然后修改 PATH 环境变量，将此目录添加到 PATH 的最前面。之后，当 ndsudo 执行任何外部命令时，都会首先执行攻击者放置的恶意程序，从而获得 root shell。

代码中没有发现明显的投毒行为。它只是简单地设置 uid 和 gid 为 0，然后执行 /bin/bash。因此，投毒风险评估为0%。

利用方式总结：
1.  利用需要先获得一个netdata软件的低权限账号。
2.  创建一个包含恶意程序（例如 POC 中的 C 程序编译后的可执行文件）的可写目录。
3.  修改 PATH 环境变量，将该目录添加到 PATH 的最前面。
4.  触发 ndsudo 执行任何外部命令，这将导致恶意程序以 root 权限执行，从而获得 root shell。

**项目地址:** [x0da6h/POC-for-CVE-2024-32019](https://github.com/x0da6h/POC-for-CVE-2024-32019)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)

---

