## CVE-2024-10924 - Really Simple Security (Free, Pro, and Pro Multisite) 插件 (WordPress) 身份认证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份认证绕过 (Authentication Bypass)

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite) 插件 (WordPress)

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** 9.0.0 至 9.1.1.1

**利用条件:** 需要目标网站启用“双重身份验证 (Two-Factor Authentication)”功能（默认不启用）。攻击者无需现有凭据，通过网络即可利用。

**POC 可用性:** 9/10

**POC 类型:** 完整利用 (基于Docker环境)

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC提供了一套完整的基于Docker的复现环境。分析其Dockerfile、docker-compose.yml以及entrypoint.sh脚本，可以看出该项目旨在快速搭建一个包含WordPress核心及受影响插件的实验环境。代码通过WP-CLI自动化安装WordPress并配置数据库，具有极高的实用性。核心原理针对Really Simple Security插件中的check_login_and_get_user函数存在的逻辑缺陷：在处理2FA REST API请求时，由于错误处理不当，攻击者可以通过特定的参数构造，绕过身份验证逻辑，直接以任意用户（包括管理员ID）身份登录系统。该POC结构清晰，包含环境一键部署脚本、自动化配置流程以及演示视频链接，是极高质量的防御性研究素材，能够有效帮助安全团队验证漏洞存在性并测试补丁有效性。其利用逻辑直接且易于在本地闭环环境复现，省去了手动搭建复杂WordPress依赖环境的过程。【利用步骤】1. 克隆仓库至本地环境。2. 执行docker compose up --build，拉取WordPress和MySQL镜像并启动。3. 访问本地8080端口，按照README指引启用Really Simple Security插件并激活2FA功能。4. 使用REST API客户端向漏洞端点（/wp-json/really-simple-security/v1/two-factor-login）发送构造请求。5. 修改user_id参数为目标用户（如ID为1的管理员）。6. 获取有效的身份认证Cookie，从而以管理员身份接管站点控制权。【投毒风险分析】经过对公开代码段的深度静态分析，该POC项目的投毒风险极低。首先，脚本使用的源均来自官方或可信渠道，如WordPress官网和GitHub上的WP-CLI官方仓库。Dockerfile中的apt-get操作和curl下载行为仅限于安装基础工具（less, mariadb-client, curl），未发现下载混淆二进制文件或跳转至不明域名的行为。entrypoint.sh脚本逻辑透明，主要执行数据库连接检查、WP配置生成及插件激活等标准运维操作。代码中不存在eval()、base64混淆执行或反弹Shell等典型的恶意特征。该项目的目的明确，即通过Docker容器化技术隔离实验环境，避免对宿主机造成负面影响。尽管如此，在执行第三方Dockerfile时，仍建议研究人员在受控的沙箱环境中运行，并监控其网络流量，防止在自动安装插件过程中可能出现的供应链劫持。总体而言，该POC是一个规范的、透明的漏洞研究工具，而非用于传播恶意软件的伪装载体。

**项目地址:** [https://github.com/Trackflaw/CVE-2024-10924-Wordpress-Docker.git](https://www.google.com/search?q=https://github.com/Trackflaw/CVE-2024-10924-Wordpress-Docker.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)
