# CVE-2024-3400

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-3400-0x0d3ad_CVE-2024-3400.md](../2024/CVE-2024-3400-0x0d3ad_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** Palo Alto Networks PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 < 10.2.9-h1, PAN-OS 11.0 < 11.0.4-h1, PAN-OS 11.1 < 11.1.2-h3

**利用条件:** 目标系统配置了GlobalProtect网关或门户，攻击者可以发起网络请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 中的一个命令注入漏洞。该漏洞允许未经身份验证的远程攻击者在受影响的系统上以 root 权限执行任意命令。利用方式是通过向目标服务器的/ssl-vpn/hipreport.esp路径发送特制的HTTP POST请求，并在Cookie头中注入恶意代码。

**有效性分析：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此POC代码是有效的。
  * 漏洞库信息表明该漏洞确实存在，并且有可利用的POC。
  * 搜索结果显示存在大量关于该漏洞的分析和利用的文章。
  * POC代码实现了利用该漏洞执行命令的功能，通过构造包含恶意命令的 Cookie 发送到目标服务器，从而实现远程命令执行。

**投毒风险分析：**
提供的 `exploit.py` 脚本的功能主要是生成并发送包含反弹 shell 命令的 HTTP 请求。代码中没有发现明显的恶意行为或者隐藏的后门代码。脚本的行为是可以预测的，即根据用户输入的 IP 地址和端口，生成反弹 shell 命令，并将其嵌入到 Cookie 中发送给目标服务器。`README.md` 文件也只是描述漏洞信息和使用示例。因此，投毒风险较低，可以判断投毒风险为 0%。

**利用方式分析：**
1.  **漏洞触发点：** GlobalProtect 功能的 `/ssl-vpn/hipreport.esp` 路径。
2.  **攻击向量：** 通过构造恶意的 HTTP Cookie，在 Cookie 中嵌入经过 base64 编码的命令。
3.  **命令注入：**  恶意命令被注入到 Cookie `SESSID` 中，服务器在处理 Cookie 时，未对其中的内容进行充分的验证和过滤，导致命令被执行。
4.  **利用过程：**
    *   攻击者首先需要确定目标系统存在 CVE-2024-3400 漏洞，并且配置了 GlobalProtect 功能。
    *   然后，攻击者运行 `exploit.py` 脚本，输入目标服务器的 IP 地址、攻击者用于接收反弹 shell 的 IP 地址和端口。
    *   脚本会生成一个包含反弹 shell 命令的 HTTP 请求，并将该请求发送到目标服务器的 `/ssl-vpn/hipreport.esp` 路径。
    *   目标服务器在处理该请求时，会执行 Cookie 中的恶意命令，从而建立一个反弹 shell 连接到攻击者的机器上。
    *   攻击者即可通过该反弹 shell 连接控制目标系统。

**项目地址:** [0x0d3ad/CVE-2024-3400](https://github.com/0x0d3ad/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #2

**来源**: [CVE-2024-3400-0xr2r_CVE-2024-3400-Palo-Alto-OS-Command-Injection.md](../2024/CVE-2024-3400-0xr2r_CVE-2024-3400-Palo-Alto-OS-Command-Injection.md)

## CVE-2024-3400 PAN-OS GlobalProtect 任意文件创建导致命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未授权的攻击者可以以root权限执行任意代码

**影响版本:** PAN-OS 10.2（低于10.2.9-h1），PAN-OS 11.0（低于11.0.4-h1），PAN-OS 11.1（低于11.1.2-h3）

**利用条件:** 需要目标系统配置了GlobalProtect网关或GlobalProtect门户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400是一个存在于Palo Alto Networks PAN-OS软件GlobalProtect功能中的任意文件创建导致命令注入漏洞。攻击者可以通过特制的HTTP请求创建任意文件，进而执行任意命令，获得root权限。

**利用方式：**

1.  **漏洞验证：** 首先，攻击者发送一个GET请求到`/global-protect/portal/images/0xr2r.txt`，如果返回404，则表示目标系统不存在此文件，可以继续利用。
2.  **文件创建：** 攻击者发送一个POST请求到`/ssl-vpn/hipreport.esp`，并在Cookie中设置`SESSID`为`/../../../var/appweb/sslvpndocs/global-protect/portal/images/0xr2r.txt`。POST请求的内容可以为空，或者包含一些payload数据，如`user=0xr2r&portal=0xr2r&authcookie=284ad748-7ce2-4753-a39a-aa381b18cf70&domain=0xr2r&computer=0xr2r&client-ip=0xr2r&client-ipv6=0xr2r&md5-sum=0xr2r&gwHipReportCheck=0xr2r`。此操作将在目标系统的指定路径下创建文件`0xr2r.txt`。
3.  **验证文件创建：** 再次发送GET请求到`/global-protect/portal/images/0xr2r.txt`，如果返回403，则表示文件已成功创建。

根据Volexity的分析，该漏洞是由于对`/ssl-vpn/hipreport.esp`的输入验证不足造成的，允许未经身份验证的攻击者创建任意文件。通过创建恶意文件，攻击者可以进一步利用命令注入漏洞执行任意代码。

**有效性：**
提供的POC代码是有效的，它展示了如何利用该漏洞在目标系统上创建任意文件。通过创建文件，可以为进一步的攻击（例如命令注入）奠定基础。

**投毒风险：**
此POC代码中未发现明显的投毒代码。该代码主要展示了如何利用漏洞创建文件。没有发现任何尝试在目标系统上安装后门或执行恶意操作的恶意代码.可以认为投毒风险为0%。但是，应该谨慎对待任何来自不受信任来源的代码，并进行彻底的审查。

**项目地址:** [0xr2r/CVE-2024-3400-Palo-Alto-OS-Command-Injection](https://github.com/0xr2r/CVE-2024-3400-Palo-Alto-OS-Command-Injection)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #3

**来源**: [CVE-2024-3400-AdaniKamal_CVE-2024-3400.md](../2024/CVE-2024-3400-AdaniKamal_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** Palo Alto Networks PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以利用此漏洞以root权限执行任意代码。

**影响版本:** PAN-OS 10.2 (小于 10.2.9-h1), PAN-OS 11.0 (小于 11.0.4-h1), PAN-OS 11.1 (小于 11.1.2-h3)

**利用条件:** 目标系统需要配置GlobalProtect gateway 或 GlobalProtect portal，且是受影响的PAN-OS版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**漏洞评估：**

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 中的一个远程命令执行漏洞。CVSS 评分为 10 分，表明该漏洞非常严重。利用此漏洞，未经身份验证的攻击者可以在受影响的设备上以 root 权限执行任意代码。

**漏洞有效性：**

根据漏洞库信息和搜索结果，CVE-2024-3400 已经被积极利用。漏洞库信息明确指出 Palo Alto Networks 已经意识到越来越多的攻击利用了这个漏洞，并且已经公开了第三方提供的概念验证代码。多个搜索结果也印证了这一点，并提供了关于检测利用尝试和后渗透活动的更多信息。

提供的代码`panos-scanner.py` 是一个版本检测工具，可以帮助确定远程 PAN-OS 目标的软件版本。这个工具本身并不能直接利用该漏洞，但可以用于识别易受攻击的目标。 因此，提供的POC代码不是直接的漏洞利用代码,而只是一个辅助确定目标版本脚本, 需要配合其他的exp利用。

**投毒风险：**

分析 `panos-scanner.py`，此脚本的主要目的是通过发送 HTTP 请求到目标 PAN-OS 设备，并分析返回的 HTTP 头部来确定其版本。脚本中存在以下潜在的投毒风险：

*   **依赖项风险：** 脚本依赖于 `requests` 和 `urllib3` 库。如果这些库被恶意替换，可能导致代码执行或其他恶意行为。
*   **版本表篡改：** 脚本使用 `version-table.txt` 文件来映射日期和 PAN-OS 版本。如果此文件被篡改，可能导致误报或漏报。
*   **请求劫持：** 虽然脚本使用了 `verify=False` 禁用了 SSL 证书验证，但如果攻击者能够劫持网络流量，可以伪造响应，从而欺骗脚本。
*   **参数注入：** 脚本接受命令行参数，例如目标 URL。如果对这些参数没有进行充分的验证，可能会导致命令注入。

考虑到以上因素，以及脚本的主要功能是版本检测，因此，该仓库中存在作者隐藏的投毒代码的可能性较低，估计为 10%。

**利用方式：**

CVE-2024-3400 是一个命令注入漏洞，允许未经身份验证的攻击者在受影响的 PAN-OS 设备上执行任意代码。利用方式通常涉及以下步骤：

1.  **目标识别：** 使用诸如 `panos-scanner.py` 这样的工具或手动分析来识别运行易受攻击的 PAN-OS 版本的设备，并且GlobalProtect 已配置启用。
2.  **漏洞触发：** 向 GlobalProtect 门户或网关发送特制的 HTTP 请求，其中包含恶意命令。由于这是一个任意文件创建导致的命令注入漏洞，攻击者可以通过构造特定的请求，使得 PAN-OS 在文件创建过程中执行恶意命令。
3.  **代码执行：** 成功利用该漏洞后，攻击者可以以 root 权限在防火墙上执行任意代码，例如安装后门、窃取敏感数据或中断服务。

**总结：**

CVE-2024-3400 是一个严重的安全漏洞，需要立即修复。建议受影响的用户尽快升级到 Palo Alto Networks 提供的修复版本。

**项目地址:** [AdaniKamal/CVE-2024-3400](https://github.com/AdaniKamal/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #4

**来源**: [CVE-2024-3400-Chocapikk_CVE-2024-3400.md](../2024/CVE-2024-3400-Chocapikk_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以以root权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标设备配置了GlobalProtect网关或GlobalProtect Portal，且在受影响的PAN-OS版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞，未经身份验证的攻击者可以在启用了 GlobalProtect 的 PAN-OS 防火墙上以 root 权限执行任意代码。

**漏洞利用方式：**

1.  **漏洞点:** 漏洞存在于GlobalProtect组件处理 `hipreport.esp` 请求的过程中。
2.  **攻击方式:** 攻击者通过构造包含目录遍历的恶意`SESSID` cookie发送POST请求到`/ssl-vpn/hipreport.esp` 。目录遍历允许攻击者覆盖或创建Web服务器可访问目录之外的文件。
3.  **命令注入:**  利用目录遍历，攻击者可以在特定位置创建一个文件，其中包含要执行的命令。
4.  **代码执行:** 创建的文件包含的命令会被PAN-OS执行，导致远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果和提供的POC代码，该漏洞是有效的。漏洞库信息明确指出该漏洞已被积极利用，并且存在公开的POC代码。搜索结果也证实了这一点，多个安全厂商发布了关于该漏洞的分析和检测方法。提供的POC代码实现了利用该漏洞进行远程代码执行或漏洞扫描的功能。

**投毒风险分析：**

代码中存在一些潜在的风险，需要进一步人工分析。
1. 脚本依赖于`pwncat-vl`。由于`pwncat`是一个渗透测试工具，引入这个库可能会增加攻击面。检查该库的安全性是必要的。
2.  代码尝试利用socket进行反向shell连接。虽然这是漏洞利用的一部分，但如果脚本被恶意修改，可能会被滥用。
3. 文件名的生成使用uuid，这降低了恶意文件被预测到的可能性，但仍需注意文件创建的位置和内容。

尽管存在上述风险，但从代码的整体结构来看，其主要功能是利用漏洞实现远程代码执行或扫描，没有明显的恶意代码，所以存在一定比例的投毒风险。

**项目地址:** [Chocapikk/CVE-2024-3400](https://github.com/Chocapikk/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #5

**来源**: [CVE-2024-3400-CyberBibs_SOC274---Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400-.md](../2024/CVE-2024-3400-CyberBibs_SOC274---Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400-.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未授权攻击者可利用该漏洞以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统需配置 GlobalProtect gateway 或 portal，无需开启设备遥测

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞。攻击者可以通过构造恶意请求，利用任意文件创建漏洞实现命令注入，最终在防火墙上以 root 权限执行任意代码。

**有效性评估：**

根据漏洞描述和搜索结果，CVE-2024-3400 漏洞是一个严重的安全问题，存在公开可用的 PoC，且已被实际利用。因此，提供的 PoC 代码很可能有效。

**投毒风险评估：**

提供的漏洞利用代码仅包含README.md文件，该文件主要描述了安全分析人员如何检测和响应此漏洞，没有发现任何可以执行的代码。
因此，可以判定该仓库存在作者隐藏的投毒代码的可能性较低，大约为10%， 主要考虑有以下几点原因：
*   **README.md文件：** 该文件详细描述了漏洞的分析、检测和修复过程，更像是一个安全分析报告。
*   **引用外部PoC：** 该文件引用了 GitHub 上另一个 PoC 仓库（`https://github.com/seed1337/CVE-2024-24919-POC/blob/main/exploit.py`），表明作者可能并未自行编写漏洞利用代码，而是使用了公开资源。
*   **缺乏可执行代码：** 提供的文件中没有任何可执行的代码，因此无法直接进行恶意操作。

**利用方式分析：**

1.  **漏洞成因：** 由于GlobalProtect 功能中存在任意文件创建漏洞，导致可以执行系统命令。
2.  **攻击方式：** 攻击者构造特定的 HTTP 请求，该请求包含恶意的 payload， 尝试读取敏感文件（例如 `/etc/shadow`）。
3.  **利用结果：** 成功利用该漏洞可使攻击者在目标系统上以 root 权限执行任意命令。
4.  **修复方案：** 升级到 PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3 及以上版本。

**项目地址:** [CyberBibs/SOC274---Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400-](https://github.com/CyberBibs/SOC274---Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400-)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #6

**来源**: [CVE-2024-3400-CyprianAtsyor_letsdefend-cve2024-3400-case-study.md](../2024/CVE-2024-3400-CyprianAtsyor_letsdefend-cve2024-3400-case-study.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** Palo Alto Networks PAN-OS GlobalProtect

**危害等级:** 高危，未授权远程命令执行，可完全控制防火墙

**影响版本:** PAN-OS 10.2 (小于 10.2.9-h1), 11.0 (小于 11.0.4-h1), 11.1 (小于 11.1.2-h3)

**利用条件:** 存在GlobalProtect网关或Portal配置，且防火墙版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是一个存在于Palo Alto Networks PAN-OS GlobalProtect功能中的命令注入漏洞。该漏洞允许未经身份验证的攻击者在防火墙上以root权限执行任意代码。根据漏洞信息和搜索结果，该漏洞的利用方式是利用特制的SESSID cookie，其中包含经过反引号执行的命令，并利用 `${IFS}` 绕过简单的过滤器。攻击者可以通过 `/global-protect/login.esp` 端点将payload注入，从而创建一个任意文件，导致命令注入。

**漏洞利用有效性：**

从提供的漏洞库信息、搜索结果以及漏洞利用代码来看，该漏洞利用是有效的。漏洞库信息中明确指出“Palo Alto Networks is aware of an increasing number of attacks that leverage the exploitation of this vulnerability”以及“Proof of concepts for this vulnerability have been publicly disclosed by third parties.”，证明该漏洞在野外已被利用且存在可用的PoC。

搜索结果也证实了这一点，例如“CVE-2024-3400 Activity | ThreatLabz” 和 “CVE-2024-3400 PAN-OS Zero-Day: What You Need To...” 都表明该漏洞正在被积极利用。

漏洞利用代码（README.md）中也详细描述了一个真实的攻击案例，包括攻击者使用的payload、C2服务器、以及受影响的端点等，进一步证实了该漏洞的可利用性。

**投毒风险分析：**

提供的漏洞利用代码（README.md）主要是一个事件调查报告和分析，用于检测和响应CVE-2024-3400的攻击尝试。虽然提供了IOC、利用模式和缓解措施，但该文件本身并没有包含恶意代码。

但是，考虑到该漏洞允许远程代码执行，攻击者可能会利用该漏洞部署后门或其他恶意软件。因此，在实际利用PoC进行测试时，需要格外小心，确保在一个隔离的环境中进行，并仔细检查利用过程中产生的任何文件或进程。

根据对代码的分析，投毒风险较低，估计为10%。风险主要来自如果直接复制利用代码而不理解其含义，可能会无意中执行一些不期望的操作，但代码本身没有明显的恶意目的。

**利用方式总结：**

1.  **目标：** 存在GlobalProtect配置的Palo Alto Networks PAN-OS防火墙（版本在受影响范围内）。
2.  **入口点：** `/global-protect/login.esp` 端点。
3.  **攻击载荷：** 特制的 `SESSID` cookie，包含反引号执行的命令，并使用 `${IFS}` 绕过过滤器。
4.  **利用过程：** 攻击者发送包含恶意 `SESSID` 的 HTTP POST 请求到 `/global-protect/login.esp` 端点，触发命令注入。
5.  **结果：** 在防火墙上以 root 权限执行任意命令，例如，下载并执行恶意脚本，建立反向shell等。

**项目地址:** [CyprianAtsyor/letsdefend-cve2024-3400-case-study](https://github.com/CyprianAtsyor/letsdefend-cve2024-3400-case-study)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #7

**来源**: [CVE-2024-3400-HackingLZ_panrapidcheck.md](../2024/CVE-2024-3400-HackingLZ_panrapidcheck.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未授权攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (低于 10.2.9-h1), 11.0 (低于 11.0.4-h1), 和 11.1 (低于 11.1.2-h3)

**利用条件:** 目标系统配置了 GlobalProtect 网关或 Portal

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞的存在，未经身份验证的攻击者可以在具有 root 权限的防火墙上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的PoC。漏洞库信息中提到 “Palo Alto Networks is aware of an increasing number of attacks that leverage the exploitation of this vulnerability. Proof of concepts for this vulnerability have been publicly disclosed by third parties.”
搜索结果中也包含多个威胁情报报告和分析，表明该漏洞的利用已经发生。
提供的代码， `panparse.py`,本身并不是直接的漏洞利用代码，而是一个用于分析 Palo Alto Networks 技术支持文件的 Python 脚本。它旨在帮助安全分析师查找与 CVE-2024-3400 相关的入侵痕迹（IOCs）。此脚本分析日志文件，例如gpsvc.log，sslvpn-access.log 和 nginx 的访问日志，以查找可疑活动。`iocs.txt` 文件包含已知的恶意IP地址，脚本将使用这些IP地址在日志中进行搜索。

因此，提供的PoC代码的有效性在于辅助分析，而不是直接利用漏洞。

**投毒风险分析：**

*   `README.md`：只是一个说明文件，描述了脚本的用途和使用方法，没有投毒风险。
*   `iocs.txt`：包含一个IP地址。虽然可以通过添加额外的恶意IP地址来误导分析，但这不是传统的代码投毒。风险较低。
*   `panparse.py`：Python脚本，分析日志文件。潜在的投毒方式可能包括：
    *   **恶意正则表达式：** 正则表达式如果构造不当，可能导致拒绝服务（ReDoS）攻击。
    *   **文件路径操纵：** 脚本处理文件路径，如果存在路径遍历漏洞，可能导致脚本访问或修改不应访问的文件。
    *   **执行任意命令：** 如果脚本包含执行系统命令的功能（虽然提供的代码中未直接体现，但可以通过构造特定的日志内容来实现），则可能被利用执行恶意命令。
*   **综合评估：** 由于脚本主要是分析日志文件，投毒的直接危害较小，主要集中在误导分析人员或造成拒绝服务。但如果配合精心构造的日志文件，可能存在一定的风险。

整体来看，投毒风险较低，大约为10%。 风险主要来自于被分析的日志内容和脚本本身存在的潜在漏洞，而不是恶意代码。

**利用方式：**

1.  **未授权访问：** 攻击者不需要身份验证即可触发漏洞。
2.  **文件创建：** 漏洞允许攻击者在系统上创建任意文件。
3.  **命令注入：** 通过创建包含恶意代码的文件，攻击者可以利用命令注入漏洞执行任意命令，从而获得 root 权限。
4.  **GlobalProtect配置：** 该漏洞仅影响配置了GlobalProtect网关或Portal的PAN-OS系统。


**项目地址:** [HackingLZ/panrapidcheck](https://github.com/HackingLZ/panrapidcheck)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #8

**来源**: [CVE-2024-3400-Kr0ff_cve-2024-3400.md](../2024/CVE-2024-3400-Kr0ff_cve-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以在防火墙上以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2（低于 10.2.9-h1）、11.0（低于 11.0.4-h1）和 11.1（低于 11.1.2-h3）

**利用条件:** 目标系统需要配置 GlobalProtect 网关或 GlobalProtect 门户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞，未经身份验证的攻击者可以利用此漏洞在受影响的防火墙上以 root 权限执行任意代码。

**有效性：**
提供的 PoC 代码似乎有效。漏洞库信息和搜索结果都表明该漏洞已被积极利用，并且存在公开的 PoC。该PoC代码包含check模块，可以验证目标是否存在漏洞，exploit模块可以执行命令。

**投毒风险：**
该 PoC 代码的投毒风险较低 (0%)。代码相对简单，主要是利用请求进行漏洞验证和利用。没有发现明显的恶意或隐藏行为，例如下载和执行任意二进制文件、修改系统文件或安装后门。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于GlobalProtect组件中，通过构造特殊的HTTP请求触发。该漏洞允许攻击者创建任意文件。
2.  **命令注入：** 攻击者利用任意文件创建漏洞进行命令注入，以执行恶意代码。
3.  **权限提升：** 成功利用该漏洞后，攻击者可以在目标系统上获得 root 权限。

**PoC 利用方式分析：**
*   **check 模块：**  检查目标是否容易受到攻击。
    *   它使用特制的 Cookie 发送 POST 请求到 `/ssl-vpn/hipreport.esp` 端点。Cookie 包含路径遍历序列，旨在访问 web 服务器文档目录之外的文件。
    *   如果请求返回状态代码 200，则脚本会尝试使用不包含 Cookie 的单独 GET 请求来访问服务器上使用 Cookie 值中指定的文件名构造的路径。 如果此 GET 请求返回状态代码 403（禁止），则目标被认为是易受攻击的。
*   **exploit 模块：** 利用漏洞执行命令。
    *   它通过构造带有恶意 Cookie 的HTTP POST请求到 `/ssl-vpn/hipreport.esp` 端点，触发命令执行。Cookie 包含命令注入payload，该payload将执行任意命令。
    *   该脚本使用`${IFS}`绕过空格过滤。
    *   该脚本尝试通过HTTP和HTTPS发送请求。

**缓解措施：**
建议立即升级到 PAN-OS 的固定版本，即使已应用解决方法和缓解措施。 该问题已在 PAN-OS 10.2.9-h1、PAN-OS 11.0.4-h1、PAN-OS 11.1.2-h3 以及所有更高版本的 PAN-OS 中得到修复。

**项目地址:** [Kr0ff/cve-2024-3400](https://github.com/Kr0ff/cve-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #9

**来源**: [CVE-2024-3400-MurrayR0123_CVE-2024-3400-Compromise-Checker.md](../2024/CVE-2024-3400-MurrayR0123_CVE-2024-3400-Compromise-Checker.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未授权的攻击者可以以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2 (低于 10.2.9-h1), PAN-OS 11.0 (低于 11.0.4-h1), PAN-OS 11.1 (低于 11.1.2-h3)

**利用条件:** 需要目标系统配置了 GlobalProtect 网关或 GlobalProtect 门户，无需启用设备遥测。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞，源于任意文件创建漏洞。未经身份验证的攻击者可以利用此漏洞在防火墙上以 root 权限执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开可用的 PoC。提供的 `cve-2024-3400_checker.sh` 脚本并非直接的漏洞利用代码，而是用于检测目标系统是否已经被入侵，该脚本通过检查web服务器日志、恶意文件和可疑的计划任务等方式进行检测。

**投毒风险：**
该脚本本身旨在检测漏洞利用后的痕迹，而非利用漏洞。虽然脚本本身不会直接执行恶意操作，但仍有很小的风险：
*   **误报：** 脚本可能会因为某些特征与恶意行为相似而产生误报，导致不必要的恐慌。
*   **信息泄露：** 脚本运行时会读取系统日志和配置文件，如果脚本被恶意修改，可能会泄露敏感信息。
因此，投毒风险估计为 10%。

**利用方式：**
根据漏洞信息描述和搜索结果，攻击者利用此漏洞通常涉及以下步骤：
1.  **利用任意文件创建漏洞：** 攻击者首先利用漏洞在目标系统上创建任意文件。
2.  **命令注入：**  通过精心构造的文件内容，攻击者可以注入恶意命令。
3.  **以 root 权限执行代码：** 注入的命令以 root 权限执行，攻击者从而完全控制受影响的系统。

根据Volexity的分析报告，攻击者可能还会使用Upstyle后门进行持久化控制。
检测脚本中的检测点也反映了这些攻击特征，例如检测`/var/lib/python3.6/site-packages/system.pth`中是否包含base64编码的恶意代码，以及检查/tmp目录下是否存在创建GlobalProtect相关目录或下载执行恶意脚本的行为。


**项目地址:** [MurrayR0123/CVE-2024-3400-Compromise-Checker](https://github.com/MurrayR0123/CVE-2024-3400-Compromise-Checker)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #10

**来源**: [CVE-2024-3400-Ravaan21_CVE-2024-3400.md](../2024/CVE-2024-3400-Ravaan21_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 任意文件创建导致命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，允许未授权的攻击者以root权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统需要配置GlobalProtect网关或门户，且未应用漏洞补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞。该漏洞源于任意文件创建，可能允许未经身份验证的攻击者在防火墙上以root权限执行任意代码。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的POC。
提供的Python和Rust版本的POC代码尝试利用该漏洞来检测目标系统是否存在漏洞。POC代码通过发送特制的HTTP请求到目标系统的GlobalProtect接口，尝试创建或访问特定文件。如果成功，则认为系统易受攻击。

**投毒风险分析：**

查看提供的Python和Rust POC代码，未发现明显的恶意或投毒代码。这些代码的主要目的是验证漏洞的存在，而非植入后门或执行恶意操作。

*   Python 代码：`/tmp/b413b80758a8cc351e9d0e6068c08cc3/CVE-2024-3400.py` 使用 `requests` 库发送 HTTP 请求，检查目标是否易受攻击，并将易受攻击的IP地址写入`vuln.txt`。这部分代码没有发现任何投毒行为。
*   Rust 代码：`/tmp/b413b80758a8cc351e9d0e6068c08cc3/src/main.rs` 的功能与 Python 版本类似，使用 `reqwest` 库发送 HTTP 请求，并将易受攻击的 IP 地址写入`vuln.txt`。同样，没有发现恶意代码。

因此，投毒风险评估为0%。

**利用方式：**

1.  **漏洞触发：** 攻击者发送特制的HTTP请求到目标系统的GlobalProtect接口，请求包含恶意构造的文件路径，导致服务器尝试创建或访问该文件。
2.  **命令注入：** 由于输入验证不当，恶意文件路径中的特殊字符被解释为命令，导致系统执行攻击者指定的任意代码。
3.  **权限提升：** 该漏洞允许攻击者以root权限执行代码，从而完全控制受影响的防火墙。

**缓解措施：**

*   立即升级到PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3或更高版本。
*   如果无法立即升级，可以应用威胁防御签名95187、95189和95191（在应用程序和威胁内容版本8836-8695及更高版本中可用）来阻止攻击。

**项目地址:** [Ravaan21/CVE-2024-3400](https://github.com/Ravaan21/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #11

**来源**: [CVE-2024-3400-Rohith-Reddy-Y_Zero-Day-Vulnerability-Exploitation-Detection-Tool.md](../2024/CVE-2024-3400-Rohith-Reddy-Y_Zero-Day-Vulnerability-Exploitation-Detection-Tool.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以利用此漏洞在防火墙上以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2（低于 10.2.9-h1）、PAN-OS 11.0（低于 11.0.4-h1）和 PAN-OS 11.1（低于 11.1.2-h3）

**利用条件:** 需要目标系统配置了 GlobalProtect 网关或 GlobalProtect 门户（或两者）。设备不需要启用 telemetry。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。该漏洞源于任意文件创建，攻击者可以利用它来执行任意命令。该漏洞影响配置了 GlobalProtect 网关或门户的特定 PAN-OS 版本。\n\n**有效性：**\n根据漏洞库信息、搜索结果（如ihebski/CVE-2024-3400在github上存在）表明存在公开可用的PoC，以及Volexity和Palo Alto Networks官方的威胁报告，确认该漏洞已被积极利用，因此该漏洞利用代码有效性较高。\n\n**投毒风险：**\n提供的漏洞利用代码是一个“Zero-Day Vulnerability Exploitation Detection Tool”，旨在 *检测* 而非 *利用* 漏洞。该工具使用 AI/ML 技术分析网络流量以检测异常模式，从而预测和阻止零日攻击。但仓库包含AI检测模型，有较大概率存在作者隐藏的后门代码，存在一定的投毒风险。\n\n**利用方式：**\n根据CVE描述，以及搜索结果，可以总结出以下利用方式：\n1.  **利用 GlobalProtect 功能中的任意文件创建漏洞。**\n2.  **通过精心构造的请求，在目标系统上创建恶意文件。**\n3.  **利用创建的文件执行命令注入，从而在防火墙上以 root 权限执行任意代码。**

**项目地址:** [Rohith-Reddy-Y/Zero-Day-Vulnerability-Exploitation-Detection-Tool](https://github.com/Rohith-Reddy-Y/Zero-Day-Vulnerability-Exploitation-Detection-Tool)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #12

**来源**: [CVE-2024-3400-W01fh4cker_CVE-2024-3400-RCE-Scan.md](../2024/CVE-2024-3400-W01fh4cker_CVE-2024-3400-RCE-Scan.md)

## CVE-2024-3400-PAN-OS-命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，允许未授权的攻击者以root权限执行任意代码

**影响版本:** PAN-OS 10.2, 11.0, 和 11.1（特定版本）

**利用条件:** 需要目标系统配置了GlobalProtect网关或门户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞。该漏洞源于任意文件创建，允许未经身份验证的攻击者在防火墙上以 root 权限执行任意代码。该漏洞影响配置了 GlobalProtect 网关或门户的特定 PAN-OS 版本（10.2.0 < 10.2.9-h1, 11.0.0 < 11.0.4-h1, 11.1.0 < 11.1.2-h3）。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的PoC代码，因此提供的PoC代码很可能有效。

**利用方式：**

1.  **利用入口：** 漏洞存在于PAN-OS的GlobalProtect功能中，需要目标开启GlobalProtect网关或者GlobalProtect门户。
2.  **漏洞触发：** 通过构造包含恶意命令的特殊Cookie，利用`/ssl-vpn/hipreport.esp`接口触发漏洞。
3.  **命令注入：** Cookie中的命令经过base64编码，然后在服务器端解码并执行。
4.  **任意文件创建：** 攻击者可以利用命令注入创建任意文件，例如，将敏感信息（如running-config.xml）写入到Web可访问的目录。
5.  **远程代码执行：** 成功利用漏洞后，攻击者可以以 root 权限在防火墙上执行任意代码。

**PoC代码分析：**

PoC代码的工作流程如下：

1.  **生成随机字符串：** 用于创建唯一的文件名。
2.  **构造恶意Cookie：**  Cookie中包含一个经过Base64编码的命令，该命令使用`tar`命令将`/opt/pancfg/mgmt/saved-configs/running-config.xml`文件压缩到`/var/appweb/sslvpndocs/global-protect/portal/js/jquery.{filename}.js`。利用`SESSID=/../../../opt/panlogs/tmp/device_telemetry/minute/`来进行目录穿越，从而达到任意文件创建的目的。
3.  **发送POST请求：** 向`/ssl-vpn/hipreport.esp`发送包含恶意Cookie的POST请求。
4.  **验证利用结果：** 检查是否可以访问`/global-protect/portal/js/jquery.{filename}.js`，如果可以访问，则表明漏洞利用成功。

**投毒风险分析：**

PoC代码的主要功能是验证漏洞是否存在，并将running-config.xml文件复制到Web可访问的目录。由于PoC需要在目标系统上执行命令，因此存在一定的投毒风险。例如，作者可能在编码的命令中添加恶意代码，导致执行`rm -rf /`或者反弹shell等恶意行为，当然，这部分命令是直接可见的，可以审计出来。

**投毒风险评估：**

代码中存在创建文件，读取配置文件的操作，这些操作本身可能被利用于进行恶意活动，比如替换文件内容、窃取配置文件中的密钥等敏感信息。但是，代码中利用的命令注入点以及创建和读取的行为都是漏洞利用本身所需要的，因此不能完全确定是作者有意为之的投毒行为。投毒风险评估为10%。

**项目地址:** [W01fh4cker/CVE-2024-3400-RCE-Scan](https://github.com/W01fh4cker/CVE-2024-3400-RCE-Scan)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #13

**来源**: [CVE-2024-3400-XiaomingX_CVE-2024-3400-poc.md](../2024/CVE-2024-3400-XiaomingX_CVE-2024-3400-poc.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可利用此漏洞以 root 权限在防火墙上执行任意代码

**影响版本:** PAN-OS 10.2 (低于 10.2.9-h1), PAN-OS 11.0 (低于 11.0.4-h1), PAN-OS 11.1 (低于 11.1.2-h3)

**利用条件:** 需要配置 GlobalProtect 网关或 GlobalProtect 门户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞，由于任意文件创建漏洞导致。未经身份验证的攻击者可以利用此漏洞在受影响的防火墙上以 root 权限执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已经被积极利用，并且已经有公开的 POC 代码。

**投毒风险：**
提供的漏洞利用代码只是 Apache 2.0 许可协议的文本，无法用于分析投毒风险。因此，从现有信息无法判断该代码库中是否存在投毒代码。考虑到漏洞的严重性和广泛利用的情况，应谨慎对待任何来源不明的漏洞利用代码。

**利用方式：**
1.  **漏洞入口：**  GlobalProtect 的特定功能（网关或门户）。
2.  **根本原因：**  由于任意文件创建导致的命令注入漏洞。
3.  **攻击过程：**  攻击者利用漏洞在系统上创建恶意文件，该文件包含恶意命令。
4.  **权限提升：**  由于命令注入以 root 权限执行，攻击者可以完全控制受影响的防火墙。
5.  **影响：**  完全控制防火墙，可能导致数据泄露、服务中断、横向移动等。

**缓解措施：**
*   立即升级到已修复的 PAN-OS 版本（10.2.9-h1、11.0.4-h1、11.1.2-h3 及更高版本）。
*   使用威胁防御订阅来阻止针对此漏洞的攻击（威胁 ID 95187、95189 和 95191）。
*   确保已将漏洞保护应用于 GlobalProtect 接口。

根据搜索结果，CISA 已将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞正在被广泛利用。

**项目地址:** [XiaomingX/CVE-2024-3400-poc](https://github.com/XiaomingX/CVE-2024-3400-poc)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #14

**来源**: [CVE-2024-3400-ZephrFish_CVE-2024-3400-Canary.md](../2024/CVE-2024-3400-ZephrFish_CVE-2024-3400-Canary.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以以 root 权限在防火墙上执行任意代码。

**影响版本:** PAN-OS 10.2 (低于 10.2.9-h1), PAN-OS 11.0 (低于 11.0.4-h1), PAN-OS 11.1 (低于 11.1.2-h3)

**利用条件:** 需要目标系统配置了 GlobalProtect gateway 或 GlobalProtect portal (或两者)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞，未经身份验证的攻击者可以利用此漏洞在受影响的防火墙上以 root 权限执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞 CVSS 评分高达 10.0，已被积极利用。提供的 PoC 代码尝试通过设置包含恶意命令的 `SESSID` cookie 来利用该漏洞。恶意命令使用 `curl` 和 `base64` 下载并执行来自 `kgezdr4fafaval55y8t2w9up.canarytokens.com` 的 shell 脚本。此行为符合命令注入漏洞的特征，因此 PoC 代码可能有效。

**投毒风险分析：**

PoC 代码本身不包含明显的投毒代码，其主要功能是利用漏洞执行命令。但是，需要注意的是，PoC 代码从外部 URL (`kgezdr4fafaval55y8t2w9up.canarytokens.com`) 下载并执行 shell 脚本。这意味着攻击者可以通过控制此 URL 来投放恶意代码。由于该URL属于canarytokens.com，该网站提供的token会发送警报，因此不太可能是恶意网址, 投毒风险较低，但依然存在。因此，风险评估百分比为10%。

**利用方式分析：**

1.  **漏洞点：** GlobalProtect 的登录页面 (`/global-protect/login.esp`)。
2.  **攻击方式：** 通过设置 `SESSID` cookie 注入恶意命令。Cookie 的值被设置为包含操作系统命令的字符串，这些命令会尝试下载并执行远程 shell 脚本。
3.  **命令执行：** 注入的命令使用 `curl` 和 `base64` 从指定 URL 下载 base64 编码的 shell 脚本，解码后通过 `bash` 执行。
4.  **权限提升：** 由于漏洞是在 PAN-OS 中利用的，且具有 root 权限执行代码的能力，因此攻击者可以完全控制受影响的防火墙。
5.  **利用条件：** 目标 PAN-OS 设备需要配置了 GlobalProtect 网关或门户，并且运行的是受影响的版本。

**项目地址:** [ZephrFish/CVE-2024-3400-Canary](https://github.com/ZephrFish/CVE-2024-3400-Canary)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #15

**来源**: [CVE-2024-3400-ak1t4_CVE-2024-3400.md](../2024/CVE-2024-3400-ak1t4_CVE-2024-3400.md)

## CVE-2024-3400 Palo Alto PAN-OS GlobalProtect 任意文件创建导致命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** Palo Alto Networks PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以在防火墙上以 root 权限执行任意代码。

**影响版本:** PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1版本, 小于 PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3

**利用条件:** 目标设备配置了 GlobalProtect 网关或 GlobalProtect 门户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞，该漏洞是由于任意文件创建导致的。未经身份验证的攻击者可以通过向目标系统发送特制的HTTP请求，在特定版本的PAN-OS上，利用GlobalProtect功能写入任意文件，最终导致命令注入，以root权限执行任意代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行受影响PAN-OS版本且配置了GlobalProtect网关或门户的Palo Alto防火墙。
2.  **利用漏洞：** 通过发送包含恶意Cookie的HTTP POST请求到`/ssl-vpn/hipreport.esp`，在`/var/appweb/sslvpndocs/global-protect/portal/images/`目录下创建任意文件。Cookie中包含`SESSID=/../../../var/appweb/sslvpndocs/global-protect/portal/images/${file_here};`，`${file_here}`是要写入的文件名，也是命令注入的关键位置。
3.  **命令执行：**  创建的文件内容可被执行，从而实现命令注入。

**有效性评估：**

根据漏洞描述和漏洞利用代码，该POC代码是有效的。它通过`httpx`工具发送特制的HTTP请求，利用任意文件创建漏洞实现命令注入。脚本首先尝试写入文件，然后验证文件是否成功写入（通过检查HTTP状态码）。

**投毒风险分析：**

该POC代码本身比较简洁，主要利用了`httpx`工具发送恶意请求。潜在的投毒风险在于：

*   **恶意URL列表：** `gp.hosts`文件可能包含指向恶意站点的链接，这些站点可能托管恶意软件或进行其他攻击活动。用户在使用该脚本时，如果使用不可信的URL列表，可能会受到二次攻击。
*   **文件写入位置：** 攻击者可能会修改脚本，将文件写入到更敏感的位置，从而扩大攻击范围。

总体来说，投毒风险较低，约为10%。主要是由于脚本功能较为单一，且依赖于`httpx`工具，恶意代码隐藏的空间有限。但用户仍需谨慎使用，并确保使用可信的URL列表。

**缓解措施：**

*   升级到PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3或更高版本。
*   应用威胁防御签名95187、95189和95191。
*   对GlobalProtect接口应用漏洞保护。

**项目地址:** [ak1t4/CVE-2024-3400](https://github.com/ak1t4/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #16

**来源**: [CVE-2024-3400-andrelia-hacks_CVE-2024-3400.md](../2024/CVE-2024-3400-andrelia-hacks_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码。

**影响版本:** PAN-OS 10.2（低于10.2.9-h1），PAN-OS 11.0（低于11.0.4-h1），PAN-OS 11.1（低于11.1.2-h3）。仅影响配置了GlobalProtect网关或GlobalProtect门户的防火墙。

**利用条件:** 目标系统需启用GlobalProtect门户或网关功能，且为受影响的PAN-OS版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是一个Palo Alto Networks PAN-OS中GlobalProtect功能存在的任意文件创建导致的操作系统命令注入漏洞。未经身份验证的攻击者可以通过构造恶意请求，在受影响的系统上以root权限执行任意代码。

**漏洞利用有效性：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判定此漏洞利用是有效的。漏洞库信息显示Palo Alto Networks已知存在利用此漏洞的攻击，并且第三方已公开PoC。搜索结果也证实了该漏洞已被积极利用。

**投毒风险分析：**

PoC代码主要包含以下几个文件：

*   `LICENSE`：MIT许可证，表明作者允许自由使用、复制、修改和分发代码。
*   `README.md`：包含漏洞的描述、使用方法、依赖说明和参考链接。使用说明指示如何扫描目标并提取配置文件。
*   `get_data.py`：该脚本从`confirmed_rce.log`文件中读取目标URL，然后使用多线程下载文件。下载的文件存储在`out/`目录下。
*   `run.py`：此脚本用于扫描目标，尝试利用该漏洞。它创建一个随机的文件名，并构造一个命令来打包`/opt/pancfg/mgmt/saved-configs/running-config.xml`文件，并将其保存在`/var/appweb/sslvpndocs/global-protect/portal/js/`目录下，这个目录是GlobalProtect Portal的js文件目录。

风险评估：

1.  **依赖安装：** `README.md`中要求安装`rich`库，这本身是相对安全的，但是从非官方源安装包则存在一定的风险。
2.  **目标文件获取：** `get_data.py`从`confirmed_rce.log`读取URL并下载文件。如果`confirmed_rce.log`被篡改，可能导致下载恶意文件。
3.  **命令构造：**  `run.py`构造的命令会将配置文件打包并放置到Web可访问目录，从而泄露敏感信息，例如管理员密码哈希等。攻击者可以利用这些信息进行进一步的攻击。

投毒风险：
代码本身看起来是合法的PoC，用于检测和利用CVE-2024-3400漏洞。但是，存在一些潜在的投毒风险，例如：
* 如果攻击者修改了`run.py`脚本，使其执行恶意命令，例如删除文件或安装后门，则可能造成更大的危害。但是目前看到的脚本仅仅是把配置文件导出来，风险较小。
*  如果依赖项`rich`被恶意版本替换，也可能导致代码执行过程中出现问题。

虽然存在上述风险，但考虑到PoC的主要功能是利用漏洞，而不是直接执行恶意操作，因此投毒的概率较低。此外，该PoC仅用于`get_data.py`下载文件，以及`run.py`产生exp，因此，这里的**投毒概率大概在10%**左右。

**漏洞利用方式：**

1.  **确定目标：** 攻击者首先需要确定存在漏洞的PAN-OS防火墙，这些防火墙启用了GlobalProtect门户或网关功能，并且运行着受影响的PAN-OS版本。
2.  **发送恶意请求：** 攻击者发送特制的HTTP请求，其中包含用于创建任意文件的命令注入代码。`run.py`文件展示了如何通过base64编码的命令，利用`tar`命令将敏感配置文件`/opt/pancfg/mgmt/saved-configs/running-config.xml`打包到Web可访问目录中。
3.  **执行任意代码：**  由于文件创建过程存在漏洞，攻击者可以将恶意代码注入到创建的文件中，或者利用文件创建来执行操作系统命令。通过将打包好的配置文件放置在web目录，攻击者可以下载这些文件。
4.  **权限提升：**  由于命令注入是以root权限执行的，攻击者可以完全控制受影响的系统，包括安装后门、窃取数据或破坏系统。
5.  **提取敏感信息：** 攻击者可以通过`get_data.py`下载配置文件，获取敏感信息。

总而言之，该漏洞的利用过程涉及发送恶意请求，利用任意文件创建漏洞执行命令注入，最终实现远程代码执行和权限提升。

**项目地址:** [andrelia-hacks/CVE-2024-3400](https://github.com/andrelia-hacks/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #17

**来源**: [CVE-2024-3400-codeblueprint_CVE-2024-3400.md](../2024/CVE-2024-3400-codeblueprint_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未授权的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (< 10.2.9-h1), 11.0 (< 11.0.4-h1), 11.1 (< 11.1.2-h3)

**利用条件:** 需要目标设备配置了GlobalProtect网关或GlobalProtect Portal，并且漏洞版本在影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞，未经身份验证的攻击者可以在具有 root 权限的防火墙上执行任意代码。

**有效性评估：**

提供的 Python POC 代码 `/tmp/0de44055d5df69da649501894bfd0c34/CVE-2024-3400_upload_check.py` 尝试通过在 `/var/appweb/sslvpndocs/global-protect/portal/images/` 目录下上传一个随机命名的 `.txt` 文件来验证漏洞的存在。该脚本首先检查目标是否存在，然后尝试上传文件，并通过检查文件是否存在来验证上传是否成功。搜索引擎结果和漏洞库信息表明该漏洞确实存在，并且有公开可用的 PoC。

**投毒风险评估：**

分析提供的代码后，投毒风险较低。该脚本主要用于验证目标是否存在漏洞，而不是执行恶意操作。唯一可能需要注意的是，该脚本会在目标文件系统上创建一个测试文件，但脚本本身提供了删除该文件的说明。

*   代码逻辑较为简单，主要功能是上传和检查文件，没有发现明显的恶意行为。
*   脚本需要用户手动输入目标 URL，降低了大规模自动化攻击的风险。
*   脚本的目的是验证漏洞存在，而不是利用漏洞执行恶意操作。
*  存在非常低的风险：脚本在成功上传后，提示用户手动删除上传的文件。如果攻击者利用此脚本，但没有清除测试文件，可能会留下痕迹，但这不是恶意投毒，而是利用不当的副作用。

综合考虑，该 POC 代码的投毒风险约为 5%。

**利用方式：**

1.  **漏洞原理：** 该漏洞是由于 PAN-OS GlobalProtect 在处理特定请求时，允许攻击者创建任意文件，进而导致命令注入。具体来说，攻击者可以通过构造包含恶意代码的文件名，并利用 GlobalProtect 的文件处理逻辑来执行系统命令。
2.  **利用步骤：**
    *   攻击者首先需要确定目标 PAN-OS 设备是否配置了 GlobalProtect 并且版本在受影响范围内。
    *   攻击者构造一个包含恶意代码的文件名，例如 `test.txt; <command>`，其中 `<command>` 是要执行的系统命令。
    *   攻击者通过构造特定的 HTTP 请求，将包含恶意代码的文件名传递给 GlobalProtect。
    *   GlobalProtect 在处理该请求时，会尝试创建该文件，由于文件名包含恶意代码，导致系统命令被执行。
3.  **影响：** 成功利用该漏洞后，攻击者可以获得目标设备的 root 权限，从而可以执行任意操作，例如窃取敏感数据、安装后门、篡改系统配置等。

根据漏洞库信息，缓解措施包括升级到修复后的 PAN-OS 版本，或使用威胁防御签名来阻止攻击。

**项目地址:** [codeblueprint/CVE-2024-3400](https://github.com/codeblueprint/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #18

**来源**: [CVE-2024-3400-hahasagined_CVE-2024-3400.md](../2024/CVE-2024-3400-hahasagined_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect Command Injection

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未经身份验证的攻击者可以在防火墙上以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2 (< 10.2.9-h1), 11.0 (< 11.0.4-h1), and 11.1 (< 11.1.2-h3)

**利用条件:** 需要目标PAN-OS设备配置了GlobalProtect网关或GlobalProtect门户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞的存在，未经身份验证的攻击者可以在特定 PAN-OS 版本和配置下，利用此漏洞以 root 权限在防火墙上执行任意代码。

**有效性：**
根据漏洞信息，已经存在公开可用的POC代码，并且该漏洞已被积极利用。搜索结果也表明了这一点，多个安全厂商和研究人员已经发布了关于该漏洞的分析和利用信息，例如Unit 42、Volexity、Zscaler和CrowdStrike。

**投毒风险：**
提供的“漏洞利用代码”实际上是一个IP地址列表（EDL）。虽然看似无害，但如果攻击者将恶意命令注入过程与此列表结合使用，则该列表可以作为攻击基础设施的一部分。此列表本身不包含任何恶意代码，因此直接的“投毒风险”为0%。但是，它可能会被用于后续的攻击活动中，例如建立C&C通信。

**利用方式：**
1.  **任意文件创建：** 攻击者利用 GlobalProtect 功能中存在的漏洞，在目标系统上创建任意文件。
2.  **命令注入：** 攻击者通过构造恶意请求，将恶意命令注入到服务器的操作系统中。
3.  **代码执行：** 注入的命令以 root 权限执行，允许攻击者完全控制受影响的防火墙。例如安装后门。

根据漏洞库信息和搜索结果，成功利用此漏洞需要满足以下条件：
*   目标设备必须运行受影响的 PAN-OS 版本（10.2、11.0 或 11.1）。
*   设备必须配置了 GlobalProtect 网关或 GlobalProtect 门户。

漏洞利用通常涉及发送特制的 HTTP 请求，利用URL中的参数进行命令注入，从而在目标系统上执行任意代码。

**项目地址:** [hahasagined/CVE-2024-3400](https://github.com/hahasagined/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #19

**来源**: [CVE-2024-3400-hashdr1ft_SOC274-Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400.md](../2024/CVE-2024-3400-hashdr1ft_SOC274-Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400.md)

## CVE-2024-3400 - Palo Alto Networks PAN-OS GlobalProtect Command Injection

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (<10.2.9-h1), 11.0 (<11.0.4-h1), 11.1 (<11.1.2-h3)，并配置了GlobalProtect网关或门户

**利用条件:** 需要目标系统运行受影响的PAN-OS版本，并启用了GlobalProtect网关或门户功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞。由于任意文件创建漏洞导致，未经身份验证的远程攻击者可以通过在受影响的设备上创建恶意文件，执行任意代码，从而获得root权限。漏洞影响配置了GlobalProtect网关或门户的PAN-OS 10.2、11.0和11.1的特定版本。根据提供的漏洞利用代码, 可以看到一个SOC分析师利用自动化工具对告警进行分析, 通过分析攻击流量, 恶意IP以及最终日志响应码来判断漏洞是否被利用. 漏洞利用代码分析主要是记录SOC分析过程, 本身没有提供exp代码。投毒风险分析：漏洞利用代码本身是SOC分析过程记录，而非漏洞利用的EXP，本身不具备漏洞利用能力。其中的图片引用可能存在钓鱼风险，例如替换为恶意链接等， 风险较低，因此投毒风险评定为10%。漏洞利用方式：攻击者发送特制的HTTP请求到GlobalProtect的登录页面`/global-protect/login.esp`，利用任意文件创建漏洞，写入包含恶意命令的文件。由于命令注入漏洞的存在，写入的文件中的命令将以root权限执行。根据搜索结果, 此漏洞已经被大规模利用, 并且已经有公开的POC.

**项目地址:** [hashdr1ft/SOC274-Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400](https://github.com/hashdr1ft/SOC274-Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #20

**来源**: [CVE-2024-3400-ihebski_CVE-2024-3400.md](../2024/CVE-2024-3400-ihebski_CVE-2024-3400.md)

## CVE-2024-3400 - Palo Alto Networks PAN-OS GlobalProtect Command Injection

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** Palo Alto Networks PAN-OS (GlobalProtect)

**危害等级:** 高危，未授权的远程代码执行，可获取 root 权限

**影响版本:** PAN-OS 10.2 < 10.2.9-h1, 11.0 < 11.0.4-h1, 11.1 < 11.1.2-h3

**利用条件:** 需要配置 GlobalProtect 网关或门户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞。未经身份验证的攻击者可以通过精心构造的请求，在受影响的设备上以 root 权限执行任意代码。漏洞利用涉及任意文件创建，进而导致命令注入。根据漏洞库信息，存在野外利用，CISA KEV 也收录了该漏洞。

**有效性：** 根据提供的漏洞利用代码和搜索引擎结果，该 POC 代码是有效的。POC 通过构造包含路径遍历的 Cookie，在指定位置创建文件，验证是否存在漏洞。更进一步的RCE利用需要启用Telemetry。

**投毒风险：** 漏洞利用代码主要由一个 YAML 文件 (NUCLEI 模板) 和 README 文件组成。YAML 文件定义了漏洞验证的 HTTP 请求，README 描述了漏洞和利用方法。license文件是MIT开源协议。风险在于，如果攻击者修改 YAML 文件，例如在 POST 请求中添加额外的恶意载荷，就可能存在投毒风险。该仓库本身相对简单，投毒点在于利用方式的描述和 YAML 文件内容，但整体风险较低，预计约为 10%。由于要依赖于 Telemetry 开启才能进一步的RCE利用，所以投毒的价值不大，

**利用方式：**
1.  发送一个包含特殊构造的 `SESSID` Cookie 的 POST 请求到 `/ssl-vpn/hipreport.esp`。Cookie 中的路径遍历用于指定文件创建的位置。
2.  如果存在漏洞，服务器会根据Cookie中的文件名创建文件.
3. 验证思路：尝试访问创建的文件。如果返回 403 状态码（禁止访问），则表示目标存在漏洞，且文件创建成功(文件创建的权限是root权限)。
4. 进一步的RCE,通过Telemetry日志分析与控制，发送含有命令的Cookie进行RCE攻击

**项目地址:** [ihebski/CVE-2024-3400](https://github.com/ihebski/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #21

**来源**: [CVE-2024-3400-iwallarm_cve-2024-3400.md](../2024/CVE-2024-3400-iwallarm_cve-2024-3400.md)

## CVE-2024-3400-PAN-OS-命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未授权的攻击者可以以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (低于10.2.9-h1), 11.0 (低于11.0.4-h1), 11.1 (低于11.1.2-h3)

**利用条件:** 需要配置GlobalProtect网关或GlobalProtect门户的PAN-OS防火墙。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞，由于任意文件创建导致。未经身份验证的攻击者可以利用此漏洞在防火墙上以root权限执行任意代码。漏洞影响配置了GlobalProtect网关或门户的特定PAN-OS版本。从提供的漏洞利用代码来看，它似乎包含一个域名 `cve-2024-3400.org` 和一个 `test` 文件. 利用方式可能涉及在目标系统上创建包含恶意命令的文件，然后通过命令注入执行。关于投毒风险，该POC代码本身较为简洁，主要目的是验证漏洞的存在。但是攻击者可以利用此漏洞植入恶意后门，因此存在一定的投毒风险，可能性评估为10%。根据搜索结果，该漏洞已被广泛利用，CISA也将其列入已知被利用的漏洞目录。

**项目地址:** [iwallarm/cve-2024-3400](https://github.com/iwallarm/cve-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #22

**来源**: [CVE-2024-3400-marconesler_CVE-2024-3400.md](../2024/CVE-2024-3400-marconesler_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 任意文件创建导致命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (低于 10.2.9-h1), 11.0 (低于 11.0.4-h1), 和 11.1 (低于 11.1.2-h3)，且配置了GlobalProtect网关或门户

**利用条件:** 需要目标系统配置了GlobalProtect网关或门户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞，源于任意文件创建。未经身份验证的远程攻击者可以利用此漏洞在受影响的设备上以 root 权限执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以得出结论：该漏洞的PoC代码有效。

*   漏洞库信息显示，Palo Alto Networks 已经意识到有越来越多的攻击利用此漏洞，并且第三方已经公开了PoC。
*   搜索结果中也包含了多个关于CVE-2024-3400的分析文章，以及检测被入侵设备的方法，进一步证实了该漏洞的真实性和可利用性。
*   提供的PoC代码 `cve-2024-3400.py` 实现了利用该漏洞执行命令的功能，包括获取配置文件和执行反弹shell。

**投毒风险分析：**

PoC代码本身相对简单，主要通过构造恶意的SESSID cookie来触发漏洞。投毒风险较低。主要风险点在于：

*   **README.md中的免责声明：** README.md提到“the firewall must be running a vulnerable PAN-OS version and must have telemetry enabled.”,如果使用者忽略此项说明，在非漏洞环境中使用，可能会导致一些非预期行为。 即使此项说明，使用者也有可能没意识到打开telemetry可能带来的风险. *   **Connect-back shell风险：** PoC代码中包含反弹shell的功能，如果攻击者修改反弹shell的IP地址和端口，可以连接到受害者的设备。

**漏洞利用方式：**

1.  **漏洞原理：** 漏洞利用了GlobalProtect功能中对用户输入验证不严格的问题，允许攻击者通过构造恶意的SESSID cookie来创建任意文件，并在创建文件的过程中执行命令注入。
2.  **攻击步骤：**
    *   攻击者构造包含恶意命令的SESSID cookie。
    *   攻击者向目标设备的GlobalProtect登录页面发送请求，并在请求中包含构造的SESSID cookie。
    *   目标设备在处理SESSID cookie时，由于验证不严格，会将cookie中的恶意命令注入到系统中执行。
3.  **PoC代码分析：**
    *   `cve-2024-3400.py` 脚本接受目标主机、攻击类型和反弹shell地址作为参数。
    *   脚本根据攻击类型选择不同的命令。
        *   `getconf`: 复制 `running-config.xml` 到 web 目录，攻击者可以下载配置文件。
        *   `getpanoramaconf`: 复制 `merged-running-config.xml` 到 web 目录，攻击者可以下载panorama合并的配置文件。
        *   `remoteshell`: 启动反弹shell，连接到攻击者指定的IP地址和端口。
    *   脚本将命令进行base64编码，并将其嵌入到SESSID cookie中。
    *   脚本向目标设备发送包含恶意cookie的GET请求。

**总结：**

CVE-2024-3400是一个高危漏洞，利用简单，影响广泛。建议受影响的用户尽快升级到安全版本。

**项目地址:** [marconesler/CVE-2024-3400](https://github.com/marconesler/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #23

**来源**: [CVE-2024-3400-nanwinata_CVE-2024-3400.md](../2024/CVE-2024-3400-nanwinata_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 （未升级到指定hotfix版本）

**利用条件:** 需要目标系统配置了GlobalProtect gateway 或 GlobalProtect portal

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于PAN-OS GlobalProtect功能中存在任意文件创建导致的命令注入漏洞。未经验证的攻击者可以通过向目标服务器发送特制的请求，在目标服务器上创建恶意文件，进而执行任意系统命令，最终获得root权限。漏洞利用代码通过修改Cookie中的`SESSID`参数，指向一个包含命令注入的路径，然后发送POST请求到`/ssl-vpn/hipreport.esp`来触发该漏洞。httpx用于快速扫描目标域名下的活跃主机及端口，Subfinder用于子域名枚举。

**有效性评估：**
根据漏洞信息和漏洞利用代码，该PoC代码是有效的。漏洞库信息明确指出存在公开的PoC，并且漏洞被大规模利用。搜索结果中也包含大量关于该漏洞的分析和利用信息。该PoC代码通过构造恶意的Cookie，利用了任意文件创建的漏洞，实现了命令注入。

**投毒风险分析：**
PoC代码本身的功能是验证漏洞是否存在。代码主要包含以下功能：
1.  **子域名枚举:**  使用`subfinder`工具枚举目标域名的子域名，这本身没有投毒风险，但如果`subfinder`本身被替换成恶意版本，则存在风险。
2.  **活跃主机扫描:** 使用`httpx`工具扫描活跃主机，同样，需要保证`httpx`工具本身的安全性。
3.  **漏洞验证:** 通过构造特殊的Cookie和URI，发送POST请求来验证目标是否存在漏洞。这个过程本身是漏洞利用的一部分，**不是投毒代码**。
4. **临时文件处理**: 代码中会创建和删除临时文件(`temp_domains.txt`)，如果存在恶意修改，可能导致拒绝服务或信息泄露，但可能性较低。

**潜在投毒点分析：**
*   **依赖外部工具:** PoC依赖`subfinder`和`httpx`这两个外部工具。如果这两个工具被恶意版本替换，则存在投毒风险。例如，恶意版本的`subfinder`可能返回错误的子域名，或者`httpx`被修改为执行恶意代码。这种风险的评估概率是10%。

**利用方式：**
1.  **子域名枚举 (可选):** 使用`subfinder`等工具枚举目标域名的子域名。如果已知目标IP地址，则可以跳过此步骤。
2.  **活跃主机扫描:** 使用`httpx`等工具扫描目标子域名的80,443,4443,8443端口，确定哪些主机是活跃的。
3.  **漏洞验证:** 对活跃的主机，构造包含恶意代码的Cookie，发送POST请求到`/ssl-vpn/hipreport.esp`，验证漏洞是否存在。Cookie包含的文件路径指向可以执行命令的位置，从而实现命令注入。
4.  **命令执行:** 成功利用漏洞后，攻击者可以在目标系统上执行任意命令，从而控制系统。

**项目地址:** [nanwinata/CVE-2024-3400](https://github.com/nanwinata/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #24

**来源**: [CVE-2024-3400-pwnj0hn_CVE-2024-3400.md](../2024/CVE-2024-3400-pwnj0hn_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码。

**影响版本:** PAN-OS 10.2 (低于10.2.9-h1), PAN-OS 11.0 (低于11.0.4-h1), PAN-OS 11.1 (低于11.1.2-h3)

**利用条件:** 需要目标设备配置了GlobalProtect网关或门户，且攻击者可以访问GlobalProtect服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建导致了命令注入。未经身份验证的远程攻击者可以通过利用此漏洞，以 root 权限在防火墙上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。漏洞库信息明确指出存在利用此漏洞的攻击，并且公开了PoC。提供的代码尝试创建一个文件，然后检查文件是否成功创建，以确认漏洞是否存在。搜索结果中也提到了该漏洞正在被积极利用。

**投毒风险：**
该PoC代码主要功能是检测目标是否存在漏洞，通过构造特殊的Cookie，尝试在目标服务器上创建文件。代码本身相对简单，主要使用了`requests`库发送HTTP请求，未发现明显的恶意行为。主要风险可能在于：
1.  **误报风险：**  PoC可能因为网络环境或其他因素导致误报。
2.  **资源消耗：**  如果大规模扫描，可能会对目标设备造成一定的资源消耗。
3.  **依赖风险：**  依赖requests库，如果该库被篡改，可能存在风险。

该PoC本身进行恶意操作的可能性很低，因此投毒风险较低，大约为 5%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含特殊路径的Cookie，发送到受影响的PAN-OS设备的GlobalProtect服务。
2.  **任意文件创建：** 恶意Cookie中的路径被用于创建任意文件。
3.  **命令注入：** 由于文件创建过程中的不当处理，攻击者可以在文件名中注入操作系统命令。
4.  **代码执行：** 操作系统命令以root权限执行，从而允许攻击者完全控制受影响的设备。

简单来说，利用方式就是通过发送特制的HTTP请求，在目标设备上创建任意文件，进而执行任意命令。

**项目地址:** [pwnj0hn/CVE-2024-3400](https://github.com/pwnj0hn/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #25

**来源**: [CVE-2024-3400-retkoussa_CVE-2024-3400.md](../2024/CVE-2024-3400-retkoussa_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以利用此漏洞在防火墙上以 root 权限执行任意代码。

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标PAN-OS设备配置了 GlobalProtect gateway 或 GlobalProtect portal (或两者)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 中的一个命令注入漏洞。由于任意文件创建漏洞，未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上执行任意代码，获得 root 权限。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞是真实存在的，并且已经被野外利用。提供的 PoC 代码旨在验证漏洞的存在。该PoC通过构造包含恶意路径的 SESSID Cookie，结合`/ssl-vpn/hipreport.esp`接口，尝试在`/var/appweb/sslvpndocs/global-protect/portal/images/`目录下创建一个名为`poc.txt`的文件。创建成功后，尝试通过`/global-protect/portal/images/poc.txt`访问该文件。如果返回 HTTP 403 状态码，则表示文件已成功上传，验证了漏洞的存在。由于脚本自动尝试HTTPS，且可以上传文件，初步判断提供的PoC代码是有效的。

**投毒风险分析：**

查看提供的PoC脚本，脚本主要功能是发送两个 HTTP 请求来验证漏洞的存在。第一个 POST 请求设置了一个包含目录遍历的 Cookie，目的是在特定目录下创建文件。第二个 GET 请求检查文件是否成功创建。脚本没有明显的恶意行为，例如植入后门或收集信息。尽管如此，仍然存在一定的投毒风险，例如：

*   **依赖项风险：** 脚本使用了 `requests` 库，如果该库被恶意篡改，可能导致安全问题。
*   **代码执行风险：** 虽然脚本本身看起来无害，但攻击者可能修改脚本，例如添加反向 shell 或其他恶意功能。考虑到代码简洁，功能单一，判定脚本投毒可能性为10%。

**利用方式总结：**

1.  **漏洞触发：** 攻击者发送特制的 HTTP 请求到受影响的 PAN-OS 设备的 GlobalProtect 接口。该请求包含恶意的 SESSID Cookie，利用目录遍历和任意文件创建漏洞。
2.  **命令注入：** 通过创建的文件执行操作系统命令。
3.  **权限提升：** 由于 GlobalProtect 组件以 root 权限运行，攻击者可以获得 root 权限。
4.  **最终影响：** 攻击者可以完全控制受影响的防火墙，包括读取敏感信息、修改配置、安装恶意软件等。

**缓解措施：**

*   立即升级到已修复的 PAN-OS 版本。
*   应用威胁防御签名 (Threat IDs 95187, 95189, and 95191)。
*   将漏洞保护应用于 GlobalProtect 接口。

**项目地址:** [retkoussa/CVE-2024-3400](https://github.com/retkoussa/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #26

**来源**: [CVE-2024-3400-schooldropout1337_CVE-2024-3400.md](../2024/CVE-2024-3400-schooldropout1337_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统配置了GlobalProtect gateway或GlobalProtect portal，且运行受影响的PAN-OS版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞。该漏洞源于任意文件创建，允许未经身份验证的远程攻击者在防火墙上以root权限执行任意代码。

**有效性分析：**

*   漏洞库信息明确指出该漏洞影响特定版本的PAN-OS，并且Palo Alto Networks已经意识到有越来越多的攻击利用此漏洞。同时，第三方已经公开了PoC。
*   搜索引擎结果也显示，该漏洞已被广泛关注，并有相关的威胁情报和检测方法发布。
*   提供的PoC代码包含一个Bash脚本和一个Nuclei模板，可以用于验证漏洞的存在。

**利用方式：**

1.  **0-Byte File Creation (CVE-2024-3400.sh):**
    *   攻击者使用`curl`命令向目标服务器的`/ssl-vpn/hipreport.esp`发送一个POST请求，并在Cookie中设置`SESSID`为恶意路径，尝试在`/var/appweb/sslvpndocs/global-protect/portal/images/`目录下创建一个0字节的`CVE20243400.txt`文件。
    *   脚本验证文件是否成功创建，如果服务器返回200 OK，则认为创建成功。
    *   然后，脚本尝试访问创建的文件，如果服务器返回403 Forbidden，则表明目标服务器存在漏洞。

2.  **OS Command Injection (CVE20243400.yaml):**
    *   该Nuclei模板使用多个POST请求，在Cookie中设置恶意的`SESSID`值，目标路径为`/../../../opt/panlogs/tmp/device_telemetry/minute/`，通过命令注入执行`curl`命令，将目标系统的`uname`或`hostname`信息发送到攻击者的`interactsh`服务器，从而验证是否存在命令注入漏洞。

**投毒风险分析：**

虽然提供的代码主要目的是为了验证漏洞，但仍然存在轻微的投毒风险：

*   **依赖外部资源:** Nuclei模板依赖于攻击者控制的`interactsh`服务器。如果攻击者恶意地将`interactsh`配置为执行某些恶意操作（比如记录受害者的IP地址并进行后续攻击），则可能存在风险。此风险评估为10%。
*   **脚本下载:**  虽然本分析直接提供了漏洞利用脚本内容，但在实际情况中，攻击者可能提供脚本下载链接，如果脚本被篡改，则可能存在风险。

**总结：**

提供的PoC代码是有效的，可以用于验证CVE-2024-3400漏洞。利用方式主要是通过构造恶意的HTTP请求，利用任意文件创建漏洞实现命令注入，从而在目标系统上执行任意代码。 尽管代码本身主要是漏洞验证，但是仍然存在一些投毒风险，需要谨慎使用。

**项目地址:** [schooldropout1337/CVE-2024-3400](https://github.com/schooldropout1337/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #27

**来源**: [CVE-2024-3400-swaybs_CVE-2024-3400.md](../2024/CVE-2024-3400-swaybs_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (小于10.2.9-h1), 11.0 (小于11.0.4-h1), 11.1 (小于11.1.2-h3)

**利用条件:** 需要目标设备配置了GlobalProtect网关或Portal,并且能通过网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞，源于任意文件创建。攻击者可以利用此漏洞，在未经身份验证的情况下，以root权限在防火墙上执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，此漏洞已经被积极利用，并且有公开的PoC。提供的Python脚本旨在检查防火墙上是否存在漏洞利用的痕迹，而不是直接利用该漏洞。脚本通过Netmiko库连接到防火墙，并执行特定的命令，从而检测是否存在与漏洞相关的日志记录。

**投毒风险：**
提供的代码仓库主要包含一个用于检测漏洞的Python脚本。该脚本使用`netmiko`连接到Palo Alto防火墙，并执行`grep`命令来检查特定的日志模式。其中，`firewall_hosts`、`firewall_username`、`firewall_password`和`command_to_run`都需要用户自行配置。由于脚本的目的是检查漏洞利用痕迹，而不是直接进行漏洞利用，因此投毒风险较低。但用户在使用脚本时，仍需注意脚本的来源和完整性，避免引入恶意代码。

**利用方式：**
根据漏洞库信息和搜索结果，攻击者利用此漏洞的方式可能包括：
1.  利用未授权的任意文件创建漏洞，在目标系统上创建恶意文件。
2.  通过构造特定的请求，触发命令注入，执行任意系统命令。
3.  通过GlobalProtect组件，利用命令注入漏洞，获取root权限。

该漏洞的利用需要特定的PAN-OS版本，以及GlobalProtect网关或Portal的配置。缓解措施包括升级到修复后的PAN-OS版本，或者使用威胁防御签名进行阻止。

**项目地址:** [swaybs/CVE-2024-3400](https://github.com/swaybs/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #28

**来源**: [CVE-2024-3400-sxyrxyy_CVE-2024-3400-Check.md](../2024/CVE-2024-3400-sxyrxyy_CVE-2024-3400-Check.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，允许未经验证的攻击者以 root 权限在防火墙上执行任意代码

**影响版本:** PAN-OS 10.2.0 <= version < 10.2.9-h1, PAN-OS 11.0.0 <= version < 11.0.4-h1, PAN-OS 11.1.0 <= version < 11.1.2-h3

**利用条件:** 需要目标系统配置了 GlobalProtect 网关或门户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞的存在，未经身份验证的攻击者可以通过利用此漏洞在防火墙上以 root 权限执行任意代码。漏洞存在于 PAN-OS 10.2、PAN-OS 11.0 和 PAN-OS 11.1 版本，且必须配置 GlobalProtect 网关或门户。\n\n**漏洞利用方式：**\n1.  攻击者向`/ssl-vpn/hipreport.esp` endpoint 发送 POST 请求。\n2.  POST 请求中包含特制的 Cookie，其中 SESSID 参数被设置为指向恶意文件路径`/../../../var/appweb/sslvpndocs/global-protect/portal/images/sxy.txt`。\n3.  攻击者随后向`/global-protect/portal/images/sxy.txt` 发送 GET 请求，如果服务器返回 403 错误，则表明漏洞存在，且攻击者可以通过构造恶意请求执行任意代码。\n\n**POC代码有效性：**提供的POC代码旨在检测目标是否存在漏洞，通过发送特定的POST和GET请求，验证是否能够访问通常被禁止访问的文件。如果GET请求返回403状态码，则表明目标可能存在漏洞。\n\n**投毒风险分析：**\nPOC代码中存在潜在的投毒风险，主要体现在注释掉的 interactsh 相关代码部分。这段代码的目的是使用 `curl` 命令将目标系统的 `whoami` 命令的输出发送到攻击者的 interactsh 服务器。虽然这段代码当前是被注释掉的，但如果攻击者修改代码，取消注释，并运行，则可能存在以下风险：\n*   **信息泄露:** 将 `whoami` 命令的输出发送到外部服务器可能泄露目标系统的用户名信息。\n*   **命令执行:** 通过 interactsh 反连，可能执行更复杂的恶意命令。\n\n因此，尽管当前代码是检测漏洞，但潜在的风险仍然存在，尤其是对于不熟悉代码的用户，可能在不知情的情况下运行包含恶意代码的变体。所以，我将投毒风险评定为 10%。
此外，代码会尝试获取目标的 SSL 证书信息，这本身不是恶意行为，但可能被攻击者用于指纹识别和进一步攻击。

**缓解措施：**\n*   立即升级到已修复的 PAN-OS 版本，如 PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3 或更高版本。\n*   应用威胁防御签名（Threat IDs 95187, 95189, 和 95191）。\n*   确保 GlobalProtect 接口已应用漏洞保护。

**项目地址:** [sxyrxyy/CVE-2024-3400-Check](https://github.com/sxyrxyy/CVE-2024-3400-Check)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #29

**来源**: [CVE-2024-3400-terminalJunki3_CVE-2024-3400-Checker.md](../2024/CVE-2024-3400-terminalJunki3_CVE-2024-3400-Checker.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未授权攻击者可利用此漏洞以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统需启用 GlobalProtect 网关或门户，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞，源于任意文件创建。未经身份验证的远程攻击者可以通过构造特定的请求，利用此漏洞在受影响的防火墙上以 root 权限执行任意代码。漏洞影响启用了 GlobalProtect 网关或门户的 PAN-OS 10.2、11.0 和 11.1 的特定版本。\n\n**有效性：**\n根据漏洞库信息和搜索结果，CVE-2024-3400 漏洞已被积极利用，并且存在公开可用的PoC。提供的 Python 脚本旨在检查 Palo Alto Networks 设备的 tech support 文件中是否存在 CVE-2024-3400 攻击的迹象，它本身并非利用代码，而是用于检测受害者是否已经被攻击。所以此POC代码不直接体现漏洞的利用,而是在侧面验证漏洞是否被利用,存在一定的有效性。\n\n**投毒风险：**\n提供的Python脚本用于分析日志文件，搜索恶意行为的迹象。该脚本主要功能是解压和搜索指定的日志文件（'md_out.log', 'md_out.log.old', 'gpsvc.log'）中是否存在特定的恶意关键词（'wget', 'bash', 'device_telemetry/minute/', 'unmarshal'）。\n\n*   **投毒点分析：**
    * 脚本本身不包含直接的恶意代码或后门，其主要功能是文件解压和字符串搜索，风险较低。
    *  **误报风险:**  脚本依赖于预定义的`search_terms`列表，如果该列表被篡改，例如添加了常见的正常字符串，可能导致大量的误报，降低脚本的可用性。
    * **依赖库风险:** 脚本依赖于Python的`gzip`和`tarfile`库，如果这些库本身存在漏洞，可能被利用。但这是所有Python脚本的通用风险。
    * **文件路径风险:** 脚本需要用户指定`filepath`变量，如果用户指定了错误的或恶意的`.tar.gz`文件，可能导致脚本分析错误的文件，并给出错误的结论。
    * **代码缺陷:** return使用不当,会导致未能完全检查文件。\n\n总的来说，该脚本的投毒风险较低，主要的风险在于被篡改的`search_terms`列表可能导致误报。因此，投毒风险评估为10%。\n\n**利用方式：**\n根据漏洞描述和搜索结果，攻击者利用 CVE-2024-3400 的方式如下：\n1.  **构造恶意请求：**  攻击者构造包含恶意命令的特定请求，发送到启用了 GlobalProtect 的 PAN-OS 设备。\n2.  **利用任意文件创建漏洞：**  该请求触发了 PAN-OS 中的任意文件创建漏洞，允许攻击者在系统上创建恶意文件。\n3.  **命令注入：**  创建的恶意文件被执行，从而实现命令注入，允许攻击者以 root 权限执行任意代码。\n4.  **完全控制：**  成功利用该漏洞后，攻击者可以完全控制受影响的防火墙设备。

**项目地址:** [terminalJunki3/CVE-2024-3400-Checker](https://github.com/terminalJunki3/CVE-2024-3400-Checker)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #30

**来源**: [CVE-2024-3400-tfrederick74656_cve-2024-3400-poc.md](../2024/CVE-2024-3400-tfrederick74656_cve-2024-3400-poc.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，允许未授权的攻击者以root权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3， 并且配置了GlobalProtect网关或门户

**利用条件:** 目标系统需要配置GlobalProtect网关或门户，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞，由于任意文件创建导致。根据Volexity的分析和 Palo Alto Networks 的公告，该漏洞允许未经身份验证的攻击者在防火墙上以 root 权限执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是有效的，并且已经被积极利用。CISA已经将其添加到已知被利用漏洞的目录中。提供的PoC代码通过构造包含目录遍历的 Cookie，尝试访问`/var/appweb/sslvpndocs/global-protect/portal/images/watchtowr.txt`，从而验证漏洞的存在。

**投毒风险：**
此PoC代码本身相对简单，主要用于验证漏洞是否存在。投毒风险较低，估计在10%左右。尽管如此，任何从非官方来源下载的代码都存在潜在风险。用户应仔细审查代码，理解其功能，并在隔离环境中运行。潜在的投毒方式可能包括：

*   **恶意URL重定向：** PoC 中使用的 URL 可能会被更改为指向恶意站点，诱骗用户下载其他恶意软件。
*   **命令注入修改：** 攻击者可能修改 PoC 代码，添加额外的命令注入 payload，在测试时执行恶意操作。

**利用方式：**
1.  **漏洞触发：** 通过构造包含目录遍历的 `SESSID` Cookie，发送到 `/ssl-vpn/hipreport.esp` 路径。
2.  **任意文件创建：** 成功利用后，攻击者可以创建任意文件。
3.  **命令注入：** 利用任意文件创建漏洞，执行任意操作系统命令，最终获得 root 权限。

总体而言，该漏洞影响严重，利用方式简单，已经出现公开的PoC，建议尽快修复。

**项目地址:** [tfrederick74656/cve-2024-3400-poc](https://github.com/tfrederick74656/cve-2024-3400-poc)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #31

**来源**: [CVE-2024-3400-tk-sawada_IPLineFinder.md](../2024/CVE-2024-3400-tk-sawada_IPLineFinder.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统配置了 GlobalProtect gateway 或 GlobalProtect portal, 且为受影响的 PAN-OS 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞，由于任意文件创建漏洞导致。攻击者可以通过 GlobalProtect 服务，利用此漏洞在防火墙上以 root 权限执行任意代码，无需身份验证。

**漏洞利用方式：**

1.  攻击者利用 GlobalProtect 的未授权访问点，通过构造特定的请求，触发任意文件创建漏洞。
2.  利用任意文件创建漏洞，写入包含恶意命令的文件。
3.  通过命令注入，执行恶意代码，从而控制防火墙。

**提供的漏洞利用代码分析：**

提供的代码 `IPLineFinder.py` **不是直接的漏洞利用代码**。它是一个 Python 脚本，用于在日志文件中查找包含特定 IP 地址的行，并将这些行提取到新的文件中。此脚本的设计目的是用于取证分析，以确定受 CVE-2024-3400 影响的系统是否已被入侵，通过搜索已知的恶意 IP 地址来判断。

**关于投毒风险的分析：**

*   `IPLineFinder.py` 本身：脚本逻辑相对简单，主要功能是搜索和提取日志行。直接的恶意代码注入风险较低。但如果攻击者替换或修改了`ip_addresses` 列表，添加了用于混淆或误导分析的IP地址，则存在投毒风险，使分析人员无法准确识别攻击源头或关联恶意活动。

*   依赖性：该脚本依赖于 Python 标准库 `os`。 虽然标准库的风险较低，但如果脚本在受损环境中执行，则存在被篡改的风险。

*   整体风险评估：考虑到脚本的功能和依赖性，以及攻击者可能的操作，估计投毒风险为 10%。这主要是指攻击者可能篡改 IP 地址列表，来混淆视听。

**搜索引擎结果佐证：**

搜索结果表明，CVE-2024-3400 是一个已在野外被利用的零日漏洞，且存在公开的 POC。Volexity 等安全公司发布了关于如何检测 compromised 设备的报告。CrowdStrike 和 Zscaler 也发布了相关的分析报告。

综上所述，CVE-2024-3400 是一个高危漏洞，可以被远程利用，需要及时修复。提供的脚本 `IPLineFinder.py` 本身不是漏洞利用代码，而是用于入侵检测和取证分析的工具，但存在被投毒的潜在风险，尽管风险较低。

**项目地址:** [tk-sawada/IPLineFinder](https://github.com/tk-sawada/IPLineFinder)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #32

**来源**: [CVE-2024-3400-workshop748_CVE-2024-3400.md](../2024/CVE-2024-3400-workshop748_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，可导致远程代码执行，获取Root权限

**影响版本:** PAN-OS 10.2, 11.0, and 11.1 (特定版本，见漏洞库信息)

**利用条件:** 需要配置GlobalProtect网关或门户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS GlobalProtect功能中的一个命令注入漏洞。攻击者通过在GlobalProtect的特定配置中利用任意文件创建漏洞，可以执行任意代码并获得防火墙上的root权限。该漏洞影响配置了GlobalProtect网关或门户的PAN-OS 10.2、11.0和11.1的特定版本。根据漏洞库信息，受影响的版本包括低于PAN-OS 10.2.9-h1的10.2.x版本，低于PAN-OS 11.0.4-h1的11.0.x版本，以及低于PAN-OS 11.1.2-h3的11.1.x版本。搜索引擎结果显示，该漏洞已被积极利用，且存在公开的PoC代码。提供的漏洞利用代码是Cargo.lock文件，用于Rust项目的依赖管理。虽然该文件本身不包含恶意代码，但由于该项目可能用于漏洞利用，存在作者在其他地方（例如在实际的Rust源代码中，未提供）加入恶意投毒代码的理论风险，但由于Cargo.lock只是锁定版本，直接投毒难度较大，风险较低。漏洞利用方式包括：未经身份验证的攻击者利用GlobalProtect中的漏洞创建任意文件，进而执行操作系统命令。从Volexity的博客文章(webpage 3)来看，检测受损的Palo Alto Networks防火墙设备的方法，从Zscaler的博客文章(webpage 4)来看，存在upstyle后门的技术分析。因此，漏洞的有效性较高，投毒风险较低。

**漏洞利用方式:**

1.  **未授权访问:** 利用未授权访问漏洞进入系统。
2.  **文件创建:**  利用GlobalProtect功能中的漏洞创建任意文件。
3.  **命令注入:**  通过文件创建，注入恶意操作系统命令。
4.  **Root权限获取:**  成功利用后，攻击者获得防火墙的Root权限。


**项目地址:** [workshop748/CVE-2024-3400](https://github.com/workshop748/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #33

**来源**: [CVE-2024-3400-zam89_CVE-2024-3400-pot.md](../2024/CVE-2024-3400-zam89_CVE-2024-3400-pot.md)

# CVE-2024-3400

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-3400-0x0d3ad_CVE-2024-3400.md](../2024/CVE-2024-3400-0x0d3ad_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** Palo Alto Networks PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 < 10.2.9-h1, PAN-OS 11.0 < 11.0.4-h1, PAN-OS 11.1 < 11.1.2-h3

**利用条件:** 目标系统配置了GlobalProtect网关或门户，攻击者可以发起网络请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 中的一个命令注入漏洞。该漏洞允许未经身份验证的远程攻击者在受影响的系统上以 root 权限执行任意命令。利用方式是通过向目标服务器的/ssl-vpn/hipreport.esp路径发送特制的HTTP POST请求，并在Cookie头中注入恶意代码。

**有效性分析：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此POC代码是有效的。
  * 漏洞库信息表明该漏洞确实存在，并且有可利用的POC。
  * 搜索结果显示存在大量关于该漏洞的分析和利用的文章。
  * POC代码实现了利用该漏洞执行命令的功能，通过构造包含恶意命令的 Cookie 发送到目标服务器，从而实现远程命令执行。

**投毒风险分析：**
提供的 `exploit.py` 脚本的功能主要是生成并发送包含反弹 shell 命令的 HTTP 请求。代码中没有发现明显的恶意行为或者隐藏的后门代码。脚本的行为是可以预测的，即根据用户输入的 IP 地址和端口，生成反弹 shell 命令，并将其嵌入到 Cookie 中发送给目标服务器。`README.md` 文件也只是描述漏洞信息和使用示例。因此，投毒风险较低，可以判断投毒风险为 0%。

**利用方式分析：**
1.  **漏洞触发点：** GlobalProtect 功能的 `/ssl-vpn/hipreport.esp` 路径。
2.  **攻击向量：** 通过构造恶意的 HTTP Cookie，在 Cookie 中嵌入经过 base64 编码的命令。
3.  **命令注入：**  恶意命令被注入到 Cookie `SESSID` 中，服务器在处理 Cookie 时，未对其中的内容进行充分的验证和过滤，导致命令被执行。
4.  **利用过程：**
    *   攻击者首先需要确定目标系统存在 CVE-2024-3400 漏洞，并且配置了 GlobalProtect 功能。
    *   然后，攻击者运行 `exploit.py` 脚本，输入目标服务器的 IP 地址、攻击者用于接收反弹 shell 的 IP 地址和端口。
    *   脚本会生成一个包含反弹 shell 命令的 HTTP 请求，并将该请求发送到目标服务器的 `/ssl-vpn/hipreport.esp` 路径。
    *   目标服务器在处理该请求时，会执行 Cookie 中的恶意命令，从而建立一个反弹 shell 连接到攻击者的机器上。
    *   攻击者即可通过该反弹 shell 连接控制目标系统。

**项目地址:** [0x0d3ad/CVE-2024-3400](https://github.com/0x0d3ad/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #2

**来源**: [CVE-2024-3400-0xr2r_CVE-2024-3400-Palo-Alto-OS-Command-Injection.md](../2024/CVE-2024-3400-0xr2r_CVE-2024-3400-Palo-Alto-OS-Command-Injection.md)

## CVE-2024-3400 PAN-OS GlobalProtect 任意文件创建导致命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未授权的攻击者可以以root权限执行任意代码

**影响版本:** PAN-OS 10.2（低于10.2.9-h1），PAN-OS 11.0（低于11.0.4-h1），PAN-OS 11.1（低于11.1.2-h3）

**利用条件:** 需要目标系统配置了GlobalProtect网关或GlobalProtect门户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400是一个存在于Palo Alto Networks PAN-OS软件GlobalProtect功能中的任意文件创建导致命令注入漏洞。攻击者可以通过特制的HTTP请求创建任意文件，进而执行任意命令，获得root权限。

**利用方式：**

1.  **漏洞验证：** 首先，攻击者发送一个GET请求到`/global-protect/portal/images/0xr2r.txt`，如果返回404，则表示目标系统不存在此文件，可以继续利用。
2.  **文件创建：** 攻击者发送一个POST请求到`/ssl-vpn/hipreport.esp`，并在Cookie中设置`SESSID`为`/../../../var/appweb/sslvpndocs/global-protect/portal/images/0xr2r.txt`。POST请求的内容可以为空，或者包含一些payload数据，如`user=0xr2r&portal=0xr2r&authcookie=284ad748-7ce2-4753-a39a-aa381b18cf70&domain=0xr2r&computer=0xr2r&client-ip=0xr2r&client-ipv6=0xr2r&md5-sum=0xr2r&gwHipReportCheck=0xr2r`。此操作将在目标系统的指定路径下创建文件`0xr2r.txt`。
3.  **验证文件创建：** 再次发送GET请求到`/global-protect/portal/images/0xr2r.txt`，如果返回403，则表示文件已成功创建。

根据Volexity的分析，该漏洞是由于对`/ssl-vpn/hipreport.esp`的输入验证不足造成的，允许未经身份验证的攻击者创建任意文件。通过创建恶意文件，攻击者可以进一步利用命令注入漏洞执行任意代码。

**有效性：**
提供的POC代码是有效的，它展示了如何利用该漏洞在目标系统上创建任意文件。通过创建文件，可以为进一步的攻击（例如命令注入）奠定基础。

**投毒风险：**
此POC代码中未发现明显的投毒代码。该代码主要展示了如何利用漏洞创建文件。没有发现任何尝试在目标系统上安装后门或执行恶意操作的恶意代码.可以认为投毒风险为0%。但是，应该谨慎对待任何来自不受信任来源的代码，并进行彻底的审查。

**项目地址:** [0xr2r/CVE-2024-3400-Palo-Alto-OS-Command-Injection](https://github.com/0xr2r/CVE-2024-3400-Palo-Alto-OS-Command-Injection)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #3

**来源**: [CVE-2024-3400-AdaniKamal_CVE-2024-3400.md](../2024/CVE-2024-3400-AdaniKamal_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** Palo Alto Networks PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以利用此漏洞以root权限执行任意代码。

**影响版本:** PAN-OS 10.2 (小于 10.2.9-h1), PAN-OS 11.0 (小于 11.0.4-h1), PAN-OS 11.1 (小于 11.1.2-h3)

**利用条件:** 目标系统需要配置GlobalProtect gateway 或 GlobalProtect portal，且是受影响的PAN-OS版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**漏洞评估：**

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 中的一个远程命令执行漏洞。CVSS 评分为 10 分，表明该漏洞非常严重。利用此漏洞，未经身份验证的攻击者可以在受影响的设备上以 root 权限执行任意代码。

**漏洞有效性：**

根据漏洞库信息和搜索结果，CVE-2024-3400 已经被积极利用。漏洞库信息明确指出 Palo Alto Networks 已经意识到越来越多的攻击利用了这个漏洞，并且已经公开了第三方提供的概念验证代码。多个搜索结果也印证了这一点，并提供了关于检测利用尝试和后渗透活动的更多信息。

提供的代码`panos-scanner.py` 是一个版本检测工具，可以帮助确定远程 PAN-OS 目标的软件版本。这个工具本身并不能直接利用该漏洞，但可以用于识别易受攻击的目标。 因此，提供的POC代码不是直接的漏洞利用代码,而只是一个辅助确定目标版本脚本, 需要配合其他的exp利用。

**投毒风险：**

分析 `panos-scanner.py`，此脚本的主要目的是通过发送 HTTP 请求到目标 PAN-OS 设备，并分析返回的 HTTP 头部来确定其版本。脚本中存在以下潜在的投毒风险：

*   **依赖项风险：** 脚本依赖于 `requests` 和 `urllib3` 库。如果这些库被恶意替换，可能导致代码执行或其他恶意行为。
*   **版本表篡改：** 脚本使用 `version-table.txt` 文件来映射日期和 PAN-OS 版本。如果此文件被篡改，可能导致误报或漏报。
*   **请求劫持：** 虽然脚本使用了 `verify=False` 禁用了 SSL 证书验证，但如果攻击者能够劫持网络流量，可以伪造响应，从而欺骗脚本。
*   **参数注入：** 脚本接受命令行参数，例如目标 URL。如果对这些参数没有进行充分的验证，可能会导致命令注入。

考虑到以上因素，以及脚本的主要功能是版本检测，因此，该仓库中存在作者隐藏的投毒代码的可能性较低，估计为 10%。

**利用方式：**

CVE-2024-3400 是一个命令注入漏洞，允许未经身份验证的攻击者在受影响的 PAN-OS 设备上执行任意代码。利用方式通常涉及以下步骤：

1.  **目标识别：** 使用诸如 `panos-scanner.py` 这样的工具或手动分析来识别运行易受攻击的 PAN-OS 版本的设备，并且GlobalProtect 已配置启用。
2.  **漏洞触发：** 向 GlobalProtect 门户或网关发送特制的 HTTP 请求，其中包含恶意命令。由于这是一个任意文件创建导致的命令注入漏洞，攻击者可以通过构造特定的请求，使得 PAN-OS 在文件创建过程中执行恶意命令。
3.  **代码执行：** 成功利用该漏洞后，攻击者可以以 root 权限在防火墙上执行任意代码，例如安装后门、窃取敏感数据或中断服务。

**总结：**

CVE-2024-3400 是一个严重的安全漏洞，需要立即修复。建议受影响的用户尽快升级到 Palo Alto Networks 提供的修复版本。

**项目地址:** [AdaniKamal/CVE-2024-3400](https://github.com/AdaniKamal/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #4

**来源**: [CVE-2024-3400-Chocapikk_CVE-2024-3400.md](../2024/CVE-2024-3400-Chocapikk_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以以root权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标设备配置了GlobalProtect网关或GlobalProtect Portal，且在受影响的PAN-OS版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞，未经身份验证的攻击者可以在启用了 GlobalProtect 的 PAN-OS 防火墙上以 root 权限执行任意代码。

**漏洞利用方式：**

1.  **漏洞点:** 漏洞存在于GlobalProtect组件处理 `hipreport.esp` 请求的过程中。
2.  **攻击方式:** 攻击者通过构造包含目录遍历的恶意`SESSID` cookie发送POST请求到`/ssl-vpn/hipreport.esp` 。目录遍历允许攻击者覆盖或创建Web服务器可访问目录之外的文件。
3.  **命令注入:**  利用目录遍历，攻击者可以在特定位置创建一个文件，其中包含要执行的命令。
4.  **代码执行:** 创建的文件包含的命令会被PAN-OS执行，导致远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果和提供的POC代码，该漏洞是有效的。漏洞库信息明确指出该漏洞已被积极利用，并且存在公开的POC代码。搜索结果也证实了这一点，多个安全厂商发布了关于该漏洞的分析和检测方法。提供的POC代码实现了利用该漏洞进行远程代码执行或漏洞扫描的功能。

**投毒风险分析：**

代码中存在一些潜在的风险，需要进一步人工分析。
1. 脚本依赖于`pwncat-vl`。由于`pwncat`是一个渗透测试工具，引入这个库可能会增加攻击面。检查该库的安全性是必要的。
2.  代码尝试利用socket进行反向shell连接。虽然这是漏洞利用的一部分，但如果脚本被恶意修改，可能会被滥用。
3. 文件名的生成使用uuid，这降低了恶意文件被预测到的可能性，但仍需注意文件创建的位置和内容。

尽管存在上述风险，但从代码的整体结构来看，其主要功能是利用漏洞实现远程代码执行或扫描，没有明显的恶意代码，所以存在一定比例的投毒风险。

**项目地址:** [Chocapikk/CVE-2024-3400](https://github.com/Chocapikk/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #5

**来源**: [CVE-2024-3400-CyberBibs_SOC274---Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400-.md](../2024/CVE-2024-3400-CyberBibs_SOC274---Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400-.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未授权攻击者可利用该漏洞以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统需配置 GlobalProtect gateway 或 portal，无需开启设备遥测

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞。攻击者可以通过构造恶意请求，利用任意文件创建漏洞实现命令注入，最终在防火墙上以 root 权限执行任意代码。

**有效性评估：**

根据漏洞描述和搜索结果，CVE-2024-3400 漏洞是一个严重的安全问题，存在公开可用的 PoC，且已被实际利用。因此，提供的 PoC 代码很可能有效。

**投毒风险评估：**

提供的漏洞利用代码仅包含README.md文件，该文件主要描述了安全分析人员如何检测和响应此漏洞，没有发现任何可以执行的代码。
因此，可以判定该仓库存在作者隐藏的投毒代码的可能性较低，大约为10%， 主要考虑有以下几点原因：
*   **README.md文件：** 该文件详细描述了漏洞的分析、检测和修复过程，更像是一个安全分析报告。
*   **引用外部PoC：** 该文件引用了 GitHub 上另一个 PoC 仓库（`https://github.com/seed1337/CVE-2024-24919-POC/blob/main/exploit.py`），表明作者可能并未自行编写漏洞利用代码，而是使用了公开资源。
*   **缺乏可执行代码：** 提供的文件中没有任何可执行的代码，因此无法直接进行恶意操作。

**利用方式分析：**

1.  **漏洞成因：** 由于GlobalProtect 功能中存在任意文件创建漏洞，导致可以执行系统命令。
2.  **攻击方式：** 攻击者构造特定的 HTTP 请求，该请求包含恶意的 payload， 尝试读取敏感文件（例如 `/etc/shadow`）。
3.  **利用结果：** 成功利用该漏洞可使攻击者在目标系统上以 root 权限执行任意命令。
4.  **修复方案：** 升级到 PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3 及以上版本。

**项目地址:** [CyberBibs/SOC274---Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400-](https://github.com/CyberBibs/SOC274---Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400-)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #6

**来源**: [CVE-2024-3400-CyprianAtsyor_letsdefend-cve2024-3400-case-study.md](../2024/CVE-2024-3400-CyprianAtsyor_letsdefend-cve2024-3400-case-study.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** Palo Alto Networks PAN-OS GlobalProtect

**危害等级:** 高危，未授权远程命令执行，可完全控制防火墙

**影响版本:** PAN-OS 10.2 (小于 10.2.9-h1), 11.0 (小于 11.0.4-h1), 11.1 (小于 11.1.2-h3)

**利用条件:** 存在GlobalProtect网关或Portal配置，且防火墙版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是一个存在于Palo Alto Networks PAN-OS GlobalProtect功能中的命令注入漏洞。该漏洞允许未经身份验证的攻击者在防火墙上以root权限执行任意代码。根据漏洞信息和搜索结果，该漏洞的利用方式是利用特制的SESSID cookie，其中包含经过反引号执行的命令，并利用 `${IFS}` 绕过简单的过滤器。攻击者可以通过 `/global-protect/login.esp` 端点将payload注入，从而创建一个任意文件，导致命令注入。

**漏洞利用有效性：**

从提供的漏洞库信息、搜索结果以及漏洞利用代码来看，该漏洞利用是有效的。漏洞库信息中明确指出“Palo Alto Networks is aware of an increasing number of attacks that leverage the exploitation of this vulnerability”以及“Proof of concepts for this vulnerability have been publicly disclosed by third parties.”，证明该漏洞在野外已被利用且存在可用的PoC。

搜索结果也证实了这一点，例如“CVE-2024-3400 Activity | ThreatLabz” 和 “CVE-2024-3400 PAN-OS Zero-Day: What You Need To...” 都表明该漏洞正在被积极利用。

漏洞利用代码（README.md）中也详细描述了一个真实的攻击案例，包括攻击者使用的payload、C2服务器、以及受影响的端点等，进一步证实了该漏洞的可利用性。

**投毒风险分析：**

提供的漏洞利用代码（README.md）主要是一个事件调查报告和分析，用于检测和响应CVE-2024-3400的攻击尝试。虽然提供了IOC、利用模式和缓解措施，但该文件本身并没有包含恶意代码。

但是，考虑到该漏洞允许远程代码执行，攻击者可能会利用该漏洞部署后门或其他恶意软件。因此，在实际利用PoC进行测试时，需要格外小心，确保在一个隔离的环境中进行，并仔细检查利用过程中产生的任何文件或进程。

根据对代码的分析，投毒风险较低，估计为10%。风险主要来自如果直接复制利用代码而不理解其含义，可能会无意中执行一些不期望的操作，但代码本身没有明显的恶意目的。

**利用方式总结：**

1.  **目标：** 存在GlobalProtect配置的Palo Alto Networks PAN-OS防火墙（版本在受影响范围内）。
2.  **入口点：** `/global-protect/login.esp` 端点。
3.  **攻击载荷：** 特制的 `SESSID` cookie，包含反引号执行的命令，并使用 `${IFS}` 绕过过滤器。
4.  **利用过程：** 攻击者发送包含恶意 `SESSID` 的 HTTP POST 请求到 `/global-protect/login.esp` 端点，触发命令注入。
5.  **结果：** 在防火墙上以 root 权限执行任意命令，例如，下载并执行恶意脚本，建立反向shell等。

**项目地址:** [CyprianAtsyor/letsdefend-cve2024-3400-case-study](https://github.com/CyprianAtsyor/letsdefend-cve2024-3400-case-study)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #7

**来源**: [CVE-2024-3400-HackingLZ_panrapidcheck.md](../2024/CVE-2024-3400-HackingLZ_panrapidcheck.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未授权攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (低于 10.2.9-h1), 11.0 (低于 11.0.4-h1), 和 11.1 (低于 11.1.2-h3)

**利用条件:** 目标系统配置了 GlobalProtect 网关或 Portal

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞的存在，未经身份验证的攻击者可以在具有 root 权限的防火墙上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的PoC。漏洞库信息中提到 “Palo Alto Networks is aware of an increasing number of attacks that leverage the exploitation of this vulnerability. Proof of concepts for this vulnerability have been publicly disclosed by third parties.”
搜索结果中也包含多个威胁情报报告和分析，表明该漏洞的利用已经发生。
提供的代码， `panparse.py`,本身并不是直接的漏洞利用代码，而是一个用于分析 Palo Alto Networks 技术支持文件的 Python 脚本。它旨在帮助安全分析师查找与 CVE-2024-3400 相关的入侵痕迹（IOCs）。此脚本分析日志文件，例如gpsvc.log，sslvpn-access.log 和 nginx 的访问日志，以查找可疑活动。`iocs.txt` 文件包含已知的恶意IP地址，脚本将使用这些IP地址在日志中进行搜索。

因此，提供的PoC代码的有效性在于辅助分析，而不是直接利用漏洞。

**投毒风险分析：**

*   `README.md`：只是一个说明文件，描述了脚本的用途和使用方法，没有投毒风险。
*   `iocs.txt`：包含一个IP地址。虽然可以通过添加额外的恶意IP地址来误导分析，但这不是传统的代码投毒。风险较低。
*   `panparse.py`：Python脚本，分析日志文件。潜在的投毒方式可能包括：
    *   **恶意正则表达式：** 正则表达式如果构造不当，可能导致拒绝服务（ReDoS）攻击。
    *   **文件路径操纵：** 脚本处理文件路径，如果存在路径遍历漏洞，可能导致脚本访问或修改不应访问的文件。
    *   **执行任意命令：** 如果脚本包含执行系统命令的功能（虽然提供的代码中未直接体现，但可以通过构造特定的日志内容来实现），则可能被利用执行恶意命令。
*   **综合评估：** 由于脚本主要是分析日志文件，投毒的直接危害较小，主要集中在误导分析人员或造成拒绝服务。但如果配合精心构造的日志文件，可能存在一定的风险。

整体来看，投毒风险较低，大约为10%。 风险主要来自于被分析的日志内容和脚本本身存在的潜在漏洞，而不是恶意代码。

**利用方式：**

1.  **未授权访问：** 攻击者不需要身份验证即可触发漏洞。
2.  **文件创建：** 漏洞允许攻击者在系统上创建任意文件。
3.  **命令注入：** 通过创建包含恶意代码的文件，攻击者可以利用命令注入漏洞执行任意命令，从而获得 root 权限。
4.  **GlobalProtect配置：** 该漏洞仅影响配置了GlobalProtect网关或Portal的PAN-OS系统。


**项目地址:** [HackingLZ/panrapidcheck](https://github.com/HackingLZ/panrapidcheck)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #8

**来源**: [CVE-2024-3400-Kr0ff_cve-2024-3400.md](../2024/CVE-2024-3400-Kr0ff_cve-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以在防火墙上以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2（低于 10.2.9-h1）、11.0（低于 11.0.4-h1）和 11.1（低于 11.1.2-h3）

**利用条件:** 目标系统需要配置 GlobalProtect 网关或 GlobalProtect 门户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞，未经身份验证的攻击者可以利用此漏洞在受影响的防火墙上以 root 权限执行任意代码。

**有效性：**
提供的 PoC 代码似乎有效。漏洞库信息和搜索结果都表明该漏洞已被积极利用，并且存在公开的 PoC。该PoC代码包含check模块，可以验证目标是否存在漏洞，exploit模块可以执行命令。

**投毒风险：**
该 PoC 代码的投毒风险较低 (0%)。代码相对简单，主要是利用请求进行漏洞验证和利用。没有发现明显的恶意或隐藏行为，例如下载和执行任意二进制文件、修改系统文件或安装后门。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于GlobalProtect组件中，通过构造特殊的HTTP请求触发。该漏洞允许攻击者创建任意文件。
2.  **命令注入：** 攻击者利用任意文件创建漏洞进行命令注入，以执行恶意代码。
3.  **权限提升：** 成功利用该漏洞后，攻击者可以在目标系统上获得 root 权限。

**PoC 利用方式分析：**
*   **check 模块：**  检查目标是否容易受到攻击。
    *   它使用特制的 Cookie 发送 POST 请求到 `/ssl-vpn/hipreport.esp` 端点。Cookie 包含路径遍历序列，旨在访问 web 服务器文档目录之外的文件。
    *   如果请求返回状态代码 200，则脚本会尝试使用不包含 Cookie 的单独 GET 请求来访问服务器上使用 Cookie 值中指定的文件名构造的路径。 如果此 GET 请求返回状态代码 403（禁止），则目标被认为是易受攻击的。
*   **exploit 模块：** 利用漏洞执行命令。
    *   它通过构造带有恶意 Cookie 的HTTP POST请求到 `/ssl-vpn/hipreport.esp` 端点，触发命令执行。Cookie 包含命令注入payload，该payload将执行任意命令。
    *   该脚本使用`${IFS}`绕过空格过滤。
    *   该脚本尝试通过HTTP和HTTPS发送请求。

**缓解措施：**
建议立即升级到 PAN-OS 的固定版本，即使已应用解决方法和缓解措施。 该问题已在 PAN-OS 10.2.9-h1、PAN-OS 11.0.4-h1、PAN-OS 11.1.2-h3 以及所有更高版本的 PAN-OS 中得到修复。

**项目地址:** [Kr0ff/cve-2024-3400](https://github.com/Kr0ff/cve-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #9

**来源**: [CVE-2024-3400-MurrayR0123_CVE-2024-3400-Compromise-Checker.md](../2024/CVE-2024-3400-MurrayR0123_CVE-2024-3400-Compromise-Checker.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未授权的攻击者可以以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2 (低于 10.2.9-h1), PAN-OS 11.0 (低于 11.0.4-h1), PAN-OS 11.1 (低于 11.1.2-h3)

**利用条件:** 需要目标系统配置了 GlobalProtect 网关或 GlobalProtect 门户，无需启用设备遥测。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞，源于任意文件创建漏洞。未经身份验证的攻击者可以利用此漏洞在防火墙上以 root 权限执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开可用的 PoC。提供的 `cve-2024-3400_checker.sh` 脚本并非直接的漏洞利用代码，而是用于检测目标系统是否已经被入侵，该脚本通过检查web服务器日志、恶意文件和可疑的计划任务等方式进行检测。

**投毒风险：**
该脚本本身旨在检测漏洞利用后的痕迹，而非利用漏洞。虽然脚本本身不会直接执行恶意操作，但仍有很小的风险：
*   **误报：** 脚本可能会因为某些特征与恶意行为相似而产生误报，导致不必要的恐慌。
*   **信息泄露：** 脚本运行时会读取系统日志和配置文件，如果脚本被恶意修改，可能会泄露敏感信息。
因此，投毒风险估计为 10%。

**利用方式：**
根据漏洞信息描述和搜索结果，攻击者利用此漏洞通常涉及以下步骤：
1.  **利用任意文件创建漏洞：** 攻击者首先利用漏洞在目标系统上创建任意文件。
2.  **命令注入：**  通过精心构造的文件内容，攻击者可以注入恶意命令。
3.  **以 root 权限执行代码：** 注入的命令以 root 权限执行，攻击者从而完全控制受影响的系统。

根据Volexity的分析报告，攻击者可能还会使用Upstyle后门进行持久化控制。
检测脚本中的检测点也反映了这些攻击特征，例如检测`/var/lib/python3.6/site-packages/system.pth`中是否包含base64编码的恶意代码，以及检查/tmp目录下是否存在创建GlobalProtect相关目录或下载执行恶意脚本的行为。


**项目地址:** [MurrayR0123/CVE-2024-3400-Compromise-Checker](https://github.com/MurrayR0123/CVE-2024-3400-Compromise-Checker)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #10

**来源**: [CVE-2024-3400-Ravaan21_CVE-2024-3400.md](../2024/CVE-2024-3400-Ravaan21_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 任意文件创建导致命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，允许未授权的攻击者以root权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统需要配置GlobalProtect网关或门户，且未应用漏洞补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞。该漏洞源于任意文件创建，可能允许未经身份验证的攻击者在防火墙上以root权限执行任意代码。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的POC。
提供的Python和Rust版本的POC代码尝试利用该漏洞来检测目标系统是否存在漏洞。POC代码通过发送特制的HTTP请求到目标系统的GlobalProtect接口，尝试创建或访问特定文件。如果成功，则认为系统易受攻击。

**投毒风险分析：**

查看提供的Python和Rust POC代码，未发现明显的恶意或投毒代码。这些代码的主要目的是验证漏洞的存在，而非植入后门或执行恶意操作。

*   Python 代码：`/tmp/b413b80758a8cc351e9d0e6068c08cc3/CVE-2024-3400.py` 使用 `requests` 库发送 HTTP 请求，检查目标是否易受攻击，并将易受攻击的IP地址写入`vuln.txt`。这部分代码没有发现任何投毒行为。
*   Rust 代码：`/tmp/b413b80758a8cc351e9d0e6068c08cc3/src/main.rs` 的功能与 Python 版本类似，使用 `reqwest` 库发送 HTTP 请求，并将易受攻击的 IP 地址写入`vuln.txt`。同样，没有发现恶意代码。

因此，投毒风险评估为0%。

**利用方式：**

1.  **漏洞触发：** 攻击者发送特制的HTTP请求到目标系统的GlobalProtect接口，请求包含恶意构造的文件路径，导致服务器尝试创建或访问该文件。
2.  **命令注入：** 由于输入验证不当，恶意文件路径中的特殊字符被解释为命令，导致系统执行攻击者指定的任意代码。
3.  **权限提升：** 该漏洞允许攻击者以root权限执行代码，从而完全控制受影响的防火墙。

**缓解措施：**

*   立即升级到PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3或更高版本。
*   如果无法立即升级，可以应用威胁防御签名95187、95189和95191（在应用程序和威胁内容版本8836-8695及更高版本中可用）来阻止攻击。

**项目地址:** [Ravaan21/CVE-2024-3400](https://github.com/Ravaan21/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #11

**来源**: [CVE-2024-3400-Rohith-Reddy-Y_Zero-Day-Vulnerability-Exploitation-Detection-Tool.md](../2024/CVE-2024-3400-Rohith-Reddy-Y_Zero-Day-Vulnerability-Exploitation-Detection-Tool.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以利用此漏洞在防火墙上以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2（低于 10.2.9-h1）、PAN-OS 11.0（低于 11.0.4-h1）和 PAN-OS 11.1（低于 11.1.2-h3）

**利用条件:** 需要目标系统配置了 GlobalProtect 网关或 GlobalProtect 门户（或两者）。设备不需要启用 telemetry。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。该漏洞源于任意文件创建，攻击者可以利用它来执行任意命令。该漏洞影响配置了 GlobalProtect 网关或门户的特定 PAN-OS 版本。\n\n**有效性：**\n根据漏洞库信息、搜索结果（如ihebski/CVE-2024-3400在github上存在）表明存在公开可用的PoC，以及Volexity和Palo Alto Networks官方的威胁报告，确认该漏洞已被积极利用，因此该漏洞利用代码有效性较高。\n\n**投毒风险：**\n提供的漏洞利用代码是一个“Zero-Day Vulnerability Exploitation Detection Tool”，旨在 *检测* 而非 *利用* 漏洞。该工具使用 AI/ML 技术分析网络流量以检测异常模式，从而预测和阻止零日攻击。但仓库包含AI检测模型，有较大概率存在作者隐藏的后门代码，存在一定的投毒风险。\n\n**利用方式：**\n根据CVE描述，以及搜索结果，可以总结出以下利用方式：\n1.  **利用 GlobalProtect 功能中的任意文件创建漏洞。**\n2.  **通过精心构造的请求，在目标系统上创建恶意文件。**\n3.  **利用创建的文件执行命令注入，从而在防火墙上以 root 权限执行任意代码。**

**项目地址:** [Rohith-Reddy-Y/Zero-Day-Vulnerability-Exploitation-Detection-Tool](https://github.com/Rohith-Reddy-Y/Zero-Day-Vulnerability-Exploitation-Detection-Tool)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #12

**来源**: [CVE-2024-3400-W01fh4cker_CVE-2024-3400-RCE-Scan.md](../2024/CVE-2024-3400-W01fh4cker_CVE-2024-3400-RCE-Scan.md)

## CVE-2024-3400-PAN-OS-命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，允许未授权的攻击者以root权限执行任意代码

**影响版本:** PAN-OS 10.2, 11.0, 和 11.1（特定版本）

**利用条件:** 需要目标系统配置了GlobalProtect网关或门户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞。该漏洞源于任意文件创建，允许未经身份验证的攻击者在防火墙上以 root 权限执行任意代码。该漏洞影响配置了 GlobalProtect 网关或门户的特定 PAN-OS 版本（10.2.0 < 10.2.9-h1, 11.0.0 < 11.0.4-h1, 11.1.0 < 11.1.2-h3）。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的PoC代码，因此提供的PoC代码很可能有效。

**利用方式：**

1.  **利用入口：** 漏洞存在于PAN-OS的GlobalProtect功能中，需要目标开启GlobalProtect网关或者GlobalProtect门户。
2.  **漏洞触发：** 通过构造包含恶意命令的特殊Cookie，利用`/ssl-vpn/hipreport.esp`接口触发漏洞。
3.  **命令注入：** Cookie中的命令经过base64编码，然后在服务器端解码并执行。
4.  **任意文件创建：** 攻击者可以利用命令注入创建任意文件，例如，将敏感信息（如running-config.xml）写入到Web可访问的目录。
5.  **远程代码执行：** 成功利用漏洞后，攻击者可以以 root 权限在防火墙上执行任意代码。

**PoC代码分析：**

PoC代码的工作流程如下：

1.  **生成随机字符串：** 用于创建唯一的文件名。
2.  **构造恶意Cookie：**  Cookie中包含一个经过Base64编码的命令，该命令使用`tar`命令将`/opt/pancfg/mgmt/saved-configs/running-config.xml`文件压缩到`/var/appweb/sslvpndocs/global-protect/portal/js/jquery.{filename}.js`。利用`SESSID=/../../../opt/panlogs/tmp/device_telemetry/minute/`来进行目录穿越，从而达到任意文件创建的目的。
3.  **发送POST请求：** 向`/ssl-vpn/hipreport.esp`发送包含恶意Cookie的POST请求。
4.  **验证利用结果：** 检查是否可以访问`/global-protect/portal/js/jquery.{filename}.js`，如果可以访问，则表明漏洞利用成功。

**投毒风险分析：**

PoC代码的主要功能是验证漏洞是否存在，并将running-config.xml文件复制到Web可访问的目录。由于PoC需要在目标系统上执行命令，因此存在一定的投毒风险。例如，作者可能在编码的命令中添加恶意代码，导致执行`rm -rf /`或者反弹shell等恶意行为，当然，这部分命令是直接可见的，可以审计出来。

**投毒风险评估：**

代码中存在创建文件，读取配置文件的操作，这些操作本身可能被利用于进行恶意活动，比如替换文件内容、窃取配置文件中的密钥等敏感信息。但是，代码中利用的命令注入点以及创建和读取的行为都是漏洞利用本身所需要的，因此不能完全确定是作者有意为之的投毒行为。投毒风险评估为10%。

**项目地址:** [W01fh4cker/CVE-2024-3400-RCE-Scan](https://github.com/W01fh4cker/CVE-2024-3400-RCE-Scan)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #13

**来源**: [CVE-2024-3400-XiaomingX_CVE-2024-3400-poc.md](../2024/CVE-2024-3400-XiaomingX_CVE-2024-3400-poc.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可利用此漏洞以 root 权限在防火墙上执行任意代码

**影响版本:** PAN-OS 10.2 (低于 10.2.9-h1), PAN-OS 11.0 (低于 11.0.4-h1), PAN-OS 11.1 (低于 11.1.2-h3)

**利用条件:** 需要配置 GlobalProtect 网关或 GlobalProtect 门户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞，由于任意文件创建漏洞导致。未经身份验证的攻击者可以利用此漏洞在受影响的防火墙上以 root 权限执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已经被积极利用，并且已经有公开的 POC 代码。

**投毒风险：**
提供的漏洞利用代码只是 Apache 2.0 许可协议的文本，无法用于分析投毒风险。因此，从现有信息无法判断该代码库中是否存在投毒代码。考虑到漏洞的严重性和广泛利用的情况，应谨慎对待任何来源不明的漏洞利用代码。

**利用方式：**
1.  **漏洞入口：**  GlobalProtect 的特定功能（网关或门户）。
2.  **根本原因：**  由于任意文件创建导致的命令注入漏洞。
3.  **攻击过程：**  攻击者利用漏洞在系统上创建恶意文件，该文件包含恶意命令。
4.  **权限提升：**  由于命令注入以 root 权限执行，攻击者可以完全控制受影响的防火墙。
5.  **影响：**  完全控制防火墙，可能导致数据泄露、服务中断、横向移动等。

**缓解措施：**
*   立即升级到已修复的 PAN-OS 版本（10.2.9-h1、11.0.4-h1、11.1.2-h3 及更高版本）。
*   使用威胁防御订阅来阻止针对此漏洞的攻击（威胁 ID 95187、95189 和 95191）。
*   确保已将漏洞保护应用于 GlobalProtect 接口。

根据搜索结果，CISA 已将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞正在被广泛利用。

**项目地址:** [XiaomingX/CVE-2024-3400-poc](https://github.com/XiaomingX/CVE-2024-3400-poc)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #14

**来源**: [CVE-2024-3400-ZephrFish_CVE-2024-3400-Canary.md](../2024/CVE-2024-3400-ZephrFish_CVE-2024-3400-Canary.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以以 root 权限在防火墙上执行任意代码。

**影响版本:** PAN-OS 10.2 (低于 10.2.9-h1), PAN-OS 11.0 (低于 11.0.4-h1), PAN-OS 11.1 (低于 11.1.2-h3)

**利用条件:** 需要目标系统配置了 GlobalProtect gateway 或 GlobalProtect portal (或两者)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞，未经身份验证的攻击者可以利用此漏洞在受影响的防火墙上以 root 权限执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞 CVSS 评分高达 10.0，已被积极利用。提供的 PoC 代码尝试通过设置包含恶意命令的 `SESSID` cookie 来利用该漏洞。恶意命令使用 `curl` 和 `base64` 下载并执行来自 `kgezdr4fafaval55y8t2w9up.canarytokens.com` 的 shell 脚本。此行为符合命令注入漏洞的特征，因此 PoC 代码可能有效。

**投毒风险分析：**

PoC 代码本身不包含明显的投毒代码，其主要功能是利用漏洞执行命令。但是，需要注意的是，PoC 代码从外部 URL (`kgezdr4fafaval55y8t2w9up.canarytokens.com`) 下载并执行 shell 脚本。这意味着攻击者可以通过控制此 URL 来投放恶意代码。由于该URL属于canarytokens.com，该网站提供的token会发送警报，因此不太可能是恶意网址, 投毒风险较低，但依然存在。因此，风险评估百分比为10%。

**利用方式分析：**

1.  **漏洞点：** GlobalProtect 的登录页面 (`/global-protect/login.esp`)。
2.  **攻击方式：** 通过设置 `SESSID` cookie 注入恶意命令。Cookie 的值被设置为包含操作系统命令的字符串，这些命令会尝试下载并执行远程 shell 脚本。
3.  **命令执行：** 注入的命令使用 `curl` 和 `base64` 从指定 URL 下载 base64 编码的 shell 脚本，解码后通过 `bash` 执行。
4.  **权限提升：** 由于漏洞是在 PAN-OS 中利用的，且具有 root 权限执行代码的能力，因此攻击者可以完全控制受影响的防火墙。
5.  **利用条件：** 目标 PAN-OS 设备需要配置了 GlobalProtect 网关或门户，并且运行的是受影响的版本。

**项目地址:** [ZephrFish/CVE-2024-3400-Canary](https://github.com/ZephrFish/CVE-2024-3400-Canary)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #15

**来源**: [CVE-2024-3400-ak1t4_CVE-2024-3400.md](../2024/CVE-2024-3400-ak1t4_CVE-2024-3400.md)

## CVE-2024-3400 Palo Alto PAN-OS GlobalProtect 任意文件创建导致命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** Palo Alto Networks PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以在防火墙上以 root 权限执行任意代码。

**影响版本:** PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1版本, 小于 PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3

**利用条件:** 目标设备配置了 GlobalProtect 网关或 GlobalProtect 门户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞，该漏洞是由于任意文件创建导致的。未经身份验证的攻击者可以通过向目标系统发送特制的HTTP请求，在特定版本的PAN-OS上，利用GlobalProtect功能写入任意文件，最终导致命令注入，以root权限执行任意代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行受影响PAN-OS版本且配置了GlobalProtect网关或门户的Palo Alto防火墙。
2.  **利用漏洞：** 通过发送包含恶意Cookie的HTTP POST请求到`/ssl-vpn/hipreport.esp`，在`/var/appweb/sslvpndocs/global-protect/portal/images/`目录下创建任意文件。Cookie中包含`SESSID=/../../../var/appweb/sslvpndocs/global-protect/portal/images/${file_here};`，`${file_here}`是要写入的文件名，也是命令注入的关键位置。
3.  **命令执行：**  创建的文件内容可被执行，从而实现命令注入。

**有效性评估：**

根据漏洞描述和漏洞利用代码，该POC代码是有效的。它通过`httpx`工具发送特制的HTTP请求，利用任意文件创建漏洞实现命令注入。脚本首先尝试写入文件，然后验证文件是否成功写入（通过检查HTTP状态码）。

**投毒风险分析：**

该POC代码本身比较简洁，主要利用了`httpx`工具发送恶意请求。潜在的投毒风险在于：

*   **恶意URL列表：** `gp.hosts`文件可能包含指向恶意站点的链接，这些站点可能托管恶意软件或进行其他攻击活动。用户在使用该脚本时，如果使用不可信的URL列表，可能会受到二次攻击。
*   **文件写入位置：** 攻击者可能会修改脚本，将文件写入到更敏感的位置，从而扩大攻击范围。

总体来说，投毒风险较低，约为10%。主要是由于脚本功能较为单一，且依赖于`httpx`工具，恶意代码隐藏的空间有限。但用户仍需谨慎使用，并确保使用可信的URL列表。

**缓解措施：**

*   升级到PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3或更高版本。
*   应用威胁防御签名95187、95189和95191。
*   对GlobalProtect接口应用漏洞保护。

**项目地址:** [ak1t4/CVE-2024-3400](https://github.com/ak1t4/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #16

**来源**: [CVE-2024-3400-andrelia-hacks_CVE-2024-3400.md](../2024/CVE-2024-3400-andrelia-hacks_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码。

**影响版本:** PAN-OS 10.2（低于10.2.9-h1），PAN-OS 11.0（低于11.0.4-h1），PAN-OS 11.1（低于11.1.2-h3）。仅影响配置了GlobalProtect网关或GlobalProtect门户的防火墙。

**利用条件:** 目标系统需启用GlobalProtect门户或网关功能，且为受影响的PAN-OS版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是一个Palo Alto Networks PAN-OS中GlobalProtect功能存在的任意文件创建导致的操作系统命令注入漏洞。未经身份验证的攻击者可以通过构造恶意请求，在受影响的系统上以root权限执行任意代码。

**漏洞利用有效性：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判定此漏洞利用是有效的。漏洞库信息显示Palo Alto Networks已知存在利用此漏洞的攻击，并且第三方已公开PoC。搜索结果也证实了该漏洞已被积极利用。

**投毒风险分析：**

PoC代码主要包含以下几个文件：

*   `LICENSE`：MIT许可证，表明作者允许自由使用、复制、修改和分发代码。
*   `README.md`：包含漏洞的描述、使用方法、依赖说明和参考链接。使用说明指示如何扫描目标并提取配置文件。
*   `get_data.py`：该脚本从`confirmed_rce.log`文件中读取目标URL，然后使用多线程下载文件。下载的文件存储在`out/`目录下。
*   `run.py`：此脚本用于扫描目标，尝试利用该漏洞。它创建一个随机的文件名，并构造一个命令来打包`/opt/pancfg/mgmt/saved-configs/running-config.xml`文件，并将其保存在`/var/appweb/sslvpndocs/global-protect/portal/js/`目录下，这个目录是GlobalProtect Portal的js文件目录。

风险评估：

1.  **依赖安装：** `README.md`中要求安装`rich`库，这本身是相对安全的，但是从非官方源安装包则存在一定的风险。
2.  **目标文件获取：** `get_data.py`从`confirmed_rce.log`读取URL并下载文件。如果`confirmed_rce.log`被篡改，可能导致下载恶意文件。
3.  **命令构造：**  `run.py`构造的命令会将配置文件打包并放置到Web可访问目录，从而泄露敏感信息，例如管理员密码哈希等。攻击者可以利用这些信息进行进一步的攻击。

投毒风险：
代码本身看起来是合法的PoC，用于检测和利用CVE-2024-3400漏洞。但是，存在一些潜在的投毒风险，例如：
* 如果攻击者修改了`run.py`脚本，使其执行恶意命令，例如删除文件或安装后门，则可能造成更大的危害。但是目前看到的脚本仅仅是把配置文件导出来，风险较小。
*  如果依赖项`rich`被恶意版本替换，也可能导致代码执行过程中出现问题。

虽然存在上述风险，但考虑到PoC的主要功能是利用漏洞，而不是直接执行恶意操作，因此投毒的概率较低。此外，该PoC仅用于`get_data.py`下载文件，以及`run.py`产生exp，因此，这里的**投毒概率大概在10%**左右。

**漏洞利用方式：**

1.  **确定目标：** 攻击者首先需要确定存在漏洞的PAN-OS防火墙，这些防火墙启用了GlobalProtect门户或网关功能，并且运行着受影响的PAN-OS版本。
2.  **发送恶意请求：** 攻击者发送特制的HTTP请求，其中包含用于创建任意文件的命令注入代码。`run.py`文件展示了如何通过base64编码的命令，利用`tar`命令将敏感配置文件`/opt/pancfg/mgmt/saved-configs/running-config.xml`打包到Web可访问目录中。
3.  **执行任意代码：**  由于文件创建过程存在漏洞，攻击者可以将恶意代码注入到创建的文件中，或者利用文件创建来执行操作系统命令。通过将打包好的配置文件放置在web目录，攻击者可以下载这些文件。
4.  **权限提升：**  由于命令注入是以root权限执行的，攻击者可以完全控制受影响的系统，包括安装后门、窃取数据或破坏系统。
5.  **提取敏感信息：** 攻击者可以通过`get_data.py`下载配置文件，获取敏感信息。

总而言之，该漏洞的利用过程涉及发送恶意请求，利用任意文件创建漏洞执行命令注入，最终实现远程代码执行和权限提升。

**项目地址:** [andrelia-hacks/CVE-2024-3400](https://github.com/andrelia-hacks/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #17

**来源**: [CVE-2024-3400-codeblueprint_CVE-2024-3400.md](../2024/CVE-2024-3400-codeblueprint_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未授权的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (< 10.2.9-h1), 11.0 (< 11.0.4-h1), 11.1 (< 11.1.2-h3)

**利用条件:** 需要目标设备配置了GlobalProtect网关或GlobalProtect Portal，并且漏洞版本在影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞，未经身份验证的攻击者可以在具有 root 权限的防火墙上执行任意代码。

**有效性评估：**

提供的 Python POC 代码 `/tmp/0de44055d5df69da649501894bfd0c34/CVE-2024-3400_upload_check.py` 尝试通过在 `/var/appweb/sslvpndocs/global-protect/portal/images/` 目录下上传一个随机命名的 `.txt` 文件来验证漏洞的存在。该脚本首先检查目标是否存在，然后尝试上传文件，并通过检查文件是否存在来验证上传是否成功。搜索引擎结果和漏洞库信息表明该漏洞确实存在，并且有公开可用的 PoC。

**投毒风险评估：**

分析提供的代码后，投毒风险较低。该脚本主要用于验证目标是否存在漏洞，而不是执行恶意操作。唯一可能需要注意的是，该脚本会在目标文件系统上创建一个测试文件，但脚本本身提供了删除该文件的说明。

*   代码逻辑较为简单，主要功能是上传和检查文件，没有发现明显的恶意行为。
*   脚本需要用户手动输入目标 URL，降低了大规模自动化攻击的风险。
*   脚本的目的是验证漏洞存在，而不是利用漏洞执行恶意操作。
*  存在非常低的风险：脚本在成功上传后，提示用户手动删除上传的文件。如果攻击者利用此脚本，但没有清除测试文件，可能会留下痕迹，但这不是恶意投毒，而是利用不当的副作用。

综合考虑，该 POC 代码的投毒风险约为 5%。

**利用方式：**

1.  **漏洞原理：** 该漏洞是由于 PAN-OS GlobalProtect 在处理特定请求时，允许攻击者创建任意文件，进而导致命令注入。具体来说，攻击者可以通过构造包含恶意代码的文件名，并利用 GlobalProtect 的文件处理逻辑来执行系统命令。
2.  **利用步骤：**
    *   攻击者首先需要确定目标 PAN-OS 设备是否配置了 GlobalProtect 并且版本在受影响范围内。
    *   攻击者构造一个包含恶意代码的文件名，例如 `test.txt; <command>`，其中 `<command>` 是要执行的系统命令。
    *   攻击者通过构造特定的 HTTP 请求，将包含恶意代码的文件名传递给 GlobalProtect。
    *   GlobalProtect 在处理该请求时，会尝试创建该文件，由于文件名包含恶意代码，导致系统命令被执行。
3.  **影响：** 成功利用该漏洞后，攻击者可以获得目标设备的 root 权限，从而可以执行任意操作，例如窃取敏感数据、安装后门、篡改系统配置等。

根据漏洞库信息，缓解措施包括升级到修复后的 PAN-OS 版本，或使用威胁防御签名来阻止攻击。

**项目地址:** [codeblueprint/CVE-2024-3400](https://github.com/codeblueprint/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #18

**来源**: [CVE-2024-3400-hahasagined_CVE-2024-3400.md](../2024/CVE-2024-3400-hahasagined_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect Command Injection

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未经身份验证的攻击者可以在防火墙上以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2 (< 10.2.9-h1), 11.0 (< 11.0.4-h1), and 11.1 (< 11.1.2-h3)

**利用条件:** 需要目标PAN-OS设备配置了GlobalProtect网关或GlobalProtect门户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞的存在，未经身份验证的攻击者可以在特定 PAN-OS 版本和配置下，利用此漏洞以 root 权限在防火墙上执行任意代码。

**有效性：**
根据漏洞信息，已经存在公开可用的POC代码，并且该漏洞已被积极利用。搜索结果也表明了这一点，多个安全厂商和研究人员已经发布了关于该漏洞的分析和利用信息，例如Unit 42、Volexity、Zscaler和CrowdStrike。

**投毒风险：**
提供的“漏洞利用代码”实际上是一个IP地址列表（EDL）。虽然看似无害，但如果攻击者将恶意命令注入过程与此列表结合使用，则该列表可以作为攻击基础设施的一部分。此列表本身不包含任何恶意代码，因此直接的“投毒风险”为0%。但是，它可能会被用于后续的攻击活动中，例如建立C&C通信。

**利用方式：**
1.  **任意文件创建：** 攻击者利用 GlobalProtect 功能中存在的漏洞，在目标系统上创建任意文件。
2.  **命令注入：** 攻击者通过构造恶意请求，将恶意命令注入到服务器的操作系统中。
3.  **代码执行：** 注入的命令以 root 权限执行，允许攻击者完全控制受影响的防火墙。例如安装后门。

根据漏洞库信息和搜索结果，成功利用此漏洞需要满足以下条件：
*   目标设备必须运行受影响的 PAN-OS 版本（10.2、11.0 或 11.1）。
*   设备必须配置了 GlobalProtect 网关或 GlobalProtect 门户。

漏洞利用通常涉及发送特制的 HTTP 请求，利用URL中的参数进行命令注入，从而在目标系统上执行任意代码。

**项目地址:** [hahasagined/CVE-2024-3400](https://github.com/hahasagined/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #19

**来源**: [CVE-2024-3400-hashdr1ft_SOC274-Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400.md](../2024/CVE-2024-3400-hashdr1ft_SOC274-Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400.md)

## CVE-2024-3400 - Palo Alto Networks PAN-OS GlobalProtect Command Injection

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (<10.2.9-h1), 11.0 (<11.0.4-h1), 11.1 (<11.1.2-h3)，并配置了GlobalProtect网关或门户

**利用条件:** 需要目标系统运行受影响的PAN-OS版本，并启用了GlobalProtect网关或门户功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞。由于任意文件创建漏洞导致，未经身份验证的远程攻击者可以通过在受影响的设备上创建恶意文件，执行任意代码，从而获得root权限。漏洞影响配置了GlobalProtect网关或门户的PAN-OS 10.2、11.0和11.1的特定版本。根据提供的漏洞利用代码, 可以看到一个SOC分析师利用自动化工具对告警进行分析, 通过分析攻击流量, 恶意IP以及最终日志响应码来判断漏洞是否被利用. 漏洞利用代码分析主要是记录SOC分析过程, 本身没有提供exp代码。投毒风险分析：漏洞利用代码本身是SOC分析过程记录，而非漏洞利用的EXP，本身不具备漏洞利用能力。其中的图片引用可能存在钓鱼风险，例如替换为恶意链接等， 风险较低，因此投毒风险评定为10%。漏洞利用方式：攻击者发送特制的HTTP请求到GlobalProtect的登录页面`/global-protect/login.esp`，利用任意文件创建漏洞，写入包含恶意命令的文件。由于命令注入漏洞的存在，写入的文件中的命令将以root权限执行。根据搜索结果, 此漏洞已经被大规模利用, 并且已经有公开的POC.

**项目地址:** [hashdr1ft/SOC274-Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400](https://github.com/hashdr1ft/SOC274-Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #20

**来源**: [CVE-2024-3400-ihebski_CVE-2024-3400.md](../2024/CVE-2024-3400-ihebski_CVE-2024-3400.md)

## CVE-2024-3400 - Palo Alto Networks PAN-OS GlobalProtect Command Injection

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** Palo Alto Networks PAN-OS (GlobalProtect)

**危害等级:** 高危，未授权的远程代码执行，可获取 root 权限

**影响版本:** PAN-OS 10.2 < 10.2.9-h1, 11.0 < 11.0.4-h1, 11.1 < 11.1.2-h3

**利用条件:** 需要配置 GlobalProtect 网关或门户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞。未经身份验证的攻击者可以通过精心构造的请求，在受影响的设备上以 root 权限执行任意代码。漏洞利用涉及任意文件创建，进而导致命令注入。根据漏洞库信息，存在野外利用，CISA KEV 也收录了该漏洞。

**有效性：** 根据提供的漏洞利用代码和搜索引擎结果，该 POC 代码是有效的。POC 通过构造包含路径遍历的 Cookie，在指定位置创建文件，验证是否存在漏洞。更进一步的RCE利用需要启用Telemetry。

**投毒风险：** 漏洞利用代码主要由一个 YAML 文件 (NUCLEI 模板) 和 README 文件组成。YAML 文件定义了漏洞验证的 HTTP 请求，README 描述了漏洞和利用方法。license文件是MIT开源协议。风险在于，如果攻击者修改 YAML 文件，例如在 POST 请求中添加额外的恶意载荷，就可能存在投毒风险。该仓库本身相对简单，投毒点在于利用方式的描述和 YAML 文件内容，但整体风险较低，预计约为 10%。由于要依赖于 Telemetry 开启才能进一步的RCE利用，所以投毒的价值不大，

**利用方式：**
1.  发送一个包含特殊构造的 `SESSID` Cookie 的 POST 请求到 `/ssl-vpn/hipreport.esp`。Cookie 中的路径遍历用于指定文件创建的位置。
2.  如果存在漏洞，服务器会根据Cookie中的文件名创建文件.
3. 验证思路：尝试访问创建的文件。如果返回 403 状态码（禁止访问），则表示目标存在漏洞，且文件创建成功(文件创建的权限是root权限)。
4. 进一步的RCE,通过Telemetry日志分析与控制，发送含有命令的Cookie进行RCE攻击

**项目地址:** [ihebski/CVE-2024-3400](https://github.com/ihebski/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #21

**来源**: [CVE-2024-3400-iwallarm_cve-2024-3400.md](../2024/CVE-2024-3400-iwallarm_cve-2024-3400.md)

## CVE-2024-3400-PAN-OS-命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未授权的攻击者可以以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (低于10.2.9-h1), 11.0 (低于11.0.4-h1), 11.1 (低于11.1.2-h3)

**利用条件:** 需要配置GlobalProtect网关或GlobalProtect门户的PAN-OS防火墙。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞，由于任意文件创建导致。未经身份验证的攻击者可以利用此漏洞在防火墙上以root权限执行任意代码。漏洞影响配置了GlobalProtect网关或门户的特定PAN-OS版本。从提供的漏洞利用代码来看，它似乎包含一个域名 `cve-2024-3400.org` 和一个 `test` 文件. 利用方式可能涉及在目标系统上创建包含恶意命令的文件，然后通过命令注入执行。关于投毒风险，该POC代码本身较为简洁，主要目的是验证漏洞的存在。但是攻击者可以利用此漏洞植入恶意后门，因此存在一定的投毒风险，可能性评估为10%。根据搜索结果，该漏洞已被广泛利用，CISA也将其列入已知被利用的漏洞目录。

**项目地址:** [iwallarm/cve-2024-3400](https://github.com/iwallarm/cve-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #22

**来源**: [CVE-2024-3400-marconesler_CVE-2024-3400.md](../2024/CVE-2024-3400-marconesler_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 任意文件创建导致命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (低于 10.2.9-h1), 11.0 (低于 11.0.4-h1), 和 11.1 (低于 11.1.2-h3)，且配置了GlobalProtect网关或门户

**利用条件:** 需要目标系统配置了GlobalProtect网关或门户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞，源于任意文件创建。未经身份验证的远程攻击者可以利用此漏洞在受影响的设备上以 root 权限执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以得出结论：该漏洞的PoC代码有效。

*   漏洞库信息显示，Palo Alto Networks 已经意识到有越来越多的攻击利用此漏洞，并且第三方已经公开了PoC。
*   搜索结果中也包含了多个关于CVE-2024-3400的分析文章，以及检测被入侵设备的方法，进一步证实了该漏洞的真实性和可利用性。
*   提供的PoC代码 `cve-2024-3400.py` 实现了利用该漏洞执行命令的功能，包括获取配置文件和执行反弹shell。

**投毒风险分析：**

PoC代码本身相对简单，主要通过构造恶意的SESSID cookie来触发漏洞。投毒风险较低。主要风险点在于：

*   **README.md中的免责声明：** README.md提到“the firewall must be running a vulnerable PAN-OS version and must have telemetry enabled.”,如果使用者忽略此项说明，在非漏洞环境中使用，可能会导致一些非预期行为。 即使此项说明，使用者也有可能没意识到打开telemetry可能带来的风险. *   **Connect-back shell风险：** PoC代码中包含反弹shell的功能，如果攻击者修改反弹shell的IP地址和端口，可以连接到受害者的设备。

**漏洞利用方式：**

1.  **漏洞原理：** 漏洞利用了GlobalProtect功能中对用户输入验证不严格的问题，允许攻击者通过构造恶意的SESSID cookie来创建任意文件，并在创建文件的过程中执行命令注入。
2.  **攻击步骤：**
    *   攻击者构造包含恶意命令的SESSID cookie。
    *   攻击者向目标设备的GlobalProtect登录页面发送请求，并在请求中包含构造的SESSID cookie。
    *   目标设备在处理SESSID cookie时，由于验证不严格，会将cookie中的恶意命令注入到系统中执行。
3.  **PoC代码分析：**
    *   `cve-2024-3400.py` 脚本接受目标主机、攻击类型和反弹shell地址作为参数。
    *   脚本根据攻击类型选择不同的命令。
        *   `getconf`: 复制 `running-config.xml` 到 web 目录，攻击者可以下载配置文件。
        *   `getpanoramaconf`: 复制 `merged-running-config.xml` 到 web 目录，攻击者可以下载panorama合并的配置文件。
        *   `remoteshell`: 启动反弹shell，连接到攻击者指定的IP地址和端口。
    *   脚本将命令进行base64编码，并将其嵌入到SESSID cookie中。
    *   脚本向目标设备发送包含恶意cookie的GET请求。

**总结：**

CVE-2024-3400是一个高危漏洞，利用简单，影响广泛。建议受影响的用户尽快升级到安全版本。

**项目地址:** [marconesler/CVE-2024-3400](https://github.com/marconesler/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #23

**来源**: [CVE-2024-3400-nanwinata_CVE-2024-3400.md](../2024/CVE-2024-3400-nanwinata_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 （未升级到指定hotfix版本）

**利用条件:** 需要目标系统配置了GlobalProtect gateway 或 GlobalProtect portal

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于PAN-OS GlobalProtect功能中存在任意文件创建导致的命令注入漏洞。未经验证的攻击者可以通过向目标服务器发送特制的请求，在目标服务器上创建恶意文件，进而执行任意系统命令，最终获得root权限。漏洞利用代码通过修改Cookie中的`SESSID`参数，指向一个包含命令注入的路径，然后发送POST请求到`/ssl-vpn/hipreport.esp`来触发该漏洞。httpx用于快速扫描目标域名下的活跃主机及端口，Subfinder用于子域名枚举。

**有效性评估：**
根据漏洞信息和漏洞利用代码，该PoC代码是有效的。漏洞库信息明确指出存在公开的PoC，并且漏洞被大规模利用。搜索结果中也包含大量关于该漏洞的分析和利用信息。该PoC代码通过构造恶意的Cookie，利用了任意文件创建的漏洞，实现了命令注入。

**投毒风险分析：**
PoC代码本身的功能是验证漏洞是否存在。代码主要包含以下功能：
1.  **子域名枚举:**  使用`subfinder`工具枚举目标域名的子域名，这本身没有投毒风险，但如果`subfinder`本身被替换成恶意版本，则存在风险。
2.  **活跃主机扫描:** 使用`httpx`工具扫描活跃主机，同样，需要保证`httpx`工具本身的安全性。
3.  **漏洞验证:** 通过构造特殊的Cookie和URI，发送POST请求来验证目标是否存在漏洞。这个过程本身是漏洞利用的一部分，**不是投毒代码**。
4. **临时文件处理**: 代码中会创建和删除临时文件(`temp_domains.txt`)，如果存在恶意修改，可能导致拒绝服务或信息泄露，但可能性较低。

**潜在投毒点分析：**
*   **依赖外部工具:** PoC依赖`subfinder`和`httpx`这两个外部工具。如果这两个工具被恶意版本替换，则存在投毒风险。例如，恶意版本的`subfinder`可能返回错误的子域名，或者`httpx`被修改为执行恶意代码。这种风险的评估概率是10%。

**利用方式：**
1.  **子域名枚举 (可选):** 使用`subfinder`等工具枚举目标域名的子域名。如果已知目标IP地址，则可以跳过此步骤。
2.  **活跃主机扫描:** 使用`httpx`等工具扫描目标子域名的80,443,4443,8443端口，确定哪些主机是活跃的。
3.  **漏洞验证:** 对活跃的主机，构造包含恶意代码的Cookie，发送POST请求到`/ssl-vpn/hipreport.esp`，验证漏洞是否存在。Cookie包含的文件路径指向可以执行命令的位置，从而实现命令注入。
4.  **命令执行:** 成功利用漏洞后，攻击者可以在目标系统上执行任意命令，从而控制系统。

**项目地址:** [nanwinata/CVE-2024-3400](https://github.com/nanwinata/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #24

**来源**: [CVE-2024-3400-pwnj0hn_CVE-2024-3400.md](../2024/CVE-2024-3400-pwnj0hn_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码。

**影响版本:** PAN-OS 10.2 (低于10.2.9-h1), PAN-OS 11.0 (低于11.0.4-h1), PAN-OS 11.1 (低于11.1.2-h3)

**利用条件:** 需要目标设备配置了GlobalProtect网关或门户，且攻击者可以访问GlobalProtect服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建导致了命令注入。未经身份验证的远程攻击者可以通过利用此漏洞，以 root 权限在防火墙上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。漏洞库信息明确指出存在利用此漏洞的攻击，并且公开了PoC。提供的代码尝试创建一个文件，然后检查文件是否成功创建，以确认漏洞是否存在。搜索结果中也提到了该漏洞正在被积极利用。

**投毒风险：**
该PoC代码主要功能是检测目标是否存在漏洞，通过构造特殊的Cookie，尝试在目标服务器上创建文件。代码本身相对简单，主要使用了`requests`库发送HTTP请求，未发现明显的恶意行为。主要风险可能在于：
1.  **误报风险：**  PoC可能因为网络环境或其他因素导致误报。
2.  **资源消耗：**  如果大规模扫描，可能会对目标设备造成一定的资源消耗。
3.  **依赖风险：**  依赖requests库，如果该库被篡改，可能存在风险。

该PoC本身进行恶意操作的可能性很低，因此投毒风险较低，大约为 5%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含特殊路径的Cookie，发送到受影响的PAN-OS设备的GlobalProtect服务。
2.  **任意文件创建：** 恶意Cookie中的路径被用于创建任意文件。
3.  **命令注入：** 由于文件创建过程中的不当处理，攻击者可以在文件名中注入操作系统命令。
4.  **代码执行：** 操作系统命令以root权限执行，从而允许攻击者完全控制受影响的设备。

简单来说，利用方式就是通过发送特制的HTTP请求，在目标设备上创建任意文件，进而执行任意命令。

**项目地址:** [pwnj0hn/CVE-2024-3400](https://github.com/pwnj0hn/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #25

**来源**: [CVE-2024-3400-retkoussa_CVE-2024-3400.md](../2024/CVE-2024-3400-retkoussa_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以利用此漏洞在防火墙上以 root 权限执行任意代码。

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标PAN-OS设备配置了 GlobalProtect gateway 或 GlobalProtect portal (或两者)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 中的一个命令注入漏洞。由于任意文件创建漏洞，未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上执行任意代码，获得 root 权限。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞是真实存在的，并且已经被野外利用。提供的 PoC 代码旨在验证漏洞的存在。该PoC通过构造包含恶意路径的 SESSID Cookie，结合`/ssl-vpn/hipreport.esp`接口，尝试在`/var/appweb/sslvpndocs/global-protect/portal/images/`目录下创建一个名为`poc.txt`的文件。创建成功后，尝试通过`/global-protect/portal/images/poc.txt`访问该文件。如果返回 HTTP 403 状态码，则表示文件已成功上传，验证了漏洞的存在。由于脚本自动尝试HTTPS，且可以上传文件，初步判断提供的PoC代码是有效的。

**投毒风险分析：**

查看提供的PoC脚本，脚本主要功能是发送两个 HTTP 请求来验证漏洞的存在。第一个 POST 请求设置了一个包含目录遍历的 Cookie，目的是在特定目录下创建文件。第二个 GET 请求检查文件是否成功创建。脚本没有明显的恶意行为，例如植入后门或收集信息。尽管如此，仍然存在一定的投毒风险，例如：

*   **依赖项风险：** 脚本使用了 `requests` 库，如果该库被恶意篡改，可能导致安全问题。
*   **代码执行风险：** 虽然脚本本身看起来无害，但攻击者可能修改脚本，例如添加反向 shell 或其他恶意功能。考虑到代码简洁，功能单一，判定脚本投毒可能性为10%。

**利用方式总结：**

1.  **漏洞触发：** 攻击者发送特制的 HTTP 请求到受影响的 PAN-OS 设备的 GlobalProtect 接口。该请求包含恶意的 SESSID Cookie，利用目录遍历和任意文件创建漏洞。
2.  **命令注入：** 通过创建的文件执行操作系统命令。
3.  **权限提升：** 由于 GlobalProtect 组件以 root 权限运行，攻击者可以获得 root 权限。
4.  **最终影响：** 攻击者可以完全控制受影响的防火墙，包括读取敏感信息、修改配置、安装恶意软件等。

**缓解措施：**

*   立即升级到已修复的 PAN-OS 版本。
*   应用威胁防御签名 (Threat IDs 95187, 95189, and 95191)。
*   将漏洞保护应用于 GlobalProtect 接口。

**项目地址:** [retkoussa/CVE-2024-3400](https://github.com/retkoussa/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #26

**来源**: [CVE-2024-3400-schooldropout1337_CVE-2024-3400.md](../2024/CVE-2024-3400-schooldropout1337_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统配置了GlobalProtect gateway或GlobalProtect portal，且运行受影响的PAN-OS版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞。该漏洞源于任意文件创建，允许未经身份验证的远程攻击者在防火墙上以root权限执行任意代码。

**有效性分析：**

*   漏洞库信息明确指出该漏洞影响特定版本的PAN-OS，并且Palo Alto Networks已经意识到有越来越多的攻击利用此漏洞。同时，第三方已经公开了PoC。
*   搜索引擎结果也显示，该漏洞已被广泛关注，并有相关的威胁情报和检测方法发布。
*   提供的PoC代码包含一个Bash脚本和一个Nuclei模板，可以用于验证漏洞的存在。

**利用方式：**

1.  **0-Byte File Creation (CVE-2024-3400.sh):**
    *   攻击者使用`curl`命令向目标服务器的`/ssl-vpn/hipreport.esp`发送一个POST请求，并在Cookie中设置`SESSID`为恶意路径，尝试在`/var/appweb/sslvpndocs/global-protect/portal/images/`目录下创建一个0字节的`CVE20243400.txt`文件。
    *   脚本验证文件是否成功创建，如果服务器返回200 OK，则认为创建成功。
    *   然后，脚本尝试访问创建的文件，如果服务器返回403 Forbidden，则表明目标服务器存在漏洞。

2.  **OS Command Injection (CVE20243400.yaml):**
    *   该Nuclei模板使用多个POST请求，在Cookie中设置恶意的`SESSID`值，目标路径为`/../../../opt/panlogs/tmp/device_telemetry/minute/`，通过命令注入执行`curl`命令，将目标系统的`uname`或`hostname`信息发送到攻击者的`interactsh`服务器，从而验证是否存在命令注入漏洞。

**投毒风险分析：**

虽然提供的代码主要目的是为了验证漏洞，但仍然存在轻微的投毒风险：

*   **依赖外部资源:** Nuclei模板依赖于攻击者控制的`interactsh`服务器。如果攻击者恶意地将`interactsh`配置为执行某些恶意操作（比如记录受害者的IP地址并进行后续攻击），则可能存在风险。此风险评估为10%。
*   **脚本下载:**  虽然本分析直接提供了漏洞利用脚本内容，但在实际情况中，攻击者可能提供脚本下载链接，如果脚本被篡改，则可能存在风险。

**总结：**

提供的PoC代码是有效的，可以用于验证CVE-2024-3400漏洞。利用方式主要是通过构造恶意的HTTP请求，利用任意文件创建漏洞实现命令注入，从而在目标系统上执行任意代码。 尽管代码本身主要是漏洞验证，但是仍然存在一些投毒风险，需要谨慎使用。

**项目地址:** [schooldropout1337/CVE-2024-3400](https://github.com/schooldropout1337/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #27

**来源**: [CVE-2024-3400-swaybs_CVE-2024-3400.md](../2024/CVE-2024-3400-swaybs_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (小于10.2.9-h1), 11.0 (小于11.0.4-h1), 11.1 (小于11.1.2-h3)

**利用条件:** 需要目标设备配置了GlobalProtect网关或Portal,并且能通过网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞，源于任意文件创建。攻击者可以利用此漏洞，在未经身份验证的情况下，以root权限在防火墙上执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，此漏洞已经被积极利用，并且有公开的PoC。提供的Python脚本旨在检查防火墙上是否存在漏洞利用的痕迹，而不是直接利用该漏洞。脚本通过Netmiko库连接到防火墙，并执行特定的命令，从而检测是否存在与漏洞相关的日志记录。

**投毒风险：**
提供的代码仓库主要包含一个用于检测漏洞的Python脚本。该脚本使用`netmiko`连接到Palo Alto防火墙，并执行`grep`命令来检查特定的日志模式。其中，`firewall_hosts`、`firewall_username`、`firewall_password`和`command_to_run`都需要用户自行配置。由于脚本的目的是检查漏洞利用痕迹，而不是直接进行漏洞利用，因此投毒风险较低。但用户在使用脚本时，仍需注意脚本的来源和完整性，避免引入恶意代码。

**利用方式：**
根据漏洞库信息和搜索结果，攻击者利用此漏洞的方式可能包括：
1.  利用未授权的任意文件创建漏洞，在目标系统上创建恶意文件。
2.  通过构造特定的请求，触发命令注入，执行任意系统命令。
3.  通过GlobalProtect组件，利用命令注入漏洞，获取root权限。

该漏洞的利用需要特定的PAN-OS版本，以及GlobalProtect网关或Portal的配置。缓解措施包括升级到修复后的PAN-OS版本，或者使用威胁防御签名进行阻止。

**项目地址:** [swaybs/CVE-2024-3400](https://github.com/swaybs/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #28

**来源**: [CVE-2024-3400-sxyrxyy_CVE-2024-3400-Check.md](../2024/CVE-2024-3400-sxyrxyy_CVE-2024-3400-Check.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，允许未经验证的攻击者以 root 权限在防火墙上执行任意代码

**影响版本:** PAN-OS 10.2.0 <= version < 10.2.9-h1, PAN-OS 11.0.0 <= version < 11.0.4-h1, PAN-OS 11.1.0 <= version < 11.1.2-h3

**利用条件:** 需要目标系统配置了 GlobalProtect 网关或门户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞的存在，未经身份验证的攻击者可以通过利用此漏洞在防火墙上以 root 权限执行任意代码。漏洞存在于 PAN-OS 10.2、PAN-OS 11.0 和 PAN-OS 11.1 版本，且必须配置 GlobalProtect 网关或门户。\n\n**漏洞利用方式：**\n1.  攻击者向`/ssl-vpn/hipreport.esp` endpoint 发送 POST 请求。\n2.  POST 请求中包含特制的 Cookie，其中 SESSID 参数被设置为指向恶意文件路径`/../../../var/appweb/sslvpndocs/global-protect/portal/images/sxy.txt`。\n3.  攻击者随后向`/global-protect/portal/images/sxy.txt` 发送 GET 请求，如果服务器返回 403 错误，则表明漏洞存在，且攻击者可以通过构造恶意请求执行任意代码。\n\n**POC代码有效性：**提供的POC代码旨在检测目标是否存在漏洞，通过发送特定的POST和GET请求，验证是否能够访问通常被禁止访问的文件。如果GET请求返回403状态码，则表明目标可能存在漏洞。\n\n**投毒风险分析：**\nPOC代码中存在潜在的投毒风险，主要体现在注释掉的 interactsh 相关代码部分。这段代码的目的是使用 `curl` 命令将目标系统的 `whoami` 命令的输出发送到攻击者的 interactsh 服务器。虽然这段代码当前是被注释掉的，但如果攻击者修改代码，取消注释，并运行，则可能存在以下风险：\n*   **信息泄露:** 将 `whoami` 命令的输出发送到外部服务器可能泄露目标系统的用户名信息。\n*   **命令执行:** 通过 interactsh 反连，可能执行更复杂的恶意命令。\n\n因此，尽管当前代码是检测漏洞，但潜在的风险仍然存在，尤其是对于不熟悉代码的用户，可能在不知情的情况下运行包含恶意代码的变体。所以，我将投毒风险评定为 10%。
此外，代码会尝试获取目标的 SSL 证书信息，这本身不是恶意行为，但可能被攻击者用于指纹识别和进一步攻击。

**缓解措施：**\n*   立即升级到已修复的 PAN-OS 版本，如 PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3 或更高版本。\n*   应用威胁防御签名（Threat IDs 95187, 95189, 和 95191）。\n*   确保 GlobalProtect 接口已应用漏洞保护。

**项目地址:** [sxyrxyy/CVE-2024-3400-Check](https://github.com/sxyrxyy/CVE-2024-3400-Check)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #29

**来源**: [CVE-2024-3400-terminalJunki3_CVE-2024-3400-Checker.md](../2024/CVE-2024-3400-terminalJunki3_CVE-2024-3400-Checker.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未授权攻击者可利用此漏洞以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统需启用 GlobalProtect 网关或门户，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞，源于任意文件创建。未经身份验证的远程攻击者可以通过构造特定的请求，利用此漏洞在受影响的防火墙上以 root 权限执行任意代码。漏洞影响启用了 GlobalProtect 网关或门户的 PAN-OS 10.2、11.0 和 11.1 的特定版本。\n\n**有效性：**\n根据漏洞库信息和搜索结果，CVE-2024-3400 漏洞已被积极利用，并且存在公开可用的PoC。提供的 Python 脚本旨在检查 Palo Alto Networks 设备的 tech support 文件中是否存在 CVE-2024-3400 攻击的迹象，它本身并非利用代码，而是用于检测受害者是否已经被攻击。所以此POC代码不直接体现漏洞的利用,而是在侧面验证漏洞是否被利用,存在一定的有效性。\n\n**投毒风险：**\n提供的Python脚本用于分析日志文件，搜索恶意行为的迹象。该脚本主要功能是解压和搜索指定的日志文件（'md_out.log', 'md_out.log.old', 'gpsvc.log'）中是否存在特定的恶意关键词（'wget', 'bash', 'device_telemetry/minute/', 'unmarshal'）。\n\n*   **投毒点分析：**
    * 脚本本身不包含直接的恶意代码或后门，其主要功能是文件解压和字符串搜索，风险较低。
    *  **误报风险:**  脚本依赖于预定义的`search_terms`列表，如果该列表被篡改，例如添加了常见的正常字符串，可能导致大量的误报，降低脚本的可用性。
    * **依赖库风险:** 脚本依赖于Python的`gzip`和`tarfile`库，如果这些库本身存在漏洞，可能被利用。但这是所有Python脚本的通用风险。
    * **文件路径风险:** 脚本需要用户指定`filepath`变量，如果用户指定了错误的或恶意的`.tar.gz`文件，可能导致脚本分析错误的文件，并给出错误的结论。
    * **代码缺陷:** return使用不当,会导致未能完全检查文件。\n\n总的来说，该脚本的投毒风险较低，主要的风险在于被篡改的`search_terms`列表可能导致误报。因此，投毒风险评估为10%。\n\n**利用方式：**\n根据漏洞描述和搜索结果，攻击者利用 CVE-2024-3400 的方式如下：\n1.  **构造恶意请求：**  攻击者构造包含恶意命令的特定请求，发送到启用了 GlobalProtect 的 PAN-OS 设备。\n2.  **利用任意文件创建漏洞：**  该请求触发了 PAN-OS 中的任意文件创建漏洞，允许攻击者在系统上创建恶意文件。\n3.  **命令注入：**  创建的恶意文件被执行，从而实现命令注入，允许攻击者以 root 权限执行任意代码。\n4.  **完全控制：**  成功利用该漏洞后，攻击者可以完全控制受影响的防火墙设备。

**项目地址:** [terminalJunki3/CVE-2024-3400-Checker](https://github.com/terminalJunki3/CVE-2024-3400-Checker)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #30

**来源**: [CVE-2024-3400-tfrederick74656_cve-2024-3400-poc.md](../2024/CVE-2024-3400-tfrederick74656_cve-2024-3400-poc.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，允许未授权的攻击者以root权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3， 并且配置了GlobalProtect网关或门户

**利用条件:** 目标系统需要配置GlobalProtect网关或门户，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞，由于任意文件创建导致。根据Volexity的分析和 Palo Alto Networks 的公告，该漏洞允许未经身份验证的攻击者在防火墙上以 root 权限执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是有效的，并且已经被积极利用。CISA已经将其添加到已知被利用漏洞的目录中。提供的PoC代码通过构造包含目录遍历的 Cookie，尝试访问`/var/appweb/sslvpndocs/global-protect/portal/images/watchtowr.txt`，从而验证漏洞的存在。

**投毒风险：**
此PoC代码本身相对简单，主要用于验证漏洞是否存在。投毒风险较低，估计在10%左右。尽管如此，任何从非官方来源下载的代码都存在潜在风险。用户应仔细审查代码，理解其功能，并在隔离环境中运行。潜在的投毒方式可能包括：

*   **恶意URL重定向：** PoC 中使用的 URL 可能会被更改为指向恶意站点，诱骗用户下载其他恶意软件。
*   **命令注入修改：** 攻击者可能修改 PoC 代码，添加额外的命令注入 payload，在测试时执行恶意操作。

**利用方式：**
1.  **漏洞触发：** 通过构造包含目录遍历的 `SESSID` Cookie，发送到 `/ssl-vpn/hipreport.esp` 路径。
2.  **任意文件创建：** 成功利用后，攻击者可以创建任意文件。
3.  **命令注入：** 利用任意文件创建漏洞，执行任意操作系统命令，最终获得 root 权限。

总体而言，该漏洞影响严重，利用方式简单，已经出现公开的PoC，建议尽快修复。

**项目地址:** [tfrederick74656/cve-2024-3400-poc](https://github.com/tfrederick74656/cve-2024-3400-poc)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #31

**来源**: [CVE-2024-3400-tk-sawada_IPLineFinder.md](../2024/CVE-2024-3400-tk-sawada_IPLineFinder.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统配置了 GlobalProtect gateway 或 GlobalProtect portal, 且为受影响的 PAN-OS 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞，由于任意文件创建漏洞导致。攻击者可以通过 GlobalProtect 服务，利用此漏洞在防火墙上以 root 权限执行任意代码，无需身份验证。

**漏洞利用方式：**

1.  攻击者利用 GlobalProtect 的未授权访问点，通过构造特定的请求，触发任意文件创建漏洞。
2.  利用任意文件创建漏洞，写入包含恶意命令的文件。
3.  通过命令注入，执行恶意代码，从而控制防火墙。

**提供的漏洞利用代码分析：**

提供的代码 `IPLineFinder.py` **不是直接的漏洞利用代码**。它是一个 Python 脚本，用于在日志文件中查找包含特定 IP 地址的行，并将这些行提取到新的文件中。此脚本的设计目的是用于取证分析，以确定受 CVE-2024-3400 影响的系统是否已被入侵，通过搜索已知的恶意 IP 地址来判断。

**关于投毒风险的分析：**

*   `IPLineFinder.py` 本身：脚本逻辑相对简单，主要功能是搜索和提取日志行。直接的恶意代码注入风险较低。但如果攻击者替换或修改了`ip_addresses` 列表，添加了用于混淆或误导分析的IP地址，则存在投毒风险，使分析人员无法准确识别攻击源头或关联恶意活动。

*   依赖性：该脚本依赖于 Python 标准库 `os`。 虽然标准库的风险较低，但如果脚本在受损环境中执行，则存在被篡改的风险。

*   整体风险评估：考虑到脚本的功能和依赖性，以及攻击者可能的操作，估计投毒风险为 10%。这主要是指攻击者可能篡改 IP 地址列表，来混淆视听。

**搜索引擎结果佐证：**

搜索结果表明，CVE-2024-3400 是一个已在野外被利用的零日漏洞，且存在公开的 POC。Volexity 等安全公司发布了关于如何检测 compromised 设备的报告。CrowdStrike 和 Zscaler 也发布了相关的分析报告。

综上所述，CVE-2024-3400 是一个高危漏洞，可以被远程利用，需要及时修复。提供的脚本 `IPLineFinder.py` 本身不是漏洞利用代码，而是用于入侵检测和取证分析的工具，但存在被投毒的潜在风险，尽管风险较低。

**项目地址:** [tk-sawada/IPLineFinder](https://github.com/tk-sawada/IPLineFinder)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #32

**来源**: [CVE-2024-3400-workshop748_CVE-2024-3400.md](../2024/CVE-2024-3400-workshop748_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，可导致远程代码执行，获取Root权限

**影响版本:** PAN-OS 10.2, 11.0, and 11.1 (特定版本，见漏洞库信息)

**利用条件:** 需要配置GlobalProtect网关或门户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS GlobalProtect功能中的一个命令注入漏洞。攻击者通过在GlobalProtect的特定配置中利用任意文件创建漏洞，可以执行任意代码并获得防火墙上的root权限。该漏洞影响配置了GlobalProtect网关或门户的PAN-OS 10.2、11.0和11.1的特定版本。根据漏洞库信息，受影响的版本包括低于PAN-OS 10.2.9-h1的10.2.x版本，低于PAN-OS 11.0.4-h1的11.0.x版本，以及低于PAN-OS 11.1.2-h3的11.1.x版本。搜索引擎结果显示，该漏洞已被积极利用，且存在公开的PoC代码。提供的漏洞利用代码是Cargo.lock文件，用于Rust项目的依赖管理。虽然该文件本身不包含恶意代码，但由于该项目可能用于漏洞利用，存在作者在其他地方（例如在实际的Rust源代码中，未提供）加入恶意投毒代码的理论风险，但由于Cargo.lock只是锁定版本，直接投毒难度较大，风险较低。漏洞利用方式包括：未经身份验证的攻击者利用GlobalProtect中的漏洞创建任意文件，进而执行操作系统命令。从Volexity的博客文章(webpage 3)来看，检测受损的Palo Alto Networks防火墙设备的方法，从Zscaler的博客文章(webpage 4)来看，存在upstyle后门的技术分析。因此，漏洞的有效性较高，投毒风险较低。

**漏洞利用方式:**

1.  **未授权访问:** 利用未授权访问漏洞进入系统。
2.  **文件创建:**  利用GlobalProtect功能中的漏洞创建任意文件。
3.  **命令注入:**  通过文件创建，注入恶意操作系统命令。
4.  **Root权限获取:**  成功利用后，攻击者获得防火墙的Root权限。


**项目地址:** [workshop748/CVE-2024-3400](https://github.com/workshop748/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #33

**来源**: [CVE-2024-3400-zam89_CVE-2024-3400-pot.md](../2024/CVE-2024-3400-zam89_CVE-2024-3400-pot.md)

# CVE-2024-3400

> 📦 该CVE有 **32** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-3400-0x0d3ad_CVE-2024-3400.md](../2024/CVE-2024-3400-0x0d3ad_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** Palo Alto Networks PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 < 10.2.9-h1, PAN-OS 11.0 < 11.0.4-h1, PAN-OS 11.1 < 11.1.2-h3

**利用条件:** 目标系统配置了GlobalProtect网关或门户，攻击者可以发起网络请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 中的一个命令注入漏洞。该漏洞允许未经身份验证的远程攻击者在受影响的系统上以 root 权限执行任意命令。利用方式是通过向目标服务器的/ssl-vpn/hipreport.esp路径发送特制的HTTP POST请求，并在Cookie头中注入恶意代码。

**有效性分析：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此POC代码是有效的。
  * 漏洞库信息表明该漏洞确实存在，并且有可利用的POC。
  * 搜索结果显示存在大量关于该漏洞的分析和利用的文章。
  * POC代码实现了利用该漏洞执行命令的功能，通过构造包含恶意命令的 Cookie 发送到目标服务器，从而实现远程命令执行。

**投毒风险分析：**
提供的 `exploit.py` 脚本的功能主要是生成并发送包含反弹 shell 命令的 HTTP 请求。代码中没有发现明显的恶意行为或者隐藏的后门代码。脚本的行为是可以预测的，即根据用户输入的 IP 地址和端口，生成反弹 shell 命令，并将其嵌入到 Cookie 中发送给目标服务器。`README.md` 文件也只是描述漏洞信息和使用示例。因此，投毒风险较低，可以判断投毒风险为 0%。

**利用方式分析：**
1.  **漏洞触发点：** GlobalProtect 功能的 `/ssl-vpn/hipreport.esp` 路径。
2.  **攻击向量：** 通过构造恶意的 HTTP Cookie，在 Cookie 中嵌入经过 base64 编码的命令。
3.  **命令注入：**  恶意命令被注入到 Cookie `SESSID` 中，服务器在处理 Cookie 时，未对其中的内容进行充分的验证和过滤，导致命令被执行。
4.  **利用过程：**
    *   攻击者首先需要确定目标系统存在 CVE-2024-3400 漏洞，并且配置了 GlobalProtect 功能。
    *   然后，攻击者运行 `exploit.py` 脚本，输入目标服务器的 IP 地址、攻击者用于接收反弹 shell 的 IP 地址和端口。
    *   脚本会生成一个包含反弹 shell 命令的 HTTP 请求，并将该请求发送到目标服务器的 `/ssl-vpn/hipreport.esp` 路径。
    *   目标服务器在处理该请求时，会执行 Cookie 中的恶意命令，从而建立一个反弹 shell 连接到攻击者的机器上。
    *   攻击者即可通过该反弹 shell 连接控制目标系统。

**项目地址:** [0x0d3ad/CVE-2024-3400](https://github.com/0x0d3ad/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #2

**来源**: [CVE-2024-3400-0xr2r_CVE-2024-3400-Palo-Alto-OS-Command-Injection.md](../2024/CVE-2024-3400-0xr2r_CVE-2024-3400-Palo-Alto-OS-Command-Injection.md)

## CVE-2024-3400 PAN-OS GlobalProtect 任意文件创建导致命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未授权的攻击者可以以root权限执行任意代码

**影响版本:** PAN-OS 10.2（低于10.2.9-h1），PAN-OS 11.0（低于11.0.4-h1），PAN-OS 11.1（低于11.1.2-h3）

**利用条件:** 需要目标系统配置了GlobalProtect网关或GlobalProtect门户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400是一个存在于Palo Alto Networks PAN-OS软件GlobalProtect功能中的任意文件创建导致命令注入漏洞。攻击者可以通过特制的HTTP请求创建任意文件，进而执行任意命令，获得root权限。

**利用方式：**

1.  **漏洞验证：** 首先，攻击者发送一个GET请求到`/global-protect/portal/images/0xr2r.txt`，如果返回404，则表示目标系统不存在此文件，可以继续利用。
2.  **文件创建：** 攻击者发送一个POST请求到`/ssl-vpn/hipreport.esp`，并在Cookie中设置`SESSID`为`/../../../var/appweb/sslvpndocs/global-protect/portal/images/0xr2r.txt`。POST请求的内容可以为空，或者包含一些payload数据，如`user=0xr2r&portal=0xr2r&authcookie=284ad748-7ce2-4753-a39a-aa381b18cf70&domain=0xr2r&computer=0xr2r&client-ip=0xr2r&client-ipv6=0xr2r&md5-sum=0xr2r&gwHipReportCheck=0xr2r`。此操作将在目标系统的指定路径下创建文件`0xr2r.txt`。
3.  **验证文件创建：** 再次发送GET请求到`/global-protect/portal/images/0xr2r.txt`，如果返回403，则表示文件已成功创建。

根据Volexity的分析，该漏洞是由于对`/ssl-vpn/hipreport.esp`的输入验证不足造成的，允许未经身份验证的攻击者创建任意文件。通过创建恶意文件，攻击者可以进一步利用命令注入漏洞执行任意代码。

**有效性：**
提供的POC代码是有效的，它展示了如何利用该漏洞在目标系统上创建任意文件。通过创建文件，可以为进一步的攻击（例如命令注入）奠定基础。

**投毒风险：**
此POC代码中未发现明显的投毒代码。该代码主要展示了如何利用漏洞创建文件。没有发现任何尝试在目标系统上安装后门或执行恶意操作的恶意代码.可以认为投毒风险为0%。但是，应该谨慎对待任何来自不受信任来源的代码，并进行彻底的审查。

**项目地址:** [0xr2r/CVE-2024-3400-Palo-Alto-OS-Command-Injection](https://github.com/0xr2r/CVE-2024-3400-Palo-Alto-OS-Command-Injection)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #3

**来源**: [CVE-2024-3400-AdaniKamal_CVE-2024-3400.md](../2024/CVE-2024-3400-AdaniKamal_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** Palo Alto Networks PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以利用此漏洞以root权限执行任意代码。

**影响版本:** PAN-OS 10.2 (小于 10.2.9-h1), PAN-OS 11.0 (小于 11.0.4-h1), PAN-OS 11.1 (小于 11.1.2-h3)

**利用条件:** 目标系统需要配置GlobalProtect gateway 或 GlobalProtect portal，且是受影响的PAN-OS版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**漏洞评估：**

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 中的一个远程命令执行漏洞。CVSS 评分为 10 分，表明该漏洞非常严重。利用此漏洞，未经身份验证的攻击者可以在受影响的设备上以 root 权限执行任意代码。

**漏洞有效性：**

根据漏洞库信息和搜索结果，CVE-2024-3400 已经被积极利用。漏洞库信息明确指出 Palo Alto Networks 已经意识到越来越多的攻击利用了这个漏洞，并且已经公开了第三方提供的概念验证代码。多个搜索结果也印证了这一点，并提供了关于检测利用尝试和后渗透活动的更多信息。

提供的代码`panos-scanner.py` 是一个版本检测工具，可以帮助确定远程 PAN-OS 目标的软件版本。这个工具本身并不能直接利用该漏洞，但可以用于识别易受攻击的目标。 因此，提供的POC代码不是直接的漏洞利用代码,而只是一个辅助确定目标版本脚本, 需要配合其他的exp利用。

**投毒风险：**

分析 `panos-scanner.py`，此脚本的主要目的是通过发送 HTTP 请求到目标 PAN-OS 设备，并分析返回的 HTTP 头部来确定其版本。脚本中存在以下潜在的投毒风险：

*   **依赖项风险：** 脚本依赖于 `requests` 和 `urllib3` 库。如果这些库被恶意替换，可能导致代码执行或其他恶意行为。
*   **版本表篡改：** 脚本使用 `version-table.txt` 文件来映射日期和 PAN-OS 版本。如果此文件被篡改，可能导致误报或漏报。
*   **请求劫持：** 虽然脚本使用了 `verify=False` 禁用了 SSL 证书验证，但如果攻击者能够劫持网络流量，可以伪造响应，从而欺骗脚本。
*   **参数注入：** 脚本接受命令行参数，例如目标 URL。如果对这些参数没有进行充分的验证，可能会导致命令注入。

考虑到以上因素，以及脚本的主要功能是版本检测，因此，该仓库中存在作者隐藏的投毒代码的可能性较低，估计为 10%。

**利用方式：**

CVE-2024-3400 是一个命令注入漏洞，允许未经身份验证的攻击者在受影响的 PAN-OS 设备上执行任意代码。利用方式通常涉及以下步骤：

1.  **目标识别：** 使用诸如 `panos-scanner.py` 这样的工具或手动分析来识别运行易受攻击的 PAN-OS 版本的设备，并且GlobalProtect 已配置启用。
2.  **漏洞触发：** 向 GlobalProtect 门户或网关发送特制的 HTTP 请求，其中包含恶意命令。由于这是一个任意文件创建导致的命令注入漏洞，攻击者可以通过构造特定的请求，使得 PAN-OS 在文件创建过程中执行恶意命令。
3.  **代码执行：** 成功利用该漏洞后，攻击者可以以 root 权限在防火墙上执行任意代码，例如安装后门、窃取敏感数据或中断服务。

**总结：**

CVE-2024-3400 是一个严重的安全漏洞，需要立即修复。建议受影响的用户尽快升级到 Palo Alto Networks 提供的修复版本。

**项目地址:** [AdaniKamal/CVE-2024-3400](https://github.com/AdaniKamal/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #4

**来源**: [CVE-2024-3400-Chocapikk_CVE-2024-3400.md](../2024/CVE-2024-3400-Chocapikk_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以以root权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标设备配置了GlobalProtect网关或GlobalProtect Portal，且在受影响的PAN-OS版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞，未经身份验证的攻击者可以在启用了 GlobalProtect 的 PAN-OS 防火墙上以 root 权限执行任意代码。

**漏洞利用方式：**

1.  **漏洞点:** 漏洞存在于GlobalProtect组件处理 `hipreport.esp` 请求的过程中。
2.  **攻击方式:** 攻击者通过构造包含目录遍历的恶意`SESSID` cookie发送POST请求到`/ssl-vpn/hipreport.esp` 。目录遍历允许攻击者覆盖或创建Web服务器可访问目录之外的文件。
3.  **命令注入:**  利用目录遍历，攻击者可以在特定位置创建一个文件，其中包含要执行的命令。
4.  **代码执行:** 创建的文件包含的命令会被PAN-OS执行，导致远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果和提供的POC代码，该漏洞是有效的。漏洞库信息明确指出该漏洞已被积极利用，并且存在公开的POC代码。搜索结果也证实了这一点，多个安全厂商发布了关于该漏洞的分析和检测方法。提供的POC代码实现了利用该漏洞进行远程代码执行或漏洞扫描的功能。

**投毒风险分析：**

代码中存在一些潜在的风险，需要进一步人工分析。
1. 脚本依赖于`pwncat-vl`。由于`pwncat`是一个渗透测试工具，引入这个库可能会增加攻击面。检查该库的安全性是必要的。
2.  代码尝试利用socket进行反向shell连接。虽然这是漏洞利用的一部分，但如果脚本被恶意修改，可能会被滥用。
3. 文件名的生成使用uuid，这降低了恶意文件被预测到的可能性，但仍需注意文件创建的位置和内容。

尽管存在上述风险，但从代码的整体结构来看，其主要功能是利用漏洞实现远程代码执行或扫描，没有明显的恶意代码，所以存在一定比例的投毒风险。

**项目地址:** [Chocapikk/CVE-2024-3400](https://github.com/Chocapikk/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #5

**来源**: [CVE-2024-3400-CyberBibs_SOC274---Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400-.md](../2024/CVE-2024-3400-CyberBibs_SOC274---Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400-.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未授权攻击者可利用该漏洞以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统需配置 GlobalProtect gateway 或 portal，无需开启设备遥测

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞。攻击者可以通过构造恶意请求，利用任意文件创建漏洞实现命令注入，最终在防火墙上以 root 权限执行任意代码。

**有效性评估：**

根据漏洞描述和搜索结果，CVE-2024-3400 漏洞是一个严重的安全问题，存在公开可用的 PoC，且已被实际利用。因此，提供的 PoC 代码很可能有效。

**投毒风险评估：**

提供的漏洞利用代码仅包含README.md文件，该文件主要描述了安全分析人员如何检测和响应此漏洞，没有发现任何可以执行的代码。
因此，可以判定该仓库存在作者隐藏的投毒代码的可能性较低，大约为10%， 主要考虑有以下几点原因：
*   **README.md文件：** 该文件详细描述了漏洞的分析、检测和修复过程，更像是一个安全分析报告。
*   **引用外部PoC：** 该文件引用了 GitHub 上另一个 PoC 仓库（`https://github.com/seed1337/CVE-2024-24919-POC/blob/main/exploit.py`），表明作者可能并未自行编写漏洞利用代码，而是使用了公开资源。
*   **缺乏可执行代码：** 提供的文件中没有任何可执行的代码，因此无法直接进行恶意操作。

**利用方式分析：**

1.  **漏洞成因：** 由于GlobalProtect 功能中存在任意文件创建漏洞，导致可以执行系统命令。
2.  **攻击方式：** 攻击者构造特定的 HTTP 请求，该请求包含恶意的 payload， 尝试读取敏感文件（例如 `/etc/shadow`）。
3.  **利用结果：** 成功利用该漏洞可使攻击者在目标系统上以 root 权限执行任意命令。
4.  **修复方案：** 升级到 PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3 及以上版本。

**项目地址:** [CyberBibs/SOC274---Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400-](https://github.com/CyberBibs/SOC274---Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400-)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #6

**来源**: [CVE-2024-3400-CyprianAtsyor_letsdefend-cve2024-3400-case-study.md](../2024/CVE-2024-3400-CyprianAtsyor_letsdefend-cve2024-3400-case-study.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** Palo Alto Networks PAN-OS GlobalProtect

**危害等级:** 高危，未授权远程命令执行，可完全控制防火墙

**影响版本:** PAN-OS 10.2 (小于 10.2.9-h1), 11.0 (小于 11.0.4-h1), 11.1 (小于 11.1.2-h3)

**利用条件:** 存在GlobalProtect网关或Portal配置，且防火墙版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是一个存在于Palo Alto Networks PAN-OS GlobalProtect功能中的命令注入漏洞。该漏洞允许未经身份验证的攻击者在防火墙上以root权限执行任意代码。根据漏洞信息和搜索结果，该漏洞的利用方式是利用特制的SESSID cookie，其中包含经过反引号执行的命令，并利用 `${IFS}` 绕过简单的过滤器。攻击者可以通过 `/global-protect/login.esp` 端点将payload注入，从而创建一个任意文件，导致命令注入。

**漏洞利用有效性：**

从提供的漏洞库信息、搜索结果以及漏洞利用代码来看，该漏洞利用是有效的。漏洞库信息中明确指出“Palo Alto Networks is aware of an increasing number of attacks that leverage the exploitation of this vulnerability”以及“Proof of concepts for this vulnerability have been publicly disclosed by third parties.”，证明该漏洞在野外已被利用且存在可用的PoC。

搜索结果也证实了这一点，例如“CVE-2024-3400 Activity | ThreatLabz” 和 “CVE-2024-3400 PAN-OS Zero-Day: What You Need To...” 都表明该漏洞正在被积极利用。

漏洞利用代码（README.md）中也详细描述了一个真实的攻击案例，包括攻击者使用的payload、C2服务器、以及受影响的端点等，进一步证实了该漏洞的可利用性。

**投毒风险分析：**

提供的漏洞利用代码（README.md）主要是一个事件调查报告和分析，用于检测和响应CVE-2024-3400的攻击尝试。虽然提供了IOC、利用模式和缓解措施，但该文件本身并没有包含恶意代码。

但是，考虑到该漏洞允许远程代码执行，攻击者可能会利用该漏洞部署后门或其他恶意软件。因此，在实际利用PoC进行测试时，需要格外小心，确保在一个隔离的环境中进行，并仔细检查利用过程中产生的任何文件或进程。

根据对代码的分析，投毒风险较低，估计为10%。风险主要来自如果直接复制利用代码而不理解其含义，可能会无意中执行一些不期望的操作，但代码本身没有明显的恶意目的。

**利用方式总结：**

1.  **目标：** 存在GlobalProtect配置的Palo Alto Networks PAN-OS防火墙（版本在受影响范围内）。
2.  **入口点：** `/global-protect/login.esp` 端点。
3.  **攻击载荷：** 特制的 `SESSID` cookie，包含反引号执行的命令，并使用 `${IFS}` 绕过过滤器。
4.  **利用过程：** 攻击者发送包含恶意 `SESSID` 的 HTTP POST 请求到 `/global-protect/login.esp` 端点，触发命令注入。
5.  **结果：** 在防火墙上以 root 权限执行任意命令，例如，下载并执行恶意脚本，建立反向shell等。

**项目地址:** [CyprianAtsyor/letsdefend-cve2024-3400-case-study](https://github.com/CyprianAtsyor/letsdefend-cve2024-3400-case-study)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #7

**来源**: [CVE-2024-3400-HackingLZ_panrapidcheck.md](../2024/CVE-2024-3400-HackingLZ_panrapidcheck.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未授权攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (低于 10.2.9-h1), 11.0 (低于 11.0.4-h1), 和 11.1 (低于 11.1.2-h3)

**利用条件:** 目标系统配置了 GlobalProtect 网关或 Portal

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞的存在，未经身份验证的攻击者可以在具有 root 权限的防火墙上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的PoC。漏洞库信息中提到 “Palo Alto Networks is aware of an increasing number of attacks that leverage the exploitation of this vulnerability. Proof of concepts for this vulnerability have been publicly disclosed by third parties.”
搜索结果中也包含多个威胁情报报告和分析，表明该漏洞的利用已经发生。
提供的代码， `panparse.py`,本身并不是直接的漏洞利用代码，而是一个用于分析 Palo Alto Networks 技术支持文件的 Python 脚本。它旨在帮助安全分析师查找与 CVE-2024-3400 相关的入侵痕迹（IOCs）。此脚本分析日志文件，例如gpsvc.log，sslvpn-access.log 和 nginx 的访问日志，以查找可疑活动。`iocs.txt` 文件包含已知的恶意IP地址，脚本将使用这些IP地址在日志中进行搜索。

因此，提供的PoC代码的有效性在于辅助分析，而不是直接利用漏洞。

**投毒风险分析：**

*   `README.md`：只是一个说明文件，描述了脚本的用途和使用方法，没有投毒风险。
*   `iocs.txt`：包含一个IP地址。虽然可以通过添加额外的恶意IP地址来误导分析，但这不是传统的代码投毒。风险较低。
*   `panparse.py`：Python脚本，分析日志文件。潜在的投毒方式可能包括：
    *   **恶意正则表达式：** 正则表达式如果构造不当，可能导致拒绝服务（ReDoS）攻击。
    *   **文件路径操纵：** 脚本处理文件路径，如果存在路径遍历漏洞，可能导致脚本访问或修改不应访问的文件。
    *   **执行任意命令：** 如果脚本包含执行系统命令的功能（虽然提供的代码中未直接体现，但可以通过构造特定的日志内容来实现），则可能被利用执行恶意命令。
*   **综合评估：** 由于脚本主要是分析日志文件，投毒的直接危害较小，主要集中在误导分析人员或造成拒绝服务。但如果配合精心构造的日志文件，可能存在一定的风险。

整体来看，投毒风险较低，大约为10%。 风险主要来自于被分析的日志内容和脚本本身存在的潜在漏洞，而不是恶意代码。

**利用方式：**

1.  **未授权访问：** 攻击者不需要身份验证即可触发漏洞。
2.  **文件创建：** 漏洞允许攻击者在系统上创建任意文件。
3.  **命令注入：** 通过创建包含恶意代码的文件，攻击者可以利用命令注入漏洞执行任意命令，从而获得 root 权限。
4.  **GlobalProtect配置：** 该漏洞仅影响配置了GlobalProtect网关或Portal的PAN-OS系统。


**项目地址:** [HackingLZ/panrapidcheck](https://github.com/HackingLZ/panrapidcheck)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #8

**来源**: [CVE-2024-3400-Kr0ff_cve-2024-3400.md](../2024/CVE-2024-3400-Kr0ff_cve-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以在防火墙上以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2（低于 10.2.9-h1）、11.0（低于 11.0.4-h1）和 11.1（低于 11.1.2-h3）

**利用条件:** 目标系统需要配置 GlobalProtect 网关或 GlobalProtect 门户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞，未经身份验证的攻击者可以利用此漏洞在受影响的防火墙上以 root 权限执行任意代码。

**有效性：**
提供的 PoC 代码似乎有效。漏洞库信息和搜索结果都表明该漏洞已被积极利用，并且存在公开的 PoC。该PoC代码包含check模块，可以验证目标是否存在漏洞，exploit模块可以执行命令。

**投毒风险：**
该 PoC 代码的投毒风险较低 (0%)。代码相对简单，主要是利用请求进行漏洞验证和利用。没有发现明显的恶意或隐藏行为，例如下载和执行任意二进制文件、修改系统文件或安装后门。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于GlobalProtect组件中，通过构造特殊的HTTP请求触发。该漏洞允许攻击者创建任意文件。
2.  **命令注入：** 攻击者利用任意文件创建漏洞进行命令注入，以执行恶意代码。
3.  **权限提升：** 成功利用该漏洞后，攻击者可以在目标系统上获得 root 权限。

**PoC 利用方式分析：**
*   **check 模块：**  检查目标是否容易受到攻击。
    *   它使用特制的 Cookie 发送 POST 请求到 `/ssl-vpn/hipreport.esp` 端点。Cookie 包含路径遍历序列，旨在访问 web 服务器文档目录之外的文件。
    *   如果请求返回状态代码 200，则脚本会尝试使用不包含 Cookie 的单独 GET 请求来访问服务器上使用 Cookie 值中指定的文件名构造的路径。 如果此 GET 请求返回状态代码 403（禁止），则目标被认为是易受攻击的。
*   **exploit 模块：** 利用漏洞执行命令。
    *   它通过构造带有恶意 Cookie 的HTTP POST请求到 `/ssl-vpn/hipreport.esp` 端点，触发命令执行。Cookie 包含命令注入payload，该payload将执行任意命令。
    *   该脚本使用`${IFS}`绕过空格过滤。
    *   该脚本尝试通过HTTP和HTTPS发送请求。

**缓解措施：**
建议立即升级到 PAN-OS 的固定版本，即使已应用解决方法和缓解措施。 该问题已在 PAN-OS 10.2.9-h1、PAN-OS 11.0.4-h1、PAN-OS 11.1.2-h3 以及所有更高版本的 PAN-OS 中得到修复。

**项目地址:** [Kr0ff/cve-2024-3400](https://github.com/Kr0ff/cve-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #9

**来源**: [CVE-2024-3400-MurrayR0123_CVE-2024-3400-Compromise-Checker.md](../2024/CVE-2024-3400-MurrayR0123_CVE-2024-3400-Compromise-Checker.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未授权的攻击者可以以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2 (低于 10.2.9-h1), PAN-OS 11.0 (低于 11.0.4-h1), PAN-OS 11.1 (低于 11.1.2-h3)

**利用条件:** 需要目标系统配置了 GlobalProtect 网关或 GlobalProtect 门户，无需启用设备遥测。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞，源于任意文件创建漏洞。未经身份验证的攻击者可以利用此漏洞在防火墙上以 root 权限执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开可用的 PoC。提供的 `cve-2024-3400_checker.sh` 脚本并非直接的漏洞利用代码，而是用于检测目标系统是否已经被入侵，该脚本通过检查web服务器日志、恶意文件和可疑的计划任务等方式进行检测。

**投毒风险：**
该脚本本身旨在检测漏洞利用后的痕迹，而非利用漏洞。虽然脚本本身不会直接执行恶意操作，但仍有很小的风险：
*   **误报：** 脚本可能会因为某些特征与恶意行为相似而产生误报，导致不必要的恐慌。
*   **信息泄露：** 脚本运行时会读取系统日志和配置文件，如果脚本被恶意修改，可能会泄露敏感信息。
因此，投毒风险估计为 10%。

**利用方式：**
根据漏洞信息描述和搜索结果，攻击者利用此漏洞通常涉及以下步骤：
1.  **利用任意文件创建漏洞：** 攻击者首先利用漏洞在目标系统上创建任意文件。
2.  **命令注入：**  通过精心构造的文件内容，攻击者可以注入恶意命令。
3.  **以 root 权限执行代码：** 注入的命令以 root 权限执行，攻击者从而完全控制受影响的系统。

根据Volexity的分析报告，攻击者可能还会使用Upstyle后门进行持久化控制。
检测脚本中的检测点也反映了这些攻击特征，例如检测`/var/lib/python3.6/site-packages/system.pth`中是否包含base64编码的恶意代码，以及检查/tmp目录下是否存在创建GlobalProtect相关目录或下载执行恶意脚本的行为。


**项目地址:** [MurrayR0123/CVE-2024-3400-Compromise-Checker](https://github.com/MurrayR0123/CVE-2024-3400-Compromise-Checker)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #10

**来源**: [CVE-2024-3400-Ravaan21_CVE-2024-3400.md](../2024/CVE-2024-3400-Ravaan21_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 任意文件创建导致命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，允许未授权的攻击者以root权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统需要配置GlobalProtect网关或门户，且未应用漏洞补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞。该漏洞源于任意文件创建，可能允许未经身份验证的攻击者在防火墙上以root权限执行任意代码。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的POC。
提供的Python和Rust版本的POC代码尝试利用该漏洞来检测目标系统是否存在漏洞。POC代码通过发送特制的HTTP请求到目标系统的GlobalProtect接口，尝试创建或访问特定文件。如果成功，则认为系统易受攻击。

**投毒风险分析：**

查看提供的Python和Rust POC代码，未发现明显的恶意或投毒代码。这些代码的主要目的是验证漏洞的存在，而非植入后门或执行恶意操作。

*   Python 代码：`/tmp/b413b80758a8cc351e9d0e6068c08cc3/CVE-2024-3400.py` 使用 `requests` 库发送 HTTP 请求，检查目标是否易受攻击，并将易受攻击的IP地址写入`vuln.txt`。这部分代码没有发现任何投毒行为。
*   Rust 代码：`/tmp/b413b80758a8cc351e9d0e6068c08cc3/src/main.rs` 的功能与 Python 版本类似，使用 `reqwest` 库发送 HTTP 请求，并将易受攻击的 IP 地址写入`vuln.txt`。同样，没有发现恶意代码。

因此，投毒风险评估为0%。

**利用方式：**

1.  **漏洞触发：** 攻击者发送特制的HTTP请求到目标系统的GlobalProtect接口，请求包含恶意构造的文件路径，导致服务器尝试创建或访问该文件。
2.  **命令注入：** 由于输入验证不当，恶意文件路径中的特殊字符被解释为命令，导致系统执行攻击者指定的任意代码。
3.  **权限提升：** 该漏洞允许攻击者以root权限执行代码，从而完全控制受影响的防火墙。

**缓解措施：**

*   立即升级到PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3或更高版本。
*   如果无法立即升级，可以应用威胁防御签名95187、95189和95191（在应用程序和威胁内容版本8836-8695及更高版本中可用）来阻止攻击。

**项目地址:** [Ravaan21/CVE-2024-3400](https://github.com/Ravaan21/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #11

**来源**: [CVE-2024-3400-Rohith-Reddy-Y_Zero-Day-Vulnerability-Exploitation-Detection-Tool.md](../2024/CVE-2024-3400-Rohith-Reddy-Y_Zero-Day-Vulnerability-Exploitation-Detection-Tool.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以利用此漏洞在防火墙上以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2（低于 10.2.9-h1）、PAN-OS 11.0（低于 11.0.4-h1）和 PAN-OS 11.1（低于 11.1.2-h3）

**利用条件:** 需要目标系统配置了 GlobalProtect 网关或 GlobalProtect 门户（或两者）。设备不需要启用 telemetry。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。该漏洞源于任意文件创建，攻击者可以利用它来执行任意命令。该漏洞影响配置了 GlobalProtect 网关或门户的特定 PAN-OS 版本。\n\n**有效性：**\n根据漏洞库信息、搜索结果（如ihebski/CVE-2024-3400在github上存在）表明存在公开可用的PoC，以及Volexity和Palo Alto Networks官方的威胁报告，确认该漏洞已被积极利用，因此该漏洞利用代码有效性较高。\n\n**投毒风险：**\n提供的漏洞利用代码是一个“Zero-Day Vulnerability Exploitation Detection Tool”，旨在 *检测* 而非 *利用* 漏洞。该工具使用 AI/ML 技术分析网络流量以检测异常模式，从而预测和阻止零日攻击。但仓库包含AI检测模型，有较大概率存在作者隐藏的后门代码，存在一定的投毒风险。\n\n**利用方式：**\n根据CVE描述，以及搜索结果，可以总结出以下利用方式：\n1.  **利用 GlobalProtect 功能中的任意文件创建漏洞。**\n2.  **通过精心构造的请求，在目标系统上创建恶意文件。**\n3.  **利用创建的文件执行命令注入，从而在防火墙上以 root 权限执行任意代码。**

**项目地址:** [Rohith-Reddy-Y/Zero-Day-Vulnerability-Exploitation-Detection-Tool](https://github.com/Rohith-Reddy-Y/Zero-Day-Vulnerability-Exploitation-Detection-Tool)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #12

**来源**: [CVE-2024-3400-W01fh4cker_CVE-2024-3400-RCE-Scan.md](../2024/CVE-2024-3400-W01fh4cker_CVE-2024-3400-RCE-Scan.md)

## CVE-2024-3400-PAN-OS-命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，允许未授权的攻击者以root权限执行任意代码

**影响版本:** PAN-OS 10.2, 11.0, 和 11.1（特定版本）

**利用条件:** 需要目标系统配置了GlobalProtect网关或门户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞。该漏洞源于任意文件创建，允许未经身份验证的攻击者在防火墙上以 root 权限执行任意代码。该漏洞影响配置了 GlobalProtect 网关或门户的特定 PAN-OS 版本（10.2.0 < 10.2.9-h1, 11.0.0 < 11.0.4-h1, 11.1.0 < 11.1.2-h3）。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的PoC代码，因此提供的PoC代码很可能有效。

**利用方式：**

1.  **利用入口：** 漏洞存在于PAN-OS的GlobalProtect功能中，需要目标开启GlobalProtect网关或者GlobalProtect门户。
2.  **漏洞触发：** 通过构造包含恶意命令的特殊Cookie，利用`/ssl-vpn/hipreport.esp`接口触发漏洞。
3.  **命令注入：** Cookie中的命令经过base64编码，然后在服务器端解码并执行。
4.  **任意文件创建：** 攻击者可以利用命令注入创建任意文件，例如，将敏感信息（如running-config.xml）写入到Web可访问的目录。
5.  **远程代码执行：** 成功利用漏洞后，攻击者可以以 root 权限在防火墙上执行任意代码。

**PoC代码分析：**

PoC代码的工作流程如下：

1.  **生成随机字符串：** 用于创建唯一的文件名。
2.  **构造恶意Cookie：**  Cookie中包含一个经过Base64编码的命令，该命令使用`tar`命令将`/opt/pancfg/mgmt/saved-configs/running-config.xml`文件压缩到`/var/appweb/sslvpndocs/global-protect/portal/js/jquery.{filename}.js`。利用`SESSID=/../../../opt/panlogs/tmp/device_telemetry/minute/`来进行目录穿越，从而达到任意文件创建的目的。
3.  **发送POST请求：** 向`/ssl-vpn/hipreport.esp`发送包含恶意Cookie的POST请求。
4.  **验证利用结果：** 检查是否可以访问`/global-protect/portal/js/jquery.{filename}.js`，如果可以访问，则表明漏洞利用成功。

**投毒风险分析：**

PoC代码的主要功能是验证漏洞是否存在，并将running-config.xml文件复制到Web可访问的目录。由于PoC需要在目标系统上执行命令，因此存在一定的投毒风险。例如，作者可能在编码的命令中添加恶意代码，导致执行`rm -rf /`或者反弹shell等恶意行为，当然，这部分命令是直接可见的，可以审计出来。

**投毒风险评估：**

代码中存在创建文件，读取配置文件的操作，这些操作本身可能被利用于进行恶意活动，比如替换文件内容、窃取配置文件中的密钥等敏感信息。但是，代码中利用的命令注入点以及创建和读取的行为都是漏洞利用本身所需要的，因此不能完全确定是作者有意为之的投毒行为。投毒风险评估为10%。

**项目地址:** [W01fh4cker/CVE-2024-3400-RCE-Scan](https://github.com/W01fh4cker/CVE-2024-3400-RCE-Scan)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #13

**来源**: [CVE-2024-3400-XiaomingX_CVE-2024-3400-poc.md](../2024/CVE-2024-3400-XiaomingX_CVE-2024-3400-poc.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可利用此漏洞以 root 权限在防火墙上执行任意代码

**影响版本:** PAN-OS 10.2 (低于 10.2.9-h1), PAN-OS 11.0 (低于 11.0.4-h1), PAN-OS 11.1 (低于 11.1.2-h3)

**利用条件:** 需要配置 GlobalProtect 网关或 GlobalProtect 门户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞，由于任意文件创建漏洞导致。未经身份验证的攻击者可以利用此漏洞在受影响的防火墙上以 root 权限执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已经被积极利用，并且已经有公开的 POC 代码。

**投毒风险：**
提供的漏洞利用代码只是 Apache 2.0 许可协议的文本，无法用于分析投毒风险。因此，从现有信息无法判断该代码库中是否存在投毒代码。考虑到漏洞的严重性和广泛利用的情况，应谨慎对待任何来源不明的漏洞利用代码。

**利用方式：**
1.  **漏洞入口：**  GlobalProtect 的特定功能（网关或门户）。
2.  **根本原因：**  由于任意文件创建导致的命令注入漏洞。
3.  **攻击过程：**  攻击者利用漏洞在系统上创建恶意文件，该文件包含恶意命令。
4.  **权限提升：**  由于命令注入以 root 权限执行，攻击者可以完全控制受影响的防火墙。
5.  **影响：**  完全控制防火墙，可能导致数据泄露、服务中断、横向移动等。

**缓解措施：**
*   立即升级到已修复的 PAN-OS 版本（10.2.9-h1、11.0.4-h1、11.1.2-h3 及更高版本）。
*   使用威胁防御订阅来阻止针对此漏洞的攻击（威胁 ID 95187、95189 和 95191）。
*   确保已将漏洞保护应用于 GlobalProtect 接口。

根据搜索结果，CISA 已将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞正在被广泛利用。

**项目地址:** [XiaomingX/CVE-2024-3400-poc](https://github.com/XiaomingX/CVE-2024-3400-poc)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #14

**来源**: [CVE-2024-3400-ZephrFish_CVE-2024-3400-Canary.md](../2024/CVE-2024-3400-ZephrFish_CVE-2024-3400-Canary.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以以 root 权限在防火墙上执行任意代码。

**影响版本:** PAN-OS 10.2 (低于 10.2.9-h1), PAN-OS 11.0 (低于 11.0.4-h1), PAN-OS 11.1 (低于 11.1.2-h3)

**利用条件:** 需要目标系统配置了 GlobalProtect gateway 或 GlobalProtect portal (或两者)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞，未经身份验证的攻击者可以利用此漏洞在受影响的防火墙上以 root 权限执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞 CVSS 评分高达 10.0，已被积极利用。提供的 PoC 代码尝试通过设置包含恶意命令的 `SESSID` cookie 来利用该漏洞。恶意命令使用 `curl` 和 `base64` 下载并执行来自 `kgezdr4fafaval55y8t2w9up.canarytokens.com` 的 shell 脚本。此行为符合命令注入漏洞的特征，因此 PoC 代码可能有效。

**投毒风险分析：**

PoC 代码本身不包含明显的投毒代码，其主要功能是利用漏洞执行命令。但是，需要注意的是，PoC 代码从外部 URL (`kgezdr4fafaval55y8t2w9up.canarytokens.com`) 下载并执行 shell 脚本。这意味着攻击者可以通过控制此 URL 来投放恶意代码。由于该URL属于canarytokens.com，该网站提供的token会发送警报，因此不太可能是恶意网址, 投毒风险较低，但依然存在。因此，风险评估百分比为10%。

**利用方式分析：**

1.  **漏洞点：** GlobalProtect 的登录页面 (`/global-protect/login.esp`)。
2.  **攻击方式：** 通过设置 `SESSID` cookie 注入恶意命令。Cookie 的值被设置为包含操作系统命令的字符串，这些命令会尝试下载并执行远程 shell 脚本。
3.  **命令执行：** 注入的命令使用 `curl` 和 `base64` 从指定 URL 下载 base64 编码的 shell 脚本，解码后通过 `bash` 执行。
4.  **权限提升：** 由于漏洞是在 PAN-OS 中利用的，且具有 root 权限执行代码的能力，因此攻击者可以完全控制受影响的防火墙。
5.  **利用条件：** 目标 PAN-OS 设备需要配置了 GlobalProtect 网关或门户，并且运行的是受影响的版本。

**项目地址:** [ZephrFish/CVE-2024-3400-Canary](https://github.com/ZephrFish/CVE-2024-3400-Canary)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #15

**来源**: [CVE-2024-3400-ak1t4_CVE-2024-3400.md](../2024/CVE-2024-3400-ak1t4_CVE-2024-3400.md)

## CVE-2024-3400 Palo Alto PAN-OS GlobalProtect 任意文件创建导致命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** Palo Alto Networks PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以在防火墙上以 root 权限执行任意代码。

**影响版本:** PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1版本, 小于 PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3

**利用条件:** 目标设备配置了 GlobalProtect 网关或 GlobalProtect 门户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞，该漏洞是由于任意文件创建导致的。未经身份验证的攻击者可以通过向目标系统发送特制的HTTP请求，在特定版本的PAN-OS上，利用GlobalProtect功能写入任意文件，最终导致命令注入，以root权限执行任意代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行受影响PAN-OS版本且配置了GlobalProtect网关或门户的Palo Alto防火墙。
2.  **利用漏洞：** 通过发送包含恶意Cookie的HTTP POST请求到`/ssl-vpn/hipreport.esp`，在`/var/appweb/sslvpndocs/global-protect/portal/images/`目录下创建任意文件。Cookie中包含`SESSID=/../../../var/appweb/sslvpndocs/global-protect/portal/images/${file_here};`，`${file_here}`是要写入的文件名，也是命令注入的关键位置。
3.  **命令执行：**  创建的文件内容可被执行，从而实现命令注入。

**有效性评估：**

根据漏洞描述和漏洞利用代码，该POC代码是有效的。它通过`httpx`工具发送特制的HTTP请求，利用任意文件创建漏洞实现命令注入。脚本首先尝试写入文件，然后验证文件是否成功写入（通过检查HTTP状态码）。

**投毒风险分析：**

该POC代码本身比较简洁，主要利用了`httpx`工具发送恶意请求。潜在的投毒风险在于：

*   **恶意URL列表：** `gp.hosts`文件可能包含指向恶意站点的链接，这些站点可能托管恶意软件或进行其他攻击活动。用户在使用该脚本时，如果使用不可信的URL列表，可能会受到二次攻击。
*   **文件写入位置：** 攻击者可能会修改脚本，将文件写入到更敏感的位置，从而扩大攻击范围。

总体来说，投毒风险较低，约为10%。主要是由于脚本功能较为单一，且依赖于`httpx`工具，恶意代码隐藏的空间有限。但用户仍需谨慎使用，并确保使用可信的URL列表。

**缓解措施：**

*   升级到PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3或更高版本。
*   应用威胁防御签名95187、95189和95191。
*   对GlobalProtect接口应用漏洞保护。

**项目地址:** [ak1t4/CVE-2024-3400](https://github.com/ak1t4/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #16

**来源**: [CVE-2024-3400-andrelia-hacks_CVE-2024-3400.md](../2024/CVE-2024-3400-andrelia-hacks_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码。

**影响版本:** PAN-OS 10.2（低于10.2.9-h1），PAN-OS 11.0（低于11.0.4-h1），PAN-OS 11.1（低于11.1.2-h3）。仅影响配置了GlobalProtect网关或GlobalProtect门户的防火墙。

**利用条件:** 目标系统需启用GlobalProtect门户或网关功能，且为受影响的PAN-OS版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是一个Palo Alto Networks PAN-OS中GlobalProtect功能存在的任意文件创建导致的操作系统命令注入漏洞。未经身份验证的攻击者可以通过构造恶意请求，在受影响的系统上以root权限执行任意代码。

**漏洞利用有效性：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判定此漏洞利用是有效的。漏洞库信息显示Palo Alto Networks已知存在利用此漏洞的攻击，并且第三方已公开PoC。搜索结果也证实了该漏洞已被积极利用。

**投毒风险分析：**

PoC代码主要包含以下几个文件：

*   `LICENSE`：MIT许可证，表明作者允许自由使用、复制、修改和分发代码。
*   `README.md`：包含漏洞的描述、使用方法、依赖说明和参考链接。使用说明指示如何扫描目标并提取配置文件。
*   `get_data.py`：该脚本从`confirmed_rce.log`文件中读取目标URL，然后使用多线程下载文件。下载的文件存储在`out/`目录下。
*   `run.py`：此脚本用于扫描目标，尝试利用该漏洞。它创建一个随机的文件名，并构造一个命令来打包`/opt/pancfg/mgmt/saved-configs/running-config.xml`文件，并将其保存在`/var/appweb/sslvpndocs/global-protect/portal/js/`目录下，这个目录是GlobalProtect Portal的js文件目录。

风险评估：

1.  **依赖安装：** `README.md`中要求安装`rich`库，这本身是相对安全的，但是从非官方源安装包则存在一定的风险。
2.  **目标文件获取：** `get_data.py`从`confirmed_rce.log`读取URL并下载文件。如果`confirmed_rce.log`被篡改，可能导致下载恶意文件。
3.  **命令构造：**  `run.py`构造的命令会将配置文件打包并放置到Web可访问目录，从而泄露敏感信息，例如管理员密码哈希等。攻击者可以利用这些信息进行进一步的攻击。

投毒风险：
代码本身看起来是合法的PoC，用于检测和利用CVE-2024-3400漏洞。但是，存在一些潜在的投毒风险，例如：
* 如果攻击者修改了`run.py`脚本，使其执行恶意命令，例如删除文件或安装后门，则可能造成更大的危害。但是目前看到的脚本仅仅是把配置文件导出来，风险较小。
*  如果依赖项`rich`被恶意版本替换，也可能导致代码执行过程中出现问题。

虽然存在上述风险，但考虑到PoC的主要功能是利用漏洞，而不是直接执行恶意操作，因此投毒的概率较低。此外，该PoC仅用于`get_data.py`下载文件，以及`run.py`产生exp，因此，这里的**投毒概率大概在10%**左右。

**漏洞利用方式：**

1.  **确定目标：** 攻击者首先需要确定存在漏洞的PAN-OS防火墙，这些防火墙启用了GlobalProtect门户或网关功能，并且运行着受影响的PAN-OS版本。
2.  **发送恶意请求：** 攻击者发送特制的HTTP请求，其中包含用于创建任意文件的命令注入代码。`run.py`文件展示了如何通过base64编码的命令，利用`tar`命令将敏感配置文件`/opt/pancfg/mgmt/saved-configs/running-config.xml`打包到Web可访问目录中。
3.  **执行任意代码：**  由于文件创建过程存在漏洞，攻击者可以将恶意代码注入到创建的文件中，或者利用文件创建来执行操作系统命令。通过将打包好的配置文件放置在web目录，攻击者可以下载这些文件。
4.  **权限提升：**  由于命令注入是以root权限执行的，攻击者可以完全控制受影响的系统，包括安装后门、窃取数据或破坏系统。
5.  **提取敏感信息：** 攻击者可以通过`get_data.py`下载配置文件，获取敏感信息。

总而言之，该漏洞的利用过程涉及发送恶意请求，利用任意文件创建漏洞执行命令注入，最终实现远程代码执行和权限提升。

**项目地址:** [andrelia-hacks/CVE-2024-3400](https://github.com/andrelia-hacks/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #17

**来源**: [CVE-2024-3400-codeblueprint_CVE-2024-3400.md](../2024/CVE-2024-3400-codeblueprint_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未授权的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (< 10.2.9-h1), 11.0 (< 11.0.4-h1), 11.1 (< 11.1.2-h3)

**利用条件:** 需要目标设备配置了GlobalProtect网关或GlobalProtect Portal，并且漏洞版本在影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞，未经身份验证的攻击者可以在具有 root 权限的防火墙上执行任意代码。

**有效性评估：**

提供的 Python POC 代码 `/tmp/0de44055d5df69da649501894bfd0c34/CVE-2024-3400_upload_check.py` 尝试通过在 `/var/appweb/sslvpndocs/global-protect/portal/images/` 目录下上传一个随机命名的 `.txt` 文件来验证漏洞的存在。该脚本首先检查目标是否存在，然后尝试上传文件，并通过检查文件是否存在来验证上传是否成功。搜索引擎结果和漏洞库信息表明该漏洞确实存在，并且有公开可用的 PoC。

**投毒风险评估：**

分析提供的代码后，投毒风险较低。该脚本主要用于验证目标是否存在漏洞，而不是执行恶意操作。唯一可能需要注意的是，该脚本会在目标文件系统上创建一个测试文件，但脚本本身提供了删除该文件的说明。

*   代码逻辑较为简单，主要功能是上传和检查文件，没有发现明显的恶意行为。
*   脚本需要用户手动输入目标 URL，降低了大规模自动化攻击的风险。
*   脚本的目的是验证漏洞存在，而不是利用漏洞执行恶意操作。
*  存在非常低的风险：脚本在成功上传后，提示用户手动删除上传的文件。如果攻击者利用此脚本，但没有清除测试文件，可能会留下痕迹，但这不是恶意投毒，而是利用不当的副作用。

综合考虑，该 POC 代码的投毒风险约为 5%。

**利用方式：**

1.  **漏洞原理：** 该漏洞是由于 PAN-OS GlobalProtect 在处理特定请求时，允许攻击者创建任意文件，进而导致命令注入。具体来说，攻击者可以通过构造包含恶意代码的文件名，并利用 GlobalProtect 的文件处理逻辑来执行系统命令。
2.  **利用步骤：**
    *   攻击者首先需要确定目标 PAN-OS 设备是否配置了 GlobalProtect 并且版本在受影响范围内。
    *   攻击者构造一个包含恶意代码的文件名，例如 `test.txt; <command>`，其中 `<command>` 是要执行的系统命令。
    *   攻击者通过构造特定的 HTTP 请求，将包含恶意代码的文件名传递给 GlobalProtect。
    *   GlobalProtect 在处理该请求时，会尝试创建该文件，由于文件名包含恶意代码，导致系统命令被执行。
3.  **影响：** 成功利用该漏洞后，攻击者可以获得目标设备的 root 权限，从而可以执行任意操作，例如窃取敏感数据、安装后门、篡改系统配置等。

根据漏洞库信息，缓解措施包括升级到修复后的 PAN-OS 版本，或使用威胁防御签名来阻止攻击。

**项目地址:** [codeblueprint/CVE-2024-3400](https://github.com/codeblueprint/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #18

**来源**: [CVE-2024-3400-hahasagined_CVE-2024-3400.md](../2024/CVE-2024-3400-hahasagined_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect Command Injection

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未经身份验证的攻击者可以在防火墙上以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2 (< 10.2.9-h1), 11.0 (< 11.0.4-h1), and 11.1 (< 11.1.2-h3)

**利用条件:** 需要目标PAN-OS设备配置了GlobalProtect网关或GlobalProtect门户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞的存在，未经身份验证的攻击者可以在特定 PAN-OS 版本和配置下，利用此漏洞以 root 权限在防火墙上执行任意代码。

**有效性：**
根据漏洞信息，已经存在公开可用的POC代码，并且该漏洞已被积极利用。搜索结果也表明了这一点，多个安全厂商和研究人员已经发布了关于该漏洞的分析和利用信息，例如Unit 42、Volexity、Zscaler和CrowdStrike。

**投毒风险：**
提供的“漏洞利用代码”实际上是一个IP地址列表（EDL）。虽然看似无害，但如果攻击者将恶意命令注入过程与此列表结合使用，则该列表可以作为攻击基础设施的一部分。此列表本身不包含任何恶意代码，因此直接的“投毒风险”为0%。但是，它可能会被用于后续的攻击活动中，例如建立C&C通信。

**利用方式：**
1.  **任意文件创建：** 攻击者利用 GlobalProtect 功能中存在的漏洞，在目标系统上创建任意文件。
2.  **命令注入：** 攻击者通过构造恶意请求，将恶意命令注入到服务器的操作系统中。
3.  **代码执行：** 注入的命令以 root 权限执行，允许攻击者完全控制受影响的防火墙。例如安装后门。

根据漏洞库信息和搜索结果，成功利用此漏洞需要满足以下条件：
*   目标设备必须运行受影响的 PAN-OS 版本（10.2、11.0 或 11.1）。
*   设备必须配置了 GlobalProtect 网关或 GlobalProtect 门户。

漏洞利用通常涉及发送特制的 HTTP 请求，利用URL中的参数进行命令注入，从而在目标系统上执行任意代码。

**项目地址:** [hahasagined/CVE-2024-3400](https://github.com/hahasagined/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #19

**来源**: [CVE-2024-3400-hashdr1ft_SOC274-Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400.md](../2024/CVE-2024-3400-hashdr1ft_SOC274-Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400.md)

## CVE-2024-3400 - Palo Alto Networks PAN-OS GlobalProtect Command Injection

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (<10.2.9-h1), 11.0 (<11.0.4-h1), 11.1 (<11.1.2-h3)，并配置了GlobalProtect网关或门户

**利用条件:** 需要目标系统运行受影响的PAN-OS版本，并启用了GlobalProtect网关或门户功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞。由于任意文件创建漏洞导致，未经身份验证的远程攻击者可以通过在受影响的设备上创建恶意文件，执行任意代码，从而获得root权限。漏洞影响配置了GlobalProtect网关或门户的PAN-OS 10.2、11.0和11.1的特定版本。根据提供的漏洞利用代码, 可以看到一个SOC分析师利用自动化工具对告警进行分析, 通过分析攻击流量, 恶意IP以及最终日志响应码来判断漏洞是否被利用. 漏洞利用代码分析主要是记录SOC分析过程, 本身没有提供exp代码。投毒风险分析：漏洞利用代码本身是SOC分析过程记录，而非漏洞利用的EXP，本身不具备漏洞利用能力。其中的图片引用可能存在钓鱼风险，例如替换为恶意链接等， 风险较低，因此投毒风险评定为10%。漏洞利用方式：攻击者发送特制的HTTP请求到GlobalProtect的登录页面`/global-protect/login.esp`，利用任意文件创建漏洞，写入包含恶意命令的文件。由于命令注入漏洞的存在，写入的文件中的命令将以root权限执行。根据搜索结果, 此漏洞已经被大规模利用, 并且已经有公开的POC.

**项目地址:** [hashdr1ft/SOC274-Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400](https://github.com/hashdr1ft/SOC274-Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #20

**来源**: [CVE-2024-3400-ihebski_CVE-2024-3400.md](../2024/CVE-2024-3400-ihebski_CVE-2024-3400.md)

## CVE-2024-3400 - Palo Alto Networks PAN-OS GlobalProtect Command Injection

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** Palo Alto Networks PAN-OS (GlobalProtect)

**危害等级:** 高危，未授权的远程代码执行，可获取 root 权限

**影响版本:** PAN-OS 10.2 < 10.2.9-h1, 11.0 < 11.0.4-h1, 11.1 < 11.1.2-h3

**利用条件:** 需要配置 GlobalProtect 网关或门户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞。未经身份验证的攻击者可以通过精心构造的请求，在受影响的设备上以 root 权限执行任意代码。漏洞利用涉及任意文件创建，进而导致命令注入。根据漏洞库信息，存在野外利用，CISA KEV 也收录了该漏洞。

**有效性：** 根据提供的漏洞利用代码和搜索引擎结果，该 POC 代码是有效的。POC 通过构造包含路径遍历的 Cookie，在指定位置创建文件，验证是否存在漏洞。更进一步的RCE利用需要启用Telemetry。

**投毒风险：** 漏洞利用代码主要由一个 YAML 文件 (NUCLEI 模板) 和 README 文件组成。YAML 文件定义了漏洞验证的 HTTP 请求，README 描述了漏洞和利用方法。license文件是MIT开源协议。风险在于，如果攻击者修改 YAML 文件，例如在 POST 请求中添加额外的恶意载荷，就可能存在投毒风险。该仓库本身相对简单，投毒点在于利用方式的描述和 YAML 文件内容，但整体风险较低，预计约为 10%。由于要依赖于 Telemetry 开启才能进一步的RCE利用，所以投毒的价值不大，

**利用方式：**
1.  发送一个包含特殊构造的 `SESSID` Cookie 的 POST 请求到 `/ssl-vpn/hipreport.esp`。Cookie 中的路径遍历用于指定文件创建的位置。
2.  如果存在漏洞，服务器会根据Cookie中的文件名创建文件.
3. 验证思路：尝试访问创建的文件。如果返回 403 状态码（禁止访问），则表示目标存在漏洞，且文件创建成功(文件创建的权限是root权限)。
4. 进一步的RCE,通过Telemetry日志分析与控制，发送含有命令的Cookie进行RCE攻击

**项目地址:** [ihebski/CVE-2024-3400](https://github.com/ihebski/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #21

**来源**: [CVE-2024-3400-iwallarm_cve-2024-3400.md](../2024/CVE-2024-3400-iwallarm_cve-2024-3400.md)

## CVE-2024-3400-PAN-OS-命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未授权的攻击者可以以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (低于10.2.9-h1), 11.0 (低于11.0.4-h1), 11.1 (低于11.1.2-h3)

**利用条件:** 需要配置GlobalProtect网关或GlobalProtect门户的PAN-OS防火墙。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞，由于任意文件创建导致。未经身份验证的攻击者可以利用此漏洞在防火墙上以root权限执行任意代码。漏洞影响配置了GlobalProtect网关或门户的特定PAN-OS版本。从提供的漏洞利用代码来看，它似乎包含一个域名 `cve-2024-3400.org` 和一个 `test` 文件. 利用方式可能涉及在目标系统上创建包含恶意命令的文件，然后通过命令注入执行。关于投毒风险，该POC代码本身较为简洁，主要目的是验证漏洞的存在。但是攻击者可以利用此漏洞植入恶意后门，因此存在一定的投毒风险，可能性评估为10%。根据搜索结果，该漏洞已被广泛利用，CISA也将其列入已知被利用的漏洞目录。

**项目地址:** [iwallarm/cve-2024-3400](https://github.com/iwallarm/cve-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #22

**来源**: [CVE-2024-3400-marconesler_CVE-2024-3400.md](../2024/CVE-2024-3400-marconesler_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 任意文件创建导致命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (低于 10.2.9-h1), 11.0 (低于 11.0.4-h1), 和 11.1 (低于 11.1.2-h3)，且配置了GlobalProtect网关或门户

**利用条件:** 需要目标系统配置了GlobalProtect网关或门户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞，源于任意文件创建。未经身份验证的远程攻击者可以利用此漏洞在受影响的设备上以 root 权限执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以得出结论：该漏洞的PoC代码有效。

*   漏洞库信息显示，Palo Alto Networks 已经意识到有越来越多的攻击利用此漏洞，并且第三方已经公开了PoC。
*   搜索结果中也包含了多个关于CVE-2024-3400的分析文章，以及检测被入侵设备的方法，进一步证实了该漏洞的真实性和可利用性。
*   提供的PoC代码 `cve-2024-3400.py` 实现了利用该漏洞执行命令的功能，包括获取配置文件和执行反弹shell。

**投毒风险分析：**

PoC代码本身相对简单，主要通过构造恶意的SESSID cookie来触发漏洞。投毒风险较低。主要风险点在于：

*   **README.md中的免责声明：** README.md提到“the firewall must be running a vulnerable PAN-OS version and must have telemetry enabled.”,如果使用者忽略此项说明，在非漏洞环境中使用，可能会导致一些非预期行为。 即使此项说明，使用者也有可能没意识到打开telemetry可能带来的风险. *   **Connect-back shell风险：** PoC代码中包含反弹shell的功能，如果攻击者修改反弹shell的IP地址和端口，可以连接到受害者的设备。

**漏洞利用方式：**

1.  **漏洞原理：** 漏洞利用了GlobalProtect功能中对用户输入验证不严格的问题，允许攻击者通过构造恶意的SESSID cookie来创建任意文件，并在创建文件的过程中执行命令注入。
2.  **攻击步骤：**
    *   攻击者构造包含恶意命令的SESSID cookie。
    *   攻击者向目标设备的GlobalProtect登录页面发送请求，并在请求中包含构造的SESSID cookie。
    *   目标设备在处理SESSID cookie时，由于验证不严格，会将cookie中的恶意命令注入到系统中执行。
3.  **PoC代码分析：**
    *   `cve-2024-3400.py` 脚本接受目标主机、攻击类型和反弹shell地址作为参数。
    *   脚本根据攻击类型选择不同的命令。
        *   `getconf`: 复制 `running-config.xml` 到 web 目录，攻击者可以下载配置文件。
        *   `getpanoramaconf`: 复制 `merged-running-config.xml` 到 web 目录，攻击者可以下载panorama合并的配置文件。
        *   `remoteshell`: 启动反弹shell，连接到攻击者指定的IP地址和端口。
    *   脚本将命令进行base64编码，并将其嵌入到SESSID cookie中。
    *   脚本向目标设备发送包含恶意cookie的GET请求。

**总结：**

CVE-2024-3400是一个高危漏洞，利用简单，影响广泛。建议受影响的用户尽快升级到安全版本。

**项目地址:** [marconesler/CVE-2024-3400](https://github.com/marconesler/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #23

**来源**: [CVE-2024-3400-nanwinata_CVE-2024-3400.md](../2024/CVE-2024-3400-nanwinata_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 （未升级到指定hotfix版本）

**利用条件:** 需要目标系统配置了GlobalProtect gateway 或 GlobalProtect portal

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于PAN-OS GlobalProtect功能中存在任意文件创建导致的命令注入漏洞。未经验证的攻击者可以通过向目标服务器发送特制的请求，在目标服务器上创建恶意文件，进而执行任意系统命令，最终获得root权限。漏洞利用代码通过修改Cookie中的`SESSID`参数，指向一个包含命令注入的路径，然后发送POST请求到`/ssl-vpn/hipreport.esp`来触发该漏洞。httpx用于快速扫描目标域名下的活跃主机及端口，Subfinder用于子域名枚举。

**有效性评估：**
根据漏洞信息和漏洞利用代码，该PoC代码是有效的。漏洞库信息明确指出存在公开的PoC，并且漏洞被大规模利用。搜索结果中也包含大量关于该漏洞的分析和利用信息。该PoC代码通过构造恶意的Cookie，利用了任意文件创建的漏洞，实现了命令注入。

**投毒风险分析：**
PoC代码本身的功能是验证漏洞是否存在。代码主要包含以下功能：
1.  **子域名枚举:**  使用`subfinder`工具枚举目标域名的子域名，这本身没有投毒风险，但如果`subfinder`本身被替换成恶意版本，则存在风险。
2.  **活跃主机扫描:** 使用`httpx`工具扫描活跃主机，同样，需要保证`httpx`工具本身的安全性。
3.  **漏洞验证:** 通过构造特殊的Cookie和URI，发送POST请求来验证目标是否存在漏洞。这个过程本身是漏洞利用的一部分，**不是投毒代码**。
4. **临时文件处理**: 代码中会创建和删除临时文件(`temp_domains.txt`)，如果存在恶意修改，可能导致拒绝服务或信息泄露，但可能性较低。

**潜在投毒点分析：**
*   **依赖外部工具:** PoC依赖`subfinder`和`httpx`这两个外部工具。如果这两个工具被恶意版本替换，则存在投毒风险。例如，恶意版本的`subfinder`可能返回错误的子域名，或者`httpx`被修改为执行恶意代码。这种风险的评估概率是10%。

**利用方式：**
1.  **子域名枚举 (可选):** 使用`subfinder`等工具枚举目标域名的子域名。如果已知目标IP地址，则可以跳过此步骤。
2.  **活跃主机扫描:** 使用`httpx`等工具扫描目标子域名的80,443,4443,8443端口，确定哪些主机是活跃的。
3.  **漏洞验证:** 对活跃的主机，构造包含恶意代码的Cookie，发送POST请求到`/ssl-vpn/hipreport.esp`，验证漏洞是否存在。Cookie包含的文件路径指向可以执行命令的位置，从而实现命令注入。
4.  **命令执行:** 成功利用漏洞后，攻击者可以在目标系统上执行任意命令，从而控制系统。

**项目地址:** [nanwinata/CVE-2024-3400](https://github.com/nanwinata/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #24

**来源**: [CVE-2024-3400-pwnj0hn_CVE-2024-3400.md](../2024/CVE-2024-3400-pwnj0hn_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码。

**影响版本:** PAN-OS 10.2 (低于10.2.9-h1), PAN-OS 11.0 (低于11.0.4-h1), PAN-OS 11.1 (低于11.1.2-h3)

**利用条件:** 需要目标设备配置了GlobalProtect网关或门户，且攻击者可以访问GlobalProtect服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建导致了命令注入。未经身份验证的远程攻击者可以通过利用此漏洞，以 root 权限在防火墙上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。漏洞库信息明确指出存在利用此漏洞的攻击，并且公开了PoC。提供的代码尝试创建一个文件，然后检查文件是否成功创建，以确认漏洞是否存在。搜索结果中也提到了该漏洞正在被积极利用。

**投毒风险：**
该PoC代码主要功能是检测目标是否存在漏洞，通过构造特殊的Cookie，尝试在目标服务器上创建文件。代码本身相对简单，主要使用了`requests`库发送HTTP请求，未发现明显的恶意行为。主要风险可能在于：
1.  **误报风险：**  PoC可能因为网络环境或其他因素导致误报。
2.  **资源消耗：**  如果大规模扫描，可能会对目标设备造成一定的资源消耗。
3.  **依赖风险：**  依赖requests库，如果该库被篡改，可能存在风险。

该PoC本身进行恶意操作的可能性很低，因此投毒风险较低，大约为 5%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含特殊路径的Cookie，发送到受影响的PAN-OS设备的GlobalProtect服务。
2.  **任意文件创建：** 恶意Cookie中的路径被用于创建任意文件。
3.  **命令注入：** 由于文件创建过程中的不当处理，攻击者可以在文件名中注入操作系统命令。
4.  **代码执行：** 操作系统命令以root权限执行，从而允许攻击者完全控制受影响的设备。

简单来说，利用方式就是通过发送特制的HTTP请求，在目标设备上创建任意文件，进而执行任意命令。

**项目地址:** [pwnj0hn/CVE-2024-3400](https://github.com/pwnj0hn/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #25

**来源**: [CVE-2024-3400-retkoussa_CVE-2024-3400.md](../2024/CVE-2024-3400-retkoussa_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以利用此漏洞在防火墙上以 root 权限执行任意代码。

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标PAN-OS设备配置了 GlobalProtect gateway 或 GlobalProtect portal (或两者)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 中的一个命令注入漏洞。由于任意文件创建漏洞，未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上执行任意代码，获得 root 权限。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞是真实存在的，并且已经被野外利用。提供的 PoC 代码旨在验证漏洞的存在。该PoC通过构造包含恶意路径的 SESSID Cookie，结合`/ssl-vpn/hipreport.esp`接口，尝试在`/var/appweb/sslvpndocs/global-protect/portal/images/`目录下创建一个名为`poc.txt`的文件。创建成功后，尝试通过`/global-protect/portal/images/poc.txt`访问该文件。如果返回 HTTP 403 状态码，则表示文件已成功上传，验证了漏洞的存在。由于脚本自动尝试HTTPS，且可以上传文件，初步判断提供的PoC代码是有效的。

**投毒风险分析：**

查看提供的PoC脚本，脚本主要功能是发送两个 HTTP 请求来验证漏洞的存在。第一个 POST 请求设置了一个包含目录遍历的 Cookie，目的是在特定目录下创建文件。第二个 GET 请求检查文件是否成功创建。脚本没有明显的恶意行为，例如植入后门或收集信息。尽管如此，仍然存在一定的投毒风险，例如：

*   **依赖项风险：** 脚本使用了 `requests` 库，如果该库被恶意篡改，可能导致安全问题。
*   **代码执行风险：** 虽然脚本本身看起来无害，但攻击者可能修改脚本，例如添加反向 shell 或其他恶意功能。考虑到代码简洁，功能单一，判定脚本投毒可能性为10%。

**利用方式总结：**

1.  **漏洞触发：** 攻击者发送特制的 HTTP 请求到受影响的 PAN-OS 设备的 GlobalProtect 接口。该请求包含恶意的 SESSID Cookie，利用目录遍历和任意文件创建漏洞。
2.  **命令注入：** 通过创建的文件执行操作系统命令。
3.  **权限提升：** 由于 GlobalProtect 组件以 root 权限运行，攻击者可以获得 root 权限。
4.  **最终影响：** 攻击者可以完全控制受影响的防火墙，包括读取敏感信息、修改配置、安装恶意软件等。

**缓解措施：**

*   立即升级到已修复的 PAN-OS 版本。
*   应用威胁防御签名 (Threat IDs 95187, 95189, and 95191)。
*   将漏洞保护应用于 GlobalProtect 接口。

**项目地址:** [retkoussa/CVE-2024-3400](https://github.com/retkoussa/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #26

**来源**: [CVE-2024-3400-schooldropout1337_CVE-2024-3400.md](../2024/CVE-2024-3400-schooldropout1337_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统配置了GlobalProtect gateway或GlobalProtect portal，且运行受影响的PAN-OS版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞。该漏洞源于任意文件创建，允许未经身份验证的远程攻击者在防火墙上以root权限执行任意代码。

**有效性分析：**

*   漏洞库信息明确指出该漏洞影响特定版本的PAN-OS，并且Palo Alto Networks已经意识到有越来越多的攻击利用此漏洞。同时，第三方已经公开了PoC。
*   搜索引擎结果也显示，该漏洞已被广泛关注，并有相关的威胁情报和检测方法发布。
*   提供的PoC代码包含一个Bash脚本和一个Nuclei模板，可以用于验证漏洞的存在。

**利用方式：**

1.  **0-Byte File Creation (CVE-2024-3400.sh):**
    *   攻击者使用`curl`命令向目标服务器的`/ssl-vpn/hipreport.esp`发送一个POST请求，并在Cookie中设置`SESSID`为恶意路径，尝试在`/var/appweb/sslvpndocs/global-protect/portal/images/`目录下创建一个0字节的`CVE20243400.txt`文件。
    *   脚本验证文件是否成功创建，如果服务器返回200 OK，则认为创建成功。
    *   然后，脚本尝试访问创建的文件，如果服务器返回403 Forbidden，则表明目标服务器存在漏洞。

2.  **OS Command Injection (CVE20243400.yaml):**
    *   该Nuclei模板使用多个POST请求，在Cookie中设置恶意的`SESSID`值，目标路径为`/../../../opt/panlogs/tmp/device_telemetry/minute/`，通过命令注入执行`curl`命令，将目标系统的`uname`或`hostname`信息发送到攻击者的`interactsh`服务器，从而验证是否存在命令注入漏洞。

**投毒风险分析：**

虽然提供的代码主要目的是为了验证漏洞，但仍然存在轻微的投毒风险：

*   **依赖外部资源:** Nuclei模板依赖于攻击者控制的`interactsh`服务器。如果攻击者恶意地将`interactsh`配置为执行某些恶意操作（比如记录受害者的IP地址并进行后续攻击），则可能存在风险。此风险评估为10%。
*   **脚本下载:**  虽然本分析直接提供了漏洞利用脚本内容，但在实际情况中，攻击者可能提供脚本下载链接，如果脚本被篡改，则可能存在风险。

**总结：**

提供的PoC代码是有效的，可以用于验证CVE-2024-3400漏洞。利用方式主要是通过构造恶意的HTTP请求，利用任意文件创建漏洞实现命令注入，从而在目标系统上执行任意代码。 尽管代码本身主要是漏洞验证，但是仍然存在一些投毒风险，需要谨慎使用。

**项目地址:** [schooldropout1337/CVE-2024-3400](https://github.com/schooldropout1337/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #27

**来源**: [CVE-2024-3400-swaybs_CVE-2024-3400.md](../2024/CVE-2024-3400-swaybs_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (小于10.2.9-h1), 11.0 (小于11.0.4-h1), 11.1 (小于11.1.2-h3)

**利用条件:** 需要目标设备配置了GlobalProtect网关或Portal,并且能通过网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞，源于任意文件创建。攻击者可以利用此漏洞，在未经身份验证的情况下，以root权限在防火墙上执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，此漏洞已经被积极利用，并且有公开的PoC。提供的Python脚本旨在检查防火墙上是否存在漏洞利用的痕迹，而不是直接利用该漏洞。脚本通过Netmiko库连接到防火墙，并执行特定的命令，从而检测是否存在与漏洞相关的日志记录。

**投毒风险：**
提供的代码仓库主要包含一个用于检测漏洞的Python脚本。该脚本使用`netmiko`连接到Palo Alto防火墙，并执行`grep`命令来检查特定的日志模式。其中，`firewall_hosts`、`firewall_username`、`firewall_password`和`command_to_run`都需要用户自行配置。由于脚本的目的是检查漏洞利用痕迹，而不是直接进行漏洞利用，因此投毒风险较低。但用户在使用脚本时，仍需注意脚本的来源和完整性，避免引入恶意代码。

**利用方式：**
根据漏洞库信息和搜索结果，攻击者利用此漏洞的方式可能包括：
1.  利用未授权的任意文件创建漏洞，在目标系统上创建恶意文件。
2.  通过构造特定的请求，触发命令注入，执行任意系统命令。
3.  通过GlobalProtect组件，利用命令注入漏洞，获取root权限。

该漏洞的利用需要特定的PAN-OS版本，以及GlobalProtect网关或Portal的配置。缓解措施包括升级到修复后的PAN-OS版本，或者使用威胁防御签名进行阻止。

**项目地址:** [swaybs/CVE-2024-3400](https://github.com/swaybs/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #28

**来源**: [CVE-2024-3400-sxyrxyy_CVE-2024-3400-Check.md](../2024/CVE-2024-3400-sxyrxyy_CVE-2024-3400-Check.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，允许未经验证的攻击者以 root 权限在防火墙上执行任意代码

**影响版本:** PAN-OS 10.2.0 <= version < 10.2.9-h1, PAN-OS 11.0.0 <= version < 11.0.4-h1, PAN-OS 11.1.0 <= version < 11.1.2-h3

**利用条件:** 需要目标系统配置了 GlobalProtect 网关或门户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞的存在，未经身份验证的攻击者可以通过利用此漏洞在防火墙上以 root 权限执行任意代码。漏洞存在于 PAN-OS 10.2、PAN-OS 11.0 和 PAN-OS 11.1 版本，且必须配置 GlobalProtect 网关或门户。\n\n**漏洞利用方式：**\n1.  攻击者向`/ssl-vpn/hipreport.esp` endpoint 发送 POST 请求。\n2.  POST 请求中包含特制的 Cookie，其中 SESSID 参数被设置为指向恶意文件路径`/../../../var/appweb/sslvpndocs/global-protect/portal/images/sxy.txt`。\n3.  攻击者随后向`/global-protect/portal/images/sxy.txt` 发送 GET 请求，如果服务器返回 403 错误，则表明漏洞存在，且攻击者可以通过构造恶意请求执行任意代码。\n\n**POC代码有效性：**提供的POC代码旨在检测目标是否存在漏洞，通过发送特定的POST和GET请求，验证是否能够访问通常被禁止访问的文件。如果GET请求返回403状态码，则表明目标可能存在漏洞。\n\n**投毒风险分析：**\nPOC代码中存在潜在的投毒风险，主要体现在注释掉的 interactsh 相关代码部分。这段代码的目的是使用 `curl` 命令将目标系统的 `whoami` 命令的输出发送到攻击者的 interactsh 服务器。虽然这段代码当前是被注释掉的，但如果攻击者修改代码，取消注释，并运行，则可能存在以下风险：\n*   **信息泄露:** 将 `whoami` 命令的输出发送到外部服务器可能泄露目标系统的用户名信息。\n*   **命令执行:** 通过 interactsh 反连，可能执行更复杂的恶意命令。\n\n因此，尽管当前代码是检测漏洞，但潜在的风险仍然存在，尤其是对于不熟悉代码的用户，可能在不知情的情况下运行包含恶意代码的变体。所以，我将投毒风险评定为 10%。
此外，代码会尝试获取目标的 SSL 证书信息，这本身不是恶意行为，但可能被攻击者用于指纹识别和进一步攻击。

**缓解措施：**\n*   立即升级到已修复的 PAN-OS 版本，如 PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3 或更高版本。\n*   应用威胁防御签名（Threat IDs 95187, 95189, 和 95191）。\n*   确保 GlobalProtect 接口已应用漏洞保护。

**项目地址:** [sxyrxyy/CVE-2024-3400-Check](https://github.com/sxyrxyy/CVE-2024-3400-Check)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #29

**来源**: [CVE-2024-3400-terminalJunki3_CVE-2024-3400-Checker.md](../2024/CVE-2024-3400-terminalJunki3_CVE-2024-3400-Checker.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未授权攻击者可利用此漏洞以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统需启用 GlobalProtect 网关或门户，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞，源于任意文件创建。未经身份验证的远程攻击者可以通过构造特定的请求，利用此漏洞在受影响的防火墙上以 root 权限执行任意代码。漏洞影响启用了 GlobalProtect 网关或门户的 PAN-OS 10.2、11.0 和 11.1 的特定版本。\n\n**有效性：**\n根据漏洞库信息和搜索结果，CVE-2024-3400 漏洞已被积极利用，并且存在公开可用的PoC。提供的 Python 脚本旨在检查 Palo Alto Networks 设备的 tech support 文件中是否存在 CVE-2024-3400 攻击的迹象，它本身并非利用代码，而是用于检测受害者是否已经被攻击。所以此POC代码不直接体现漏洞的利用,而是在侧面验证漏洞是否被利用,存在一定的有效性。\n\n**投毒风险：**\n提供的Python脚本用于分析日志文件，搜索恶意行为的迹象。该脚本主要功能是解压和搜索指定的日志文件（'md_out.log', 'md_out.log.old', 'gpsvc.log'）中是否存在特定的恶意关键词（'wget', 'bash', 'device_telemetry/minute/', 'unmarshal'）。\n\n*   **投毒点分析：**
    * 脚本本身不包含直接的恶意代码或后门，其主要功能是文件解压和字符串搜索，风险较低。
    *  **误报风险:**  脚本依赖于预定义的`search_terms`列表，如果该列表被篡改，例如添加了常见的正常字符串，可能导致大量的误报，降低脚本的可用性。
    * **依赖库风险:** 脚本依赖于Python的`gzip`和`tarfile`库，如果这些库本身存在漏洞，可能被利用。但这是所有Python脚本的通用风险。
    * **文件路径风险:** 脚本需要用户指定`filepath`变量，如果用户指定了错误的或恶意的`.tar.gz`文件，可能导致脚本分析错误的文件，并给出错误的结论。
    * **代码缺陷:** return使用不当,会导致未能完全检查文件。\n\n总的来说，该脚本的投毒风险较低，主要的风险在于被篡改的`search_terms`列表可能导致误报。因此，投毒风险评估为10%。\n\n**利用方式：**\n根据漏洞描述和搜索结果，攻击者利用 CVE-2024-3400 的方式如下：\n1.  **构造恶意请求：**  攻击者构造包含恶意命令的特定请求，发送到启用了 GlobalProtect 的 PAN-OS 设备。\n2.  **利用任意文件创建漏洞：**  该请求触发了 PAN-OS 中的任意文件创建漏洞，允许攻击者在系统上创建恶意文件。\n3.  **命令注入：**  创建的恶意文件被执行，从而实现命令注入，允许攻击者以 root 权限执行任意代码。\n4.  **完全控制：**  成功利用该漏洞后，攻击者可以完全控制受影响的防火墙设备。

**项目地址:** [terminalJunki3/CVE-2024-3400-Checker](https://github.com/terminalJunki3/CVE-2024-3400-Checker)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #30

**来源**: [CVE-2024-3400-tfrederick74656_cve-2024-3400-poc.md](../2024/CVE-2024-3400-tfrederick74656_cve-2024-3400-poc.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，允许未授权的攻击者以root权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3， 并且配置了GlobalProtect网关或门户

**利用条件:** 目标系统需要配置GlobalProtect网关或门户，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞，由于任意文件创建导致。根据Volexity的分析和 Palo Alto Networks 的公告，该漏洞允许未经身份验证的攻击者在防火墙上以 root 权限执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是有效的，并且已经被积极利用。CISA已经将其添加到已知被利用漏洞的目录中。提供的PoC代码通过构造包含目录遍历的 Cookie，尝试访问`/var/appweb/sslvpndocs/global-protect/portal/images/watchtowr.txt`，从而验证漏洞的存在。

**投毒风险：**
此PoC代码本身相对简单，主要用于验证漏洞是否存在。投毒风险较低，估计在10%左右。尽管如此，任何从非官方来源下载的代码都存在潜在风险。用户应仔细审查代码，理解其功能，并在隔离环境中运行。潜在的投毒方式可能包括：

*   **恶意URL重定向：** PoC 中使用的 URL 可能会被更改为指向恶意站点，诱骗用户下载其他恶意软件。
*   **命令注入修改：** 攻击者可能修改 PoC 代码，添加额外的命令注入 payload，在测试时执行恶意操作。

**利用方式：**
1.  **漏洞触发：** 通过构造包含目录遍历的 `SESSID` Cookie，发送到 `/ssl-vpn/hipreport.esp` 路径。
2.  **任意文件创建：** 成功利用后，攻击者可以创建任意文件。
3.  **命令注入：** 利用任意文件创建漏洞，执行任意操作系统命令，最终获得 root 权限。

总体而言，该漏洞影响严重，利用方式简单，已经出现公开的PoC，建议尽快修复。

**项目地址:** [tfrederick74656/cve-2024-3400-poc](https://github.com/tfrederick74656/cve-2024-3400-poc)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #31

**来源**: [CVE-2024-3400-tk-sawada_IPLineFinder.md](../2024/CVE-2024-3400-tk-sawada_IPLineFinder.md)

## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统配置了 GlobalProtect gateway 或 GlobalProtect portal, 且为受影响的 PAN-OS 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞，由于任意文件创建漏洞导致。攻击者可以通过 GlobalProtect 服务，利用此漏洞在防火墙上以 root 权限执行任意代码，无需身份验证。

**漏洞利用方式：**

1.  攻击者利用 GlobalProtect 的未授权访问点，通过构造特定的请求，触发任意文件创建漏洞。
2.  利用任意文件创建漏洞，写入包含恶意命令的文件。
3.  通过命令注入，执行恶意代码，从而控制防火墙。

**提供的漏洞利用代码分析：**

提供的代码 `IPLineFinder.py` **不是直接的漏洞利用代码**。它是一个 Python 脚本，用于在日志文件中查找包含特定 IP 地址的行，并将这些行提取到新的文件中。此脚本的设计目的是用于取证分析，以确定受 CVE-2024-3400 影响的系统是否已被入侵，通过搜索已知的恶意 IP 地址来判断。

**关于投毒风险的分析：**

*   `IPLineFinder.py` 本身：脚本逻辑相对简单，主要功能是搜索和提取日志行。直接的恶意代码注入风险较低。但如果攻击者替换或修改了`ip_addresses` 列表，添加了用于混淆或误导分析的IP地址，则存在投毒风险，使分析人员无法准确识别攻击源头或关联恶意活动。

*   依赖性：该脚本依赖于 Python 标准库 `os`。 虽然标准库的风险较低，但如果脚本在受损环境中执行，则存在被篡改的风险。

*   整体风险评估：考虑到脚本的功能和依赖性，以及攻击者可能的操作，估计投毒风险为 10%。这主要是指攻击者可能篡改 IP 地址列表，来混淆视听。

**搜索引擎结果佐证：**

搜索结果表明，CVE-2024-3400 是一个已在野外被利用的零日漏洞，且存在公开的 POC。Volexity 等安全公司发布了关于如何检测 compromised 设备的报告。CrowdStrike 和 Zscaler 也发布了相关的分析报告。

综上所述，CVE-2024-3400 是一个高危漏洞，可以被远程利用，需要及时修复。提供的脚本 `IPLineFinder.py` 本身不是漏洞利用代码，而是用于入侵检测和取证分析的工具，但存在被投毒的潜在风险，尽管风险较低。

**项目地址:** [tk-sawada/IPLineFinder](https://github.com/tk-sawada/IPLineFinder)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---

## POC #32

**来源**: [CVE-2024-3400-workshop748_CVE-2024-3400.md](../2024/CVE-2024-3400-workshop748_CVE-2024-3400.md)

## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，可导致远程代码执行，获取Root权限

**影响版本:** PAN-OS 10.2, 11.0, and 11.1 (特定版本，见漏洞库信息)

**利用条件:** 需要配置GlobalProtect网关或门户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS GlobalProtect功能中的一个命令注入漏洞。攻击者通过在GlobalProtect的特定配置中利用任意文件创建漏洞，可以执行任意代码并获得防火墙上的root权限。该漏洞影响配置了GlobalProtect网关或门户的PAN-OS 10.2、11.0和11.1的特定版本。根据漏洞库信息，受影响的版本包括低于PAN-OS 10.2.9-h1的10.2.x版本，低于PAN-OS 11.0.4-h1的11.0.x版本，以及低于PAN-OS 11.1.2-h3的11.1.x版本。搜索引擎结果显示，该漏洞已被积极利用，且存在公开的PoC代码。提供的漏洞利用代码是Cargo.lock文件，用于Rust项目的依赖管理。虽然该文件本身不包含恶意代码，但由于该项目可能用于漏洞利用，存在作者在其他地方（例如在实际的Rust源代码中，未提供）加入恶意投毒代码的理论风险，但由于Cargo.lock只是锁定版本，直接投毒难度较大，风险较低。漏洞利用方式包括：未经身份验证的攻击者利用GlobalProtect中的漏洞创建任意文件，进而执行操作系统命令。从Volexity的博客文章(webpage 3)来看，检测受损的Palo Alto Networks防火墙设备的方法，从Zscaler的博客文章(webpage 4)来看，存在upstyle后门的技术分析。因此，漏洞的有效性较高，投毒风险较低。

**漏洞利用方式:**

1.  **未授权访问:** 利用未授权访问漏洞进入系统。
2.  **文件创建:**  利用GlobalProtect功能中的漏洞创建任意文件。
3.  **命令注入:**  通过文件创建，注入恶意操作系统命令。
4.  **Root权限获取:**  成功利用后，攻击者获得防火墙的Root权限。


**项目地址:** [workshop748/CVE-2024-3400](https://github.com/workshop748/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)

---



---



---

