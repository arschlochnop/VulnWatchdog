# CVE-2024-56145

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md](../2024/CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md)

# CVE-2024-56145

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md](../2024/CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md)

# CVE-2024-56145

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md](../2024/CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md)

# CVE-2024-56145

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md](../2024/CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md)

# CVE-2024-56145

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md](../2024/CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md)

# CVE-2024-56145

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md](../2024/CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md)

# CVE-2024-56145

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md](../2024/CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md)

# CVE-2024-56145

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md](../2024/CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md)

# CVE-2024-56145

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md](../2024/CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md)

# CVE-2024-56145

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md](../2024/CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md)

# CVE-2024-56145

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md](../2024/CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md)

# CVE-2024-56145

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md](../2024/CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md)

# CVE-2024-56145

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md](../2024/CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md)

# CVE-2024-56145

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md](../2024/CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md)

# CVE-2024-56145

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md](../2024/CVE-2024-56145-Sachinart_CVE-2024-56145-craftcms-rce.md)

# CVE-2024-56145

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-56145-Chocapikk_CVE-2024-56145.md](../2024/CVE-2024-56145-Chocapikk_CVE-2024-56145.md)

## CVE-2024-56145 - Craft CMS RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.0.0 < 3.9.14, 4.0.0-RC1 < 4.13.2, 5.0.0-RC1 < 5.5.2，且php.ini中register_argc_argv配置开启

**利用条件:** 目标Craft CMS版本受影响，PHP配置开启`register_argc_argv`，攻击者可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是一个Craft CMS中的远程代码执行漏洞。该漏洞出现在`register_argc_argv` PHP配置选项启用时。 攻击者可以通过精心构造的payload利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理:** 当`register_argc_argv`启用时，PHP会将GET, POST, COOKIE等数据填充到`argv`全局变量中。未经过滤的`argv`变量会被Craft CMS用于模板路径的解析，从而造成命令注入。

2.  **利用步骤 (基于提供的POC代码):**
    *   **设置环境:** 首先，需要在目标系统或本地搭建一个受影响版本的Craft CMS，并确保`register_argc_argv`配置项已开启。POC 代码提供了使用 `ddev` 的自动化环境配置脚本。
    *   **FTP Server:** 该漏洞利用工具会启动一个 FTP 服务，用于存放恶意 payload，并通过 FTP 协议提供给 Craft CMS 应用。
    *   **Payload生成:**  攻击者需要构造一个恶意的模板路径Payload，通过特定的参数传递给Craft CMS，Craft CMS会解析该模板路径，从而执行payload中包含的恶意代码。
    *   **漏洞触发:** 构造包含恶意模板路径的请求发送到目标 Craft CMS 应用。如果目标存在漏洞，且FTP服务配置正确，则恶意代码会被执行。
    *   **反弹shell:** POC代码可以生成多种反弹shell的payload（bash, nc, mkfifo），从而允许攻击者控制目标系统。

3.  **投毒风险:**  POC代码使用了一个FTP server来传输恶意代码，如果代码编写者在FTP服务器上放置了其它恶意文件，可能会在不知情的情况下被目标系统下载和执行，从而导致投毒。此外，该POC工具使用`pygyat`库，这是一个用于编写python命令行工具的库，本身并无明显的投毒风险。POC代码主要功能是漏洞利用，较为直接，但依然存在一定的投毒的可能性，例如在payload生成环节植入恶意代码。

4.  **缓解措施:**
    *   升级到Craft CMS的最新版本（>= 3.9.14, >= 4.13.2, >= 5.5.2）。
    *   禁用`register_argc_argv`配置选项。


**项目地址:** [Chocapikk/CVE-2024-56145](https://github.com/Chocapikk/CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

## POC #2

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---



---

## POC #3

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---



---

## POC #3

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---



---

## POC #3

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---



---

## POC #3

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---



---

## POC #3

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---



---

## POC #3

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---



---

## POC #3

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---



---

## POC #3

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---



---

## POC #3

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---



---

## POC #3

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---



---

## POC #3

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---



---

## POC #3

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---



---

## POC #3

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---



---

## POC #3

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---



---

## POC #3

**来源**: [CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md](../2024/CVE-2024-56145-hmhlol_craft-cms-RCE-CVE-2024-56145.md)

## CVE-2024-56145-CraftCMS-RCE

**漏洞编号:** CVE-2024-56145

**漏洞类型:** RCE

**影响应用:** Craft CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.5.2 and < 4.13.2 and < 3.9.14

**利用条件:** PHP配置项register_argc_argv需要启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56145是Craft CMS中的一个远程代码执行漏洞。根据漏洞信息，该漏洞的触发条件是php.ini配置文件中启用了`register_argc_argv`选项。从搜索引擎结果来看，Assetnote的研究团队发现了该漏洞，并发布了相关的分析文章和漏洞利用工具。提供的漏洞利用代码是一个Dockerfile，用于构建包含易受攻击版本的Craft CMS和启用`register_argc_argv`的PHP环境。`build_docker.sh`脚本用于构建和启动Docker容器。漏洞利用方式是利用PHP将命令行参数注入到应用程序中，从而执行恶意代码。因为POC环境中包含FTP服务，并允许匿名用户写入，这存在一定的风险，例如，攻击者可能会利用FTP服务上传恶意文件并执行，从而导致更严重的投毒攻击。

**漏洞利用方式：**

1.  **条件：** 目标Craft CMS服务器的php.ini中启用了`register_argc_argv`。
2.  **攻击：** 攻击者构造包含恶意代码的HTTP请求，该恶意代码会被作为命令行参数传递给PHP脚本。
3.  **执行：** Craft CMS解析请求，由于`register_argc_argv`已启用，恶意代码会作为命令行参数被注册，并最终导致代码执行。

**投毒风险评估：**

虽然提供的代码主要是为了复现漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **FTP服务：** Dockerfile配置了匿名可写的FTP服务。攻击者可以在环境中上传恶意文件。
2.  **.env文件：** Dockerfile中复制`.env`文件，这可能包含数据库凭据或其他敏感信息，如果这些信息被泄露，可能会导致更严重的攻击。
3.  **Composer依赖：** `composer.json` 文件指定了依赖包的版本，如果攻击者控制了依赖包的源，可能会注入恶意代码。

综合以上因素，虽然该POC的主要目的是验证漏洞，但其中一些配置可能会被恶意利用。因此，我们认为存在10%的投毒风险。

**项目地址:** [hmhlol/craft-cms-RCE-CVE-2024-56145](https://github.com/hmhlol/craft-cms-RCE-CVE-2024-56145)

**漏洞详情:** [CVE-2024-56145](https://nvd.nist.gov/vuln/detail/CVE-2024-56145)

---

