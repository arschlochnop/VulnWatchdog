## CVE-2024-53677 - Apache Struts 远程代码执行 (RCE)

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 严重

**CVSS评分:** 9.5

**影响版本:** 2.0.0 至 2.5.33, 6.0.0 至 6.3.0.2

**利用条件:** 目标应用需开启文件上传功能，且攻击者需能够访问文件上传接口。

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该提供的POC代码（Check-CVE-2024-53677.py）是一个典型的漏洞扫描脚本，主要用于验证目标服务器是否存在路径穿越漏洞。其核心逻辑是通过Multipart表单上传文件，并尝试利用OGNL属性绑定（top.uploadFileName）来覆盖服务器端的文件命名逻辑，将原本应该存储在临时目录的文件通过路径穿越符（../../）移动到非预期的目录。分析认为该POC属于‘无损检测’，因为它尝试上传一个名为vuln_test.txt的无害文本文件，并通过检查响应包中是否返回该文件名来推断路径穿越是否成功。虽然该脚本能够有效验证路径穿越的存在性，但它本身并未实现完整的RCE利用链（如上传JSP webshell并访问执行）。在实际生产环境中，由于Web服务器权限控制、目录权限或WAF拦截，该检测脚本可能出现误报或漏报，但其作为初期踩点工具具有较高的参考价值。脚本使用了标准的requests和requests_toolbelt库，逻辑清晰，没有明显的混淆或异常行为，是一个针对S2-067漏洞的初步验证脚本。针对该漏洞的深层利用通常需要结合Web容器的部署路径和可执行权限，该POC仅完成了第一步路径操控的验证。建议安全研究员在隔离环境下配合具体的Struts版本进行测试，观察服务器端文件落地的实际位置以确认漏洞。 【利用步骤】1. 确定目标系统使用的Apache Struts版本处于受影响范围内。2. 寻找系统中的文件上传功能模块（如.action或.do结尾的上传接口）。3. 构造特定的Multipart/form-data请求，除了正常的上传字段外，添加一个恶意的参数字段（如top.uploadFileName或uploadFileName），并注入路径穿越字符（例如../../webapps/ROOT/shell.jsp）。4. 如果服务器逻辑存在缺陷，会将上传的文件流写入到注入的路径中。5. 通过浏览器或命令行访问上传后的恶意文件路径，实现远程代码执行。 【投毒风险分析】该POC代码的投毒风险极低，估值为10%。经过对Python脚本的详细代码审计，发现该脚本主要执行以下操作：1. 导入标准库（requests, argparse, logging）和常用的第三方库（requests_toolbelt）。2. 构造HTTP POST请求发送至用户指定的URL。3. 打印响应状态和简单的逻辑判断结果。脚本中不存在任何硬编码的远程恶意下载地址、base64混淆的Shellcode序列、或者尝试修改本地系统文件、读取系统敏感信息（如/etc/shadow）的行为。唯一可能引发警惕的是网络连接行为，但这完全取决于用户输入的target_url。脚本逻辑完全透明，注释清晰，不含混淆代码，不符合投毒软件的特征。README文档虽然使用了醒目的警示符号，但其内容旨在提供安全通报而非误导用户执行恶意代码。总体而言，该脚本是一个纯粹的防御性检测工具，安全从业者可以放心在受控环境中使用，但仍需注意在扫描生产环境前获得授权，以避免产生不必要的告警或法律风险。

**项目地址:** 本地分析路径: /tmp/vulnwatchdog_d0988db93eeda996a5df3bc7273eab39/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)
