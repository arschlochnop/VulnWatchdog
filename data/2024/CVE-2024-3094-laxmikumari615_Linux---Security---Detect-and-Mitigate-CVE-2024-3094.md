## CVE-2024-3094 - XZ Utils (liblzma) 后门/供应链攻击

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 后门/供应链攻击

**影响应用:** XZ Utils (liblzma)

**危害等级:** 严重 (Critical)

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 运行受影响版本的 Linux 发行版，且 SSH 服务（sshd）链接了受污染的 liblzma 库（通常通过 systemd 机制）。

**POC 可用性:** 4/10

**POC 类型:** 概念验证/检测脚本

**攻击复杂度:** 高

**投毒风险:** 15%

## 详情

【POC有效性分析】该 CVE-2024-3094 实际上是针对 XZ Utils 项目的复杂供应链攻击。提供的 POC 代码库（vulnwatchdog）并非用于利用该后门的 Exploit，而是一个检测工具和文档集合。经过分析，该 POC 的主要功能是帮助系统管理员识别其环境中是否安装了 5.6.0 或 5.6.1 版本的 xz-utils。后门本身的触发机制极其复杂，涉及在构建过程中通过一系列混淆的 m4 脚本和测试文件（二进制数据）向编译后的 liblzma 中注入恶意代码。真正的后门利用代码并不会直接出现在一般的脚本中，而是潜伏在库文件中，通过特定的 RSA 密钥签名触发。由于提供的输入仅为 README 和检测指导，缺乏攻击载荷，因此在‘利用’层面有效性较低，但在‘防御检测’层面具有参考价值。该漏洞的特殊性在于它不是传统的代码缺陷，而是一次蓄意策划的渗透。利用步骤极其隐蔽，攻击者必须向受害者的 sshd 服务发送特定的、经过加密的预认证 payload，这使得在没有原始攻击者密钥的情况下，第三方很难完整复现攻击流程。目前的公开 POC 主要是基于版本匹配或检查特定的 .o 文件导出符号变化。【利用步骤】1. 识别目标系统是否运行受影响的 Linux 发行版（如 Debian Sid, Fedora 40/41, openSUSE Tumbleweed 等）。2. 确认安装的 xz-utils 版本是否为 5.6.0 或 5.6.1。3. 检查 sshd 是否间接引用了 liblzma 库（使用 ldd $(which sshd) 命令）。4. 在后门活跃的情况下，攻击者通过构造特定的 SSH 握手包触发恶意逻辑。5. 后门绕过身份验证并执行攻击者预设的代码。【投毒风险分析】针对该 POC 代码仓库的分析显示，其主要内容为说明文档和可能的检测脚本，其本身的投毒风险处于低位（约 15%）。主要的风险点在于这类重大漏洞爆发时，网络上会出现大量伪装成‘一键修补’或‘一键检测’的脚本，这些脚本可能包含反弹 Shell 或恶意下载器。由于 CVE-2024-3094 本身就是由供应链投毒引起的，防御者在下载任何非官方、非知名安全机构发布的检测工具时应保持极高警惕。目前的 POC 仓库 vulnwatchdog 结构清晰，代码逻辑主要围绕版本对比和文件搜索，未发现明显的混淆、eval 执行或异常的外部网络请求。然而，研究人员应注意，如果脚本中包含预编译的二进制检测工具或经过 base64 编码的 shell 段落，必须先进行脱壳审计。在部署防御措施时，建议优先使用操作系统官方发行版提供的安全补丁和官方检测脚本（如 oss-security 社区提供的脚本），而非通过 GitHub 随机搜索到的项目。对于安全研究团队，应在隔离环境（Sandbox）中运行此类脚本，防止‘二次投毒’造成的内网渗透风险。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2024-3094](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2024-3094)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)
