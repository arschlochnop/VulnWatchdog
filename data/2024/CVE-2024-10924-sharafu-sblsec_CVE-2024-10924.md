## CVE-2024-10924 - Really Simple Security (原名 Really Simple SSL) 身份验证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** Really Simple Security (原名 Really Simple SSL)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 9.0.0 至 9.1.1.1

**利用条件:** 无需身份验证，目标网站需启用双因子身份验证 (2FA) 功能且插件处于受影响版本范围。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于WordPress插件Really Simple Security的REST API处理逻辑中。当插件启用双因子身份验证（2FA）功能时，`skip_onboarding` 处理程序未能对请求进行充分的安全验证。攻击者可以通过向 `/wp-json/reallysimplessl/v1/two_fa/skip_onboarding` 发送包含特定 `user_id` 的恶意 JSON 请求来绕过身份验证。提供的 C 语言 POC 代码通过 libcurl 库构造了一个 POST 请求，设置 Content-Type 为 application/json，并发送包含 `user_id` 和伪造 `login_nonce` 的载荷。由于后端代码在验证逻辑上存在缺陷，即便 nonce 无效，只要 `user_id` 正确，服务器也会错误地验证用户身份并在 HTTP 响应头中返回有效的 `Set-Cookie` 认证凭证。POC 中的 `header_callback` 函数能够直接捕获这些 Cookie，证明了攻击者可以借此直接以管理员身份（通常 user_id 为 1）登录系统，无需任何密码或 2FA 验证，具有极高的实战威胁。利用步骤：1. 确认目标网站安装了 9.0.0 至 9.1.1.1 版本的 Really Simple Security 插件。2. 探测或猜测目标管理员的 user_id（通常为 1）。3. 编译并运行 POC 代码，输入目标 user_id 和 REST API 端点 URL。4. 观察输出，截获 HTTP 响应中的认证 Cookie。5. 将 Cookie 导入浏览器即可直接进入后台。投毒风险分析：该 POC 使用标准的 C 语言编写，依赖于开源库 libcurl，代码逻辑透明，直接展示了如何构造 JSON 载荷及处理响应头。通过静态代码审计发现，其核心逻辑仅限于网络请求的收发，并未包含任何混淆代码、Shellcode 植入、远程恶意服务器回调或本地文件破坏行为。代码中虽然包含了字符艺术（Ascii Art）作为横幅，但这属于安全研究员常见的标识性做法，不属于恶意投毒范畴。唯一潜在的风险点在于使用者若不具备环境配置能力，可能在寻找编译环境时下载到被二次修改的恶意编译器或二进制文件，但源代码本身是清白且具有教育意义的。代码中没有使用 eval() 类动态执行函数，也没有尝试绕过本地安全软件。整体评估该 POC 属于高质量且安全的防御性研究样本。

**项目地址:** [https://github.com/wordfence/CVE-2024-10924-PoC](https://www.google.com/search?q=https://github.com/wordfence/CVE-2024-10924-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)
