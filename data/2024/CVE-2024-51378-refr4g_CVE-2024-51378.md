# CVE-2024-51378

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-å‘½ä»¤æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** å‘½ä»¤æ³¨å…¥

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹å‘½ä»¤æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 2.3.6åŠ(æœªä¿®è¡¥)2.3.7

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºCyberPanelçš„dns/views.pyå’Œftp/views.pyä¸­çš„getresetstatusåŠŸèƒ½ã€‚ç”±äºsecMiddlewareä»…é’ˆå¯¹POSTè¯·æ±‚ï¼Œè¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡GETè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶åœ¨statusfileå±æ€§ä¸­ä½¿ç”¨shellå…ƒå­—ç¬¦ï¼Œé€šè¿‡è®¿é—®/dns/getresetstatusæˆ–/ftp/getresetstatusæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ 

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´åŸç†ï¼š** é€šè¿‡æ„é€ åŒ…å«shellå…ƒå­—ç¬¦çš„`statusfile`å‚æ•°ï¼Œå®ç°å‘½ä»¤æ³¨å…¥ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**
    *   **è¢«åŠ¨æ¨¡å¼ï¼ˆæ‰«æï¼‰ï¼š** é€šè¿‡GETè¯·æ±‚è®¿é—®`/ftp/getresetstatus`ï¼Œæ£€æŸ¥è¿”å›å†…å®¹æ˜¯å¦åŒ…å«`JSONDecodeError at /ftp/getresetstatus`ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚
    *   **ä¸»åŠ¨æ¨¡å¼ï¼ˆåˆ©ç”¨ï¼‰ï¼š**
        1.  å‘é€GETè¯·æ±‚è·å–`csrftoken`ã€‚
        2.  å‘é€OPTIONSè¯·æ±‚åˆ°`/ftp/getresetstatus`æˆ–`/dns/getresetstatus`ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å«è·å–çš„`csrftoken`ï¼Œå¹¶åœ¨payloadçš„`statusfile`å‚æ•°ä¸­æ³¨å…¥å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œ`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`ã€‚

3.  **æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`51378_use.py`å’ŒNucleiæ¨¡æ¿ï¼‰æœ‰æ•ˆã€‚`51378_use.py`è„šæœ¬å¯ä»¥äº¤äº’å¼åœ°æ‰§è¡Œå‘½ä»¤ã€‚Nucleiæ¨¡æ¿æä¾›äº†è¢«åŠ¨å’Œä¸»åŠ¨ä¸¤ç§æ‰«ææ–¹å¼ã€‚

4.  **æŠ•æ¯’é£é™©ï¼š**
   ä»“åº“çš„å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯ç”¨äºæ¼æ´æ£€æµ‹å’Œåˆ©ç”¨çš„ï¼Œåªæœ‰å°‘é‡ç”¨æˆ·äº¤äº’éƒ¨åˆ†ï¼Œä¾‹å¦‚å‘½ä»¤è¡Œè¾“å…¥ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨5%ã€‚ ä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨æ‰«ææˆ–åˆ©ç”¨è„šæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§,ä¾‹å¦‚åå¼¹shellæˆ–ä¸‹è½½æ‰§è¡Œæ¶æ„ç¨‹åºç­‰è¡Œä¸ºã€‚éœ€è¦äººå·¥å®¡æ ¸æ‰€æœ‰è„šæœ¬ä»£ç ï¼Œç‰¹åˆ«æ˜¯ä¸ç½‘ç»œè¯·æ±‚å’Œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œç›¸å…³çš„éƒ¨åˆ†ã€‚

**æ€»ç»“ï¼š** CVE-2024-51378æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ æ¼æ´åˆ©ç”¨POCå·²å…¬å¼€ï¼ŒCISA KEVä¹Ÿå·²ç»æ”¶å½•ï¼Œåˆ©ç”¨æ–¹å¼ç®€å•ï¼Œå¨èƒå·¨å¤§ã€‚éœ€è¦å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**æ¥æº**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-å‘½ä»¤æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** å‘½ä»¤æ³¨å…¥

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹å‘½ä»¤æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 2.3.6åŠ(æœªä¿®è¡¥)2.3.7

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºCyberPanelçš„dns/views.pyå’Œftp/views.pyä¸­çš„getresetstatusåŠŸèƒ½ã€‚ç”±äºsecMiddlewareä»…é’ˆå¯¹POSTè¯·æ±‚ï¼Œè¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡GETè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶åœ¨statusfileå±æ€§ä¸­ä½¿ç”¨shellå…ƒå­—ç¬¦ï¼Œé€šè¿‡è®¿é—®/dns/getresetstatusæˆ–/ftp/getresetstatusæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ 

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´åŸç†ï¼š** é€šè¿‡æ„é€ åŒ…å«shellå…ƒå­—ç¬¦çš„`statusfile`å‚æ•°ï¼Œå®ç°å‘½ä»¤æ³¨å…¥ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**
    *   **è¢«åŠ¨æ¨¡å¼ï¼ˆæ‰«æï¼‰ï¼š** é€šè¿‡GETè¯·æ±‚è®¿é—®`/ftp/getresetstatus`ï¼Œæ£€æŸ¥è¿”å›å†…å®¹æ˜¯å¦åŒ…å«`JSONDecodeError at /ftp/getresetstatus`ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚
    *   **ä¸»åŠ¨æ¨¡å¼ï¼ˆåˆ©ç”¨ï¼‰ï¼š**
        1.  å‘é€GETè¯·æ±‚è·å–`csrftoken`ã€‚
        2.  å‘é€OPTIONSè¯·æ±‚åˆ°`/ftp/getresetstatus`æˆ–`/dns/getresetstatus`ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å«è·å–çš„`csrftoken`ï¼Œå¹¶åœ¨payloadçš„`statusfile`å‚æ•°ä¸­æ³¨å…¥å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œ`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`ã€‚

3.  **æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`51378_use.py`å’ŒNucleiæ¨¡æ¿ï¼‰æœ‰æ•ˆã€‚`51378_use.py`è„šæœ¬å¯ä»¥äº¤äº’å¼åœ°æ‰§è¡Œå‘½ä»¤ã€‚Nucleiæ¨¡æ¿æä¾›äº†è¢«åŠ¨å’Œä¸»åŠ¨ä¸¤ç§æ‰«ææ–¹å¼ã€‚

4.  **æŠ•æ¯’é£é™©ï¼š**
   ä»“åº“çš„å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯ç”¨äºæ¼æ´æ£€æµ‹å’Œåˆ©ç”¨çš„ï¼Œåªæœ‰å°‘é‡ç”¨æˆ·äº¤äº’éƒ¨åˆ†ï¼Œä¾‹å¦‚å‘½ä»¤è¡Œè¾“å…¥ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨5%ã€‚ ä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨æ‰«ææˆ–åˆ©ç”¨è„šæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§,ä¾‹å¦‚åå¼¹shellæˆ–ä¸‹è½½æ‰§è¡Œæ¶æ„ç¨‹åºç­‰è¡Œä¸ºã€‚éœ€è¦äººå·¥å®¡æ ¸æ‰€æœ‰è„šæœ¬ä»£ç ï¼Œç‰¹åˆ«æ˜¯ä¸ç½‘ç»œè¯·æ±‚å’Œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œç›¸å…³çš„éƒ¨åˆ†ã€‚

**æ€»ç»“ï¼š** CVE-2024-51378æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ æ¼æ´åˆ©ç”¨POCå·²å…¬å¼€ï¼ŒCISA KEVä¹Ÿå·²ç»æ”¶å½•ï¼Œåˆ©ç”¨æ–¹å¼ç®€å•ï¼Œå¨èƒå·¨å¤§ã€‚éœ€è¦å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**æ¥æº**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-å‘½ä»¤æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** å‘½ä»¤æ³¨å…¥

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹å‘½ä»¤æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 2.3.6åŠ(æœªä¿®è¡¥)2.3.7

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºCyberPanelçš„dns/views.pyå’Œftp/views.pyä¸­çš„getresetstatusåŠŸèƒ½ã€‚ç”±äºsecMiddlewareä»…é’ˆå¯¹POSTè¯·æ±‚ï¼Œè¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡GETè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶åœ¨statusfileå±æ€§ä¸­ä½¿ç”¨shellå…ƒå­—ç¬¦ï¼Œé€šè¿‡è®¿é—®/dns/getresetstatusæˆ–/ftp/getresetstatusæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ 

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´åŸç†ï¼š** é€šè¿‡æ„é€ åŒ…å«shellå…ƒå­—ç¬¦çš„`statusfile`å‚æ•°ï¼Œå®ç°å‘½ä»¤æ³¨å…¥ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**
    *   **è¢«åŠ¨æ¨¡å¼ï¼ˆæ‰«æï¼‰ï¼š** é€šè¿‡GETè¯·æ±‚è®¿é—®`/ftp/getresetstatus`ï¼Œæ£€æŸ¥è¿”å›å†…å®¹æ˜¯å¦åŒ…å«`JSONDecodeError at /ftp/getresetstatus`ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚
    *   **ä¸»åŠ¨æ¨¡å¼ï¼ˆåˆ©ç”¨ï¼‰ï¼š**
        1.  å‘é€GETè¯·æ±‚è·å–`csrftoken`ã€‚
        2.  å‘é€OPTIONSè¯·æ±‚åˆ°`/ftp/getresetstatus`æˆ–`/dns/getresetstatus`ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å«è·å–çš„`csrftoken`ï¼Œå¹¶åœ¨payloadçš„`statusfile`å‚æ•°ä¸­æ³¨å…¥å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œ`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`ã€‚

3.  **æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`51378_use.py`å’ŒNucleiæ¨¡æ¿ï¼‰æœ‰æ•ˆã€‚`51378_use.py`è„šæœ¬å¯ä»¥äº¤äº’å¼åœ°æ‰§è¡Œå‘½ä»¤ã€‚Nucleiæ¨¡æ¿æä¾›äº†è¢«åŠ¨å’Œä¸»åŠ¨ä¸¤ç§æ‰«ææ–¹å¼ã€‚

4.  **æŠ•æ¯’é£é™©ï¼š**
   ä»“åº“çš„å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯ç”¨äºæ¼æ´æ£€æµ‹å’Œåˆ©ç”¨çš„ï¼Œåªæœ‰å°‘é‡ç”¨æˆ·äº¤äº’éƒ¨åˆ†ï¼Œä¾‹å¦‚å‘½ä»¤è¡Œè¾“å…¥ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨5%ã€‚ ä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨æ‰«ææˆ–åˆ©ç”¨è„šæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§,ä¾‹å¦‚åå¼¹shellæˆ–ä¸‹è½½æ‰§è¡Œæ¶æ„ç¨‹åºç­‰è¡Œä¸ºã€‚éœ€è¦äººå·¥å®¡æ ¸æ‰€æœ‰è„šæœ¬ä»£ç ï¼Œç‰¹åˆ«æ˜¯ä¸ç½‘ç»œè¯·æ±‚å’Œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œç›¸å…³çš„éƒ¨åˆ†ã€‚

**æ€»ç»“ï¼š** CVE-2024-51378æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ æ¼æ´åˆ©ç”¨POCå·²å…¬å¼€ï¼ŒCISA KEVä¹Ÿå·²ç»æ”¶å½•ï¼Œåˆ©ç”¨æ–¹å¼ç®€å•ï¼Œå¨èƒå·¨å¤§ã€‚éœ€è¦å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**æ¥æº**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-å‘½ä»¤æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** å‘½ä»¤æ³¨å…¥

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹å‘½ä»¤æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 2.3.6åŠ(æœªä¿®è¡¥)2.3.7

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºCyberPanelçš„dns/views.pyå’Œftp/views.pyä¸­çš„getresetstatusåŠŸèƒ½ã€‚ç”±äºsecMiddlewareä»…é’ˆå¯¹POSTè¯·æ±‚ï¼Œè¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡GETè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶åœ¨statusfileå±æ€§ä¸­ä½¿ç”¨shellå…ƒå­—ç¬¦ï¼Œé€šè¿‡è®¿é—®/dns/getresetstatusæˆ–/ftp/getresetstatusæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ 

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´åŸç†ï¼š** é€šè¿‡æ„é€ åŒ…å«shellå…ƒå­—ç¬¦çš„`statusfile`å‚æ•°ï¼Œå®ç°å‘½ä»¤æ³¨å…¥ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**
    *   **è¢«åŠ¨æ¨¡å¼ï¼ˆæ‰«æï¼‰ï¼š** é€šè¿‡GETè¯·æ±‚è®¿é—®`/ftp/getresetstatus`ï¼Œæ£€æŸ¥è¿”å›å†…å®¹æ˜¯å¦åŒ…å«`JSONDecodeError at /ftp/getresetstatus`ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚
    *   **ä¸»åŠ¨æ¨¡å¼ï¼ˆåˆ©ç”¨ï¼‰ï¼š**
        1.  å‘é€GETè¯·æ±‚è·å–`csrftoken`ã€‚
        2.  å‘é€OPTIONSè¯·æ±‚åˆ°`/ftp/getresetstatus`æˆ–`/dns/getresetstatus`ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å«è·å–çš„`csrftoken`ï¼Œå¹¶åœ¨payloadçš„`statusfile`å‚æ•°ä¸­æ³¨å…¥å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œ`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`ã€‚

3.  **æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`51378_use.py`å’ŒNucleiæ¨¡æ¿ï¼‰æœ‰æ•ˆã€‚`51378_use.py`è„šæœ¬å¯ä»¥äº¤äº’å¼åœ°æ‰§è¡Œå‘½ä»¤ã€‚Nucleiæ¨¡æ¿æä¾›äº†è¢«åŠ¨å’Œä¸»åŠ¨ä¸¤ç§æ‰«ææ–¹å¼ã€‚

4.  **æŠ•æ¯’é£é™©ï¼š**
   ä»“åº“çš„å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯ç”¨äºæ¼æ´æ£€æµ‹å’Œåˆ©ç”¨çš„ï¼Œåªæœ‰å°‘é‡ç”¨æˆ·äº¤äº’éƒ¨åˆ†ï¼Œä¾‹å¦‚å‘½ä»¤è¡Œè¾“å…¥ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨5%ã€‚ ä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨æ‰«ææˆ–åˆ©ç”¨è„šæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§,ä¾‹å¦‚åå¼¹shellæˆ–ä¸‹è½½æ‰§è¡Œæ¶æ„ç¨‹åºç­‰è¡Œä¸ºã€‚éœ€è¦äººå·¥å®¡æ ¸æ‰€æœ‰è„šæœ¬ä»£ç ï¼Œç‰¹åˆ«æ˜¯ä¸ç½‘ç»œè¯·æ±‚å’Œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œç›¸å…³çš„éƒ¨åˆ†ã€‚

**æ€»ç»“ï¼š** CVE-2024-51378æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ æ¼æ´åˆ©ç”¨POCå·²å…¬å¼€ï¼ŒCISA KEVä¹Ÿå·²ç»æ”¶å½•ï¼Œåˆ©ç”¨æ–¹å¼ç®€å•ï¼Œå¨èƒå·¨å¤§ã€‚éœ€è¦å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**æ¥æº**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-å‘½ä»¤æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** å‘½ä»¤æ³¨å…¥

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹å‘½ä»¤æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 2.3.6åŠ(æœªä¿®è¡¥)2.3.7

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºCyberPanelçš„dns/views.pyå’Œftp/views.pyä¸­çš„getresetstatusåŠŸèƒ½ã€‚ç”±äºsecMiddlewareä»…é’ˆå¯¹POSTè¯·æ±‚ï¼Œè¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡GETè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶åœ¨statusfileå±æ€§ä¸­ä½¿ç”¨shellå…ƒå­—ç¬¦ï¼Œé€šè¿‡è®¿é—®/dns/getresetstatusæˆ–/ftp/getresetstatusæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ 

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´åŸç†ï¼š** é€šè¿‡æ„é€ åŒ…å«shellå…ƒå­—ç¬¦çš„`statusfile`å‚æ•°ï¼Œå®ç°å‘½ä»¤æ³¨å…¥ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**
    *   **è¢«åŠ¨æ¨¡å¼ï¼ˆæ‰«æï¼‰ï¼š** é€šè¿‡GETè¯·æ±‚è®¿é—®`/ftp/getresetstatus`ï¼Œæ£€æŸ¥è¿”å›å†…å®¹æ˜¯å¦åŒ…å«`JSONDecodeError at /ftp/getresetstatus`ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚
    *   **ä¸»åŠ¨æ¨¡å¼ï¼ˆåˆ©ç”¨ï¼‰ï¼š**
        1.  å‘é€GETè¯·æ±‚è·å–`csrftoken`ã€‚
        2.  å‘é€OPTIONSè¯·æ±‚åˆ°`/ftp/getresetstatus`æˆ–`/dns/getresetstatus`ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å«è·å–çš„`csrftoken`ï¼Œå¹¶åœ¨payloadçš„`statusfile`å‚æ•°ä¸­æ³¨å…¥å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œ`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`ã€‚

3.  **æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`51378_use.py`å’ŒNucleiæ¨¡æ¿ï¼‰æœ‰æ•ˆã€‚`51378_use.py`è„šæœ¬å¯ä»¥äº¤äº’å¼åœ°æ‰§è¡Œå‘½ä»¤ã€‚Nucleiæ¨¡æ¿æä¾›äº†è¢«åŠ¨å’Œä¸»åŠ¨ä¸¤ç§æ‰«ææ–¹å¼ã€‚

4.  **æŠ•æ¯’é£é™©ï¼š**
   ä»“åº“çš„å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯ç”¨äºæ¼æ´æ£€æµ‹å’Œåˆ©ç”¨çš„ï¼Œåªæœ‰å°‘é‡ç”¨æˆ·äº¤äº’éƒ¨åˆ†ï¼Œä¾‹å¦‚å‘½ä»¤è¡Œè¾“å…¥ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨5%ã€‚ ä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨æ‰«ææˆ–åˆ©ç”¨è„šæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§,ä¾‹å¦‚åå¼¹shellæˆ–ä¸‹è½½æ‰§è¡Œæ¶æ„ç¨‹åºç­‰è¡Œä¸ºã€‚éœ€è¦äººå·¥å®¡æ ¸æ‰€æœ‰è„šæœ¬ä»£ç ï¼Œç‰¹åˆ«æ˜¯ä¸ç½‘ç»œè¯·æ±‚å’Œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œç›¸å…³çš„éƒ¨åˆ†ã€‚

**æ€»ç»“ï¼š** CVE-2024-51378æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ æ¼æ´åˆ©ç”¨POCå·²å…¬å¼€ï¼ŒCISA KEVä¹Ÿå·²ç»æ”¶å½•ï¼Œåˆ©ç”¨æ–¹å¼ç®€å•ï¼Œå¨èƒå·¨å¤§ã€‚éœ€è¦å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**æ¥æº**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-å‘½ä»¤æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** å‘½ä»¤æ³¨å…¥

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹å‘½ä»¤æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 2.3.6åŠ(æœªä¿®è¡¥)2.3.7

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºCyberPanelçš„dns/views.pyå’Œftp/views.pyä¸­çš„getresetstatusåŠŸèƒ½ã€‚ç”±äºsecMiddlewareä»…é’ˆå¯¹POSTè¯·æ±‚ï¼Œè¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡GETè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶åœ¨statusfileå±æ€§ä¸­ä½¿ç”¨shellå…ƒå­—ç¬¦ï¼Œé€šè¿‡è®¿é—®/dns/getresetstatusæˆ–/ftp/getresetstatusæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ 

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´åŸç†ï¼š** é€šè¿‡æ„é€ åŒ…å«shellå…ƒå­—ç¬¦çš„`statusfile`å‚æ•°ï¼Œå®ç°å‘½ä»¤æ³¨å…¥ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**
    *   **è¢«åŠ¨æ¨¡å¼ï¼ˆæ‰«æï¼‰ï¼š** é€šè¿‡GETè¯·æ±‚è®¿é—®`/ftp/getresetstatus`ï¼Œæ£€æŸ¥è¿”å›å†…å®¹æ˜¯å¦åŒ…å«`JSONDecodeError at /ftp/getresetstatus`ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚
    *   **ä¸»åŠ¨æ¨¡å¼ï¼ˆåˆ©ç”¨ï¼‰ï¼š**
        1.  å‘é€GETè¯·æ±‚è·å–`csrftoken`ã€‚
        2.  å‘é€OPTIONSè¯·æ±‚åˆ°`/ftp/getresetstatus`æˆ–`/dns/getresetstatus`ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å«è·å–çš„`csrftoken`ï¼Œå¹¶åœ¨payloadçš„`statusfile`å‚æ•°ä¸­æ³¨å…¥å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œ`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`ã€‚

3.  **æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`51378_use.py`å’ŒNucleiæ¨¡æ¿ï¼‰æœ‰æ•ˆã€‚`51378_use.py`è„šæœ¬å¯ä»¥äº¤äº’å¼åœ°æ‰§è¡Œå‘½ä»¤ã€‚Nucleiæ¨¡æ¿æä¾›äº†è¢«åŠ¨å’Œä¸»åŠ¨ä¸¤ç§æ‰«ææ–¹å¼ã€‚

4.  **æŠ•æ¯’é£é™©ï¼š**
   ä»“åº“çš„å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯ç”¨äºæ¼æ´æ£€æµ‹å’Œåˆ©ç”¨çš„ï¼Œåªæœ‰å°‘é‡ç”¨æˆ·äº¤äº’éƒ¨åˆ†ï¼Œä¾‹å¦‚å‘½ä»¤è¡Œè¾“å…¥ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨5%ã€‚ ä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨æ‰«ææˆ–åˆ©ç”¨è„šæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§,ä¾‹å¦‚åå¼¹shellæˆ–ä¸‹è½½æ‰§è¡Œæ¶æ„ç¨‹åºç­‰è¡Œä¸ºã€‚éœ€è¦äººå·¥å®¡æ ¸æ‰€æœ‰è„šæœ¬ä»£ç ï¼Œç‰¹åˆ«æ˜¯ä¸ç½‘ç»œè¯·æ±‚å’Œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œç›¸å…³çš„éƒ¨åˆ†ã€‚

**æ€»ç»“ï¼š** CVE-2024-51378æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ æ¼æ´åˆ©ç”¨POCå·²å…¬å¼€ï¼ŒCISA KEVä¹Ÿå·²ç»æ”¶å½•ï¼Œåˆ©ç”¨æ–¹å¼ç®€å•ï¼Œå¨èƒå·¨å¤§ã€‚éœ€è¦å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**æ¥æº**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-å‘½ä»¤æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** å‘½ä»¤æ³¨å…¥

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹å‘½ä»¤æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 2.3.6åŠ(æœªä¿®è¡¥)2.3.7

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºCyberPanelçš„dns/views.pyå’Œftp/views.pyä¸­çš„getresetstatusåŠŸèƒ½ã€‚ç”±äºsecMiddlewareä»…é’ˆå¯¹POSTè¯·æ±‚ï¼Œè¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡GETè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶åœ¨statusfileå±æ€§ä¸­ä½¿ç”¨shellå…ƒå­—ç¬¦ï¼Œé€šè¿‡è®¿é—®/dns/getresetstatusæˆ–/ftp/getresetstatusæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ 

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´åŸç†ï¼š** é€šè¿‡æ„é€ åŒ…å«shellå…ƒå­—ç¬¦çš„`statusfile`å‚æ•°ï¼Œå®ç°å‘½ä»¤æ³¨å…¥ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**
    *   **è¢«åŠ¨æ¨¡å¼ï¼ˆæ‰«æï¼‰ï¼š** é€šè¿‡GETè¯·æ±‚è®¿é—®`/ftp/getresetstatus`ï¼Œæ£€æŸ¥è¿”å›å†…å®¹æ˜¯å¦åŒ…å«`JSONDecodeError at /ftp/getresetstatus`ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚
    *   **ä¸»åŠ¨æ¨¡å¼ï¼ˆåˆ©ç”¨ï¼‰ï¼š**
        1.  å‘é€GETè¯·æ±‚è·å–`csrftoken`ã€‚
        2.  å‘é€OPTIONSè¯·æ±‚åˆ°`/ftp/getresetstatus`æˆ–`/dns/getresetstatus`ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å«è·å–çš„`csrftoken`ï¼Œå¹¶åœ¨payloadçš„`statusfile`å‚æ•°ä¸­æ³¨å…¥å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œ`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`ã€‚

3.  **æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`51378_use.py`å’ŒNucleiæ¨¡æ¿ï¼‰æœ‰æ•ˆã€‚`51378_use.py`è„šæœ¬å¯ä»¥äº¤äº’å¼åœ°æ‰§è¡Œå‘½ä»¤ã€‚Nucleiæ¨¡æ¿æä¾›äº†è¢«åŠ¨å’Œä¸»åŠ¨ä¸¤ç§æ‰«ææ–¹å¼ã€‚

4.  **æŠ•æ¯’é£é™©ï¼š**
   ä»“åº“çš„å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯ç”¨äºæ¼æ´æ£€æµ‹å’Œåˆ©ç”¨çš„ï¼Œåªæœ‰å°‘é‡ç”¨æˆ·äº¤äº’éƒ¨åˆ†ï¼Œä¾‹å¦‚å‘½ä»¤è¡Œè¾“å…¥ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨5%ã€‚ ä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨æ‰«ææˆ–åˆ©ç”¨è„šæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§,ä¾‹å¦‚åå¼¹shellæˆ–ä¸‹è½½æ‰§è¡Œæ¶æ„ç¨‹åºç­‰è¡Œä¸ºã€‚éœ€è¦äººå·¥å®¡æ ¸æ‰€æœ‰è„šæœ¬ä»£ç ï¼Œç‰¹åˆ«æ˜¯ä¸ç½‘ç»œè¯·æ±‚å’Œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œç›¸å…³çš„éƒ¨åˆ†ã€‚

**æ€»ç»“ï¼š** CVE-2024-51378æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ æ¼æ´åˆ©ç”¨POCå·²å…¬å¼€ï¼ŒCISA KEVä¹Ÿå·²ç»æ”¶å½•ï¼Œåˆ©ç”¨æ–¹å¼ç®€å•ï¼Œå¨èƒå·¨å¤§ã€‚éœ€è¦å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**æ¥æº**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-å‘½ä»¤æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** å‘½ä»¤æ³¨å…¥

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹å‘½ä»¤æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 2.3.6åŠ(æœªä¿®è¡¥)2.3.7

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºCyberPanelçš„dns/views.pyå’Œftp/views.pyä¸­çš„getresetstatusåŠŸèƒ½ã€‚ç”±äºsecMiddlewareä»…é’ˆå¯¹POSTè¯·æ±‚ï¼Œè¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡GETè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶åœ¨statusfileå±æ€§ä¸­ä½¿ç”¨shellå…ƒå­—ç¬¦ï¼Œé€šè¿‡è®¿é—®/dns/getresetstatusæˆ–/ftp/getresetstatusæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ 

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´åŸç†ï¼š** é€šè¿‡æ„é€ åŒ…å«shellå…ƒå­—ç¬¦çš„`statusfile`å‚æ•°ï¼Œå®ç°å‘½ä»¤æ³¨å…¥ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**
    *   **è¢«åŠ¨æ¨¡å¼ï¼ˆæ‰«æï¼‰ï¼š** é€šè¿‡GETè¯·æ±‚è®¿é—®`/ftp/getresetstatus`ï¼Œæ£€æŸ¥è¿”å›å†…å®¹æ˜¯å¦åŒ…å«`JSONDecodeError at /ftp/getresetstatus`ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚
    *   **ä¸»åŠ¨æ¨¡å¼ï¼ˆåˆ©ç”¨ï¼‰ï¼š**
        1.  å‘é€GETè¯·æ±‚è·å–`csrftoken`ã€‚
        2.  å‘é€OPTIONSè¯·æ±‚åˆ°`/ftp/getresetstatus`æˆ–`/dns/getresetstatus`ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å«è·å–çš„`csrftoken`ï¼Œå¹¶åœ¨payloadçš„`statusfile`å‚æ•°ä¸­æ³¨å…¥å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œ`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`ã€‚

3.  **æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`51378_use.py`å’ŒNucleiæ¨¡æ¿ï¼‰æœ‰æ•ˆã€‚`51378_use.py`è„šæœ¬å¯ä»¥äº¤äº’å¼åœ°æ‰§è¡Œå‘½ä»¤ã€‚Nucleiæ¨¡æ¿æä¾›äº†è¢«åŠ¨å’Œä¸»åŠ¨ä¸¤ç§æ‰«ææ–¹å¼ã€‚

4.  **æŠ•æ¯’é£é™©ï¼š**
   ä»“åº“çš„å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯ç”¨äºæ¼æ´æ£€æµ‹å’Œåˆ©ç”¨çš„ï¼Œåªæœ‰å°‘é‡ç”¨æˆ·äº¤äº’éƒ¨åˆ†ï¼Œä¾‹å¦‚å‘½ä»¤è¡Œè¾“å…¥ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨5%ã€‚ ä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨æ‰«ææˆ–åˆ©ç”¨è„šæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§,ä¾‹å¦‚åå¼¹shellæˆ–ä¸‹è½½æ‰§è¡Œæ¶æ„ç¨‹åºç­‰è¡Œä¸ºã€‚éœ€è¦äººå·¥å®¡æ ¸æ‰€æœ‰è„šæœ¬ä»£ç ï¼Œç‰¹åˆ«æ˜¯ä¸ç½‘ç»œè¯·æ±‚å’Œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œç›¸å…³çš„éƒ¨åˆ†ã€‚

**æ€»ç»“ï¼š** CVE-2024-51378æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ æ¼æ´åˆ©ç”¨POCå·²å…¬å¼€ï¼ŒCISA KEVä¹Ÿå·²ç»æ”¶å½•ï¼Œåˆ©ç”¨æ–¹å¼ç®€å•ï¼Œå¨èƒå·¨å¤§ã€‚éœ€è¦å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**æ¥æº**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-å‘½ä»¤æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** å‘½ä»¤æ³¨å…¥

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹å‘½ä»¤æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 2.3.6åŠ(æœªä¿®è¡¥)2.3.7

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºCyberPanelçš„dns/views.pyå’Œftp/views.pyä¸­çš„getresetstatusåŠŸèƒ½ã€‚ç”±äºsecMiddlewareä»…é’ˆå¯¹POSTè¯·æ±‚ï¼Œè¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡GETè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶åœ¨statusfileå±æ€§ä¸­ä½¿ç”¨shellå…ƒå­—ç¬¦ï¼Œé€šè¿‡è®¿é—®/dns/getresetstatusæˆ–/ftp/getresetstatusæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ 

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´åŸç†ï¼š** é€šè¿‡æ„é€ åŒ…å«shellå…ƒå­—ç¬¦çš„`statusfile`å‚æ•°ï¼Œå®ç°å‘½ä»¤æ³¨å…¥ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**
    *   **è¢«åŠ¨æ¨¡å¼ï¼ˆæ‰«æï¼‰ï¼š** é€šè¿‡GETè¯·æ±‚è®¿é—®`/ftp/getresetstatus`ï¼Œæ£€æŸ¥è¿”å›å†…å®¹æ˜¯å¦åŒ…å«`JSONDecodeError at /ftp/getresetstatus`ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚
    *   **ä¸»åŠ¨æ¨¡å¼ï¼ˆåˆ©ç”¨ï¼‰ï¼š**
        1.  å‘é€GETè¯·æ±‚è·å–`csrftoken`ã€‚
        2.  å‘é€OPTIONSè¯·æ±‚åˆ°`/ftp/getresetstatus`æˆ–`/dns/getresetstatus`ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å«è·å–çš„`csrftoken`ï¼Œå¹¶åœ¨payloadçš„`statusfile`å‚æ•°ä¸­æ³¨å…¥å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œ`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`ã€‚

3.  **æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`51378_use.py`å’ŒNucleiæ¨¡æ¿ï¼‰æœ‰æ•ˆã€‚`51378_use.py`è„šæœ¬å¯ä»¥äº¤äº’å¼åœ°æ‰§è¡Œå‘½ä»¤ã€‚Nucleiæ¨¡æ¿æä¾›äº†è¢«åŠ¨å’Œä¸»åŠ¨ä¸¤ç§æ‰«ææ–¹å¼ã€‚

4.  **æŠ•æ¯’é£é™©ï¼š**
   ä»“åº“çš„å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯ç”¨äºæ¼æ´æ£€æµ‹å’Œåˆ©ç”¨çš„ï¼Œåªæœ‰å°‘é‡ç”¨æˆ·äº¤äº’éƒ¨åˆ†ï¼Œä¾‹å¦‚å‘½ä»¤è¡Œè¾“å…¥ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨5%ã€‚ ä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨æ‰«ææˆ–åˆ©ç”¨è„šæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§,ä¾‹å¦‚åå¼¹shellæˆ–ä¸‹è½½æ‰§è¡Œæ¶æ„ç¨‹åºç­‰è¡Œä¸ºã€‚éœ€è¦äººå·¥å®¡æ ¸æ‰€æœ‰è„šæœ¬ä»£ç ï¼Œç‰¹åˆ«æ˜¯ä¸ç½‘ç»œè¯·æ±‚å’Œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œç›¸å…³çš„éƒ¨åˆ†ã€‚

**æ€»ç»“ï¼š** CVE-2024-51378æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ æ¼æ´åˆ©ç”¨POCå·²å…¬å¼€ï¼ŒCISA KEVä¹Ÿå·²ç»æ”¶å½•ï¼Œåˆ©ç”¨æ–¹å¼ç®€å•ï¼Œå¨èƒå·¨å¤§ã€‚éœ€è¦å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**æ¥æº**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-å‘½ä»¤æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** å‘½ä»¤æ³¨å…¥

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹å‘½ä»¤æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 2.3.6åŠ(æœªä¿®è¡¥)2.3.7

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºCyberPanelçš„dns/views.pyå’Œftp/views.pyä¸­çš„getresetstatusåŠŸèƒ½ã€‚ç”±äºsecMiddlewareä»…é’ˆå¯¹POSTè¯·æ±‚ï¼Œè¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡GETè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶åœ¨statusfileå±æ€§ä¸­ä½¿ç”¨shellå…ƒå­—ç¬¦ï¼Œé€šè¿‡è®¿é—®/dns/getresetstatusæˆ–/ftp/getresetstatusæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ 

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´åŸç†ï¼š** é€šè¿‡æ„é€ åŒ…å«shellå…ƒå­—ç¬¦çš„`statusfile`å‚æ•°ï¼Œå®ç°å‘½ä»¤æ³¨å…¥ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**
    *   **è¢«åŠ¨æ¨¡å¼ï¼ˆæ‰«æï¼‰ï¼š** é€šè¿‡GETè¯·æ±‚è®¿é—®`/ftp/getresetstatus`ï¼Œæ£€æŸ¥è¿”å›å†…å®¹æ˜¯å¦åŒ…å«`JSONDecodeError at /ftp/getresetstatus`ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚
    *   **ä¸»åŠ¨æ¨¡å¼ï¼ˆåˆ©ç”¨ï¼‰ï¼š**
        1.  å‘é€GETè¯·æ±‚è·å–`csrftoken`ã€‚
        2.  å‘é€OPTIONSè¯·æ±‚åˆ°`/ftp/getresetstatus`æˆ–`/dns/getresetstatus`ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å«è·å–çš„`csrftoken`ï¼Œå¹¶åœ¨payloadçš„`statusfile`å‚æ•°ä¸­æ³¨å…¥å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œ`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`ã€‚

3.  **æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`51378_use.py`å’ŒNucleiæ¨¡æ¿ï¼‰æœ‰æ•ˆã€‚`51378_use.py`è„šæœ¬å¯ä»¥äº¤äº’å¼åœ°æ‰§è¡Œå‘½ä»¤ã€‚Nucleiæ¨¡æ¿æä¾›äº†è¢«åŠ¨å’Œä¸»åŠ¨ä¸¤ç§æ‰«ææ–¹å¼ã€‚

4.  **æŠ•æ¯’é£é™©ï¼š**
   ä»“åº“çš„å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯ç”¨äºæ¼æ´æ£€æµ‹å’Œåˆ©ç”¨çš„ï¼Œåªæœ‰å°‘é‡ç”¨æˆ·äº¤äº’éƒ¨åˆ†ï¼Œä¾‹å¦‚å‘½ä»¤è¡Œè¾“å…¥ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨5%ã€‚ ä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨æ‰«ææˆ–åˆ©ç”¨è„šæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§,ä¾‹å¦‚åå¼¹shellæˆ–ä¸‹è½½æ‰§è¡Œæ¶æ„ç¨‹åºç­‰è¡Œä¸ºã€‚éœ€è¦äººå·¥å®¡æ ¸æ‰€æœ‰è„šæœ¬ä»£ç ï¼Œç‰¹åˆ«æ˜¯ä¸ç½‘ç»œè¯·æ±‚å’Œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œç›¸å…³çš„éƒ¨åˆ†ã€‚

**æ€»ç»“ï¼š** CVE-2024-51378æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ æ¼æ´åˆ©ç”¨POCå·²å…¬å¼€ï¼ŒCISA KEVä¹Ÿå·²ç»æ”¶å½•ï¼Œåˆ©ç”¨æ–¹å¼ç®€å•ï¼Œå¨èƒå·¨å¤§ã€‚éœ€è¦å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**æ¥æº**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** <= 2.3.6 and 2.3.7 (unpatched)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelç®¡ç†ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-51378 å­˜åœ¨äº CyberPanel çš„ `dns/views.py` å’Œ `ftp/views.py` ä¸­ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡ `/dns/getresetstatus` æˆ– `/ftp/getresetstatus` è·¯å¾„ï¼Œåˆ©ç”¨ `statusfile` å±æ€§ä¸­çš„ shell å…ƒå­—ç¬¦ï¼Œç»•è¿‡ `secMiddleware`ï¼ˆä»…é€‚ç”¨äº POST è¯·æ±‚ï¼‰å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PSAUX åœ¨ 2024 å¹´ 10 æœˆå·²åœ¨é‡å¤–åˆ©ç”¨æ­¤æ¼æ´ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´ä½ç½®**: `/dns/getresetstatus` å’Œ `/ftp/getresetstatus`ã€‚
2.  **ç»•è¿‡è®¤è¯**:  æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºç»•è¿‡ `secMiddleware`ï¼Œå› ä¸ºå®ƒåªé’ˆå¯¹ POST è¯·æ±‚è¿›è¡Œå®‰å…¨æ£€æŸ¥ï¼Œè€Œ GET è¯·æ±‚ä¸å—ä¿æŠ¤ã€‚
3.  **å‘½ä»¤æ³¨å…¥**: é€šè¿‡åœ¨ `statusfile` å‚æ•°ä¸­æ³¨å…¥ shell å…ƒå­—ç¬¦æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `;` æ¥è¿æ¥å‘½ä»¤ã€‚
4.  **PoC åˆ†æ**: æä¾›çš„ PoC ä»£ç  `run.py` è„šæœ¬é€šè¿‡ HTTP è¯·æ±‚å‘é€åŒ…å«æ¶æ„ `statusfile` å‚æ•°çš„ GET è¯·æ±‚ï¼Œä»è€Œè§¦å‘å‘½ä»¤æ³¨å…¥ã€‚è¯¥è„šæœ¬å…è®¸æŒ‡å®šç›®æ ‡ IP åœ°å€åˆ—è¡¨å’Œè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å¦‚æœä¸æŒ‡å®šå‘½ä»¤ï¼Œé»˜è®¤ä¼šéƒ¨ç½² SSH å…¬é’¥åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå®ç°æŒä¹…è®¿é—®ã€‚
5. **æŠ•æ¯’é£é™©**: è„šæœ¬ä¸­åŒ…å«ä¸€ä¸ªé»˜è®¤ssh keyçš„å˜é‡,è‹¥æœªä¿®æ”¹,æ‰€æœ‰ä½¿ç”¨æ­¤è„šæœ¬çš„äººéƒ½ä¼šæ¤å…¥ç›¸åŒçš„å…¬é’¥,ä»è€Œå¯¼è‡´å…¶ä»–äººå¯ä»¥åˆ©ç”¨æ­¤åé—¨è¿›è¡Œæ§åˆ¶,æ‰€ä»¥æœ‰ä¸€å®šæŠ•æ¯’é£é™©.å¦å¤–è„šæœ¬ç¼–å†™å­˜åœ¨ä¸å®Œæ•´ï¼ŒtokenCSRFå‡½æ•°æ²¡æœ‰return,è¿è¡Œç›´æ¥æŠ¥é”™ï¼Œåˆ©ç”¨å­˜åœ¨é£é™©.é£é™©å æ¯”5%ã€‚
6.  **ç¼“è§£æªæ–½**: ç«‹å³å°† CyberPanel æ›´æ–°åˆ° >= 2.3.8 ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•ç«‹å³æ›´æ–°ï¼Œè¯·é€šè¿‡é˜²ç«å¢™æˆ–ç½‘ç»œ ACL é™åˆ¶å¯¹é¢æ¿çš„è®¿é—®ï¼Œå¹¶åº”ç”¨ WAF/IPS è§„åˆ™æ¥é˜»æ­¢å¯ç–‘è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**æ¥æº**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** <= 2.3.6 and 2.3.7 (unpatched)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelç®¡ç†ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-51378 å­˜åœ¨äº CyberPanel çš„ `dns/views.py` å’Œ `ftp/views.py` ä¸­ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡ `/dns/getresetstatus` æˆ– `/ftp/getresetstatus` è·¯å¾„ï¼Œåˆ©ç”¨ `statusfile` å±æ€§ä¸­çš„ shell å…ƒå­—ç¬¦ï¼Œç»•è¿‡ `secMiddleware`ï¼ˆä»…é€‚ç”¨äº POST è¯·æ±‚ï¼‰å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PSAUX åœ¨ 2024 å¹´ 10 æœˆå·²åœ¨é‡å¤–åˆ©ç”¨æ­¤æ¼æ´ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´ä½ç½®**: `/dns/getresetstatus` å’Œ `/ftp/getresetstatus`ã€‚
2.  **ç»•è¿‡è®¤è¯**:  æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºç»•è¿‡ `secMiddleware`ï¼Œå› ä¸ºå®ƒåªé’ˆå¯¹ POST è¯·æ±‚è¿›è¡Œå®‰å…¨æ£€æŸ¥ï¼Œè€Œ GET è¯·æ±‚ä¸å—ä¿æŠ¤ã€‚
3.  **å‘½ä»¤æ³¨å…¥**: é€šè¿‡åœ¨ `statusfile` å‚æ•°ä¸­æ³¨å…¥ shell å…ƒå­—ç¬¦æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `;` æ¥è¿æ¥å‘½ä»¤ã€‚
4.  **PoC åˆ†æ**: æä¾›çš„ PoC ä»£ç  `run.py` è„šæœ¬é€šè¿‡ HTTP è¯·æ±‚å‘é€åŒ…å«æ¶æ„ `statusfile` å‚æ•°çš„ GET è¯·æ±‚ï¼Œä»è€Œè§¦å‘å‘½ä»¤æ³¨å…¥ã€‚è¯¥è„šæœ¬å…è®¸æŒ‡å®šç›®æ ‡ IP åœ°å€åˆ—è¡¨å’Œè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å¦‚æœä¸æŒ‡å®šå‘½ä»¤ï¼Œé»˜è®¤ä¼šéƒ¨ç½² SSH å…¬é’¥åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå®ç°æŒä¹…è®¿é—®ã€‚
5. **æŠ•æ¯’é£é™©**: è„šæœ¬ä¸­åŒ…å«ä¸€ä¸ªé»˜è®¤ssh keyçš„å˜é‡,è‹¥æœªä¿®æ”¹,æ‰€æœ‰ä½¿ç”¨æ­¤è„šæœ¬çš„äººéƒ½ä¼šæ¤å…¥ç›¸åŒçš„å…¬é’¥,ä»è€Œå¯¼è‡´å…¶ä»–äººå¯ä»¥åˆ©ç”¨æ­¤åé—¨è¿›è¡Œæ§åˆ¶,æ‰€ä»¥æœ‰ä¸€å®šæŠ•æ¯’é£é™©.å¦å¤–è„šæœ¬ç¼–å†™å­˜åœ¨ä¸å®Œæ•´ï¼ŒtokenCSRFå‡½æ•°æ²¡æœ‰return,è¿è¡Œç›´æ¥æŠ¥é”™ï¼Œåˆ©ç”¨å­˜åœ¨é£é™©.é£é™©å æ¯”5%ã€‚
6.  **ç¼“è§£æªæ–½**: ç«‹å³å°† CyberPanel æ›´æ–°åˆ° >= 2.3.8 ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•ç«‹å³æ›´æ–°ï¼Œè¯·é€šè¿‡é˜²ç«å¢™æˆ–ç½‘ç»œ ACL é™åˆ¶å¯¹é¢æ¿çš„è®¿é—®ï¼Œå¹¶åº”ç”¨ WAF/IPS è§„åˆ™æ¥é˜»æ­¢å¯ç–‘è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**æ¥æº**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** <= 2.3.6 and 2.3.7 (unpatched)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelç®¡ç†ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-51378 å­˜åœ¨äº CyberPanel çš„ `dns/views.py` å’Œ `ftp/views.py` ä¸­ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡ `/dns/getresetstatus` æˆ– `/ftp/getresetstatus` è·¯å¾„ï¼Œåˆ©ç”¨ `statusfile` å±æ€§ä¸­çš„ shell å…ƒå­—ç¬¦ï¼Œç»•è¿‡ `secMiddleware`ï¼ˆä»…é€‚ç”¨äº POST è¯·æ±‚ï¼‰å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PSAUX åœ¨ 2024 å¹´ 10 æœˆå·²åœ¨é‡å¤–åˆ©ç”¨æ­¤æ¼æ´ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´ä½ç½®**: `/dns/getresetstatus` å’Œ `/ftp/getresetstatus`ã€‚
2.  **ç»•è¿‡è®¤è¯**:  æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºç»•è¿‡ `secMiddleware`ï¼Œå› ä¸ºå®ƒåªé’ˆå¯¹ POST è¯·æ±‚è¿›è¡Œå®‰å…¨æ£€æŸ¥ï¼Œè€Œ GET è¯·æ±‚ä¸å—ä¿æŠ¤ã€‚
3.  **å‘½ä»¤æ³¨å…¥**: é€šè¿‡åœ¨ `statusfile` å‚æ•°ä¸­æ³¨å…¥ shell å…ƒå­—ç¬¦æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `;` æ¥è¿æ¥å‘½ä»¤ã€‚
4.  **PoC åˆ†æ**: æä¾›çš„ PoC ä»£ç  `run.py` è„šæœ¬é€šè¿‡ HTTP è¯·æ±‚å‘é€åŒ…å«æ¶æ„ `statusfile` å‚æ•°çš„ GET è¯·æ±‚ï¼Œä»è€Œè§¦å‘å‘½ä»¤æ³¨å…¥ã€‚è¯¥è„šæœ¬å…è®¸æŒ‡å®šç›®æ ‡ IP åœ°å€åˆ—è¡¨å’Œè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å¦‚æœä¸æŒ‡å®šå‘½ä»¤ï¼Œé»˜è®¤ä¼šéƒ¨ç½² SSH å…¬é’¥åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå®ç°æŒä¹…è®¿é—®ã€‚
5. **æŠ•æ¯’é£é™©**: è„šæœ¬ä¸­åŒ…å«ä¸€ä¸ªé»˜è®¤ssh keyçš„å˜é‡,è‹¥æœªä¿®æ”¹,æ‰€æœ‰ä½¿ç”¨æ­¤è„šæœ¬çš„äººéƒ½ä¼šæ¤å…¥ç›¸åŒçš„å…¬é’¥,ä»è€Œå¯¼è‡´å…¶ä»–äººå¯ä»¥åˆ©ç”¨æ­¤åé—¨è¿›è¡Œæ§åˆ¶,æ‰€ä»¥æœ‰ä¸€å®šæŠ•æ¯’é£é™©.å¦å¤–è„šæœ¬ç¼–å†™å­˜åœ¨ä¸å®Œæ•´ï¼ŒtokenCSRFå‡½æ•°æ²¡æœ‰return,è¿è¡Œç›´æ¥æŠ¥é”™ï¼Œåˆ©ç”¨å­˜åœ¨é£é™©.é£é™©å æ¯”5%ã€‚
6.  **ç¼“è§£æªæ–½**: ç«‹å³å°† CyberPanel æ›´æ–°åˆ° >= 2.3.8 ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•ç«‹å³æ›´æ–°ï¼Œè¯·é€šè¿‡é˜²ç«å¢™æˆ–ç½‘ç»œ ACL é™åˆ¶å¯¹é¢æ¿çš„è®¿é—®ï¼Œå¹¶åº”ç”¨ WAF/IPS è§„åˆ™æ¥é˜»æ­¢å¯ç–‘è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**æ¥æº**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** <= 2.3.6 and 2.3.7 (unpatched)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelç®¡ç†ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-51378 å­˜åœ¨äº CyberPanel çš„ `dns/views.py` å’Œ `ftp/views.py` ä¸­ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡ `/dns/getresetstatus` æˆ– `/ftp/getresetstatus` è·¯å¾„ï¼Œåˆ©ç”¨ `statusfile` å±æ€§ä¸­çš„ shell å…ƒå­—ç¬¦ï¼Œç»•è¿‡ `secMiddleware`ï¼ˆä»…é€‚ç”¨äº POST è¯·æ±‚ï¼‰å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PSAUX åœ¨ 2024 å¹´ 10 æœˆå·²åœ¨é‡å¤–åˆ©ç”¨æ­¤æ¼æ´ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´ä½ç½®**: `/dns/getresetstatus` å’Œ `/ftp/getresetstatus`ã€‚
2.  **ç»•è¿‡è®¤è¯**:  æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºç»•è¿‡ `secMiddleware`ï¼Œå› ä¸ºå®ƒåªé’ˆå¯¹ POST è¯·æ±‚è¿›è¡Œå®‰å…¨æ£€æŸ¥ï¼Œè€Œ GET è¯·æ±‚ä¸å—ä¿æŠ¤ã€‚
3.  **å‘½ä»¤æ³¨å…¥**: é€šè¿‡åœ¨ `statusfile` å‚æ•°ä¸­æ³¨å…¥ shell å…ƒå­—ç¬¦æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `;` æ¥è¿æ¥å‘½ä»¤ã€‚
4.  **PoC åˆ†æ**: æä¾›çš„ PoC ä»£ç  `run.py` è„šæœ¬é€šè¿‡ HTTP è¯·æ±‚å‘é€åŒ…å«æ¶æ„ `statusfile` å‚æ•°çš„ GET è¯·æ±‚ï¼Œä»è€Œè§¦å‘å‘½ä»¤æ³¨å…¥ã€‚è¯¥è„šæœ¬å…è®¸æŒ‡å®šç›®æ ‡ IP åœ°å€åˆ—è¡¨å’Œè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å¦‚æœä¸æŒ‡å®šå‘½ä»¤ï¼Œé»˜è®¤ä¼šéƒ¨ç½² SSH å…¬é’¥åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå®ç°æŒä¹…è®¿é—®ã€‚
5. **æŠ•æ¯’é£é™©**: è„šæœ¬ä¸­åŒ…å«ä¸€ä¸ªé»˜è®¤ssh keyçš„å˜é‡,è‹¥æœªä¿®æ”¹,æ‰€æœ‰ä½¿ç”¨æ­¤è„šæœ¬çš„äººéƒ½ä¼šæ¤å…¥ç›¸åŒçš„å…¬é’¥,ä»è€Œå¯¼è‡´å…¶ä»–äººå¯ä»¥åˆ©ç”¨æ­¤åé—¨è¿›è¡Œæ§åˆ¶,æ‰€ä»¥æœ‰ä¸€å®šæŠ•æ¯’é£é™©.å¦å¤–è„šæœ¬ç¼–å†™å­˜åœ¨ä¸å®Œæ•´ï¼ŒtokenCSRFå‡½æ•°æ²¡æœ‰return,è¿è¡Œç›´æ¥æŠ¥é”™ï¼Œåˆ©ç”¨å­˜åœ¨é£é™©.é£é™©å æ¯”5%ã€‚
6.  **ç¼“è§£æªæ–½**: ç«‹å³å°† CyberPanel æ›´æ–°åˆ° >= 2.3.8 ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•ç«‹å³æ›´æ–°ï¼Œè¯·é€šè¿‡é˜²ç«å¢™æˆ–ç½‘ç»œ ACL é™åˆ¶å¯¹é¢æ¿çš„è®¿é—®ï¼Œå¹¶åº”ç”¨ WAF/IPS è§„åˆ™æ¥é˜»æ­¢å¯ç–‘è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**æ¥æº**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** <= 2.3.6 and 2.3.7 (unpatched)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelç®¡ç†ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-51378 å­˜åœ¨äº CyberPanel çš„ `dns/views.py` å’Œ `ftp/views.py` ä¸­ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡ `/dns/getresetstatus` æˆ– `/ftp/getresetstatus` è·¯å¾„ï¼Œåˆ©ç”¨ `statusfile` å±æ€§ä¸­çš„ shell å…ƒå­—ç¬¦ï¼Œç»•è¿‡ `secMiddleware`ï¼ˆä»…é€‚ç”¨äº POST è¯·æ±‚ï¼‰å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PSAUX åœ¨ 2024 å¹´ 10 æœˆå·²åœ¨é‡å¤–åˆ©ç”¨æ­¤æ¼æ´ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´ä½ç½®**: `/dns/getresetstatus` å’Œ `/ftp/getresetstatus`ã€‚
2.  **ç»•è¿‡è®¤è¯**:  æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºç»•è¿‡ `secMiddleware`ï¼Œå› ä¸ºå®ƒåªé’ˆå¯¹ POST è¯·æ±‚è¿›è¡Œå®‰å…¨æ£€æŸ¥ï¼Œè€Œ GET è¯·æ±‚ä¸å—ä¿æŠ¤ã€‚
3.  **å‘½ä»¤æ³¨å…¥**: é€šè¿‡åœ¨ `statusfile` å‚æ•°ä¸­æ³¨å…¥ shell å…ƒå­—ç¬¦æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `;` æ¥è¿æ¥å‘½ä»¤ã€‚
4.  **PoC åˆ†æ**: æä¾›çš„ PoC ä»£ç  `run.py` è„šæœ¬é€šè¿‡ HTTP è¯·æ±‚å‘é€åŒ…å«æ¶æ„ `statusfile` å‚æ•°çš„ GET è¯·æ±‚ï¼Œä»è€Œè§¦å‘å‘½ä»¤æ³¨å…¥ã€‚è¯¥è„šæœ¬å…è®¸æŒ‡å®šç›®æ ‡ IP åœ°å€åˆ—è¡¨å’Œè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å¦‚æœä¸æŒ‡å®šå‘½ä»¤ï¼Œé»˜è®¤ä¼šéƒ¨ç½² SSH å…¬é’¥åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå®ç°æŒä¹…è®¿é—®ã€‚
5. **æŠ•æ¯’é£é™©**: è„šæœ¬ä¸­åŒ…å«ä¸€ä¸ªé»˜è®¤ssh keyçš„å˜é‡,è‹¥æœªä¿®æ”¹,æ‰€æœ‰ä½¿ç”¨æ­¤è„šæœ¬çš„äººéƒ½ä¼šæ¤å…¥ç›¸åŒçš„å…¬é’¥,ä»è€Œå¯¼è‡´å…¶ä»–äººå¯ä»¥åˆ©ç”¨æ­¤åé—¨è¿›è¡Œæ§åˆ¶,æ‰€ä»¥æœ‰ä¸€å®šæŠ•æ¯’é£é™©.å¦å¤–è„šæœ¬ç¼–å†™å­˜åœ¨ä¸å®Œæ•´ï¼ŒtokenCSRFå‡½æ•°æ²¡æœ‰return,è¿è¡Œç›´æ¥æŠ¥é”™ï¼Œåˆ©ç”¨å­˜åœ¨é£é™©.é£é™©å æ¯”5%ã€‚
6.  **ç¼“è§£æªæ–½**: ç«‹å³å°† CyberPanel æ›´æ–°åˆ° >= 2.3.8 ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•ç«‹å³æ›´æ–°ï¼Œè¯·é€šè¿‡é˜²ç«å¢™æˆ–ç½‘ç»œ ACL é™åˆ¶å¯¹é¢æ¿çš„è®¿é—®ï¼Œå¹¶åº”ç”¨ WAF/IPS è§„åˆ™æ¥é˜»æ­¢å¯ç–‘è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**æ¥æº**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** <= 2.3.6 and 2.3.7 (unpatched)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelç®¡ç†ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-51378 å­˜åœ¨äº CyberPanel çš„ `dns/views.py` å’Œ `ftp/views.py` ä¸­ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡ `/dns/getresetstatus` æˆ– `/ftp/getresetstatus` è·¯å¾„ï¼Œåˆ©ç”¨ `statusfile` å±æ€§ä¸­çš„ shell å…ƒå­—ç¬¦ï¼Œç»•è¿‡ `secMiddleware`ï¼ˆä»…é€‚ç”¨äº POST è¯·æ±‚ï¼‰å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PSAUX åœ¨ 2024 å¹´ 10 æœˆå·²åœ¨é‡å¤–åˆ©ç”¨æ­¤æ¼æ´ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´ä½ç½®**: `/dns/getresetstatus` å’Œ `/ftp/getresetstatus`ã€‚
2.  **ç»•è¿‡è®¤è¯**:  æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºç»•è¿‡ `secMiddleware`ï¼Œå› ä¸ºå®ƒåªé’ˆå¯¹ POST è¯·æ±‚è¿›è¡Œå®‰å…¨æ£€æŸ¥ï¼Œè€Œ GET è¯·æ±‚ä¸å—ä¿æŠ¤ã€‚
3.  **å‘½ä»¤æ³¨å…¥**: é€šè¿‡åœ¨ `statusfile` å‚æ•°ä¸­æ³¨å…¥ shell å…ƒå­—ç¬¦æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `;` æ¥è¿æ¥å‘½ä»¤ã€‚
4.  **PoC åˆ†æ**: æä¾›çš„ PoC ä»£ç  `run.py` è„šæœ¬é€šè¿‡ HTTP è¯·æ±‚å‘é€åŒ…å«æ¶æ„ `statusfile` å‚æ•°çš„ GET è¯·æ±‚ï¼Œä»è€Œè§¦å‘å‘½ä»¤æ³¨å…¥ã€‚è¯¥è„šæœ¬å…è®¸æŒ‡å®šç›®æ ‡ IP åœ°å€åˆ—è¡¨å’Œè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å¦‚æœä¸æŒ‡å®šå‘½ä»¤ï¼Œé»˜è®¤ä¼šéƒ¨ç½² SSH å…¬é’¥åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå®ç°æŒä¹…è®¿é—®ã€‚
5. **æŠ•æ¯’é£é™©**: è„šæœ¬ä¸­åŒ…å«ä¸€ä¸ªé»˜è®¤ssh keyçš„å˜é‡,è‹¥æœªä¿®æ”¹,æ‰€æœ‰ä½¿ç”¨æ­¤è„šæœ¬çš„äººéƒ½ä¼šæ¤å…¥ç›¸åŒçš„å…¬é’¥,ä»è€Œå¯¼è‡´å…¶ä»–äººå¯ä»¥åˆ©ç”¨æ­¤åé—¨è¿›è¡Œæ§åˆ¶,æ‰€ä»¥æœ‰ä¸€å®šæŠ•æ¯’é£é™©.å¦å¤–è„šæœ¬ç¼–å†™å­˜åœ¨ä¸å®Œæ•´ï¼ŒtokenCSRFå‡½æ•°æ²¡æœ‰return,è¿è¡Œç›´æ¥æŠ¥é”™ï¼Œåˆ©ç”¨å­˜åœ¨é£é™©.é£é™©å æ¯”5%ã€‚
6.  **ç¼“è§£æªæ–½**: ç«‹å³å°† CyberPanel æ›´æ–°åˆ° >= 2.3.8 ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•ç«‹å³æ›´æ–°ï¼Œè¯·é€šè¿‡é˜²ç«å¢™æˆ–ç½‘ç»œ ACL é™åˆ¶å¯¹é¢æ¿çš„è®¿é—®ï¼Œå¹¶åº”ç”¨ WAF/IPS è§„åˆ™æ¥é˜»æ­¢å¯ç–‘è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**æ¥æº**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** <= 2.3.6 and 2.3.7 (unpatched)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelç®¡ç†ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-51378 å­˜åœ¨äº CyberPanel çš„ `dns/views.py` å’Œ `ftp/views.py` ä¸­ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡ `/dns/getresetstatus` æˆ– `/ftp/getresetstatus` è·¯å¾„ï¼Œåˆ©ç”¨ `statusfile` å±æ€§ä¸­çš„ shell å…ƒå­—ç¬¦ï¼Œç»•è¿‡ `secMiddleware`ï¼ˆä»…é€‚ç”¨äº POST è¯·æ±‚ï¼‰å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PSAUX åœ¨ 2024 å¹´ 10 æœˆå·²åœ¨é‡å¤–åˆ©ç”¨æ­¤æ¼æ´ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´ä½ç½®**: `/dns/getresetstatus` å’Œ `/ftp/getresetstatus`ã€‚
2.  **ç»•è¿‡è®¤è¯**:  æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºç»•è¿‡ `secMiddleware`ï¼Œå› ä¸ºå®ƒåªé’ˆå¯¹ POST è¯·æ±‚è¿›è¡Œå®‰å…¨æ£€æŸ¥ï¼Œè€Œ GET è¯·æ±‚ä¸å—ä¿æŠ¤ã€‚
3.  **å‘½ä»¤æ³¨å…¥**: é€šè¿‡åœ¨ `statusfile` å‚æ•°ä¸­æ³¨å…¥ shell å…ƒå­—ç¬¦æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `;` æ¥è¿æ¥å‘½ä»¤ã€‚
4.  **PoC åˆ†æ**: æä¾›çš„ PoC ä»£ç  `run.py` è„šæœ¬é€šè¿‡ HTTP è¯·æ±‚å‘é€åŒ…å«æ¶æ„ `statusfile` å‚æ•°çš„ GET è¯·æ±‚ï¼Œä»è€Œè§¦å‘å‘½ä»¤æ³¨å…¥ã€‚è¯¥è„šæœ¬å…è®¸æŒ‡å®šç›®æ ‡ IP åœ°å€åˆ—è¡¨å’Œè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å¦‚æœä¸æŒ‡å®šå‘½ä»¤ï¼Œé»˜è®¤ä¼šéƒ¨ç½² SSH å…¬é’¥åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå®ç°æŒä¹…è®¿é—®ã€‚
5. **æŠ•æ¯’é£é™©**: è„šæœ¬ä¸­åŒ…å«ä¸€ä¸ªé»˜è®¤ssh keyçš„å˜é‡,è‹¥æœªä¿®æ”¹,æ‰€æœ‰ä½¿ç”¨æ­¤è„šæœ¬çš„äººéƒ½ä¼šæ¤å…¥ç›¸åŒçš„å…¬é’¥,ä»è€Œå¯¼è‡´å…¶ä»–äººå¯ä»¥åˆ©ç”¨æ­¤åé—¨è¿›è¡Œæ§åˆ¶,æ‰€ä»¥æœ‰ä¸€å®šæŠ•æ¯’é£é™©.å¦å¤–è„šæœ¬ç¼–å†™å­˜åœ¨ä¸å®Œæ•´ï¼ŒtokenCSRFå‡½æ•°æ²¡æœ‰return,è¿è¡Œç›´æ¥æŠ¥é”™ï¼Œåˆ©ç”¨å­˜åœ¨é£é™©.é£é™©å æ¯”5%ã€‚
6.  **ç¼“è§£æªæ–½**: ç«‹å³å°† CyberPanel æ›´æ–°åˆ° >= 2.3.8 ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•ç«‹å³æ›´æ–°ï¼Œè¯·é€šè¿‡é˜²ç«å¢™æˆ–ç½‘ç»œ ACL é™åˆ¶å¯¹é¢æ¿çš„è®¿é—®ï¼Œå¹¶åº”ç”¨ WAF/IPS è§„åˆ™æ¥é˜»æ­¢å¯ç–‘è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**æ¥æº**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** <= 2.3.6 and 2.3.7 (unpatched)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelç®¡ç†ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-51378 å­˜åœ¨äº CyberPanel çš„ `dns/views.py` å’Œ `ftp/views.py` ä¸­ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡ `/dns/getresetstatus` æˆ– `/ftp/getresetstatus` è·¯å¾„ï¼Œåˆ©ç”¨ `statusfile` å±æ€§ä¸­çš„ shell å…ƒå­—ç¬¦ï¼Œç»•è¿‡ `secMiddleware`ï¼ˆä»…é€‚ç”¨äº POST è¯·æ±‚ï¼‰å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PSAUX åœ¨ 2024 å¹´ 10 æœˆå·²åœ¨é‡å¤–åˆ©ç”¨æ­¤æ¼æ´ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´ä½ç½®**: `/dns/getresetstatus` å’Œ `/ftp/getresetstatus`ã€‚
2.  **ç»•è¿‡è®¤è¯**:  æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºç»•è¿‡ `secMiddleware`ï¼Œå› ä¸ºå®ƒåªé’ˆå¯¹ POST è¯·æ±‚è¿›è¡Œå®‰å…¨æ£€æŸ¥ï¼Œè€Œ GET è¯·æ±‚ä¸å—ä¿æŠ¤ã€‚
3.  **å‘½ä»¤æ³¨å…¥**: é€šè¿‡åœ¨ `statusfile` å‚æ•°ä¸­æ³¨å…¥ shell å…ƒå­—ç¬¦æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `;` æ¥è¿æ¥å‘½ä»¤ã€‚
4.  **PoC åˆ†æ**: æä¾›çš„ PoC ä»£ç  `run.py` è„šæœ¬é€šè¿‡ HTTP è¯·æ±‚å‘é€åŒ…å«æ¶æ„ `statusfile` å‚æ•°çš„ GET è¯·æ±‚ï¼Œä»è€Œè§¦å‘å‘½ä»¤æ³¨å…¥ã€‚è¯¥è„šæœ¬å…è®¸æŒ‡å®šç›®æ ‡ IP åœ°å€åˆ—è¡¨å’Œè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å¦‚æœä¸æŒ‡å®šå‘½ä»¤ï¼Œé»˜è®¤ä¼šéƒ¨ç½² SSH å…¬é’¥åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå®ç°æŒä¹…è®¿é—®ã€‚
5. **æŠ•æ¯’é£é™©**: è„šæœ¬ä¸­åŒ…å«ä¸€ä¸ªé»˜è®¤ssh keyçš„å˜é‡,è‹¥æœªä¿®æ”¹,æ‰€æœ‰ä½¿ç”¨æ­¤è„šæœ¬çš„äººéƒ½ä¼šæ¤å…¥ç›¸åŒçš„å…¬é’¥,ä»è€Œå¯¼è‡´å…¶ä»–äººå¯ä»¥åˆ©ç”¨æ­¤åé—¨è¿›è¡Œæ§åˆ¶,æ‰€ä»¥æœ‰ä¸€å®šæŠ•æ¯’é£é™©.å¦å¤–è„šæœ¬ç¼–å†™å­˜åœ¨ä¸å®Œæ•´ï¼ŒtokenCSRFå‡½æ•°æ²¡æœ‰return,è¿è¡Œç›´æ¥æŠ¥é”™ï¼Œåˆ©ç”¨å­˜åœ¨é£é™©.é£é™©å æ¯”5%ã€‚
6.  **ç¼“è§£æªæ–½**: ç«‹å³å°† CyberPanel æ›´æ–°åˆ° >= 2.3.8 ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•ç«‹å³æ›´æ–°ï¼Œè¯·é€šè¿‡é˜²ç«å¢™æˆ–ç½‘ç»œ ACL é™åˆ¶å¯¹é¢æ¿çš„è®¿é—®ï¼Œå¹¶åº”ç”¨ WAF/IPS è§„åˆ™æ¥é˜»æ­¢å¯ç–‘è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**æ¥æº**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** <= 2.3.6 and 2.3.7 (unpatched)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelç®¡ç†ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-51378 å­˜åœ¨äº CyberPanel çš„ `dns/views.py` å’Œ `ftp/views.py` ä¸­ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡ `/dns/getresetstatus` æˆ– `/ftp/getresetstatus` è·¯å¾„ï¼Œåˆ©ç”¨ `statusfile` å±æ€§ä¸­çš„ shell å…ƒå­—ç¬¦ï¼Œç»•è¿‡ `secMiddleware`ï¼ˆä»…é€‚ç”¨äº POST è¯·æ±‚ï¼‰å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PSAUX åœ¨ 2024 å¹´ 10 æœˆå·²åœ¨é‡å¤–åˆ©ç”¨æ­¤æ¼æ´ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´ä½ç½®**: `/dns/getresetstatus` å’Œ `/ftp/getresetstatus`ã€‚
2.  **ç»•è¿‡è®¤è¯**:  æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºç»•è¿‡ `secMiddleware`ï¼Œå› ä¸ºå®ƒåªé’ˆå¯¹ POST è¯·æ±‚è¿›è¡Œå®‰å…¨æ£€æŸ¥ï¼Œè€Œ GET è¯·æ±‚ä¸å—ä¿æŠ¤ã€‚
3.  **å‘½ä»¤æ³¨å…¥**: é€šè¿‡åœ¨ `statusfile` å‚æ•°ä¸­æ³¨å…¥ shell å…ƒå­—ç¬¦æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `;` æ¥è¿æ¥å‘½ä»¤ã€‚
4.  **PoC åˆ†æ**: æä¾›çš„ PoC ä»£ç  `run.py` è„šæœ¬é€šè¿‡ HTTP è¯·æ±‚å‘é€åŒ…å«æ¶æ„ `statusfile` å‚æ•°çš„ GET è¯·æ±‚ï¼Œä»è€Œè§¦å‘å‘½ä»¤æ³¨å…¥ã€‚è¯¥è„šæœ¬å…è®¸æŒ‡å®šç›®æ ‡ IP åœ°å€åˆ—è¡¨å’Œè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å¦‚æœä¸æŒ‡å®šå‘½ä»¤ï¼Œé»˜è®¤ä¼šéƒ¨ç½² SSH å…¬é’¥åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå®ç°æŒä¹…è®¿é—®ã€‚
5. **æŠ•æ¯’é£é™©**: è„šæœ¬ä¸­åŒ…å«ä¸€ä¸ªé»˜è®¤ssh keyçš„å˜é‡,è‹¥æœªä¿®æ”¹,æ‰€æœ‰ä½¿ç”¨æ­¤è„šæœ¬çš„äººéƒ½ä¼šæ¤å…¥ç›¸åŒçš„å…¬é’¥,ä»è€Œå¯¼è‡´å…¶ä»–äººå¯ä»¥åˆ©ç”¨æ­¤åé—¨è¿›è¡Œæ§åˆ¶,æ‰€ä»¥æœ‰ä¸€å®šæŠ•æ¯’é£é™©.å¦å¤–è„šæœ¬ç¼–å†™å­˜åœ¨ä¸å®Œæ•´ï¼ŒtokenCSRFå‡½æ•°æ²¡æœ‰return,è¿è¡Œç›´æ¥æŠ¥é”™ï¼Œåˆ©ç”¨å­˜åœ¨é£é™©.é£é™©å æ¯”5%ã€‚
6.  **ç¼“è§£æªæ–½**: ç«‹å³å°† CyberPanel æ›´æ–°åˆ° >= 2.3.8 ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•ç«‹å³æ›´æ–°ï¼Œè¯·é€šè¿‡é˜²ç«å¢™æˆ–ç½‘ç»œ ACL é™åˆ¶å¯¹é¢æ¿çš„è®¿é—®ï¼Œå¹¶åº”ç”¨ WAF/IPS è§„åˆ™æ¥é˜»æ­¢å¯ç–‘è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**æ¥æº**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-51378

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** CyberPanel

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** <= 2.3.6 and 2.3.7 (unpatched)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®CyberPanelç®¡ç†ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-51378 å­˜åœ¨äº CyberPanel çš„ `dns/views.py` å’Œ `ftp/views.py` ä¸­ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡ `/dns/getresetstatus` æˆ– `/ftp/getresetstatus` è·¯å¾„ï¼Œåˆ©ç”¨ `statusfile` å±æ€§ä¸­çš„ shell å…ƒå­—ç¬¦ï¼Œç»•è¿‡ `secMiddleware`ï¼ˆä»…é€‚ç”¨äº POST è¯·æ±‚ï¼‰å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PSAUX åœ¨ 2024 å¹´ 10 æœˆå·²åœ¨é‡å¤–åˆ©ç”¨æ­¤æ¼æ´ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´ä½ç½®**: `/dns/getresetstatus` å’Œ `/ftp/getresetstatus`ã€‚
2.  **ç»•è¿‡è®¤è¯**:  æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºç»•è¿‡ `secMiddleware`ï¼Œå› ä¸ºå®ƒåªé’ˆå¯¹ POST è¯·æ±‚è¿›è¡Œå®‰å…¨æ£€æŸ¥ï¼Œè€Œ GET è¯·æ±‚ä¸å—ä¿æŠ¤ã€‚
3.  **å‘½ä»¤æ³¨å…¥**: é€šè¿‡åœ¨ `statusfile` å‚æ•°ä¸­æ³¨å…¥ shell å…ƒå­—ç¬¦æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `;` æ¥è¿æ¥å‘½ä»¤ã€‚
4.  **PoC åˆ†æ**: æä¾›çš„ PoC ä»£ç  `run.py` è„šæœ¬é€šè¿‡ HTTP è¯·æ±‚å‘é€åŒ…å«æ¶æ„ `statusfile` å‚æ•°çš„ GET è¯·æ±‚ï¼Œä»è€Œè§¦å‘å‘½ä»¤æ³¨å…¥ã€‚è¯¥è„šæœ¬å…è®¸æŒ‡å®šç›®æ ‡ IP åœ°å€åˆ—è¡¨å’Œè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å¦‚æœä¸æŒ‡å®šå‘½ä»¤ï¼Œé»˜è®¤ä¼šéƒ¨ç½² SSH å…¬é’¥åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå®ç°æŒä¹…è®¿é—®ã€‚
5. **æŠ•æ¯’é£é™©**: è„šæœ¬ä¸­åŒ…å«ä¸€ä¸ªé»˜è®¤ssh keyçš„å˜é‡,è‹¥æœªä¿®æ”¹,æ‰€æœ‰ä½¿ç”¨æ­¤è„šæœ¬çš„äººéƒ½ä¼šæ¤å…¥ç›¸åŒçš„å…¬é’¥,ä»è€Œå¯¼è‡´å…¶ä»–äººå¯ä»¥åˆ©ç”¨æ­¤åé—¨è¿›è¡Œæ§åˆ¶,æ‰€ä»¥æœ‰ä¸€å®šæŠ•æ¯’é£é™©.å¦å¤–è„šæœ¬ç¼–å†™å­˜åœ¨ä¸å®Œæ•´ï¼ŒtokenCSRFå‡½æ•°æ²¡æœ‰return,è¿è¡Œç›´æ¥æŠ¥é”™ï¼Œåˆ©ç”¨å­˜åœ¨é£é™©.é£é™©å æ¯”5%ã€‚
6.  **ç¼“è§£æªæ–½**: ç«‹å³å°† CyberPanel æ›´æ–°åˆ° >= 2.3.8 ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•ç«‹å³æ›´æ–°ï¼Œè¯·é€šè¿‡é˜²ç«å¢™æˆ–ç½‘ç»œ ACL é™åˆ¶å¯¹é¢æ¿çš„è®¿é—®ï¼Œå¹¶åº”ç”¨ WAF/IPS è§„åˆ™æ¥é˜»æ­¢å¯ç–‘è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

