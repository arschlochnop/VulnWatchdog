# CVE-2024-51378

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-命令注入

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 命令注入

**影响应用:** CyberPanel

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** 2.3.6及(未修补)2.3.7

**利用条件:** 需要网络访问CyberPanel实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于CyberPanel的dns/views.py和ftp/views.py中的getresetstatus功能。由于secMiddleware仅针对POST请求，远程攻击者可以通过GET请求绕过身份验证，并在statusfile属性中使用shell元字符，通过访问/dns/getresetstatus或/ftp/getresetstatus来执行任意命令。 

**漏洞利用分析：**

1.  **漏洞原理：** 通过构造包含shell元字符的`statusfile`参数，实现命令注入。
2.  **利用方式：**
    *   **被动模式（扫描）：** 通过GET请求访问`/ftp/getresetstatus`，检查返回内容是否包含`JSONDecodeError at /ftp/getresetstatus`，以此判断是否存在漏洞。
    *   **主动模式（利用）：**
        1.  发送GET请求获取`csrftoken`。
        2.  发送OPTIONS请求到`/ftp/getresetstatus`或`/dns/getresetstatus`，在请求头中包含获取的`csrftoken`，并在payload的`statusfile`参数中注入命令。例如，`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`。

3.  **有效性：** 提供的POC代码（`51378_use.py`和Nuclei模板）有效。`51378_use.py`脚本可以交互式地执行命令。Nuclei模板提供了被动和主动两种扫描方式。

4.  **投毒风险：**
   仓库的大部分代码看起来是用于漏洞检测和利用的，只有少量用户交互部分，例如命令行输入。因此，投毒风险较低，大约在5%。 但不能完全排除作者在扫描或利用脚本中加入恶意代码的可能性,例如反弹shell或下载执行恶意程序等行为。需要人工审核所有脚本代码，特别是与网络请求和系统命令执行相关的部分。

**总结：** CVE-2024-51378是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意命令。 漏洞利用POC已公开，CISA KEV也已经收录，利用方式简单，威胁巨大。需要尽快升级到安全版本。

**项目地址:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**来源**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-命令注入

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 命令注入

**影响应用:** CyberPanel

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** 2.3.6及(未修补)2.3.7

**利用条件:** 需要网络访问CyberPanel实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于CyberPanel的dns/views.py和ftp/views.py中的getresetstatus功能。由于secMiddleware仅针对POST请求，远程攻击者可以通过GET请求绕过身份验证，并在statusfile属性中使用shell元字符，通过访问/dns/getresetstatus或/ftp/getresetstatus来执行任意命令。 

**漏洞利用分析：**

1.  **漏洞原理：** 通过构造包含shell元字符的`statusfile`参数，实现命令注入。
2.  **利用方式：**
    *   **被动模式（扫描）：** 通过GET请求访问`/ftp/getresetstatus`，检查返回内容是否包含`JSONDecodeError at /ftp/getresetstatus`，以此判断是否存在漏洞。
    *   **主动模式（利用）：**
        1.  发送GET请求获取`csrftoken`。
        2.  发送OPTIONS请求到`/ftp/getresetstatus`或`/dns/getresetstatus`，在请求头中包含获取的`csrftoken`，并在payload的`statusfile`参数中注入命令。例如，`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`。

3.  **有效性：** 提供的POC代码（`51378_use.py`和Nuclei模板）有效。`51378_use.py`脚本可以交互式地执行命令。Nuclei模板提供了被动和主动两种扫描方式。

4.  **投毒风险：**
   仓库的大部分代码看起来是用于漏洞检测和利用的，只有少量用户交互部分，例如命令行输入。因此，投毒风险较低，大约在5%。 但不能完全排除作者在扫描或利用脚本中加入恶意代码的可能性,例如反弹shell或下载执行恶意程序等行为。需要人工审核所有脚本代码，特别是与网络请求和系统命令执行相关的部分。

**总结：** CVE-2024-51378是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意命令。 漏洞利用POC已公开，CISA KEV也已经收录，利用方式简单，威胁巨大。需要尽快升级到安全版本。

**项目地址:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**来源**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-命令注入

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 命令注入

**影响应用:** CyberPanel

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** 2.3.6及(未修补)2.3.7

**利用条件:** 需要网络访问CyberPanel实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于CyberPanel的dns/views.py和ftp/views.py中的getresetstatus功能。由于secMiddleware仅针对POST请求，远程攻击者可以通过GET请求绕过身份验证，并在statusfile属性中使用shell元字符，通过访问/dns/getresetstatus或/ftp/getresetstatus来执行任意命令。 

**漏洞利用分析：**

1.  **漏洞原理：** 通过构造包含shell元字符的`statusfile`参数，实现命令注入。
2.  **利用方式：**
    *   **被动模式（扫描）：** 通过GET请求访问`/ftp/getresetstatus`，检查返回内容是否包含`JSONDecodeError at /ftp/getresetstatus`，以此判断是否存在漏洞。
    *   **主动模式（利用）：**
        1.  发送GET请求获取`csrftoken`。
        2.  发送OPTIONS请求到`/ftp/getresetstatus`或`/dns/getresetstatus`，在请求头中包含获取的`csrftoken`，并在payload的`statusfile`参数中注入命令。例如，`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`。

3.  **有效性：** 提供的POC代码（`51378_use.py`和Nuclei模板）有效。`51378_use.py`脚本可以交互式地执行命令。Nuclei模板提供了被动和主动两种扫描方式。

4.  **投毒风险：**
   仓库的大部分代码看起来是用于漏洞检测和利用的，只有少量用户交互部分，例如命令行输入。因此，投毒风险较低，大约在5%。 但不能完全排除作者在扫描或利用脚本中加入恶意代码的可能性,例如反弹shell或下载执行恶意程序等行为。需要人工审核所有脚本代码，特别是与网络请求和系统命令执行相关的部分。

**总结：** CVE-2024-51378是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意命令。 漏洞利用POC已公开，CISA KEV也已经收录，利用方式简单，威胁巨大。需要尽快升级到安全版本。

**项目地址:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**来源**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-命令注入

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 命令注入

**影响应用:** CyberPanel

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** 2.3.6及(未修补)2.3.7

**利用条件:** 需要网络访问CyberPanel实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于CyberPanel的dns/views.py和ftp/views.py中的getresetstatus功能。由于secMiddleware仅针对POST请求，远程攻击者可以通过GET请求绕过身份验证，并在statusfile属性中使用shell元字符，通过访问/dns/getresetstatus或/ftp/getresetstatus来执行任意命令。 

**漏洞利用分析：**

1.  **漏洞原理：** 通过构造包含shell元字符的`statusfile`参数，实现命令注入。
2.  **利用方式：**
    *   **被动模式（扫描）：** 通过GET请求访问`/ftp/getresetstatus`，检查返回内容是否包含`JSONDecodeError at /ftp/getresetstatus`，以此判断是否存在漏洞。
    *   **主动模式（利用）：**
        1.  发送GET请求获取`csrftoken`。
        2.  发送OPTIONS请求到`/ftp/getresetstatus`或`/dns/getresetstatus`，在请求头中包含获取的`csrftoken`，并在payload的`statusfile`参数中注入命令。例如，`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`。

3.  **有效性：** 提供的POC代码（`51378_use.py`和Nuclei模板）有效。`51378_use.py`脚本可以交互式地执行命令。Nuclei模板提供了被动和主动两种扫描方式。

4.  **投毒风险：**
   仓库的大部分代码看起来是用于漏洞检测和利用的，只有少量用户交互部分，例如命令行输入。因此，投毒风险较低，大约在5%。 但不能完全排除作者在扫描或利用脚本中加入恶意代码的可能性,例如反弹shell或下载执行恶意程序等行为。需要人工审核所有脚本代码，特别是与网络请求和系统命令执行相关的部分。

**总结：** CVE-2024-51378是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意命令。 漏洞利用POC已公开，CISA KEV也已经收录，利用方式简单，威胁巨大。需要尽快升级到安全版本。

**项目地址:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**来源**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-命令注入

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 命令注入

**影响应用:** CyberPanel

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** 2.3.6及(未修补)2.3.7

**利用条件:** 需要网络访问CyberPanel实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于CyberPanel的dns/views.py和ftp/views.py中的getresetstatus功能。由于secMiddleware仅针对POST请求，远程攻击者可以通过GET请求绕过身份验证，并在statusfile属性中使用shell元字符，通过访问/dns/getresetstatus或/ftp/getresetstatus来执行任意命令。 

**漏洞利用分析：**

1.  **漏洞原理：** 通过构造包含shell元字符的`statusfile`参数，实现命令注入。
2.  **利用方式：**
    *   **被动模式（扫描）：** 通过GET请求访问`/ftp/getresetstatus`，检查返回内容是否包含`JSONDecodeError at /ftp/getresetstatus`，以此判断是否存在漏洞。
    *   **主动模式（利用）：**
        1.  发送GET请求获取`csrftoken`。
        2.  发送OPTIONS请求到`/ftp/getresetstatus`或`/dns/getresetstatus`，在请求头中包含获取的`csrftoken`，并在payload的`statusfile`参数中注入命令。例如，`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`。

3.  **有效性：** 提供的POC代码（`51378_use.py`和Nuclei模板）有效。`51378_use.py`脚本可以交互式地执行命令。Nuclei模板提供了被动和主动两种扫描方式。

4.  **投毒风险：**
   仓库的大部分代码看起来是用于漏洞检测和利用的，只有少量用户交互部分，例如命令行输入。因此，投毒风险较低，大约在5%。 但不能完全排除作者在扫描或利用脚本中加入恶意代码的可能性,例如反弹shell或下载执行恶意程序等行为。需要人工审核所有脚本代码，特别是与网络请求和系统命令执行相关的部分。

**总结：** CVE-2024-51378是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意命令。 漏洞利用POC已公开，CISA KEV也已经收录，利用方式简单，威胁巨大。需要尽快升级到安全版本。

**项目地址:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**来源**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-命令注入

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 命令注入

**影响应用:** CyberPanel

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** 2.3.6及(未修补)2.3.7

**利用条件:** 需要网络访问CyberPanel实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于CyberPanel的dns/views.py和ftp/views.py中的getresetstatus功能。由于secMiddleware仅针对POST请求，远程攻击者可以通过GET请求绕过身份验证，并在statusfile属性中使用shell元字符，通过访问/dns/getresetstatus或/ftp/getresetstatus来执行任意命令。 

**漏洞利用分析：**

1.  **漏洞原理：** 通过构造包含shell元字符的`statusfile`参数，实现命令注入。
2.  **利用方式：**
    *   **被动模式（扫描）：** 通过GET请求访问`/ftp/getresetstatus`，检查返回内容是否包含`JSONDecodeError at /ftp/getresetstatus`，以此判断是否存在漏洞。
    *   **主动模式（利用）：**
        1.  发送GET请求获取`csrftoken`。
        2.  发送OPTIONS请求到`/ftp/getresetstatus`或`/dns/getresetstatus`，在请求头中包含获取的`csrftoken`，并在payload的`statusfile`参数中注入命令。例如，`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`。

3.  **有效性：** 提供的POC代码（`51378_use.py`和Nuclei模板）有效。`51378_use.py`脚本可以交互式地执行命令。Nuclei模板提供了被动和主动两种扫描方式。

4.  **投毒风险：**
   仓库的大部分代码看起来是用于漏洞检测和利用的，只有少量用户交互部分，例如命令行输入。因此，投毒风险较低，大约在5%。 但不能完全排除作者在扫描或利用脚本中加入恶意代码的可能性,例如反弹shell或下载执行恶意程序等行为。需要人工审核所有脚本代码，特别是与网络请求和系统命令执行相关的部分。

**总结：** CVE-2024-51378是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意命令。 漏洞利用POC已公开，CISA KEV也已经收录，利用方式简单，威胁巨大。需要尽快升级到安全版本。

**项目地址:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**来源**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-命令注入

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 命令注入

**影响应用:** CyberPanel

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** 2.3.6及(未修补)2.3.7

**利用条件:** 需要网络访问CyberPanel实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于CyberPanel的dns/views.py和ftp/views.py中的getresetstatus功能。由于secMiddleware仅针对POST请求，远程攻击者可以通过GET请求绕过身份验证，并在statusfile属性中使用shell元字符，通过访问/dns/getresetstatus或/ftp/getresetstatus来执行任意命令。 

**漏洞利用分析：**

1.  **漏洞原理：** 通过构造包含shell元字符的`statusfile`参数，实现命令注入。
2.  **利用方式：**
    *   **被动模式（扫描）：** 通过GET请求访问`/ftp/getresetstatus`，检查返回内容是否包含`JSONDecodeError at /ftp/getresetstatus`，以此判断是否存在漏洞。
    *   **主动模式（利用）：**
        1.  发送GET请求获取`csrftoken`。
        2.  发送OPTIONS请求到`/ftp/getresetstatus`或`/dns/getresetstatus`，在请求头中包含获取的`csrftoken`，并在payload的`statusfile`参数中注入命令。例如，`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`。

3.  **有效性：** 提供的POC代码（`51378_use.py`和Nuclei模板）有效。`51378_use.py`脚本可以交互式地执行命令。Nuclei模板提供了被动和主动两种扫描方式。

4.  **投毒风险：**
   仓库的大部分代码看起来是用于漏洞检测和利用的，只有少量用户交互部分，例如命令行输入。因此，投毒风险较低，大约在5%。 但不能完全排除作者在扫描或利用脚本中加入恶意代码的可能性,例如反弹shell或下载执行恶意程序等行为。需要人工审核所有脚本代码，特别是与网络请求和系统命令执行相关的部分。

**总结：** CVE-2024-51378是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意命令。 漏洞利用POC已公开，CISA KEV也已经收录，利用方式简单，威胁巨大。需要尽快升级到安全版本。

**项目地址:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**来源**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-命令注入

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 命令注入

**影响应用:** CyberPanel

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** 2.3.6及(未修补)2.3.7

**利用条件:** 需要网络访问CyberPanel实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于CyberPanel的dns/views.py和ftp/views.py中的getresetstatus功能。由于secMiddleware仅针对POST请求，远程攻击者可以通过GET请求绕过身份验证，并在statusfile属性中使用shell元字符，通过访问/dns/getresetstatus或/ftp/getresetstatus来执行任意命令。 

**漏洞利用分析：**

1.  **漏洞原理：** 通过构造包含shell元字符的`statusfile`参数，实现命令注入。
2.  **利用方式：**
    *   **被动模式（扫描）：** 通过GET请求访问`/ftp/getresetstatus`，检查返回内容是否包含`JSONDecodeError at /ftp/getresetstatus`，以此判断是否存在漏洞。
    *   **主动模式（利用）：**
        1.  发送GET请求获取`csrftoken`。
        2.  发送OPTIONS请求到`/ftp/getresetstatus`或`/dns/getresetstatus`，在请求头中包含获取的`csrftoken`，并在payload的`statusfile`参数中注入命令。例如，`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`。

3.  **有效性：** 提供的POC代码（`51378_use.py`和Nuclei模板）有效。`51378_use.py`脚本可以交互式地执行命令。Nuclei模板提供了被动和主动两种扫描方式。

4.  **投毒风险：**
   仓库的大部分代码看起来是用于漏洞检测和利用的，只有少量用户交互部分，例如命令行输入。因此，投毒风险较低，大约在5%。 但不能完全排除作者在扫描或利用脚本中加入恶意代码的可能性,例如反弹shell或下载执行恶意程序等行为。需要人工审核所有脚本代码，特别是与网络请求和系统命令执行相关的部分。

**总结：** CVE-2024-51378是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意命令。 漏洞利用POC已公开，CISA KEV也已经收录，利用方式简单，威胁巨大。需要尽快升级到安全版本。

**项目地址:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**来源**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-命令注入

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 命令注入

**影响应用:** CyberPanel

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** 2.3.6及(未修补)2.3.7

**利用条件:** 需要网络访问CyberPanel实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于CyberPanel的dns/views.py和ftp/views.py中的getresetstatus功能。由于secMiddleware仅针对POST请求，远程攻击者可以通过GET请求绕过身份验证，并在statusfile属性中使用shell元字符，通过访问/dns/getresetstatus或/ftp/getresetstatus来执行任意命令。 

**漏洞利用分析：**

1.  **漏洞原理：** 通过构造包含shell元字符的`statusfile`参数，实现命令注入。
2.  **利用方式：**
    *   **被动模式（扫描）：** 通过GET请求访问`/ftp/getresetstatus`，检查返回内容是否包含`JSONDecodeError at /ftp/getresetstatus`，以此判断是否存在漏洞。
    *   **主动模式（利用）：**
        1.  发送GET请求获取`csrftoken`。
        2.  发送OPTIONS请求到`/ftp/getresetstatus`或`/dns/getresetstatus`，在请求头中包含获取的`csrftoken`，并在payload的`statusfile`参数中注入命令。例如，`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`。

3.  **有效性：** 提供的POC代码（`51378_use.py`和Nuclei模板）有效。`51378_use.py`脚本可以交互式地执行命令。Nuclei模板提供了被动和主动两种扫描方式。

4.  **投毒风险：**
   仓库的大部分代码看起来是用于漏洞检测和利用的，只有少量用户交互部分，例如命令行输入。因此，投毒风险较低，大约在5%。 但不能完全排除作者在扫描或利用脚本中加入恶意代码的可能性,例如反弹shell或下载执行恶意程序等行为。需要人工审核所有脚本代码，特别是与网络请求和系统命令执行相关的部分。

**总结：** CVE-2024-51378是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意命令。 漏洞利用POC已公开，CISA KEV也已经收录，利用方式简单，威胁巨大。需要尽快升级到安全版本。

**项目地址:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**来源**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-命令注入

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 命令注入

**影响应用:** CyberPanel

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** 2.3.6及(未修补)2.3.7

**利用条件:** 需要网络访问CyberPanel实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于CyberPanel的dns/views.py和ftp/views.py中的getresetstatus功能。由于secMiddleware仅针对POST请求，远程攻击者可以通过GET请求绕过身份验证，并在statusfile属性中使用shell元字符，通过访问/dns/getresetstatus或/ftp/getresetstatus来执行任意命令。 

**漏洞利用分析：**

1.  **漏洞原理：** 通过构造包含shell元字符的`statusfile`参数，实现命令注入。
2.  **利用方式：**
    *   **被动模式（扫描）：** 通过GET请求访问`/ftp/getresetstatus`，检查返回内容是否包含`JSONDecodeError at /ftp/getresetstatus`，以此判断是否存在漏洞。
    *   **主动模式（利用）：**
        1.  发送GET请求获取`csrftoken`。
        2.  发送OPTIONS请求到`/ftp/getresetstatus`或`/dns/getresetstatus`，在请求头中包含获取的`csrftoken`，并在payload的`statusfile`参数中注入命令。例如，`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`。

3.  **有效性：** 提供的POC代码（`51378_use.py`和Nuclei模板）有效。`51378_use.py`脚本可以交互式地执行命令。Nuclei模板提供了被动和主动两种扫描方式。

4.  **投毒风险：**
   仓库的大部分代码看起来是用于漏洞检测和利用的，只有少量用户交互部分，例如命令行输入。因此，投毒风险较低，大约在5%。 但不能完全排除作者在扫描或利用脚本中加入恶意代码的可能性,例如反弹shell或下载执行恶意程序等行为。需要人工审核所有脚本代码，特别是与网络请求和系统命令执行相关的部分。

**总结：** CVE-2024-51378是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意命令。 漏洞利用POC已公开，CISA KEV也已经收录，利用方式简单，威胁巨大。需要尽快升级到安全版本。

**项目地址:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**来源**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-命令注入

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 命令注入

**影响应用:** CyberPanel

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** 2.3.6及(未修补)2.3.7

**利用条件:** 需要网络访问CyberPanel实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于CyberPanel的dns/views.py和ftp/views.py中的getresetstatus功能。由于secMiddleware仅针对POST请求，远程攻击者可以通过GET请求绕过身份验证，并在statusfile属性中使用shell元字符，通过访问/dns/getresetstatus或/ftp/getresetstatus来执行任意命令。 

**漏洞利用分析：**

1.  **漏洞原理：** 通过构造包含shell元字符的`statusfile`参数，实现命令注入。
2.  **利用方式：**
    *   **被动模式（扫描）：** 通过GET请求访问`/ftp/getresetstatus`，检查返回内容是否包含`JSONDecodeError at /ftp/getresetstatus`，以此判断是否存在漏洞。
    *   **主动模式（利用）：**
        1.  发送GET请求获取`csrftoken`。
        2.  发送OPTIONS请求到`/ftp/getresetstatus`或`/dns/getresetstatus`，在请求头中包含获取的`csrftoken`，并在payload的`statusfile`参数中注入命令。例如，`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`。

3.  **有效性：** 提供的POC代码（`51378_use.py`和Nuclei模板）有效。`51378_use.py`脚本可以交互式地执行命令。Nuclei模板提供了被动和主动两种扫描方式。

4.  **投毒风险：**
   仓库的大部分代码看起来是用于漏洞检测和利用的，只有少量用户交互部分，例如命令行输入。因此，投毒风险较低，大约在5%。 但不能完全排除作者在扫描或利用脚本中加入恶意代码的可能性,例如反弹shell或下载执行恶意程序等行为。需要人工审核所有脚本代码，特别是与网络请求和系统命令执行相关的部分。

**总结：** CVE-2024-51378是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意命令。 漏洞利用POC已公开，CISA KEV也已经收录，利用方式简单，威胁巨大。需要尽快升级到安全版本。

**项目地址:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**来源**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-命令注入

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 命令注入

**影响应用:** CyberPanel

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** 2.3.6及(未修补)2.3.7

**利用条件:** 需要网络访问CyberPanel实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于CyberPanel的dns/views.py和ftp/views.py中的getresetstatus功能。由于secMiddleware仅针对POST请求，远程攻击者可以通过GET请求绕过身份验证，并在statusfile属性中使用shell元字符，通过访问/dns/getresetstatus或/ftp/getresetstatus来执行任意命令。 

**漏洞利用分析：**

1.  **漏洞原理：** 通过构造包含shell元字符的`statusfile`参数，实现命令注入。
2.  **利用方式：**
    *   **被动模式（扫描）：** 通过GET请求访问`/ftp/getresetstatus`，检查返回内容是否包含`JSONDecodeError at /ftp/getresetstatus`，以此判断是否存在漏洞。
    *   **主动模式（利用）：**
        1.  发送GET请求获取`csrftoken`。
        2.  发送OPTIONS请求到`/ftp/getresetstatus`或`/dns/getresetstatus`，在请求头中包含获取的`csrftoken`，并在payload的`statusfile`参数中注入命令。例如，`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`。

3.  **有效性：** 提供的POC代码（`51378_use.py`和Nuclei模板）有效。`51378_use.py`脚本可以交互式地执行命令。Nuclei模板提供了被动和主动两种扫描方式。

4.  **投毒风险：**
   仓库的大部分代码看起来是用于漏洞检测和利用的，只有少量用户交互部分，例如命令行输入。因此，投毒风险较低，大约在5%。 但不能完全排除作者在扫描或利用脚本中加入恶意代码的可能性,例如反弹shell或下载执行恶意程序等行为。需要人工审核所有脚本代码，特别是与网络请求和系统命令执行相关的部分。

**总结：** CVE-2024-51378是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意命令。 漏洞利用POC已公开，CISA KEV也已经收录，利用方式简单，威胁巨大。需要尽快升级到安全版本。

**项目地址:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**来源**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-命令注入

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 命令注入

**影响应用:** CyberPanel

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** 2.3.6及(未修补)2.3.7

**利用条件:** 需要网络访问CyberPanel实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于CyberPanel的dns/views.py和ftp/views.py中的getresetstatus功能。由于secMiddleware仅针对POST请求，远程攻击者可以通过GET请求绕过身份验证，并在statusfile属性中使用shell元字符，通过访问/dns/getresetstatus或/ftp/getresetstatus来执行任意命令。 

**漏洞利用分析：**

1.  **漏洞原理：** 通过构造包含shell元字符的`statusfile`参数，实现命令注入。
2.  **利用方式：**
    *   **被动模式（扫描）：** 通过GET请求访问`/ftp/getresetstatus`，检查返回内容是否包含`JSONDecodeError at /ftp/getresetstatus`，以此判断是否存在漏洞。
    *   **主动模式（利用）：**
        1.  发送GET请求获取`csrftoken`。
        2.  发送OPTIONS请求到`/ftp/getresetstatus`或`/dns/getresetstatus`，在请求头中包含获取的`csrftoken`，并在payload的`statusfile`参数中注入命令。例如，`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`。

3.  **有效性：** 提供的POC代码（`51378_use.py`和Nuclei模板）有效。`51378_use.py`脚本可以交互式地执行命令。Nuclei模板提供了被动和主动两种扫描方式。

4.  **投毒风险：**
   仓库的大部分代码看起来是用于漏洞检测和利用的，只有少量用户交互部分，例如命令行输入。因此，投毒风险较低，大约在5%。 但不能完全排除作者在扫描或利用脚本中加入恶意代码的可能性,例如反弹shell或下载执行恶意程序等行为。需要人工审核所有脚本代码，特别是与网络请求和系统命令执行相关的部分。

**总结：** CVE-2024-51378是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意命令。 漏洞利用POC已公开，CISA KEV也已经收录，利用方式简单，威胁巨大。需要尽快升级到安全版本。

**项目地址:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**来源**: [CVE-2024-51378-refr4g_CVE-2024-51378.md](../2024/CVE-2024-51378-refr4g_CVE-2024-51378.md)

# CVE-2024-51378

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-51378-qnole000_CVE-2024-51378.md](../2024/CVE-2024-51378-qnole000_CVE-2024-51378.md)

## CVE-2024-51378-CyberPanel-命令注入

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 命令注入

**影响应用:** CyberPanel

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** 2.3.6及(未修补)2.3.7

**利用条件:** 需要网络访问CyberPanel实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于CyberPanel的dns/views.py和ftp/views.py中的getresetstatus功能。由于secMiddleware仅针对POST请求，远程攻击者可以通过GET请求绕过身份验证，并在statusfile属性中使用shell元字符，通过访问/dns/getresetstatus或/ftp/getresetstatus来执行任意命令。 

**漏洞利用分析：**

1.  **漏洞原理：** 通过构造包含shell元字符的`statusfile`参数，实现命令注入。
2.  **利用方式：**
    *   **被动模式（扫描）：** 通过GET请求访问`/ftp/getresetstatus`，检查返回内容是否包含`JSONDecodeError at /ftp/getresetstatus`，以此判断是否存在漏洞。
    *   **主动模式（利用）：**
        1.  发送GET请求获取`csrftoken`。
        2.  发送OPTIONS请求到`/ftp/getresetstatus`或`/dns/getresetstatus`，在请求头中包含获取的`csrftoken`，并在payload的`statusfile`参数中注入命令。例如，`{"statusfile": "/dev/null; id; #","csrftoken":"{{csrf_token}}"}`。

3.  **有效性：** 提供的POC代码（`51378_use.py`和Nuclei模板）有效。`51378_use.py`脚本可以交互式地执行命令。Nuclei模板提供了被动和主动两种扫描方式。

4.  **投毒风险：**
   仓库的大部分代码看起来是用于漏洞检测和利用的，只有少量用户交互部分，例如命令行输入。因此，投毒风险较低，大约在5%。 但不能完全排除作者在扫描或利用脚本中加入恶意代码的可能性,例如反弹shell或下载执行恶意程序等行为。需要人工审核所有脚本代码，特别是与网络请求和系统命令执行相关的部分。

**总结：** CVE-2024-51378是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意命令。 漏洞利用POC已公开，CISA KEV也已经收录，利用方式简单，威胁巨大。需要尽快升级到安全版本。

**项目地址:** [qnole000/CVE-2024-51378](https://github.com/qnole000/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

## POC #2

**来源**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel 远程代码执行

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CyberPanel

**危害等级:** 高危，可绕过身份验证并执行任意命令

**影响版本:** <= 2.3.6 and 2.3.7 (unpatched)

**利用条件:** 需要网络访问CyberPanel管理端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-51378 存在于 CyberPanel 的 `dns/views.py` 和 `ftp/views.py` 中。未经身份验证的远程攻击者可以通过 `/dns/getresetstatus` 或 `/ftp/getresetstatus` 路径，利用 `statusfile` 属性中的 shell 元字符，绕过 `secMiddleware`（仅适用于 POST 请求）并执行任意命令。PSAUX 在 2024 年 10 月已在野外利用此漏洞。该漏洞的利用方式如下：

1.  **漏洞位置**: `/dns/getresetstatus` 和 `/ftp/getresetstatus`。
2.  **绕过认证**:  漏洞利用的关键在于绕过 `secMiddleware`，因为它只针对 POST 请求进行安全检查，而 GET 请求不受保护。
3.  **命令注入**: 通过在 `statusfile` 参数中注入 shell 元字符来执行任意命令。例如，可以使用 `;` 来连接命令。
4.  **PoC 分析**: 提供的 PoC 代码 `run.py` 脚本通过 HTTP 请求发送包含恶意 `statusfile` 参数的 GET 请求，从而触发命令注入。该脚本允许指定目标 IP 地址列表和要执行的命令。如果不指定命令，默认会部署 SSH 公钥到目标服务器，实现持久访问。
5. **投毒风险**: 脚本中包含一个默认ssh key的变量,若未修改,所有使用此脚本的人都会植入相同的公钥,从而导致其他人可以利用此后门进行控制,所以有一定投毒风险.另外脚本编写存在不完整，tokenCSRF函数没有return,运行直接报错，利用存在风险.风险占比5%。
6.  **缓解措施**: 立即将 CyberPanel 更新到 >= 2.3.8 版本。如果无法立即更新，请通过防火墙或网络 ACL 限制对面板的访问，并应用 WAF/IPS 规则来阻止可疑请求。

**项目地址:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**来源**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel 远程代码执行

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CyberPanel

**危害等级:** 高危，可绕过身份验证并执行任意命令

**影响版本:** <= 2.3.6 and 2.3.7 (unpatched)

**利用条件:** 需要网络访问CyberPanel管理端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-51378 存在于 CyberPanel 的 `dns/views.py` 和 `ftp/views.py` 中。未经身份验证的远程攻击者可以通过 `/dns/getresetstatus` 或 `/ftp/getresetstatus` 路径，利用 `statusfile` 属性中的 shell 元字符，绕过 `secMiddleware`（仅适用于 POST 请求）并执行任意命令。PSAUX 在 2024 年 10 月已在野外利用此漏洞。该漏洞的利用方式如下：

1.  **漏洞位置**: `/dns/getresetstatus` 和 `/ftp/getresetstatus`。
2.  **绕过认证**:  漏洞利用的关键在于绕过 `secMiddleware`，因为它只针对 POST 请求进行安全检查，而 GET 请求不受保护。
3.  **命令注入**: 通过在 `statusfile` 参数中注入 shell 元字符来执行任意命令。例如，可以使用 `;` 来连接命令。
4.  **PoC 分析**: 提供的 PoC 代码 `run.py` 脚本通过 HTTP 请求发送包含恶意 `statusfile` 参数的 GET 请求，从而触发命令注入。该脚本允许指定目标 IP 地址列表和要执行的命令。如果不指定命令，默认会部署 SSH 公钥到目标服务器，实现持久访问。
5. **投毒风险**: 脚本中包含一个默认ssh key的变量,若未修改,所有使用此脚本的人都会植入相同的公钥,从而导致其他人可以利用此后门进行控制,所以有一定投毒风险.另外脚本编写存在不完整，tokenCSRF函数没有return,运行直接报错，利用存在风险.风险占比5%。
6.  **缓解措施**: 立即将 CyberPanel 更新到 >= 2.3.8 版本。如果无法立即更新，请通过防火墙或网络 ACL 限制对面板的访问，并应用 WAF/IPS 规则来阻止可疑请求。

**项目地址:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**来源**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel 远程代码执行

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CyberPanel

**危害等级:** 高危，可绕过身份验证并执行任意命令

**影响版本:** <= 2.3.6 and 2.3.7 (unpatched)

**利用条件:** 需要网络访问CyberPanel管理端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-51378 存在于 CyberPanel 的 `dns/views.py` 和 `ftp/views.py` 中。未经身份验证的远程攻击者可以通过 `/dns/getresetstatus` 或 `/ftp/getresetstatus` 路径，利用 `statusfile` 属性中的 shell 元字符，绕过 `secMiddleware`（仅适用于 POST 请求）并执行任意命令。PSAUX 在 2024 年 10 月已在野外利用此漏洞。该漏洞的利用方式如下：

1.  **漏洞位置**: `/dns/getresetstatus` 和 `/ftp/getresetstatus`。
2.  **绕过认证**:  漏洞利用的关键在于绕过 `secMiddleware`，因为它只针对 POST 请求进行安全检查，而 GET 请求不受保护。
3.  **命令注入**: 通过在 `statusfile` 参数中注入 shell 元字符来执行任意命令。例如，可以使用 `;` 来连接命令。
4.  **PoC 分析**: 提供的 PoC 代码 `run.py` 脚本通过 HTTP 请求发送包含恶意 `statusfile` 参数的 GET 请求，从而触发命令注入。该脚本允许指定目标 IP 地址列表和要执行的命令。如果不指定命令，默认会部署 SSH 公钥到目标服务器，实现持久访问。
5. **投毒风险**: 脚本中包含一个默认ssh key的变量,若未修改,所有使用此脚本的人都会植入相同的公钥,从而导致其他人可以利用此后门进行控制,所以有一定投毒风险.另外脚本编写存在不完整，tokenCSRF函数没有return,运行直接报错，利用存在风险.风险占比5%。
6.  **缓解措施**: 立即将 CyberPanel 更新到 >= 2.3.8 版本。如果无法立即更新，请通过防火墙或网络 ACL 限制对面板的访问，并应用 WAF/IPS 规则来阻止可疑请求。

**项目地址:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**来源**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel 远程代码执行

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CyberPanel

**危害等级:** 高危，可绕过身份验证并执行任意命令

**影响版本:** <= 2.3.6 and 2.3.7 (unpatched)

**利用条件:** 需要网络访问CyberPanel管理端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-51378 存在于 CyberPanel 的 `dns/views.py` 和 `ftp/views.py` 中。未经身份验证的远程攻击者可以通过 `/dns/getresetstatus` 或 `/ftp/getresetstatus` 路径，利用 `statusfile` 属性中的 shell 元字符，绕过 `secMiddleware`（仅适用于 POST 请求）并执行任意命令。PSAUX 在 2024 年 10 月已在野外利用此漏洞。该漏洞的利用方式如下：

1.  **漏洞位置**: `/dns/getresetstatus` 和 `/ftp/getresetstatus`。
2.  **绕过认证**:  漏洞利用的关键在于绕过 `secMiddleware`，因为它只针对 POST 请求进行安全检查，而 GET 请求不受保护。
3.  **命令注入**: 通过在 `statusfile` 参数中注入 shell 元字符来执行任意命令。例如，可以使用 `;` 来连接命令。
4.  **PoC 分析**: 提供的 PoC 代码 `run.py` 脚本通过 HTTP 请求发送包含恶意 `statusfile` 参数的 GET 请求，从而触发命令注入。该脚本允许指定目标 IP 地址列表和要执行的命令。如果不指定命令，默认会部署 SSH 公钥到目标服务器，实现持久访问。
5. **投毒风险**: 脚本中包含一个默认ssh key的变量,若未修改,所有使用此脚本的人都会植入相同的公钥,从而导致其他人可以利用此后门进行控制,所以有一定投毒风险.另外脚本编写存在不完整，tokenCSRF函数没有return,运行直接报错，利用存在风险.风险占比5%。
6.  **缓解措施**: 立即将 CyberPanel 更新到 >= 2.3.8 版本。如果无法立即更新，请通过防火墙或网络 ACL 限制对面板的访问，并应用 WAF/IPS 规则来阻止可疑请求。

**项目地址:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**来源**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel 远程代码执行

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CyberPanel

**危害等级:** 高危，可绕过身份验证并执行任意命令

**影响版本:** <= 2.3.6 and 2.3.7 (unpatched)

**利用条件:** 需要网络访问CyberPanel管理端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-51378 存在于 CyberPanel 的 `dns/views.py` 和 `ftp/views.py` 中。未经身份验证的远程攻击者可以通过 `/dns/getresetstatus` 或 `/ftp/getresetstatus` 路径，利用 `statusfile` 属性中的 shell 元字符，绕过 `secMiddleware`（仅适用于 POST 请求）并执行任意命令。PSAUX 在 2024 年 10 月已在野外利用此漏洞。该漏洞的利用方式如下：

1.  **漏洞位置**: `/dns/getresetstatus` 和 `/ftp/getresetstatus`。
2.  **绕过认证**:  漏洞利用的关键在于绕过 `secMiddleware`，因为它只针对 POST 请求进行安全检查，而 GET 请求不受保护。
3.  **命令注入**: 通过在 `statusfile` 参数中注入 shell 元字符来执行任意命令。例如，可以使用 `;` 来连接命令。
4.  **PoC 分析**: 提供的 PoC 代码 `run.py` 脚本通过 HTTP 请求发送包含恶意 `statusfile` 参数的 GET 请求，从而触发命令注入。该脚本允许指定目标 IP 地址列表和要执行的命令。如果不指定命令，默认会部署 SSH 公钥到目标服务器，实现持久访问。
5. **投毒风险**: 脚本中包含一个默认ssh key的变量,若未修改,所有使用此脚本的人都会植入相同的公钥,从而导致其他人可以利用此后门进行控制,所以有一定投毒风险.另外脚本编写存在不完整，tokenCSRF函数没有return,运行直接报错，利用存在风险.风险占比5%。
6.  **缓解措施**: 立即将 CyberPanel 更新到 >= 2.3.8 版本。如果无法立即更新，请通过防火墙或网络 ACL 限制对面板的访问，并应用 WAF/IPS 规则来阻止可疑请求。

**项目地址:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**来源**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel 远程代码执行

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CyberPanel

**危害等级:** 高危，可绕过身份验证并执行任意命令

**影响版本:** <= 2.3.6 and 2.3.7 (unpatched)

**利用条件:** 需要网络访问CyberPanel管理端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-51378 存在于 CyberPanel 的 `dns/views.py` 和 `ftp/views.py` 中。未经身份验证的远程攻击者可以通过 `/dns/getresetstatus` 或 `/ftp/getresetstatus` 路径，利用 `statusfile` 属性中的 shell 元字符，绕过 `secMiddleware`（仅适用于 POST 请求）并执行任意命令。PSAUX 在 2024 年 10 月已在野外利用此漏洞。该漏洞的利用方式如下：

1.  **漏洞位置**: `/dns/getresetstatus` 和 `/ftp/getresetstatus`。
2.  **绕过认证**:  漏洞利用的关键在于绕过 `secMiddleware`，因为它只针对 POST 请求进行安全检查，而 GET 请求不受保护。
3.  **命令注入**: 通过在 `statusfile` 参数中注入 shell 元字符来执行任意命令。例如，可以使用 `;` 来连接命令。
4.  **PoC 分析**: 提供的 PoC 代码 `run.py` 脚本通过 HTTP 请求发送包含恶意 `statusfile` 参数的 GET 请求，从而触发命令注入。该脚本允许指定目标 IP 地址列表和要执行的命令。如果不指定命令，默认会部署 SSH 公钥到目标服务器，实现持久访问。
5. **投毒风险**: 脚本中包含一个默认ssh key的变量,若未修改,所有使用此脚本的人都会植入相同的公钥,从而导致其他人可以利用此后门进行控制,所以有一定投毒风险.另外脚本编写存在不完整，tokenCSRF函数没有return,运行直接报错，利用存在风险.风险占比5%。
6.  **缓解措施**: 立即将 CyberPanel 更新到 >= 2.3.8 版本。如果无法立即更新，请通过防火墙或网络 ACL 限制对面板的访问，并应用 WAF/IPS 规则来阻止可疑请求。

**项目地址:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**来源**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel 远程代码执行

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CyberPanel

**危害等级:** 高危，可绕过身份验证并执行任意命令

**影响版本:** <= 2.3.6 and 2.3.7 (unpatched)

**利用条件:** 需要网络访问CyberPanel管理端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-51378 存在于 CyberPanel 的 `dns/views.py` 和 `ftp/views.py` 中。未经身份验证的远程攻击者可以通过 `/dns/getresetstatus` 或 `/ftp/getresetstatus` 路径，利用 `statusfile` 属性中的 shell 元字符，绕过 `secMiddleware`（仅适用于 POST 请求）并执行任意命令。PSAUX 在 2024 年 10 月已在野外利用此漏洞。该漏洞的利用方式如下：

1.  **漏洞位置**: `/dns/getresetstatus` 和 `/ftp/getresetstatus`。
2.  **绕过认证**:  漏洞利用的关键在于绕过 `secMiddleware`，因为它只针对 POST 请求进行安全检查，而 GET 请求不受保护。
3.  **命令注入**: 通过在 `statusfile` 参数中注入 shell 元字符来执行任意命令。例如，可以使用 `;` 来连接命令。
4.  **PoC 分析**: 提供的 PoC 代码 `run.py` 脚本通过 HTTP 请求发送包含恶意 `statusfile` 参数的 GET 请求，从而触发命令注入。该脚本允许指定目标 IP 地址列表和要执行的命令。如果不指定命令，默认会部署 SSH 公钥到目标服务器，实现持久访问。
5. **投毒风险**: 脚本中包含一个默认ssh key的变量,若未修改,所有使用此脚本的人都会植入相同的公钥,从而导致其他人可以利用此后门进行控制,所以有一定投毒风险.另外脚本编写存在不完整，tokenCSRF函数没有return,运行直接报错，利用存在风险.风险占比5%。
6.  **缓解措施**: 立即将 CyberPanel 更新到 >= 2.3.8 版本。如果无法立即更新，请通过防火墙或网络 ACL 限制对面板的访问，并应用 WAF/IPS 规则来阻止可疑请求。

**项目地址:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**来源**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel 远程代码执行

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CyberPanel

**危害等级:** 高危，可绕过身份验证并执行任意命令

**影响版本:** <= 2.3.6 and 2.3.7 (unpatched)

**利用条件:** 需要网络访问CyberPanel管理端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-51378 存在于 CyberPanel 的 `dns/views.py` 和 `ftp/views.py` 中。未经身份验证的远程攻击者可以通过 `/dns/getresetstatus` 或 `/ftp/getresetstatus` 路径，利用 `statusfile` 属性中的 shell 元字符，绕过 `secMiddleware`（仅适用于 POST 请求）并执行任意命令。PSAUX 在 2024 年 10 月已在野外利用此漏洞。该漏洞的利用方式如下：

1.  **漏洞位置**: `/dns/getresetstatus` 和 `/ftp/getresetstatus`。
2.  **绕过认证**:  漏洞利用的关键在于绕过 `secMiddleware`，因为它只针对 POST 请求进行安全检查，而 GET 请求不受保护。
3.  **命令注入**: 通过在 `statusfile` 参数中注入 shell 元字符来执行任意命令。例如，可以使用 `;` 来连接命令。
4.  **PoC 分析**: 提供的 PoC 代码 `run.py` 脚本通过 HTTP 请求发送包含恶意 `statusfile` 参数的 GET 请求，从而触发命令注入。该脚本允许指定目标 IP 地址列表和要执行的命令。如果不指定命令，默认会部署 SSH 公钥到目标服务器，实现持久访问。
5. **投毒风险**: 脚本中包含一个默认ssh key的变量,若未修改,所有使用此脚本的人都会植入相同的公钥,从而导致其他人可以利用此后门进行控制,所以有一定投毒风险.另外脚本编写存在不完整，tokenCSRF函数没有return,运行直接报错，利用存在风险.风险占比5%。
6.  **缓解措施**: 立即将 CyberPanel 更新到 >= 2.3.8 版本。如果无法立即更新，请通过防火墙或网络 ACL 限制对面板的访问，并应用 WAF/IPS 规则来阻止可疑请求。

**项目地址:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**来源**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel 远程代码执行

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CyberPanel

**危害等级:** 高危，可绕过身份验证并执行任意命令

**影响版本:** <= 2.3.6 and 2.3.7 (unpatched)

**利用条件:** 需要网络访问CyberPanel管理端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-51378 存在于 CyberPanel 的 `dns/views.py` 和 `ftp/views.py` 中。未经身份验证的远程攻击者可以通过 `/dns/getresetstatus` 或 `/ftp/getresetstatus` 路径，利用 `statusfile` 属性中的 shell 元字符，绕过 `secMiddleware`（仅适用于 POST 请求）并执行任意命令。PSAUX 在 2024 年 10 月已在野外利用此漏洞。该漏洞的利用方式如下：

1.  **漏洞位置**: `/dns/getresetstatus` 和 `/ftp/getresetstatus`。
2.  **绕过认证**:  漏洞利用的关键在于绕过 `secMiddleware`，因为它只针对 POST 请求进行安全检查，而 GET 请求不受保护。
3.  **命令注入**: 通过在 `statusfile` 参数中注入 shell 元字符来执行任意命令。例如，可以使用 `;` 来连接命令。
4.  **PoC 分析**: 提供的 PoC 代码 `run.py` 脚本通过 HTTP 请求发送包含恶意 `statusfile` 参数的 GET 请求，从而触发命令注入。该脚本允许指定目标 IP 地址列表和要执行的命令。如果不指定命令，默认会部署 SSH 公钥到目标服务器，实现持久访问。
5. **投毒风险**: 脚本中包含一个默认ssh key的变量,若未修改,所有使用此脚本的人都会植入相同的公钥,从而导致其他人可以利用此后门进行控制,所以有一定投毒风险.另外脚本编写存在不完整，tokenCSRF函数没有return,运行直接报错，利用存在风险.风险占比5%。
6.  **缓解措施**: 立即将 CyberPanel 更新到 >= 2.3.8 版本。如果无法立即更新，请通过防火墙或网络 ACL 限制对面板的访问，并应用 WAF/IPS 规则来阻止可疑请求。

**项目地址:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**来源**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel 远程代码执行

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CyberPanel

**危害等级:** 高危，可绕过身份验证并执行任意命令

**影响版本:** <= 2.3.6 and 2.3.7 (unpatched)

**利用条件:** 需要网络访问CyberPanel管理端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-51378 存在于 CyberPanel 的 `dns/views.py` 和 `ftp/views.py` 中。未经身份验证的远程攻击者可以通过 `/dns/getresetstatus` 或 `/ftp/getresetstatus` 路径，利用 `statusfile` 属性中的 shell 元字符，绕过 `secMiddleware`（仅适用于 POST 请求）并执行任意命令。PSAUX 在 2024 年 10 月已在野外利用此漏洞。该漏洞的利用方式如下：

1.  **漏洞位置**: `/dns/getresetstatus` 和 `/ftp/getresetstatus`。
2.  **绕过认证**:  漏洞利用的关键在于绕过 `secMiddleware`，因为它只针对 POST 请求进行安全检查，而 GET 请求不受保护。
3.  **命令注入**: 通过在 `statusfile` 参数中注入 shell 元字符来执行任意命令。例如，可以使用 `;` 来连接命令。
4.  **PoC 分析**: 提供的 PoC 代码 `run.py` 脚本通过 HTTP 请求发送包含恶意 `statusfile` 参数的 GET 请求，从而触发命令注入。该脚本允许指定目标 IP 地址列表和要执行的命令。如果不指定命令，默认会部署 SSH 公钥到目标服务器，实现持久访问。
5. **投毒风险**: 脚本中包含一个默认ssh key的变量,若未修改,所有使用此脚本的人都会植入相同的公钥,从而导致其他人可以利用此后门进行控制,所以有一定投毒风险.另外脚本编写存在不完整，tokenCSRF函数没有return,运行直接报错，利用存在风险.风险占比5%。
6.  **缓解措施**: 立即将 CyberPanel 更新到 >= 2.3.8 版本。如果无法立即更新，请通过防火墙或网络 ACL 限制对面板的访问，并应用 WAF/IPS 规则来阻止可疑请求。

**项目地址:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**来源**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel 远程代码执行

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CyberPanel

**危害等级:** 高危，可绕过身份验证并执行任意命令

**影响版本:** <= 2.3.6 and 2.3.7 (unpatched)

**利用条件:** 需要网络访问CyberPanel管理端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-51378 存在于 CyberPanel 的 `dns/views.py` 和 `ftp/views.py` 中。未经身份验证的远程攻击者可以通过 `/dns/getresetstatus` 或 `/ftp/getresetstatus` 路径，利用 `statusfile` 属性中的 shell 元字符，绕过 `secMiddleware`（仅适用于 POST 请求）并执行任意命令。PSAUX 在 2024 年 10 月已在野外利用此漏洞。该漏洞的利用方式如下：

1.  **漏洞位置**: `/dns/getresetstatus` 和 `/ftp/getresetstatus`。
2.  **绕过认证**:  漏洞利用的关键在于绕过 `secMiddleware`，因为它只针对 POST 请求进行安全检查，而 GET 请求不受保护。
3.  **命令注入**: 通过在 `statusfile` 参数中注入 shell 元字符来执行任意命令。例如，可以使用 `;` 来连接命令。
4.  **PoC 分析**: 提供的 PoC 代码 `run.py` 脚本通过 HTTP 请求发送包含恶意 `statusfile` 参数的 GET 请求，从而触发命令注入。该脚本允许指定目标 IP 地址列表和要执行的命令。如果不指定命令，默认会部署 SSH 公钥到目标服务器，实现持久访问。
5. **投毒风险**: 脚本中包含一个默认ssh key的变量,若未修改,所有使用此脚本的人都会植入相同的公钥,从而导致其他人可以利用此后门进行控制,所以有一定投毒风险.另外脚本编写存在不完整，tokenCSRF函数没有return,运行直接报错，利用存在风险.风险占比5%。
6.  **缓解措施**: 立即将 CyberPanel 更新到 >= 2.3.8 版本。如果无法立即更新，请通过防火墙或网络 ACL 限制对面板的访问，并应用 WAF/IPS 规则来阻止可疑请求。

**项目地址:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**来源**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel 远程代码执行

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CyberPanel

**危害等级:** 高危，可绕过身份验证并执行任意命令

**影响版本:** <= 2.3.6 and 2.3.7 (unpatched)

**利用条件:** 需要网络访问CyberPanel管理端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-51378 存在于 CyberPanel 的 `dns/views.py` 和 `ftp/views.py` 中。未经身份验证的远程攻击者可以通过 `/dns/getresetstatus` 或 `/ftp/getresetstatus` 路径，利用 `statusfile` 属性中的 shell 元字符，绕过 `secMiddleware`（仅适用于 POST 请求）并执行任意命令。PSAUX 在 2024 年 10 月已在野外利用此漏洞。该漏洞的利用方式如下：

1.  **漏洞位置**: `/dns/getresetstatus` 和 `/ftp/getresetstatus`。
2.  **绕过认证**:  漏洞利用的关键在于绕过 `secMiddleware`，因为它只针对 POST 请求进行安全检查，而 GET 请求不受保护。
3.  **命令注入**: 通过在 `statusfile` 参数中注入 shell 元字符来执行任意命令。例如，可以使用 `;` 来连接命令。
4.  **PoC 分析**: 提供的 PoC 代码 `run.py` 脚本通过 HTTP 请求发送包含恶意 `statusfile` 参数的 GET 请求，从而触发命令注入。该脚本允许指定目标 IP 地址列表和要执行的命令。如果不指定命令，默认会部署 SSH 公钥到目标服务器，实现持久访问。
5. **投毒风险**: 脚本中包含一个默认ssh key的变量,若未修改,所有使用此脚本的人都会植入相同的公钥,从而导致其他人可以利用此后门进行控制,所以有一定投毒风险.另外脚本编写存在不完整，tokenCSRF函数没有return,运行直接报错，利用存在风险.风险占比5%。
6.  **缓解措施**: 立即将 CyberPanel 更新到 >= 2.3.8 版本。如果无法立即更新，请通过防火墙或网络 ACL 限制对面板的访问，并应用 WAF/IPS 规则来阻止可疑请求。

**项目地址:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**来源**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel 远程代码执行

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CyberPanel

**危害等级:** 高危，可绕过身份验证并执行任意命令

**影响版本:** <= 2.3.6 and 2.3.7 (unpatched)

**利用条件:** 需要网络访问CyberPanel管理端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-51378 存在于 CyberPanel 的 `dns/views.py` 和 `ftp/views.py` 中。未经身份验证的远程攻击者可以通过 `/dns/getresetstatus` 或 `/ftp/getresetstatus` 路径，利用 `statusfile` 属性中的 shell 元字符，绕过 `secMiddleware`（仅适用于 POST 请求）并执行任意命令。PSAUX 在 2024 年 10 月已在野外利用此漏洞。该漏洞的利用方式如下：

1.  **漏洞位置**: `/dns/getresetstatus` 和 `/ftp/getresetstatus`。
2.  **绕过认证**:  漏洞利用的关键在于绕过 `secMiddleware`，因为它只针对 POST 请求进行安全检查，而 GET 请求不受保护。
3.  **命令注入**: 通过在 `statusfile` 参数中注入 shell 元字符来执行任意命令。例如，可以使用 `;` 来连接命令。
4.  **PoC 分析**: 提供的 PoC 代码 `run.py` 脚本通过 HTTP 请求发送包含恶意 `statusfile` 参数的 GET 请求，从而触发命令注入。该脚本允许指定目标 IP 地址列表和要执行的命令。如果不指定命令，默认会部署 SSH 公钥到目标服务器，实现持久访问。
5. **投毒风险**: 脚本中包含一个默认ssh key的变量,若未修改,所有使用此脚本的人都会植入相同的公钥,从而导致其他人可以利用此后门进行控制,所以有一定投毒风险.另外脚本编写存在不完整，tokenCSRF函数没有return,运行直接报错，利用存在风险.风险占比5%。
6.  **缓解措施**: 立即将 CyberPanel 更新到 >= 2.3.8 版本。如果无法立即更新，请通过防火墙或网络 ACL 限制对面板的访问，并应用 WAF/IPS 规则来阻止可疑请求。

**项目地址:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---



---

## POC #3

**来源**: [CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md](../2024/CVE-2024-51378-rimbadirgantara_CVE-2024-51378.md)

## CVE-2024-51378 - CyberPanel 远程代码执行

**漏洞编号:** CVE-2024-51378

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CyberPanel

**危害等级:** 高危，可绕过身份验证并执行任意命令

**影响版本:** <= 2.3.6 and 2.3.7 (unpatched)

**利用条件:** 需要网络访问CyberPanel管理端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-51378 存在于 CyberPanel 的 `dns/views.py` 和 `ftp/views.py` 中。未经身份验证的远程攻击者可以通过 `/dns/getresetstatus` 或 `/ftp/getresetstatus` 路径，利用 `statusfile` 属性中的 shell 元字符，绕过 `secMiddleware`（仅适用于 POST 请求）并执行任意命令。PSAUX 在 2024 年 10 月已在野外利用此漏洞。该漏洞的利用方式如下：

1.  **漏洞位置**: `/dns/getresetstatus` 和 `/ftp/getresetstatus`。
2.  **绕过认证**:  漏洞利用的关键在于绕过 `secMiddleware`，因为它只针对 POST 请求进行安全检查，而 GET 请求不受保护。
3.  **命令注入**: 通过在 `statusfile` 参数中注入 shell 元字符来执行任意命令。例如，可以使用 `;` 来连接命令。
4.  **PoC 分析**: 提供的 PoC 代码 `run.py` 脚本通过 HTTP 请求发送包含恶意 `statusfile` 参数的 GET 请求，从而触发命令注入。该脚本允许指定目标 IP 地址列表和要执行的命令。如果不指定命令，默认会部署 SSH 公钥到目标服务器，实现持久访问。
5. **投毒风险**: 脚本中包含一个默认ssh key的变量,若未修改,所有使用此脚本的人都会植入相同的公钥,从而导致其他人可以利用此后门进行控制,所以有一定投毒风险.另外脚本编写存在不完整，tokenCSRF函数没有return,运行直接报错，利用存在风险.风险占比5%。
6.  **缓解措施**: 立即将 CyberPanel 更新到 >= 2.3.8 版本。如果无法立即更新，请通过防火墙或网络 ACL 限制对面板的访问，并应用 WAF/IPS 规则来阻止可疑请求。

**项目地址:** [rimbadirgantara/CVE-2024-51378](https://github.com/rimbadirgantara/CVE-2024-51378)

**漏洞详情:** [CVE-2024-51378](https://nvd.nist.gov/vuln/detail/CVE-2024-51378)

---

