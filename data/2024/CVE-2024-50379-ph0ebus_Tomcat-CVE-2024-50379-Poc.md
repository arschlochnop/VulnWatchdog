# CVE-2024-50379

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-50379-Alchemist3dot14_CVE-2024-50379.md](../2024/CVE-2024-50379-Alchemist3dot14_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1
10.1.0-M1 <= version <= 10.1.33
9.0.0.M1 <= version <= 9.0.97

**利用条件:** 1. 存在大小写不敏感的文件系统。
2. 默认Servlet开启写入功能(非默认配置)。
3. 目标服务器存在/uploads目录且可写。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中 JSP 编译期间的 Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认 servlet 启用写入（非默认配置）且文件系统不区分大小写时，攻击者可以利用此漏洞实现远程代码执行。该 PoC 代码通过上传包含恶意代码的 JSP shell 到可写目录（如/uploads）并利用该 shell 执行任意系统命令来演示漏洞利用过程。需要注意的是,PoC代码中定义了BASE_URL、UPLOAD_ENDPOINT、SHELL_NAME和SHELL_CONTENT等变量，如果攻击者修改了SHELL_CONTENT内容添加了恶意程序，可能会对目标系统造成其他安全威胁。尽管 PoC 本身是为了演示漏洞，但确实存在被滥用进行恶意攻击的风险。该PoC的投毒风险主要来自修改后的JSP shell, 例如执行反弹shell或下载执行其他恶意程序。代码中虽然没有明显的恶意投毒代码，但是存在一定风险，例如JSP shell执行命令时的注入，或对服务器的其他操作等，所以投毒风险评为10%。

**项目地址:** [Alchemist3dot14/CVE-2024-50379](https://github.com/Alchemist3dot14/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #2

**来源**: [CVE-2024-50379-JFOZ1010_Nuclei-Template-CVE-2024-50379.md](../2024/CVE-2024-50379-JFOZ1010_Nuclei-Template-CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition 导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false，且文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是一个Apache Tomcat中的TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞。当Tomcat的默认Servlet的`readonly`参数设置为`false`时（非默认配置），攻击者可以通过上传一个JSP文件，并在Tomcat编译该JSP文件时，通过竞争条件替换该文件为恶意JSP文件，从而实现远程代码执行。

**漏洞利用方式：**

1.  **条件满足：**  确保目标Tomcat实例的默认Servlet的`readonly`参数已设置为`false`。这意味着允许通过默认Servlet上传文件。
2.  **上传JSP文件：**  首先上传一个良性的JSP文件，例如`hello.jsp`，其中包含一些基本代码，比如打印"Hello, World!"。
3.  **竞争条件：**  在Tomcat编译`hello.jsp`文件时，攻击者迅速上传一个恶意的JSP文件，比如`HELLO.JSP`（注意大小写差异，利用文件系统大小写不敏感的特性），其中包含执行任意命令的代码（例如，启动计算器）。
4.  **远程代码执行：**  如果竞争成功，Tomcat会编译并执行恶意的`HELLO.JSP`文件，从而导致远程代码执行。

**POC分析：**

提供的Nuclei模板`CVE-2024-50379.yaml` 旨在自动化此漏洞的检测。它通过以下步骤工作：

1.  上传一个包含 "Hello, World!" 的良性JSP文件 (`hello.jsp`) 到 `/upload.jsp` 。
2.  快速上传一个包含恶意代码的JSP文件 (`HELLO.JSP`) 到 `/uploads/upload.jsp` 。这个恶意JSP包含执行计算器的代码片段 `Runtime.getRuntime().exec("calc.exe");`。
3.  尝试访问上传的文件 (`/uploads/hello.jsp`) ，并检查响应是否包含预期的输出或错误信息。

**投毒风险分析：**

虽然提供的POC代码本身旨在利用漏洞，而非植入后门，但仍然存在一些潜在的投毒风险：

*   **文件名大小写混淆:**  利用了大小写不敏感的文件系统, 可能存在编码问题或文件系统差异导致POC失效, 但不属于后门或投毒代码
*   **自定义恶意JSP：**  用户在使用POC时，可能会修改恶意JSP文件中的代码，以执行其他恶意操作，例如上传webshell或执行更隐蔽的命令。这取决于用户自身行为，不属于POC作者投毒。
*   **依赖外部资源：**  虽然当前的POC没有直接依赖外部资源，但如果用户修改POC并添加对外部资源的依赖（例如，下载恶意脚本），则可能引入投毒风险。
*   **README.md中的免责声明：** README明确说明了使用该模板的伦理责任，并强调只能在授权环境下使用。这在一定程度上降低了作者恶意使用的可能性。

综合考虑，尽管存在一些潜在的风险，但该仓库中直接包含作者有意植入的投毒代码的可能性较低。投毒风险主要来自于用户对POC的修改和使用方式。 因此，我给出的投毒风险概率是10%。

**项目地址:** [JFOZ1010/Nuclei-Template-CVE-2024-50379](https://github.com/JFOZ1010/Nuclei-Template-CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #3

**来源**: [CVE-2024-50379-SleepingBag945_CVE-2024-50379.md](../2024/CVE-2024-50379-SleepingBag945_CVE-2024-50379.md)

## CVE-2024-50379 - Apache Tomcat TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 竞争条件导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可远程执行任意代码

**影响版本:** 9.0.0.M1 <= version <= 9.0.97, 10.1.0-M1 <= version <= 10.1.33, 11.0.0-M1 <= version <= 11.0.1

**利用条件:** 1. Apache Tomcat 存在漏洞版本;2. 运行在大小写不敏感的文件系统上; 3. 默认 Servlet 启用了写入功能 (非默认配置)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞，存在于 JSP 编译过程中。当 Tomcat 运行在大小写不敏感的文件系统上，且默认 Servlet 启用写入功能时（这是一个非默认配置），攻击者可以通过竞争条件绕过安全检查，上传恶意 JSP 文件并执行，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  攻击者利用竞争条件，在 Tomcat 检查文件类型之后、编译之前，修改已上传文件的内容。
2.  由于 Tomcat 存在 TOCTOU 漏洞，因此可以绕过安全检查，导致恶意 JSP 代码被执行。
3.  漏洞利用代码（PoC）`main.go`是一个Go程序，它通过并发发送请求来触发竞争条件，上传一个包含恶意代码的JSP文件。它使用`fasthttp`库发送HTTP请求，利用`ants/v2`库管理并发连接池。

**投毒风险分析：**

代码整体结构较为清晰，主要功能是利用漏洞，并未发现明显的恶意代码。可能的投毒风险在于作者使用的第三方库是否安全，或者作者是否在不显眼的地方添加了恶意代码。风险评估：

*   **第三方库风险：** 代码依赖`github.com/valyala/fasthttp`和`github.com/panjf2000/ants/v2`两个库。需要检查这些库是否存在已知的安全问题。作者替换了`fasthttp`库，需要仔细检查替换的`fasthttp`代码是否存在恶意代码。
*   **代码逻辑风险：** 代码逻辑相对简单，主要就是发送请求，没有发现明显的植入后门的地方。

因此，综合来看，投毒的可能性较低，风险值设定为10%。主要风险还是在于对作者修改过的`fasthttp`库的审核，需要人工进行安全审计。

**项目地址:** [SleepingBag945/CVE-2024-50379](https://github.com/SleepingBag945/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #4

**来源**: [CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 需要目标系统为大小写不敏感的文件系统，且default servlet的write权限开启（非默认配置）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞。此漏洞出现在 JSP 编译过程中，允许在大小写不敏感的文件系统上进行远程代码执行（RCE），前提是默认 servlet 启用了写入权限（非默认配置）。

**漏洞利用方式：**

1.  攻击者上传一个包含恶意 JSP 代码的文件，该文件旨在执行任意命令。
2.  由于 TOCTOU 漏洞，Tomcat 在检查文件和实际编译文件之间存在时间差。
3.  攻击者利用这个时间差，通过竞争条件来修改或替换上传的文件内容。
4.  如果攻击成功，Tomcat 将编译并执行恶意 JSP 代码，从而导致远程代码执行。

**POC代码分析：**

提供的POC代码 (`Exploit-poc.py`) 旨在自动化利用此漏洞的过程。它执行以下操作：

1.  **上传Payload:** 使用`PUT`请求将包含恶意代码的JSP文件（`rce.jsp`）上传到目标服务器。
2.  **触发Payload:** 使用`GET`请求访问上传的JSP文件，触发服务器执行JSP中的恶意代码。

该脚本允许指定单个目标URL或包含目标URL列表的文件，并使用多线程来加速漏洞利用过程。

**有效性：**

根据漏洞信息和搜索结果，POC代码是有效的，可以利用该漏洞在满足特定条件的目标系统上执行远程代码。

**投毒风险：**

虽然POC代码本身主要是为了验证和利用漏洞，但仍然存在一定的投毒风险。`JSP_PAYLOAD` 变量允许攻击者自定义执行的命令，如果攻击者上传的Payload包含恶意代码，可能会对目标系统造成损害。例如，Payload可以执行系统命令、修改文件或窃取敏感数据。
此外，脚本中 `if resp.status_code == 200 and "root" in resp.text.lower():` 判断是否存在漏洞利用成功，这里存在一定的概率作者可能存在恶意的判断，导致虽然命令执行成功，但无法正确显示出来，从而导致攻击者判断失误，后续进行恶意操作。

综合评估，该仓库中存在一定程度的投毒风险，风险概率约为10%。主要是考虑到代码作者可以通过构造Payload来影响目标系统，或通过不准确的判断结果来迷惑攻击者。

**项目地址:** [Yuri08loveElaina/CVE-2024-50379-POC](https://github.com/Yuri08loveElaina/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #5

**来源**: [CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379.md](../2024/CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379.md)

## CVE-2024-50379 - Apache Tomcat JSP 编译 TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** 9.0.0.M1 - 9.0.97, 10.1.0-M1 - 10.1.33, 11.0.0-M1 - 11.0.1

**利用条件:** 默认Servlet启用写入（非默认配置），大小写不敏感的文件系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU（Time-of-check Time-of-use）竞争条件漏洞，发生在 JSP 编译期间。如果满足以下条件，则可能导致远程代码执行：

1.  **默认 Servlet 启用写入：** Tomcat 的默认 Servlet 允许写入，这不是默认配置，需要手动开启。
2.  **大小写不敏感的文件系统：** 操作系统使用大小写不敏感的文件系统（例如 Windows）。

**漏洞利用方式：**

攻击者通过上传恶意 JSP 文件（例如 aa.Jsp 和 bb.Jsp）并利用并发请求触发 TOCTOU 漏洞。具体来说，攻击者会并发地发送 PUT 和 GET 请求到 Tomcat 服务器。PUT 请求用于上传包含恶意代码的 JSP 文件，GET 请求用于访问这些 JSP 文件。由于竞争条件，Tomcat 可能会在文件检查后、实际执行文件之前，将文件误判为安全，从而导致恶意代码被执行。

漏洞利用代码 `exploit.py` 模拟了这种攻击方式，它并发地向目标 URL 发送 PUT 和 GET 请求，尝试上传和执行包含反弹 shell 代码的 JSP 文件。代码中使用了多线程来增加竞争成功的概率。

**有效性：**

根据漏洞描述和搜索结果，POC代码在满足特定条件（默认 Servlet 启用写入，大小写不敏感的文件系统）下有效。它利用了并发请求来触发 TOCTOU 漏洞，从而允许远程代码执行。

**投毒风险：**

查看提供的代码，发现该代码的功能是尝试利用 CVE-2024-50379 漏洞进行远程代码执行。代码本身实现了并发上传和访问JSP文件，并通过反弹shell执行恶意代码。**该代码的目的是进行漏洞验证和利用，而不是植入恶意后门**。因此，认为该代码存在投毒风险的可能性极低，判定为0%。

搜索结果也表明该漏洞利用涉及竞争条件，需要并发执行 PUT 和 GET 请求才能成功利用。这与 POC 代码的实现方式相符。

**项目地址:** [Yuri08loveElaina/CVE-2024-50379](https://github.com/Yuri08loveElaina/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #6

**来源**: [CVE-2024-50379-carefreegarb_CVE-2024-50379.md](../2024/CVE-2024-50379-carefreegarb_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可以导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 1. 目标系统为大小写不敏感的文件系统。
2. Tomcat的default servlet的readonly参数设置为false（非默认配置，允许写入）。
3. 存在网络访问Tomcat服务器的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是Apache Tomcat中的一个Time-of-Check Time-of-Use (TOCTOU)竞争条件漏洞。当满足以下条件时，攻击者可以利用此漏洞在服务器上执行任意代码：

*   **环境要求:** 目标系统使用大小写不敏感的文件系统，并且default servlet的`readonly`参数设置为`false`。
*   **漏洞原理:** 在JSP编译期间，Tomcat存在一个竞争条件。攻击者可以在Tomcat检查文件是否存在和可写之后，但在实际编译之前，替换JSP文件。通过精心构造JSP文件，攻击者可以上传恶意代码，并在服务器上执行。
*   **利用方式:**  提供的POC代码是一个Go程序，它利用多线程并发上传恶意JSP文件，从而触发竞争条件。该POC接受目标URL、包含恶意代码的JSP文件路径以及目标服务器上保存的文件名/路径作为参数。
*   **有效性:** 根据搜索结果和POC代码，该漏洞利用是有效的，可以实现远程代码执行。
*   **投毒风险评估:** 提供的代码中存在一定的投毒风险。虽然主要功能是实现漏洞利用，但作者可能在代码中添加一些不明显的后门或者恶意行为。代码中包含`replace github.com/valyala/fasthttp v1.58.0 => ./fasthttp`。使用本地修改过的 `fasthttp` 库存在潜在风险，恶意作者可能在修改后的库中植入后门。因此，对于此类来源不明的代码，需要进行代码审计，才能确保其安全性。综合考虑，存在10%的投毒风险。

**项目地址:** [carefreegarb/CVE-2024-50379](https://github.com/carefreegarb/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #7

**来源**: [CVE-2024-50379-dear-cell_CVE-2024-50379.md](../2024/CVE-2024-50379-dear-cell_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认servlet配置为可写(非默认配置)，文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 servlet 配置为可写（非默认配置）且文件系统大小写不敏感时，攻击者可以通过竞争条件在JSP编译期间执行任意代码，导致远程代码执行（RCE）。

**漏洞利用方式：**

1.  **竞争条件：** 利用JSP编译过程中的TOCTOU漏洞，通过并发请求修改正在编译的文件。
2.  **PUT请求：** POC代码使用PUT方法尝试上传JSP文件到目标URL（/asd.Jsp 和 /qwe.Jsp）。
3.  **GET请求：** POC代码也使用GET请求访问JSP文件。
4.  **1.jsp和2.jsp:** POC利用了 /1.jsp 和 /2.jsp 文件，其中2.jsp 似乎动态生成jsp马，写入到/1.jsp.
5.  **并发执行：** 使用线程池并发执行PUT和GET请求，增加竞争成功的概率。
6.  **Payload：**  `upload.txt` 文件包含JSP payload，用于写入恶意代码。

**有效性评估：**

根据漏洞描述，搜索引擎结果和POC代码，该漏洞利用是有效的。POC代码尝试利用竞争条件上传包含恶意代码的JSP文件。

**投毒风险评估：**

POC代码本身的主要目的是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **恶意Payload：**`upload.txt` 文件中的payload可能包含恶意代码，如果使用者不检查该文件内容直接运行POC，可能会在目标系统上植入后门。
2.  **隐藏逻辑：** 脚本中可能存在隐蔽的后门代码, 虽然代码主要逻辑围绕竞争和JSP上传, 但不能完全排除作者添加额外恶意行为的可能性, 虽然可能性较低。
3.  **依赖风险：**虽然代码本身没有直接的外部依赖，如果`upload.txt`来自于外部，那风险就变得不可控。
总体来说，投毒风险较低，大约5%，但需要仔细审查`upload.txt`的内容，确保其安全性。

**建议：**
* 升级到Tomcat 11.0.2, 10.1.34 或 9.0.98。
* 禁用默认servlet的写入权限。
* 仔细审查并测试POC代码，确保理解其行为，避免未知的风险。

**项目地址:** [dear-cell/CVE-2024-50379](https://github.com/dear-cell/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #8

**来源**: [CVE-2024-50379-dkstar11q_CVE-2024-50379-nuclei.md](../2024/CVE-2024-50379-dkstar11q_CVE-2024-50379-nuclei.md)

## CVE-2024-50379-ApacheTomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 Servlet 启用写入且文件系统不区分大小写时，在 JSP 编译期间可能导致远程代码执行。

**漏洞利用方式：**
1.  攻击者利用PUT方法上传一个JSP文件到一个可写目录。
2.  由于TOCTOU漏洞，在Tomcat检查文件类型和实际编译文件之间存在时间差，攻击者可以利用竞争条件，上传恶意JSP文件绕过检查。
3.  上传的JSP文件会被当做可执行文件执行，从而导致远程代码执行。

**POC有效性：**
提供的`poc.py`脚本通过多线程并发上传包含恶意代码的JSP文件，利用竞争条件触发漏洞。该脚本首先检查目标是否允许PUT请求，然后通过PUT上传一个payload，该payload用于将webshell写入指定路径，最后GET请求访问该webshell，如果返回200则验证成功

**投毒风险评估：**
该仓库中是否存在投毒代码的可能性较低。`poc.py`的主要功能是利用漏洞上传和执行webshell。虽然webshell本身具有潜在的风险，但它属于漏洞利用的范畴，并不构成“投毒”。脚本的功能相对明确，没有发现隐藏的恶意行为。考虑到脚本的开源性质以及其目标是漏洞利用，作者隐藏恶意代码的可能性较低，但不能完全排除，因此评估的投毒风险为1%。

**项目地址:** [dkstar11q/CVE-2024-50379-nuclei](https://github.com/dkstar11q/CVE-2024-50379-nuclei)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #9

**来源**: [CVE-2024-50379-dragonked2_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-dragonked2_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个时间检查/时间使用 (TOCTOU) 竞争条件漏洞。该漏洞出现在 JSP 编译期间，当默认 servlet 启用了写入（非默认配置）且文件系统大小写不敏感时，允许远程代码执行 (RCE)。攻击者可以利用此漏洞上传一个文件，并通过竞争条件使其被 Tomcat 作为 JSP 文件执行，从而导致任意代码执行。提供的代码段是 Apache 2.0 许可协议，并非漏洞利用代码本身，因此无法直接验证 POC 的有效性。但根据搜索结果，存在公开的POC，可以利用。由于提供的代码只是许可协议，不包含恶意代码，因此投毒风险为0%。利用方式如下：

1.  **上传恶意文件：** 攻击者上传一个恶意文件，该文件伪装成 JSP 文件，但实际上包含恶意代码。
2.  **竞争条件：** 攻击者利用 TOCTOU 漏洞，在 Tomcat 检查文件类型和实际编译文件之间制造时间差。
3.  **绕过检查：** 在检查通过后，攻击者通过某种方式修改文件内容，使其成为真正的 JSP 文件，并包含恶意代码。
4.  **远程代码执行：** Tomcat 编译并执行该 JSP 文件，从而导致远程代码执行。

**项目地址:** [dragonked2/CVE-2024-50379-POC](https://github.com/dragonked2/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #10

**来源**: [CVE-2024-50379-gomtaengi_CVE-2024-50379-exp.md](../2024/CVE-2024-50379-gomtaengi_CVE-2024-50379-exp.md)

## CVE-2024-50379 - Apache Tomcat TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 9.0.0.M1 - 9.0.97, 10.1.0-M1 - 10.1.33, 11.0.0-M1 - 11.0.1

**利用条件:** 默认 servlet 启用写入 (非默认配置)且运行在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是 Apache Tomcat 中 JSP 编译期间发生的 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 servlet 启用写入时，攻击者可以通过上传包含恶意 JSP 代码的文件并利用竞争条件来触发 Tomcat 解析和执行它，从而实现远程代码执行。

**利用方式：**

1.  **上传恶意 JSP 文件：** 攻击者首先上传一个名为 `test01_{random_suffix}.txt` 的文件，其中包含JSP Footer代码，该代码的功能是接收通过请求头传递的base64编码的payload，然后通过AES解密后加载到内存中执行。
2.  **利用竞争条件：** 攻击者利用竞争条件，尝试在 Tomcat 将上传的 `.txt` 文件识别为普通文本文件之前，将其重命名为 `.jsp` 文件。这需要同时发送大量的请求。
3.  **JSP 编译和执行：** 如果竞争成功，Tomcat 将尝试编译并执行该 `.jsp` 文件，从而允许攻击者执行任意代码。

**POC代码分析：**

提供的 Python POC 脚本旨在自动化利用此漏洞。脚本执行以下步骤：

1.  **生成随机字符串和哈希：** 生成随机后缀和 MD5 哈希值，用于生成唯一的临时文件名和最终的 JSP 文件名。
2.  **生成 JSP 内容：** 生成包含将源文件复制到目标文件的 JSP 代码。
3.  **发送 PUT 请求：** 使用生成的随机文件名将恶意 JSP 内容上传到服务器。 通过PUT上传t1{random_suffix}.Txt和t2{random_suffix}.Txt为JSP Footer内容，t1{random_suffix}.Jsp和t2{random_suffix}.Jsp为JSP Header内容。
4.  **发送 GET 请求：** 发送GET请求, 检查目标JSP是否存在.
5.  **多线程并发：** 使用多线程并发来增加竞争条件成功的可能性。
6.  **停止机制:**  一旦发现漏洞则停止扫描.

**投毒风险分析：**

代码中存在一定的投毒风险，主要集中在以下几个方面：

1.  **JSP Footer 的自定义内容：** 脚本允许用户通过 `-f` 或 `--footer` 参数指定自定义的 JSP footer 内容。 如果攻击者指定了恶意的 JSP 代码，则可能导致被攻击的服务器受到进一步的损害。 但这是参数问题，不是代码本身的问题。
2.  **Payload 执行：** JSP Footer 中的恶意代码功能是通过请求头传递加密的payload，并将其加载到内存中执行。攻击者可以通过控制请求头来执行任意代码。尽管这本身就是漏洞利用的一部分，但如果攻击者能够注入额外的恶意代码，则可能导致更严重的后果。

**总结：**

该漏洞利用的有效性较高，但也依赖于特定的配置（默认 servlet 启用写入）和文件系统类型（大小写不敏感）。POC 代码可以有效利用此漏洞，但存在一定的投毒风险，用户需要谨慎使用，尤其是在指定自定义 JSP 内容时。Payload的加载和执行是漏洞利用的关键步骤。

**项目地址:** [gomtaengi/CVE-2024-50379-exp](https://github.com/gomtaengi/CVE-2024-50379-exp)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #11

**来源**: [CVE-2024-50379-iSee857_CVE-2024-50379-PoC.md](../2024/CVE-2024-50379-iSee857_CVE-2024-50379-PoC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入(非默认配置)，文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379是Apache Tomcat中的一个Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认Servlet启用写入且文件系统不区分大小写时，攻击者可以通过竞争条件在JSP编译期间执行远程代码。

**漏洞利用方式：**

1.  攻击者发送PUT请求上传一个名为`aa.Jsp`的文件，包含恶意JSP代码，例如`aa<% Runtime.getRuntime().exec("calc.exe");%>`。同时上传`bb.Jsp`类似的文件。
2.  利用TOCTOU漏洞：在Tomcat检查文件类型之后，但在编译之前，攻击者通过竞争条件修改文件内容，从而绕过安全检查。
3.  Tomcat将上传的文件编译为JSP，执行其中的恶意代码，导致远程代码执行。
4.  POC代码通过多线程并发PUT和GET请求，尝试触发竞争条件，利用漏洞。

**有效性：**

提供的POC代码利用了多线程并发请求，旨在触发TOCTOU竞争条件，经验证是有效的。搜索引擎结果也表明该漏洞可被利用，并提供了相关的PoC。

**投毒风险：**

该仓库中的POC代码的主要功能是利用CVE-2024-50379漏洞进行远程代码执行的验证。  payload使用了calc.exe, 并没有发现明显的恶意行为，例如反弹shell或植入持久性后门。代码存在极小概率的投毒风险（例如，在非常隐蔽的地方插入恶意代码，或者利用竞争条件引入不可预测的行为），但这种可能性很低。基于对整个代码的审查，判断投毒风险约为1%。代码中只是用于验证漏洞的后门代码，不属于投毒代码。


**项目地址:** [iSee857/CVE-2024-50379-PoC](https://github.com/iSee857/CVE-2024-50379-PoC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #12

**来源**: [CVE-2024-50379-lizhianyuguangming_CVE-2024-50379-exp.md](../2024/CVE-2024-50379-lizhianyuguangming_CVE-2024-50379-exp.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU 竞态条件导致远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false（非默认配置），运行在大小写不敏感的文件系统上，网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU (Time-of-Check Time-of-Use) 竞态条件漏洞，发生在 JSP 编译期间。当 Tomcat 运行在大小写不敏感的文件系统上，并且默认 Servlet 的 `readonly` 参数设置为 `false` （这**不是默认配置**），攻击者可以通过竞态条件竞争，上传一个文件，并在 Tomcat 检查其类型之前，将其替换为恶意的 JSP 文件，从而导致远程代码执行。

**漏洞利用方式：**

1.  **先决条件：** 目标 Tomcat 实例必须配置为允许写入（`readonly=false`）。目标服务器的文件系统需要不区分大小写，如 Windows 服务器。
2.  **上传文件：** 攻击者上传一个文件，比如 `t1<random_suffix>.txt` 和 `t2<random_suffix>.txt`，包含部分 JSP 代码，为恶意JSP文件的前半部分和后半部分，用于后续组合。
3.  **竞争条件：** 攻击者发送并发请求，尝试利用 TOCTOU 漏洞。这些请求尝试在 Tomcat 检查文件类型之前，修改上传的文件。
4.  **替换文件：**  利用竞态条件，在 Tomcat 检查文件类型之后，但在实际编译之前，恶意 JSP 代码被写入到上传的文件中。
5.  **JSP 编译：** Tomcat 编译并执行恶意 JSP 代码，从而导致 RCE。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于自动化利用此漏洞。主要步骤如下：

1.  **加载目标 URL：** 从 `url.txt` 文件中读取目标 Tomcat 服务器的 URL 列表。
2.  **生成随机字符串和 MD5 哈希：** 用于生成临时文件名和进行一些操作。
3.  **生成 JSP 代码：**生成用于将文件重命名并执行的JSP Header和JSP Footer,其中JSP Footer包含冰蝎payload。
4.  **发送 GET 请求：**  向目标服务器发送 GET 请求，触发漏洞利用。构造特定的 URL，访问恶意文件，触发 JSP 编译，执行恶意代码。
5.  **并发执行：** 使用线程池并发发送请求，以增加利用成功的概率。

**投毒风险分析：**

该脚本的主要目的是利用 CVE-2024-50379 漏洞，实现远程代码执行。 但是，在 `generate_jsp_footer` 函数中，默认情况下包含一个冰蝎 payload。如果使用者不了解这段代码的作用，可能会在不知情的情况下植入后门。

-   **投毒代码：** `generate_jsp_footer` 函数中默认包含冰蝎 payload。
-   **风险评估：** 冰蝎是一个流行的 webshell 工具，攻击者可以使用它来远程管理服务器，执行任意命令，上传和下载文件等。

因此，该脚本存在一定的投毒风险，使用者需要仔细检查代码，确保自己了解每一部分代码的作用。特别是 `generate_jsp_footer` 函数，使用者可以自定义 `custom_content` 参数，替换默认的冰蝎 payload。

**投毒风险比例：** 10%（主要风险在于使用者不了解默认 payload 的作用，在不知情的情况下使用）。


**项目地址:** [lizhianyuguangming/CVE-2024-50379-exp](https://github.com/lizhianyuguangming/CVE-2024-50379-exp)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #13

**来源**: [CVE-2024-50379-ph0ebus_Tomcat-CVE-2024-50379-Poc.md](../2024/CVE-2024-50379-ph0ebus_Tomcat-CVE-2024-50379-Poc.md)

# CVE-2024-50379

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-50379-Alchemist3dot14_CVE-2024-50379.md](../2024/CVE-2024-50379-Alchemist3dot14_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1
10.1.0-M1 <= version <= 10.1.33
9.0.0.M1 <= version <= 9.0.97

**利用条件:** 1. 存在大小写不敏感的文件系统。
2. 默认Servlet开启写入功能(非默认配置)。
3. 目标服务器存在/uploads目录且可写。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中 JSP 编译期间的 Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认 servlet 启用写入（非默认配置）且文件系统不区分大小写时，攻击者可以利用此漏洞实现远程代码执行。该 PoC 代码通过上传包含恶意代码的 JSP shell 到可写目录（如/uploads）并利用该 shell 执行任意系统命令来演示漏洞利用过程。需要注意的是,PoC代码中定义了BASE_URL、UPLOAD_ENDPOINT、SHELL_NAME和SHELL_CONTENT等变量，如果攻击者修改了SHELL_CONTENT内容添加了恶意程序，可能会对目标系统造成其他安全威胁。尽管 PoC 本身是为了演示漏洞，但确实存在被滥用进行恶意攻击的风险。该PoC的投毒风险主要来自修改后的JSP shell, 例如执行反弹shell或下载执行其他恶意程序。代码中虽然没有明显的恶意投毒代码，但是存在一定风险，例如JSP shell执行命令时的注入，或对服务器的其他操作等，所以投毒风险评为10%。

**项目地址:** [Alchemist3dot14/CVE-2024-50379](https://github.com/Alchemist3dot14/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #2

**来源**: [CVE-2024-50379-JFOZ1010_Nuclei-Template-CVE-2024-50379.md](../2024/CVE-2024-50379-JFOZ1010_Nuclei-Template-CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition 导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false，且文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是一个Apache Tomcat中的TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞。当Tomcat的默认Servlet的`readonly`参数设置为`false`时（非默认配置），攻击者可以通过上传一个JSP文件，并在Tomcat编译该JSP文件时，通过竞争条件替换该文件为恶意JSP文件，从而实现远程代码执行。

**漏洞利用方式：**

1.  **条件满足：**  确保目标Tomcat实例的默认Servlet的`readonly`参数已设置为`false`。这意味着允许通过默认Servlet上传文件。
2.  **上传JSP文件：**  首先上传一个良性的JSP文件，例如`hello.jsp`，其中包含一些基本代码，比如打印"Hello, World!"。
3.  **竞争条件：**  在Tomcat编译`hello.jsp`文件时，攻击者迅速上传一个恶意的JSP文件，比如`HELLO.JSP`（注意大小写差异，利用文件系统大小写不敏感的特性），其中包含执行任意命令的代码（例如，启动计算器）。
4.  **远程代码执行：**  如果竞争成功，Tomcat会编译并执行恶意的`HELLO.JSP`文件，从而导致远程代码执行。

**POC分析：**

提供的Nuclei模板`CVE-2024-50379.yaml` 旨在自动化此漏洞的检测。它通过以下步骤工作：

1.  上传一个包含 "Hello, World!" 的良性JSP文件 (`hello.jsp`) 到 `/upload.jsp` 。
2.  快速上传一个包含恶意代码的JSP文件 (`HELLO.JSP`) 到 `/uploads/upload.jsp` 。这个恶意JSP包含执行计算器的代码片段 `Runtime.getRuntime().exec("calc.exe");`。
3.  尝试访问上传的文件 (`/uploads/hello.jsp`) ，并检查响应是否包含预期的输出或错误信息。

**投毒风险分析：**

虽然提供的POC代码本身旨在利用漏洞，而非植入后门，但仍然存在一些潜在的投毒风险：

*   **文件名大小写混淆:**  利用了大小写不敏感的文件系统, 可能存在编码问题或文件系统差异导致POC失效, 但不属于后门或投毒代码
*   **自定义恶意JSP：**  用户在使用POC时，可能会修改恶意JSP文件中的代码，以执行其他恶意操作，例如上传webshell或执行更隐蔽的命令。这取决于用户自身行为，不属于POC作者投毒。
*   **依赖外部资源：**  虽然当前的POC没有直接依赖外部资源，但如果用户修改POC并添加对外部资源的依赖（例如，下载恶意脚本），则可能引入投毒风险。
*   **README.md中的免责声明：** README明确说明了使用该模板的伦理责任，并强调只能在授权环境下使用。这在一定程度上降低了作者恶意使用的可能性。

综合考虑，尽管存在一些潜在的风险，但该仓库中直接包含作者有意植入的投毒代码的可能性较低。投毒风险主要来自于用户对POC的修改和使用方式。 因此，我给出的投毒风险概率是10%。

**项目地址:** [JFOZ1010/Nuclei-Template-CVE-2024-50379](https://github.com/JFOZ1010/Nuclei-Template-CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #3

**来源**: [CVE-2024-50379-SleepingBag945_CVE-2024-50379.md](../2024/CVE-2024-50379-SleepingBag945_CVE-2024-50379.md)

## CVE-2024-50379 - Apache Tomcat TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 竞争条件导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可远程执行任意代码

**影响版本:** 9.0.0.M1 <= version <= 9.0.97, 10.1.0-M1 <= version <= 10.1.33, 11.0.0-M1 <= version <= 11.0.1

**利用条件:** 1. Apache Tomcat 存在漏洞版本;2. 运行在大小写不敏感的文件系统上; 3. 默认 Servlet 启用了写入功能 (非默认配置)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞，存在于 JSP 编译过程中。当 Tomcat 运行在大小写不敏感的文件系统上，且默认 Servlet 启用写入功能时（这是一个非默认配置），攻击者可以通过竞争条件绕过安全检查，上传恶意 JSP 文件并执行，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  攻击者利用竞争条件，在 Tomcat 检查文件类型之后、编译之前，修改已上传文件的内容。
2.  由于 Tomcat 存在 TOCTOU 漏洞，因此可以绕过安全检查，导致恶意 JSP 代码被执行。
3.  漏洞利用代码（PoC）`main.go`是一个Go程序，它通过并发发送请求来触发竞争条件，上传一个包含恶意代码的JSP文件。它使用`fasthttp`库发送HTTP请求，利用`ants/v2`库管理并发连接池。

**投毒风险分析：**

代码整体结构较为清晰，主要功能是利用漏洞，并未发现明显的恶意代码。可能的投毒风险在于作者使用的第三方库是否安全，或者作者是否在不显眼的地方添加了恶意代码。风险评估：

*   **第三方库风险：** 代码依赖`github.com/valyala/fasthttp`和`github.com/panjf2000/ants/v2`两个库。需要检查这些库是否存在已知的安全问题。作者替换了`fasthttp`库，需要仔细检查替换的`fasthttp`代码是否存在恶意代码。
*   **代码逻辑风险：** 代码逻辑相对简单，主要就是发送请求，没有发现明显的植入后门的地方。

因此，综合来看，投毒的可能性较低，风险值设定为10%。主要风险还是在于对作者修改过的`fasthttp`库的审核，需要人工进行安全审计。

**项目地址:** [SleepingBag945/CVE-2024-50379](https://github.com/SleepingBag945/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #4

**来源**: [CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 需要目标系统为大小写不敏感的文件系统，且default servlet的write权限开启（非默认配置）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞。此漏洞出现在 JSP 编译过程中，允许在大小写不敏感的文件系统上进行远程代码执行（RCE），前提是默认 servlet 启用了写入权限（非默认配置）。

**漏洞利用方式：**

1.  攻击者上传一个包含恶意 JSP 代码的文件，该文件旨在执行任意命令。
2.  由于 TOCTOU 漏洞，Tomcat 在检查文件和实际编译文件之间存在时间差。
3.  攻击者利用这个时间差，通过竞争条件来修改或替换上传的文件内容。
4.  如果攻击成功，Tomcat 将编译并执行恶意 JSP 代码，从而导致远程代码执行。

**POC代码分析：**

提供的POC代码 (`Exploit-poc.py`) 旨在自动化利用此漏洞的过程。它执行以下操作：

1.  **上传Payload:** 使用`PUT`请求将包含恶意代码的JSP文件（`rce.jsp`）上传到目标服务器。
2.  **触发Payload:** 使用`GET`请求访问上传的JSP文件，触发服务器执行JSP中的恶意代码。

该脚本允许指定单个目标URL或包含目标URL列表的文件，并使用多线程来加速漏洞利用过程。

**有效性：**

根据漏洞信息和搜索结果，POC代码是有效的，可以利用该漏洞在满足特定条件的目标系统上执行远程代码。

**投毒风险：**

虽然POC代码本身主要是为了验证和利用漏洞，但仍然存在一定的投毒风险。`JSP_PAYLOAD` 变量允许攻击者自定义执行的命令，如果攻击者上传的Payload包含恶意代码，可能会对目标系统造成损害。例如，Payload可以执行系统命令、修改文件或窃取敏感数据。
此外，脚本中 `if resp.status_code == 200 and "root" in resp.text.lower():` 判断是否存在漏洞利用成功，这里存在一定的概率作者可能存在恶意的判断，导致虽然命令执行成功，但无法正确显示出来，从而导致攻击者判断失误，后续进行恶意操作。

综合评估，该仓库中存在一定程度的投毒风险，风险概率约为10%。主要是考虑到代码作者可以通过构造Payload来影响目标系统，或通过不准确的判断结果来迷惑攻击者。

**项目地址:** [Yuri08loveElaina/CVE-2024-50379-POC](https://github.com/Yuri08loveElaina/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #5

**来源**: [CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379.md](../2024/CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379.md)

## CVE-2024-50379 - Apache Tomcat JSP 编译 TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** 9.0.0.M1 - 9.0.97, 10.1.0-M1 - 10.1.33, 11.0.0-M1 - 11.0.1

**利用条件:** 默认Servlet启用写入（非默认配置），大小写不敏感的文件系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU（Time-of-check Time-of-use）竞争条件漏洞，发生在 JSP 编译期间。如果满足以下条件，则可能导致远程代码执行：

1.  **默认 Servlet 启用写入：** Tomcat 的默认 Servlet 允许写入，这不是默认配置，需要手动开启。
2.  **大小写不敏感的文件系统：** 操作系统使用大小写不敏感的文件系统（例如 Windows）。

**漏洞利用方式：**

攻击者通过上传恶意 JSP 文件（例如 aa.Jsp 和 bb.Jsp）并利用并发请求触发 TOCTOU 漏洞。具体来说，攻击者会并发地发送 PUT 和 GET 请求到 Tomcat 服务器。PUT 请求用于上传包含恶意代码的 JSP 文件，GET 请求用于访问这些 JSP 文件。由于竞争条件，Tomcat 可能会在文件检查后、实际执行文件之前，将文件误判为安全，从而导致恶意代码被执行。

漏洞利用代码 `exploit.py` 模拟了这种攻击方式，它并发地向目标 URL 发送 PUT 和 GET 请求，尝试上传和执行包含反弹 shell 代码的 JSP 文件。代码中使用了多线程来增加竞争成功的概率。

**有效性：**

根据漏洞描述和搜索结果，POC代码在满足特定条件（默认 Servlet 启用写入，大小写不敏感的文件系统）下有效。它利用了并发请求来触发 TOCTOU 漏洞，从而允许远程代码执行。

**投毒风险：**

查看提供的代码，发现该代码的功能是尝试利用 CVE-2024-50379 漏洞进行远程代码执行。代码本身实现了并发上传和访问JSP文件，并通过反弹shell执行恶意代码。**该代码的目的是进行漏洞验证和利用，而不是植入恶意后门**。因此，认为该代码存在投毒风险的可能性极低，判定为0%。

搜索结果也表明该漏洞利用涉及竞争条件，需要并发执行 PUT 和 GET 请求才能成功利用。这与 POC 代码的实现方式相符。

**项目地址:** [Yuri08loveElaina/CVE-2024-50379](https://github.com/Yuri08loveElaina/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #6

**来源**: [CVE-2024-50379-carefreegarb_CVE-2024-50379.md](../2024/CVE-2024-50379-carefreegarb_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可以导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 1. 目标系统为大小写不敏感的文件系统。
2. Tomcat的default servlet的readonly参数设置为false（非默认配置，允许写入）。
3. 存在网络访问Tomcat服务器的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是Apache Tomcat中的一个Time-of-Check Time-of-Use (TOCTOU)竞争条件漏洞。当满足以下条件时，攻击者可以利用此漏洞在服务器上执行任意代码：

*   **环境要求:** 目标系统使用大小写不敏感的文件系统，并且default servlet的`readonly`参数设置为`false`。
*   **漏洞原理:** 在JSP编译期间，Tomcat存在一个竞争条件。攻击者可以在Tomcat检查文件是否存在和可写之后，但在实际编译之前，替换JSP文件。通过精心构造JSP文件，攻击者可以上传恶意代码，并在服务器上执行。
*   **利用方式:**  提供的POC代码是一个Go程序，它利用多线程并发上传恶意JSP文件，从而触发竞争条件。该POC接受目标URL、包含恶意代码的JSP文件路径以及目标服务器上保存的文件名/路径作为参数。
*   **有效性:** 根据搜索结果和POC代码，该漏洞利用是有效的，可以实现远程代码执行。
*   **投毒风险评估:** 提供的代码中存在一定的投毒风险。虽然主要功能是实现漏洞利用，但作者可能在代码中添加一些不明显的后门或者恶意行为。代码中包含`replace github.com/valyala/fasthttp v1.58.0 => ./fasthttp`。使用本地修改过的 `fasthttp` 库存在潜在风险，恶意作者可能在修改后的库中植入后门。因此，对于此类来源不明的代码，需要进行代码审计，才能确保其安全性。综合考虑，存在10%的投毒风险。

**项目地址:** [carefreegarb/CVE-2024-50379](https://github.com/carefreegarb/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #7

**来源**: [CVE-2024-50379-dear-cell_CVE-2024-50379.md](../2024/CVE-2024-50379-dear-cell_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认servlet配置为可写(非默认配置)，文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 servlet 配置为可写（非默认配置）且文件系统大小写不敏感时，攻击者可以通过竞争条件在JSP编译期间执行任意代码，导致远程代码执行（RCE）。

**漏洞利用方式：**

1.  **竞争条件：** 利用JSP编译过程中的TOCTOU漏洞，通过并发请求修改正在编译的文件。
2.  **PUT请求：** POC代码使用PUT方法尝试上传JSP文件到目标URL（/asd.Jsp 和 /qwe.Jsp）。
3.  **GET请求：** POC代码也使用GET请求访问JSP文件。
4.  **1.jsp和2.jsp:** POC利用了 /1.jsp 和 /2.jsp 文件，其中2.jsp 似乎动态生成jsp马，写入到/1.jsp.
5.  **并发执行：** 使用线程池并发执行PUT和GET请求，增加竞争成功的概率。
6.  **Payload：**  `upload.txt` 文件包含JSP payload，用于写入恶意代码。

**有效性评估：**

根据漏洞描述，搜索引擎结果和POC代码，该漏洞利用是有效的。POC代码尝试利用竞争条件上传包含恶意代码的JSP文件。

**投毒风险评估：**

POC代码本身的主要目的是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **恶意Payload：**`upload.txt` 文件中的payload可能包含恶意代码，如果使用者不检查该文件内容直接运行POC，可能会在目标系统上植入后门。
2.  **隐藏逻辑：** 脚本中可能存在隐蔽的后门代码, 虽然代码主要逻辑围绕竞争和JSP上传, 但不能完全排除作者添加额外恶意行为的可能性, 虽然可能性较低。
3.  **依赖风险：**虽然代码本身没有直接的外部依赖，如果`upload.txt`来自于外部，那风险就变得不可控。
总体来说，投毒风险较低，大约5%，但需要仔细审查`upload.txt`的内容，确保其安全性。

**建议：**
* 升级到Tomcat 11.0.2, 10.1.34 或 9.0.98。
* 禁用默认servlet的写入权限。
* 仔细审查并测试POC代码，确保理解其行为，避免未知的风险。

**项目地址:** [dear-cell/CVE-2024-50379](https://github.com/dear-cell/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #8

**来源**: [CVE-2024-50379-dkstar11q_CVE-2024-50379-nuclei.md](../2024/CVE-2024-50379-dkstar11q_CVE-2024-50379-nuclei.md)

## CVE-2024-50379-ApacheTomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 Servlet 启用写入且文件系统不区分大小写时，在 JSP 编译期间可能导致远程代码执行。

**漏洞利用方式：**
1.  攻击者利用PUT方法上传一个JSP文件到一个可写目录。
2.  由于TOCTOU漏洞，在Tomcat检查文件类型和实际编译文件之间存在时间差，攻击者可以利用竞争条件，上传恶意JSP文件绕过检查。
3.  上传的JSP文件会被当做可执行文件执行，从而导致远程代码执行。

**POC有效性：**
提供的`poc.py`脚本通过多线程并发上传包含恶意代码的JSP文件，利用竞争条件触发漏洞。该脚本首先检查目标是否允许PUT请求，然后通过PUT上传一个payload，该payload用于将webshell写入指定路径，最后GET请求访问该webshell，如果返回200则验证成功

**投毒风险评估：**
该仓库中是否存在投毒代码的可能性较低。`poc.py`的主要功能是利用漏洞上传和执行webshell。虽然webshell本身具有潜在的风险，但它属于漏洞利用的范畴，并不构成“投毒”。脚本的功能相对明确，没有发现隐藏的恶意行为。考虑到脚本的开源性质以及其目标是漏洞利用，作者隐藏恶意代码的可能性较低，但不能完全排除，因此评估的投毒风险为1%。

**项目地址:** [dkstar11q/CVE-2024-50379-nuclei](https://github.com/dkstar11q/CVE-2024-50379-nuclei)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #9

**来源**: [CVE-2024-50379-dragonked2_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-dragonked2_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个时间检查/时间使用 (TOCTOU) 竞争条件漏洞。该漏洞出现在 JSP 编译期间，当默认 servlet 启用了写入（非默认配置）且文件系统大小写不敏感时，允许远程代码执行 (RCE)。攻击者可以利用此漏洞上传一个文件，并通过竞争条件使其被 Tomcat 作为 JSP 文件执行，从而导致任意代码执行。提供的代码段是 Apache 2.0 许可协议，并非漏洞利用代码本身，因此无法直接验证 POC 的有效性。但根据搜索结果，存在公开的POC，可以利用。由于提供的代码只是许可协议，不包含恶意代码，因此投毒风险为0%。利用方式如下：

1.  **上传恶意文件：** 攻击者上传一个恶意文件，该文件伪装成 JSP 文件，但实际上包含恶意代码。
2.  **竞争条件：** 攻击者利用 TOCTOU 漏洞，在 Tomcat 检查文件类型和实际编译文件之间制造时间差。
3.  **绕过检查：** 在检查通过后，攻击者通过某种方式修改文件内容，使其成为真正的 JSP 文件，并包含恶意代码。
4.  **远程代码执行：** Tomcat 编译并执行该 JSP 文件，从而导致远程代码执行。

**项目地址:** [dragonked2/CVE-2024-50379-POC](https://github.com/dragonked2/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #10

**来源**: [CVE-2024-50379-gomtaengi_CVE-2024-50379-exp.md](../2024/CVE-2024-50379-gomtaengi_CVE-2024-50379-exp.md)

## CVE-2024-50379 - Apache Tomcat TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 9.0.0.M1 - 9.0.97, 10.1.0-M1 - 10.1.33, 11.0.0-M1 - 11.0.1

**利用条件:** 默认 servlet 启用写入 (非默认配置)且运行在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是 Apache Tomcat 中 JSP 编译期间发生的 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 servlet 启用写入时，攻击者可以通过上传包含恶意 JSP 代码的文件并利用竞争条件来触发 Tomcat 解析和执行它，从而实现远程代码执行。

**利用方式：**

1.  **上传恶意 JSP 文件：** 攻击者首先上传一个名为 `test01_{random_suffix}.txt` 的文件，其中包含JSP Footer代码，该代码的功能是接收通过请求头传递的base64编码的payload，然后通过AES解密后加载到内存中执行。
2.  **利用竞争条件：** 攻击者利用竞争条件，尝试在 Tomcat 将上传的 `.txt` 文件识别为普通文本文件之前，将其重命名为 `.jsp` 文件。这需要同时发送大量的请求。
3.  **JSP 编译和执行：** 如果竞争成功，Tomcat 将尝试编译并执行该 `.jsp` 文件，从而允许攻击者执行任意代码。

**POC代码分析：**

提供的 Python POC 脚本旨在自动化利用此漏洞。脚本执行以下步骤：

1.  **生成随机字符串和哈希：** 生成随机后缀和 MD5 哈希值，用于生成唯一的临时文件名和最终的 JSP 文件名。
2.  **生成 JSP 内容：** 生成包含将源文件复制到目标文件的 JSP 代码。
3.  **发送 PUT 请求：** 使用生成的随机文件名将恶意 JSP 内容上传到服务器。 通过PUT上传t1{random_suffix}.Txt和t2{random_suffix}.Txt为JSP Footer内容，t1{random_suffix}.Jsp和t2{random_suffix}.Jsp为JSP Header内容。
4.  **发送 GET 请求：** 发送GET请求, 检查目标JSP是否存在.
5.  **多线程并发：** 使用多线程并发来增加竞争条件成功的可能性。
6.  **停止机制:**  一旦发现漏洞则停止扫描.

**投毒风险分析：**

代码中存在一定的投毒风险，主要集中在以下几个方面：

1.  **JSP Footer 的自定义内容：** 脚本允许用户通过 `-f` 或 `--footer` 参数指定自定义的 JSP footer 内容。 如果攻击者指定了恶意的 JSP 代码，则可能导致被攻击的服务器受到进一步的损害。 但这是参数问题，不是代码本身的问题。
2.  **Payload 执行：** JSP Footer 中的恶意代码功能是通过请求头传递加密的payload，并将其加载到内存中执行。攻击者可以通过控制请求头来执行任意代码。尽管这本身就是漏洞利用的一部分，但如果攻击者能够注入额外的恶意代码，则可能导致更严重的后果。

**总结：**

该漏洞利用的有效性较高，但也依赖于特定的配置（默认 servlet 启用写入）和文件系统类型（大小写不敏感）。POC 代码可以有效利用此漏洞，但存在一定的投毒风险，用户需要谨慎使用，尤其是在指定自定义 JSP 内容时。Payload的加载和执行是漏洞利用的关键步骤。

**项目地址:** [gomtaengi/CVE-2024-50379-exp](https://github.com/gomtaengi/CVE-2024-50379-exp)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #11

**来源**: [CVE-2024-50379-iSee857_CVE-2024-50379-PoC.md](../2024/CVE-2024-50379-iSee857_CVE-2024-50379-PoC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入(非默认配置)，文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379是Apache Tomcat中的一个Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认Servlet启用写入且文件系统不区分大小写时，攻击者可以通过竞争条件在JSP编译期间执行远程代码。

**漏洞利用方式：**

1.  攻击者发送PUT请求上传一个名为`aa.Jsp`的文件，包含恶意JSP代码，例如`aa<% Runtime.getRuntime().exec("calc.exe");%>`。同时上传`bb.Jsp`类似的文件。
2.  利用TOCTOU漏洞：在Tomcat检查文件类型之后，但在编译之前，攻击者通过竞争条件修改文件内容，从而绕过安全检查。
3.  Tomcat将上传的文件编译为JSP，执行其中的恶意代码，导致远程代码执行。
4.  POC代码通过多线程并发PUT和GET请求，尝试触发竞争条件，利用漏洞。

**有效性：**

提供的POC代码利用了多线程并发请求，旨在触发TOCTOU竞争条件，经验证是有效的。搜索引擎结果也表明该漏洞可被利用，并提供了相关的PoC。

**投毒风险：**

该仓库中的POC代码的主要功能是利用CVE-2024-50379漏洞进行远程代码执行的验证。  payload使用了calc.exe, 并没有发现明显的恶意行为，例如反弹shell或植入持久性后门。代码存在极小概率的投毒风险（例如，在非常隐蔽的地方插入恶意代码，或者利用竞争条件引入不可预测的行为），但这种可能性很低。基于对整个代码的审查，判断投毒风险约为1%。代码中只是用于验证漏洞的后门代码，不属于投毒代码。


**项目地址:** [iSee857/CVE-2024-50379-PoC](https://github.com/iSee857/CVE-2024-50379-PoC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #12

**来源**: [CVE-2024-50379-lizhianyuguangming_CVE-2024-50379-exp.md](../2024/CVE-2024-50379-lizhianyuguangming_CVE-2024-50379-exp.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU 竞态条件导致远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false（非默认配置），运行在大小写不敏感的文件系统上，网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU (Time-of-Check Time-of-Use) 竞态条件漏洞，发生在 JSP 编译期间。当 Tomcat 运行在大小写不敏感的文件系统上，并且默认 Servlet 的 `readonly` 参数设置为 `false` （这**不是默认配置**），攻击者可以通过竞态条件竞争，上传一个文件，并在 Tomcat 检查其类型之前，将其替换为恶意的 JSP 文件，从而导致远程代码执行。

**漏洞利用方式：**

1.  **先决条件：** 目标 Tomcat 实例必须配置为允许写入（`readonly=false`）。目标服务器的文件系统需要不区分大小写，如 Windows 服务器。
2.  **上传文件：** 攻击者上传一个文件，比如 `t1<random_suffix>.txt` 和 `t2<random_suffix>.txt`，包含部分 JSP 代码，为恶意JSP文件的前半部分和后半部分，用于后续组合。
3.  **竞争条件：** 攻击者发送并发请求，尝试利用 TOCTOU 漏洞。这些请求尝试在 Tomcat 检查文件类型之前，修改上传的文件。
4.  **替换文件：**  利用竞态条件，在 Tomcat 检查文件类型之后，但在实际编译之前，恶意 JSP 代码被写入到上传的文件中。
5.  **JSP 编译：** Tomcat 编译并执行恶意 JSP 代码，从而导致 RCE。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于自动化利用此漏洞。主要步骤如下：

1.  **加载目标 URL：** 从 `url.txt` 文件中读取目标 Tomcat 服务器的 URL 列表。
2.  **生成随机字符串和 MD5 哈希：** 用于生成临时文件名和进行一些操作。
3.  **生成 JSP 代码：**生成用于将文件重命名并执行的JSP Header和JSP Footer,其中JSP Footer包含冰蝎payload。
4.  **发送 GET 请求：**  向目标服务器发送 GET 请求，触发漏洞利用。构造特定的 URL，访问恶意文件，触发 JSP 编译，执行恶意代码。
5.  **并发执行：** 使用线程池并发发送请求，以增加利用成功的概率。

**投毒风险分析：**

该脚本的主要目的是利用 CVE-2024-50379 漏洞，实现远程代码执行。 但是，在 `generate_jsp_footer` 函数中，默认情况下包含一个冰蝎 payload。如果使用者不了解这段代码的作用，可能会在不知情的情况下植入后门。

-   **投毒代码：** `generate_jsp_footer` 函数中默认包含冰蝎 payload。
-   **风险评估：** 冰蝎是一个流行的 webshell 工具，攻击者可以使用它来远程管理服务器，执行任意命令，上传和下载文件等。

因此，该脚本存在一定的投毒风险，使用者需要仔细检查代码，确保自己了解每一部分代码的作用。特别是 `generate_jsp_footer` 函数，使用者可以自定义 `custom_content` 参数，替换默认的冰蝎 payload。

**投毒风险比例：** 10%（主要风险在于使用者不了解默认 payload 的作用，在不知情的情况下使用）。


**项目地址:** [lizhianyuguangming/CVE-2024-50379-exp](https://github.com/lizhianyuguangming/CVE-2024-50379-exp)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #13

**来源**: [CVE-2024-50379-ph0ebus_Tomcat-CVE-2024-50379-Poc.md](../2024/CVE-2024-50379-ph0ebus_Tomcat-CVE-2024-50379-Poc.md)

# CVE-2024-50379

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-50379-Alchemist3dot14_CVE-2024-50379.md](../2024/CVE-2024-50379-Alchemist3dot14_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1
10.1.0-M1 <= version <= 10.1.33
9.0.0.M1 <= version <= 9.0.97

**利用条件:** 1. 存在大小写不敏感的文件系统。
2. 默认Servlet开启写入功能(非默认配置)。
3. 目标服务器存在/uploads目录且可写。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中 JSP 编译期间的 Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认 servlet 启用写入（非默认配置）且文件系统不区分大小写时，攻击者可以利用此漏洞实现远程代码执行。该 PoC 代码通过上传包含恶意代码的 JSP shell 到可写目录（如/uploads）并利用该 shell 执行任意系统命令来演示漏洞利用过程。需要注意的是,PoC代码中定义了BASE_URL、UPLOAD_ENDPOINT、SHELL_NAME和SHELL_CONTENT等变量，如果攻击者修改了SHELL_CONTENT内容添加了恶意程序，可能会对目标系统造成其他安全威胁。尽管 PoC 本身是为了演示漏洞，但确实存在被滥用进行恶意攻击的风险。该PoC的投毒风险主要来自修改后的JSP shell, 例如执行反弹shell或下载执行其他恶意程序。代码中虽然没有明显的恶意投毒代码，但是存在一定风险，例如JSP shell执行命令时的注入，或对服务器的其他操作等，所以投毒风险评为10%。

**项目地址:** [Alchemist3dot14/CVE-2024-50379](https://github.com/Alchemist3dot14/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #2

**来源**: [CVE-2024-50379-JFOZ1010_Nuclei-Template-CVE-2024-50379.md](../2024/CVE-2024-50379-JFOZ1010_Nuclei-Template-CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition 导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false，且文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是一个Apache Tomcat中的TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞。当Tomcat的默认Servlet的`readonly`参数设置为`false`时（非默认配置），攻击者可以通过上传一个JSP文件，并在Tomcat编译该JSP文件时，通过竞争条件替换该文件为恶意JSP文件，从而实现远程代码执行。

**漏洞利用方式：**

1.  **条件满足：**  确保目标Tomcat实例的默认Servlet的`readonly`参数已设置为`false`。这意味着允许通过默认Servlet上传文件。
2.  **上传JSP文件：**  首先上传一个良性的JSP文件，例如`hello.jsp`，其中包含一些基本代码，比如打印"Hello, World!"。
3.  **竞争条件：**  在Tomcat编译`hello.jsp`文件时，攻击者迅速上传一个恶意的JSP文件，比如`HELLO.JSP`（注意大小写差异，利用文件系统大小写不敏感的特性），其中包含执行任意命令的代码（例如，启动计算器）。
4.  **远程代码执行：**  如果竞争成功，Tomcat会编译并执行恶意的`HELLO.JSP`文件，从而导致远程代码执行。

**POC分析：**

提供的Nuclei模板`CVE-2024-50379.yaml` 旨在自动化此漏洞的检测。它通过以下步骤工作：

1.  上传一个包含 "Hello, World!" 的良性JSP文件 (`hello.jsp`) 到 `/upload.jsp` 。
2.  快速上传一个包含恶意代码的JSP文件 (`HELLO.JSP`) 到 `/uploads/upload.jsp` 。这个恶意JSP包含执行计算器的代码片段 `Runtime.getRuntime().exec("calc.exe");`。
3.  尝试访问上传的文件 (`/uploads/hello.jsp`) ，并检查响应是否包含预期的输出或错误信息。

**投毒风险分析：**

虽然提供的POC代码本身旨在利用漏洞，而非植入后门，但仍然存在一些潜在的投毒风险：

*   **文件名大小写混淆:**  利用了大小写不敏感的文件系统, 可能存在编码问题或文件系统差异导致POC失效, 但不属于后门或投毒代码
*   **自定义恶意JSP：**  用户在使用POC时，可能会修改恶意JSP文件中的代码，以执行其他恶意操作，例如上传webshell或执行更隐蔽的命令。这取决于用户自身行为，不属于POC作者投毒。
*   **依赖外部资源：**  虽然当前的POC没有直接依赖外部资源，但如果用户修改POC并添加对外部资源的依赖（例如，下载恶意脚本），则可能引入投毒风险。
*   **README.md中的免责声明：** README明确说明了使用该模板的伦理责任，并强调只能在授权环境下使用。这在一定程度上降低了作者恶意使用的可能性。

综合考虑，尽管存在一些潜在的风险，但该仓库中直接包含作者有意植入的投毒代码的可能性较低。投毒风险主要来自于用户对POC的修改和使用方式。 因此，我给出的投毒风险概率是10%。

**项目地址:** [JFOZ1010/Nuclei-Template-CVE-2024-50379](https://github.com/JFOZ1010/Nuclei-Template-CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #3

**来源**: [CVE-2024-50379-SleepingBag945_CVE-2024-50379.md](../2024/CVE-2024-50379-SleepingBag945_CVE-2024-50379.md)

## CVE-2024-50379 - Apache Tomcat TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 竞争条件导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可远程执行任意代码

**影响版本:** 9.0.0.M1 <= version <= 9.0.97, 10.1.0-M1 <= version <= 10.1.33, 11.0.0-M1 <= version <= 11.0.1

**利用条件:** 1. Apache Tomcat 存在漏洞版本;2. 运行在大小写不敏感的文件系统上; 3. 默认 Servlet 启用了写入功能 (非默认配置)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞，存在于 JSP 编译过程中。当 Tomcat 运行在大小写不敏感的文件系统上，且默认 Servlet 启用写入功能时（这是一个非默认配置），攻击者可以通过竞争条件绕过安全检查，上传恶意 JSP 文件并执行，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  攻击者利用竞争条件，在 Tomcat 检查文件类型之后、编译之前，修改已上传文件的内容。
2.  由于 Tomcat 存在 TOCTOU 漏洞，因此可以绕过安全检查，导致恶意 JSP 代码被执行。
3.  漏洞利用代码（PoC）`main.go`是一个Go程序，它通过并发发送请求来触发竞争条件，上传一个包含恶意代码的JSP文件。它使用`fasthttp`库发送HTTP请求，利用`ants/v2`库管理并发连接池。

**投毒风险分析：**

代码整体结构较为清晰，主要功能是利用漏洞，并未发现明显的恶意代码。可能的投毒风险在于作者使用的第三方库是否安全，或者作者是否在不显眼的地方添加了恶意代码。风险评估：

*   **第三方库风险：** 代码依赖`github.com/valyala/fasthttp`和`github.com/panjf2000/ants/v2`两个库。需要检查这些库是否存在已知的安全问题。作者替换了`fasthttp`库，需要仔细检查替换的`fasthttp`代码是否存在恶意代码。
*   **代码逻辑风险：** 代码逻辑相对简单，主要就是发送请求，没有发现明显的植入后门的地方。

因此，综合来看，投毒的可能性较低，风险值设定为10%。主要风险还是在于对作者修改过的`fasthttp`库的审核，需要人工进行安全审计。

**项目地址:** [SleepingBag945/CVE-2024-50379](https://github.com/SleepingBag945/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #4

**来源**: [CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 需要目标系统为大小写不敏感的文件系统，且default servlet的write权限开启（非默认配置）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞。此漏洞出现在 JSP 编译过程中，允许在大小写不敏感的文件系统上进行远程代码执行（RCE），前提是默认 servlet 启用了写入权限（非默认配置）。

**漏洞利用方式：**

1.  攻击者上传一个包含恶意 JSP 代码的文件，该文件旨在执行任意命令。
2.  由于 TOCTOU 漏洞，Tomcat 在检查文件和实际编译文件之间存在时间差。
3.  攻击者利用这个时间差，通过竞争条件来修改或替换上传的文件内容。
4.  如果攻击成功，Tomcat 将编译并执行恶意 JSP 代码，从而导致远程代码执行。

**POC代码分析：**

提供的POC代码 (`Exploit-poc.py`) 旨在自动化利用此漏洞的过程。它执行以下操作：

1.  **上传Payload:** 使用`PUT`请求将包含恶意代码的JSP文件（`rce.jsp`）上传到目标服务器。
2.  **触发Payload:** 使用`GET`请求访问上传的JSP文件，触发服务器执行JSP中的恶意代码。

该脚本允许指定单个目标URL或包含目标URL列表的文件，并使用多线程来加速漏洞利用过程。

**有效性：**

根据漏洞信息和搜索结果，POC代码是有效的，可以利用该漏洞在满足特定条件的目标系统上执行远程代码。

**投毒风险：**

虽然POC代码本身主要是为了验证和利用漏洞，但仍然存在一定的投毒风险。`JSP_PAYLOAD` 变量允许攻击者自定义执行的命令，如果攻击者上传的Payload包含恶意代码，可能会对目标系统造成损害。例如，Payload可以执行系统命令、修改文件或窃取敏感数据。
此外，脚本中 `if resp.status_code == 200 and "root" in resp.text.lower():` 判断是否存在漏洞利用成功，这里存在一定的概率作者可能存在恶意的判断，导致虽然命令执行成功，但无法正确显示出来，从而导致攻击者判断失误，后续进行恶意操作。

综合评估，该仓库中存在一定程度的投毒风险，风险概率约为10%。主要是考虑到代码作者可以通过构造Payload来影响目标系统，或通过不准确的判断结果来迷惑攻击者。

**项目地址:** [Yuri08loveElaina/CVE-2024-50379-POC](https://github.com/Yuri08loveElaina/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #5

**来源**: [CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379.md](../2024/CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379.md)

## CVE-2024-50379 - Apache Tomcat JSP 编译 TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** 9.0.0.M1 - 9.0.97, 10.1.0-M1 - 10.1.33, 11.0.0-M1 - 11.0.1

**利用条件:** 默认Servlet启用写入（非默认配置），大小写不敏感的文件系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU（Time-of-check Time-of-use）竞争条件漏洞，发生在 JSP 编译期间。如果满足以下条件，则可能导致远程代码执行：

1.  **默认 Servlet 启用写入：** Tomcat 的默认 Servlet 允许写入，这不是默认配置，需要手动开启。
2.  **大小写不敏感的文件系统：** 操作系统使用大小写不敏感的文件系统（例如 Windows）。

**漏洞利用方式：**

攻击者通过上传恶意 JSP 文件（例如 aa.Jsp 和 bb.Jsp）并利用并发请求触发 TOCTOU 漏洞。具体来说，攻击者会并发地发送 PUT 和 GET 请求到 Tomcat 服务器。PUT 请求用于上传包含恶意代码的 JSP 文件，GET 请求用于访问这些 JSP 文件。由于竞争条件，Tomcat 可能会在文件检查后、实际执行文件之前，将文件误判为安全，从而导致恶意代码被执行。

漏洞利用代码 `exploit.py` 模拟了这种攻击方式，它并发地向目标 URL 发送 PUT 和 GET 请求，尝试上传和执行包含反弹 shell 代码的 JSP 文件。代码中使用了多线程来增加竞争成功的概率。

**有效性：**

根据漏洞描述和搜索结果，POC代码在满足特定条件（默认 Servlet 启用写入，大小写不敏感的文件系统）下有效。它利用了并发请求来触发 TOCTOU 漏洞，从而允许远程代码执行。

**投毒风险：**

查看提供的代码，发现该代码的功能是尝试利用 CVE-2024-50379 漏洞进行远程代码执行。代码本身实现了并发上传和访问JSP文件，并通过反弹shell执行恶意代码。**该代码的目的是进行漏洞验证和利用，而不是植入恶意后门**。因此，认为该代码存在投毒风险的可能性极低，判定为0%。

搜索结果也表明该漏洞利用涉及竞争条件，需要并发执行 PUT 和 GET 请求才能成功利用。这与 POC 代码的实现方式相符。

**项目地址:** [Yuri08loveElaina/CVE-2024-50379](https://github.com/Yuri08loveElaina/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #6

**来源**: [CVE-2024-50379-carefreegarb_CVE-2024-50379.md](../2024/CVE-2024-50379-carefreegarb_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可以导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 1. 目标系统为大小写不敏感的文件系统。
2. Tomcat的default servlet的readonly参数设置为false（非默认配置，允许写入）。
3. 存在网络访问Tomcat服务器的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是Apache Tomcat中的一个Time-of-Check Time-of-Use (TOCTOU)竞争条件漏洞。当满足以下条件时，攻击者可以利用此漏洞在服务器上执行任意代码：

*   **环境要求:** 目标系统使用大小写不敏感的文件系统，并且default servlet的`readonly`参数设置为`false`。
*   **漏洞原理:** 在JSP编译期间，Tomcat存在一个竞争条件。攻击者可以在Tomcat检查文件是否存在和可写之后，但在实际编译之前，替换JSP文件。通过精心构造JSP文件，攻击者可以上传恶意代码，并在服务器上执行。
*   **利用方式:**  提供的POC代码是一个Go程序，它利用多线程并发上传恶意JSP文件，从而触发竞争条件。该POC接受目标URL、包含恶意代码的JSP文件路径以及目标服务器上保存的文件名/路径作为参数。
*   **有效性:** 根据搜索结果和POC代码，该漏洞利用是有效的，可以实现远程代码执行。
*   **投毒风险评估:** 提供的代码中存在一定的投毒风险。虽然主要功能是实现漏洞利用，但作者可能在代码中添加一些不明显的后门或者恶意行为。代码中包含`replace github.com/valyala/fasthttp v1.58.0 => ./fasthttp`。使用本地修改过的 `fasthttp` 库存在潜在风险，恶意作者可能在修改后的库中植入后门。因此，对于此类来源不明的代码，需要进行代码审计，才能确保其安全性。综合考虑，存在10%的投毒风险。

**项目地址:** [carefreegarb/CVE-2024-50379](https://github.com/carefreegarb/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #7

**来源**: [CVE-2024-50379-dear-cell_CVE-2024-50379.md](../2024/CVE-2024-50379-dear-cell_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认servlet配置为可写(非默认配置)，文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 servlet 配置为可写（非默认配置）且文件系统大小写不敏感时，攻击者可以通过竞争条件在JSP编译期间执行任意代码，导致远程代码执行（RCE）。

**漏洞利用方式：**

1.  **竞争条件：** 利用JSP编译过程中的TOCTOU漏洞，通过并发请求修改正在编译的文件。
2.  **PUT请求：** POC代码使用PUT方法尝试上传JSP文件到目标URL（/asd.Jsp 和 /qwe.Jsp）。
3.  **GET请求：** POC代码也使用GET请求访问JSP文件。
4.  **1.jsp和2.jsp:** POC利用了 /1.jsp 和 /2.jsp 文件，其中2.jsp 似乎动态生成jsp马，写入到/1.jsp.
5.  **并发执行：** 使用线程池并发执行PUT和GET请求，增加竞争成功的概率。
6.  **Payload：**  `upload.txt` 文件包含JSP payload，用于写入恶意代码。

**有效性评估：**

根据漏洞描述，搜索引擎结果和POC代码，该漏洞利用是有效的。POC代码尝试利用竞争条件上传包含恶意代码的JSP文件。

**投毒风险评估：**

POC代码本身的主要目的是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **恶意Payload：**`upload.txt` 文件中的payload可能包含恶意代码，如果使用者不检查该文件内容直接运行POC，可能会在目标系统上植入后门。
2.  **隐藏逻辑：** 脚本中可能存在隐蔽的后门代码, 虽然代码主要逻辑围绕竞争和JSP上传, 但不能完全排除作者添加额外恶意行为的可能性, 虽然可能性较低。
3.  **依赖风险：**虽然代码本身没有直接的外部依赖，如果`upload.txt`来自于外部，那风险就变得不可控。
总体来说，投毒风险较低，大约5%，但需要仔细审查`upload.txt`的内容，确保其安全性。

**建议：**
* 升级到Tomcat 11.0.2, 10.1.34 或 9.0.98。
* 禁用默认servlet的写入权限。
* 仔细审查并测试POC代码，确保理解其行为，避免未知的风险。

**项目地址:** [dear-cell/CVE-2024-50379](https://github.com/dear-cell/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #8

**来源**: [CVE-2024-50379-dkstar11q_CVE-2024-50379-nuclei.md](../2024/CVE-2024-50379-dkstar11q_CVE-2024-50379-nuclei.md)

## CVE-2024-50379-ApacheTomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 Servlet 启用写入且文件系统不区分大小写时，在 JSP 编译期间可能导致远程代码执行。

**漏洞利用方式：**
1.  攻击者利用PUT方法上传一个JSP文件到一个可写目录。
2.  由于TOCTOU漏洞，在Tomcat检查文件类型和实际编译文件之间存在时间差，攻击者可以利用竞争条件，上传恶意JSP文件绕过检查。
3.  上传的JSP文件会被当做可执行文件执行，从而导致远程代码执行。

**POC有效性：**
提供的`poc.py`脚本通过多线程并发上传包含恶意代码的JSP文件，利用竞争条件触发漏洞。该脚本首先检查目标是否允许PUT请求，然后通过PUT上传一个payload，该payload用于将webshell写入指定路径，最后GET请求访问该webshell，如果返回200则验证成功

**投毒风险评估：**
该仓库中是否存在投毒代码的可能性较低。`poc.py`的主要功能是利用漏洞上传和执行webshell。虽然webshell本身具有潜在的风险，但它属于漏洞利用的范畴，并不构成“投毒”。脚本的功能相对明确，没有发现隐藏的恶意行为。考虑到脚本的开源性质以及其目标是漏洞利用，作者隐藏恶意代码的可能性较低，但不能完全排除，因此评估的投毒风险为1%。

**项目地址:** [dkstar11q/CVE-2024-50379-nuclei](https://github.com/dkstar11q/CVE-2024-50379-nuclei)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #9

**来源**: [CVE-2024-50379-dragonked2_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-dragonked2_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个时间检查/时间使用 (TOCTOU) 竞争条件漏洞。该漏洞出现在 JSP 编译期间，当默认 servlet 启用了写入（非默认配置）且文件系统大小写不敏感时，允许远程代码执行 (RCE)。攻击者可以利用此漏洞上传一个文件，并通过竞争条件使其被 Tomcat 作为 JSP 文件执行，从而导致任意代码执行。提供的代码段是 Apache 2.0 许可协议，并非漏洞利用代码本身，因此无法直接验证 POC 的有效性。但根据搜索结果，存在公开的POC，可以利用。由于提供的代码只是许可协议，不包含恶意代码，因此投毒风险为0%。利用方式如下：

1.  **上传恶意文件：** 攻击者上传一个恶意文件，该文件伪装成 JSP 文件，但实际上包含恶意代码。
2.  **竞争条件：** 攻击者利用 TOCTOU 漏洞，在 Tomcat 检查文件类型和实际编译文件之间制造时间差。
3.  **绕过检查：** 在检查通过后，攻击者通过某种方式修改文件内容，使其成为真正的 JSP 文件，并包含恶意代码。
4.  **远程代码执行：** Tomcat 编译并执行该 JSP 文件，从而导致远程代码执行。

**项目地址:** [dragonked2/CVE-2024-50379-POC](https://github.com/dragonked2/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #10

**来源**: [CVE-2024-50379-gomtaengi_CVE-2024-50379-exp.md](../2024/CVE-2024-50379-gomtaengi_CVE-2024-50379-exp.md)

## CVE-2024-50379 - Apache Tomcat TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 9.0.0.M1 - 9.0.97, 10.1.0-M1 - 10.1.33, 11.0.0-M1 - 11.0.1

**利用条件:** 默认 servlet 启用写入 (非默认配置)且运行在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是 Apache Tomcat 中 JSP 编译期间发生的 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 servlet 启用写入时，攻击者可以通过上传包含恶意 JSP 代码的文件并利用竞争条件来触发 Tomcat 解析和执行它，从而实现远程代码执行。

**利用方式：**

1.  **上传恶意 JSP 文件：** 攻击者首先上传一个名为 `test01_{random_suffix}.txt` 的文件，其中包含JSP Footer代码，该代码的功能是接收通过请求头传递的base64编码的payload，然后通过AES解密后加载到内存中执行。
2.  **利用竞争条件：** 攻击者利用竞争条件，尝试在 Tomcat 将上传的 `.txt` 文件识别为普通文本文件之前，将其重命名为 `.jsp` 文件。这需要同时发送大量的请求。
3.  **JSP 编译和执行：** 如果竞争成功，Tomcat 将尝试编译并执行该 `.jsp` 文件，从而允许攻击者执行任意代码。

**POC代码分析：**

提供的 Python POC 脚本旨在自动化利用此漏洞。脚本执行以下步骤：

1.  **生成随机字符串和哈希：** 生成随机后缀和 MD5 哈希值，用于生成唯一的临时文件名和最终的 JSP 文件名。
2.  **生成 JSP 内容：** 生成包含将源文件复制到目标文件的 JSP 代码。
3.  **发送 PUT 请求：** 使用生成的随机文件名将恶意 JSP 内容上传到服务器。 通过PUT上传t1{random_suffix}.Txt和t2{random_suffix}.Txt为JSP Footer内容，t1{random_suffix}.Jsp和t2{random_suffix}.Jsp为JSP Header内容。
4.  **发送 GET 请求：** 发送GET请求, 检查目标JSP是否存在.
5.  **多线程并发：** 使用多线程并发来增加竞争条件成功的可能性。
6.  **停止机制:**  一旦发现漏洞则停止扫描.

**投毒风险分析：**

代码中存在一定的投毒风险，主要集中在以下几个方面：

1.  **JSP Footer 的自定义内容：** 脚本允许用户通过 `-f` 或 `--footer` 参数指定自定义的 JSP footer 内容。 如果攻击者指定了恶意的 JSP 代码，则可能导致被攻击的服务器受到进一步的损害。 但这是参数问题，不是代码本身的问题。
2.  **Payload 执行：** JSP Footer 中的恶意代码功能是通过请求头传递加密的payload，并将其加载到内存中执行。攻击者可以通过控制请求头来执行任意代码。尽管这本身就是漏洞利用的一部分，但如果攻击者能够注入额外的恶意代码，则可能导致更严重的后果。

**总结：**

该漏洞利用的有效性较高，但也依赖于特定的配置（默认 servlet 启用写入）和文件系统类型（大小写不敏感）。POC 代码可以有效利用此漏洞，但存在一定的投毒风险，用户需要谨慎使用，尤其是在指定自定义 JSP 内容时。Payload的加载和执行是漏洞利用的关键步骤。

**项目地址:** [gomtaengi/CVE-2024-50379-exp](https://github.com/gomtaengi/CVE-2024-50379-exp)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #11

**来源**: [CVE-2024-50379-iSee857_CVE-2024-50379-PoC.md](../2024/CVE-2024-50379-iSee857_CVE-2024-50379-PoC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入(非默认配置)，文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379是Apache Tomcat中的一个Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认Servlet启用写入且文件系统不区分大小写时，攻击者可以通过竞争条件在JSP编译期间执行远程代码。

**漏洞利用方式：**

1.  攻击者发送PUT请求上传一个名为`aa.Jsp`的文件，包含恶意JSP代码，例如`aa<% Runtime.getRuntime().exec("calc.exe");%>`。同时上传`bb.Jsp`类似的文件。
2.  利用TOCTOU漏洞：在Tomcat检查文件类型之后，但在编译之前，攻击者通过竞争条件修改文件内容，从而绕过安全检查。
3.  Tomcat将上传的文件编译为JSP，执行其中的恶意代码，导致远程代码执行。
4.  POC代码通过多线程并发PUT和GET请求，尝试触发竞争条件，利用漏洞。

**有效性：**

提供的POC代码利用了多线程并发请求，旨在触发TOCTOU竞争条件，经验证是有效的。搜索引擎结果也表明该漏洞可被利用，并提供了相关的PoC。

**投毒风险：**

该仓库中的POC代码的主要功能是利用CVE-2024-50379漏洞进行远程代码执行的验证。  payload使用了calc.exe, 并没有发现明显的恶意行为，例如反弹shell或植入持久性后门。代码存在极小概率的投毒风险（例如，在非常隐蔽的地方插入恶意代码，或者利用竞争条件引入不可预测的行为），但这种可能性很低。基于对整个代码的审查，判断投毒风险约为1%。代码中只是用于验证漏洞的后门代码，不属于投毒代码。


**项目地址:** [iSee857/CVE-2024-50379-PoC](https://github.com/iSee857/CVE-2024-50379-PoC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #12

**来源**: [CVE-2024-50379-lizhianyuguangming_CVE-2024-50379-exp.md](../2024/CVE-2024-50379-lizhianyuguangming_CVE-2024-50379-exp.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU 竞态条件导致远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false（非默认配置），运行在大小写不敏感的文件系统上，网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU (Time-of-Check Time-of-Use) 竞态条件漏洞，发生在 JSP 编译期间。当 Tomcat 运行在大小写不敏感的文件系统上，并且默认 Servlet 的 `readonly` 参数设置为 `false` （这**不是默认配置**），攻击者可以通过竞态条件竞争，上传一个文件，并在 Tomcat 检查其类型之前，将其替换为恶意的 JSP 文件，从而导致远程代码执行。

**漏洞利用方式：**

1.  **先决条件：** 目标 Tomcat 实例必须配置为允许写入（`readonly=false`）。目标服务器的文件系统需要不区分大小写，如 Windows 服务器。
2.  **上传文件：** 攻击者上传一个文件，比如 `t1<random_suffix>.txt` 和 `t2<random_suffix>.txt`，包含部分 JSP 代码，为恶意JSP文件的前半部分和后半部分，用于后续组合。
3.  **竞争条件：** 攻击者发送并发请求，尝试利用 TOCTOU 漏洞。这些请求尝试在 Tomcat 检查文件类型之前，修改上传的文件。
4.  **替换文件：**  利用竞态条件，在 Tomcat 检查文件类型之后，但在实际编译之前，恶意 JSP 代码被写入到上传的文件中。
5.  **JSP 编译：** Tomcat 编译并执行恶意 JSP 代码，从而导致 RCE。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于自动化利用此漏洞。主要步骤如下：

1.  **加载目标 URL：** 从 `url.txt` 文件中读取目标 Tomcat 服务器的 URL 列表。
2.  **生成随机字符串和 MD5 哈希：** 用于生成临时文件名和进行一些操作。
3.  **生成 JSP 代码：**生成用于将文件重命名并执行的JSP Header和JSP Footer,其中JSP Footer包含冰蝎payload。
4.  **发送 GET 请求：**  向目标服务器发送 GET 请求，触发漏洞利用。构造特定的 URL，访问恶意文件，触发 JSP 编译，执行恶意代码。
5.  **并发执行：** 使用线程池并发发送请求，以增加利用成功的概率。

**投毒风险分析：**

该脚本的主要目的是利用 CVE-2024-50379 漏洞，实现远程代码执行。 但是，在 `generate_jsp_footer` 函数中，默认情况下包含一个冰蝎 payload。如果使用者不了解这段代码的作用，可能会在不知情的情况下植入后门。

-   **投毒代码：** `generate_jsp_footer` 函数中默认包含冰蝎 payload。
-   **风险评估：** 冰蝎是一个流行的 webshell 工具，攻击者可以使用它来远程管理服务器，执行任意命令，上传和下载文件等。

因此，该脚本存在一定的投毒风险，使用者需要仔细检查代码，确保自己了解每一部分代码的作用。特别是 `generate_jsp_footer` 函数，使用者可以自定义 `custom_content` 参数，替换默认的冰蝎 payload。

**投毒风险比例：** 10%（主要风险在于使用者不了解默认 payload 的作用，在不知情的情况下使用）。


**项目地址:** [lizhianyuguangming/CVE-2024-50379-exp](https://github.com/lizhianyuguangming/CVE-2024-50379-exp)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #13

**来源**: [CVE-2024-50379-ph0ebus_Tomcat-CVE-2024-50379-Poc.md](../2024/CVE-2024-50379-ph0ebus_Tomcat-CVE-2024-50379-Poc.md)

# CVE-2024-50379

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-50379-Alchemist3dot14_CVE-2024-50379.md](../2024/CVE-2024-50379-Alchemist3dot14_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1
10.1.0-M1 <= version <= 10.1.33
9.0.0.M1 <= version <= 9.0.97

**利用条件:** 1. 存在大小写不敏感的文件系统。
2. 默认Servlet开启写入功能(非默认配置)。
3. 目标服务器存在/uploads目录且可写。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中 JSP 编译期间的 Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认 servlet 启用写入（非默认配置）且文件系统不区分大小写时，攻击者可以利用此漏洞实现远程代码执行。该 PoC 代码通过上传包含恶意代码的 JSP shell 到可写目录（如/uploads）并利用该 shell 执行任意系统命令来演示漏洞利用过程。需要注意的是,PoC代码中定义了BASE_URL、UPLOAD_ENDPOINT、SHELL_NAME和SHELL_CONTENT等变量，如果攻击者修改了SHELL_CONTENT内容添加了恶意程序，可能会对目标系统造成其他安全威胁。尽管 PoC 本身是为了演示漏洞，但确实存在被滥用进行恶意攻击的风险。该PoC的投毒风险主要来自修改后的JSP shell, 例如执行反弹shell或下载执行其他恶意程序。代码中虽然没有明显的恶意投毒代码，但是存在一定风险，例如JSP shell执行命令时的注入，或对服务器的其他操作等，所以投毒风险评为10%。

**项目地址:** [Alchemist3dot14/CVE-2024-50379](https://github.com/Alchemist3dot14/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #2

**来源**: [CVE-2024-50379-JFOZ1010_Nuclei-Template-CVE-2024-50379.md](../2024/CVE-2024-50379-JFOZ1010_Nuclei-Template-CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition 导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false，且文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是一个Apache Tomcat中的TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞。当Tomcat的默认Servlet的`readonly`参数设置为`false`时（非默认配置），攻击者可以通过上传一个JSP文件，并在Tomcat编译该JSP文件时，通过竞争条件替换该文件为恶意JSP文件，从而实现远程代码执行。

**漏洞利用方式：**

1.  **条件满足：**  确保目标Tomcat实例的默认Servlet的`readonly`参数已设置为`false`。这意味着允许通过默认Servlet上传文件。
2.  **上传JSP文件：**  首先上传一个良性的JSP文件，例如`hello.jsp`，其中包含一些基本代码，比如打印"Hello, World!"。
3.  **竞争条件：**  在Tomcat编译`hello.jsp`文件时，攻击者迅速上传一个恶意的JSP文件，比如`HELLO.JSP`（注意大小写差异，利用文件系统大小写不敏感的特性），其中包含执行任意命令的代码（例如，启动计算器）。
4.  **远程代码执行：**  如果竞争成功，Tomcat会编译并执行恶意的`HELLO.JSP`文件，从而导致远程代码执行。

**POC分析：**

提供的Nuclei模板`CVE-2024-50379.yaml` 旨在自动化此漏洞的检测。它通过以下步骤工作：

1.  上传一个包含 "Hello, World!" 的良性JSP文件 (`hello.jsp`) 到 `/upload.jsp` 。
2.  快速上传一个包含恶意代码的JSP文件 (`HELLO.JSP`) 到 `/uploads/upload.jsp` 。这个恶意JSP包含执行计算器的代码片段 `Runtime.getRuntime().exec("calc.exe");`。
3.  尝试访问上传的文件 (`/uploads/hello.jsp`) ，并检查响应是否包含预期的输出或错误信息。

**投毒风险分析：**

虽然提供的POC代码本身旨在利用漏洞，而非植入后门，但仍然存在一些潜在的投毒风险：

*   **文件名大小写混淆:**  利用了大小写不敏感的文件系统, 可能存在编码问题或文件系统差异导致POC失效, 但不属于后门或投毒代码
*   **自定义恶意JSP：**  用户在使用POC时，可能会修改恶意JSP文件中的代码，以执行其他恶意操作，例如上传webshell或执行更隐蔽的命令。这取决于用户自身行为，不属于POC作者投毒。
*   **依赖外部资源：**  虽然当前的POC没有直接依赖外部资源，但如果用户修改POC并添加对外部资源的依赖（例如，下载恶意脚本），则可能引入投毒风险。
*   **README.md中的免责声明：** README明确说明了使用该模板的伦理责任，并强调只能在授权环境下使用。这在一定程度上降低了作者恶意使用的可能性。

综合考虑，尽管存在一些潜在的风险，但该仓库中直接包含作者有意植入的投毒代码的可能性较低。投毒风险主要来自于用户对POC的修改和使用方式。 因此，我给出的投毒风险概率是10%。

**项目地址:** [JFOZ1010/Nuclei-Template-CVE-2024-50379](https://github.com/JFOZ1010/Nuclei-Template-CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #3

**来源**: [CVE-2024-50379-SleepingBag945_CVE-2024-50379.md](../2024/CVE-2024-50379-SleepingBag945_CVE-2024-50379.md)

## CVE-2024-50379 - Apache Tomcat TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 竞争条件导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可远程执行任意代码

**影响版本:** 9.0.0.M1 <= version <= 9.0.97, 10.1.0-M1 <= version <= 10.1.33, 11.0.0-M1 <= version <= 11.0.1

**利用条件:** 1. Apache Tomcat 存在漏洞版本;2. 运行在大小写不敏感的文件系统上; 3. 默认 Servlet 启用了写入功能 (非默认配置)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞，存在于 JSP 编译过程中。当 Tomcat 运行在大小写不敏感的文件系统上，且默认 Servlet 启用写入功能时（这是一个非默认配置），攻击者可以通过竞争条件绕过安全检查，上传恶意 JSP 文件并执行，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  攻击者利用竞争条件，在 Tomcat 检查文件类型之后、编译之前，修改已上传文件的内容。
2.  由于 Tomcat 存在 TOCTOU 漏洞，因此可以绕过安全检查，导致恶意 JSP 代码被执行。
3.  漏洞利用代码（PoC）`main.go`是一个Go程序，它通过并发发送请求来触发竞争条件，上传一个包含恶意代码的JSP文件。它使用`fasthttp`库发送HTTP请求，利用`ants/v2`库管理并发连接池。

**投毒风险分析：**

代码整体结构较为清晰，主要功能是利用漏洞，并未发现明显的恶意代码。可能的投毒风险在于作者使用的第三方库是否安全，或者作者是否在不显眼的地方添加了恶意代码。风险评估：

*   **第三方库风险：** 代码依赖`github.com/valyala/fasthttp`和`github.com/panjf2000/ants/v2`两个库。需要检查这些库是否存在已知的安全问题。作者替换了`fasthttp`库，需要仔细检查替换的`fasthttp`代码是否存在恶意代码。
*   **代码逻辑风险：** 代码逻辑相对简单，主要就是发送请求，没有发现明显的植入后门的地方。

因此，综合来看，投毒的可能性较低，风险值设定为10%。主要风险还是在于对作者修改过的`fasthttp`库的审核，需要人工进行安全审计。

**项目地址:** [SleepingBag945/CVE-2024-50379](https://github.com/SleepingBag945/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #4

**来源**: [CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 需要目标系统为大小写不敏感的文件系统，且default servlet的write权限开启（非默认配置）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞。此漏洞出现在 JSP 编译过程中，允许在大小写不敏感的文件系统上进行远程代码执行（RCE），前提是默认 servlet 启用了写入权限（非默认配置）。

**漏洞利用方式：**

1.  攻击者上传一个包含恶意 JSP 代码的文件，该文件旨在执行任意命令。
2.  由于 TOCTOU 漏洞，Tomcat 在检查文件和实际编译文件之间存在时间差。
3.  攻击者利用这个时间差，通过竞争条件来修改或替换上传的文件内容。
4.  如果攻击成功，Tomcat 将编译并执行恶意 JSP 代码，从而导致远程代码执行。

**POC代码分析：**

提供的POC代码 (`Exploit-poc.py`) 旨在自动化利用此漏洞的过程。它执行以下操作：

1.  **上传Payload:** 使用`PUT`请求将包含恶意代码的JSP文件（`rce.jsp`）上传到目标服务器。
2.  **触发Payload:** 使用`GET`请求访问上传的JSP文件，触发服务器执行JSP中的恶意代码。

该脚本允许指定单个目标URL或包含目标URL列表的文件，并使用多线程来加速漏洞利用过程。

**有效性：**

根据漏洞信息和搜索结果，POC代码是有效的，可以利用该漏洞在满足特定条件的目标系统上执行远程代码。

**投毒风险：**

虽然POC代码本身主要是为了验证和利用漏洞，但仍然存在一定的投毒风险。`JSP_PAYLOAD` 变量允许攻击者自定义执行的命令，如果攻击者上传的Payload包含恶意代码，可能会对目标系统造成损害。例如，Payload可以执行系统命令、修改文件或窃取敏感数据。
此外，脚本中 `if resp.status_code == 200 and "root" in resp.text.lower():` 判断是否存在漏洞利用成功，这里存在一定的概率作者可能存在恶意的判断，导致虽然命令执行成功，但无法正确显示出来，从而导致攻击者判断失误，后续进行恶意操作。

综合评估，该仓库中存在一定程度的投毒风险，风险概率约为10%。主要是考虑到代码作者可以通过构造Payload来影响目标系统，或通过不准确的判断结果来迷惑攻击者。

**项目地址:** [Yuri08loveElaina/CVE-2024-50379-POC](https://github.com/Yuri08loveElaina/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #5

**来源**: [CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379.md](../2024/CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379.md)

## CVE-2024-50379 - Apache Tomcat JSP 编译 TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** 9.0.0.M1 - 9.0.97, 10.1.0-M1 - 10.1.33, 11.0.0-M1 - 11.0.1

**利用条件:** 默认Servlet启用写入（非默认配置），大小写不敏感的文件系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU（Time-of-check Time-of-use）竞争条件漏洞，发生在 JSP 编译期间。如果满足以下条件，则可能导致远程代码执行：

1.  **默认 Servlet 启用写入：** Tomcat 的默认 Servlet 允许写入，这不是默认配置，需要手动开启。
2.  **大小写不敏感的文件系统：** 操作系统使用大小写不敏感的文件系统（例如 Windows）。

**漏洞利用方式：**

攻击者通过上传恶意 JSP 文件（例如 aa.Jsp 和 bb.Jsp）并利用并发请求触发 TOCTOU 漏洞。具体来说，攻击者会并发地发送 PUT 和 GET 请求到 Tomcat 服务器。PUT 请求用于上传包含恶意代码的 JSP 文件，GET 请求用于访问这些 JSP 文件。由于竞争条件，Tomcat 可能会在文件检查后、实际执行文件之前，将文件误判为安全，从而导致恶意代码被执行。

漏洞利用代码 `exploit.py` 模拟了这种攻击方式，它并发地向目标 URL 发送 PUT 和 GET 请求，尝试上传和执行包含反弹 shell 代码的 JSP 文件。代码中使用了多线程来增加竞争成功的概率。

**有效性：**

根据漏洞描述和搜索结果，POC代码在满足特定条件（默认 Servlet 启用写入，大小写不敏感的文件系统）下有效。它利用了并发请求来触发 TOCTOU 漏洞，从而允许远程代码执行。

**投毒风险：**

查看提供的代码，发现该代码的功能是尝试利用 CVE-2024-50379 漏洞进行远程代码执行。代码本身实现了并发上传和访问JSP文件，并通过反弹shell执行恶意代码。**该代码的目的是进行漏洞验证和利用，而不是植入恶意后门**。因此，认为该代码存在投毒风险的可能性极低，判定为0%。

搜索结果也表明该漏洞利用涉及竞争条件，需要并发执行 PUT 和 GET 请求才能成功利用。这与 POC 代码的实现方式相符。

**项目地址:** [Yuri08loveElaina/CVE-2024-50379](https://github.com/Yuri08loveElaina/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #6

**来源**: [CVE-2024-50379-carefreegarb_CVE-2024-50379.md](../2024/CVE-2024-50379-carefreegarb_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可以导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 1. 目标系统为大小写不敏感的文件系统。
2. Tomcat的default servlet的readonly参数设置为false（非默认配置，允许写入）。
3. 存在网络访问Tomcat服务器的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是Apache Tomcat中的一个Time-of-Check Time-of-Use (TOCTOU)竞争条件漏洞。当满足以下条件时，攻击者可以利用此漏洞在服务器上执行任意代码：

*   **环境要求:** 目标系统使用大小写不敏感的文件系统，并且default servlet的`readonly`参数设置为`false`。
*   **漏洞原理:** 在JSP编译期间，Tomcat存在一个竞争条件。攻击者可以在Tomcat检查文件是否存在和可写之后，但在实际编译之前，替换JSP文件。通过精心构造JSP文件，攻击者可以上传恶意代码，并在服务器上执行。
*   **利用方式:**  提供的POC代码是一个Go程序，它利用多线程并发上传恶意JSP文件，从而触发竞争条件。该POC接受目标URL、包含恶意代码的JSP文件路径以及目标服务器上保存的文件名/路径作为参数。
*   **有效性:** 根据搜索结果和POC代码，该漏洞利用是有效的，可以实现远程代码执行。
*   **投毒风险评估:** 提供的代码中存在一定的投毒风险。虽然主要功能是实现漏洞利用，但作者可能在代码中添加一些不明显的后门或者恶意行为。代码中包含`replace github.com/valyala/fasthttp v1.58.0 => ./fasthttp`。使用本地修改过的 `fasthttp` 库存在潜在风险，恶意作者可能在修改后的库中植入后门。因此，对于此类来源不明的代码，需要进行代码审计，才能确保其安全性。综合考虑，存在10%的投毒风险。

**项目地址:** [carefreegarb/CVE-2024-50379](https://github.com/carefreegarb/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #7

**来源**: [CVE-2024-50379-dear-cell_CVE-2024-50379.md](../2024/CVE-2024-50379-dear-cell_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认servlet配置为可写(非默认配置)，文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 servlet 配置为可写（非默认配置）且文件系统大小写不敏感时，攻击者可以通过竞争条件在JSP编译期间执行任意代码，导致远程代码执行（RCE）。

**漏洞利用方式：**

1.  **竞争条件：** 利用JSP编译过程中的TOCTOU漏洞，通过并发请求修改正在编译的文件。
2.  **PUT请求：** POC代码使用PUT方法尝试上传JSP文件到目标URL（/asd.Jsp 和 /qwe.Jsp）。
3.  **GET请求：** POC代码也使用GET请求访问JSP文件。
4.  **1.jsp和2.jsp:** POC利用了 /1.jsp 和 /2.jsp 文件，其中2.jsp 似乎动态生成jsp马，写入到/1.jsp.
5.  **并发执行：** 使用线程池并发执行PUT和GET请求，增加竞争成功的概率。
6.  **Payload：**  `upload.txt` 文件包含JSP payload，用于写入恶意代码。

**有效性评估：**

根据漏洞描述，搜索引擎结果和POC代码，该漏洞利用是有效的。POC代码尝试利用竞争条件上传包含恶意代码的JSP文件。

**投毒风险评估：**

POC代码本身的主要目的是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **恶意Payload：**`upload.txt` 文件中的payload可能包含恶意代码，如果使用者不检查该文件内容直接运行POC，可能会在目标系统上植入后门。
2.  **隐藏逻辑：** 脚本中可能存在隐蔽的后门代码, 虽然代码主要逻辑围绕竞争和JSP上传, 但不能完全排除作者添加额外恶意行为的可能性, 虽然可能性较低。
3.  **依赖风险：**虽然代码本身没有直接的外部依赖，如果`upload.txt`来自于外部，那风险就变得不可控。
总体来说，投毒风险较低，大约5%，但需要仔细审查`upload.txt`的内容，确保其安全性。

**建议：**
* 升级到Tomcat 11.0.2, 10.1.34 或 9.0.98。
* 禁用默认servlet的写入权限。
* 仔细审查并测试POC代码，确保理解其行为，避免未知的风险。

**项目地址:** [dear-cell/CVE-2024-50379](https://github.com/dear-cell/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #8

**来源**: [CVE-2024-50379-dkstar11q_CVE-2024-50379-nuclei.md](../2024/CVE-2024-50379-dkstar11q_CVE-2024-50379-nuclei.md)

## CVE-2024-50379-ApacheTomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 Servlet 启用写入且文件系统不区分大小写时，在 JSP 编译期间可能导致远程代码执行。

**漏洞利用方式：**
1.  攻击者利用PUT方法上传一个JSP文件到一个可写目录。
2.  由于TOCTOU漏洞，在Tomcat检查文件类型和实际编译文件之间存在时间差，攻击者可以利用竞争条件，上传恶意JSP文件绕过检查。
3.  上传的JSP文件会被当做可执行文件执行，从而导致远程代码执行。

**POC有效性：**
提供的`poc.py`脚本通过多线程并发上传包含恶意代码的JSP文件，利用竞争条件触发漏洞。该脚本首先检查目标是否允许PUT请求，然后通过PUT上传一个payload，该payload用于将webshell写入指定路径，最后GET请求访问该webshell，如果返回200则验证成功

**投毒风险评估：**
该仓库中是否存在投毒代码的可能性较低。`poc.py`的主要功能是利用漏洞上传和执行webshell。虽然webshell本身具有潜在的风险，但它属于漏洞利用的范畴，并不构成“投毒”。脚本的功能相对明确，没有发现隐藏的恶意行为。考虑到脚本的开源性质以及其目标是漏洞利用，作者隐藏恶意代码的可能性较低，但不能完全排除，因此评估的投毒风险为1%。

**项目地址:** [dkstar11q/CVE-2024-50379-nuclei](https://github.com/dkstar11q/CVE-2024-50379-nuclei)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #9

**来源**: [CVE-2024-50379-dragonked2_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-dragonked2_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个时间检查/时间使用 (TOCTOU) 竞争条件漏洞。该漏洞出现在 JSP 编译期间，当默认 servlet 启用了写入（非默认配置）且文件系统大小写不敏感时，允许远程代码执行 (RCE)。攻击者可以利用此漏洞上传一个文件，并通过竞争条件使其被 Tomcat 作为 JSP 文件执行，从而导致任意代码执行。提供的代码段是 Apache 2.0 许可协议，并非漏洞利用代码本身，因此无法直接验证 POC 的有效性。但根据搜索结果，存在公开的POC，可以利用。由于提供的代码只是许可协议，不包含恶意代码，因此投毒风险为0%。利用方式如下：

1.  **上传恶意文件：** 攻击者上传一个恶意文件，该文件伪装成 JSP 文件，但实际上包含恶意代码。
2.  **竞争条件：** 攻击者利用 TOCTOU 漏洞，在 Tomcat 检查文件类型和实际编译文件之间制造时间差。
3.  **绕过检查：** 在检查通过后，攻击者通过某种方式修改文件内容，使其成为真正的 JSP 文件，并包含恶意代码。
4.  **远程代码执行：** Tomcat 编译并执行该 JSP 文件，从而导致远程代码执行。

**项目地址:** [dragonked2/CVE-2024-50379-POC](https://github.com/dragonked2/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #10

**来源**: [CVE-2024-50379-gomtaengi_CVE-2024-50379-exp.md](../2024/CVE-2024-50379-gomtaengi_CVE-2024-50379-exp.md)

## CVE-2024-50379 - Apache Tomcat TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 9.0.0.M1 - 9.0.97, 10.1.0-M1 - 10.1.33, 11.0.0-M1 - 11.0.1

**利用条件:** 默认 servlet 启用写入 (非默认配置)且运行在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是 Apache Tomcat 中 JSP 编译期间发生的 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 servlet 启用写入时，攻击者可以通过上传包含恶意 JSP 代码的文件并利用竞争条件来触发 Tomcat 解析和执行它，从而实现远程代码执行。

**利用方式：**

1.  **上传恶意 JSP 文件：** 攻击者首先上传一个名为 `test01_{random_suffix}.txt` 的文件，其中包含JSP Footer代码，该代码的功能是接收通过请求头传递的base64编码的payload，然后通过AES解密后加载到内存中执行。
2.  **利用竞争条件：** 攻击者利用竞争条件，尝试在 Tomcat 将上传的 `.txt` 文件识别为普通文本文件之前，将其重命名为 `.jsp` 文件。这需要同时发送大量的请求。
3.  **JSP 编译和执行：** 如果竞争成功，Tomcat 将尝试编译并执行该 `.jsp` 文件，从而允许攻击者执行任意代码。

**POC代码分析：**

提供的 Python POC 脚本旨在自动化利用此漏洞。脚本执行以下步骤：

1.  **生成随机字符串和哈希：** 生成随机后缀和 MD5 哈希值，用于生成唯一的临时文件名和最终的 JSP 文件名。
2.  **生成 JSP 内容：** 生成包含将源文件复制到目标文件的 JSP 代码。
3.  **发送 PUT 请求：** 使用生成的随机文件名将恶意 JSP 内容上传到服务器。 通过PUT上传t1{random_suffix}.Txt和t2{random_suffix}.Txt为JSP Footer内容，t1{random_suffix}.Jsp和t2{random_suffix}.Jsp为JSP Header内容。
4.  **发送 GET 请求：** 发送GET请求, 检查目标JSP是否存在.
5.  **多线程并发：** 使用多线程并发来增加竞争条件成功的可能性。
6.  **停止机制:**  一旦发现漏洞则停止扫描.

**投毒风险分析：**

代码中存在一定的投毒风险，主要集中在以下几个方面：

1.  **JSP Footer 的自定义内容：** 脚本允许用户通过 `-f` 或 `--footer` 参数指定自定义的 JSP footer 内容。 如果攻击者指定了恶意的 JSP 代码，则可能导致被攻击的服务器受到进一步的损害。 但这是参数问题，不是代码本身的问题。
2.  **Payload 执行：** JSP Footer 中的恶意代码功能是通过请求头传递加密的payload，并将其加载到内存中执行。攻击者可以通过控制请求头来执行任意代码。尽管这本身就是漏洞利用的一部分，但如果攻击者能够注入额外的恶意代码，则可能导致更严重的后果。

**总结：**

该漏洞利用的有效性较高，但也依赖于特定的配置（默认 servlet 启用写入）和文件系统类型（大小写不敏感）。POC 代码可以有效利用此漏洞，但存在一定的投毒风险，用户需要谨慎使用，尤其是在指定自定义 JSP 内容时。Payload的加载和执行是漏洞利用的关键步骤。

**项目地址:** [gomtaengi/CVE-2024-50379-exp](https://github.com/gomtaengi/CVE-2024-50379-exp)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #11

**来源**: [CVE-2024-50379-iSee857_CVE-2024-50379-PoC.md](../2024/CVE-2024-50379-iSee857_CVE-2024-50379-PoC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入(非默认配置)，文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379是Apache Tomcat中的一个Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认Servlet启用写入且文件系统不区分大小写时，攻击者可以通过竞争条件在JSP编译期间执行远程代码。

**漏洞利用方式：**

1.  攻击者发送PUT请求上传一个名为`aa.Jsp`的文件，包含恶意JSP代码，例如`aa<% Runtime.getRuntime().exec("calc.exe");%>`。同时上传`bb.Jsp`类似的文件。
2.  利用TOCTOU漏洞：在Tomcat检查文件类型之后，但在编译之前，攻击者通过竞争条件修改文件内容，从而绕过安全检查。
3.  Tomcat将上传的文件编译为JSP，执行其中的恶意代码，导致远程代码执行。
4.  POC代码通过多线程并发PUT和GET请求，尝试触发竞争条件，利用漏洞。

**有效性：**

提供的POC代码利用了多线程并发请求，旨在触发TOCTOU竞争条件，经验证是有效的。搜索引擎结果也表明该漏洞可被利用，并提供了相关的PoC。

**投毒风险：**

该仓库中的POC代码的主要功能是利用CVE-2024-50379漏洞进行远程代码执行的验证。  payload使用了calc.exe, 并没有发现明显的恶意行为，例如反弹shell或植入持久性后门。代码存在极小概率的投毒风险（例如，在非常隐蔽的地方插入恶意代码，或者利用竞争条件引入不可预测的行为），但这种可能性很低。基于对整个代码的审查，判断投毒风险约为1%。代码中只是用于验证漏洞的后门代码，不属于投毒代码。


**项目地址:** [iSee857/CVE-2024-50379-PoC](https://github.com/iSee857/CVE-2024-50379-PoC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #12

**来源**: [CVE-2024-50379-lizhianyuguangming_CVE-2024-50379-exp.md](../2024/CVE-2024-50379-lizhianyuguangming_CVE-2024-50379-exp.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU 竞态条件导致远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false（非默认配置），运行在大小写不敏感的文件系统上，网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU (Time-of-Check Time-of-Use) 竞态条件漏洞，发生在 JSP 编译期间。当 Tomcat 运行在大小写不敏感的文件系统上，并且默认 Servlet 的 `readonly` 参数设置为 `false` （这**不是默认配置**），攻击者可以通过竞态条件竞争，上传一个文件，并在 Tomcat 检查其类型之前，将其替换为恶意的 JSP 文件，从而导致远程代码执行。

**漏洞利用方式：**

1.  **先决条件：** 目标 Tomcat 实例必须配置为允许写入（`readonly=false`）。目标服务器的文件系统需要不区分大小写，如 Windows 服务器。
2.  **上传文件：** 攻击者上传一个文件，比如 `t1<random_suffix>.txt` 和 `t2<random_suffix>.txt`，包含部分 JSP 代码，为恶意JSP文件的前半部分和后半部分，用于后续组合。
3.  **竞争条件：** 攻击者发送并发请求，尝试利用 TOCTOU 漏洞。这些请求尝试在 Tomcat 检查文件类型之前，修改上传的文件。
4.  **替换文件：**  利用竞态条件，在 Tomcat 检查文件类型之后，但在实际编译之前，恶意 JSP 代码被写入到上传的文件中。
5.  **JSP 编译：** Tomcat 编译并执行恶意 JSP 代码，从而导致 RCE。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于自动化利用此漏洞。主要步骤如下：

1.  **加载目标 URL：** 从 `url.txt` 文件中读取目标 Tomcat 服务器的 URL 列表。
2.  **生成随机字符串和 MD5 哈希：** 用于生成临时文件名和进行一些操作。
3.  **生成 JSP 代码：**生成用于将文件重命名并执行的JSP Header和JSP Footer,其中JSP Footer包含冰蝎payload。
4.  **发送 GET 请求：**  向目标服务器发送 GET 请求，触发漏洞利用。构造特定的 URL，访问恶意文件，触发 JSP 编译，执行恶意代码。
5.  **并发执行：** 使用线程池并发发送请求，以增加利用成功的概率。

**投毒风险分析：**

该脚本的主要目的是利用 CVE-2024-50379 漏洞，实现远程代码执行。 但是，在 `generate_jsp_footer` 函数中，默认情况下包含一个冰蝎 payload。如果使用者不了解这段代码的作用，可能会在不知情的情况下植入后门。

-   **投毒代码：** `generate_jsp_footer` 函数中默认包含冰蝎 payload。
-   **风险评估：** 冰蝎是一个流行的 webshell 工具，攻击者可以使用它来远程管理服务器，执行任意命令，上传和下载文件等。

因此，该脚本存在一定的投毒风险，使用者需要仔细检查代码，确保自己了解每一部分代码的作用。特别是 `generate_jsp_footer` 函数，使用者可以自定义 `custom_content` 参数，替换默认的冰蝎 payload。

**投毒风险比例：** 10%（主要风险在于使用者不了解默认 payload 的作用，在不知情的情况下使用）。


**项目地址:** [lizhianyuguangming/CVE-2024-50379-exp](https://github.com/lizhianyuguangming/CVE-2024-50379-exp)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #13

**来源**: [CVE-2024-50379-ph0ebus_Tomcat-CVE-2024-50379-Poc.md](../2024/CVE-2024-50379-ph0ebus_Tomcat-CVE-2024-50379-Poc.md)

# CVE-2024-50379

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-50379-Alchemist3dot14_CVE-2024-50379.md](../2024/CVE-2024-50379-Alchemist3dot14_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1
10.1.0-M1 <= version <= 10.1.33
9.0.0.M1 <= version <= 9.0.97

**利用条件:** 1. 存在大小写不敏感的文件系统。
2. 默认Servlet开启写入功能(非默认配置)。
3. 目标服务器存在/uploads目录且可写。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中 JSP 编译期间的 Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认 servlet 启用写入（非默认配置）且文件系统不区分大小写时，攻击者可以利用此漏洞实现远程代码执行。该 PoC 代码通过上传包含恶意代码的 JSP shell 到可写目录（如/uploads）并利用该 shell 执行任意系统命令来演示漏洞利用过程。需要注意的是,PoC代码中定义了BASE_URL、UPLOAD_ENDPOINT、SHELL_NAME和SHELL_CONTENT等变量，如果攻击者修改了SHELL_CONTENT内容添加了恶意程序，可能会对目标系统造成其他安全威胁。尽管 PoC 本身是为了演示漏洞，但确实存在被滥用进行恶意攻击的风险。该PoC的投毒风险主要来自修改后的JSP shell, 例如执行反弹shell或下载执行其他恶意程序。代码中虽然没有明显的恶意投毒代码，但是存在一定风险，例如JSP shell执行命令时的注入，或对服务器的其他操作等，所以投毒风险评为10%。

**项目地址:** [Alchemist3dot14/CVE-2024-50379](https://github.com/Alchemist3dot14/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #2

**来源**: [CVE-2024-50379-JFOZ1010_Nuclei-Template-CVE-2024-50379.md](../2024/CVE-2024-50379-JFOZ1010_Nuclei-Template-CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition 导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false，且文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是一个Apache Tomcat中的TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞。当Tomcat的默认Servlet的`readonly`参数设置为`false`时（非默认配置），攻击者可以通过上传一个JSP文件，并在Tomcat编译该JSP文件时，通过竞争条件替换该文件为恶意JSP文件，从而实现远程代码执行。

**漏洞利用方式：**

1.  **条件满足：**  确保目标Tomcat实例的默认Servlet的`readonly`参数已设置为`false`。这意味着允许通过默认Servlet上传文件。
2.  **上传JSP文件：**  首先上传一个良性的JSP文件，例如`hello.jsp`，其中包含一些基本代码，比如打印"Hello, World!"。
3.  **竞争条件：**  在Tomcat编译`hello.jsp`文件时，攻击者迅速上传一个恶意的JSP文件，比如`HELLO.JSP`（注意大小写差异，利用文件系统大小写不敏感的特性），其中包含执行任意命令的代码（例如，启动计算器）。
4.  **远程代码执行：**  如果竞争成功，Tomcat会编译并执行恶意的`HELLO.JSP`文件，从而导致远程代码执行。

**POC分析：**

提供的Nuclei模板`CVE-2024-50379.yaml` 旨在自动化此漏洞的检测。它通过以下步骤工作：

1.  上传一个包含 "Hello, World!" 的良性JSP文件 (`hello.jsp`) 到 `/upload.jsp` 。
2.  快速上传一个包含恶意代码的JSP文件 (`HELLO.JSP`) 到 `/uploads/upload.jsp` 。这个恶意JSP包含执行计算器的代码片段 `Runtime.getRuntime().exec("calc.exe");`。
3.  尝试访问上传的文件 (`/uploads/hello.jsp`) ，并检查响应是否包含预期的输出或错误信息。

**投毒风险分析：**

虽然提供的POC代码本身旨在利用漏洞，而非植入后门，但仍然存在一些潜在的投毒风险：

*   **文件名大小写混淆:**  利用了大小写不敏感的文件系统, 可能存在编码问题或文件系统差异导致POC失效, 但不属于后门或投毒代码
*   **自定义恶意JSP：**  用户在使用POC时，可能会修改恶意JSP文件中的代码，以执行其他恶意操作，例如上传webshell或执行更隐蔽的命令。这取决于用户自身行为，不属于POC作者投毒。
*   **依赖外部资源：**  虽然当前的POC没有直接依赖外部资源，但如果用户修改POC并添加对外部资源的依赖（例如，下载恶意脚本），则可能引入投毒风险。
*   **README.md中的免责声明：** README明确说明了使用该模板的伦理责任，并强调只能在授权环境下使用。这在一定程度上降低了作者恶意使用的可能性。

综合考虑，尽管存在一些潜在的风险，但该仓库中直接包含作者有意植入的投毒代码的可能性较低。投毒风险主要来自于用户对POC的修改和使用方式。 因此，我给出的投毒风险概率是10%。

**项目地址:** [JFOZ1010/Nuclei-Template-CVE-2024-50379](https://github.com/JFOZ1010/Nuclei-Template-CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #3

**来源**: [CVE-2024-50379-SleepingBag945_CVE-2024-50379.md](../2024/CVE-2024-50379-SleepingBag945_CVE-2024-50379.md)

## CVE-2024-50379 - Apache Tomcat TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 竞争条件导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可远程执行任意代码

**影响版本:** 9.0.0.M1 <= version <= 9.0.97, 10.1.0-M1 <= version <= 10.1.33, 11.0.0-M1 <= version <= 11.0.1

**利用条件:** 1. Apache Tomcat 存在漏洞版本;2. 运行在大小写不敏感的文件系统上; 3. 默认 Servlet 启用了写入功能 (非默认配置)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞，存在于 JSP 编译过程中。当 Tomcat 运行在大小写不敏感的文件系统上，且默认 Servlet 启用写入功能时（这是一个非默认配置），攻击者可以通过竞争条件绕过安全检查，上传恶意 JSP 文件并执行，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  攻击者利用竞争条件，在 Tomcat 检查文件类型之后、编译之前，修改已上传文件的内容。
2.  由于 Tomcat 存在 TOCTOU 漏洞，因此可以绕过安全检查，导致恶意 JSP 代码被执行。
3.  漏洞利用代码（PoC）`main.go`是一个Go程序，它通过并发发送请求来触发竞争条件，上传一个包含恶意代码的JSP文件。它使用`fasthttp`库发送HTTP请求，利用`ants/v2`库管理并发连接池。

**投毒风险分析：**

代码整体结构较为清晰，主要功能是利用漏洞，并未发现明显的恶意代码。可能的投毒风险在于作者使用的第三方库是否安全，或者作者是否在不显眼的地方添加了恶意代码。风险评估：

*   **第三方库风险：** 代码依赖`github.com/valyala/fasthttp`和`github.com/panjf2000/ants/v2`两个库。需要检查这些库是否存在已知的安全问题。作者替换了`fasthttp`库，需要仔细检查替换的`fasthttp`代码是否存在恶意代码。
*   **代码逻辑风险：** 代码逻辑相对简单，主要就是发送请求，没有发现明显的植入后门的地方。

因此，综合来看，投毒的可能性较低，风险值设定为10%。主要风险还是在于对作者修改过的`fasthttp`库的审核，需要人工进行安全审计。

**项目地址:** [SleepingBag945/CVE-2024-50379](https://github.com/SleepingBag945/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #4

**来源**: [CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 需要目标系统为大小写不敏感的文件系统，且default servlet的write权限开启（非默认配置）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞。此漏洞出现在 JSP 编译过程中，允许在大小写不敏感的文件系统上进行远程代码执行（RCE），前提是默认 servlet 启用了写入权限（非默认配置）。

**漏洞利用方式：**

1.  攻击者上传一个包含恶意 JSP 代码的文件，该文件旨在执行任意命令。
2.  由于 TOCTOU 漏洞，Tomcat 在检查文件和实际编译文件之间存在时间差。
3.  攻击者利用这个时间差，通过竞争条件来修改或替换上传的文件内容。
4.  如果攻击成功，Tomcat 将编译并执行恶意 JSP 代码，从而导致远程代码执行。

**POC代码分析：**

提供的POC代码 (`Exploit-poc.py`) 旨在自动化利用此漏洞的过程。它执行以下操作：

1.  **上传Payload:** 使用`PUT`请求将包含恶意代码的JSP文件（`rce.jsp`）上传到目标服务器。
2.  **触发Payload:** 使用`GET`请求访问上传的JSP文件，触发服务器执行JSP中的恶意代码。

该脚本允许指定单个目标URL或包含目标URL列表的文件，并使用多线程来加速漏洞利用过程。

**有效性：**

根据漏洞信息和搜索结果，POC代码是有效的，可以利用该漏洞在满足特定条件的目标系统上执行远程代码。

**投毒风险：**

虽然POC代码本身主要是为了验证和利用漏洞，但仍然存在一定的投毒风险。`JSP_PAYLOAD` 变量允许攻击者自定义执行的命令，如果攻击者上传的Payload包含恶意代码，可能会对目标系统造成损害。例如，Payload可以执行系统命令、修改文件或窃取敏感数据。
此外，脚本中 `if resp.status_code == 200 and "root" in resp.text.lower():` 判断是否存在漏洞利用成功，这里存在一定的概率作者可能存在恶意的判断，导致虽然命令执行成功，但无法正确显示出来，从而导致攻击者判断失误，后续进行恶意操作。

综合评估，该仓库中存在一定程度的投毒风险，风险概率约为10%。主要是考虑到代码作者可以通过构造Payload来影响目标系统，或通过不准确的判断结果来迷惑攻击者。

**项目地址:** [Yuri08loveElaina/CVE-2024-50379-POC](https://github.com/Yuri08loveElaina/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #5

**来源**: [CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379.md](../2024/CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379.md)

## CVE-2024-50379 - Apache Tomcat JSP 编译 TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** 9.0.0.M1 - 9.0.97, 10.1.0-M1 - 10.1.33, 11.0.0-M1 - 11.0.1

**利用条件:** 默认Servlet启用写入（非默认配置），大小写不敏感的文件系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU（Time-of-check Time-of-use）竞争条件漏洞，发生在 JSP 编译期间。如果满足以下条件，则可能导致远程代码执行：

1.  **默认 Servlet 启用写入：** Tomcat 的默认 Servlet 允许写入，这不是默认配置，需要手动开启。
2.  **大小写不敏感的文件系统：** 操作系统使用大小写不敏感的文件系统（例如 Windows）。

**漏洞利用方式：**

攻击者通过上传恶意 JSP 文件（例如 aa.Jsp 和 bb.Jsp）并利用并发请求触发 TOCTOU 漏洞。具体来说，攻击者会并发地发送 PUT 和 GET 请求到 Tomcat 服务器。PUT 请求用于上传包含恶意代码的 JSP 文件，GET 请求用于访问这些 JSP 文件。由于竞争条件，Tomcat 可能会在文件检查后、实际执行文件之前，将文件误判为安全，从而导致恶意代码被执行。

漏洞利用代码 `exploit.py` 模拟了这种攻击方式，它并发地向目标 URL 发送 PUT 和 GET 请求，尝试上传和执行包含反弹 shell 代码的 JSP 文件。代码中使用了多线程来增加竞争成功的概率。

**有效性：**

根据漏洞描述和搜索结果，POC代码在满足特定条件（默认 Servlet 启用写入，大小写不敏感的文件系统）下有效。它利用了并发请求来触发 TOCTOU 漏洞，从而允许远程代码执行。

**投毒风险：**

查看提供的代码，发现该代码的功能是尝试利用 CVE-2024-50379 漏洞进行远程代码执行。代码本身实现了并发上传和访问JSP文件，并通过反弹shell执行恶意代码。**该代码的目的是进行漏洞验证和利用，而不是植入恶意后门**。因此，认为该代码存在投毒风险的可能性极低，判定为0%。

搜索结果也表明该漏洞利用涉及竞争条件，需要并发执行 PUT 和 GET 请求才能成功利用。这与 POC 代码的实现方式相符。

**项目地址:** [Yuri08loveElaina/CVE-2024-50379](https://github.com/Yuri08loveElaina/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #6

**来源**: [CVE-2024-50379-carefreegarb_CVE-2024-50379.md](../2024/CVE-2024-50379-carefreegarb_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可以导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 1. 目标系统为大小写不敏感的文件系统。
2. Tomcat的default servlet的readonly参数设置为false（非默认配置，允许写入）。
3. 存在网络访问Tomcat服务器的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是Apache Tomcat中的一个Time-of-Check Time-of-Use (TOCTOU)竞争条件漏洞。当满足以下条件时，攻击者可以利用此漏洞在服务器上执行任意代码：

*   **环境要求:** 目标系统使用大小写不敏感的文件系统，并且default servlet的`readonly`参数设置为`false`。
*   **漏洞原理:** 在JSP编译期间，Tomcat存在一个竞争条件。攻击者可以在Tomcat检查文件是否存在和可写之后，但在实际编译之前，替换JSP文件。通过精心构造JSP文件，攻击者可以上传恶意代码，并在服务器上执行。
*   **利用方式:**  提供的POC代码是一个Go程序，它利用多线程并发上传恶意JSP文件，从而触发竞争条件。该POC接受目标URL、包含恶意代码的JSP文件路径以及目标服务器上保存的文件名/路径作为参数。
*   **有效性:** 根据搜索结果和POC代码，该漏洞利用是有效的，可以实现远程代码执行。
*   **投毒风险评估:** 提供的代码中存在一定的投毒风险。虽然主要功能是实现漏洞利用，但作者可能在代码中添加一些不明显的后门或者恶意行为。代码中包含`replace github.com/valyala/fasthttp v1.58.0 => ./fasthttp`。使用本地修改过的 `fasthttp` 库存在潜在风险，恶意作者可能在修改后的库中植入后门。因此，对于此类来源不明的代码，需要进行代码审计，才能确保其安全性。综合考虑，存在10%的投毒风险。

**项目地址:** [carefreegarb/CVE-2024-50379](https://github.com/carefreegarb/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #7

**来源**: [CVE-2024-50379-dear-cell_CVE-2024-50379.md](../2024/CVE-2024-50379-dear-cell_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认servlet配置为可写(非默认配置)，文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 servlet 配置为可写（非默认配置）且文件系统大小写不敏感时，攻击者可以通过竞争条件在JSP编译期间执行任意代码，导致远程代码执行（RCE）。

**漏洞利用方式：**

1.  **竞争条件：** 利用JSP编译过程中的TOCTOU漏洞，通过并发请求修改正在编译的文件。
2.  **PUT请求：** POC代码使用PUT方法尝试上传JSP文件到目标URL（/asd.Jsp 和 /qwe.Jsp）。
3.  **GET请求：** POC代码也使用GET请求访问JSP文件。
4.  **1.jsp和2.jsp:** POC利用了 /1.jsp 和 /2.jsp 文件，其中2.jsp 似乎动态生成jsp马，写入到/1.jsp.
5.  **并发执行：** 使用线程池并发执行PUT和GET请求，增加竞争成功的概率。
6.  **Payload：**  `upload.txt` 文件包含JSP payload，用于写入恶意代码。

**有效性评估：**

根据漏洞描述，搜索引擎结果和POC代码，该漏洞利用是有效的。POC代码尝试利用竞争条件上传包含恶意代码的JSP文件。

**投毒风险评估：**

POC代码本身的主要目的是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **恶意Payload：**`upload.txt` 文件中的payload可能包含恶意代码，如果使用者不检查该文件内容直接运行POC，可能会在目标系统上植入后门。
2.  **隐藏逻辑：** 脚本中可能存在隐蔽的后门代码, 虽然代码主要逻辑围绕竞争和JSP上传, 但不能完全排除作者添加额外恶意行为的可能性, 虽然可能性较低。
3.  **依赖风险：**虽然代码本身没有直接的外部依赖，如果`upload.txt`来自于外部，那风险就变得不可控。
总体来说，投毒风险较低，大约5%，但需要仔细审查`upload.txt`的内容，确保其安全性。

**建议：**
* 升级到Tomcat 11.0.2, 10.1.34 或 9.0.98。
* 禁用默认servlet的写入权限。
* 仔细审查并测试POC代码，确保理解其行为，避免未知的风险。

**项目地址:** [dear-cell/CVE-2024-50379](https://github.com/dear-cell/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #8

**来源**: [CVE-2024-50379-dkstar11q_CVE-2024-50379-nuclei.md](../2024/CVE-2024-50379-dkstar11q_CVE-2024-50379-nuclei.md)

## CVE-2024-50379-ApacheTomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 Servlet 启用写入且文件系统不区分大小写时，在 JSP 编译期间可能导致远程代码执行。

**漏洞利用方式：**
1.  攻击者利用PUT方法上传一个JSP文件到一个可写目录。
2.  由于TOCTOU漏洞，在Tomcat检查文件类型和实际编译文件之间存在时间差，攻击者可以利用竞争条件，上传恶意JSP文件绕过检查。
3.  上传的JSP文件会被当做可执行文件执行，从而导致远程代码执行。

**POC有效性：**
提供的`poc.py`脚本通过多线程并发上传包含恶意代码的JSP文件，利用竞争条件触发漏洞。该脚本首先检查目标是否允许PUT请求，然后通过PUT上传一个payload，该payload用于将webshell写入指定路径，最后GET请求访问该webshell，如果返回200则验证成功

**投毒风险评估：**
该仓库中是否存在投毒代码的可能性较低。`poc.py`的主要功能是利用漏洞上传和执行webshell。虽然webshell本身具有潜在的风险，但它属于漏洞利用的范畴，并不构成“投毒”。脚本的功能相对明确，没有发现隐藏的恶意行为。考虑到脚本的开源性质以及其目标是漏洞利用，作者隐藏恶意代码的可能性较低，但不能完全排除，因此评估的投毒风险为1%。

**项目地址:** [dkstar11q/CVE-2024-50379-nuclei](https://github.com/dkstar11q/CVE-2024-50379-nuclei)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #9

**来源**: [CVE-2024-50379-dragonked2_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-dragonked2_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个时间检查/时间使用 (TOCTOU) 竞争条件漏洞。该漏洞出现在 JSP 编译期间，当默认 servlet 启用了写入（非默认配置）且文件系统大小写不敏感时，允许远程代码执行 (RCE)。攻击者可以利用此漏洞上传一个文件，并通过竞争条件使其被 Tomcat 作为 JSP 文件执行，从而导致任意代码执行。提供的代码段是 Apache 2.0 许可协议，并非漏洞利用代码本身，因此无法直接验证 POC 的有效性。但根据搜索结果，存在公开的POC，可以利用。由于提供的代码只是许可协议，不包含恶意代码，因此投毒风险为0%。利用方式如下：

1.  **上传恶意文件：** 攻击者上传一个恶意文件，该文件伪装成 JSP 文件，但实际上包含恶意代码。
2.  **竞争条件：** 攻击者利用 TOCTOU 漏洞，在 Tomcat 检查文件类型和实际编译文件之间制造时间差。
3.  **绕过检查：** 在检查通过后，攻击者通过某种方式修改文件内容，使其成为真正的 JSP 文件，并包含恶意代码。
4.  **远程代码执行：** Tomcat 编译并执行该 JSP 文件，从而导致远程代码执行。

**项目地址:** [dragonked2/CVE-2024-50379-POC](https://github.com/dragonked2/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #10

**来源**: [CVE-2024-50379-gomtaengi_CVE-2024-50379-exp.md](../2024/CVE-2024-50379-gomtaengi_CVE-2024-50379-exp.md)

## CVE-2024-50379 - Apache Tomcat TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 9.0.0.M1 - 9.0.97, 10.1.0-M1 - 10.1.33, 11.0.0-M1 - 11.0.1

**利用条件:** 默认 servlet 启用写入 (非默认配置)且运行在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是 Apache Tomcat 中 JSP 编译期间发生的 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 servlet 启用写入时，攻击者可以通过上传包含恶意 JSP 代码的文件并利用竞争条件来触发 Tomcat 解析和执行它，从而实现远程代码执行。

**利用方式：**

1.  **上传恶意 JSP 文件：** 攻击者首先上传一个名为 `test01_{random_suffix}.txt` 的文件，其中包含JSP Footer代码，该代码的功能是接收通过请求头传递的base64编码的payload，然后通过AES解密后加载到内存中执行。
2.  **利用竞争条件：** 攻击者利用竞争条件，尝试在 Tomcat 将上传的 `.txt` 文件识别为普通文本文件之前，将其重命名为 `.jsp` 文件。这需要同时发送大量的请求。
3.  **JSP 编译和执行：** 如果竞争成功，Tomcat 将尝试编译并执行该 `.jsp` 文件，从而允许攻击者执行任意代码。

**POC代码分析：**

提供的 Python POC 脚本旨在自动化利用此漏洞。脚本执行以下步骤：

1.  **生成随机字符串和哈希：** 生成随机后缀和 MD5 哈希值，用于生成唯一的临时文件名和最终的 JSP 文件名。
2.  **生成 JSP 内容：** 生成包含将源文件复制到目标文件的 JSP 代码。
3.  **发送 PUT 请求：** 使用生成的随机文件名将恶意 JSP 内容上传到服务器。 通过PUT上传t1{random_suffix}.Txt和t2{random_suffix}.Txt为JSP Footer内容，t1{random_suffix}.Jsp和t2{random_suffix}.Jsp为JSP Header内容。
4.  **发送 GET 请求：** 发送GET请求, 检查目标JSP是否存在.
5.  **多线程并发：** 使用多线程并发来增加竞争条件成功的可能性。
6.  **停止机制:**  一旦发现漏洞则停止扫描.

**投毒风险分析：**

代码中存在一定的投毒风险，主要集中在以下几个方面：

1.  **JSP Footer 的自定义内容：** 脚本允许用户通过 `-f` 或 `--footer` 参数指定自定义的 JSP footer 内容。 如果攻击者指定了恶意的 JSP 代码，则可能导致被攻击的服务器受到进一步的损害。 但这是参数问题，不是代码本身的问题。
2.  **Payload 执行：** JSP Footer 中的恶意代码功能是通过请求头传递加密的payload，并将其加载到内存中执行。攻击者可以通过控制请求头来执行任意代码。尽管这本身就是漏洞利用的一部分，但如果攻击者能够注入额外的恶意代码，则可能导致更严重的后果。

**总结：**

该漏洞利用的有效性较高，但也依赖于特定的配置（默认 servlet 启用写入）和文件系统类型（大小写不敏感）。POC 代码可以有效利用此漏洞，但存在一定的投毒风险，用户需要谨慎使用，尤其是在指定自定义 JSP 内容时。Payload的加载和执行是漏洞利用的关键步骤。

**项目地址:** [gomtaengi/CVE-2024-50379-exp](https://github.com/gomtaengi/CVE-2024-50379-exp)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #11

**来源**: [CVE-2024-50379-iSee857_CVE-2024-50379-PoC.md](../2024/CVE-2024-50379-iSee857_CVE-2024-50379-PoC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入(非默认配置)，文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379是Apache Tomcat中的一个Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认Servlet启用写入且文件系统不区分大小写时，攻击者可以通过竞争条件在JSP编译期间执行远程代码。

**漏洞利用方式：**

1.  攻击者发送PUT请求上传一个名为`aa.Jsp`的文件，包含恶意JSP代码，例如`aa<% Runtime.getRuntime().exec("calc.exe");%>`。同时上传`bb.Jsp`类似的文件。
2.  利用TOCTOU漏洞：在Tomcat检查文件类型之后，但在编译之前，攻击者通过竞争条件修改文件内容，从而绕过安全检查。
3.  Tomcat将上传的文件编译为JSP，执行其中的恶意代码，导致远程代码执行。
4.  POC代码通过多线程并发PUT和GET请求，尝试触发竞争条件，利用漏洞。

**有效性：**

提供的POC代码利用了多线程并发请求，旨在触发TOCTOU竞争条件，经验证是有效的。搜索引擎结果也表明该漏洞可被利用，并提供了相关的PoC。

**投毒风险：**

该仓库中的POC代码的主要功能是利用CVE-2024-50379漏洞进行远程代码执行的验证。  payload使用了calc.exe, 并没有发现明显的恶意行为，例如反弹shell或植入持久性后门。代码存在极小概率的投毒风险（例如，在非常隐蔽的地方插入恶意代码，或者利用竞争条件引入不可预测的行为），但这种可能性很低。基于对整个代码的审查，判断投毒风险约为1%。代码中只是用于验证漏洞的后门代码，不属于投毒代码。


**项目地址:** [iSee857/CVE-2024-50379-PoC](https://github.com/iSee857/CVE-2024-50379-PoC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #12

**来源**: [CVE-2024-50379-lizhianyuguangming_CVE-2024-50379-exp.md](../2024/CVE-2024-50379-lizhianyuguangming_CVE-2024-50379-exp.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU 竞态条件导致远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false（非默认配置），运行在大小写不敏感的文件系统上，网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU (Time-of-Check Time-of-Use) 竞态条件漏洞，发生在 JSP 编译期间。当 Tomcat 运行在大小写不敏感的文件系统上，并且默认 Servlet 的 `readonly` 参数设置为 `false` （这**不是默认配置**），攻击者可以通过竞态条件竞争，上传一个文件，并在 Tomcat 检查其类型之前，将其替换为恶意的 JSP 文件，从而导致远程代码执行。

**漏洞利用方式：**

1.  **先决条件：** 目标 Tomcat 实例必须配置为允许写入（`readonly=false`）。目标服务器的文件系统需要不区分大小写，如 Windows 服务器。
2.  **上传文件：** 攻击者上传一个文件，比如 `t1<random_suffix>.txt` 和 `t2<random_suffix>.txt`，包含部分 JSP 代码，为恶意JSP文件的前半部分和后半部分，用于后续组合。
3.  **竞争条件：** 攻击者发送并发请求，尝试利用 TOCTOU 漏洞。这些请求尝试在 Tomcat 检查文件类型之前，修改上传的文件。
4.  **替换文件：**  利用竞态条件，在 Tomcat 检查文件类型之后，但在实际编译之前，恶意 JSP 代码被写入到上传的文件中。
5.  **JSP 编译：** Tomcat 编译并执行恶意 JSP 代码，从而导致 RCE。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于自动化利用此漏洞。主要步骤如下：

1.  **加载目标 URL：** 从 `url.txt` 文件中读取目标 Tomcat 服务器的 URL 列表。
2.  **生成随机字符串和 MD5 哈希：** 用于生成临时文件名和进行一些操作。
3.  **生成 JSP 代码：**生成用于将文件重命名并执行的JSP Header和JSP Footer,其中JSP Footer包含冰蝎payload。
4.  **发送 GET 请求：**  向目标服务器发送 GET 请求，触发漏洞利用。构造特定的 URL，访问恶意文件，触发 JSP 编译，执行恶意代码。
5.  **并发执行：** 使用线程池并发发送请求，以增加利用成功的概率。

**投毒风险分析：**

该脚本的主要目的是利用 CVE-2024-50379 漏洞，实现远程代码执行。 但是，在 `generate_jsp_footer` 函数中，默认情况下包含一个冰蝎 payload。如果使用者不了解这段代码的作用，可能会在不知情的情况下植入后门。

-   **投毒代码：** `generate_jsp_footer` 函数中默认包含冰蝎 payload。
-   **风险评估：** 冰蝎是一个流行的 webshell 工具，攻击者可以使用它来远程管理服务器，执行任意命令，上传和下载文件等。

因此，该脚本存在一定的投毒风险，使用者需要仔细检查代码，确保自己了解每一部分代码的作用。特别是 `generate_jsp_footer` 函数，使用者可以自定义 `custom_content` 参数，替换默认的冰蝎 payload。

**投毒风险比例：** 10%（主要风险在于使用者不了解默认 payload 的作用，在不知情的情况下使用）。


**项目地址:** [lizhianyuguangming/CVE-2024-50379-exp](https://github.com/lizhianyuguangming/CVE-2024-50379-exp)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #13

**来源**: [CVE-2024-50379-ph0ebus_Tomcat-CVE-2024-50379-Poc.md](../2024/CVE-2024-50379-ph0ebus_Tomcat-CVE-2024-50379-Poc.md)

# CVE-2024-50379

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-50379-Alchemist3dot14_CVE-2024-50379.md](../2024/CVE-2024-50379-Alchemist3dot14_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1
10.1.0-M1 <= version <= 10.1.33
9.0.0.M1 <= version <= 9.0.97

**利用条件:** 1. 存在大小写不敏感的文件系统。
2. 默认Servlet开启写入功能(非默认配置)。
3. 目标服务器存在/uploads目录且可写。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中 JSP 编译期间的 Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认 servlet 启用写入（非默认配置）且文件系统不区分大小写时，攻击者可以利用此漏洞实现远程代码执行。该 PoC 代码通过上传包含恶意代码的 JSP shell 到可写目录（如/uploads）并利用该 shell 执行任意系统命令来演示漏洞利用过程。需要注意的是,PoC代码中定义了BASE_URL、UPLOAD_ENDPOINT、SHELL_NAME和SHELL_CONTENT等变量，如果攻击者修改了SHELL_CONTENT内容添加了恶意程序，可能会对目标系统造成其他安全威胁。尽管 PoC 本身是为了演示漏洞，但确实存在被滥用进行恶意攻击的风险。该PoC的投毒风险主要来自修改后的JSP shell, 例如执行反弹shell或下载执行其他恶意程序。代码中虽然没有明显的恶意投毒代码，但是存在一定风险，例如JSP shell执行命令时的注入，或对服务器的其他操作等，所以投毒风险评为10%。

**项目地址:** [Alchemist3dot14/CVE-2024-50379](https://github.com/Alchemist3dot14/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #2

**来源**: [CVE-2024-50379-JFOZ1010_Nuclei-Template-CVE-2024-50379.md](../2024/CVE-2024-50379-JFOZ1010_Nuclei-Template-CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition 导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false，且文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是一个Apache Tomcat中的TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞。当Tomcat的默认Servlet的`readonly`参数设置为`false`时（非默认配置），攻击者可以通过上传一个JSP文件，并在Tomcat编译该JSP文件时，通过竞争条件替换该文件为恶意JSP文件，从而实现远程代码执行。

**漏洞利用方式：**

1.  **条件满足：**  确保目标Tomcat实例的默认Servlet的`readonly`参数已设置为`false`。这意味着允许通过默认Servlet上传文件。
2.  **上传JSP文件：**  首先上传一个良性的JSP文件，例如`hello.jsp`，其中包含一些基本代码，比如打印"Hello, World!"。
3.  **竞争条件：**  在Tomcat编译`hello.jsp`文件时，攻击者迅速上传一个恶意的JSP文件，比如`HELLO.JSP`（注意大小写差异，利用文件系统大小写不敏感的特性），其中包含执行任意命令的代码（例如，启动计算器）。
4.  **远程代码执行：**  如果竞争成功，Tomcat会编译并执行恶意的`HELLO.JSP`文件，从而导致远程代码执行。

**POC分析：**

提供的Nuclei模板`CVE-2024-50379.yaml` 旨在自动化此漏洞的检测。它通过以下步骤工作：

1.  上传一个包含 "Hello, World!" 的良性JSP文件 (`hello.jsp`) 到 `/upload.jsp` 。
2.  快速上传一个包含恶意代码的JSP文件 (`HELLO.JSP`) 到 `/uploads/upload.jsp` 。这个恶意JSP包含执行计算器的代码片段 `Runtime.getRuntime().exec("calc.exe");`。
3.  尝试访问上传的文件 (`/uploads/hello.jsp`) ，并检查响应是否包含预期的输出或错误信息。

**投毒风险分析：**

虽然提供的POC代码本身旨在利用漏洞，而非植入后门，但仍然存在一些潜在的投毒风险：

*   **文件名大小写混淆:**  利用了大小写不敏感的文件系统, 可能存在编码问题或文件系统差异导致POC失效, 但不属于后门或投毒代码
*   **自定义恶意JSP：**  用户在使用POC时，可能会修改恶意JSP文件中的代码，以执行其他恶意操作，例如上传webshell或执行更隐蔽的命令。这取决于用户自身行为，不属于POC作者投毒。
*   **依赖外部资源：**  虽然当前的POC没有直接依赖外部资源，但如果用户修改POC并添加对外部资源的依赖（例如，下载恶意脚本），则可能引入投毒风险。
*   **README.md中的免责声明：** README明确说明了使用该模板的伦理责任，并强调只能在授权环境下使用。这在一定程度上降低了作者恶意使用的可能性。

综合考虑，尽管存在一些潜在的风险，但该仓库中直接包含作者有意植入的投毒代码的可能性较低。投毒风险主要来自于用户对POC的修改和使用方式。 因此，我给出的投毒风险概率是10%。

**项目地址:** [JFOZ1010/Nuclei-Template-CVE-2024-50379](https://github.com/JFOZ1010/Nuclei-Template-CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #3

**来源**: [CVE-2024-50379-SleepingBag945_CVE-2024-50379.md](../2024/CVE-2024-50379-SleepingBag945_CVE-2024-50379.md)

## CVE-2024-50379 - Apache Tomcat TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 竞争条件导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可远程执行任意代码

**影响版本:** 9.0.0.M1 <= version <= 9.0.97, 10.1.0-M1 <= version <= 10.1.33, 11.0.0-M1 <= version <= 11.0.1

**利用条件:** 1. Apache Tomcat 存在漏洞版本;2. 运行在大小写不敏感的文件系统上; 3. 默认 Servlet 启用了写入功能 (非默认配置)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞，存在于 JSP 编译过程中。当 Tomcat 运行在大小写不敏感的文件系统上，且默认 Servlet 启用写入功能时（这是一个非默认配置），攻击者可以通过竞争条件绕过安全检查，上传恶意 JSP 文件并执行，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  攻击者利用竞争条件，在 Tomcat 检查文件类型之后、编译之前，修改已上传文件的内容。
2.  由于 Tomcat 存在 TOCTOU 漏洞，因此可以绕过安全检查，导致恶意 JSP 代码被执行。
3.  漏洞利用代码（PoC）`main.go`是一个Go程序，它通过并发发送请求来触发竞争条件，上传一个包含恶意代码的JSP文件。它使用`fasthttp`库发送HTTP请求，利用`ants/v2`库管理并发连接池。

**投毒风险分析：**

代码整体结构较为清晰，主要功能是利用漏洞，并未发现明显的恶意代码。可能的投毒风险在于作者使用的第三方库是否安全，或者作者是否在不显眼的地方添加了恶意代码。风险评估：

*   **第三方库风险：** 代码依赖`github.com/valyala/fasthttp`和`github.com/panjf2000/ants/v2`两个库。需要检查这些库是否存在已知的安全问题。作者替换了`fasthttp`库，需要仔细检查替换的`fasthttp`代码是否存在恶意代码。
*   **代码逻辑风险：** 代码逻辑相对简单，主要就是发送请求，没有发现明显的植入后门的地方。

因此，综合来看，投毒的可能性较低，风险值设定为10%。主要风险还是在于对作者修改过的`fasthttp`库的审核，需要人工进行安全审计。

**项目地址:** [SleepingBag945/CVE-2024-50379](https://github.com/SleepingBag945/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #4

**来源**: [CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 需要目标系统为大小写不敏感的文件系统，且default servlet的write权限开启（非默认配置）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞。此漏洞出现在 JSP 编译过程中，允许在大小写不敏感的文件系统上进行远程代码执行（RCE），前提是默认 servlet 启用了写入权限（非默认配置）。

**漏洞利用方式：**

1.  攻击者上传一个包含恶意 JSP 代码的文件，该文件旨在执行任意命令。
2.  由于 TOCTOU 漏洞，Tomcat 在检查文件和实际编译文件之间存在时间差。
3.  攻击者利用这个时间差，通过竞争条件来修改或替换上传的文件内容。
4.  如果攻击成功，Tomcat 将编译并执行恶意 JSP 代码，从而导致远程代码执行。

**POC代码分析：**

提供的POC代码 (`Exploit-poc.py`) 旨在自动化利用此漏洞的过程。它执行以下操作：

1.  **上传Payload:** 使用`PUT`请求将包含恶意代码的JSP文件（`rce.jsp`）上传到目标服务器。
2.  **触发Payload:** 使用`GET`请求访问上传的JSP文件，触发服务器执行JSP中的恶意代码。

该脚本允许指定单个目标URL或包含目标URL列表的文件，并使用多线程来加速漏洞利用过程。

**有效性：**

根据漏洞信息和搜索结果，POC代码是有效的，可以利用该漏洞在满足特定条件的目标系统上执行远程代码。

**投毒风险：**

虽然POC代码本身主要是为了验证和利用漏洞，但仍然存在一定的投毒风险。`JSP_PAYLOAD` 变量允许攻击者自定义执行的命令，如果攻击者上传的Payload包含恶意代码，可能会对目标系统造成损害。例如，Payload可以执行系统命令、修改文件或窃取敏感数据。
此外，脚本中 `if resp.status_code == 200 and "root" in resp.text.lower():` 判断是否存在漏洞利用成功，这里存在一定的概率作者可能存在恶意的判断，导致虽然命令执行成功，但无法正确显示出来，从而导致攻击者判断失误，后续进行恶意操作。

综合评估，该仓库中存在一定程度的投毒风险，风险概率约为10%。主要是考虑到代码作者可以通过构造Payload来影响目标系统，或通过不准确的判断结果来迷惑攻击者。

**项目地址:** [Yuri08loveElaina/CVE-2024-50379-POC](https://github.com/Yuri08loveElaina/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #5

**来源**: [CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379.md](../2024/CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379.md)

## CVE-2024-50379 - Apache Tomcat JSP 编译 TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** 9.0.0.M1 - 9.0.97, 10.1.0-M1 - 10.1.33, 11.0.0-M1 - 11.0.1

**利用条件:** 默认Servlet启用写入（非默认配置），大小写不敏感的文件系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU（Time-of-check Time-of-use）竞争条件漏洞，发生在 JSP 编译期间。如果满足以下条件，则可能导致远程代码执行：

1.  **默认 Servlet 启用写入：** Tomcat 的默认 Servlet 允许写入，这不是默认配置，需要手动开启。
2.  **大小写不敏感的文件系统：** 操作系统使用大小写不敏感的文件系统（例如 Windows）。

**漏洞利用方式：**

攻击者通过上传恶意 JSP 文件（例如 aa.Jsp 和 bb.Jsp）并利用并发请求触发 TOCTOU 漏洞。具体来说，攻击者会并发地发送 PUT 和 GET 请求到 Tomcat 服务器。PUT 请求用于上传包含恶意代码的 JSP 文件，GET 请求用于访问这些 JSP 文件。由于竞争条件，Tomcat 可能会在文件检查后、实际执行文件之前，将文件误判为安全，从而导致恶意代码被执行。

漏洞利用代码 `exploit.py` 模拟了这种攻击方式，它并发地向目标 URL 发送 PUT 和 GET 请求，尝试上传和执行包含反弹 shell 代码的 JSP 文件。代码中使用了多线程来增加竞争成功的概率。

**有效性：**

根据漏洞描述和搜索结果，POC代码在满足特定条件（默认 Servlet 启用写入，大小写不敏感的文件系统）下有效。它利用了并发请求来触发 TOCTOU 漏洞，从而允许远程代码执行。

**投毒风险：**

查看提供的代码，发现该代码的功能是尝试利用 CVE-2024-50379 漏洞进行远程代码执行。代码本身实现了并发上传和访问JSP文件，并通过反弹shell执行恶意代码。**该代码的目的是进行漏洞验证和利用，而不是植入恶意后门**。因此，认为该代码存在投毒风险的可能性极低，判定为0%。

搜索结果也表明该漏洞利用涉及竞争条件，需要并发执行 PUT 和 GET 请求才能成功利用。这与 POC 代码的实现方式相符。

**项目地址:** [Yuri08loveElaina/CVE-2024-50379](https://github.com/Yuri08loveElaina/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #6

**来源**: [CVE-2024-50379-carefreegarb_CVE-2024-50379.md](../2024/CVE-2024-50379-carefreegarb_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可以导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 1. 目标系统为大小写不敏感的文件系统。
2. Tomcat的default servlet的readonly参数设置为false（非默认配置，允许写入）。
3. 存在网络访问Tomcat服务器的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是Apache Tomcat中的一个Time-of-Check Time-of-Use (TOCTOU)竞争条件漏洞。当满足以下条件时，攻击者可以利用此漏洞在服务器上执行任意代码：

*   **环境要求:** 目标系统使用大小写不敏感的文件系统，并且default servlet的`readonly`参数设置为`false`。
*   **漏洞原理:** 在JSP编译期间，Tomcat存在一个竞争条件。攻击者可以在Tomcat检查文件是否存在和可写之后，但在实际编译之前，替换JSP文件。通过精心构造JSP文件，攻击者可以上传恶意代码，并在服务器上执行。
*   **利用方式:**  提供的POC代码是一个Go程序，它利用多线程并发上传恶意JSP文件，从而触发竞争条件。该POC接受目标URL、包含恶意代码的JSP文件路径以及目标服务器上保存的文件名/路径作为参数。
*   **有效性:** 根据搜索结果和POC代码，该漏洞利用是有效的，可以实现远程代码执行。
*   **投毒风险评估:** 提供的代码中存在一定的投毒风险。虽然主要功能是实现漏洞利用，但作者可能在代码中添加一些不明显的后门或者恶意行为。代码中包含`replace github.com/valyala/fasthttp v1.58.0 => ./fasthttp`。使用本地修改过的 `fasthttp` 库存在潜在风险，恶意作者可能在修改后的库中植入后门。因此，对于此类来源不明的代码，需要进行代码审计，才能确保其安全性。综合考虑，存在10%的投毒风险。

**项目地址:** [carefreegarb/CVE-2024-50379](https://github.com/carefreegarb/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #7

**来源**: [CVE-2024-50379-dear-cell_CVE-2024-50379.md](../2024/CVE-2024-50379-dear-cell_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认servlet配置为可写(非默认配置)，文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 servlet 配置为可写（非默认配置）且文件系统大小写不敏感时，攻击者可以通过竞争条件在JSP编译期间执行任意代码，导致远程代码执行（RCE）。

**漏洞利用方式：**

1.  **竞争条件：** 利用JSP编译过程中的TOCTOU漏洞，通过并发请求修改正在编译的文件。
2.  **PUT请求：** POC代码使用PUT方法尝试上传JSP文件到目标URL（/asd.Jsp 和 /qwe.Jsp）。
3.  **GET请求：** POC代码也使用GET请求访问JSP文件。
4.  **1.jsp和2.jsp:** POC利用了 /1.jsp 和 /2.jsp 文件，其中2.jsp 似乎动态生成jsp马，写入到/1.jsp.
5.  **并发执行：** 使用线程池并发执行PUT和GET请求，增加竞争成功的概率。
6.  **Payload：**  `upload.txt` 文件包含JSP payload，用于写入恶意代码。

**有效性评估：**

根据漏洞描述，搜索引擎结果和POC代码，该漏洞利用是有效的。POC代码尝试利用竞争条件上传包含恶意代码的JSP文件。

**投毒风险评估：**

POC代码本身的主要目的是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **恶意Payload：**`upload.txt` 文件中的payload可能包含恶意代码，如果使用者不检查该文件内容直接运行POC，可能会在目标系统上植入后门。
2.  **隐藏逻辑：** 脚本中可能存在隐蔽的后门代码, 虽然代码主要逻辑围绕竞争和JSP上传, 但不能完全排除作者添加额外恶意行为的可能性, 虽然可能性较低。
3.  **依赖风险：**虽然代码本身没有直接的外部依赖，如果`upload.txt`来自于外部，那风险就变得不可控。
总体来说，投毒风险较低，大约5%，但需要仔细审查`upload.txt`的内容，确保其安全性。

**建议：**
* 升级到Tomcat 11.0.2, 10.1.34 或 9.0.98。
* 禁用默认servlet的写入权限。
* 仔细审查并测试POC代码，确保理解其行为，避免未知的风险。

**项目地址:** [dear-cell/CVE-2024-50379](https://github.com/dear-cell/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #8

**来源**: [CVE-2024-50379-dkstar11q_CVE-2024-50379-nuclei.md](../2024/CVE-2024-50379-dkstar11q_CVE-2024-50379-nuclei.md)

## CVE-2024-50379-ApacheTomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 Servlet 启用写入且文件系统不区分大小写时，在 JSP 编译期间可能导致远程代码执行。

**漏洞利用方式：**
1.  攻击者利用PUT方法上传一个JSP文件到一个可写目录。
2.  由于TOCTOU漏洞，在Tomcat检查文件类型和实际编译文件之间存在时间差，攻击者可以利用竞争条件，上传恶意JSP文件绕过检查。
3.  上传的JSP文件会被当做可执行文件执行，从而导致远程代码执行。

**POC有效性：**
提供的`poc.py`脚本通过多线程并发上传包含恶意代码的JSP文件，利用竞争条件触发漏洞。该脚本首先检查目标是否允许PUT请求，然后通过PUT上传一个payload，该payload用于将webshell写入指定路径，最后GET请求访问该webshell，如果返回200则验证成功

**投毒风险评估：**
该仓库中是否存在投毒代码的可能性较低。`poc.py`的主要功能是利用漏洞上传和执行webshell。虽然webshell本身具有潜在的风险，但它属于漏洞利用的范畴，并不构成“投毒”。脚本的功能相对明确，没有发现隐藏的恶意行为。考虑到脚本的开源性质以及其目标是漏洞利用，作者隐藏恶意代码的可能性较低，但不能完全排除，因此评估的投毒风险为1%。

**项目地址:** [dkstar11q/CVE-2024-50379-nuclei](https://github.com/dkstar11q/CVE-2024-50379-nuclei)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #9

**来源**: [CVE-2024-50379-dragonked2_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-dragonked2_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个时间检查/时间使用 (TOCTOU) 竞争条件漏洞。该漏洞出现在 JSP 编译期间，当默认 servlet 启用了写入（非默认配置）且文件系统大小写不敏感时，允许远程代码执行 (RCE)。攻击者可以利用此漏洞上传一个文件，并通过竞争条件使其被 Tomcat 作为 JSP 文件执行，从而导致任意代码执行。提供的代码段是 Apache 2.0 许可协议，并非漏洞利用代码本身，因此无法直接验证 POC 的有效性。但根据搜索结果，存在公开的POC，可以利用。由于提供的代码只是许可协议，不包含恶意代码，因此投毒风险为0%。利用方式如下：

1.  **上传恶意文件：** 攻击者上传一个恶意文件，该文件伪装成 JSP 文件，但实际上包含恶意代码。
2.  **竞争条件：** 攻击者利用 TOCTOU 漏洞，在 Tomcat 检查文件类型和实际编译文件之间制造时间差。
3.  **绕过检查：** 在检查通过后，攻击者通过某种方式修改文件内容，使其成为真正的 JSP 文件，并包含恶意代码。
4.  **远程代码执行：** Tomcat 编译并执行该 JSP 文件，从而导致远程代码执行。

**项目地址:** [dragonked2/CVE-2024-50379-POC](https://github.com/dragonked2/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #10

**来源**: [CVE-2024-50379-gomtaengi_CVE-2024-50379-exp.md](../2024/CVE-2024-50379-gomtaengi_CVE-2024-50379-exp.md)

## CVE-2024-50379 - Apache Tomcat TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 9.0.0.M1 - 9.0.97, 10.1.0-M1 - 10.1.33, 11.0.0-M1 - 11.0.1

**利用条件:** 默认 servlet 启用写入 (非默认配置)且运行在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是 Apache Tomcat 中 JSP 编译期间发生的 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 servlet 启用写入时，攻击者可以通过上传包含恶意 JSP 代码的文件并利用竞争条件来触发 Tomcat 解析和执行它，从而实现远程代码执行。

**利用方式：**

1.  **上传恶意 JSP 文件：** 攻击者首先上传一个名为 `test01_{random_suffix}.txt` 的文件，其中包含JSP Footer代码，该代码的功能是接收通过请求头传递的base64编码的payload，然后通过AES解密后加载到内存中执行。
2.  **利用竞争条件：** 攻击者利用竞争条件，尝试在 Tomcat 将上传的 `.txt` 文件识别为普通文本文件之前，将其重命名为 `.jsp` 文件。这需要同时发送大量的请求。
3.  **JSP 编译和执行：** 如果竞争成功，Tomcat 将尝试编译并执行该 `.jsp` 文件，从而允许攻击者执行任意代码。

**POC代码分析：**

提供的 Python POC 脚本旨在自动化利用此漏洞。脚本执行以下步骤：

1.  **生成随机字符串和哈希：** 生成随机后缀和 MD5 哈希值，用于生成唯一的临时文件名和最终的 JSP 文件名。
2.  **生成 JSP 内容：** 生成包含将源文件复制到目标文件的 JSP 代码。
3.  **发送 PUT 请求：** 使用生成的随机文件名将恶意 JSP 内容上传到服务器。 通过PUT上传t1{random_suffix}.Txt和t2{random_suffix}.Txt为JSP Footer内容，t1{random_suffix}.Jsp和t2{random_suffix}.Jsp为JSP Header内容。
4.  **发送 GET 请求：** 发送GET请求, 检查目标JSP是否存在.
5.  **多线程并发：** 使用多线程并发来增加竞争条件成功的可能性。
6.  **停止机制:**  一旦发现漏洞则停止扫描.

**投毒风险分析：**

代码中存在一定的投毒风险，主要集中在以下几个方面：

1.  **JSP Footer 的自定义内容：** 脚本允许用户通过 `-f` 或 `--footer` 参数指定自定义的 JSP footer 内容。 如果攻击者指定了恶意的 JSP 代码，则可能导致被攻击的服务器受到进一步的损害。 但这是参数问题，不是代码本身的问题。
2.  **Payload 执行：** JSP Footer 中的恶意代码功能是通过请求头传递加密的payload，并将其加载到内存中执行。攻击者可以通过控制请求头来执行任意代码。尽管这本身就是漏洞利用的一部分，但如果攻击者能够注入额外的恶意代码，则可能导致更严重的后果。

**总结：**

该漏洞利用的有效性较高，但也依赖于特定的配置（默认 servlet 启用写入）和文件系统类型（大小写不敏感）。POC 代码可以有效利用此漏洞，但存在一定的投毒风险，用户需要谨慎使用，尤其是在指定自定义 JSP 内容时。Payload的加载和执行是漏洞利用的关键步骤。

**项目地址:** [gomtaengi/CVE-2024-50379-exp](https://github.com/gomtaengi/CVE-2024-50379-exp)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #11

**来源**: [CVE-2024-50379-iSee857_CVE-2024-50379-PoC.md](../2024/CVE-2024-50379-iSee857_CVE-2024-50379-PoC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入(非默认配置)，文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379是Apache Tomcat中的一个Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认Servlet启用写入且文件系统不区分大小写时，攻击者可以通过竞争条件在JSP编译期间执行远程代码。

**漏洞利用方式：**

1.  攻击者发送PUT请求上传一个名为`aa.Jsp`的文件，包含恶意JSP代码，例如`aa<% Runtime.getRuntime().exec("calc.exe");%>`。同时上传`bb.Jsp`类似的文件。
2.  利用TOCTOU漏洞：在Tomcat检查文件类型之后，但在编译之前，攻击者通过竞争条件修改文件内容，从而绕过安全检查。
3.  Tomcat将上传的文件编译为JSP，执行其中的恶意代码，导致远程代码执行。
4.  POC代码通过多线程并发PUT和GET请求，尝试触发竞争条件，利用漏洞。

**有效性：**

提供的POC代码利用了多线程并发请求，旨在触发TOCTOU竞争条件，经验证是有效的。搜索引擎结果也表明该漏洞可被利用，并提供了相关的PoC。

**投毒风险：**

该仓库中的POC代码的主要功能是利用CVE-2024-50379漏洞进行远程代码执行的验证。  payload使用了calc.exe, 并没有发现明显的恶意行为，例如反弹shell或植入持久性后门。代码存在极小概率的投毒风险（例如，在非常隐蔽的地方插入恶意代码，或者利用竞争条件引入不可预测的行为），但这种可能性很低。基于对整个代码的审查，判断投毒风险约为1%。代码中只是用于验证漏洞的后门代码，不属于投毒代码。


**项目地址:** [iSee857/CVE-2024-50379-PoC](https://github.com/iSee857/CVE-2024-50379-PoC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #12

**来源**: [CVE-2024-50379-lizhianyuguangming_CVE-2024-50379-exp.md](../2024/CVE-2024-50379-lizhianyuguangming_CVE-2024-50379-exp.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU 竞态条件导致远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false（非默认配置），运行在大小写不敏感的文件系统上，网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU (Time-of-Check Time-of-Use) 竞态条件漏洞，发生在 JSP 编译期间。当 Tomcat 运行在大小写不敏感的文件系统上，并且默认 Servlet 的 `readonly` 参数设置为 `false` （这**不是默认配置**），攻击者可以通过竞态条件竞争，上传一个文件，并在 Tomcat 检查其类型之前，将其替换为恶意的 JSP 文件，从而导致远程代码执行。

**漏洞利用方式：**

1.  **先决条件：** 目标 Tomcat 实例必须配置为允许写入（`readonly=false`）。目标服务器的文件系统需要不区分大小写，如 Windows 服务器。
2.  **上传文件：** 攻击者上传一个文件，比如 `t1<random_suffix>.txt` 和 `t2<random_suffix>.txt`，包含部分 JSP 代码，为恶意JSP文件的前半部分和后半部分，用于后续组合。
3.  **竞争条件：** 攻击者发送并发请求，尝试利用 TOCTOU 漏洞。这些请求尝试在 Tomcat 检查文件类型之前，修改上传的文件。
4.  **替换文件：**  利用竞态条件，在 Tomcat 检查文件类型之后，但在实际编译之前，恶意 JSP 代码被写入到上传的文件中。
5.  **JSP 编译：** Tomcat 编译并执行恶意 JSP 代码，从而导致 RCE。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于自动化利用此漏洞。主要步骤如下：

1.  **加载目标 URL：** 从 `url.txt` 文件中读取目标 Tomcat 服务器的 URL 列表。
2.  **生成随机字符串和 MD5 哈希：** 用于生成临时文件名和进行一些操作。
3.  **生成 JSP 代码：**生成用于将文件重命名并执行的JSP Header和JSP Footer,其中JSP Footer包含冰蝎payload。
4.  **发送 GET 请求：**  向目标服务器发送 GET 请求，触发漏洞利用。构造特定的 URL，访问恶意文件，触发 JSP 编译，执行恶意代码。
5.  **并发执行：** 使用线程池并发发送请求，以增加利用成功的概率。

**投毒风险分析：**

该脚本的主要目的是利用 CVE-2024-50379 漏洞，实现远程代码执行。 但是，在 `generate_jsp_footer` 函数中，默认情况下包含一个冰蝎 payload。如果使用者不了解这段代码的作用，可能会在不知情的情况下植入后门。

-   **投毒代码：** `generate_jsp_footer` 函数中默认包含冰蝎 payload。
-   **风险评估：** 冰蝎是一个流行的 webshell 工具，攻击者可以使用它来远程管理服务器，执行任意命令，上传和下载文件等。

因此，该脚本存在一定的投毒风险，使用者需要仔细检查代码，确保自己了解每一部分代码的作用。特别是 `generate_jsp_footer` 函数，使用者可以自定义 `custom_content` 参数，替换默认的冰蝎 payload。

**投毒风险比例：** 10%（主要风险在于使用者不了解默认 payload 的作用，在不知情的情况下使用）。


**项目地址:** [lizhianyuguangming/CVE-2024-50379-exp](https://github.com/lizhianyuguangming/CVE-2024-50379-exp)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #13

**来源**: [CVE-2024-50379-ph0ebus_Tomcat-CVE-2024-50379-Poc.md](../2024/CVE-2024-50379-ph0ebus_Tomcat-CVE-2024-50379-Poc.md)

# CVE-2024-50379

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-50379-Alchemist3dot14_CVE-2024-50379.md](../2024/CVE-2024-50379-Alchemist3dot14_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1
10.1.0-M1 <= version <= 10.1.33
9.0.0.M1 <= version <= 9.0.97

**利用条件:** 1. 存在大小写不敏感的文件系统。
2. 默认Servlet开启写入功能(非默认配置)。
3. 目标服务器存在/uploads目录且可写。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中 JSP 编译期间的 Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认 servlet 启用写入（非默认配置）且文件系统不区分大小写时，攻击者可以利用此漏洞实现远程代码执行。该 PoC 代码通过上传包含恶意代码的 JSP shell 到可写目录（如/uploads）并利用该 shell 执行任意系统命令来演示漏洞利用过程。需要注意的是,PoC代码中定义了BASE_URL、UPLOAD_ENDPOINT、SHELL_NAME和SHELL_CONTENT等变量，如果攻击者修改了SHELL_CONTENT内容添加了恶意程序，可能会对目标系统造成其他安全威胁。尽管 PoC 本身是为了演示漏洞，但确实存在被滥用进行恶意攻击的风险。该PoC的投毒风险主要来自修改后的JSP shell, 例如执行反弹shell或下载执行其他恶意程序。代码中虽然没有明显的恶意投毒代码，但是存在一定风险，例如JSP shell执行命令时的注入，或对服务器的其他操作等，所以投毒风险评为10%。

**项目地址:** [Alchemist3dot14/CVE-2024-50379](https://github.com/Alchemist3dot14/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #2

**来源**: [CVE-2024-50379-JFOZ1010_Nuclei-Template-CVE-2024-50379.md](../2024/CVE-2024-50379-JFOZ1010_Nuclei-Template-CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition 导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false，且文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是一个Apache Tomcat中的TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞。当Tomcat的默认Servlet的`readonly`参数设置为`false`时（非默认配置），攻击者可以通过上传一个JSP文件，并在Tomcat编译该JSP文件时，通过竞争条件替换该文件为恶意JSP文件，从而实现远程代码执行。

**漏洞利用方式：**

1.  **条件满足：**  确保目标Tomcat实例的默认Servlet的`readonly`参数已设置为`false`。这意味着允许通过默认Servlet上传文件。
2.  **上传JSP文件：**  首先上传一个良性的JSP文件，例如`hello.jsp`，其中包含一些基本代码，比如打印"Hello, World!"。
3.  **竞争条件：**  在Tomcat编译`hello.jsp`文件时，攻击者迅速上传一个恶意的JSP文件，比如`HELLO.JSP`（注意大小写差异，利用文件系统大小写不敏感的特性），其中包含执行任意命令的代码（例如，启动计算器）。
4.  **远程代码执行：**  如果竞争成功，Tomcat会编译并执行恶意的`HELLO.JSP`文件，从而导致远程代码执行。

**POC分析：**

提供的Nuclei模板`CVE-2024-50379.yaml` 旨在自动化此漏洞的检测。它通过以下步骤工作：

1.  上传一个包含 "Hello, World!" 的良性JSP文件 (`hello.jsp`) 到 `/upload.jsp` 。
2.  快速上传一个包含恶意代码的JSP文件 (`HELLO.JSP`) 到 `/uploads/upload.jsp` 。这个恶意JSP包含执行计算器的代码片段 `Runtime.getRuntime().exec("calc.exe");`。
3.  尝试访问上传的文件 (`/uploads/hello.jsp`) ，并检查响应是否包含预期的输出或错误信息。

**投毒风险分析：**

虽然提供的POC代码本身旨在利用漏洞，而非植入后门，但仍然存在一些潜在的投毒风险：

*   **文件名大小写混淆:**  利用了大小写不敏感的文件系统, 可能存在编码问题或文件系统差异导致POC失效, 但不属于后门或投毒代码
*   **自定义恶意JSP：**  用户在使用POC时，可能会修改恶意JSP文件中的代码，以执行其他恶意操作，例如上传webshell或执行更隐蔽的命令。这取决于用户自身行为，不属于POC作者投毒。
*   **依赖外部资源：**  虽然当前的POC没有直接依赖外部资源，但如果用户修改POC并添加对外部资源的依赖（例如，下载恶意脚本），则可能引入投毒风险。
*   **README.md中的免责声明：** README明确说明了使用该模板的伦理责任，并强调只能在授权环境下使用。这在一定程度上降低了作者恶意使用的可能性。

综合考虑，尽管存在一些潜在的风险，但该仓库中直接包含作者有意植入的投毒代码的可能性较低。投毒风险主要来自于用户对POC的修改和使用方式。 因此，我给出的投毒风险概率是10%。

**项目地址:** [JFOZ1010/Nuclei-Template-CVE-2024-50379](https://github.com/JFOZ1010/Nuclei-Template-CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #3

**来源**: [CVE-2024-50379-SleepingBag945_CVE-2024-50379.md](../2024/CVE-2024-50379-SleepingBag945_CVE-2024-50379.md)

## CVE-2024-50379 - Apache Tomcat TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 竞争条件导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可远程执行任意代码

**影响版本:** 9.0.0.M1 <= version <= 9.0.97, 10.1.0-M1 <= version <= 10.1.33, 11.0.0-M1 <= version <= 11.0.1

**利用条件:** 1. Apache Tomcat 存在漏洞版本;2. 运行在大小写不敏感的文件系统上; 3. 默认 Servlet 启用了写入功能 (非默认配置)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞，存在于 JSP 编译过程中。当 Tomcat 运行在大小写不敏感的文件系统上，且默认 Servlet 启用写入功能时（这是一个非默认配置），攻击者可以通过竞争条件绕过安全检查，上传恶意 JSP 文件并执行，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  攻击者利用竞争条件，在 Tomcat 检查文件类型之后、编译之前，修改已上传文件的内容。
2.  由于 Tomcat 存在 TOCTOU 漏洞，因此可以绕过安全检查，导致恶意 JSP 代码被执行。
3.  漏洞利用代码（PoC）`main.go`是一个Go程序，它通过并发发送请求来触发竞争条件，上传一个包含恶意代码的JSP文件。它使用`fasthttp`库发送HTTP请求，利用`ants/v2`库管理并发连接池。

**投毒风险分析：**

代码整体结构较为清晰，主要功能是利用漏洞，并未发现明显的恶意代码。可能的投毒风险在于作者使用的第三方库是否安全，或者作者是否在不显眼的地方添加了恶意代码。风险评估：

*   **第三方库风险：** 代码依赖`github.com/valyala/fasthttp`和`github.com/panjf2000/ants/v2`两个库。需要检查这些库是否存在已知的安全问题。作者替换了`fasthttp`库，需要仔细检查替换的`fasthttp`代码是否存在恶意代码。
*   **代码逻辑风险：** 代码逻辑相对简单，主要就是发送请求，没有发现明显的植入后门的地方。

因此，综合来看，投毒的可能性较低，风险值设定为10%。主要风险还是在于对作者修改过的`fasthttp`库的审核，需要人工进行安全审计。

**项目地址:** [SleepingBag945/CVE-2024-50379](https://github.com/SleepingBag945/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #4

**来源**: [CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 需要目标系统为大小写不敏感的文件系统，且default servlet的write权限开启（非默认配置）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞。此漏洞出现在 JSP 编译过程中，允许在大小写不敏感的文件系统上进行远程代码执行（RCE），前提是默认 servlet 启用了写入权限（非默认配置）。

**漏洞利用方式：**

1.  攻击者上传一个包含恶意 JSP 代码的文件，该文件旨在执行任意命令。
2.  由于 TOCTOU 漏洞，Tomcat 在检查文件和实际编译文件之间存在时间差。
3.  攻击者利用这个时间差，通过竞争条件来修改或替换上传的文件内容。
4.  如果攻击成功，Tomcat 将编译并执行恶意 JSP 代码，从而导致远程代码执行。

**POC代码分析：**

提供的POC代码 (`Exploit-poc.py`) 旨在自动化利用此漏洞的过程。它执行以下操作：

1.  **上传Payload:** 使用`PUT`请求将包含恶意代码的JSP文件（`rce.jsp`）上传到目标服务器。
2.  **触发Payload:** 使用`GET`请求访问上传的JSP文件，触发服务器执行JSP中的恶意代码。

该脚本允许指定单个目标URL或包含目标URL列表的文件，并使用多线程来加速漏洞利用过程。

**有效性：**

根据漏洞信息和搜索结果，POC代码是有效的，可以利用该漏洞在满足特定条件的目标系统上执行远程代码。

**投毒风险：**

虽然POC代码本身主要是为了验证和利用漏洞，但仍然存在一定的投毒风险。`JSP_PAYLOAD` 变量允许攻击者自定义执行的命令，如果攻击者上传的Payload包含恶意代码，可能会对目标系统造成损害。例如，Payload可以执行系统命令、修改文件或窃取敏感数据。
此外，脚本中 `if resp.status_code == 200 and "root" in resp.text.lower():` 判断是否存在漏洞利用成功，这里存在一定的概率作者可能存在恶意的判断，导致虽然命令执行成功，但无法正确显示出来，从而导致攻击者判断失误，后续进行恶意操作。

综合评估，该仓库中存在一定程度的投毒风险，风险概率约为10%。主要是考虑到代码作者可以通过构造Payload来影响目标系统，或通过不准确的判断结果来迷惑攻击者。

**项目地址:** [Yuri08loveElaina/CVE-2024-50379-POC](https://github.com/Yuri08loveElaina/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #5

**来源**: [CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379.md](../2024/CVE-2024-50379-Yuri08loveElaina_CVE-2024-50379.md)

## CVE-2024-50379 - Apache Tomcat JSP 编译 TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** 9.0.0.M1 - 9.0.97, 10.1.0-M1 - 10.1.33, 11.0.0-M1 - 11.0.1

**利用条件:** 默认Servlet启用写入（非默认配置），大小写不敏感的文件系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU（Time-of-check Time-of-use）竞争条件漏洞，发生在 JSP 编译期间。如果满足以下条件，则可能导致远程代码执行：

1.  **默认 Servlet 启用写入：** Tomcat 的默认 Servlet 允许写入，这不是默认配置，需要手动开启。
2.  **大小写不敏感的文件系统：** 操作系统使用大小写不敏感的文件系统（例如 Windows）。

**漏洞利用方式：**

攻击者通过上传恶意 JSP 文件（例如 aa.Jsp 和 bb.Jsp）并利用并发请求触发 TOCTOU 漏洞。具体来说，攻击者会并发地发送 PUT 和 GET 请求到 Tomcat 服务器。PUT 请求用于上传包含恶意代码的 JSP 文件，GET 请求用于访问这些 JSP 文件。由于竞争条件，Tomcat 可能会在文件检查后、实际执行文件之前，将文件误判为安全，从而导致恶意代码被执行。

漏洞利用代码 `exploit.py` 模拟了这种攻击方式，它并发地向目标 URL 发送 PUT 和 GET 请求，尝试上传和执行包含反弹 shell 代码的 JSP 文件。代码中使用了多线程来增加竞争成功的概率。

**有效性：**

根据漏洞描述和搜索结果，POC代码在满足特定条件（默认 Servlet 启用写入，大小写不敏感的文件系统）下有效。它利用了并发请求来触发 TOCTOU 漏洞，从而允许远程代码执行。

**投毒风险：**

查看提供的代码，发现该代码的功能是尝试利用 CVE-2024-50379 漏洞进行远程代码执行。代码本身实现了并发上传和访问JSP文件，并通过反弹shell执行恶意代码。**该代码的目的是进行漏洞验证和利用，而不是植入恶意后门**。因此，认为该代码存在投毒风险的可能性极低，判定为0%。

搜索结果也表明该漏洞利用涉及竞争条件，需要并发执行 PUT 和 GET 请求才能成功利用。这与 POC 代码的实现方式相符。

**项目地址:** [Yuri08loveElaina/CVE-2024-50379](https://github.com/Yuri08loveElaina/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #6

**来源**: [CVE-2024-50379-carefreegarb_CVE-2024-50379.md](../2024/CVE-2024-50379-carefreegarb_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可以导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 1. 目标系统为大小写不敏感的文件系统。
2. Tomcat的default servlet的readonly参数设置为false（非默认配置，允许写入）。
3. 存在网络访问Tomcat服务器的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是Apache Tomcat中的一个Time-of-Check Time-of-Use (TOCTOU)竞争条件漏洞。当满足以下条件时，攻击者可以利用此漏洞在服务器上执行任意代码：

*   **环境要求:** 目标系统使用大小写不敏感的文件系统，并且default servlet的`readonly`参数设置为`false`。
*   **漏洞原理:** 在JSP编译期间，Tomcat存在一个竞争条件。攻击者可以在Tomcat检查文件是否存在和可写之后，但在实际编译之前，替换JSP文件。通过精心构造JSP文件，攻击者可以上传恶意代码，并在服务器上执行。
*   **利用方式:**  提供的POC代码是一个Go程序，它利用多线程并发上传恶意JSP文件，从而触发竞争条件。该POC接受目标URL、包含恶意代码的JSP文件路径以及目标服务器上保存的文件名/路径作为参数。
*   **有效性:** 根据搜索结果和POC代码，该漏洞利用是有效的，可以实现远程代码执行。
*   **投毒风险评估:** 提供的代码中存在一定的投毒风险。虽然主要功能是实现漏洞利用，但作者可能在代码中添加一些不明显的后门或者恶意行为。代码中包含`replace github.com/valyala/fasthttp v1.58.0 => ./fasthttp`。使用本地修改过的 `fasthttp` 库存在潜在风险，恶意作者可能在修改后的库中植入后门。因此，对于此类来源不明的代码，需要进行代码审计，才能确保其安全性。综合考虑，存在10%的投毒风险。

**项目地址:** [carefreegarb/CVE-2024-50379](https://github.com/carefreegarb/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #7

**来源**: [CVE-2024-50379-dear-cell_CVE-2024-50379.md](../2024/CVE-2024-50379-dear-cell_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认servlet配置为可写(非默认配置)，文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 servlet 配置为可写（非默认配置）且文件系统大小写不敏感时，攻击者可以通过竞争条件在JSP编译期间执行任意代码，导致远程代码执行（RCE）。

**漏洞利用方式：**

1.  **竞争条件：** 利用JSP编译过程中的TOCTOU漏洞，通过并发请求修改正在编译的文件。
2.  **PUT请求：** POC代码使用PUT方法尝试上传JSP文件到目标URL（/asd.Jsp 和 /qwe.Jsp）。
3.  **GET请求：** POC代码也使用GET请求访问JSP文件。
4.  **1.jsp和2.jsp:** POC利用了 /1.jsp 和 /2.jsp 文件，其中2.jsp 似乎动态生成jsp马，写入到/1.jsp.
5.  **并发执行：** 使用线程池并发执行PUT和GET请求，增加竞争成功的概率。
6.  **Payload：**  `upload.txt` 文件包含JSP payload，用于写入恶意代码。

**有效性评估：**

根据漏洞描述，搜索引擎结果和POC代码，该漏洞利用是有效的。POC代码尝试利用竞争条件上传包含恶意代码的JSP文件。

**投毒风险评估：**

POC代码本身的主要目的是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **恶意Payload：**`upload.txt` 文件中的payload可能包含恶意代码，如果使用者不检查该文件内容直接运行POC，可能会在目标系统上植入后门。
2.  **隐藏逻辑：** 脚本中可能存在隐蔽的后门代码, 虽然代码主要逻辑围绕竞争和JSP上传, 但不能完全排除作者添加额外恶意行为的可能性, 虽然可能性较低。
3.  **依赖风险：**虽然代码本身没有直接的外部依赖，如果`upload.txt`来自于外部，那风险就变得不可控。
总体来说，投毒风险较低，大约5%，但需要仔细审查`upload.txt`的内容，确保其安全性。

**建议：**
* 升级到Tomcat 11.0.2, 10.1.34 或 9.0.98。
* 禁用默认servlet的写入权限。
* 仔细审查并测试POC代码，确保理解其行为，避免未知的风险。

**项目地址:** [dear-cell/CVE-2024-50379](https://github.com/dear-cell/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #8

**来源**: [CVE-2024-50379-dkstar11q_CVE-2024-50379-nuclei.md](../2024/CVE-2024-50379-dkstar11q_CVE-2024-50379-nuclei.md)

## CVE-2024-50379-ApacheTomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 Servlet 启用写入且文件系统不区分大小写时，在 JSP 编译期间可能导致远程代码执行。

**漏洞利用方式：**
1.  攻击者利用PUT方法上传一个JSP文件到一个可写目录。
2.  由于TOCTOU漏洞，在Tomcat检查文件类型和实际编译文件之间存在时间差，攻击者可以利用竞争条件，上传恶意JSP文件绕过检查。
3.  上传的JSP文件会被当做可执行文件执行，从而导致远程代码执行。

**POC有效性：**
提供的`poc.py`脚本通过多线程并发上传包含恶意代码的JSP文件，利用竞争条件触发漏洞。该脚本首先检查目标是否允许PUT请求，然后通过PUT上传一个payload，该payload用于将webshell写入指定路径，最后GET请求访问该webshell，如果返回200则验证成功

**投毒风险评估：**
该仓库中是否存在投毒代码的可能性较低。`poc.py`的主要功能是利用漏洞上传和执行webshell。虽然webshell本身具有潜在的风险，但它属于漏洞利用的范畴，并不构成“投毒”。脚本的功能相对明确，没有发现隐藏的恶意行为。考虑到脚本的开源性质以及其目标是漏洞利用，作者隐藏恶意代码的可能性较低，但不能完全排除，因此评估的投毒风险为1%。

**项目地址:** [dkstar11q/CVE-2024-50379-nuclei](https://github.com/dkstar11q/CVE-2024-50379-nuclei)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #9

**来源**: [CVE-2024-50379-dragonked2_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-dragonked2_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个时间检查/时间使用 (TOCTOU) 竞争条件漏洞。该漏洞出现在 JSP 编译期间，当默认 servlet 启用了写入（非默认配置）且文件系统大小写不敏感时，允许远程代码执行 (RCE)。攻击者可以利用此漏洞上传一个文件，并通过竞争条件使其被 Tomcat 作为 JSP 文件执行，从而导致任意代码执行。提供的代码段是 Apache 2.0 许可协议，并非漏洞利用代码本身，因此无法直接验证 POC 的有效性。但根据搜索结果，存在公开的POC，可以利用。由于提供的代码只是许可协议，不包含恶意代码，因此投毒风险为0%。利用方式如下：

1.  **上传恶意文件：** 攻击者上传一个恶意文件，该文件伪装成 JSP 文件，但实际上包含恶意代码。
2.  **竞争条件：** 攻击者利用 TOCTOU 漏洞，在 Tomcat 检查文件类型和实际编译文件之间制造时间差。
3.  **绕过检查：** 在检查通过后，攻击者通过某种方式修改文件内容，使其成为真正的 JSP 文件，并包含恶意代码。
4.  **远程代码执行：** Tomcat 编译并执行该 JSP 文件，从而导致远程代码执行。

**项目地址:** [dragonked2/CVE-2024-50379-POC](https://github.com/dragonked2/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #10

**来源**: [CVE-2024-50379-gomtaengi_CVE-2024-50379-exp.md](../2024/CVE-2024-50379-gomtaengi_CVE-2024-50379-exp.md)

## CVE-2024-50379 - Apache Tomcat TOCTOU 竞争条件 RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 9.0.0.M1 - 9.0.97, 10.1.0-M1 - 10.1.33, 11.0.0-M1 - 11.0.1

**利用条件:** 默认 servlet 启用写入 (非默认配置)且运行在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是 Apache Tomcat 中 JSP 编译期间发生的 Time-of-check Time-of-use (TOCTOU) 竞争条件漏洞。当默认 servlet 启用写入时，攻击者可以通过上传包含恶意 JSP 代码的文件并利用竞争条件来触发 Tomcat 解析和执行它，从而实现远程代码执行。

**利用方式：**

1.  **上传恶意 JSP 文件：** 攻击者首先上传一个名为 `test01_{random_suffix}.txt` 的文件，其中包含JSP Footer代码，该代码的功能是接收通过请求头传递的base64编码的payload，然后通过AES解密后加载到内存中执行。
2.  **利用竞争条件：** 攻击者利用竞争条件，尝试在 Tomcat 将上传的 `.txt` 文件识别为普通文本文件之前，将其重命名为 `.jsp` 文件。这需要同时发送大量的请求。
3.  **JSP 编译和执行：** 如果竞争成功，Tomcat 将尝试编译并执行该 `.jsp` 文件，从而允许攻击者执行任意代码。

**POC代码分析：**

提供的 Python POC 脚本旨在自动化利用此漏洞。脚本执行以下步骤：

1.  **生成随机字符串和哈希：** 生成随机后缀和 MD5 哈希值，用于生成唯一的临时文件名和最终的 JSP 文件名。
2.  **生成 JSP 内容：** 生成包含将源文件复制到目标文件的 JSP 代码。
3.  **发送 PUT 请求：** 使用生成的随机文件名将恶意 JSP 内容上传到服务器。 通过PUT上传t1{random_suffix}.Txt和t2{random_suffix}.Txt为JSP Footer内容，t1{random_suffix}.Jsp和t2{random_suffix}.Jsp为JSP Header内容。
4.  **发送 GET 请求：** 发送GET请求, 检查目标JSP是否存在.
5.  **多线程并发：** 使用多线程并发来增加竞争条件成功的可能性。
6.  **停止机制:**  一旦发现漏洞则停止扫描.

**投毒风险分析：**

代码中存在一定的投毒风险，主要集中在以下几个方面：

1.  **JSP Footer 的自定义内容：** 脚本允许用户通过 `-f` 或 `--footer` 参数指定自定义的 JSP footer 内容。 如果攻击者指定了恶意的 JSP 代码，则可能导致被攻击的服务器受到进一步的损害。 但这是参数问题，不是代码本身的问题。
2.  **Payload 执行：** JSP Footer 中的恶意代码功能是通过请求头传递加密的payload，并将其加载到内存中执行。攻击者可以通过控制请求头来执行任意代码。尽管这本身就是漏洞利用的一部分，但如果攻击者能够注入额外的恶意代码，则可能导致更严重的后果。

**总结：**

该漏洞利用的有效性较高，但也依赖于特定的配置（默认 servlet 启用写入）和文件系统类型（大小写不敏感）。POC 代码可以有效利用此漏洞，但存在一定的投毒风险，用户需要谨慎使用，尤其是在指定自定义 JSP 内容时。Payload的加载和执行是漏洞利用的关键步骤。

**项目地址:** [gomtaengi/CVE-2024-50379-exp](https://github.com/gomtaengi/CVE-2024-50379-exp)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #11

**来源**: [CVE-2024-50379-iSee857_CVE-2024-50379-PoC.md](../2024/CVE-2024-50379-iSee857_CVE-2024-50379-PoC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入(非默认配置)，文件系统大小写不敏感

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379是Apache Tomcat中的一个Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认Servlet启用写入且文件系统不区分大小写时，攻击者可以通过竞争条件在JSP编译期间执行远程代码。

**漏洞利用方式：**

1.  攻击者发送PUT请求上传一个名为`aa.Jsp`的文件，包含恶意JSP代码，例如`aa<% Runtime.getRuntime().exec("calc.exe");%>`。同时上传`bb.Jsp`类似的文件。
2.  利用TOCTOU漏洞：在Tomcat检查文件类型之后，但在编译之前，攻击者通过竞争条件修改文件内容，从而绕过安全检查。
3.  Tomcat将上传的文件编译为JSP，执行其中的恶意代码，导致远程代码执行。
4.  POC代码通过多线程并发PUT和GET请求，尝试触发竞争条件，利用漏洞。

**有效性：**

提供的POC代码利用了多线程并发请求，旨在触发TOCTOU竞争条件，经验证是有效的。搜索引擎结果也表明该漏洞可被利用，并提供了相关的PoC。

**投毒风险：**

该仓库中的POC代码的主要功能是利用CVE-2024-50379漏洞进行远程代码执行的验证。  payload使用了calc.exe, 并没有发现明显的恶意行为，例如反弹shell或植入持久性后门。代码存在极小概率的投毒风险（例如，在非常隐蔽的地方插入恶意代码，或者利用竞争条件引入不可预测的行为），但这种可能性很低。基于对整个代码的审查，判断投毒风险约为1%。代码中只是用于验证漏洞的后门代码，不属于投毒代码。


**项目地址:** [iSee857/CVE-2024-50379-PoC](https://github.com/iSee857/CVE-2024-50379-PoC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #12

**来源**: [CVE-2024-50379-lizhianyuguangming_CVE-2024-50379-exp.md](../2024/CVE-2024-50379-lizhianyuguangming_CVE-2024-50379-exp.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU 竞态条件导致远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false（非默认配置），运行在大小写不敏感的文件系统上，网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 TOCTOU (Time-of-Check Time-of-Use) 竞态条件漏洞，发生在 JSP 编译期间。当 Tomcat 运行在大小写不敏感的文件系统上，并且默认 Servlet 的 `readonly` 参数设置为 `false` （这**不是默认配置**），攻击者可以通过竞态条件竞争，上传一个文件，并在 Tomcat 检查其类型之前，将其替换为恶意的 JSP 文件，从而导致远程代码执行。

**漏洞利用方式：**

1.  **先决条件：** 目标 Tomcat 实例必须配置为允许写入（`readonly=false`）。目标服务器的文件系统需要不区分大小写，如 Windows 服务器。
2.  **上传文件：** 攻击者上传一个文件，比如 `t1<random_suffix>.txt` 和 `t2<random_suffix>.txt`，包含部分 JSP 代码，为恶意JSP文件的前半部分和后半部分，用于后续组合。
3.  **竞争条件：** 攻击者发送并发请求，尝试利用 TOCTOU 漏洞。这些请求尝试在 Tomcat 检查文件类型之前，修改上传的文件。
4.  **替换文件：**  利用竞态条件，在 Tomcat 检查文件类型之后，但在实际编译之前，恶意 JSP 代码被写入到上传的文件中。
5.  **JSP 编译：** Tomcat 编译并执行恶意 JSP 代码，从而导致 RCE。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于自动化利用此漏洞。主要步骤如下：

1.  **加载目标 URL：** 从 `url.txt` 文件中读取目标 Tomcat 服务器的 URL 列表。
2.  **生成随机字符串和 MD5 哈希：** 用于生成临时文件名和进行一些操作。
3.  **生成 JSP 代码：**生成用于将文件重命名并执行的JSP Header和JSP Footer,其中JSP Footer包含冰蝎payload。
4.  **发送 GET 请求：**  向目标服务器发送 GET 请求，触发漏洞利用。构造特定的 URL，访问恶意文件，触发 JSP 编译，执行恶意代码。
5.  **并发执行：** 使用线程池并发发送请求，以增加利用成功的概率。

**投毒风险分析：**

该脚本的主要目的是利用 CVE-2024-50379 漏洞，实现远程代码执行。 但是，在 `generate_jsp_footer` 函数中，默认情况下包含一个冰蝎 payload。如果使用者不了解这段代码的作用，可能会在不知情的情况下植入后门。

-   **投毒代码：** `generate_jsp_footer` 函数中默认包含冰蝎 payload。
-   **风险评估：** 冰蝎是一个流行的 webshell 工具，攻击者可以使用它来远程管理服务器，执行任意命令，上传和下载文件等。

因此，该脚本存在一定的投毒风险，使用者需要仔细检查代码，确保自己了解每一部分代码的作用。特别是 `generate_jsp_footer` 函数，使用者可以自定义 `custom_content` 参数，替换默认的冰蝎 payload。

**投毒风险比例：** 10%（主要风险在于使用者不了解默认 payload 的作用，在不知情的情况下使用）。


**项目地址:** [lizhianyuguangming/CVE-2024-50379-exp](https://github.com/lizhianyuguangming/CVE-2024-50379-exp)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #13

**来源**: [CVE-2024-50379-pwnosec_CVE-2024-50379.md](../2024/CVE-2024-50379-pwnosec_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个时序竞态条件漏洞，发生在 JSP 编译期间。当默认 Servlet 启用写入（非默认配置）且文件系统大小写不敏感时，攻击者可以通过竞态条件竞争，上传一个 JSP 文件，使得该文件被 Tomcat 当作 JSP 文件执行，从而导致远程代码执行（RCE）。

**有效性：**
根据漏洞描述，搜索引擎结果以及提供的POC代码，可以判定该POC代码有效。

**投毒风险：**
分析提供的 Python 脚本 `exploit.py`，脚本的功能是尝试上传一个 JSP shell 到目标服务器的 `/uploads` 目录，并提供一个简单的命令行界面来执行命令。脚本本身没有明显的恶意代码。代码逻辑比较清晰，主要涉及 URL 处理、HTTP 请求和响应处理。不过，由于脚本允许远程执行任意命令，攻击者可能利用此工具进行恶意活动。

投毒风险评估：
*   核心代码无明显恶意行为：脚本的主要功能是上传和执行命令，没有发现主动删除文件、窃取信息等恶意代码。
*   潜在的滥用风险：脚本本身就是为了方便 RCE 而设计的，如果被恶意用户使用，可能造成严重危害。
*   依赖风险：脚本使用了 `requests` 库，需要确保该库本身没有安全问题。

综合来看，此仓库中作者隐藏的投毒代码的可能性较低，约为1%。风险主要在于脚本的功能本身可能被滥用。

**利用方式：**
1.  **漏洞触发前提：** Tomcat 服务器需要满足以下条件才能被利用：
    *   默认 Servlet 启用写入（`readonly` 参数设置为 `false`）。
    *   文件系统大小写不敏感。
2.  **攻击步骤：**
    *   攻击者运行提供的 `exploit.py` 脚本。
    *   脚本会提示用户输入目标 Tomcat 服务器的 base URL。
    *   脚本会尝试上传一个 JSP shell 到 `/uploads/shell.jsp`。
    *   如果 `/uploads` 目录不存在或没有正确配置，脚本仍然会继续上传尝试。
    *   上传成功后，攻击者可以通过脚本提供的命令行界面，输入任意命令，在 Tomcat 服务器上执行。
3.  **漏洞原理：**
    该漏洞是一个 TOCTOU 竞态条件漏洞，在 JSP 编译过程中，Tomcat 会检查上传的文件。攻击者利用竞态条件，在 Tomcat 检查文件之后、编译文件之前，替换文件内容为恶意的 JSP 代码，从而绕过安全检查，实现 RCE。

**项目地址:** [pwnosec/CVE-2024-50379](https://github.com/pwnosec/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #14

**来源**: [CVE-2024-50379-thunww_CVE-2024-50379.md](../2024/CVE-2024-50379-thunww_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU竞态条件导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet配置为可写（非默认配置），运行在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。此漏洞存在于 JSP 编译过程中，当 Tomcat 的默认 servlet 启用写入时（非默认配置），允许在大小写不敏感的文件系统上实现 RCE（远程代码执行）。

**漏洞利用方式：**

1.  **上传包含恶意JSP代码的文件：** 攻击者通过PUT请求上传一个以".Jsp"结尾的文件，该文件包含一个反向shell的JSP payload。注意这里的文件名是".Jsp"，首字母大写，是为了绕过某些检查。
2.  **竞态条件：** 攻击者利用并发PUT和GET请求，尝试在Tomcat检查文件扩展名和实际编译执行JSP代码之间的时间窗口内，触发竞态条件。
3.  **远程代码执行：** 如果竞态条件成功，Tomcat会将上传的文件作为JSP编译并执行，从而执行攻击者上传的恶意代码（反向shell）。

**POC代码分析：**

*   Python脚本使用`requests`库发送HTTP请求，使用`concurrent.futures`库创建线程池并发发送PUT和GET请求。
*   PUT请求上传包含恶意JSP代码的文件，目标URL为`{target_url}/{filename}.Jsp`。
*   GET请求尝试访问上传的文件，目标URL为`{target_url}/{filename}.jsp` (注意大小写)。
*   JSP payload建立与攻击者指定IP和端口的反向shell连接，从而允许攻击者远程控制服务器。

**投毒风险评估：**

此仓库中存在投毒代码的风险较低，约为10%。主要考虑因素如下：

*   **README.md中的免责声明：**  虽然README.md中声明代码仅用于研究和教育目的，但不能完全排除恶意意图。
*   **Payload的复杂性：** 虽然JSP payload本身就是一个恶意代码，但它明确指定了攻击者的IP地址和端口。这使得payload更容易被检测和分析，降低了隐藏恶意代码的可能性。
*   **仓库的活跃度：**  看起来这是一个个人项目，readme内容还未完成，作者可能会加入其他恶意代码的可能性无法排除。

**有效性：**

提供的PoC代码应该是有效的，因为它利用了已知的漏洞利用方法，并且利用了并发来增加竞态条件成功的机会。然而，成功利用此漏洞取决于目标Tomcat实例的配置（默认servlet是否可写）和文件系统的大小写敏感性。攻击者需要在运行POC前，将JSP Payload中的IP地址更换成自己的IP地址，并监听4444端口，才能成功拿到shell.

**项目地址:** [thunww/CVE-2024-50379](https://github.com/thunww/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #15

**来源**: [CVE-2024-50379-v3153_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-v3153_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 需要在大小写不敏感的文件系统上运行，且Default Servlet开启了写入权限 (非默认配置)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是Apache Tomcat中JSP编译期间的TOCTOU竞争条件漏洞。 在大小写不敏感的文件系统（如Windows）上，如果Default Servlet被配置为允许写入（这并非默认配置），则可能导致远程代码执行。

**有效性：**
提供的POC代码是有效的，它展示了如何利用TOCTOU竞争条件漏洞。 POC通过上传JSP文件，然后迅速替换为大小写不同的相同文件名的JSP文件，从而利用文件系统的大小写不敏感性覆盖原始文件。

**投毒风险：**
该漏洞利用代码的投毒风险较低，约为10%。主要风险在于upload.jsp 中上传路径是可控的，有可能被修改指向其他目录，导致拒绝服务。

**利用方式：**
1.  **环境准备：**  目标系统必须运行在大小写不敏感的文件系统上（例如Windows）。同时，Tomcat的Default Servlet必须配置为允许写入，这需要修改`web.xml`。
2.  **上传恶意JSP文件：**  首先，上传一个JSP文件（例如`file.jsp`），该文件包含恶意代码，比如执行系统命令。
3.  **竞争条件利用：**  在上传`file.jsp`后，立即尝试上传一个大小写不同的同名文件（例如`FILE.JSP`）。由于文件系统的大小写不敏感性，后上传的文件会覆盖之前的文件。
4.  **代码执行：**  Tomcat会尝试编译和执行新上传的JSP文件，从而执行攻击者注入的恶意代码。

**总结：**
此漏洞利用的关键在于利用TOCTOU竞争条件和文件系统的大小写不敏感性，绕过Tomcat的安全检查，最终实现远程代码执行。

**项目地址:** [v3153/CVE-2024-50379-POC](https://github.com/v3153/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #16

**来源**: [CVE-2024-50379-yiliufeng168_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-yiliufeng168_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU 竞争条件导致RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false（允许写入），运行在大小写不敏感的文件系统上（如Windows）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认Servlet配置为可写（非默认配置），且运行在大小写不敏感的文件系统上时，攻击者可以利用此漏洞实现远程代码执行。

**有效性：**
提供的 POC 代码有效。它利用了 TOCTOU 漏洞，通过上传一个 JSP 文件，然后快速替换为大小写不同的同名文件，在大小写不敏感的文件系统上绕过检查，最终执行恶意代码。

**投毒风险：**
该仓库的投毒风险较低。虽然代码提供了RCE的手段，但主要集中在利用漏洞本身，而非植入额外的恶意代码。`hello.jsp`只是一个演示用的后门文件，用于验证漏洞的存在。`upload.jsp`文件上传功能存在被恶意利用的可能，因此存在很小的投毒风险。

**利用方式：**
1.  **配置条件：** 目标 Tomcat 服务器必须满足以下条件：
    *   运行在大小写不敏感的文件系统上（如 Windows）。
    *   默认 Servlet 的 `readonly` 参数设置为 `false`，允许上传文件。
2.  **上传 JSP 文件：** 攻击者首先上传一个 JSP 文件（例如，`file.jsp`），该文件包含恶意代码。
3.  **竞争条件：** 攻击者快速将上传的文件替换为大小写不同的同名文件（例如，`FILE.JSP`）。由于文件系统大小写不敏感，原始文件将被覆盖。
4.  **代码执行：** 当 Tomcat 尝试编译和执行 JSP 文件时，会执行攻击者上传的恶意代码，导致远程代码执行。

**参考信息：**
搜索结果中多个链接（例如，vulcan.io, wiz.io, redhat.com, nvd.nist.gov, medium.com, sangfor.com, mend.io, cvedetails.com）均证实了该漏洞的存在以及 RCE 的可能性，并提供了修复建议。

**项目地址:** [yiliufeng168/CVE-2024-50379-POC](https://github.com/yiliufeng168/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---



---

## POC #14

**来源**: [CVE-2024-50379-pwnosec_CVE-2024-50379.md](../2024/CVE-2024-50379-pwnosec_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个时序竞态条件漏洞，发生在 JSP 编译期间。当默认 Servlet 启用写入（非默认配置）且文件系统大小写不敏感时，攻击者可以通过竞态条件竞争，上传一个 JSP 文件，使得该文件被 Tomcat 当作 JSP 文件执行，从而导致远程代码执行（RCE）。

**有效性：**
根据漏洞描述，搜索引擎结果以及提供的POC代码，可以判定该POC代码有效。

**投毒风险：**
分析提供的 Python 脚本 `exploit.py`，脚本的功能是尝试上传一个 JSP shell 到目标服务器的 `/uploads` 目录，并提供一个简单的命令行界面来执行命令。脚本本身没有明显的恶意代码。代码逻辑比较清晰，主要涉及 URL 处理、HTTP 请求和响应处理。不过，由于脚本允许远程执行任意命令，攻击者可能利用此工具进行恶意活动。

投毒风险评估：
*   核心代码无明显恶意行为：脚本的主要功能是上传和执行命令，没有发现主动删除文件、窃取信息等恶意代码。
*   潜在的滥用风险：脚本本身就是为了方便 RCE 而设计的，如果被恶意用户使用，可能造成严重危害。
*   依赖风险：脚本使用了 `requests` 库，需要确保该库本身没有安全问题。

综合来看，此仓库中作者隐藏的投毒代码的可能性较低，约为1%。风险主要在于脚本的功能本身可能被滥用。

**利用方式：**
1.  **漏洞触发前提：** Tomcat 服务器需要满足以下条件才能被利用：
    *   默认 Servlet 启用写入（`readonly` 参数设置为 `false`）。
    *   文件系统大小写不敏感。
2.  **攻击步骤：**
    *   攻击者运行提供的 `exploit.py` 脚本。
    *   脚本会提示用户输入目标 Tomcat 服务器的 base URL。
    *   脚本会尝试上传一个 JSP shell 到 `/uploads/shell.jsp`。
    *   如果 `/uploads` 目录不存在或没有正确配置，脚本仍然会继续上传尝试。
    *   上传成功后，攻击者可以通过脚本提供的命令行界面，输入任意命令，在 Tomcat 服务器上执行。
3.  **漏洞原理：**
    该漏洞是一个 TOCTOU 竞态条件漏洞，在 JSP 编译过程中，Tomcat 会检查上传的文件。攻击者利用竞态条件，在 Tomcat 检查文件之后、编译文件之前，替换文件内容为恶意的 JSP 代码，从而绕过安全检查，实现 RCE。

**项目地址:** [pwnosec/CVE-2024-50379](https://github.com/pwnosec/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #15

**来源**: [CVE-2024-50379-thunww_CVE-2024-50379.md](../2024/CVE-2024-50379-thunww_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU竞态条件导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet配置为可写（非默认配置），运行在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。此漏洞存在于 JSP 编译过程中，当 Tomcat 的默认 servlet 启用写入时（非默认配置），允许在大小写不敏感的文件系统上实现 RCE（远程代码执行）。

**漏洞利用方式：**

1.  **上传包含恶意JSP代码的文件：** 攻击者通过PUT请求上传一个以".Jsp"结尾的文件，该文件包含一个反向shell的JSP payload。注意这里的文件名是".Jsp"，首字母大写，是为了绕过某些检查。
2.  **竞态条件：** 攻击者利用并发PUT和GET请求，尝试在Tomcat检查文件扩展名和实际编译执行JSP代码之间的时间窗口内，触发竞态条件。
3.  **远程代码执行：** 如果竞态条件成功，Tomcat会将上传的文件作为JSP编译并执行，从而执行攻击者上传的恶意代码（反向shell）。

**POC代码分析：**

*   Python脚本使用`requests`库发送HTTP请求，使用`concurrent.futures`库创建线程池并发发送PUT和GET请求。
*   PUT请求上传包含恶意JSP代码的文件，目标URL为`{target_url}/{filename}.Jsp`。
*   GET请求尝试访问上传的文件，目标URL为`{target_url}/{filename}.jsp` (注意大小写)。
*   JSP payload建立与攻击者指定IP和端口的反向shell连接，从而允许攻击者远程控制服务器。

**投毒风险评估：**

此仓库中存在投毒代码的风险较低，约为10%。主要考虑因素如下：

*   **README.md中的免责声明：**  虽然README.md中声明代码仅用于研究和教育目的，但不能完全排除恶意意图。
*   **Payload的复杂性：** 虽然JSP payload本身就是一个恶意代码，但它明确指定了攻击者的IP地址和端口。这使得payload更容易被检测和分析，降低了隐藏恶意代码的可能性。
*   **仓库的活跃度：**  看起来这是一个个人项目，readme内容还未完成，作者可能会加入其他恶意代码的可能性无法排除。

**有效性：**

提供的PoC代码应该是有效的，因为它利用了已知的漏洞利用方法，并且利用了并发来增加竞态条件成功的机会。然而，成功利用此漏洞取决于目标Tomcat实例的配置（默认servlet是否可写）和文件系统的大小写敏感性。攻击者需要在运行POC前，将JSP Payload中的IP地址更换成自己的IP地址，并监听4444端口，才能成功拿到shell.

**项目地址:** [thunww/CVE-2024-50379](https://github.com/thunww/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #16

**来源**: [CVE-2024-50379-v3153_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-v3153_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 需要在大小写不敏感的文件系统上运行，且Default Servlet开启了写入权限 (非默认配置)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是Apache Tomcat中JSP编译期间的TOCTOU竞争条件漏洞。 在大小写不敏感的文件系统（如Windows）上，如果Default Servlet被配置为允许写入（这并非默认配置），则可能导致远程代码执行。

**有效性：**
提供的POC代码是有效的，它展示了如何利用TOCTOU竞争条件漏洞。 POC通过上传JSP文件，然后迅速替换为大小写不同的相同文件名的JSP文件，从而利用文件系统的大小写不敏感性覆盖原始文件。

**投毒风险：**
该漏洞利用代码的投毒风险较低，约为10%。主要风险在于upload.jsp 中上传路径是可控的，有可能被修改指向其他目录，导致拒绝服务。

**利用方式：**
1.  **环境准备：**  目标系统必须运行在大小写不敏感的文件系统上（例如Windows）。同时，Tomcat的Default Servlet必须配置为允许写入，这需要修改`web.xml`。
2.  **上传恶意JSP文件：**  首先，上传一个JSP文件（例如`file.jsp`），该文件包含恶意代码，比如执行系统命令。
3.  **竞争条件利用：**  在上传`file.jsp`后，立即尝试上传一个大小写不同的同名文件（例如`FILE.JSP`）。由于文件系统的大小写不敏感性，后上传的文件会覆盖之前的文件。
4.  **代码执行：**  Tomcat会尝试编译和执行新上传的JSP文件，从而执行攻击者注入的恶意代码。

**总结：**
此漏洞利用的关键在于利用TOCTOU竞争条件和文件系统的大小写不敏感性，绕过Tomcat的安全检查，最终实现远程代码执行。

**项目地址:** [v3153/CVE-2024-50379-POC](https://github.com/v3153/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #17

**来源**: [CVE-2024-50379-yiliufeng168_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-yiliufeng168_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU 竞争条件导致RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false（允许写入），运行在大小写不敏感的文件系统上（如Windows）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认Servlet配置为可写（非默认配置），且运行在大小写不敏感的文件系统上时，攻击者可以利用此漏洞实现远程代码执行。

**有效性：**
提供的 POC 代码有效。它利用了 TOCTOU 漏洞，通过上传一个 JSP 文件，然后快速替换为大小写不同的同名文件，在大小写不敏感的文件系统上绕过检查，最终执行恶意代码。

**投毒风险：**
该仓库的投毒风险较低。虽然代码提供了RCE的手段，但主要集中在利用漏洞本身，而非植入额外的恶意代码。`hello.jsp`只是一个演示用的后门文件，用于验证漏洞的存在。`upload.jsp`文件上传功能存在被恶意利用的可能，因此存在很小的投毒风险。

**利用方式：**
1.  **配置条件：** 目标 Tomcat 服务器必须满足以下条件：
    *   运行在大小写不敏感的文件系统上（如 Windows）。
    *   默认 Servlet 的 `readonly` 参数设置为 `false`，允许上传文件。
2.  **上传 JSP 文件：** 攻击者首先上传一个 JSP 文件（例如，`file.jsp`），该文件包含恶意代码。
3.  **竞争条件：** 攻击者快速将上传的文件替换为大小写不同的同名文件（例如，`FILE.JSP`）。由于文件系统大小写不敏感，原始文件将被覆盖。
4.  **代码执行：** 当 Tomcat 尝试编译和执行 JSP 文件时，会执行攻击者上传的恶意代码，导致远程代码执行。

**参考信息：**
搜索结果中多个链接（例如，vulcan.io, wiz.io, redhat.com, nvd.nist.gov, medium.com, sangfor.com, mend.io, cvedetails.com）均证实了该漏洞的存在以及 RCE 的可能性，并提供了修复建议。

**项目地址:** [yiliufeng168/CVE-2024-50379-POC](https://github.com/yiliufeng168/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---



---

## POC #14

**来源**: [CVE-2024-50379-pwnosec_CVE-2024-50379.md](../2024/CVE-2024-50379-pwnosec_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个时序竞态条件漏洞，发生在 JSP 编译期间。当默认 Servlet 启用写入（非默认配置）且文件系统大小写不敏感时，攻击者可以通过竞态条件竞争，上传一个 JSP 文件，使得该文件被 Tomcat 当作 JSP 文件执行，从而导致远程代码执行（RCE）。

**有效性：**
根据漏洞描述，搜索引擎结果以及提供的POC代码，可以判定该POC代码有效。

**投毒风险：**
分析提供的 Python 脚本 `exploit.py`，脚本的功能是尝试上传一个 JSP shell 到目标服务器的 `/uploads` 目录，并提供一个简单的命令行界面来执行命令。脚本本身没有明显的恶意代码。代码逻辑比较清晰，主要涉及 URL 处理、HTTP 请求和响应处理。不过，由于脚本允许远程执行任意命令，攻击者可能利用此工具进行恶意活动。

投毒风险评估：
*   核心代码无明显恶意行为：脚本的主要功能是上传和执行命令，没有发现主动删除文件、窃取信息等恶意代码。
*   潜在的滥用风险：脚本本身就是为了方便 RCE 而设计的，如果被恶意用户使用，可能造成严重危害。
*   依赖风险：脚本使用了 `requests` 库，需要确保该库本身没有安全问题。

综合来看，此仓库中作者隐藏的投毒代码的可能性较低，约为1%。风险主要在于脚本的功能本身可能被滥用。

**利用方式：**
1.  **漏洞触发前提：** Tomcat 服务器需要满足以下条件才能被利用：
    *   默认 Servlet 启用写入（`readonly` 参数设置为 `false`）。
    *   文件系统大小写不敏感。
2.  **攻击步骤：**
    *   攻击者运行提供的 `exploit.py` 脚本。
    *   脚本会提示用户输入目标 Tomcat 服务器的 base URL。
    *   脚本会尝试上传一个 JSP shell 到 `/uploads/shell.jsp`。
    *   如果 `/uploads` 目录不存在或没有正确配置，脚本仍然会继续上传尝试。
    *   上传成功后，攻击者可以通过脚本提供的命令行界面，输入任意命令，在 Tomcat 服务器上执行。
3.  **漏洞原理：**
    该漏洞是一个 TOCTOU 竞态条件漏洞，在 JSP 编译过程中，Tomcat 会检查上传的文件。攻击者利用竞态条件，在 Tomcat 检查文件之后、编译文件之前，替换文件内容为恶意的 JSP 代码，从而绕过安全检查，实现 RCE。

**项目地址:** [pwnosec/CVE-2024-50379](https://github.com/pwnosec/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #15

**来源**: [CVE-2024-50379-thunww_CVE-2024-50379.md](../2024/CVE-2024-50379-thunww_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU竞态条件导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet配置为可写（非默认配置），运行在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。此漏洞存在于 JSP 编译过程中，当 Tomcat 的默认 servlet 启用写入时（非默认配置），允许在大小写不敏感的文件系统上实现 RCE（远程代码执行）。

**漏洞利用方式：**

1.  **上传包含恶意JSP代码的文件：** 攻击者通过PUT请求上传一个以".Jsp"结尾的文件，该文件包含一个反向shell的JSP payload。注意这里的文件名是".Jsp"，首字母大写，是为了绕过某些检查。
2.  **竞态条件：** 攻击者利用并发PUT和GET请求，尝试在Tomcat检查文件扩展名和实际编译执行JSP代码之间的时间窗口内，触发竞态条件。
3.  **远程代码执行：** 如果竞态条件成功，Tomcat会将上传的文件作为JSP编译并执行，从而执行攻击者上传的恶意代码（反向shell）。

**POC代码分析：**

*   Python脚本使用`requests`库发送HTTP请求，使用`concurrent.futures`库创建线程池并发发送PUT和GET请求。
*   PUT请求上传包含恶意JSP代码的文件，目标URL为`{target_url}/{filename}.Jsp`。
*   GET请求尝试访问上传的文件，目标URL为`{target_url}/{filename}.jsp` (注意大小写)。
*   JSP payload建立与攻击者指定IP和端口的反向shell连接，从而允许攻击者远程控制服务器。

**投毒风险评估：**

此仓库中存在投毒代码的风险较低，约为10%。主要考虑因素如下：

*   **README.md中的免责声明：**  虽然README.md中声明代码仅用于研究和教育目的，但不能完全排除恶意意图。
*   **Payload的复杂性：** 虽然JSP payload本身就是一个恶意代码，但它明确指定了攻击者的IP地址和端口。这使得payload更容易被检测和分析，降低了隐藏恶意代码的可能性。
*   **仓库的活跃度：**  看起来这是一个个人项目，readme内容还未完成，作者可能会加入其他恶意代码的可能性无法排除。

**有效性：**

提供的PoC代码应该是有效的，因为它利用了已知的漏洞利用方法，并且利用了并发来增加竞态条件成功的机会。然而，成功利用此漏洞取决于目标Tomcat实例的配置（默认servlet是否可写）和文件系统的大小写敏感性。攻击者需要在运行POC前，将JSP Payload中的IP地址更换成自己的IP地址，并监听4444端口，才能成功拿到shell.

**项目地址:** [thunww/CVE-2024-50379](https://github.com/thunww/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #16

**来源**: [CVE-2024-50379-v3153_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-v3153_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 需要在大小写不敏感的文件系统上运行，且Default Servlet开启了写入权限 (非默认配置)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是Apache Tomcat中JSP编译期间的TOCTOU竞争条件漏洞。 在大小写不敏感的文件系统（如Windows）上，如果Default Servlet被配置为允许写入（这并非默认配置），则可能导致远程代码执行。

**有效性：**
提供的POC代码是有效的，它展示了如何利用TOCTOU竞争条件漏洞。 POC通过上传JSP文件，然后迅速替换为大小写不同的相同文件名的JSP文件，从而利用文件系统的大小写不敏感性覆盖原始文件。

**投毒风险：**
该漏洞利用代码的投毒风险较低，约为10%。主要风险在于upload.jsp 中上传路径是可控的，有可能被修改指向其他目录，导致拒绝服务。

**利用方式：**
1.  **环境准备：**  目标系统必须运行在大小写不敏感的文件系统上（例如Windows）。同时，Tomcat的Default Servlet必须配置为允许写入，这需要修改`web.xml`。
2.  **上传恶意JSP文件：**  首先，上传一个JSP文件（例如`file.jsp`），该文件包含恶意代码，比如执行系统命令。
3.  **竞争条件利用：**  在上传`file.jsp`后，立即尝试上传一个大小写不同的同名文件（例如`FILE.JSP`）。由于文件系统的大小写不敏感性，后上传的文件会覆盖之前的文件。
4.  **代码执行：**  Tomcat会尝试编译和执行新上传的JSP文件，从而执行攻击者注入的恶意代码。

**总结：**
此漏洞利用的关键在于利用TOCTOU竞争条件和文件系统的大小写不敏感性，绕过Tomcat的安全检查，最终实现远程代码执行。

**项目地址:** [v3153/CVE-2024-50379-POC](https://github.com/v3153/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #17

**来源**: [CVE-2024-50379-yiliufeng168_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-yiliufeng168_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU 竞争条件导致RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false（允许写入），运行在大小写不敏感的文件系统上（如Windows）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认Servlet配置为可写（非默认配置），且运行在大小写不敏感的文件系统上时，攻击者可以利用此漏洞实现远程代码执行。

**有效性：**
提供的 POC 代码有效。它利用了 TOCTOU 漏洞，通过上传一个 JSP 文件，然后快速替换为大小写不同的同名文件，在大小写不敏感的文件系统上绕过检查，最终执行恶意代码。

**投毒风险：**
该仓库的投毒风险较低。虽然代码提供了RCE的手段，但主要集中在利用漏洞本身，而非植入额外的恶意代码。`hello.jsp`只是一个演示用的后门文件，用于验证漏洞的存在。`upload.jsp`文件上传功能存在被恶意利用的可能，因此存在很小的投毒风险。

**利用方式：**
1.  **配置条件：** 目标 Tomcat 服务器必须满足以下条件：
    *   运行在大小写不敏感的文件系统上（如 Windows）。
    *   默认 Servlet 的 `readonly` 参数设置为 `false`，允许上传文件。
2.  **上传 JSP 文件：** 攻击者首先上传一个 JSP 文件（例如，`file.jsp`），该文件包含恶意代码。
3.  **竞争条件：** 攻击者快速将上传的文件替换为大小写不同的同名文件（例如，`FILE.JSP`）。由于文件系统大小写不敏感，原始文件将被覆盖。
4.  **代码执行：** 当 Tomcat 尝试编译和执行 JSP 文件时，会执行攻击者上传的恶意代码，导致远程代码执行。

**参考信息：**
搜索结果中多个链接（例如，vulcan.io, wiz.io, redhat.com, nvd.nist.gov, medium.com, sangfor.com, mend.io, cvedetails.com）均证实了该漏洞的存在以及 RCE 的可能性，并提供了修复建议。

**项目地址:** [yiliufeng168/CVE-2024-50379-POC](https://github.com/yiliufeng168/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---



---

## POC #14

**来源**: [CVE-2024-50379-pwnosec_CVE-2024-50379.md](../2024/CVE-2024-50379-pwnosec_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个时序竞态条件漏洞，发生在 JSP 编译期间。当默认 Servlet 启用写入（非默认配置）且文件系统大小写不敏感时，攻击者可以通过竞态条件竞争，上传一个 JSP 文件，使得该文件被 Tomcat 当作 JSP 文件执行，从而导致远程代码执行（RCE）。

**有效性：**
根据漏洞描述，搜索引擎结果以及提供的POC代码，可以判定该POC代码有效。

**投毒风险：**
分析提供的 Python 脚本 `exploit.py`，脚本的功能是尝试上传一个 JSP shell 到目标服务器的 `/uploads` 目录，并提供一个简单的命令行界面来执行命令。脚本本身没有明显的恶意代码。代码逻辑比较清晰，主要涉及 URL 处理、HTTP 请求和响应处理。不过，由于脚本允许远程执行任意命令，攻击者可能利用此工具进行恶意活动。

投毒风险评估：
*   核心代码无明显恶意行为：脚本的主要功能是上传和执行命令，没有发现主动删除文件、窃取信息等恶意代码。
*   潜在的滥用风险：脚本本身就是为了方便 RCE 而设计的，如果被恶意用户使用，可能造成严重危害。
*   依赖风险：脚本使用了 `requests` 库，需要确保该库本身没有安全问题。

综合来看，此仓库中作者隐藏的投毒代码的可能性较低，约为1%。风险主要在于脚本的功能本身可能被滥用。

**利用方式：**
1.  **漏洞触发前提：** Tomcat 服务器需要满足以下条件才能被利用：
    *   默认 Servlet 启用写入（`readonly` 参数设置为 `false`）。
    *   文件系统大小写不敏感。
2.  **攻击步骤：**
    *   攻击者运行提供的 `exploit.py` 脚本。
    *   脚本会提示用户输入目标 Tomcat 服务器的 base URL。
    *   脚本会尝试上传一个 JSP shell 到 `/uploads/shell.jsp`。
    *   如果 `/uploads` 目录不存在或没有正确配置，脚本仍然会继续上传尝试。
    *   上传成功后，攻击者可以通过脚本提供的命令行界面，输入任意命令，在 Tomcat 服务器上执行。
3.  **漏洞原理：**
    该漏洞是一个 TOCTOU 竞态条件漏洞，在 JSP 编译过程中，Tomcat 会检查上传的文件。攻击者利用竞态条件，在 Tomcat 检查文件之后、编译文件之前，替换文件内容为恶意的 JSP 代码，从而绕过安全检查，实现 RCE。

**项目地址:** [pwnosec/CVE-2024-50379](https://github.com/pwnosec/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #15

**来源**: [CVE-2024-50379-thunww_CVE-2024-50379.md](../2024/CVE-2024-50379-thunww_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU竞态条件导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet配置为可写（非默认配置），运行在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。此漏洞存在于 JSP 编译过程中，当 Tomcat 的默认 servlet 启用写入时（非默认配置），允许在大小写不敏感的文件系统上实现 RCE（远程代码执行）。

**漏洞利用方式：**

1.  **上传包含恶意JSP代码的文件：** 攻击者通过PUT请求上传一个以".Jsp"结尾的文件，该文件包含一个反向shell的JSP payload。注意这里的文件名是".Jsp"，首字母大写，是为了绕过某些检查。
2.  **竞态条件：** 攻击者利用并发PUT和GET请求，尝试在Tomcat检查文件扩展名和实际编译执行JSP代码之间的时间窗口内，触发竞态条件。
3.  **远程代码执行：** 如果竞态条件成功，Tomcat会将上传的文件作为JSP编译并执行，从而执行攻击者上传的恶意代码（反向shell）。

**POC代码分析：**

*   Python脚本使用`requests`库发送HTTP请求，使用`concurrent.futures`库创建线程池并发发送PUT和GET请求。
*   PUT请求上传包含恶意JSP代码的文件，目标URL为`{target_url}/{filename}.Jsp`。
*   GET请求尝试访问上传的文件，目标URL为`{target_url}/{filename}.jsp` (注意大小写)。
*   JSP payload建立与攻击者指定IP和端口的反向shell连接，从而允许攻击者远程控制服务器。

**投毒风险评估：**

此仓库中存在投毒代码的风险较低，约为10%。主要考虑因素如下：

*   **README.md中的免责声明：**  虽然README.md中声明代码仅用于研究和教育目的，但不能完全排除恶意意图。
*   **Payload的复杂性：** 虽然JSP payload本身就是一个恶意代码，但它明确指定了攻击者的IP地址和端口。这使得payload更容易被检测和分析，降低了隐藏恶意代码的可能性。
*   **仓库的活跃度：**  看起来这是一个个人项目，readme内容还未完成，作者可能会加入其他恶意代码的可能性无法排除。

**有效性：**

提供的PoC代码应该是有效的，因为它利用了已知的漏洞利用方法，并且利用了并发来增加竞态条件成功的机会。然而，成功利用此漏洞取决于目标Tomcat实例的配置（默认servlet是否可写）和文件系统的大小写敏感性。攻击者需要在运行POC前，将JSP Payload中的IP地址更换成自己的IP地址，并监听4444端口，才能成功拿到shell.

**项目地址:** [thunww/CVE-2024-50379](https://github.com/thunww/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #16

**来源**: [CVE-2024-50379-v3153_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-v3153_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 需要在大小写不敏感的文件系统上运行，且Default Servlet开启了写入权限 (非默认配置)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是Apache Tomcat中JSP编译期间的TOCTOU竞争条件漏洞。 在大小写不敏感的文件系统（如Windows）上，如果Default Servlet被配置为允许写入（这并非默认配置），则可能导致远程代码执行。

**有效性：**
提供的POC代码是有效的，它展示了如何利用TOCTOU竞争条件漏洞。 POC通过上传JSP文件，然后迅速替换为大小写不同的相同文件名的JSP文件，从而利用文件系统的大小写不敏感性覆盖原始文件。

**投毒风险：**
该漏洞利用代码的投毒风险较低，约为10%。主要风险在于upload.jsp 中上传路径是可控的，有可能被修改指向其他目录，导致拒绝服务。

**利用方式：**
1.  **环境准备：**  目标系统必须运行在大小写不敏感的文件系统上（例如Windows）。同时，Tomcat的Default Servlet必须配置为允许写入，这需要修改`web.xml`。
2.  **上传恶意JSP文件：**  首先，上传一个JSP文件（例如`file.jsp`），该文件包含恶意代码，比如执行系统命令。
3.  **竞争条件利用：**  在上传`file.jsp`后，立即尝试上传一个大小写不同的同名文件（例如`FILE.JSP`）。由于文件系统的大小写不敏感性，后上传的文件会覆盖之前的文件。
4.  **代码执行：**  Tomcat会尝试编译和执行新上传的JSP文件，从而执行攻击者注入的恶意代码。

**总结：**
此漏洞利用的关键在于利用TOCTOU竞争条件和文件系统的大小写不敏感性，绕过Tomcat的安全检查，最终实现远程代码执行。

**项目地址:** [v3153/CVE-2024-50379-POC](https://github.com/v3153/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #17

**来源**: [CVE-2024-50379-yiliufeng168_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-yiliufeng168_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU 竞争条件导致RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false（允许写入），运行在大小写不敏感的文件系统上（如Windows）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认Servlet配置为可写（非默认配置），且运行在大小写不敏感的文件系统上时，攻击者可以利用此漏洞实现远程代码执行。

**有效性：**
提供的 POC 代码有效。它利用了 TOCTOU 漏洞，通过上传一个 JSP 文件，然后快速替换为大小写不同的同名文件，在大小写不敏感的文件系统上绕过检查，最终执行恶意代码。

**投毒风险：**
该仓库的投毒风险较低。虽然代码提供了RCE的手段，但主要集中在利用漏洞本身，而非植入额外的恶意代码。`hello.jsp`只是一个演示用的后门文件，用于验证漏洞的存在。`upload.jsp`文件上传功能存在被恶意利用的可能，因此存在很小的投毒风险。

**利用方式：**
1.  **配置条件：** 目标 Tomcat 服务器必须满足以下条件：
    *   运行在大小写不敏感的文件系统上（如 Windows）。
    *   默认 Servlet 的 `readonly` 参数设置为 `false`，允许上传文件。
2.  **上传 JSP 文件：** 攻击者首先上传一个 JSP 文件（例如，`file.jsp`），该文件包含恶意代码。
3.  **竞争条件：** 攻击者快速将上传的文件替换为大小写不同的同名文件（例如，`FILE.JSP`）。由于文件系统大小写不敏感，原始文件将被覆盖。
4.  **代码执行：** 当 Tomcat 尝试编译和执行 JSP 文件时，会执行攻击者上传的恶意代码，导致远程代码执行。

**参考信息：**
搜索结果中多个链接（例如，vulcan.io, wiz.io, redhat.com, nvd.nist.gov, medium.com, sangfor.com, mend.io, cvedetails.com）均证实了该漏洞的存在以及 RCE 的可能性，并提供了修复建议。

**项目地址:** [yiliufeng168/CVE-2024-50379-POC](https://github.com/yiliufeng168/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---



---

## POC #14

**来源**: [CVE-2024-50379-pwnosec_CVE-2024-50379.md](../2024/CVE-2024-50379-pwnosec_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个时序竞态条件漏洞，发生在 JSP 编译期间。当默认 Servlet 启用写入（非默认配置）且文件系统大小写不敏感时，攻击者可以通过竞态条件竞争，上传一个 JSP 文件，使得该文件被 Tomcat 当作 JSP 文件执行，从而导致远程代码执行（RCE）。

**有效性：**
根据漏洞描述，搜索引擎结果以及提供的POC代码，可以判定该POC代码有效。

**投毒风险：**
分析提供的 Python 脚本 `exploit.py`，脚本的功能是尝试上传一个 JSP shell 到目标服务器的 `/uploads` 目录，并提供一个简单的命令行界面来执行命令。脚本本身没有明显的恶意代码。代码逻辑比较清晰，主要涉及 URL 处理、HTTP 请求和响应处理。不过，由于脚本允许远程执行任意命令，攻击者可能利用此工具进行恶意活动。

投毒风险评估：
*   核心代码无明显恶意行为：脚本的主要功能是上传和执行命令，没有发现主动删除文件、窃取信息等恶意代码。
*   潜在的滥用风险：脚本本身就是为了方便 RCE 而设计的，如果被恶意用户使用，可能造成严重危害。
*   依赖风险：脚本使用了 `requests` 库，需要确保该库本身没有安全问题。

综合来看，此仓库中作者隐藏的投毒代码的可能性较低，约为1%。风险主要在于脚本的功能本身可能被滥用。

**利用方式：**
1.  **漏洞触发前提：** Tomcat 服务器需要满足以下条件才能被利用：
    *   默认 Servlet 启用写入（`readonly` 参数设置为 `false`）。
    *   文件系统大小写不敏感。
2.  **攻击步骤：**
    *   攻击者运行提供的 `exploit.py` 脚本。
    *   脚本会提示用户输入目标 Tomcat 服务器的 base URL。
    *   脚本会尝试上传一个 JSP shell 到 `/uploads/shell.jsp`。
    *   如果 `/uploads` 目录不存在或没有正确配置，脚本仍然会继续上传尝试。
    *   上传成功后，攻击者可以通过脚本提供的命令行界面，输入任意命令，在 Tomcat 服务器上执行。
3.  **漏洞原理：**
    该漏洞是一个 TOCTOU 竞态条件漏洞，在 JSP 编译过程中，Tomcat 会检查上传的文件。攻击者利用竞态条件，在 Tomcat 检查文件之后、编译文件之前，替换文件内容为恶意的 JSP 代码，从而绕过安全检查，实现 RCE。

**项目地址:** [pwnosec/CVE-2024-50379](https://github.com/pwnosec/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #15

**来源**: [CVE-2024-50379-thunww_CVE-2024-50379.md](../2024/CVE-2024-50379-thunww_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU竞态条件导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet配置为可写（非默认配置），运行在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。此漏洞存在于 JSP 编译过程中，当 Tomcat 的默认 servlet 启用写入时（非默认配置），允许在大小写不敏感的文件系统上实现 RCE（远程代码执行）。

**漏洞利用方式：**

1.  **上传包含恶意JSP代码的文件：** 攻击者通过PUT请求上传一个以".Jsp"结尾的文件，该文件包含一个反向shell的JSP payload。注意这里的文件名是".Jsp"，首字母大写，是为了绕过某些检查。
2.  **竞态条件：** 攻击者利用并发PUT和GET请求，尝试在Tomcat检查文件扩展名和实际编译执行JSP代码之间的时间窗口内，触发竞态条件。
3.  **远程代码执行：** 如果竞态条件成功，Tomcat会将上传的文件作为JSP编译并执行，从而执行攻击者上传的恶意代码（反向shell）。

**POC代码分析：**

*   Python脚本使用`requests`库发送HTTP请求，使用`concurrent.futures`库创建线程池并发发送PUT和GET请求。
*   PUT请求上传包含恶意JSP代码的文件，目标URL为`{target_url}/{filename}.Jsp`。
*   GET请求尝试访问上传的文件，目标URL为`{target_url}/{filename}.jsp` (注意大小写)。
*   JSP payload建立与攻击者指定IP和端口的反向shell连接，从而允许攻击者远程控制服务器。

**投毒风险评估：**

此仓库中存在投毒代码的风险较低，约为10%。主要考虑因素如下：

*   **README.md中的免责声明：**  虽然README.md中声明代码仅用于研究和教育目的，但不能完全排除恶意意图。
*   **Payload的复杂性：** 虽然JSP payload本身就是一个恶意代码，但它明确指定了攻击者的IP地址和端口。这使得payload更容易被检测和分析，降低了隐藏恶意代码的可能性。
*   **仓库的活跃度：**  看起来这是一个个人项目，readme内容还未完成，作者可能会加入其他恶意代码的可能性无法排除。

**有效性：**

提供的PoC代码应该是有效的，因为它利用了已知的漏洞利用方法，并且利用了并发来增加竞态条件成功的机会。然而，成功利用此漏洞取决于目标Tomcat实例的配置（默认servlet是否可写）和文件系统的大小写敏感性。攻击者需要在运行POC前，将JSP Payload中的IP地址更换成自己的IP地址，并监听4444端口，才能成功拿到shell.

**项目地址:** [thunww/CVE-2024-50379](https://github.com/thunww/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #16

**来源**: [CVE-2024-50379-v3153_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-v3153_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 需要在大小写不敏感的文件系统上运行，且Default Servlet开启了写入权限 (非默认配置)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是Apache Tomcat中JSP编译期间的TOCTOU竞争条件漏洞。 在大小写不敏感的文件系统（如Windows）上，如果Default Servlet被配置为允许写入（这并非默认配置），则可能导致远程代码执行。

**有效性：**
提供的POC代码是有效的，它展示了如何利用TOCTOU竞争条件漏洞。 POC通过上传JSP文件，然后迅速替换为大小写不同的相同文件名的JSP文件，从而利用文件系统的大小写不敏感性覆盖原始文件。

**投毒风险：**
该漏洞利用代码的投毒风险较低，约为10%。主要风险在于upload.jsp 中上传路径是可控的，有可能被修改指向其他目录，导致拒绝服务。

**利用方式：**
1.  **环境准备：**  目标系统必须运行在大小写不敏感的文件系统上（例如Windows）。同时，Tomcat的Default Servlet必须配置为允许写入，这需要修改`web.xml`。
2.  **上传恶意JSP文件：**  首先，上传一个JSP文件（例如`file.jsp`），该文件包含恶意代码，比如执行系统命令。
3.  **竞争条件利用：**  在上传`file.jsp`后，立即尝试上传一个大小写不同的同名文件（例如`FILE.JSP`）。由于文件系统的大小写不敏感性，后上传的文件会覆盖之前的文件。
4.  **代码执行：**  Tomcat会尝试编译和执行新上传的JSP文件，从而执行攻击者注入的恶意代码。

**总结：**
此漏洞利用的关键在于利用TOCTOU竞争条件和文件系统的大小写不敏感性，绕过Tomcat的安全检查，最终实现远程代码执行。

**项目地址:** [v3153/CVE-2024-50379-POC](https://github.com/v3153/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #17

**来源**: [CVE-2024-50379-yiliufeng168_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-yiliufeng168_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU 竞争条件导致RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false（允许写入），运行在大小写不敏感的文件系统上（如Windows）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认Servlet配置为可写（非默认配置），且运行在大小写不敏感的文件系统上时，攻击者可以利用此漏洞实现远程代码执行。

**有效性：**
提供的 POC 代码有效。它利用了 TOCTOU 漏洞，通过上传一个 JSP 文件，然后快速替换为大小写不同的同名文件，在大小写不敏感的文件系统上绕过检查，最终执行恶意代码。

**投毒风险：**
该仓库的投毒风险较低。虽然代码提供了RCE的手段，但主要集中在利用漏洞本身，而非植入额外的恶意代码。`hello.jsp`只是一个演示用的后门文件，用于验证漏洞的存在。`upload.jsp`文件上传功能存在被恶意利用的可能，因此存在很小的投毒风险。

**利用方式：**
1.  **配置条件：** 目标 Tomcat 服务器必须满足以下条件：
    *   运行在大小写不敏感的文件系统上（如 Windows）。
    *   默认 Servlet 的 `readonly` 参数设置为 `false`，允许上传文件。
2.  **上传 JSP 文件：** 攻击者首先上传一个 JSP 文件（例如，`file.jsp`），该文件包含恶意代码。
3.  **竞争条件：** 攻击者快速将上传的文件替换为大小写不同的同名文件（例如，`FILE.JSP`）。由于文件系统大小写不敏感，原始文件将被覆盖。
4.  **代码执行：** 当 Tomcat 尝试编译和执行 JSP 文件时，会执行攻击者上传的恶意代码，导致远程代码执行。

**参考信息：**
搜索结果中多个链接（例如，vulcan.io, wiz.io, redhat.com, nvd.nist.gov, medium.com, sangfor.com, mend.io, cvedetails.com）均证实了该漏洞的存在以及 RCE 的可能性，并提供了修复建议。

**项目地址:** [yiliufeng168/CVE-2024-50379-POC](https://github.com/yiliufeng168/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---



---

## POC #14

**来源**: [CVE-2024-50379-pwnosec_CVE-2024-50379.md](../2024/CVE-2024-50379-pwnosec_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个时序竞态条件漏洞，发生在 JSP 编译期间。当默认 Servlet 启用写入（非默认配置）且文件系统大小写不敏感时，攻击者可以通过竞态条件竞争，上传一个 JSP 文件，使得该文件被 Tomcat 当作 JSP 文件执行，从而导致远程代码执行（RCE）。

**有效性：**
根据漏洞描述，搜索引擎结果以及提供的POC代码，可以判定该POC代码有效。

**投毒风险：**
分析提供的 Python 脚本 `exploit.py`，脚本的功能是尝试上传一个 JSP shell 到目标服务器的 `/uploads` 目录，并提供一个简单的命令行界面来执行命令。脚本本身没有明显的恶意代码。代码逻辑比较清晰，主要涉及 URL 处理、HTTP 请求和响应处理。不过，由于脚本允许远程执行任意命令，攻击者可能利用此工具进行恶意活动。

投毒风险评估：
*   核心代码无明显恶意行为：脚本的主要功能是上传和执行命令，没有发现主动删除文件、窃取信息等恶意代码。
*   潜在的滥用风险：脚本本身就是为了方便 RCE 而设计的，如果被恶意用户使用，可能造成严重危害。
*   依赖风险：脚本使用了 `requests` 库，需要确保该库本身没有安全问题。

综合来看，此仓库中作者隐藏的投毒代码的可能性较低，约为1%。风险主要在于脚本的功能本身可能被滥用。

**利用方式：**
1.  **漏洞触发前提：** Tomcat 服务器需要满足以下条件才能被利用：
    *   默认 Servlet 启用写入（`readonly` 参数设置为 `false`）。
    *   文件系统大小写不敏感。
2.  **攻击步骤：**
    *   攻击者运行提供的 `exploit.py` 脚本。
    *   脚本会提示用户输入目标 Tomcat 服务器的 base URL。
    *   脚本会尝试上传一个 JSP shell 到 `/uploads/shell.jsp`。
    *   如果 `/uploads` 目录不存在或没有正确配置，脚本仍然会继续上传尝试。
    *   上传成功后，攻击者可以通过脚本提供的命令行界面，输入任意命令，在 Tomcat 服务器上执行。
3.  **漏洞原理：**
    该漏洞是一个 TOCTOU 竞态条件漏洞，在 JSP 编译过程中，Tomcat 会检查上传的文件。攻击者利用竞态条件，在 Tomcat 检查文件之后、编译文件之前，替换文件内容为恶意的 JSP 代码，从而绕过安全检查，实现 RCE。

**项目地址:** [pwnosec/CVE-2024-50379](https://github.com/pwnosec/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #15

**来源**: [CVE-2024-50379-thunww_CVE-2024-50379.md](../2024/CVE-2024-50379-thunww_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU竞态条件导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet配置为可写（非默认配置），运行在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。此漏洞存在于 JSP 编译过程中，当 Tomcat 的默认 servlet 启用写入时（非默认配置），允许在大小写不敏感的文件系统上实现 RCE（远程代码执行）。

**漏洞利用方式：**

1.  **上传包含恶意JSP代码的文件：** 攻击者通过PUT请求上传一个以".Jsp"结尾的文件，该文件包含一个反向shell的JSP payload。注意这里的文件名是".Jsp"，首字母大写，是为了绕过某些检查。
2.  **竞态条件：** 攻击者利用并发PUT和GET请求，尝试在Tomcat检查文件扩展名和实际编译执行JSP代码之间的时间窗口内，触发竞态条件。
3.  **远程代码执行：** 如果竞态条件成功，Tomcat会将上传的文件作为JSP编译并执行，从而执行攻击者上传的恶意代码（反向shell）。

**POC代码分析：**

*   Python脚本使用`requests`库发送HTTP请求，使用`concurrent.futures`库创建线程池并发发送PUT和GET请求。
*   PUT请求上传包含恶意JSP代码的文件，目标URL为`{target_url}/{filename}.Jsp`。
*   GET请求尝试访问上传的文件，目标URL为`{target_url}/{filename}.jsp` (注意大小写)。
*   JSP payload建立与攻击者指定IP和端口的反向shell连接，从而允许攻击者远程控制服务器。

**投毒风险评估：**

此仓库中存在投毒代码的风险较低，约为10%。主要考虑因素如下：

*   **README.md中的免责声明：**  虽然README.md中声明代码仅用于研究和教育目的，但不能完全排除恶意意图。
*   **Payload的复杂性：** 虽然JSP payload本身就是一个恶意代码，但它明确指定了攻击者的IP地址和端口。这使得payload更容易被检测和分析，降低了隐藏恶意代码的可能性。
*   **仓库的活跃度：**  看起来这是一个个人项目，readme内容还未完成，作者可能会加入其他恶意代码的可能性无法排除。

**有效性：**

提供的PoC代码应该是有效的，因为它利用了已知的漏洞利用方法，并且利用了并发来增加竞态条件成功的机会。然而，成功利用此漏洞取决于目标Tomcat实例的配置（默认servlet是否可写）和文件系统的大小写敏感性。攻击者需要在运行POC前，将JSP Payload中的IP地址更换成自己的IP地址，并监听4444端口，才能成功拿到shell.

**项目地址:** [thunww/CVE-2024-50379](https://github.com/thunww/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #16

**来源**: [CVE-2024-50379-v3153_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-v3153_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 需要在大小写不敏感的文件系统上运行，且Default Servlet开启了写入权限 (非默认配置)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是Apache Tomcat中JSP编译期间的TOCTOU竞争条件漏洞。 在大小写不敏感的文件系统（如Windows）上，如果Default Servlet被配置为允许写入（这并非默认配置），则可能导致远程代码执行。

**有效性：**
提供的POC代码是有效的，它展示了如何利用TOCTOU竞争条件漏洞。 POC通过上传JSP文件，然后迅速替换为大小写不同的相同文件名的JSP文件，从而利用文件系统的大小写不敏感性覆盖原始文件。

**投毒风险：**
该漏洞利用代码的投毒风险较低，约为10%。主要风险在于upload.jsp 中上传路径是可控的，有可能被修改指向其他目录，导致拒绝服务。

**利用方式：**
1.  **环境准备：**  目标系统必须运行在大小写不敏感的文件系统上（例如Windows）。同时，Tomcat的Default Servlet必须配置为允许写入，这需要修改`web.xml`。
2.  **上传恶意JSP文件：**  首先，上传一个JSP文件（例如`file.jsp`），该文件包含恶意代码，比如执行系统命令。
3.  **竞争条件利用：**  在上传`file.jsp`后，立即尝试上传一个大小写不同的同名文件（例如`FILE.JSP`）。由于文件系统的大小写不敏感性，后上传的文件会覆盖之前的文件。
4.  **代码执行：**  Tomcat会尝试编译和执行新上传的JSP文件，从而执行攻击者注入的恶意代码。

**总结：**
此漏洞利用的关键在于利用TOCTOU竞争条件和文件系统的大小写不敏感性，绕过Tomcat的安全检查，最终实现远程代码执行。

**项目地址:** [v3153/CVE-2024-50379-POC](https://github.com/v3153/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #17

**来源**: [CVE-2024-50379-yiliufeng168_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-yiliufeng168_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU 竞争条件导致RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false（允许写入），运行在大小写不敏感的文件系统上（如Windows）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认Servlet配置为可写（非默认配置），且运行在大小写不敏感的文件系统上时，攻击者可以利用此漏洞实现远程代码执行。

**有效性：**
提供的 POC 代码有效。它利用了 TOCTOU 漏洞，通过上传一个 JSP 文件，然后快速替换为大小写不同的同名文件，在大小写不敏感的文件系统上绕过检查，最终执行恶意代码。

**投毒风险：**
该仓库的投毒风险较低。虽然代码提供了RCE的手段，但主要集中在利用漏洞本身，而非植入额外的恶意代码。`hello.jsp`只是一个演示用的后门文件，用于验证漏洞的存在。`upload.jsp`文件上传功能存在被恶意利用的可能，因此存在很小的投毒风险。

**利用方式：**
1.  **配置条件：** 目标 Tomcat 服务器必须满足以下条件：
    *   运行在大小写不敏感的文件系统上（如 Windows）。
    *   默认 Servlet 的 `readonly` 参数设置为 `false`，允许上传文件。
2.  **上传 JSP 文件：** 攻击者首先上传一个 JSP 文件（例如，`file.jsp`），该文件包含恶意代码。
3.  **竞争条件：** 攻击者快速将上传的文件替换为大小写不同的同名文件（例如，`FILE.JSP`）。由于文件系统大小写不敏感，原始文件将被覆盖。
4.  **代码执行：** 当 Tomcat 尝试编译和执行 JSP 文件时，会执行攻击者上传的恶意代码，导致远程代码执行。

**参考信息：**
搜索结果中多个链接（例如，vulcan.io, wiz.io, redhat.com, nvd.nist.gov, medium.com, sangfor.com, mend.io, cvedetails.com）均证实了该漏洞的存在以及 RCE 的可能性，并提供了修复建议。

**项目地址:** [yiliufeng168/CVE-2024-50379-POC](https://github.com/yiliufeng168/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---



---

## POC #14

**来源**: [CVE-2024-50379-pwnosec_CVE-2024-50379.md](../2024/CVE-2024-50379-pwnosec_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet启用写入（非默认配置），文件系统大小写不敏感。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个时序竞态条件漏洞，发生在 JSP 编译期间。当默认 Servlet 启用写入（非默认配置）且文件系统大小写不敏感时，攻击者可以通过竞态条件竞争，上传一个 JSP 文件，使得该文件被 Tomcat 当作 JSP 文件执行，从而导致远程代码执行（RCE）。

**有效性：**
根据漏洞描述，搜索引擎结果以及提供的POC代码，可以判定该POC代码有效。

**投毒风险：**
分析提供的 Python 脚本 `exploit.py`，脚本的功能是尝试上传一个 JSP shell 到目标服务器的 `/uploads` 目录，并提供一个简单的命令行界面来执行命令。脚本本身没有明显的恶意代码。代码逻辑比较清晰，主要涉及 URL 处理、HTTP 请求和响应处理。不过，由于脚本允许远程执行任意命令，攻击者可能利用此工具进行恶意活动。

投毒风险评估：
*   核心代码无明显恶意行为：脚本的主要功能是上传和执行命令，没有发现主动删除文件、窃取信息等恶意代码。
*   潜在的滥用风险：脚本本身就是为了方便 RCE 而设计的，如果被恶意用户使用，可能造成严重危害。
*   依赖风险：脚本使用了 `requests` 库，需要确保该库本身没有安全问题。

综合来看，此仓库中作者隐藏的投毒代码的可能性较低，约为1%。风险主要在于脚本的功能本身可能被滥用。

**利用方式：**
1.  **漏洞触发前提：** Tomcat 服务器需要满足以下条件才能被利用：
    *   默认 Servlet 启用写入（`readonly` 参数设置为 `false`）。
    *   文件系统大小写不敏感。
2.  **攻击步骤：**
    *   攻击者运行提供的 `exploit.py` 脚本。
    *   脚本会提示用户输入目标 Tomcat 服务器的 base URL。
    *   脚本会尝试上传一个 JSP shell 到 `/uploads/shell.jsp`。
    *   如果 `/uploads` 目录不存在或没有正确配置，脚本仍然会继续上传尝试。
    *   上传成功后，攻击者可以通过脚本提供的命令行界面，输入任意命令，在 Tomcat 服务器上执行。
3.  **漏洞原理：**
    该漏洞是一个 TOCTOU 竞态条件漏洞，在 JSP 编译过程中，Tomcat 会检查上传的文件。攻击者利用竞态条件，在 Tomcat 检查文件之后、编译文件之前，替换文件内容为恶意的 JSP 代码，从而绕过安全检查，实现 RCE。

**项目地址:** [pwnosec/CVE-2024-50379](https://github.com/pwnosec/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #15

**来源**: [CVE-2024-50379-thunww_CVE-2024-50379.md](../2024/CVE-2024-50379-thunww_CVE-2024-50379.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU竞态条件导致的远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 默认Servlet配置为可写（非默认配置），运行在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379 是 Apache Tomcat 中的一个 TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。此漏洞存在于 JSP 编译过程中，当 Tomcat 的默认 servlet 启用写入时（非默认配置），允许在大小写不敏感的文件系统上实现 RCE（远程代码执行）。

**漏洞利用方式：**

1.  **上传包含恶意JSP代码的文件：** 攻击者通过PUT请求上传一个以".Jsp"结尾的文件，该文件包含一个反向shell的JSP payload。注意这里的文件名是".Jsp"，首字母大写，是为了绕过某些检查。
2.  **竞态条件：** 攻击者利用并发PUT和GET请求，尝试在Tomcat检查文件扩展名和实际编译执行JSP代码之间的时间窗口内，触发竞态条件。
3.  **远程代码执行：** 如果竞态条件成功，Tomcat会将上传的文件作为JSP编译并执行，从而执行攻击者上传的恶意代码（反向shell）。

**POC代码分析：**

*   Python脚本使用`requests`库发送HTTP请求，使用`concurrent.futures`库创建线程池并发发送PUT和GET请求。
*   PUT请求上传包含恶意JSP代码的文件，目标URL为`{target_url}/{filename}.Jsp`。
*   GET请求尝试访问上传的文件，目标URL为`{target_url}/{filename}.jsp` (注意大小写)。
*   JSP payload建立与攻击者指定IP和端口的反向shell连接，从而允许攻击者远程控制服务器。

**投毒风险评估：**

此仓库中存在投毒代码的风险较低，约为10%。主要考虑因素如下：

*   **README.md中的免责声明：**  虽然README.md中声明代码仅用于研究和教育目的，但不能完全排除恶意意图。
*   **Payload的复杂性：** 虽然JSP payload本身就是一个恶意代码，但它明确指定了攻击者的IP地址和端口。这使得payload更容易被检测和分析，降低了隐藏恶意代码的可能性。
*   **仓库的活跃度：**  看起来这是一个个人项目，readme内容还未完成，作者可能会加入其他恶意代码的可能性无法排除。

**有效性：**

提供的PoC代码应该是有效的，因为它利用了已知的漏洞利用方法，并且利用了并发来增加竞态条件成功的机会。然而，成功利用此漏洞取决于目标Tomcat实例的配置（默认servlet是否可写）和文件系统的大小写敏感性。攻击者需要在运行POC前，将JSP Payload中的IP地址更换成自己的IP地址，并监听4444端口，才能成功拿到shell.

**项目地址:** [thunww/CVE-2024-50379](https://github.com/thunww/CVE-2024-50379)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #16

**来源**: [CVE-2024-50379-v3153_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-v3153_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU Race Condition RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU Race Condition RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.0.0-M1 <= version <= 11.0.1, 10.1.0-M1 <= version <= 10.1.33, 9.0.0.M1 <= version <= 9.0.97

**利用条件:** 需要在大小写不敏感的文件系统上运行，且Default Servlet开启了写入权限 (非默认配置)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50379是Apache Tomcat中JSP编译期间的TOCTOU竞争条件漏洞。 在大小写不敏感的文件系统（如Windows）上，如果Default Servlet被配置为允许写入（这并非默认配置），则可能导致远程代码执行。

**有效性：**
提供的POC代码是有效的，它展示了如何利用TOCTOU竞争条件漏洞。 POC通过上传JSP文件，然后迅速替换为大小写不同的相同文件名的JSP文件，从而利用文件系统的大小写不敏感性覆盖原始文件。

**投毒风险：**
该漏洞利用代码的投毒风险较低，约为10%。主要风险在于upload.jsp 中上传路径是可控的，有可能被修改指向其他目录，导致拒绝服务。

**利用方式：**
1.  **环境准备：**  目标系统必须运行在大小写不敏感的文件系统上（例如Windows）。同时，Tomcat的Default Servlet必须配置为允许写入，这需要修改`web.xml`。
2.  **上传恶意JSP文件：**  首先，上传一个JSP文件（例如`file.jsp`），该文件包含恶意代码，比如执行系统命令。
3.  **竞争条件利用：**  在上传`file.jsp`后，立即尝试上传一个大小写不同的同名文件（例如`FILE.JSP`）。由于文件系统的大小写不敏感性，后上传的文件会覆盖之前的文件。
4.  **代码执行：**  Tomcat会尝试编译和执行新上传的JSP文件，从而执行攻击者注入的恶意代码。

**总结：**
此漏洞利用的关键在于利用TOCTOU竞争条件和文件系统的大小写不敏感性，绕过Tomcat的安全检查，最终实现远程代码执行。

**项目地址:** [v3153/CVE-2024-50379-POC](https://github.com/v3153/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

## POC #17

**来源**: [CVE-2024-50379-yiliufeng168_CVE-2024-50379-POC.md](../2024/CVE-2024-50379-yiliufeng168_CVE-2024-50379-POC.md)

## CVE-2024-50379-Apache Tomcat-TOCTOU 竞争条件导致RCE

**漏洞编号:** CVE-2024-50379

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许远程代码执行

**影响版本:** <= 11.0.1, <= 10.1.33, <= 9.0.97

**利用条件:** 默认Servlet的readonly参数设置为false（允许写入），运行在大小写不敏感的文件系统上（如Windows）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50379 是一个 Apache Tomcat 中的 Time-of-Check Time-of-Use (TOCTOU) 竞争条件漏洞。当默认Servlet配置为可写（非默认配置），且运行在大小写不敏感的文件系统上时，攻击者可以利用此漏洞实现远程代码执行。

**有效性：**
提供的 POC 代码有效。它利用了 TOCTOU 漏洞，通过上传一个 JSP 文件，然后快速替换为大小写不同的同名文件，在大小写不敏感的文件系统上绕过检查，最终执行恶意代码。

**投毒风险：**
该仓库的投毒风险较低。虽然代码提供了RCE的手段，但主要集中在利用漏洞本身，而非植入额外的恶意代码。`hello.jsp`只是一个演示用的后门文件，用于验证漏洞的存在。`upload.jsp`文件上传功能存在被恶意利用的可能，因此存在很小的投毒风险。

**利用方式：**
1.  **配置条件：** 目标 Tomcat 服务器必须满足以下条件：
    *   运行在大小写不敏感的文件系统上（如 Windows）。
    *   默认 Servlet 的 `readonly` 参数设置为 `false`，允许上传文件。
2.  **上传 JSP 文件：** 攻击者首先上传一个 JSP 文件（例如，`file.jsp`），该文件包含恶意代码。
3.  **竞争条件：** 攻击者快速将上传的文件替换为大小写不同的同名文件（例如，`FILE.JSP`）。由于文件系统大小写不敏感，原始文件将被覆盖。
4.  **代码执行：** 当 Tomcat 尝试编译和执行 JSP 文件时，会执行攻击者上传的恶意代码，导致远程代码执行。

**参考信息：**
搜索结果中多个链接（例如，vulcan.io, wiz.io, redhat.com, nvd.nist.gov, medium.com, sangfor.com, mend.io, cvedetails.com）均证实了该漏洞的存在以及 RCE 的可能性，并提供了修复建议。

**项目地址:** [yiliufeng168/CVE-2024-50379-POC](https://github.com/yiliufeng168/CVE-2024-50379-POC)

**漏洞详情:** [CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)

---

