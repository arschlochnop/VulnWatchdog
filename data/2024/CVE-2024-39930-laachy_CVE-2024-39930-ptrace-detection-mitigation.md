# CVE-2024-39930

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-39930-alexander47777_-CVE-2024-39930.md](../2024/CVE-2024-39930-alexander47777_-CVE-2024-39930.md)

## CVE-2024-39930-Gogs-SSH参数注入导致RCE

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs启用内置SSH服务器，并拥有已认证用户的凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-39930 是 Gogs 0.13.0 及更早版本中内置 SSH 服务器上的一个参数注入漏洞。经验证的用户可以通过 SSH 连接发送恶意的 `--split-string` 环境变量请求，导致远程代码执行。

**利用方式：**

1.  **获取用户凭据：** 攻击者需要拥有 Gogs 实例上一个已认证用户的用户名和密码，或者有效的 API Token。
2.  **获取API Token（如果缺少账户）：** 使用提供的`exploit.py`脚本，如果已知用户名和密码，可以利用`get_token`函数获取API Token。
3.  **上传SSH公钥：** 利用获得的 API Token，通过`upload_ssh_key`函数上传攻击者的 SSH 公钥。脚本会先使用`clear_ssh_keys`清除用户原有的SSH keys,然后再上传新的key。这一步使得攻击者可以使用SSH密钥进行身份验证，从而绕过密码。
4.  **构造恶意 SSH 请求：** 使用`execute_command`函数，通过 SSH 连接到 Gogs 服务器，并设置 `--split-string` 环境变量为要执行的命令。`git-upload-pack`命令被用来触发漏洞。由于Gogs处理环境变量的方式存在缺陷，`--split-string`的内容会被当做参数传递给`git-upload-pack`，导致命令注入。
5.  **执行命令：** Gogs服务器执行由 `--split-string` 指定的命令。

**有效性：**

根据漏洞描述、搜索结果和提供的利用代码，该漏洞利用的有效性很高。多个来源确认了该漏洞的存在和严重性，并提供了概念验证的利用代码。该脚本自动化了漏洞利用过程，包括获取API token，上传SSH密钥，以及通过构造特殊的SSH请求来执行任意命令。

**投毒风险：**

仔细审查 `exploit.py` 后，发现主要功能是利用漏洞，并未发现明显的恶意代码（例如，永久性后门安装或数据窃取）。脚本会清理用户现有的 SSH 密钥，然后上传攻击者的密钥，这本身可能会导致服务中断，但这种行为是漏洞利用的一部分，而不是为了长期控制系统。但是，脚本中涉及网络请求和文件操作，如果攻击者修改了脚本，可以很容易地添加恶意功能，例如将敏感信息发送到外部服务器或安装后门。考虑到脚本的目的是进行渗透测试，因此不太可能存在作者隐藏的恶意代码。 但是考虑到代码中存在清理原有ssh key,可能会造成服务中断,以及代码的复杂性，存在潜在风险的可能性,因此判定投毒风险为10%。

**项目地址:** [alexander47777/-CVE-2024-39930](https://github.com/alexander47777/-CVE-2024-39930)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---

## POC #2

**来源**: [CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md](../2024/CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md)

# CVE-2024-39930

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-39930-alexander47777_-CVE-2024-39930.md](../2024/CVE-2024-39930-alexander47777_-CVE-2024-39930.md)

## CVE-2024-39930-Gogs-SSH参数注入导致RCE

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs启用内置SSH服务器，并拥有已认证用户的凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-39930 是 Gogs 0.13.0 及更早版本中内置 SSH 服务器上的一个参数注入漏洞。经验证的用户可以通过 SSH 连接发送恶意的 `--split-string` 环境变量请求，导致远程代码执行。

**利用方式：**

1.  **获取用户凭据：** 攻击者需要拥有 Gogs 实例上一个已认证用户的用户名和密码，或者有效的 API Token。
2.  **获取API Token（如果缺少账户）：** 使用提供的`exploit.py`脚本，如果已知用户名和密码，可以利用`get_token`函数获取API Token。
3.  **上传SSH公钥：** 利用获得的 API Token，通过`upload_ssh_key`函数上传攻击者的 SSH 公钥。脚本会先使用`clear_ssh_keys`清除用户原有的SSH keys,然后再上传新的key。这一步使得攻击者可以使用SSH密钥进行身份验证，从而绕过密码。
4.  **构造恶意 SSH 请求：** 使用`execute_command`函数，通过 SSH 连接到 Gogs 服务器，并设置 `--split-string` 环境变量为要执行的命令。`git-upload-pack`命令被用来触发漏洞。由于Gogs处理环境变量的方式存在缺陷，`--split-string`的内容会被当做参数传递给`git-upload-pack`，导致命令注入。
5.  **执行命令：** Gogs服务器执行由 `--split-string` 指定的命令。

**有效性：**

根据漏洞描述、搜索结果和提供的利用代码，该漏洞利用的有效性很高。多个来源确认了该漏洞的存在和严重性，并提供了概念验证的利用代码。该脚本自动化了漏洞利用过程，包括获取API token，上传SSH密钥，以及通过构造特殊的SSH请求来执行任意命令。

**投毒风险：**

仔细审查 `exploit.py` 后，发现主要功能是利用漏洞，并未发现明显的恶意代码（例如，永久性后门安装或数据窃取）。脚本会清理用户现有的 SSH 密钥，然后上传攻击者的密钥，这本身可能会导致服务中断，但这种行为是漏洞利用的一部分，而不是为了长期控制系统。但是，脚本中涉及网络请求和文件操作，如果攻击者修改了脚本，可以很容易地添加恶意功能，例如将敏感信息发送到外部服务器或安装后门。考虑到脚本的目的是进行渗透测试，因此不太可能存在作者隐藏的恶意代码。 但是考虑到代码中存在清理原有ssh key,可能会造成服务中断,以及代码的复杂性，存在潜在风险的可能性,因此判定投毒风险为10%。

**项目地址:** [alexander47777/-CVE-2024-39930](https://github.com/alexander47777/-CVE-2024-39930)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---

## POC #2

**来源**: [CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md](../2024/CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md)

# CVE-2024-39930

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-39930-alexander47777_-CVE-2024-39930.md](../2024/CVE-2024-39930-alexander47777_-CVE-2024-39930.md)

## CVE-2024-39930-Gogs-SSH参数注入导致RCE

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs启用内置SSH服务器，并拥有已认证用户的凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-39930 是 Gogs 0.13.0 及更早版本中内置 SSH 服务器上的一个参数注入漏洞。经验证的用户可以通过 SSH 连接发送恶意的 `--split-string` 环境变量请求，导致远程代码执行。

**利用方式：**

1.  **获取用户凭据：** 攻击者需要拥有 Gogs 实例上一个已认证用户的用户名和密码，或者有效的 API Token。
2.  **获取API Token（如果缺少账户）：** 使用提供的`exploit.py`脚本，如果已知用户名和密码，可以利用`get_token`函数获取API Token。
3.  **上传SSH公钥：** 利用获得的 API Token，通过`upload_ssh_key`函数上传攻击者的 SSH 公钥。脚本会先使用`clear_ssh_keys`清除用户原有的SSH keys,然后再上传新的key。这一步使得攻击者可以使用SSH密钥进行身份验证，从而绕过密码。
4.  **构造恶意 SSH 请求：** 使用`execute_command`函数，通过 SSH 连接到 Gogs 服务器，并设置 `--split-string` 环境变量为要执行的命令。`git-upload-pack`命令被用来触发漏洞。由于Gogs处理环境变量的方式存在缺陷，`--split-string`的内容会被当做参数传递给`git-upload-pack`，导致命令注入。
5.  **执行命令：** Gogs服务器执行由 `--split-string` 指定的命令。

**有效性：**

根据漏洞描述、搜索结果和提供的利用代码，该漏洞利用的有效性很高。多个来源确认了该漏洞的存在和严重性，并提供了概念验证的利用代码。该脚本自动化了漏洞利用过程，包括获取API token，上传SSH密钥，以及通过构造特殊的SSH请求来执行任意命令。

**投毒风险：**

仔细审查 `exploit.py` 后，发现主要功能是利用漏洞，并未发现明显的恶意代码（例如，永久性后门安装或数据窃取）。脚本会清理用户现有的 SSH 密钥，然后上传攻击者的密钥，这本身可能会导致服务中断，但这种行为是漏洞利用的一部分，而不是为了长期控制系统。但是，脚本中涉及网络请求和文件操作，如果攻击者修改了脚本，可以很容易地添加恶意功能，例如将敏感信息发送到外部服务器或安装后门。考虑到脚本的目的是进行渗透测试，因此不太可能存在作者隐藏的恶意代码。 但是考虑到代码中存在清理原有ssh key,可能会造成服务中断,以及代码的复杂性，存在潜在风险的可能性,因此判定投毒风险为10%。

**项目地址:** [alexander47777/-CVE-2024-39930](https://github.com/alexander47777/-CVE-2024-39930)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---

## POC #2

**来源**: [CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md](../2024/CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md)

# CVE-2024-39930

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-39930-alexander47777_-CVE-2024-39930.md](../2024/CVE-2024-39930-alexander47777_-CVE-2024-39930.md)

## CVE-2024-39930-Gogs-SSH参数注入导致RCE

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs启用内置SSH服务器，并拥有已认证用户的凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-39930 是 Gogs 0.13.0 及更早版本中内置 SSH 服务器上的一个参数注入漏洞。经验证的用户可以通过 SSH 连接发送恶意的 `--split-string` 环境变量请求，导致远程代码执行。

**利用方式：**

1.  **获取用户凭据：** 攻击者需要拥有 Gogs 实例上一个已认证用户的用户名和密码，或者有效的 API Token。
2.  **获取API Token（如果缺少账户）：** 使用提供的`exploit.py`脚本，如果已知用户名和密码，可以利用`get_token`函数获取API Token。
3.  **上传SSH公钥：** 利用获得的 API Token，通过`upload_ssh_key`函数上传攻击者的 SSH 公钥。脚本会先使用`clear_ssh_keys`清除用户原有的SSH keys,然后再上传新的key。这一步使得攻击者可以使用SSH密钥进行身份验证，从而绕过密码。
4.  **构造恶意 SSH 请求：** 使用`execute_command`函数，通过 SSH 连接到 Gogs 服务器，并设置 `--split-string` 环境变量为要执行的命令。`git-upload-pack`命令被用来触发漏洞。由于Gogs处理环境变量的方式存在缺陷，`--split-string`的内容会被当做参数传递给`git-upload-pack`，导致命令注入。
5.  **执行命令：** Gogs服务器执行由 `--split-string` 指定的命令。

**有效性：**

根据漏洞描述、搜索结果和提供的利用代码，该漏洞利用的有效性很高。多个来源确认了该漏洞的存在和严重性，并提供了概念验证的利用代码。该脚本自动化了漏洞利用过程，包括获取API token，上传SSH密钥，以及通过构造特殊的SSH请求来执行任意命令。

**投毒风险：**

仔细审查 `exploit.py` 后，发现主要功能是利用漏洞，并未发现明显的恶意代码（例如，永久性后门安装或数据窃取）。脚本会清理用户现有的 SSH 密钥，然后上传攻击者的密钥，这本身可能会导致服务中断，但这种行为是漏洞利用的一部分，而不是为了长期控制系统。但是，脚本中涉及网络请求和文件操作，如果攻击者修改了脚本，可以很容易地添加恶意功能，例如将敏感信息发送到外部服务器或安装后门。考虑到脚本的目的是进行渗透测试，因此不太可能存在作者隐藏的恶意代码。 但是考虑到代码中存在清理原有ssh key,可能会造成服务中断,以及代码的复杂性，存在潜在风险的可能性,因此判定投毒风险为10%。

**项目地址:** [alexander47777/-CVE-2024-39930](https://github.com/alexander47777/-CVE-2024-39930)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---

## POC #2

**来源**: [CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md](../2024/CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md)

# CVE-2024-39930

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-39930-alexander47777_-CVE-2024-39930.md](../2024/CVE-2024-39930-alexander47777_-CVE-2024-39930.md)

## CVE-2024-39930-Gogs-SSH参数注入导致RCE

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs启用内置SSH服务器，并拥有已认证用户的凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-39930 是 Gogs 0.13.0 及更早版本中内置 SSH 服务器上的一个参数注入漏洞。经验证的用户可以通过 SSH 连接发送恶意的 `--split-string` 环境变量请求，导致远程代码执行。

**利用方式：**

1.  **获取用户凭据：** 攻击者需要拥有 Gogs 实例上一个已认证用户的用户名和密码，或者有效的 API Token。
2.  **获取API Token（如果缺少账户）：** 使用提供的`exploit.py`脚本，如果已知用户名和密码，可以利用`get_token`函数获取API Token。
3.  **上传SSH公钥：** 利用获得的 API Token，通过`upload_ssh_key`函数上传攻击者的 SSH 公钥。脚本会先使用`clear_ssh_keys`清除用户原有的SSH keys,然后再上传新的key。这一步使得攻击者可以使用SSH密钥进行身份验证，从而绕过密码。
4.  **构造恶意 SSH 请求：** 使用`execute_command`函数，通过 SSH 连接到 Gogs 服务器，并设置 `--split-string` 环境变量为要执行的命令。`git-upload-pack`命令被用来触发漏洞。由于Gogs处理环境变量的方式存在缺陷，`--split-string`的内容会被当做参数传递给`git-upload-pack`，导致命令注入。
5.  **执行命令：** Gogs服务器执行由 `--split-string` 指定的命令。

**有效性：**

根据漏洞描述、搜索结果和提供的利用代码，该漏洞利用的有效性很高。多个来源确认了该漏洞的存在和严重性，并提供了概念验证的利用代码。该脚本自动化了漏洞利用过程，包括获取API token，上传SSH密钥，以及通过构造特殊的SSH请求来执行任意命令。

**投毒风险：**

仔细审查 `exploit.py` 后，发现主要功能是利用漏洞，并未发现明显的恶意代码（例如，永久性后门安装或数据窃取）。脚本会清理用户现有的 SSH 密钥，然后上传攻击者的密钥，这本身可能会导致服务中断，但这种行为是漏洞利用的一部分，而不是为了长期控制系统。但是，脚本中涉及网络请求和文件操作，如果攻击者修改了脚本，可以很容易地添加恶意功能，例如将敏感信息发送到外部服务器或安装后门。考虑到脚本的目的是进行渗透测试，因此不太可能存在作者隐藏的恶意代码。 但是考虑到代码中存在清理原有ssh key,可能会造成服务中断,以及代码的复杂性，存在潜在风险的可能性,因此判定投毒风险为10%。

**项目地址:** [alexander47777/-CVE-2024-39930](https://github.com/alexander47777/-CVE-2024-39930)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---

## POC #2

**来源**: [CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md](../2024/CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md)

# CVE-2024-39930

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-39930-alexander47777_-CVE-2024-39930.md](../2024/CVE-2024-39930-alexander47777_-CVE-2024-39930.md)

## CVE-2024-39930-Gogs-SSH参数注入导致RCE

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs启用内置SSH服务器，并拥有已认证用户的凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-39930 是 Gogs 0.13.0 及更早版本中内置 SSH 服务器上的一个参数注入漏洞。经验证的用户可以通过 SSH 连接发送恶意的 `--split-string` 环境变量请求，导致远程代码执行。

**利用方式：**

1.  **获取用户凭据：** 攻击者需要拥有 Gogs 实例上一个已认证用户的用户名和密码，或者有效的 API Token。
2.  **获取API Token（如果缺少账户）：** 使用提供的`exploit.py`脚本，如果已知用户名和密码，可以利用`get_token`函数获取API Token。
3.  **上传SSH公钥：** 利用获得的 API Token，通过`upload_ssh_key`函数上传攻击者的 SSH 公钥。脚本会先使用`clear_ssh_keys`清除用户原有的SSH keys,然后再上传新的key。这一步使得攻击者可以使用SSH密钥进行身份验证，从而绕过密码。
4.  **构造恶意 SSH 请求：** 使用`execute_command`函数，通过 SSH 连接到 Gogs 服务器，并设置 `--split-string` 环境变量为要执行的命令。`git-upload-pack`命令被用来触发漏洞。由于Gogs处理环境变量的方式存在缺陷，`--split-string`的内容会被当做参数传递给`git-upload-pack`，导致命令注入。
5.  **执行命令：** Gogs服务器执行由 `--split-string` 指定的命令。

**有效性：**

根据漏洞描述、搜索结果和提供的利用代码，该漏洞利用的有效性很高。多个来源确认了该漏洞的存在和严重性，并提供了概念验证的利用代码。该脚本自动化了漏洞利用过程，包括获取API token，上传SSH密钥，以及通过构造特殊的SSH请求来执行任意命令。

**投毒风险：**

仔细审查 `exploit.py` 后，发现主要功能是利用漏洞，并未发现明显的恶意代码（例如，永久性后门安装或数据窃取）。脚本会清理用户现有的 SSH 密钥，然后上传攻击者的密钥，这本身可能会导致服务中断，但这种行为是漏洞利用的一部分，而不是为了长期控制系统。但是，脚本中涉及网络请求和文件操作，如果攻击者修改了脚本，可以很容易地添加恶意功能，例如将敏感信息发送到外部服务器或安装后门。考虑到脚本的目的是进行渗透测试，因此不太可能存在作者隐藏的恶意代码。 但是考虑到代码中存在清理原有ssh key,可能会造成服务中断,以及代码的复杂性，存在潜在风险的可能性,因此判定投毒风险为10%。

**项目地址:** [alexander47777/-CVE-2024-39930](https://github.com/alexander47777/-CVE-2024-39930)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---

## POC #2

**来源**: [CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md](../2024/CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md)

# CVE-2024-39930

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-39930-alexander47777_-CVE-2024-39930.md](../2024/CVE-2024-39930-alexander47777_-CVE-2024-39930.md)

## CVE-2024-39930-Gogs-SSH参数注入导致RCE

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs启用内置SSH服务器，并拥有已认证用户的凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-39930 是 Gogs 0.13.0 及更早版本中内置 SSH 服务器上的一个参数注入漏洞。经验证的用户可以通过 SSH 连接发送恶意的 `--split-string` 环境变量请求，导致远程代码执行。

**利用方式：**

1.  **获取用户凭据：** 攻击者需要拥有 Gogs 实例上一个已认证用户的用户名和密码，或者有效的 API Token。
2.  **获取API Token（如果缺少账户）：** 使用提供的`exploit.py`脚本，如果已知用户名和密码，可以利用`get_token`函数获取API Token。
3.  **上传SSH公钥：** 利用获得的 API Token，通过`upload_ssh_key`函数上传攻击者的 SSH 公钥。脚本会先使用`clear_ssh_keys`清除用户原有的SSH keys,然后再上传新的key。这一步使得攻击者可以使用SSH密钥进行身份验证，从而绕过密码。
4.  **构造恶意 SSH 请求：** 使用`execute_command`函数，通过 SSH 连接到 Gogs 服务器，并设置 `--split-string` 环境变量为要执行的命令。`git-upload-pack`命令被用来触发漏洞。由于Gogs处理环境变量的方式存在缺陷，`--split-string`的内容会被当做参数传递给`git-upload-pack`，导致命令注入。
5.  **执行命令：** Gogs服务器执行由 `--split-string` 指定的命令。

**有效性：**

根据漏洞描述、搜索结果和提供的利用代码，该漏洞利用的有效性很高。多个来源确认了该漏洞的存在和严重性，并提供了概念验证的利用代码。该脚本自动化了漏洞利用过程，包括获取API token，上传SSH密钥，以及通过构造特殊的SSH请求来执行任意命令。

**投毒风险：**

仔细审查 `exploit.py` 后，发现主要功能是利用漏洞，并未发现明显的恶意代码（例如，永久性后门安装或数据窃取）。脚本会清理用户现有的 SSH 密钥，然后上传攻击者的密钥，这本身可能会导致服务中断，但这种行为是漏洞利用的一部分，而不是为了长期控制系统。但是，脚本中涉及网络请求和文件操作，如果攻击者修改了脚本，可以很容易地添加恶意功能，例如将敏感信息发送到外部服务器或安装后门。考虑到脚本的目的是进行渗透测试，因此不太可能存在作者隐藏的恶意代码。 但是考虑到代码中存在清理原有ssh key,可能会造成服务中断,以及代码的复杂性，存在潜在风险的可能性,因此判定投毒风险为10%。

**项目地址:** [alexander47777/-CVE-2024-39930](https://github.com/alexander47777/-CVE-2024-39930)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---

## POC #2

**来源**: [CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md](../2024/CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md)

# CVE-2024-39930

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-39930-alexander47777_-CVE-2024-39930.md](../2024/CVE-2024-39930-alexander47777_-CVE-2024-39930.md)

## CVE-2024-39930-Gogs-SSH参数注入导致RCE

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs启用内置SSH服务器，并拥有已认证用户的凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-39930 是 Gogs 0.13.0 及更早版本中内置 SSH 服务器上的一个参数注入漏洞。经验证的用户可以通过 SSH 连接发送恶意的 `--split-string` 环境变量请求，导致远程代码执行。

**利用方式：**

1.  **获取用户凭据：** 攻击者需要拥有 Gogs 实例上一个已认证用户的用户名和密码，或者有效的 API Token。
2.  **获取API Token（如果缺少账户）：** 使用提供的`exploit.py`脚本，如果已知用户名和密码，可以利用`get_token`函数获取API Token。
3.  **上传SSH公钥：** 利用获得的 API Token，通过`upload_ssh_key`函数上传攻击者的 SSH 公钥。脚本会先使用`clear_ssh_keys`清除用户原有的SSH keys,然后再上传新的key。这一步使得攻击者可以使用SSH密钥进行身份验证，从而绕过密码。
4.  **构造恶意 SSH 请求：** 使用`execute_command`函数，通过 SSH 连接到 Gogs 服务器，并设置 `--split-string` 环境变量为要执行的命令。`git-upload-pack`命令被用来触发漏洞。由于Gogs处理环境变量的方式存在缺陷，`--split-string`的内容会被当做参数传递给`git-upload-pack`，导致命令注入。
5.  **执行命令：** Gogs服务器执行由 `--split-string` 指定的命令。

**有效性：**

根据漏洞描述、搜索结果和提供的利用代码，该漏洞利用的有效性很高。多个来源确认了该漏洞的存在和严重性，并提供了概念验证的利用代码。该脚本自动化了漏洞利用过程，包括获取API token，上传SSH密钥，以及通过构造特殊的SSH请求来执行任意命令。

**投毒风险：**

仔细审查 `exploit.py` 后，发现主要功能是利用漏洞，并未发现明显的恶意代码（例如，永久性后门安装或数据窃取）。脚本会清理用户现有的 SSH 密钥，然后上传攻击者的密钥，这本身可能会导致服务中断，但这种行为是漏洞利用的一部分，而不是为了长期控制系统。但是，脚本中涉及网络请求和文件操作，如果攻击者修改了脚本，可以很容易地添加恶意功能，例如将敏感信息发送到外部服务器或安装后门。考虑到脚本的目的是进行渗透测试，因此不太可能存在作者隐藏的恶意代码。 但是考虑到代码中存在清理原有ssh key,可能会造成服务中断,以及代码的复杂性，存在潜在风险的可能性,因此判定投毒风险为10%。

**项目地址:** [alexander47777/-CVE-2024-39930](https://github.com/alexander47777/-CVE-2024-39930)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---

## POC #2

**来源**: [CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md](../2024/CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md)

# CVE-2024-39930

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-39930-alexander47777_-CVE-2024-39930.md](../2024/CVE-2024-39930-alexander47777_-CVE-2024-39930.md)

## CVE-2024-39930-Gogs-SSH参数注入导致RCE

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs启用内置SSH服务器，并拥有已认证用户的凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-39930 是 Gogs 0.13.0 及更早版本中内置 SSH 服务器上的一个参数注入漏洞。经验证的用户可以通过 SSH 连接发送恶意的 `--split-string` 环境变量请求，导致远程代码执行。

**利用方式：**

1.  **获取用户凭据：** 攻击者需要拥有 Gogs 实例上一个已认证用户的用户名和密码，或者有效的 API Token。
2.  **获取API Token（如果缺少账户）：** 使用提供的`exploit.py`脚本，如果已知用户名和密码，可以利用`get_token`函数获取API Token。
3.  **上传SSH公钥：** 利用获得的 API Token，通过`upload_ssh_key`函数上传攻击者的 SSH 公钥。脚本会先使用`clear_ssh_keys`清除用户原有的SSH keys,然后再上传新的key。这一步使得攻击者可以使用SSH密钥进行身份验证，从而绕过密码。
4.  **构造恶意 SSH 请求：** 使用`execute_command`函数，通过 SSH 连接到 Gogs 服务器，并设置 `--split-string` 环境变量为要执行的命令。`git-upload-pack`命令被用来触发漏洞。由于Gogs处理环境变量的方式存在缺陷，`--split-string`的内容会被当做参数传递给`git-upload-pack`，导致命令注入。
5.  **执行命令：** Gogs服务器执行由 `--split-string` 指定的命令。

**有效性：**

根据漏洞描述、搜索结果和提供的利用代码，该漏洞利用的有效性很高。多个来源确认了该漏洞的存在和严重性，并提供了概念验证的利用代码。该脚本自动化了漏洞利用过程，包括获取API token，上传SSH密钥，以及通过构造特殊的SSH请求来执行任意命令。

**投毒风险：**

仔细审查 `exploit.py` 后，发现主要功能是利用漏洞，并未发现明显的恶意代码（例如，永久性后门安装或数据窃取）。脚本会清理用户现有的 SSH 密钥，然后上传攻击者的密钥，这本身可能会导致服务中断，但这种行为是漏洞利用的一部分，而不是为了长期控制系统。但是，脚本中涉及网络请求和文件操作，如果攻击者修改了脚本，可以很容易地添加恶意功能，例如将敏感信息发送到外部服务器或安装后门。考虑到脚本的目的是进行渗透测试，因此不太可能存在作者隐藏的恶意代码。 但是考虑到代码中存在清理原有ssh key,可能会造成服务中断,以及代码的复杂性，存在潜在风险的可能性,因此判定投毒风险为10%。

**项目地址:** [alexander47777/-CVE-2024-39930](https://github.com/alexander47777/-CVE-2024-39930)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---

## POC #2

**来源**: [CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md](../2024/CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md)

# CVE-2024-39930

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-39930-alexander47777_-CVE-2024-39930.md](../2024/CVE-2024-39930-alexander47777_-CVE-2024-39930.md)

## CVE-2024-39930-Gogs-SSH参数注入导致RCE

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs启用内置SSH服务器，并拥有已认证用户的凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-39930 是 Gogs 0.13.0 及更早版本中内置 SSH 服务器上的一个参数注入漏洞。经验证的用户可以通过 SSH 连接发送恶意的 `--split-string` 环境变量请求，导致远程代码执行。

**利用方式：**

1.  **获取用户凭据：** 攻击者需要拥有 Gogs 实例上一个已认证用户的用户名和密码，或者有效的 API Token。
2.  **获取API Token（如果缺少账户）：** 使用提供的`exploit.py`脚本，如果已知用户名和密码，可以利用`get_token`函数获取API Token。
3.  **上传SSH公钥：** 利用获得的 API Token，通过`upload_ssh_key`函数上传攻击者的 SSH 公钥。脚本会先使用`clear_ssh_keys`清除用户原有的SSH keys,然后再上传新的key。这一步使得攻击者可以使用SSH密钥进行身份验证，从而绕过密码。
4.  **构造恶意 SSH 请求：** 使用`execute_command`函数，通过 SSH 连接到 Gogs 服务器，并设置 `--split-string` 环境变量为要执行的命令。`git-upload-pack`命令被用来触发漏洞。由于Gogs处理环境变量的方式存在缺陷，`--split-string`的内容会被当做参数传递给`git-upload-pack`，导致命令注入。
5.  **执行命令：** Gogs服务器执行由 `--split-string` 指定的命令。

**有效性：**

根据漏洞描述、搜索结果和提供的利用代码，该漏洞利用的有效性很高。多个来源确认了该漏洞的存在和严重性，并提供了概念验证的利用代码。该脚本自动化了漏洞利用过程，包括获取API token，上传SSH密钥，以及通过构造特殊的SSH请求来执行任意命令。

**投毒风险：**

仔细审查 `exploit.py` 后，发现主要功能是利用漏洞，并未发现明显的恶意代码（例如，永久性后门安装或数据窃取）。脚本会清理用户现有的 SSH 密钥，然后上传攻击者的密钥，这本身可能会导致服务中断，但这种行为是漏洞利用的一部分，而不是为了长期控制系统。但是，脚本中涉及网络请求和文件操作，如果攻击者修改了脚本，可以很容易地添加恶意功能，例如将敏感信息发送到外部服务器或安装后门。考虑到脚本的目的是进行渗透测试，因此不太可能存在作者隐藏的恶意代码。 但是考虑到代码中存在清理原有ssh key,可能会造成服务中断,以及代码的复杂性，存在潜在风险的可能性,因此判定投毒风险为10%。

**项目地址:** [alexander47777/-CVE-2024-39930](https://github.com/alexander47777/-CVE-2024-39930)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---

## POC #2

**来源**: [CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md](../2024/CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md)

# CVE-2024-39930

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-39930-alexander47777_-CVE-2024-39930.md](../2024/CVE-2024-39930-alexander47777_-CVE-2024-39930.md)

## CVE-2024-39930-Gogs-SSH参数注入导致RCE

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs启用内置SSH服务器，并拥有已认证用户的凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-39930 是 Gogs 0.13.0 及更早版本中内置 SSH 服务器上的一个参数注入漏洞。经验证的用户可以通过 SSH 连接发送恶意的 `--split-string` 环境变量请求，导致远程代码执行。

**利用方式：**

1.  **获取用户凭据：** 攻击者需要拥有 Gogs 实例上一个已认证用户的用户名和密码，或者有效的 API Token。
2.  **获取API Token（如果缺少账户）：** 使用提供的`exploit.py`脚本，如果已知用户名和密码，可以利用`get_token`函数获取API Token。
3.  **上传SSH公钥：** 利用获得的 API Token，通过`upload_ssh_key`函数上传攻击者的 SSH 公钥。脚本会先使用`clear_ssh_keys`清除用户原有的SSH keys,然后再上传新的key。这一步使得攻击者可以使用SSH密钥进行身份验证，从而绕过密码。
4.  **构造恶意 SSH 请求：** 使用`execute_command`函数，通过 SSH 连接到 Gogs 服务器，并设置 `--split-string` 环境变量为要执行的命令。`git-upload-pack`命令被用来触发漏洞。由于Gogs处理环境变量的方式存在缺陷，`--split-string`的内容会被当做参数传递给`git-upload-pack`，导致命令注入。
5.  **执行命令：** Gogs服务器执行由 `--split-string` 指定的命令。

**有效性：**

根据漏洞描述、搜索结果和提供的利用代码，该漏洞利用的有效性很高。多个来源确认了该漏洞的存在和严重性，并提供了概念验证的利用代码。该脚本自动化了漏洞利用过程，包括获取API token，上传SSH密钥，以及通过构造特殊的SSH请求来执行任意命令。

**投毒风险：**

仔细审查 `exploit.py` 后，发现主要功能是利用漏洞，并未发现明显的恶意代码（例如，永久性后门安装或数据窃取）。脚本会清理用户现有的 SSH 密钥，然后上传攻击者的密钥，这本身可能会导致服务中断，但这种行为是漏洞利用的一部分，而不是为了长期控制系统。但是，脚本中涉及网络请求和文件操作，如果攻击者修改了脚本，可以很容易地添加恶意功能，例如将敏感信息发送到外部服务器或安装后门。考虑到脚本的目的是进行渗透测试，因此不太可能存在作者隐藏的恶意代码。 但是考虑到代码中存在清理原有ssh key,可能会造成服务中断,以及代码的复杂性，存在潜在风险的可能性,因此判定投毒风险为10%。

**项目地址:** [alexander47777/-CVE-2024-39930](https://github.com/alexander47777/-CVE-2024-39930)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---

## POC #2

**来源**: [CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md](../2024/CVE-2024-39930-laachy_CVE-2024-39930-ptrace-detection-mitigation.md)

# CVE-2024-39930

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-39930-alexander47777_-CVE-2024-39930.md](../2024/CVE-2024-39930-alexander47777_-CVE-2024-39930.md)

## CVE-2024-39930-Gogs-SSH参数注入导致RCE

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs启用内置SSH服务器，并拥有已认证用户的凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-39930 是 Gogs 0.13.0 及更早版本中内置 SSH 服务器上的一个参数注入漏洞。经验证的用户可以通过 SSH 连接发送恶意的 `--split-string` 环境变量请求，导致远程代码执行。

**利用方式：**

1.  **获取用户凭据：** 攻击者需要拥有 Gogs 实例上一个已认证用户的用户名和密码，或者有效的 API Token。
2.  **获取API Token（如果缺少账户）：** 使用提供的`exploit.py`脚本，如果已知用户名和密码，可以利用`get_token`函数获取API Token。
3.  **上传SSH公钥：** 利用获得的 API Token，通过`upload_ssh_key`函数上传攻击者的 SSH 公钥。脚本会先使用`clear_ssh_keys`清除用户原有的SSH keys,然后再上传新的key。这一步使得攻击者可以使用SSH密钥进行身份验证，从而绕过密码。
4.  **构造恶意 SSH 请求：** 使用`execute_command`函数，通过 SSH 连接到 Gogs 服务器，并设置 `--split-string` 环境变量为要执行的命令。`git-upload-pack`命令被用来触发漏洞。由于Gogs处理环境变量的方式存在缺陷，`--split-string`的内容会被当做参数传递给`git-upload-pack`，导致命令注入。
5.  **执行命令：** Gogs服务器执行由 `--split-string` 指定的命令。

**有效性：**

根据漏洞描述、搜索结果和提供的利用代码，该漏洞利用的有效性很高。多个来源确认了该漏洞的存在和严重性，并提供了概念验证的利用代码。该脚本自动化了漏洞利用过程，包括获取API token，上传SSH密钥，以及通过构造特殊的SSH请求来执行任意命令。

**投毒风险：**

仔细审查 `exploit.py` 后，发现主要功能是利用漏洞，并未发现明显的恶意代码（例如，永久性后门安装或数据窃取）。脚本会清理用户现有的 SSH 密钥，然后上传攻击者的密钥，这本身可能会导致服务中断，但这种行为是漏洞利用的一部分，而不是为了长期控制系统。但是，脚本中涉及网络请求和文件操作，如果攻击者修改了脚本，可以很容易地添加恶意功能，例如将敏感信息发送到外部服务器或安装后门。考虑到脚本的目的是进行渗透测试，因此不太可能存在作者隐藏的恶意代码。 但是考虑到代码中存在清理原有ssh key,可能会造成服务中断,以及代码的复杂性，存在潜在风险的可能性,因此判定投毒风险为10%。

**项目地址:** [alexander47777/-CVE-2024-39930](https://github.com/alexander47777/-CVE-2024-39930)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---

## POC #2

**来源**: [CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md](../2024/CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md)

## CVE-2024-39930-Gogs-远程代码执行

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行

**影响应用:** Gogs

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs内置SSH服务已启用，并拥有一个有效的用户账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-39930是Gogs 0.13.0及更早版本中内置SSH服务器存在的一个参数注入漏洞。攻击者可以通过建立SSH连接，并发送恶意的`--split-string`环境变量请求，从而执行任意代码。该漏洞影响Linux环境下的Gogs实例，Windows实例不受影响。

**漏洞利用方式：**

1.  **获取API Token：** 首先，利用Gogs API，通过用户名和密码获取API Token。这是后续操作的身份验证凭据。
2.  **创建仓库（可选）：** 创建一个新的Git仓库，虽然从原理上来说不是必须，但是poc中做了此操作,可能是为了更方便的触发git相关功能。
3.  **删除现有SSH Key：** 删除用户已有的SSH Key，保证攻击者可以上传自己控制的Key。
4.  **添加SSH Key：** 上传攻击者自己的SSH Key，为后续的SSH连接做准备。
5.  **SSH 连接并执行命令：** 使用Paramiko库建立SSH连接，关键在于设置环境变量`--split-string`，该变量的值会被注入到`git-upload-pack`命令中，导致命令执行。实际执行的命令是`git-upload-pack <repo_path>`，而`--split-string`的值会作为额外的参数传递给这个命令。

**投毒风险分析：**

该POC代码主要分为两个部分：一部分是利用Gogs API进行用户认证、创建仓库、管理SSH Key等操作；另一部分是建立SSH连接，并利用`--split-string`参数注入执行命令。

API调用部分的代码相对安全，风险较低。主要的潜在投毒点在于以下几个方面：

*   **命令执行字符串：** 攻击者可能会在提供的command参数中嵌入恶意代码，但这是用户可控的，不属于POC本身投毒。
*   **SSH密钥生成或处理：** 如果POC包含SSH密钥生成功能，可能会生成弱密钥或者后门密钥。但当前代码直接使用用户提供的密钥文件，因此不存在此风险。
*   **其他隐藏的恶意代码：** 理论上，作者可以在代码中添加其他隐藏的恶意行为，例如收集用户信息、植入持久化后门等。但是，该POC代码逻辑相对简单，没有发现明显的恶意代码。

基于以上分析，此POC的投毒风险较低，大约为1%。风险主要集中在用户提供的执行命令字符串本身是否存在恶意行为，而非POC代码本身。

**项目地址:** [theMcSam/CVE-2024-39930-PoC](https://github.com/theMcSam/CVE-2024-39930-PoC)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---



---

## POC #3

**来源**: [CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md](../2024/CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md)

## CVE-2024-39930-Gogs-远程代码执行

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行

**影响应用:** Gogs

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs内置SSH服务已启用，并拥有一个有效的用户账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-39930是Gogs 0.13.0及更早版本中内置SSH服务器存在的一个参数注入漏洞。攻击者可以通过建立SSH连接，并发送恶意的`--split-string`环境变量请求，从而执行任意代码。该漏洞影响Linux环境下的Gogs实例，Windows实例不受影响。

**漏洞利用方式：**

1.  **获取API Token：** 首先，利用Gogs API，通过用户名和密码获取API Token。这是后续操作的身份验证凭据。
2.  **创建仓库（可选）：** 创建一个新的Git仓库，虽然从原理上来说不是必须，但是poc中做了此操作,可能是为了更方便的触发git相关功能。
3.  **删除现有SSH Key：** 删除用户已有的SSH Key，保证攻击者可以上传自己控制的Key。
4.  **添加SSH Key：** 上传攻击者自己的SSH Key，为后续的SSH连接做准备。
5.  **SSH 连接并执行命令：** 使用Paramiko库建立SSH连接，关键在于设置环境变量`--split-string`，该变量的值会被注入到`git-upload-pack`命令中，导致命令执行。实际执行的命令是`git-upload-pack <repo_path>`，而`--split-string`的值会作为额外的参数传递给这个命令。

**投毒风险分析：**

该POC代码主要分为两个部分：一部分是利用Gogs API进行用户认证、创建仓库、管理SSH Key等操作；另一部分是建立SSH连接，并利用`--split-string`参数注入执行命令。

API调用部分的代码相对安全，风险较低。主要的潜在投毒点在于以下几个方面：

*   **命令执行字符串：** 攻击者可能会在提供的command参数中嵌入恶意代码，但这是用户可控的，不属于POC本身投毒。
*   **SSH密钥生成或处理：** 如果POC包含SSH密钥生成功能，可能会生成弱密钥或者后门密钥。但当前代码直接使用用户提供的密钥文件，因此不存在此风险。
*   **其他隐藏的恶意代码：** 理论上，作者可以在代码中添加其他隐藏的恶意行为，例如收集用户信息、植入持久化后门等。但是，该POC代码逻辑相对简单，没有发现明显的恶意代码。

基于以上分析，此POC的投毒风险较低，大约为1%。风险主要集中在用户提供的执行命令字符串本身是否存在恶意行为，而非POC代码本身。

**项目地址:** [theMcSam/CVE-2024-39930-PoC](https://github.com/theMcSam/CVE-2024-39930-PoC)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---



---

## POC #3

**来源**: [CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md](../2024/CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md)

## CVE-2024-39930-Gogs-远程代码执行

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行

**影响应用:** Gogs

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs内置SSH服务已启用，并拥有一个有效的用户账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-39930是Gogs 0.13.0及更早版本中内置SSH服务器存在的一个参数注入漏洞。攻击者可以通过建立SSH连接，并发送恶意的`--split-string`环境变量请求，从而执行任意代码。该漏洞影响Linux环境下的Gogs实例，Windows实例不受影响。

**漏洞利用方式：**

1.  **获取API Token：** 首先，利用Gogs API，通过用户名和密码获取API Token。这是后续操作的身份验证凭据。
2.  **创建仓库（可选）：** 创建一个新的Git仓库，虽然从原理上来说不是必须，但是poc中做了此操作,可能是为了更方便的触发git相关功能。
3.  **删除现有SSH Key：** 删除用户已有的SSH Key，保证攻击者可以上传自己控制的Key。
4.  **添加SSH Key：** 上传攻击者自己的SSH Key，为后续的SSH连接做准备。
5.  **SSH 连接并执行命令：** 使用Paramiko库建立SSH连接，关键在于设置环境变量`--split-string`，该变量的值会被注入到`git-upload-pack`命令中，导致命令执行。实际执行的命令是`git-upload-pack <repo_path>`，而`--split-string`的值会作为额外的参数传递给这个命令。

**投毒风险分析：**

该POC代码主要分为两个部分：一部分是利用Gogs API进行用户认证、创建仓库、管理SSH Key等操作；另一部分是建立SSH连接，并利用`--split-string`参数注入执行命令。

API调用部分的代码相对安全，风险较低。主要的潜在投毒点在于以下几个方面：

*   **命令执行字符串：** 攻击者可能会在提供的command参数中嵌入恶意代码，但这是用户可控的，不属于POC本身投毒。
*   **SSH密钥生成或处理：** 如果POC包含SSH密钥生成功能，可能会生成弱密钥或者后门密钥。但当前代码直接使用用户提供的密钥文件，因此不存在此风险。
*   **其他隐藏的恶意代码：** 理论上，作者可以在代码中添加其他隐藏的恶意行为，例如收集用户信息、植入持久化后门等。但是，该POC代码逻辑相对简单，没有发现明显的恶意代码。

基于以上分析，此POC的投毒风险较低，大约为1%。风险主要集中在用户提供的执行命令字符串本身是否存在恶意行为，而非POC代码本身。

**项目地址:** [theMcSam/CVE-2024-39930-PoC](https://github.com/theMcSam/CVE-2024-39930-PoC)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---



---

## POC #3

**来源**: [CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md](../2024/CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md)

## CVE-2024-39930-Gogs-远程代码执行

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行

**影响应用:** Gogs

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs内置SSH服务已启用，并拥有一个有效的用户账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-39930是Gogs 0.13.0及更早版本中内置SSH服务器存在的一个参数注入漏洞。攻击者可以通过建立SSH连接，并发送恶意的`--split-string`环境变量请求，从而执行任意代码。该漏洞影响Linux环境下的Gogs实例，Windows实例不受影响。

**漏洞利用方式：**

1.  **获取API Token：** 首先，利用Gogs API，通过用户名和密码获取API Token。这是后续操作的身份验证凭据。
2.  **创建仓库（可选）：** 创建一个新的Git仓库，虽然从原理上来说不是必须，但是poc中做了此操作,可能是为了更方便的触发git相关功能。
3.  **删除现有SSH Key：** 删除用户已有的SSH Key，保证攻击者可以上传自己控制的Key。
4.  **添加SSH Key：** 上传攻击者自己的SSH Key，为后续的SSH连接做准备。
5.  **SSH 连接并执行命令：** 使用Paramiko库建立SSH连接，关键在于设置环境变量`--split-string`，该变量的值会被注入到`git-upload-pack`命令中，导致命令执行。实际执行的命令是`git-upload-pack <repo_path>`，而`--split-string`的值会作为额外的参数传递给这个命令。

**投毒风险分析：**

该POC代码主要分为两个部分：一部分是利用Gogs API进行用户认证、创建仓库、管理SSH Key等操作；另一部分是建立SSH连接，并利用`--split-string`参数注入执行命令。

API调用部分的代码相对安全，风险较低。主要的潜在投毒点在于以下几个方面：

*   **命令执行字符串：** 攻击者可能会在提供的command参数中嵌入恶意代码，但这是用户可控的，不属于POC本身投毒。
*   **SSH密钥生成或处理：** 如果POC包含SSH密钥生成功能，可能会生成弱密钥或者后门密钥。但当前代码直接使用用户提供的密钥文件，因此不存在此风险。
*   **其他隐藏的恶意代码：** 理论上，作者可以在代码中添加其他隐藏的恶意行为，例如收集用户信息、植入持久化后门等。但是，该POC代码逻辑相对简单，没有发现明显的恶意代码。

基于以上分析，此POC的投毒风险较低，大约为1%。风险主要集中在用户提供的执行命令字符串本身是否存在恶意行为，而非POC代码本身。

**项目地址:** [theMcSam/CVE-2024-39930-PoC](https://github.com/theMcSam/CVE-2024-39930-PoC)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---



---

## POC #3

**来源**: [CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md](../2024/CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md)

## CVE-2024-39930-Gogs-远程代码执行

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行

**影响应用:** Gogs

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs内置SSH服务已启用，并拥有一个有效的用户账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-39930是Gogs 0.13.0及更早版本中内置SSH服务器存在的一个参数注入漏洞。攻击者可以通过建立SSH连接，并发送恶意的`--split-string`环境变量请求，从而执行任意代码。该漏洞影响Linux环境下的Gogs实例，Windows实例不受影响。

**漏洞利用方式：**

1.  **获取API Token：** 首先，利用Gogs API，通过用户名和密码获取API Token。这是后续操作的身份验证凭据。
2.  **创建仓库（可选）：** 创建一个新的Git仓库，虽然从原理上来说不是必须，但是poc中做了此操作,可能是为了更方便的触发git相关功能。
3.  **删除现有SSH Key：** 删除用户已有的SSH Key，保证攻击者可以上传自己控制的Key。
4.  **添加SSH Key：** 上传攻击者自己的SSH Key，为后续的SSH连接做准备。
5.  **SSH 连接并执行命令：** 使用Paramiko库建立SSH连接，关键在于设置环境变量`--split-string`，该变量的值会被注入到`git-upload-pack`命令中，导致命令执行。实际执行的命令是`git-upload-pack <repo_path>`，而`--split-string`的值会作为额外的参数传递给这个命令。

**投毒风险分析：**

该POC代码主要分为两个部分：一部分是利用Gogs API进行用户认证、创建仓库、管理SSH Key等操作；另一部分是建立SSH连接，并利用`--split-string`参数注入执行命令。

API调用部分的代码相对安全，风险较低。主要的潜在投毒点在于以下几个方面：

*   **命令执行字符串：** 攻击者可能会在提供的command参数中嵌入恶意代码，但这是用户可控的，不属于POC本身投毒。
*   **SSH密钥生成或处理：** 如果POC包含SSH密钥生成功能，可能会生成弱密钥或者后门密钥。但当前代码直接使用用户提供的密钥文件，因此不存在此风险。
*   **其他隐藏的恶意代码：** 理论上，作者可以在代码中添加其他隐藏的恶意行为，例如收集用户信息、植入持久化后门等。但是，该POC代码逻辑相对简单，没有发现明显的恶意代码。

基于以上分析，此POC的投毒风险较低，大约为1%。风险主要集中在用户提供的执行命令字符串本身是否存在恶意行为，而非POC代码本身。

**项目地址:** [theMcSam/CVE-2024-39930-PoC](https://github.com/theMcSam/CVE-2024-39930-PoC)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---



---

## POC #3

**来源**: [CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md](../2024/CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md)

## CVE-2024-39930-Gogs-远程代码执行

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行

**影响应用:** Gogs

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs内置SSH服务已启用，并拥有一个有效的用户账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-39930是Gogs 0.13.0及更早版本中内置SSH服务器存在的一个参数注入漏洞。攻击者可以通过建立SSH连接，并发送恶意的`--split-string`环境变量请求，从而执行任意代码。该漏洞影响Linux环境下的Gogs实例，Windows实例不受影响。

**漏洞利用方式：**

1.  **获取API Token：** 首先，利用Gogs API，通过用户名和密码获取API Token。这是后续操作的身份验证凭据。
2.  **创建仓库（可选）：** 创建一个新的Git仓库，虽然从原理上来说不是必须，但是poc中做了此操作,可能是为了更方便的触发git相关功能。
3.  **删除现有SSH Key：** 删除用户已有的SSH Key，保证攻击者可以上传自己控制的Key。
4.  **添加SSH Key：** 上传攻击者自己的SSH Key，为后续的SSH连接做准备。
5.  **SSH 连接并执行命令：** 使用Paramiko库建立SSH连接，关键在于设置环境变量`--split-string`，该变量的值会被注入到`git-upload-pack`命令中，导致命令执行。实际执行的命令是`git-upload-pack <repo_path>`，而`--split-string`的值会作为额外的参数传递给这个命令。

**投毒风险分析：**

该POC代码主要分为两个部分：一部分是利用Gogs API进行用户认证、创建仓库、管理SSH Key等操作；另一部分是建立SSH连接，并利用`--split-string`参数注入执行命令。

API调用部分的代码相对安全，风险较低。主要的潜在投毒点在于以下几个方面：

*   **命令执行字符串：** 攻击者可能会在提供的command参数中嵌入恶意代码，但这是用户可控的，不属于POC本身投毒。
*   **SSH密钥生成或处理：** 如果POC包含SSH密钥生成功能，可能会生成弱密钥或者后门密钥。但当前代码直接使用用户提供的密钥文件，因此不存在此风险。
*   **其他隐藏的恶意代码：** 理论上，作者可以在代码中添加其他隐藏的恶意行为，例如收集用户信息、植入持久化后门等。但是，该POC代码逻辑相对简单，没有发现明显的恶意代码。

基于以上分析，此POC的投毒风险较低，大约为1%。风险主要集中在用户提供的执行命令字符串本身是否存在恶意行为，而非POC代码本身。

**项目地址:** [theMcSam/CVE-2024-39930-PoC](https://github.com/theMcSam/CVE-2024-39930-PoC)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---



---

## POC #3

**来源**: [CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md](../2024/CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md)

## CVE-2024-39930-Gogs-远程代码执行

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行

**影响应用:** Gogs

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs内置SSH服务已启用，并拥有一个有效的用户账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-39930是Gogs 0.13.0及更早版本中内置SSH服务器存在的一个参数注入漏洞。攻击者可以通过建立SSH连接，并发送恶意的`--split-string`环境变量请求，从而执行任意代码。该漏洞影响Linux环境下的Gogs实例，Windows实例不受影响。

**漏洞利用方式：**

1.  **获取API Token：** 首先，利用Gogs API，通过用户名和密码获取API Token。这是后续操作的身份验证凭据。
2.  **创建仓库（可选）：** 创建一个新的Git仓库，虽然从原理上来说不是必须，但是poc中做了此操作,可能是为了更方便的触发git相关功能。
3.  **删除现有SSH Key：** 删除用户已有的SSH Key，保证攻击者可以上传自己控制的Key。
4.  **添加SSH Key：** 上传攻击者自己的SSH Key，为后续的SSH连接做准备。
5.  **SSH 连接并执行命令：** 使用Paramiko库建立SSH连接，关键在于设置环境变量`--split-string`，该变量的值会被注入到`git-upload-pack`命令中，导致命令执行。实际执行的命令是`git-upload-pack <repo_path>`，而`--split-string`的值会作为额外的参数传递给这个命令。

**投毒风险分析：**

该POC代码主要分为两个部分：一部分是利用Gogs API进行用户认证、创建仓库、管理SSH Key等操作；另一部分是建立SSH连接，并利用`--split-string`参数注入执行命令。

API调用部分的代码相对安全，风险较低。主要的潜在投毒点在于以下几个方面：

*   **命令执行字符串：** 攻击者可能会在提供的command参数中嵌入恶意代码，但这是用户可控的，不属于POC本身投毒。
*   **SSH密钥生成或处理：** 如果POC包含SSH密钥生成功能，可能会生成弱密钥或者后门密钥。但当前代码直接使用用户提供的密钥文件，因此不存在此风险。
*   **其他隐藏的恶意代码：** 理论上，作者可以在代码中添加其他隐藏的恶意行为，例如收集用户信息、植入持久化后门等。但是，该POC代码逻辑相对简单，没有发现明显的恶意代码。

基于以上分析，此POC的投毒风险较低，大约为1%。风险主要集中在用户提供的执行命令字符串本身是否存在恶意行为，而非POC代码本身。

**项目地址:** [theMcSam/CVE-2024-39930-PoC](https://github.com/theMcSam/CVE-2024-39930-PoC)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---



---

## POC #3

**来源**: [CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md](../2024/CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md)

## CVE-2024-39930-Gogs-远程代码执行

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行

**影响应用:** Gogs

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs内置SSH服务已启用，并拥有一个有效的用户账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-39930是Gogs 0.13.0及更早版本中内置SSH服务器存在的一个参数注入漏洞。攻击者可以通过建立SSH连接，并发送恶意的`--split-string`环境变量请求，从而执行任意代码。该漏洞影响Linux环境下的Gogs实例，Windows实例不受影响。

**漏洞利用方式：**

1.  **获取API Token：** 首先，利用Gogs API，通过用户名和密码获取API Token。这是后续操作的身份验证凭据。
2.  **创建仓库（可选）：** 创建一个新的Git仓库，虽然从原理上来说不是必须，但是poc中做了此操作,可能是为了更方便的触发git相关功能。
3.  **删除现有SSH Key：** 删除用户已有的SSH Key，保证攻击者可以上传自己控制的Key。
4.  **添加SSH Key：** 上传攻击者自己的SSH Key，为后续的SSH连接做准备。
5.  **SSH 连接并执行命令：** 使用Paramiko库建立SSH连接，关键在于设置环境变量`--split-string`，该变量的值会被注入到`git-upload-pack`命令中，导致命令执行。实际执行的命令是`git-upload-pack <repo_path>`，而`--split-string`的值会作为额外的参数传递给这个命令。

**投毒风险分析：**

该POC代码主要分为两个部分：一部分是利用Gogs API进行用户认证、创建仓库、管理SSH Key等操作；另一部分是建立SSH连接，并利用`--split-string`参数注入执行命令。

API调用部分的代码相对安全，风险较低。主要的潜在投毒点在于以下几个方面：

*   **命令执行字符串：** 攻击者可能会在提供的command参数中嵌入恶意代码，但这是用户可控的，不属于POC本身投毒。
*   **SSH密钥生成或处理：** 如果POC包含SSH密钥生成功能，可能会生成弱密钥或者后门密钥。但当前代码直接使用用户提供的密钥文件，因此不存在此风险。
*   **其他隐藏的恶意代码：** 理论上，作者可以在代码中添加其他隐藏的恶意行为，例如收集用户信息、植入持久化后门等。但是，该POC代码逻辑相对简单，没有发现明显的恶意代码。

基于以上分析，此POC的投毒风险较低，大约为1%。风险主要集中在用户提供的执行命令字符串本身是否存在恶意行为，而非POC代码本身。

**项目地址:** [theMcSam/CVE-2024-39930-PoC](https://github.com/theMcSam/CVE-2024-39930-PoC)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---



---

## POC #3

**来源**: [CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md](../2024/CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md)

## CVE-2024-39930-Gogs-远程代码执行

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行

**影响应用:** Gogs

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs内置SSH服务已启用，并拥有一个有效的用户账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-39930是Gogs 0.13.0及更早版本中内置SSH服务器存在的一个参数注入漏洞。攻击者可以通过建立SSH连接，并发送恶意的`--split-string`环境变量请求，从而执行任意代码。该漏洞影响Linux环境下的Gogs实例，Windows实例不受影响。

**漏洞利用方式：**

1.  **获取API Token：** 首先，利用Gogs API，通过用户名和密码获取API Token。这是后续操作的身份验证凭据。
2.  **创建仓库（可选）：** 创建一个新的Git仓库，虽然从原理上来说不是必须，但是poc中做了此操作,可能是为了更方便的触发git相关功能。
3.  **删除现有SSH Key：** 删除用户已有的SSH Key，保证攻击者可以上传自己控制的Key。
4.  **添加SSH Key：** 上传攻击者自己的SSH Key，为后续的SSH连接做准备。
5.  **SSH 连接并执行命令：** 使用Paramiko库建立SSH连接，关键在于设置环境变量`--split-string`，该变量的值会被注入到`git-upload-pack`命令中，导致命令执行。实际执行的命令是`git-upload-pack <repo_path>`，而`--split-string`的值会作为额外的参数传递给这个命令。

**投毒风险分析：**

该POC代码主要分为两个部分：一部分是利用Gogs API进行用户认证、创建仓库、管理SSH Key等操作；另一部分是建立SSH连接，并利用`--split-string`参数注入执行命令。

API调用部分的代码相对安全，风险较低。主要的潜在投毒点在于以下几个方面：

*   **命令执行字符串：** 攻击者可能会在提供的command参数中嵌入恶意代码，但这是用户可控的，不属于POC本身投毒。
*   **SSH密钥生成或处理：** 如果POC包含SSH密钥生成功能，可能会生成弱密钥或者后门密钥。但当前代码直接使用用户提供的密钥文件，因此不存在此风险。
*   **其他隐藏的恶意代码：** 理论上，作者可以在代码中添加其他隐藏的恶意行为，例如收集用户信息、植入持久化后门等。但是，该POC代码逻辑相对简单，没有发现明显的恶意代码。

基于以上分析，此POC的投毒风险较低，大约为1%。风险主要集中在用户提供的执行命令字符串本身是否存在恶意行为，而非POC代码本身。

**项目地址:** [theMcSam/CVE-2024-39930-PoC](https://github.com/theMcSam/CVE-2024-39930-PoC)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---



---

## POC #3

**来源**: [CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md](../2024/CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md)

## CVE-2024-39930-Gogs-远程代码执行

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行

**影响应用:** Gogs

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs内置SSH服务已启用，并拥有一个有效的用户账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-39930是Gogs 0.13.0及更早版本中内置SSH服务器存在的一个参数注入漏洞。攻击者可以通过建立SSH连接，并发送恶意的`--split-string`环境变量请求，从而执行任意代码。该漏洞影响Linux环境下的Gogs实例，Windows实例不受影响。

**漏洞利用方式：**

1.  **获取API Token：** 首先，利用Gogs API，通过用户名和密码获取API Token。这是后续操作的身份验证凭据。
2.  **创建仓库（可选）：** 创建一个新的Git仓库，虽然从原理上来说不是必须，但是poc中做了此操作,可能是为了更方便的触发git相关功能。
3.  **删除现有SSH Key：** 删除用户已有的SSH Key，保证攻击者可以上传自己控制的Key。
4.  **添加SSH Key：** 上传攻击者自己的SSH Key，为后续的SSH连接做准备。
5.  **SSH 连接并执行命令：** 使用Paramiko库建立SSH连接，关键在于设置环境变量`--split-string`，该变量的值会被注入到`git-upload-pack`命令中，导致命令执行。实际执行的命令是`git-upload-pack <repo_path>`，而`--split-string`的值会作为额外的参数传递给这个命令。

**投毒风险分析：**

该POC代码主要分为两个部分：一部分是利用Gogs API进行用户认证、创建仓库、管理SSH Key等操作；另一部分是建立SSH连接，并利用`--split-string`参数注入执行命令。

API调用部分的代码相对安全，风险较低。主要的潜在投毒点在于以下几个方面：

*   **命令执行字符串：** 攻击者可能会在提供的command参数中嵌入恶意代码，但这是用户可控的，不属于POC本身投毒。
*   **SSH密钥生成或处理：** 如果POC包含SSH密钥生成功能，可能会生成弱密钥或者后门密钥。但当前代码直接使用用户提供的密钥文件，因此不存在此风险。
*   **其他隐藏的恶意代码：** 理论上，作者可以在代码中添加其他隐藏的恶意行为，例如收集用户信息、植入持久化后门等。但是，该POC代码逻辑相对简单，没有发现明显的恶意代码。

基于以上分析，此POC的投毒风险较低，大约为1%。风险主要集中在用户提供的执行命令字符串本身是否存在恶意行为，而非POC代码本身。

**项目地址:** [theMcSam/CVE-2024-39930-PoC](https://github.com/theMcSam/CVE-2024-39930-PoC)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---



---

## POC #3

**来源**: [CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md](../2024/CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md)

## CVE-2024-39930-Gogs-远程代码执行

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行

**影响应用:** Gogs

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs内置SSH服务已启用，并拥有一个有效的用户账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-39930是Gogs 0.13.0及更早版本中内置SSH服务器存在的一个参数注入漏洞。攻击者可以通过建立SSH连接，并发送恶意的`--split-string`环境变量请求，从而执行任意代码。该漏洞影响Linux环境下的Gogs实例，Windows实例不受影响。

**漏洞利用方式：**

1.  **获取API Token：** 首先，利用Gogs API，通过用户名和密码获取API Token。这是后续操作的身份验证凭据。
2.  **创建仓库（可选）：** 创建一个新的Git仓库，虽然从原理上来说不是必须，但是poc中做了此操作,可能是为了更方便的触发git相关功能。
3.  **删除现有SSH Key：** 删除用户已有的SSH Key，保证攻击者可以上传自己控制的Key。
4.  **添加SSH Key：** 上传攻击者自己的SSH Key，为后续的SSH连接做准备。
5.  **SSH 连接并执行命令：** 使用Paramiko库建立SSH连接，关键在于设置环境变量`--split-string`，该变量的值会被注入到`git-upload-pack`命令中，导致命令执行。实际执行的命令是`git-upload-pack <repo_path>`，而`--split-string`的值会作为额外的参数传递给这个命令。

**投毒风险分析：**

该POC代码主要分为两个部分：一部分是利用Gogs API进行用户认证、创建仓库、管理SSH Key等操作；另一部分是建立SSH连接，并利用`--split-string`参数注入执行命令。

API调用部分的代码相对安全，风险较低。主要的潜在投毒点在于以下几个方面：

*   **命令执行字符串：** 攻击者可能会在提供的command参数中嵌入恶意代码，但这是用户可控的，不属于POC本身投毒。
*   **SSH密钥生成或处理：** 如果POC包含SSH密钥生成功能，可能会生成弱密钥或者后门密钥。但当前代码直接使用用户提供的密钥文件，因此不存在此风险。
*   **其他隐藏的恶意代码：** 理论上，作者可以在代码中添加其他隐藏的恶意行为，例如收集用户信息、植入持久化后门等。但是，该POC代码逻辑相对简单，没有发现明显的恶意代码。

基于以上分析，此POC的投毒风险较低，大约为1%。风险主要集中在用户提供的执行命令字符串本身是否存在恶意行为，而非POC代码本身。

**项目地址:** [theMcSam/CVE-2024-39930-PoC](https://github.com/theMcSam/CVE-2024-39930-PoC)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---



---

## POC #3

**来源**: [CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md](../2024/CVE-2024-39930-theMcSam_CVE-2024-39930-PoC.md)

## CVE-2024-39930-Gogs-远程代码执行

**漏洞编号:** CVE-2024-39930

**漏洞类型:** 远程代码执行

**影响应用:** Gogs

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.13.0

**利用条件:** 需要Gogs内置SSH服务已启用，并拥有一个有效的用户账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-39930是Gogs 0.13.0及更早版本中内置SSH服务器存在的一个参数注入漏洞。攻击者可以通过建立SSH连接，并发送恶意的`--split-string`环境变量请求，从而执行任意代码。该漏洞影响Linux环境下的Gogs实例，Windows实例不受影响。

**漏洞利用方式：**

1.  **获取API Token：** 首先，利用Gogs API，通过用户名和密码获取API Token。这是后续操作的身份验证凭据。
2.  **创建仓库（可选）：** 创建一个新的Git仓库，虽然从原理上来说不是必须，但是poc中做了此操作,可能是为了更方便的触发git相关功能。
3.  **删除现有SSH Key：** 删除用户已有的SSH Key，保证攻击者可以上传自己控制的Key。
4.  **添加SSH Key：** 上传攻击者自己的SSH Key，为后续的SSH连接做准备。
5.  **SSH 连接并执行命令：** 使用Paramiko库建立SSH连接，关键在于设置环境变量`--split-string`，该变量的值会被注入到`git-upload-pack`命令中，导致命令执行。实际执行的命令是`git-upload-pack <repo_path>`，而`--split-string`的值会作为额外的参数传递给这个命令。

**投毒风险分析：**

该POC代码主要分为两个部分：一部分是利用Gogs API进行用户认证、创建仓库、管理SSH Key等操作；另一部分是建立SSH连接，并利用`--split-string`参数注入执行命令。

API调用部分的代码相对安全，风险较低。主要的潜在投毒点在于以下几个方面：

*   **命令执行字符串：** 攻击者可能会在提供的command参数中嵌入恶意代码，但这是用户可控的，不属于POC本身投毒。
*   **SSH密钥生成或处理：** 如果POC包含SSH密钥生成功能，可能会生成弱密钥或者后门密钥。但当前代码直接使用用户提供的密钥文件，因此不存在此风险。
*   **其他隐藏的恶意代码：** 理论上，作者可以在代码中添加其他隐藏的恶意行为，例如收集用户信息、植入持久化后门等。但是，该POC代码逻辑相对简单，没有发现明显的恶意代码。

基于以上分析，此POC的投毒风险较低，大约为1%。风险主要集中在用户提供的执行命令字符串本身是否存在恶意行为，而非POC代码本身。

**项目地址:** [theMcSam/CVE-2024-39930-PoC](https://github.com/theMcSam/CVE-2024-39930-PoC)

**漏洞详情:** [CVE-2024-39930](https://nvd.nist.gov/vuln/detail/CVE-2024-39930)

---

