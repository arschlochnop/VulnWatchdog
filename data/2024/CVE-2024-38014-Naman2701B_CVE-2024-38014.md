# CVE-2024-38014

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38014-Naman2701B_CVE-2024-38014.md](../2024/CVE-2024-38014-Naman2701B_CVE-2024-38014.md)

# CVE-2024-38014

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38014-Naman2701B_CVE-2024-38014.md](../2024/CVE-2024-38014-Naman2701B_CVE-2024-38014.md)

# CVE-2024-38014

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38014-Naman2701B_CVE-2024-38014.md](../2024/CVE-2024-38014-Naman2701B_CVE-2024-38014.md)

# CVE-2024-38014

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38014-Naman2701B_CVE-2024-38014.md](../2024/CVE-2024-38014-Naman2701B_CVE-2024-38014.md)

# CVE-2024-38014

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38014-Naman2701B_CVE-2024-38014.md](../2024/CVE-2024-38014-Naman2701B_CVE-2024-38014.md)

## CVE-2024-38014 Windows Installer 特权提升漏洞

**漏洞编号:** CVE-2024-38014

**漏洞类型:** 特权提升

**影响应用:** Windows Installer

**危害等级:** 高危，可能导致本地用户获取SYSTEM权限

**影响版本:** 受影响的Windows版本（见CVE描述）

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38014 是一个 Windows Installer 的特权提升漏洞。根据漏洞信息和搜索结果，该漏洞允许本地低权限用户提升到 SYSTEM 权限。漏洞存在于 MSI 安装程序的修复功能中。攻击者可以利用此漏洞执行任意代码并获得 SYSTEM 权限。

**有效性：**
提供的漏洞利用代码包含一个 Visual Studio 解决方案，该解决方案构建一个恶意的 MSI 安装包。该 MSI 安装包包含一个名为 evil.dll 的 DLL 文件，并在安装过程中通过自定义操作执行该 DLL 里的 `MyEntryPoint` 函数，`Impersonate="no"`表明该自定义操作以SYSTEM权限运行。因此，如果该DLL编译成功且漏洞存在，该代码应能有效利用该漏洞。

**投毒风险：**
代码仓库中可能存在的投毒代码在于 `evil.dll` 的内容。 由于没有提供 `evil.dll` 的源代码，我们无法确定该 DLL 是否包含恶意代码（例如，安装后门、收集用户信息等）。如果攻击者分发了包含恶意 `evil.dll` 的 MSI 文件，则可能构成投毒攻击。因此，存在一定投毒风险，但风险主要集中在 DLL 的具体实现上，从目前给定的代码来看，风险较低, 故投毒风险评估为5%。

**利用方式：**
1.  攻击者创建一个恶意的 MSI 安装包 (利用提供的wix工程).
2.  该 MSI 安装包包含一个特制的 DLL 文件 (`evil.dll`)，该 DLL 包含攻击者的恶意代码。
3.  攻击者诱使用户（受害者）运行此 MSI 安装包。
4.  安装程序运行，当执行到安装包中预先设置的自定义操作时，将以 SYSTEM 权限加载并执行 `evil.dll` 中的 `MyEntryPoint` 函数。
5.  恶意代码以 SYSTEM 权限运行，从而允许攻击者完全控制受害者的系统。

**项目地址:** [Naman2701B/CVE-2024-38014](https://github.com/Naman2701B/CVE-2024-38014)

**漏洞详情:** [CVE-2024-38014](https://nvd.nist.gov/vuln/detail/CVE-2024-38014)

---

## POC #2

**来源**: [CVE-2024-38014-Naman2701B_DLL-for-2024-38014.md](../2024/CVE-2024-38014-Naman2701B_DLL-for-2024-38014.md)

## CVE-2024-38014-Windows Installer Elevation of Privilege

**漏洞编号:** CVE-2024-38014

**漏洞类型:** 权限提升

**影响应用:** Windows Installer

**危害等级:** 高危，攻击者可以利用此漏洞获取SYSTEM权限

**影响版本:** 见CVE信息中的受影响版本范围

**利用条件:** 本地低权限用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38014是一个Windows Installer权限提升漏洞。攻击者可以利用此漏洞，通过精心设计的 MSI 文件或者修复功能，以 SYSTEM 权限执行任意代码。根据搜索结果，该漏洞存在于 MSI 安装程序的修复功能中，低权限用户可以执行该功能，但该功能以 NT AUTHORITY\SYSTEM 权限运行，这为权限提升创造了条件。

**有效性：**
提供的漏洞利用代码是 Visual Studio solution 文件，包含一个名为 "evil" 的 DLL 项目。这个 DLL 很可能被设计成利用该漏洞，通过 Windows Installer 以 SYSTEM 权限执行恶意代码。

**投毒风险：**
虽然提供的代码片段主要定义了项目结构，但具体恶意代码位于 `evil.cpp` 或类似源文件中，此处未提供。因此，无法完全排除投毒的可能性。投毒风险评估为 10%。风险主要体现在：
*   **Payload 植入：** DLL 内部可能包含恶意 payload，例如执行 shellcode、添加后门用户或修改系统配置等。
*   **远程连接：** 恶意代码可能尝试连接到外部服务器，以下载更多 payload 或泄露信息。
*   **破坏性操作：** 可能包含删除文件、停止服务等破坏性操作。

**利用方式：**
1.  攻击者创建一个恶意的 MSI 安装包，该安装包在安装或修复过程中会加载并执行 "evil.dll"。
2.  或者，攻击者可以利用现有的已安装应用程序的修复功能，诱导系统加载和执行 "evil.dll"。
3.  "evil.dll" 在 SYSTEM 权限下执行，从而允许攻击者执行任意操作，例如添加具有管理员权限的用户。



**项目地址:** [Naman2701B/DLL-for-2024-38014](https://github.com/Naman2701B/DLL-for-2024-38014)

**漏洞详情:** [CVE-2024-38014](https://nvd.nist.gov/vuln/detail/CVE-2024-38014)

---



---

## POC #2

**来源**: [CVE-2024-38014-Naman2701B_DLL-for-2024-38014.md](../2024/CVE-2024-38014-Naman2701B_DLL-for-2024-38014.md)

## CVE-2024-38014-Windows Installer Elevation of Privilege

**漏洞编号:** CVE-2024-38014

**漏洞类型:** 权限提升

**影响应用:** Windows Installer

**危害等级:** 高危，攻击者可以利用此漏洞获取SYSTEM权限

**影响版本:** 见CVE信息中的受影响版本范围

**利用条件:** 本地低权限用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38014是一个Windows Installer权限提升漏洞。攻击者可以利用此漏洞，通过精心设计的 MSI 文件或者修复功能，以 SYSTEM 权限执行任意代码。根据搜索结果，该漏洞存在于 MSI 安装程序的修复功能中，低权限用户可以执行该功能，但该功能以 NT AUTHORITY\SYSTEM 权限运行，这为权限提升创造了条件。

**有效性：**
提供的漏洞利用代码是 Visual Studio solution 文件，包含一个名为 "evil" 的 DLL 项目。这个 DLL 很可能被设计成利用该漏洞，通过 Windows Installer 以 SYSTEM 权限执行恶意代码。

**投毒风险：**
虽然提供的代码片段主要定义了项目结构，但具体恶意代码位于 `evil.cpp` 或类似源文件中，此处未提供。因此，无法完全排除投毒的可能性。投毒风险评估为 10%。风险主要体现在：
*   **Payload 植入：** DLL 内部可能包含恶意 payload，例如执行 shellcode、添加后门用户或修改系统配置等。
*   **远程连接：** 恶意代码可能尝试连接到外部服务器，以下载更多 payload 或泄露信息。
*   **破坏性操作：** 可能包含删除文件、停止服务等破坏性操作。

**利用方式：**
1.  攻击者创建一个恶意的 MSI 安装包，该安装包在安装或修复过程中会加载并执行 "evil.dll"。
2.  或者，攻击者可以利用现有的已安装应用程序的修复功能，诱导系统加载和执行 "evil.dll"。
3.  "evil.dll" 在 SYSTEM 权限下执行，从而允许攻击者执行任意操作，例如添加具有管理员权限的用户。



**项目地址:** [Naman2701B/DLL-for-2024-38014](https://github.com/Naman2701B/DLL-for-2024-38014)

**漏洞详情:** [CVE-2024-38014](https://nvd.nist.gov/vuln/detail/CVE-2024-38014)

---



---

## POC #2

**来源**: [CVE-2024-38014-Naman2701B_DLL-for-2024-38014.md](../2024/CVE-2024-38014-Naman2701B_DLL-for-2024-38014.md)

## CVE-2024-38014-Windows Installer Elevation of Privilege

**漏洞编号:** CVE-2024-38014

**漏洞类型:** 权限提升

**影响应用:** Windows Installer

**危害等级:** 高危，攻击者可以利用此漏洞获取SYSTEM权限

**影响版本:** 见CVE信息中的受影响版本范围

**利用条件:** 本地低权限用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38014是一个Windows Installer权限提升漏洞。攻击者可以利用此漏洞，通过精心设计的 MSI 文件或者修复功能，以 SYSTEM 权限执行任意代码。根据搜索结果，该漏洞存在于 MSI 安装程序的修复功能中，低权限用户可以执行该功能，但该功能以 NT AUTHORITY\SYSTEM 权限运行，这为权限提升创造了条件。

**有效性：**
提供的漏洞利用代码是 Visual Studio solution 文件，包含一个名为 "evil" 的 DLL 项目。这个 DLL 很可能被设计成利用该漏洞，通过 Windows Installer 以 SYSTEM 权限执行恶意代码。

**投毒风险：**
虽然提供的代码片段主要定义了项目结构，但具体恶意代码位于 `evil.cpp` 或类似源文件中，此处未提供。因此，无法完全排除投毒的可能性。投毒风险评估为 10%。风险主要体现在：
*   **Payload 植入：** DLL 内部可能包含恶意 payload，例如执行 shellcode、添加后门用户或修改系统配置等。
*   **远程连接：** 恶意代码可能尝试连接到外部服务器，以下载更多 payload 或泄露信息。
*   **破坏性操作：** 可能包含删除文件、停止服务等破坏性操作。

**利用方式：**
1.  攻击者创建一个恶意的 MSI 安装包，该安装包在安装或修复过程中会加载并执行 "evil.dll"。
2.  或者，攻击者可以利用现有的已安装应用程序的修复功能，诱导系统加载和执行 "evil.dll"。
3.  "evil.dll" 在 SYSTEM 权限下执行，从而允许攻击者执行任意操作，例如添加具有管理员权限的用户。



**项目地址:** [Naman2701B/DLL-for-2024-38014](https://github.com/Naman2701B/DLL-for-2024-38014)

**漏洞详情:** [CVE-2024-38014](https://nvd.nist.gov/vuln/detail/CVE-2024-38014)

---



---

## POC #2

**来源**: [CVE-2024-38014-Naman2701B_DLL-for-2024-38014.md](../2024/CVE-2024-38014-Naman2701B_DLL-for-2024-38014.md)

## CVE-2024-38014-Windows Installer Elevation of Privilege

**漏洞编号:** CVE-2024-38014

**漏洞类型:** 权限提升

**影响应用:** Windows Installer

**危害等级:** 高危，攻击者可以利用此漏洞获取SYSTEM权限

**影响版本:** 见CVE信息中的受影响版本范围

**利用条件:** 本地低权限用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38014是一个Windows Installer权限提升漏洞。攻击者可以利用此漏洞，通过精心设计的 MSI 文件或者修复功能，以 SYSTEM 权限执行任意代码。根据搜索结果，该漏洞存在于 MSI 安装程序的修复功能中，低权限用户可以执行该功能，但该功能以 NT AUTHORITY\SYSTEM 权限运行，这为权限提升创造了条件。

**有效性：**
提供的漏洞利用代码是 Visual Studio solution 文件，包含一个名为 "evil" 的 DLL 项目。这个 DLL 很可能被设计成利用该漏洞，通过 Windows Installer 以 SYSTEM 权限执行恶意代码。

**投毒风险：**
虽然提供的代码片段主要定义了项目结构，但具体恶意代码位于 `evil.cpp` 或类似源文件中，此处未提供。因此，无法完全排除投毒的可能性。投毒风险评估为 10%。风险主要体现在：
*   **Payload 植入：** DLL 内部可能包含恶意 payload，例如执行 shellcode、添加后门用户或修改系统配置等。
*   **远程连接：** 恶意代码可能尝试连接到外部服务器，以下载更多 payload 或泄露信息。
*   **破坏性操作：** 可能包含删除文件、停止服务等破坏性操作。

**利用方式：**
1.  攻击者创建一个恶意的 MSI 安装包，该安装包在安装或修复过程中会加载并执行 "evil.dll"。
2.  或者，攻击者可以利用现有的已安装应用程序的修复功能，诱导系统加载和执行 "evil.dll"。
3.  "evil.dll" 在 SYSTEM 权限下执行，从而允许攻击者执行任意操作，例如添加具有管理员权限的用户。



**项目地址:** [Naman2701B/DLL-for-2024-38014](https://github.com/Naman2701B/DLL-for-2024-38014)

**漏洞详情:** [CVE-2024-38014](https://nvd.nist.gov/vuln/detail/CVE-2024-38014)

---



---

## POC #2

**来源**: [CVE-2024-38014-Naman2701B_DLL-for-2024-38014.md](../2024/CVE-2024-38014-Naman2701B_DLL-for-2024-38014.md)

## CVE-2024-38014-Windows Installer Elevation of Privilege

**漏洞编号:** CVE-2024-38014

**漏洞类型:** 权限提升

**影响应用:** Windows Installer

**危害等级:** 高危，攻击者可以利用此漏洞获取SYSTEM权限

**影响版本:** 见CVE信息中的受影响版本范围

**利用条件:** 本地低权限用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38014是一个Windows Installer权限提升漏洞。攻击者可以利用此漏洞，通过精心设计的 MSI 文件或者修复功能，以 SYSTEM 权限执行任意代码。根据搜索结果，该漏洞存在于 MSI 安装程序的修复功能中，低权限用户可以执行该功能，但该功能以 NT AUTHORITY\SYSTEM 权限运行，这为权限提升创造了条件。

**有效性：**
提供的漏洞利用代码是 Visual Studio solution 文件，包含一个名为 "evil" 的 DLL 项目。这个 DLL 很可能被设计成利用该漏洞，通过 Windows Installer 以 SYSTEM 权限执行恶意代码。

**投毒风险：**
虽然提供的代码片段主要定义了项目结构，但具体恶意代码位于 `evil.cpp` 或类似源文件中，此处未提供。因此，无法完全排除投毒的可能性。投毒风险评估为 10%。风险主要体现在：
*   **Payload 植入：** DLL 内部可能包含恶意 payload，例如执行 shellcode、添加后门用户或修改系统配置等。
*   **远程连接：** 恶意代码可能尝试连接到外部服务器，以下载更多 payload 或泄露信息。
*   **破坏性操作：** 可能包含删除文件、停止服务等破坏性操作。

**利用方式：**
1.  攻击者创建一个恶意的 MSI 安装包，该安装包在安装或修复过程中会加载并执行 "evil.dll"。
2.  或者，攻击者可以利用现有的已安装应用程序的修复功能，诱导系统加载和执行 "evil.dll"。
3.  "evil.dll" 在 SYSTEM 权限下执行，从而允许攻击者执行任意操作，例如添加具有管理员权限的用户。



**项目地址:** [Naman2701B/DLL-for-2024-38014](https://github.com/Naman2701B/DLL-for-2024-38014)

**漏洞详情:** [CVE-2024-38014](https://nvd.nist.gov/vuln/detail/CVE-2024-38014)

---

