## CVE-2024-3094 - XZ Utils / liblzma 供应链攻击/后门 (RCE)

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门 (RCE)

**影响应用:** XZ Utils / liblzma

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响版本安装在运行sshd的Linux系统上，且sshd通过systemd与liblzma链接

**POC 可用性:** 8/10

**POC 类型:** 概念验证/检测工具

**攻击复杂度:** 高

**投毒风险:** 15%

## 详情

POC有效性分析：本POC仓库主要提供针对CVE-2024-3094的检测工具，而非利用代码。其核心逻辑在于检测本地安装的xz版本以及扫描特定的二进制特征。经过分析，该POC包含有效的版本检测脚本（strings $which xz | grep '5.6.[01]'）和二进制指纹匹配逻辑。对于防御性研究人员而言，这类检测脚本的有效性极高，能够准确识别环境中受污染的库文件。利用步骤：1. 攻击者通过长达两年的时间伪装成合法贡献者Jia Tan，获得XZ项目的维护权限。2. 在5.6.0和5.6.1版本的源码包中植入混淆的m4宏文件，在编译过程中动态注入恶意代码。3. 恶意代码（liblzma.so）在sshd启动时被加载，通过运行时挂钩（hooking）修改RSA_public_decrypt函数。4. 攻击者发送带有特定指令的RSA公钥，后门验证签名后跳过身份认证或执行Payload。投毒风险分析：该POC项目本身是一个防御性质的开源检测工具，代码逻辑透明，主要使用标准shell指令和二进制扫描逻辑，未发现混淆代码或可疑的外部网络连接，因此直接投毒风险较低（约15%）。然而，研究人员需警惕网络上出现的伪装成‘自动修复脚本’或‘一键漏洞利用（Exploit）’的虚假POC。真正的CVE-2024-3094后门利用具有极高的技术门槛，攻击者需要特定的私钥（Ed448算法）才能触发。如果用户在不信任的源下载所谓的‘利用脚本’并以root权限运行，极易遭遇第二波针对安全研究人员的投毒攻击。因此，建议仅从受信渠道（如知名安全公司的GitHub）获取检测工具，并严格审查任何需要sudo权限运行的脚本。

**项目地址:** [https://github.com/jfrog/cve-2024-3094-detector](https://www.google.com/search?q=https://github.com/jfrog/cve-2024-3094-detector)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)
