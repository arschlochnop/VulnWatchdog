## CVE-2024-53677 - Apache Struts 远程代码执行 (RCE)

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 严重 (CRITICAL)

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Struts 2.0.0 - 2.5.33, Struts 6.0.0 - 6.3.0.2

**利用条件:** 无需认证，远程网络访问，目标应用需开启文件上传功能且未升级至安全版本。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 25%

## 详情

【POC有效性分析】该提供的POC代码（CVE-2024-53677-S2-067-thread.py）是一个功能完整的针对Apache Struts2 S2-067漏洞的自动化渗透测试脚本。代码通过构造多部分（multipart/form-data）请求，利用Struts2文件上传逻辑中的路径遍历缺陷进行攻击。有效性体现在以下几个方面：首先，它实现了自动化的Payload生成，使用了Base64编码的JSP后门，能绕过简单的关键词过滤；其次，使用了requests_toolbelt构建复杂的multipart请求，模拟了WebKit边界，能够有效触发Struts的解析逻辑；再次，脚本包含了路径拼接逻辑，尝试将Payload写入Web可访问目录（如/uploads/）；最后，脚本具备多线程并发验证能力（ThreadPoolExecutor）和自动化回连验证。从代码逻辑看，该POC能直接获取服务器权限。利用步骤如下：1. 攻击者确定目标上传接口；2. 构造含有'../'序列的文件参数，将jsp文件定位到Web根目录；3. 脚本上传经过Base64混淆的jsp脚本；4. 脚本尝试访问上传后的路径并执行whoami指令。若返回预期结果，则证明漏洞存在并已成功利用。【投毒风险分析】在对此POC代码的安全性审查中，虽然该脚本包含了一些敏感操作，但初步判定其投毒风险处于较低水平（约25%）。风险点分析：脚本中使用了base64硬编码的JSP Payload，这在防御性研究中是标准做法，目的是为了验证RCE能力，而非真正的恶意投毒。脚本使用了random和string库来生成随机文件名，这避免了对目标系统的持久化破坏，符合安全研究的规范。唯一需要警惕的是其多线程模块，如果在未经授权的情况下大规模扫描，会导致目标服务DOS风险。代码中未发现隐藏的外部网络请求（除了对目标的请求）、未发现自我复制逻辑、也未发现针对运行环境（攻击者机器）的窃密行为。JSP载荷虽然包含Runtime.exec，但其目的是回显执行结果给研究员。整体来看，代码逻辑清晰，主要使用了标准Python库（requests, argparse），没有引入可疑的第三方闭源二进制文件。然而，由于脚本具备一键批量攻击的能力，若被恶意修改分发，其危害性极大，建议研究人员在隔离环境运行，并检查所有base64解码后的真实内容。

**项目地址:** [https://github.com/apache/struts](https://github.com/apache/struts)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)
