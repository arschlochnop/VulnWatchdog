## CVE-2024-5932 - GiveWP – Donation Plugin and Fundraising Platform PHP反序列化/RCE

**漏洞编号:** CVE-2024-5932

**漏洞类型:** PHP反序列化/RCE

**影响应用:** GiveWP – Donation Plugin and Fundraising Platform

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** <= 3.14.1

**利用条件:** 远程网络访问，无需身份验证，目标安装并启用了GiveWP插件且版本在受影响范围内

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码针对WordPress GiveWP插件中的CVE-2024-5932漏洞。漏洞根源在于插件在处理捐赠表单提交时，未能对用户输入的`give_title`等字段进行严格过滤，直接传递给`maybe_unserialize`函数，导致PHP反序列化漏洞。攻击者可以构造恶意序列化对象，结合插件内部或WordPress核心的POP链实现远程代码执行（RCE）。分析提供的Python脚本片段，它引用了`faker`生成伪造数据，`rich_click`用于命令行交互，显示出较高的工程化程度。脚本通过模拟合法的捐赠流程（获取Nonce值、提交表单），并在Payload部分植入精心构造的序列化字符串。由于该漏洞 CVSS 评分达到 10.0，且目前已有成熟的利用工具，其在野攻击风险极高，该POC在配置正确目标URL的情况下具有极高的成功率。利用步骤：1. 首先访问目标网站的捐赠页面，利用正则表达式或BeautifulSoup解析HTML获取必要的安全性校验字段如`give-form-id`、`give-form-hash`以及`_wpnonce`。2. 构造恶意的PHP序列化Payload，通常利用`GuzzleHttp`或类似的库作为POP链来触发系统命令执行。3. 将Payload封装在HTTP POST请求中发送至`/wp-admin/admin-ajax.php`或直接提交至捐赠表单处理接口。4. 如果利用成功，服务器将执行Payload中的命令，POC通常会尝试回显结果或建立反弹Shell。投毒风险分析：经过对POC代码结构的审查，该脚本主要使用了`requests`、`bs4`、`faker`等标准安全研究库，代码逻辑清晰，其核心功能是进行漏洞检测与复现。然而，由于脚本在Banner部分使用了较长且复杂的字符图形，且在截断部分可能包含对Payload的Base64编码处理，安全研究员需保持警惕。目前并未发现代码中存在典型的投毒特征，如尝试读取本地`~/.ssh`目录、上传敏感环境变量至外部C2服务器或执行隐藏的混淆代码（如`eval(base64_decode(...))`）。15%的风险评分主要来源于POC工具的传播来源不确定性以及在处理Payload反序列化时可能对测试环境造成的不可控影响。在使用此类POC时，建议在完全隔离的沙箱环境中运行，并使用抓包工具监控其是否存在异常的外部通信行为。总体而言，该代码更倾向于一个专业的漏洞验证工具，而非恶意投毒脚本，但在实际应用中仍需对其后续未显示的逻辑进行完整审计。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2024-5932-rce](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2024-5932-rce)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-5932](https://nvd.nist.gov/vuln/detail/CVE-2024-5932)
