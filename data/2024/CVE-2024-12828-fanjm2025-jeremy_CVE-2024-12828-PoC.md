## CVE-2024-12828 - Webmin 命令注入

**漏洞编号:** CVE-2024-12828

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危

**CVSS评分:** 9.9

**影响版本:** 未知，需进一步分析确定受影响版本范围，authentic-theme commit 61e5b10227b似乎修复了此问题。

**利用条件:** 需要有效的SID（会话ID）。需要能够通过HTTP(S)访问目标Webmin服务器。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2024-12828是一个存在于Webmin中的命令注入漏洞。该漏洞允许远程攻击者通过CGI请求处理执行任意代码。ZDI的报告指出，该漏洞存在于由用户提供的字符串的使用中。 

POC有效性分析：提供的POC代码是一个Python脚本，它利用了CVE-2024-12828漏洞。该脚本首先创建一个requests会话，然后构建一个包含恶意payload的HTTP POST请求。该payload包含一个反向shell，它试图连接到攻击者控制的IP地址和端口。脚本使用urllib.parse.quote对payload进行编码，以确保其在HTTP请求中正确传输。成功利用漏洞的前提是拥有一个有效的SID。脚本会发送构造好的数据包，若目标存在漏洞，将会在攻击者机器上建立一个反向shell。

利用步骤：
1. 获取目标Webmin服务器的SID（会话ID）。这可以通过合法的登录或其他漏洞利用方式实现。
2. 修改POC脚本中的target_ip、target_port、sid、lhost和lport变量，以匹配目标服务器和攻击者的IP地址和端口。
3. 运行POC脚本。脚本将发送包含恶意payload的HTTP POST请求到目标服务器。
4. 如果漏洞利用成功，目标服务器将执行payload，并建立一个与攻击者机器的反向shell连接。

投毒风险分析：
该POC的投毒风险较低，约为15%。原因是：
1. 代码结构清晰，易于理解。没有发现明显的混淆或隐藏的恶意行为。
2. 脚本使用标准的Python库，如requests、urllib.parse和socket，这些库通常是安全的。
3. 脚本的主要功能是发送HTTP请求和启动监听器，没有发现执行恶意操作的代码。
4. 脚本没有下载或执行任何外部脚本或文件。
5. 唯一的潜在风险是，攻击者可能会修改payload，以执行恶意操作，例如安装后门或窃取敏感数据。但是，这需要攻击者具备一定的技术知识，并且可以通过代码审查来降低风险。

总体而言，该POC的投毒风险较低，但仍需要谨慎使用，并进行代码审查，以确保其安全性。

**项目地址:** https://github.com/xxx/CVE-2024-12828（请自行搜索）

**漏洞详情:** https://www.cve.org/CVERecord?id=CVE-2024-12828
