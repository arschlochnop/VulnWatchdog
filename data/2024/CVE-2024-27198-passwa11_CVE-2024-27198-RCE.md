# CVE-2024-27198

> ğŸ“¦ è¯¥CVEæœ‰ **13** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-27198-ArtemCyberLab_Project-Exploiting-CVE-2024-27198-RCE-Vulnerability.md](../2024/CVE-2024-27198-ArtemCyberLab_Project-Exploiting-CVE-2024-27198-RCE-Vulnerability.md)

## CVE-2024-27198-TeamCity-è®¤è¯ç»•è¿‡RCE

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡RCE

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨æ§åˆ¶å—å½±å“çš„TeamCityæœåŠ¡å™¨

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡TeamCityæœåŠ¡å™¨ç‰ˆæœ¬ä½äº2023.11.4ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè¿›è¡Œç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-27198 å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œæ‰§è¡Œç®¡ç†æ“ä½œã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md)ï¼Œåˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  **ç›®æ ‡è¯†åˆ«:** æ‰¾åˆ°ç›®æ ‡TeamCityæœåŠ¡å™¨ï¼ˆç‰ˆæœ¬ä½äº2023.11.4ï¼‰ã€‚
2.  **æ¼æ´åˆ©ç”¨:** ä½¿ç”¨`CVE-2024-27198-RCE.py` è„šæœ¬è¿›è¡Œæ”»å‡»ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨ä¸Šä¼ æ¶æ„çš„æ’ä»¶ã€‚
3.  **æ’ä»¶æ¿€æ´»:** æ¶æ„æ’ä»¶è¢«æ¿€æ´»ï¼Œæä¾›äº†ä¸€ä¸ªwebshellè®¿é—®ã€‚
4.  **å‘½ä»¤æ‰§è¡Œ:** é€šè¿‡ webshell (ä½äºä¾‹å¦‚ `http://10.10.217.209:50000/plugins/zHXm20lm/zHXm20lm.jsp`)ï¼Œæ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä¾‹å¦‚`whoami`ã€`ls` å’Œ `cat /home/ubuntu/flag.txt`ã€‚
5.  **æ•°æ®è·å–:** æ”»å‡»è€…å¯ä»¥é€šè¿‡webshellè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚flagæ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç (README.mdæè¿°)æŒ‡ç¤ºæ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•ä¸Šä¼ æ¶æ„æ’ä»¶å¹¶é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚CISA KEV ä¹Ÿæ ‡è®°ä¸ºæ´»è·ƒæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ ¹æ®æä¾›çš„READMEæ–‡ä»¶ï¼Œå…¶ä¸­å¹¶æœªå‘ç°ä»»ä½•éšè—çš„æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶ä»…æè¿°äº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´æ¥ä¸Šä¼ å’Œæ¿€æ´»æ¶æ„æ’ä»¶ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [ArtemCyberLab/Project-Exploiting-CVE-2024-27198-RCE-Vulnerability](https://github.com/ArtemCyberLab/Project-Exploiting-CVE-2024-27198-RCE-Vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #2

**æ¥æº**: [CVE-2024-27198-CharonDefalt_CVE-2024-27198-RCE.md](../2024/CVE-2024-27198-CharonDefalt_CVE-2024-27198-RCE.md)

## CVE-2024-27198-JetBrains TeamCity Authentication Bypass & RCE

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒçš„ç®¡ç†å‘˜è®¿é—®å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® TeamCity æœåŠ¡å™¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-27198 å­˜åœ¨äº JetBrains TeamCity ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯å¹¶æ‰§è¡Œç®¡ç†å‘˜æ“ä½œã€‚POC ä»£ç é€šè¿‡å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚åˆ° `/hax?jsp=/app/rest/server;.jsp` è·¯å¾„æ¥è·å– TeamCity çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶åˆ©ç”¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚ 

è¯¥æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š

1. **è·å– TeamCity ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿä¿¡æ¯:** POC ä»£ç é¦–å…ˆå°è¯•è·å– TeamCity çš„ç‰ˆæœ¬ä¿¡æ¯å’Œç›®æ ‡æœåŠ¡å™¨çš„æ“ä½œç³»ç»Ÿä¿¡æ¯ï¼Œä»¥ä¾¿æ›´å¥½åœ°è¿›è¡Œåç»­çš„æ¼æ´åˆ©ç”¨ã€‚
2. **æ„é€ æ¶æ„çš„æ’ä»¶ ZIP æ–‡ä»¶:** POC ä»£ç ä¼šç”Ÿæˆä¸€ä¸ªåŒ…å«æ¶æ„ JSP ä»£ç çš„æ’ä»¶ ZIP æ–‡ä»¶ã€‚è¯¥ JSP ä»£ç åŒ…å«ä¸€ä¸ªç®€å•çš„ web shellï¼Œå…è®¸æ”»å‡»è€…æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3. **åˆ©ç”¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ä¸Šä¼ æ¶æ„æ’ä»¶:**  é€šè¿‡æœªç»èº«ä»½éªŒè¯çš„ API æ¥å£ä¸Šä¼ æ¶æ„æ’ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
4. **æ‰§è¡Œä»»æ„å‘½ä»¤:** æˆåŠŸä¸Šä¼ æ¶æ„æ’ä»¶åï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—®è¯¥æ’ä»¶ä¸­çš„ JSP é¡µé¢æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

è¯¥ POC ä»£ç ä¸»è¦åŒ…å«æ¼æ´åˆ©ç”¨åŠŸèƒ½ï¼Œç”¨äºéªŒè¯å’Œåˆ©ç”¨ CVE-2024-27198 æ¼æ´ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«ç”ŸæˆåŒ…å« webshell çš„ JSP æ–‡ä»¶çš„éƒ¨åˆ†ï¼Œä½†è¿™å±äºæ¼æ´åˆ©ç”¨çš„æ­£å¸¸ç»„æˆéƒ¨åˆ†ï¼Œä¸åº”è¢«è§†ä¸ºæŠ•æ¯’ä»£ç ã€‚è€ƒè™‘åˆ°ä»£ç ä¸­å¯èƒ½å­˜åœ¨çš„ç»†å¾®çš„ã€éš¾ä»¥å¯Ÿè§‰çš„åé—¨æˆ–è€…éšè—åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼Œæ”¶é›†ç”¨æˆ·ä¿¡æ¯å¹¶å‘é€åˆ°æ¶æ„æœåŠ¡å™¨ç­‰ï¼‰ï¼Œä½†å¯èƒ½æ€§è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [CharonDefalt/CVE-2024-27198-RCE](https://github.com/CharonDefalt/CVE-2024-27198-RCE)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #3

**æ¥æº**: [CVE-2024-27198-Chocapikk_CVE-2024-27198.md](../2024/CVE-2024-27198-Chocapikk_CVE-2024-27198.md)

## CVE-2024-27198-JetBrains TeamCity Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·æ‰§è¡Œç®¡ç†å‘˜æ“ä½œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® TeamCity æœåŠ¡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-27198æ˜¯JetBrains TeamCity 2023.11.4ä¹‹å‰çš„ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…æ‰§è¡Œç®¡ç†å‘˜æ“ä½œã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´CVSSè¯„åˆ†ä¸º9.8 (Critical)ï¼Œå·²ç»è¢«CISAæ·»åŠ åˆ°å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®CISAä¿¡æ¯,è¯¥æ¼æ´å·²ç»è¢«ç§¯æåˆ©ç”¨,ç»™å‡ºçš„æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡`hax?jsp=/app/rest/users;.jsp`è·¯å¾„æ·»åŠ å…·æœ‰ç³»ç»Ÿç®¡ç†å‘˜è§’è‰²çš„ç”¨æˆ·ï¼Œä»è€Œè·å¾—ç®¡ç†å‘˜æƒé™ã€‚è¿™ç§åˆ©ç”¨æ–¹å¼ä¸æ¼æ´æè¿°ç›¸ç¬¦ï¼Œä¸”é€šè¿‡DarkReadingç­‰å®‰å…¨åª’ä½“çš„æŠ¥é“ä½è¯ï¼Œè¯¥æ¼æ´ç¡®å®è¢«å¤§è§„æ¨¡åˆ©ç”¨ã€‚å› æ­¤ï¼Œæä¾›çš„POCä»£ç çš„æ€è·¯æ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®é™…çš„æˆåŠŸç‡å–å†³äºTeamCityæœåŠ¡å™¨çš„é…ç½®å’Œç‰ˆæœ¬ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ·»åŠ ç”¨æˆ·å’Œæ‰§è¡Œå‘½ä»¤ï¼Œä»£ç æœ¬èº«å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä½†æ€»ä½“é£é™©è¾ƒä½ï¼Œåªæœ‰10%ã€‚æŠ•æ¯’é£é™©ä¸»è¦æ¥è‡ªäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **åé—¨è´¦å·ï¼š**  å¦‚æœæ”»å‡»è€…ä¿®æ”¹è„šæœ¬ï¼Œå¯ä»¥å°†æ–°æ·»åŠ çš„ç®¡ç†å‘˜è´¦å·ä¿¡æ¯ç¡¬ç¼–ç åˆ°è„šæœ¬ä¸­ï¼Œæ–¹ä¾¿åç»­çš„æŒç»­è®¿é—®ã€‚
*   **æ¶æ„å‘½ä»¤ï¼š**  `execute_command`å‡½æ•°å¯ä»¥è¢«ä¿®æ”¹ä¸ºæ‰§è¡Œæ›´å…·ç ´åæ€§çš„å‘½ä»¤ï¼Œä¾‹å¦‚åˆ é™¤æ•°æ®ã€ç¯¡æ”¹é…ç½®ç­‰ã€‚
*   **ä¾èµ–å¼•å…¥ï¼š**  æ”»å‡»è€…å¯èƒ½é€šè¿‡å¼•å…¥æ¶æ„çš„ç¬¬ä¸‰æ–¹åº“æ¥æ‰§è¡Œæ¶æ„ä»£ç ï¼Œä½†é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç ä¾èµ–é¡¹è¾ƒå°‘ã€‚
*   **æ‰¹é‡å¤„ç†é£é™©ï¼š** è™½ç„¶æ‰¹é‡å¤„ç†ä»…è¯„ä¼°æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä½†å¦‚æœè¢«ä¿®æ”¹ä¸ºå°è¯•åˆ©ç”¨ï¼Œä¼šå¯¹å¤§é‡æœåŠ¡å™¨é€ æˆå½±å“ã€‚

ç”±äºè„šæœ¬ç›¸å¯¹ç®€å•ï¼Œå¹¶ä¸”ä¸»è¦ä¾èµ–äºå·²çŸ¥çš„TeamCity APIï¼Œå› æ­¤éšè—æ¶æ„ä»£ç çš„éš¾åº¦è¾ƒé«˜ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡è¯†åˆ«ï¼š**  é€šè¿‡ç½‘ç»œæ‰«ææˆ–ä¿¡æ¯æ”¶é›†ï¼Œç¡®å®šè¿è¡ŒTeamCityä¸”ç‰ˆæœ¬ä½äº2023.11.4çš„ç›®æ ‡ã€‚
2.  **èº«ä»½éªŒè¯ç»•è¿‡ï¼š**  åˆ©ç”¨æ¼æ´ï¼Œç»•è¿‡TeamCityçš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚
3.  **æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·ï¼š**  é€šè¿‡æ„é€ æ¶æ„çš„REST APIè¯·æ±‚ï¼Œå‘TeamCityæœåŠ¡å™¨æ·»åŠ å…·æœ‰ç³»ç»Ÿç®¡ç†å‘˜æƒé™çš„æ–°ç”¨æˆ·ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æˆåŠŸæ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·åï¼Œä½¿ç”¨æ–°è´¦å·ç™»å½•TeamCityï¼Œåˆ©ç”¨TeamCityæä¾›çš„åŠŸèƒ½ï¼Œæ‰§è¡Œä»»æ„ä»£ç ï¼Œå®ç°è¿œç¨‹æ§åˆ¶æœåŠ¡å™¨çš„ç›®çš„ã€‚
5.  **å‘½ä»¤æ‰§è¡Œï¼š** é€šè¿‡äº¤äº’å¼shellæ‰§è¡Œå‘½ä»¤ã€‚

åˆ©ç”¨è„šæœ¬æä¾›äº†æ‰¹é‡å¤„ç†åŠŸèƒ½ï¼Œå¯ä»¥è‡ªåŠ¨åŒ–æ‰«æå’Œè¯†åˆ«æ½œåœ¨çš„æ¼æ´æœåŠ¡å™¨ã€‚è„šæœ¬è¿˜æä¾›äº†æ·»åŠ ç”¨æˆ·çš„åŠŸèƒ½ï¼Œé€šè¿‡æ·»åŠ ç”¨æˆ·å°è¯•è·å–ç®¡ç†æƒé™å¹¶è¿›ä¸€æ­¥è¿›è¡ŒRCEã€‚

æ€»è€Œè¨€ä¹‹ï¼ŒCVE-2024-27198æ¼æ´çš„åˆ©ç”¨æ–¹å¼è¾ƒä¸ºç›´æ¥ï¼Œé€šè¿‡æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·å³å¯è·å¾—æœåŠ¡å™¨æ§åˆ¶æƒï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [Chocapikk/CVE-2024-27198](https://github.com/Chocapikk/CVE-2024-27198)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #4

**æ¥æº**: [CVE-2024-27198-Cythonic1_CVE-2024-27198_POC.md](../2024/CVE-2024-27198-Cythonic1_CVE-2024-27198_POC.md)

## CVE-2024-27198-JetBrains-TeamCity-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·æ‰§è¡Œç®¡ç†å‘˜æ“ä½œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®TeamCityæœåŠ¡å™¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-27198æ˜¯JetBrains TeamCity 2023.11.4ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œæ”»å‡»å‘é‡ä¸ºç½‘ç»œï¼Œæ”»å‡»å¤æ‚åº¦ä½ï¼Œæ— éœ€ä»»ä½•æƒé™æˆ–ç”¨æˆ·äº¤äº’å³å¯åˆ©ç”¨ã€‚CISAå·²å°†æ­¤æ¼æ´æ·»åŠ åˆ°å·²çŸ¥è¢«åˆ©ç”¨çš„æ¼æ´ç›®å½•ä¸­ï¼Œè¡¨æ˜è¯¥æ¼æ´æ­£åœ¨è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªCargo.lockæ–‡ä»¶ï¼Œå®ƒåˆ—å‡ºäº†CVE-2024-27198é¡¹ç›®ä¾èµ–çš„Rust cratesã€‚Cargo.lockæœ¬èº«ä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä½†å®ƒæš—ç¤ºå­˜åœ¨ä¸€ä¸ªåˆ©ç”¨è¯¥æ¼æ´çš„Rusté¡¹ç›®ã€‚ç”±äºæ²¡æœ‰æä¾›å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œéš¾ä»¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†æ˜¯è€ƒè™‘åˆ°CISAå·²å°†æ­¤æ¼æ´æ·»åŠ åˆ°å·²çŸ¥è¢«åˆ©ç”¨çš„æ¼æ´ç›®å½•ä¸­ï¼Œå¯ä»¥è®¤ä¸ºè¯¥æ¼æ´å­˜åœ¨å¯ç”¨çš„æœ‰æ•ˆåˆ©ç”¨æ–¹æ³•ã€‚å…³äºæŠ•æ¯’é£é™©ï¼ŒCargo.lockæ–‡ä»¶åˆ—å‡ºäº†ä¸€äº›å¸¸è§çš„Rust cratesï¼Œå¦‚reqwestã€serdeå’Œquick-xmlï¼Œè¿™äº›åº“æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä¾èµ–é¡¹éƒ½å¯èƒ½è¢«æ¶æ„ä¿®æ”¹ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ï¼Œæ— éœ€æä¾›æœ‰æ•ˆçš„ç”¨æˆ·åå’Œå¯†ç å³å¯æ‰§è¡Œç®¡ç†å‘˜æ“ä½œã€‚è¿™å¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ï¼Œæ•°æ®æ³„éœ²ï¼Œç¯¡æ”¹å’Œç³»ç»Ÿæ§åˆ¶ï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [Cythonic1/CVE-2024-27198_POC](https://github.com/Cythonic1/CVE-2024-27198_POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #5

**æ¥æº**: [CVE-2024-27198-HPT-Intern-Task-Submission_CVE-2024-27198.md](../2024/CVE-2024-27198-HPT-Intern-Task-Submission_CVE-2024-27198.md)

## CVE-2024-27198 TeamCity èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·æ‰§è¡Œç®¡ç†æ“ä½œï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®TeamCityæœåŠ¡å™¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-27198 æ˜¯ JetBrains TeamCity ä¸­å­˜åœ¨çš„èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´ä½äº `web-openapi.jar` åº“çš„ `jetbrains.buildServer.controllers.BaseController` ç±»ä¸­ã€‚å…·ä½“æ¥è¯´ï¼Œ`updateViewIfRequestHasJspParameter` æ–¹æ³•åœ¨å¤„ç†è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `jsp` è¯·æ±‚å‚æ•°æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ„é€ ä¸€ä¸ªä¸ä»¥ `.jsp` ç»“å°¾çš„ URLï¼Œä¾‹å¦‚ `/random_string`ã€‚
2.  åœ¨è¯¥ URL ä¸­æ·»åŠ  `jsp` è¯·æ±‚å‚æ•°ï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºä»¥ `.jsp` ç»“å°¾ä½†ä¸åŒ…å« `/admin` çš„å€¼ï¼Œä¾‹å¦‚ `random_string?jsp=anything.jsp`ã€‚
3.  å¦‚æœ `modelAndView` å¯¹è±¡çš„è§†å›¾åç§°ä¸ `jsp` å‚æ•°çš„å€¼ä¸åŒï¼Œåˆ™ `modelAndView` çš„è§†å›¾åç§°å°†è¢«æ›´æ–°ä¸º `jsp` å‚æ•°çš„å€¼ã€‚
4.  é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—® TeamCity REST API ä¸­çš„æ•æ„Ÿèµ„æºï¼Œä¾‹å¦‚ `/app/rest/server`ï¼Œè€Œæ— éœ€è¿›è¡Œèº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç è§£é‡Šäº†æ¼æ´åŸç†ï¼Œå¹¶æè¿°äº†å¦‚ä½•æ„é€ æ¶æ„ URL ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’ŒPOCä»£ç åˆ†æï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„POCä»£ç ä¸»è¦ä¸ºæ¼æ´åˆ†ææ–‡æ¡£ï¼Œæè¿°äº†æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ–¹æ³•ã€‚ç”±äºä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ä¸ºæè¿°æ€§çš„JAVAä»£ç æ®µï¼Œç›´æ¥æ‰§è¡Œçš„è„šæœ¬è¾ƒå°‘ã€‚ä½†æ˜¯ç”±äºå…¶ä¸­åŒ…å«äº†ä¸€äº›Githubçš„é“¾æ¥ï¼Œå¦‚æœç”¨æˆ·ä¸‹è½½äº†éå®˜æ–¹æ¥æºçš„EXPå¹¶æ‰§è¡Œï¼Œå¯èƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [HPT-Intern-Task-Submission/CVE-2024-27198](https://github.com/HPT-Intern-Task-Submission/CVE-2024-27198)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #6

**æ¥æº**: [CVE-2024-27198-K3ysTr0K3R_CVE-2024-27198-EXPLOIT.md](../2024/CVE-2024-27198-K3ysTr0K3R_CVE-2024-27198-EXPLOIT.md)

## CVE-2024-27198-JetBrains-TeamCity-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** æé«˜å±ï¼Œå¯å¯¼è‡´æœªæˆæƒçš„ç®¡ç†å‘˜æƒé™è·å–å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®TeamCityæœåŠ¡å™¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-27198 å­˜åœ¨äº JetBrains TeamCity 2023.11.4 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œæ˜¯ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè·å¾—ç®¡ç†å‘˜æƒé™ï¼Œæ‰§è¡Œä»»æ„æ“ä½œï¼ŒåŒ…æ‹¬è¯»å–ã€ä¿®æ”¹æˆ–åˆ é™¤æ•°æ®ï¼Œç”šè‡³å¯ä»¥æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘ `/hax?jsp=/app/rest/users;.jsp` ç«¯ç‚¹å‘é€åŒ…å«æ¶æ„ JSON æ•°æ®çš„ POST è¯·æ±‚ï¼ŒJSON æ•°æ®ä¸­åŒ…å«éšæœºç”Ÿæˆçš„ç”¨æˆ·åã€å¯†ç å’ŒSYSTEM_ADMINè§’è‰²ï¼Œä»è€Œåˆ›å»ºä¸€ä¸ªå…·æœ‰ç®¡ç†å‘˜æƒé™çš„ç”¨æˆ·ã€‚æä¾›çš„POCä»£ç é€šè¿‡æ„é€ åŒ…å«SYSTEM_ADMINè§’è‰²çš„ç”¨æˆ·åˆ›å»ºè¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ã€‚ ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä»£ç åŠŸèƒ½ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚

**é¡¹ç›®åœ°å€:** [K3ysTr0K3R/CVE-2024-27198-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2024-27198-EXPLOIT)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #7

**æ¥æº**: [CVE-2024-27198-Shimon03_Explora-o-RCE-n-o-autenticado-JetBrains-TeamCity-CVE-2024-27198-.md](../2024/CVE-2024-27198-Shimon03_Explora-o-RCE-n-o-autenticado-JetBrains-TeamCity-CVE-2024-27198-.md)

## CVE-2024-27198 - JetBrains TeamCity èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…æ‰§è¡Œç®¡ç†å‘˜æ“ä½œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®TeamCityæœåŠ¡å™¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-27198æ˜¯ä¸€ä¸ªJetBrains TeamCityä¸­çš„èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ï¼Œå½±å“ç‰ˆæœ¬ä½äº2023.11.4ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…æ‰§è¡Œç®¡ç†å‘˜æ“ä½œï¼ŒCVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚CISAå·²å°†æ­¤æ¼æ´æ·»åŠ åˆ°å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªåä¸º`Explora-o-RCE-n-o-autenticado-JetBrains-TeamCity-CVE-2024-27198-`çš„ä»“åº“ï¼Œè¡¨æ˜å®ƒå¯èƒ½ä¸æœªç»èº«ä»½éªŒè¯çš„RCEï¼ˆè¿œç¨‹ä»£ç æ‰§è¡Œï¼‰æ¼æ´æœ‰å…³ã€‚è™½ç„¶æä¾›çš„`README.md`æ–‡ä»¶å†…å®¹æœ‰é™ï¼Œä½†å®ƒç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æåˆ°äº†ç›¸å…³çš„CVEç¼–å·ã€‚è€ƒè™‘åˆ°CISAçš„KEVæ¡ç›®ï¼Œä»¥åŠ`darkreading.com`çš„æ–‡ç« ï¼Œè¡¨æ˜è¯¥æ¼æ´æ­£åœ¨è¢«ç§¯æåˆ©ç”¨ã€‚ç”±äºæä¾›çš„åˆ©ç”¨ä»£ç å†…å®¹åªæ˜¯ä¸€ä¸ªREADMEæ–‡ä»¶ï¼Œæ— æ³•ç¡®è®¤å®Œæ•´åˆ©ç”¨ç»†èŠ‚ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºç›®å‰çœ‹åˆ°çš„åªæœ‰readmeæ–‡ä»¶ï¼Œæ¶æ„ä½œè€…å¯èƒ½åœ¨å…¶ä»–æœªæä¾›çš„æ–‡ä»¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æŸç§æ‰‹æ®µç»•è¿‡èº«ä»½éªŒè¯æœºåˆ¶ï¼Œæœ€ç»ˆè·å¾—ç®¡ç†å‘˜æƒé™ï¼Œä»è€Œå¯ä»¥è¿›è¡Œä»»æ„æ“ä½œï¼ŒåŒ…æ‹¬ä½†ä¸é™äºæ•°æ®æ³„éœ²ã€ç¯¡æ”¹å’Œè¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Shimon03/Explora-o-RCE-n-o-autenticado-JetBrains-TeamCity-CVE-2024-27198-](https://github.com/Shimon03/Explora-o-RCE-n-o-autenticado-JetBrains-TeamCity-CVE-2024-27198-)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #8

**æ¥æº**: [CVE-2024-27198-W01fh4cker_CVE-2024-27198-RCE.md](../2024/CVE-2024-27198-W01fh4cker_CVE-2024-27198-RCE.md)

## CVE-2024-27198-TeamCity èº«ä»½éªŒè¯ç»•è¿‡ RCE

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…æ‰§è¡Œä»»æ„ç®¡ç†æ“ä½œå’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ TeamCity å®ä¾‹ç½‘ç»œå¯è¾¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-27198 å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…ç»•è¿‡ TeamCity çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»è€Œæ‰§è¡Œç®¡ç†å‘˜æ“ä½œã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡æ¼æ´ï¼ŒCVSS è¯„åˆ†ä¸º 9.8ï¼Œè¡¨æ˜å…¶å½±å“éå¸¸é«˜ã€‚CISA å·²å°†å…¶æ·»åŠ åˆ°å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½• (KEV)ï¼Œè¿™æ„å‘³ç€è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ Python POC ä»£ç  `CVE-2024-27198-RCE.py` çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåˆ©ç”¨äº†èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ï¼Œé€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œå…è®¸æ”»å‡»è€…ä¸Šä¼ æ¶æ„æ’ä»¶åˆ° TeamCity æœåŠ¡å™¨ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ä»£ç å°è¯•è·å–TeamCityç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿä¿¡æ¯ï¼Œè¿™æœ‰åŠ©äºç¡®å®šç›®æ ‡ç¯å¢ƒå¹¶é€‰æ‹©åˆé€‚çš„æ”»å‡»è½½è·ã€‚POCé€šè¿‡ç”ŸæˆåŒ…å«æ¶æ„JSPæ–‡ä»¶çš„æ’ä»¶,è¿›è€Œæ‰§è¡Œå‘½ä»¤.

**æŠ•æ¯’é£é™©ï¼š**

è™½ç„¶å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯ä¸ºäº†åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **JSP Shell å†…å®¹ï¼š** POCå…è®¸æŒ‡å®š`shell_file_content`å‚æ•°ï¼Œå¯ä»¥æ’å…¥ä»»æ„jspä»£ç ï¼Œè¿™å¯èƒ½è¢«æ»¥ç”¨.
*   **éšæœºæ•°ç”Ÿæˆï¼š** ä»£ç ä¸­ä½¿ç”¨äº†ä¸€äº›éšæœºå­—ç¬¦ä¸²ï¼Œä½†è¿™äº›éšæœºæ•°ç”Ÿæˆå™¨çš„å®‰å…¨æ€§å¯èƒ½ä¸è¶³ä»¥æŠµæŠ—é«˜çº§æ”»å‡»è€…çš„åˆ†æã€‚
*   **æ’ä»¶åï¼š**æ¶æ„jaråŒ…çš„åç§°å¯èƒ½ä¼šè¢«æ£€æµ‹å‡ºæ¥,éœ€è¦é¢å¤–å¤„ç†.

æ€»çš„æ¥è¯´ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡ä¸º 10%ã€‚ ä¸»è¦æ˜¯ä½œè€…å¯èƒ½åœ¨shell_file_contentå‚æ•°é‡Œé¢åšæ‰‹è„šï¼Œæ¯”å¦‚åŠ å…¥åå‘shellï¼Œè·å–è‚‰é¸¡æƒé™ç­‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **èº«ä»½éªŒè¯ç»•è¿‡ï¼š** æ”»å‡»è€…åˆ©ç”¨ TeamCity çš„èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ï¼Œæ— éœ€æä¾›æœ‰æ•ˆçš„ç”¨æˆ·åå’Œå¯†ç å³å¯è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
2.  **ä¸Šä¼ æ¶æ„æ’ä»¶ï¼š** æ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ä¸Šä¼ ä¸€ä¸ªåŒ…å«æ¶æ„ JSP æ–‡ä»¶çš„æ’ä»¶ï¼ˆJAR æ–‡ä»¶ï¼‰ã€‚è¯¥æ’ä»¶ä¼šä¼ªè£…æˆåˆæ³•æ’ä»¶ï¼Œä½†å®é™…ä¸ŠåŒ…å«æ¶æ„ä»£ç ã€‚
3.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** TeamCity æœåŠ¡å™¨ä¼šåŠ è½½å¹¶æ‰§è¡Œä¸Šä¼ çš„æ¶æ„æ’ä»¶ï¼Œä»è€Œå…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ”»å‡»è€…é€šå¸¸ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€å®‰è£…åé—¨æˆ–çªƒå–æ•æ„Ÿæ•°æ®ã€‚

æ€»ä½“æ¥è¯´ï¼Œåˆ©ç”¨æ–¹å¼ç›¸å½“ç›´æ¥ï¼Œä¾èµ–äºèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´æ¥æ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [W01fh4cker/CVE-2024-27198-RCE](https://github.com/W01fh4cker/CVE-2024-27198-RCE)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #9

**æ¥æº**: [CVE-2024-27198-geniuszly_CVE-2024-27198.md](../2024/CVE-2024-27198-geniuszly_CVE-2024-27198.md)

## CVE-2024-27198-JetBrains TeamCity èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…æ‰§è¡Œç®¡ç†æ“ä½œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®TeamCityæœåŠ¡å™¨ï¼Œç›®æ ‡ç‰ˆæœ¬ä½äº2023.11.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-27198æ˜¯JetBrains TeamCityæœåŠ¡å™¨ä¸­å­˜åœ¨çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡è®¿é—®ç‰¹å®šçš„URLï¼ˆ/pwned?jsp=/app/rest/users;.jspï¼‰å¹¶æ„é€ æ¶æ„è¯·æ±‚æ¥åˆ›å»ºæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨ä¸éœ€è¦ä»»ä½•ç‰¹æƒæˆ–ç”¨æˆ·äº¤äº’ã€‚æ¼æ´åˆ©ç”¨ä»£ç é¦–å…ˆå°è¯•è·å–TeamCityçš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œç„¶åé€šè¿‡å‘é€å¸¦æœ‰ç”¨æˆ·åã€å¯†ç å’Œç®¡ç†å‘˜è§’è‰²çš„JSONæœ‰æ•ˆè´Ÿè½½çš„POSTè¯·æ±‚åˆ°æ¼æ´URLæ¥åˆ›å»ºç”¨æˆ·ã€‚å¦‚æœæœåŠ¡å™¨å®¹æ˜“å—åˆ°æ”»å‡»ï¼Œå°†æˆåŠŸåˆ›å»ºå…·æœ‰ç®¡ç†å‘˜æƒé™çš„æ–°ç”¨æˆ·ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨ä»£ç åº”è¯¥æœ‰æ•ˆï¼Œå› ä¸ºè¯¥æ¼æ´å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISAå·²å°†å…¶æ·»åŠ åˆ°å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚ ä»£ç æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€è¯·æ±‚åˆ›å»ºç”¨æˆ·ã€‚ é£é™©ä¸»è¦æ¥è‡ªäºä»¥ä¸‹å‡ ç‚¹ï¼š

*   **ä¾èµ–é¡¹é£é™©ï¼š** è™½ç„¶ä»£ç æœ¬èº«åªä½¿ç”¨äº† `requests` å’Œ `urllib3` åº“ï¼Œä½†æ”»å‡»è€…å¯èƒ½ä¼šé€šè¿‡æ›¿æ¢æˆ–ç¯¡æ”¹è¿™äº›åº“æ¥æ¤å…¥æ¶æ„ä»£ç ã€‚ ä½†å¯èƒ½æ€§è¾ƒä½ã€‚
*   **ä»£ç æ··æ·†æˆ–éšè—ï¼š** ä»£ç çš„å¯è¯»æ€§è¾ƒé«˜ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ··æ·†æˆ–éšè—ä»£ç ã€‚ ä½†ä»ç„¶å­˜åœ¨ä¸€å®šé£é™©ï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡ç»†å¾®çš„ä¿®æ”¹æ¥æ·»åŠ æ¶æ„åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡TeamCityæœåŠ¡å™¨çš„URLã€è¦åˆ›å»ºçš„ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç ã€‚
2.  è„šæœ¬é¦–å…ˆå°è¯•è·å–TeamCityæœåŠ¡å™¨çš„ç‰ˆæœ¬ã€‚
3.  ç„¶åï¼Œè„šæœ¬æ„é€ ä¸€ä¸ªåŒ…å«ç”¨æˆ·åã€å¯†ç å’Œç®¡ç†å‘˜æƒé™çš„JSON payloadï¼Œå¹¶å°†å…¶å‘é€åˆ°`/pwned?jsp=/app/rest/users;.jsp`ç«¯ç‚¹ã€‚
4.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¯¥ç”¨æˆ·ç™»å½•å¹¶æ§åˆ¶TeamCityæœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [geniuszly/CVE-2024-27198](https://github.com/geniuszly/CVE-2024-27198)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #10

**æ¥æº**: [CVE-2024-27198-jrbH4CK_CVE-2024-27198.md](../2024/CVE-2024-27198-jrbH4CK_CVE-2024-27198.md)

## CVE-2024-27198 - JetBrains TeamCity Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…æ‰§è¡Œç®¡ç†å‘˜æ“ä½œï¼ŒåŒ…æ‹¬è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** TeamCityæœåŠ¡å™¨éœ€è¦è¿è¡Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸”ç½‘ç»œå¯è®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-27198 æ˜¯ JetBrains TeamCity ä¸­å­˜åœ¨çš„èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹åˆ¶çš„è¯·æ±‚ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶è·å¾—ç®¡ç†å‘˜æƒé™ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ TeamCity æœåŠ¡å™¨ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œ Rapid7 çš„åˆ†æï¼ˆREADME.mdä¸­å¼•ç”¨ï¼‰ï¼Œè¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…æ‰§è¡Œç®¡ç†å‘˜æ“ä½œã€‚æä¾›çš„PoCä»£ç ï¼ˆcve-2024-27198.pyï¼‰åˆ©ç”¨æ­¤æ¼æ´åˆ›å»ºä¸€ä¸ªå…·æœ‰ç³»ç»Ÿç®¡ç†å‘˜æƒé™çš„æ–°ç”¨æˆ·ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚åˆ° TeamCity æœåŠ¡å™¨çš„ `/hax?jsp=/app/rest/users;XXX.jsp` ç«¯ç‚¹ï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚
2.  åˆ©ç”¨è¯¥ç«¯ç‚¹ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ POST è¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ï¼Œå¹¶åœ¨è¯·æ±‚ä½“ä¸­æŒ‡å®šç”¨æˆ·åã€å¯†ç å’Œè§’è‰²ã€‚
3.  æˆåŠŸåˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·åï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨æ–°åˆ›å»ºçš„å‡­æ®ç™»å½• TeamCity å¹¶å®Œå…¨æ§åˆ¶æœåŠ¡å™¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆ†æäº†æä¾›çš„æ–‡ä»¶ï¼Œä¸»è¦é£é™©ç‚¹å¦‚ä¸‹ï¼š

*   **cve-2024-27198.pyï¼š** æ­¤æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ï¼Œç”¨äºåœ¨ç›®æ ‡ TeamCity æœåŠ¡å™¨ä¸Šåˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ã€‚ ä»£ç æœ¬èº«ä¼¼ä¹æ²¡æœ‰ç›´æ¥åŒ…å«æ¶æ„æŠ•æ¯’ä»£ç ï¼Œä½†åˆ›å»ºçš„ç®¡ç†å‘˜è´¦æˆ·æœ¬èº«å³ä¸ºåé—¨ã€‚å› æ­¤ï¼Œä¸èƒ½åˆ¤å®šä¸ºæŠ•æ¯’ã€‚
*   **README.mdï¼š**  æ­¤æ–‡ä»¶åŒ…å«æ¼æ´æè¿°ã€åˆ©ç”¨æ–¹æ³•å’Œå‚è€ƒé“¾æ¥ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„ä»£ç ã€‚
*   **img/test:** æ­¤æ–‡ä»¶ä¸ºç©ºï¼Œä¹Ÿæ²¡æœ‰é£é™©ã€‚

è™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹æ½œåœ¨çš„é£é™©ï¼š

1.  **ä¾èµ–åº“é£é™©ï¼š** PoCä»£ç ä½¿ç”¨ `requests` å’Œ `json` åº“ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›åº“çš„æºï¼ˆè™½ç„¶å¯èƒ½æ€§è¾ƒä½ï¼‰ï¼Œåˆ™å¯èƒ½å¼•å…¥æ¶æ„ä»£ç ã€‚ ä½†æ ¹æ®ç›®å‰æä¾›çš„ä¿¡æ¯ï¼Œæ— æ³•åˆ¤å®šå­˜åœ¨è¿™ç§é£é™©ã€‚
2.  **åé—¨é£é™©ï¼š** PoCä»£ç åˆ›å»ºçš„ç®¡ç†å‘˜å¸æˆ·æœ¬èº«å°±æ˜¯ä¸€ä¸ªåé—¨ï¼Œå¦‚æœè¯¥ä»£ç è¢«æ¶æ„ä¼ æ’­ï¼Œå¯èƒ½è¢«ç”¨äºæœªç»æˆæƒçš„è®¿é—®ã€‚

ç»¼åˆè€ƒè™‘ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚ä¸»è¦é£é™©åœ¨äºæ¼æ´åˆ©ç”¨æœ¬èº«å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [jrbH4CK/CVE-2024-27198](https://github.com/jrbH4CK/CVE-2024-27198)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #11

**æ¥æº**: [CVE-2024-27198-passwa11_CVE-2024-27198-RCE.md](../2024/CVE-2024-27198-passwa11_CVE-2024-27198-RCE.md)

# CVE-2024-27198

> ğŸ“¦ è¯¥CVEæœ‰ **13** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-27198-ArtemCyberLab_Project-Exploiting-CVE-2024-27198-RCE-Vulnerability.md](../2024/CVE-2024-27198-ArtemCyberLab_Project-Exploiting-CVE-2024-27198-RCE-Vulnerability.md)

## CVE-2024-27198-TeamCity-è®¤è¯ç»•è¿‡RCE

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡RCE

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨æ§åˆ¶å—å½±å“çš„TeamCityæœåŠ¡å™¨

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡TeamCityæœåŠ¡å™¨ç‰ˆæœ¬ä½äº2023.11.4ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè¿›è¡Œç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-27198 å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œæ‰§è¡Œç®¡ç†æ“ä½œã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md)ï¼Œåˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  **ç›®æ ‡è¯†åˆ«:** æ‰¾åˆ°ç›®æ ‡TeamCityæœåŠ¡å™¨ï¼ˆç‰ˆæœ¬ä½äº2023.11.4ï¼‰ã€‚
2.  **æ¼æ´åˆ©ç”¨:** ä½¿ç”¨`CVE-2024-27198-RCE.py` è„šæœ¬è¿›è¡Œæ”»å‡»ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨ä¸Šä¼ æ¶æ„çš„æ’ä»¶ã€‚
3.  **æ’ä»¶æ¿€æ´»:** æ¶æ„æ’ä»¶è¢«æ¿€æ´»ï¼Œæä¾›äº†ä¸€ä¸ªwebshellè®¿é—®ã€‚
4.  **å‘½ä»¤æ‰§è¡Œ:** é€šè¿‡ webshell (ä½äºä¾‹å¦‚ `http://10.10.217.209:50000/plugins/zHXm20lm/zHXm20lm.jsp`)ï¼Œæ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä¾‹å¦‚`whoami`ã€`ls` å’Œ `cat /home/ubuntu/flag.txt`ã€‚
5.  **æ•°æ®è·å–:** æ”»å‡»è€…å¯ä»¥é€šè¿‡webshellè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚flagæ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç (README.mdæè¿°)æŒ‡ç¤ºæ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•ä¸Šä¼ æ¶æ„æ’ä»¶å¹¶é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚CISA KEV ä¹Ÿæ ‡è®°ä¸ºæ´»è·ƒæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ ¹æ®æä¾›çš„READMEæ–‡ä»¶ï¼Œå…¶ä¸­å¹¶æœªå‘ç°ä»»ä½•éšè—çš„æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶ä»…æè¿°äº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´æ¥ä¸Šä¼ å’Œæ¿€æ´»æ¶æ„æ’ä»¶ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [ArtemCyberLab/Project-Exploiting-CVE-2024-27198-RCE-Vulnerability](https://github.com/ArtemCyberLab/Project-Exploiting-CVE-2024-27198-RCE-Vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #2

**æ¥æº**: [CVE-2024-27198-CharonDefalt_CVE-2024-27198-RCE.md](../2024/CVE-2024-27198-CharonDefalt_CVE-2024-27198-RCE.md)

## CVE-2024-27198-JetBrains TeamCity Authentication Bypass & RCE

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒçš„ç®¡ç†å‘˜è®¿é—®å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® TeamCity æœåŠ¡å™¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-27198 å­˜åœ¨äº JetBrains TeamCity ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯å¹¶æ‰§è¡Œç®¡ç†å‘˜æ“ä½œã€‚POC ä»£ç é€šè¿‡å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚åˆ° `/hax?jsp=/app/rest/server;.jsp` è·¯å¾„æ¥è·å– TeamCity çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶åˆ©ç”¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚ 

è¯¥æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š

1. **è·å– TeamCity ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿä¿¡æ¯:** POC ä»£ç é¦–å…ˆå°è¯•è·å– TeamCity çš„ç‰ˆæœ¬ä¿¡æ¯å’Œç›®æ ‡æœåŠ¡å™¨çš„æ“ä½œç³»ç»Ÿä¿¡æ¯ï¼Œä»¥ä¾¿æ›´å¥½åœ°è¿›è¡Œåç»­çš„æ¼æ´åˆ©ç”¨ã€‚
2. **æ„é€ æ¶æ„çš„æ’ä»¶ ZIP æ–‡ä»¶:** POC ä»£ç ä¼šç”Ÿæˆä¸€ä¸ªåŒ…å«æ¶æ„ JSP ä»£ç çš„æ’ä»¶ ZIP æ–‡ä»¶ã€‚è¯¥ JSP ä»£ç åŒ…å«ä¸€ä¸ªç®€å•çš„ web shellï¼Œå…è®¸æ”»å‡»è€…æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3. **åˆ©ç”¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ä¸Šä¼ æ¶æ„æ’ä»¶:**  é€šè¿‡æœªç»èº«ä»½éªŒè¯çš„ API æ¥å£ä¸Šä¼ æ¶æ„æ’ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
4. **æ‰§è¡Œä»»æ„å‘½ä»¤:** æˆåŠŸä¸Šä¼ æ¶æ„æ’ä»¶åï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—®è¯¥æ’ä»¶ä¸­çš„ JSP é¡µé¢æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

è¯¥ POC ä»£ç ä¸»è¦åŒ…å«æ¼æ´åˆ©ç”¨åŠŸèƒ½ï¼Œç”¨äºéªŒè¯å’Œåˆ©ç”¨ CVE-2024-27198 æ¼æ´ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«ç”ŸæˆåŒ…å« webshell çš„ JSP æ–‡ä»¶çš„éƒ¨åˆ†ï¼Œä½†è¿™å±äºæ¼æ´åˆ©ç”¨çš„æ­£å¸¸ç»„æˆéƒ¨åˆ†ï¼Œä¸åº”è¢«è§†ä¸ºæŠ•æ¯’ä»£ç ã€‚è€ƒè™‘åˆ°ä»£ç ä¸­å¯èƒ½å­˜åœ¨çš„ç»†å¾®çš„ã€éš¾ä»¥å¯Ÿè§‰çš„åé—¨æˆ–è€…éšè—åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼Œæ”¶é›†ç”¨æˆ·ä¿¡æ¯å¹¶å‘é€åˆ°æ¶æ„æœåŠ¡å™¨ç­‰ï¼‰ï¼Œä½†å¯èƒ½æ€§è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [CharonDefalt/CVE-2024-27198-RCE](https://github.com/CharonDefalt/CVE-2024-27198-RCE)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #3

**æ¥æº**: [CVE-2024-27198-Chocapikk_CVE-2024-27198.md](../2024/CVE-2024-27198-Chocapikk_CVE-2024-27198.md)

## CVE-2024-27198-JetBrains TeamCity Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·æ‰§è¡Œç®¡ç†å‘˜æ“ä½œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® TeamCity æœåŠ¡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-27198æ˜¯JetBrains TeamCity 2023.11.4ä¹‹å‰çš„ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…æ‰§è¡Œç®¡ç†å‘˜æ“ä½œã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´CVSSè¯„åˆ†ä¸º9.8 (Critical)ï¼Œå·²ç»è¢«CISAæ·»åŠ åˆ°å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®CISAä¿¡æ¯,è¯¥æ¼æ´å·²ç»è¢«ç§¯æåˆ©ç”¨,ç»™å‡ºçš„æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡`hax?jsp=/app/rest/users;.jsp`è·¯å¾„æ·»åŠ å…·æœ‰ç³»ç»Ÿç®¡ç†å‘˜è§’è‰²çš„ç”¨æˆ·ï¼Œä»è€Œè·å¾—ç®¡ç†å‘˜æƒé™ã€‚è¿™ç§åˆ©ç”¨æ–¹å¼ä¸æ¼æ´æè¿°ç›¸ç¬¦ï¼Œä¸”é€šè¿‡DarkReadingç­‰å®‰å…¨åª’ä½“çš„æŠ¥é“ä½è¯ï¼Œè¯¥æ¼æ´ç¡®å®è¢«å¤§è§„æ¨¡åˆ©ç”¨ã€‚å› æ­¤ï¼Œæä¾›çš„POCä»£ç çš„æ€è·¯æ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®é™…çš„æˆåŠŸç‡å–å†³äºTeamCityæœåŠ¡å™¨çš„é…ç½®å’Œç‰ˆæœ¬ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ·»åŠ ç”¨æˆ·å’Œæ‰§è¡Œå‘½ä»¤ï¼Œä»£ç æœ¬èº«å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä½†æ€»ä½“é£é™©è¾ƒä½ï¼Œåªæœ‰10%ã€‚æŠ•æ¯’é£é™©ä¸»è¦æ¥è‡ªäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **åé—¨è´¦å·ï¼š**  å¦‚æœæ”»å‡»è€…ä¿®æ”¹è„šæœ¬ï¼Œå¯ä»¥å°†æ–°æ·»åŠ çš„ç®¡ç†å‘˜è´¦å·ä¿¡æ¯ç¡¬ç¼–ç åˆ°è„šæœ¬ä¸­ï¼Œæ–¹ä¾¿åç»­çš„æŒç»­è®¿é—®ã€‚
*   **æ¶æ„å‘½ä»¤ï¼š**  `execute_command`å‡½æ•°å¯ä»¥è¢«ä¿®æ”¹ä¸ºæ‰§è¡Œæ›´å…·ç ´åæ€§çš„å‘½ä»¤ï¼Œä¾‹å¦‚åˆ é™¤æ•°æ®ã€ç¯¡æ”¹é…ç½®ç­‰ã€‚
*   **ä¾èµ–å¼•å…¥ï¼š**  æ”»å‡»è€…å¯èƒ½é€šè¿‡å¼•å…¥æ¶æ„çš„ç¬¬ä¸‰æ–¹åº“æ¥æ‰§è¡Œæ¶æ„ä»£ç ï¼Œä½†é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç ä¾èµ–é¡¹è¾ƒå°‘ã€‚
*   **æ‰¹é‡å¤„ç†é£é™©ï¼š** è™½ç„¶æ‰¹é‡å¤„ç†ä»…è¯„ä¼°æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä½†å¦‚æœè¢«ä¿®æ”¹ä¸ºå°è¯•åˆ©ç”¨ï¼Œä¼šå¯¹å¤§é‡æœåŠ¡å™¨é€ æˆå½±å“ã€‚

ç”±äºè„šæœ¬ç›¸å¯¹ç®€å•ï¼Œå¹¶ä¸”ä¸»è¦ä¾èµ–äºå·²çŸ¥çš„TeamCity APIï¼Œå› æ­¤éšè—æ¶æ„ä»£ç çš„éš¾åº¦è¾ƒé«˜ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡è¯†åˆ«ï¼š**  é€šè¿‡ç½‘ç»œæ‰«ææˆ–ä¿¡æ¯æ”¶é›†ï¼Œç¡®å®šè¿è¡ŒTeamCityä¸”ç‰ˆæœ¬ä½äº2023.11.4çš„ç›®æ ‡ã€‚
2.  **èº«ä»½éªŒè¯ç»•è¿‡ï¼š**  åˆ©ç”¨æ¼æ´ï¼Œç»•è¿‡TeamCityçš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚
3.  **æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·ï¼š**  é€šè¿‡æ„é€ æ¶æ„çš„REST APIè¯·æ±‚ï¼Œå‘TeamCityæœåŠ¡å™¨æ·»åŠ å…·æœ‰ç³»ç»Ÿç®¡ç†å‘˜æƒé™çš„æ–°ç”¨æˆ·ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æˆåŠŸæ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·åï¼Œä½¿ç”¨æ–°è´¦å·ç™»å½•TeamCityï¼Œåˆ©ç”¨TeamCityæä¾›çš„åŠŸèƒ½ï¼Œæ‰§è¡Œä»»æ„ä»£ç ï¼Œå®ç°è¿œç¨‹æ§åˆ¶æœåŠ¡å™¨çš„ç›®çš„ã€‚
5.  **å‘½ä»¤æ‰§è¡Œï¼š** é€šè¿‡äº¤äº’å¼shellæ‰§è¡Œå‘½ä»¤ã€‚

åˆ©ç”¨è„šæœ¬æä¾›äº†æ‰¹é‡å¤„ç†åŠŸèƒ½ï¼Œå¯ä»¥è‡ªåŠ¨åŒ–æ‰«æå’Œè¯†åˆ«æ½œåœ¨çš„æ¼æ´æœåŠ¡å™¨ã€‚è„šæœ¬è¿˜æä¾›äº†æ·»åŠ ç”¨æˆ·çš„åŠŸèƒ½ï¼Œé€šè¿‡æ·»åŠ ç”¨æˆ·å°è¯•è·å–ç®¡ç†æƒé™å¹¶è¿›ä¸€æ­¥è¿›è¡ŒRCEã€‚

æ€»è€Œè¨€ä¹‹ï¼ŒCVE-2024-27198æ¼æ´çš„åˆ©ç”¨æ–¹å¼è¾ƒä¸ºç›´æ¥ï¼Œé€šè¿‡æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·å³å¯è·å¾—æœåŠ¡å™¨æ§åˆ¶æƒï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [Chocapikk/CVE-2024-27198](https://github.com/Chocapikk/CVE-2024-27198)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #4

**æ¥æº**: [CVE-2024-27198-Cythonic1_CVE-2024-27198_POC.md](../2024/CVE-2024-27198-Cythonic1_CVE-2024-27198_POC.md)

## CVE-2024-27198-JetBrains-TeamCity-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·æ‰§è¡Œç®¡ç†å‘˜æ“ä½œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®TeamCityæœåŠ¡å™¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-27198æ˜¯JetBrains TeamCity 2023.11.4ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œæ”»å‡»å‘é‡ä¸ºç½‘ç»œï¼Œæ”»å‡»å¤æ‚åº¦ä½ï¼Œæ— éœ€ä»»ä½•æƒé™æˆ–ç”¨æˆ·äº¤äº’å³å¯åˆ©ç”¨ã€‚CISAå·²å°†æ­¤æ¼æ´æ·»åŠ åˆ°å·²çŸ¥è¢«åˆ©ç”¨çš„æ¼æ´ç›®å½•ä¸­ï¼Œè¡¨æ˜è¯¥æ¼æ´æ­£åœ¨è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªCargo.lockæ–‡ä»¶ï¼Œå®ƒåˆ—å‡ºäº†CVE-2024-27198é¡¹ç›®ä¾èµ–çš„Rust cratesã€‚Cargo.lockæœ¬èº«ä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä½†å®ƒæš—ç¤ºå­˜åœ¨ä¸€ä¸ªåˆ©ç”¨è¯¥æ¼æ´çš„Rusté¡¹ç›®ã€‚ç”±äºæ²¡æœ‰æä¾›å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œéš¾ä»¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†æ˜¯è€ƒè™‘åˆ°CISAå·²å°†æ­¤æ¼æ´æ·»åŠ åˆ°å·²çŸ¥è¢«åˆ©ç”¨çš„æ¼æ´ç›®å½•ä¸­ï¼Œå¯ä»¥è®¤ä¸ºè¯¥æ¼æ´å­˜åœ¨å¯ç”¨çš„æœ‰æ•ˆåˆ©ç”¨æ–¹æ³•ã€‚å…³äºæŠ•æ¯’é£é™©ï¼ŒCargo.lockæ–‡ä»¶åˆ—å‡ºäº†ä¸€äº›å¸¸è§çš„Rust cratesï¼Œå¦‚reqwestã€serdeå’Œquick-xmlï¼Œè¿™äº›åº“æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä¾èµ–é¡¹éƒ½å¯èƒ½è¢«æ¶æ„ä¿®æ”¹ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ï¼Œæ— éœ€æä¾›æœ‰æ•ˆçš„ç”¨æˆ·åå’Œå¯†ç å³å¯æ‰§è¡Œç®¡ç†å‘˜æ“ä½œã€‚è¿™å¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ï¼Œæ•°æ®æ³„éœ²ï¼Œç¯¡æ”¹å’Œç³»ç»Ÿæ§åˆ¶ï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [Cythonic1/CVE-2024-27198_POC](https://github.com/Cythonic1/CVE-2024-27198_POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #5

**æ¥æº**: [CVE-2024-27198-HPT-Intern-Task-Submission_CVE-2024-27198.md](../2024/CVE-2024-27198-HPT-Intern-Task-Submission_CVE-2024-27198.md)

## CVE-2024-27198 TeamCity èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·æ‰§è¡Œç®¡ç†æ“ä½œï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®TeamCityæœåŠ¡å™¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-27198 æ˜¯ JetBrains TeamCity ä¸­å­˜åœ¨çš„èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´ä½äº `web-openapi.jar` åº“çš„ `jetbrains.buildServer.controllers.BaseController` ç±»ä¸­ã€‚å…·ä½“æ¥è¯´ï¼Œ`updateViewIfRequestHasJspParameter` æ–¹æ³•åœ¨å¤„ç†è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `jsp` è¯·æ±‚å‚æ•°æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ„é€ ä¸€ä¸ªä¸ä»¥ `.jsp` ç»“å°¾çš„ URLï¼Œä¾‹å¦‚ `/random_string`ã€‚
2.  åœ¨è¯¥ URL ä¸­æ·»åŠ  `jsp` è¯·æ±‚å‚æ•°ï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºä»¥ `.jsp` ç»“å°¾ä½†ä¸åŒ…å« `/admin` çš„å€¼ï¼Œä¾‹å¦‚ `random_string?jsp=anything.jsp`ã€‚
3.  å¦‚æœ `modelAndView` å¯¹è±¡çš„è§†å›¾åç§°ä¸ `jsp` å‚æ•°çš„å€¼ä¸åŒï¼Œåˆ™ `modelAndView` çš„è§†å›¾åç§°å°†è¢«æ›´æ–°ä¸º `jsp` å‚æ•°çš„å€¼ã€‚
4.  é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—® TeamCity REST API ä¸­çš„æ•æ„Ÿèµ„æºï¼Œä¾‹å¦‚ `/app/rest/server`ï¼Œè€Œæ— éœ€è¿›è¡Œèº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç è§£é‡Šäº†æ¼æ´åŸç†ï¼Œå¹¶æè¿°äº†å¦‚ä½•æ„é€ æ¶æ„ URL ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’ŒPOCä»£ç åˆ†æï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„POCä»£ç ä¸»è¦ä¸ºæ¼æ´åˆ†ææ–‡æ¡£ï¼Œæè¿°äº†æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ–¹æ³•ã€‚ç”±äºä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ä¸ºæè¿°æ€§çš„JAVAä»£ç æ®µï¼Œç›´æ¥æ‰§è¡Œçš„è„šæœ¬è¾ƒå°‘ã€‚ä½†æ˜¯ç”±äºå…¶ä¸­åŒ…å«äº†ä¸€äº›Githubçš„é“¾æ¥ï¼Œå¦‚æœç”¨æˆ·ä¸‹è½½äº†éå®˜æ–¹æ¥æºçš„EXPå¹¶æ‰§è¡Œï¼Œå¯èƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [HPT-Intern-Task-Submission/CVE-2024-27198](https://github.com/HPT-Intern-Task-Submission/CVE-2024-27198)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #6

**æ¥æº**: [CVE-2024-27198-K3ysTr0K3R_CVE-2024-27198-EXPLOIT.md](../2024/CVE-2024-27198-K3ysTr0K3R_CVE-2024-27198-EXPLOIT.md)

## CVE-2024-27198-JetBrains-TeamCity-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** æé«˜å±ï¼Œå¯å¯¼è‡´æœªæˆæƒçš„ç®¡ç†å‘˜æƒé™è·å–å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®TeamCityæœåŠ¡å™¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-27198 å­˜åœ¨äº JetBrains TeamCity 2023.11.4 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œæ˜¯ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè·å¾—ç®¡ç†å‘˜æƒé™ï¼Œæ‰§è¡Œä»»æ„æ“ä½œï¼ŒåŒ…æ‹¬è¯»å–ã€ä¿®æ”¹æˆ–åˆ é™¤æ•°æ®ï¼Œç”šè‡³å¯ä»¥æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘ `/hax?jsp=/app/rest/users;.jsp` ç«¯ç‚¹å‘é€åŒ…å«æ¶æ„ JSON æ•°æ®çš„ POST è¯·æ±‚ï¼ŒJSON æ•°æ®ä¸­åŒ…å«éšæœºç”Ÿæˆçš„ç”¨æˆ·åã€å¯†ç å’ŒSYSTEM_ADMINè§’è‰²ï¼Œä»è€Œåˆ›å»ºä¸€ä¸ªå…·æœ‰ç®¡ç†å‘˜æƒé™çš„ç”¨æˆ·ã€‚æä¾›çš„POCä»£ç é€šè¿‡æ„é€ åŒ…å«SYSTEM_ADMINè§’è‰²çš„ç”¨æˆ·åˆ›å»ºè¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ã€‚ ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä»£ç åŠŸèƒ½ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚

**é¡¹ç›®åœ°å€:** [K3ysTr0K3R/CVE-2024-27198-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2024-27198-EXPLOIT)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #7

**æ¥æº**: [CVE-2024-27198-Shimon03_Explora-o-RCE-n-o-autenticado-JetBrains-TeamCity-CVE-2024-27198-.md](../2024/CVE-2024-27198-Shimon03_Explora-o-RCE-n-o-autenticado-JetBrains-TeamCity-CVE-2024-27198-.md)

## CVE-2024-27198 - JetBrains TeamCity èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…æ‰§è¡Œç®¡ç†å‘˜æ“ä½œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®TeamCityæœåŠ¡å™¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-27198æ˜¯ä¸€ä¸ªJetBrains TeamCityä¸­çš„èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ï¼Œå½±å“ç‰ˆæœ¬ä½äº2023.11.4ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…æ‰§è¡Œç®¡ç†å‘˜æ“ä½œï¼ŒCVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚CISAå·²å°†æ­¤æ¼æ´æ·»åŠ åˆ°å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªåä¸º`Explora-o-RCE-n-o-autenticado-JetBrains-TeamCity-CVE-2024-27198-`çš„ä»“åº“ï¼Œè¡¨æ˜å®ƒå¯èƒ½ä¸æœªç»èº«ä»½éªŒè¯çš„RCEï¼ˆè¿œç¨‹ä»£ç æ‰§è¡Œï¼‰æ¼æ´æœ‰å…³ã€‚è™½ç„¶æä¾›çš„`README.md`æ–‡ä»¶å†…å®¹æœ‰é™ï¼Œä½†å®ƒç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æåˆ°äº†ç›¸å…³çš„CVEç¼–å·ã€‚è€ƒè™‘åˆ°CISAçš„KEVæ¡ç›®ï¼Œä»¥åŠ`darkreading.com`çš„æ–‡ç« ï¼Œè¡¨æ˜è¯¥æ¼æ´æ­£åœ¨è¢«ç§¯æåˆ©ç”¨ã€‚ç”±äºæä¾›çš„åˆ©ç”¨ä»£ç å†…å®¹åªæ˜¯ä¸€ä¸ªREADMEæ–‡ä»¶ï¼Œæ— æ³•ç¡®è®¤å®Œæ•´åˆ©ç”¨ç»†èŠ‚ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºç›®å‰çœ‹åˆ°çš„åªæœ‰readmeæ–‡ä»¶ï¼Œæ¶æ„ä½œè€…å¯èƒ½åœ¨å…¶ä»–æœªæä¾›çš„æ–‡ä»¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æŸç§æ‰‹æ®µç»•è¿‡èº«ä»½éªŒè¯æœºåˆ¶ï¼Œæœ€ç»ˆè·å¾—ç®¡ç†å‘˜æƒé™ï¼Œä»è€Œå¯ä»¥è¿›è¡Œä»»æ„æ“ä½œï¼ŒåŒ…æ‹¬ä½†ä¸é™äºæ•°æ®æ³„éœ²ã€ç¯¡æ”¹å’Œè¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Shimon03/Explora-o-RCE-n-o-autenticado-JetBrains-TeamCity-CVE-2024-27198-](https://github.com/Shimon03/Explora-o-RCE-n-o-autenticado-JetBrains-TeamCity-CVE-2024-27198-)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #8

**æ¥æº**: [CVE-2024-27198-W01fh4cker_CVE-2024-27198-RCE.md](../2024/CVE-2024-27198-W01fh4cker_CVE-2024-27198-RCE.md)

## CVE-2024-27198-TeamCity èº«ä»½éªŒè¯ç»•è¿‡ RCE

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…æ‰§è¡Œä»»æ„ç®¡ç†æ“ä½œå’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ TeamCity å®ä¾‹ç½‘ç»œå¯è¾¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-27198 å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…ç»•è¿‡ TeamCity çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»è€Œæ‰§è¡Œç®¡ç†å‘˜æ“ä½œã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡æ¼æ´ï¼ŒCVSS è¯„åˆ†ä¸º 9.8ï¼Œè¡¨æ˜å…¶å½±å“éå¸¸é«˜ã€‚CISA å·²å°†å…¶æ·»åŠ åˆ°å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½• (KEV)ï¼Œè¿™æ„å‘³ç€è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ Python POC ä»£ç  `CVE-2024-27198-RCE.py` çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåˆ©ç”¨äº†èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ï¼Œé€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œå…è®¸æ”»å‡»è€…ä¸Šä¼ æ¶æ„æ’ä»¶åˆ° TeamCity æœåŠ¡å™¨ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ä»£ç å°è¯•è·å–TeamCityç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿä¿¡æ¯ï¼Œè¿™æœ‰åŠ©äºç¡®å®šç›®æ ‡ç¯å¢ƒå¹¶é€‰æ‹©åˆé€‚çš„æ”»å‡»è½½è·ã€‚POCé€šè¿‡ç”ŸæˆåŒ…å«æ¶æ„JSPæ–‡ä»¶çš„æ’ä»¶,è¿›è€Œæ‰§è¡Œå‘½ä»¤.

**æŠ•æ¯’é£é™©ï¼š**

è™½ç„¶å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯ä¸ºäº†åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **JSP Shell å†…å®¹ï¼š** POCå…è®¸æŒ‡å®š`shell_file_content`å‚æ•°ï¼Œå¯ä»¥æ’å…¥ä»»æ„jspä»£ç ï¼Œè¿™å¯èƒ½è¢«æ»¥ç”¨.
*   **éšæœºæ•°ç”Ÿæˆï¼š** ä»£ç ä¸­ä½¿ç”¨äº†ä¸€äº›éšæœºå­—ç¬¦ä¸²ï¼Œä½†è¿™äº›éšæœºæ•°ç”Ÿæˆå™¨çš„å®‰å…¨æ€§å¯èƒ½ä¸è¶³ä»¥æŠµæŠ—é«˜çº§æ”»å‡»è€…çš„åˆ†æã€‚
*   **æ’ä»¶åï¼š**æ¶æ„jaråŒ…çš„åç§°å¯èƒ½ä¼šè¢«æ£€æµ‹å‡ºæ¥,éœ€è¦é¢å¤–å¤„ç†.

æ€»çš„æ¥è¯´ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡ä¸º 10%ã€‚ ä¸»è¦æ˜¯ä½œè€…å¯èƒ½åœ¨shell_file_contentå‚æ•°é‡Œé¢åšæ‰‹è„šï¼Œæ¯”å¦‚åŠ å…¥åå‘shellï¼Œè·å–è‚‰é¸¡æƒé™ç­‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **èº«ä»½éªŒè¯ç»•è¿‡ï¼š** æ”»å‡»è€…åˆ©ç”¨ TeamCity çš„èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ï¼Œæ— éœ€æä¾›æœ‰æ•ˆçš„ç”¨æˆ·åå’Œå¯†ç å³å¯è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
2.  **ä¸Šä¼ æ¶æ„æ’ä»¶ï¼š** æ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ä¸Šä¼ ä¸€ä¸ªåŒ…å«æ¶æ„ JSP æ–‡ä»¶çš„æ’ä»¶ï¼ˆJAR æ–‡ä»¶ï¼‰ã€‚è¯¥æ’ä»¶ä¼šä¼ªè£…æˆåˆæ³•æ’ä»¶ï¼Œä½†å®é™…ä¸ŠåŒ…å«æ¶æ„ä»£ç ã€‚
3.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** TeamCity æœåŠ¡å™¨ä¼šåŠ è½½å¹¶æ‰§è¡Œä¸Šä¼ çš„æ¶æ„æ’ä»¶ï¼Œä»è€Œå…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ”»å‡»è€…é€šå¸¸ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€å®‰è£…åé—¨æˆ–çªƒå–æ•æ„Ÿæ•°æ®ã€‚

æ€»ä½“æ¥è¯´ï¼Œåˆ©ç”¨æ–¹å¼ç›¸å½“ç›´æ¥ï¼Œä¾èµ–äºèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´æ¥æ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [W01fh4cker/CVE-2024-27198-RCE](https://github.com/W01fh4cker/CVE-2024-27198-RCE)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #9

**æ¥æº**: [CVE-2024-27198-geniuszly_CVE-2024-27198.md](../2024/CVE-2024-27198-geniuszly_CVE-2024-27198.md)

## CVE-2024-27198-JetBrains TeamCity èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…æ‰§è¡Œç®¡ç†æ“ä½œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®TeamCityæœåŠ¡å™¨ï¼Œç›®æ ‡ç‰ˆæœ¬ä½äº2023.11.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-27198æ˜¯JetBrains TeamCityæœåŠ¡å™¨ä¸­å­˜åœ¨çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡è®¿é—®ç‰¹å®šçš„URLï¼ˆ/pwned?jsp=/app/rest/users;.jspï¼‰å¹¶æ„é€ æ¶æ„è¯·æ±‚æ¥åˆ›å»ºæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨ä¸éœ€è¦ä»»ä½•ç‰¹æƒæˆ–ç”¨æˆ·äº¤äº’ã€‚æ¼æ´åˆ©ç”¨ä»£ç é¦–å…ˆå°è¯•è·å–TeamCityçš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œç„¶åé€šè¿‡å‘é€å¸¦æœ‰ç”¨æˆ·åã€å¯†ç å’Œç®¡ç†å‘˜è§’è‰²çš„JSONæœ‰æ•ˆè´Ÿè½½çš„POSTè¯·æ±‚åˆ°æ¼æ´URLæ¥åˆ›å»ºç”¨æˆ·ã€‚å¦‚æœæœåŠ¡å™¨å®¹æ˜“å—åˆ°æ”»å‡»ï¼Œå°†æˆåŠŸåˆ›å»ºå…·æœ‰ç®¡ç†å‘˜æƒé™çš„æ–°ç”¨æˆ·ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨ä»£ç åº”è¯¥æœ‰æ•ˆï¼Œå› ä¸ºè¯¥æ¼æ´å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISAå·²å°†å…¶æ·»åŠ åˆ°å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚ ä»£ç æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€è¯·æ±‚åˆ›å»ºç”¨æˆ·ã€‚ é£é™©ä¸»è¦æ¥è‡ªäºä»¥ä¸‹å‡ ç‚¹ï¼š

*   **ä¾èµ–é¡¹é£é™©ï¼š** è™½ç„¶ä»£ç æœ¬èº«åªä½¿ç”¨äº† `requests` å’Œ `urllib3` åº“ï¼Œä½†æ”»å‡»è€…å¯èƒ½ä¼šé€šè¿‡æ›¿æ¢æˆ–ç¯¡æ”¹è¿™äº›åº“æ¥æ¤å…¥æ¶æ„ä»£ç ã€‚ ä½†å¯èƒ½æ€§è¾ƒä½ã€‚
*   **ä»£ç æ··æ·†æˆ–éšè—ï¼š** ä»£ç çš„å¯è¯»æ€§è¾ƒé«˜ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ··æ·†æˆ–éšè—ä»£ç ã€‚ ä½†ä»ç„¶å­˜åœ¨ä¸€å®šé£é™©ï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡ç»†å¾®çš„ä¿®æ”¹æ¥æ·»åŠ æ¶æ„åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡TeamCityæœåŠ¡å™¨çš„URLã€è¦åˆ›å»ºçš„ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç ã€‚
2.  è„šæœ¬é¦–å…ˆå°è¯•è·å–TeamCityæœåŠ¡å™¨çš„ç‰ˆæœ¬ã€‚
3.  ç„¶åï¼Œè„šæœ¬æ„é€ ä¸€ä¸ªåŒ…å«ç”¨æˆ·åã€å¯†ç å’Œç®¡ç†å‘˜æƒé™çš„JSON payloadï¼Œå¹¶å°†å…¶å‘é€åˆ°`/pwned?jsp=/app/rest/users;.jsp`ç«¯ç‚¹ã€‚
4.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¯¥ç”¨æˆ·ç™»å½•å¹¶æ§åˆ¶TeamCityæœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [geniuszly/CVE-2024-27198](https://github.com/geniuszly/CVE-2024-27198)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #10

**æ¥æº**: [CVE-2024-27198-jrbH4CK_CVE-2024-27198.md](../2024/CVE-2024-27198-jrbH4CK_CVE-2024-27198.md)

## CVE-2024-27198 - JetBrains TeamCity Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…æ‰§è¡Œç®¡ç†å‘˜æ“ä½œï¼ŒåŒ…æ‹¬è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** TeamCityæœåŠ¡å™¨éœ€è¦è¿è¡Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸”ç½‘ç»œå¯è®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-27198 æ˜¯ JetBrains TeamCity ä¸­å­˜åœ¨çš„èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹åˆ¶çš„è¯·æ±‚ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶è·å¾—ç®¡ç†å‘˜æƒé™ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ TeamCity æœåŠ¡å™¨ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œ Rapid7 çš„åˆ†æï¼ˆREADME.mdä¸­å¼•ç”¨ï¼‰ï¼Œè¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…æ‰§è¡Œç®¡ç†å‘˜æ“ä½œã€‚æä¾›çš„PoCä»£ç ï¼ˆcve-2024-27198.pyï¼‰åˆ©ç”¨æ­¤æ¼æ´åˆ›å»ºä¸€ä¸ªå…·æœ‰ç³»ç»Ÿç®¡ç†å‘˜æƒé™çš„æ–°ç”¨æˆ·ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚åˆ° TeamCity æœåŠ¡å™¨çš„ `/hax?jsp=/app/rest/users;XXX.jsp` ç«¯ç‚¹ï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚
2.  åˆ©ç”¨è¯¥ç«¯ç‚¹ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ POST è¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ï¼Œå¹¶åœ¨è¯·æ±‚ä½“ä¸­æŒ‡å®šç”¨æˆ·åã€å¯†ç å’Œè§’è‰²ã€‚
3.  æˆåŠŸåˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·åï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨æ–°åˆ›å»ºçš„å‡­æ®ç™»å½• TeamCity å¹¶å®Œå…¨æ§åˆ¶æœåŠ¡å™¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆ†æäº†æä¾›çš„æ–‡ä»¶ï¼Œä¸»è¦é£é™©ç‚¹å¦‚ä¸‹ï¼š

*   **cve-2024-27198.pyï¼š** æ­¤æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ï¼Œç”¨äºåœ¨ç›®æ ‡ TeamCity æœåŠ¡å™¨ä¸Šåˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ã€‚ ä»£ç æœ¬èº«ä¼¼ä¹æ²¡æœ‰ç›´æ¥åŒ…å«æ¶æ„æŠ•æ¯’ä»£ç ï¼Œä½†åˆ›å»ºçš„ç®¡ç†å‘˜è´¦æˆ·æœ¬èº«å³ä¸ºåé—¨ã€‚å› æ­¤ï¼Œä¸èƒ½åˆ¤å®šä¸ºæŠ•æ¯’ã€‚
*   **README.mdï¼š**  æ­¤æ–‡ä»¶åŒ…å«æ¼æ´æè¿°ã€åˆ©ç”¨æ–¹æ³•å’Œå‚è€ƒé“¾æ¥ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„ä»£ç ã€‚
*   **img/test:** æ­¤æ–‡ä»¶ä¸ºç©ºï¼Œä¹Ÿæ²¡æœ‰é£é™©ã€‚

è™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹æ½œåœ¨çš„é£é™©ï¼š

1.  **ä¾èµ–åº“é£é™©ï¼š** PoCä»£ç ä½¿ç”¨ `requests` å’Œ `json` åº“ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›åº“çš„æºï¼ˆè™½ç„¶å¯èƒ½æ€§è¾ƒä½ï¼‰ï¼Œåˆ™å¯èƒ½å¼•å…¥æ¶æ„ä»£ç ã€‚ ä½†æ ¹æ®ç›®å‰æä¾›çš„ä¿¡æ¯ï¼Œæ— æ³•åˆ¤å®šå­˜åœ¨è¿™ç§é£é™©ã€‚
2.  **åé—¨é£é™©ï¼š** PoCä»£ç åˆ›å»ºçš„ç®¡ç†å‘˜å¸æˆ·æœ¬èº«å°±æ˜¯ä¸€ä¸ªåé—¨ï¼Œå¦‚æœè¯¥ä»£ç è¢«æ¶æ„ä¼ æ’­ï¼Œå¯èƒ½è¢«ç”¨äºæœªç»æˆæƒçš„è®¿é—®ã€‚

ç»¼åˆè€ƒè™‘ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚ä¸»è¦é£é™©åœ¨äºæ¼æ´åˆ©ç”¨æœ¬èº«å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [jrbH4CK/CVE-2024-27198](https://github.com/jrbH4CK/CVE-2024-27198)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #11

**æ¥æº**: [CVE-2024-27198-passwa11_CVE-2024-27198-RCE.md](../2024/CVE-2024-27198-passwa11_CVE-2024-27198-RCE.md)

## CVE-2024-27198-JetBrains TeamCity è®¤è¯ç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·æ‰§è¡Œç®¡ç†æ“ä½œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡TeamCityå®ä¾‹å¯ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-27198æ˜¯JetBrains TeamCity 2023.11.4ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨çš„è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…æ‰§è¡Œç®¡ç†æ“ä½œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (CVE-2024-27198-RCE.py)å°è¯•é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨æ­¤æ¼æ´ï¼š

1.  **æ·»åŠ ç”¨æˆ·ï¼š** é¦–å…ˆï¼Œåˆ©ç”¨è„šæœ¬çš„`/hax?jsp=/app/rest/users;.jsp`ç«¯ç‚¹ï¼Œå°è¯•æ·»åŠ å…·æœ‰ç®¡ç†å‘˜æƒé™çš„æ–°ç”¨æˆ·ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™ä¼šæ‹¿åˆ°æ–°å¢ç”¨æˆ·çš„userIDã€‚
2.  **è·å–Tokenï¼š** ä¸ºè¯¥æ–°å¢ç”¨æˆ·åˆ›å»ºtokenï¼Œç”¨äºåç»­é‰´æƒã€‚
3.  **è·å–æ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼š** è„šæœ¬é€šè¿‡è®¿é—®`/app/rest/debug/processes`ç«¯ç‚¹ï¼Œå°è¯•æ‰§è¡Œ`echo ReadyGO`å‘½ä»¤æ¥åˆ¤æ–­ç›®æ ‡æ“ä½œç³»ç»Ÿæ˜¯Linuxè¿˜æ˜¯Windowsã€‚
4.  **æ‰§è¡Œå‘½ä»¤ï¼š** åœ¨è·å–æ“ä½œç³»ç»Ÿç‰ˆæœ¬åï¼Œè„šæœ¬å†æ¬¡ä½¿ç”¨`/app/rest/debug/processes`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ ç‰¹å®šçš„URLæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚å‘½ä»¤çš„æ‰§è¡Œä¾èµ–äºä¸Šä¸€æ­¥tokenæ˜¯å¦è·å–æˆåŠŸã€‚

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«CISAåˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•ï¼Œè¡¨æ˜è¯¥æ¼æ´åœ¨é‡å¤–å·²è¢«ç§¯æåˆ©ç”¨ã€‚CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚æä¾›çš„POCä»£ç åˆ©ç”¨äº†èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ï¼Œèƒ½å¤Ÿåˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤ï¼ŒéªŒè¯äº†å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ä»”ç»†æ£€æŸ¥æä¾›çš„POCä»£ç åï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„æˆ–æŠ•æ¯’ä»£ç ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œä¸»è¦ç”¨äºåˆ©ç”¨æ¼æ´è¿›è¡Œèº«ä»½éªŒè¯ç»•è¿‡å’Œå‘½ä»¤æ‰§è¡Œã€‚ä»£ç ä¸­çš„åŠŸèƒ½éƒ½ä¸æ¼æ´åˆ©ç”¨ç›´æ¥ç›¸å…³ï¼Œæ²¡æœ‰å‘ç°ä¸é¢„æœŸåŠŸèƒ½ä¸ç¬¦çš„éšè—æˆ–å¯ç–‘è¡Œä¸ºã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ï¼Œç„¶ååˆ©ç”¨ç»•è¿‡çš„èº«ä»½éªŒè¯æ‰§è¡Œç®¡ç†æ“ä½œï¼ŒåŒ…æ‹¬æ·»åŠ æ¶æ„ç”¨æˆ·å’Œæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚è¯¥æ¼æ´å¯èƒ½è¢«ç”¨äºæ§åˆ¶TeamCityæœåŠ¡å™¨ï¼Œçªƒå–æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–è€…è¿›ä¸€æ­¥æ”»å‡»å†…éƒ¨ç½‘ç»œã€‚

**é¡¹ç›®åœ°å€:** [passwa11/CVE-2024-27198-RCE](https://github.com/passwa11/CVE-2024-27198-RCE)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #12

**æ¥æº**: [CVE-2024-27198-wall0wW1spr_CVE-2024-27198.md](../2024/CVE-2024-27198-wall0wW1spr_CVE-2024-27198.md)

## CVE-2024-27198-JetBrains TeamCity èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·æ‰§è¡Œç®¡ç†å‘˜æ“ä½œï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®TeamCityæœåŠ¡å™¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-27198æ˜¯JetBrains TeamCity 2023.11.4ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œæ‰§è¡Œç®¡ç†å‘˜æ“ä½œã€‚æä¾›çš„PoCåˆ©ç”¨ä»£ç é€šè¿‡å‘`/evildjnn?jsp=/app/rest/users;.jsp`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ï¼Œåˆ›å»ºä¸€ä¸ªå…·æœ‰SYSTEM_ADMINè§’è‰²çš„æ–°ç”¨æˆ·ã€‚åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€æä¾›TeamCityæœåŠ¡å™¨çš„URLï¼Œä»¥åŠè¦åˆ›å»ºçš„ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç ã€‚ç”±äºæ¼æ´åˆ©ç”¨ä»£ç ç›´æ¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ï¼Œæœªå‘ç°éšè—çš„æ¶æ„ä»£ç æˆ–æŠ•æ¯’è¡Œä¸ºã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [wall0wW1spr/CVE-2024-27198](https://github.com/wall0wW1spr/CVE-2024-27198)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #13

**æ¥æº**: [CVE-2024-27198-yoryio_CVE-2024-27198.md](../2024/CVE-2024-27198-yoryio_CVE-2024-27198.md)

## CVE-2024-27198-JetBrainsTeamCity-è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·æ‰§è¡Œç®¡ç†å‘˜æ“ä½œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡TeamCityæœåŠ¡å™¨å¯è®¿é—®ï¼Œæœªåº”ç”¨è¡¥ä¸

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-27198 å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶åœ¨å—å½±å“çš„ TeamCity æœåŠ¡å™¨ä¸Šæ‰§è¡Œç®¡ç†æ“ä½œã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯åˆ©ç”¨`pwned?jsp=/app/rest/users;.jsp` è¿™ä¸ªç‰¹æ®Šçš„ç«¯ç‚¹ï¼Œè¯¥ç«¯ç‚¹å…è®¸æ”»å‡»è€…åœ¨æœªæˆæƒçš„æƒ…å†µä¸‹åˆ›å»ºæ–°ç”¨æˆ·ï¼Œå¹¶å°†è¯¥ç”¨æˆ·è®¾ç½®ä¸ºç®¡ç†å‘˜ã€‚æä¾›çš„PoC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç”¨æˆ·åå’Œå¯†ç çš„ POST è¯·æ±‚åˆ°è¯¥ç«¯ç‚¹æ¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ã€‚ä»PoCä»£ç åˆ†ææ¥çœ‹ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œè¯¥è„šæœ¬åªæ˜¯æŒ‰ç…§æ¼æ´åŸç†å®ç°äº†åˆ©ç”¨è¿‡ç¨‹ã€‚é£é™©åœ¨äºå¦‚æœæ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´æˆåŠŸåˆ›å»ºç®¡ç†å‘˜è´¦æˆ·ï¼Œä»–ä»¬å¯ä»¥å®Œå…¨æ§åˆ¶ TeamCity æœåŠ¡å™¨ï¼ŒåŒ…æ‹¬è¯»å–æ•æ„Ÿä¿¡æ¯ï¼Œä¿®æ”¹æ„å»ºé…ç½®ï¼Œç”šè‡³æ‰§è¡Œä»»æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [yoryio/CVE-2024-27198](https://github.com/yoryio/CVE-2024-27198)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---



---

## POC #12

**æ¥æº**: [CVE-2024-27198-wall0wW1spr_CVE-2024-27198.md](../2024/CVE-2024-27198-wall0wW1spr_CVE-2024-27198.md)

## CVE-2024-27198-JetBrains TeamCity èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·æ‰§è¡Œç®¡ç†å‘˜æ“ä½œï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®TeamCityæœåŠ¡å™¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-27198æ˜¯JetBrains TeamCity 2023.11.4ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œæ‰§è¡Œç®¡ç†å‘˜æ“ä½œã€‚æä¾›çš„PoCåˆ©ç”¨ä»£ç é€šè¿‡å‘`/evildjnn?jsp=/app/rest/users;.jsp`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ï¼Œåˆ›å»ºä¸€ä¸ªå…·æœ‰SYSTEM_ADMINè§’è‰²çš„æ–°ç”¨æˆ·ã€‚åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€æä¾›TeamCityæœåŠ¡å™¨çš„URLï¼Œä»¥åŠè¦åˆ›å»ºçš„ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç ã€‚ç”±äºæ¼æ´åˆ©ç”¨ä»£ç ç›´æ¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ï¼Œæœªå‘ç°éšè—çš„æ¶æ„ä»£ç æˆ–æŠ•æ¯’è¡Œä¸ºã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [wall0wW1spr/CVE-2024-27198](https://github.com/wall0wW1spr/CVE-2024-27198)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

## POC #13

**æ¥æº**: [CVE-2024-27198-yoryio_CVE-2024-27198.md](../2024/CVE-2024-27198-yoryio_CVE-2024-27198.md)

## CVE-2024-27198-JetBrainsTeamCity-è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-27198

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** JetBrains TeamCity

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·æ‰§è¡Œç®¡ç†å‘˜æ“ä½œ

**å½±å“ç‰ˆæœ¬:** < 2023.11.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡TeamCityæœåŠ¡å™¨å¯è®¿é—®ï¼Œæœªåº”ç”¨è¡¥ä¸

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-27198 å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶åœ¨å—å½±å“çš„ TeamCity æœåŠ¡å™¨ä¸Šæ‰§è¡Œç®¡ç†æ“ä½œã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯åˆ©ç”¨`pwned?jsp=/app/rest/users;.jsp` è¿™ä¸ªç‰¹æ®Šçš„ç«¯ç‚¹ï¼Œè¯¥ç«¯ç‚¹å…è®¸æ”»å‡»è€…åœ¨æœªæˆæƒçš„æƒ…å†µä¸‹åˆ›å»ºæ–°ç”¨æˆ·ï¼Œå¹¶å°†è¯¥ç”¨æˆ·è®¾ç½®ä¸ºç®¡ç†å‘˜ã€‚æä¾›çš„PoC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç”¨æˆ·åå’Œå¯†ç çš„ POST è¯·æ±‚åˆ°è¯¥ç«¯ç‚¹æ¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ã€‚ä»PoCä»£ç åˆ†ææ¥çœ‹ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œè¯¥è„šæœ¬åªæ˜¯æŒ‰ç…§æ¼æ´åŸç†å®ç°äº†åˆ©ç”¨è¿‡ç¨‹ã€‚é£é™©åœ¨äºå¦‚æœæ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´æˆåŠŸåˆ›å»ºç®¡ç†å‘˜è´¦æˆ·ï¼Œä»–ä»¬å¯ä»¥å®Œå…¨æ§åˆ¶ TeamCity æœåŠ¡å™¨ï¼ŒåŒ…æ‹¬è¯»å–æ•æ„Ÿä¿¡æ¯ï¼Œä¿®æ”¹æ„å»ºé…ç½®ï¼Œç”šè‡³æ‰§è¡Œä»»æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [yoryio/CVE-2024-27198](https://github.com/yoryio/CVE-2024-27198)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)

---

