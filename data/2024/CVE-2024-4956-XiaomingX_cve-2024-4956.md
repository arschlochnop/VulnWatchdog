# CVE-2024-4956

> ğŸ“¦ è¯¥CVEæœ‰ **18** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4956-An00bRektn_shirocrack.md](../2024/CVE-2024-4956-An00bRektn_shirocrack.md)

## CVE-2024-4956-Sonatype Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´çš„åˆ©ç”¨ç›¸å¯¹ç®€å•ï¼Œåªéœ€å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚å³å¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `shirocrack` æœ¬èº«å¹¶ä¸æ˜¯ç›´æ¥åˆ©ç”¨è·¯å¾„éå†æ¼æ´çš„PoCï¼Œè€Œæ˜¯åˆ©ç”¨è·¯å¾„éå†è¯»å–åˆ°çš„ç”¨æˆ·å¯†ç å“ˆå¸Œè¿›è¡Œç ´è§£çš„å·¥å…·ã€‚è¯¥å·¥å…·æ˜¯ä¸ºäº†ç ´è§£ Apache Shiro æ¡†æ¶ä½¿ç”¨çš„å¯†ç å“ˆå¸Œã€‚æŠ•æ¯’é£é™©åˆ†æï¼šè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªå¯†ç ç ´è§£å·¥å…·ï¼Œå…¶æœ¬èº«åŠŸèƒ½æ¯”è¾ƒæ˜ç¡®ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`shirocrack.go` åªæ˜¯ä¸€ä¸ªä½¿ç”¨å­—å…¸è¿›è¡Œæš´åŠ›ç ´è§£çš„å·¥å…·ï¼Œä½†å­˜åœ¨ä½œè€…æ·»åŠ åé—¨çš„é£é™©ï¼Œè€ƒè™‘åˆ°è¯¥å·¥å…·çš„ç”¨é€”ï¼Œä»¥åŠä½œè€…å¯èƒ½å‡ºäºæŸäº›ç›®çš„æ¤å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©, ç™¾åˆ†æ¯”ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é¦–å…ˆåˆ©ç”¨ CVE-2024-4956 è·¯å¾„éå†æ¼æ´è¯»å– Nexus Repository Manager æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œæ¯”å¦‚åŒ…å«å¯†ç å“ˆå¸Œçš„ `.pcl` æ–‡ä»¶ã€‚ç„¶åï¼Œä½¿ç”¨æä¾›çš„ `shirocrack` å·¥å…·ç ´è§£è¿™äº›å¯†ç å“ˆå¸Œã€‚å¦‚æœç ´è§£æˆåŠŸï¼Œæ”»å‡»è€…å°±å¯ä»¥ä½¿ç”¨ç ´è§£çš„å¯†ç ç™»å½• Nexus Repository Managerï¼Œæˆ–è€…åˆ©ç”¨æ³„éœ²çš„å…¶ä»–ä¿¡æ¯è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [An00bRektn/shirocrack](https://github.com/An00bRektn/shirocrack)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #2

**æ¥æº**: [CVE-2024-4956-Buff3st-0v3rfl0w_CVE-2024-4956.md](../2024/CVE-2024-4956-Buff3st-0v3rfl0w_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository 3 ä¸­å­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äºæ‰€æœ‰ 3.x ç‰ˆæœ¬ç›´åˆ° 3.68.0ï¼ˆåŒ…å« 3.68.0ï¼‰ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚å®ƒé€šè¿‡æ„é€ ä¸€ä¸ªåŒ…å«å¤šä¸ª `..` åºåˆ—çš„ URLï¼Œå°è¯•è®¿é—®æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å›æ–‡ä»¶çš„å†…å®¹ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†æäº†æä¾›çš„ Python è„šæœ¬ï¼ˆCVE-2024-4956.pyï¼‰å’Œ README.md æ–‡ä»¶ã€‚

*   **CVE-2024-4956.py:** è¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP GET è¯·æ±‚åˆ°ç›®æ ‡ Nexus Repository æœåŠ¡å™¨ï¼Œè¯·æ±‚ä¸­åŒ…å«ç»è¿‡ç¼–ç çš„è·¯å¾„éå† payloadã€‚è„šæœ¬åŒ…å«åŸºæœ¬çš„é”™è¯¯å¤„ç†ï¼Œå¹¶åœ¨å“åº”ä¸­æ£€æŸ¥ "Not Found" å­—ç¬¦ä¸²ä»¥ç¡®å®šæ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚è„šæœ¬çš„åŠŸèƒ½ä¸å…¶æè¿°çš„åŠŸèƒ½ä¸€è‡´ï¼Œå³åˆ©ç”¨ CVE-2024-4956 è¿›è¡Œæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰ã€‚
*   **README.md:** è¯¥æ–‡ä»¶æä¾›äº†æœ‰å…³å¦‚ä½•ä½¿ç”¨è¯¥è„šæœ¬çš„åŸºæœ¬ä¿¡æ¯ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘å†…å®¹ã€‚

å°½ç®¡æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†ä»»ä½•ä»ä¸å—ä¿¡ä»»çš„æ¥æºè·å–çš„ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚æ­¤è„šæœ¬çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š
    *   **ä¾èµ–å…³ç³»é£é™©ï¼š** è„šæœ¬ä½¿ç”¨ `requests` åº“ã€‚è™½ç„¶ `requests` æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„åº“ï¼Œä½†æ”»å‡»è€…å¯èƒ½ä¼šå°è¯•é€šè¿‡æ¶æ„ç‰ˆæœ¬çš„ `requests` æˆ– `requests` çš„ä¾èµ–é¡¹è¿›è¡ŒæŠ•æ¯’ï¼Œå°½ç®¡è¿™ç§æƒ…å†µä¸å¤ªå¯èƒ½ã€‚
    *   **å¼€å‘è€…ç–å¿½ï¼š** å¼€å‘è€…å¯èƒ½ä¼šåœ¨æ— æ„ä¸­å¼•å…¥æ¼æ´æˆ–é”™è¯¯ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™äº›æ¼æ´æˆ–é”™è¯¯ã€‚
    *   **å…ƒæ•°æ®æ¬ºéª—ï¼š** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬çš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚ä½œè€…ä¿¡æ¯æˆ–æè¿°ï¼Œä»¥ä½¿å…¶çœ‹èµ·æ¥æ›´å¯ä¿¡ã€‚
    *   **æœ‰é™çš„å®¡æŸ¥ï¼š** ç”±äºæ²¡æœ‰å¯¹è¯¥è„šæœ¬è¿›è¡Œå¹¿æ³›çš„å®¡æŸ¥ï¼Œå› æ­¤æ— æ³•å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚

å»ºè®®åœ¨ä½¿ç”¨å‰å®¡æŸ¥è¯¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ `http://<nexus_ip>:<nexus_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`ã€‚
2.  Nexus Repository æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯ URL ä¸­çš„è·¯å¾„ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è®¿é—® `/etc/passwd` æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨å°† `/etc/passwd` æ–‡ä»¶çš„å†…å®¹è¿”å›ç»™æ”»å‡»è€…ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Buff3st-0v3rfl0w/CVE-2024-4956](https://github.com/Buff3st-0v3rfl0w/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #3

**æ¥æº**: [CVE-2024-4956-Cappricio-Securities_CVE-2024-4956.md](../2024/CVE-2024-4956-Cappricio-Securities_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 3.0.0 <= version <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒNexus Repository Manager 3ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®ç›®æ ‡ç³»ç»Ÿã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ 3.0.0 åˆ° 3.68.0 ä¹‹é—´çš„æ‰€æœ‰ Nexus Repository Manager 3.x ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç  (POC) æ˜¾ç¤ºï¼ŒCappricio-Securities å·²ç»å¼€å‘äº†ç›¸åº”çš„æ¼æ´åˆ©ç”¨å·¥å…·ï¼Œé€šè¿‡æ„é€ ç‰¹å®šçš„ URLï¼Œæ”»å‡»è€…å¯ä»¥ä¸‹è½½æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚è¯¥å·¥å…·æ”¯æŒå•ä¸ª URL æ‰«æã€æ‰¹é‡ URL æ‰«æï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚é›†æˆäº†Telegram APIï¼Œå¯ç”¨äºæ¥æ”¶æ¼æ´æ£€æµ‹çš„å³æ—¶é€šçŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å­˜åœ¨å…¬å¼€å¯ç”¨çš„POCã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç æ–‡ä»¶ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å®ç°æ¼æ´éªŒè¯å’Œåˆ©ç”¨ã€‚å…¶ä¸­ï¼ŒREADME.md æ–‡ä»¶ä¸­å¼•ç”¨äº†å¤–éƒ¨å›¾ç‰‡å’Œshields.io çš„å¾½ç« ï¼Œå­˜åœ¨ä¸€å®šçš„ä¾›åº”é“¾æŠ•æ¯’é£é™©ï¼Œä½†æ€»ä½“é£é™©è¾ƒä½ã€‚æ­¤å¤–ï¼ŒPOC å·¥å…·é›†æˆäº† Telegram API å‘é€é€šçŸ¥ï¼Œä½¿ç”¨è€…éœ€è¦æä¾›è‡ªå·±çš„ Telegram Chat IDï¼Œå¯èƒ½å­˜åœ¨éšç§æ³„éœ²é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©å¤§çº¦ä¸º 10%ï¼Œä¸»è¦æ¥è‡ªä¾›åº”é“¾ä¾èµ–å’Œä¸ªäººä¿¡æ¯æ³„éœ²ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ä½¿ç”¨ Cappricio-Securities æä¾›çš„ CVE-2024-4956 å·¥å…·ã€‚
2.  é€šè¿‡ pip å®‰è£…è¯¥å·¥å…·ï¼š`pip install CVE-2024-4956`ã€‚
3.  ä½¿ç”¨ `-u` å‚æ•°æŒ‡å®šå•ä¸ªç›®æ ‡ URLï¼Œæˆ–è€…ä½¿ç”¨ `-i` å‚æ•°æŒ‡å®šåŒ…å«å¤šä¸ªç›®æ ‡ URL çš„æ–‡æœ¬æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„æ¶æ„ URLï¼Œä¾‹å¦‚ï¼š`http://example.com/../../../etc/passwd`ï¼Œåˆ©ç”¨è¯¥ URL ä¸‹è½½ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd` æˆ–åº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ã€‚
5.  å¯ä»¥ä½¿ç”¨ `-o` å‚æ•°å°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­ã€‚
6.  å·¥å…·é›†æˆäº†Telegram APIï¼Œå¯ä»¥é€šè¿‡é…ç½®Chat IDï¼Œæ¥æ”¶æ¼æ´æ£€æµ‹çš„å³æ—¶é€šçŸ¥

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-4956](https://github.com/Cappricio-Securities/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #4

**æ¥æº**: [CVE-2024-4956-GoatSecurity_CVE-2024-4956.md](../2024/CVE-2024-4956-GoatSecurity_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Manager 3å®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«å¤šä¸ª "/%2F" å’Œ "../" çš„ URLï¼Œç»•è¿‡è·¯å¾„æ£€æŸ¥ï¼Œæœ€ç»ˆè®¿é—®åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/passwdã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå¯ä»¥éªŒè¯æ¼æ´çš„HTTPè¯·æ±‚å’Œä¸€ä¸ªå¯ä»¥æ‰¹é‡æ‰«æç›®æ ‡çš„pythonè„šæœ¬ã€‚è„šæœ¬ä»targets.txtè¯»å–ç›®æ ‡URLï¼Œå¹¶å¯¹æ¯ä¸ªURLå°è¯•åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–/etc/passwdæ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™å°†è¯¥URLæ·»åŠ åˆ°vulnerable_sitesåˆ—è¡¨ä¸­ï¼Œå¯ä»¥é€‰æ‹©ä¿å­˜åˆ°output.txtæ–‡ä»¶ä¸­ã€‚è™½ç„¶è„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚targets.txtä¸­å¯èƒ½åŒ…å«æŒ‡å‘æ¶æ„ç«™ç‚¹çš„é“¾æ¥ï¼Œæˆ–ä½œè€…æœªæ¥å¯èƒ½åœ¨githubä»“åº“ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚æ‰«æè„šæœ¬åˆ©ç”¨requestsåº“å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨å› ç›®æ ‡æœåŠ¡å™¨ç½‘ç»œæ³¢åŠ¨å¯¼è‡´è¯¯æŠ¥çš„æƒ…å†µã€‚

**é¡¹ç›®åœ°å€:** [GoatSecurity/CVE-2024-4956](https://github.com/GoatSecurity/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #5

**æ¥æº**: [CVE-2024-4956-JolyIrsb_CVE-2024-4956.md](../2024/CVE-2024-4956-JolyIrsb_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œéœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„ Python è„šæœ¬ `CVE-2024-4956-threads.py` æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´ã€‚ å®ƒé€šè¿‡æ„é€ åŒ…å«å¤šä¸ª `/%2F` å’Œ `../` åºåˆ—çš„ URL æ¥å°è¯•è¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„ `/etc/passwd` æ–‡ä»¶ã€‚å¦‚æœå“åº”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è„šæœ¬è®¤ä¸ºè¯¥ä¸»æœºå­˜åœ¨æ¼æ´ã€‚æä¾›çš„nucleiæ¨¡ç‰ˆå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
ä»£ç æœ¬èº«å®ç°çš„åŠŸèƒ½ä¸ºè¯»å–ç›®æ ‡æœºå™¨ä¸Šçš„æ–‡ä»¶ï¼Œä»ä»£ç åŠŸèƒ½ä¸Šåˆ¤æ–­ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ä»£ç çš„ä½œè€…å¯ä»¥åœ¨check_vulnerabilityå‡½æ•°ä¸­æ·»åŠ é¢å¤–çš„æ¶æ„ä»£ç ,ç”¨äºæ”¶é›†ç›®æ ‡ä¸»æœºçš„ä¿¡æ¯æˆ–è€…æ¤å…¥åé—¨ç¨‹åºï¼Œä½†ä»ç›®å‰çš„ä»£ç æ¥çœ‹ï¼Œæ²¡æœ‰å‘ç°ç›´æ¥çš„æŠ•æ¯’ä»£ç ã€‚README.md ä¸­çš„å£°æ˜ä¹Ÿæš—ç¤ºäº†é£é™©çš„å­˜åœ¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚å› ä¸ºä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œå¦‚æœå­˜åœ¨æ¶æ„ä»£ç å®¹æ˜“è¢«å‘ç°ã€‚ 

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚ `/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`ï¼‰çš„ URLã€‚
2.  Nexus Repository Manager 3 é”™è¯¯åœ°å¤„ç†è¯¥ URLï¼Œå…è®¸æ”»å‡»è€…è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç å’Œç³»ç»Ÿæ–‡ä»¶ã€‚
4.  ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬,å¯ä»¥æ‰¹é‡å¯¹ç›®æ ‡è¿›è¡Œæ‰«æ,è¯†åˆ«å­˜åœ¨æ¼æ´çš„ä¸»æœºã€‚
5.  æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„nucleiæ¨¡ç‰ˆï¼ŒåŒ…å«ä¸»åŠ¨æ‰«æå’Œè¢«åŠ¨æå–ç‰ˆæœ¬ï¼Œæ–¹ä¾¿æ¼æ´éªŒè¯

**é¡¹ç›®åœ°å€:** [JolyIrsb/CVE-2024-4956](https://github.com/JolyIrsb/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #6

**æ¥æº**: [CVE-2024-4956-Praison001_CVE-2024-4956-Sonatype-Nexus-Repository-Manager.md](../2024/CVE-2024-4956-Praison001_CVE-2024-4956-Sonatype-Nexus-Repository-Manager.md)

## CVE-2024-4956-Sonatype Nexus Repository Manager-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Managerå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆä¾‹å¦‚ `%2F` å’Œ `..`ï¼‰çš„ URLï¼Œè¯»å– Nexus Repository Manager æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„PoCä»£ç åŒ…å« Python å’Œ Bash ä¸¤ç§å®ç°ï¼Œéƒ½åˆ©ç”¨äº† URL ç¼–ç çš„è·¯å¾„éå†åºåˆ—æ¥è®¿é—®ç›®æ ‡æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªæˆæƒè®¿é—®ç³»ç»Ÿæ–‡ä»¶ï¼ŒPoC ä»£ç çš„ç›®çš„æ˜¯é€šè¿‡æ„é€ æ¶æ„ URL è¯»å–æœåŠ¡å™¨æ–‡ä»¶ã€‚PoCä»£ç ç»™å‡ºäº†Python3å’ŒBashä¸¤ç§åˆ©ç”¨æ–¹å¼ï¼Œå¹¶ä¸”æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒéªŒè¯äº†å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

PoC ä»£ç ï¼ˆ`exploitBash.sh` å’Œ `exploitPython.py`ï¼‰çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP GET è¯·æ±‚ä»¥åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å°è¯•æ‰§è¡Œæ¶æ„æ“ä½œï¼ˆä¾‹å¦‚ï¼Œå†™å…¥æ–‡ä»¶ã€æ‰§è¡Œå‘½ä»¤ï¼‰çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚è„šæœ¬çš„è¡Œä¸ºç¬¦åˆæ¼æ´æè¿°ï¼Œæ—¨åœ¨è¯»å–æŒ‡å®šæ–‡ä»¶å†…å®¹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡Nexus Repository Managerå®ä¾‹çš„URLå’Œç«¯å£ï¼š**  ä¾‹å¦‚`http://127.0.0.1:8081`ã€‚
2.  **æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„æ¶æ„URLï¼š**  PoCä»£ç ä¸­ä½¿ç”¨äº†`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..{targetFile}`ï¼Œå…¶ä¸­`{targetFile}`æ˜¯è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  **å‘é€HTTP GETè¯·æ±‚ï¼š**  ä½¿ç”¨PoCä»£ç æä¾›çš„Pythonè„šæœ¬æˆ–Bashè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLã€ç«¯å£å’Œè¦è¯»å–çš„æ–‡ä»¶ã€‚
4.  **åˆ†æå“åº”ï¼š**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚å¦‚æœåˆ©ç”¨å¤±è´¥ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šè¿”å›é”™è¯¯ä»£ç æˆ–æ¶ˆæ¯ã€‚

**é˜²èŒƒæªæ–½ï¼š**

*   å‡çº§åˆ° Sonatype Nexus Repository Manager 3.68.1 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å‚è€ƒ Sonatype å®˜æ–¹æ–‡æ¡£ï¼Œå®æ–½é€‚å½“çš„ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager](https://github.com/Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #7

**æ¥æº**: [CVE-2024-4956-TypicalModMaker_CVE-2024-4956.md](../2024/CVE-2024-4956-TypicalModMaker_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Sonatype Nexus Repository Manager 3ï¼Œä¸”å…è®¸æœªæˆæƒç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨ç²¾å¿ƒæ„é€ çš„URLæ¥ä¸‹è½½ä»»æ„æ–‡ä»¶ã€‚`README.md`æ–‡ä»¶ä¸­æè¿°äº†ç›¸å…³çš„åˆ©ç”¨è„šæœ¬ï¼ŒåŒ…æ‹¬æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å®¹æ˜“å—åˆ°æ”»å‡» (`check-vulnerable-servers.py`)ï¼Œæ£€æŸ¥æ˜¯å¦ä»¥ root ç”¨æˆ·èº«ä»½è¿è¡Œ (`check-root-servers.py`)ï¼Œä»¥åŠå°è¯•ä½¿ç”¨æ‰¾åˆ°çš„ç§é’¥é€šè¿‡ SSH ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½• (`check-private_keys.py`)ã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š** ä»“åº“ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„è„šæœ¬ä¸»è¦ç”¨äºæ£€æµ‹å’Œåˆ©ç”¨æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ã€‚ä½†å­˜åœ¨è½»å¾®é£é™©ï¼Œä½“ç°åœ¨`check-private_keys.py`ï¼Œå¯èƒ½å­˜åœ¨æ”¶é›†ç§é’¥ç”¨äºå…¶ä»–ç›®çš„ï¼Œæ‰€ä»¥åˆ¤å®šæŠ•æ¯’é£é™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ä½¿ç”¨ Shodan ç­‰æœç´¢å¼•æ“æŸ¥æ‰¾æš´éœ²åœ¨ç½‘ç»œä¸Šçš„ Sonatype Nexus Repository Manager 3 å®ä¾‹ã€‚
2.  ä½¿ç”¨ `check-vulnerable-servers.py` è„šæœ¬éªŒè¯ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨ CVE-2024-4956 æ¼æ´ï¼Œé€šè¿‡å°è¯•è¯»å– `/etc/passwd` æ–‡ä»¶æ¥éªŒè¯ã€‚
3.  ï¼ˆå¦‚æœç›®æ ‡ä»¥ root èº«ä»½è¿è¡Œï¼‰ä½¿ç”¨ `check-root-servers.py` è„šæœ¬éªŒè¯ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å¯ä»¥è¯»å– `/etc/shadow` æ–‡ä»¶ã€‚
4.  ï¼ˆå¦‚æœç›®æ ‡ä»¥ root èº«ä»½è¿è¡Œï¼‰ä½¿ç”¨ `check-private_keys.py` è„šæœ¬æŸ¥æ‰¾å¸¸è§çš„ç§é’¥è·¯å¾„ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°è¯•ä½¿ç”¨è¿™äº›ç§é’¥é€šè¿‡ SSH ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½•ã€‚

**é¡¹ç›®åœ°å€:** [TypicalModMaker/CVE-2024-4956](https://github.com/TypicalModMaker/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #8

**æ¥æº**: [CVE-2024-4956-UMASANKAR-MG_Path-Traversal-CVE-2024-4956.md](../2024/CVE-2024-4956-UMASANKAR-MG_Path-Traversal-CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 - è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Manager 3å®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 30%

## è¯¦æƒ…

æ ¹æ®CVE-2024-4956çš„æè¿°ï¼ŒSonatype Nexus Repository Manager 3å­˜åœ¨ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚è¯¥æ¼æ´å·²åœ¨3.68.1ç‰ˆæœ¬ä¸­ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ä»æä¾›çš„æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå½±å“ã€‚ç½‘é¡µ0ã€1ã€2ã€3ã€5ã€6ã€7å’Œ8å‡æåˆ°äº†CVE-2024-4956æ˜¯ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚ç½‘é¡µ9æä¾›äº†åŒ…å«PoCä»£ç çš„GitHubé“¾æ¥ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

æä¾›çš„PoCä»£ç åŒ…å«å‡ ä¸ªæ–‡ä»¶ï¼š
* `LICENSE`ï¼šMITè®¸å¯è¯ã€‚
* `cve/README.md`ï¼šæ¼æ´æè¿°ã€å…è´£å£°æ˜ã€PoCè§†é¢‘é“¾æ¥ã€å¸®åŠ©èœå•ã€ä½œè€…ä¿¡æ¯å’Œåé¦ˆæ–¹å¼ã€‚
* `cve/main.py`ï¼šä¸»ç¨‹åºå…¥å£ï¼ŒåŒ…å«å‘½ä»¤è¡Œå‚æ•°è§£æå’Œæ¼æ´åˆ©ç”¨é€»è¾‘ã€‚
* `cve/setup.py`ï¼šç”¨äºæ‰“åŒ…å’Œå®‰è£…PoCå·¥å…·çš„setupæ–‡ä»¶ã€‚
* `cve/includes/__init__.py`ï¼šä¸€ä¸ªç©ºçš„åˆå§‹åŒ–æ–‡ä»¶
* `cve/includes/file.py`ï¼šä¸€ä¸ªæ–‡ä»¶è¯»å–ç›¸å…³çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä»£ç ä¸å®Œæ•´

ä»`cve/main.py`çš„ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥è„šæœ¬æ¥å—URLæˆ–æ–‡ä»¶åˆ—è¡¨ä½œä¸ºè¾“å…¥ï¼Œå¹¶è°ƒç”¨ç›¸åº”çš„æ¨¡å—è¿›è¡Œæ¼æ´æ‰«æã€‚å®ƒä½¿ç”¨äº†`argparse`åº“æ¥å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼Œå¹¶æ ¹æ®å‚æ•°è°ƒç”¨scan.cvescan(args.url,args.output) æˆ–è€… file.reader(args.list,args.output)è¿›è¡Œåç»­å¤„ç†ã€‚
è™½ç„¶file.readerä»£ç ä¸å®Œæ•´ï¼Œä½†æ˜¯ç»“åˆgithubä¸Šçš„å…¶ä»–ä¿¡æ¯å¯ä»¥æ¨æµ‹å‡ºå…¶åŸºæœ¬çš„åŠŸèƒ½æ˜¯å‘é€å«æœ‰../çš„è¯·æ±‚åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆæ­¥åˆ†æï¼ŒPoCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ï¼Œä½†å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºä½œè€…UMASANKAR-MGåœ¨`README.md`ä¸­åŠ å…¥å…è´£å£°æ˜ï¼Œå¯èƒ½æš—ç¤ºå­˜åœ¨æœªå…¬å¼€çš„æ¶æ„åŠŸèƒ½ã€‚`setup.py`ä½¿ç”¨ç®€å•çš„'Path Traversal = cve.main:main' å…¥å£ç‚¹, é™ä½äº†åˆ†æçš„éš¾åº¦.

*   **å¯ç–‘ç‚¹ï¼š** å…è´£å£°æ˜å’Œä½œè€…ä¿¡æ¯å¯èƒ½æ©ç›–çœŸå®ç›®çš„ã€‚
*   **é£é™©ç‚¹ï¼š**  `cve/includes/file.py` ä»£ç ä¸å®Œæ•´ï¼Œå¯èƒ½åŒ…å«æ¶æ„ä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ã€‚`scan.cvescan`å‡½æ•°ä¹Ÿéœ€è¦è¿›ä¸€æ­¥åˆ†æï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºã€‚

ç»¼åˆè¯„ä¼°ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†é£é™©ç¨‹åº¦ä¸é«˜ï¼Œå¤§çº¦ä¸º30%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆä¾‹å¦‚`../`ï¼‰çš„æ¶æ„URLã€‚
2.  æ”»å‡»è€…å‘é€è¯¥æ¶æ„URLåˆ°ç›®æ ‡Nexus Repository Manager 3æœåŠ¡å™¨ã€‚
3.  æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯URLï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿè¯»å–ä»»æ„æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…è·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ã€‚

**PoCä½¿ç”¨æ–¹å¼ï¼š**

ä»cve/main.pyå¯ä»¥çœ‹åˆ°ï¼Œä¸»è¦ç”±ä¸¤ç§æ–¹å¼ä½¿ç”¨è¿™ä¸ªPOCã€‚
1.  `-u/--url`ï¼šæŒ‡å®šç›®æ ‡URLï¼Œç”¨äºå¯¹å•ä¸ªç›®æ ‡è¿›è¡Œæ‰«æ
2.  `-l/--list`ï¼šæŒ‡å®šåŒ…å«ç›®æ ‡URLåˆ—è¡¨çš„æ–‡ä»¶ï¼Œç”¨äºæ‰¹é‡æ‰«æ
3.  `-o/--output`ï¼šæŒ‡å®šè¾“å‡ºæ–‡ä»¶åï¼Œå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­
4.  `-b/--blog`ï¼šæ‰“å¼€åŒ…å«å…³äºè¯¥æ¼æ´çš„æ›´å¤šä¿¡æ¯çš„åšå®¢é¡µé¢

ä¾‹å¦‚ï¼š
`python main.py -u http://example.com/ -o output.txt`

**æ€»ç»“ï¼š**

CVE-2024-4956æ˜¯ä¸€ä¸ªé«˜å±çš„è·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚PoCä»£ç çš„å­˜åœ¨è¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ï¼Œä½†éœ€è¦æ³¨æ„æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½¿ç”¨æ—¶åº”è°¨æ…ã€‚

**é¡¹ç›®åœ°å€:** [UMASANKAR-MG/Path-Traversal-CVE-2024-4956](https://github.com/UMASANKAR-MG/Path-Traversal-CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #9

**æ¥æº**: [CVE-2024-4956-XiaomingX_cve-2024-4956.md](../2024/CVE-2024-4956-XiaomingX_cve-2024-4956.md)

# CVE-2024-4956

> ğŸ“¦ è¯¥CVEæœ‰ **18** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4956-An00bRektn_shirocrack.md](../2024/CVE-2024-4956-An00bRektn_shirocrack.md)

## CVE-2024-4956-Sonatype Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´çš„åˆ©ç”¨ç›¸å¯¹ç®€å•ï¼Œåªéœ€å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚å³å¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `shirocrack` æœ¬èº«å¹¶ä¸æ˜¯ç›´æ¥åˆ©ç”¨è·¯å¾„éå†æ¼æ´çš„PoCï¼Œè€Œæ˜¯åˆ©ç”¨è·¯å¾„éå†è¯»å–åˆ°çš„ç”¨æˆ·å¯†ç å“ˆå¸Œè¿›è¡Œç ´è§£çš„å·¥å…·ã€‚è¯¥å·¥å…·æ˜¯ä¸ºäº†ç ´è§£ Apache Shiro æ¡†æ¶ä½¿ç”¨çš„å¯†ç å“ˆå¸Œã€‚æŠ•æ¯’é£é™©åˆ†æï¼šè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªå¯†ç ç ´è§£å·¥å…·ï¼Œå…¶æœ¬èº«åŠŸèƒ½æ¯”è¾ƒæ˜ç¡®ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`shirocrack.go` åªæ˜¯ä¸€ä¸ªä½¿ç”¨å­—å…¸è¿›è¡Œæš´åŠ›ç ´è§£çš„å·¥å…·ï¼Œä½†å­˜åœ¨ä½œè€…æ·»åŠ åé—¨çš„é£é™©ï¼Œè€ƒè™‘åˆ°è¯¥å·¥å…·çš„ç”¨é€”ï¼Œä»¥åŠä½œè€…å¯èƒ½å‡ºäºæŸäº›ç›®çš„æ¤å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©, ç™¾åˆ†æ¯”ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é¦–å…ˆåˆ©ç”¨ CVE-2024-4956 è·¯å¾„éå†æ¼æ´è¯»å– Nexus Repository Manager æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œæ¯”å¦‚åŒ…å«å¯†ç å“ˆå¸Œçš„ `.pcl` æ–‡ä»¶ã€‚ç„¶åï¼Œä½¿ç”¨æä¾›çš„ `shirocrack` å·¥å…·ç ´è§£è¿™äº›å¯†ç å“ˆå¸Œã€‚å¦‚æœç ´è§£æˆåŠŸï¼Œæ”»å‡»è€…å°±å¯ä»¥ä½¿ç”¨ç ´è§£çš„å¯†ç ç™»å½• Nexus Repository Managerï¼Œæˆ–è€…åˆ©ç”¨æ³„éœ²çš„å…¶ä»–ä¿¡æ¯è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [An00bRektn/shirocrack](https://github.com/An00bRektn/shirocrack)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #2

**æ¥æº**: [CVE-2024-4956-Buff3st-0v3rfl0w_CVE-2024-4956.md](../2024/CVE-2024-4956-Buff3st-0v3rfl0w_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository 3 ä¸­å­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äºæ‰€æœ‰ 3.x ç‰ˆæœ¬ç›´åˆ° 3.68.0ï¼ˆåŒ…å« 3.68.0ï¼‰ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚å®ƒé€šè¿‡æ„é€ ä¸€ä¸ªåŒ…å«å¤šä¸ª `..` åºåˆ—çš„ URLï¼Œå°è¯•è®¿é—®æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å›æ–‡ä»¶çš„å†…å®¹ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†æäº†æä¾›çš„ Python è„šæœ¬ï¼ˆCVE-2024-4956.pyï¼‰å’Œ README.md æ–‡ä»¶ã€‚

*   **CVE-2024-4956.py:** è¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP GET è¯·æ±‚åˆ°ç›®æ ‡ Nexus Repository æœåŠ¡å™¨ï¼Œè¯·æ±‚ä¸­åŒ…å«ç»è¿‡ç¼–ç çš„è·¯å¾„éå† payloadã€‚è„šæœ¬åŒ…å«åŸºæœ¬çš„é”™è¯¯å¤„ç†ï¼Œå¹¶åœ¨å“åº”ä¸­æ£€æŸ¥ "Not Found" å­—ç¬¦ä¸²ä»¥ç¡®å®šæ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚è„šæœ¬çš„åŠŸèƒ½ä¸å…¶æè¿°çš„åŠŸèƒ½ä¸€è‡´ï¼Œå³åˆ©ç”¨ CVE-2024-4956 è¿›è¡Œæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰ã€‚
*   **README.md:** è¯¥æ–‡ä»¶æä¾›äº†æœ‰å…³å¦‚ä½•ä½¿ç”¨è¯¥è„šæœ¬çš„åŸºæœ¬ä¿¡æ¯ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘å†…å®¹ã€‚

å°½ç®¡æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†ä»»ä½•ä»ä¸å—ä¿¡ä»»çš„æ¥æºè·å–çš„ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚æ­¤è„šæœ¬çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š
    *   **ä¾èµ–å…³ç³»é£é™©ï¼š** è„šæœ¬ä½¿ç”¨ `requests` åº“ã€‚è™½ç„¶ `requests` æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„åº“ï¼Œä½†æ”»å‡»è€…å¯èƒ½ä¼šå°è¯•é€šè¿‡æ¶æ„ç‰ˆæœ¬çš„ `requests` æˆ– `requests` çš„ä¾èµ–é¡¹è¿›è¡ŒæŠ•æ¯’ï¼Œå°½ç®¡è¿™ç§æƒ…å†µä¸å¤ªå¯èƒ½ã€‚
    *   **å¼€å‘è€…ç–å¿½ï¼š** å¼€å‘è€…å¯èƒ½ä¼šåœ¨æ— æ„ä¸­å¼•å…¥æ¼æ´æˆ–é”™è¯¯ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™äº›æ¼æ´æˆ–é”™è¯¯ã€‚
    *   **å…ƒæ•°æ®æ¬ºéª—ï¼š** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬çš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚ä½œè€…ä¿¡æ¯æˆ–æè¿°ï¼Œä»¥ä½¿å…¶çœ‹èµ·æ¥æ›´å¯ä¿¡ã€‚
    *   **æœ‰é™çš„å®¡æŸ¥ï¼š** ç”±äºæ²¡æœ‰å¯¹è¯¥è„šæœ¬è¿›è¡Œå¹¿æ³›çš„å®¡æŸ¥ï¼Œå› æ­¤æ— æ³•å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚

å»ºè®®åœ¨ä½¿ç”¨å‰å®¡æŸ¥è¯¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ `http://<nexus_ip>:<nexus_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`ã€‚
2.  Nexus Repository æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯ URL ä¸­çš„è·¯å¾„ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è®¿é—® `/etc/passwd` æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨å°† `/etc/passwd` æ–‡ä»¶çš„å†…å®¹è¿”å›ç»™æ”»å‡»è€…ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Buff3st-0v3rfl0w/CVE-2024-4956](https://github.com/Buff3st-0v3rfl0w/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #3

**æ¥æº**: [CVE-2024-4956-Cappricio-Securities_CVE-2024-4956.md](../2024/CVE-2024-4956-Cappricio-Securities_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 3.0.0 <= version <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒNexus Repository Manager 3ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®ç›®æ ‡ç³»ç»Ÿã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ 3.0.0 åˆ° 3.68.0 ä¹‹é—´çš„æ‰€æœ‰ Nexus Repository Manager 3.x ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç  (POC) æ˜¾ç¤ºï¼ŒCappricio-Securities å·²ç»å¼€å‘äº†ç›¸åº”çš„æ¼æ´åˆ©ç”¨å·¥å…·ï¼Œé€šè¿‡æ„é€ ç‰¹å®šçš„ URLï¼Œæ”»å‡»è€…å¯ä»¥ä¸‹è½½æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚è¯¥å·¥å…·æ”¯æŒå•ä¸ª URL æ‰«æã€æ‰¹é‡ URL æ‰«æï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚é›†æˆäº†Telegram APIï¼Œå¯ç”¨äºæ¥æ”¶æ¼æ´æ£€æµ‹çš„å³æ—¶é€šçŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å­˜åœ¨å…¬å¼€å¯ç”¨çš„POCã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç æ–‡ä»¶ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å®ç°æ¼æ´éªŒè¯å’Œåˆ©ç”¨ã€‚å…¶ä¸­ï¼ŒREADME.md æ–‡ä»¶ä¸­å¼•ç”¨äº†å¤–éƒ¨å›¾ç‰‡å’Œshields.io çš„å¾½ç« ï¼Œå­˜åœ¨ä¸€å®šçš„ä¾›åº”é“¾æŠ•æ¯’é£é™©ï¼Œä½†æ€»ä½“é£é™©è¾ƒä½ã€‚æ­¤å¤–ï¼ŒPOC å·¥å…·é›†æˆäº† Telegram API å‘é€é€šçŸ¥ï¼Œä½¿ç”¨è€…éœ€è¦æä¾›è‡ªå·±çš„ Telegram Chat IDï¼Œå¯èƒ½å­˜åœ¨éšç§æ³„éœ²é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©å¤§çº¦ä¸º 10%ï¼Œä¸»è¦æ¥è‡ªä¾›åº”é“¾ä¾èµ–å’Œä¸ªäººä¿¡æ¯æ³„éœ²ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ä½¿ç”¨ Cappricio-Securities æä¾›çš„ CVE-2024-4956 å·¥å…·ã€‚
2.  é€šè¿‡ pip å®‰è£…è¯¥å·¥å…·ï¼š`pip install CVE-2024-4956`ã€‚
3.  ä½¿ç”¨ `-u` å‚æ•°æŒ‡å®šå•ä¸ªç›®æ ‡ URLï¼Œæˆ–è€…ä½¿ç”¨ `-i` å‚æ•°æŒ‡å®šåŒ…å«å¤šä¸ªç›®æ ‡ URL çš„æ–‡æœ¬æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„æ¶æ„ URLï¼Œä¾‹å¦‚ï¼š`http://example.com/../../../etc/passwd`ï¼Œåˆ©ç”¨è¯¥ URL ä¸‹è½½ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd` æˆ–åº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ã€‚
5.  å¯ä»¥ä½¿ç”¨ `-o` å‚æ•°å°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­ã€‚
6.  å·¥å…·é›†æˆäº†Telegram APIï¼Œå¯ä»¥é€šè¿‡é…ç½®Chat IDï¼Œæ¥æ”¶æ¼æ´æ£€æµ‹çš„å³æ—¶é€šçŸ¥

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-4956](https://github.com/Cappricio-Securities/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #4

**æ¥æº**: [CVE-2024-4956-GoatSecurity_CVE-2024-4956.md](../2024/CVE-2024-4956-GoatSecurity_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Manager 3å®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«å¤šä¸ª "/%2F" å’Œ "../" çš„ URLï¼Œç»•è¿‡è·¯å¾„æ£€æŸ¥ï¼Œæœ€ç»ˆè®¿é—®åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/passwdã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå¯ä»¥éªŒè¯æ¼æ´çš„HTTPè¯·æ±‚å’Œä¸€ä¸ªå¯ä»¥æ‰¹é‡æ‰«æç›®æ ‡çš„pythonè„šæœ¬ã€‚è„šæœ¬ä»targets.txtè¯»å–ç›®æ ‡URLï¼Œå¹¶å¯¹æ¯ä¸ªURLå°è¯•åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–/etc/passwdæ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™å°†è¯¥URLæ·»åŠ åˆ°vulnerable_sitesåˆ—è¡¨ä¸­ï¼Œå¯ä»¥é€‰æ‹©ä¿å­˜åˆ°output.txtæ–‡ä»¶ä¸­ã€‚è™½ç„¶è„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚targets.txtä¸­å¯èƒ½åŒ…å«æŒ‡å‘æ¶æ„ç«™ç‚¹çš„é“¾æ¥ï¼Œæˆ–ä½œè€…æœªæ¥å¯èƒ½åœ¨githubä»“åº“ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚æ‰«æè„šæœ¬åˆ©ç”¨requestsåº“å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨å› ç›®æ ‡æœåŠ¡å™¨ç½‘ç»œæ³¢åŠ¨å¯¼è‡´è¯¯æŠ¥çš„æƒ…å†µã€‚

**é¡¹ç›®åœ°å€:** [GoatSecurity/CVE-2024-4956](https://github.com/GoatSecurity/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #5

**æ¥æº**: [CVE-2024-4956-JolyIrsb_CVE-2024-4956.md](../2024/CVE-2024-4956-JolyIrsb_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œéœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„ Python è„šæœ¬ `CVE-2024-4956-threads.py` æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´ã€‚ å®ƒé€šè¿‡æ„é€ åŒ…å«å¤šä¸ª `/%2F` å’Œ `../` åºåˆ—çš„ URL æ¥å°è¯•è¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„ `/etc/passwd` æ–‡ä»¶ã€‚å¦‚æœå“åº”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è„šæœ¬è®¤ä¸ºè¯¥ä¸»æœºå­˜åœ¨æ¼æ´ã€‚æä¾›çš„nucleiæ¨¡ç‰ˆå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
ä»£ç æœ¬èº«å®ç°çš„åŠŸèƒ½ä¸ºè¯»å–ç›®æ ‡æœºå™¨ä¸Šçš„æ–‡ä»¶ï¼Œä»ä»£ç åŠŸèƒ½ä¸Šåˆ¤æ–­ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ä»£ç çš„ä½œè€…å¯ä»¥åœ¨check_vulnerabilityå‡½æ•°ä¸­æ·»åŠ é¢å¤–çš„æ¶æ„ä»£ç ,ç”¨äºæ”¶é›†ç›®æ ‡ä¸»æœºçš„ä¿¡æ¯æˆ–è€…æ¤å…¥åé—¨ç¨‹åºï¼Œä½†ä»ç›®å‰çš„ä»£ç æ¥çœ‹ï¼Œæ²¡æœ‰å‘ç°ç›´æ¥çš„æŠ•æ¯’ä»£ç ã€‚README.md ä¸­çš„å£°æ˜ä¹Ÿæš—ç¤ºäº†é£é™©çš„å­˜åœ¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚å› ä¸ºä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œå¦‚æœå­˜åœ¨æ¶æ„ä»£ç å®¹æ˜“è¢«å‘ç°ã€‚ 

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚ `/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`ï¼‰çš„ URLã€‚
2.  Nexus Repository Manager 3 é”™è¯¯åœ°å¤„ç†è¯¥ URLï¼Œå…è®¸æ”»å‡»è€…è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç å’Œç³»ç»Ÿæ–‡ä»¶ã€‚
4.  ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬,å¯ä»¥æ‰¹é‡å¯¹ç›®æ ‡è¿›è¡Œæ‰«æ,è¯†åˆ«å­˜åœ¨æ¼æ´çš„ä¸»æœºã€‚
5.  æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„nucleiæ¨¡ç‰ˆï¼ŒåŒ…å«ä¸»åŠ¨æ‰«æå’Œè¢«åŠ¨æå–ç‰ˆæœ¬ï¼Œæ–¹ä¾¿æ¼æ´éªŒè¯

**é¡¹ç›®åœ°å€:** [JolyIrsb/CVE-2024-4956](https://github.com/JolyIrsb/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #6

**æ¥æº**: [CVE-2024-4956-Praison001_CVE-2024-4956-Sonatype-Nexus-Repository-Manager.md](../2024/CVE-2024-4956-Praison001_CVE-2024-4956-Sonatype-Nexus-Repository-Manager.md)

## CVE-2024-4956-Sonatype Nexus Repository Manager-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Managerå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆä¾‹å¦‚ `%2F` å’Œ `..`ï¼‰çš„ URLï¼Œè¯»å– Nexus Repository Manager æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„PoCä»£ç åŒ…å« Python å’Œ Bash ä¸¤ç§å®ç°ï¼Œéƒ½åˆ©ç”¨äº† URL ç¼–ç çš„è·¯å¾„éå†åºåˆ—æ¥è®¿é—®ç›®æ ‡æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªæˆæƒè®¿é—®ç³»ç»Ÿæ–‡ä»¶ï¼ŒPoC ä»£ç çš„ç›®çš„æ˜¯é€šè¿‡æ„é€ æ¶æ„ URL è¯»å–æœåŠ¡å™¨æ–‡ä»¶ã€‚PoCä»£ç ç»™å‡ºäº†Python3å’ŒBashä¸¤ç§åˆ©ç”¨æ–¹å¼ï¼Œå¹¶ä¸”æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒéªŒè¯äº†å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

PoC ä»£ç ï¼ˆ`exploitBash.sh` å’Œ `exploitPython.py`ï¼‰çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP GET è¯·æ±‚ä»¥åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å°è¯•æ‰§è¡Œæ¶æ„æ“ä½œï¼ˆä¾‹å¦‚ï¼Œå†™å…¥æ–‡ä»¶ã€æ‰§è¡Œå‘½ä»¤ï¼‰çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚è„šæœ¬çš„è¡Œä¸ºç¬¦åˆæ¼æ´æè¿°ï¼Œæ—¨åœ¨è¯»å–æŒ‡å®šæ–‡ä»¶å†…å®¹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡Nexus Repository Managerå®ä¾‹çš„URLå’Œç«¯å£ï¼š**  ä¾‹å¦‚`http://127.0.0.1:8081`ã€‚
2.  **æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„æ¶æ„URLï¼š**  PoCä»£ç ä¸­ä½¿ç”¨äº†`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..{targetFile}`ï¼Œå…¶ä¸­`{targetFile}`æ˜¯è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  **å‘é€HTTP GETè¯·æ±‚ï¼š**  ä½¿ç”¨PoCä»£ç æä¾›çš„Pythonè„šæœ¬æˆ–Bashè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLã€ç«¯å£å’Œè¦è¯»å–çš„æ–‡ä»¶ã€‚
4.  **åˆ†æå“åº”ï¼š**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚å¦‚æœåˆ©ç”¨å¤±è´¥ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šè¿”å›é”™è¯¯ä»£ç æˆ–æ¶ˆæ¯ã€‚

**é˜²èŒƒæªæ–½ï¼š**

*   å‡çº§åˆ° Sonatype Nexus Repository Manager 3.68.1 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å‚è€ƒ Sonatype å®˜æ–¹æ–‡æ¡£ï¼Œå®æ–½é€‚å½“çš„ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager](https://github.com/Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #7

**æ¥æº**: [CVE-2024-4956-TypicalModMaker_CVE-2024-4956.md](../2024/CVE-2024-4956-TypicalModMaker_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Sonatype Nexus Repository Manager 3ï¼Œä¸”å…è®¸æœªæˆæƒç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨ç²¾å¿ƒæ„é€ çš„URLæ¥ä¸‹è½½ä»»æ„æ–‡ä»¶ã€‚`README.md`æ–‡ä»¶ä¸­æè¿°äº†ç›¸å…³çš„åˆ©ç”¨è„šæœ¬ï¼ŒåŒ…æ‹¬æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å®¹æ˜“å—åˆ°æ”»å‡» (`check-vulnerable-servers.py`)ï¼Œæ£€æŸ¥æ˜¯å¦ä»¥ root ç”¨æˆ·èº«ä»½è¿è¡Œ (`check-root-servers.py`)ï¼Œä»¥åŠå°è¯•ä½¿ç”¨æ‰¾åˆ°çš„ç§é’¥é€šè¿‡ SSH ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½• (`check-private_keys.py`)ã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š** ä»“åº“ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„è„šæœ¬ä¸»è¦ç”¨äºæ£€æµ‹å’Œåˆ©ç”¨æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ã€‚ä½†å­˜åœ¨è½»å¾®é£é™©ï¼Œä½“ç°åœ¨`check-private_keys.py`ï¼Œå¯èƒ½å­˜åœ¨æ”¶é›†ç§é’¥ç”¨äºå…¶ä»–ç›®çš„ï¼Œæ‰€ä»¥åˆ¤å®šæŠ•æ¯’é£é™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ä½¿ç”¨ Shodan ç­‰æœç´¢å¼•æ“æŸ¥æ‰¾æš´éœ²åœ¨ç½‘ç»œä¸Šçš„ Sonatype Nexus Repository Manager 3 å®ä¾‹ã€‚
2.  ä½¿ç”¨ `check-vulnerable-servers.py` è„šæœ¬éªŒè¯ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨ CVE-2024-4956 æ¼æ´ï¼Œé€šè¿‡å°è¯•è¯»å– `/etc/passwd` æ–‡ä»¶æ¥éªŒè¯ã€‚
3.  ï¼ˆå¦‚æœç›®æ ‡ä»¥ root èº«ä»½è¿è¡Œï¼‰ä½¿ç”¨ `check-root-servers.py` è„šæœ¬éªŒè¯ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å¯ä»¥è¯»å– `/etc/shadow` æ–‡ä»¶ã€‚
4.  ï¼ˆå¦‚æœç›®æ ‡ä»¥ root èº«ä»½è¿è¡Œï¼‰ä½¿ç”¨ `check-private_keys.py` è„šæœ¬æŸ¥æ‰¾å¸¸è§çš„ç§é’¥è·¯å¾„ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°è¯•ä½¿ç”¨è¿™äº›ç§é’¥é€šè¿‡ SSH ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½•ã€‚

**é¡¹ç›®åœ°å€:** [TypicalModMaker/CVE-2024-4956](https://github.com/TypicalModMaker/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #8

**æ¥æº**: [CVE-2024-4956-UMASANKAR-MG_Path-Traversal-CVE-2024-4956.md](../2024/CVE-2024-4956-UMASANKAR-MG_Path-Traversal-CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 - è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Manager 3å®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 30%

## è¯¦æƒ…

æ ¹æ®CVE-2024-4956çš„æè¿°ï¼ŒSonatype Nexus Repository Manager 3å­˜åœ¨ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚è¯¥æ¼æ´å·²åœ¨3.68.1ç‰ˆæœ¬ä¸­ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ä»æä¾›çš„æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå½±å“ã€‚ç½‘é¡µ0ã€1ã€2ã€3ã€5ã€6ã€7å’Œ8å‡æåˆ°äº†CVE-2024-4956æ˜¯ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚ç½‘é¡µ9æä¾›äº†åŒ…å«PoCä»£ç çš„GitHubé“¾æ¥ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

æä¾›çš„PoCä»£ç åŒ…å«å‡ ä¸ªæ–‡ä»¶ï¼š
* `LICENSE`ï¼šMITè®¸å¯è¯ã€‚
* `cve/README.md`ï¼šæ¼æ´æè¿°ã€å…è´£å£°æ˜ã€PoCè§†é¢‘é“¾æ¥ã€å¸®åŠ©èœå•ã€ä½œè€…ä¿¡æ¯å’Œåé¦ˆæ–¹å¼ã€‚
* `cve/main.py`ï¼šä¸»ç¨‹åºå…¥å£ï¼ŒåŒ…å«å‘½ä»¤è¡Œå‚æ•°è§£æå’Œæ¼æ´åˆ©ç”¨é€»è¾‘ã€‚
* `cve/setup.py`ï¼šç”¨äºæ‰“åŒ…å’Œå®‰è£…PoCå·¥å…·çš„setupæ–‡ä»¶ã€‚
* `cve/includes/__init__.py`ï¼šä¸€ä¸ªç©ºçš„åˆå§‹åŒ–æ–‡ä»¶
* `cve/includes/file.py`ï¼šä¸€ä¸ªæ–‡ä»¶è¯»å–ç›¸å…³çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä»£ç ä¸å®Œæ•´

ä»`cve/main.py`çš„ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥è„šæœ¬æ¥å—URLæˆ–æ–‡ä»¶åˆ—è¡¨ä½œä¸ºè¾“å…¥ï¼Œå¹¶è°ƒç”¨ç›¸åº”çš„æ¨¡å—è¿›è¡Œæ¼æ´æ‰«æã€‚å®ƒä½¿ç”¨äº†`argparse`åº“æ¥å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼Œå¹¶æ ¹æ®å‚æ•°è°ƒç”¨scan.cvescan(args.url,args.output) æˆ–è€… file.reader(args.list,args.output)è¿›è¡Œåç»­å¤„ç†ã€‚
è™½ç„¶file.readerä»£ç ä¸å®Œæ•´ï¼Œä½†æ˜¯ç»“åˆgithubä¸Šçš„å…¶ä»–ä¿¡æ¯å¯ä»¥æ¨æµ‹å‡ºå…¶åŸºæœ¬çš„åŠŸèƒ½æ˜¯å‘é€å«æœ‰../çš„è¯·æ±‚åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆæ­¥åˆ†æï¼ŒPoCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ï¼Œä½†å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºä½œè€…UMASANKAR-MGåœ¨`README.md`ä¸­åŠ å…¥å…è´£å£°æ˜ï¼Œå¯èƒ½æš—ç¤ºå­˜åœ¨æœªå…¬å¼€çš„æ¶æ„åŠŸèƒ½ã€‚`setup.py`ä½¿ç”¨ç®€å•çš„'Path Traversal = cve.main:main' å…¥å£ç‚¹, é™ä½äº†åˆ†æçš„éš¾åº¦.

*   **å¯ç–‘ç‚¹ï¼š** å…è´£å£°æ˜å’Œä½œè€…ä¿¡æ¯å¯èƒ½æ©ç›–çœŸå®ç›®çš„ã€‚
*   **é£é™©ç‚¹ï¼š**  `cve/includes/file.py` ä»£ç ä¸å®Œæ•´ï¼Œå¯èƒ½åŒ…å«æ¶æ„ä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ã€‚`scan.cvescan`å‡½æ•°ä¹Ÿéœ€è¦è¿›ä¸€æ­¥åˆ†æï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºã€‚

ç»¼åˆè¯„ä¼°ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†é£é™©ç¨‹åº¦ä¸é«˜ï¼Œå¤§çº¦ä¸º30%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆä¾‹å¦‚`../`ï¼‰çš„æ¶æ„URLã€‚
2.  æ”»å‡»è€…å‘é€è¯¥æ¶æ„URLåˆ°ç›®æ ‡Nexus Repository Manager 3æœåŠ¡å™¨ã€‚
3.  æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯URLï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿè¯»å–ä»»æ„æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…è·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ã€‚

**PoCä½¿ç”¨æ–¹å¼ï¼š**

ä»cve/main.pyå¯ä»¥çœ‹åˆ°ï¼Œä¸»è¦ç”±ä¸¤ç§æ–¹å¼ä½¿ç”¨è¿™ä¸ªPOCã€‚
1.  `-u/--url`ï¼šæŒ‡å®šç›®æ ‡URLï¼Œç”¨äºå¯¹å•ä¸ªç›®æ ‡è¿›è¡Œæ‰«æ
2.  `-l/--list`ï¼šæŒ‡å®šåŒ…å«ç›®æ ‡URLåˆ—è¡¨çš„æ–‡ä»¶ï¼Œç”¨äºæ‰¹é‡æ‰«æ
3.  `-o/--output`ï¼šæŒ‡å®šè¾“å‡ºæ–‡ä»¶åï¼Œå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­
4.  `-b/--blog`ï¼šæ‰“å¼€åŒ…å«å…³äºè¯¥æ¼æ´çš„æ›´å¤šä¿¡æ¯çš„åšå®¢é¡µé¢

ä¾‹å¦‚ï¼š
`python main.py -u http://example.com/ -o output.txt`

**æ€»ç»“ï¼š**

CVE-2024-4956æ˜¯ä¸€ä¸ªé«˜å±çš„è·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚PoCä»£ç çš„å­˜åœ¨è¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ï¼Œä½†éœ€è¦æ³¨æ„æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½¿ç”¨æ—¶åº”è°¨æ…ã€‚

**é¡¹ç›®åœ°å€:** [UMASANKAR-MG/Path-Traversal-CVE-2024-4956](https://github.com/UMASANKAR-MG/Path-Traversal-CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #9

**æ¥æº**: [CVE-2024-4956-XiaomingX_cve-2024-4956.md](../2024/CVE-2024-4956-XiaomingX_cve-2024-4956.md)

# CVE-2024-4956

> ğŸ“¦ è¯¥CVEæœ‰ **18** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4956-An00bRektn_shirocrack.md](../2024/CVE-2024-4956-An00bRektn_shirocrack.md)

## CVE-2024-4956-Sonatype Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´çš„åˆ©ç”¨ç›¸å¯¹ç®€å•ï¼Œåªéœ€å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚å³å¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `shirocrack` æœ¬èº«å¹¶ä¸æ˜¯ç›´æ¥åˆ©ç”¨è·¯å¾„éå†æ¼æ´çš„PoCï¼Œè€Œæ˜¯åˆ©ç”¨è·¯å¾„éå†è¯»å–åˆ°çš„ç”¨æˆ·å¯†ç å“ˆå¸Œè¿›è¡Œç ´è§£çš„å·¥å…·ã€‚è¯¥å·¥å…·æ˜¯ä¸ºäº†ç ´è§£ Apache Shiro æ¡†æ¶ä½¿ç”¨çš„å¯†ç å“ˆå¸Œã€‚æŠ•æ¯’é£é™©åˆ†æï¼šè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªå¯†ç ç ´è§£å·¥å…·ï¼Œå…¶æœ¬èº«åŠŸèƒ½æ¯”è¾ƒæ˜ç¡®ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`shirocrack.go` åªæ˜¯ä¸€ä¸ªä½¿ç”¨å­—å…¸è¿›è¡Œæš´åŠ›ç ´è§£çš„å·¥å…·ï¼Œä½†å­˜åœ¨ä½œè€…æ·»åŠ åé—¨çš„é£é™©ï¼Œè€ƒè™‘åˆ°è¯¥å·¥å…·çš„ç”¨é€”ï¼Œä»¥åŠä½œè€…å¯èƒ½å‡ºäºæŸäº›ç›®çš„æ¤å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©, ç™¾åˆ†æ¯”ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é¦–å…ˆåˆ©ç”¨ CVE-2024-4956 è·¯å¾„éå†æ¼æ´è¯»å– Nexus Repository Manager æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œæ¯”å¦‚åŒ…å«å¯†ç å“ˆå¸Œçš„ `.pcl` æ–‡ä»¶ã€‚ç„¶åï¼Œä½¿ç”¨æä¾›çš„ `shirocrack` å·¥å…·ç ´è§£è¿™äº›å¯†ç å“ˆå¸Œã€‚å¦‚æœç ´è§£æˆåŠŸï¼Œæ”»å‡»è€…å°±å¯ä»¥ä½¿ç”¨ç ´è§£çš„å¯†ç ç™»å½• Nexus Repository Managerï¼Œæˆ–è€…åˆ©ç”¨æ³„éœ²çš„å…¶ä»–ä¿¡æ¯è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [An00bRektn/shirocrack](https://github.com/An00bRektn/shirocrack)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #2

**æ¥æº**: [CVE-2024-4956-Buff3st-0v3rfl0w_CVE-2024-4956.md](../2024/CVE-2024-4956-Buff3st-0v3rfl0w_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository 3 ä¸­å­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äºæ‰€æœ‰ 3.x ç‰ˆæœ¬ç›´åˆ° 3.68.0ï¼ˆåŒ…å« 3.68.0ï¼‰ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚å®ƒé€šè¿‡æ„é€ ä¸€ä¸ªåŒ…å«å¤šä¸ª `..` åºåˆ—çš„ URLï¼Œå°è¯•è®¿é—®æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å›æ–‡ä»¶çš„å†…å®¹ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†æäº†æä¾›çš„ Python è„šæœ¬ï¼ˆCVE-2024-4956.pyï¼‰å’Œ README.md æ–‡ä»¶ã€‚

*   **CVE-2024-4956.py:** è¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP GET è¯·æ±‚åˆ°ç›®æ ‡ Nexus Repository æœåŠ¡å™¨ï¼Œè¯·æ±‚ä¸­åŒ…å«ç»è¿‡ç¼–ç çš„è·¯å¾„éå† payloadã€‚è„šæœ¬åŒ…å«åŸºæœ¬çš„é”™è¯¯å¤„ç†ï¼Œå¹¶åœ¨å“åº”ä¸­æ£€æŸ¥ "Not Found" å­—ç¬¦ä¸²ä»¥ç¡®å®šæ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚è„šæœ¬çš„åŠŸèƒ½ä¸å…¶æè¿°çš„åŠŸèƒ½ä¸€è‡´ï¼Œå³åˆ©ç”¨ CVE-2024-4956 è¿›è¡Œæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰ã€‚
*   **README.md:** è¯¥æ–‡ä»¶æä¾›äº†æœ‰å…³å¦‚ä½•ä½¿ç”¨è¯¥è„šæœ¬çš„åŸºæœ¬ä¿¡æ¯ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘å†…å®¹ã€‚

å°½ç®¡æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†ä»»ä½•ä»ä¸å—ä¿¡ä»»çš„æ¥æºè·å–çš„ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚æ­¤è„šæœ¬çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š
    *   **ä¾èµ–å…³ç³»é£é™©ï¼š** è„šæœ¬ä½¿ç”¨ `requests` åº“ã€‚è™½ç„¶ `requests` æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„åº“ï¼Œä½†æ”»å‡»è€…å¯èƒ½ä¼šå°è¯•é€šè¿‡æ¶æ„ç‰ˆæœ¬çš„ `requests` æˆ– `requests` çš„ä¾èµ–é¡¹è¿›è¡ŒæŠ•æ¯’ï¼Œå°½ç®¡è¿™ç§æƒ…å†µä¸å¤ªå¯èƒ½ã€‚
    *   **å¼€å‘è€…ç–å¿½ï¼š** å¼€å‘è€…å¯èƒ½ä¼šåœ¨æ— æ„ä¸­å¼•å…¥æ¼æ´æˆ–é”™è¯¯ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™äº›æ¼æ´æˆ–é”™è¯¯ã€‚
    *   **å…ƒæ•°æ®æ¬ºéª—ï¼š** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬çš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚ä½œè€…ä¿¡æ¯æˆ–æè¿°ï¼Œä»¥ä½¿å…¶çœ‹èµ·æ¥æ›´å¯ä¿¡ã€‚
    *   **æœ‰é™çš„å®¡æŸ¥ï¼š** ç”±äºæ²¡æœ‰å¯¹è¯¥è„šæœ¬è¿›è¡Œå¹¿æ³›çš„å®¡æŸ¥ï¼Œå› æ­¤æ— æ³•å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚

å»ºè®®åœ¨ä½¿ç”¨å‰å®¡æŸ¥è¯¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ `http://<nexus_ip>:<nexus_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`ã€‚
2.  Nexus Repository æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯ URL ä¸­çš„è·¯å¾„ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è®¿é—® `/etc/passwd` æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨å°† `/etc/passwd` æ–‡ä»¶çš„å†…å®¹è¿”å›ç»™æ”»å‡»è€…ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Buff3st-0v3rfl0w/CVE-2024-4956](https://github.com/Buff3st-0v3rfl0w/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #3

**æ¥æº**: [CVE-2024-4956-Cappricio-Securities_CVE-2024-4956.md](../2024/CVE-2024-4956-Cappricio-Securities_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 3.0.0 <= version <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒNexus Repository Manager 3ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®ç›®æ ‡ç³»ç»Ÿã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ 3.0.0 åˆ° 3.68.0 ä¹‹é—´çš„æ‰€æœ‰ Nexus Repository Manager 3.x ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç  (POC) æ˜¾ç¤ºï¼ŒCappricio-Securities å·²ç»å¼€å‘äº†ç›¸åº”çš„æ¼æ´åˆ©ç”¨å·¥å…·ï¼Œé€šè¿‡æ„é€ ç‰¹å®šçš„ URLï¼Œæ”»å‡»è€…å¯ä»¥ä¸‹è½½æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚è¯¥å·¥å…·æ”¯æŒå•ä¸ª URL æ‰«æã€æ‰¹é‡ URL æ‰«æï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚é›†æˆäº†Telegram APIï¼Œå¯ç”¨äºæ¥æ”¶æ¼æ´æ£€æµ‹çš„å³æ—¶é€šçŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å­˜åœ¨å…¬å¼€å¯ç”¨çš„POCã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç æ–‡ä»¶ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å®ç°æ¼æ´éªŒè¯å’Œåˆ©ç”¨ã€‚å…¶ä¸­ï¼ŒREADME.md æ–‡ä»¶ä¸­å¼•ç”¨äº†å¤–éƒ¨å›¾ç‰‡å’Œshields.io çš„å¾½ç« ï¼Œå­˜åœ¨ä¸€å®šçš„ä¾›åº”é“¾æŠ•æ¯’é£é™©ï¼Œä½†æ€»ä½“é£é™©è¾ƒä½ã€‚æ­¤å¤–ï¼ŒPOC å·¥å…·é›†æˆäº† Telegram API å‘é€é€šçŸ¥ï¼Œä½¿ç”¨è€…éœ€è¦æä¾›è‡ªå·±çš„ Telegram Chat IDï¼Œå¯èƒ½å­˜åœ¨éšç§æ³„éœ²é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©å¤§çº¦ä¸º 10%ï¼Œä¸»è¦æ¥è‡ªä¾›åº”é“¾ä¾èµ–å’Œä¸ªäººä¿¡æ¯æ³„éœ²ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ä½¿ç”¨ Cappricio-Securities æä¾›çš„ CVE-2024-4956 å·¥å…·ã€‚
2.  é€šè¿‡ pip å®‰è£…è¯¥å·¥å…·ï¼š`pip install CVE-2024-4956`ã€‚
3.  ä½¿ç”¨ `-u` å‚æ•°æŒ‡å®šå•ä¸ªç›®æ ‡ URLï¼Œæˆ–è€…ä½¿ç”¨ `-i` å‚æ•°æŒ‡å®šåŒ…å«å¤šä¸ªç›®æ ‡ URL çš„æ–‡æœ¬æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„æ¶æ„ URLï¼Œä¾‹å¦‚ï¼š`http://example.com/../../../etc/passwd`ï¼Œåˆ©ç”¨è¯¥ URL ä¸‹è½½ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd` æˆ–åº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ã€‚
5.  å¯ä»¥ä½¿ç”¨ `-o` å‚æ•°å°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­ã€‚
6.  å·¥å…·é›†æˆäº†Telegram APIï¼Œå¯ä»¥é€šè¿‡é…ç½®Chat IDï¼Œæ¥æ”¶æ¼æ´æ£€æµ‹çš„å³æ—¶é€šçŸ¥

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-4956](https://github.com/Cappricio-Securities/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #4

**æ¥æº**: [CVE-2024-4956-GoatSecurity_CVE-2024-4956.md](../2024/CVE-2024-4956-GoatSecurity_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Manager 3å®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«å¤šä¸ª "/%2F" å’Œ "../" çš„ URLï¼Œç»•è¿‡è·¯å¾„æ£€æŸ¥ï¼Œæœ€ç»ˆè®¿é—®åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/passwdã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå¯ä»¥éªŒè¯æ¼æ´çš„HTTPè¯·æ±‚å’Œä¸€ä¸ªå¯ä»¥æ‰¹é‡æ‰«æç›®æ ‡çš„pythonè„šæœ¬ã€‚è„šæœ¬ä»targets.txtè¯»å–ç›®æ ‡URLï¼Œå¹¶å¯¹æ¯ä¸ªURLå°è¯•åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–/etc/passwdæ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™å°†è¯¥URLæ·»åŠ åˆ°vulnerable_sitesåˆ—è¡¨ä¸­ï¼Œå¯ä»¥é€‰æ‹©ä¿å­˜åˆ°output.txtæ–‡ä»¶ä¸­ã€‚è™½ç„¶è„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚targets.txtä¸­å¯èƒ½åŒ…å«æŒ‡å‘æ¶æ„ç«™ç‚¹çš„é“¾æ¥ï¼Œæˆ–ä½œè€…æœªæ¥å¯èƒ½åœ¨githubä»“åº“ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚æ‰«æè„šæœ¬åˆ©ç”¨requestsåº“å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨å› ç›®æ ‡æœåŠ¡å™¨ç½‘ç»œæ³¢åŠ¨å¯¼è‡´è¯¯æŠ¥çš„æƒ…å†µã€‚

**é¡¹ç›®åœ°å€:** [GoatSecurity/CVE-2024-4956](https://github.com/GoatSecurity/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #5

**æ¥æº**: [CVE-2024-4956-JolyIrsb_CVE-2024-4956.md](../2024/CVE-2024-4956-JolyIrsb_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œéœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„ Python è„šæœ¬ `CVE-2024-4956-threads.py` æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´ã€‚ å®ƒé€šè¿‡æ„é€ åŒ…å«å¤šä¸ª `/%2F` å’Œ `../` åºåˆ—çš„ URL æ¥å°è¯•è¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„ `/etc/passwd` æ–‡ä»¶ã€‚å¦‚æœå“åº”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è„šæœ¬è®¤ä¸ºè¯¥ä¸»æœºå­˜åœ¨æ¼æ´ã€‚æä¾›çš„nucleiæ¨¡ç‰ˆå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
ä»£ç æœ¬èº«å®ç°çš„åŠŸèƒ½ä¸ºè¯»å–ç›®æ ‡æœºå™¨ä¸Šçš„æ–‡ä»¶ï¼Œä»ä»£ç åŠŸèƒ½ä¸Šåˆ¤æ–­ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ä»£ç çš„ä½œè€…å¯ä»¥åœ¨check_vulnerabilityå‡½æ•°ä¸­æ·»åŠ é¢å¤–çš„æ¶æ„ä»£ç ,ç”¨äºæ”¶é›†ç›®æ ‡ä¸»æœºçš„ä¿¡æ¯æˆ–è€…æ¤å…¥åé—¨ç¨‹åºï¼Œä½†ä»ç›®å‰çš„ä»£ç æ¥çœ‹ï¼Œæ²¡æœ‰å‘ç°ç›´æ¥çš„æŠ•æ¯’ä»£ç ã€‚README.md ä¸­çš„å£°æ˜ä¹Ÿæš—ç¤ºäº†é£é™©çš„å­˜åœ¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚å› ä¸ºä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œå¦‚æœå­˜åœ¨æ¶æ„ä»£ç å®¹æ˜“è¢«å‘ç°ã€‚ 

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚ `/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`ï¼‰çš„ URLã€‚
2.  Nexus Repository Manager 3 é”™è¯¯åœ°å¤„ç†è¯¥ URLï¼Œå…è®¸æ”»å‡»è€…è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç å’Œç³»ç»Ÿæ–‡ä»¶ã€‚
4.  ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬,å¯ä»¥æ‰¹é‡å¯¹ç›®æ ‡è¿›è¡Œæ‰«æ,è¯†åˆ«å­˜åœ¨æ¼æ´çš„ä¸»æœºã€‚
5.  æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„nucleiæ¨¡ç‰ˆï¼ŒåŒ…å«ä¸»åŠ¨æ‰«æå’Œè¢«åŠ¨æå–ç‰ˆæœ¬ï¼Œæ–¹ä¾¿æ¼æ´éªŒè¯

**é¡¹ç›®åœ°å€:** [JolyIrsb/CVE-2024-4956](https://github.com/JolyIrsb/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #6

**æ¥æº**: [CVE-2024-4956-Praison001_CVE-2024-4956-Sonatype-Nexus-Repository-Manager.md](../2024/CVE-2024-4956-Praison001_CVE-2024-4956-Sonatype-Nexus-Repository-Manager.md)

## CVE-2024-4956-Sonatype Nexus Repository Manager-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Managerå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆä¾‹å¦‚ `%2F` å’Œ `..`ï¼‰çš„ URLï¼Œè¯»å– Nexus Repository Manager æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„PoCä»£ç åŒ…å« Python å’Œ Bash ä¸¤ç§å®ç°ï¼Œéƒ½åˆ©ç”¨äº† URL ç¼–ç çš„è·¯å¾„éå†åºåˆ—æ¥è®¿é—®ç›®æ ‡æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªæˆæƒè®¿é—®ç³»ç»Ÿæ–‡ä»¶ï¼ŒPoC ä»£ç çš„ç›®çš„æ˜¯é€šè¿‡æ„é€ æ¶æ„ URL è¯»å–æœåŠ¡å™¨æ–‡ä»¶ã€‚PoCä»£ç ç»™å‡ºäº†Python3å’ŒBashä¸¤ç§åˆ©ç”¨æ–¹å¼ï¼Œå¹¶ä¸”æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒéªŒè¯äº†å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

PoC ä»£ç ï¼ˆ`exploitBash.sh` å’Œ `exploitPython.py`ï¼‰çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP GET è¯·æ±‚ä»¥åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å°è¯•æ‰§è¡Œæ¶æ„æ“ä½œï¼ˆä¾‹å¦‚ï¼Œå†™å…¥æ–‡ä»¶ã€æ‰§è¡Œå‘½ä»¤ï¼‰çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚è„šæœ¬çš„è¡Œä¸ºç¬¦åˆæ¼æ´æè¿°ï¼Œæ—¨åœ¨è¯»å–æŒ‡å®šæ–‡ä»¶å†…å®¹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡Nexus Repository Managerå®ä¾‹çš„URLå’Œç«¯å£ï¼š**  ä¾‹å¦‚`http://127.0.0.1:8081`ã€‚
2.  **æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„æ¶æ„URLï¼š**  PoCä»£ç ä¸­ä½¿ç”¨äº†`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..{targetFile}`ï¼Œå…¶ä¸­`{targetFile}`æ˜¯è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  **å‘é€HTTP GETè¯·æ±‚ï¼š**  ä½¿ç”¨PoCä»£ç æä¾›çš„Pythonè„šæœ¬æˆ–Bashè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLã€ç«¯å£å’Œè¦è¯»å–çš„æ–‡ä»¶ã€‚
4.  **åˆ†æå“åº”ï¼š**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚å¦‚æœåˆ©ç”¨å¤±è´¥ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šè¿”å›é”™è¯¯ä»£ç æˆ–æ¶ˆæ¯ã€‚

**é˜²èŒƒæªæ–½ï¼š**

*   å‡çº§åˆ° Sonatype Nexus Repository Manager 3.68.1 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å‚è€ƒ Sonatype å®˜æ–¹æ–‡æ¡£ï¼Œå®æ–½é€‚å½“çš„ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager](https://github.com/Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #7

**æ¥æº**: [CVE-2024-4956-TypicalModMaker_CVE-2024-4956.md](../2024/CVE-2024-4956-TypicalModMaker_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Sonatype Nexus Repository Manager 3ï¼Œä¸”å…è®¸æœªæˆæƒç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨ç²¾å¿ƒæ„é€ çš„URLæ¥ä¸‹è½½ä»»æ„æ–‡ä»¶ã€‚`README.md`æ–‡ä»¶ä¸­æè¿°äº†ç›¸å…³çš„åˆ©ç”¨è„šæœ¬ï¼ŒåŒ…æ‹¬æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å®¹æ˜“å—åˆ°æ”»å‡» (`check-vulnerable-servers.py`)ï¼Œæ£€æŸ¥æ˜¯å¦ä»¥ root ç”¨æˆ·èº«ä»½è¿è¡Œ (`check-root-servers.py`)ï¼Œä»¥åŠå°è¯•ä½¿ç”¨æ‰¾åˆ°çš„ç§é’¥é€šè¿‡ SSH ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½• (`check-private_keys.py`)ã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š** ä»“åº“ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„è„šæœ¬ä¸»è¦ç”¨äºæ£€æµ‹å’Œåˆ©ç”¨æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ã€‚ä½†å­˜åœ¨è½»å¾®é£é™©ï¼Œä½“ç°åœ¨`check-private_keys.py`ï¼Œå¯èƒ½å­˜åœ¨æ”¶é›†ç§é’¥ç”¨äºå…¶ä»–ç›®çš„ï¼Œæ‰€ä»¥åˆ¤å®šæŠ•æ¯’é£é™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ä½¿ç”¨ Shodan ç­‰æœç´¢å¼•æ“æŸ¥æ‰¾æš´éœ²åœ¨ç½‘ç»œä¸Šçš„ Sonatype Nexus Repository Manager 3 å®ä¾‹ã€‚
2.  ä½¿ç”¨ `check-vulnerable-servers.py` è„šæœ¬éªŒè¯ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨ CVE-2024-4956 æ¼æ´ï¼Œé€šè¿‡å°è¯•è¯»å– `/etc/passwd` æ–‡ä»¶æ¥éªŒè¯ã€‚
3.  ï¼ˆå¦‚æœç›®æ ‡ä»¥ root èº«ä»½è¿è¡Œï¼‰ä½¿ç”¨ `check-root-servers.py` è„šæœ¬éªŒè¯ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å¯ä»¥è¯»å– `/etc/shadow` æ–‡ä»¶ã€‚
4.  ï¼ˆå¦‚æœç›®æ ‡ä»¥ root èº«ä»½è¿è¡Œï¼‰ä½¿ç”¨ `check-private_keys.py` è„šæœ¬æŸ¥æ‰¾å¸¸è§çš„ç§é’¥è·¯å¾„ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°è¯•ä½¿ç”¨è¿™äº›ç§é’¥é€šè¿‡ SSH ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½•ã€‚

**é¡¹ç›®åœ°å€:** [TypicalModMaker/CVE-2024-4956](https://github.com/TypicalModMaker/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #8

**æ¥æº**: [CVE-2024-4956-UMASANKAR-MG_Path-Traversal-CVE-2024-4956.md](../2024/CVE-2024-4956-UMASANKAR-MG_Path-Traversal-CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 - è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Manager 3å®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 30%

## è¯¦æƒ…

æ ¹æ®CVE-2024-4956çš„æè¿°ï¼ŒSonatype Nexus Repository Manager 3å­˜åœ¨ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚è¯¥æ¼æ´å·²åœ¨3.68.1ç‰ˆæœ¬ä¸­ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ä»æä¾›çš„æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå½±å“ã€‚ç½‘é¡µ0ã€1ã€2ã€3ã€5ã€6ã€7å’Œ8å‡æåˆ°äº†CVE-2024-4956æ˜¯ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚ç½‘é¡µ9æä¾›äº†åŒ…å«PoCä»£ç çš„GitHubé“¾æ¥ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

æä¾›çš„PoCä»£ç åŒ…å«å‡ ä¸ªæ–‡ä»¶ï¼š
* `LICENSE`ï¼šMITè®¸å¯è¯ã€‚
* `cve/README.md`ï¼šæ¼æ´æè¿°ã€å…è´£å£°æ˜ã€PoCè§†é¢‘é“¾æ¥ã€å¸®åŠ©èœå•ã€ä½œè€…ä¿¡æ¯å’Œåé¦ˆæ–¹å¼ã€‚
* `cve/main.py`ï¼šä¸»ç¨‹åºå…¥å£ï¼ŒåŒ…å«å‘½ä»¤è¡Œå‚æ•°è§£æå’Œæ¼æ´åˆ©ç”¨é€»è¾‘ã€‚
* `cve/setup.py`ï¼šç”¨äºæ‰“åŒ…å’Œå®‰è£…PoCå·¥å…·çš„setupæ–‡ä»¶ã€‚
* `cve/includes/__init__.py`ï¼šä¸€ä¸ªç©ºçš„åˆå§‹åŒ–æ–‡ä»¶
* `cve/includes/file.py`ï¼šä¸€ä¸ªæ–‡ä»¶è¯»å–ç›¸å…³çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä»£ç ä¸å®Œæ•´

ä»`cve/main.py`çš„ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥è„šæœ¬æ¥å—URLæˆ–æ–‡ä»¶åˆ—è¡¨ä½œä¸ºè¾“å…¥ï¼Œå¹¶è°ƒç”¨ç›¸åº”çš„æ¨¡å—è¿›è¡Œæ¼æ´æ‰«æã€‚å®ƒä½¿ç”¨äº†`argparse`åº“æ¥å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼Œå¹¶æ ¹æ®å‚æ•°è°ƒç”¨scan.cvescan(args.url,args.output) æˆ–è€… file.reader(args.list,args.output)è¿›è¡Œåç»­å¤„ç†ã€‚
è™½ç„¶file.readerä»£ç ä¸å®Œæ•´ï¼Œä½†æ˜¯ç»“åˆgithubä¸Šçš„å…¶ä»–ä¿¡æ¯å¯ä»¥æ¨æµ‹å‡ºå…¶åŸºæœ¬çš„åŠŸèƒ½æ˜¯å‘é€å«æœ‰../çš„è¯·æ±‚åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆæ­¥åˆ†æï¼ŒPoCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ï¼Œä½†å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºä½œè€…UMASANKAR-MGåœ¨`README.md`ä¸­åŠ å…¥å…è´£å£°æ˜ï¼Œå¯èƒ½æš—ç¤ºå­˜åœ¨æœªå…¬å¼€çš„æ¶æ„åŠŸèƒ½ã€‚`setup.py`ä½¿ç”¨ç®€å•çš„'Path Traversal = cve.main:main' å…¥å£ç‚¹, é™ä½äº†åˆ†æçš„éš¾åº¦.

*   **å¯ç–‘ç‚¹ï¼š** å…è´£å£°æ˜å’Œä½œè€…ä¿¡æ¯å¯èƒ½æ©ç›–çœŸå®ç›®çš„ã€‚
*   **é£é™©ç‚¹ï¼š**  `cve/includes/file.py` ä»£ç ä¸å®Œæ•´ï¼Œå¯èƒ½åŒ…å«æ¶æ„ä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ã€‚`scan.cvescan`å‡½æ•°ä¹Ÿéœ€è¦è¿›ä¸€æ­¥åˆ†æï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºã€‚

ç»¼åˆè¯„ä¼°ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†é£é™©ç¨‹åº¦ä¸é«˜ï¼Œå¤§çº¦ä¸º30%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆä¾‹å¦‚`../`ï¼‰çš„æ¶æ„URLã€‚
2.  æ”»å‡»è€…å‘é€è¯¥æ¶æ„URLåˆ°ç›®æ ‡Nexus Repository Manager 3æœåŠ¡å™¨ã€‚
3.  æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯URLï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿè¯»å–ä»»æ„æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…è·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ã€‚

**PoCä½¿ç”¨æ–¹å¼ï¼š**

ä»cve/main.pyå¯ä»¥çœ‹åˆ°ï¼Œä¸»è¦ç”±ä¸¤ç§æ–¹å¼ä½¿ç”¨è¿™ä¸ªPOCã€‚
1.  `-u/--url`ï¼šæŒ‡å®šç›®æ ‡URLï¼Œç”¨äºå¯¹å•ä¸ªç›®æ ‡è¿›è¡Œæ‰«æ
2.  `-l/--list`ï¼šæŒ‡å®šåŒ…å«ç›®æ ‡URLåˆ—è¡¨çš„æ–‡ä»¶ï¼Œç”¨äºæ‰¹é‡æ‰«æ
3.  `-o/--output`ï¼šæŒ‡å®šè¾“å‡ºæ–‡ä»¶åï¼Œå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­
4.  `-b/--blog`ï¼šæ‰“å¼€åŒ…å«å…³äºè¯¥æ¼æ´çš„æ›´å¤šä¿¡æ¯çš„åšå®¢é¡µé¢

ä¾‹å¦‚ï¼š
`python main.py -u http://example.com/ -o output.txt`

**æ€»ç»“ï¼š**

CVE-2024-4956æ˜¯ä¸€ä¸ªé«˜å±çš„è·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚PoCä»£ç çš„å­˜åœ¨è¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ï¼Œä½†éœ€è¦æ³¨æ„æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½¿ç”¨æ—¶åº”è°¨æ…ã€‚

**é¡¹ç›®åœ°å€:** [UMASANKAR-MG/Path-Traversal-CVE-2024-4956](https://github.com/UMASANKAR-MG/Path-Traversal-CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #9

**æ¥æº**: [CVE-2024-4956-XiaomingX_cve-2024-4956.md](../2024/CVE-2024-4956-XiaomingX_cve-2024-4956.md)

# CVE-2024-4956

> ğŸ“¦ è¯¥CVEæœ‰ **18** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4956-An00bRektn_shirocrack.md](../2024/CVE-2024-4956-An00bRektn_shirocrack.md)

## CVE-2024-4956-Sonatype Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´çš„åˆ©ç”¨ç›¸å¯¹ç®€å•ï¼Œåªéœ€å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚å³å¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `shirocrack` æœ¬èº«å¹¶ä¸æ˜¯ç›´æ¥åˆ©ç”¨è·¯å¾„éå†æ¼æ´çš„PoCï¼Œè€Œæ˜¯åˆ©ç”¨è·¯å¾„éå†è¯»å–åˆ°çš„ç”¨æˆ·å¯†ç å“ˆå¸Œè¿›è¡Œç ´è§£çš„å·¥å…·ã€‚è¯¥å·¥å…·æ˜¯ä¸ºäº†ç ´è§£ Apache Shiro æ¡†æ¶ä½¿ç”¨çš„å¯†ç å“ˆå¸Œã€‚æŠ•æ¯’é£é™©åˆ†æï¼šè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªå¯†ç ç ´è§£å·¥å…·ï¼Œå…¶æœ¬èº«åŠŸèƒ½æ¯”è¾ƒæ˜ç¡®ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`shirocrack.go` åªæ˜¯ä¸€ä¸ªä½¿ç”¨å­—å…¸è¿›è¡Œæš´åŠ›ç ´è§£çš„å·¥å…·ï¼Œä½†å­˜åœ¨ä½œè€…æ·»åŠ åé—¨çš„é£é™©ï¼Œè€ƒè™‘åˆ°è¯¥å·¥å…·çš„ç”¨é€”ï¼Œä»¥åŠä½œè€…å¯èƒ½å‡ºäºæŸäº›ç›®çš„æ¤å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©, ç™¾åˆ†æ¯”ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é¦–å…ˆåˆ©ç”¨ CVE-2024-4956 è·¯å¾„éå†æ¼æ´è¯»å– Nexus Repository Manager æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œæ¯”å¦‚åŒ…å«å¯†ç å“ˆå¸Œçš„ `.pcl` æ–‡ä»¶ã€‚ç„¶åï¼Œä½¿ç”¨æä¾›çš„ `shirocrack` å·¥å…·ç ´è§£è¿™äº›å¯†ç å“ˆå¸Œã€‚å¦‚æœç ´è§£æˆåŠŸï¼Œæ”»å‡»è€…å°±å¯ä»¥ä½¿ç”¨ç ´è§£çš„å¯†ç ç™»å½• Nexus Repository Managerï¼Œæˆ–è€…åˆ©ç”¨æ³„éœ²çš„å…¶ä»–ä¿¡æ¯è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [An00bRektn/shirocrack](https://github.com/An00bRektn/shirocrack)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #2

**æ¥æº**: [CVE-2024-4956-Buff3st-0v3rfl0w_CVE-2024-4956.md](../2024/CVE-2024-4956-Buff3st-0v3rfl0w_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository 3 ä¸­å­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äºæ‰€æœ‰ 3.x ç‰ˆæœ¬ç›´åˆ° 3.68.0ï¼ˆåŒ…å« 3.68.0ï¼‰ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚å®ƒé€šè¿‡æ„é€ ä¸€ä¸ªåŒ…å«å¤šä¸ª `..` åºåˆ—çš„ URLï¼Œå°è¯•è®¿é—®æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å›æ–‡ä»¶çš„å†…å®¹ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†æäº†æä¾›çš„ Python è„šæœ¬ï¼ˆCVE-2024-4956.pyï¼‰å’Œ README.md æ–‡ä»¶ã€‚

*   **CVE-2024-4956.py:** è¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP GET è¯·æ±‚åˆ°ç›®æ ‡ Nexus Repository æœåŠ¡å™¨ï¼Œè¯·æ±‚ä¸­åŒ…å«ç»è¿‡ç¼–ç çš„è·¯å¾„éå† payloadã€‚è„šæœ¬åŒ…å«åŸºæœ¬çš„é”™è¯¯å¤„ç†ï¼Œå¹¶åœ¨å“åº”ä¸­æ£€æŸ¥ "Not Found" å­—ç¬¦ä¸²ä»¥ç¡®å®šæ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚è„šæœ¬çš„åŠŸèƒ½ä¸å…¶æè¿°çš„åŠŸèƒ½ä¸€è‡´ï¼Œå³åˆ©ç”¨ CVE-2024-4956 è¿›è¡Œæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰ã€‚
*   **README.md:** è¯¥æ–‡ä»¶æä¾›äº†æœ‰å…³å¦‚ä½•ä½¿ç”¨è¯¥è„šæœ¬çš„åŸºæœ¬ä¿¡æ¯ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘å†…å®¹ã€‚

å°½ç®¡æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†ä»»ä½•ä»ä¸å—ä¿¡ä»»çš„æ¥æºè·å–çš„ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚æ­¤è„šæœ¬çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š
    *   **ä¾èµ–å…³ç³»é£é™©ï¼š** è„šæœ¬ä½¿ç”¨ `requests` åº“ã€‚è™½ç„¶ `requests` æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„åº“ï¼Œä½†æ”»å‡»è€…å¯èƒ½ä¼šå°è¯•é€šè¿‡æ¶æ„ç‰ˆæœ¬çš„ `requests` æˆ– `requests` çš„ä¾èµ–é¡¹è¿›è¡ŒæŠ•æ¯’ï¼Œå°½ç®¡è¿™ç§æƒ…å†µä¸å¤ªå¯èƒ½ã€‚
    *   **å¼€å‘è€…ç–å¿½ï¼š** å¼€å‘è€…å¯èƒ½ä¼šåœ¨æ— æ„ä¸­å¼•å…¥æ¼æ´æˆ–é”™è¯¯ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™äº›æ¼æ´æˆ–é”™è¯¯ã€‚
    *   **å…ƒæ•°æ®æ¬ºéª—ï¼š** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬çš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚ä½œè€…ä¿¡æ¯æˆ–æè¿°ï¼Œä»¥ä½¿å…¶çœ‹èµ·æ¥æ›´å¯ä¿¡ã€‚
    *   **æœ‰é™çš„å®¡æŸ¥ï¼š** ç”±äºæ²¡æœ‰å¯¹è¯¥è„šæœ¬è¿›è¡Œå¹¿æ³›çš„å®¡æŸ¥ï¼Œå› æ­¤æ— æ³•å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚

å»ºè®®åœ¨ä½¿ç”¨å‰å®¡æŸ¥è¯¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ `http://<nexus_ip>:<nexus_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`ã€‚
2.  Nexus Repository æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯ URL ä¸­çš„è·¯å¾„ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è®¿é—® `/etc/passwd` æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨å°† `/etc/passwd` æ–‡ä»¶çš„å†…å®¹è¿”å›ç»™æ”»å‡»è€…ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Buff3st-0v3rfl0w/CVE-2024-4956](https://github.com/Buff3st-0v3rfl0w/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #3

**æ¥æº**: [CVE-2024-4956-Cappricio-Securities_CVE-2024-4956.md](../2024/CVE-2024-4956-Cappricio-Securities_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 3.0.0 <= version <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒNexus Repository Manager 3ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®ç›®æ ‡ç³»ç»Ÿã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ 3.0.0 åˆ° 3.68.0 ä¹‹é—´çš„æ‰€æœ‰ Nexus Repository Manager 3.x ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç  (POC) æ˜¾ç¤ºï¼ŒCappricio-Securities å·²ç»å¼€å‘äº†ç›¸åº”çš„æ¼æ´åˆ©ç”¨å·¥å…·ï¼Œé€šè¿‡æ„é€ ç‰¹å®šçš„ URLï¼Œæ”»å‡»è€…å¯ä»¥ä¸‹è½½æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚è¯¥å·¥å…·æ”¯æŒå•ä¸ª URL æ‰«æã€æ‰¹é‡ URL æ‰«æï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚é›†æˆäº†Telegram APIï¼Œå¯ç”¨äºæ¥æ”¶æ¼æ´æ£€æµ‹çš„å³æ—¶é€šçŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å­˜åœ¨å…¬å¼€å¯ç”¨çš„POCã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç æ–‡ä»¶ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å®ç°æ¼æ´éªŒè¯å’Œåˆ©ç”¨ã€‚å…¶ä¸­ï¼ŒREADME.md æ–‡ä»¶ä¸­å¼•ç”¨äº†å¤–éƒ¨å›¾ç‰‡å’Œshields.io çš„å¾½ç« ï¼Œå­˜åœ¨ä¸€å®šçš„ä¾›åº”é“¾æŠ•æ¯’é£é™©ï¼Œä½†æ€»ä½“é£é™©è¾ƒä½ã€‚æ­¤å¤–ï¼ŒPOC å·¥å…·é›†æˆäº† Telegram API å‘é€é€šçŸ¥ï¼Œä½¿ç”¨è€…éœ€è¦æä¾›è‡ªå·±çš„ Telegram Chat IDï¼Œå¯èƒ½å­˜åœ¨éšç§æ³„éœ²é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©å¤§çº¦ä¸º 10%ï¼Œä¸»è¦æ¥è‡ªä¾›åº”é“¾ä¾èµ–å’Œä¸ªäººä¿¡æ¯æ³„éœ²ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ä½¿ç”¨ Cappricio-Securities æä¾›çš„ CVE-2024-4956 å·¥å…·ã€‚
2.  é€šè¿‡ pip å®‰è£…è¯¥å·¥å…·ï¼š`pip install CVE-2024-4956`ã€‚
3.  ä½¿ç”¨ `-u` å‚æ•°æŒ‡å®šå•ä¸ªç›®æ ‡ URLï¼Œæˆ–è€…ä½¿ç”¨ `-i` å‚æ•°æŒ‡å®šåŒ…å«å¤šä¸ªç›®æ ‡ URL çš„æ–‡æœ¬æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„æ¶æ„ URLï¼Œä¾‹å¦‚ï¼š`http://example.com/../../../etc/passwd`ï¼Œåˆ©ç”¨è¯¥ URL ä¸‹è½½ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd` æˆ–åº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ã€‚
5.  å¯ä»¥ä½¿ç”¨ `-o` å‚æ•°å°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­ã€‚
6.  å·¥å…·é›†æˆäº†Telegram APIï¼Œå¯ä»¥é€šè¿‡é…ç½®Chat IDï¼Œæ¥æ”¶æ¼æ´æ£€æµ‹çš„å³æ—¶é€šçŸ¥

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-4956](https://github.com/Cappricio-Securities/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #4

**æ¥æº**: [CVE-2024-4956-GoatSecurity_CVE-2024-4956.md](../2024/CVE-2024-4956-GoatSecurity_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Manager 3å®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«å¤šä¸ª "/%2F" å’Œ "../" çš„ URLï¼Œç»•è¿‡è·¯å¾„æ£€æŸ¥ï¼Œæœ€ç»ˆè®¿é—®åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/passwdã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå¯ä»¥éªŒè¯æ¼æ´çš„HTTPè¯·æ±‚å’Œä¸€ä¸ªå¯ä»¥æ‰¹é‡æ‰«æç›®æ ‡çš„pythonè„šæœ¬ã€‚è„šæœ¬ä»targets.txtè¯»å–ç›®æ ‡URLï¼Œå¹¶å¯¹æ¯ä¸ªURLå°è¯•åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–/etc/passwdæ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™å°†è¯¥URLæ·»åŠ åˆ°vulnerable_sitesåˆ—è¡¨ä¸­ï¼Œå¯ä»¥é€‰æ‹©ä¿å­˜åˆ°output.txtæ–‡ä»¶ä¸­ã€‚è™½ç„¶è„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚targets.txtä¸­å¯èƒ½åŒ…å«æŒ‡å‘æ¶æ„ç«™ç‚¹çš„é“¾æ¥ï¼Œæˆ–ä½œè€…æœªæ¥å¯èƒ½åœ¨githubä»“åº“ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚æ‰«æè„šæœ¬åˆ©ç”¨requestsåº“å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨å› ç›®æ ‡æœåŠ¡å™¨ç½‘ç»œæ³¢åŠ¨å¯¼è‡´è¯¯æŠ¥çš„æƒ…å†µã€‚

**é¡¹ç›®åœ°å€:** [GoatSecurity/CVE-2024-4956](https://github.com/GoatSecurity/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #5

**æ¥æº**: [CVE-2024-4956-JolyIrsb_CVE-2024-4956.md](../2024/CVE-2024-4956-JolyIrsb_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œéœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„ Python è„šæœ¬ `CVE-2024-4956-threads.py` æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´ã€‚ å®ƒé€šè¿‡æ„é€ åŒ…å«å¤šä¸ª `/%2F` å’Œ `../` åºåˆ—çš„ URL æ¥å°è¯•è¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„ `/etc/passwd` æ–‡ä»¶ã€‚å¦‚æœå“åº”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è„šæœ¬è®¤ä¸ºè¯¥ä¸»æœºå­˜åœ¨æ¼æ´ã€‚æä¾›çš„nucleiæ¨¡ç‰ˆå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
ä»£ç æœ¬èº«å®ç°çš„åŠŸèƒ½ä¸ºè¯»å–ç›®æ ‡æœºå™¨ä¸Šçš„æ–‡ä»¶ï¼Œä»ä»£ç åŠŸèƒ½ä¸Šåˆ¤æ–­ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ä»£ç çš„ä½œè€…å¯ä»¥åœ¨check_vulnerabilityå‡½æ•°ä¸­æ·»åŠ é¢å¤–çš„æ¶æ„ä»£ç ,ç”¨äºæ”¶é›†ç›®æ ‡ä¸»æœºçš„ä¿¡æ¯æˆ–è€…æ¤å…¥åé—¨ç¨‹åºï¼Œä½†ä»ç›®å‰çš„ä»£ç æ¥çœ‹ï¼Œæ²¡æœ‰å‘ç°ç›´æ¥çš„æŠ•æ¯’ä»£ç ã€‚README.md ä¸­çš„å£°æ˜ä¹Ÿæš—ç¤ºäº†é£é™©çš„å­˜åœ¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚å› ä¸ºä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œå¦‚æœå­˜åœ¨æ¶æ„ä»£ç å®¹æ˜“è¢«å‘ç°ã€‚ 

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚ `/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`ï¼‰çš„ URLã€‚
2.  Nexus Repository Manager 3 é”™è¯¯åœ°å¤„ç†è¯¥ URLï¼Œå…è®¸æ”»å‡»è€…è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç å’Œç³»ç»Ÿæ–‡ä»¶ã€‚
4.  ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬,å¯ä»¥æ‰¹é‡å¯¹ç›®æ ‡è¿›è¡Œæ‰«æ,è¯†åˆ«å­˜åœ¨æ¼æ´çš„ä¸»æœºã€‚
5.  æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„nucleiæ¨¡ç‰ˆï¼ŒåŒ…å«ä¸»åŠ¨æ‰«æå’Œè¢«åŠ¨æå–ç‰ˆæœ¬ï¼Œæ–¹ä¾¿æ¼æ´éªŒè¯

**é¡¹ç›®åœ°å€:** [JolyIrsb/CVE-2024-4956](https://github.com/JolyIrsb/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #6

**æ¥æº**: [CVE-2024-4956-Praison001_CVE-2024-4956-Sonatype-Nexus-Repository-Manager.md](../2024/CVE-2024-4956-Praison001_CVE-2024-4956-Sonatype-Nexus-Repository-Manager.md)

## CVE-2024-4956-Sonatype Nexus Repository Manager-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Managerå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆä¾‹å¦‚ `%2F` å’Œ `..`ï¼‰çš„ URLï¼Œè¯»å– Nexus Repository Manager æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„PoCä»£ç åŒ…å« Python å’Œ Bash ä¸¤ç§å®ç°ï¼Œéƒ½åˆ©ç”¨äº† URL ç¼–ç çš„è·¯å¾„éå†åºåˆ—æ¥è®¿é—®ç›®æ ‡æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªæˆæƒè®¿é—®ç³»ç»Ÿæ–‡ä»¶ï¼ŒPoC ä»£ç çš„ç›®çš„æ˜¯é€šè¿‡æ„é€ æ¶æ„ URL è¯»å–æœåŠ¡å™¨æ–‡ä»¶ã€‚PoCä»£ç ç»™å‡ºäº†Python3å’ŒBashä¸¤ç§åˆ©ç”¨æ–¹å¼ï¼Œå¹¶ä¸”æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒéªŒè¯äº†å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

PoC ä»£ç ï¼ˆ`exploitBash.sh` å’Œ `exploitPython.py`ï¼‰çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP GET è¯·æ±‚ä»¥åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å°è¯•æ‰§è¡Œæ¶æ„æ“ä½œï¼ˆä¾‹å¦‚ï¼Œå†™å…¥æ–‡ä»¶ã€æ‰§è¡Œå‘½ä»¤ï¼‰çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚è„šæœ¬çš„è¡Œä¸ºç¬¦åˆæ¼æ´æè¿°ï¼Œæ—¨åœ¨è¯»å–æŒ‡å®šæ–‡ä»¶å†…å®¹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡Nexus Repository Managerå®ä¾‹çš„URLå’Œç«¯å£ï¼š**  ä¾‹å¦‚`http://127.0.0.1:8081`ã€‚
2.  **æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„æ¶æ„URLï¼š**  PoCä»£ç ä¸­ä½¿ç”¨äº†`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..{targetFile}`ï¼Œå…¶ä¸­`{targetFile}`æ˜¯è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  **å‘é€HTTP GETè¯·æ±‚ï¼š**  ä½¿ç”¨PoCä»£ç æä¾›çš„Pythonè„šæœ¬æˆ–Bashè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLã€ç«¯å£å’Œè¦è¯»å–çš„æ–‡ä»¶ã€‚
4.  **åˆ†æå“åº”ï¼š**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚å¦‚æœåˆ©ç”¨å¤±è´¥ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šè¿”å›é”™è¯¯ä»£ç æˆ–æ¶ˆæ¯ã€‚

**é˜²èŒƒæªæ–½ï¼š**

*   å‡çº§åˆ° Sonatype Nexus Repository Manager 3.68.1 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å‚è€ƒ Sonatype å®˜æ–¹æ–‡æ¡£ï¼Œå®æ–½é€‚å½“çš„ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager](https://github.com/Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #7

**æ¥æº**: [CVE-2024-4956-TypicalModMaker_CVE-2024-4956.md](../2024/CVE-2024-4956-TypicalModMaker_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Sonatype Nexus Repository Manager 3ï¼Œä¸”å…è®¸æœªæˆæƒç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨ç²¾å¿ƒæ„é€ çš„URLæ¥ä¸‹è½½ä»»æ„æ–‡ä»¶ã€‚`README.md`æ–‡ä»¶ä¸­æè¿°äº†ç›¸å…³çš„åˆ©ç”¨è„šæœ¬ï¼ŒåŒ…æ‹¬æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å®¹æ˜“å—åˆ°æ”»å‡» (`check-vulnerable-servers.py`)ï¼Œæ£€æŸ¥æ˜¯å¦ä»¥ root ç”¨æˆ·èº«ä»½è¿è¡Œ (`check-root-servers.py`)ï¼Œä»¥åŠå°è¯•ä½¿ç”¨æ‰¾åˆ°çš„ç§é’¥é€šè¿‡ SSH ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½• (`check-private_keys.py`)ã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š** ä»“åº“ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„è„šæœ¬ä¸»è¦ç”¨äºæ£€æµ‹å’Œåˆ©ç”¨æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ã€‚ä½†å­˜åœ¨è½»å¾®é£é™©ï¼Œä½“ç°åœ¨`check-private_keys.py`ï¼Œå¯èƒ½å­˜åœ¨æ”¶é›†ç§é’¥ç”¨äºå…¶ä»–ç›®çš„ï¼Œæ‰€ä»¥åˆ¤å®šæŠ•æ¯’é£é™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ä½¿ç”¨ Shodan ç­‰æœç´¢å¼•æ“æŸ¥æ‰¾æš´éœ²åœ¨ç½‘ç»œä¸Šçš„ Sonatype Nexus Repository Manager 3 å®ä¾‹ã€‚
2.  ä½¿ç”¨ `check-vulnerable-servers.py` è„šæœ¬éªŒè¯ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨ CVE-2024-4956 æ¼æ´ï¼Œé€šè¿‡å°è¯•è¯»å– `/etc/passwd` æ–‡ä»¶æ¥éªŒè¯ã€‚
3.  ï¼ˆå¦‚æœç›®æ ‡ä»¥ root èº«ä»½è¿è¡Œï¼‰ä½¿ç”¨ `check-root-servers.py` è„šæœ¬éªŒè¯ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å¯ä»¥è¯»å– `/etc/shadow` æ–‡ä»¶ã€‚
4.  ï¼ˆå¦‚æœç›®æ ‡ä»¥ root èº«ä»½è¿è¡Œï¼‰ä½¿ç”¨ `check-private_keys.py` è„šæœ¬æŸ¥æ‰¾å¸¸è§çš„ç§é’¥è·¯å¾„ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°è¯•ä½¿ç”¨è¿™äº›ç§é’¥é€šè¿‡ SSH ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½•ã€‚

**é¡¹ç›®åœ°å€:** [TypicalModMaker/CVE-2024-4956](https://github.com/TypicalModMaker/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #8

**æ¥æº**: [CVE-2024-4956-UMASANKAR-MG_Path-Traversal-CVE-2024-4956.md](../2024/CVE-2024-4956-UMASANKAR-MG_Path-Traversal-CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 - è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Manager 3å®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 30%

## è¯¦æƒ…

æ ¹æ®CVE-2024-4956çš„æè¿°ï¼ŒSonatype Nexus Repository Manager 3å­˜åœ¨ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚è¯¥æ¼æ´å·²åœ¨3.68.1ç‰ˆæœ¬ä¸­ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ä»æä¾›çš„æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå½±å“ã€‚ç½‘é¡µ0ã€1ã€2ã€3ã€5ã€6ã€7å’Œ8å‡æåˆ°äº†CVE-2024-4956æ˜¯ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚ç½‘é¡µ9æä¾›äº†åŒ…å«PoCä»£ç çš„GitHubé“¾æ¥ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

æä¾›çš„PoCä»£ç åŒ…å«å‡ ä¸ªæ–‡ä»¶ï¼š
* `LICENSE`ï¼šMITè®¸å¯è¯ã€‚
* `cve/README.md`ï¼šæ¼æ´æè¿°ã€å…è´£å£°æ˜ã€PoCè§†é¢‘é“¾æ¥ã€å¸®åŠ©èœå•ã€ä½œè€…ä¿¡æ¯å’Œåé¦ˆæ–¹å¼ã€‚
* `cve/main.py`ï¼šä¸»ç¨‹åºå…¥å£ï¼ŒåŒ…å«å‘½ä»¤è¡Œå‚æ•°è§£æå’Œæ¼æ´åˆ©ç”¨é€»è¾‘ã€‚
* `cve/setup.py`ï¼šç”¨äºæ‰“åŒ…å’Œå®‰è£…PoCå·¥å…·çš„setupæ–‡ä»¶ã€‚
* `cve/includes/__init__.py`ï¼šä¸€ä¸ªç©ºçš„åˆå§‹åŒ–æ–‡ä»¶
* `cve/includes/file.py`ï¼šä¸€ä¸ªæ–‡ä»¶è¯»å–ç›¸å…³çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä»£ç ä¸å®Œæ•´

ä»`cve/main.py`çš„ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥è„šæœ¬æ¥å—URLæˆ–æ–‡ä»¶åˆ—è¡¨ä½œä¸ºè¾“å…¥ï¼Œå¹¶è°ƒç”¨ç›¸åº”çš„æ¨¡å—è¿›è¡Œæ¼æ´æ‰«æã€‚å®ƒä½¿ç”¨äº†`argparse`åº“æ¥å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼Œå¹¶æ ¹æ®å‚æ•°è°ƒç”¨scan.cvescan(args.url,args.output) æˆ–è€… file.reader(args.list,args.output)è¿›è¡Œåç»­å¤„ç†ã€‚
è™½ç„¶file.readerä»£ç ä¸å®Œæ•´ï¼Œä½†æ˜¯ç»“åˆgithubä¸Šçš„å…¶ä»–ä¿¡æ¯å¯ä»¥æ¨æµ‹å‡ºå…¶åŸºæœ¬çš„åŠŸèƒ½æ˜¯å‘é€å«æœ‰../çš„è¯·æ±‚åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆæ­¥åˆ†æï¼ŒPoCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ï¼Œä½†å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºä½œè€…UMASANKAR-MGåœ¨`README.md`ä¸­åŠ å…¥å…è´£å£°æ˜ï¼Œå¯èƒ½æš—ç¤ºå­˜åœ¨æœªå…¬å¼€çš„æ¶æ„åŠŸèƒ½ã€‚`setup.py`ä½¿ç”¨ç®€å•çš„'Path Traversal = cve.main:main' å…¥å£ç‚¹, é™ä½äº†åˆ†æçš„éš¾åº¦.

*   **å¯ç–‘ç‚¹ï¼š** å…è´£å£°æ˜å’Œä½œè€…ä¿¡æ¯å¯èƒ½æ©ç›–çœŸå®ç›®çš„ã€‚
*   **é£é™©ç‚¹ï¼š**  `cve/includes/file.py` ä»£ç ä¸å®Œæ•´ï¼Œå¯èƒ½åŒ…å«æ¶æ„ä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ã€‚`scan.cvescan`å‡½æ•°ä¹Ÿéœ€è¦è¿›ä¸€æ­¥åˆ†æï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºã€‚

ç»¼åˆè¯„ä¼°ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†é£é™©ç¨‹åº¦ä¸é«˜ï¼Œå¤§çº¦ä¸º30%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆä¾‹å¦‚`../`ï¼‰çš„æ¶æ„URLã€‚
2.  æ”»å‡»è€…å‘é€è¯¥æ¶æ„URLåˆ°ç›®æ ‡Nexus Repository Manager 3æœåŠ¡å™¨ã€‚
3.  æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯URLï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿè¯»å–ä»»æ„æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…è·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ã€‚

**PoCä½¿ç”¨æ–¹å¼ï¼š**

ä»cve/main.pyå¯ä»¥çœ‹åˆ°ï¼Œä¸»è¦ç”±ä¸¤ç§æ–¹å¼ä½¿ç”¨è¿™ä¸ªPOCã€‚
1.  `-u/--url`ï¼šæŒ‡å®šç›®æ ‡URLï¼Œç”¨äºå¯¹å•ä¸ªç›®æ ‡è¿›è¡Œæ‰«æ
2.  `-l/--list`ï¼šæŒ‡å®šåŒ…å«ç›®æ ‡URLåˆ—è¡¨çš„æ–‡ä»¶ï¼Œç”¨äºæ‰¹é‡æ‰«æ
3.  `-o/--output`ï¼šæŒ‡å®šè¾“å‡ºæ–‡ä»¶åï¼Œå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­
4.  `-b/--blog`ï¼šæ‰“å¼€åŒ…å«å…³äºè¯¥æ¼æ´çš„æ›´å¤šä¿¡æ¯çš„åšå®¢é¡µé¢

ä¾‹å¦‚ï¼š
`python main.py -u http://example.com/ -o output.txt`

**æ€»ç»“ï¼š**

CVE-2024-4956æ˜¯ä¸€ä¸ªé«˜å±çš„è·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚PoCä»£ç çš„å­˜åœ¨è¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ï¼Œä½†éœ€è¦æ³¨æ„æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½¿ç”¨æ—¶åº”è°¨æ…ã€‚

**é¡¹ç›®åœ°å€:** [UMASANKAR-MG/Path-Traversal-CVE-2024-4956](https://github.com/UMASANKAR-MG/Path-Traversal-CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #9

**æ¥æº**: [CVE-2024-4956-XiaomingX_cve-2024-4956.md](../2024/CVE-2024-4956-XiaomingX_cve-2024-4956.md)

# CVE-2024-4956

> ğŸ“¦ è¯¥CVEæœ‰ **18** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4956-An00bRektn_shirocrack.md](../2024/CVE-2024-4956-An00bRektn_shirocrack.md)

## CVE-2024-4956-Sonatype Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´çš„åˆ©ç”¨ç›¸å¯¹ç®€å•ï¼Œåªéœ€å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚å³å¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `shirocrack` æœ¬èº«å¹¶ä¸æ˜¯ç›´æ¥åˆ©ç”¨è·¯å¾„éå†æ¼æ´çš„PoCï¼Œè€Œæ˜¯åˆ©ç”¨è·¯å¾„éå†è¯»å–åˆ°çš„ç”¨æˆ·å¯†ç å“ˆå¸Œè¿›è¡Œç ´è§£çš„å·¥å…·ã€‚è¯¥å·¥å…·æ˜¯ä¸ºäº†ç ´è§£ Apache Shiro æ¡†æ¶ä½¿ç”¨çš„å¯†ç å“ˆå¸Œã€‚æŠ•æ¯’é£é™©åˆ†æï¼šè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªå¯†ç ç ´è§£å·¥å…·ï¼Œå…¶æœ¬èº«åŠŸèƒ½æ¯”è¾ƒæ˜ç¡®ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`shirocrack.go` åªæ˜¯ä¸€ä¸ªä½¿ç”¨å­—å…¸è¿›è¡Œæš´åŠ›ç ´è§£çš„å·¥å…·ï¼Œä½†å­˜åœ¨ä½œè€…æ·»åŠ åé—¨çš„é£é™©ï¼Œè€ƒè™‘åˆ°è¯¥å·¥å…·çš„ç”¨é€”ï¼Œä»¥åŠä½œè€…å¯èƒ½å‡ºäºæŸäº›ç›®çš„æ¤å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©, ç™¾åˆ†æ¯”ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é¦–å…ˆåˆ©ç”¨ CVE-2024-4956 è·¯å¾„éå†æ¼æ´è¯»å– Nexus Repository Manager æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œæ¯”å¦‚åŒ…å«å¯†ç å“ˆå¸Œçš„ `.pcl` æ–‡ä»¶ã€‚ç„¶åï¼Œä½¿ç”¨æä¾›çš„ `shirocrack` å·¥å…·ç ´è§£è¿™äº›å¯†ç å“ˆå¸Œã€‚å¦‚æœç ´è§£æˆåŠŸï¼Œæ”»å‡»è€…å°±å¯ä»¥ä½¿ç”¨ç ´è§£çš„å¯†ç ç™»å½• Nexus Repository Managerï¼Œæˆ–è€…åˆ©ç”¨æ³„éœ²çš„å…¶ä»–ä¿¡æ¯è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [An00bRektn/shirocrack](https://github.com/An00bRektn/shirocrack)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #2

**æ¥æº**: [CVE-2024-4956-Buff3st-0v3rfl0w_CVE-2024-4956.md](../2024/CVE-2024-4956-Buff3st-0v3rfl0w_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository 3 ä¸­å­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äºæ‰€æœ‰ 3.x ç‰ˆæœ¬ç›´åˆ° 3.68.0ï¼ˆåŒ…å« 3.68.0ï¼‰ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚å®ƒé€šè¿‡æ„é€ ä¸€ä¸ªåŒ…å«å¤šä¸ª `..` åºåˆ—çš„ URLï¼Œå°è¯•è®¿é—®æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å›æ–‡ä»¶çš„å†…å®¹ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†æäº†æä¾›çš„ Python è„šæœ¬ï¼ˆCVE-2024-4956.pyï¼‰å’Œ README.md æ–‡ä»¶ã€‚

*   **CVE-2024-4956.py:** è¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP GET è¯·æ±‚åˆ°ç›®æ ‡ Nexus Repository æœåŠ¡å™¨ï¼Œè¯·æ±‚ä¸­åŒ…å«ç»è¿‡ç¼–ç çš„è·¯å¾„éå† payloadã€‚è„šæœ¬åŒ…å«åŸºæœ¬çš„é”™è¯¯å¤„ç†ï¼Œå¹¶åœ¨å“åº”ä¸­æ£€æŸ¥ "Not Found" å­—ç¬¦ä¸²ä»¥ç¡®å®šæ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚è„šæœ¬çš„åŠŸèƒ½ä¸å…¶æè¿°çš„åŠŸèƒ½ä¸€è‡´ï¼Œå³åˆ©ç”¨ CVE-2024-4956 è¿›è¡Œæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰ã€‚
*   **README.md:** è¯¥æ–‡ä»¶æä¾›äº†æœ‰å…³å¦‚ä½•ä½¿ç”¨è¯¥è„šæœ¬çš„åŸºæœ¬ä¿¡æ¯ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘å†…å®¹ã€‚

å°½ç®¡æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†ä»»ä½•ä»ä¸å—ä¿¡ä»»çš„æ¥æºè·å–çš„ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚æ­¤è„šæœ¬çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š
    *   **ä¾èµ–å…³ç³»é£é™©ï¼š** è„šæœ¬ä½¿ç”¨ `requests` åº“ã€‚è™½ç„¶ `requests` æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„åº“ï¼Œä½†æ”»å‡»è€…å¯èƒ½ä¼šå°è¯•é€šè¿‡æ¶æ„ç‰ˆæœ¬çš„ `requests` æˆ– `requests` çš„ä¾èµ–é¡¹è¿›è¡ŒæŠ•æ¯’ï¼Œå°½ç®¡è¿™ç§æƒ…å†µä¸å¤ªå¯èƒ½ã€‚
    *   **å¼€å‘è€…ç–å¿½ï¼š** å¼€å‘è€…å¯èƒ½ä¼šåœ¨æ— æ„ä¸­å¼•å…¥æ¼æ´æˆ–é”™è¯¯ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™äº›æ¼æ´æˆ–é”™è¯¯ã€‚
    *   **å…ƒæ•°æ®æ¬ºéª—ï¼š** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬çš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚ä½œè€…ä¿¡æ¯æˆ–æè¿°ï¼Œä»¥ä½¿å…¶çœ‹èµ·æ¥æ›´å¯ä¿¡ã€‚
    *   **æœ‰é™çš„å®¡æŸ¥ï¼š** ç”±äºæ²¡æœ‰å¯¹è¯¥è„šæœ¬è¿›è¡Œå¹¿æ³›çš„å®¡æŸ¥ï¼Œå› æ­¤æ— æ³•å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚

å»ºè®®åœ¨ä½¿ç”¨å‰å®¡æŸ¥è¯¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ `http://<nexus_ip>:<nexus_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`ã€‚
2.  Nexus Repository æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯ URL ä¸­çš„è·¯å¾„ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è®¿é—® `/etc/passwd` æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨å°† `/etc/passwd` æ–‡ä»¶çš„å†…å®¹è¿”å›ç»™æ”»å‡»è€…ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Buff3st-0v3rfl0w/CVE-2024-4956](https://github.com/Buff3st-0v3rfl0w/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #3

**æ¥æº**: [CVE-2024-4956-Cappricio-Securities_CVE-2024-4956.md](../2024/CVE-2024-4956-Cappricio-Securities_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 3.0.0 <= version <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒNexus Repository Manager 3ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®ç›®æ ‡ç³»ç»Ÿã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ 3.0.0 åˆ° 3.68.0 ä¹‹é—´çš„æ‰€æœ‰ Nexus Repository Manager 3.x ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç  (POC) æ˜¾ç¤ºï¼ŒCappricio-Securities å·²ç»å¼€å‘äº†ç›¸åº”çš„æ¼æ´åˆ©ç”¨å·¥å…·ï¼Œé€šè¿‡æ„é€ ç‰¹å®šçš„ URLï¼Œæ”»å‡»è€…å¯ä»¥ä¸‹è½½æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚è¯¥å·¥å…·æ”¯æŒå•ä¸ª URL æ‰«æã€æ‰¹é‡ URL æ‰«æï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚é›†æˆäº†Telegram APIï¼Œå¯ç”¨äºæ¥æ”¶æ¼æ´æ£€æµ‹çš„å³æ—¶é€šçŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å­˜åœ¨å…¬å¼€å¯ç”¨çš„POCã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç æ–‡ä»¶ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å®ç°æ¼æ´éªŒè¯å’Œåˆ©ç”¨ã€‚å…¶ä¸­ï¼ŒREADME.md æ–‡ä»¶ä¸­å¼•ç”¨äº†å¤–éƒ¨å›¾ç‰‡å’Œshields.io çš„å¾½ç« ï¼Œå­˜åœ¨ä¸€å®šçš„ä¾›åº”é“¾æŠ•æ¯’é£é™©ï¼Œä½†æ€»ä½“é£é™©è¾ƒä½ã€‚æ­¤å¤–ï¼ŒPOC å·¥å…·é›†æˆäº† Telegram API å‘é€é€šçŸ¥ï¼Œä½¿ç”¨è€…éœ€è¦æä¾›è‡ªå·±çš„ Telegram Chat IDï¼Œå¯èƒ½å­˜åœ¨éšç§æ³„éœ²é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©å¤§çº¦ä¸º 10%ï¼Œä¸»è¦æ¥è‡ªä¾›åº”é“¾ä¾èµ–å’Œä¸ªäººä¿¡æ¯æ³„éœ²ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ä½¿ç”¨ Cappricio-Securities æä¾›çš„ CVE-2024-4956 å·¥å…·ã€‚
2.  é€šè¿‡ pip å®‰è£…è¯¥å·¥å…·ï¼š`pip install CVE-2024-4956`ã€‚
3.  ä½¿ç”¨ `-u` å‚æ•°æŒ‡å®šå•ä¸ªç›®æ ‡ URLï¼Œæˆ–è€…ä½¿ç”¨ `-i` å‚æ•°æŒ‡å®šåŒ…å«å¤šä¸ªç›®æ ‡ URL çš„æ–‡æœ¬æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„æ¶æ„ URLï¼Œä¾‹å¦‚ï¼š`http://example.com/../../../etc/passwd`ï¼Œåˆ©ç”¨è¯¥ URL ä¸‹è½½ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd` æˆ–åº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ã€‚
5.  å¯ä»¥ä½¿ç”¨ `-o` å‚æ•°å°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­ã€‚
6.  å·¥å…·é›†æˆäº†Telegram APIï¼Œå¯ä»¥é€šè¿‡é…ç½®Chat IDï¼Œæ¥æ”¶æ¼æ´æ£€æµ‹çš„å³æ—¶é€šçŸ¥

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-4956](https://github.com/Cappricio-Securities/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #4

**æ¥æº**: [CVE-2024-4956-GoatSecurity_CVE-2024-4956.md](../2024/CVE-2024-4956-GoatSecurity_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Manager 3å®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«å¤šä¸ª "/%2F" å’Œ "../" çš„ URLï¼Œç»•è¿‡è·¯å¾„æ£€æŸ¥ï¼Œæœ€ç»ˆè®¿é—®åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/passwdã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå¯ä»¥éªŒè¯æ¼æ´çš„HTTPè¯·æ±‚å’Œä¸€ä¸ªå¯ä»¥æ‰¹é‡æ‰«æç›®æ ‡çš„pythonè„šæœ¬ã€‚è„šæœ¬ä»targets.txtè¯»å–ç›®æ ‡URLï¼Œå¹¶å¯¹æ¯ä¸ªURLå°è¯•åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–/etc/passwdæ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™å°†è¯¥URLæ·»åŠ åˆ°vulnerable_sitesåˆ—è¡¨ä¸­ï¼Œå¯ä»¥é€‰æ‹©ä¿å­˜åˆ°output.txtæ–‡ä»¶ä¸­ã€‚è™½ç„¶è„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚targets.txtä¸­å¯èƒ½åŒ…å«æŒ‡å‘æ¶æ„ç«™ç‚¹çš„é“¾æ¥ï¼Œæˆ–ä½œè€…æœªæ¥å¯èƒ½åœ¨githubä»“åº“ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚æ‰«æè„šæœ¬åˆ©ç”¨requestsåº“å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨å› ç›®æ ‡æœåŠ¡å™¨ç½‘ç»œæ³¢åŠ¨å¯¼è‡´è¯¯æŠ¥çš„æƒ…å†µã€‚

**é¡¹ç›®åœ°å€:** [GoatSecurity/CVE-2024-4956](https://github.com/GoatSecurity/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #5

**æ¥æº**: [CVE-2024-4956-JolyIrsb_CVE-2024-4956.md](../2024/CVE-2024-4956-JolyIrsb_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œéœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„ Python è„šæœ¬ `CVE-2024-4956-threads.py` æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´ã€‚ å®ƒé€šè¿‡æ„é€ åŒ…å«å¤šä¸ª `/%2F` å’Œ `../` åºåˆ—çš„ URL æ¥å°è¯•è¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„ `/etc/passwd` æ–‡ä»¶ã€‚å¦‚æœå“åº”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è„šæœ¬è®¤ä¸ºè¯¥ä¸»æœºå­˜åœ¨æ¼æ´ã€‚æä¾›çš„nucleiæ¨¡ç‰ˆå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
ä»£ç æœ¬èº«å®ç°çš„åŠŸèƒ½ä¸ºè¯»å–ç›®æ ‡æœºå™¨ä¸Šçš„æ–‡ä»¶ï¼Œä»ä»£ç åŠŸèƒ½ä¸Šåˆ¤æ–­ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ä»£ç çš„ä½œè€…å¯ä»¥åœ¨check_vulnerabilityå‡½æ•°ä¸­æ·»åŠ é¢å¤–çš„æ¶æ„ä»£ç ,ç”¨äºæ”¶é›†ç›®æ ‡ä¸»æœºçš„ä¿¡æ¯æˆ–è€…æ¤å…¥åé—¨ç¨‹åºï¼Œä½†ä»ç›®å‰çš„ä»£ç æ¥çœ‹ï¼Œæ²¡æœ‰å‘ç°ç›´æ¥çš„æŠ•æ¯’ä»£ç ã€‚README.md ä¸­çš„å£°æ˜ä¹Ÿæš—ç¤ºäº†é£é™©çš„å­˜åœ¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚å› ä¸ºä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œå¦‚æœå­˜åœ¨æ¶æ„ä»£ç å®¹æ˜“è¢«å‘ç°ã€‚ 

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚ `/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`ï¼‰çš„ URLã€‚
2.  Nexus Repository Manager 3 é”™è¯¯åœ°å¤„ç†è¯¥ URLï¼Œå…è®¸æ”»å‡»è€…è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç å’Œç³»ç»Ÿæ–‡ä»¶ã€‚
4.  ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬,å¯ä»¥æ‰¹é‡å¯¹ç›®æ ‡è¿›è¡Œæ‰«æ,è¯†åˆ«å­˜åœ¨æ¼æ´çš„ä¸»æœºã€‚
5.  æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„nucleiæ¨¡ç‰ˆï¼ŒåŒ…å«ä¸»åŠ¨æ‰«æå’Œè¢«åŠ¨æå–ç‰ˆæœ¬ï¼Œæ–¹ä¾¿æ¼æ´éªŒè¯

**é¡¹ç›®åœ°å€:** [JolyIrsb/CVE-2024-4956](https://github.com/JolyIrsb/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #6

**æ¥æº**: [CVE-2024-4956-Praison001_CVE-2024-4956-Sonatype-Nexus-Repository-Manager.md](../2024/CVE-2024-4956-Praison001_CVE-2024-4956-Sonatype-Nexus-Repository-Manager.md)

## CVE-2024-4956-Sonatype Nexus Repository Manager-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Managerå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆä¾‹å¦‚ `%2F` å’Œ `..`ï¼‰çš„ URLï¼Œè¯»å– Nexus Repository Manager æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„PoCä»£ç åŒ…å« Python å’Œ Bash ä¸¤ç§å®ç°ï¼Œéƒ½åˆ©ç”¨äº† URL ç¼–ç çš„è·¯å¾„éå†åºåˆ—æ¥è®¿é—®ç›®æ ‡æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªæˆæƒè®¿é—®ç³»ç»Ÿæ–‡ä»¶ï¼ŒPoC ä»£ç çš„ç›®çš„æ˜¯é€šè¿‡æ„é€ æ¶æ„ URL è¯»å–æœåŠ¡å™¨æ–‡ä»¶ã€‚PoCä»£ç ç»™å‡ºäº†Python3å’ŒBashä¸¤ç§åˆ©ç”¨æ–¹å¼ï¼Œå¹¶ä¸”æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒéªŒè¯äº†å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

PoC ä»£ç ï¼ˆ`exploitBash.sh` å’Œ `exploitPython.py`ï¼‰çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP GET è¯·æ±‚ä»¥åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å°è¯•æ‰§è¡Œæ¶æ„æ“ä½œï¼ˆä¾‹å¦‚ï¼Œå†™å…¥æ–‡ä»¶ã€æ‰§è¡Œå‘½ä»¤ï¼‰çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚è„šæœ¬çš„è¡Œä¸ºç¬¦åˆæ¼æ´æè¿°ï¼Œæ—¨åœ¨è¯»å–æŒ‡å®šæ–‡ä»¶å†…å®¹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡Nexus Repository Managerå®ä¾‹çš„URLå’Œç«¯å£ï¼š**  ä¾‹å¦‚`http://127.0.0.1:8081`ã€‚
2.  **æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„æ¶æ„URLï¼š**  PoCä»£ç ä¸­ä½¿ç”¨äº†`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..{targetFile}`ï¼Œå…¶ä¸­`{targetFile}`æ˜¯è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  **å‘é€HTTP GETè¯·æ±‚ï¼š**  ä½¿ç”¨PoCä»£ç æä¾›çš„Pythonè„šæœ¬æˆ–Bashè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLã€ç«¯å£å’Œè¦è¯»å–çš„æ–‡ä»¶ã€‚
4.  **åˆ†æå“åº”ï¼š**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚å¦‚æœåˆ©ç”¨å¤±è´¥ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šè¿”å›é”™è¯¯ä»£ç æˆ–æ¶ˆæ¯ã€‚

**é˜²èŒƒæªæ–½ï¼š**

*   å‡çº§åˆ° Sonatype Nexus Repository Manager 3.68.1 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å‚è€ƒ Sonatype å®˜æ–¹æ–‡æ¡£ï¼Œå®æ–½é€‚å½“çš„ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager](https://github.com/Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #7

**æ¥æº**: [CVE-2024-4956-TypicalModMaker_CVE-2024-4956.md](../2024/CVE-2024-4956-TypicalModMaker_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Sonatype Nexus Repository Manager 3ï¼Œä¸”å…è®¸æœªæˆæƒç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨ç²¾å¿ƒæ„é€ çš„URLæ¥ä¸‹è½½ä»»æ„æ–‡ä»¶ã€‚`README.md`æ–‡ä»¶ä¸­æè¿°äº†ç›¸å…³çš„åˆ©ç”¨è„šæœ¬ï¼ŒåŒ…æ‹¬æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å®¹æ˜“å—åˆ°æ”»å‡» (`check-vulnerable-servers.py`)ï¼Œæ£€æŸ¥æ˜¯å¦ä»¥ root ç”¨æˆ·èº«ä»½è¿è¡Œ (`check-root-servers.py`)ï¼Œä»¥åŠå°è¯•ä½¿ç”¨æ‰¾åˆ°çš„ç§é’¥é€šè¿‡ SSH ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½• (`check-private_keys.py`)ã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š** ä»“åº“ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„è„šæœ¬ä¸»è¦ç”¨äºæ£€æµ‹å’Œåˆ©ç”¨æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ã€‚ä½†å­˜åœ¨è½»å¾®é£é™©ï¼Œä½“ç°åœ¨`check-private_keys.py`ï¼Œå¯èƒ½å­˜åœ¨æ”¶é›†ç§é’¥ç”¨äºå…¶ä»–ç›®çš„ï¼Œæ‰€ä»¥åˆ¤å®šæŠ•æ¯’é£é™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ä½¿ç”¨ Shodan ç­‰æœç´¢å¼•æ“æŸ¥æ‰¾æš´éœ²åœ¨ç½‘ç»œä¸Šçš„ Sonatype Nexus Repository Manager 3 å®ä¾‹ã€‚
2.  ä½¿ç”¨ `check-vulnerable-servers.py` è„šæœ¬éªŒè¯ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨ CVE-2024-4956 æ¼æ´ï¼Œé€šè¿‡å°è¯•è¯»å– `/etc/passwd` æ–‡ä»¶æ¥éªŒè¯ã€‚
3.  ï¼ˆå¦‚æœç›®æ ‡ä»¥ root èº«ä»½è¿è¡Œï¼‰ä½¿ç”¨ `check-root-servers.py` è„šæœ¬éªŒè¯ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å¯ä»¥è¯»å– `/etc/shadow` æ–‡ä»¶ã€‚
4.  ï¼ˆå¦‚æœç›®æ ‡ä»¥ root èº«ä»½è¿è¡Œï¼‰ä½¿ç”¨ `check-private_keys.py` è„šæœ¬æŸ¥æ‰¾å¸¸è§çš„ç§é’¥è·¯å¾„ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°è¯•ä½¿ç”¨è¿™äº›ç§é’¥é€šè¿‡ SSH ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½•ã€‚

**é¡¹ç›®åœ°å€:** [TypicalModMaker/CVE-2024-4956](https://github.com/TypicalModMaker/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #8

**æ¥æº**: [CVE-2024-4956-UMASANKAR-MG_Path-Traversal-CVE-2024-4956.md](../2024/CVE-2024-4956-UMASANKAR-MG_Path-Traversal-CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 - è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Manager 3å®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 30%

## è¯¦æƒ…

æ ¹æ®CVE-2024-4956çš„æè¿°ï¼ŒSonatype Nexus Repository Manager 3å­˜åœ¨ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚è¯¥æ¼æ´å·²åœ¨3.68.1ç‰ˆæœ¬ä¸­ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ä»æä¾›çš„æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå½±å“ã€‚ç½‘é¡µ0ã€1ã€2ã€3ã€5ã€6ã€7å’Œ8å‡æåˆ°äº†CVE-2024-4956æ˜¯ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚ç½‘é¡µ9æä¾›äº†åŒ…å«PoCä»£ç çš„GitHubé“¾æ¥ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

æä¾›çš„PoCä»£ç åŒ…å«å‡ ä¸ªæ–‡ä»¶ï¼š
* `LICENSE`ï¼šMITè®¸å¯è¯ã€‚
* `cve/README.md`ï¼šæ¼æ´æè¿°ã€å…è´£å£°æ˜ã€PoCè§†é¢‘é“¾æ¥ã€å¸®åŠ©èœå•ã€ä½œè€…ä¿¡æ¯å’Œåé¦ˆæ–¹å¼ã€‚
* `cve/main.py`ï¼šä¸»ç¨‹åºå…¥å£ï¼ŒåŒ…å«å‘½ä»¤è¡Œå‚æ•°è§£æå’Œæ¼æ´åˆ©ç”¨é€»è¾‘ã€‚
* `cve/setup.py`ï¼šç”¨äºæ‰“åŒ…å’Œå®‰è£…PoCå·¥å…·çš„setupæ–‡ä»¶ã€‚
* `cve/includes/__init__.py`ï¼šä¸€ä¸ªç©ºçš„åˆå§‹åŒ–æ–‡ä»¶
* `cve/includes/file.py`ï¼šä¸€ä¸ªæ–‡ä»¶è¯»å–ç›¸å…³çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä»£ç ä¸å®Œæ•´

ä»`cve/main.py`çš„ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥è„šæœ¬æ¥å—URLæˆ–æ–‡ä»¶åˆ—è¡¨ä½œä¸ºè¾“å…¥ï¼Œå¹¶è°ƒç”¨ç›¸åº”çš„æ¨¡å—è¿›è¡Œæ¼æ´æ‰«æã€‚å®ƒä½¿ç”¨äº†`argparse`åº“æ¥å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼Œå¹¶æ ¹æ®å‚æ•°è°ƒç”¨scan.cvescan(args.url,args.output) æˆ–è€… file.reader(args.list,args.output)è¿›è¡Œåç»­å¤„ç†ã€‚
è™½ç„¶file.readerä»£ç ä¸å®Œæ•´ï¼Œä½†æ˜¯ç»“åˆgithubä¸Šçš„å…¶ä»–ä¿¡æ¯å¯ä»¥æ¨æµ‹å‡ºå…¶åŸºæœ¬çš„åŠŸèƒ½æ˜¯å‘é€å«æœ‰../çš„è¯·æ±‚åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆæ­¥åˆ†æï¼ŒPoCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ï¼Œä½†å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºä½œè€…UMASANKAR-MGåœ¨`README.md`ä¸­åŠ å…¥å…è´£å£°æ˜ï¼Œå¯èƒ½æš—ç¤ºå­˜åœ¨æœªå…¬å¼€çš„æ¶æ„åŠŸèƒ½ã€‚`setup.py`ä½¿ç”¨ç®€å•çš„'Path Traversal = cve.main:main' å…¥å£ç‚¹, é™ä½äº†åˆ†æçš„éš¾åº¦.

*   **å¯ç–‘ç‚¹ï¼š** å…è´£å£°æ˜å’Œä½œè€…ä¿¡æ¯å¯èƒ½æ©ç›–çœŸå®ç›®çš„ã€‚
*   **é£é™©ç‚¹ï¼š**  `cve/includes/file.py` ä»£ç ä¸å®Œæ•´ï¼Œå¯èƒ½åŒ…å«æ¶æ„ä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ã€‚`scan.cvescan`å‡½æ•°ä¹Ÿéœ€è¦è¿›ä¸€æ­¥åˆ†æï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºã€‚

ç»¼åˆè¯„ä¼°ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†é£é™©ç¨‹åº¦ä¸é«˜ï¼Œå¤§çº¦ä¸º30%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆä¾‹å¦‚`../`ï¼‰çš„æ¶æ„URLã€‚
2.  æ”»å‡»è€…å‘é€è¯¥æ¶æ„URLåˆ°ç›®æ ‡Nexus Repository Manager 3æœåŠ¡å™¨ã€‚
3.  æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯URLï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿè¯»å–ä»»æ„æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…è·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ã€‚

**PoCä½¿ç”¨æ–¹å¼ï¼š**

ä»cve/main.pyå¯ä»¥çœ‹åˆ°ï¼Œä¸»è¦ç”±ä¸¤ç§æ–¹å¼ä½¿ç”¨è¿™ä¸ªPOCã€‚
1.  `-u/--url`ï¼šæŒ‡å®šç›®æ ‡URLï¼Œç”¨äºå¯¹å•ä¸ªç›®æ ‡è¿›è¡Œæ‰«æ
2.  `-l/--list`ï¼šæŒ‡å®šåŒ…å«ç›®æ ‡URLåˆ—è¡¨çš„æ–‡ä»¶ï¼Œç”¨äºæ‰¹é‡æ‰«æ
3.  `-o/--output`ï¼šæŒ‡å®šè¾“å‡ºæ–‡ä»¶åï¼Œå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­
4.  `-b/--blog`ï¼šæ‰“å¼€åŒ…å«å…³äºè¯¥æ¼æ´çš„æ›´å¤šä¿¡æ¯çš„åšå®¢é¡µé¢

ä¾‹å¦‚ï¼š
`python main.py -u http://example.com/ -o output.txt`

**æ€»ç»“ï¼š**

CVE-2024-4956æ˜¯ä¸€ä¸ªé«˜å±çš„è·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚PoCä»£ç çš„å­˜åœ¨è¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ï¼Œä½†éœ€è¦æ³¨æ„æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½¿ç”¨æ—¶åº”è°¨æ…ã€‚

**é¡¹ç›®åœ°å€:** [UMASANKAR-MG/Path-Traversal-CVE-2024-4956](https://github.com/UMASANKAR-MG/Path-Traversal-CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #9

**æ¥æº**: [CVE-2024-4956-XiaomingX_cve-2024-4956.md](../2024/CVE-2024-4956-XiaomingX_cve-2024-4956.md)

# CVE-2024-4956

> ğŸ“¦ è¯¥CVEæœ‰ **18** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4956-An00bRektn_shirocrack.md](../2024/CVE-2024-4956-An00bRektn_shirocrack.md)

## CVE-2024-4956-Sonatype Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´çš„åˆ©ç”¨ç›¸å¯¹ç®€å•ï¼Œåªéœ€å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚å³å¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `shirocrack` æœ¬èº«å¹¶ä¸æ˜¯ç›´æ¥åˆ©ç”¨è·¯å¾„éå†æ¼æ´çš„PoCï¼Œè€Œæ˜¯åˆ©ç”¨è·¯å¾„éå†è¯»å–åˆ°çš„ç”¨æˆ·å¯†ç å“ˆå¸Œè¿›è¡Œç ´è§£çš„å·¥å…·ã€‚è¯¥å·¥å…·æ˜¯ä¸ºäº†ç ´è§£ Apache Shiro æ¡†æ¶ä½¿ç”¨çš„å¯†ç å“ˆå¸Œã€‚æŠ•æ¯’é£é™©åˆ†æï¼šè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªå¯†ç ç ´è§£å·¥å…·ï¼Œå…¶æœ¬èº«åŠŸèƒ½æ¯”è¾ƒæ˜ç¡®ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`shirocrack.go` åªæ˜¯ä¸€ä¸ªä½¿ç”¨å­—å…¸è¿›è¡Œæš´åŠ›ç ´è§£çš„å·¥å…·ï¼Œä½†å­˜åœ¨ä½œè€…æ·»åŠ åé—¨çš„é£é™©ï¼Œè€ƒè™‘åˆ°è¯¥å·¥å…·çš„ç”¨é€”ï¼Œä»¥åŠä½œè€…å¯èƒ½å‡ºäºæŸäº›ç›®çš„æ¤å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©, ç™¾åˆ†æ¯”ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é¦–å…ˆåˆ©ç”¨ CVE-2024-4956 è·¯å¾„éå†æ¼æ´è¯»å– Nexus Repository Manager æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œæ¯”å¦‚åŒ…å«å¯†ç å“ˆå¸Œçš„ `.pcl` æ–‡ä»¶ã€‚ç„¶åï¼Œä½¿ç”¨æä¾›çš„ `shirocrack` å·¥å…·ç ´è§£è¿™äº›å¯†ç å“ˆå¸Œã€‚å¦‚æœç ´è§£æˆåŠŸï¼Œæ”»å‡»è€…å°±å¯ä»¥ä½¿ç”¨ç ´è§£çš„å¯†ç ç™»å½• Nexus Repository Managerï¼Œæˆ–è€…åˆ©ç”¨æ³„éœ²çš„å…¶ä»–ä¿¡æ¯è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [An00bRektn/shirocrack](https://github.com/An00bRektn/shirocrack)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #2

**æ¥æº**: [CVE-2024-4956-Buff3st-0v3rfl0w_CVE-2024-4956.md](../2024/CVE-2024-4956-Buff3st-0v3rfl0w_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository 3 ä¸­å­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äºæ‰€æœ‰ 3.x ç‰ˆæœ¬ç›´åˆ° 3.68.0ï¼ˆåŒ…å« 3.68.0ï¼‰ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚å®ƒé€šè¿‡æ„é€ ä¸€ä¸ªåŒ…å«å¤šä¸ª `..` åºåˆ—çš„ URLï¼Œå°è¯•è®¿é—®æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å›æ–‡ä»¶çš„å†…å®¹ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†æäº†æä¾›çš„ Python è„šæœ¬ï¼ˆCVE-2024-4956.pyï¼‰å’Œ README.md æ–‡ä»¶ã€‚

*   **CVE-2024-4956.py:** è¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP GET è¯·æ±‚åˆ°ç›®æ ‡ Nexus Repository æœåŠ¡å™¨ï¼Œè¯·æ±‚ä¸­åŒ…å«ç»è¿‡ç¼–ç çš„è·¯å¾„éå† payloadã€‚è„šæœ¬åŒ…å«åŸºæœ¬çš„é”™è¯¯å¤„ç†ï¼Œå¹¶åœ¨å“åº”ä¸­æ£€æŸ¥ "Not Found" å­—ç¬¦ä¸²ä»¥ç¡®å®šæ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚è„šæœ¬çš„åŠŸèƒ½ä¸å…¶æè¿°çš„åŠŸèƒ½ä¸€è‡´ï¼Œå³åˆ©ç”¨ CVE-2024-4956 è¿›è¡Œæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰ã€‚
*   **README.md:** è¯¥æ–‡ä»¶æä¾›äº†æœ‰å…³å¦‚ä½•ä½¿ç”¨è¯¥è„šæœ¬çš„åŸºæœ¬ä¿¡æ¯ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘å†…å®¹ã€‚

å°½ç®¡æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†ä»»ä½•ä»ä¸å—ä¿¡ä»»çš„æ¥æºè·å–çš„ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚æ­¤è„šæœ¬çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š
    *   **ä¾èµ–å…³ç³»é£é™©ï¼š** è„šæœ¬ä½¿ç”¨ `requests` åº“ã€‚è™½ç„¶ `requests` æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„åº“ï¼Œä½†æ”»å‡»è€…å¯èƒ½ä¼šå°è¯•é€šè¿‡æ¶æ„ç‰ˆæœ¬çš„ `requests` æˆ– `requests` çš„ä¾èµ–é¡¹è¿›è¡ŒæŠ•æ¯’ï¼Œå°½ç®¡è¿™ç§æƒ…å†µä¸å¤ªå¯èƒ½ã€‚
    *   **å¼€å‘è€…ç–å¿½ï¼š** å¼€å‘è€…å¯èƒ½ä¼šåœ¨æ— æ„ä¸­å¼•å…¥æ¼æ´æˆ–é”™è¯¯ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™äº›æ¼æ´æˆ–é”™è¯¯ã€‚
    *   **å…ƒæ•°æ®æ¬ºéª—ï¼š** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬çš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚ä½œè€…ä¿¡æ¯æˆ–æè¿°ï¼Œä»¥ä½¿å…¶çœ‹èµ·æ¥æ›´å¯ä¿¡ã€‚
    *   **æœ‰é™çš„å®¡æŸ¥ï¼š** ç”±äºæ²¡æœ‰å¯¹è¯¥è„šæœ¬è¿›è¡Œå¹¿æ³›çš„å®¡æŸ¥ï¼Œå› æ­¤æ— æ³•å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚

å»ºè®®åœ¨ä½¿ç”¨å‰å®¡æŸ¥è¯¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ `http://<nexus_ip>:<nexus_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`ã€‚
2.  Nexus Repository æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯ URL ä¸­çš„è·¯å¾„ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è®¿é—® `/etc/passwd` æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨å°† `/etc/passwd` æ–‡ä»¶çš„å†…å®¹è¿”å›ç»™æ”»å‡»è€…ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Buff3st-0v3rfl0w/CVE-2024-4956](https://github.com/Buff3st-0v3rfl0w/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #3

**æ¥æº**: [CVE-2024-4956-Cappricio-Securities_CVE-2024-4956.md](../2024/CVE-2024-4956-Cappricio-Securities_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 3.0.0 <= version <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒNexus Repository Manager 3ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®ç›®æ ‡ç³»ç»Ÿã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ 3.0.0 åˆ° 3.68.0 ä¹‹é—´çš„æ‰€æœ‰ Nexus Repository Manager 3.x ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç  (POC) æ˜¾ç¤ºï¼ŒCappricio-Securities å·²ç»å¼€å‘äº†ç›¸åº”çš„æ¼æ´åˆ©ç”¨å·¥å…·ï¼Œé€šè¿‡æ„é€ ç‰¹å®šçš„ URLï¼Œæ”»å‡»è€…å¯ä»¥ä¸‹è½½æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚è¯¥å·¥å…·æ”¯æŒå•ä¸ª URL æ‰«æã€æ‰¹é‡ URL æ‰«æï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚é›†æˆäº†Telegram APIï¼Œå¯ç”¨äºæ¥æ”¶æ¼æ´æ£€æµ‹çš„å³æ—¶é€šçŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å­˜åœ¨å…¬å¼€å¯ç”¨çš„POCã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç æ–‡ä»¶ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å®ç°æ¼æ´éªŒè¯å’Œåˆ©ç”¨ã€‚å…¶ä¸­ï¼ŒREADME.md æ–‡ä»¶ä¸­å¼•ç”¨äº†å¤–éƒ¨å›¾ç‰‡å’Œshields.io çš„å¾½ç« ï¼Œå­˜åœ¨ä¸€å®šçš„ä¾›åº”é“¾æŠ•æ¯’é£é™©ï¼Œä½†æ€»ä½“é£é™©è¾ƒä½ã€‚æ­¤å¤–ï¼ŒPOC å·¥å…·é›†æˆäº† Telegram API å‘é€é€šçŸ¥ï¼Œä½¿ç”¨è€…éœ€è¦æä¾›è‡ªå·±çš„ Telegram Chat IDï¼Œå¯èƒ½å­˜åœ¨éšç§æ³„éœ²é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©å¤§çº¦ä¸º 10%ï¼Œä¸»è¦æ¥è‡ªä¾›åº”é“¾ä¾èµ–å’Œä¸ªäººä¿¡æ¯æ³„éœ²ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ä½¿ç”¨ Cappricio-Securities æä¾›çš„ CVE-2024-4956 å·¥å…·ã€‚
2.  é€šè¿‡ pip å®‰è£…è¯¥å·¥å…·ï¼š`pip install CVE-2024-4956`ã€‚
3.  ä½¿ç”¨ `-u` å‚æ•°æŒ‡å®šå•ä¸ªç›®æ ‡ URLï¼Œæˆ–è€…ä½¿ç”¨ `-i` å‚æ•°æŒ‡å®šåŒ…å«å¤šä¸ªç›®æ ‡ URL çš„æ–‡æœ¬æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„æ¶æ„ URLï¼Œä¾‹å¦‚ï¼š`http://example.com/../../../etc/passwd`ï¼Œåˆ©ç”¨è¯¥ URL ä¸‹è½½ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd` æˆ–åº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ã€‚
5.  å¯ä»¥ä½¿ç”¨ `-o` å‚æ•°å°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­ã€‚
6.  å·¥å…·é›†æˆäº†Telegram APIï¼Œå¯ä»¥é€šè¿‡é…ç½®Chat IDï¼Œæ¥æ”¶æ¼æ´æ£€æµ‹çš„å³æ—¶é€šçŸ¥

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-4956](https://github.com/Cappricio-Securities/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #4

**æ¥æº**: [CVE-2024-4956-GoatSecurity_CVE-2024-4956.md](../2024/CVE-2024-4956-GoatSecurity_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Manager 3å®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«å¤šä¸ª "/%2F" å’Œ "../" çš„ URLï¼Œç»•è¿‡è·¯å¾„æ£€æŸ¥ï¼Œæœ€ç»ˆè®¿é—®åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/passwdã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå¯ä»¥éªŒè¯æ¼æ´çš„HTTPè¯·æ±‚å’Œä¸€ä¸ªå¯ä»¥æ‰¹é‡æ‰«æç›®æ ‡çš„pythonè„šæœ¬ã€‚è„šæœ¬ä»targets.txtè¯»å–ç›®æ ‡URLï¼Œå¹¶å¯¹æ¯ä¸ªURLå°è¯•åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–/etc/passwdæ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™å°†è¯¥URLæ·»åŠ åˆ°vulnerable_sitesåˆ—è¡¨ä¸­ï¼Œå¯ä»¥é€‰æ‹©ä¿å­˜åˆ°output.txtæ–‡ä»¶ä¸­ã€‚è™½ç„¶è„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚targets.txtä¸­å¯èƒ½åŒ…å«æŒ‡å‘æ¶æ„ç«™ç‚¹çš„é“¾æ¥ï¼Œæˆ–ä½œè€…æœªæ¥å¯èƒ½åœ¨githubä»“åº“ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚æ‰«æè„šæœ¬åˆ©ç”¨requestsåº“å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨å› ç›®æ ‡æœåŠ¡å™¨ç½‘ç»œæ³¢åŠ¨å¯¼è‡´è¯¯æŠ¥çš„æƒ…å†µã€‚

**é¡¹ç›®åœ°å€:** [GoatSecurity/CVE-2024-4956](https://github.com/GoatSecurity/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #5

**æ¥æº**: [CVE-2024-4956-JolyIrsb_CVE-2024-4956.md](../2024/CVE-2024-4956-JolyIrsb_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œéœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„ Python è„šæœ¬ `CVE-2024-4956-threads.py` æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´ã€‚ å®ƒé€šè¿‡æ„é€ åŒ…å«å¤šä¸ª `/%2F` å’Œ `../` åºåˆ—çš„ URL æ¥å°è¯•è¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„ `/etc/passwd` æ–‡ä»¶ã€‚å¦‚æœå“åº”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è„šæœ¬è®¤ä¸ºè¯¥ä¸»æœºå­˜åœ¨æ¼æ´ã€‚æä¾›çš„nucleiæ¨¡ç‰ˆå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
ä»£ç æœ¬èº«å®ç°çš„åŠŸèƒ½ä¸ºè¯»å–ç›®æ ‡æœºå™¨ä¸Šçš„æ–‡ä»¶ï¼Œä»ä»£ç åŠŸèƒ½ä¸Šåˆ¤æ–­ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ä»£ç çš„ä½œè€…å¯ä»¥åœ¨check_vulnerabilityå‡½æ•°ä¸­æ·»åŠ é¢å¤–çš„æ¶æ„ä»£ç ,ç”¨äºæ”¶é›†ç›®æ ‡ä¸»æœºçš„ä¿¡æ¯æˆ–è€…æ¤å…¥åé—¨ç¨‹åºï¼Œä½†ä»ç›®å‰çš„ä»£ç æ¥çœ‹ï¼Œæ²¡æœ‰å‘ç°ç›´æ¥çš„æŠ•æ¯’ä»£ç ã€‚README.md ä¸­çš„å£°æ˜ä¹Ÿæš—ç¤ºäº†é£é™©çš„å­˜åœ¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚å› ä¸ºä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œå¦‚æœå­˜åœ¨æ¶æ„ä»£ç å®¹æ˜“è¢«å‘ç°ã€‚ 

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚ `/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`ï¼‰çš„ URLã€‚
2.  Nexus Repository Manager 3 é”™è¯¯åœ°å¤„ç†è¯¥ URLï¼Œå…è®¸æ”»å‡»è€…è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç å’Œç³»ç»Ÿæ–‡ä»¶ã€‚
4.  ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬,å¯ä»¥æ‰¹é‡å¯¹ç›®æ ‡è¿›è¡Œæ‰«æ,è¯†åˆ«å­˜åœ¨æ¼æ´çš„ä¸»æœºã€‚
5.  æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„nucleiæ¨¡ç‰ˆï¼ŒåŒ…å«ä¸»åŠ¨æ‰«æå’Œè¢«åŠ¨æå–ç‰ˆæœ¬ï¼Œæ–¹ä¾¿æ¼æ´éªŒè¯

**é¡¹ç›®åœ°å€:** [JolyIrsb/CVE-2024-4956](https://github.com/JolyIrsb/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #6

**æ¥æº**: [CVE-2024-4956-Praison001_CVE-2024-4956-Sonatype-Nexus-Repository-Manager.md](../2024/CVE-2024-4956-Praison001_CVE-2024-4956-Sonatype-Nexus-Repository-Manager.md)

## CVE-2024-4956-Sonatype Nexus Repository Manager-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Managerå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆä¾‹å¦‚ `%2F` å’Œ `..`ï¼‰çš„ URLï¼Œè¯»å– Nexus Repository Manager æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„PoCä»£ç åŒ…å« Python å’Œ Bash ä¸¤ç§å®ç°ï¼Œéƒ½åˆ©ç”¨äº† URL ç¼–ç çš„è·¯å¾„éå†åºåˆ—æ¥è®¿é—®ç›®æ ‡æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªæˆæƒè®¿é—®ç³»ç»Ÿæ–‡ä»¶ï¼ŒPoC ä»£ç çš„ç›®çš„æ˜¯é€šè¿‡æ„é€ æ¶æ„ URL è¯»å–æœåŠ¡å™¨æ–‡ä»¶ã€‚PoCä»£ç ç»™å‡ºäº†Python3å’ŒBashä¸¤ç§åˆ©ç”¨æ–¹å¼ï¼Œå¹¶ä¸”æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒéªŒè¯äº†å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

PoC ä»£ç ï¼ˆ`exploitBash.sh` å’Œ `exploitPython.py`ï¼‰çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP GET è¯·æ±‚ä»¥åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å°è¯•æ‰§è¡Œæ¶æ„æ“ä½œï¼ˆä¾‹å¦‚ï¼Œå†™å…¥æ–‡ä»¶ã€æ‰§è¡Œå‘½ä»¤ï¼‰çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚è„šæœ¬çš„è¡Œä¸ºç¬¦åˆæ¼æ´æè¿°ï¼Œæ—¨åœ¨è¯»å–æŒ‡å®šæ–‡ä»¶å†…å®¹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡Nexus Repository Managerå®ä¾‹çš„URLå’Œç«¯å£ï¼š**  ä¾‹å¦‚`http://127.0.0.1:8081`ã€‚
2.  **æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„æ¶æ„URLï¼š**  PoCä»£ç ä¸­ä½¿ç”¨äº†`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..{targetFile}`ï¼Œå…¶ä¸­`{targetFile}`æ˜¯è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  **å‘é€HTTP GETè¯·æ±‚ï¼š**  ä½¿ç”¨PoCä»£ç æä¾›çš„Pythonè„šæœ¬æˆ–Bashè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLã€ç«¯å£å’Œè¦è¯»å–çš„æ–‡ä»¶ã€‚
4.  **åˆ†æå“åº”ï¼š**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚å¦‚æœåˆ©ç”¨å¤±è´¥ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šè¿”å›é”™è¯¯ä»£ç æˆ–æ¶ˆæ¯ã€‚

**é˜²èŒƒæªæ–½ï¼š**

*   å‡çº§åˆ° Sonatype Nexus Repository Manager 3.68.1 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å‚è€ƒ Sonatype å®˜æ–¹æ–‡æ¡£ï¼Œå®æ–½é€‚å½“çš„ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager](https://github.com/Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #7

**æ¥æº**: [CVE-2024-4956-TypicalModMaker_CVE-2024-4956.md](../2024/CVE-2024-4956-TypicalModMaker_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Sonatype Nexus Repository Manager 3ï¼Œä¸”å…è®¸æœªæˆæƒç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨ç²¾å¿ƒæ„é€ çš„URLæ¥ä¸‹è½½ä»»æ„æ–‡ä»¶ã€‚`README.md`æ–‡ä»¶ä¸­æè¿°äº†ç›¸å…³çš„åˆ©ç”¨è„šæœ¬ï¼ŒåŒ…æ‹¬æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å®¹æ˜“å—åˆ°æ”»å‡» (`check-vulnerable-servers.py`)ï¼Œæ£€æŸ¥æ˜¯å¦ä»¥ root ç”¨æˆ·èº«ä»½è¿è¡Œ (`check-root-servers.py`)ï¼Œä»¥åŠå°è¯•ä½¿ç”¨æ‰¾åˆ°çš„ç§é’¥é€šè¿‡ SSH ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½• (`check-private_keys.py`)ã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š** ä»“åº“ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„è„šæœ¬ä¸»è¦ç”¨äºæ£€æµ‹å’Œåˆ©ç”¨æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ã€‚ä½†å­˜åœ¨è½»å¾®é£é™©ï¼Œä½“ç°åœ¨`check-private_keys.py`ï¼Œå¯èƒ½å­˜åœ¨æ”¶é›†ç§é’¥ç”¨äºå…¶ä»–ç›®çš„ï¼Œæ‰€ä»¥åˆ¤å®šæŠ•æ¯’é£é™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ä½¿ç”¨ Shodan ç­‰æœç´¢å¼•æ“æŸ¥æ‰¾æš´éœ²åœ¨ç½‘ç»œä¸Šçš„ Sonatype Nexus Repository Manager 3 å®ä¾‹ã€‚
2.  ä½¿ç”¨ `check-vulnerable-servers.py` è„šæœ¬éªŒè¯ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨ CVE-2024-4956 æ¼æ´ï¼Œé€šè¿‡å°è¯•è¯»å– `/etc/passwd` æ–‡ä»¶æ¥éªŒè¯ã€‚
3.  ï¼ˆå¦‚æœç›®æ ‡ä»¥ root èº«ä»½è¿è¡Œï¼‰ä½¿ç”¨ `check-root-servers.py` è„šæœ¬éªŒè¯ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å¯ä»¥è¯»å– `/etc/shadow` æ–‡ä»¶ã€‚
4.  ï¼ˆå¦‚æœç›®æ ‡ä»¥ root èº«ä»½è¿è¡Œï¼‰ä½¿ç”¨ `check-private_keys.py` è„šæœ¬æŸ¥æ‰¾å¸¸è§çš„ç§é’¥è·¯å¾„ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°è¯•ä½¿ç”¨è¿™äº›ç§é’¥é€šè¿‡ SSH ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½•ã€‚

**é¡¹ç›®åœ°å€:** [TypicalModMaker/CVE-2024-4956](https://github.com/TypicalModMaker/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #8

**æ¥æº**: [CVE-2024-4956-UMASANKAR-MG_Path-Traversal-CVE-2024-4956.md](../2024/CVE-2024-4956-UMASANKAR-MG_Path-Traversal-CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 - è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Manager 3å®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 30%

## è¯¦æƒ…

æ ¹æ®CVE-2024-4956çš„æè¿°ï¼ŒSonatype Nexus Repository Manager 3å­˜åœ¨ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚è¯¥æ¼æ´å·²åœ¨3.68.1ç‰ˆæœ¬ä¸­ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ä»æä¾›çš„æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå½±å“ã€‚ç½‘é¡µ0ã€1ã€2ã€3ã€5ã€6ã€7å’Œ8å‡æåˆ°äº†CVE-2024-4956æ˜¯ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚ç½‘é¡µ9æä¾›äº†åŒ…å«PoCä»£ç çš„GitHubé“¾æ¥ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

æä¾›çš„PoCä»£ç åŒ…å«å‡ ä¸ªæ–‡ä»¶ï¼š
* `LICENSE`ï¼šMITè®¸å¯è¯ã€‚
* `cve/README.md`ï¼šæ¼æ´æè¿°ã€å…è´£å£°æ˜ã€PoCè§†é¢‘é“¾æ¥ã€å¸®åŠ©èœå•ã€ä½œè€…ä¿¡æ¯å’Œåé¦ˆæ–¹å¼ã€‚
* `cve/main.py`ï¼šä¸»ç¨‹åºå…¥å£ï¼ŒåŒ…å«å‘½ä»¤è¡Œå‚æ•°è§£æå’Œæ¼æ´åˆ©ç”¨é€»è¾‘ã€‚
* `cve/setup.py`ï¼šç”¨äºæ‰“åŒ…å’Œå®‰è£…PoCå·¥å…·çš„setupæ–‡ä»¶ã€‚
* `cve/includes/__init__.py`ï¼šä¸€ä¸ªç©ºçš„åˆå§‹åŒ–æ–‡ä»¶
* `cve/includes/file.py`ï¼šä¸€ä¸ªæ–‡ä»¶è¯»å–ç›¸å…³çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä»£ç ä¸å®Œæ•´

ä»`cve/main.py`çš„ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥è„šæœ¬æ¥å—URLæˆ–æ–‡ä»¶åˆ—è¡¨ä½œä¸ºè¾“å…¥ï¼Œå¹¶è°ƒç”¨ç›¸åº”çš„æ¨¡å—è¿›è¡Œæ¼æ´æ‰«æã€‚å®ƒä½¿ç”¨äº†`argparse`åº“æ¥å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼Œå¹¶æ ¹æ®å‚æ•°è°ƒç”¨scan.cvescan(args.url,args.output) æˆ–è€… file.reader(args.list,args.output)è¿›è¡Œåç»­å¤„ç†ã€‚
è™½ç„¶file.readerä»£ç ä¸å®Œæ•´ï¼Œä½†æ˜¯ç»“åˆgithubä¸Šçš„å…¶ä»–ä¿¡æ¯å¯ä»¥æ¨æµ‹å‡ºå…¶åŸºæœ¬çš„åŠŸèƒ½æ˜¯å‘é€å«æœ‰../çš„è¯·æ±‚åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆæ­¥åˆ†æï¼ŒPoCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ï¼Œä½†å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºä½œè€…UMASANKAR-MGåœ¨`README.md`ä¸­åŠ å…¥å…è´£å£°æ˜ï¼Œå¯èƒ½æš—ç¤ºå­˜åœ¨æœªå…¬å¼€çš„æ¶æ„åŠŸèƒ½ã€‚`setup.py`ä½¿ç”¨ç®€å•çš„'Path Traversal = cve.main:main' å…¥å£ç‚¹, é™ä½äº†åˆ†æçš„éš¾åº¦.

*   **å¯ç–‘ç‚¹ï¼š** å…è´£å£°æ˜å’Œä½œè€…ä¿¡æ¯å¯èƒ½æ©ç›–çœŸå®ç›®çš„ã€‚
*   **é£é™©ç‚¹ï¼š**  `cve/includes/file.py` ä»£ç ä¸å®Œæ•´ï¼Œå¯èƒ½åŒ…å«æ¶æ„ä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ã€‚`scan.cvescan`å‡½æ•°ä¹Ÿéœ€è¦è¿›ä¸€æ­¥åˆ†æï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºã€‚

ç»¼åˆè¯„ä¼°ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†é£é™©ç¨‹åº¦ä¸é«˜ï¼Œå¤§çº¦ä¸º30%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆä¾‹å¦‚`../`ï¼‰çš„æ¶æ„URLã€‚
2.  æ”»å‡»è€…å‘é€è¯¥æ¶æ„URLåˆ°ç›®æ ‡Nexus Repository Manager 3æœåŠ¡å™¨ã€‚
3.  æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯URLï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿè¯»å–ä»»æ„æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…è·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ã€‚

**PoCä½¿ç”¨æ–¹å¼ï¼š**

ä»cve/main.pyå¯ä»¥çœ‹åˆ°ï¼Œä¸»è¦ç”±ä¸¤ç§æ–¹å¼ä½¿ç”¨è¿™ä¸ªPOCã€‚
1.  `-u/--url`ï¼šæŒ‡å®šç›®æ ‡URLï¼Œç”¨äºå¯¹å•ä¸ªç›®æ ‡è¿›è¡Œæ‰«æ
2.  `-l/--list`ï¼šæŒ‡å®šåŒ…å«ç›®æ ‡URLåˆ—è¡¨çš„æ–‡ä»¶ï¼Œç”¨äºæ‰¹é‡æ‰«æ
3.  `-o/--output`ï¼šæŒ‡å®šè¾“å‡ºæ–‡ä»¶åï¼Œå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­
4.  `-b/--blog`ï¼šæ‰“å¼€åŒ…å«å…³äºè¯¥æ¼æ´çš„æ›´å¤šä¿¡æ¯çš„åšå®¢é¡µé¢

ä¾‹å¦‚ï¼š
`python main.py -u http://example.com/ -o output.txt`

**æ€»ç»“ï¼š**

CVE-2024-4956æ˜¯ä¸€ä¸ªé«˜å±çš„è·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚PoCä»£ç çš„å­˜åœ¨è¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ï¼Œä½†éœ€è¦æ³¨æ„æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½¿ç”¨æ—¶åº”è°¨æ…ã€‚

**é¡¹ç›®åœ°å€:** [UMASANKAR-MG/Path-Traversal-CVE-2024-4956](https://github.com/UMASANKAR-MG/Path-Traversal-CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #9

**æ¥æº**: [CVE-2024-4956-XiaomingX_cve-2024-4956.md](../2024/CVE-2024-4956-XiaomingX_cve-2024-4956.md)

# CVE-2024-4956

> ğŸ“¦ è¯¥CVEæœ‰ **18** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4956-An00bRektn_shirocrack.md](../2024/CVE-2024-4956-An00bRektn_shirocrack.md)

## CVE-2024-4956-Sonatype Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´çš„åˆ©ç”¨ç›¸å¯¹ç®€å•ï¼Œåªéœ€å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚å³å¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `shirocrack` æœ¬èº«å¹¶ä¸æ˜¯ç›´æ¥åˆ©ç”¨è·¯å¾„éå†æ¼æ´çš„PoCï¼Œè€Œæ˜¯åˆ©ç”¨è·¯å¾„éå†è¯»å–åˆ°çš„ç”¨æˆ·å¯†ç å“ˆå¸Œè¿›è¡Œç ´è§£çš„å·¥å…·ã€‚è¯¥å·¥å…·æ˜¯ä¸ºäº†ç ´è§£ Apache Shiro æ¡†æ¶ä½¿ç”¨çš„å¯†ç å“ˆå¸Œã€‚æŠ•æ¯’é£é™©åˆ†æï¼šè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªå¯†ç ç ´è§£å·¥å…·ï¼Œå…¶æœ¬èº«åŠŸèƒ½æ¯”è¾ƒæ˜ç¡®ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`shirocrack.go` åªæ˜¯ä¸€ä¸ªä½¿ç”¨å­—å…¸è¿›è¡Œæš´åŠ›ç ´è§£çš„å·¥å…·ï¼Œä½†å­˜åœ¨ä½œè€…æ·»åŠ åé—¨çš„é£é™©ï¼Œè€ƒè™‘åˆ°è¯¥å·¥å…·çš„ç”¨é€”ï¼Œä»¥åŠä½œè€…å¯èƒ½å‡ºäºæŸäº›ç›®çš„æ¤å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©, ç™¾åˆ†æ¯”ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é¦–å…ˆåˆ©ç”¨ CVE-2024-4956 è·¯å¾„éå†æ¼æ´è¯»å– Nexus Repository Manager æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œæ¯”å¦‚åŒ…å«å¯†ç å“ˆå¸Œçš„ `.pcl` æ–‡ä»¶ã€‚ç„¶åï¼Œä½¿ç”¨æä¾›çš„ `shirocrack` å·¥å…·ç ´è§£è¿™äº›å¯†ç å“ˆå¸Œã€‚å¦‚æœç ´è§£æˆåŠŸï¼Œæ”»å‡»è€…å°±å¯ä»¥ä½¿ç”¨ç ´è§£çš„å¯†ç ç™»å½• Nexus Repository Managerï¼Œæˆ–è€…åˆ©ç”¨æ³„éœ²çš„å…¶ä»–ä¿¡æ¯è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [An00bRektn/shirocrack](https://github.com/An00bRektn/shirocrack)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #2

**æ¥æº**: [CVE-2024-4956-Buff3st-0v3rfl0w_CVE-2024-4956.md](../2024/CVE-2024-4956-Buff3st-0v3rfl0w_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository 3 ä¸­å­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äºæ‰€æœ‰ 3.x ç‰ˆæœ¬ç›´åˆ° 3.68.0ï¼ˆåŒ…å« 3.68.0ï¼‰ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚å®ƒé€šè¿‡æ„é€ ä¸€ä¸ªåŒ…å«å¤šä¸ª `..` åºåˆ—çš„ URLï¼Œå°è¯•è®¿é—®æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å›æ–‡ä»¶çš„å†…å®¹ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†æäº†æä¾›çš„ Python è„šæœ¬ï¼ˆCVE-2024-4956.pyï¼‰å’Œ README.md æ–‡ä»¶ã€‚

*   **CVE-2024-4956.py:** è¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP GET è¯·æ±‚åˆ°ç›®æ ‡ Nexus Repository æœåŠ¡å™¨ï¼Œè¯·æ±‚ä¸­åŒ…å«ç»è¿‡ç¼–ç çš„è·¯å¾„éå† payloadã€‚è„šæœ¬åŒ…å«åŸºæœ¬çš„é”™è¯¯å¤„ç†ï¼Œå¹¶åœ¨å“åº”ä¸­æ£€æŸ¥ "Not Found" å­—ç¬¦ä¸²ä»¥ç¡®å®šæ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚è„šæœ¬çš„åŠŸèƒ½ä¸å…¶æè¿°çš„åŠŸèƒ½ä¸€è‡´ï¼Œå³åˆ©ç”¨ CVE-2024-4956 è¿›è¡Œæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰ã€‚
*   **README.md:** è¯¥æ–‡ä»¶æä¾›äº†æœ‰å…³å¦‚ä½•ä½¿ç”¨è¯¥è„šæœ¬çš„åŸºæœ¬ä¿¡æ¯ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘å†…å®¹ã€‚

å°½ç®¡æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†ä»»ä½•ä»ä¸å—ä¿¡ä»»çš„æ¥æºè·å–çš„ä»£ç éƒ½å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚æ­¤è„šæœ¬çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š
    *   **ä¾èµ–å…³ç³»é£é™©ï¼š** è„šæœ¬ä½¿ç”¨ `requests` åº“ã€‚è™½ç„¶ `requests` æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„åº“ï¼Œä½†æ”»å‡»è€…å¯èƒ½ä¼šå°è¯•é€šè¿‡æ¶æ„ç‰ˆæœ¬çš„ `requests` æˆ– `requests` çš„ä¾èµ–é¡¹è¿›è¡ŒæŠ•æ¯’ï¼Œå°½ç®¡è¿™ç§æƒ…å†µä¸å¤ªå¯èƒ½ã€‚
    *   **å¼€å‘è€…ç–å¿½ï¼š** å¼€å‘è€…å¯èƒ½ä¼šåœ¨æ— æ„ä¸­å¼•å…¥æ¼æ´æˆ–é”™è¯¯ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™äº›æ¼æ´æˆ–é”™è¯¯ã€‚
    *   **å…ƒæ•°æ®æ¬ºéª—ï¼š** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬çš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚ä½œè€…ä¿¡æ¯æˆ–æè¿°ï¼Œä»¥ä½¿å…¶çœ‹èµ·æ¥æ›´å¯ä¿¡ã€‚
    *   **æœ‰é™çš„å®¡æŸ¥ï¼š** ç”±äºæ²¡æœ‰å¯¹è¯¥è„šæœ¬è¿›è¡Œå¹¿æ³›çš„å®¡æŸ¥ï¼Œå› æ­¤æ— æ³•å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚

å»ºè®®åœ¨ä½¿ç”¨å‰å®¡æŸ¥è¯¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ `http://<nexus_ip>:<nexus_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`ã€‚
2.  Nexus Repository æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯ URL ä¸­çš„è·¯å¾„ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è®¿é—® `/etc/passwd` æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨å°† `/etc/passwd` æ–‡ä»¶çš„å†…å®¹è¿”å›ç»™æ”»å‡»è€…ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Buff3st-0v3rfl0w/CVE-2024-4956](https://github.com/Buff3st-0v3rfl0w/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #3

**æ¥æº**: [CVE-2024-4956-Cappricio-Securities_CVE-2024-4956.md](../2024/CVE-2024-4956-Cappricio-Securities_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 3.0.0 <= version <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒNexus Repository Manager 3ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®ç›®æ ‡ç³»ç»Ÿã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ 3.0.0 åˆ° 3.68.0 ä¹‹é—´çš„æ‰€æœ‰ Nexus Repository Manager 3.x ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç  (POC) æ˜¾ç¤ºï¼ŒCappricio-Securities å·²ç»å¼€å‘äº†ç›¸åº”çš„æ¼æ´åˆ©ç”¨å·¥å…·ï¼Œé€šè¿‡æ„é€ ç‰¹å®šçš„ URLï¼Œæ”»å‡»è€…å¯ä»¥ä¸‹è½½æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚è¯¥å·¥å…·æ”¯æŒå•ä¸ª URL æ‰«æã€æ‰¹é‡ URL æ‰«æï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚é›†æˆäº†Telegram APIï¼Œå¯ç”¨äºæ¥æ”¶æ¼æ´æ£€æµ‹çš„å³æ—¶é€šçŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å­˜åœ¨å…¬å¼€å¯ç”¨çš„POCã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç æ–‡ä»¶ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å®ç°æ¼æ´éªŒè¯å’Œåˆ©ç”¨ã€‚å…¶ä¸­ï¼ŒREADME.md æ–‡ä»¶ä¸­å¼•ç”¨äº†å¤–éƒ¨å›¾ç‰‡å’Œshields.io çš„å¾½ç« ï¼Œå­˜åœ¨ä¸€å®šçš„ä¾›åº”é“¾æŠ•æ¯’é£é™©ï¼Œä½†æ€»ä½“é£é™©è¾ƒä½ã€‚æ­¤å¤–ï¼ŒPOC å·¥å…·é›†æˆäº† Telegram API å‘é€é€šçŸ¥ï¼Œä½¿ç”¨è€…éœ€è¦æä¾›è‡ªå·±çš„ Telegram Chat IDï¼Œå¯èƒ½å­˜åœ¨éšç§æ³„éœ²é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©å¤§çº¦ä¸º 10%ï¼Œä¸»è¦æ¥è‡ªä¾›åº”é“¾ä¾èµ–å’Œä¸ªäººä¿¡æ¯æ³„éœ²ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ä½¿ç”¨ Cappricio-Securities æä¾›çš„ CVE-2024-4956 å·¥å…·ã€‚
2.  é€šè¿‡ pip å®‰è£…è¯¥å·¥å…·ï¼š`pip install CVE-2024-4956`ã€‚
3.  ä½¿ç”¨ `-u` å‚æ•°æŒ‡å®šå•ä¸ªç›®æ ‡ URLï¼Œæˆ–è€…ä½¿ç”¨ `-i` å‚æ•°æŒ‡å®šåŒ…å«å¤šä¸ªç›®æ ‡ URL çš„æ–‡æœ¬æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„æ¶æ„ URLï¼Œä¾‹å¦‚ï¼š`http://example.com/../../../etc/passwd`ï¼Œåˆ©ç”¨è¯¥ URL ä¸‹è½½ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd` æˆ–åº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ã€‚
5.  å¯ä»¥ä½¿ç”¨ `-o` å‚æ•°å°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­ã€‚
6.  å·¥å…·é›†æˆäº†Telegram APIï¼Œå¯ä»¥é€šè¿‡é…ç½®Chat IDï¼Œæ¥æ”¶æ¼æ´æ£€æµ‹çš„å³æ—¶é€šçŸ¥

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-4956](https://github.com/Cappricio-Securities/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #4

**æ¥æº**: [CVE-2024-4956-GoatSecurity_CVE-2024-4956.md](../2024/CVE-2024-4956-GoatSecurity_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Manager 3å®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«å¤šä¸ª "/%2F" å’Œ "../" çš„ URLï¼Œç»•è¿‡è·¯å¾„æ£€æŸ¥ï¼Œæœ€ç»ˆè®¿é—®åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/passwdã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå¯ä»¥éªŒè¯æ¼æ´çš„HTTPè¯·æ±‚å’Œä¸€ä¸ªå¯ä»¥æ‰¹é‡æ‰«æç›®æ ‡çš„pythonè„šæœ¬ã€‚è„šæœ¬ä»targets.txtè¯»å–ç›®æ ‡URLï¼Œå¹¶å¯¹æ¯ä¸ªURLå°è¯•åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–/etc/passwdæ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™å°†è¯¥URLæ·»åŠ åˆ°vulnerable_sitesåˆ—è¡¨ä¸­ï¼Œå¯ä»¥é€‰æ‹©ä¿å­˜åˆ°output.txtæ–‡ä»¶ä¸­ã€‚è™½ç„¶è„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚targets.txtä¸­å¯èƒ½åŒ…å«æŒ‡å‘æ¶æ„ç«™ç‚¹çš„é“¾æ¥ï¼Œæˆ–ä½œè€…æœªæ¥å¯èƒ½åœ¨githubä»“åº“ä¸­æ¤å…¥æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚æ‰«æè„šæœ¬åˆ©ç”¨requestsåº“å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨å› ç›®æ ‡æœåŠ¡å™¨ç½‘ç»œæ³¢åŠ¨å¯¼è‡´è¯¯æŠ¥çš„æƒ…å†µã€‚

**é¡¹ç›®åœ°å€:** [GoatSecurity/CVE-2024-4956](https://github.com/GoatSecurity/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #5

**æ¥æº**: [CVE-2024-4956-JolyIrsb_CVE-2024-4956.md](../2024/CVE-2024-4956-JolyIrsb_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œéœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„ Python è„šæœ¬ `CVE-2024-4956-threads.py` æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´ã€‚ å®ƒé€šè¿‡æ„é€ åŒ…å«å¤šä¸ª `/%2F` å’Œ `../` åºåˆ—çš„ URL æ¥å°è¯•è¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„ `/etc/passwd` æ–‡ä»¶ã€‚å¦‚æœå“åº”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è„šæœ¬è®¤ä¸ºè¯¥ä¸»æœºå­˜åœ¨æ¼æ´ã€‚æä¾›çš„nucleiæ¨¡ç‰ˆå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
ä»£ç æœ¬èº«å®ç°çš„åŠŸèƒ½ä¸ºè¯»å–ç›®æ ‡æœºå™¨ä¸Šçš„æ–‡ä»¶ï¼Œä»ä»£ç åŠŸèƒ½ä¸Šåˆ¤æ–­ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ä»£ç çš„ä½œè€…å¯ä»¥åœ¨check_vulnerabilityå‡½æ•°ä¸­æ·»åŠ é¢å¤–çš„æ¶æ„ä»£ç ,ç”¨äºæ”¶é›†ç›®æ ‡ä¸»æœºçš„ä¿¡æ¯æˆ–è€…æ¤å…¥åé—¨ç¨‹åºï¼Œä½†ä»ç›®å‰çš„ä»£ç æ¥çœ‹ï¼Œæ²¡æœ‰å‘ç°ç›´æ¥çš„æŠ•æ¯’ä»£ç ã€‚README.md ä¸­çš„å£°æ˜ä¹Ÿæš—ç¤ºäº†é£é™©çš„å­˜åœ¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚å› ä¸ºä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œå¦‚æœå­˜åœ¨æ¶æ„ä»£ç å®¹æ˜“è¢«å‘ç°ã€‚ 

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚ `/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`ï¼‰çš„ URLã€‚
2.  Nexus Repository Manager 3 é”™è¯¯åœ°å¤„ç†è¯¥ URLï¼Œå…è®¸æ”»å‡»è€…è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç å’Œç³»ç»Ÿæ–‡ä»¶ã€‚
4.  ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬,å¯ä»¥æ‰¹é‡å¯¹ç›®æ ‡è¿›è¡Œæ‰«æ,è¯†åˆ«å­˜åœ¨æ¼æ´çš„ä¸»æœºã€‚
5.  æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„nucleiæ¨¡ç‰ˆï¼ŒåŒ…å«ä¸»åŠ¨æ‰«æå’Œè¢«åŠ¨æå–ç‰ˆæœ¬ï¼Œæ–¹ä¾¿æ¼æ´éªŒè¯

**é¡¹ç›®åœ°å€:** [JolyIrsb/CVE-2024-4956](https://github.com/JolyIrsb/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #6

**æ¥æº**: [CVE-2024-4956-Praison001_CVE-2024-4956-Sonatype-Nexus-Repository-Manager.md](../2024/CVE-2024-4956-Praison001_CVE-2024-4956-Sonatype-Nexus-Repository-Manager.md)

## CVE-2024-4956-Sonatype Nexus Repository Manager-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Managerå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆä¾‹å¦‚ `%2F` å’Œ `..`ï¼‰çš„ URLï¼Œè¯»å– Nexus Repository Manager æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„PoCä»£ç åŒ…å« Python å’Œ Bash ä¸¤ç§å®ç°ï¼Œéƒ½åˆ©ç”¨äº† URL ç¼–ç çš„è·¯å¾„éå†åºåˆ—æ¥è®¿é—®ç›®æ ‡æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªæˆæƒè®¿é—®ç³»ç»Ÿæ–‡ä»¶ï¼ŒPoC ä»£ç çš„ç›®çš„æ˜¯é€šè¿‡æ„é€ æ¶æ„ URL è¯»å–æœåŠ¡å™¨æ–‡ä»¶ã€‚PoCä»£ç ç»™å‡ºäº†Python3å’ŒBashä¸¤ç§åˆ©ç”¨æ–¹å¼ï¼Œå¹¶ä¸”æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒéªŒè¯äº†å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

PoC ä»£ç ï¼ˆ`exploitBash.sh` å’Œ `exploitPython.py`ï¼‰çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP GET è¯·æ±‚ä»¥åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å°è¯•æ‰§è¡Œæ¶æ„æ“ä½œï¼ˆä¾‹å¦‚ï¼Œå†™å…¥æ–‡ä»¶ã€æ‰§è¡Œå‘½ä»¤ï¼‰çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚è„šæœ¬çš„è¡Œä¸ºç¬¦åˆæ¼æ´æè¿°ï¼Œæ—¨åœ¨è¯»å–æŒ‡å®šæ–‡ä»¶å†…å®¹ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡Nexus Repository Managerå®ä¾‹çš„URLå’Œç«¯å£ï¼š**  ä¾‹å¦‚`http://127.0.0.1:8081`ã€‚
2.  **æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„æ¶æ„URLï¼š**  PoCä»£ç ä¸­ä½¿ç”¨äº†`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..{targetFile}`ï¼Œå…¶ä¸­`{targetFile}`æ˜¯è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  **å‘é€HTTP GETè¯·æ±‚ï¼š**  ä½¿ç”¨PoCä»£ç æä¾›çš„Pythonè„šæœ¬æˆ–Bashè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLã€ç«¯å£å’Œè¦è¯»å–çš„æ–‡ä»¶ã€‚
4.  **åˆ†æå“åº”ï¼š**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚å¦‚æœåˆ©ç”¨å¤±è´¥ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šè¿”å›é”™è¯¯ä»£ç æˆ–æ¶ˆæ¯ã€‚

**é˜²èŒƒæªæ–½ï¼š**

*   å‡çº§åˆ° Sonatype Nexus Repository Manager 3.68.1 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å‚è€ƒ Sonatype å®˜æ–¹æ–‡æ¡£ï¼Œå®æ–½é€‚å½“çš„ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager](https://github.com/Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #7

**æ¥æº**: [CVE-2024-4956-TypicalModMaker_CVE-2024-4956.md](../2024/CVE-2024-4956-TypicalModMaker_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Sonatype Nexus Repository Manager 3ï¼Œä¸”å…è®¸æœªæˆæƒç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨ç²¾å¿ƒæ„é€ çš„URLæ¥ä¸‹è½½ä»»æ„æ–‡ä»¶ã€‚`README.md`æ–‡ä»¶ä¸­æè¿°äº†ç›¸å…³çš„åˆ©ç”¨è„šæœ¬ï¼ŒåŒ…æ‹¬æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å®¹æ˜“å—åˆ°æ”»å‡» (`check-vulnerable-servers.py`)ï¼Œæ£€æŸ¥æ˜¯å¦ä»¥ root ç”¨æˆ·èº«ä»½è¿è¡Œ (`check-root-servers.py`)ï¼Œä»¥åŠå°è¯•ä½¿ç”¨æ‰¾åˆ°çš„ç§é’¥é€šè¿‡ SSH ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½• (`check-private_keys.py`)ã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š** ä»“åº“ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„è„šæœ¬ä¸»è¦ç”¨äºæ£€æµ‹å’Œåˆ©ç”¨æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ã€‚ä½†å­˜åœ¨è½»å¾®é£é™©ï¼Œä½“ç°åœ¨`check-private_keys.py`ï¼Œå¯èƒ½å­˜åœ¨æ”¶é›†ç§é’¥ç”¨äºå…¶ä»–ç›®çš„ï¼Œæ‰€ä»¥åˆ¤å®šæŠ•æ¯’é£é™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ä½¿ç”¨ Shodan ç­‰æœç´¢å¼•æ“æŸ¥æ‰¾æš´éœ²åœ¨ç½‘ç»œä¸Šçš„ Sonatype Nexus Repository Manager 3 å®ä¾‹ã€‚
2.  ä½¿ç”¨ `check-vulnerable-servers.py` è„šæœ¬éªŒè¯ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨ CVE-2024-4956 æ¼æ´ï¼Œé€šè¿‡å°è¯•è¯»å– `/etc/passwd` æ–‡ä»¶æ¥éªŒè¯ã€‚
3.  ï¼ˆå¦‚æœç›®æ ‡ä»¥ root èº«ä»½è¿è¡Œï¼‰ä½¿ç”¨ `check-root-servers.py` è„šæœ¬éªŒè¯ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å¯ä»¥è¯»å– `/etc/shadow` æ–‡ä»¶ã€‚
4.  ï¼ˆå¦‚æœç›®æ ‡ä»¥ root èº«ä»½è¿è¡Œï¼‰ä½¿ç”¨ `check-private_keys.py` è„šæœ¬æŸ¥æ‰¾å¸¸è§çš„ç§é’¥è·¯å¾„ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°è¯•ä½¿ç”¨è¿™äº›ç§é’¥é€šè¿‡ SSH ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½•ã€‚

**é¡¹ç›®åœ°å€:** [TypicalModMaker/CVE-2024-4956](https://github.com/TypicalModMaker/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #8

**æ¥æº**: [CVE-2024-4956-UMASANKAR-MG_Path-Traversal-CVE-2024-4956.md](../2024/CVE-2024-4956-UMASANKAR-MG_Path-Traversal-CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 - è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Manager 3å®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 30%

## è¯¦æƒ…

æ ¹æ®CVE-2024-4956çš„æè¿°ï¼ŒSonatype Nexus Repository Manager 3å­˜åœ¨ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚è¯¥æ¼æ´å·²åœ¨3.68.1ç‰ˆæœ¬ä¸­ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ä»æä¾›çš„æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå½±å“ã€‚ç½‘é¡µ0ã€1ã€2ã€3ã€5ã€6ã€7å’Œ8å‡æåˆ°äº†CVE-2024-4956æ˜¯ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚ç½‘é¡µ9æä¾›äº†åŒ…å«PoCä»£ç çš„GitHubé“¾æ¥ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

æä¾›çš„PoCä»£ç åŒ…å«å‡ ä¸ªæ–‡ä»¶ï¼š
* `LICENSE`ï¼šMITè®¸å¯è¯ã€‚
* `cve/README.md`ï¼šæ¼æ´æè¿°ã€å…è´£å£°æ˜ã€PoCè§†é¢‘é“¾æ¥ã€å¸®åŠ©èœå•ã€ä½œè€…ä¿¡æ¯å’Œåé¦ˆæ–¹å¼ã€‚
* `cve/main.py`ï¼šä¸»ç¨‹åºå…¥å£ï¼ŒåŒ…å«å‘½ä»¤è¡Œå‚æ•°è§£æå’Œæ¼æ´åˆ©ç”¨é€»è¾‘ã€‚
* `cve/setup.py`ï¼šç”¨äºæ‰“åŒ…å’Œå®‰è£…PoCå·¥å…·çš„setupæ–‡ä»¶ã€‚
* `cve/includes/__init__.py`ï¼šä¸€ä¸ªç©ºçš„åˆå§‹åŒ–æ–‡ä»¶
* `cve/includes/file.py`ï¼šä¸€ä¸ªæ–‡ä»¶è¯»å–ç›¸å…³çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä»£ç ä¸å®Œæ•´

ä»`cve/main.py`çš„ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥è„šæœ¬æ¥å—URLæˆ–æ–‡ä»¶åˆ—è¡¨ä½œä¸ºè¾“å…¥ï¼Œå¹¶è°ƒç”¨ç›¸åº”çš„æ¨¡å—è¿›è¡Œæ¼æ´æ‰«æã€‚å®ƒä½¿ç”¨äº†`argparse`åº“æ¥å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼Œå¹¶æ ¹æ®å‚æ•°è°ƒç”¨scan.cvescan(args.url,args.output) æˆ–è€… file.reader(args.list,args.output)è¿›è¡Œåç»­å¤„ç†ã€‚
è™½ç„¶file.readerä»£ç ä¸å®Œæ•´ï¼Œä½†æ˜¯ç»“åˆgithubä¸Šçš„å…¶ä»–ä¿¡æ¯å¯ä»¥æ¨æµ‹å‡ºå…¶åŸºæœ¬çš„åŠŸèƒ½æ˜¯å‘é€å«æœ‰../çš„è¯·æ±‚åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆæ­¥åˆ†æï¼ŒPoCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ï¼Œä½†å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºä½œè€…UMASANKAR-MGåœ¨`README.md`ä¸­åŠ å…¥å…è´£å£°æ˜ï¼Œå¯èƒ½æš—ç¤ºå­˜åœ¨æœªå…¬å¼€çš„æ¶æ„åŠŸèƒ½ã€‚`setup.py`ä½¿ç”¨ç®€å•çš„'Path Traversal = cve.main:main' å…¥å£ç‚¹, é™ä½äº†åˆ†æçš„éš¾åº¦.

*   **å¯ç–‘ç‚¹ï¼š** å…è´£å£°æ˜å’Œä½œè€…ä¿¡æ¯å¯èƒ½æ©ç›–çœŸå®ç›®çš„ã€‚
*   **é£é™©ç‚¹ï¼š**  `cve/includes/file.py` ä»£ç ä¸å®Œæ•´ï¼Œå¯èƒ½åŒ…å«æ¶æ„ä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ã€‚`scan.cvescan`å‡½æ•°ä¹Ÿéœ€è¦è¿›ä¸€æ­¥åˆ†æï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨æ¶æ„è¡Œä¸ºã€‚

ç»¼åˆè¯„ä¼°ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†é£é™©ç¨‹åº¦ä¸é«˜ï¼Œå¤§çº¦ä¸º30%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆä¾‹å¦‚`../`ï¼‰çš„æ¶æ„URLã€‚
2.  æ”»å‡»è€…å‘é€è¯¥æ¶æ„URLåˆ°ç›®æ ‡Nexus Repository Manager 3æœåŠ¡å™¨ã€‚
3.  æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯URLï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿè¯»å–ä»»æ„æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…è·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ã€‚

**PoCä½¿ç”¨æ–¹å¼ï¼š**

ä»cve/main.pyå¯ä»¥çœ‹åˆ°ï¼Œä¸»è¦ç”±ä¸¤ç§æ–¹å¼ä½¿ç”¨è¿™ä¸ªPOCã€‚
1.  `-u/--url`ï¼šæŒ‡å®šç›®æ ‡URLï¼Œç”¨äºå¯¹å•ä¸ªç›®æ ‡è¿›è¡Œæ‰«æ
2.  `-l/--list`ï¼šæŒ‡å®šåŒ…å«ç›®æ ‡URLåˆ—è¡¨çš„æ–‡ä»¶ï¼Œç”¨äºæ‰¹é‡æ‰«æ
3.  `-o/--output`ï¼šæŒ‡å®šè¾“å‡ºæ–‡ä»¶åï¼Œå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­
4.  `-b/--blog`ï¼šæ‰“å¼€åŒ…å«å…³äºè¯¥æ¼æ´çš„æ›´å¤šä¿¡æ¯çš„åšå®¢é¡µé¢

ä¾‹å¦‚ï¼š
`python main.py -u http://example.com/ -o output.txt`

**æ€»ç»“ï¼š**

CVE-2024-4956æ˜¯ä¸€ä¸ªé«˜å±çš„è·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚PoCä»£ç çš„å­˜åœ¨è¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ï¼Œä½†éœ€è¦æ³¨æ„æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½¿ç”¨æ—¶åº”è°¨æ…ã€‚

**é¡¹ç›®åœ°å€:** [UMASANKAR-MG/Path-Traversal-CVE-2024-4956](https://github.com/UMASANKAR-MG/Path-Traversal-CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #9

**æ¥æº**: [CVE-2024-4956-XiaomingX_cve-2024-4956.md](../2024/CVE-2024-4956-XiaomingX_cve-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** Path Traversal

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 3.0.0 <= version <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956æ˜¯Sonatype Nexus Repository Manager 3ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“3.0.0åˆ°3.68.0ç‰ˆæœ¬ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„URLæ¥è®¿é—®ç³»ç»Ÿæ–‡ä»¶ã€‚ ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæ˜¯Apache License 2.0çš„æ–‡æœ¬ï¼Œå¹¶ä¸æ˜¯å®é™…çš„æ”»å‡»è„šæœ¬ï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚ ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å·²ç»å¾—åˆ°ç¡®è®¤ï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POCã€‚ ç”±äºæä¾›çš„ä»£ç ä»…ä¸ºLicenseæ–‡æœ¬ï¼Œå› æ­¤å¯ä»¥åˆ¤å®šæ­¤ä»£ç æ®µä¸åŒ…å«ä»»ä½•æŠ•æ¯’ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [XiaomingX/cve-2024-4956](https://github.com/XiaomingX/cve-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #10

**æ¥æº**: [CVE-2024-4956-art-of-defence_CVE-2024-4956.md](../2024/CVE-2024-4956-art-of-defence_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Managerå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ï¼Œæ˜¯ä¸€ä¸ªæœªç»éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URL è®¿é—®æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ä¸‹è½½æ•æ„Ÿçš„ç³»ç»Ÿæ–‡ä»¶ã€åº”ç”¨ç¨‹åºæºä»£ç å’Œé…ç½®ä¿¡æ¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `CVE-2024-4956_detect.py` é€šè¿‡å‘é€åŒ…å«è·¯å¾„éå†payloadçš„HTTP GETè¯·æ±‚æ¥éªŒè¯ç›®æ ‡æ˜¯å¦æ˜“å—æ”»å‡»ã€‚è¯¥è„šæœ¬æ£€æŸ¥å“åº”ä¸­æ˜¯å¦åŒ…å« 'root' å­—ç¬¦ä¸²ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦æˆåŠŸè¯»å–äº† `/etc/passwd` æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¸”å½±å“èŒƒå›´å¹¿æ³›ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç›´æ¥éªŒè¯è¯¥æ¼æ´çš„å­˜åœ¨æ€§ï¼Œå› æ­¤æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æŸ¥çœ‹æä¾›çš„ POC ä»£ç  `CVE-2024-4956_detect.py` å’Œ `README.md`ã€‚è¯¥è„šæœ¬ä»…ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` åªæ˜¯å¯¹è„šæœ¬çš„ç®€å•æè¿°ã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ URLï¼Œä¾‹å¦‚ï¼š`http://<ç›®æ ‡IP>:<ç«¯å£>/%2F%2F%2F%2E%2E%2F%2F%2E%2F%2F%2E%2E%2F%2F%2F%2E%2E%2F%2F%2E%2E%2F%2E%2F%65%74%63%2F%70%61%73%73%77%64`ã€‚
2.  Nexus Repository Manager 3 å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæœªæ­£ç¡®éªŒè¯è·¯å¾„ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ URL ä¸­çš„è·¯å¾„ï¼Œè¯»å–å…¶ä»–æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æ•°æ®åº“è¿æ¥ä¿¡æ¯ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [art-of-defence/CVE-2024-4956](https://github.com/art-of-defence/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #11

**æ¥æº**: [CVE-2024-4956-banditzCyber0x_CVE-2024-4956.md](../2024/CVE-2024-4956-banditzCyber0x_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨å¼€å¯ä¸”å¯ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ï¼Œæ˜¯ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/passwd ç­‰æ•æ„Ÿæ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œæ­¤æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚NVD å’Œå…¶ä»–å®‰å…¨æœºæ„å‡å·²ç¡®è®¤è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³ä¿¡æ¯ã€‚POC ä»£ç é€šè¿‡æ„é€ åŒ…å« "%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd" çš„ URL æ¥è®¿é—® /etc/passwd æ–‡ä»¶ï¼Œå¦‚æœè¿”å›åŒ…å« "root:.*:0:0" çš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šCVE-2024-4956.yaml å’Œ README.mdã€‚YAML æ–‡ä»¶åŒ…å« Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚ README.md æ–‡ä»¶åŒ…å«æ¼æ´çš„ç®€å•æè¿°å’Œä¸€ä¸ªå›¾ç‰‡é“¾æ¥ï¼Œè¯¥å›¾ç‰‡é“¾æ¥æŒ‡å‘ githubusercontent.comï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œä»æ•´ä½“é¡¹ç›®æ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½ä¿®æ”¹ YAML æ–‡ä»¶æˆ–åœ¨å…¶ä»–åœ°æ–¹æ·»åŠ æ¶æ„ä»£ç ã€‚ ç»¼åˆè€ƒè™‘ï¼Œåˆ¤å®šæŠ•æ¯’é£é™©ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç¡®å®šç›®æ ‡æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ Nexus Repository Manager 3 ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (<= 3.68.0)ã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URLï¼Œä¾‹å¦‚ï¼š`{{BaseURL}}/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€ GET è¯·æ±‚ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› /etc/passwd æ–‡ä»¶å†…å®¹ï¼Œåˆ™æ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [banditzCyber0x/CVE-2024-4956](https://github.com/banditzCyber0x/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #12

**æ¥æº**: [CVE-2024-4956-erickfernandox_CVE-2024-4956.md](../2024/CVE-2024-4956-erickfernandox_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ä»»æ„ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œéœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚ `../`ï¼‰çš„æ¶æ„ URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚NVDã€Broadcomã€INCIBE-CERTã€Acunetix ç­‰å¤šä¸ªæ¥æºå‡ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚æä¾›çš„ YAML æ ¼å¼çš„ Nuclei æ¨¡æ¿å’Œ PoC æ˜¾ç¤ºäº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è¿™äº›ä¿¡æ¯éƒ½è¯æ˜äº†è¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `CVE-2024-4956.yaml` å’Œ `README.md` æ–‡ä»¶ï¼Œå‘ç°å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚Nuclei æ¨¡æ¿çš„åŠŸèƒ½æ˜¯å‘é€åŒ…å«ç›®å½•éå†åºåˆ—çš„ HTTP GET è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå“åº”ä½“å†…å®¹åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚README æ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°ã€å—å½±å“ç‰ˆæœ¬ã€ç¼“è§£æªæ–½å’Œ PoCã€‚æ•´ä¸ªä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæ¼æ´éªŒè¯å·¥å…·ï¼Œè€Œä¸æ˜¯ä¼ æ’­æ¶æ„è½¯ä»¶ã€‚ä½†æ˜¯ä¸æ’é™¤ä½œè€…åœ¨å…¶ä»–ç‰ˆæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç , æ•…ç»™å‡º5%çš„æŠ•æ¯’æ¦‚ç‡.

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„æ¶æ„ URLï¼Œä¾‹å¦‚ï¼š`{{BaseURL}}/%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f../etc/passwd`ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡ Nexus Repository Manager 3 æœåŠ¡å™¨å‘é€ HTTP GET è¯·æ±‚ï¼Œè¯·æ±‚è¯¥æ¶æ„ URLã€‚
3.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å› `/etc/passwd` æ–‡ä»¶çš„å†…å®¹ï¼Œæ”»å‡»è€…ä»è€Œè¯»å–åˆ°æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [erickfernandox/CVE-2024-4956](https://github.com/erickfernandox/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #13

**æ¥æº**: [CVE-2024-4956-fin3ss3g0d_CVE-2024-4956.md](../2024/CVE-2024-4956-fin3ss3g0d_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„ Nexus Repository Managerã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ 3.68.1 ä¹‹å‰çš„ Sonatype Nexus Repository Manager 3.x ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç  `cve-2024-4956.py` æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨è‡ªåŠ¨åŒ–åˆ©ç”¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„URLï¼Œå°è¯•è®¿é—®æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š
    *   æŒ‡å®šç›®æ ‡æœåŠ¡å™¨çš„URLã€‚
    *   æŒ‡å®šåŒ…å«è¦æµ‹è¯•çš„æ–‡ä»¶è·¯å¾„åˆ—è¡¨çš„æ–‡æœ¬æ–‡ä»¶ã€‚
    *   ä½¿ç”¨HTTPä»£ç†ï¼ˆå¯é€‰ï¼‰ã€‚
    *   æµ‹è¯•æ¨¡å¼ä»¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚
    *   æŒ‡å®šç”¨äºéå†æµ‹è¯•çš„ç›¸å¯¹è·¯å¾„ã€‚
è„šæœ¬é€šè¿‡æ›¿æ¢ `/` ä¸º `%2F` æ¥ç»•è¿‡URLç¼–ç é™åˆ¶ï¼Œç„¶åå‘é€HTTP GETè¯·æ±‚ã€‚æ ¹æ®å…¶è®¾è®¡ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„Pythonä»£ç ï¼Œå‘ç°è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellã€æ¶æ„æ–‡ä»¶ä¸Šä¼ ç­‰ã€‚ä½†æ˜¯ï¼Œè„šæœ¬çš„ä½œè€…åœ¨READMEä¸­æä¾›äº†ä¸€ä¸ªApache Shiro 1 çš„Hashcat æ¨¡å—ï¼Œå¹¶æä¾›äº†gité“¾æ¥ã€‚è™½ç„¶è¯¥æ¨¡å—æœ¬èº«æ˜¯ç”¨äºå¯†ç ç ´è§£çš„å·¥å…·ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨çš„é£é™©ã€‚è¯¥repositoryä¸­LICENSEæ–‡ä»¶æ˜¯æ ‡å‡†çš„MIT licenseï¼Œæ›´è¶‹å‘äºæ­£å¸¸åˆ©ç”¨.
ä»£ç ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§æä½ï¼Œé£é™©è¯„ä¼°ä¸º 1%ã€‚ä¸»è¦é£é™©æ¥è‡ªä½¿ç”¨è€…åˆ©ç”¨æ­¤å·¥å…·è¿›è¡Œéæˆæƒçš„æ¸—é€æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„æ¶æ„URLï¼Œä¾‹å¦‚ `http://target/service/local/artifact/maven/content?r=central&g=org.apache.shiro&a=shiro-core&v=1.2.2&p=jar&filepath=../../../../../../etc/passwd`ã€‚
2.  Nexus Repository Manager æœªæ­£ç¡®éªŒè¯URLä¸­çš„æ–‡ä»¶è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥ä½¿ç”¨æ­¤æ¼æ´è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€é…ç½®æ–‡ä»¶å’Œå…¶ä»–æ•æ„Ÿä¿¡æ¯ã€‚
4.  å¯ä»¥ç»“åˆå…¶ä»–æ¼æ´ï¼Œä¾‹å¦‚shiroçš„æ¼æ´ï¼Œæ¥æ‰©å¤§æ”»å‡»é¢ã€‚

**é¡¹ç›®åœ°å€:** [fin3ss3g0d/CVE-2024-4956](https://github.com/fin3ss3g0d/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #14

**æ¥æº**: [CVE-2024-4956-gmh5225_CVE-2024-4956.md](../2024/CVE-2024-4956-gmh5225_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒSonatype Nexus Repository Manager 3ï¼Œä¸”ç‰ˆæœ¬ä½äºæˆ–ç­‰äº3.68.0ï¼Œç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ `/etc/passwd`ã€‚ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ä¸€ä¸ªGETè¯·æ±‚ï¼Œå…¶ä¸­URLåŒ…å«å¤§é‡ `/%2f` å’Œ `../` çš„ç»„åˆï¼Œç”¨äºç»•è¿‡è·¯å¾„æ£€æŸ¥ï¼Œæœ€ç»ˆè®¿é—®åˆ° `/etc/passwd` æ–‡ä»¶ã€‚YAMLæ–‡ä»¶ä¸­çš„Nucleiæ¨¡æ¿æ˜ç¡®æŒ‡å‡ºäº†è¿™ä¸€ç‚¹ï¼Œå¹¶æä¾›äº†ç›¸åº”çš„æ­£åˆ™è¡¨è¾¾å¼æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚æœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºå®ƒå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…è®¿é—®å’Œä¸‹è½½æ•æ„Ÿç³»ç»Ÿæ–‡ä»¶ï¼Œåº”ç”¨ç¨‹åºæºä»£ç å’Œé…ç½®ã€‚è¯¥POCä»£ç ä»…ç”¨äºè¯»å–æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°å­˜åœ¨æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [gmh5225/CVE-2024-4956](https://github.com/gmh5225/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #15

**æ¥æº**: [CVE-2024-4956-ifconfig-me_CVE-2024-4956-Bulk-Scanner.md](../2024/CVE-2024-4956-ifconfig-me_CVE-2024-4956-Bulk-Scanner.md)

## CVE-2024-4956 Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Sonatype Nexus Repository Manager 3ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®è¯¥æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚PoC ä»£ç  `CVE-2024-4956-scanner.py` æ˜¯ä¸€ä¸ªæ‰¹é‡æ‰«æå™¨ï¼Œå®ƒä»æ–‡ä»¶ä¸­è¯»å–åŸŸåå’Œpayloadsï¼Œç„¶åå‘æ¯ä¸ªåŸŸåå‘é€åŒ…å« payload çš„è¯·æ±‚ã€‚å¦‚æœå“åº”åŒ…å«"root:"å­—ç¬¦ä¸²ï¼ˆé€šå¸¸åœ¨ `/etc/passwd` æ–‡ä»¶ä¸­ï¼‰ï¼Œåˆ™è®¤ä¸ºè¯¥URLå­˜åœ¨æ¼æ´å¹¶å°†å…¶å†™å…¥ `successful_urls.txt` æ–‡ä»¶ä¸­ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¸”PoCä»£ç æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´ï¼Œå› æ­¤PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å†…å®¹ã€‚ä»£ç ä¸­åŒ…å«äº†ä¸€äº›æ‰“å°è¯­å¥å’Œæ–‡ä»¶å†™å…¥æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ‰«ææ¼æ´ï¼Œå¹¶è®°å½•æˆåŠŸåˆ©ç”¨çš„URLï¼Œè€Œä¸æ˜¯ä¿®æ”¹æˆ–ç ´åç›®æ ‡ç³»ç»Ÿã€‚
*   è™½ç„¶å­˜åœ¨æ–‡ä»¶å†™å…¥æ“ä½œ (`successful_urls.txt`)ï¼Œä½†è¿™ä»…ç”¨äºè®°å½•ç›®çš„ï¼Œä¸ä¼šæ‰§è¡Œä»»ä½•æ½œåœ¨çš„æ¶æ„æ“ä½œã€‚
*   ä»£ç çš„æ‰€æœ‰æ“ä½œéƒ½ä¸å…¶å£°æ˜çš„ç›®æ ‡ä¸€è‡´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—æˆ–æœªè®°å½•çš„åŠŸèƒ½ã€‚

å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©éå¸¸ä½ã€‚è€ƒè™‘åˆ°ä»£ç çš„ç®€å•æ€§å’ŒåŠŸèƒ½çš„é€æ˜æ€§ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…éœ€è¦ä¸€ä¸ªåŒ…å«ç›®æ ‡Nexus Repository Managerå®ä¾‹URLçš„åˆ—è¡¨ã€‚
2.  æ”»å‡»è€…éœ€è¦ä¸€ä¸ªåŒ…å«è·¯å¾„éå†payloadçš„åˆ—è¡¨ï¼Œä¾‹å¦‚ `../../../../etc/passwd`ã€‚
3.  è¿è¡ŒPoCè„šæœ¬ `CVE-2024-4956-scanner.py`ï¼Œå¹¶æä¾›åŒ…å«URLåˆ—è¡¨å’Œpayloadåˆ—è¡¨çš„æ–‡ä»¶è·¯å¾„ã€‚
4.  è¯¥è„šæœ¬ä¼šå‘æ¯ä¸ªURLå‘é€åŒ…å«payloadçš„è¯·æ±‚ã€‚
5.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å›è¢«è¯»å–çš„æ–‡ä»¶å†…å®¹ã€‚è„šæœ¬å°†æ£€æµ‹`/etc/passwd`æ–‡ä»¶ä¸­çš„â€œroot:â€å­—ç¬¦ä¸²ä»¥åˆ¤æ–­æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚
6.  åˆ©ç”¨æˆåŠŸçš„URLå°†è¢«è®°å½•åœ¨`successful_urls.txt`æ–‡ä»¶ä¸­ã€‚

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æ•æ„Ÿçš„ç³»ç»Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ï¼Œä»è€Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–è¿›ä¸€æ­¥åˆ©ç”¨ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [ifconfig-me/CVE-2024-4956-Bulk-Scanner](https://github.com/ifconfig-me/CVE-2024-4956-Bulk-Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #16

**æ¥æº**: [CVE-2024-4956-thinhap_CVE-2024-4956-PoC.md](../2024/CVE-2024-4956-thinhap_CVE-2024-4956-PoC.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ github ä¸Šçš„ POCï¼‰å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œåˆ©ç”¨`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`è¿™æ ·çš„payloadæ¥è¯»å–`/etc/passwd`æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å°±æ˜¯ä¸€ä¸ªè¯»å–`/etc/passwd`æ–‡ä»¶çš„ HTTP GET è¯·æ±‚ç¤ºä¾‹ï¼Œå› æ­¤åˆ¤æ–­ POC ä»£ç æœ‰æ•ˆã€‚

å…³äºæŠ•æ¯’é£é™©ï¼Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (`README.md`)ä»…åŒ…å« HTTP è¯·æ±‚ç¤ºä¾‹å’Œä¸€å¼ æˆåŠŸåˆ©ç”¨æ¼æ´çš„æˆªå›¾ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ä»¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç æˆ–å‘½ä»¤ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1. æ„é€ åŒ…å«è·¯å¾„éå†çš„ URLã€‚
2. å‘å—å½±å“çš„ Sonatype Nexus Repository Manager 3 å®ä¾‹å‘é€æ„é€ çš„ URL è¯·æ±‚ã€‚
3. å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼Œåˆ™æœåŠ¡å™¨ä¼šè¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [thinhap/CVE-2024-4956-PoC](https://github.com/thinhap/CVE-2024-4956-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #17

**æ¥æº**: [CVE-2024-4956-verylazytech_CVE-2024-4956.md](../2024/CVE-2024-4956-verylazytech_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“çš„Sonatype Nexus Repository Manager 3ç‰ˆæœ¬ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢å¼•æ“ç»“æœä¸­å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠæœªç»èº«ä»½éªŒè¯çš„è¯»å–ç³»ç»Ÿæ–‡ä»¶çš„èƒ½åŠ›ã€‚æä¾›çš„ Python POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹æ®Šæ„é€ çš„ URL å°è¯•è¯»å– `/etc/passwd` å’Œ `/etc/shadow` æ–‡ä»¶æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ POC ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚å¹¶æ£€æŸ¥å“åº”å†…å®¹ï¼Œä»¥ç¡®è®¤æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€»è¾‘æ¯”è¾ƒç›´æ¥ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•è¯•å›¾åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…åé—¨æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—ï¼ˆä¾‹å¦‚ `../`ï¼‰çš„æ¶æ„ URLã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„ URL å‘é€åˆ°å—å½±å“çš„ Sonatype Nexus Repository Manager 3 æœåŠ¡å™¨ã€‚
3.  æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯ URL ä¸­çš„è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…è¯»å–åˆ°æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚ `/etc/passwd` æˆ– `/etc/shadow`ã€‚

ä¾‹å¦‚ï¼ŒPOC ä»£ç ä¸­ä½¿ç”¨çš„ URL å¦‚ä¸‹ï¼š
`http://<ip_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F../etc/passwd`

æ­¤ URL å°è¯•é€šè¿‡è·¯å¾„éå†è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šè¯»å–æ•æ„Ÿä¿¡æ¯ï¼Œä»è€Œå¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-4956](https://github.com/verylazytech/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #18

**æ¥æº**: [CVE-2024-4956-xungzzz_CVE-2024-4956.md](../2024/CVE-2024-4956-xungzzz_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository 3-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** Path Traversal

**å½±å“åº”ç”¨:** Nexus Repository 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository 3æœåŠ¡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956æ˜¯Sonatype Nexus Repository 3ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„URLè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç å°è¯•é€šè¿‡è·¯å¾„éå†è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸè¯»å–åˆ°åŒ…å«"root:"çš„å“åº”ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©:**
PoCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œæ—¨åœ¨è¯»å–`/etc/passwd`æ–‡ä»¶ã€‚æŠ•æ¯’ä»£ç å¯èƒ½å­˜åœ¨äºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **æµ‹è¯•æ¡†æ¶æœ¬èº«çš„é£é™©ï¼š**å¦‚æœä½¿ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶æ‰§è¡Œæ­¤PoCï¼Œæ¡†æ¶å¯èƒ½è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œä½†yamlæ–‡ä»¶æœ¬èº«ä¸å…·å¤‡æ­¤ç‰¹æ€§ã€‚
2.  **ä¸‹è½½æºçš„é£é™©ï¼š**å¦‚æœyamlæ–‡ä»¶ä¸æ˜¯ä»å¯ä¿¡çš„æºä¸‹è½½ï¼Œä¸‹è½½è¿‡ç¨‹ä¸­å¯èƒ½è¢«ç¯¡æ”¹ã€‚
è€ƒè™‘åˆ°yamlæ–‡ä»¶çš„ç®€å•æ€§ä»¥åŠPoCçš„æ€§è´¨ï¼Œç›´æ¥åœ¨PoCä¸­æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„URLï¼Œä¾‹å¦‚`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`ã€‚
2.  æ”»å‡»è€…å‘é€GETè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„Nexus Repository 3æœåŠ¡å™¨ã€‚
3.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œå°†è¿”å›`/etc/passwd`æ–‡ä»¶çš„å†…å®¹ï¼Œå¦åˆ™è¿”å›é”™è¯¯ä¿¡æ¯ã€‚
4.  æ”»å‡»è€…å¯ä»¥æ›¿æ¢`/etc/passwd`ä¸ºå…¶ä»–æ•æ„Ÿæ–‡ä»¶è·¯å¾„ï¼Œä»¥è¯»å–å…¶ä»–æ–‡ä»¶å†…å®¹ã€‚

**æ’åºä¼˜å…ˆçº§è¯´æ˜:**
å°½ç®¡æ¼æ´åº“ä¿¡æ¯æä¾›äº†æ¼æ´çš„åŸºæœ¬ä¿¡æ¯ï¼Œä½†æœç´¢å¼•æ“ç»“æœæä¾›äº†æ›´å¹¿æ³›çš„å‚è€ƒä¿¡æ¯ï¼ŒåŒ…æ‹¬å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œå¯èƒ½çš„ç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æ˜¯éªŒè¯æ¼æ´å­˜åœ¨çš„ç›´æ¥è¯æ®ï¼Œå› æ­¤æ¼æ´åˆ©ç”¨ä»£ç çš„ä¼˜å…ˆçº§é«˜äºæ¼æ´åº“ä¿¡æ¯ï¼Œè€Œæœç´¢å¼•æ“ç»“æœçš„ä¼˜å…ˆçº§é«˜äºæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ˜¯å› ä¸ºæœç´¢å¼•æ“ç»“æœå¯ä»¥æä¾›æ›´å…¨é¢çš„ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [xungzzz/CVE-2024-4956](https://github.com/xungzzz/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---



---

## POC #10

**æ¥æº**: [CVE-2024-4956-art-of-defence_CVE-2024-4956.md](../2024/CVE-2024-4956-art-of-defence_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Managerå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ï¼Œæ˜¯ä¸€ä¸ªæœªç»éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URL è®¿é—®æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ä¸‹è½½æ•æ„Ÿçš„ç³»ç»Ÿæ–‡ä»¶ã€åº”ç”¨ç¨‹åºæºä»£ç å’Œé…ç½®ä¿¡æ¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `CVE-2024-4956_detect.py` é€šè¿‡å‘é€åŒ…å«è·¯å¾„éå†payloadçš„HTTP GETè¯·æ±‚æ¥éªŒè¯ç›®æ ‡æ˜¯å¦æ˜“å—æ”»å‡»ã€‚è¯¥è„šæœ¬æ£€æŸ¥å“åº”ä¸­æ˜¯å¦åŒ…å« 'root' å­—ç¬¦ä¸²ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦æˆåŠŸè¯»å–äº† `/etc/passwd` æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¸”å½±å“èŒƒå›´å¹¿æ³›ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç›´æ¥éªŒè¯è¯¥æ¼æ´çš„å­˜åœ¨æ€§ï¼Œå› æ­¤æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æŸ¥çœ‹æä¾›çš„ POC ä»£ç  `CVE-2024-4956_detect.py` å’Œ `README.md`ã€‚è¯¥è„šæœ¬ä»…ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` åªæ˜¯å¯¹è„šæœ¬çš„ç®€å•æè¿°ã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ URLï¼Œä¾‹å¦‚ï¼š`http://<ç›®æ ‡IP>:<ç«¯å£>/%2F%2F%2F%2E%2E%2F%2F%2E%2F%2F%2E%2E%2F%2F%2F%2E%2E%2F%2F%2E%2E%2F%2E%2F%65%74%63%2F%70%61%73%73%77%64`ã€‚
2.  Nexus Repository Manager 3 å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæœªæ­£ç¡®éªŒè¯è·¯å¾„ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ URL ä¸­çš„è·¯å¾„ï¼Œè¯»å–å…¶ä»–æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æ•°æ®åº“è¿æ¥ä¿¡æ¯ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [art-of-defence/CVE-2024-4956](https://github.com/art-of-defence/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #11

**æ¥æº**: [CVE-2024-4956-banditzCyber0x_CVE-2024-4956.md](../2024/CVE-2024-4956-banditzCyber0x_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨å¼€å¯ä¸”å¯ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ï¼Œæ˜¯ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/passwd ç­‰æ•æ„Ÿæ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œæ­¤æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚NVD å’Œå…¶ä»–å®‰å…¨æœºæ„å‡å·²ç¡®è®¤è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³ä¿¡æ¯ã€‚POC ä»£ç é€šè¿‡æ„é€ åŒ…å« "%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd" çš„ URL æ¥è®¿é—® /etc/passwd æ–‡ä»¶ï¼Œå¦‚æœè¿”å›åŒ…å« "root:.*:0:0" çš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šCVE-2024-4956.yaml å’Œ README.mdã€‚YAML æ–‡ä»¶åŒ…å« Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚ README.md æ–‡ä»¶åŒ…å«æ¼æ´çš„ç®€å•æè¿°å’Œä¸€ä¸ªå›¾ç‰‡é“¾æ¥ï¼Œè¯¥å›¾ç‰‡é“¾æ¥æŒ‡å‘ githubusercontent.comï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œä»æ•´ä½“é¡¹ç›®æ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½ä¿®æ”¹ YAML æ–‡ä»¶æˆ–åœ¨å…¶ä»–åœ°æ–¹æ·»åŠ æ¶æ„ä»£ç ã€‚ ç»¼åˆè€ƒè™‘ï¼Œåˆ¤å®šæŠ•æ¯’é£é™©ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç¡®å®šç›®æ ‡æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ Nexus Repository Manager 3 ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (<= 3.68.0)ã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URLï¼Œä¾‹å¦‚ï¼š`{{BaseURL}}/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€ GET è¯·æ±‚ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› /etc/passwd æ–‡ä»¶å†…å®¹ï¼Œåˆ™æ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [banditzCyber0x/CVE-2024-4956](https://github.com/banditzCyber0x/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #12

**æ¥æº**: [CVE-2024-4956-erickfernandox_CVE-2024-4956.md](../2024/CVE-2024-4956-erickfernandox_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ä»»æ„ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œéœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚ `../`ï¼‰çš„æ¶æ„ URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚NVDã€Broadcomã€INCIBE-CERTã€Acunetix ç­‰å¤šä¸ªæ¥æºå‡ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚æä¾›çš„ YAML æ ¼å¼çš„ Nuclei æ¨¡æ¿å’Œ PoC æ˜¾ç¤ºäº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è¿™äº›ä¿¡æ¯éƒ½è¯æ˜äº†è¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `CVE-2024-4956.yaml` å’Œ `README.md` æ–‡ä»¶ï¼Œå‘ç°å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚Nuclei æ¨¡æ¿çš„åŠŸèƒ½æ˜¯å‘é€åŒ…å«ç›®å½•éå†åºåˆ—çš„ HTTP GET è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå“åº”ä½“å†…å®¹åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚README æ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°ã€å—å½±å“ç‰ˆæœ¬ã€ç¼“è§£æªæ–½å’Œ PoCã€‚æ•´ä¸ªä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæ¼æ´éªŒè¯å·¥å…·ï¼Œè€Œä¸æ˜¯ä¼ æ’­æ¶æ„è½¯ä»¶ã€‚ä½†æ˜¯ä¸æ’é™¤ä½œè€…åœ¨å…¶ä»–ç‰ˆæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç , æ•…ç»™å‡º5%çš„æŠ•æ¯’æ¦‚ç‡.

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„æ¶æ„ URLï¼Œä¾‹å¦‚ï¼š`{{BaseURL}}/%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f../etc/passwd`ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡ Nexus Repository Manager 3 æœåŠ¡å™¨å‘é€ HTTP GET è¯·æ±‚ï¼Œè¯·æ±‚è¯¥æ¶æ„ URLã€‚
3.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å› `/etc/passwd` æ–‡ä»¶çš„å†…å®¹ï¼Œæ”»å‡»è€…ä»è€Œè¯»å–åˆ°æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [erickfernandox/CVE-2024-4956](https://github.com/erickfernandox/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #13

**æ¥æº**: [CVE-2024-4956-fin3ss3g0d_CVE-2024-4956.md](../2024/CVE-2024-4956-fin3ss3g0d_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„ Nexus Repository Managerã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ 3.68.1 ä¹‹å‰çš„ Sonatype Nexus Repository Manager 3.x ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç  `cve-2024-4956.py` æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨è‡ªåŠ¨åŒ–åˆ©ç”¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„URLï¼Œå°è¯•è®¿é—®æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š
    *   æŒ‡å®šç›®æ ‡æœåŠ¡å™¨çš„URLã€‚
    *   æŒ‡å®šåŒ…å«è¦æµ‹è¯•çš„æ–‡ä»¶è·¯å¾„åˆ—è¡¨çš„æ–‡æœ¬æ–‡ä»¶ã€‚
    *   ä½¿ç”¨HTTPä»£ç†ï¼ˆå¯é€‰ï¼‰ã€‚
    *   æµ‹è¯•æ¨¡å¼ä»¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚
    *   æŒ‡å®šç”¨äºéå†æµ‹è¯•çš„ç›¸å¯¹è·¯å¾„ã€‚
è„šæœ¬é€šè¿‡æ›¿æ¢ `/` ä¸º `%2F` æ¥ç»•è¿‡URLç¼–ç é™åˆ¶ï¼Œç„¶åå‘é€HTTP GETè¯·æ±‚ã€‚æ ¹æ®å…¶è®¾è®¡ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„Pythonä»£ç ï¼Œå‘ç°è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellã€æ¶æ„æ–‡ä»¶ä¸Šä¼ ç­‰ã€‚ä½†æ˜¯ï¼Œè„šæœ¬çš„ä½œè€…åœ¨READMEä¸­æä¾›äº†ä¸€ä¸ªApache Shiro 1 çš„Hashcat æ¨¡å—ï¼Œå¹¶æä¾›äº†gité“¾æ¥ã€‚è™½ç„¶è¯¥æ¨¡å—æœ¬èº«æ˜¯ç”¨äºå¯†ç ç ´è§£çš„å·¥å…·ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨çš„é£é™©ã€‚è¯¥repositoryä¸­LICENSEæ–‡ä»¶æ˜¯æ ‡å‡†çš„MIT licenseï¼Œæ›´è¶‹å‘äºæ­£å¸¸åˆ©ç”¨.
ä»£ç ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§æä½ï¼Œé£é™©è¯„ä¼°ä¸º 1%ã€‚ä¸»è¦é£é™©æ¥è‡ªä½¿ç”¨è€…åˆ©ç”¨æ­¤å·¥å…·è¿›è¡Œéæˆæƒçš„æ¸—é€æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„æ¶æ„URLï¼Œä¾‹å¦‚ `http://target/service/local/artifact/maven/content?r=central&g=org.apache.shiro&a=shiro-core&v=1.2.2&p=jar&filepath=../../../../../../etc/passwd`ã€‚
2.  Nexus Repository Manager æœªæ­£ç¡®éªŒè¯URLä¸­çš„æ–‡ä»¶è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥ä½¿ç”¨æ­¤æ¼æ´è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€é…ç½®æ–‡ä»¶å’Œå…¶ä»–æ•æ„Ÿä¿¡æ¯ã€‚
4.  å¯ä»¥ç»“åˆå…¶ä»–æ¼æ´ï¼Œä¾‹å¦‚shiroçš„æ¼æ´ï¼Œæ¥æ‰©å¤§æ”»å‡»é¢ã€‚

**é¡¹ç›®åœ°å€:** [fin3ss3g0d/CVE-2024-4956](https://github.com/fin3ss3g0d/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #14

**æ¥æº**: [CVE-2024-4956-gmh5225_CVE-2024-4956.md](../2024/CVE-2024-4956-gmh5225_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒSonatype Nexus Repository Manager 3ï¼Œä¸”ç‰ˆæœ¬ä½äºæˆ–ç­‰äº3.68.0ï¼Œç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ `/etc/passwd`ã€‚ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ä¸€ä¸ªGETè¯·æ±‚ï¼Œå…¶ä¸­URLåŒ…å«å¤§é‡ `/%2f` å’Œ `../` çš„ç»„åˆï¼Œç”¨äºç»•è¿‡è·¯å¾„æ£€æŸ¥ï¼Œæœ€ç»ˆè®¿é—®åˆ° `/etc/passwd` æ–‡ä»¶ã€‚YAMLæ–‡ä»¶ä¸­çš„Nucleiæ¨¡æ¿æ˜ç¡®æŒ‡å‡ºäº†è¿™ä¸€ç‚¹ï¼Œå¹¶æä¾›äº†ç›¸åº”çš„æ­£åˆ™è¡¨è¾¾å¼æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚æœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºå®ƒå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…è®¿é—®å’Œä¸‹è½½æ•æ„Ÿç³»ç»Ÿæ–‡ä»¶ï¼Œåº”ç”¨ç¨‹åºæºä»£ç å’Œé…ç½®ã€‚è¯¥POCä»£ç ä»…ç”¨äºè¯»å–æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°å­˜åœ¨æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [gmh5225/CVE-2024-4956](https://github.com/gmh5225/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #15

**æ¥æº**: [CVE-2024-4956-ifconfig-me_CVE-2024-4956-Bulk-Scanner.md](../2024/CVE-2024-4956-ifconfig-me_CVE-2024-4956-Bulk-Scanner.md)

## CVE-2024-4956 Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Sonatype Nexus Repository Manager 3ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®è¯¥æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚PoC ä»£ç  `CVE-2024-4956-scanner.py` æ˜¯ä¸€ä¸ªæ‰¹é‡æ‰«æå™¨ï¼Œå®ƒä»æ–‡ä»¶ä¸­è¯»å–åŸŸåå’Œpayloadsï¼Œç„¶åå‘æ¯ä¸ªåŸŸåå‘é€åŒ…å« payload çš„è¯·æ±‚ã€‚å¦‚æœå“åº”åŒ…å«"root:"å­—ç¬¦ä¸²ï¼ˆé€šå¸¸åœ¨ `/etc/passwd` æ–‡ä»¶ä¸­ï¼‰ï¼Œåˆ™è®¤ä¸ºè¯¥URLå­˜åœ¨æ¼æ´å¹¶å°†å…¶å†™å…¥ `successful_urls.txt` æ–‡ä»¶ä¸­ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¸”PoCä»£ç æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´ï¼Œå› æ­¤PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å†…å®¹ã€‚ä»£ç ä¸­åŒ…å«äº†ä¸€äº›æ‰“å°è¯­å¥å’Œæ–‡ä»¶å†™å…¥æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ‰«ææ¼æ´ï¼Œå¹¶è®°å½•æˆåŠŸåˆ©ç”¨çš„URLï¼Œè€Œä¸æ˜¯ä¿®æ”¹æˆ–ç ´åç›®æ ‡ç³»ç»Ÿã€‚
*   è™½ç„¶å­˜åœ¨æ–‡ä»¶å†™å…¥æ“ä½œ (`successful_urls.txt`)ï¼Œä½†è¿™ä»…ç”¨äºè®°å½•ç›®çš„ï¼Œä¸ä¼šæ‰§è¡Œä»»ä½•æ½œåœ¨çš„æ¶æ„æ“ä½œã€‚
*   ä»£ç çš„æ‰€æœ‰æ“ä½œéƒ½ä¸å…¶å£°æ˜çš„ç›®æ ‡ä¸€è‡´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—æˆ–æœªè®°å½•çš„åŠŸèƒ½ã€‚

å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©éå¸¸ä½ã€‚è€ƒè™‘åˆ°ä»£ç çš„ç®€å•æ€§å’ŒåŠŸèƒ½çš„é€æ˜æ€§ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…éœ€è¦ä¸€ä¸ªåŒ…å«ç›®æ ‡Nexus Repository Managerå®ä¾‹URLçš„åˆ—è¡¨ã€‚
2.  æ”»å‡»è€…éœ€è¦ä¸€ä¸ªåŒ…å«è·¯å¾„éå†payloadçš„åˆ—è¡¨ï¼Œä¾‹å¦‚ `../../../../etc/passwd`ã€‚
3.  è¿è¡ŒPoCè„šæœ¬ `CVE-2024-4956-scanner.py`ï¼Œå¹¶æä¾›åŒ…å«URLåˆ—è¡¨å’Œpayloadåˆ—è¡¨çš„æ–‡ä»¶è·¯å¾„ã€‚
4.  è¯¥è„šæœ¬ä¼šå‘æ¯ä¸ªURLå‘é€åŒ…å«payloadçš„è¯·æ±‚ã€‚
5.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å›è¢«è¯»å–çš„æ–‡ä»¶å†…å®¹ã€‚è„šæœ¬å°†æ£€æµ‹`/etc/passwd`æ–‡ä»¶ä¸­çš„â€œroot:â€å­—ç¬¦ä¸²ä»¥åˆ¤æ–­æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚
6.  åˆ©ç”¨æˆåŠŸçš„URLå°†è¢«è®°å½•åœ¨`successful_urls.txt`æ–‡ä»¶ä¸­ã€‚

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æ•æ„Ÿçš„ç³»ç»Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ï¼Œä»è€Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–è¿›ä¸€æ­¥åˆ©ç”¨ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [ifconfig-me/CVE-2024-4956-Bulk-Scanner](https://github.com/ifconfig-me/CVE-2024-4956-Bulk-Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #16

**æ¥æº**: [CVE-2024-4956-thinhap_CVE-2024-4956-PoC.md](../2024/CVE-2024-4956-thinhap_CVE-2024-4956-PoC.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ github ä¸Šçš„ POCï¼‰å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œåˆ©ç”¨`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`è¿™æ ·çš„payloadæ¥è¯»å–`/etc/passwd`æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å°±æ˜¯ä¸€ä¸ªè¯»å–`/etc/passwd`æ–‡ä»¶çš„ HTTP GET è¯·æ±‚ç¤ºä¾‹ï¼Œå› æ­¤åˆ¤æ–­ POC ä»£ç æœ‰æ•ˆã€‚

å…³äºæŠ•æ¯’é£é™©ï¼Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (`README.md`)ä»…åŒ…å« HTTP è¯·æ±‚ç¤ºä¾‹å’Œä¸€å¼ æˆåŠŸåˆ©ç”¨æ¼æ´çš„æˆªå›¾ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ä»¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç æˆ–å‘½ä»¤ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1. æ„é€ åŒ…å«è·¯å¾„éå†çš„ URLã€‚
2. å‘å—å½±å“çš„ Sonatype Nexus Repository Manager 3 å®ä¾‹å‘é€æ„é€ çš„ URL è¯·æ±‚ã€‚
3. å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼Œåˆ™æœåŠ¡å™¨ä¼šè¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [thinhap/CVE-2024-4956-PoC](https://github.com/thinhap/CVE-2024-4956-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #17

**æ¥æº**: [CVE-2024-4956-verylazytech_CVE-2024-4956.md](../2024/CVE-2024-4956-verylazytech_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“çš„Sonatype Nexus Repository Manager 3ç‰ˆæœ¬ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢å¼•æ“ç»“æœä¸­å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠæœªç»èº«ä»½éªŒè¯çš„è¯»å–ç³»ç»Ÿæ–‡ä»¶çš„èƒ½åŠ›ã€‚æä¾›çš„ Python POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹æ®Šæ„é€ çš„ URL å°è¯•è¯»å– `/etc/passwd` å’Œ `/etc/shadow` æ–‡ä»¶æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ POC ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚å¹¶æ£€æŸ¥å“åº”å†…å®¹ï¼Œä»¥ç¡®è®¤æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€»è¾‘æ¯”è¾ƒç›´æ¥ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•è¯•å›¾åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…åé—¨æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—ï¼ˆä¾‹å¦‚ `../`ï¼‰çš„æ¶æ„ URLã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„ URL å‘é€åˆ°å—å½±å“çš„ Sonatype Nexus Repository Manager 3 æœåŠ¡å™¨ã€‚
3.  æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯ URL ä¸­çš„è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…è¯»å–åˆ°æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚ `/etc/passwd` æˆ– `/etc/shadow`ã€‚

ä¾‹å¦‚ï¼ŒPOC ä»£ç ä¸­ä½¿ç”¨çš„ URL å¦‚ä¸‹ï¼š
`http://<ip_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F../etc/passwd`

æ­¤ URL å°è¯•é€šè¿‡è·¯å¾„éå†è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šè¯»å–æ•æ„Ÿä¿¡æ¯ï¼Œä»è€Œå¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-4956](https://github.com/verylazytech/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #18

**æ¥æº**: [CVE-2024-4956-xungzzz_CVE-2024-4956.md](../2024/CVE-2024-4956-xungzzz_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository 3-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** Path Traversal

**å½±å“åº”ç”¨:** Nexus Repository 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository 3æœåŠ¡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956æ˜¯Sonatype Nexus Repository 3ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„URLè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç å°è¯•é€šè¿‡è·¯å¾„éå†è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸè¯»å–åˆ°åŒ…å«"root:"çš„å“åº”ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©:**
PoCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œæ—¨åœ¨è¯»å–`/etc/passwd`æ–‡ä»¶ã€‚æŠ•æ¯’ä»£ç å¯èƒ½å­˜åœ¨äºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **æµ‹è¯•æ¡†æ¶æœ¬èº«çš„é£é™©ï¼š**å¦‚æœä½¿ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶æ‰§è¡Œæ­¤PoCï¼Œæ¡†æ¶å¯èƒ½è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œä½†yamlæ–‡ä»¶æœ¬èº«ä¸å…·å¤‡æ­¤ç‰¹æ€§ã€‚
2.  **ä¸‹è½½æºçš„é£é™©ï¼š**å¦‚æœyamlæ–‡ä»¶ä¸æ˜¯ä»å¯ä¿¡çš„æºä¸‹è½½ï¼Œä¸‹è½½è¿‡ç¨‹ä¸­å¯èƒ½è¢«ç¯¡æ”¹ã€‚
è€ƒè™‘åˆ°yamlæ–‡ä»¶çš„ç®€å•æ€§ä»¥åŠPoCçš„æ€§è´¨ï¼Œç›´æ¥åœ¨PoCä¸­æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„URLï¼Œä¾‹å¦‚`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`ã€‚
2.  æ”»å‡»è€…å‘é€GETè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„Nexus Repository 3æœåŠ¡å™¨ã€‚
3.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œå°†è¿”å›`/etc/passwd`æ–‡ä»¶çš„å†…å®¹ï¼Œå¦åˆ™è¿”å›é”™è¯¯ä¿¡æ¯ã€‚
4.  æ”»å‡»è€…å¯ä»¥æ›¿æ¢`/etc/passwd`ä¸ºå…¶ä»–æ•æ„Ÿæ–‡ä»¶è·¯å¾„ï¼Œä»¥è¯»å–å…¶ä»–æ–‡ä»¶å†…å®¹ã€‚

**æ’åºä¼˜å…ˆçº§è¯´æ˜:**
å°½ç®¡æ¼æ´åº“ä¿¡æ¯æä¾›äº†æ¼æ´çš„åŸºæœ¬ä¿¡æ¯ï¼Œä½†æœç´¢å¼•æ“ç»“æœæä¾›äº†æ›´å¹¿æ³›çš„å‚è€ƒä¿¡æ¯ï¼ŒåŒ…æ‹¬å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œå¯èƒ½çš„ç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æ˜¯éªŒè¯æ¼æ´å­˜åœ¨çš„ç›´æ¥è¯æ®ï¼Œå› æ­¤æ¼æ´åˆ©ç”¨ä»£ç çš„ä¼˜å…ˆçº§é«˜äºæ¼æ´åº“ä¿¡æ¯ï¼Œè€Œæœç´¢å¼•æ“ç»“æœçš„ä¼˜å…ˆçº§é«˜äºæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ˜¯å› ä¸ºæœç´¢å¼•æ“ç»“æœå¯ä»¥æä¾›æ›´å…¨é¢çš„ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [xungzzz/CVE-2024-4956](https://github.com/xungzzz/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---



---

## POC #10

**æ¥æº**: [CVE-2024-4956-art-of-defence_CVE-2024-4956.md](../2024/CVE-2024-4956-art-of-defence_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Managerå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ï¼Œæ˜¯ä¸€ä¸ªæœªç»éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URL è®¿é—®æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ä¸‹è½½æ•æ„Ÿçš„ç³»ç»Ÿæ–‡ä»¶ã€åº”ç”¨ç¨‹åºæºä»£ç å’Œé…ç½®ä¿¡æ¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `CVE-2024-4956_detect.py` é€šè¿‡å‘é€åŒ…å«è·¯å¾„éå†payloadçš„HTTP GETè¯·æ±‚æ¥éªŒè¯ç›®æ ‡æ˜¯å¦æ˜“å—æ”»å‡»ã€‚è¯¥è„šæœ¬æ£€æŸ¥å“åº”ä¸­æ˜¯å¦åŒ…å« 'root' å­—ç¬¦ä¸²ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦æˆåŠŸè¯»å–äº† `/etc/passwd` æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¸”å½±å“èŒƒå›´å¹¿æ³›ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç›´æ¥éªŒè¯è¯¥æ¼æ´çš„å­˜åœ¨æ€§ï¼Œå› æ­¤æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æŸ¥çœ‹æä¾›çš„ POC ä»£ç  `CVE-2024-4956_detect.py` å’Œ `README.md`ã€‚è¯¥è„šæœ¬ä»…ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` åªæ˜¯å¯¹è„šæœ¬çš„ç®€å•æè¿°ã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ URLï¼Œä¾‹å¦‚ï¼š`http://<ç›®æ ‡IP>:<ç«¯å£>/%2F%2F%2F%2E%2E%2F%2F%2E%2F%2F%2E%2E%2F%2F%2F%2E%2E%2F%2F%2E%2E%2F%2E%2F%65%74%63%2F%70%61%73%73%77%64`ã€‚
2.  Nexus Repository Manager 3 å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæœªæ­£ç¡®éªŒè¯è·¯å¾„ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ URL ä¸­çš„è·¯å¾„ï¼Œè¯»å–å…¶ä»–æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æ•°æ®åº“è¿æ¥ä¿¡æ¯ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [art-of-defence/CVE-2024-4956](https://github.com/art-of-defence/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #11

**æ¥æº**: [CVE-2024-4956-banditzCyber0x_CVE-2024-4956.md](../2024/CVE-2024-4956-banditzCyber0x_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨å¼€å¯ä¸”å¯ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ï¼Œæ˜¯ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/passwd ç­‰æ•æ„Ÿæ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œæ­¤æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚NVD å’Œå…¶ä»–å®‰å…¨æœºæ„å‡å·²ç¡®è®¤è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³ä¿¡æ¯ã€‚POC ä»£ç é€šè¿‡æ„é€ åŒ…å« "%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd" çš„ URL æ¥è®¿é—® /etc/passwd æ–‡ä»¶ï¼Œå¦‚æœè¿”å›åŒ…å« "root:.*:0:0" çš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šCVE-2024-4956.yaml å’Œ README.mdã€‚YAML æ–‡ä»¶åŒ…å« Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚ README.md æ–‡ä»¶åŒ…å«æ¼æ´çš„ç®€å•æè¿°å’Œä¸€ä¸ªå›¾ç‰‡é“¾æ¥ï¼Œè¯¥å›¾ç‰‡é“¾æ¥æŒ‡å‘ githubusercontent.comï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œä»æ•´ä½“é¡¹ç›®æ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½ä¿®æ”¹ YAML æ–‡ä»¶æˆ–åœ¨å…¶ä»–åœ°æ–¹æ·»åŠ æ¶æ„ä»£ç ã€‚ ç»¼åˆè€ƒè™‘ï¼Œåˆ¤å®šæŠ•æ¯’é£é™©ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç¡®å®šç›®æ ‡æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ Nexus Repository Manager 3 ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (<= 3.68.0)ã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URLï¼Œä¾‹å¦‚ï¼š`{{BaseURL}}/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€ GET è¯·æ±‚ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› /etc/passwd æ–‡ä»¶å†…å®¹ï¼Œåˆ™æ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [banditzCyber0x/CVE-2024-4956](https://github.com/banditzCyber0x/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #12

**æ¥æº**: [CVE-2024-4956-erickfernandox_CVE-2024-4956.md](../2024/CVE-2024-4956-erickfernandox_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ä»»æ„ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œéœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚ `../`ï¼‰çš„æ¶æ„ URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚NVDã€Broadcomã€INCIBE-CERTã€Acunetix ç­‰å¤šä¸ªæ¥æºå‡ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚æä¾›çš„ YAML æ ¼å¼çš„ Nuclei æ¨¡æ¿å’Œ PoC æ˜¾ç¤ºäº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è¿™äº›ä¿¡æ¯éƒ½è¯æ˜äº†è¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `CVE-2024-4956.yaml` å’Œ `README.md` æ–‡ä»¶ï¼Œå‘ç°å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚Nuclei æ¨¡æ¿çš„åŠŸèƒ½æ˜¯å‘é€åŒ…å«ç›®å½•éå†åºåˆ—çš„ HTTP GET è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå“åº”ä½“å†…å®¹åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚README æ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°ã€å—å½±å“ç‰ˆæœ¬ã€ç¼“è§£æªæ–½å’Œ PoCã€‚æ•´ä¸ªä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæ¼æ´éªŒè¯å·¥å…·ï¼Œè€Œä¸æ˜¯ä¼ æ’­æ¶æ„è½¯ä»¶ã€‚ä½†æ˜¯ä¸æ’é™¤ä½œè€…åœ¨å…¶ä»–ç‰ˆæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç , æ•…ç»™å‡º5%çš„æŠ•æ¯’æ¦‚ç‡.

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„æ¶æ„ URLï¼Œä¾‹å¦‚ï¼š`{{BaseURL}}/%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f../etc/passwd`ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡ Nexus Repository Manager 3 æœåŠ¡å™¨å‘é€ HTTP GET è¯·æ±‚ï¼Œè¯·æ±‚è¯¥æ¶æ„ URLã€‚
3.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å› `/etc/passwd` æ–‡ä»¶çš„å†…å®¹ï¼Œæ”»å‡»è€…ä»è€Œè¯»å–åˆ°æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [erickfernandox/CVE-2024-4956](https://github.com/erickfernandox/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #13

**æ¥æº**: [CVE-2024-4956-fin3ss3g0d_CVE-2024-4956.md](../2024/CVE-2024-4956-fin3ss3g0d_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„ Nexus Repository Managerã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ 3.68.1 ä¹‹å‰çš„ Sonatype Nexus Repository Manager 3.x ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç  `cve-2024-4956.py` æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨è‡ªåŠ¨åŒ–åˆ©ç”¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„URLï¼Œå°è¯•è®¿é—®æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š
    *   æŒ‡å®šç›®æ ‡æœåŠ¡å™¨çš„URLã€‚
    *   æŒ‡å®šåŒ…å«è¦æµ‹è¯•çš„æ–‡ä»¶è·¯å¾„åˆ—è¡¨çš„æ–‡æœ¬æ–‡ä»¶ã€‚
    *   ä½¿ç”¨HTTPä»£ç†ï¼ˆå¯é€‰ï¼‰ã€‚
    *   æµ‹è¯•æ¨¡å¼ä»¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚
    *   æŒ‡å®šç”¨äºéå†æµ‹è¯•çš„ç›¸å¯¹è·¯å¾„ã€‚
è„šæœ¬é€šè¿‡æ›¿æ¢ `/` ä¸º `%2F` æ¥ç»•è¿‡URLç¼–ç é™åˆ¶ï¼Œç„¶åå‘é€HTTP GETè¯·æ±‚ã€‚æ ¹æ®å…¶è®¾è®¡ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„Pythonä»£ç ï¼Œå‘ç°è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellã€æ¶æ„æ–‡ä»¶ä¸Šä¼ ç­‰ã€‚ä½†æ˜¯ï¼Œè„šæœ¬çš„ä½œè€…åœ¨READMEä¸­æä¾›äº†ä¸€ä¸ªApache Shiro 1 çš„Hashcat æ¨¡å—ï¼Œå¹¶æä¾›äº†gité“¾æ¥ã€‚è™½ç„¶è¯¥æ¨¡å—æœ¬èº«æ˜¯ç”¨äºå¯†ç ç ´è§£çš„å·¥å…·ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨çš„é£é™©ã€‚è¯¥repositoryä¸­LICENSEæ–‡ä»¶æ˜¯æ ‡å‡†çš„MIT licenseï¼Œæ›´è¶‹å‘äºæ­£å¸¸åˆ©ç”¨.
ä»£ç ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§æä½ï¼Œé£é™©è¯„ä¼°ä¸º 1%ã€‚ä¸»è¦é£é™©æ¥è‡ªä½¿ç”¨è€…åˆ©ç”¨æ­¤å·¥å…·è¿›è¡Œéæˆæƒçš„æ¸—é€æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„æ¶æ„URLï¼Œä¾‹å¦‚ `http://target/service/local/artifact/maven/content?r=central&g=org.apache.shiro&a=shiro-core&v=1.2.2&p=jar&filepath=../../../../../../etc/passwd`ã€‚
2.  Nexus Repository Manager æœªæ­£ç¡®éªŒè¯URLä¸­çš„æ–‡ä»¶è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥ä½¿ç”¨æ­¤æ¼æ´è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€é…ç½®æ–‡ä»¶å’Œå…¶ä»–æ•æ„Ÿä¿¡æ¯ã€‚
4.  å¯ä»¥ç»“åˆå…¶ä»–æ¼æ´ï¼Œä¾‹å¦‚shiroçš„æ¼æ´ï¼Œæ¥æ‰©å¤§æ”»å‡»é¢ã€‚

**é¡¹ç›®åœ°å€:** [fin3ss3g0d/CVE-2024-4956](https://github.com/fin3ss3g0d/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #14

**æ¥æº**: [CVE-2024-4956-gmh5225_CVE-2024-4956.md](../2024/CVE-2024-4956-gmh5225_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒSonatype Nexus Repository Manager 3ï¼Œä¸”ç‰ˆæœ¬ä½äºæˆ–ç­‰äº3.68.0ï¼Œç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ `/etc/passwd`ã€‚ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ä¸€ä¸ªGETè¯·æ±‚ï¼Œå…¶ä¸­URLåŒ…å«å¤§é‡ `/%2f` å’Œ `../` çš„ç»„åˆï¼Œç”¨äºç»•è¿‡è·¯å¾„æ£€æŸ¥ï¼Œæœ€ç»ˆè®¿é—®åˆ° `/etc/passwd` æ–‡ä»¶ã€‚YAMLæ–‡ä»¶ä¸­çš„Nucleiæ¨¡æ¿æ˜ç¡®æŒ‡å‡ºäº†è¿™ä¸€ç‚¹ï¼Œå¹¶æä¾›äº†ç›¸åº”çš„æ­£åˆ™è¡¨è¾¾å¼æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚æœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºå®ƒå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…è®¿é—®å’Œä¸‹è½½æ•æ„Ÿç³»ç»Ÿæ–‡ä»¶ï¼Œåº”ç”¨ç¨‹åºæºä»£ç å’Œé…ç½®ã€‚è¯¥POCä»£ç ä»…ç”¨äºè¯»å–æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°å­˜åœ¨æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [gmh5225/CVE-2024-4956](https://github.com/gmh5225/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #15

**æ¥æº**: [CVE-2024-4956-ifconfig-me_CVE-2024-4956-Bulk-Scanner.md](../2024/CVE-2024-4956-ifconfig-me_CVE-2024-4956-Bulk-Scanner.md)

## CVE-2024-4956 Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Sonatype Nexus Repository Manager 3ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®è¯¥æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚PoC ä»£ç  `CVE-2024-4956-scanner.py` æ˜¯ä¸€ä¸ªæ‰¹é‡æ‰«æå™¨ï¼Œå®ƒä»æ–‡ä»¶ä¸­è¯»å–åŸŸåå’Œpayloadsï¼Œç„¶åå‘æ¯ä¸ªåŸŸåå‘é€åŒ…å« payload çš„è¯·æ±‚ã€‚å¦‚æœå“åº”åŒ…å«"root:"å­—ç¬¦ä¸²ï¼ˆé€šå¸¸åœ¨ `/etc/passwd` æ–‡ä»¶ä¸­ï¼‰ï¼Œåˆ™è®¤ä¸ºè¯¥URLå­˜åœ¨æ¼æ´å¹¶å°†å…¶å†™å…¥ `successful_urls.txt` æ–‡ä»¶ä¸­ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¸”PoCä»£ç æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´ï¼Œå› æ­¤PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å†…å®¹ã€‚ä»£ç ä¸­åŒ…å«äº†ä¸€äº›æ‰“å°è¯­å¥å’Œæ–‡ä»¶å†™å…¥æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ‰«ææ¼æ´ï¼Œå¹¶è®°å½•æˆåŠŸåˆ©ç”¨çš„URLï¼Œè€Œä¸æ˜¯ä¿®æ”¹æˆ–ç ´åç›®æ ‡ç³»ç»Ÿã€‚
*   è™½ç„¶å­˜åœ¨æ–‡ä»¶å†™å…¥æ“ä½œ (`successful_urls.txt`)ï¼Œä½†è¿™ä»…ç”¨äºè®°å½•ç›®çš„ï¼Œä¸ä¼šæ‰§è¡Œä»»ä½•æ½œåœ¨çš„æ¶æ„æ“ä½œã€‚
*   ä»£ç çš„æ‰€æœ‰æ“ä½œéƒ½ä¸å…¶å£°æ˜çš„ç›®æ ‡ä¸€è‡´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—æˆ–æœªè®°å½•çš„åŠŸèƒ½ã€‚

å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©éå¸¸ä½ã€‚è€ƒè™‘åˆ°ä»£ç çš„ç®€å•æ€§å’ŒåŠŸèƒ½çš„é€æ˜æ€§ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…éœ€è¦ä¸€ä¸ªåŒ…å«ç›®æ ‡Nexus Repository Managerå®ä¾‹URLçš„åˆ—è¡¨ã€‚
2.  æ”»å‡»è€…éœ€è¦ä¸€ä¸ªåŒ…å«è·¯å¾„éå†payloadçš„åˆ—è¡¨ï¼Œä¾‹å¦‚ `../../../../etc/passwd`ã€‚
3.  è¿è¡ŒPoCè„šæœ¬ `CVE-2024-4956-scanner.py`ï¼Œå¹¶æä¾›åŒ…å«URLåˆ—è¡¨å’Œpayloadåˆ—è¡¨çš„æ–‡ä»¶è·¯å¾„ã€‚
4.  è¯¥è„šæœ¬ä¼šå‘æ¯ä¸ªURLå‘é€åŒ…å«payloadçš„è¯·æ±‚ã€‚
5.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å›è¢«è¯»å–çš„æ–‡ä»¶å†…å®¹ã€‚è„šæœ¬å°†æ£€æµ‹`/etc/passwd`æ–‡ä»¶ä¸­çš„â€œroot:â€å­—ç¬¦ä¸²ä»¥åˆ¤æ–­æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚
6.  åˆ©ç”¨æˆåŠŸçš„URLå°†è¢«è®°å½•åœ¨`successful_urls.txt`æ–‡ä»¶ä¸­ã€‚

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æ•æ„Ÿçš„ç³»ç»Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ï¼Œä»è€Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–è¿›ä¸€æ­¥åˆ©ç”¨ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [ifconfig-me/CVE-2024-4956-Bulk-Scanner](https://github.com/ifconfig-me/CVE-2024-4956-Bulk-Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #16

**æ¥æº**: [CVE-2024-4956-thinhap_CVE-2024-4956-PoC.md](../2024/CVE-2024-4956-thinhap_CVE-2024-4956-PoC.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ github ä¸Šçš„ POCï¼‰å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œåˆ©ç”¨`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`è¿™æ ·çš„payloadæ¥è¯»å–`/etc/passwd`æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å°±æ˜¯ä¸€ä¸ªè¯»å–`/etc/passwd`æ–‡ä»¶çš„ HTTP GET è¯·æ±‚ç¤ºä¾‹ï¼Œå› æ­¤åˆ¤æ–­ POC ä»£ç æœ‰æ•ˆã€‚

å…³äºæŠ•æ¯’é£é™©ï¼Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (`README.md`)ä»…åŒ…å« HTTP è¯·æ±‚ç¤ºä¾‹å’Œä¸€å¼ æˆåŠŸåˆ©ç”¨æ¼æ´çš„æˆªå›¾ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ä»¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç æˆ–å‘½ä»¤ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1. æ„é€ åŒ…å«è·¯å¾„éå†çš„ URLã€‚
2. å‘å—å½±å“çš„ Sonatype Nexus Repository Manager 3 å®ä¾‹å‘é€æ„é€ çš„ URL è¯·æ±‚ã€‚
3. å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼Œåˆ™æœåŠ¡å™¨ä¼šè¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [thinhap/CVE-2024-4956-PoC](https://github.com/thinhap/CVE-2024-4956-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #17

**æ¥æº**: [CVE-2024-4956-verylazytech_CVE-2024-4956.md](../2024/CVE-2024-4956-verylazytech_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“çš„Sonatype Nexus Repository Manager 3ç‰ˆæœ¬ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢å¼•æ“ç»“æœä¸­å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠæœªç»èº«ä»½éªŒè¯çš„è¯»å–ç³»ç»Ÿæ–‡ä»¶çš„èƒ½åŠ›ã€‚æä¾›çš„ Python POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹æ®Šæ„é€ çš„ URL å°è¯•è¯»å– `/etc/passwd` å’Œ `/etc/shadow` æ–‡ä»¶æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ POC ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚å¹¶æ£€æŸ¥å“åº”å†…å®¹ï¼Œä»¥ç¡®è®¤æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€»è¾‘æ¯”è¾ƒç›´æ¥ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•è¯•å›¾åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…åé—¨æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—ï¼ˆä¾‹å¦‚ `../`ï¼‰çš„æ¶æ„ URLã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„ URL å‘é€åˆ°å—å½±å“çš„ Sonatype Nexus Repository Manager 3 æœåŠ¡å™¨ã€‚
3.  æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯ URL ä¸­çš„è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…è¯»å–åˆ°æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚ `/etc/passwd` æˆ– `/etc/shadow`ã€‚

ä¾‹å¦‚ï¼ŒPOC ä»£ç ä¸­ä½¿ç”¨çš„ URL å¦‚ä¸‹ï¼š
`http://<ip_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F../etc/passwd`

æ­¤ URL å°è¯•é€šè¿‡è·¯å¾„éå†è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šè¯»å–æ•æ„Ÿä¿¡æ¯ï¼Œä»è€Œå¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-4956](https://github.com/verylazytech/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #18

**æ¥æº**: [CVE-2024-4956-xungzzz_CVE-2024-4956.md](../2024/CVE-2024-4956-xungzzz_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository 3-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** Path Traversal

**å½±å“åº”ç”¨:** Nexus Repository 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository 3æœåŠ¡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956æ˜¯Sonatype Nexus Repository 3ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„URLè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç å°è¯•é€šè¿‡è·¯å¾„éå†è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸè¯»å–åˆ°åŒ…å«"root:"çš„å“åº”ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©:**
PoCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œæ—¨åœ¨è¯»å–`/etc/passwd`æ–‡ä»¶ã€‚æŠ•æ¯’ä»£ç å¯èƒ½å­˜åœ¨äºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **æµ‹è¯•æ¡†æ¶æœ¬èº«çš„é£é™©ï¼š**å¦‚æœä½¿ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶æ‰§è¡Œæ­¤PoCï¼Œæ¡†æ¶å¯èƒ½è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œä½†yamlæ–‡ä»¶æœ¬èº«ä¸å…·å¤‡æ­¤ç‰¹æ€§ã€‚
2.  **ä¸‹è½½æºçš„é£é™©ï¼š**å¦‚æœyamlæ–‡ä»¶ä¸æ˜¯ä»å¯ä¿¡çš„æºä¸‹è½½ï¼Œä¸‹è½½è¿‡ç¨‹ä¸­å¯èƒ½è¢«ç¯¡æ”¹ã€‚
è€ƒè™‘åˆ°yamlæ–‡ä»¶çš„ç®€å•æ€§ä»¥åŠPoCçš„æ€§è´¨ï¼Œç›´æ¥åœ¨PoCä¸­æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„URLï¼Œä¾‹å¦‚`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`ã€‚
2.  æ”»å‡»è€…å‘é€GETè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„Nexus Repository 3æœåŠ¡å™¨ã€‚
3.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œå°†è¿”å›`/etc/passwd`æ–‡ä»¶çš„å†…å®¹ï¼Œå¦åˆ™è¿”å›é”™è¯¯ä¿¡æ¯ã€‚
4.  æ”»å‡»è€…å¯ä»¥æ›¿æ¢`/etc/passwd`ä¸ºå…¶ä»–æ•æ„Ÿæ–‡ä»¶è·¯å¾„ï¼Œä»¥è¯»å–å…¶ä»–æ–‡ä»¶å†…å®¹ã€‚

**æ’åºä¼˜å…ˆçº§è¯´æ˜:**
å°½ç®¡æ¼æ´åº“ä¿¡æ¯æä¾›äº†æ¼æ´çš„åŸºæœ¬ä¿¡æ¯ï¼Œä½†æœç´¢å¼•æ“ç»“æœæä¾›äº†æ›´å¹¿æ³›çš„å‚è€ƒä¿¡æ¯ï¼ŒåŒ…æ‹¬å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œå¯èƒ½çš„ç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æ˜¯éªŒè¯æ¼æ´å­˜åœ¨çš„ç›´æ¥è¯æ®ï¼Œå› æ­¤æ¼æ´åˆ©ç”¨ä»£ç çš„ä¼˜å…ˆçº§é«˜äºæ¼æ´åº“ä¿¡æ¯ï¼Œè€Œæœç´¢å¼•æ“ç»“æœçš„ä¼˜å…ˆçº§é«˜äºæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ˜¯å› ä¸ºæœç´¢å¼•æ“ç»“æœå¯ä»¥æä¾›æ›´å…¨é¢çš„ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [xungzzz/CVE-2024-4956](https://github.com/xungzzz/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---



---

## POC #10

**æ¥æº**: [CVE-2024-4956-art-of-defence_CVE-2024-4956.md](../2024/CVE-2024-4956-art-of-defence_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Managerå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ï¼Œæ˜¯ä¸€ä¸ªæœªç»éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URL è®¿é—®æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ä¸‹è½½æ•æ„Ÿçš„ç³»ç»Ÿæ–‡ä»¶ã€åº”ç”¨ç¨‹åºæºä»£ç å’Œé…ç½®ä¿¡æ¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `CVE-2024-4956_detect.py` é€šè¿‡å‘é€åŒ…å«è·¯å¾„éå†payloadçš„HTTP GETè¯·æ±‚æ¥éªŒè¯ç›®æ ‡æ˜¯å¦æ˜“å—æ”»å‡»ã€‚è¯¥è„šæœ¬æ£€æŸ¥å“åº”ä¸­æ˜¯å¦åŒ…å« 'root' å­—ç¬¦ä¸²ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦æˆåŠŸè¯»å–äº† `/etc/passwd` æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¸”å½±å“èŒƒå›´å¹¿æ³›ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç›´æ¥éªŒè¯è¯¥æ¼æ´çš„å­˜åœ¨æ€§ï¼Œå› æ­¤æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æŸ¥çœ‹æä¾›çš„ POC ä»£ç  `CVE-2024-4956_detect.py` å’Œ `README.md`ã€‚è¯¥è„šæœ¬ä»…ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` åªæ˜¯å¯¹è„šæœ¬çš„ç®€å•æè¿°ã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ URLï¼Œä¾‹å¦‚ï¼š`http://<ç›®æ ‡IP>:<ç«¯å£>/%2F%2F%2F%2E%2E%2F%2F%2E%2F%2F%2E%2E%2F%2F%2F%2E%2E%2F%2F%2E%2E%2F%2E%2F%65%74%63%2F%70%61%73%73%77%64`ã€‚
2.  Nexus Repository Manager 3 å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæœªæ­£ç¡®éªŒè¯è·¯å¾„ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ URL ä¸­çš„è·¯å¾„ï¼Œè¯»å–å…¶ä»–æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æ•°æ®åº“è¿æ¥ä¿¡æ¯ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [art-of-defence/CVE-2024-4956](https://github.com/art-of-defence/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #11

**æ¥æº**: [CVE-2024-4956-banditzCyber0x_CVE-2024-4956.md](../2024/CVE-2024-4956-banditzCyber0x_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨å¼€å¯ä¸”å¯ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ï¼Œæ˜¯ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/passwd ç­‰æ•æ„Ÿæ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œæ­¤æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚NVD å’Œå…¶ä»–å®‰å…¨æœºæ„å‡å·²ç¡®è®¤è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³ä¿¡æ¯ã€‚POC ä»£ç é€šè¿‡æ„é€ åŒ…å« "%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd" çš„ URL æ¥è®¿é—® /etc/passwd æ–‡ä»¶ï¼Œå¦‚æœè¿”å›åŒ…å« "root:.*:0:0" çš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šCVE-2024-4956.yaml å’Œ README.mdã€‚YAML æ–‡ä»¶åŒ…å« Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚ README.md æ–‡ä»¶åŒ…å«æ¼æ´çš„ç®€å•æè¿°å’Œä¸€ä¸ªå›¾ç‰‡é“¾æ¥ï¼Œè¯¥å›¾ç‰‡é“¾æ¥æŒ‡å‘ githubusercontent.comï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œä»æ•´ä½“é¡¹ç›®æ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½ä¿®æ”¹ YAML æ–‡ä»¶æˆ–åœ¨å…¶ä»–åœ°æ–¹æ·»åŠ æ¶æ„ä»£ç ã€‚ ç»¼åˆè€ƒè™‘ï¼Œåˆ¤å®šæŠ•æ¯’é£é™©ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç¡®å®šç›®æ ‡æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ Nexus Repository Manager 3 ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (<= 3.68.0)ã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URLï¼Œä¾‹å¦‚ï¼š`{{BaseURL}}/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€ GET è¯·æ±‚ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› /etc/passwd æ–‡ä»¶å†…å®¹ï¼Œåˆ™æ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [banditzCyber0x/CVE-2024-4956](https://github.com/banditzCyber0x/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #12

**æ¥æº**: [CVE-2024-4956-erickfernandox_CVE-2024-4956.md](../2024/CVE-2024-4956-erickfernandox_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ä»»æ„ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œéœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚ `../`ï¼‰çš„æ¶æ„ URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚NVDã€Broadcomã€INCIBE-CERTã€Acunetix ç­‰å¤šä¸ªæ¥æºå‡ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚æä¾›çš„ YAML æ ¼å¼çš„ Nuclei æ¨¡æ¿å’Œ PoC æ˜¾ç¤ºäº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è¿™äº›ä¿¡æ¯éƒ½è¯æ˜äº†è¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `CVE-2024-4956.yaml` å’Œ `README.md` æ–‡ä»¶ï¼Œå‘ç°å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚Nuclei æ¨¡æ¿çš„åŠŸèƒ½æ˜¯å‘é€åŒ…å«ç›®å½•éå†åºåˆ—çš„ HTTP GET è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå“åº”ä½“å†…å®¹åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚README æ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°ã€å—å½±å“ç‰ˆæœ¬ã€ç¼“è§£æªæ–½å’Œ PoCã€‚æ•´ä¸ªä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæ¼æ´éªŒè¯å·¥å…·ï¼Œè€Œä¸æ˜¯ä¼ æ’­æ¶æ„è½¯ä»¶ã€‚ä½†æ˜¯ä¸æ’é™¤ä½œè€…åœ¨å…¶ä»–ç‰ˆæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç , æ•…ç»™å‡º5%çš„æŠ•æ¯’æ¦‚ç‡.

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„æ¶æ„ URLï¼Œä¾‹å¦‚ï¼š`{{BaseURL}}/%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f../etc/passwd`ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡ Nexus Repository Manager 3 æœåŠ¡å™¨å‘é€ HTTP GET è¯·æ±‚ï¼Œè¯·æ±‚è¯¥æ¶æ„ URLã€‚
3.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å› `/etc/passwd` æ–‡ä»¶çš„å†…å®¹ï¼Œæ”»å‡»è€…ä»è€Œè¯»å–åˆ°æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [erickfernandox/CVE-2024-4956](https://github.com/erickfernandox/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #13

**æ¥æº**: [CVE-2024-4956-fin3ss3g0d_CVE-2024-4956.md](../2024/CVE-2024-4956-fin3ss3g0d_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„ Nexus Repository Managerã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ 3.68.1 ä¹‹å‰çš„ Sonatype Nexus Repository Manager 3.x ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç  `cve-2024-4956.py` æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨è‡ªåŠ¨åŒ–åˆ©ç”¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„URLï¼Œå°è¯•è®¿é—®æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š
    *   æŒ‡å®šç›®æ ‡æœåŠ¡å™¨çš„URLã€‚
    *   æŒ‡å®šåŒ…å«è¦æµ‹è¯•çš„æ–‡ä»¶è·¯å¾„åˆ—è¡¨çš„æ–‡æœ¬æ–‡ä»¶ã€‚
    *   ä½¿ç”¨HTTPä»£ç†ï¼ˆå¯é€‰ï¼‰ã€‚
    *   æµ‹è¯•æ¨¡å¼ä»¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚
    *   æŒ‡å®šç”¨äºéå†æµ‹è¯•çš„ç›¸å¯¹è·¯å¾„ã€‚
è„šæœ¬é€šè¿‡æ›¿æ¢ `/` ä¸º `%2F` æ¥ç»•è¿‡URLç¼–ç é™åˆ¶ï¼Œç„¶åå‘é€HTTP GETè¯·æ±‚ã€‚æ ¹æ®å…¶è®¾è®¡ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„Pythonä»£ç ï¼Œå‘ç°è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellã€æ¶æ„æ–‡ä»¶ä¸Šä¼ ç­‰ã€‚ä½†æ˜¯ï¼Œè„šæœ¬çš„ä½œè€…åœ¨READMEä¸­æä¾›äº†ä¸€ä¸ªApache Shiro 1 çš„Hashcat æ¨¡å—ï¼Œå¹¶æä¾›äº†gité“¾æ¥ã€‚è™½ç„¶è¯¥æ¨¡å—æœ¬èº«æ˜¯ç”¨äºå¯†ç ç ´è§£çš„å·¥å…·ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨çš„é£é™©ã€‚è¯¥repositoryä¸­LICENSEæ–‡ä»¶æ˜¯æ ‡å‡†çš„MIT licenseï¼Œæ›´è¶‹å‘äºæ­£å¸¸åˆ©ç”¨.
ä»£ç ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§æä½ï¼Œé£é™©è¯„ä¼°ä¸º 1%ã€‚ä¸»è¦é£é™©æ¥è‡ªä½¿ç”¨è€…åˆ©ç”¨æ­¤å·¥å…·è¿›è¡Œéæˆæƒçš„æ¸—é€æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„æ¶æ„URLï¼Œä¾‹å¦‚ `http://target/service/local/artifact/maven/content?r=central&g=org.apache.shiro&a=shiro-core&v=1.2.2&p=jar&filepath=../../../../../../etc/passwd`ã€‚
2.  Nexus Repository Manager æœªæ­£ç¡®éªŒè¯URLä¸­çš„æ–‡ä»¶è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥ä½¿ç”¨æ­¤æ¼æ´è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€é…ç½®æ–‡ä»¶å’Œå…¶ä»–æ•æ„Ÿä¿¡æ¯ã€‚
4.  å¯ä»¥ç»“åˆå…¶ä»–æ¼æ´ï¼Œä¾‹å¦‚shiroçš„æ¼æ´ï¼Œæ¥æ‰©å¤§æ”»å‡»é¢ã€‚

**é¡¹ç›®åœ°å€:** [fin3ss3g0d/CVE-2024-4956](https://github.com/fin3ss3g0d/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #14

**æ¥æº**: [CVE-2024-4956-gmh5225_CVE-2024-4956.md](../2024/CVE-2024-4956-gmh5225_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒSonatype Nexus Repository Manager 3ï¼Œä¸”ç‰ˆæœ¬ä½äºæˆ–ç­‰äº3.68.0ï¼Œç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ `/etc/passwd`ã€‚ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ä¸€ä¸ªGETè¯·æ±‚ï¼Œå…¶ä¸­URLåŒ…å«å¤§é‡ `/%2f` å’Œ `../` çš„ç»„åˆï¼Œç”¨äºç»•è¿‡è·¯å¾„æ£€æŸ¥ï¼Œæœ€ç»ˆè®¿é—®åˆ° `/etc/passwd` æ–‡ä»¶ã€‚YAMLæ–‡ä»¶ä¸­çš„Nucleiæ¨¡æ¿æ˜ç¡®æŒ‡å‡ºäº†è¿™ä¸€ç‚¹ï¼Œå¹¶æä¾›äº†ç›¸åº”çš„æ­£åˆ™è¡¨è¾¾å¼æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚æœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºå®ƒå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…è®¿é—®å’Œä¸‹è½½æ•æ„Ÿç³»ç»Ÿæ–‡ä»¶ï¼Œåº”ç”¨ç¨‹åºæºä»£ç å’Œé…ç½®ã€‚è¯¥POCä»£ç ä»…ç”¨äºè¯»å–æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°å­˜åœ¨æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [gmh5225/CVE-2024-4956](https://github.com/gmh5225/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #15

**æ¥æº**: [CVE-2024-4956-ifconfig-me_CVE-2024-4956-Bulk-Scanner.md](../2024/CVE-2024-4956-ifconfig-me_CVE-2024-4956-Bulk-Scanner.md)

## CVE-2024-4956 Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Sonatype Nexus Repository Manager 3ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®è¯¥æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚PoC ä»£ç  `CVE-2024-4956-scanner.py` æ˜¯ä¸€ä¸ªæ‰¹é‡æ‰«æå™¨ï¼Œå®ƒä»æ–‡ä»¶ä¸­è¯»å–åŸŸåå’Œpayloadsï¼Œç„¶åå‘æ¯ä¸ªåŸŸåå‘é€åŒ…å« payload çš„è¯·æ±‚ã€‚å¦‚æœå“åº”åŒ…å«"root:"å­—ç¬¦ä¸²ï¼ˆé€šå¸¸åœ¨ `/etc/passwd` æ–‡ä»¶ä¸­ï¼‰ï¼Œåˆ™è®¤ä¸ºè¯¥URLå­˜åœ¨æ¼æ´å¹¶å°†å…¶å†™å…¥ `successful_urls.txt` æ–‡ä»¶ä¸­ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¸”PoCä»£ç æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´ï¼Œå› æ­¤PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å†…å®¹ã€‚ä»£ç ä¸­åŒ…å«äº†ä¸€äº›æ‰“å°è¯­å¥å’Œæ–‡ä»¶å†™å…¥æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ‰«ææ¼æ´ï¼Œå¹¶è®°å½•æˆåŠŸåˆ©ç”¨çš„URLï¼Œè€Œä¸æ˜¯ä¿®æ”¹æˆ–ç ´åç›®æ ‡ç³»ç»Ÿã€‚
*   è™½ç„¶å­˜åœ¨æ–‡ä»¶å†™å…¥æ“ä½œ (`successful_urls.txt`)ï¼Œä½†è¿™ä»…ç”¨äºè®°å½•ç›®çš„ï¼Œä¸ä¼šæ‰§è¡Œä»»ä½•æ½œåœ¨çš„æ¶æ„æ“ä½œã€‚
*   ä»£ç çš„æ‰€æœ‰æ“ä½œéƒ½ä¸å…¶å£°æ˜çš„ç›®æ ‡ä¸€è‡´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—æˆ–æœªè®°å½•çš„åŠŸèƒ½ã€‚

å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©éå¸¸ä½ã€‚è€ƒè™‘åˆ°ä»£ç çš„ç®€å•æ€§å’ŒåŠŸèƒ½çš„é€æ˜æ€§ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…éœ€è¦ä¸€ä¸ªåŒ…å«ç›®æ ‡Nexus Repository Managerå®ä¾‹URLçš„åˆ—è¡¨ã€‚
2.  æ”»å‡»è€…éœ€è¦ä¸€ä¸ªåŒ…å«è·¯å¾„éå†payloadçš„åˆ—è¡¨ï¼Œä¾‹å¦‚ `../../../../etc/passwd`ã€‚
3.  è¿è¡ŒPoCè„šæœ¬ `CVE-2024-4956-scanner.py`ï¼Œå¹¶æä¾›åŒ…å«URLåˆ—è¡¨å’Œpayloadåˆ—è¡¨çš„æ–‡ä»¶è·¯å¾„ã€‚
4.  è¯¥è„šæœ¬ä¼šå‘æ¯ä¸ªURLå‘é€åŒ…å«payloadçš„è¯·æ±‚ã€‚
5.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å›è¢«è¯»å–çš„æ–‡ä»¶å†…å®¹ã€‚è„šæœ¬å°†æ£€æµ‹`/etc/passwd`æ–‡ä»¶ä¸­çš„â€œroot:â€å­—ç¬¦ä¸²ä»¥åˆ¤æ–­æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚
6.  åˆ©ç”¨æˆåŠŸçš„URLå°†è¢«è®°å½•åœ¨`successful_urls.txt`æ–‡ä»¶ä¸­ã€‚

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æ•æ„Ÿçš„ç³»ç»Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ï¼Œä»è€Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–è¿›ä¸€æ­¥åˆ©ç”¨ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [ifconfig-me/CVE-2024-4956-Bulk-Scanner](https://github.com/ifconfig-me/CVE-2024-4956-Bulk-Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #16

**æ¥æº**: [CVE-2024-4956-thinhap_CVE-2024-4956-PoC.md](../2024/CVE-2024-4956-thinhap_CVE-2024-4956-PoC.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ github ä¸Šçš„ POCï¼‰å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œåˆ©ç”¨`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`è¿™æ ·çš„payloadæ¥è¯»å–`/etc/passwd`æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å°±æ˜¯ä¸€ä¸ªè¯»å–`/etc/passwd`æ–‡ä»¶çš„ HTTP GET è¯·æ±‚ç¤ºä¾‹ï¼Œå› æ­¤åˆ¤æ–­ POC ä»£ç æœ‰æ•ˆã€‚

å…³äºæŠ•æ¯’é£é™©ï¼Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (`README.md`)ä»…åŒ…å« HTTP è¯·æ±‚ç¤ºä¾‹å’Œä¸€å¼ æˆåŠŸåˆ©ç”¨æ¼æ´çš„æˆªå›¾ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ä»¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç æˆ–å‘½ä»¤ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1. æ„é€ åŒ…å«è·¯å¾„éå†çš„ URLã€‚
2. å‘å—å½±å“çš„ Sonatype Nexus Repository Manager 3 å®ä¾‹å‘é€æ„é€ çš„ URL è¯·æ±‚ã€‚
3. å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼Œåˆ™æœåŠ¡å™¨ä¼šè¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [thinhap/CVE-2024-4956-PoC](https://github.com/thinhap/CVE-2024-4956-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #17

**æ¥æº**: [CVE-2024-4956-verylazytech_CVE-2024-4956.md](../2024/CVE-2024-4956-verylazytech_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“çš„Sonatype Nexus Repository Manager 3ç‰ˆæœ¬ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢å¼•æ“ç»“æœä¸­å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠæœªç»èº«ä»½éªŒè¯çš„è¯»å–ç³»ç»Ÿæ–‡ä»¶çš„èƒ½åŠ›ã€‚æä¾›çš„ Python POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹æ®Šæ„é€ çš„ URL å°è¯•è¯»å– `/etc/passwd` å’Œ `/etc/shadow` æ–‡ä»¶æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ POC ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚å¹¶æ£€æŸ¥å“åº”å†…å®¹ï¼Œä»¥ç¡®è®¤æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€»è¾‘æ¯”è¾ƒç›´æ¥ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•è¯•å›¾åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…åé—¨æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—ï¼ˆä¾‹å¦‚ `../`ï¼‰çš„æ¶æ„ URLã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„ URL å‘é€åˆ°å—å½±å“çš„ Sonatype Nexus Repository Manager 3 æœåŠ¡å™¨ã€‚
3.  æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯ URL ä¸­çš„è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…è¯»å–åˆ°æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚ `/etc/passwd` æˆ– `/etc/shadow`ã€‚

ä¾‹å¦‚ï¼ŒPOC ä»£ç ä¸­ä½¿ç”¨çš„ URL å¦‚ä¸‹ï¼š
`http://<ip_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F../etc/passwd`

æ­¤ URL å°è¯•é€šè¿‡è·¯å¾„éå†è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šè¯»å–æ•æ„Ÿä¿¡æ¯ï¼Œä»è€Œå¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-4956](https://github.com/verylazytech/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #18

**æ¥æº**: [CVE-2024-4956-xungzzz_CVE-2024-4956.md](../2024/CVE-2024-4956-xungzzz_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository 3-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** Path Traversal

**å½±å“åº”ç”¨:** Nexus Repository 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository 3æœåŠ¡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956æ˜¯Sonatype Nexus Repository 3ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„URLè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç å°è¯•é€šè¿‡è·¯å¾„éå†è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸè¯»å–åˆ°åŒ…å«"root:"çš„å“åº”ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©:**
PoCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œæ—¨åœ¨è¯»å–`/etc/passwd`æ–‡ä»¶ã€‚æŠ•æ¯’ä»£ç å¯èƒ½å­˜åœ¨äºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **æµ‹è¯•æ¡†æ¶æœ¬èº«çš„é£é™©ï¼š**å¦‚æœä½¿ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶æ‰§è¡Œæ­¤PoCï¼Œæ¡†æ¶å¯èƒ½è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œä½†yamlæ–‡ä»¶æœ¬èº«ä¸å…·å¤‡æ­¤ç‰¹æ€§ã€‚
2.  **ä¸‹è½½æºçš„é£é™©ï¼š**å¦‚æœyamlæ–‡ä»¶ä¸æ˜¯ä»å¯ä¿¡çš„æºä¸‹è½½ï¼Œä¸‹è½½è¿‡ç¨‹ä¸­å¯èƒ½è¢«ç¯¡æ”¹ã€‚
è€ƒè™‘åˆ°yamlæ–‡ä»¶çš„ç®€å•æ€§ä»¥åŠPoCçš„æ€§è´¨ï¼Œç›´æ¥åœ¨PoCä¸­æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„URLï¼Œä¾‹å¦‚`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`ã€‚
2.  æ”»å‡»è€…å‘é€GETè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„Nexus Repository 3æœåŠ¡å™¨ã€‚
3.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œå°†è¿”å›`/etc/passwd`æ–‡ä»¶çš„å†…å®¹ï¼Œå¦åˆ™è¿”å›é”™è¯¯ä¿¡æ¯ã€‚
4.  æ”»å‡»è€…å¯ä»¥æ›¿æ¢`/etc/passwd`ä¸ºå…¶ä»–æ•æ„Ÿæ–‡ä»¶è·¯å¾„ï¼Œä»¥è¯»å–å…¶ä»–æ–‡ä»¶å†…å®¹ã€‚

**æ’åºä¼˜å…ˆçº§è¯´æ˜:**
å°½ç®¡æ¼æ´åº“ä¿¡æ¯æä¾›äº†æ¼æ´çš„åŸºæœ¬ä¿¡æ¯ï¼Œä½†æœç´¢å¼•æ“ç»“æœæä¾›äº†æ›´å¹¿æ³›çš„å‚è€ƒä¿¡æ¯ï¼ŒåŒ…æ‹¬å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œå¯èƒ½çš„ç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æ˜¯éªŒè¯æ¼æ´å­˜åœ¨çš„ç›´æ¥è¯æ®ï¼Œå› æ­¤æ¼æ´åˆ©ç”¨ä»£ç çš„ä¼˜å…ˆçº§é«˜äºæ¼æ´åº“ä¿¡æ¯ï¼Œè€Œæœç´¢å¼•æ“ç»“æœçš„ä¼˜å…ˆçº§é«˜äºæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ˜¯å› ä¸ºæœç´¢å¼•æ“ç»“æœå¯ä»¥æä¾›æ›´å…¨é¢çš„ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [xungzzz/CVE-2024-4956](https://github.com/xungzzz/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---



---

## POC #10

**æ¥æº**: [CVE-2024-4956-art-of-defence_CVE-2024-4956.md](../2024/CVE-2024-4956-art-of-defence_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Managerå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ï¼Œæ˜¯ä¸€ä¸ªæœªç»éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URL è®¿é—®æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ä¸‹è½½æ•æ„Ÿçš„ç³»ç»Ÿæ–‡ä»¶ã€åº”ç”¨ç¨‹åºæºä»£ç å’Œé…ç½®ä¿¡æ¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `CVE-2024-4956_detect.py` é€šè¿‡å‘é€åŒ…å«è·¯å¾„éå†payloadçš„HTTP GETè¯·æ±‚æ¥éªŒè¯ç›®æ ‡æ˜¯å¦æ˜“å—æ”»å‡»ã€‚è¯¥è„šæœ¬æ£€æŸ¥å“åº”ä¸­æ˜¯å¦åŒ…å« 'root' å­—ç¬¦ä¸²ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦æˆåŠŸè¯»å–äº† `/etc/passwd` æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¸”å½±å“èŒƒå›´å¹¿æ³›ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç›´æ¥éªŒè¯è¯¥æ¼æ´çš„å­˜åœ¨æ€§ï¼Œå› æ­¤æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æŸ¥çœ‹æä¾›çš„ POC ä»£ç  `CVE-2024-4956_detect.py` å’Œ `README.md`ã€‚è¯¥è„šæœ¬ä»…ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` åªæ˜¯å¯¹è„šæœ¬çš„ç®€å•æè¿°ã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ URLï¼Œä¾‹å¦‚ï¼š`http://<ç›®æ ‡IP>:<ç«¯å£>/%2F%2F%2F%2E%2E%2F%2F%2E%2F%2F%2E%2E%2F%2F%2F%2E%2E%2F%2F%2E%2E%2F%2E%2F%65%74%63%2F%70%61%73%73%77%64`ã€‚
2.  Nexus Repository Manager 3 å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæœªæ­£ç¡®éªŒè¯è·¯å¾„ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ URL ä¸­çš„è·¯å¾„ï¼Œè¯»å–å…¶ä»–æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æ•°æ®åº“è¿æ¥ä¿¡æ¯ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [art-of-defence/CVE-2024-4956](https://github.com/art-of-defence/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #11

**æ¥æº**: [CVE-2024-4956-banditzCyber0x_CVE-2024-4956.md](../2024/CVE-2024-4956-banditzCyber0x_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨å¼€å¯ä¸”å¯ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ï¼Œæ˜¯ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/passwd ç­‰æ•æ„Ÿæ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œæ­¤æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚NVD å’Œå…¶ä»–å®‰å…¨æœºæ„å‡å·²ç¡®è®¤è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³ä¿¡æ¯ã€‚POC ä»£ç é€šè¿‡æ„é€ åŒ…å« "%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd" çš„ URL æ¥è®¿é—® /etc/passwd æ–‡ä»¶ï¼Œå¦‚æœè¿”å›åŒ…å« "root:.*:0:0" çš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šCVE-2024-4956.yaml å’Œ README.mdã€‚YAML æ–‡ä»¶åŒ…å« Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚ README.md æ–‡ä»¶åŒ…å«æ¼æ´çš„ç®€å•æè¿°å’Œä¸€ä¸ªå›¾ç‰‡é“¾æ¥ï¼Œè¯¥å›¾ç‰‡é“¾æ¥æŒ‡å‘ githubusercontent.comï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œä»æ•´ä½“é¡¹ç›®æ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½ä¿®æ”¹ YAML æ–‡ä»¶æˆ–åœ¨å…¶ä»–åœ°æ–¹æ·»åŠ æ¶æ„ä»£ç ã€‚ ç»¼åˆè€ƒè™‘ï¼Œåˆ¤å®šæŠ•æ¯’é£é™©ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç¡®å®šç›®æ ‡æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ Nexus Repository Manager 3 ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (<= 3.68.0)ã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URLï¼Œä¾‹å¦‚ï¼š`{{BaseURL}}/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€ GET è¯·æ±‚ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› /etc/passwd æ–‡ä»¶å†…å®¹ï¼Œåˆ™æ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [banditzCyber0x/CVE-2024-4956](https://github.com/banditzCyber0x/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #12

**æ¥æº**: [CVE-2024-4956-erickfernandox_CVE-2024-4956.md](../2024/CVE-2024-4956-erickfernandox_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ä»»æ„ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œéœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚ `../`ï¼‰çš„æ¶æ„ URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚NVDã€Broadcomã€INCIBE-CERTã€Acunetix ç­‰å¤šä¸ªæ¥æºå‡ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚æä¾›çš„ YAML æ ¼å¼çš„ Nuclei æ¨¡æ¿å’Œ PoC æ˜¾ç¤ºäº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è¿™äº›ä¿¡æ¯éƒ½è¯æ˜äº†è¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `CVE-2024-4956.yaml` å’Œ `README.md` æ–‡ä»¶ï¼Œå‘ç°å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚Nuclei æ¨¡æ¿çš„åŠŸèƒ½æ˜¯å‘é€åŒ…å«ç›®å½•éå†åºåˆ—çš„ HTTP GET è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå“åº”ä½“å†…å®¹åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚README æ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°ã€å—å½±å“ç‰ˆæœ¬ã€ç¼“è§£æªæ–½å’Œ PoCã€‚æ•´ä¸ªä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæ¼æ´éªŒè¯å·¥å…·ï¼Œè€Œä¸æ˜¯ä¼ æ’­æ¶æ„è½¯ä»¶ã€‚ä½†æ˜¯ä¸æ’é™¤ä½œè€…åœ¨å…¶ä»–ç‰ˆæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç , æ•…ç»™å‡º5%çš„æŠ•æ¯’æ¦‚ç‡.

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„æ¶æ„ URLï¼Œä¾‹å¦‚ï¼š`{{BaseURL}}/%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f../etc/passwd`ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡ Nexus Repository Manager 3 æœåŠ¡å™¨å‘é€ HTTP GET è¯·æ±‚ï¼Œè¯·æ±‚è¯¥æ¶æ„ URLã€‚
3.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å› `/etc/passwd` æ–‡ä»¶çš„å†…å®¹ï¼Œæ”»å‡»è€…ä»è€Œè¯»å–åˆ°æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [erickfernandox/CVE-2024-4956](https://github.com/erickfernandox/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #13

**æ¥æº**: [CVE-2024-4956-fin3ss3g0d_CVE-2024-4956.md](../2024/CVE-2024-4956-fin3ss3g0d_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„ Nexus Repository Managerã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ 3.68.1 ä¹‹å‰çš„ Sonatype Nexus Repository Manager 3.x ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç  `cve-2024-4956.py` æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨è‡ªåŠ¨åŒ–åˆ©ç”¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„URLï¼Œå°è¯•è®¿é—®æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š
    *   æŒ‡å®šç›®æ ‡æœåŠ¡å™¨çš„URLã€‚
    *   æŒ‡å®šåŒ…å«è¦æµ‹è¯•çš„æ–‡ä»¶è·¯å¾„åˆ—è¡¨çš„æ–‡æœ¬æ–‡ä»¶ã€‚
    *   ä½¿ç”¨HTTPä»£ç†ï¼ˆå¯é€‰ï¼‰ã€‚
    *   æµ‹è¯•æ¨¡å¼ä»¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚
    *   æŒ‡å®šç”¨äºéå†æµ‹è¯•çš„ç›¸å¯¹è·¯å¾„ã€‚
è„šæœ¬é€šè¿‡æ›¿æ¢ `/` ä¸º `%2F` æ¥ç»•è¿‡URLç¼–ç é™åˆ¶ï¼Œç„¶åå‘é€HTTP GETè¯·æ±‚ã€‚æ ¹æ®å…¶è®¾è®¡ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„Pythonä»£ç ï¼Œå‘ç°è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellã€æ¶æ„æ–‡ä»¶ä¸Šä¼ ç­‰ã€‚ä½†æ˜¯ï¼Œè„šæœ¬çš„ä½œè€…åœ¨READMEä¸­æä¾›äº†ä¸€ä¸ªApache Shiro 1 çš„Hashcat æ¨¡å—ï¼Œå¹¶æä¾›äº†gité“¾æ¥ã€‚è™½ç„¶è¯¥æ¨¡å—æœ¬èº«æ˜¯ç”¨äºå¯†ç ç ´è§£çš„å·¥å…·ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨çš„é£é™©ã€‚è¯¥repositoryä¸­LICENSEæ–‡ä»¶æ˜¯æ ‡å‡†çš„MIT licenseï¼Œæ›´è¶‹å‘äºæ­£å¸¸åˆ©ç”¨.
ä»£ç ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§æä½ï¼Œé£é™©è¯„ä¼°ä¸º 1%ã€‚ä¸»è¦é£é™©æ¥è‡ªä½¿ç”¨è€…åˆ©ç”¨æ­¤å·¥å…·è¿›è¡Œéæˆæƒçš„æ¸—é€æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„æ¶æ„URLï¼Œä¾‹å¦‚ `http://target/service/local/artifact/maven/content?r=central&g=org.apache.shiro&a=shiro-core&v=1.2.2&p=jar&filepath=../../../../../../etc/passwd`ã€‚
2.  Nexus Repository Manager æœªæ­£ç¡®éªŒè¯URLä¸­çš„æ–‡ä»¶è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥ä½¿ç”¨æ­¤æ¼æ´è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€é…ç½®æ–‡ä»¶å’Œå…¶ä»–æ•æ„Ÿä¿¡æ¯ã€‚
4.  å¯ä»¥ç»“åˆå…¶ä»–æ¼æ´ï¼Œä¾‹å¦‚shiroçš„æ¼æ´ï¼Œæ¥æ‰©å¤§æ”»å‡»é¢ã€‚

**é¡¹ç›®åœ°å€:** [fin3ss3g0d/CVE-2024-4956](https://github.com/fin3ss3g0d/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #14

**æ¥æº**: [CVE-2024-4956-gmh5225_CVE-2024-4956.md](../2024/CVE-2024-4956-gmh5225_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒSonatype Nexus Repository Manager 3ï¼Œä¸”ç‰ˆæœ¬ä½äºæˆ–ç­‰äº3.68.0ï¼Œç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ `/etc/passwd`ã€‚ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ä¸€ä¸ªGETè¯·æ±‚ï¼Œå…¶ä¸­URLåŒ…å«å¤§é‡ `/%2f` å’Œ `../` çš„ç»„åˆï¼Œç”¨äºç»•è¿‡è·¯å¾„æ£€æŸ¥ï¼Œæœ€ç»ˆè®¿é—®åˆ° `/etc/passwd` æ–‡ä»¶ã€‚YAMLæ–‡ä»¶ä¸­çš„Nucleiæ¨¡æ¿æ˜ç¡®æŒ‡å‡ºäº†è¿™ä¸€ç‚¹ï¼Œå¹¶æä¾›äº†ç›¸åº”çš„æ­£åˆ™è¡¨è¾¾å¼æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚æœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºå®ƒå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…è®¿é—®å’Œä¸‹è½½æ•æ„Ÿç³»ç»Ÿæ–‡ä»¶ï¼Œåº”ç”¨ç¨‹åºæºä»£ç å’Œé…ç½®ã€‚è¯¥POCä»£ç ä»…ç”¨äºè¯»å–æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°å­˜åœ¨æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [gmh5225/CVE-2024-4956](https://github.com/gmh5225/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #15

**æ¥æº**: [CVE-2024-4956-ifconfig-me_CVE-2024-4956-Bulk-Scanner.md](../2024/CVE-2024-4956-ifconfig-me_CVE-2024-4956-Bulk-Scanner.md)

## CVE-2024-4956 Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Sonatype Nexus Repository Manager 3ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®è¯¥æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚PoC ä»£ç  `CVE-2024-4956-scanner.py` æ˜¯ä¸€ä¸ªæ‰¹é‡æ‰«æå™¨ï¼Œå®ƒä»æ–‡ä»¶ä¸­è¯»å–åŸŸåå’Œpayloadsï¼Œç„¶åå‘æ¯ä¸ªåŸŸåå‘é€åŒ…å« payload çš„è¯·æ±‚ã€‚å¦‚æœå“åº”åŒ…å«"root:"å­—ç¬¦ä¸²ï¼ˆé€šå¸¸åœ¨ `/etc/passwd` æ–‡ä»¶ä¸­ï¼‰ï¼Œåˆ™è®¤ä¸ºè¯¥URLå­˜åœ¨æ¼æ´å¹¶å°†å…¶å†™å…¥ `successful_urls.txt` æ–‡ä»¶ä¸­ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¸”PoCä»£ç æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´ï¼Œå› æ­¤PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å†…å®¹ã€‚ä»£ç ä¸­åŒ…å«äº†ä¸€äº›æ‰“å°è¯­å¥å’Œæ–‡ä»¶å†™å…¥æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ‰«ææ¼æ´ï¼Œå¹¶è®°å½•æˆåŠŸåˆ©ç”¨çš„URLï¼Œè€Œä¸æ˜¯ä¿®æ”¹æˆ–ç ´åç›®æ ‡ç³»ç»Ÿã€‚
*   è™½ç„¶å­˜åœ¨æ–‡ä»¶å†™å…¥æ“ä½œ (`successful_urls.txt`)ï¼Œä½†è¿™ä»…ç”¨äºè®°å½•ç›®çš„ï¼Œä¸ä¼šæ‰§è¡Œä»»ä½•æ½œåœ¨çš„æ¶æ„æ“ä½œã€‚
*   ä»£ç çš„æ‰€æœ‰æ“ä½œéƒ½ä¸å…¶å£°æ˜çš„ç›®æ ‡ä¸€è‡´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—æˆ–æœªè®°å½•çš„åŠŸèƒ½ã€‚

å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©éå¸¸ä½ã€‚è€ƒè™‘åˆ°ä»£ç çš„ç®€å•æ€§å’ŒåŠŸèƒ½çš„é€æ˜æ€§ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…éœ€è¦ä¸€ä¸ªåŒ…å«ç›®æ ‡Nexus Repository Managerå®ä¾‹URLçš„åˆ—è¡¨ã€‚
2.  æ”»å‡»è€…éœ€è¦ä¸€ä¸ªåŒ…å«è·¯å¾„éå†payloadçš„åˆ—è¡¨ï¼Œä¾‹å¦‚ `../../../../etc/passwd`ã€‚
3.  è¿è¡ŒPoCè„šæœ¬ `CVE-2024-4956-scanner.py`ï¼Œå¹¶æä¾›åŒ…å«URLåˆ—è¡¨å’Œpayloadåˆ—è¡¨çš„æ–‡ä»¶è·¯å¾„ã€‚
4.  è¯¥è„šæœ¬ä¼šå‘æ¯ä¸ªURLå‘é€åŒ…å«payloadçš„è¯·æ±‚ã€‚
5.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å›è¢«è¯»å–çš„æ–‡ä»¶å†…å®¹ã€‚è„šæœ¬å°†æ£€æµ‹`/etc/passwd`æ–‡ä»¶ä¸­çš„â€œroot:â€å­—ç¬¦ä¸²ä»¥åˆ¤æ–­æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚
6.  åˆ©ç”¨æˆåŠŸçš„URLå°†è¢«è®°å½•åœ¨`successful_urls.txt`æ–‡ä»¶ä¸­ã€‚

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æ•æ„Ÿçš„ç³»ç»Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ï¼Œä»è€Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–è¿›ä¸€æ­¥åˆ©ç”¨ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [ifconfig-me/CVE-2024-4956-Bulk-Scanner](https://github.com/ifconfig-me/CVE-2024-4956-Bulk-Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #16

**æ¥æº**: [CVE-2024-4956-thinhap_CVE-2024-4956-PoC.md](../2024/CVE-2024-4956-thinhap_CVE-2024-4956-PoC.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ github ä¸Šçš„ POCï¼‰å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œåˆ©ç”¨`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`è¿™æ ·çš„payloadæ¥è¯»å–`/etc/passwd`æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å°±æ˜¯ä¸€ä¸ªè¯»å–`/etc/passwd`æ–‡ä»¶çš„ HTTP GET è¯·æ±‚ç¤ºä¾‹ï¼Œå› æ­¤åˆ¤æ–­ POC ä»£ç æœ‰æ•ˆã€‚

å…³äºæŠ•æ¯’é£é™©ï¼Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (`README.md`)ä»…åŒ…å« HTTP è¯·æ±‚ç¤ºä¾‹å’Œä¸€å¼ æˆåŠŸåˆ©ç”¨æ¼æ´çš„æˆªå›¾ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ä»¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç æˆ–å‘½ä»¤ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1. æ„é€ åŒ…å«è·¯å¾„éå†çš„ URLã€‚
2. å‘å—å½±å“çš„ Sonatype Nexus Repository Manager 3 å®ä¾‹å‘é€æ„é€ çš„ URL è¯·æ±‚ã€‚
3. å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼Œåˆ™æœåŠ¡å™¨ä¼šè¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [thinhap/CVE-2024-4956-PoC](https://github.com/thinhap/CVE-2024-4956-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #17

**æ¥æº**: [CVE-2024-4956-verylazytech_CVE-2024-4956.md](../2024/CVE-2024-4956-verylazytech_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“çš„Sonatype Nexus Repository Manager 3ç‰ˆæœ¬ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢å¼•æ“ç»“æœä¸­å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠæœªç»èº«ä»½éªŒè¯çš„è¯»å–ç³»ç»Ÿæ–‡ä»¶çš„èƒ½åŠ›ã€‚æä¾›çš„ Python POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹æ®Šæ„é€ çš„ URL å°è¯•è¯»å– `/etc/passwd` å’Œ `/etc/shadow` æ–‡ä»¶æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ POC ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚å¹¶æ£€æŸ¥å“åº”å†…å®¹ï¼Œä»¥ç¡®è®¤æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€»è¾‘æ¯”è¾ƒç›´æ¥ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•è¯•å›¾åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…åé—¨æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—ï¼ˆä¾‹å¦‚ `../`ï¼‰çš„æ¶æ„ URLã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„ URL å‘é€åˆ°å—å½±å“çš„ Sonatype Nexus Repository Manager 3 æœåŠ¡å™¨ã€‚
3.  æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯ URL ä¸­çš„è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…è¯»å–åˆ°æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚ `/etc/passwd` æˆ– `/etc/shadow`ã€‚

ä¾‹å¦‚ï¼ŒPOC ä»£ç ä¸­ä½¿ç”¨çš„ URL å¦‚ä¸‹ï¼š
`http://<ip_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F../etc/passwd`

æ­¤ URL å°è¯•é€šè¿‡è·¯å¾„éå†è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šè¯»å–æ•æ„Ÿä¿¡æ¯ï¼Œä»è€Œå¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-4956](https://github.com/verylazytech/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #18

**æ¥æº**: [CVE-2024-4956-xungzzz_CVE-2024-4956.md](../2024/CVE-2024-4956-xungzzz_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository 3-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** Path Traversal

**å½±å“åº”ç”¨:** Nexus Repository 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository 3æœåŠ¡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956æ˜¯Sonatype Nexus Repository 3ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„URLè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç å°è¯•é€šè¿‡è·¯å¾„éå†è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸè¯»å–åˆ°åŒ…å«"root:"çš„å“åº”ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©:**
PoCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œæ—¨åœ¨è¯»å–`/etc/passwd`æ–‡ä»¶ã€‚æŠ•æ¯’ä»£ç å¯èƒ½å­˜åœ¨äºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **æµ‹è¯•æ¡†æ¶æœ¬èº«çš„é£é™©ï¼š**å¦‚æœä½¿ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶æ‰§è¡Œæ­¤PoCï¼Œæ¡†æ¶å¯èƒ½è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œä½†yamlæ–‡ä»¶æœ¬èº«ä¸å…·å¤‡æ­¤ç‰¹æ€§ã€‚
2.  **ä¸‹è½½æºçš„é£é™©ï¼š**å¦‚æœyamlæ–‡ä»¶ä¸æ˜¯ä»å¯ä¿¡çš„æºä¸‹è½½ï¼Œä¸‹è½½è¿‡ç¨‹ä¸­å¯èƒ½è¢«ç¯¡æ”¹ã€‚
è€ƒè™‘åˆ°yamlæ–‡ä»¶çš„ç®€å•æ€§ä»¥åŠPoCçš„æ€§è´¨ï¼Œç›´æ¥åœ¨PoCä¸­æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„URLï¼Œä¾‹å¦‚`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`ã€‚
2.  æ”»å‡»è€…å‘é€GETè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„Nexus Repository 3æœåŠ¡å™¨ã€‚
3.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œå°†è¿”å›`/etc/passwd`æ–‡ä»¶çš„å†…å®¹ï¼Œå¦åˆ™è¿”å›é”™è¯¯ä¿¡æ¯ã€‚
4.  æ”»å‡»è€…å¯ä»¥æ›¿æ¢`/etc/passwd`ä¸ºå…¶ä»–æ•æ„Ÿæ–‡ä»¶è·¯å¾„ï¼Œä»¥è¯»å–å…¶ä»–æ–‡ä»¶å†…å®¹ã€‚

**æ’åºä¼˜å…ˆçº§è¯´æ˜:**
å°½ç®¡æ¼æ´åº“ä¿¡æ¯æä¾›äº†æ¼æ´çš„åŸºæœ¬ä¿¡æ¯ï¼Œä½†æœç´¢å¼•æ“ç»“æœæä¾›äº†æ›´å¹¿æ³›çš„å‚è€ƒä¿¡æ¯ï¼ŒåŒ…æ‹¬å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œå¯èƒ½çš„ç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æ˜¯éªŒè¯æ¼æ´å­˜åœ¨çš„ç›´æ¥è¯æ®ï¼Œå› æ­¤æ¼æ´åˆ©ç”¨ä»£ç çš„ä¼˜å…ˆçº§é«˜äºæ¼æ´åº“ä¿¡æ¯ï¼Œè€Œæœç´¢å¼•æ“ç»“æœçš„ä¼˜å…ˆçº§é«˜äºæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ˜¯å› ä¸ºæœç´¢å¼•æ“ç»“æœå¯ä»¥æä¾›æ›´å…¨é¢çš„ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [xungzzz/CVE-2024-4956](https://github.com/xungzzz/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---



---

## POC #10

**æ¥æº**: [CVE-2024-4956-art-of-defence_CVE-2024-4956.md](../2024/CVE-2024-4956-art-of-defence_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Managerå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ï¼Œæ˜¯ä¸€ä¸ªæœªç»éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URL è®¿é—®æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ä¸‹è½½æ•æ„Ÿçš„ç³»ç»Ÿæ–‡ä»¶ã€åº”ç”¨ç¨‹åºæºä»£ç å’Œé…ç½®ä¿¡æ¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `CVE-2024-4956_detect.py` é€šè¿‡å‘é€åŒ…å«è·¯å¾„éå†payloadçš„HTTP GETè¯·æ±‚æ¥éªŒè¯ç›®æ ‡æ˜¯å¦æ˜“å—æ”»å‡»ã€‚è¯¥è„šæœ¬æ£€æŸ¥å“åº”ä¸­æ˜¯å¦åŒ…å« 'root' å­—ç¬¦ä¸²ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦æˆåŠŸè¯»å–äº† `/etc/passwd` æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¸”å½±å“èŒƒå›´å¹¿æ³›ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç›´æ¥éªŒè¯è¯¥æ¼æ´çš„å­˜åœ¨æ€§ï¼Œå› æ­¤æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æŸ¥çœ‹æä¾›çš„ POC ä»£ç  `CVE-2024-4956_detect.py` å’Œ `README.md`ã€‚è¯¥è„šæœ¬ä»…ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` åªæ˜¯å¯¹è„šæœ¬çš„ç®€å•æè¿°ã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ URLï¼Œä¾‹å¦‚ï¼š`http://<ç›®æ ‡IP>:<ç«¯å£>/%2F%2F%2F%2E%2E%2F%2F%2E%2F%2F%2E%2E%2F%2F%2F%2E%2E%2F%2F%2E%2E%2F%2E%2F%65%74%63%2F%70%61%73%73%77%64`ã€‚
2.  Nexus Repository Manager 3 å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæœªæ­£ç¡®éªŒè¯è·¯å¾„ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ URL ä¸­çš„è·¯å¾„ï¼Œè¯»å–å…¶ä»–æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æ•°æ®åº“è¿æ¥ä¿¡æ¯ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [art-of-defence/CVE-2024-4956](https://github.com/art-of-defence/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #11

**æ¥æº**: [CVE-2024-4956-banditzCyber0x_CVE-2024-4956.md](../2024/CVE-2024-4956-banditzCyber0x_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨å¼€å¯ä¸”å¯ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ï¼Œæ˜¯ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/passwd ç­‰æ•æ„Ÿæ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œæ­¤æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚NVD å’Œå…¶ä»–å®‰å…¨æœºæ„å‡å·²ç¡®è®¤è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³ä¿¡æ¯ã€‚POC ä»£ç é€šè¿‡æ„é€ åŒ…å« "%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd" çš„ URL æ¥è®¿é—® /etc/passwd æ–‡ä»¶ï¼Œå¦‚æœè¿”å›åŒ…å« "root:.*:0:0" çš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šCVE-2024-4956.yaml å’Œ README.mdã€‚YAML æ–‡ä»¶åŒ…å« Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚ README.md æ–‡ä»¶åŒ…å«æ¼æ´çš„ç®€å•æè¿°å’Œä¸€ä¸ªå›¾ç‰‡é“¾æ¥ï¼Œè¯¥å›¾ç‰‡é“¾æ¥æŒ‡å‘ githubusercontent.comï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œä»æ•´ä½“é¡¹ç›®æ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½ä¿®æ”¹ YAML æ–‡ä»¶æˆ–åœ¨å…¶ä»–åœ°æ–¹æ·»åŠ æ¶æ„ä»£ç ã€‚ ç»¼åˆè€ƒè™‘ï¼Œåˆ¤å®šæŠ•æ¯’é£é™©ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç¡®å®šç›®æ ‡æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ Nexus Repository Manager 3 ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (<= 3.68.0)ã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URLï¼Œä¾‹å¦‚ï¼š`{{BaseURL}}/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€ GET è¯·æ±‚ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› /etc/passwd æ–‡ä»¶å†…å®¹ï¼Œåˆ™æ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [banditzCyber0x/CVE-2024-4956](https://github.com/banditzCyber0x/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #12

**æ¥æº**: [CVE-2024-4956-erickfernandox_CVE-2024-4956.md](../2024/CVE-2024-4956-erickfernandox_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ä»»æ„ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œéœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚ `../`ï¼‰çš„æ¶æ„ URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚NVDã€Broadcomã€INCIBE-CERTã€Acunetix ç­‰å¤šä¸ªæ¥æºå‡ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚æä¾›çš„ YAML æ ¼å¼çš„ Nuclei æ¨¡æ¿å’Œ PoC æ˜¾ç¤ºäº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è¿™äº›ä¿¡æ¯éƒ½è¯æ˜äº†è¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `CVE-2024-4956.yaml` å’Œ `README.md` æ–‡ä»¶ï¼Œå‘ç°å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚Nuclei æ¨¡æ¿çš„åŠŸèƒ½æ˜¯å‘é€åŒ…å«ç›®å½•éå†åºåˆ—çš„ HTTP GET è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå“åº”ä½“å†…å®¹åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚README æ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°ã€å—å½±å“ç‰ˆæœ¬ã€ç¼“è§£æªæ–½å’Œ PoCã€‚æ•´ä¸ªä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæ¼æ´éªŒè¯å·¥å…·ï¼Œè€Œä¸æ˜¯ä¼ æ’­æ¶æ„è½¯ä»¶ã€‚ä½†æ˜¯ä¸æ’é™¤ä½œè€…åœ¨å…¶ä»–ç‰ˆæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç , æ•…ç»™å‡º5%çš„æŠ•æ¯’æ¦‚ç‡.

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„æ¶æ„ URLï¼Œä¾‹å¦‚ï¼š`{{BaseURL}}/%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f../etc/passwd`ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡ Nexus Repository Manager 3 æœåŠ¡å™¨å‘é€ HTTP GET è¯·æ±‚ï¼Œè¯·æ±‚è¯¥æ¶æ„ URLã€‚
3.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å› `/etc/passwd` æ–‡ä»¶çš„å†…å®¹ï¼Œæ”»å‡»è€…ä»è€Œè¯»å–åˆ°æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [erickfernandox/CVE-2024-4956](https://github.com/erickfernandox/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #13

**æ¥æº**: [CVE-2024-4956-fin3ss3g0d_CVE-2024-4956.md](../2024/CVE-2024-4956-fin3ss3g0d_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„ Nexus Repository Managerã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ 3.68.1 ä¹‹å‰çš„ Sonatype Nexus Repository Manager 3.x ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç  `cve-2024-4956.py` æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨è‡ªåŠ¨åŒ–åˆ©ç”¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„URLï¼Œå°è¯•è®¿é—®æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š
    *   æŒ‡å®šç›®æ ‡æœåŠ¡å™¨çš„URLã€‚
    *   æŒ‡å®šåŒ…å«è¦æµ‹è¯•çš„æ–‡ä»¶è·¯å¾„åˆ—è¡¨çš„æ–‡æœ¬æ–‡ä»¶ã€‚
    *   ä½¿ç”¨HTTPä»£ç†ï¼ˆå¯é€‰ï¼‰ã€‚
    *   æµ‹è¯•æ¨¡å¼ä»¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚
    *   æŒ‡å®šç”¨äºéå†æµ‹è¯•çš„ç›¸å¯¹è·¯å¾„ã€‚
è„šæœ¬é€šè¿‡æ›¿æ¢ `/` ä¸º `%2F` æ¥ç»•è¿‡URLç¼–ç é™åˆ¶ï¼Œç„¶åå‘é€HTTP GETè¯·æ±‚ã€‚æ ¹æ®å…¶è®¾è®¡ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„Pythonä»£ç ï¼Œå‘ç°è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellã€æ¶æ„æ–‡ä»¶ä¸Šä¼ ç­‰ã€‚ä½†æ˜¯ï¼Œè„šæœ¬çš„ä½œè€…åœ¨READMEä¸­æä¾›äº†ä¸€ä¸ªApache Shiro 1 çš„Hashcat æ¨¡å—ï¼Œå¹¶æä¾›äº†gité“¾æ¥ã€‚è™½ç„¶è¯¥æ¨¡å—æœ¬èº«æ˜¯ç”¨äºå¯†ç ç ´è§£çš„å·¥å…·ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨çš„é£é™©ã€‚è¯¥repositoryä¸­LICENSEæ–‡ä»¶æ˜¯æ ‡å‡†çš„MIT licenseï¼Œæ›´è¶‹å‘äºæ­£å¸¸åˆ©ç”¨.
ä»£ç ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§æä½ï¼Œé£é™©è¯„ä¼°ä¸º 1%ã€‚ä¸»è¦é£é™©æ¥è‡ªä½¿ç”¨è€…åˆ©ç”¨æ­¤å·¥å…·è¿›è¡Œéæˆæƒçš„æ¸—é€æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„æ¶æ„URLï¼Œä¾‹å¦‚ `http://target/service/local/artifact/maven/content?r=central&g=org.apache.shiro&a=shiro-core&v=1.2.2&p=jar&filepath=../../../../../../etc/passwd`ã€‚
2.  Nexus Repository Manager æœªæ­£ç¡®éªŒè¯URLä¸­çš„æ–‡ä»¶è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥ä½¿ç”¨æ­¤æ¼æ´è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€é…ç½®æ–‡ä»¶å’Œå…¶ä»–æ•æ„Ÿä¿¡æ¯ã€‚
4.  å¯ä»¥ç»“åˆå…¶ä»–æ¼æ´ï¼Œä¾‹å¦‚shiroçš„æ¼æ´ï¼Œæ¥æ‰©å¤§æ”»å‡»é¢ã€‚

**é¡¹ç›®åœ°å€:** [fin3ss3g0d/CVE-2024-4956](https://github.com/fin3ss3g0d/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #14

**æ¥æº**: [CVE-2024-4956-gmh5225_CVE-2024-4956.md](../2024/CVE-2024-4956-gmh5225_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒSonatype Nexus Repository Manager 3ï¼Œä¸”ç‰ˆæœ¬ä½äºæˆ–ç­‰äº3.68.0ï¼Œç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ `/etc/passwd`ã€‚ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ä¸€ä¸ªGETè¯·æ±‚ï¼Œå…¶ä¸­URLåŒ…å«å¤§é‡ `/%2f` å’Œ `../` çš„ç»„åˆï¼Œç”¨äºç»•è¿‡è·¯å¾„æ£€æŸ¥ï¼Œæœ€ç»ˆè®¿é—®åˆ° `/etc/passwd` æ–‡ä»¶ã€‚YAMLæ–‡ä»¶ä¸­çš„Nucleiæ¨¡æ¿æ˜ç¡®æŒ‡å‡ºäº†è¿™ä¸€ç‚¹ï¼Œå¹¶æä¾›äº†ç›¸åº”çš„æ­£åˆ™è¡¨è¾¾å¼æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚æœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºå®ƒå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…è®¿é—®å’Œä¸‹è½½æ•æ„Ÿç³»ç»Ÿæ–‡ä»¶ï¼Œåº”ç”¨ç¨‹åºæºä»£ç å’Œé…ç½®ã€‚è¯¥POCä»£ç ä»…ç”¨äºè¯»å–æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°å­˜åœ¨æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [gmh5225/CVE-2024-4956](https://github.com/gmh5225/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #15

**æ¥æº**: [CVE-2024-4956-ifconfig-me_CVE-2024-4956-Bulk-Scanner.md](../2024/CVE-2024-4956-ifconfig-me_CVE-2024-4956-Bulk-Scanner.md)

## CVE-2024-4956 Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Sonatype Nexus Repository Manager 3ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®è¯¥æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚PoC ä»£ç  `CVE-2024-4956-scanner.py` æ˜¯ä¸€ä¸ªæ‰¹é‡æ‰«æå™¨ï¼Œå®ƒä»æ–‡ä»¶ä¸­è¯»å–åŸŸåå’Œpayloadsï¼Œç„¶åå‘æ¯ä¸ªåŸŸåå‘é€åŒ…å« payload çš„è¯·æ±‚ã€‚å¦‚æœå“åº”åŒ…å«"root:"å­—ç¬¦ä¸²ï¼ˆé€šå¸¸åœ¨ `/etc/passwd` æ–‡ä»¶ä¸­ï¼‰ï¼Œåˆ™è®¤ä¸ºè¯¥URLå­˜åœ¨æ¼æ´å¹¶å°†å…¶å†™å…¥ `successful_urls.txt` æ–‡ä»¶ä¸­ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¸”PoCä»£ç æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´ï¼Œå› æ­¤PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å†…å®¹ã€‚ä»£ç ä¸­åŒ…å«äº†ä¸€äº›æ‰“å°è¯­å¥å’Œæ–‡ä»¶å†™å…¥æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ‰«ææ¼æ´ï¼Œå¹¶è®°å½•æˆåŠŸåˆ©ç”¨çš„URLï¼Œè€Œä¸æ˜¯ä¿®æ”¹æˆ–ç ´åç›®æ ‡ç³»ç»Ÿã€‚
*   è™½ç„¶å­˜åœ¨æ–‡ä»¶å†™å…¥æ“ä½œ (`successful_urls.txt`)ï¼Œä½†è¿™ä»…ç”¨äºè®°å½•ç›®çš„ï¼Œä¸ä¼šæ‰§è¡Œä»»ä½•æ½œåœ¨çš„æ¶æ„æ“ä½œã€‚
*   ä»£ç çš„æ‰€æœ‰æ“ä½œéƒ½ä¸å…¶å£°æ˜çš„ç›®æ ‡ä¸€è‡´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—æˆ–æœªè®°å½•çš„åŠŸèƒ½ã€‚

å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©éå¸¸ä½ã€‚è€ƒè™‘åˆ°ä»£ç çš„ç®€å•æ€§å’ŒåŠŸèƒ½çš„é€æ˜æ€§ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…éœ€è¦ä¸€ä¸ªåŒ…å«ç›®æ ‡Nexus Repository Managerå®ä¾‹URLçš„åˆ—è¡¨ã€‚
2.  æ”»å‡»è€…éœ€è¦ä¸€ä¸ªåŒ…å«è·¯å¾„éå†payloadçš„åˆ—è¡¨ï¼Œä¾‹å¦‚ `../../../../etc/passwd`ã€‚
3.  è¿è¡ŒPoCè„šæœ¬ `CVE-2024-4956-scanner.py`ï¼Œå¹¶æä¾›åŒ…å«URLåˆ—è¡¨å’Œpayloadåˆ—è¡¨çš„æ–‡ä»¶è·¯å¾„ã€‚
4.  è¯¥è„šæœ¬ä¼šå‘æ¯ä¸ªURLå‘é€åŒ…å«payloadçš„è¯·æ±‚ã€‚
5.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å›è¢«è¯»å–çš„æ–‡ä»¶å†…å®¹ã€‚è„šæœ¬å°†æ£€æµ‹`/etc/passwd`æ–‡ä»¶ä¸­çš„â€œroot:â€å­—ç¬¦ä¸²ä»¥åˆ¤æ–­æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚
6.  åˆ©ç”¨æˆåŠŸçš„URLå°†è¢«è®°å½•åœ¨`successful_urls.txt`æ–‡ä»¶ä¸­ã€‚

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æ•æ„Ÿçš„ç³»ç»Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ï¼Œä»è€Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–è¿›ä¸€æ­¥åˆ©ç”¨ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [ifconfig-me/CVE-2024-4956-Bulk-Scanner](https://github.com/ifconfig-me/CVE-2024-4956-Bulk-Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #16

**æ¥æº**: [CVE-2024-4956-thinhap_CVE-2024-4956-PoC.md](../2024/CVE-2024-4956-thinhap_CVE-2024-4956-PoC.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ github ä¸Šçš„ POCï¼‰å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œåˆ©ç”¨`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`è¿™æ ·çš„payloadæ¥è¯»å–`/etc/passwd`æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å°±æ˜¯ä¸€ä¸ªè¯»å–`/etc/passwd`æ–‡ä»¶çš„ HTTP GET è¯·æ±‚ç¤ºä¾‹ï¼Œå› æ­¤åˆ¤æ–­ POC ä»£ç æœ‰æ•ˆã€‚

å…³äºæŠ•æ¯’é£é™©ï¼Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (`README.md`)ä»…åŒ…å« HTTP è¯·æ±‚ç¤ºä¾‹å’Œä¸€å¼ æˆåŠŸåˆ©ç”¨æ¼æ´çš„æˆªå›¾ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ä»¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç æˆ–å‘½ä»¤ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1. æ„é€ åŒ…å«è·¯å¾„éå†çš„ URLã€‚
2. å‘å—å½±å“çš„ Sonatype Nexus Repository Manager 3 å®ä¾‹å‘é€æ„é€ çš„ URL è¯·æ±‚ã€‚
3. å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼Œåˆ™æœåŠ¡å™¨ä¼šè¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [thinhap/CVE-2024-4956-PoC](https://github.com/thinhap/CVE-2024-4956-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #17

**æ¥æº**: [CVE-2024-4956-verylazytech_CVE-2024-4956.md](../2024/CVE-2024-4956-verylazytech_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“çš„Sonatype Nexus Repository Manager 3ç‰ˆæœ¬ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢å¼•æ“ç»“æœä¸­å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠæœªç»èº«ä»½éªŒè¯çš„è¯»å–ç³»ç»Ÿæ–‡ä»¶çš„èƒ½åŠ›ã€‚æä¾›çš„ Python POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹æ®Šæ„é€ çš„ URL å°è¯•è¯»å– `/etc/passwd` å’Œ `/etc/shadow` æ–‡ä»¶æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ POC ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚å¹¶æ£€æŸ¥å“åº”å†…å®¹ï¼Œä»¥ç¡®è®¤æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€»è¾‘æ¯”è¾ƒç›´æ¥ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•è¯•å›¾åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…åé—¨æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—ï¼ˆä¾‹å¦‚ `../`ï¼‰çš„æ¶æ„ URLã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„ URL å‘é€åˆ°å—å½±å“çš„ Sonatype Nexus Repository Manager 3 æœåŠ¡å™¨ã€‚
3.  æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯ URL ä¸­çš„è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…è¯»å–åˆ°æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚ `/etc/passwd` æˆ– `/etc/shadow`ã€‚

ä¾‹å¦‚ï¼ŒPOC ä»£ç ä¸­ä½¿ç”¨çš„ URL å¦‚ä¸‹ï¼š
`http://<ip_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F../etc/passwd`

æ­¤ URL å°è¯•é€šè¿‡è·¯å¾„éå†è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šè¯»å–æ•æ„Ÿä¿¡æ¯ï¼Œä»è€Œå¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-4956](https://github.com/verylazytech/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #18

**æ¥æº**: [CVE-2024-4956-xungzzz_CVE-2024-4956.md](../2024/CVE-2024-4956-xungzzz_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository 3-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** Path Traversal

**å½±å“åº”ç”¨:** Nexus Repository 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository 3æœåŠ¡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956æ˜¯Sonatype Nexus Repository 3ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„URLè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç å°è¯•é€šè¿‡è·¯å¾„éå†è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸè¯»å–åˆ°åŒ…å«"root:"çš„å“åº”ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©:**
PoCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œæ—¨åœ¨è¯»å–`/etc/passwd`æ–‡ä»¶ã€‚æŠ•æ¯’ä»£ç å¯èƒ½å­˜åœ¨äºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **æµ‹è¯•æ¡†æ¶æœ¬èº«çš„é£é™©ï¼š**å¦‚æœä½¿ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶æ‰§è¡Œæ­¤PoCï¼Œæ¡†æ¶å¯èƒ½è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œä½†yamlæ–‡ä»¶æœ¬èº«ä¸å…·å¤‡æ­¤ç‰¹æ€§ã€‚
2.  **ä¸‹è½½æºçš„é£é™©ï¼š**å¦‚æœyamlæ–‡ä»¶ä¸æ˜¯ä»å¯ä¿¡çš„æºä¸‹è½½ï¼Œä¸‹è½½è¿‡ç¨‹ä¸­å¯èƒ½è¢«ç¯¡æ”¹ã€‚
è€ƒè™‘åˆ°yamlæ–‡ä»¶çš„ç®€å•æ€§ä»¥åŠPoCçš„æ€§è´¨ï¼Œç›´æ¥åœ¨PoCä¸­æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„URLï¼Œä¾‹å¦‚`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`ã€‚
2.  æ”»å‡»è€…å‘é€GETè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„Nexus Repository 3æœåŠ¡å™¨ã€‚
3.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œå°†è¿”å›`/etc/passwd`æ–‡ä»¶çš„å†…å®¹ï¼Œå¦åˆ™è¿”å›é”™è¯¯ä¿¡æ¯ã€‚
4.  æ”»å‡»è€…å¯ä»¥æ›¿æ¢`/etc/passwd`ä¸ºå…¶ä»–æ•æ„Ÿæ–‡ä»¶è·¯å¾„ï¼Œä»¥è¯»å–å…¶ä»–æ–‡ä»¶å†…å®¹ã€‚

**æ’åºä¼˜å…ˆçº§è¯´æ˜:**
å°½ç®¡æ¼æ´åº“ä¿¡æ¯æä¾›äº†æ¼æ´çš„åŸºæœ¬ä¿¡æ¯ï¼Œä½†æœç´¢å¼•æ“ç»“æœæä¾›äº†æ›´å¹¿æ³›çš„å‚è€ƒä¿¡æ¯ï¼ŒåŒ…æ‹¬å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œå¯èƒ½çš„ç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æ˜¯éªŒè¯æ¼æ´å­˜åœ¨çš„ç›´æ¥è¯æ®ï¼Œå› æ­¤æ¼æ´åˆ©ç”¨ä»£ç çš„ä¼˜å…ˆçº§é«˜äºæ¼æ´åº“ä¿¡æ¯ï¼Œè€Œæœç´¢å¼•æ“ç»“æœçš„ä¼˜å…ˆçº§é«˜äºæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ˜¯å› ä¸ºæœç´¢å¼•æ“ç»“æœå¯ä»¥æä¾›æ›´å…¨é¢çš„ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [xungzzz/CVE-2024-4956](https://github.com/xungzzz/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---



---

## POC #10

**æ¥æº**: [CVE-2024-4956-art-of-defence_CVE-2024-4956.md](../2024/CVE-2024-4956-art-of-defence_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository Managerå®ä¾‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ï¼Œæ˜¯ä¸€ä¸ªæœªç»éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URL è®¿é—®æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ä¸‹è½½æ•æ„Ÿçš„ç³»ç»Ÿæ–‡ä»¶ã€åº”ç”¨ç¨‹åºæºä»£ç å’Œé…ç½®ä¿¡æ¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `CVE-2024-4956_detect.py` é€šè¿‡å‘é€åŒ…å«è·¯å¾„éå†payloadçš„HTTP GETè¯·æ±‚æ¥éªŒè¯ç›®æ ‡æ˜¯å¦æ˜“å—æ”»å‡»ã€‚è¯¥è„šæœ¬æ£€æŸ¥å“åº”ä¸­æ˜¯å¦åŒ…å« 'root' å­—ç¬¦ä¸²ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦æˆåŠŸè¯»å–äº† `/etc/passwd` æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¸”å½±å“èŒƒå›´å¹¿æ³›ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç›´æ¥éªŒè¯è¯¥æ¼æ´çš„å­˜åœ¨æ€§ï¼Œå› æ­¤æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æŸ¥çœ‹æä¾›çš„ POC ä»£ç  `CVE-2024-4956_detect.py` å’Œ `README.md`ã€‚è¯¥è„šæœ¬ä»…ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` åªæ˜¯å¯¹è„šæœ¬çš„ç®€å•æè¿°ã€‚å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ URLï¼Œä¾‹å¦‚ï¼š`http://<ç›®æ ‡IP>:<ç«¯å£>/%2F%2F%2F%2E%2E%2F%2F%2E%2F%2F%2E%2E%2F%2F%2F%2E%2E%2F%2F%2E%2E%2F%2E%2F%65%74%63%2F%70%61%73%73%77%64`ã€‚
2.  Nexus Repository Manager 3 å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæœªæ­£ç¡®éªŒè¯è·¯å¾„ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹ URL ä¸­çš„è·¯å¾„ï¼Œè¯»å–å…¶ä»–æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æ•°æ®åº“è¿æ¥ä¿¡æ¯ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [art-of-defence/CVE-2024-4956](https://github.com/art-of-defence/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #11

**æ¥æº**: [CVE-2024-4956-banditzCyber0x_CVE-2024-4956.md](../2024/CVE-2024-4956-banditzCyber0x_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository Manager 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨å¼€å¯ä¸”å¯ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ï¼Œæ˜¯ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/passwd ç­‰æ•æ„Ÿæ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œæ­¤æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚NVD å’Œå…¶ä»–å®‰å…¨æœºæ„å‡å·²ç¡®è®¤è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³ä¿¡æ¯ã€‚POC ä»£ç é€šè¿‡æ„é€ åŒ…å« "%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd" çš„ URL æ¥è®¿é—® /etc/passwd æ–‡ä»¶ï¼Œå¦‚æœè¿”å›åŒ…å« "root:.*:0:0" çš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šCVE-2024-4956.yaml å’Œ README.mdã€‚YAML æ–‡ä»¶åŒ…å« Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚ README.md æ–‡ä»¶åŒ…å«æ¼æ´çš„ç®€å•æè¿°å’Œä¸€ä¸ªå›¾ç‰‡é“¾æ¥ï¼Œè¯¥å›¾ç‰‡é“¾æ¥æŒ‡å‘ githubusercontent.comï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œä»æ•´ä½“é¡¹ç›®æ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½ä¿®æ”¹ YAML æ–‡ä»¶æˆ–åœ¨å…¶ä»–åœ°æ–¹æ·»åŠ æ¶æ„ä»£ç ã€‚ ç»¼åˆè€ƒè™‘ï¼Œåˆ¤å®šæŠ•æ¯’é£é™©ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç¡®å®šç›®æ ‡æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ Nexus Repository Manager 3 ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (<= 3.68.0)ã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URLï¼Œä¾‹å¦‚ï¼š`{{BaseURL}}/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€ GET è¯·æ±‚ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› /etc/passwd æ–‡ä»¶å†…å®¹ï¼Œåˆ™æ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [banditzCyber0x/CVE-2024-4956](https://github.com/banditzCyber0x/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #12

**æ¥æº**: [CVE-2024-4956-erickfernandox_CVE-2024-4956.md](../2024/CVE-2024-4956-erickfernandox_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ä»»æ„ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œéœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚ `../`ï¼‰çš„æ¶æ„ URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚NVDã€Broadcomã€INCIBE-CERTã€Acunetix ç­‰å¤šä¸ªæ¥æºå‡ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€‚æä¾›çš„ YAML æ ¼å¼çš„ Nuclei æ¨¡æ¿å’Œ PoC æ˜¾ç¤ºäº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è¿™äº›ä¿¡æ¯éƒ½è¯æ˜äº†è¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `CVE-2024-4956.yaml` å’Œ `README.md` æ–‡ä»¶ï¼Œå‘ç°å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚Nuclei æ¨¡æ¿çš„åŠŸèƒ½æ˜¯å‘é€åŒ…å«ç›®å½•éå†åºåˆ—çš„ HTTP GET è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå“åº”ä½“å†…å®¹åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚README æ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°ã€å—å½±å“ç‰ˆæœ¬ã€ç¼“è§£æªæ–½å’Œ PoCã€‚æ•´ä¸ªä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæ¼æ´éªŒè¯å·¥å…·ï¼Œè€Œä¸æ˜¯ä¼ æ’­æ¶æ„è½¯ä»¶ã€‚ä½†æ˜¯ä¸æ’é™¤ä½œè€…åœ¨å…¶ä»–ç‰ˆæœ¬ä¸­åŠ å…¥æ¶æ„ä»£ç , æ•…ç»™å‡º5%çš„æŠ•æ¯’æ¦‚ç‡.

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„æ¶æ„ URLï¼Œä¾‹å¦‚ï¼š`{{BaseURL}}/%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f../etc/passwd`ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡ Nexus Repository Manager 3 æœåŠ¡å™¨å‘é€ HTTP GET è¯·æ±‚ï¼Œè¯·æ±‚è¯¥æ¶æ„ URLã€‚
3.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å› `/etc/passwd` æ–‡ä»¶çš„å†…å®¹ï¼Œæ”»å‡»è€…ä»è€Œè¯»å–åˆ°æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [erickfernandox/CVE-2024-4956](https://github.com/erickfernandox/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #13

**æ¥æº**: [CVE-2024-4956-fin3ss3g0d_CVE-2024-4956.md](../2024/CVE-2024-4956-fin3ss3g0d_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„ Nexus Repository Managerã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ 3.68.1 ä¹‹å‰çš„ Sonatype Nexus Repository Manager 3.x ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç  `cve-2024-4956.py` æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨è‡ªåŠ¨åŒ–åˆ©ç”¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„URLï¼Œå°è¯•è®¿é—®æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š
    *   æŒ‡å®šç›®æ ‡æœåŠ¡å™¨çš„URLã€‚
    *   æŒ‡å®šåŒ…å«è¦æµ‹è¯•çš„æ–‡ä»¶è·¯å¾„åˆ—è¡¨çš„æ–‡æœ¬æ–‡ä»¶ã€‚
    *   ä½¿ç”¨HTTPä»£ç†ï¼ˆå¯é€‰ï¼‰ã€‚
    *   æµ‹è¯•æ¨¡å¼ä»¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚
    *   æŒ‡å®šç”¨äºéå†æµ‹è¯•çš„ç›¸å¯¹è·¯å¾„ã€‚
è„šæœ¬é€šè¿‡æ›¿æ¢ `/` ä¸º `%2F` æ¥ç»•è¿‡URLç¼–ç é™åˆ¶ï¼Œç„¶åå‘é€HTTP GETè¯·æ±‚ã€‚æ ¹æ®å…¶è®¾è®¡ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„Pythonä»£ç ï¼Œå‘ç°è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellã€æ¶æ„æ–‡ä»¶ä¸Šä¼ ç­‰ã€‚ä½†æ˜¯ï¼Œè„šæœ¬çš„ä½œè€…åœ¨READMEä¸­æä¾›äº†ä¸€ä¸ªApache Shiro 1 çš„Hashcat æ¨¡å—ï¼Œå¹¶æä¾›äº†gité“¾æ¥ã€‚è™½ç„¶è¯¥æ¨¡å—æœ¬èº«æ˜¯ç”¨äºå¯†ç ç ´è§£çš„å·¥å…·ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨çš„é£é™©ã€‚è¯¥repositoryä¸­LICENSEæ–‡ä»¶æ˜¯æ ‡å‡†çš„MIT licenseï¼Œæ›´è¶‹å‘äºæ­£å¸¸åˆ©ç”¨.
ä»£ç ä¸­å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§æä½ï¼Œé£é™©è¯„ä¼°ä¸º 1%ã€‚ä¸»è¦é£é™©æ¥è‡ªä½¿ç”¨è€…åˆ©ç”¨æ­¤å·¥å…·è¿›è¡Œéæˆæƒçš„æ¸—é€æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„æ¶æ„URLï¼Œä¾‹å¦‚ `http://target/service/local/artifact/maven/content?r=central&g=org.apache.shiro&a=shiro-core&v=1.2.2&p=jar&filepath=../../../../../../etc/passwd`ã€‚
2.  Nexus Repository Manager æœªæ­£ç¡®éªŒè¯URLä¸­çš„æ–‡ä»¶è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥ä½¿ç”¨æ­¤æ¼æ´è¯»å–ç³»ç»Ÿæ–‡ä»¶ã€é…ç½®æ–‡ä»¶å’Œå…¶ä»–æ•æ„Ÿä¿¡æ¯ã€‚
4.  å¯ä»¥ç»“åˆå…¶ä»–æ¼æ´ï¼Œä¾‹å¦‚shiroçš„æ¼æ´ï¼Œæ¥æ‰©å¤§æ”»å‡»é¢ã€‚

**é¡¹ç›®åœ°å€:** [fin3ss3g0d/CVE-2024-4956](https://github.com/fin3ss3g0d/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #14

**æ¥æº**: [CVE-2024-4956-gmh5225_CVE-2024-4956.md](../2024/CVE-2024-4956-gmh5225_CVE-2024-4956.md)

## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒSonatype Nexus Repository Manager 3ï¼Œä¸”ç‰ˆæœ¬ä½äºæˆ–ç­‰äº3.68.0ï¼Œç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ `/etc/passwd`ã€‚ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ä¸€ä¸ªGETè¯·æ±‚ï¼Œå…¶ä¸­URLåŒ…å«å¤§é‡ `/%2f` å’Œ `../` çš„ç»„åˆï¼Œç”¨äºç»•è¿‡è·¯å¾„æ£€æŸ¥ï¼Œæœ€ç»ˆè®¿é—®åˆ° `/etc/passwd` æ–‡ä»¶ã€‚YAMLæ–‡ä»¶ä¸­çš„Nucleiæ¨¡æ¿æ˜ç¡®æŒ‡å‡ºäº†è¿™ä¸€ç‚¹ï¼Œå¹¶æä¾›äº†ç›¸åº”çš„æ­£åˆ™è¡¨è¾¾å¼æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚æœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºå®ƒå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…è®¿é—®å’Œä¸‹è½½æ•æ„Ÿç³»ç»Ÿæ–‡ä»¶ï¼Œåº”ç”¨ç¨‹åºæºä»£ç å’Œé…ç½®ã€‚è¯¥POCä»£ç ä»…ç”¨äºè¯»å–æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°å­˜åœ¨æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [gmh5225/CVE-2024-4956](https://github.com/gmh5225/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #15

**æ¥æº**: [CVE-2024-4956-ifconfig-me_CVE-2024-4956-Bulk-Scanner.md](../2024/CVE-2024-4956-ifconfig-me_CVE-2024-4956-Bulk-Scanner.md)

## CVE-2024-4956 Sonatype Nexus Repository 3 Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Sonatype Nexus Repository Manager 3ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®è¯¥æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4956 å­˜åœ¨äº Sonatype Nexus Repository Manager 3 ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚PoC ä»£ç  `CVE-2024-4956-scanner.py` æ˜¯ä¸€ä¸ªæ‰¹é‡æ‰«æå™¨ï¼Œå®ƒä»æ–‡ä»¶ä¸­è¯»å–åŸŸåå’Œpayloadsï¼Œç„¶åå‘æ¯ä¸ªåŸŸåå‘é€åŒ…å« payload çš„è¯·æ±‚ã€‚å¦‚æœå“åº”åŒ…å«"root:"å­—ç¬¦ä¸²ï¼ˆé€šå¸¸åœ¨ `/etc/passwd` æ–‡ä»¶ä¸­ï¼‰ï¼Œåˆ™è®¤ä¸ºè¯¥URLå­˜åœ¨æ¼æ´å¹¶å°†å…¶å†™å…¥ `successful_urls.txt` æ–‡ä»¶ä¸­ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¸”PoCä»£ç æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´ï¼Œå› æ­¤PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å†…å®¹ã€‚ä»£ç ä¸­åŒ…å«äº†ä¸€äº›æ‰“å°è¯­å¥å’Œæ–‡ä»¶å†™å…¥æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ‰«ææ¼æ´ï¼Œå¹¶è®°å½•æˆåŠŸåˆ©ç”¨çš„URLï¼Œè€Œä¸æ˜¯ä¿®æ”¹æˆ–ç ´åç›®æ ‡ç³»ç»Ÿã€‚
*   è™½ç„¶å­˜åœ¨æ–‡ä»¶å†™å…¥æ“ä½œ (`successful_urls.txt`)ï¼Œä½†è¿™ä»…ç”¨äºè®°å½•ç›®çš„ï¼Œä¸ä¼šæ‰§è¡Œä»»ä½•æ½œåœ¨çš„æ¶æ„æ“ä½œã€‚
*   ä»£ç çš„æ‰€æœ‰æ“ä½œéƒ½ä¸å…¶å£°æ˜çš„ç›®æ ‡ä¸€è‡´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—æˆ–æœªè®°å½•çš„åŠŸèƒ½ã€‚

å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©éå¸¸ä½ã€‚è€ƒè™‘åˆ°ä»£ç çš„ç®€å•æ€§å’ŒåŠŸèƒ½çš„é€æ˜æ€§ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…éœ€è¦ä¸€ä¸ªåŒ…å«ç›®æ ‡Nexus Repository Managerå®ä¾‹URLçš„åˆ—è¡¨ã€‚
2.  æ”»å‡»è€…éœ€è¦ä¸€ä¸ªåŒ…å«è·¯å¾„éå†payloadçš„åˆ—è¡¨ï¼Œä¾‹å¦‚ `../../../../etc/passwd`ã€‚
3.  è¿è¡ŒPoCè„šæœ¬ `CVE-2024-4956-scanner.py`ï¼Œå¹¶æä¾›åŒ…å«URLåˆ—è¡¨å’Œpayloadåˆ—è¡¨çš„æ–‡ä»¶è·¯å¾„ã€‚
4.  è¯¥è„šæœ¬ä¼šå‘æ¯ä¸ªURLå‘é€åŒ…å«payloadçš„è¯·æ±‚ã€‚
5.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šè¿”å›è¢«è¯»å–çš„æ–‡ä»¶å†…å®¹ã€‚è„šæœ¬å°†æ£€æµ‹`/etc/passwd`æ–‡ä»¶ä¸­çš„â€œroot:â€å­—ç¬¦ä¸²ä»¥åˆ¤æ–­æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚
6.  åˆ©ç”¨æˆåŠŸçš„URLå°†è¢«è®°å½•åœ¨`successful_urls.txt`æ–‡ä»¶ä¸­ã€‚

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æ•æ„Ÿçš„ç³»ç»Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ï¼Œä»è€Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–è¿›ä¸€æ­¥åˆ©ç”¨ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [ifconfig-me/CVE-2024-4956-Bulk-Scanner](https://github.com/ifconfig-me/CVE-2024-4956-Bulk-Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #16

**æ¥æº**: [CVE-2024-4956-thinhap_CVE-2024-4956-PoC.md](../2024/CVE-2024-4956-thinhap_CVE-2024-4956-PoC.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ github ä¸Šçš„ POCï¼‰å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œåˆ©ç”¨`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`è¿™æ ·çš„payloadæ¥è¯»å–`/etc/passwd`æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å°±æ˜¯ä¸€ä¸ªè¯»å–`/etc/passwd`æ–‡ä»¶çš„ HTTP GET è¯·æ±‚ç¤ºä¾‹ï¼Œå› æ­¤åˆ¤æ–­ POC ä»£ç æœ‰æ•ˆã€‚

å…³äºæŠ•æ¯’é£é™©ï¼Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (`README.md`)ä»…åŒ…å« HTTP è¯·æ±‚ç¤ºä¾‹å’Œä¸€å¼ æˆåŠŸåˆ©ç”¨æ¼æ´çš„æˆªå›¾ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ä»¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç æˆ–å‘½ä»¤ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
1. æ„é€ åŒ…å«è·¯å¾„éå†çš„ URLã€‚
2. å‘å—å½±å“çš„ Sonatype Nexus Repository Manager 3 å®ä¾‹å‘é€æ„é€ çš„ URL è¯·æ±‚ã€‚
3. å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼Œåˆ™æœåŠ¡å™¨ä¼šè¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [thinhap/CVE-2024-4956-PoC](https://github.com/thinhap/CVE-2024-4956-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #17

**æ¥æº**: [CVE-2024-4956-verylazytech_CVE-2024-4956.md](../2024/CVE-2024-4956-verylazytech_CVE-2024-4956.md)

## CVE-2024-4956-Sonatype Nexus Repository 3-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Sonatype Nexus Repository Manager 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–ç³»ç»Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“çš„Sonatype Nexus Repository Manager 3ç‰ˆæœ¬ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4956 æ˜¯ Sonatype Nexus Repository Manager 3 ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´é€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URL æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢å¼•æ“ç»“æœä¸­å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠæœªç»èº«ä»½éªŒè¯çš„è¯»å–ç³»ç»Ÿæ–‡ä»¶çš„èƒ½åŠ›ã€‚æä¾›çš„ Python POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹æ®Šæ„é€ çš„ URL å°è¯•è¯»å– `/etc/passwd` å’Œ `/etc/shadow` æ–‡ä»¶æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ POC ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚å¹¶æ£€æŸ¥å“åº”å†…å®¹ï¼Œä»¥ç¡®è®¤æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€»è¾‘æ¯”è¾ƒç›´æ¥ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•è¯•å›¾åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…åé—¨æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—ï¼ˆä¾‹å¦‚ `../`ï¼‰çš„æ¶æ„ URLã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„ URL å‘é€åˆ°å—å½±å“çš„ Sonatype Nexus Repository Manager 3 æœåŠ¡å™¨ã€‚
3.  æœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯ URL ä¸­çš„è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…è¯»å–åˆ°æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚ `/etc/passwd` æˆ– `/etc/shadow`ã€‚

ä¾‹å¦‚ï¼ŒPOC ä»£ç ä¸­ä½¿ç”¨çš„ URL å¦‚ä¸‹ï¼š
`http://<ip_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F../etc/passwd`

æ­¤ URL å°è¯•é€šè¿‡è·¯å¾„éå†è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šè¯»å–æ•æ„Ÿä¿¡æ¯ï¼Œä»è€Œå¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-4956](https://github.com/verylazytech/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

## POC #18

**æ¥æº**: [CVE-2024-4956-xungzzz_CVE-2024-4956.md](../2024/CVE-2024-4956-xungzzz_CVE-2024-4956.md)

## CVE-2024-4956-Nexus Repository 3-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-4956

**æ¼æ´ç±»å‹:** Path Traversal

**å½±å“åº”ç”¨:** Nexus Repository 3

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.68.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ç›®æ ‡Nexus Repository 3æœåŠ¡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4956æ˜¯Sonatype Nexus Repository 3ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„URLè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç å°è¯•é€šè¿‡è·¯å¾„éå†è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸè¯»å–åˆ°åŒ…å«"root:"çš„å“åº”ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©:**
PoCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œæ—¨åœ¨è¯»å–`/etc/passwd`æ–‡ä»¶ã€‚æŠ•æ¯’ä»£ç å¯èƒ½å­˜åœ¨äºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **æµ‹è¯•æ¡†æ¶æœ¬èº«çš„é£é™©ï¼š**å¦‚æœä½¿ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶æ‰§è¡Œæ­¤PoCï¼Œæ¡†æ¶å¯èƒ½è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œä½†yamlæ–‡ä»¶æœ¬èº«ä¸å…·å¤‡æ­¤ç‰¹æ€§ã€‚
2.  **ä¸‹è½½æºçš„é£é™©ï¼š**å¦‚æœyamlæ–‡ä»¶ä¸æ˜¯ä»å¯ä¿¡çš„æºä¸‹è½½ï¼Œä¸‹è½½è¿‡ç¨‹ä¸­å¯èƒ½è¢«ç¯¡æ”¹ã€‚
è€ƒè™‘åˆ°yamlæ–‡ä»¶çš„ç®€å•æ€§ä»¥åŠPoCçš„æ€§è´¨ï¼Œç›´æ¥åœ¨PoCä¸­æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„URLï¼Œä¾‹å¦‚`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`ã€‚
2.  æ”»å‡»è€…å‘é€GETè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„Nexus Repository 3æœåŠ¡å™¨ã€‚
3.  å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œå°†è¿”å›`/etc/passwd`æ–‡ä»¶çš„å†…å®¹ï¼Œå¦åˆ™è¿”å›é”™è¯¯ä¿¡æ¯ã€‚
4.  æ”»å‡»è€…å¯ä»¥æ›¿æ¢`/etc/passwd`ä¸ºå…¶ä»–æ•æ„Ÿæ–‡ä»¶è·¯å¾„ï¼Œä»¥è¯»å–å…¶ä»–æ–‡ä»¶å†…å®¹ã€‚

**æ’åºä¼˜å…ˆçº§è¯´æ˜:**
å°½ç®¡æ¼æ´åº“ä¿¡æ¯æä¾›äº†æ¼æ´çš„åŸºæœ¬ä¿¡æ¯ï¼Œä½†æœç´¢å¼•æ“ç»“æœæä¾›äº†æ›´å¹¿æ³›çš„å‚è€ƒä¿¡æ¯ï¼ŒåŒ…æ‹¬å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œå¯èƒ½çš„ç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æ˜¯éªŒè¯æ¼æ´å­˜åœ¨çš„ç›´æ¥è¯æ®ï¼Œå› æ­¤æ¼æ´åˆ©ç”¨ä»£ç çš„ä¼˜å…ˆçº§é«˜äºæ¼æ´åº“ä¿¡æ¯ï¼Œè€Œæœç´¢å¼•æ“ç»“æœçš„ä¼˜å…ˆçº§é«˜äºæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ˜¯å› ä¸ºæœç´¢å¼•æ“ç»“æœå¯ä»¥æä¾›æ›´å…¨é¢çš„ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [xungzzz/CVE-2024-4956](https://github.com/xungzzz/CVE-2024-4956)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)

---

