# CVE-2024-42327

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42327-874anthony_CVE-2024-42327_Zabbix_SQLi.md](../2024/CVE-2024-42327-874anthony_CVE-2024-42327_Zabbix_SQLi.md)

# CVE-2024-42327

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42327-874anthony_CVE-2024-42327_Zabbix_SQLi.md](../2024/CVE-2024-42327-874anthony_CVE-2024-42327_Zabbix_SQLi.md)

# CVE-2024-42327

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42327-874anthony_CVE-2024-42327_Zabbix_SQLi.md](../2024/CVE-2024-42327-874anthony_CVE-2024-42327_Zabbix_SQLi.md)

# CVE-2024-42327

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42327-874anthony_CVE-2024-42327_Zabbix_SQLi.md](../2024/CVE-2024-42327-874anthony_CVE-2024-42327_Zabbix_SQLi.md)

# CVE-2024-42327

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42327-874anthony_CVE-2024-42327_Zabbix_SQLi.md](../2024/CVE-2024-42327-874anthony_CVE-2024-42327_Zabbix_SQLi.md)

# CVE-2024-42327

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42327-874anthony_CVE-2024-42327_Zabbix_SQLi.md](../2024/CVE-2024-42327-874anthony_CVE-2024-42327_Zabbix_SQLi.md)

# CVE-2024-42327

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42327-BridgerAlderson_Zabbix-CVE-2024-42327-SQL-Injection-RCE.md](../2024/CVE-2024-42327-BridgerAlderson_Zabbix-CVE-2024-42327-SQL-Injection-RCE.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致数据泄露、权限提升和远程代码执行

**影响版本:** <=6.0.31, <=6.4.16, <=7.0.1

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-42327是Zabbix服务器中存在的一个SQL注入漏洞。该漏洞位于`CUser`类的`addRelatedObjects`函数中，该函数被`CUser.get`函数调用。由于`CUser.get`函数对所有具有API访问权限的用户都可用，因此，拥有Zabbix前端非管理员用户账户，且具备API访问权限的攻击者，便可以利用此漏洞，通过构造恶意的SQL语句，执行未授权的数据库操作。

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且具有较高的CVSS评分(9.9)。提供的PoC代码旨在利用时间型SQL注入来提取管理员会话ID，然后利用该ID来执行远程代码执行。PoC利用了Zabbix API的user.get方法，通过构造包含`SLEEP()`函数的SQL注入语句来判断管理员会话ID的字符。从代码的逻辑和github的内容来看，利用方式是可行的。

**投毒风险评估：**
分析PoC代码，主要是通过时间盲注的方式，获取admin的sessionid，然后通过sessionid获取权限，执行创建item等操作，最终达到RCE。在给出的代码中，并发线程数量设置成了10。这种设置本身并不直接构成投毒。但存在一种潜在的风险：如果目标服务器的资源非常有限，或者数据库连接数已经接近上限，过多的并发请求可能会导致拒绝服务(DoS)攻击。此外，Payload本身如果连接到外网的服务器，如果外网服务器被控制，也可能被用于恶意用途。

综上，PoC本身存在极低的投毒风险，大约为5%。

**利用方式：**
1.  **身份验证：** 使用Zabbix API的`user.login`方法，通过提供的用户名和密码获取身份验证token（`auth_token`）。
2.  **SQL注入：** 使用Zabbix API的`user.get`方法，构造恶意的SQL查询，利用时间盲注技术逐步提取管理员会话ID（`admin_session`）。
3.  **信息收集：** 使用提取到的`admin_session`，通过Zabbix API的`host.get`请求，获取目标主机和接口的ID。
4.  **远程代码执行：** 利用获取到的主机和接口ID，通过Zabbix API的`item.create`请求，创建一个包含反向shell命令的item，从而在目标服务器上执行任意代码。

**项目地址:** [BridgerAlderson/Zabbix-CVE-2024-42327-SQL-Injection-RCE](https://github.com/BridgerAlderson/Zabbix-CVE-2024-42327-SQL-Injection-RCE)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #2

**来源**: [CVE-2024-42327-aramosf_cve-2024-42327.md](../2024/CVE-2024-42327-aramosf_cve-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升、敏感信息泄露

**影响版本:** <= 7.0.1, <= 6.4.16, <= 6.0.31

**利用条件:** 需要Zabbix前端非管理员用户账户，且该账户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端API中CUser类的addRelatedObjects函数存在SQL注入漏洞。该漏洞允许拥有API访问权限的非管理员用户通过构造恶意的SQL语句来绕过权限验证，执行未授权的数据库操作。 

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用代码的有效性较高。漏洞库信息明确指出该漏洞存在，并提供了受影响的版本范围。搜索结果中，多个来源确认了该漏洞的存在及其严重性，并且有公开的PoC代码（如GitHub链接）。提供的PoC代码脚本通过Zabbix API登录，然后循环获取用户ID的信息，如果成功利用漏洞，可以泄露敏感信息。

**投毒风险：**
提供的PoC代码主要功能是利用SQL注入漏洞获取Zabbix用户信息。代码本身相对简单，主要是通过Zabbix的API进行身份验证和数据获取。虽然使用了`requests`库，但没有发现明显的恶意行为，例如执行系统命令或修改文件等。但是使用者要小心网络传输过程中的流量劫持，如果被投毒替换，则使用者有风险。经过详细分析，认为其中存在投毒代码的可能性较低，大概1%。

**利用方式：**
1.  **身份验证：** 使用有效的Zabbix用户名和密码，通过user.login API方法获取身份验证令牌（auth token）。
2.  **漏洞触发：** 使用获取的auth token，调用user.get API方法，构造包含恶意SQL语句的userids参数。由于CUser类的addRelatedObjects函数存在SQL注入，恶意SQL语句将被执行。
3.  **信息泄露：** 成功利用SQL注入后，攻击者可以获取数据库中的敏感信息，例如用户名、密码哈希等。
4.  **权限提升：**  通过SQL注入，攻击者可能提升自己的权限，甚至获取管理员权限。
5. **远程代码执行:** Github 上有通过此漏洞利用可以获取到RCE的代码。

总而言之，此漏洞的风险在于未经授权的数据访问和潜在的权限提升。PoC的存在以及CVSS评分9.9表明该漏洞较为严重，应及时修复。

**项目地址:** [aramosf/cve-2024-42327](https://github.com/aramosf/cve-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #3

**来源**: [CVE-2024-42327-compr00t_CVE-2024-42327.md](../2024/CVE-2024-42327-compr00t_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 严重，可能导致权限提升和远程代码执行

**影响版本:** <= 7.0.1, 6.4.16, 6.0.31

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户具备API访问权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-42327 是 Zabbix 前端中的一个 SQL 注入漏洞，存在于 `CUser` 类的 `addRelatedObjects` 函数中。此函数被 `CUser.get` 函数调用，而 `CUser.get` 可供任何具有 API 访问权限的用户使用。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断该漏洞利用的有效性较高。

*   漏洞库信息明确指出该漏洞的存在，并给出了受影响的版本范围。
*   搜索引擎结果中，多个网页都提到了该漏洞，包括 NVD、Wiz.io、Qualys 等安全厂商的分析报告，进一步证实了该漏洞的存在。
*   POC 代码中提供了一个可用于测试的 SQL 注入 payload，并详细说明了漏洞触发的条件。

**投毒风险：**

通过分析提供的 POC 代码，发现主要的投毒风险较低，大约为5%。虽然存在一个`compose.yaml`文件用于构建docker环境,但是需要注意,如果攻击者修改了`compose.yaml`或者`compose_zabbix_components.yaml`，可能会引入包含恶意镜像或其他恶意配置的容器。

*   `cve-2024-42327.py` 本身是一个相对简单的 Python 脚本，用于验证漏洞的存在，没有发现明显的恶意代码。
*   `README.md` 文件只是提供了漏洞的描述、POC 代码和参考链接，也没有发现恶意内容。
*   docker-compose 文件(`compose.yaml`, `compose_zabbix_components.yaml`)定义了 Zabbix 服务器和代理的容器配置。虽然这些文件本身没有直接的恶意代码，但恶意修改过的docker-compose文件可能导致以下风险：
    *   **使用被污染的镜像：** 攻击者可以修改 docker-compose 文件，将 ZABBIX_SERVER_MYSQL_IMAGE 等变量指向包含恶意软件的镜像仓库。虽然原文件引用了变量，增加了一点分析难度，但是仍然存在被替换镜像的风险
    *   **卷挂载不当：** 可以通过挂载宿主机目录到容器内，实现文件读写，造成数据泄露或篡改。

**利用方式：**

1.  **获取 Zabbix 前端的非管理员用户账户，并确保该账户具有 API 访问权限。**
2.  **使用 `user.login` 方法获取 API 认证 token。**
3.  **构造包含 SQL 注入 payload 的 `user.get` 请求。**Payload 利用了 `selectRole` 参数，通过注入 `SLEEP(5)` 函数来测试 SQL 注入。
4.  **发送构造好的请求到 `/api_jsonrpc.php` 接口。**
5.  **如果服务器响应时间超过 5 秒，则表明存在 SQL 注入漏洞。**

攻击者成功利用此漏洞后，可以执行任意 SQL 查询，从而可能泄露敏感数据、修改系统配置，甚至获取管理员权限，最终实现远程代码执行。

**项目地址:** [compr00t/CVE-2024-42327](https://github.com/compr00t/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #4

**来源**: [CVE-2024-42327-depers-rus_CVE-2024-42327.md](../2024/CVE-2024-42327-depers-rus_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致数据泄露、权限提升和远程代码执行

**影响版本:** 6.0.0-6.0.31, 6.4.0-6.4.16, 7.0.0-7.0.1

**利用条件:** 需要Zabbix前端的非管理员用户账号，且该账号具备API访问权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端API中user.get方法存在的一个SQL注入漏洞。具有API访问权限的非管理员用户可以通过构造恶意的SQL语句，注入到`selectRole`参数中，从而执行任意SQL查询。该漏洞位于`CUser`类的`addRelatedObjects`函数中，该函数被`CUser.get`函数调用，而`CUser.get`函数对具有API访问权限的任何用户都可用。

**有效性：**
提供的PoC代码是有效的。它首先通过`user.login`方法获取一个API会话令牌，然后使用该令牌调用`user.get`方法，并在`selectRole`参数中注入一个延时注入payload (`pg_sleep()`)。如果响应时间超过预期的延迟，则表示目标服务器存在SQL注入漏洞。PoC代码还尝试从Users表提取信息。

**投毒风险：**
该PoC代码本身旨在验证漏洞的存在并提取用户信息。主要风险来自代码仓库本身。虽然PoC本身没有明显的恶意代码，但是仍然存在一些极低的风险：

*   **依赖风险：**  PoC代码依赖于`requests`模块，如果攻击者替换了`requests`模块或通过其他方式引入了恶意依赖项，则可能导致代码执行。

*   **目标攻击：**  针对特定目标，攻击者可能会修改PoC代码，例如，硬编码特定的数据库凭据或添加后门。

因此，综合评估，投毒风险较低，约为1%。

**利用方式：**
1.  **身份验证：**  攻击者需要一个Zabbix前端的非管理员用户账号，且该账号具备API访问权限。
2.  **获取API令牌：** 使用用户凭据通过`user.login`方法获取API会话令牌。
3.  **SQL注入：**  构造包含恶意SQL payload的JSON请求，通过`user.get`方法，在`selectRole`参数中注入SQL语句。例如，可以使用延时注入来判断漏洞是否存在。
4.  **数据提取/权限提升：**  利用SQL注入漏洞，攻击者可以读取数据库中的敏感数据，例如用户凭据、配置信息等。攻击者还可以尝试通过SQL注入来提升权限，例如创建管理员账号。
5.  **远程代码执行：**  在某些情况下，攻击者可能可以利用SQL注入漏洞执行任意代码。例如，如果Zabbix服务器的数据库用户具有文件写入权限，攻击者可以尝试将恶意代码写入到服务器的文件系统中，然后通过其他方式执行该代码。

**项目地址:** [depers-rus/CVE-2024-42327](https://github.com/depers-rus/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #5

**来源**: [CVE-2024-42327-godylockz_CVE-2024-42327.md](../2024/CVE-2024-42327-godylockz_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可导致权限提升和远程代码执行

**影响版本:** < 6.0.32rc1, < 6.4.17rc1, < 7.0.2rc1

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户需要具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端存在的一个SQL注入漏洞。攻击者通过利用该漏洞，可以泄漏管理员API认证令牌，并在目标服务器上创建item以实现反向shell，最终达到远程代码执行的目的。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞的POC代码是有效的。POC利用了`CUser.get`函数中的SQL注入点，通过注入恶意SQL语句，可以读取`zabbix.sessions`表中的`sessionid`，从而获取管理员的API token，进一步利用API创建监控项，执行任意命令。

**投毒风险：**

分析POC代码后，发现投毒的风险较低。主要代码功能围绕SQL注入利用，获取管理员Token并执行反向shell，没有发现明显恶意或隐藏后门的代码。一些参数如`sleep_time`控制延迟，`threads`控制线程数，这些都是正常利用参数。故风险评估极低。

**利用方式：**

1.  **身份验证：** 使用一个具有API访问权限的非管理员用户账户登录Zabbix前端。
2.  **获取用户API Token：** 调用user.login接口，获取当前用户的API Token
3.  **SQL注入：** 利用`CUser.get` API 中的 SQL 注入点，通过构造恶意的SQL语句来从zabbix.sessions表中提取管理员用户的sessionid。这个sessionid很可能就是管理员用户的API Token。
4.  **获取 Host ID：** 使用host.get方法获取目标主机的hostid
5.  **权限提升：** 使用管理员API认证令牌，提升权限。
6.  **远程代码执行：** 创建一个恶意的监控项，该监控项执行反向shell命令。将反向shell指向攻击者的监听地址。
7.  **反向 Shell：**  目标服务器执行反向shell命令，攻击者获得目标服务器的shell访问权限。

**项目地址:** [godylockz/CVE-2024-42327](https://github.com/godylockz/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #6

**来源**: [CVE-2024-42327-igorbf495_CVE-2024-42327.md](../2024/CVE-2024-42327-igorbf495_CVE-2024-42327.md)

## CVE-2024-42327 - Zabbix SQL 注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL 注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升、数据泄露和远程命令执行

**影响版本:** 6.0.0 <= 6.0.31, 6.4.0 <= 6.4.16, 7.0.0 <= 7.0.1

**利用条件:** 需要 Zabbix 前端非管理员用户账户，且该账户拥有 API 访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42327 是 Zabbix 前端 API 中 CUser 类的 addRelatedObjects 函数中存在的 SQL 注入漏洞。此漏洞允许具有 API 访问权限的非管理员用户利用。根据搜索结果和提供的漏洞利用代码，利用方式如下：

1.  **漏洞利用方式：** 攻击者可以使用 Zabbix API，特别是 user.get 方法，触发 CUser 类的 addRelatedObjects 函数中的 SQL 注入。 攻击者首先通过 user.login 获取 token，然后修改请求参数，调用 user.update 函数， 尝试修改用户角色为超级用户。由于 `usrgrps` 参数缺少验证，可以被滥用，将用户添加到多个用户组中。通过将用户添加到 Zabbix administrators group 等具有无限制权限的组，可以提升用户权限。

2.  **有效性：** 提供的漏洞利用代码包含利用 CVE-2024-42327 的信息。代码展示了如何通过 Zabbix API 进行身份验证，以及如何构造恶意请求来利用 SQL 注入漏洞并尝试提升权限。搜索结果中的多个页面也证实了该漏洞的存在和严重性，以及PoC的存在。

3.  **投毒风险：** 虽然漏洞利用代码主要集中在利用 SQL 注入漏洞，但也存在一定的投毒风险。仔细检查了提供的代码，没有明显的恶意代码。`README.md` 文件主要描述了如何利用漏洞，没有发现作者有意添加的后门或恶意功能。代码中存在的风险主要在于攻击者可能会修改代码，引入恶意的SQL 语句，从而导致被攻击服务器的数据遭到破坏。考虑到代码的复杂性，以及潜在的风险，这里给出10%的投毒风险评估。

**项目地址:** [igorbf495/CVE-2024-42327](https://github.com/igorbf495/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #7

**来源**: [CVE-2024-42327-itform-fr_Zabbix---CVE-2024-42327.md](../2024/CVE-2024-42327-itform-fr_Zabbix---CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升和远程代码执行

**影响版本:** <=6.0.31, <=6.4.16, <=7.0.1

**利用条件:** 需要非管理员用户账户，且该账户拥有API访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42327是Zabbix前端API中存在的一个SQL注入漏洞。非管理员用户，只要拥有API访问权限，就可以利用此漏洞。

**有效性：**

根据漏洞信息和搜索结果，以及提供的PoC代码，可以判定该漏洞利用的有效性较高。PoC代码演示了如何利用SQL注入漏洞，通过`user.get` API获取管理员的会话ID（sessionid）或密码哈希，进而提权执行操作，甚至远程代码执行。

**投毒风险：**

分析PoC代码，发现以下潜在投毒风险：

*   **硬编码依赖：** PoC代码中使用了类似 `u.userid=1` 这样的硬编码，假设管理员用户的ID为1。如果目标系统管理员ID不是1，脚本可能无法正常工作，或者被修改为执行恶意操作。
*   **远程代码执行：** 脚本通过创建和执行Zabbix脚本实现远程代码执行。攻击者可能修改脚本内容，执行任意恶意命令。
*   **权限维持：** 成功提权后，攻击者可以通过创建新的管理员账户来维持对系统的控制。
*   **数据篡改：** 通过SQL注入可以篡改数据库中的数据，影响Zabbix系统的监控数据和配置。

综合判断，该PoC代码存在一定的投毒风险，风险概率估计为10%。风险主要来自于利用成功后的恶意操作，而非PoC本身携带恶意payload。

**利用方式：**

1.  **身份验证：** 使用Zabbix前端的非管理员用户的用户名和密码，通过`user.login` API获取身份验证令牌（token）。
2.  **SQL注入：** 构造恶意的`user.get` API请求，在`selectRole`参数中注入SQL代码。PoC利用SQL注入，尝试获取管理员用户的会话ID或密码哈希。
3.  **权限提升：** 如果成功获取管理员的会话ID，可以使用该ID作为`Authorization` header，冒充管理员执行API操作。
4.  **远程代码执行（RCE）：**  利用管理员权限，创建一个新的Zabbix脚本，脚本内容为经过Base64编码的恶意命令，然后通过`script.execute` API执行该脚本。
5.  **创建用户：** 利用管理员权限，创建一个新的管理员用户，完成持久化攻击。

总体来说，该漏洞的利用涉及多个Zabbix API，结合SQL注入实现权限提升和远程代码执行。利用过程相对复杂，但PoC代码的存在降低了利用难度。

**项目地址:** [itform-fr/Zabbix---CVE-2024-42327](https://github.com/itform-fr/Zabbix---CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #8

**来源**: [CVE-2024-42327-watchdog1337_CVE-2024-42327_Zabbix_SQLI.md](../2024/CVE-2024-42327-watchdog1337_CVE-2024-42327_Zabbix_SQLI.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升和远程代码执行

**影响版本:** 6.0.0 <= version <= 6.0.31
6.4.0 <= version <= 6.4.16
7.0.0 <= version <= 7.0.1

**利用条件:** 需要Zabbix前端访问权限，并且用户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端的一个SQL注入漏洞，存在于`CUser`类的`addRelatedObjects`函数中。该函数被`CUser.get`调用，而`CUser.get`可被任何具有API访问权限的用户访问。漏洞利用方式如下：

1.  **漏洞利用前提：**
    *   拥有Zabbix前端的非管理员用户账户。
    *   该账户具有API访问权限（默认User角色即可）。
2.  **漏洞利用步骤：**
    *   攻击者使用有效的Zabbix用户名和密码通过Zabbix API进行身份验证。
    *   成功身份验证后，获得一个身份验证令牌（auth_token）。
    *   攻击者构造恶意的SQL注入payload，利用`user.get` API方法的`selectRole`参数，将SQL注入语句插入到查询中。
    *   通过Zabbix API发送包含恶意payload的请求。PoC代码提供的exp可用于获取用户credentials, session等信息。

3.  **有效性：**
    根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该POC代码是有效的。搜索引擎结果中已经有github仓库公开了POC。

4. **投毒风险：**
 代码本身是比较直白的SQL注入利用，没有发现明显的恶意代码。但是，requests.get 使用了 `verify=False` 禁用了 SSL 证书验证，存在中间人攻击的风险，可能被注入恶意代码或者窃取凭据.风险评估为1%.

5.  **利用方式总结：**
    攻击者通过API接口，利用SQL注入漏洞，可以读取数据库中的敏感信息，例如用户凭据、session信息等。如果Zabbix数据库权限配置不当，可能导致权限提升，甚至远程代码执行，获取服务器控制权。

**项目地址:** [watchdog1337/CVE-2024-42327_Zabbix_SQLI](https://github.com/watchdog1337/CVE-2024-42327_Zabbix_SQLI)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---



---

## POC #2

**来源**: [CVE-2024-42327-BridgerAlderson_Zabbix-CVE-2024-42327-SQL-Injection-RCE.md](../2024/CVE-2024-42327-BridgerAlderson_Zabbix-CVE-2024-42327-SQL-Injection-RCE.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致数据泄露、权限提升和远程代码执行

**影响版本:** <=6.0.31, <=6.4.16, <=7.0.1

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-42327是Zabbix服务器中存在的一个SQL注入漏洞。该漏洞位于`CUser`类的`addRelatedObjects`函数中，该函数被`CUser.get`函数调用。由于`CUser.get`函数对所有具有API访问权限的用户都可用，因此，拥有Zabbix前端非管理员用户账户，且具备API访问权限的攻击者，便可以利用此漏洞，通过构造恶意的SQL语句，执行未授权的数据库操作。

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且具有较高的CVSS评分(9.9)。提供的PoC代码旨在利用时间型SQL注入来提取管理员会话ID，然后利用该ID来执行远程代码执行。PoC利用了Zabbix API的user.get方法，通过构造包含`SLEEP()`函数的SQL注入语句来判断管理员会话ID的字符。从代码的逻辑和github的内容来看，利用方式是可行的。

**投毒风险评估：**
分析PoC代码，主要是通过时间盲注的方式，获取admin的sessionid，然后通过sessionid获取权限，执行创建item等操作，最终达到RCE。在给出的代码中，并发线程数量设置成了10。这种设置本身并不直接构成投毒。但存在一种潜在的风险：如果目标服务器的资源非常有限，或者数据库连接数已经接近上限，过多的并发请求可能会导致拒绝服务(DoS)攻击。此外，Payload本身如果连接到外网的服务器，如果外网服务器被控制，也可能被用于恶意用途。

综上，PoC本身存在极低的投毒风险，大约为5%。

**利用方式：**
1.  **身份验证：** 使用Zabbix API的`user.login`方法，通过提供的用户名和密码获取身份验证token（`auth_token`）。
2.  **SQL注入：** 使用Zabbix API的`user.get`方法，构造恶意的SQL查询，利用时间盲注技术逐步提取管理员会话ID（`admin_session`）。
3.  **信息收集：** 使用提取到的`admin_session`，通过Zabbix API的`host.get`请求，获取目标主机和接口的ID。
4.  **远程代码执行：** 利用获取到的主机和接口ID，通过Zabbix API的`item.create`请求，创建一个包含反向shell命令的item，从而在目标服务器上执行任意代码。

**项目地址:** [BridgerAlderson/Zabbix-CVE-2024-42327-SQL-Injection-RCE](https://github.com/BridgerAlderson/Zabbix-CVE-2024-42327-SQL-Injection-RCE)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #3

**来源**: [CVE-2024-42327-aramosf_cve-2024-42327.md](../2024/CVE-2024-42327-aramosf_cve-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升、敏感信息泄露

**影响版本:** <= 7.0.1, <= 6.4.16, <= 6.0.31

**利用条件:** 需要Zabbix前端非管理员用户账户，且该账户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端API中CUser类的addRelatedObjects函数存在SQL注入漏洞。该漏洞允许拥有API访问权限的非管理员用户通过构造恶意的SQL语句来绕过权限验证，执行未授权的数据库操作。 

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用代码的有效性较高。漏洞库信息明确指出该漏洞存在，并提供了受影响的版本范围。搜索结果中，多个来源确认了该漏洞的存在及其严重性，并且有公开的PoC代码（如GitHub链接）。提供的PoC代码脚本通过Zabbix API登录，然后循环获取用户ID的信息，如果成功利用漏洞，可以泄露敏感信息。

**投毒风险：**
提供的PoC代码主要功能是利用SQL注入漏洞获取Zabbix用户信息。代码本身相对简单，主要是通过Zabbix的API进行身份验证和数据获取。虽然使用了`requests`库，但没有发现明显的恶意行为，例如执行系统命令或修改文件等。但是使用者要小心网络传输过程中的流量劫持，如果被投毒替换，则使用者有风险。经过详细分析，认为其中存在投毒代码的可能性较低，大概1%。

**利用方式：**
1.  **身份验证：** 使用有效的Zabbix用户名和密码，通过user.login API方法获取身份验证令牌（auth token）。
2.  **漏洞触发：** 使用获取的auth token，调用user.get API方法，构造包含恶意SQL语句的userids参数。由于CUser类的addRelatedObjects函数存在SQL注入，恶意SQL语句将被执行。
3.  **信息泄露：** 成功利用SQL注入后，攻击者可以获取数据库中的敏感信息，例如用户名、密码哈希等。
4.  **权限提升：**  通过SQL注入，攻击者可能提升自己的权限，甚至获取管理员权限。
5. **远程代码执行:** Github 上有通过此漏洞利用可以获取到RCE的代码。

总而言之，此漏洞的风险在于未经授权的数据访问和潜在的权限提升。PoC的存在以及CVSS评分9.9表明该漏洞较为严重，应及时修复。

**项目地址:** [aramosf/cve-2024-42327](https://github.com/aramosf/cve-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #4

**来源**: [CVE-2024-42327-compr00t_CVE-2024-42327.md](../2024/CVE-2024-42327-compr00t_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 严重，可能导致权限提升和远程代码执行

**影响版本:** <= 7.0.1, 6.4.16, 6.0.31

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户具备API访问权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-42327 是 Zabbix 前端中的一个 SQL 注入漏洞，存在于 `CUser` 类的 `addRelatedObjects` 函数中。此函数被 `CUser.get` 函数调用，而 `CUser.get` 可供任何具有 API 访问权限的用户使用。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断该漏洞利用的有效性较高。

*   漏洞库信息明确指出该漏洞的存在，并给出了受影响的版本范围。
*   搜索引擎结果中，多个网页都提到了该漏洞，包括 NVD、Wiz.io、Qualys 等安全厂商的分析报告，进一步证实了该漏洞的存在。
*   POC 代码中提供了一个可用于测试的 SQL 注入 payload，并详细说明了漏洞触发的条件。

**投毒风险：**

通过分析提供的 POC 代码，发现主要的投毒风险较低，大约为5%。虽然存在一个`compose.yaml`文件用于构建docker环境,但是需要注意,如果攻击者修改了`compose.yaml`或者`compose_zabbix_components.yaml`，可能会引入包含恶意镜像或其他恶意配置的容器。

*   `cve-2024-42327.py` 本身是一个相对简单的 Python 脚本，用于验证漏洞的存在，没有发现明显的恶意代码。
*   `README.md` 文件只是提供了漏洞的描述、POC 代码和参考链接，也没有发现恶意内容。
*   docker-compose 文件(`compose.yaml`, `compose_zabbix_components.yaml`)定义了 Zabbix 服务器和代理的容器配置。虽然这些文件本身没有直接的恶意代码，但恶意修改过的docker-compose文件可能导致以下风险：
    *   **使用被污染的镜像：** 攻击者可以修改 docker-compose 文件，将 ZABBIX_SERVER_MYSQL_IMAGE 等变量指向包含恶意软件的镜像仓库。虽然原文件引用了变量，增加了一点分析难度，但是仍然存在被替换镜像的风险
    *   **卷挂载不当：** 可以通过挂载宿主机目录到容器内，实现文件读写，造成数据泄露或篡改。

**利用方式：**

1.  **获取 Zabbix 前端的非管理员用户账户，并确保该账户具有 API 访问权限。**
2.  **使用 `user.login` 方法获取 API 认证 token。**
3.  **构造包含 SQL 注入 payload 的 `user.get` 请求。**Payload 利用了 `selectRole` 参数，通过注入 `SLEEP(5)` 函数来测试 SQL 注入。
4.  **发送构造好的请求到 `/api_jsonrpc.php` 接口。**
5.  **如果服务器响应时间超过 5 秒，则表明存在 SQL 注入漏洞。**

攻击者成功利用此漏洞后，可以执行任意 SQL 查询，从而可能泄露敏感数据、修改系统配置，甚至获取管理员权限，最终实现远程代码执行。

**项目地址:** [compr00t/CVE-2024-42327](https://github.com/compr00t/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #5

**来源**: [CVE-2024-42327-depers-rus_CVE-2024-42327.md](../2024/CVE-2024-42327-depers-rus_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致数据泄露、权限提升和远程代码执行

**影响版本:** 6.0.0-6.0.31, 6.4.0-6.4.16, 7.0.0-7.0.1

**利用条件:** 需要Zabbix前端的非管理员用户账号，且该账号具备API访问权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端API中user.get方法存在的一个SQL注入漏洞。具有API访问权限的非管理员用户可以通过构造恶意的SQL语句，注入到`selectRole`参数中，从而执行任意SQL查询。该漏洞位于`CUser`类的`addRelatedObjects`函数中，该函数被`CUser.get`函数调用，而`CUser.get`函数对具有API访问权限的任何用户都可用。

**有效性：**
提供的PoC代码是有效的。它首先通过`user.login`方法获取一个API会话令牌，然后使用该令牌调用`user.get`方法，并在`selectRole`参数中注入一个延时注入payload (`pg_sleep()`)。如果响应时间超过预期的延迟，则表示目标服务器存在SQL注入漏洞。PoC代码还尝试从Users表提取信息。

**投毒风险：**
该PoC代码本身旨在验证漏洞的存在并提取用户信息。主要风险来自代码仓库本身。虽然PoC本身没有明显的恶意代码，但是仍然存在一些极低的风险：

*   **依赖风险：**  PoC代码依赖于`requests`模块，如果攻击者替换了`requests`模块或通过其他方式引入了恶意依赖项，则可能导致代码执行。

*   **目标攻击：**  针对特定目标，攻击者可能会修改PoC代码，例如，硬编码特定的数据库凭据或添加后门。

因此，综合评估，投毒风险较低，约为1%。

**利用方式：**
1.  **身份验证：**  攻击者需要一个Zabbix前端的非管理员用户账号，且该账号具备API访问权限。
2.  **获取API令牌：** 使用用户凭据通过`user.login`方法获取API会话令牌。
3.  **SQL注入：**  构造包含恶意SQL payload的JSON请求，通过`user.get`方法，在`selectRole`参数中注入SQL语句。例如，可以使用延时注入来判断漏洞是否存在。
4.  **数据提取/权限提升：**  利用SQL注入漏洞，攻击者可以读取数据库中的敏感数据，例如用户凭据、配置信息等。攻击者还可以尝试通过SQL注入来提升权限，例如创建管理员账号。
5.  **远程代码执行：**  在某些情况下，攻击者可能可以利用SQL注入漏洞执行任意代码。例如，如果Zabbix服务器的数据库用户具有文件写入权限，攻击者可以尝试将恶意代码写入到服务器的文件系统中，然后通过其他方式执行该代码。

**项目地址:** [depers-rus/CVE-2024-42327](https://github.com/depers-rus/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #6

**来源**: [CVE-2024-42327-godylockz_CVE-2024-42327.md](../2024/CVE-2024-42327-godylockz_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可导致权限提升和远程代码执行

**影响版本:** < 6.0.32rc1, < 6.4.17rc1, < 7.0.2rc1

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户需要具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端存在的一个SQL注入漏洞。攻击者通过利用该漏洞，可以泄漏管理员API认证令牌，并在目标服务器上创建item以实现反向shell，最终达到远程代码执行的目的。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞的POC代码是有效的。POC利用了`CUser.get`函数中的SQL注入点，通过注入恶意SQL语句，可以读取`zabbix.sessions`表中的`sessionid`，从而获取管理员的API token，进一步利用API创建监控项，执行任意命令。

**投毒风险：**

分析POC代码后，发现投毒的风险较低。主要代码功能围绕SQL注入利用，获取管理员Token并执行反向shell，没有发现明显恶意或隐藏后门的代码。一些参数如`sleep_time`控制延迟，`threads`控制线程数，这些都是正常利用参数。故风险评估极低。

**利用方式：**

1.  **身份验证：** 使用一个具有API访问权限的非管理员用户账户登录Zabbix前端。
2.  **获取用户API Token：** 调用user.login接口，获取当前用户的API Token
3.  **SQL注入：** 利用`CUser.get` API 中的 SQL 注入点，通过构造恶意的SQL语句来从zabbix.sessions表中提取管理员用户的sessionid。这个sessionid很可能就是管理员用户的API Token。
4.  **获取 Host ID：** 使用host.get方法获取目标主机的hostid
5.  **权限提升：** 使用管理员API认证令牌，提升权限。
6.  **远程代码执行：** 创建一个恶意的监控项，该监控项执行反向shell命令。将反向shell指向攻击者的监听地址。
7.  **反向 Shell：**  目标服务器执行反向shell命令，攻击者获得目标服务器的shell访问权限。

**项目地址:** [godylockz/CVE-2024-42327](https://github.com/godylockz/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #7

**来源**: [CVE-2024-42327-igorbf495_CVE-2024-42327.md](../2024/CVE-2024-42327-igorbf495_CVE-2024-42327.md)

## CVE-2024-42327 - Zabbix SQL 注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL 注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升、数据泄露和远程命令执行

**影响版本:** 6.0.0 <= 6.0.31, 6.4.0 <= 6.4.16, 7.0.0 <= 7.0.1

**利用条件:** 需要 Zabbix 前端非管理员用户账户，且该账户拥有 API 访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42327 是 Zabbix 前端 API 中 CUser 类的 addRelatedObjects 函数中存在的 SQL 注入漏洞。此漏洞允许具有 API 访问权限的非管理员用户利用。根据搜索结果和提供的漏洞利用代码，利用方式如下：

1.  **漏洞利用方式：** 攻击者可以使用 Zabbix API，特别是 user.get 方法，触发 CUser 类的 addRelatedObjects 函数中的 SQL 注入。 攻击者首先通过 user.login 获取 token，然后修改请求参数，调用 user.update 函数， 尝试修改用户角色为超级用户。由于 `usrgrps` 参数缺少验证，可以被滥用，将用户添加到多个用户组中。通过将用户添加到 Zabbix administrators group 等具有无限制权限的组，可以提升用户权限。

2.  **有效性：** 提供的漏洞利用代码包含利用 CVE-2024-42327 的信息。代码展示了如何通过 Zabbix API 进行身份验证，以及如何构造恶意请求来利用 SQL 注入漏洞并尝试提升权限。搜索结果中的多个页面也证实了该漏洞的存在和严重性，以及PoC的存在。

3.  **投毒风险：** 虽然漏洞利用代码主要集中在利用 SQL 注入漏洞，但也存在一定的投毒风险。仔细检查了提供的代码，没有明显的恶意代码。`README.md` 文件主要描述了如何利用漏洞，没有发现作者有意添加的后门或恶意功能。代码中存在的风险主要在于攻击者可能会修改代码，引入恶意的SQL 语句，从而导致被攻击服务器的数据遭到破坏。考虑到代码的复杂性，以及潜在的风险，这里给出10%的投毒风险评估。

**项目地址:** [igorbf495/CVE-2024-42327](https://github.com/igorbf495/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #8

**来源**: [CVE-2024-42327-itform-fr_Zabbix---CVE-2024-42327.md](../2024/CVE-2024-42327-itform-fr_Zabbix---CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升和远程代码执行

**影响版本:** <=6.0.31, <=6.4.16, <=7.0.1

**利用条件:** 需要非管理员用户账户，且该账户拥有API访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42327是Zabbix前端API中存在的一个SQL注入漏洞。非管理员用户，只要拥有API访问权限，就可以利用此漏洞。

**有效性：**

根据漏洞信息和搜索结果，以及提供的PoC代码，可以判定该漏洞利用的有效性较高。PoC代码演示了如何利用SQL注入漏洞，通过`user.get` API获取管理员的会话ID（sessionid）或密码哈希，进而提权执行操作，甚至远程代码执行。

**投毒风险：**

分析PoC代码，发现以下潜在投毒风险：

*   **硬编码依赖：** PoC代码中使用了类似 `u.userid=1` 这样的硬编码，假设管理员用户的ID为1。如果目标系统管理员ID不是1，脚本可能无法正常工作，或者被修改为执行恶意操作。
*   **远程代码执行：** 脚本通过创建和执行Zabbix脚本实现远程代码执行。攻击者可能修改脚本内容，执行任意恶意命令。
*   **权限维持：** 成功提权后，攻击者可以通过创建新的管理员账户来维持对系统的控制。
*   **数据篡改：** 通过SQL注入可以篡改数据库中的数据，影响Zabbix系统的监控数据和配置。

综合判断，该PoC代码存在一定的投毒风险，风险概率估计为10%。风险主要来自于利用成功后的恶意操作，而非PoC本身携带恶意payload。

**利用方式：**

1.  **身份验证：** 使用Zabbix前端的非管理员用户的用户名和密码，通过`user.login` API获取身份验证令牌（token）。
2.  **SQL注入：** 构造恶意的`user.get` API请求，在`selectRole`参数中注入SQL代码。PoC利用SQL注入，尝试获取管理员用户的会话ID或密码哈希。
3.  **权限提升：** 如果成功获取管理员的会话ID，可以使用该ID作为`Authorization` header，冒充管理员执行API操作。
4.  **远程代码执行（RCE）：**  利用管理员权限，创建一个新的Zabbix脚本，脚本内容为经过Base64编码的恶意命令，然后通过`script.execute` API执行该脚本。
5.  **创建用户：** 利用管理员权限，创建一个新的管理员用户，完成持久化攻击。

总体来说，该漏洞的利用涉及多个Zabbix API，结合SQL注入实现权限提升和远程代码执行。利用过程相对复杂，但PoC代码的存在降低了利用难度。

**项目地址:** [itform-fr/Zabbix---CVE-2024-42327](https://github.com/itform-fr/Zabbix---CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #9

**来源**: [CVE-2024-42327-watchdog1337_CVE-2024-42327_Zabbix_SQLI.md](../2024/CVE-2024-42327-watchdog1337_CVE-2024-42327_Zabbix_SQLI.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升和远程代码执行

**影响版本:** 6.0.0 <= version <= 6.0.31
6.4.0 <= version <= 6.4.16
7.0.0 <= version <= 7.0.1

**利用条件:** 需要Zabbix前端访问权限，并且用户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端的一个SQL注入漏洞，存在于`CUser`类的`addRelatedObjects`函数中。该函数被`CUser.get`调用，而`CUser.get`可被任何具有API访问权限的用户访问。漏洞利用方式如下：

1.  **漏洞利用前提：**
    *   拥有Zabbix前端的非管理员用户账户。
    *   该账户具有API访问权限（默认User角色即可）。
2.  **漏洞利用步骤：**
    *   攻击者使用有效的Zabbix用户名和密码通过Zabbix API进行身份验证。
    *   成功身份验证后，获得一个身份验证令牌（auth_token）。
    *   攻击者构造恶意的SQL注入payload，利用`user.get` API方法的`selectRole`参数，将SQL注入语句插入到查询中。
    *   通过Zabbix API发送包含恶意payload的请求。PoC代码提供的exp可用于获取用户credentials, session等信息。

3.  **有效性：**
    根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该POC代码是有效的。搜索引擎结果中已经有github仓库公开了POC。

4. **投毒风险：**
 代码本身是比较直白的SQL注入利用，没有发现明显的恶意代码。但是，requests.get 使用了 `verify=False` 禁用了 SSL 证书验证，存在中间人攻击的风险，可能被注入恶意代码或者窃取凭据.风险评估为1%.

5.  **利用方式总结：**
    攻击者通过API接口，利用SQL注入漏洞，可以读取数据库中的敏感信息，例如用户凭据、session信息等。如果Zabbix数据库权限配置不当，可能导致权限提升，甚至远程代码执行，获取服务器控制权。

**项目地址:** [watchdog1337/CVE-2024-42327_Zabbix_SQLI](https://github.com/watchdog1337/CVE-2024-42327_Zabbix_SQLI)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---



---

## POC #2

**来源**: [CVE-2024-42327-BridgerAlderson_Zabbix-CVE-2024-42327-SQL-Injection-RCE.md](../2024/CVE-2024-42327-BridgerAlderson_Zabbix-CVE-2024-42327-SQL-Injection-RCE.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致数据泄露、权限提升和远程代码执行

**影响版本:** <=6.0.31, <=6.4.16, <=7.0.1

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-42327是Zabbix服务器中存在的一个SQL注入漏洞。该漏洞位于`CUser`类的`addRelatedObjects`函数中，该函数被`CUser.get`函数调用。由于`CUser.get`函数对所有具有API访问权限的用户都可用，因此，拥有Zabbix前端非管理员用户账户，且具备API访问权限的攻击者，便可以利用此漏洞，通过构造恶意的SQL语句，执行未授权的数据库操作。

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且具有较高的CVSS评分(9.9)。提供的PoC代码旨在利用时间型SQL注入来提取管理员会话ID，然后利用该ID来执行远程代码执行。PoC利用了Zabbix API的user.get方法，通过构造包含`SLEEP()`函数的SQL注入语句来判断管理员会话ID的字符。从代码的逻辑和github的内容来看，利用方式是可行的。

**投毒风险评估：**
分析PoC代码，主要是通过时间盲注的方式，获取admin的sessionid，然后通过sessionid获取权限，执行创建item等操作，最终达到RCE。在给出的代码中，并发线程数量设置成了10。这种设置本身并不直接构成投毒。但存在一种潜在的风险：如果目标服务器的资源非常有限，或者数据库连接数已经接近上限，过多的并发请求可能会导致拒绝服务(DoS)攻击。此外，Payload本身如果连接到外网的服务器，如果外网服务器被控制，也可能被用于恶意用途。

综上，PoC本身存在极低的投毒风险，大约为5%。

**利用方式：**
1.  **身份验证：** 使用Zabbix API的`user.login`方法，通过提供的用户名和密码获取身份验证token（`auth_token`）。
2.  **SQL注入：** 使用Zabbix API的`user.get`方法，构造恶意的SQL查询，利用时间盲注技术逐步提取管理员会话ID（`admin_session`）。
3.  **信息收集：** 使用提取到的`admin_session`，通过Zabbix API的`host.get`请求，获取目标主机和接口的ID。
4.  **远程代码执行：** 利用获取到的主机和接口ID，通过Zabbix API的`item.create`请求，创建一个包含反向shell命令的item，从而在目标服务器上执行任意代码。

**项目地址:** [BridgerAlderson/Zabbix-CVE-2024-42327-SQL-Injection-RCE](https://github.com/BridgerAlderson/Zabbix-CVE-2024-42327-SQL-Injection-RCE)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #3

**来源**: [CVE-2024-42327-aramosf_cve-2024-42327.md](../2024/CVE-2024-42327-aramosf_cve-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升、敏感信息泄露

**影响版本:** <= 7.0.1, <= 6.4.16, <= 6.0.31

**利用条件:** 需要Zabbix前端非管理员用户账户，且该账户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端API中CUser类的addRelatedObjects函数存在SQL注入漏洞。该漏洞允许拥有API访问权限的非管理员用户通过构造恶意的SQL语句来绕过权限验证，执行未授权的数据库操作。 

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用代码的有效性较高。漏洞库信息明确指出该漏洞存在，并提供了受影响的版本范围。搜索结果中，多个来源确认了该漏洞的存在及其严重性，并且有公开的PoC代码（如GitHub链接）。提供的PoC代码脚本通过Zabbix API登录，然后循环获取用户ID的信息，如果成功利用漏洞，可以泄露敏感信息。

**投毒风险：**
提供的PoC代码主要功能是利用SQL注入漏洞获取Zabbix用户信息。代码本身相对简单，主要是通过Zabbix的API进行身份验证和数据获取。虽然使用了`requests`库，但没有发现明显的恶意行为，例如执行系统命令或修改文件等。但是使用者要小心网络传输过程中的流量劫持，如果被投毒替换，则使用者有风险。经过详细分析，认为其中存在投毒代码的可能性较低，大概1%。

**利用方式：**
1.  **身份验证：** 使用有效的Zabbix用户名和密码，通过user.login API方法获取身份验证令牌（auth token）。
2.  **漏洞触发：** 使用获取的auth token，调用user.get API方法，构造包含恶意SQL语句的userids参数。由于CUser类的addRelatedObjects函数存在SQL注入，恶意SQL语句将被执行。
3.  **信息泄露：** 成功利用SQL注入后，攻击者可以获取数据库中的敏感信息，例如用户名、密码哈希等。
4.  **权限提升：**  通过SQL注入，攻击者可能提升自己的权限，甚至获取管理员权限。
5. **远程代码执行:** Github 上有通过此漏洞利用可以获取到RCE的代码。

总而言之，此漏洞的风险在于未经授权的数据访问和潜在的权限提升。PoC的存在以及CVSS评分9.9表明该漏洞较为严重，应及时修复。

**项目地址:** [aramosf/cve-2024-42327](https://github.com/aramosf/cve-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #4

**来源**: [CVE-2024-42327-compr00t_CVE-2024-42327.md](../2024/CVE-2024-42327-compr00t_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 严重，可能导致权限提升和远程代码执行

**影响版本:** <= 7.0.1, 6.4.16, 6.0.31

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户具备API访问权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-42327 是 Zabbix 前端中的一个 SQL 注入漏洞，存在于 `CUser` 类的 `addRelatedObjects` 函数中。此函数被 `CUser.get` 函数调用，而 `CUser.get` 可供任何具有 API 访问权限的用户使用。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断该漏洞利用的有效性较高。

*   漏洞库信息明确指出该漏洞的存在，并给出了受影响的版本范围。
*   搜索引擎结果中，多个网页都提到了该漏洞，包括 NVD、Wiz.io、Qualys 等安全厂商的分析报告，进一步证实了该漏洞的存在。
*   POC 代码中提供了一个可用于测试的 SQL 注入 payload，并详细说明了漏洞触发的条件。

**投毒风险：**

通过分析提供的 POC 代码，发现主要的投毒风险较低，大约为5%。虽然存在一个`compose.yaml`文件用于构建docker环境,但是需要注意,如果攻击者修改了`compose.yaml`或者`compose_zabbix_components.yaml`，可能会引入包含恶意镜像或其他恶意配置的容器。

*   `cve-2024-42327.py` 本身是一个相对简单的 Python 脚本，用于验证漏洞的存在，没有发现明显的恶意代码。
*   `README.md` 文件只是提供了漏洞的描述、POC 代码和参考链接，也没有发现恶意内容。
*   docker-compose 文件(`compose.yaml`, `compose_zabbix_components.yaml`)定义了 Zabbix 服务器和代理的容器配置。虽然这些文件本身没有直接的恶意代码，但恶意修改过的docker-compose文件可能导致以下风险：
    *   **使用被污染的镜像：** 攻击者可以修改 docker-compose 文件，将 ZABBIX_SERVER_MYSQL_IMAGE 等变量指向包含恶意软件的镜像仓库。虽然原文件引用了变量，增加了一点分析难度，但是仍然存在被替换镜像的风险
    *   **卷挂载不当：** 可以通过挂载宿主机目录到容器内，实现文件读写，造成数据泄露或篡改。

**利用方式：**

1.  **获取 Zabbix 前端的非管理员用户账户，并确保该账户具有 API 访问权限。**
2.  **使用 `user.login` 方法获取 API 认证 token。**
3.  **构造包含 SQL 注入 payload 的 `user.get` 请求。**Payload 利用了 `selectRole` 参数，通过注入 `SLEEP(5)` 函数来测试 SQL 注入。
4.  **发送构造好的请求到 `/api_jsonrpc.php` 接口。**
5.  **如果服务器响应时间超过 5 秒，则表明存在 SQL 注入漏洞。**

攻击者成功利用此漏洞后，可以执行任意 SQL 查询，从而可能泄露敏感数据、修改系统配置，甚至获取管理员权限，最终实现远程代码执行。

**项目地址:** [compr00t/CVE-2024-42327](https://github.com/compr00t/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #5

**来源**: [CVE-2024-42327-depers-rus_CVE-2024-42327.md](../2024/CVE-2024-42327-depers-rus_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致数据泄露、权限提升和远程代码执行

**影响版本:** 6.0.0-6.0.31, 6.4.0-6.4.16, 7.0.0-7.0.1

**利用条件:** 需要Zabbix前端的非管理员用户账号，且该账号具备API访问权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端API中user.get方法存在的一个SQL注入漏洞。具有API访问权限的非管理员用户可以通过构造恶意的SQL语句，注入到`selectRole`参数中，从而执行任意SQL查询。该漏洞位于`CUser`类的`addRelatedObjects`函数中，该函数被`CUser.get`函数调用，而`CUser.get`函数对具有API访问权限的任何用户都可用。

**有效性：**
提供的PoC代码是有效的。它首先通过`user.login`方法获取一个API会话令牌，然后使用该令牌调用`user.get`方法，并在`selectRole`参数中注入一个延时注入payload (`pg_sleep()`)。如果响应时间超过预期的延迟，则表示目标服务器存在SQL注入漏洞。PoC代码还尝试从Users表提取信息。

**投毒风险：**
该PoC代码本身旨在验证漏洞的存在并提取用户信息。主要风险来自代码仓库本身。虽然PoC本身没有明显的恶意代码，但是仍然存在一些极低的风险：

*   **依赖风险：**  PoC代码依赖于`requests`模块，如果攻击者替换了`requests`模块或通过其他方式引入了恶意依赖项，则可能导致代码执行。

*   **目标攻击：**  针对特定目标，攻击者可能会修改PoC代码，例如，硬编码特定的数据库凭据或添加后门。

因此，综合评估，投毒风险较低，约为1%。

**利用方式：**
1.  **身份验证：**  攻击者需要一个Zabbix前端的非管理员用户账号，且该账号具备API访问权限。
2.  **获取API令牌：** 使用用户凭据通过`user.login`方法获取API会话令牌。
3.  **SQL注入：**  构造包含恶意SQL payload的JSON请求，通过`user.get`方法，在`selectRole`参数中注入SQL语句。例如，可以使用延时注入来判断漏洞是否存在。
4.  **数据提取/权限提升：**  利用SQL注入漏洞，攻击者可以读取数据库中的敏感数据，例如用户凭据、配置信息等。攻击者还可以尝试通过SQL注入来提升权限，例如创建管理员账号。
5.  **远程代码执行：**  在某些情况下，攻击者可能可以利用SQL注入漏洞执行任意代码。例如，如果Zabbix服务器的数据库用户具有文件写入权限，攻击者可以尝试将恶意代码写入到服务器的文件系统中，然后通过其他方式执行该代码。

**项目地址:** [depers-rus/CVE-2024-42327](https://github.com/depers-rus/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #6

**来源**: [CVE-2024-42327-godylockz_CVE-2024-42327.md](../2024/CVE-2024-42327-godylockz_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可导致权限提升和远程代码执行

**影响版本:** < 6.0.32rc1, < 6.4.17rc1, < 7.0.2rc1

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户需要具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端存在的一个SQL注入漏洞。攻击者通过利用该漏洞，可以泄漏管理员API认证令牌，并在目标服务器上创建item以实现反向shell，最终达到远程代码执行的目的。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞的POC代码是有效的。POC利用了`CUser.get`函数中的SQL注入点，通过注入恶意SQL语句，可以读取`zabbix.sessions`表中的`sessionid`，从而获取管理员的API token，进一步利用API创建监控项，执行任意命令。

**投毒风险：**

分析POC代码后，发现投毒的风险较低。主要代码功能围绕SQL注入利用，获取管理员Token并执行反向shell，没有发现明显恶意或隐藏后门的代码。一些参数如`sleep_time`控制延迟，`threads`控制线程数，这些都是正常利用参数。故风险评估极低。

**利用方式：**

1.  **身份验证：** 使用一个具有API访问权限的非管理员用户账户登录Zabbix前端。
2.  **获取用户API Token：** 调用user.login接口，获取当前用户的API Token
3.  **SQL注入：** 利用`CUser.get` API 中的 SQL 注入点，通过构造恶意的SQL语句来从zabbix.sessions表中提取管理员用户的sessionid。这个sessionid很可能就是管理员用户的API Token。
4.  **获取 Host ID：** 使用host.get方法获取目标主机的hostid
5.  **权限提升：** 使用管理员API认证令牌，提升权限。
6.  **远程代码执行：** 创建一个恶意的监控项，该监控项执行反向shell命令。将反向shell指向攻击者的监听地址。
7.  **反向 Shell：**  目标服务器执行反向shell命令，攻击者获得目标服务器的shell访问权限。

**项目地址:** [godylockz/CVE-2024-42327](https://github.com/godylockz/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #7

**来源**: [CVE-2024-42327-igorbf495_CVE-2024-42327.md](../2024/CVE-2024-42327-igorbf495_CVE-2024-42327.md)

## CVE-2024-42327 - Zabbix SQL 注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL 注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升、数据泄露和远程命令执行

**影响版本:** 6.0.0 <= 6.0.31, 6.4.0 <= 6.4.16, 7.0.0 <= 7.0.1

**利用条件:** 需要 Zabbix 前端非管理员用户账户，且该账户拥有 API 访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42327 是 Zabbix 前端 API 中 CUser 类的 addRelatedObjects 函数中存在的 SQL 注入漏洞。此漏洞允许具有 API 访问权限的非管理员用户利用。根据搜索结果和提供的漏洞利用代码，利用方式如下：

1.  **漏洞利用方式：** 攻击者可以使用 Zabbix API，特别是 user.get 方法，触发 CUser 类的 addRelatedObjects 函数中的 SQL 注入。 攻击者首先通过 user.login 获取 token，然后修改请求参数，调用 user.update 函数， 尝试修改用户角色为超级用户。由于 `usrgrps` 参数缺少验证，可以被滥用，将用户添加到多个用户组中。通过将用户添加到 Zabbix administrators group 等具有无限制权限的组，可以提升用户权限。

2.  **有效性：** 提供的漏洞利用代码包含利用 CVE-2024-42327 的信息。代码展示了如何通过 Zabbix API 进行身份验证，以及如何构造恶意请求来利用 SQL 注入漏洞并尝试提升权限。搜索结果中的多个页面也证实了该漏洞的存在和严重性，以及PoC的存在。

3.  **投毒风险：** 虽然漏洞利用代码主要集中在利用 SQL 注入漏洞，但也存在一定的投毒风险。仔细检查了提供的代码，没有明显的恶意代码。`README.md` 文件主要描述了如何利用漏洞，没有发现作者有意添加的后门或恶意功能。代码中存在的风险主要在于攻击者可能会修改代码，引入恶意的SQL 语句，从而导致被攻击服务器的数据遭到破坏。考虑到代码的复杂性，以及潜在的风险，这里给出10%的投毒风险评估。

**项目地址:** [igorbf495/CVE-2024-42327](https://github.com/igorbf495/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #8

**来源**: [CVE-2024-42327-itform-fr_Zabbix---CVE-2024-42327.md](../2024/CVE-2024-42327-itform-fr_Zabbix---CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升和远程代码执行

**影响版本:** <=6.0.31, <=6.4.16, <=7.0.1

**利用条件:** 需要非管理员用户账户，且该账户拥有API访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42327是Zabbix前端API中存在的一个SQL注入漏洞。非管理员用户，只要拥有API访问权限，就可以利用此漏洞。

**有效性：**

根据漏洞信息和搜索结果，以及提供的PoC代码，可以判定该漏洞利用的有效性较高。PoC代码演示了如何利用SQL注入漏洞，通过`user.get` API获取管理员的会话ID（sessionid）或密码哈希，进而提权执行操作，甚至远程代码执行。

**投毒风险：**

分析PoC代码，发现以下潜在投毒风险：

*   **硬编码依赖：** PoC代码中使用了类似 `u.userid=1` 这样的硬编码，假设管理员用户的ID为1。如果目标系统管理员ID不是1，脚本可能无法正常工作，或者被修改为执行恶意操作。
*   **远程代码执行：** 脚本通过创建和执行Zabbix脚本实现远程代码执行。攻击者可能修改脚本内容，执行任意恶意命令。
*   **权限维持：** 成功提权后，攻击者可以通过创建新的管理员账户来维持对系统的控制。
*   **数据篡改：** 通过SQL注入可以篡改数据库中的数据，影响Zabbix系统的监控数据和配置。

综合判断，该PoC代码存在一定的投毒风险，风险概率估计为10%。风险主要来自于利用成功后的恶意操作，而非PoC本身携带恶意payload。

**利用方式：**

1.  **身份验证：** 使用Zabbix前端的非管理员用户的用户名和密码，通过`user.login` API获取身份验证令牌（token）。
2.  **SQL注入：** 构造恶意的`user.get` API请求，在`selectRole`参数中注入SQL代码。PoC利用SQL注入，尝试获取管理员用户的会话ID或密码哈希。
3.  **权限提升：** 如果成功获取管理员的会话ID，可以使用该ID作为`Authorization` header，冒充管理员执行API操作。
4.  **远程代码执行（RCE）：**  利用管理员权限，创建一个新的Zabbix脚本，脚本内容为经过Base64编码的恶意命令，然后通过`script.execute` API执行该脚本。
5.  **创建用户：** 利用管理员权限，创建一个新的管理员用户，完成持久化攻击。

总体来说，该漏洞的利用涉及多个Zabbix API，结合SQL注入实现权限提升和远程代码执行。利用过程相对复杂，但PoC代码的存在降低了利用难度。

**项目地址:** [itform-fr/Zabbix---CVE-2024-42327](https://github.com/itform-fr/Zabbix---CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #9

**来源**: [CVE-2024-42327-watchdog1337_CVE-2024-42327_Zabbix_SQLI.md](../2024/CVE-2024-42327-watchdog1337_CVE-2024-42327_Zabbix_SQLI.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升和远程代码执行

**影响版本:** 6.0.0 <= version <= 6.0.31
6.4.0 <= version <= 6.4.16
7.0.0 <= version <= 7.0.1

**利用条件:** 需要Zabbix前端访问权限，并且用户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端的一个SQL注入漏洞，存在于`CUser`类的`addRelatedObjects`函数中。该函数被`CUser.get`调用，而`CUser.get`可被任何具有API访问权限的用户访问。漏洞利用方式如下：

1.  **漏洞利用前提：**
    *   拥有Zabbix前端的非管理员用户账户。
    *   该账户具有API访问权限（默认User角色即可）。
2.  **漏洞利用步骤：**
    *   攻击者使用有效的Zabbix用户名和密码通过Zabbix API进行身份验证。
    *   成功身份验证后，获得一个身份验证令牌（auth_token）。
    *   攻击者构造恶意的SQL注入payload，利用`user.get` API方法的`selectRole`参数，将SQL注入语句插入到查询中。
    *   通过Zabbix API发送包含恶意payload的请求。PoC代码提供的exp可用于获取用户credentials, session等信息。

3.  **有效性：**
    根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该POC代码是有效的。搜索引擎结果中已经有github仓库公开了POC。

4. **投毒风险：**
 代码本身是比较直白的SQL注入利用，没有发现明显的恶意代码。但是，requests.get 使用了 `verify=False` 禁用了 SSL 证书验证，存在中间人攻击的风险，可能被注入恶意代码或者窃取凭据.风险评估为1%.

5.  **利用方式总结：**
    攻击者通过API接口，利用SQL注入漏洞，可以读取数据库中的敏感信息，例如用户凭据、session信息等。如果Zabbix数据库权限配置不当，可能导致权限提升，甚至远程代码执行，获取服务器控制权。

**项目地址:** [watchdog1337/CVE-2024-42327_Zabbix_SQLI](https://github.com/watchdog1337/CVE-2024-42327_Zabbix_SQLI)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---



---

## POC #2

**来源**: [CVE-2024-42327-BridgerAlderson_Zabbix-CVE-2024-42327-SQL-Injection-RCE.md](../2024/CVE-2024-42327-BridgerAlderson_Zabbix-CVE-2024-42327-SQL-Injection-RCE.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致数据泄露、权限提升和远程代码执行

**影响版本:** <=6.0.31, <=6.4.16, <=7.0.1

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-42327是Zabbix服务器中存在的一个SQL注入漏洞。该漏洞位于`CUser`类的`addRelatedObjects`函数中，该函数被`CUser.get`函数调用。由于`CUser.get`函数对所有具有API访问权限的用户都可用，因此，拥有Zabbix前端非管理员用户账户，且具备API访问权限的攻击者，便可以利用此漏洞，通过构造恶意的SQL语句，执行未授权的数据库操作。

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且具有较高的CVSS评分(9.9)。提供的PoC代码旨在利用时间型SQL注入来提取管理员会话ID，然后利用该ID来执行远程代码执行。PoC利用了Zabbix API的user.get方法，通过构造包含`SLEEP()`函数的SQL注入语句来判断管理员会话ID的字符。从代码的逻辑和github的内容来看，利用方式是可行的。

**投毒风险评估：**
分析PoC代码，主要是通过时间盲注的方式，获取admin的sessionid，然后通过sessionid获取权限，执行创建item等操作，最终达到RCE。在给出的代码中，并发线程数量设置成了10。这种设置本身并不直接构成投毒。但存在一种潜在的风险：如果目标服务器的资源非常有限，或者数据库连接数已经接近上限，过多的并发请求可能会导致拒绝服务(DoS)攻击。此外，Payload本身如果连接到外网的服务器，如果外网服务器被控制，也可能被用于恶意用途。

综上，PoC本身存在极低的投毒风险，大约为5%。

**利用方式：**
1.  **身份验证：** 使用Zabbix API的`user.login`方法，通过提供的用户名和密码获取身份验证token（`auth_token`）。
2.  **SQL注入：** 使用Zabbix API的`user.get`方法，构造恶意的SQL查询，利用时间盲注技术逐步提取管理员会话ID（`admin_session`）。
3.  **信息收集：** 使用提取到的`admin_session`，通过Zabbix API的`host.get`请求，获取目标主机和接口的ID。
4.  **远程代码执行：** 利用获取到的主机和接口ID，通过Zabbix API的`item.create`请求，创建一个包含反向shell命令的item，从而在目标服务器上执行任意代码。

**项目地址:** [BridgerAlderson/Zabbix-CVE-2024-42327-SQL-Injection-RCE](https://github.com/BridgerAlderson/Zabbix-CVE-2024-42327-SQL-Injection-RCE)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #3

**来源**: [CVE-2024-42327-aramosf_cve-2024-42327.md](../2024/CVE-2024-42327-aramosf_cve-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升、敏感信息泄露

**影响版本:** <= 7.0.1, <= 6.4.16, <= 6.0.31

**利用条件:** 需要Zabbix前端非管理员用户账户，且该账户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端API中CUser类的addRelatedObjects函数存在SQL注入漏洞。该漏洞允许拥有API访问权限的非管理员用户通过构造恶意的SQL语句来绕过权限验证，执行未授权的数据库操作。 

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用代码的有效性较高。漏洞库信息明确指出该漏洞存在，并提供了受影响的版本范围。搜索结果中，多个来源确认了该漏洞的存在及其严重性，并且有公开的PoC代码（如GitHub链接）。提供的PoC代码脚本通过Zabbix API登录，然后循环获取用户ID的信息，如果成功利用漏洞，可以泄露敏感信息。

**投毒风险：**
提供的PoC代码主要功能是利用SQL注入漏洞获取Zabbix用户信息。代码本身相对简单，主要是通过Zabbix的API进行身份验证和数据获取。虽然使用了`requests`库，但没有发现明显的恶意行为，例如执行系统命令或修改文件等。但是使用者要小心网络传输过程中的流量劫持，如果被投毒替换，则使用者有风险。经过详细分析，认为其中存在投毒代码的可能性较低，大概1%。

**利用方式：**
1.  **身份验证：** 使用有效的Zabbix用户名和密码，通过user.login API方法获取身份验证令牌（auth token）。
2.  **漏洞触发：** 使用获取的auth token，调用user.get API方法，构造包含恶意SQL语句的userids参数。由于CUser类的addRelatedObjects函数存在SQL注入，恶意SQL语句将被执行。
3.  **信息泄露：** 成功利用SQL注入后，攻击者可以获取数据库中的敏感信息，例如用户名、密码哈希等。
4.  **权限提升：**  通过SQL注入，攻击者可能提升自己的权限，甚至获取管理员权限。
5. **远程代码执行:** Github 上有通过此漏洞利用可以获取到RCE的代码。

总而言之，此漏洞的风险在于未经授权的数据访问和潜在的权限提升。PoC的存在以及CVSS评分9.9表明该漏洞较为严重，应及时修复。

**项目地址:** [aramosf/cve-2024-42327](https://github.com/aramosf/cve-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #4

**来源**: [CVE-2024-42327-compr00t_CVE-2024-42327.md](../2024/CVE-2024-42327-compr00t_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 严重，可能导致权限提升和远程代码执行

**影响版本:** <= 7.0.1, 6.4.16, 6.0.31

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户具备API访问权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-42327 是 Zabbix 前端中的一个 SQL 注入漏洞，存在于 `CUser` 类的 `addRelatedObjects` 函数中。此函数被 `CUser.get` 函数调用，而 `CUser.get` 可供任何具有 API 访问权限的用户使用。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断该漏洞利用的有效性较高。

*   漏洞库信息明确指出该漏洞的存在，并给出了受影响的版本范围。
*   搜索引擎结果中，多个网页都提到了该漏洞，包括 NVD、Wiz.io、Qualys 等安全厂商的分析报告，进一步证实了该漏洞的存在。
*   POC 代码中提供了一个可用于测试的 SQL 注入 payload，并详细说明了漏洞触发的条件。

**投毒风险：**

通过分析提供的 POC 代码，发现主要的投毒风险较低，大约为5%。虽然存在一个`compose.yaml`文件用于构建docker环境,但是需要注意,如果攻击者修改了`compose.yaml`或者`compose_zabbix_components.yaml`，可能会引入包含恶意镜像或其他恶意配置的容器。

*   `cve-2024-42327.py` 本身是一个相对简单的 Python 脚本，用于验证漏洞的存在，没有发现明显的恶意代码。
*   `README.md` 文件只是提供了漏洞的描述、POC 代码和参考链接，也没有发现恶意内容。
*   docker-compose 文件(`compose.yaml`, `compose_zabbix_components.yaml`)定义了 Zabbix 服务器和代理的容器配置。虽然这些文件本身没有直接的恶意代码，但恶意修改过的docker-compose文件可能导致以下风险：
    *   **使用被污染的镜像：** 攻击者可以修改 docker-compose 文件，将 ZABBIX_SERVER_MYSQL_IMAGE 等变量指向包含恶意软件的镜像仓库。虽然原文件引用了变量，增加了一点分析难度，但是仍然存在被替换镜像的风险
    *   **卷挂载不当：** 可以通过挂载宿主机目录到容器内，实现文件读写，造成数据泄露或篡改。

**利用方式：**

1.  **获取 Zabbix 前端的非管理员用户账户，并确保该账户具有 API 访问权限。**
2.  **使用 `user.login` 方法获取 API 认证 token。**
3.  **构造包含 SQL 注入 payload 的 `user.get` 请求。**Payload 利用了 `selectRole` 参数，通过注入 `SLEEP(5)` 函数来测试 SQL 注入。
4.  **发送构造好的请求到 `/api_jsonrpc.php` 接口。**
5.  **如果服务器响应时间超过 5 秒，则表明存在 SQL 注入漏洞。**

攻击者成功利用此漏洞后，可以执行任意 SQL 查询，从而可能泄露敏感数据、修改系统配置，甚至获取管理员权限，最终实现远程代码执行。

**项目地址:** [compr00t/CVE-2024-42327](https://github.com/compr00t/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #5

**来源**: [CVE-2024-42327-depers-rus_CVE-2024-42327.md](../2024/CVE-2024-42327-depers-rus_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致数据泄露、权限提升和远程代码执行

**影响版本:** 6.0.0-6.0.31, 6.4.0-6.4.16, 7.0.0-7.0.1

**利用条件:** 需要Zabbix前端的非管理员用户账号，且该账号具备API访问权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端API中user.get方法存在的一个SQL注入漏洞。具有API访问权限的非管理员用户可以通过构造恶意的SQL语句，注入到`selectRole`参数中，从而执行任意SQL查询。该漏洞位于`CUser`类的`addRelatedObjects`函数中，该函数被`CUser.get`函数调用，而`CUser.get`函数对具有API访问权限的任何用户都可用。

**有效性：**
提供的PoC代码是有效的。它首先通过`user.login`方法获取一个API会话令牌，然后使用该令牌调用`user.get`方法，并在`selectRole`参数中注入一个延时注入payload (`pg_sleep()`)。如果响应时间超过预期的延迟，则表示目标服务器存在SQL注入漏洞。PoC代码还尝试从Users表提取信息。

**投毒风险：**
该PoC代码本身旨在验证漏洞的存在并提取用户信息。主要风险来自代码仓库本身。虽然PoC本身没有明显的恶意代码，但是仍然存在一些极低的风险：

*   **依赖风险：**  PoC代码依赖于`requests`模块，如果攻击者替换了`requests`模块或通过其他方式引入了恶意依赖项，则可能导致代码执行。

*   **目标攻击：**  针对特定目标，攻击者可能会修改PoC代码，例如，硬编码特定的数据库凭据或添加后门。

因此，综合评估，投毒风险较低，约为1%。

**利用方式：**
1.  **身份验证：**  攻击者需要一个Zabbix前端的非管理员用户账号，且该账号具备API访问权限。
2.  **获取API令牌：** 使用用户凭据通过`user.login`方法获取API会话令牌。
3.  **SQL注入：**  构造包含恶意SQL payload的JSON请求，通过`user.get`方法，在`selectRole`参数中注入SQL语句。例如，可以使用延时注入来判断漏洞是否存在。
4.  **数据提取/权限提升：**  利用SQL注入漏洞，攻击者可以读取数据库中的敏感数据，例如用户凭据、配置信息等。攻击者还可以尝试通过SQL注入来提升权限，例如创建管理员账号。
5.  **远程代码执行：**  在某些情况下，攻击者可能可以利用SQL注入漏洞执行任意代码。例如，如果Zabbix服务器的数据库用户具有文件写入权限，攻击者可以尝试将恶意代码写入到服务器的文件系统中，然后通过其他方式执行该代码。

**项目地址:** [depers-rus/CVE-2024-42327](https://github.com/depers-rus/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #6

**来源**: [CVE-2024-42327-godylockz_CVE-2024-42327.md](../2024/CVE-2024-42327-godylockz_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可导致权限提升和远程代码执行

**影响版本:** < 6.0.32rc1, < 6.4.17rc1, < 7.0.2rc1

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户需要具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端存在的一个SQL注入漏洞。攻击者通过利用该漏洞，可以泄漏管理员API认证令牌，并在目标服务器上创建item以实现反向shell，最终达到远程代码执行的目的。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞的POC代码是有效的。POC利用了`CUser.get`函数中的SQL注入点，通过注入恶意SQL语句，可以读取`zabbix.sessions`表中的`sessionid`，从而获取管理员的API token，进一步利用API创建监控项，执行任意命令。

**投毒风险：**

分析POC代码后，发现投毒的风险较低。主要代码功能围绕SQL注入利用，获取管理员Token并执行反向shell，没有发现明显恶意或隐藏后门的代码。一些参数如`sleep_time`控制延迟，`threads`控制线程数，这些都是正常利用参数。故风险评估极低。

**利用方式：**

1.  **身份验证：** 使用一个具有API访问权限的非管理员用户账户登录Zabbix前端。
2.  **获取用户API Token：** 调用user.login接口，获取当前用户的API Token
3.  **SQL注入：** 利用`CUser.get` API 中的 SQL 注入点，通过构造恶意的SQL语句来从zabbix.sessions表中提取管理员用户的sessionid。这个sessionid很可能就是管理员用户的API Token。
4.  **获取 Host ID：** 使用host.get方法获取目标主机的hostid
5.  **权限提升：** 使用管理员API认证令牌，提升权限。
6.  **远程代码执行：** 创建一个恶意的监控项，该监控项执行反向shell命令。将反向shell指向攻击者的监听地址。
7.  **反向 Shell：**  目标服务器执行反向shell命令，攻击者获得目标服务器的shell访问权限。

**项目地址:** [godylockz/CVE-2024-42327](https://github.com/godylockz/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #7

**来源**: [CVE-2024-42327-igorbf495_CVE-2024-42327.md](../2024/CVE-2024-42327-igorbf495_CVE-2024-42327.md)

## CVE-2024-42327 - Zabbix SQL 注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL 注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升、数据泄露和远程命令执行

**影响版本:** 6.0.0 <= 6.0.31, 6.4.0 <= 6.4.16, 7.0.0 <= 7.0.1

**利用条件:** 需要 Zabbix 前端非管理员用户账户，且该账户拥有 API 访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42327 是 Zabbix 前端 API 中 CUser 类的 addRelatedObjects 函数中存在的 SQL 注入漏洞。此漏洞允许具有 API 访问权限的非管理员用户利用。根据搜索结果和提供的漏洞利用代码，利用方式如下：

1.  **漏洞利用方式：** 攻击者可以使用 Zabbix API，特别是 user.get 方法，触发 CUser 类的 addRelatedObjects 函数中的 SQL 注入。 攻击者首先通过 user.login 获取 token，然后修改请求参数，调用 user.update 函数， 尝试修改用户角色为超级用户。由于 `usrgrps` 参数缺少验证，可以被滥用，将用户添加到多个用户组中。通过将用户添加到 Zabbix administrators group 等具有无限制权限的组，可以提升用户权限。

2.  **有效性：** 提供的漏洞利用代码包含利用 CVE-2024-42327 的信息。代码展示了如何通过 Zabbix API 进行身份验证，以及如何构造恶意请求来利用 SQL 注入漏洞并尝试提升权限。搜索结果中的多个页面也证实了该漏洞的存在和严重性，以及PoC的存在。

3.  **投毒风险：** 虽然漏洞利用代码主要集中在利用 SQL 注入漏洞，但也存在一定的投毒风险。仔细检查了提供的代码，没有明显的恶意代码。`README.md` 文件主要描述了如何利用漏洞，没有发现作者有意添加的后门或恶意功能。代码中存在的风险主要在于攻击者可能会修改代码，引入恶意的SQL 语句，从而导致被攻击服务器的数据遭到破坏。考虑到代码的复杂性，以及潜在的风险，这里给出10%的投毒风险评估。

**项目地址:** [igorbf495/CVE-2024-42327](https://github.com/igorbf495/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #8

**来源**: [CVE-2024-42327-itform-fr_Zabbix---CVE-2024-42327.md](../2024/CVE-2024-42327-itform-fr_Zabbix---CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升和远程代码执行

**影响版本:** <=6.0.31, <=6.4.16, <=7.0.1

**利用条件:** 需要非管理员用户账户，且该账户拥有API访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42327是Zabbix前端API中存在的一个SQL注入漏洞。非管理员用户，只要拥有API访问权限，就可以利用此漏洞。

**有效性：**

根据漏洞信息和搜索结果，以及提供的PoC代码，可以判定该漏洞利用的有效性较高。PoC代码演示了如何利用SQL注入漏洞，通过`user.get` API获取管理员的会话ID（sessionid）或密码哈希，进而提权执行操作，甚至远程代码执行。

**投毒风险：**

分析PoC代码，发现以下潜在投毒风险：

*   **硬编码依赖：** PoC代码中使用了类似 `u.userid=1` 这样的硬编码，假设管理员用户的ID为1。如果目标系统管理员ID不是1，脚本可能无法正常工作，或者被修改为执行恶意操作。
*   **远程代码执行：** 脚本通过创建和执行Zabbix脚本实现远程代码执行。攻击者可能修改脚本内容，执行任意恶意命令。
*   **权限维持：** 成功提权后，攻击者可以通过创建新的管理员账户来维持对系统的控制。
*   **数据篡改：** 通过SQL注入可以篡改数据库中的数据，影响Zabbix系统的监控数据和配置。

综合判断，该PoC代码存在一定的投毒风险，风险概率估计为10%。风险主要来自于利用成功后的恶意操作，而非PoC本身携带恶意payload。

**利用方式：**

1.  **身份验证：** 使用Zabbix前端的非管理员用户的用户名和密码，通过`user.login` API获取身份验证令牌（token）。
2.  **SQL注入：** 构造恶意的`user.get` API请求，在`selectRole`参数中注入SQL代码。PoC利用SQL注入，尝试获取管理员用户的会话ID或密码哈希。
3.  **权限提升：** 如果成功获取管理员的会话ID，可以使用该ID作为`Authorization` header，冒充管理员执行API操作。
4.  **远程代码执行（RCE）：**  利用管理员权限，创建一个新的Zabbix脚本，脚本内容为经过Base64编码的恶意命令，然后通过`script.execute` API执行该脚本。
5.  **创建用户：** 利用管理员权限，创建一个新的管理员用户，完成持久化攻击。

总体来说，该漏洞的利用涉及多个Zabbix API，结合SQL注入实现权限提升和远程代码执行。利用过程相对复杂，但PoC代码的存在降低了利用难度。

**项目地址:** [itform-fr/Zabbix---CVE-2024-42327](https://github.com/itform-fr/Zabbix---CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #9

**来源**: [CVE-2024-42327-watchdog1337_CVE-2024-42327_Zabbix_SQLI.md](../2024/CVE-2024-42327-watchdog1337_CVE-2024-42327_Zabbix_SQLI.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升和远程代码执行

**影响版本:** 6.0.0 <= version <= 6.0.31
6.4.0 <= version <= 6.4.16
7.0.0 <= version <= 7.0.1

**利用条件:** 需要Zabbix前端访问权限，并且用户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端的一个SQL注入漏洞，存在于`CUser`类的`addRelatedObjects`函数中。该函数被`CUser.get`调用，而`CUser.get`可被任何具有API访问权限的用户访问。漏洞利用方式如下：

1.  **漏洞利用前提：**
    *   拥有Zabbix前端的非管理员用户账户。
    *   该账户具有API访问权限（默认User角色即可）。
2.  **漏洞利用步骤：**
    *   攻击者使用有效的Zabbix用户名和密码通过Zabbix API进行身份验证。
    *   成功身份验证后，获得一个身份验证令牌（auth_token）。
    *   攻击者构造恶意的SQL注入payload，利用`user.get` API方法的`selectRole`参数，将SQL注入语句插入到查询中。
    *   通过Zabbix API发送包含恶意payload的请求。PoC代码提供的exp可用于获取用户credentials, session等信息。

3.  **有效性：**
    根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该POC代码是有效的。搜索引擎结果中已经有github仓库公开了POC。

4. **投毒风险：**
 代码本身是比较直白的SQL注入利用，没有发现明显的恶意代码。但是，requests.get 使用了 `verify=False` 禁用了 SSL 证书验证，存在中间人攻击的风险，可能被注入恶意代码或者窃取凭据.风险评估为1%.

5.  **利用方式总结：**
    攻击者通过API接口，利用SQL注入漏洞，可以读取数据库中的敏感信息，例如用户凭据、session信息等。如果Zabbix数据库权限配置不当，可能导致权限提升，甚至远程代码执行，获取服务器控制权。

**项目地址:** [watchdog1337/CVE-2024-42327_Zabbix_SQLI](https://github.com/watchdog1337/CVE-2024-42327_Zabbix_SQLI)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---



---

## POC #2

**来源**: [CVE-2024-42327-BridgerAlderson_Zabbix-CVE-2024-42327-SQL-Injection-RCE.md](../2024/CVE-2024-42327-BridgerAlderson_Zabbix-CVE-2024-42327-SQL-Injection-RCE.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致数据泄露、权限提升和远程代码执行

**影响版本:** <=6.0.31, <=6.4.16, <=7.0.1

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-42327是Zabbix服务器中存在的一个SQL注入漏洞。该漏洞位于`CUser`类的`addRelatedObjects`函数中，该函数被`CUser.get`函数调用。由于`CUser.get`函数对所有具有API访问权限的用户都可用，因此，拥有Zabbix前端非管理员用户账户，且具备API访问权限的攻击者，便可以利用此漏洞，通过构造恶意的SQL语句，执行未授权的数据库操作。

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且具有较高的CVSS评分(9.9)。提供的PoC代码旨在利用时间型SQL注入来提取管理员会话ID，然后利用该ID来执行远程代码执行。PoC利用了Zabbix API的user.get方法，通过构造包含`SLEEP()`函数的SQL注入语句来判断管理员会话ID的字符。从代码的逻辑和github的内容来看，利用方式是可行的。

**投毒风险评估：**
分析PoC代码，主要是通过时间盲注的方式，获取admin的sessionid，然后通过sessionid获取权限，执行创建item等操作，最终达到RCE。在给出的代码中，并发线程数量设置成了10。这种设置本身并不直接构成投毒。但存在一种潜在的风险：如果目标服务器的资源非常有限，或者数据库连接数已经接近上限，过多的并发请求可能会导致拒绝服务(DoS)攻击。此外，Payload本身如果连接到外网的服务器，如果外网服务器被控制，也可能被用于恶意用途。

综上，PoC本身存在极低的投毒风险，大约为5%。

**利用方式：**
1.  **身份验证：** 使用Zabbix API的`user.login`方法，通过提供的用户名和密码获取身份验证token（`auth_token`）。
2.  **SQL注入：** 使用Zabbix API的`user.get`方法，构造恶意的SQL查询，利用时间盲注技术逐步提取管理员会话ID（`admin_session`）。
3.  **信息收集：** 使用提取到的`admin_session`，通过Zabbix API的`host.get`请求，获取目标主机和接口的ID。
4.  **远程代码执行：** 利用获取到的主机和接口ID，通过Zabbix API的`item.create`请求，创建一个包含反向shell命令的item，从而在目标服务器上执行任意代码。

**项目地址:** [BridgerAlderson/Zabbix-CVE-2024-42327-SQL-Injection-RCE](https://github.com/BridgerAlderson/Zabbix-CVE-2024-42327-SQL-Injection-RCE)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #3

**来源**: [CVE-2024-42327-aramosf_cve-2024-42327.md](../2024/CVE-2024-42327-aramosf_cve-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升、敏感信息泄露

**影响版本:** <= 7.0.1, <= 6.4.16, <= 6.0.31

**利用条件:** 需要Zabbix前端非管理员用户账户，且该账户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端API中CUser类的addRelatedObjects函数存在SQL注入漏洞。该漏洞允许拥有API访问权限的非管理员用户通过构造恶意的SQL语句来绕过权限验证，执行未授权的数据库操作。 

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用代码的有效性较高。漏洞库信息明确指出该漏洞存在，并提供了受影响的版本范围。搜索结果中，多个来源确认了该漏洞的存在及其严重性，并且有公开的PoC代码（如GitHub链接）。提供的PoC代码脚本通过Zabbix API登录，然后循环获取用户ID的信息，如果成功利用漏洞，可以泄露敏感信息。

**投毒风险：**
提供的PoC代码主要功能是利用SQL注入漏洞获取Zabbix用户信息。代码本身相对简单，主要是通过Zabbix的API进行身份验证和数据获取。虽然使用了`requests`库，但没有发现明显的恶意行为，例如执行系统命令或修改文件等。但是使用者要小心网络传输过程中的流量劫持，如果被投毒替换，则使用者有风险。经过详细分析，认为其中存在投毒代码的可能性较低，大概1%。

**利用方式：**
1.  **身份验证：** 使用有效的Zabbix用户名和密码，通过user.login API方法获取身份验证令牌（auth token）。
2.  **漏洞触发：** 使用获取的auth token，调用user.get API方法，构造包含恶意SQL语句的userids参数。由于CUser类的addRelatedObjects函数存在SQL注入，恶意SQL语句将被执行。
3.  **信息泄露：** 成功利用SQL注入后，攻击者可以获取数据库中的敏感信息，例如用户名、密码哈希等。
4.  **权限提升：**  通过SQL注入，攻击者可能提升自己的权限，甚至获取管理员权限。
5. **远程代码执行:** Github 上有通过此漏洞利用可以获取到RCE的代码。

总而言之，此漏洞的风险在于未经授权的数据访问和潜在的权限提升。PoC的存在以及CVSS评分9.9表明该漏洞较为严重，应及时修复。

**项目地址:** [aramosf/cve-2024-42327](https://github.com/aramosf/cve-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #4

**来源**: [CVE-2024-42327-compr00t_CVE-2024-42327.md](../2024/CVE-2024-42327-compr00t_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 严重，可能导致权限提升和远程代码执行

**影响版本:** <= 7.0.1, 6.4.16, 6.0.31

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户具备API访问权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-42327 是 Zabbix 前端中的一个 SQL 注入漏洞，存在于 `CUser` 类的 `addRelatedObjects` 函数中。此函数被 `CUser.get` 函数调用，而 `CUser.get` 可供任何具有 API 访问权限的用户使用。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断该漏洞利用的有效性较高。

*   漏洞库信息明确指出该漏洞的存在，并给出了受影响的版本范围。
*   搜索引擎结果中，多个网页都提到了该漏洞，包括 NVD、Wiz.io、Qualys 等安全厂商的分析报告，进一步证实了该漏洞的存在。
*   POC 代码中提供了一个可用于测试的 SQL 注入 payload，并详细说明了漏洞触发的条件。

**投毒风险：**

通过分析提供的 POC 代码，发现主要的投毒风险较低，大约为5%。虽然存在一个`compose.yaml`文件用于构建docker环境,但是需要注意,如果攻击者修改了`compose.yaml`或者`compose_zabbix_components.yaml`，可能会引入包含恶意镜像或其他恶意配置的容器。

*   `cve-2024-42327.py` 本身是一个相对简单的 Python 脚本，用于验证漏洞的存在，没有发现明显的恶意代码。
*   `README.md` 文件只是提供了漏洞的描述、POC 代码和参考链接，也没有发现恶意内容。
*   docker-compose 文件(`compose.yaml`, `compose_zabbix_components.yaml`)定义了 Zabbix 服务器和代理的容器配置。虽然这些文件本身没有直接的恶意代码，但恶意修改过的docker-compose文件可能导致以下风险：
    *   **使用被污染的镜像：** 攻击者可以修改 docker-compose 文件，将 ZABBIX_SERVER_MYSQL_IMAGE 等变量指向包含恶意软件的镜像仓库。虽然原文件引用了变量，增加了一点分析难度，但是仍然存在被替换镜像的风险
    *   **卷挂载不当：** 可以通过挂载宿主机目录到容器内，实现文件读写，造成数据泄露或篡改。

**利用方式：**

1.  **获取 Zabbix 前端的非管理员用户账户，并确保该账户具有 API 访问权限。**
2.  **使用 `user.login` 方法获取 API 认证 token。**
3.  **构造包含 SQL 注入 payload 的 `user.get` 请求。**Payload 利用了 `selectRole` 参数，通过注入 `SLEEP(5)` 函数来测试 SQL 注入。
4.  **发送构造好的请求到 `/api_jsonrpc.php` 接口。**
5.  **如果服务器响应时间超过 5 秒，则表明存在 SQL 注入漏洞。**

攻击者成功利用此漏洞后，可以执行任意 SQL 查询，从而可能泄露敏感数据、修改系统配置，甚至获取管理员权限，最终实现远程代码执行。

**项目地址:** [compr00t/CVE-2024-42327](https://github.com/compr00t/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #5

**来源**: [CVE-2024-42327-depers-rus_CVE-2024-42327.md](../2024/CVE-2024-42327-depers-rus_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致数据泄露、权限提升和远程代码执行

**影响版本:** 6.0.0-6.0.31, 6.4.0-6.4.16, 7.0.0-7.0.1

**利用条件:** 需要Zabbix前端的非管理员用户账号，且该账号具备API访问权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端API中user.get方法存在的一个SQL注入漏洞。具有API访问权限的非管理员用户可以通过构造恶意的SQL语句，注入到`selectRole`参数中，从而执行任意SQL查询。该漏洞位于`CUser`类的`addRelatedObjects`函数中，该函数被`CUser.get`函数调用，而`CUser.get`函数对具有API访问权限的任何用户都可用。

**有效性：**
提供的PoC代码是有效的。它首先通过`user.login`方法获取一个API会话令牌，然后使用该令牌调用`user.get`方法，并在`selectRole`参数中注入一个延时注入payload (`pg_sleep()`)。如果响应时间超过预期的延迟，则表示目标服务器存在SQL注入漏洞。PoC代码还尝试从Users表提取信息。

**投毒风险：**
该PoC代码本身旨在验证漏洞的存在并提取用户信息。主要风险来自代码仓库本身。虽然PoC本身没有明显的恶意代码，但是仍然存在一些极低的风险：

*   **依赖风险：**  PoC代码依赖于`requests`模块，如果攻击者替换了`requests`模块或通过其他方式引入了恶意依赖项，则可能导致代码执行。

*   **目标攻击：**  针对特定目标，攻击者可能会修改PoC代码，例如，硬编码特定的数据库凭据或添加后门。

因此，综合评估，投毒风险较低，约为1%。

**利用方式：**
1.  **身份验证：**  攻击者需要一个Zabbix前端的非管理员用户账号，且该账号具备API访问权限。
2.  **获取API令牌：** 使用用户凭据通过`user.login`方法获取API会话令牌。
3.  **SQL注入：**  构造包含恶意SQL payload的JSON请求，通过`user.get`方法，在`selectRole`参数中注入SQL语句。例如，可以使用延时注入来判断漏洞是否存在。
4.  **数据提取/权限提升：**  利用SQL注入漏洞，攻击者可以读取数据库中的敏感数据，例如用户凭据、配置信息等。攻击者还可以尝试通过SQL注入来提升权限，例如创建管理员账号。
5.  **远程代码执行：**  在某些情况下，攻击者可能可以利用SQL注入漏洞执行任意代码。例如，如果Zabbix服务器的数据库用户具有文件写入权限，攻击者可以尝试将恶意代码写入到服务器的文件系统中，然后通过其他方式执行该代码。

**项目地址:** [depers-rus/CVE-2024-42327](https://github.com/depers-rus/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #6

**来源**: [CVE-2024-42327-godylockz_CVE-2024-42327.md](../2024/CVE-2024-42327-godylockz_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可导致权限提升和远程代码执行

**影响版本:** < 6.0.32rc1, < 6.4.17rc1, < 7.0.2rc1

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户需要具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端存在的一个SQL注入漏洞。攻击者通过利用该漏洞，可以泄漏管理员API认证令牌，并在目标服务器上创建item以实现反向shell，最终达到远程代码执行的目的。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞的POC代码是有效的。POC利用了`CUser.get`函数中的SQL注入点，通过注入恶意SQL语句，可以读取`zabbix.sessions`表中的`sessionid`，从而获取管理员的API token，进一步利用API创建监控项，执行任意命令。

**投毒风险：**

分析POC代码后，发现投毒的风险较低。主要代码功能围绕SQL注入利用，获取管理员Token并执行反向shell，没有发现明显恶意或隐藏后门的代码。一些参数如`sleep_time`控制延迟，`threads`控制线程数，这些都是正常利用参数。故风险评估极低。

**利用方式：**

1.  **身份验证：** 使用一个具有API访问权限的非管理员用户账户登录Zabbix前端。
2.  **获取用户API Token：** 调用user.login接口，获取当前用户的API Token
3.  **SQL注入：** 利用`CUser.get` API 中的 SQL 注入点，通过构造恶意的SQL语句来从zabbix.sessions表中提取管理员用户的sessionid。这个sessionid很可能就是管理员用户的API Token。
4.  **获取 Host ID：** 使用host.get方法获取目标主机的hostid
5.  **权限提升：** 使用管理员API认证令牌，提升权限。
6.  **远程代码执行：** 创建一个恶意的监控项，该监控项执行反向shell命令。将反向shell指向攻击者的监听地址。
7.  **反向 Shell：**  目标服务器执行反向shell命令，攻击者获得目标服务器的shell访问权限。

**项目地址:** [godylockz/CVE-2024-42327](https://github.com/godylockz/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #7

**来源**: [CVE-2024-42327-igorbf495_CVE-2024-42327.md](../2024/CVE-2024-42327-igorbf495_CVE-2024-42327.md)

## CVE-2024-42327 - Zabbix SQL 注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL 注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升、数据泄露和远程命令执行

**影响版本:** 6.0.0 <= 6.0.31, 6.4.0 <= 6.4.16, 7.0.0 <= 7.0.1

**利用条件:** 需要 Zabbix 前端非管理员用户账户，且该账户拥有 API 访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42327 是 Zabbix 前端 API 中 CUser 类的 addRelatedObjects 函数中存在的 SQL 注入漏洞。此漏洞允许具有 API 访问权限的非管理员用户利用。根据搜索结果和提供的漏洞利用代码，利用方式如下：

1.  **漏洞利用方式：** 攻击者可以使用 Zabbix API，特别是 user.get 方法，触发 CUser 类的 addRelatedObjects 函数中的 SQL 注入。 攻击者首先通过 user.login 获取 token，然后修改请求参数，调用 user.update 函数， 尝试修改用户角色为超级用户。由于 `usrgrps` 参数缺少验证，可以被滥用，将用户添加到多个用户组中。通过将用户添加到 Zabbix administrators group 等具有无限制权限的组，可以提升用户权限。

2.  **有效性：** 提供的漏洞利用代码包含利用 CVE-2024-42327 的信息。代码展示了如何通过 Zabbix API 进行身份验证，以及如何构造恶意请求来利用 SQL 注入漏洞并尝试提升权限。搜索结果中的多个页面也证实了该漏洞的存在和严重性，以及PoC的存在。

3.  **投毒风险：** 虽然漏洞利用代码主要集中在利用 SQL 注入漏洞，但也存在一定的投毒风险。仔细检查了提供的代码，没有明显的恶意代码。`README.md` 文件主要描述了如何利用漏洞，没有发现作者有意添加的后门或恶意功能。代码中存在的风险主要在于攻击者可能会修改代码，引入恶意的SQL 语句，从而导致被攻击服务器的数据遭到破坏。考虑到代码的复杂性，以及潜在的风险，这里给出10%的投毒风险评估。

**项目地址:** [igorbf495/CVE-2024-42327](https://github.com/igorbf495/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #8

**来源**: [CVE-2024-42327-itform-fr_Zabbix---CVE-2024-42327.md](../2024/CVE-2024-42327-itform-fr_Zabbix---CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升和远程代码执行

**影响版本:** <=6.0.31, <=6.4.16, <=7.0.1

**利用条件:** 需要非管理员用户账户，且该账户拥有API访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42327是Zabbix前端API中存在的一个SQL注入漏洞。非管理员用户，只要拥有API访问权限，就可以利用此漏洞。

**有效性：**

根据漏洞信息和搜索结果，以及提供的PoC代码，可以判定该漏洞利用的有效性较高。PoC代码演示了如何利用SQL注入漏洞，通过`user.get` API获取管理员的会话ID（sessionid）或密码哈希，进而提权执行操作，甚至远程代码执行。

**投毒风险：**

分析PoC代码，发现以下潜在投毒风险：

*   **硬编码依赖：** PoC代码中使用了类似 `u.userid=1` 这样的硬编码，假设管理员用户的ID为1。如果目标系统管理员ID不是1，脚本可能无法正常工作，或者被修改为执行恶意操作。
*   **远程代码执行：** 脚本通过创建和执行Zabbix脚本实现远程代码执行。攻击者可能修改脚本内容，执行任意恶意命令。
*   **权限维持：** 成功提权后，攻击者可以通过创建新的管理员账户来维持对系统的控制。
*   **数据篡改：** 通过SQL注入可以篡改数据库中的数据，影响Zabbix系统的监控数据和配置。

综合判断，该PoC代码存在一定的投毒风险，风险概率估计为10%。风险主要来自于利用成功后的恶意操作，而非PoC本身携带恶意payload。

**利用方式：**

1.  **身份验证：** 使用Zabbix前端的非管理员用户的用户名和密码，通过`user.login` API获取身份验证令牌（token）。
2.  **SQL注入：** 构造恶意的`user.get` API请求，在`selectRole`参数中注入SQL代码。PoC利用SQL注入，尝试获取管理员用户的会话ID或密码哈希。
3.  **权限提升：** 如果成功获取管理员的会话ID，可以使用该ID作为`Authorization` header，冒充管理员执行API操作。
4.  **远程代码执行（RCE）：**  利用管理员权限，创建一个新的Zabbix脚本，脚本内容为经过Base64编码的恶意命令，然后通过`script.execute` API执行该脚本。
5.  **创建用户：** 利用管理员权限，创建一个新的管理员用户，完成持久化攻击。

总体来说，该漏洞的利用涉及多个Zabbix API，结合SQL注入实现权限提升和远程代码执行。利用过程相对复杂，但PoC代码的存在降低了利用难度。

**项目地址:** [itform-fr/Zabbix---CVE-2024-42327](https://github.com/itform-fr/Zabbix---CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #9

**来源**: [CVE-2024-42327-watchdog1337_CVE-2024-42327_Zabbix_SQLI.md](../2024/CVE-2024-42327-watchdog1337_CVE-2024-42327_Zabbix_SQLI.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升和远程代码执行

**影响版本:** 6.0.0 <= version <= 6.0.31
6.4.0 <= version <= 6.4.16
7.0.0 <= version <= 7.0.1

**利用条件:** 需要Zabbix前端访问权限，并且用户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端的一个SQL注入漏洞，存在于`CUser`类的`addRelatedObjects`函数中。该函数被`CUser.get`调用，而`CUser.get`可被任何具有API访问权限的用户访问。漏洞利用方式如下：

1.  **漏洞利用前提：**
    *   拥有Zabbix前端的非管理员用户账户。
    *   该账户具有API访问权限（默认User角色即可）。
2.  **漏洞利用步骤：**
    *   攻击者使用有效的Zabbix用户名和密码通过Zabbix API进行身份验证。
    *   成功身份验证后，获得一个身份验证令牌（auth_token）。
    *   攻击者构造恶意的SQL注入payload，利用`user.get` API方法的`selectRole`参数，将SQL注入语句插入到查询中。
    *   通过Zabbix API发送包含恶意payload的请求。PoC代码提供的exp可用于获取用户credentials, session等信息。

3.  **有效性：**
    根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该POC代码是有效的。搜索引擎结果中已经有github仓库公开了POC。

4. **投毒风险：**
 代码本身是比较直白的SQL注入利用，没有发现明显的恶意代码。但是，requests.get 使用了 `verify=False` 禁用了 SSL 证书验证，存在中间人攻击的风险，可能被注入恶意代码或者窃取凭据.风险评估为1%.

5.  **利用方式总结：**
    攻击者通过API接口，利用SQL注入漏洞，可以读取数据库中的敏感信息，例如用户凭据、session信息等。如果Zabbix数据库权限配置不当，可能导致权限提升，甚至远程代码执行，获取服务器控制权。

**项目地址:** [watchdog1337/CVE-2024-42327_Zabbix_SQLI](https://github.com/watchdog1337/CVE-2024-42327_Zabbix_SQLI)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---



---

## POC #2

**来源**: [CVE-2024-42327-BridgerAlderson_Zabbix-CVE-2024-42327-SQL-Injection-RCE.md](../2024/CVE-2024-42327-BridgerAlderson_Zabbix-CVE-2024-42327-SQL-Injection-RCE.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致数据泄露、权限提升和远程代码执行

**影响版本:** <=6.0.31, <=6.4.16, <=7.0.1

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-42327是Zabbix服务器中存在的一个SQL注入漏洞。该漏洞位于`CUser`类的`addRelatedObjects`函数中，该函数被`CUser.get`函数调用。由于`CUser.get`函数对所有具有API访问权限的用户都可用，因此，拥有Zabbix前端非管理员用户账户，且具备API访问权限的攻击者，便可以利用此漏洞，通过构造恶意的SQL语句，执行未授权的数据库操作。

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且具有较高的CVSS评分(9.9)。提供的PoC代码旨在利用时间型SQL注入来提取管理员会话ID，然后利用该ID来执行远程代码执行。PoC利用了Zabbix API的user.get方法，通过构造包含`SLEEP()`函数的SQL注入语句来判断管理员会话ID的字符。从代码的逻辑和github的内容来看，利用方式是可行的。

**投毒风险评估：**
分析PoC代码，主要是通过时间盲注的方式，获取admin的sessionid，然后通过sessionid获取权限，执行创建item等操作，最终达到RCE。在给出的代码中，并发线程数量设置成了10。这种设置本身并不直接构成投毒。但存在一种潜在的风险：如果目标服务器的资源非常有限，或者数据库连接数已经接近上限，过多的并发请求可能会导致拒绝服务(DoS)攻击。此外，Payload本身如果连接到外网的服务器，如果外网服务器被控制，也可能被用于恶意用途。

综上，PoC本身存在极低的投毒风险，大约为5%。

**利用方式：**
1.  **身份验证：** 使用Zabbix API的`user.login`方法，通过提供的用户名和密码获取身份验证token（`auth_token`）。
2.  **SQL注入：** 使用Zabbix API的`user.get`方法，构造恶意的SQL查询，利用时间盲注技术逐步提取管理员会话ID（`admin_session`）。
3.  **信息收集：** 使用提取到的`admin_session`，通过Zabbix API的`host.get`请求，获取目标主机和接口的ID。
4.  **远程代码执行：** 利用获取到的主机和接口ID，通过Zabbix API的`item.create`请求，创建一个包含反向shell命令的item，从而在目标服务器上执行任意代码。

**项目地址:** [BridgerAlderson/Zabbix-CVE-2024-42327-SQL-Injection-RCE](https://github.com/BridgerAlderson/Zabbix-CVE-2024-42327-SQL-Injection-RCE)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #3

**来源**: [CVE-2024-42327-aramosf_cve-2024-42327.md](../2024/CVE-2024-42327-aramosf_cve-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升、敏感信息泄露

**影响版本:** <= 7.0.1, <= 6.4.16, <= 6.0.31

**利用条件:** 需要Zabbix前端非管理员用户账户，且该账户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端API中CUser类的addRelatedObjects函数存在SQL注入漏洞。该漏洞允许拥有API访问权限的非管理员用户通过构造恶意的SQL语句来绕过权限验证，执行未授权的数据库操作。 

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用代码的有效性较高。漏洞库信息明确指出该漏洞存在，并提供了受影响的版本范围。搜索结果中，多个来源确认了该漏洞的存在及其严重性，并且有公开的PoC代码（如GitHub链接）。提供的PoC代码脚本通过Zabbix API登录，然后循环获取用户ID的信息，如果成功利用漏洞，可以泄露敏感信息。

**投毒风险：**
提供的PoC代码主要功能是利用SQL注入漏洞获取Zabbix用户信息。代码本身相对简单，主要是通过Zabbix的API进行身份验证和数据获取。虽然使用了`requests`库，但没有发现明显的恶意行为，例如执行系统命令或修改文件等。但是使用者要小心网络传输过程中的流量劫持，如果被投毒替换，则使用者有风险。经过详细分析，认为其中存在投毒代码的可能性较低，大概1%。

**利用方式：**
1.  **身份验证：** 使用有效的Zabbix用户名和密码，通过user.login API方法获取身份验证令牌（auth token）。
2.  **漏洞触发：** 使用获取的auth token，调用user.get API方法，构造包含恶意SQL语句的userids参数。由于CUser类的addRelatedObjects函数存在SQL注入，恶意SQL语句将被执行。
3.  **信息泄露：** 成功利用SQL注入后，攻击者可以获取数据库中的敏感信息，例如用户名、密码哈希等。
4.  **权限提升：**  通过SQL注入，攻击者可能提升自己的权限，甚至获取管理员权限。
5. **远程代码执行:** Github 上有通过此漏洞利用可以获取到RCE的代码。

总而言之，此漏洞的风险在于未经授权的数据访问和潜在的权限提升。PoC的存在以及CVSS评分9.9表明该漏洞较为严重，应及时修复。

**项目地址:** [aramosf/cve-2024-42327](https://github.com/aramosf/cve-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #4

**来源**: [CVE-2024-42327-compr00t_CVE-2024-42327.md](../2024/CVE-2024-42327-compr00t_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 严重，可能导致权限提升和远程代码执行

**影响版本:** <= 7.0.1, 6.4.16, 6.0.31

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户具备API访问权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-42327 是 Zabbix 前端中的一个 SQL 注入漏洞，存在于 `CUser` 类的 `addRelatedObjects` 函数中。此函数被 `CUser.get` 函数调用，而 `CUser.get` 可供任何具有 API 访问权限的用户使用。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断该漏洞利用的有效性较高。

*   漏洞库信息明确指出该漏洞的存在，并给出了受影响的版本范围。
*   搜索引擎结果中，多个网页都提到了该漏洞，包括 NVD、Wiz.io、Qualys 等安全厂商的分析报告，进一步证实了该漏洞的存在。
*   POC 代码中提供了一个可用于测试的 SQL 注入 payload，并详细说明了漏洞触发的条件。

**投毒风险：**

通过分析提供的 POC 代码，发现主要的投毒风险较低，大约为5%。虽然存在一个`compose.yaml`文件用于构建docker环境,但是需要注意,如果攻击者修改了`compose.yaml`或者`compose_zabbix_components.yaml`，可能会引入包含恶意镜像或其他恶意配置的容器。

*   `cve-2024-42327.py` 本身是一个相对简单的 Python 脚本，用于验证漏洞的存在，没有发现明显的恶意代码。
*   `README.md` 文件只是提供了漏洞的描述、POC 代码和参考链接，也没有发现恶意内容。
*   docker-compose 文件(`compose.yaml`, `compose_zabbix_components.yaml`)定义了 Zabbix 服务器和代理的容器配置。虽然这些文件本身没有直接的恶意代码，但恶意修改过的docker-compose文件可能导致以下风险：
    *   **使用被污染的镜像：** 攻击者可以修改 docker-compose 文件，将 ZABBIX_SERVER_MYSQL_IMAGE 等变量指向包含恶意软件的镜像仓库。虽然原文件引用了变量，增加了一点分析难度，但是仍然存在被替换镜像的风险
    *   **卷挂载不当：** 可以通过挂载宿主机目录到容器内，实现文件读写，造成数据泄露或篡改。

**利用方式：**

1.  **获取 Zabbix 前端的非管理员用户账户，并确保该账户具有 API 访问权限。**
2.  **使用 `user.login` 方法获取 API 认证 token。**
3.  **构造包含 SQL 注入 payload 的 `user.get` 请求。**Payload 利用了 `selectRole` 参数，通过注入 `SLEEP(5)` 函数来测试 SQL 注入。
4.  **发送构造好的请求到 `/api_jsonrpc.php` 接口。**
5.  **如果服务器响应时间超过 5 秒，则表明存在 SQL 注入漏洞。**

攻击者成功利用此漏洞后，可以执行任意 SQL 查询，从而可能泄露敏感数据、修改系统配置，甚至获取管理员权限，最终实现远程代码执行。

**项目地址:** [compr00t/CVE-2024-42327](https://github.com/compr00t/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #5

**来源**: [CVE-2024-42327-depers-rus_CVE-2024-42327.md](../2024/CVE-2024-42327-depers-rus_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致数据泄露、权限提升和远程代码执行

**影响版本:** 6.0.0-6.0.31, 6.4.0-6.4.16, 7.0.0-7.0.1

**利用条件:** 需要Zabbix前端的非管理员用户账号，且该账号具备API访问权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端API中user.get方法存在的一个SQL注入漏洞。具有API访问权限的非管理员用户可以通过构造恶意的SQL语句，注入到`selectRole`参数中，从而执行任意SQL查询。该漏洞位于`CUser`类的`addRelatedObjects`函数中，该函数被`CUser.get`函数调用，而`CUser.get`函数对具有API访问权限的任何用户都可用。

**有效性：**
提供的PoC代码是有效的。它首先通过`user.login`方法获取一个API会话令牌，然后使用该令牌调用`user.get`方法，并在`selectRole`参数中注入一个延时注入payload (`pg_sleep()`)。如果响应时间超过预期的延迟，则表示目标服务器存在SQL注入漏洞。PoC代码还尝试从Users表提取信息。

**投毒风险：**
该PoC代码本身旨在验证漏洞的存在并提取用户信息。主要风险来自代码仓库本身。虽然PoC本身没有明显的恶意代码，但是仍然存在一些极低的风险：

*   **依赖风险：**  PoC代码依赖于`requests`模块，如果攻击者替换了`requests`模块或通过其他方式引入了恶意依赖项，则可能导致代码执行。

*   **目标攻击：**  针对特定目标，攻击者可能会修改PoC代码，例如，硬编码特定的数据库凭据或添加后门。

因此，综合评估，投毒风险较低，约为1%。

**利用方式：**
1.  **身份验证：**  攻击者需要一个Zabbix前端的非管理员用户账号，且该账号具备API访问权限。
2.  **获取API令牌：** 使用用户凭据通过`user.login`方法获取API会话令牌。
3.  **SQL注入：**  构造包含恶意SQL payload的JSON请求，通过`user.get`方法，在`selectRole`参数中注入SQL语句。例如，可以使用延时注入来判断漏洞是否存在。
4.  **数据提取/权限提升：**  利用SQL注入漏洞，攻击者可以读取数据库中的敏感数据，例如用户凭据、配置信息等。攻击者还可以尝试通过SQL注入来提升权限，例如创建管理员账号。
5.  **远程代码执行：**  在某些情况下，攻击者可能可以利用SQL注入漏洞执行任意代码。例如，如果Zabbix服务器的数据库用户具有文件写入权限，攻击者可以尝试将恶意代码写入到服务器的文件系统中，然后通过其他方式执行该代码。

**项目地址:** [depers-rus/CVE-2024-42327](https://github.com/depers-rus/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #6

**来源**: [CVE-2024-42327-godylockz_CVE-2024-42327.md](../2024/CVE-2024-42327-godylockz_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可导致权限提升和远程代码执行

**影响版本:** < 6.0.32rc1, < 6.4.17rc1, < 7.0.2rc1

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户需要具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端存在的一个SQL注入漏洞。攻击者通过利用该漏洞，可以泄漏管理员API认证令牌，并在目标服务器上创建item以实现反向shell，最终达到远程代码执行的目的。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞的POC代码是有效的。POC利用了`CUser.get`函数中的SQL注入点，通过注入恶意SQL语句，可以读取`zabbix.sessions`表中的`sessionid`，从而获取管理员的API token，进一步利用API创建监控项，执行任意命令。

**投毒风险：**

分析POC代码后，发现投毒的风险较低。主要代码功能围绕SQL注入利用，获取管理员Token并执行反向shell，没有发现明显恶意或隐藏后门的代码。一些参数如`sleep_time`控制延迟，`threads`控制线程数，这些都是正常利用参数。故风险评估极低。

**利用方式：**

1.  **身份验证：** 使用一个具有API访问权限的非管理员用户账户登录Zabbix前端。
2.  **获取用户API Token：** 调用user.login接口，获取当前用户的API Token
3.  **SQL注入：** 利用`CUser.get` API 中的 SQL 注入点，通过构造恶意的SQL语句来从zabbix.sessions表中提取管理员用户的sessionid。这个sessionid很可能就是管理员用户的API Token。
4.  **获取 Host ID：** 使用host.get方法获取目标主机的hostid
5.  **权限提升：** 使用管理员API认证令牌，提升权限。
6.  **远程代码执行：** 创建一个恶意的监控项，该监控项执行反向shell命令。将反向shell指向攻击者的监听地址。
7.  **反向 Shell：**  目标服务器执行反向shell命令，攻击者获得目标服务器的shell访问权限。

**项目地址:** [godylockz/CVE-2024-42327](https://github.com/godylockz/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #7

**来源**: [CVE-2024-42327-igorbf495_CVE-2024-42327.md](../2024/CVE-2024-42327-igorbf495_CVE-2024-42327.md)

## CVE-2024-42327 - Zabbix SQL 注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL 注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升、数据泄露和远程命令执行

**影响版本:** 6.0.0 <= 6.0.31, 6.4.0 <= 6.4.16, 7.0.0 <= 7.0.1

**利用条件:** 需要 Zabbix 前端非管理员用户账户，且该账户拥有 API 访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42327 是 Zabbix 前端 API 中 CUser 类的 addRelatedObjects 函数中存在的 SQL 注入漏洞。此漏洞允许具有 API 访问权限的非管理员用户利用。根据搜索结果和提供的漏洞利用代码，利用方式如下：

1.  **漏洞利用方式：** 攻击者可以使用 Zabbix API，特别是 user.get 方法，触发 CUser 类的 addRelatedObjects 函数中的 SQL 注入。 攻击者首先通过 user.login 获取 token，然后修改请求参数，调用 user.update 函数， 尝试修改用户角色为超级用户。由于 `usrgrps` 参数缺少验证，可以被滥用，将用户添加到多个用户组中。通过将用户添加到 Zabbix administrators group 等具有无限制权限的组，可以提升用户权限。

2.  **有效性：** 提供的漏洞利用代码包含利用 CVE-2024-42327 的信息。代码展示了如何通过 Zabbix API 进行身份验证，以及如何构造恶意请求来利用 SQL 注入漏洞并尝试提升权限。搜索结果中的多个页面也证实了该漏洞的存在和严重性，以及PoC的存在。

3.  **投毒风险：** 虽然漏洞利用代码主要集中在利用 SQL 注入漏洞，但也存在一定的投毒风险。仔细检查了提供的代码，没有明显的恶意代码。`README.md` 文件主要描述了如何利用漏洞，没有发现作者有意添加的后门或恶意功能。代码中存在的风险主要在于攻击者可能会修改代码，引入恶意的SQL 语句，从而导致被攻击服务器的数据遭到破坏。考虑到代码的复杂性，以及潜在的风险，这里给出10%的投毒风险评估。

**项目地址:** [igorbf495/CVE-2024-42327](https://github.com/igorbf495/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #8

**来源**: [CVE-2024-42327-itform-fr_Zabbix---CVE-2024-42327.md](../2024/CVE-2024-42327-itform-fr_Zabbix---CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升和远程代码执行

**影响版本:** <=6.0.31, <=6.4.16, <=7.0.1

**利用条件:** 需要非管理员用户账户，且该账户拥有API访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42327是Zabbix前端API中存在的一个SQL注入漏洞。非管理员用户，只要拥有API访问权限，就可以利用此漏洞。

**有效性：**

根据漏洞信息和搜索结果，以及提供的PoC代码，可以判定该漏洞利用的有效性较高。PoC代码演示了如何利用SQL注入漏洞，通过`user.get` API获取管理员的会话ID（sessionid）或密码哈希，进而提权执行操作，甚至远程代码执行。

**投毒风险：**

分析PoC代码，发现以下潜在投毒风险：

*   **硬编码依赖：** PoC代码中使用了类似 `u.userid=1` 这样的硬编码，假设管理员用户的ID为1。如果目标系统管理员ID不是1，脚本可能无法正常工作，或者被修改为执行恶意操作。
*   **远程代码执行：** 脚本通过创建和执行Zabbix脚本实现远程代码执行。攻击者可能修改脚本内容，执行任意恶意命令。
*   **权限维持：** 成功提权后，攻击者可以通过创建新的管理员账户来维持对系统的控制。
*   **数据篡改：** 通过SQL注入可以篡改数据库中的数据，影响Zabbix系统的监控数据和配置。

综合判断，该PoC代码存在一定的投毒风险，风险概率估计为10%。风险主要来自于利用成功后的恶意操作，而非PoC本身携带恶意payload。

**利用方式：**

1.  **身份验证：** 使用Zabbix前端的非管理员用户的用户名和密码，通过`user.login` API获取身份验证令牌（token）。
2.  **SQL注入：** 构造恶意的`user.get` API请求，在`selectRole`参数中注入SQL代码。PoC利用SQL注入，尝试获取管理员用户的会话ID或密码哈希。
3.  **权限提升：** 如果成功获取管理员的会话ID，可以使用该ID作为`Authorization` header，冒充管理员执行API操作。
4.  **远程代码执行（RCE）：**  利用管理员权限，创建一个新的Zabbix脚本，脚本内容为经过Base64编码的恶意命令，然后通过`script.execute` API执行该脚本。
5.  **创建用户：** 利用管理员权限，创建一个新的管理员用户，完成持久化攻击。

总体来说，该漏洞的利用涉及多个Zabbix API，结合SQL注入实现权限提升和远程代码执行。利用过程相对复杂，但PoC代码的存在降低了利用难度。

**项目地址:** [itform-fr/Zabbix---CVE-2024-42327](https://github.com/itform-fr/Zabbix---CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #9

**来源**: [CVE-2024-42327-watchdog1337_CVE-2024-42327_Zabbix_SQLI.md](../2024/CVE-2024-42327-watchdog1337_CVE-2024-42327_Zabbix_SQLI.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升和远程代码执行

**影响版本:** 6.0.0 <= version <= 6.0.31
6.4.0 <= version <= 6.4.16
7.0.0 <= version <= 7.0.1

**利用条件:** 需要Zabbix前端访问权限，并且用户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端的一个SQL注入漏洞，存在于`CUser`类的`addRelatedObjects`函数中。该函数被`CUser.get`调用，而`CUser.get`可被任何具有API访问权限的用户访问。漏洞利用方式如下：

1.  **漏洞利用前提：**
    *   拥有Zabbix前端的非管理员用户账户。
    *   该账户具有API访问权限（默认User角色即可）。
2.  **漏洞利用步骤：**
    *   攻击者使用有效的Zabbix用户名和密码通过Zabbix API进行身份验证。
    *   成功身份验证后，获得一个身份验证令牌（auth_token）。
    *   攻击者构造恶意的SQL注入payload，利用`user.get` API方法的`selectRole`参数，将SQL注入语句插入到查询中。
    *   通过Zabbix API发送包含恶意payload的请求。PoC代码提供的exp可用于获取用户credentials, session等信息。

3.  **有效性：**
    根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该POC代码是有效的。搜索引擎结果中已经有github仓库公开了POC。

4. **投毒风险：**
 代码本身是比较直白的SQL注入利用，没有发现明显的恶意代码。但是，requests.get 使用了 `verify=False` 禁用了 SSL 证书验证，存在中间人攻击的风险，可能被注入恶意代码或者窃取凭据.风险评估为1%.

5.  **利用方式总结：**
    攻击者通过API接口，利用SQL注入漏洞，可以读取数据库中的敏感信息，例如用户凭据、session信息等。如果Zabbix数据库权限配置不当，可能导致权限提升，甚至远程代码执行，获取服务器控制权。

**项目地址:** [watchdog1337/CVE-2024-42327_Zabbix_SQLI](https://github.com/watchdog1337/CVE-2024-42327_Zabbix_SQLI)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---



---

## POC #2

**来源**: [CVE-2024-42327-BridgerAlderson_Zabbix-CVE-2024-42327-SQL-Injection-RCE.md](../2024/CVE-2024-42327-BridgerAlderson_Zabbix-CVE-2024-42327-SQL-Injection-RCE.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致数据泄露、权限提升和远程代码执行

**影响版本:** <=6.0.31, <=6.4.16, <=7.0.1

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-42327是Zabbix服务器中存在的一个SQL注入漏洞。该漏洞位于`CUser`类的`addRelatedObjects`函数中，该函数被`CUser.get`函数调用。由于`CUser.get`函数对所有具有API访问权限的用户都可用，因此，拥有Zabbix前端非管理员用户账户，且具备API访问权限的攻击者，便可以利用此漏洞，通过构造恶意的SQL语句，执行未授权的数据库操作。

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且具有较高的CVSS评分(9.9)。提供的PoC代码旨在利用时间型SQL注入来提取管理员会话ID，然后利用该ID来执行远程代码执行。PoC利用了Zabbix API的user.get方法，通过构造包含`SLEEP()`函数的SQL注入语句来判断管理员会话ID的字符。从代码的逻辑和github的内容来看，利用方式是可行的。

**投毒风险评估：**
分析PoC代码，主要是通过时间盲注的方式，获取admin的sessionid，然后通过sessionid获取权限，执行创建item等操作，最终达到RCE。在给出的代码中，并发线程数量设置成了10。这种设置本身并不直接构成投毒。但存在一种潜在的风险：如果目标服务器的资源非常有限，或者数据库连接数已经接近上限，过多的并发请求可能会导致拒绝服务(DoS)攻击。此外，Payload本身如果连接到外网的服务器，如果外网服务器被控制，也可能被用于恶意用途。

综上，PoC本身存在极低的投毒风险，大约为5%。

**利用方式：**
1.  **身份验证：** 使用Zabbix API的`user.login`方法，通过提供的用户名和密码获取身份验证token（`auth_token`）。
2.  **SQL注入：** 使用Zabbix API的`user.get`方法，构造恶意的SQL查询，利用时间盲注技术逐步提取管理员会话ID（`admin_session`）。
3.  **信息收集：** 使用提取到的`admin_session`，通过Zabbix API的`host.get`请求，获取目标主机和接口的ID。
4.  **远程代码执行：** 利用获取到的主机和接口ID，通过Zabbix API的`item.create`请求，创建一个包含反向shell命令的item，从而在目标服务器上执行任意代码。

**项目地址:** [BridgerAlderson/Zabbix-CVE-2024-42327-SQL-Injection-RCE](https://github.com/BridgerAlderson/Zabbix-CVE-2024-42327-SQL-Injection-RCE)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #3

**来源**: [CVE-2024-42327-aramosf_cve-2024-42327.md](../2024/CVE-2024-42327-aramosf_cve-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升、敏感信息泄露

**影响版本:** <= 7.0.1, <= 6.4.16, <= 6.0.31

**利用条件:** 需要Zabbix前端非管理员用户账户，且该账户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端API中CUser类的addRelatedObjects函数存在SQL注入漏洞。该漏洞允许拥有API访问权限的非管理员用户通过构造恶意的SQL语句来绕过权限验证，执行未授权的数据库操作。 

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用代码的有效性较高。漏洞库信息明确指出该漏洞存在，并提供了受影响的版本范围。搜索结果中，多个来源确认了该漏洞的存在及其严重性，并且有公开的PoC代码（如GitHub链接）。提供的PoC代码脚本通过Zabbix API登录，然后循环获取用户ID的信息，如果成功利用漏洞，可以泄露敏感信息。

**投毒风险：**
提供的PoC代码主要功能是利用SQL注入漏洞获取Zabbix用户信息。代码本身相对简单，主要是通过Zabbix的API进行身份验证和数据获取。虽然使用了`requests`库，但没有发现明显的恶意行为，例如执行系统命令或修改文件等。但是使用者要小心网络传输过程中的流量劫持，如果被投毒替换，则使用者有风险。经过详细分析，认为其中存在投毒代码的可能性较低，大概1%。

**利用方式：**
1.  **身份验证：** 使用有效的Zabbix用户名和密码，通过user.login API方法获取身份验证令牌（auth token）。
2.  **漏洞触发：** 使用获取的auth token，调用user.get API方法，构造包含恶意SQL语句的userids参数。由于CUser类的addRelatedObjects函数存在SQL注入，恶意SQL语句将被执行。
3.  **信息泄露：** 成功利用SQL注入后，攻击者可以获取数据库中的敏感信息，例如用户名、密码哈希等。
4.  **权限提升：**  通过SQL注入，攻击者可能提升自己的权限，甚至获取管理员权限。
5. **远程代码执行:** Github 上有通过此漏洞利用可以获取到RCE的代码。

总而言之，此漏洞的风险在于未经授权的数据访问和潜在的权限提升。PoC的存在以及CVSS评分9.9表明该漏洞较为严重，应及时修复。

**项目地址:** [aramosf/cve-2024-42327](https://github.com/aramosf/cve-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #4

**来源**: [CVE-2024-42327-compr00t_CVE-2024-42327.md](../2024/CVE-2024-42327-compr00t_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 严重，可能导致权限提升和远程代码执行

**影响版本:** <= 7.0.1, 6.4.16, 6.0.31

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户具备API访问权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-42327 是 Zabbix 前端中的一个 SQL 注入漏洞，存在于 `CUser` 类的 `addRelatedObjects` 函数中。此函数被 `CUser.get` 函数调用，而 `CUser.get` 可供任何具有 API 访问权限的用户使用。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断该漏洞利用的有效性较高。

*   漏洞库信息明确指出该漏洞的存在，并给出了受影响的版本范围。
*   搜索引擎结果中，多个网页都提到了该漏洞，包括 NVD、Wiz.io、Qualys 等安全厂商的分析报告，进一步证实了该漏洞的存在。
*   POC 代码中提供了一个可用于测试的 SQL 注入 payload，并详细说明了漏洞触发的条件。

**投毒风险：**

通过分析提供的 POC 代码，发现主要的投毒风险较低，大约为5%。虽然存在一个`compose.yaml`文件用于构建docker环境,但是需要注意,如果攻击者修改了`compose.yaml`或者`compose_zabbix_components.yaml`，可能会引入包含恶意镜像或其他恶意配置的容器。

*   `cve-2024-42327.py` 本身是一个相对简单的 Python 脚本，用于验证漏洞的存在，没有发现明显的恶意代码。
*   `README.md` 文件只是提供了漏洞的描述、POC 代码和参考链接，也没有发现恶意内容。
*   docker-compose 文件(`compose.yaml`, `compose_zabbix_components.yaml`)定义了 Zabbix 服务器和代理的容器配置。虽然这些文件本身没有直接的恶意代码，但恶意修改过的docker-compose文件可能导致以下风险：
    *   **使用被污染的镜像：** 攻击者可以修改 docker-compose 文件，将 ZABBIX_SERVER_MYSQL_IMAGE 等变量指向包含恶意软件的镜像仓库。虽然原文件引用了变量，增加了一点分析难度，但是仍然存在被替换镜像的风险
    *   **卷挂载不当：** 可以通过挂载宿主机目录到容器内，实现文件读写，造成数据泄露或篡改。

**利用方式：**

1.  **获取 Zabbix 前端的非管理员用户账户，并确保该账户具有 API 访问权限。**
2.  **使用 `user.login` 方法获取 API 认证 token。**
3.  **构造包含 SQL 注入 payload 的 `user.get` 请求。**Payload 利用了 `selectRole` 参数，通过注入 `SLEEP(5)` 函数来测试 SQL 注入。
4.  **发送构造好的请求到 `/api_jsonrpc.php` 接口。**
5.  **如果服务器响应时间超过 5 秒，则表明存在 SQL 注入漏洞。**

攻击者成功利用此漏洞后，可以执行任意 SQL 查询，从而可能泄露敏感数据、修改系统配置，甚至获取管理员权限，最终实现远程代码执行。

**项目地址:** [compr00t/CVE-2024-42327](https://github.com/compr00t/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #5

**来源**: [CVE-2024-42327-depers-rus_CVE-2024-42327.md](../2024/CVE-2024-42327-depers-rus_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致数据泄露、权限提升和远程代码执行

**影响版本:** 6.0.0-6.0.31, 6.4.0-6.4.16, 7.0.0-7.0.1

**利用条件:** 需要Zabbix前端的非管理员用户账号，且该账号具备API访问权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端API中user.get方法存在的一个SQL注入漏洞。具有API访问权限的非管理员用户可以通过构造恶意的SQL语句，注入到`selectRole`参数中，从而执行任意SQL查询。该漏洞位于`CUser`类的`addRelatedObjects`函数中，该函数被`CUser.get`函数调用，而`CUser.get`函数对具有API访问权限的任何用户都可用。

**有效性：**
提供的PoC代码是有效的。它首先通过`user.login`方法获取一个API会话令牌，然后使用该令牌调用`user.get`方法，并在`selectRole`参数中注入一个延时注入payload (`pg_sleep()`)。如果响应时间超过预期的延迟，则表示目标服务器存在SQL注入漏洞。PoC代码还尝试从Users表提取信息。

**投毒风险：**
该PoC代码本身旨在验证漏洞的存在并提取用户信息。主要风险来自代码仓库本身。虽然PoC本身没有明显的恶意代码，但是仍然存在一些极低的风险：

*   **依赖风险：**  PoC代码依赖于`requests`模块，如果攻击者替换了`requests`模块或通过其他方式引入了恶意依赖项，则可能导致代码执行。

*   **目标攻击：**  针对特定目标，攻击者可能会修改PoC代码，例如，硬编码特定的数据库凭据或添加后门。

因此，综合评估，投毒风险较低，约为1%。

**利用方式：**
1.  **身份验证：**  攻击者需要一个Zabbix前端的非管理员用户账号，且该账号具备API访问权限。
2.  **获取API令牌：** 使用用户凭据通过`user.login`方法获取API会话令牌。
3.  **SQL注入：**  构造包含恶意SQL payload的JSON请求，通过`user.get`方法，在`selectRole`参数中注入SQL语句。例如，可以使用延时注入来判断漏洞是否存在。
4.  **数据提取/权限提升：**  利用SQL注入漏洞，攻击者可以读取数据库中的敏感数据，例如用户凭据、配置信息等。攻击者还可以尝试通过SQL注入来提升权限，例如创建管理员账号。
5.  **远程代码执行：**  在某些情况下，攻击者可能可以利用SQL注入漏洞执行任意代码。例如，如果Zabbix服务器的数据库用户具有文件写入权限，攻击者可以尝试将恶意代码写入到服务器的文件系统中，然后通过其他方式执行该代码。

**项目地址:** [depers-rus/CVE-2024-42327](https://github.com/depers-rus/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #6

**来源**: [CVE-2024-42327-godylockz_CVE-2024-42327.md](../2024/CVE-2024-42327-godylockz_CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可导致权限提升和远程代码执行

**影响版本:** < 6.0.32rc1, < 6.4.17rc1, < 7.0.2rc1

**利用条件:** 需要Zabbix前端的非管理员用户账户，且该账户需要具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端存在的一个SQL注入漏洞。攻击者通过利用该漏洞，可以泄漏管理员API认证令牌，并在目标服务器上创建item以实现反向shell，最终达到远程代码执行的目的。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞的POC代码是有效的。POC利用了`CUser.get`函数中的SQL注入点，通过注入恶意SQL语句，可以读取`zabbix.sessions`表中的`sessionid`，从而获取管理员的API token，进一步利用API创建监控项，执行任意命令。

**投毒风险：**

分析POC代码后，发现投毒的风险较低。主要代码功能围绕SQL注入利用，获取管理员Token并执行反向shell，没有发现明显恶意或隐藏后门的代码。一些参数如`sleep_time`控制延迟，`threads`控制线程数，这些都是正常利用参数。故风险评估极低。

**利用方式：**

1.  **身份验证：** 使用一个具有API访问权限的非管理员用户账户登录Zabbix前端。
2.  **获取用户API Token：** 调用user.login接口，获取当前用户的API Token
3.  **SQL注入：** 利用`CUser.get` API 中的 SQL 注入点，通过构造恶意的SQL语句来从zabbix.sessions表中提取管理员用户的sessionid。这个sessionid很可能就是管理员用户的API Token。
4.  **获取 Host ID：** 使用host.get方法获取目标主机的hostid
5.  **权限提升：** 使用管理员API认证令牌，提升权限。
6.  **远程代码执行：** 创建一个恶意的监控项，该监控项执行反向shell命令。将反向shell指向攻击者的监听地址。
7.  **反向 Shell：**  目标服务器执行反向shell命令，攻击者获得目标服务器的shell访问权限。

**项目地址:** [godylockz/CVE-2024-42327](https://github.com/godylockz/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #7

**来源**: [CVE-2024-42327-igorbf495_CVE-2024-42327.md](../2024/CVE-2024-42327-igorbf495_CVE-2024-42327.md)

## CVE-2024-42327 - Zabbix SQL 注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL 注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升、数据泄露和远程命令执行

**影响版本:** 6.0.0 <= 6.0.31, 6.4.0 <= 6.4.16, 7.0.0 <= 7.0.1

**利用条件:** 需要 Zabbix 前端非管理员用户账户，且该账户拥有 API 访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42327 是 Zabbix 前端 API 中 CUser 类的 addRelatedObjects 函数中存在的 SQL 注入漏洞。此漏洞允许具有 API 访问权限的非管理员用户利用。根据搜索结果和提供的漏洞利用代码，利用方式如下：

1.  **漏洞利用方式：** 攻击者可以使用 Zabbix API，特别是 user.get 方法，触发 CUser 类的 addRelatedObjects 函数中的 SQL 注入。 攻击者首先通过 user.login 获取 token，然后修改请求参数，调用 user.update 函数， 尝试修改用户角色为超级用户。由于 `usrgrps` 参数缺少验证，可以被滥用，将用户添加到多个用户组中。通过将用户添加到 Zabbix administrators group 等具有无限制权限的组，可以提升用户权限。

2.  **有效性：** 提供的漏洞利用代码包含利用 CVE-2024-42327 的信息。代码展示了如何通过 Zabbix API 进行身份验证，以及如何构造恶意请求来利用 SQL 注入漏洞并尝试提升权限。搜索结果中的多个页面也证实了该漏洞的存在和严重性，以及PoC的存在。

3.  **投毒风险：** 虽然漏洞利用代码主要集中在利用 SQL 注入漏洞，但也存在一定的投毒风险。仔细检查了提供的代码，没有明显的恶意代码。`README.md` 文件主要描述了如何利用漏洞，没有发现作者有意添加的后门或恶意功能。代码中存在的风险主要在于攻击者可能会修改代码，引入恶意的SQL 语句，从而导致被攻击服务器的数据遭到破坏。考虑到代码的复杂性，以及潜在的风险，这里给出10%的投毒风险评估。

**项目地址:** [igorbf495/CVE-2024-42327](https://github.com/igorbf495/CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #8

**来源**: [CVE-2024-42327-itform-fr_Zabbix---CVE-2024-42327.md](../2024/CVE-2024-42327-itform-fr_Zabbix---CVE-2024-42327.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升和远程代码执行

**影响版本:** <=6.0.31, <=6.4.16, <=7.0.1

**利用条件:** 需要非管理员用户账户，且该账户拥有API访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42327是Zabbix前端API中存在的一个SQL注入漏洞。非管理员用户，只要拥有API访问权限，就可以利用此漏洞。

**有效性：**

根据漏洞信息和搜索结果，以及提供的PoC代码，可以判定该漏洞利用的有效性较高。PoC代码演示了如何利用SQL注入漏洞，通过`user.get` API获取管理员的会话ID（sessionid）或密码哈希，进而提权执行操作，甚至远程代码执行。

**投毒风险：**

分析PoC代码，发现以下潜在投毒风险：

*   **硬编码依赖：** PoC代码中使用了类似 `u.userid=1` 这样的硬编码，假设管理员用户的ID为1。如果目标系统管理员ID不是1，脚本可能无法正常工作，或者被修改为执行恶意操作。
*   **远程代码执行：** 脚本通过创建和执行Zabbix脚本实现远程代码执行。攻击者可能修改脚本内容，执行任意恶意命令。
*   **权限维持：** 成功提权后，攻击者可以通过创建新的管理员账户来维持对系统的控制。
*   **数据篡改：** 通过SQL注入可以篡改数据库中的数据，影响Zabbix系统的监控数据和配置。

综合判断，该PoC代码存在一定的投毒风险，风险概率估计为10%。风险主要来自于利用成功后的恶意操作，而非PoC本身携带恶意payload。

**利用方式：**

1.  **身份验证：** 使用Zabbix前端的非管理员用户的用户名和密码，通过`user.login` API获取身份验证令牌（token）。
2.  **SQL注入：** 构造恶意的`user.get` API请求，在`selectRole`参数中注入SQL代码。PoC利用SQL注入，尝试获取管理员用户的会话ID或密码哈希。
3.  **权限提升：** 如果成功获取管理员的会话ID，可以使用该ID作为`Authorization` header，冒充管理员执行API操作。
4.  **远程代码执行（RCE）：**  利用管理员权限，创建一个新的Zabbix脚本，脚本内容为经过Base64编码的恶意命令，然后通过`script.execute` API执行该脚本。
5.  **创建用户：** 利用管理员权限，创建一个新的管理员用户，完成持久化攻击。

总体来说，该漏洞的利用涉及多个Zabbix API，结合SQL注入实现权限提升和远程代码执行。利用过程相对复杂，但PoC代码的存在降低了利用难度。

**项目地址:** [itform-fr/Zabbix---CVE-2024-42327](https://github.com/itform-fr/Zabbix---CVE-2024-42327)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

## POC #9

**来源**: [CVE-2024-42327-watchdog1337_CVE-2024-42327_Zabbix_SQLI.md](../2024/CVE-2024-42327-watchdog1337_CVE-2024-42327_Zabbix_SQLI.md)

## CVE-2024-42327-Zabbix-SQL注入

**漏洞编号:** CVE-2024-42327

**漏洞类型:** SQL注入

**影响应用:** Zabbix

**危害等级:** 高危，可能导致权限提升和远程代码执行

**影响版本:** 6.0.0 <= version <= 6.0.31
6.4.0 <= version <= 6.4.16
7.0.0 <= version <= 7.0.1

**利用条件:** 需要Zabbix前端访问权限，并且用户具有API访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-42327是Zabbix前端的一个SQL注入漏洞，存在于`CUser`类的`addRelatedObjects`函数中。该函数被`CUser.get`调用，而`CUser.get`可被任何具有API访问权限的用户访问。漏洞利用方式如下：

1.  **漏洞利用前提：**
    *   拥有Zabbix前端的非管理员用户账户。
    *   该账户具有API访问权限（默认User角色即可）。
2.  **漏洞利用步骤：**
    *   攻击者使用有效的Zabbix用户名和密码通过Zabbix API进行身份验证。
    *   成功身份验证后，获得一个身份验证令牌（auth_token）。
    *   攻击者构造恶意的SQL注入payload，利用`user.get` API方法的`selectRole`参数，将SQL注入语句插入到查询中。
    *   通过Zabbix API发送包含恶意payload的请求。PoC代码提供的exp可用于获取用户credentials, session等信息。

3.  **有效性：**
    根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该POC代码是有效的。搜索引擎结果中已经有github仓库公开了POC。

4. **投毒风险：**
 代码本身是比较直白的SQL注入利用，没有发现明显的恶意代码。但是，requests.get 使用了 `verify=False` 禁用了 SSL 证书验证，存在中间人攻击的风险，可能被注入恶意代码或者窃取凭据.风险评估为1%.

5.  **利用方式总结：**
    攻击者通过API接口，利用SQL注入漏洞，可以读取数据库中的敏感信息，例如用户凭据、session信息等。如果Zabbix数据库权限配置不当，可能导致权限提升，甚至远程代码执行，获取服务器控制权。

**项目地址:** [watchdog1337/CVE-2024-42327_Zabbix_SQLI](https://github.com/watchdog1337/CVE-2024-42327_Zabbix_SQLI)

**漏洞详情:** [CVE-2024-42327](https://nvd.nist.gov/vuln/detail/CVE-2024-42327)

---

