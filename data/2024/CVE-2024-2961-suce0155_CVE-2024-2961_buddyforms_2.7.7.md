# CVE-2024-2961

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-2961-4wayhandshake_CVE-2024-2961.md](../2024/CVE-2024-2961-4wayhandshake_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，可能会发生最多4字节的输出缓冲区溢出。攻击者可以利用此漏洞导致应用程序崩溃或覆盖相邻的变量。根据提供的漏洞利用代码，该POC利用了`wrapwrap`工具来构造特定的PHP过滤器链，该过滤器链会触发`iconv()`函数的漏洞，从而实现任意文件读取。该POC针对WordPress环境，利用其`upload_image_from_url`功能，通过可控的URL参数和构造的过滤器链，读取服务器上的任意文件。 

**有效性：**
根据漏洞描述和提供的利用代码，该漏洞是可利用的。Ambionics网站上的文章 (webpage 4, and links inside CVE details) 以及提供的POC表明此漏洞可以通过精心构造的输入触发。

**投毒风险：**
检查`arbitrary-file-read.py`脚本，未发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造HTTP请求，利用`wrapwrap`生成的链，发送给目标服务器，并处理响应。脚本的目的是利用漏洞读取文件内容，没有发现任何主动植入后门或执行恶意操作的迹象。代码从`chain.txt`读取filter chain，并将其插入到POST请求中，这部分是与wrapwrap工具协同工作以利用漏洞。检查README.md文件，描述了如何使用POC和wrapwrap工具，没有发现任何可疑之处。因此，投毒风险较低。

**利用方式：**
1.  **目标确认:** 确认目标系统使用受影响的glibc版本（< 2.40）并且存在可以利用的字符集转换点。
2.  **构造Payload:** 使用wrapwrap工具，生成包含特定PHP filter chain的`chain.txt`文件，该filter chain可以触发iconv()函数的缓冲区溢出漏洞，目标是读取任意文件。
3.  **URL构造:** 攻击者需要找到一个接受URL作为参数的接口，例如WordPress的`upload_image_from_url`功能。
4.  **发送请求:** 攻击者将构造的包含恶意filter chain的URL发送给目标服务器。
5.  **触发漏洞:**  服务器的iconv()函数在处理字符集转换时发生缓冲区溢出。
6.  **任意文件读取:**  利用缓冲区溢出漏洞，读取服务器上的任意文件内容。
7.  **移除Prefix/Suffix:** 可以移除读取文件的前缀或后缀，方便查看文件内容。
8.  **结果获取:**  攻击者从服务器的响应中获取读取的文件内容。

此利用方式依赖于目标系统存在特定的字符集转换操作，并且攻击者能够控制输入到iconv()函数的参数。提供的代码专门针对WordPress环境，展示了如何利用其文件上传功能触发漏洞，读取服务器上的敏感文件。

**项目地址:** [4wayhandshake/CVE-2024-2961](https://github.com/4wayhandshake/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #2

**来源**: [CVE-2024-2961-absolutedesignltd_iconvfix.md](../2024/CVE-2024-2961-absolutedesignltd_iconvfix.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或覆盖相邻变量，甚至远程代码执行（根据搜索结果）

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标系统glibc版本低于2.40，字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 漏洞是 glibc 中 iconv() 函数在处理 ISO-2022-CN-EXT 字符集转换时存在的缓冲区溢出漏洞。具体来说，当 iconv() 将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会溢出输出缓冲区最多 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量。搜索结果表明该漏洞可能被利用于远程代码执行。

**漏洞利用方式：**

1.  **触发条件：**  利用iconv函数进行字符集转换，源字符集未知，目标字符集需要指定为ISO-2022-CN-EXT，且glibc版本低于2.40。
2.  **溢出：**  构造特定的输入字符串，当 iconv() 函数尝试将其转换为 ISO-2022-CN-EXT 时，导致输出缓冲区溢出 4 个字节。
3.  **利用：**  通过控制溢出的内容，可以覆盖相邻的变量，或者改变程序的执行流程，最终达到远程代码执行的目的。

**POC 代码分析：**

*   `iconvfix.sh` 脚本首先从 sansec.io 下载 `cve-2024-2961.c` 文件，然后编译并运行它。`cve-2024-2961.c` 应该是一个用于检测系统是否受 CVE-2024-2961 漏洞影响的程序。
*   如果检测到系统是易受攻击的，脚本会备份 `/usr/lib64/gconv/gconv-modules` 文件，然后注释掉该文件中与 ISO-2022-CN-EXT 相关的行。这样做可以禁用 ISO-2022-CN-EXT 字符集，从而缓解该漏洞。
*   `iconvconfig` 命令用于重建 iconv 的配置缓存。
*   脚本会再次运行漏洞检测程序，以确认补丁是否成功应用。

**有效性：**

提供的 `iconvfix.sh` 脚本通过注释掉 `/usr/lib64/gconv/gconv-modules` 文件中与 `ISO-2022-CN-EXT` 相关的行来缓解漏洞。这种方法能够阻止程序使用有漏洞的字符集转换，从而达到修复漏洞的效果。脚本的有效性依赖于系统是CentOS 7。

**投毒风险分析：**

*   脚本的主要操作是下载并执行来自 `sansec.io` 的代码。这意味着脚本的安全性取决于 `sansec.io` 的可信度。如果 `sansec.io` 被攻破或者提供恶意代码，那么执行该脚本的系统也会受到威胁。 *   脚本会修改 `/usr/lib64/gconv/gconv-modules` 文件，如果修改过程出现错误，可能会导致字符集转换出现问题。 *   尽管如此，代码本身没有明显的恶意行为，脚本意图在于修补漏洞，而非植入后门。投毒风险主要在于外部依赖 `sansec.io`，因此投毒风险相对较低。

**风险比例：** 下载外部脚本存在潜在风险，但是该脚本的内容更多的是修复行为，所以判断投毒风险为10%。

**项目地址:** [absolutedesignltd/iconvfix](https://github.com/absolutedesignltd/iconvfix)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #3

**来源**: [CVE-2024-2961-ambionics_cnext-exploits.md](../2024/CVE-2024-2961-ambionics_cnext-exploits.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务、信息泄露或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，且应用程序调用了iconv()函数，并转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 是 glibc iconv() 函数中的一个缓冲区溢出漏洞。该漏洞存在于glibc 2.39及更早版本中，当使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，可能导致输出缓冲区溢出，最多溢出 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量，进而可能被利用执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可利用的POC。提供的POC代码是一个名为`blind-cnext-exploit.py`的Python脚本，它利用了该漏洞实现了在PHP环境下的盲文件读取和远程代码执行。`README.md`文件提供了更详细的漏洞信息和利用方法的说明。

**投毒风险分析：**

分析`blind-cnext-exploit.py`的内容。代码结构相对复杂，涉及PHP filter chain的利用，但整体框架和逻辑比较清晰。主要的风险点在于`Remote`类，它负责与目标服务器交互并发送payload，如果`Remote`类中的代码被修改为恶意代码，例如在成功利用后执行额外的恶意操作，则存在投毒风险。但是，在对提供的代码进行分析后，并未发现明显的恶意行为。

`requirements.txt`文件需要安装的依赖库也需要进行检查，是否存在引入恶意库的可能。
综合判断，投毒风险较低，大约为10%。主要风险集中在`Remote`类的具体实现和`requirements.txt`依赖库。

**利用方式：**

该漏洞的利用方式如下：

1.  **触发漏洞：**  利用iconv()函数将特定的字符串转换为ISO-2022-CN-EXT字符集，触发缓冲区溢出。
2.  **盲文件读取：**  利用PHP filter chain技术，结合iconv()的漏洞，实现在目标服务器上的盲文件读取。
3.  **信息泄露：**  读取目标服务器上的敏感文件，例如PHP的配置文件、源代码等。
4.  **远程代码执行：**  通过文件读取，获取关键信息，例如libc地址、堆地址等，然后构造特定的payload，覆盖关键数据，最终实现远程代码执行。

提供的POC代码主要针对PHP环境，通过盲文件读取实现RCE。


**项目地址:** [ambionics/cnext-exploits](https://github.com/ambionics/cnext-exploits)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #4

**来源**: [CVE-2024-2961-exfil0_test_iconv.md](../2024/CVE-2024-2961-exfil0_test_iconv.md)

## CVE-2024-2961

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、覆盖相邻变量甚至远程代码执行。

**影响版本:** < 2.40

**利用条件:** 目标系统使用glibc版本低于2.40，并且程序调用了iconv()函数进行字符集转换，特别是转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数存在的一个缓冲区溢出漏洞。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能发生最多4个字节的溢出。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，此漏洞被认为是有效的。漏洞库和搜索结果中都明确指出iconv()函数在特定条件下会发生缓冲区溢出。提供的POC代码尝试触发该漏洞，通过将字符串转换为ISO-2022-CN-EXT字符集来测试溢出。

**投毒风险：** 提供的代码仓库中没有发现明显的投毒迹象。`README.md`文件描述了漏洞的利用方法，并提供了编译和运行POC的步骤。`test_iconv.c`文件是简单的C代码，用于调用iconv()函数并尝试触发漏洞。代码本身没有包含任何恶意或隐藏的功能。因此，投毒风险评估为0%。

**利用方式：**

1.  **触发漏洞：** 攻击者需要控制iconv()函数的输入和输出缓冲区，并且指定目标字符集为ISO-2022-CN-EXT。攻击者需要输入精心构造的字符串。
2.  **溢出利用：** 由于溢出只有4个字节，通常无法直接实现任意代码执行。然而，结合其他技术（例如堆利用）可能能够利用此漏洞来覆盖关键数据结构，例如堆元数据或者函数指针。
3.  **远程代码执行(RCE)：**  根据搜索结果，特别是RedHat的描述，该漏洞可能允许攻击者通过构造恶意字符序列触发越界写入并执行远程代码。Ambionics的文章也深入探讨了利用此漏洞实现RCE的可能性，特别是在PHP环境中，通过修改free list 指针，从而实现任意写。

**总结：**

CVE-2024-2961是一个缓冲区溢出漏洞，虽然溢出量较小，但结合其他技术，攻击者可以利用此漏洞实现程序崩溃，变量覆盖，甚至远程代码执行。提供的POC代码验证了该漏洞的存在，代码本身没有发现投毒风险。

**项目地址:** [exfil0/test_iconv](https://github.com/exfil0/test_iconv)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #5

**来源**: [CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md](../2024/CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、任意代码执行或信息泄露

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并调用iconv()函数进行ISO-2022-CN-EXT字符集转换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中。当将字符串转换为 ISO-2022-CN-EXT 字符集时，该函数可能导致输出缓冲区溢出，最多溢出 4 个字节。攻击者可以利用此漏洞通过特制的字符序列触发越界写入，从而导致应用程序崩溃，覆盖相邻变量或执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此漏洞利用 **有效**。漏洞库信息明确指出 iconv() 函数存在缓冲区溢出，搜索引擎结果也佐证了漏洞的存在，并提及了远程代码执行的可能性。提供的 Python 脚本 (exp.py) 尝试利用该漏洞，通过构造特定的输入，触发堆溢出，并最终尝试执行任意代码。Ambionics 的博客文章 (由搜索结果中的网页 4 指出) 提供了更详细的漏洞分析和利用方法，进一步确认了漏洞的可利用性。

**投毒风险评估：**
对提供的 exp.py 脚本进行分析：

*   **依赖库：** 脚本依赖 `pwn`, `requests` (通过`ten` 模块，该模块可能封装了`requests`) 和 `zlib` 等库。这些库本身可能存在安全风险，但属于常用库，风险较低。
*   **功能：** 脚本的主要功能是从远程服务器下载文件，读取内存映射，计算堆地址，然后构造特定的输入数据，触发漏洞。脚本包含很多与堆操作相关的代码,例如计算地址和chunk size。整体代码复杂，难以完全确定是否存在后门。
*   **可疑点：** 脚本使用了 `ten` 这个模块，这有可能是一个定制的模块，其中可能存在未知的恶意代码。脚本中包含了多个压缩和分块的操作，用于构造特定的攻击载荷，这些操作增加了代码的复杂性，也增加了隐藏恶意代码的可能性。
    `ADDR_EFREE = LIBC.symbols["__libc_system"]`这行代码使用了 system 函数，如果能控制传递给 system 函数的参数，就可以执行任意命令。在exp.py的剩余部分代码中，代码是不完整的，难以确认最终传递给system函数的参数。 

综合评估，该 POC 存在一定的投毒风险，大约为 **10%**。风险主要来自于 `ten` 模块的未知风险和利用 `system` 函数执行命令的可能性。

**利用方式分析：**

1.  **漏洞触发：** 漏洞利用首先需要触发 `iconv()` 函数，并将易受攻击的字符集作为目标。
2.  **内存布局：** 攻击者需要确定目标系统上的内存布局，特别是堆地址和 libc 地址。利用代码通过读取 `/proc/self/maps` 来获取内存区域信息，然后计算堆和 libc 的基地址。
3.  **堆溢出：** 攻击者通过构造特定的输入，利用缓冲区溢出覆盖堆上的元数据。提供的代码使用了 `chunked_chunk` 和 `compressed_bucket` 函数来创建包含特定大小和内容的 chunked data，这些chunked data会触发堆溢出。
4.  **任意代码执行：** 成功触发堆溢出后，攻击者可以覆盖关键内存区域，例如函数指针或 GOT 表项，以便在程序执行过程中劫持控制流。利用代码试图覆盖 `__libc_system` 函数，以便执行任意命令。具体而言，攻击者会覆盖free list bin指针指向伪造的chunk，然后通过malloc操作来操纵内存，从而达到任意写的效果，最终劫持控制流，执行任意代码（调用 `system` 函数）。

**项目地址:** [kjdfklha/CVE-2024-2961_poc](https://github.com/kjdfklha/CVE-2024-2961_poc)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #6

**来源**: [CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md](../2024/CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md)

## CVE-2024-2961-glibc-iconv 缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量，在特定情况下可能导致远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要存在使用 iconv 函数，并且进行到 ISO-2022-CN-EXT 字符集的转换。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中，当将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会导致最多 4 字节的输出缓冲区溢出。该漏洞影响 2.39 及更早版本。从提供的漏洞利用代码来看，该脚本利用 PHP 的 filter chain 和 iconv 函数处理字符编码转换的缺陷，实现任意文件读取。脚本首先创建一个包含一系列 iconv 转换的 PHP 过滤器链 payload，该 payload 用于读取目标服务器上的任意文件。然后，脚本通过模拟图像上传，将 payload 隐藏在 POST 请求中，发送到目标服务器的 admin-ajax.php 端点。服务器处理请求后，脚本下载生成的文件，并提取显示目标文件的内容。

**有效性：**
根据CVE描述和搜索结果以及提供的漏洞利用代码，此漏洞利用的有效性较高。CISA ADP 将其标记为“poc”，且存在利用的技术可行性。

**投毒风险：**
提供的代码主要包含一个 Python 脚本 (lfi.py) 和一个 README.md 文件。Python 脚本的功能是利用 CVE-2024-2961 漏洞读取远程文件。检查脚本发现其主要是构造恶意的字符转换，没有明显的恶意代码或者后门。脚本依赖于特定的目标 URL 和请求头，这些信息需要在实际使用前进行配置。脚本本身较为直接，没有发现隐藏的投毒代码。

**利用方式：**
利用方式是通过构造特定的 PHP 过滤器链，借助 iconv 函数在字符集转换过程中触发缓冲区溢出，从而读取服务器上的任意文件。


**项目地址:** [kyotozx/CVE-2024-2961-Remote-File-Read](https://github.com/kyotozx/CVE-2024-2961-Remote-File-Read)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #7

**来源**: [CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md](../2024/CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或任意代码执行

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行ISO-2022-CN-EXT字符集转换，并且输出缓冲区大小可控。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数的一个缓冲区溢出漏洞。当使用iconv()将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能会发生最多4字节的溢出。攻击者可以通过构造特定的输入字符串来触发此漏洞，导致程序崩溃或覆盖相邻的变量，甚至执行任意代码。

**有效性评估：**
根据CVE信息和搜索结果，该漏洞已经公开披露，并且存在可利用的POC。提供的修复脚本通过从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行来缓解该漏洞，禁用存在漏洞的字符集转换。 因此，修复脚本本身表明该漏洞是可利用的，虽然提供的脚本仅仅是缓解，而不是直接的exp.

**投毒风险评估：**
提供的`fix.sh`脚本的主要功能是检测系统上是否存在受漏洞影响的glibc版本，并尝试通过修改iconv的配置文件来缓解该漏洞。脚本首先检查`/usr/lib/x86_64-linux-gnu/gconv`目录是否存在，然后检查ldd版本是否包含GLIBC，并检查`iconv -l`命令的输出是否包含'CN-?EXT'。如果以上检查都通过，脚本会尝试使用`grep`命令从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行，并将修改后的内容保存到`.new`文件中，最后使用`mv`命令覆盖原始文件。脚本的最后运行`iconvconfig`。

该脚本的目的是缓解漏洞，而不是利用漏洞。没有发现任何恶意代码或隐藏的后门。因此，投毒风险可以认为是0%。

**利用方式：**
1.  **触发漏洞：** 通过调用iconv()函数，并将一个精心构造的字符串从一种字符集转换为ISO-2022-CN-EXT字符集。
2.  **控制溢出：**  控制输入字符串和输出缓冲区的大小，确保溢出发生，并且覆盖到目标内存区域。
3.  **代码执行 (如果可能)：** 如果溢出覆盖了函数返回地址或其他关键数据，攻击者可以控制程序的执行流程，最终实现任意代码执行。

漏洞利用难度取决于具体的环境和目标程序。在某些情况下，可能需要绕过各种安全机制，如地址空间布局随机化（ASLR）和数据执行保护（DEP）。

**项目地址:** [mattaperkins/FIX-CVE-2024-2961](https://github.com/mattaperkins/FIX-CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #8

**来源**: [CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md](../2024/CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并且存在可利用的iconv()函数调用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用`iconv()`函数将字符串转换为ISO-2022-CN-EXT字符集时，可能导致输出缓冲区溢出最多4个字节。

**有效性评估：**

根据漏洞信息和搜索引擎结果，此漏洞存在已知的PoC。PoC代码利用了PHP的`php://filter`流包装器以及一系列的`convert.iconv.*`过滤器链，通过精心构造的输入，触发glibc的iconv函数进行字符集转换，最终造成缓冲区溢出。利用方式较为复杂，依赖于PHP环境和特定的配置。

根据搜索引擎的结果发现，存在远程代码执行的可能性，结合给出的EXP代码来看，EXP中的利用是通过构造特定的`convert.iconv`链条最终溢出达到读取文件内容或者写入的目的。

**投毒风险评估：**

提供的PoC代码主要通过HTTP请求发送payload，并下载`/proc/self/maps`和libc文件。虽然PoC中包含了一些base64编码和解码操作，以及`convert.iconv` 链条，但整体逻辑看起来是为了利用漏洞，没有明显的恶意代码，但仍然存在很小的风险。

风险点在于：

1.  **依赖外部资源：** PoC可能需要下载远程文件（libc），攻击者可以替换这些文件为恶意文件。
2.  **命令执行：** PoC允许指定要执行的命令，如果目标系统配置不当，可能导致恶意命令执行。
3.  **未知的依赖项风险：** PoC可能依赖于未知的或未公开的第三方库，这些库可能存在安全漏洞，或者被攻击者篡改。

综合评估，PoC代码存在一定的投毒风险，但概率较低(5%)，需要仔细审计代码，并确保使用的外部资源是可信的。

**利用方式：**

1.  **目标识别：** 确定目标系统使用的glibc版本低于2.40，并且存在iconv()函数调用。
2.  **构造Payload：**  使用`php://filter`流包装器和一系列的`convert.iconv.*`过滤器链构造恶意的payload，触发缓冲区溢出。
3.  **信息泄露/代码执行：** 利用溢出覆盖相邻的变量或函数指针，从而实现信息泄露或远程代码执行。

**项目地址:** [regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-](https://github.com/regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #9

**来源**: [CVE-2024-2961-rvizx_CVE-2024-2961.md](../2024/CVE-2024-2961-rvizx_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，并且程序使用iconv函数转换到ISO-2022-CN-EXT字符集

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961 存在于 GNU C 库 (glibc) 的 iconv() 函数中。当应用程序使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果 glibc 版本低于 2.40，则可能发生缓冲区溢出，溢出量最多为 4 字节。这可能导致应用程序崩溃或覆盖相邻变量，攻击者可能利用此漏洞执行远程代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且存在PoC。提供的脚本 `fix.sh` 并非直接的利用代码，而是用于缓解该漏洞的脚本。它通过禁用有问题的字符集来阻止漏洞被触发，因此该脚本本身不是PoC，但验证了漏洞的可利用性。

**投毒风险：**

分析 `fix.sh` 脚本，它主要执行以下操作：

1.  检查系统是否存在受影响的字符集。
2.  查找 `gconv-modules-extra.conf` 文件。
3.  禁用 `gconv-modules-extra.conf` 中与 `ISO-2022-CN-EXT` 相关的编码。
4.  重新生成 gconv 模块缓存。
5.  验证缓解措施是否成功。

脚本中潜在的投毒点可能在于：

*   在禁用编码的部分，`sed` 命令可能被修改为删除其他重要的字符集，导致应用程序无法正常处理某些字符，虽然可能性不大，考虑到这个脚本的目的是缓解漏洞，恶意修改 `sed` 命令会适得其反，更容易被检测到。 *   替换 `gconv-modules-extra.conf` 或者注入恶意内容，导致系统无法正常工作。但是会影响全局导致应用异常。

总体而言，该脚本的风险较低，因为其主要功能是禁用特定的字符集，而不是执行任意代码。考虑到作者的信息和脚本内容，可以初步判断存在恶意投毒的可能性较低，估算投毒风险为 5%。

**利用方式：**

漏洞的利用方式是：

1.  攻击者需要找到一个应用程序，该应用程序使用 glibc 的 iconv() 函数进行字符集转换。
2.  应用程序必须使用 iconv() 函数将输入转换为 ISO-2022-CN-EXT 字符集。
3.  攻击者构造恶意的字符串，当该字符串被 iconv() 函数转换时，会导致输出缓冲区溢出。
4.  如果成功利用，攻击者可以控制程序的执行流程，甚至执行任意代码。具体利用效果取决于程序内存布局以及溢出造成的破坏。

**项目地址:** [rvizx/CVE-2024-2961](https://github.com/rvizx/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #10

**来源**: [CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md](../2024/CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md)

# CVE-2024-2961

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-2961-4wayhandshake_CVE-2024-2961.md](../2024/CVE-2024-2961-4wayhandshake_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，可能会发生最多4字节的输出缓冲区溢出。攻击者可以利用此漏洞导致应用程序崩溃或覆盖相邻的变量。根据提供的漏洞利用代码，该POC利用了`wrapwrap`工具来构造特定的PHP过滤器链，该过滤器链会触发`iconv()`函数的漏洞，从而实现任意文件读取。该POC针对WordPress环境，利用其`upload_image_from_url`功能，通过可控的URL参数和构造的过滤器链，读取服务器上的任意文件。 

**有效性：**
根据漏洞描述和提供的利用代码，该漏洞是可利用的。Ambionics网站上的文章 (webpage 4, and links inside CVE details) 以及提供的POC表明此漏洞可以通过精心构造的输入触发。

**投毒风险：**
检查`arbitrary-file-read.py`脚本，未发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造HTTP请求，利用`wrapwrap`生成的链，发送给目标服务器，并处理响应。脚本的目的是利用漏洞读取文件内容，没有发现任何主动植入后门或执行恶意操作的迹象。代码从`chain.txt`读取filter chain，并将其插入到POST请求中，这部分是与wrapwrap工具协同工作以利用漏洞。检查README.md文件，描述了如何使用POC和wrapwrap工具，没有发现任何可疑之处。因此，投毒风险较低。

**利用方式：**
1.  **目标确认:** 确认目标系统使用受影响的glibc版本（< 2.40）并且存在可以利用的字符集转换点。
2.  **构造Payload:** 使用wrapwrap工具，生成包含特定PHP filter chain的`chain.txt`文件，该filter chain可以触发iconv()函数的缓冲区溢出漏洞，目标是读取任意文件。
3.  **URL构造:** 攻击者需要找到一个接受URL作为参数的接口，例如WordPress的`upload_image_from_url`功能。
4.  **发送请求:** 攻击者将构造的包含恶意filter chain的URL发送给目标服务器。
5.  **触发漏洞:**  服务器的iconv()函数在处理字符集转换时发生缓冲区溢出。
6.  **任意文件读取:**  利用缓冲区溢出漏洞，读取服务器上的任意文件内容。
7.  **移除Prefix/Suffix:** 可以移除读取文件的前缀或后缀，方便查看文件内容。
8.  **结果获取:**  攻击者从服务器的响应中获取读取的文件内容。

此利用方式依赖于目标系统存在特定的字符集转换操作，并且攻击者能够控制输入到iconv()函数的参数。提供的代码专门针对WordPress环境，展示了如何利用其文件上传功能触发漏洞，读取服务器上的敏感文件。

**项目地址:** [4wayhandshake/CVE-2024-2961](https://github.com/4wayhandshake/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #2

**来源**: [CVE-2024-2961-absolutedesignltd_iconvfix.md](../2024/CVE-2024-2961-absolutedesignltd_iconvfix.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或覆盖相邻变量，甚至远程代码执行（根据搜索结果）

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标系统glibc版本低于2.40，字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 漏洞是 glibc 中 iconv() 函数在处理 ISO-2022-CN-EXT 字符集转换时存在的缓冲区溢出漏洞。具体来说，当 iconv() 将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会溢出输出缓冲区最多 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量。搜索结果表明该漏洞可能被利用于远程代码执行。

**漏洞利用方式：**

1.  **触发条件：**  利用iconv函数进行字符集转换，源字符集未知，目标字符集需要指定为ISO-2022-CN-EXT，且glibc版本低于2.40。
2.  **溢出：**  构造特定的输入字符串，当 iconv() 函数尝试将其转换为 ISO-2022-CN-EXT 时，导致输出缓冲区溢出 4 个字节。
3.  **利用：**  通过控制溢出的内容，可以覆盖相邻的变量，或者改变程序的执行流程，最终达到远程代码执行的目的。

**POC 代码分析：**

*   `iconvfix.sh` 脚本首先从 sansec.io 下载 `cve-2024-2961.c` 文件，然后编译并运行它。`cve-2024-2961.c` 应该是一个用于检测系统是否受 CVE-2024-2961 漏洞影响的程序。
*   如果检测到系统是易受攻击的，脚本会备份 `/usr/lib64/gconv/gconv-modules` 文件，然后注释掉该文件中与 ISO-2022-CN-EXT 相关的行。这样做可以禁用 ISO-2022-CN-EXT 字符集，从而缓解该漏洞。
*   `iconvconfig` 命令用于重建 iconv 的配置缓存。
*   脚本会再次运行漏洞检测程序，以确认补丁是否成功应用。

**有效性：**

提供的 `iconvfix.sh` 脚本通过注释掉 `/usr/lib64/gconv/gconv-modules` 文件中与 `ISO-2022-CN-EXT` 相关的行来缓解漏洞。这种方法能够阻止程序使用有漏洞的字符集转换，从而达到修复漏洞的效果。脚本的有效性依赖于系统是CentOS 7。

**投毒风险分析：**

*   脚本的主要操作是下载并执行来自 `sansec.io` 的代码。这意味着脚本的安全性取决于 `sansec.io` 的可信度。如果 `sansec.io` 被攻破或者提供恶意代码，那么执行该脚本的系统也会受到威胁。 *   脚本会修改 `/usr/lib64/gconv/gconv-modules` 文件，如果修改过程出现错误，可能会导致字符集转换出现问题。 *   尽管如此，代码本身没有明显的恶意行为，脚本意图在于修补漏洞，而非植入后门。投毒风险主要在于外部依赖 `sansec.io`，因此投毒风险相对较低。

**风险比例：** 下载外部脚本存在潜在风险，但是该脚本的内容更多的是修复行为，所以判断投毒风险为10%。

**项目地址:** [absolutedesignltd/iconvfix](https://github.com/absolutedesignltd/iconvfix)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #3

**来源**: [CVE-2024-2961-ambionics_cnext-exploits.md](../2024/CVE-2024-2961-ambionics_cnext-exploits.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务、信息泄露或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，且应用程序调用了iconv()函数，并转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 是 glibc iconv() 函数中的一个缓冲区溢出漏洞。该漏洞存在于glibc 2.39及更早版本中，当使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，可能导致输出缓冲区溢出，最多溢出 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量，进而可能被利用执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可利用的POC。提供的POC代码是一个名为`blind-cnext-exploit.py`的Python脚本，它利用了该漏洞实现了在PHP环境下的盲文件读取和远程代码执行。`README.md`文件提供了更详细的漏洞信息和利用方法的说明。

**投毒风险分析：**

分析`blind-cnext-exploit.py`的内容。代码结构相对复杂，涉及PHP filter chain的利用，但整体框架和逻辑比较清晰。主要的风险点在于`Remote`类，它负责与目标服务器交互并发送payload，如果`Remote`类中的代码被修改为恶意代码，例如在成功利用后执行额外的恶意操作，则存在投毒风险。但是，在对提供的代码进行分析后，并未发现明显的恶意行为。

`requirements.txt`文件需要安装的依赖库也需要进行检查，是否存在引入恶意库的可能。
综合判断，投毒风险较低，大约为10%。主要风险集中在`Remote`类的具体实现和`requirements.txt`依赖库。

**利用方式：**

该漏洞的利用方式如下：

1.  **触发漏洞：**  利用iconv()函数将特定的字符串转换为ISO-2022-CN-EXT字符集，触发缓冲区溢出。
2.  **盲文件读取：**  利用PHP filter chain技术，结合iconv()的漏洞，实现在目标服务器上的盲文件读取。
3.  **信息泄露：**  读取目标服务器上的敏感文件，例如PHP的配置文件、源代码等。
4.  **远程代码执行：**  通过文件读取，获取关键信息，例如libc地址、堆地址等，然后构造特定的payload，覆盖关键数据，最终实现远程代码执行。

提供的POC代码主要针对PHP环境，通过盲文件读取实现RCE。


**项目地址:** [ambionics/cnext-exploits](https://github.com/ambionics/cnext-exploits)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #4

**来源**: [CVE-2024-2961-exfil0_test_iconv.md](../2024/CVE-2024-2961-exfil0_test_iconv.md)

## CVE-2024-2961

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、覆盖相邻变量甚至远程代码执行。

**影响版本:** < 2.40

**利用条件:** 目标系统使用glibc版本低于2.40，并且程序调用了iconv()函数进行字符集转换，特别是转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数存在的一个缓冲区溢出漏洞。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能发生最多4个字节的溢出。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，此漏洞被认为是有效的。漏洞库和搜索结果中都明确指出iconv()函数在特定条件下会发生缓冲区溢出。提供的POC代码尝试触发该漏洞，通过将字符串转换为ISO-2022-CN-EXT字符集来测试溢出。

**投毒风险：** 提供的代码仓库中没有发现明显的投毒迹象。`README.md`文件描述了漏洞的利用方法，并提供了编译和运行POC的步骤。`test_iconv.c`文件是简单的C代码，用于调用iconv()函数并尝试触发漏洞。代码本身没有包含任何恶意或隐藏的功能。因此，投毒风险评估为0%。

**利用方式：**

1.  **触发漏洞：** 攻击者需要控制iconv()函数的输入和输出缓冲区，并且指定目标字符集为ISO-2022-CN-EXT。攻击者需要输入精心构造的字符串。
2.  **溢出利用：** 由于溢出只有4个字节，通常无法直接实现任意代码执行。然而，结合其他技术（例如堆利用）可能能够利用此漏洞来覆盖关键数据结构，例如堆元数据或者函数指针。
3.  **远程代码执行(RCE)：**  根据搜索结果，特别是RedHat的描述，该漏洞可能允许攻击者通过构造恶意字符序列触发越界写入并执行远程代码。Ambionics的文章也深入探讨了利用此漏洞实现RCE的可能性，特别是在PHP环境中，通过修改free list 指针，从而实现任意写。

**总结：**

CVE-2024-2961是一个缓冲区溢出漏洞，虽然溢出量较小，但结合其他技术，攻击者可以利用此漏洞实现程序崩溃，变量覆盖，甚至远程代码执行。提供的POC代码验证了该漏洞的存在，代码本身没有发现投毒风险。

**项目地址:** [exfil0/test_iconv](https://github.com/exfil0/test_iconv)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #5

**来源**: [CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md](../2024/CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、任意代码执行或信息泄露

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并调用iconv()函数进行ISO-2022-CN-EXT字符集转换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中。当将字符串转换为 ISO-2022-CN-EXT 字符集时，该函数可能导致输出缓冲区溢出，最多溢出 4 个字节。攻击者可以利用此漏洞通过特制的字符序列触发越界写入，从而导致应用程序崩溃，覆盖相邻变量或执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此漏洞利用 **有效**。漏洞库信息明确指出 iconv() 函数存在缓冲区溢出，搜索引擎结果也佐证了漏洞的存在，并提及了远程代码执行的可能性。提供的 Python 脚本 (exp.py) 尝试利用该漏洞，通过构造特定的输入，触发堆溢出，并最终尝试执行任意代码。Ambionics 的博客文章 (由搜索结果中的网页 4 指出) 提供了更详细的漏洞分析和利用方法，进一步确认了漏洞的可利用性。

**投毒风险评估：**
对提供的 exp.py 脚本进行分析：

*   **依赖库：** 脚本依赖 `pwn`, `requests` (通过`ten` 模块，该模块可能封装了`requests`) 和 `zlib` 等库。这些库本身可能存在安全风险，但属于常用库，风险较低。
*   **功能：** 脚本的主要功能是从远程服务器下载文件，读取内存映射，计算堆地址，然后构造特定的输入数据，触发漏洞。脚本包含很多与堆操作相关的代码,例如计算地址和chunk size。整体代码复杂，难以完全确定是否存在后门。
*   **可疑点：** 脚本使用了 `ten` 这个模块，这有可能是一个定制的模块，其中可能存在未知的恶意代码。脚本中包含了多个压缩和分块的操作，用于构造特定的攻击载荷，这些操作增加了代码的复杂性，也增加了隐藏恶意代码的可能性。
    `ADDR_EFREE = LIBC.symbols["__libc_system"]`这行代码使用了 system 函数，如果能控制传递给 system 函数的参数，就可以执行任意命令。在exp.py的剩余部分代码中，代码是不完整的，难以确认最终传递给system函数的参数。 

综合评估，该 POC 存在一定的投毒风险，大约为 **10%**。风险主要来自于 `ten` 模块的未知风险和利用 `system` 函数执行命令的可能性。

**利用方式分析：**

1.  **漏洞触发：** 漏洞利用首先需要触发 `iconv()` 函数，并将易受攻击的字符集作为目标。
2.  **内存布局：** 攻击者需要确定目标系统上的内存布局，特别是堆地址和 libc 地址。利用代码通过读取 `/proc/self/maps` 来获取内存区域信息，然后计算堆和 libc 的基地址。
3.  **堆溢出：** 攻击者通过构造特定的输入，利用缓冲区溢出覆盖堆上的元数据。提供的代码使用了 `chunked_chunk` 和 `compressed_bucket` 函数来创建包含特定大小和内容的 chunked data，这些chunked data会触发堆溢出。
4.  **任意代码执行：** 成功触发堆溢出后，攻击者可以覆盖关键内存区域，例如函数指针或 GOT 表项，以便在程序执行过程中劫持控制流。利用代码试图覆盖 `__libc_system` 函数，以便执行任意命令。具体而言，攻击者会覆盖free list bin指针指向伪造的chunk，然后通过malloc操作来操纵内存，从而达到任意写的效果，最终劫持控制流，执行任意代码（调用 `system` 函数）。

**项目地址:** [kjdfklha/CVE-2024-2961_poc](https://github.com/kjdfklha/CVE-2024-2961_poc)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #6

**来源**: [CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md](../2024/CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md)

## CVE-2024-2961-glibc-iconv 缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量，在特定情况下可能导致远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要存在使用 iconv 函数，并且进行到 ISO-2022-CN-EXT 字符集的转换。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中，当将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会导致最多 4 字节的输出缓冲区溢出。该漏洞影响 2.39 及更早版本。从提供的漏洞利用代码来看，该脚本利用 PHP 的 filter chain 和 iconv 函数处理字符编码转换的缺陷，实现任意文件读取。脚本首先创建一个包含一系列 iconv 转换的 PHP 过滤器链 payload，该 payload 用于读取目标服务器上的任意文件。然后，脚本通过模拟图像上传，将 payload 隐藏在 POST 请求中，发送到目标服务器的 admin-ajax.php 端点。服务器处理请求后，脚本下载生成的文件，并提取显示目标文件的内容。

**有效性：**
根据CVE描述和搜索结果以及提供的漏洞利用代码，此漏洞利用的有效性较高。CISA ADP 将其标记为“poc”，且存在利用的技术可行性。

**投毒风险：**
提供的代码主要包含一个 Python 脚本 (lfi.py) 和一个 README.md 文件。Python 脚本的功能是利用 CVE-2024-2961 漏洞读取远程文件。检查脚本发现其主要是构造恶意的字符转换，没有明显的恶意代码或者后门。脚本依赖于特定的目标 URL 和请求头，这些信息需要在实际使用前进行配置。脚本本身较为直接，没有发现隐藏的投毒代码。

**利用方式：**
利用方式是通过构造特定的 PHP 过滤器链，借助 iconv 函数在字符集转换过程中触发缓冲区溢出，从而读取服务器上的任意文件。


**项目地址:** [kyotozx/CVE-2024-2961-Remote-File-Read](https://github.com/kyotozx/CVE-2024-2961-Remote-File-Read)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #7

**来源**: [CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md](../2024/CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或任意代码执行

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行ISO-2022-CN-EXT字符集转换，并且输出缓冲区大小可控。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数的一个缓冲区溢出漏洞。当使用iconv()将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能会发生最多4字节的溢出。攻击者可以通过构造特定的输入字符串来触发此漏洞，导致程序崩溃或覆盖相邻的变量，甚至执行任意代码。

**有效性评估：**
根据CVE信息和搜索结果，该漏洞已经公开披露，并且存在可利用的POC。提供的修复脚本通过从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行来缓解该漏洞，禁用存在漏洞的字符集转换。 因此，修复脚本本身表明该漏洞是可利用的，虽然提供的脚本仅仅是缓解，而不是直接的exp.

**投毒风险评估：**
提供的`fix.sh`脚本的主要功能是检测系统上是否存在受漏洞影响的glibc版本，并尝试通过修改iconv的配置文件来缓解该漏洞。脚本首先检查`/usr/lib/x86_64-linux-gnu/gconv`目录是否存在，然后检查ldd版本是否包含GLIBC，并检查`iconv -l`命令的输出是否包含'CN-?EXT'。如果以上检查都通过，脚本会尝试使用`grep`命令从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行，并将修改后的内容保存到`.new`文件中，最后使用`mv`命令覆盖原始文件。脚本的最后运行`iconvconfig`。

该脚本的目的是缓解漏洞，而不是利用漏洞。没有发现任何恶意代码或隐藏的后门。因此，投毒风险可以认为是0%。

**利用方式：**
1.  **触发漏洞：** 通过调用iconv()函数，并将一个精心构造的字符串从一种字符集转换为ISO-2022-CN-EXT字符集。
2.  **控制溢出：**  控制输入字符串和输出缓冲区的大小，确保溢出发生，并且覆盖到目标内存区域。
3.  **代码执行 (如果可能)：** 如果溢出覆盖了函数返回地址或其他关键数据，攻击者可以控制程序的执行流程，最终实现任意代码执行。

漏洞利用难度取决于具体的环境和目标程序。在某些情况下，可能需要绕过各种安全机制，如地址空间布局随机化（ASLR）和数据执行保护（DEP）。

**项目地址:** [mattaperkins/FIX-CVE-2024-2961](https://github.com/mattaperkins/FIX-CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #8

**来源**: [CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md](../2024/CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并且存在可利用的iconv()函数调用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用`iconv()`函数将字符串转换为ISO-2022-CN-EXT字符集时，可能导致输出缓冲区溢出最多4个字节。

**有效性评估：**

根据漏洞信息和搜索引擎结果，此漏洞存在已知的PoC。PoC代码利用了PHP的`php://filter`流包装器以及一系列的`convert.iconv.*`过滤器链，通过精心构造的输入，触发glibc的iconv函数进行字符集转换，最终造成缓冲区溢出。利用方式较为复杂，依赖于PHP环境和特定的配置。

根据搜索引擎的结果发现，存在远程代码执行的可能性，结合给出的EXP代码来看，EXP中的利用是通过构造特定的`convert.iconv`链条最终溢出达到读取文件内容或者写入的目的。

**投毒风险评估：**

提供的PoC代码主要通过HTTP请求发送payload，并下载`/proc/self/maps`和libc文件。虽然PoC中包含了一些base64编码和解码操作，以及`convert.iconv` 链条，但整体逻辑看起来是为了利用漏洞，没有明显的恶意代码，但仍然存在很小的风险。

风险点在于：

1.  **依赖外部资源：** PoC可能需要下载远程文件（libc），攻击者可以替换这些文件为恶意文件。
2.  **命令执行：** PoC允许指定要执行的命令，如果目标系统配置不当，可能导致恶意命令执行。
3.  **未知的依赖项风险：** PoC可能依赖于未知的或未公开的第三方库，这些库可能存在安全漏洞，或者被攻击者篡改。

综合评估，PoC代码存在一定的投毒风险，但概率较低(5%)，需要仔细审计代码，并确保使用的外部资源是可信的。

**利用方式：**

1.  **目标识别：** 确定目标系统使用的glibc版本低于2.40，并且存在iconv()函数调用。
2.  **构造Payload：**  使用`php://filter`流包装器和一系列的`convert.iconv.*`过滤器链构造恶意的payload，触发缓冲区溢出。
3.  **信息泄露/代码执行：** 利用溢出覆盖相邻的变量或函数指针，从而实现信息泄露或远程代码执行。

**项目地址:** [regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-](https://github.com/regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #9

**来源**: [CVE-2024-2961-rvizx_CVE-2024-2961.md](../2024/CVE-2024-2961-rvizx_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，并且程序使用iconv函数转换到ISO-2022-CN-EXT字符集

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961 存在于 GNU C 库 (glibc) 的 iconv() 函数中。当应用程序使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果 glibc 版本低于 2.40，则可能发生缓冲区溢出，溢出量最多为 4 字节。这可能导致应用程序崩溃或覆盖相邻变量，攻击者可能利用此漏洞执行远程代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且存在PoC。提供的脚本 `fix.sh` 并非直接的利用代码，而是用于缓解该漏洞的脚本。它通过禁用有问题的字符集来阻止漏洞被触发，因此该脚本本身不是PoC，但验证了漏洞的可利用性。

**投毒风险：**

分析 `fix.sh` 脚本，它主要执行以下操作：

1.  检查系统是否存在受影响的字符集。
2.  查找 `gconv-modules-extra.conf` 文件。
3.  禁用 `gconv-modules-extra.conf` 中与 `ISO-2022-CN-EXT` 相关的编码。
4.  重新生成 gconv 模块缓存。
5.  验证缓解措施是否成功。

脚本中潜在的投毒点可能在于：

*   在禁用编码的部分，`sed` 命令可能被修改为删除其他重要的字符集，导致应用程序无法正常处理某些字符，虽然可能性不大，考虑到这个脚本的目的是缓解漏洞，恶意修改 `sed` 命令会适得其反，更容易被检测到。 *   替换 `gconv-modules-extra.conf` 或者注入恶意内容，导致系统无法正常工作。但是会影响全局导致应用异常。

总体而言，该脚本的风险较低，因为其主要功能是禁用特定的字符集，而不是执行任意代码。考虑到作者的信息和脚本内容，可以初步判断存在恶意投毒的可能性较低，估算投毒风险为 5%。

**利用方式：**

漏洞的利用方式是：

1.  攻击者需要找到一个应用程序，该应用程序使用 glibc 的 iconv() 函数进行字符集转换。
2.  应用程序必须使用 iconv() 函数将输入转换为 ISO-2022-CN-EXT 字符集。
3.  攻击者构造恶意的字符串，当该字符串被 iconv() 函数转换时，会导致输出缓冲区溢出。
4.  如果成功利用，攻击者可以控制程序的执行流程，甚至执行任意代码。具体利用效果取决于程序内存布局以及溢出造成的破坏。

**项目地址:** [rvizx/CVE-2024-2961](https://github.com/rvizx/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #10

**来源**: [CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md](../2024/CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md)

# CVE-2024-2961

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-2961-4wayhandshake_CVE-2024-2961.md](../2024/CVE-2024-2961-4wayhandshake_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，可能会发生最多4字节的输出缓冲区溢出。攻击者可以利用此漏洞导致应用程序崩溃或覆盖相邻的变量。根据提供的漏洞利用代码，该POC利用了`wrapwrap`工具来构造特定的PHP过滤器链，该过滤器链会触发`iconv()`函数的漏洞，从而实现任意文件读取。该POC针对WordPress环境，利用其`upload_image_from_url`功能，通过可控的URL参数和构造的过滤器链，读取服务器上的任意文件。 

**有效性：**
根据漏洞描述和提供的利用代码，该漏洞是可利用的。Ambionics网站上的文章 (webpage 4, and links inside CVE details) 以及提供的POC表明此漏洞可以通过精心构造的输入触发。

**投毒风险：**
检查`arbitrary-file-read.py`脚本，未发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造HTTP请求，利用`wrapwrap`生成的链，发送给目标服务器，并处理响应。脚本的目的是利用漏洞读取文件内容，没有发现任何主动植入后门或执行恶意操作的迹象。代码从`chain.txt`读取filter chain，并将其插入到POST请求中，这部分是与wrapwrap工具协同工作以利用漏洞。检查README.md文件，描述了如何使用POC和wrapwrap工具，没有发现任何可疑之处。因此，投毒风险较低。

**利用方式：**
1.  **目标确认:** 确认目标系统使用受影响的glibc版本（< 2.40）并且存在可以利用的字符集转换点。
2.  **构造Payload:** 使用wrapwrap工具，生成包含特定PHP filter chain的`chain.txt`文件，该filter chain可以触发iconv()函数的缓冲区溢出漏洞，目标是读取任意文件。
3.  **URL构造:** 攻击者需要找到一个接受URL作为参数的接口，例如WordPress的`upload_image_from_url`功能。
4.  **发送请求:** 攻击者将构造的包含恶意filter chain的URL发送给目标服务器。
5.  **触发漏洞:**  服务器的iconv()函数在处理字符集转换时发生缓冲区溢出。
6.  **任意文件读取:**  利用缓冲区溢出漏洞，读取服务器上的任意文件内容。
7.  **移除Prefix/Suffix:** 可以移除读取文件的前缀或后缀，方便查看文件内容。
8.  **结果获取:**  攻击者从服务器的响应中获取读取的文件内容。

此利用方式依赖于目标系统存在特定的字符集转换操作，并且攻击者能够控制输入到iconv()函数的参数。提供的代码专门针对WordPress环境，展示了如何利用其文件上传功能触发漏洞，读取服务器上的敏感文件。

**项目地址:** [4wayhandshake/CVE-2024-2961](https://github.com/4wayhandshake/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #2

**来源**: [CVE-2024-2961-absolutedesignltd_iconvfix.md](../2024/CVE-2024-2961-absolutedesignltd_iconvfix.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或覆盖相邻变量，甚至远程代码执行（根据搜索结果）

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标系统glibc版本低于2.40，字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 漏洞是 glibc 中 iconv() 函数在处理 ISO-2022-CN-EXT 字符集转换时存在的缓冲区溢出漏洞。具体来说，当 iconv() 将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会溢出输出缓冲区最多 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量。搜索结果表明该漏洞可能被利用于远程代码执行。

**漏洞利用方式：**

1.  **触发条件：**  利用iconv函数进行字符集转换，源字符集未知，目标字符集需要指定为ISO-2022-CN-EXT，且glibc版本低于2.40。
2.  **溢出：**  构造特定的输入字符串，当 iconv() 函数尝试将其转换为 ISO-2022-CN-EXT 时，导致输出缓冲区溢出 4 个字节。
3.  **利用：**  通过控制溢出的内容，可以覆盖相邻的变量，或者改变程序的执行流程，最终达到远程代码执行的目的。

**POC 代码分析：**

*   `iconvfix.sh` 脚本首先从 sansec.io 下载 `cve-2024-2961.c` 文件，然后编译并运行它。`cve-2024-2961.c` 应该是一个用于检测系统是否受 CVE-2024-2961 漏洞影响的程序。
*   如果检测到系统是易受攻击的，脚本会备份 `/usr/lib64/gconv/gconv-modules` 文件，然后注释掉该文件中与 ISO-2022-CN-EXT 相关的行。这样做可以禁用 ISO-2022-CN-EXT 字符集，从而缓解该漏洞。
*   `iconvconfig` 命令用于重建 iconv 的配置缓存。
*   脚本会再次运行漏洞检测程序，以确认补丁是否成功应用。

**有效性：**

提供的 `iconvfix.sh` 脚本通过注释掉 `/usr/lib64/gconv/gconv-modules` 文件中与 `ISO-2022-CN-EXT` 相关的行来缓解漏洞。这种方法能够阻止程序使用有漏洞的字符集转换，从而达到修复漏洞的效果。脚本的有效性依赖于系统是CentOS 7。

**投毒风险分析：**

*   脚本的主要操作是下载并执行来自 `sansec.io` 的代码。这意味着脚本的安全性取决于 `sansec.io` 的可信度。如果 `sansec.io` 被攻破或者提供恶意代码，那么执行该脚本的系统也会受到威胁。 *   脚本会修改 `/usr/lib64/gconv/gconv-modules` 文件，如果修改过程出现错误，可能会导致字符集转换出现问题。 *   尽管如此，代码本身没有明显的恶意行为，脚本意图在于修补漏洞，而非植入后门。投毒风险主要在于外部依赖 `sansec.io`，因此投毒风险相对较低。

**风险比例：** 下载外部脚本存在潜在风险，但是该脚本的内容更多的是修复行为，所以判断投毒风险为10%。

**项目地址:** [absolutedesignltd/iconvfix](https://github.com/absolutedesignltd/iconvfix)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #3

**来源**: [CVE-2024-2961-ambionics_cnext-exploits.md](../2024/CVE-2024-2961-ambionics_cnext-exploits.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务、信息泄露或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，且应用程序调用了iconv()函数，并转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 是 glibc iconv() 函数中的一个缓冲区溢出漏洞。该漏洞存在于glibc 2.39及更早版本中，当使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，可能导致输出缓冲区溢出，最多溢出 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量，进而可能被利用执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可利用的POC。提供的POC代码是一个名为`blind-cnext-exploit.py`的Python脚本，它利用了该漏洞实现了在PHP环境下的盲文件读取和远程代码执行。`README.md`文件提供了更详细的漏洞信息和利用方法的说明。

**投毒风险分析：**

分析`blind-cnext-exploit.py`的内容。代码结构相对复杂，涉及PHP filter chain的利用，但整体框架和逻辑比较清晰。主要的风险点在于`Remote`类，它负责与目标服务器交互并发送payload，如果`Remote`类中的代码被修改为恶意代码，例如在成功利用后执行额外的恶意操作，则存在投毒风险。但是，在对提供的代码进行分析后，并未发现明显的恶意行为。

`requirements.txt`文件需要安装的依赖库也需要进行检查，是否存在引入恶意库的可能。
综合判断，投毒风险较低，大约为10%。主要风险集中在`Remote`类的具体实现和`requirements.txt`依赖库。

**利用方式：**

该漏洞的利用方式如下：

1.  **触发漏洞：**  利用iconv()函数将特定的字符串转换为ISO-2022-CN-EXT字符集，触发缓冲区溢出。
2.  **盲文件读取：**  利用PHP filter chain技术，结合iconv()的漏洞，实现在目标服务器上的盲文件读取。
3.  **信息泄露：**  读取目标服务器上的敏感文件，例如PHP的配置文件、源代码等。
4.  **远程代码执行：**  通过文件读取，获取关键信息，例如libc地址、堆地址等，然后构造特定的payload，覆盖关键数据，最终实现远程代码执行。

提供的POC代码主要针对PHP环境，通过盲文件读取实现RCE。


**项目地址:** [ambionics/cnext-exploits](https://github.com/ambionics/cnext-exploits)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #4

**来源**: [CVE-2024-2961-exfil0_test_iconv.md](../2024/CVE-2024-2961-exfil0_test_iconv.md)

## CVE-2024-2961

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、覆盖相邻变量甚至远程代码执行。

**影响版本:** < 2.40

**利用条件:** 目标系统使用glibc版本低于2.40，并且程序调用了iconv()函数进行字符集转换，特别是转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数存在的一个缓冲区溢出漏洞。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能发生最多4个字节的溢出。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，此漏洞被认为是有效的。漏洞库和搜索结果中都明确指出iconv()函数在特定条件下会发生缓冲区溢出。提供的POC代码尝试触发该漏洞，通过将字符串转换为ISO-2022-CN-EXT字符集来测试溢出。

**投毒风险：** 提供的代码仓库中没有发现明显的投毒迹象。`README.md`文件描述了漏洞的利用方法，并提供了编译和运行POC的步骤。`test_iconv.c`文件是简单的C代码，用于调用iconv()函数并尝试触发漏洞。代码本身没有包含任何恶意或隐藏的功能。因此，投毒风险评估为0%。

**利用方式：**

1.  **触发漏洞：** 攻击者需要控制iconv()函数的输入和输出缓冲区，并且指定目标字符集为ISO-2022-CN-EXT。攻击者需要输入精心构造的字符串。
2.  **溢出利用：** 由于溢出只有4个字节，通常无法直接实现任意代码执行。然而，结合其他技术（例如堆利用）可能能够利用此漏洞来覆盖关键数据结构，例如堆元数据或者函数指针。
3.  **远程代码执行(RCE)：**  根据搜索结果，特别是RedHat的描述，该漏洞可能允许攻击者通过构造恶意字符序列触发越界写入并执行远程代码。Ambionics的文章也深入探讨了利用此漏洞实现RCE的可能性，特别是在PHP环境中，通过修改free list 指针，从而实现任意写。

**总结：**

CVE-2024-2961是一个缓冲区溢出漏洞，虽然溢出量较小，但结合其他技术，攻击者可以利用此漏洞实现程序崩溃，变量覆盖，甚至远程代码执行。提供的POC代码验证了该漏洞的存在，代码本身没有发现投毒风险。

**项目地址:** [exfil0/test_iconv](https://github.com/exfil0/test_iconv)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #5

**来源**: [CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md](../2024/CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、任意代码执行或信息泄露

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并调用iconv()函数进行ISO-2022-CN-EXT字符集转换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中。当将字符串转换为 ISO-2022-CN-EXT 字符集时，该函数可能导致输出缓冲区溢出，最多溢出 4 个字节。攻击者可以利用此漏洞通过特制的字符序列触发越界写入，从而导致应用程序崩溃，覆盖相邻变量或执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此漏洞利用 **有效**。漏洞库信息明确指出 iconv() 函数存在缓冲区溢出，搜索引擎结果也佐证了漏洞的存在，并提及了远程代码执行的可能性。提供的 Python 脚本 (exp.py) 尝试利用该漏洞，通过构造特定的输入，触发堆溢出，并最终尝试执行任意代码。Ambionics 的博客文章 (由搜索结果中的网页 4 指出) 提供了更详细的漏洞分析和利用方法，进一步确认了漏洞的可利用性。

**投毒风险评估：**
对提供的 exp.py 脚本进行分析：

*   **依赖库：** 脚本依赖 `pwn`, `requests` (通过`ten` 模块，该模块可能封装了`requests`) 和 `zlib` 等库。这些库本身可能存在安全风险，但属于常用库，风险较低。
*   **功能：** 脚本的主要功能是从远程服务器下载文件，读取内存映射，计算堆地址，然后构造特定的输入数据，触发漏洞。脚本包含很多与堆操作相关的代码,例如计算地址和chunk size。整体代码复杂，难以完全确定是否存在后门。
*   **可疑点：** 脚本使用了 `ten` 这个模块，这有可能是一个定制的模块，其中可能存在未知的恶意代码。脚本中包含了多个压缩和分块的操作，用于构造特定的攻击载荷，这些操作增加了代码的复杂性，也增加了隐藏恶意代码的可能性。
    `ADDR_EFREE = LIBC.symbols["__libc_system"]`这行代码使用了 system 函数，如果能控制传递给 system 函数的参数，就可以执行任意命令。在exp.py的剩余部分代码中，代码是不完整的，难以确认最终传递给system函数的参数。 

综合评估，该 POC 存在一定的投毒风险，大约为 **10%**。风险主要来自于 `ten` 模块的未知风险和利用 `system` 函数执行命令的可能性。

**利用方式分析：**

1.  **漏洞触发：** 漏洞利用首先需要触发 `iconv()` 函数，并将易受攻击的字符集作为目标。
2.  **内存布局：** 攻击者需要确定目标系统上的内存布局，特别是堆地址和 libc 地址。利用代码通过读取 `/proc/self/maps` 来获取内存区域信息，然后计算堆和 libc 的基地址。
3.  **堆溢出：** 攻击者通过构造特定的输入，利用缓冲区溢出覆盖堆上的元数据。提供的代码使用了 `chunked_chunk` 和 `compressed_bucket` 函数来创建包含特定大小和内容的 chunked data，这些chunked data会触发堆溢出。
4.  **任意代码执行：** 成功触发堆溢出后，攻击者可以覆盖关键内存区域，例如函数指针或 GOT 表项，以便在程序执行过程中劫持控制流。利用代码试图覆盖 `__libc_system` 函数，以便执行任意命令。具体而言，攻击者会覆盖free list bin指针指向伪造的chunk，然后通过malloc操作来操纵内存，从而达到任意写的效果，最终劫持控制流，执行任意代码（调用 `system` 函数）。

**项目地址:** [kjdfklha/CVE-2024-2961_poc](https://github.com/kjdfklha/CVE-2024-2961_poc)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #6

**来源**: [CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md](../2024/CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md)

## CVE-2024-2961-glibc-iconv 缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量，在特定情况下可能导致远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要存在使用 iconv 函数，并且进行到 ISO-2022-CN-EXT 字符集的转换。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中，当将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会导致最多 4 字节的输出缓冲区溢出。该漏洞影响 2.39 及更早版本。从提供的漏洞利用代码来看，该脚本利用 PHP 的 filter chain 和 iconv 函数处理字符编码转换的缺陷，实现任意文件读取。脚本首先创建一个包含一系列 iconv 转换的 PHP 过滤器链 payload，该 payload 用于读取目标服务器上的任意文件。然后，脚本通过模拟图像上传，将 payload 隐藏在 POST 请求中，发送到目标服务器的 admin-ajax.php 端点。服务器处理请求后，脚本下载生成的文件，并提取显示目标文件的内容。

**有效性：**
根据CVE描述和搜索结果以及提供的漏洞利用代码，此漏洞利用的有效性较高。CISA ADP 将其标记为“poc”，且存在利用的技术可行性。

**投毒风险：**
提供的代码主要包含一个 Python 脚本 (lfi.py) 和一个 README.md 文件。Python 脚本的功能是利用 CVE-2024-2961 漏洞读取远程文件。检查脚本发现其主要是构造恶意的字符转换，没有明显的恶意代码或者后门。脚本依赖于特定的目标 URL 和请求头，这些信息需要在实际使用前进行配置。脚本本身较为直接，没有发现隐藏的投毒代码。

**利用方式：**
利用方式是通过构造特定的 PHP 过滤器链，借助 iconv 函数在字符集转换过程中触发缓冲区溢出，从而读取服务器上的任意文件。


**项目地址:** [kyotozx/CVE-2024-2961-Remote-File-Read](https://github.com/kyotozx/CVE-2024-2961-Remote-File-Read)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #7

**来源**: [CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md](../2024/CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或任意代码执行

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行ISO-2022-CN-EXT字符集转换，并且输出缓冲区大小可控。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数的一个缓冲区溢出漏洞。当使用iconv()将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能会发生最多4字节的溢出。攻击者可以通过构造特定的输入字符串来触发此漏洞，导致程序崩溃或覆盖相邻的变量，甚至执行任意代码。

**有效性评估：**
根据CVE信息和搜索结果，该漏洞已经公开披露，并且存在可利用的POC。提供的修复脚本通过从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行来缓解该漏洞，禁用存在漏洞的字符集转换。 因此，修复脚本本身表明该漏洞是可利用的，虽然提供的脚本仅仅是缓解，而不是直接的exp.

**投毒风险评估：**
提供的`fix.sh`脚本的主要功能是检测系统上是否存在受漏洞影响的glibc版本，并尝试通过修改iconv的配置文件来缓解该漏洞。脚本首先检查`/usr/lib/x86_64-linux-gnu/gconv`目录是否存在，然后检查ldd版本是否包含GLIBC，并检查`iconv -l`命令的输出是否包含'CN-?EXT'。如果以上检查都通过，脚本会尝试使用`grep`命令从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行，并将修改后的内容保存到`.new`文件中，最后使用`mv`命令覆盖原始文件。脚本的最后运行`iconvconfig`。

该脚本的目的是缓解漏洞，而不是利用漏洞。没有发现任何恶意代码或隐藏的后门。因此，投毒风险可以认为是0%。

**利用方式：**
1.  **触发漏洞：** 通过调用iconv()函数，并将一个精心构造的字符串从一种字符集转换为ISO-2022-CN-EXT字符集。
2.  **控制溢出：**  控制输入字符串和输出缓冲区的大小，确保溢出发生，并且覆盖到目标内存区域。
3.  **代码执行 (如果可能)：** 如果溢出覆盖了函数返回地址或其他关键数据，攻击者可以控制程序的执行流程，最终实现任意代码执行。

漏洞利用难度取决于具体的环境和目标程序。在某些情况下，可能需要绕过各种安全机制，如地址空间布局随机化（ASLR）和数据执行保护（DEP）。

**项目地址:** [mattaperkins/FIX-CVE-2024-2961](https://github.com/mattaperkins/FIX-CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #8

**来源**: [CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md](../2024/CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并且存在可利用的iconv()函数调用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用`iconv()`函数将字符串转换为ISO-2022-CN-EXT字符集时，可能导致输出缓冲区溢出最多4个字节。

**有效性评估：**

根据漏洞信息和搜索引擎结果，此漏洞存在已知的PoC。PoC代码利用了PHP的`php://filter`流包装器以及一系列的`convert.iconv.*`过滤器链，通过精心构造的输入，触发glibc的iconv函数进行字符集转换，最终造成缓冲区溢出。利用方式较为复杂，依赖于PHP环境和特定的配置。

根据搜索引擎的结果发现，存在远程代码执行的可能性，结合给出的EXP代码来看，EXP中的利用是通过构造特定的`convert.iconv`链条最终溢出达到读取文件内容或者写入的目的。

**投毒风险评估：**

提供的PoC代码主要通过HTTP请求发送payload，并下载`/proc/self/maps`和libc文件。虽然PoC中包含了一些base64编码和解码操作，以及`convert.iconv` 链条，但整体逻辑看起来是为了利用漏洞，没有明显的恶意代码，但仍然存在很小的风险。

风险点在于：

1.  **依赖外部资源：** PoC可能需要下载远程文件（libc），攻击者可以替换这些文件为恶意文件。
2.  **命令执行：** PoC允许指定要执行的命令，如果目标系统配置不当，可能导致恶意命令执行。
3.  **未知的依赖项风险：** PoC可能依赖于未知的或未公开的第三方库，这些库可能存在安全漏洞，或者被攻击者篡改。

综合评估，PoC代码存在一定的投毒风险，但概率较低(5%)，需要仔细审计代码，并确保使用的外部资源是可信的。

**利用方式：**

1.  **目标识别：** 确定目标系统使用的glibc版本低于2.40，并且存在iconv()函数调用。
2.  **构造Payload：**  使用`php://filter`流包装器和一系列的`convert.iconv.*`过滤器链构造恶意的payload，触发缓冲区溢出。
3.  **信息泄露/代码执行：** 利用溢出覆盖相邻的变量或函数指针，从而实现信息泄露或远程代码执行。

**项目地址:** [regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-](https://github.com/regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #9

**来源**: [CVE-2024-2961-rvizx_CVE-2024-2961.md](../2024/CVE-2024-2961-rvizx_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，并且程序使用iconv函数转换到ISO-2022-CN-EXT字符集

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961 存在于 GNU C 库 (glibc) 的 iconv() 函数中。当应用程序使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果 glibc 版本低于 2.40，则可能发生缓冲区溢出，溢出量最多为 4 字节。这可能导致应用程序崩溃或覆盖相邻变量，攻击者可能利用此漏洞执行远程代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且存在PoC。提供的脚本 `fix.sh` 并非直接的利用代码，而是用于缓解该漏洞的脚本。它通过禁用有问题的字符集来阻止漏洞被触发，因此该脚本本身不是PoC，但验证了漏洞的可利用性。

**投毒风险：**

分析 `fix.sh` 脚本，它主要执行以下操作：

1.  检查系统是否存在受影响的字符集。
2.  查找 `gconv-modules-extra.conf` 文件。
3.  禁用 `gconv-modules-extra.conf` 中与 `ISO-2022-CN-EXT` 相关的编码。
4.  重新生成 gconv 模块缓存。
5.  验证缓解措施是否成功。

脚本中潜在的投毒点可能在于：

*   在禁用编码的部分，`sed` 命令可能被修改为删除其他重要的字符集，导致应用程序无法正常处理某些字符，虽然可能性不大，考虑到这个脚本的目的是缓解漏洞，恶意修改 `sed` 命令会适得其反，更容易被检测到。 *   替换 `gconv-modules-extra.conf` 或者注入恶意内容，导致系统无法正常工作。但是会影响全局导致应用异常。

总体而言，该脚本的风险较低，因为其主要功能是禁用特定的字符集，而不是执行任意代码。考虑到作者的信息和脚本内容，可以初步判断存在恶意投毒的可能性较低，估算投毒风险为 5%。

**利用方式：**

漏洞的利用方式是：

1.  攻击者需要找到一个应用程序，该应用程序使用 glibc 的 iconv() 函数进行字符集转换。
2.  应用程序必须使用 iconv() 函数将输入转换为 ISO-2022-CN-EXT 字符集。
3.  攻击者构造恶意的字符串，当该字符串被 iconv() 函数转换时，会导致输出缓冲区溢出。
4.  如果成功利用，攻击者可以控制程序的执行流程，甚至执行任意代码。具体利用效果取决于程序内存布局以及溢出造成的破坏。

**项目地址:** [rvizx/CVE-2024-2961](https://github.com/rvizx/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #10

**来源**: [CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md](../2024/CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md)

# CVE-2024-2961

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-2961-4wayhandshake_CVE-2024-2961.md](../2024/CVE-2024-2961-4wayhandshake_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，可能会发生最多4字节的输出缓冲区溢出。攻击者可以利用此漏洞导致应用程序崩溃或覆盖相邻的变量。根据提供的漏洞利用代码，该POC利用了`wrapwrap`工具来构造特定的PHP过滤器链，该过滤器链会触发`iconv()`函数的漏洞，从而实现任意文件读取。该POC针对WordPress环境，利用其`upload_image_from_url`功能，通过可控的URL参数和构造的过滤器链，读取服务器上的任意文件。 

**有效性：**
根据漏洞描述和提供的利用代码，该漏洞是可利用的。Ambionics网站上的文章 (webpage 4, and links inside CVE details) 以及提供的POC表明此漏洞可以通过精心构造的输入触发。

**投毒风险：**
检查`arbitrary-file-read.py`脚本，未发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造HTTP请求，利用`wrapwrap`生成的链，发送给目标服务器，并处理响应。脚本的目的是利用漏洞读取文件内容，没有发现任何主动植入后门或执行恶意操作的迹象。代码从`chain.txt`读取filter chain，并将其插入到POST请求中，这部分是与wrapwrap工具协同工作以利用漏洞。检查README.md文件，描述了如何使用POC和wrapwrap工具，没有发现任何可疑之处。因此，投毒风险较低。

**利用方式：**
1.  **目标确认:** 确认目标系统使用受影响的glibc版本（< 2.40）并且存在可以利用的字符集转换点。
2.  **构造Payload:** 使用wrapwrap工具，生成包含特定PHP filter chain的`chain.txt`文件，该filter chain可以触发iconv()函数的缓冲区溢出漏洞，目标是读取任意文件。
3.  **URL构造:** 攻击者需要找到一个接受URL作为参数的接口，例如WordPress的`upload_image_from_url`功能。
4.  **发送请求:** 攻击者将构造的包含恶意filter chain的URL发送给目标服务器。
5.  **触发漏洞:**  服务器的iconv()函数在处理字符集转换时发生缓冲区溢出。
6.  **任意文件读取:**  利用缓冲区溢出漏洞，读取服务器上的任意文件内容。
7.  **移除Prefix/Suffix:** 可以移除读取文件的前缀或后缀，方便查看文件内容。
8.  **结果获取:**  攻击者从服务器的响应中获取读取的文件内容。

此利用方式依赖于目标系统存在特定的字符集转换操作，并且攻击者能够控制输入到iconv()函数的参数。提供的代码专门针对WordPress环境，展示了如何利用其文件上传功能触发漏洞，读取服务器上的敏感文件。

**项目地址:** [4wayhandshake/CVE-2024-2961](https://github.com/4wayhandshake/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #2

**来源**: [CVE-2024-2961-absolutedesignltd_iconvfix.md](../2024/CVE-2024-2961-absolutedesignltd_iconvfix.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或覆盖相邻变量，甚至远程代码执行（根据搜索结果）

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标系统glibc版本低于2.40，字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 漏洞是 glibc 中 iconv() 函数在处理 ISO-2022-CN-EXT 字符集转换时存在的缓冲区溢出漏洞。具体来说，当 iconv() 将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会溢出输出缓冲区最多 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量。搜索结果表明该漏洞可能被利用于远程代码执行。

**漏洞利用方式：**

1.  **触发条件：**  利用iconv函数进行字符集转换，源字符集未知，目标字符集需要指定为ISO-2022-CN-EXT，且glibc版本低于2.40。
2.  **溢出：**  构造特定的输入字符串，当 iconv() 函数尝试将其转换为 ISO-2022-CN-EXT 时，导致输出缓冲区溢出 4 个字节。
3.  **利用：**  通过控制溢出的内容，可以覆盖相邻的变量，或者改变程序的执行流程，最终达到远程代码执行的目的。

**POC 代码分析：**

*   `iconvfix.sh` 脚本首先从 sansec.io 下载 `cve-2024-2961.c` 文件，然后编译并运行它。`cve-2024-2961.c` 应该是一个用于检测系统是否受 CVE-2024-2961 漏洞影响的程序。
*   如果检测到系统是易受攻击的，脚本会备份 `/usr/lib64/gconv/gconv-modules` 文件，然后注释掉该文件中与 ISO-2022-CN-EXT 相关的行。这样做可以禁用 ISO-2022-CN-EXT 字符集，从而缓解该漏洞。
*   `iconvconfig` 命令用于重建 iconv 的配置缓存。
*   脚本会再次运行漏洞检测程序，以确认补丁是否成功应用。

**有效性：**

提供的 `iconvfix.sh` 脚本通过注释掉 `/usr/lib64/gconv/gconv-modules` 文件中与 `ISO-2022-CN-EXT` 相关的行来缓解漏洞。这种方法能够阻止程序使用有漏洞的字符集转换，从而达到修复漏洞的效果。脚本的有效性依赖于系统是CentOS 7。

**投毒风险分析：**

*   脚本的主要操作是下载并执行来自 `sansec.io` 的代码。这意味着脚本的安全性取决于 `sansec.io` 的可信度。如果 `sansec.io` 被攻破或者提供恶意代码，那么执行该脚本的系统也会受到威胁。 *   脚本会修改 `/usr/lib64/gconv/gconv-modules` 文件，如果修改过程出现错误，可能会导致字符集转换出现问题。 *   尽管如此，代码本身没有明显的恶意行为，脚本意图在于修补漏洞，而非植入后门。投毒风险主要在于外部依赖 `sansec.io`，因此投毒风险相对较低。

**风险比例：** 下载外部脚本存在潜在风险，但是该脚本的内容更多的是修复行为，所以判断投毒风险为10%。

**项目地址:** [absolutedesignltd/iconvfix](https://github.com/absolutedesignltd/iconvfix)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #3

**来源**: [CVE-2024-2961-ambionics_cnext-exploits.md](../2024/CVE-2024-2961-ambionics_cnext-exploits.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务、信息泄露或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，且应用程序调用了iconv()函数，并转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 是 glibc iconv() 函数中的一个缓冲区溢出漏洞。该漏洞存在于glibc 2.39及更早版本中，当使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，可能导致输出缓冲区溢出，最多溢出 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量，进而可能被利用执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可利用的POC。提供的POC代码是一个名为`blind-cnext-exploit.py`的Python脚本，它利用了该漏洞实现了在PHP环境下的盲文件读取和远程代码执行。`README.md`文件提供了更详细的漏洞信息和利用方法的说明。

**投毒风险分析：**

分析`blind-cnext-exploit.py`的内容。代码结构相对复杂，涉及PHP filter chain的利用，但整体框架和逻辑比较清晰。主要的风险点在于`Remote`类，它负责与目标服务器交互并发送payload，如果`Remote`类中的代码被修改为恶意代码，例如在成功利用后执行额外的恶意操作，则存在投毒风险。但是，在对提供的代码进行分析后，并未发现明显的恶意行为。

`requirements.txt`文件需要安装的依赖库也需要进行检查，是否存在引入恶意库的可能。
综合判断，投毒风险较低，大约为10%。主要风险集中在`Remote`类的具体实现和`requirements.txt`依赖库。

**利用方式：**

该漏洞的利用方式如下：

1.  **触发漏洞：**  利用iconv()函数将特定的字符串转换为ISO-2022-CN-EXT字符集，触发缓冲区溢出。
2.  **盲文件读取：**  利用PHP filter chain技术，结合iconv()的漏洞，实现在目标服务器上的盲文件读取。
3.  **信息泄露：**  读取目标服务器上的敏感文件，例如PHP的配置文件、源代码等。
4.  **远程代码执行：**  通过文件读取，获取关键信息，例如libc地址、堆地址等，然后构造特定的payload，覆盖关键数据，最终实现远程代码执行。

提供的POC代码主要针对PHP环境，通过盲文件读取实现RCE。


**项目地址:** [ambionics/cnext-exploits](https://github.com/ambionics/cnext-exploits)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #4

**来源**: [CVE-2024-2961-exfil0_test_iconv.md](../2024/CVE-2024-2961-exfil0_test_iconv.md)

## CVE-2024-2961

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、覆盖相邻变量甚至远程代码执行。

**影响版本:** < 2.40

**利用条件:** 目标系统使用glibc版本低于2.40，并且程序调用了iconv()函数进行字符集转换，特别是转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数存在的一个缓冲区溢出漏洞。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能发生最多4个字节的溢出。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，此漏洞被认为是有效的。漏洞库和搜索结果中都明确指出iconv()函数在特定条件下会发生缓冲区溢出。提供的POC代码尝试触发该漏洞，通过将字符串转换为ISO-2022-CN-EXT字符集来测试溢出。

**投毒风险：** 提供的代码仓库中没有发现明显的投毒迹象。`README.md`文件描述了漏洞的利用方法，并提供了编译和运行POC的步骤。`test_iconv.c`文件是简单的C代码，用于调用iconv()函数并尝试触发漏洞。代码本身没有包含任何恶意或隐藏的功能。因此，投毒风险评估为0%。

**利用方式：**

1.  **触发漏洞：** 攻击者需要控制iconv()函数的输入和输出缓冲区，并且指定目标字符集为ISO-2022-CN-EXT。攻击者需要输入精心构造的字符串。
2.  **溢出利用：** 由于溢出只有4个字节，通常无法直接实现任意代码执行。然而，结合其他技术（例如堆利用）可能能够利用此漏洞来覆盖关键数据结构，例如堆元数据或者函数指针。
3.  **远程代码执行(RCE)：**  根据搜索结果，特别是RedHat的描述，该漏洞可能允许攻击者通过构造恶意字符序列触发越界写入并执行远程代码。Ambionics的文章也深入探讨了利用此漏洞实现RCE的可能性，特别是在PHP环境中，通过修改free list 指针，从而实现任意写。

**总结：**

CVE-2024-2961是一个缓冲区溢出漏洞，虽然溢出量较小，但结合其他技术，攻击者可以利用此漏洞实现程序崩溃，变量覆盖，甚至远程代码执行。提供的POC代码验证了该漏洞的存在，代码本身没有发现投毒风险。

**项目地址:** [exfil0/test_iconv](https://github.com/exfil0/test_iconv)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #5

**来源**: [CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md](../2024/CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、任意代码执行或信息泄露

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并调用iconv()函数进行ISO-2022-CN-EXT字符集转换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中。当将字符串转换为 ISO-2022-CN-EXT 字符集时，该函数可能导致输出缓冲区溢出，最多溢出 4 个字节。攻击者可以利用此漏洞通过特制的字符序列触发越界写入，从而导致应用程序崩溃，覆盖相邻变量或执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此漏洞利用 **有效**。漏洞库信息明确指出 iconv() 函数存在缓冲区溢出，搜索引擎结果也佐证了漏洞的存在，并提及了远程代码执行的可能性。提供的 Python 脚本 (exp.py) 尝试利用该漏洞，通过构造特定的输入，触发堆溢出，并最终尝试执行任意代码。Ambionics 的博客文章 (由搜索结果中的网页 4 指出) 提供了更详细的漏洞分析和利用方法，进一步确认了漏洞的可利用性。

**投毒风险评估：**
对提供的 exp.py 脚本进行分析：

*   **依赖库：** 脚本依赖 `pwn`, `requests` (通过`ten` 模块，该模块可能封装了`requests`) 和 `zlib` 等库。这些库本身可能存在安全风险，但属于常用库，风险较低。
*   **功能：** 脚本的主要功能是从远程服务器下载文件，读取内存映射，计算堆地址，然后构造特定的输入数据，触发漏洞。脚本包含很多与堆操作相关的代码,例如计算地址和chunk size。整体代码复杂，难以完全确定是否存在后门。
*   **可疑点：** 脚本使用了 `ten` 这个模块，这有可能是一个定制的模块，其中可能存在未知的恶意代码。脚本中包含了多个压缩和分块的操作，用于构造特定的攻击载荷，这些操作增加了代码的复杂性，也增加了隐藏恶意代码的可能性。
    `ADDR_EFREE = LIBC.symbols["__libc_system"]`这行代码使用了 system 函数，如果能控制传递给 system 函数的参数，就可以执行任意命令。在exp.py的剩余部分代码中，代码是不完整的，难以确认最终传递给system函数的参数。 

综合评估，该 POC 存在一定的投毒风险，大约为 **10%**。风险主要来自于 `ten` 模块的未知风险和利用 `system` 函数执行命令的可能性。

**利用方式分析：**

1.  **漏洞触发：** 漏洞利用首先需要触发 `iconv()` 函数，并将易受攻击的字符集作为目标。
2.  **内存布局：** 攻击者需要确定目标系统上的内存布局，特别是堆地址和 libc 地址。利用代码通过读取 `/proc/self/maps` 来获取内存区域信息，然后计算堆和 libc 的基地址。
3.  **堆溢出：** 攻击者通过构造特定的输入，利用缓冲区溢出覆盖堆上的元数据。提供的代码使用了 `chunked_chunk` 和 `compressed_bucket` 函数来创建包含特定大小和内容的 chunked data，这些chunked data会触发堆溢出。
4.  **任意代码执行：** 成功触发堆溢出后，攻击者可以覆盖关键内存区域，例如函数指针或 GOT 表项，以便在程序执行过程中劫持控制流。利用代码试图覆盖 `__libc_system` 函数，以便执行任意命令。具体而言，攻击者会覆盖free list bin指针指向伪造的chunk，然后通过malloc操作来操纵内存，从而达到任意写的效果，最终劫持控制流，执行任意代码（调用 `system` 函数）。

**项目地址:** [kjdfklha/CVE-2024-2961_poc](https://github.com/kjdfklha/CVE-2024-2961_poc)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #6

**来源**: [CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md](../2024/CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md)

## CVE-2024-2961-glibc-iconv 缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量，在特定情况下可能导致远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要存在使用 iconv 函数，并且进行到 ISO-2022-CN-EXT 字符集的转换。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中，当将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会导致最多 4 字节的输出缓冲区溢出。该漏洞影响 2.39 及更早版本。从提供的漏洞利用代码来看，该脚本利用 PHP 的 filter chain 和 iconv 函数处理字符编码转换的缺陷，实现任意文件读取。脚本首先创建一个包含一系列 iconv 转换的 PHP 过滤器链 payload，该 payload 用于读取目标服务器上的任意文件。然后，脚本通过模拟图像上传，将 payload 隐藏在 POST 请求中，发送到目标服务器的 admin-ajax.php 端点。服务器处理请求后，脚本下载生成的文件，并提取显示目标文件的内容。

**有效性：**
根据CVE描述和搜索结果以及提供的漏洞利用代码，此漏洞利用的有效性较高。CISA ADP 将其标记为“poc”，且存在利用的技术可行性。

**投毒风险：**
提供的代码主要包含一个 Python 脚本 (lfi.py) 和一个 README.md 文件。Python 脚本的功能是利用 CVE-2024-2961 漏洞读取远程文件。检查脚本发现其主要是构造恶意的字符转换，没有明显的恶意代码或者后门。脚本依赖于特定的目标 URL 和请求头，这些信息需要在实际使用前进行配置。脚本本身较为直接，没有发现隐藏的投毒代码。

**利用方式：**
利用方式是通过构造特定的 PHP 过滤器链，借助 iconv 函数在字符集转换过程中触发缓冲区溢出，从而读取服务器上的任意文件。


**项目地址:** [kyotozx/CVE-2024-2961-Remote-File-Read](https://github.com/kyotozx/CVE-2024-2961-Remote-File-Read)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #7

**来源**: [CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md](../2024/CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或任意代码执行

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行ISO-2022-CN-EXT字符集转换，并且输出缓冲区大小可控。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数的一个缓冲区溢出漏洞。当使用iconv()将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能会发生最多4字节的溢出。攻击者可以通过构造特定的输入字符串来触发此漏洞，导致程序崩溃或覆盖相邻的变量，甚至执行任意代码。

**有效性评估：**
根据CVE信息和搜索结果，该漏洞已经公开披露，并且存在可利用的POC。提供的修复脚本通过从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行来缓解该漏洞，禁用存在漏洞的字符集转换。 因此，修复脚本本身表明该漏洞是可利用的，虽然提供的脚本仅仅是缓解，而不是直接的exp.

**投毒风险评估：**
提供的`fix.sh`脚本的主要功能是检测系统上是否存在受漏洞影响的glibc版本，并尝试通过修改iconv的配置文件来缓解该漏洞。脚本首先检查`/usr/lib/x86_64-linux-gnu/gconv`目录是否存在，然后检查ldd版本是否包含GLIBC，并检查`iconv -l`命令的输出是否包含'CN-?EXT'。如果以上检查都通过，脚本会尝试使用`grep`命令从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行，并将修改后的内容保存到`.new`文件中，最后使用`mv`命令覆盖原始文件。脚本的最后运行`iconvconfig`。

该脚本的目的是缓解漏洞，而不是利用漏洞。没有发现任何恶意代码或隐藏的后门。因此，投毒风险可以认为是0%。

**利用方式：**
1.  **触发漏洞：** 通过调用iconv()函数，并将一个精心构造的字符串从一种字符集转换为ISO-2022-CN-EXT字符集。
2.  **控制溢出：**  控制输入字符串和输出缓冲区的大小，确保溢出发生，并且覆盖到目标内存区域。
3.  **代码执行 (如果可能)：** 如果溢出覆盖了函数返回地址或其他关键数据，攻击者可以控制程序的执行流程，最终实现任意代码执行。

漏洞利用难度取决于具体的环境和目标程序。在某些情况下，可能需要绕过各种安全机制，如地址空间布局随机化（ASLR）和数据执行保护（DEP）。

**项目地址:** [mattaperkins/FIX-CVE-2024-2961](https://github.com/mattaperkins/FIX-CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #8

**来源**: [CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md](../2024/CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并且存在可利用的iconv()函数调用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用`iconv()`函数将字符串转换为ISO-2022-CN-EXT字符集时，可能导致输出缓冲区溢出最多4个字节。

**有效性评估：**

根据漏洞信息和搜索引擎结果，此漏洞存在已知的PoC。PoC代码利用了PHP的`php://filter`流包装器以及一系列的`convert.iconv.*`过滤器链，通过精心构造的输入，触发glibc的iconv函数进行字符集转换，最终造成缓冲区溢出。利用方式较为复杂，依赖于PHP环境和特定的配置。

根据搜索引擎的结果发现，存在远程代码执行的可能性，结合给出的EXP代码来看，EXP中的利用是通过构造特定的`convert.iconv`链条最终溢出达到读取文件内容或者写入的目的。

**投毒风险评估：**

提供的PoC代码主要通过HTTP请求发送payload，并下载`/proc/self/maps`和libc文件。虽然PoC中包含了一些base64编码和解码操作，以及`convert.iconv` 链条，但整体逻辑看起来是为了利用漏洞，没有明显的恶意代码，但仍然存在很小的风险。

风险点在于：

1.  **依赖外部资源：** PoC可能需要下载远程文件（libc），攻击者可以替换这些文件为恶意文件。
2.  **命令执行：** PoC允许指定要执行的命令，如果目标系统配置不当，可能导致恶意命令执行。
3.  **未知的依赖项风险：** PoC可能依赖于未知的或未公开的第三方库，这些库可能存在安全漏洞，或者被攻击者篡改。

综合评估，PoC代码存在一定的投毒风险，但概率较低(5%)，需要仔细审计代码，并确保使用的外部资源是可信的。

**利用方式：**

1.  **目标识别：** 确定目标系统使用的glibc版本低于2.40，并且存在iconv()函数调用。
2.  **构造Payload：**  使用`php://filter`流包装器和一系列的`convert.iconv.*`过滤器链构造恶意的payload，触发缓冲区溢出。
3.  **信息泄露/代码执行：** 利用溢出覆盖相邻的变量或函数指针，从而实现信息泄露或远程代码执行。

**项目地址:** [regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-](https://github.com/regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #9

**来源**: [CVE-2024-2961-rvizx_CVE-2024-2961.md](../2024/CVE-2024-2961-rvizx_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，并且程序使用iconv函数转换到ISO-2022-CN-EXT字符集

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961 存在于 GNU C 库 (glibc) 的 iconv() 函数中。当应用程序使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果 glibc 版本低于 2.40，则可能发生缓冲区溢出，溢出量最多为 4 字节。这可能导致应用程序崩溃或覆盖相邻变量，攻击者可能利用此漏洞执行远程代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且存在PoC。提供的脚本 `fix.sh` 并非直接的利用代码，而是用于缓解该漏洞的脚本。它通过禁用有问题的字符集来阻止漏洞被触发，因此该脚本本身不是PoC，但验证了漏洞的可利用性。

**投毒风险：**

分析 `fix.sh` 脚本，它主要执行以下操作：

1.  检查系统是否存在受影响的字符集。
2.  查找 `gconv-modules-extra.conf` 文件。
3.  禁用 `gconv-modules-extra.conf` 中与 `ISO-2022-CN-EXT` 相关的编码。
4.  重新生成 gconv 模块缓存。
5.  验证缓解措施是否成功。

脚本中潜在的投毒点可能在于：

*   在禁用编码的部分，`sed` 命令可能被修改为删除其他重要的字符集，导致应用程序无法正常处理某些字符，虽然可能性不大，考虑到这个脚本的目的是缓解漏洞，恶意修改 `sed` 命令会适得其反，更容易被检测到。 *   替换 `gconv-modules-extra.conf` 或者注入恶意内容，导致系统无法正常工作。但是会影响全局导致应用异常。

总体而言，该脚本的风险较低，因为其主要功能是禁用特定的字符集，而不是执行任意代码。考虑到作者的信息和脚本内容，可以初步判断存在恶意投毒的可能性较低，估算投毒风险为 5%。

**利用方式：**

漏洞的利用方式是：

1.  攻击者需要找到一个应用程序，该应用程序使用 glibc 的 iconv() 函数进行字符集转换。
2.  应用程序必须使用 iconv() 函数将输入转换为 ISO-2022-CN-EXT 字符集。
3.  攻击者构造恶意的字符串，当该字符串被 iconv() 函数转换时，会导致输出缓冲区溢出。
4.  如果成功利用，攻击者可以控制程序的执行流程，甚至执行任意代码。具体利用效果取决于程序内存布局以及溢出造成的破坏。

**项目地址:** [rvizx/CVE-2024-2961](https://github.com/rvizx/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #10

**来源**: [CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md](../2024/CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md)

# CVE-2024-2961

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-2961-4wayhandshake_CVE-2024-2961.md](../2024/CVE-2024-2961-4wayhandshake_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，可能会发生最多4字节的输出缓冲区溢出。攻击者可以利用此漏洞导致应用程序崩溃或覆盖相邻的变量。根据提供的漏洞利用代码，该POC利用了`wrapwrap`工具来构造特定的PHP过滤器链，该过滤器链会触发`iconv()`函数的漏洞，从而实现任意文件读取。该POC针对WordPress环境，利用其`upload_image_from_url`功能，通过可控的URL参数和构造的过滤器链，读取服务器上的任意文件。 

**有效性：**
根据漏洞描述和提供的利用代码，该漏洞是可利用的。Ambionics网站上的文章 (webpage 4, and links inside CVE details) 以及提供的POC表明此漏洞可以通过精心构造的输入触发。

**投毒风险：**
检查`arbitrary-file-read.py`脚本，未发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造HTTP请求，利用`wrapwrap`生成的链，发送给目标服务器，并处理响应。脚本的目的是利用漏洞读取文件内容，没有发现任何主动植入后门或执行恶意操作的迹象。代码从`chain.txt`读取filter chain，并将其插入到POST请求中，这部分是与wrapwrap工具协同工作以利用漏洞。检查README.md文件，描述了如何使用POC和wrapwrap工具，没有发现任何可疑之处。因此，投毒风险较低。

**利用方式：**
1.  **目标确认:** 确认目标系统使用受影响的glibc版本（< 2.40）并且存在可以利用的字符集转换点。
2.  **构造Payload:** 使用wrapwrap工具，生成包含特定PHP filter chain的`chain.txt`文件，该filter chain可以触发iconv()函数的缓冲区溢出漏洞，目标是读取任意文件。
3.  **URL构造:** 攻击者需要找到一个接受URL作为参数的接口，例如WordPress的`upload_image_from_url`功能。
4.  **发送请求:** 攻击者将构造的包含恶意filter chain的URL发送给目标服务器。
5.  **触发漏洞:**  服务器的iconv()函数在处理字符集转换时发生缓冲区溢出。
6.  **任意文件读取:**  利用缓冲区溢出漏洞，读取服务器上的任意文件内容。
7.  **移除Prefix/Suffix:** 可以移除读取文件的前缀或后缀，方便查看文件内容。
8.  **结果获取:**  攻击者从服务器的响应中获取读取的文件内容。

此利用方式依赖于目标系统存在特定的字符集转换操作，并且攻击者能够控制输入到iconv()函数的参数。提供的代码专门针对WordPress环境，展示了如何利用其文件上传功能触发漏洞，读取服务器上的敏感文件。

**项目地址:** [4wayhandshake/CVE-2024-2961](https://github.com/4wayhandshake/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #2

**来源**: [CVE-2024-2961-absolutedesignltd_iconvfix.md](../2024/CVE-2024-2961-absolutedesignltd_iconvfix.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或覆盖相邻变量，甚至远程代码执行（根据搜索结果）

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标系统glibc版本低于2.40，字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 漏洞是 glibc 中 iconv() 函数在处理 ISO-2022-CN-EXT 字符集转换时存在的缓冲区溢出漏洞。具体来说，当 iconv() 将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会溢出输出缓冲区最多 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量。搜索结果表明该漏洞可能被利用于远程代码执行。

**漏洞利用方式：**

1.  **触发条件：**  利用iconv函数进行字符集转换，源字符集未知，目标字符集需要指定为ISO-2022-CN-EXT，且glibc版本低于2.40。
2.  **溢出：**  构造特定的输入字符串，当 iconv() 函数尝试将其转换为 ISO-2022-CN-EXT 时，导致输出缓冲区溢出 4 个字节。
3.  **利用：**  通过控制溢出的内容，可以覆盖相邻的变量，或者改变程序的执行流程，最终达到远程代码执行的目的。

**POC 代码分析：**

*   `iconvfix.sh` 脚本首先从 sansec.io 下载 `cve-2024-2961.c` 文件，然后编译并运行它。`cve-2024-2961.c` 应该是一个用于检测系统是否受 CVE-2024-2961 漏洞影响的程序。
*   如果检测到系统是易受攻击的，脚本会备份 `/usr/lib64/gconv/gconv-modules` 文件，然后注释掉该文件中与 ISO-2022-CN-EXT 相关的行。这样做可以禁用 ISO-2022-CN-EXT 字符集，从而缓解该漏洞。
*   `iconvconfig` 命令用于重建 iconv 的配置缓存。
*   脚本会再次运行漏洞检测程序，以确认补丁是否成功应用。

**有效性：**

提供的 `iconvfix.sh` 脚本通过注释掉 `/usr/lib64/gconv/gconv-modules` 文件中与 `ISO-2022-CN-EXT` 相关的行来缓解漏洞。这种方法能够阻止程序使用有漏洞的字符集转换，从而达到修复漏洞的效果。脚本的有效性依赖于系统是CentOS 7。

**投毒风险分析：**

*   脚本的主要操作是下载并执行来自 `sansec.io` 的代码。这意味着脚本的安全性取决于 `sansec.io` 的可信度。如果 `sansec.io` 被攻破或者提供恶意代码，那么执行该脚本的系统也会受到威胁。 *   脚本会修改 `/usr/lib64/gconv/gconv-modules` 文件，如果修改过程出现错误，可能会导致字符集转换出现问题。 *   尽管如此，代码本身没有明显的恶意行为，脚本意图在于修补漏洞，而非植入后门。投毒风险主要在于外部依赖 `sansec.io`，因此投毒风险相对较低。

**风险比例：** 下载外部脚本存在潜在风险，但是该脚本的内容更多的是修复行为，所以判断投毒风险为10%。

**项目地址:** [absolutedesignltd/iconvfix](https://github.com/absolutedesignltd/iconvfix)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #3

**来源**: [CVE-2024-2961-ambionics_cnext-exploits.md](../2024/CVE-2024-2961-ambionics_cnext-exploits.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务、信息泄露或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，且应用程序调用了iconv()函数，并转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 是 glibc iconv() 函数中的一个缓冲区溢出漏洞。该漏洞存在于glibc 2.39及更早版本中，当使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，可能导致输出缓冲区溢出，最多溢出 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量，进而可能被利用执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可利用的POC。提供的POC代码是一个名为`blind-cnext-exploit.py`的Python脚本，它利用了该漏洞实现了在PHP环境下的盲文件读取和远程代码执行。`README.md`文件提供了更详细的漏洞信息和利用方法的说明。

**投毒风险分析：**

分析`blind-cnext-exploit.py`的内容。代码结构相对复杂，涉及PHP filter chain的利用，但整体框架和逻辑比较清晰。主要的风险点在于`Remote`类，它负责与目标服务器交互并发送payload，如果`Remote`类中的代码被修改为恶意代码，例如在成功利用后执行额外的恶意操作，则存在投毒风险。但是，在对提供的代码进行分析后，并未发现明显的恶意行为。

`requirements.txt`文件需要安装的依赖库也需要进行检查，是否存在引入恶意库的可能。
综合判断，投毒风险较低，大约为10%。主要风险集中在`Remote`类的具体实现和`requirements.txt`依赖库。

**利用方式：**

该漏洞的利用方式如下：

1.  **触发漏洞：**  利用iconv()函数将特定的字符串转换为ISO-2022-CN-EXT字符集，触发缓冲区溢出。
2.  **盲文件读取：**  利用PHP filter chain技术，结合iconv()的漏洞，实现在目标服务器上的盲文件读取。
3.  **信息泄露：**  读取目标服务器上的敏感文件，例如PHP的配置文件、源代码等。
4.  **远程代码执行：**  通过文件读取，获取关键信息，例如libc地址、堆地址等，然后构造特定的payload，覆盖关键数据，最终实现远程代码执行。

提供的POC代码主要针对PHP环境，通过盲文件读取实现RCE。


**项目地址:** [ambionics/cnext-exploits](https://github.com/ambionics/cnext-exploits)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #4

**来源**: [CVE-2024-2961-exfil0_test_iconv.md](../2024/CVE-2024-2961-exfil0_test_iconv.md)

## CVE-2024-2961

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、覆盖相邻变量甚至远程代码执行。

**影响版本:** < 2.40

**利用条件:** 目标系统使用glibc版本低于2.40，并且程序调用了iconv()函数进行字符集转换，特别是转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数存在的一个缓冲区溢出漏洞。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能发生最多4个字节的溢出。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，此漏洞被认为是有效的。漏洞库和搜索结果中都明确指出iconv()函数在特定条件下会发生缓冲区溢出。提供的POC代码尝试触发该漏洞，通过将字符串转换为ISO-2022-CN-EXT字符集来测试溢出。

**投毒风险：** 提供的代码仓库中没有发现明显的投毒迹象。`README.md`文件描述了漏洞的利用方法，并提供了编译和运行POC的步骤。`test_iconv.c`文件是简单的C代码，用于调用iconv()函数并尝试触发漏洞。代码本身没有包含任何恶意或隐藏的功能。因此，投毒风险评估为0%。

**利用方式：**

1.  **触发漏洞：** 攻击者需要控制iconv()函数的输入和输出缓冲区，并且指定目标字符集为ISO-2022-CN-EXT。攻击者需要输入精心构造的字符串。
2.  **溢出利用：** 由于溢出只有4个字节，通常无法直接实现任意代码执行。然而，结合其他技术（例如堆利用）可能能够利用此漏洞来覆盖关键数据结构，例如堆元数据或者函数指针。
3.  **远程代码执行(RCE)：**  根据搜索结果，特别是RedHat的描述，该漏洞可能允许攻击者通过构造恶意字符序列触发越界写入并执行远程代码。Ambionics的文章也深入探讨了利用此漏洞实现RCE的可能性，特别是在PHP环境中，通过修改free list 指针，从而实现任意写。

**总结：**

CVE-2024-2961是一个缓冲区溢出漏洞，虽然溢出量较小，但结合其他技术，攻击者可以利用此漏洞实现程序崩溃，变量覆盖，甚至远程代码执行。提供的POC代码验证了该漏洞的存在，代码本身没有发现投毒风险。

**项目地址:** [exfil0/test_iconv](https://github.com/exfil0/test_iconv)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #5

**来源**: [CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md](../2024/CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、任意代码执行或信息泄露

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并调用iconv()函数进行ISO-2022-CN-EXT字符集转换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中。当将字符串转换为 ISO-2022-CN-EXT 字符集时，该函数可能导致输出缓冲区溢出，最多溢出 4 个字节。攻击者可以利用此漏洞通过特制的字符序列触发越界写入，从而导致应用程序崩溃，覆盖相邻变量或执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此漏洞利用 **有效**。漏洞库信息明确指出 iconv() 函数存在缓冲区溢出，搜索引擎结果也佐证了漏洞的存在，并提及了远程代码执行的可能性。提供的 Python 脚本 (exp.py) 尝试利用该漏洞，通过构造特定的输入，触发堆溢出，并最终尝试执行任意代码。Ambionics 的博客文章 (由搜索结果中的网页 4 指出) 提供了更详细的漏洞分析和利用方法，进一步确认了漏洞的可利用性。

**投毒风险评估：**
对提供的 exp.py 脚本进行分析：

*   **依赖库：** 脚本依赖 `pwn`, `requests` (通过`ten` 模块，该模块可能封装了`requests`) 和 `zlib` 等库。这些库本身可能存在安全风险，但属于常用库，风险较低。
*   **功能：** 脚本的主要功能是从远程服务器下载文件，读取内存映射，计算堆地址，然后构造特定的输入数据，触发漏洞。脚本包含很多与堆操作相关的代码,例如计算地址和chunk size。整体代码复杂，难以完全确定是否存在后门。
*   **可疑点：** 脚本使用了 `ten` 这个模块，这有可能是一个定制的模块，其中可能存在未知的恶意代码。脚本中包含了多个压缩和分块的操作，用于构造特定的攻击载荷，这些操作增加了代码的复杂性，也增加了隐藏恶意代码的可能性。
    `ADDR_EFREE = LIBC.symbols["__libc_system"]`这行代码使用了 system 函数，如果能控制传递给 system 函数的参数，就可以执行任意命令。在exp.py的剩余部分代码中，代码是不完整的，难以确认最终传递给system函数的参数。 

综合评估，该 POC 存在一定的投毒风险，大约为 **10%**。风险主要来自于 `ten` 模块的未知风险和利用 `system` 函数执行命令的可能性。

**利用方式分析：**

1.  **漏洞触发：** 漏洞利用首先需要触发 `iconv()` 函数，并将易受攻击的字符集作为目标。
2.  **内存布局：** 攻击者需要确定目标系统上的内存布局，特别是堆地址和 libc 地址。利用代码通过读取 `/proc/self/maps` 来获取内存区域信息，然后计算堆和 libc 的基地址。
3.  **堆溢出：** 攻击者通过构造特定的输入，利用缓冲区溢出覆盖堆上的元数据。提供的代码使用了 `chunked_chunk` 和 `compressed_bucket` 函数来创建包含特定大小和内容的 chunked data，这些chunked data会触发堆溢出。
4.  **任意代码执行：** 成功触发堆溢出后，攻击者可以覆盖关键内存区域，例如函数指针或 GOT 表项，以便在程序执行过程中劫持控制流。利用代码试图覆盖 `__libc_system` 函数，以便执行任意命令。具体而言，攻击者会覆盖free list bin指针指向伪造的chunk，然后通过malloc操作来操纵内存，从而达到任意写的效果，最终劫持控制流，执行任意代码（调用 `system` 函数）。

**项目地址:** [kjdfklha/CVE-2024-2961_poc](https://github.com/kjdfklha/CVE-2024-2961_poc)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #6

**来源**: [CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md](../2024/CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md)

## CVE-2024-2961-glibc-iconv 缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量，在特定情况下可能导致远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要存在使用 iconv 函数，并且进行到 ISO-2022-CN-EXT 字符集的转换。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中，当将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会导致最多 4 字节的输出缓冲区溢出。该漏洞影响 2.39 及更早版本。从提供的漏洞利用代码来看，该脚本利用 PHP 的 filter chain 和 iconv 函数处理字符编码转换的缺陷，实现任意文件读取。脚本首先创建一个包含一系列 iconv 转换的 PHP 过滤器链 payload，该 payload 用于读取目标服务器上的任意文件。然后，脚本通过模拟图像上传，将 payload 隐藏在 POST 请求中，发送到目标服务器的 admin-ajax.php 端点。服务器处理请求后，脚本下载生成的文件，并提取显示目标文件的内容。

**有效性：**
根据CVE描述和搜索结果以及提供的漏洞利用代码，此漏洞利用的有效性较高。CISA ADP 将其标记为“poc”，且存在利用的技术可行性。

**投毒风险：**
提供的代码主要包含一个 Python 脚本 (lfi.py) 和一个 README.md 文件。Python 脚本的功能是利用 CVE-2024-2961 漏洞读取远程文件。检查脚本发现其主要是构造恶意的字符转换，没有明显的恶意代码或者后门。脚本依赖于特定的目标 URL 和请求头，这些信息需要在实际使用前进行配置。脚本本身较为直接，没有发现隐藏的投毒代码。

**利用方式：**
利用方式是通过构造特定的 PHP 过滤器链，借助 iconv 函数在字符集转换过程中触发缓冲区溢出，从而读取服务器上的任意文件。


**项目地址:** [kyotozx/CVE-2024-2961-Remote-File-Read](https://github.com/kyotozx/CVE-2024-2961-Remote-File-Read)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #7

**来源**: [CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md](../2024/CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或任意代码执行

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行ISO-2022-CN-EXT字符集转换，并且输出缓冲区大小可控。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数的一个缓冲区溢出漏洞。当使用iconv()将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能会发生最多4字节的溢出。攻击者可以通过构造特定的输入字符串来触发此漏洞，导致程序崩溃或覆盖相邻的变量，甚至执行任意代码。

**有效性评估：**
根据CVE信息和搜索结果，该漏洞已经公开披露，并且存在可利用的POC。提供的修复脚本通过从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行来缓解该漏洞，禁用存在漏洞的字符集转换。 因此，修复脚本本身表明该漏洞是可利用的，虽然提供的脚本仅仅是缓解，而不是直接的exp.

**投毒风险评估：**
提供的`fix.sh`脚本的主要功能是检测系统上是否存在受漏洞影响的glibc版本，并尝试通过修改iconv的配置文件来缓解该漏洞。脚本首先检查`/usr/lib/x86_64-linux-gnu/gconv`目录是否存在，然后检查ldd版本是否包含GLIBC，并检查`iconv -l`命令的输出是否包含'CN-?EXT'。如果以上检查都通过，脚本会尝试使用`grep`命令从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行，并将修改后的内容保存到`.new`文件中，最后使用`mv`命令覆盖原始文件。脚本的最后运行`iconvconfig`。

该脚本的目的是缓解漏洞，而不是利用漏洞。没有发现任何恶意代码或隐藏的后门。因此，投毒风险可以认为是0%。

**利用方式：**
1.  **触发漏洞：** 通过调用iconv()函数，并将一个精心构造的字符串从一种字符集转换为ISO-2022-CN-EXT字符集。
2.  **控制溢出：**  控制输入字符串和输出缓冲区的大小，确保溢出发生，并且覆盖到目标内存区域。
3.  **代码执行 (如果可能)：** 如果溢出覆盖了函数返回地址或其他关键数据，攻击者可以控制程序的执行流程，最终实现任意代码执行。

漏洞利用难度取决于具体的环境和目标程序。在某些情况下，可能需要绕过各种安全机制，如地址空间布局随机化（ASLR）和数据执行保护（DEP）。

**项目地址:** [mattaperkins/FIX-CVE-2024-2961](https://github.com/mattaperkins/FIX-CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #8

**来源**: [CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md](../2024/CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并且存在可利用的iconv()函数调用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用`iconv()`函数将字符串转换为ISO-2022-CN-EXT字符集时，可能导致输出缓冲区溢出最多4个字节。

**有效性评估：**

根据漏洞信息和搜索引擎结果，此漏洞存在已知的PoC。PoC代码利用了PHP的`php://filter`流包装器以及一系列的`convert.iconv.*`过滤器链，通过精心构造的输入，触发glibc的iconv函数进行字符集转换，最终造成缓冲区溢出。利用方式较为复杂，依赖于PHP环境和特定的配置。

根据搜索引擎的结果发现，存在远程代码执行的可能性，结合给出的EXP代码来看，EXP中的利用是通过构造特定的`convert.iconv`链条最终溢出达到读取文件内容或者写入的目的。

**投毒风险评估：**

提供的PoC代码主要通过HTTP请求发送payload，并下载`/proc/self/maps`和libc文件。虽然PoC中包含了一些base64编码和解码操作，以及`convert.iconv` 链条，但整体逻辑看起来是为了利用漏洞，没有明显的恶意代码，但仍然存在很小的风险。

风险点在于：

1.  **依赖外部资源：** PoC可能需要下载远程文件（libc），攻击者可以替换这些文件为恶意文件。
2.  **命令执行：** PoC允许指定要执行的命令，如果目标系统配置不当，可能导致恶意命令执行。
3.  **未知的依赖项风险：** PoC可能依赖于未知的或未公开的第三方库，这些库可能存在安全漏洞，或者被攻击者篡改。

综合评估，PoC代码存在一定的投毒风险，但概率较低(5%)，需要仔细审计代码，并确保使用的外部资源是可信的。

**利用方式：**

1.  **目标识别：** 确定目标系统使用的glibc版本低于2.40，并且存在iconv()函数调用。
2.  **构造Payload：**  使用`php://filter`流包装器和一系列的`convert.iconv.*`过滤器链构造恶意的payload，触发缓冲区溢出。
3.  **信息泄露/代码执行：** 利用溢出覆盖相邻的变量或函数指针，从而实现信息泄露或远程代码执行。

**项目地址:** [regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-](https://github.com/regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #9

**来源**: [CVE-2024-2961-rvizx_CVE-2024-2961.md](../2024/CVE-2024-2961-rvizx_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，并且程序使用iconv函数转换到ISO-2022-CN-EXT字符集

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961 存在于 GNU C 库 (glibc) 的 iconv() 函数中。当应用程序使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果 glibc 版本低于 2.40，则可能发生缓冲区溢出，溢出量最多为 4 字节。这可能导致应用程序崩溃或覆盖相邻变量，攻击者可能利用此漏洞执行远程代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且存在PoC。提供的脚本 `fix.sh` 并非直接的利用代码，而是用于缓解该漏洞的脚本。它通过禁用有问题的字符集来阻止漏洞被触发，因此该脚本本身不是PoC，但验证了漏洞的可利用性。

**投毒风险：**

分析 `fix.sh` 脚本，它主要执行以下操作：

1.  检查系统是否存在受影响的字符集。
2.  查找 `gconv-modules-extra.conf` 文件。
3.  禁用 `gconv-modules-extra.conf` 中与 `ISO-2022-CN-EXT` 相关的编码。
4.  重新生成 gconv 模块缓存。
5.  验证缓解措施是否成功。

脚本中潜在的投毒点可能在于：

*   在禁用编码的部分，`sed` 命令可能被修改为删除其他重要的字符集，导致应用程序无法正常处理某些字符，虽然可能性不大，考虑到这个脚本的目的是缓解漏洞，恶意修改 `sed` 命令会适得其反，更容易被检测到。 *   替换 `gconv-modules-extra.conf` 或者注入恶意内容，导致系统无法正常工作。但是会影响全局导致应用异常。

总体而言，该脚本的风险较低，因为其主要功能是禁用特定的字符集，而不是执行任意代码。考虑到作者的信息和脚本内容，可以初步判断存在恶意投毒的可能性较低，估算投毒风险为 5%。

**利用方式：**

漏洞的利用方式是：

1.  攻击者需要找到一个应用程序，该应用程序使用 glibc 的 iconv() 函数进行字符集转换。
2.  应用程序必须使用 iconv() 函数将输入转换为 ISO-2022-CN-EXT 字符集。
3.  攻击者构造恶意的字符串，当该字符串被 iconv() 函数转换时，会导致输出缓冲区溢出。
4.  如果成功利用，攻击者可以控制程序的执行流程，甚至执行任意代码。具体利用效果取决于程序内存布局以及溢出造成的破坏。

**项目地址:** [rvizx/CVE-2024-2961](https://github.com/rvizx/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #10

**来源**: [CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md](../2024/CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md)

# CVE-2024-2961

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-2961-4wayhandshake_CVE-2024-2961.md](../2024/CVE-2024-2961-4wayhandshake_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，可能会发生最多4字节的输出缓冲区溢出。攻击者可以利用此漏洞导致应用程序崩溃或覆盖相邻的变量。根据提供的漏洞利用代码，该POC利用了`wrapwrap`工具来构造特定的PHP过滤器链，该过滤器链会触发`iconv()`函数的漏洞，从而实现任意文件读取。该POC针对WordPress环境，利用其`upload_image_from_url`功能，通过可控的URL参数和构造的过滤器链，读取服务器上的任意文件。 

**有效性：**
根据漏洞描述和提供的利用代码，该漏洞是可利用的。Ambionics网站上的文章 (webpage 4, and links inside CVE details) 以及提供的POC表明此漏洞可以通过精心构造的输入触发。

**投毒风险：**
检查`arbitrary-file-read.py`脚本，未发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造HTTP请求，利用`wrapwrap`生成的链，发送给目标服务器，并处理响应。脚本的目的是利用漏洞读取文件内容，没有发现任何主动植入后门或执行恶意操作的迹象。代码从`chain.txt`读取filter chain，并将其插入到POST请求中，这部分是与wrapwrap工具协同工作以利用漏洞。检查README.md文件，描述了如何使用POC和wrapwrap工具，没有发现任何可疑之处。因此，投毒风险较低。

**利用方式：**
1.  **目标确认:** 确认目标系统使用受影响的glibc版本（< 2.40）并且存在可以利用的字符集转换点。
2.  **构造Payload:** 使用wrapwrap工具，生成包含特定PHP filter chain的`chain.txt`文件，该filter chain可以触发iconv()函数的缓冲区溢出漏洞，目标是读取任意文件。
3.  **URL构造:** 攻击者需要找到一个接受URL作为参数的接口，例如WordPress的`upload_image_from_url`功能。
4.  **发送请求:** 攻击者将构造的包含恶意filter chain的URL发送给目标服务器。
5.  **触发漏洞:**  服务器的iconv()函数在处理字符集转换时发生缓冲区溢出。
6.  **任意文件读取:**  利用缓冲区溢出漏洞，读取服务器上的任意文件内容。
7.  **移除Prefix/Suffix:** 可以移除读取文件的前缀或后缀，方便查看文件内容。
8.  **结果获取:**  攻击者从服务器的响应中获取读取的文件内容。

此利用方式依赖于目标系统存在特定的字符集转换操作，并且攻击者能够控制输入到iconv()函数的参数。提供的代码专门针对WordPress环境，展示了如何利用其文件上传功能触发漏洞，读取服务器上的敏感文件。

**项目地址:** [4wayhandshake/CVE-2024-2961](https://github.com/4wayhandshake/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #2

**来源**: [CVE-2024-2961-absolutedesignltd_iconvfix.md](../2024/CVE-2024-2961-absolutedesignltd_iconvfix.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或覆盖相邻变量，甚至远程代码执行（根据搜索结果）

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标系统glibc版本低于2.40，字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 漏洞是 glibc 中 iconv() 函数在处理 ISO-2022-CN-EXT 字符集转换时存在的缓冲区溢出漏洞。具体来说，当 iconv() 将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会溢出输出缓冲区最多 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量。搜索结果表明该漏洞可能被利用于远程代码执行。

**漏洞利用方式：**

1.  **触发条件：**  利用iconv函数进行字符集转换，源字符集未知，目标字符集需要指定为ISO-2022-CN-EXT，且glibc版本低于2.40。
2.  **溢出：**  构造特定的输入字符串，当 iconv() 函数尝试将其转换为 ISO-2022-CN-EXT 时，导致输出缓冲区溢出 4 个字节。
3.  **利用：**  通过控制溢出的内容，可以覆盖相邻的变量，或者改变程序的执行流程，最终达到远程代码执行的目的。

**POC 代码分析：**

*   `iconvfix.sh` 脚本首先从 sansec.io 下载 `cve-2024-2961.c` 文件，然后编译并运行它。`cve-2024-2961.c` 应该是一个用于检测系统是否受 CVE-2024-2961 漏洞影响的程序。
*   如果检测到系统是易受攻击的，脚本会备份 `/usr/lib64/gconv/gconv-modules` 文件，然后注释掉该文件中与 ISO-2022-CN-EXT 相关的行。这样做可以禁用 ISO-2022-CN-EXT 字符集，从而缓解该漏洞。
*   `iconvconfig` 命令用于重建 iconv 的配置缓存。
*   脚本会再次运行漏洞检测程序，以确认补丁是否成功应用。

**有效性：**

提供的 `iconvfix.sh` 脚本通过注释掉 `/usr/lib64/gconv/gconv-modules` 文件中与 `ISO-2022-CN-EXT` 相关的行来缓解漏洞。这种方法能够阻止程序使用有漏洞的字符集转换，从而达到修复漏洞的效果。脚本的有效性依赖于系统是CentOS 7。

**投毒风险分析：**

*   脚本的主要操作是下载并执行来自 `sansec.io` 的代码。这意味着脚本的安全性取决于 `sansec.io` 的可信度。如果 `sansec.io` 被攻破或者提供恶意代码，那么执行该脚本的系统也会受到威胁。 *   脚本会修改 `/usr/lib64/gconv/gconv-modules` 文件，如果修改过程出现错误，可能会导致字符集转换出现问题。 *   尽管如此，代码本身没有明显的恶意行为，脚本意图在于修补漏洞，而非植入后门。投毒风险主要在于外部依赖 `sansec.io`，因此投毒风险相对较低。

**风险比例：** 下载外部脚本存在潜在风险，但是该脚本的内容更多的是修复行为，所以判断投毒风险为10%。

**项目地址:** [absolutedesignltd/iconvfix](https://github.com/absolutedesignltd/iconvfix)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #3

**来源**: [CVE-2024-2961-ambionics_cnext-exploits.md](../2024/CVE-2024-2961-ambionics_cnext-exploits.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务、信息泄露或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，且应用程序调用了iconv()函数，并转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 是 glibc iconv() 函数中的一个缓冲区溢出漏洞。该漏洞存在于glibc 2.39及更早版本中，当使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，可能导致输出缓冲区溢出，最多溢出 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量，进而可能被利用执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可利用的POC。提供的POC代码是一个名为`blind-cnext-exploit.py`的Python脚本，它利用了该漏洞实现了在PHP环境下的盲文件读取和远程代码执行。`README.md`文件提供了更详细的漏洞信息和利用方法的说明。

**投毒风险分析：**

分析`blind-cnext-exploit.py`的内容。代码结构相对复杂，涉及PHP filter chain的利用，但整体框架和逻辑比较清晰。主要的风险点在于`Remote`类，它负责与目标服务器交互并发送payload，如果`Remote`类中的代码被修改为恶意代码，例如在成功利用后执行额外的恶意操作，则存在投毒风险。但是，在对提供的代码进行分析后，并未发现明显的恶意行为。

`requirements.txt`文件需要安装的依赖库也需要进行检查，是否存在引入恶意库的可能。
综合判断，投毒风险较低，大约为10%。主要风险集中在`Remote`类的具体实现和`requirements.txt`依赖库。

**利用方式：**

该漏洞的利用方式如下：

1.  **触发漏洞：**  利用iconv()函数将特定的字符串转换为ISO-2022-CN-EXT字符集，触发缓冲区溢出。
2.  **盲文件读取：**  利用PHP filter chain技术，结合iconv()的漏洞，实现在目标服务器上的盲文件读取。
3.  **信息泄露：**  读取目标服务器上的敏感文件，例如PHP的配置文件、源代码等。
4.  **远程代码执行：**  通过文件读取，获取关键信息，例如libc地址、堆地址等，然后构造特定的payload，覆盖关键数据，最终实现远程代码执行。

提供的POC代码主要针对PHP环境，通过盲文件读取实现RCE。


**项目地址:** [ambionics/cnext-exploits](https://github.com/ambionics/cnext-exploits)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #4

**来源**: [CVE-2024-2961-exfil0_test_iconv.md](../2024/CVE-2024-2961-exfil0_test_iconv.md)

## CVE-2024-2961

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、覆盖相邻变量甚至远程代码执行。

**影响版本:** < 2.40

**利用条件:** 目标系统使用glibc版本低于2.40，并且程序调用了iconv()函数进行字符集转换，特别是转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数存在的一个缓冲区溢出漏洞。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能发生最多4个字节的溢出。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，此漏洞被认为是有效的。漏洞库和搜索结果中都明确指出iconv()函数在特定条件下会发生缓冲区溢出。提供的POC代码尝试触发该漏洞，通过将字符串转换为ISO-2022-CN-EXT字符集来测试溢出。

**投毒风险：** 提供的代码仓库中没有发现明显的投毒迹象。`README.md`文件描述了漏洞的利用方法，并提供了编译和运行POC的步骤。`test_iconv.c`文件是简单的C代码，用于调用iconv()函数并尝试触发漏洞。代码本身没有包含任何恶意或隐藏的功能。因此，投毒风险评估为0%。

**利用方式：**

1.  **触发漏洞：** 攻击者需要控制iconv()函数的输入和输出缓冲区，并且指定目标字符集为ISO-2022-CN-EXT。攻击者需要输入精心构造的字符串。
2.  **溢出利用：** 由于溢出只有4个字节，通常无法直接实现任意代码执行。然而，结合其他技术（例如堆利用）可能能够利用此漏洞来覆盖关键数据结构，例如堆元数据或者函数指针。
3.  **远程代码执行(RCE)：**  根据搜索结果，特别是RedHat的描述，该漏洞可能允许攻击者通过构造恶意字符序列触发越界写入并执行远程代码。Ambionics的文章也深入探讨了利用此漏洞实现RCE的可能性，特别是在PHP环境中，通过修改free list 指针，从而实现任意写。

**总结：**

CVE-2024-2961是一个缓冲区溢出漏洞，虽然溢出量较小，但结合其他技术，攻击者可以利用此漏洞实现程序崩溃，变量覆盖，甚至远程代码执行。提供的POC代码验证了该漏洞的存在，代码本身没有发现投毒风险。

**项目地址:** [exfil0/test_iconv](https://github.com/exfil0/test_iconv)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #5

**来源**: [CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md](../2024/CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、任意代码执行或信息泄露

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并调用iconv()函数进行ISO-2022-CN-EXT字符集转换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中。当将字符串转换为 ISO-2022-CN-EXT 字符集时，该函数可能导致输出缓冲区溢出，最多溢出 4 个字节。攻击者可以利用此漏洞通过特制的字符序列触发越界写入，从而导致应用程序崩溃，覆盖相邻变量或执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此漏洞利用 **有效**。漏洞库信息明确指出 iconv() 函数存在缓冲区溢出，搜索引擎结果也佐证了漏洞的存在，并提及了远程代码执行的可能性。提供的 Python 脚本 (exp.py) 尝试利用该漏洞，通过构造特定的输入，触发堆溢出，并最终尝试执行任意代码。Ambionics 的博客文章 (由搜索结果中的网页 4 指出) 提供了更详细的漏洞分析和利用方法，进一步确认了漏洞的可利用性。

**投毒风险评估：**
对提供的 exp.py 脚本进行分析：

*   **依赖库：** 脚本依赖 `pwn`, `requests` (通过`ten` 模块，该模块可能封装了`requests`) 和 `zlib` 等库。这些库本身可能存在安全风险，但属于常用库，风险较低。
*   **功能：** 脚本的主要功能是从远程服务器下载文件，读取内存映射，计算堆地址，然后构造特定的输入数据，触发漏洞。脚本包含很多与堆操作相关的代码,例如计算地址和chunk size。整体代码复杂，难以完全确定是否存在后门。
*   **可疑点：** 脚本使用了 `ten` 这个模块，这有可能是一个定制的模块，其中可能存在未知的恶意代码。脚本中包含了多个压缩和分块的操作，用于构造特定的攻击载荷，这些操作增加了代码的复杂性，也增加了隐藏恶意代码的可能性。
    `ADDR_EFREE = LIBC.symbols["__libc_system"]`这行代码使用了 system 函数，如果能控制传递给 system 函数的参数，就可以执行任意命令。在exp.py的剩余部分代码中，代码是不完整的，难以确认最终传递给system函数的参数。 

综合评估，该 POC 存在一定的投毒风险，大约为 **10%**。风险主要来自于 `ten` 模块的未知风险和利用 `system` 函数执行命令的可能性。

**利用方式分析：**

1.  **漏洞触发：** 漏洞利用首先需要触发 `iconv()` 函数，并将易受攻击的字符集作为目标。
2.  **内存布局：** 攻击者需要确定目标系统上的内存布局，特别是堆地址和 libc 地址。利用代码通过读取 `/proc/self/maps` 来获取内存区域信息，然后计算堆和 libc 的基地址。
3.  **堆溢出：** 攻击者通过构造特定的输入，利用缓冲区溢出覆盖堆上的元数据。提供的代码使用了 `chunked_chunk` 和 `compressed_bucket` 函数来创建包含特定大小和内容的 chunked data，这些chunked data会触发堆溢出。
4.  **任意代码执行：** 成功触发堆溢出后，攻击者可以覆盖关键内存区域，例如函数指针或 GOT 表项，以便在程序执行过程中劫持控制流。利用代码试图覆盖 `__libc_system` 函数，以便执行任意命令。具体而言，攻击者会覆盖free list bin指针指向伪造的chunk，然后通过malloc操作来操纵内存，从而达到任意写的效果，最终劫持控制流，执行任意代码（调用 `system` 函数）。

**项目地址:** [kjdfklha/CVE-2024-2961_poc](https://github.com/kjdfklha/CVE-2024-2961_poc)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #6

**来源**: [CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md](../2024/CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md)

## CVE-2024-2961-glibc-iconv 缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量，在特定情况下可能导致远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要存在使用 iconv 函数，并且进行到 ISO-2022-CN-EXT 字符集的转换。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中，当将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会导致最多 4 字节的输出缓冲区溢出。该漏洞影响 2.39 及更早版本。从提供的漏洞利用代码来看，该脚本利用 PHP 的 filter chain 和 iconv 函数处理字符编码转换的缺陷，实现任意文件读取。脚本首先创建一个包含一系列 iconv 转换的 PHP 过滤器链 payload，该 payload 用于读取目标服务器上的任意文件。然后，脚本通过模拟图像上传，将 payload 隐藏在 POST 请求中，发送到目标服务器的 admin-ajax.php 端点。服务器处理请求后，脚本下载生成的文件，并提取显示目标文件的内容。

**有效性：**
根据CVE描述和搜索结果以及提供的漏洞利用代码，此漏洞利用的有效性较高。CISA ADP 将其标记为“poc”，且存在利用的技术可行性。

**投毒风险：**
提供的代码主要包含一个 Python 脚本 (lfi.py) 和一个 README.md 文件。Python 脚本的功能是利用 CVE-2024-2961 漏洞读取远程文件。检查脚本发现其主要是构造恶意的字符转换，没有明显的恶意代码或者后门。脚本依赖于特定的目标 URL 和请求头，这些信息需要在实际使用前进行配置。脚本本身较为直接，没有发现隐藏的投毒代码。

**利用方式：**
利用方式是通过构造特定的 PHP 过滤器链，借助 iconv 函数在字符集转换过程中触发缓冲区溢出，从而读取服务器上的任意文件。


**项目地址:** [kyotozx/CVE-2024-2961-Remote-File-Read](https://github.com/kyotozx/CVE-2024-2961-Remote-File-Read)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #7

**来源**: [CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md](../2024/CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或任意代码执行

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行ISO-2022-CN-EXT字符集转换，并且输出缓冲区大小可控。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数的一个缓冲区溢出漏洞。当使用iconv()将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能会发生最多4字节的溢出。攻击者可以通过构造特定的输入字符串来触发此漏洞，导致程序崩溃或覆盖相邻的变量，甚至执行任意代码。

**有效性评估：**
根据CVE信息和搜索结果，该漏洞已经公开披露，并且存在可利用的POC。提供的修复脚本通过从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行来缓解该漏洞，禁用存在漏洞的字符集转换。 因此，修复脚本本身表明该漏洞是可利用的，虽然提供的脚本仅仅是缓解，而不是直接的exp.

**投毒风险评估：**
提供的`fix.sh`脚本的主要功能是检测系统上是否存在受漏洞影响的glibc版本，并尝试通过修改iconv的配置文件来缓解该漏洞。脚本首先检查`/usr/lib/x86_64-linux-gnu/gconv`目录是否存在，然后检查ldd版本是否包含GLIBC，并检查`iconv -l`命令的输出是否包含'CN-?EXT'。如果以上检查都通过，脚本会尝试使用`grep`命令从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行，并将修改后的内容保存到`.new`文件中，最后使用`mv`命令覆盖原始文件。脚本的最后运行`iconvconfig`。

该脚本的目的是缓解漏洞，而不是利用漏洞。没有发现任何恶意代码或隐藏的后门。因此，投毒风险可以认为是0%。

**利用方式：**
1.  **触发漏洞：** 通过调用iconv()函数，并将一个精心构造的字符串从一种字符集转换为ISO-2022-CN-EXT字符集。
2.  **控制溢出：**  控制输入字符串和输出缓冲区的大小，确保溢出发生，并且覆盖到目标内存区域。
3.  **代码执行 (如果可能)：** 如果溢出覆盖了函数返回地址或其他关键数据，攻击者可以控制程序的执行流程，最终实现任意代码执行。

漏洞利用难度取决于具体的环境和目标程序。在某些情况下，可能需要绕过各种安全机制，如地址空间布局随机化（ASLR）和数据执行保护（DEP）。

**项目地址:** [mattaperkins/FIX-CVE-2024-2961](https://github.com/mattaperkins/FIX-CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #8

**来源**: [CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md](../2024/CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并且存在可利用的iconv()函数调用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用`iconv()`函数将字符串转换为ISO-2022-CN-EXT字符集时，可能导致输出缓冲区溢出最多4个字节。

**有效性评估：**

根据漏洞信息和搜索引擎结果，此漏洞存在已知的PoC。PoC代码利用了PHP的`php://filter`流包装器以及一系列的`convert.iconv.*`过滤器链，通过精心构造的输入，触发glibc的iconv函数进行字符集转换，最终造成缓冲区溢出。利用方式较为复杂，依赖于PHP环境和特定的配置。

根据搜索引擎的结果发现，存在远程代码执行的可能性，结合给出的EXP代码来看，EXP中的利用是通过构造特定的`convert.iconv`链条最终溢出达到读取文件内容或者写入的目的。

**投毒风险评估：**

提供的PoC代码主要通过HTTP请求发送payload，并下载`/proc/self/maps`和libc文件。虽然PoC中包含了一些base64编码和解码操作，以及`convert.iconv` 链条，但整体逻辑看起来是为了利用漏洞，没有明显的恶意代码，但仍然存在很小的风险。

风险点在于：

1.  **依赖外部资源：** PoC可能需要下载远程文件（libc），攻击者可以替换这些文件为恶意文件。
2.  **命令执行：** PoC允许指定要执行的命令，如果目标系统配置不当，可能导致恶意命令执行。
3.  **未知的依赖项风险：** PoC可能依赖于未知的或未公开的第三方库，这些库可能存在安全漏洞，或者被攻击者篡改。

综合评估，PoC代码存在一定的投毒风险，但概率较低(5%)，需要仔细审计代码，并确保使用的外部资源是可信的。

**利用方式：**

1.  **目标识别：** 确定目标系统使用的glibc版本低于2.40，并且存在iconv()函数调用。
2.  **构造Payload：**  使用`php://filter`流包装器和一系列的`convert.iconv.*`过滤器链构造恶意的payload，触发缓冲区溢出。
3.  **信息泄露/代码执行：** 利用溢出覆盖相邻的变量或函数指针，从而实现信息泄露或远程代码执行。

**项目地址:** [regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-](https://github.com/regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #9

**来源**: [CVE-2024-2961-rvizx_CVE-2024-2961.md](../2024/CVE-2024-2961-rvizx_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，并且程序使用iconv函数转换到ISO-2022-CN-EXT字符集

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961 存在于 GNU C 库 (glibc) 的 iconv() 函数中。当应用程序使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果 glibc 版本低于 2.40，则可能发生缓冲区溢出，溢出量最多为 4 字节。这可能导致应用程序崩溃或覆盖相邻变量，攻击者可能利用此漏洞执行远程代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且存在PoC。提供的脚本 `fix.sh` 并非直接的利用代码，而是用于缓解该漏洞的脚本。它通过禁用有问题的字符集来阻止漏洞被触发，因此该脚本本身不是PoC，但验证了漏洞的可利用性。

**投毒风险：**

分析 `fix.sh` 脚本，它主要执行以下操作：

1.  检查系统是否存在受影响的字符集。
2.  查找 `gconv-modules-extra.conf` 文件。
3.  禁用 `gconv-modules-extra.conf` 中与 `ISO-2022-CN-EXT` 相关的编码。
4.  重新生成 gconv 模块缓存。
5.  验证缓解措施是否成功。

脚本中潜在的投毒点可能在于：

*   在禁用编码的部分，`sed` 命令可能被修改为删除其他重要的字符集，导致应用程序无法正常处理某些字符，虽然可能性不大，考虑到这个脚本的目的是缓解漏洞，恶意修改 `sed` 命令会适得其反，更容易被检测到。 *   替换 `gconv-modules-extra.conf` 或者注入恶意内容，导致系统无法正常工作。但是会影响全局导致应用异常。

总体而言，该脚本的风险较低，因为其主要功能是禁用特定的字符集，而不是执行任意代码。考虑到作者的信息和脚本内容，可以初步判断存在恶意投毒的可能性较低，估算投毒风险为 5%。

**利用方式：**

漏洞的利用方式是：

1.  攻击者需要找到一个应用程序，该应用程序使用 glibc 的 iconv() 函数进行字符集转换。
2.  应用程序必须使用 iconv() 函数将输入转换为 ISO-2022-CN-EXT 字符集。
3.  攻击者构造恶意的字符串，当该字符串被 iconv() 函数转换时，会导致输出缓冲区溢出。
4.  如果成功利用，攻击者可以控制程序的执行流程，甚至执行任意代码。具体利用效果取决于程序内存布局以及溢出造成的破坏。

**项目地址:** [rvizx/CVE-2024-2961](https://github.com/rvizx/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #10

**来源**: [CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md](../2024/CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md)

# CVE-2024-2961

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-2961-4wayhandshake_CVE-2024-2961.md](../2024/CVE-2024-2961-4wayhandshake_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，可能会发生最多4字节的输出缓冲区溢出。攻击者可以利用此漏洞导致应用程序崩溃或覆盖相邻的变量。根据提供的漏洞利用代码，该POC利用了`wrapwrap`工具来构造特定的PHP过滤器链，该过滤器链会触发`iconv()`函数的漏洞，从而实现任意文件读取。该POC针对WordPress环境，利用其`upload_image_from_url`功能，通过可控的URL参数和构造的过滤器链，读取服务器上的任意文件。 

**有效性：**
根据漏洞描述和提供的利用代码，该漏洞是可利用的。Ambionics网站上的文章 (webpage 4, and links inside CVE details) 以及提供的POC表明此漏洞可以通过精心构造的输入触发。

**投毒风险：**
检查`arbitrary-file-read.py`脚本，未发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造HTTP请求，利用`wrapwrap`生成的链，发送给目标服务器，并处理响应。脚本的目的是利用漏洞读取文件内容，没有发现任何主动植入后门或执行恶意操作的迹象。代码从`chain.txt`读取filter chain，并将其插入到POST请求中，这部分是与wrapwrap工具协同工作以利用漏洞。检查README.md文件，描述了如何使用POC和wrapwrap工具，没有发现任何可疑之处。因此，投毒风险较低。

**利用方式：**
1.  **目标确认:** 确认目标系统使用受影响的glibc版本（< 2.40）并且存在可以利用的字符集转换点。
2.  **构造Payload:** 使用wrapwrap工具，生成包含特定PHP filter chain的`chain.txt`文件，该filter chain可以触发iconv()函数的缓冲区溢出漏洞，目标是读取任意文件。
3.  **URL构造:** 攻击者需要找到一个接受URL作为参数的接口，例如WordPress的`upload_image_from_url`功能。
4.  **发送请求:** 攻击者将构造的包含恶意filter chain的URL发送给目标服务器。
5.  **触发漏洞:**  服务器的iconv()函数在处理字符集转换时发生缓冲区溢出。
6.  **任意文件读取:**  利用缓冲区溢出漏洞，读取服务器上的任意文件内容。
7.  **移除Prefix/Suffix:** 可以移除读取文件的前缀或后缀，方便查看文件内容。
8.  **结果获取:**  攻击者从服务器的响应中获取读取的文件内容。

此利用方式依赖于目标系统存在特定的字符集转换操作，并且攻击者能够控制输入到iconv()函数的参数。提供的代码专门针对WordPress环境，展示了如何利用其文件上传功能触发漏洞，读取服务器上的敏感文件。

**项目地址:** [4wayhandshake/CVE-2024-2961](https://github.com/4wayhandshake/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #2

**来源**: [CVE-2024-2961-absolutedesignltd_iconvfix.md](../2024/CVE-2024-2961-absolutedesignltd_iconvfix.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或覆盖相邻变量，甚至远程代码执行（根据搜索结果）

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标系统glibc版本低于2.40，字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 漏洞是 glibc 中 iconv() 函数在处理 ISO-2022-CN-EXT 字符集转换时存在的缓冲区溢出漏洞。具体来说，当 iconv() 将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会溢出输出缓冲区最多 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量。搜索结果表明该漏洞可能被利用于远程代码执行。

**漏洞利用方式：**

1.  **触发条件：**  利用iconv函数进行字符集转换，源字符集未知，目标字符集需要指定为ISO-2022-CN-EXT，且glibc版本低于2.40。
2.  **溢出：**  构造特定的输入字符串，当 iconv() 函数尝试将其转换为 ISO-2022-CN-EXT 时，导致输出缓冲区溢出 4 个字节。
3.  **利用：**  通过控制溢出的内容，可以覆盖相邻的变量，或者改变程序的执行流程，最终达到远程代码执行的目的。

**POC 代码分析：**

*   `iconvfix.sh` 脚本首先从 sansec.io 下载 `cve-2024-2961.c` 文件，然后编译并运行它。`cve-2024-2961.c` 应该是一个用于检测系统是否受 CVE-2024-2961 漏洞影响的程序。
*   如果检测到系统是易受攻击的，脚本会备份 `/usr/lib64/gconv/gconv-modules` 文件，然后注释掉该文件中与 ISO-2022-CN-EXT 相关的行。这样做可以禁用 ISO-2022-CN-EXT 字符集，从而缓解该漏洞。
*   `iconvconfig` 命令用于重建 iconv 的配置缓存。
*   脚本会再次运行漏洞检测程序，以确认补丁是否成功应用。

**有效性：**

提供的 `iconvfix.sh` 脚本通过注释掉 `/usr/lib64/gconv/gconv-modules` 文件中与 `ISO-2022-CN-EXT` 相关的行来缓解漏洞。这种方法能够阻止程序使用有漏洞的字符集转换，从而达到修复漏洞的效果。脚本的有效性依赖于系统是CentOS 7。

**投毒风险分析：**

*   脚本的主要操作是下载并执行来自 `sansec.io` 的代码。这意味着脚本的安全性取决于 `sansec.io` 的可信度。如果 `sansec.io` 被攻破或者提供恶意代码，那么执行该脚本的系统也会受到威胁。 *   脚本会修改 `/usr/lib64/gconv/gconv-modules` 文件，如果修改过程出现错误，可能会导致字符集转换出现问题。 *   尽管如此，代码本身没有明显的恶意行为，脚本意图在于修补漏洞，而非植入后门。投毒风险主要在于外部依赖 `sansec.io`，因此投毒风险相对较低。

**风险比例：** 下载外部脚本存在潜在风险，但是该脚本的内容更多的是修复行为，所以判断投毒风险为10%。

**项目地址:** [absolutedesignltd/iconvfix](https://github.com/absolutedesignltd/iconvfix)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #3

**来源**: [CVE-2024-2961-ambionics_cnext-exploits.md](../2024/CVE-2024-2961-ambionics_cnext-exploits.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务、信息泄露或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，且应用程序调用了iconv()函数，并转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 是 glibc iconv() 函数中的一个缓冲区溢出漏洞。该漏洞存在于glibc 2.39及更早版本中，当使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，可能导致输出缓冲区溢出，最多溢出 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量，进而可能被利用执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可利用的POC。提供的POC代码是一个名为`blind-cnext-exploit.py`的Python脚本，它利用了该漏洞实现了在PHP环境下的盲文件读取和远程代码执行。`README.md`文件提供了更详细的漏洞信息和利用方法的说明。

**投毒风险分析：**

分析`blind-cnext-exploit.py`的内容。代码结构相对复杂，涉及PHP filter chain的利用，但整体框架和逻辑比较清晰。主要的风险点在于`Remote`类，它负责与目标服务器交互并发送payload，如果`Remote`类中的代码被修改为恶意代码，例如在成功利用后执行额外的恶意操作，则存在投毒风险。但是，在对提供的代码进行分析后，并未发现明显的恶意行为。

`requirements.txt`文件需要安装的依赖库也需要进行检查，是否存在引入恶意库的可能。
综合判断，投毒风险较低，大约为10%。主要风险集中在`Remote`类的具体实现和`requirements.txt`依赖库。

**利用方式：**

该漏洞的利用方式如下：

1.  **触发漏洞：**  利用iconv()函数将特定的字符串转换为ISO-2022-CN-EXT字符集，触发缓冲区溢出。
2.  **盲文件读取：**  利用PHP filter chain技术，结合iconv()的漏洞，实现在目标服务器上的盲文件读取。
3.  **信息泄露：**  读取目标服务器上的敏感文件，例如PHP的配置文件、源代码等。
4.  **远程代码执行：**  通过文件读取，获取关键信息，例如libc地址、堆地址等，然后构造特定的payload，覆盖关键数据，最终实现远程代码执行。

提供的POC代码主要针对PHP环境，通过盲文件读取实现RCE。


**项目地址:** [ambionics/cnext-exploits](https://github.com/ambionics/cnext-exploits)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #4

**来源**: [CVE-2024-2961-exfil0_test_iconv.md](../2024/CVE-2024-2961-exfil0_test_iconv.md)

## CVE-2024-2961

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、覆盖相邻变量甚至远程代码执行。

**影响版本:** < 2.40

**利用条件:** 目标系统使用glibc版本低于2.40，并且程序调用了iconv()函数进行字符集转换，特别是转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数存在的一个缓冲区溢出漏洞。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能发生最多4个字节的溢出。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，此漏洞被认为是有效的。漏洞库和搜索结果中都明确指出iconv()函数在特定条件下会发生缓冲区溢出。提供的POC代码尝试触发该漏洞，通过将字符串转换为ISO-2022-CN-EXT字符集来测试溢出。

**投毒风险：** 提供的代码仓库中没有发现明显的投毒迹象。`README.md`文件描述了漏洞的利用方法，并提供了编译和运行POC的步骤。`test_iconv.c`文件是简单的C代码，用于调用iconv()函数并尝试触发漏洞。代码本身没有包含任何恶意或隐藏的功能。因此，投毒风险评估为0%。

**利用方式：**

1.  **触发漏洞：** 攻击者需要控制iconv()函数的输入和输出缓冲区，并且指定目标字符集为ISO-2022-CN-EXT。攻击者需要输入精心构造的字符串。
2.  **溢出利用：** 由于溢出只有4个字节，通常无法直接实现任意代码执行。然而，结合其他技术（例如堆利用）可能能够利用此漏洞来覆盖关键数据结构，例如堆元数据或者函数指针。
3.  **远程代码执行(RCE)：**  根据搜索结果，特别是RedHat的描述，该漏洞可能允许攻击者通过构造恶意字符序列触发越界写入并执行远程代码。Ambionics的文章也深入探讨了利用此漏洞实现RCE的可能性，特别是在PHP环境中，通过修改free list 指针，从而实现任意写。

**总结：**

CVE-2024-2961是一个缓冲区溢出漏洞，虽然溢出量较小，但结合其他技术，攻击者可以利用此漏洞实现程序崩溃，变量覆盖，甚至远程代码执行。提供的POC代码验证了该漏洞的存在，代码本身没有发现投毒风险。

**项目地址:** [exfil0/test_iconv](https://github.com/exfil0/test_iconv)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #5

**来源**: [CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md](../2024/CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、任意代码执行或信息泄露

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并调用iconv()函数进行ISO-2022-CN-EXT字符集转换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中。当将字符串转换为 ISO-2022-CN-EXT 字符集时，该函数可能导致输出缓冲区溢出，最多溢出 4 个字节。攻击者可以利用此漏洞通过特制的字符序列触发越界写入，从而导致应用程序崩溃，覆盖相邻变量或执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此漏洞利用 **有效**。漏洞库信息明确指出 iconv() 函数存在缓冲区溢出，搜索引擎结果也佐证了漏洞的存在，并提及了远程代码执行的可能性。提供的 Python 脚本 (exp.py) 尝试利用该漏洞，通过构造特定的输入，触发堆溢出，并最终尝试执行任意代码。Ambionics 的博客文章 (由搜索结果中的网页 4 指出) 提供了更详细的漏洞分析和利用方法，进一步确认了漏洞的可利用性。

**投毒风险评估：**
对提供的 exp.py 脚本进行分析：

*   **依赖库：** 脚本依赖 `pwn`, `requests` (通过`ten` 模块，该模块可能封装了`requests`) 和 `zlib` 等库。这些库本身可能存在安全风险，但属于常用库，风险较低。
*   **功能：** 脚本的主要功能是从远程服务器下载文件，读取内存映射，计算堆地址，然后构造特定的输入数据，触发漏洞。脚本包含很多与堆操作相关的代码,例如计算地址和chunk size。整体代码复杂，难以完全确定是否存在后门。
*   **可疑点：** 脚本使用了 `ten` 这个模块，这有可能是一个定制的模块，其中可能存在未知的恶意代码。脚本中包含了多个压缩和分块的操作，用于构造特定的攻击载荷，这些操作增加了代码的复杂性，也增加了隐藏恶意代码的可能性。
    `ADDR_EFREE = LIBC.symbols["__libc_system"]`这行代码使用了 system 函数，如果能控制传递给 system 函数的参数，就可以执行任意命令。在exp.py的剩余部分代码中，代码是不完整的，难以确认最终传递给system函数的参数。 

综合评估，该 POC 存在一定的投毒风险，大约为 **10%**。风险主要来自于 `ten` 模块的未知风险和利用 `system` 函数执行命令的可能性。

**利用方式分析：**

1.  **漏洞触发：** 漏洞利用首先需要触发 `iconv()` 函数，并将易受攻击的字符集作为目标。
2.  **内存布局：** 攻击者需要确定目标系统上的内存布局，特别是堆地址和 libc 地址。利用代码通过读取 `/proc/self/maps` 来获取内存区域信息，然后计算堆和 libc 的基地址。
3.  **堆溢出：** 攻击者通过构造特定的输入，利用缓冲区溢出覆盖堆上的元数据。提供的代码使用了 `chunked_chunk` 和 `compressed_bucket` 函数来创建包含特定大小和内容的 chunked data，这些chunked data会触发堆溢出。
4.  **任意代码执行：** 成功触发堆溢出后，攻击者可以覆盖关键内存区域，例如函数指针或 GOT 表项，以便在程序执行过程中劫持控制流。利用代码试图覆盖 `__libc_system` 函数，以便执行任意命令。具体而言，攻击者会覆盖free list bin指针指向伪造的chunk，然后通过malloc操作来操纵内存，从而达到任意写的效果，最终劫持控制流，执行任意代码（调用 `system` 函数）。

**项目地址:** [kjdfklha/CVE-2024-2961_poc](https://github.com/kjdfklha/CVE-2024-2961_poc)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #6

**来源**: [CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md](../2024/CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md)

## CVE-2024-2961-glibc-iconv 缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量，在特定情况下可能导致远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要存在使用 iconv 函数，并且进行到 ISO-2022-CN-EXT 字符集的转换。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中，当将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会导致最多 4 字节的输出缓冲区溢出。该漏洞影响 2.39 及更早版本。从提供的漏洞利用代码来看，该脚本利用 PHP 的 filter chain 和 iconv 函数处理字符编码转换的缺陷，实现任意文件读取。脚本首先创建一个包含一系列 iconv 转换的 PHP 过滤器链 payload，该 payload 用于读取目标服务器上的任意文件。然后，脚本通过模拟图像上传，将 payload 隐藏在 POST 请求中，发送到目标服务器的 admin-ajax.php 端点。服务器处理请求后，脚本下载生成的文件，并提取显示目标文件的内容。

**有效性：**
根据CVE描述和搜索结果以及提供的漏洞利用代码，此漏洞利用的有效性较高。CISA ADP 将其标记为“poc”，且存在利用的技术可行性。

**投毒风险：**
提供的代码主要包含一个 Python 脚本 (lfi.py) 和一个 README.md 文件。Python 脚本的功能是利用 CVE-2024-2961 漏洞读取远程文件。检查脚本发现其主要是构造恶意的字符转换，没有明显的恶意代码或者后门。脚本依赖于特定的目标 URL 和请求头，这些信息需要在实际使用前进行配置。脚本本身较为直接，没有发现隐藏的投毒代码。

**利用方式：**
利用方式是通过构造特定的 PHP 过滤器链，借助 iconv 函数在字符集转换过程中触发缓冲区溢出，从而读取服务器上的任意文件。


**项目地址:** [kyotozx/CVE-2024-2961-Remote-File-Read](https://github.com/kyotozx/CVE-2024-2961-Remote-File-Read)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #7

**来源**: [CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md](../2024/CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或任意代码执行

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行ISO-2022-CN-EXT字符集转换，并且输出缓冲区大小可控。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数的一个缓冲区溢出漏洞。当使用iconv()将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能会发生最多4字节的溢出。攻击者可以通过构造特定的输入字符串来触发此漏洞，导致程序崩溃或覆盖相邻的变量，甚至执行任意代码。

**有效性评估：**
根据CVE信息和搜索结果，该漏洞已经公开披露，并且存在可利用的POC。提供的修复脚本通过从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行来缓解该漏洞，禁用存在漏洞的字符集转换。 因此，修复脚本本身表明该漏洞是可利用的，虽然提供的脚本仅仅是缓解，而不是直接的exp.

**投毒风险评估：**
提供的`fix.sh`脚本的主要功能是检测系统上是否存在受漏洞影响的glibc版本，并尝试通过修改iconv的配置文件来缓解该漏洞。脚本首先检查`/usr/lib/x86_64-linux-gnu/gconv`目录是否存在，然后检查ldd版本是否包含GLIBC，并检查`iconv -l`命令的输出是否包含'CN-?EXT'。如果以上检查都通过，脚本会尝试使用`grep`命令从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行，并将修改后的内容保存到`.new`文件中，最后使用`mv`命令覆盖原始文件。脚本的最后运行`iconvconfig`。

该脚本的目的是缓解漏洞，而不是利用漏洞。没有发现任何恶意代码或隐藏的后门。因此，投毒风险可以认为是0%。

**利用方式：**
1.  **触发漏洞：** 通过调用iconv()函数，并将一个精心构造的字符串从一种字符集转换为ISO-2022-CN-EXT字符集。
2.  **控制溢出：**  控制输入字符串和输出缓冲区的大小，确保溢出发生，并且覆盖到目标内存区域。
3.  **代码执行 (如果可能)：** 如果溢出覆盖了函数返回地址或其他关键数据，攻击者可以控制程序的执行流程，最终实现任意代码执行。

漏洞利用难度取决于具体的环境和目标程序。在某些情况下，可能需要绕过各种安全机制，如地址空间布局随机化（ASLR）和数据执行保护（DEP）。

**项目地址:** [mattaperkins/FIX-CVE-2024-2961](https://github.com/mattaperkins/FIX-CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #8

**来源**: [CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md](../2024/CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并且存在可利用的iconv()函数调用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用`iconv()`函数将字符串转换为ISO-2022-CN-EXT字符集时，可能导致输出缓冲区溢出最多4个字节。

**有效性评估：**

根据漏洞信息和搜索引擎结果，此漏洞存在已知的PoC。PoC代码利用了PHP的`php://filter`流包装器以及一系列的`convert.iconv.*`过滤器链，通过精心构造的输入，触发glibc的iconv函数进行字符集转换，最终造成缓冲区溢出。利用方式较为复杂，依赖于PHP环境和特定的配置。

根据搜索引擎的结果发现，存在远程代码执行的可能性，结合给出的EXP代码来看，EXP中的利用是通过构造特定的`convert.iconv`链条最终溢出达到读取文件内容或者写入的目的。

**投毒风险评估：**

提供的PoC代码主要通过HTTP请求发送payload，并下载`/proc/self/maps`和libc文件。虽然PoC中包含了一些base64编码和解码操作，以及`convert.iconv` 链条，但整体逻辑看起来是为了利用漏洞，没有明显的恶意代码，但仍然存在很小的风险。

风险点在于：

1.  **依赖外部资源：** PoC可能需要下载远程文件（libc），攻击者可以替换这些文件为恶意文件。
2.  **命令执行：** PoC允许指定要执行的命令，如果目标系统配置不当，可能导致恶意命令执行。
3.  **未知的依赖项风险：** PoC可能依赖于未知的或未公开的第三方库，这些库可能存在安全漏洞，或者被攻击者篡改。

综合评估，PoC代码存在一定的投毒风险，但概率较低(5%)，需要仔细审计代码，并确保使用的外部资源是可信的。

**利用方式：**

1.  **目标识别：** 确定目标系统使用的glibc版本低于2.40，并且存在iconv()函数调用。
2.  **构造Payload：**  使用`php://filter`流包装器和一系列的`convert.iconv.*`过滤器链构造恶意的payload，触发缓冲区溢出。
3.  **信息泄露/代码执行：** 利用溢出覆盖相邻的变量或函数指针，从而实现信息泄露或远程代码执行。

**项目地址:** [regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-](https://github.com/regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #9

**来源**: [CVE-2024-2961-rvizx_CVE-2024-2961.md](../2024/CVE-2024-2961-rvizx_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，并且程序使用iconv函数转换到ISO-2022-CN-EXT字符集

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961 存在于 GNU C 库 (glibc) 的 iconv() 函数中。当应用程序使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果 glibc 版本低于 2.40，则可能发生缓冲区溢出，溢出量最多为 4 字节。这可能导致应用程序崩溃或覆盖相邻变量，攻击者可能利用此漏洞执行远程代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且存在PoC。提供的脚本 `fix.sh` 并非直接的利用代码，而是用于缓解该漏洞的脚本。它通过禁用有问题的字符集来阻止漏洞被触发，因此该脚本本身不是PoC，但验证了漏洞的可利用性。

**投毒风险：**

分析 `fix.sh` 脚本，它主要执行以下操作：

1.  检查系统是否存在受影响的字符集。
2.  查找 `gconv-modules-extra.conf` 文件。
3.  禁用 `gconv-modules-extra.conf` 中与 `ISO-2022-CN-EXT` 相关的编码。
4.  重新生成 gconv 模块缓存。
5.  验证缓解措施是否成功。

脚本中潜在的投毒点可能在于：

*   在禁用编码的部分，`sed` 命令可能被修改为删除其他重要的字符集，导致应用程序无法正常处理某些字符，虽然可能性不大，考虑到这个脚本的目的是缓解漏洞，恶意修改 `sed` 命令会适得其反，更容易被检测到。 *   替换 `gconv-modules-extra.conf` 或者注入恶意内容，导致系统无法正常工作。但是会影响全局导致应用异常。

总体而言，该脚本的风险较低，因为其主要功能是禁用特定的字符集，而不是执行任意代码。考虑到作者的信息和脚本内容，可以初步判断存在恶意投毒的可能性较低，估算投毒风险为 5%。

**利用方式：**

漏洞的利用方式是：

1.  攻击者需要找到一个应用程序，该应用程序使用 glibc 的 iconv() 函数进行字符集转换。
2.  应用程序必须使用 iconv() 函数将输入转换为 ISO-2022-CN-EXT 字符集。
3.  攻击者构造恶意的字符串，当该字符串被 iconv() 函数转换时，会导致输出缓冲区溢出。
4.  如果成功利用，攻击者可以控制程序的执行流程，甚至执行任意代码。具体利用效果取决于程序内存布局以及溢出造成的破坏。

**项目地址:** [rvizx/CVE-2024-2961](https://github.com/rvizx/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #10

**来源**: [CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md](../2024/CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md)

# CVE-2024-2961

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-2961-4wayhandshake_CVE-2024-2961.md](../2024/CVE-2024-2961-4wayhandshake_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，可能会发生最多4字节的输出缓冲区溢出。攻击者可以利用此漏洞导致应用程序崩溃或覆盖相邻的变量。根据提供的漏洞利用代码，该POC利用了`wrapwrap`工具来构造特定的PHP过滤器链，该过滤器链会触发`iconv()`函数的漏洞，从而实现任意文件读取。该POC针对WordPress环境，利用其`upload_image_from_url`功能，通过可控的URL参数和构造的过滤器链，读取服务器上的任意文件。 

**有效性：**
根据漏洞描述和提供的利用代码，该漏洞是可利用的。Ambionics网站上的文章 (webpage 4, and links inside CVE details) 以及提供的POC表明此漏洞可以通过精心构造的输入触发。

**投毒风险：**
检查`arbitrary-file-read.py`脚本，未发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造HTTP请求，利用`wrapwrap`生成的链，发送给目标服务器，并处理响应。脚本的目的是利用漏洞读取文件内容，没有发现任何主动植入后门或执行恶意操作的迹象。代码从`chain.txt`读取filter chain，并将其插入到POST请求中，这部分是与wrapwrap工具协同工作以利用漏洞。检查README.md文件，描述了如何使用POC和wrapwrap工具，没有发现任何可疑之处。因此，投毒风险较低。

**利用方式：**
1.  **目标确认:** 确认目标系统使用受影响的glibc版本（< 2.40）并且存在可以利用的字符集转换点。
2.  **构造Payload:** 使用wrapwrap工具，生成包含特定PHP filter chain的`chain.txt`文件，该filter chain可以触发iconv()函数的缓冲区溢出漏洞，目标是读取任意文件。
3.  **URL构造:** 攻击者需要找到一个接受URL作为参数的接口，例如WordPress的`upload_image_from_url`功能。
4.  **发送请求:** 攻击者将构造的包含恶意filter chain的URL发送给目标服务器。
5.  **触发漏洞:**  服务器的iconv()函数在处理字符集转换时发生缓冲区溢出。
6.  **任意文件读取:**  利用缓冲区溢出漏洞，读取服务器上的任意文件内容。
7.  **移除Prefix/Suffix:** 可以移除读取文件的前缀或后缀，方便查看文件内容。
8.  **结果获取:**  攻击者从服务器的响应中获取读取的文件内容。

此利用方式依赖于目标系统存在特定的字符集转换操作，并且攻击者能够控制输入到iconv()函数的参数。提供的代码专门针对WordPress环境，展示了如何利用其文件上传功能触发漏洞，读取服务器上的敏感文件。

**项目地址:** [4wayhandshake/CVE-2024-2961](https://github.com/4wayhandshake/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #2

**来源**: [CVE-2024-2961-absolutedesignltd_iconvfix.md](../2024/CVE-2024-2961-absolutedesignltd_iconvfix.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或覆盖相邻变量，甚至远程代码执行（根据搜索结果）

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标系统glibc版本低于2.40，字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 漏洞是 glibc 中 iconv() 函数在处理 ISO-2022-CN-EXT 字符集转换时存在的缓冲区溢出漏洞。具体来说，当 iconv() 将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会溢出输出缓冲区最多 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量。搜索结果表明该漏洞可能被利用于远程代码执行。

**漏洞利用方式：**

1.  **触发条件：**  利用iconv函数进行字符集转换，源字符集未知，目标字符集需要指定为ISO-2022-CN-EXT，且glibc版本低于2.40。
2.  **溢出：**  构造特定的输入字符串，当 iconv() 函数尝试将其转换为 ISO-2022-CN-EXT 时，导致输出缓冲区溢出 4 个字节。
3.  **利用：**  通过控制溢出的内容，可以覆盖相邻的变量，或者改变程序的执行流程，最终达到远程代码执行的目的。

**POC 代码分析：**

*   `iconvfix.sh` 脚本首先从 sansec.io 下载 `cve-2024-2961.c` 文件，然后编译并运行它。`cve-2024-2961.c` 应该是一个用于检测系统是否受 CVE-2024-2961 漏洞影响的程序。
*   如果检测到系统是易受攻击的，脚本会备份 `/usr/lib64/gconv/gconv-modules` 文件，然后注释掉该文件中与 ISO-2022-CN-EXT 相关的行。这样做可以禁用 ISO-2022-CN-EXT 字符集，从而缓解该漏洞。
*   `iconvconfig` 命令用于重建 iconv 的配置缓存。
*   脚本会再次运行漏洞检测程序，以确认补丁是否成功应用。

**有效性：**

提供的 `iconvfix.sh` 脚本通过注释掉 `/usr/lib64/gconv/gconv-modules` 文件中与 `ISO-2022-CN-EXT` 相关的行来缓解漏洞。这种方法能够阻止程序使用有漏洞的字符集转换，从而达到修复漏洞的效果。脚本的有效性依赖于系统是CentOS 7。

**投毒风险分析：**

*   脚本的主要操作是下载并执行来自 `sansec.io` 的代码。这意味着脚本的安全性取决于 `sansec.io` 的可信度。如果 `sansec.io` 被攻破或者提供恶意代码，那么执行该脚本的系统也会受到威胁。 *   脚本会修改 `/usr/lib64/gconv/gconv-modules` 文件，如果修改过程出现错误，可能会导致字符集转换出现问题。 *   尽管如此，代码本身没有明显的恶意行为，脚本意图在于修补漏洞，而非植入后门。投毒风险主要在于外部依赖 `sansec.io`，因此投毒风险相对较低。

**风险比例：** 下载外部脚本存在潜在风险，但是该脚本的内容更多的是修复行为，所以判断投毒风险为10%。

**项目地址:** [absolutedesignltd/iconvfix](https://github.com/absolutedesignltd/iconvfix)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #3

**来源**: [CVE-2024-2961-ambionics_cnext-exploits.md](../2024/CVE-2024-2961-ambionics_cnext-exploits.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务、信息泄露或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，且应用程序调用了iconv()函数，并转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 是 glibc iconv() 函数中的一个缓冲区溢出漏洞。该漏洞存在于glibc 2.39及更早版本中，当使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，可能导致输出缓冲区溢出，最多溢出 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量，进而可能被利用执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可利用的POC。提供的POC代码是一个名为`blind-cnext-exploit.py`的Python脚本，它利用了该漏洞实现了在PHP环境下的盲文件读取和远程代码执行。`README.md`文件提供了更详细的漏洞信息和利用方法的说明。

**投毒风险分析：**

分析`blind-cnext-exploit.py`的内容。代码结构相对复杂，涉及PHP filter chain的利用，但整体框架和逻辑比较清晰。主要的风险点在于`Remote`类，它负责与目标服务器交互并发送payload，如果`Remote`类中的代码被修改为恶意代码，例如在成功利用后执行额外的恶意操作，则存在投毒风险。但是，在对提供的代码进行分析后，并未发现明显的恶意行为。

`requirements.txt`文件需要安装的依赖库也需要进行检查，是否存在引入恶意库的可能。
综合判断，投毒风险较低，大约为10%。主要风险集中在`Remote`类的具体实现和`requirements.txt`依赖库。

**利用方式：**

该漏洞的利用方式如下：

1.  **触发漏洞：**  利用iconv()函数将特定的字符串转换为ISO-2022-CN-EXT字符集，触发缓冲区溢出。
2.  **盲文件读取：**  利用PHP filter chain技术，结合iconv()的漏洞，实现在目标服务器上的盲文件读取。
3.  **信息泄露：**  读取目标服务器上的敏感文件，例如PHP的配置文件、源代码等。
4.  **远程代码执行：**  通过文件读取，获取关键信息，例如libc地址、堆地址等，然后构造特定的payload，覆盖关键数据，最终实现远程代码执行。

提供的POC代码主要针对PHP环境，通过盲文件读取实现RCE。


**项目地址:** [ambionics/cnext-exploits](https://github.com/ambionics/cnext-exploits)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #4

**来源**: [CVE-2024-2961-exfil0_test_iconv.md](../2024/CVE-2024-2961-exfil0_test_iconv.md)

## CVE-2024-2961

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、覆盖相邻变量甚至远程代码执行。

**影响版本:** < 2.40

**利用条件:** 目标系统使用glibc版本低于2.40，并且程序调用了iconv()函数进行字符集转换，特别是转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数存在的一个缓冲区溢出漏洞。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能发生最多4个字节的溢出。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，此漏洞被认为是有效的。漏洞库和搜索结果中都明确指出iconv()函数在特定条件下会发生缓冲区溢出。提供的POC代码尝试触发该漏洞，通过将字符串转换为ISO-2022-CN-EXT字符集来测试溢出。

**投毒风险：** 提供的代码仓库中没有发现明显的投毒迹象。`README.md`文件描述了漏洞的利用方法，并提供了编译和运行POC的步骤。`test_iconv.c`文件是简单的C代码，用于调用iconv()函数并尝试触发漏洞。代码本身没有包含任何恶意或隐藏的功能。因此，投毒风险评估为0%。

**利用方式：**

1.  **触发漏洞：** 攻击者需要控制iconv()函数的输入和输出缓冲区，并且指定目标字符集为ISO-2022-CN-EXT。攻击者需要输入精心构造的字符串。
2.  **溢出利用：** 由于溢出只有4个字节，通常无法直接实现任意代码执行。然而，结合其他技术（例如堆利用）可能能够利用此漏洞来覆盖关键数据结构，例如堆元数据或者函数指针。
3.  **远程代码执行(RCE)：**  根据搜索结果，特别是RedHat的描述，该漏洞可能允许攻击者通过构造恶意字符序列触发越界写入并执行远程代码。Ambionics的文章也深入探讨了利用此漏洞实现RCE的可能性，特别是在PHP环境中，通过修改free list 指针，从而实现任意写。

**总结：**

CVE-2024-2961是一个缓冲区溢出漏洞，虽然溢出量较小，但结合其他技术，攻击者可以利用此漏洞实现程序崩溃，变量覆盖，甚至远程代码执行。提供的POC代码验证了该漏洞的存在，代码本身没有发现投毒风险。

**项目地址:** [exfil0/test_iconv](https://github.com/exfil0/test_iconv)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #5

**来源**: [CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md](../2024/CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、任意代码执行或信息泄露

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并调用iconv()函数进行ISO-2022-CN-EXT字符集转换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中。当将字符串转换为 ISO-2022-CN-EXT 字符集时，该函数可能导致输出缓冲区溢出，最多溢出 4 个字节。攻击者可以利用此漏洞通过特制的字符序列触发越界写入，从而导致应用程序崩溃，覆盖相邻变量或执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此漏洞利用 **有效**。漏洞库信息明确指出 iconv() 函数存在缓冲区溢出，搜索引擎结果也佐证了漏洞的存在，并提及了远程代码执行的可能性。提供的 Python 脚本 (exp.py) 尝试利用该漏洞，通过构造特定的输入，触发堆溢出，并最终尝试执行任意代码。Ambionics 的博客文章 (由搜索结果中的网页 4 指出) 提供了更详细的漏洞分析和利用方法，进一步确认了漏洞的可利用性。

**投毒风险评估：**
对提供的 exp.py 脚本进行分析：

*   **依赖库：** 脚本依赖 `pwn`, `requests` (通过`ten` 模块，该模块可能封装了`requests`) 和 `zlib` 等库。这些库本身可能存在安全风险，但属于常用库，风险较低。
*   **功能：** 脚本的主要功能是从远程服务器下载文件，读取内存映射，计算堆地址，然后构造特定的输入数据，触发漏洞。脚本包含很多与堆操作相关的代码,例如计算地址和chunk size。整体代码复杂，难以完全确定是否存在后门。
*   **可疑点：** 脚本使用了 `ten` 这个模块，这有可能是一个定制的模块，其中可能存在未知的恶意代码。脚本中包含了多个压缩和分块的操作，用于构造特定的攻击载荷，这些操作增加了代码的复杂性，也增加了隐藏恶意代码的可能性。
    `ADDR_EFREE = LIBC.symbols["__libc_system"]`这行代码使用了 system 函数，如果能控制传递给 system 函数的参数，就可以执行任意命令。在exp.py的剩余部分代码中，代码是不完整的，难以确认最终传递给system函数的参数。 

综合评估，该 POC 存在一定的投毒风险，大约为 **10%**。风险主要来自于 `ten` 模块的未知风险和利用 `system` 函数执行命令的可能性。

**利用方式分析：**

1.  **漏洞触发：** 漏洞利用首先需要触发 `iconv()` 函数，并将易受攻击的字符集作为目标。
2.  **内存布局：** 攻击者需要确定目标系统上的内存布局，特别是堆地址和 libc 地址。利用代码通过读取 `/proc/self/maps` 来获取内存区域信息，然后计算堆和 libc 的基地址。
3.  **堆溢出：** 攻击者通过构造特定的输入，利用缓冲区溢出覆盖堆上的元数据。提供的代码使用了 `chunked_chunk` 和 `compressed_bucket` 函数来创建包含特定大小和内容的 chunked data，这些chunked data会触发堆溢出。
4.  **任意代码执行：** 成功触发堆溢出后，攻击者可以覆盖关键内存区域，例如函数指针或 GOT 表项，以便在程序执行过程中劫持控制流。利用代码试图覆盖 `__libc_system` 函数，以便执行任意命令。具体而言，攻击者会覆盖free list bin指针指向伪造的chunk，然后通过malloc操作来操纵内存，从而达到任意写的效果，最终劫持控制流，执行任意代码（调用 `system` 函数）。

**项目地址:** [kjdfklha/CVE-2024-2961_poc](https://github.com/kjdfklha/CVE-2024-2961_poc)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #6

**来源**: [CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md](../2024/CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md)

## CVE-2024-2961-glibc-iconv 缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量，在特定情况下可能导致远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要存在使用 iconv 函数，并且进行到 ISO-2022-CN-EXT 字符集的转换。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中，当将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会导致最多 4 字节的输出缓冲区溢出。该漏洞影响 2.39 及更早版本。从提供的漏洞利用代码来看，该脚本利用 PHP 的 filter chain 和 iconv 函数处理字符编码转换的缺陷，实现任意文件读取。脚本首先创建一个包含一系列 iconv 转换的 PHP 过滤器链 payload，该 payload 用于读取目标服务器上的任意文件。然后，脚本通过模拟图像上传，将 payload 隐藏在 POST 请求中，发送到目标服务器的 admin-ajax.php 端点。服务器处理请求后，脚本下载生成的文件，并提取显示目标文件的内容。

**有效性：**
根据CVE描述和搜索结果以及提供的漏洞利用代码，此漏洞利用的有效性较高。CISA ADP 将其标记为“poc”，且存在利用的技术可行性。

**投毒风险：**
提供的代码主要包含一个 Python 脚本 (lfi.py) 和一个 README.md 文件。Python 脚本的功能是利用 CVE-2024-2961 漏洞读取远程文件。检查脚本发现其主要是构造恶意的字符转换，没有明显的恶意代码或者后门。脚本依赖于特定的目标 URL 和请求头，这些信息需要在实际使用前进行配置。脚本本身较为直接，没有发现隐藏的投毒代码。

**利用方式：**
利用方式是通过构造特定的 PHP 过滤器链，借助 iconv 函数在字符集转换过程中触发缓冲区溢出，从而读取服务器上的任意文件。


**项目地址:** [kyotozx/CVE-2024-2961-Remote-File-Read](https://github.com/kyotozx/CVE-2024-2961-Remote-File-Read)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #7

**来源**: [CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md](../2024/CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或任意代码执行

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行ISO-2022-CN-EXT字符集转换，并且输出缓冲区大小可控。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数的一个缓冲区溢出漏洞。当使用iconv()将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能会发生最多4字节的溢出。攻击者可以通过构造特定的输入字符串来触发此漏洞，导致程序崩溃或覆盖相邻的变量，甚至执行任意代码。

**有效性评估：**
根据CVE信息和搜索结果，该漏洞已经公开披露，并且存在可利用的POC。提供的修复脚本通过从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行来缓解该漏洞，禁用存在漏洞的字符集转换。 因此，修复脚本本身表明该漏洞是可利用的，虽然提供的脚本仅仅是缓解，而不是直接的exp.

**投毒风险评估：**
提供的`fix.sh`脚本的主要功能是检测系统上是否存在受漏洞影响的glibc版本，并尝试通过修改iconv的配置文件来缓解该漏洞。脚本首先检查`/usr/lib/x86_64-linux-gnu/gconv`目录是否存在，然后检查ldd版本是否包含GLIBC，并检查`iconv -l`命令的输出是否包含'CN-?EXT'。如果以上检查都通过，脚本会尝试使用`grep`命令从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行，并将修改后的内容保存到`.new`文件中，最后使用`mv`命令覆盖原始文件。脚本的最后运行`iconvconfig`。

该脚本的目的是缓解漏洞，而不是利用漏洞。没有发现任何恶意代码或隐藏的后门。因此，投毒风险可以认为是0%。

**利用方式：**
1.  **触发漏洞：** 通过调用iconv()函数，并将一个精心构造的字符串从一种字符集转换为ISO-2022-CN-EXT字符集。
2.  **控制溢出：**  控制输入字符串和输出缓冲区的大小，确保溢出发生，并且覆盖到目标内存区域。
3.  **代码执行 (如果可能)：** 如果溢出覆盖了函数返回地址或其他关键数据，攻击者可以控制程序的执行流程，最终实现任意代码执行。

漏洞利用难度取决于具体的环境和目标程序。在某些情况下，可能需要绕过各种安全机制，如地址空间布局随机化（ASLR）和数据执行保护（DEP）。

**项目地址:** [mattaperkins/FIX-CVE-2024-2961](https://github.com/mattaperkins/FIX-CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #8

**来源**: [CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md](../2024/CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并且存在可利用的iconv()函数调用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用`iconv()`函数将字符串转换为ISO-2022-CN-EXT字符集时，可能导致输出缓冲区溢出最多4个字节。

**有效性评估：**

根据漏洞信息和搜索引擎结果，此漏洞存在已知的PoC。PoC代码利用了PHP的`php://filter`流包装器以及一系列的`convert.iconv.*`过滤器链，通过精心构造的输入，触发glibc的iconv函数进行字符集转换，最终造成缓冲区溢出。利用方式较为复杂，依赖于PHP环境和特定的配置。

根据搜索引擎的结果发现，存在远程代码执行的可能性，结合给出的EXP代码来看，EXP中的利用是通过构造特定的`convert.iconv`链条最终溢出达到读取文件内容或者写入的目的。

**投毒风险评估：**

提供的PoC代码主要通过HTTP请求发送payload，并下载`/proc/self/maps`和libc文件。虽然PoC中包含了一些base64编码和解码操作，以及`convert.iconv` 链条，但整体逻辑看起来是为了利用漏洞，没有明显的恶意代码，但仍然存在很小的风险。

风险点在于：

1.  **依赖外部资源：** PoC可能需要下载远程文件（libc），攻击者可以替换这些文件为恶意文件。
2.  **命令执行：** PoC允许指定要执行的命令，如果目标系统配置不当，可能导致恶意命令执行。
3.  **未知的依赖项风险：** PoC可能依赖于未知的或未公开的第三方库，这些库可能存在安全漏洞，或者被攻击者篡改。

综合评估，PoC代码存在一定的投毒风险，但概率较低(5%)，需要仔细审计代码，并确保使用的外部资源是可信的。

**利用方式：**

1.  **目标识别：** 确定目标系统使用的glibc版本低于2.40，并且存在iconv()函数调用。
2.  **构造Payload：**  使用`php://filter`流包装器和一系列的`convert.iconv.*`过滤器链构造恶意的payload，触发缓冲区溢出。
3.  **信息泄露/代码执行：** 利用溢出覆盖相邻的变量或函数指针，从而实现信息泄露或远程代码执行。

**项目地址:** [regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-](https://github.com/regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #9

**来源**: [CVE-2024-2961-rvizx_CVE-2024-2961.md](../2024/CVE-2024-2961-rvizx_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，并且程序使用iconv函数转换到ISO-2022-CN-EXT字符集

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961 存在于 GNU C 库 (glibc) 的 iconv() 函数中。当应用程序使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果 glibc 版本低于 2.40，则可能发生缓冲区溢出，溢出量最多为 4 字节。这可能导致应用程序崩溃或覆盖相邻变量，攻击者可能利用此漏洞执行远程代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且存在PoC。提供的脚本 `fix.sh` 并非直接的利用代码，而是用于缓解该漏洞的脚本。它通过禁用有问题的字符集来阻止漏洞被触发，因此该脚本本身不是PoC，但验证了漏洞的可利用性。

**投毒风险：**

分析 `fix.sh` 脚本，它主要执行以下操作：

1.  检查系统是否存在受影响的字符集。
2.  查找 `gconv-modules-extra.conf` 文件。
3.  禁用 `gconv-modules-extra.conf` 中与 `ISO-2022-CN-EXT` 相关的编码。
4.  重新生成 gconv 模块缓存。
5.  验证缓解措施是否成功。

脚本中潜在的投毒点可能在于：

*   在禁用编码的部分，`sed` 命令可能被修改为删除其他重要的字符集，导致应用程序无法正常处理某些字符，虽然可能性不大，考虑到这个脚本的目的是缓解漏洞，恶意修改 `sed` 命令会适得其反，更容易被检测到。 *   替换 `gconv-modules-extra.conf` 或者注入恶意内容，导致系统无法正常工作。但是会影响全局导致应用异常。

总体而言，该脚本的风险较低，因为其主要功能是禁用特定的字符集，而不是执行任意代码。考虑到作者的信息和脚本内容，可以初步判断存在恶意投毒的可能性较低，估算投毒风险为 5%。

**利用方式：**

漏洞的利用方式是：

1.  攻击者需要找到一个应用程序，该应用程序使用 glibc 的 iconv() 函数进行字符集转换。
2.  应用程序必须使用 iconv() 函数将输入转换为 ISO-2022-CN-EXT 字符集。
3.  攻击者构造恶意的字符串，当该字符串被 iconv() 函数转换时，会导致输出缓冲区溢出。
4.  如果成功利用，攻击者可以控制程序的执行流程，甚至执行任意代码。具体利用效果取决于程序内存布局以及溢出造成的破坏。

**项目地址:** [rvizx/CVE-2024-2961](https://github.com/rvizx/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #10

**来源**: [CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md](../2024/CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md)

# CVE-2024-2961

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-2961-4wayhandshake_CVE-2024-2961.md](../2024/CVE-2024-2961-4wayhandshake_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，可能会发生最多4字节的输出缓冲区溢出。攻击者可以利用此漏洞导致应用程序崩溃或覆盖相邻的变量。根据提供的漏洞利用代码，该POC利用了`wrapwrap`工具来构造特定的PHP过滤器链，该过滤器链会触发`iconv()`函数的漏洞，从而实现任意文件读取。该POC针对WordPress环境，利用其`upload_image_from_url`功能，通过可控的URL参数和构造的过滤器链，读取服务器上的任意文件。 

**有效性：**
根据漏洞描述和提供的利用代码，该漏洞是可利用的。Ambionics网站上的文章 (webpage 4, and links inside CVE details) 以及提供的POC表明此漏洞可以通过精心构造的输入触发。

**投毒风险：**
检查`arbitrary-file-read.py`脚本，未发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造HTTP请求，利用`wrapwrap`生成的链，发送给目标服务器，并处理响应。脚本的目的是利用漏洞读取文件内容，没有发现任何主动植入后门或执行恶意操作的迹象。代码从`chain.txt`读取filter chain，并将其插入到POST请求中，这部分是与wrapwrap工具协同工作以利用漏洞。检查README.md文件，描述了如何使用POC和wrapwrap工具，没有发现任何可疑之处。因此，投毒风险较低。

**利用方式：**
1.  **目标确认:** 确认目标系统使用受影响的glibc版本（< 2.40）并且存在可以利用的字符集转换点。
2.  **构造Payload:** 使用wrapwrap工具，生成包含特定PHP filter chain的`chain.txt`文件，该filter chain可以触发iconv()函数的缓冲区溢出漏洞，目标是读取任意文件。
3.  **URL构造:** 攻击者需要找到一个接受URL作为参数的接口，例如WordPress的`upload_image_from_url`功能。
4.  **发送请求:** 攻击者将构造的包含恶意filter chain的URL发送给目标服务器。
5.  **触发漏洞:**  服务器的iconv()函数在处理字符集转换时发生缓冲区溢出。
6.  **任意文件读取:**  利用缓冲区溢出漏洞，读取服务器上的任意文件内容。
7.  **移除Prefix/Suffix:** 可以移除读取文件的前缀或后缀，方便查看文件内容。
8.  **结果获取:**  攻击者从服务器的响应中获取读取的文件内容。

此利用方式依赖于目标系统存在特定的字符集转换操作，并且攻击者能够控制输入到iconv()函数的参数。提供的代码专门针对WordPress环境，展示了如何利用其文件上传功能触发漏洞，读取服务器上的敏感文件。

**项目地址:** [4wayhandshake/CVE-2024-2961](https://github.com/4wayhandshake/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #2

**来源**: [CVE-2024-2961-absolutedesignltd_iconvfix.md](../2024/CVE-2024-2961-absolutedesignltd_iconvfix.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或覆盖相邻变量，甚至远程代码执行（根据搜索结果）

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行字符集转换，且目标系统glibc版本低于2.40，字符集为ISO-2022-CN-EXT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 漏洞是 glibc 中 iconv() 函数在处理 ISO-2022-CN-EXT 字符集转换时存在的缓冲区溢出漏洞。具体来说，当 iconv() 将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会溢出输出缓冲区最多 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量。搜索结果表明该漏洞可能被利用于远程代码执行。

**漏洞利用方式：**

1.  **触发条件：**  利用iconv函数进行字符集转换，源字符集未知，目标字符集需要指定为ISO-2022-CN-EXT，且glibc版本低于2.40。
2.  **溢出：**  构造特定的输入字符串，当 iconv() 函数尝试将其转换为 ISO-2022-CN-EXT 时，导致输出缓冲区溢出 4 个字节。
3.  **利用：**  通过控制溢出的内容，可以覆盖相邻的变量，或者改变程序的执行流程，最终达到远程代码执行的目的。

**POC 代码分析：**

*   `iconvfix.sh` 脚本首先从 sansec.io 下载 `cve-2024-2961.c` 文件，然后编译并运行它。`cve-2024-2961.c` 应该是一个用于检测系统是否受 CVE-2024-2961 漏洞影响的程序。
*   如果检测到系统是易受攻击的，脚本会备份 `/usr/lib64/gconv/gconv-modules` 文件，然后注释掉该文件中与 ISO-2022-CN-EXT 相关的行。这样做可以禁用 ISO-2022-CN-EXT 字符集，从而缓解该漏洞。
*   `iconvconfig` 命令用于重建 iconv 的配置缓存。
*   脚本会再次运行漏洞检测程序，以确认补丁是否成功应用。

**有效性：**

提供的 `iconvfix.sh` 脚本通过注释掉 `/usr/lib64/gconv/gconv-modules` 文件中与 `ISO-2022-CN-EXT` 相关的行来缓解漏洞。这种方法能够阻止程序使用有漏洞的字符集转换，从而达到修复漏洞的效果。脚本的有效性依赖于系统是CentOS 7。

**投毒风险分析：**

*   脚本的主要操作是下载并执行来自 `sansec.io` 的代码。这意味着脚本的安全性取决于 `sansec.io` 的可信度。如果 `sansec.io` 被攻破或者提供恶意代码，那么执行该脚本的系统也会受到威胁。 *   脚本会修改 `/usr/lib64/gconv/gconv-modules` 文件，如果修改过程出现错误，可能会导致字符集转换出现问题。 *   尽管如此，代码本身没有明显的恶意行为，脚本意图在于修补漏洞，而非植入后门。投毒风险主要在于外部依赖 `sansec.io`，因此投毒风险相对较低。

**风险比例：** 下载外部脚本存在潜在风险，但是该脚本的内容更多的是修复行为，所以判断投毒风险为10%。

**项目地址:** [absolutedesignltd/iconvfix](https://github.com/absolutedesignltd/iconvfix)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #3

**来源**: [CVE-2024-2961-ambionics_cnext-exploits.md](../2024/CVE-2024-2961-ambionics_cnext-exploits.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务、信息泄露或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，且应用程序调用了iconv()函数，并转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 是 glibc iconv() 函数中的一个缓冲区溢出漏洞。该漏洞存在于glibc 2.39及更早版本中，当使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，可能导致输出缓冲区溢出，最多溢出 4 个字节。这可能导致应用程序崩溃或覆盖相邻变量，进而可能被利用执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可利用的POC。提供的POC代码是一个名为`blind-cnext-exploit.py`的Python脚本，它利用了该漏洞实现了在PHP环境下的盲文件读取和远程代码执行。`README.md`文件提供了更详细的漏洞信息和利用方法的说明。

**投毒风险分析：**

分析`blind-cnext-exploit.py`的内容。代码结构相对复杂，涉及PHP filter chain的利用，但整体框架和逻辑比较清晰。主要的风险点在于`Remote`类，它负责与目标服务器交互并发送payload，如果`Remote`类中的代码被修改为恶意代码，例如在成功利用后执行额外的恶意操作，则存在投毒风险。但是，在对提供的代码进行分析后，并未发现明显的恶意行为。

`requirements.txt`文件需要安装的依赖库也需要进行检查，是否存在引入恶意库的可能。
综合判断，投毒风险较低，大约为10%。主要风险集中在`Remote`类的具体实现和`requirements.txt`依赖库。

**利用方式：**

该漏洞的利用方式如下：

1.  **触发漏洞：**  利用iconv()函数将特定的字符串转换为ISO-2022-CN-EXT字符集，触发缓冲区溢出。
2.  **盲文件读取：**  利用PHP filter chain技术，结合iconv()的漏洞，实现在目标服务器上的盲文件读取。
3.  **信息泄露：**  读取目标服务器上的敏感文件，例如PHP的配置文件、源代码等。
4.  **远程代码执行：**  通过文件读取，获取关键信息，例如libc地址、堆地址等，然后构造特定的payload，覆盖关键数据，最终实现远程代码执行。

提供的POC代码主要针对PHP环境，通过盲文件读取实现RCE。


**项目地址:** [ambionics/cnext-exploits](https://github.com/ambionics/cnext-exploits)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #4

**来源**: [CVE-2024-2961-exfil0_test_iconv.md](../2024/CVE-2024-2961-exfil0_test_iconv.md)

## CVE-2024-2961

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、覆盖相邻变量甚至远程代码执行。

**影响版本:** < 2.40

**利用条件:** 目标系统使用glibc版本低于2.40，并且程序调用了iconv()函数进行字符集转换，特别是转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数存在的一个缓冲区溢出漏洞。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能发生最多4个字节的溢出。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，此漏洞被认为是有效的。漏洞库和搜索结果中都明确指出iconv()函数在特定条件下会发生缓冲区溢出。提供的POC代码尝试触发该漏洞，通过将字符串转换为ISO-2022-CN-EXT字符集来测试溢出。

**投毒风险：** 提供的代码仓库中没有发现明显的投毒迹象。`README.md`文件描述了漏洞的利用方法，并提供了编译和运行POC的步骤。`test_iconv.c`文件是简单的C代码，用于调用iconv()函数并尝试触发漏洞。代码本身没有包含任何恶意或隐藏的功能。因此，投毒风险评估为0%。

**利用方式：**

1.  **触发漏洞：** 攻击者需要控制iconv()函数的输入和输出缓冲区，并且指定目标字符集为ISO-2022-CN-EXT。攻击者需要输入精心构造的字符串。
2.  **溢出利用：** 由于溢出只有4个字节，通常无法直接实现任意代码执行。然而，结合其他技术（例如堆利用）可能能够利用此漏洞来覆盖关键数据结构，例如堆元数据或者函数指针。
3.  **远程代码执行(RCE)：**  根据搜索结果，特别是RedHat的描述，该漏洞可能允许攻击者通过构造恶意字符序列触发越界写入并执行远程代码。Ambionics的文章也深入探讨了利用此漏洞实现RCE的可能性，特别是在PHP环境中，通过修改free list 指针，从而实现任意写。

**总结：**

CVE-2024-2961是一个缓冲区溢出漏洞，虽然溢出量较小，但结合其他技术，攻击者可以利用此漏洞实现程序崩溃，变量覆盖，甚至远程代码执行。提供的POC代码验证了该漏洞的存在，代码本身没有发现投毒风险。

**项目地址:** [exfil0/test_iconv](https://github.com/exfil0/test_iconv)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #5

**来源**: [CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md](../2024/CVE-2024-2961-kjdfklha_CVE-2024-2961_poc.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、任意代码执行或信息泄露

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并调用iconv()函数进行ISO-2022-CN-EXT字符集转换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中。当将字符串转换为 ISO-2022-CN-EXT 字符集时，该函数可能导致输出缓冲区溢出，最多溢出 4 个字节。攻击者可以利用此漏洞通过特制的字符序列触发越界写入，从而导致应用程序崩溃，覆盖相邻变量或执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此漏洞利用 **有效**。漏洞库信息明确指出 iconv() 函数存在缓冲区溢出，搜索引擎结果也佐证了漏洞的存在，并提及了远程代码执行的可能性。提供的 Python 脚本 (exp.py) 尝试利用该漏洞，通过构造特定的输入，触发堆溢出，并最终尝试执行任意代码。Ambionics 的博客文章 (由搜索结果中的网页 4 指出) 提供了更详细的漏洞分析和利用方法，进一步确认了漏洞的可利用性。

**投毒风险评估：**
对提供的 exp.py 脚本进行分析：

*   **依赖库：** 脚本依赖 `pwn`, `requests` (通过`ten` 模块，该模块可能封装了`requests`) 和 `zlib` 等库。这些库本身可能存在安全风险，但属于常用库，风险较低。
*   **功能：** 脚本的主要功能是从远程服务器下载文件，读取内存映射，计算堆地址，然后构造特定的输入数据，触发漏洞。脚本包含很多与堆操作相关的代码,例如计算地址和chunk size。整体代码复杂，难以完全确定是否存在后门。
*   **可疑点：** 脚本使用了 `ten` 这个模块，这有可能是一个定制的模块，其中可能存在未知的恶意代码。脚本中包含了多个压缩和分块的操作，用于构造特定的攻击载荷，这些操作增加了代码的复杂性，也增加了隐藏恶意代码的可能性。
    `ADDR_EFREE = LIBC.symbols["__libc_system"]`这行代码使用了 system 函数，如果能控制传递给 system 函数的参数，就可以执行任意命令。在exp.py的剩余部分代码中，代码是不完整的，难以确认最终传递给system函数的参数。 

综合评估，该 POC 存在一定的投毒风险，大约为 **10%**。风险主要来自于 `ten` 模块的未知风险和利用 `system` 函数执行命令的可能性。

**利用方式分析：**

1.  **漏洞触发：** 漏洞利用首先需要触发 `iconv()` 函数，并将易受攻击的字符集作为目标。
2.  **内存布局：** 攻击者需要确定目标系统上的内存布局，特别是堆地址和 libc 地址。利用代码通过读取 `/proc/self/maps` 来获取内存区域信息，然后计算堆和 libc 的基地址。
3.  **堆溢出：** 攻击者通过构造特定的输入，利用缓冲区溢出覆盖堆上的元数据。提供的代码使用了 `chunked_chunk` 和 `compressed_bucket` 函数来创建包含特定大小和内容的 chunked data，这些chunked data会触发堆溢出。
4.  **任意代码执行：** 成功触发堆溢出后，攻击者可以覆盖关键内存区域，例如函数指针或 GOT 表项，以便在程序执行过程中劫持控制流。利用代码试图覆盖 `__libc_system` 函数，以便执行任意命令。具体而言，攻击者会覆盖free list bin指针指向伪造的chunk，然后通过malloc操作来操纵内存，从而达到任意写的效果，最终劫持控制流，执行任意代码（调用 `system` 函数）。

**项目地址:** [kjdfklha/CVE-2024-2961_poc](https://github.com/kjdfklha/CVE-2024-2961_poc)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #6

**来源**: [CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md](../2024/CVE-2024-2961-kyotozx_CVE-2024-2961-Remote-File-Read.md)

## CVE-2024-2961-glibc-iconv 缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用崩溃或覆盖相邻变量，在特定情况下可能导致远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要存在使用 iconv 函数，并且进行到 ISO-2022-CN-EXT 字符集的转换。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 存在于 glibc 的 iconv() 函数中，当将字符串转换为 ISO-2022-CN-EXT 字符集时，可能会导致最多 4 字节的输出缓冲区溢出。该漏洞影响 2.39 及更早版本。从提供的漏洞利用代码来看，该脚本利用 PHP 的 filter chain 和 iconv 函数处理字符编码转换的缺陷，实现任意文件读取。脚本首先创建一个包含一系列 iconv 转换的 PHP 过滤器链 payload，该 payload 用于读取目标服务器上的任意文件。然后，脚本通过模拟图像上传，将 payload 隐藏在 POST 请求中，发送到目标服务器的 admin-ajax.php 端点。服务器处理请求后，脚本下载生成的文件，并提取显示目标文件的内容。

**有效性：**
根据CVE描述和搜索结果以及提供的漏洞利用代码，此漏洞利用的有效性较高。CISA ADP 将其标记为“poc”，且存在利用的技术可行性。

**投毒风险：**
提供的代码主要包含一个 Python 脚本 (lfi.py) 和一个 README.md 文件。Python 脚本的功能是利用 CVE-2024-2961 漏洞读取远程文件。检查脚本发现其主要是构造恶意的字符转换，没有明显的恶意代码或者后门。脚本依赖于特定的目标 URL 和请求头，这些信息需要在实际使用前进行配置。脚本本身较为直接，没有发现隐藏的投毒代码。

**利用方式：**
利用方式是通过构造特定的 PHP 过滤器链，借助 iconv 函数在字符集转换过程中触发缓冲区溢出，从而读取服务器上的任意文件。


**项目地址:** [kyotozx/CVE-2024-2961-Remote-File-Read](https://github.com/kyotozx/CVE-2024-2961-Remote-File-Read)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #7

**来源**: [CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md](../2024/CVE-2024-2961-mattaperkins_FIX-CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或任意代码执行

**影响版本:** < 2.40

**利用条件:** 需要使用iconv()函数进行ISO-2022-CN-EXT字符集转换，并且输出缓冲区大小可控。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数的一个缓冲区溢出漏洞。当使用iconv()将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能会发生最多4字节的溢出。攻击者可以通过构造特定的输入字符串来触发此漏洞，导致程序崩溃或覆盖相邻的变量，甚至执行任意代码。

**有效性评估：**
根据CVE信息和搜索结果，该漏洞已经公开披露，并且存在可利用的POC。提供的修复脚本通过从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行来缓解该漏洞，禁用存在漏洞的字符集转换。 因此，修复脚本本身表明该漏洞是可利用的，虽然提供的脚本仅仅是缓解，而不是直接的exp.

**投毒风险评估：**
提供的`fix.sh`脚本的主要功能是检测系统上是否存在受漏洞影响的glibc版本，并尝试通过修改iconv的配置文件来缓解该漏洞。脚本首先检查`/usr/lib/x86_64-linux-gnu/gconv`目录是否存在，然后检查ldd版本是否包含GLIBC，并检查`iconv -l`命令的输出是否包含'CN-?EXT'。如果以上检查都通过，脚本会尝试使用`grep`命令从`gconv-modules-extra.conf`文件中移除包含'CN-?EXT'的行，并将修改后的内容保存到`.new`文件中，最后使用`mv`命令覆盖原始文件。脚本的最后运行`iconvconfig`。

该脚本的目的是缓解漏洞，而不是利用漏洞。没有发现任何恶意代码或隐藏的后门。因此，投毒风险可以认为是0%。

**利用方式：**
1.  **触发漏洞：** 通过调用iconv()函数，并将一个精心构造的字符串从一种字符集转换为ISO-2022-CN-EXT字符集。
2.  **控制溢出：**  控制输入字符串和输出缓冲区的大小，确保溢出发生，并且覆盖到目标内存区域。
3.  **代码执行 (如果可能)：** 如果溢出覆盖了函数返回地址或其他关键数据，攻击者可以控制程序的执行流程，最终实现任意代码执行。

漏洞利用难度取决于具体的环境和目标程序。在某些情况下，可能需要绕过各种安全机制，如地址空间布局随机化（ASLR）和数据执行保护（DEP）。

**项目地址:** [mattaperkins/FIX-CVE-2024-2961](https://github.com/mattaperkins/FIX-CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #8

**来源**: [CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md](../2024/CVE-2024-2961-regantemudo_PHP-file-read-to-RCE-CVE-2024-2961-.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用存在漏洞的glibc版本，并且存在可利用的iconv()函数调用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961是glibc库iconv()函数中的一个缓冲区溢出漏洞。该漏洞影响glibc 2.39及更早版本。当使用`iconv()`函数将字符串转换为ISO-2022-CN-EXT字符集时，可能导致输出缓冲区溢出最多4个字节。

**有效性评估：**

根据漏洞信息和搜索引擎结果，此漏洞存在已知的PoC。PoC代码利用了PHP的`php://filter`流包装器以及一系列的`convert.iconv.*`过滤器链，通过精心构造的输入，触发glibc的iconv函数进行字符集转换，最终造成缓冲区溢出。利用方式较为复杂，依赖于PHP环境和特定的配置。

根据搜索引擎的结果发现，存在远程代码执行的可能性，结合给出的EXP代码来看，EXP中的利用是通过构造特定的`convert.iconv`链条最终溢出达到读取文件内容或者写入的目的。

**投毒风险评估：**

提供的PoC代码主要通过HTTP请求发送payload，并下载`/proc/self/maps`和libc文件。虽然PoC中包含了一些base64编码和解码操作，以及`convert.iconv` 链条，但整体逻辑看起来是为了利用漏洞，没有明显的恶意代码，但仍然存在很小的风险。

风险点在于：

1.  **依赖外部资源：** PoC可能需要下载远程文件（libc），攻击者可以替换这些文件为恶意文件。
2.  **命令执行：** PoC允许指定要执行的命令，如果目标系统配置不当，可能导致恶意命令执行。
3.  **未知的依赖项风险：** PoC可能依赖于未知的或未公开的第三方库，这些库可能存在安全漏洞，或者被攻击者篡改。

综合评估，PoC代码存在一定的投毒风险，但概率较低(5%)，需要仔细审计代码，并确保使用的外部资源是可信的。

**利用方式：**

1.  **目标识别：** 确定目标系统使用的glibc版本低于2.40，并且存在iconv()函数调用。
2.  **构造Payload：**  使用`php://filter`流包装器和一系列的`convert.iconv.*`过滤器链构造恶意的payload，触发缓冲区溢出。
3.  **信息泄露/代码执行：** 利用溢出覆盖相邻的变量或函数指针，从而实现信息泄露或远程代码执行。

**项目地址:** [regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-](https://github.com/regantemudo/PHP-file-read-to-RCE-CVE-2024-2961-)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #9

**来源**: [CVE-2024-2961-rvizx_CVE-2024-2961.md](../2024/CVE-2024-2961-rvizx_CVE-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，并且程序使用iconv函数转换到ISO-2022-CN-EXT字符集

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961 存在于 GNU C 库 (glibc) 的 iconv() 函数中。当应用程序使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果 glibc 版本低于 2.40，则可能发生缓冲区溢出，溢出量最多为 4 字节。这可能导致应用程序崩溃或覆盖相邻变量，攻击者可能利用此漏洞执行远程代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且存在PoC。提供的脚本 `fix.sh` 并非直接的利用代码，而是用于缓解该漏洞的脚本。它通过禁用有问题的字符集来阻止漏洞被触发，因此该脚本本身不是PoC，但验证了漏洞的可利用性。

**投毒风险：**

分析 `fix.sh` 脚本，它主要执行以下操作：

1.  检查系统是否存在受影响的字符集。
2.  查找 `gconv-modules-extra.conf` 文件。
3.  禁用 `gconv-modules-extra.conf` 中与 `ISO-2022-CN-EXT` 相关的编码。
4.  重新生成 gconv 模块缓存。
5.  验证缓解措施是否成功。

脚本中潜在的投毒点可能在于：

*   在禁用编码的部分，`sed` 命令可能被修改为删除其他重要的字符集，导致应用程序无法正常处理某些字符，虽然可能性不大，考虑到这个脚本的目的是缓解漏洞，恶意修改 `sed` 命令会适得其反，更容易被检测到。 *   替换 `gconv-modules-extra.conf` 或者注入恶意内容，导致系统无法正常工作。但是会影响全局导致应用异常。

总体而言，该脚本的风险较低，因为其主要功能是禁用特定的字符集，而不是执行任意代码。考虑到作者的信息和脚本内容，可以初步判断存在恶意投毒的可能性较低，估算投毒风险为 5%。

**利用方式：**

漏洞的利用方式是：

1.  攻击者需要找到一个应用程序，该应用程序使用 glibc 的 iconv() 函数进行字符集转换。
2.  应用程序必须使用 iconv() 函数将输入转换为 ISO-2022-CN-EXT 字符集。
3.  攻击者构造恶意的字符串，当该字符串被 iconv() 函数转换时，会导致输出缓冲区溢出。
4.  如果成功利用，攻击者可以控制程序的执行流程，甚至执行任意代码。具体利用效果取决于程序内存布局以及溢出造成的破坏。

**项目地址:** [rvizx/CVE-2024-2961](https://github.com/rvizx/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #10

**来源**: [CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md](../2024/CVE-2024-2961-suce0155_CVE-2024-2961_buddyforms_2.7.7.md)

## CVE-2024-2961_buddyforms_2.7.7_RCE

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** glibc (iconv) & Buddyforms 2.7.7

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** glibc <= 2.39 & Buddyforms 2.7.7

**利用条件:** 需要Buddyforms 2.7.7插件存在，且目标系统使用受影响的glibc版本，以及存在可利用的admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞结合了CVE-2024-2961（glibc iconv缓冲区溢出）和CVE-2023–26326 (Buddyforms LFI)。攻击者利用Buddyforms插件的文件包含漏洞读取任意文件，然后利用glibc的iconv函数进行字符集转换时存在的缓冲区溢出漏洞，通过构造恶意的字符序列触发溢出，最终实现远程代码执行。

**有效性：**
根据漏洞描述，搜索引擎结果和提供的POC代码，该POC代码是有效的。POC代码的README描述了如何使用该漏洞，并且提供了相关的技术细节链接和演示图片。代码本身利用了`iconv`函数的漏洞结合Buddyforms插件来实现RCE。

**投毒风险：**
POC代码中主要关注`buddyforms_2.7.7_cnext_exploit.py`。初步分析没有发现明显的恶意代码，例如反弹shell、下载执行恶意程序等。但是，仍然存在一定的投毒风险，主要体现在以下几个方面：
*   **依赖库风险：** `requirements.txt`中可能包含带有恶意代码的依赖库，虽然几率较低，但存在可能性。
*   **Payload定制风险：** POC代码的有效性依赖于特定的payload。攻击者可能通过修改payload来植入后门，例如在执行命令前或后添加恶意操作。尽管此POC的目的是进行漏洞利用演示，但用户可能不经检查直接用于生产环境，从而为攻击者留下可乘之机。
*   **隐蔽的后门函数：** 作者可能在代码中加入看似无害的函数，但在特定条件下触发恶意行为。虽然直接分析没有发现，但不能排除这种可能性。综合考虑，认为存在20%的投毒风险。

**利用方式：**
1.  **文件包含：** 利用Buddyforms插件的漏洞，通过`php://filter`伪协议读取`/proc/self/maps`，泄露内存布局。
2.  **泄露libc地址：** 从内存布局中找到libc的加载地址。
3.  **利用iconv漏洞：** 构造恶意的字符序列，利用`iconv`函数在进行`ISO-2022-CN-EXT`字符集转换时触发缓冲区溢出。
4.  **覆盖返回地址：** 利用缓冲区溢出覆盖函数返回地址，劫持程序控制流。
5.  **执行shellcode：** 将返回地址覆盖为shellcode的地址，执行shellcode，实现远程代码执行。
6.  **反弹Shell/执行命令:** Shellcode通常用于反弹shell或执行任意命令。

总而言之，利用方式比较复杂，需要结合多个漏洞才能完成RCE。

**项目地址:** [suce0155/CVE-2024-2961_buddyforms_2.7.7](https://github.com/suce0155/CVE-2024-2961_buddyforms_2.7.7)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

## POC #11

**来源**: [CVE-2024-2961-tnishiox_cve-2024-2961.md](../2024/CVE-2024-2961-tnishiox_cve-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用程序崩溃或覆盖相邻变量，理论上可实现远程代码执行。

**影响版本:** < 2.40

**利用条件:** 需要应用程序使用 iconv 函数进行字符集转换，且目标字符集为 ISO-2022-CN-EXT。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 是 glibc 中 iconv 函数的一个缓冲区溢出漏洞。具体来说，当使用 iconv 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果输出缓冲区太小，可能会发生最多 4 字节的溢出。漏洞影响 glibc 2.39 及更早版本。

**有效性：**
提供的 POC 代码是一个简单的漏洞检测器，它尝试使用 iconv 函数将包含中文字符的字符串从 UTF-8 转换为 ISO-2022-CN-EXT。如果 `iconv` 返回值小于0，则说明系统存在漏洞。代码通过检查 `soutput` 的值来确定是否发生溢出。根据搜索结果，此漏洞确实存在可利用性。

**投毒风险：**
该仓库的代码非常简单，主要就是一个C文件和一个README。C文件仅仅实现了漏洞验证的功能，没有发现恶意代码。README 提供了漏洞相关信息的链接。因此，投毒风险非常低，大约为 1%。argv可以从外部传入参数，用于设置 sleep 的时间。

**利用方式：**
攻击者需要控制应用程序的输入，使其能够调用 iconv 函数，并将字符串转换为 ISO-2022-CN-EXT 字符集。同时，攻击者还需要精心构造输入字符串，以便在溢出时覆盖关键内存区域，例如函数返回地址或其它重要的变量。搜索结果中的网页1提到“ This issue may allow an attacker to craft a malicious characters sequence that will trigger the out-of-bounds write and perform remote code execution.”

简单来说，利用方式如下：
1.  确定目标应用程序使用 iconv 函数进行字符集转换，且容易受到该漏洞的影响。
2.  构造恶意的输入字符串，触发溢出。
3.  控制溢出内容，覆盖目标内存区域，实现攻击目的，例如代码执行。

**项目地址:** [tnishiox/cve-2024-2961](https://github.com/tnishiox/cve-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---



---

## POC #11

**来源**: [CVE-2024-2961-tnishiox_cve-2024-2961.md](../2024/CVE-2024-2961-tnishiox_cve-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用程序崩溃或覆盖相邻变量，理论上可实现远程代码执行。

**影响版本:** < 2.40

**利用条件:** 需要应用程序使用 iconv 函数进行字符集转换，且目标字符集为 ISO-2022-CN-EXT。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 是 glibc 中 iconv 函数的一个缓冲区溢出漏洞。具体来说，当使用 iconv 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果输出缓冲区太小，可能会发生最多 4 字节的溢出。漏洞影响 glibc 2.39 及更早版本。

**有效性：**
提供的 POC 代码是一个简单的漏洞检测器，它尝试使用 iconv 函数将包含中文字符的字符串从 UTF-8 转换为 ISO-2022-CN-EXT。如果 `iconv` 返回值小于0，则说明系统存在漏洞。代码通过检查 `soutput` 的值来确定是否发生溢出。根据搜索结果，此漏洞确实存在可利用性。

**投毒风险：**
该仓库的代码非常简单，主要就是一个C文件和一个README。C文件仅仅实现了漏洞验证的功能，没有发现恶意代码。README 提供了漏洞相关信息的链接。因此，投毒风险非常低，大约为 1%。argv可以从外部传入参数，用于设置 sleep 的时间。

**利用方式：**
攻击者需要控制应用程序的输入，使其能够调用 iconv 函数，并将字符串转换为 ISO-2022-CN-EXT 字符集。同时，攻击者还需要精心构造输入字符串，以便在溢出时覆盖关键内存区域，例如函数返回地址或其它重要的变量。搜索结果中的网页1提到“ This issue may allow an attacker to craft a malicious characters sequence that will trigger the out-of-bounds write and perform remote code execution.”

简单来说，利用方式如下：
1.  确定目标应用程序使用 iconv 函数进行字符集转换，且容易受到该漏洞的影响。
2.  构造恶意的输入字符串，触发溢出。
3.  控制溢出内容，覆盖目标内存区域，实现攻击目的，例如代码执行。

**项目地址:** [tnishiox/cve-2024-2961](https://github.com/tnishiox/cve-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---



---

## POC #11

**来源**: [CVE-2024-2961-tnishiox_cve-2024-2961.md](../2024/CVE-2024-2961-tnishiox_cve-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用程序崩溃或覆盖相邻变量，理论上可实现远程代码执行。

**影响版本:** < 2.40

**利用条件:** 需要应用程序使用 iconv 函数进行字符集转换，且目标字符集为 ISO-2022-CN-EXT。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 是 glibc 中 iconv 函数的一个缓冲区溢出漏洞。具体来说，当使用 iconv 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果输出缓冲区太小，可能会发生最多 4 字节的溢出。漏洞影响 glibc 2.39 及更早版本。

**有效性：**
提供的 POC 代码是一个简单的漏洞检测器，它尝试使用 iconv 函数将包含中文字符的字符串从 UTF-8 转换为 ISO-2022-CN-EXT。如果 `iconv` 返回值小于0，则说明系统存在漏洞。代码通过检查 `soutput` 的值来确定是否发生溢出。根据搜索结果，此漏洞确实存在可利用性。

**投毒风险：**
该仓库的代码非常简单，主要就是一个C文件和一个README。C文件仅仅实现了漏洞验证的功能，没有发现恶意代码。README 提供了漏洞相关信息的链接。因此，投毒风险非常低，大约为 1%。argv可以从外部传入参数，用于设置 sleep 的时间。

**利用方式：**
攻击者需要控制应用程序的输入，使其能够调用 iconv 函数，并将字符串转换为 ISO-2022-CN-EXT 字符集。同时，攻击者还需要精心构造输入字符串，以便在溢出时覆盖关键内存区域，例如函数返回地址或其它重要的变量。搜索结果中的网页1提到“ This issue may allow an attacker to craft a malicious characters sequence that will trigger the out-of-bounds write and perform remote code execution.”

简单来说，利用方式如下：
1.  确定目标应用程序使用 iconv 函数进行字符集转换，且容易受到该漏洞的影响。
2.  构造恶意的输入字符串，触发溢出。
3.  控制溢出内容，覆盖目标内存区域，实现攻击目的，例如代码执行。

**项目地址:** [tnishiox/cve-2024-2961](https://github.com/tnishiox/cve-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---



---

## POC #11

**来源**: [CVE-2024-2961-tnishiox_cve-2024-2961.md](../2024/CVE-2024-2961-tnishiox_cve-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用程序崩溃或覆盖相邻变量，理论上可实现远程代码执行。

**影响版本:** < 2.40

**利用条件:** 需要应用程序使用 iconv 函数进行字符集转换，且目标字符集为 ISO-2022-CN-EXT。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 是 glibc 中 iconv 函数的一个缓冲区溢出漏洞。具体来说，当使用 iconv 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果输出缓冲区太小，可能会发生最多 4 字节的溢出。漏洞影响 glibc 2.39 及更早版本。

**有效性：**
提供的 POC 代码是一个简单的漏洞检测器，它尝试使用 iconv 函数将包含中文字符的字符串从 UTF-8 转换为 ISO-2022-CN-EXT。如果 `iconv` 返回值小于0，则说明系统存在漏洞。代码通过检查 `soutput` 的值来确定是否发生溢出。根据搜索结果，此漏洞确实存在可利用性。

**投毒风险：**
该仓库的代码非常简单，主要就是一个C文件和一个README。C文件仅仅实现了漏洞验证的功能，没有发现恶意代码。README 提供了漏洞相关信息的链接。因此，投毒风险非常低，大约为 1%。argv可以从外部传入参数，用于设置 sleep 的时间。

**利用方式：**
攻击者需要控制应用程序的输入，使其能够调用 iconv 函数，并将字符串转换为 ISO-2022-CN-EXT 字符集。同时，攻击者还需要精心构造输入字符串，以便在溢出时覆盖关键内存区域，例如函数返回地址或其它重要的变量。搜索结果中的网页1提到“ This issue may allow an attacker to craft a malicious characters sequence that will trigger the out-of-bounds write and perform remote code execution.”

简单来说，利用方式如下：
1.  确定目标应用程序使用 iconv 函数进行字符集转换，且容易受到该漏洞的影响。
2.  构造恶意的输入字符串，触发溢出。
3.  控制溢出内容，覆盖目标内存区域，实现攻击目的，例如代码执行。

**项目地址:** [tnishiox/cve-2024-2961](https://github.com/tnishiox/cve-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---



---

## POC #11

**来源**: [CVE-2024-2961-tnishiox_cve-2024-2961.md](../2024/CVE-2024-2961-tnishiox_cve-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用程序崩溃或覆盖相邻变量，理论上可实现远程代码执行。

**影响版本:** < 2.40

**利用条件:** 需要应用程序使用 iconv 函数进行字符集转换，且目标字符集为 ISO-2022-CN-EXT。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 是 glibc 中 iconv 函数的一个缓冲区溢出漏洞。具体来说，当使用 iconv 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果输出缓冲区太小，可能会发生最多 4 字节的溢出。漏洞影响 glibc 2.39 及更早版本。

**有效性：**
提供的 POC 代码是一个简单的漏洞检测器，它尝试使用 iconv 函数将包含中文字符的字符串从 UTF-8 转换为 ISO-2022-CN-EXT。如果 `iconv` 返回值小于0，则说明系统存在漏洞。代码通过检查 `soutput` 的值来确定是否发生溢出。根据搜索结果，此漏洞确实存在可利用性。

**投毒风险：**
该仓库的代码非常简单，主要就是一个C文件和一个README。C文件仅仅实现了漏洞验证的功能，没有发现恶意代码。README 提供了漏洞相关信息的链接。因此，投毒风险非常低，大约为 1%。argv可以从外部传入参数，用于设置 sleep 的时间。

**利用方式：**
攻击者需要控制应用程序的输入，使其能够调用 iconv 函数，并将字符串转换为 ISO-2022-CN-EXT 字符集。同时，攻击者还需要精心构造输入字符串，以便在溢出时覆盖关键内存区域，例如函数返回地址或其它重要的变量。搜索结果中的网页1提到“ This issue may allow an attacker to craft a malicious characters sequence that will trigger the out-of-bounds write and perform remote code execution.”

简单来说，利用方式如下：
1.  确定目标应用程序使用 iconv 函数进行字符集转换，且容易受到该漏洞的影响。
2.  构造恶意的输入字符串，触发溢出。
3.  控制溢出内容，覆盖目标内存区域，实现攻击目的，例如代码执行。

**项目地址:** [tnishiox/cve-2024-2961](https://github.com/tnishiox/cve-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---



---

## POC #11

**来源**: [CVE-2024-2961-tnishiox_cve-2024-2961.md](../2024/CVE-2024-2961-tnishiox_cve-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用程序崩溃或覆盖相邻变量，理论上可实现远程代码执行。

**影响版本:** < 2.40

**利用条件:** 需要应用程序使用 iconv 函数进行字符集转换，且目标字符集为 ISO-2022-CN-EXT。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 是 glibc 中 iconv 函数的一个缓冲区溢出漏洞。具体来说，当使用 iconv 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果输出缓冲区太小，可能会发生最多 4 字节的溢出。漏洞影响 glibc 2.39 及更早版本。

**有效性：**
提供的 POC 代码是一个简单的漏洞检测器，它尝试使用 iconv 函数将包含中文字符的字符串从 UTF-8 转换为 ISO-2022-CN-EXT。如果 `iconv` 返回值小于0，则说明系统存在漏洞。代码通过检查 `soutput` 的值来确定是否发生溢出。根据搜索结果，此漏洞确实存在可利用性。

**投毒风险：**
该仓库的代码非常简单，主要就是一个C文件和一个README。C文件仅仅实现了漏洞验证的功能，没有发现恶意代码。README 提供了漏洞相关信息的链接。因此，投毒风险非常低，大约为 1%。argv可以从外部传入参数，用于设置 sleep 的时间。

**利用方式：**
攻击者需要控制应用程序的输入，使其能够调用 iconv 函数，并将字符串转换为 ISO-2022-CN-EXT 字符集。同时，攻击者还需要精心构造输入字符串，以便在溢出时覆盖关键内存区域，例如函数返回地址或其它重要的变量。搜索结果中的网页1提到“ This issue may allow an attacker to craft a malicious characters sequence that will trigger the out-of-bounds write and perform remote code execution.”

简单来说，利用方式如下：
1.  确定目标应用程序使用 iconv 函数进行字符集转换，且容易受到该漏洞的影响。
2.  构造恶意的输入字符串，触发溢出。
3.  控制溢出内容，覆盖目标内存区域，实现攻击目的，例如代码执行。

**项目地址:** [tnishiox/cve-2024-2961](https://github.com/tnishiox/cve-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---



---

## POC #11

**来源**: [CVE-2024-2961-tnishiox_cve-2024-2961.md](../2024/CVE-2024-2961-tnishiox_cve-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用程序崩溃或覆盖相邻变量，理论上可实现远程代码执行。

**影响版本:** < 2.40

**利用条件:** 需要应用程序使用 iconv 函数进行字符集转换，且目标字符集为 ISO-2022-CN-EXT。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 是 glibc 中 iconv 函数的一个缓冲区溢出漏洞。具体来说，当使用 iconv 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果输出缓冲区太小，可能会发生最多 4 字节的溢出。漏洞影响 glibc 2.39 及更早版本。

**有效性：**
提供的 POC 代码是一个简单的漏洞检测器，它尝试使用 iconv 函数将包含中文字符的字符串从 UTF-8 转换为 ISO-2022-CN-EXT。如果 `iconv` 返回值小于0，则说明系统存在漏洞。代码通过检查 `soutput` 的值来确定是否发生溢出。根据搜索结果，此漏洞确实存在可利用性。

**投毒风险：**
该仓库的代码非常简单，主要就是一个C文件和一个README。C文件仅仅实现了漏洞验证的功能，没有发现恶意代码。README 提供了漏洞相关信息的链接。因此，投毒风险非常低，大约为 1%。argv可以从外部传入参数，用于设置 sleep 的时间。

**利用方式：**
攻击者需要控制应用程序的输入，使其能够调用 iconv 函数，并将字符串转换为 ISO-2022-CN-EXT 字符集。同时，攻击者还需要精心构造输入字符串，以便在溢出时覆盖关键内存区域，例如函数返回地址或其它重要的变量。搜索结果中的网页1提到“ This issue may allow an attacker to craft a malicious characters sequence that will trigger the out-of-bounds write and perform remote code execution.”

简单来说，利用方式如下：
1.  确定目标应用程序使用 iconv 函数进行字符集转换，且容易受到该漏洞的影响。
2.  构造恶意的输入字符串，触发溢出。
3.  控制溢出内容，覆盖目标内存区域，实现攻击目的，例如代码执行。

**项目地址:** [tnishiox/cve-2024-2961](https://github.com/tnishiox/cve-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---



---

## POC #11

**来源**: [CVE-2024-2961-tnishiox_cve-2024-2961.md](../2024/CVE-2024-2961-tnishiox_cve-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用程序崩溃或覆盖相邻变量，理论上可实现远程代码执行。

**影响版本:** < 2.40

**利用条件:** 需要应用程序使用 iconv 函数进行字符集转换，且目标字符集为 ISO-2022-CN-EXT。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 是 glibc 中 iconv 函数的一个缓冲区溢出漏洞。具体来说，当使用 iconv 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果输出缓冲区太小，可能会发生最多 4 字节的溢出。漏洞影响 glibc 2.39 及更早版本。

**有效性：**
提供的 POC 代码是一个简单的漏洞检测器，它尝试使用 iconv 函数将包含中文字符的字符串从 UTF-8 转换为 ISO-2022-CN-EXT。如果 `iconv` 返回值小于0，则说明系统存在漏洞。代码通过检查 `soutput` 的值来确定是否发生溢出。根据搜索结果，此漏洞确实存在可利用性。

**投毒风险：**
该仓库的代码非常简单，主要就是一个C文件和一个README。C文件仅仅实现了漏洞验证的功能，没有发现恶意代码。README 提供了漏洞相关信息的链接。因此，投毒风险非常低，大约为 1%。argv可以从外部传入参数，用于设置 sleep 的时间。

**利用方式：**
攻击者需要控制应用程序的输入，使其能够调用 iconv 函数，并将字符串转换为 ISO-2022-CN-EXT 字符集。同时，攻击者还需要精心构造输入字符串，以便在溢出时覆盖关键内存区域，例如函数返回地址或其它重要的变量。搜索结果中的网页1提到“ This issue may allow an attacker to craft a malicious characters sequence that will trigger the out-of-bounds write and perform remote code execution.”

简单来说，利用方式如下：
1.  确定目标应用程序使用 iconv 函数进行字符集转换，且容易受到该漏洞的影响。
2.  构造恶意的输入字符串，触发溢出。
3.  控制溢出内容，覆盖目标内存区域，实现攻击目的，例如代码执行。

**项目地址:** [tnishiox/cve-2024-2961](https://github.com/tnishiox/cve-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---



---

## POC #11

**来源**: [CVE-2024-2961-tnishiox_cve-2024-2961.md](../2024/CVE-2024-2961-tnishiox_cve-2024-2961.md)

## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用程序崩溃或覆盖相邻变量，理论上可实现远程代码执行。

**影响版本:** < 2.40

**利用条件:** 需要应用程序使用 iconv 函数进行字符集转换，且目标字符集为 ISO-2022-CN-EXT。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 是 glibc 中 iconv 函数的一个缓冲区溢出漏洞。具体来说，当使用 iconv 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果输出缓冲区太小，可能会发生最多 4 字节的溢出。漏洞影响 glibc 2.39 及更早版本。

**有效性：**
提供的 POC 代码是一个简单的漏洞检测器，它尝试使用 iconv 函数将包含中文字符的字符串从 UTF-8 转换为 ISO-2022-CN-EXT。如果 `iconv` 返回值小于0，则说明系统存在漏洞。代码通过检查 `soutput` 的值来确定是否发生溢出。根据搜索结果，此漏洞确实存在可利用性。

**投毒风险：**
该仓库的代码非常简单，主要就是一个C文件和一个README。C文件仅仅实现了漏洞验证的功能，没有发现恶意代码。README 提供了漏洞相关信息的链接。因此，投毒风险非常低，大约为 1%。argv可以从外部传入参数，用于设置 sleep 的时间。

**利用方式：**
攻击者需要控制应用程序的输入，使其能够调用 iconv 函数，并将字符串转换为 ISO-2022-CN-EXT 字符集。同时，攻击者还需要精心构造输入字符串，以便在溢出时覆盖关键内存区域，例如函数返回地址或其它重要的变量。搜索结果中的网页1提到“ This issue may allow an attacker to craft a malicious characters sequence that will trigger the out-of-bounds write and perform remote code execution.”

简单来说，利用方式如下：
1.  确定目标应用程序使用 iconv 函数进行字符集转换，且容易受到该漏洞的影响。
2.  构造恶意的输入字符串，触发溢出。
3.  控制溢出内容，覆盖目标内存区域，实现攻击目的，例如代码执行。

**项目地址:** [tnishiox/cve-2024-2961](https://github.com/tnishiox/cve-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)

---

