# CVE-2024-37032

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-37032-Bi0x_CVE-2024-37032.md](../2024/CVE-2024-37032-Bi0x_CVE-2024-37032.md)

## CVE-2024-37032-Ollama-路径遍历

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件读取和写入，甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要Ollama服务运行，并能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Ollama 0.1.34之前的版本中，由于没有充分验证模型路径中的摘要格式（sha256哈希值），攻击者可以通过构造包含路径遍历字符（如`../`）的恶意摘要，来读取或写入Ollama服务器文件系统上的任意文件。攻击者可以搭建一个恶意的registry服务器，Ollama客户端在拉取模型时，由于没有正确校验，会去恶意registry上下载manifest文件，manifest文件中的digest包含路径遍历payload，从而造成任意文件读取或写入。POC代码提供了一个rogue registry server（`rogue_registry_server/server.py`）和利用脚本（`poc.py`）。利用脚本配置了恶意registry地址，并通过`pull`和`push`接口触发漏洞。恶意registry server的`fake_manifests`函数返回包含路径遍历payload的manifest文件。利用过程中，恶意服务器模拟了Ollama期望的响应头，以便进行路径遍历。通过修改`HOST`可以指定恶意registry服务器的地址。由于没有发现作者隐藏的payload代码段，因此投毒风险为0%。

**项目地址:** [Bi0x/CVE-2024-37032](https://github.com/Bi0x/CVE-2024-37032)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

## POC #2

**来源**: [CVE-2024-37032-ahboon_CVE-2024-37032-scanner.md](../2024/CVE-2024-37032-ahboon_CVE-2024-37032-scanner.md)

# CVE-2024-37032

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-37032-Bi0x_CVE-2024-37032.md](../2024/CVE-2024-37032-Bi0x_CVE-2024-37032.md)

## CVE-2024-37032-Ollama-路径遍历

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件读取和写入，甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要Ollama服务运行，并能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Ollama 0.1.34之前的版本中，由于没有充分验证模型路径中的摘要格式（sha256哈希值），攻击者可以通过构造包含路径遍历字符（如`../`）的恶意摘要，来读取或写入Ollama服务器文件系统上的任意文件。攻击者可以搭建一个恶意的registry服务器，Ollama客户端在拉取模型时，由于没有正确校验，会去恶意registry上下载manifest文件，manifest文件中的digest包含路径遍历payload，从而造成任意文件读取或写入。POC代码提供了一个rogue registry server（`rogue_registry_server/server.py`）和利用脚本（`poc.py`）。利用脚本配置了恶意registry地址，并通过`pull`和`push`接口触发漏洞。恶意registry server的`fake_manifests`函数返回包含路径遍历payload的manifest文件。利用过程中，恶意服务器模拟了Ollama期望的响应头，以便进行路径遍历。通过修改`HOST`可以指定恶意registry服务器的地址。由于没有发现作者隐藏的payload代码段，因此投毒风险为0%。

**项目地址:** [Bi0x/CVE-2024-37032](https://github.com/Bi0x/CVE-2024-37032)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

## POC #2

**来源**: [CVE-2024-37032-ahboon_CVE-2024-37032-scanner.md](../2024/CVE-2024-37032-ahboon_CVE-2024-37032-scanner.md)

# CVE-2024-37032

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-37032-Bi0x_CVE-2024-37032.md](../2024/CVE-2024-37032-Bi0x_CVE-2024-37032.md)

## CVE-2024-37032-Ollama-路径遍历

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件读取和写入，甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要Ollama服务运行，并能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Ollama 0.1.34之前的版本中，由于没有充分验证模型路径中的摘要格式（sha256哈希值），攻击者可以通过构造包含路径遍历字符（如`../`）的恶意摘要，来读取或写入Ollama服务器文件系统上的任意文件。攻击者可以搭建一个恶意的registry服务器，Ollama客户端在拉取模型时，由于没有正确校验，会去恶意registry上下载manifest文件，manifest文件中的digest包含路径遍历payload，从而造成任意文件读取或写入。POC代码提供了一个rogue registry server（`rogue_registry_server/server.py`）和利用脚本（`poc.py`）。利用脚本配置了恶意registry地址，并通过`pull`和`push`接口触发漏洞。恶意registry server的`fake_manifests`函数返回包含路径遍历payload的manifest文件。利用过程中，恶意服务器模拟了Ollama期望的响应头，以便进行路径遍历。通过修改`HOST`可以指定恶意registry服务器的地址。由于没有发现作者隐藏的payload代码段，因此投毒风险为0%。

**项目地址:** [Bi0x/CVE-2024-37032](https://github.com/Bi0x/CVE-2024-37032)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

## POC #2

**来源**: [CVE-2024-37032-ahboon_CVE-2024-37032-scanner.md](../2024/CVE-2024-37032-ahboon_CVE-2024-37032-scanner.md)

# CVE-2024-37032

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-37032-Bi0x_CVE-2024-37032.md](../2024/CVE-2024-37032-Bi0x_CVE-2024-37032.md)

## CVE-2024-37032-Ollama-路径遍历

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件读取和写入，甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要Ollama服务运行，并能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Ollama 0.1.34之前的版本中，由于没有充分验证模型路径中的摘要格式（sha256哈希值），攻击者可以通过构造包含路径遍历字符（如`../`）的恶意摘要，来读取或写入Ollama服务器文件系统上的任意文件。攻击者可以搭建一个恶意的registry服务器，Ollama客户端在拉取模型时，由于没有正确校验，会去恶意registry上下载manifest文件，manifest文件中的digest包含路径遍历payload，从而造成任意文件读取或写入。POC代码提供了一个rogue registry server（`rogue_registry_server/server.py`）和利用脚本（`poc.py`）。利用脚本配置了恶意registry地址，并通过`pull`和`push`接口触发漏洞。恶意registry server的`fake_manifests`函数返回包含路径遍历payload的manifest文件。利用过程中，恶意服务器模拟了Ollama期望的响应头，以便进行路径遍历。通过修改`HOST`可以指定恶意registry服务器的地址。由于没有发现作者隐藏的payload代码段，因此投毒风险为0%。

**项目地址:** [Bi0x/CVE-2024-37032](https://github.com/Bi0x/CVE-2024-37032)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

## POC #2

**来源**: [CVE-2024-37032-ahboon_CVE-2024-37032-scanner.md](../2024/CVE-2024-37032-ahboon_CVE-2024-37032-scanner.md)

# CVE-2024-37032

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-37032-Bi0x_CVE-2024-37032.md](../2024/CVE-2024-37032-Bi0x_CVE-2024-37032.md)

## CVE-2024-37032-Ollama-路径遍历

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件读取和写入，甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要Ollama服务运行，并能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Ollama 0.1.34之前的版本中，由于没有充分验证模型路径中的摘要格式（sha256哈希值），攻击者可以通过构造包含路径遍历字符（如`../`）的恶意摘要，来读取或写入Ollama服务器文件系统上的任意文件。攻击者可以搭建一个恶意的registry服务器，Ollama客户端在拉取模型时，由于没有正确校验，会去恶意registry上下载manifest文件，manifest文件中的digest包含路径遍历payload，从而造成任意文件读取或写入。POC代码提供了一个rogue registry server（`rogue_registry_server/server.py`）和利用脚本（`poc.py`）。利用脚本配置了恶意registry地址，并通过`pull`和`push`接口触发漏洞。恶意registry server的`fake_manifests`函数返回包含路径遍历payload的manifest文件。利用过程中，恶意服务器模拟了Ollama期望的响应头，以便进行路径遍历。通过修改`HOST`可以指定恶意registry服务器的地址。由于没有发现作者隐藏的payload代码段，因此投毒风险为0%。

**项目地址:** [Bi0x/CVE-2024-37032](https://github.com/Bi0x/CVE-2024-37032)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

## POC #2

**来源**: [CVE-2024-37032-ahboon_CVE-2024-37032-scanner.md](../2024/CVE-2024-37032-ahboon_CVE-2024-37032-scanner.md)

# CVE-2024-37032

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-37032-Bi0x_CVE-2024-37032.md](../2024/CVE-2024-37032-Bi0x_CVE-2024-37032.md)

## CVE-2024-37032-Ollama-路径遍历

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件读取和写入，甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要Ollama服务运行，并能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Ollama 0.1.34之前的版本中，由于没有充分验证模型路径中的摘要格式（sha256哈希值），攻击者可以通过构造包含路径遍历字符（如`../`）的恶意摘要，来读取或写入Ollama服务器文件系统上的任意文件。攻击者可以搭建一个恶意的registry服务器，Ollama客户端在拉取模型时，由于没有正确校验，会去恶意registry上下载manifest文件，manifest文件中的digest包含路径遍历payload，从而造成任意文件读取或写入。POC代码提供了一个rogue registry server（`rogue_registry_server/server.py`）和利用脚本（`poc.py`）。利用脚本配置了恶意registry地址，并通过`pull`和`push`接口触发漏洞。恶意registry server的`fake_manifests`函数返回包含路径遍历payload的manifest文件。利用过程中，恶意服务器模拟了Ollama期望的响应头，以便进行路径遍历。通过修改`HOST`可以指定恶意registry服务器的地址。由于没有发现作者隐藏的payload代码段，因此投毒风险为0%。

**项目地址:** [Bi0x/CVE-2024-37032](https://github.com/Bi0x/CVE-2024-37032)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

## POC #2

**来源**: [CVE-2024-37032-ahboon_CVE-2024-37032-scanner.md](../2024/CVE-2024-37032-ahboon_CVE-2024-37032-scanner.md)

# CVE-2024-37032

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-37032-Bi0x_CVE-2024-37032.md](../2024/CVE-2024-37032-Bi0x_CVE-2024-37032.md)

## CVE-2024-37032-Ollama-路径遍历

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件读取和写入，甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要Ollama服务运行，并能够通过网络访问该服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Ollama 0.1.34之前的版本中，由于没有充分验证模型路径中的摘要格式（sha256哈希值），攻击者可以通过构造包含路径遍历字符（如`../`）的恶意摘要，来读取或写入Ollama服务器文件系统上的任意文件。攻击者可以搭建一个恶意的registry服务器，Ollama客户端在拉取模型时，由于没有正确校验，会去恶意registry上下载manifest文件，manifest文件中的digest包含路径遍历payload，从而造成任意文件读取或写入。POC代码提供了一个rogue registry server（`rogue_registry_server/server.py`）和利用脚本（`poc.py`）。利用脚本配置了恶意registry地址，并通过`pull`和`push`接口触发漏洞。恶意registry server的`fake_manifests`函数返回包含路径遍历payload的manifest文件。利用过程中，恶意服务器模拟了Ollama期望的响应头，以便进行路径遍历。通过修改`HOST`可以指定恶意registry服务器的地址。由于没有发现作者隐藏的payload代码段，因此投毒风险为0%。

**项目地址:** [Bi0x/CVE-2024-37032](https://github.com/Bi0x/CVE-2024-37032)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

## POC #2

**来源**: [CVE-2024-37032-ahboon_CVE-2024-37032-scanner.md](../2024/CVE-2024-37032-ahboon_CVE-2024-37032-scanner.md)

## CVE-2024-37032 - Ollama Path Traversal

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历/远程代码执行 (RCE)

**影响应用:** Ollama

**危害等级:** 高危，可能导致文件读取、写入甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要低权限用户能访问 Ollama API 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-37032 是 Ollama 0.1.34 之前版本中的一个路径遍历漏洞。漏洞原因是 Ollama 在处理模型路径时，没有充分验证摘要（SHA256）的格式。攻击者可以构造包含路径遍历字符（如`../`）的恶意摘要，从而绕过访问控制，读取或写入服务器上的任意文件。由于 Ollama 经常用于执行机器学习模型，写入任意文件可能会导致 RCE。

**利用方式：**

1.  攻击者需要构造包含恶意路径的摘要。例如，`../` 可以用来跳出模型目录，访问其他敏感文件或目录。
2.  然后，攻击者使用这个恶意摘要来请求模型路径。由于 Ollama 没有正确验证摘要格式，路径遍历攻击将成功。
3.  根据具体的利用方式，攻击者可以读取敏感文件，覆盖配置文件，或者上传恶意代码到服务器上，从而实现远程代码执行。

**有效性评估：**

提供的 Python 脚本 (`CVE-2024-37032-scan.py`) 并非利用代码，而是漏洞扫描器。 它通过检查 `/api/version` 接口返回的版本号来判断 Ollama 实例是否易受攻击。如果版本号低于 0.1.34，则认为存在漏洞。这个脚本的有效性取决于 Ollama 实例是否开启了 API 接口，并且能够正确返回版本信息。

**投毒风险评估：**

分析了提供的 `CVE-2024-37032-scan.py` 和 `README.md` 文件。该扫描器本身不包含任何恶意代码。它只是用于检测指定子网中是否存在存在漏洞的 Ollama 服务。投毒风险为 0%。如果存在恶意利用代码，投毒风险评估需要重新考虑，重点关注利用代码是否会篡改系统配置，植入后门程序等。

**项目地址:** [ahboon/CVE-2024-37032-scanner](https://github.com/ahboon/CVE-2024-37032-scanner)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

## POC #3

**来源**: [CVE-2024-37032-pankass_CVE-2024-37032_CVE-2024-45436.md](../2024/CVE-2024-37032-pankass_CVE-2024-37032_CVE-2024-45436.md)

## CVE-2024-37032 Ollama 路径遍历导致RCE

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Ollama

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要Ollama服务运行且攻击者能够发送HTTP请求到Ollama服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Ollama 0.1.34之前的版本中。由于Ollama没有充分验证模型路径中的摘要格式（sha256哈希值，应为64位十六进制数字），攻击者可以利用路径遍历漏洞，通过构造恶意的模型路径，上传包含恶意payload的zip文件到服务器的任意位置。该POC通过以下步骤实现RCE：

1.  **生成恶意动态链接库（hook.so）：**  使用gcc编译包含反弹shell命令的C代码，生成一个动态链接库文件。这段C代码使用`__attribute__((constructor))`来确保在库加载时执行。它会删除`/etc/ld.so.preload`和`/tmp/hook.so`，然后执行攻击者提供的反弹shell命令。
2.  **生成恶意ZIP文件（evil.zip）：**  创建一个ZIP文件，其中包含两个文件：
    *   `/etc/ld.so.preload`：包含`/tmp/hook.so`，用于预加载恶意动态链接库。
    *   `/tmp/hook.so`：包含编译后的恶意动态链接库。
    ZIP文件中的路径使用了`../../../../../../../../..`来进行路径遍历，目的是覆盖系统中的`/etc/ld.so.preload`文件，并将恶意的hook.so文件放置到`/tmp`目录下。
3.  **上传恶意BLOB：**  计算evil.zip文件的SHA256哈希值，并使用该哈希值作为文件名，将evil.zip文件上传到Ollama服务器的`/api/blobs`端点。
4.  **创建模型：**  使用之前上传的BLOB的哈希值，通过构造一个包含`FROM /root/.ollama/models/blobs/{blob_sha256}`的modelfile，向`/api/create`端点发送POST请求，创建一个新的模型。
5.  **触发执行：**  通过向`/api/embeddings`发送POST请求，并设置`model`为`all-minilm:22m`（或其他模型），触发Ollama加载该模型。由于`/etc/ld.so.preload`已被修改，系统在加载任何新的动态链接库时都会先加载`/tmp/hook.so`，从而执行恶意代码，反弹shell。

**投毒风险分析：**
代码功能明确，主要用于利用漏洞，没有发现额外的恶意行为，因此投毒风险评估为0%。

**项目地址:** [pankass/CVE-2024-37032_CVE-2024-45436](https://github.com/pankass/CVE-2024-37032_CVE-2024-45436)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

## POC #4

**来源**: [CVE-2024-37032-stuxbench_vllm-cve-2024-37032.md](../2024/CVE-2024-37032-stuxbench_vllm-cve-2024-37032.md)

## CVE-2024-37032-Ollama-路径遍历

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件读取甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要能够向 Ollama 服务器发送请求，权限要求较低（低权限用户即可触发）

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2024-37032是Ollama中存在的一个路径遍历漏洞，具体原因是Ollama在处理模型路径时，没有充分验证digest的格式（预期为64位十六进制的sha256值）。这使得攻击者可以构造恶意的digest，包含例如"../"这样的路径遍历序列，从而访问受限目录之外的文件。

**有效性评估：**

根据提供的漏洞信息，POC代码并不直接可用。漏洞信息提及了包含`modelpath_test.go`的修复commit，表明存在测试用例可以触发和验证该漏洞。Vicarius的文章提供了更详细的漏洞分析。但是，提供的代码是构建vLLM容器的Dockerfile和一些脚本，与Ollama漏洞本身无关，因此无法直接验证CVE-2024-37032。

**投毒风险评估：**

提供的Dockerfile和相关脚本的目的是为了构建一个包含vLLM（一个快速的LLM推理库）的Docker镜像。这些文件本身看起来是安全的，目的是自动化构建和部署vLLM，没有发现任何恶意代码或后门。

因此，投毒风险很低。这里评估为0%。

**利用方式分析：**

1.  **构造恶意模型digest：** 攻击者需要能够向Ollama服务器发送请求，其中包含用于指定模型路径的digest参数。
2.  **路径遍历：** 将digest设置为包含路径遍历序列的值，例如`../`，目的是逃逸出预期的模型存储目录。
3.  **访问敏感文件/RCE：** 成功利用路径遍历后，攻击者可能能够读取服务器上的任意文件（如果Ollama进程具有相应的权限），或者结合其他漏洞实现远程代码执行。

由于Ollama在处理请求时会使用该digest构建文件路径，不充分的验证允许攻击者控制路径的一部分，从而访问到不应该访问的文件或目录。该漏洞CVSS评分为8.8，说明其潜在危害较大。

**项目地址:** [stuxbench/vllm-cve-2024-37032](https://github.com/stuxbench/vllm-cve-2024-37032)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---



---

## POC #3

**来源**: [CVE-2024-37032-pankass_CVE-2024-37032_CVE-2024-45436.md](../2024/CVE-2024-37032-pankass_CVE-2024-37032_CVE-2024-45436.md)

## CVE-2024-37032 Ollama 路径遍历导致RCE

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Ollama

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要Ollama服务运行且攻击者能够发送HTTP请求到Ollama服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Ollama 0.1.34之前的版本中。由于Ollama没有充分验证模型路径中的摘要格式（sha256哈希值，应为64位十六进制数字），攻击者可以利用路径遍历漏洞，通过构造恶意的模型路径，上传包含恶意payload的zip文件到服务器的任意位置。该POC通过以下步骤实现RCE：

1.  **生成恶意动态链接库（hook.so）：**  使用gcc编译包含反弹shell命令的C代码，生成一个动态链接库文件。这段C代码使用`__attribute__((constructor))`来确保在库加载时执行。它会删除`/etc/ld.so.preload`和`/tmp/hook.so`，然后执行攻击者提供的反弹shell命令。
2.  **生成恶意ZIP文件（evil.zip）：**  创建一个ZIP文件，其中包含两个文件：
    *   `/etc/ld.so.preload`：包含`/tmp/hook.so`，用于预加载恶意动态链接库。
    *   `/tmp/hook.so`：包含编译后的恶意动态链接库。
    ZIP文件中的路径使用了`../../../../../../../../..`来进行路径遍历，目的是覆盖系统中的`/etc/ld.so.preload`文件，并将恶意的hook.so文件放置到`/tmp`目录下。
3.  **上传恶意BLOB：**  计算evil.zip文件的SHA256哈希值，并使用该哈希值作为文件名，将evil.zip文件上传到Ollama服务器的`/api/blobs`端点。
4.  **创建模型：**  使用之前上传的BLOB的哈希值，通过构造一个包含`FROM /root/.ollama/models/blobs/{blob_sha256}`的modelfile，向`/api/create`端点发送POST请求，创建一个新的模型。
5.  **触发执行：**  通过向`/api/embeddings`发送POST请求，并设置`model`为`all-minilm:22m`（或其他模型），触发Ollama加载该模型。由于`/etc/ld.so.preload`已被修改，系统在加载任何新的动态链接库时都会先加载`/tmp/hook.so`，从而执行恶意代码，反弹shell。

**投毒风险分析：**
代码功能明确，主要用于利用漏洞，没有发现额外的恶意行为，因此投毒风险评估为0%。

**项目地址:** [pankass/CVE-2024-37032_CVE-2024-45436](https://github.com/pankass/CVE-2024-37032_CVE-2024-45436)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

## POC #4

**来源**: [CVE-2024-37032-stuxbench_vllm-cve-2024-37032.md](../2024/CVE-2024-37032-stuxbench_vllm-cve-2024-37032.md)

## CVE-2024-37032-Ollama-路径遍历

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件读取甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要能够向 Ollama 服务器发送请求，权限要求较低（低权限用户即可触发）

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2024-37032是Ollama中存在的一个路径遍历漏洞，具体原因是Ollama在处理模型路径时，没有充分验证digest的格式（预期为64位十六进制的sha256值）。这使得攻击者可以构造恶意的digest，包含例如"../"这样的路径遍历序列，从而访问受限目录之外的文件。

**有效性评估：**

根据提供的漏洞信息，POC代码并不直接可用。漏洞信息提及了包含`modelpath_test.go`的修复commit，表明存在测试用例可以触发和验证该漏洞。Vicarius的文章提供了更详细的漏洞分析。但是，提供的代码是构建vLLM容器的Dockerfile和一些脚本，与Ollama漏洞本身无关，因此无法直接验证CVE-2024-37032。

**投毒风险评估：**

提供的Dockerfile和相关脚本的目的是为了构建一个包含vLLM（一个快速的LLM推理库）的Docker镜像。这些文件本身看起来是安全的，目的是自动化构建和部署vLLM，没有发现任何恶意代码或后门。

因此，投毒风险很低。这里评估为0%。

**利用方式分析：**

1.  **构造恶意模型digest：** 攻击者需要能够向Ollama服务器发送请求，其中包含用于指定模型路径的digest参数。
2.  **路径遍历：** 将digest设置为包含路径遍历序列的值，例如`../`，目的是逃逸出预期的模型存储目录。
3.  **访问敏感文件/RCE：** 成功利用路径遍历后，攻击者可能能够读取服务器上的任意文件（如果Ollama进程具有相应的权限），或者结合其他漏洞实现远程代码执行。

由于Ollama在处理请求时会使用该digest构建文件路径，不充分的验证允许攻击者控制路径的一部分，从而访问到不应该访问的文件或目录。该漏洞CVSS评分为8.8，说明其潜在危害较大。

**项目地址:** [stuxbench/vllm-cve-2024-37032](https://github.com/stuxbench/vllm-cve-2024-37032)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---



---

## POC #3

**来源**: [CVE-2024-37032-pankass_CVE-2024-37032_CVE-2024-45436.md](../2024/CVE-2024-37032-pankass_CVE-2024-37032_CVE-2024-45436.md)

## CVE-2024-37032 Ollama 路径遍历导致RCE

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Ollama

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要Ollama服务运行且攻击者能够发送HTTP请求到Ollama服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Ollama 0.1.34之前的版本中。由于Ollama没有充分验证模型路径中的摘要格式（sha256哈希值，应为64位十六进制数字），攻击者可以利用路径遍历漏洞，通过构造恶意的模型路径，上传包含恶意payload的zip文件到服务器的任意位置。该POC通过以下步骤实现RCE：

1.  **生成恶意动态链接库（hook.so）：**  使用gcc编译包含反弹shell命令的C代码，生成一个动态链接库文件。这段C代码使用`__attribute__((constructor))`来确保在库加载时执行。它会删除`/etc/ld.so.preload`和`/tmp/hook.so`，然后执行攻击者提供的反弹shell命令。
2.  **生成恶意ZIP文件（evil.zip）：**  创建一个ZIP文件，其中包含两个文件：
    *   `/etc/ld.so.preload`：包含`/tmp/hook.so`，用于预加载恶意动态链接库。
    *   `/tmp/hook.so`：包含编译后的恶意动态链接库。
    ZIP文件中的路径使用了`../../../../../../../../..`来进行路径遍历，目的是覆盖系统中的`/etc/ld.so.preload`文件，并将恶意的hook.so文件放置到`/tmp`目录下。
3.  **上传恶意BLOB：**  计算evil.zip文件的SHA256哈希值，并使用该哈希值作为文件名，将evil.zip文件上传到Ollama服务器的`/api/blobs`端点。
4.  **创建模型：**  使用之前上传的BLOB的哈希值，通过构造一个包含`FROM /root/.ollama/models/blobs/{blob_sha256}`的modelfile，向`/api/create`端点发送POST请求，创建一个新的模型。
5.  **触发执行：**  通过向`/api/embeddings`发送POST请求，并设置`model`为`all-minilm:22m`（或其他模型），触发Ollama加载该模型。由于`/etc/ld.so.preload`已被修改，系统在加载任何新的动态链接库时都会先加载`/tmp/hook.so`，从而执行恶意代码，反弹shell。

**投毒风险分析：**
代码功能明确，主要用于利用漏洞，没有发现额外的恶意行为，因此投毒风险评估为0%。

**项目地址:** [pankass/CVE-2024-37032_CVE-2024-45436](https://github.com/pankass/CVE-2024-37032_CVE-2024-45436)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

## POC #4

**来源**: [CVE-2024-37032-stuxbench_vllm-cve-2024-37032.md](../2024/CVE-2024-37032-stuxbench_vllm-cve-2024-37032.md)

## CVE-2024-37032-Ollama-路径遍历

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件读取甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要能够向 Ollama 服务器发送请求，权限要求较低（低权限用户即可触发）

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2024-37032是Ollama中存在的一个路径遍历漏洞，具体原因是Ollama在处理模型路径时，没有充分验证digest的格式（预期为64位十六进制的sha256值）。这使得攻击者可以构造恶意的digest，包含例如"../"这样的路径遍历序列，从而访问受限目录之外的文件。

**有效性评估：**

根据提供的漏洞信息，POC代码并不直接可用。漏洞信息提及了包含`modelpath_test.go`的修复commit，表明存在测试用例可以触发和验证该漏洞。Vicarius的文章提供了更详细的漏洞分析。但是，提供的代码是构建vLLM容器的Dockerfile和一些脚本，与Ollama漏洞本身无关，因此无法直接验证CVE-2024-37032。

**投毒风险评估：**

提供的Dockerfile和相关脚本的目的是为了构建一个包含vLLM（一个快速的LLM推理库）的Docker镜像。这些文件本身看起来是安全的，目的是自动化构建和部署vLLM，没有发现任何恶意代码或后门。

因此，投毒风险很低。这里评估为0%。

**利用方式分析：**

1.  **构造恶意模型digest：** 攻击者需要能够向Ollama服务器发送请求，其中包含用于指定模型路径的digest参数。
2.  **路径遍历：** 将digest设置为包含路径遍历序列的值，例如`../`，目的是逃逸出预期的模型存储目录。
3.  **访问敏感文件/RCE：** 成功利用路径遍历后，攻击者可能能够读取服务器上的任意文件（如果Ollama进程具有相应的权限），或者结合其他漏洞实现远程代码执行。

由于Ollama在处理请求时会使用该digest构建文件路径，不充分的验证允许攻击者控制路径的一部分，从而访问到不应该访问的文件或目录。该漏洞CVSS评分为8.8，说明其潜在危害较大。

**项目地址:** [stuxbench/vllm-cve-2024-37032](https://github.com/stuxbench/vllm-cve-2024-37032)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---



---

## POC #3

**来源**: [CVE-2024-37032-pankass_CVE-2024-37032_CVE-2024-45436.md](../2024/CVE-2024-37032-pankass_CVE-2024-37032_CVE-2024-45436.md)

## CVE-2024-37032 Ollama 路径遍历导致RCE

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Ollama

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要Ollama服务运行且攻击者能够发送HTTP请求到Ollama服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Ollama 0.1.34之前的版本中。由于Ollama没有充分验证模型路径中的摘要格式（sha256哈希值，应为64位十六进制数字），攻击者可以利用路径遍历漏洞，通过构造恶意的模型路径，上传包含恶意payload的zip文件到服务器的任意位置。该POC通过以下步骤实现RCE：

1.  **生成恶意动态链接库（hook.so）：**  使用gcc编译包含反弹shell命令的C代码，生成一个动态链接库文件。这段C代码使用`__attribute__((constructor))`来确保在库加载时执行。它会删除`/etc/ld.so.preload`和`/tmp/hook.so`，然后执行攻击者提供的反弹shell命令。
2.  **生成恶意ZIP文件（evil.zip）：**  创建一个ZIP文件，其中包含两个文件：
    *   `/etc/ld.so.preload`：包含`/tmp/hook.so`，用于预加载恶意动态链接库。
    *   `/tmp/hook.so`：包含编译后的恶意动态链接库。
    ZIP文件中的路径使用了`../../../../../../../../..`来进行路径遍历，目的是覆盖系统中的`/etc/ld.so.preload`文件，并将恶意的hook.so文件放置到`/tmp`目录下。
3.  **上传恶意BLOB：**  计算evil.zip文件的SHA256哈希值，并使用该哈希值作为文件名，将evil.zip文件上传到Ollama服务器的`/api/blobs`端点。
4.  **创建模型：**  使用之前上传的BLOB的哈希值，通过构造一个包含`FROM /root/.ollama/models/blobs/{blob_sha256}`的modelfile，向`/api/create`端点发送POST请求，创建一个新的模型。
5.  **触发执行：**  通过向`/api/embeddings`发送POST请求，并设置`model`为`all-minilm:22m`（或其他模型），触发Ollama加载该模型。由于`/etc/ld.so.preload`已被修改，系统在加载任何新的动态链接库时都会先加载`/tmp/hook.so`，从而执行恶意代码，反弹shell。

**投毒风险分析：**
代码功能明确，主要用于利用漏洞，没有发现额外的恶意行为，因此投毒风险评估为0%。

**项目地址:** [pankass/CVE-2024-37032_CVE-2024-45436](https://github.com/pankass/CVE-2024-37032_CVE-2024-45436)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

## POC #4

**来源**: [CVE-2024-37032-stuxbench_vllm-cve-2024-37032.md](../2024/CVE-2024-37032-stuxbench_vllm-cve-2024-37032.md)

## CVE-2024-37032-Ollama-路径遍历

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件读取甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要能够向 Ollama 服务器发送请求，权限要求较低（低权限用户即可触发）

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2024-37032是Ollama中存在的一个路径遍历漏洞，具体原因是Ollama在处理模型路径时，没有充分验证digest的格式（预期为64位十六进制的sha256值）。这使得攻击者可以构造恶意的digest，包含例如"../"这样的路径遍历序列，从而访问受限目录之外的文件。

**有效性评估：**

根据提供的漏洞信息，POC代码并不直接可用。漏洞信息提及了包含`modelpath_test.go`的修复commit，表明存在测试用例可以触发和验证该漏洞。Vicarius的文章提供了更详细的漏洞分析。但是，提供的代码是构建vLLM容器的Dockerfile和一些脚本，与Ollama漏洞本身无关，因此无法直接验证CVE-2024-37032。

**投毒风险评估：**

提供的Dockerfile和相关脚本的目的是为了构建一个包含vLLM（一个快速的LLM推理库）的Docker镜像。这些文件本身看起来是安全的，目的是自动化构建和部署vLLM，没有发现任何恶意代码或后门。

因此，投毒风险很低。这里评估为0%。

**利用方式分析：**

1.  **构造恶意模型digest：** 攻击者需要能够向Ollama服务器发送请求，其中包含用于指定模型路径的digest参数。
2.  **路径遍历：** 将digest设置为包含路径遍历序列的值，例如`../`，目的是逃逸出预期的模型存储目录。
3.  **访问敏感文件/RCE：** 成功利用路径遍历后，攻击者可能能够读取服务器上的任意文件（如果Ollama进程具有相应的权限），或者结合其他漏洞实现远程代码执行。

由于Ollama在处理请求时会使用该digest构建文件路径，不充分的验证允许攻击者控制路径的一部分，从而访问到不应该访问的文件或目录。该漏洞CVSS评分为8.8，说明其潜在危害较大。

**项目地址:** [stuxbench/vllm-cve-2024-37032](https://github.com/stuxbench/vllm-cve-2024-37032)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---



---

## POC #3

**来源**: [CVE-2024-37032-pankass_CVE-2024-37032_CVE-2024-45436.md](../2024/CVE-2024-37032-pankass_CVE-2024-37032_CVE-2024-45436.md)

## CVE-2024-37032 Ollama 路径遍历导致RCE

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Ollama

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要Ollama服务运行且攻击者能够发送HTTP请求到Ollama服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Ollama 0.1.34之前的版本中。由于Ollama没有充分验证模型路径中的摘要格式（sha256哈希值，应为64位十六进制数字），攻击者可以利用路径遍历漏洞，通过构造恶意的模型路径，上传包含恶意payload的zip文件到服务器的任意位置。该POC通过以下步骤实现RCE：

1.  **生成恶意动态链接库（hook.so）：**  使用gcc编译包含反弹shell命令的C代码，生成一个动态链接库文件。这段C代码使用`__attribute__((constructor))`来确保在库加载时执行。它会删除`/etc/ld.so.preload`和`/tmp/hook.so`，然后执行攻击者提供的反弹shell命令。
2.  **生成恶意ZIP文件（evil.zip）：**  创建一个ZIP文件，其中包含两个文件：
    *   `/etc/ld.so.preload`：包含`/tmp/hook.so`，用于预加载恶意动态链接库。
    *   `/tmp/hook.so`：包含编译后的恶意动态链接库。
    ZIP文件中的路径使用了`../../../../../../../../..`来进行路径遍历，目的是覆盖系统中的`/etc/ld.so.preload`文件，并将恶意的hook.so文件放置到`/tmp`目录下。
3.  **上传恶意BLOB：**  计算evil.zip文件的SHA256哈希值，并使用该哈希值作为文件名，将evil.zip文件上传到Ollama服务器的`/api/blobs`端点。
4.  **创建模型：**  使用之前上传的BLOB的哈希值，通过构造一个包含`FROM /root/.ollama/models/blobs/{blob_sha256}`的modelfile，向`/api/create`端点发送POST请求，创建一个新的模型。
5.  **触发执行：**  通过向`/api/embeddings`发送POST请求，并设置`model`为`all-minilm:22m`（或其他模型），触发Ollama加载该模型。由于`/etc/ld.so.preload`已被修改，系统在加载任何新的动态链接库时都会先加载`/tmp/hook.so`，从而执行恶意代码，反弹shell。

**投毒风险分析：**
代码功能明确，主要用于利用漏洞，没有发现额外的恶意行为，因此投毒风险评估为0%。

**项目地址:** [pankass/CVE-2024-37032_CVE-2024-45436](https://github.com/pankass/CVE-2024-37032_CVE-2024-45436)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

## POC #4

**来源**: [CVE-2024-37032-stuxbench_vllm-cve-2024-37032.md](../2024/CVE-2024-37032-stuxbench_vllm-cve-2024-37032.md)

## CVE-2024-37032-Ollama-路径遍历

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件读取甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要能够向 Ollama 服务器发送请求，权限要求较低（低权限用户即可触发）

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2024-37032是Ollama中存在的一个路径遍历漏洞，具体原因是Ollama在处理模型路径时，没有充分验证digest的格式（预期为64位十六进制的sha256值）。这使得攻击者可以构造恶意的digest，包含例如"../"这样的路径遍历序列，从而访问受限目录之外的文件。

**有效性评估：**

根据提供的漏洞信息，POC代码并不直接可用。漏洞信息提及了包含`modelpath_test.go`的修复commit，表明存在测试用例可以触发和验证该漏洞。Vicarius的文章提供了更详细的漏洞分析。但是，提供的代码是构建vLLM容器的Dockerfile和一些脚本，与Ollama漏洞本身无关，因此无法直接验证CVE-2024-37032。

**投毒风险评估：**

提供的Dockerfile和相关脚本的目的是为了构建一个包含vLLM（一个快速的LLM推理库）的Docker镜像。这些文件本身看起来是安全的，目的是自动化构建和部署vLLM，没有发现任何恶意代码或后门。

因此，投毒风险很低。这里评估为0%。

**利用方式分析：**

1.  **构造恶意模型digest：** 攻击者需要能够向Ollama服务器发送请求，其中包含用于指定模型路径的digest参数。
2.  **路径遍历：** 将digest设置为包含路径遍历序列的值，例如`../`，目的是逃逸出预期的模型存储目录。
3.  **访问敏感文件/RCE：** 成功利用路径遍历后，攻击者可能能够读取服务器上的任意文件（如果Ollama进程具有相应的权限），或者结合其他漏洞实现远程代码执行。

由于Ollama在处理请求时会使用该digest构建文件路径，不充分的验证允许攻击者控制路径的一部分，从而访问到不应该访问的文件或目录。该漏洞CVSS评分为8.8，说明其潜在危害较大。

**项目地址:** [stuxbench/vllm-cve-2024-37032](https://github.com/stuxbench/vllm-cve-2024-37032)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---



---

## POC #3

**来源**: [CVE-2024-37032-pankass_CVE-2024-37032_CVE-2024-45436.md](../2024/CVE-2024-37032-pankass_CVE-2024-37032_CVE-2024-45436.md)

## CVE-2024-37032 Ollama 路径遍历导致RCE

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Ollama

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要Ollama服务运行且攻击者能够发送HTTP请求到Ollama服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Ollama 0.1.34之前的版本中。由于Ollama没有充分验证模型路径中的摘要格式（sha256哈希值，应为64位十六进制数字），攻击者可以利用路径遍历漏洞，通过构造恶意的模型路径，上传包含恶意payload的zip文件到服务器的任意位置。该POC通过以下步骤实现RCE：

1.  **生成恶意动态链接库（hook.so）：**  使用gcc编译包含反弹shell命令的C代码，生成一个动态链接库文件。这段C代码使用`__attribute__((constructor))`来确保在库加载时执行。它会删除`/etc/ld.so.preload`和`/tmp/hook.so`，然后执行攻击者提供的反弹shell命令。
2.  **生成恶意ZIP文件（evil.zip）：**  创建一个ZIP文件，其中包含两个文件：
    *   `/etc/ld.so.preload`：包含`/tmp/hook.so`，用于预加载恶意动态链接库。
    *   `/tmp/hook.so`：包含编译后的恶意动态链接库。
    ZIP文件中的路径使用了`../../../../../../../../..`来进行路径遍历，目的是覆盖系统中的`/etc/ld.so.preload`文件，并将恶意的hook.so文件放置到`/tmp`目录下。
3.  **上传恶意BLOB：**  计算evil.zip文件的SHA256哈希值，并使用该哈希值作为文件名，将evil.zip文件上传到Ollama服务器的`/api/blobs`端点。
4.  **创建模型：**  使用之前上传的BLOB的哈希值，通过构造一个包含`FROM /root/.ollama/models/blobs/{blob_sha256}`的modelfile，向`/api/create`端点发送POST请求，创建一个新的模型。
5.  **触发执行：**  通过向`/api/embeddings`发送POST请求，并设置`model`为`all-minilm:22m`（或其他模型），触发Ollama加载该模型。由于`/etc/ld.so.preload`已被修改，系统在加载任何新的动态链接库时都会先加载`/tmp/hook.so`，从而执行恶意代码，反弹shell。

**投毒风险分析：**
代码功能明确，主要用于利用漏洞，没有发现额外的恶意行为，因此投毒风险评估为0%。

**项目地址:** [pankass/CVE-2024-37032_CVE-2024-45436](https://github.com/pankass/CVE-2024-37032_CVE-2024-45436)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

## POC #4

**来源**: [CVE-2024-37032-stuxbench_vllm-cve-2024-37032.md](../2024/CVE-2024-37032-stuxbench_vllm-cve-2024-37032.md)

## CVE-2024-37032-Ollama-路径遍历

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件读取甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要能够向 Ollama 服务器发送请求，权限要求较低（低权限用户即可触发）

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2024-37032是Ollama中存在的一个路径遍历漏洞，具体原因是Ollama在处理模型路径时，没有充分验证digest的格式（预期为64位十六进制的sha256值）。这使得攻击者可以构造恶意的digest，包含例如"../"这样的路径遍历序列，从而访问受限目录之外的文件。

**有效性评估：**

根据提供的漏洞信息，POC代码并不直接可用。漏洞信息提及了包含`modelpath_test.go`的修复commit，表明存在测试用例可以触发和验证该漏洞。Vicarius的文章提供了更详细的漏洞分析。但是，提供的代码是构建vLLM容器的Dockerfile和一些脚本，与Ollama漏洞本身无关，因此无法直接验证CVE-2024-37032。

**投毒风险评估：**

提供的Dockerfile和相关脚本的目的是为了构建一个包含vLLM（一个快速的LLM推理库）的Docker镜像。这些文件本身看起来是安全的，目的是自动化构建和部署vLLM，没有发现任何恶意代码或后门。

因此，投毒风险很低。这里评估为0%。

**利用方式分析：**

1.  **构造恶意模型digest：** 攻击者需要能够向Ollama服务器发送请求，其中包含用于指定模型路径的digest参数。
2.  **路径遍历：** 将digest设置为包含路径遍历序列的值，例如`../`，目的是逃逸出预期的模型存储目录。
3.  **访问敏感文件/RCE：** 成功利用路径遍历后，攻击者可能能够读取服务器上的任意文件（如果Ollama进程具有相应的权限），或者结合其他漏洞实现远程代码执行。

由于Ollama在处理请求时会使用该digest构建文件路径，不充分的验证允许攻击者控制路径的一部分，从而访问到不应该访问的文件或目录。该漏洞CVSS评分为8.8，说明其潜在危害较大。

**项目地址:** [stuxbench/vllm-cve-2024-37032](https://github.com/stuxbench/vllm-cve-2024-37032)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---



---

## POC #3

**来源**: [CVE-2024-37032-pankass_CVE-2024-37032_CVE-2024-45436.md](../2024/CVE-2024-37032-pankass_CVE-2024-37032_CVE-2024-45436.md)

## CVE-2024-37032 Ollama 路径遍历导致RCE

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Ollama

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要Ollama服务运行且攻击者能够发送HTTP请求到Ollama服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Ollama 0.1.34之前的版本中。由于Ollama没有充分验证模型路径中的摘要格式（sha256哈希值，应为64位十六进制数字），攻击者可以利用路径遍历漏洞，通过构造恶意的模型路径，上传包含恶意payload的zip文件到服务器的任意位置。该POC通过以下步骤实现RCE：

1.  **生成恶意动态链接库（hook.so）：**  使用gcc编译包含反弹shell命令的C代码，生成一个动态链接库文件。这段C代码使用`__attribute__((constructor))`来确保在库加载时执行。它会删除`/etc/ld.so.preload`和`/tmp/hook.so`，然后执行攻击者提供的反弹shell命令。
2.  **生成恶意ZIP文件（evil.zip）：**  创建一个ZIP文件，其中包含两个文件：
    *   `/etc/ld.so.preload`：包含`/tmp/hook.so`，用于预加载恶意动态链接库。
    *   `/tmp/hook.so`：包含编译后的恶意动态链接库。
    ZIP文件中的路径使用了`../../../../../../../../..`来进行路径遍历，目的是覆盖系统中的`/etc/ld.so.preload`文件，并将恶意的hook.so文件放置到`/tmp`目录下。
3.  **上传恶意BLOB：**  计算evil.zip文件的SHA256哈希值，并使用该哈希值作为文件名，将evil.zip文件上传到Ollama服务器的`/api/blobs`端点。
4.  **创建模型：**  使用之前上传的BLOB的哈希值，通过构造一个包含`FROM /root/.ollama/models/blobs/{blob_sha256}`的modelfile，向`/api/create`端点发送POST请求，创建一个新的模型。
5.  **触发执行：**  通过向`/api/embeddings`发送POST请求，并设置`model`为`all-minilm:22m`（或其他模型），触发Ollama加载该模型。由于`/etc/ld.so.preload`已被修改，系统在加载任何新的动态链接库时都会先加载`/tmp/hook.so`，从而执行恶意代码，反弹shell。

**投毒风险分析：**
代码功能明确，主要用于利用漏洞，没有发现额外的恶意行为，因此投毒风险评估为0%。

**项目地址:** [pankass/CVE-2024-37032_CVE-2024-45436](https://github.com/pankass/CVE-2024-37032_CVE-2024-45436)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

## POC #4

**来源**: [CVE-2024-37032-stuxbench_vllm-cve-2024-37032.md](../2024/CVE-2024-37032-stuxbench_vllm-cve-2024-37032.md)

## CVE-2024-37032-Ollama-路径遍历

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件读取甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要能够向 Ollama 服务器发送请求，权限要求较低（低权限用户即可触发）

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2024-37032是Ollama中存在的一个路径遍历漏洞，具体原因是Ollama在处理模型路径时，没有充分验证digest的格式（预期为64位十六进制的sha256值）。这使得攻击者可以构造恶意的digest，包含例如"../"这样的路径遍历序列，从而访问受限目录之外的文件。

**有效性评估：**

根据提供的漏洞信息，POC代码并不直接可用。漏洞信息提及了包含`modelpath_test.go`的修复commit，表明存在测试用例可以触发和验证该漏洞。Vicarius的文章提供了更详细的漏洞分析。但是，提供的代码是构建vLLM容器的Dockerfile和一些脚本，与Ollama漏洞本身无关，因此无法直接验证CVE-2024-37032。

**投毒风险评估：**

提供的Dockerfile和相关脚本的目的是为了构建一个包含vLLM（一个快速的LLM推理库）的Docker镜像。这些文件本身看起来是安全的，目的是自动化构建和部署vLLM，没有发现任何恶意代码或后门。

因此，投毒风险很低。这里评估为0%。

**利用方式分析：**

1.  **构造恶意模型digest：** 攻击者需要能够向Ollama服务器发送请求，其中包含用于指定模型路径的digest参数。
2.  **路径遍历：** 将digest设置为包含路径遍历序列的值，例如`../`，目的是逃逸出预期的模型存储目录。
3.  **访问敏感文件/RCE：** 成功利用路径遍历后，攻击者可能能够读取服务器上的任意文件（如果Ollama进程具有相应的权限），或者结合其他漏洞实现远程代码执行。

由于Ollama在处理请求时会使用该digest构建文件路径，不充分的验证允许攻击者控制路径的一部分，从而访问到不应该访问的文件或目录。该漏洞CVSS评分为8.8，说明其潜在危害较大。

**项目地址:** [stuxbench/vllm-cve-2024-37032](https://github.com/stuxbench/vllm-cve-2024-37032)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)

---

