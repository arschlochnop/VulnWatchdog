# CVE-2024-55591

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-55591-0x7556_CVE-2024-55591.md](../2024/CVE-2024-55591-0x7556_CVE-2024-55591.md)

## CVE-2024-55591

**漏洞编号:** CVE-2024-55591

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，允许未经身份验证的远程攻击者获取超级管理员权限

**影响版本:** FortiOS 7.0.0 through 7.0.16, FortiProxy 7.0.0 through 7.0.19, FortiProxy 7.2.0 through 7.2.12

**利用条件:** 目标设备必须运行受影响的 FortiOS 或 FortiProxy 版本，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-55591 是 FortiOS 和 FortiProxy 中的一个身份验证绕过漏洞。攻击者可以通过向 Node.js websocket 模块发送特制请求来绕过身份验证并获得超级管理员权限。提供的 POC 代码（1Scan）是一个扫描器，用于批量检测是否存在此漏洞。它利用了漏洞利用代码（watchtowrlabs的fortios-auth-bypass-poc-CVE-2024-55591）。

**有效性：**
根据搜索结果，CVE-2024-55591 已经被积极利用。提供的 POC 扫描器和链接的漏洞利用代码的存在表明该漏洞可以被有效利用。

**投毒风险：**
查看提供的POC代码（1Scan），主要功能是扫描目标是否存在漏洞，并调用其他POC。作者可能在扫描器中添加隐蔽的后门或者恶意代码来投毒。投毒风险较低，因为该工具主要专注于漏洞检测，而明确的漏洞利用代码通常放在单独的仓库中。但是，如果作者在扫描器中嵌入了静默执行恶意操作的代码，投毒风险依然存在。 因此，我判断存在 10% 的风险。

**利用方式：**
1.  攻击者利用漏洞，通过构造特殊的请求绕过身份验证。
2.  成功绕过身份验证后，攻击者获得超级管理员权限。
3.  拥有超级管理员权限后，攻击者可以执行任意操作，包括但不限于配置更改、数据窃取和拒绝服务攻击。

**项目地址:** [0x7556/CVE-2024-55591](https://github.com/0x7556/CVE-2024-55591)

**漏洞详情:** [CVE-2024-55591](https://nvd.nist.gov/vuln/detail/CVE-2024-55591)

---

## POC #2

**来源**: [CVE-2024-55591-UMChacker_CVE-2024-55591-POC.md](../2024/CVE-2024-55591-UMChacker_CVE-2024-55591-POC.md)

## CVE-2024-55591 – FortiOS WebSocket CLI 身份验证绕过

**漏洞编号:** CVE-2024-55591

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，攻击者可能获得超级管理员权限

**影响版本:** FortiOS 7.0.0 <= version <= 7.0.16, FortiProxy 7.0.0 <= version <= 7.0.19, FortiProxy 7.2.0 <= version <= 7.2.12

**利用条件:** 目标设备开启了FortiOS/FortiProxy的web管理界面，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-55591 是一个影响 FortiOS 和 FortiProxy 的身份验证绕过漏洞。攻击者可以通过向 Node.js websocket 模块发送特制请求来绕过身份验证，从而获得超级管理员权限。

**有效性分析:**

根据提供的漏洞信息、搜索结果和PoC代码，该漏洞利用是有效的。

*   漏洞库信息显示该漏洞是严重级别的身份验证绕过漏洞，CVSS 评分为 9.6。
*   搜索结果表明该漏洞已在野外被利用，多个安全厂商发布了关于该漏洞的警告。
*   提供的PoC代码旨在利用 websocket 模块中的身份验证绕过漏洞，可以通过发送特制的websocket请求来获取管理员权限。
*   PoC代码通过构造特定的websocket请求，模拟管理员登录过程，从而绕过身份验证。

**投毒风险分析:**

PoC代码中存在潜在的投毒风险。

*   PoC作者在代码中使用了较多的注释，但部分注释为非英文，这增加了代码审查的难度。
*   PoC代码中存在一些不必要的代码片段，这些代码片段可能被用于隐藏恶意行为。
*  PoC中使用了`watchTowr`作为`local_access_token`,在登录信息中也出现了多次,这可能是一种后门,但也可能是一种测试手段,难以判断。但是增加了投毒的可行性。

综合考虑，投毒风险约为10%。

**利用方式:**

1.  攻击者首先需要确定目标 FortiOS/FortiProxy 设备的 IP 地址和端口。
2.  攻击者使用 PoC 代码向目标设备发送包含特定参数的 WebSocket 请求。
3.  PoC 代码利用漏洞绕过身份验证，建立与设备的 WebSocket 连接。
4.  攻击者通过 WebSocket 连接向设备发送 CLI 命令，从而实现对设备的控制。

**项目地址:** [UMChacker/CVE-2024-55591-POC](https://github.com/UMChacker/CVE-2024-55591-POC)

**漏洞详情:** [CVE-2024-55591](https://nvd.nist.gov/vuln/detail/CVE-2024-55591)

---

## POC #3

**来源**: [CVE-2024-55591-binarywarm_exp-cmd-add-admin-vpn-CVE-2024-55591.md](../2024/CVE-2024-55591-binarywarm_exp-cmd-add-admin-vpn-CVE-2024-55591.md)

## CVE-2024-55591 - FortiOS/FortiProxy 身份验证绕过

**漏洞编号:** CVE-2024-55591

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，允许未授权的远程攻击者获得超级管理员权限

**影响版本:** FortiOS: 7.0.0 <= version <= 7.0.16
FortiProxy: 7.0.0 <= version <= 7.0.19, 7.2.0 <= version <= 7.2.12

**利用条件:** 目标系统需要运行受影响的FortiOS或FortiProxy版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-55591是一个影响FortiOS和FortiProxy的身份验证绕过漏洞。该漏洞位于Node.js websocket模块中，允许未经身份验证的远程攻击者通过构造特制的请求来获得超级管理员权限。 根据搜索引擎结果，该漏洞已被积极利用在野外。提供的POC代码包括一个Python脚本(binarywarm-exp.py)，用于验证漏洞的存在并利用它。脚本通过WebSocket与目标FortiOS/FortiProxy设备通信，并发送特制的请求以绕过身份验证。仓库描述也包含一个快速开始安装指导, 需要安装requests rich python-telegram-bot包,作者在Github仓库中提供了一个外部下载地址[Download](https://satoshidisk.com/pay/CO99uu)，需要付费下载，增加了额外的风险,下载的文件可能包含恶意代码的可能性，因此评估投毒风险为20%。

**项目地址:** [binarywarm/exp-cmd-add-admin-vpn-CVE-2024-55591](https://github.com/binarywarm/exp-cmd-add-admin-vpn-CVE-2024-55591)

**漏洞详情:** [CVE-2024-55591](https://nvd.nist.gov/vuln/detail/CVE-2024-55591)

---

## POC #4

**来源**: [CVE-2024-55591-exfil0_CVE-2024-55591-POC.md](../2024/CVE-2024-55591-exfil0_CVE-2024-55591-POC.md)

## CVE-2024-55591-Fortinet身份验证绕过

**漏洞编号:** CVE-2024-55591

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，攻击者可以获得超级管理员权限

**影响版本:** FortiOS: 7.0.0 to 7.0.16, FortiProxy: 7.0.0 to 7.0.19, 7.2.0 to 7.2.12

**利用条件:** 需要网络访问目标设备的WebSocket/Telnet管理端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-55591 漏洞是一个严重的身份验证绕过漏洞，影响 FortiOS 和 FortiProxy。根据漏洞描述，攻击者可以通过构造特制的请求到 Node.js WebSocket 模块，绕过身份验证，获得超级管理员权限。\n\n**有效性分析：**\n\n*   漏洞库信息显示该漏洞CVSS评分为9.6，属于严重级别，且已被CISA列入已知被利用漏洞目录 (KEV)。\n*   搜索引擎结果表明该漏洞已被野外利用，影响大量设备，多个安全厂商发布了分析报告。\n*   提供的PoC代码是一个Python脚本，旨在自动化利用该漏洞。PoC 具有依赖安装、端口扫描、版本检测、漏洞利用和命令执行等功能。该PoC脚本的存在进一步佐证了该漏洞的可利用性。\n\n综合以上信息，可以得出结论：CVE-2024-55591 漏洞**有效且危害严重**。\n\n**投毒风险分析：**\n\nPoC代码主要功能集中在漏洞检测和利用上，未发现明显的恶意代码，用于植入后门或进行其他恶意行为。但是，任何未经审核的代码都存在一定的风险。\n\nPoC脚本执行的命令，如 `diag sys top`、`diag debug crashlog read`、`execute shell` 可用于收集敏感信息，如果攻击者修改了这些命令，可能会造成更大的危害。脚本集成了从互联网下载依赖的行为，如果作者在托管的依赖中加入恶意代码，则可能存在投毒风险。\n\n综合分析，认为该PoC脚本存在**较低的投毒风险（10%）**。用户在使用该脚本时，应仔细审核代码，并采取必要的安全措施。\n\n**利用方式：**\n\n1.  **端口扫描：** 使用 Nmap 扫描目标设备，发现开放的 WebSocket/Telnet 管理端口。\n2.  **版本检测：** 尝试获取目标设备的 FortiOS/FortiProxy 版本信息，确认是否存在漏洞。\n3.  **WebSocket 连接：** 与目标设备的 WebSocket 接口建立连接。\n4.  **身份验证绕过：** 发送特制的请求到 WebSocket 接口，绕过身份验证。\n5.  **命令执行：** 成功绕过身份验证后，执行任意命令，获取超级管理员权限。

**项目地址:** [exfil0/CVE-2024-55591-POC](https://github.com/exfil0/CVE-2024-55591-POC)

**漏洞详情:** [CVE-2024-55591](https://nvd.nist.gov/vuln/detail/CVE-2024-55591)

---

## POC #5

**来源**: [CVE-2024-55591-rawtips_CVE-2024-55591.md](../2024/CVE-2024-55591-rawtips_CVE-2024-55591.md)

## CVE-2024-55591-FortiOS/FortiProxy-身份验证绕过

**漏洞编号:** CVE-2024-55591

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可能导致未授权访问和完全控制

**影响版本:** FortiOS: v7.0.0 to v7.0.16, FortiProxy: v7.0.0 to v7.0.19, v7.2.0 to v7.2.12

**利用条件:** 需要网络访问到目标设备的管理界面（通常是443端口，HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-55591 是一种身份验证绕过漏洞，影响 FortiOS 和 FortiProxy 的特定版本。攻击者可以通过向 Node.js WebSocket 模块发送特制请求来绕过身份验证，从而获得超级管理员权限。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的 PoC 代码，此漏洞的利用是有效的。漏洞库信息显示 CVSS 评分为 9.6 (CRITICAL)，且已被 CISA 加入已知被利用的漏洞列表 (KEV)。搜索引擎结果也表明该漏洞正在被野外利用，并且有公开的 PoC 代码。

**投毒风险：**
提供的 PoC 代码包含两个文件：`README.md` 和 `exploit.py`。 `README.md` 仅包含漏洞的描述、受影响的版本、使用说明和免责声明，没有恶意代码。`exploit.py` 包含用于利用漏洞的 Python 代码。 通过快速浏览代码，发现存在安装依赖的代码：
```python
subprocess.check_call([sys.executable, "-m", "pip", "install", package])
```
但是根据本次任务要求,POC 验证的后门代码判定为正常代码，所以判定为非投毒代码，风险较低。

**利用方式：**
1.  攻击者首先需要能够访问目标 FortiOS 或 FortiProxy 设备的管理界面（通常通过 HTTPS 端口 443）。
2.  攻击者使用提供的 PoC 脚本或其他类似工具。
3.  该脚本通过建立 WebSocket 连接并发送特制的请求来绕过身份验证。
4.  成功绕过身份验证后，攻击者获得超级管理员权限，可以执行任意命令，例如获取系统信息、修改配置或执行远程代码。

**项目地址:** [rawtips/CVE-2024-55591](https://github.com/rawtips/CVE-2024-55591)

**漏洞详情:** [CVE-2024-55591](https://nvd.nist.gov/vuln/detail/CVE-2024-55591)

---

## POC #6

**来源**: [CVE-2024-55591-sysirq_fortios-auth-bypass-exploit-CVE-2024-55591.md](../2024/CVE-2024-55591-sysirq_fortios-auth-bypass-exploit-CVE-2024-55591.md)

## CVE-2024-55591-FortiOS/FortiProxy 身份验证绕过

**漏洞编号:** CVE-2024-55591

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可能导致超级管理员权限泄露和远程代码执行

**影响版本:** FortiOS 7.0.0 through 7.0.16, FortiProxy 7.0.0 through 7.0.19, FortiProxy 7.2.0 through 7.2.12

**利用条件:** 需要网络访问目标设备的FortiOS/FortiProxy服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-55591 是 FortiOS 和 FortiProxy 中的一个身份验证绕过漏洞，允许未经身份验证的远程攻击者通过向 Node.js websocket 模块发送特制的请求来获得超级管理员权限。漏洞利用代码 `exp.py` 允许攻击者指定目标 IP 地址、端口、用户名和要执行的命令，成功利用后可以执行任意命令。从提供的PoC 代码看，主要的风险来自于命令执行，理论上如果作者在`exp.py` 中加入例如从特定URL下载恶意脚本执行或反弹shell，会导致投毒。由于只是简单的命令执行，所以投毒的可能性较低，估计为10%。搜索结果也表明该漏洞正在被积极利用。

**项目地址:** [sysirq/fortios-auth-bypass-exploit-CVE-2024-55591](https://github.com/sysirq/fortios-auth-bypass-exploit-CVE-2024-55591)

**漏洞详情:** [CVE-2024-55591](https://nvd.nist.gov/vuln/detail/CVE-2024-55591)

---

## POC #7

**来源**: [CVE-2024-55591-sysirq_fortios-auth-bypass-poc-CVE-2024-55591.md](../2024/CVE-2024-55591-sysirq_fortios-auth-bypass-poc-CVE-2024-55591.md)

## CVE-2024-55591-FortiOS/FortiProxy-认证绕过

**漏洞编号:** CVE-2024-55591

**漏洞类型:** 认证绕过

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可能导致超级管理员权限获取

**影响版本:** FortiOS 7.0.0 through 7.0.16, FortiProxy 7.0.0 through 7.0.19 and 7.2.0 through 7.2.12

**利用条件:** 目标设备开启WebSocket服务，且存在于受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-55591是一个影响FortiOS和FortiProxy的认证绕过漏洞。攻击者可以通过构造特殊的请求到Node.js websocket模块绕过身份验证，获取超级管理员权限。根据漏洞信息和搜索结果，此漏洞危害极大，且已被积极利用。

**有效性：**
提供的POC代码尝试利用websocket协议与目标建立连接，并发送特定格式的请求。代码中包含websocket握手过程的实现（生成key、验证accept key），以及发送和接收websocket frame的函数。POC代码中使用了`local_access_token=a5a5a5a5a5a5adasda8sd8sd8ewerfgfg`，这很可能是漏洞利用的关键参数，用于绕过认证。

**投毒风险：**
代码总体结构清晰，主要功能集中在websocket连接建立和数据交互上。潜在的投毒风险点在于：

1.  **依赖库篡改：** 代码使用了requests, pwn等库，如果这些库被篡改，可能引入恶意代码。
2.  **HOST变量：** HOST变量硬编码了目标IP，如果攻击者将HOST修改为恶意IP，可能导致受害者连接到错误的服务器。
3.  **`local_access_token`值：** 此值如果被替换为其他值,可能导致利用失败或者其他问题.但从代码本身来看，并不直接包含后门代码，只是攻击利用的有效载荷.如果poc作者将此payload做了记录,可能会造成一定的风险.

总体来说，投毒风险较低，主要集中在依赖库和变量被篡改的可能性上。**因此，投毒风险评估为20%。**

**利用方式：**
1.  **建立WebSocket连接：** POC首先尝试与目标设备的WebSocket服务建立SSL连接。
2.  **发送握手请求：**  发送包含特定`Sec-WebSocket-Key`的HTTP GET请求，尝试升级协议为WebSocket。
3.  **认证绕过：** 在WebSocket握手请求的URL中包含`local_access_token=a5a5a5a5a5a5adasda8sd8sd8ewerfgfg`，利用此参数绕过认证。
4.  **数据交互：**  如果握手成功，则可以发送和接收WebSocket frame，执行进一步的攻击操作，如发送恶意命令或获取敏感信息。

根据搜索结果，此漏洞已经被野外利用，攻击者利用此漏洞可以获取FortiOS/FortiProxy设备的超级管理员权限。

**项目地址:** [sysirq/fortios-auth-bypass-poc-CVE-2024-55591](https://github.com/sysirq/fortios-auth-bypass-poc-CVE-2024-55591)

**漏洞详情:** [CVE-2024-55591](https://nvd.nist.gov/vuln/detail/CVE-2024-55591)

---

## POC #8

**来源**: [CVE-2024-55591-virus-or-not_CVE-2024-55591.md](../2024/CVE-2024-55591-virus-or-not_CVE-2024-55591.md)

## CVE-2024-55591-FortiOS/FortiProxy-身份验证绕过

**漏洞编号:** CVE-2024-55591

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，可能导致超级管理员权限获取

**影响版本:** FortiOS 7.0.0 <= 7.0.16; FortiProxy 7.0.0 <= 7.0.19, 7.2.0 <= 7.2.12

**利用条件:** 需要网络访问到受影响的FortiOS/FortiProxy设备的WebSocket服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-55591 是一个 FortiOS 和 FortiProxy 中的身份验证绕过漏洞。攻击者可以通过向 Node.js WebSocket 模块发送特制的请求，绕过身份验证并获得超级管理员权限。 

**有效性:**
根据漏洞信息和搜索结果，此漏洞已被积极利用，且 CVSS 评分高达 9.6，表明其严重性。提供的 POC 代码尝试利用 WebSocket 连接，并发送包含用户名和其他信息的特定格式的 Payload。 如果目标设备存在漏洞，则攻击者可以通过此Payload获得超级管理员权限，然后执行任意命令。

**投毒风险:**
阅读POC代码后，代码本身实现了漏洞利用，没有明显的投毒行为。代码存在Debug模式，会打印通信过程中的数据，方便使用者分析。该POC通过WebSocket连接并发送构造的Payload数据，没有发现主动删除日志、植入后门或者篡改系统配置的恶意行为。
但是，需要注意的是，如果成功利用此漏洞，攻击者可以获得超级管理员权限，从而可以进行任意恶意操作，例如植入后门、窃取数据等。因此，在使用此 POC 进行测试时，必须在隔离的环境中进行，并采取适当的安全措施。
总体评估，此 POC 代码本身的投毒风险较低，但是利用此漏洞可能导致严重的后果。因此，在使用时需要谨慎。

**利用方式:**
1.  攻击者首先需要确定目标 FortiOS 或 FortiProxy 设备的 WebSocket 服务是否可访问。
2.  利用提供的 POC 代码，指定目标 IP 地址、端口、用户名和要执行的命令。
3.  POC 代码会建立与目标设备的 WebSocket 连接。
4.  POC 代码会发送精心构造的 Payload，绕过身份验证。
5.  攻击者可以通过发送命令来获得超级管理员权限，并在目标设备上执行任意操作。

**项目地址:** [virus-or-not/CVE-2024-55591](https://github.com/virus-or-not/CVE-2024-55591)

**漏洞详情:** [CVE-2024-55591](https://nvd.nist.gov/vuln/detail/CVE-2024-55591)

---

## POC #9

**来源**: [CVE-2024-55591-watchtowrlabs_fortios-auth-bypass-check-CVE-2024-55591.md](../2024/CVE-2024-55591-watchtowrlabs_fortios-auth-bypass-check-CVE-2024-55591.md)

## CVE-2024-55591-FortiOS/FortiProxy 认证绕过

**漏洞编号:** CVE-2024-55591

**漏洞类型:** 认证绕过

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，攻击者可能获得超级管理员权限

**影响版本:** FortiOS 7.0.0 - 7.0.16, FortiProxy 7.0.0 - 7.0.19, FortiProxy 7.2.0 - 7.2.12

**利用条件:** 需要目标设备开放HTTPS端口（通常是443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-55591 存在于 FortiOS 和 FortiProxy 中，允许未经身份验证的远程攻击者通过构造特殊的请求到 Node.js websocket 模块来绕过身份验证，并获得超级管理员权限。 

**漏洞利用方式：**

根据提供的PoC代码，攻击者首先向`/login?redir=/ng`端点发送GET请求，模拟登录行为。然后，向一个包含随机后缀的端点（例如`/watchTowr-{random_suffix}`）发送带有特定WebSocket头的GET请求。如果满足特定条件（例如，HTTP状态码、响应体内容、响应头等），则认为目标存在漏洞。

**有效性分析：**

PoC代码通过模拟特定的HTTP请求交互来验证漏洞的存在。它检查响应的状态码、响应体和响应头，以确定目标是否受到攻击。 根据搜索结果，此漏洞已被在野利用，这表明提供的 PoC 代码具有潜在的有效性。

**投毒风险分析：**

PoC 代码本身的功能是检测目标是否存在 CVE-2024-55591 漏洞，并没有发现明显的恶意代码。投毒的风险较低，大约为5%。但需要注意：
* 该脚本会禁用SSL证书验证，虽然这是为了方便测试，但也可能导致中间人攻击的风险。用户应该意识到这一点，并在生产环境中谨慎使用。
* 攻击者可能会修改该PoC代码，添加恶意功能，然后传播它。因此，从不受信任的来源下载的代码需要仔细审查。

**项目地址:** [watchtowrlabs/fortios-auth-bypass-check-CVE-2024-55591](https://github.com/watchtowrlabs/fortios-auth-bypass-check-CVE-2024-55591)

**漏洞详情:** [CVE-2024-55591](https://nvd.nist.gov/vuln/detail/CVE-2024-55591)

---

## POC #10

**来源**: [CVE-2024-55591-watchtowrlabs_fortios-auth-bypass-poc-CVE-2024-55591.md](../2024/CVE-2024-55591-watchtowrlabs_fortios-auth-bypass-poc-CVE-2024-55591.md)

## CVE-2024-55591 - FortiOS/FortiProxy Authentication Bypass

**漏洞编号:** CVE-2024-55591

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，可导致超级管理员权限获取

**影响版本:** FortiOS 7.0.0 <= 7.0.16, FortiProxy 7.0.0 <= 7.0.19, FortiProxy 7.2.0 <= 7.2.12

**利用条件:** 需要目标设备开放网络访问，并运行受影响的FortiOS或FortiProxy版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-55591 是一个影响 FortiOS 和 FortiProxy 的身份验证绕过漏洞。攻击者可以通过向 Node.js websocket 模块发送特制请求来获得超级管理员权限。漏洞库信息、搜索引擎结果和提供的 PoC 代码均表明该漏洞的有效性。

**有效性：**
漏洞库信息表明该漏洞已经被积极利用，并被 CISA 加入到已知被利用的漏洞列表中。搜索引擎结果也确认了该漏洞已经被野外利用。提供的 PoC 代码旨在利用 websocket 模块中的缺陷，通过伪造登录上下文信息并发送特制的命令，绕过身份验证并执行任意命令。

**投毒风险：**
PoC 代码本身看起来比较直接地实现了漏洞利用，但仍存在一定的投毒风险。PoC代码中包含从服务器接收数据，并使用`bytes.fromhex(data.hex()).decode(errors='replace')`尝试解码数据，如果服务器返回包含恶意代码的十六进制字符串，可能会被解码并执行。此外，虽然PoC代码没有明显地进行恶意行为，但攻击者可能会修改该代码，加入例如反向shell的恶意代码，从而达到长期控制目标系统的目的。因此，不能完全排除投毒的可能性，估计投毒风险为10%。

**利用方式：**
1.  PoC 利用了 FortiOS/FortiProxy 中的 Node.js websocket 模块的身份验证绕过漏洞。
2.  PoC 首先创建一个 websocket 连接到目标设备。
3.  然后，它构造一个包含伪造的登录上下文信息的 websocket 帧，模拟一个合法的管理员登录。
4.  接下来，它发送一个包含要执行的命令的 websocket 帧。
5.  由于身份验证绕过，目标设备将执行该命令，并将结果返回给攻击者。
6. 该漏洞允许攻击者在未经授权的情况下获得超级管理员权限，从而完全控制受影响的设备。

**项目地址:** [watchtowrlabs/fortios-auth-bypass-poc-CVE-2024-55591](https://github.com/watchtowrlabs/fortios-auth-bypass-poc-CVE-2024-55591)

**漏洞详情:** [CVE-2024-55591](https://nvd.nist.gov/vuln/detail/CVE-2024-55591)

---

