# CVE-2024-12084

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-12084-InkeyP_CVE-2024-12084.md](../2024/CVE-2024-12084-InkeyP_CVE-2024-12084.md)

# CVE-2024-12084

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-12084-InkeyP_CVE-2024-12084.md](../2024/CVE-2024-12084-InkeyP_CVE-2024-12084.md)

# CVE-2024-12084

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-12084-InkeyP_CVE-2024-12084.md](../2024/CVE-2024-12084-InkeyP_CVE-2024-12084.md)

# CVE-2024-12084

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-12084-InkeyP_CVE-2024-12084.md](../2024/CVE-2024-12084-InkeyP_CVE-2024-12084.md)

# CVE-2024-12084

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-12084-InkeyP_CVE-2024-12084.md](../2024/CVE-2024-12084-InkeyP_CVE-2024-12084.md)

# CVE-2024-12084

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-12084-InkeyP_CVE-2024-12084.md](../2024/CVE-2024-12084-InkeyP_CVE-2024-12084.md)

## CVE-2024-12084-Rsync-堆缓冲区溢出

**漏洞编号:** CVE-2024-12084

**漏洞类型:** 堆缓冲区溢出

**影响应用:** Rsync

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 3.2.7, 3.3.0

**利用条件:** Rsync daemon 运行且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-12084 是 Rsync 中存在的一个堆缓冲区溢出漏洞。漏洞原因是程序在处理攻击者可控的校验和长度 (s2length) 时不当。当 MAX_DIGEST_LEN 超过固定的 SUM_LENGTH (16 字节) 时，攻击者可以溢出 sum2 缓冲区。\n\n**漏洞利用方式：**\n\n1.  **握手:** 客户端与 Rsync 服务器建立连接，进行协议版本协商。\n2.  **模块选择:** 客户端选择一个模块，如果服务器配置允许匿名访问，则无需身份验证。\n3.  **参数发送:** 客户端发送 Rsync 命令参数。\n4.  **兼容性标志读取:** 客户端读取服务器的兼容性标志，并可能进行校验和算法的协商。\n5.  **校验和种子读取:** 客户端读取服务器的校验和种子。\n6.  **Multiplexing:** 启用 Multiplexing 功能以便更高效地传输数据。\n7.  **文件列表处理:** 漏洞触发点在于服务器处理文件列表时，攻击者可以构造恶意的校验和长度，导致堆缓冲区溢出。POC 通过精心构造的文件列表数据，利用 `read_varint` 函数读取校验和长度时触发溢出。\n\n**投毒风险分析：**\n\n该 POC 代码主要用于验证漏洞的存在，提供了一个本地调试和远程利用的框架。代码中包含 GDB 调试功能，便于分析漏洞。投毒风险较低，主要风险在于如果直接将修改后的恶意代码部署到生产环境，可能会引入后门或不稳定因素。`pwncli` 是一个 CTF 工具，可能包含一些安全风险，但主要集中在利用阶段而非持久化的投毒行为。需要注意的是，该脚本依赖特定的环境配置（如 `rsync.conf` 和 `LD_LIBRARY_PATH`），确保环境安全非常重要。该利用程序相对复杂，需要对 Rsync 协议和内存布局有深入的理解，增加了投毒的难度，但也并非不可能。总的来说，该脚本主要用于漏洞验证和利用，而非恶意代码传播，因此判定投毒风险较低。

**项目地址:** [InkeyP/CVE-2024-12084](https://github.com/InkeyP/CVE-2024-12084)

**漏洞详情:** [CVE-2024-12084](https://nvd.nist.gov/vuln/detail/CVE-2024-12084)

---

## POC #2

**来源**: [CVE-2024-12084-rxerium_CVE-2024-12084.md](../2024/CVE-2024-12084-rxerium_CVE-2024-12084.md)

## CVE-2024-12084-rsync-堆缓冲区溢出

**漏洞编号:** CVE-2024-12084

**漏洞类型:** 堆缓冲区溢出

**影响应用:** rsync

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 3.2.7 和 3.3.0

**利用条件:** 需要目标 rsync 服务开启，且协议版本为 31.0

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-12084 存在于 rsync 守护进程中，是由于对攻击者可控的校验和长度（s2length）处理不当造成的堆缓冲区溢出。当 MAX_DIGEST_LEN 超过固定 SUM_LENGTH（16 字节）时，攻击者可以在 sum2 缓冲区中进行越界写入，从而实现远程代码执行。

**有效性：**
提供的 POC 代码是一个 Nuclei 模板，用于检测 rsync 服务是否容易受到 CVE-2024-12084 攻击。该模板通过检查 rsync 服务的协议版本是否为 31.0 来判断目标是否存在漏洞。如果协议版本匹配，则认为目标容易受到攻击。这个检测方法是基于协议版本与漏洞版本之间的关联，因此是有效的。

**投毒风险：**
检查提供的文件 `LICENSE`, `README.md`, `template.yaml`。`LICENSE` 是 MIT 许可证，属于标准协议。 `README.md` 文件描述了漏洞和如何使用 Nuclei 模板进行检测。`template.yaml` 文件包含 Nuclei 模板的具体配置，它定义了如何发送请求以及如何识别 rsync 服务的协议版本。仔细检查了 Nuclei 模板代码，没有发现任何尝试进行恶意操作的代码。此仓库中没有发现隐藏的投毒代码，因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要建立与易受攻击的 rsync 服务器的连接。
2.  攻击者在数据传输过程中发送特制的校验和长度 (s2length)，使其大于 SUM_LENGTH (16 字节)。
3.  当 rsync 守护进程处理此校验和时，由于不正确的边界检查，它会将数据写入 sum2 缓冲区之外，导致堆缓冲区溢出。
4.  攻击者可以通过控制溢出的数据来覆盖堆上的其他数据结构，最终实现远程代码执行。
简而言之，利用方式是通过发送特制的 rsync 协议数据包，其中包含过长的校验和长度，从而触发堆缓冲区溢出并实现远程代码执行。

**项目地址:** [rxerium/CVE-2024-12084](https://github.com/rxerium/CVE-2024-12084)

**漏洞详情:** [CVE-2024-12084](https://nvd.nist.gov/vuln/detail/CVE-2024-12084)

---

## POC #3

**来源**: [CVE-2024-12084-themirze_cve-2024-12084.md](../2024/CVE-2024-12084-themirze_cve-2024-12084.md)

## CVE-2024-12084-Rsync-堆缓冲区溢出

**漏洞编号:** CVE-2024-12084

**漏洞类型:** 堆缓冲区溢出

**影响应用:** Rsync

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 3.2.7, 3.3.0

**利用条件:** 需要网络访问Rsync服务，匿名读取权限或已知用户名密码

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-12084是Rsync守护进程中的一个基于堆的缓冲区溢出漏洞。由于不正确处理攻击者可控的校验和长度 (s2length)，当 MAX_DIGEST_LEN 超过固定的 SUM_LENGTH (16 字节) 时，攻击者可以在 sum2 缓冲区中进行越界写入。

**有效性：**
根据漏洞库信息和GitHub漏洞库信息,可知此漏洞POC可用。提供的Python脚本并没有直接利用堆缓冲区溢出漏洞，而是尝试利用rsync的配置错误（如匿名访问）进行文件上传，如果目标rsync服务器配置不当存在可以上传文件的模块，脚本能够上传文件。

**投毒风险：**
该脚本的主要功能是枚举rsync模块并测试写入权限。脚本没有明显的恶意代码，例如反向shell、downloader等。风险较低，但仍存在潜在风险，脚本可能被修改后用于恶意目的，例如上传包含恶意代码的文件，考虑到作者未经验证，因此投毒风险概率评估为 1%。

**利用方式：**
1.  **扫描目标：** 使用提供的脚本扫描指定IP列表中的Rsync服务(端口873)。
2.  **枚举模块：**  尝试列出Rsync服务器上可用的模块。
3.  **权限测试：**  针对每个模块，尝试写入文件，以确定是否具有写入权限。如果成功写入，则表明目标存在配置错误，可能允许恶意文件上传，存在进一步利用的可能，但是上传本身并没有直接利用 CVE-2024-12084。

**结论：**
虽然提供的脚本本身并没有直接利用 CVE-2024-12084 漏洞进行堆缓冲区溢出攻击，但是如果结合其他exp，可能会成功利用该漏洞进行RCE。

**项目地址:** [themirze/cve-2024-12084](https://github.com/themirze/cve-2024-12084)

**漏洞详情:** [CVE-2024-12084](https://nvd.nist.gov/vuln/detail/CVE-2024-12084)

---



---

## POC #2

**来源**: [CVE-2024-12084-rxerium_CVE-2024-12084.md](../2024/CVE-2024-12084-rxerium_CVE-2024-12084.md)

## CVE-2024-12084-rsync-堆缓冲区溢出

**漏洞编号:** CVE-2024-12084

**漏洞类型:** 堆缓冲区溢出

**影响应用:** rsync

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 3.2.7 和 3.3.0

**利用条件:** 需要目标 rsync 服务开启，且协议版本为 31.0

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-12084 存在于 rsync 守护进程中，是由于对攻击者可控的校验和长度（s2length）处理不当造成的堆缓冲区溢出。当 MAX_DIGEST_LEN 超过固定 SUM_LENGTH（16 字节）时，攻击者可以在 sum2 缓冲区中进行越界写入，从而实现远程代码执行。

**有效性：**
提供的 POC 代码是一个 Nuclei 模板，用于检测 rsync 服务是否容易受到 CVE-2024-12084 攻击。该模板通过检查 rsync 服务的协议版本是否为 31.0 来判断目标是否存在漏洞。如果协议版本匹配，则认为目标容易受到攻击。这个检测方法是基于协议版本与漏洞版本之间的关联，因此是有效的。

**投毒风险：**
检查提供的文件 `LICENSE`, `README.md`, `template.yaml`。`LICENSE` 是 MIT 许可证，属于标准协议。 `README.md` 文件描述了漏洞和如何使用 Nuclei 模板进行检测。`template.yaml` 文件包含 Nuclei 模板的具体配置，它定义了如何发送请求以及如何识别 rsync 服务的协议版本。仔细检查了 Nuclei 模板代码，没有发现任何尝试进行恶意操作的代码。此仓库中没有发现隐藏的投毒代码，因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要建立与易受攻击的 rsync 服务器的连接。
2.  攻击者在数据传输过程中发送特制的校验和长度 (s2length)，使其大于 SUM_LENGTH (16 字节)。
3.  当 rsync 守护进程处理此校验和时，由于不正确的边界检查，它会将数据写入 sum2 缓冲区之外，导致堆缓冲区溢出。
4.  攻击者可以通过控制溢出的数据来覆盖堆上的其他数据结构，最终实现远程代码执行。
简而言之，利用方式是通过发送特制的 rsync 协议数据包，其中包含过长的校验和长度，从而触发堆缓冲区溢出并实现远程代码执行。

**项目地址:** [rxerium/CVE-2024-12084](https://github.com/rxerium/CVE-2024-12084)

**漏洞详情:** [CVE-2024-12084](https://nvd.nist.gov/vuln/detail/CVE-2024-12084)

---

## POC #3

**来源**: [CVE-2024-12084-themirze_cve-2024-12084.md](../2024/CVE-2024-12084-themirze_cve-2024-12084.md)

## CVE-2024-12084-Rsync-堆缓冲区溢出

**漏洞编号:** CVE-2024-12084

**漏洞类型:** 堆缓冲区溢出

**影响应用:** Rsync

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 3.2.7, 3.3.0

**利用条件:** 需要网络访问Rsync服务，匿名读取权限或已知用户名密码

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-12084是Rsync守护进程中的一个基于堆的缓冲区溢出漏洞。由于不正确处理攻击者可控的校验和长度 (s2length)，当 MAX_DIGEST_LEN 超过固定的 SUM_LENGTH (16 字节) 时，攻击者可以在 sum2 缓冲区中进行越界写入。

**有效性：**
根据漏洞库信息和GitHub漏洞库信息,可知此漏洞POC可用。提供的Python脚本并没有直接利用堆缓冲区溢出漏洞，而是尝试利用rsync的配置错误（如匿名访问）进行文件上传，如果目标rsync服务器配置不当存在可以上传文件的模块，脚本能够上传文件。

**投毒风险：**
该脚本的主要功能是枚举rsync模块并测试写入权限。脚本没有明显的恶意代码，例如反向shell、downloader等。风险较低，但仍存在潜在风险，脚本可能被修改后用于恶意目的，例如上传包含恶意代码的文件，考虑到作者未经验证，因此投毒风险概率评估为 1%。

**利用方式：**
1.  **扫描目标：** 使用提供的脚本扫描指定IP列表中的Rsync服务(端口873)。
2.  **枚举模块：**  尝试列出Rsync服务器上可用的模块。
3.  **权限测试：**  针对每个模块，尝试写入文件，以确定是否具有写入权限。如果成功写入，则表明目标存在配置错误，可能允许恶意文件上传，存在进一步利用的可能，但是上传本身并没有直接利用 CVE-2024-12084。

**结论：**
虽然提供的脚本本身并没有直接利用 CVE-2024-12084 漏洞进行堆缓冲区溢出攻击，但是如果结合其他exp，可能会成功利用该漏洞进行RCE。

**项目地址:** [themirze/cve-2024-12084](https://github.com/themirze/cve-2024-12084)

**漏洞详情:** [CVE-2024-12084](https://nvd.nist.gov/vuln/detail/CVE-2024-12084)

---



---

## POC #2

**来源**: [CVE-2024-12084-rxerium_CVE-2024-12084.md](../2024/CVE-2024-12084-rxerium_CVE-2024-12084.md)

## CVE-2024-12084-rsync-堆缓冲区溢出

**漏洞编号:** CVE-2024-12084

**漏洞类型:** 堆缓冲区溢出

**影响应用:** rsync

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 3.2.7 和 3.3.0

**利用条件:** 需要目标 rsync 服务开启，且协议版本为 31.0

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-12084 存在于 rsync 守护进程中，是由于对攻击者可控的校验和长度（s2length）处理不当造成的堆缓冲区溢出。当 MAX_DIGEST_LEN 超过固定 SUM_LENGTH（16 字节）时，攻击者可以在 sum2 缓冲区中进行越界写入，从而实现远程代码执行。

**有效性：**
提供的 POC 代码是一个 Nuclei 模板，用于检测 rsync 服务是否容易受到 CVE-2024-12084 攻击。该模板通过检查 rsync 服务的协议版本是否为 31.0 来判断目标是否存在漏洞。如果协议版本匹配，则认为目标容易受到攻击。这个检测方法是基于协议版本与漏洞版本之间的关联，因此是有效的。

**投毒风险：**
检查提供的文件 `LICENSE`, `README.md`, `template.yaml`。`LICENSE` 是 MIT 许可证，属于标准协议。 `README.md` 文件描述了漏洞和如何使用 Nuclei 模板进行检测。`template.yaml` 文件包含 Nuclei 模板的具体配置，它定义了如何发送请求以及如何识别 rsync 服务的协议版本。仔细检查了 Nuclei 模板代码，没有发现任何尝试进行恶意操作的代码。此仓库中没有发现隐藏的投毒代码，因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要建立与易受攻击的 rsync 服务器的连接。
2.  攻击者在数据传输过程中发送特制的校验和长度 (s2length)，使其大于 SUM_LENGTH (16 字节)。
3.  当 rsync 守护进程处理此校验和时，由于不正确的边界检查，它会将数据写入 sum2 缓冲区之外，导致堆缓冲区溢出。
4.  攻击者可以通过控制溢出的数据来覆盖堆上的其他数据结构，最终实现远程代码执行。
简而言之，利用方式是通过发送特制的 rsync 协议数据包，其中包含过长的校验和长度，从而触发堆缓冲区溢出并实现远程代码执行。

**项目地址:** [rxerium/CVE-2024-12084](https://github.com/rxerium/CVE-2024-12084)

**漏洞详情:** [CVE-2024-12084](https://nvd.nist.gov/vuln/detail/CVE-2024-12084)

---

## POC #3

**来源**: [CVE-2024-12084-themirze_cve-2024-12084.md](../2024/CVE-2024-12084-themirze_cve-2024-12084.md)

## CVE-2024-12084-Rsync-堆缓冲区溢出

**漏洞编号:** CVE-2024-12084

**漏洞类型:** 堆缓冲区溢出

**影响应用:** Rsync

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 3.2.7, 3.3.0

**利用条件:** 需要网络访问Rsync服务，匿名读取权限或已知用户名密码

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-12084是Rsync守护进程中的一个基于堆的缓冲区溢出漏洞。由于不正确处理攻击者可控的校验和长度 (s2length)，当 MAX_DIGEST_LEN 超过固定的 SUM_LENGTH (16 字节) 时，攻击者可以在 sum2 缓冲区中进行越界写入。

**有效性：**
根据漏洞库信息和GitHub漏洞库信息,可知此漏洞POC可用。提供的Python脚本并没有直接利用堆缓冲区溢出漏洞，而是尝试利用rsync的配置错误（如匿名访问）进行文件上传，如果目标rsync服务器配置不当存在可以上传文件的模块，脚本能够上传文件。

**投毒风险：**
该脚本的主要功能是枚举rsync模块并测试写入权限。脚本没有明显的恶意代码，例如反向shell、downloader等。风险较低，但仍存在潜在风险，脚本可能被修改后用于恶意目的，例如上传包含恶意代码的文件，考虑到作者未经验证，因此投毒风险概率评估为 1%。

**利用方式：**
1.  **扫描目标：** 使用提供的脚本扫描指定IP列表中的Rsync服务(端口873)。
2.  **枚举模块：**  尝试列出Rsync服务器上可用的模块。
3.  **权限测试：**  针对每个模块，尝试写入文件，以确定是否具有写入权限。如果成功写入，则表明目标存在配置错误，可能允许恶意文件上传，存在进一步利用的可能，但是上传本身并没有直接利用 CVE-2024-12084。

**结论：**
虽然提供的脚本本身并没有直接利用 CVE-2024-12084 漏洞进行堆缓冲区溢出攻击，但是如果结合其他exp，可能会成功利用该漏洞进行RCE。

**项目地址:** [themirze/cve-2024-12084](https://github.com/themirze/cve-2024-12084)

**漏洞详情:** [CVE-2024-12084](https://nvd.nist.gov/vuln/detail/CVE-2024-12084)

---



---

## POC #2

**来源**: [CVE-2024-12084-rxerium_CVE-2024-12084.md](../2024/CVE-2024-12084-rxerium_CVE-2024-12084.md)

## CVE-2024-12084-rsync-堆缓冲区溢出

**漏洞编号:** CVE-2024-12084

**漏洞类型:** 堆缓冲区溢出

**影响应用:** rsync

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 3.2.7 和 3.3.0

**利用条件:** 需要目标 rsync 服务开启，且协议版本为 31.0

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-12084 存在于 rsync 守护进程中，是由于对攻击者可控的校验和长度（s2length）处理不当造成的堆缓冲区溢出。当 MAX_DIGEST_LEN 超过固定 SUM_LENGTH（16 字节）时，攻击者可以在 sum2 缓冲区中进行越界写入，从而实现远程代码执行。

**有效性：**
提供的 POC 代码是一个 Nuclei 模板，用于检测 rsync 服务是否容易受到 CVE-2024-12084 攻击。该模板通过检查 rsync 服务的协议版本是否为 31.0 来判断目标是否存在漏洞。如果协议版本匹配，则认为目标容易受到攻击。这个检测方法是基于协议版本与漏洞版本之间的关联，因此是有效的。

**投毒风险：**
检查提供的文件 `LICENSE`, `README.md`, `template.yaml`。`LICENSE` 是 MIT 许可证，属于标准协议。 `README.md` 文件描述了漏洞和如何使用 Nuclei 模板进行检测。`template.yaml` 文件包含 Nuclei 模板的具体配置，它定义了如何发送请求以及如何识别 rsync 服务的协议版本。仔细检查了 Nuclei 模板代码，没有发现任何尝试进行恶意操作的代码。此仓库中没有发现隐藏的投毒代码，因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要建立与易受攻击的 rsync 服务器的连接。
2.  攻击者在数据传输过程中发送特制的校验和长度 (s2length)，使其大于 SUM_LENGTH (16 字节)。
3.  当 rsync 守护进程处理此校验和时，由于不正确的边界检查，它会将数据写入 sum2 缓冲区之外，导致堆缓冲区溢出。
4.  攻击者可以通过控制溢出的数据来覆盖堆上的其他数据结构，最终实现远程代码执行。
简而言之，利用方式是通过发送特制的 rsync 协议数据包，其中包含过长的校验和长度，从而触发堆缓冲区溢出并实现远程代码执行。

**项目地址:** [rxerium/CVE-2024-12084](https://github.com/rxerium/CVE-2024-12084)

**漏洞详情:** [CVE-2024-12084](https://nvd.nist.gov/vuln/detail/CVE-2024-12084)

---

## POC #3

**来源**: [CVE-2024-12084-themirze_cve-2024-12084.md](../2024/CVE-2024-12084-themirze_cve-2024-12084.md)

## CVE-2024-12084-Rsync-堆缓冲区溢出

**漏洞编号:** CVE-2024-12084

**漏洞类型:** 堆缓冲区溢出

**影响应用:** Rsync

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 3.2.7, 3.3.0

**利用条件:** 需要网络访问Rsync服务，匿名读取权限或已知用户名密码

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-12084是Rsync守护进程中的一个基于堆的缓冲区溢出漏洞。由于不正确处理攻击者可控的校验和长度 (s2length)，当 MAX_DIGEST_LEN 超过固定的 SUM_LENGTH (16 字节) 时，攻击者可以在 sum2 缓冲区中进行越界写入。

**有效性：**
根据漏洞库信息和GitHub漏洞库信息,可知此漏洞POC可用。提供的Python脚本并没有直接利用堆缓冲区溢出漏洞，而是尝试利用rsync的配置错误（如匿名访问）进行文件上传，如果目标rsync服务器配置不当存在可以上传文件的模块，脚本能够上传文件。

**投毒风险：**
该脚本的主要功能是枚举rsync模块并测试写入权限。脚本没有明显的恶意代码，例如反向shell、downloader等。风险较低，但仍存在潜在风险，脚本可能被修改后用于恶意目的，例如上传包含恶意代码的文件，考虑到作者未经验证，因此投毒风险概率评估为 1%。

**利用方式：**
1.  **扫描目标：** 使用提供的脚本扫描指定IP列表中的Rsync服务(端口873)。
2.  **枚举模块：**  尝试列出Rsync服务器上可用的模块。
3.  **权限测试：**  针对每个模块，尝试写入文件，以确定是否具有写入权限。如果成功写入，则表明目标存在配置错误，可能允许恶意文件上传，存在进一步利用的可能，但是上传本身并没有直接利用 CVE-2024-12084。

**结论：**
虽然提供的脚本本身并没有直接利用 CVE-2024-12084 漏洞进行堆缓冲区溢出攻击，但是如果结合其他exp，可能会成功利用该漏洞进行RCE。

**项目地址:** [themirze/cve-2024-12084](https://github.com/themirze/cve-2024-12084)

**漏洞详情:** [CVE-2024-12084](https://nvd.nist.gov/vuln/detail/CVE-2024-12084)

---



---

## POC #2

**来源**: [CVE-2024-12084-rxerium_CVE-2024-12084.md](../2024/CVE-2024-12084-rxerium_CVE-2024-12084.md)

## CVE-2024-12084-rsync-堆缓冲区溢出

**漏洞编号:** CVE-2024-12084

**漏洞类型:** 堆缓冲区溢出

**影响应用:** rsync

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 3.2.7 和 3.3.0

**利用条件:** 需要目标 rsync 服务开启，且协议版本为 31.0

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-12084 存在于 rsync 守护进程中，是由于对攻击者可控的校验和长度（s2length）处理不当造成的堆缓冲区溢出。当 MAX_DIGEST_LEN 超过固定 SUM_LENGTH（16 字节）时，攻击者可以在 sum2 缓冲区中进行越界写入，从而实现远程代码执行。

**有效性：**
提供的 POC 代码是一个 Nuclei 模板，用于检测 rsync 服务是否容易受到 CVE-2024-12084 攻击。该模板通过检查 rsync 服务的协议版本是否为 31.0 来判断目标是否存在漏洞。如果协议版本匹配，则认为目标容易受到攻击。这个检测方法是基于协议版本与漏洞版本之间的关联，因此是有效的。

**投毒风险：**
检查提供的文件 `LICENSE`, `README.md`, `template.yaml`。`LICENSE` 是 MIT 许可证，属于标准协议。 `README.md` 文件描述了漏洞和如何使用 Nuclei 模板进行检测。`template.yaml` 文件包含 Nuclei 模板的具体配置，它定义了如何发送请求以及如何识别 rsync 服务的协议版本。仔细检查了 Nuclei 模板代码，没有发现任何尝试进行恶意操作的代码。此仓库中没有发现隐藏的投毒代码，因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要建立与易受攻击的 rsync 服务器的连接。
2.  攻击者在数据传输过程中发送特制的校验和长度 (s2length)，使其大于 SUM_LENGTH (16 字节)。
3.  当 rsync 守护进程处理此校验和时，由于不正确的边界检查，它会将数据写入 sum2 缓冲区之外，导致堆缓冲区溢出。
4.  攻击者可以通过控制溢出的数据来覆盖堆上的其他数据结构，最终实现远程代码执行。
简而言之，利用方式是通过发送特制的 rsync 协议数据包，其中包含过长的校验和长度，从而触发堆缓冲区溢出并实现远程代码执行。

**项目地址:** [rxerium/CVE-2024-12084](https://github.com/rxerium/CVE-2024-12084)

**漏洞详情:** [CVE-2024-12084](https://nvd.nist.gov/vuln/detail/CVE-2024-12084)

---

## POC #3

**来源**: [CVE-2024-12084-themirze_cve-2024-12084.md](../2024/CVE-2024-12084-themirze_cve-2024-12084.md)

## CVE-2024-12084-Rsync-堆缓冲区溢出

**漏洞编号:** CVE-2024-12084

**漏洞类型:** 堆缓冲区溢出

**影响应用:** Rsync

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 3.2.7, 3.3.0

**利用条件:** 需要网络访问Rsync服务，匿名读取权限或已知用户名密码

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-12084是Rsync守护进程中的一个基于堆的缓冲区溢出漏洞。由于不正确处理攻击者可控的校验和长度 (s2length)，当 MAX_DIGEST_LEN 超过固定的 SUM_LENGTH (16 字节) 时，攻击者可以在 sum2 缓冲区中进行越界写入。

**有效性：**
根据漏洞库信息和GitHub漏洞库信息,可知此漏洞POC可用。提供的Python脚本并没有直接利用堆缓冲区溢出漏洞，而是尝试利用rsync的配置错误（如匿名访问）进行文件上传，如果目标rsync服务器配置不当存在可以上传文件的模块，脚本能够上传文件。

**投毒风险：**
该脚本的主要功能是枚举rsync模块并测试写入权限。脚本没有明显的恶意代码，例如反向shell、downloader等。风险较低，但仍存在潜在风险，脚本可能被修改后用于恶意目的，例如上传包含恶意代码的文件，考虑到作者未经验证，因此投毒风险概率评估为 1%。

**利用方式：**
1.  **扫描目标：** 使用提供的脚本扫描指定IP列表中的Rsync服务(端口873)。
2.  **枚举模块：**  尝试列出Rsync服务器上可用的模块。
3.  **权限测试：**  针对每个模块，尝试写入文件，以确定是否具有写入权限。如果成功写入，则表明目标存在配置错误，可能允许恶意文件上传，存在进一步利用的可能，但是上传本身并没有直接利用 CVE-2024-12084。

**结论：**
虽然提供的脚本本身并没有直接利用 CVE-2024-12084 漏洞进行堆缓冲区溢出攻击，但是如果结合其他exp，可能会成功利用该漏洞进行RCE。

**项目地址:** [themirze/cve-2024-12084](https://github.com/themirze/cve-2024-12084)

**漏洞详情:** [CVE-2024-12084](https://nvd.nist.gov/vuln/detail/CVE-2024-12084)

---



---

## POC #2

**来源**: [CVE-2024-12084-rxerium_CVE-2024-12084.md](../2024/CVE-2024-12084-rxerium_CVE-2024-12084.md)

## CVE-2024-12084-rsync-堆缓冲区溢出

**漏洞编号:** CVE-2024-12084

**漏洞类型:** 堆缓冲区溢出

**影响应用:** rsync

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 3.2.7 和 3.3.0

**利用条件:** 需要目标 rsync 服务开启，且协议版本为 31.0

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-12084 存在于 rsync 守护进程中，是由于对攻击者可控的校验和长度（s2length）处理不当造成的堆缓冲区溢出。当 MAX_DIGEST_LEN 超过固定 SUM_LENGTH（16 字节）时，攻击者可以在 sum2 缓冲区中进行越界写入，从而实现远程代码执行。

**有效性：**
提供的 POC 代码是一个 Nuclei 模板，用于检测 rsync 服务是否容易受到 CVE-2024-12084 攻击。该模板通过检查 rsync 服务的协议版本是否为 31.0 来判断目标是否存在漏洞。如果协议版本匹配，则认为目标容易受到攻击。这个检测方法是基于协议版本与漏洞版本之间的关联，因此是有效的。

**投毒风险：**
检查提供的文件 `LICENSE`, `README.md`, `template.yaml`。`LICENSE` 是 MIT 许可证，属于标准协议。 `README.md` 文件描述了漏洞和如何使用 Nuclei 模板进行检测。`template.yaml` 文件包含 Nuclei 模板的具体配置，它定义了如何发送请求以及如何识别 rsync 服务的协议版本。仔细检查了 Nuclei 模板代码，没有发现任何尝试进行恶意操作的代码。此仓库中没有发现隐藏的投毒代码，因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要建立与易受攻击的 rsync 服务器的连接。
2.  攻击者在数据传输过程中发送特制的校验和长度 (s2length)，使其大于 SUM_LENGTH (16 字节)。
3.  当 rsync 守护进程处理此校验和时，由于不正确的边界检查，它会将数据写入 sum2 缓冲区之外，导致堆缓冲区溢出。
4.  攻击者可以通过控制溢出的数据来覆盖堆上的其他数据结构，最终实现远程代码执行。
简而言之，利用方式是通过发送特制的 rsync 协议数据包，其中包含过长的校验和长度，从而触发堆缓冲区溢出并实现远程代码执行。

**项目地址:** [rxerium/CVE-2024-12084](https://github.com/rxerium/CVE-2024-12084)

**漏洞详情:** [CVE-2024-12084](https://nvd.nist.gov/vuln/detail/CVE-2024-12084)

---

## POC #3

**来源**: [CVE-2024-12084-themirze_cve-2024-12084.md](../2024/CVE-2024-12084-themirze_cve-2024-12084.md)

## CVE-2024-12084-Rsync-堆缓冲区溢出

**漏洞编号:** CVE-2024-12084

**漏洞类型:** 堆缓冲区溢出

**影响应用:** Rsync

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 3.2.7, 3.3.0

**利用条件:** 需要网络访问Rsync服务，匿名读取权限或已知用户名密码

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-12084是Rsync守护进程中的一个基于堆的缓冲区溢出漏洞。由于不正确处理攻击者可控的校验和长度 (s2length)，当 MAX_DIGEST_LEN 超过固定的 SUM_LENGTH (16 字节) 时，攻击者可以在 sum2 缓冲区中进行越界写入。

**有效性：**
根据漏洞库信息和GitHub漏洞库信息,可知此漏洞POC可用。提供的Python脚本并没有直接利用堆缓冲区溢出漏洞，而是尝试利用rsync的配置错误（如匿名访问）进行文件上传，如果目标rsync服务器配置不当存在可以上传文件的模块，脚本能够上传文件。

**投毒风险：**
该脚本的主要功能是枚举rsync模块并测试写入权限。脚本没有明显的恶意代码，例如反向shell、downloader等。风险较低，但仍存在潜在风险，脚本可能被修改后用于恶意目的，例如上传包含恶意代码的文件，考虑到作者未经验证，因此投毒风险概率评估为 1%。

**利用方式：**
1.  **扫描目标：** 使用提供的脚本扫描指定IP列表中的Rsync服务(端口873)。
2.  **枚举模块：**  尝试列出Rsync服务器上可用的模块。
3.  **权限测试：**  针对每个模块，尝试写入文件，以确定是否具有写入权限。如果成功写入，则表明目标存在配置错误，可能允许恶意文件上传，存在进一步利用的可能，但是上传本身并没有直接利用 CVE-2024-12084。

**结论：**
虽然提供的脚本本身并没有直接利用 CVE-2024-12084 漏洞进行堆缓冲区溢出攻击，但是如果结合其他exp，可能会成功利用该漏洞进行RCE。

**项目地址:** [themirze/cve-2024-12084](https://github.com/themirze/cve-2024-12084)

**漏洞详情:** [CVE-2024-12084](https://nvd.nist.gov/vuln/detail/CVE-2024-12084)

---

