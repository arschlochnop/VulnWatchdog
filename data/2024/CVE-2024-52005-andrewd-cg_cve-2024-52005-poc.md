## CVE-2024-52005 - Git / DHI ArgoCD ANSI转义序列注入 (CWE-150)

**漏洞编号:** CVE-2024-52005

**漏洞类型:** ANSI转义序列注入 (CWE-150)

**影响应用:** Git / DHI ArgoCD

**危害等级:** 中等

**CVSS评分:** 5.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N)

**影响版本:** Git <= 2.47.3; DHI ArgoCD containers using vulnerable Git versions

**利用条件:** 攻击者需能够控制受害者克隆或访问的Git存储库内容，且受害者需通过终端查看Git侧边栏(sideband)输出。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC针对CVE-2024-52005提供了极高完整性的验证框架。漏洞核心在于Git在处理远程存储库回传的sideband消息时，未能正确过滤或转义ANSI控制字符。POC通过Python脚本(`exploit_cve_2024_52005.py`)自动化构建包含恶意Git钩子（如post-checkout）的存储库。其有效性在于它不仅验证了字符显示，还通过8种不同负载（如`hide_command`和`fake_vulnerability_scan`）演示了如何利用ANSI转义序列操纵终端缓冲区。攻击者可以利用`\x1b[2J`清屏或`\x1b[A`向上移动光标来覆盖合法的安全警告，甚至在视觉上诱导管理员执行看起来无害但实际危险的命令。在DHI ArgoCD环境下的测试证明，即使容器声称不受影响，由于其底层依赖的Git版本低于2.47.3且其核心功能就是克隆第三方库，该漏洞依然可以通过自动化流水线的日志输出造成严重的社会工程学威胁。利用步骤：1. 使用POC脚本创建恶意仓库：`./exploit_cve_2024_52005.py create social_engineering`。2. 在受控Git服务器（或模拟环境）上托管该仓库。3. 诱导目标使用受影响的Git客户端或CI/CD平台（如ArgoCD）执行克隆/更新操作。4. 观察终端或CI/CD日志，恶意构造的ANSI序列将修改屏幕输出。投毒风险分析：该POC本身具有清晰的防御性研究意图，代码结构透明，使用了标准Python库且未包含加密混淆或可疑的外部网络请求，因此直接投毒风险较低（约15%）。主要的风险点在于POC脚本中包含的‘恶意’Git钩子生成逻辑，这些钩子虽然是为了演示ANSI注入，但如果被未经审查地部署到生产环境，可能会触发非预期的自动执行行为。此外，脚本在本地创建并操作Git仓库，涉及文件系统写入。通过分析其`QUICKSTART.md`，该工具链主要用于红队演练或安全审计，旨在反驳供应商的不实安全声明（VEX）。防御者在使用时应在隔离的沙箱环境运行，重点防御手段应为升级Git客户端至2.48.0或更高版本，并在CI/CD展示界面强制对ANSI转义序列进行剥离或静态转义。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2024-52005](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2024-52005) (推测路径)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-52005](https://nvd.nist.gov/vuln/detail/CVE-2024-52005)
