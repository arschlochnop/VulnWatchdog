# CVE-2024-6387

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-6387-AzrDll_CVE-2024-6387.md](../2024/CVE-2024-6387-AzrDll_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH 竞争条件导致 RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。需要发起大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务中的一个竞争条件漏洞，源于 CVE-2006-5051 的回归。未经身份验证的远程攻击者可以通过在短时间内发起大量失败的身份验证尝试来触发此漏洞。利用此漏洞需要在glibc堆中插入指令，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞确实存在，并且有公开的PoC利用代码。该PoC通过建立大量的 SSH 连接并进行不成功的身份验证来触发竞争条件。参考[webpage 3]，此漏洞允许glibc Linux发行版在堆中插入指令，从而实现代码执行。提供的PoC代码尝试利用这一点，但成功率可能较低，因为竞争条件需要精确的时间控制。

**投毒风险：**
提供的PoC代码`/tmp/fe03af2a23123389ff9785e2fb119f2c/PoC.py` 包含了从文件中读取glibc地址的功能。 虽然代码本身没有明显的恶意行为，但如果提供的 `glibc_file` 包含恶意构造的地址，可能会导致非预期的行为，甚至导致拒绝服务。例如，如果`glibc_base`地址指向了关键系统函数，覆盖该地址可能造成系统崩溃。另一个潜在的风险点是 `timing_adjustment`，如果调整不当可能造成DoS。综上所述，投毒风险为10%。主要是考虑到作者可能在利用代码的 `glibc_file` 参数中提供恶意的 glibc 地址，诱导用户使用，从而达到破坏目标系统的目的。

**利用方式：**
1.  **建立连接：** 攻击者首先建立与目标 OpenSSH 服务器的 TCP 连接。
2.  **SSH 握手：** 攻击者执行 SSH 握手过程，例如发送 SSH 版本字符串。
3.  **堆准备：** PoC尝试在堆上分配一些数据，为利用竞争条件做准备。
4.  **触发竞争条件：**  通过快速发送大量失败的身份验证请求，攻击者试图触发 `sshd` 进程中的竞争条件。这涉及利用 `LoginGraceTime` 参数，该参数允许攻击者在身份验证超时之前发送多个请求。根据[webpage 6]，利用此漏洞需要大量连接尝试才能准确触发竞争条件。
5.  **代码执行：**  如果竞争条件被成功触发，攻击者可以在内存中写入恶意代码，从而实现远程代码执行。提供的 PoC 代码尝试通过覆盖 glibc 的地址来实现这一点。如果成功利用，攻击者可以获得 root 权限，如[webpage 1][webpage 4]所描述。
6.  **拒绝服务：** 即使未能成功实现 RCE，攻击者也可能通过耗尽服务器资源来实现拒绝服务。由于竞争条件涉及信号处理，不正确的信号处理可能导致 `sshd` 崩溃。

**项目地址:** [AzrDll/CVE-2024-6387](https://github.com/AzrDll/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #2

**来源**: [CVE-2024-6387-DimaMend_cve-2024-6387-poc.md](../2024/CVE-2024-6387-DimaMend_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行(RCE)和拒绝服务(DoS)

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，并且目标系统基于glibc。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全漏洞，它是由CVE-2006-5051引入的回归错误。该漏洞是一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**利用方式：**

1.  **建立连接：** 攻击者首先与易受攻击的OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者尝试进行SSH握手，但故意不完成身份验证过程。这是为了触发`LoginGraceTime`超时。
3.  **堆准备：** 攻击者发送一系列SSH数据包，旨在操纵服务器的内存堆的布局。 这可能涉及到分配和释放内存，以便为利用创造合适的条件。
4.  **触发竞争条件：** 攻击者利用`LoginGraceTime`超时机制。当服务器由于握手超时而即将终止连接时，会发送一个信号。 攻击者尝试与此信号处理程序执行竞争，以修改服务器的内存。
5.  **代码执行：** 如果竞争成功，攻击者可以将恶意代码注入到服务器的内存中，并获得代码执行能力。 根据具体利用方式，这可能导致以root权限执行代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞的利用是可行的。许多信息源表明，存在公开可用的PoC，并且已经有人成功利用了此漏洞。 PoC代码的功能是尝试利用这个竞态条件。

**投毒风险分析：**

PoC代码中存在投毒代码的风险很低，原因如下：

*   **代码结构：** 代码主要集中于建立连接、进行SSH握手、操纵堆内存以及尝试触发竞态条件。虽然代码较为复杂，但在总体流程上没有明显的恶意操作。
*   **Shellcode占位符：** 代码中存在一个 `shellcode` 占位符，明确提示用户需要替换成实际的 shellcode。这表明作者的意图是提供一个框架，而不是一个直接可用的恶意载荷。
*   **注释和说明：** 代码包含大量的注释和说明，解释了漏洞的原理、利用方法以及需要调整的参数。这表明作者的目的是帮助研究人员理解和复现漏洞，而不是隐藏恶意代码。
*   **随机性和尝试次数：** 代码包含大量的随机尝试，目的是为了提高漏洞利用的成功率。这种随机性使得代码难以预测，也增加了作者插入恶意代码的难度。
*   **外部依赖：** 代码没有包含明显的外部依赖或网络请求，这降低了其被用于下载或执行恶意代码的风险。

虽然直接投毒的可能性较低，但仍然存在一些潜在风险，比如在 `shellcode` 占位符中插入恶意代码，或者在调整参数的过程中引入错误，导致程序行为异常。因此，在使用 PoC 代码时，仍然需要进行仔细的代码审查和安全测试。

综上所述，此仓库中存在作者隐藏的投毒代码的可能性估计为1%。

**项目地址:** [DimaMend/cve-2024-6387-poc](https://github.com/DimaMend/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #3

**来源**: [CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行存在漏洞版本的OpenSSH服务，且攻击者能够建立SSH连接，并在认证超时前发送恶意数据。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，存在于glibc的linux系统。它源于一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该漏洞是有效的。多个来源都确认了该漏洞的存在以及其远程代码执行的潜力。POC代码的存在进一步支持了其可利用性。

**投毒风险：**

POC代码本身包含以下潜在的投毒风险点：

*   **Shellcode占位符:** 代码中明确提到 `Shellcode placeholder (replace with actual shellcode)`。如果用户直接使用未经审查的 shellcode，则可能引入恶意行为。此处的风险不在于作者投毒，而在于用户使用不当。
*   **GLIBC_BASES:**  `GLIBC_BASES[]` 数组包含可能的 glibc 基地址。如果这个地址不准确，利用将失败。如果作者故意提供错误的地址，可能会导致拒绝服务或误导分析。
*   **Timing parameters:** 注释提到需要根据目标系统调整 timing 参数。错误的 timing 可能导致利用失败或系统不稳定。
*   **Heap layout 和 File structure offsets:**  代码注释中也强调了需要针对不同的 OpenSSH 和 glibc 版本进行调整，否则利用会失败。故意设置错误的值可能导致程序崩溃或产生其他未定义行为。
*   **随机数生成:** 代码使用 `srand(time(NULL))` 初始化随机数生成器。虽然这本身不是投毒，但如果后续利用中依赖于可预测的随机数，可能会被利用。

总体评估投毒风险为30%。风险主要来自于需要用户自行替换的shellcode，以及需要用户根据目标环境配置的参数。作者本身隐藏恶意代码的可能性较低，但用户在使用过程中存在引入风险的可能性。

**利用方式：**

1.  **建立连接：** 攻击者首先需要建立与目标 OpenSSH 服务器的连接。
2.  **SSH握手：** 进行初步的SSH握手过程，包括版本协商和密钥交换的初始化，但无需完成身份认证。
3.  **堆准备：**  `prepare_heap` 函数的目的是在堆上创建特定的布局，为后续的利用创造条件。具体实现细节未给出，但可能涉及分配和释放内存，以控制堆的状态。
4.  **时间测量：** `time_final_packet` 函数测量服务器处理特定数据包所需的时间。这个时间信息对于后续的竞争条件利用至关重要。
5.  **竞争条件：**  `attempt_race_condition` 函数尝试触发漏洞的核心：信号处理程序中的竞争条件。这通常涉及发送一个精心构造的数据包，该数据包会在服务器处理过程中触发 SIGALRM 信号。由于信号处理程序使用了异步信号不安全函数，因此可能导致堆损坏。
6.  **代码执行：**  如果竞争条件成功触发，攻击者就可以利用堆损坏来执行任意代码。这通常涉及覆盖函数指针或控制程序的执行流程。

该漏洞的利用依赖于精确的 timing 和对目标系统内存布局的了解。攻击者需要进行大量的尝试才能成功利用该漏洞。

**项目地址:** [HadesNull123/CVE-2024-6387_Check](https://github.com/HadesNull123/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #4

**来源**: [CVE-2024-6387-Karmakstylez_CVE-2024-6387.md](../2024/CVE-2024-6387-Karmakstylez_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器(sshd)中的一个安全回归漏洞，存在于glibc-based Linux系统。该漏洞源于信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。该漏洞利用代码尝试通过大量的连接请求触发竞争条件，通过调整glibc基地址和定时参数绕过ASLR，将恶意代码注入到堆中，最终实现以root权限远程代码执行。

有效性：根据漏洞信息和搜索结果，此POC代码具备一定的有效性，但成功利用需要满足特定条件，例如目标系统使用glibc，以及OpenSSH版本在受影响范围内。同时，漏洞利用的成功率受到系统负载、网络延迟等因素的影响，需要进行大量的尝试。

投毒风险：POC代码中存在一定的投毒风险。虽然POC代码的主要目的是利用已知的漏洞，但攻击者可能在代码中加入恶意功能，例如植入后门、收集敏感信息等。例如，shellcode 部分是明显的注入点。风险评定为10%，主要基于以下几点：
1.  **Shellcode 替换：** 代码明确指出 `shellcode` 变量是占位符，需要替换为实际的 shellcode。如果用户不小心使用了包含恶意指令的 shellcode，则可能导致投毒。
2.  **glibc 基地址猜测：** 虽然代码尝试多个 glibc 基地址，但如果攻击者预先知道目标系统的 glibc 地址，则可以修改 `GLIBC_BASES` 数组以提高利用成功率，同时也可能引入恶意地址。
3.  **Timing 参数调整：** 代码中的 `usleep` 函数用于控制连接尝试之间的延迟。攻击者可以通过调整这些参数来优化漏洞利用，但也可能引入导致拒绝服务 (DoS) 的参数。
4.  **编译选项：**POC 需要编译，攻击者可以在编译时添加额外的恶意编译选项，例如禁用安全特性等。
5.  **作者本身:** 仓库作者有投毒行为.

利用方式：
1.  攻击者首先需要确定目标系统是否运行受影响的OpenSSH版本，以及是否基于glibc。
2.  攻击者发起大量的SSH连接请求，尝试触发竞争条件。
3.  攻击者利用精心构造的数据包覆盖堆上的特定内存区域，将恶意代码注入到sshd进程中。
4.  一旦恶意代码成功执行，攻击者即可获得目标系统的控制权。

**项目地址:** [Karmakstylez/CVE-2024-6387](https://github.com/Karmakstylez/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #5

**来源**: [CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md](../2024/CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md)

## CVE-2024-6387-OpenSSH-RegreSSHion-RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行并获取 root 权限或造成拒绝服务

**影响版本:** <= 9.7p1 (受影响版本 8.5p1 至 9.7p1)

**利用条件:** 需要目标服务器运行受影响版本的OpenSSH，且存在时间窗口内的未认证连接尝试。高危利用场景依赖glibc环境。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-6387，也被称为“regreSSHion”，是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞（CVE-2006-5051）。该漏洞源于信号处理中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC已经存在，并且能够实现远程代码执行和拒绝服务攻击。很多安全厂商和研究人员都发布了相关的分析报告和PoC代码。

**投毒风险：**
提供的漏洞利用代码（/tmp/270e32ae67508359811c0f9899155269/README.md 和 LICENSE）仅仅是声明了存在POC，根据现有信息，该仓库本身存在恶意代码的风险较低。但是，由于POC的执行具有高危性，在实际使用中，仍需要进行安全审查。

**利用方式：**
1.  **竞争条件：** 攻击者通过在短时间内发起大量未认证的连接尝试，触发 `sshd` 中的竞争条件。
2.  **信号处理：** 在特定的时间窗口内，`sshd` 可能会以不安全的方式处理信号，导致内存损坏或其他异常行为。
3.  **远程代码执行/拒绝服务：**  利用内存损坏或其他异常行为，攻击者可以执行任意代码（RCE），或导致 `sshd` 崩溃，造成拒绝服务（DoS）。部分利用依赖特定的glibc环境。
4.  **ProxyCommand注入:** 根据github仓库的README.md描述，该POC利用了 `ProxyCommand` 配置不当或滥用的情况，攻击者可以注入恶意命令到 `ProxyCommand` 中，从而获得命令执行或者横向渗透的能力。

**缓解措施：**
*   升级到 OpenSSH 9.8 或更高版本。
*   设置 `LoginGraceTime 0` 以禁用在指定超时时间内未完成身份验证时服务器断开连接的功能（Red Hat 建议的临时缓解措施，但会使服务器更容易受到 DoS 攻击）。
*   使用 `fail2ban` 等工具，配合防火墙来监控日志文件并适当管理连接。

**项目地址:** [Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC](https://github.com/Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #6

**来源**: [CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md](../2024/CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）或拒绝服务（DoS）

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。它是一个竞争条件漏洞，可能导致sshd以不安全的方式处理信号。远程攻击者可以通过在设定的时间内未能成功验证身份来触发此漏洞，从而可能导致远程代码执行或拒绝服务。

**有效性评估：**

根据漏洞库信息、搜索结果以及提供的POC代码来看，此漏洞的POC是存在的，并且多个安全厂商都发布了相关的分析报告和检测方法。搜索结果也表明此漏洞允许远程未授权代码执行。

**利用方式：**

1.  攻击者建立与目标OpenSSH服务器的连接。
2.  进行SSH握手，获取服务器banner。
3.  准备堆，发送一定量的填充数据。
4.  尝试触发竞争条件，通过发送包含`glibc_base`地址的payload，并附加一些`nop`指令。
5.  如果成功，则在服务器上执行代码，获得root权限。
6.  脚本使用了多线程来增加攻击成功的几率，并对时序进行调整。

**投毒风险评估：**

提供的POC代码（`Exploit_2024_6387.py`）本身是一个漏洞利用脚本，其目的是利用目标系统的漏洞。评估投毒风险主要关注作者是否在脚本中植入了恶意代码，例如：

*   **后门代码：**  脚本在成功利用漏洞后，是否会创建一个后门，允许攻击者在未经授权的情况下再次访问系统。
*   **破坏性代码：**  脚本是否包含旨在破坏目标系统或数据的代码。
*   **信息窃取代码：**  脚本是否会窃取目标系统上的敏感信息。

分析代码发现，虽然脚本本身旨在利用漏洞，但并未发现明显的后门、破坏性或信息窃取代码。 然而，需要注意的是，该脚本的`TARGET_IP`和`TARGET_PORT`是硬编码的，在实际使用中需要进行修改。此外，攻击者可能会修改此脚本以包含恶意功能。此处的`glibc_base`地址也需要根据目标环境进行调整，否则利用大概率会失败，这也是成功利用此漏洞的难点之一。

综合来看，该仓库存在投毒风险的可能性较低，但是不排除有攻击者对代码进行修改后，二次传播。因此，建议在使用前仔细审查代码。

**风险评估：**
`poison`的百分比评估主要考虑以下几个方面：

*   **代码复杂性：** 代码越复杂，隐藏恶意代码的可能性越高。
*   **作者信誉：** 如果作者的信誉未知或可疑，则风险越高。
*   **代码审查：** 代码是否经过其他安全研究人员的审查。

根据以上分析，此脚本的`poison`风险评估为10%。

**项目地址:** [SkyGodling/CVE-2024-6387-POC](https://github.com/SkyGodling/CVE-2024-6387-POC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #7

**来源**: [CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md](../2024/CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，未认证的远程攻击者通过在设定的时间内认证失败触发

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞(CVE-2006-5051)。它存在一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，进而导致远程代码执行(RCE)或拒绝服务(DoS)。

根据搜索结果和漏洞信息，该漏洞影响glibc-based Linux系统，利用需要发起大量连接尝试来触发竞争条件。

提供的漏洞利用代码 `scanner.py` 是一个版本扫描器，并非直接利用 CVE-2024-6387。它用于检测目标 SSH 服务器的版本，并根据预定义的 CVE 列表判断是否存在已知的漏洞。该脚本通过创建 socket 连接到目标主机的 SSH 端口，然后发送一个空字节并接收服务器的响应，从中提取 OpenSSH 的版本信息。然后将提取的版本与易受攻击的版本列表进行比较。

**漏洞利用方式：**

1.  攻击者需要向目标 OpenSSH 服务器发起大量的连接请求。
2.  在连接建立后，故意触发认证失败，从而在信号处理过程中创建竞争条件。
3.  竞争条件允许攻击者在某些 glibc Linux 发行版中将指令插入堆中，进而实现远程代码执行。

**投毒风险：**

虽然脚本本身是一个版本扫描器，而不是直接的漏洞利用程序，但仍需谨慎评估其潜在的投毒风险。 代码中存在创建日志目录并记录扫描结果的行为，存在恶意修改扫描逻辑或在日志中写入恶意数据，但可能性极低。因此，评估投毒风险为1%。

**项目地址:** [ThatNotEasy/CVE-2024-6387](https://github.com/ThatNotEasy/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #8

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 远程代码执行/拒绝服务

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1，受影响版本包括8.5p1至9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且攻击者能够发起大量连接请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞，它源于 CVE-2006-5051。该漏洞是一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间段内未能通过身份验证来触发此漏洞。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的PoC代码是有效的。多个来源证实了该漏洞的存在和可利用性，特别是针对glibc的Linux系统。

**投毒风险：**

提供的PoC代码包含用于编译、构建和利用漏洞的Dockerfile和Python脚本。通过分析代码，可以发现以下潜在的投毒风险因素：

*   **依赖项：** Dockerfile中使用了`wget`和`curl`来下载OpenSSH源码，存在被中间人攻击替换为恶意源码的风险。尽管校验和可以降低这种风险，但如果攻击者能够控制构建环境，仍然可能引入恶意代码。
*   **shellcode：** Python脚本包含一个名为`shellcode`的变量，目前只是占位符，但攻击者可以修改此变量，插入恶意shellcode。攻击者可以精心构造shellcode，以执行恶意操作，例如安装后门、窃取数据或提权。

虽然这些风险存在，但从现有代码来看，没有发现明显的恶意代码。因此，评估投毒风险为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的OpenSSH环境（32位Linux系统）。
2.  **SSH握手：** 客户端与服务器建立连接，发送SSH版本信息并进行密钥交换（KEX）初始化。
3.  **堆准备：** 通过发送特定大小的数据包来布置堆内存，利用glibc的漏洞插入恶意指令。
4.  **触发竞争条件：** 大量连接尝试来触发信号处理程序中的竞争条件。
5.  **执行代码：** 成功触发竞争条件后，恶意代码将被执行，从而实现远程代码执行。

总体来说，利用方式较为复杂，需要精心构造数据包和进行大量的连接尝试才能成功。

**项目地址:** [YassDEV221608/CVE-2024-6387](https://github.com/YassDEV221608/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #9

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 9.7p1 (影响 8.5p1 到 9.7p1)

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，并且是基于glibc的Linux系统。攻击者需要能够建立到SSH服务的网络连接，并能够快速发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中发现的一个安全回归漏洞，存在于glibc的Linux系统中。该漏洞是由于OpenSSH服务器（sshd）中的信号处理存在竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用此漏洞可能导致以 root 身份远程执行代码。

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果也确认了该漏洞的存在，并描述了其可能导致远程代码执行的风险。漏洞利用代码的存在也进一步证实了漏洞的有效性，代码尝试利用竞争条件来执行任意代码。

**投毒风险：**
代码存在一定的投毒风险的可能性。虽然代码本身看起来是在尝试利用该漏洞，但以下因素需要考虑：

1.  **Shellcode占位符：** 代码中包含一个shellcode占位符`unsigned char shellcode[] = "\x90\x90\x90\x90";`，明确指示需要替换成实际的shellcode。如果用户没有意识到这一点，或者使用了恶意shellcode，可能会造成损害。这里的投毒风险在于，攻击者可能发布包含恶意shellcode的exp，诱导用户使用。 
2.  **GLIBC_BASES：** 代码中定义了`GLIBC_BASES[]`，用于绕过ASLR。如果这些地址不正确，利用将失败。更糟糕的是，如果攻击者故意提供错误的地址，可能会导致程序崩溃或其他不可预测的行为。
3.  **Timing parameters和 Heap layout 需要调整：** 代码注释中强调了定时参数和堆布局需要根据目标系统进行调整。如果这些参数设置不正确，可能会导致利用失败或目标系统不稳定。
4.  **文件结构偏移量：** 代码提到需要验证特定glibc版本的文件结构偏移量。使用错误的偏移量可能导致内存损坏或其他不可预测的行为。

总体来看，该POC的复杂性和对系统内部结构的依赖性，投毒者可以通过提供不正确的配置参数，或者引导用户使用错误的shellcode，达到破坏目标系统的目的。因此存在10%的投毒风险。

**利用方式：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **建立连接：** 攻击者首先需要与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者需要完成初始的SSH握手过程，包括协议版本交换和密钥交换初始化（KEX）。
3.  **堆准备：** 攻击者利用SSH协议发送数据包，在内存堆上布置精心构造的数据结构，为后续的漏洞利用做准备。
4.  **触发竞争条件：** 攻击者发送一个特制的SSH数据包，该数据包的设计是为了触发sshd中的竞争条件。具体来说，它利用了在身份验证失败的情况下，信号处理程序中的不安全操作。
5.  **RCE：** 成功触发竞争条件后，攻击者可以将恶意代码注入到sshd进程中，从而实现远程代码执行。具体是通过内存操作覆盖某个函数指针，使其指向攻击者提供的shellcode。
6.  **提权（Root）：** 由于sshd通常以root权限运行，因此攻击者执行的shellcode也将以root权限运行，从而完全控制目标系统。

**项目地址:** [YassDEV221608/CVE-2024-6387_PoC](https://github.com/YassDEV221608/CVE-2024-6387_PoC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #10

**来源**: [CVE-2024-6387-alex14324_ssh_poc2024.md](../2024/CVE-2024-6387-alex14324_ssh_poc2024.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）和拒绝服务（DoS）

**影响版本:** <= 9.7p1

**利用条件:** 需要目标系统开启sshd服务，且受影响的OpenSSH版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是一个存在于OpenSSH服务器（sshd）中的安全漏洞，具体来说是一个竞争条件漏洞。该漏洞源于OpenSSH处理信号的方式。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，导致sshd以不安全的方式处理信号。这可能导致远程代码执行（RCE），攻击者获得root权限，或拒绝服务（DoS），使服务器不可用。

**有效性分析：**
从漏洞库信息、搜索结果和提供的PoC代码来看，该漏洞的PoC是存在的，并且被广泛讨论和利用。 搜索结果中提到“regreSSHion (CVE-2024-6387) is an unauthenticated RCE vulnerability in OpenSSH’s server, affecting glibc-based Linux systems. Full root access is granted.” 表明该漏洞有很高的潜在影响. PoC代码也试图绕过ASLR，并包含shellcode的占位符，表明攻击者可以注入恶意代码。

**投毒风险分析：**
提供的PoC代码具有一定的投毒风险，大约为10%。主要基于以下几点：
1.  **Shellcode占位符：** 代码中包含`unsigned char shellcode[] = "\x90\x90\x90\x90";`。虽然这只是一个占位符，需要用户替换为实际的shellcode，但攻击者可能发布包含恶意shellcode的版本，诱导用户使用。
2.  **GLIBC_BASES地址：**  代码中包含了`uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`。这些地址是ASLR绕过的尝试，但如果攻击者故意提供错误的地址，可能导致利用失败或者其他未知的行为，但一般不会产生特别大的危害。
3.  **Timing参数：** 代码中需要根据目标系统响应调整Timing参数。攻击者可能提供不合适的参数，导致利用不稳定或者失败。
4.  **Heap Layout和文件结构偏移：**  代码注释中提到“Heap layout : Requires tweaking for different OpenSSH versions.” 和 “File structure offsets: Verify for the specific glibc version.”。攻击者可能故意提供错误的值，导致利用失败或者产生其他问题。

**利用方式：**
1.  **建立连接：** 攻击者首先需要与目标服务器的sshd服务建立TCP连接。
2.  **SSH握手：** 进行SSH握手，包括版本交换、密钥交换等步骤。PoC代码中的 `perform_ssh_handshake` 函数实现了这些步骤。
3.  **堆准备：** 通过发送特定的SSH数据包，在sshd进程的堆上分配内存，并控制堆的布局。`prepare_heap` 函数用于执行此操作。
4.  **时间计算：**  计算处理最终数据包所需的时间，用于后续的竞争条件利用。`time_final_packet` 函数用于执行此操作。
5.  **竞争条件利用：**  通过大量并发连接，触发sshd中的竞争条件漏洞。攻击者不断尝试进行身份验证，但故意失败，以触发SIGALRM信号处理程序。由于信号处理程序中使用了非异步信号安全的函数，可能导致内存损坏和代码执行。`attempt_race_condition` 函数用于执行此操作。
6.  **ASLR绕过：**  由于地址空间布局随机化（ASLR）的存在，攻击者需要知道glibc的基地址。PoC代码中包含了一组可能的基地址，并尝试逐个利用。
7.  **代码注入：** 成功利用竞争条件后，攻击者可以将恶意代码（shellcode）注入到sshd进程的内存中。占位符需要替换。
8.  **代码执行：**  执行注入的shellcode，从而获得服务器的root权限。

**项目地址:** [alex14324/ssh_poc2024](https://github.com/alex14324/ssh_poc2024)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #11

**来源**: [CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md](../2024/CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH服务，并允许未授权的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)。

**有效性:**
根据搜索结果和漏洞库信息，此漏洞的PoC是存在的，并且已经被公开。多个来源证实了该漏洞的存在，以及它可能导致远程代码执行。提供的“漏洞利用代码”实际上是一个缓解脚本，旨在通过升级OpenSSH版本或禁用LoginGraceTime来降低风险，而不是一个实际的利用程序。

**投毒风险:**
提供的脚本主要功能是检测并修复漏洞，但仍然存在一定的投毒风险：
*   **依赖外部源：** 脚本使用`apt-get update`和`apt-get install`命令，依赖外部软件源。如果软件源被恶意篡改，可能导致安装恶意软件包。
*   **配置修改：** 脚本会修改`/etc/ssh/sshd_config`文件，存在被恶意利用修改配置的风险。
*   **权限提升：** 脚本需要root权限运行，如果脚本被篡改，可能导致提权攻击。
综合考虑，该脚本存在一定的投毒风险，但主要风险在于依赖的外部源和配置修改，因此投毒风险评估为10%。

**利用方式:**
此漏洞的利用方式是利用 sshd 进程处理信号时的竞争条件。攻击者需要发起大量连接尝试，并在身份验证失败时触发竞争条件。成功触发后，攻击者能够在目标系统上执行任意代码。根据 offsec.com 的博客文章，此漏洞利用机会在某些 glibc Linux 发行版中，能将指令插入堆中。

**项目地址:** [almogopp/OpenSSH-CVE-2024-6387-Fix](https://github.com/almogopp/OpenSSH-CVE-2024-6387-Fix)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #12

**来源**: [CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md](../2024/CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许未授权网络访问SSH端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387 (regreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的安全回归漏洞，源于 CVE-2006-5051。这是一个竞争条件漏洞，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内身份验证失败来触发此漏洞。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经公开。多个安全厂商和研究人员已经发布了关于此漏洞的分析和PoC代码。

**投毒风险分析：**

提供的Checker.py脚本的主要功能是检测目标SSH服务器是否存在CVE-2024-6387漏洞。它通过连接到目标服务器的SSH端口并获取SSH banner信息，然后将其与已知易受攻击和已修补的版本进行比较来确定漏洞状态。 代码中没有发现任何明显的恶意或后门代码。

投毒风险评估：0%。该脚本主要用于漏洞检测，不包含任何主动利用漏洞的代码，也没有发现作者隐藏的恶意代码。

**利用方式分析：**

1.  **漏洞原理：** 漏洞是由于 OpenSSH 在处理信号时存在竞争条件，允许在身份验证失败期间执行恶意代码。
2.  **攻击步骤：** 攻击者需要向目标服务器发起大量的SSH连接尝试。
3.  **触发条件：** 在连接尝试期间，攻击者故意使身份验证失败，触发竞争条件。
4.  **利用结果：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码，以root权限运行，或者造成拒绝服务攻击。
5.  **缓解措施：** 通过设置 `LoginGraceTime 0` 禁用 `LoginGraceTime` 参数可以缓解远程代码执行的风险，但仍然存在拒绝服务的风险。更新到OpenSSH 9.8或更高版本是完整的修复方案。

**项目地址:** [anhvutuan/CVE-2024-6387-poc-1](https://github.com/anhvutuan/CVE-2024-6387-poc-1)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #13

**来源**: [CVE-2024-6387-awusan125_test_for6387.md](../2024/CVE-2024-6387-awusan125_test_for6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要目标系统基于 glibc，且 OpenSSH 版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理程序中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用可能允许攻击者在目标系统上以 root 权限执行任意代码或导致拒绝服务。

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞的 PoC 已被公开，并且漏洞利用的复杂性较高。搜索结果表明，该漏洞影响 glibc 基础的 Linux 系统。提供的 POC 代码似乎旨在利用此漏洞。

**投毒风险分析：**
该 POC 代码中存在一定的投毒风险，大约 20%。原因如下：
*   **Shellcode 占位符:** 代码中包含 `unsigned char shellcode[] = "\x90\x90\x90\x90";` 这一行，明确指出需要替换为实际的 shellcode。如果用户不小心使用了该占位符，或者植入了其他有害 shellcode，则可能导致不可预期的后果。
*   **GLIBC 基地址硬编码:** 代码中定义了 `uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`，并表示 “Needs adjustment for specific target systems”。如果 GLIBC 基地址不正确，可能导致利用失败，甚至造成程序崩溃。攻击者可能会故意提供错误的基地址，使得用户在尝试利用时受到干扰，或者执行其他恶意操作。
*   **Timing 参数需要微调:** 代码注释中提到 “Timing parameters: Fine-tune based on target system responsiveness”。如果 timing 参数设置不当，可能导致竞争条件无法触发，或者引发其他问题。攻击者可能会提供误导性的 timing 参数，使得用户在尝试利用时遇到困难，或者触发非预期的行为。
*   **Heap 布局和文件结构偏移量:** 代码注释提到 “Heap layout : Requires tweaking for different OpenSSH versions” 和 “File structure offsets: Verify for the specific glibc version.” 这表示该漏洞利用依赖于特定的堆布局和文件结构偏移量。如果这些值不正确，则可能导致利用失败，甚至造成程序崩溃。攻击者可能会提供不兼容的值，使得用户在尝试利用时受到干扰，或者触发非预期的行为。
*   **错误处理不完善:** 代码中虽然包含了一些错误处理逻辑，但可能存在未处理的异常情况。攻击者可能会利用这些漏洞，使得程序在特定条件下崩溃或执行非预期的操作。

**利用方式：**
利用方式主要涉及以下步骤：
1.  **建立连接：** 与目标 SSH 服务器建立 TCP 连接。
2.  **SSH 握手：** 执行 SSH 握手过程，包括版本交换和密钥交换。
3.  **堆准备：** 通过发送特定的数据包，在堆上创建特定的布局。
4.  **时间控制：** 精确控制数据包的发送时间，以便触发竞争条件。
5.  **竞争条件触发：** 通过大量连接尝试和认证失败，利用信号处理程序的竞争条件在内存中注入恶意代码，通常包括修改 glibc 的数据结构。
6.  **代码执行：** 利用注入的恶意代码来执行任意命令。
7.  **绕过 ASLR：** 由于地址空间布局随机化 (ASLR) 的存在，需要确定 glibc 的基地址。PoC 代码中尝试了几个常见的基地址。

总体而言，该漏洞利用较为复杂，需要对 SSH 协议、glibc 内部机制和竞争条件有深入的了解。该漏洞的成功利用还依赖于目标系统的特定配置和状态。

**项目地址:** [awusan125/test_for6387](https://github.com/awusan125/test_for6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #14

**来源**: [CVE-2024-6387-dream434_CVE-2024-6387.md](../2024/CVE-2024-6387-dream434_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，目标系统运行受影响的OpenSSH版本，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性评估：**

根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已经被广泛讨论。漏洞利用代码的脚本主要用于检测目标主机是否运行存在漏洞的OpenSSH版本，利用方式是扫描目标IP的22端口，获取OpenSSH版本信息，并与已知的易受攻击版本进行比较，从而判断目标系统是否存在漏洞。

**投毒风险分析：**

提供的漏洞利用代码（CVE-2024-6387.py）主要用于版本检测，功能相对简单。虽然`README.md`中包含克隆GitHub仓库的操作，但直接分析提供的Python脚本，发现潜在的投毒点在于以下几个方面：

1.  **依赖包风险：** 脚本本身依赖较少，但如果`README.md`引导用户安装额外的依赖包（例如通过`pip install -r requirements.txt`，而`requirements.txt`包含恶意包），则可能存在投毒风险。
2.  **命令执行风险：** `README.md` 中的运行命令 `python CVE-2024-6387.py http://exemple.com` 虽然看起来无害，但如果 `CVE-2024-6387.py` 存在漏洞，允许通过命令行参数执行恶意代码，则存在风险。当前提供的代码没有直接利用命令行参数执行代码的逻辑。
3.  **文件包含风险：** 如果脚本尝试动态加载其他文件（例如配置文件），而这些文件被篡改，则可能存在风险。

鉴于以上分析，以及`README.md`中存在引导用户克隆github仓库的操作，综合判断，存在较低的投毒风险，约为10%。主要基于假设恶意代码可能存在于被克隆仓库的其他文件中，或者存在利用脚本漏洞执行恶意代码的可能。

**漏洞利用方式：**

1.  **版本检测：** 攻击者首先需要确定目标系统上运行的OpenSSH版本是否在受影响的范围内（8.5p1 <= version <= 9.7p1）。
2.  **触发竞争条件：** 攻击者通过与目标SSH服务器建立连接，并在身份验证过程中故意失败，以触发漏洞相关的竞争条件。
3.  **代码执行：** 成功触发竞争条件后，攻击者可以利用该漏洞在目标系统上执行任意代码，通常以root权限执行。

搜索结果也表明，此漏洞允许未经身份验证的远程代码执行，并且影响基于glibc的Linux系统。因此，利用方式的核心在于触发竞争条件并利用glibc的特性来执行恶意代码。

**项目地址:** [dream434/CVE-2024-6387](https://github.com/dream434/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #15

**来源**: [CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标主机开启SSH服务，且攻击者能够发起大量连接尝试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是一个OpenSSH服务器中的竞争条件漏洞。它源于OpenSSH处理信号的方式，当SSH服务器在短时间内收到大量连接请求且认证失败时，可能导致信号处理不当，进而允许未经验证的远程攻击者在基于glibc的Linux系统上执行任意代码，获取root权限，或者导致拒绝服务。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC已发布，表明漏洞可被利用。提供的Python脚本`CVE-2024-6387-Vulnerability-Checker.py`是一个漏洞检测工具，通过检查SSH banner版本来判断目标是否存在漏洞。脚本本身并不能直接利用该漏洞进行RCE或DoS攻击，而是用来辅助确认目标系统是否在受影响的范围内。

**投毒风险：**
该Python脚本主要功能是检查OpenSSH版本，判断其是否在受影响的范围内。代码本身只包含版本检测逻辑，没有发现任何恶意代码或后门，因此投毒风险极低。可以认为投毒风险为0%。

**利用方式：**
1.  **版本检测：** 使用PoC脚本或类似工具检测目标SSH服务器的版本，确认其是否位于易受攻击的范围(8.5p1 <= OpenSSH <= 9.7p1)。
2.  **触发竞争条件：** 如果目标版本易受攻击，攻击者需要发起大量连接尝试，并在短时间内故意认证失败，以触发竞争条件。
3.  **代码执行（或DoS）：** 成功触发竞争条件后，利用glibc的堆操作特性，攻击者可以插入恶意指令到堆中，从而实现远程代码执行。另一种利用方式是耗尽服务器资源，造成拒绝服务攻击。

需要注意的是，利用此漏洞进行RCE需要对glibc堆操作有一定的了解，并且成功率可能不高。缓解措施包括禁用`LoginGraceTime`配置，并使用`fail2ban`等工具限制恶意连接。

**项目地址:** [filipi86/CVE-2024-6387-Vulnerability-Checker](https://github.com/filipi86/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #16

**来源**: [CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-regreSSHion

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1 (OpenSSH)

**利用条件:** 需要glibc-based Linux系统，以及OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞。漏洞源于OpenSSH服务器处理信号的方式存在问题，具体来说，当用户认证失败时，可能触发不安全的信号处理。远程攻击者可以通过在短时间内发起大量SSH连接尝试，并故意触发认证失败，从而引发竞争条件，最终可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据搜索结果（webpage 1, 3, 4, 5, 7, 8）和漏洞库信息，该漏洞已被确认为一个高危漏洞，并且存在公开的PoC（Proof of Concept）代码。虽然提供的POC代码只是一个包含漏洞描述的README.md文件，**不能直接运行，但是，github上存在可利用的POC**。该POC的有效性取决于目标系统是否满足漏洞利用的条件，即：
1.  使用受影响的OpenSSH版本（<= 9.7p1）。
2.  目标系统是基于glibc的Linux发行版。
3.  系统配置允许一定数量的并发连接。

**投毒风险：**
提供的POC代码（README.md）本身不包含任何可执行代码，因此直接的投毒风险很低。但需要注意的是，任何从互联网上下载的代码都存在潜在的风险。即使是看似无害的文档，也可能包含恶意链接或指令，引导用户下载或执行恶意代码。因此，下载和使用任何PoC代码时，都应该保持警惕，并进行充分的安全审查。

虽然提供的README.md文件本身投毒风险较低,但是考虑到实际利用中需要依赖其他EXP, 因此其他仓库被投毒的可能性相对较高。
风险评估：10%

**利用方式：**
根据漏洞描述和搜索结果，利用方式主要包括以下几个步骤：
1.  **大量连接请求：** 攻击者向目标OpenSSH服务器发起大量的并发连接请求。
2.  **触发认证失败：**  在连接请求中，故意提供错误的用户名或密码，触发认证失败事件。
3.  **竞争条件利用：**  通过大量认证失败事件，触发OpenSSH服务器中的竞争条件漏洞。
4.  **代码执行或DoS：** 成功利用漏洞后，攻击者可以执行任意代码（RCE）或导致服务器崩溃（DoS）。

需要注意的是，利用该漏洞需要一定的资源和技术，并且成功率可能不高。Red Hat 在其安全公告中指出，实现RCE需要相当多的资源投入。同时，修改sshd_config,设置LoginGraceTime为0可以有效避免远程代码执行，但仍存在拒绝服务风险.

**项目地址:** [identity-threat-labs/Article-RegreSSHion-CVE-2024-6387](https://github.com/identity-threat-labs/Article-RegreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #17

**来源**: [CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，sshd服务运行且存在于受影响版本范围内，目标系统是基于glibc的Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中发现的竞争条件漏洞。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发该漏洞。成功利用可能导致以root权限远程执行代码或拒绝服务。该漏洞的利用依赖于触发信号处理程序的竞争条件，攻击者需要发起大量连接尝试才能提高触发漏洞的几率。提供的PoC代码是一个漏洞验证工具，用于检测目标系统上运行的OpenSSH版本是否存在漏洞。它通过连接到目标SSH端口并检查SSH横幅来工作。如果横幅指示易受攻击的版本，则该工具会将目标标记为易受攻击。PoC代码本身似乎不包含任何明显的投毒代码。它仅仅用于验证漏洞是否存在，并不会主动进行利用。

**利用方式：**

1.  攻击者向目标服务器的SSH端口发起大量连接请求。
2.  连接请求需要故意失败，例如提供无效的用户名或密码，以便触发身份验证失败流程。
3.  攻击者利用OpenSSH处理信号时的竞争条件，将恶意指令插入堆中。
4.  如果竞争条件利用成功，攻击者即可在目标系统上以root权限执行任意代码或导致拒绝服务。

**项目地址:** [identity-threat-labs/CVE-2024-6387-Vulnerability-Checker](https://github.com/identity-threat-labs/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #18

**来源**: [CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md](../2024/CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统使用受影响的OpenSSH版本，基于glibc的Linux系统，且未禁用LoginGraceTime

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是一个存在于OpenSSH服务器(sshd)中的竞争条件漏洞。该漏洞源于OpenSSH在处理信号时存在不安全行为。远程攻击者通过在一定时间内认证失败，可以触发此漏洞，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**漏洞利用方式：**

1.  攻击者向目标服务器发起大量的SSH连接请求。
2.  在SSH认证过程中，攻击者故意使认证失败，触发LoginGraceTime超时。
3.  由于竞争条件，sshd可能在处理SIGALRM信号时进入不安全状态。
4.  在glibc-based的Linux系统上，这种不安全状态可能允许攻击者将指令插入到堆中，最终导致RCE。
5.  如果无法实现RCE，攻击者可以通过耗尽服务器资源，导致DoS。

**POC代码分析：**

提供的PoC代码`/tmp/d7c5471d195cdec17d8f4ebaf7516058/CVE-2024-6387_poc.py`的主要功能是检测目标SSH服务器的版本，判断其是否受CVE-2024-6387漏洞影响。它通过建立socket连接，发送`\x00`，接收SSH版本信息，并进行正则匹配来确定OpenSSH的版本。如果版本在易受攻击的范围内（8.5 <= 版本 < 9.8）,则输出目标系统可能存在漏洞。该PoC本身**不包含直接利用漏洞的代码**，仅仅用于版本检测。

`/tmp/d7c5471d195cdec17d8f4ebaf7516058/README.md` 提供了一个使用说明，介绍了如何使用该PoC。`/tmp/d7c5471d195cdec17d8f4ebaf7516058/ip-addr.list`包含需要检查的IP地址列表, 127.0.0.1是示例.

**有效性：**

提供的POC代码的**有效性在于验证目标系统是否存在漏洞**，而非直接利用该漏洞。根据搜索结果和漏洞描述，完整的漏洞利用需要更复杂的步骤和技术，例如大量连接尝试来触发竞争条件，以及精心构造的shellcode。因此，此PoC仅仅是前期验证步骤。

**投毒风险：**

该仓库中存在**投毒风险的可能性较低，约为10%**。PoC代码主要功能是版本检测，本身没有发现恶意代码。潜在的风险可能存在于：

*   `ip-addr.list`文件：虽然当前提供的`ip-addr.list`文件只包含本地地址`127.0.0.1`, 如果用户不小心使用了作者预先设定的其他IP地址列表，可能会导致未授权的扫描或攻击行为。
*   `session.log`文件：虽然日志记录本身不是恶意行为，但如果日志文件被上传或泄露，可能暴露用户的扫描目标信息。日志信息包含IP和端口信息。
*   在实际利用该漏洞时，如果攻击者使用了恶意的Payload，可能会对目标系统造成更大的危害。这些Payload可能被伪装成无害的代码，从而绕过安全检测。
*   如果作者在其他未公开的分支或版本中包含了恶意代码，并且诱导用户使用这些版本，则存在更高的投毒风险。

**综上所述，**虽然提供的PoC代码本身不包含明显的恶意代码，但用户在使用时仍然需要保持警惕，仔细审查代码，并确保从可信的来源获取代码，避免潜在的投毒风险。

**项目地址:** [jocker2410/CVE-2024-6387_poc](https://github.com/jocker2410/CVE-2024-6387_poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #19

**来源**: [CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：**

从搜索结果和漏洞库信息来看，该漏洞存在可利用的POC。提供的Rust代码是一个漏洞检查器，它通过连接到SSH服务器并读取SSH banner来判断目标服务器是否运行着存在漏洞的OpenSSH版本。

**投毒风险：**

提供的代码是一个漏洞检测工具，用于检查目标系统是否存在CVE-2024-6387漏洞。代码功能相对清晰，主要包括：

*   定义了易受攻击和已修补的版本列表。
*   通过TCP连接获取SSH banner。
*   将获取的banner与已知易受攻击的版本进行比较。

代码中没有发现恶意行为，例如执行系统命令或上传/下载文件。因此，**投毒风险较低，判断为0%**。

**利用方式：**

根据漏洞信息和搜索结果，攻击者需要发起大量的连接尝试，以触发sshd中的竞争条件。成功利用该漏洞可能允许攻击者在目标系统上执行任意代码或导致拒绝服务。Offsec的博客提供了关于如何利用该漏洞的更详细的解释。

**总结：**

CVE-2024-6387是一个严重的安全漏洞，允许未经身份验证的攻击者远程执行代码。虽然利用该漏洞需要一定的资源和技术，但由于存在公开的POC，因此建议尽快更新OpenSSH版本。

**项目地址:** [kubota/CVE-2024-6387-Vulnerability-Checker](https://github.com/kubota/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #20

**来源**: [CVE-2024-6387-l-urk_CVE-2024-6387.md](../2024/CVE-2024-6387-l-urk_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH regreSSHion 远程代码执行漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** OpenSSH

**危害等级:** 高危，未授权的远程攻击者可以利用此漏洞以 root 权限执行任意代码，或者造成拒绝服务。

**影响版本:** 8.5p1 ~ 9.7p1

**利用条件:** 目标系统使用受影响的 OpenSSH 版本, 并且基于 glibc 的 Linux 系统。需要网络连通性, 且攻击者需要能够发起大量的 SSH 连接尝试。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，又名 regreSSHion，是 OpenSSH 服务器中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件漏洞，允许未经身份验证的远程攻击者在基于 glibc 的 Linux 系统上执行任意代码。漏洞的利用方式涉及发起大量的 SSH 连接尝试，触发 sshd 进程中的竞争条件，从而允许攻击者将指令插入堆中，最终实现 RCE。

**有效性：**
从搜索结果和漏洞库信息来看，此漏洞是真实存在的，并且存在公开可用的 PoC 代码。PoC 代码的描述也与漏洞描述一致，表明其具有较高的有效性。

**投毒风险：**
提供的 POC 代码库中的 `LISCENCE` 文件声明了严格的权限限制，这在一定程度上增加了投毒的可能性。虽然无法通过现有信息完全确定是否存在投毒代码，但需要对脚本进行仔细审查，特别注意以下几个方面：

*   **shellcode:**  分析 shellcode 的行为，确保其功能与漏洞利用目的相符，没有恶意行为。
*   **网络连接:**  检查代码中是否存在额外的网络连接，特别是连接到未知或可疑的 IP 地址。
*   **文件操作:**  检查代码中是否存在对系统文件的修改或删除操作。
*   **依赖项:**  审查 `requirements.txt` 文件中的依赖项，确保没有引入恶意的第三方库。

考虑到需要大量连接尝试和对堆的操纵，以及许可证的严格声明，综合评估投毒风险为10%。这部分代码逻辑比较复杂，存在隐藏恶意代码的可能性。

**利用方式：**
1.  攻击者通过网络向目标 OpenSSH 服务器发起大量的连接请求。
2.  利用 OpenSSH 服务器处理连接请求时存在的竞争条件，特别是在信号处理方面。
3.  通过精心构造的数据包，将恶意代码注入到服务器的堆内存中。
4.  触发执行注入的恶意代码，从而获得对目标系统的控制权 (RCE) 或导致拒绝服务 (DoS)。
5.  默认的shellcode打开9999端口,并使用nc进行监听。

**项目地址:** [l-urk/CVE-2024-6387](https://github.com/l-urk/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #21

**来源**: [CVE-2024-6387-lflare_cve-2024-6387-poc.md](../2024/CVE-2024-6387-lflare_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是OpenSSH服务器(sshd)中的一个竞争条件漏洞，源于CVE-2006-5051的安全回归。当sshd在不安全的方式下处理某些信号时，未经验证的远程攻击者可能通过在设定的时间内未能成功验证身份来触发此漏洞。

**有效性评估：**
根据漏洞信息和搜索结果，此漏洞的PoC已经发布，并且被广泛讨论，证明了其有效性。PoC代码（`7etsuo-regreSSHion.c`）尝试利用此漏洞，通过以下步骤：

1.  **连接建立：** 与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH协议握手。
3.  **堆准备：** 准备堆布局以进行利用。
4.  **时间测量：** 测量数据包解析时间。
5.  **竞争条件尝试：** 尝试触发竞争条件，利用信号处理中的不安全函数调用，最终目标是执行shellcode，提权至root。
6.  **ASLR绕过：**尝试不同的glibc基地址，以绕过地址空间布局随机化(ASLR)。

代码中包含了尝试20000次利用的循环，以及100ms的延时，这些都符合漏洞分析文章的描述，增加了利用成功的可能性。

**投毒风险评估：**

此PoC代码存在一定程度的投毒风险，因为:

1.  **Shellcode:** PoC代码包含一个shellcode占位符，攻击者需要替换成真实的shellcode。如果提供的shellcode本身是恶意的，那么使用此PoC会导致投毒。
2. **glibc地址:** PoC代码包含glibc基址，攻击者需要手动调整为目标系统的基址。如果提供的基址不正确，或者根本无法确定正确的基址，会影响利用成功率。如果攻击者故意提供错误的基址或者使用错误的基址绕过策略，也有可能导致拒绝服务。
3.  **定时参数：** PoC代码中的定时参数需要根据目标系统的响应速度进行调整。如果定时不当，可能导致利用失败，甚至使目标系统崩溃。
4.  **heap布局:** OpenSSH的堆布局会随着版本的变化而变化，需要针对不同的版本进行调整。如果不调整，可能无法成功利用。

**评估：**
PoC代码的编写者可能在代码中加入不易察觉的恶意行为，例如收集目标系统信息并发送到远程服务器等。但是，考虑到PoC的主要目的是为了验证漏洞，因此这种风险相对较低。PoC中已经存在大量的需要修改的地方，需要使用者有一定的漏洞知识储备，因此投毒风险相对较低。

**综合评估**：PoC中投毒风险预估为10%，

**利用方式总结：**

1.  攻击者首先需要与目标OpenSSH服务器建立连接。
2.  然后，攻击者需要执行SSH握手协议。
3.  接着，攻击者发送特制的数据包，触发sshd中的竞争条件。
4.  竞争条件允许攻击者覆盖内存中的关键数据结构。
5.  攻击者通过覆盖的数据结构，执行预先准备好的shellcode，从而获得目标系统的root权限。
6. 利用过程需要绕过ASLR保护，这可能需要多次尝试，或者使用其他信息泄露漏洞。
7. 攻击需要一定的timing， 把握好发送数据包的时间。

**项目地址:** [lflare/cve-2024-6387-poc](https://github.com/lflare/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #22

**来源**: [CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387是一个OpenSSH服务器(sshd)中的安全回归漏洞，存在于OpenSSH 8.5p1到9.7p1版本。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。远程攻击者可以通过在设定的时间内认证失败来触发此漏洞，可能导致远程代码执行或拒绝服务。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已确认存在，并且有POC代码可用。搜索引擎结果中的多个链接指向了漏洞分析、利用和修复方法，以及相关的讨论。

**投毒风险：**
提供的POC代码包含一个Python脚本（main.py）和一个README.md文件。脚本内容主要用于识别易受攻击的OpenSSH服务器，并无发现任何恶意代码或者后门，但是不排除后续增加投毒代码的可能性, 因此投毒风险极低。

**利用方式：**
1.  攻击者需要发起大量SSH连接到目标服务器。
2.  在LoginGraceTime时间内，故意使认证失败。
3.  利用竞争条件，使sshd以不安全的方式处理信号。
4.  如果成功，攻击者可能能够执行任意代码或导致服务崩溃（拒绝服务）。

**缓解措施：**
*   将OpenSSH升级到9.8或更高版本。
*   设置`LoginGraceTime 0`可以缓解RCE，但不能完全避免DoS攻击，建议结合`fail2ban`和防火墙使用。

**项目地址:** [moften/regreSSHion-CVE-2024-6387](https://github.com/moften/regreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #23

**来源**: [CVE-2024-6387-prelearn-code_CVE-2024-6387.md](../2024/CVE-2024-6387-prelearn-code_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 远程代码执行

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行

**影响应用:** OpenSSH

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (glibc-based Linux systems)

**利用条件:** 目标系统需要运行受影响版本的OpenSSH，且基于glibc。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，也被称为"regreSSHion"，是OpenSSH服务器（sshd）中的一个安全漏洞，是CVE-2006-5051的一个回归。它是由信号处理中的竞争条件引起的。未经身份验证的远程攻击者可以通过在设定的时间内未能成功进行身份验证来触发此漏洞，可能导致以root权限执行任意代码。该漏洞影响基于glibc的Linux系统上的OpenSSH 8.5p1到9.7p1版本。

**有效性：**
根据漏洞库信息、搜索结果（特别是来自Qualys和offsec的分析），以及POC代码的存在，可以判断该漏洞是有效的，并且存在可利用的POC。

**投毒风险：**
POC代码中存在一定的投毒风险。虽然代码的目的是利用该漏洞，但攻击者可能会修改shellcode以进行恶意活动，或者在代码中加入额外的后门。例如，`shellcode`变量中包含占位符，需要替换为实际的shellcode。如果用户从不可信来源下载POC，并使用了包含恶意shellcode的POC，则可能存在投毒风险。代码中定义了多个glibc地址用于绕过ASLR，攻击者可以伪造错误的地址，来扰乱攻击。

**利用方式：**
利用方式涉及以下几个步骤：

1.  **建立连接：** 攻击者首先与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH握手过程，包括版本交换和密钥交换的初始化。
3.  **堆准备：** 发送特定的SSH数据包，以在sshd进程的堆上创建特定的内存布局，为利用创造条件。
4.  **触发竞争条件：** 攻击者触发一个竞争条件，该条件涉及OpenSSH处理信号的方式，利用SIGALRM信号处理程序中的不安全函数调用。
5.  **地址绕过：** 通过尝试多个可能的glibc基址，绕过地址空间布局随机化 (ASLR)。
6.  **执行代码：** 成功触发竞争条件后，将恶意shellcode注入到内存中并执行，从而获得远程代码执行权限（通常以root权限）。

**缓解措施包括：**
*   禁用`LoginGraceTime`参数，虽然不能完全阻止DoS，但可以防御RCE。
*   使用`fail2ban`等工具监控日志文件并管理连接。
*   及时更新到OpenSSH的修复版本。

**项目地址:** [prelearn-code/CVE-2024-6387](https://github.com/prelearn-code/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #24

**来源**: [CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md](../2024/CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，glibc-based Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387是一个OpenSSH服务器中的竞争条件漏洞（源于CVE-2006-5051的回归）。未经身份验证的远程攻击者可以通过在设定的时间内未能完成身份验证来触发此漏洞。利用方式是发送大量连接请求，触发竞争条件，在glibc-based Linux系统上可能导致在堆中插入恶意指令，最终实现远程代码执行或拒绝服务。提供的脚本并非POC，而是缓解措施：

1.  **有效性：** 提供的脚本实际上是一个缓解脚本，通过将`LoginGraceTime`设置为0来减少漏洞被利用的可能性，并不能直接验证漏洞，缓解脚本会禁用SSHD服务器在指定超时时间内未完成身份验证时断开连接的能力。虽然降低了RCE的风险，但增加了拒绝服务(DoS)的风险。

2.  **投毒风险：** 提供的脚本目的是缓解漏洞，没有发现任何隐藏的恶意代码，因此投毒风险为0%。

3.  **利用方式：** 根据漏洞信息和搜索结果，利用方式是未认证的攻击者向目标OpenSSH服务器发送大量连接请求，由于竞争条件的存在，sshd可能以不安全的方式处理信号，从而允许攻击者执行任意代码（RCE）或造成拒绝服务(DoS)。攻击成功的关键在于触发竞争条件，因此需要大量的并发连接尝试。


**项目地址:** [redux-sibi-jose/mitigate_ssh](https://github.com/redux-sibi-jose/mitigate_ssh)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #25

**来源**: [CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md](../2024/CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，并且攻击者能够建立SSH连接并触发竞争条件。攻击者需要尝试大量连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全漏洞，源于信号处理中的竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：** 根据漏洞库信息和搜索结果，此漏洞存在PoC。该漏洞的利用依赖于触发竞争条件，因此需要进行大量的连接尝试。

**投毒风险：** 分析提供的PoC代码，主要包含一个检测脚本（detection-script.py）和一个README。检测脚本尝试建立到目标SSH服务器的连接，并发送SSH协议版本字符串，然后读取服务器的响应。LICENSE文件和README.md文件是标准格式，描述了漏洞信息。由于检测脚本本身较为简单，且没有发现明显的恶意代码，因此投毒的风险较低，约为10%。 但是需要人工review所有代码.特别是二进制文件.

**利用方式：** 利用此漏洞需要：
1.  攻击者向目标服务器上的sshd服务发起大量的连接请求。
2.  在连接建立但身份验证尚未完成时，利用竞争条件触发信号处理错误。
3.  如果成功利用，攻击者可以在目标系统上执行任意代码，获得root权限（根据漏洞描述和搜索结果）。

利用的复杂性在于需要精确地控制时序，以触发竞争条件。这通常需要大量的计算资源和对目标系统行为的深入了解。同时该漏洞在glibc-based Linux systems更有效,可能无法在所有系统上利用。

**项目地址:** [s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH](https://github.com/s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #26

**来源**: [CVE-2024-6387-wiggels_regresshion-check.md](../2024/CVE-2024-6387-wiggels_regresshion-check.md)

# CVE-2024-6387

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-6387-AzrDll_CVE-2024-6387.md](../2024/CVE-2024-6387-AzrDll_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH 竞争条件导致 RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。需要发起大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务中的一个竞争条件漏洞，源于 CVE-2006-5051 的回归。未经身份验证的远程攻击者可以通过在短时间内发起大量失败的身份验证尝试来触发此漏洞。利用此漏洞需要在glibc堆中插入指令，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞确实存在，并且有公开的PoC利用代码。该PoC通过建立大量的 SSH 连接并进行不成功的身份验证来触发竞争条件。参考[webpage 3]，此漏洞允许glibc Linux发行版在堆中插入指令，从而实现代码执行。提供的PoC代码尝试利用这一点，但成功率可能较低，因为竞争条件需要精确的时间控制。

**投毒风险：**
提供的PoC代码`/tmp/fe03af2a23123389ff9785e2fb119f2c/PoC.py` 包含了从文件中读取glibc地址的功能。 虽然代码本身没有明显的恶意行为，但如果提供的 `glibc_file` 包含恶意构造的地址，可能会导致非预期的行为，甚至导致拒绝服务。例如，如果`glibc_base`地址指向了关键系统函数，覆盖该地址可能造成系统崩溃。另一个潜在的风险点是 `timing_adjustment`，如果调整不当可能造成DoS。综上所述，投毒风险为10%。主要是考虑到作者可能在利用代码的 `glibc_file` 参数中提供恶意的 glibc 地址，诱导用户使用，从而达到破坏目标系统的目的。

**利用方式：**
1.  **建立连接：** 攻击者首先建立与目标 OpenSSH 服务器的 TCP 连接。
2.  **SSH 握手：** 攻击者执行 SSH 握手过程，例如发送 SSH 版本字符串。
3.  **堆准备：** PoC尝试在堆上分配一些数据，为利用竞争条件做准备。
4.  **触发竞争条件：**  通过快速发送大量失败的身份验证请求，攻击者试图触发 `sshd` 进程中的竞争条件。这涉及利用 `LoginGraceTime` 参数，该参数允许攻击者在身份验证超时之前发送多个请求。根据[webpage 6]，利用此漏洞需要大量连接尝试才能准确触发竞争条件。
5.  **代码执行：**  如果竞争条件被成功触发，攻击者可以在内存中写入恶意代码，从而实现远程代码执行。提供的 PoC 代码尝试通过覆盖 glibc 的地址来实现这一点。如果成功利用，攻击者可以获得 root 权限，如[webpage 1][webpage 4]所描述。
6.  **拒绝服务：** 即使未能成功实现 RCE，攻击者也可能通过耗尽服务器资源来实现拒绝服务。由于竞争条件涉及信号处理，不正确的信号处理可能导致 `sshd` 崩溃。

**项目地址:** [AzrDll/CVE-2024-6387](https://github.com/AzrDll/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #2

**来源**: [CVE-2024-6387-DimaMend_cve-2024-6387-poc.md](../2024/CVE-2024-6387-DimaMend_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行(RCE)和拒绝服务(DoS)

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，并且目标系统基于glibc。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全漏洞，它是由CVE-2006-5051引入的回归错误。该漏洞是一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**利用方式：**

1.  **建立连接：** 攻击者首先与易受攻击的OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者尝试进行SSH握手，但故意不完成身份验证过程。这是为了触发`LoginGraceTime`超时。
3.  **堆准备：** 攻击者发送一系列SSH数据包，旨在操纵服务器的内存堆的布局。 这可能涉及到分配和释放内存，以便为利用创造合适的条件。
4.  **触发竞争条件：** 攻击者利用`LoginGraceTime`超时机制。当服务器由于握手超时而即将终止连接时，会发送一个信号。 攻击者尝试与此信号处理程序执行竞争，以修改服务器的内存。
5.  **代码执行：** 如果竞争成功，攻击者可以将恶意代码注入到服务器的内存中，并获得代码执行能力。 根据具体利用方式，这可能导致以root权限执行代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞的利用是可行的。许多信息源表明，存在公开可用的PoC，并且已经有人成功利用了此漏洞。 PoC代码的功能是尝试利用这个竞态条件。

**投毒风险分析：**

PoC代码中存在投毒代码的风险很低，原因如下：

*   **代码结构：** 代码主要集中于建立连接、进行SSH握手、操纵堆内存以及尝试触发竞态条件。虽然代码较为复杂，但在总体流程上没有明显的恶意操作。
*   **Shellcode占位符：** 代码中存在一个 `shellcode` 占位符，明确提示用户需要替换成实际的 shellcode。这表明作者的意图是提供一个框架，而不是一个直接可用的恶意载荷。
*   **注释和说明：** 代码包含大量的注释和说明，解释了漏洞的原理、利用方法以及需要调整的参数。这表明作者的目的是帮助研究人员理解和复现漏洞，而不是隐藏恶意代码。
*   **随机性和尝试次数：** 代码包含大量的随机尝试，目的是为了提高漏洞利用的成功率。这种随机性使得代码难以预测，也增加了作者插入恶意代码的难度。
*   **外部依赖：** 代码没有包含明显的外部依赖或网络请求，这降低了其被用于下载或执行恶意代码的风险。

虽然直接投毒的可能性较低，但仍然存在一些潜在风险，比如在 `shellcode` 占位符中插入恶意代码，或者在调整参数的过程中引入错误，导致程序行为异常。因此，在使用 PoC 代码时，仍然需要进行仔细的代码审查和安全测试。

综上所述，此仓库中存在作者隐藏的投毒代码的可能性估计为1%。

**项目地址:** [DimaMend/cve-2024-6387-poc](https://github.com/DimaMend/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #3

**来源**: [CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行存在漏洞版本的OpenSSH服务，且攻击者能够建立SSH连接，并在认证超时前发送恶意数据。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，存在于glibc的linux系统。它源于一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该漏洞是有效的。多个来源都确认了该漏洞的存在以及其远程代码执行的潜力。POC代码的存在进一步支持了其可利用性。

**投毒风险：**

POC代码本身包含以下潜在的投毒风险点：

*   **Shellcode占位符:** 代码中明确提到 `Shellcode placeholder (replace with actual shellcode)`。如果用户直接使用未经审查的 shellcode，则可能引入恶意行为。此处的风险不在于作者投毒，而在于用户使用不当。
*   **GLIBC_BASES:**  `GLIBC_BASES[]` 数组包含可能的 glibc 基地址。如果这个地址不准确，利用将失败。如果作者故意提供错误的地址，可能会导致拒绝服务或误导分析。
*   **Timing parameters:** 注释提到需要根据目标系统调整 timing 参数。错误的 timing 可能导致利用失败或系统不稳定。
*   **Heap layout 和 File structure offsets:**  代码注释中也强调了需要针对不同的 OpenSSH 和 glibc 版本进行调整，否则利用会失败。故意设置错误的值可能导致程序崩溃或产生其他未定义行为。
*   **随机数生成:** 代码使用 `srand(time(NULL))` 初始化随机数生成器。虽然这本身不是投毒，但如果后续利用中依赖于可预测的随机数，可能会被利用。

总体评估投毒风险为30%。风险主要来自于需要用户自行替换的shellcode，以及需要用户根据目标环境配置的参数。作者本身隐藏恶意代码的可能性较低，但用户在使用过程中存在引入风险的可能性。

**利用方式：**

1.  **建立连接：** 攻击者首先需要建立与目标 OpenSSH 服务器的连接。
2.  **SSH握手：** 进行初步的SSH握手过程，包括版本协商和密钥交换的初始化，但无需完成身份认证。
3.  **堆准备：**  `prepare_heap` 函数的目的是在堆上创建特定的布局，为后续的利用创造条件。具体实现细节未给出，但可能涉及分配和释放内存，以控制堆的状态。
4.  **时间测量：** `time_final_packet` 函数测量服务器处理特定数据包所需的时间。这个时间信息对于后续的竞争条件利用至关重要。
5.  **竞争条件：**  `attempt_race_condition` 函数尝试触发漏洞的核心：信号处理程序中的竞争条件。这通常涉及发送一个精心构造的数据包，该数据包会在服务器处理过程中触发 SIGALRM 信号。由于信号处理程序使用了异步信号不安全函数，因此可能导致堆损坏。
6.  **代码执行：**  如果竞争条件成功触发，攻击者就可以利用堆损坏来执行任意代码。这通常涉及覆盖函数指针或控制程序的执行流程。

该漏洞的利用依赖于精确的 timing 和对目标系统内存布局的了解。攻击者需要进行大量的尝试才能成功利用该漏洞。

**项目地址:** [HadesNull123/CVE-2024-6387_Check](https://github.com/HadesNull123/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #4

**来源**: [CVE-2024-6387-Karmakstylez_CVE-2024-6387.md](../2024/CVE-2024-6387-Karmakstylez_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器(sshd)中的一个安全回归漏洞，存在于glibc-based Linux系统。该漏洞源于信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。该漏洞利用代码尝试通过大量的连接请求触发竞争条件，通过调整glibc基地址和定时参数绕过ASLR，将恶意代码注入到堆中，最终实现以root权限远程代码执行。

有效性：根据漏洞信息和搜索结果，此POC代码具备一定的有效性，但成功利用需要满足特定条件，例如目标系统使用glibc，以及OpenSSH版本在受影响范围内。同时，漏洞利用的成功率受到系统负载、网络延迟等因素的影响，需要进行大量的尝试。

投毒风险：POC代码中存在一定的投毒风险。虽然POC代码的主要目的是利用已知的漏洞，但攻击者可能在代码中加入恶意功能，例如植入后门、收集敏感信息等。例如，shellcode 部分是明显的注入点。风险评定为10%，主要基于以下几点：
1.  **Shellcode 替换：** 代码明确指出 `shellcode` 变量是占位符，需要替换为实际的 shellcode。如果用户不小心使用了包含恶意指令的 shellcode，则可能导致投毒。
2.  **glibc 基地址猜测：** 虽然代码尝试多个 glibc 基地址，但如果攻击者预先知道目标系统的 glibc 地址，则可以修改 `GLIBC_BASES` 数组以提高利用成功率，同时也可能引入恶意地址。
3.  **Timing 参数调整：** 代码中的 `usleep` 函数用于控制连接尝试之间的延迟。攻击者可以通过调整这些参数来优化漏洞利用，但也可能引入导致拒绝服务 (DoS) 的参数。
4.  **编译选项：**POC 需要编译，攻击者可以在编译时添加额外的恶意编译选项，例如禁用安全特性等。
5.  **作者本身:** 仓库作者有投毒行为.

利用方式：
1.  攻击者首先需要确定目标系统是否运行受影响的OpenSSH版本，以及是否基于glibc。
2.  攻击者发起大量的SSH连接请求，尝试触发竞争条件。
3.  攻击者利用精心构造的数据包覆盖堆上的特定内存区域，将恶意代码注入到sshd进程中。
4.  一旦恶意代码成功执行，攻击者即可获得目标系统的控制权。

**项目地址:** [Karmakstylez/CVE-2024-6387](https://github.com/Karmakstylez/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #5

**来源**: [CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md](../2024/CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md)

## CVE-2024-6387-OpenSSH-RegreSSHion-RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行并获取 root 权限或造成拒绝服务

**影响版本:** <= 9.7p1 (受影响版本 8.5p1 至 9.7p1)

**利用条件:** 需要目标服务器运行受影响版本的OpenSSH，且存在时间窗口内的未认证连接尝试。高危利用场景依赖glibc环境。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-6387，也被称为“regreSSHion”，是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞（CVE-2006-5051）。该漏洞源于信号处理中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC已经存在，并且能够实现远程代码执行和拒绝服务攻击。很多安全厂商和研究人员都发布了相关的分析报告和PoC代码。

**投毒风险：**
提供的漏洞利用代码（/tmp/270e32ae67508359811c0f9899155269/README.md 和 LICENSE）仅仅是声明了存在POC，根据现有信息，该仓库本身存在恶意代码的风险较低。但是，由于POC的执行具有高危性，在实际使用中，仍需要进行安全审查。

**利用方式：**
1.  **竞争条件：** 攻击者通过在短时间内发起大量未认证的连接尝试，触发 `sshd` 中的竞争条件。
2.  **信号处理：** 在特定的时间窗口内，`sshd` 可能会以不安全的方式处理信号，导致内存损坏或其他异常行为。
3.  **远程代码执行/拒绝服务：**  利用内存损坏或其他异常行为，攻击者可以执行任意代码（RCE），或导致 `sshd` 崩溃，造成拒绝服务（DoS）。部分利用依赖特定的glibc环境。
4.  **ProxyCommand注入:** 根据github仓库的README.md描述，该POC利用了 `ProxyCommand` 配置不当或滥用的情况，攻击者可以注入恶意命令到 `ProxyCommand` 中，从而获得命令执行或者横向渗透的能力。

**缓解措施：**
*   升级到 OpenSSH 9.8 或更高版本。
*   设置 `LoginGraceTime 0` 以禁用在指定超时时间内未完成身份验证时服务器断开连接的功能（Red Hat 建议的临时缓解措施，但会使服务器更容易受到 DoS 攻击）。
*   使用 `fail2ban` 等工具，配合防火墙来监控日志文件并适当管理连接。

**项目地址:** [Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC](https://github.com/Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #6

**来源**: [CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md](../2024/CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）或拒绝服务（DoS）

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。它是一个竞争条件漏洞，可能导致sshd以不安全的方式处理信号。远程攻击者可以通过在设定的时间内未能成功验证身份来触发此漏洞，从而可能导致远程代码执行或拒绝服务。

**有效性评估：**

根据漏洞库信息、搜索结果以及提供的POC代码来看，此漏洞的POC是存在的，并且多个安全厂商都发布了相关的分析报告和检测方法。搜索结果也表明此漏洞允许远程未授权代码执行。

**利用方式：**

1.  攻击者建立与目标OpenSSH服务器的连接。
2.  进行SSH握手，获取服务器banner。
3.  准备堆，发送一定量的填充数据。
4.  尝试触发竞争条件，通过发送包含`glibc_base`地址的payload，并附加一些`nop`指令。
5.  如果成功，则在服务器上执行代码，获得root权限。
6.  脚本使用了多线程来增加攻击成功的几率，并对时序进行调整。

**投毒风险评估：**

提供的POC代码（`Exploit_2024_6387.py`）本身是一个漏洞利用脚本，其目的是利用目标系统的漏洞。评估投毒风险主要关注作者是否在脚本中植入了恶意代码，例如：

*   **后门代码：**  脚本在成功利用漏洞后，是否会创建一个后门，允许攻击者在未经授权的情况下再次访问系统。
*   **破坏性代码：**  脚本是否包含旨在破坏目标系统或数据的代码。
*   **信息窃取代码：**  脚本是否会窃取目标系统上的敏感信息。

分析代码发现，虽然脚本本身旨在利用漏洞，但并未发现明显的后门、破坏性或信息窃取代码。 然而，需要注意的是，该脚本的`TARGET_IP`和`TARGET_PORT`是硬编码的，在实际使用中需要进行修改。此外，攻击者可能会修改此脚本以包含恶意功能。此处的`glibc_base`地址也需要根据目标环境进行调整，否则利用大概率会失败，这也是成功利用此漏洞的难点之一。

综合来看，该仓库存在投毒风险的可能性较低，但是不排除有攻击者对代码进行修改后，二次传播。因此，建议在使用前仔细审查代码。

**风险评估：**
`poison`的百分比评估主要考虑以下几个方面：

*   **代码复杂性：** 代码越复杂，隐藏恶意代码的可能性越高。
*   **作者信誉：** 如果作者的信誉未知或可疑，则风险越高。
*   **代码审查：** 代码是否经过其他安全研究人员的审查。

根据以上分析，此脚本的`poison`风险评估为10%。

**项目地址:** [SkyGodling/CVE-2024-6387-POC](https://github.com/SkyGodling/CVE-2024-6387-POC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #7

**来源**: [CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md](../2024/CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，未认证的远程攻击者通过在设定的时间内认证失败触发

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞(CVE-2006-5051)。它存在一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，进而导致远程代码执行(RCE)或拒绝服务(DoS)。

根据搜索结果和漏洞信息，该漏洞影响glibc-based Linux系统，利用需要发起大量连接尝试来触发竞争条件。

提供的漏洞利用代码 `scanner.py` 是一个版本扫描器，并非直接利用 CVE-2024-6387。它用于检测目标 SSH 服务器的版本，并根据预定义的 CVE 列表判断是否存在已知的漏洞。该脚本通过创建 socket 连接到目标主机的 SSH 端口，然后发送一个空字节并接收服务器的响应，从中提取 OpenSSH 的版本信息。然后将提取的版本与易受攻击的版本列表进行比较。

**漏洞利用方式：**

1.  攻击者需要向目标 OpenSSH 服务器发起大量的连接请求。
2.  在连接建立后，故意触发认证失败，从而在信号处理过程中创建竞争条件。
3.  竞争条件允许攻击者在某些 glibc Linux 发行版中将指令插入堆中，进而实现远程代码执行。

**投毒风险：**

虽然脚本本身是一个版本扫描器，而不是直接的漏洞利用程序，但仍需谨慎评估其潜在的投毒风险。 代码中存在创建日志目录并记录扫描结果的行为，存在恶意修改扫描逻辑或在日志中写入恶意数据，但可能性极低。因此，评估投毒风险为1%。

**项目地址:** [ThatNotEasy/CVE-2024-6387](https://github.com/ThatNotEasy/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #8

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 远程代码执行/拒绝服务

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1，受影响版本包括8.5p1至9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且攻击者能够发起大量连接请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞，它源于 CVE-2006-5051。该漏洞是一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间段内未能通过身份验证来触发此漏洞。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的PoC代码是有效的。多个来源证实了该漏洞的存在和可利用性，特别是针对glibc的Linux系统。

**投毒风险：**

提供的PoC代码包含用于编译、构建和利用漏洞的Dockerfile和Python脚本。通过分析代码，可以发现以下潜在的投毒风险因素：

*   **依赖项：** Dockerfile中使用了`wget`和`curl`来下载OpenSSH源码，存在被中间人攻击替换为恶意源码的风险。尽管校验和可以降低这种风险，但如果攻击者能够控制构建环境，仍然可能引入恶意代码。
*   **shellcode：** Python脚本包含一个名为`shellcode`的变量，目前只是占位符，但攻击者可以修改此变量，插入恶意shellcode。攻击者可以精心构造shellcode，以执行恶意操作，例如安装后门、窃取数据或提权。

虽然这些风险存在，但从现有代码来看，没有发现明显的恶意代码。因此，评估投毒风险为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的OpenSSH环境（32位Linux系统）。
2.  **SSH握手：** 客户端与服务器建立连接，发送SSH版本信息并进行密钥交换（KEX）初始化。
3.  **堆准备：** 通过发送特定大小的数据包来布置堆内存，利用glibc的漏洞插入恶意指令。
4.  **触发竞争条件：** 大量连接尝试来触发信号处理程序中的竞争条件。
5.  **执行代码：** 成功触发竞争条件后，恶意代码将被执行，从而实现远程代码执行。

总体来说，利用方式较为复杂，需要精心构造数据包和进行大量的连接尝试才能成功。

**项目地址:** [YassDEV221608/CVE-2024-6387](https://github.com/YassDEV221608/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #9

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 9.7p1 (影响 8.5p1 到 9.7p1)

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，并且是基于glibc的Linux系统。攻击者需要能够建立到SSH服务的网络连接，并能够快速发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中发现的一个安全回归漏洞，存在于glibc的Linux系统中。该漏洞是由于OpenSSH服务器（sshd）中的信号处理存在竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用此漏洞可能导致以 root 身份远程执行代码。

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果也确认了该漏洞的存在，并描述了其可能导致远程代码执行的风险。漏洞利用代码的存在也进一步证实了漏洞的有效性，代码尝试利用竞争条件来执行任意代码。

**投毒风险：**
代码存在一定的投毒风险的可能性。虽然代码本身看起来是在尝试利用该漏洞，但以下因素需要考虑：

1.  **Shellcode占位符：** 代码中包含一个shellcode占位符`unsigned char shellcode[] = "\x90\x90\x90\x90";`，明确指示需要替换成实际的shellcode。如果用户没有意识到这一点，或者使用了恶意shellcode，可能会造成损害。这里的投毒风险在于，攻击者可能发布包含恶意shellcode的exp，诱导用户使用。 
2.  **GLIBC_BASES：** 代码中定义了`GLIBC_BASES[]`，用于绕过ASLR。如果这些地址不正确，利用将失败。更糟糕的是，如果攻击者故意提供错误的地址，可能会导致程序崩溃或其他不可预测的行为。
3.  **Timing parameters和 Heap layout 需要调整：** 代码注释中强调了定时参数和堆布局需要根据目标系统进行调整。如果这些参数设置不正确，可能会导致利用失败或目标系统不稳定。
4.  **文件结构偏移量：** 代码提到需要验证特定glibc版本的文件结构偏移量。使用错误的偏移量可能导致内存损坏或其他不可预测的行为。

总体来看，该POC的复杂性和对系统内部结构的依赖性，投毒者可以通过提供不正确的配置参数，或者引导用户使用错误的shellcode，达到破坏目标系统的目的。因此存在10%的投毒风险。

**利用方式：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **建立连接：** 攻击者首先需要与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者需要完成初始的SSH握手过程，包括协议版本交换和密钥交换初始化（KEX）。
3.  **堆准备：** 攻击者利用SSH协议发送数据包，在内存堆上布置精心构造的数据结构，为后续的漏洞利用做准备。
4.  **触发竞争条件：** 攻击者发送一个特制的SSH数据包，该数据包的设计是为了触发sshd中的竞争条件。具体来说，它利用了在身份验证失败的情况下，信号处理程序中的不安全操作。
5.  **RCE：** 成功触发竞争条件后，攻击者可以将恶意代码注入到sshd进程中，从而实现远程代码执行。具体是通过内存操作覆盖某个函数指针，使其指向攻击者提供的shellcode。
6.  **提权（Root）：** 由于sshd通常以root权限运行，因此攻击者执行的shellcode也将以root权限运行，从而完全控制目标系统。

**项目地址:** [YassDEV221608/CVE-2024-6387_PoC](https://github.com/YassDEV221608/CVE-2024-6387_PoC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #10

**来源**: [CVE-2024-6387-alex14324_ssh_poc2024.md](../2024/CVE-2024-6387-alex14324_ssh_poc2024.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）和拒绝服务（DoS）

**影响版本:** <= 9.7p1

**利用条件:** 需要目标系统开启sshd服务，且受影响的OpenSSH版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是一个存在于OpenSSH服务器（sshd）中的安全漏洞，具体来说是一个竞争条件漏洞。该漏洞源于OpenSSH处理信号的方式。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，导致sshd以不安全的方式处理信号。这可能导致远程代码执行（RCE），攻击者获得root权限，或拒绝服务（DoS），使服务器不可用。

**有效性分析：**
从漏洞库信息、搜索结果和提供的PoC代码来看，该漏洞的PoC是存在的，并且被广泛讨论和利用。 搜索结果中提到“regreSSHion (CVE-2024-6387) is an unauthenticated RCE vulnerability in OpenSSH’s server, affecting glibc-based Linux systems. Full root access is granted.” 表明该漏洞有很高的潜在影响. PoC代码也试图绕过ASLR，并包含shellcode的占位符，表明攻击者可以注入恶意代码。

**投毒风险分析：**
提供的PoC代码具有一定的投毒风险，大约为10%。主要基于以下几点：
1.  **Shellcode占位符：** 代码中包含`unsigned char shellcode[] = "\x90\x90\x90\x90";`。虽然这只是一个占位符，需要用户替换为实际的shellcode，但攻击者可能发布包含恶意shellcode的版本，诱导用户使用。
2.  **GLIBC_BASES地址：**  代码中包含了`uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`。这些地址是ASLR绕过的尝试，但如果攻击者故意提供错误的地址，可能导致利用失败或者其他未知的行为，但一般不会产生特别大的危害。
3.  **Timing参数：** 代码中需要根据目标系统响应调整Timing参数。攻击者可能提供不合适的参数，导致利用不稳定或者失败。
4.  **Heap Layout和文件结构偏移：**  代码注释中提到“Heap layout : Requires tweaking for different OpenSSH versions.” 和 “File structure offsets: Verify for the specific glibc version.”。攻击者可能故意提供错误的值，导致利用失败或者产生其他问题。

**利用方式：**
1.  **建立连接：** 攻击者首先需要与目标服务器的sshd服务建立TCP连接。
2.  **SSH握手：** 进行SSH握手，包括版本交换、密钥交换等步骤。PoC代码中的 `perform_ssh_handshake` 函数实现了这些步骤。
3.  **堆准备：** 通过发送特定的SSH数据包，在sshd进程的堆上分配内存，并控制堆的布局。`prepare_heap` 函数用于执行此操作。
4.  **时间计算：**  计算处理最终数据包所需的时间，用于后续的竞争条件利用。`time_final_packet` 函数用于执行此操作。
5.  **竞争条件利用：**  通过大量并发连接，触发sshd中的竞争条件漏洞。攻击者不断尝试进行身份验证，但故意失败，以触发SIGALRM信号处理程序。由于信号处理程序中使用了非异步信号安全的函数，可能导致内存损坏和代码执行。`attempt_race_condition` 函数用于执行此操作。
6.  **ASLR绕过：**  由于地址空间布局随机化（ASLR）的存在，攻击者需要知道glibc的基地址。PoC代码中包含了一组可能的基地址，并尝试逐个利用。
7.  **代码注入：** 成功利用竞争条件后，攻击者可以将恶意代码（shellcode）注入到sshd进程的内存中。占位符需要替换。
8.  **代码执行：**  执行注入的shellcode，从而获得服务器的root权限。

**项目地址:** [alex14324/ssh_poc2024](https://github.com/alex14324/ssh_poc2024)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #11

**来源**: [CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md](../2024/CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH服务，并允许未授权的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)。

**有效性:**
根据搜索结果和漏洞库信息，此漏洞的PoC是存在的，并且已经被公开。多个来源证实了该漏洞的存在，以及它可能导致远程代码执行。提供的“漏洞利用代码”实际上是一个缓解脚本，旨在通过升级OpenSSH版本或禁用LoginGraceTime来降低风险，而不是一个实际的利用程序。

**投毒风险:**
提供的脚本主要功能是检测并修复漏洞，但仍然存在一定的投毒风险：
*   **依赖外部源：** 脚本使用`apt-get update`和`apt-get install`命令，依赖外部软件源。如果软件源被恶意篡改，可能导致安装恶意软件包。
*   **配置修改：** 脚本会修改`/etc/ssh/sshd_config`文件，存在被恶意利用修改配置的风险。
*   **权限提升：** 脚本需要root权限运行，如果脚本被篡改，可能导致提权攻击。
综合考虑，该脚本存在一定的投毒风险，但主要风险在于依赖的外部源和配置修改，因此投毒风险评估为10%。

**利用方式:**
此漏洞的利用方式是利用 sshd 进程处理信号时的竞争条件。攻击者需要发起大量连接尝试，并在身份验证失败时触发竞争条件。成功触发后，攻击者能够在目标系统上执行任意代码。根据 offsec.com 的博客文章，此漏洞利用机会在某些 glibc Linux 发行版中，能将指令插入堆中。

**项目地址:** [almogopp/OpenSSH-CVE-2024-6387-Fix](https://github.com/almogopp/OpenSSH-CVE-2024-6387-Fix)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #12

**来源**: [CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md](../2024/CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许未授权网络访问SSH端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387 (regreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的安全回归漏洞，源于 CVE-2006-5051。这是一个竞争条件漏洞，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内身份验证失败来触发此漏洞。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经公开。多个安全厂商和研究人员已经发布了关于此漏洞的分析和PoC代码。

**投毒风险分析：**

提供的Checker.py脚本的主要功能是检测目标SSH服务器是否存在CVE-2024-6387漏洞。它通过连接到目标服务器的SSH端口并获取SSH banner信息，然后将其与已知易受攻击和已修补的版本进行比较来确定漏洞状态。 代码中没有发现任何明显的恶意或后门代码。

投毒风险评估：0%。该脚本主要用于漏洞检测，不包含任何主动利用漏洞的代码，也没有发现作者隐藏的恶意代码。

**利用方式分析：**

1.  **漏洞原理：** 漏洞是由于 OpenSSH 在处理信号时存在竞争条件，允许在身份验证失败期间执行恶意代码。
2.  **攻击步骤：** 攻击者需要向目标服务器发起大量的SSH连接尝试。
3.  **触发条件：** 在连接尝试期间，攻击者故意使身份验证失败，触发竞争条件。
4.  **利用结果：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码，以root权限运行，或者造成拒绝服务攻击。
5.  **缓解措施：** 通过设置 `LoginGraceTime 0` 禁用 `LoginGraceTime` 参数可以缓解远程代码执行的风险，但仍然存在拒绝服务的风险。更新到OpenSSH 9.8或更高版本是完整的修复方案。

**项目地址:** [anhvutuan/CVE-2024-6387-poc-1](https://github.com/anhvutuan/CVE-2024-6387-poc-1)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #13

**来源**: [CVE-2024-6387-awusan125_test_for6387.md](../2024/CVE-2024-6387-awusan125_test_for6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要目标系统基于 glibc，且 OpenSSH 版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理程序中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用可能允许攻击者在目标系统上以 root 权限执行任意代码或导致拒绝服务。

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞的 PoC 已被公开，并且漏洞利用的复杂性较高。搜索结果表明，该漏洞影响 glibc 基础的 Linux 系统。提供的 POC 代码似乎旨在利用此漏洞。

**投毒风险分析：**
该 POC 代码中存在一定的投毒风险，大约 20%。原因如下：
*   **Shellcode 占位符:** 代码中包含 `unsigned char shellcode[] = "\x90\x90\x90\x90";` 这一行，明确指出需要替换为实际的 shellcode。如果用户不小心使用了该占位符，或者植入了其他有害 shellcode，则可能导致不可预期的后果。
*   **GLIBC 基地址硬编码:** 代码中定义了 `uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`，并表示 “Needs adjustment for specific target systems”。如果 GLIBC 基地址不正确，可能导致利用失败，甚至造成程序崩溃。攻击者可能会故意提供错误的基地址，使得用户在尝试利用时受到干扰，或者执行其他恶意操作。
*   **Timing 参数需要微调:** 代码注释中提到 “Timing parameters: Fine-tune based on target system responsiveness”。如果 timing 参数设置不当，可能导致竞争条件无法触发，或者引发其他问题。攻击者可能会提供误导性的 timing 参数，使得用户在尝试利用时遇到困难，或者触发非预期的行为。
*   **Heap 布局和文件结构偏移量:** 代码注释提到 “Heap layout : Requires tweaking for different OpenSSH versions” 和 “File structure offsets: Verify for the specific glibc version.” 这表示该漏洞利用依赖于特定的堆布局和文件结构偏移量。如果这些值不正确，则可能导致利用失败，甚至造成程序崩溃。攻击者可能会提供不兼容的值，使得用户在尝试利用时受到干扰，或者触发非预期的行为。
*   **错误处理不完善:** 代码中虽然包含了一些错误处理逻辑，但可能存在未处理的异常情况。攻击者可能会利用这些漏洞，使得程序在特定条件下崩溃或执行非预期的操作。

**利用方式：**
利用方式主要涉及以下步骤：
1.  **建立连接：** 与目标 SSH 服务器建立 TCP 连接。
2.  **SSH 握手：** 执行 SSH 握手过程，包括版本交换和密钥交换。
3.  **堆准备：** 通过发送特定的数据包，在堆上创建特定的布局。
4.  **时间控制：** 精确控制数据包的发送时间，以便触发竞争条件。
5.  **竞争条件触发：** 通过大量连接尝试和认证失败，利用信号处理程序的竞争条件在内存中注入恶意代码，通常包括修改 glibc 的数据结构。
6.  **代码执行：** 利用注入的恶意代码来执行任意命令。
7.  **绕过 ASLR：** 由于地址空间布局随机化 (ASLR) 的存在，需要确定 glibc 的基地址。PoC 代码中尝试了几个常见的基地址。

总体而言，该漏洞利用较为复杂，需要对 SSH 协议、glibc 内部机制和竞争条件有深入的了解。该漏洞的成功利用还依赖于目标系统的特定配置和状态。

**项目地址:** [awusan125/test_for6387](https://github.com/awusan125/test_for6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #14

**来源**: [CVE-2024-6387-dream434_CVE-2024-6387.md](../2024/CVE-2024-6387-dream434_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，目标系统运行受影响的OpenSSH版本，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性评估：**

根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已经被广泛讨论。漏洞利用代码的脚本主要用于检测目标主机是否运行存在漏洞的OpenSSH版本，利用方式是扫描目标IP的22端口，获取OpenSSH版本信息，并与已知的易受攻击版本进行比较，从而判断目标系统是否存在漏洞。

**投毒风险分析：**

提供的漏洞利用代码（CVE-2024-6387.py）主要用于版本检测，功能相对简单。虽然`README.md`中包含克隆GitHub仓库的操作，但直接分析提供的Python脚本，发现潜在的投毒点在于以下几个方面：

1.  **依赖包风险：** 脚本本身依赖较少，但如果`README.md`引导用户安装额外的依赖包（例如通过`pip install -r requirements.txt`，而`requirements.txt`包含恶意包），则可能存在投毒风险。
2.  **命令执行风险：** `README.md` 中的运行命令 `python CVE-2024-6387.py http://exemple.com` 虽然看起来无害，但如果 `CVE-2024-6387.py` 存在漏洞，允许通过命令行参数执行恶意代码，则存在风险。当前提供的代码没有直接利用命令行参数执行代码的逻辑。
3.  **文件包含风险：** 如果脚本尝试动态加载其他文件（例如配置文件），而这些文件被篡改，则可能存在风险。

鉴于以上分析，以及`README.md`中存在引导用户克隆github仓库的操作，综合判断，存在较低的投毒风险，约为10%。主要基于假设恶意代码可能存在于被克隆仓库的其他文件中，或者存在利用脚本漏洞执行恶意代码的可能。

**漏洞利用方式：**

1.  **版本检测：** 攻击者首先需要确定目标系统上运行的OpenSSH版本是否在受影响的范围内（8.5p1 <= version <= 9.7p1）。
2.  **触发竞争条件：** 攻击者通过与目标SSH服务器建立连接，并在身份验证过程中故意失败，以触发漏洞相关的竞争条件。
3.  **代码执行：** 成功触发竞争条件后，攻击者可以利用该漏洞在目标系统上执行任意代码，通常以root权限执行。

搜索结果也表明，此漏洞允许未经身份验证的远程代码执行，并且影响基于glibc的Linux系统。因此，利用方式的核心在于触发竞争条件并利用glibc的特性来执行恶意代码。

**项目地址:** [dream434/CVE-2024-6387](https://github.com/dream434/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #15

**来源**: [CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标主机开启SSH服务，且攻击者能够发起大量连接尝试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是一个OpenSSH服务器中的竞争条件漏洞。它源于OpenSSH处理信号的方式，当SSH服务器在短时间内收到大量连接请求且认证失败时，可能导致信号处理不当，进而允许未经验证的远程攻击者在基于glibc的Linux系统上执行任意代码，获取root权限，或者导致拒绝服务。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC已发布，表明漏洞可被利用。提供的Python脚本`CVE-2024-6387-Vulnerability-Checker.py`是一个漏洞检测工具，通过检查SSH banner版本来判断目标是否存在漏洞。脚本本身并不能直接利用该漏洞进行RCE或DoS攻击，而是用来辅助确认目标系统是否在受影响的范围内。

**投毒风险：**
该Python脚本主要功能是检查OpenSSH版本，判断其是否在受影响的范围内。代码本身只包含版本检测逻辑，没有发现任何恶意代码或后门，因此投毒风险极低。可以认为投毒风险为0%。

**利用方式：**
1.  **版本检测：** 使用PoC脚本或类似工具检测目标SSH服务器的版本，确认其是否位于易受攻击的范围(8.5p1 <= OpenSSH <= 9.7p1)。
2.  **触发竞争条件：** 如果目标版本易受攻击，攻击者需要发起大量连接尝试，并在短时间内故意认证失败，以触发竞争条件。
3.  **代码执行（或DoS）：** 成功触发竞争条件后，利用glibc的堆操作特性，攻击者可以插入恶意指令到堆中，从而实现远程代码执行。另一种利用方式是耗尽服务器资源，造成拒绝服务攻击。

需要注意的是，利用此漏洞进行RCE需要对glibc堆操作有一定的了解，并且成功率可能不高。缓解措施包括禁用`LoginGraceTime`配置，并使用`fail2ban`等工具限制恶意连接。

**项目地址:** [filipi86/CVE-2024-6387-Vulnerability-Checker](https://github.com/filipi86/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #16

**来源**: [CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-regreSSHion

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1 (OpenSSH)

**利用条件:** 需要glibc-based Linux系统，以及OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞。漏洞源于OpenSSH服务器处理信号的方式存在问题，具体来说，当用户认证失败时，可能触发不安全的信号处理。远程攻击者可以通过在短时间内发起大量SSH连接尝试，并故意触发认证失败，从而引发竞争条件，最终可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据搜索结果（webpage 1, 3, 4, 5, 7, 8）和漏洞库信息，该漏洞已被确认为一个高危漏洞，并且存在公开的PoC（Proof of Concept）代码。虽然提供的POC代码只是一个包含漏洞描述的README.md文件，**不能直接运行，但是，github上存在可利用的POC**。该POC的有效性取决于目标系统是否满足漏洞利用的条件，即：
1.  使用受影响的OpenSSH版本（<= 9.7p1）。
2.  目标系统是基于glibc的Linux发行版。
3.  系统配置允许一定数量的并发连接。

**投毒风险：**
提供的POC代码（README.md）本身不包含任何可执行代码，因此直接的投毒风险很低。但需要注意的是，任何从互联网上下载的代码都存在潜在的风险。即使是看似无害的文档，也可能包含恶意链接或指令，引导用户下载或执行恶意代码。因此，下载和使用任何PoC代码时，都应该保持警惕，并进行充分的安全审查。

虽然提供的README.md文件本身投毒风险较低,但是考虑到实际利用中需要依赖其他EXP, 因此其他仓库被投毒的可能性相对较高。
风险评估：10%

**利用方式：**
根据漏洞描述和搜索结果，利用方式主要包括以下几个步骤：
1.  **大量连接请求：** 攻击者向目标OpenSSH服务器发起大量的并发连接请求。
2.  **触发认证失败：**  在连接请求中，故意提供错误的用户名或密码，触发认证失败事件。
3.  **竞争条件利用：**  通过大量认证失败事件，触发OpenSSH服务器中的竞争条件漏洞。
4.  **代码执行或DoS：** 成功利用漏洞后，攻击者可以执行任意代码（RCE）或导致服务器崩溃（DoS）。

需要注意的是，利用该漏洞需要一定的资源和技术，并且成功率可能不高。Red Hat 在其安全公告中指出，实现RCE需要相当多的资源投入。同时，修改sshd_config,设置LoginGraceTime为0可以有效避免远程代码执行，但仍存在拒绝服务风险.

**项目地址:** [identity-threat-labs/Article-RegreSSHion-CVE-2024-6387](https://github.com/identity-threat-labs/Article-RegreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #17

**来源**: [CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，sshd服务运行且存在于受影响版本范围内，目标系统是基于glibc的Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中发现的竞争条件漏洞。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发该漏洞。成功利用可能导致以root权限远程执行代码或拒绝服务。该漏洞的利用依赖于触发信号处理程序的竞争条件，攻击者需要发起大量连接尝试才能提高触发漏洞的几率。提供的PoC代码是一个漏洞验证工具，用于检测目标系统上运行的OpenSSH版本是否存在漏洞。它通过连接到目标SSH端口并检查SSH横幅来工作。如果横幅指示易受攻击的版本，则该工具会将目标标记为易受攻击。PoC代码本身似乎不包含任何明显的投毒代码。它仅仅用于验证漏洞是否存在，并不会主动进行利用。

**利用方式：**

1.  攻击者向目标服务器的SSH端口发起大量连接请求。
2.  连接请求需要故意失败，例如提供无效的用户名或密码，以便触发身份验证失败流程。
3.  攻击者利用OpenSSH处理信号时的竞争条件，将恶意指令插入堆中。
4.  如果竞争条件利用成功，攻击者即可在目标系统上以root权限执行任意代码或导致拒绝服务。

**项目地址:** [identity-threat-labs/CVE-2024-6387-Vulnerability-Checker](https://github.com/identity-threat-labs/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #18

**来源**: [CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md](../2024/CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统使用受影响的OpenSSH版本，基于glibc的Linux系统，且未禁用LoginGraceTime

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是一个存在于OpenSSH服务器(sshd)中的竞争条件漏洞。该漏洞源于OpenSSH在处理信号时存在不安全行为。远程攻击者通过在一定时间内认证失败，可以触发此漏洞，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**漏洞利用方式：**

1.  攻击者向目标服务器发起大量的SSH连接请求。
2.  在SSH认证过程中，攻击者故意使认证失败，触发LoginGraceTime超时。
3.  由于竞争条件，sshd可能在处理SIGALRM信号时进入不安全状态。
4.  在glibc-based的Linux系统上，这种不安全状态可能允许攻击者将指令插入到堆中，最终导致RCE。
5.  如果无法实现RCE，攻击者可以通过耗尽服务器资源，导致DoS。

**POC代码分析：**

提供的PoC代码`/tmp/d7c5471d195cdec17d8f4ebaf7516058/CVE-2024-6387_poc.py`的主要功能是检测目标SSH服务器的版本，判断其是否受CVE-2024-6387漏洞影响。它通过建立socket连接，发送`\x00`，接收SSH版本信息，并进行正则匹配来确定OpenSSH的版本。如果版本在易受攻击的范围内（8.5 <= 版本 < 9.8）,则输出目标系统可能存在漏洞。该PoC本身**不包含直接利用漏洞的代码**，仅仅用于版本检测。

`/tmp/d7c5471d195cdec17d8f4ebaf7516058/README.md` 提供了一个使用说明，介绍了如何使用该PoC。`/tmp/d7c5471d195cdec17d8f4ebaf7516058/ip-addr.list`包含需要检查的IP地址列表, 127.0.0.1是示例.

**有效性：**

提供的POC代码的**有效性在于验证目标系统是否存在漏洞**，而非直接利用该漏洞。根据搜索结果和漏洞描述，完整的漏洞利用需要更复杂的步骤和技术，例如大量连接尝试来触发竞争条件，以及精心构造的shellcode。因此，此PoC仅仅是前期验证步骤。

**投毒风险：**

该仓库中存在**投毒风险的可能性较低，约为10%**。PoC代码主要功能是版本检测，本身没有发现恶意代码。潜在的风险可能存在于：

*   `ip-addr.list`文件：虽然当前提供的`ip-addr.list`文件只包含本地地址`127.0.0.1`, 如果用户不小心使用了作者预先设定的其他IP地址列表，可能会导致未授权的扫描或攻击行为。
*   `session.log`文件：虽然日志记录本身不是恶意行为，但如果日志文件被上传或泄露，可能暴露用户的扫描目标信息。日志信息包含IP和端口信息。
*   在实际利用该漏洞时，如果攻击者使用了恶意的Payload，可能会对目标系统造成更大的危害。这些Payload可能被伪装成无害的代码，从而绕过安全检测。
*   如果作者在其他未公开的分支或版本中包含了恶意代码，并且诱导用户使用这些版本，则存在更高的投毒风险。

**综上所述，**虽然提供的PoC代码本身不包含明显的恶意代码，但用户在使用时仍然需要保持警惕，仔细审查代码，并确保从可信的来源获取代码，避免潜在的投毒风险。

**项目地址:** [jocker2410/CVE-2024-6387_poc](https://github.com/jocker2410/CVE-2024-6387_poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #19

**来源**: [CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：**

从搜索结果和漏洞库信息来看，该漏洞存在可利用的POC。提供的Rust代码是一个漏洞检查器，它通过连接到SSH服务器并读取SSH banner来判断目标服务器是否运行着存在漏洞的OpenSSH版本。

**投毒风险：**

提供的代码是一个漏洞检测工具，用于检查目标系统是否存在CVE-2024-6387漏洞。代码功能相对清晰，主要包括：

*   定义了易受攻击和已修补的版本列表。
*   通过TCP连接获取SSH banner。
*   将获取的banner与已知易受攻击的版本进行比较。

代码中没有发现恶意行为，例如执行系统命令或上传/下载文件。因此，**投毒风险较低，判断为0%**。

**利用方式：**

根据漏洞信息和搜索结果，攻击者需要发起大量的连接尝试，以触发sshd中的竞争条件。成功利用该漏洞可能允许攻击者在目标系统上执行任意代码或导致拒绝服务。Offsec的博客提供了关于如何利用该漏洞的更详细的解释。

**总结：**

CVE-2024-6387是一个严重的安全漏洞，允许未经身份验证的攻击者远程执行代码。虽然利用该漏洞需要一定的资源和技术，但由于存在公开的POC，因此建议尽快更新OpenSSH版本。

**项目地址:** [kubota/CVE-2024-6387-Vulnerability-Checker](https://github.com/kubota/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #20

**来源**: [CVE-2024-6387-l-urk_CVE-2024-6387.md](../2024/CVE-2024-6387-l-urk_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH regreSSHion 远程代码执行漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** OpenSSH

**危害等级:** 高危，未授权的远程攻击者可以利用此漏洞以 root 权限执行任意代码，或者造成拒绝服务。

**影响版本:** 8.5p1 ~ 9.7p1

**利用条件:** 目标系统使用受影响的 OpenSSH 版本, 并且基于 glibc 的 Linux 系统。需要网络连通性, 且攻击者需要能够发起大量的 SSH 连接尝试。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，又名 regreSSHion，是 OpenSSH 服务器中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件漏洞，允许未经身份验证的远程攻击者在基于 glibc 的 Linux 系统上执行任意代码。漏洞的利用方式涉及发起大量的 SSH 连接尝试，触发 sshd 进程中的竞争条件，从而允许攻击者将指令插入堆中，最终实现 RCE。

**有效性：**
从搜索结果和漏洞库信息来看，此漏洞是真实存在的，并且存在公开可用的 PoC 代码。PoC 代码的描述也与漏洞描述一致，表明其具有较高的有效性。

**投毒风险：**
提供的 POC 代码库中的 `LISCENCE` 文件声明了严格的权限限制，这在一定程度上增加了投毒的可能性。虽然无法通过现有信息完全确定是否存在投毒代码，但需要对脚本进行仔细审查，特别注意以下几个方面：

*   **shellcode:**  分析 shellcode 的行为，确保其功能与漏洞利用目的相符，没有恶意行为。
*   **网络连接:**  检查代码中是否存在额外的网络连接，特别是连接到未知或可疑的 IP 地址。
*   **文件操作:**  检查代码中是否存在对系统文件的修改或删除操作。
*   **依赖项:**  审查 `requirements.txt` 文件中的依赖项，确保没有引入恶意的第三方库。

考虑到需要大量连接尝试和对堆的操纵，以及许可证的严格声明，综合评估投毒风险为10%。这部分代码逻辑比较复杂，存在隐藏恶意代码的可能性。

**利用方式：**
1.  攻击者通过网络向目标 OpenSSH 服务器发起大量的连接请求。
2.  利用 OpenSSH 服务器处理连接请求时存在的竞争条件，特别是在信号处理方面。
3.  通过精心构造的数据包，将恶意代码注入到服务器的堆内存中。
4.  触发执行注入的恶意代码，从而获得对目标系统的控制权 (RCE) 或导致拒绝服务 (DoS)。
5.  默认的shellcode打开9999端口,并使用nc进行监听。

**项目地址:** [l-urk/CVE-2024-6387](https://github.com/l-urk/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #21

**来源**: [CVE-2024-6387-lflare_cve-2024-6387-poc.md](../2024/CVE-2024-6387-lflare_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是OpenSSH服务器(sshd)中的一个竞争条件漏洞，源于CVE-2006-5051的安全回归。当sshd在不安全的方式下处理某些信号时，未经验证的远程攻击者可能通过在设定的时间内未能成功验证身份来触发此漏洞。

**有效性评估：**
根据漏洞信息和搜索结果，此漏洞的PoC已经发布，并且被广泛讨论，证明了其有效性。PoC代码（`7etsuo-regreSSHion.c`）尝试利用此漏洞，通过以下步骤：

1.  **连接建立：** 与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH协议握手。
3.  **堆准备：** 准备堆布局以进行利用。
4.  **时间测量：** 测量数据包解析时间。
5.  **竞争条件尝试：** 尝试触发竞争条件，利用信号处理中的不安全函数调用，最终目标是执行shellcode，提权至root。
6.  **ASLR绕过：**尝试不同的glibc基地址，以绕过地址空间布局随机化(ASLR)。

代码中包含了尝试20000次利用的循环，以及100ms的延时，这些都符合漏洞分析文章的描述，增加了利用成功的可能性。

**投毒风险评估：**

此PoC代码存在一定程度的投毒风险，因为:

1.  **Shellcode:** PoC代码包含一个shellcode占位符，攻击者需要替换成真实的shellcode。如果提供的shellcode本身是恶意的，那么使用此PoC会导致投毒。
2. **glibc地址:** PoC代码包含glibc基址，攻击者需要手动调整为目标系统的基址。如果提供的基址不正确，或者根本无法确定正确的基址，会影响利用成功率。如果攻击者故意提供错误的基址或者使用错误的基址绕过策略，也有可能导致拒绝服务。
3.  **定时参数：** PoC代码中的定时参数需要根据目标系统的响应速度进行调整。如果定时不当，可能导致利用失败，甚至使目标系统崩溃。
4.  **heap布局:** OpenSSH的堆布局会随着版本的变化而变化，需要针对不同的版本进行调整。如果不调整，可能无法成功利用。

**评估：**
PoC代码的编写者可能在代码中加入不易察觉的恶意行为，例如收集目标系统信息并发送到远程服务器等。但是，考虑到PoC的主要目的是为了验证漏洞，因此这种风险相对较低。PoC中已经存在大量的需要修改的地方，需要使用者有一定的漏洞知识储备，因此投毒风险相对较低。

**综合评估**：PoC中投毒风险预估为10%，

**利用方式总结：**

1.  攻击者首先需要与目标OpenSSH服务器建立连接。
2.  然后，攻击者需要执行SSH握手协议。
3.  接着，攻击者发送特制的数据包，触发sshd中的竞争条件。
4.  竞争条件允许攻击者覆盖内存中的关键数据结构。
5.  攻击者通过覆盖的数据结构，执行预先准备好的shellcode，从而获得目标系统的root权限。
6. 利用过程需要绕过ASLR保护，这可能需要多次尝试，或者使用其他信息泄露漏洞。
7. 攻击需要一定的timing， 把握好发送数据包的时间。

**项目地址:** [lflare/cve-2024-6387-poc](https://github.com/lflare/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #22

**来源**: [CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387是一个OpenSSH服务器(sshd)中的安全回归漏洞，存在于OpenSSH 8.5p1到9.7p1版本。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。远程攻击者可以通过在设定的时间内认证失败来触发此漏洞，可能导致远程代码执行或拒绝服务。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已确认存在，并且有POC代码可用。搜索引擎结果中的多个链接指向了漏洞分析、利用和修复方法，以及相关的讨论。

**投毒风险：**
提供的POC代码包含一个Python脚本（main.py）和一个README.md文件。脚本内容主要用于识别易受攻击的OpenSSH服务器，并无发现任何恶意代码或者后门，但是不排除后续增加投毒代码的可能性, 因此投毒风险极低。

**利用方式：**
1.  攻击者需要发起大量SSH连接到目标服务器。
2.  在LoginGraceTime时间内，故意使认证失败。
3.  利用竞争条件，使sshd以不安全的方式处理信号。
4.  如果成功，攻击者可能能够执行任意代码或导致服务崩溃（拒绝服务）。

**缓解措施：**
*   将OpenSSH升级到9.8或更高版本。
*   设置`LoginGraceTime 0`可以缓解RCE，但不能完全避免DoS攻击，建议结合`fail2ban`和防火墙使用。

**项目地址:** [moften/regreSSHion-CVE-2024-6387](https://github.com/moften/regreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #23

**来源**: [CVE-2024-6387-prelearn-code_CVE-2024-6387.md](../2024/CVE-2024-6387-prelearn-code_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 远程代码执行

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行

**影响应用:** OpenSSH

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (glibc-based Linux systems)

**利用条件:** 目标系统需要运行受影响版本的OpenSSH，且基于glibc。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，也被称为"regreSSHion"，是OpenSSH服务器（sshd）中的一个安全漏洞，是CVE-2006-5051的一个回归。它是由信号处理中的竞争条件引起的。未经身份验证的远程攻击者可以通过在设定的时间内未能成功进行身份验证来触发此漏洞，可能导致以root权限执行任意代码。该漏洞影响基于glibc的Linux系统上的OpenSSH 8.5p1到9.7p1版本。

**有效性：**
根据漏洞库信息、搜索结果（特别是来自Qualys和offsec的分析），以及POC代码的存在，可以判断该漏洞是有效的，并且存在可利用的POC。

**投毒风险：**
POC代码中存在一定的投毒风险。虽然代码的目的是利用该漏洞，但攻击者可能会修改shellcode以进行恶意活动，或者在代码中加入额外的后门。例如，`shellcode`变量中包含占位符，需要替换为实际的shellcode。如果用户从不可信来源下载POC，并使用了包含恶意shellcode的POC，则可能存在投毒风险。代码中定义了多个glibc地址用于绕过ASLR，攻击者可以伪造错误的地址，来扰乱攻击。

**利用方式：**
利用方式涉及以下几个步骤：

1.  **建立连接：** 攻击者首先与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH握手过程，包括版本交换和密钥交换的初始化。
3.  **堆准备：** 发送特定的SSH数据包，以在sshd进程的堆上创建特定的内存布局，为利用创造条件。
4.  **触发竞争条件：** 攻击者触发一个竞争条件，该条件涉及OpenSSH处理信号的方式，利用SIGALRM信号处理程序中的不安全函数调用。
5.  **地址绕过：** 通过尝试多个可能的glibc基址，绕过地址空间布局随机化 (ASLR)。
6.  **执行代码：** 成功触发竞争条件后，将恶意shellcode注入到内存中并执行，从而获得远程代码执行权限（通常以root权限）。

**缓解措施包括：**
*   禁用`LoginGraceTime`参数，虽然不能完全阻止DoS，但可以防御RCE。
*   使用`fail2ban`等工具监控日志文件并管理连接。
*   及时更新到OpenSSH的修复版本。

**项目地址:** [prelearn-code/CVE-2024-6387](https://github.com/prelearn-code/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #24

**来源**: [CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md](../2024/CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，glibc-based Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387是一个OpenSSH服务器中的竞争条件漏洞（源于CVE-2006-5051的回归）。未经身份验证的远程攻击者可以通过在设定的时间内未能完成身份验证来触发此漏洞。利用方式是发送大量连接请求，触发竞争条件，在glibc-based Linux系统上可能导致在堆中插入恶意指令，最终实现远程代码执行或拒绝服务。提供的脚本并非POC，而是缓解措施：

1.  **有效性：** 提供的脚本实际上是一个缓解脚本，通过将`LoginGraceTime`设置为0来减少漏洞被利用的可能性，并不能直接验证漏洞，缓解脚本会禁用SSHD服务器在指定超时时间内未完成身份验证时断开连接的能力。虽然降低了RCE的风险，但增加了拒绝服务(DoS)的风险。

2.  **投毒风险：** 提供的脚本目的是缓解漏洞，没有发现任何隐藏的恶意代码，因此投毒风险为0%。

3.  **利用方式：** 根据漏洞信息和搜索结果，利用方式是未认证的攻击者向目标OpenSSH服务器发送大量连接请求，由于竞争条件的存在，sshd可能以不安全的方式处理信号，从而允许攻击者执行任意代码（RCE）或造成拒绝服务(DoS)。攻击成功的关键在于触发竞争条件，因此需要大量的并发连接尝试。


**项目地址:** [redux-sibi-jose/mitigate_ssh](https://github.com/redux-sibi-jose/mitigate_ssh)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #25

**来源**: [CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md](../2024/CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，并且攻击者能够建立SSH连接并触发竞争条件。攻击者需要尝试大量连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全漏洞，源于信号处理中的竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：** 根据漏洞库信息和搜索结果，此漏洞存在PoC。该漏洞的利用依赖于触发竞争条件，因此需要进行大量的连接尝试。

**投毒风险：** 分析提供的PoC代码，主要包含一个检测脚本（detection-script.py）和一个README。检测脚本尝试建立到目标SSH服务器的连接，并发送SSH协议版本字符串，然后读取服务器的响应。LICENSE文件和README.md文件是标准格式，描述了漏洞信息。由于检测脚本本身较为简单，且没有发现明显的恶意代码，因此投毒的风险较低，约为10%。 但是需要人工review所有代码.特别是二进制文件.

**利用方式：** 利用此漏洞需要：
1.  攻击者向目标服务器上的sshd服务发起大量的连接请求。
2.  在连接建立但身份验证尚未完成时，利用竞争条件触发信号处理错误。
3.  如果成功利用，攻击者可以在目标系统上执行任意代码，获得root权限（根据漏洞描述和搜索结果）。

利用的复杂性在于需要精确地控制时序，以触发竞争条件。这通常需要大量的计算资源和对目标系统行为的深入了解。同时该漏洞在glibc-based Linux systems更有效,可能无法在所有系统上利用。

**项目地址:** [s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH](https://github.com/s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #26

**来源**: [CVE-2024-6387-wiggels_regresshion-check.md](../2024/CVE-2024-6387-wiggels_regresshion-check.md)

# CVE-2024-6387

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-6387-AzrDll_CVE-2024-6387.md](../2024/CVE-2024-6387-AzrDll_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH 竞争条件导致 RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。需要发起大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务中的一个竞争条件漏洞，源于 CVE-2006-5051 的回归。未经身份验证的远程攻击者可以通过在短时间内发起大量失败的身份验证尝试来触发此漏洞。利用此漏洞需要在glibc堆中插入指令，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞确实存在，并且有公开的PoC利用代码。该PoC通过建立大量的 SSH 连接并进行不成功的身份验证来触发竞争条件。参考[webpage 3]，此漏洞允许glibc Linux发行版在堆中插入指令，从而实现代码执行。提供的PoC代码尝试利用这一点，但成功率可能较低，因为竞争条件需要精确的时间控制。

**投毒风险：**
提供的PoC代码`/tmp/fe03af2a23123389ff9785e2fb119f2c/PoC.py` 包含了从文件中读取glibc地址的功能。 虽然代码本身没有明显的恶意行为，但如果提供的 `glibc_file` 包含恶意构造的地址，可能会导致非预期的行为，甚至导致拒绝服务。例如，如果`glibc_base`地址指向了关键系统函数，覆盖该地址可能造成系统崩溃。另一个潜在的风险点是 `timing_adjustment`，如果调整不当可能造成DoS。综上所述，投毒风险为10%。主要是考虑到作者可能在利用代码的 `glibc_file` 参数中提供恶意的 glibc 地址，诱导用户使用，从而达到破坏目标系统的目的。

**利用方式：**
1.  **建立连接：** 攻击者首先建立与目标 OpenSSH 服务器的 TCP 连接。
2.  **SSH 握手：** 攻击者执行 SSH 握手过程，例如发送 SSH 版本字符串。
3.  **堆准备：** PoC尝试在堆上分配一些数据，为利用竞争条件做准备。
4.  **触发竞争条件：**  通过快速发送大量失败的身份验证请求，攻击者试图触发 `sshd` 进程中的竞争条件。这涉及利用 `LoginGraceTime` 参数，该参数允许攻击者在身份验证超时之前发送多个请求。根据[webpage 6]，利用此漏洞需要大量连接尝试才能准确触发竞争条件。
5.  **代码执行：**  如果竞争条件被成功触发，攻击者可以在内存中写入恶意代码，从而实现远程代码执行。提供的 PoC 代码尝试通过覆盖 glibc 的地址来实现这一点。如果成功利用，攻击者可以获得 root 权限，如[webpage 1][webpage 4]所描述。
6.  **拒绝服务：** 即使未能成功实现 RCE，攻击者也可能通过耗尽服务器资源来实现拒绝服务。由于竞争条件涉及信号处理，不正确的信号处理可能导致 `sshd` 崩溃。

**项目地址:** [AzrDll/CVE-2024-6387](https://github.com/AzrDll/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #2

**来源**: [CVE-2024-6387-DimaMend_cve-2024-6387-poc.md](../2024/CVE-2024-6387-DimaMend_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行(RCE)和拒绝服务(DoS)

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，并且目标系统基于glibc。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全漏洞，它是由CVE-2006-5051引入的回归错误。该漏洞是一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**利用方式：**

1.  **建立连接：** 攻击者首先与易受攻击的OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者尝试进行SSH握手，但故意不完成身份验证过程。这是为了触发`LoginGraceTime`超时。
3.  **堆准备：** 攻击者发送一系列SSH数据包，旨在操纵服务器的内存堆的布局。 这可能涉及到分配和释放内存，以便为利用创造合适的条件。
4.  **触发竞争条件：** 攻击者利用`LoginGraceTime`超时机制。当服务器由于握手超时而即将终止连接时，会发送一个信号。 攻击者尝试与此信号处理程序执行竞争，以修改服务器的内存。
5.  **代码执行：** 如果竞争成功，攻击者可以将恶意代码注入到服务器的内存中，并获得代码执行能力。 根据具体利用方式，这可能导致以root权限执行代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞的利用是可行的。许多信息源表明，存在公开可用的PoC，并且已经有人成功利用了此漏洞。 PoC代码的功能是尝试利用这个竞态条件。

**投毒风险分析：**

PoC代码中存在投毒代码的风险很低，原因如下：

*   **代码结构：** 代码主要集中于建立连接、进行SSH握手、操纵堆内存以及尝试触发竞态条件。虽然代码较为复杂，但在总体流程上没有明显的恶意操作。
*   **Shellcode占位符：** 代码中存在一个 `shellcode` 占位符，明确提示用户需要替换成实际的 shellcode。这表明作者的意图是提供一个框架，而不是一个直接可用的恶意载荷。
*   **注释和说明：** 代码包含大量的注释和说明，解释了漏洞的原理、利用方法以及需要调整的参数。这表明作者的目的是帮助研究人员理解和复现漏洞，而不是隐藏恶意代码。
*   **随机性和尝试次数：** 代码包含大量的随机尝试，目的是为了提高漏洞利用的成功率。这种随机性使得代码难以预测，也增加了作者插入恶意代码的难度。
*   **外部依赖：** 代码没有包含明显的外部依赖或网络请求，这降低了其被用于下载或执行恶意代码的风险。

虽然直接投毒的可能性较低，但仍然存在一些潜在风险，比如在 `shellcode` 占位符中插入恶意代码，或者在调整参数的过程中引入错误，导致程序行为异常。因此，在使用 PoC 代码时，仍然需要进行仔细的代码审查和安全测试。

综上所述，此仓库中存在作者隐藏的投毒代码的可能性估计为1%。

**项目地址:** [DimaMend/cve-2024-6387-poc](https://github.com/DimaMend/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #3

**来源**: [CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行存在漏洞版本的OpenSSH服务，且攻击者能够建立SSH连接，并在认证超时前发送恶意数据。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，存在于glibc的linux系统。它源于一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该漏洞是有效的。多个来源都确认了该漏洞的存在以及其远程代码执行的潜力。POC代码的存在进一步支持了其可利用性。

**投毒风险：**

POC代码本身包含以下潜在的投毒风险点：

*   **Shellcode占位符:** 代码中明确提到 `Shellcode placeholder (replace with actual shellcode)`。如果用户直接使用未经审查的 shellcode，则可能引入恶意行为。此处的风险不在于作者投毒，而在于用户使用不当。
*   **GLIBC_BASES:**  `GLIBC_BASES[]` 数组包含可能的 glibc 基地址。如果这个地址不准确，利用将失败。如果作者故意提供错误的地址，可能会导致拒绝服务或误导分析。
*   **Timing parameters:** 注释提到需要根据目标系统调整 timing 参数。错误的 timing 可能导致利用失败或系统不稳定。
*   **Heap layout 和 File structure offsets:**  代码注释中也强调了需要针对不同的 OpenSSH 和 glibc 版本进行调整，否则利用会失败。故意设置错误的值可能导致程序崩溃或产生其他未定义行为。
*   **随机数生成:** 代码使用 `srand(time(NULL))` 初始化随机数生成器。虽然这本身不是投毒，但如果后续利用中依赖于可预测的随机数，可能会被利用。

总体评估投毒风险为30%。风险主要来自于需要用户自行替换的shellcode，以及需要用户根据目标环境配置的参数。作者本身隐藏恶意代码的可能性较低，但用户在使用过程中存在引入风险的可能性。

**利用方式：**

1.  **建立连接：** 攻击者首先需要建立与目标 OpenSSH 服务器的连接。
2.  **SSH握手：** 进行初步的SSH握手过程，包括版本协商和密钥交换的初始化，但无需完成身份认证。
3.  **堆准备：**  `prepare_heap` 函数的目的是在堆上创建特定的布局，为后续的利用创造条件。具体实现细节未给出，但可能涉及分配和释放内存，以控制堆的状态。
4.  **时间测量：** `time_final_packet` 函数测量服务器处理特定数据包所需的时间。这个时间信息对于后续的竞争条件利用至关重要。
5.  **竞争条件：**  `attempt_race_condition` 函数尝试触发漏洞的核心：信号处理程序中的竞争条件。这通常涉及发送一个精心构造的数据包，该数据包会在服务器处理过程中触发 SIGALRM 信号。由于信号处理程序使用了异步信号不安全函数，因此可能导致堆损坏。
6.  **代码执行：**  如果竞争条件成功触发，攻击者就可以利用堆损坏来执行任意代码。这通常涉及覆盖函数指针或控制程序的执行流程。

该漏洞的利用依赖于精确的 timing 和对目标系统内存布局的了解。攻击者需要进行大量的尝试才能成功利用该漏洞。

**项目地址:** [HadesNull123/CVE-2024-6387_Check](https://github.com/HadesNull123/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #4

**来源**: [CVE-2024-6387-Karmakstylez_CVE-2024-6387.md](../2024/CVE-2024-6387-Karmakstylez_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器(sshd)中的一个安全回归漏洞，存在于glibc-based Linux系统。该漏洞源于信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。该漏洞利用代码尝试通过大量的连接请求触发竞争条件，通过调整glibc基地址和定时参数绕过ASLR，将恶意代码注入到堆中，最终实现以root权限远程代码执行。

有效性：根据漏洞信息和搜索结果，此POC代码具备一定的有效性，但成功利用需要满足特定条件，例如目标系统使用glibc，以及OpenSSH版本在受影响范围内。同时，漏洞利用的成功率受到系统负载、网络延迟等因素的影响，需要进行大量的尝试。

投毒风险：POC代码中存在一定的投毒风险。虽然POC代码的主要目的是利用已知的漏洞，但攻击者可能在代码中加入恶意功能，例如植入后门、收集敏感信息等。例如，shellcode 部分是明显的注入点。风险评定为10%，主要基于以下几点：
1.  **Shellcode 替换：** 代码明确指出 `shellcode` 变量是占位符，需要替换为实际的 shellcode。如果用户不小心使用了包含恶意指令的 shellcode，则可能导致投毒。
2.  **glibc 基地址猜测：** 虽然代码尝试多个 glibc 基地址，但如果攻击者预先知道目标系统的 glibc 地址，则可以修改 `GLIBC_BASES` 数组以提高利用成功率，同时也可能引入恶意地址。
3.  **Timing 参数调整：** 代码中的 `usleep` 函数用于控制连接尝试之间的延迟。攻击者可以通过调整这些参数来优化漏洞利用，但也可能引入导致拒绝服务 (DoS) 的参数。
4.  **编译选项：**POC 需要编译，攻击者可以在编译时添加额外的恶意编译选项，例如禁用安全特性等。
5.  **作者本身:** 仓库作者有投毒行为.

利用方式：
1.  攻击者首先需要确定目标系统是否运行受影响的OpenSSH版本，以及是否基于glibc。
2.  攻击者发起大量的SSH连接请求，尝试触发竞争条件。
3.  攻击者利用精心构造的数据包覆盖堆上的特定内存区域，将恶意代码注入到sshd进程中。
4.  一旦恶意代码成功执行，攻击者即可获得目标系统的控制权。

**项目地址:** [Karmakstylez/CVE-2024-6387](https://github.com/Karmakstylez/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #5

**来源**: [CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md](../2024/CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md)

## CVE-2024-6387-OpenSSH-RegreSSHion-RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行并获取 root 权限或造成拒绝服务

**影响版本:** <= 9.7p1 (受影响版本 8.5p1 至 9.7p1)

**利用条件:** 需要目标服务器运行受影响版本的OpenSSH，且存在时间窗口内的未认证连接尝试。高危利用场景依赖glibc环境。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-6387，也被称为“regreSSHion”，是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞（CVE-2006-5051）。该漏洞源于信号处理中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC已经存在，并且能够实现远程代码执行和拒绝服务攻击。很多安全厂商和研究人员都发布了相关的分析报告和PoC代码。

**投毒风险：**
提供的漏洞利用代码（/tmp/270e32ae67508359811c0f9899155269/README.md 和 LICENSE）仅仅是声明了存在POC，根据现有信息，该仓库本身存在恶意代码的风险较低。但是，由于POC的执行具有高危性，在实际使用中，仍需要进行安全审查。

**利用方式：**
1.  **竞争条件：** 攻击者通过在短时间内发起大量未认证的连接尝试，触发 `sshd` 中的竞争条件。
2.  **信号处理：** 在特定的时间窗口内，`sshd` 可能会以不安全的方式处理信号，导致内存损坏或其他异常行为。
3.  **远程代码执行/拒绝服务：**  利用内存损坏或其他异常行为，攻击者可以执行任意代码（RCE），或导致 `sshd` 崩溃，造成拒绝服务（DoS）。部分利用依赖特定的glibc环境。
4.  **ProxyCommand注入:** 根据github仓库的README.md描述，该POC利用了 `ProxyCommand` 配置不当或滥用的情况，攻击者可以注入恶意命令到 `ProxyCommand` 中，从而获得命令执行或者横向渗透的能力。

**缓解措施：**
*   升级到 OpenSSH 9.8 或更高版本。
*   设置 `LoginGraceTime 0` 以禁用在指定超时时间内未完成身份验证时服务器断开连接的功能（Red Hat 建议的临时缓解措施，但会使服务器更容易受到 DoS 攻击）。
*   使用 `fail2ban` 等工具，配合防火墙来监控日志文件并适当管理连接。

**项目地址:** [Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC](https://github.com/Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #6

**来源**: [CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md](../2024/CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）或拒绝服务（DoS）

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。它是一个竞争条件漏洞，可能导致sshd以不安全的方式处理信号。远程攻击者可以通过在设定的时间内未能成功验证身份来触发此漏洞，从而可能导致远程代码执行或拒绝服务。

**有效性评估：**

根据漏洞库信息、搜索结果以及提供的POC代码来看，此漏洞的POC是存在的，并且多个安全厂商都发布了相关的分析报告和检测方法。搜索结果也表明此漏洞允许远程未授权代码执行。

**利用方式：**

1.  攻击者建立与目标OpenSSH服务器的连接。
2.  进行SSH握手，获取服务器banner。
3.  准备堆，发送一定量的填充数据。
4.  尝试触发竞争条件，通过发送包含`glibc_base`地址的payload，并附加一些`nop`指令。
5.  如果成功，则在服务器上执行代码，获得root权限。
6.  脚本使用了多线程来增加攻击成功的几率，并对时序进行调整。

**投毒风险评估：**

提供的POC代码（`Exploit_2024_6387.py`）本身是一个漏洞利用脚本，其目的是利用目标系统的漏洞。评估投毒风险主要关注作者是否在脚本中植入了恶意代码，例如：

*   **后门代码：**  脚本在成功利用漏洞后，是否会创建一个后门，允许攻击者在未经授权的情况下再次访问系统。
*   **破坏性代码：**  脚本是否包含旨在破坏目标系统或数据的代码。
*   **信息窃取代码：**  脚本是否会窃取目标系统上的敏感信息。

分析代码发现，虽然脚本本身旨在利用漏洞，但并未发现明显的后门、破坏性或信息窃取代码。 然而，需要注意的是，该脚本的`TARGET_IP`和`TARGET_PORT`是硬编码的，在实际使用中需要进行修改。此外，攻击者可能会修改此脚本以包含恶意功能。此处的`glibc_base`地址也需要根据目标环境进行调整，否则利用大概率会失败，这也是成功利用此漏洞的难点之一。

综合来看，该仓库存在投毒风险的可能性较低，但是不排除有攻击者对代码进行修改后，二次传播。因此，建议在使用前仔细审查代码。

**风险评估：**
`poison`的百分比评估主要考虑以下几个方面：

*   **代码复杂性：** 代码越复杂，隐藏恶意代码的可能性越高。
*   **作者信誉：** 如果作者的信誉未知或可疑，则风险越高。
*   **代码审查：** 代码是否经过其他安全研究人员的审查。

根据以上分析，此脚本的`poison`风险评估为10%。

**项目地址:** [SkyGodling/CVE-2024-6387-POC](https://github.com/SkyGodling/CVE-2024-6387-POC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #7

**来源**: [CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md](../2024/CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，未认证的远程攻击者通过在设定的时间内认证失败触发

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞(CVE-2006-5051)。它存在一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，进而导致远程代码执行(RCE)或拒绝服务(DoS)。

根据搜索结果和漏洞信息，该漏洞影响glibc-based Linux系统，利用需要发起大量连接尝试来触发竞争条件。

提供的漏洞利用代码 `scanner.py` 是一个版本扫描器，并非直接利用 CVE-2024-6387。它用于检测目标 SSH 服务器的版本，并根据预定义的 CVE 列表判断是否存在已知的漏洞。该脚本通过创建 socket 连接到目标主机的 SSH 端口，然后发送一个空字节并接收服务器的响应，从中提取 OpenSSH 的版本信息。然后将提取的版本与易受攻击的版本列表进行比较。

**漏洞利用方式：**

1.  攻击者需要向目标 OpenSSH 服务器发起大量的连接请求。
2.  在连接建立后，故意触发认证失败，从而在信号处理过程中创建竞争条件。
3.  竞争条件允许攻击者在某些 glibc Linux 发行版中将指令插入堆中，进而实现远程代码执行。

**投毒风险：**

虽然脚本本身是一个版本扫描器，而不是直接的漏洞利用程序，但仍需谨慎评估其潜在的投毒风险。 代码中存在创建日志目录并记录扫描结果的行为，存在恶意修改扫描逻辑或在日志中写入恶意数据，但可能性极低。因此，评估投毒风险为1%。

**项目地址:** [ThatNotEasy/CVE-2024-6387](https://github.com/ThatNotEasy/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #8

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 远程代码执行/拒绝服务

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1，受影响版本包括8.5p1至9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且攻击者能够发起大量连接请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞，它源于 CVE-2006-5051。该漏洞是一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间段内未能通过身份验证来触发此漏洞。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的PoC代码是有效的。多个来源证实了该漏洞的存在和可利用性，特别是针对glibc的Linux系统。

**投毒风险：**

提供的PoC代码包含用于编译、构建和利用漏洞的Dockerfile和Python脚本。通过分析代码，可以发现以下潜在的投毒风险因素：

*   **依赖项：** Dockerfile中使用了`wget`和`curl`来下载OpenSSH源码，存在被中间人攻击替换为恶意源码的风险。尽管校验和可以降低这种风险，但如果攻击者能够控制构建环境，仍然可能引入恶意代码。
*   **shellcode：** Python脚本包含一个名为`shellcode`的变量，目前只是占位符，但攻击者可以修改此变量，插入恶意shellcode。攻击者可以精心构造shellcode，以执行恶意操作，例如安装后门、窃取数据或提权。

虽然这些风险存在，但从现有代码来看，没有发现明显的恶意代码。因此，评估投毒风险为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的OpenSSH环境（32位Linux系统）。
2.  **SSH握手：** 客户端与服务器建立连接，发送SSH版本信息并进行密钥交换（KEX）初始化。
3.  **堆准备：** 通过发送特定大小的数据包来布置堆内存，利用glibc的漏洞插入恶意指令。
4.  **触发竞争条件：** 大量连接尝试来触发信号处理程序中的竞争条件。
5.  **执行代码：** 成功触发竞争条件后，恶意代码将被执行，从而实现远程代码执行。

总体来说，利用方式较为复杂，需要精心构造数据包和进行大量的连接尝试才能成功。

**项目地址:** [YassDEV221608/CVE-2024-6387](https://github.com/YassDEV221608/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #9

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 9.7p1 (影响 8.5p1 到 9.7p1)

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，并且是基于glibc的Linux系统。攻击者需要能够建立到SSH服务的网络连接，并能够快速发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中发现的一个安全回归漏洞，存在于glibc的Linux系统中。该漏洞是由于OpenSSH服务器（sshd）中的信号处理存在竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用此漏洞可能导致以 root 身份远程执行代码。

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果也确认了该漏洞的存在，并描述了其可能导致远程代码执行的风险。漏洞利用代码的存在也进一步证实了漏洞的有效性，代码尝试利用竞争条件来执行任意代码。

**投毒风险：**
代码存在一定的投毒风险的可能性。虽然代码本身看起来是在尝试利用该漏洞，但以下因素需要考虑：

1.  **Shellcode占位符：** 代码中包含一个shellcode占位符`unsigned char shellcode[] = "\x90\x90\x90\x90";`，明确指示需要替换成实际的shellcode。如果用户没有意识到这一点，或者使用了恶意shellcode，可能会造成损害。这里的投毒风险在于，攻击者可能发布包含恶意shellcode的exp，诱导用户使用。 
2.  **GLIBC_BASES：** 代码中定义了`GLIBC_BASES[]`，用于绕过ASLR。如果这些地址不正确，利用将失败。更糟糕的是，如果攻击者故意提供错误的地址，可能会导致程序崩溃或其他不可预测的行为。
3.  **Timing parameters和 Heap layout 需要调整：** 代码注释中强调了定时参数和堆布局需要根据目标系统进行调整。如果这些参数设置不正确，可能会导致利用失败或目标系统不稳定。
4.  **文件结构偏移量：** 代码提到需要验证特定glibc版本的文件结构偏移量。使用错误的偏移量可能导致内存损坏或其他不可预测的行为。

总体来看，该POC的复杂性和对系统内部结构的依赖性，投毒者可以通过提供不正确的配置参数，或者引导用户使用错误的shellcode，达到破坏目标系统的目的。因此存在10%的投毒风险。

**利用方式：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **建立连接：** 攻击者首先需要与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者需要完成初始的SSH握手过程，包括协议版本交换和密钥交换初始化（KEX）。
3.  **堆准备：** 攻击者利用SSH协议发送数据包，在内存堆上布置精心构造的数据结构，为后续的漏洞利用做准备。
4.  **触发竞争条件：** 攻击者发送一个特制的SSH数据包，该数据包的设计是为了触发sshd中的竞争条件。具体来说，它利用了在身份验证失败的情况下，信号处理程序中的不安全操作。
5.  **RCE：** 成功触发竞争条件后，攻击者可以将恶意代码注入到sshd进程中，从而实现远程代码执行。具体是通过内存操作覆盖某个函数指针，使其指向攻击者提供的shellcode。
6.  **提权（Root）：** 由于sshd通常以root权限运行，因此攻击者执行的shellcode也将以root权限运行，从而完全控制目标系统。

**项目地址:** [YassDEV221608/CVE-2024-6387_PoC](https://github.com/YassDEV221608/CVE-2024-6387_PoC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #10

**来源**: [CVE-2024-6387-alex14324_ssh_poc2024.md](../2024/CVE-2024-6387-alex14324_ssh_poc2024.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）和拒绝服务（DoS）

**影响版本:** <= 9.7p1

**利用条件:** 需要目标系统开启sshd服务，且受影响的OpenSSH版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是一个存在于OpenSSH服务器（sshd）中的安全漏洞，具体来说是一个竞争条件漏洞。该漏洞源于OpenSSH处理信号的方式。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，导致sshd以不安全的方式处理信号。这可能导致远程代码执行（RCE），攻击者获得root权限，或拒绝服务（DoS），使服务器不可用。

**有效性分析：**
从漏洞库信息、搜索结果和提供的PoC代码来看，该漏洞的PoC是存在的，并且被广泛讨论和利用。 搜索结果中提到“regreSSHion (CVE-2024-6387) is an unauthenticated RCE vulnerability in OpenSSH’s server, affecting glibc-based Linux systems. Full root access is granted.” 表明该漏洞有很高的潜在影响. PoC代码也试图绕过ASLR，并包含shellcode的占位符，表明攻击者可以注入恶意代码。

**投毒风险分析：**
提供的PoC代码具有一定的投毒风险，大约为10%。主要基于以下几点：
1.  **Shellcode占位符：** 代码中包含`unsigned char shellcode[] = "\x90\x90\x90\x90";`。虽然这只是一个占位符，需要用户替换为实际的shellcode，但攻击者可能发布包含恶意shellcode的版本，诱导用户使用。
2.  **GLIBC_BASES地址：**  代码中包含了`uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`。这些地址是ASLR绕过的尝试，但如果攻击者故意提供错误的地址，可能导致利用失败或者其他未知的行为，但一般不会产生特别大的危害。
3.  **Timing参数：** 代码中需要根据目标系统响应调整Timing参数。攻击者可能提供不合适的参数，导致利用不稳定或者失败。
4.  **Heap Layout和文件结构偏移：**  代码注释中提到“Heap layout : Requires tweaking for different OpenSSH versions.” 和 “File structure offsets: Verify for the specific glibc version.”。攻击者可能故意提供错误的值，导致利用失败或者产生其他问题。

**利用方式：**
1.  **建立连接：** 攻击者首先需要与目标服务器的sshd服务建立TCP连接。
2.  **SSH握手：** 进行SSH握手，包括版本交换、密钥交换等步骤。PoC代码中的 `perform_ssh_handshake` 函数实现了这些步骤。
3.  **堆准备：** 通过发送特定的SSH数据包，在sshd进程的堆上分配内存，并控制堆的布局。`prepare_heap` 函数用于执行此操作。
4.  **时间计算：**  计算处理最终数据包所需的时间，用于后续的竞争条件利用。`time_final_packet` 函数用于执行此操作。
5.  **竞争条件利用：**  通过大量并发连接，触发sshd中的竞争条件漏洞。攻击者不断尝试进行身份验证，但故意失败，以触发SIGALRM信号处理程序。由于信号处理程序中使用了非异步信号安全的函数，可能导致内存损坏和代码执行。`attempt_race_condition` 函数用于执行此操作。
6.  **ASLR绕过：**  由于地址空间布局随机化（ASLR）的存在，攻击者需要知道glibc的基地址。PoC代码中包含了一组可能的基地址，并尝试逐个利用。
7.  **代码注入：** 成功利用竞争条件后，攻击者可以将恶意代码（shellcode）注入到sshd进程的内存中。占位符需要替换。
8.  **代码执行：**  执行注入的shellcode，从而获得服务器的root权限。

**项目地址:** [alex14324/ssh_poc2024](https://github.com/alex14324/ssh_poc2024)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #11

**来源**: [CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md](../2024/CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH服务，并允许未授权的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)。

**有效性:**
根据搜索结果和漏洞库信息，此漏洞的PoC是存在的，并且已经被公开。多个来源证实了该漏洞的存在，以及它可能导致远程代码执行。提供的“漏洞利用代码”实际上是一个缓解脚本，旨在通过升级OpenSSH版本或禁用LoginGraceTime来降低风险，而不是一个实际的利用程序。

**投毒风险:**
提供的脚本主要功能是检测并修复漏洞，但仍然存在一定的投毒风险：
*   **依赖外部源：** 脚本使用`apt-get update`和`apt-get install`命令，依赖外部软件源。如果软件源被恶意篡改，可能导致安装恶意软件包。
*   **配置修改：** 脚本会修改`/etc/ssh/sshd_config`文件，存在被恶意利用修改配置的风险。
*   **权限提升：** 脚本需要root权限运行，如果脚本被篡改，可能导致提权攻击。
综合考虑，该脚本存在一定的投毒风险，但主要风险在于依赖的外部源和配置修改，因此投毒风险评估为10%。

**利用方式:**
此漏洞的利用方式是利用 sshd 进程处理信号时的竞争条件。攻击者需要发起大量连接尝试，并在身份验证失败时触发竞争条件。成功触发后，攻击者能够在目标系统上执行任意代码。根据 offsec.com 的博客文章，此漏洞利用机会在某些 glibc Linux 发行版中，能将指令插入堆中。

**项目地址:** [almogopp/OpenSSH-CVE-2024-6387-Fix](https://github.com/almogopp/OpenSSH-CVE-2024-6387-Fix)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #12

**来源**: [CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md](../2024/CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许未授权网络访问SSH端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387 (regreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的安全回归漏洞，源于 CVE-2006-5051。这是一个竞争条件漏洞，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内身份验证失败来触发此漏洞。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经公开。多个安全厂商和研究人员已经发布了关于此漏洞的分析和PoC代码。

**投毒风险分析：**

提供的Checker.py脚本的主要功能是检测目标SSH服务器是否存在CVE-2024-6387漏洞。它通过连接到目标服务器的SSH端口并获取SSH banner信息，然后将其与已知易受攻击和已修补的版本进行比较来确定漏洞状态。 代码中没有发现任何明显的恶意或后门代码。

投毒风险评估：0%。该脚本主要用于漏洞检测，不包含任何主动利用漏洞的代码，也没有发现作者隐藏的恶意代码。

**利用方式分析：**

1.  **漏洞原理：** 漏洞是由于 OpenSSH 在处理信号时存在竞争条件，允许在身份验证失败期间执行恶意代码。
2.  **攻击步骤：** 攻击者需要向目标服务器发起大量的SSH连接尝试。
3.  **触发条件：** 在连接尝试期间，攻击者故意使身份验证失败，触发竞争条件。
4.  **利用结果：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码，以root权限运行，或者造成拒绝服务攻击。
5.  **缓解措施：** 通过设置 `LoginGraceTime 0` 禁用 `LoginGraceTime` 参数可以缓解远程代码执行的风险，但仍然存在拒绝服务的风险。更新到OpenSSH 9.8或更高版本是完整的修复方案。

**项目地址:** [anhvutuan/CVE-2024-6387-poc-1](https://github.com/anhvutuan/CVE-2024-6387-poc-1)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #13

**来源**: [CVE-2024-6387-awusan125_test_for6387.md](../2024/CVE-2024-6387-awusan125_test_for6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要目标系统基于 glibc，且 OpenSSH 版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理程序中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用可能允许攻击者在目标系统上以 root 权限执行任意代码或导致拒绝服务。

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞的 PoC 已被公开，并且漏洞利用的复杂性较高。搜索结果表明，该漏洞影响 glibc 基础的 Linux 系统。提供的 POC 代码似乎旨在利用此漏洞。

**投毒风险分析：**
该 POC 代码中存在一定的投毒风险，大约 20%。原因如下：
*   **Shellcode 占位符:** 代码中包含 `unsigned char shellcode[] = "\x90\x90\x90\x90";` 这一行，明确指出需要替换为实际的 shellcode。如果用户不小心使用了该占位符，或者植入了其他有害 shellcode，则可能导致不可预期的后果。
*   **GLIBC 基地址硬编码:** 代码中定义了 `uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`，并表示 “Needs adjustment for specific target systems”。如果 GLIBC 基地址不正确，可能导致利用失败，甚至造成程序崩溃。攻击者可能会故意提供错误的基地址，使得用户在尝试利用时受到干扰，或者执行其他恶意操作。
*   **Timing 参数需要微调:** 代码注释中提到 “Timing parameters: Fine-tune based on target system responsiveness”。如果 timing 参数设置不当，可能导致竞争条件无法触发，或者引发其他问题。攻击者可能会提供误导性的 timing 参数，使得用户在尝试利用时遇到困难，或者触发非预期的行为。
*   **Heap 布局和文件结构偏移量:** 代码注释提到 “Heap layout : Requires tweaking for different OpenSSH versions” 和 “File structure offsets: Verify for the specific glibc version.” 这表示该漏洞利用依赖于特定的堆布局和文件结构偏移量。如果这些值不正确，则可能导致利用失败，甚至造成程序崩溃。攻击者可能会提供不兼容的值，使得用户在尝试利用时受到干扰，或者触发非预期的行为。
*   **错误处理不完善:** 代码中虽然包含了一些错误处理逻辑，但可能存在未处理的异常情况。攻击者可能会利用这些漏洞，使得程序在特定条件下崩溃或执行非预期的操作。

**利用方式：**
利用方式主要涉及以下步骤：
1.  **建立连接：** 与目标 SSH 服务器建立 TCP 连接。
2.  **SSH 握手：** 执行 SSH 握手过程，包括版本交换和密钥交换。
3.  **堆准备：** 通过发送特定的数据包，在堆上创建特定的布局。
4.  **时间控制：** 精确控制数据包的发送时间，以便触发竞争条件。
5.  **竞争条件触发：** 通过大量连接尝试和认证失败，利用信号处理程序的竞争条件在内存中注入恶意代码，通常包括修改 glibc 的数据结构。
6.  **代码执行：** 利用注入的恶意代码来执行任意命令。
7.  **绕过 ASLR：** 由于地址空间布局随机化 (ASLR) 的存在，需要确定 glibc 的基地址。PoC 代码中尝试了几个常见的基地址。

总体而言，该漏洞利用较为复杂，需要对 SSH 协议、glibc 内部机制和竞争条件有深入的了解。该漏洞的成功利用还依赖于目标系统的特定配置和状态。

**项目地址:** [awusan125/test_for6387](https://github.com/awusan125/test_for6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #14

**来源**: [CVE-2024-6387-dream434_CVE-2024-6387.md](../2024/CVE-2024-6387-dream434_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，目标系统运行受影响的OpenSSH版本，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性评估：**

根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已经被广泛讨论。漏洞利用代码的脚本主要用于检测目标主机是否运行存在漏洞的OpenSSH版本，利用方式是扫描目标IP的22端口，获取OpenSSH版本信息，并与已知的易受攻击版本进行比较，从而判断目标系统是否存在漏洞。

**投毒风险分析：**

提供的漏洞利用代码（CVE-2024-6387.py）主要用于版本检测，功能相对简单。虽然`README.md`中包含克隆GitHub仓库的操作，但直接分析提供的Python脚本，发现潜在的投毒点在于以下几个方面：

1.  **依赖包风险：** 脚本本身依赖较少，但如果`README.md`引导用户安装额外的依赖包（例如通过`pip install -r requirements.txt`，而`requirements.txt`包含恶意包），则可能存在投毒风险。
2.  **命令执行风险：** `README.md` 中的运行命令 `python CVE-2024-6387.py http://exemple.com` 虽然看起来无害，但如果 `CVE-2024-6387.py` 存在漏洞，允许通过命令行参数执行恶意代码，则存在风险。当前提供的代码没有直接利用命令行参数执行代码的逻辑。
3.  **文件包含风险：** 如果脚本尝试动态加载其他文件（例如配置文件），而这些文件被篡改，则可能存在风险。

鉴于以上分析，以及`README.md`中存在引导用户克隆github仓库的操作，综合判断，存在较低的投毒风险，约为10%。主要基于假设恶意代码可能存在于被克隆仓库的其他文件中，或者存在利用脚本漏洞执行恶意代码的可能。

**漏洞利用方式：**

1.  **版本检测：** 攻击者首先需要确定目标系统上运行的OpenSSH版本是否在受影响的范围内（8.5p1 <= version <= 9.7p1）。
2.  **触发竞争条件：** 攻击者通过与目标SSH服务器建立连接，并在身份验证过程中故意失败，以触发漏洞相关的竞争条件。
3.  **代码执行：** 成功触发竞争条件后，攻击者可以利用该漏洞在目标系统上执行任意代码，通常以root权限执行。

搜索结果也表明，此漏洞允许未经身份验证的远程代码执行，并且影响基于glibc的Linux系统。因此，利用方式的核心在于触发竞争条件并利用glibc的特性来执行恶意代码。

**项目地址:** [dream434/CVE-2024-6387](https://github.com/dream434/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #15

**来源**: [CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标主机开启SSH服务，且攻击者能够发起大量连接尝试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是一个OpenSSH服务器中的竞争条件漏洞。它源于OpenSSH处理信号的方式，当SSH服务器在短时间内收到大量连接请求且认证失败时，可能导致信号处理不当，进而允许未经验证的远程攻击者在基于glibc的Linux系统上执行任意代码，获取root权限，或者导致拒绝服务。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC已发布，表明漏洞可被利用。提供的Python脚本`CVE-2024-6387-Vulnerability-Checker.py`是一个漏洞检测工具，通过检查SSH banner版本来判断目标是否存在漏洞。脚本本身并不能直接利用该漏洞进行RCE或DoS攻击，而是用来辅助确认目标系统是否在受影响的范围内。

**投毒风险：**
该Python脚本主要功能是检查OpenSSH版本，判断其是否在受影响的范围内。代码本身只包含版本检测逻辑，没有发现任何恶意代码或后门，因此投毒风险极低。可以认为投毒风险为0%。

**利用方式：**
1.  **版本检测：** 使用PoC脚本或类似工具检测目标SSH服务器的版本，确认其是否位于易受攻击的范围(8.5p1 <= OpenSSH <= 9.7p1)。
2.  **触发竞争条件：** 如果目标版本易受攻击，攻击者需要发起大量连接尝试，并在短时间内故意认证失败，以触发竞争条件。
3.  **代码执行（或DoS）：** 成功触发竞争条件后，利用glibc的堆操作特性，攻击者可以插入恶意指令到堆中，从而实现远程代码执行。另一种利用方式是耗尽服务器资源，造成拒绝服务攻击。

需要注意的是，利用此漏洞进行RCE需要对glibc堆操作有一定的了解，并且成功率可能不高。缓解措施包括禁用`LoginGraceTime`配置，并使用`fail2ban`等工具限制恶意连接。

**项目地址:** [filipi86/CVE-2024-6387-Vulnerability-Checker](https://github.com/filipi86/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #16

**来源**: [CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-regreSSHion

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1 (OpenSSH)

**利用条件:** 需要glibc-based Linux系统，以及OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞。漏洞源于OpenSSH服务器处理信号的方式存在问题，具体来说，当用户认证失败时，可能触发不安全的信号处理。远程攻击者可以通过在短时间内发起大量SSH连接尝试，并故意触发认证失败，从而引发竞争条件，最终可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据搜索结果（webpage 1, 3, 4, 5, 7, 8）和漏洞库信息，该漏洞已被确认为一个高危漏洞，并且存在公开的PoC（Proof of Concept）代码。虽然提供的POC代码只是一个包含漏洞描述的README.md文件，**不能直接运行，但是，github上存在可利用的POC**。该POC的有效性取决于目标系统是否满足漏洞利用的条件，即：
1.  使用受影响的OpenSSH版本（<= 9.7p1）。
2.  目标系统是基于glibc的Linux发行版。
3.  系统配置允许一定数量的并发连接。

**投毒风险：**
提供的POC代码（README.md）本身不包含任何可执行代码，因此直接的投毒风险很低。但需要注意的是，任何从互联网上下载的代码都存在潜在的风险。即使是看似无害的文档，也可能包含恶意链接或指令，引导用户下载或执行恶意代码。因此，下载和使用任何PoC代码时，都应该保持警惕，并进行充分的安全审查。

虽然提供的README.md文件本身投毒风险较低,但是考虑到实际利用中需要依赖其他EXP, 因此其他仓库被投毒的可能性相对较高。
风险评估：10%

**利用方式：**
根据漏洞描述和搜索结果，利用方式主要包括以下几个步骤：
1.  **大量连接请求：** 攻击者向目标OpenSSH服务器发起大量的并发连接请求。
2.  **触发认证失败：**  在连接请求中，故意提供错误的用户名或密码，触发认证失败事件。
3.  **竞争条件利用：**  通过大量认证失败事件，触发OpenSSH服务器中的竞争条件漏洞。
4.  **代码执行或DoS：** 成功利用漏洞后，攻击者可以执行任意代码（RCE）或导致服务器崩溃（DoS）。

需要注意的是，利用该漏洞需要一定的资源和技术，并且成功率可能不高。Red Hat 在其安全公告中指出，实现RCE需要相当多的资源投入。同时，修改sshd_config,设置LoginGraceTime为0可以有效避免远程代码执行，但仍存在拒绝服务风险.

**项目地址:** [identity-threat-labs/Article-RegreSSHion-CVE-2024-6387](https://github.com/identity-threat-labs/Article-RegreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #17

**来源**: [CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，sshd服务运行且存在于受影响版本范围内，目标系统是基于glibc的Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中发现的竞争条件漏洞。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发该漏洞。成功利用可能导致以root权限远程执行代码或拒绝服务。该漏洞的利用依赖于触发信号处理程序的竞争条件，攻击者需要发起大量连接尝试才能提高触发漏洞的几率。提供的PoC代码是一个漏洞验证工具，用于检测目标系统上运行的OpenSSH版本是否存在漏洞。它通过连接到目标SSH端口并检查SSH横幅来工作。如果横幅指示易受攻击的版本，则该工具会将目标标记为易受攻击。PoC代码本身似乎不包含任何明显的投毒代码。它仅仅用于验证漏洞是否存在，并不会主动进行利用。

**利用方式：**

1.  攻击者向目标服务器的SSH端口发起大量连接请求。
2.  连接请求需要故意失败，例如提供无效的用户名或密码，以便触发身份验证失败流程。
3.  攻击者利用OpenSSH处理信号时的竞争条件，将恶意指令插入堆中。
4.  如果竞争条件利用成功，攻击者即可在目标系统上以root权限执行任意代码或导致拒绝服务。

**项目地址:** [identity-threat-labs/CVE-2024-6387-Vulnerability-Checker](https://github.com/identity-threat-labs/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #18

**来源**: [CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md](../2024/CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统使用受影响的OpenSSH版本，基于glibc的Linux系统，且未禁用LoginGraceTime

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是一个存在于OpenSSH服务器(sshd)中的竞争条件漏洞。该漏洞源于OpenSSH在处理信号时存在不安全行为。远程攻击者通过在一定时间内认证失败，可以触发此漏洞，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**漏洞利用方式：**

1.  攻击者向目标服务器发起大量的SSH连接请求。
2.  在SSH认证过程中，攻击者故意使认证失败，触发LoginGraceTime超时。
3.  由于竞争条件，sshd可能在处理SIGALRM信号时进入不安全状态。
4.  在glibc-based的Linux系统上，这种不安全状态可能允许攻击者将指令插入到堆中，最终导致RCE。
5.  如果无法实现RCE，攻击者可以通过耗尽服务器资源，导致DoS。

**POC代码分析：**

提供的PoC代码`/tmp/d7c5471d195cdec17d8f4ebaf7516058/CVE-2024-6387_poc.py`的主要功能是检测目标SSH服务器的版本，判断其是否受CVE-2024-6387漏洞影响。它通过建立socket连接，发送`\x00`，接收SSH版本信息，并进行正则匹配来确定OpenSSH的版本。如果版本在易受攻击的范围内（8.5 <= 版本 < 9.8）,则输出目标系统可能存在漏洞。该PoC本身**不包含直接利用漏洞的代码**，仅仅用于版本检测。

`/tmp/d7c5471d195cdec17d8f4ebaf7516058/README.md` 提供了一个使用说明，介绍了如何使用该PoC。`/tmp/d7c5471d195cdec17d8f4ebaf7516058/ip-addr.list`包含需要检查的IP地址列表, 127.0.0.1是示例.

**有效性：**

提供的POC代码的**有效性在于验证目标系统是否存在漏洞**，而非直接利用该漏洞。根据搜索结果和漏洞描述，完整的漏洞利用需要更复杂的步骤和技术，例如大量连接尝试来触发竞争条件，以及精心构造的shellcode。因此，此PoC仅仅是前期验证步骤。

**投毒风险：**

该仓库中存在**投毒风险的可能性较低，约为10%**。PoC代码主要功能是版本检测，本身没有发现恶意代码。潜在的风险可能存在于：

*   `ip-addr.list`文件：虽然当前提供的`ip-addr.list`文件只包含本地地址`127.0.0.1`, 如果用户不小心使用了作者预先设定的其他IP地址列表，可能会导致未授权的扫描或攻击行为。
*   `session.log`文件：虽然日志记录本身不是恶意行为，但如果日志文件被上传或泄露，可能暴露用户的扫描目标信息。日志信息包含IP和端口信息。
*   在实际利用该漏洞时，如果攻击者使用了恶意的Payload，可能会对目标系统造成更大的危害。这些Payload可能被伪装成无害的代码，从而绕过安全检测。
*   如果作者在其他未公开的分支或版本中包含了恶意代码，并且诱导用户使用这些版本，则存在更高的投毒风险。

**综上所述，**虽然提供的PoC代码本身不包含明显的恶意代码，但用户在使用时仍然需要保持警惕，仔细审查代码，并确保从可信的来源获取代码，避免潜在的投毒风险。

**项目地址:** [jocker2410/CVE-2024-6387_poc](https://github.com/jocker2410/CVE-2024-6387_poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #19

**来源**: [CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：**

从搜索结果和漏洞库信息来看，该漏洞存在可利用的POC。提供的Rust代码是一个漏洞检查器，它通过连接到SSH服务器并读取SSH banner来判断目标服务器是否运行着存在漏洞的OpenSSH版本。

**投毒风险：**

提供的代码是一个漏洞检测工具，用于检查目标系统是否存在CVE-2024-6387漏洞。代码功能相对清晰，主要包括：

*   定义了易受攻击和已修补的版本列表。
*   通过TCP连接获取SSH banner。
*   将获取的banner与已知易受攻击的版本进行比较。

代码中没有发现恶意行为，例如执行系统命令或上传/下载文件。因此，**投毒风险较低，判断为0%**。

**利用方式：**

根据漏洞信息和搜索结果，攻击者需要发起大量的连接尝试，以触发sshd中的竞争条件。成功利用该漏洞可能允许攻击者在目标系统上执行任意代码或导致拒绝服务。Offsec的博客提供了关于如何利用该漏洞的更详细的解释。

**总结：**

CVE-2024-6387是一个严重的安全漏洞，允许未经身份验证的攻击者远程执行代码。虽然利用该漏洞需要一定的资源和技术，但由于存在公开的POC，因此建议尽快更新OpenSSH版本。

**项目地址:** [kubota/CVE-2024-6387-Vulnerability-Checker](https://github.com/kubota/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #20

**来源**: [CVE-2024-6387-l-urk_CVE-2024-6387.md](../2024/CVE-2024-6387-l-urk_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH regreSSHion 远程代码执行漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** OpenSSH

**危害等级:** 高危，未授权的远程攻击者可以利用此漏洞以 root 权限执行任意代码，或者造成拒绝服务。

**影响版本:** 8.5p1 ~ 9.7p1

**利用条件:** 目标系统使用受影响的 OpenSSH 版本, 并且基于 glibc 的 Linux 系统。需要网络连通性, 且攻击者需要能够发起大量的 SSH 连接尝试。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，又名 regreSSHion，是 OpenSSH 服务器中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件漏洞，允许未经身份验证的远程攻击者在基于 glibc 的 Linux 系统上执行任意代码。漏洞的利用方式涉及发起大量的 SSH 连接尝试，触发 sshd 进程中的竞争条件，从而允许攻击者将指令插入堆中，最终实现 RCE。

**有效性：**
从搜索结果和漏洞库信息来看，此漏洞是真实存在的，并且存在公开可用的 PoC 代码。PoC 代码的描述也与漏洞描述一致，表明其具有较高的有效性。

**投毒风险：**
提供的 POC 代码库中的 `LISCENCE` 文件声明了严格的权限限制，这在一定程度上增加了投毒的可能性。虽然无法通过现有信息完全确定是否存在投毒代码，但需要对脚本进行仔细审查，特别注意以下几个方面：

*   **shellcode:**  分析 shellcode 的行为，确保其功能与漏洞利用目的相符，没有恶意行为。
*   **网络连接:**  检查代码中是否存在额外的网络连接，特别是连接到未知或可疑的 IP 地址。
*   **文件操作:**  检查代码中是否存在对系统文件的修改或删除操作。
*   **依赖项:**  审查 `requirements.txt` 文件中的依赖项，确保没有引入恶意的第三方库。

考虑到需要大量连接尝试和对堆的操纵，以及许可证的严格声明，综合评估投毒风险为10%。这部分代码逻辑比较复杂，存在隐藏恶意代码的可能性。

**利用方式：**
1.  攻击者通过网络向目标 OpenSSH 服务器发起大量的连接请求。
2.  利用 OpenSSH 服务器处理连接请求时存在的竞争条件，特别是在信号处理方面。
3.  通过精心构造的数据包，将恶意代码注入到服务器的堆内存中。
4.  触发执行注入的恶意代码，从而获得对目标系统的控制权 (RCE) 或导致拒绝服务 (DoS)。
5.  默认的shellcode打开9999端口,并使用nc进行监听。

**项目地址:** [l-urk/CVE-2024-6387](https://github.com/l-urk/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #21

**来源**: [CVE-2024-6387-lflare_cve-2024-6387-poc.md](../2024/CVE-2024-6387-lflare_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是OpenSSH服务器(sshd)中的一个竞争条件漏洞，源于CVE-2006-5051的安全回归。当sshd在不安全的方式下处理某些信号时，未经验证的远程攻击者可能通过在设定的时间内未能成功验证身份来触发此漏洞。

**有效性评估：**
根据漏洞信息和搜索结果，此漏洞的PoC已经发布，并且被广泛讨论，证明了其有效性。PoC代码（`7etsuo-regreSSHion.c`）尝试利用此漏洞，通过以下步骤：

1.  **连接建立：** 与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH协议握手。
3.  **堆准备：** 准备堆布局以进行利用。
4.  **时间测量：** 测量数据包解析时间。
5.  **竞争条件尝试：** 尝试触发竞争条件，利用信号处理中的不安全函数调用，最终目标是执行shellcode，提权至root。
6.  **ASLR绕过：**尝试不同的glibc基地址，以绕过地址空间布局随机化(ASLR)。

代码中包含了尝试20000次利用的循环，以及100ms的延时，这些都符合漏洞分析文章的描述，增加了利用成功的可能性。

**投毒风险评估：**

此PoC代码存在一定程度的投毒风险，因为:

1.  **Shellcode:** PoC代码包含一个shellcode占位符，攻击者需要替换成真实的shellcode。如果提供的shellcode本身是恶意的，那么使用此PoC会导致投毒。
2. **glibc地址:** PoC代码包含glibc基址，攻击者需要手动调整为目标系统的基址。如果提供的基址不正确，或者根本无法确定正确的基址，会影响利用成功率。如果攻击者故意提供错误的基址或者使用错误的基址绕过策略，也有可能导致拒绝服务。
3.  **定时参数：** PoC代码中的定时参数需要根据目标系统的响应速度进行调整。如果定时不当，可能导致利用失败，甚至使目标系统崩溃。
4.  **heap布局:** OpenSSH的堆布局会随着版本的变化而变化，需要针对不同的版本进行调整。如果不调整，可能无法成功利用。

**评估：**
PoC代码的编写者可能在代码中加入不易察觉的恶意行为，例如收集目标系统信息并发送到远程服务器等。但是，考虑到PoC的主要目的是为了验证漏洞，因此这种风险相对较低。PoC中已经存在大量的需要修改的地方，需要使用者有一定的漏洞知识储备，因此投毒风险相对较低。

**综合评估**：PoC中投毒风险预估为10%，

**利用方式总结：**

1.  攻击者首先需要与目标OpenSSH服务器建立连接。
2.  然后，攻击者需要执行SSH握手协议。
3.  接着，攻击者发送特制的数据包，触发sshd中的竞争条件。
4.  竞争条件允许攻击者覆盖内存中的关键数据结构。
5.  攻击者通过覆盖的数据结构，执行预先准备好的shellcode，从而获得目标系统的root权限。
6. 利用过程需要绕过ASLR保护，这可能需要多次尝试，或者使用其他信息泄露漏洞。
7. 攻击需要一定的timing， 把握好发送数据包的时间。

**项目地址:** [lflare/cve-2024-6387-poc](https://github.com/lflare/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #22

**来源**: [CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387是一个OpenSSH服务器(sshd)中的安全回归漏洞，存在于OpenSSH 8.5p1到9.7p1版本。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。远程攻击者可以通过在设定的时间内认证失败来触发此漏洞，可能导致远程代码执行或拒绝服务。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已确认存在，并且有POC代码可用。搜索引擎结果中的多个链接指向了漏洞分析、利用和修复方法，以及相关的讨论。

**投毒风险：**
提供的POC代码包含一个Python脚本（main.py）和一个README.md文件。脚本内容主要用于识别易受攻击的OpenSSH服务器，并无发现任何恶意代码或者后门，但是不排除后续增加投毒代码的可能性, 因此投毒风险极低。

**利用方式：**
1.  攻击者需要发起大量SSH连接到目标服务器。
2.  在LoginGraceTime时间内，故意使认证失败。
3.  利用竞争条件，使sshd以不安全的方式处理信号。
4.  如果成功，攻击者可能能够执行任意代码或导致服务崩溃（拒绝服务）。

**缓解措施：**
*   将OpenSSH升级到9.8或更高版本。
*   设置`LoginGraceTime 0`可以缓解RCE，但不能完全避免DoS攻击，建议结合`fail2ban`和防火墙使用。

**项目地址:** [moften/regreSSHion-CVE-2024-6387](https://github.com/moften/regreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #23

**来源**: [CVE-2024-6387-prelearn-code_CVE-2024-6387.md](../2024/CVE-2024-6387-prelearn-code_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 远程代码执行

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行

**影响应用:** OpenSSH

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (glibc-based Linux systems)

**利用条件:** 目标系统需要运行受影响版本的OpenSSH，且基于glibc。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，也被称为"regreSSHion"，是OpenSSH服务器（sshd）中的一个安全漏洞，是CVE-2006-5051的一个回归。它是由信号处理中的竞争条件引起的。未经身份验证的远程攻击者可以通过在设定的时间内未能成功进行身份验证来触发此漏洞，可能导致以root权限执行任意代码。该漏洞影响基于glibc的Linux系统上的OpenSSH 8.5p1到9.7p1版本。

**有效性：**
根据漏洞库信息、搜索结果（特别是来自Qualys和offsec的分析），以及POC代码的存在，可以判断该漏洞是有效的，并且存在可利用的POC。

**投毒风险：**
POC代码中存在一定的投毒风险。虽然代码的目的是利用该漏洞，但攻击者可能会修改shellcode以进行恶意活动，或者在代码中加入额外的后门。例如，`shellcode`变量中包含占位符，需要替换为实际的shellcode。如果用户从不可信来源下载POC，并使用了包含恶意shellcode的POC，则可能存在投毒风险。代码中定义了多个glibc地址用于绕过ASLR，攻击者可以伪造错误的地址，来扰乱攻击。

**利用方式：**
利用方式涉及以下几个步骤：

1.  **建立连接：** 攻击者首先与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH握手过程，包括版本交换和密钥交换的初始化。
3.  **堆准备：** 发送特定的SSH数据包，以在sshd进程的堆上创建特定的内存布局，为利用创造条件。
4.  **触发竞争条件：** 攻击者触发一个竞争条件，该条件涉及OpenSSH处理信号的方式，利用SIGALRM信号处理程序中的不安全函数调用。
5.  **地址绕过：** 通过尝试多个可能的glibc基址，绕过地址空间布局随机化 (ASLR)。
6.  **执行代码：** 成功触发竞争条件后，将恶意shellcode注入到内存中并执行，从而获得远程代码执行权限（通常以root权限）。

**缓解措施包括：**
*   禁用`LoginGraceTime`参数，虽然不能完全阻止DoS，但可以防御RCE。
*   使用`fail2ban`等工具监控日志文件并管理连接。
*   及时更新到OpenSSH的修复版本。

**项目地址:** [prelearn-code/CVE-2024-6387](https://github.com/prelearn-code/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #24

**来源**: [CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md](../2024/CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，glibc-based Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387是一个OpenSSH服务器中的竞争条件漏洞（源于CVE-2006-5051的回归）。未经身份验证的远程攻击者可以通过在设定的时间内未能完成身份验证来触发此漏洞。利用方式是发送大量连接请求，触发竞争条件，在glibc-based Linux系统上可能导致在堆中插入恶意指令，最终实现远程代码执行或拒绝服务。提供的脚本并非POC，而是缓解措施：

1.  **有效性：** 提供的脚本实际上是一个缓解脚本，通过将`LoginGraceTime`设置为0来减少漏洞被利用的可能性，并不能直接验证漏洞，缓解脚本会禁用SSHD服务器在指定超时时间内未完成身份验证时断开连接的能力。虽然降低了RCE的风险，但增加了拒绝服务(DoS)的风险。

2.  **投毒风险：** 提供的脚本目的是缓解漏洞，没有发现任何隐藏的恶意代码，因此投毒风险为0%。

3.  **利用方式：** 根据漏洞信息和搜索结果，利用方式是未认证的攻击者向目标OpenSSH服务器发送大量连接请求，由于竞争条件的存在，sshd可能以不安全的方式处理信号，从而允许攻击者执行任意代码（RCE）或造成拒绝服务(DoS)。攻击成功的关键在于触发竞争条件，因此需要大量的并发连接尝试。


**项目地址:** [redux-sibi-jose/mitigate_ssh](https://github.com/redux-sibi-jose/mitigate_ssh)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #25

**来源**: [CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md](../2024/CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，并且攻击者能够建立SSH连接并触发竞争条件。攻击者需要尝试大量连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全漏洞，源于信号处理中的竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：** 根据漏洞库信息和搜索结果，此漏洞存在PoC。该漏洞的利用依赖于触发竞争条件，因此需要进行大量的连接尝试。

**投毒风险：** 分析提供的PoC代码，主要包含一个检测脚本（detection-script.py）和一个README。检测脚本尝试建立到目标SSH服务器的连接，并发送SSH协议版本字符串，然后读取服务器的响应。LICENSE文件和README.md文件是标准格式，描述了漏洞信息。由于检测脚本本身较为简单，且没有发现明显的恶意代码，因此投毒的风险较低，约为10%。 但是需要人工review所有代码.特别是二进制文件.

**利用方式：** 利用此漏洞需要：
1.  攻击者向目标服务器上的sshd服务发起大量的连接请求。
2.  在连接建立但身份验证尚未完成时，利用竞争条件触发信号处理错误。
3.  如果成功利用，攻击者可以在目标系统上执行任意代码，获得root权限（根据漏洞描述和搜索结果）。

利用的复杂性在于需要精确地控制时序，以触发竞争条件。这通常需要大量的计算资源和对目标系统行为的深入了解。同时该漏洞在glibc-based Linux systems更有效,可能无法在所有系统上利用。

**项目地址:** [s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH](https://github.com/s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #26

**来源**: [CVE-2024-6387-wiggels_regresshion-check.md](../2024/CVE-2024-6387-wiggels_regresshion-check.md)

# CVE-2024-6387

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-6387-AzrDll_CVE-2024-6387.md](../2024/CVE-2024-6387-AzrDll_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH 竞争条件导致 RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。需要发起大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务中的一个竞争条件漏洞，源于 CVE-2006-5051 的回归。未经身份验证的远程攻击者可以通过在短时间内发起大量失败的身份验证尝试来触发此漏洞。利用此漏洞需要在glibc堆中插入指令，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞确实存在，并且有公开的PoC利用代码。该PoC通过建立大量的 SSH 连接并进行不成功的身份验证来触发竞争条件。参考[webpage 3]，此漏洞允许glibc Linux发行版在堆中插入指令，从而实现代码执行。提供的PoC代码尝试利用这一点，但成功率可能较低，因为竞争条件需要精确的时间控制。

**投毒风险：**
提供的PoC代码`/tmp/fe03af2a23123389ff9785e2fb119f2c/PoC.py` 包含了从文件中读取glibc地址的功能。 虽然代码本身没有明显的恶意行为，但如果提供的 `glibc_file` 包含恶意构造的地址，可能会导致非预期的行为，甚至导致拒绝服务。例如，如果`glibc_base`地址指向了关键系统函数，覆盖该地址可能造成系统崩溃。另一个潜在的风险点是 `timing_adjustment`，如果调整不当可能造成DoS。综上所述，投毒风险为10%。主要是考虑到作者可能在利用代码的 `glibc_file` 参数中提供恶意的 glibc 地址，诱导用户使用，从而达到破坏目标系统的目的。

**利用方式：**
1.  **建立连接：** 攻击者首先建立与目标 OpenSSH 服务器的 TCP 连接。
2.  **SSH 握手：** 攻击者执行 SSH 握手过程，例如发送 SSH 版本字符串。
3.  **堆准备：** PoC尝试在堆上分配一些数据，为利用竞争条件做准备。
4.  **触发竞争条件：**  通过快速发送大量失败的身份验证请求，攻击者试图触发 `sshd` 进程中的竞争条件。这涉及利用 `LoginGraceTime` 参数，该参数允许攻击者在身份验证超时之前发送多个请求。根据[webpage 6]，利用此漏洞需要大量连接尝试才能准确触发竞争条件。
5.  **代码执行：**  如果竞争条件被成功触发，攻击者可以在内存中写入恶意代码，从而实现远程代码执行。提供的 PoC 代码尝试通过覆盖 glibc 的地址来实现这一点。如果成功利用，攻击者可以获得 root 权限，如[webpage 1][webpage 4]所描述。
6.  **拒绝服务：** 即使未能成功实现 RCE，攻击者也可能通过耗尽服务器资源来实现拒绝服务。由于竞争条件涉及信号处理，不正确的信号处理可能导致 `sshd` 崩溃。

**项目地址:** [AzrDll/CVE-2024-6387](https://github.com/AzrDll/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #2

**来源**: [CVE-2024-6387-DimaMend_cve-2024-6387-poc.md](../2024/CVE-2024-6387-DimaMend_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行(RCE)和拒绝服务(DoS)

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，并且目标系统基于glibc。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全漏洞，它是由CVE-2006-5051引入的回归错误。该漏洞是一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**利用方式：**

1.  **建立连接：** 攻击者首先与易受攻击的OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者尝试进行SSH握手，但故意不完成身份验证过程。这是为了触发`LoginGraceTime`超时。
3.  **堆准备：** 攻击者发送一系列SSH数据包，旨在操纵服务器的内存堆的布局。 这可能涉及到分配和释放内存，以便为利用创造合适的条件。
4.  **触发竞争条件：** 攻击者利用`LoginGraceTime`超时机制。当服务器由于握手超时而即将终止连接时，会发送一个信号。 攻击者尝试与此信号处理程序执行竞争，以修改服务器的内存。
5.  **代码执行：** 如果竞争成功，攻击者可以将恶意代码注入到服务器的内存中，并获得代码执行能力。 根据具体利用方式，这可能导致以root权限执行代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞的利用是可行的。许多信息源表明，存在公开可用的PoC，并且已经有人成功利用了此漏洞。 PoC代码的功能是尝试利用这个竞态条件。

**投毒风险分析：**

PoC代码中存在投毒代码的风险很低，原因如下：

*   **代码结构：** 代码主要集中于建立连接、进行SSH握手、操纵堆内存以及尝试触发竞态条件。虽然代码较为复杂，但在总体流程上没有明显的恶意操作。
*   **Shellcode占位符：** 代码中存在一个 `shellcode` 占位符，明确提示用户需要替换成实际的 shellcode。这表明作者的意图是提供一个框架，而不是一个直接可用的恶意载荷。
*   **注释和说明：** 代码包含大量的注释和说明，解释了漏洞的原理、利用方法以及需要调整的参数。这表明作者的目的是帮助研究人员理解和复现漏洞，而不是隐藏恶意代码。
*   **随机性和尝试次数：** 代码包含大量的随机尝试，目的是为了提高漏洞利用的成功率。这种随机性使得代码难以预测，也增加了作者插入恶意代码的难度。
*   **外部依赖：** 代码没有包含明显的外部依赖或网络请求，这降低了其被用于下载或执行恶意代码的风险。

虽然直接投毒的可能性较低，但仍然存在一些潜在风险，比如在 `shellcode` 占位符中插入恶意代码，或者在调整参数的过程中引入错误，导致程序行为异常。因此，在使用 PoC 代码时，仍然需要进行仔细的代码审查和安全测试。

综上所述，此仓库中存在作者隐藏的投毒代码的可能性估计为1%。

**项目地址:** [DimaMend/cve-2024-6387-poc](https://github.com/DimaMend/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #3

**来源**: [CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行存在漏洞版本的OpenSSH服务，且攻击者能够建立SSH连接，并在认证超时前发送恶意数据。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，存在于glibc的linux系统。它源于一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该漏洞是有效的。多个来源都确认了该漏洞的存在以及其远程代码执行的潜力。POC代码的存在进一步支持了其可利用性。

**投毒风险：**

POC代码本身包含以下潜在的投毒风险点：

*   **Shellcode占位符:** 代码中明确提到 `Shellcode placeholder (replace with actual shellcode)`。如果用户直接使用未经审查的 shellcode，则可能引入恶意行为。此处的风险不在于作者投毒，而在于用户使用不当。
*   **GLIBC_BASES:**  `GLIBC_BASES[]` 数组包含可能的 glibc 基地址。如果这个地址不准确，利用将失败。如果作者故意提供错误的地址，可能会导致拒绝服务或误导分析。
*   **Timing parameters:** 注释提到需要根据目标系统调整 timing 参数。错误的 timing 可能导致利用失败或系统不稳定。
*   **Heap layout 和 File structure offsets:**  代码注释中也强调了需要针对不同的 OpenSSH 和 glibc 版本进行调整，否则利用会失败。故意设置错误的值可能导致程序崩溃或产生其他未定义行为。
*   **随机数生成:** 代码使用 `srand(time(NULL))` 初始化随机数生成器。虽然这本身不是投毒，但如果后续利用中依赖于可预测的随机数，可能会被利用。

总体评估投毒风险为30%。风险主要来自于需要用户自行替换的shellcode，以及需要用户根据目标环境配置的参数。作者本身隐藏恶意代码的可能性较低，但用户在使用过程中存在引入风险的可能性。

**利用方式：**

1.  **建立连接：** 攻击者首先需要建立与目标 OpenSSH 服务器的连接。
2.  **SSH握手：** 进行初步的SSH握手过程，包括版本协商和密钥交换的初始化，但无需完成身份认证。
3.  **堆准备：**  `prepare_heap` 函数的目的是在堆上创建特定的布局，为后续的利用创造条件。具体实现细节未给出，但可能涉及分配和释放内存，以控制堆的状态。
4.  **时间测量：** `time_final_packet` 函数测量服务器处理特定数据包所需的时间。这个时间信息对于后续的竞争条件利用至关重要。
5.  **竞争条件：**  `attempt_race_condition` 函数尝试触发漏洞的核心：信号处理程序中的竞争条件。这通常涉及发送一个精心构造的数据包，该数据包会在服务器处理过程中触发 SIGALRM 信号。由于信号处理程序使用了异步信号不安全函数，因此可能导致堆损坏。
6.  **代码执行：**  如果竞争条件成功触发，攻击者就可以利用堆损坏来执行任意代码。这通常涉及覆盖函数指针或控制程序的执行流程。

该漏洞的利用依赖于精确的 timing 和对目标系统内存布局的了解。攻击者需要进行大量的尝试才能成功利用该漏洞。

**项目地址:** [HadesNull123/CVE-2024-6387_Check](https://github.com/HadesNull123/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #4

**来源**: [CVE-2024-6387-Karmakstylez_CVE-2024-6387.md](../2024/CVE-2024-6387-Karmakstylez_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器(sshd)中的一个安全回归漏洞，存在于glibc-based Linux系统。该漏洞源于信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。该漏洞利用代码尝试通过大量的连接请求触发竞争条件，通过调整glibc基地址和定时参数绕过ASLR，将恶意代码注入到堆中，最终实现以root权限远程代码执行。

有效性：根据漏洞信息和搜索结果，此POC代码具备一定的有效性，但成功利用需要满足特定条件，例如目标系统使用glibc，以及OpenSSH版本在受影响范围内。同时，漏洞利用的成功率受到系统负载、网络延迟等因素的影响，需要进行大量的尝试。

投毒风险：POC代码中存在一定的投毒风险。虽然POC代码的主要目的是利用已知的漏洞，但攻击者可能在代码中加入恶意功能，例如植入后门、收集敏感信息等。例如，shellcode 部分是明显的注入点。风险评定为10%，主要基于以下几点：
1.  **Shellcode 替换：** 代码明确指出 `shellcode` 变量是占位符，需要替换为实际的 shellcode。如果用户不小心使用了包含恶意指令的 shellcode，则可能导致投毒。
2.  **glibc 基地址猜测：** 虽然代码尝试多个 glibc 基地址，但如果攻击者预先知道目标系统的 glibc 地址，则可以修改 `GLIBC_BASES` 数组以提高利用成功率，同时也可能引入恶意地址。
3.  **Timing 参数调整：** 代码中的 `usleep` 函数用于控制连接尝试之间的延迟。攻击者可以通过调整这些参数来优化漏洞利用，但也可能引入导致拒绝服务 (DoS) 的参数。
4.  **编译选项：**POC 需要编译，攻击者可以在编译时添加额外的恶意编译选项，例如禁用安全特性等。
5.  **作者本身:** 仓库作者有投毒行为.

利用方式：
1.  攻击者首先需要确定目标系统是否运行受影响的OpenSSH版本，以及是否基于glibc。
2.  攻击者发起大量的SSH连接请求，尝试触发竞争条件。
3.  攻击者利用精心构造的数据包覆盖堆上的特定内存区域，将恶意代码注入到sshd进程中。
4.  一旦恶意代码成功执行，攻击者即可获得目标系统的控制权。

**项目地址:** [Karmakstylez/CVE-2024-6387](https://github.com/Karmakstylez/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #5

**来源**: [CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md](../2024/CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md)

## CVE-2024-6387-OpenSSH-RegreSSHion-RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行并获取 root 权限或造成拒绝服务

**影响版本:** <= 9.7p1 (受影响版本 8.5p1 至 9.7p1)

**利用条件:** 需要目标服务器运行受影响版本的OpenSSH，且存在时间窗口内的未认证连接尝试。高危利用场景依赖glibc环境。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-6387，也被称为“regreSSHion”，是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞（CVE-2006-5051）。该漏洞源于信号处理中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC已经存在，并且能够实现远程代码执行和拒绝服务攻击。很多安全厂商和研究人员都发布了相关的分析报告和PoC代码。

**投毒风险：**
提供的漏洞利用代码（/tmp/270e32ae67508359811c0f9899155269/README.md 和 LICENSE）仅仅是声明了存在POC，根据现有信息，该仓库本身存在恶意代码的风险较低。但是，由于POC的执行具有高危性，在实际使用中，仍需要进行安全审查。

**利用方式：**
1.  **竞争条件：** 攻击者通过在短时间内发起大量未认证的连接尝试，触发 `sshd` 中的竞争条件。
2.  **信号处理：** 在特定的时间窗口内，`sshd` 可能会以不安全的方式处理信号，导致内存损坏或其他异常行为。
3.  **远程代码执行/拒绝服务：**  利用内存损坏或其他异常行为，攻击者可以执行任意代码（RCE），或导致 `sshd` 崩溃，造成拒绝服务（DoS）。部分利用依赖特定的glibc环境。
4.  **ProxyCommand注入:** 根据github仓库的README.md描述，该POC利用了 `ProxyCommand` 配置不当或滥用的情况，攻击者可以注入恶意命令到 `ProxyCommand` 中，从而获得命令执行或者横向渗透的能力。

**缓解措施：**
*   升级到 OpenSSH 9.8 或更高版本。
*   设置 `LoginGraceTime 0` 以禁用在指定超时时间内未完成身份验证时服务器断开连接的功能（Red Hat 建议的临时缓解措施，但会使服务器更容易受到 DoS 攻击）。
*   使用 `fail2ban` 等工具，配合防火墙来监控日志文件并适当管理连接。

**项目地址:** [Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC](https://github.com/Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #6

**来源**: [CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md](../2024/CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）或拒绝服务（DoS）

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。它是一个竞争条件漏洞，可能导致sshd以不安全的方式处理信号。远程攻击者可以通过在设定的时间内未能成功验证身份来触发此漏洞，从而可能导致远程代码执行或拒绝服务。

**有效性评估：**

根据漏洞库信息、搜索结果以及提供的POC代码来看，此漏洞的POC是存在的，并且多个安全厂商都发布了相关的分析报告和检测方法。搜索结果也表明此漏洞允许远程未授权代码执行。

**利用方式：**

1.  攻击者建立与目标OpenSSH服务器的连接。
2.  进行SSH握手，获取服务器banner。
3.  准备堆，发送一定量的填充数据。
4.  尝试触发竞争条件，通过发送包含`glibc_base`地址的payload，并附加一些`nop`指令。
5.  如果成功，则在服务器上执行代码，获得root权限。
6.  脚本使用了多线程来增加攻击成功的几率，并对时序进行调整。

**投毒风险评估：**

提供的POC代码（`Exploit_2024_6387.py`）本身是一个漏洞利用脚本，其目的是利用目标系统的漏洞。评估投毒风险主要关注作者是否在脚本中植入了恶意代码，例如：

*   **后门代码：**  脚本在成功利用漏洞后，是否会创建一个后门，允许攻击者在未经授权的情况下再次访问系统。
*   **破坏性代码：**  脚本是否包含旨在破坏目标系统或数据的代码。
*   **信息窃取代码：**  脚本是否会窃取目标系统上的敏感信息。

分析代码发现，虽然脚本本身旨在利用漏洞，但并未发现明显的后门、破坏性或信息窃取代码。 然而，需要注意的是，该脚本的`TARGET_IP`和`TARGET_PORT`是硬编码的，在实际使用中需要进行修改。此外，攻击者可能会修改此脚本以包含恶意功能。此处的`glibc_base`地址也需要根据目标环境进行调整，否则利用大概率会失败，这也是成功利用此漏洞的难点之一。

综合来看，该仓库存在投毒风险的可能性较低，但是不排除有攻击者对代码进行修改后，二次传播。因此，建议在使用前仔细审查代码。

**风险评估：**
`poison`的百分比评估主要考虑以下几个方面：

*   **代码复杂性：** 代码越复杂，隐藏恶意代码的可能性越高。
*   **作者信誉：** 如果作者的信誉未知或可疑，则风险越高。
*   **代码审查：** 代码是否经过其他安全研究人员的审查。

根据以上分析，此脚本的`poison`风险评估为10%。

**项目地址:** [SkyGodling/CVE-2024-6387-POC](https://github.com/SkyGodling/CVE-2024-6387-POC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #7

**来源**: [CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md](../2024/CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，未认证的远程攻击者通过在设定的时间内认证失败触发

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞(CVE-2006-5051)。它存在一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，进而导致远程代码执行(RCE)或拒绝服务(DoS)。

根据搜索结果和漏洞信息，该漏洞影响glibc-based Linux系统，利用需要发起大量连接尝试来触发竞争条件。

提供的漏洞利用代码 `scanner.py` 是一个版本扫描器，并非直接利用 CVE-2024-6387。它用于检测目标 SSH 服务器的版本，并根据预定义的 CVE 列表判断是否存在已知的漏洞。该脚本通过创建 socket 连接到目标主机的 SSH 端口，然后发送一个空字节并接收服务器的响应，从中提取 OpenSSH 的版本信息。然后将提取的版本与易受攻击的版本列表进行比较。

**漏洞利用方式：**

1.  攻击者需要向目标 OpenSSH 服务器发起大量的连接请求。
2.  在连接建立后，故意触发认证失败，从而在信号处理过程中创建竞争条件。
3.  竞争条件允许攻击者在某些 glibc Linux 发行版中将指令插入堆中，进而实现远程代码执行。

**投毒风险：**

虽然脚本本身是一个版本扫描器，而不是直接的漏洞利用程序，但仍需谨慎评估其潜在的投毒风险。 代码中存在创建日志目录并记录扫描结果的行为，存在恶意修改扫描逻辑或在日志中写入恶意数据，但可能性极低。因此，评估投毒风险为1%。

**项目地址:** [ThatNotEasy/CVE-2024-6387](https://github.com/ThatNotEasy/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #8

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 远程代码执行/拒绝服务

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1，受影响版本包括8.5p1至9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且攻击者能够发起大量连接请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞，它源于 CVE-2006-5051。该漏洞是一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间段内未能通过身份验证来触发此漏洞。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的PoC代码是有效的。多个来源证实了该漏洞的存在和可利用性，特别是针对glibc的Linux系统。

**投毒风险：**

提供的PoC代码包含用于编译、构建和利用漏洞的Dockerfile和Python脚本。通过分析代码，可以发现以下潜在的投毒风险因素：

*   **依赖项：** Dockerfile中使用了`wget`和`curl`来下载OpenSSH源码，存在被中间人攻击替换为恶意源码的风险。尽管校验和可以降低这种风险，但如果攻击者能够控制构建环境，仍然可能引入恶意代码。
*   **shellcode：** Python脚本包含一个名为`shellcode`的变量，目前只是占位符，但攻击者可以修改此变量，插入恶意shellcode。攻击者可以精心构造shellcode，以执行恶意操作，例如安装后门、窃取数据或提权。

虽然这些风险存在，但从现有代码来看，没有发现明显的恶意代码。因此，评估投毒风险为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的OpenSSH环境（32位Linux系统）。
2.  **SSH握手：** 客户端与服务器建立连接，发送SSH版本信息并进行密钥交换（KEX）初始化。
3.  **堆准备：** 通过发送特定大小的数据包来布置堆内存，利用glibc的漏洞插入恶意指令。
4.  **触发竞争条件：** 大量连接尝试来触发信号处理程序中的竞争条件。
5.  **执行代码：** 成功触发竞争条件后，恶意代码将被执行，从而实现远程代码执行。

总体来说，利用方式较为复杂，需要精心构造数据包和进行大量的连接尝试才能成功。

**项目地址:** [YassDEV221608/CVE-2024-6387](https://github.com/YassDEV221608/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #9

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 9.7p1 (影响 8.5p1 到 9.7p1)

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，并且是基于glibc的Linux系统。攻击者需要能够建立到SSH服务的网络连接，并能够快速发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中发现的一个安全回归漏洞，存在于glibc的Linux系统中。该漏洞是由于OpenSSH服务器（sshd）中的信号处理存在竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用此漏洞可能导致以 root 身份远程执行代码。

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果也确认了该漏洞的存在，并描述了其可能导致远程代码执行的风险。漏洞利用代码的存在也进一步证实了漏洞的有效性，代码尝试利用竞争条件来执行任意代码。

**投毒风险：**
代码存在一定的投毒风险的可能性。虽然代码本身看起来是在尝试利用该漏洞，但以下因素需要考虑：

1.  **Shellcode占位符：** 代码中包含一个shellcode占位符`unsigned char shellcode[] = "\x90\x90\x90\x90";`，明确指示需要替换成实际的shellcode。如果用户没有意识到这一点，或者使用了恶意shellcode，可能会造成损害。这里的投毒风险在于，攻击者可能发布包含恶意shellcode的exp，诱导用户使用。 
2.  **GLIBC_BASES：** 代码中定义了`GLIBC_BASES[]`，用于绕过ASLR。如果这些地址不正确，利用将失败。更糟糕的是，如果攻击者故意提供错误的地址，可能会导致程序崩溃或其他不可预测的行为。
3.  **Timing parameters和 Heap layout 需要调整：** 代码注释中强调了定时参数和堆布局需要根据目标系统进行调整。如果这些参数设置不正确，可能会导致利用失败或目标系统不稳定。
4.  **文件结构偏移量：** 代码提到需要验证特定glibc版本的文件结构偏移量。使用错误的偏移量可能导致内存损坏或其他不可预测的行为。

总体来看，该POC的复杂性和对系统内部结构的依赖性，投毒者可以通过提供不正确的配置参数，或者引导用户使用错误的shellcode，达到破坏目标系统的目的。因此存在10%的投毒风险。

**利用方式：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **建立连接：** 攻击者首先需要与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者需要完成初始的SSH握手过程，包括协议版本交换和密钥交换初始化（KEX）。
3.  **堆准备：** 攻击者利用SSH协议发送数据包，在内存堆上布置精心构造的数据结构，为后续的漏洞利用做准备。
4.  **触发竞争条件：** 攻击者发送一个特制的SSH数据包，该数据包的设计是为了触发sshd中的竞争条件。具体来说，它利用了在身份验证失败的情况下，信号处理程序中的不安全操作。
5.  **RCE：** 成功触发竞争条件后，攻击者可以将恶意代码注入到sshd进程中，从而实现远程代码执行。具体是通过内存操作覆盖某个函数指针，使其指向攻击者提供的shellcode。
6.  **提权（Root）：** 由于sshd通常以root权限运行，因此攻击者执行的shellcode也将以root权限运行，从而完全控制目标系统。

**项目地址:** [YassDEV221608/CVE-2024-6387_PoC](https://github.com/YassDEV221608/CVE-2024-6387_PoC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #10

**来源**: [CVE-2024-6387-alex14324_ssh_poc2024.md](../2024/CVE-2024-6387-alex14324_ssh_poc2024.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）和拒绝服务（DoS）

**影响版本:** <= 9.7p1

**利用条件:** 需要目标系统开启sshd服务，且受影响的OpenSSH版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是一个存在于OpenSSH服务器（sshd）中的安全漏洞，具体来说是一个竞争条件漏洞。该漏洞源于OpenSSH处理信号的方式。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，导致sshd以不安全的方式处理信号。这可能导致远程代码执行（RCE），攻击者获得root权限，或拒绝服务（DoS），使服务器不可用。

**有效性分析：**
从漏洞库信息、搜索结果和提供的PoC代码来看，该漏洞的PoC是存在的，并且被广泛讨论和利用。 搜索结果中提到“regreSSHion (CVE-2024-6387) is an unauthenticated RCE vulnerability in OpenSSH’s server, affecting glibc-based Linux systems. Full root access is granted.” 表明该漏洞有很高的潜在影响. PoC代码也试图绕过ASLR，并包含shellcode的占位符，表明攻击者可以注入恶意代码。

**投毒风险分析：**
提供的PoC代码具有一定的投毒风险，大约为10%。主要基于以下几点：
1.  **Shellcode占位符：** 代码中包含`unsigned char shellcode[] = "\x90\x90\x90\x90";`。虽然这只是一个占位符，需要用户替换为实际的shellcode，但攻击者可能发布包含恶意shellcode的版本，诱导用户使用。
2.  **GLIBC_BASES地址：**  代码中包含了`uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`。这些地址是ASLR绕过的尝试，但如果攻击者故意提供错误的地址，可能导致利用失败或者其他未知的行为，但一般不会产生特别大的危害。
3.  **Timing参数：** 代码中需要根据目标系统响应调整Timing参数。攻击者可能提供不合适的参数，导致利用不稳定或者失败。
4.  **Heap Layout和文件结构偏移：**  代码注释中提到“Heap layout : Requires tweaking for different OpenSSH versions.” 和 “File structure offsets: Verify for the specific glibc version.”。攻击者可能故意提供错误的值，导致利用失败或者产生其他问题。

**利用方式：**
1.  **建立连接：** 攻击者首先需要与目标服务器的sshd服务建立TCP连接。
2.  **SSH握手：** 进行SSH握手，包括版本交换、密钥交换等步骤。PoC代码中的 `perform_ssh_handshake` 函数实现了这些步骤。
3.  **堆准备：** 通过发送特定的SSH数据包，在sshd进程的堆上分配内存，并控制堆的布局。`prepare_heap` 函数用于执行此操作。
4.  **时间计算：**  计算处理最终数据包所需的时间，用于后续的竞争条件利用。`time_final_packet` 函数用于执行此操作。
5.  **竞争条件利用：**  通过大量并发连接，触发sshd中的竞争条件漏洞。攻击者不断尝试进行身份验证，但故意失败，以触发SIGALRM信号处理程序。由于信号处理程序中使用了非异步信号安全的函数，可能导致内存损坏和代码执行。`attempt_race_condition` 函数用于执行此操作。
6.  **ASLR绕过：**  由于地址空间布局随机化（ASLR）的存在，攻击者需要知道glibc的基地址。PoC代码中包含了一组可能的基地址，并尝试逐个利用。
7.  **代码注入：** 成功利用竞争条件后，攻击者可以将恶意代码（shellcode）注入到sshd进程的内存中。占位符需要替换。
8.  **代码执行：**  执行注入的shellcode，从而获得服务器的root权限。

**项目地址:** [alex14324/ssh_poc2024](https://github.com/alex14324/ssh_poc2024)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #11

**来源**: [CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md](../2024/CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH服务，并允许未授权的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)。

**有效性:**
根据搜索结果和漏洞库信息，此漏洞的PoC是存在的，并且已经被公开。多个来源证实了该漏洞的存在，以及它可能导致远程代码执行。提供的“漏洞利用代码”实际上是一个缓解脚本，旨在通过升级OpenSSH版本或禁用LoginGraceTime来降低风险，而不是一个实际的利用程序。

**投毒风险:**
提供的脚本主要功能是检测并修复漏洞，但仍然存在一定的投毒风险：
*   **依赖外部源：** 脚本使用`apt-get update`和`apt-get install`命令，依赖外部软件源。如果软件源被恶意篡改，可能导致安装恶意软件包。
*   **配置修改：** 脚本会修改`/etc/ssh/sshd_config`文件，存在被恶意利用修改配置的风险。
*   **权限提升：** 脚本需要root权限运行，如果脚本被篡改，可能导致提权攻击。
综合考虑，该脚本存在一定的投毒风险，但主要风险在于依赖的外部源和配置修改，因此投毒风险评估为10%。

**利用方式:**
此漏洞的利用方式是利用 sshd 进程处理信号时的竞争条件。攻击者需要发起大量连接尝试，并在身份验证失败时触发竞争条件。成功触发后，攻击者能够在目标系统上执行任意代码。根据 offsec.com 的博客文章，此漏洞利用机会在某些 glibc Linux 发行版中，能将指令插入堆中。

**项目地址:** [almogopp/OpenSSH-CVE-2024-6387-Fix](https://github.com/almogopp/OpenSSH-CVE-2024-6387-Fix)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #12

**来源**: [CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md](../2024/CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许未授权网络访问SSH端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387 (regreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的安全回归漏洞，源于 CVE-2006-5051。这是一个竞争条件漏洞，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内身份验证失败来触发此漏洞。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经公开。多个安全厂商和研究人员已经发布了关于此漏洞的分析和PoC代码。

**投毒风险分析：**

提供的Checker.py脚本的主要功能是检测目标SSH服务器是否存在CVE-2024-6387漏洞。它通过连接到目标服务器的SSH端口并获取SSH banner信息，然后将其与已知易受攻击和已修补的版本进行比较来确定漏洞状态。 代码中没有发现任何明显的恶意或后门代码。

投毒风险评估：0%。该脚本主要用于漏洞检测，不包含任何主动利用漏洞的代码，也没有发现作者隐藏的恶意代码。

**利用方式分析：**

1.  **漏洞原理：** 漏洞是由于 OpenSSH 在处理信号时存在竞争条件，允许在身份验证失败期间执行恶意代码。
2.  **攻击步骤：** 攻击者需要向目标服务器发起大量的SSH连接尝试。
3.  **触发条件：** 在连接尝试期间，攻击者故意使身份验证失败，触发竞争条件。
4.  **利用结果：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码，以root权限运行，或者造成拒绝服务攻击。
5.  **缓解措施：** 通过设置 `LoginGraceTime 0` 禁用 `LoginGraceTime` 参数可以缓解远程代码执行的风险，但仍然存在拒绝服务的风险。更新到OpenSSH 9.8或更高版本是完整的修复方案。

**项目地址:** [anhvutuan/CVE-2024-6387-poc-1](https://github.com/anhvutuan/CVE-2024-6387-poc-1)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #13

**来源**: [CVE-2024-6387-awusan125_test_for6387.md](../2024/CVE-2024-6387-awusan125_test_for6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要目标系统基于 glibc，且 OpenSSH 版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理程序中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用可能允许攻击者在目标系统上以 root 权限执行任意代码或导致拒绝服务。

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞的 PoC 已被公开，并且漏洞利用的复杂性较高。搜索结果表明，该漏洞影响 glibc 基础的 Linux 系统。提供的 POC 代码似乎旨在利用此漏洞。

**投毒风险分析：**
该 POC 代码中存在一定的投毒风险，大约 20%。原因如下：
*   **Shellcode 占位符:** 代码中包含 `unsigned char shellcode[] = "\x90\x90\x90\x90";` 这一行，明确指出需要替换为实际的 shellcode。如果用户不小心使用了该占位符，或者植入了其他有害 shellcode，则可能导致不可预期的后果。
*   **GLIBC 基地址硬编码:** 代码中定义了 `uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`，并表示 “Needs adjustment for specific target systems”。如果 GLIBC 基地址不正确，可能导致利用失败，甚至造成程序崩溃。攻击者可能会故意提供错误的基地址，使得用户在尝试利用时受到干扰，或者执行其他恶意操作。
*   **Timing 参数需要微调:** 代码注释中提到 “Timing parameters: Fine-tune based on target system responsiveness”。如果 timing 参数设置不当，可能导致竞争条件无法触发，或者引发其他问题。攻击者可能会提供误导性的 timing 参数，使得用户在尝试利用时遇到困难，或者触发非预期的行为。
*   **Heap 布局和文件结构偏移量:** 代码注释提到 “Heap layout : Requires tweaking for different OpenSSH versions” 和 “File structure offsets: Verify for the specific glibc version.” 这表示该漏洞利用依赖于特定的堆布局和文件结构偏移量。如果这些值不正确，则可能导致利用失败，甚至造成程序崩溃。攻击者可能会提供不兼容的值，使得用户在尝试利用时受到干扰，或者触发非预期的行为。
*   **错误处理不完善:** 代码中虽然包含了一些错误处理逻辑，但可能存在未处理的异常情况。攻击者可能会利用这些漏洞，使得程序在特定条件下崩溃或执行非预期的操作。

**利用方式：**
利用方式主要涉及以下步骤：
1.  **建立连接：** 与目标 SSH 服务器建立 TCP 连接。
2.  **SSH 握手：** 执行 SSH 握手过程，包括版本交换和密钥交换。
3.  **堆准备：** 通过发送特定的数据包，在堆上创建特定的布局。
4.  **时间控制：** 精确控制数据包的发送时间，以便触发竞争条件。
5.  **竞争条件触发：** 通过大量连接尝试和认证失败，利用信号处理程序的竞争条件在内存中注入恶意代码，通常包括修改 glibc 的数据结构。
6.  **代码执行：** 利用注入的恶意代码来执行任意命令。
7.  **绕过 ASLR：** 由于地址空间布局随机化 (ASLR) 的存在，需要确定 glibc 的基地址。PoC 代码中尝试了几个常见的基地址。

总体而言，该漏洞利用较为复杂，需要对 SSH 协议、glibc 内部机制和竞争条件有深入的了解。该漏洞的成功利用还依赖于目标系统的特定配置和状态。

**项目地址:** [awusan125/test_for6387](https://github.com/awusan125/test_for6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #14

**来源**: [CVE-2024-6387-dream434_CVE-2024-6387.md](../2024/CVE-2024-6387-dream434_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，目标系统运行受影响的OpenSSH版本，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性评估：**

根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已经被广泛讨论。漏洞利用代码的脚本主要用于检测目标主机是否运行存在漏洞的OpenSSH版本，利用方式是扫描目标IP的22端口，获取OpenSSH版本信息，并与已知的易受攻击版本进行比较，从而判断目标系统是否存在漏洞。

**投毒风险分析：**

提供的漏洞利用代码（CVE-2024-6387.py）主要用于版本检测，功能相对简单。虽然`README.md`中包含克隆GitHub仓库的操作，但直接分析提供的Python脚本，发现潜在的投毒点在于以下几个方面：

1.  **依赖包风险：** 脚本本身依赖较少，但如果`README.md`引导用户安装额外的依赖包（例如通过`pip install -r requirements.txt`，而`requirements.txt`包含恶意包），则可能存在投毒风险。
2.  **命令执行风险：** `README.md` 中的运行命令 `python CVE-2024-6387.py http://exemple.com` 虽然看起来无害，但如果 `CVE-2024-6387.py` 存在漏洞，允许通过命令行参数执行恶意代码，则存在风险。当前提供的代码没有直接利用命令行参数执行代码的逻辑。
3.  **文件包含风险：** 如果脚本尝试动态加载其他文件（例如配置文件），而这些文件被篡改，则可能存在风险。

鉴于以上分析，以及`README.md`中存在引导用户克隆github仓库的操作，综合判断，存在较低的投毒风险，约为10%。主要基于假设恶意代码可能存在于被克隆仓库的其他文件中，或者存在利用脚本漏洞执行恶意代码的可能。

**漏洞利用方式：**

1.  **版本检测：** 攻击者首先需要确定目标系统上运行的OpenSSH版本是否在受影响的范围内（8.5p1 <= version <= 9.7p1）。
2.  **触发竞争条件：** 攻击者通过与目标SSH服务器建立连接，并在身份验证过程中故意失败，以触发漏洞相关的竞争条件。
3.  **代码执行：** 成功触发竞争条件后，攻击者可以利用该漏洞在目标系统上执行任意代码，通常以root权限执行。

搜索结果也表明，此漏洞允许未经身份验证的远程代码执行，并且影响基于glibc的Linux系统。因此，利用方式的核心在于触发竞争条件并利用glibc的特性来执行恶意代码。

**项目地址:** [dream434/CVE-2024-6387](https://github.com/dream434/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #15

**来源**: [CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标主机开启SSH服务，且攻击者能够发起大量连接尝试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是一个OpenSSH服务器中的竞争条件漏洞。它源于OpenSSH处理信号的方式，当SSH服务器在短时间内收到大量连接请求且认证失败时，可能导致信号处理不当，进而允许未经验证的远程攻击者在基于glibc的Linux系统上执行任意代码，获取root权限，或者导致拒绝服务。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC已发布，表明漏洞可被利用。提供的Python脚本`CVE-2024-6387-Vulnerability-Checker.py`是一个漏洞检测工具，通过检查SSH banner版本来判断目标是否存在漏洞。脚本本身并不能直接利用该漏洞进行RCE或DoS攻击，而是用来辅助确认目标系统是否在受影响的范围内。

**投毒风险：**
该Python脚本主要功能是检查OpenSSH版本，判断其是否在受影响的范围内。代码本身只包含版本检测逻辑，没有发现任何恶意代码或后门，因此投毒风险极低。可以认为投毒风险为0%。

**利用方式：**
1.  **版本检测：** 使用PoC脚本或类似工具检测目标SSH服务器的版本，确认其是否位于易受攻击的范围(8.5p1 <= OpenSSH <= 9.7p1)。
2.  **触发竞争条件：** 如果目标版本易受攻击，攻击者需要发起大量连接尝试，并在短时间内故意认证失败，以触发竞争条件。
3.  **代码执行（或DoS）：** 成功触发竞争条件后，利用glibc的堆操作特性，攻击者可以插入恶意指令到堆中，从而实现远程代码执行。另一种利用方式是耗尽服务器资源，造成拒绝服务攻击。

需要注意的是，利用此漏洞进行RCE需要对glibc堆操作有一定的了解，并且成功率可能不高。缓解措施包括禁用`LoginGraceTime`配置，并使用`fail2ban`等工具限制恶意连接。

**项目地址:** [filipi86/CVE-2024-6387-Vulnerability-Checker](https://github.com/filipi86/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #16

**来源**: [CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-regreSSHion

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1 (OpenSSH)

**利用条件:** 需要glibc-based Linux系统，以及OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞。漏洞源于OpenSSH服务器处理信号的方式存在问题，具体来说，当用户认证失败时，可能触发不安全的信号处理。远程攻击者可以通过在短时间内发起大量SSH连接尝试，并故意触发认证失败，从而引发竞争条件，最终可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据搜索结果（webpage 1, 3, 4, 5, 7, 8）和漏洞库信息，该漏洞已被确认为一个高危漏洞，并且存在公开的PoC（Proof of Concept）代码。虽然提供的POC代码只是一个包含漏洞描述的README.md文件，**不能直接运行，但是，github上存在可利用的POC**。该POC的有效性取决于目标系统是否满足漏洞利用的条件，即：
1.  使用受影响的OpenSSH版本（<= 9.7p1）。
2.  目标系统是基于glibc的Linux发行版。
3.  系统配置允许一定数量的并发连接。

**投毒风险：**
提供的POC代码（README.md）本身不包含任何可执行代码，因此直接的投毒风险很低。但需要注意的是，任何从互联网上下载的代码都存在潜在的风险。即使是看似无害的文档，也可能包含恶意链接或指令，引导用户下载或执行恶意代码。因此，下载和使用任何PoC代码时，都应该保持警惕，并进行充分的安全审查。

虽然提供的README.md文件本身投毒风险较低,但是考虑到实际利用中需要依赖其他EXP, 因此其他仓库被投毒的可能性相对较高。
风险评估：10%

**利用方式：**
根据漏洞描述和搜索结果，利用方式主要包括以下几个步骤：
1.  **大量连接请求：** 攻击者向目标OpenSSH服务器发起大量的并发连接请求。
2.  **触发认证失败：**  在连接请求中，故意提供错误的用户名或密码，触发认证失败事件。
3.  **竞争条件利用：**  通过大量认证失败事件，触发OpenSSH服务器中的竞争条件漏洞。
4.  **代码执行或DoS：** 成功利用漏洞后，攻击者可以执行任意代码（RCE）或导致服务器崩溃（DoS）。

需要注意的是，利用该漏洞需要一定的资源和技术，并且成功率可能不高。Red Hat 在其安全公告中指出，实现RCE需要相当多的资源投入。同时，修改sshd_config,设置LoginGraceTime为0可以有效避免远程代码执行，但仍存在拒绝服务风险.

**项目地址:** [identity-threat-labs/Article-RegreSSHion-CVE-2024-6387](https://github.com/identity-threat-labs/Article-RegreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #17

**来源**: [CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，sshd服务运行且存在于受影响版本范围内，目标系统是基于glibc的Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中发现的竞争条件漏洞。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发该漏洞。成功利用可能导致以root权限远程执行代码或拒绝服务。该漏洞的利用依赖于触发信号处理程序的竞争条件，攻击者需要发起大量连接尝试才能提高触发漏洞的几率。提供的PoC代码是一个漏洞验证工具，用于检测目标系统上运行的OpenSSH版本是否存在漏洞。它通过连接到目标SSH端口并检查SSH横幅来工作。如果横幅指示易受攻击的版本，则该工具会将目标标记为易受攻击。PoC代码本身似乎不包含任何明显的投毒代码。它仅仅用于验证漏洞是否存在，并不会主动进行利用。

**利用方式：**

1.  攻击者向目标服务器的SSH端口发起大量连接请求。
2.  连接请求需要故意失败，例如提供无效的用户名或密码，以便触发身份验证失败流程。
3.  攻击者利用OpenSSH处理信号时的竞争条件，将恶意指令插入堆中。
4.  如果竞争条件利用成功，攻击者即可在目标系统上以root权限执行任意代码或导致拒绝服务。

**项目地址:** [identity-threat-labs/CVE-2024-6387-Vulnerability-Checker](https://github.com/identity-threat-labs/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #18

**来源**: [CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md](../2024/CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统使用受影响的OpenSSH版本，基于glibc的Linux系统，且未禁用LoginGraceTime

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是一个存在于OpenSSH服务器(sshd)中的竞争条件漏洞。该漏洞源于OpenSSH在处理信号时存在不安全行为。远程攻击者通过在一定时间内认证失败，可以触发此漏洞，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**漏洞利用方式：**

1.  攻击者向目标服务器发起大量的SSH连接请求。
2.  在SSH认证过程中，攻击者故意使认证失败，触发LoginGraceTime超时。
3.  由于竞争条件，sshd可能在处理SIGALRM信号时进入不安全状态。
4.  在glibc-based的Linux系统上，这种不安全状态可能允许攻击者将指令插入到堆中，最终导致RCE。
5.  如果无法实现RCE，攻击者可以通过耗尽服务器资源，导致DoS。

**POC代码分析：**

提供的PoC代码`/tmp/d7c5471d195cdec17d8f4ebaf7516058/CVE-2024-6387_poc.py`的主要功能是检测目标SSH服务器的版本，判断其是否受CVE-2024-6387漏洞影响。它通过建立socket连接，发送`\x00`，接收SSH版本信息，并进行正则匹配来确定OpenSSH的版本。如果版本在易受攻击的范围内（8.5 <= 版本 < 9.8）,则输出目标系统可能存在漏洞。该PoC本身**不包含直接利用漏洞的代码**，仅仅用于版本检测。

`/tmp/d7c5471d195cdec17d8f4ebaf7516058/README.md` 提供了一个使用说明，介绍了如何使用该PoC。`/tmp/d7c5471d195cdec17d8f4ebaf7516058/ip-addr.list`包含需要检查的IP地址列表, 127.0.0.1是示例.

**有效性：**

提供的POC代码的**有效性在于验证目标系统是否存在漏洞**，而非直接利用该漏洞。根据搜索结果和漏洞描述，完整的漏洞利用需要更复杂的步骤和技术，例如大量连接尝试来触发竞争条件，以及精心构造的shellcode。因此，此PoC仅仅是前期验证步骤。

**投毒风险：**

该仓库中存在**投毒风险的可能性较低，约为10%**。PoC代码主要功能是版本检测，本身没有发现恶意代码。潜在的风险可能存在于：

*   `ip-addr.list`文件：虽然当前提供的`ip-addr.list`文件只包含本地地址`127.0.0.1`, 如果用户不小心使用了作者预先设定的其他IP地址列表，可能会导致未授权的扫描或攻击行为。
*   `session.log`文件：虽然日志记录本身不是恶意行为，但如果日志文件被上传或泄露，可能暴露用户的扫描目标信息。日志信息包含IP和端口信息。
*   在实际利用该漏洞时，如果攻击者使用了恶意的Payload，可能会对目标系统造成更大的危害。这些Payload可能被伪装成无害的代码，从而绕过安全检测。
*   如果作者在其他未公开的分支或版本中包含了恶意代码，并且诱导用户使用这些版本，则存在更高的投毒风险。

**综上所述，**虽然提供的PoC代码本身不包含明显的恶意代码，但用户在使用时仍然需要保持警惕，仔细审查代码，并确保从可信的来源获取代码，避免潜在的投毒风险。

**项目地址:** [jocker2410/CVE-2024-6387_poc](https://github.com/jocker2410/CVE-2024-6387_poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #19

**来源**: [CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：**

从搜索结果和漏洞库信息来看，该漏洞存在可利用的POC。提供的Rust代码是一个漏洞检查器，它通过连接到SSH服务器并读取SSH banner来判断目标服务器是否运行着存在漏洞的OpenSSH版本。

**投毒风险：**

提供的代码是一个漏洞检测工具，用于检查目标系统是否存在CVE-2024-6387漏洞。代码功能相对清晰，主要包括：

*   定义了易受攻击和已修补的版本列表。
*   通过TCP连接获取SSH banner。
*   将获取的banner与已知易受攻击的版本进行比较。

代码中没有发现恶意行为，例如执行系统命令或上传/下载文件。因此，**投毒风险较低，判断为0%**。

**利用方式：**

根据漏洞信息和搜索结果，攻击者需要发起大量的连接尝试，以触发sshd中的竞争条件。成功利用该漏洞可能允许攻击者在目标系统上执行任意代码或导致拒绝服务。Offsec的博客提供了关于如何利用该漏洞的更详细的解释。

**总结：**

CVE-2024-6387是一个严重的安全漏洞，允许未经身份验证的攻击者远程执行代码。虽然利用该漏洞需要一定的资源和技术，但由于存在公开的POC，因此建议尽快更新OpenSSH版本。

**项目地址:** [kubota/CVE-2024-6387-Vulnerability-Checker](https://github.com/kubota/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #20

**来源**: [CVE-2024-6387-l-urk_CVE-2024-6387.md](../2024/CVE-2024-6387-l-urk_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH regreSSHion 远程代码执行漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** OpenSSH

**危害等级:** 高危，未授权的远程攻击者可以利用此漏洞以 root 权限执行任意代码，或者造成拒绝服务。

**影响版本:** 8.5p1 ~ 9.7p1

**利用条件:** 目标系统使用受影响的 OpenSSH 版本, 并且基于 glibc 的 Linux 系统。需要网络连通性, 且攻击者需要能够发起大量的 SSH 连接尝试。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，又名 regreSSHion，是 OpenSSH 服务器中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件漏洞，允许未经身份验证的远程攻击者在基于 glibc 的 Linux 系统上执行任意代码。漏洞的利用方式涉及发起大量的 SSH 连接尝试，触发 sshd 进程中的竞争条件，从而允许攻击者将指令插入堆中，最终实现 RCE。

**有效性：**
从搜索结果和漏洞库信息来看，此漏洞是真实存在的，并且存在公开可用的 PoC 代码。PoC 代码的描述也与漏洞描述一致，表明其具有较高的有效性。

**投毒风险：**
提供的 POC 代码库中的 `LISCENCE` 文件声明了严格的权限限制，这在一定程度上增加了投毒的可能性。虽然无法通过现有信息完全确定是否存在投毒代码，但需要对脚本进行仔细审查，特别注意以下几个方面：

*   **shellcode:**  分析 shellcode 的行为，确保其功能与漏洞利用目的相符，没有恶意行为。
*   **网络连接:**  检查代码中是否存在额外的网络连接，特别是连接到未知或可疑的 IP 地址。
*   **文件操作:**  检查代码中是否存在对系统文件的修改或删除操作。
*   **依赖项:**  审查 `requirements.txt` 文件中的依赖项，确保没有引入恶意的第三方库。

考虑到需要大量连接尝试和对堆的操纵，以及许可证的严格声明，综合评估投毒风险为10%。这部分代码逻辑比较复杂，存在隐藏恶意代码的可能性。

**利用方式：**
1.  攻击者通过网络向目标 OpenSSH 服务器发起大量的连接请求。
2.  利用 OpenSSH 服务器处理连接请求时存在的竞争条件，特别是在信号处理方面。
3.  通过精心构造的数据包，将恶意代码注入到服务器的堆内存中。
4.  触发执行注入的恶意代码，从而获得对目标系统的控制权 (RCE) 或导致拒绝服务 (DoS)。
5.  默认的shellcode打开9999端口,并使用nc进行监听。

**项目地址:** [l-urk/CVE-2024-6387](https://github.com/l-urk/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #21

**来源**: [CVE-2024-6387-lflare_cve-2024-6387-poc.md](../2024/CVE-2024-6387-lflare_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是OpenSSH服务器(sshd)中的一个竞争条件漏洞，源于CVE-2006-5051的安全回归。当sshd在不安全的方式下处理某些信号时，未经验证的远程攻击者可能通过在设定的时间内未能成功验证身份来触发此漏洞。

**有效性评估：**
根据漏洞信息和搜索结果，此漏洞的PoC已经发布，并且被广泛讨论，证明了其有效性。PoC代码（`7etsuo-regreSSHion.c`）尝试利用此漏洞，通过以下步骤：

1.  **连接建立：** 与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH协议握手。
3.  **堆准备：** 准备堆布局以进行利用。
4.  **时间测量：** 测量数据包解析时间。
5.  **竞争条件尝试：** 尝试触发竞争条件，利用信号处理中的不安全函数调用，最终目标是执行shellcode，提权至root。
6.  **ASLR绕过：**尝试不同的glibc基地址，以绕过地址空间布局随机化(ASLR)。

代码中包含了尝试20000次利用的循环，以及100ms的延时，这些都符合漏洞分析文章的描述，增加了利用成功的可能性。

**投毒风险评估：**

此PoC代码存在一定程度的投毒风险，因为:

1.  **Shellcode:** PoC代码包含一个shellcode占位符，攻击者需要替换成真实的shellcode。如果提供的shellcode本身是恶意的，那么使用此PoC会导致投毒。
2. **glibc地址:** PoC代码包含glibc基址，攻击者需要手动调整为目标系统的基址。如果提供的基址不正确，或者根本无法确定正确的基址，会影响利用成功率。如果攻击者故意提供错误的基址或者使用错误的基址绕过策略，也有可能导致拒绝服务。
3.  **定时参数：** PoC代码中的定时参数需要根据目标系统的响应速度进行调整。如果定时不当，可能导致利用失败，甚至使目标系统崩溃。
4.  **heap布局:** OpenSSH的堆布局会随着版本的变化而变化，需要针对不同的版本进行调整。如果不调整，可能无法成功利用。

**评估：**
PoC代码的编写者可能在代码中加入不易察觉的恶意行为，例如收集目标系统信息并发送到远程服务器等。但是，考虑到PoC的主要目的是为了验证漏洞，因此这种风险相对较低。PoC中已经存在大量的需要修改的地方，需要使用者有一定的漏洞知识储备，因此投毒风险相对较低。

**综合评估**：PoC中投毒风险预估为10%，

**利用方式总结：**

1.  攻击者首先需要与目标OpenSSH服务器建立连接。
2.  然后，攻击者需要执行SSH握手协议。
3.  接着，攻击者发送特制的数据包，触发sshd中的竞争条件。
4.  竞争条件允许攻击者覆盖内存中的关键数据结构。
5.  攻击者通过覆盖的数据结构，执行预先准备好的shellcode，从而获得目标系统的root权限。
6. 利用过程需要绕过ASLR保护，这可能需要多次尝试，或者使用其他信息泄露漏洞。
7. 攻击需要一定的timing， 把握好发送数据包的时间。

**项目地址:** [lflare/cve-2024-6387-poc](https://github.com/lflare/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #22

**来源**: [CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387是一个OpenSSH服务器(sshd)中的安全回归漏洞，存在于OpenSSH 8.5p1到9.7p1版本。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。远程攻击者可以通过在设定的时间内认证失败来触发此漏洞，可能导致远程代码执行或拒绝服务。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已确认存在，并且有POC代码可用。搜索引擎结果中的多个链接指向了漏洞分析、利用和修复方法，以及相关的讨论。

**投毒风险：**
提供的POC代码包含一个Python脚本（main.py）和一个README.md文件。脚本内容主要用于识别易受攻击的OpenSSH服务器，并无发现任何恶意代码或者后门，但是不排除后续增加投毒代码的可能性, 因此投毒风险极低。

**利用方式：**
1.  攻击者需要发起大量SSH连接到目标服务器。
2.  在LoginGraceTime时间内，故意使认证失败。
3.  利用竞争条件，使sshd以不安全的方式处理信号。
4.  如果成功，攻击者可能能够执行任意代码或导致服务崩溃（拒绝服务）。

**缓解措施：**
*   将OpenSSH升级到9.8或更高版本。
*   设置`LoginGraceTime 0`可以缓解RCE，但不能完全避免DoS攻击，建议结合`fail2ban`和防火墙使用。

**项目地址:** [moften/regreSSHion-CVE-2024-6387](https://github.com/moften/regreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #23

**来源**: [CVE-2024-6387-prelearn-code_CVE-2024-6387.md](../2024/CVE-2024-6387-prelearn-code_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 远程代码执行

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行

**影响应用:** OpenSSH

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (glibc-based Linux systems)

**利用条件:** 目标系统需要运行受影响版本的OpenSSH，且基于glibc。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，也被称为"regreSSHion"，是OpenSSH服务器（sshd）中的一个安全漏洞，是CVE-2006-5051的一个回归。它是由信号处理中的竞争条件引起的。未经身份验证的远程攻击者可以通过在设定的时间内未能成功进行身份验证来触发此漏洞，可能导致以root权限执行任意代码。该漏洞影响基于glibc的Linux系统上的OpenSSH 8.5p1到9.7p1版本。

**有效性：**
根据漏洞库信息、搜索结果（特别是来自Qualys和offsec的分析），以及POC代码的存在，可以判断该漏洞是有效的，并且存在可利用的POC。

**投毒风险：**
POC代码中存在一定的投毒风险。虽然代码的目的是利用该漏洞，但攻击者可能会修改shellcode以进行恶意活动，或者在代码中加入额外的后门。例如，`shellcode`变量中包含占位符，需要替换为实际的shellcode。如果用户从不可信来源下载POC，并使用了包含恶意shellcode的POC，则可能存在投毒风险。代码中定义了多个glibc地址用于绕过ASLR，攻击者可以伪造错误的地址，来扰乱攻击。

**利用方式：**
利用方式涉及以下几个步骤：

1.  **建立连接：** 攻击者首先与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH握手过程，包括版本交换和密钥交换的初始化。
3.  **堆准备：** 发送特定的SSH数据包，以在sshd进程的堆上创建特定的内存布局，为利用创造条件。
4.  **触发竞争条件：** 攻击者触发一个竞争条件，该条件涉及OpenSSH处理信号的方式，利用SIGALRM信号处理程序中的不安全函数调用。
5.  **地址绕过：** 通过尝试多个可能的glibc基址，绕过地址空间布局随机化 (ASLR)。
6.  **执行代码：** 成功触发竞争条件后，将恶意shellcode注入到内存中并执行，从而获得远程代码执行权限（通常以root权限）。

**缓解措施包括：**
*   禁用`LoginGraceTime`参数，虽然不能完全阻止DoS，但可以防御RCE。
*   使用`fail2ban`等工具监控日志文件并管理连接。
*   及时更新到OpenSSH的修复版本。

**项目地址:** [prelearn-code/CVE-2024-6387](https://github.com/prelearn-code/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #24

**来源**: [CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md](../2024/CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，glibc-based Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387是一个OpenSSH服务器中的竞争条件漏洞（源于CVE-2006-5051的回归）。未经身份验证的远程攻击者可以通过在设定的时间内未能完成身份验证来触发此漏洞。利用方式是发送大量连接请求，触发竞争条件，在glibc-based Linux系统上可能导致在堆中插入恶意指令，最终实现远程代码执行或拒绝服务。提供的脚本并非POC，而是缓解措施：

1.  **有效性：** 提供的脚本实际上是一个缓解脚本，通过将`LoginGraceTime`设置为0来减少漏洞被利用的可能性，并不能直接验证漏洞，缓解脚本会禁用SSHD服务器在指定超时时间内未完成身份验证时断开连接的能力。虽然降低了RCE的风险，但增加了拒绝服务(DoS)的风险。

2.  **投毒风险：** 提供的脚本目的是缓解漏洞，没有发现任何隐藏的恶意代码，因此投毒风险为0%。

3.  **利用方式：** 根据漏洞信息和搜索结果，利用方式是未认证的攻击者向目标OpenSSH服务器发送大量连接请求，由于竞争条件的存在，sshd可能以不安全的方式处理信号，从而允许攻击者执行任意代码（RCE）或造成拒绝服务(DoS)。攻击成功的关键在于触发竞争条件，因此需要大量的并发连接尝试。


**项目地址:** [redux-sibi-jose/mitigate_ssh](https://github.com/redux-sibi-jose/mitigate_ssh)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #25

**来源**: [CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md](../2024/CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，并且攻击者能够建立SSH连接并触发竞争条件。攻击者需要尝试大量连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全漏洞，源于信号处理中的竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：** 根据漏洞库信息和搜索结果，此漏洞存在PoC。该漏洞的利用依赖于触发竞争条件，因此需要进行大量的连接尝试。

**投毒风险：** 分析提供的PoC代码，主要包含一个检测脚本（detection-script.py）和一个README。检测脚本尝试建立到目标SSH服务器的连接，并发送SSH协议版本字符串，然后读取服务器的响应。LICENSE文件和README.md文件是标准格式，描述了漏洞信息。由于检测脚本本身较为简单，且没有发现明显的恶意代码，因此投毒的风险较低，约为10%。 但是需要人工review所有代码.特别是二进制文件.

**利用方式：** 利用此漏洞需要：
1.  攻击者向目标服务器上的sshd服务发起大量的连接请求。
2.  在连接建立但身份验证尚未完成时，利用竞争条件触发信号处理错误。
3.  如果成功利用，攻击者可以在目标系统上执行任意代码，获得root权限（根据漏洞描述和搜索结果）。

利用的复杂性在于需要精确地控制时序，以触发竞争条件。这通常需要大量的计算资源和对目标系统行为的深入了解。同时该漏洞在glibc-based Linux systems更有效,可能无法在所有系统上利用。

**项目地址:** [s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH](https://github.com/s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #26

**来源**: [CVE-2024-6387-wiggels_regresshion-check.md](../2024/CVE-2024-6387-wiggels_regresshion-check.md)

# CVE-2024-6387

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-6387-AzrDll_CVE-2024-6387.md](../2024/CVE-2024-6387-AzrDll_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH 竞争条件导致 RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。需要发起大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务中的一个竞争条件漏洞，源于 CVE-2006-5051 的回归。未经身份验证的远程攻击者可以通过在短时间内发起大量失败的身份验证尝试来触发此漏洞。利用此漏洞需要在glibc堆中插入指令，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞确实存在，并且有公开的PoC利用代码。该PoC通过建立大量的 SSH 连接并进行不成功的身份验证来触发竞争条件。参考[webpage 3]，此漏洞允许glibc Linux发行版在堆中插入指令，从而实现代码执行。提供的PoC代码尝试利用这一点，但成功率可能较低，因为竞争条件需要精确的时间控制。

**投毒风险：**
提供的PoC代码`/tmp/fe03af2a23123389ff9785e2fb119f2c/PoC.py` 包含了从文件中读取glibc地址的功能。 虽然代码本身没有明显的恶意行为，但如果提供的 `glibc_file` 包含恶意构造的地址，可能会导致非预期的行为，甚至导致拒绝服务。例如，如果`glibc_base`地址指向了关键系统函数，覆盖该地址可能造成系统崩溃。另一个潜在的风险点是 `timing_adjustment`，如果调整不当可能造成DoS。综上所述，投毒风险为10%。主要是考虑到作者可能在利用代码的 `glibc_file` 参数中提供恶意的 glibc 地址，诱导用户使用，从而达到破坏目标系统的目的。

**利用方式：**
1.  **建立连接：** 攻击者首先建立与目标 OpenSSH 服务器的 TCP 连接。
2.  **SSH 握手：** 攻击者执行 SSH 握手过程，例如发送 SSH 版本字符串。
3.  **堆准备：** PoC尝试在堆上分配一些数据，为利用竞争条件做准备。
4.  **触发竞争条件：**  通过快速发送大量失败的身份验证请求，攻击者试图触发 `sshd` 进程中的竞争条件。这涉及利用 `LoginGraceTime` 参数，该参数允许攻击者在身份验证超时之前发送多个请求。根据[webpage 6]，利用此漏洞需要大量连接尝试才能准确触发竞争条件。
5.  **代码执行：**  如果竞争条件被成功触发，攻击者可以在内存中写入恶意代码，从而实现远程代码执行。提供的 PoC 代码尝试通过覆盖 glibc 的地址来实现这一点。如果成功利用，攻击者可以获得 root 权限，如[webpage 1][webpage 4]所描述。
6.  **拒绝服务：** 即使未能成功实现 RCE，攻击者也可能通过耗尽服务器资源来实现拒绝服务。由于竞争条件涉及信号处理，不正确的信号处理可能导致 `sshd` 崩溃。

**项目地址:** [AzrDll/CVE-2024-6387](https://github.com/AzrDll/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #2

**来源**: [CVE-2024-6387-DimaMend_cve-2024-6387-poc.md](../2024/CVE-2024-6387-DimaMend_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行(RCE)和拒绝服务(DoS)

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，并且目标系统基于glibc。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全漏洞，它是由CVE-2006-5051引入的回归错误。该漏洞是一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**利用方式：**

1.  **建立连接：** 攻击者首先与易受攻击的OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者尝试进行SSH握手，但故意不完成身份验证过程。这是为了触发`LoginGraceTime`超时。
3.  **堆准备：** 攻击者发送一系列SSH数据包，旨在操纵服务器的内存堆的布局。 这可能涉及到分配和释放内存，以便为利用创造合适的条件。
4.  **触发竞争条件：** 攻击者利用`LoginGraceTime`超时机制。当服务器由于握手超时而即将终止连接时，会发送一个信号。 攻击者尝试与此信号处理程序执行竞争，以修改服务器的内存。
5.  **代码执行：** 如果竞争成功，攻击者可以将恶意代码注入到服务器的内存中，并获得代码执行能力。 根据具体利用方式，这可能导致以root权限执行代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞的利用是可行的。许多信息源表明，存在公开可用的PoC，并且已经有人成功利用了此漏洞。 PoC代码的功能是尝试利用这个竞态条件。

**投毒风险分析：**

PoC代码中存在投毒代码的风险很低，原因如下：

*   **代码结构：** 代码主要集中于建立连接、进行SSH握手、操纵堆内存以及尝试触发竞态条件。虽然代码较为复杂，但在总体流程上没有明显的恶意操作。
*   **Shellcode占位符：** 代码中存在一个 `shellcode` 占位符，明确提示用户需要替换成实际的 shellcode。这表明作者的意图是提供一个框架，而不是一个直接可用的恶意载荷。
*   **注释和说明：** 代码包含大量的注释和说明，解释了漏洞的原理、利用方法以及需要调整的参数。这表明作者的目的是帮助研究人员理解和复现漏洞，而不是隐藏恶意代码。
*   **随机性和尝试次数：** 代码包含大量的随机尝试，目的是为了提高漏洞利用的成功率。这种随机性使得代码难以预测，也增加了作者插入恶意代码的难度。
*   **外部依赖：** 代码没有包含明显的外部依赖或网络请求，这降低了其被用于下载或执行恶意代码的风险。

虽然直接投毒的可能性较低，但仍然存在一些潜在风险，比如在 `shellcode` 占位符中插入恶意代码，或者在调整参数的过程中引入错误，导致程序行为异常。因此，在使用 PoC 代码时，仍然需要进行仔细的代码审查和安全测试。

综上所述，此仓库中存在作者隐藏的投毒代码的可能性估计为1%。

**项目地址:** [DimaMend/cve-2024-6387-poc](https://github.com/DimaMend/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #3

**来源**: [CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行存在漏洞版本的OpenSSH服务，且攻击者能够建立SSH连接，并在认证超时前发送恶意数据。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，存在于glibc的linux系统。它源于一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该漏洞是有效的。多个来源都确认了该漏洞的存在以及其远程代码执行的潜力。POC代码的存在进一步支持了其可利用性。

**投毒风险：**

POC代码本身包含以下潜在的投毒风险点：

*   **Shellcode占位符:** 代码中明确提到 `Shellcode placeholder (replace with actual shellcode)`。如果用户直接使用未经审查的 shellcode，则可能引入恶意行为。此处的风险不在于作者投毒，而在于用户使用不当。
*   **GLIBC_BASES:**  `GLIBC_BASES[]` 数组包含可能的 glibc 基地址。如果这个地址不准确，利用将失败。如果作者故意提供错误的地址，可能会导致拒绝服务或误导分析。
*   **Timing parameters:** 注释提到需要根据目标系统调整 timing 参数。错误的 timing 可能导致利用失败或系统不稳定。
*   **Heap layout 和 File structure offsets:**  代码注释中也强调了需要针对不同的 OpenSSH 和 glibc 版本进行调整，否则利用会失败。故意设置错误的值可能导致程序崩溃或产生其他未定义行为。
*   **随机数生成:** 代码使用 `srand(time(NULL))` 初始化随机数生成器。虽然这本身不是投毒，但如果后续利用中依赖于可预测的随机数，可能会被利用。

总体评估投毒风险为30%。风险主要来自于需要用户自行替换的shellcode，以及需要用户根据目标环境配置的参数。作者本身隐藏恶意代码的可能性较低，但用户在使用过程中存在引入风险的可能性。

**利用方式：**

1.  **建立连接：** 攻击者首先需要建立与目标 OpenSSH 服务器的连接。
2.  **SSH握手：** 进行初步的SSH握手过程，包括版本协商和密钥交换的初始化，但无需完成身份认证。
3.  **堆准备：**  `prepare_heap` 函数的目的是在堆上创建特定的布局，为后续的利用创造条件。具体实现细节未给出，但可能涉及分配和释放内存，以控制堆的状态。
4.  **时间测量：** `time_final_packet` 函数测量服务器处理特定数据包所需的时间。这个时间信息对于后续的竞争条件利用至关重要。
5.  **竞争条件：**  `attempt_race_condition` 函数尝试触发漏洞的核心：信号处理程序中的竞争条件。这通常涉及发送一个精心构造的数据包，该数据包会在服务器处理过程中触发 SIGALRM 信号。由于信号处理程序使用了异步信号不安全函数，因此可能导致堆损坏。
6.  **代码执行：**  如果竞争条件成功触发，攻击者就可以利用堆损坏来执行任意代码。这通常涉及覆盖函数指针或控制程序的执行流程。

该漏洞的利用依赖于精确的 timing 和对目标系统内存布局的了解。攻击者需要进行大量的尝试才能成功利用该漏洞。

**项目地址:** [HadesNull123/CVE-2024-6387_Check](https://github.com/HadesNull123/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #4

**来源**: [CVE-2024-6387-Karmakstylez_CVE-2024-6387.md](../2024/CVE-2024-6387-Karmakstylez_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器(sshd)中的一个安全回归漏洞，存在于glibc-based Linux系统。该漏洞源于信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。该漏洞利用代码尝试通过大量的连接请求触发竞争条件，通过调整glibc基地址和定时参数绕过ASLR，将恶意代码注入到堆中，最终实现以root权限远程代码执行。

有效性：根据漏洞信息和搜索结果，此POC代码具备一定的有效性，但成功利用需要满足特定条件，例如目标系统使用glibc，以及OpenSSH版本在受影响范围内。同时，漏洞利用的成功率受到系统负载、网络延迟等因素的影响，需要进行大量的尝试。

投毒风险：POC代码中存在一定的投毒风险。虽然POC代码的主要目的是利用已知的漏洞，但攻击者可能在代码中加入恶意功能，例如植入后门、收集敏感信息等。例如，shellcode 部分是明显的注入点。风险评定为10%，主要基于以下几点：
1.  **Shellcode 替换：** 代码明确指出 `shellcode` 变量是占位符，需要替换为实际的 shellcode。如果用户不小心使用了包含恶意指令的 shellcode，则可能导致投毒。
2.  **glibc 基地址猜测：** 虽然代码尝试多个 glibc 基地址，但如果攻击者预先知道目标系统的 glibc 地址，则可以修改 `GLIBC_BASES` 数组以提高利用成功率，同时也可能引入恶意地址。
3.  **Timing 参数调整：** 代码中的 `usleep` 函数用于控制连接尝试之间的延迟。攻击者可以通过调整这些参数来优化漏洞利用，但也可能引入导致拒绝服务 (DoS) 的参数。
4.  **编译选项：**POC 需要编译，攻击者可以在编译时添加额外的恶意编译选项，例如禁用安全特性等。
5.  **作者本身:** 仓库作者有投毒行为.

利用方式：
1.  攻击者首先需要确定目标系统是否运行受影响的OpenSSH版本，以及是否基于glibc。
2.  攻击者发起大量的SSH连接请求，尝试触发竞争条件。
3.  攻击者利用精心构造的数据包覆盖堆上的特定内存区域，将恶意代码注入到sshd进程中。
4.  一旦恶意代码成功执行，攻击者即可获得目标系统的控制权。

**项目地址:** [Karmakstylez/CVE-2024-6387](https://github.com/Karmakstylez/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #5

**来源**: [CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md](../2024/CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md)

## CVE-2024-6387-OpenSSH-RegreSSHion-RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行并获取 root 权限或造成拒绝服务

**影响版本:** <= 9.7p1 (受影响版本 8.5p1 至 9.7p1)

**利用条件:** 需要目标服务器运行受影响版本的OpenSSH，且存在时间窗口内的未认证连接尝试。高危利用场景依赖glibc环境。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-6387，也被称为“regreSSHion”，是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞（CVE-2006-5051）。该漏洞源于信号处理中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC已经存在，并且能够实现远程代码执行和拒绝服务攻击。很多安全厂商和研究人员都发布了相关的分析报告和PoC代码。

**投毒风险：**
提供的漏洞利用代码（/tmp/270e32ae67508359811c0f9899155269/README.md 和 LICENSE）仅仅是声明了存在POC，根据现有信息，该仓库本身存在恶意代码的风险较低。但是，由于POC的执行具有高危性，在实际使用中，仍需要进行安全审查。

**利用方式：**
1.  **竞争条件：** 攻击者通过在短时间内发起大量未认证的连接尝试，触发 `sshd` 中的竞争条件。
2.  **信号处理：** 在特定的时间窗口内，`sshd` 可能会以不安全的方式处理信号，导致内存损坏或其他异常行为。
3.  **远程代码执行/拒绝服务：**  利用内存损坏或其他异常行为，攻击者可以执行任意代码（RCE），或导致 `sshd` 崩溃，造成拒绝服务（DoS）。部分利用依赖特定的glibc环境。
4.  **ProxyCommand注入:** 根据github仓库的README.md描述，该POC利用了 `ProxyCommand` 配置不当或滥用的情况，攻击者可以注入恶意命令到 `ProxyCommand` 中，从而获得命令执行或者横向渗透的能力。

**缓解措施：**
*   升级到 OpenSSH 9.8 或更高版本。
*   设置 `LoginGraceTime 0` 以禁用在指定超时时间内未完成身份验证时服务器断开连接的功能（Red Hat 建议的临时缓解措施，但会使服务器更容易受到 DoS 攻击）。
*   使用 `fail2ban` 等工具，配合防火墙来监控日志文件并适当管理连接。

**项目地址:** [Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC](https://github.com/Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #6

**来源**: [CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md](../2024/CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）或拒绝服务（DoS）

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。它是一个竞争条件漏洞，可能导致sshd以不安全的方式处理信号。远程攻击者可以通过在设定的时间内未能成功验证身份来触发此漏洞，从而可能导致远程代码执行或拒绝服务。

**有效性评估：**

根据漏洞库信息、搜索结果以及提供的POC代码来看，此漏洞的POC是存在的，并且多个安全厂商都发布了相关的分析报告和检测方法。搜索结果也表明此漏洞允许远程未授权代码执行。

**利用方式：**

1.  攻击者建立与目标OpenSSH服务器的连接。
2.  进行SSH握手，获取服务器banner。
3.  准备堆，发送一定量的填充数据。
4.  尝试触发竞争条件，通过发送包含`glibc_base`地址的payload，并附加一些`nop`指令。
5.  如果成功，则在服务器上执行代码，获得root权限。
6.  脚本使用了多线程来增加攻击成功的几率，并对时序进行调整。

**投毒风险评估：**

提供的POC代码（`Exploit_2024_6387.py`）本身是一个漏洞利用脚本，其目的是利用目标系统的漏洞。评估投毒风险主要关注作者是否在脚本中植入了恶意代码，例如：

*   **后门代码：**  脚本在成功利用漏洞后，是否会创建一个后门，允许攻击者在未经授权的情况下再次访问系统。
*   **破坏性代码：**  脚本是否包含旨在破坏目标系统或数据的代码。
*   **信息窃取代码：**  脚本是否会窃取目标系统上的敏感信息。

分析代码发现，虽然脚本本身旨在利用漏洞，但并未发现明显的后门、破坏性或信息窃取代码。 然而，需要注意的是，该脚本的`TARGET_IP`和`TARGET_PORT`是硬编码的，在实际使用中需要进行修改。此外，攻击者可能会修改此脚本以包含恶意功能。此处的`glibc_base`地址也需要根据目标环境进行调整，否则利用大概率会失败，这也是成功利用此漏洞的难点之一。

综合来看，该仓库存在投毒风险的可能性较低，但是不排除有攻击者对代码进行修改后，二次传播。因此，建议在使用前仔细审查代码。

**风险评估：**
`poison`的百分比评估主要考虑以下几个方面：

*   **代码复杂性：** 代码越复杂，隐藏恶意代码的可能性越高。
*   **作者信誉：** 如果作者的信誉未知或可疑，则风险越高。
*   **代码审查：** 代码是否经过其他安全研究人员的审查。

根据以上分析，此脚本的`poison`风险评估为10%。

**项目地址:** [SkyGodling/CVE-2024-6387-POC](https://github.com/SkyGodling/CVE-2024-6387-POC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #7

**来源**: [CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md](../2024/CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，未认证的远程攻击者通过在设定的时间内认证失败触发

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞(CVE-2006-5051)。它存在一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，进而导致远程代码执行(RCE)或拒绝服务(DoS)。

根据搜索结果和漏洞信息，该漏洞影响glibc-based Linux系统，利用需要发起大量连接尝试来触发竞争条件。

提供的漏洞利用代码 `scanner.py` 是一个版本扫描器，并非直接利用 CVE-2024-6387。它用于检测目标 SSH 服务器的版本，并根据预定义的 CVE 列表判断是否存在已知的漏洞。该脚本通过创建 socket 连接到目标主机的 SSH 端口，然后发送一个空字节并接收服务器的响应，从中提取 OpenSSH 的版本信息。然后将提取的版本与易受攻击的版本列表进行比较。

**漏洞利用方式：**

1.  攻击者需要向目标 OpenSSH 服务器发起大量的连接请求。
2.  在连接建立后，故意触发认证失败，从而在信号处理过程中创建竞争条件。
3.  竞争条件允许攻击者在某些 glibc Linux 发行版中将指令插入堆中，进而实现远程代码执行。

**投毒风险：**

虽然脚本本身是一个版本扫描器，而不是直接的漏洞利用程序，但仍需谨慎评估其潜在的投毒风险。 代码中存在创建日志目录并记录扫描结果的行为，存在恶意修改扫描逻辑或在日志中写入恶意数据，但可能性极低。因此，评估投毒风险为1%。

**项目地址:** [ThatNotEasy/CVE-2024-6387](https://github.com/ThatNotEasy/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #8

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 远程代码执行/拒绝服务

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1，受影响版本包括8.5p1至9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且攻击者能够发起大量连接请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞，它源于 CVE-2006-5051。该漏洞是一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间段内未能通过身份验证来触发此漏洞。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的PoC代码是有效的。多个来源证实了该漏洞的存在和可利用性，特别是针对glibc的Linux系统。

**投毒风险：**

提供的PoC代码包含用于编译、构建和利用漏洞的Dockerfile和Python脚本。通过分析代码，可以发现以下潜在的投毒风险因素：

*   **依赖项：** Dockerfile中使用了`wget`和`curl`来下载OpenSSH源码，存在被中间人攻击替换为恶意源码的风险。尽管校验和可以降低这种风险，但如果攻击者能够控制构建环境，仍然可能引入恶意代码。
*   **shellcode：** Python脚本包含一个名为`shellcode`的变量，目前只是占位符，但攻击者可以修改此变量，插入恶意shellcode。攻击者可以精心构造shellcode，以执行恶意操作，例如安装后门、窃取数据或提权。

虽然这些风险存在，但从现有代码来看，没有发现明显的恶意代码。因此，评估投毒风险为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的OpenSSH环境（32位Linux系统）。
2.  **SSH握手：** 客户端与服务器建立连接，发送SSH版本信息并进行密钥交换（KEX）初始化。
3.  **堆准备：** 通过发送特定大小的数据包来布置堆内存，利用glibc的漏洞插入恶意指令。
4.  **触发竞争条件：** 大量连接尝试来触发信号处理程序中的竞争条件。
5.  **执行代码：** 成功触发竞争条件后，恶意代码将被执行，从而实现远程代码执行。

总体来说，利用方式较为复杂，需要精心构造数据包和进行大量的连接尝试才能成功。

**项目地址:** [YassDEV221608/CVE-2024-6387](https://github.com/YassDEV221608/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #9

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 9.7p1 (影响 8.5p1 到 9.7p1)

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，并且是基于glibc的Linux系统。攻击者需要能够建立到SSH服务的网络连接，并能够快速发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中发现的一个安全回归漏洞，存在于glibc的Linux系统中。该漏洞是由于OpenSSH服务器（sshd）中的信号处理存在竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用此漏洞可能导致以 root 身份远程执行代码。

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果也确认了该漏洞的存在，并描述了其可能导致远程代码执行的风险。漏洞利用代码的存在也进一步证实了漏洞的有效性，代码尝试利用竞争条件来执行任意代码。

**投毒风险：**
代码存在一定的投毒风险的可能性。虽然代码本身看起来是在尝试利用该漏洞，但以下因素需要考虑：

1.  **Shellcode占位符：** 代码中包含一个shellcode占位符`unsigned char shellcode[] = "\x90\x90\x90\x90";`，明确指示需要替换成实际的shellcode。如果用户没有意识到这一点，或者使用了恶意shellcode，可能会造成损害。这里的投毒风险在于，攻击者可能发布包含恶意shellcode的exp，诱导用户使用。 
2.  **GLIBC_BASES：** 代码中定义了`GLIBC_BASES[]`，用于绕过ASLR。如果这些地址不正确，利用将失败。更糟糕的是，如果攻击者故意提供错误的地址，可能会导致程序崩溃或其他不可预测的行为。
3.  **Timing parameters和 Heap layout 需要调整：** 代码注释中强调了定时参数和堆布局需要根据目标系统进行调整。如果这些参数设置不正确，可能会导致利用失败或目标系统不稳定。
4.  **文件结构偏移量：** 代码提到需要验证特定glibc版本的文件结构偏移量。使用错误的偏移量可能导致内存损坏或其他不可预测的行为。

总体来看，该POC的复杂性和对系统内部结构的依赖性，投毒者可以通过提供不正确的配置参数，或者引导用户使用错误的shellcode，达到破坏目标系统的目的。因此存在10%的投毒风险。

**利用方式：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **建立连接：** 攻击者首先需要与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者需要完成初始的SSH握手过程，包括协议版本交换和密钥交换初始化（KEX）。
3.  **堆准备：** 攻击者利用SSH协议发送数据包，在内存堆上布置精心构造的数据结构，为后续的漏洞利用做准备。
4.  **触发竞争条件：** 攻击者发送一个特制的SSH数据包，该数据包的设计是为了触发sshd中的竞争条件。具体来说，它利用了在身份验证失败的情况下，信号处理程序中的不安全操作。
5.  **RCE：** 成功触发竞争条件后，攻击者可以将恶意代码注入到sshd进程中，从而实现远程代码执行。具体是通过内存操作覆盖某个函数指针，使其指向攻击者提供的shellcode。
6.  **提权（Root）：** 由于sshd通常以root权限运行，因此攻击者执行的shellcode也将以root权限运行，从而完全控制目标系统。

**项目地址:** [YassDEV221608/CVE-2024-6387_PoC](https://github.com/YassDEV221608/CVE-2024-6387_PoC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #10

**来源**: [CVE-2024-6387-alex14324_ssh_poc2024.md](../2024/CVE-2024-6387-alex14324_ssh_poc2024.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）和拒绝服务（DoS）

**影响版本:** <= 9.7p1

**利用条件:** 需要目标系统开启sshd服务，且受影响的OpenSSH版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是一个存在于OpenSSH服务器（sshd）中的安全漏洞，具体来说是一个竞争条件漏洞。该漏洞源于OpenSSH处理信号的方式。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，导致sshd以不安全的方式处理信号。这可能导致远程代码执行（RCE），攻击者获得root权限，或拒绝服务（DoS），使服务器不可用。

**有效性分析：**
从漏洞库信息、搜索结果和提供的PoC代码来看，该漏洞的PoC是存在的，并且被广泛讨论和利用。 搜索结果中提到“regreSSHion (CVE-2024-6387) is an unauthenticated RCE vulnerability in OpenSSH’s server, affecting glibc-based Linux systems. Full root access is granted.” 表明该漏洞有很高的潜在影响. PoC代码也试图绕过ASLR，并包含shellcode的占位符，表明攻击者可以注入恶意代码。

**投毒风险分析：**
提供的PoC代码具有一定的投毒风险，大约为10%。主要基于以下几点：
1.  **Shellcode占位符：** 代码中包含`unsigned char shellcode[] = "\x90\x90\x90\x90";`。虽然这只是一个占位符，需要用户替换为实际的shellcode，但攻击者可能发布包含恶意shellcode的版本，诱导用户使用。
2.  **GLIBC_BASES地址：**  代码中包含了`uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`。这些地址是ASLR绕过的尝试，但如果攻击者故意提供错误的地址，可能导致利用失败或者其他未知的行为，但一般不会产生特别大的危害。
3.  **Timing参数：** 代码中需要根据目标系统响应调整Timing参数。攻击者可能提供不合适的参数，导致利用不稳定或者失败。
4.  **Heap Layout和文件结构偏移：**  代码注释中提到“Heap layout : Requires tweaking for different OpenSSH versions.” 和 “File structure offsets: Verify for the specific glibc version.”。攻击者可能故意提供错误的值，导致利用失败或者产生其他问题。

**利用方式：**
1.  **建立连接：** 攻击者首先需要与目标服务器的sshd服务建立TCP连接。
2.  **SSH握手：** 进行SSH握手，包括版本交换、密钥交换等步骤。PoC代码中的 `perform_ssh_handshake` 函数实现了这些步骤。
3.  **堆准备：** 通过发送特定的SSH数据包，在sshd进程的堆上分配内存，并控制堆的布局。`prepare_heap` 函数用于执行此操作。
4.  **时间计算：**  计算处理最终数据包所需的时间，用于后续的竞争条件利用。`time_final_packet` 函数用于执行此操作。
5.  **竞争条件利用：**  通过大量并发连接，触发sshd中的竞争条件漏洞。攻击者不断尝试进行身份验证，但故意失败，以触发SIGALRM信号处理程序。由于信号处理程序中使用了非异步信号安全的函数，可能导致内存损坏和代码执行。`attempt_race_condition` 函数用于执行此操作。
6.  **ASLR绕过：**  由于地址空间布局随机化（ASLR）的存在，攻击者需要知道glibc的基地址。PoC代码中包含了一组可能的基地址，并尝试逐个利用。
7.  **代码注入：** 成功利用竞争条件后，攻击者可以将恶意代码（shellcode）注入到sshd进程的内存中。占位符需要替换。
8.  **代码执行：**  执行注入的shellcode，从而获得服务器的root权限。

**项目地址:** [alex14324/ssh_poc2024](https://github.com/alex14324/ssh_poc2024)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #11

**来源**: [CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md](../2024/CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH服务，并允许未授权的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)。

**有效性:**
根据搜索结果和漏洞库信息，此漏洞的PoC是存在的，并且已经被公开。多个来源证实了该漏洞的存在，以及它可能导致远程代码执行。提供的“漏洞利用代码”实际上是一个缓解脚本，旨在通过升级OpenSSH版本或禁用LoginGraceTime来降低风险，而不是一个实际的利用程序。

**投毒风险:**
提供的脚本主要功能是检测并修复漏洞，但仍然存在一定的投毒风险：
*   **依赖外部源：** 脚本使用`apt-get update`和`apt-get install`命令，依赖外部软件源。如果软件源被恶意篡改，可能导致安装恶意软件包。
*   **配置修改：** 脚本会修改`/etc/ssh/sshd_config`文件，存在被恶意利用修改配置的风险。
*   **权限提升：** 脚本需要root权限运行，如果脚本被篡改，可能导致提权攻击。
综合考虑，该脚本存在一定的投毒风险，但主要风险在于依赖的外部源和配置修改，因此投毒风险评估为10%。

**利用方式:**
此漏洞的利用方式是利用 sshd 进程处理信号时的竞争条件。攻击者需要发起大量连接尝试，并在身份验证失败时触发竞争条件。成功触发后，攻击者能够在目标系统上执行任意代码。根据 offsec.com 的博客文章，此漏洞利用机会在某些 glibc Linux 发行版中，能将指令插入堆中。

**项目地址:** [almogopp/OpenSSH-CVE-2024-6387-Fix](https://github.com/almogopp/OpenSSH-CVE-2024-6387-Fix)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #12

**来源**: [CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md](../2024/CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许未授权网络访问SSH端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387 (regreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的安全回归漏洞，源于 CVE-2006-5051。这是一个竞争条件漏洞，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内身份验证失败来触发此漏洞。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经公开。多个安全厂商和研究人员已经发布了关于此漏洞的分析和PoC代码。

**投毒风险分析：**

提供的Checker.py脚本的主要功能是检测目标SSH服务器是否存在CVE-2024-6387漏洞。它通过连接到目标服务器的SSH端口并获取SSH banner信息，然后将其与已知易受攻击和已修补的版本进行比较来确定漏洞状态。 代码中没有发现任何明显的恶意或后门代码。

投毒风险评估：0%。该脚本主要用于漏洞检测，不包含任何主动利用漏洞的代码，也没有发现作者隐藏的恶意代码。

**利用方式分析：**

1.  **漏洞原理：** 漏洞是由于 OpenSSH 在处理信号时存在竞争条件，允许在身份验证失败期间执行恶意代码。
2.  **攻击步骤：** 攻击者需要向目标服务器发起大量的SSH连接尝试。
3.  **触发条件：** 在连接尝试期间，攻击者故意使身份验证失败，触发竞争条件。
4.  **利用结果：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码，以root权限运行，或者造成拒绝服务攻击。
5.  **缓解措施：** 通过设置 `LoginGraceTime 0` 禁用 `LoginGraceTime` 参数可以缓解远程代码执行的风险，但仍然存在拒绝服务的风险。更新到OpenSSH 9.8或更高版本是完整的修复方案。

**项目地址:** [anhvutuan/CVE-2024-6387-poc-1](https://github.com/anhvutuan/CVE-2024-6387-poc-1)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #13

**来源**: [CVE-2024-6387-awusan125_test_for6387.md](../2024/CVE-2024-6387-awusan125_test_for6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要目标系统基于 glibc，且 OpenSSH 版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理程序中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用可能允许攻击者在目标系统上以 root 权限执行任意代码或导致拒绝服务。

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞的 PoC 已被公开，并且漏洞利用的复杂性较高。搜索结果表明，该漏洞影响 glibc 基础的 Linux 系统。提供的 POC 代码似乎旨在利用此漏洞。

**投毒风险分析：**
该 POC 代码中存在一定的投毒风险，大约 20%。原因如下：
*   **Shellcode 占位符:** 代码中包含 `unsigned char shellcode[] = "\x90\x90\x90\x90";` 这一行，明确指出需要替换为实际的 shellcode。如果用户不小心使用了该占位符，或者植入了其他有害 shellcode，则可能导致不可预期的后果。
*   **GLIBC 基地址硬编码:** 代码中定义了 `uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`，并表示 “Needs adjustment for specific target systems”。如果 GLIBC 基地址不正确，可能导致利用失败，甚至造成程序崩溃。攻击者可能会故意提供错误的基地址，使得用户在尝试利用时受到干扰，或者执行其他恶意操作。
*   **Timing 参数需要微调:** 代码注释中提到 “Timing parameters: Fine-tune based on target system responsiveness”。如果 timing 参数设置不当，可能导致竞争条件无法触发，或者引发其他问题。攻击者可能会提供误导性的 timing 参数，使得用户在尝试利用时遇到困难，或者触发非预期的行为。
*   **Heap 布局和文件结构偏移量:** 代码注释提到 “Heap layout : Requires tweaking for different OpenSSH versions” 和 “File structure offsets: Verify for the specific glibc version.” 这表示该漏洞利用依赖于特定的堆布局和文件结构偏移量。如果这些值不正确，则可能导致利用失败，甚至造成程序崩溃。攻击者可能会提供不兼容的值，使得用户在尝试利用时受到干扰，或者触发非预期的行为。
*   **错误处理不完善:** 代码中虽然包含了一些错误处理逻辑，但可能存在未处理的异常情况。攻击者可能会利用这些漏洞，使得程序在特定条件下崩溃或执行非预期的操作。

**利用方式：**
利用方式主要涉及以下步骤：
1.  **建立连接：** 与目标 SSH 服务器建立 TCP 连接。
2.  **SSH 握手：** 执行 SSH 握手过程，包括版本交换和密钥交换。
3.  **堆准备：** 通过发送特定的数据包，在堆上创建特定的布局。
4.  **时间控制：** 精确控制数据包的发送时间，以便触发竞争条件。
5.  **竞争条件触发：** 通过大量连接尝试和认证失败，利用信号处理程序的竞争条件在内存中注入恶意代码，通常包括修改 glibc 的数据结构。
6.  **代码执行：** 利用注入的恶意代码来执行任意命令。
7.  **绕过 ASLR：** 由于地址空间布局随机化 (ASLR) 的存在，需要确定 glibc 的基地址。PoC 代码中尝试了几个常见的基地址。

总体而言，该漏洞利用较为复杂，需要对 SSH 协议、glibc 内部机制和竞争条件有深入的了解。该漏洞的成功利用还依赖于目标系统的特定配置和状态。

**项目地址:** [awusan125/test_for6387](https://github.com/awusan125/test_for6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #14

**来源**: [CVE-2024-6387-dream434_CVE-2024-6387.md](../2024/CVE-2024-6387-dream434_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，目标系统运行受影响的OpenSSH版本，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性评估：**

根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已经被广泛讨论。漏洞利用代码的脚本主要用于检测目标主机是否运行存在漏洞的OpenSSH版本，利用方式是扫描目标IP的22端口，获取OpenSSH版本信息，并与已知的易受攻击版本进行比较，从而判断目标系统是否存在漏洞。

**投毒风险分析：**

提供的漏洞利用代码（CVE-2024-6387.py）主要用于版本检测，功能相对简单。虽然`README.md`中包含克隆GitHub仓库的操作，但直接分析提供的Python脚本，发现潜在的投毒点在于以下几个方面：

1.  **依赖包风险：** 脚本本身依赖较少，但如果`README.md`引导用户安装额外的依赖包（例如通过`pip install -r requirements.txt`，而`requirements.txt`包含恶意包），则可能存在投毒风险。
2.  **命令执行风险：** `README.md` 中的运行命令 `python CVE-2024-6387.py http://exemple.com` 虽然看起来无害，但如果 `CVE-2024-6387.py` 存在漏洞，允许通过命令行参数执行恶意代码，则存在风险。当前提供的代码没有直接利用命令行参数执行代码的逻辑。
3.  **文件包含风险：** 如果脚本尝试动态加载其他文件（例如配置文件），而这些文件被篡改，则可能存在风险。

鉴于以上分析，以及`README.md`中存在引导用户克隆github仓库的操作，综合判断，存在较低的投毒风险，约为10%。主要基于假设恶意代码可能存在于被克隆仓库的其他文件中，或者存在利用脚本漏洞执行恶意代码的可能。

**漏洞利用方式：**

1.  **版本检测：** 攻击者首先需要确定目标系统上运行的OpenSSH版本是否在受影响的范围内（8.5p1 <= version <= 9.7p1）。
2.  **触发竞争条件：** 攻击者通过与目标SSH服务器建立连接，并在身份验证过程中故意失败，以触发漏洞相关的竞争条件。
3.  **代码执行：** 成功触发竞争条件后，攻击者可以利用该漏洞在目标系统上执行任意代码，通常以root权限执行。

搜索结果也表明，此漏洞允许未经身份验证的远程代码执行，并且影响基于glibc的Linux系统。因此，利用方式的核心在于触发竞争条件并利用glibc的特性来执行恶意代码。

**项目地址:** [dream434/CVE-2024-6387](https://github.com/dream434/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #15

**来源**: [CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标主机开启SSH服务，且攻击者能够发起大量连接尝试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是一个OpenSSH服务器中的竞争条件漏洞。它源于OpenSSH处理信号的方式，当SSH服务器在短时间内收到大量连接请求且认证失败时，可能导致信号处理不当，进而允许未经验证的远程攻击者在基于glibc的Linux系统上执行任意代码，获取root权限，或者导致拒绝服务。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC已发布，表明漏洞可被利用。提供的Python脚本`CVE-2024-6387-Vulnerability-Checker.py`是一个漏洞检测工具，通过检查SSH banner版本来判断目标是否存在漏洞。脚本本身并不能直接利用该漏洞进行RCE或DoS攻击，而是用来辅助确认目标系统是否在受影响的范围内。

**投毒风险：**
该Python脚本主要功能是检查OpenSSH版本，判断其是否在受影响的范围内。代码本身只包含版本检测逻辑，没有发现任何恶意代码或后门，因此投毒风险极低。可以认为投毒风险为0%。

**利用方式：**
1.  **版本检测：** 使用PoC脚本或类似工具检测目标SSH服务器的版本，确认其是否位于易受攻击的范围(8.5p1 <= OpenSSH <= 9.7p1)。
2.  **触发竞争条件：** 如果目标版本易受攻击，攻击者需要发起大量连接尝试，并在短时间内故意认证失败，以触发竞争条件。
3.  **代码执行（或DoS）：** 成功触发竞争条件后，利用glibc的堆操作特性，攻击者可以插入恶意指令到堆中，从而实现远程代码执行。另一种利用方式是耗尽服务器资源，造成拒绝服务攻击。

需要注意的是，利用此漏洞进行RCE需要对glibc堆操作有一定的了解，并且成功率可能不高。缓解措施包括禁用`LoginGraceTime`配置，并使用`fail2ban`等工具限制恶意连接。

**项目地址:** [filipi86/CVE-2024-6387-Vulnerability-Checker](https://github.com/filipi86/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #16

**来源**: [CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-regreSSHion

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1 (OpenSSH)

**利用条件:** 需要glibc-based Linux系统，以及OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞。漏洞源于OpenSSH服务器处理信号的方式存在问题，具体来说，当用户认证失败时，可能触发不安全的信号处理。远程攻击者可以通过在短时间内发起大量SSH连接尝试，并故意触发认证失败，从而引发竞争条件，最终可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据搜索结果（webpage 1, 3, 4, 5, 7, 8）和漏洞库信息，该漏洞已被确认为一个高危漏洞，并且存在公开的PoC（Proof of Concept）代码。虽然提供的POC代码只是一个包含漏洞描述的README.md文件，**不能直接运行，但是，github上存在可利用的POC**。该POC的有效性取决于目标系统是否满足漏洞利用的条件，即：
1.  使用受影响的OpenSSH版本（<= 9.7p1）。
2.  目标系统是基于glibc的Linux发行版。
3.  系统配置允许一定数量的并发连接。

**投毒风险：**
提供的POC代码（README.md）本身不包含任何可执行代码，因此直接的投毒风险很低。但需要注意的是，任何从互联网上下载的代码都存在潜在的风险。即使是看似无害的文档，也可能包含恶意链接或指令，引导用户下载或执行恶意代码。因此，下载和使用任何PoC代码时，都应该保持警惕，并进行充分的安全审查。

虽然提供的README.md文件本身投毒风险较低,但是考虑到实际利用中需要依赖其他EXP, 因此其他仓库被投毒的可能性相对较高。
风险评估：10%

**利用方式：**
根据漏洞描述和搜索结果，利用方式主要包括以下几个步骤：
1.  **大量连接请求：** 攻击者向目标OpenSSH服务器发起大量的并发连接请求。
2.  **触发认证失败：**  在连接请求中，故意提供错误的用户名或密码，触发认证失败事件。
3.  **竞争条件利用：**  通过大量认证失败事件，触发OpenSSH服务器中的竞争条件漏洞。
4.  **代码执行或DoS：** 成功利用漏洞后，攻击者可以执行任意代码（RCE）或导致服务器崩溃（DoS）。

需要注意的是，利用该漏洞需要一定的资源和技术，并且成功率可能不高。Red Hat 在其安全公告中指出，实现RCE需要相当多的资源投入。同时，修改sshd_config,设置LoginGraceTime为0可以有效避免远程代码执行，但仍存在拒绝服务风险.

**项目地址:** [identity-threat-labs/Article-RegreSSHion-CVE-2024-6387](https://github.com/identity-threat-labs/Article-RegreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #17

**来源**: [CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，sshd服务运行且存在于受影响版本范围内，目标系统是基于glibc的Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中发现的竞争条件漏洞。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发该漏洞。成功利用可能导致以root权限远程执行代码或拒绝服务。该漏洞的利用依赖于触发信号处理程序的竞争条件，攻击者需要发起大量连接尝试才能提高触发漏洞的几率。提供的PoC代码是一个漏洞验证工具，用于检测目标系统上运行的OpenSSH版本是否存在漏洞。它通过连接到目标SSH端口并检查SSH横幅来工作。如果横幅指示易受攻击的版本，则该工具会将目标标记为易受攻击。PoC代码本身似乎不包含任何明显的投毒代码。它仅仅用于验证漏洞是否存在，并不会主动进行利用。

**利用方式：**

1.  攻击者向目标服务器的SSH端口发起大量连接请求。
2.  连接请求需要故意失败，例如提供无效的用户名或密码，以便触发身份验证失败流程。
3.  攻击者利用OpenSSH处理信号时的竞争条件，将恶意指令插入堆中。
4.  如果竞争条件利用成功，攻击者即可在目标系统上以root权限执行任意代码或导致拒绝服务。

**项目地址:** [identity-threat-labs/CVE-2024-6387-Vulnerability-Checker](https://github.com/identity-threat-labs/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #18

**来源**: [CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md](../2024/CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统使用受影响的OpenSSH版本，基于glibc的Linux系统，且未禁用LoginGraceTime

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是一个存在于OpenSSH服务器(sshd)中的竞争条件漏洞。该漏洞源于OpenSSH在处理信号时存在不安全行为。远程攻击者通过在一定时间内认证失败，可以触发此漏洞，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**漏洞利用方式：**

1.  攻击者向目标服务器发起大量的SSH连接请求。
2.  在SSH认证过程中，攻击者故意使认证失败，触发LoginGraceTime超时。
3.  由于竞争条件，sshd可能在处理SIGALRM信号时进入不安全状态。
4.  在glibc-based的Linux系统上，这种不安全状态可能允许攻击者将指令插入到堆中，最终导致RCE。
5.  如果无法实现RCE，攻击者可以通过耗尽服务器资源，导致DoS。

**POC代码分析：**

提供的PoC代码`/tmp/d7c5471d195cdec17d8f4ebaf7516058/CVE-2024-6387_poc.py`的主要功能是检测目标SSH服务器的版本，判断其是否受CVE-2024-6387漏洞影响。它通过建立socket连接，发送`\x00`，接收SSH版本信息，并进行正则匹配来确定OpenSSH的版本。如果版本在易受攻击的范围内（8.5 <= 版本 < 9.8）,则输出目标系统可能存在漏洞。该PoC本身**不包含直接利用漏洞的代码**，仅仅用于版本检测。

`/tmp/d7c5471d195cdec17d8f4ebaf7516058/README.md` 提供了一个使用说明，介绍了如何使用该PoC。`/tmp/d7c5471d195cdec17d8f4ebaf7516058/ip-addr.list`包含需要检查的IP地址列表, 127.0.0.1是示例.

**有效性：**

提供的POC代码的**有效性在于验证目标系统是否存在漏洞**，而非直接利用该漏洞。根据搜索结果和漏洞描述，完整的漏洞利用需要更复杂的步骤和技术，例如大量连接尝试来触发竞争条件，以及精心构造的shellcode。因此，此PoC仅仅是前期验证步骤。

**投毒风险：**

该仓库中存在**投毒风险的可能性较低，约为10%**。PoC代码主要功能是版本检测，本身没有发现恶意代码。潜在的风险可能存在于：

*   `ip-addr.list`文件：虽然当前提供的`ip-addr.list`文件只包含本地地址`127.0.0.1`, 如果用户不小心使用了作者预先设定的其他IP地址列表，可能会导致未授权的扫描或攻击行为。
*   `session.log`文件：虽然日志记录本身不是恶意行为，但如果日志文件被上传或泄露，可能暴露用户的扫描目标信息。日志信息包含IP和端口信息。
*   在实际利用该漏洞时，如果攻击者使用了恶意的Payload，可能会对目标系统造成更大的危害。这些Payload可能被伪装成无害的代码，从而绕过安全检测。
*   如果作者在其他未公开的分支或版本中包含了恶意代码，并且诱导用户使用这些版本，则存在更高的投毒风险。

**综上所述，**虽然提供的PoC代码本身不包含明显的恶意代码，但用户在使用时仍然需要保持警惕，仔细审查代码，并确保从可信的来源获取代码，避免潜在的投毒风险。

**项目地址:** [jocker2410/CVE-2024-6387_poc](https://github.com/jocker2410/CVE-2024-6387_poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #19

**来源**: [CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：**

从搜索结果和漏洞库信息来看，该漏洞存在可利用的POC。提供的Rust代码是一个漏洞检查器，它通过连接到SSH服务器并读取SSH banner来判断目标服务器是否运行着存在漏洞的OpenSSH版本。

**投毒风险：**

提供的代码是一个漏洞检测工具，用于检查目标系统是否存在CVE-2024-6387漏洞。代码功能相对清晰，主要包括：

*   定义了易受攻击和已修补的版本列表。
*   通过TCP连接获取SSH banner。
*   将获取的banner与已知易受攻击的版本进行比较。

代码中没有发现恶意行为，例如执行系统命令或上传/下载文件。因此，**投毒风险较低，判断为0%**。

**利用方式：**

根据漏洞信息和搜索结果，攻击者需要发起大量的连接尝试，以触发sshd中的竞争条件。成功利用该漏洞可能允许攻击者在目标系统上执行任意代码或导致拒绝服务。Offsec的博客提供了关于如何利用该漏洞的更详细的解释。

**总结：**

CVE-2024-6387是一个严重的安全漏洞，允许未经身份验证的攻击者远程执行代码。虽然利用该漏洞需要一定的资源和技术，但由于存在公开的POC，因此建议尽快更新OpenSSH版本。

**项目地址:** [kubota/CVE-2024-6387-Vulnerability-Checker](https://github.com/kubota/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #20

**来源**: [CVE-2024-6387-l-urk_CVE-2024-6387.md](../2024/CVE-2024-6387-l-urk_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH regreSSHion 远程代码执行漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** OpenSSH

**危害等级:** 高危，未授权的远程攻击者可以利用此漏洞以 root 权限执行任意代码，或者造成拒绝服务。

**影响版本:** 8.5p1 ~ 9.7p1

**利用条件:** 目标系统使用受影响的 OpenSSH 版本, 并且基于 glibc 的 Linux 系统。需要网络连通性, 且攻击者需要能够发起大量的 SSH 连接尝试。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，又名 regreSSHion，是 OpenSSH 服务器中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件漏洞，允许未经身份验证的远程攻击者在基于 glibc 的 Linux 系统上执行任意代码。漏洞的利用方式涉及发起大量的 SSH 连接尝试，触发 sshd 进程中的竞争条件，从而允许攻击者将指令插入堆中，最终实现 RCE。

**有效性：**
从搜索结果和漏洞库信息来看，此漏洞是真实存在的，并且存在公开可用的 PoC 代码。PoC 代码的描述也与漏洞描述一致，表明其具有较高的有效性。

**投毒风险：**
提供的 POC 代码库中的 `LISCENCE` 文件声明了严格的权限限制，这在一定程度上增加了投毒的可能性。虽然无法通过现有信息完全确定是否存在投毒代码，但需要对脚本进行仔细审查，特别注意以下几个方面：

*   **shellcode:**  分析 shellcode 的行为，确保其功能与漏洞利用目的相符，没有恶意行为。
*   **网络连接:**  检查代码中是否存在额外的网络连接，特别是连接到未知或可疑的 IP 地址。
*   **文件操作:**  检查代码中是否存在对系统文件的修改或删除操作。
*   **依赖项:**  审查 `requirements.txt` 文件中的依赖项，确保没有引入恶意的第三方库。

考虑到需要大量连接尝试和对堆的操纵，以及许可证的严格声明，综合评估投毒风险为10%。这部分代码逻辑比较复杂，存在隐藏恶意代码的可能性。

**利用方式：**
1.  攻击者通过网络向目标 OpenSSH 服务器发起大量的连接请求。
2.  利用 OpenSSH 服务器处理连接请求时存在的竞争条件，特别是在信号处理方面。
3.  通过精心构造的数据包，将恶意代码注入到服务器的堆内存中。
4.  触发执行注入的恶意代码，从而获得对目标系统的控制权 (RCE) 或导致拒绝服务 (DoS)。
5.  默认的shellcode打开9999端口,并使用nc进行监听。

**项目地址:** [l-urk/CVE-2024-6387](https://github.com/l-urk/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #21

**来源**: [CVE-2024-6387-lflare_cve-2024-6387-poc.md](../2024/CVE-2024-6387-lflare_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是OpenSSH服务器(sshd)中的一个竞争条件漏洞，源于CVE-2006-5051的安全回归。当sshd在不安全的方式下处理某些信号时，未经验证的远程攻击者可能通过在设定的时间内未能成功验证身份来触发此漏洞。

**有效性评估：**
根据漏洞信息和搜索结果，此漏洞的PoC已经发布，并且被广泛讨论，证明了其有效性。PoC代码（`7etsuo-regreSSHion.c`）尝试利用此漏洞，通过以下步骤：

1.  **连接建立：** 与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH协议握手。
3.  **堆准备：** 准备堆布局以进行利用。
4.  **时间测量：** 测量数据包解析时间。
5.  **竞争条件尝试：** 尝试触发竞争条件，利用信号处理中的不安全函数调用，最终目标是执行shellcode，提权至root。
6.  **ASLR绕过：**尝试不同的glibc基地址，以绕过地址空间布局随机化(ASLR)。

代码中包含了尝试20000次利用的循环，以及100ms的延时，这些都符合漏洞分析文章的描述，增加了利用成功的可能性。

**投毒风险评估：**

此PoC代码存在一定程度的投毒风险，因为:

1.  **Shellcode:** PoC代码包含一个shellcode占位符，攻击者需要替换成真实的shellcode。如果提供的shellcode本身是恶意的，那么使用此PoC会导致投毒。
2. **glibc地址:** PoC代码包含glibc基址，攻击者需要手动调整为目标系统的基址。如果提供的基址不正确，或者根本无法确定正确的基址，会影响利用成功率。如果攻击者故意提供错误的基址或者使用错误的基址绕过策略，也有可能导致拒绝服务。
3.  **定时参数：** PoC代码中的定时参数需要根据目标系统的响应速度进行调整。如果定时不当，可能导致利用失败，甚至使目标系统崩溃。
4.  **heap布局:** OpenSSH的堆布局会随着版本的变化而变化，需要针对不同的版本进行调整。如果不调整，可能无法成功利用。

**评估：**
PoC代码的编写者可能在代码中加入不易察觉的恶意行为，例如收集目标系统信息并发送到远程服务器等。但是，考虑到PoC的主要目的是为了验证漏洞，因此这种风险相对较低。PoC中已经存在大量的需要修改的地方，需要使用者有一定的漏洞知识储备，因此投毒风险相对较低。

**综合评估**：PoC中投毒风险预估为10%，

**利用方式总结：**

1.  攻击者首先需要与目标OpenSSH服务器建立连接。
2.  然后，攻击者需要执行SSH握手协议。
3.  接着，攻击者发送特制的数据包，触发sshd中的竞争条件。
4.  竞争条件允许攻击者覆盖内存中的关键数据结构。
5.  攻击者通过覆盖的数据结构，执行预先准备好的shellcode，从而获得目标系统的root权限。
6. 利用过程需要绕过ASLR保护，这可能需要多次尝试，或者使用其他信息泄露漏洞。
7. 攻击需要一定的timing， 把握好发送数据包的时间。

**项目地址:** [lflare/cve-2024-6387-poc](https://github.com/lflare/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #22

**来源**: [CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387是一个OpenSSH服务器(sshd)中的安全回归漏洞，存在于OpenSSH 8.5p1到9.7p1版本。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。远程攻击者可以通过在设定的时间内认证失败来触发此漏洞，可能导致远程代码执行或拒绝服务。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已确认存在，并且有POC代码可用。搜索引擎结果中的多个链接指向了漏洞分析、利用和修复方法，以及相关的讨论。

**投毒风险：**
提供的POC代码包含一个Python脚本（main.py）和一个README.md文件。脚本内容主要用于识别易受攻击的OpenSSH服务器，并无发现任何恶意代码或者后门，但是不排除后续增加投毒代码的可能性, 因此投毒风险极低。

**利用方式：**
1.  攻击者需要发起大量SSH连接到目标服务器。
2.  在LoginGraceTime时间内，故意使认证失败。
3.  利用竞争条件，使sshd以不安全的方式处理信号。
4.  如果成功，攻击者可能能够执行任意代码或导致服务崩溃（拒绝服务）。

**缓解措施：**
*   将OpenSSH升级到9.8或更高版本。
*   设置`LoginGraceTime 0`可以缓解RCE，但不能完全避免DoS攻击，建议结合`fail2ban`和防火墙使用。

**项目地址:** [moften/regreSSHion-CVE-2024-6387](https://github.com/moften/regreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #23

**来源**: [CVE-2024-6387-prelearn-code_CVE-2024-6387.md](../2024/CVE-2024-6387-prelearn-code_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 远程代码执行

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行

**影响应用:** OpenSSH

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (glibc-based Linux systems)

**利用条件:** 目标系统需要运行受影响版本的OpenSSH，且基于glibc。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，也被称为"regreSSHion"，是OpenSSH服务器（sshd）中的一个安全漏洞，是CVE-2006-5051的一个回归。它是由信号处理中的竞争条件引起的。未经身份验证的远程攻击者可以通过在设定的时间内未能成功进行身份验证来触发此漏洞，可能导致以root权限执行任意代码。该漏洞影响基于glibc的Linux系统上的OpenSSH 8.5p1到9.7p1版本。

**有效性：**
根据漏洞库信息、搜索结果（特别是来自Qualys和offsec的分析），以及POC代码的存在，可以判断该漏洞是有效的，并且存在可利用的POC。

**投毒风险：**
POC代码中存在一定的投毒风险。虽然代码的目的是利用该漏洞，但攻击者可能会修改shellcode以进行恶意活动，或者在代码中加入额外的后门。例如，`shellcode`变量中包含占位符，需要替换为实际的shellcode。如果用户从不可信来源下载POC，并使用了包含恶意shellcode的POC，则可能存在投毒风险。代码中定义了多个glibc地址用于绕过ASLR，攻击者可以伪造错误的地址，来扰乱攻击。

**利用方式：**
利用方式涉及以下几个步骤：

1.  **建立连接：** 攻击者首先与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH握手过程，包括版本交换和密钥交换的初始化。
3.  **堆准备：** 发送特定的SSH数据包，以在sshd进程的堆上创建特定的内存布局，为利用创造条件。
4.  **触发竞争条件：** 攻击者触发一个竞争条件，该条件涉及OpenSSH处理信号的方式，利用SIGALRM信号处理程序中的不安全函数调用。
5.  **地址绕过：** 通过尝试多个可能的glibc基址，绕过地址空间布局随机化 (ASLR)。
6.  **执行代码：** 成功触发竞争条件后，将恶意shellcode注入到内存中并执行，从而获得远程代码执行权限（通常以root权限）。

**缓解措施包括：**
*   禁用`LoginGraceTime`参数，虽然不能完全阻止DoS，但可以防御RCE。
*   使用`fail2ban`等工具监控日志文件并管理连接。
*   及时更新到OpenSSH的修复版本。

**项目地址:** [prelearn-code/CVE-2024-6387](https://github.com/prelearn-code/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #24

**来源**: [CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md](../2024/CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，glibc-based Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387是一个OpenSSH服务器中的竞争条件漏洞（源于CVE-2006-5051的回归）。未经身份验证的远程攻击者可以通过在设定的时间内未能完成身份验证来触发此漏洞。利用方式是发送大量连接请求，触发竞争条件，在glibc-based Linux系统上可能导致在堆中插入恶意指令，最终实现远程代码执行或拒绝服务。提供的脚本并非POC，而是缓解措施：

1.  **有效性：** 提供的脚本实际上是一个缓解脚本，通过将`LoginGraceTime`设置为0来减少漏洞被利用的可能性，并不能直接验证漏洞，缓解脚本会禁用SSHD服务器在指定超时时间内未完成身份验证时断开连接的能力。虽然降低了RCE的风险，但增加了拒绝服务(DoS)的风险。

2.  **投毒风险：** 提供的脚本目的是缓解漏洞，没有发现任何隐藏的恶意代码，因此投毒风险为0%。

3.  **利用方式：** 根据漏洞信息和搜索结果，利用方式是未认证的攻击者向目标OpenSSH服务器发送大量连接请求，由于竞争条件的存在，sshd可能以不安全的方式处理信号，从而允许攻击者执行任意代码（RCE）或造成拒绝服务(DoS)。攻击成功的关键在于触发竞争条件，因此需要大量的并发连接尝试。


**项目地址:** [redux-sibi-jose/mitigate_ssh](https://github.com/redux-sibi-jose/mitigate_ssh)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #25

**来源**: [CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md](../2024/CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，并且攻击者能够建立SSH连接并触发竞争条件。攻击者需要尝试大量连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全漏洞，源于信号处理中的竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：** 根据漏洞库信息和搜索结果，此漏洞存在PoC。该漏洞的利用依赖于触发竞争条件，因此需要进行大量的连接尝试。

**投毒风险：** 分析提供的PoC代码，主要包含一个检测脚本（detection-script.py）和一个README。检测脚本尝试建立到目标SSH服务器的连接，并发送SSH协议版本字符串，然后读取服务器的响应。LICENSE文件和README.md文件是标准格式，描述了漏洞信息。由于检测脚本本身较为简单，且没有发现明显的恶意代码，因此投毒的风险较低，约为10%。 但是需要人工review所有代码.特别是二进制文件.

**利用方式：** 利用此漏洞需要：
1.  攻击者向目标服务器上的sshd服务发起大量的连接请求。
2.  在连接建立但身份验证尚未完成时，利用竞争条件触发信号处理错误。
3.  如果成功利用，攻击者可以在目标系统上执行任意代码，获得root权限（根据漏洞描述和搜索结果）。

利用的复杂性在于需要精确地控制时序，以触发竞争条件。这通常需要大量的计算资源和对目标系统行为的深入了解。同时该漏洞在glibc-based Linux systems更有效,可能无法在所有系统上利用。

**项目地址:** [s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH](https://github.com/s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #26

**来源**: [CVE-2024-6387-wiggels_regresshion-check.md](../2024/CVE-2024-6387-wiggels_regresshion-check.md)

# CVE-2024-6387

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-6387-AzrDll_CVE-2024-6387.md](../2024/CVE-2024-6387-AzrDll_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH 竞争条件导致 RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。需要发起大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务中的一个竞争条件漏洞，源于 CVE-2006-5051 的回归。未经身份验证的远程攻击者可以通过在短时间内发起大量失败的身份验证尝试来触发此漏洞。利用此漏洞需要在glibc堆中插入指令，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞确实存在，并且有公开的PoC利用代码。该PoC通过建立大量的 SSH 连接并进行不成功的身份验证来触发竞争条件。参考[webpage 3]，此漏洞允许glibc Linux发行版在堆中插入指令，从而实现代码执行。提供的PoC代码尝试利用这一点，但成功率可能较低，因为竞争条件需要精确的时间控制。

**投毒风险：**
提供的PoC代码`/tmp/fe03af2a23123389ff9785e2fb119f2c/PoC.py` 包含了从文件中读取glibc地址的功能。 虽然代码本身没有明显的恶意行为，但如果提供的 `glibc_file` 包含恶意构造的地址，可能会导致非预期的行为，甚至导致拒绝服务。例如，如果`glibc_base`地址指向了关键系统函数，覆盖该地址可能造成系统崩溃。另一个潜在的风险点是 `timing_adjustment`，如果调整不当可能造成DoS。综上所述，投毒风险为10%。主要是考虑到作者可能在利用代码的 `glibc_file` 参数中提供恶意的 glibc 地址，诱导用户使用，从而达到破坏目标系统的目的。

**利用方式：**
1.  **建立连接：** 攻击者首先建立与目标 OpenSSH 服务器的 TCP 连接。
2.  **SSH 握手：** 攻击者执行 SSH 握手过程，例如发送 SSH 版本字符串。
3.  **堆准备：** PoC尝试在堆上分配一些数据，为利用竞争条件做准备。
4.  **触发竞争条件：**  通过快速发送大量失败的身份验证请求，攻击者试图触发 `sshd` 进程中的竞争条件。这涉及利用 `LoginGraceTime` 参数，该参数允许攻击者在身份验证超时之前发送多个请求。根据[webpage 6]，利用此漏洞需要大量连接尝试才能准确触发竞争条件。
5.  **代码执行：**  如果竞争条件被成功触发，攻击者可以在内存中写入恶意代码，从而实现远程代码执行。提供的 PoC 代码尝试通过覆盖 glibc 的地址来实现这一点。如果成功利用，攻击者可以获得 root 权限，如[webpage 1][webpage 4]所描述。
6.  **拒绝服务：** 即使未能成功实现 RCE，攻击者也可能通过耗尽服务器资源来实现拒绝服务。由于竞争条件涉及信号处理，不正确的信号处理可能导致 `sshd` 崩溃。

**项目地址:** [AzrDll/CVE-2024-6387](https://github.com/AzrDll/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #2

**来源**: [CVE-2024-6387-DimaMend_cve-2024-6387-poc.md](../2024/CVE-2024-6387-DimaMend_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行(RCE)和拒绝服务(DoS)

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，并且目标系统基于glibc。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全漏洞，它是由CVE-2006-5051引入的回归错误。该漏洞是一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**利用方式：**

1.  **建立连接：** 攻击者首先与易受攻击的OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者尝试进行SSH握手，但故意不完成身份验证过程。这是为了触发`LoginGraceTime`超时。
3.  **堆准备：** 攻击者发送一系列SSH数据包，旨在操纵服务器的内存堆的布局。 这可能涉及到分配和释放内存，以便为利用创造合适的条件。
4.  **触发竞争条件：** 攻击者利用`LoginGraceTime`超时机制。当服务器由于握手超时而即将终止连接时，会发送一个信号。 攻击者尝试与此信号处理程序执行竞争，以修改服务器的内存。
5.  **代码执行：** 如果竞争成功，攻击者可以将恶意代码注入到服务器的内存中，并获得代码执行能力。 根据具体利用方式，这可能导致以root权限执行代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞的利用是可行的。许多信息源表明，存在公开可用的PoC，并且已经有人成功利用了此漏洞。 PoC代码的功能是尝试利用这个竞态条件。

**投毒风险分析：**

PoC代码中存在投毒代码的风险很低，原因如下：

*   **代码结构：** 代码主要集中于建立连接、进行SSH握手、操纵堆内存以及尝试触发竞态条件。虽然代码较为复杂，但在总体流程上没有明显的恶意操作。
*   **Shellcode占位符：** 代码中存在一个 `shellcode` 占位符，明确提示用户需要替换成实际的 shellcode。这表明作者的意图是提供一个框架，而不是一个直接可用的恶意载荷。
*   **注释和说明：** 代码包含大量的注释和说明，解释了漏洞的原理、利用方法以及需要调整的参数。这表明作者的目的是帮助研究人员理解和复现漏洞，而不是隐藏恶意代码。
*   **随机性和尝试次数：** 代码包含大量的随机尝试，目的是为了提高漏洞利用的成功率。这种随机性使得代码难以预测，也增加了作者插入恶意代码的难度。
*   **外部依赖：** 代码没有包含明显的外部依赖或网络请求，这降低了其被用于下载或执行恶意代码的风险。

虽然直接投毒的可能性较低，但仍然存在一些潜在风险，比如在 `shellcode` 占位符中插入恶意代码，或者在调整参数的过程中引入错误，导致程序行为异常。因此，在使用 PoC 代码时，仍然需要进行仔细的代码审查和安全测试。

综上所述，此仓库中存在作者隐藏的投毒代码的可能性估计为1%。

**项目地址:** [DimaMend/cve-2024-6387-poc](https://github.com/DimaMend/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #3

**来源**: [CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行存在漏洞版本的OpenSSH服务，且攻击者能够建立SSH连接，并在认证超时前发送恶意数据。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，存在于glibc的linux系统。它源于一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该漏洞是有效的。多个来源都确认了该漏洞的存在以及其远程代码执行的潜力。POC代码的存在进一步支持了其可利用性。

**投毒风险：**

POC代码本身包含以下潜在的投毒风险点：

*   **Shellcode占位符:** 代码中明确提到 `Shellcode placeholder (replace with actual shellcode)`。如果用户直接使用未经审查的 shellcode，则可能引入恶意行为。此处的风险不在于作者投毒，而在于用户使用不当。
*   **GLIBC_BASES:**  `GLIBC_BASES[]` 数组包含可能的 glibc 基地址。如果这个地址不准确，利用将失败。如果作者故意提供错误的地址，可能会导致拒绝服务或误导分析。
*   **Timing parameters:** 注释提到需要根据目标系统调整 timing 参数。错误的 timing 可能导致利用失败或系统不稳定。
*   **Heap layout 和 File structure offsets:**  代码注释中也强调了需要针对不同的 OpenSSH 和 glibc 版本进行调整，否则利用会失败。故意设置错误的值可能导致程序崩溃或产生其他未定义行为。
*   **随机数生成:** 代码使用 `srand(time(NULL))` 初始化随机数生成器。虽然这本身不是投毒，但如果后续利用中依赖于可预测的随机数，可能会被利用。

总体评估投毒风险为30%。风险主要来自于需要用户自行替换的shellcode，以及需要用户根据目标环境配置的参数。作者本身隐藏恶意代码的可能性较低，但用户在使用过程中存在引入风险的可能性。

**利用方式：**

1.  **建立连接：** 攻击者首先需要建立与目标 OpenSSH 服务器的连接。
2.  **SSH握手：** 进行初步的SSH握手过程，包括版本协商和密钥交换的初始化，但无需完成身份认证。
3.  **堆准备：**  `prepare_heap` 函数的目的是在堆上创建特定的布局，为后续的利用创造条件。具体实现细节未给出，但可能涉及分配和释放内存，以控制堆的状态。
4.  **时间测量：** `time_final_packet` 函数测量服务器处理特定数据包所需的时间。这个时间信息对于后续的竞争条件利用至关重要。
5.  **竞争条件：**  `attempt_race_condition` 函数尝试触发漏洞的核心：信号处理程序中的竞争条件。这通常涉及发送一个精心构造的数据包，该数据包会在服务器处理过程中触发 SIGALRM 信号。由于信号处理程序使用了异步信号不安全函数，因此可能导致堆损坏。
6.  **代码执行：**  如果竞争条件成功触发，攻击者就可以利用堆损坏来执行任意代码。这通常涉及覆盖函数指针或控制程序的执行流程。

该漏洞的利用依赖于精确的 timing 和对目标系统内存布局的了解。攻击者需要进行大量的尝试才能成功利用该漏洞。

**项目地址:** [HadesNull123/CVE-2024-6387_Check](https://github.com/HadesNull123/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #4

**来源**: [CVE-2024-6387-Karmakstylez_CVE-2024-6387.md](../2024/CVE-2024-6387-Karmakstylez_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器(sshd)中的一个安全回归漏洞，存在于glibc-based Linux系统。该漏洞源于信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。该漏洞利用代码尝试通过大量的连接请求触发竞争条件，通过调整glibc基地址和定时参数绕过ASLR，将恶意代码注入到堆中，最终实现以root权限远程代码执行。

有效性：根据漏洞信息和搜索结果，此POC代码具备一定的有效性，但成功利用需要满足特定条件，例如目标系统使用glibc，以及OpenSSH版本在受影响范围内。同时，漏洞利用的成功率受到系统负载、网络延迟等因素的影响，需要进行大量的尝试。

投毒风险：POC代码中存在一定的投毒风险。虽然POC代码的主要目的是利用已知的漏洞，但攻击者可能在代码中加入恶意功能，例如植入后门、收集敏感信息等。例如，shellcode 部分是明显的注入点。风险评定为10%，主要基于以下几点：
1.  **Shellcode 替换：** 代码明确指出 `shellcode` 变量是占位符，需要替换为实际的 shellcode。如果用户不小心使用了包含恶意指令的 shellcode，则可能导致投毒。
2.  **glibc 基地址猜测：** 虽然代码尝试多个 glibc 基地址，但如果攻击者预先知道目标系统的 glibc 地址，则可以修改 `GLIBC_BASES` 数组以提高利用成功率，同时也可能引入恶意地址。
3.  **Timing 参数调整：** 代码中的 `usleep` 函数用于控制连接尝试之间的延迟。攻击者可以通过调整这些参数来优化漏洞利用，但也可能引入导致拒绝服务 (DoS) 的参数。
4.  **编译选项：**POC 需要编译，攻击者可以在编译时添加额外的恶意编译选项，例如禁用安全特性等。
5.  **作者本身:** 仓库作者有投毒行为.

利用方式：
1.  攻击者首先需要确定目标系统是否运行受影响的OpenSSH版本，以及是否基于glibc。
2.  攻击者发起大量的SSH连接请求，尝试触发竞争条件。
3.  攻击者利用精心构造的数据包覆盖堆上的特定内存区域，将恶意代码注入到sshd进程中。
4.  一旦恶意代码成功执行，攻击者即可获得目标系统的控制权。

**项目地址:** [Karmakstylez/CVE-2024-6387](https://github.com/Karmakstylez/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #5

**来源**: [CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md](../2024/CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md)

## CVE-2024-6387-OpenSSH-RegreSSHion-RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行并获取 root 权限或造成拒绝服务

**影响版本:** <= 9.7p1 (受影响版本 8.5p1 至 9.7p1)

**利用条件:** 需要目标服务器运行受影响版本的OpenSSH，且存在时间窗口内的未认证连接尝试。高危利用场景依赖glibc环境。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-6387，也被称为“regreSSHion”，是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞（CVE-2006-5051）。该漏洞源于信号处理中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC已经存在，并且能够实现远程代码执行和拒绝服务攻击。很多安全厂商和研究人员都发布了相关的分析报告和PoC代码。

**投毒风险：**
提供的漏洞利用代码（/tmp/270e32ae67508359811c0f9899155269/README.md 和 LICENSE）仅仅是声明了存在POC，根据现有信息，该仓库本身存在恶意代码的风险较低。但是，由于POC的执行具有高危性，在实际使用中，仍需要进行安全审查。

**利用方式：**
1.  **竞争条件：** 攻击者通过在短时间内发起大量未认证的连接尝试，触发 `sshd` 中的竞争条件。
2.  **信号处理：** 在特定的时间窗口内，`sshd` 可能会以不安全的方式处理信号，导致内存损坏或其他异常行为。
3.  **远程代码执行/拒绝服务：**  利用内存损坏或其他异常行为，攻击者可以执行任意代码（RCE），或导致 `sshd` 崩溃，造成拒绝服务（DoS）。部分利用依赖特定的glibc环境。
4.  **ProxyCommand注入:** 根据github仓库的README.md描述，该POC利用了 `ProxyCommand` 配置不当或滥用的情况，攻击者可以注入恶意命令到 `ProxyCommand` 中，从而获得命令执行或者横向渗透的能力。

**缓解措施：**
*   升级到 OpenSSH 9.8 或更高版本。
*   设置 `LoginGraceTime 0` 以禁用在指定超时时间内未完成身份验证时服务器断开连接的功能（Red Hat 建议的临时缓解措施，但会使服务器更容易受到 DoS 攻击）。
*   使用 `fail2ban` 等工具，配合防火墙来监控日志文件并适当管理连接。

**项目地址:** [Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC](https://github.com/Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #6

**来源**: [CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md](../2024/CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）或拒绝服务（DoS）

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。它是一个竞争条件漏洞，可能导致sshd以不安全的方式处理信号。远程攻击者可以通过在设定的时间内未能成功验证身份来触发此漏洞，从而可能导致远程代码执行或拒绝服务。

**有效性评估：**

根据漏洞库信息、搜索结果以及提供的POC代码来看，此漏洞的POC是存在的，并且多个安全厂商都发布了相关的分析报告和检测方法。搜索结果也表明此漏洞允许远程未授权代码执行。

**利用方式：**

1.  攻击者建立与目标OpenSSH服务器的连接。
2.  进行SSH握手，获取服务器banner。
3.  准备堆，发送一定量的填充数据。
4.  尝试触发竞争条件，通过发送包含`glibc_base`地址的payload，并附加一些`nop`指令。
5.  如果成功，则在服务器上执行代码，获得root权限。
6.  脚本使用了多线程来增加攻击成功的几率，并对时序进行调整。

**投毒风险评估：**

提供的POC代码（`Exploit_2024_6387.py`）本身是一个漏洞利用脚本，其目的是利用目标系统的漏洞。评估投毒风险主要关注作者是否在脚本中植入了恶意代码，例如：

*   **后门代码：**  脚本在成功利用漏洞后，是否会创建一个后门，允许攻击者在未经授权的情况下再次访问系统。
*   **破坏性代码：**  脚本是否包含旨在破坏目标系统或数据的代码。
*   **信息窃取代码：**  脚本是否会窃取目标系统上的敏感信息。

分析代码发现，虽然脚本本身旨在利用漏洞，但并未发现明显的后门、破坏性或信息窃取代码。 然而，需要注意的是，该脚本的`TARGET_IP`和`TARGET_PORT`是硬编码的，在实际使用中需要进行修改。此外，攻击者可能会修改此脚本以包含恶意功能。此处的`glibc_base`地址也需要根据目标环境进行调整，否则利用大概率会失败，这也是成功利用此漏洞的难点之一。

综合来看，该仓库存在投毒风险的可能性较低，但是不排除有攻击者对代码进行修改后，二次传播。因此，建议在使用前仔细审查代码。

**风险评估：**
`poison`的百分比评估主要考虑以下几个方面：

*   **代码复杂性：** 代码越复杂，隐藏恶意代码的可能性越高。
*   **作者信誉：** 如果作者的信誉未知或可疑，则风险越高。
*   **代码审查：** 代码是否经过其他安全研究人员的审查。

根据以上分析，此脚本的`poison`风险评估为10%。

**项目地址:** [SkyGodling/CVE-2024-6387-POC](https://github.com/SkyGodling/CVE-2024-6387-POC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #7

**来源**: [CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md](../2024/CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，未认证的远程攻击者通过在设定的时间内认证失败触发

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞(CVE-2006-5051)。它存在一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，进而导致远程代码执行(RCE)或拒绝服务(DoS)。

根据搜索结果和漏洞信息，该漏洞影响glibc-based Linux系统，利用需要发起大量连接尝试来触发竞争条件。

提供的漏洞利用代码 `scanner.py` 是一个版本扫描器，并非直接利用 CVE-2024-6387。它用于检测目标 SSH 服务器的版本，并根据预定义的 CVE 列表判断是否存在已知的漏洞。该脚本通过创建 socket 连接到目标主机的 SSH 端口，然后发送一个空字节并接收服务器的响应，从中提取 OpenSSH 的版本信息。然后将提取的版本与易受攻击的版本列表进行比较。

**漏洞利用方式：**

1.  攻击者需要向目标 OpenSSH 服务器发起大量的连接请求。
2.  在连接建立后，故意触发认证失败，从而在信号处理过程中创建竞争条件。
3.  竞争条件允许攻击者在某些 glibc Linux 发行版中将指令插入堆中，进而实现远程代码执行。

**投毒风险：**

虽然脚本本身是一个版本扫描器，而不是直接的漏洞利用程序，但仍需谨慎评估其潜在的投毒风险。 代码中存在创建日志目录并记录扫描结果的行为，存在恶意修改扫描逻辑或在日志中写入恶意数据，但可能性极低。因此，评估投毒风险为1%。

**项目地址:** [ThatNotEasy/CVE-2024-6387](https://github.com/ThatNotEasy/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #8

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 远程代码执行/拒绝服务

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1，受影响版本包括8.5p1至9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且攻击者能够发起大量连接请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞，它源于 CVE-2006-5051。该漏洞是一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间段内未能通过身份验证来触发此漏洞。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的PoC代码是有效的。多个来源证实了该漏洞的存在和可利用性，特别是针对glibc的Linux系统。

**投毒风险：**

提供的PoC代码包含用于编译、构建和利用漏洞的Dockerfile和Python脚本。通过分析代码，可以发现以下潜在的投毒风险因素：

*   **依赖项：** Dockerfile中使用了`wget`和`curl`来下载OpenSSH源码，存在被中间人攻击替换为恶意源码的风险。尽管校验和可以降低这种风险，但如果攻击者能够控制构建环境，仍然可能引入恶意代码。
*   **shellcode：** Python脚本包含一个名为`shellcode`的变量，目前只是占位符，但攻击者可以修改此变量，插入恶意shellcode。攻击者可以精心构造shellcode，以执行恶意操作，例如安装后门、窃取数据或提权。

虽然这些风险存在，但从现有代码来看，没有发现明显的恶意代码。因此，评估投毒风险为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的OpenSSH环境（32位Linux系统）。
2.  **SSH握手：** 客户端与服务器建立连接，发送SSH版本信息并进行密钥交换（KEX）初始化。
3.  **堆准备：** 通过发送特定大小的数据包来布置堆内存，利用glibc的漏洞插入恶意指令。
4.  **触发竞争条件：** 大量连接尝试来触发信号处理程序中的竞争条件。
5.  **执行代码：** 成功触发竞争条件后，恶意代码将被执行，从而实现远程代码执行。

总体来说，利用方式较为复杂，需要精心构造数据包和进行大量的连接尝试才能成功。

**项目地址:** [YassDEV221608/CVE-2024-6387](https://github.com/YassDEV221608/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #9

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 9.7p1 (影响 8.5p1 到 9.7p1)

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，并且是基于glibc的Linux系统。攻击者需要能够建立到SSH服务的网络连接，并能够快速发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中发现的一个安全回归漏洞，存在于glibc的Linux系统中。该漏洞是由于OpenSSH服务器（sshd）中的信号处理存在竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用此漏洞可能导致以 root 身份远程执行代码。

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果也确认了该漏洞的存在，并描述了其可能导致远程代码执行的风险。漏洞利用代码的存在也进一步证实了漏洞的有效性，代码尝试利用竞争条件来执行任意代码。

**投毒风险：**
代码存在一定的投毒风险的可能性。虽然代码本身看起来是在尝试利用该漏洞，但以下因素需要考虑：

1.  **Shellcode占位符：** 代码中包含一个shellcode占位符`unsigned char shellcode[] = "\x90\x90\x90\x90";`，明确指示需要替换成实际的shellcode。如果用户没有意识到这一点，或者使用了恶意shellcode，可能会造成损害。这里的投毒风险在于，攻击者可能发布包含恶意shellcode的exp，诱导用户使用。 
2.  **GLIBC_BASES：** 代码中定义了`GLIBC_BASES[]`，用于绕过ASLR。如果这些地址不正确，利用将失败。更糟糕的是，如果攻击者故意提供错误的地址，可能会导致程序崩溃或其他不可预测的行为。
3.  **Timing parameters和 Heap layout 需要调整：** 代码注释中强调了定时参数和堆布局需要根据目标系统进行调整。如果这些参数设置不正确，可能会导致利用失败或目标系统不稳定。
4.  **文件结构偏移量：** 代码提到需要验证特定glibc版本的文件结构偏移量。使用错误的偏移量可能导致内存损坏或其他不可预测的行为。

总体来看，该POC的复杂性和对系统内部结构的依赖性，投毒者可以通过提供不正确的配置参数，或者引导用户使用错误的shellcode，达到破坏目标系统的目的。因此存在10%的投毒风险。

**利用方式：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **建立连接：** 攻击者首先需要与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者需要完成初始的SSH握手过程，包括协议版本交换和密钥交换初始化（KEX）。
3.  **堆准备：** 攻击者利用SSH协议发送数据包，在内存堆上布置精心构造的数据结构，为后续的漏洞利用做准备。
4.  **触发竞争条件：** 攻击者发送一个特制的SSH数据包，该数据包的设计是为了触发sshd中的竞争条件。具体来说，它利用了在身份验证失败的情况下，信号处理程序中的不安全操作。
5.  **RCE：** 成功触发竞争条件后，攻击者可以将恶意代码注入到sshd进程中，从而实现远程代码执行。具体是通过内存操作覆盖某个函数指针，使其指向攻击者提供的shellcode。
6.  **提权（Root）：** 由于sshd通常以root权限运行，因此攻击者执行的shellcode也将以root权限运行，从而完全控制目标系统。

**项目地址:** [YassDEV221608/CVE-2024-6387_PoC](https://github.com/YassDEV221608/CVE-2024-6387_PoC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #10

**来源**: [CVE-2024-6387-alex14324_ssh_poc2024.md](../2024/CVE-2024-6387-alex14324_ssh_poc2024.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）和拒绝服务（DoS）

**影响版本:** <= 9.7p1

**利用条件:** 需要目标系统开启sshd服务，且受影响的OpenSSH版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是一个存在于OpenSSH服务器（sshd）中的安全漏洞，具体来说是一个竞争条件漏洞。该漏洞源于OpenSSH处理信号的方式。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，导致sshd以不安全的方式处理信号。这可能导致远程代码执行（RCE），攻击者获得root权限，或拒绝服务（DoS），使服务器不可用。

**有效性分析：**
从漏洞库信息、搜索结果和提供的PoC代码来看，该漏洞的PoC是存在的，并且被广泛讨论和利用。 搜索结果中提到“regreSSHion (CVE-2024-6387) is an unauthenticated RCE vulnerability in OpenSSH’s server, affecting glibc-based Linux systems. Full root access is granted.” 表明该漏洞有很高的潜在影响. PoC代码也试图绕过ASLR，并包含shellcode的占位符，表明攻击者可以注入恶意代码。

**投毒风险分析：**
提供的PoC代码具有一定的投毒风险，大约为10%。主要基于以下几点：
1.  **Shellcode占位符：** 代码中包含`unsigned char shellcode[] = "\x90\x90\x90\x90";`。虽然这只是一个占位符，需要用户替换为实际的shellcode，但攻击者可能发布包含恶意shellcode的版本，诱导用户使用。
2.  **GLIBC_BASES地址：**  代码中包含了`uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`。这些地址是ASLR绕过的尝试，但如果攻击者故意提供错误的地址，可能导致利用失败或者其他未知的行为，但一般不会产生特别大的危害。
3.  **Timing参数：** 代码中需要根据目标系统响应调整Timing参数。攻击者可能提供不合适的参数，导致利用不稳定或者失败。
4.  **Heap Layout和文件结构偏移：**  代码注释中提到“Heap layout : Requires tweaking for different OpenSSH versions.” 和 “File structure offsets: Verify for the specific glibc version.”。攻击者可能故意提供错误的值，导致利用失败或者产生其他问题。

**利用方式：**
1.  **建立连接：** 攻击者首先需要与目标服务器的sshd服务建立TCP连接。
2.  **SSH握手：** 进行SSH握手，包括版本交换、密钥交换等步骤。PoC代码中的 `perform_ssh_handshake` 函数实现了这些步骤。
3.  **堆准备：** 通过发送特定的SSH数据包，在sshd进程的堆上分配内存，并控制堆的布局。`prepare_heap` 函数用于执行此操作。
4.  **时间计算：**  计算处理最终数据包所需的时间，用于后续的竞争条件利用。`time_final_packet` 函数用于执行此操作。
5.  **竞争条件利用：**  通过大量并发连接，触发sshd中的竞争条件漏洞。攻击者不断尝试进行身份验证，但故意失败，以触发SIGALRM信号处理程序。由于信号处理程序中使用了非异步信号安全的函数，可能导致内存损坏和代码执行。`attempt_race_condition` 函数用于执行此操作。
6.  **ASLR绕过：**  由于地址空间布局随机化（ASLR）的存在，攻击者需要知道glibc的基地址。PoC代码中包含了一组可能的基地址，并尝试逐个利用。
7.  **代码注入：** 成功利用竞争条件后，攻击者可以将恶意代码（shellcode）注入到sshd进程的内存中。占位符需要替换。
8.  **代码执行：**  执行注入的shellcode，从而获得服务器的root权限。

**项目地址:** [alex14324/ssh_poc2024](https://github.com/alex14324/ssh_poc2024)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #11

**来源**: [CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md](../2024/CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH服务，并允许未授权的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)。

**有效性:**
根据搜索结果和漏洞库信息，此漏洞的PoC是存在的，并且已经被公开。多个来源证实了该漏洞的存在，以及它可能导致远程代码执行。提供的“漏洞利用代码”实际上是一个缓解脚本，旨在通过升级OpenSSH版本或禁用LoginGraceTime来降低风险，而不是一个实际的利用程序。

**投毒风险:**
提供的脚本主要功能是检测并修复漏洞，但仍然存在一定的投毒风险：
*   **依赖外部源：** 脚本使用`apt-get update`和`apt-get install`命令，依赖外部软件源。如果软件源被恶意篡改，可能导致安装恶意软件包。
*   **配置修改：** 脚本会修改`/etc/ssh/sshd_config`文件，存在被恶意利用修改配置的风险。
*   **权限提升：** 脚本需要root权限运行，如果脚本被篡改，可能导致提权攻击。
综合考虑，该脚本存在一定的投毒风险，但主要风险在于依赖的外部源和配置修改，因此投毒风险评估为10%。

**利用方式:**
此漏洞的利用方式是利用 sshd 进程处理信号时的竞争条件。攻击者需要发起大量连接尝试，并在身份验证失败时触发竞争条件。成功触发后，攻击者能够在目标系统上执行任意代码。根据 offsec.com 的博客文章，此漏洞利用机会在某些 glibc Linux 发行版中，能将指令插入堆中。

**项目地址:** [almogopp/OpenSSH-CVE-2024-6387-Fix](https://github.com/almogopp/OpenSSH-CVE-2024-6387-Fix)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #12

**来源**: [CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md](../2024/CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许未授权网络访问SSH端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387 (regreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的安全回归漏洞，源于 CVE-2006-5051。这是一个竞争条件漏洞，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内身份验证失败来触发此漏洞。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经公开。多个安全厂商和研究人员已经发布了关于此漏洞的分析和PoC代码。

**投毒风险分析：**

提供的Checker.py脚本的主要功能是检测目标SSH服务器是否存在CVE-2024-6387漏洞。它通过连接到目标服务器的SSH端口并获取SSH banner信息，然后将其与已知易受攻击和已修补的版本进行比较来确定漏洞状态。 代码中没有发现任何明显的恶意或后门代码。

投毒风险评估：0%。该脚本主要用于漏洞检测，不包含任何主动利用漏洞的代码，也没有发现作者隐藏的恶意代码。

**利用方式分析：**

1.  **漏洞原理：** 漏洞是由于 OpenSSH 在处理信号时存在竞争条件，允许在身份验证失败期间执行恶意代码。
2.  **攻击步骤：** 攻击者需要向目标服务器发起大量的SSH连接尝试。
3.  **触发条件：** 在连接尝试期间，攻击者故意使身份验证失败，触发竞争条件。
4.  **利用结果：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码，以root权限运行，或者造成拒绝服务攻击。
5.  **缓解措施：** 通过设置 `LoginGraceTime 0` 禁用 `LoginGraceTime` 参数可以缓解远程代码执行的风险，但仍然存在拒绝服务的风险。更新到OpenSSH 9.8或更高版本是完整的修复方案。

**项目地址:** [anhvutuan/CVE-2024-6387-poc-1](https://github.com/anhvutuan/CVE-2024-6387-poc-1)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #13

**来源**: [CVE-2024-6387-awusan125_test_for6387.md](../2024/CVE-2024-6387-awusan125_test_for6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要目标系统基于 glibc，且 OpenSSH 版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理程序中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用可能允许攻击者在目标系统上以 root 权限执行任意代码或导致拒绝服务。

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞的 PoC 已被公开，并且漏洞利用的复杂性较高。搜索结果表明，该漏洞影响 glibc 基础的 Linux 系统。提供的 POC 代码似乎旨在利用此漏洞。

**投毒风险分析：**
该 POC 代码中存在一定的投毒风险，大约 20%。原因如下：
*   **Shellcode 占位符:** 代码中包含 `unsigned char shellcode[] = "\x90\x90\x90\x90";` 这一行，明确指出需要替换为实际的 shellcode。如果用户不小心使用了该占位符，或者植入了其他有害 shellcode，则可能导致不可预期的后果。
*   **GLIBC 基地址硬编码:** 代码中定义了 `uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`，并表示 “Needs adjustment for specific target systems”。如果 GLIBC 基地址不正确，可能导致利用失败，甚至造成程序崩溃。攻击者可能会故意提供错误的基地址，使得用户在尝试利用时受到干扰，或者执行其他恶意操作。
*   **Timing 参数需要微调:** 代码注释中提到 “Timing parameters: Fine-tune based on target system responsiveness”。如果 timing 参数设置不当，可能导致竞争条件无法触发，或者引发其他问题。攻击者可能会提供误导性的 timing 参数，使得用户在尝试利用时遇到困难，或者触发非预期的行为。
*   **Heap 布局和文件结构偏移量:** 代码注释提到 “Heap layout : Requires tweaking for different OpenSSH versions” 和 “File structure offsets: Verify for the specific glibc version.” 这表示该漏洞利用依赖于特定的堆布局和文件结构偏移量。如果这些值不正确，则可能导致利用失败，甚至造成程序崩溃。攻击者可能会提供不兼容的值，使得用户在尝试利用时受到干扰，或者触发非预期的行为。
*   **错误处理不完善:** 代码中虽然包含了一些错误处理逻辑，但可能存在未处理的异常情况。攻击者可能会利用这些漏洞，使得程序在特定条件下崩溃或执行非预期的操作。

**利用方式：**
利用方式主要涉及以下步骤：
1.  **建立连接：** 与目标 SSH 服务器建立 TCP 连接。
2.  **SSH 握手：** 执行 SSH 握手过程，包括版本交换和密钥交换。
3.  **堆准备：** 通过发送特定的数据包，在堆上创建特定的布局。
4.  **时间控制：** 精确控制数据包的发送时间，以便触发竞争条件。
5.  **竞争条件触发：** 通过大量连接尝试和认证失败，利用信号处理程序的竞争条件在内存中注入恶意代码，通常包括修改 glibc 的数据结构。
6.  **代码执行：** 利用注入的恶意代码来执行任意命令。
7.  **绕过 ASLR：** 由于地址空间布局随机化 (ASLR) 的存在，需要确定 glibc 的基地址。PoC 代码中尝试了几个常见的基地址。

总体而言，该漏洞利用较为复杂，需要对 SSH 协议、glibc 内部机制和竞争条件有深入的了解。该漏洞的成功利用还依赖于目标系统的特定配置和状态。

**项目地址:** [awusan125/test_for6387](https://github.com/awusan125/test_for6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #14

**来源**: [CVE-2024-6387-dream434_CVE-2024-6387.md](../2024/CVE-2024-6387-dream434_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，目标系统运行受影响的OpenSSH版本，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性评估：**

根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已经被广泛讨论。漏洞利用代码的脚本主要用于检测目标主机是否运行存在漏洞的OpenSSH版本，利用方式是扫描目标IP的22端口，获取OpenSSH版本信息，并与已知的易受攻击版本进行比较，从而判断目标系统是否存在漏洞。

**投毒风险分析：**

提供的漏洞利用代码（CVE-2024-6387.py）主要用于版本检测，功能相对简单。虽然`README.md`中包含克隆GitHub仓库的操作，但直接分析提供的Python脚本，发现潜在的投毒点在于以下几个方面：

1.  **依赖包风险：** 脚本本身依赖较少，但如果`README.md`引导用户安装额外的依赖包（例如通过`pip install -r requirements.txt`，而`requirements.txt`包含恶意包），则可能存在投毒风险。
2.  **命令执行风险：** `README.md` 中的运行命令 `python CVE-2024-6387.py http://exemple.com` 虽然看起来无害，但如果 `CVE-2024-6387.py` 存在漏洞，允许通过命令行参数执行恶意代码，则存在风险。当前提供的代码没有直接利用命令行参数执行代码的逻辑。
3.  **文件包含风险：** 如果脚本尝试动态加载其他文件（例如配置文件），而这些文件被篡改，则可能存在风险。

鉴于以上分析，以及`README.md`中存在引导用户克隆github仓库的操作，综合判断，存在较低的投毒风险，约为10%。主要基于假设恶意代码可能存在于被克隆仓库的其他文件中，或者存在利用脚本漏洞执行恶意代码的可能。

**漏洞利用方式：**

1.  **版本检测：** 攻击者首先需要确定目标系统上运行的OpenSSH版本是否在受影响的范围内（8.5p1 <= version <= 9.7p1）。
2.  **触发竞争条件：** 攻击者通过与目标SSH服务器建立连接，并在身份验证过程中故意失败，以触发漏洞相关的竞争条件。
3.  **代码执行：** 成功触发竞争条件后，攻击者可以利用该漏洞在目标系统上执行任意代码，通常以root权限执行。

搜索结果也表明，此漏洞允许未经身份验证的远程代码执行，并且影响基于glibc的Linux系统。因此，利用方式的核心在于触发竞争条件并利用glibc的特性来执行恶意代码。

**项目地址:** [dream434/CVE-2024-6387](https://github.com/dream434/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #15

**来源**: [CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标主机开启SSH服务，且攻击者能够发起大量连接尝试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是一个OpenSSH服务器中的竞争条件漏洞。它源于OpenSSH处理信号的方式，当SSH服务器在短时间内收到大量连接请求且认证失败时，可能导致信号处理不当，进而允许未经验证的远程攻击者在基于glibc的Linux系统上执行任意代码，获取root权限，或者导致拒绝服务。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC已发布，表明漏洞可被利用。提供的Python脚本`CVE-2024-6387-Vulnerability-Checker.py`是一个漏洞检测工具，通过检查SSH banner版本来判断目标是否存在漏洞。脚本本身并不能直接利用该漏洞进行RCE或DoS攻击，而是用来辅助确认目标系统是否在受影响的范围内。

**投毒风险：**
该Python脚本主要功能是检查OpenSSH版本，判断其是否在受影响的范围内。代码本身只包含版本检测逻辑，没有发现任何恶意代码或后门，因此投毒风险极低。可以认为投毒风险为0%。

**利用方式：**
1.  **版本检测：** 使用PoC脚本或类似工具检测目标SSH服务器的版本，确认其是否位于易受攻击的范围(8.5p1 <= OpenSSH <= 9.7p1)。
2.  **触发竞争条件：** 如果目标版本易受攻击，攻击者需要发起大量连接尝试，并在短时间内故意认证失败，以触发竞争条件。
3.  **代码执行（或DoS）：** 成功触发竞争条件后，利用glibc的堆操作特性，攻击者可以插入恶意指令到堆中，从而实现远程代码执行。另一种利用方式是耗尽服务器资源，造成拒绝服务攻击。

需要注意的是，利用此漏洞进行RCE需要对glibc堆操作有一定的了解，并且成功率可能不高。缓解措施包括禁用`LoginGraceTime`配置，并使用`fail2ban`等工具限制恶意连接。

**项目地址:** [filipi86/CVE-2024-6387-Vulnerability-Checker](https://github.com/filipi86/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #16

**来源**: [CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-regreSSHion

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1 (OpenSSH)

**利用条件:** 需要glibc-based Linux系统，以及OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞。漏洞源于OpenSSH服务器处理信号的方式存在问题，具体来说，当用户认证失败时，可能触发不安全的信号处理。远程攻击者可以通过在短时间内发起大量SSH连接尝试，并故意触发认证失败，从而引发竞争条件，最终可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据搜索结果（webpage 1, 3, 4, 5, 7, 8）和漏洞库信息，该漏洞已被确认为一个高危漏洞，并且存在公开的PoC（Proof of Concept）代码。虽然提供的POC代码只是一个包含漏洞描述的README.md文件，**不能直接运行，但是，github上存在可利用的POC**。该POC的有效性取决于目标系统是否满足漏洞利用的条件，即：
1.  使用受影响的OpenSSH版本（<= 9.7p1）。
2.  目标系统是基于glibc的Linux发行版。
3.  系统配置允许一定数量的并发连接。

**投毒风险：**
提供的POC代码（README.md）本身不包含任何可执行代码，因此直接的投毒风险很低。但需要注意的是，任何从互联网上下载的代码都存在潜在的风险。即使是看似无害的文档，也可能包含恶意链接或指令，引导用户下载或执行恶意代码。因此，下载和使用任何PoC代码时，都应该保持警惕，并进行充分的安全审查。

虽然提供的README.md文件本身投毒风险较低,但是考虑到实际利用中需要依赖其他EXP, 因此其他仓库被投毒的可能性相对较高。
风险评估：10%

**利用方式：**
根据漏洞描述和搜索结果，利用方式主要包括以下几个步骤：
1.  **大量连接请求：** 攻击者向目标OpenSSH服务器发起大量的并发连接请求。
2.  **触发认证失败：**  在连接请求中，故意提供错误的用户名或密码，触发认证失败事件。
3.  **竞争条件利用：**  通过大量认证失败事件，触发OpenSSH服务器中的竞争条件漏洞。
4.  **代码执行或DoS：** 成功利用漏洞后，攻击者可以执行任意代码（RCE）或导致服务器崩溃（DoS）。

需要注意的是，利用该漏洞需要一定的资源和技术，并且成功率可能不高。Red Hat 在其安全公告中指出，实现RCE需要相当多的资源投入。同时，修改sshd_config,设置LoginGraceTime为0可以有效避免远程代码执行，但仍存在拒绝服务风险.

**项目地址:** [identity-threat-labs/Article-RegreSSHion-CVE-2024-6387](https://github.com/identity-threat-labs/Article-RegreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #17

**来源**: [CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，sshd服务运行且存在于受影响版本范围内，目标系统是基于glibc的Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中发现的竞争条件漏洞。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发该漏洞。成功利用可能导致以root权限远程执行代码或拒绝服务。该漏洞的利用依赖于触发信号处理程序的竞争条件，攻击者需要发起大量连接尝试才能提高触发漏洞的几率。提供的PoC代码是一个漏洞验证工具，用于检测目标系统上运行的OpenSSH版本是否存在漏洞。它通过连接到目标SSH端口并检查SSH横幅来工作。如果横幅指示易受攻击的版本，则该工具会将目标标记为易受攻击。PoC代码本身似乎不包含任何明显的投毒代码。它仅仅用于验证漏洞是否存在，并不会主动进行利用。

**利用方式：**

1.  攻击者向目标服务器的SSH端口发起大量连接请求。
2.  连接请求需要故意失败，例如提供无效的用户名或密码，以便触发身份验证失败流程。
3.  攻击者利用OpenSSH处理信号时的竞争条件，将恶意指令插入堆中。
4.  如果竞争条件利用成功，攻击者即可在目标系统上以root权限执行任意代码或导致拒绝服务。

**项目地址:** [identity-threat-labs/CVE-2024-6387-Vulnerability-Checker](https://github.com/identity-threat-labs/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #18

**来源**: [CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md](../2024/CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统使用受影响的OpenSSH版本，基于glibc的Linux系统，且未禁用LoginGraceTime

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是一个存在于OpenSSH服务器(sshd)中的竞争条件漏洞。该漏洞源于OpenSSH在处理信号时存在不安全行为。远程攻击者通过在一定时间内认证失败，可以触发此漏洞，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**漏洞利用方式：**

1.  攻击者向目标服务器发起大量的SSH连接请求。
2.  在SSH认证过程中，攻击者故意使认证失败，触发LoginGraceTime超时。
3.  由于竞争条件，sshd可能在处理SIGALRM信号时进入不安全状态。
4.  在glibc-based的Linux系统上，这种不安全状态可能允许攻击者将指令插入到堆中，最终导致RCE。
5.  如果无法实现RCE，攻击者可以通过耗尽服务器资源，导致DoS。

**POC代码分析：**

提供的PoC代码`/tmp/d7c5471d195cdec17d8f4ebaf7516058/CVE-2024-6387_poc.py`的主要功能是检测目标SSH服务器的版本，判断其是否受CVE-2024-6387漏洞影响。它通过建立socket连接，发送`\x00`，接收SSH版本信息，并进行正则匹配来确定OpenSSH的版本。如果版本在易受攻击的范围内（8.5 <= 版本 < 9.8）,则输出目标系统可能存在漏洞。该PoC本身**不包含直接利用漏洞的代码**，仅仅用于版本检测。

`/tmp/d7c5471d195cdec17d8f4ebaf7516058/README.md` 提供了一个使用说明，介绍了如何使用该PoC。`/tmp/d7c5471d195cdec17d8f4ebaf7516058/ip-addr.list`包含需要检查的IP地址列表, 127.0.0.1是示例.

**有效性：**

提供的POC代码的**有效性在于验证目标系统是否存在漏洞**，而非直接利用该漏洞。根据搜索结果和漏洞描述，完整的漏洞利用需要更复杂的步骤和技术，例如大量连接尝试来触发竞争条件，以及精心构造的shellcode。因此，此PoC仅仅是前期验证步骤。

**投毒风险：**

该仓库中存在**投毒风险的可能性较低，约为10%**。PoC代码主要功能是版本检测，本身没有发现恶意代码。潜在的风险可能存在于：

*   `ip-addr.list`文件：虽然当前提供的`ip-addr.list`文件只包含本地地址`127.0.0.1`, 如果用户不小心使用了作者预先设定的其他IP地址列表，可能会导致未授权的扫描或攻击行为。
*   `session.log`文件：虽然日志记录本身不是恶意行为，但如果日志文件被上传或泄露，可能暴露用户的扫描目标信息。日志信息包含IP和端口信息。
*   在实际利用该漏洞时，如果攻击者使用了恶意的Payload，可能会对目标系统造成更大的危害。这些Payload可能被伪装成无害的代码，从而绕过安全检测。
*   如果作者在其他未公开的分支或版本中包含了恶意代码，并且诱导用户使用这些版本，则存在更高的投毒风险。

**综上所述，**虽然提供的PoC代码本身不包含明显的恶意代码，但用户在使用时仍然需要保持警惕，仔细审查代码，并确保从可信的来源获取代码，避免潜在的投毒风险。

**项目地址:** [jocker2410/CVE-2024-6387_poc](https://github.com/jocker2410/CVE-2024-6387_poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #19

**来源**: [CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：**

从搜索结果和漏洞库信息来看，该漏洞存在可利用的POC。提供的Rust代码是一个漏洞检查器，它通过连接到SSH服务器并读取SSH banner来判断目标服务器是否运行着存在漏洞的OpenSSH版本。

**投毒风险：**

提供的代码是一个漏洞检测工具，用于检查目标系统是否存在CVE-2024-6387漏洞。代码功能相对清晰，主要包括：

*   定义了易受攻击和已修补的版本列表。
*   通过TCP连接获取SSH banner。
*   将获取的banner与已知易受攻击的版本进行比较。

代码中没有发现恶意行为，例如执行系统命令或上传/下载文件。因此，**投毒风险较低，判断为0%**。

**利用方式：**

根据漏洞信息和搜索结果，攻击者需要发起大量的连接尝试，以触发sshd中的竞争条件。成功利用该漏洞可能允许攻击者在目标系统上执行任意代码或导致拒绝服务。Offsec的博客提供了关于如何利用该漏洞的更详细的解释。

**总结：**

CVE-2024-6387是一个严重的安全漏洞，允许未经身份验证的攻击者远程执行代码。虽然利用该漏洞需要一定的资源和技术，但由于存在公开的POC，因此建议尽快更新OpenSSH版本。

**项目地址:** [kubota/CVE-2024-6387-Vulnerability-Checker](https://github.com/kubota/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #20

**来源**: [CVE-2024-6387-l-urk_CVE-2024-6387.md](../2024/CVE-2024-6387-l-urk_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH regreSSHion 远程代码执行漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** OpenSSH

**危害等级:** 高危，未授权的远程攻击者可以利用此漏洞以 root 权限执行任意代码，或者造成拒绝服务。

**影响版本:** 8.5p1 ~ 9.7p1

**利用条件:** 目标系统使用受影响的 OpenSSH 版本, 并且基于 glibc 的 Linux 系统。需要网络连通性, 且攻击者需要能够发起大量的 SSH 连接尝试。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，又名 regreSSHion，是 OpenSSH 服务器中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件漏洞，允许未经身份验证的远程攻击者在基于 glibc 的 Linux 系统上执行任意代码。漏洞的利用方式涉及发起大量的 SSH 连接尝试，触发 sshd 进程中的竞争条件，从而允许攻击者将指令插入堆中，最终实现 RCE。

**有效性：**
从搜索结果和漏洞库信息来看，此漏洞是真实存在的，并且存在公开可用的 PoC 代码。PoC 代码的描述也与漏洞描述一致，表明其具有较高的有效性。

**投毒风险：**
提供的 POC 代码库中的 `LISCENCE` 文件声明了严格的权限限制，这在一定程度上增加了投毒的可能性。虽然无法通过现有信息完全确定是否存在投毒代码，但需要对脚本进行仔细审查，特别注意以下几个方面：

*   **shellcode:**  分析 shellcode 的行为，确保其功能与漏洞利用目的相符，没有恶意行为。
*   **网络连接:**  检查代码中是否存在额外的网络连接，特别是连接到未知或可疑的 IP 地址。
*   **文件操作:**  检查代码中是否存在对系统文件的修改或删除操作。
*   **依赖项:**  审查 `requirements.txt` 文件中的依赖项，确保没有引入恶意的第三方库。

考虑到需要大量连接尝试和对堆的操纵，以及许可证的严格声明，综合评估投毒风险为10%。这部分代码逻辑比较复杂，存在隐藏恶意代码的可能性。

**利用方式：**
1.  攻击者通过网络向目标 OpenSSH 服务器发起大量的连接请求。
2.  利用 OpenSSH 服务器处理连接请求时存在的竞争条件，特别是在信号处理方面。
3.  通过精心构造的数据包，将恶意代码注入到服务器的堆内存中。
4.  触发执行注入的恶意代码，从而获得对目标系统的控制权 (RCE) 或导致拒绝服务 (DoS)。
5.  默认的shellcode打开9999端口,并使用nc进行监听。

**项目地址:** [l-urk/CVE-2024-6387](https://github.com/l-urk/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #21

**来源**: [CVE-2024-6387-lflare_cve-2024-6387-poc.md](../2024/CVE-2024-6387-lflare_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是OpenSSH服务器(sshd)中的一个竞争条件漏洞，源于CVE-2006-5051的安全回归。当sshd在不安全的方式下处理某些信号时，未经验证的远程攻击者可能通过在设定的时间内未能成功验证身份来触发此漏洞。

**有效性评估：**
根据漏洞信息和搜索结果，此漏洞的PoC已经发布，并且被广泛讨论，证明了其有效性。PoC代码（`7etsuo-regreSSHion.c`）尝试利用此漏洞，通过以下步骤：

1.  **连接建立：** 与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH协议握手。
3.  **堆准备：** 准备堆布局以进行利用。
4.  **时间测量：** 测量数据包解析时间。
5.  **竞争条件尝试：** 尝试触发竞争条件，利用信号处理中的不安全函数调用，最终目标是执行shellcode，提权至root。
6.  **ASLR绕过：**尝试不同的glibc基地址，以绕过地址空间布局随机化(ASLR)。

代码中包含了尝试20000次利用的循环，以及100ms的延时，这些都符合漏洞分析文章的描述，增加了利用成功的可能性。

**投毒风险评估：**

此PoC代码存在一定程度的投毒风险，因为:

1.  **Shellcode:** PoC代码包含一个shellcode占位符，攻击者需要替换成真实的shellcode。如果提供的shellcode本身是恶意的，那么使用此PoC会导致投毒。
2. **glibc地址:** PoC代码包含glibc基址，攻击者需要手动调整为目标系统的基址。如果提供的基址不正确，或者根本无法确定正确的基址，会影响利用成功率。如果攻击者故意提供错误的基址或者使用错误的基址绕过策略，也有可能导致拒绝服务。
3.  **定时参数：** PoC代码中的定时参数需要根据目标系统的响应速度进行调整。如果定时不当，可能导致利用失败，甚至使目标系统崩溃。
4.  **heap布局:** OpenSSH的堆布局会随着版本的变化而变化，需要针对不同的版本进行调整。如果不调整，可能无法成功利用。

**评估：**
PoC代码的编写者可能在代码中加入不易察觉的恶意行为，例如收集目标系统信息并发送到远程服务器等。但是，考虑到PoC的主要目的是为了验证漏洞，因此这种风险相对较低。PoC中已经存在大量的需要修改的地方，需要使用者有一定的漏洞知识储备，因此投毒风险相对较低。

**综合评估**：PoC中投毒风险预估为10%，

**利用方式总结：**

1.  攻击者首先需要与目标OpenSSH服务器建立连接。
2.  然后，攻击者需要执行SSH握手协议。
3.  接着，攻击者发送特制的数据包，触发sshd中的竞争条件。
4.  竞争条件允许攻击者覆盖内存中的关键数据结构。
5.  攻击者通过覆盖的数据结构，执行预先准备好的shellcode，从而获得目标系统的root权限。
6. 利用过程需要绕过ASLR保护，这可能需要多次尝试，或者使用其他信息泄露漏洞。
7. 攻击需要一定的timing， 把握好发送数据包的时间。

**项目地址:** [lflare/cve-2024-6387-poc](https://github.com/lflare/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #22

**来源**: [CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387是一个OpenSSH服务器(sshd)中的安全回归漏洞，存在于OpenSSH 8.5p1到9.7p1版本。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。远程攻击者可以通过在设定的时间内认证失败来触发此漏洞，可能导致远程代码执行或拒绝服务。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已确认存在，并且有POC代码可用。搜索引擎结果中的多个链接指向了漏洞分析、利用和修复方法，以及相关的讨论。

**投毒风险：**
提供的POC代码包含一个Python脚本（main.py）和一个README.md文件。脚本内容主要用于识别易受攻击的OpenSSH服务器，并无发现任何恶意代码或者后门，但是不排除后续增加投毒代码的可能性, 因此投毒风险极低。

**利用方式：**
1.  攻击者需要发起大量SSH连接到目标服务器。
2.  在LoginGraceTime时间内，故意使认证失败。
3.  利用竞争条件，使sshd以不安全的方式处理信号。
4.  如果成功，攻击者可能能够执行任意代码或导致服务崩溃（拒绝服务）。

**缓解措施：**
*   将OpenSSH升级到9.8或更高版本。
*   设置`LoginGraceTime 0`可以缓解RCE，但不能完全避免DoS攻击，建议结合`fail2ban`和防火墙使用。

**项目地址:** [moften/regreSSHion-CVE-2024-6387](https://github.com/moften/regreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #23

**来源**: [CVE-2024-6387-prelearn-code_CVE-2024-6387.md](../2024/CVE-2024-6387-prelearn-code_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 远程代码执行

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行

**影响应用:** OpenSSH

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (glibc-based Linux systems)

**利用条件:** 目标系统需要运行受影响版本的OpenSSH，且基于glibc。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，也被称为"regreSSHion"，是OpenSSH服务器（sshd）中的一个安全漏洞，是CVE-2006-5051的一个回归。它是由信号处理中的竞争条件引起的。未经身份验证的远程攻击者可以通过在设定的时间内未能成功进行身份验证来触发此漏洞，可能导致以root权限执行任意代码。该漏洞影响基于glibc的Linux系统上的OpenSSH 8.5p1到9.7p1版本。

**有效性：**
根据漏洞库信息、搜索结果（特别是来自Qualys和offsec的分析），以及POC代码的存在，可以判断该漏洞是有效的，并且存在可利用的POC。

**投毒风险：**
POC代码中存在一定的投毒风险。虽然代码的目的是利用该漏洞，但攻击者可能会修改shellcode以进行恶意活动，或者在代码中加入额外的后门。例如，`shellcode`变量中包含占位符，需要替换为实际的shellcode。如果用户从不可信来源下载POC，并使用了包含恶意shellcode的POC，则可能存在投毒风险。代码中定义了多个glibc地址用于绕过ASLR，攻击者可以伪造错误的地址，来扰乱攻击。

**利用方式：**
利用方式涉及以下几个步骤：

1.  **建立连接：** 攻击者首先与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH握手过程，包括版本交换和密钥交换的初始化。
3.  **堆准备：** 发送特定的SSH数据包，以在sshd进程的堆上创建特定的内存布局，为利用创造条件。
4.  **触发竞争条件：** 攻击者触发一个竞争条件，该条件涉及OpenSSH处理信号的方式，利用SIGALRM信号处理程序中的不安全函数调用。
5.  **地址绕过：** 通过尝试多个可能的glibc基址，绕过地址空间布局随机化 (ASLR)。
6.  **执行代码：** 成功触发竞争条件后，将恶意shellcode注入到内存中并执行，从而获得远程代码执行权限（通常以root权限）。

**缓解措施包括：**
*   禁用`LoginGraceTime`参数，虽然不能完全阻止DoS，但可以防御RCE。
*   使用`fail2ban`等工具监控日志文件并管理连接。
*   及时更新到OpenSSH的修复版本。

**项目地址:** [prelearn-code/CVE-2024-6387](https://github.com/prelearn-code/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #24

**来源**: [CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md](../2024/CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，glibc-based Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387是一个OpenSSH服务器中的竞争条件漏洞（源于CVE-2006-5051的回归）。未经身份验证的远程攻击者可以通过在设定的时间内未能完成身份验证来触发此漏洞。利用方式是发送大量连接请求，触发竞争条件，在glibc-based Linux系统上可能导致在堆中插入恶意指令，最终实现远程代码执行或拒绝服务。提供的脚本并非POC，而是缓解措施：

1.  **有效性：** 提供的脚本实际上是一个缓解脚本，通过将`LoginGraceTime`设置为0来减少漏洞被利用的可能性，并不能直接验证漏洞，缓解脚本会禁用SSHD服务器在指定超时时间内未完成身份验证时断开连接的能力。虽然降低了RCE的风险，但增加了拒绝服务(DoS)的风险。

2.  **投毒风险：** 提供的脚本目的是缓解漏洞，没有发现任何隐藏的恶意代码，因此投毒风险为0%。

3.  **利用方式：** 根据漏洞信息和搜索结果，利用方式是未认证的攻击者向目标OpenSSH服务器发送大量连接请求，由于竞争条件的存在，sshd可能以不安全的方式处理信号，从而允许攻击者执行任意代码（RCE）或造成拒绝服务(DoS)。攻击成功的关键在于触发竞争条件，因此需要大量的并发连接尝试。


**项目地址:** [redux-sibi-jose/mitigate_ssh](https://github.com/redux-sibi-jose/mitigate_ssh)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #25

**来源**: [CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md](../2024/CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，并且攻击者能够建立SSH连接并触发竞争条件。攻击者需要尝试大量连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全漏洞，源于信号处理中的竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：** 根据漏洞库信息和搜索结果，此漏洞存在PoC。该漏洞的利用依赖于触发竞争条件，因此需要进行大量的连接尝试。

**投毒风险：** 分析提供的PoC代码，主要包含一个检测脚本（detection-script.py）和一个README。检测脚本尝试建立到目标SSH服务器的连接，并发送SSH协议版本字符串，然后读取服务器的响应。LICENSE文件和README.md文件是标准格式，描述了漏洞信息。由于检测脚本本身较为简单，且没有发现明显的恶意代码，因此投毒的风险较低，约为10%。 但是需要人工review所有代码.特别是二进制文件.

**利用方式：** 利用此漏洞需要：
1.  攻击者向目标服务器上的sshd服务发起大量的连接请求。
2.  在连接建立但身份验证尚未完成时，利用竞争条件触发信号处理错误。
3.  如果成功利用，攻击者可以在目标系统上执行任意代码，获得root权限（根据漏洞描述和搜索结果）。

利用的复杂性在于需要精确地控制时序，以触发竞争条件。这通常需要大量的计算资源和对目标系统行为的深入了解。同时该漏洞在glibc-based Linux systems更有效,可能无法在所有系统上利用。

**项目地址:** [s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH](https://github.com/s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #26

**来源**: [CVE-2024-6387-wiggels_regresshion-check.md](../2024/CVE-2024-6387-wiggels_regresshion-check.md)

# CVE-2024-6387

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-6387-AzrDll_CVE-2024-6387.md](../2024/CVE-2024-6387-AzrDll_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH 竞争条件导致 RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。需要发起大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务中的一个竞争条件漏洞，源于 CVE-2006-5051 的回归。未经身份验证的远程攻击者可以通过在短时间内发起大量失败的身份验证尝试来触发此漏洞。利用此漏洞需要在glibc堆中插入指令，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞确实存在，并且有公开的PoC利用代码。该PoC通过建立大量的 SSH 连接并进行不成功的身份验证来触发竞争条件。参考[webpage 3]，此漏洞允许glibc Linux发行版在堆中插入指令，从而实现代码执行。提供的PoC代码尝试利用这一点，但成功率可能较低，因为竞争条件需要精确的时间控制。

**投毒风险：**
提供的PoC代码`/tmp/fe03af2a23123389ff9785e2fb119f2c/PoC.py` 包含了从文件中读取glibc地址的功能。 虽然代码本身没有明显的恶意行为，但如果提供的 `glibc_file` 包含恶意构造的地址，可能会导致非预期的行为，甚至导致拒绝服务。例如，如果`glibc_base`地址指向了关键系统函数，覆盖该地址可能造成系统崩溃。另一个潜在的风险点是 `timing_adjustment`，如果调整不当可能造成DoS。综上所述，投毒风险为10%。主要是考虑到作者可能在利用代码的 `glibc_file` 参数中提供恶意的 glibc 地址，诱导用户使用，从而达到破坏目标系统的目的。

**利用方式：**
1.  **建立连接：** 攻击者首先建立与目标 OpenSSH 服务器的 TCP 连接。
2.  **SSH 握手：** 攻击者执行 SSH 握手过程，例如发送 SSH 版本字符串。
3.  **堆准备：** PoC尝试在堆上分配一些数据，为利用竞争条件做准备。
4.  **触发竞争条件：**  通过快速发送大量失败的身份验证请求，攻击者试图触发 `sshd` 进程中的竞争条件。这涉及利用 `LoginGraceTime` 参数，该参数允许攻击者在身份验证超时之前发送多个请求。根据[webpage 6]，利用此漏洞需要大量连接尝试才能准确触发竞争条件。
5.  **代码执行：**  如果竞争条件被成功触发，攻击者可以在内存中写入恶意代码，从而实现远程代码执行。提供的 PoC 代码尝试通过覆盖 glibc 的地址来实现这一点。如果成功利用，攻击者可以获得 root 权限，如[webpage 1][webpage 4]所描述。
6.  **拒绝服务：** 即使未能成功实现 RCE，攻击者也可能通过耗尽服务器资源来实现拒绝服务。由于竞争条件涉及信号处理，不正确的信号处理可能导致 `sshd` 崩溃。

**项目地址:** [AzrDll/CVE-2024-6387](https://github.com/AzrDll/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #2

**来源**: [CVE-2024-6387-DimaMend_cve-2024-6387-poc.md](../2024/CVE-2024-6387-DimaMend_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行(RCE)和拒绝服务(DoS)

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，并且目标系统基于glibc。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全漏洞，它是由CVE-2006-5051引入的回归错误。该漏洞是一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**利用方式：**

1.  **建立连接：** 攻击者首先与易受攻击的OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者尝试进行SSH握手，但故意不完成身份验证过程。这是为了触发`LoginGraceTime`超时。
3.  **堆准备：** 攻击者发送一系列SSH数据包，旨在操纵服务器的内存堆的布局。 这可能涉及到分配和释放内存，以便为利用创造合适的条件。
4.  **触发竞争条件：** 攻击者利用`LoginGraceTime`超时机制。当服务器由于握手超时而即将终止连接时，会发送一个信号。 攻击者尝试与此信号处理程序执行竞争，以修改服务器的内存。
5.  **代码执行：** 如果竞争成功，攻击者可以将恶意代码注入到服务器的内存中，并获得代码执行能力。 根据具体利用方式，这可能导致以root权限执行代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞的利用是可行的。许多信息源表明，存在公开可用的PoC，并且已经有人成功利用了此漏洞。 PoC代码的功能是尝试利用这个竞态条件。

**投毒风险分析：**

PoC代码中存在投毒代码的风险很低，原因如下：

*   **代码结构：** 代码主要集中于建立连接、进行SSH握手、操纵堆内存以及尝试触发竞态条件。虽然代码较为复杂，但在总体流程上没有明显的恶意操作。
*   **Shellcode占位符：** 代码中存在一个 `shellcode` 占位符，明确提示用户需要替换成实际的 shellcode。这表明作者的意图是提供一个框架，而不是一个直接可用的恶意载荷。
*   **注释和说明：** 代码包含大量的注释和说明，解释了漏洞的原理、利用方法以及需要调整的参数。这表明作者的目的是帮助研究人员理解和复现漏洞，而不是隐藏恶意代码。
*   **随机性和尝试次数：** 代码包含大量的随机尝试，目的是为了提高漏洞利用的成功率。这种随机性使得代码难以预测，也增加了作者插入恶意代码的难度。
*   **外部依赖：** 代码没有包含明显的外部依赖或网络请求，这降低了其被用于下载或执行恶意代码的风险。

虽然直接投毒的可能性较低，但仍然存在一些潜在风险，比如在 `shellcode` 占位符中插入恶意代码，或者在调整参数的过程中引入错误，导致程序行为异常。因此，在使用 PoC 代码时，仍然需要进行仔细的代码审查和安全测试。

综上所述，此仓库中存在作者隐藏的投毒代码的可能性估计为1%。

**项目地址:** [DimaMend/cve-2024-6387-poc](https://github.com/DimaMend/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #3

**来源**: [CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行存在漏洞版本的OpenSSH服务，且攻击者能够建立SSH连接，并在认证超时前发送恶意数据。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，存在于glibc的linux系统。它源于一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该漏洞是有效的。多个来源都确认了该漏洞的存在以及其远程代码执行的潜力。POC代码的存在进一步支持了其可利用性。

**投毒风险：**

POC代码本身包含以下潜在的投毒风险点：

*   **Shellcode占位符:** 代码中明确提到 `Shellcode placeholder (replace with actual shellcode)`。如果用户直接使用未经审查的 shellcode，则可能引入恶意行为。此处的风险不在于作者投毒，而在于用户使用不当。
*   **GLIBC_BASES:**  `GLIBC_BASES[]` 数组包含可能的 glibc 基地址。如果这个地址不准确，利用将失败。如果作者故意提供错误的地址，可能会导致拒绝服务或误导分析。
*   **Timing parameters:** 注释提到需要根据目标系统调整 timing 参数。错误的 timing 可能导致利用失败或系统不稳定。
*   **Heap layout 和 File structure offsets:**  代码注释中也强调了需要针对不同的 OpenSSH 和 glibc 版本进行调整，否则利用会失败。故意设置错误的值可能导致程序崩溃或产生其他未定义行为。
*   **随机数生成:** 代码使用 `srand(time(NULL))` 初始化随机数生成器。虽然这本身不是投毒，但如果后续利用中依赖于可预测的随机数，可能会被利用。

总体评估投毒风险为30%。风险主要来自于需要用户自行替换的shellcode，以及需要用户根据目标环境配置的参数。作者本身隐藏恶意代码的可能性较低，但用户在使用过程中存在引入风险的可能性。

**利用方式：**

1.  **建立连接：** 攻击者首先需要建立与目标 OpenSSH 服务器的连接。
2.  **SSH握手：** 进行初步的SSH握手过程，包括版本协商和密钥交换的初始化，但无需完成身份认证。
3.  **堆准备：**  `prepare_heap` 函数的目的是在堆上创建特定的布局，为后续的利用创造条件。具体实现细节未给出，但可能涉及分配和释放内存，以控制堆的状态。
4.  **时间测量：** `time_final_packet` 函数测量服务器处理特定数据包所需的时间。这个时间信息对于后续的竞争条件利用至关重要。
5.  **竞争条件：**  `attempt_race_condition` 函数尝试触发漏洞的核心：信号处理程序中的竞争条件。这通常涉及发送一个精心构造的数据包，该数据包会在服务器处理过程中触发 SIGALRM 信号。由于信号处理程序使用了异步信号不安全函数，因此可能导致堆损坏。
6.  **代码执行：**  如果竞争条件成功触发，攻击者就可以利用堆损坏来执行任意代码。这通常涉及覆盖函数指针或控制程序的执行流程。

该漏洞的利用依赖于精确的 timing 和对目标系统内存布局的了解。攻击者需要进行大量的尝试才能成功利用该漏洞。

**项目地址:** [HadesNull123/CVE-2024-6387_Check](https://github.com/HadesNull123/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #4

**来源**: [CVE-2024-6387-Karmakstylez_CVE-2024-6387.md](../2024/CVE-2024-6387-Karmakstylez_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器(sshd)中的一个安全回归漏洞，存在于glibc-based Linux系统。该漏洞源于信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。该漏洞利用代码尝试通过大量的连接请求触发竞争条件，通过调整glibc基地址和定时参数绕过ASLR，将恶意代码注入到堆中，最终实现以root权限远程代码执行。

有效性：根据漏洞信息和搜索结果，此POC代码具备一定的有效性，但成功利用需要满足特定条件，例如目标系统使用glibc，以及OpenSSH版本在受影响范围内。同时，漏洞利用的成功率受到系统负载、网络延迟等因素的影响，需要进行大量的尝试。

投毒风险：POC代码中存在一定的投毒风险。虽然POC代码的主要目的是利用已知的漏洞，但攻击者可能在代码中加入恶意功能，例如植入后门、收集敏感信息等。例如，shellcode 部分是明显的注入点。风险评定为10%，主要基于以下几点：
1.  **Shellcode 替换：** 代码明确指出 `shellcode` 变量是占位符，需要替换为实际的 shellcode。如果用户不小心使用了包含恶意指令的 shellcode，则可能导致投毒。
2.  **glibc 基地址猜测：** 虽然代码尝试多个 glibc 基地址，但如果攻击者预先知道目标系统的 glibc 地址，则可以修改 `GLIBC_BASES` 数组以提高利用成功率，同时也可能引入恶意地址。
3.  **Timing 参数调整：** 代码中的 `usleep` 函数用于控制连接尝试之间的延迟。攻击者可以通过调整这些参数来优化漏洞利用，但也可能引入导致拒绝服务 (DoS) 的参数。
4.  **编译选项：**POC 需要编译，攻击者可以在编译时添加额外的恶意编译选项，例如禁用安全特性等。
5.  **作者本身:** 仓库作者有投毒行为.

利用方式：
1.  攻击者首先需要确定目标系统是否运行受影响的OpenSSH版本，以及是否基于glibc。
2.  攻击者发起大量的SSH连接请求，尝试触发竞争条件。
3.  攻击者利用精心构造的数据包覆盖堆上的特定内存区域，将恶意代码注入到sshd进程中。
4.  一旦恶意代码成功执行，攻击者即可获得目标系统的控制权。

**项目地址:** [Karmakstylez/CVE-2024-6387](https://github.com/Karmakstylez/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #5

**来源**: [CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md](../2024/CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md)

## CVE-2024-6387-OpenSSH-RegreSSHion-RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行并获取 root 权限或造成拒绝服务

**影响版本:** <= 9.7p1 (受影响版本 8.5p1 至 9.7p1)

**利用条件:** 需要目标服务器运行受影响版本的OpenSSH，且存在时间窗口内的未认证连接尝试。高危利用场景依赖glibc环境。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-6387，也被称为“regreSSHion”，是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞（CVE-2006-5051）。该漏洞源于信号处理中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC已经存在，并且能够实现远程代码执行和拒绝服务攻击。很多安全厂商和研究人员都发布了相关的分析报告和PoC代码。

**投毒风险：**
提供的漏洞利用代码（/tmp/270e32ae67508359811c0f9899155269/README.md 和 LICENSE）仅仅是声明了存在POC，根据现有信息，该仓库本身存在恶意代码的风险较低。但是，由于POC的执行具有高危性，在实际使用中，仍需要进行安全审查。

**利用方式：**
1.  **竞争条件：** 攻击者通过在短时间内发起大量未认证的连接尝试，触发 `sshd` 中的竞争条件。
2.  **信号处理：** 在特定的时间窗口内，`sshd` 可能会以不安全的方式处理信号，导致内存损坏或其他异常行为。
3.  **远程代码执行/拒绝服务：**  利用内存损坏或其他异常行为，攻击者可以执行任意代码（RCE），或导致 `sshd` 崩溃，造成拒绝服务（DoS）。部分利用依赖特定的glibc环境。
4.  **ProxyCommand注入:** 根据github仓库的README.md描述，该POC利用了 `ProxyCommand` 配置不当或滥用的情况，攻击者可以注入恶意命令到 `ProxyCommand` 中，从而获得命令执行或者横向渗透的能力。

**缓解措施：**
*   升级到 OpenSSH 9.8 或更高版本。
*   设置 `LoginGraceTime 0` 以禁用在指定超时时间内未完成身份验证时服务器断开连接的功能（Red Hat 建议的临时缓解措施，但会使服务器更容易受到 DoS 攻击）。
*   使用 `fail2ban` 等工具，配合防火墙来监控日志文件并适当管理连接。

**项目地址:** [Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC](https://github.com/Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #6

**来源**: [CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md](../2024/CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）或拒绝服务（DoS）

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。它是一个竞争条件漏洞，可能导致sshd以不安全的方式处理信号。远程攻击者可以通过在设定的时间内未能成功验证身份来触发此漏洞，从而可能导致远程代码执行或拒绝服务。

**有效性评估：**

根据漏洞库信息、搜索结果以及提供的POC代码来看，此漏洞的POC是存在的，并且多个安全厂商都发布了相关的分析报告和检测方法。搜索结果也表明此漏洞允许远程未授权代码执行。

**利用方式：**

1.  攻击者建立与目标OpenSSH服务器的连接。
2.  进行SSH握手，获取服务器banner。
3.  准备堆，发送一定量的填充数据。
4.  尝试触发竞争条件，通过发送包含`glibc_base`地址的payload，并附加一些`nop`指令。
5.  如果成功，则在服务器上执行代码，获得root权限。
6.  脚本使用了多线程来增加攻击成功的几率，并对时序进行调整。

**投毒风险评估：**

提供的POC代码（`Exploit_2024_6387.py`）本身是一个漏洞利用脚本，其目的是利用目标系统的漏洞。评估投毒风险主要关注作者是否在脚本中植入了恶意代码，例如：

*   **后门代码：**  脚本在成功利用漏洞后，是否会创建一个后门，允许攻击者在未经授权的情况下再次访问系统。
*   **破坏性代码：**  脚本是否包含旨在破坏目标系统或数据的代码。
*   **信息窃取代码：**  脚本是否会窃取目标系统上的敏感信息。

分析代码发现，虽然脚本本身旨在利用漏洞，但并未发现明显的后门、破坏性或信息窃取代码。 然而，需要注意的是，该脚本的`TARGET_IP`和`TARGET_PORT`是硬编码的，在实际使用中需要进行修改。此外，攻击者可能会修改此脚本以包含恶意功能。此处的`glibc_base`地址也需要根据目标环境进行调整，否则利用大概率会失败，这也是成功利用此漏洞的难点之一。

综合来看，该仓库存在投毒风险的可能性较低，但是不排除有攻击者对代码进行修改后，二次传播。因此，建议在使用前仔细审查代码。

**风险评估：**
`poison`的百分比评估主要考虑以下几个方面：

*   **代码复杂性：** 代码越复杂，隐藏恶意代码的可能性越高。
*   **作者信誉：** 如果作者的信誉未知或可疑，则风险越高。
*   **代码审查：** 代码是否经过其他安全研究人员的审查。

根据以上分析，此脚本的`poison`风险评估为10%。

**项目地址:** [SkyGodling/CVE-2024-6387-POC](https://github.com/SkyGodling/CVE-2024-6387-POC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #7

**来源**: [CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md](../2024/CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，未认证的远程攻击者通过在设定的时间内认证失败触发

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞(CVE-2006-5051)。它存在一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，进而导致远程代码执行(RCE)或拒绝服务(DoS)。

根据搜索结果和漏洞信息，该漏洞影响glibc-based Linux系统，利用需要发起大量连接尝试来触发竞争条件。

提供的漏洞利用代码 `scanner.py` 是一个版本扫描器，并非直接利用 CVE-2024-6387。它用于检测目标 SSH 服务器的版本，并根据预定义的 CVE 列表判断是否存在已知的漏洞。该脚本通过创建 socket 连接到目标主机的 SSH 端口，然后发送一个空字节并接收服务器的响应，从中提取 OpenSSH 的版本信息。然后将提取的版本与易受攻击的版本列表进行比较。

**漏洞利用方式：**

1.  攻击者需要向目标 OpenSSH 服务器发起大量的连接请求。
2.  在连接建立后，故意触发认证失败，从而在信号处理过程中创建竞争条件。
3.  竞争条件允许攻击者在某些 glibc Linux 发行版中将指令插入堆中，进而实现远程代码执行。

**投毒风险：**

虽然脚本本身是一个版本扫描器，而不是直接的漏洞利用程序，但仍需谨慎评估其潜在的投毒风险。 代码中存在创建日志目录并记录扫描结果的行为，存在恶意修改扫描逻辑或在日志中写入恶意数据，但可能性极低。因此，评估投毒风险为1%。

**项目地址:** [ThatNotEasy/CVE-2024-6387](https://github.com/ThatNotEasy/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #8

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 远程代码执行/拒绝服务

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1，受影响版本包括8.5p1至9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且攻击者能够发起大量连接请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞，它源于 CVE-2006-5051。该漏洞是一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间段内未能通过身份验证来触发此漏洞。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的PoC代码是有效的。多个来源证实了该漏洞的存在和可利用性，特别是针对glibc的Linux系统。

**投毒风险：**

提供的PoC代码包含用于编译、构建和利用漏洞的Dockerfile和Python脚本。通过分析代码，可以发现以下潜在的投毒风险因素：

*   **依赖项：** Dockerfile中使用了`wget`和`curl`来下载OpenSSH源码，存在被中间人攻击替换为恶意源码的风险。尽管校验和可以降低这种风险，但如果攻击者能够控制构建环境，仍然可能引入恶意代码。
*   **shellcode：** Python脚本包含一个名为`shellcode`的变量，目前只是占位符，但攻击者可以修改此变量，插入恶意shellcode。攻击者可以精心构造shellcode，以执行恶意操作，例如安装后门、窃取数据或提权。

虽然这些风险存在，但从现有代码来看，没有发现明显的恶意代码。因此，评估投毒风险为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的OpenSSH环境（32位Linux系统）。
2.  **SSH握手：** 客户端与服务器建立连接，发送SSH版本信息并进行密钥交换（KEX）初始化。
3.  **堆准备：** 通过发送特定大小的数据包来布置堆内存，利用glibc的漏洞插入恶意指令。
4.  **触发竞争条件：** 大量连接尝试来触发信号处理程序中的竞争条件。
5.  **执行代码：** 成功触发竞争条件后，恶意代码将被执行，从而实现远程代码执行。

总体来说，利用方式较为复杂，需要精心构造数据包和进行大量的连接尝试才能成功。

**项目地址:** [YassDEV221608/CVE-2024-6387](https://github.com/YassDEV221608/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #9

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 9.7p1 (影响 8.5p1 到 9.7p1)

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，并且是基于glibc的Linux系统。攻击者需要能够建立到SSH服务的网络连接，并能够快速发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中发现的一个安全回归漏洞，存在于glibc的Linux系统中。该漏洞是由于OpenSSH服务器（sshd）中的信号处理存在竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用此漏洞可能导致以 root 身份远程执行代码。

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果也确认了该漏洞的存在，并描述了其可能导致远程代码执行的风险。漏洞利用代码的存在也进一步证实了漏洞的有效性，代码尝试利用竞争条件来执行任意代码。

**投毒风险：**
代码存在一定的投毒风险的可能性。虽然代码本身看起来是在尝试利用该漏洞，但以下因素需要考虑：

1.  **Shellcode占位符：** 代码中包含一个shellcode占位符`unsigned char shellcode[] = "\x90\x90\x90\x90";`，明确指示需要替换成实际的shellcode。如果用户没有意识到这一点，或者使用了恶意shellcode，可能会造成损害。这里的投毒风险在于，攻击者可能发布包含恶意shellcode的exp，诱导用户使用。 
2.  **GLIBC_BASES：** 代码中定义了`GLIBC_BASES[]`，用于绕过ASLR。如果这些地址不正确，利用将失败。更糟糕的是，如果攻击者故意提供错误的地址，可能会导致程序崩溃或其他不可预测的行为。
3.  **Timing parameters和 Heap layout 需要调整：** 代码注释中强调了定时参数和堆布局需要根据目标系统进行调整。如果这些参数设置不正确，可能会导致利用失败或目标系统不稳定。
4.  **文件结构偏移量：** 代码提到需要验证特定glibc版本的文件结构偏移量。使用错误的偏移量可能导致内存损坏或其他不可预测的行为。

总体来看，该POC的复杂性和对系统内部结构的依赖性，投毒者可以通过提供不正确的配置参数，或者引导用户使用错误的shellcode，达到破坏目标系统的目的。因此存在10%的投毒风险。

**利用方式：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **建立连接：** 攻击者首先需要与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者需要完成初始的SSH握手过程，包括协议版本交换和密钥交换初始化（KEX）。
3.  **堆准备：** 攻击者利用SSH协议发送数据包，在内存堆上布置精心构造的数据结构，为后续的漏洞利用做准备。
4.  **触发竞争条件：** 攻击者发送一个特制的SSH数据包，该数据包的设计是为了触发sshd中的竞争条件。具体来说，它利用了在身份验证失败的情况下，信号处理程序中的不安全操作。
5.  **RCE：** 成功触发竞争条件后，攻击者可以将恶意代码注入到sshd进程中，从而实现远程代码执行。具体是通过内存操作覆盖某个函数指针，使其指向攻击者提供的shellcode。
6.  **提权（Root）：** 由于sshd通常以root权限运行，因此攻击者执行的shellcode也将以root权限运行，从而完全控制目标系统。

**项目地址:** [YassDEV221608/CVE-2024-6387_PoC](https://github.com/YassDEV221608/CVE-2024-6387_PoC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #10

**来源**: [CVE-2024-6387-alex14324_ssh_poc2024.md](../2024/CVE-2024-6387-alex14324_ssh_poc2024.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）和拒绝服务（DoS）

**影响版本:** <= 9.7p1

**利用条件:** 需要目标系统开启sshd服务，且受影响的OpenSSH版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是一个存在于OpenSSH服务器（sshd）中的安全漏洞，具体来说是一个竞争条件漏洞。该漏洞源于OpenSSH处理信号的方式。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，导致sshd以不安全的方式处理信号。这可能导致远程代码执行（RCE），攻击者获得root权限，或拒绝服务（DoS），使服务器不可用。

**有效性分析：**
从漏洞库信息、搜索结果和提供的PoC代码来看，该漏洞的PoC是存在的，并且被广泛讨论和利用。 搜索结果中提到“regreSSHion (CVE-2024-6387) is an unauthenticated RCE vulnerability in OpenSSH’s server, affecting glibc-based Linux systems. Full root access is granted.” 表明该漏洞有很高的潜在影响. PoC代码也试图绕过ASLR，并包含shellcode的占位符，表明攻击者可以注入恶意代码。

**投毒风险分析：**
提供的PoC代码具有一定的投毒风险，大约为10%。主要基于以下几点：
1.  **Shellcode占位符：** 代码中包含`unsigned char shellcode[] = "\x90\x90\x90\x90";`。虽然这只是一个占位符，需要用户替换为实际的shellcode，但攻击者可能发布包含恶意shellcode的版本，诱导用户使用。
2.  **GLIBC_BASES地址：**  代码中包含了`uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`。这些地址是ASLR绕过的尝试，但如果攻击者故意提供错误的地址，可能导致利用失败或者其他未知的行为，但一般不会产生特别大的危害。
3.  **Timing参数：** 代码中需要根据目标系统响应调整Timing参数。攻击者可能提供不合适的参数，导致利用不稳定或者失败。
4.  **Heap Layout和文件结构偏移：**  代码注释中提到“Heap layout : Requires tweaking for different OpenSSH versions.” 和 “File structure offsets: Verify for the specific glibc version.”。攻击者可能故意提供错误的值，导致利用失败或者产生其他问题。

**利用方式：**
1.  **建立连接：** 攻击者首先需要与目标服务器的sshd服务建立TCP连接。
2.  **SSH握手：** 进行SSH握手，包括版本交换、密钥交换等步骤。PoC代码中的 `perform_ssh_handshake` 函数实现了这些步骤。
3.  **堆准备：** 通过发送特定的SSH数据包，在sshd进程的堆上分配内存，并控制堆的布局。`prepare_heap` 函数用于执行此操作。
4.  **时间计算：**  计算处理最终数据包所需的时间，用于后续的竞争条件利用。`time_final_packet` 函数用于执行此操作。
5.  **竞争条件利用：**  通过大量并发连接，触发sshd中的竞争条件漏洞。攻击者不断尝试进行身份验证，但故意失败，以触发SIGALRM信号处理程序。由于信号处理程序中使用了非异步信号安全的函数，可能导致内存损坏和代码执行。`attempt_race_condition` 函数用于执行此操作。
6.  **ASLR绕过：**  由于地址空间布局随机化（ASLR）的存在，攻击者需要知道glibc的基地址。PoC代码中包含了一组可能的基地址，并尝试逐个利用。
7.  **代码注入：** 成功利用竞争条件后，攻击者可以将恶意代码（shellcode）注入到sshd进程的内存中。占位符需要替换。
8.  **代码执行：**  执行注入的shellcode，从而获得服务器的root权限。

**项目地址:** [alex14324/ssh_poc2024](https://github.com/alex14324/ssh_poc2024)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #11

**来源**: [CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md](../2024/CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH服务，并允许未授权的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)。

**有效性:**
根据搜索结果和漏洞库信息，此漏洞的PoC是存在的，并且已经被公开。多个来源证实了该漏洞的存在，以及它可能导致远程代码执行。提供的“漏洞利用代码”实际上是一个缓解脚本，旨在通过升级OpenSSH版本或禁用LoginGraceTime来降低风险，而不是一个实际的利用程序。

**投毒风险:**
提供的脚本主要功能是检测并修复漏洞，但仍然存在一定的投毒风险：
*   **依赖外部源：** 脚本使用`apt-get update`和`apt-get install`命令，依赖外部软件源。如果软件源被恶意篡改，可能导致安装恶意软件包。
*   **配置修改：** 脚本会修改`/etc/ssh/sshd_config`文件，存在被恶意利用修改配置的风险。
*   **权限提升：** 脚本需要root权限运行，如果脚本被篡改，可能导致提权攻击。
综合考虑，该脚本存在一定的投毒风险，但主要风险在于依赖的外部源和配置修改，因此投毒风险评估为10%。

**利用方式:**
此漏洞的利用方式是利用 sshd 进程处理信号时的竞争条件。攻击者需要发起大量连接尝试，并在身份验证失败时触发竞争条件。成功触发后，攻击者能够在目标系统上执行任意代码。根据 offsec.com 的博客文章，此漏洞利用机会在某些 glibc Linux 发行版中，能将指令插入堆中。

**项目地址:** [almogopp/OpenSSH-CVE-2024-6387-Fix](https://github.com/almogopp/OpenSSH-CVE-2024-6387-Fix)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #12

**来源**: [CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md](../2024/CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许未授权网络访问SSH端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387 (regreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的安全回归漏洞，源于 CVE-2006-5051。这是一个竞争条件漏洞，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内身份验证失败来触发此漏洞。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经公开。多个安全厂商和研究人员已经发布了关于此漏洞的分析和PoC代码。

**投毒风险分析：**

提供的Checker.py脚本的主要功能是检测目标SSH服务器是否存在CVE-2024-6387漏洞。它通过连接到目标服务器的SSH端口并获取SSH banner信息，然后将其与已知易受攻击和已修补的版本进行比较来确定漏洞状态。 代码中没有发现任何明显的恶意或后门代码。

投毒风险评估：0%。该脚本主要用于漏洞检测，不包含任何主动利用漏洞的代码，也没有发现作者隐藏的恶意代码。

**利用方式分析：**

1.  **漏洞原理：** 漏洞是由于 OpenSSH 在处理信号时存在竞争条件，允许在身份验证失败期间执行恶意代码。
2.  **攻击步骤：** 攻击者需要向目标服务器发起大量的SSH连接尝试。
3.  **触发条件：** 在连接尝试期间，攻击者故意使身份验证失败，触发竞争条件。
4.  **利用结果：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码，以root权限运行，或者造成拒绝服务攻击。
5.  **缓解措施：** 通过设置 `LoginGraceTime 0` 禁用 `LoginGraceTime` 参数可以缓解远程代码执行的风险，但仍然存在拒绝服务的风险。更新到OpenSSH 9.8或更高版本是完整的修复方案。

**项目地址:** [anhvutuan/CVE-2024-6387-poc-1](https://github.com/anhvutuan/CVE-2024-6387-poc-1)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #13

**来源**: [CVE-2024-6387-awusan125_test_for6387.md](../2024/CVE-2024-6387-awusan125_test_for6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要目标系统基于 glibc，且 OpenSSH 版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理程序中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用可能允许攻击者在目标系统上以 root 权限执行任意代码或导致拒绝服务。

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞的 PoC 已被公开，并且漏洞利用的复杂性较高。搜索结果表明，该漏洞影响 glibc 基础的 Linux 系统。提供的 POC 代码似乎旨在利用此漏洞。

**投毒风险分析：**
该 POC 代码中存在一定的投毒风险，大约 20%。原因如下：
*   **Shellcode 占位符:** 代码中包含 `unsigned char shellcode[] = "\x90\x90\x90\x90";` 这一行，明确指出需要替换为实际的 shellcode。如果用户不小心使用了该占位符，或者植入了其他有害 shellcode，则可能导致不可预期的后果。
*   **GLIBC 基地址硬编码:** 代码中定义了 `uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`，并表示 “Needs adjustment for specific target systems”。如果 GLIBC 基地址不正确，可能导致利用失败，甚至造成程序崩溃。攻击者可能会故意提供错误的基地址，使得用户在尝试利用时受到干扰，或者执行其他恶意操作。
*   **Timing 参数需要微调:** 代码注释中提到 “Timing parameters: Fine-tune based on target system responsiveness”。如果 timing 参数设置不当，可能导致竞争条件无法触发，或者引发其他问题。攻击者可能会提供误导性的 timing 参数，使得用户在尝试利用时遇到困难，或者触发非预期的行为。
*   **Heap 布局和文件结构偏移量:** 代码注释提到 “Heap layout : Requires tweaking for different OpenSSH versions” 和 “File structure offsets: Verify for the specific glibc version.” 这表示该漏洞利用依赖于特定的堆布局和文件结构偏移量。如果这些值不正确，则可能导致利用失败，甚至造成程序崩溃。攻击者可能会提供不兼容的值，使得用户在尝试利用时受到干扰，或者触发非预期的行为。
*   **错误处理不完善:** 代码中虽然包含了一些错误处理逻辑，但可能存在未处理的异常情况。攻击者可能会利用这些漏洞，使得程序在特定条件下崩溃或执行非预期的操作。

**利用方式：**
利用方式主要涉及以下步骤：
1.  **建立连接：** 与目标 SSH 服务器建立 TCP 连接。
2.  **SSH 握手：** 执行 SSH 握手过程，包括版本交换和密钥交换。
3.  **堆准备：** 通过发送特定的数据包，在堆上创建特定的布局。
4.  **时间控制：** 精确控制数据包的发送时间，以便触发竞争条件。
5.  **竞争条件触发：** 通过大量连接尝试和认证失败，利用信号处理程序的竞争条件在内存中注入恶意代码，通常包括修改 glibc 的数据结构。
6.  **代码执行：** 利用注入的恶意代码来执行任意命令。
7.  **绕过 ASLR：** 由于地址空间布局随机化 (ASLR) 的存在，需要确定 glibc 的基地址。PoC 代码中尝试了几个常见的基地址。

总体而言，该漏洞利用较为复杂，需要对 SSH 协议、glibc 内部机制和竞争条件有深入的了解。该漏洞的成功利用还依赖于目标系统的特定配置和状态。

**项目地址:** [awusan125/test_for6387](https://github.com/awusan125/test_for6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #14

**来源**: [CVE-2024-6387-dream434_CVE-2024-6387.md](../2024/CVE-2024-6387-dream434_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，目标系统运行受影响的OpenSSH版本，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性评估：**

根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已经被广泛讨论。漏洞利用代码的脚本主要用于检测目标主机是否运行存在漏洞的OpenSSH版本，利用方式是扫描目标IP的22端口，获取OpenSSH版本信息，并与已知的易受攻击版本进行比较，从而判断目标系统是否存在漏洞。

**投毒风险分析：**

提供的漏洞利用代码（CVE-2024-6387.py）主要用于版本检测，功能相对简单。虽然`README.md`中包含克隆GitHub仓库的操作，但直接分析提供的Python脚本，发现潜在的投毒点在于以下几个方面：

1.  **依赖包风险：** 脚本本身依赖较少，但如果`README.md`引导用户安装额外的依赖包（例如通过`pip install -r requirements.txt`，而`requirements.txt`包含恶意包），则可能存在投毒风险。
2.  **命令执行风险：** `README.md` 中的运行命令 `python CVE-2024-6387.py http://exemple.com` 虽然看起来无害，但如果 `CVE-2024-6387.py` 存在漏洞，允许通过命令行参数执行恶意代码，则存在风险。当前提供的代码没有直接利用命令行参数执行代码的逻辑。
3.  **文件包含风险：** 如果脚本尝试动态加载其他文件（例如配置文件），而这些文件被篡改，则可能存在风险。

鉴于以上分析，以及`README.md`中存在引导用户克隆github仓库的操作，综合判断，存在较低的投毒风险，约为10%。主要基于假设恶意代码可能存在于被克隆仓库的其他文件中，或者存在利用脚本漏洞执行恶意代码的可能。

**漏洞利用方式：**

1.  **版本检测：** 攻击者首先需要确定目标系统上运行的OpenSSH版本是否在受影响的范围内（8.5p1 <= version <= 9.7p1）。
2.  **触发竞争条件：** 攻击者通过与目标SSH服务器建立连接，并在身份验证过程中故意失败，以触发漏洞相关的竞争条件。
3.  **代码执行：** 成功触发竞争条件后，攻击者可以利用该漏洞在目标系统上执行任意代码，通常以root权限执行。

搜索结果也表明，此漏洞允许未经身份验证的远程代码执行，并且影响基于glibc的Linux系统。因此，利用方式的核心在于触发竞争条件并利用glibc的特性来执行恶意代码。

**项目地址:** [dream434/CVE-2024-6387](https://github.com/dream434/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #15

**来源**: [CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标主机开启SSH服务，且攻击者能够发起大量连接尝试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是一个OpenSSH服务器中的竞争条件漏洞。它源于OpenSSH处理信号的方式，当SSH服务器在短时间内收到大量连接请求且认证失败时，可能导致信号处理不当，进而允许未经验证的远程攻击者在基于glibc的Linux系统上执行任意代码，获取root权限，或者导致拒绝服务。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC已发布，表明漏洞可被利用。提供的Python脚本`CVE-2024-6387-Vulnerability-Checker.py`是一个漏洞检测工具，通过检查SSH banner版本来判断目标是否存在漏洞。脚本本身并不能直接利用该漏洞进行RCE或DoS攻击，而是用来辅助确认目标系统是否在受影响的范围内。

**投毒风险：**
该Python脚本主要功能是检查OpenSSH版本，判断其是否在受影响的范围内。代码本身只包含版本检测逻辑，没有发现任何恶意代码或后门，因此投毒风险极低。可以认为投毒风险为0%。

**利用方式：**
1.  **版本检测：** 使用PoC脚本或类似工具检测目标SSH服务器的版本，确认其是否位于易受攻击的范围(8.5p1 <= OpenSSH <= 9.7p1)。
2.  **触发竞争条件：** 如果目标版本易受攻击，攻击者需要发起大量连接尝试，并在短时间内故意认证失败，以触发竞争条件。
3.  **代码执行（或DoS）：** 成功触发竞争条件后，利用glibc的堆操作特性，攻击者可以插入恶意指令到堆中，从而实现远程代码执行。另一种利用方式是耗尽服务器资源，造成拒绝服务攻击。

需要注意的是，利用此漏洞进行RCE需要对glibc堆操作有一定的了解，并且成功率可能不高。缓解措施包括禁用`LoginGraceTime`配置，并使用`fail2ban`等工具限制恶意连接。

**项目地址:** [filipi86/CVE-2024-6387-Vulnerability-Checker](https://github.com/filipi86/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #16

**来源**: [CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-regreSSHion

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1 (OpenSSH)

**利用条件:** 需要glibc-based Linux系统，以及OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞。漏洞源于OpenSSH服务器处理信号的方式存在问题，具体来说，当用户认证失败时，可能触发不安全的信号处理。远程攻击者可以通过在短时间内发起大量SSH连接尝试，并故意触发认证失败，从而引发竞争条件，最终可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据搜索结果（webpage 1, 3, 4, 5, 7, 8）和漏洞库信息，该漏洞已被确认为一个高危漏洞，并且存在公开的PoC（Proof of Concept）代码。虽然提供的POC代码只是一个包含漏洞描述的README.md文件，**不能直接运行，但是，github上存在可利用的POC**。该POC的有效性取决于目标系统是否满足漏洞利用的条件，即：
1.  使用受影响的OpenSSH版本（<= 9.7p1）。
2.  目标系统是基于glibc的Linux发行版。
3.  系统配置允许一定数量的并发连接。

**投毒风险：**
提供的POC代码（README.md）本身不包含任何可执行代码，因此直接的投毒风险很低。但需要注意的是，任何从互联网上下载的代码都存在潜在的风险。即使是看似无害的文档，也可能包含恶意链接或指令，引导用户下载或执行恶意代码。因此，下载和使用任何PoC代码时，都应该保持警惕，并进行充分的安全审查。

虽然提供的README.md文件本身投毒风险较低,但是考虑到实际利用中需要依赖其他EXP, 因此其他仓库被投毒的可能性相对较高。
风险评估：10%

**利用方式：**
根据漏洞描述和搜索结果，利用方式主要包括以下几个步骤：
1.  **大量连接请求：** 攻击者向目标OpenSSH服务器发起大量的并发连接请求。
2.  **触发认证失败：**  在连接请求中，故意提供错误的用户名或密码，触发认证失败事件。
3.  **竞争条件利用：**  通过大量认证失败事件，触发OpenSSH服务器中的竞争条件漏洞。
4.  **代码执行或DoS：** 成功利用漏洞后，攻击者可以执行任意代码（RCE）或导致服务器崩溃（DoS）。

需要注意的是，利用该漏洞需要一定的资源和技术，并且成功率可能不高。Red Hat 在其安全公告中指出，实现RCE需要相当多的资源投入。同时，修改sshd_config,设置LoginGraceTime为0可以有效避免远程代码执行，但仍存在拒绝服务风险.

**项目地址:** [identity-threat-labs/Article-RegreSSHion-CVE-2024-6387](https://github.com/identity-threat-labs/Article-RegreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #17

**来源**: [CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，sshd服务运行且存在于受影响版本范围内，目标系统是基于glibc的Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中发现的竞争条件漏洞。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发该漏洞。成功利用可能导致以root权限远程执行代码或拒绝服务。该漏洞的利用依赖于触发信号处理程序的竞争条件，攻击者需要发起大量连接尝试才能提高触发漏洞的几率。提供的PoC代码是一个漏洞验证工具，用于检测目标系统上运行的OpenSSH版本是否存在漏洞。它通过连接到目标SSH端口并检查SSH横幅来工作。如果横幅指示易受攻击的版本，则该工具会将目标标记为易受攻击。PoC代码本身似乎不包含任何明显的投毒代码。它仅仅用于验证漏洞是否存在，并不会主动进行利用。

**利用方式：**

1.  攻击者向目标服务器的SSH端口发起大量连接请求。
2.  连接请求需要故意失败，例如提供无效的用户名或密码，以便触发身份验证失败流程。
3.  攻击者利用OpenSSH处理信号时的竞争条件，将恶意指令插入堆中。
4.  如果竞争条件利用成功，攻击者即可在目标系统上以root权限执行任意代码或导致拒绝服务。

**项目地址:** [identity-threat-labs/CVE-2024-6387-Vulnerability-Checker](https://github.com/identity-threat-labs/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #18

**来源**: [CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md](../2024/CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统使用受影响的OpenSSH版本，基于glibc的Linux系统，且未禁用LoginGraceTime

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是一个存在于OpenSSH服务器(sshd)中的竞争条件漏洞。该漏洞源于OpenSSH在处理信号时存在不安全行为。远程攻击者通过在一定时间内认证失败，可以触发此漏洞，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**漏洞利用方式：**

1.  攻击者向目标服务器发起大量的SSH连接请求。
2.  在SSH认证过程中，攻击者故意使认证失败，触发LoginGraceTime超时。
3.  由于竞争条件，sshd可能在处理SIGALRM信号时进入不安全状态。
4.  在glibc-based的Linux系统上，这种不安全状态可能允许攻击者将指令插入到堆中，最终导致RCE。
5.  如果无法实现RCE，攻击者可以通过耗尽服务器资源，导致DoS。

**POC代码分析：**

提供的PoC代码`/tmp/d7c5471d195cdec17d8f4ebaf7516058/CVE-2024-6387_poc.py`的主要功能是检测目标SSH服务器的版本，判断其是否受CVE-2024-6387漏洞影响。它通过建立socket连接，发送`\x00`，接收SSH版本信息，并进行正则匹配来确定OpenSSH的版本。如果版本在易受攻击的范围内（8.5 <= 版本 < 9.8）,则输出目标系统可能存在漏洞。该PoC本身**不包含直接利用漏洞的代码**，仅仅用于版本检测。

`/tmp/d7c5471d195cdec17d8f4ebaf7516058/README.md` 提供了一个使用说明，介绍了如何使用该PoC。`/tmp/d7c5471d195cdec17d8f4ebaf7516058/ip-addr.list`包含需要检查的IP地址列表, 127.0.0.1是示例.

**有效性：**

提供的POC代码的**有效性在于验证目标系统是否存在漏洞**，而非直接利用该漏洞。根据搜索结果和漏洞描述，完整的漏洞利用需要更复杂的步骤和技术，例如大量连接尝试来触发竞争条件，以及精心构造的shellcode。因此，此PoC仅仅是前期验证步骤。

**投毒风险：**

该仓库中存在**投毒风险的可能性较低，约为10%**。PoC代码主要功能是版本检测，本身没有发现恶意代码。潜在的风险可能存在于：

*   `ip-addr.list`文件：虽然当前提供的`ip-addr.list`文件只包含本地地址`127.0.0.1`, 如果用户不小心使用了作者预先设定的其他IP地址列表，可能会导致未授权的扫描或攻击行为。
*   `session.log`文件：虽然日志记录本身不是恶意行为，但如果日志文件被上传或泄露，可能暴露用户的扫描目标信息。日志信息包含IP和端口信息。
*   在实际利用该漏洞时，如果攻击者使用了恶意的Payload，可能会对目标系统造成更大的危害。这些Payload可能被伪装成无害的代码，从而绕过安全检测。
*   如果作者在其他未公开的分支或版本中包含了恶意代码，并且诱导用户使用这些版本，则存在更高的投毒风险。

**综上所述，**虽然提供的PoC代码本身不包含明显的恶意代码，但用户在使用时仍然需要保持警惕，仔细审查代码，并确保从可信的来源获取代码，避免潜在的投毒风险。

**项目地址:** [jocker2410/CVE-2024-6387_poc](https://github.com/jocker2410/CVE-2024-6387_poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #19

**来源**: [CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：**

从搜索结果和漏洞库信息来看，该漏洞存在可利用的POC。提供的Rust代码是一个漏洞检查器，它通过连接到SSH服务器并读取SSH banner来判断目标服务器是否运行着存在漏洞的OpenSSH版本。

**投毒风险：**

提供的代码是一个漏洞检测工具，用于检查目标系统是否存在CVE-2024-6387漏洞。代码功能相对清晰，主要包括：

*   定义了易受攻击和已修补的版本列表。
*   通过TCP连接获取SSH banner。
*   将获取的banner与已知易受攻击的版本进行比较。

代码中没有发现恶意行为，例如执行系统命令或上传/下载文件。因此，**投毒风险较低，判断为0%**。

**利用方式：**

根据漏洞信息和搜索结果，攻击者需要发起大量的连接尝试，以触发sshd中的竞争条件。成功利用该漏洞可能允许攻击者在目标系统上执行任意代码或导致拒绝服务。Offsec的博客提供了关于如何利用该漏洞的更详细的解释。

**总结：**

CVE-2024-6387是一个严重的安全漏洞，允许未经身份验证的攻击者远程执行代码。虽然利用该漏洞需要一定的资源和技术，但由于存在公开的POC，因此建议尽快更新OpenSSH版本。

**项目地址:** [kubota/CVE-2024-6387-Vulnerability-Checker](https://github.com/kubota/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #20

**来源**: [CVE-2024-6387-l-urk_CVE-2024-6387.md](../2024/CVE-2024-6387-l-urk_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH regreSSHion 远程代码执行漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** OpenSSH

**危害等级:** 高危，未授权的远程攻击者可以利用此漏洞以 root 权限执行任意代码，或者造成拒绝服务。

**影响版本:** 8.5p1 ~ 9.7p1

**利用条件:** 目标系统使用受影响的 OpenSSH 版本, 并且基于 glibc 的 Linux 系统。需要网络连通性, 且攻击者需要能够发起大量的 SSH 连接尝试。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，又名 regreSSHion，是 OpenSSH 服务器中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件漏洞，允许未经身份验证的远程攻击者在基于 glibc 的 Linux 系统上执行任意代码。漏洞的利用方式涉及发起大量的 SSH 连接尝试，触发 sshd 进程中的竞争条件，从而允许攻击者将指令插入堆中，最终实现 RCE。

**有效性：**
从搜索结果和漏洞库信息来看，此漏洞是真实存在的，并且存在公开可用的 PoC 代码。PoC 代码的描述也与漏洞描述一致，表明其具有较高的有效性。

**投毒风险：**
提供的 POC 代码库中的 `LISCENCE` 文件声明了严格的权限限制，这在一定程度上增加了投毒的可能性。虽然无法通过现有信息完全确定是否存在投毒代码，但需要对脚本进行仔细审查，特别注意以下几个方面：

*   **shellcode:**  分析 shellcode 的行为，确保其功能与漏洞利用目的相符，没有恶意行为。
*   **网络连接:**  检查代码中是否存在额外的网络连接，特别是连接到未知或可疑的 IP 地址。
*   **文件操作:**  检查代码中是否存在对系统文件的修改或删除操作。
*   **依赖项:**  审查 `requirements.txt` 文件中的依赖项，确保没有引入恶意的第三方库。

考虑到需要大量连接尝试和对堆的操纵，以及许可证的严格声明，综合评估投毒风险为10%。这部分代码逻辑比较复杂，存在隐藏恶意代码的可能性。

**利用方式：**
1.  攻击者通过网络向目标 OpenSSH 服务器发起大量的连接请求。
2.  利用 OpenSSH 服务器处理连接请求时存在的竞争条件，特别是在信号处理方面。
3.  通过精心构造的数据包，将恶意代码注入到服务器的堆内存中。
4.  触发执行注入的恶意代码，从而获得对目标系统的控制权 (RCE) 或导致拒绝服务 (DoS)。
5.  默认的shellcode打开9999端口,并使用nc进行监听。

**项目地址:** [l-urk/CVE-2024-6387](https://github.com/l-urk/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #21

**来源**: [CVE-2024-6387-lflare_cve-2024-6387-poc.md](../2024/CVE-2024-6387-lflare_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是OpenSSH服务器(sshd)中的一个竞争条件漏洞，源于CVE-2006-5051的安全回归。当sshd在不安全的方式下处理某些信号时，未经验证的远程攻击者可能通过在设定的时间内未能成功验证身份来触发此漏洞。

**有效性评估：**
根据漏洞信息和搜索结果，此漏洞的PoC已经发布，并且被广泛讨论，证明了其有效性。PoC代码（`7etsuo-regreSSHion.c`）尝试利用此漏洞，通过以下步骤：

1.  **连接建立：** 与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH协议握手。
3.  **堆准备：** 准备堆布局以进行利用。
4.  **时间测量：** 测量数据包解析时间。
5.  **竞争条件尝试：** 尝试触发竞争条件，利用信号处理中的不安全函数调用，最终目标是执行shellcode，提权至root。
6.  **ASLR绕过：**尝试不同的glibc基地址，以绕过地址空间布局随机化(ASLR)。

代码中包含了尝试20000次利用的循环，以及100ms的延时，这些都符合漏洞分析文章的描述，增加了利用成功的可能性。

**投毒风险评估：**

此PoC代码存在一定程度的投毒风险，因为:

1.  **Shellcode:** PoC代码包含一个shellcode占位符，攻击者需要替换成真实的shellcode。如果提供的shellcode本身是恶意的，那么使用此PoC会导致投毒。
2. **glibc地址:** PoC代码包含glibc基址，攻击者需要手动调整为目标系统的基址。如果提供的基址不正确，或者根本无法确定正确的基址，会影响利用成功率。如果攻击者故意提供错误的基址或者使用错误的基址绕过策略，也有可能导致拒绝服务。
3.  **定时参数：** PoC代码中的定时参数需要根据目标系统的响应速度进行调整。如果定时不当，可能导致利用失败，甚至使目标系统崩溃。
4.  **heap布局:** OpenSSH的堆布局会随着版本的变化而变化，需要针对不同的版本进行调整。如果不调整，可能无法成功利用。

**评估：**
PoC代码的编写者可能在代码中加入不易察觉的恶意行为，例如收集目标系统信息并发送到远程服务器等。但是，考虑到PoC的主要目的是为了验证漏洞，因此这种风险相对较低。PoC中已经存在大量的需要修改的地方，需要使用者有一定的漏洞知识储备，因此投毒风险相对较低。

**综合评估**：PoC中投毒风险预估为10%，

**利用方式总结：**

1.  攻击者首先需要与目标OpenSSH服务器建立连接。
2.  然后，攻击者需要执行SSH握手协议。
3.  接着，攻击者发送特制的数据包，触发sshd中的竞争条件。
4.  竞争条件允许攻击者覆盖内存中的关键数据结构。
5.  攻击者通过覆盖的数据结构，执行预先准备好的shellcode，从而获得目标系统的root权限。
6. 利用过程需要绕过ASLR保护，这可能需要多次尝试，或者使用其他信息泄露漏洞。
7. 攻击需要一定的timing， 把握好发送数据包的时间。

**项目地址:** [lflare/cve-2024-6387-poc](https://github.com/lflare/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #22

**来源**: [CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387是一个OpenSSH服务器(sshd)中的安全回归漏洞，存在于OpenSSH 8.5p1到9.7p1版本。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。远程攻击者可以通过在设定的时间内认证失败来触发此漏洞，可能导致远程代码执行或拒绝服务。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已确认存在，并且有POC代码可用。搜索引擎结果中的多个链接指向了漏洞分析、利用和修复方法，以及相关的讨论。

**投毒风险：**
提供的POC代码包含一个Python脚本（main.py）和一个README.md文件。脚本内容主要用于识别易受攻击的OpenSSH服务器，并无发现任何恶意代码或者后门，但是不排除后续增加投毒代码的可能性, 因此投毒风险极低。

**利用方式：**
1.  攻击者需要发起大量SSH连接到目标服务器。
2.  在LoginGraceTime时间内，故意使认证失败。
3.  利用竞争条件，使sshd以不安全的方式处理信号。
4.  如果成功，攻击者可能能够执行任意代码或导致服务崩溃（拒绝服务）。

**缓解措施：**
*   将OpenSSH升级到9.8或更高版本。
*   设置`LoginGraceTime 0`可以缓解RCE，但不能完全避免DoS攻击，建议结合`fail2ban`和防火墙使用。

**项目地址:** [moften/regreSSHion-CVE-2024-6387](https://github.com/moften/regreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #23

**来源**: [CVE-2024-6387-prelearn-code_CVE-2024-6387.md](../2024/CVE-2024-6387-prelearn-code_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 远程代码执行

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行

**影响应用:** OpenSSH

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (glibc-based Linux systems)

**利用条件:** 目标系统需要运行受影响版本的OpenSSH，且基于glibc。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，也被称为"regreSSHion"，是OpenSSH服务器（sshd）中的一个安全漏洞，是CVE-2006-5051的一个回归。它是由信号处理中的竞争条件引起的。未经身份验证的远程攻击者可以通过在设定的时间内未能成功进行身份验证来触发此漏洞，可能导致以root权限执行任意代码。该漏洞影响基于glibc的Linux系统上的OpenSSH 8.5p1到9.7p1版本。

**有效性：**
根据漏洞库信息、搜索结果（特别是来自Qualys和offsec的分析），以及POC代码的存在，可以判断该漏洞是有效的，并且存在可利用的POC。

**投毒风险：**
POC代码中存在一定的投毒风险。虽然代码的目的是利用该漏洞，但攻击者可能会修改shellcode以进行恶意活动，或者在代码中加入额外的后门。例如，`shellcode`变量中包含占位符，需要替换为实际的shellcode。如果用户从不可信来源下载POC，并使用了包含恶意shellcode的POC，则可能存在投毒风险。代码中定义了多个glibc地址用于绕过ASLR，攻击者可以伪造错误的地址，来扰乱攻击。

**利用方式：**
利用方式涉及以下几个步骤：

1.  **建立连接：** 攻击者首先与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH握手过程，包括版本交换和密钥交换的初始化。
3.  **堆准备：** 发送特定的SSH数据包，以在sshd进程的堆上创建特定的内存布局，为利用创造条件。
4.  **触发竞争条件：** 攻击者触发一个竞争条件，该条件涉及OpenSSH处理信号的方式，利用SIGALRM信号处理程序中的不安全函数调用。
5.  **地址绕过：** 通过尝试多个可能的glibc基址，绕过地址空间布局随机化 (ASLR)。
6.  **执行代码：** 成功触发竞争条件后，将恶意shellcode注入到内存中并执行，从而获得远程代码执行权限（通常以root权限）。

**缓解措施包括：**
*   禁用`LoginGraceTime`参数，虽然不能完全阻止DoS，但可以防御RCE。
*   使用`fail2ban`等工具监控日志文件并管理连接。
*   及时更新到OpenSSH的修复版本。

**项目地址:** [prelearn-code/CVE-2024-6387](https://github.com/prelearn-code/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #24

**来源**: [CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md](../2024/CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，glibc-based Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387是一个OpenSSH服务器中的竞争条件漏洞（源于CVE-2006-5051的回归）。未经身份验证的远程攻击者可以通过在设定的时间内未能完成身份验证来触发此漏洞。利用方式是发送大量连接请求，触发竞争条件，在glibc-based Linux系统上可能导致在堆中插入恶意指令，最终实现远程代码执行或拒绝服务。提供的脚本并非POC，而是缓解措施：

1.  **有效性：** 提供的脚本实际上是一个缓解脚本，通过将`LoginGraceTime`设置为0来减少漏洞被利用的可能性，并不能直接验证漏洞，缓解脚本会禁用SSHD服务器在指定超时时间内未完成身份验证时断开连接的能力。虽然降低了RCE的风险，但增加了拒绝服务(DoS)的风险。

2.  **投毒风险：** 提供的脚本目的是缓解漏洞，没有发现任何隐藏的恶意代码，因此投毒风险为0%。

3.  **利用方式：** 根据漏洞信息和搜索结果，利用方式是未认证的攻击者向目标OpenSSH服务器发送大量连接请求，由于竞争条件的存在，sshd可能以不安全的方式处理信号，从而允许攻击者执行任意代码（RCE）或造成拒绝服务(DoS)。攻击成功的关键在于触发竞争条件，因此需要大量的并发连接尝试。


**项目地址:** [redux-sibi-jose/mitigate_ssh](https://github.com/redux-sibi-jose/mitigate_ssh)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #25

**来源**: [CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md](../2024/CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，并且攻击者能够建立SSH连接并触发竞争条件。攻击者需要尝试大量连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全漏洞，源于信号处理中的竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：** 根据漏洞库信息和搜索结果，此漏洞存在PoC。该漏洞的利用依赖于触发竞争条件，因此需要进行大量的连接尝试。

**投毒风险：** 分析提供的PoC代码，主要包含一个检测脚本（detection-script.py）和一个README。检测脚本尝试建立到目标SSH服务器的连接，并发送SSH协议版本字符串，然后读取服务器的响应。LICENSE文件和README.md文件是标准格式，描述了漏洞信息。由于检测脚本本身较为简单，且没有发现明显的恶意代码，因此投毒的风险较低，约为10%。 但是需要人工review所有代码.特别是二进制文件.

**利用方式：** 利用此漏洞需要：
1.  攻击者向目标服务器上的sshd服务发起大量的连接请求。
2.  在连接建立但身份验证尚未完成时，利用竞争条件触发信号处理错误。
3.  如果成功利用，攻击者可以在目标系统上执行任意代码，获得root权限（根据漏洞描述和搜索结果）。

利用的复杂性在于需要精确地控制时序，以触发竞争条件。这通常需要大量的计算资源和对目标系统行为的深入了解。同时该漏洞在glibc-based Linux systems更有效,可能无法在所有系统上利用。

**项目地址:** [s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH](https://github.com/s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #26

**来源**: [CVE-2024-6387-wiggels_regresshion-check.md](../2024/CVE-2024-6387-wiggels_regresshion-check.md)

# CVE-2024-6387

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-6387-AzrDll_CVE-2024-6387.md](../2024/CVE-2024-6387-AzrDll_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH 竞争条件导致 RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。需要发起大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务中的一个竞争条件漏洞，源于 CVE-2006-5051 的回归。未经身份验证的远程攻击者可以通过在短时间内发起大量失败的身份验证尝试来触发此漏洞。利用此漏洞需要在glibc堆中插入指令，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞确实存在，并且有公开的PoC利用代码。该PoC通过建立大量的 SSH 连接并进行不成功的身份验证来触发竞争条件。参考[webpage 3]，此漏洞允许glibc Linux发行版在堆中插入指令，从而实现代码执行。提供的PoC代码尝试利用这一点，但成功率可能较低，因为竞争条件需要精确的时间控制。

**投毒风险：**
提供的PoC代码`/tmp/fe03af2a23123389ff9785e2fb119f2c/PoC.py` 包含了从文件中读取glibc地址的功能。 虽然代码本身没有明显的恶意行为，但如果提供的 `glibc_file` 包含恶意构造的地址，可能会导致非预期的行为，甚至导致拒绝服务。例如，如果`glibc_base`地址指向了关键系统函数，覆盖该地址可能造成系统崩溃。另一个潜在的风险点是 `timing_adjustment`，如果调整不当可能造成DoS。综上所述，投毒风险为10%。主要是考虑到作者可能在利用代码的 `glibc_file` 参数中提供恶意的 glibc 地址，诱导用户使用，从而达到破坏目标系统的目的。

**利用方式：**
1.  **建立连接：** 攻击者首先建立与目标 OpenSSH 服务器的 TCP 连接。
2.  **SSH 握手：** 攻击者执行 SSH 握手过程，例如发送 SSH 版本字符串。
3.  **堆准备：** PoC尝试在堆上分配一些数据，为利用竞争条件做准备。
4.  **触发竞争条件：**  通过快速发送大量失败的身份验证请求，攻击者试图触发 `sshd` 进程中的竞争条件。这涉及利用 `LoginGraceTime` 参数，该参数允许攻击者在身份验证超时之前发送多个请求。根据[webpage 6]，利用此漏洞需要大量连接尝试才能准确触发竞争条件。
5.  **代码执行：**  如果竞争条件被成功触发，攻击者可以在内存中写入恶意代码，从而实现远程代码执行。提供的 PoC 代码尝试通过覆盖 glibc 的地址来实现这一点。如果成功利用，攻击者可以获得 root 权限，如[webpage 1][webpage 4]所描述。
6.  **拒绝服务：** 即使未能成功实现 RCE，攻击者也可能通过耗尽服务器资源来实现拒绝服务。由于竞争条件涉及信号处理，不正确的信号处理可能导致 `sshd` 崩溃。

**项目地址:** [AzrDll/CVE-2024-6387](https://github.com/AzrDll/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #2

**来源**: [CVE-2024-6387-DimaMend_cve-2024-6387-poc.md](../2024/CVE-2024-6387-DimaMend_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行(RCE)和拒绝服务(DoS)

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，并且目标系统基于glibc。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全漏洞，它是由CVE-2006-5051引入的回归错误。该漏洞是一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**利用方式：**

1.  **建立连接：** 攻击者首先与易受攻击的OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者尝试进行SSH握手，但故意不完成身份验证过程。这是为了触发`LoginGraceTime`超时。
3.  **堆准备：** 攻击者发送一系列SSH数据包，旨在操纵服务器的内存堆的布局。 这可能涉及到分配和释放内存，以便为利用创造合适的条件。
4.  **触发竞争条件：** 攻击者利用`LoginGraceTime`超时机制。当服务器由于握手超时而即将终止连接时，会发送一个信号。 攻击者尝试与此信号处理程序执行竞争，以修改服务器的内存。
5.  **代码执行：** 如果竞争成功，攻击者可以将恶意代码注入到服务器的内存中，并获得代码执行能力。 根据具体利用方式，这可能导致以root权限执行代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞的利用是可行的。许多信息源表明，存在公开可用的PoC，并且已经有人成功利用了此漏洞。 PoC代码的功能是尝试利用这个竞态条件。

**投毒风险分析：**

PoC代码中存在投毒代码的风险很低，原因如下：

*   **代码结构：** 代码主要集中于建立连接、进行SSH握手、操纵堆内存以及尝试触发竞态条件。虽然代码较为复杂，但在总体流程上没有明显的恶意操作。
*   **Shellcode占位符：** 代码中存在一个 `shellcode` 占位符，明确提示用户需要替换成实际的 shellcode。这表明作者的意图是提供一个框架，而不是一个直接可用的恶意载荷。
*   **注释和说明：** 代码包含大量的注释和说明，解释了漏洞的原理、利用方法以及需要调整的参数。这表明作者的目的是帮助研究人员理解和复现漏洞，而不是隐藏恶意代码。
*   **随机性和尝试次数：** 代码包含大量的随机尝试，目的是为了提高漏洞利用的成功率。这种随机性使得代码难以预测，也增加了作者插入恶意代码的难度。
*   **外部依赖：** 代码没有包含明显的外部依赖或网络请求，这降低了其被用于下载或执行恶意代码的风险。

虽然直接投毒的可能性较低，但仍然存在一些潜在风险，比如在 `shellcode` 占位符中插入恶意代码，或者在调整参数的过程中引入错误，导致程序行为异常。因此，在使用 PoC 代码时，仍然需要进行仔细的代码审查和安全测试。

综上所述，此仓库中存在作者隐藏的投毒代码的可能性估计为1%。

**项目地址:** [DimaMend/cve-2024-6387-poc](https://github.com/DimaMend/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #3

**来源**: [CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行存在漏洞版本的OpenSSH服务，且攻击者能够建立SSH连接，并在认证超时前发送恶意数据。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，存在于glibc的linux系统。它源于一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该漏洞是有效的。多个来源都确认了该漏洞的存在以及其远程代码执行的潜力。POC代码的存在进一步支持了其可利用性。

**投毒风险：**

POC代码本身包含以下潜在的投毒风险点：

*   **Shellcode占位符:** 代码中明确提到 `Shellcode placeholder (replace with actual shellcode)`。如果用户直接使用未经审查的 shellcode，则可能引入恶意行为。此处的风险不在于作者投毒，而在于用户使用不当。
*   **GLIBC_BASES:**  `GLIBC_BASES[]` 数组包含可能的 glibc 基地址。如果这个地址不准确，利用将失败。如果作者故意提供错误的地址，可能会导致拒绝服务或误导分析。
*   **Timing parameters:** 注释提到需要根据目标系统调整 timing 参数。错误的 timing 可能导致利用失败或系统不稳定。
*   **Heap layout 和 File structure offsets:**  代码注释中也强调了需要针对不同的 OpenSSH 和 glibc 版本进行调整，否则利用会失败。故意设置错误的值可能导致程序崩溃或产生其他未定义行为。
*   **随机数生成:** 代码使用 `srand(time(NULL))` 初始化随机数生成器。虽然这本身不是投毒，但如果后续利用中依赖于可预测的随机数，可能会被利用。

总体评估投毒风险为30%。风险主要来自于需要用户自行替换的shellcode，以及需要用户根据目标环境配置的参数。作者本身隐藏恶意代码的可能性较低，但用户在使用过程中存在引入风险的可能性。

**利用方式：**

1.  **建立连接：** 攻击者首先需要建立与目标 OpenSSH 服务器的连接。
2.  **SSH握手：** 进行初步的SSH握手过程，包括版本协商和密钥交换的初始化，但无需完成身份认证。
3.  **堆准备：**  `prepare_heap` 函数的目的是在堆上创建特定的布局，为后续的利用创造条件。具体实现细节未给出，但可能涉及分配和释放内存，以控制堆的状态。
4.  **时间测量：** `time_final_packet` 函数测量服务器处理特定数据包所需的时间。这个时间信息对于后续的竞争条件利用至关重要。
5.  **竞争条件：**  `attempt_race_condition` 函数尝试触发漏洞的核心：信号处理程序中的竞争条件。这通常涉及发送一个精心构造的数据包，该数据包会在服务器处理过程中触发 SIGALRM 信号。由于信号处理程序使用了异步信号不安全函数，因此可能导致堆损坏。
6.  **代码执行：**  如果竞争条件成功触发，攻击者就可以利用堆损坏来执行任意代码。这通常涉及覆盖函数指针或控制程序的执行流程。

该漏洞的利用依赖于精确的 timing 和对目标系统内存布局的了解。攻击者需要进行大量的尝试才能成功利用该漏洞。

**项目地址:** [HadesNull123/CVE-2024-6387_Check](https://github.com/HadesNull123/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #4

**来源**: [CVE-2024-6387-Karmakstylez_CVE-2024-6387.md](../2024/CVE-2024-6387-Karmakstylez_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器(sshd)中的一个安全回归漏洞，存在于glibc-based Linux系统。该漏洞源于信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。该漏洞利用代码尝试通过大量的连接请求触发竞争条件，通过调整glibc基地址和定时参数绕过ASLR，将恶意代码注入到堆中，最终实现以root权限远程代码执行。

有效性：根据漏洞信息和搜索结果，此POC代码具备一定的有效性，但成功利用需要满足特定条件，例如目标系统使用glibc，以及OpenSSH版本在受影响范围内。同时，漏洞利用的成功率受到系统负载、网络延迟等因素的影响，需要进行大量的尝试。

投毒风险：POC代码中存在一定的投毒风险。虽然POC代码的主要目的是利用已知的漏洞，但攻击者可能在代码中加入恶意功能，例如植入后门、收集敏感信息等。例如，shellcode 部分是明显的注入点。风险评定为10%，主要基于以下几点：
1.  **Shellcode 替换：** 代码明确指出 `shellcode` 变量是占位符，需要替换为实际的 shellcode。如果用户不小心使用了包含恶意指令的 shellcode，则可能导致投毒。
2.  **glibc 基地址猜测：** 虽然代码尝试多个 glibc 基地址，但如果攻击者预先知道目标系统的 glibc 地址，则可以修改 `GLIBC_BASES` 数组以提高利用成功率，同时也可能引入恶意地址。
3.  **Timing 参数调整：** 代码中的 `usleep` 函数用于控制连接尝试之间的延迟。攻击者可以通过调整这些参数来优化漏洞利用，但也可能引入导致拒绝服务 (DoS) 的参数。
4.  **编译选项：**POC 需要编译，攻击者可以在编译时添加额外的恶意编译选项，例如禁用安全特性等。
5.  **作者本身:** 仓库作者有投毒行为.

利用方式：
1.  攻击者首先需要确定目标系统是否运行受影响的OpenSSH版本，以及是否基于glibc。
2.  攻击者发起大量的SSH连接请求，尝试触发竞争条件。
3.  攻击者利用精心构造的数据包覆盖堆上的特定内存区域，将恶意代码注入到sshd进程中。
4.  一旦恶意代码成功执行，攻击者即可获得目标系统的控制权。

**项目地址:** [Karmakstylez/CVE-2024-6387](https://github.com/Karmakstylez/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #5

**来源**: [CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md](../2024/CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md)

## CVE-2024-6387-OpenSSH-RegreSSHion-RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行并获取 root 权限或造成拒绝服务

**影响版本:** <= 9.7p1 (受影响版本 8.5p1 至 9.7p1)

**利用条件:** 需要目标服务器运行受影响版本的OpenSSH，且存在时间窗口内的未认证连接尝试。高危利用场景依赖glibc环境。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-6387，也被称为“regreSSHion”，是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞（CVE-2006-5051）。该漏洞源于信号处理中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC已经存在，并且能够实现远程代码执行和拒绝服务攻击。很多安全厂商和研究人员都发布了相关的分析报告和PoC代码。

**投毒风险：**
提供的漏洞利用代码（/tmp/270e32ae67508359811c0f9899155269/README.md 和 LICENSE）仅仅是声明了存在POC，根据现有信息，该仓库本身存在恶意代码的风险较低。但是，由于POC的执行具有高危性，在实际使用中，仍需要进行安全审查。

**利用方式：**
1.  **竞争条件：** 攻击者通过在短时间内发起大量未认证的连接尝试，触发 `sshd` 中的竞争条件。
2.  **信号处理：** 在特定的时间窗口内，`sshd` 可能会以不安全的方式处理信号，导致内存损坏或其他异常行为。
3.  **远程代码执行/拒绝服务：**  利用内存损坏或其他异常行为，攻击者可以执行任意代码（RCE），或导致 `sshd` 崩溃，造成拒绝服务（DoS）。部分利用依赖特定的glibc环境。
4.  **ProxyCommand注入:** 根据github仓库的README.md描述，该POC利用了 `ProxyCommand` 配置不当或滥用的情况，攻击者可以注入恶意命令到 `ProxyCommand` 中，从而获得命令执行或者横向渗透的能力。

**缓解措施：**
*   升级到 OpenSSH 9.8 或更高版本。
*   设置 `LoginGraceTime 0` 以禁用在指定超时时间内未完成身份验证时服务器断开连接的功能（Red Hat 建议的临时缓解措施，但会使服务器更容易受到 DoS 攻击）。
*   使用 `fail2ban` 等工具，配合防火墙来监控日志文件并适当管理连接。

**项目地址:** [Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC](https://github.com/Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #6

**来源**: [CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md](../2024/CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）或拒绝服务（DoS）

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。它是一个竞争条件漏洞，可能导致sshd以不安全的方式处理信号。远程攻击者可以通过在设定的时间内未能成功验证身份来触发此漏洞，从而可能导致远程代码执行或拒绝服务。

**有效性评估：**

根据漏洞库信息、搜索结果以及提供的POC代码来看，此漏洞的POC是存在的，并且多个安全厂商都发布了相关的分析报告和检测方法。搜索结果也表明此漏洞允许远程未授权代码执行。

**利用方式：**

1.  攻击者建立与目标OpenSSH服务器的连接。
2.  进行SSH握手，获取服务器banner。
3.  准备堆，发送一定量的填充数据。
4.  尝试触发竞争条件，通过发送包含`glibc_base`地址的payload，并附加一些`nop`指令。
5.  如果成功，则在服务器上执行代码，获得root权限。
6.  脚本使用了多线程来增加攻击成功的几率，并对时序进行调整。

**投毒风险评估：**

提供的POC代码（`Exploit_2024_6387.py`）本身是一个漏洞利用脚本，其目的是利用目标系统的漏洞。评估投毒风险主要关注作者是否在脚本中植入了恶意代码，例如：

*   **后门代码：**  脚本在成功利用漏洞后，是否会创建一个后门，允许攻击者在未经授权的情况下再次访问系统。
*   **破坏性代码：**  脚本是否包含旨在破坏目标系统或数据的代码。
*   **信息窃取代码：**  脚本是否会窃取目标系统上的敏感信息。

分析代码发现，虽然脚本本身旨在利用漏洞，但并未发现明显的后门、破坏性或信息窃取代码。 然而，需要注意的是，该脚本的`TARGET_IP`和`TARGET_PORT`是硬编码的，在实际使用中需要进行修改。此外，攻击者可能会修改此脚本以包含恶意功能。此处的`glibc_base`地址也需要根据目标环境进行调整，否则利用大概率会失败，这也是成功利用此漏洞的难点之一。

综合来看，该仓库存在投毒风险的可能性较低，但是不排除有攻击者对代码进行修改后，二次传播。因此，建议在使用前仔细审查代码。

**风险评估：**
`poison`的百分比评估主要考虑以下几个方面：

*   **代码复杂性：** 代码越复杂，隐藏恶意代码的可能性越高。
*   **作者信誉：** 如果作者的信誉未知或可疑，则风险越高。
*   **代码审查：** 代码是否经过其他安全研究人员的审查。

根据以上分析，此脚本的`poison`风险评估为10%。

**项目地址:** [SkyGodling/CVE-2024-6387-POC](https://github.com/SkyGodling/CVE-2024-6387-POC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #7

**来源**: [CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md](../2024/CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，未认证的远程攻击者通过在设定的时间内认证失败触发

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞(CVE-2006-5051)。它存在一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，进而导致远程代码执行(RCE)或拒绝服务(DoS)。

根据搜索结果和漏洞信息，该漏洞影响glibc-based Linux系统，利用需要发起大量连接尝试来触发竞争条件。

提供的漏洞利用代码 `scanner.py` 是一个版本扫描器，并非直接利用 CVE-2024-6387。它用于检测目标 SSH 服务器的版本，并根据预定义的 CVE 列表判断是否存在已知的漏洞。该脚本通过创建 socket 连接到目标主机的 SSH 端口，然后发送一个空字节并接收服务器的响应，从中提取 OpenSSH 的版本信息。然后将提取的版本与易受攻击的版本列表进行比较。

**漏洞利用方式：**

1.  攻击者需要向目标 OpenSSH 服务器发起大量的连接请求。
2.  在连接建立后，故意触发认证失败，从而在信号处理过程中创建竞争条件。
3.  竞争条件允许攻击者在某些 glibc Linux 发行版中将指令插入堆中，进而实现远程代码执行。

**投毒风险：**

虽然脚本本身是一个版本扫描器，而不是直接的漏洞利用程序，但仍需谨慎评估其潜在的投毒风险。 代码中存在创建日志目录并记录扫描结果的行为，存在恶意修改扫描逻辑或在日志中写入恶意数据，但可能性极低。因此，评估投毒风险为1%。

**项目地址:** [ThatNotEasy/CVE-2024-6387](https://github.com/ThatNotEasy/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #8

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 远程代码执行/拒绝服务

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1，受影响版本包括8.5p1至9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且攻击者能够发起大量连接请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞，它源于 CVE-2006-5051。该漏洞是一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间段内未能通过身份验证来触发此漏洞。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的PoC代码是有效的。多个来源证实了该漏洞的存在和可利用性，特别是针对glibc的Linux系统。

**投毒风险：**

提供的PoC代码包含用于编译、构建和利用漏洞的Dockerfile和Python脚本。通过分析代码，可以发现以下潜在的投毒风险因素：

*   **依赖项：** Dockerfile中使用了`wget`和`curl`来下载OpenSSH源码，存在被中间人攻击替换为恶意源码的风险。尽管校验和可以降低这种风险，但如果攻击者能够控制构建环境，仍然可能引入恶意代码。
*   **shellcode：** Python脚本包含一个名为`shellcode`的变量，目前只是占位符，但攻击者可以修改此变量，插入恶意shellcode。攻击者可以精心构造shellcode，以执行恶意操作，例如安装后门、窃取数据或提权。

虽然这些风险存在，但从现有代码来看，没有发现明显的恶意代码。因此，评估投毒风险为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的OpenSSH环境（32位Linux系统）。
2.  **SSH握手：** 客户端与服务器建立连接，发送SSH版本信息并进行密钥交换（KEX）初始化。
3.  **堆准备：** 通过发送特定大小的数据包来布置堆内存，利用glibc的漏洞插入恶意指令。
4.  **触发竞争条件：** 大量连接尝试来触发信号处理程序中的竞争条件。
5.  **执行代码：** 成功触发竞争条件后，恶意代码将被执行，从而实现远程代码执行。

总体来说，利用方式较为复杂，需要精心构造数据包和进行大量的连接尝试才能成功。

**项目地址:** [YassDEV221608/CVE-2024-6387](https://github.com/YassDEV221608/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #9

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 9.7p1 (影响 8.5p1 到 9.7p1)

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，并且是基于glibc的Linux系统。攻击者需要能够建立到SSH服务的网络连接，并能够快速发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中发现的一个安全回归漏洞，存在于glibc的Linux系统中。该漏洞是由于OpenSSH服务器（sshd）中的信号处理存在竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用此漏洞可能导致以 root 身份远程执行代码。

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果也确认了该漏洞的存在，并描述了其可能导致远程代码执行的风险。漏洞利用代码的存在也进一步证实了漏洞的有效性，代码尝试利用竞争条件来执行任意代码。

**投毒风险：**
代码存在一定的投毒风险的可能性。虽然代码本身看起来是在尝试利用该漏洞，但以下因素需要考虑：

1.  **Shellcode占位符：** 代码中包含一个shellcode占位符`unsigned char shellcode[] = "\x90\x90\x90\x90";`，明确指示需要替换成实际的shellcode。如果用户没有意识到这一点，或者使用了恶意shellcode，可能会造成损害。这里的投毒风险在于，攻击者可能发布包含恶意shellcode的exp，诱导用户使用。 
2.  **GLIBC_BASES：** 代码中定义了`GLIBC_BASES[]`，用于绕过ASLR。如果这些地址不正确，利用将失败。更糟糕的是，如果攻击者故意提供错误的地址，可能会导致程序崩溃或其他不可预测的行为。
3.  **Timing parameters和 Heap layout 需要调整：** 代码注释中强调了定时参数和堆布局需要根据目标系统进行调整。如果这些参数设置不正确，可能会导致利用失败或目标系统不稳定。
4.  **文件结构偏移量：** 代码提到需要验证特定glibc版本的文件结构偏移量。使用错误的偏移量可能导致内存损坏或其他不可预测的行为。

总体来看，该POC的复杂性和对系统内部结构的依赖性，投毒者可以通过提供不正确的配置参数，或者引导用户使用错误的shellcode，达到破坏目标系统的目的。因此存在10%的投毒风险。

**利用方式：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **建立连接：** 攻击者首先需要与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者需要完成初始的SSH握手过程，包括协议版本交换和密钥交换初始化（KEX）。
3.  **堆准备：** 攻击者利用SSH协议发送数据包，在内存堆上布置精心构造的数据结构，为后续的漏洞利用做准备。
4.  **触发竞争条件：** 攻击者发送一个特制的SSH数据包，该数据包的设计是为了触发sshd中的竞争条件。具体来说，它利用了在身份验证失败的情况下，信号处理程序中的不安全操作。
5.  **RCE：** 成功触发竞争条件后，攻击者可以将恶意代码注入到sshd进程中，从而实现远程代码执行。具体是通过内存操作覆盖某个函数指针，使其指向攻击者提供的shellcode。
6.  **提权（Root）：** 由于sshd通常以root权限运行，因此攻击者执行的shellcode也将以root权限运行，从而完全控制目标系统。

**项目地址:** [YassDEV221608/CVE-2024-6387_PoC](https://github.com/YassDEV221608/CVE-2024-6387_PoC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #10

**来源**: [CVE-2024-6387-alex14324_ssh_poc2024.md](../2024/CVE-2024-6387-alex14324_ssh_poc2024.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）和拒绝服务（DoS）

**影响版本:** <= 9.7p1

**利用条件:** 需要目标系统开启sshd服务，且受影响的OpenSSH版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是一个存在于OpenSSH服务器（sshd）中的安全漏洞，具体来说是一个竞争条件漏洞。该漏洞源于OpenSSH处理信号的方式。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，导致sshd以不安全的方式处理信号。这可能导致远程代码执行（RCE），攻击者获得root权限，或拒绝服务（DoS），使服务器不可用。

**有效性分析：**
从漏洞库信息、搜索结果和提供的PoC代码来看，该漏洞的PoC是存在的，并且被广泛讨论和利用。 搜索结果中提到“regreSSHion (CVE-2024-6387) is an unauthenticated RCE vulnerability in OpenSSH’s server, affecting glibc-based Linux systems. Full root access is granted.” 表明该漏洞有很高的潜在影响. PoC代码也试图绕过ASLR，并包含shellcode的占位符，表明攻击者可以注入恶意代码。

**投毒风险分析：**
提供的PoC代码具有一定的投毒风险，大约为10%。主要基于以下几点：
1.  **Shellcode占位符：** 代码中包含`unsigned char shellcode[] = "\x90\x90\x90\x90";`。虽然这只是一个占位符，需要用户替换为实际的shellcode，但攻击者可能发布包含恶意shellcode的版本，诱导用户使用。
2.  **GLIBC_BASES地址：**  代码中包含了`uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`。这些地址是ASLR绕过的尝试，但如果攻击者故意提供错误的地址，可能导致利用失败或者其他未知的行为，但一般不会产生特别大的危害。
3.  **Timing参数：** 代码中需要根据目标系统响应调整Timing参数。攻击者可能提供不合适的参数，导致利用不稳定或者失败。
4.  **Heap Layout和文件结构偏移：**  代码注释中提到“Heap layout : Requires tweaking for different OpenSSH versions.” 和 “File structure offsets: Verify for the specific glibc version.”。攻击者可能故意提供错误的值，导致利用失败或者产生其他问题。

**利用方式：**
1.  **建立连接：** 攻击者首先需要与目标服务器的sshd服务建立TCP连接。
2.  **SSH握手：** 进行SSH握手，包括版本交换、密钥交换等步骤。PoC代码中的 `perform_ssh_handshake` 函数实现了这些步骤。
3.  **堆准备：** 通过发送特定的SSH数据包，在sshd进程的堆上分配内存，并控制堆的布局。`prepare_heap` 函数用于执行此操作。
4.  **时间计算：**  计算处理最终数据包所需的时间，用于后续的竞争条件利用。`time_final_packet` 函数用于执行此操作。
5.  **竞争条件利用：**  通过大量并发连接，触发sshd中的竞争条件漏洞。攻击者不断尝试进行身份验证，但故意失败，以触发SIGALRM信号处理程序。由于信号处理程序中使用了非异步信号安全的函数，可能导致内存损坏和代码执行。`attempt_race_condition` 函数用于执行此操作。
6.  **ASLR绕过：**  由于地址空间布局随机化（ASLR）的存在，攻击者需要知道glibc的基地址。PoC代码中包含了一组可能的基地址，并尝试逐个利用。
7.  **代码注入：** 成功利用竞争条件后，攻击者可以将恶意代码（shellcode）注入到sshd进程的内存中。占位符需要替换。
8.  **代码执行：**  执行注入的shellcode，从而获得服务器的root权限。

**项目地址:** [alex14324/ssh_poc2024](https://github.com/alex14324/ssh_poc2024)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #11

**来源**: [CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md](../2024/CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH服务，并允许未授权的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)。

**有效性:**
根据搜索结果和漏洞库信息，此漏洞的PoC是存在的，并且已经被公开。多个来源证实了该漏洞的存在，以及它可能导致远程代码执行。提供的“漏洞利用代码”实际上是一个缓解脚本，旨在通过升级OpenSSH版本或禁用LoginGraceTime来降低风险，而不是一个实际的利用程序。

**投毒风险:**
提供的脚本主要功能是检测并修复漏洞，但仍然存在一定的投毒风险：
*   **依赖外部源：** 脚本使用`apt-get update`和`apt-get install`命令，依赖外部软件源。如果软件源被恶意篡改，可能导致安装恶意软件包。
*   **配置修改：** 脚本会修改`/etc/ssh/sshd_config`文件，存在被恶意利用修改配置的风险。
*   **权限提升：** 脚本需要root权限运行，如果脚本被篡改，可能导致提权攻击。
综合考虑，该脚本存在一定的投毒风险，但主要风险在于依赖的外部源和配置修改，因此投毒风险评估为10%。

**利用方式:**
此漏洞的利用方式是利用 sshd 进程处理信号时的竞争条件。攻击者需要发起大量连接尝试，并在身份验证失败时触发竞争条件。成功触发后，攻击者能够在目标系统上执行任意代码。根据 offsec.com 的博客文章，此漏洞利用机会在某些 glibc Linux 发行版中，能将指令插入堆中。

**项目地址:** [almogopp/OpenSSH-CVE-2024-6387-Fix](https://github.com/almogopp/OpenSSH-CVE-2024-6387-Fix)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #12

**来源**: [CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md](../2024/CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许未授权网络访问SSH端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387 (regreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的安全回归漏洞，源于 CVE-2006-5051。这是一个竞争条件漏洞，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内身份验证失败来触发此漏洞。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经公开。多个安全厂商和研究人员已经发布了关于此漏洞的分析和PoC代码。

**投毒风险分析：**

提供的Checker.py脚本的主要功能是检测目标SSH服务器是否存在CVE-2024-6387漏洞。它通过连接到目标服务器的SSH端口并获取SSH banner信息，然后将其与已知易受攻击和已修补的版本进行比较来确定漏洞状态。 代码中没有发现任何明显的恶意或后门代码。

投毒风险评估：0%。该脚本主要用于漏洞检测，不包含任何主动利用漏洞的代码，也没有发现作者隐藏的恶意代码。

**利用方式分析：**

1.  **漏洞原理：** 漏洞是由于 OpenSSH 在处理信号时存在竞争条件，允许在身份验证失败期间执行恶意代码。
2.  **攻击步骤：** 攻击者需要向目标服务器发起大量的SSH连接尝试。
3.  **触发条件：** 在连接尝试期间，攻击者故意使身份验证失败，触发竞争条件。
4.  **利用结果：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码，以root权限运行，或者造成拒绝服务攻击。
5.  **缓解措施：** 通过设置 `LoginGraceTime 0` 禁用 `LoginGraceTime` 参数可以缓解远程代码执行的风险，但仍然存在拒绝服务的风险。更新到OpenSSH 9.8或更高版本是完整的修复方案。

**项目地址:** [anhvutuan/CVE-2024-6387-poc-1](https://github.com/anhvutuan/CVE-2024-6387-poc-1)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #13

**来源**: [CVE-2024-6387-awusan125_test_for6387.md](../2024/CVE-2024-6387-awusan125_test_for6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要目标系统基于 glibc，且 OpenSSH 版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理程序中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用可能允许攻击者在目标系统上以 root 权限执行任意代码或导致拒绝服务。

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞的 PoC 已被公开，并且漏洞利用的复杂性较高。搜索结果表明，该漏洞影响 glibc 基础的 Linux 系统。提供的 POC 代码似乎旨在利用此漏洞。

**投毒风险分析：**
该 POC 代码中存在一定的投毒风险，大约 20%。原因如下：
*   **Shellcode 占位符:** 代码中包含 `unsigned char shellcode[] = "\x90\x90\x90\x90";` 这一行，明确指出需要替换为实际的 shellcode。如果用户不小心使用了该占位符，或者植入了其他有害 shellcode，则可能导致不可预期的后果。
*   **GLIBC 基地址硬编码:** 代码中定义了 `uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`，并表示 “Needs adjustment for specific target systems”。如果 GLIBC 基地址不正确，可能导致利用失败，甚至造成程序崩溃。攻击者可能会故意提供错误的基地址，使得用户在尝试利用时受到干扰，或者执行其他恶意操作。
*   **Timing 参数需要微调:** 代码注释中提到 “Timing parameters: Fine-tune based on target system responsiveness”。如果 timing 参数设置不当，可能导致竞争条件无法触发，或者引发其他问题。攻击者可能会提供误导性的 timing 参数，使得用户在尝试利用时遇到困难，或者触发非预期的行为。
*   **Heap 布局和文件结构偏移量:** 代码注释提到 “Heap layout : Requires tweaking for different OpenSSH versions” 和 “File structure offsets: Verify for the specific glibc version.” 这表示该漏洞利用依赖于特定的堆布局和文件结构偏移量。如果这些值不正确，则可能导致利用失败，甚至造成程序崩溃。攻击者可能会提供不兼容的值，使得用户在尝试利用时受到干扰，或者触发非预期的行为。
*   **错误处理不完善:** 代码中虽然包含了一些错误处理逻辑，但可能存在未处理的异常情况。攻击者可能会利用这些漏洞，使得程序在特定条件下崩溃或执行非预期的操作。

**利用方式：**
利用方式主要涉及以下步骤：
1.  **建立连接：** 与目标 SSH 服务器建立 TCP 连接。
2.  **SSH 握手：** 执行 SSH 握手过程，包括版本交换和密钥交换。
3.  **堆准备：** 通过发送特定的数据包，在堆上创建特定的布局。
4.  **时间控制：** 精确控制数据包的发送时间，以便触发竞争条件。
5.  **竞争条件触发：** 通过大量连接尝试和认证失败，利用信号处理程序的竞争条件在内存中注入恶意代码，通常包括修改 glibc 的数据结构。
6.  **代码执行：** 利用注入的恶意代码来执行任意命令。
7.  **绕过 ASLR：** 由于地址空间布局随机化 (ASLR) 的存在，需要确定 glibc 的基地址。PoC 代码中尝试了几个常见的基地址。

总体而言，该漏洞利用较为复杂，需要对 SSH 协议、glibc 内部机制和竞争条件有深入的了解。该漏洞的成功利用还依赖于目标系统的特定配置和状态。

**项目地址:** [awusan125/test_for6387](https://github.com/awusan125/test_for6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #14

**来源**: [CVE-2024-6387-dream434_CVE-2024-6387.md](../2024/CVE-2024-6387-dream434_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，目标系统运行受影响的OpenSSH版本，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性评估：**

根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已经被广泛讨论。漏洞利用代码的脚本主要用于检测目标主机是否运行存在漏洞的OpenSSH版本，利用方式是扫描目标IP的22端口，获取OpenSSH版本信息，并与已知的易受攻击版本进行比较，从而判断目标系统是否存在漏洞。

**投毒风险分析：**

提供的漏洞利用代码（CVE-2024-6387.py）主要用于版本检测，功能相对简单。虽然`README.md`中包含克隆GitHub仓库的操作，但直接分析提供的Python脚本，发现潜在的投毒点在于以下几个方面：

1.  **依赖包风险：** 脚本本身依赖较少，但如果`README.md`引导用户安装额外的依赖包（例如通过`pip install -r requirements.txt`，而`requirements.txt`包含恶意包），则可能存在投毒风险。
2.  **命令执行风险：** `README.md` 中的运行命令 `python CVE-2024-6387.py http://exemple.com` 虽然看起来无害，但如果 `CVE-2024-6387.py` 存在漏洞，允许通过命令行参数执行恶意代码，则存在风险。当前提供的代码没有直接利用命令行参数执行代码的逻辑。
3.  **文件包含风险：** 如果脚本尝试动态加载其他文件（例如配置文件），而这些文件被篡改，则可能存在风险。

鉴于以上分析，以及`README.md`中存在引导用户克隆github仓库的操作，综合判断，存在较低的投毒风险，约为10%。主要基于假设恶意代码可能存在于被克隆仓库的其他文件中，或者存在利用脚本漏洞执行恶意代码的可能。

**漏洞利用方式：**

1.  **版本检测：** 攻击者首先需要确定目标系统上运行的OpenSSH版本是否在受影响的范围内（8.5p1 <= version <= 9.7p1）。
2.  **触发竞争条件：** 攻击者通过与目标SSH服务器建立连接，并在身份验证过程中故意失败，以触发漏洞相关的竞争条件。
3.  **代码执行：** 成功触发竞争条件后，攻击者可以利用该漏洞在目标系统上执行任意代码，通常以root权限执行。

搜索结果也表明，此漏洞允许未经身份验证的远程代码执行，并且影响基于glibc的Linux系统。因此，利用方式的核心在于触发竞争条件并利用glibc的特性来执行恶意代码。

**项目地址:** [dream434/CVE-2024-6387](https://github.com/dream434/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #15

**来源**: [CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标主机开启SSH服务，且攻击者能够发起大量连接尝试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是一个OpenSSH服务器中的竞争条件漏洞。它源于OpenSSH处理信号的方式，当SSH服务器在短时间内收到大量连接请求且认证失败时，可能导致信号处理不当，进而允许未经验证的远程攻击者在基于glibc的Linux系统上执行任意代码，获取root权限，或者导致拒绝服务。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC已发布，表明漏洞可被利用。提供的Python脚本`CVE-2024-6387-Vulnerability-Checker.py`是一个漏洞检测工具，通过检查SSH banner版本来判断目标是否存在漏洞。脚本本身并不能直接利用该漏洞进行RCE或DoS攻击，而是用来辅助确认目标系统是否在受影响的范围内。

**投毒风险：**
该Python脚本主要功能是检查OpenSSH版本，判断其是否在受影响的范围内。代码本身只包含版本检测逻辑，没有发现任何恶意代码或后门，因此投毒风险极低。可以认为投毒风险为0%。

**利用方式：**
1.  **版本检测：** 使用PoC脚本或类似工具检测目标SSH服务器的版本，确认其是否位于易受攻击的范围(8.5p1 <= OpenSSH <= 9.7p1)。
2.  **触发竞争条件：** 如果目标版本易受攻击，攻击者需要发起大量连接尝试，并在短时间内故意认证失败，以触发竞争条件。
3.  **代码执行（或DoS）：** 成功触发竞争条件后，利用glibc的堆操作特性，攻击者可以插入恶意指令到堆中，从而实现远程代码执行。另一种利用方式是耗尽服务器资源，造成拒绝服务攻击。

需要注意的是，利用此漏洞进行RCE需要对glibc堆操作有一定的了解，并且成功率可能不高。缓解措施包括禁用`LoginGraceTime`配置，并使用`fail2ban`等工具限制恶意连接。

**项目地址:** [filipi86/CVE-2024-6387-Vulnerability-Checker](https://github.com/filipi86/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #16

**来源**: [CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-regreSSHion

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1 (OpenSSH)

**利用条件:** 需要glibc-based Linux系统，以及OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞。漏洞源于OpenSSH服务器处理信号的方式存在问题，具体来说，当用户认证失败时，可能触发不安全的信号处理。远程攻击者可以通过在短时间内发起大量SSH连接尝试，并故意触发认证失败，从而引发竞争条件，最终可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据搜索结果（webpage 1, 3, 4, 5, 7, 8）和漏洞库信息，该漏洞已被确认为一个高危漏洞，并且存在公开的PoC（Proof of Concept）代码。虽然提供的POC代码只是一个包含漏洞描述的README.md文件，**不能直接运行，但是，github上存在可利用的POC**。该POC的有效性取决于目标系统是否满足漏洞利用的条件，即：
1.  使用受影响的OpenSSH版本（<= 9.7p1）。
2.  目标系统是基于glibc的Linux发行版。
3.  系统配置允许一定数量的并发连接。

**投毒风险：**
提供的POC代码（README.md）本身不包含任何可执行代码，因此直接的投毒风险很低。但需要注意的是，任何从互联网上下载的代码都存在潜在的风险。即使是看似无害的文档，也可能包含恶意链接或指令，引导用户下载或执行恶意代码。因此，下载和使用任何PoC代码时，都应该保持警惕，并进行充分的安全审查。

虽然提供的README.md文件本身投毒风险较低,但是考虑到实际利用中需要依赖其他EXP, 因此其他仓库被投毒的可能性相对较高。
风险评估：10%

**利用方式：**
根据漏洞描述和搜索结果，利用方式主要包括以下几个步骤：
1.  **大量连接请求：** 攻击者向目标OpenSSH服务器发起大量的并发连接请求。
2.  **触发认证失败：**  在连接请求中，故意提供错误的用户名或密码，触发认证失败事件。
3.  **竞争条件利用：**  通过大量认证失败事件，触发OpenSSH服务器中的竞争条件漏洞。
4.  **代码执行或DoS：** 成功利用漏洞后，攻击者可以执行任意代码（RCE）或导致服务器崩溃（DoS）。

需要注意的是，利用该漏洞需要一定的资源和技术，并且成功率可能不高。Red Hat 在其安全公告中指出，实现RCE需要相当多的资源投入。同时，修改sshd_config,设置LoginGraceTime为0可以有效避免远程代码执行，但仍存在拒绝服务风险.

**项目地址:** [identity-threat-labs/Article-RegreSSHion-CVE-2024-6387](https://github.com/identity-threat-labs/Article-RegreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #17

**来源**: [CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，sshd服务运行且存在于受影响版本范围内，目标系统是基于glibc的Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中发现的竞争条件漏洞。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发该漏洞。成功利用可能导致以root权限远程执行代码或拒绝服务。该漏洞的利用依赖于触发信号处理程序的竞争条件，攻击者需要发起大量连接尝试才能提高触发漏洞的几率。提供的PoC代码是一个漏洞验证工具，用于检测目标系统上运行的OpenSSH版本是否存在漏洞。它通过连接到目标SSH端口并检查SSH横幅来工作。如果横幅指示易受攻击的版本，则该工具会将目标标记为易受攻击。PoC代码本身似乎不包含任何明显的投毒代码。它仅仅用于验证漏洞是否存在，并不会主动进行利用。

**利用方式：**

1.  攻击者向目标服务器的SSH端口发起大量连接请求。
2.  连接请求需要故意失败，例如提供无效的用户名或密码，以便触发身份验证失败流程。
3.  攻击者利用OpenSSH处理信号时的竞争条件，将恶意指令插入堆中。
4.  如果竞争条件利用成功，攻击者即可在目标系统上以root权限执行任意代码或导致拒绝服务。

**项目地址:** [identity-threat-labs/CVE-2024-6387-Vulnerability-Checker](https://github.com/identity-threat-labs/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #18

**来源**: [CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md](../2024/CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统使用受影响的OpenSSH版本，基于glibc的Linux系统，且未禁用LoginGraceTime

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是一个存在于OpenSSH服务器(sshd)中的竞争条件漏洞。该漏洞源于OpenSSH在处理信号时存在不安全行为。远程攻击者通过在一定时间内认证失败，可以触发此漏洞，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**漏洞利用方式：**

1.  攻击者向目标服务器发起大量的SSH连接请求。
2.  在SSH认证过程中，攻击者故意使认证失败，触发LoginGraceTime超时。
3.  由于竞争条件，sshd可能在处理SIGALRM信号时进入不安全状态。
4.  在glibc-based的Linux系统上，这种不安全状态可能允许攻击者将指令插入到堆中，最终导致RCE。
5.  如果无法实现RCE，攻击者可以通过耗尽服务器资源，导致DoS。

**POC代码分析：**

提供的PoC代码`/tmp/d7c5471d195cdec17d8f4ebaf7516058/CVE-2024-6387_poc.py`的主要功能是检测目标SSH服务器的版本，判断其是否受CVE-2024-6387漏洞影响。它通过建立socket连接，发送`\x00`，接收SSH版本信息，并进行正则匹配来确定OpenSSH的版本。如果版本在易受攻击的范围内（8.5 <= 版本 < 9.8）,则输出目标系统可能存在漏洞。该PoC本身**不包含直接利用漏洞的代码**，仅仅用于版本检测。

`/tmp/d7c5471d195cdec17d8f4ebaf7516058/README.md` 提供了一个使用说明，介绍了如何使用该PoC。`/tmp/d7c5471d195cdec17d8f4ebaf7516058/ip-addr.list`包含需要检查的IP地址列表, 127.0.0.1是示例.

**有效性：**

提供的POC代码的**有效性在于验证目标系统是否存在漏洞**，而非直接利用该漏洞。根据搜索结果和漏洞描述，完整的漏洞利用需要更复杂的步骤和技术，例如大量连接尝试来触发竞争条件，以及精心构造的shellcode。因此，此PoC仅仅是前期验证步骤。

**投毒风险：**

该仓库中存在**投毒风险的可能性较低，约为10%**。PoC代码主要功能是版本检测，本身没有发现恶意代码。潜在的风险可能存在于：

*   `ip-addr.list`文件：虽然当前提供的`ip-addr.list`文件只包含本地地址`127.0.0.1`, 如果用户不小心使用了作者预先设定的其他IP地址列表，可能会导致未授权的扫描或攻击行为。
*   `session.log`文件：虽然日志记录本身不是恶意行为，但如果日志文件被上传或泄露，可能暴露用户的扫描目标信息。日志信息包含IP和端口信息。
*   在实际利用该漏洞时，如果攻击者使用了恶意的Payload，可能会对目标系统造成更大的危害。这些Payload可能被伪装成无害的代码，从而绕过安全检测。
*   如果作者在其他未公开的分支或版本中包含了恶意代码，并且诱导用户使用这些版本，则存在更高的投毒风险。

**综上所述，**虽然提供的PoC代码本身不包含明显的恶意代码，但用户在使用时仍然需要保持警惕，仔细审查代码，并确保从可信的来源获取代码，避免潜在的投毒风险。

**项目地址:** [jocker2410/CVE-2024-6387_poc](https://github.com/jocker2410/CVE-2024-6387_poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #19

**来源**: [CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：**

从搜索结果和漏洞库信息来看，该漏洞存在可利用的POC。提供的Rust代码是一个漏洞检查器，它通过连接到SSH服务器并读取SSH banner来判断目标服务器是否运行着存在漏洞的OpenSSH版本。

**投毒风险：**

提供的代码是一个漏洞检测工具，用于检查目标系统是否存在CVE-2024-6387漏洞。代码功能相对清晰，主要包括：

*   定义了易受攻击和已修补的版本列表。
*   通过TCP连接获取SSH banner。
*   将获取的banner与已知易受攻击的版本进行比较。

代码中没有发现恶意行为，例如执行系统命令或上传/下载文件。因此，**投毒风险较低，判断为0%**。

**利用方式：**

根据漏洞信息和搜索结果，攻击者需要发起大量的连接尝试，以触发sshd中的竞争条件。成功利用该漏洞可能允许攻击者在目标系统上执行任意代码或导致拒绝服务。Offsec的博客提供了关于如何利用该漏洞的更详细的解释。

**总结：**

CVE-2024-6387是一个严重的安全漏洞，允许未经身份验证的攻击者远程执行代码。虽然利用该漏洞需要一定的资源和技术，但由于存在公开的POC，因此建议尽快更新OpenSSH版本。

**项目地址:** [kubota/CVE-2024-6387-Vulnerability-Checker](https://github.com/kubota/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #20

**来源**: [CVE-2024-6387-l-urk_CVE-2024-6387.md](../2024/CVE-2024-6387-l-urk_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH regreSSHion 远程代码执行漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** OpenSSH

**危害等级:** 高危，未授权的远程攻击者可以利用此漏洞以 root 权限执行任意代码，或者造成拒绝服务。

**影响版本:** 8.5p1 ~ 9.7p1

**利用条件:** 目标系统使用受影响的 OpenSSH 版本, 并且基于 glibc 的 Linux 系统。需要网络连通性, 且攻击者需要能够发起大量的 SSH 连接尝试。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，又名 regreSSHion，是 OpenSSH 服务器中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件漏洞，允许未经身份验证的远程攻击者在基于 glibc 的 Linux 系统上执行任意代码。漏洞的利用方式涉及发起大量的 SSH 连接尝试，触发 sshd 进程中的竞争条件，从而允许攻击者将指令插入堆中，最终实现 RCE。

**有效性：**
从搜索结果和漏洞库信息来看，此漏洞是真实存在的，并且存在公开可用的 PoC 代码。PoC 代码的描述也与漏洞描述一致，表明其具有较高的有效性。

**投毒风险：**
提供的 POC 代码库中的 `LISCENCE` 文件声明了严格的权限限制，这在一定程度上增加了投毒的可能性。虽然无法通过现有信息完全确定是否存在投毒代码，但需要对脚本进行仔细审查，特别注意以下几个方面：

*   **shellcode:**  分析 shellcode 的行为，确保其功能与漏洞利用目的相符，没有恶意行为。
*   **网络连接:**  检查代码中是否存在额外的网络连接，特别是连接到未知或可疑的 IP 地址。
*   **文件操作:**  检查代码中是否存在对系统文件的修改或删除操作。
*   **依赖项:**  审查 `requirements.txt` 文件中的依赖项，确保没有引入恶意的第三方库。

考虑到需要大量连接尝试和对堆的操纵，以及许可证的严格声明，综合评估投毒风险为10%。这部分代码逻辑比较复杂，存在隐藏恶意代码的可能性。

**利用方式：**
1.  攻击者通过网络向目标 OpenSSH 服务器发起大量的连接请求。
2.  利用 OpenSSH 服务器处理连接请求时存在的竞争条件，特别是在信号处理方面。
3.  通过精心构造的数据包，将恶意代码注入到服务器的堆内存中。
4.  触发执行注入的恶意代码，从而获得对目标系统的控制权 (RCE) 或导致拒绝服务 (DoS)。
5.  默认的shellcode打开9999端口,并使用nc进行监听。

**项目地址:** [l-urk/CVE-2024-6387](https://github.com/l-urk/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #21

**来源**: [CVE-2024-6387-lflare_cve-2024-6387-poc.md](../2024/CVE-2024-6387-lflare_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是OpenSSH服务器(sshd)中的一个竞争条件漏洞，源于CVE-2006-5051的安全回归。当sshd在不安全的方式下处理某些信号时，未经验证的远程攻击者可能通过在设定的时间内未能成功验证身份来触发此漏洞。

**有效性评估：**
根据漏洞信息和搜索结果，此漏洞的PoC已经发布，并且被广泛讨论，证明了其有效性。PoC代码（`7etsuo-regreSSHion.c`）尝试利用此漏洞，通过以下步骤：

1.  **连接建立：** 与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH协议握手。
3.  **堆准备：** 准备堆布局以进行利用。
4.  **时间测量：** 测量数据包解析时间。
5.  **竞争条件尝试：** 尝试触发竞争条件，利用信号处理中的不安全函数调用，最终目标是执行shellcode，提权至root。
6.  **ASLR绕过：**尝试不同的glibc基地址，以绕过地址空间布局随机化(ASLR)。

代码中包含了尝试20000次利用的循环，以及100ms的延时，这些都符合漏洞分析文章的描述，增加了利用成功的可能性。

**投毒风险评估：**

此PoC代码存在一定程度的投毒风险，因为:

1.  **Shellcode:** PoC代码包含一个shellcode占位符，攻击者需要替换成真实的shellcode。如果提供的shellcode本身是恶意的，那么使用此PoC会导致投毒。
2. **glibc地址:** PoC代码包含glibc基址，攻击者需要手动调整为目标系统的基址。如果提供的基址不正确，或者根本无法确定正确的基址，会影响利用成功率。如果攻击者故意提供错误的基址或者使用错误的基址绕过策略，也有可能导致拒绝服务。
3.  **定时参数：** PoC代码中的定时参数需要根据目标系统的响应速度进行调整。如果定时不当，可能导致利用失败，甚至使目标系统崩溃。
4.  **heap布局:** OpenSSH的堆布局会随着版本的变化而变化，需要针对不同的版本进行调整。如果不调整，可能无法成功利用。

**评估：**
PoC代码的编写者可能在代码中加入不易察觉的恶意行为，例如收集目标系统信息并发送到远程服务器等。但是，考虑到PoC的主要目的是为了验证漏洞，因此这种风险相对较低。PoC中已经存在大量的需要修改的地方，需要使用者有一定的漏洞知识储备，因此投毒风险相对较低。

**综合评估**：PoC中投毒风险预估为10%，

**利用方式总结：**

1.  攻击者首先需要与目标OpenSSH服务器建立连接。
2.  然后，攻击者需要执行SSH握手协议。
3.  接着，攻击者发送特制的数据包，触发sshd中的竞争条件。
4.  竞争条件允许攻击者覆盖内存中的关键数据结构。
5.  攻击者通过覆盖的数据结构，执行预先准备好的shellcode，从而获得目标系统的root权限。
6. 利用过程需要绕过ASLR保护，这可能需要多次尝试，或者使用其他信息泄露漏洞。
7. 攻击需要一定的timing， 把握好发送数据包的时间。

**项目地址:** [lflare/cve-2024-6387-poc](https://github.com/lflare/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #22

**来源**: [CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387是一个OpenSSH服务器(sshd)中的安全回归漏洞，存在于OpenSSH 8.5p1到9.7p1版本。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。远程攻击者可以通过在设定的时间内认证失败来触发此漏洞，可能导致远程代码执行或拒绝服务。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已确认存在，并且有POC代码可用。搜索引擎结果中的多个链接指向了漏洞分析、利用和修复方法，以及相关的讨论。

**投毒风险：**
提供的POC代码包含一个Python脚本（main.py）和一个README.md文件。脚本内容主要用于识别易受攻击的OpenSSH服务器，并无发现任何恶意代码或者后门，但是不排除后续增加投毒代码的可能性, 因此投毒风险极低。

**利用方式：**
1.  攻击者需要发起大量SSH连接到目标服务器。
2.  在LoginGraceTime时间内，故意使认证失败。
3.  利用竞争条件，使sshd以不安全的方式处理信号。
4.  如果成功，攻击者可能能够执行任意代码或导致服务崩溃（拒绝服务）。

**缓解措施：**
*   将OpenSSH升级到9.8或更高版本。
*   设置`LoginGraceTime 0`可以缓解RCE，但不能完全避免DoS攻击，建议结合`fail2ban`和防火墙使用。

**项目地址:** [moften/regreSSHion-CVE-2024-6387](https://github.com/moften/regreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #23

**来源**: [CVE-2024-6387-prelearn-code_CVE-2024-6387.md](../2024/CVE-2024-6387-prelearn-code_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 远程代码执行

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行

**影响应用:** OpenSSH

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (glibc-based Linux systems)

**利用条件:** 目标系统需要运行受影响版本的OpenSSH，且基于glibc。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，也被称为"regreSSHion"，是OpenSSH服务器（sshd）中的一个安全漏洞，是CVE-2006-5051的一个回归。它是由信号处理中的竞争条件引起的。未经身份验证的远程攻击者可以通过在设定的时间内未能成功进行身份验证来触发此漏洞，可能导致以root权限执行任意代码。该漏洞影响基于glibc的Linux系统上的OpenSSH 8.5p1到9.7p1版本。

**有效性：**
根据漏洞库信息、搜索结果（特别是来自Qualys和offsec的分析），以及POC代码的存在，可以判断该漏洞是有效的，并且存在可利用的POC。

**投毒风险：**
POC代码中存在一定的投毒风险。虽然代码的目的是利用该漏洞，但攻击者可能会修改shellcode以进行恶意活动，或者在代码中加入额外的后门。例如，`shellcode`变量中包含占位符，需要替换为实际的shellcode。如果用户从不可信来源下载POC，并使用了包含恶意shellcode的POC，则可能存在投毒风险。代码中定义了多个glibc地址用于绕过ASLR，攻击者可以伪造错误的地址，来扰乱攻击。

**利用方式：**
利用方式涉及以下几个步骤：

1.  **建立连接：** 攻击者首先与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH握手过程，包括版本交换和密钥交换的初始化。
3.  **堆准备：** 发送特定的SSH数据包，以在sshd进程的堆上创建特定的内存布局，为利用创造条件。
4.  **触发竞争条件：** 攻击者触发一个竞争条件，该条件涉及OpenSSH处理信号的方式，利用SIGALRM信号处理程序中的不安全函数调用。
5.  **地址绕过：** 通过尝试多个可能的glibc基址，绕过地址空间布局随机化 (ASLR)。
6.  **执行代码：** 成功触发竞争条件后，将恶意shellcode注入到内存中并执行，从而获得远程代码执行权限（通常以root权限）。

**缓解措施包括：**
*   禁用`LoginGraceTime`参数，虽然不能完全阻止DoS，但可以防御RCE。
*   使用`fail2ban`等工具监控日志文件并管理连接。
*   及时更新到OpenSSH的修复版本。

**项目地址:** [prelearn-code/CVE-2024-6387](https://github.com/prelearn-code/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #24

**来源**: [CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md](../2024/CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，glibc-based Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387是一个OpenSSH服务器中的竞争条件漏洞（源于CVE-2006-5051的回归）。未经身份验证的远程攻击者可以通过在设定的时间内未能完成身份验证来触发此漏洞。利用方式是发送大量连接请求，触发竞争条件，在glibc-based Linux系统上可能导致在堆中插入恶意指令，最终实现远程代码执行或拒绝服务。提供的脚本并非POC，而是缓解措施：

1.  **有效性：** 提供的脚本实际上是一个缓解脚本，通过将`LoginGraceTime`设置为0来减少漏洞被利用的可能性，并不能直接验证漏洞，缓解脚本会禁用SSHD服务器在指定超时时间内未完成身份验证时断开连接的能力。虽然降低了RCE的风险，但增加了拒绝服务(DoS)的风险。

2.  **投毒风险：** 提供的脚本目的是缓解漏洞，没有发现任何隐藏的恶意代码，因此投毒风险为0%。

3.  **利用方式：** 根据漏洞信息和搜索结果，利用方式是未认证的攻击者向目标OpenSSH服务器发送大量连接请求，由于竞争条件的存在，sshd可能以不安全的方式处理信号，从而允许攻击者执行任意代码（RCE）或造成拒绝服务(DoS)。攻击成功的关键在于触发竞争条件，因此需要大量的并发连接尝试。


**项目地址:** [redux-sibi-jose/mitigate_ssh](https://github.com/redux-sibi-jose/mitigate_ssh)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #25

**来源**: [CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md](../2024/CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，并且攻击者能够建立SSH连接并触发竞争条件。攻击者需要尝试大量连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全漏洞，源于信号处理中的竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：** 根据漏洞库信息和搜索结果，此漏洞存在PoC。该漏洞的利用依赖于触发竞争条件，因此需要进行大量的连接尝试。

**投毒风险：** 分析提供的PoC代码，主要包含一个检测脚本（detection-script.py）和一个README。检测脚本尝试建立到目标SSH服务器的连接，并发送SSH协议版本字符串，然后读取服务器的响应。LICENSE文件和README.md文件是标准格式，描述了漏洞信息。由于检测脚本本身较为简单，且没有发现明显的恶意代码，因此投毒的风险较低，约为10%。 但是需要人工review所有代码.特别是二进制文件.

**利用方式：** 利用此漏洞需要：
1.  攻击者向目标服务器上的sshd服务发起大量的连接请求。
2.  在连接建立但身份验证尚未完成时，利用竞争条件触发信号处理错误。
3.  如果成功利用，攻击者可以在目标系统上执行任意代码，获得root权限（根据漏洞描述和搜索结果）。

利用的复杂性在于需要精确地控制时序，以触发竞争条件。这通常需要大量的计算资源和对目标系统行为的深入了解。同时该漏洞在glibc-based Linux systems更有效,可能无法在所有系统上利用。

**项目地址:** [s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH](https://github.com/s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #26

**来源**: [CVE-2024-6387-wiggels_regresshion-check.md](../2024/CVE-2024-6387-wiggels_regresshion-check.md)

# CVE-2024-6387

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-6387-AzrDll_CVE-2024-6387.md](../2024/CVE-2024-6387-AzrDll_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH 竞争条件导致 RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。需要发起大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务中的一个竞争条件漏洞，源于 CVE-2006-5051 的回归。未经身份验证的远程攻击者可以通过在短时间内发起大量失败的身份验证尝试来触发此漏洞。利用此漏洞需要在glibc堆中插入指令，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞确实存在，并且有公开的PoC利用代码。该PoC通过建立大量的 SSH 连接并进行不成功的身份验证来触发竞争条件。参考[webpage 3]，此漏洞允许glibc Linux发行版在堆中插入指令，从而实现代码执行。提供的PoC代码尝试利用这一点，但成功率可能较低，因为竞争条件需要精确的时间控制。

**投毒风险：**
提供的PoC代码`/tmp/fe03af2a23123389ff9785e2fb119f2c/PoC.py` 包含了从文件中读取glibc地址的功能。 虽然代码本身没有明显的恶意行为，但如果提供的 `glibc_file` 包含恶意构造的地址，可能会导致非预期的行为，甚至导致拒绝服务。例如，如果`glibc_base`地址指向了关键系统函数，覆盖该地址可能造成系统崩溃。另一个潜在的风险点是 `timing_adjustment`，如果调整不当可能造成DoS。综上所述，投毒风险为10%。主要是考虑到作者可能在利用代码的 `glibc_file` 参数中提供恶意的 glibc 地址，诱导用户使用，从而达到破坏目标系统的目的。

**利用方式：**
1.  **建立连接：** 攻击者首先建立与目标 OpenSSH 服务器的 TCP 连接。
2.  **SSH 握手：** 攻击者执行 SSH 握手过程，例如发送 SSH 版本字符串。
3.  **堆准备：** PoC尝试在堆上分配一些数据，为利用竞争条件做准备。
4.  **触发竞争条件：**  通过快速发送大量失败的身份验证请求，攻击者试图触发 `sshd` 进程中的竞争条件。这涉及利用 `LoginGraceTime` 参数，该参数允许攻击者在身份验证超时之前发送多个请求。根据[webpage 6]，利用此漏洞需要大量连接尝试才能准确触发竞争条件。
5.  **代码执行：**  如果竞争条件被成功触发，攻击者可以在内存中写入恶意代码，从而实现远程代码执行。提供的 PoC 代码尝试通过覆盖 glibc 的地址来实现这一点。如果成功利用，攻击者可以获得 root 权限，如[webpage 1][webpage 4]所描述。
6.  **拒绝服务：** 即使未能成功实现 RCE，攻击者也可能通过耗尽服务器资源来实现拒绝服务。由于竞争条件涉及信号处理，不正确的信号处理可能导致 `sshd` 崩溃。

**项目地址:** [AzrDll/CVE-2024-6387](https://github.com/AzrDll/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #2

**来源**: [CVE-2024-6387-DimaMend_cve-2024-6387-poc.md](../2024/CVE-2024-6387-DimaMend_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行(RCE)和拒绝服务(DoS)

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，并且目标系统基于glibc。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全漏洞，它是由CVE-2006-5051引入的回归错误。该漏洞是一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**利用方式：**

1.  **建立连接：** 攻击者首先与易受攻击的OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者尝试进行SSH握手，但故意不完成身份验证过程。这是为了触发`LoginGraceTime`超时。
3.  **堆准备：** 攻击者发送一系列SSH数据包，旨在操纵服务器的内存堆的布局。 这可能涉及到分配和释放内存，以便为利用创造合适的条件。
4.  **触发竞争条件：** 攻击者利用`LoginGraceTime`超时机制。当服务器由于握手超时而即将终止连接时，会发送一个信号。 攻击者尝试与此信号处理程序执行竞争，以修改服务器的内存。
5.  **代码执行：** 如果竞争成功，攻击者可以将恶意代码注入到服务器的内存中，并获得代码执行能力。 根据具体利用方式，这可能导致以root权限执行代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞的利用是可行的。许多信息源表明，存在公开可用的PoC，并且已经有人成功利用了此漏洞。 PoC代码的功能是尝试利用这个竞态条件。

**投毒风险分析：**

PoC代码中存在投毒代码的风险很低，原因如下：

*   **代码结构：** 代码主要集中于建立连接、进行SSH握手、操纵堆内存以及尝试触发竞态条件。虽然代码较为复杂，但在总体流程上没有明显的恶意操作。
*   **Shellcode占位符：** 代码中存在一个 `shellcode` 占位符，明确提示用户需要替换成实际的 shellcode。这表明作者的意图是提供一个框架，而不是一个直接可用的恶意载荷。
*   **注释和说明：** 代码包含大量的注释和说明，解释了漏洞的原理、利用方法以及需要调整的参数。这表明作者的目的是帮助研究人员理解和复现漏洞，而不是隐藏恶意代码。
*   **随机性和尝试次数：** 代码包含大量的随机尝试，目的是为了提高漏洞利用的成功率。这种随机性使得代码难以预测，也增加了作者插入恶意代码的难度。
*   **外部依赖：** 代码没有包含明显的外部依赖或网络请求，这降低了其被用于下载或执行恶意代码的风险。

虽然直接投毒的可能性较低，但仍然存在一些潜在风险，比如在 `shellcode` 占位符中插入恶意代码，或者在调整参数的过程中引入错误，导致程序行为异常。因此，在使用 PoC 代码时，仍然需要进行仔细的代码审查和安全测试。

综上所述，此仓库中存在作者隐藏的投毒代码的可能性估计为1%。

**项目地址:** [DimaMend/cve-2024-6387-poc](https://github.com/DimaMend/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #3

**来源**: [CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行存在漏洞版本的OpenSSH服务，且攻击者能够建立SSH连接，并在认证超时前发送恶意数据。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，存在于glibc的linux系统。它源于一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该漏洞是有效的。多个来源都确认了该漏洞的存在以及其远程代码执行的潜力。POC代码的存在进一步支持了其可利用性。

**投毒风险：**

POC代码本身包含以下潜在的投毒风险点：

*   **Shellcode占位符:** 代码中明确提到 `Shellcode placeholder (replace with actual shellcode)`。如果用户直接使用未经审查的 shellcode，则可能引入恶意行为。此处的风险不在于作者投毒，而在于用户使用不当。
*   **GLIBC_BASES:**  `GLIBC_BASES[]` 数组包含可能的 glibc 基地址。如果这个地址不准确，利用将失败。如果作者故意提供错误的地址，可能会导致拒绝服务或误导分析。
*   **Timing parameters:** 注释提到需要根据目标系统调整 timing 参数。错误的 timing 可能导致利用失败或系统不稳定。
*   **Heap layout 和 File structure offsets:**  代码注释中也强调了需要针对不同的 OpenSSH 和 glibc 版本进行调整，否则利用会失败。故意设置错误的值可能导致程序崩溃或产生其他未定义行为。
*   **随机数生成:** 代码使用 `srand(time(NULL))` 初始化随机数生成器。虽然这本身不是投毒，但如果后续利用中依赖于可预测的随机数，可能会被利用。

总体评估投毒风险为30%。风险主要来自于需要用户自行替换的shellcode，以及需要用户根据目标环境配置的参数。作者本身隐藏恶意代码的可能性较低，但用户在使用过程中存在引入风险的可能性。

**利用方式：**

1.  **建立连接：** 攻击者首先需要建立与目标 OpenSSH 服务器的连接。
2.  **SSH握手：** 进行初步的SSH握手过程，包括版本协商和密钥交换的初始化，但无需完成身份认证。
3.  **堆准备：**  `prepare_heap` 函数的目的是在堆上创建特定的布局，为后续的利用创造条件。具体实现细节未给出，但可能涉及分配和释放内存，以控制堆的状态。
4.  **时间测量：** `time_final_packet` 函数测量服务器处理特定数据包所需的时间。这个时间信息对于后续的竞争条件利用至关重要。
5.  **竞争条件：**  `attempt_race_condition` 函数尝试触发漏洞的核心：信号处理程序中的竞争条件。这通常涉及发送一个精心构造的数据包，该数据包会在服务器处理过程中触发 SIGALRM 信号。由于信号处理程序使用了异步信号不安全函数，因此可能导致堆损坏。
6.  **代码执行：**  如果竞争条件成功触发，攻击者就可以利用堆损坏来执行任意代码。这通常涉及覆盖函数指针或控制程序的执行流程。

该漏洞的利用依赖于精确的 timing 和对目标系统内存布局的了解。攻击者需要进行大量的尝试才能成功利用该漏洞。

**项目地址:** [HadesNull123/CVE-2024-6387_Check](https://github.com/HadesNull123/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #4

**来源**: [CVE-2024-6387-Karmakstylez_CVE-2024-6387.md](../2024/CVE-2024-6387-Karmakstylez_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器(sshd)中的一个安全回归漏洞，存在于glibc-based Linux系统。该漏洞源于信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。该漏洞利用代码尝试通过大量的连接请求触发竞争条件，通过调整glibc基地址和定时参数绕过ASLR，将恶意代码注入到堆中，最终实现以root权限远程代码执行。

有效性：根据漏洞信息和搜索结果，此POC代码具备一定的有效性，但成功利用需要满足特定条件，例如目标系统使用glibc，以及OpenSSH版本在受影响范围内。同时，漏洞利用的成功率受到系统负载、网络延迟等因素的影响，需要进行大量的尝试。

投毒风险：POC代码中存在一定的投毒风险。虽然POC代码的主要目的是利用已知的漏洞，但攻击者可能在代码中加入恶意功能，例如植入后门、收集敏感信息等。例如，shellcode 部分是明显的注入点。风险评定为10%，主要基于以下几点：
1.  **Shellcode 替换：** 代码明确指出 `shellcode` 变量是占位符，需要替换为实际的 shellcode。如果用户不小心使用了包含恶意指令的 shellcode，则可能导致投毒。
2.  **glibc 基地址猜测：** 虽然代码尝试多个 glibc 基地址，但如果攻击者预先知道目标系统的 glibc 地址，则可以修改 `GLIBC_BASES` 数组以提高利用成功率，同时也可能引入恶意地址。
3.  **Timing 参数调整：** 代码中的 `usleep` 函数用于控制连接尝试之间的延迟。攻击者可以通过调整这些参数来优化漏洞利用，但也可能引入导致拒绝服务 (DoS) 的参数。
4.  **编译选项：**POC 需要编译，攻击者可以在编译时添加额外的恶意编译选项，例如禁用安全特性等。
5.  **作者本身:** 仓库作者有投毒行为.

利用方式：
1.  攻击者首先需要确定目标系统是否运行受影响的OpenSSH版本，以及是否基于glibc。
2.  攻击者发起大量的SSH连接请求，尝试触发竞争条件。
3.  攻击者利用精心构造的数据包覆盖堆上的特定内存区域，将恶意代码注入到sshd进程中。
4.  一旦恶意代码成功执行，攻击者即可获得目标系统的控制权。

**项目地址:** [Karmakstylez/CVE-2024-6387](https://github.com/Karmakstylez/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #5

**来源**: [CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md](../2024/CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md)

## CVE-2024-6387-OpenSSH-RegreSSHion-RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行并获取 root 权限或造成拒绝服务

**影响版本:** <= 9.7p1 (受影响版本 8.5p1 至 9.7p1)

**利用条件:** 需要目标服务器运行受影响版本的OpenSSH，且存在时间窗口内的未认证连接尝试。高危利用场景依赖glibc环境。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-6387，也被称为“regreSSHion”，是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞（CVE-2006-5051）。该漏洞源于信号处理中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC已经存在，并且能够实现远程代码执行和拒绝服务攻击。很多安全厂商和研究人员都发布了相关的分析报告和PoC代码。

**投毒风险：**
提供的漏洞利用代码（/tmp/270e32ae67508359811c0f9899155269/README.md 和 LICENSE）仅仅是声明了存在POC，根据现有信息，该仓库本身存在恶意代码的风险较低。但是，由于POC的执行具有高危性，在实际使用中，仍需要进行安全审查。

**利用方式：**
1.  **竞争条件：** 攻击者通过在短时间内发起大量未认证的连接尝试，触发 `sshd` 中的竞争条件。
2.  **信号处理：** 在特定的时间窗口内，`sshd` 可能会以不安全的方式处理信号，导致内存损坏或其他异常行为。
3.  **远程代码执行/拒绝服务：**  利用内存损坏或其他异常行为，攻击者可以执行任意代码（RCE），或导致 `sshd` 崩溃，造成拒绝服务（DoS）。部分利用依赖特定的glibc环境。
4.  **ProxyCommand注入:** 根据github仓库的README.md描述，该POC利用了 `ProxyCommand` 配置不当或滥用的情况，攻击者可以注入恶意命令到 `ProxyCommand` 中，从而获得命令执行或者横向渗透的能力。

**缓解措施：**
*   升级到 OpenSSH 9.8 或更高版本。
*   设置 `LoginGraceTime 0` 以禁用在指定超时时间内未完成身份验证时服务器断开连接的功能（Red Hat 建议的临时缓解措施，但会使服务器更容易受到 DoS 攻击）。
*   使用 `fail2ban` 等工具，配合防火墙来监控日志文件并适当管理连接。

**项目地址:** [Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC](https://github.com/Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #6

**来源**: [CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md](../2024/CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）或拒绝服务（DoS）

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。它是一个竞争条件漏洞，可能导致sshd以不安全的方式处理信号。远程攻击者可以通过在设定的时间内未能成功验证身份来触发此漏洞，从而可能导致远程代码执行或拒绝服务。

**有效性评估：**

根据漏洞库信息、搜索结果以及提供的POC代码来看，此漏洞的POC是存在的，并且多个安全厂商都发布了相关的分析报告和检测方法。搜索结果也表明此漏洞允许远程未授权代码执行。

**利用方式：**

1.  攻击者建立与目标OpenSSH服务器的连接。
2.  进行SSH握手，获取服务器banner。
3.  准备堆，发送一定量的填充数据。
4.  尝试触发竞争条件，通过发送包含`glibc_base`地址的payload，并附加一些`nop`指令。
5.  如果成功，则在服务器上执行代码，获得root权限。
6.  脚本使用了多线程来增加攻击成功的几率，并对时序进行调整。

**投毒风险评估：**

提供的POC代码（`Exploit_2024_6387.py`）本身是一个漏洞利用脚本，其目的是利用目标系统的漏洞。评估投毒风险主要关注作者是否在脚本中植入了恶意代码，例如：

*   **后门代码：**  脚本在成功利用漏洞后，是否会创建一个后门，允许攻击者在未经授权的情况下再次访问系统。
*   **破坏性代码：**  脚本是否包含旨在破坏目标系统或数据的代码。
*   **信息窃取代码：**  脚本是否会窃取目标系统上的敏感信息。

分析代码发现，虽然脚本本身旨在利用漏洞，但并未发现明显的后门、破坏性或信息窃取代码。 然而，需要注意的是，该脚本的`TARGET_IP`和`TARGET_PORT`是硬编码的，在实际使用中需要进行修改。此外，攻击者可能会修改此脚本以包含恶意功能。此处的`glibc_base`地址也需要根据目标环境进行调整，否则利用大概率会失败，这也是成功利用此漏洞的难点之一。

综合来看，该仓库存在投毒风险的可能性较低，但是不排除有攻击者对代码进行修改后，二次传播。因此，建议在使用前仔细审查代码。

**风险评估：**
`poison`的百分比评估主要考虑以下几个方面：

*   **代码复杂性：** 代码越复杂，隐藏恶意代码的可能性越高。
*   **作者信誉：** 如果作者的信誉未知或可疑，则风险越高。
*   **代码审查：** 代码是否经过其他安全研究人员的审查。

根据以上分析，此脚本的`poison`风险评估为10%。

**项目地址:** [SkyGodling/CVE-2024-6387-POC](https://github.com/SkyGodling/CVE-2024-6387-POC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #7

**来源**: [CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md](../2024/CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，未认证的远程攻击者通过在设定的时间内认证失败触发

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞(CVE-2006-5051)。它存在一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，进而导致远程代码执行(RCE)或拒绝服务(DoS)。

根据搜索结果和漏洞信息，该漏洞影响glibc-based Linux系统，利用需要发起大量连接尝试来触发竞争条件。

提供的漏洞利用代码 `scanner.py` 是一个版本扫描器，并非直接利用 CVE-2024-6387。它用于检测目标 SSH 服务器的版本，并根据预定义的 CVE 列表判断是否存在已知的漏洞。该脚本通过创建 socket 连接到目标主机的 SSH 端口，然后发送一个空字节并接收服务器的响应，从中提取 OpenSSH 的版本信息。然后将提取的版本与易受攻击的版本列表进行比较。

**漏洞利用方式：**

1.  攻击者需要向目标 OpenSSH 服务器发起大量的连接请求。
2.  在连接建立后，故意触发认证失败，从而在信号处理过程中创建竞争条件。
3.  竞争条件允许攻击者在某些 glibc Linux 发行版中将指令插入堆中，进而实现远程代码执行。

**投毒风险：**

虽然脚本本身是一个版本扫描器，而不是直接的漏洞利用程序，但仍需谨慎评估其潜在的投毒风险。 代码中存在创建日志目录并记录扫描结果的行为，存在恶意修改扫描逻辑或在日志中写入恶意数据，但可能性极低。因此，评估投毒风险为1%。

**项目地址:** [ThatNotEasy/CVE-2024-6387](https://github.com/ThatNotEasy/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #8

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 远程代码执行/拒绝服务

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1，受影响版本包括8.5p1至9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且攻击者能够发起大量连接请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞，它源于 CVE-2006-5051。该漏洞是一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间段内未能通过身份验证来触发此漏洞。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的PoC代码是有效的。多个来源证实了该漏洞的存在和可利用性，特别是针对glibc的Linux系统。

**投毒风险：**

提供的PoC代码包含用于编译、构建和利用漏洞的Dockerfile和Python脚本。通过分析代码，可以发现以下潜在的投毒风险因素：

*   **依赖项：** Dockerfile中使用了`wget`和`curl`来下载OpenSSH源码，存在被中间人攻击替换为恶意源码的风险。尽管校验和可以降低这种风险，但如果攻击者能够控制构建环境，仍然可能引入恶意代码。
*   **shellcode：** Python脚本包含一个名为`shellcode`的变量，目前只是占位符，但攻击者可以修改此变量，插入恶意shellcode。攻击者可以精心构造shellcode，以执行恶意操作，例如安装后门、窃取数据或提权。

虽然这些风险存在，但从现有代码来看，没有发现明显的恶意代码。因此，评估投毒风险为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的OpenSSH环境（32位Linux系统）。
2.  **SSH握手：** 客户端与服务器建立连接，发送SSH版本信息并进行密钥交换（KEX）初始化。
3.  **堆准备：** 通过发送特定大小的数据包来布置堆内存，利用glibc的漏洞插入恶意指令。
4.  **触发竞争条件：** 大量连接尝试来触发信号处理程序中的竞争条件。
5.  **执行代码：** 成功触发竞争条件后，恶意代码将被执行，从而实现远程代码执行。

总体来说，利用方式较为复杂，需要精心构造数据包和进行大量的连接尝试才能成功。

**项目地址:** [YassDEV221608/CVE-2024-6387](https://github.com/YassDEV221608/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #9

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 9.7p1 (影响 8.5p1 到 9.7p1)

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，并且是基于glibc的Linux系统。攻击者需要能够建立到SSH服务的网络连接，并能够快速发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中发现的一个安全回归漏洞，存在于glibc的Linux系统中。该漏洞是由于OpenSSH服务器（sshd）中的信号处理存在竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用此漏洞可能导致以 root 身份远程执行代码。

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果也确认了该漏洞的存在，并描述了其可能导致远程代码执行的风险。漏洞利用代码的存在也进一步证实了漏洞的有效性，代码尝试利用竞争条件来执行任意代码。

**投毒风险：**
代码存在一定的投毒风险的可能性。虽然代码本身看起来是在尝试利用该漏洞，但以下因素需要考虑：

1.  **Shellcode占位符：** 代码中包含一个shellcode占位符`unsigned char shellcode[] = "\x90\x90\x90\x90";`，明确指示需要替换成实际的shellcode。如果用户没有意识到这一点，或者使用了恶意shellcode，可能会造成损害。这里的投毒风险在于，攻击者可能发布包含恶意shellcode的exp，诱导用户使用。 
2.  **GLIBC_BASES：** 代码中定义了`GLIBC_BASES[]`，用于绕过ASLR。如果这些地址不正确，利用将失败。更糟糕的是，如果攻击者故意提供错误的地址，可能会导致程序崩溃或其他不可预测的行为。
3.  **Timing parameters和 Heap layout 需要调整：** 代码注释中强调了定时参数和堆布局需要根据目标系统进行调整。如果这些参数设置不正确，可能会导致利用失败或目标系统不稳定。
4.  **文件结构偏移量：** 代码提到需要验证特定glibc版本的文件结构偏移量。使用错误的偏移量可能导致内存损坏或其他不可预测的行为。

总体来看，该POC的复杂性和对系统内部结构的依赖性，投毒者可以通过提供不正确的配置参数，或者引导用户使用错误的shellcode，达到破坏目标系统的目的。因此存在10%的投毒风险。

**利用方式：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **建立连接：** 攻击者首先需要与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者需要完成初始的SSH握手过程，包括协议版本交换和密钥交换初始化（KEX）。
3.  **堆准备：** 攻击者利用SSH协议发送数据包，在内存堆上布置精心构造的数据结构，为后续的漏洞利用做准备。
4.  **触发竞争条件：** 攻击者发送一个特制的SSH数据包，该数据包的设计是为了触发sshd中的竞争条件。具体来说，它利用了在身份验证失败的情况下，信号处理程序中的不安全操作。
5.  **RCE：** 成功触发竞争条件后，攻击者可以将恶意代码注入到sshd进程中，从而实现远程代码执行。具体是通过内存操作覆盖某个函数指针，使其指向攻击者提供的shellcode。
6.  **提权（Root）：** 由于sshd通常以root权限运行，因此攻击者执行的shellcode也将以root权限运行，从而完全控制目标系统。

**项目地址:** [YassDEV221608/CVE-2024-6387_PoC](https://github.com/YassDEV221608/CVE-2024-6387_PoC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #10

**来源**: [CVE-2024-6387-alex14324_ssh_poc2024.md](../2024/CVE-2024-6387-alex14324_ssh_poc2024.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）和拒绝服务（DoS）

**影响版本:** <= 9.7p1

**利用条件:** 需要目标系统开启sshd服务，且受影响的OpenSSH版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是一个存在于OpenSSH服务器（sshd）中的安全漏洞，具体来说是一个竞争条件漏洞。该漏洞源于OpenSSH处理信号的方式。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，导致sshd以不安全的方式处理信号。这可能导致远程代码执行（RCE），攻击者获得root权限，或拒绝服务（DoS），使服务器不可用。

**有效性分析：**
从漏洞库信息、搜索结果和提供的PoC代码来看，该漏洞的PoC是存在的，并且被广泛讨论和利用。 搜索结果中提到“regreSSHion (CVE-2024-6387) is an unauthenticated RCE vulnerability in OpenSSH’s server, affecting glibc-based Linux systems. Full root access is granted.” 表明该漏洞有很高的潜在影响. PoC代码也试图绕过ASLR，并包含shellcode的占位符，表明攻击者可以注入恶意代码。

**投毒风险分析：**
提供的PoC代码具有一定的投毒风险，大约为10%。主要基于以下几点：
1.  **Shellcode占位符：** 代码中包含`unsigned char shellcode[] = "\x90\x90\x90\x90";`。虽然这只是一个占位符，需要用户替换为实际的shellcode，但攻击者可能发布包含恶意shellcode的版本，诱导用户使用。
2.  **GLIBC_BASES地址：**  代码中包含了`uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`。这些地址是ASLR绕过的尝试，但如果攻击者故意提供错误的地址，可能导致利用失败或者其他未知的行为，但一般不会产生特别大的危害。
3.  **Timing参数：** 代码中需要根据目标系统响应调整Timing参数。攻击者可能提供不合适的参数，导致利用不稳定或者失败。
4.  **Heap Layout和文件结构偏移：**  代码注释中提到“Heap layout : Requires tweaking for different OpenSSH versions.” 和 “File structure offsets: Verify for the specific glibc version.”。攻击者可能故意提供错误的值，导致利用失败或者产生其他问题。

**利用方式：**
1.  **建立连接：** 攻击者首先需要与目标服务器的sshd服务建立TCP连接。
2.  **SSH握手：** 进行SSH握手，包括版本交换、密钥交换等步骤。PoC代码中的 `perform_ssh_handshake` 函数实现了这些步骤。
3.  **堆准备：** 通过发送特定的SSH数据包，在sshd进程的堆上分配内存，并控制堆的布局。`prepare_heap` 函数用于执行此操作。
4.  **时间计算：**  计算处理最终数据包所需的时间，用于后续的竞争条件利用。`time_final_packet` 函数用于执行此操作。
5.  **竞争条件利用：**  通过大量并发连接，触发sshd中的竞争条件漏洞。攻击者不断尝试进行身份验证，但故意失败，以触发SIGALRM信号处理程序。由于信号处理程序中使用了非异步信号安全的函数，可能导致内存损坏和代码执行。`attempt_race_condition` 函数用于执行此操作。
6.  **ASLR绕过：**  由于地址空间布局随机化（ASLR）的存在，攻击者需要知道glibc的基地址。PoC代码中包含了一组可能的基地址，并尝试逐个利用。
7.  **代码注入：** 成功利用竞争条件后，攻击者可以将恶意代码（shellcode）注入到sshd进程的内存中。占位符需要替换。
8.  **代码执行：**  执行注入的shellcode，从而获得服务器的root权限。

**项目地址:** [alex14324/ssh_poc2024](https://github.com/alex14324/ssh_poc2024)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #11

**来源**: [CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md](../2024/CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH服务，并允许未授权的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)。

**有效性:**
根据搜索结果和漏洞库信息，此漏洞的PoC是存在的，并且已经被公开。多个来源证实了该漏洞的存在，以及它可能导致远程代码执行。提供的“漏洞利用代码”实际上是一个缓解脚本，旨在通过升级OpenSSH版本或禁用LoginGraceTime来降低风险，而不是一个实际的利用程序。

**投毒风险:**
提供的脚本主要功能是检测并修复漏洞，但仍然存在一定的投毒风险：
*   **依赖外部源：** 脚本使用`apt-get update`和`apt-get install`命令，依赖外部软件源。如果软件源被恶意篡改，可能导致安装恶意软件包。
*   **配置修改：** 脚本会修改`/etc/ssh/sshd_config`文件，存在被恶意利用修改配置的风险。
*   **权限提升：** 脚本需要root权限运行，如果脚本被篡改，可能导致提权攻击。
综合考虑，该脚本存在一定的投毒风险，但主要风险在于依赖的外部源和配置修改，因此投毒风险评估为10%。

**利用方式:**
此漏洞的利用方式是利用 sshd 进程处理信号时的竞争条件。攻击者需要发起大量连接尝试，并在身份验证失败时触发竞争条件。成功触发后，攻击者能够在目标系统上执行任意代码。根据 offsec.com 的博客文章，此漏洞利用机会在某些 glibc Linux 发行版中，能将指令插入堆中。

**项目地址:** [almogopp/OpenSSH-CVE-2024-6387-Fix](https://github.com/almogopp/OpenSSH-CVE-2024-6387-Fix)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #12

**来源**: [CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md](../2024/CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许未授权网络访问SSH端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387 (regreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的安全回归漏洞，源于 CVE-2006-5051。这是一个竞争条件漏洞，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内身份验证失败来触发此漏洞。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经公开。多个安全厂商和研究人员已经发布了关于此漏洞的分析和PoC代码。

**投毒风险分析：**

提供的Checker.py脚本的主要功能是检测目标SSH服务器是否存在CVE-2024-6387漏洞。它通过连接到目标服务器的SSH端口并获取SSH banner信息，然后将其与已知易受攻击和已修补的版本进行比较来确定漏洞状态。 代码中没有发现任何明显的恶意或后门代码。

投毒风险评估：0%。该脚本主要用于漏洞检测，不包含任何主动利用漏洞的代码，也没有发现作者隐藏的恶意代码。

**利用方式分析：**

1.  **漏洞原理：** 漏洞是由于 OpenSSH 在处理信号时存在竞争条件，允许在身份验证失败期间执行恶意代码。
2.  **攻击步骤：** 攻击者需要向目标服务器发起大量的SSH连接尝试。
3.  **触发条件：** 在连接尝试期间，攻击者故意使身份验证失败，触发竞争条件。
4.  **利用结果：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码，以root权限运行，或者造成拒绝服务攻击。
5.  **缓解措施：** 通过设置 `LoginGraceTime 0` 禁用 `LoginGraceTime` 参数可以缓解远程代码执行的风险，但仍然存在拒绝服务的风险。更新到OpenSSH 9.8或更高版本是完整的修复方案。

**项目地址:** [anhvutuan/CVE-2024-6387-poc-1](https://github.com/anhvutuan/CVE-2024-6387-poc-1)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #13

**来源**: [CVE-2024-6387-awusan125_test_for6387.md](../2024/CVE-2024-6387-awusan125_test_for6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要目标系统基于 glibc，且 OpenSSH 版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理程序中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用可能允许攻击者在目标系统上以 root 权限执行任意代码或导致拒绝服务。

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞的 PoC 已被公开，并且漏洞利用的复杂性较高。搜索结果表明，该漏洞影响 glibc 基础的 Linux 系统。提供的 POC 代码似乎旨在利用此漏洞。

**投毒风险分析：**
该 POC 代码中存在一定的投毒风险，大约 20%。原因如下：
*   **Shellcode 占位符:** 代码中包含 `unsigned char shellcode[] = "\x90\x90\x90\x90";` 这一行，明确指出需要替换为实际的 shellcode。如果用户不小心使用了该占位符，或者植入了其他有害 shellcode，则可能导致不可预期的后果。
*   **GLIBC 基地址硬编码:** 代码中定义了 `uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`，并表示 “Needs adjustment for specific target systems”。如果 GLIBC 基地址不正确，可能导致利用失败，甚至造成程序崩溃。攻击者可能会故意提供错误的基地址，使得用户在尝试利用时受到干扰，或者执行其他恶意操作。
*   **Timing 参数需要微调:** 代码注释中提到 “Timing parameters: Fine-tune based on target system responsiveness”。如果 timing 参数设置不当，可能导致竞争条件无法触发，或者引发其他问题。攻击者可能会提供误导性的 timing 参数，使得用户在尝试利用时遇到困难，或者触发非预期的行为。
*   **Heap 布局和文件结构偏移量:** 代码注释提到 “Heap layout : Requires tweaking for different OpenSSH versions” 和 “File structure offsets: Verify for the specific glibc version.” 这表示该漏洞利用依赖于特定的堆布局和文件结构偏移量。如果这些值不正确，则可能导致利用失败，甚至造成程序崩溃。攻击者可能会提供不兼容的值，使得用户在尝试利用时受到干扰，或者触发非预期的行为。
*   **错误处理不完善:** 代码中虽然包含了一些错误处理逻辑，但可能存在未处理的异常情况。攻击者可能会利用这些漏洞，使得程序在特定条件下崩溃或执行非预期的操作。

**利用方式：**
利用方式主要涉及以下步骤：
1.  **建立连接：** 与目标 SSH 服务器建立 TCP 连接。
2.  **SSH 握手：** 执行 SSH 握手过程，包括版本交换和密钥交换。
3.  **堆准备：** 通过发送特定的数据包，在堆上创建特定的布局。
4.  **时间控制：** 精确控制数据包的发送时间，以便触发竞争条件。
5.  **竞争条件触发：** 通过大量连接尝试和认证失败，利用信号处理程序的竞争条件在内存中注入恶意代码，通常包括修改 glibc 的数据结构。
6.  **代码执行：** 利用注入的恶意代码来执行任意命令。
7.  **绕过 ASLR：** 由于地址空间布局随机化 (ASLR) 的存在，需要确定 glibc 的基地址。PoC 代码中尝试了几个常见的基地址。

总体而言，该漏洞利用较为复杂，需要对 SSH 协议、glibc 内部机制和竞争条件有深入的了解。该漏洞的成功利用还依赖于目标系统的特定配置和状态。

**项目地址:** [awusan125/test_for6387](https://github.com/awusan125/test_for6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #14

**来源**: [CVE-2024-6387-dream434_CVE-2024-6387.md](../2024/CVE-2024-6387-dream434_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，目标系统运行受影响的OpenSSH版本，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性评估：**

根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已经被广泛讨论。漏洞利用代码的脚本主要用于检测目标主机是否运行存在漏洞的OpenSSH版本，利用方式是扫描目标IP的22端口，获取OpenSSH版本信息，并与已知的易受攻击版本进行比较，从而判断目标系统是否存在漏洞。

**投毒风险分析：**

提供的漏洞利用代码（CVE-2024-6387.py）主要用于版本检测，功能相对简单。虽然`README.md`中包含克隆GitHub仓库的操作，但直接分析提供的Python脚本，发现潜在的投毒点在于以下几个方面：

1.  **依赖包风险：** 脚本本身依赖较少，但如果`README.md`引导用户安装额外的依赖包（例如通过`pip install -r requirements.txt`，而`requirements.txt`包含恶意包），则可能存在投毒风险。
2.  **命令执行风险：** `README.md` 中的运行命令 `python CVE-2024-6387.py http://exemple.com` 虽然看起来无害，但如果 `CVE-2024-6387.py` 存在漏洞，允许通过命令行参数执行恶意代码，则存在风险。当前提供的代码没有直接利用命令行参数执行代码的逻辑。
3.  **文件包含风险：** 如果脚本尝试动态加载其他文件（例如配置文件），而这些文件被篡改，则可能存在风险。

鉴于以上分析，以及`README.md`中存在引导用户克隆github仓库的操作，综合判断，存在较低的投毒风险，约为10%。主要基于假设恶意代码可能存在于被克隆仓库的其他文件中，或者存在利用脚本漏洞执行恶意代码的可能。

**漏洞利用方式：**

1.  **版本检测：** 攻击者首先需要确定目标系统上运行的OpenSSH版本是否在受影响的范围内（8.5p1 <= version <= 9.7p1）。
2.  **触发竞争条件：** 攻击者通过与目标SSH服务器建立连接，并在身份验证过程中故意失败，以触发漏洞相关的竞争条件。
3.  **代码执行：** 成功触发竞争条件后，攻击者可以利用该漏洞在目标系统上执行任意代码，通常以root权限执行。

搜索结果也表明，此漏洞允许未经身份验证的远程代码执行，并且影响基于glibc的Linux系统。因此，利用方式的核心在于触发竞争条件并利用glibc的特性来执行恶意代码。

**项目地址:** [dream434/CVE-2024-6387](https://github.com/dream434/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #15

**来源**: [CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标主机开启SSH服务，且攻击者能够发起大量连接尝试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是一个OpenSSH服务器中的竞争条件漏洞。它源于OpenSSH处理信号的方式，当SSH服务器在短时间内收到大量连接请求且认证失败时，可能导致信号处理不当，进而允许未经验证的远程攻击者在基于glibc的Linux系统上执行任意代码，获取root权限，或者导致拒绝服务。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC已发布，表明漏洞可被利用。提供的Python脚本`CVE-2024-6387-Vulnerability-Checker.py`是一个漏洞检测工具，通过检查SSH banner版本来判断目标是否存在漏洞。脚本本身并不能直接利用该漏洞进行RCE或DoS攻击，而是用来辅助确认目标系统是否在受影响的范围内。

**投毒风险：**
该Python脚本主要功能是检查OpenSSH版本，判断其是否在受影响的范围内。代码本身只包含版本检测逻辑，没有发现任何恶意代码或后门，因此投毒风险极低。可以认为投毒风险为0%。

**利用方式：**
1.  **版本检测：** 使用PoC脚本或类似工具检测目标SSH服务器的版本，确认其是否位于易受攻击的范围(8.5p1 <= OpenSSH <= 9.7p1)。
2.  **触发竞争条件：** 如果目标版本易受攻击，攻击者需要发起大量连接尝试，并在短时间内故意认证失败，以触发竞争条件。
3.  **代码执行（或DoS）：** 成功触发竞争条件后，利用glibc的堆操作特性，攻击者可以插入恶意指令到堆中，从而实现远程代码执行。另一种利用方式是耗尽服务器资源，造成拒绝服务攻击。

需要注意的是，利用此漏洞进行RCE需要对glibc堆操作有一定的了解，并且成功率可能不高。缓解措施包括禁用`LoginGraceTime`配置，并使用`fail2ban`等工具限制恶意连接。

**项目地址:** [filipi86/CVE-2024-6387-Vulnerability-Checker](https://github.com/filipi86/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #16

**来源**: [CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-regreSSHion

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1 (OpenSSH)

**利用条件:** 需要glibc-based Linux系统，以及OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞。漏洞源于OpenSSH服务器处理信号的方式存在问题，具体来说，当用户认证失败时，可能触发不安全的信号处理。远程攻击者可以通过在短时间内发起大量SSH连接尝试，并故意触发认证失败，从而引发竞争条件，最终可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据搜索结果（webpage 1, 3, 4, 5, 7, 8）和漏洞库信息，该漏洞已被确认为一个高危漏洞，并且存在公开的PoC（Proof of Concept）代码。虽然提供的POC代码只是一个包含漏洞描述的README.md文件，**不能直接运行，但是，github上存在可利用的POC**。该POC的有效性取决于目标系统是否满足漏洞利用的条件，即：
1.  使用受影响的OpenSSH版本（<= 9.7p1）。
2.  目标系统是基于glibc的Linux发行版。
3.  系统配置允许一定数量的并发连接。

**投毒风险：**
提供的POC代码（README.md）本身不包含任何可执行代码，因此直接的投毒风险很低。但需要注意的是，任何从互联网上下载的代码都存在潜在的风险。即使是看似无害的文档，也可能包含恶意链接或指令，引导用户下载或执行恶意代码。因此，下载和使用任何PoC代码时，都应该保持警惕，并进行充分的安全审查。

虽然提供的README.md文件本身投毒风险较低,但是考虑到实际利用中需要依赖其他EXP, 因此其他仓库被投毒的可能性相对较高。
风险评估：10%

**利用方式：**
根据漏洞描述和搜索结果，利用方式主要包括以下几个步骤：
1.  **大量连接请求：** 攻击者向目标OpenSSH服务器发起大量的并发连接请求。
2.  **触发认证失败：**  在连接请求中，故意提供错误的用户名或密码，触发认证失败事件。
3.  **竞争条件利用：**  通过大量认证失败事件，触发OpenSSH服务器中的竞争条件漏洞。
4.  **代码执行或DoS：** 成功利用漏洞后，攻击者可以执行任意代码（RCE）或导致服务器崩溃（DoS）。

需要注意的是，利用该漏洞需要一定的资源和技术，并且成功率可能不高。Red Hat 在其安全公告中指出，实现RCE需要相当多的资源投入。同时，修改sshd_config,设置LoginGraceTime为0可以有效避免远程代码执行，但仍存在拒绝服务风险.

**项目地址:** [identity-threat-labs/Article-RegreSSHion-CVE-2024-6387](https://github.com/identity-threat-labs/Article-RegreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #17

**来源**: [CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，sshd服务运行且存在于受影响版本范围内，目标系统是基于glibc的Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中发现的竞争条件漏洞。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发该漏洞。成功利用可能导致以root权限远程执行代码或拒绝服务。该漏洞的利用依赖于触发信号处理程序的竞争条件，攻击者需要发起大量连接尝试才能提高触发漏洞的几率。提供的PoC代码是一个漏洞验证工具，用于检测目标系统上运行的OpenSSH版本是否存在漏洞。它通过连接到目标SSH端口并检查SSH横幅来工作。如果横幅指示易受攻击的版本，则该工具会将目标标记为易受攻击。PoC代码本身似乎不包含任何明显的投毒代码。它仅仅用于验证漏洞是否存在，并不会主动进行利用。

**利用方式：**

1.  攻击者向目标服务器的SSH端口发起大量连接请求。
2.  连接请求需要故意失败，例如提供无效的用户名或密码，以便触发身份验证失败流程。
3.  攻击者利用OpenSSH处理信号时的竞争条件，将恶意指令插入堆中。
4.  如果竞争条件利用成功，攻击者即可在目标系统上以root权限执行任意代码或导致拒绝服务。

**项目地址:** [identity-threat-labs/CVE-2024-6387-Vulnerability-Checker](https://github.com/identity-threat-labs/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #18

**来源**: [CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md](../2024/CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统使用受影响的OpenSSH版本，基于glibc的Linux系统，且未禁用LoginGraceTime

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是一个存在于OpenSSH服务器(sshd)中的竞争条件漏洞。该漏洞源于OpenSSH在处理信号时存在不安全行为。远程攻击者通过在一定时间内认证失败，可以触发此漏洞，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**漏洞利用方式：**

1.  攻击者向目标服务器发起大量的SSH连接请求。
2.  在SSH认证过程中，攻击者故意使认证失败，触发LoginGraceTime超时。
3.  由于竞争条件，sshd可能在处理SIGALRM信号时进入不安全状态。
4.  在glibc-based的Linux系统上，这种不安全状态可能允许攻击者将指令插入到堆中，最终导致RCE。
5.  如果无法实现RCE，攻击者可以通过耗尽服务器资源，导致DoS。

**POC代码分析：**

提供的PoC代码`/tmp/d7c5471d195cdec17d8f4ebaf7516058/CVE-2024-6387_poc.py`的主要功能是检测目标SSH服务器的版本，判断其是否受CVE-2024-6387漏洞影响。它通过建立socket连接，发送`\x00`，接收SSH版本信息，并进行正则匹配来确定OpenSSH的版本。如果版本在易受攻击的范围内（8.5 <= 版本 < 9.8）,则输出目标系统可能存在漏洞。该PoC本身**不包含直接利用漏洞的代码**，仅仅用于版本检测。

`/tmp/d7c5471d195cdec17d8f4ebaf7516058/README.md` 提供了一个使用说明，介绍了如何使用该PoC。`/tmp/d7c5471d195cdec17d8f4ebaf7516058/ip-addr.list`包含需要检查的IP地址列表, 127.0.0.1是示例.

**有效性：**

提供的POC代码的**有效性在于验证目标系统是否存在漏洞**，而非直接利用该漏洞。根据搜索结果和漏洞描述，完整的漏洞利用需要更复杂的步骤和技术，例如大量连接尝试来触发竞争条件，以及精心构造的shellcode。因此，此PoC仅仅是前期验证步骤。

**投毒风险：**

该仓库中存在**投毒风险的可能性较低，约为10%**。PoC代码主要功能是版本检测，本身没有发现恶意代码。潜在的风险可能存在于：

*   `ip-addr.list`文件：虽然当前提供的`ip-addr.list`文件只包含本地地址`127.0.0.1`, 如果用户不小心使用了作者预先设定的其他IP地址列表，可能会导致未授权的扫描或攻击行为。
*   `session.log`文件：虽然日志记录本身不是恶意行为，但如果日志文件被上传或泄露，可能暴露用户的扫描目标信息。日志信息包含IP和端口信息。
*   在实际利用该漏洞时，如果攻击者使用了恶意的Payload，可能会对目标系统造成更大的危害。这些Payload可能被伪装成无害的代码，从而绕过安全检测。
*   如果作者在其他未公开的分支或版本中包含了恶意代码，并且诱导用户使用这些版本，则存在更高的投毒风险。

**综上所述，**虽然提供的PoC代码本身不包含明显的恶意代码，但用户在使用时仍然需要保持警惕，仔细审查代码，并确保从可信的来源获取代码，避免潜在的投毒风险。

**项目地址:** [jocker2410/CVE-2024-6387_poc](https://github.com/jocker2410/CVE-2024-6387_poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #19

**来源**: [CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：**

从搜索结果和漏洞库信息来看，该漏洞存在可利用的POC。提供的Rust代码是一个漏洞检查器，它通过连接到SSH服务器并读取SSH banner来判断目标服务器是否运行着存在漏洞的OpenSSH版本。

**投毒风险：**

提供的代码是一个漏洞检测工具，用于检查目标系统是否存在CVE-2024-6387漏洞。代码功能相对清晰，主要包括：

*   定义了易受攻击和已修补的版本列表。
*   通过TCP连接获取SSH banner。
*   将获取的banner与已知易受攻击的版本进行比较。

代码中没有发现恶意行为，例如执行系统命令或上传/下载文件。因此，**投毒风险较低，判断为0%**。

**利用方式：**

根据漏洞信息和搜索结果，攻击者需要发起大量的连接尝试，以触发sshd中的竞争条件。成功利用该漏洞可能允许攻击者在目标系统上执行任意代码或导致拒绝服务。Offsec的博客提供了关于如何利用该漏洞的更详细的解释。

**总结：**

CVE-2024-6387是一个严重的安全漏洞，允许未经身份验证的攻击者远程执行代码。虽然利用该漏洞需要一定的资源和技术，但由于存在公开的POC，因此建议尽快更新OpenSSH版本。

**项目地址:** [kubota/CVE-2024-6387-Vulnerability-Checker](https://github.com/kubota/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #20

**来源**: [CVE-2024-6387-l-urk_CVE-2024-6387.md](../2024/CVE-2024-6387-l-urk_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH regreSSHion 远程代码执行漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** OpenSSH

**危害等级:** 高危，未授权的远程攻击者可以利用此漏洞以 root 权限执行任意代码，或者造成拒绝服务。

**影响版本:** 8.5p1 ~ 9.7p1

**利用条件:** 目标系统使用受影响的 OpenSSH 版本, 并且基于 glibc 的 Linux 系统。需要网络连通性, 且攻击者需要能够发起大量的 SSH 连接尝试。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，又名 regreSSHion，是 OpenSSH 服务器中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件漏洞，允许未经身份验证的远程攻击者在基于 glibc 的 Linux 系统上执行任意代码。漏洞的利用方式涉及发起大量的 SSH 连接尝试，触发 sshd 进程中的竞争条件，从而允许攻击者将指令插入堆中，最终实现 RCE。

**有效性：**
从搜索结果和漏洞库信息来看，此漏洞是真实存在的，并且存在公开可用的 PoC 代码。PoC 代码的描述也与漏洞描述一致，表明其具有较高的有效性。

**投毒风险：**
提供的 POC 代码库中的 `LISCENCE` 文件声明了严格的权限限制，这在一定程度上增加了投毒的可能性。虽然无法通过现有信息完全确定是否存在投毒代码，但需要对脚本进行仔细审查，特别注意以下几个方面：

*   **shellcode:**  分析 shellcode 的行为，确保其功能与漏洞利用目的相符，没有恶意行为。
*   **网络连接:**  检查代码中是否存在额外的网络连接，特别是连接到未知或可疑的 IP 地址。
*   **文件操作:**  检查代码中是否存在对系统文件的修改或删除操作。
*   **依赖项:**  审查 `requirements.txt` 文件中的依赖项，确保没有引入恶意的第三方库。

考虑到需要大量连接尝试和对堆的操纵，以及许可证的严格声明，综合评估投毒风险为10%。这部分代码逻辑比较复杂，存在隐藏恶意代码的可能性。

**利用方式：**
1.  攻击者通过网络向目标 OpenSSH 服务器发起大量的连接请求。
2.  利用 OpenSSH 服务器处理连接请求时存在的竞争条件，特别是在信号处理方面。
3.  通过精心构造的数据包，将恶意代码注入到服务器的堆内存中。
4.  触发执行注入的恶意代码，从而获得对目标系统的控制权 (RCE) 或导致拒绝服务 (DoS)。
5.  默认的shellcode打开9999端口,并使用nc进行监听。

**项目地址:** [l-urk/CVE-2024-6387](https://github.com/l-urk/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #21

**来源**: [CVE-2024-6387-lflare_cve-2024-6387-poc.md](../2024/CVE-2024-6387-lflare_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是OpenSSH服务器(sshd)中的一个竞争条件漏洞，源于CVE-2006-5051的安全回归。当sshd在不安全的方式下处理某些信号时，未经验证的远程攻击者可能通过在设定的时间内未能成功验证身份来触发此漏洞。

**有效性评估：**
根据漏洞信息和搜索结果，此漏洞的PoC已经发布，并且被广泛讨论，证明了其有效性。PoC代码（`7etsuo-regreSSHion.c`）尝试利用此漏洞，通过以下步骤：

1.  **连接建立：** 与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH协议握手。
3.  **堆准备：** 准备堆布局以进行利用。
4.  **时间测量：** 测量数据包解析时间。
5.  **竞争条件尝试：** 尝试触发竞争条件，利用信号处理中的不安全函数调用，最终目标是执行shellcode，提权至root。
6.  **ASLR绕过：**尝试不同的glibc基地址，以绕过地址空间布局随机化(ASLR)。

代码中包含了尝试20000次利用的循环，以及100ms的延时，这些都符合漏洞分析文章的描述，增加了利用成功的可能性。

**投毒风险评估：**

此PoC代码存在一定程度的投毒风险，因为:

1.  **Shellcode:** PoC代码包含一个shellcode占位符，攻击者需要替换成真实的shellcode。如果提供的shellcode本身是恶意的，那么使用此PoC会导致投毒。
2. **glibc地址:** PoC代码包含glibc基址，攻击者需要手动调整为目标系统的基址。如果提供的基址不正确，或者根本无法确定正确的基址，会影响利用成功率。如果攻击者故意提供错误的基址或者使用错误的基址绕过策略，也有可能导致拒绝服务。
3.  **定时参数：** PoC代码中的定时参数需要根据目标系统的响应速度进行调整。如果定时不当，可能导致利用失败，甚至使目标系统崩溃。
4.  **heap布局:** OpenSSH的堆布局会随着版本的变化而变化，需要针对不同的版本进行调整。如果不调整，可能无法成功利用。

**评估：**
PoC代码的编写者可能在代码中加入不易察觉的恶意行为，例如收集目标系统信息并发送到远程服务器等。但是，考虑到PoC的主要目的是为了验证漏洞，因此这种风险相对较低。PoC中已经存在大量的需要修改的地方，需要使用者有一定的漏洞知识储备，因此投毒风险相对较低。

**综合评估**：PoC中投毒风险预估为10%，

**利用方式总结：**

1.  攻击者首先需要与目标OpenSSH服务器建立连接。
2.  然后，攻击者需要执行SSH握手协议。
3.  接着，攻击者发送特制的数据包，触发sshd中的竞争条件。
4.  竞争条件允许攻击者覆盖内存中的关键数据结构。
5.  攻击者通过覆盖的数据结构，执行预先准备好的shellcode，从而获得目标系统的root权限。
6. 利用过程需要绕过ASLR保护，这可能需要多次尝试，或者使用其他信息泄露漏洞。
7. 攻击需要一定的timing， 把握好发送数据包的时间。

**项目地址:** [lflare/cve-2024-6387-poc](https://github.com/lflare/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #22

**来源**: [CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387是一个OpenSSH服务器(sshd)中的安全回归漏洞，存在于OpenSSH 8.5p1到9.7p1版本。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。远程攻击者可以通过在设定的时间内认证失败来触发此漏洞，可能导致远程代码执行或拒绝服务。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已确认存在，并且有POC代码可用。搜索引擎结果中的多个链接指向了漏洞分析、利用和修复方法，以及相关的讨论。

**投毒风险：**
提供的POC代码包含一个Python脚本（main.py）和一个README.md文件。脚本内容主要用于识别易受攻击的OpenSSH服务器，并无发现任何恶意代码或者后门，但是不排除后续增加投毒代码的可能性, 因此投毒风险极低。

**利用方式：**
1.  攻击者需要发起大量SSH连接到目标服务器。
2.  在LoginGraceTime时间内，故意使认证失败。
3.  利用竞争条件，使sshd以不安全的方式处理信号。
4.  如果成功，攻击者可能能够执行任意代码或导致服务崩溃（拒绝服务）。

**缓解措施：**
*   将OpenSSH升级到9.8或更高版本。
*   设置`LoginGraceTime 0`可以缓解RCE，但不能完全避免DoS攻击，建议结合`fail2ban`和防火墙使用。

**项目地址:** [moften/regreSSHion-CVE-2024-6387](https://github.com/moften/regreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #23

**来源**: [CVE-2024-6387-prelearn-code_CVE-2024-6387.md](../2024/CVE-2024-6387-prelearn-code_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 远程代码执行

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行

**影响应用:** OpenSSH

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (glibc-based Linux systems)

**利用条件:** 目标系统需要运行受影响版本的OpenSSH，且基于glibc。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，也被称为"regreSSHion"，是OpenSSH服务器（sshd）中的一个安全漏洞，是CVE-2006-5051的一个回归。它是由信号处理中的竞争条件引起的。未经身份验证的远程攻击者可以通过在设定的时间内未能成功进行身份验证来触发此漏洞，可能导致以root权限执行任意代码。该漏洞影响基于glibc的Linux系统上的OpenSSH 8.5p1到9.7p1版本。

**有效性：**
根据漏洞库信息、搜索结果（特别是来自Qualys和offsec的分析），以及POC代码的存在，可以判断该漏洞是有效的，并且存在可利用的POC。

**投毒风险：**
POC代码中存在一定的投毒风险。虽然代码的目的是利用该漏洞，但攻击者可能会修改shellcode以进行恶意活动，或者在代码中加入额外的后门。例如，`shellcode`变量中包含占位符，需要替换为实际的shellcode。如果用户从不可信来源下载POC，并使用了包含恶意shellcode的POC，则可能存在投毒风险。代码中定义了多个glibc地址用于绕过ASLR，攻击者可以伪造错误的地址，来扰乱攻击。

**利用方式：**
利用方式涉及以下几个步骤：

1.  **建立连接：** 攻击者首先与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH握手过程，包括版本交换和密钥交换的初始化。
3.  **堆准备：** 发送特定的SSH数据包，以在sshd进程的堆上创建特定的内存布局，为利用创造条件。
4.  **触发竞争条件：** 攻击者触发一个竞争条件，该条件涉及OpenSSH处理信号的方式，利用SIGALRM信号处理程序中的不安全函数调用。
5.  **地址绕过：** 通过尝试多个可能的glibc基址，绕过地址空间布局随机化 (ASLR)。
6.  **执行代码：** 成功触发竞争条件后，将恶意shellcode注入到内存中并执行，从而获得远程代码执行权限（通常以root权限）。

**缓解措施包括：**
*   禁用`LoginGraceTime`参数，虽然不能完全阻止DoS，但可以防御RCE。
*   使用`fail2ban`等工具监控日志文件并管理连接。
*   及时更新到OpenSSH的修复版本。

**项目地址:** [prelearn-code/CVE-2024-6387](https://github.com/prelearn-code/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #24

**来源**: [CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md](../2024/CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，glibc-based Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387是一个OpenSSH服务器中的竞争条件漏洞（源于CVE-2006-5051的回归）。未经身份验证的远程攻击者可以通过在设定的时间内未能完成身份验证来触发此漏洞。利用方式是发送大量连接请求，触发竞争条件，在glibc-based Linux系统上可能导致在堆中插入恶意指令，最终实现远程代码执行或拒绝服务。提供的脚本并非POC，而是缓解措施：

1.  **有效性：** 提供的脚本实际上是一个缓解脚本，通过将`LoginGraceTime`设置为0来减少漏洞被利用的可能性，并不能直接验证漏洞，缓解脚本会禁用SSHD服务器在指定超时时间内未完成身份验证时断开连接的能力。虽然降低了RCE的风险，但增加了拒绝服务(DoS)的风险。

2.  **投毒风险：** 提供的脚本目的是缓解漏洞，没有发现任何隐藏的恶意代码，因此投毒风险为0%。

3.  **利用方式：** 根据漏洞信息和搜索结果，利用方式是未认证的攻击者向目标OpenSSH服务器发送大量连接请求，由于竞争条件的存在，sshd可能以不安全的方式处理信号，从而允许攻击者执行任意代码（RCE）或造成拒绝服务(DoS)。攻击成功的关键在于触发竞争条件，因此需要大量的并发连接尝试。


**项目地址:** [redux-sibi-jose/mitigate_ssh](https://github.com/redux-sibi-jose/mitigate_ssh)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #25

**来源**: [CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md](../2024/CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，并且攻击者能够建立SSH连接并触发竞争条件。攻击者需要尝试大量连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全漏洞，源于信号处理中的竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：** 根据漏洞库信息和搜索结果，此漏洞存在PoC。该漏洞的利用依赖于触发竞争条件，因此需要进行大量的连接尝试。

**投毒风险：** 分析提供的PoC代码，主要包含一个检测脚本（detection-script.py）和一个README。检测脚本尝试建立到目标SSH服务器的连接，并发送SSH协议版本字符串，然后读取服务器的响应。LICENSE文件和README.md文件是标准格式，描述了漏洞信息。由于检测脚本本身较为简单，且没有发现明显的恶意代码，因此投毒的风险较低，约为10%。 但是需要人工review所有代码.特别是二进制文件.

**利用方式：** 利用此漏洞需要：
1.  攻击者向目标服务器上的sshd服务发起大量的连接请求。
2.  在连接建立但身份验证尚未完成时，利用竞争条件触发信号处理错误。
3.  如果成功利用，攻击者可以在目标系统上执行任意代码，获得root权限（根据漏洞描述和搜索结果）。

利用的复杂性在于需要精确地控制时序，以触发竞争条件。这通常需要大量的计算资源和对目标系统行为的深入了解。同时该漏洞在glibc-based Linux systems更有效,可能无法在所有系统上利用。

**项目地址:** [s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH](https://github.com/s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #26

**来源**: [CVE-2024-6387-wiggels_regresshion-check.md](../2024/CVE-2024-6387-wiggels_regresshion-check.md)

# CVE-2024-6387

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-6387-AzrDll_CVE-2024-6387.md](../2024/CVE-2024-6387-AzrDll_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH 竞争条件导致 RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。需要发起大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务中的一个竞争条件漏洞，源于 CVE-2006-5051 的回归。未经身份验证的远程攻击者可以通过在短时间内发起大量失败的身份验证尝试来触发此漏洞。利用此漏洞需要在glibc堆中插入指令，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞确实存在，并且有公开的PoC利用代码。该PoC通过建立大量的 SSH 连接并进行不成功的身份验证来触发竞争条件。参考[webpage 3]，此漏洞允许glibc Linux发行版在堆中插入指令，从而实现代码执行。提供的PoC代码尝试利用这一点，但成功率可能较低，因为竞争条件需要精确的时间控制。

**投毒风险：**
提供的PoC代码`/tmp/fe03af2a23123389ff9785e2fb119f2c/PoC.py` 包含了从文件中读取glibc地址的功能。 虽然代码本身没有明显的恶意行为，但如果提供的 `glibc_file` 包含恶意构造的地址，可能会导致非预期的行为，甚至导致拒绝服务。例如，如果`glibc_base`地址指向了关键系统函数，覆盖该地址可能造成系统崩溃。另一个潜在的风险点是 `timing_adjustment`，如果调整不当可能造成DoS。综上所述，投毒风险为10%。主要是考虑到作者可能在利用代码的 `glibc_file` 参数中提供恶意的 glibc 地址，诱导用户使用，从而达到破坏目标系统的目的。

**利用方式：**
1.  **建立连接：** 攻击者首先建立与目标 OpenSSH 服务器的 TCP 连接。
2.  **SSH 握手：** 攻击者执行 SSH 握手过程，例如发送 SSH 版本字符串。
3.  **堆准备：** PoC尝试在堆上分配一些数据，为利用竞争条件做准备。
4.  **触发竞争条件：**  通过快速发送大量失败的身份验证请求，攻击者试图触发 `sshd` 进程中的竞争条件。这涉及利用 `LoginGraceTime` 参数，该参数允许攻击者在身份验证超时之前发送多个请求。根据[webpage 6]，利用此漏洞需要大量连接尝试才能准确触发竞争条件。
5.  **代码执行：**  如果竞争条件被成功触发，攻击者可以在内存中写入恶意代码，从而实现远程代码执行。提供的 PoC 代码尝试通过覆盖 glibc 的地址来实现这一点。如果成功利用，攻击者可以获得 root 权限，如[webpage 1][webpage 4]所描述。
6.  **拒绝服务：** 即使未能成功实现 RCE，攻击者也可能通过耗尽服务器资源来实现拒绝服务。由于竞争条件涉及信号处理，不正确的信号处理可能导致 `sshd` 崩溃。

**项目地址:** [AzrDll/CVE-2024-6387](https://github.com/AzrDll/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #2

**来源**: [CVE-2024-6387-DimaMend_cve-2024-6387-poc.md](../2024/CVE-2024-6387-DimaMend_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行(RCE)和拒绝服务(DoS)

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，并且目标系统基于glibc。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全漏洞，它是由CVE-2006-5051引入的回归错误。该漏洞是一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**利用方式：**

1.  **建立连接：** 攻击者首先与易受攻击的OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者尝试进行SSH握手，但故意不完成身份验证过程。这是为了触发`LoginGraceTime`超时。
3.  **堆准备：** 攻击者发送一系列SSH数据包，旨在操纵服务器的内存堆的布局。 这可能涉及到分配和释放内存，以便为利用创造合适的条件。
4.  **触发竞争条件：** 攻击者利用`LoginGraceTime`超时机制。当服务器由于握手超时而即将终止连接时，会发送一个信号。 攻击者尝试与此信号处理程序执行竞争，以修改服务器的内存。
5.  **代码执行：** 如果竞争成功，攻击者可以将恶意代码注入到服务器的内存中，并获得代码执行能力。 根据具体利用方式，这可能导致以root权限执行代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞的利用是可行的。许多信息源表明，存在公开可用的PoC，并且已经有人成功利用了此漏洞。 PoC代码的功能是尝试利用这个竞态条件。

**投毒风险分析：**

PoC代码中存在投毒代码的风险很低，原因如下：

*   **代码结构：** 代码主要集中于建立连接、进行SSH握手、操纵堆内存以及尝试触发竞态条件。虽然代码较为复杂，但在总体流程上没有明显的恶意操作。
*   **Shellcode占位符：** 代码中存在一个 `shellcode` 占位符，明确提示用户需要替换成实际的 shellcode。这表明作者的意图是提供一个框架，而不是一个直接可用的恶意载荷。
*   **注释和说明：** 代码包含大量的注释和说明，解释了漏洞的原理、利用方法以及需要调整的参数。这表明作者的目的是帮助研究人员理解和复现漏洞，而不是隐藏恶意代码。
*   **随机性和尝试次数：** 代码包含大量的随机尝试，目的是为了提高漏洞利用的成功率。这种随机性使得代码难以预测，也增加了作者插入恶意代码的难度。
*   **外部依赖：** 代码没有包含明显的外部依赖或网络请求，这降低了其被用于下载或执行恶意代码的风险。

虽然直接投毒的可能性较低，但仍然存在一些潜在风险，比如在 `shellcode` 占位符中插入恶意代码，或者在调整参数的过程中引入错误，导致程序行为异常。因此，在使用 PoC 代码时，仍然需要进行仔细的代码审查和安全测试。

综上所述，此仓库中存在作者隐藏的投毒代码的可能性估计为1%。

**项目地址:** [DimaMend/cve-2024-6387-poc](https://github.com/DimaMend/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #3

**来源**: [CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-HadesNull123_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行存在漏洞版本的OpenSSH服务，且攻击者能够建立SSH连接，并在认证超时前发送恶意数据。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，存在于glibc的linux系统。它源于一个信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该漏洞是有效的。多个来源都确认了该漏洞的存在以及其远程代码执行的潜力。POC代码的存在进一步支持了其可利用性。

**投毒风险：**

POC代码本身包含以下潜在的投毒风险点：

*   **Shellcode占位符:** 代码中明确提到 `Shellcode placeholder (replace with actual shellcode)`。如果用户直接使用未经审查的 shellcode，则可能引入恶意行为。此处的风险不在于作者投毒，而在于用户使用不当。
*   **GLIBC_BASES:**  `GLIBC_BASES[]` 数组包含可能的 glibc 基地址。如果这个地址不准确，利用将失败。如果作者故意提供错误的地址，可能会导致拒绝服务或误导分析。
*   **Timing parameters:** 注释提到需要根据目标系统调整 timing 参数。错误的 timing 可能导致利用失败或系统不稳定。
*   **Heap layout 和 File structure offsets:**  代码注释中也强调了需要针对不同的 OpenSSH 和 glibc 版本进行调整，否则利用会失败。故意设置错误的值可能导致程序崩溃或产生其他未定义行为。
*   **随机数生成:** 代码使用 `srand(time(NULL))` 初始化随机数生成器。虽然这本身不是投毒，但如果后续利用中依赖于可预测的随机数，可能会被利用。

总体评估投毒风险为30%。风险主要来自于需要用户自行替换的shellcode，以及需要用户根据目标环境配置的参数。作者本身隐藏恶意代码的可能性较低，但用户在使用过程中存在引入风险的可能性。

**利用方式：**

1.  **建立连接：** 攻击者首先需要建立与目标 OpenSSH 服务器的连接。
2.  **SSH握手：** 进行初步的SSH握手过程，包括版本协商和密钥交换的初始化，但无需完成身份认证。
3.  **堆准备：**  `prepare_heap` 函数的目的是在堆上创建特定的布局，为后续的利用创造条件。具体实现细节未给出，但可能涉及分配和释放内存，以控制堆的状态。
4.  **时间测量：** `time_final_packet` 函数测量服务器处理特定数据包所需的时间。这个时间信息对于后续的竞争条件利用至关重要。
5.  **竞争条件：**  `attempt_race_condition` 函数尝试触发漏洞的核心：信号处理程序中的竞争条件。这通常涉及发送一个精心构造的数据包，该数据包会在服务器处理过程中触发 SIGALRM 信号。由于信号处理程序使用了异步信号不安全函数，因此可能导致堆损坏。
6.  **代码执行：**  如果竞争条件成功触发，攻击者就可以利用堆损坏来执行任意代码。这通常涉及覆盖函数指针或控制程序的执行流程。

该漏洞的利用依赖于精确的 timing 和对目标系统内存布局的了解。攻击者需要进行大量的尝试才能成功利用该漏洞。

**项目地址:** [HadesNull123/CVE-2024-6387_Check](https://github.com/HadesNull123/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #4

**来源**: [CVE-2024-6387-Karmakstylez_CVE-2024-6387.md](../2024/CVE-2024-6387-Karmakstylez_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器(sshd)中的一个安全回归漏洞，存在于glibc-based Linux系统。该漏洞源于信号处理程序中的竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。该漏洞利用代码尝试通过大量的连接请求触发竞争条件，通过调整glibc基地址和定时参数绕过ASLR，将恶意代码注入到堆中，最终实现以root权限远程代码执行。

有效性：根据漏洞信息和搜索结果，此POC代码具备一定的有效性，但成功利用需要满足特定条件，例如目标系统使用glibc，以及OpenSSH版本在受影响范围内。同时，漏洞利用的成功率受到系统负载、网络延迟等因素的影响，需要进行大量的尝试。

投毒风险：POC代码中存在一定的投毒风险。虽然POC代码的主要目的是利用已知的漏洞，但攻击者可能在代码中加入恶意功能，例如植入后门、收集敏感信息等。例如，shellcode 部分是明显的注入点。风险评定为10%，主要基于以下几点：
1.  **Shellcode 替换：** 代码明确指出 `shellcode` 变量是占位符，需要替换为实际的 shellcode。如果用户不小心使用了包含恶意指令的 shellcode，则可能导致投毒。
2.  **glibc 基地址猜测：** 虽然代码尝试多个 glibc 基地址，但如果攻击者预先知道目标系统的 glibc 地址，则可以修改 `GLIBC_BASES` 数组以提高利用成功率，同时也可能引入恶意地址。
3.  **Timing 参数调整：** 代码中的 `usleep` 函数用于控制连接尝试之间的延迟。攻击者可以通过调整这些参数来优化漏洞利用，但也可能引入导致拒绝服务 (DoS) 的参数。
4.  **编译选项：**POC 需要编译，攻击者可以在编译时添加额外的恶意编译选项，例如禁用安全特性等。
5.  **作者本身:** 仓库作者有投毒行为.

利用方式：
1.  攻击者首先需要确定目标系统是否运行受影响的OpenSSH版本，以及是否基于glibc。
2.  攻击者发起大量的SSH连接请求，尝试触发竞争条件。
3.  攻击者利用精心构造的数据包覆盖堆上的特定内存区域，将恶意代码注入到sshd进程中。
4.  一旦恶意代码成功执行，攻击者即可获得目标系统的控制权。

**项目地址:** [Karmakstylez/CVE-2024-6387](https://github.com/Karmakstylez/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #5

**来源**: [CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md](../2024/CVE-2024-6387-Lost-Ryder_CVE-2024-6387-OpenSSH-ProxyCommand-RC.md)

## CVE-2024-6387-OpenSSH-RegreSSHion-RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行并获取 root 权限或造成拒绝服务

**影响版本:** <= 9.7p1 (受影响版本 8.5p1 至 9.7p1)

**利用条件:** 需要目标服务器运行受影响版本的OpenSSH，且存在时间窗口内的未认证连接尝试。高危利用场景依赖glibc环境。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-6387，也被称为“regreSSHion”，是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞（CVE-2006-5051）。该漏洞源于信号处理中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC已经存在，并且能够实现远程代码执行和拒绝服务攻击。很多安全厂商和研究人员都发布了相关的分析报告和PoC代码。

**投毒风险：**
提供的漏洞利用代码（/tmp/270e32ae67508359811c0f9899155269/README.md 和 LICENSE）仅仅是声明了存在POC，根据现有信息，该仓库本身存在恶意代码的风险较低。但是，由于POC的执行具有高危性，在实际使用中，仍需要进行安全审查。

**利用方式：**
1.  **竞争条件：** 攻击者通过在短时间内发起大量未认证的连接尝试，触发 `sshd` 中的竞争条件。
2.  **信号处理：** 在特定的时间窗口内，`sshd` 可能会以不安全的方式处理信号，导致内存损坏或其他异常行为。
3.  **远程代码执行/拒绝服务：**  利用内存损坏或其他异常行为，攻击者可以执行任意代码（RCE），或导致 `sshd` 崩溃，造成拒绝服务（DoS）。部分利用依赖特定的glibc环境。
4.  **ProxyCommand注入:** 根据github仓库的README.md描述，该POC利用了 `ProxyCommand` 配置不当或滥用的情况，攻击者可以注入恶意命令到 `ProxyCommand` 中，从而获得命令执行或者横向渗透的能力。

**缓解措施：**
*   升级到 OpenSSH 9.8 或更高版本。
*   设置 `LoginGraceTime 0` 以禁用在指定超时时间内未完成身份验证时服务器断开连接的功能（Red Hat 建议的临时缓解措施，但会使服务器更容易受到 DoS 攻击）。
*   使用 `fail2ban` 等工具，配合防火墙来监控日志文件并适当管理连接。

**项目地址:** [Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC](https://github.com/Lost-Ryder/CVE-2024-6387-OpenSSH-ProxyCommand-RC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #6

**来源**: [CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md](../2024/CVE-2024-6387-SkyGodling_CVE-2024-6387-POC.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）或拒绝服务（DoS）

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 目标系统运行受影响版本的OpenSSH，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。它是一个竞争条件漏洞，可能导致sshd以不安全的方式处理信号。远程攻击者可以通过在设定的时间内未能成功验证身份来触发此漏洞，从而可能导致远程代码执行或拒绝服务。

**有效性评估：**

根据漏洞库信息、搜索结果以及提供的POC代码来看，此漏洞的POC是存在的，并且多个安全厂商都发布了相关的分析报告和检测方法。搜索结果也表明此漏洞允许远程未授权代码执行。

**利用方式：**

1.  攻击者建立与目标OpenSSH服务器的连接。
2.  进行SSH握手，获取服务器banner。
3.  准备堆，发送一定量的填充数据。
4.  尝试触发竞争条件，通过发送包含`glibc_base`地址的payload，并附加一些`nop`指令。
5.  如果成功，则在服务器上执行代码，获得root权限。
6.  脚本使用了多线程来增加攻击成功的几率，并对时序进行调整。

**投毒风险评估：**

提供的POC代码（`Exploit_2024_6387.py`）本身是一个漏洞利用脚本，其目的是利用目标系统的漏洞。评估投毒风险主要关注作者是否在脚本中植入了恶意代码，例如：

*   **后门代码：**  脚本在成功利用漏洞后，是否会创建一个后门，允许攻击者在未经授权的情况下再次访问系统。
*   **破坏性代码：**  脚本是否包含旨在破坏目标系统或数据的代码。
*   **信息窃取代码：**  脚本是否会窃取目标系统上的敏感信息。

分析代码发现，虽然脚本本身旨在利用漏洞，但并未发现明显的后门、破坏性或信息窃取代码。 然而，需要注意的是，该脚本的`TARGET_IP`和`TARGET_PORT`是硬编码的，在实际使用中需要进行修改。此外，攻击者可能会修改此脚本以包含恶意功能。此处的`glibc_base`地址也需要根据目标环境进行调整，否则利用大概率会失败，这也是成功利用此漏洞的难点之一。

综合来看，该仓库存在投毒风险的可能性较低，但是不排除有攻击者对代码进行修改后，二次传播。因此，建议在使用前仔细审查代码。

**风险评估：**
`poison`的百分比评估主要考虑以下几个方面：

*   **代码复杂性：** 代码越复杂，隐藏恶意代码的可能性越高。
*   **作者信誉：** 如果作者的信誉未知或可疑，则风险越高。
*   **代码审查：** 代码是否经过其他安全研究人员的审查。

根据以上分析，此脚本的`poison`风险评估为10%。

**项目地址:** [SkyGodling/CVE-2024-6387-POC](https://github.com/SkyGodling/CVE-2024-6387-POC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #7

**来源**: [CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md](../2024/CVE-2024-6387-ThatNotEasy_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，未认证的远程攻击者通过在设定的时间内认证失败触发

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞(CVE-2006-5051)。它存在一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，进而导致远程代码执行(RCE)或拒绝服务(DoS)。

根据搜索结果和漏洞信息，该漏洞影响glibc-based Linux系统，利用需要发起大量连接尝试来触发竞争条件。

提供的漏洞利用代码 `scanner.py` 是一个版本扫描器，并非直接利用 CVE-2024-6387。它用于检测目标 SSH 服务器的版本，并根据预定义的 CVE 列表判断是否存在已知的漏洞。该脚本通过创建 socket 连接到目标主机的 SSH 端口，然后发送一个空字节并接收服务器的响应，从中提取 OpenSSH 的版本信息。然后将提取的版本与易受攻击的版本列表进行比较。

**漏洞利用方式：**

1.  攻击者需要向目标 OpenSSH 服务器发起大量的连接请求。
2.  在连接建立后，故意触发认证失败，从而在信号处理过程中创建竞争条件。
3.  竞争条件允许攻击者在某些 glibc Linux 发行版中将指令插入堆中，进而实现远程代码执行。

**投毒风险：**

虽然脚本本身是一个版本扫描器，而不是直接的漏洞利用程序，但仍需谨慎评估其潜在的投毒风险。 代码中存在创建日志目录并记录扫描结果的行为，存在恶意修改扫描逻辑或在日志中写入恶意数据，但可能性极低。因此，评估投毒风险为1%。

**项目地址:** [ThatNotEasy/CVE-2024-6387](https://github.com/ThatNotEasy/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #8

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 远程代码执行/拒绝服务

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1，受影响版本包括8.5p1至9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且攻击者能够发起大量连接请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞，它源于 CVE-2006-5051。该漏洞是一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间段内未能通过身份验证来触发此漏洞。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的PoC代码是有效的。多个来源证实了该漏洞的存在和可利用性，特别是针对glibc的Linux系统。

**投毒风险：**

提供的PoC代码包含用于编译、构建和利用漏洞的Dockerfile和Python脚本。通过分析代码，可以发现以下潜在的投毒风险因素：

*   **依赖项：** Dockerfile中使用了`wget`和`curl`来下载OpenSSH源码，存在被中间人攻击替换为恶意源码的风险。尽管校验和可以降低这种风险，但如果攻击者能够控制构建环境，仍然可能引入恶意代码。
*   **shellcode：** Python脚本包含一个名为`shellcode`的变量，目前只是占位符，但攻击者可以修改此变量，插入恶意shellcode。攻击者可以精心构造shellcode，以执行恶意操作，例如安装后门、窃取数据或提权。

虽然这些风险存在，但从现有代码来看，没有发现明显的恶意代码。因此，评估投毒风险为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的OpenSSH环境（32位Linux系统）。
2.  **SSH握手：** 客户端与服务器建立连接，发送SSH版本信息并进行密钥交换（KEX）初始化。
3.  **堆准备：** 通过发送特定大小的数据包来布置堆内存，利用glibc的漏洞插入恶意指令。
4.  **触发竞争条件：** 大量连接尝试来触发信号处理程序中的竞争条件。
5.  **执行代码：** 成功触发竞争条件后，恶意代码将被执行，从而实现远程代码执行。

总体来说，利用方式较为复杂，需要精心构造数据包和进行大量的连接尝试才能成功。

**项目地址:** [YassDEV221608/CVE-2024-6387](https://github.com/YassDEV221608/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #9

**来源**: [CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md](../2024/CVE-2024-6387-YassDEV221608_CVE-2024-6387_PoC.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 9.7p1 (影响 8.5p1 到 9.7p1)

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，并且是基于glibc的Linux系统。攻击者需要能够建立到SSH服务的网络连接，并能够快速发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中发现的一个安全回归漏洞，存在于glibc的Linux系统中。该漏洞是由于OpenSSH服务器（sshd）中的信号处理存在竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用此漏洞可能导致以 root 身份远程执行代码。

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果也确认了该漏洞的存在，并描述了其可能导致远程代码执行的风险。漏洞利用代码的存在也进一步证实了漏洞的有效性，代码尝试利用竞争条件来执行任意代码。

**投毒风险：**
代码存在一定的投毒风险的可能性。虽然代码本身看起来是在尝试利用该漏洞，但以下因素需要考虑：

1.  **Shellcode占位符：** 代码中包含一个shellcode占位符`unsigned char shellcode[] = "\x90\x90\x90\x90";`，明确指示需要替换成实际的shellcode。如果用户没有意识到这一点，或者使用了恶意shellcode，可能会造成损害。这里的投毒风险在于，攻击者可能发布包含恶意shellcode的exp，诱导用户使用。 
2.  **GLIBC_BASES：** 代码中定义了`GLIBC_BASES[]`，用于绕过ASLR。如果这些地址不正确，利用将失败。更糟糕的是，如果攻击者故意提供错误的地址，可能会导致程序崩溃或其他不可预测的行为。
3.  **Timing parameters和 Heap layout 需要调整：** 代码注释中强调了定时参数和堆布局需要根据目标系统进行调整。如果这些参数设置不正确，可能会导致利用失败或目标系统不稳定。
4.  **文件结构偏移量：** 代码提到需要验证特定glibc版本的文件结构偏移量。使用错误的偏移量可能导致内存损坏或其他不可预测的行为。

总体来看，该POC的复杂性和对系统内部结构的依赖性，投毒者可以通过提供不正确的配置参数，或者引导用户使用错误的shellcode，达到破坏目标系统的目的。因此存在10%的投毒风险。

**利用方式：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **建立连接：** 攻击者首先需要与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 攻击者需要完成初始的SSH握手过程，包括协议版本交换和密钥交换初始化（KEX）。
3.  **堆准备：** 攻击者利用SSH协议发送数据包，在内存堆上布置精心构造的数据结构，为后续的漏洞利用做准备。
4.  **触发竞争条件：** 攻击者发送一个特制的SSH数据包，该数据包的设计是为了触发sshd中的竞争条件。具体来说，它利用了在身份验证失败的情况下，信号处理程序中的不安全操作。
5.  **RCE：** 成功触发竞争条件后，攻击者可以将恶意代码注入到sshd进程中，从而实现远程代码执行。具体是通过内存操作覆盖某个函数指针，使其指向攻击者提供的shellcode。
6.  **提权（Root）：** 由于sshd通常以root权限运行，因此攻击者执行的shellcode也将以root权限运行，从而完全控制目标系统。

**项目地址:** [YassDEV221608/CVE-2024-6387_PoC](https://github.com/YassDEV221608/CVE-2024-6387_PoC)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #10

**来源**: [CVE-2024-6387-alex14324_ssh_poc2024.md](../2024/CVE-2024-6387-alex14324_ssh_poc2024.md)

## CVE-2024-6387-OpenSSH-竞争条件RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行（RCE）和拒绝服务（DoS）

**影响版本:** <= 9.7p1

**利用条件:** 需要目标系统开启sshd服务，且受影响的OpenSSH版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是一个存在于OpenSSH服务器（sshd）中的安全漏洞，具体来说是一个竞争条件漏洞。该漏洞源于OpenSSH处理信号的方式。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，导致sshd以不安全的方式处理信号。这可能导致远程代码执行（RCE），攻击者获得root权限，或拒绝服务（DoS），使服务器不可用。

**有效性分析：**
从漏洞库信息、搜索结果和提供的PoC代码来看，该漏洞的PoC是存在的，并且被广泛讨论和利用。 搜索结果中提到“regreSSHion (CVE-2024-6387) is an unauthenticated RCE vulnerability in OpenSSH’s server, affecting glibc-based Linux systems. Full root access is granted.” 表明该漏洞有很高的潜在影响. PoC代码也试图绕过ASLR，并包含shellcode的占位符，表明攻击者可以注入恶意代码。

**投毒风险分析：**
提供的PoC代码具有一定的投毒风险，大约为10%。主要基于以下几点：
1.  **Shellcode占位符：** 代码中包含`unsigned char shellcode[] = "\x90\x90\x90\x90";`。虽然这只是一个占位符，需要用户替换为实际的shellcode，但攻击者可能发布包含恶意shellcode的版本，诱导用户使用。
2.  **GLIBC_BASES地址：**  代码中包含了`uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`。这些地址是ASLR绕过的尝试，但如果攻击者故意提供错误的地址，可能导致利用失败或者其他未知的行为，但一般不会产生特别大的危害。
3.  **Timing参数：** 代码中需要根据目标系统响应调整Timing参数。攻击者可能提供不合适的参数，导致利用不稳定或者失败。
4.  **Heap Layout和文件结构偏移：**  代码注释中提到“Heap layout : Requires tweaking for different OpenSSH versions.” 和 “File structure offsets: Verify for the specific glibc version.”。攻击者可能故意提供错误的值，导致利用失败或者产生其他问题。

**利用方式：**
1.  **建立连接：** 攻击者首先需要与目标服务器的sshd服务建立TCP连接。
2.  **SSH握手：** 进行SSH握手，包括版本交换、密钥交换等步骤。PoC代码中的 `perform_ssh_handshake` 函数实现了这些步骤。
3.  **堆准备：** 通过发送特定的SSH数据包，在sshd进程的堆上分配内存，并控制堆的布局。`prepare_heap` 函数用于执行此操作。
4.  **时间计算：**  计算处理最终数据包所需的时间，用于后续的竞争条件利用。`time_final_packet` 函数用于执行此操作。
5.  **竞争条件利用：**  通过大量并发连接，触发sshd中的竞争条件漏洞。攻击者不断尝试进行身份验证，但故意失败，以触发SIGALRM信号处理程序。由于信号处理程序中使用了非异步信号安全的函数，可能导致内存损坏和代码执行。`attempt_race_condition` 函数用于执行此操作。
6.  **ASLR绕过：**  由于地址空间布局随机化（ASLR）的存在，攻击者需要知道glibc的基地址。PoC代码中包含了一组可能的基地址，并尝试逐个利用。
7.  **代码注入：** 成功利用竞争条件后，攻击者可以将恶意代码（shellcode）注入到sshd进程的内存中。占位符需要替换。
8.  **代码执行：**  执行注入的shellcode，从而获得服务器的root权限。

**项目地址:** [alex14324/ssh_poc2024](https://github.com/alex14324/ssh_poc2024)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #11

**来源**: [CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md](../2024/CVE-2024-6387-almogopp_OpenSSH-CVE-2024-6387-Fix.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH服务，并允许未授权的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)。

**有效性:**
根据搜索结果和漏洞库信息，此漏洞的PoC是存在的，并且已经被公开。多个来源证实了该漏洞的存在，以及它可能导致远程代码执行。提供的“漏洞利用代码”实际上是一个缓解脚本，旨在通过升级OpenSSH版本或禁用LoginGraceTime来降低风险，而不是一个实际的利用程序。

**投毒风险:**
提供的脚本主要功能是检测并修复漏洞，但仍然存在一定的投毒风险：
*   **依赖外部源：** 脚本使用`apt-get update`和`apt-get install`命令，依赖外部软件源。如果软件源被恶意篡改，可能导致安装恶意软件包。
*   **配置修改：** 脚本会修改`/etc/ssh/sshd_config`文件，存在被恶意利用修改配置的风险。
*   **权限提升：** 脚本需要root权限运行，如果脚本被篡改，可能导致提权攻击。
综合考虑，该脚本存在一定的投毒风险，但主要风险在于依赖的外部源和配置修改，因此投毒风险评估为10%。

**利用方式:**
此漏洞的利用方式是利用 sshd 进程处理信号时的竞争条件。攻击者需要发起大量连接尝试，并在身份验证失败时触发竞争条件。成功触发后，攻击者能够在目标系统上执行任意代码。根据 offsec.com 的博客文章，此漏洞利用机会在某些 glibc Linux 发行版中，能将指令插入堆中。

**项目地址:** [almogopp/OpenSSH-CVE-2024-6387-Fix](https://github.com/almogopp/OpenSSH-CVE-2024-6387-Fix)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #12

**来源**: [CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md](../2024/CVE-2024-6387-anhvutuan_CVE-2024-6387-poc-1.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许未授权网络访问SSH端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387 (regreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的安全回归漏洞，源于 CVE-2006-5051。这是一个竞争条件漏洞，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内身份验证失败来触发此漏洞。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经公开。多个安全厂商和研究人员已经发布了关于此漏洞的分析和PoC代码。

**投毒风险分析：**

提供的Checker.py脚本的主要功能是检测目标SSH服务器是否存在CVE-2024-6387漏洞。它通过连接到目标服务器的SSH端口并获取SSH banner信息，然后将其与已知易受攻击和已修补的版本进行比较来确定漏洞状态。 代码中没有发现任何明显的恶意或后门代码。

投毒风险评估：0%。该脚本主要用于漏洞检测，不包含任何主动利用漏洞的代码，也没有发现作者隐藏的恶意代码。

**利用方式分析：**

1.  **漏洞原理：** 漏洞是由于 OpenSSH 在处理信号时存在竞争条件，允许在身份验证失败期间执行恶意代码。
2.  **攻击步骤：** 攻击者需要向目标服务器发起大量的SSH连接尝试。
3.  **触发条件：** 在连接尝试期间，攻击者故意使身份验证失败，触发竞争条件。
4.  **利用结果：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码，以root权限运行，或者造成拒绝服务攻击。
5.  **缓解措施：** 通过设置 `LoginGraceTime 0` 禁用 `LoginGraceTime` 参数可以缓解远程代码执行的风险，但仍然存在拒绝服务的风险。更新到OpenSSH 9.8或更高版本是完整的修复方案。

**项目地址:** [anhvutuan/CVE-2024-6387-poc-1](https://github.com/anhvutuan/CVE-2024-6387-poc-1)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #13

**来源**: [CVE-2024-6387-awusan125_test_for6387.md](../2024/CVE-2024-6387-awusan125_test_for6387.md)

## CVE-2024-6387 - OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要目标系统基于 glibc，且 OpenSSH 版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理程序中的竞争条件，可能导致 `sshd` 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用可能允许攻击者在目标系统上以 root 权限执行任意代码或导致拒绝服务。

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞的 PoC 已被公开，并且漏洞利用的复杂性较高。搜索结果表明，该漏洞影响 glibc 基础的 Linux 系统。提供的 POC 代码似乎旨在利用此漏洞。

**投毒风险分析：**
该 POC 代码中存在一定的投毒风险，大约 20%。原因如下：
*   **Shellcode 占位符:** 代码中包含 `unsigned char shellcode[] = "\x90\x90\x90\x90";` 这一行，明确指出需要替换为实际的 shellcode。如果用户不小心使用了该占位符，或者植入了其他有害 shellcode，则可能导致不可预期的后果。
*   **GLIBC 基地址硬编码:** 代码中定义了 `uint64_t GLIBC_BASES[] = { 0xb7200000, 0xb7400000 };`，并表示 “Needs adjustment for specific target systems”。如果 GLIBC 基地址不正确，可能导致利用失败，甚至造成程序崩溃。攻击者可能会故意提供错误的基地址，使得用户在尝试利用时受到干扰，或者执行其他恶意操作。
*   **Timing 参数需要微调:** 代码注释中提到 “Timing parameters: Fine-tune based on target system responsiveness”。如果 timing 参数设置不当，可能导致竞争条件无法触发，或者引发其他问题。攻击者可能会提供误导性的 timing 参数，使得用户在尝试利用时遇到困难，或者触发非预期的行为。
*   **Heap 布局和文件结构偏移量:** 代码注释提到 “Heap layout : Requires tweaking for different OpenSSH versions” 和 “File structure offsets: Verify for the specific glibc version.” 这表示该漏洞利用依赖于特定的堆布局和文件结构偏移量。如果这些值不正确，则可能导致利用失败，甚至造成程序崩溃。攻击者可能会提供不兼容的值，使得用户在尝试利用时受到干扰，或者触发非预期的行为。
*   **错误处理不完善:** 代码中虽然包含了一些错误处理逻辑，但可能存在未处理的异常情况。攻击者可能会利用这些漏洞，使得程序在特定条件下崩溃或执行非预期的操作。

**利用方式：**
利用方式主要涉及以下步骤：
1.  **建立连接：** 与目标 SSH 服务器建立 TCP 连接。
2.  **SSH 握手：** 执行 SSH 握手过程，包括版本交换和密钥交换。
3.  **堆准备：** 通过发送特定的数据包，在堆上创建特定的布局。
4.  **时间控制：** 精确控制数据包的发送时间，以便触发竞争条件。
5.  **竞争条件触发：** 通过大量连接尝试和认证失败，利用信号处理程序的竞争条件在内存中注入恶意代码，通常包括修改 glibc 的数据结构。
6.  **代码执行：** 利用注入的恶意代码来执行任意命令。
7.  **绕过 ASLR：** 由于地址空间布局随机化 (ASLR) 的存在，需要确定 glibc 的基地址。PoC 代码中尝试了几个常见的基地址。

总体而言，该漏洞利用较为复杂，需要对 SSH 协议、glibc 内部机制和竞争条件有深入的了解。该漏洞的成功利用还依赖于目标系统的特定配置和状态。

**项目地址:** [awusan125/test_for6387](https://github.com/awusan125/test_for6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #14

**来源**: [CVE-2024-6387-dream434_CVE-2024-6387.md](../2024/CVE-2024-6387-dream434_CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，目标系统运行受影响的OpenSSH版本，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性评估：**

根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已经被广泛讨论。漏洞利用代码的脚本主要用于检测目标主机是否运行存在漏洞的OpenSSH版本，利用方式是扫描目标IP的22端口，获取OpenSSH版本信息，并与已知的易受攻击版本进行比较，从而判断目标系统是否存在漏洞。

**投毒风险分析：**

提供的漏洞利用代码（CVE-2024-6387.py）主要用于版本检测，功能相对简单。虽然`README.md`中包含克隆GitHub仓库的操作，但直接分析提供的Python脚本，发现潜在的投毒点在于以下几个方面：

1.  **依赖包风险：** 脚本本身依赖较少，但如果`README.md`引导用户安装额外的依赖包（例如通过`pip install -r requirements.txt`，而`requirements.txt`包含恶意包），则可能存在投毒风险。
2.  **命令执行风险：** `README.md` 中的运行命令 `python CVE-2024-6387.py http://exemple.com` 虽然看起来无害，但如果 `CVE-2024-6387.py` 存在漏洞，允许通过命令行参数执行恶意代码，则存在风险。当前提供的代码没有直接利用命令行参数执行代码的逻辑。
3.  **文件包含风险：** 如果脚本尝试动态加载其他文件（例如配置文件），而这些文件被篡改，则可能存在风险。

鉴于以上分析，以及`README.md`中存在引导用户克隆github仓库的操作，综合判断，存在较低的投毒风险，约为10%。主要基于假设恶意代码可能存在于被克隆仓库的其他文件中，或者存在利用脚本漏洞执行恶意代码的可能。

**漏洞利用方式：**

1.  **版本检测：** 攻击者首先需要确定目标系统上运行的OpenSSH版本是否在受影响的范围内（8.5p1 <= version <= 9.7p1）。
2.  **触发竞争条件：** 攻击者通过与目标SSH服务器建立连接，并在身份验证过程中故意失败，以触发漏洞相关的竞争条件。
3.  **代码执行：** 成功触发竞争条件后，攻击者可以利用该漏洞在目标系统上执行任意代码，通常以root权限执行。

搜索结果也表明，此漏洞允许未经身份验证的远程代码执行，并且影响基于glibc的Linux系统。因此，利用方式的核心在于触发竞争条件并利用glibc的特性来执行恶意代码。

**项目地址:** [dream434/CVE-2024-6387](https://github.com/dream434/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #15

**来源**: [CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-filipi86_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标主机开启SSH服务，且攻击者能够发起大量连接尝试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是一个OpenSSH服务器中的竞争条件漏洞。它源于OpenSSH处理信号的方式，当SSH服务器在短时间内收到大量连接请求且认证失败时，可能导致信号处理不当，进而允许未经验证的远程攻击者在基于glibc的Linux系统上执行任意代码，获取root权限，或者导致拒绝服务。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC已发布，表明漏洞可被利用。提供的Python脚本`CVE-2024-6387-Vulnerability-Checker.py`是一个漏洞检测工具，通过检查SSH banner版本来判断目标是否存在漏洞。脚本本身并不能直接利用该漏洞进行RCE或DoS攻击，而是用来辅助确认目标系统是否在受影响的范围内。

**投毒风险：**
该Python脚本主要功能是检查OpenSSH版本，判断其是否在受影响的范围内。代码本身只包含版本检测逻辑，没有发现任何恶意代码或后门，因此投毒风险极低。可以认为投毒风险为0%。

**利用方式：**
1.  **版本检测：** 使用PoC脚本或类似工具检测目标SSH服务器的版本，确认其是否位于易受攻击的范围(8.5p1 <= OpenSSH <= 9.7p1)。
2.  **触发竞争条件：** 如果目标版本易受攻击，攻击者需要发起大量连接尝试，并在短时间内故意认证失败，以触发竞争条件。
3.  **代码执行（或DoS）：** 成功触发竞争条件后，利用glibc的堆操作特性，攻击者可以插入恶意指令到堆中，从而实现远程代码执行。另一种利用方式是耗尽服务器资源，造成拒绝服务攻击。

需要注意的是，利用此漏洞进行RCE需要对glibc堆操作有一定的了解，并且成功率可能不高。缓解措施包括禁用`LoginGraceTime`配置，并使用`fail2ban`等工具限制恶意连接。

**项目地址:** [filipi86/CVE-2024-6387-Vulnerability-Checker](https://github.com/filipi86/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #16

**来源**: [CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-identity-threat-labs_Article-RegreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-regreSSHion

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1 (OpenSSH)

**利用条件:** 需要glibc-based Linux系统，以及OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞。漏洞源于OpenSSH服务器处理信号的方式存在问题，具体来说，当用户认证失败时，可能触发不安全的信号处理。远程攻击者可以通过在短时间内发起大量SSH连接尝试，并故意触发认证失败，从而引发竞争条件，最终可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据搜索结果（webpage 1, 3, 4, 5, 7, 8）和漏洞库信息，该漏洞已被确认为一个高危漏洞，并且存在公开的PoC（Proof of Concept）代码。虽然提供的POC代码只是一个包含漏洞描述的README.md文件，**不能直接运行，但是，github上存在可利用的POC**。该POC的有效性取决于目标系统是否满足漏洞利用的条件，即：
1.  使用受影响的OpenSSH版本（<= 9.7p1）。
2.  目标系统是基于glibc的Linux发行版。
3.  系统配置允许一定数量的并发连接。

**投毒风险：**
提供的POC代码（README.md）本身不包含任何可执行代码，因此直接的投毒风险很低。但需要注意的是，任何从互联网上下载的代码都存在潜在的风险。即使是看似无害的文档，也可能包含恶意链接或指令，引导用户下载或执行恶意代码。因此，下载和使用任何PoC代码时，都应该保持警惕，并进行充分的安全审查。

虽然提供的README.md文件本身投毒风险较低,但是考虑到实际利用中需要依赖其他EXP, 因此其他仓库被投毒的可能性相对较高。
风险评估：10%

**利用方式：**
根据漏洞描述和搜索结果，利用方式主要包括以下几个步骤：
1.  **大量连接请求：** 攻击者向目标OpenSSH服务器发起大量的并发连接请求。
2.  **触发认证失败：**  在连接请求中，故意提供错误的用户名或密码，触发认证失败事件。
3.  **竞争条件利用：**  通过大量认证失败事件，触发OpenSSH服务器中的竞争条件漏洞。
4.  **代码执行或DoS：** 成功利用漏洞后，攻击者可以执行任意代码（RCE）或导致服务器崩溃（DoS）。

需要注意的是，利用该漏洞需要一定的资源和技术，并且成功率可能不高。Red Hat 在其安全公告中指出，实现RCE需要相当多的资源投入。同时，修改sshd_config,设置LoginGraceTime为0可以有效避免远程代码执行，但仍存在拒绝服务风险.

**项目地址:** [identity-threat-labs/Article-RegreSSHion-CVE-2024-6387](https://github.com/identity-threat-labs/Article-RegreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #17

**来源**: [CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-identity-threat-labs_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，sshd服务运行且存在于受影响版本范围内，目标系统是基于glibc的Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中发现的竞争条件漏洞。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发该漏洞。成功利用可能导致以root权限远程执行代码或拒绝服务。该漏洞的利用依赖于触发信号处理程序的竞争条件，攻击者需要发起大量连接尝试才能提高触发漏洞的几率。提供的PoC代码是一个漏洞验证工具，用于检测目标系统上运行的OpenSSH版本是否存在漏洞。它通过连接到目标SSH端口并检查SSH横幅来工作。如果横幅指示易受攻击的版本，则该工具会将目标标记为易受攻击。PoC代码本身似乎不包含任何明显的投毒代码。它仅仅用于验证漏洞是否存在，并不会主动进行利用。

**利用方式：**

1.  攻击者向目标服务器的SSH端口发起大量连接请求。
2.  连接请求需要故意失败，例如提供无效的用户名或密码，以便触发身份验证失败流程。
3.  攻击者利用OpenSSH处理信号时的竞争条件，将恶意指令插入堆中。
4.  如果竞争条件利用成功，攻击者即可在目标系统上以root权限执行任意代码或导致拒绝服务。

**项目地址:** [identity-threat-labs/CVE-2024-6387-Vulnerability-Checker](https://github.com/identity-threat-labs/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #18

**来源**: [CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md](../2024/CVE-2024-6387-jocker2410_CVE-2024-6387_poc.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统使用受影响的OpenSSH版本，基于glibc的Linux系统，且未禁用LoginGraceTime

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是一个存在于OpenSSH服务器(sshd)中的竞争条件漏洞。该漏洞源于OpenSSH在处理信号时存在不安全行为。远程攻击者通过在一定时间内认证失败，可以触发此漏洞，进而可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**漏洞利用方式：**

1.  攻击者向目标服务器发起大量的SSH连接请求。
2.  在SSH认证过程中，攻击者故意使认证失败，触发LoginGraceTime超时。
3.  由于竞争条件，sshd可能在处理SIGALRM信号时进入不安全状态。
4.  在glibc-based的Linux系统上，这种不安全状态可能允许攻击者将指令插入到堆中，最终导致RCE。
5.  如果无法实现RCE，攻击者可以通过耗尽服务器资源，导致DoS。

**POC代码分析：**

提供的PoC代码`/tmp/d7c5471d195cdec17d8f4ebaf7516058/CVE-2024-6387_poc.py`的主要功能是检测目标SSH服务器的版本，判断其是否受CVE-2024-6387漏洞影响。它通过建立socket连接，发送`\x00`，接收SSH版本信息，并进行正则匹配来确定OpenSSH的版本。如果版本在易受攻击的范围内（8.5 <= 版本 < 9.8）,则输出目标系统可能存在漏洞。该PoC本身**不包含直接利用漏洞的代码**，仅仅用于版本检测。

`/tmp/d7c5471d195cdec17d8f4ebaf7516058/README.md` 提供了一个使用说明，介绍了如何使用该PoC。`/tmp/d7c5471d195cdec17d8f4ebaf7516058/ip-addr.list`包含需要检查的IP地址列表, 127.0.0.1是示例.

**有效性：**

提供的POC代码的**有效性在于验证目标系统是否存在漏洞**，而非直接利用该漏洞。根据搜索结果和漏洞描述，完整的漏洞利用需要更复杂的步骤和技术，例如大量连接尝试来触发竞争条件，以及精心构造的shellcode。因此，此PoC仅仅是前期验证步骤。

**投毒风险：**

该仓库中存在**投毒风险的可能性较低，约为10%**。PoC代码主要功能是版本检测，本身没有发现恶意代码。潜在的风险可能存在于：

*   `ip-addr.list`文件：虽然当前提供的`ip-addr.list`文件只包含本地地址`127.0.0.1`, 如果用户不小心使用了作者预先设定的其他IP地址列表，可能会导致未授权的扫描或攻击行为。
*   `session.log`文件：虽然日志记录本身不是恶意行为，但如果日志文件被上传或泄露，可能暴露用户的扫描目标信息。日志信息包含IP和端口信息。
*   在实际利用该漏洞时，如果攻击者使用了恶意的Payload，可能会对目标系统造成更大的危害。这些Payload可能被伪装成无害的代码，从而绕过安全检测。
*   如果作者在其他未公开的分支或版本中包含了恶意代码，并且诱导用户使用这些版本，则存在更高的投毒风险。

**综上所述，**虽然提供的PoC代码本身不包含明显的恶意代码，但用户在使用时仍然需要保持警惕，仔细审查代码，并确保从可信的来源获取代码，避免潜在的投毒风险。

**项目地址:** [jocker2410/CVE-2024-6387_poc](https://github.com/jocker2410/CVE-2024-6387_poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #19

**来源**: [CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md](../2024/CVE-2024-6387-kubota_CVE-2024-6387-Vulnerability-Checker.md)

## CVE-2024-6387-OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：**

从搜索结果和漏洞库信息来看，该漏洞存在可利用的POC。提供的Rust代码是一个漏洞检查器，它通过连接到SSH服务器并读取SSH banner来判断目标服务器是否运行着存在漏洞的OpenSSH版本。

**投毒风险：**

提供的代码是一个漏洞检测工具，用于检查目标系统是否存在CVE-2024-6387漏洞。代码功能相对清晰，主要包括：

*   定义了易受攻击和已修补的版本列表。
*   通过TCP连接获取SSH banner。
*   将获取的banner与已知易受攻击的版本进行比较。

代码中没有发现恶意行为，例如执行系统命令或上传/下载文件。因此，**投毒风险较低，判断为0%**。

**利用方式：**

根据漏洞信息和搜索结果，攻击者需要发起大量的连接尝试，以触发sshd中的竞争条件。成功利用该漏洞可能允许攻击者在目标系统上执行任意代码或导致拒绝服务。Offsec的博客提供了关于如何利用该漏洞的更详细的解释。

**总结：**

CVE-2024-6387是一个严重的安全漏洞，允许未经身份验证的攻击者远程执行代码。虽然利用该漏洞需要一定的资源和技术，但由于存在公开的POC，因此建议尽快更新OpenSSH版本。

**项目地址:** [kubota/CVE-2024-6387-Vulnerability-Checker](https://github.com/kubota/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #20

**来源**: [CVE-2024-6387-l-urk_CVE-2024-6387.md](../2024/CVE-2024-6387-l-urk_CVE-2024-6387.md)

## CVE-2024-6387 OpenSSH regreSSHion 远程代码执行漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** OpenSSH

**危害等级:** 高危，未授权的远程攻击者可以利用此漏洞以 root 权限执行任意代码，或者造成拒绝服务。

**影响版本:** 8.5p1 ~ 9.7p1

**利用条件:** 目标系统使用受影响的 OpenSSH 版本, 并且基于 glibc 的 Linux 系统。需要网络连通性, 且攻击者需要能够发起大量的 SSH 连接尝试。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，又名 regreSSHion，是 OpenSSH 服务器中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件漏洞，允许未经身份验证的远程攻击者在基于 glibc 的 Linux 系统上执行任意代码。漏洞的利用方式涉及发起大量的 SSH 连接尝试，触发 sshd 进程中的竞争条件，从而允许攻击者将指令插入堆中，最终实现 RCE。

**有效性：**
从搜索结果和漏洞库信息来看，此漏洞是真实存在的，并且存在公开可用的 PoC 代码。PoC 代码的描述也与漏洞描述一致，表明其具有较高的有效性。

**投毒风险：**
提供的 POC 代码库中的 `LISCENCE` 文件声明了严格的权限限制，这在一定程度上增加了投毒的可能性。虽然无法通过现有信息完全确定是否存在投毒代码，但需要对脚本进行仔细审查，特别注意以下几个方面：

*   **shellcode:**  分析 shellcode 的行为，确保其功能与漏洞利用目的相符，没有恶意行为。
*   **网络连接:**  检查代码中是否存在额外的网络连接，特别是连接到未知或可疑的 IP 地址。
*   **文件操作:**  检查代码中是否存在对系统文件的修改或删除操作。
*   **依赖项:**  审查 `requirements.txt` 文件中的依赖项，确保没有引入恶意的第三方库。

考虑到需要大量连接尝试和对堆的操纵，以及许可证的严格声明，综合评估投毒风险为10%。这部分代码逻辑比较复杂，存在隐藏恶意代码的可能性。

**利用方式：**
1.  攻击者通过网络向目标 OpenSSH 服务器发起大量的连接请求。
2.  利用 OpenSSH 服务器处理连接请求时存在的竞争条件，特别是在信号处理方面。
3.  通过精心构造的数据包，将恶意代码注入到服务器的堆内存中。
4.  触发执行注入的恶意代码，从而获得对目标系统的控制权 (RCE) 或导致拒绝服务 (DoS)。
5.  默认的shellcode打开9999端口,并使用nc进行监听。

**项目地址:** [l-urk/CVE-2024-6387](https://github.com/l-urk/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #21

**来源**: [CVE-2024-6387-lflare_cve-2024-6387-poc.md](../2024/CVE-2024-6387-lflare_cve-2024-6387-poc.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= 版本 <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387是OpenSSH服务器(sshd)中的一个竞争条件漏洞，源于CVE-2006-5051的安全回归。当sshd在不安全的方式下处理某些信号时，未经验证的远程攻击者可能通过在设定的时间内未能成功验证身份来触发此漏洞。

**有效性评估：**
根据漏洞信息和搜索结果，此漏洞的PoC已经发布，并且被广泛讨论，证明了其有效性。PoC代码（`7etsuo-regreSSHion.c`）尝试利用此漏洞，通过以下步骤：

1.  **连接建立：** 与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH协议握手。
3.  **堆准备：** 准备堆布局以进行利用。
4.  **时间测量：** 测量数据包解析时间。
5.  **竞争条件尝试：** 尝试触发竞争条件，利用信号处理中的不安全函数调用，最终目标是执行shellcode，提权至root。
6.  **ASLR绕过：**尝试不同的glibc基地址，以绕过地址空间布局随机化(ASLR)。

代码中包含了尝试20000次利用的循环，以及100ms的延时，这些都符合漏洞分析文章的描述，增加了利用成功的可能性。

**投毒风险评估：**

此PoC代码存在一定程度的投毒风险，因为:

1.  **Shellcode:** PoC代码包含一个shellcode占位符，攻击者需要替换成真实的shellcode。如果提供的shellcode本身是恶意的，那么使用此PoC会导致投毒。
2. **glibc地址:** PoC代码包含glibc基址，攻击者需要手动调整为目标系统的基址。如果提供的基址不正确，或者根本无法确定正确的基址，会影响利用成功率。如果攻击者故意提供错误的基址或者使用错误的基址绕过策略，也有可能导致拒绝服务。
3.  **定时参数：** PoC代码中的定时参数需要根据目标系统的响应速度进行调整。如果定时不当，可能导致利用失败，甚至使目标系统崩溃。
4.  **heap布局:** OpenSSH的堆布局会随着版本的变化而变化，需要针对不同的版本进行调整。如果不调整，可能无法成功利用。

**评估：**
PoC代码的编写者可能在代码中加入不易察觉的恶意行为，例如收集目标系统信息并发送到远程服务器等。但是，考虑到PoC的主要目的是为了验证漏洞，因此这种风险相对较低。PoC中已经存在大量的需要修改的地方，需要使用者有一定的漏洞知识储备，因此投毒风险相对较低。

**综合评估**：PoC中投毒风险预估为10%，

**利用方式总结：**

1.  攻击者首先需要与目标OpenSSH服务器建立连接。
2.  然后，攻击者需要执行SSH握手协议。
3.  接着，攻击者发送特制的数据包，触发sshd中的竞争条件。
4.  竞争条件允许攻击者覆盖内存中的关键数据结构。
5.  攻击者通过覆盖的数据结构，执行预先准备好的shellcode，从而获得目标系统的root权限。
6. 利用过程需要绕过ASLR保护，这可能需要多次尝试，或者使用其他信息泄露漏洞。
7. 攻击需要一定的timing， 把握好发送数据包的时间。

**项目地址:** [lflare/cve-2024-6387-poc](https://github.com/lflare/cve-2024-6387-poc)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #22

**来源**: [CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md](../2024/CVE-2024-6387-moften_regreSSHion-CVE-2024-6387.md)

## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387是一个OpenSSH服务器(sshd)中的安全回归漏洞，存在于OpenSSH 8.5p1到9.7p1版本。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。远程攻击者可以通过在设定的时间内认证失败来触发此漏洞，可能导致远程代码执行或拒绝服务。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已确认存在，并且有POC代码可用。搜索引擎结果中的多个链接指向了漏洞分析、利用和修复方法，以及相关的讨论。

**投毒风险：**
提供的POC代码包含一个Python脚本（main.py）和一个README.md文件。脚本内容主要用于识别易受攻击的OpenSSH服务器，并无发现任何恶意代码或者后门，但是不排除后续增加投毒代码的可能性, 因此投毒风险极低。

**利用方式：**
1.  攻击者需要发起大量SSH连接到目标服务器。
2.  在LoginGraceTime时间内，故意使认证失败。
3.  利用竞争条件，使sshd以不安全的方式处理信号。
4.  如果成功，攻击者可能能够执行任意代码或导致服务崩溃（拒绝服务）。

**缓解措施：**
*   将OpenSSH升级到9.8或更高版本。
*   设置`LoginGraceTime 0`可以缓解RCE，但不能完全避免DoS攻击，建议结合`fail2ban`和防火墙使用。

**项目地址:** [moften/regreSSHion-CVE-2024-6387](https://github.com/moften/regreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #23

**来源**: [CVE-2024-6387-prelearn-code_CVE-2024-6387.md](../2024/CVE-2024-6387-prelearn-code_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 远程代码执行

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行

**影响应用:** OpenSSH

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (glibc-based Linux systems)

**利用条件:** 目标系统需要运行受影响版本的OpenSSH，且基于glibc。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，也被称为"regreSSHion"，是OpenSSH服务器（sshd）中的一个安全漏洞，是CVE-2006-5051的一个回归。它是由信号处理中的竞争条件引起的。未经身份验证的远程攻击者可以通过在设定的时间内未能成功进行身份验证来触发此漏洞，可能导致以root权限执行任意代码。该漏洞影响基于glibc的Linux系统上的OpenSSH 8.5p1到9.7p1版本。

**有效性：**
根据漏洞库信息、搜索结果（特别是来自Qualys和offsec的分析），以及POC代码的存在，可以判断该漏洞是有效的，并且存在可利用的POC。

**投毒风险：**
POC代码中存在一定的投毒风险。虽然代码的目的是利用该漏洞，但攻击者可能会修改shellcode以进行恶意活动，或者在代码中加入额外的后门。例如，`shellcode`变量中包含占位符，需要替换为实际的shellcode。如果用户从不可信来源下载POC，并使用了包含恶意shellcode的POC，则可能存在投毒风险。代码中定义了多个glibc地址用于绕过ASLR，攻击者可以伪造错误的地址，来扰乱攻击。

**利用方式：**
利用方式涉及以下几个步骤：

1.  **建立连接：** 攻击者首先与目标OpenSSH服务器建立TCP连接。
2.  **SSH握手：** 执行初步的SSH握手过程，包括版本交换和密钥交换的初始化。
3.  **堆准备：** 发送特定的SSH数据包，以在sshd进程的堆上创建特定的内存布局，为利用创造条件。
4.  **触发竞争条件：** 攻击者触发一个竞争条件，该条件涉及OpenSSH处理信号的方式，利用SIGALRM信号处理程序中的不安全函数调用。
5.  **地址绕过：** 通过尝试多个可能的glibc基址，绕过地址空间布局随机化 (ASLR)。
6.  **执行代码：** 成功触发竞争条件后，将恶意shellcode注入到内存中并执行，从而获得远程代码执行权限（通常以root权限）。

**缓解措施包括：**
*   禁用`LoginGraceTime`参数，虽然不能完全阻止DoS，但可以防御RCE。
*   使用`fail2ban`等工具监控日志文件并管理连接。
*   及时更新到OpenSSH的修复版本。

**项目地址:** [prelearn-code/CVE-2024-6387](https://github.com/prelearn-code/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #24

**来源**: [CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md](../2024/CVE-2024-6387-redux-sibi-jose_mitigate_ssh.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，glibc-based Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387是一个OpenSSH服务器中的竞争条件漏洞（源于CVE-2006-5051的回归）。未经身份验证的远程攻击者可以通过在设定的时间内未能完成身份验证来触发此漏洞。利用方式是发送大量连接请求，触发竞争条件，在glibc-based Linux系统上可能导致在堆中插入恶意指令，最终实现远程代码执行或拒绝服务。提供的脚本并非POC，而是缓解措施：

1.  **有效性：** 提供的脚本实际上是一个缓解脚本，通过将`LoginGraceTime`设置为0来减少漏洞被利用的可能性，并不能直接验证漏洞，缓解脚本会禁用SSHD服务器在指定超时时间内未完成身份验证时断开连接的能力。虽然降低了RCE的风险，但增加了拒绝服务(DoS)的风险。

2.  **投毒风险：** 提供的脚本目的是缓解漏洞，没有发现任何隐藏的恶意代码，因此投毒风险为0%。

3.  **利用方式：** 根据漏洞信息和搜索结果，利用方式是未认证的攻击者向目标OpenSSH服务器发送大量连接请求，由于竞争条件的存在，sshd可能以不安全的方式处理信号，从而允许攻击者执行任意代码（RCE）或造成拒绝服务(DoS)。攻击成功的关键在于触发竞争条件，因此需要大量的并发连接尝试。


**项目地址:** [redux-sibi-jose/mitigate_ssh](https://github.com/redux-sibi-jose/mitigate_ssh)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #25

**来源**: [CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md](../2024/CVE-2024-6387-s1d6point7bugcrowd_CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH.md)

## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，并且攻击者能够建立SSH连接并触发竞争条件。攻击者需要尝试大量连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全漏洞，源于信号处理中的竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：** 根据漏洞库信息和搜索结果，此漏洞存在PoC。该漏洞的利用依赖于触发竞争条件，因此需要进行大量的连接尝试。

**投毒风险：** 分析提供的PoC代码，主要包含一个检测脚本（detection-script.py）和一个README。检测脚本尝试建立到目标SSH服务器的连接，并发送SSH协议版本字符串，然后读取服务器的响应。LICENSE文件和README.md文件是标准格式，描述了漏洞信息。由于检测脚本本身较为简单，且没有发现明显的恶意代码，因此投毒的风险较低，约为10%。 但是需要人工review所有代码.特别是二进制文件.

**利用方式：** 利用此漏洞需要：
1.  攻击者向目标服务器上的sshd服务发起大量的连接请求。
2.  在连接建立但身份验证尚未完成时，利用竞争条件触发信号处理错误。
3.  如果成功利用，攻击者可以在目标系统上执行任意代码，获得root权限（根据漏洞描述和搜索结果）。

利用的复杂性在于需要精确地控制时序，以触发竞争条件。这通常需要大量的计算资源和对目标系统行为的深入了解。同时该漏洞在glibc-based Linux systems更有效,可能无法在所有系统上利用。

**项目地址:** [s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH](https://github.com/s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #26

**来源**: [CVE-2024-6387-xaitax_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-xaitax_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行OpenSSH服务，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞，它允许未经身份验证的远程攻击者执行任意代码或造成拒绝服务。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码判断，该漏洞是真实存在的，并且存在公开的PoC，因此有效性较高。

**投毒风险：**
提供的PoC代码（CVE-2024-6387_Check.py）的主要目的是检测目标是否存在该漏洞，而不是利用该漏洞。PoC 通过banner信息判断是否存在漏洞版本。
代码中存在极低的投毒风险。主要集中在以下的可能性：

*   **DNS解析的潜在风险：** PoC脚本包含DNS解析功能(`dns_resolve`)，如果攻击者控制了DNS服务器，则可能将目标IP解析到恶意服务器，从而进行中间人攻击。这是一个间接的投毒方式，依赖于外部环境的配合。
*   **结果误判：**虽然概率很低,如果修改PoC代码，使其在特定情况下报告目标为 vulnerable，即使实际上并非如此，攻击者可以利用此信息针对性地进行攻击。

综合来看，代码本身直接包含恶意payload的可能性较低，更多的是潜在的、间接的风险。因此，投毒风险估计为1%。

**利用方式：**
1.  **漏洞原理：** 该漏洞源于OpenSSH处理信号的方式存在竞争条件。当客户端尝试连接到服务器时，如果身份验证失败，服务器会发送一个信号给处理连接的进程。由于竞争条件，这个信号可能在不安全的时间点被处理，导致内存损坏或代码执行。
2.  **利用步骤：**
    *   攻击者向目标服务器发起SSH连接，但故意不进行身份验证（或提供错误的凭据）。
    *   攻击者利用竞争条件，在身份验证失败后，诱使服务器处理信号，从而触发漏洞。
    *   如果成功，攻击者可能能够执行任意代码，从而控制目标服务器。
3.  **影响：** 成功利用此漏洞可能导致完全控制受影响的系统，包括读取敏感信息、修改系统配置以及安装恶意软件。
4.  **缓解措施：** 及时更新OpenSSH版本是缓解此漏洞最有效的方法。也可以考虑禁用`LoginGraceTime`参数，但这样做可能会影响正常用户的连接体验。


**项目地址:** [xaitax/CVE-2024-6387_Check](https://github.com/xaitax/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #27

**来源**: [CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md](../2024/CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞检测

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务攻击

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (受影响版本范围)

**利用条件:** 目标系统运行受影响版本的OpenSSH服务，并且攻击者能够建立网络连接。

**POC 可用性:** 是，存在漏洞检测POC代码

**投毒风险:** 5%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。该漏洞是一个信号处理竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞信息和搜索结果，此漏洞被认为是高危的，并且存在公开可用的PoC利用代码。该漏洞利用的复杂性较高(CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)，意味着成功利用需要精确的时序和条件，并非总是可靠，但成功利用的后果非常严重。

**投毒风险：**
提供的YAML文件是一个nuclei模板，用于检测目标系统上运行的OpenSSH版本是否在受影响的范围内，并排除已知已修复的发行版（如Ubuntu, Debian等）。README.md文件列出了排除补丁的版本。该代码的主要目的是漏洞检测，而不是漏洞利用。该nuclei模板本身不包含恶意代码，但是，如果攻击者修改此文件以错误地排除某些已修复的版本，或者包含虚假信息以误导用户，则可能存在投毒风险。 假设，攻击者修改YAML文件，移除对某些打了补丁的版本的排除规则，那么扫描结果可能会错误地将打了补丁的系统判定为存在漏洞，诱导用户采取不必要的措施。 但是，这种投毒攻击依赖于用户信任并使用被篡改的检测脚本，总体风险较低。 综合来看，POC本身投毒风险较低，约为5%。

**利用方式：**
1.  **版本检测：** 攻击者可以使用提供的nuclei模板或类似工具来扫描目标系统，确定其运行的OpenSSH版本是否在受影响的范围内。
2.  **触发竞争条件：** 一旦确认目标系统存在漏洞，攻击者需要通过发送大量无效的身份验证请求来触发竞争条件。这通常涉及在LoginGraceTime内尝试多次身份验证失败。
3.  **代码执行/拒绝服务：** 成功触发竞争条件后，sshd可能会以不安全的方式处理信号，从而允许攻击者执行任意代码或导致服务崩溃（拒绝服务）。 根据搜索结果，利用可能需要多次重试才能成功。

**缓解措施：**
*   升级到OpenSSH 9.8或更高版本。
*   禁用LoginGraceTime或将其设置为0，并使用fail2ban等工具来管理连接。
*   应用发行版提供的安全补丁。

**项目地址:** [xiw1ll/CVE-2024-6387_Checker](https://github.com/xiw1ll/CVE-2024-6387_Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #28

**来源**: [CVE-2024-6387-zql-gif_CVE-2024-6387.md](../2024/CVE-2024-6387-zql-gif_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.5p1 <= OpenSSH < 9.8p1

**利用条件:** 默认配置下，未认证的远程攻击者可以通过大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（又名 regreSSHion）是 OpenSSH 服务器中的一个漏洞，它允许在基于 glibc 的 Linux 系统上进行未经身份验证的远程代码执行。该漏洞源于 OpenSSH 服务器 (sshd) 中的信号处理竞争条件。当客户端在 LoginGraceTime 秒内未通过身份验证时，sshd 的 SIGALRM 处理程序会被异步调用，但此信号处理程序调用各种非异步信号安全函数（例如，syslog()）。

**有效性：**
根据漏洞库信息和搜索引擎结果，已经存在针对该漏洞的POC（Proof of Concept）代码。多个来源表明该漏洞可以被利用实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码主要包含漏洞解释和相关链接，实际的exp内容需要进一步分析。但从文本内容分析，投毒风险较低，约10%。需要进一步审计完整exp代码才能确定。

**利用方式：**
1.  攻击者发起大量连接尝试，目的是触发信号处理竞争条件。
2.  在身份验证超时（LoginGraceTime）之前不进行身份验证，导致 `SIGALRM` 信号触发。
3.  `SIGALRM` 信号处理程序调用非异步信号安全函数 `syslog()`，导致内存损坏或者其他不稳定状态。
4.  攻击者利用这个不稳定状态，将恶意代码注入到堆中。
5.  成功利用该漏洞可导致以 root 权限执行任意代码。

**项目地址:** [zql-gif/CVE-2024-6387](https://github.com/zql-gif/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---



---

## POC #27

**来源**: [CVE-2024-6387-xaitax_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-xaitax_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行OpenSSH服务，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞，它允许未经身份验证的远程攻击者执行任意代码或造成拒绝服务。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码判断，该漏洞是真实存在的，并且存在公开的PoC，因此有效性较高。

**投毒风险：**
提供的PoC代码（CVE-2024-6387_Check.py）的主要目的是检测目标是否存在该漏洞，而不是利用该漏洞。PoC 通过banner信息判断是否存在漏洞版本。
代码中存在极低的投毒风险。主要集中在以下的可能性：

*   **DNS解析的潜在风险：** PoC脚本包含DNS解析功能(`dns_resolve`)，如果攻击者控制了DNS服务器，则可能将目标IP解析到恶意服务器，从而进行中间人攻击。这是一个间接的投毒方式，依赖于外部环境的配合。
*   **结果误判：**虽然概率很低,如果修改PoC代码，使其在特定情况下报告目标为 vulnerable，即使实际上并非如此，攻击者可以利用此信息针对性地进行攻击。

综合来看，代码本身直接包含恶意payload的可能性较低，更多的是潜在的、间接的风险。因此，投毒风险估计为1%。

**利用方式：**
1.  **漏洞原理：** 该漏洞源于OpenSSH处理信号的方式存在竞争条件。当客户端尝试连接到服务器时，如果身份验证失败，服务器会发送一个信号给处理连接的进程。由于竞争条件，这个信号可能在不安全的时间点被处理，导致内存损坏或代码执行。
2.  **利用步骤：**
    *   攻击者向目标服务器发起SSH连接，但故意不进行身份验证（或提供错误的凭据）。
    *   攻击者利用竞争条件，在身份验证失败后，诱使服务器处理信号，从而触发漏洞。
    *   如果成功，攻击者可能能够执行任意代码，从而控制目标服务器。
3.  **影响：** 成功利用此漏洞可能导致完全控制受影响的系统，包括读取敏感信息、修改系统配置以及安装恶意软件。
4.  **缓解措施：** 及时更新OpenSSH版本是缓解此漏洞最有效的方法。也可以考虑禁用`LoginGraceTime`参数，但这样做可能会影响正常用户的连接体验。


**项目地址:** [xaitax/CVE-2024-6387_Check](https://github.com/xaitax/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #28

**来源**: [CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md](../2024/CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞检测

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务攻击

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (受影响版本范围)

**利用条件:** 目标系统运行受影响版本的OpenSSH服务，并且攻击者能够建立网络连接。

**POC 可用性:** 是，存在漏洞检测POC代码

**投毒风险:** 5%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。该漏洞是一个信号处理竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞信息和搜索结果，此漏洞被认为是高危的，并且存在公开可用的PoC利用代码。该漏洞利用的复杂性较高(CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)，意味着成功利用需要精确的时序和条件，并非总是可靠，但成功利用的后果非常严重。

**投毒风险：**
提供的YAML文件是一个nuclei模板，用于检测目标系统上运行的OpenSSH版本是否在受影响的范围内，并排除已知已修复的发行版（如Ubuntu, Debian等）。README.md文件列出了排除补丁的版本。该代码的主要目的是漏洞检测，而不是漏洞利用。该nuclei模板本身不包含恶意代码，但是，如果攻击者修改此文件以错误地排除某些已修复的版本，或者包含虚假信息以误导用户，则可能存在投毒风险。 假设，攻击者修改YAML文件，移除对某些打了补丁的版本的排除规则，那么扫描结果可能会错误地将打了补丁的系统判定为存在漏洞，诱导用户采取不必要的措施。 但是，这种投毒攻击依赖于用户信任并使用被篡改的检测脚本，总体风险较低。 综合来看，POC本身投毒风险较低，约为5%。

**利用方式：**
1.  **版本检测：** 攻击者可以使用提供的nuclei模板或类似工具来扫描目标系统，确定其运行的OpenSSH版本是否在受影响的范围内。
2.  **触发竞争条件：** 一旦确认目标系统存在漏洞，攻击者需要通过发送大量无效的身份验证请求来触发竞争条件。这通常涉及在LoginGraceTime内尝试多次身份验证失败。
3.  **代码执行/拒绝服务：** 成功触发竞争条件后，sshd可能会以不安全的方式处理信号，从而允许攻击者执行任意代码或导致服务崩溃（拒绝服务）。 根据搜索结果，利用可能需要多次重试才能成功。

**缓解措施：**
*   升级到OpenSSH 9.8或更高版本。
*   禁用LoginGraceTime或将其设置为0，并使用fail2ban等工具来管理连接。
*   应用发行版提供的安全补丁。

**项目地址:** [xiw1ll/CVE-2024-6387_Checker](https://github.com/xiw1ll/CVE-2024-6387_Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #29

**来源**: [CVE-2024-6387-zql-gif_CVE-2024-6387.md](../2024/CVE-2024-6387-zql-gif_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.5p1 <= OpenSSH < 9.8p1

**利用条件:** 默认配置下，未认证的远程攻击者可以通过大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（又名 regreSSHion）是 OpenSSH 服务器中的一个漏洞，它允许在基于 glibc 的 Linux 系统上进行未经身份验证的远程代码执行。该漏洞源于 OpenSSH 服务器 (sshd) 中的信号处理竞争条件。当客户端在 LoginGraceTime 秒内未通过身份验证时，sshd 的 SIGALRM 处理程序会被异步调用，但此信号处理程序调用各种非异步信号安全函数（例如，syslog()）。

**有效性：**
根据漏洞库信息和搜索引擎结果，已经存在针对该漏洞的POC（Proof of Concept）代码。多个来源表明该漏洞可以被利用实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码主要包含漏洞解释和相关链接，实际的exp内容需要进一步分析。但从文本内容分析，投毒风险较低，约10%。需要进一步审计完整exp代码才能确定。

**利用方式：**
1.  攻击者发起大量连接尝试，目的是触发信号处理竞争条件。
2.  在身份验证超时（LoginGraceTime）之前不进行身份验证，导致 `SIGALRM` 信号触发。
3.  `SIGALRM` 信号处理程序调用非异步信号安全函数 `syslog()`，导致内存损坏或者其他不稳定状态。
4.  攻击者利用这个不稳定状态，将恶意代码注入到堆中。
5.  成功利用该漏洞可导致以 root 权限执行任意代码。

**项目地址:** [zql-gif/CVE-2024-6387](https://github.com/zql-gif/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---



---

## POC #27

**来源**: [CVE-2024-6387-xaitax_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-xaitax_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行OpenSSH服务，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞，它允许未经身份验证的远程攻击者执行任意代码或造成拒绝服务。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码判断，该漏洞是真实存在的，并且存在公开的PoC，因此有效性较高。

**投毒风险：**
提供的PoC代码（CVE-2024-6387_Check.py）的主要目的是检测目标是否存在该漏洞，而不是利用该漏洞。PoC 通过banner信息判断是否存在漏洞版本。
代码中存在极低的投毒风险。主要集中在以下的可能性：

*   **DNS解析的潜在风险：** PoC脚本包含DNS解析功能(`dns_resolve`)，如果攻击者控制了DNS服务器，则可能将目标IP解析到恶意服务器，从而进行中间人攻击。这是一个间接的投毒方式，依赖于外部环境的配合。
*   **结果误判：**虽然概率很低,如果修改PoC代码，使其在特定情况下报告目标为 vulnerable，即使实际上并非如此，攻击者可以利用此信息针对性地进行攻击。

综合来看，代码本身直接包含恶意payload的可能性较低，更多的是潜在的、间接的风险。因此，投毒风险估计为1%。

**利用方式：**
1.  **漏洞原理：** 该漏洞源于OpenSSH处理信号的方式存在竞争条件。当客户端尝试连接到服务器时，如果身份验证失败，服务器会发送一个信号给处理连接的进程。由于竞争条件，这个信号可能在不安全的时间点被处理，导致内存损坏或代码执行。
2.  **利用步骤：**
    *   攻击者向目标服务器发起SSH连接，但故意不进行身份验证（或提供错误的凭据）。
    *   攻击者利用竞争条件，在身份验证失败后，诱使服务器处理信号，从而触发漏洞。
    *   如果成功，攻击者可能能够执行任意代码，从而控制目标服务器。
3.  **影响：** 成功利用此漏洞可能导致完全控制受影响的系统，包括读取敏感信息、修改系统配置以及安装恶意软件。
4.  **缓解措施：** 及时更新OpenSSH版本是缓解此漏洞最有效的方法。也可以考虑禁用`LoginGraceTime`参数，但这样做可能会影响正常用户的连接体验。


**项目地址:** [xaitax/CVE-2024-6387_Check](https://github.com/xaitax/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #28

**来源**: [CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md](../2024/CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞检测

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务攻击

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (受影响版本范围)

**利用条件:** 目标系统运行受影响版本的OpenSSH服务，并且攻击者能够建立网络连接。

**POC 可用性:** 是，存在漏洞检测POC代码

**投毒风险:** 5%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。该漏洞是一个信号处理竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞信息和搜索结果，此漏洞被认为是高危的，并且存在公开可用的PoC利用代码。该漏洞利用的复杂性较高(CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)，意味着成功利用需要精确的时序和条件，并非总是可靠，但成功利用的后果非常严重。

**投毒风险：**
提供的YAML文件是一个nuclei模板，用于检测目标系统上运行的OpenSSH版本是否在受影响的范围内，并排除已知已修复的发行版（如Ubuntu, Debian等）。README.md文件列出了排除补丁的版本。该代码的主要目的是漏洞检测，而不是漏洞利用。该nuclei模板本身不包含恶意代码，但是，如果攻击者修改此文件以错误地排除某些已修复的版本，或者包含虚假信息以误导用户，则可能存在投毒风险。 假设，攻击者修改YAML文件，移除对某些打了补丁的版本的排除规则，那么扫描结果可能会错误地将打了补丁的系统判定为存在漏洞，诱导用户采取不必要的措施。 但是，这种投毒攻击依赖于用户信任并使用被篡改的检测脚本，总体风险较低。 综合来看，POC本身投毒风险较低，约为5%。

**利用方式：**
1.  **版本检测：** 攻击者可以使用提供的nuclei模板或类似工具来扫描目标系统，确定其运行的OpenSSH版本是否在受影响的范围内。
2.  **触发竞争条件：** 一旦确认目标系统存在漏洞，攻击者需要通过发送大量无效的身份验证请求来触发竞争条件。这通常涉及在LoginGraceTime内尝试多次身份验证失败。
3.  **代码执行/拒绝服务：** 成功触发竞争条件后，sshd可能会以不安全的方式处理信号，从而允许攻击者执行任意代码或导致服务崩溃（拒绝服务）。 根据搜索结果，利用可能需要多次重试才能成功。

**缓解措施：**
*   升级到OpenSSH 9.8或更高版本。
*   禁用LoginGraceTime或将其设置为0，并使用fail2ban等工具来管理连接。
*   应用发行版提供的安全补丁。

**项目地址:** [xiw1ll/CVE-2024-6387_Checker](https://github.com/xiw1ll/CVE-2024-6387_Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #29

**来源**: [CVE-2024-6387-zql-gif_CVE-2024-6387.md](../2024/CVE-2024-6387-zql-gif_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.5p1 <= OpenSSH < 9.8p1

**利用条件:** 默认配置下，未认证的远程攻击者可以通过大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（又名 regreSSHion）是 OpenSSH 服务器中的一个漏洞，它允许在基于 glibc 的 Linux 系统上进行未经身份验证的远程代码执行。该漏洞源于 OpenSSH 服务器 (sshd) 中的信号处理竞争条件。当客户端在 LoginGraceTime 秒内未通过身份验证时，sshd 的 SIGALRM 处理程序会被异步调用，但此信号处理程序调用各种非异步信号安全函数（例如，syslog()）。

**有效性：**
根据漏洞库信息和搜索引擎结果，已经存在针对该漏洞的POC（Proof of Concept）代码。多个来源表明该漏洞可以被利用实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码主要包含漏洞解释和相关链接，实际的exp内容需要进一步分析。但从文本内容分析，投毒风险较低，约10%。需要进一步审计完整exp代码才能确定。

**利用方式：**
1.  攻击者发起大量连接尝试，目的是触发信号处理竞争条件。
2.  在身份验证超时（LoginGraceTime）之前不进行身份验证，导致 `SIGALRM` 信号触发。
3.  `SIGALRM` 信号处理程序调用非异步信号安全函数 `syslog()`，导致内存损坏或者其他不稳定状态。
4.  攻击者利用这个不稳定状态，将恶意代码注入到堆中。
5.  成功利用该漏洞可导致以 root 权限执行任意代码。

**项目地址:** [zql-gif/CVE-2024-6387](https://github.com/zql-gif/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---



---

## POC #27

**来源**: [CVE-2024-6387-xaitax_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-xaitax_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行OpenSSH服务，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞，它允许未经身份验证的远程攻击者执行任意代码或造成拒绝服务。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码判断，该漏洞是真实存在的，并且存在公开的PoC，因此有效性较高。

**投毒风险：**
提供的PoC代码（CVE-2024-6387_Check.py）的主要目的是检测目标是否存在该漏洞，而不是利用该漏洞。PoC 通过banner信息判断是否存在漏洞版本。
代码中存在极低的投毒风险。主要集中在以下的可能性：

*   **DNS解析的潜在风险：** PoC脚本包含DNS解析功能(`dns_resolve`)，如果攻击者控制了DNS服务器，则可能将目标IP解析到恶意服务器，从而进行中间人攻击。这是一个间接的投毒方式，依赖于外部环境的配合。
*   **结果误判：**虽然概率很低,如果修改PoC代码，使其在特定情况下报告目标为 vulnerable，即使实际上并非如此，攻击者可以利用此信息针对性地进行攻击。

综合来看，代码本身直接包含恶意payload的可能性较低，更多的是潜在的、间接的风险。因此，投毒风险估计为1%。

**利用方式：**
1.  **漏洞原理：** 该漏洞源于OpenSSH处理信号的方式存在竞争条件。当客户端尝试连接到服务器时，如果身份验证失败，服务器会发送一个信号给处理连接的进程。由于竞争条件，这个信号可能在不安全的时间点被处理，导致内存损坏或代码执行。
2.  **利用步骤：**
    *   攻击者向目标服务器发起SSH连接，但故意不进行身份验证（或提供错误的凭据）。
    *   攻击者利用竞争条件，在身份验证失败后，诱使服务器处理信号，从而触发漏洞。
    *   如果成功，攻击者可能能够执行任意代码，从而控制目标服务器。
3.  **影响：** 成功利用此漏洞可能导致完全控制受影响的系统，包括读取敏感信息、修改系统配置以及安装恶意软件。
4.  **缓解措施：** 及时更新OpenSSH版本是缓解此漏洞最有效的方法。也可以考虑禁用`LoginGraceTime`参数，但这样做可能会影响正常用户的连接体验。


**项目地址:** [xaitax/CVE-2024-6387_Check](https://github.com/xaitax/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #28

**来源**: [CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md](../2024/CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞检测

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务攻击

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (受影响版本范围)

**利用条件:** 目标系统运行受影响版本的OpenSSH服务，并且攻击者能够建立网络连接。

**POC 可用性:** 是，存在漏洞检测POC代码

**投毒风险:** 5%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。该漏洞是一个信号处理竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞信息和搜索结果，此漏洞被认为是高危的，并且存在公开可用的PoC利用代码。该漏洞利用的复杂性较高(CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)，意味着成功利用需要精确的时序和条件，并非总是可靠，但成功利用的后果非常严重。

**投毒风险：**
提供的YAML文件是一个nuclei模板，用于检测目标系统上运行的OpenSSH版本是否在受影响的范围内，并排除已知已修复的发行版（如Ubuntu, Debian等）。README.md文件列出了排除补丁的版本。该代码的主要目的是漏洞检测，而不是漏洞利用。该nuclei模板本身不包含恶意代码，但是，如果攻击者修改此文件以错误地排除某些已修复的版本，或者包含虚假信息以误导用户，则可能存在投毒风险。 假设，攻击者修改YAML文件，移除对某些打了补丁的版本的排除规则，那么扫描结果可能会错误地将打了补丁的系统判定为存在漏洞，诱导用户采取不必要的措施。 但是，这种投毒攻击依赖于用户信任并使用被篡改的检测脚本，总体风险较低。 综合来看，POC本身投毒风险较低，约为5%。

**利用方式：**
1.  **版本检测：** 攻击者可以使用提供的nuclei模板或类似工具来扫描目标系统，确定其运行的OpenSSH版本是否在受影响的范围内。
2.  **触发竞争条件：** 一旦确认目标系统存在漏洞，攻击者需要通过发送大量无效的身份验证请求来触发竞争条件。这通常涉及在LoginGraceTime内尝试多次身份验证失败。
3.  **代码执行/拒绝服务：** 成功触发竞争条件后，sshd可能会以不安全的方式处理信号，从而允许攻击者执行任意代码或导致服务崩溃（拒绝服务）。 根据搜索结果，利用可能需要多次重试才能成功。

**缓解措施：**
*   升级到OpenSSH 9.8或更高版本。
*   禁用LoginGraceTime或将其设置为0，并使用fail2ban等工具来管理连接。
*   应用发行版提供的安全补丁。

**项目地址:** [xiw1ll/CVE-2024-6387_Checker](https://github.com/xiw1ll/CVE-2024-6387_Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #29

**来源**: [CVE-2024-6387-zql-gif_CVE-2024-6387.md](../2024/CVE-2024-6387-zql-gif_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.5p1 <= OpenSSH < 9.8p1

**利用条件:** 默认配置下，未认证的远程攻击者可以通过大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（又名 regreSSHion）是 OpenSSH 服务器中的一个漏洞，它允许在基于 glibc 的 Linux 系统上进行未经身份验证的远程代码执行。该漏洞源于 OpenSSH 服务器 (sshd) 中的信号处理竞争条件。当客户端在 LoginGraceTime 秒内未通过身份验证时，sshd 的 SIGALRM 处理程序会被异步调用，但此信号处理程序调用各种非异步信号安全函数（例如，syslog()）。

**有效性：**
根据漏洞库信息和搜索引擎结果，已经存在针对该漏洞的POC（Proof of Concept）代码。多个来源表明该漏洞可以被利用实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码主要包含漏洞解释和相关链接，实际的exp内容需要进一步分析。但从文本内容分析，投毒风险较低，约10%。需要进一步审计完整exp代码才能确定。

**利用方式：**
1.  攻击者发起大量连接尝试，目的是触发信号处理竞争条件。
2.  在身份验证超时（LoginGraceTime）之前不进行身份验证，导致 `SIGALRM` 信号触发。
3.  `SIGALRM` 信号处理程序调用非异步信号安全函数 `syslog()`，导致内存损坏或者其他不稳定状态。
4.  攻击者利用这个不稳定状态，将恶意代码注入到堆中。
5.  成功利用该漏洞可导致以 root 权限执行任意代码。

**项目地址:** [zql-gif/CVE-2024-6387](https://github.com/zql-gif/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---



---

## POC #27

**来源**: [CVE-2024-6387-xaitax_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-xaitax_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行OpenSSH服务，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞，它允许未经身份验证的远程攻击者执行任意代码或造成拒绝服务。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码判断，该漏洞是真实存在的，并且存在公开的PoC，因此有效性较高。

**投毒风险：**
提供的PoC代码（CVE-2024-6387_Check.py）的主要目的是检测目标是否存在该漏洞，而不是利用该漏洞。PoC 通过banner信息判断是否存在漏洞版本。
代码中存在极低的投毒风险。主要集中在以下的可能性：

*   **DNS解析的潜在风险：** PoC脚本包含DNS解析功能(`dns_resolve`)，如果攻击者控制了DNS服务器，则可能将目标IP解析到恶意服务器，从而进行中间人攻击。这是一个间接的投毒方式，依赖于外部环境的配合。
*   **结果误判：**虽然概率很低,如果修改PoC代码，使其在特定情况下报告目标为 vulnerable，即使实际上并非如此，攻击者可以利用此信息针对性地进行攻击。

综合来看，代码本身直接包含恶意payload的可能性较低，更多的是潜在的、间接的风险。因此，投毒风险估计为1%。

**利用方式：**
1.  **漏洞原理：** 该漏洞源于OpenSSH处理信号的方式存在竞争条件。当客户端尝试连接到服务器时，如果身份验证失败，服务器会发送一个信号给处理连接的进程。由于竞争条件，这个信号可能在不安全的时间点被处理，导致内存损坏或代码执行。
2.  **利用步骤：**
    *   攻击者向目标服务器发起SSH连接，但故意不进行身份验证（或提供错误的凭据）。
    *   攻击者利用竞争条件，在身份验证失败后，诱使服务器处理信号，从而触发漏洞。
    *   如果成功，攻击者可能能够执行任意代码，从而控制目标服务器。
3.  **影响：** 成功利用此漏洞可能导致完全控制受影响的系统，包括读取敏感信息、修改系统配置以及安装恶意软件。
4.  **缓解措施：** 及时更新OpenSSH版本是缓解此漏洞最有效的方法。也可以考虑禁用`LoginGraceTime`参数，但这样做可能会影响正常用户的连接体验。


**项目地址:** [xaitax/CVE-2024-6387_Check](https://github.com/xaitax/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #28

**来源**: [CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md](../2024/CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞检测

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务攻击

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (受影响版本范围)

**利用条件:** 目标系统运行受影响版本的OpenSSH服务，并且攻击者能够建立网络连接。

**POC 可用性:** 是，存在漏洞检测POC代码

**投毒风险:** 5%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。该漏洞是一个信号处理竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞信息和搜索结果，此漏洞被认为是高危的，并且存在公开可用的PoC利用代码。该漏洞利用的复杂性较高(CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)，意味着成功利用需要精确的时序和条件，并非总是可靠，但成功利用的后果非常严重。

**投毒风险：**
提供的YAML文件是一个nuclei模板，用于检测目标系统上运行的OpenSSH版本是否在受影响的范围内，并排除已知已修复的发行版（如Ubuntu, Debian等）。README.md文件列出了排除补丁的版本。该代码的主要目的是漏洞检测，而不是漏洞利用。该nuclei模板本身不包含恶意代码，但是，如果攻击者修改此文件以错误地排除某些已修复的版本，或者包含虚假信息以误导用户，则可能存在投毒风险。 假设，攻击者修改YAML文件，移除对某些打了补丁的版本的排除规则，那么扫描结果可能会错误地将打了补丁的系统判定为存在漏洞，诱导用户采取不必要的措施。 但是，这种投毒攻击依赖于用户信任并使用被篡改的检测脚本，总体风险较低。 综合来看，POC本身投毒风险较低，约为5%。

**利用方式：**
1.  **版本检测：** 攻击者可以使用提供的nuclei模板或类似工具来扫描目标系统，确定其运行的OpenSSH版本是否在受影响的范围内。
2.  **触发竞争条件：** 一旦确认目标系统存在漏洞，攻击者需要通过发送大量无效的身份验证请求来触发竞争条件。这通常涉及在LoginGraceTime内尝试多次身份验证失败。
3.  **代码执行/拒绝服务：** 成功触发竞争条件后，sshd可能会以不安全的方式处理信号，从而允许攻击者执行任意代码或导致服务崩溃（拒绝服务）。 根据搜索结果，利用可能需要多次重试才能成功。

**缓解措施：**
*   升级到OpenSSH 9.8或更高版本。
*   禁用LoginGraceTime或将其设置为0，并使用fail2ban等工具来管理连接。
*   应用发行版提供的安全补丁。

**项目地址:** [xiw1ll/CVE-2024-6387_Checker](https://github.com/xiw1ll/CVE-2024-6387_Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #29

**来源**: [CVE-2024-6387-zql-gif_CVE-2024-6387.md](../2024/CVE-2024-6387-zql-gif_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.5p1 <= OpenSSH < 9.8p1

**利用条件:** 默认配置下，未认证的远程攻击者可以通过大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（又名 regreSSHion）是 OpenSSH 服务器中的一个漏洞，它允许在基于 glibc 的 Linux 系统上进行未经身份验证的远程代码执行。该漏洞源于 OpenSSH 服务器 (sshd) 中的信号处理竞争条件。当客户端在 LoginGraceTime 秒内未通过身份验证时，sshd 的 SIGALRM 处理程序会被异步调用，但此信号处理程序调用各种非异步信号安全函数（例如，syslog()）。

**有效性：**
根据漏洞库信息和搜索引擎结果，已经存在针对该漏洞的POC（Proof of Concept）代码。多个来源表明该漏洞可以被利用实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码主要包含漏洞解释和相关链接，实际的exp内容需要进一步分析。但从文本内容分析，投毒风险较低，约10%。需要进一步审计完整exp代码才能确定。

**利用方式：**
1.  攻击者发起大量连接尝试，目的是触发信号处理竞争条件。
2.  在身份验证超时（LoginGraceTime）之前不进行身份验证，导致 `SIGALRM` 信号触发。
3.  `SIGALRM` 信号处理程序调用非异步信号安全函数 `syslog()`，导致内存损坏或者其他不稳定状态。
4.  攻击者利用这个不稳定状态，将恶意代码注入到堆中。
5.  成功利用该漏洞可导致以 root 权限执行任意代码。

**项目地址:** [zql-gif/CVE-2024-6387](https://github.com/zql-gif/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---



---

## POC #27

**来源**: [CVE-2024-6387-xaitax_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-xaitax_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行OpenSSH服务，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞，它允许未经身份验证的远程攻击者执行任意代码或造成拒绝服务。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码判断，该漏洞是真实存在的，并且存在公开的PoC，因此有效性较高。

**投毒风险：**
提供的PoC代码（CVE-2024-6387_Check.py）的主要目的是检测目标是否存在该漏洞，而不是利用该漏洞。PoC 通过banner信息判断是否存在漏洞版本。
代码中存在极低的投毒风险。主要集中在以下的可能性：

*   **DNS解析的潜在风险：** PoC脚本包含DNS解析功能(`dns_resolve`)，如果攻击者控制了DNS服务器，则可能将目标IP解析到恶意服务器，从而进行中间人攻击。这是一个间接的投毒方式，依赖于外部环境的配合。
*   **结果误判：**虽然概率很低,如果修改PoC代码，使其在特定情况下报告目标为 vulnerable，即使实际上并非如此，攻击者可以利用此信息针对性地进行攻击。

综合来看，代码本身直接包含恶意payload的可能性较低，更多的是潜在的、间接的风险。因此，投毒风险估计为1%。

**利用方式：**
1.  **漏洞原理：** 该漏洞源于OpenSSH处理信号的方式存在竞争条件。当客户端尝试连接到服务器时，如果身份验证失败，服务器会发送一个信号给处理连接的进程。由于竞争条件，这个信号可能在不安全的时间点被处理，导致内存损坏或代码执行。
2.  **利用步骤：**
    *   攻击者向目标服务器发起SSH连接，但故意不进行身份验证（或提供错误的凭据）。
    *   攻击者利用竞争条件，在身份验证失败后，诱使服务器处理信号，从而触发漏洞。
    *   如果成功，攻击者可能能够执行任意代码，从而控制目标服务器。
3.  **影响：** 成功利用此漏洞可能导致完全控制受影响的系统，包括读取敏感信息、修改系统配置以及安装恶意软件。
4.  **缓解措施：** 及时更新OpenSSH版本是缓解此漏洞最有效的方法。也可以考虑禁用`LoginGraceTime`参数，但这样做可能会影响正常用户的连接体验。


**项目地址:** [xaitax/CVE-2024-6387_Check](https://github.com/xaitax/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #28

**来源**: [CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md](../2024/CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞检测

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务攻击

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (受影响版本范围)

**利用条件:** 目标系统运行受影响版本的OpenSSH服务，并且攻击者能够建立网络连接。

**POC 可用性:** 是，存在漏洞检测POC代码

**投毒风险:** 5%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。该漏洞是一个信号处理竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞信息和搜索结果，此漏洞被认为是高危的，并且存在公开可用的PoC利用代码。该漏洞利用的复杂性较高(CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)，意味着成功利用需要精确的时序和条件，并非总是可靠，但成功利用的后果非常严重。

**投毒风险：**
提供的YAML文件是一个nuclei模板，用于检测目标系统上运行的OpenSSH版本是否在受影响的范围内，并排除已知已修复的发行版（如Ubuntu, Debian等）。README.md文件列出了排除补丁的版本。该代码的主要目的是漏洞检测，而不是漏洞利用。该nuclei模板本身不包含恶意代码，但是，如果攻击者修改此文件以错误地排除某些已修复的版本，或者包含虚假信息以误导用户，则可能存在投毒风险。 假设，攻击者修改YAML文件，移除对某些打了补丁的版本的排除规则，那么扫描结果可能会错误地将打了补丁的系统判定为存在漏洞，诱导用户采取不必要的措施。 但是，这种投毒攻击依赖于用户信任并使用被篡改的检测脚本，总体风险较低。 综合来看，POC本身投毒风险较低，约为5%。

**利用方式：**
1.  **版本检测：** 攻击者可以使用提供的nuclei模板或类似工具来扫描目标系统，确定其运行的OpenSSH版本是否在受影响的范围内。
2.  **触发竞争条件：** 一旦确认目标系统存在漏洞，攻击者需要通过发送大量无效的身份验证请求来触发竞争条件。这通常涉及在LoginGraceTime内尝试多次身份验证失败。
3.  **代码执行/拒绝服务：** 成功触发竞争条件后，sshd可能会以不安全的方式处理信号，从而允许攻击者执行任意代码或导致服务崩溃（拒绝服务）。 根据搜索结果，利用可能需要多次重试才能成功。

**缓解措施：**
*   升级到OpenSSH 9.8或更高版本。
*   禁用LoginGraceTime或将其设置为0，并使用fail2ban等工具来管理连接。
*   应用发行版提供的安全补丁。

**项目地址:** [xiw1ll/CVE-2024-6387_Checker](https://github.com/xiw1ll/CVE-2024-6387_Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #29

**来源**: [CVE-2024-6387-zql-gif_CVE-2024-6387.md](../2024/CVE-2024-6387-zql-gif_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.5p1 <= OpenSSH < 9.8p1

**利用条件:** 默认配置下，未认证的远程攻击者可以通过大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（又名 regreSSHion）是 OpenSSH 服务器中的一个漏洞，它允许在基于 glibc 的 Linux 系统上进行未经身份验证的远程代码执行。该漏洞源于 OpenSSH 服务器 (sshd) 中的信号处理竞争条件。当客户端在 LoginGraceTime 秒内未通过身份验证时，sshd 的 SIGALRM 处理程序会被异步调用，但此信号处理程序调用各种非异步信号安全函数（例如，syslog()）。

**有效性：**
根据漏洞库信息和搜索引擎结果，已经存在针对该漏洞的POC（Proof of Concept）代码。多个来源表明该漏洞可以被利用实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码主要包含漏洞解释和相关链接，实际的exp内容需要进一步分析。但从文本内容分析，投毒风险较低，约10%。需要进一步审计完整exp代码才能确定。

**利用方式：**
1.  攻击者发起大量连接尝试，目的是触发信号处理竞争条件。
2.  在身份验证超时（LoginGraceTime）之前不进行身份验证，导致 `SIGALRM` 信号触发。
3.  `SIGALRM` 信号处理程序调用非异步信号安全函数 `syslog()`，导致内存损坏或者其他不稳定状态。
4.  攻击者利用这个不稳定状态，将恶意代码注入到堆中。
5.  成功利用该漏洞可导致以 root 权限执行任意代码。

**项目地址:** [zql-gif/CVE-2024-6387](https://github.com/zql-gif/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---



---

## POC #27

**来源**: [CVE-2024-6387-xaitax_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-xaitax_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行OpenSSH服务，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞，它允许未经身份验证的远程攻击者执行任意代码或造成拒绝服务。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码判断，该漏洞是真实存在的，并且存在公开的PoC，因此有效性较高。

**投毒风险：**
提供的PoC代码（CVE-2024-6387_Check.py）的主要目的是检测目标是否存在该漏洞，而不是利用该漏洞。PoC 通过banner信息判断是否存在漏洞版本。
代码中存在极低的投毒风险。主要集中在以下的可能性：

*   **DNS解析的潜在风险：** PoC脚本包含DNS解析功能(`dns_resolve`)，如果攻击者控制了DNS服务器，则可能将目标IP解析到恶意服务器，从而进行中间人攻击。这是一个间接的投毒方式，依赖于外部环境的配合。
*   **结果误判：**虽然概率很低,如果修改PoC代码，使其在特定情况下报告目标为 vulnerable，即使实际上并非如此，攻击者可以利用此信息针对性地进行攻击。

综合来看，代码本身直接包含恶意payload的可能性较低，更多的是潜在的、间接的风险。因此，投毒风险估计为1%。

**利用方式：**
1.  **漏洞原理：** 该漏洞源于OpenSSH处理信号的方式存在竞争条件。当客户端尝试连接到服务器时，如果身份验证失败，服务器会发送一个信号给处理连接的进程。由于竞争条件，这个信号可能在不安全的时间点被处理，导致内存损坏或代码执行。
2.  **利用步骤：**
    *   攻击者向目标服务器发起SSH连接，但故意不进行身份验证（或提供错误的凭据）。
    *   攻击者利用竞争条件，在身份验证失败后，诱使服务器处理信号，从而触发漏洞。
    *   如果成功，攻击者可能能够执行任意代码，从而控制目标服务器。
3.  **影响：** 成功利用此漏洞可能导致完全控制受影响的系统，包括读取敏感信息、修改系统配置以及安装恶意软件。
4.  **缓解措施：** 及时更新OpenSSH版本是缓解此漏洞最有效的方法。也可以考虑禁用`LoginGraceTime`参数，但这样做可能会影响正常用户的连接体验。


**项目地址:** [xaitax/CVE-2024-6387_Check](https://github.com/xaitax/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #28

**来源**: [CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md](../2024/CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞检测

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务攻击

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (受影响版本范围)

**利用条件:** 目标系统运行受影响版本的OpenSSH服务，并且攻击者能够建立网络连接。

**POC 可用性:** 是，存在漏洞检测POC代码

**投毒风险:** 5%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。该漏洞是一个信号处理竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞信息和搜索结果，此漏洞被认为是高危的，并且存在公开可用的PoC利用代码。该漏洞利用的复杂性较高(CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)，意味着成功利用需要精确的时序和条件，并非总是可靠，但成功利用的后果非常严重。

**投毒风险：**
提供的YAML文件是一个nuclei模板，用于检测目标系统上运行的OpenSSH版本是否在受影响的范围内，并排除已知已修复的发行版（如Ubuntu, Debian等）。README.md文件列出了排除补丁的版本。该代码的主要目的是漏洞检测，而不是漏洞利用。该nuclei模板本身不包含恶意代码，但是，如果攻击者修改此文件以错误地排除某些已修复的版本，或者包含虚假信息以误导用户，则可能存在投毒风险。 假设，攻击者修改YAML文件，移除对某些打了补丁的版本的排除规则，那么扫描结果可能会错误地将打了补丁的系统判定为存在漏洞，诱导用户采取不必要的措施。 但是，这种投毒攻击依赖于用户信任并使用被篡改的检测脚本，总体风险较低。 综合来看，POC本身投毒风险较低，约为5%。

**利用方式：**
1.  **版本检测：** 攻击者可以使用提供的nuclei模板或类似工具来扫描目标系统，确定其运行的OpenSSH版本是否在受影响的范围内。
2.  **触发竞争条件：** 一旦确认目标系统存在漏洞，攻击者需要通过发送大量无效的身份验证请求来触发竞争条件。这通常涉及在LoginGraceTime内尝试多次身份验证失败。
3.  **代码执行/拒绝服务：** 成功触发竞争条件后，sshd可能会以不安全的方式处理信号，从而允许攻击者执行任意代码或导致服务崩溃（拒绝服务）。 根据搜索结果，利用可能需要多次重试才能成功。

**缓解措施：**
*   升级到OpenSSH 9.8或更高版本。
*   禁用LoginGraceTime或将其设置为0，并使用fail2ban等工具来管理连接。
*   应用发行版提供的安全补丁。

**项目地址:** [xiw1ll/CVE-2024-6387_Checker](https://github.com/xiw1ll/CVE-2024-6387_Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #29

**来源**: [CVE-2024-6387-zql-gif_CVE-2024-6387.md](../2024/CVE-2024-6387-zql-gif_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.5p1 <= OpenSSH < 9.8p1

**利用条件:** 默认配置下，未认证的远程攻击者可以通过大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（又名 regreSSHion）是 OpenSSH 服务器中的一个漏洞，它允许在基于 glibc 的 Linux 系统上进行未经身份验证的远程代码执行。该漏洞源于 OpenSSH 服务器 (sshd) 中的信号处理竞争条件。当客户端在 LoginGraceTime 秒内未通过身份验证时，sshd 的 SIGALRM 处理程序会被异步调用，但此信号处理程序调用各种非异步信号安全函数（例如，syslog()）。

**有效性：**
根据漏洞库信息和搜索引擎结果，已经存在针对该漏洞的POC（Proof of Concept）代码。多个来源表明该漏洞可以被利用实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码主要包含漏洞解释和相关链接，实际的exp内容需要进一步分析。但从文本内容分析，投毒风险较低，约10%。需要进一步审计完整exp代码才能确定。

**利用方式：**
1.  攻击者发起大量连接尝试，目的是触发信号处理竞争条件。
2.  在身份验证超时（LoginGraceTime）之前不进行身份验证，导致 `SIGALRM` 信号触发。
3.  `SIGALRM` 信号处理程序调用非异步信号安全函数 `syslog()`，导致内存损坏或者其他不稳定状态。
4.  攻击者利用这个不稳定状态，将恶意代码注入到堆中。
5.  成功利用该漏洞可导致以 root 权限执行任意代码。

**项目地址:** [zql-gif/CVE-2024-6387](https://github.com/zql-gif/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---



---

## POC #27

**来源**: [CVE-2024-6387-xaitax_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-xaitax_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行OpenSSH服务，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞，它允许未经身份验证的远程攻击者执行任意代码或造成拒绝服务。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码判断，该漏洞是真实存在的，并且存在公开的PoC，因此有效性较高。

**投毒风险：**
提供的PoC代码（CVE-2024-6387_Check.py）的主要目的是检测目标是否存在该漏洞，而不是利用该漏洞。PoC 通过banner信息判断是否存在漏洞版本。
代码中存在极低的投毒风险。主要集中在以下的可能性：

*   **DNS解析的潜在风险：** PoC脚本包含DNS解析功能(`dns_resolve`)，如果攻击者控制了DNS服务器，则可能将目标IP解析到恶意服务器，从而进行中间人攻击。这是一个间接的投毒方式，依赖于外部环境的配合。
*   **结果误判：**虽然概率很低,如果修改PoC代码，使其在特定情况下报告目标为 vulnerable，即使实际上并非如此，攻击者可以利用此信息针对性地进行攻击。

综合来看，代码本身直接包含恶意payload的可能性较低，更多的是潜在的、间接的风险。因此，投毒风险估计为1%。

**利用方式：**
1.  **漏洞原理：** 该漏洞源于OpenSSH处理信号的方式存在竞争条件。当客户端尝试连接到服务器时，如果身份验证失败，服务器会发送一个信号给处理连接的进程。由于竞争条件，这个信号可能在不安全的时间点被处理，导致内存损坏或代码执行。
2.  **利用步骤：**
    *   攻击者向目标服务器发起SSH连接，但故意不进行身份验证（或提供错误的凭据）。
    *   攻击者利用竞争条件，在身份验证失败后，诱使服务器处理信号，从而触发漏洞。
    *   如果成功，攻击者可能能够执行任意代码，从而控制目标服务器。
3.  **影响：** 成功利用此漏洞可能导致完全控制受影响的系统，包括读取敏感信息、修改系统配置以及安装恶意软件。
4.  **缓解措施：** 及时更新OpenSSH版本是缓解此漏洞最有效的方法。也可以考虑禁用`LoginGraceTime`参数，但这样做可能会影响正常用户的连接体验。


**项目地址:** [xaitax/CVE-2024-6387_Check](https://github.com/xaitax/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #28

**来源**: [CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md](../2024/CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞检测

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务攻击

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (受影响版本范围)

**利用条件:** 目标系统运行受影响版本的OpenSSH服务，并且攻击者能够建立网络连接。

**POC 可用性:** 是，存在漏洞检测POC代码

**投毒风险:** 5%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。该漏洞是一个信号处理竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞信息和搜索结果，此漏洞被认为是高危的，并且存在公开可用的PoC利用代码。该漏洞利用的复杂性较高(CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)，意味着成功利用需要精确的时序和条件，并非总是可靠，但成功利用的后果非常严重。

**投毒风险：**
提供的YAML文件是一个nuclei模板，用于检测目标系统上运行的OpenSSH版本是否在受影响的范围内，并排除已知已修复的发行版（如Ubuntu, Debian等）。README.md文件列出了排除补丁的版本。该代码的主要目的是漏洞检测，而不是漏洞利用。该nuclei模板本身不包含恶意代码，但是，如果攻击者修改此文件以错误地排除某些已修复的版本，或者包含虚假信息以误导用户，则可能存在投毒风险。 假设，攻击者修改YAML文件，移除对某些打了补丁的版本的排除规则，那么扫描结果可能会错误地将打了补丁的系统判定为存在漏洞，诱导用户采取不必要的措施。 但是，这种投毒攻击依赖于用户信任并使用被篡改的检测脚本，总体风险较低。 综合来看，POC本身投毒风险较低，约为5%。

**利用方式：**
1.  **版本检测：** 攻击者可以使用提供的nuclei模板或类似工具来扫描目标系统，确定其运行的OpenSSH版本是否在受影响的范围内。
2.  **触发竞争条件：** 一旦确认目标系统存在漏洞，攻击者需要通过发送大量无效的身份验证请求来触发竞争条件。这通常涉及在LoginGraceTime内尝试多次身份验证失败。
3.  **代码执行/拒绝服务：** 成功触发竞争条件后，sshd可能会以不安全的方式处理信号，从而允许攻击者执行任意代码或导致服务崩溃（拒绝服务）。 根据搜索结果，利用可能需要多次重试才能成功。

**缓解措施：**
*   升级到OpenSSH 9.8或更高版本。
*   禁用LoginGraceTime或将其设置为0，并使用fail2ban等工具来管理连接。
*   应用发行版提供的安全补丁。

**项目地址:** [xiw1ll/CVE-2024-6387_Checker](https://github.com/xiw1ll/CVE-2024-6387_Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #29

**来源**: [CVE-2024-6387-zql-gif_CVE-2024-6387.md](../2024/CVE-2024-6387-zql-gif_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.5p1 <= OpenSSH < 9.8p1

**利用条件:** 默认配置下，未认证的远程攻击者可以通过大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（又名 regreSSHion）是 OpenSSH 服务器中的一个漏洞，它允许在基于 glibc 的 Linux 系统上进行未经身份验证的远程代码执行。该漏洞源于 OpenSSH 服务器 (sshd) 中的信号处理竞争条件。当客户端在 LoginGraceTime 秒内未通过身份验证时，sshd 的 SIGALRM 处理程序会被异步调用，但此信号处理程序调用各种非异步信号安全函数（例如，syslog()）。

**有效性：**
根据漏洞库信息和搜索引擎结果，已经存在针对该漏洞的POC（Proof of Concept）代码。多个来源表明该漏洞可以被利用实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码主要包含漏洞解释和相关链接，实际的exp内容需要进一步分析。但从文本内容分析，投毒风险较低，约10%。需要进一步审计完整exp代码才能确定。

**利用方式：**
1.  攻击者发起大量连接尝试，目的是触发信号处理竞争条件。
2.  在身份验证超时（LoginGraceTime）之前不进行身份验证，导致 `SIGALRM` 信号触发。
3.  `SIGALRM` 信号处理程序调用非异步信号安全函数 `syslog()`，导致内存损坏或者其他不稳定状态。
4.  攻击者利用这个不稳定状态，将恶意代码注入到堆中。
5.  成功利用该漏洞可导致以 root 权限执行任意代码。

**项目地址:** [zql-gif/CVE-2024-6387](https://github.com/zql-gif/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---



---

## POC #27

**来源**: [CVE-2024-6387-xaitax_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-xaitax_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行OpenSSH服务，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞，它允许未经身份验证的远程攻击者执行任意代码或造成拒绝服务。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码判断，该漏洞是真实存在的，并且存在公开的PoC，因此有效性较高。

**投毒风险：**
提供的PoC代码（CVE-2024-6387_Check.py）的主要目的是检测目标是否存在该漏洞，而不是利用该漏洞。PoC 通过banner信息判断是否存在漏洞版本。
代码中存在极低的投毒风险。主要集中在以下的可能性：

*   **DNS解析的潜在风险：** PoC脚本包含DNS解析功能(`dns_resolve`)，如果攻击者控制了DNS服务器，则可能将目标IP解析到恶意服务器，从而进行中间人攻击。这是一个间接的投毒方式，依赖于外部环境的配合。
*   **结果误判：**虽然概率很低,如果修改PoC代码，使其在特定情况下报告目标为 vulnerable，即使实际上并非如此，攻击者可以利用此信息针对性地进行攻击。

综合来看，代码本身直接包含恶意payload的可能性较低，更多的是潜在的、间接的风险。因此，投毒风险估计为1%。

**利用方式：**
1.  **漏洞原理：** 该漏洞源于OpenSSH处理信号的方式存在竞争条件。当客户端尝试连接到服务器时，如果身份验证失败，服务器会发送一个信号给处理连接的进程。由于竞争条件，这个信号可能在不安全的时间点被处理，导致内存损坏或代码执行。
2.  **利用步骤：**
    *   攻击者向目标服务器发起SSH连接，但故意不进行身份验证（或提供错误的凭据）。
    *   攻击者利用竞争条件，在身份验证失败后，诱使服务器处理信号，从而触发漏洞。
    *   如果成功，攻击者可能能够执行任意代码，从而控制目标服务器。
3.  **影响：** 成功利用此漏洞可能导致完全控制受影响的系统，包括读取敏感信息、修改系统配置以及安装恶意软件。
4.  **缓解措施：** 及时更新OpenSSH版本是缓解此漏洞最有效的方法。也可以考虑禁用`LoginGraceTime`参数，但这样做可能会影响正常用户的连接体验。


**项目地址:** [xaitax/CVE-2024-6387_Check](https://github.com/xaitax/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #28

**来源**: [CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md](../2024/CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞检测

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务攻击

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (受影响版本范围)

**利用条件:** 目标系统运行受影响版本的OpenSSH服务，并且攻击者能够建立网络连接。

**POC 可用性:** 是，存在漏洞检测POC代码

**投毒风险:** 5%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。该漏洞是一个信号处理竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞信息和搜索结果，此漏洞被认为是高危的，并且存在公开可用的PoC利用代码。该漏洞利用的复杂性较高(CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)，意味着成功利用需要精确的时序和条件，并非总是可靠，但成功利用的后果非常严重。

**投毒风险：**
提供的YAML文件是一个nuclei模板，用于检测目标系统上运行的OpenSSH版本是否在受影响的范围内，并排除已知已修复的发行版（如Ubuntu, Debian等）。README.md文件列出了排除补丁的版本。该代码的主要目的是漏洞检测，而不是漏洞利用。该nuclei模板本身不包含恶意代码，但是，如果攻击者修改此文件以错误地排除某些已修复的版本，或者包含虚假信息以误导用户，则可能存在投毒风险。 假设，攻击者修改YAML文件，移除对某些打了补丁的版本的排除规则，那么扫描结果可能会错误地将打了补丁的系统判定为存在漏洞，诱导用户采取不必要的措施。 但是，这种投毒攻击依赖于用户信任并使用被篡改的检测脚本，总体风险较低。 综合来看，POC本身投毒风险较低，约为5%。

**利用方式：**
1.  **版本检测：** 攻击者可以使用提供的nuclei模板或类似工具来扫描目标系统，确定其运行的OpenSSH版本是否在受影响的范围内。
2.  **触发竞争条件：** 一旦确认目标系统存在漏洞，攻击者需要通过发送大量无效的身份验证请求来触发竞争条件。这通常涉及在LoginGraceTime内尝试多次身份验证失败。
3.  **代码执行/拒绝服务：** 成功触发竞争条件后，sshd可能会以不安全的方式处理信号，从而允许攻击者执行任意代码或导致服务崩溃（拒绝服务）。 根据搜索结果，利用可能需要多次重试才能成功。

**缓解措施：**
*   升级到OpenSSH 9.8或更高版本。
*   禁用LoginGraceTime或将其设置为0，并使用fail2ban等工具来管理连接。
*   应用发行版提供的安全补丁。

**项目地址:** [xiw1ll/CVE-2024-6387_Checker](https://github.com/xiw1ll/CVE-2024-6387_Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #29

**来源**: [CVE-2024-6387-zql-gif_CVE-2024-6387.md](../2024/CVE-2024-6387-zql-gif_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.5p1 <= OpenSSH < 9.8p1

**利用条件:** 默认配置下，未认证的远程攻击者可以通过大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（又名 regreSSHion）是 OpenSSH 服务器中的一个漏洞，它允许在基于 glibc 的 Linux 系统上进行未经身份验证的远程代码执行。该漏洞源于 OpenSSH 服务器 (sshd) 中的信号处理竞争条件。当客户端在 LoginGraceTime 秒内未通过身份验证时，sshd 的 SIGALRM 处理程序会被异步调用，但此信号处理程序调用各种非异步信号安全函数（例如，syslog()）。

**有效性：**
根据漏洞库信息和搜索引擎结果，已经存在针对该漏洞的POC（Proof of Concept）代码。多个来源表明该漏洞可以被利用实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码主要包含漏洞解释和相关链接，实际的exp内容需要进一步分析。但从文本内容分析，投毒风险较低，约10%。需要进一步审计完整exp代码才能确定。

**利用方式：**
1.  攻击者发起大量连接尝试，目的是触发信号处理竞争条件。
2.  在身份验证超时（LoginGraceTime）之前不进行身份验证，导致 `SIGALRM` 信号触发。
3.  `SIGALRM` 信号处理程序调用非异步信号安全函数 `syslog()`，导致内存损坏或者其他不稳定状态。
4.  攻击者利用这个不稳定状态，将恶意代码注入到堆中。
5.  成功利用该漏洞可导致以 root 权限执行任意代码。

**项目地址:** [zql-gif/CVE-2024-6387](https://github.com/zql-gif/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---



---

## POC #27

**来源**: [CVE-2024-6387-xaitax_CVE-2024-6387_Check.md](../2024/CVE-2024-6387-xaitax_CVE-2024-6387_Check.md)

## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行OpenSSH服务，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞，它允许未经身份验证的远程攻击者执行任意代码或造成拒绝服务。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码判断，该漏洞是真实存在的，并且存在公开的PoC，因此有效性较高。

**投毒风险：**
提供的PoC代码（CVE-2024-6387_Check.py）的主要目的是检测目标是否存在该漏洞，而不是利用该漏洞。PoC 通过banner信息判断是否存在漏洞版本。
代码中存在极低的投毒风险。主要集中在以下的可能性：

*   **DNS解析的潜在风险：** PoC脚本包含DNS解析功能(`dns_resolve`)，如果攻击者控制了DNS服务器，则可能将目标IP解析到恶意服务器，从而进行中间人攻击。这是一个间接的投毒方式，依赖于外部环境的配合。
*   **结果误判：**虽然概率很低,如果修改PoC代码，使其在特定情况下报告目标为 vulnerable，即使实际上并非如此，攻击者可以利用此信息针对性地进行攻击。

综合来看，代码本身直接包含恶意payload的可能性较低，更多的是潜在的、间接的风险。因此，投毒风险估计为1%。

**利用方式：**
1.  **漏洞原理：** 该漏洞源于OpenSSH处理信号的方式存在竞争条件。当客户端尝试连接到服务器时，如果身份验证失败，服务器会发送一个信号给处理连接的进程。由于竞争条件，这个信号可能在不安全的时间点被处理，导致内存损坏或代码执行。
2.  **利用步骤：**
    *   攻击者向目标服务器发起SSH连接，但故意不进行身份验证（或提供错误的凭据）。
    *   攻击者利用竞争条件，在身份验证失败后，诱使服务器处理信号，从而触发漏洞。
    *   如果成功，攻击者可能能够执行任意代码，从而控制目标服务器。
3.  **影响：** 成功利用此漏洞可能导致完全控制受影响的系统，包括读取敏感信息、修改系统配置以及安装恶意软件。
4.  **缓解措施：** 及时更新OpenSSH版本是缓解此漏洞最有效的方法。也可以考虑禁用`LoginGraceTime`参数，但这样做可能会影响正常用户的连接体验。


**项目地址:** [xaitax/CVE-2024-6387_Check](https://github.com/xaitax/CVE-2024-6387_Check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #28

**来源**: [CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md](../2024/CVE-2024-6387-xiw1ll_CVE-2024-6387_Checker.md)

## CVE-2024-6387 OpenSSH regreSSHion 漏洞检测

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务攻击

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1 (受影响版本范围)

**利用条件:** 目标系统运行受影响版本的OpenSSH服务，并且攻击者能够建立网络连接。

**POC 可用性:** 是，存在漏洞检测POC代码

**投毒风险:** 5%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。该漏洞是一个信号处理竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据漏洞信息和搜索结果，此漏洞被认为是高危的，并且存在公开可用的PoC利用代码。该漏洞利用的复杂性较高(CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)，意味着成功利用需要精确的时序和条件，并非总是可靠，但成功利用的后果非常严重。

**投毒风险：**
提供的YAML文件是一个nuclei模板，用于检测目标系统上运行的OpenSSH版本是否在受影响的范围内，并排除已知已修复的发行版（如Ubuntu, Debian等）。README.md文件列出了排除补丁的版本。该代码的主要目的是漏洞检测，而不是漏洞利用。该nuclei模板本身不包含恶意代码，但是，如果攻击者修改此文件以错误地排除某些已修复的版本，或者包含虚假信息以误导用户，则可能存在投毒风险。 假设，攻击者修改YAML文件，移除对某些打了补丁的版本的排除规则，那么扫描结果可能会错误地将打了补丁的系统判定为存在漏洞，诱导用户采取不必要的措施。 但是，这种投毒攻击依赖于用户信任并使用被篡改的检测脚本，总体风险较低。 综合来看，POC本身投毒风险较低，约为5%。

**利用方式：**
1.  **版本检测：** 攻击者可以使用提供的nuclei模板或类似工具来扫描目标系统，确定其运行的OpenSSH版本是否在受影响的范围内。
2.  **触发竞争条件：** 一旦确认目标系统存在漏洞，攻击者需要通过发送大量无效的身份验证请求来触发竞争条件。这通常涉及在LoginGraceTime内尝试多次身份验证失败。
3.  **代码执行/拒绝服务：** 成功触发竞争条件后，sshd可能会以不安全的方式处理信号，从而允许攻击者执行任意代码或导致服务崩溃（拒绝服务）。 根据搜索结果，利用可能需要多次重试才能成功。

**缓解措施：**
*   升级到OpenSSH 9.8或更高版本。
*   禁用LoginGraceTime或将其设置为0，并使用fail2ban等工具来管理连接。
*   应用发行版提供的安全补丁。

**项目地址:** [xiw1ll/CVE-2024-6387_Checker](https://github.com/xiw1ll/CVE-2024-6387_Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

## POC #29

**来源**: [CVE-2024-6387-zql-gif_CVE-2024-6387.md](../2024/CVE-2024-6387-zql-gif_CVE-2024-6387.md)

## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.5p1 <= OpenSSH < 9.8p1

**利用条件:** 默认配置下，未认证的远程攻击者可以通过大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（又名 regreSSHion）是 OpenSSH 服务器中的一个漏洞，它允许在基于 glibc 的 Linux 系统上进行未经身份验证的远程代码执行。该漏洞源于 OpenSSH 服务器 (sshd) 中的信号处理竞争条件。当客户端在 LoginGraceTime 秒内未通过身份验证时，sshd 的 SIGALRM 处理程序会被异步调用，但此信号处理程序调用各种非异步信号安全函数（例如，syslog()）。

**有效性：**
根据漏洞库信息和搜索引擎结果，已经存在针对该漏洞的POC（Proof of Concept）代码。多个来源表明该漏洞可以被利用实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码主要包含漏洞解释和相关链接，实际的exp内容需要进一步分析。但从文本内容分析，投毒风险较低，约10%。需要进一步审计完整exp代码才能确定。

**利用方式：**
1.  攻击者发起大量连接尝试，目的是触发信号处理竞争条件。
2.  在身份验证超时（LoginGraceTime）之前不进行身份验证，导致 `SIGALRM` 信号触发。
3.  `SIGALRM` 信号处理程序调用非异步信号安全函数 `syslog()`，导致内存损坏或者其他不稳定状态。
4.  攻击者利用这个不稳定状态，将恶意代码注入到堆中。
5.  成功利用该漏洞可导致以 root 权限执行任意代码。

**项目地址:** [zql-gif/CVE-2024-6387](https://github.com/zql-gif/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)

---

