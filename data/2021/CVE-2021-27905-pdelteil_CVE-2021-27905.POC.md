# CVE-2021-27905

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-27905-Henry4E36_Solr-SSRF.md](../2021/CVE-2021-27905-Henry4E36_Solr-SSRF.md)

## CVE-2021-27905-ApacheSolr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器端请求伪造，信息泄露和潜在的RCE

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例的/replication接口对外开放且未进行访问控制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Solr的ReplicationHandler中。攻击者可以通过操纵`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，导致Solr服务器向该URL发起请求，从而实现SSRF攻击。提供的Python脚本利用了这一漏洞，通过向`/solr/{core}/replication`接口发送包含恶意`masterUrl`的请求，来尝试触发SSRF。脚本首先尝试获取Solr Core的名称，然后构造包含恶意DNSLog服务器地址的`masterUrl`，并发送请求。如果DNSLog服务器收到了请求，则证明漏洞存在。经过对提供的python脚本`CVE-2021-27905.py`和`README.md`文件内容检查，未发现任何可疑的或恶意的代码片段，因此判断不存在投毒风险。

**项目地址:** [Henry4E36/Solr-SSRF](https://github.com/Henry4E36/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #2

**来源**: [CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md](../2021/CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md)

## CVE-2021-27905 - Apache Solr SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF (Server-Side Request Forgery)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内部服务访问、远程代码执行（取决于内部网络的配置）

**影响版本:** < 8.8.2

**利用条件:** 需要Solr实例运行在受影响版本，并且`/replication`处理器对外开放（或至少可被攻击者访问）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905 是一个存在于 Apache Solr ReplicationHandler 中的 SSRF 漏洞。在受影响的版本中，ReplicationHandler 的 `masterUrl` 参数未经过充分的验证，允许攻击者指定任意 URL，导致 Solr 服务器向该 URL 发起请求。 

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在于 8.8.2 之前的版本，而提供的 PoC 代码和 Docker Compose 文件使用了 `solr:8.8.1` 镜像，证明了该漏洞的存在。

**投毒风险：**
该仓库中存在投毒代码的可能性较低，约为 10%。主要基于以下几点：
*   PoC代码相对简单，主要功能是利用 SSRF 漏洞发送 HTTP 请求。
*   代码结构清晰，易于理解和审查。
*   PoC的目的是验证漏洞的存在，而不是执行恶意操作。虽然SSRF本身具有潜在的危害，但这取决于攻击者指定的 payload。投毒指的是作者在代码中隐藏的恶意逻辑。

然而，仍然存在一定的风险：
*   依赖关系 (`requirements.txt`) 可能会被篡改，引入包含恶意代码的第三方库。但目前`requirements.txt`仅包含`requests`库，风险较低。
*   攻击者可能会误用该 PoC，将内部服务或敏感信息暴露在外部。
*   payload 本身可能包含恶意代码（例如，如果目标内部服务存在其他漏洞）。

**利用方式：**
利用方式如下：
1.  确定目标 Solr 实例的版本低于 8.8.2。
2.  找到或创建一个 Solr Core。
3.  使用提供的 PoC 代码 `cve-2021-27905.py`，指定目标 Solr 实例的 URL (`--target`) 和要发送的 payload URL (`--payload`)。
4.  如果没有指定 core，程序会自动尝试获取。
5.  PoC 代码会构造一个包含 `masterUrl` 参数的请求，发送到 `/solr/<CORE_NAME>/replication` 路径，触发 SSRF 漏洞。
6.  Solr 服务器会向 `masterUrl` 指定的 URL 发起请求，攻击者可以利用这一点探测内部网络、读取内部服务数据或者利用其他漏洞。


**项目地址:** [RIZZZIOM/CVE-2021-27905](https://github.com/RIZZZIOM/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #3

**来源**: [CVE-2021-27905-W2Ning_Solr-SSRF.md](../2021/CVE-2021-27905-W2Ning_Solr-SSRF.md)

## CVE-2021-27905-Apache Solr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器敏感信息泄露，内网探测，甚至远程代码执行（结合其他漏洞）

**影响版本:** < 8.8.2

**利用条件:** Solr实例暴露在公网上，并且目标版本小于8.8.2

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-27905是Apache Solr中的一个SSRF漏洞，存在于ReplicationHandler中。攻击者可以通过`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，Solr服务器会向该URL发起请求，从而导致SSRF。提供的POC利用了这一点，首先通过`/solr/admin/cores`接口获取core名称，然后利用`/solr/{core}/config`接口设置`requestDispatcher.requestParsers.enableRemoteStreaming`为true，最后调用`/solr/{core}/debug/dump`去dump一些配置信息，虽然这些操作本身不一定是高危操作，但开了`enableRemoteStreaming`这个口子，可能会结合其他利用方式，比如远程配置文件加载，达成RCE. 仓库中存在的投毒风险较低，主要风险在于该POC本身可能被滥用，攻击未授权的Solr实例。但是，Xray的检测插件代码本身并没有发现明显的恶意行为，只是一些配置的修改。

**项目地址:** [W2Ning/Solr-SSRF](https://github.com/W2Ning/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #4

**来源**: [CVE-2021-27905-murataydemir_CVE-2021-27905.md](../2021/CVE-2021-27905-murataydemir_CVE-2021-27905.md)

## CVE-2021-27905 Apache Solr ReplicationHandler SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内网探测等

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例开放/replication接口且未配置访问限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905是Apache Solr ReplicationHandler组件中的一个服务器端请求伪造(SSRF)漏洞。攻击者可以通过构造恶意的masterUrl或leaderUrl参数，使Solr服务器向任意URL发起请求。漏洞利用的有效性较高，因为POC代码清晰地展示了如何通过/replication接口和fetchindex命令以及masterUrl参数触发SSRF。首先，攻击者需要通过/solr/admin/cores接口获取Solr core的名称。然后，构造包含恶意URL的请求，例如`GET /solr/{core_name}/replication/?command=fetchindex&masterUrl={ssrf_here}`，发送到目标Solr服务器。服务器会根据攻击者提供的URL发起请求，从而实现SSRF攻击。投毒风险较低，但不能完全排除。虽然提供的POC代码主要是用于SSRF验证，但攻击者可能在其他文件中或在下载的依赖中加入恶意代码，比如监听特定端口、上传敏感信息等。需要人工审核其他的代码文件，以及依赖包来确认是否存在恶意代码，这里给出10%的风险评估是基于该README.md文件本身进行风险评估。

**项目地址:** [murataydemir/CVE-2021-27905](https://github.com/murataydemir/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #5

**来源**: [CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md](../2021/CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md)

# CVE-2021-27905

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-27905-Henry4E36_Solr-SSRF.md](../2021/CVE-2021-27905-Henry4E36_Solr-SSRF.md)

## CVE-2021-27905-ApacheSolr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器端请求伪造，信息泄露和潜在的RCE

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例的/replication接口对外开放且未进行访问控制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Solr的ReplicationHandler中。攻击者可以通过操纵`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，导致Solr服务器向该URL发起请求，从而实现SSRF攻击。提供的Python脚本利用了这一漏洞，通过向`/solr/{core}/replication`接口发送包含恶意`masterUrl`的请求，来尝试触发SSRF。脚本首先尝试获取Solr Core的名称，然后构造包含恶意DNSLog服务器地址的`masterUrl`，并发送请求。如果DNSLog服务器收到了请求，则证明漏洞存在。经过对提供的python脚本`CVE-2021-27905.py`和`README.md`文件内容检查，未发现任何可疑的或恶意的代码片段，因此判断不存在投毒风险。

**项目地址:** [Henry4E36/Solr-SSRF](https://github.com/Henry4E36/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #2

**来源**: [CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md](../2021/CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md)

## CVE-2021-27905 - Apache Solr SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF (Server-Side Request Forgery)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内部服务访问、远程代码执行（取决于内部网络的配置）

**影响版本:** < 8.8.2

**利用条件:** 需要Solr实例运行在受影响版本，并且`/replication`处理器对外开放（或至少可被攻击者访问）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905 是一个存在于 Apache Solr ReplicationHandler 中的 SSRF 漏洞。在受影响的版本中，ReplicationHandler 的 `masterUrl` 参数未经过充分的验证，允许攻击者指定任意 URL，导致 Solr 服务器向该 URL 发起请求。 

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在于 8.8.2 之前的版本，而提供的 PoC 代码和 Docker Compose 文件使用了 `solr:8.8.1` 镜像，证明了该漏洞的存在。

**投毒风险：**
该仓库中存在投毒代码的可能性较低，约为 10%。主要基于以下几点：
*   PoC代码相对简单，主要功能是利用 SSRF 漏洞发送 HTTP 请求。
*   代码结构清晰，易于理解和审查。
*   PoC的目的是验证漏洞的存在，而不是执行恶意操作。虽然SSRF本身具有潜在的危害，但这取决于攻击者指定的 payload。投毒指的是作者在代码中隐藏的恶意逻辑。

然而，仍然存在一定的风险：
*   依赖关系 (`requirements.txt`) 可能会被篡改，引入包含恶意代码的第三方库。但目前`requirements.txt`仅包含`requests`库，风险较低。
*   攻击者可能会误用该 PoC，将内部服务或敏感信息暴露在外部。
*   payload 本身可能包含恶意代码（例如，如果目标内部服务存在其他漏洞）。

**利用方式：**
利用方式如下：
1.  确定目标 Solr 实例的版本低于 8.8.2。
2.  找到或创建一个 Solr Core。
3.  使用提供的 PoC 代码 `cve-2021-27905.py`，指定目标 Solr 实例的 URL (`--target`) 和要发送的 payload URL (`--payload`)。
4.  如果没有指定 core，程序会自动尝试获取。
5.  PoC 代码会构造一个包含 `masterUrl` 参数的请求，发送到 `/solr/<CORE_NAME>/replication` 路径，触发 SSRF 漏洞。
6.  Solr 服务器会向 `masterUrl` 指定的 URL 发起请求，攻击者可以利用这一点探测内部网络、读取内部服务数据或者利用其他漏洞。


**项目地址:** [RIZZZIOM/CVE-2021-27905](https://github.com/RIZZZIOM/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #3

**来源**: [CVE-2021-27905-W2Ning_Solr-SSRF.md](../2021/CVE-2021-27905-W2Ning_Solr-SSRF.md)

## CVE-2021-27905-Apache Solr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器敏感信息泄露，内网探测，甚至远程代码执行（结合其他漏洞）

**影响版本:** < 8.8.2

**利用条件:** Solr实例暴露在公网上，并且目标版本小于8.8.2

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-27905是Apache Solr中的一个SSRF漏洞，存在于ReplicationHandler中。攻击者可以通过`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，Solr服务器会向该URL发起请求，从而导致SSRF。提供的POC利用了这一点，首先通过`/solr/admin/cores`接口获取core名称，然后利用`/solr/{core}/config`接口设置`requestDispatcher.requestParsers.enableRemoteStreaming`为true，最后调用`/solr/{core}/debug/dump`去dump一些配置信息，虽然这些操作本身不一定是高危操作，但开了`enableRemoteStreaming`这个口子，可能会结合其他利用方式，比如远程配置文件加载，达成RCE. 仓库中存在的投毒风险较低，主要风险在于该POC本身可能被滥用，攻击未授权的Solr实例。但是，Xray的检测插件代码本身并没有发现明显的恶意行为，只是一些配置的修改。

**项目地址:** [W2Ning/Solr-SSRF](https://github.com/W2Ning/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #4

**来源**: [CVE-2021-27905-murataydemir_CVE-2021-27905.md](../2021/CVE-2021-27905-murataydemir_CVE-2021-27905.md)

## CVE-2021-27905 Apache Solr ReplicationHandler SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内网探测等

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例开放/replication接口且未配置访问限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905是Apache Solr ReplicationHandler组件中的一个服务器端请求伪造(SSRF)漏洞。攻击者可以通过构造恶意的masterUrl或leaderUrl参数，使Solr服务器向任意URL发起请求。漏洞利用的有效性较高，因为POC代码清晰地展示了如何通过/replication接口和fetchindex命令以及masterUrl参数触发SSRF。首先，攻击者需要通过/solr/admin/cores接口获取Solr core的名称。然后，构造包含恶意URL的请求，例如`GET /solr/{core_name}/replication/?command=fetchindex&masterUrl={ssrf_here}`，发送到目标Solr服务器。服务器会根据攻击者提供的URL发起请求，从而实现SSRF攻击。投毒风险较低，但不能完全排除。虽然提供的POC代码主要是用于SSRF验证，但攻击者可能在其他文件中或在下载的依赖中加入恶意代码，比如监听特定端口、上传敏感信息等。需要人工审核其他的代码文件，以及依赖包来确认是否存在恶意代码，这里给出10%的风险评估是基于该README.md文件本身进行风险评估。

**项目地址:** [murataydemir/CVE-2021-27905](https://github.com/murataydemir/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #5

**来源**: [CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md](../2021/CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md)

# CVE-2021-27905

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-27905-Henry4E36_Solr-SSRF.md](../2021/CVE-2021-27905-Henry4E36_Solr-SSRF.md)

## CVE-2021-27905-ApacheSolr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器端请求伪造，信息泄露和潜在的RCE

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例的/replication接口对外开放且未进行访问控制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Solr的ReplicationHandler中。攻击者可以通过操纵`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，导致Solr服务器向该URL发起请求，从而实现SSRF攻击。提供的Python脚本利用了这一漏洞，通过向`/solr/{core}/replication`接口发送包含恶意`masterUrl`的请求，来尝试触发SSRF。脚本首先尝试获取Solr Core的名称，然后构造包含恶意DNSLog服务器地址的`masterUrl`，并发送请求。如果DNSLog服务器收到了请求，则证明漏洞存在。经过对提供的python脚本`CVE-2021-27905.py`和`README.md`文件内容检查，未发现任何可疑的或恶意的代码片段，因此判断不存在投毒风险。

**项目地址:** [Henry4E36/Solr-SSRF](https://github.com/Henry4E36/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #2

**来源**: [CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md](../2021/CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md)

## CVE-2021-27905 - Apache Solr SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF (Server-Side Request Forgery)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内部服务访问、远程代码执行（取决于内部网络的配置）

**影响版本:** < 8.8.2

**利用条件:** 需要Solr实例运行在受影响版本，并且`/replication`处理器对外开放（或至少可被攻击者访问）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905 是一个存在于 Apache Solr ReplicationHandler 中的 SSRF 漏洞。在受影响的版本中，ReplicationHandler 的 `masterUrl` 参数未经过充分的验证，允许攻击者指定任意 URL，导致 Solr 服务器向该 URL 发起请求。 

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在于 8.8.2 之前的版本，而提供的 PoC 代码和 Docker Compose 文件使用了 `solr:8.8.1` 镜像，证明了该漏洞的存在。

**投毒风险：**
该仓库中存在投毒代码的可能性较低，约为 10%。主要基于以下几点：
*   PoC代码相对简单，主要功能是利用 SSRF 漏洞发送 HTTP 请求。
*   代码结构清晰，易于理解和审查。
*   PoC的目的是验证漏洞的存在，而不是执行恶意操作。虽然SSRF本身具有潜在的危害，但这取决于攻击者指定的 payload。投毒指的是作者在代码中隐藏的恶意逻辑。

然而，仍然存在一定的风险：
*   依赖关系 (`requirements.txt`) 可能会被篡改，引入包含恶意代码的第三方库。但目前`requirements.txt`仅包含`requests`库，风险较低。
*   攻击者可能会误用该 PoC，将内部服务或敏感信息暴露在外部。
*   payload 本身可能包含恶意代码（例如，如果目标内部服务存在其他漏洞）。

**利用方式：**
利用方式如下：
1.  确定目标 Solr 实例的版本低于 8.8.2。
2.  找到或创建一个 Solr Core。
3.  使用提供的 PoC 代码 `cve-2021-27905.py`，指定目标 Solr 实例的 URL (`--target`) 和要发送的 payload URL (`--payload`)。
4.  如果没有指定 core，程序会自动尝试获取。
5.  PoC 代码会构造一个包含 `masterUrl` 参数的请求，发送到 `/solr/<CORE_NAME>/replication` 路径，触发 SSRF 漏洞。
6.  Solr 服务器会向 `masterUrl` 指定的 URL 发起请求，攻击者可以利用这一点探测内部网络、读取内部服务数据或者利用其他漏洞。


**项目地址:** [RIZZZIOM/CVE-2021-27905](https://github.com/RIZZZIOM/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #3

**来源**: [CVE-2021-27905-W2Ning_Solr-SSRF.md](../2021/CVE-2021-27905-W2Ning_Solr-SSRF.md)

## CVE-2021-27905-Apache Solr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器敏感信息泄露，内网探测，甚至远程代码执行（结合其他漏洞）

**影响版本:** < 8.8.2

**利用条件:** Solr实例暴露在公网上，并且目标版本小于8.8.2

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-27905是Apache Solr中的一个SSRF漏洞，存在于ReplicationHandler中。攻击者可以通过`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，Solr服务器会向该URL发起请求，从而导致SSRF。提供的POC利用了这一点，首先通过`/solr/admin/cores`接口获取core名称，然后利用`/solr/{core}/config`接口设置`requestDispatcher.requestParsers.enableRemoteStreaming`为true，最后调用`/solr/{core}/debug/dump`去dump一些配置信息，虽然这些操作本身不一定是高危操作，但开了`enableRemoteStreaming`这个口子，可能会结合其他利用方式，比如远程配置文件加载，达成RCE. 仓库中存在的投毒风险较低，主要风险在于该POC本身可能被滥用，攻击未授权的Solr实例。但是，Xray的检测插件代码本身并没有发现明显的恶意行为，只是一些配置的修改。

**项目地址:** [W2Ning/Solr-SSRF](https://github.com/W2Ning/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #4

**来源**: [CVE-2021-27905-murataydemir_CVE-2021-27905.md](../2021/CVE-2021-27905-murataydemir_CVE-2021-27905.md)

## CVE-2021-27905 Apache Solr ReplicationHandler SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内网探测等

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例开放/replication接口且未配置访问限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905是Apache Solr ReplicationHandler组件中的一个服务器端请求伪造(SSRF)漏洞。攻击者可以通过构造恶意的masterUrl或leaderUrl参数，使Solr服务器向任意URL发起请求。漏洞利用的有效性较高，因为POC代码清晰地展示了如何通过/replication接口和fetchindex命令以及masterUrl参数触发SSRF。首先，攻击者需要通过/solr/admin/cores接口获取Solr core的名称。然后，构造包含恶意URL的请求，例如`GET /solr/{core_name}/replication/?command=fetchindex&masterUrl={ssrf_here}`，发送到目标Solr服务器。服务器会根据攻击者提供的URL发起请求，从而实现SSRF攻击。投毒风险较低，但不能完全排除。虽然提供的POC代码主要是用于SSRF验证，但攻击者可能在其他文件中或在下载的依赖中加入恶意代码，比如监听特定端口、上传敏感信息等。需要人工审核其他的代码文件，以及依赖包来确认是否存在恶意代码，这里给出10%的风险评估是基于该README.md文件本身进行风险评估。

**项目地址:** [murataydemir/CVE-2021-27905](https://github.com/murataydemir/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #5

**来源**: [CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md](../2021/CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md)

# CVE-2021-27905

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-27905-Henry4E36_Solr-SSRF.md](../2021/CVE-2021-27905-Henry4E36_Solr-SSRF.md)

## CVE-2021-27905-ApacheSolr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器端请求伪造，信息泄露和潜在的RCE

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例的/replication接口对外开放且未进行访问控制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Solr的ReplicationHandler中。攻击者可以通过操纵`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，导致Solr服务器向该URL发起请求，从而实现SSRF攻击。提供的Python脚本利用了这一漏洞，通过向`/solr/{core}/replication`接口发送包含恶意`masterUrl`的请求，来尝试触发SSRF。脚本首先尝试获取Solr Core的名称，然后构造包含恶意DNSLog服务器地址的`masterUrl`，并发送请求。如果DNSLog服务器收到了请求，则证明漏洞存在。经过对提供的python脚本`CVE-2021-27905.py`和`README.md`文件内容检查，未发现任何可疑的或恶意的代码片段，因此判断不存在投毒风险。

**项目地址:** [Henry4E36/Solr-SSRF](https://github.com/Henry4E36/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #2

**来源**: [CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md](../2021/CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md)

## CVE-2021-27905 - Apache Solr SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF (Server-Side Request Forgery)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内部服务访问、远程代码执行（取决于内部网络的配置）

**影响版本:** < 8.8.2

**利用条件:** 需要Solr实例运行在受影响版本，并且`/replication`处理器对外开放（或至少可被攻击者访问）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905 是一个存在于 Apache Solr ReplicationHandler 中的 SSRF 漏洞。在受影响的版本中，ReplicationHandler 的 `masterUrl` 参数未经过充分的验证，允许攻击者指定任意 URL，导致 Solr 服务器向该 URL 发起请求。 

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在于 8.8.2 之前的版本，而提供的 PoC 代码和 Docker Compose 文件使用了 `solr:8.8.1` 镜像，证明了该漏洞的存在。

**投毒风险：**
该仓库中存在投毒代码的可能性较低，约为 10%。主要基于以下几点：
*   PoC代码相对简单，主要功能是利用 SSRF 漏洞发送 HTTP 请求。
*   代码结构清晰，易于理解和审查。
*   PoC的目的是验证漏洞的存在，而不是执行恶意操作。虽然SSRF本身具有潜在的危害，但这取决于攻击者指定的 payload。投毒指的是作者在代码中隐藏的恶意逻辑。

然而，仍然存在一定的风险：
*   依赖关系 (`requirements.txt`) 可能会被篡改，引入包含恶意代码的第三方库。但目前`requirements.txt`仅包含`requests`库，风险较低。
*   攻击者可能会误用该 PoC，将内部服务或敏感信息暴露在外部。
*   payload 本身可能包含恶意代码（例如，如果目标内部服务存在其他漏洞）。

**利用方式：**
利用方式如下：
1.  确定目标 Solr 实例的版本低于 8.8.2。
2.  找到或创建一个 Solr Core。
3.  使用提供的 PoC 代码 `cve-2021-27905.py`，指定目标 Solr 实例的 URL (`--target`) 和要发送的 payload URL (`--payload`)。
4.  如果没有指定 core，程序会自动尝试获取。
5.  PoC 代码会构造一个包含 `masterUrl` 参数的请求，发送到 `/solr/<CORE_NAME>/replication` 路径，触发 SSRF 漏洞。
6.  Solr 服务器会向 `masterUrl` 指定的 URL 发起请求，攻击者可以利用这一点探测内部网络、读取内部服务数据或者利用其他漏洞。


**项目地址:** [RIZZZIOM/CVE-2021-27905](https://github.com/RIZZZIOM/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #3

**来源**: [CVE-2021-27905-W2Ning_Solr-SSRF.md](../2021/CVE-2021-27905-W2Ning_Solr-SSRF.md)

## CVE-2021-27905-Apache Solr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器敏感信息泄露，内网探测，甚至远程代码执行（结合其他漏洞）

**影响版本:** < 8.8.2

**利用条件:** Solr实例暴露在公网上，并且目标版本小于8.8.2

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-27905是Apache Solr中的一个SSRF漏洞，存在于ReplicationHandler中。攻击者可以通过`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，Solr服务器会向该URL发起请求，从而导致SSRF。提供的POC利用了这一点，首先通过`/solr/admin/cores`接口获取core名称，然后利用`/solr/{core}/config`接口设置`requestDispatcher.requestParsers.enableRemoteStreaming`为true，最后调用`/solr/{core}/debug/dump`去dump一些配置信息，虽然这些操作本身不一定是高危操作，但开了`enableRemoteStreaming`这个口子，可能会结合其他利用方式，比如远程配置文件加载，达成RCE. 仓库中存在的投毒风险较低，主要风险在于该POC本身可能被滥用，攻击未授权的Solr实例。但是，Xray的检测插件代码本身并没有发现明显的恶意行为，只是一些配置的修改。

**项目地址:** [W2Ning/Solr-SSRF](https://github.com/W2Ning/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #4

**来源**: [CVE-2021-27905-murataydemir_CVE-2021-27905.md](../2021/CVE-2021-27905-murataydemir_CVE-2021-27905.md)

## CVE-2021-27905 Apache Solr ReplicationHandler SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内网探测等

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例开放/replication接口且未配置访问限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905是Apache Solr ReplicationHandler组件中的一个服务器端请求伪造(SSRF)漏洞。攻击者可以通过构造恶意的masterUrl或leaderUrl参数，使Solr服务器向任意URL发起请求。漏洞利用的有效性较高，因为POC代码清晰地展示了如何通过/replication接口和fetchindex命令以及masterUrl参数触发SSRF。首先，攻击者需要通过/solr/admin/cores接口获取Solr core的名称。然后，构造包含恶意URL的请求，例如`GET /solr/{core_name}/replication/?command=fetchindex&masterUrl={ssrf_here}`，发送到目标Solr服务器。服务器会根据攻击者提供的URL发起请求，从而实现SSRF攻击。投毒风险较低，但不能完全排除。虽然提供的POC代码主要是用于SSRF验证，但攻击者可能在其他文件中或在下载的依赖中加入恶意代码，比如监听特定端口、上传敏感信息等。需要人工审核其他的代码文件，以及依赖包来确认是否存在恶意代码，这里给出10%的风险评估是基于该README.md文件本身进行风险评估。

**项目地址:** [murataydemir/CVE-2021-27905](https://github.com/murataydemir/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #5

**来源**: [CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md](../2021/CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md)

# CVE-2021-27905

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-27905-Henry4E36_Solr-SSRF.md](../2021/CVE-2021-27905-Henry4E36_Solr-SSRF.md)

## CVE-2021-27905-ApacheSolr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器端请求伪造，信息泄露和潜在的RCE

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例的/replication接口对外开放且未进行访问控制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Solr的ReplicationHandler中。攻击者可以通过操纵`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，导致Solr服务器向该URL发起请求，从而实现SSRF攻击。提供的Python脚本利用了这一漏洞，通过向`/solr/{core}/replication`接口发送包含恶意`masterUrl`的请求，来尝试触发SSRF。脚本首先尝试获取Solr Core的名称，然后构造包含恶意DNSLog服务器地址的`masterUrl`，并发送请求。如果DNSLog服务器收到了请求，则证明漏洞存在。经过对提供的python脚本`CVE-2021-27905.py`和`README.md`文件内容检查，未发现任何可疑的或恶意的代码片段，因此判断不存在投毒风险。

**项目地址:** [Henry4E36/Solr-SSRF](https://github.com/Henry4E36/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #2

**来源**: [CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md](../2021/CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md)

## CVE-2021-27905 - Apache Solr SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF (Server-Side Request Forgery)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内部服务访问、远程代码执行（取决于内部网络的配置）

**影响版本:** < 8.8.2

**利用条件:** 需要Solr实例运行在受影响版本，并且`/replication`处理器对外开放（或至少可被攻击者访问）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905 是一个存在于 Apache Solr ReplicationHandler 中的 SSRF 漏洞。在受影响的版本中，ReplicationHandler 的 `masterUrl` 参数未经过充分的验证，允许攻击者指定任意 URL，导致 Solr 服务器向该 URL 发起请求。 

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在于 8.8.2 之前的版本，而提供的 PoC 代码和 Docker Compose 文件使用了 `solr:8.8.1` 镜像，证明了该漏洞的存在。

**投毒风险：**
该仓库中存在投毒代码的可能性较低，约为 10%。主要基于以下几点：
*   PoC代码相对简单，主要功能是利用 SSRF 漏洞发送 HTTP 请求。
*   代码结构清晰，易于理解和审查。
*   PoC的目的是验证漏洞的存在，而不是执行恶意操作。虽然SSRF本身具有潜在的危害，但这取决于攻击者指定的 payload。投毒指的是作者在代码中隐藏的恶意逻辑。

然而，仍然存在一定的风险：
*   依赖关系 (`requirements.txt`) 可能会被篡改，引入包含恶意代码的第三方库。但目前`requirements.txt`仅包含`requests`库，风险较低。
*   攻击者可能会误用该 PoC，将内部服务或敏感信息暴露在外部。
*   payload 本身可能包含恶意代码（例如，如果目标内部服务存在其他漏洞）。

**利用方式：**
利用方式如下：
1.  确定目标 Solr 实例的版本低于 8.8.2。
2.  找到或创建一个 Solr Core。
3.  使用提供的 PoC 代码 `cve-2021-27905.py`，指定目标 Solr 实例的 URL (`--target`) 和要发送的 payload URL (`--payload`)。
4.  如果没有指定 core，程序会自动尝试获取。
5.  PoC 代码会构造一个包含 `masterUrl` 参数的请求，发送到 `/solr/<CORE_NAME>/replication` 路径，触发 SSRF 漏洞。
6.  Solr 服务器会向 `masterUrl` 指定的 URL 发起请求，攻击者可以利用这一点探测内部网络、读取内部服务数据或者利用其他漏洞。


**项目地址:** [RIZZZIOM/CVE-2021-27905](https://github.com/RIZZZIOM/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #3

**来源**: [CVE-2021-27905-W2Ning_Solr-SSRF.md](../2021/CVE-2021-27905-W2Ning_Solr-SSRF.md)

## CVE-2021-27905-Apache Solr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器敏感信息泄露，内网探测，甚至远程代码执行（结合其他漏洞）

**影响版本:** < 8.8.2

**利用条件:** Solr实例暴露在公网上，并且目标版本小于8.8.2

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-27905是Apache Solr中的一个SSRF漏洞，存在于ReplicationHandler中。攻击者可以通过`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，Solr服务器会向该URL发起请求，从而导致SSRF。提供的POC利用了这一点，首先通过`/solr/admin/cores`接口获取core名称，然后利用`/solr/{core}/config`接口设置`requestDispatcher.requestParsers.enableRemoteStreaming`为true，最后调用`/solr/{core}/debug/dump`去dump一些配置信息，虽然这些操作本身不一定是高危操作，但开了`enableRemoteStreaming`这个口子，可能会结合其他利用方式，比如远程配置文件加载，达成RCE. 仓库中存在的投毒风险较低，主要风险在于该POC本身可能被滥用，攻击未授权的Solr实例。但是，Xray的检测插件代码本身并没有发现明显的恶意行为，只是一些配置的修改。

**项目地址:** [W2Ning/Solr-SSRF](https://github.com/W2Ning/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #4

**来源**: [CVE-2021-27905-murataydemir_CVE-2021-27905.md](../2021/CVE-2021-27905-murataydemir_CVE-2021-27905.md)

## CVE-2021-27905 Apache Solr ReplicationHandler SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内网探测等

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例开放/replication接口且未配置访问限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905是Apache Solr ReplicationHandler组件中的一个服务器端请求伪造(SSRF)漏洞。攻击者可以通过构造恶意的masterUrl或leaderUrl参数，使Solr服务器向任意URL发起请求。漏洞利用的有效性较高，因为POC代码清晰地展示了如何通过/replication接口和fetchindex命令以及masterUrl参数触发SSRF。首先，攻击者需要通过/solr/admin/cores接口获取Solr core的名称。然后，构造包含恶意URL的请求，例如`GET /solr/{core_name}/replication/?command=fetchindex&masterUrl={ssrf_here}`，发送到目标Solr服务器。服务器会根据攻击者提供的URL发起请求，从而实现SSRF攻击。投毒风险较低，但不能完全排除。虽然提供的POC代码主要是用于SSRF验证，但攻击者可能在其他文件中或在下载的依赖中加入恶意代码，比如监听特定端口、上传敏感信息等。需要人工审核其他的代码文件，以及依赖包来确认是否存在恶意代码，这里给出10%的风险评估是基于该README.md文件本身进行风险评估。

**项目地址:** [murataydemir/CVE-2021-27905](https://github.com/murataydemir/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #5

**来源**: [CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md](../2021/CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md)

# CVE-2021-27905

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-27905-Henry4E36_Solr-SSRF.md](../2021/CVE-2021-27905-Henry4E36_Solr-SSRF.md)

## CVE-2021-27905-ApacheSolr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器端请求伪造，信息泄露和潜在的RCE

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例的/replication接口对外开放且未进行访问控制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Solr的ReplicationHandler中。攻击者可以通过操纵`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，导致Solr服务器向该URL发起请求，从而实现SSRF攻击。提供的Python脚本利用了这一漏洞，通过向`/solr/{core}/replication`接口发送包含恶意`masterUrl`的请求，来尝试触发SSRF。脚本首先尝试获取Solr Core的名称，然后构造包含恶意DNSLog服务器地址的`masterUrl`，并发送请求。如果DNSLog服务器收到了请求，则证明漏洞存在。经过对提供的python脚本`CVE-2021-27905.py`和`README.md`文件内容检查，未发现任何可疑的或恶意的代码片段，因此判断不存在投毒风险。

**项目地址:** [Henry4E36/Solr-SSRF](https://github.com/Henry4E36/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #2

**来源**: [CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md](../2021/CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md)

## CVE-2021-27905 - Apache Solr SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF (Server-Side Request Forgery)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内部服务访问、远程代码执行（取决于内部网络的配置）

**影响版本:** < 8.8.2

**利用条件:** 需要Solr实例运行在受影响版本，并且`/replication`处理器对外开放（或至少可被攻击者访问）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905 是一个存在于 Apache Solr ReplicationHandler 中的 SSRF 漏洞。在受影响的版本中，ReplicationHandler 的 `masterUrl` 参数未经过充分的验证，允许攻击者指定任意 URL，导致 Solr 服务器向该 URL 发起请求。 

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在于 8.8.2 之前的版本，而提供的 PoC 代码和 Docker Compose 文件使用了 `solr:8.8.1` 镜像，证明了该漏洞的存在。

**投毒风险：**
该仓库中存在投毒代码的可能性较低，约为 10%。主要基于以下几点：
*   PoC代码相对简单，主要功能是利用 SSRF 漏洞发送 HTTP 请求。
*   代码结构清晰，易于理解和审查。
*   PoC的目的是验证漏洞的存在，而不是执行恶意操作。虽然SSRF本身具有潜在的危害，但这取决于攻击者指定的 payload。投毒指的是作者在代码中隐藏的恶意逻辑。

然而，仍然存在一定的风险：
*   依赖关系 (`requirements.txt`) 可能会被篡改，引入包含恶意代码的第三方库。但目前`requirements.txt`仅包含`requests`库，风险较低。
*   攻击者可能会误用该 PoC，将内部服务或敏感信息暴露在外部。
*   payload 本身可能包含恶意代码（例如，如果目标内部服务存在其他漏洞）。

**利用方式：**
利用方式如下：
1.  确定目标 Solr 实例的版本低于 8.8.2。
2.  找到或创建一个 Solr Core。
3.  使用提供的 PoC 代码 `cve-2021-27905.py`，指定目标 Solr 实例的 URL (`--target`) 和要发送的 payload URL (`--payload`)。
4.  如果没有指定 core，程序会自动尝试获取。
5.  PoC 代码会构造一个包含 `masterUrl` 参数的请求，发送到 `/solr/<CORE_NAME>/replication` 路径，触发 SSRF 漏洞。
6.  Solr 服务器会向 `masterUrl` 指定的 URL 发起请求，攻击者可以利用这一点探测内部网络、读取内部服务数据或者利用其他漏洞。


**项目地址:** [RIZZZIOM/CVE-2021-27905](https://github.com/RIZZZIOM/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #3

**来源**: [CVE-2021-27905-W2Ning_Solr-SSRF.md](../2021/CVE-2021-27905-W2Ning_Solr-SSRF.md)

## CVE-2021-27905-Apache Solr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器敏感信息泄露，内网探测，甚至远程代码执行（结合其他漏洞）

**影响版本:** < 8.8.2

**利用条件:** Solr实例暴露在公网上，并且目标版本小于8.8.2

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-27905是Apache Solr中的一个SSRF漏洞，存在于ReplicationHandler中。攻击者可以通过`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，Solr服务器会向该URL发起请求，从而导致SSRF。提供的POC利用了这一点，首先通过`/solr/admin/cores`接口获取core名称，然后利用`/solr/{core}/config`接口设置`requestDispatcher.requestParsers.enableRemoteStreaming`为true，最后调用`/solr/{core}/debug/dump`去dump一些配置信息，虽然这些操作本身不一定是高危操作，但开了`enableRemoteStreaming`这个口子，可能会结合其他利用方式，比如远程配置文件加载，达成RCE. 仓库中存在的投毒风险较低，主要风险在于该POC本身可能被滥用，攻击未授权的Solr实例。但是，Xray的检测插件代码本身并没有发现明显的恶意行为，只是一些配置的修改。

**项目地址:** [W2Ning/Solr-SSRF](https://github.com/W2Ning/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #4

**来源**: [CVE-2021-27905-murataydemir_CVE-2021-27905.md](../2021/CVE-2021-27905-murataydemir_CVE-2021-27905.md)

## CVE-2021-27905 Apache Solr ReplicationHandler SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内网探测等

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例开放/replication接口且未配置访问限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905是Apache Solr ReplicationHandler组件中的一个服务器端请求伪造(SSRF)漏洞。攻击者可以通过构造恶意的masterUrl或leaderUrl参数，使Solr服务器向任意URL发起请求。漏洞利用的有效性较高，因为POC代码清晰地展示了如何通过/replication接口和fetchindex命令以及masterUrl参数触发SSRF。首先，攻击者需要通过/solr/admin/cores接口获取Solr core的名称。然后，构造包含恶意URL的请求，例如`GET /solr/{core_name}/replication/?command=fetchindex&masterUrl={ssrf_here}`，发送到目标Solr服务器。服务器会根据攻击者提供的URL发起请求，从而实现SSRF攻击。投毒风险较低，但不能完全排除。虽然提供的POC代码主要是用于SSRF验证，但攻击者可能在其他文件中或在下载的依赖中加入恶意代码，比如监听特定端口、上传敏感信息等。需要人工审核其他的代码文件，以及依赖包来确认是否存在恶意代码，这里给出10%的风险评估是基于该README.md文件本身进行风险评估。

**项目地址:** [murataydemir/CVE-2021-27905](https://github.com/murataydemir/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #5

**来源**: [CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md](../2021/CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md)

# CVE-2021-27905

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-27905-Henry4E36_Solr-SSRF.md](../2021/CVE-2021-27905-Henry4E36_Solr-SSRF.md)

## CVE-2021-27905-ApacheSolr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器端请求伪造，信息泄露和潜在的RCE

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例的/replication接口对外开放且未进行访问控制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Solr的ReplicationHandler中。攻击者可以通过操纵`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，导致Solr服务器向该URL发起请求，从而实现SSRF攻击。提供的Python脚本利用了这一漏洞，通过向`/solr/{core}/replication`接口发送包含恶意`masterUrl`的请求，来尝试触发SSRF。脚本首先尝试获取Solr Core的名称，然后构造包含恶意DNSLog服务器地址的`masterUrl`，并发送请求。如果DNSLog服务器收到了请求，则证明漏洞存在。经过对提供的python脚本`CVE-2021-27905.py`和`README.md`文件内容检查，未发现任何可疑的或恶意的代码片段，因此判断不存在投毒风险。

**项目地址:** [Henry4E36/Solr-SSRF](https://github.com/Henry4E36/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #2

**来源**: [CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md](../2021/CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md)

## CVE-2021-27905 - Apache Solr SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF (Server-Side Request Forgery)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内部服务访问、远程代码执行（取决于内部网络的配置）

**影响版本:** < 8.8.2

**利用条件:** 需要Solr实例运行在受影响版本，并且`/replication`处理器对外开放（或至少可被攻击者访问）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905 是一个存在于 Apache Solr ReplicationHandler 中的 SSRF 漏洞。在受影响的版本中，ReplicationHandler 的 `masterUrl` 参数未经过充分的验证，允许攻击者指定任意 URL，导致 Solr 服务器向该 URL 发起请求。 

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在于 8.8.2 之前的版本，而提供的 PoC 代码和 Docker Compose 文件使用了 `solr:8.8.1` 镜像，证明了该漏洞的存在。

**投毒风险：**
该仓库中存在投毒代码的可能性较低，约为 10%。主要基于以下几点：
*   PoC代码相对简单，主要功能是利用 SSRF 漏洞发送 HTTP 请求。
*   代码结构清晰，易于理解和审查。
*   PoC的目的是验证漏洞的存在，而不是执行恶意操作。虽然SSRF本身具有潜在的危害，但这取决于攻击者指定的 payload。投毒指的是作者在代码中隐藏的恶意逻辑。

然而，仍然存在一定的风险：
*   依赖关系 (`requirements.txt`) 可能会被篡改，引入包含恶意代码的第三方库。但目前`requirements.txt`仅包含`requests`库，风险较低。
*   攻击者可能会误用该 PoC，将内部服务或敏感信息暴露在外部。
*   payload 本身可能包含恶意代码（例如，如果目标内部服务存在其他漏洞）。

**利用方式：**
利用方式如下：
1.  确定目标 Solr 实例的版本低于 8.8.2。
2.  找到或创建一个 Solr Core。
3.  使用提供的 PoC 代码 `cve-2021-27905.py`，指定目标 Solr 实例的 URL (`--target`) 和要发送的 payload URL (`--payload`)。
4.  如果没有指定 core，程序会自动尝试获取。
5.  PoC 代码会构造一个包含 `masterUrl` 参数的请求，发送到 `/solr/<CORE_NAME>/replication` 路径，触发 SSRF 漏洞。
6.  Solr 服务器会向 `masterUrl` 指定的 URL 发起请求，攻击者可以利用这一点探测内部网络、读取内部服务数据或者利用其他漏洞。


**项目地址:** [RIZZZIOM/CVE-2021-27905](https://github.com/RIZZZIOM/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #3

**来源**: [CVE-2021-27905-W2Ning_Solr-SSRF.md](../2021/CVE-2021-27905-W2Ning_Solr-SSRF.md)

## CVE-2021-27905-Apache Solr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器敏感信息泄露，内网探测，甚至远程代码执行（结合其他漏洞）

**影响版本:** < 8.8.2

**利用条件:** Solr实例暴露在公网上，并且目标版本小于8.8.2

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-27905是Apache Solr中的一个SSRF漏洞，存在于ReplicationHandler中。攻击者可以通过`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，Solr服务器会向该URL发起请求，从而导致SSRF。提供的POC利用了这一点，首先通过`/solr/admin/cores`接口获取core名称，然后利用`/solr/{core}/config`接口设置`requestDispatcher.requestParsers.enableRemoteStreaming`为true，最后调用`/solr/{core}/debug/dump`去dump一些配置信息，虽然这些操作本身不一定是高危操作，但开了`enableRemoteStreaming`这个口子，可能会结合其他利用方式，比如远程配置文件加载，达成RCE. 仓库中存在的投毒风险较低，主要风险在于该POC本身可能被滥用，攻击未授权的Solr实例。但是，Xray的检测插件代码本身并没有发现明显的恶意行为，只是一些配置的修改。

**项目地址:** [W2Ning/Solr-SSRF](https://github.com/W2Ning/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #4

**来源**: [CVE-2021-27905-murataydemir_CVE-2021-27905.md](../2021/CVE-2021-27905-murataydemir_CVE-2021-27905.md)

## CVE-2021-27905 Apache Solr ReplicationHandler SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内网探测等

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例开放/replication接口且未配置访问限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905是Apache Solr ReplicationHandler组件中的一个服务器端请求伪造(SSRF)漏洞。攻击者可以通过构造恶意的masterUrl或leaderUrl参数，使Solr服务器向任意URL发起请求。漏洞利用的有效性较高，因为POC代码清晰地展示了如何通过/replication接口和fetchindex命令以及masterUrl参数触发SSRF。首先，攻击者需要通过/solr/admin/cores接口获取Solr core的名称。然后，构造包含恶意URL的请求，例如`GET /solr/{core_name}/replication/?command=fetchindex&masterUrl={ssrf_here}`，发送到目标Solr服务器。服务器会根据攻击者提供的URL发起请求，从而实现SSRF攻击。投毒风险较低，但不能完全排除。虽然提供的POC代码主要是用于SSRF验证，但攻击者可能在其他文件中或在下载的依赖中加入恶意代码，比如监听特定端口、上传敏感信息等。需要人工审核其他的代码文件，以及依赖包来确认是否存在恶意代码，这里给出10%的风险评估是基于该README.md文件本身进行风险评估。

**项目地址:** [murataydemir/CVE-2021-27905](https://github.com/murataydemir/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #5

**来源**: [CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md](../2021/CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md)

# CVE-2021-27905

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-27905-Henry4E36_Solr-SSRF.md](../2021/CVE-2021-27905-Henry4E36_Solr-SSRF.md)

## CVE-2021-27905-ApacheSolr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器端请求伪造，信息泄露和潜在的RCE

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例的/replication接口对外开放且未进行访问控制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Solr的ReplicationHandler中。攻击者可以通过操纵`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，导致Solr服务器向该URL发起请求，从而实现SSRF攻击。提供的Python脚本利用了这一漏洞，通过向`/solr/{core}/replication`接口发送包含恶意`masterUrl`的请求，来尝试触发SSRF。脚本首先尝试获取Solr Core的名称，然后构造包含恶意DNSLog服务器地址的`masterUrl`，并发送请求。如果DNSLog服务器收到了请求，则证明漏洞存在。经过对提供的python脚本`CVE-2021-27905.py`和`README.md`文件内容检查，未发现任何可疑的或恶意的代码片段，因此判断不存在投毒风险。

**项目地址:** [Henry4E36/Solr-SSRF](https://github.com/Henry4E36/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #2

**来源**: [CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md](../2021/CVE-2021-27905-RIZZZIOM_CVE-2021-27905.md)

## CVE-2021-27905 - Apache Solr SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF (Server-Side Request Forgery)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内部服务访问、远程代码执行（取决于内部网络的配置）

**影响版本:** < 8.8.2

**利用条件:** 需要Solr实例运行在受影响版本，并且`/replication`处理器对外开放（或至少可被攻击者访问）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905 是一个存在于 Apache Solr ReplicationHandler 中的 SSRF 漏洞。在受影响的版本中，ReplicationHandler 的 `masterUrl` 参数未经过充分的验证，允许攻击者指定任意 URL，导致 Solr 服务器向该 URL 发起请求。 

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在于 8.8.2 之前的版本，而提供的 PoC 代码和 Docker Compose 文件使用了 `solr:8.8.1` 镜像，证明了该漏洞的存在。

**投毒风险：**
该仓库中存在投毒代码的可能性较低，约为 10%。主要基于以下几点：
*   PoC代码相对简单，主要功能是利用 SSRF 漏洞发送 HTTP 请求。
*   代码结构清晰，易于理解和审查。
*   PoC的目的是验证漏洞的存在，而不是执行恶意操作。虽然SSRF本身具有潜在的危害，但这取决于攻击者指定的 payload。投毒指的是作者在代码中隐藏的恶意逻辑。

然而，仍然存在一定的风险：
*   依赖关系 (`requirements.txt`) 可能会被篡改，引入包含恶意代码的第三方库。但目前`requirements.txt`仅包含`requests`库，风险较低。
*   攻击者可能会误用该 PoC，将内部服务或敏感信息暴露在外部。
*   payload 本身可能包含恶意代码（例如，如果目标内部服务存在其他漏洞）。

**利用方式：**
利用方式如下：
1.  确定目标 Solr 实例的版本低于 8.8.2。
2.  找到或创建一个 Solr Core。
3.  使用提供的 PoC 代码 `cve-2021-27905.py`，指定目标 Solr 实例的 URL (`--target`) 和要发送的 payload URL (`--payload`)。
4.  如果没有指定 core，程序会自动尝试获取。
5.  PoC 代码会构造一个包含 `masterUrl` 参数的请求，发送到 `/solr/<CORE_NAME>/replication` 路径，触发 SSRF 漏洞。
6.  Solr 服务器会向 `masterUrl` 指定的 URL 发起请求，攻击者可以利用这一点探测内部网络、读取内部服务数据或者利用其他漏洞。


**项目地址:** [RIZZZIOM/CVE-2021-27905](https://github.com/RIZZZIOM/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #3

**来源**: [CVE-2021-27905-W2Ning_Solr-SSRF.md](../2021/CVE-2021-27905-W2Ning_Solr-SSRF.md)

## CVE-2021-27905-Apache Solr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器敏感信息泄露，内网探测，甚至远程代码执行（结合其他漏洞）

**影响版本:** < 8.8.2

**利用条件:** Solr实例暴露在公网上，并且目标版本小于8.8.2

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-27905是Apache Solr中的一个SSRF漏洞，存在于ReplicationHandler中。攻击者可以通过`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，Solr服务器会向该URL发起请求，从而导致SSRF。提供的POC利用了这一点，首先通过`/solr/admin/cores`接口获取core名称，然后利用`/solr/{core}/config`接口设置`requestDispatcher.requestParsers.enableRemoteStreaming`为true，最后调用`/solr/{core}/debug/dump`去dump一些配置信息，虽然这些操作本身不一定是高危操作，但开了`enableRemoteStreaming`这个口子，可能会结合其他利用方式，比如远程配置文件加载，达成RCE. 仓库中存在的投毒风险较低，主要风险在于该POC本身可能被滥用，攻击未授权的Solr实例。但是，Xray的检测插件代码本身并没有发现明显的恶意行为，只是一些配置的修改。

**项目地址:** [W2Ning/Solr-SSRF](https://github.com/W2Ning/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #4

**来源**: [CVE-2021-27905-murataydemir_CVE-2021-27905.md](../2021/CVE-2021-27905-murataydemir_CVE-2021-27905.md)

## CVE-2021-27905 Apache Solr ReplicationHandler SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内网探测等

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例开放/replication接口且未配置访问限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905是Apache Solr ReplicationHandler组件中的一个服务器端请求伪造(SSRF)漏洞。攻击者可以通过构造恶意的masterUrl或leaderUrl参数，使Solr服务器向任意URL发起请求。漏洞利用的有效性较高，因为POC代码清晰地展示了如何通过/replication接口和fetchindex命令以及masterUrl参数触发SSRF。首先，攻击者需要通过/solr/admin/cores接口获取Solr core的名称。然后，构造包含恶意URL的请求，例如`GET /solr/{core_name}/replication/?command=fetchindex&masterUrl={ssrf_here}`，发送到目标Solr服务器。服务器会根据攻击者提供的URL发起请求，从而实现SSRF攻击。投毒风险较低，但不能完全排除。虽然提供的POC代码主要是用于SSRF验证，但攻击者可能在其他文件中或在下载的依赖中加入恶意代码，比如监听特定端口、上传敏感信息等。需要人工审核其他的代码文件，以及依赖包来确认是否存在恶意代码，这里给出10%的风险评估是基于该README.md文件本身进行风险评估。

**项目地址:** [murataydemir/CVE-2021-27905](https://github.com/murataydemir/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---

## POC #5

**来源**: [CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md](../2021/CVE-2021-27905-pdelteil_CVE-2021-27905.POC.md)

## CVE-2021-27905 Apache Solr SSRF漏洞

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF (Server-Side Request Forgery)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、甚至远程代码执行（取决于目标内网环境）

**影响版本:** < 8.8.2

**利用条件:** 需要Solr实例开启ReplicationHandler且可被外部访问，并存在可利用的协议（例如 file://, http://等）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905是Apache Solr的一个SSRF漏洞，存在于ReplicationHandler组件中。该组件允许通过`masterUrl`或`leaderUrl`参数指定另一个Solr核心进行索引数据复制。漏洞原因是Solr未对这些参数进行充分的SSRF防护检查，导致攻击者可以控制这些URL，发起服务器端请求。

**有效性评估：**

根据提供的POC代码，该代码通过`traverse.sh`脚本利用`file://`协议读取服务器上的文件。脚本首先构造一个包含`stream.url=file://$START`的请求，发送到Solr的`/replication`端点（或其他配置的ReplicationHandler端点）。然后，脚本解析Solr的响应，根据响应状态码判断是否成功读取文件。如果状态码为0，脚本继续解析响应内容，根据`stream`参数中空格的数量判断是文件内容还是目录列表。如果是目录列表，脚本会递归地调用`callCurl`函数，继续读取子目录下的文件。

**投毒风险评估：**

`traverse.sh`脚本本身的功能是读取文件内容，并没有发现直接执行恶意代码或者篡改数据的行为。但存在以下风险：

1.  **依赖域名变量:** 脚本依赖于变量`DOMAIN`，如果攻击者能控制该变量，可能会导致脚本尝试连接到恶意的Solr服务器，从而受到攻击。
2.  **信息泄露:**  遍历服务器文件系统，可能导致敏感信息（例如配置文件、密钥等）泄露。脚本本身会将文件内容输出到控制台。
3.  **资源消耗:**  递归地读取目录可能导致大量的HTTP请求，消耗服务器资源。

基于以上分析，认为该POC代码存在一定的投毒风险，主要体现在利用方式上可能导致信息泄露和资源消耗，以及通过`DOMAIN`变量引入的潜在风险。但是并没有发现恶意后门代码，因此投毒风险较低，评估为10%。

**利用方式总结：**

1.  **确定目标Solr版本小于8.8.2。**
2.  **找到ReplicationHandler端点。** 默认情况下是`/replication`，但可能被配置为其他值。
3.  **使用`masterUrl`或`leaderUrl`参数，构造包含恶意URL的请求。** 例如`masterUrl=file:///etc/passwd`。
4.  **发送请求到ReplicationHandler端点。**
5.  **如果成功，Solr服务器将尝试读取`/etc/passwd`文件，并将内容包含在响应中。** 攻击者可以分析响应，提取文件内容。
6.  **利用`traverse.sh`脚本可以递归遍历整个文件系统，从而进一步扩大攻击面。**
7.  **利用file协议读取文件内容，或者利用http(s)协议探测内网服务。**

**项目地址:** [pdelteil/CVE-2021-27905.POC](https://github.com/pdelteil/CVE-2021-27905.POC)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)

---



---



---



---



---



---



---



---

