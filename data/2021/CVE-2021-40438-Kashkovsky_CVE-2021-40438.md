## CVE-2021-40438 - Apache HTTP Server SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF

**影响应用:** Apache HTTP Server

**危害等级:** High

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N

**影响版本:** 2.4.48 and earlier

**利用条件:** No authentication required, network access

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 20%

## 详情

CVE-2021-40438是Apache HTTP Server中的一个服务器端请求伪造(SSRF)漏洞。精心构造的请求URI路径可能导致mod_proxy将请求转发到由远程用户选择的源服务器。此漏洞影响Apache HTTP Server 2.4.48及更早版本。

POC代码分析表明，该漏洞允许攻击者通过操纵URI路径，使Apache服务器将请求转发到任意目标服务器。给定的curl命令示例演示了如何通过`unix:`协议指定目标地址，从而实现SSRF。攻击者可以利用此漏洞扫描内部网络、读取内部服务数据或执行未经授权的操作。

利用步骤如下：
1. 准备一个恶意的URI路径，例如`unix:目标地址`。
2. 将此恶意URI路径包含在发送给Apache服务器的HTTP请求中。
3. 确保已启用`mod_proxy`和`mod_proxy_connect`模块。
4. Apache服务器会将请求转发到指定的`unix:`目标地址。

此POC的有效性已通过成功触发请求转发到指定地址进行了验证。通过修改目标地址，可以进一步利用此漏洞来执行各种攻击。

投毒风险分析：
此POC代码主要由curl命令组成，相对清晰易懂。虽然它可以用于发起SSRF攻击，但其本身不包含任何恶意代码或混淆技术。它使用标准的curl命令，没有发现任何可疑行为。由于该POC的简单性以及缺乏任何外部脚本或混淆，因此投毒风险较低。尽管如此，仍需谨慎使用该POC，因为它可以被滥用于恶意目的，例如扫描内部网络或访问敏感数据。为了降低风险，建议对POC代码进行审查，并确保仅在受控环境中进行测试。

考虑到缺乏混淆、外部依赖或可疑行为，该POC的投毒风险估计为20%。

**项目地址:** https://app.netlas.io/responses/?q=cve.name:CVE-2021-40438&page=1

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2021-40438
