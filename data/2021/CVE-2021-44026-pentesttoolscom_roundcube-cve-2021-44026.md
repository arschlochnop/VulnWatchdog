# CVE-2021-44026

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md](../2021/CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md)

# CVE-2021-44026

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md](../2021/CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md)

# CVE-2021-44026

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md](../2021/CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md)

# CVE-2021-44026

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md](../2021/CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md)

# CVE-2021-44026

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md](../2021/CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md)

# CVE-2021-44026

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md](../2021/CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md)

# CVE-2021-44026

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md](../2021/CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md)

# CVE-2021-44026

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md](../2021/CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md)

# CVE-2021-44026

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md](../2021/CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md)

# CVE-2021-44026

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md](../2021/CVE-2021-44026-pentesttoolscom_roundcube-cve-2021-44026.md)

## CVE-2021-44026-Roundcube-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2021-44026

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Roundcube

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 1.3.0 < version < 1.3.17 å’Œ 1.4.0 < version < 1.4.12

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Roundcube Webmailå®ä¾‹ï¼Œä¸”ç›®æ ‡ç”¨æˆ·èƒ½å¤Ÿæ¥æ”¶å¹¶æ‰“å¼€åŒ…å«æ¶æ„payloadçš„é‚®ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2021-44026æ˜¯Roundcube Webmailä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ï¼Œä½äºæœç´¢åŠŸèƒ½æˆ–search_paramså‚æ•°ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œæ³¨å…¥åˆ°æœç´¢å‚æ•°ä¸­ï¼Œä»è€Œæ‰§è¡Œä»»æ„SQLæŸ¥è¯¢ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„POCä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼š
1.  `exploit_chain_xss_sqli.py`ï¼šè¿™æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºå‘é€åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªFlaskæœåŠ¡å™¨ï¼Œç”¨äºæ¥æ”¶ä»ç›®æ ‡Roundcubeå®ä¾‹å¯¼å‡ºçš„æ•°æ®ã€‚
2.  `static/x-fetch-sqli.js`ï¼šè¿™æ˜¯ä¸€ä¸ªJavaScriptæ–‡ä»¶ï¼ŒåŒ…å«åˆ©ç”¨SQLæ³¨å…¥æ¼æ´çš„payloadã€‚è¯¥payloadé¦–å…ˆé€šè¿‡UNION SELECTè¯­å¥ä»sessionè¡¨ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ï¼Œç„¶åé€šè¿‡æœç´¢åŠŸèƒ½è§¦å‘SQLæ³¨å…¥ï¼Œæœ€åå°†å¯¼å‡ºçš„æ•°æ®å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸º:
* æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸”å½±å“äº†ç‰¹å®šçš„Roundcubeç‰ˆæœ¬ã€‚
* æœç´¢ç»“æœä¸­åŒ…å«åˆ©ç”¨æ­¤æ¼æ´çš„å®ä¾‹ï¼Œä»¥åŠç›¸å…³çš„åˆ†ææ–‡ç« ã€‚
* POCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨XSSå’ŒSQLæ³¨å…¥ç»„åˆæ”»å‡»çš„æ–¹æ³•ï¼Œå¯ä»¥æå–æ•æ„Ÿä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åœ¨æä¾›çš„POCä»£ç ä¸­ï¼Œ`x-fetch-sqli.js` æ–‡ä»¶ä¸­å®šä¹‰äº†C2æœåŠ¡å™¨çš„åœ°å€ `let c2 = "http://192.168.1.2:8181"`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ­¤C2æœåŠ¡å™¨ï¼Œæˆ–è€…æ›´æ”¹äº†ä»£ç ä¸­çš„C2æœåŠ¡å™¨åœ°å€ï¼Œåˆ™å¯ä»¥æ”¶é›†æ‰€æœ‰å—å®³è€…çš„æ•æ„Ÿä¿¡æ¯ã€‚åœ¨ `exploit_chain_xss_sqli.py`ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹é‚®ä»¶å†…å®¹ï¼Œè¯±ä½¿ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚

ä½†æ•´ä½“ä»£ç çš„ç›®çš„æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚å› æ­¤ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º **1%** ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **å‘é€æ¶æ„é‚®ä»¶ï¼š** æ”»å‡»è€…é¦–å…ˆä½¿ç”¨`exploit_chain_xss_sqli.py`è„šæœ¬ï¼Œæ„é€ åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶å°†å…¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
2.  **è§¦å‘XSSï¼š** ç›®æ ‡ç”¨æˆ·æ‰“å¼€é‚®ä»¶åï¼ŒXSS payloadä¼šè¢«æ‰§è¡Œï¼Œä»è€ŒåŠ è½½`x-fetch-sqli.js`æ–‡ä»¶ã€‚
3.  **SQLæ³¨å…¥ï¼š** `x-fetch-sqli.js`æ–‡ä»¶åˆ©ç”¨Roundcubeçš„æœç´¢åŠŸèƒ½ï¼Œæ„é€ SQLæ³¨å…¥payloadï¼Œä»æ•°æ®åº“ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ã€‚
4.  **æ•°æ®å¯¼å‡ºï¼š** é€šè¿‡åœ°å€ç°¿å¯¼å‡ºåŠŸèƒ½ï¼Œå†æ¬¡è§¦å‘SQLæ³¨å…¥ï¼Œå°†åŒ…å«SESSIDå’ŒVARSä¿¡æ¯çš„vCardæ–‡ä»¶å¯¼å‡ºã€‚
5.  **æ•°æ®å›ä¼ ï¼š**  å°†å¯¼å‡ºçš„vCardæ–‡ä»¶ä½¿ç”¨base64ç¼–ç åï¼Œå‘é€åˆ°æ”»å‡»è€…çš„C2æœåŠ¡å™¨ã€‚
6.  **è·å–æ•æ„Ÿä¿¡æ¯ï¼š** æ”»å‡»è€…åœ¨C2æœåŠ¡å™¨ä¸Šæ¥æ”¶åˆ°æ•°æ®åï¼Œè¿›è¡Œbase64è§£ç ï¼Œä»è€Œè·å¾—ç›®æ ‡ç”¨æˆ·çš„SESSIDå’ŒVARSä¿¡æ¯ï¼Œè¿›è€Œå¯èƒ½æ§åˆ¶ç›®æ ‡ç”¨æˆ·çš„è´¦æˆ·ã€‚

**é¡¹ç›®åœ°å€:** [skyllpro/CVE-2021-44026-PoC](https://github.com/skyllpro/CVE-2021-44026-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-44026](https://nvd.nist.gov/vuln/detail/CVE-2021-44026)

---

## POC #2

**æ¥æº**: [CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md](../2021/CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md)

## CVE-2021-44026-Roundcube-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2021-44026

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Roundcube

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 1.3.0 < version < 1.3.17 å’Œ 1.4.0 < version < 1.4.12

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Roundcube Webmailå®ä¾‹ï¼Œä¸”ç›®æ ‡ç”¨æˆ·èƒ½å¤Ÿæ¥æ”¶å¹¶æ‰“å¼€åŒ…å«æ¶æ„payloadçš„é‚®ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2021-44026æ˜¯Roundcube Webmailä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ï¼Œä½äºæœç´¢åŠŸèƒ½æˆ–search_paramså‚æ•°ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œæ³¨å…¥åˆ°æœç´¢å‚æ•°ä¸­ï¼Œä»è€Œæ‰§è¡Œä»»æ„SQLæŸ¥è¯¢ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„POCä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼š
1.  `exploit_chain_xss_sqli.py`ï¼šè¿™æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºå‘é€åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªFlaskæœåŠ¡å™¨ï¼Œç”¨äºæ¥æ”¶ä»ç›®æ ‡Roundcubeå®ä¾‹å¯¼å‡ºçš„æ•°æ®ã€‚
2.  `static/x-fetch-sqli.js`ï¼šè¿™æ˜¯ä¸€ä¸ªJavaScriptæ–‡ä»¶ï¼ŒåŒ…å«åˆ©ç”¨SQLæ³¨å…¥æ¼æ´çš„payloadã€‚è¯¥payloadé¦–å…ˆé€šè¿‡UNION SELECTè¯­å¥ä»sessionè¡¨ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ï¼Œç„¶åé€šè¿‡æœç´¢åŠŸèƒ½è§¦å‘SQLæ³¨å…¥ï¼Œæœ€åå°†å¯¼å‡ºçš„æ•°æ®å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸º:
* æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸”å½±å“äº†ç‰¹å®šçš„Roundcubeç‰ˆæœ¬ã€‚
* æœç´¢ç»“æœä¸­åŒ…å«åˆ©ç”¨æ­¤æ¼æ´çš„å®ä¾‹ï¼Œä»¥åŠç›¸å…³çš„åˆ†ææ–‡ç« ã€‚
* POCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨XSSå’ŒSQLæ³¨å…¥ç»„åˆæ”»å‡»çš„æ–¹æ³•ï¼Œå¯ä»¥æå–æ•æ„Ÿä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åœ¨æä¾›çš„POCä»£ç ä¸­ï¼Œ`x-fetch-sqli.js` æ–‡ä»¶ä¸­å®šä¹‰äº†C2æœåŠ¡å™¨çš„åœ°å€ `let c2 = "http://192.168.1.2:8181"`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ­¤C2æœåŠ¡å™¨ï¼Œæˆ–è€…æ›´æ”¹äº†ä»£ç ä¸­çš„C2æœåŠ¡å™¨åœ°å€ï¼Œåˆ™å¯ä»¥æ”¶é›†æ‰€æœ‰å—å®³è€…çš„æ•æ„Ÿä¿¡æ¯ã€‚åœ¨ `exploit_chain_xss_sqli.py`ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹é‚®ä»¶å†…å®¹ï¼Œè¯±ä½¿ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚

ä½†æ•´ä½“ä»£ç çš„ç›®çš„æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚å› æ­¤ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º **1%** ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **å‘é€æ¶æ„é‚®ä»¶ï¼š** æ”»å‡»è€…é¦–å…ˆä½¿ç”¨`exploit_chain_xss_sqli.py`è„šæœ¬ï¼Œæ„é€ åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶å°†å…¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
2.  **è§¦å‘XSSï¼š** ç›®æ ‡ç”¨æˆ·æ‰“å¼€é‚®ä»¶åï¼ŒXSS payloadä¼šè¢«æ‰§è¡Œï¼Œä»è€ŒåŠ è½½`x-fetch-sqli.js`æ–‡ä»¶ã€‚
3.  **SQLæ³¨å…¥ï¼š** `x-fetch-sqli.js`æ–‡ä»¶åˆ©ç”¨Roundcubeçš„æœç´¢åŠŸèƒ½ï¼Œæ„é€ SQLæ³¨å…¥payloadï¼Œä»æ•°æ®åº“ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ã€‚
4.  **æ•°æ®å¯¼å‡ºï¼š** é€šè¿‡åœ°å€ç°¿å¯¼å‡ºåŠŸèƒ½ï¼Œå†æ¬¡è§¦å‘SQLæ³¨å…¥ï¼Œå°†åŒ…å«SESSIDå’ŒVARSä¿¡æ¯çš„vCardæ–‡ä»¶å¯¼å‡ºã€‚
5.  **æ•°æ®å›ä¼ ï¼š**  å°†å¯¼å‡ºçš„vCardæ–‡ä»¶ä½¿ç”¨base64ç¼–ç åï¼Œå‘é€åˆ°æ”»å‡»è€…çš„C2æœåŠ¡å™¨ã€‚
6.  **è·å–æ•æ„Ÿä¿¡æ¯ï¼š** æ”»å‡»è€…åœ¨C2æœåŠ¡å™¨ä¸Šæ¥æ”¶åˆ°æ•°æ®åï¼Œè¿›è¡Œbase64è§£ç ï¼Œä»è€Œè·å¾—ç›®æ ‡ç”¨æˆ·çš„SESSIDå’ŒVARSä¿¡æ¯ï¼Œè¿›è€Œå¯èƒ½æ§åˆ¶ç›®æ ‡ç”¨æˆ·çš„è´¦æˆ·ã€‚

**é¡¹ç›®åœ°å€:** [skyllpro/CVE-2021-44026-PoC](https://github.com/skyllpro/CVE-2021-44026-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-44026](https://nvd.nist.gov/vuln/detail/CVE-2021-44026)

---



---

## POC #2

**æ¥æº**: [CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md](../2021/CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md)

## CVE-2021-44026-Roundcube-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2021-44026

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Roundcube

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 1.3.0 < version < 1.3.17 å’Œ 1.4.0 < version < 1.4.12

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Roundcube Webmailå®ä¾‹ï¼Œä¸”ç›®æ ‡ç”¨æˆ·èƒ½å¤Ÿæ¥æ”¶å¹¶æ‰“å¼€åŒ…å«æ¶æ„payloadçš„é‚®ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2021-44026æ˜¯Roundcube Webmailä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ï¼Œä½äºæœç´¢åŠŸèƒ½æˆ–search_paramså‚æ•°ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œæ³¨å…¥åˆ°æœç´¢å‚æ•°ä¸­ï¼Œä»è€Œæ‰§è¡Œä»»æ„SQLæŸ¥è¯¢ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„POCä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼š
1.  `exploit_chain_xss_sqli.py`ï¼šè¿™æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºå‘é€åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªFlaskæœåŠ¡å™¨ï¼Œç”¨äºæ¥æ”¶ä»ç›®æ ‡Roundcubeå®ä¾‹å¯¼å‡ºçš„æ•°æ®ã€‚
2.  `static/x-fetch-sqli.js`ï¼šè¿™æ˜¯ä¸€ä¸ªJavaScriptæ–‡ä»¶ï¼ŒåŒ…å«åˆ©ç”¨SQLæ³¨å…¥æ¼æ´çš„payloadã€‚è¯¥payloadé¦–å…ˆé€šè¿‡UNION SELECTè¯­å¥ä»sessionè¡¨ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ï¼Œç„¶åé€šè¿‡æœç´¢åŠŸèƒ½è§¦å‘SQLæ³¨å…¥ï¼Œæœ€åå°†å¯¼å‡ºçš„æ•°æ®å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸º:
* æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸”å½±å“äº†ç‰¹å®šçš„Roundcubeç‰ˆæœ¬ã€‚
* æœç´¢ç»“æœä¸­åŒ…å«åˆ©ç”¨æ­¤æ¼æ´çš„å®ä¾‹ï¼Œä»¥åŠç›¸å…³çš„åˆ†ææ–‡ç« ã€‚
* POCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨XSSå’ŒSQLæ³¨å…¥ç»„åˆæ”»å‡»çš„æ–¹æ³•ï¼Œå¯ä»¥æå–æ•æ„Ÿä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åœ¨æä¾›çš„POCä»£ç ä¸­ï¼Œ`x-fetch-sqli.js` æ–‡ä»¶ä¸­å®šä¹‰äº†C2æœåŠ¡å™¨çš„åœ°å€ `let c2 = "http://192.168.1.2:8181"`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ­¤C2æœåŠ¡å™¨ï¼Œæˆ–è€…æ›´æ”¹äº†ä»£ç ä¸­çš„C2æœåŠ¡å™¨åœ°å€ï¼Œåˆ™å¯ä»¥æ”¶é›†æ‰€æœ‰å—å®³è€…çš„æ•æ„Ÿä¿¡æ¯ã€‚åœ¨ `exploit_chain_xss_sqli.py`ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹é‚®ä»¶å†…å®¹ï¼Œè¯±ä½¿ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚

ä½†æ•´ä½“ä»£ç çš„ç›®çš„æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚å› æ­¤ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º **1%** ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **å‘é€æ¶æ„é‚®ä»¶ï¼š** æ”»å‡»è€…é¦–å…ˆä½¿ç”¨`exploit_chain_xss_sqli.py`è„šæœ¬ï¼Œæ„é€ åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶å°†å…¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
2.  **è§¦å‘XSSï¼š** ç›®æ ‡ç”¨æˆ·æ‰“å¼€é‚®ä»¶åï¼ŒXSS payloadä¼šè¢«æ‰§è¡Œï¼Œä»è€ŒåŠ è½½`x-fetch-sqli.js`æ–‡ä»¶ã€‚
3.  **SQLæ³¨å…¥ï¼š** `x-fetch-sqli.js`æ–‡ä»¶åˆ©ç”¨Roundcubeçš„æœç´¢åŠŸèƒ½ï¼Œæ„é€ SQLæ³¨å…¥payloadï¼Œä»æ•°æ®åº“ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ã€‚
4.  **æ•°æ®å¯¼å‡ºï¼š** é€šè¿‡åœ°å€ç°¿å¯¼å‡ºåŠŸèƒ½ï¼Œå†æ¬¡è§¦å‘SQLæ³¨å…¥ï¼Œå°†åŒ…å«SESSIDå’ŒVARSä¿¡æ¯çš„vCardæ–‡ä»¶å¯¼å‡ºã€‚
5.  **æ•°æ®å›ä¼ ï¼š**  å°†å¯¼å‡ºçš„vCardæ–‡ä»¶ä½¿ç”¨base64ç¼–ç åï¼Œå‘é€åˆ°æ”»å‡»è€…çš„C2æœåŠ¡å™¨ã€‚
6.  **è·å–æ•æ„Ÿä¿¡æ¯ï¼š** æ”»å‡»è€…åœ¨C2æœåŠ¡å™¨ä¸Šæ¥æ”¶åˆ°æ•°æ®åï¼Œè¿›è¡Œbase64è§£ç ï¼Œä»è€Œè·å¾—ç›®æ ‡ç”¨æˆ·çš„SESSIDå’ŒVARSä¿¡æ¯ï¼Œè¿›è€Œå¯èƒ½æ§åˆ¶ç›®æ ‡ç”¨æˆ·çš„è´¦æˆ·ã€‚

**é¡¹ç›®åœ°å€:** [skyllpro/CVE-2021-44026-PoC](https://github.com/skyllpro/CVE-2021-44026-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-44026](https://nvd.nist.gov/vuln/detail/CVE-2021-44026)

---



---

## POC #2

**æ¥æº**: [CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md](../2021/CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md)

## CVE-2021-44026-Roundcube-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2021-44026

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Roundcube

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 1.3.0 < version < 1.3.17 å’Œ 1.4.0 < version < 1.4.12

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Roundcube Webmailå®ä¾‹ï¼Œä¸”ç›®æ ‡ç”¨æˆ·èƒ½å¤Ÿæ¥æ”¶å¹¶æ‰“å¼€åŒ…å«æ¶æ„payloadçš„é‚®ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2021-44026æ˜¯Roundcube Webmailä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ï¼Œä½äºæœç´¢åŠŸèƒ½æˆ–search_paramså‚æ•°ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œæ³¨å…¥åˆ°æœç´¢å‚æ•°ä¸­ï¼Œä»è€Œæ‰§è¡Œä»»æ„SQLæŸ¥è¯¢ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„POCä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼š
1.  `exploit_chain_xss_sqli.py`ï¼šè¿™æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºå‘é€åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªFlaskæœåŠ¡å™¨ï¼Œç”¨äºæ¥æ”¶ä»ç›®æ ‡Roundcubeå®ä¾‹å¯¼å‡ºçš„æ•°æ®ã€‚
2.  `static/x-fetch-sqli.js`ï¼šè¿™æ˜¯ä¸€ä¸ªJavaScriptæ–‡ä»¶ï¼ŒåŒ…å«åˆ©ç”¨SQLæ³¨å…¥æ¼æ´çš„payloadã€‚è¯¥payloadé¦–å…ˆé€šè¿‡UNION SELECTè¯­å¥ä»sessionè¡¨ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ï¼Œç„¶åé€šè¿‡æœç´¢åŠŸèƒ½è§¦å‘SQLæ³¨å…¥ï¼Œæœ€åå°†å¯¼å‡ºçš„æ•°æ®å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸º:
* æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸”å½±å“äº†ç‰¹å®šçš„Roundcubeç‰ˆæœ¬ã€‚
* æœç´¢ç»“æœä¸­åŒ…å«åˆ©ç”¨æ­¤æ¼æ´çš„å®ä¾‹ï¼Œä»¥åŠç›¸å…³çš„åˆ†ææ–‡ç« ã€‚
* POCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨XSSå’ŒSQLæ³¨å…¥ç»„åˆæ”»å‡»çš„æ–¹æ³•ï¼Œå¯ä»¥æå–æ•æ„Ÿä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åœ¨æä¾›çš„POCä»£ç ä¸­ï¼Œ`x-fetch-sqli.js` æ–‡ä»¶ä¸­å®šä¹‰äº†C2æœåŠ¡å™¨çš„åœ°å€ `let c2 = "http://192.168.1.2:8181"`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ­¤C2æœåŠ¡å™¨ï¼Œæˆ–è€…æ›´æ”¹äº†ä»£ç ä¸­çš„C2æœåŠ¡å™¨åœ°å€ï¼Œåˆ™å¯ä»¥æ”¶é›†æ‰€æœ‰å—å®³è€…çš„æ•æ„Ÿä¿¡æ¯ã€‚åœ¨ `exploit_chain_xss_sqli.py`ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹é‚®ä»¶å†…å®¹ï¼Œè¯±ä½¿ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚

ä½†æ•´ä½“ä»£ç çš„ç›®çš„æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚å› æ­¤ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º **1%** ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **å‘é€æ¶æ„é‚®ä»¶ï¼š** æ”»å‡»è€…é¦–å…ˆä½¿ç”¨`exploit_chain_xss_sqli.py`è„šæœ¬ï¼Œæ„é€ åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶å°†å…¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
2.  **è§¦å‘XSSï¼š** ç›®æ ‡ç”¨æˆ·æ‰“å¼€é‚®ä»¶åï¼ŒXSS payloadä¼šè¢«æ‰§è¡Œï¼Œä»è€ŒåŠ è½½`x-fetch-sqli.js`æ–‡ä»¶ã€‚
3.  **SQLæ³¨å…¥ï¼š** `x-fetch-sqli.js`æ–‡ä»¶åˆ©ç”¨Roundcubeçš„æœç´¢åŠŸèƒ½ï¼Œæ„é€ SQLæ³¨å…¥payloadï¼Œä»æ•°æ®åº“ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ã€‚
4.  **æ•°æ®å¯¼å‡ºï¼š** é€šè¿‡åœ°å€ç°¿å¯¼å‡ºåŠŸèƒ½ï¼Œå†æ¬¡è§¦å‘SQLæ³¨å…¥ï¼Œå°†åŒ…å«SESSIDå’ŒVARSä¿¡æ¯çš„vCardæ–‡ä»¶å¯¼å‡ºã€‚
5.  **æ•°æ®å›ä¼ ï¼š**  å°†å¯¼å‡ºçš„vCardæ–‡ä»¶ä½¿ç”¨base64ç¼–ç åï¼Œå‘é€åˆ°æ”»å‡»è€…çš„C2æœåŠ¡å™¨ã€‚
6.  **è·å–æ•æ„Ÿä¿¡æ¯ï¼š** æ”»å‡»è€…åœ¨C2æœåŠ¡å™¨ä¸Šæ¥æ”¶åˆ°æ•°æ®åï¼Œè¿›è¡Œbase64è§£ç ï¼Œä»è€Œè·å¾—ç›®æ ‡ç”¨æˆ·çš„SESSIDå’ŒVARSä¿¡æ¯ï¼Œè¿›è€Œå¯èƒ½æ§åˆ¶ç›®æ ‡ç”¨æˆ·çš„è´¦æˆ·ã€‚

**é¡¹ç›®åœ°å€:** [skyllpro/CVE-2021-44026-PoC](https://github.com/skyllpro/CVE-2021-44026-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-44026](https://nvd.nist.gov/vuln/detail/CVE-2021-44026)

---



---

## POC #2

**æ¥æº**: [CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md](../2021/CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md)

## CVE-2021-44026-Roundcube-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2021-44026

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Roundcube

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 1.3.0 < version < 1.3.17 å’Œ 1.4.0 < version < 1.4.12

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Roundcube Webmailå®ä¾‹ï¼Œä¸”ç›®æ ‡ç”¨æˆ·èƒ½å¤Ÿæ¥æ”¶å¹¶æ‰“å¼€åŒ…å«æ¶æ„payloadçš„é‚®ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2021-44026æ˜¯Roundcube Webmailä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ï¼Œä½äºæœç´¢åŠŸèƒ½æˆ–search_paramså‚æ•°ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œæ³¨å…¥åˆ°æœç´¢å‚æ•°ä¸­ï¼Œä»è€Œæ‰§è¡Œä»»æ„SQLæŸ¥è¯¢ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„POCä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼š
1.  `exploit_chain_xss_sqli.py`ï¼šè¿™æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºå‘é€åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªFlaskæœåŠ¡å™¨ï¼Œç”¨äºæ¥æ”¶ä»ç›®æ ‡Roundcubeå®ä¾‹å¯¼å‡ºçš„æ•°æ®ã€‚
2.  `static/x-fetch-sqli.js`ï¼šè¿™æ˜¯ä¸€ä¸ªJavaScriptæ–‡ä»¶ï¼ŒåŒ…å«åˆ©ç”¨SQLæ³¨å…¥æ¼æ´çš„payloadã€‚è¯¥payloadé¦–å…ˆé€šè¿‡UNION SELECTè¯­å¥ä»sessionè¡¨ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ï¼Œç„¶åé€šè¿‡æœç´¢åŠŸèƒ½è§¦å‘SQLæ³¨å…¥ï¼Œæœ€åå°†å¯¼å‡ºçš„æ•°æ®å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸º:
* æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸”å½±å“äº†ç‰¹å®šçš„Roundcubeç‰ˆæœ¬ã€‚
* æœç´¢ç»“æœä¸­åŒ…å«åˆ©ç”¨æ­¤æ¼æ´çš„å®ä¾‹ï¼Œä»¥åŠç›¸å…³çš„åˆ†ææ–‡ç« ã€‚
* POCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨XSSå’ŒSQLæ³¨å…¥ç»„åˆæ”»å‡»çš„æ–¹æ³•ï¼Œå¯ä»¥æå–æ•æ„Ÿä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åœ¨æä¾›çš„POCä»£ç ä¸­ï¼Œ`x-fetch-sqli.js` æ–‡ä»¶ä¸­å®šä¹‰äº†C2æœåŠ¡å™¨çš„åœ°å€ `let c2 = "http://192.168.1.2:8181"`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ­¤C2æœåŠ¡å™¨ï¼Œæˆ–è€…æ›´æ”¹äº†ä»£ç ä¸­çš„C2æœåŠ¡å™¨åœ°å€ï¼Œåˆ™å¯ä»¥æ”¶é›†æ‰€æœ‰å—å®³è€…çš„æ•æ„Ÿä¿¡æ¯ã€‚åœ¨ `exploit_chain_xss_sqli.py`ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹é‚®ä»¶å†…å®¹ï¼Œè¯±ä½¿ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚

ä½†æ•´ä½“ä»£ç çš„ç›®çš„æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚å› æ­¤ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º **1%** ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **å‘é€æ¶æ„é‚®ä»¶ï¼š** æ”»å‡»è€…é¦–å…ˆä½¿ç”¨`exploit_chain_xss_sqli.py`è„šæœ¬ï¼Œæ„é€ åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶å°†å…¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
2.  **è§¦å‘XSSï¼š** ç›®æ ‡ç”¨æˆ·æ‰“å¼€é‚®ä»¶åï¼ŒXSS payloadä¼šè¢«æ‰§è¡Œï¼Œä»è€ŒåŠ è½½`x-fetch-sqli.js`æ–‡ä»¶ã€‚
3.  **SQLæ³¨å…¥ï¼š** `x-fetch-sqli.js`æ–‡ä»¶åˆ©ç”¨Roundcubeçš„æœç´¢åŠŸèƒ½ï¼Œæ„é€ SQLæ³¨å…¥payloadï¼Œä»æ•°æ®åº“ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ã€‚
4.  **æ•°æ®å¯¼å‡ºï¼š** é€šè¿‡åœ°å€ç°¿å¯¼å‡ºåŠŸèƒ½ï¼Œå†æ¬¡è§¦å‘SQLæ³¨å…¥ï¼Œå°†åŒ…å«SESSIDå’ŒVARSä¿¡æ¯çš„vCardæ–‡ä»¶å¯¼å‡ºã€‚
5.  **æ•°æ®å›ä¼ ï¼š**  å°†å¯¼å‡ºçš„vCardæ–‡ä»¶ä½¿ç”¨base64ç¼–ç åï¼Œå‘é€åˆ°æ”»å‡»è€…çš„C2æœåŠ¡å™¨ã€‚
6.  **è·å–æ•æ„Ÿä¿¡æ¯ï¼š** æ”»å‡»è€…åœ¨C2æœåŠ¡å™¨ä¸Šæ¥æ”¶åˆ°æ•°æ®åï¼Œè¿›è¡Œbase64è§£ç ï¼Œä»è€Œè·å¾—ç›®æ ‡ç”¨æˆ·çš„SESSIDå’ŒVARSä¿¡æ¯ï¼Œè¿›è€Œå¯èƒ½æ§åˆ¶ç›®æ ‡ç”¨æˆ·çš„è´¦æˆ·ã€‚

**é¡¹ç›®åœ°å€:** [skyllpro/CVE-2021-44026-PoC](https://github.com/skyllpro/CVE-2021-44026-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-44026](https://nvd.nist.gov/vuln/detail/CVE-2021-44026)

---



---

## POC #2

**æ¥æº**: [CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md](../2021/CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md)

## CVE-2021-44026-Roundcube-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2021-44026

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Roundcube

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 1.3.0 < version < 1.3.17 å’Œ 1.4.0 < version < 1.4.12

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Roundcube Webmailå®ä¾‹ï¼Œä¸”ç›®æ ‡ç”¨æˆ·èƒ½å¤Ÿæ¥æ”¶å¹¶æ‰“å¼€åŒ…å«æ¶æ„payloadçš„é‚®ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2021-44026æ˜¯Roundcube Webmailä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ï¼Œä½äºæœç´¢åŠŸèƒ½æˆ–search_paramså‚æ•°ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œæ³¨å…¥åˆ°æœç´¢å‚æ•°ä¸­ï¼Œä»è€Œæ‰§è¡Œä»»æ„SQLæŸ¥è¯¢ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„POCä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼š
1.  `exploit_chain_xss_sqli.py`ï¼šè¿™æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºå‘é€åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªFlaskæœåŠ¡å™¨ï¼Œç”¨äºæ¥æ”¶ä»ç›®æ ‡Roundcubeå®ä¾‹å¯¼å‡ºçš„æ•°æ®ã€‚
2.  `static/x-fetch-sqli.js`ï¼šè¿™æ˜¯ä¸€ä¸ªJavaScriptæ–‡ä»¶ï¼ŒåŒ…å«åˆ©ç”¨SQLæ³¨å…¥æ¼æ´çš„payloadã€‚è¯¥payloadé¦–å…ˆé€šè¿‡UNION SELECTè¯­å¥ä»sessionè¡¨ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ï¼Œç„¶åé€šè¿‡æœç´¢åŠŸèƒ½è§¦å‘SQLæ³¨å…¥ï¼Œæœ€åå°†å¯¼å‡ºçš„æ•°æ®å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸º:
* æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸”å½±å“äº†ç‰¹å®šçš„Roundcubeç‰ˆæœ¬ã€‚
* æœç´¢ç»“æœä¸­åŒ…å«åˆ©ç”¨æ­¤æ¼æ´çš„å®ä¾‹ï¼Œä»¥åŠç›¸å…³çš„åˆ†ææ–‡ç« ã€‚
* POCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨XSSå’ŒSQLæ³¨å…¥ç»„åˆæ”»å‡»çš„æ–¹æ³•ï¼Œå¯ä»¥æå–æ•æ„Ÿä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åœ¨æä¾›çš„POCä»£ç ä¸­ï¼Œ`x-fetch-sqli.js` æ–‡ä»¶ä¸­å®šä¹‰äº†C2æœåŠ¡å™¨çš„åœ°å€ `let c2 = "http://192.168.1.2:8181"`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ­¤C2æœåŠ¡å™¨ï¼Œæˆ–è€…æ›´æ”¹äº†ä»£ç ä¸­çš„C2æœåŠ¡å™¨åœ°å€ï¼Œåˆ™å¯ä»¥æ”¶é›†æ‰€æœ‰å—å®³è€…çš„æ•æ„Ÿä¿¡æ¯ã€‚åœ¨ `exploit_chain_xss_sqli.py`ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹é‚®ä»¶å†…å®¹ï¼Œè¯±ä½¿ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚

ä½†æ•´ä½“ä»£ç çš„ç›®çš„æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚å› æ­¤ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º **1%** ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **å‘é€æ¶æ„é‚®ä»¶ï¼š** æ”»å‡»è€…é¦–å…ˆä½¿ç”¨`exploit_chain_xss_sqli.py`è„šæœ¬ï¼Œæ„é€ åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶å°†å…¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
2.  **è§¦å‘XSSï¼š** ç›®æ ‡ç”¨æˆ·æ‰“å¼€é‚®ä»¶åï¼ŒXSS payloadä¼šè¢«æ‰§è¡Œï¼Œä»è€ŒåŠ è½½`x-fetch-sqli.js`æ–‡ä»¶ã€‚
3.  **SQLæ³¨å…¥ï¼š** `x-fetch-sqli.js`æ–‡ä»¶åˆ©ç”¨Roundcubeçš„æœç´¢åŠŸèƒ½ï¼Œæ„é€ SQLæ³¨å…¥payloadï¼Œä»æ•°æ®åº“ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ã€‚
4.  **æ•°æ®å¯¼å‡ºï¼š** é€šè¿‡åœ°å€ç°¿å¯¼å‡ºåŠŸèƒ½ï¼Œå†æ¬¡è§¦å‘SQLæ³¨å…¥ï¼Œå°†åŒ…å«SESSIDå’ŒVARSä¿¡æ¯çš„vCardæ–‡ä»¶å¯¼å‡ºã€‚
5.  **æ•°æ®å›ä¼ ï¼š**  å°†å¯¼å‡ºçš„vCardæ–‡ä»¶ä½¿ç”¨base64ç¼–ç åï¼Œå‘é€åˆ°æ”»å‡»è€…çš„C2æœåŠ¡å™¨ã€‚
6.  **è·å–æ•æ„Ÿä¿¡æ¯ï¼š** æ”»å‡»è€…åœ¨C2æœåŠ¡å™¨ä¸Šæ¥æ”¶åˆ°æ•°æ®åï¼Œè¿›è¡Œbase64è§£ç ï¼Œä»è€Œè·å¾—ç›®æ ‡ç”¨æˆ·çš„SESSIDå’ŒVARSä¿¡æ¯ï¼Œè¿›è€Œå¯èƒ½æ§åˆ¶ç›®æ ‡ç”¨æˆ·çš„è´¦æˆ·ã€‚

**é¡¹ç›®åœ°å€:** [skyllpro/CVE-2021-44026-PoC](https://github.com/skyllpro/CVE-2021-44026-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-44026](https://nvd.nist.gov/vuln/detail/CVE-2021-44026)

---



---

## POC #2

**æ¥æº**: [CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md](../2021/CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md)

## CVE-2021-44026-Roundcube-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2021-44026

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Roundcube

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 1.3.0 < version < 1.3.17 å’Œ 1.4.0 < version < 1.4.12

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Roundcube Webmailå®ä¾‹ï¼Œä¸”ç›®æ ‡ç”¨æˆ·èƒ½å¤Ÿæ¥æ”¶å¹¶æ‰“å¼€åŒ…å«æ¶æ„payloadçš„é‚®ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2021-44026æ˜¯Roundcube Webmailä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ï¼Œä½äºæœç´¢åŠŸèƒ½æˆ–search_paramså‚æ•°ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œæ³¨å…¥åˆ°æœç´¢å‚æ•°ä¸­ï¼Œä»è€Œæ‰§è¡Œä»»æ„SQLæŸ¥è¯¢ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„POCä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼š
1.  `exploit_chain_xss_sqli.py`ï¼šè¿™æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºå‘é€åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªFlaskæœåŠ¡å™¨ï¼Œç”¨äºæ¥æ”¶ä»ç›®æ ‡Roundcubeå®ä¾‹å¯¼å‡ºçš„æ•°æ®ã€‚
2.  `static/x-fetch-sqli.js`ï¼šè¿™æ˜¯ä¸€ä¸ªJavaScriptæ–‡ä»¶ï¼ŒåŒ…å«åˆ©ç”¨SQLæ³¨å…¥æ¼æ´çš„payloadã€‚è¯¥payloadé¦–å…ˆé€šè¿‡UNION SELECTè¯­å¥ä»sessionè¡¨ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ï¼Œç„¶åé€šè¿‡æœç´¢åŠŸèƒ½è§¦å‘SQLæ³¨å…¥ï¼Œæœ€åå°†å¯¼å‡ºçš„æ•°æ®å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸º:
* æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸”å½±å“äº†ç‰¹å®šçš„Roundcubeç‰ˆæœ¬ã€‚
* æœç´¢ç»“æœä¸­åŒ…å«åˆ©ç”¨æ­¤æ¼æ´çš„å®ä¾‹ï¼Œä»¥åŠç›¸å…³çš„åˆ†ææ–‡ç« ã€‚
* POCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨XSSå’ŒSQLæ³¨å…¥ç»„åˆæ”»å‡»çš„æ–¹æ³•ï¼Œå¯ä»¥æå–æ•æ„Ÿä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åœ¨æä¾›çš„POCä»£ç ä¸­ï¼Œ`x-fetch-sqli.js` æ–‡ä»¶ä¸­å®šä¹‰äº†C2æœåŠ¡å™¨çš„åœ°å€ `let c2 = "http://192.168.1.2:8181"`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ­¤C2æœåŠ¡å™¨ï¼Œæˆ–è€…æ›´æ”¹äº†ä»£ç ä¸­çš„C2æœåŠ¡å™¨åœ°å€ï¼Œåˆ™å¯ä»¥æ”¶é›†æ‰€æœ‰å—å®³è€…çš„æ•æ„Ÿä¿¡æ¯ã€‚åœ¨ `exploit_chain_xss_sqli.py`ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹é‚®ä»¶å†…å®¹ï¼Œè¯±ä½¿ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚

ä½†æ•´ä½“ä»£ç çš„ç›®çš„æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚å› æ­¤ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º **1%** ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **å‘é€æ¶æ„é‚®ä»¶ï¼š** æ”»å‡»è€…é¦–å…ˆä½¿ç”¨`exploit_chain_xss_sqli.py`è„šæœ¬ï¼Œæ„é€ åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶å°†å…¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
2.  **è§¦å‘XSSï¼š** ç›®æ ‡ç”¨æˆ·æ‰“å¼€é‚®ä»¶åï¼ŒXSS payloadä¼šè¢«æ‰§è¡Œï¼Œä»è€ŒåŠ è½½`x-fetch-sqli.js`æ–‡ä»¶ã€‚
3.  **SQLæ³¨å…¥ï¼š** `x-fetch-sqli.js`æ–‡ä»¶åˆ©ç”¨Roundcubeçš„æœç´¢åŠŸèƒ½ï¼Œæ„é€ SQLæ³¨å…¥payloadï¼Œä»æ•°æ®åº“ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ã€‚
4.  **æ•°æ®å¯¼å‡ºï¼š** é€šè¿‡åœ°å€ç°¿å¯¼å‡ºåŠŸèƒ½ï¼Œå†æ¬¡è§¦å‘SQLæ³¨å…¥ï¼Œå°†åŒ…å«SESSIDå’ŒVARSä¿¡æ¯çš„vCardæ–‡ä»¶å¯¼å‡ºã€‚
5.  **æ•°æ®å›ä¼ ï¼š**  å°†å¯¼å‡ºçš„vCardæ–‡ä»¶ä½¿ç”¨base64ç¼–ç åï¼Œå‘é€åˆ°æ”»å‡»è€…çš„C2æœåŠ¡å™¨ã€‚
6.  **è·å–æ•æ„Ÿä¿¡æ¯ï¼š** æ”»å‡»è€…åœ¨C2æœåŠ¡å™¨ä¸Šæ¥æ”¶åˆ°æ•°æ®åï¼Œè¿›è¡Œbase64è§£ç ï¼Œä»è€Œè·å¾—ç›®æ ‡ç”¨æˆ·çš„SESSIDå’ŒVARSä¿¡æ¯ï¼Œè¿›è€Œå¯èƒ½æ§åˆ¶ç›®æ ‡ç”¨æˆ·çš„è´¦æˆ·ã€‚

**é¡¹ç›®åœ°å€:** [skyllpro/CVE-2021-44026-PoC](https://github.com/skyllpro/CVE-2021-44026-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-44026](https://nvd.nist.gov/vuln/detail/CVE-2021-44026)

---



---

## POC #2

**æ¥æº**: [CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md](../2021/CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md)

## CVE-2021-44026-Roundcube-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2021-44026

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Roundcube

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 1.3.0 < version < 1.3.17 å’Œ 1.4.0 < version < 1.4.12

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Roundcube Webmailå®ä¾‹ï¼Œä¸”ç›®æ ‡ç”¨æˆ·èƒ½å¤Ÿæ¥æ”¶å¹¶æ‰“å¼€åŒ…å«æ¶æ„payloadçš„é‚®ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2021-44026æ˜¯Roundcube Webmailä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ï¼Œä½äºæœç´¢åŠŸèƒ½æˆ–search_paramså‚æ•°ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œæ³¨å…¥åˆ°æœç´¢å‚æ•°ä¸­ï¼Œä»è€Œæ‰§è¡Œä»»æ„SQLæŸ¥è¯¢ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„POCä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼š
1.  `exploit_chain_xss_sqli.py`ï¼šè¿™æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºå‘é€åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªFlaskæœåŠ¡å™¨ï¼Œç”¨äºæ¥æ”¶ä»ç›®æ ‡Roundcubeå®ä¾‹å¯¼å‡ºçš„æ•°æ®ã€‚
2.  `static/x-fetch-sqli.js`ï¼šè¿™æ˜¯ä¸€ä¸ªJavaScriptæ–‡ä»¶ï¼ŒåŒ…å«åˆ©ç”¨SQLæ³¨å…¥æ¼æ´çš„payloadã€‚è¯¥payloadé¦–å…ˆé€šè¿‡UNION SELECTè¯­å¥ä»sessionè¡¨ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ï¼Œç„¶åé€šè¿‡æœç´¢åŠŸèƒ½è§¦å‘SQLæ³¨å…¥ï¼Œæœ€åå°†å¯¼å‡ºçš„æ•°æ®å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸º:
* æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸”å½±å“äº†ç‰¹å®šçš„Roundcubeç‰ˆæœ¬ã€‚
* æœç´¢ç»“æœä¸­åŒ…å«åˆ©ç”¨æ­¤æ¼æ´çš„å®ä¾‹ï¼Œä»¥åŠç›¸å…³çš„åˆ†ææ–‡ç« ã€‚
* POCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨XSSå’ŒSQLæ³¨å…¥ç»„åˆæ”»å‡»çš„æ–¹æ³•ï¼Œå¯ä»¥æå–æ•æ„Ÿä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åœ¨æä¾›çš„POCä»£ç ä¸­ï¼Œ`x-fetch-sqli.js` æ–‡ä»¶ä¸­å®šä¹‰äº†C2æœåŠ¡å™¨çš„åœ°å€ `let c2 = "http://192.168.1.2:8181"`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ­¤C2æœåŠ¡å™¨ï¼Œæˆ–è€…æ›´æ”¹äº†ä»£ç ä¸­çš„C2æœåŠ¡å™¨åœ°å€ï¼Œåˆ™å¯ä»¥æ”¶é›†æ‰€æœ‰å—å®³è€…çš„æ•æ„Ÿä¿¡æ¯ã€‚åœ¨ `exploit_chain_xss_sqli.py`ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹é‚®ä»¶å†…å®¹ï¼Œè¯±ä½¿ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚

ä½†æ•´ä½“ä»£ç çš„ç›®çš„æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚å› æ­¤ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º **1%** ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **å‘é€æ¶æ„é‚®ä»¶ï¼š** æ”»å‡»è€…é¦–å…ˆä½¿ç”¨`exploit_chain_xss_sqli.py`è„šæœ¬ï¼Œæ„é€ åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶å°†å…¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
2.  **è§¦å‘XSSï¼š** ç›®æ ‡ç”¨æˆ·æ‰“å¼€é‚®ä»¶åï¼ŒXSS payloadä¼šè¢«æ‰§è¡Œï¼Œä»è€ŒåŠ è½½`x-fetch-sqli.js`æ–‡ä»¶ã€‚
3.  **SQLæ³¨å…¥ï¼š** `x-fetch-sqli.js`æ–‡ä»¶åˆ©ç”¨Roundcubeçš„æœç´¢åŠŸèƒ½ï¼Œæ„é€ SQLæ³¨å…¥payloadï¼Œä»æ•°æ®åº“ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ã€‚
4.  **æ•°æ®å¯¼å‡ºï¼š** é€šè¿‡åœ°å€ç°¿å¯¼å‡ºåŠŸèƒ½ï¼Œå†æ¬¡è§¦å‘SQLæ³¨å…¥ï¼Œå°†åŒ…å«SESSIDå’ŒVARSä¿¡æ¯çš„vCardæ–‡ä»¶å¯¼å‡ºã€‚
5.  **æ•°æ®å›ä¼ ï¼š**  å°†å¯¼å‡ºçš„vCardæ–‡ä»¶ä½¿ç”¨base64ç¼–ç åï¼Œå‘é€åˆ°æ”»å‡»è€…çš„C2æœåŠ¡å™¨ã€‚
6.  **è·å–æ•æ„Ÿä¿¡æ¯ï¼š** æ”»å‡»è€…åœ¨C2æœåŠ¡å™¨ä¸Šæ¥æ”¶åˆ°æ•°æ®åï¼Œè¿›è¡Œbase64è§£ç ï¼Œä»è€Œè·å¾—ç›®æ ‡ç”¨æˆ·çš„SESSIDå’ŒVARSä¿¡æ¯ï¼Œè¿›è€Œå¯èƒ½æ§åˆ¶ç›®æ ‡ç”¨æˆ·çš„è´¦æˆ·ã€‚

**é¡¹ç›®åœ°å€:** [skyllpro/CVE-2021-44026-PoC](https://github.com/skyllpro/CVE-2021-44026-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-44026](https://nvd.nist.gov/vuln/detail/CVE-2021-44026)

---



---

## POC #2

**æ¥æº**: [CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md](../2021/CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md)

## CVE-2021-44026-Roundcube-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2021-44026

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Roundcube

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 1.3.0 < version < 1.3.17 å’Œ 1.4.0 < version < 1.4.12

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Roundcube Webmailå®ä¾‹ï¼Œä¸”ç›®æ ‡ç”¨æˆ·èƒ½å¤Ÿæ¥æ”¶å¹¶æ‰“å¼€åŒ…å«æ¶æ„payloadçš„é‚®ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2021-44026æ˜¯Roundcube Webmailä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ï¼Œä½äºæœç´¢åŠŸèƒ½æˆ–search_paramså‚æ•°ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œæ³¨å…¥åˆ°æœç´¢å‚æ•°ä¸­ï¼Œä»è€Œæ‰§è¡Œä»»æ„SQLæŸ¥è¯¢ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„POCä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼š
1.  `exploit_chain_xss_sqli.py`ï¼šè¿™æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºå‘é€åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªFlaskæœåŠ¡å™¨ï¼Œç”¨äºæ¥æ”¶ä»ç›®æ ‡Roundcubeå®ä¾‹å¯¼å‡ºçš„æ•°æ®ã€‚
2.  `static/x-fetch-sqli.js`ï¼šè¿™æ˜¯ä¸€ä¸ªJavaScriptæ–‡ä»¶ï¼ŒåŒ…å«åˆ©ç”¨SQLæ³¨å…¥æ¼æ´çš„payloadã€‚è¯¥payloadé¦–å…ˆé€šè¿‡UNION SELECTè¯­å¥ä»sessionè¡¨ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ï¼Œç„¶åé€šè¿‡æœç´¢åŠŸèƒ½è§¦å‘SQLæ³¨å…¥ï¼Œæœ€åå°†å¯¼å‡ºçš„æ•°æ®å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸º:
* æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸”å½±å“äº†ç‰¹å®šçš„Roundcubeç‰ˆæœ¬ã€‚
* æœç´¢ç»“æœä¸­åŒ…å«åˆ©ç”¨æ­¤æ¼æ´çš„å®ä¾‹ï¼Œä»¥åŠç›¸å…³çš„åˆ†ææ–‡ç« ã€‚
* POCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨XSSå’ŒSQLæ³¨å…¥ç»„åˆæ”»å‡»çš„æ–¹æ³•ï¼Œå¯ä»¥æå–æ•æ„Ÿä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åœ¨æä¾›çš„POCä»£ç ä¸­ï¼Œ`x-fetch-sqli.js` æ–‡ä»¶ä¸­å®šä¹‰äº†C2æœåŠ¡å™¨çš„åœ°å€ `let c2 = "http://192.168.1.2:8181"`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ­¤C2æœåŠ¡å™¨ï¼Œæˆ–è€…æ›´æ”¹äº†ä»£ç ä¸­çš„C2æœåŠ¡å™¨åœ°å€ï¼Œåˆ™å¯ä»¥æ”¶é›†æ‰€æœ‰å—å®³è€…çš„æ•æ„Ÿä¿¡æ¯ã€‚åœ¨ `exploit_chain_xss_sqli.py`ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹é‚®ä»¶å†…å®¹ï¼Œè¯±ä½¿ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚

ä½†æ•´ä½“ä»£ç çš„ç›®çš„æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚å› æ­¤ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º **1%** ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **å‘é€æ¶æ„é‚®ä»¶ï¼š** æ”»å‡»è€…é¦–å…ˆä½¿ç”¨`exploit_chain_xss_sqli.py`è„šæœ¬ï¼Œæ„é€ åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶å°†å…¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
2.  **è§¦å‘XSSï¼š** ç›®æ ‡ç”¨æˆ·æ‰“å¼€é‚®ä»¶åï¼ŒXSS payloadä¼šè¢«æ‰§è¡Œï¼Œä»è€ŒåŠ è½½`x-fetch-sqli.js`æ–‡ä»¶ã€‚
3.  **SQLæ³¨å…¥ï¼š** `x-fetch-sqli.js`æ–‡ä»¶åˆ©ç”¨Roundcubeçš„æœç´¢åŠŸèƒ½ï¼Œæ„é€ SQLæ³¨å…¥payloadï¼Œä»æ•°æ®åº“ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ã€‚
4.  **æ•°æ®å¯¼å‡ºï¼š** é€šè¿‡åœ°å€ç°¿å¯¼å‡ºåŠŸèƒ½ï¼Œå†æ¬¡è§¦å‘SQLæ³¨å…¥ï¼Œå°†åŒ…å«SESSIDå’ŒVARSä¿¡æ¯çš„vCardæ–‡ä»¶å¯¼å‡ºã€‚
5.  **æ•°æ®å›ä¼ ï¼š**  å°†å¯¼å‡ºçš„vCardæ–‡ä»¶ä½¿ç”¨base64ç¼–ç åï¼Œå‘é€åˆ°æ”»å‡»è€…çš„C2æœåŠ¡å™¨ã€‚
6.  **è·å–æ•æ„Ÿä¿¡æ¯ï¼š** æ”»å‡»è€…åœ¨C2æœåŠ¡å™¨ä¸Šæ¥æ”¶åˆ°æ•°æ®åï¼Œè¿›è¡Œbase64è§£ç ï¼Œä»è€Œè·å¾—ç›®æ ‡ç”¨æˆ·çš„SESSIDå’ŒVARSä¿¡æ¯ï¼Œè¿›è€Œå¯èƒ½æ§åˆ¶ç›®æ ‡ç”¨æˆ·çš„è´¦æˆ·ã€‚

**é¡¹ç›®åœ°å€:** [skyllpro/CVE-2021-44026-PoC](https://github.com/skyllpro/CVE-2021-44026-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-44026](https://nvd.nist.gov/vuln/detail/CVE-2021-44026)

---



---

## POC #2

**æ¥æº**: [CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md](../2021/CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md)

## CVE-2021-44026-Roundcube-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2021-44026

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Roundcube

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 1.3.0 < version < 1.3.17 å’Œ 1.4.0 < version < 1.4.12

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Roundcube Webmailå®ä¾‹ï¼Œä¸”ç›®æ ‡ç”¨æˆ·èƒ½å¤Ÿæ¥æ”¶å¹¶æ‰“å¼€åŒ…å«æ¶æ„payloadçš„é‚®ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2021-44026æ˜¯Roundcube Webmailä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ï¼Œä½äºæœç´¢åŠŸèƒ½æˆ–search_paramså‚æ•°ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œæ³¨å…¥åˆ°æœç´¢å‚æ•°ä¸­ï¼Œä»è€Œæ‰§è¡Œä»»æ„SQLæŸ¥è¯¢ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„POCä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼š
1.  `exploit_chain_xss_sqli.py`ï¼šè¿™æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºå‘é€åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªFlaskæœåŠ¡å™¨ï¼Œç”¨äºæ¥æ”¶ä»ç›®æ ‡Roundcubeå®ä¾‹å¯¼å‡ºçš„æ•°æ®ã€‚
2.  `static/x-fetch-sqli.js`ï¼šè¿™æ˜¯ä¸€ä¸ªJavaScriptæ–‡ä»¶ï¼ŒåŒ…å«åˆ©ç”¨SQLæ³¨å…¥æ¼æ´çš„payloadã€‚è¯¥payloadé¦–å…ˆé€šè¿‡UNION SELECTè¯­å¥ä»sessionè¡¨ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ï¼Œç„¶åé€šè¿‡æœç´¢åŠŸèƒ½è§¦å‘SQLæ³¨å…¥ï¼Œæœ€åå°†å¯¼å‡ºçš„æ•°æ®å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸º:
* æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸”å½±å“äº†ç‰¹å®šçš„Roundcubeç‰ˆæœ¬ã€‚
* æœç´¢ç»“æœä¸­åŒ…å«åˆ©ç”¨æ­¤æ¼æ´çš„å®ä¾‹ï¼Œä»¥åŠç›¸å…³çš„åˆ†ææ–‡ç« ã€‚
* POCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨XSSå’ŒSQLæ³¨å…¥ç»„åˆæ”»å‡»çš„æ–¹æ³•ï¼Œå¯ä»¥æå–æ•æ„Ÿä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åœ¨æä¾›çš„POCä»£ç ä¸­ï¼Œ`x-fetch-sqli.js` æ–‡ä»¶ä¸­å®šä¹‰äº†C2æœåŠ¡å™¨çš„åœ°å€ `let c2 = "http://192.168.1.2:8181"`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ­¤C2æœåŠ¡å™¨ï¼Œæˆ–è€…æ›´æ”¹äº†ä»£ç ä¸­çš„C2æœåŠ¡å™¨åœ°å€ï¼Œåˆ™å¯ä»¥æ”¶é›†æ‰€æœ‰å—å®³è€…çš„æ•æ„Ÿä¿¡æ¯ã€‚åœ¨ `exploit_chain_xss_sqli.py`ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹é‚®ä»¶å†…å®¹ï¼Œè¯±ä½¿ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚

ä½†æ•´ä½“ä»£ç çš„ç›®çš„æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚å› æ­¤ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º **1%** ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **å‘é€æ¶æ„é‚®ä»¶ï¼š** æ”»å‡»è€…é¦–å…ˆä½¿ç”¨`exploit_chain_xss_sqli.py`è„šæœ¬ï¼Œæ„é€ åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶å°†å…¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
2.  **è§¦å‘XSSï¼š** ç›®æ ‡ç”¨æˆ·æ‰“å¼€é‚®ä»¶åï¼ŒXSS payloadä¼šè¢«æ‰§è¡Œï¼Œä»è€ŒåŠ è½½`x-fetch-sqli.js`æ–‡ä»¶ã€‚
3.  **SQLæ³¨å…¥ï¼š** `x-fetch-sqli.js`æ–‡ä»¶åˆ©ç”¨Roundcubeçš„æœç´¢åŠŸèƒ½ï¼Œæ„é€ SQLæ³¨å…¥payloadï¼Œä»æ•°æ®åº“ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ã€‚
4.  **æ•°æ®å¯¼å‡ºï¼š** é€šè¿‡åœ°å€ç°¿å¯¼å‡ºåŠŸèƒ½ï¼Œå†æ¬¡è§¦å‘SQLæ³¨å…¥ï¼Œå°†åŒ…å«SESSIDå’ŒVARSä¿¡æ¯çš„vCardæ–‡ä»¶å¯¼å‡ºã€‚
5.  **æ•°æ®å›ä¼ ï¼š**  å°†å¯¼å‡ºçš„vCardæ–‡ä»¶ä½¿ç”¨base64ç¼–ç åï¼Œå‘é€åˆ°æ”»å‡»è€…çš„C2æœåŠ¡å™¨ã€‚
6.  **è·å–æ•æ„Ÿä¿¡æ¯ï¼š** æ”»å‡»è€…åœ¨C2æœåŠ¡å™¨ä¸Šæ¥æ”¶åˆ°æ•°æ®åï¼Œè¿›è¡Œbase64è§£ç ï¼Œä»è€Œè·å¾—ç›®æ ‡ç”¨æˆ·çš„SESSIDå’ŒVARSä¿¡æ¯ï¼Œè¿›è€Œå¯èƒ½æ§åˆ¶ç›®æ ‡ç”¨æˆ·çš„è´¦æˆ·ã€‚

**é¡¹ç›®åœ°å€:** [skyllpro/CVE-2021-44026-PoC](https://github.com/skyllpro/CVE-2021-44026-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-44026](https://nvd.nist.gov/vuln/detail/CVE-2021-44026)

---



---

## POC #2

**æ¥æº**: [CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md](../2021/CVE-2021-44026-skyllpro_CVE-2021-44026-PoC.md)

## CVE-2021-44026-Roundcube-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2021-44026

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Roundcube

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 1.3.0 < version < 1.3.17 å’Œ 1.4.0 < version < 1.4.12

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Roundcube Webmailå®ä¾‹ï¼Œä¸”ç›®æ ‡ç”¨æˆ·èƒ½å¤Ÿæ¥æ”¶å¹¶æ‰“å¼€åŒ…å«æ¶æ„payloadçš„é‚®ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2021-44026æ˜¯Roundcube Webmailä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ï¼Œä½äºæœç´¢åŠŸèƒ½æˆ–search_paramså‚æ•°ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œæ³¨å…¥åˆ°æœç´¢å‚æ•°ä¸­ï¼Œä»è€Œæ‰§è¡Œä»»æ„SQLæŸ¥è¯¢ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„POCä»£ç åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼š
1.  `exploit_chain_xss_sqli.py`ï¼šè¿™æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºå‘é€åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªFlaskæœåŠ¡å™¨ï¼Œç”¨äºæ¥æ”¶ä»ç›®æ ‡Roundcubeå®ä¾‹å¯¼å‡ºçš„æ•°æ®ã€‚
2.  `static/x-fetch-sqli.js`ï¼šè¿™æ˜¯ä¸€ä¸ªJavaScriptæ–‡ä»¶ï¼ŒåŒ…å«åˆ©ç”¨SQLæ³¨å…¥æ¼æ´çš„payloadã€‚è¯¥payloadé¦–å…ˆé€šè¿‡UNION SELECTè¯­å¥ä»sessionè¡¨ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ï¼Œç„¶åé€šè¿‡æœç´¢åŠŸèƒ½è§¦å‘SQLæ³¨å…¥ï¼Œæœ€åå°†å¯¼å‡ºçš„æ•°æ®å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸º:
* æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸”å½±å“äº†ç‰¹å®šçš„Roundcubeç‰ˆæœ¬ã€‚
* æœç´¢ç»“æœä¸­åŒ…å«åˆ©ç”¨æ­¤æ¼æ´çš„å®ä¾‹ï¼Œä»¥åŠç›¸å…³çš„åˆ†ææ–‡ç« ã€‚
* POCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨XSSå’ŒSQLæ³¨å…¥ç»„åˆæ”»å‡»çš„æ–¹æ³•ï¼Œå¯ä»¥æå–æ•æ„Ÿä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åœ¨æä¾›çš„POCä»£ç ä¸­ï¼Œ`x-fetch-sqli.js` æ–‡ä»¶ä¸­å®šä¹‰äº†C2æœåŠ¡å™¨çš„åœ°å€ `let c2 = "http://192.168.1.2:8181"`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ­¤C2æœåŠ¡å™¨ï¼Œæˆ–è€…æ›´æ”¹äº†ä»£ç ä¸­çš„C2æœåŠ¡å™¨åœ°å€ï¼Œåˆ™å¯ä»¥æ”¶é›†æ‰€æœ‰å—å®³è€…çš„æ•æ„Ÿä¿¡æ¯ã€‚åœ¨ `exploit_chain_xss_sqli.py`ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹é‚®ä»¶å†…å®¹ï¼Œè¯±ä½¿ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚

ä½†æ•´ä½“ä»£ç çš„ç›®çš„æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´ï¼Œè€Œéæ¤å…¥åé—¨ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚å› æ­¤ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º **1%** ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **å‘é€æ¶æ„é‚®ä»¶ï¼š** æ”»å‡»è€…é¦–å…ˆä½¿ç”¨`exploit_chain_xss_sqli.py`è„šæœ¬ï¼Œæ„é€ åŒ…å«XSS payloadçš„é‚®ä»¶ï¼Œå¹¶å°†å…¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
2.  **è§¦å‘XSSï¼š** ç›®æ ‡ç”¨æˆ·æ‰“å¼€é‚®ä»¶åï¼ŒXSS payloadä¼šè¢«æ‰§è¡Œï¼Œä»è€ŒåŠ è½½`x-fetch-sqli.js`æ–‡ä»¶ã€‚
3.  **SQLæ³¨å…¥ï¼š** `x-fetch-sqli.js`æ–‡ä»¶åˆ©ç”¨Roundcubeçš„æœç´¢åŠŸèƒ½ï¼Œæ„é€ SQLæ³¨å…¥payloadï¼Œä»æ•°æ®åº“ä¸­æå–SESSIDå’ŒVARSä¿¡æ¯ã€‚
4.  **æ•°æ®å¯¼å‡ºï¼š** é€šè¿‡åœ°å€ç°¿å¯¼å‡ºåŠŸèƒ½ï¼Œå†æ¬¡è§¦å‘SQLæ³¨å…¥ï¼Œå°†åŒ…å«SESSIDå’ŒVARSä¿¡æ¯çš„vCardæ–‡ä»¶å¯¼å‡ºã€‚
5.  **æ•°æ®å›ä¼ ï¼š**  å°†å¯¼å‡ºçš„vCardæ–‡ä»¶ä½¿ç”¨base64ç¼–ç åï¼Œå‘é€åˆ°æ”»å‡»è€…çš„C2æœåŠ¡å™¨ã€‚
6.  **è·å–æ•æ„Ÿä¿¡æ¯ï¼š** æ”»å‡»è€…åœ¨C2æœåŠ¡å™¨ä¸Šæ¥æ”¶åˆ°æ•°æ®åï¼Œè¿›è¡Œbase64è§£ç ï¼Œä»è€Œè·å¾—ç›®æ ‡ç”¨æˆ·çš„SESSIDå’ŒVARSä¿¡æ¯ï¼Œè¿›è€Œå¯èƒ½æ§åˆ¶ç›®æ ‡ç”¨æˆ·çš„è´¦æˆ·ã€‚

**é¡¹ç›®åœ°å€:** [skyllpro/CVE-2021-44026-PoC](https://github.com/skyllpro/CVE-2021-44026-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-44026](https://nvd.nist.gov/vuln/detail/CVE-2021-44026)

---

