## CVE-2021-4034 - polkit (pkexec) 本地权限提升 (LPE)

**漏洞编号:** CVE-2021-4034

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** polkit (pkexec)

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 所有包含 polkit 的 Linux 发行版 (2009年至今)

**利用条件:** 具有本地普通用户账户访问权限

**POC 可用性:** 4/10

**POC 类型:** 概念验证/文档说明

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：本数据源提供的POC内容主要为一份学术性质的毕业论文或研究报告（Studienarbeit），其README和LaTeX源代码详细描述了CVE-2021-4034（即PwnKit）的原理。该漏洞存在于polkit的pkexec程序中，源于其对命令行参数处理的不当。当argv数组为空时，程序会错误地尝试读取环境变量数组，导致内存越界写入。攻击者可以通过构造特定的环境变量，诱导pkexec加载并执行恶意的共享库文件，从而以root权限执行代码。虽然提供的文件片段中没有直接包含二进制利用脚本，但其学术分析极其深入，逻辑严密，足以指导安全人员重现该漏洞。其有效性体现在对利用原理的精准解释：利用PATH环境变量的特性在非法索引处写入受控字符串。 利用步骤：1. 在本地系统中创建一个包含恶意共享库的目录（例如 'GCONV_PATH=.'）。2. 创建一个虚假的转换配置目录和对应的.so文件，该文件包含提权Payload（如 setuid(0) + execve('/bin/sh')）。3. 调用pkexec，并确保传递给它的参数列表为空（argv[] = { NULL }），同时设置精心构造的环境变量。4. pkexec在解析参数时会由于越界读取到环境变量，并最终加载攻击者指定的.so文件，从而弹出root shell。 投毒风险分析：该仓库目前的投毒风险极低（约5%）。通过对提供的LaTeX源代码和README进行审计，发现该项目是一个典型的学术研究项目。代码中包含大量的学术格式定义（如memoir类、TikZ绘图包等），不包含任何混淆代码、外部恶意请求或二进制下载指令。其目的在于教育和防御性展示，而非秘密传播。尽管如此，防御者在从GitHub等平台下载此类命名的仓库时仍需警悯，因为此类高知名度漏洞（PwnKit）常被攻击者利用，通过上传看似是安全研究实则包含恶意后门（如在Makefile中植入反弹Shell）的假POC进行投毒。本样本由于是纯文档项目，且代码逻辑透明，目前未发现恶意行为，属于安全的防御性研究资料。

**项目地址:** /tmp/vulnwatchdog_7211107d8767192859c283e8fbaf5d5a/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2021-4034](https://nvd.nist.gov/vuln/detail/CVE-2021-4034)
