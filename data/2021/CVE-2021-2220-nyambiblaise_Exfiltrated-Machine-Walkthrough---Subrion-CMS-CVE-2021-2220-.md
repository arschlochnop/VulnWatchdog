## CVE-2021-21220 - Google Chrome (Chromium V8 Engine) 远程代码执行 (RCE)

**漏洞编号:** CVE-2021-21220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Google Chrome (Chromium V8 Engine)

**危害等级:** CRITICAL

**CVSS评分:** 8.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** Chrome < 89.0.4389.128

**利用条件:** 用户访问恶意网页，且Chrome未开启沙箱(No-Sandbox)或配合沙箱逃逸漏洞使用

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】CVE-2021-21220是一个存在于Google Chrome V8引擎中的JIT（Just-In-Time）编译器漏洞。该漏洞源于V8在对SimplifiedLowering阶段进行整数截断检查时存在逻辑缺陷。具体而言，编译器在处理位运算（如OR）的结果时，未能正确验证其输入值的范围，导致在生成机器码时可能忽略了必要的类型检查或边界溢出检查。搜索结果显示，该漏洞已有多份详细的分析报告和公开的POC代码。根据结果1和结果2，修复该漏洞的Commit ID为02f84c745fc0cae5927a66dc4a3e。POC的有效性在特定环境下（如禁用沙箱的Chrome实例）极高。公开的POC代码通常利用这一逻辑错误构造一个越界读写（OOB）原语，通过修改数组的Length属性或直接操作DataView，实现对内存地址的任意访问。在现代浏览器防御体系下，该漏洞通常作为链条的第一步，用于在渲染进程中执行代码。由于Chromium项目的透明度，补丁后的对比分析使得漏洞利用路径非常清晰。实验证明，在配套的Shellcode注入下，可以实现弹出计算器（calc.exe）等典型的RCE验证效果。然而，在启用沙箱的默认配置下，单纯利用此漏洞无法直接控制宿主机系统，需要配合内核驱动漏洞或沙箱逃逸漏洞才能实现完整的系统控制。【利用步骤】1. 准备攻击环境：搭建一个Web服务器，用于托管恶意HTML文件和JS脚本。2. 构造Payload：根据V8漏洞特性编写JavaScript代码。首先通过特定的位运算触发JIT优化错误，构造出越界访问的数组。3. 内存布局：利用越界访问原语，在内存中搜索和定位关键对象的地址，通过类型混淆手段获取DataView或其他可读写内存的对象。4. 编写Shellcode：准备好要执行的二进制指令（如执行系统命令的Shellcode）。5. 劫持执行流：利用任意内存读写能力，覆盖WebAssembly对象或其他具有执行权限（RWX）的内存区域，将执行流重定向到Shellcode。6. 触发攻击：引导目标用户使用受影响版本的Chrome浏览器访问恶意链接，如果是无沙箱模式（--no-sandbox），则可直接观察到代码执行结果。【投毒风险分析】该漏洞相关的防御性研究代码投毒风险处于低至中等水平（约15%）。主要的风险点在于：首先，由于V8漏洞利用涉及大量复杂的混淆JS代码（为了稳定触发JIT优化），普通安全研究人员很难通过肉眼快速判断JS逻辑中是否隐藏了针对分析者本人的浏览器攻击脚本。如果POC发布者在利用代码中额外嵌入了针对特定分析工具或特定版本的二级利用，可能会导致研究员的分析环境反遭渗透。其次，部分GitHub上的POC（如结果5提到的类似结构）可能在辅助脚本（如python验证脚本）中加入下载器指令，虽然本案中的README显示结构较为规范，但在下载第三方ysoserial或类似payload生成工具时，若来源非官方，存在供应链投毒风险。再次，对于此类高价值RCE漏洞，攻击者常伪造“一键式EXP”来吸引初级脚本小子或研究员下载运行，这些工具可能被捆绑后门。但在本案例的公开搜索结果中，代码库主要侧重于漏洞复现和CTF场景（如结果7、8），其代码透明度较高，通过标准库实现，未见明显的恶意混淆或外部可疑连接请求，故整体投毒风险被评估为低风险级别，但仍建议在隔离的虚拟机环境下进行调试和验证。

**项目地址:** [https://github.com/yumusb/CVE-2021-26295](https://github.com/yumusb/CVE-2021-26295)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2021-21220](https://nvd.nist.gov/vuln/detail/CVE-2021-21220)
