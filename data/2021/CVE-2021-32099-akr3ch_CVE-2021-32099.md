# CVE-2021-32099

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-32099-akr3ch_CVE-2021-32099.md](../2021/CVE-2021-32099-akr3ch_CVE-2021-32099.md)

# CVE-2021-32099

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-32099-ibnuuby_CVE-2021-32099.md](../2021/CVE-2021-32099-ibnuuby_CVE-2021-32099.md)

## CVE-2021-32099-Artica Pandora FMS-SQL注入

**漏洞编号:** CVE-2021-32099

**漏洞类型:** SQL注入

**影响应用:** Artica Pandora FMS

**危害等级:** 高危，允许未授权用户绕过身份验证并获得管理员权限

**影响版本:** 742

**利用条件:** 目标系统运行Pandora FMS 742且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-32099是Artica Pandora FMS 742版本中pandora_console组件的/include/chart_generator.php文件存在的一个SQL注入漏洞。 

**有效性：**
提供的POC代码通过`session_id`参数注入恶意的SQL语句。该SQL语句使用`UNION SELECT`来构造一个新的结果集，该结果集包含一个伪造的`tsessions_php`表中的数据，从而将当前会话的用户ID设置为`admin`，实现登录绕过。

**投毒风险：**
该仓库主要包含漏洞的POC和描述信息，没有发现明显的恶意代码。但是，任何从公开来源获取的代码都存在一定的风险。在实际使用POC之前，建议进行代码审查，以确保其安全性。投毒风险评估为5%，主要来自于对第三方代码仓库的固有风险，以及作者可能在描述文件中加入恶意链接或者指令的可能性。

**利用方式：**
1.  攻击者向目标系统的`/pandora_console/include/chart_generator.php`发送一个包含恶意`session_id`参数的HTTP请求。
2.  恶意的`session_id`参数包含一个SQL注入payload，该payload旨在修改当前用户的会话数据，将其权限提升为管理员。
3.  目标系统执行包含恶意代码的SQL查询，更新会话信息。
4.  攻击者刷新页面或访问需要管理员权限的功能，即可绕过身份验证，以管理员身份登录系统。

**项目地址:** [ibnuuby/CVE-2021-32099](https://github.com/ibnuuby/CVE-2021-32099)

**漏洞详情:** [CVE-2021-32099](https://nvd.nist.gov/vuln/detail/CVE-2021-32099)

---

## POC #2

**来源**: [CVE-2021-32099-l3eol3eo_CVE-2021-32099_SQLi.md](../2021/CVE-2021-32099-l3eol3eo_CVE-2021-32099_SQLi.md)

## CVE-2021-32099 - Artica Pandora FMS SQL 注入导致登录绕过

**漏洞编号:** CVE-2021-32099

**漏洞类型:** SQL 注入

**影响应用:** Artica Pandora FMS

**危害等级:** 高危，可导致未授权访问和信息泄露

**影响版本:** 742

**利用条件:** 目标系统运行 Pandora FMS 742，且攻击者可以访问 /include/chart_generator.php 页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-32099 漏洞存在于 Artica Pandora FMS 742 的 pandora_console 组件中。攻击者可以通过操纵 /include/chart_generator.php 的 session_id 参数，注入恶意的 SQL 代码，从而绕过身份验证。具体利用方式如下：

1.  攻击者构造包含 SQL 注入 payload 的 URL，例如：`http://localhost:8000/pandora_console/include/chart_generator.php?session_id=PayloadHere%27%20union%20select%20%271%27,%272%27,%27id_usuario|s:5:%22admin%22;%27%20--%20a`
2.  该 payload 会修改数据库中的 session 数据，将用户的 id_usuario 设置为 admin。该部分主要构造恶意的序列化数据以覆盖现有session。
3.  攻击者访问 Pandora FMS 控制台，即可获得管理员权限。

**有效性:** 提供的POC代码是有效的，因为它利用了 SQL 注入漏洞来修改会话数据，从而实现登录绕过。

**投毒风险:** 提供的POC代码仓库主要包含了一个 `README.md` 文件。该文件详细描述了漏洞的分析过程和利用方法。 虽然代码本身没有明显的恶意行为，比如下载执行恶意文件等，但是任何能修改数据库的攻击都可能导致数据损坏和拒绝服务。因此，存在极低的投毒风险，约5%，风险点在于攻击者可以使用此漏洞修改或删除数据库内容，从而对系统造成损害。 

**利用方式:**

1.  确定目标系统运行的是 Artica Pandora FMS 742。
2.  构造包含 SQL 注入 payload 的 URL，目标为 `/include/chart_generator.php` 页面，并修改 `session_id` 参数。
3.  访问构造的 URL。
4.  访问 Pandora FMS 控制台，以绕过身份验证并获得管理员权限。

**项目地址:** [l3eol3eo/CVE-2021-32099_SQLi](https://github.com/l3eol3eo/CVE-2021-32099_SQLi)

**漏洞详情:** [CVE-2021-32099](https://nvd.nist.gov/vuln/detail/CVE-2021-32099)

---

## POC #3

**来源**: [CVE-2021-32099-magicrc_CVE-2021-32099.md](../2021/CVE-2021-32099-magicrc_CVE-2021-32099.md)

## CVE-2021-32099-Artica Pandora FMS-SQL注入

**漏洞编号:** CVE-2021-32099

**漏洞类型:** SQL注入

**影响应用:** Artica Pandora FMS

**危害等级:** 高危，可能导致未经授权访问和权限提升

**影响版本:** 742

**利用条件:** 需要网络访问目标 Pandora FMS 742 实例，且目标存在漏洞的 /include/chart_generator.php 文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-32099 是 Artica Pandora FMS 742 的 pandora_console 组件中的 SQL 注入漏洞。未经验证的攻击者可以通过操纵 /include/chart_generator.php 的 session_id 参数来提升其会话权限，从而绕过登录验证。

**有效性：**
根据漏洞库信息、搜索引擎结果（尤其是 GitHub 链接）以及漏洞描述，该漏洞利用是有效的。漏洞允许未经身份验证的攻击者通过 SQL 注入绕过身份验证。

**投毒风险：**
提供的代码段仅包含 MIT 许可证。 没有发现任何恶意或可疑的代码，因此投毒风险为 0%。 提供的代码只是一个标准的开源许可协议，与漏洞利用本身无关。

**利用方式：**
1.  攻击者构造包含恶意 SQL 注入的 `session_id` 参数的 HTTP 请求。
2.  将该请求发送到目标 Pandora FMS 742 实例的 `/include/chart_generator.php` 文件。
3.  恶意 SQL 注入会更新服务器上的会话信息，将攻击者的会话权限提升为管理员或其他高权限用户。
4.  攻击者使用被提升的会话来访问受保护的资源或执行管理操作，从而实现登录绕过。

**项目地址:** [magicrc/CVE-2021-32099](https://github.com/magicrc/CVE-2021-32099)

**漏洞详情:** [CVE-2021-32099](https://nvd.nist.gov/vuln/detail/CVE-2021-32099)

---

## POC #4

**来源**: [CVE-2021-32099-zjicmDarkWing_CVE-2021-32099.md](../2021/CVE-2021-32099-zjicmDarkWing_CVE-2021-32099.md)

## CVE-2021-32099-Pandora FMS-SQL注入

**漏洞编号:** CVE-2021-32099

**漏洞类型:** SQL注入

**影响应用:** Pandora FMS

**危害等级:** 高危，允许未授权访问和权限提升

**影响版本:** 742

**利用条件:** 需要网络访问 Pandora FMS 控制台

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-32099 是 Artica Pandora FMS 742 版本中 pandora_console 组件存在的一个 SQL 注入漏洞。根据漏洞描述和搜索结果，该漏洞允许未经身份验证的攻击者通过操纵 `/include/chart_generator.php` 文件的 `session_id` 参数来升级他们的会话权限，从而绕过登录验证。提供的 POC 代码显示，通过在 `session_id` 参数中注入 SQL 语句，攻击者可以修改 session 数据，将用户身份设置为 "admin"。  

**有效性：**  
根据漏洞信息、搜索结果和 POC 代码，可以判断该漏洞的利用是有效的。POC 代码构造了一个包含 SQL 注入的 URL，用于修改 session 数据，从而实现登录绕过。

**投毒风险：**
POC本身的功能是验证漏洞，并不会引入恶意代码。`/tmp/6e3e51a32dedf3468374abbb2ba88f38/README.md` 文件中只有简单的漏洞描述和POC链接，从目前提供的信息分析，投毒风险较低，但也无法完全排除作者在其他地方隐藏恶意代码的可能性。例如，存在同作者其他仓库存在后门，诱导受害者使用。因此，给出10%的风险评估。

**利用方式：**
1.  攻击者无需身份验证。
2.  攻击者构造恶意的 URL，其中包含 SQL 注入代码，该代码位于 `/include/chart_generator.php` 文件的 `session_id` 参数中。
3.  SQL 注入代码用于更新数据库中的 session 数据，将攻击者的会话与管理员权限关联。
4.  攻击者使用被篡改的会话访问 Pandora FMS 控制台，从而获得未经授权的访问权限。

**项目地址:** [zjicmDarkWing/CVE-2021-32099](https://github.com/zjicmDarkWing/CVE-2021-32099)

**漏洞详情:** [CVE-2021-32099](https://nvd.nist.gov/vuln/detail/CVE-2021-32099)

---



---

## POC #2

**来源**: [CVE-2021-32099-ibnuuby_CVE-2021-32099.md](../2021/CVE-2021-32099-ibnuuby_CVE-2021-32099.md)

## CVE-2021-32099-Artica Pandora FMS-SQL注入

**漏洞编号:** CVE-2021-32099

**漏洞类型:** SQL注入

**影响应用:** Artica Pandora FMS

**危害等级:** 高危，允许未授权用户绕过身份验证并获得管理员权限

**影响版本:** 742

**利用条件:** 目标系统运行Pandora FMS 742且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-32099是Artica Pandora FMS 742版本中pandora_console组件的/include/chart_generator.php文件存在的一个SQL注入漏洞。 

**有效性：**
提供的POC代码通过`session_id`参数注入恶意的SQL语句。该SQL语句使用`UNION SELECT`来构造一个新的结果集，该结果集包含一个伪造的`tsessions_php`表中的数据，从而将当前会话的用户ID设置为`admin`，实现登录绕过。

**投毒风险：**
该仓库主要包含漏洞的POC和描述信息，没有发现明显的恶意代码。但是，任何从公开来源获取的代码都存在一定的风险。在实际使用POC之前，建议进行代码审查，以确保其安全性。投毒风险评估为5%，主要来自于对第三方代码仓库的固有风险，以及作者可能在描述文件中加入恶意链接或者指令的可能性。

**利用方式：**
1.  攻击者向目标系统的`/pandora_console/include/chart_generator.php`发送一个包含恶意`session_id`参数的HTTP请求。
2.  恶意的`session_id`参数包含一个SQL注入payload，该payload旨在修改当前用户的会话数据，将其权限提升为管理员。
3.  目标系统执行包含恶意代码的SQL查询，更新会话信息。
4.  攻击者刷新页面或访问需要管理员权限的功能，即可绕过身份验证，以管理员身份登录系统。

**项目地址:** [ibnuuby/CVE-2021-32099](https://github.com/ibnuuby/CVE-2021-32099)

**漏洞详情:** [CVE-2021-32099](https://nvd.nist.gov/vuln/detail/CVE-2021-32099)

---

## POC #3

**来源**: [CVE-2021-32099-l3eol3eo_CVE-2021-32099_SQLi.md](../2021/CVE-2021-32099-l3eol3eo_CVE-2021-32099_SQLi.md)

## CVE-2021-32099 - Artica Pandora FMS SQL 注入导致登录绕过

**漏洞编号:** CVE-2021-32099

**漏洞类型:** SQL 注入

**影响应用:** Artica Pandora FMS

**危害等级:** 高危，可导致未授权访问和信息泄露

**影响版本:** 742

**利用条件:** 目标系统运行 Pandora FMS 742，且攻击者可以访问 /include/chart_generator.php 页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-32099 漏洞存在于 Artica Pandora FMS 742 的 pandora_console 组件中。攻击者可以通过操纵 /include/chart_generator.php 的 session_id 参数，注入恶意的 SQL 代码，从而绕过身份验证。具体利用方式如下：

1.  攻击者构造包含 SQL 注入 payload 的 URL，例如：`http://localhost:8000/pandora_console/include/chart_generator.php?session_id=PayloadHere%27%20union%20select%20%271%27,%272%27,%27id_usuario|s:5:%22admin%22;%27%20--%20a`
2.  该 payload 会修改数据库中的 session 数据，将用户的 id_usuario 设置为 admin。该部分主要构造恶意的序列化数据以覆盖现有session。
3.  攻击者访问 Pandora FMS 控制台，即可获得管理员权限。

**有效性:** 提供的POC代码是有效的，因为它利用了 SQL 注入漏洞来修改会话数据，从而实现登录绕过。

**投毒风险:** 提供的POC代码仓库主要包含了一个 `README.md` 文件。该文件详细描述了漏洞的分析过程和利用方法。 虽然代码本身没有明显的恶意行为，比如下载执行恶意文件等，但是任何能修改数据库的攻击都可能导致数据损坏和拒绝服务。因此，存在极低的投毒风险，约5%，风险点在于攻击者可以使用此漏洞修改或删除数据库内容，从而对系统造成损害。 

**利用方式:**

1.  确定目标系统运行的是 Artica Pandora FMS 742。
2.  构造包含 SQL 注入 payload 的 URL，目标为 `/include/chart_generator.php` 页面，并修改 `session_id` 参数。
3.  访问构造的 URL。
4.  访问 Pandora FMS 控制台，以绕过身份验证并获得管理员权限。

**项目地址:** [l3eol3eo/CVE-2021-32099_SQLi](https://github.com/l3eol3eo/CVE-2021-32099_SQLi)

**漏洞详情:** [CVE-2021-32099](https://nvd.nist.gov/vuln/detail/CVE-2021-32099)

---

## POC #4

**来源**: [CVE-2021-32099-magicrc_CVE-2021-32099.md](../2021/CVE-2021-32099-magicrc_CVE-2021-32099.md)

## CVE-2021-32099-Artica Pandora FMS-SQL注入

**漏洞编号:** CVE-2021-32099

**漏洞类型:** SQL注入

**影响应用:** Artica Pandora FMS

**危害等级:** 高危，可能导致未经授权访问和权限提升

**影响版本:** 742

**利用条件:** 需要网络访问目标 Pandora FMS 742 实例，且目标存在漏洞的 /include/chart_generator.php 文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-32099 是 Artica Pandora FMS 742 的 pandora_console 组件中的 SQL 注入漏洞。未经验证的攻击者可以通过操纵 /include/chart_generator.php 的 session_id 参数来提升其会话权限，从而绕过登录验证。

**有效性：**
根据漏洞库信息、搜索引擎结果（尤其是 GitHub 链接）以及漏洞描述，该漏洞利用是有效的。漏洞允许未经身份验证的攻击者通过 SQL 注入绕过身份验证。

**投毒风险：**
提供的代码段仅包含 MIT 许可证。 没有发现任何恶意或可疑的代码，因此投毒风险为 0%。 提供的代码只是一个标准的开源许可协议，与漏洞利用本身无关。

**利用方式：**
1.  攻击者构造包含恶意 SQL 注入的 `session_id` 参数的 HTTP 请求。
2.  将该请求发送到目标 Pandora FMS 742 实例的 `/include/chart_generator.php` 文件。
3.  恶意 SQL 注入会更新服务器上的会话信息，将攻击者的会话权限提升为管理员或其他高权限用户。
4.  攻击者使用被提升的会话来访问受保护的资源或执行管理操作，从而实现登录绕过。

**项目地址:** [magicrc/CVE-2021-32099](https://github.com/magicrc/CVE-2021-32099)

**漏洞详情:** [CVE-2021-32099](https://nvd.nist.gov/vuln/detail/CVE-2021-32099)

---

## POC #5

**来源**: [CVE-2021-32099-zjicmDarkWing_CVE-2021-32099.md](../2021/CVE-2021-32099-zjicmDarkWing_CVE-2021-32099.md)

## CVE-2021-32099-Pandora FMS-SQL注入

**漏洞编号:** CVE-2021-32099

**漏洞类型:** SQL注入

**影响应用:** Pandora FMS

**危害等级:** 高危，允许未授权访问和权限提升

**影响版本:** 742

**利用条件:** 需要网络访问 Pandora FMS 控制台

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-32099 是 Artica Pandora FMS 742 版本中 pandora_console 组件存在的一个 SQL 注入漏洞。根据漏洞描述和搜索结果，该漏洞允许未经身份验证的攻击者通过操纵 `/include/chart_generator.php` 文件的 `session_id` 参数来升级他们的会话权限，从而绕过登录验证。提供的 POC 代码显示，通过在 `session_id` 参数中注入 SQL 语句，攻击者可以修改 session 数据，将用户身份设置为 "admin"。  

**有效性：**  
根据漏洞信息、搜索结果和 POC 代码，可以判断该漏洞的利用是有效的。POC 代码构造了一个包含 SQL 注入的 URL，用于修改 session 数据，从而实现登录绕过。

**投毒风险：**
POC本身的功能是验证漏洞，并不会引入恶意代码。`/tmp/6e3e51a32dedf3468374abbb2ba88f38/README.md` 文件中只有简单的漏洞描述和POC链接，从目前提供的信息分析，投毒风险较低，但也无法完全排除作者在其他地方隐藏恶意代码的可能性。例如，存在同作者其他仓库存在后门，诱导受害者使用。因此，给出10%的风险评估。

**利用方式：**
1.  攻击者无需身份验证。
2.  攻击者构造恶意的 URL，其中包含 SQL 注入代码，该代码位于 `/include/chart_generator.php` 文件的 `session_id` 参数中。
3.  SQL 注入代码用于更新数据库中的 session 数据，将攻击者的会话与管理员权限关联。
4.  攻击者使用被篡改的会话访问 Pandora FMS 控制台，从而获得未经授权的访问权限。

**项目地址:** [zjicmDarkWing/CVE-2021-32099](https://github.com/zjicmDarkWing/CVE-2021-32099)

**漏洞详情:** [CVE-2021-32099](https://nvd.nist.gov/vuln/detail/CVE-2021-32099)

---

