# CVE-2021-25646

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-25646-1n7erface_PocList.md](../2021/CVE-2021-25646-1n7erface_PocList.md)

## CVE-2021-25646-Apache Druid-RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要身份验证（但可绕过配置），目标Druid版本<=0.20.0，且JavaScript执行功能未完全禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-25646允许经过身份验证的用户通过构造特制的请求来执行任意JavaScript代码，从而实现远程代码执行。即使服务器配置禁用了JavaScript功能，此漏洞仍然有效。利用方式主要通过发送包含恶意JavaScript代码的HTTP请求，利用Druid的配置覆盖机制来实现。从提供的代码片段来看，POC是存在的，作者声明项目中存在多个漏洞的POC。由于项目作者声明中存在对安全法的担忧，并且项目后期存在架构上的问题，无法保证提供的所有POC的有效性。因此，无法排除POC中存在隐藏的后门或者恶意代码的可能。但是其主动停止更新，说明存在主动规避风险的意愿，且主要目标是简化漏洞利用流程而非进行恶意活动。投毒风险较低，估计为10%。此漏洞的修复方案是升级到Druid 0.20.1或更高版本，并限制对集群机器的网络访问。

**项目地址:** [1n7erface/PocList](https://github.com/1n7erface/PocList)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #2

**来源**: [CVE-2021-25646-Ormicron_CVE-2021-25646-GUI.md](../2021/CVE-2021-25646-Ormicron_CVE-2021-25646-GUI.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标运行Druid 0.20.0及更早版本，且攻击者需要具备身份验证权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造特定的请求来覆盖系统配置，从而在 Apache Druid 服务器上执行任意代码。漏洞利用方式：

1.  **漏洞描述：** Apache Druid 包含执行用户提供的 JavaScript 代码的能力，该功能旨在用于高信任环境，默认情况下处于禁用状态。但是，在 Druid 0.20.0 及更早版本中，经过身份验证的用户可以发送特制的请求，强制 Druid 运行用户提供的 JavaScript 代码，而无需考虑服务器配置。
2.  **搜索引擎结果分析：** 大部分搜索结果都表明这是一个未经身份验证的 RCE 漏洞，这与漏洞库中的信息不符。漏洞库信息表明，该漏洞需要身份验证。
3.  **漏洞利用代码分析：** 提供的代码是 C# 的 Visual Studio 项目，看起来是一个用于利用此漏洞的程序。项目包含`Form1.cs`和`Program.cs`等文件，表明它可能是一个图形界面程序，用于构造和发送恶意请求。

    *   **有效性：** 根据漏洞信息和搜索结果，可以判断该漏洞是有效的，并且存在公开可用的利用代码。需要注意的是，漏洞利用需要身份验证，这一点与部分搜索结果不一致。提供的C#代码表明存在一种GUI利用方式。通过构造带有恶意JavaScript代码的HTTP请求利用漏洞。
    *   **投毒风险：**  提供的代码片段为 Visual Studio 项目文件和一些窗体相关的代码，并非完整的PoC代码，难以直接判断是否存在投毒代码。代码本身是用于利用漏洞的，如果攻击者修改了代码，例如在执行有效载荷之前或之后添加了其他恶意操作（例如，窃取凭据、安装后门、横向渗透），则可能存在投毒。根据已提供的代码片段，检测到恶意代码的概率较低，约为20%。
    *   **利用方式：** 攻击者需要首先获取 Druid 实例的有效身份验证凭据。然后，他们可以构造一个包含恶意 JavaScript 代码的 HTTP 请求，利用 Druid 的配置覆盖机制来执行该代码，从而获得服务器的控制权。攻击通常涉及向 Druid 服务器的特定端点（例如查询或数据摄取 API）发送包含恶意 JavaScript 代码的 JSON 载荷。

**项目地址:** [Ormicron/CVE-2021-25646-GUI](https://github.com/Ormicron/CVE-2021-25646-GUI)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #3

**来源**: [CVE-2021-25646-ShadowLance2_Apache-Druid-CVE-2021-25646-Exploit.md](../2021/CVE-2021-25646-ShadowLance2_Apache-Druid-CVE-2021-25646-Exploit.md)

## CVE-2021-25646-Apache Druid-RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务版本低于0.20.1，且攻击者需要具备一定程度的身份验证（即使是低权限用户）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-25646是Apache Druid中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许经过身份验证的用户通过构造特制的请求来执行任意JavaScript代码，从而在Druid服务器上以服务器进程的权限执行代码。即使服务器配置禁用了JavaScript执行，攻击者仍然可以通过此漏洞绕过限制。

**有效性：**
提供的PoC代码看起来是有效的。它利用了Druid的sampler接口，通过构造包含恶意JavaScript代码的JSON payload，尝试在目标系统上执行命令。代码中包含了命令转义，增加了成功利用的可能性。

**投毒风险：**
PoC代码中存在少量投毒风险。代码逻辑主要是构造payload，风险主要在于以下几点：

1.  **依赖安装风险：**`requirements.txt`文件如果包含恶意依赖，则存在投毒风险，但该PoC未使用`requirements.txt`而是直接提示安装`requests`库，风险较低。
2.  **请求库风险：**代码使用了`requests`库发送HTTP请求。如果该库被篡改，可能导致信息泄露或者其他安全问题，但这种情况发生的概率较低。
3.  **代码逻辑风险：** 代码中命令执行部分使用了`java.lang.Runtime.getRuntime().exec()`，如果攻击者修改了PoC，可能会尝试执行更危险的命令，但代码本身目标是执行用户指定的命令。

因此，综合来看，PoC本身包含的恶意代码概率较低，但如果被篡改，则可能存在风险，投毒风险评估为5%。

**利用方式：**
1.  攻击者需要知道目标Druid服务的URL。
2.  攻击者需要发送一个POST请求到`/druid/indexer/v1/sampler`端点。
3.  请求体需要是包含恶意JavaScript代码的JSON payload。这个payload会覆盖服务器配置，强制执行JavaScript代码。
4.  恶意JavaScript代码使用`java.lang.Runtime.getRuntime().exec()`来执行系统命令。
5.  服务器返回命令执行结果。

**项目地址:** [ShadowLance2/Apache-Druid-CVE-2021-25646-Exploit](https://github.com/ShadowLance2/Apache-Druid-CVE-2021-25646-Exploit)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #4

**来源**: [CVE-2021-25646-Vulnmachines_Apache-Druid-CVE-2021-25646.md](../2021/CVE-2021-25646-Vulnmachines_Apache-Druid-CVE-2021-25646.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器版本低于或等于0.20.0，且攻击者需要具有经过身份验证的访问权限（根据漏洞库信息）。但根据部分搜索结果，某些默认配置可能无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 漏洞允许经过身份验证的用户（或者在某些未授权配置下，未经身份验证的用户）通过发送特制的 HTTP 请求，在 Apache Druid 服务器上执行任意 JavaScript 代码，从而实现远程代码执行。  

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开的POC代码。提供的POC代码通过`POST /druid/indexer/v1/sampler?for=filter`发送包含恶意JavaScript代码的JSON数据，利用Druid的`filter`功能执行`wget`命令，下载恶意文件到`/tmp/hacked.txt`。因此，该POC代码是有效的。

**投毒风险分析：**
Payload.txt中的代码会尝试从攻击者的IP地址下载文件，存在潜在的投毒风险。攻击者可以替换文件内容，例如下载恶意的二进制文件或其他payload。README.md文件只是一个简单的说明，本身不包含恶意代码。

分析 Payload.txt 文件，其中的 JavaScript 代码旨在通过 `wget` 命令从 `IP/file` 下载文件到 `/tmp/hacked.txt`。这段代码本身不包含后门或者恶意逻辑，只是下载文件。但如果攻击者替换 `IP/file` 指向恶意文件，则可能造成投毒。

风险评估：
- **下载恶意文件:** 90% 的风险在于，攻击者可能会修改 `IP/file` 指向一个恶意的可执行文件、脚本或其他有害内容，导致受害者系统感染或被控制。
- **代码本身:** 代码本身（`wget IP/file -O /tmp/hacked.txt`）的恶意性只有 10%，因为这只是一个下载操作，恶意性取决于下载的内容。

**利用方式：**
1.  **身份验证：**  根据漏洞描述，默认需要首先通过Druid的身份验证机制。但是，需要注意的是，某些搜索结果表明，在某些默认配置下，Druid可能存在未授权访问的情况，无需身份验证即可利用此漏洞。
2.  **构造恶意请求：**  构造一个包含恶意JavaScript代码的JSON数据包，并将其发送到`/druid/indexer/v1/sampler?for=filter`端点。
3.  **代码执行：**  Druid服务器解析该请求，执行嵌入的JavaScript代码，从而实现远程代码执行。
4.  **利用 JavaScript 执行系统命令:** POC 利用 `java.lang.Runtime.getRuntime().exec()` 来执行系统命令 `wget IP/file -O /tmp/hacked.txt`。这里的核心是使用 Java 的 Runtime 对象来执行任意系统命令。

**总结：**
该漏洞利用方式简单，危害性高，利用代码有效，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [Vulnmachines/Apache-Druid-CVE-2021-25646](https://github.com/Vulnmachines/Apache-Druid-CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #5

**来源**: [CVE-2021-25646-givemefivw_CVE-2021-25646.md](../2021/CVE-2021-25646-givemefivw_CVE-2021-25646.md)

## CVE-2021-25646-ApacheDruid远程命令执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid实例版本小于等于0.20.0，且攻击者需要能够发送HTTP请求到Druid的indexer服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造恶意请求，绕过服务器配置执行任意JavaScript代码，从而导致远程代码执行。该漏洞利用方式主要是发送POST请求到/druid/indexer/v1/sampler接口，请求体包含精心构造的JSON数据，该数据中嵌入了恶意JavaScript代码。POC有效性分析：提供的POC代码使用Wker脚本编写，通过定义dir变量指定漏洞接口，post变量定义了包含恶意JavaScript的JSON数据。脚本首先获取DNSLog域名，替换post中的占位符，然后发送POST请求，并通过检查DNSLog记录来验证漏洞是否存在。利用方式：

1.  目标系统运行着Apache Druid 0.20.0或更早版本。
2.  攻击者能够通过网络访问Druid的indexer服务。
3.  攻击者运行提供的Wker脚本，输入目标Druid实例的URL。
4.  脚本发送包含恶意JavaScript代码的POST请求到/druid/indexer/v1/sampler。
5.  如果漏洞存在，Druid服务器将执行恶意JavaScript代码，并向DNSLog服务器发送DNS查询。
6.  脚本通过检查DNSLog记录来确认漏洞是否存在。
投毒风险分析：查看了仓库中的所有文件，包括主脚本和dns.wker。dns.wker主要功能是获取dnslog的域名和cookie，并查询dnslog的结果。主脚本将dnslog域名插入到payload中，发送到目标服务器，检测是否存在漏洞，根据dnslog的结果判断是否执行成功。并没有发现恶意代码，因此投毒风险为0%。

**项目地址:** [givemefivw/CVE-2021-25646](https://github.com/givemefivw/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #6

**来源**: [CVE-2021-25646-gps1949_CVE-2021-25646.md](../2021/CVE-2021-25646-gps1949_CVE-2021-25646.md)

## CVE-2021-25646 - Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许攻击者在Druid服务器上执行任意代码

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器版本为0.20.0或更早，并且攻击者需要具有一定的权限（Authenticated users）。 javascript未禁用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过发送特制的请求来覆盖系统配置，从而执行任意代码。漏洞利用代码通过构造包含恶意 JavaScript 代码的 POST 请求，利用 Druid 的索引器 sampler 功能，触发远程代码执行。

**漏洞利用方式：**

1.  攻击者首先需要获得Druid的身份验证。
2.  攻击者构造一个包含恶意 JavaScript 代码的 JSON 数据，该代码会被嵌入到 Druid 的 `sampler` 请求中。
3.  通过 POST 请求将构造好的 JSON 数据发送到 `/druid/indexer/v1/sampler` 接口。
4.  Druid 服务器解析请求，执行嵌入的 JavaScript 代码，从而实现远程代码执行。
5.  在提供的PoC代码中，通过`-u`指定URL，`-c`指定要执行的命令。PoC中提供了反弹shell的示例，先写入反弹shell脚本，赋予执行权限，然后执行shell脚本。

**有效性：**

根据漏洞信息和搜索引擎结果，此漏洞是真实存在的，并且PoC代码也有效，可以成功触发远程代码执行。

**投毒风险：**

该仓库的投毒风险较低，因为PoC代码比较简单，功能单一，主要实现了漏洞的利用。投毒风险主要来自以下几个方面：

*   **不明显的恶意代码：** 攻击者可能会在 JavaScript 代码中添加不明显的恶意代码，例如，在执行命令后，将服务器上的敏感数据发送到攻击者的服务器。
*   **依赖项：** 如果PoC依赖于外部库，这些库可能包含恶意代码。

总体而言，该PoC的投毒风险较低，约为5%。因为漏洞本身已经可以实现远程代码执行，没有必要增加额外的后门代码。


**项目地址:** [gps1949/CVE-2021-25646](https://github.com/gps1949/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #7

**来源**: [CVE-2021-25646-j2ekim_CVE-2021-25646.md](../2021/CVE-2021-25646-j2ekim_CVE-2021-25646.md)

# CVE-2021-25646

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-25646-1n7erface_PocList.md](../2021/CVE-2021-25646-1n7erface_PocList.md)

## CVE-2021-25646-Apache Druid-RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要身份验证（但可绕过配置），目标Druid版本<=0.20.0，且JavaScript执行功能未完全禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-25646允许经过身份验证的用户通过构造特制的请求来执行任意JavaScript代码，从而实现远程代码执行。即使服务器配置禁用了JavaScript功能，此漏洞仍然有效。利用方式主要通过发送包含恶意JavaScript代码的HTTP请求，利用Druid的配置覆盖机制来实现。从提供的代码片段来看，POC是存在的，作者声明项目中存在多个漏洞的POC。由于项目作者声明中存在对安全法的担忧，并且项目后期存在架构上的问题，无法保证提供的所有POC的有效性。因此，无法排除POC中存在隐藏的后门或者恶意代码的可能。但是其主动停止更新，说明存在主动规避风险的意愿，且主要目标是简化漏洞利用流程而非进行恶意活动。投毒风险较低，估计为10%。此漏洞的修复方案是升级到Druid 0.20.1或更高版本，并限制对集群机器的网络访问。

**项目地址:** [1n7erface/PocList](https://github.com/1n7erface/PocList)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #2

**来源**: [CVE-2021-25646-Ormicron_CVE-2021-25646-GUI.md](../2021/CVE-2021-25646-Ormicron_CVE-2021-25646-GUI.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标运行Druid 0.20.0及更早版本，且攻击者需要具备身份验证权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造特定的请求来覆盖系统配置，从而在 Apache Druid 服务器上执行任意代码。漏洞利用方式：

1.  **漏洞描述：** Apache Druid 包含执行用户提供的 JavaScript 代码的能力，该功能旨在用于高信任环境，默认情况下处于禁用状态。但是，在 Druid 0.20.0 及更早版本中，经过身份验证的用户可以发送特制的请求，强制 Druid 运行用户提供的 JavaScript 代码，而无需考虑服务器配置。
2.  **搜索引擎结果分析：** 大部分搜索结果都表明这是一个未经身份验证的 RCE 漏洞，这与漏洞库中的信息不符。漏洞库信息表明，该漏洞需要身份验证。
3.  **漏洞利用代码分析：** 提供的代码是 C# 的 Visual Studio 项目，看起来是一个用于利用此漏洞的程序。项目包含`Form1.cs`和`Program.cs`等文件，表明它可能是一个图形界面程序，用于构造和发送恶意请求。

    *   **有效性：** 根据漏洞信息和搜索结果，可以判断该漏洞是有效的，并且存在公开可用的利用代码。需要注意的是，漏洞利用需要身份验证，这一点与部分搜索结果不一致。提供的C#代码表明存在一种GUI利用方式。通过构造带有恶意JavaScript代码的HTTP请求利用漏洞。
    *   **投毒风险：**  提供的代码片段为 Visual Studio 项目文件和一些窗体相关的代码，并非完整的PoC代码，难以直接判断是否存在投毒代码。代码本身是用于利用漏洞的，如果攻击者修改了代码，例如在执行有效载荷之前或之后添加了其他恶意操作（例如，窃取凭据、安装后门、横向渗透），则可能存在投毒。根据已提供的代码片段，检测到恶意代码的概率较低，约为20%。
    *   **利用方式：** 攻击者需要首先获取 Druid 实例的有效身份验证凭据。然后，他们可以构造一个包含恶意 JavaScript 代码的 HTTP 请求，利用 Druid 的配置覆盖机制来执行该代码，从而获得服务器的控制权。攻击通常涉及向 Druid 服务器的特定端点（例如查询或数据摄取 API）发送包含恶意 JavaScript 代码的 JSON 载荷。

**项目地址:** [Ormicron/CVE-2021-25646-GUI](https://github.com/Ormicron/CVE-2021-25646-GUI)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #3

**来源**: [CVE-2021-25646-ShadowLance2_Apache-Druid-CVE-2021-25646-Exploit.md](../2021/CVE-2021-25646-ShadowLance2_Apache-Druid-CVE-2021-25646-Exploit.md)

## CVE-2021-25646-Apache Druid-RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务版本低于0.20.1，且攻击者需要具备一定程度的身份验证（即使是低权限用户）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-25646是Apache Druid中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许经过身份验证的用户通过构造特制的请求来执行任意JavaScript代码，从而在Druid服务器上以服务器进程的权限执行代码。即使服务器配置禁用了JavaScript执行，攻击者仍然可以通过此漏洞绕过限制。

**有效性：**
提供的PoC代码看起来是有效的。它利用了Druid的sampler接口，通过构造包含恶意JavaScript代码的JSON payload，尝试在目标系统上执行命令。代码中包含了命令转义，增加了成功利用的可能性。

**投毒风险：**
PoC代码中存在少量投毒风险。代码逻辑主要是构造payload，风险主要在于以下几点：

1.  **依赖安装风险：**`requirements.txt`文件如果包含恶意依赖，则存在投毒风险，但该PoC未使用`requirements.txt`而是直接提示安装`requests`库，风险较低。
2.  **请求库风险：**代码使用了`requests`库发送HTTP请求。如果该库被篡改，可能导致信息泄露或者其他安全问题，但这种情况发生的概率较低。
3.  **代码逻辑风险：** 代码中命令执行部分使用了`java.lang.Runtime.getRuntime().exec()`，如果攻击者修改了PoC，可能会尝试执行更危险的命令，但代码本身目标是执行用户指定的命令。

因此，综合来看，PoC本身包含的恶意代码概率较低，但如果被篡改，则可能存在风险，投毒风险评估为5%。

**利用方式：**
1.  攻击者需要知道目标Druid服务的URL。
2.  攻击者需要发送一个POST请求到`/druid/indexer/v1/sampler`端点。
3.  请求体需要是包含恶意JavaScript代码的JSON payload。这个payload会覆盖服务器配置，强制执行JavaScript代码。
4.  恶意JavaScript代码使用`java.lang.Runtime.getRuntime().exec()`来执行系统命令。
5.  服务器返回命令执行结果。

**项目地址:** [ShadowLance2/Apache-Druid-CVE-2021-25646-Exploit](https://github.com/ShadowLance2/Apache-Druid-CVE-2021-25646-Exploit)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #4

**来源**: [CVE-2021-25646-Vulnmachines_Apache-Druid-CVE-2021-25646.md](../2021/CVE-2021-25646-Vulnmachines_Apache-Druid-CVE-2021-25646.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器版本低于或等于0.20.0，且攻击者需要具有经过身份验证的访问权限（根据漏洞库信息）。但根据部分搜索结果，某些默认配置可能无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 漏洞允许经过身份验证的用户（或者在某些未授权配置下，未经身份验证的用户）通过发送特制的 HTTP 请求，在 Apache Druid 服务器上执行任意 JavaScript 代码，从而实现远程代码执行。  

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开的POC代码。提供的POC代码通过`POST /druid/indexer/v1/sampler?for=filter`发送包含恶意JavaScript代码的JSON数据，利用Druid的`filter`功能执行`wget`命令，下载恶意文件到`/tmp/hacked.txt`。因此，该POC代码是有效的。

**投毒风险分析：**
Payload.txt中的代码会尝试从攻击者的IP地址下载文件，存在潜在的投毒风险。攻击者可以替换文件内容，例如下载恶意的二进制文件或其他payload。README.md文件只是一个简单的说明，本身不包含恶意代码。

分析 Payload.txt 文件，其中的 JavaScript 代码旨在通过 `wget` 命令从 `IP/file` 下载文件到 `/tmp/hacked.txt`。这段代码本身不包含后门或者恶意逻辑，只是下载文件。但如果攻击者替换 `IP/file` 指向恶意文件，则可能造成投毒。

风险评估：
- **下载恶意文件:** 90% 的风险在于，攻击者可能会修改 `IP/file` 指向一个恶意的可执行文件、脚本或其他有害内容，导致受害者系统感染或被控制。
- **代码本身:** 代码本身（`wget IP/file -O /tmp/hacked.txt`）的恶意性只有 10%，因为这只是一个下载操作，恶意性取决于下载的内容。

**利用方式：**
1.  **身份验证：**  根据漏洞描述，默认需要首先通过Druid的身份验证机制。但是，需要注意的是，某些搜索结果表明，在某些默认配置下，Druid可能存在未授权访问的情况，无需身份验证即可利用此漏洞。
2.  **构造恶意请求：**  构造一个包含恶意JavaScript代码的JSON数据包，并将其发送到`/druid/indexer/v1/sampler?for=filter`端点。
3.  **代码执行：**  Druid服务器解析该请求，执行嵌入的JavaScript代码，从而实现远程代码执行。
4.  **利用 JavaScript 执行系统命令:** POC 利用 `java.lang.Runtime.getRuntime().exec()` 来执行系统命令 `wget IP/file -O /tmp/hacked.txt`。这里的核心是使用 Java 的 Runtime 对象来执行任意系统命令。

**总结：**
该漏洞利用方式简单，危害性高，利用代码有效，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [Vulnmachines/Apache-Druid-CVE-2021-25646](https://github.com/Vulnmachines/Apache-Druid-CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #5

**来源**: [CVE-2021-25646-givemefivw_CVE-2021-25646.md](../2021/CVE-2021-25646-givemefivw_CVE-2021-25646.md)

## CVE-2021-25646-ApacheDruid远程命令执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid实例版本小于等于0.20.0，且攻击者需要能够发送HTTP请求到Druid的indexer服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造恶意请求，绕过服务器配置执行任意JavaScript代码，从而导致远程代码执行。该漏洞利用方式主要是发送POST请求到/druid/indexer/v1/sampler接口，请求体包含精心构造的JSON数据，该数据中嵌入了恶意JavaScript代码。POC有效性分析：提供的POC代码使用Wker脚本编写，通过定义dir变量指定漏洞接口，post变量定义了包含恶意JavaScript的JSON数据。脚本首先获取DNSLog域名，替换post中的占位符，然后发送POST请求，并通过检查DNSLog记录来验证漏洞是否存在。利用方式：

1.  目标系统运行着Apache Druid 0.20.0或更早版本。
2.  攻击者能够通过网络访问Druid的indexer服务。
3.  攻击者运行提供的Wker脚本，输入目标Druid实例的URL。
4.  脚本发送包含恶意JavaScript代码的POST请求到/druid/indexer/v1/sampler。
5.  如果漏洞存在，Druid服务器将执行恶意JavaScript代码，并向DNSLog服务器发送DNS查询。
6.  脚本通过检查DNSLog记录来确认漏洞是否存在。
投毒风险分析：查看了仓库中的所有文件，包括主脚本和dns.wker。dns.wker主要功能是获取dnslog的域名和cookie，并查询dnslog的结果。主脚本将dnslog域名插入到payload中，发送到目标服务器，检测是否存在漏洞，根据dnslog的结果判断是否执行成功。并没有发现恶意代码，因此投毒风险为0%。

**项目地址:** [givemefivw/CVE-2021-25646](https://github.com/givemefivw/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #6

**来源**: [CVE-2021-25646-gps1949_CVE-2021-25646.md](../2021/CVE-2021-25646-gps1949_CVE-2021-25646.md)

## CVE-2021-25646 - Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许攻击者在Druid服务器上执行任意代码

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器版本为0.20.0或更早，并且攻击者需要具有一定的权限（Authenticated users）。 javascript未禁用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过发送特制的请求来覆盖系统配置，从而执行任意代码。漏洞利用代码通过构造包含恶意 JavaScript 代码的 POST 请求，利用 Druid 的索引器 sampler 功能，触发远程代码执行。

**漏洞利用方式：**

1.  攻击者首先需要获得Druid的身份验证。
2.  攻击者构造一个包含恶意 JavaScript 代码的 JSON 数据，该代码会被嵌入到 Druid 的 `sampler` 请求中。
3.  通过 POST 请求将构造好的 JSON 数据发送到 `/druid/indexer/v1/sampler` 接口。
4.  Druid 服务器解析请求，执行嵌入的 JavaScript 代码，从而实现远程代码执行。
5.  在提供的PoC代码中，通过`-u`指定URL，`-c`指定要执行的命令。PoC中提供了反弹shell的示例，先写入反弹shell脚本，赋予执行权限，然后执行shell脚本。

**有效性：**

根据漏洞信息和搜索引擎结果，此漏洞是真实存在的，并且PoC代码也有效，可以成功触发远程代码执行。

**投毒风险：**

该仓库的投毒风险较低，因为PoC代码比较简单，功能单一，主要实现了漏洞的利用。投毒风险主要来自以下几个方面：

*   **不明显的恶意代码：** 攻击者可能会在 JavaScript 代码中添加不明显的恶意代码，例如，在执行命令后，将服务器上的敏感数据发送到攻击者的服务器。
*   **依赖项：** 如果PoC依赖于外部库，这些库可能包含恶意代码。

总体而言，该PoC的投毒风险较低，约为5%。因为漏洞本身已经可以实现远程代码执行，没有必要增加额外的后门代码。


**项目地址:** [gps1949/CVE-2021-25646](https://github.com/gps1949/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #7

**来源**: [CVE-2021-25646-j2ekim_CVE-2021-25646.md](../2021/CVE-2021-25646-j2ekim_CVE-2021-25646.md)

# CVE-2021-25646

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-25646-1n7erface_PocList.md](../2021/CVE-2021-25646-1n7erface_PocList.md)

## CVE-2021-25646-Apache Druid-RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要身份验证（但可绕过配置），目标Druid版本<=0.20.0，且JavaScript执行功能未完全禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-25646允许经过身份验证的用户通过构造特制的请求来执行任意JavaScript代码，从而实现远程代码执行。即使服务器配置禁用了JavaScript功能，此漏洞仍然有效。利用方式主要通过发送包含恶意JavaScript代码的HTTP请求，利用Druid的配置覆盖机制来实现。从提供的代码片段来看，POC是存在的，作者声明项目中存在多个漏洞的POC。由于项目作者声明中存在对安全法的担忧，并且项目后期存在架构上的问题，无法保证提供的所有POC的有效性。因此，无法排除POC中存在隐藏的后门或者恶意代码的可能。但是其主动停止更新，说明存在主动规避风险的意愿，且主要目标是简化漏洞利用流程而非进行恶意活动。投毒风险较低，估计为10%。此漏洞的修复方案是升级到Druid 0.20.1或更高版本，并限制对集群机器的网络访问。

**项目地址:** [1n7erface/PocList](https://github.com/1n7erface/PocList)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #2

**来源**: [CVE-2021-25646-Ormicron_CVE-2021-25646-GUI.md](../2021/CVE-2021-25646-Ormicron_CVE-2021-25646-GUI.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标运行Druid 0.20.0及更早版本，且攻击者需要具备身份验证权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造特定的请求来覆盖系统配置，从而在 Apache Druid 服务器上执行任意代码。漏洞利用方式：

1.  **漏洞描述：** Apache Druid 包含执行用户提供的 JavaScript 代码的能力，该功能旨在用于高信任环境，默认情况下处于禁用状态。但是，在 Druid 0.20.0 及更早版本中，经过身份验证的用户可以发送特制的请求，强制 Druid 运行用户提供的 JavaScript 代码，而无需考虑服务器配置。
2.  **搜索引擎结果分析：** 大部分搜索结果都表明这是一个未经身份验证的 RCE 漏洞，这与漏洞库中的信息不符。漏洞库信息表明，该漏洞需要身份验证。
3.  **漏洞利用代码分析：** 提供的代码是 C# 的 Visual Studio 项目，看起来是一个用于利用此漏洞的程序。项目包含`Form1.cs`和`Program.cs`等文件，表明它可能是一个图形界面程序，用于构造和发送恶意请求。

    *   **有效性：** 根据漏洞信息和搜索结果，可以判断该漏洞是有效的，并且存在公开可用的利用代码。需要注意的是，漏洞利用需要身份验证，这一点与部分搜索结果不一致。提供的C#代码表明存在一种GUI利用方式。通过构造带有恶意JavaScript代码的HTTP请求利用漏洞。
    *   **投毒风险：**  提供的代码片段为 Visual Studio 项目文件和一些窗体相关的代码，并非完整的PoC代码，难以直接判断是否存在投毒代码。代码本身是用于利用漏洞的，如果攻击者修改了代码，例如在执行有效载荷之前或之后添加了其他恶意操作（例如，窃取凭据、安装后门、横向渗透），则可能存在投毒。根据已提供的代码片段，检测到恶意代码的概率较低，约为20%。
    *   **利用方式：** 攻击者需要首先获取 Druid 实例的有效身份验证凭据。然后，他们可以构造一个包含恶意 JavaScript 代码的 HTTP 请求，利用 Druid 的配置覆盖机制来执行该代码，从而获得服务器的控制权。攻击通常涉及向 Druid 服务器的特定端点（例如查询或数据摄取 API）发送包含恶意 JavaScript 代码的 JSON 载荷。

**项目地址:** [Ormicron/CVE-2021-25646-GUI](https://github.com/Ormicron/CVE-2021-25646-GUI)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #3

**来源**: [CVE-2021-25646-ShadowLance2_Apache-Druid-CVE-2021-25646-Exploit.md](../2021/CVE-2021-25646-ShadowLance2_Apache-Druid-CVE-2021-25646-Exploit.md)

## CVE-2021-25646-Apache Druid-RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务版本低于0.20.1，且攻击者需要具备一定程度的身份验证（即使是低权限用户）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-25646是Apache Druid中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许经过身份验证的用户通过构造特制的请求来执行任意JavaScript代码，从而在Druid服务器上以服务器进程的权限执行代码。即使服务器配置禁用了JavaScript执行，攻击者仍然可以通过此漏洞绕过限制。

**有效性：**
提供的PoC代码看起来是有效的。它利用了Druid的sampler接口，通过构造包含恶意JavaScript代码的JSON payload，尝试在目标系统上执行命令。代码中包含了命令转义，增加了成功利用的可能性。

**投毒风险：**
PoC代码中存在少量投毒风险。代码逻辑主要是构造payload，风险主要在于以下几点：

1.  **依赖安装风险：**`requirements.txt`文件如果包含恶意依赖，则存在投毒风险，但该PoC未使用`requirements.txt`而是直接提示安装`requests`库，风险较低。
2.  **请求库风险：**代码使用了`requests`库发送HTTP请求。如果该库被篡改，可能导致信息泄露或者其他安全问题，但这种情况发生的概率较低。
3.  **代码逻辑风险：** 代码中命令执行部分使用了`java.lang.Runtime.getRuntime().exec()`，如果攻击者修改了PoC，可能会尝试执行更危险的命令，但代码本身目标是执行用户指定的命令。

因此，综合来看，PoC本身包含的恶意代码概率较低，但如果被篡改，则可能存在风险，投毒风险评估为5%。

**利用方式：**
1.  攻击者需要知道目标Druid服务的URL。
2.  攻击者需要发送一个POST请求到`/druid/indexer/v1/sampler`端点。
3.  请求体需要是包含恶意JavaScript代码的JSON payload。这个payload会覆盖服务器配置，强制执行JavaScript代码。
4.  恶意JavaScript代码使用`java.lang.Runtime.getRuntime().exec()`来执行系统命令。
5.  服务器返回命令执行结果。

**项目地址:** [ShadowLance2/Apache-Druid-CVE-2021-25646-Exploit](https://github.com/ShadowLance2/Apache-Druid-CVE-2021-25646-Exploit)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #4

**来源**: [CVE-2021-25646-Vulnmachines_Apache-Druid-CVE-2021-25646.md](../2021/CVE-2021-25646-Vulnmachines_Apache-Druid-CVE-2021-25646.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器版本低于或等于0.20.0，且攻击者需要具有经过身份验证的访问权限（根据漏洞库信息）。但根据部分搜索结果，某些默认配置可能无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 漏洞允许经过身份验证的用户（或者在某些未授权配置下，未经身份验证的用户）通过发送特制的 HTTP 请求，在 Apache Druid 服务器上执行任意 JavaScript 代码，从而实现远程代码执行。  

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开的POC代码。提供的POC代码通过`POST /druid/indexer/v1/sampler?for=filter`发送包含恶意JavaScript代码的JSON数据，利用Druid的`filter`功能执行`wget`命令，下载恶意文件到`/tmp/hacked.txt`。因此，该POC代码是有效的。

**投毒风险分析：**
Payload.txt中的代码会尝试从攻击者的IP地址下载文件，存在潜在的投毒风险。攻击者可以替换文件内容，例如下载恶意的二进制文件或其他payload。README.md文件只是一个简单的说明，本身不包含恶意代码。

分析 Payload.txt 文件，其中的 JavaScript 代码旨在通过 `wget` 命令从 `IP/file` 下载文件到 `/tmp/hacked.txt`。这段代码本身不包含后门或者恶意逻辑，只是下载文件。但如果攻击者替换 `IP/file` 指向恶意文件，则可能造成投毒。

风险评估：
- **下载恶意文件:** 90% 的风险在于，攻击者可能会修改 `IP/file` 指向一个恶意的可执行文件、脚本或其他有害内容，导致受害者系统感染或被控制。
- **代码本身:** 代码本身（`wget IP/file -O /tmp/hacked.txt`）的恶意性只有 10%，因为这只是一个下载操作，恶意性取决于下载的内容。

**利用方式：**
1.  **身份验证：**  根据漏洞描述，默认需要首先通过Druid的身份验证机制。但是，需要注意的是，某些搜索结果表明，在某些默认配置下，Druid可能存在未授权访问的情况，无需身份验证即可利用此漏洞。
2.  **构造恶意请求：**  构造一个包含恶意JavaScript代码的JSON数据包，并将其发送到`/druid/indexer/v1/sampler?for=filter`端点。
3.  **代码执行：**  Druid服务器解析该请求，执行嵌入的JavaScript代码，从而实现远程代码执行。
4.  **利用 JavaScript 执行系统命令:** POC 利用 `java.lang.Runtime.getRuntime().exec()` 来执行系统命令 `wget IP/file -O /tmp/hacked.txt`。这里的核心是使用 Java 的 Runtime 对象来执行任意系统命令。

**总结：**
该漏洞利用方式简单，危害性高，利用代码有效，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [Vulnmachines/Apache-Druid-CVE-2021-25646](https://github.com/Vulnmachines/Apache-Druid-CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #5

**来源**: [CVE-2021-25646-givemefivw_CVE-2021-25646.md](../2021/CVE-2021-25646-givemefivw_CVE-2021-25646.md)

## CVE-2021-25646-ApacheDruid远程命令执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid实例版本小于等于0.20.0，且攻击者需要能够发送HTTP请求到Druid的indexer服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造恶意请求，绕过服务器配置执行任意JavaScript代码，从而导致远程代码执行。该漏洞利用方式主要是发送POST请求到/druid/indexer/v1/sampler接口，请求体包含精心构造的JSON数据，该数据中嵌入了恶意JavaScript代码。POC有效性分析：提供的POC代码使用Wker脚本编写，通过定义dir变量指定漏洞接口，post变量定义了包含恶意JavaScript的JSON数据。脚本首先获取DNSLog域名，替换post中的占位符，然后发送POST请求，并通过检查DNSLog记录来验证漏洞是否存在。利用方式：

1.  目标系统运行着Apache Druid 0.20.0或更早版本。
2.  攻击者能够通过网络访问Druid的indexer服务。
3.  攻击者运行提供的Wker脚本，输入目标Druid实例的URL。
4.  脚本发送包含恶意JavaScript代码的POST请求到/druid/indexer/v1/sampler。
5.  如果漏洞存在，Druid服务器将执行恶意JavaScript代码，并向DNSLog服务器发送DNS查询。
6.  脚本通过检查DNSLog记录来确认漏洞是否存在。
投毒风险分析：查看了仓库中的所有文件，包括主脚本和dns.wker。dns.wker主要功能是获取dnslog的域名和cookie，并查询dnslog的结果。主脚本将dnslog域名插入到payload中，发送到目标服务器，检测是否存在漏洞，根据dnslog的结果判断是否执行成功。并没有发现恶意代码，因此投毒风险为0%。

**项目地址:** [givemefivw/CVE-2021-25646](https://github.com/givemefivw/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #6

**来源**: [CVE-2021-25646-gps1949_CVE-2021-25646.md](../2021/CVE-2021-25646-gps1949_CVE-2021-25646.md)

## CVE-2021-25646 - Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许攻击者在Druid服务器上执行任意代码

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器版本为0.20.0或更早，并且攻击者需要具有一定的权限（Authenticated users）。 javascript未禁用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过发送特制的请求来覆盖系统配置，从而执行任意代码。漏洞利用代码通过构造包含恶意 JavaScript 代码的 POST 请求，利用 Druid 的索引器 sampler 功能，触发远程代码执行。

**漏洞利用方式：**

1.  攻击者首先需要获得Druid的身份验证。
2.  攻击者构造一个包含恶意 JavaScript 代码的 JSON 数据，该代码会被嵌入到 Druid 的 `sampler` 请求中。
3.  通过 POST 请求将构造好的 JSON 数据发送到 `/druid/indexer/v1/sampler` 接口。
4.  Druid 服务器解析请求，执行嵌入的 JavaScript 代码，从而实现远程代码执行。
5.  在提供的PoC代码中，通过`-u`指定URL，`-c`指定要执行的命令。PoC中提供了反弹shell的示例，先写入反弹shell脚本，赋予执行权限，然后执行shell脚本。

**有效性：**

根据漏洞信息和搜索引擎结果，此漏洞是真实存在的，并且PoC代码也有效，可以成功触发远程代码执行。

**投毒风险：**

该仓库的投毒风险较低，因为PoC代码比较简单，功能单一，主要实现了漏洞的利用。投毒风险主要来自以下几个方面：

*   **不明显的恶意代码：** 攻击者可能会在 JavaScript 代码中添加不明显的恶意代码，例如，在执行命令后，将服务器上的敏感数据发送到攻击者的服务器。
*   **依赖项：** 如果PoC依赖于外部库，这些库可能包含恶意代码。

总体而言，该PoC的投毒风险较低，约为5%。因为漏洞本身已经可以实现远程代码执行，没有必要增加额外的后门代码。


**项目地址:** [gps1949/CVE-2021-25646](https://github.com/gps1949/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #7

**来源**: [CVE-2021-25646-j2ekim_CVE-2021-25646.md](../2021/CVE-2021-25646-j2ekim_CVE-2021-25646.md)

# CVE-2021-25646

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-25646-1n7erface_PocList.md](../2021/CVE-2021-25646-1n7erface_PocList.md)

## CVE-2021-25646-Apache Druid-RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要身份验证（但可绕过配置），目标Druid版本<=0.20.0，且JavaScript执行功能未完全禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-25646允许经过身份验证的用户通过构造特制的请求来执行任意JavaScript代码，从而实现远程代码执行。即使服务器配置禁用了JavaScript功能，此漏洞仍然有效。利用方式主要通过发送包含恶意JavaScript代码的HTTP请求，利用Druid的配置覆盖机制来实现。从提供的代码片段来看，POC是存在的，作者声明项目中存在多个漏洞的POC。由于项目作者声明中存在对安全法的担忧，并且项目后期存在架构上的问题，无法保证提供的所有POC的有效性。因此，无法排除POC中存在隐藏的后门或者恶意代码的可能。但是其主动停止更新，说明存在主动规避风险的意愿，且主要目标是简化漏洞利用流程而非进行恶意活动。投毒风险较低，估计为10%。此漏洞的修复方案是升级到Druid 0.20.1或更高版本，并限制对集群机器的网络访问。

**项目地址:** [1n7erface/PocList](https://github.com/1n7erface/PocList)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #2

**来源**: [CVE-2021-25646-Ormicron_CVE-2021-25646-GUI.md](../2021/CVE-2021-25646-Ormicron_CVE-2021-25646-GUI.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标运行Druid 0.20.0及更早版本，且攻击者需要具备身份验证权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造特定的请求来覆盖系统配置，从而在 Apache Druid 服务器上执行任意代码。漏洞利用方式：

1.  **漏洞描述：** Apache Druid 包含执行用户提供的 JavaScript 代码的能力，该功能旨在用于高信任环境，默认情况下处于禁用状态。但是，在 Druid 0.20.0 及更早版本中，经过身份验证的用户可以发送特制的请求，强制 Druid 运行用户提供的 JavaScript 代码，而无需考虑服务器配置。
2.  **搜索引擎结果分析：** 大部分搜索结果都表明这是一个未经身份验证的 RCE 漏洞，这与漏洞库中的信息不符。漏洞库信息表明，该漏洞需要身份验证。
3.  **漏洞利用代码分析：** 提供的代码是 C# 的 Visual Studio 项目，看起来是一个用于利用此漏洞的程序。项目包含`Form1.cs`和`Program.cs`等文件，表明它可能是一个图形界面程序，用于构造和发送恶意请求。

    *   **有效性：** 根据漏洞信息和搜索结果，可以判断该漏洞是有效的，并且存在公开可用的利用代码。需要注意的是，漏洞利用需要身份验证，这一点与部分搜索结果不一致。提供的C#代码表明存在一种GUI利用方式。通过构造带有恶意JavaScript代码的HTTP请求利用漏洞。
    *   **投毒风险：**  提供的代码片段为 Visual Studio 项目文件和一些窗体相关的代码，并非完整的PoC代码，难以直接判断是否存在投毒代码。代码本身是用于利用漏洞的，如果攻击者修改了代码，例如在执行有效载荷之前或之后添加了其他恶意操作（例如，窃取凭据、安装后门、横向渗透），则可能存在投毒。根据已提供的代码片段，检测到恶意代码的概率较低，约为20%。
    *   **利用方式：** 攻击者需要首先获取 Druid 实例的有效身份验证凭据。然后，他们可以构造一个包含恶意 JavaScript 代码的 HTTP 请求，利用 Druid 的配置覆盖机制来执行该代码，从而获得服务器的控制权。攻击通常涉及向 Druid 服务器的特定端点（例如查询或数据摄取 API）发送包含恶意 JavaScript 代码的 JSON 载荷。

**项目地址:** [Ormicron/CVE-2021-25646-GUI](https://github.com/Ormicron/CVE-2021-25646-GUI)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #3

**来源**: [CVE-2021-25646-ShadowLance2_Apache-Druid-CVE-2021-25646-Exploit.md](../2021/CVE-2021-25646-ShadowLance2_Apache-Druid-CVE-2021-25646-Exploit.md)

## CVE-2021-25646-Apache Druid-RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务版本低于0.20.1，且攻击者需要具备一定程度的身份验证（即使是低权限用户）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-25646是Apache Druid中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许经过身份验证的用户通过构造特制的请求来执行任意JavaScript代码，从而在Druid服务器上以服务器进程的权限执行代码。即使服务器配置禁用了JavaScript执行，攻击者仍然可以通过此漏洞绕过限制。

**有效性：**
提供的PoC代码看起来是有效的。它利用了Druid的sampler接口，通过构造包含恶意JavaScript代码的JSON payload，尝试在目标系统上执行命令。代码中包含了命令转义，增加了成功利用的可能性。

**投毒风险：**
PoC代码中存在少量投毒风险。代码逻辑主要是构造payload，风险主要在于以下几点：

1.  **依赖安装风险：**`requirements.txt`文件如果包含恶意依赖，则存在投毒风险，但该PoC未使用`requirements.txt`而是直接提示安装`requests`库，风险较低。
2.  **请求库风险：**代码使用了`requests`库发送HTTP请求。如果该库被篡改，可能导致信息泄露或者其他安全问题，但这种情况发生的概率较低。
3.  **代码逻辑风险：** 代码中命令执行部分使用了`java.lang.Runtime.getRuntime().exec()`，如果攻击者修改了PoC，可能会尝试执行更危险的命令，但代码本身目标是执行用户指定的命令。

因此，综合来看，PoC本身包含的恶意代码概率较低，但如果被篡改，则可能存在风险，投毒风险评估为5%。

**利用方式：**
1.  攻击者需要知道目标Druid服务的URL。
2.  攻击者需要发送一个POST请求到`/druid/indexer/v1/sampler`端点。
3.  请求体需要是包含恶意JavaScript代码的JSON payload。这个payload会覆盖服务器配置，强制执行JavaScript代码。
4.  恶意JavaScript代码使用`java.lang.Runtime.getRuntime().exec()`来执行系统命令。
5.  服务器返回命令执行结果。

**项目地址:** [ShadowLance2/Apache-Druid-CVE-2021-25646-Exploit](https://github.com/ShadowLance2/Apache-Druid-CVE-2021-25646-Exploit)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #4

**来源**: [CVE-2021-25646-Vulnmachines_Apache-Druid-CVE-2021-25646.md](../2021/CVE-2021-25646-Vulnmachines_Apache-Druid-CVE-2021-25646.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器版本低于或等于0.20.0，且攻击者需要具有经过身份验证的访问权限（根据漏洞库信息）。但根据部分搜索结果，某些默认配置可能无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 漏洞允许经过身份验证的用户（或者在某些未授权配置下，未经身份验证的用户）通过发送特制的 HTTP 请求，在 Apache Druid 服务器上执行任意 JavaScript 代码，从而实现远程代码执行。  

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开的POC代码。提供的POC代码通过`POST /druid/indexer/v1/sampler?for=filter`发送包含恶意JavaScript代码的JSON数据，利用Druid的`filter`功能执行`wget`命令，下载恶意文件到`/tmp/hacked.txt`。因此，该POC代码是有效的。

**投毒风险分析：**
Payload.txt中的代码会尝试从攻击者的IP地址下载文件，存在潜在的投毒风险。攻击者可以替换文件内容，例如下载恶意的二进制文件或其他payload。README.md文件只是一个简单的说明，本身不包含恶意代码。

分析 Payload.txt 文件，其中的 JavaScript 代码旨在通过 `wget` 命令从 `IP/file` 下载文件到 `/tmp/hacked.txt`。这段代码本身不包含后门或者恶意逻辑，只是下载文件。但如果攻击者替换 `IP/file` 指向恶意文件，则可能造成投毒。

风险评估：
- **下载恶意文件:** 90% 的风险在于，攻击者可能会修改 `IP/file` 指向一个恶意的可执行文件、脚本或其他有害内容，导致受害者系统感染或被控制。
- **代码本身:** 代码本身（`wget IP/file -O /tmp/hacked.txt`）的恶意性只有 10%，因为这只是一个下载操作，恶意性取决于下载的内容。

**利用方式：**
1.  **身份验证：**  根据漏洞描述，默认需要首先通过Druid的身份验证机制。但是，需要注意的是，某些搜索结果表明，在某些默认配置下，Druid可能存在未授权访问的情况，无需身份验证即可利用此漏洞。
2.  **构造恶意请求：**  构造一个包含恶意JavaScript代码的JSON数据包，并将其发送到`/druid/indexer/v1/sampler?for=filter`端点。
3.  **代码执行：**  Druid服务器解析该请求，执行嵌入的JavaScript代码，从而实现远程代码执行。
4.  **利用 JavaScript 执行系统命令:** POC 利用 `java.lang.Runtime.getRuntime().exec()` 来执行系统命令 `wget IP/file -O /tmp/hacked.txt`。这里的核心是使用 Java 的 Runtime 对象来执行任意系统命令。

**总结：**
该漏洞利用方式简单，危害性高，利用代码有效，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [Vulnmachines/Apache-Druid-CVE-2021-25646](https://github.com/Vulnmachines/Apache-Druid-CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #5

**来源**: [CVE-2021-25646-givemefivw_CVE-2021-25646.md](../2021/CVE-2021-25646-givemefivw_CVE-2021-25646.md)

## CVE-2021-25646-ApacheDruid远程命令执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid实例版本小于等于0.20.0，且攻击者需要能够发送HTTP请求到Druid的indexer服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造恶意请求，绕过服务器配置执行任意JavaScript代码，从而导致远程代码执行。该漏洞利用方式主要是发送POST请求到/druid/indexer/v1/sampler接口，请求体包含精心构造的JSON数据，该数据中嵌入了恶意JavaScript代码。POC有效性分析：提供的POC代码使用Wker脚本编写，通过定义dir变量指定漏洞接口，post变量定义了包含恶意JavaScript的JSON数据。脚本首先获取DNSLog域名，替换post中的占位符，然后发送POST请求，并通过检查DNSLog记录来验证漏洞是否存在。利用方式：

1.  目标系统运行着Apache Druid 0.20.0或更早版本。
2.  攻击者能够通过网络访问Druid的indexer服务。
3.  攻击者运行提供的Wker脚本，输入目标Druid实例的URL。
4.  脚本发送包含恶意JavaScript代码的POST请求到/druid/indexer/v1/sampler。
5.  如果漏洞存在，Druid服务器将执行恶意JavaScript代码，并向DNSLog服务器发送DNS查询。
6.  脚本通过检查DNSLog记录来确认漏洞是否存在。
投毒风险分析：查看了仓库中的所有文件，包括主脚本和dns.wker。dns.wker主要功能是获取dnslog的域名和cookie，并查询dnslog的结果。主脚本将dnslog域名插入到payload中，发送到目标服务器，检测是否存在漏洞，根据dnslog的结果判断是否执行成功。并没有发现恶意代码，因此投毒风险为0%。

**项目地址:** [givemefivw/CVE-2021-25646](https://github.com/givemefivw/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #6

**来源**: [CVE-2021-25646-gps1949_CVE-2021-25646.md](../2021/CVE-2021-25646-gps1949_CVE-2021-25646.md)

## CVE-2021-25646 - Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许攻击者在Druid服务器上执行任意代码

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器版本为0.20.0或更早，并且攻击者需要具有一定的权限（Authenticated users）。 javascript未禁用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过发送特制的请求来覆盖系统配置，从而执行任意代码。漏洞利用代码通过构造包含恶意 JavaScript 代码的 POST 请求，利用 Druid 的索引器 sampler 功能，触发远程代码执行。

**漏洞利用方式：**

1.  攻击者首先需要获得Druid的身份验证。
2.  攻击者构造一个包含恶意 JavaScript 代码的 JSON 数据，该代码会被嵌入到 Druid 的 `sampler` 请求中。
3.  通过 POST 请求将构造好的 JSON 数据发送到 `/druid/indexer/v1/sampler` 接口。
4.  Druid 服务器解析请求，执行嵌入的 JavaScript 代码，从而实现远程代码执行。
5.  在提供的PoC代码中，通过`-u`指定URL，`-c`指定要执行的命令。PoC中提供了反弹shell的示例，先写入反弹shell脚本，赋予执行权限，然后执行shell脚本。

**有效性：**

根据漏洞信息和搜索引擎结果，此漏洞是真实存在的，并且PoC代码也有效，可以成功触发远程代码执行。

**投毒风险：**

该仓库的投毒风险较低，因为PoC代码比较简单，功能单一，主要实现了漏洞的利用。投毒风险主要来自以下几个方面：

*   **不明显的恶意代码：** 攻击者可能会在 JavaScript 代码中添加不明显的恶意代码，例如，在执行命令后，将服务器上的敏感数据发送到攻击者的服务器。
*   **依赖项：** 如果PoC依赖于外部库，这些库可能包含恶意代码。

总体而言，该PoC的投毒风险较低，约为5%。因为漏洞本身已经可以实现远程代码执行，没有必要增加额外的后门代码。


**项目地址:** [gps1949/CVE-2021-25646](https://github.com/gps1949/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #7

**来源**: [CVE-2021-25646-j2ekim_CVE-2021-25646.md](../2021/CVE-2021-25646-j2ekim_CVE-2021-25646.md)

# CVE-2021-25646

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-25646-1n7erface_PocList.md](../2021/CVE-2021-25646-1n7erface_PocList.md)

## CVE-2021-25646-Apache Druid-RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要身份验证（但可绕过配置），目标Druid版本<=0.20.0，且JavaScript执行功能未完全禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-25646允许经过身份验证的用户通过构造特制的请求来执行任意JavaScript代码，从而实现远程代码执行。即使服务器配置禁用了JavaScript功能，此漏洞仍然有效。利用方式主要通过发送包含恶意JavaScript代码的HTTP请求，利用Druid的配置覆盖机制来实现。从提供的代码片段来看，POC是存在的，作者声明项目中存在多个漏洞的POC。由于项目作者声明中存在对安全法的担忧，并且项目后期存在架构上的问题，无法保证提供的所有POC的有效性。因此，无法排除POC中存在隐藏的后门或者恶意代码的可能。但是其主动停止更新，说明存在主动规避风险的意愿，且主要目标是简化漏洞利用流程而非进行恶意活动。投毒风险较低，估计为10%。此漏洞的修复方案是升级到Druid 0.20.1或更高版本，并限制对集群机器的网络访问。

**项目地址:** [1n7erface/PocList](https://github.com/1n7erface/PocList)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #2

**来源**: [CVE-2021-25646-Ormicron_CVE-2021-25646-GUI.md](../2021/CVE-2021-25646-Ormicron_CVE-2021-25646-GUI.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标运行Druid 0.20.0及更早版本，且攻击者需要具备身份验证权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造特定的请求来覆盖系统配置，从而在 Apache Druid 服务器上执行任意代码。漏洞利用方式：

1.  **漏洞描述：** Apache Druid 包含执行用户提供的 JavaScript 代码的能力，该功能旨在用于高信任环境，默认情况下处于禁用状态。但是，在 Druid 0.20.0 及更早版本中，经过身份验证的用户可以发送特制的请求，强制 Druid 运行用户提供的 JavaScript 代码，而无需考虑服务器配置。
2.  **搜索引擎结果分析：** 大部分搜索结果都表明这是一个未经身份验证的 RCE 漏洞，这与漏洞库中的信息不符。漏洞库信息表明，该漏洞需要身份验证。
3.  **漏洞利用代码分析：** 提供的代码是 C# 的 Visual Studio 项目，看起来是一个用于利用此漏洞的程序。项目包含`Form1.cs`和`Program.cs`等文件，表明它可能是一个图形界面程序，用于构造和发送恶意请求。

    *   **有效性：** 根据漏洞信息和搜索结果，可以判断该漏洞是有效的，并且存在公开可用的利用代码。需要注意的是，漏洞利用需要身份验证，这一点与部分搜索结果不一致。提供的C#代码表明存在一种GUI利用方式。通过构造带有恶意JavaScript代码的HTTP请求利用漏洞。
    *   **投毒风险：**  提供的代码片段为 Visual Studio 项目文件和一些窗体相关的代码，并非完整的PoC代码，难以直接判断是否存在投毒代码。代码本身是用于利用漏洞的，如果攻击者修改了代码，例如在执行有效载荷之前或之后添加了其他恶意操作（例如，窃取凭据、安装后门、横向渗透），则可能存在投毒。根据已提供的代码片段，检测到恶意代码的概率较低，约为20%。
    *   **利用方式：** 攻击者需要首先获取 Druid 实例的有效身份验证凭据。然后，他们可以构造一个包含恶意 JavaScript 代码的 HTTP 请求，利用 Druid 的配置覆盖机制来执行该代码，从而获得服务器的控制权。攻击通常涉及向 Druid 服务器的特定端点（例如查询或数据摄取 API）发送包含恶意 JavaScript 代码的 JSON 载荷。

**项目地址:** [Ormicron/CVE-2021-25646-GUI](https://github.com/Ormicron/CVE-2021-25646-GUI)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #3

**来源**: [CVE-2021-25646-ShadowLance2_Apache-Druid-CVE-2021-25646-Exploit.md](../2021/CVE-2021-25646-ShadowLance2_Apache-Druid-CVE-2021-25646-Exploit.md)

## CVE-2021-25646-Apache Druid-RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务版本低于0.20.1，且攻击者需要具备一定程度的身份验证（即使是低权限用户）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-25646是Apache Druid中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许经过身份验证的用户通过构造特制的请求来执行任意JavaScript代码，从而在Druid服务器上以服务器进程的权限执行代码。即使服务器配置禁用了JavaScript执行，攻击者仍然可以通过此漏洞绕过限制。

**有效性：**
提供的PoC代码看起来是有效的。它利用了Druid的sampler接口，通过构造包含恶意JavaScript代码的JSON payload，尝试在目标系统上执行命令。代码中包含了命令转义，增加了成功利用的可能性。

**投毒风险：**
PoC代码中存在少量投毒风险。代码逻辑主要是构造payload，风险主要在于以下几点：

1.  **依赖安装风险：**`requirements.txt`文件如果包含恶意依赖，则存在投毒风险，但该PoC未使用`requirements.txt`而是直接提示安装`requests`库，风险较低。
2.  **请求库风险：**代码使用了`requests`库发送HTTP请求。如果该库被篡改，可能导致信息泄露或者其他安全问题，但这种情况发生的概率较低。
3.  **代码逻辑风险：** 代码中命令执行部分使用了`java.lang.Runtime.getRuntime().exec()`，如果攻击者修改了PoC，可能会尝试执行更危险的命令，但代码本身目标是执行用户指定的命令。

因此，综合来看，PoC本身包含的恶意代码概率较低，但如果被篡改，则可能存在风险，投毒风险评估为5%。

**利用方式：**
1.  攻击者需要知道目标Druid服务的URL。
2.  攻击者需要发送一个POST请求到`/druid/indexer/v1/sampler`端点。
3.  请求体需要是包含恶意JavaScript代码的JSON payload。这个payload会覆盖服务器配置，强制执行JavaScript代码。
4.  恶意JavaScript代码使用`java.lang.Runtime.getRuntime().exec()`来执行系统命令。
5.  服务器返回命令执行结果。

**项目地址:** [ShadowLance2/Apache-Druid-CVE-2021-25646-Exploit](https://github.com/ShadowLance2/Apache-Druid-CVE-2021-25646-Exploit)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #4

**来源**: [CVE-2021-25646-Vulnmachines_Apache-Druid-CVE-2021-25646.md](../2021/CVE-2021-25646-Vulnmachines_Apache-Druid-CVE-2021-25646.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器版本低于或等于0.20.0，且攻击者需要具有经过身份验证的访问权限（根据漏洞库信息）。但根据部分搜索结果，某些默认配置可能无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 漏洞允许经过身份验证的用户（或者在某些未授权配置下，未经身份验证的用户）通过发送特制的 HTTP 请求，在 Apache Druid 服务器上执行任意 JavaScript 代码，从而实现远程代码执行。  

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开的POC代码。提供的POC代码通过`POST /druid/indexer/v1/sampler?for=filter`发送包含恶意JavaScript代码的JSON数据，利用Druid的`filter`功能执行`wget`命令，下载恶意文件到`/tmp/hacked.txt`。因此，该POC代码是有效的。

**投毒风险分析：**
Payload.txt中的代码会尝试从攻击者的IP地址下载文件，存在潜在的投毒风险。攻击者可以替换文件内容，例如下载恶意的二进制文件或其他payload。README.md文件只是一个简单的说明，本身不包含恶意代码。

分析 Payload.txt 文件，其中的 JavaScript 代码旨在通过 `wget` 命令从 `IP/file` 下载文件到 `/tmp/hacked.txt`。这段代码本身不包含后门或者恶意逻辑，只是下载文件。但如果攻击者替换 `IP/file` 指向恶意文件，则可能造成投毒。

风险评估：
- **下载恶意文件:** 90% 的风险在于，攻击者可能会修改 `IP/file` 指向一个恶意的可执行文件、脚本或其他有害内容，导致受害者系统感染或被控制。
- **代码本身:** 代码本身（`wget IP/file -O /tmp/hacked.txt`）的恶意性只有 10%，因为这只是一个下载操作，恶意性取决于下载的内容。

**利用方式：**
1.  **身份验证：**  根据漏洞描述，默认需要首先通过Druid的身份验证机制。但是，需要注意的是，某些搜索结果表明，在某些默认配置下，Druid可能存在未授权访问的情况，无需身份验证即可利用此漏洞。
2.  **构造恶意请求：**  构造一个包含恶意JavaScript代码的JSON数据包，并将其发送到`/druid/indexer/v1/sampler?for=filter`端点。
3.  **代码执行：**  Druid服务器解析该请求，执行嵌入的JavaScript代码，从而实现远程代码执行。
4.  **利用 JavaScript 执行系统命令:** POC 利用 `java.lang.Runtime.getRuntime().exec()` 来执行系统命令 `wget IP/file -O /tmp/hacked.txt`。这里的核心是使用 Java 的 Runtime 对象来执行任意系统命令。

**总结：**
该漏洞利用方式简单，危害性高，利用代码有效，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [Vulnmachines/Apache-Druid-CVE-2021-25646](https://github.com/Vulnmachines/Apache-Druid-CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #5

**来源**: [CVE-2021-25646-givemefivw_CVE-2021-25646.md](../2021/CVE-2021-25646-givemefivw_CVE-2021-25646.md)

## CVE-2021-25646-ApacheDruid远程命令执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid实例版本小于等于0.20.0，且攻击者需要能够发送HTTP请求到Druid的indexer服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造恶意请求，绕过服务器配置执行任意JavaScript代码，从而导致远程代码执行。该漏洞利用方式主要是发送POST请求到/druid/indexer/v1/sampler接口，请求体包含精心构造的JSON数据，该数据中嵌入了恶意JavaScript代码。POC有效性分析：提供的POC代码使用Wker脚本编写，通过定义dir变量指定漏洞接口，post变量定义了包含恶意JavaScript的JSON数据。脚本首先获取DNSLog域名，替换post中的占位符，然后发送POST请求，并通过检查DNSLog记录来验证漏洞是否存在。利用方式：

1.  目标系统运行着Apache Druid 0.20.0或更早版本。
2.  攻击者能够通过网络访问Druid的indexer服务。
3.  攻击者运行提供的Wker脚本，输入目标Druid实例的URL。
4.  脚本发送包含恶意JavaScript代码的POST请求到/druid/indexer/v1/sampler。
5.  如果漏洞存在，Druid服务器将执行恶意JavaScript代码，并向DNSLog服务器发送DNS查询。
6.  脚本通过检查DNSLog记录来确认漏洞是否存在。
投毒风险分析：查看了仓库中的所有文件，包括主脚本和dns.wker。dns.wker主要功能是获取dnslog的域名和cookie，并查询dnslog的结果。主脚本将dnslog域名插入到payload中，发送到目标服务器，检测是否存在漏洞，根据dnslog的结果判断是否执行成功。并没有发现恶意代码，因此投毒风险为0%。

**项目地址:** [givemefivw/CVE-2021-25646](https://github.com/givemefivw/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #6

**来源**: [CVE-2021-25646-gps1949_CVE-2021-25646.md](../2021/CVE-2021-25646-gps1949_CVE-2021-25646.md)

## CVE-2021-25646 - Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许攻击者在Druid服务器上执行任意代码

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器版本为0.20.0或更早，并且攻击者需要具有一定的权限（Authenticated users）。 javascript未禁用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过发送特制的请求来覆盖系统配置，从而执行任意代码。漏洞利用代码通过构造包含恶意 JavaScript 代码的 POST 请求，利用 Druid 的索引器 sampler 功能，触发远程代码执行。

**漏洞利用方式：**

1.  攻击者首先需要获得Druid的身份验证。
2.  攻击者构造一个包含恶意 JavaScript 代码的 JSON 数据，该代码会被嵌入到 Druid 的 `sampler` 请求中。
3.  通过 POST 请求将构造好的 JSON 数据发送到 `/druid/indexer/v1/sampler` 接口。
4.  Druid 服务器解析请求，执行嵌入的 JavaScript 代码，从而实现远程代码执行。
5.  在提供的PoC代码中，通过`-u`指定URL，`-c`指定要执行的命令。PoC中提供了反弹shell的示例，先写入反弹shell脚本，赋予执行权限，然后执行shell脚本。

**有效性：**

根据漏洞信息和搜索引擎结果，此漏洞是真实存在的，并且PoC代码也有效，可以成功触发远程代码执行。

**投毒风险：**

该仓库的投毒风险较低，因为PoC代码比较简单，功能单一，主要实现了漏洞的利用。投毒风险主要来自以下几个方面：

*   **不明显的恶意代码：** 攻击者可能会在 JavaScript 代码中添加不明显的恶意代码，例如，在执行命令后，将服务器上的敏感数据发送到攻击者的服务器。
*   **依赖项：** 如果PoC依赖于外部库，这些库可能包含恶意代码。

总体而言，该PoC的投毒风险较低，约为5%。因为漏洞本身已经可以实现远程代码执行，没有必要增加额外的后门代码。


**项目地址:** [gps1949/CVE-2021-25646](https://github.com/gps1949/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #7

**来源**: [CVE-2021-25646-j2ekim_CVE-2021-25646.md](../2021/CVE-2021-25646-j2ekim_CVE-2021-25646.md)

# CVE-2021-25646

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-25646-1n7erface_PocList.md](../2021/CVE-2021-25646-1n7erface_PocList.md)

## CVE-2021-25646-Apache Druid-RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要身份验证（但可绕过配置），目标Druid版本<=0.20.0，且JavaScript执行功能未完全禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-25646允许经过身份验证的用户通过构造特制的请求来执行任意JavaScript代码，从而实现远程代码执行。即使服务器配置禁用了JavaScript功能，此漏洞仍然有效。利用方式主要通过发送包含恶意JavaScript代码的HTTP请求，利用Druid的配置覆盖机制来实现。从提供的代码片段来看，POC是存在的，作者声明项目中存在多个漏洞的POC。由于项目作者声明中存在对安全法的担忧，并且项目后期存在架构上的问题，无法保证提供的所有POC的有效性。因此，无法排除POC中存在隐藏的后门或者恶意代码的可能。但是其主动停止更新，说明存在主动规避风险的意愿，且主要目标是简化漏洞利用流程而非进行恶意活动。投毒风险较低，估计为10%。此漏洞的修复方案是升级到Druid 0.20.1或更高版本，并限制对集群机器的网络访问。

**项目地址:** [1n7erface/PocList](https://github.com/1n7erface/PocList)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #2

**来源**: [CVE-2021-25646-Ormicron_CVE-2021-25646-GUI.md](../2021/CVE-2021-25646-Ormicron_CVE-2021-25646-GUI.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标运行Druid 0.20.0及更早版本，且攻击者需要具备身份验证权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造特定的请求来覆盖系统配置，从而在 Apache Druid 服务器上执行任意代码。漏洞利用方式：

1.  **漏洞描述：** Apache Druid 包含执行用户提供的 JavaScript 代码的能力，该功能旨在用于高信任环境，默认情况下处于禁用状态。但是，在 Druid 0.20.0 及更早版本中，经过身份验证的用户可以发送特制的请求，强制 Druid 运行用户提供的 JavaScript 代码，而无需考虑服务器配置。
2.  **搜索引擎结果分析：** 大部分搜索结果都表明这是一个未经身份验证的 RCE 漏洞，这与漏洞库中的信息不符。漏洞库信息表明，该漏洞需要身份验证。
3.  **漏洞利用代码分析：** 提供的代码是 C# 的 Visual Studio 项目，看起来是一个用于利用此漏洞的程序。项目包含`Form1.cs`和`Program.cs`等文件，表明它可能是一个图形界面程序，用于构造和发送恶意请求。

    *   **有效性：** 根据漏洞信息和搜索结果，可以判断该漏洞是有效的，并且存在公开可用的利用代码。需要注意的是，漏洞利用需要身份验证，这一点与部分搜索结果不一致。提供的C#代码表明存在一种GUI利用方式。通过构造带有恶意JavaScript代码的HTTP请求利用漏洞。
    *   **投毒风险：**  提供的代码片段为 Visual Studio 项目文件和一些窗体相关的代码，并非完整的PoC代码，难以直接判断是否存在投毒代码。代码本身是用于利用漏洞的，如果攻击者修改了代码，例如在执行有效载荷之前或之后添加了其他恶意操作（例如，窃取凭据、安装后门、横向渗透），则可能存在投毒。根据已提供的代码片段，检测到恶意代码的概率较低，约为20%。
    *   **利用方式：** 攻击者需要首先获取 Druid 实例的有效身份验证凭据。然后，他们可以构造一个包含恶意 JavaScript 代码的 HTTP 请求，利用 Druid 的配置覆盖机制来执行该代码，从而获得服务器的控制权。攻击通常涉及向 Druid 服务器的特定端点（例如查询或数据摄取 API）发送包含恶意 JavaScript 代码的 JSON 载荷。

**项目地址:** [Ormicron/CVE-2021-25646-GUI](https://github.com/Ormicron/CVE-2021-25646-GUI)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #3

**来源**: [CVE-2021-25646-ShadowLance2_Apache-Druid-CVE-2021-25646-Exploit.md](../2021/CVE-2021-25646-ShadowLance2_Apache-Druid-CVE-2021-25646-Exploit.md)

## CVE-2021-25646-Apache Druid-RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务版本低于0.20.1，且攻击者需要具备一定程度的身份验证（即使是低权限用户）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-25646是Apache Druid中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许经过身份验证的用户通过构造特制的请求来执行任意JavaScript代码，从而在Druid服务器上以服务器进程的权限执行代码。即使服务器配置禁用了JavaScript执行，攻击者仍然可以通过此漏洞绕过限制。

**有效性：**
提供的PoC代码看起来是有效的。它利用了Druid的sampler接口，通过构造包含恶意JavaScript代码的JSON payload，尝试在目标系统上执行命令。代码中包含了命令转义，增加了成功利用的可能性。

**投毒风险：**
PoC代码中存在少量投毒风险。代码逻辑主要是构造payload，风险主要在于以下几点：

1.  **依赖安装风险：**`requirements.txt`文件如果包含恶意依赖，则存在投毒风险，但该PoC未使用`requirements.txt`而是直接提示安装`requests`库，风险较低。
2.  **请求库风险：**代码使用了`requests`库发送HTTP请求。如果该库被篡改，可能导致信息泄露或者其他安全问题，但这种情况发生的概率较低。
3.  **代码逻辑风险：** 代码中命令执行部分使用了`java.lang.Runtime.getRuntime().exec()`，如果攻击者修改了PoC，可能会尝试执行更危险的命令，但代码本身目标是执行用户指定的命令。

因此，综合来看，PoC本身包含的恶意代码概率较低，但如果被篡改，则可能存在风险，投毒风险评估为5%。

**利用方式：**
1.  攻击者需要知道目标Druid服务的URL。
2.  攻击者需要发送一个POST请求到`/druid/indexer/v1/sampler`端点。
3.  请求体需要是包含恶意JavaScript代码的JSON payload。这个payload会覆盖服务器配置，强制执行JavaScript代码。
4.  恶意JavaScript代码使用`java.lang.Runtime.getRuntime().exec()`来执行系统命令。
5.  服务器返回命令执行结果。

**项目地址:** [ShadowLance2/Apache-Druid-CVE-2021-25646-Exploit](https://github.com/ShadowLance2/Apache-Druid-CVE-2021-25646-Exploit)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #4

**来源**: [CVE-2021-25646-Vulnmachines_Apache-Druid-CVE-2021-25646.md](../2021/CVE-2021-25646-Vulnmachines_Apache-Druid-CVE-2021-25646.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器版本低于或等于0.20.0，且攻击者需要具有经过身份验证的访问权限（根据漏洞库信息）。但根据部分搜索结果，某些默认配置可能无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 漏洞允许经过身份验证的用户（或者在某些未授权配置下，未经身份验证的用户）通过发送特制的 HTTP 请求，在 Apache Druid 服务器上执行任意 JavaScript 代码，从而实现远程代码执行。  

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开的POC代码。提供的POC代码通过`POST /druid/indexer/v1/sampler?for=filter`发送包含恶意JavaScript代码的JSON数据，利用Druid的`filter`功能执行`wget`命令，下载恶意文件到`/tmp/hacked.txt`。因此，该POC代码是有效的。

**投毒风险分析：**
Payload.txt中的代码会尝试从攻击者的IP地址下载文件，存在潜在的投毒风险。攻击者可以替换文件内容，例如下载恶意的二进制文件或其他payload。README.md文件只是一个简单的说明，本身不包含恶意代码。

分析 Payload.txt 文件，其中的 JavaScript 代码旨在通过 `wget` 命令从 `IP/file` 下载文件到 `/tmp/hacked.txt`。这段代码本身不包含后门或者恶意逻辑，只是下载文件。但如果攻击者替换 `IP/file` 指向恶意文件，则可能造成投毒。

风险评估：
- **下载恶意文件:** 90% 的风险在于，攻击者可能会修改 `IP/file` 指向一个恶意的可执行文件、脚本或其他有害内容，导致受害者系统感染或被控制。
- **代码本身:** 代码本身（`wget IP/file -O /tmp/hacked.txt`）的恶意性只有 10%，因为这只是一个下载操作，恶意性取决于下载的内容。

**利用方式：**
1.  **身份验证：**  根据漏洞描述，默认需要首先通过Druid的身份验证机制。但是，需要注意的是，某些搜索结果表明，在某些默认配置下，Druid可能存在未授权访问的情况，无需身份验证即可利用此漏洞。
2.  **构造恶意请求：**  构造一个包含恶意JavaScript代码的JSON数据包，并将其发送到`/druid/indexer/v1/sampler?for=filter`端点。
3.  **代码执行：**  Druid服务器解析该请求，执行嵌入的JavaScript代码，从而实现远程代码执行。
4.  **利用 JavaScript 执行系统命令:** POC 利用 `java.lang.Runtime.getRuntime().exec()` 来执行系统命令 `wget IP/file -O /tmp/hacked.txt`。这里的核心是使用 Java 的 Runtime 对象来执行任意系统命令。

**总结：**
该漏洞利用方式简单，危害性高，利用代码有效，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [Vulnmachines/Apache-Druid-CVE-2021-25646](https://github.com/Vulnmachines/Apache-Druid-CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #5

**来源**: [CVE-2021-25646-givemefivw_CVE-2021-25646.md](../2021/CVE-2021-25646-givemefivw_CVE-2021-25646.md)

## CVE-2021-25646-ApacheDruid远程命令执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid实例版本小于等于0.20.0，且攻击者需要能够发送HTTP请求到Druid的indexer服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造恶意请求，绕过服务器配置执行任意JavaScript代码，从而导致远程代码执行。该漏洞利用方式主要是发送POST请求到/druid/indexer/v1/sampler接口，请求体包含精心构造的JSON数据，该数据中嵌入了恶意JavaScript代码。POC有效性分析：提供的POC代码使用Wker脚本编写，通过定义dir变量指定漏洞接口，post变量定义了包含恶意JavaScript的JSON数据。脚本首先获取DNSLog域名，替换post中的占位符，然后发送POST请求，并通过检查DNSLog记录来验证漏洞是否存在。利用方式：

1.  目标系统运行着Apache Druid 0.20.0或更早版本。
2.  攻击者能够通过网络访问Druid的indexer服务。
3.  攻击者运行提供的Wker脚本，输入目标Druid实例的URL。
4.  脚本发送包含恶意JavaScript代码的POST请求到/druid/indexer/v1/sampler。
5.  如果漏洞存在，Druid服务器将执行恶意JavaScript代码，并向DNSLog服务器发送DNS查询。
6.  脚本通过检查DNSLog记录来确认漏洞是否存在。
投毒风险分析：查看了仓库中的所有文件，包括主脚本和dns.wker。dns.wker主要功能是获取dnslog的域名和cookie，并查询dnslog的结果。主脚本将dnslog域名插入到payload中，发送到目标服务器，检测是否存在漏洞，根据dnslog的结果判断是否执行成功。并没有发现恶意代码，因此投毒风险为0%。

**项目地址:** [givemefivw/CVE-2021-25646](https://github.com/givemefivw/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #6

**来源**: [CVE-2021-25646-gps1949_CVE-2021-25646.md](../2021/CVE-2021-25646-gps1949_CVE-2021-25646.md)

## CVE-2021-25646 - Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许攻击者在Druid服务器上执行任意代码

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器版本为0.20.0或更早，并且攻击者需要具有一定的权限（Authenticated users）。 javascript未禁用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过发送特制的请求来覆盖系统配置，从而执行任意代码。漏洞利用代码通过构造包含恶意 JavaScript 代码的 POST 请求，利用 Druid 的索引器 sampler 功能，触发远程代码执行。

**漏洞利用方式：**

1.  攻击者首先需要获得Druid的身份验证。
2.  攻击者构造一个包含恶意 JavaScript 代码的 JSON 数据，该代码会被嵌入到 Druid 的 `sampler` 请求中。
3.  通过 POST 请求将构造好的 JSON 数据发送到 `/druid/indexer/v1/sampler` 接口。
4.  Druid 服务器解析请求，执行嵌入的 JavaScript 代码，从而实现远程代码执行。
5.  在提供的PoC代码中，通过`-u`指定URL，`-c`指定要执行的命令。PoC中提供了反弹shell的示例，先写入反弹shell脚本，赋予执行权限，然后执行shell脚本。

**有效性：**

根据漏洞信息和搜索引擎结果，此漏洞是真实存在的，并且PoC代码也有效，可以成功触发远程代码执行。

**投毒风险：**

该仓库的投毒风险较低，因为PoC代码比较简单，功能单一，主要实现了漏洞的利用。投毒风险主要来自以下几个方面：

*   **不明显的恶意代码：** 攻击者可能会在 JavaScript 代码中添加不明显的恶意代码，例如，在执行命令后，将服务器上的敏感数据发送到攻击者的服务器。
*   **依赖项：** 如果PoC依赖于外部库，这些库可能包含恶意代码。

总体而言，该PoC的投毒风险较低，约为5%。因为漏洞本身已经可以实现远程代码执行，没有必要增加额外的后门代码。


**项目地址:** [gps1949/CVE-2021-25646](https://github.com/gps1949/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #7

**来源**: [CVE-2021-25646-j2ekim_CVE-2021-25646.md](../2021/CVE-2021-25646-j2ekim_CVE-2021-25646.md)

# CVE-2021-25646

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-25646-1n7erface_PocList.md](../2021/CVE-2021-25646-1n7erface_PocList.md)

## CVE-2021-25646-Apache Druid-RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要身份验证（但可绕过配置），目标Druid版本<=0.20.0，且JavaScript执行功能未完全禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-25646允许经过身份验证的用户通过构造特制的请求来执行任意JavaScript代码，从而实现远程代码执行。即使服务器配置禁用了JavaScript功能，此漏洞仍然有效。利用方式主要通过发送包含恶意JavaScript代码的HTTP请求，利用Druid的配置覆盖机制来实现。从提供的代码片段来看，POC是存在的，作者声明项目中存在多个漏洞的POC。由于项目作者声明中存在对安全法的担忧，并且项目后期存在架构上的问题，无法保证提供的所有POC的有效性。因此，无法排除POC中存在隐藏的后门或者恶意代码的可能。但是其主动停止更新，说明存在主动规避风险的意愿，且主要目标是简化漏洞利用流程而非进行恶意活动。投毒风险较低，估计为10%。此漏洞的修复方案是升级到Druid 0.20.1或更高版本，并限制对集群机器的网络访问。

**项目地址:** [1n7erface/PocList](https://github.com/1n7erface/PocList)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #2

**来源**: [CVE-2021-25646-Ormicron_CVE-2021-25646-GUI.md](../2021/CVE-2021-25646-Ormicron_CVE-2021-25646-GUI.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标运行Druid 0.20.0及更早版本，且攻击者需要具备身份验证权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造特定的请求来覆盖系统配置，从而在 Apache Druid 服务器上执行任意代码。漏洞利用方式：

1.  **漏洞描述：** Apache Druid 包含执行用户提供的 JavaScript 代码的能力，该功能旨在用于高信任环境，默认情况下处于禁用状态。但是，在 Druid 0.20.0 及更早版本中，经过身份验证的用户可以发送特制的请求，强制 Druid 运行用户提供的 JavaScript 代码，而无需考虑服务器配置。
2.  **搜索引擎结果分析：** 大部分搜索结果都表明这是一个未经身份验证的 RCE 漏洞，这与漏洞库中的信息不符。漏洞库信息表明，该漏洞需要身份验证。
3.  **漏洞利用代码分析：** 提供的代码是 C# 的 Visual Studio 项目，看起来是一个用于利用此漏洞的程序。项目包含`Form1.cs`和`Program.cs`等文件，表明它可能是一个图形界面程序，用于构造和发送恶意请求。

    *   **有效性：** 根据漏洞信息和搜索结果，可以判断该漏洞是有效的，并且存在公开可用的利用代码。需要注意的是，漏洞利用需要身份验证，这一点与部分搜索结果不一致。提供的C#代码表明存在一种GUI利用方式。通过构造带有恶意JavaScript代码的HTTP请求利用漏洞。
    *   **投毒风险：**  提供的代码片段为 Visual Studio 项目文件和一些窗体相关的代码，并非完整的PoC代码，难以直接判断是否存在投毒代码。代码本身是用于利用漏洞的，如果攻击者修改了代码，例如在执行有效载荷之前或之后添加了其他恶意操作（例如，窃取凭据、安装后门、横向渗透），则可能存在投毒。根据已提供的代码片段，检测到恶意代码的概率较低，约为20%。
    *   **利用方式：** 攻击者需要首先获取 Druid 实例的有效身份验证凭据。然后，他们可以构造一个包含恶意 JavaScript 代码的 HTTP 请求，利用 Druid 的配置覆盖机制来执行该代码，从而获得服务器的控制权。攻击通常涉及向 Druid 服务器的特定端点（例如查询或数据摄取 API）发送包含恶意 JavaScript 代码的 JSON 载荷。

**项目地址:** [Ormicron/CVE-2021-25646-GUI](https://github.com/Ormicron/CVE-2021-25646-GUI)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #3

**来源**: [CVE-2021-25646-ShadowLance2_Apache-Druid-CVE-2021-25646-Exploit.md](../2021/CVE-2021-25646-ShadowLance2_Apache-Druid-CVE-2021-25646-Exploit.md)

## CVE-2021-25646-Apache Druid-RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务版本低于0.20.1，且攻击者需要具备一定程度的身份验证（即使是低权限用户）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-25646是Apache Druid中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许经过身份验证的用户通过构造特制的请求来执行任意JavaScript代码，从而在Druid服务器上以服务器进程的权限执行代码。即使服务器配置禁用了JavaScript执行，攻击者仍然可以通过此漏洞绕过限制。

**有效性：**
提供的PoC代码看起来是有效的。它利用了Druid的sampler接口，通过构造包含恶意JavaScript代码的JSON payload，尝试在目标系统上执行命令。代码中包含了命令转义，增加了成功利用的可能性。

**投毒风险：**
PoC代码中存在少量投毒风险。代码逻辑主要是构造payload，风险主要在于以下几点：

1.  **依赖安装风险：**`requirements.txt`文件如果包含恶意依赖，则存在投毒风险，但该PoC未使用`requirements.txt`而是直接提示安装`requests`库，风险较低。
2.  **请求库风险：**代码使用了`requests`库发送HTTP请求。如果该库被篡改，可能导致信息泄露或者其他安全问题，但这种情况发生的概率较低。
3.  **代码逻辑风险：** 代码中命令执行部分使用了`java.lang.Runtime.getRuntime().exec()`，如果攻击者修改了PoC，可能会尝试执行更危险的命令，但代码本身目标是执行用户指定的命令。

因此，综合来看，PoC本身包含的恶意代码概率较低，但如果被篡改，则可能存在风险，投毒风险评估为5%。

**利用方式：**
1.  攻击者需要知道目标Druid服务的URL。
2.  攻击者需要发送一个POST请求到`/druid/indexer/v1/sampler`端点。
3.  请求体需要是包含恶意JavaScript代码的JSON payload。这个payload会覆盖服务器配置，强制执行JavaScript代码。
4.  恶意JavaScript代码使用`java.lang.Runtime.getRuntime().exec()`来执行系统命令。
5.  服务器返回命令执行结果。

**项目地址:** [ShadowLance2/Apache-Druid-CVE-2021-25646-Exploit](https://github.com/ShadowLance2/Apache-Druid-CVE-2021-25646-Exploit)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #4

**来源**: [CVE-2021-25646-Vulnmachines_Apache-Druid-CVE-2021-25646.md](../2021/CVE-2021-25646-Vulnmachines_Apache-Druid-CVE-2021-25646.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器版本低于或等于0.20.0，且攻击者需要具有经过身份验证的访问权限（根据漏洞库信息）。但根据部分搜索结果，某些默认配置可能无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 漏洞允许经过身份验证的用户（或者在某些未授权配置下，未经身份验证的用户）通过发送特制的 HTTP 请求，在 Apache Druid 服务器上执行任意 JavaScript 代码，从而实现远程代码执行。  

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开的POC代码。提供的POC代码通过`POST /druid/indexer/v1/sampler?for=filter`发送包含恶意JavaScript代码的JSON数据，利用Druid的`filter`功能执行`wget`命令，下载恶意文件到`/tmp/hacked.txt`。因此，该POC代码是有效的。

**投毒风险分析：**
Payload.txt中的代码会尝试从攻击者的IP地址下载文件，存在潜在的投毒风险。攻击者可以替换文件内容，例如下载恶意的二进制文件或其他payload。README.md文件只是一个简单的说明，本身不包含恶意代码。

分析 Payload.txt 文件，其中的 JavaScript 代码旨在通过 `wget` 命令从 `IP/file` 下载文件到 `/tmp/hacked.txt`。这段代码本身不包含后门或者恶意逻辑，只是下载文件。但如果攻击者替换 `IP/file` 指向恶意文件，则可能造成投毒。

风险评估：
- **下载恶意文件:** 90% 的风险在于，攻击者可能会修改 `IP/file` 指向一个恶意的可执行文件、脚本或其他有害内容，导致受害者系统感染或被控制。
- **代码本身:** 代码本身（`wget IP/file -O /tmp/hacked.txt`）的恶意性只有 10%，因为这只是一个下载操作，恶意性取决于下载的内容。

**利用方式：**
1.  **身份验证：**  根据漏洞描述，默认需要首先通过Druid的身份验证机制。但是，需要注意的是，某些搜索结果表明，在某些默认配置下，Druid可能存在未授权访问的情况，无需身份验证即可利用此漏洞。
2.  **构造恶意请求：**  构造一个包含恶意JavaScript代码的JSON数据包，并将其发送到`/druid/indexer/v1/sampler?for=filter`端点。
3.  **代码执行：**  Druid服务器解析该请求，执行嵌入的JavaScript代码，从而实现远程代码执行。
4.  **利用 JavaScript 执行系统命令:** POC 利用 `java.lang.Runtime.getRuntime().exec()` 来执行系统命令 `wget IP/file -O /tmp/hacked.txt`。这里的核心是使用 Java 的 Runtime 对象来执行任意系统命令。

**总结：**
该漏洞利用方式简单，危害性高，利用代码有效，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [Vulnmachines/Apache-Druid-CVE-2021-25646](https://github.com/Vulnmachines/Apache-Druid-CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #5

**来源**: [CVE-2021-25646-givemefivw_CVE-2021-25646.md](../2021/CVE-2021-25646-givemefivw_CVE-2021-25646.md)

## CVE-2021-25646-ApacheDruid远程命令执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid实例版本小于等于0.20.0，且攻击者需要能够发送HTTP请求到Druid的indexer服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造恶意请求，绕过服务器配置执行任意JavaScript代码，从而导致远程代码执行。该漏洞利用方式主要是发送POST请求到/druid/indexer/v1/sampler接口，请求体包含精心构造的JSON数据，该数据中嵌入了恶意JavaScript代码。POC有效性分析：提供的POC代码使用Wker脚本编写，通过定义dir变量指定漏洞接口，post变量定义了包含恶意JavaScript的JSON数据。脚本首先获取DNSLog域名，替换post中的占位符，然后发送POST请求，并通过检查DNSLog记录来验证漏洞是否存在。利用方式：

1.  目标系统运行着Apache Druid 0.20.0或更早版本。
2.  攻击者能够通过网络访问Druid的indexer服务。
3.  攻击者运行提供的Wker脚本，输入目标Druid实例的URL。
4.  脚本发送包含恶意JavaScript代码的POST请求到/druid/indexer/v1/sampler。
5.  如果漏洞存在，Druid服务器将执行恶意JavaScript代码，并向DNSLog服务器发送DNS查询。
6.  脚本通过检查DNSLog记录来确认漏洞是否存在。
投毒风险分析：查看了仓库中的所有文件，包括主脚本和dns.wker。dns.wker主要功能是获取dnslog的域名和cookie，并查询dnslog的结果。主脚本将dnslog域名插入到payload中，发送到目标服务器，检测是否存在漏洞，根据dnslog的结果判断是否执行成功。并没有发现恶意代码，因此投毒风险为0%。

**项目地址:** [givemefivw/CVE-2021-25646](https://github.com/givemefivw/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #6

**来源**: [CVE-2021-25646-gps1949_CVE-2021-25646.md](../2021/CVE-2021-25646-gps1949_CVE-2021-25646.md)

## CVE-2021-25646 - Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许攻击者在Druid服务器上执行任意代码

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器版本为0.20.0或更早，并且攻击者需要具有一定的权限（Authenticated users）。 javascript未禁用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过发送特制的请求来覆盖系统配置，从而执行任意代码。漏洞利用代码通过构造包含恶意 JavaScript 代码的 POST 请求，利用 Druid 的索引器 sampler 功能，触发远程代码执行。

**漏洞利用方式：**

1.  攻击者首先需要获得Druid的身份验证。
2.  攻击者构造一个包含恶意 JavaScript 代码的 JSON 数据，该代码会被嵌入到 Druid 的 `sampler` 请求中。
3.  通过 POST 请求将构造好的 JSON 数据发送到 `/druid/indexer/v1/sampler` 接口。
4.  Druid 服务器解析请求，执行嵌入的 JavaScript 代码，从而实现远程代码执行。
5.  在提供的PoC代码中，通过`-u`指定URL，`-c`指定要执行的命令。PoC中提供了反弹shell的示例，先写入反弹shell脚本，赋予执行权限，然后执行shell脚本。

**有效性：**

根据漏洞信息和搜索引擎结果，此漏洞是真实存在的，并且PoC代码也有效，可以成功触发远程代码执行。

**投毒风险：**

该仓库的投毒风险较低，因为PoC代码比较简单，功能单一，主要实现了漏洞的利用。投毒风险主要来自以下几个方面：

*   **不明显的恶意代码：** 攻击者可能会在 JavaScript 代码中添加不明显的恶意代码，例如，在执行命令后，将服务器上的敏感数据发送到攻击者的服务器。
*   **依赖项：** 如果PoC依赖于外部库，这些库可能包含恶意代码。

总体而言，该PoC的投毒风险较低，约为5%。因为漏洞本身已经可以实现远程代码执行，没有必要增加额外的后门代码。


**项目地址:** [gps1949/CVE-2021-25646](https://github.com/gps1949/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #7

**来源**: [CVE-2021-25646-k7pro_CVE-2021-25646-exp.md](../2021/CVE-2021-25646-k7pro_CVE-2021-25646-exp.md)

## CVE-2021-25646-Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid实例版本小于等于0.20.0，且攻击者需要具备一定的权限（authenticated user）。但根据搜索结果，在某些默认配置下，可能无需认证即可利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许认证用户通过构造特制的请求，绕过服务器配置，执行用户提供的 JavaScript 代码，从而实现远程代码执行。该漏洞存在于 Apache Druid 0.20.0 及更早版本中。根据提供的漏洞利用代码，该POC是一个用Go语言编写的利用工具，允许检测目标是否存在漏洞，并且可以执行命令，甚至反弹shell。

**有效性分析：**
漏洞库信息明确指出该漏洞的存在，并提供了修复方案（升级到0.20.1或更高版本）。搜索引擎结果中也包含了多个关于该漏洞的分析和利用文章，证明了该漏洞的真实性和可利用性。提供的POC代码包含漏洞检测和利用功能，从其README中的演示图片来看，该POC能够成功执行命令和反弹shell，表明其具有较高的有效性。

**投毒风险分析：**
检查POC代码，主要是 `main.go` 和 `druid/druid.go` (未提供具体内容，假设存在)，可以判断该工具是否包含恶意代码。当前给出的代码片段相对简单，主要功能是漏洞利用。由于代码使用Go语言编写，需要编译后才能执行，相比脚本语言，直接植入恶意代码的风险较低。`go.mod` 和 `go.sum` 文件列出了依赖项，可以审查这些依赖项是否存在已知的安全问题。 `color` 库看起来是用于终端输出着色的，风险较低。总体来看，直接投毒的可能性较低，风险估计为10%。

**利用方式：**
1.  **身份验证：** 某些情况下，需要首先通过身份验证获取访问权限。但根据一些搜索结果（如attackerkb.com），在默认配置下，可能无需身份验证。
2.  **构造恶意请求：** 构造包含恶意 JavaScript 代码的 HTTP 请求。根据 thezdi.com 的描述，该请求包含精心构造的 JSON 数据。
3.  **发送请求：** 将构造好的请求发送到 Druid 服务器。
4.  **执行代码：** Druid 服务器解析请求，执行嵌入的 JavaScript 代码，从而实现远程代码执行。
5.  **命令执行/反弹Shell：** 漏洞利用成功后，攻击者可以在服务器上执行任意命令，例如反弹 shell，从而完全控制服务器。

**项目地址:** [k7pro/CVE-2021-25646-exp](https://github.com/k7pro/CVE-2021-25646-exp)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #8

**来源**: [CVE-2021-25646-lp008_CVE-2021-25646.md](../2021/CVE-2021-25646-lp008_CVE-2021-25646.md)

## CVE-2021-25646 Apache Druid RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器运行在受影响版本，且攻击者需要具有经过身份验证的用户权限，或者服务器未配置身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造特殊的请求来执行任意 JavaScript 代码，即使服务器配置禁用了该功能。根据漏洞库信息和搜索结果，利用方式主要是通过发送包含恶意 JavaScript 代码的 HTTP 请求，该代码会在 Druid 服务器上执行，从而实现远程代码执行。提供的 POC 代码展示了一个 POST 请求，其中包含一个 JSON payload，该 payload 利用了 Druid 的 indexer API 和 JavaScript filter 功能来执行任意命令。攻击者可以通过修改 POC 代码中的 JavaScript 函数，来执行不同的恶意操作。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 POC 代码，此漏洞的利用是有效的。大量的安全博客和漏洞分析报告都证实了该漏洞的存在和可利用性。

**投毒风险：**

该仓库中存在作者隐藏投毒代码的风险较低。POC 本身的功能是执行任意命令，示例中是下载并执行一个 shell 脚本。如果作者将这个 shell 脚本替换为恶意脚本，则会存在投毒风险。但目前提供的readme文件仅仅只是一个命令执行的演示，没有恶意投毒迹象。因此，投毒风险评估为10%，主要考虑到潜在的脚本替换风险。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要获得 Druid 集群的身份验证权限。如果 Druid 集群未启用身份验证，则可以跳过此步骤。
2.  **构造恶意请求：** 攻击者需要构造一个包含恶意 JavaScript 代码的 HTTP POST 请求。请求的目标端点是 `/druid/indexer/v1/sampler?for=filter`。
3.  **注入恶意代码：** 在请求的 JSON payload 中，需要将恶意 JavaScript 代码注入到 transformSpec.filter.function 字段中。该 JavaScript 代码将使用 java.lang.Runtime.getRuntime().exec() 执行任意命令。
4.  **发送请求：** 将构造好的 HTTP 请求发送到目标 Druid 服务器。
5.  **代码执行：** Druid 服务器将执行请求中包含的 JavaScript 代码，从而在服务器上执行任意命令。
6.  **反弹shell:** 通过执行wget和sh命令，下载恶意脚本，从而控制服务器。

**项目地址:** [lp008/CVE-2021-25646](https://github.com/lp008/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #9

**来源**: [CVE-2021-25646-tiemio_RCE-PoC-CVE-2021-25646.md](../2021/CVE-2021-25646-tiemio_RCE-PoC-CVE-2021-25646.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标服务器运行Apache Druid 0.20.0及更早版本，并且攻击者需要具有已认证用户的权限，或者Druid未启用身份验证，允许未经身份验证的攻击者利用(参考搜索引擎结果6)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许认证用户通过构造特殊的请求，覆盖系统配置，从而在 Apache Druid 服务器上执行任意 JavaScript 代码。即使 JavaScript 功能被禁用，仍然可以利用此漏洞。利用方式包括：

1.  **身份验证绕过/利用：** 如果 Druid 未配置身份验证，攻击者可以未经身份验证直接利用该漏洞。
2.  **构造恶意请求：** 攻击者需要构造包含恶意 JavaScript 代码的请求，该代码将在 Druid 服务器上执行。
3.  **配置覆盖：** 该请求能够覆盖服务器配置，从而绕过 JavaScript 执行的限制。
4.  **远程代码执行：** 成功利用后，攻击者可以在目标服务器上执行任意命令，完全控制服务器。

POC代码分析：提供的POC代码（/tmp/35517cee5a63804036351d2adea12397/README.md）只是一个简单的说明文件，指示该POC用于命令注入。由于只包含`README.md`文件，本身并不包含任何可执行的漏洞利用代码，所以要判断是否存在投毒代码需要看是否会引导用户去下载其他的恶意脚本或者链接，该文件本身没有这些行为，因此判断存在投毒的风险相对较低。但是考虑到攻击者可能在其他地方托管恶意代码，并诱导用户下载执行，因此存在一定的投毒风险。需要注意，判断该POC的有效性需结合实际可执行的漏洞利用脚本。

搜索引擎结果表明，该漏洞可以被未经身份验证的攻击者利用（在某些配置下），并且存在公开可用的漏洞利用代码。


**项目地址:** [tiemio/RCE-PoC-CVE-2021-25646](https://github.com/tiemio/RCE-PoC-CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #10

**来源**: [CVE-2021-25646-yaunsky_cve-2021-25646.md](../2021/CVE-2021-25646-yaunsky_cve-2021-25646.md)

## CVE-2021-25646-Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许经过身份验证的用户执行任意代码

**影响版本:** <= 0.20.0

**利用条件:** 需要目标服务器运行着Apache Druid 0.20.0或更早版本，并且攻击者具有已认证用户的权限(根据漏洞库信息)。根据一些搜索结果，未经身份验证也可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 存在于 Apache Druid 中，允许经过身份验证的用户（某些情况下，未经验证的用户）通过发送特制的请求来执行任意 JavaScript 代码。该漏洞源于 Druid 允许在请求中嵌入用户提供的 JavaScript 代码，即使服务器配置禁用了此功能。攻击者可以通过构造包含恶意 JavaScript 代码的 JSON 数据，利用 /druid/indexer/v1/sampler 端点，绕过安全限制，最终在目标服务器上执行任意命令。提供的 PoC 通过构造包含恶意 JavaScript 代码的 POST 请求，其中 JavaScript 代码会执行 `ping t6gx5w.dnslog.cn` 命令，从而通过 DNS 查询来验证漏洞是否存在。

**有效性：**
PoC 代码看起来是有效的。它利用了 Druid 的 /druid/indexer/v1/sampler 端点，并通过构造恶意的 JSON payload 绕过配置限制来执行 JavaScript 代码。通过 DNSLog 平台进行验证，如果收到 ping 请求，则表明漏洞存在。

**投毒风险：**
PoC 代码本身主要包含漏洞利用的逻辑，直接执行恶意命令。虽然任何代码都存在潜在的投毒风险，但此仓库中的PoC代码的目的是利用已知的漏洞，而不是植入后门。因此，投毒风险较低。风险主要来自于使用者是否会滥用此PoC进行未经授权的渗透测试。该脚本中第52行可以被修改为执行任意命令, 具有一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统上运行的 Apache Druid 版本是否小于等于 0.20.0。
2.  （可能需要）获取目标 Druid 实例的有效用户凭据。
3.  攻击者构造一个包含恶意 JavaScript 代码的 JSON payload。此 payload 被设计为在 Druid 服务器上执行任意命令。JavaScript代码嵌入在`transformSpec`中的`filter`中。
4.  攻击者将构造的 payload 通过 POST 请求发送到 /druid/indexer/v1/sampler 端点。
5.  如果漏洞利用成功，Druid 服务器将执行 payload 中的 JavaScript 代码，从而允许攻击者在服务器上执行任意命令。

**项目地址:** [yaunsky/cve-2021-25646](https://github.com/yaunsky/cve-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---



---

## POC #8

**来源**: [CVE-2021-25646-k7pro_CVE-2021-25646-exp.md](../2021/CVE-2021-25646-k7pro_CVE-2021-25646-exp.md)

## CVE-2021-25646-Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid实例版本小于等于0.20.0，且攻击者需要具备一定的权限（authenticated user）。但根据搜索结果，在某些默认配置下，可能无需认证即可利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许认证用户通过构造特制的请求，绕过服务器配置，执行用户提供的 JavaScript 代码，从而实现远程代码执行。该漏洞存在于 Apache Druid 0.20.0 及更早版本中。根据提供的漏洞利用代码，该POC是一个用Go语言编写的利用工具，允许检测目标是否存在漏洞，并且可以执行命令，甚至反弹shell。

**有效性分析：**
漏洞库信息明确指出该漏洞的存在，并提供了修复方案（升级到0.20.1或更高版本）。搜索引擎结果中也包含了多个关于该漏洞的分析和利用文章，证明了该漏洞的真实性和可利用性。提供的POC代码包含漏洞检测和利用功能，从其README中的演示图片来看，该POC能够成功执行命令和反弹shell，表明其具有较高的有效性。

**投毒风险分析：**
检查POC代码，主要是 `main.go` 和 `druid/druid.go` (未提供具体内容，假设存在)，可以判断该工具是否包含恶意代码。当前给出的代码片段相对简单，主要功能是漏洞利用。由于代码使用Go语言编写，需要编译后才能执行，相比脚本语言，直接植入恶意代码的风险较低。`go.mod` 和 `go.sum` 文件列出了依赖项，可以审查这些依赖项是否存在已知的安全问题。 `color` 库看起来是用于终端输出着色的，风险较低。总体来看，直接投毒的可能性较低，风险估计为10%。

**利用方式：**
1.  **身份验证：** 某些情况下，需要首先通过身份验证获取访问权限。但根据一些搜索结果（如attackerkb.com），在默认配置下，可能无需身份验证。
2.  **构造恶意请求：** 构造包含恶意 JavaScript 代码的 HTTP 请求。根据 thezdi.com 的描述，该请求包含精心构造的 JSON 数据。
3.  **发送请求：** 将构造好的请求发送到 Druid 服务器。
4.  **执行代码：** Druid 服务器解析请求，执行嵌入的 JavaScript 代码，从而实现远程代码执行。
5.  **命令执行/反弹Shell：** 漏洞利用成功后，攻击者可以在服务器上执行任意命令，例如反弹 shell，从而完全控制服务器。

**项目地址:** [k7pro/CVE-2021-25646-exp](https://github.com/k7pro/CVE-2021-25646-exp)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #9

**来源**: [CVE-2021-25646-lp008_CVE-2021-25646.md](../2021/CVE-2021-25646-lp008_CVE-2021-25646.md)

## CVE-2021-25646 Apache Druid RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器运行在受影响版本，且攻击者需要具有经过身份验证的用户权限，或者服务器未配置身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造特殊的请求来执行任意 JavaScript 代码，即使服务器配置禁用了该功能。根据漏洞库信息和搜索结果，利用方式主要是通过发送包含恶意 JavaScript 代码的 HTTP 请求，该代码会在 Druid 服务器上执行，从而实现远程代码执行。提供的 POC 代码展示了一个 POST 请求，其中包含一个 JSON payload，该 payload 利用了 Druid 的 indexer API 和 JavaScript filter 功能来执行任意命令。攻击者可以通过修改 POC 代码中的 JavaScript 函数，来执行不同的恶意操作。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 POC 代码，此漏洞的利用是有效的。大量的安全博客和漏洞分析报告都证实了该漏洞的存在和可利用性。

**投毒风险：**

该仓库中存在作者隐藏投毒代码的风险较低。POC 本身的功能是执行任意命令，示例中是下载并执行一个 shell 脚本。如果作者将这个 shell 脚本替换为恶意脚本，则会存在投毒风险。但目前提供的readme文件仅仅只是一个命令执行的演示，没有恶意投毒迹象。因此，投毒风险评估为10%，主要考虑到潜在的脚本替换风险。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要获得 Druid 集群的身份验证权限。如果 Druid 集群未启用身份验证，则可以跳过此步骤。
2.  **构造恶意请求：** 攻击者需要构造一个包含恶意 JavaScript 代码的 HTTP POST 请求。请求的目标端点是 `/druid/indexer/v1/sampler?for=filter`。
3.  **注入恶意代码：** 在请求的 JSON payload 中，需要将恶意 JavaScript 代码注入到 transformSpec.filter.function 字段中。该 JavaScript 代码将使用 java.lang.Runtime.getRuntime().exec() 执行任意命令。
4.  **发送请求：** 将构造好的 HTTP 请求发送到目标 Druid 服务器。
5.  **代码执行：** Druid 服务器将执行请求中包含的 JavaScript 代码，从而在服务器上执行任意命令。
6.  **反弹shell:** 通过执行wget和sh命令，下载恶意脚本，从而控制服务器。

**项目地址:** [lp008/CVE-2021-25646](https://github.com/lp008/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #10

**来源**: [CVE-2021-25646-tiemio_RCE-PoC-CVE-2021-25646.md](../2021/CVE-2021-25646-tiemio_RCE-PoC-CVE-2021-25646.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标服务器运行Apache Druid 0.20.0及更早版本，并且攻击者需要具有已认证用户的权限，或者Druid未启用身份验证，允许未经身份验证的攻击者利用(参考搜索引擎结果6)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许认证用户通过构造特殊的请求，覆盖系统配置，从而在 Apache Druid 服务器上执行任意 JavaScript 代码。即使 JavaScript 功能被禁用，仍然可以利用此漏洞。利用方式包括：

1.  **身份验证绕过/利用：** 如果 Druid 未配置身份验证，攻击者可以未经身份验证直接利用该漏洞。
2.  **构造恶意请求：** 攻击者需要构造包含恶意 JavaScript 代码的请求，该代码将在 Druid 服务器上执行。
3.  **配置覆盖：** 该请求能够覆盖服务器配置，从而绕过 JavaScript 执行的限制。
4.  **远程代码执行：** 成功利用后，攻击者可以在目标服务器上执行任意命令，完全控制服务器。

POC代码分析：提供的POC代码（/tmp/35517cee5a63804036351d2adea12397/README.md）只是一个简单的说明文件，指示该POC用于命令注入。由于只包含`README.md`文件，本身并不包含任何可执行的漏洞利用代码，所以要判断是否存在投毒代码需要看是否会引导用户去下载其他的恶意脚本或者链接，该文件本身没有这些行为，因此判断存在投毒的风险相对较低。但是考虑到攻击者可能在其他地方托管恶意代码，并诱导用户下载执行，因此存在一定的投毒风险。需要注意，判断该POC的有效性需结合实际可执行的漏洞利用脚本。

搜索引擎结果表明，该漏洞可以被未经身份验证的攻击者利用（在某些配置下），并且存在公开可用的漏洞利用代码。


**项目地址:** [tiemio/RCE-PoC-CVE-2021-25646](https://github.com/tiemio/RCE-PoC-CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #11

**来源**: [CVE-2021-25646-yaunsky_cve-2021-25646.md](../2021/CVE-2021-25646-yaunsky_cve-2021-25646.md)

## CVE-2021-25646-Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许经过身份验证的用户执行任意代码

**影响版本:** <= 0.20.0

**利用条件:** 需要目标服务器运行着Apache Druid 0.20.0或更早版本，并且攻击者具有已认证用户的权限(根据漏洞库信息)。根据一些搜索结果，未经身份验证也可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 存在于 Apache Druid 中，允许经过身份验证的用户（某些情况下，未经验证的用户）通过发送特制的请求来执行任意 JavaScript 代码。该漏洞源于 Druid 允许在请求中嵌入用户提供的 JavaScript 代码，即使服务器配置禁用了此功能。攻击者可以通过构造包含恶意 JavaScript 代码的 JSON 数据，利用 /druid/indexer/v1/sampler 端点，绕过安全限制，最终在目标服务器上执行任意命令。提供的 PoC 通过构造包含恶意 JavaScript 代码的 POST 请求，其中 JavaScript 代码会执行 `ping t6gx5w.dnslog.cn` 命令，从而通过 DNS 查询来验证漏洞是否存在。

**有效性：**
PoC 代码看起来是有效的。它利用了 Druid 的 /druid/indexer/v1/sampler 端点，并通过构造恶意的 JSON payload 绕过配置限制来执行 JavaScript 代码。通过 DNSLog 平台进行验证，如果收到 ping 请求，则表明漏洞存在。

**投毒风险：**
PoC 代码本身主要包含漏洞利用的逻辑，直接执行恶意命令。虽然任何代码都存在潜在的投毒风险，但此仓库中的PoC代码的目的是利用已知的漏洞，而不是植入后门。因此，投毒风险较低。风险主要来自于使用者是否会滥用此PoC进行未经授权的渗透测试。该脚本中第52行可以被修改为执行任意命令, 具有一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统上运行的 Apache Druid 版本是否小于等于 0.20.0。
2.  （可能需要）获取目标 Druid 实例的有效用户凭据。
3.  攻击者构造一个包含恶意 JavaScript 代码的 JSON payload。此 payload 被设计为在 Druid 服务器上执行任意命令。JavaScript代码嵌入在`transformSpec`中的`filter`中。
4.  攻击者将构造的 payload 通过 POST 请求发送到 /druid/indexer/v1/sampler 端点。
5.  如果漏洞利用成功，Druid 服务器将执行 payload 中的 JavaScript 代码，从而允许攻击者在服务器上执行任意命令。

**项目地址:** [yaunsky/cve-2021-25646](https://github.com/yaunsky/cve-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---



---

## POC #8

**来源**: [CVE-2021-25646-k7pro_CVE-2021-25646-exp.md](../2021/CVE-2021-25646-k7pro_CVE-2021-25646-exp.md)

## CVE-2021-25646-Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid实例版本小于等于0.20.0，且攻击者需要具备一定的权限（authenticated user）。但根据搜索结果，在某些默认配置下，可能无需认证即可利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许认证用户通过构造特制的请求，绕过服务器配置，执行用户提供的 JavaScript 代码，从而实现远程代码执行。该漏洞存在于 Apache Druid 0.20.0 及更早版本中。根据提供的漏洞利用代码，该POC是一个用Go语言编写的利用工具，允许检测目标是否存在漏洞，并且可以执行命令，甚至反弹shell。

**有效性分析：**
漏洞库信息明确指出该漏洞的存在，并提供了修复方案（升级到0.20.1或更高版本）。搜索引擎结果中也包含了多个关于该漏洞的分析和利用文章，证明了该漏洞的真实性和可利用性。提供的POC代码包含漏洞检测和利用功能，从其README中的演示图片来看，该POC能够成功执行命令和反弹shell，表明其具有较高的有效性。

**投毒风险分析：**
检查POC代码，主要是 `main.go` 和 `druid/druid.go` (未提供具体内容，假设存在)，可以判断该工具是否包含恶意代码。当前给出的代码片段相对简单，主要功能是漏洞利用。由于代码使用Go语言编写，需要编译后才能执行，相比脚本语言，直接植入恶意代码的风险较低。`go.mod` 和 `go.sum` 文件列出了依赖项，可以审查这些依赖项是否存在已知的安全问题。 `color` 库看起来是用于终端输出着色的，风险较低。总体来看，直接投毒的可能性较低，风险估计为10%。

**利用方式：**
1.  **身份验证：** 某些情况下，需要首先通过身份验证获取访问权限。但根据一些搜索结果（如attackerkb.com），在默认配置下，可能无需身份验证。
2.  **构造恶意请求：** 构造包含恶意 JavaScript 代码的 HTTP 请求。根据 thezdi.com 的描述，该请求包含精心构造的 JSON 数据。
3.  **发送请求：** 将构造好的请求发送到 Druid 服务器。
4.  **执行代码：** Druid 服务器解析请求，执行嵌入的 JavaScript 代码，从而实现远程代码执行。
5.  **命令执行/反弹Shell：** 漏洞利用成功后，攻击者可以在服务器上执行任意命令，例如反弹 shell，从而完全控制服务器。

**项目地址:** [k7pro/CVE-2021-25646-exp](https://github.com/k7pro/CVE-2021-25646-exp)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #9

**来源**: [CVE-2021-25646-lp008_CVE-2021-25646.md](../2021/CVE-2021-25646-lp008_CVE-2021-25646.md)

## CVE-2021-25646 Apache Druid RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器运行在受影响版本，且攻击者需要具有经过身份验证的用户权限，或者服务器未配置身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造特殊的请求来执行任意 JavaScript 代码，即使服务器配置禁用了该功能。根据漏洞库信息和搜索结果，利用方式主要是通过发送包含恶意 JavaScript 代码的 HTTP 请求，该代码会在 Druid 服务器上执行，从而实现远程代码执行。提供的 POC 代码展示了一个 POST 请求，其中包含一个 JSON payload，该 payload 利用了 Druid 的 indexer API 和 JavaScript filter 功能来执行任意命令。攻击者可以通过修改 POC 代码中的 JavaScript 函数，来执行不同的恶意操作。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 POC 代码，此漏洞的利用是有效的。大量的安全博客和漏洞分析报告都证实了该漏洞的存在和可利用性。

**投毒风险：**

该仓库中存在作者隐藏投毒代码的风险较低。POC 本身的功能是执行任意命令，示例中是下载并执行一个 shell 脚本。如果作者将这个 shell 脚本替换为恶意脚本，则会存在投毒风险。但目前提供的readme文件仅仅只是一个命令执行的演示，没有恶意投毒迹象。因此，投毒风险评估为10%，主要考虑到潜在的脚本替换风险。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要获得 Druid 集群的身份验证权限。如果 Druid 集群未启用身份验证，则可以跳过此步骤。
2.  **构造恶意请求：** 攻击者需要构造一个包含恶意 JavaScript 代码的 HTTP POST 请求。请求的目标端点是 `/druid/indexer/v1/sampler?for=filter`。
3.  **注入恶意代码：** 在请求的 JSON payload 中，需要将恶意 JavaScript 代码注入到 transformSpec.filter.function 字段中。该 JavaScript 代码将使用 java.lang.Runtime.getRuntime().exec() 执行任意命令。
4.  **发送请求：** 将构造好的 HTTP 请求发送到目标 Druid 服务器。
5.  **代码执行：** Druid 服务器将执行请求中包含的 JavaScript 代码，从而在服务器上执行任意命令。
6.  **反弹shell:** 通过执行wget和sh命令，下载恶意脚本，从而控制服务器。

**项目地址:** [lp008/CVE-2021-25646](https://github.com/lp008/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #10

**来源**: [CVE-2021-25646-tiemio_RCE-PoC-CVE-2021-25646.md](../2021/CVE-2021-25646-tiemio_RCE-PoC-CVE-2021-25646.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标服务器运行Apache Druid 0.20.0及更早版本，并且攻击者需要具有已认证用户的权限，或者Druid未启用身份验证，允许未经身份验证的攻击者利用(参考搜索引擎结果6)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许认证用户通过构造特殊的请求，覆盖系统配置，从而在 Apache Druid 服务器上执行任意 JavaScript 代码。即使 JavaScript 功能被禁用，仍然可以利用此漏洞。利用方式包括：

1.  **身份验证绕过/利用：** 如果 Druid 未配置身份验证，攻击者可以未经身份验证直接利用该漏洞。
2.  **构造恶意请求：** 攻击者需要构造包含恶意 JavaScript 代码的请求，该代码将在 Druid 服务器上执行。
3.  **配置覆盖：** 该请求能够覆盖服务器配置，从而绕过 JavaScript 执行的限制。
4.  **远程代码执行：** 成功利用后，攻击者可以在目标服务器上执行任意命令，完全控制服务器。

POC代码分析：提供的POC代码（/tmp/35517cee5a63804036351d2adea12397/README.md）只是一个简单的说明文件，指示该POC用于命令注入。由于只包含`README.md`文件，本身并不包含任何可执行的漏洞利用代码，所以要判断是否存在投毒代码需要看是否会引导用户去下载其他的恶意脚本或者链接，该文件本身没有这些行为，因此判断存在投毒的风险相对较低。但是考虑到攻击者可能在其他地方托管恶意代码，并诱导用户下载执行，因此存在一定的投毒风险。需要注意，判断该POC的有效性需结合实际可执行的漏洞利用脚本。

搜索引擎结果表明，该漏洞可以被未经身份验证的攻击者利用（在某些配置下），并且存在公开可用的漏洞利用代码。


**项目地址:** [tiemio/RCE-PoC-CVE-2021-25646](https://github.com/tiemio/RCE-PoC-CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #11

**来源**: [CVE-2021-25646-yaunsky_cve-2021-25646.md](../2021/CVE-2021-25646-yaunsky_cve-2021-25646.md)

## CVE-2021-25646-Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许经过身份验证的用户执行任意代码

**影响版本:** <= 0.20.0

**利用条件:** 需要目标服务器运行着Apache Druid 0.20.0或更早版本，并且攻击者具有已认证用户的权限(根据漏洞库信息)。根据一些搜索结果，未经身份验证也可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 存在于 Apache Druid 中，允许经过身份验证的用户（某些情况下，未经验证的用户）通过发送特制的请求来执行任意 JavaScript 代码。该漏洞源于 Druid 允许在请求中嵌入用户提供的 JavaScript 代码，即使服务器配置禁用了此功能。攻击者可以通过构造包含恶意 JavaScript 代码的 JSON 数据，利用 /druid/indexer/v1/sampler 端点，绕过安全限制，最终在目标服务器上执行任意命令。提供的 PoC 通过构造包含恶意 JavaScript 代码的 POST 请求，其中 JavaScript 代码会执行 `ping t6gx5w.dnslog.cn` 命令，从而通过 DNS 查询来验证漏洞是否存在。

**有效性：**
PoC 代码看起来是有效的。它利用了 Druid 的 /druid/indexer/v1/sampler 端点，并通过构造恶意的 JSON payload 绕过配置限制来执行 JavaScript 代码。通过 DNSLog 平台进行验证，如果收到 ping 请求，则表明漏洞存在。

**投毒风险：**
PoC 代码本身主要包含漏洞利用的逻辑，直接执行恶意命令。虽然任何代码都存在潜在的投毒风险，但此仓库中的PoC代码的目的是利用已知的漏洞，而不是植入后门。因此，投毒风险较低。风险主要来自于使用者是否会滥用此PoC进行未经授权的渗透测试。该脚本中第52行可以被修改为执行任意命令, 具有一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统上运行的 Apache Druid 版本是否小于等于 0.20.0。
2.  （可能需要）获取目标 Druid 实例的有效用户凭据。
3.  攻击者构造一个包含恶意 JavaScript 代码的 JSON payload。此 payload 被设计为在 Druid 服务器上执行任意命令。JavaScript代码嵌入在`transformSpec`中的`filter`中。
4.  攻击者将构造的 payload 通过 POST 请求发送到 /druid/indexer/v1/sampler 端点。
5.  如果漏洞利用成功，Druid 服务器将执行 payload 中的 JavaScript 代码，从而允许攻击者在服务器上执行任意命令。

**项目地址:** [yaunsky/cve-2021-25646](https://github.com/yaunsky/cve-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---



---

## POC #8

**来源**: [CVE-2021-25646-k7pro_CVE-2021-25646-exp.md](../2021/CVE-2021-25646-k7pro_CVE-2021-25646-exp.md)

## CVE-2021-25646-Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid实例版本小于等于0.20.0，且攻击者需要具备一定的权限（authenticated user）。但根据搜索结果，在某些默认配置下，可能无需认证即可利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许认证用户通过构造特制的请求，绕过服务器配置，执行用户提供的 JavaScript 代码，从而实现远程代码执行。该漏洞存在于 Apache Druid 0.20.0 及更早版本中。根据提供的漏洞利用代码，该POC是一个用Go语言编写的利用工具，允许检测目标是否存在漏洞，并且可以执行命令，甚至反弹shell。

**有效性分析：**
漏洞库信息明确指出该漏洞的存在，并提供了修复方案（升级到0.20.1或更高版本）。搜索引擎结果中也包含了多个关于该漏洞的分析和利用文章，证明了该漏洞的真实性和可利用性。提供的POC代码包含漏洞检测和利用功能，从其README中的演示图片来看，该POC能够成功执行命令和反弹shell，表明其具有较高的有效性。

**投毒风险分析：**
检查POC代码，主要是 `main.go` 和 `druid/druid.go` (未提供具体内容，假设存在)，可以判断该工具是否包含恶意代码。当前给出的代码片段相对简单，主要功能是漏洞利用。由于代码使用Go语言编写，需要编译后才能执行，相比脚本语言，直接植入恶意代码的风险较低。`go.mod` 和 `go.sum` 文件列出了依赖项，可以审查这些依赖项是否存在已知的安全问题。 `color` 库看起来是用于终端输出着色的，风险较低。总体来看，直接投毒的可能性较低，风险估计为10%。

**利用方式：**
1.  **身份验证：** 某些情况下，需要首先通过身份验证获取访问权限。但根据一些搜索结果（如attackerkb.com），在默认配置下，可能无需身份验证。
2.  **构造恶意请求：** 构造包含恶意 JavaScript 代码的 HTTP 请求。根据 thezdi.com 的描述，该请求包含精心构造的 JSON 数据。
3.  **发送请求：** 将构造好的请求发送到 Druid 服务器。
4.  **执行代码：** Druid 服务器解析请求，执行嵌入的 JavaScript 代码，从而实现远程代码执行。
5.  **命令执行/反弹Shell：** 漏洞利用成功后，攻击者可以在服务器上执行任意命令，例如反弹 shell，从而完全控制服务器。

**项目地址:** [k7pro/CVE-2021-25646-exp](https://github.com/k7pro/CVE-2021-25646-exp)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #9

**来源**: [CVE-2021-25646-lp008_CVE-2021-25646.md](../2021/CVE-2021-25646-lp008_CVE-2021-25646.md)

## CVE-2021-25646 Apache Druid RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器运行在受影响版本，且攻击者需要具有经过身份验证的用户权限，或者服务器未配置身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造特殊的请求来执行任意 JavaScript 代码，即使服务器配置禁用了该功能。根据漏洞库信息和搜索结果，利用方式主要是通过发送包含恶意 JavaScript 代码的 HTTP 请求，该代码会在 Druid 服务器上执行，从而实现远程代码执行。提供的 POC 代码展示了一个 POST 请求，其中包含一个 JSON payload，该 payload 利用了 Druid 的 indexer API 和 JavaScript filter 功能来执行任意命令。攻击者可以通过修改 POC 代码中的 JavaScript 函数，来执行不同的恶意操作。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 POC 代码，此漏洞的利用是有效的。大量的安全博客和漏洞分析报告都证实了该漏洞的存在和可利用性。

**投毒风险：**

该仓库中存在作者隐藏投毒代码的风险较低。POC 本身的功能是执行任意命令，示例中是下载并执行一个 shell 脚本。如果作者将这个 shell 脚本替换为恶意脚本，则会存在投毒风险。但目前提供的readme文件仅仅只是一个命令执行的演示，没有恶意投毒迹象。因此，投毒风险评估为10%，主要考虑到潜在的脚本替换风险。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要获得 Druid 集群的身份验证权限。如果 Druid 集群未启用身份验证，则可以跳过此步骤。
2.  **构造恶意请求：** 攻击者需要构造一个包含恶意 JavaScript 代码的 HTTP POST 请求。请求的目标端点是 `/druid/indexer/v1/sampler?for=filter`。
3.  **注入恶意代码：** 在请求的 JSON payload 中，需要将恶意 JavaScript 代码注入到 transformSpec.filter.function 字段中。该 JavaScript 代码将使用 java.lang.Runtime.getRuntime().exec() 执行任意命令。
4.  **发送请求：** 将构造好的 HTTP 请求发送到目标 Druid 服务器。
5.  **代码执行：** Druid 服务器将执行请求中包含的 JavaScript 代码，从而在服务器上执行任意命令。
6.  **反弹shell:** 通过执行wget和sh命令，下载恶意脚本，从而控制服务器。

**项目地址:** [lp008/CVE-2021-25646](https://github.com/lp008/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #10

**来源**: [CVE-2021-25646-tiemio_RCE-PoC-CVE-2021-25646.md](../2021/CVE-2021-25646-tiemio_RCE-PoC-CVE-2021-25646.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标服务器运行Apache Druid 0.20.0及更早版本，并且攻击者需要具有已认证用户的权限，或者Druid未启用身份验证，允许未经身份验证的攻击者利用(参考搜索引擎结果6)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许认证用户通过构造特殊的请求，覆盖系统配置，从而在 Apache Druid 服务器上执行任意 JavaScript 代码。即使 JavaScript 功能被禁用，仍然可以利用此漏洞。利用方式包括：

1.  **身份验证绕过/利用：** 如果 Druid 未配置身份验证，攻击者可以未经身份验证直接利用该漏洞。
2.  **构造恶意请求：** 攻击者需要构造包含恶意 JavaScript 代码的请求，该代码将在 Druid 服务器上执行。
3.  **配置覆盖：** 该请求能够覆盖服务器配置，从而绕过 JavaScript 执行的限制。
4.  **远程代码执行：** 成功利用后，攻击者可以在目标服务器上执行任意命令，完全控制服务器。

POC代码分析：提供的POC代码（/tmp/35517cee5a63804036351d2adea12397/README.md）只是一个简单的说明文件，指示该POC用于命令注入。由于只包含`README.md`文件，本身并不包含任何可执行的漏洞利用代码，所以要判断是否存在投毒代码需要看是否会引导用户去下载其他的恶意脚本或者链接，该文件本身没有这些行为，因此判断存在投毒的风险相对较低。但是考虑到攻击者可能在其他地方托管恶意代码，并诱导用户下载执行，因此存在一定的投毒风险。需要注意，判断该POC的有效性需结合实际可执行的漏洞利用脚本。

搜索引擎结果表明，该漏洞可以被未经身份验证的攻击者利用（在某些配置下），并且存在公开可用的漏洞利用代码。


**项目地址:** [tiemio/RCE-PoC-CVE-2021-25646](https://github.com/tiemio/RCE-PoC-CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #11

**来源**: [CVE-2021-25646-yaunsky_cve-2021-25646.md](../2021/CVE-2021-25646-yaunsky_cve-2021-25646.md)

## CVE-2021-25646-Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许经过身份验证的用户执行任意代码

**影响版本:** <= 0.20.0

**利用条件:** 需要目标服务器运行着Apache Druid 0.20.0或更早版本，并且攻击者具有已认证用户的权限(根据漏洞库信息)。根据一些搜索结果，未经身份验证也可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 存在于 Apache Druid 中，允许经过身份验证的用户（某些情况下，未经验证的用户）通过发送特制的请求来执行任意 JavaScript 代码。该漏洞源于 Druid 允许在请求中嵌入用户提供的 JavaScript 代码，即使服务器配置禁用了此功能。攻击者可以通过构造包含恶意 JavaScript 代码的 JSON 数据，利用 /druid/indexer/v1/sampler 端点，绕过安全限制，最终在目标服务器上执行任意命令。提供的 PoC 通过构造包含恶意 JavaScript 代码的 POST 请求，其中 JavaScript 代码会执行 `ping t6gx5w.dnslog.cn` 命令，从而通过 DNS 查询来验证漏洞是否存在。

**有效性：**
PoC 代码看起来是有效的。它利用了 Druid 的 /druid/indexer/v1/sampler 端点，并通过构造恶意的 JSON payload 绕过配置限制来执行 JavaScript 代码。通过 DNSLog 平台进行验证，如果收到 ping 请求，则表明漏洞存在。

**投毒风险：**
PoC 代码本身主要包含漏洞利用的逻辑，直接执行恶意命令。虽然任何代码都存在潜在的投毒风险，但此仓库中的PoC代码的目的是利用已知的漏洞，而不是植入后门。因此，投毒风险较低。风险主要来自于使用者是否会滥用此PoC进行未经授权的渗透测试。该脚本中第52行可以被修改为执行任意命令, 具有一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统上运行的 Apache Druid 版本是否小于等于 0.20.0。
2.  （可能需要）获取目标 Druid 实例的有效用户凭据。
3.  攻击者构造一个包含恶意 JavaScript 代码的 JSON payload。此 payload 被设计为在 Druid 服务器上执行任意命令。JavaScript代码嵌入在`transformSpec`中的`filter`中。
4.  攻击者将构造的 payload 通过 POST 请求发送到 /druid/indexer/v1/sampler 端点。
5.  如果漏洞利用成功，Druid 服务器将执行 payload 中的 JavaScript 代码，从而允许攻击者在服务器上执行任意命令。

**项目地址:** [yaunsky/cve-2021-25646](https://github.com/yaunsky/cve-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---



---

## POC #8

**来源**: [CVE-2021-25646-k7pro_CVE-2021-25646-exp.md](../2021/CVE-2021-25646-k7pro_CVE-2021-25646-exp.md)

## CVE-2021-25646-Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid实例版本小于等于0.20.0，且攻击者需要具备一定的权限（authenticated user）。但根据搜索结果，在某些默认配置下，可能无需认证即可利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许认证用户通过构造特制的请求，绕过服务器配置，执行用户提供的 JavaScript 代码，从而实现远程代码执行。该漏洞存在于 Apache Druid 0.20.0 及更早版本中。根据提供的漏洞利用代码，该POC是一个用Go语言编写的利用工具，允许检测目标是否存在漏洞，并且可以执行命令，甚至反弹shell。

**有效性分析：**
漏洞库信息明确指出该漏洞的存在，并提供了修复方案（升级到0.20.1或更高版本）。搜索引擎结果中也包含了多个关于该漏洞的分析和利用文章，证明了该漏洞的真实性和可利用性。提供的POC代码包含漏洞检测和利用功能，从其README中的演示图片来看，该POC能够成功执行命令和反弹shell，表明其具有较高的有效性。

**投毒风险分析：**
检查POC代码，主要是 `main.go` 和 `druid/druid.go` (未提供具体内容，假设存在)，可以判断该工具是否包含恶意代码。当前给出的代码片段相对简单，主要功能是漏洞利用。由于代码使用Go语言编写，需要编译后才能执行，相比脚本语言，直接植入恶意代码的风险较低。`go.mod` 和 `go.sum` 文件列出了依赖项，可以审查这些依赖项是否存在已知的安全问题。 `color` 库看起来是用于终端输出着色的，风险较低。总体来看，直接投毒的可能性较低，风险估计为10%。

**利用方式：**
1.  **身份验证：** 某些情况下，需要首先通过身份验证获取访问权限。但根据一些搜索结果（如attackerkb.com），在默认配置下，可能无需身份验证。
2.  **构造恶意请求：** 构造包含恶意 JavaScript 代码的 HTTP 请求。根据 thezdi.com 的描述，该请求包含精心构造的 JSON 数据。
3.  **发送请求：** 将构造好的请求发送到 Druid 服务器。
4.  **执行代码：** Druid 服务器解析请求，执行嵌入的 JavaScript 代码，从而实现远程代码执行。
5.  **命令执行/反弹Shell：** 漏洞利用成功后，攻击者可以在服务器上执行任意命令，例如反弹 shell，从而完全控制服务器。

**项目地址:** [k7pro/CVE-2021-25646-exp](https://github.com/k7pro/CVE-2021-25646-exp)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #9

**来源**: [CVE-2021-25646-lp008_CVE-2021-25646.md](../2021/CVE-2021-25646-lp008_CVE-2021-25646.md)

## CVE-2021-25646 Apache Druid RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器运行在受影响版本，且攻击者需要具有经过身份验证的用户权限，或者服务器未配置身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造特殊的请求来执行任意 JavaScript 代码，即使服务器配置禁用了该功能。根据漏洞库信息和搜索结果，利用方式主要是通过发送包含恶意 JavaScript 代码的 HTTP 请求，该代码会在 Druid 服务器上执行，从而实现远程代码执行。提供的 POC 代码展示了一个 POST 请求，其中包含一个 JSON payload，该 payload 利用了 Druid 的 indexer API 和 JavaScript filter 功能来执行任意命令。攻击者可以通过修改 POC 代码中的 JavaScript 函数，来执行不同的恶意操作。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 POC 代码，此漏洞的利用是有效的。大量的安全博客和漏洞分析报告都证实了该漏洞的存在和可利用性。

**投毒风险：**

该仓库中存在作者隐藏投毒代码的风险较低。POC 本身的功能是执行任意命令，示例中是下载并执行一个 shell 脚本。如果作者将这个 shell 脚本替换为恶意脚本，则会存在投毒风险。但目前提供的readme文件仅仅只是一个命令执行的演示，没有恶意投毒迹象。因此，投毒风险评估为10%，主要考虑到潜在的脚本替换风险。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要获得 Druid 集群的身份验证权限。如果 Druid 集群未启用身份验证，则可以跳过此步骤。
2.  **构造恶意请求：** 攻击者需要构造一个包含恶意 JavaScript 代码的 HTTP POST 请求。请求的目标端点是 `/druid/indexer/v1/sampler?for=filter`。
3.  **注入恶意代码：** 在请求的 JSON payload 中，需要将恶意 JavaScript 代码注入到 transformSpec.filter.function 字段中。该 JavaScript 代码将使用 java.lang.Runtime.getRuntime().exec() 执行任意命令。
4.  **发送请求：** 将构造好的 HTTP 请求发送到目标 Druid 服务器。
5.  **代码执行：** Druid 服务器将执行请求中包含的 JavaScript 代码，从而在服务器上执行任意命令。
6.  **反弹shell:** 通过执行wget和sh命令，下载恶意脚本，从而控制服务器。

**项目地址:** [lp008/CVE-2021-25646](https://github.com/lp008/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #10

**来源**: [CVE-2021-25646-tiemio_RCE-PoC-CVE-2021-25646.md](../2021/CVE-2021-25646-tiemio_RCE-PoC-CVE-2021-25646.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标服务器运行Apache Druid 0.20.0及更早版本，并且攻击者需要具有已认证用户的权限，或者Druid未启用身份验证，允许未经身份验证的攻击者利用(参考搜索引擎结果6)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许认证用户通过构造特殊的请求，覆盖系统配置，从而在 Apache Druid 服务器上执行任意 JavaScript 代码。即使 JavaScript 功能被禁用，仍然可以利用此漏洞。利用方式包括：

1.  **身份验证绕过/利用：** 如果 Druid 未配置身份验证，攻击者可以未经身份验证直接利用该漏洞。
2.  **构造恶意请求：** 攻击者需要构造包含恶意 JavaScript 代码的请求，该代码将在 Druid 服务器上执行。
3.  **配置覆盖：** 该请求能够覆盖服务器配置，从而绕过 JavaScript 执行的限制。
4.  **远程代码执行：** 成功利用后，攻击者可以在目标服务器上执行任意命令，完全控制服务器。

POC代码分析：提供的POC代码（/tmp/35517cee5a63804036351d2adea12397/README.md）只是一个简单的说明文件，指示该POC用于命令注入。由于只包含`README.md`文件，本身并不包含任何可执行的漏洞利用代码，所以要判断是否存在投毒代码需要看是否会引导用户去下载其他的恶意脚本或者链接，该文件本身没有这些行为，因此判断存在投毒的风险相对较低。但是考虑到攻击者可能在其他地方托管恶意代码，并诱导用户下载执行，因此存在一定的投毒风险。需要注意，判断该POC的有效性需结合实际可执行的漏洞利用脚本。

搜索引擎结果表明，该漏洞可以被未经身份验证的攻击者利用（在某些配置下），并且存在公开可用的漏洞利用代码。


**项目地址:** [tiemio/RCE-PoC-CVE-2021-25646](https://github.com/tiemio/RCE-PoC-CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #11

**来源**: [CVE-2021-25646-yaunsky_cve-2021-25646.md](../2021/CVE-2021-25646-yaunsky_cve-2021-25646.md)

## CVE-2021-25646-Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许经过身份验证的用户执行任意代码

**影响版本:** <= 0.20.0

**利用条件:** 需要目标服务器运行着Apache Druid 0.20.0或更早版本，并且攻击者具有已认证用户的权限(根据漏洞库信息)。根据一些搜索结果，未经身份验证也可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 存在于 Apache Druid 中，允许经过身份验证的用户（某些情况下，未经验证的用户）通过发送特制的请求来执行任意 JavaScript 代码。该漏洞源于 Druid 允许在请求中嵌入用户提供的 JavaScript 代码，即使服务器配置禁用了此功能。攻击者可以通过构造包含恶意 JavaScript 代码的 JSON 数据，利用 /druid/indexer/v1/sampler 端点，绕过安全限制，最终在目标服务器上执行任意命令。提供的 PoC 通过构造包含恶意 JavaScript 代码的 POST 请求，其中 JavaScript 代码会执行 `ping t6gx5w.dnslog.cn` 命令，从而通过 DNS 查询来验证漏洞是否存在。

**有效性：**
PoC 代码看起来是有效的。它利用了 Druid 的 /druid/indexer/v1/sampler 端点，并通过构造恶意的 JSON payload 绕过配置限制来执行 JavaScript 代码。通过 DNSLog 平台进行验证，如果收到 ping 请求，则表明漏洞存在。

**投毒风险：**
PoC 代码本身主要包含漏洞利用的逻辑，直接执行恶意命令。虽然任何代码都存在潜在的投毒风险，但此仓库中的PoC代码的目的是利用已知的漏洞，而不是植入后门。因此，投毒风险较低。风险主要来自于使用者是否会滥用此PoC进行未经授权的渗透测试。该脚本中第52行可以被修改为执行任意命令, 具有一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统上运行的 Apache Druid 版本是否小于等于 0.20.0。
2.  （可能需要）获取目标 Druid 实例的有效用户凭据。
3.  攻击者构造一个包含恶意 JavaScript 代码的 JSON payload。此 payload 被设计为在 Druid 服务器上执行任意命令。JavaScript代码嵌入在`transformSpec`中的`filter`中。
4.  攻击者将构造的 payload 通过 POST 请求发送到 /druid/indexer/v1/sampler 端点。
5.  如果漏洞利用成功，Druid 服务器将执行 payload 中的 JavaScript 代码，从而允许攻击者在服务器上执行任意命令。

**项目地址:** [yaunsky/cve-2021-25646](https://github.com/yaunsky/cve-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---



---

## POC #8

**来源**: [CVE-2021-25646-k7pro_CVE-2021-25646-exp.md](../2021/CVE-2021-25646-k7pro_CVE-2021-25646-exp.md)

## CVE-2021-25646-Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid实例版本小于等于0.20.0，且攻击者需要具备一定的权限（authenticated user）。但根据搜索结果，在某些默认配置下，可能无需认证即可利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许认证用户通过构造特制的请求，绕过服务器配置，执行用户提供的 JavaScript 代码，从而实现远程代码执行。该漏洞存在于 Apache Druid 0.20.0 及更早版本中。根据提供的漏洞利用代码，该POC是一个用Go语言编写的利用工具，允许检测目标是否存在漏洞，并且可以执行命令，甚至反弹shell。

**有效性分析：**
漏洞库信息明确指出该漏洞的存在，并提供了修复方案（升级到0.20.1或更高版本）。搜索引擎结果中也包含了多个关于该漏洞的分析和利用文章，证明了该漏洞的真实性和可利用性。提供的POC代码包含漏洞检测和利用功能，从其README中的演示图片来看，该POC能够成功执行命令和反弹shell，表明其具有较高的有效性。

**投毒风险分析：**
检查POC代码，主要是 `main.go` 和 `druid/druid.go` (未提供具体内容，假设存在)，可以判断该工具是否包含恶意代码。当前给出的代码片段相对简单，主要功能是漏洞利用。由于代码使用Go语言编写，需要编译后才能执行，相比脚本语言，直接植入恶意代码的风险较低。`go.mod` 和 `go.sum` 文件列出了依赖项，可以审查这些依赖项是否存在已知的安全问题。 `color` 库看起来是用于终端输出着色的，风险较低。总体来看，直接投毒的可能性较低，风险估计为10%。

**利用方式：**
1.  **身份验证：** 某些情况下，需要首先通过身份验证获取访问权限。但根据一些搜索结果（如attackerkb.com），在默认配置下，可能无需身份验证。
2.  **构造恶意请求：** 构造包含恶意 JavaScript 代码的 HTTP 请求。根据 thezdi.com 的描述，该请求包含精心构造的 JSON 数据。
3.  **发送请求：** 将构造好的请求发送到 Druid 服务器。
4.  **执行代码：** Druid 服务器解析请求，执行嵌入的 JavaScript 代码，从而实现远程代码执行。
5.  **命令执行/反弹Shell：** 漏洞利用成功后，攻击者可以在服务器上执行任意命令，例如反弹 shell，从而完全控制服务器。

**项目地址:** [k7pro/CVE-2021-25646-exp](https://github.com/k7pro/CVE-2021-25646-exp)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #9

**来源**: [CVE-2021-25646-lp008_CVE-2021-25646.md](../2021/CVE-2021-25646-lp008_CVE-2021-25646.md)

## CVE-2021-25646 Apache Druid RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器运行在受影响版本，且攻击者需要具有经过身份验证的用户权限，或者服务器未配置身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造特殊的请求来执行任意 JavaScript 代码，即使服务器配置禁用了该功能。根据漏洞库信息和搜索结果，利用方式主要是通过发送包含恶意 JavaScript 代码的 HTTP 请求，该代码会在 Druid 服务器上执行，从而实现远程代码执行。提供的 POC 代码展示了一个 POST 请求，其中包含一个 JSON payload，该 payload 利用了 Druid 的 indexer API 和 JavaScript filter 功能来执行任意命令。攻击者可以通过修改 POC 代码中的 JavaScript 函数，来执行不同的恶意操作。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 POC 代码，此漏洞的利用是有效的。大量的安全博客和漏洞分析报告都证实了该漏洞的存在和可利用性。

**投毒风险：**

该仓库中存在作者隐藏投毒代码的风险较低。POC 本身的功能是执行任意命令，示例中是下载并执行一个 shell 脚本。如果作者将这个 shell 脚本替换为恶意脚本，则会存在投毒风险。但目前提供的readme文件仅仅只是一个命令执行的演示，没有恶意投毒迹象。因此，投毒风险评估为10%，主要考虑到潜在的脚本替换风险。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要获得 Druid 集群的身份验证权限。如果 Druid 集群未启用身份验证，则可以跳过此步骤。
2.  **构造恶意请求：** 攻击者需要构造一个包含恶意 JavaScript 代码的 HTTP POST 请求。请求的目标端点是 `/druid/indexer/v1/sampler?for=filter`。
3.  **注入恶意代码：** 在请求的 JSON payload 中，需要将恶意 JavaScript 代码注入到 transformSpec.filter.function 字段中。该 JavaScript 代码将使用 java.lang.Runtime.getRuntime().exec() 执行任意命令。
4.  **发送请求：** 将构造好的 HTTP 请求发送到目标 Druid 服务器。
5.  **代码执行：** Druid 服务器将执行请求中包含的 JavaScript 代码，从而在服务器上执行任意命令。
6.  **反弹shell:** 通过执行wget和sh命令，下载恶意脚本，从而控制服务器。

**项目地址:** [lp008/CVE-2021-25646](https://github.com/lp008/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #10

**来源**: [CVE-2021-25646-tiemio_RCE-PoC-CVE-2021-25646.md](../2021/CVE-2021-25646-tiemio_RCE-PoC-CVE-2021-25646.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标服务器运行Apache Druid 0.20.0及更早版本，并且攻击者需要具有已认证用户的权限，或者Druid未启用身份验证，允许未经身份验证的攻击者利用(参考搜索引擎结果6)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许认证用户通过构造特殊的请求，覆盖系统配置，从而在 Apache Druid 服务器上执行任意 JavaScript 代码。即使 JavaScript 功能被禁用，仍然可以利用此漏洞。利用方式包括：

1.  **身份验证绕过/利用：** 如果 Druid 未配置身份验证，攻击者可以未经身份验证直接利用该漏洞。
2.  **构造恶意请求：** 攻击者需要构造包含恶意 JavaScript 代码的请求，该代码将在 Druid 服务器上执行。
3.  **配置覆盖：** 该请求能够覆盖服务器配置，从而绕过 JavaScript 执行的限制。
4.  **远程代码执行：** 成功利用后，攻击者可以在目标服务器上执行任意命令，完全控制服务器。

POC代码分析：提供的POC代码（/tmp/35517cee5a63804036351d2adea12397/README.md）只是一个简单的说明文件，指示该POC用于命令注入。由于只包含`README.md`文件，本身并不包含任何可执行的漏洞利用代码，所以要判断是否存在投毒代码需要看是否会引导用户去下载其他的恶意脚本或者链接，该文件本身没有这些行为，因此判断存在投毒的风险相对较低。但是考虑到攻击者可能在其他地方托管恶意代码，并诱导用户下载执行，因此存在一定的投毒风险。需要注意，判断该POC的有效性需结合实际可执行的漏洞利用脚本。

搜索引擎结果表明，该漏洞可以被未经身份验证的攻击者利用（在某些配置下），并且存在公开可用的漏洞利用代码。


**项目地址:** [tiemio/RCE-PoC-CVE-2021-25646](https://github.com/tiemio/RCE-PoC-CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #11

**来源**: [CVE-2021-25646-yaunsky_cve-2021-25646.md](../2021/CVE-2021-25646-yaunsky_cve-2021-25646.md)

## CVE-2021-25646-Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许经过身份验证的用户执行任意代码

**影响版本:** <= 0.20.0

**利用条件:** 需要目标服务器运行着Apache Druid 0.20.0或更早版本，并且攻击者具有已认证用户的权限(根据漏洞库信息)。根据一些搜索结果，未经身份验证也可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 存在于 Apache Druid 中，允许经过身份验证的用户（某些情况下，未经验证的用户）通过发送特制的请求来执行任意 JavaScript 代码。该漏洞源于 Druid 允许在请求中嵌入用户提供的 JavaScript 代码，即使服务器配置禁用了此功能。攻击者可以通过构造包含恶意 JavaScript 代码的 JSON 数据，利用 /druid/indexer/v1/sampler 端点，绕过安全限制，最终在目标服务器上执行任意命令。提供的 PoC 通过构造包含恶意 JavaScript 代码的 POST 请求，其中 JavaScript 代码会执行 `ping t6gx5w.dnslog.cn` 命令，从而通过 DNS 查询来验证漏洞是否存在。

**有效性：**
PoC 代码看起来是有效的。它利用了 Druid 的 /druid/indexer/v1/sampler 端点，并通过构造恶意的 JSON payload 绕过配置限制来执行 JavaScript 代码。通过 DNSLog 平台进行验证，如果收到 ping 请求，则表明漏洞存在。

**投毒风险：**
PoC 代码本身主要包含漏洞利用的逻辑，直接执行恶意命令。虽然任何代码都存在潜在的投毒风险，但此仓库中的PoC代码的目的是利用已知的漏洞，而不是植入后门。因此，投毒风险较低。风险主要来自于使用者是否会滥用此PoC进行未经授权的渗透测试。该脚本中第52行可以被修改为执行任意命令, 具有一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统上运行的 Apache Druid 版本是否小于等于 0.20.0。
2.  （可能需要）获取目标 Druid 实例的有效用户凭据。
3.  攻击者构造一个包含恶意 JavaScript 代码的 JSON payload。此 payload 被设计为在 Druid 服务器上执行任意命令。JavaScript代码嵌入在`transformSpec`中的`filter`中。
4.  攻击者将构造的 payload 通过 POST 请求发送到 /druid/indexer/v1/sampler 端点。
5.  如果漏洞利用成功，Druid 服务器将执行 payload 中的 JavaScript 代码，从而允许攻击者在服务器上执行任意命令。

**项目地址:** [yaunsky/cve-2021-25646](https://github.com/yaunsky/cve-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---



---

## POC #8

**来源**: [CVE-2021-25646-k7pro_CVE-2021-25646-exp.md](../2021/CVE-2021-25646-k7pro_CVE-2021-25646-exp.md)

## CVE-2021-25646-Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid实例版本小于等于0.20.0，且攻击者需要具备一定的权限（authenticated user）。但根据搜索结果，在某些默认配置下，可能无需认证即可利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许认证用户通过构造特制的请求，绕过服务器配置，执行用户提供的 JavaScript 代码，从而实现远程代码执行。该漏洞存在于 Apache Druid 0.20.0 及更早版本中。根据提供的漏洞利用代码，该POC是一个用Go语言编写的利用工具，允许检测目标是否存在漏洞，并且可以执行命令，甚至反弹shell。

**有效性分析：**
漏洞库信息明确指出该漏洞的存在，并提供了修复方案（升级到0.20.1或更高版本）。搜索引擎结果中也包含了多个关于该漏洞的分析和利用文章，证明了该漏洞的真实性和可利用性。提供的POC代码包含漏洞检测和利用功能，从其README中的演示图片来看，该POC能够成功执行命令和反弹shell，表明其具有较高的有效性。

**投毒风险分析：**
检查POC代码，主要是 `main.go` 和 `druid/druid.go` (未提供具体内容，假设存在)，可以判断该工具是否包含恶意代码。当前给出的代码片段相对简单，主要功能是漏洞利用。由于代码使用Go语言编写，需要编译后才能执行，相比脚本语言，直接植入恶意代码的风险较低。`go.mod` 和 `go.sum` 文件列出了依赖项，可以审查这些依赖项是否存在已知的安全问题。 `color` 库看起来是用于终端输出着色的，风险较低。总体来看，直接投毒的可能性较低，风险估计为10%。

**利用方式：**
1.  **身份验证：** 某些情况下，需要首先通过身份验证获取访问权限。但根据一些搜索结果（如attackerkb.com），在默认配置下，可能无需身份验证。
2.  **构造恶意请求：** 构造包含恶意 JavaScript 代码的 HTTP 请求。根据 thezdi.com 的描述，该请求包含精心构造的 JSON 数据。
3.  **发送请求：** 将构造好的请求发送到 Druid 服务器。
4.  **执行代码：** Druid 服务器解析请求，执行嵌入的 JavaScript 代码，从而实现远程代码执行。
5.  **命令执行/反弹Shell：** 漏洞利用成功后，攻击者可以在服务器上执行任意命令，例如反弹 shell，从而完全控制服务器。

**项目地址:** [k7pro/CVE-2021-25646-exp](https://github.com/k7pro/CVE-2021-25646-exp)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #9

**来源**: [CVE-2021-25646-lp008_CVE-2021-25646.md](../2021/CVE-2021-25646-lp008_CVE-2021-25646.md)

## CVE-2021-25646 Apache Druid RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标Druid服务器运行在受影响版本，且攻击者需要具有经过身份验证的用户权限，或者服务器未配置身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许经过身份验证的用户通过构造特殊的请求来执行任意 JavaScript 代码，即使服务器配置禁用了该功能。根据漏洞库信息和搜索结果，利用方式主要是通过发送包含恶意 JavaScript 代码的 HTTP 请求，该代码会在 Druid 服务器上执行，从而实现远程代码执行。提供的 POC 代码展示了一个 POST 请求，其中包含一个 JSON payload，该 payload 利用了 Druid 的 indexer API 和 JavaScript filter 功能来执行任意命令。攻击者可以通过修改 POC 代码中的 JavaScript 函数，来执行不同的恶意操作。 

**有效性：**

根据漏洞库信息、搜索结果以及提供的 POC 代码，此漏洞的利用是有效的。大量的安全博客和漏洞分析报告都证实了该漏洞的存在和可利用性。

**投毒风险：**

该仓库中存在作者隐藏投毒代码的风险较低。POC 本身的功能是执行任意命令，示例中是下载并执行一个 shell 脚本。如果作者将这个 shell 脚本替换为恶意脚本，则会存在投毒风险。但目前提供的readme文件仅仅只是一个命令执行的演示，没有恶意投毒迹象。因此，投毒风险评估为10%，主要考虑到潜在的脚本替换风险。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要获得 Druid 集群的身份验证权限。如果 Druid 集群未启用身份验证，则可以跳过此步骤。
2.  **构造恶意请求：** 攻击者需要构造一个包含恶意 JavaScript 代码的 HTTP POST 请求。请求的目标端点是 `/druid/indexer/v1/sampler?for=filter`。
3.  **注入恶意代码：** 在请求的 JSON payload 中，需要将恶意 JavaScript 代码注入到 transformSpec.filter.function 字段中。该 JavaScript 代码将使用 java.lang.Runtime.getRuntime().exec() 执行任意命令。
4.  **发送请求：** 将构造好的 HTTP 请求发送到目标 Druid 服务器。
5.  **代码执行：** Druid 服务器将执行请求中包含的 JavaScript 代码，从而在服务器上执行任意命令。
6.  **反弹shell:** 通过执行wget和sh命令，下载恶意脚本，从而控制服务器。

**项目地址:** [lp008/CVE-2021-25646](https://github.com/lp008/CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #10

**来源**: [CVE-2021-25646-tiemio_RCE-PoC-CVE-2021-25646.md](../2021/CVE-2021-25646-tiemio_RCE-PoC-CVE-2021-25646.md)

## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标服务器运行Apache Druid 0.20.0及更早版本，并且攻击者需要具有已认证用户的权限，或者Druid未启用身份验证，允许未经身份验证的攻击者利用(参考搜索引擎结果6)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许认证用户通过构造特殊的请求，覆盖系统配置，从而在 Apache Druid 服务器上执行任意 JavaScript 代码。即使 JavaScript 功能被禁用，仍然可以利用此漏洞。利用方式包括：

1.  **身份验证绕过/利用：** 如果 Druid 未配置身份验证，攻击者可以未经身份验证直接利用该漏洞。
2.  **构造恶意请求：** 攻击者需要构造包含恶意 JavaScript 代码的请求，该代码将在 Druid 服务器上执行。
3.  **配置覆盖：** 该请求能够覆盖服务器配置，从而绕过 JavaScript 执行的限制。
4.  **远程代码执行：** 成功利用后，攻击者可以在目标服务器上执行任意命令，完全控制服务器。

POC代码分析：提供的POC代码（/tmp/35517cee5a63804036351d2adea12397/README.md）只是一个简单的说明文件，指示该POC用于命令注入。由于只包含`README.md`文件，本身并不包含任何可执行的漏洞利用代码，所以要判断是否存在投毒代码需要看是否会引导用户去下载其他的恶意脚本或者链接，该文件本身没有这些行为，因此判断存在投毒的风险相对较低。但是考虑到攻击者可能在其他地方托管恶意代码，并诱导用户下载执行，因此存在一定的投毒风险。需要注意，判断该POC的有效性需结合实际可执行的漏洞利用脚本。

搜索引擎结果表明，该漏洞可以被未经身份验证的攻击者利用（在某些配置下），并且存在公开可用的漏洞利用代码。


**项目地址:** [tiemio/RCE-PoC-CVE-2021-25646](https://github.com/tiemio/RCE-PoC-CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

## POC #11

**来源**: [CVE-2021-25646-yaunsky_cve-2021-25646.md](../2021/CVE-2021-25646-yaunsky_cve-2021-25646.md)

## CVE-2021-25646-Apache Druid 远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，允许经过身份验证的用户执行任意代码

**影响版本:** <= 0.20.0

**利用条件:** 需要目标服务器运行着Apache Druid 0.20.0或更早版本，并且攻击者具有已认证用户的权限(根据漏洞库信息)。根据一些搜索结果，未经身份验证也可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 存在于 Apache Druid 中，允许经过身份验证的用户（某些情况下，未经验证的用户）通过发送特制的请求来执行任意 JavaScript 代码。该漏洞源于 Druid 允许在请求中嵌入用户提供的 JavaScript 代码，即使服务器配置禁用了此功能。攻击者可以通过构造包含恶意 JavaScript 代码的 JSON 数据，利用 /druid/indexer/v1/sampler 端点，绕过安全限制，最终在目标服务器上执行任意命令。提供的 PoC 通过构造包含恶意 JavaScript 代码的 POST 请求，其中 JavaScript 代码会执行 `ping t6gx5w.dnslog.cn` 命令，从而通过 DNS 查询来验证漏洞是否存在。

**有效性：**
PoC 代码看起来是有效的。它利用了 Druid 的 /druid/indexer/v1/sampler 端点，并通过构造恶意的 JSON payload 绕过配置限制来执行 JavaScript 代码。通过 DNSLog 平台进行验证，如果收到 ping 请求，则表明漏洞存在。

**投毒风险：**
PoC 代码本身主要包含漏洞利用的逻辑，直接执行恶意命令。虽然任何代码都存在潜在的投毒风险，但此仓库中的PoC代码的目的是利用已知的漏洞，而不是植入后门。因此，投毒风险较低。风险主要来自于使用者是否会滥用此PoC进行未经授权的渗透测试。该脚本中第52行可以被修改为执行任意命令, 具有一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统上运行的 Apache Druid 版本是否小于等于 0.20.0。
2.  （可能需要）获取目标 Druid 实例的有效用户凭据。
3.  攻击者构造一个包含恶意 JavaScript 代码的 JSON payload。此 payload 被设计为在 Druid 服务器上执行任意命令。JavaScript代码嵌入在`transformSpec`中的`filter`中。
4.  攻击者将构造的 payload 通过 POST 请求发送到 /druid/indexer/v1/sampler 端点。
5.  如果漏洞利用成功，Druid 服务器将执行 payload 中的 JavaScript 代码，从而允许攻击者在服务器上执行任意命令。

**项目地址:** [yaunsky/cve-2021-25646](https://github.com/yaunsky/cve-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)

---

