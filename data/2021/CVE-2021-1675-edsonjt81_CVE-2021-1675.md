# CVE-2021-1675

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-1675-000Tonio_cve-2021-1675.md](../2021/CVE-2021-1675-000Tonio_cve-2021-1675.md)

## CVE-2021-1675 (PrintNightmare)

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致系统被完全控制

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要目标系统开启Print Spooler服务，攻击者需要有权限连接到打印服务（通常是网络可达）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 漏洞存在于 Windows Print Spooler 服务中，允许攻击者通过向服务添加恶意打印驱动程序来执行任意代码。提供的 PowerShell 脚本 `Invoke-Nightmare.ps1` 是一个本地利用此漏洞的 PoC (Proof of Concept)。

**有效性：**
根据漏洞库信息和脚本内容，此PoC代码旨在利用 CVE-2021-1675 本地提权。它通过添加恶意的打印驱动程序来实现，从而以 `NT AUTHORITY\SYSTEM` 权限执行代码。因此，该POC在未修复漏洞的系统上是有效的。

**投毒风险：**
PoC本身有较小的投毒风险，大约 10%。原因如下：
*   PoC 允许指定要加载的自定义 DLL (`-DLL` 参数)，这意味着用户可以执行任意代码。攻击者可能会将恶意代码嵌入DLL中，并共享此脚本，诱导他人使用该恶意DLL进行攻击。
*   脚本内置一个默认DLL，目的是创建一个新的本地管理员用户。虽然这个功能本身不是恶意投毒，但如果攻击者修改了脚本，使其内置的DLL执行更具破坏性的操作，然后发布修改后的脚本，就构成投毒。

**利用方式：**
1.  攻击者运行 `Invoke-Nightmare.ps1` 脚本，可以选择使用默认设置（添加名为 `adm1n` 的新管理员用户，密码为 `P@ssw0rd`）或自定义用户名、密码和驱动程序名称。
2.  如果提供了 `-DLL` 参数，脚本会加载并执行指定的 DLL 文件。否则，脚本会将内置的 payload (用于创建新管理员用户的 DLL) 写入到临时目录中，并加载执行。
3.  脚本利用 `AddPrinterDriverEx` 函数添加恶意打印驱动程序。 由于存在漏洞，Print Spooler 服务会以 `NT AUTHORITY\SYSTEM` 权限加载并执行恶意驱动程序。
4.  恶意驱动程序（DLL）执行攻击者指定的代码，例如创建新的管理员用户或执行任意命令。

**优先级排序依据：**
 漏洞利用代码 > 漏洞库信息 > 搜索引擎结果（因为没有有用的搜索引擎结果）

**项目地址:** [000Tonio/cve-2021-1675](https://github.com/000Tonio/cve-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #2

**来源**: [CVE-2021-1675-0xSs0rZ_Windows_Exploit.md](../2021/CVE-2021-1675-0xSs0rZ_Windows_Exploit.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许远程代码执行，可能导致系统完全被控制

**影响版本:** 受影响的Windows版本众多，包括Windows 7, 8.1, 10以及多个Windows Server版本，具体版本号参考漏洞库信息。

**利用条件:** 需要Print Spooler服务运行，攻击者需要具有一定的权限或者利用其他漏洞进行提权。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响多个Windows版本。攻击者可以通过利用该漏洞在目标系统上执行任意代码，从而完全控制系统。利用方式是，攻击者可以上传一个恶意的打印机驱动程序，Print Spooler服务在安装驱动程序时会以SYSTEM权限运行其中的代码。提供的PoC代码 `CVE-2021-1675.ps1` 是一个PowerShell脚本，它通过 `AddPrinterDriverEx` 函数添加恶意的打印机驱动程序，从而执行DLL中的代码。代码中包含添加新用户并将其加入管理员组的功能，也可以指定自定义的DLL。虽然PoC中包含了修改用户密码等功能，但主要风险是允许执行任意DLL，因此存在一定投毒风险，例如在提供的DLL中加入恶意代码。投毒风险评估为10%是因为大部分代码逻辑是为了实现漏洞利用，但理论上可以通过替换DLL来执行恶意操作。

**项目地址:** [0xSs0rZ/Windows_Exploit](https://github.com/0xSs0rZ/Windows_Exploit)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #3

**来源**: [CVE-2021-1675-AndrewTrube_CVE-2021-1675.md](../2021/CVE-2021-1675-AndrewTrube_CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare 本地提权漏洞

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 本地提权

**影响应用:** Windows Print Spooler

**危害等级:** 高危，攻击者可利用此漏洞获取SYSTEM权限

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows Server 2008, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 20H2, Windows Server version 2004, Windows 10 Version 1507, Windows 10 Version 1607, Windows 10 Version 1809, Windows 10 Version 1909, Windows 10 Version 2004, Windows 10 Version 20H2, Windows 10 Version 21H1等，具体版本号参见漏洞库信息。

**利用条件:** 攻击者需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675（PrintNightmare）是Windows Print Spooler服务中的一个漏洞，允许攻击者绕过SeLoadDriverPrivilege检查，通过安装恶意DLL来提升权限至SYSTEM。提供的POC代码包含两个源文件：`nightmare.cpp`（利用漏洞的主程序）和`payload-dll.cpp`（包含恶意shellcode的DLL）。利用方式如下：

1.  使用msfvenom生成shellcode，并将其嵌入`payload-dll.cpp`中。
2.  编译`nightmare.cpp`生成`PrintNightmareLPE.exe`。
3.  编译`payload-dll.cpp`生成`evil.dll`。
4.  将`evil.dll`移动到目标系统的`C:\windows\temp\evil.dll`（或修改`nightmare.cpp`中的路径）。
5.  运行`PrintNightmareLPE.exe`，该程序会加载`evil.dll`并执行其中的shellcode，从而提升权限。

**有效性：**提供的POC代码是有效的，可以用于演示和利用CVE-2021-1675漏洞。

**投毒风险：**虽然POC代码本身是为了复现漏洞，但存在一定的投毒风险。风险点主要在于payload-dll.cpp中shellcode的来源。如果shellcode是从不可信的来源获取，或者包含了恶意代码，那么整个利用过程就会被投毒。但代码的作者Andrew Trube是安全研究者，可以推断出投毒几率较低。根据对POC代码的分析，风险评估为 10%的概率存在潜在风险。

**漏洞利用方式：**
1.  攻击者需要在目标系统上具有本地访问权限。
2.  攻击者需要能够上传和执行文件。
3.  攻击者利用`PrintNightmareLPE.exe`加载恶意的`evil.dll`。
4.  恶意DLL中的shellcode会被执行，从而提升攻击者的权限。

**项目地址:** [AndrewTrube/CVE-2021-1675](https://github.com/AndrewTrube/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #4

**来源**: [CVE-2021-1675-DLL00P_CVE-2021-1675.md](../2021/CVE-2021-1675-DLL00P_CVE-2021-1675.md)

## CVE-2021-1675 - Windows Print Spooler Remote Code Execution

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Print Spooler Service

**危害等级:** 高危，允许未经授权的用户获取SYSTEM权限并执行任意代码。

**影响版本:** 受影响的版本包括Windows 7, Windows 8.1, Windows 10, Windows Server 2008, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2004, Windows Server version 20H2等, 具体版本号参考漏洞库信息。

**利用条件:** 需要目标系统开启Print Spooler服务, 攻击者需要具有一定的网络访问能力和SMB共享权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过`RpcAddPrinterDriverEx`函数上传恶意的DLL文件到目标系统，并利用Print Spooler服务加载执行，从而获取SYSTEM权限。 

**有效性评估：**
根据搜索引擎结果，CVE-2021-1675漏洞的PoC代码是公开可用的，并且该漏洞已经被广泛利用。提供的Python脚本`CVE-2021-1675.py`利用了`RpcAddPrinterDriverEx`函数来添加恶意驱动，从而实现远程代码执行。因此，可以判定该PoC代码是有效的。

**投毒风险分析：**
分析提供的Python脚本，主要操作包括连接到目标系统的Print Spooler服务，构建`DRIVER_CONTAINER`结构，并调用`RpcAddPrinterDriverEx`函数。PoC中包含一个阶段性的提权过程,如果不是相关漏洞研究人员,可能会误判为恶意代码,添加了针对 winhttp.dll kernelbase.dll等程序的调用。 投毒风险主要体现在：

1.  **pDriverPath 参数：** 此参数指定了要上传的恶意DLL文件的路径。如果攻击者提供的共享路径本身包含恶意代码，则可能导致投毒。
2.  **pConfigFile 参数：** 此参数指定了配置文件路径，脚本尝试使用不同的DLL文件路径（包括系统目录下的DLL）来利用漏洞，恶意作者可以在这里精心构造恶意利用链，从而达到植入后门的目的。

整体而言，代码的结构和逻辑更偏向于漏洞利用，而非恶意投毒，但如果攻击者对PoC代码进行修改，例如修改`pConfigFile`的值指向包含恶意代码的DLL，或者在上传的DLL文件中包含恶意逻辑，则可能存在投毒风险。根据我对PoC代码的分析，认为存在一定风险，百分比大约为10%。

**漏洞利用方式：**

1.  **攻击者准备一个恶意的DLL文件。**
2.  **攻击者需要获得目标系统的网络访问权限，并且需要知道一个可访问的SMB共享路径。**
3.  **攻击者运行PoC脚本，指定目标系统的IP地址、用户名、密码（或NTLM hash）和恶意DLL文件的SMB共享路径。**
4.  **脚本会连接到目标系统的Print Spooler服务，并使用`RpcAddPrinterDriverEx`函数将恶意DLL文件上传到目标系统。**
5.  **Print Spooler服务会加载并执行恶意DLL文件，从而导致远程代码执行，攻击者获得SYSTEM权限。**

**注意事项：**
*   攻击者需要具有有效的Windows用户凭据才能利用此漏洞。
*   目标系统需要开启Print Spooler服务。
*   攻击者需要确保恶意DLL文件与目标系统的体系结构（x86或x64）匹配。
*   成功利用此漏洞可能导致目标系统完全受控，因此应该尽快安装补丁或采取其他缓解措施。

**项目地址:** [DLL00P/CVE-2021-1675](https://github.com/DLL00P/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #5

**来源**: [CVE-2021-1675-GlacierGossip_PrintNightmare.md](../2021/CVE-2021-1675-GlacierGossip_PrintNightmare.md)

## CVE-2021-1675 Windows Print Spooler Remote Code Execution Vulnerability (PrintNightmare)

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许远程代码执行，导致系统完全控制

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 10的多个版本，以及Windows Server 2008到2019的多个版本。

**利用条件:** 攻击者需要能够访问Print Spooler服务，通常是通过网络共享打印机或通过RDP等方式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过向Print Spooler服务发送特制的打印任务，从而在系统上执行任意代码。

**有效性：**
漏洞库信息和公开资料表明此漏洞存在公开的POC代码。由于没有直接的POC代码，无法验证有效性。但是，考虑到CISA已将其添加到已知被利用漏洞目录(KEV)，可以认为该漏洞存在可利用的POC，并且在野利用已经发生。

**投毒风险：**
提供的代码片段是django-registration-templates，这与PrintNightmare漏洞无关。django-registration-templates是一个Django项目的模板集合，用于用户注册和身份验证。  因此，从提供的代码判断，投毒风险较低。虽然从技术上讲，任何开源代码库都可能包含恶意代码，但这个特定的库旨在提供现成的身份验证模板，风险主要在于安全性较差的模板可能被用于存在其他安全漏洞的应用程序中。
根据现有代码，判断投毒风险为10%，主要来源于依赖库的潜在风险，以及代码维护者被渗透的风险。

**利用方式：**
PrintNightmare漏洞的利用方式是利用Print Spooler服务中的不安全操作，允许未经授权的用户安装驱动程序。攻击者可以上传包含恶意代码的特制驱动程序，Print Spooler服务会以SYSTEM权限加载并执行该驱动程序，从而实现远程代码执行。

1.  **攻击者连接到目标系统的Print Spooler服务。**
2.  **攻击者利用`RpcAddPrinterDriverEx`函数安装恶意的打印机驱动程序。**
3.  **Print Spooler服务尝试加载该恶意驱动程序。**
4.  **由于权限不足或其他原因导致加载失败，但驱动程序文件已经被复制到系统目录中。**
5.  **攻击者可以触发驱动程序的加载，执行其中的恶意代码。**

**项目地址:** [GlacierGossip/PrintNightmare](https://github.com/GlacierGossip/PrintNightmare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #6

**来源**: [CVE-2021-1675-LaresLLC_CVE-2021-1675.md](../2021/CVE-2021-1675-LaresLLC_CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许远程代码执行，可能导致系统完全控制

**影响版本:** 受影响的Windows版本，具体参见漏洞库信息

**利用条件:** 目标系统开启Print Spooler服务且未安装相应补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler服务中的远程代码执行漏洞。

**有效性：**
根据NVD和Rapid7的信息，此漏洞的PoC已经公开，并且在野外被利用。提供的文件包含一个 Sysmon 配置文件，用于检测利用此漏洞的可疑活动。搜索结果表明，即使安装了最初的补丁，某些系统仍然容易受到攻击，这表明漏洞利用仍然有效，直到完全缓解措施到位。

**投毒风险：**
提供的代码主要是一个Sysmon配置文件，用于检测PrintNightmare漏洞的利用。它定义了一系列规则，用于监视与`spoolsv.exe`进程相关的可疑行为，例如加载驱动程序、创建文件、访问注册表等。由于Sysmon配置文件本身不包含任何可执行代码，因此直接的投毒风险较低。然而，仍然存在一些间接风险，比如：
*   **误报/漏报：** 配置不当或过于宽松的规则可能导致大量的误报，从而淹没安全分析师，并可能错过真正的攻击。过于严格的规则可能会导致漏报，使攻击者能够绕过检测。
*   **依赖外部组件：** 该配置依赖于Sysmon的存在和正确配置。如果攻击者能够禁用或篡改Sysmon，就可以绕过这些检测规则。
*   **社会工程：** 攻击者可能伪装成安全研究人员，分享修改后的、包含恶意规则的Sysmon配置文件。这些恶意规则可能旨在隐藏攻击活动或禁用其他安全措施。
*   **后门代码验证:** 搜索结果提示漏洞可以针对Active Directory域控制器。 漏洞利用代码中针对 spoolsv.exe 进程进行监控，并添加创建远程线程, 镜像加载等高危操作的日志监控。务必不要把POC验证的后门代码判定为投毒代码。
因此，综合评估，投毒风险约为10%。

**利用方式：**
1.  **远程代码执行：** 攻击者通过Print Spooler服务远程在目标系统上执行代码。
2.  **DLL注入：** 攻击者上传恶意的DLL文件到目标系统，并诱使Print Spooler服务加载它。
3.  **权限提升：** 通过利用该漏洞，攻击者可以将权限从普通用户提升到SYSTEM级别。

**总结：**
该漏洞影响广泛，利用难度较低，危害性高。需要及时安装补丁，并采取其他缓解措施，如禁用Print Spooler服务或限制对打印服务器的访问。
提供的Sysmon配置文件可以帮助检测该漏洞的利用，但不能完全阻止攻击。需要结合其他安全措施，如入侵检测系统（IDS）和终端检测与响应（EDR）解决方案，才能更有效地防御该漏洞。

**项目地址:** [LaresLLC/CVE-2021-1675](https://github.com/LaresLLC/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #7

**来源**: [CVE-2021-1675-OppressionBreedsResistance_CVE-2021-1675-PrintNightmare.md](../2021/CVE-2021-1675-OppressionBreedsResistance_CVE-2021-1675-PrintNightmare.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标系统开启Print Spooler服务，攻击者需要具有在目标系统上添加打印机的权限(某些情况下，可以绕过)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过向Print Spooler服务发送特制的请求，加载恶意DLL文件，从而在系统上执行任意代码。 

**有效性：**

从提供的漏洞利用代码来看，这是一个有效的POC。它包含以下关键组成部分：

*   **MyDLL2.sln/MyDLL2目录:** 包含用于生成恶意DLL的Visual Studio解决方案和项目文件。
*   **MyDLL2.cpp:** 包含DLL的源代码，其中 `DllMain` 函数在DLL加载时执行 `system("echo Oppression Breeds Resistance > C:\proof.txt")` 命令。 这会在C盘根目录下创建一个名为`proof.txt`的文件，内容为“Oppression Breeds Resistance”，用于验证漏洞是否成功利用。
*   **README.md:** 说明了POC的使用方法，提到了使用了 Caleb Stewart 和 John Hammond 的 PowerShell 脚本，并包含了一个混淆后的 PowerShell 脚本。

**投毒风险：**

该仓库存在一定的投毒风险，风险评估为10%。 虽然主要的利用方式是已知的PrintNightmare漏洞利用，但作者添加了混淆的PowerShell脚本，如果用户直接使用该混淆脚本，可能会引入未知的恶意行为。 需要仔细审查混淆脚本的内容。

**利用方式：**

1.  **构建恶意DLL：** 使用提供的Visual Studio项目构建恶意的DLL (MyDLL2.dll)。 该DLL包含在加载时执行任意命令的代码。
2.  **利用Print Spooler服务：** 使用PowerShell脚本（或Impacket）通过 `AddPrinterDriverEx` 函数将恶意的DLL上传到目标系统。
3.  **触发DLL加载：** 上传DLL后，Print Spooler服务会尝试加载该DLL，从而执行DLL中的恶意代码。
4.  **远程代码执行：**  成功利用后，攻击者可以在目标系统上以SYSTEM权限执行任意命令。

**总结：**

该POC利用了PrintNightmare漏洞，允许攻击者通过Print Spooler服务在目标系统上执行任意代码。虽然主要代码是已知的漏洞利用，但混淆的PowerShell脚本增加了潜在的投毒风险，使用时需要谨慎审查。

**安全建议：**

*   及时安装Microsoft提供的安全补丁，修复PrintNightmare漏洞。
*   禁用Print Spooler服务，如果不需要使用打印功能。
*   限制用户在系统上添加打印机的权限。

**项目地址:** [OppressionBreedsResistance/CVE-2021-1675-PrintNightmare](https://github.com/OppressionBreedsResistance/CVE-2021-1675-PrintNightmare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #8

**来源**: [CVE-2021-1675-Sp4ceDogy_NPE-CS-V-CVE-2021-1675.md](../2021/CVE-2021-1675-Sp4ceDogy_NPE-CS-V-CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare Windows Print Spooler RCE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致系统完全控制

**影响版本:** 受影响版本包括Windows 7, Windows 8.1, Windows 10, Windows Server 2008, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 20H2, Windows Server 2004, Windows 21H1等，具体版本参见漏洞库信息。

**利用条件:** 需要目标系统开启Print Spooler服务，攻击者需要具备一定的访问权限（可以是低权限用户）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过未经授权的方式调用 `RpcAddPrinterDriverEx()` 函数来安装恶意打印驱动程序，从而在目标系统上以SYSTEM权限执行任意代码。

**有效性：**
根据搜索引擎结果，CVE-2021-1675的PoC代码是存在的，并且已被公开。漏洞库信息也确认了该漏洞的存在和影响范围。

**投毒风险：**
提供的漏洞利用代码仅仅包含一些链接, 大部分是视频和github链接, github的作者是JohnHammond, 如果从github下载的exp，可能有一定的风险, 但总体来说, 投毒风险较低, 估计在10%左右。

**利用方式：**
1.  攻击者利用该漏洞，通过 `RpcAddPrinterDriverEx()` 函数添加恶意的打印机驱动。
2.  这个恶意驱动程序本质上是一个DLL文件，它会被加载到Print Spooler进程（spoolsv.exe）中。
3.  由于Print Spooler服务通常以SYSTEM权限运行，所以恶意DLL中的代码也会以SYSTEM权限执行，从而导致远程代码执行。
4.  利用流程通常包括:
    * 找到目标系统上开启的Print Spooler服务。
    * 构造恶意的请求，发送给Print Spooler服务。
    *  Print Spooler服务解析请求并尝试加载攻击者提供的恶意驱动。
    *  恶意驱动被加载后，执行攻击者预设的恶意代码。

**项目地址:** [Sp4ceDogy/NPE-CS-V-CVE-2021-1675](https://github.com/Sp4ceDogy/NPE-CS-V-CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #9

**来源**: [CVE-2021-1675-TheJoyOfHacking_calebstewart-CVE-2021-1675.md](../2021/CVE-2021-1675-TheJoyOfHacking_calebstewart-CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare Windows Print Spooler RCE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** 受影响的Windows版本，参见漏洞库信息

**利用条件:** 需要目标系统开启Print Spooler服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个存在于Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以利用此漏洞在目标系统上以SYSTEM权限执行任意代码。从搜索引擎结果来看，该漏洞已经被广泛研究并存在公开可用的PoC代码。

**有效性：** 提供的PoC代码 `CVE-2021-1675.ps1` 是一个PowerShell脚本，它利用该漏洞添加新的本地管理员用户或执行自定义DLL。该脚本通过 `AddPrinterDriverEx` 函数来加载恶意的驱动程序，从而实现代码执行。根据漏洞库信息和搜索结果，此漏洞真实存在且PoC有效。

**投毒风险：**  该脚本允许用户自定义DLL，这本身不是投毒。投毒的风险在于，脚本作者可能在默认DLL（由`get_nightmare_dll`函数提供）中包含恶意代码，这些代码可能不明显，难以检测。此外，该脚本的功能是添加用户或者执行 DLL,本身功能具有一定的危险性，使用不当可能造成系统损坏。综合考虑，判定存在10%的投毒风险，主要集中在默认DLL是否包含恶意后门。

**利用方式：** 利用方式如下：

1.  **本地提权/远程代码执行：**  攻击者可以利用该漏洞在本地提升权限，或者通过网络远程利用，在受影响的系统上以SYSTEM权限执行任意代码。
2.  **DLL注入：** PoC代码通过 `AddPrinterDriverEx` 函数添加恶意的printer driver，导致恶意DLL被加载到Print Spooler服务中，从而执行任意代码。
3.  **添加管理员用户：**  PoC代码可以配置为添加一个新的本地管理员账户，从而控制受影响的系统。该脚本会生成一个临时DLL文件，该DLL会在系统中创建一个新的管理员账户，密码也可以自定义。脚本会修改内存中的某些地址,来实现账户的配置。
4.  **利用链：** 通常需要结合其他漏洞或者利用方式（例如，中间人攻击）来远程触发该漏洞。

**项目地址:** [TheJoyOfHacking/calebstewart-CVE-2021-1675](https://github.com/TheJoyOfHacking/calebstewart-CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #10

**来源**: [CVE-2021-1675-TheJoyOfHacking_cube0x0-CVE-2021-1675.md](../2021/CVE-2021-1675-TheJoyOfHacking_cube0x0-CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致系统权限提升和远程代码执行

**影响版本:** 受影响的Windows版本包括Windows 7、8.1、10、Server 2008、2012、2016、2019、2004、20H2、21H1等，具体版本号参考漏洞库信息。

**利用条件:** 需要目标系统开启Print Spooler服务，攻击者需要具有一定的网络访问能力。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以利用此漏洞在目标系统上以SYSTEM权限执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（特别是Rapid7的博客文章以及CISA的已知被利用漏洞目录），以及提供的PoC代码，可以确认该漏洞是真实存在的，并且存在公开的PoC利用代码。PoC代码的有效性取决于目标系统是否已安装相应的安全补丁。

**投毒风险：**
分析提供的PoC代码，没有发现明显的恶意或投毒代码。代码主要功能是利用`hRpcAddPrinterDriverEx`函数上传恶意的驱动文件，从而实现远程代码执行。投毒风险较低，约为10%。主要风险在于攻击者可能会修改PoC代码，嵌入恶意Payload，或者将该漏洞与其他漏洞结合利用，扩大攻击范围。

**利用方式：**
1.  **连接目标：** 使用Impacket库中的`DCERPCTransportFactory`连接到目标系统的Print Spooler服务（通过`ncacn_np`协议）。
2.  **身份验证：** 如果需要，使用提供的用户名、密码、域名等信息进行身份验证。
3.  **查找驱动路径：** 调用`hRpcEnumPrinterDrivers`函数枚举驱动程序，找到包含“filerepository”的驱动路径，用于后续利用。
4.  **构造DRIVER_CONTAINER：** 构造一个`DRIVER_CONTAINER`结构，其中包含恶意驱动程序的信息，例如驱动路径(`pDriverPath`)、数据文件(`pDataFile`)和配置文件(`pConfigFile`)。其中`pConfigFile`指向恶意DLL文件
5.  **利用hRpcAddPrinterDriverEx：** 调用`hRpcAddPrinterDriverEx`函数，将恶意驱动程序添加到目标系统。通过修改`dwFileCopyFlags`参数，可以控制文件的复制行为。攻击者通过此函数将恶意DLL上传到目标机器。
6.  **提权执行：** 通过特定的目录结构和文件命名方式，使Print Spooler服务加载并执行上传的恶意DLL，从而获得SYSTEM权限。

综上，该漏洞利用的有效性较高，但需要一定的技术知识和实验环境。在实际利用中，需要注意目标系统的安全配置和补丁情况，以及潜在的投毒风险。

**项目地址:** [TheJoyOfHacking/cube0x0-CVE-2021-1675](https://github.com/TheJoyOfHacking/cube0x0-CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #11

**来源**: [CVE-2021-1675-VoiidByte_Impacket.md](../2021/CVE-2021-1675-VoiidByte_Impacket.md)

## CVE-2021-1675 - PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要网络访问，且目标系统开启Print Spooler服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-1675（PrintNightmare）是一个Windows Print Spooler服务的远程代码执行漏洞。攻击者可以通过精心构造的打印任务，欺骗系统加载并执行恶意DLL文件，从而获得系统权限。漏洞利用通常涉及以下步骤：

1.  **利用方式：** 攻击者首先需要通过网络访问目标系统的Print Spooler服务。这通常意味着目标系统的445端口和139端口是开放的。
2.  攻击者需要向Print Spooler服务发送一个特制的打印请求，该请求会指示Print Spooler服务加载一个由攻击者控制的DLL文件。
3.  当Print Spooler服务尝试加载该DLL文件时，恶意代码会被执行，从而允许攻击者在目标系统上执行任意代码。

**有效性：** 该漏洞在公开后，有大量的PoC代码被公开，说明漏洞是切实存在的且容易被利用。漏洞库信息和CISA KEV目录也确认了其真实性和被利用的事实。

**投毒风险：** 提供的代码是一个Swift的podspec文件，用于描述一个名为GiFHUD-Swift的iOS库，该库用于在应用中显示GIF动画的HUD。这个文件本身不包含任何可执行的代码，因此直接投毒的可能性很低。 风险主要在于：

*   **仓库被劫持：** 如果该GitHub仓库被恶意用户劫持，攻击者可能会修改podspec文件指向包含恶意代码的仓库。由于podspec文件本身不包含代码，即使被修改指向恶意仓库也需要开发者引入使用了GiFHUD-Swift的app。
*   **依赖库投毒：** 该库依赖Swift环境，如果Swift环境存在漏洞，可能被利用。但是此风险与此漏洞无关。

因此，综合分析，该podspec文件本身的投毒风险极低，只有1%的可能性。

**项目地址:** [VoiidByte/Impacket](https://github.com/VoiidByte/Impacket)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #12

**来源**: [CVE-2021-1675-Winter3un_CVE-2021-1675.md](../2021/CVE-2021-1675-Winter3un_CVE-2021-1675.md)

## CVE-2021-1675 Windows Print Spooler Remote Code Execution

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要目标系统开启Print Spooler服务，且攻击者能够与目标系统进行网络通信

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675（PrintNightmare）是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过利用该漏洞在目标系统上以SYSTEM权限执行任意代码。漏洞利用方式主要通过以下步骤：

1.  **上传恶意DLL：** 攻击者需要将恶意的DLL文件上传到目标服务器。
2.  **端口转发：** 利用`netsh interface portproxy add v4tov4 listenport=31337 connectaddress=192.168.84.129 connectport=31337`进行端口转发，以便能够访问远程服务。
3.  **利用漏洞触发执行：** 通过特定的方式触发Print Spooler服务加载并执行该DLL文件，从而实现远程代码执行。
4.  **权限提升：** 由于Print Spooler服务通常以SYSTEM权限运行，因此攻击者可以获得SYSTEM权限，完全控制目标系统。

**有效性评估：**

根据漏洞信息和搜索引擎结果，该漏洞的POC代码是有效的，并且已经被公开利用。多个安全厂商和研究人员都证实了该漏洞的存在和可利用性。CISA已将其添加到已知被利用的漏洞目录（KEV）。

**投毒风险评估：**

代码仓库中存在投毒代码的风险较低，大约为10%。风险主要在于：

*   **依赖性：** 该POC依赖于 `vlib.dll` 和 `PrintNightmareLPE.exe`，如果这些组件被替换为恶意版本，则可能导致投毒。
*   **转发端口被恶意利用:** 攻击者可能使用相同的端口进行其他恶意活动。

尽管如此，考虑到POC的主要功能是利用已知的安全漏洞，因此直接在POC代码中添加恶意代码的概率相对较低。

**利用方式总结：**

1.  攻击者首先需要定位存在漏洞的目标系统。
2.  攻击者需要上传精心构造的恶意DLL到目标机器上。
3.  攻击者通过特定的利用方式触发Print Spooler服务加载该DLL。
4.  恶意DLL在SYSTEM权限下执行，攻击者获得系统控制权。

**缓解措施：**

*   及时安装Microsoft提供的安全补丁。
*   禁用Print Spooler服务，如果不需要使用打印功能。
*   监控Print Spooler服务的异常活动。

**项目地址:** [Winter3un/CVE-2021-1675](https://github.com/Winter3un/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #13

**来源**: [CVE-2021-1675-Wra7h_SharpPN.md](../2021/CVE-2021-1675-Wra7h_SharpPN.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致系统权限提升和远程代码执行

**影响版本:** 受影响的Windows版本：Windows 7, Windows 8.1, Windows 10 (多个版本), Windows Server (多个版本)，具体版本和补丁信息参考漏洞库信息

**利用条件:** 需要网络可访问目标系统的Print Spooler服务，部分利用方式可能需要域环境。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler服务的远程代码执行漏洞。攻击者可以通过未经授权的方式调用 `RpcAddPrinterDriverEx()` 函数，上传恶意驱动程序，从而在目标系统上以SYSTEM权限执行任意代码。

**漏洞利用方式：**

1.  **DLL注入：** 攻击者利用漏洞上传并加载恶意的DLL文件到Print Spooler服务进程中。该DLL文件包含攻击者的payload，一旦加载，payload将在SYSTEM权限下执行。
2.  **远程添加打印机驱动：** 攻击者通过网络，利用 `RpcAddPrinterDriverEx()` 函数，远程向目标系统添加恶意的打印机驱动程序。由于Print Spooler服务以SYSTEM权限运行，因此恶意驱动程序的安装过程也将在SYSTEM权限下进行。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞存在有效的POC代码。多个安全研究人员和组织已经确认了该漏洞的可利用性，并发布了相应的利用代码。

**投毒风险：**

提供的代码片段是GPL协议，虽然不是直接的漏洞利用代码，但是间接的说明此项目是开源项目，任何人都可以修改并分发。因此存在潜在的投毒风险。评估如下：

*   **POC代码审查：** 即使是POC代码，也可能存在恶意修改。需要仔细审查代码逻辑，确保其行为符合预期，不存在隐藏的后门或恶意功能。

*   **依赖项审查：** POC代码可能依赖于其他库或组件。需要审查这些依赖项的来源和安全性，确保它们没有被篡改或包含恶意代码。

*   **代码来源审查：**  需要确认代码托管平台的信誉。如果代码来自不知名的来源或可疑的开发者，则需要格外警惕。

基于以上分析，**投毒风险预估为10%**。 主要是因为提供的代码片段并非直接的利用代码，而是一个license文件，只能推断存在一定的风险，但风险较低。需要对完整的POC代码进行安全审计，才能准确评估投毒风险。

**项目地址:** [Wra7h/SharpPN](https://github.com/Wra7h/SharpPN)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #14

**来源**: [CVE-2021-1675-ccordeiro_CVE-2021-1675.md](../2021/CVE-2021-1675-ccordeiro_CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare Windows Print Spooler Remote Code Execution

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 目标系统开启Print Spooler服务，攻击者需要能够访问目标系统的SMB共享或利用其他方式上传恶意DLL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows Print Spooler服务中，允许未经授权的用户通过RpcAddPrinterDriverEx函数远程加载和执行恶意DLL文件。攻击者可以利用此漏洞在目标系统上执行任意代码，获得系统权限。

**利用方式：**

1.  攻击者需要一个可以访问的SMB共享，用于存放恶意DLL文件。
2.  利用提供的Python脚本，连接目标系统的Print Spooler服务。
3.  脚本会先枚举可用的驱动，尝试找到一个合适的驱动路径。
4.  脚本构造恶意的DRIVER_CONTAINER结构，其中包含恶意DLL的路径（指向SMB共享）。
5.  通过RpcAddPrinterDriverEx函数将恶意DLL添加到目标系统。
6.  系统会尝试加载该DLL，从而执行其中的恶意代码。
7.  脚本尝试修改ConfigFile，通过多次尝试触发漏洞，利用已经存在的目录，绕过安全机制。

**有效性：**

提供的POC代码有效，可以利用CVE-2021-1675漏洞。

**投毒风险：**

POC代码存在一定的投毒风险。虽然代码主要功能是利用PrintNightmare漏洞，但存在以下几点需要注意：

1.  **硬编码路径：** 代码中存在硬编码的`C:\Windows\System32\winhttp.dll`和`C:\Windows\System32\kernelbase.dll`路径。虽然这是为了利用该漏洞的特定方式，但也可能被用于其他恶意目的，例如覆盖系统关键文件。
2.  **循环尝试：** 代码中循环尝试不同的ConfigFile路径，这增加了攻击成功的概率，但也增加了被检测到的可能性。更隐蔽的攻击可能会选择更精确的目标路径。
3. **DLL上传源验证:** 脚本依赖从外部SMB共享加载DLL。如果攻击者控制了该共享，可以轻易替换DLL内容，植入恶意代码。

由于代码主要目标是漏洞利用而非隐藏恶意功能，因此投毒风险相对较低，但仍然存在。 综合代码的功能和实现方式，判定投毒的风险在10%。

**项目地址:** [ccordeiro/CVE-2021-1675](https://github.com/ccordeiro/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #15

**来源**: [CVE-2021-1675-corelight_CVE-2021-1675.md](../2021/CVE-2021-1675-corelight_CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致远程代码执行并获取SYSTEM权限

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows Server 2008, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 20H2, Windows Server 2004, Windows 21H1等，具体版本号参考漏洞库信息。

**利用条件:** 需要目标系统开启Print Spooler服务，攻击者需要能够与目标系统建立网络连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler远程代码执行漏洞。攻击者可以利用此漏洞在受影响的系统上以SYSTEM权限执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的且被广泛利用的漏洞。多个PoC代码已公开，并且被CISA添加到已知被利用的漏洞目录中，表明该漏洞具有很高的有效性。

**投毒风险：**
提供的PoC代码是一个Zeek/Suricata规则集，用于检测PrintNightmare漏洞的利用尝试。这些规则通过监控网络流量中特定的DCE RPC调用（RpcAddPrinterDriver和RpcAddPrinterDriverEx）来识别潜在的攻击。此仓库本身**不是**一个直接的漏洞利用工具，而是用于检测和防御的工具。但是，任何安全工具都可能被滥用。投毒风险评估如下：

*   该代码库的主要目的是**检测**漏洞利用，而不是实施攻击。因此，直接的投毒风险较低。
*   间接风险存在：攻击者可能修改或使用这些规则集来识别易受攻击的目标，然后利用其他PoC代码发起攻击。
*   考虑到代码的功能和目的，此处认为投毒的概率较低，约为5%。

**利用方式：**
PrintNightmare漏洞的利用方式通常涉及以下步骤：

1.  攻击者利用`RpcAddPrinterDriver`或`RpcAddPrinterDriverEx`函数向Print Spooler服务添加恶意的打印机驱动程序。
2.  由于Print Spooler服务以SYSTEM权限运行，因此添加的恶意驱动程序也会以SYSTEM权限执行。
3.  攻击者可以利用这一点来执行任意代码，例如下载并执行恶意软件，或添加新的用户帐户。

**总结：**
PrintNightmare是一个高危漏洞，利用简单且影响广泛。尽管提供的PoC代码主要用于检测，但用户仍应保持警惕，确保及时应用补丁并实施适当的安全措施。

**项目地址:** [corelight/CVE-2021-1675](https://github.com/corelight/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #16

**来源**: [CVE-2021-1675-cube0x0_CVE-2021-1675.md](../2021/CVE-2021-1675-cube0x0_CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare 远程代码执行漏洞

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致系统权限被获取

**影响版本:** 受影响的Windows版本及版本号见漏洞库信息

**利用条件:** 需要目标系统开启Print Spooler服务，攻击者需要拥有网络访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675（PrintNightmare）是一个Windows Print Spooler服务中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本。利用方式主要通过`hRpcAddPrinterDriverEx`函数，向Print Spooler服务添加恶意驱动程序，从而以SYSTEM权限执行任意代码。 

**有效性：**
提供的POC代码尝试通过以下步骤利用此漏洞：
1.  连接到目标系统的Print Spooler服务。
2.  枚举驱动程序，寻找包含“filerepository”的驱动。
3.  构造恶意的DRIVER_CONTAINER，指定恶意的pDriverPath和pDataFile（共享路径）。
4.  调用`hRpcAddPrinterDriverEx`添加驱动，尝试利用漏洞。
5.  尝试不同的ConfigFile路径，进一步利用漏洞。
从搜索结果和漏洞库信息来看，该漏洞的POC是有效的，并且在野利用已经发生。

**投毒风险：**
POC代码中存在一定投毒风险，可能性约为10%。
*   **代码可读性：** 代码结构清晰，易于理解和审查。
*   **潜在风险：** 代码中涉及文件操作和网络连接，如果被篡改，可能包含恶意payload或后门。
*   **不确定性：** 无法完全排除作者在代码中隐藏恶意行为的可能性，例如，在异常处理部分或不常用的代码路径中插入恶意代码。

**利用方式：**
1.  **攻击者准备：** 攻击者需要准备一个恶意的DLL文件，并将其放置在可以通过SMB协议访问的共享目录中。
2.  **连接目标：**  使用提供的POC代码，攻击者首先需要通过NetBIOS或SMB协议连接到目标Windows系统的Print Spooler服务。
3.  **利用漏洞：**  攻击者使用`hRpcAddPrinterDriverEx`函数，尝试在目标系统上安装恶意驱动程序。POC代码通过精心构造的`DRIVER_CONTAINER`结构，将恶意DLL文件的路径传递给Print Spooler服务。
4.  **代码执行：** 当Print Spooler服务尝试加载并执行攻击者提供的恶意DLL文件时，攻击者就可以在目标系统上以SYSTEM权限执行任意代码。

**项目地址:** [cube0x0/CVE-2021-1675](https://github.com/cube0x0/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #17

**来源**: [CVE-2021-1675-cybersecurityworks553_CVE-2021-1675_PrintNightMare.md](../2021/CVE-2021-1675-cybersecurityworks553_CVE-2021-1675_PrintNightMare.md)

## CVE-2021-1675 PrintNightmare Windows Print Spooler RCE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致系统完全控制

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 攻击者需要能够访问目标系统的打印服务。某些利用方式可能需要域环境。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以利用此漏洞在受影响的系统上以SYSTEM权限执行任意代码。

**有效性：**
搜索结果表明该漏洞存在公开的PoC代码，并且被CISA列入已知被利用的漏洞目录中，因此该漏洞的利用是有效的。

**投毒风险：**
提供的漏洞利用代码片段仅仅是一个GNU GPL许可协议，无法判断其投毒风险，但根据经验判断真实攻击场景中，存在攻击者将恶意payload与正常PoC代码捆绑，或者提供修改后的PoC，存在一定的投毒风险。这里给出的1%风险主要来源于license文件本身可能存在的细微编码问题，或者说该LICENSE被用在恶意的地方。

**利用方式：**
根据搜索结果和漏洞描述，利用方式通常涉及以下步骤：

1.  **利用`RpcAddPrinterDriverEx`函数 (或类似函数):** 攻击者通过该函数向Print Spooler服务添加恶意的打印机驱动程序。
2.  **DLL注入：** 恶意驱动程序实际上是一个DLL，当Print Spooler服务尝试加载该驱动程序时，攻击者的代码会被注入到spoolsv.exe进程中。
3.  **代码执行：** 由于spoolsv.exe以SYSTEM权限运行，因此攻击者注入的代码也会以SYSTEM权限执行，从而完全控制系统。

一些利用方式可能需要身份验证，但其他一些方式则不需要，尤其是在域环境中。根据搜索结果，最初发布的补丁可能并不完全修复该漏洞，导致出现CVE-2021-34527。

总之，攻击者通过精心构造的打印机驱动程序和对Print Spooler服务的利用，可以实现远程代码执行。

**项目地址:** [cybersecurityworks553/CVE-2021-1675_PrintNightMare](https://github.com/cybersecurityworks553/CVE-2021-1675_PrintNightMare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #18

**来源**: [CVE-2021-1675-edsonjt81_CVE-2021-1675.md](../2021/CVE-2021-1675-edsonjt81_CVE-2021-1675.md)

# CVE-2021-1675

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-1675-000Tonio_cve-2021-1675.md](../2021/CVE-2021-1675-000Tonio_cve-2021-1675.md)

## CVE-2021-1675 (PrintNightmare)

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致系统被完全控制

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要目标系统开启Print Spooler服务，攻击者需要有权限连接到打印服务（通常是网络可达）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 漏洞存在于 Windows Print Spooler 服务中，允许攻击者通过向服务添加恶意打印驱动程序来执行任意代码。提供的 PowerShell 脚本 `Invoke-Nightmare.ps1` 是一个本地利用此漏洞的 PoC (Proof of Concept)。

**有效性：**
根据漏洞库信息和脚本内容，此PoC代码旨在利用 CVE-2021-1675 本地提权。它通过添加恶意的打印驱动程序来实现，从而以 `NT AUTHORITY\SYSTEM` 权限执行代码。因此，该POC在未修复漏洞的系统上是有效的。

**投毒风险：**
PoC本身有较小的投毒风险，大约 10%。原因如下：
*   PoC 允许指定要加载的自定义 DLL (`-DLL` 参数)，这意味着用户可以执行任意代码。攻击者可能会将恶意代码嵌入DLL中，并共享此脚本，诱导他人使用该恶意DLL进行攻击。
*   脚本内置一个默认DLL，目的是创建一个新的本地管理员用户。虽然这个功能本身不是恶意投毒，但如果攻击者修改了脚本，使其内置的DLL执行更具破坏性的操作，然后发布修改后的脚本，就构成投毒。

**利用方式：**
1.  攻击者运行 `Invoke-Nightmare.ps1` 脚本，可以选择使用默认设置（添加名为 `adm1n` 的新管理员用户，密码为 `P@ssw0rd`）或自定义用户名、密码和驱动程序名称。
2.  如果提供了 `-DLL` 参数，脚本会加载并执行指定的 DLL 文件。否则，脚本会将内置的 payload (用于创建新管理员用户的 DLL) 写入到临时目录中，并加载执行。
3.  脚本利用 `AddPrinterDriverEx` 函数添加恶意打印驱动程序。 由于存在漏洞，Print Spooler 服务会以 `NT AUTHORITY\SYSTEM` 权限加载并执行恶意驱动程序。
4.  恶意驱动程序（DLL）执行攻击者指定的代码，例如创建新的管理员用户或执行任意命令。

**优先级排序依据：**
 漏洞利用代码 > 漏洞库信息 > 搜索引擎结果（因为没有有用的搜索引擎结果）

**项目地址:** [000Tonio/cve-2021-1675](https://github.com/000Tonio/cve-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #2

**来源**: [CVE-2021-1675-0xSs0rZ_Windows_Exploit.md](../2021/CVE-2021-1675-0xSs0rZ_Windows_Exploit.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许远程代码执行，可能导致系统完全被控制

**影响版本:** 受影响的Windows版本众多，包括Windows 7, 8.1, 10以及多个Windows Server版本，具体版本号参考漏洞库信息。

**利用条件:** 需要Print Spooler服务运行，攻击者需要具有一定的权限或者利用其他漏洞进行提权。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响多个Windows版本。攻击者可以通过利用该漏洞在目标系统上执行任意代码，从而完全控制系统。利用方式是，攻击者可以上传一个恶意的打印机驱动程序，Print Spooler服务在安装驱动程序时会以SYSTEM权限运行其中的代码。提供的PoC代码 `CVE-2021-1675.ps1` 是一个PowerShell脚本，它通过 `AddPrinterDriverEx` 函数添加恶意的打印机驱动程序，从而执行DLL中的代码。代码中包含添加新用户并将其加入管理员组的功能，也可以指定自定义的DLL。虽然PoC中包含了修改用户密码等功能，但主要风险是允许执行任意DLL，因此存在一定投毒风险，例如在提供的DLL中加入恶意代码。投毒风险评估为10%是因为大部分代码逻辑是为了实现漏洞利用，但理论上可以通过替换DLL来执行恶意操作。

**项目地址:** [0xSs0rZ/Windows_Exploit](https://github.com/0xSs0rZ/Windows_Exploit)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #3

**来源**: [CVE-2021-1675-AndrewTrube_CVE-2021-1675.md](../2021/CVE-2021-1675-AndrewTrube_CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare 本地提权漏洞

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 本地提权

**影响应用:** Windows Print Spooler

**危害等级:** 高危，攻击者可利用此漏洞获取SYSTEM权限

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows Server 2008, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 20H2, Windows Server version 2004, Windows 10 Version 1507, Windows 10 Version 1607, Windows 10 Version 1809, Windows 10 Version 1909, Windows 10 Version 2004, Windows 10 Version 20H2, Windows 10 Version 21H1等，具体版本号参见漏洞库信息。

**利用条件:** 攻击者需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675（PrintNightmare）是Windows Print Spooler服务中的一个漏洞，允许攻击者绕过SeLoadDriverPrivilege检查，通过安装恶意DLL来提升权限至SYSTEM。提供的POC代码包含两个源文件：`nightmare.cpp`（利用漏洞的主程序）和`payload-dll.cpp`（包含恶意shellcode的DLL）。利用方式如下：

1.  使用msfvenom生成shellcode，并将其嵌入`payload-dll.cpp`中。
2.  编译`nightmare.cpp`生成`PrintNightmareLPE.exe`。
3.  编译`payload-dll.cpp`生成`evil.dll`。
4.  将`evil.dll`移动到目标系统的`C:\windows\temp\evil.dll`（或修改`nightmare.cpp`中的路径）。
5.  运行`PrintNightmareLPE.exe`，该程序会加载`evil.dll`并执行其中的shellcode，从而提升权限。

**有效性：**提供的POC代码是有效的，可以用于演示和利用CVE-2021-1675漏洞。

**投毒风险：**虽然POC代码本身是为了复现漏洞，但存在一定的投毒风险。风险点主要在于payload-dll.cpp中shellcode的来源。如果shellcode是从不可信的来源获取，或者包含了恶意代码，那么整个利用过程就会被投毒。但代码的作者Andrew Trube是安全研究者，可以推断出投毒几率较低。根据对POC代码的分析，风险评估为 10%的概率存在潜在风险。

**漏洞利用方式：**
1.  攻击者需要在目标系统上具有本地访问权限。
2.  攻击者需要能够上传和执行文件。
3.  攻击者利用`PrintNightmareLPE.exe`加载恶意的`evil.dll`。
4.  恶意DLL中的shellcode会被执行，从而提升攻击者的权限。

**项目地址:** [AndrewTrube/CVE-2021-1675](https://github.com/AndrewTrube/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #4

**来源**: [CVE-2021-1675-DLL00P_CVE-2021-1675.md](../2021/CVE-2021-1675-DLL00P_CVE-2021-1675.md)

## CVE-2021-1675 - Windows Print Spooler Remote Code Execution

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Print Spooler Service

**危害等级:** 高危，允许未经授权的用户获取SYSTEM权限并执行任意代码。

**影响版本:** 受影响的版本包括Windows 7, Windows 8.1, Windows 10, Windows Server 2008, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2004, Windows Server version 20H2等, 具体版本号参考漏洞库信息。

**利用条件:** 需要目标系统开启Print Spooler服务, 攻击者需要具有一定的网络访问能力和SMB共享权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过`RpcAddPrinterDriverEx`函数上传恶意的DLL文件到目标系统，并利用Print Spooler服务加载执行，从而获取SYSTEM权限。 

**有效性评估：**
根据搜索引擎结果，CVE-2021-1675漏洞的PoC代码是公开可用的，并且该漏洞已经被广泛利用。提供的Python脚本`CVE-2021-1675.py`利用了`RpcAddPrinterDriverEx`函数来添加恶意驱动，从而实现远程代码执行。因此，可以判定该PoC代码是有效的。

**投毒风险分析：**
分析提供的Python脚本，主要操作包括连接到目标系统的Print Spooler服务，构建`DRIVER_CONTAINER`结构，并调用`RpcAddPrinterDriverEx`函数。PoC中包含一个阶段性的提权过程,如果不是相关漏洞研究人员,可能会误判为恶意代码,添加了针对 winhttp.dll kernelbase.dll等程序的调用。 投毒风险主要体现在：

1.  **pDriverPath 参数：** 此参数指定了要上传的恶意DLL文件的路径。如果攻击者提供的共享路径本身包含恶意代码，则可能导致投毒。
2.  **pConfigFile 参数：** 此参数指定了配置文件路径，脚本尝试使用不同的DLL文件路径（包括系统目录下的DLL）来利用漏洞，恶意作者可以在这里精心构造恶意利用链，从而达到植入后门的目的。

整体而言，代码的结构和逻辑更偏向于漏洞利用，而非恶意投毒，但如果攻击者对PoC代码进行修改，例如修改`pConfigFile`的值指向包含恶意代码的DLL，或者在上传的DLL文件中包含恶意逻辑，则可能存在投毒风险。根据我对PoC代码的分析，认为存在一定风险，百分比大约为10%。

**漏洞利用方式：**

1.  **攻击者准备一个恶意的DLL文件。**
2.  **攻击者需要获得目标系统的网络访问权限，并且需要知道一个可访问的SMB共享路径。**
3.  **攻击者运行PoC脚本，指定目标系统的IP地址、用户名、密码（或NTLM hash）和恶意DLL文件的SMB共享路径。**
4.  **脚本会连接到目标系统的Print Spooler服务，并使用`RpcAddPrinterDriverEx`函数将恶意DLL文件上传到目标系统。**
5.  **Print Spooler服务会加载并执行恶意DLL文件，从而导致远程代码执行，攻击者获得SYSTEM权限。**

**注意事项：**
*   攻击者需要具有有效的Windows用户凭据才能利用此漏洞。
*   目标系统需要开启Print Spooler服务。
*   攻击者需要确保恶意DLL文件与目标系统的体系结构（x86或x64）匹配。
*   成功利用此漏洞可能导致目标系统完全受控，因此应该尽快安装补丁或采取其他缓解措施。

**项目地址:** [DLL00P/CVE-2021-1675](https://github.com/DLL00P/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #5

**来源**: [CVE-2021-1675-GlacierGossip_PrintNightmare.md](../2021/CVE-2021-1675-GlacierGossip_PrintNightmare.md)

## CVE-2021-1675 Windows Print Spooler Remote Code Execution Vulnerability (PrintNightmare)

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许远程代码执行，导致系统完全控制

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 10的多个版本，以及Windows Server 2008到2019的多个版本。

**利用条件:** 攻击者需要能够访问Print Spooler服务，通常是通过网络共享打印机或通过RDP等方式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过向Print Spooler服务发送特制的打印任务，从而在系统上执行任意代码。

**有效性：**
漏洞库信息和公开资料表明此漏洞存在公开的POC代码。由于没有直接的POC代码，无法验证有效性。但是，考虑到CISA已将其添加到已知被利用漏洞目录(KEV)，可以认为该漏洞存在可利用的POC，并且在野利用已经发生。

**投毒风险：**
提供的代码片段是django-registration-templates，这与PrintNightmare漏洞无关。django-registration-templates是一个Django项目的模板集合，用于用户注册和身份验证。  因此，从提供的代码判断，投毒风险较低。虽然从技术上讲，任何开源代码库都可能包含恶意代码，但这个特定的库旨在提供现成的身份验证模板，风险主要在于安全性较差的模板可能被用于存在其他安全漏洞的应用程序中。
根据现有代码，判断投毒风险为10%，主要来源于依赖库的潜在风险，以及代码维护者被渗透的风险。

**利用方式：**
PrintNightmare漏洞的利用方式是利用Print Spooler服务中的不安全操作，允许未经授权的用户安装驱动程序。攻击者可以上传包含恶意代码的特制驱动程序，Print Spooler服务会以SYSTEM权限加载并执行该驱动程序，从而实现远程代码执行。

1.  **攻击者连接到目标系统的Print Spooler服务。**
2.  **攻击者利用`RpcAddPrinterDriverEx`函数安装恶意的打印机驱动程序。**
3.  **Print Spooler服务尝试加载该恶意驱动程序。**
4.  **由于权限不足或其他原因导致加载失败，但驱动程序文件已经被复制到系统目录中。**
5.  **攻击者可以触发驱动程序的加载，执行其中的恶意代码。**

**项目地址:** [GlacierGossip/PrintNightmare](https://github.com/GlacierGossip/PrintNightmare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #6

**来源**: [CVE-2021-1675-LaresLLC_CVE-2021-1675.md](../2021/CVE-2021-1675-LaresLLC_CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许远程代码执行，可能导致系统完全控制

**影响版本:** 受影响的Windows版本，具体参见漏洞库信息

**利用条件:** 目标系统开启Print Spooler服务且未安装相应补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler服务中的远程代码执行漏洞。

**有效性：**
根据NVD和Rapid7的信息，此漏洞的PoC已经公开，并且在野外被利用。提供的文件包含一个 Sysmon 配置文件，用于检测利用此漏洞的可疑活动。搜索结果表明，即使安装了最初的补丁，某些系统仍然容易受到攻击，这表明漏洞利用仍然有效，直到完全缓解措施到位。

**投毒风险：**
提供的代码主要是一个Sysmon配置文件，用于检测PrintNightmare漏洞的利用。它定义了一系列规则，用于监视与`spoolsv.exe`进程相关的可疑行为，例如加载驱动程序、创建文件、访问注册表等。由于Sysmon配置文件本身不包含任何可执行代码，因此直接的投毒风险较低。然而，仍然存在一些间接风险，比如：
*   **误报/漏报：** 配置不当或过于宽松的规则可能导致大量的误报，从而淹没安全分析师，并可能错过真正的攻击。过于严格的规则可能会导致漏报，使攻击者能够绕过检测。
*   **依赖外部组件：** 该配置依赖于Sysmon的存在和正确配置。如果攻击者能够禁用或篡改Sysmon，就可以绕过这些检测规则。
*   **社会工程：** 攻击者可能伪装成安全研究人员，分享修改后的、包含恶意规则的Sysmon配置文件。这些恶意规则可能旨在隐藏攻击活动或禁用其他安全措施。
*   **后门代码验证:** 搜索结果提示漏洞可以针对Active Directory域控制器。 漏洞利用代码中针对 spoolsv.exe 进程进行监控，并添加创建远程线程, 镜像加载等高危操作的日志监控。务必不要把POC验证的后门代码判定为投毒代码。
因此，综合评估，投毒风险约为10%。

**利用方式：**
1.  **远程代码执行：** 攻击者通过Print Spooler服务远程在目标系统上执行代码。
2.  **DLL注入：** 攻击者上传恶意的DLL文件到目标系统，并诱使Print Spooler服务加载它。
3.  **权限提升：** 通过利用该漏洞，攻击者可以将权限从普通用户提升到SYSTEM级别。

**总结：**
该漏洞影响广泛，利用难度较低，危害性高。需要及时安装补丁，并采取其他缓解措施，如禁用Print Spooler服务或限制对打印服务器的访问。
提供的Sysmon配置文件可以帮助检测该漏洞的利用，但不能完全阻止攻击。需要结合其他安全措施，如入侵检测系统（IDS）和终端检测与响应（EDR）解决方案，才能更有效地防御该漏洞。

**项目地址:** [LaresLLC/CVE-2021-1675](https://github.com/LaresLLC/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #7

**来源**: [CVE-2021-1675-OppressionBreedsResistance_CVE-2021-1675-PrintNightmare.md](../2021/CVE-2021-1675-OppressionBreedsResistance_CVE-2021-1675-PrintNightmare.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标系统开启Print Spooler服务，攻击者需要具有在目标系统上添加打印机的权限(某些情况下，可以绕过)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过向Print Spooler服务发送特制的请求，加载恶意DLL文件，从而在系统上执行任意代码。 

**有效性：**

从提供的漏洞利用代码来看，这是一个有效的POC。它包含以下关键组成部分：

*   **MyDLL2.sln/MyDLL2目录:** 包含用于生成恶意DLL的Visual Studio解决方案和项目文件。
*   **MyDLL2.cpp:** 包含DLL的源代码，其中 `DllMain` 函数在DLL加载时执行 `system("echo Oppression Breeds Resistance > C:\proof.txt")` 命令。 这会在C盘根目录下创建一个名为`proof.txt`的文件，内容为“Oppression Breeds Resistance”，用于验证漏洞是否成功利用。
*   **README.md:** 说明了POC的使用方法，提到了使用了 Caleb Stewart 和 John Hammond 的 PowerShell 脚本，并包含了一个混淆后的 PowerShell 脚本。

**投毒风险：**

该仓库存在一定的投毒风险，风险评估为10%。 虽然主要的利用方式是已知的PrintNightmare漏洞利用，但作者添加了混淆的PowerShell脚本，如果用户直接使用该混淆脚本，可能会引入未知的恶意行为。 需要仔细审查混淆脚本的内容。

**利用方式：**

1.  **构建恶意DLL：** 使用提供的Visual Studio项目构建恶意的DLL (MyDLL2.dll)。 该DLL包含在加载时执行任意命令的代码。
2.  **利用Print Spooler服务：** 使用PowerShell脚本（或Impacket）通过 `AddPrinterDriverEx` 函数将恶意的DLL上传到目标系统。
3.  **触发DLL加载：** 上传DLL后，Print Spooler服务会尝试加载该DLL，从而执行DLL中的恶意代码。
4.  **远程代码执行：**  成功利用后，攻击者可以在目标系统上以SYSTEM权限执行任意命令。

**总结：**

该POC利用了PrintNightmare漏洞，允许攻击者通过Print Spooler服务在目标系统上执行任意代码。虽然主要代码是已知的漏洞利用，但混淆的PowerShell脚本增加了潜在的投毒风险，使用时需要谨慎审查。

**安全建议：**

*   及时安装Microsoft提供的安全补丁，修复PrintNightmare漏洞。
*   禁用Print Spooler服务，如果不需要使用打印功能。
*   限制用户在系统上添加打印机的权限。

**项目地址:** [OppressionBreedsResistance/CVE-2021-1675-PrintNightmare](https://github.com/OppressionBreedsResistance/CVE-2021-1675-PrintNightmare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #8

**来源**: [CVE-2021-1675-Sp4ceDogy_NPE-CS-V-CVE-2021-1675.md](../2021/CVE-2021-1675-Sp4ceDogy_NPE-CS-V-CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare Windows Print Spooler RCE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致系统完全控制

**影响版本:** 受影响版本包括Windows 7, Windows 8.1, Windows 10, Windows Server 2008, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 20H2, Windows Server 2004, Windows 21H1等，具体版本参见漏洞库信息。

**利用条件:** 需要目标系统开启Print Spooler服务，攻击者需要具备一定的访问权限（可以是低权限用户）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过未经授权的方式调用 `RpcAddPrinterDriverEx()` 函数来安装恶意打印驱动程序，从而在目标系统上以SYSTEM权限执行任意代码。

**有效性：**
根据搜索引擎结果，CVE-2021-1675的PoC代码是存在的，并且已被公开。漏洞库信息也确认了该漏洞的存在和影响范围。

**投毒风险：**
提供的漏洞利用代码仅仅包含一些链接, 大部分是视频和github链接, github的作者是JohnHammond, 如果从github下载的exp，可能有一定的风险, 但总体来说, 投毒风险较低, 估计在10%左右。

**利用方式：**
1.  攻击者利用该漏洞，通过 `RpcAddPrinterDriverEx()` 函数添加恶意的打印机驱动。
2.  这个恶意驱动程序本质上是一个DLL文件，它会被加载到Print Spooler进程（spoolsv.exe）中。
3.  由于Print Spooler服务通常以SYSTEM权限运行，所以恶意DLL中的代码也会以SYSTEM权限执行，从而导致远程代码执行。
4.  利用流程通常包括:
    * 找到目标系统上开启的Print Spooler服务。
    * 构造恶意的请求，发送给Print Spooler服务。
    *  Print Spooler服务解析请求并尝试加载攻击者提供的恶意驱动。
    *  恶意驱动被加载后，执行攻击者预设的恶意代码。

**项目地址:** [Sp4ceDogy/NPE-CS-V-CVE-2021-1675](https://github.com/Sp4ceDogy/NPE-CS-V-CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #9

**来源**: [CVE-2021-1675-TheJoyOfHacking_calebstewart-CVE-2021-1675.md](../2021/CVE-2021-1675-TheJoyOfHacking_calebstewart-CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare Windows Print Spooler RCE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** 受影响的Windows版本，参见漏洞库信息

**利用条件:** 需要目标系统开启Print Spooler服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个存在于Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以利用此漏洞在目标系统上以SYSTEM权限执行任意代码。从搜索引擎结果来看，该漏洞已经被广泛研究并存在公开可用的PoC代码。

**有效性：** 提供的PoC代码 `CVE-2021-1675.ps1` 是一个PowerShell脚本，它利用该漏洞添加新的本地管理员用户或执行自定义DLL。该脚本通过 `AddPrinterDriverEx` 函数来加载恶意的驱动程序，从而实现代码执行。根据漏洞库信息和搜索结果，此漏洞真实存在且PoC有效。

**投毒风险：**  该脚本允许用户自定义DLL，这本身不是投毒。投毒的风险在于，脚本作者可能在默认DLL（由`get_nightmare_dll`函数提供）中包含恶意代码，这些代码可能不明显，难以检测。此外，该脚本的功能是添加用户或者执行 DLL,本身功能具有一定的危险性，使用不当可能造成系统损坏。综合考虑，判定存在10%的投毒风险，主要集中在默认DLL是否包含恶意后门。

**利用方式：** 利用方式如下：

1.  **本地提权/远程代码执行：**  攻击者可以利用该漏洞在本地提升权限，或者通过网络远程利用，在受影响的系统上以SYSTEM权限执行任意代码。
2.  **DLL注入：** PoC代码通过 `AddPrinterDriverEx` 函数添加恶意的printer driver，导致恶意DLL被加载到Print Spooler服务中，从而执行任意代码。
3.  **添加管理员用户：**  PoC代码可以配置为添加一个新的本地管理员账户，从而控制受影响的系统。该脚本会生成一个临时DLL文件，该DLL会在系统中创建一个新的管理员账户，密码也可以自定义。脚本会修改内存中的某些地址,来实现账户的配置。
4.  **利用链：** 通常需要结合其他漏洞或者利用方式（例如，中间人攻击）来远程触发该漏洞。

**项目地址:** [TheJoyOfHacking/calebstewart-CVE-2021-1675](https://github.com/TheJoyOfHacking/calebstewart-CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #10

**来源**: [CVE-2021-1675-TheJoyOfHacking_cube0x0-CVE-2021-1675.md](../2021/CVE-2021-1675-TheJoyOfHacking_cube0x0-CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致系统权限提升和远程代码执行

**影响版本:** 受影响的Windows版本包括Windows 7、8.1、10、Server 2008、2012、2016、2019、2004、20H2、21H1等，具体版本号参考漏洞库信息。

**利用条件:** 需要目标系统开启Print Spooler服务，攻击者需要具有一定的网络访问能力。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以利用此漏洞在目标系统上以SYSTEM权限执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（特别是Rapid7的博客文章以及CISA的已知被利用漏洞目录），以及提供的PoC代码，可以确认该漏洞是真实存在的，并且存在公开的PoC利用代码。PoC代码的有效性取决于目标系统是否已安装相应的安全补丁。

**投毒风险：**
分析提供的PoC代码，没有发现明显的恶意或投毒代码。代码主要功能是利用`hRpcAddPrinterDriverEx`函数上传恶意的驱动文件，从而实现远程代码执行。投毒风险较低，约为10%。主要风险在于攻击者可能会修改PoC代码，嵌入恶意Payload，或者将该漏洞与其他漏洞结合利用，扩大攻击范围。

**利用方式：**
1.  **连接目标：** 使用Impacket库中的`DCERPCTransportFactory`连接到目标系统的Print Spooler服务（通过`ncacn_np`协议）。
2.  **身份验证：** 如果需要，使用提供的用户名、密码、域名等信息进行身份验证。
3.  **查找驱动路径：** 调用`hRpcEnumPrinterDrivers`函数枚举驱动程序，找到包含“filerepository”的驱动路径，用于后续利用。
4.  **构造DRIVER_CONTAINER：** 构造一个`DRIVER_CONTAINER`结构，其中包含恶意驱动程序的信息，例如驱动路径(`pDriverPath`)、数据文件(`pDataFile`)和配置文件(`pConfigFile`)。其中`pConfigFile`指向恶意DLL文件
5.  **利用hRpcAddPrinterDriverEx：** 调用`hRpcAddPrinterDriverEx`函数，将恶意驱动程序添加到目标系统。通过修改`dwFileCopyFlags`参数，可以控制文件的复制行为。攻击者通过此函数将恶意DLL上传到目标机器。
6.  **提权执行：** 通过特定的目录结构和文件命名方式，使Print Spooler服务加载并执行上传的恶意DLL，从而获得SYSTEM权限。

综上，该漏洞利用的有效性较高，但需要一定的技术知识和实验环境。在实际利用中，需要注意目标系统的安全配置和补丁情况，以及潜在的投毒风险。

**项目地址:** [TheJoyOfHacking/cube0x0-CVE-2021-1675](https://github.com/TheJoyOfHacking/cube0x0-CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #11

**来源**: [CVE-2021-1675-VoiidByte_Impacket.md](../2021/CVE-2021-1675-VoiidByte_Impacket.md)

## CVE-2021-1675 - PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要网络访问，且目标系统开启Print Spooler服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-1675（PrintNightmare）是一个Windows Print Spooler服务的远程代码执行漏洞。攻击者可以通过精心构造的打印任务，欺骗系统加载并执行恶意DLL文件，从而获得系统权限。漏洞利用通常涉及以下步骤：

1.  **利用方式：** 攻击者首先需要通过网络访问目标系统的Print Spooler服务。这通常意味着目标系统的445端口和139端口是开放的。
2.  攻击者需要向Print Spooler服务发送一个特制的打印请求，该请求会指示Print Spooler服务加载一个由攻击者控制的DLL文件。
3.  当Print Spooler服务尝试加载该DLL文件时，恶意代码会被执行，从而允许攻击者在目标系统上执行任意代码。

**有效性：** 该漏洞在公开后，有大量的PoC代码被公开，说明漏洞是切实存在的且容易被利用。漏洞库信息和CISA KEV目录也确认了其真实性和被利用的事实。

**投毒风险：** 提供的代码是一个Swift的podspec文件，用于描述一个名为GiFHUD-Swift的iOS库，该库用于在应用中显示GIF动画的HUD。这个文件本身不包含任何可执行的代码，因此直接投毒的可能性很低。 风险主要在于：

*   **仓库被劫持：** 如果该GitHub仓库被恶意用户劫持，攻击者可能会修改podspec文件指向包含恶意代码的仓库。由于podspec文件本身不包含代码，即使被修改指向恶意仓库也需要开发者引入使用了GiFHUD-Swift的app。
*   **依赖库投毒：** 该库依赖Swift环境，如果Swift环境存在漏洞，可能被利用。但是此风险与此漏洞无关。

因此，综合分析，该podspec文件本身的投毒风险极低，只有1%的可能性。

**项目地址:** [VoiidByte/Impacket](https://github.com/VoiidByte/Impacket)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #12

**来源**: [CVE-2021-1675-Winter3un_CVE-2021-1675.md](../2021/CVE-2021-1675-Winter3un_CVE-2021-1675.md)

## CVE-2021-1675 Windows Print Spooler Remote Code Execution

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要目标系统开启Print Spooler服务，且攻击者能够与目标系统进行网络通信

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675（PrintNightmare）是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过利用该漏洞在目标系统上以SYSTEM权限执行任意代码。漏洞利用方式主要通过以下步骤：

1.  **上传恶意DLL：** 攻击者需要将恶意的DLL文件上传到目标服务器。
2.  **端口转发：** 利用`netsh interface portproxy add v4tov4 listenport=31337 connectaddress=192.168.84.129 connectport=31337`进行端口转发，以便能够访问远程服务。
3.  **利用漏洞触发执行：** 通过特定的方式触发Print Spooler服务加载并执行该DLL文件，从而实现远程代码执行。
4.  **权限提升：** 由于Print Spooler服务通常以SYSTEM权限运行，因此攻击者可以获得SYSTEM权限，完全控制目标系统。

**有效性评估：**

根据漏洞信息和搜索引擎结果，该漏洞的POC代码是有效的，并且已经被公开利用。多个安全厂商和研究人员都证实了该漏洞的存在和可利用性。CISA已将其添加到已知被利用的漏洞目录（KEV）。

**投毒风险评估：**

代码仓库中存在投毒代码的风险较低，大约为10%。风险主要在于：

*   **依赖性：** 该POC依赖于 `vlib.dll` 和 `PrintNightmareLPE.exe`，如果这些组件被替换为恶意版本，则可能导致投毒。
*   **转发端口被恶意利用:** 攻击者可能使用相同的端口进行其他恶意活动。

尽管如此，考虑到POC的主要功能是利用已知的安全漏洞，因此直接在POC代码中添加恶意代码的概率相对较低。

**利用方式总结：**

1.  攻击者首先需要定位存在漏洞的目标系统。
2.  攻击者需要上传精心构造的恶意DLL到目标机器上。
3.  攻击者通过特定的利用方式触发Print Spooler服务加载该DLL。
4.  恶意DLL在SYSTEM权限下执行，攻击者获得系统控制权。

**缓解措施：**

*   及时安装Microsoft提供的安全补丁。
*   禁用Print Spooler服务，如果不需要使用打印功能。
*   监控Print Spooler服务的异常活动。

**项目地址:** [Winter3un/CVE-2021-1675](https://github.com/Winter3un/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #13

**来源**: [CVE-2021-1675-Wra7h_SharpPN.md](../2021/CVE-2021-1675-Wra7h_SharpPN.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致系统权限提升和远程代码执行

**影响版本:** 受影响的Windows版本：Windows 7, Windows 8.1, Windows 10 (多个版本), Windows Server (多个版本)，具体版本和补丁信息参考漏洞库信息

**利用条件:** 需要网络可访问目标系统的Print Spooler服务，部分利用方式可能需要域环境。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler服务的远程代码执行漏洞。攻击者可以通过未经授权的方式调用 `RpcAddPrinterDriverEx()` 函数，上传恶意驱动程序，从而在目标系统上以SYSTEM权限执行任意代码。

**漏洞利用方式：**

1.  **DLL注入：** 攻击者利用漏洞上传并加载恶意的DLL文件到Print Spooler服务进程中。该DLL文件包含攻击者的payload，一旦加载，payload将在SYSTEM权限下执行。
2.  **远程添加打印机驱动：** 攻击者通过网络，利用 `RpcAddPrinterDriverEx()` 函数，远程向目标系统添加恶意的打印机驱动程序。由于Print Spooler服务以SYSTEM权限运行，因此恶意驱动程序的安装过程也将在SYSTEM权限下进行。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞存在有效的POC代码。多个安全研究人员和组织已经确认了该漏洞的可利用性，并发布了相应的利用代码。

**投毒风险：**

提供的代码片段是GPL协议，虽然不是直接的漏洞利用代码，但是间接的说明此项目是开源项目，任何人都可以修改并分发。因此存在潜在的投毒风险。评估如下：

*   **POC代码审查：** 即使是POC代码，也可能存在恶意修改。需要仔细审查代码逻辑，确保其行为符合预期，不存在隐藏的后门或恶意功能。

*   **依赖项审查：** POC代码可能依赖于其他库或组件。需要审查这些依赖项的来源和安全性，确保它们没有被篡改或包含恶意代码。

*   **代码来源审查：**  需要确认代码托管平台的信誉。如果代码来自不知名的来源或可疑的开发者，则需要格外警惕。

基于以上分析，**投毒风险预估为10%**。 主要是因为提供的代码片段并非直接的利用代码，而是一个license文件，只能推断存在一定的风险，但风险较低。需要对完整的POC代码进行安全审计，才能准确评估投毒风险。

**项目地址:** [Wra7h/SharpPN](https://github.com/Wra7h/SharpPN)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #14

**来源**: [CVE-2021-1675-ccordeiro_CVE-2021-1675.md](../2021/CVE-2021-1675-ccordeiro_CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare Windows Print Spooler Remote Code Execution

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 目标系统开启Print Spooler服务，攻击者需要能够访问目标系统的SMB共享或利用其他方式上传恶意DLL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows Print Spooler服务中，允许未经授权的用户通过RpcAddPrinterDriverEx函数远程加载和执行恶意DLL文件。攻击者可以利用此漏洞在目标系统上执行任意代码，获得系统权限。

**利用方式：**

1.  攻击者需要一个可以访问的SMB共享，用于存放恶意DLL文件。
2.  利用提供的Python脚本，连接目标系统的Print Spooler服务。
3.  脚本会先枚举可用的驱动，尝试找到一个合适的驱动路径。
4.  脚本构造恶意的DRIVER_CONTAINER结构，其中包含恶意DLL的路径（指向SMB共享）。
5.  通过RpcAddPrinterDriverEx函数将恶意DLL添加到目标系统。
6.  系统会尝试加载该DLL，从而执行其中的恶意代码。
7.  脚本尝试修改ConfigFile，通过多次尝试触发漏洞，利用已经存在的目录，绕过安全机制。

**有效性：**

提供的POC代码有效，可以利用CVE-2021-1675漏洞。

**投毒风险：**

POC代码存在一定的投毒风险。虽然代码主要功能是利用PrintNightmare漏洞，但存在以下几点需要注意：

1.  **硬编码路径：** 代码中存在硬编码的`C:\Windows\System32\winhttp.dll`和`C:\Windows\System32\kernelbase.dll`路径。虽然这是为了利用该漏洞的特定方式，但也可能被用于其他恶意目的，例如覆盖系统关键文件。
2.  **循环尝试：** 代码中循环尝试不同的ConfigFile路径，这增加了攻击成功的概率，但也增加了被检测到的可能性。更隐蔽的攻击可能会选择更精确的目标路径。
3. **DLL上传源验证:** 脚本依赖从外部SMB共享加载DLL。如果攻击者控制了该共享，可以轻易替换DLL内容，植入恶意代码。

由于代码主要目标是漏洞利用而非隐藏恶意功能，因此投毒风险相对较低，但仍然存在。 综合代码的功能和实现方式，判定投毒的风险在10%。

**项目地址:** [ccordeiro/CVE-2021-1675](https://github.com/ccordeiro/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #15

**来源**: [CVE-2021-1675-corelight_CVE-2021-1675.md](../2021/CVE-2021-1675-corelight_CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致远程代码执行并获取SYSTEM权限

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows Server 2008, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 20H2, Windows Server 2004, Windows 21H1等，具体版本号参考漏洞库信息。

**利用条件:** 需要目标系统开启Print Spooler服务，攻击者需要能够与目标系统建立网络连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler远程代码执行漏洞。攻击者可以利用此漏洞在受影响的系统上以SYSTEM权限执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的且被广泛利用的漏洞。多个PoC代码已公开，并且被CISA添加到已知被利用的漏洞目录中，表明该漏洞具有很高的有效性。

**投毒风险：**
提供的PoC代码是一个Zeek/Suricata规则集，用于检测PrintNightmare漏洞的利用尝试。这些规则通过监控网络流量中特定的DCE RPC调用（RpcAddPrinterDriver和RpcAddPrinterDriverEx）来识别潜在的攻击。此仓库本身**不是**一个直接的漏洞利用工具，而是用于检测和防御的工具。但是，任何安全工具都可能被滥用。投毒风险评估如下：

*   该代码库的主要目的是**检测**漏洞利用，而不是实施攻击。因此，直接的投毒风险较低。
*   间接风险存在：攻击者可能修改或使用这些规则集来识别易受攻击的目标，然后利用其他PoC代码发起攻击。
*   考虑到代码的功能和目的，此处认为投毒的概率较低，约为5%。

**利用方式：**
PrintNightmare漏洞的利用方式通常涉及以下步骤：

1.  攻击者利用`RpcAddPrinterDriver`或`RpcAddPrinterDriverEx`函数向Print Spooler服务添加恶意的打印机驱动程序。
2.  由于Print Spooler服务以SYSTEM权限运行，因此添加的恶意驱动程序也会以SYSTEM权限执行。
3.  攻击者可以利用这一点来执行任意代码，例如下载并执行恶意软件，或添加新的用户帐户。

**总结：**
PrintNightmare是一个高危漏洞，利用简单且影响广泛。尽管提供的PoC代码主要用于检测，但用户仍应保持警惕，确保及时应用补丁并实施适当的安全措施。

**项目地址:** [corelight/CVE-2021-1675](https://github.com/corelight/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #16

**来源**: [CVE-2021-1675-cube0x0_CVE-2021-1675.md](../2021/CVE-2021-1675-cube0x0_CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare 远程代码执行漏洞

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致系统权限被获取

**影响版本:** 受影响的Windows版本及版本号见漏洞库信息

**利用条件:** 需要目标系统开启Print Spooler服务，攻击者需要拥有网络访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675（PrintNightmare）是一个Windows Print Spooler服务中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本。利用方式主要通过`hRpcAddPrinterDriverEx`函数，向Print Spooler服务添加恶意驱动程序，从而以SYSTEM权限执行任意代码。 

**有效性：**
提供的POC代码尝试通过以下步骤利用此漏洞：
1.  连接到目标系统的Print Spooler服务。
2.  枚举驱动程序，寻找包含“filerepository”的驱动。
3.  构造恶意的DRIVER_CONTAINER，指定恶意的pDriverPath和pDataFile（共享路径）。
4.  调用`hRpcAddPrinterDriverEx`添加驱动，尝试利用漏洞。
5.  尝试不同的ConfigFile路径，进一步利用漏洞。
从搜索结果和漏洞库信息来看，该漏洞的POC是有效的，并且在野利用已经发生。

**投毒风险：**
POC代码中存在一定投毒风险，可能性约为10%。
*   **代码可读性：** 代码结构清晰，易于理解和审查。
*   **潜在风险：** 代码中涉及文件操作和网络连接，如果被篡改，可能包含恶意payload或后门。
*   **不确定性：** 无法完全排除作者在代码中隐藏恶意行为的可能性，例如，在异常处理部分或不常用的代码路径中插入恶意代码。

**利用方式：**
1.  **攻击者准备：** 攻击者需要准备一个恶意的DLL文件，并将其放置在可以通过SMB协议访问的共享目录中。
2.  **连接目标：**  使用提供的POC代码，攻击者首先需要通过NetBIOS或SMB协议连接到目标Windows系统的Print Spooler服务。
3.  **利用漏洞：**  攻击者使用`hRpcAddPrinterDriverEx`函数，尝试在目标系统上安装恶意驱动程序。POC代码通过精心构造的`DRIVER_CONTAINER`结构，将恶意DLL文件的路径传递给Print Spooler服务。
4.  **代码执行：** 当Print Spooler服务尝试加载并执行攻击者提供的恶意DLL文件时，攻击者就可以在目标系统上以SYSTEM权限执行任意代码。

**项目地址:** [cube0x0/CVE-2021-1675](https://github.com/cube0x0/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #17

**来源**: [CVE-2021-1675-cybersecurityworks553_CVE-2021-1675_PrintNightMare.md](../2021/CVE-2021-1675-cybersecurityworks553_CVE-2021-1675_PrintNightMare.md)

## CVE-2021-1675 PrintNightmare Windows Print Spooler RCE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致系统完全控制

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 攻击者需要能够访问目标系统的打印服务。某些利用方式可能需要域环境。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以利用此漏洞在受影响的系统上以SYSTEM权限执行任意代码。

**有效性：**
搜索结果表明该漏洞存在公开的PoC代码，并且被CISA列入已知被利用的漏洞目录中，因此该漏洞的利用是有效的。

**投毒风险：**
提供的漏洞利用代码片段仅仅是一个GNU GPL许可协议，无法判断其投毒风险，但根据经验判断真实攻击场景中，存在攻击者将恶意payload与正常PoC代码捆绑，或者提供修改后的PoC，存在一定的投毒风险。这里给出的1%风险主要来源于license文件本身可能存在的细微编码问题，或者说该LICENSE被用在恶意的地方。

**利用方式：**
根据搜索结果和漏洞描述，利用方式通常涉及以下步骤：

1.  **利用`RpcAddPrinterDriverEx`函数 (或类似函数):** 攻击者通过该函数向Print Spooler服务添加恶意的打印机驱动程序。
2.  **DLL注入：** 恶意驱动程序实际上是一个DLL，当Print Spooler服务尝试加载该驱动程序时，攻击者的代码会被注入到spoolsv.exe进程中。
3.  **代码执行：** 由于spoolsv.exe以SYSTEM权限运行，因此攻击者注入的代码也会以SYSTEM权限执行，从而完全控制系统。

一些利用方式可能需要身份验证，但其他一些方式则不需要，尤其是在域环境中。根据搜索结果，最初发布的补丁可能并不完全修复该漏洞，导致出现CVE-2021-34527。

总之，攻击者通过精心构造的打印机驱动程序和对Print Spooler服务的利用，可以实现远程代码执行。

**项目地址:** [cybersecurityworks553/CVE-2021-1675_PrintNightMare](https://github.com/cybersecurityworks553/CVE-2021-1675_PrintNightMare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #18

**来源**: [CVE-2021-1675-edsonjt81_CVE-2021-1675.md](../2021/CVE-2021-1675-edsonjt81_CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare Windows Print Spooler RCE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致远程代码执行，权限提升至SYSTEM

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标系统开启Print Spooler服务，攻击者需要具有网络访问能力，可能需要经过身份验证(取决于具体利用方式)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响多个Windows版本。攻击者可以通过利用`AddPrinterDriverEx`函数，上传恶意DLL文件到目标系统，从而实现远程代码执行，获得SYSTEM权限。 

**有效性:**
提供的PoC代码`CVE-2021-1675.py` 实现了利用`AddPrinterDriverEx`函数上传恶意DLL。它首先连接到目标系统的Print Spooler服务，然后构造一个`DRIVER_CONTAINER`结构，其中包含指向攻击者控制的共享目录中恶意DLL文件的路径。该PoC通过循环尝试不同的目录，增加成功利用的机会。根据搜索引擎结果和漏洞库信息，该漏洞和利用方式是被广泛证实的，该PoC代码很可能有效。

**投毒风险:**
对提供的PoC代码进行了分析，发现潜在的投毒风险较低，约为10%。主要风险在于：

*   **`pConfigFile` 字段的修改:** 代码中对 `container_info['DriverInfo']['Level2']['pConfigFile']` 的修改，可能被用于尝试加载系统关键 DLL，虽然初衷可能是绕过某些安全检查或利用已知 DLL 加载顺序，但如果利用不当或被恶意修改，可能导致系统不稳定甚至崩溃。
*   **循环尝试不同目录:** 循环尝试不同的目录可能使得攻击行为更加隐蔽。如果攻击者能够精心构造恶意DLL，并在多个目录中放置，则可能会增加攻击成功的几率，同时也增加了检测和分析的难度。
*   **依赖共享目录:**  PoC依赖于攻击者可控的共享目录，如果攻击者在共享目录中放置恶意DLL，可能会对访问该共享目录的其他用户造成威胁。此外，PoC需要在受害者机器上尝试创建一些目录，如果创建失败可能抛出异常，但是该异常被try except捕获了,不会影响PoC的执行。

上述风险相对可控，主要体现在攻击者难以在未经授权的情况下修改系统 DLL 或在受害者机器上创建任意目录。代码主体逻辑仍然是漏洞利用，而非明显的恶意行为。

**利用方式:**
1.  攻击者首先需要搭建一个SMB共享，用于存放恶意DLL文件。
2.  攻击者运行PoC脚本，指定目标系统、共享路径和（可选的）驱动程序路径。
3.  PoC脚本连接到目标系统的Print Spooler服务。
4.  PoC脚本构造一个`DRIVER_CONTAINER`结构，并将共享路径指向攻击者的SMB共享中的恶意DLL。
5.  PoC脚本调用`AddPrinterDriverEx`函数，尝试在目标系统上安装驱动程序。由于存在漏洞，目标系统会尝试从攻击者的SMB共享加载DLL文件。
6.  如果成功加载DLL，攻击者即可在目标系统上执行任意代码，获得SYSTEM权限。

**项目地址:** [edsonjt81/CVE-2021-1675](https://github.com/edsonjt81/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #19

**来源**: [CVE-2021-1675-eversinc33_NimNightmare.md](../2021/CVE-2021-1675-eversinc33_NimNightmare.md)

## CVE-2021-1675 Windows Print Spooler 远程代码执行漏洞

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统权限提升和远程代码执行

**影响版本:** 受影响的Windows版本低于漏洞库信息中列出的版本号

**利用条件:** 需要用户权限，目标机器启用Print Spooler服务，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个 Windows Print Spooler 服务中的远程代码执行漏洞。该漏洞允许攻击者在目标系统上以 SYSTEM 权限执行任意代码。根据漏洞利用代码，攻击者需要首先生成一个恶意 DLL 文件，然后使用提供的 `nimnightmare.nim` 脚本将该 DLL 加载到 Print Spooler 服务中。该脚本利用 `AddPrinterDriverEx` 函数来加载恶意的驱动程序DLL。漏洞的利用方式涉及欺骗系统将恶意DLL视为合法的打印机驱动程序，从而允许恶意代码以SYSTEM权限执行。搜索结果表明，该漏洞已被广泛利用，并且存在公开的PoC代码。虽然该代码主要功能是利用漏洞，但存在投毒风险，因为攻击者可能在生成的DLL中植入后门。投毒风险较低(5%),主要风险来自于利用msfvenom生成dll时,加入恶意payload。`nimnightmare.nim`本身代码较为简短,主要功能是加载dll，恶意代码存在于dll中的可能性更高。CISA已将此漏洞添加到已知被利用的漏洞目录中。

**项目地址:** [eversinc33/NimNightmare](https://github.com/eversinc33/NimNightmare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #20

**来源**: [CVE-2021-1675-hahaleyile_my-CVE-2021-1675.md](../2021/CVE-2021-1675-hahaleyile_my-CVE-2021-1675.md)

## CVE-2021-1675 - Windows Print Spooler Remote Code Execution

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许攻击者以SYSTEM权限执行任意代码

**影响版本:** 受影响的Windows版本众多，具体参考漏洞库信息

**利用条件:** 需要网络访问，目标系统开启Print Spooler服务，攻击者需要具备一定的用户权限（普通用户即可）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过利用`AddPrinterDriverEx`函数，上传恶意驱动程序，从而以SYSTEM权限执行任意代码。搜索结果表明，该漏洞已被广泛利用，并存在公开的PoC代码。漏洞利用代码中的Dockerfile构建了包含impacket库的环境，impacket库提供了利用该漏洞的必要工具。利用方式通常涉及通过RPC调用`AddPrinterDriverEx`函数，将恶意DLL上传到目标系统，并使Print Spooler服务加载执行，从而实现RCE。

**有效性：**
PoC代码的有效性较高，因为搜索结果中存在多个PoC，并且CISA已将此漏洞添加到已知被利用的漏洞目录中。

**投毒风险：**
仓库中存在作者隐藏的投毒代码的可能性评估为10%。

*   **Dockerfile:** Dockerfile 看起来是为了构建一个包含必要依赖（例如 impacket）的攻击环境，本身不包含恶意代码。然而，`wget`命令从GitHub下载impacket，存在GitHub仓库被篡改的风险。另外，Dockerfile里的`smb.conf`和`main.py`以及`my_rprn.py`需要进一步审计，以确保没有隐藏的恶意行为。
*   **README.adoc:**  这是一个分析报告，本身不包含可执行代码，风险较低。

**利用方式：**
1.  攻击者利用具有一定权限的用户账户连接到目标系统的Print Spooler服务。
2.  通过MSRPC调用`AddPrinterDriverEx`函数，并提供指向恶意DLL的路径。
3.  Print Spooler服务尝试加载并执行该DLL。
4.  由于Print Spooler服务以SYSTEM权限运行，恶意DLL也将在SYSTEM上下文中执行，从而导致RCE。

**项目地址:** [hahaleyile/my-CVE-2021-1675](https://github.com/hahaleyile/my-CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #21

**来源**: [CVE-2021-1675-jj4152_cve-2021-1675.md](../2021/CVE-2021-1675-jj4152_cve-2021-1675.md)

## CVE-2021-1675 PrintNightmare Windows Print Spooler RCE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致远程代码执行，系统权限提升

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 目标系统启用Print Spooler服务，攻击者需要具有一定的访问权限（部分PoC可实现本地提权）。部分利用方式需要域环境。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-1675（PrintNightmare）是一个Windows Print Spooler远程代码执行漏洞。利用方式主要通过AddPrinterDriverEx函数，允许攻击者加载恶意的DLL文件到Print Spooler服务中，从而以SYSTEM权限执行任意代码。

**有效性：**

提供的POC代码（Invoke-Nightmare.ps1）看起来是有效的。它通过调用AddPrinterDriverEx函数来添加恶意打印机驱动程序，并加载指定的DLL文件。代码包含创建新用户并将其添加到本地管理员组的功能，以及执行自定义DLL的功能。搜索引擎结果也表明该漏洞存在公开的PoC。

**投毒风险：**

该POC的投毒风险较低，约为5%。代码的主要功能是利用漏洞，但存在以下潜在的投毒点：

*   **默认DLL：** POC代码使用默认的内置DLL来创建用户。虽然代码中提供了自定义DLL的选项，但用户可能直接使用默认设置，导致所有被攻击的机器上都存在相同的用户名和密码，形成后门，攻击者可以利用该后门进一步攻击。
*   **随机用户名生成：** 虽然代码试图生成随机的用户名，但是如果随机数生成器的种子存在问题，或者攻击者可以预测生成的用户名，也可能被利用。
*   **网络共享DLL：** 如果DLL是通过网络共享加载的，则可能被替换成恶意的DLL。
*   **代码混淆：** 虽然提供的代码没有明显的混淆，但是攻击者可以对PoC进行修改，增加混淆或者添加其他恶意功能。

总体来看，代码本身是漏洞利用代码，并非有意设计的投毒代码，风险较低。

**利用方式：**

1.  **加载恶意DLL：** 攻击者可以使用Invoke-Nightmare.ps1脚本，指定一个恶意的DLL文件作为打印机驱动程序。
2.  **AddPrinterDriverEx函数：** 脚本会调用AddPrinterDriverEx函数，将恶意的DLL文件加载到Print Spooler服务中。
3.  **SYSTEM权限执行：** 由于Print Spooler服务以SYSTEM权限运行，因此加载的DLL文件也会以SYSTEM权限执行，攻击者从而获得对系统的完全控制。
4.  **本地提权/远程代码执行：** 如果攻击者已经具有一定的本地权限，可以通过该漏洞提升到SYSTEM权限。如果目标系统存在其他漏洞，攻击者也可以通过远程方式触发Print Spooler服务加载恶意DLL，实现远程代码执行。
5.  **创建后门用户：** POC默认行为是创建具有已知密码的本地管理员用户，用于持久化访问。

**项目地址:** [jj4152/cve-2021-1675](https://github.com/jj4152/cve-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #22

**来源**: [CVE-2021-1675-ly4k_PrintNightmare.md](../2021/CVE-2021-1675-ly4k_PrintNightmare.md)

## CVE-2021-1675/CVE-2021-34527 PrintNightmare Windows Print Spooler RCE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许攻击者以SYSTEM权限执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10 (多个版本), Windows Server (多个版本)

**利用条件:** 目标系统开启Print Spooler服务，攻击者需要目标机器的有效用户凭据或能够进行Kerberos认证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

PrintNightmare (CVE-2021-1675/CVE-2021-34527) 是一个 Windows Print Spooler 服务中的远程代码执行漏洞。攻击者可以通过 `AddPrinterDriverEx` 函数加载恶意的驱动程序 DLL，从而在系统上以 SYSTEM 权限执行任意代码。根据搜索引擎结果和提供的漏洞利用代码，该漏洞的PoC是有效的。利用方式包括:

1.  **远程DLL注入:** 攻击者将恶意的DLL文件放置在可访问的SMB共享上，然后利用漏洞加载该DLL。
2.  **本地DLL加载:**  攻击者可以将恶意的DLL放置在目标系统的本地路径，然后利用漏洞加载它。
3.  **自定义驱动名称:** 攻击者可以指定自定义的驱动名称。

**投毒风险分析:** 提供的代码主要包含漏洞利用的脚本和license文件。虽然代码中没有明显的恶意代码，但是通过控制DLL的加载路径，攻击者可以执行任意代码，这本身就存在一定的风险。`printnightmare.py`脚本本身不属于投毒代码，它只是一个利用漏洞的工具。但用户如果使用来源不明或被篡改的`add_user.dll`等恶意payload，可能导致被植入后门或其他恶意程序。因此，在使用任何PoC代码时，都应仔细审查其来源和内容，并在隔离环境中进行测试。

由于代码的目的是为了演示漏洞利用，并且通过外部DLL来执行操作，所以不能完全排除存在投毒的可能。这里假设投毒的概率较低，评估为10%。

**项目地址:** [ly4k/PrintNightmare](https://github.com/ly4k/PrintNightmare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #23

**来源**: [CVE-2021-1675-mstxq17_CVE-2021-1675_RDL_LPE.md](../2021/CVE-2021-1675-mstxq17_CVE-2021-1675_RDL_LPE.md)

## CVE-2021-1675 PrintNightmare LPE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 本地提权（LPE）/远程代码执行（RCE）

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可提升至SYSTEM权限并可能导致远程代码执行

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, 8.1, 10, Server 2008, Server 2012, Server 2016, Server 2019, Server 2020H2, Server 21H1 等，具体版本号参考漏洞库信息

**利用条件:** 需要目标系统存在Print Spooler服务，攻击者需要能够上传DLL文件或通过网络触发漏洞（取决于利用方式）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675（PrintNightmare）是一个Windows Print Spooler服务中的本地提权（LPE）/远程代码执行（RCE）漏洞。攻击者可以利用此漏洞在受影响的系统上以SYSTEM权限执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞的PoC代码是有效的。搜索引擎结果中多个链接表明该漏洞存在公开可用的利用代码，且已被积极利用。CISA的已知被利用漏洞目录中也包含此漏洞，进一步验证了其有效性。

**投毒风险评估：**
分析提供的PoC代码（`/tmp/7e6baedcdfd18df6aba4daaa14ca5786/PrintNightMareLpe.cna`和`/tmp/7e6baedcdfd18df6aba4daaa14ca5786/README.md`）：

*   代码主要功能是利用 Cobalt Strike 框架，通过反射DLL注入的方式执行恶意代码以实现本地提权。
*   `PrintNightMareLpe.cna`脚本包含上传DLL到目标系统临时目录，然后通过`bdllspawn`函数加载DLL并执行的代码。
*   `README.md`文件描述了如何使用该插件，包括加载插件、使用`print_night_mare_lpe`命令或`elevate`模块。
*   代码中存在对目标系统架构（x86或x64）的判断，并加载相应的DLL文件。
*   **潜在的投毒风险点：**
    *   提供的PoC代码依赖于外部DLL文件（`LPE_Reflect_Elevate.x64.dll`, `CVE-2021-1675.x64.dll`, `CVE-2021-1675.x86.dll`）。如果这些DLL文件被恶意修改，则可能包含恶意代码，导致被攻击者执行非预期的操作。用户需要自行确保这些DLL文件的来源可信，且没有被篡改。虽然这个是PoC正常需要使用的组件，但是风险依然存在.
    *    PoC通过上传DLL执行恶意代码本身就是恶意行为，无法区分作者的恶意投毒行为。

综上所述，**投毒风险评估为10%**。风险主要在于外部DLL文件可能被篡改，以及使用PoC本身就是一种攻击行为。

**利用方式分析：**

1.  **环境准备：** 攻击者需要拥有一个 Cobalt Strike 环境，并获取目标系统的Beacon。
2.  **上传Payload DLL：** 攻击者使用PoC代码将包含恶意代码的DLL文件上传到目标系统的临时目录（例如：`c:\Windows\Temp\`）。
3.  **触发漏洞：** 攻击者通过`bdllspawn`函数触发Print Spooler漏洞，加载并执行上传的DLL文件。
4.  **权限提升：** 利用Print Spooler服务以SYSTEM权限执行DLL中的恶意代码，从而实现本地提权。

**搜索引擎结果补充：**

*   搜索引擎结果表明，该漏洞在野外被广泛利用，且存在针对Active Directory域控制器的利用代码。
*   修复建议包括安装Microsoft发布的补丁，以及禁用Print Spooler服务（如果不需要）。


**项目地址:** [mstxq17/CVE-2021-1675_RDL_LPE](https://github.com/mstxq17/CVE-2021-1675_RDL_LPE)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #24

**来源**: [CVE-2021-1675-peckre_PNCVE-Win10-20H2-Exploit.md](../2021/CVE-2021-1675-peckre_PNCVE-Win10-20H2-Exploit.md)

## CVE-2021-1675 PrintNightmare Windows Print Spooler 远程代码执行漏洞

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 受影响的Windows版本在漏洞库信息中已列出，通常为2021年6月之前的版本

**利用条件:** 需要目标系统开启Print Spooler服务，并且攻击者能够与目标系统进行网络通信。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，对该漏洞的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

提供的POC代码针对Windows 10 20H2版本，它通过以下步骤尝试利用漏洞：
*   下载并解压包含`PNLPE.dll`, `vlib.dll`, 和`xconsole.exe`的ZIP文件。
*   将这些文件复制到`C:\temp\testcase`目录下。
*   提示用户运行`PNLPE.dll`。

搜索引擎结果表明，CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。多个安全厂商和研究人员都发布了关于此漏洞的报告和利用代码。综合来看，提供的POC代码**可能有效**，但需要目标系统满足特定的条件（如操作系统版本、未安装补丁等）。

**2. 投毒风险：**

分析POC代码，投毒风险主要存在于以下几个方面：
*   **下载的ZIP文件：** `Win10_Exploit.zip`可能包含恶意代码。尽管`README.md`文件指向GitHubusercontent，但该链接可能被劫持或篡改。
*   **PNLPE.dll：** 这是最可能的恶意代码植入点。漏洞利用的关键在于此DLL，攻击者可以在其中嵌入后门或者其他恶意功能。
*   **运行DLL文件：** `run.bat`脚本尝试以可执行文件的方式启动`PNLPE.dll`，这通常不是DLL的正常执行方式，存在恶意行为的风险。

虽然POC本身是为了验证漏洞而编写的，但攻击者可以很容易地修改它来包含恶意代码。`run.bat` 的代码本身没有发现明显的投毒特征，但是下载的DLL存在被替换的风险,因此判断存在 **10%** 的投毒风险。

**3. 利用方式：**

PrintNightmare漏洞的利用方式通常涉及以下步骤：
*   **利用`AddPrinterDriverEx`函数：**  该函数允许在Print Spooler服务中安装打印机驱动程序。通过构造恶意的打印机驱动程序，攻击者可以将恶意DLL加载到Print Spooler服务进程中。
*   **提升权限：**  Print Spooler服务以SYSTEM权限运行，因此加载的恶意DLL也具有SYSTEM权限，攻击者可以利用此权限执行任意代码。
*   **远程代码执行：**  通过精心构造的攻击载荷，攻击者可以实现远程代码执行，从而完全控制目标系统。

总而言之，这个漏洞的利用方式通常涉及到欺骗Print Spooler服务加载恶意的DLL文件，从而获取SYSTEM权限并执行任意代码。

**项目地址:** [peckre/PNCVE-Win10-20H2-Exploit](https://github.com/peckre/PNCVE-Win10-20H2-Exploit)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #25

**来源**: [CVE-2021-1675-puckiestyle_CVE-2021-1675.md](../2021/CVE-2021-1675-puckiestyle_CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致 SYSTEM 权限的远程代码执行

**影响版本:** 受影响的Windows版本和版本号请参考漏洞库信息

**利用条件:** 目标系统开启Print Spooler服务, 攻击者需要有权限连接到目标系统的Print Spooler服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个 Windows Print Spooler 服务中的远程代码执行漏洞。攻击者可以利用此漏洞在目标系统上以 SYSTEM 权限执行任意代码。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 Windows 版本。提供的 PowerShell 脚本 `CVE-2021-1675.ps1` 是一个利用此漏洞的 PoC 代码，它通过添加恶意的打印机驱动程序来执行代码。

**有效性：**
根据搜索结果和漏洞利用代码分析，该漏洞是有效的。多个安全厂商和研究人员已经发布了关于此漏洞的分析和利用方法。PoC 代码通过调用 `AddPrinterDriverEx` 函数来添加恶意的打印机驱动程序，从而实现代码执行。

**投毒风险：**
PoC 代码本身具有一定的投毒风险，因为它可以被修改为执行任意恶意代码。例如，攻击者可以将 `Invoke-Nightmare` 函数中的 `$DLL` 参数指向一个包含恶意代码的 DLL 文件。此外，即使使用默认的 DLL，该 DLL 的目的是创建具有已知密码的管理员帐户，这也可能被视为一种后门或投毒行为。代码中，`get_nightmare_dll` 函数返回的字节数组就是payload，此payload用于创建一个新的本地管理员用户,并添加到本地管理员组。如果攻击者在未授权的情况下使用此代码，则可以利用此漏洞来控制目标系统。`$delete_me` 变量用于决定是否删除生成的DLL文件，可以被修改为不删除DLL，方便后续利用。

**利用方式：**
1.  攻击者需要拥有目标系统的访问权限，至少需要能够连接到Print Spooler服务。
2.  攻击者运行 `CVE-2021-1675.ps1` 脚本，指定恶意 DLL 文件的路径，或者使用内置的payload创建管理员账号。
3.  脚本通过调用 `AddPrinterDriverEx` 函数来添加恶意的打印机驱动程序。
4.  当打印机驱动程序被加载时，其中的恶意代码将以 SYSTEM 权限执行。
5.  通过创建的管理员帐户或直接执行的payload，攻击者可以完全控制目标系统。

**项目地址:** [puckiestyle/CVE-2021-1675](https://github.com/puckiestyle/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #26

**来源**: [CVE-2021-1675-r1skkam_PrintNightmare.md](../2021/CVE-2021-1675-r1skkam_PrintNightmare.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统权限提升和远程代码执行

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标系统启用Print Spooler服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

PrintNightmare (CVE-2021-1675) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过该漏洞在受影响的系统上以SYSTEM权限执行任意代码。根据漏洞库信息，多个Windows版本都受到影响，需要及时安装补丁。

**有效性：**
根据搜索引擎结果和漏洞库信息，该漏洞是真实存在的，并且存在公开的PoC代码。

**投毒风险：**
提供的PoC代码主要用于检测漏洞和日志分析，风险较低。TryHackMe的介绍性文档，主要用于漏洞检测，投毒风险较低，代码中本身没有直接执行恶意操作的部分，但用户可能被诱导执行恶意操作，所以存在极低的投毒风险。

**利用方式：**
利用方式通常涉及以下步骤：
1.  利用`RpcAddPrinterDriverEx`函数安装恶意的打印机驱动程序。
2.  打印机服务会尝试加载该驱动程序，从而执行攻击者提供的代码。
3.  攻击者可以利用该代码获得SYSTEM权限。

**排序优先级:**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

搜索引擎结果表明该漏洞已被广泛利用，CISA将其列入已知被利用漏洞目录，并与 CVE-2021-34527 关联。漏洞利用代码提供了一种检测漏洞的方式，并展示了如何分析相关事件日志。漏洞库信息提供了受影响的Windows版本范围。

请注意及时应用补丁，并采取缓解措施，如禁用Print Spooler服务等，以降低风险。

**项目地址:** [r1skkam/PrintNightmare](https://github.com/r1skkam/PrintNightmare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #27

**来源**: [CVE-2021-1675-thalpius_Microsoft-CVE-2021-1675.md](../2021/CVE-2021-1675-thalpius_Microsoft-CVE-2021-1675.md)

## CVE-2021-1675-PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许攻击者在受影响的系统上执行任意代码，可能导致完全控制系统。

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 10的多个版本以及相应的服务器版本，详见漏洞库信息。

**利用条件:** 攻击者需要能够与目标系统上的Print Spooler服务通信。 某些利用方式可能需要认证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler服务中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本。提供的漏洞利用代码是一个C#项目，它通过指定driverpath和dll参数来利用该漏洞，允许攻击者上传恶意的DLL文件到目标系统并执行，从而提升权限至SYSTEM。搜索结果表明，最初发布的补丁可能未能完全修复该漏洞，导致了CVE-2021-34527的出现。该漏洞已被添加到CISA的已知被利用漏洞目录中，表明其在野外已被积极利用。由于该POC需要指定DLL路径，使用者可能会使用非官方或来源不明的DLL，存在一定的投毒风险，例如DLL中包含恶意代码，此风险估计为10%。利用方式主要为上传恶意驱动程序从而执行任意代码。

**项目地址:** [thalpius/Microsoft-CVE-2021-1675](https://github.com/thalpius/Microsoft-CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #28

**来源**: [CVE-2021-1675-whoami-chmod777_CVE-2021-1675---PrintNightmare-LPE-PowerShell-.md](../2021/CVE-2021-1675-whoami-chmod777_CVE-2021-1675---PrintNightmare-LPE-PowerShell-.md)

## CVE-2021-1675 PrintNightmare Windows Print Spooler RCE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler Service

**危害等级:** 高危，允许攻击者以SYSTEM权限执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 10的多个版本，以及Windows Server 2008到Windows Server 2019的多个版本 (参考漏洞库信息)

**利用条件:** 默认情况下，Print Spooler服务运行，且未经修补 (参考搜索引擎结果)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler服务中的远程代码执行漏洞。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断此漏洞是有效的。搜索引擎结果中多个链接表明存在公开的PoC利用代码，且该漏洞已被CISA列入已知被利用漏洞目录（KEV）。

**投毒风险：**
提供的PowerShell PoC代码的主要功能是利用PrintNightmare漏洞在目标系统上创建一个新的本地管理员用户，并将其添加到本地管理员组。此代码中存在投毒的可能性很低，因为其主要功能是添加用户，而非植入恶意代码，同时会尝试从内存加载DLL。虽然该DLL内容经过编码，但编码本身是为了方便传输和存储，并非混淆恶意行为，因此可以认为是良性的。只有在-DLL参数传递恶意dll的情况下，才有投毒风险。风险评估为1%。

**利用方式：**
此PoC利用方式：
1.  **DLL注入：** 漏洞利用的核心在于向Print Spooler服务注入恶意DLL。通过`AddPrinterDriverEx`函数添加一个恶意的打印机驱动，该驱动指向攻击者控制的DLL文件。
2.  **SYSTEM权限：** 由于Print Spooler服务以SYSTEM权限运行，注入的DLL也会以SYSTEM权限执行，从而允许攻击者完全控制受影响的系统。
3.  **用户创建：**  提供的PoC代码默认使用内置的payload（`get_nightmare_dll`函数）创建一个新的本地用户（默认用户名为`adm1n`，密码为`P@ssw0rd`），并将其添加到本地管理员组。攻击者可以自定义用户名和密码，或者指定自己的DLL执行任意代码。
4.  **远程利用：** 虽然PoC可能在本地执行，但Print Spooler服务通常也监听网络连接，这使得该漏洞可以通过网络进行远程利用。

总的来说，这是一个高危漏洞，利用起来相对简单，攻击者可以利用它获得受害者系统的完全控制权。

**项目地址:** [whoami-chmod777/CVE-2021-1675---PrintNightmare-LPE-PowerShell-](https://github.com/whoami-chmod777/CVE-2021-1675---PrintNightmare-LPE-PowerShell-)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #29

**来源**: [CVE-2021-1675-whoami-chmod777_CVE-2021-1675-CVE-2021-34527.md](../2021/CVE-2021-1675-whoami-chmod777_CVE-2021-1675-CVE-2021-34527.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许攻击者以SYSTEM权限执行任意代码

**影响版本:** 受影响的Windows版本众多，包括但不限于 Windows 7, Windows 8.1, Windows 10 (多个版本), Windows Server 2008, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2020等，具体版本号参考漏洞库信息。

**利用条件:** 目标系统需要启用Print Spooler服务，攻击者需要一定的权限（通常是域用户）或欺骗用户进行操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以利用此漏洞在目标系统上以SYSTEM权限执行任意代码。根据搜索引擎结果和漏洞库信息，此漏洞影响多个Windows版本。提供的PoC代码 `CVE-2021-1675.ps1` 是一个PowerShell脚本，旨在利用此漏洞。该脚本通过添加恶意的打印机驱动程序来执行代码。如果 `$DLL` 参数为空，PoC会创建一个默认payload，在临时目录生成恶意DLL,用于创建新的本地管理员用户。如果提供了自定义的DLL，PoC会直接使用该DLL进行攻击。PoC的有效性较高，因为该漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。存在轻微投毒风险，因为PoC可以接受用户提供的DLL，攻击者可以在提供的DLL中植入恶意代码。PoC中默认DLL部分存在恶意行为，但该行为是POC功能的一部分，用于创建用户，不应视为投毒。根据提供的PoC代码，投毒风险估计为10%，主要来自于用户可能提供的恶意DLL。

**利用方式：**
1.  攻击者需要能够访问目标系统的网络。
2.  攻击者运行PoC脚本，指定恶意DLL或使用默认payload。
3.  PoC脚本利用Print Spooler服务添加恶意的打印机驱动程序。
4.  Print Spooler服务加载恶意DLL，执行其中的代码，从而允许攻击者以SYSTEM权限在目标系统上执行任意代码。
5. 通过执行DLL创建新用户或者其他更高级的操作.

**项目地址:** [whoami-chmod777/CVE-2021-1675-CVE-2021-34527](https://github.com/whoami-chmod777/CVE-2021-1675-CVE-2021-34527)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---



---

## POC #19

**来源**: [CVE-2021-1675-eversinc33_NimNightmare.md](../2021/CVE-2021-1675-eversinc33_NimNightmare.md)

## CVE-2021-1675 Windows Print Spooler 远程代码执行漏洞

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统权限提升和远程代码执行

**影响版本:** 受影响的Windows版本低于漏洞库信息中列出的版本号

**利用条件:** 需要用户权限，目标机器启用Print Spooler服务，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个 Windows Print Spooler 服务中的远程代码执行漏洞。该漏洞允许攻击者在目标系统上以 SYSTEM 权限执行任意代码。根据漏洞利用代码，攻击者需要首先生成一个恶意 DLL 文件，然后使用提供的 `nimnightmare.nim` 脚本将该 DLL 加载到 Print Spooler 服务中。该脚本利用 `AddPrinterDriverEx` 函数来加载恶意的驱动程序DLL。漏洞的利用方式涉及欺骗系统将恶意DLL视为合法的打印机驱动程序，从而允许恶意代码以SYSTEM权限执行。搜索结果表明，该漏洞已被广泛利用，并且存在公开的PoC代码。虽然该代码主要功能是利用漏洞，但存在投毒风险，因为攻击者可能在生成的DLL中植入后门。投毒风险较低(5%),主要风险来自于利用msfvenom生成dll时,加入恶意payload。`nimnightmare.nim`本身代码较为简短,主要功能是加载dll，恶意代码存在于dll中的可能性更高。CISA已将此漏洞添加到已知被利用的漏洞目录中。

**项目地址:** [eversinc33/NimNightmare](https://github.com/eversinc33/NimNightmare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #20

**来源**: [CVE-2021-1675-hahaleyile_my-CVE-2021-1675.md](../2021/CVE-2021-1675-hahaleyile_my-CVE-2021-1675.md)

## CVE-2021-1675 - Windows Print Spooler Remote Code Execution

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许攻击者以SYSTEM权限执行任意代码

**影响版本:** 受影响的Windows版本众多，具体参考漏洞库信息

**利用条件:** 需要网络访问，目标系统开启Print Spooler服务，攻击者需要具备一定的用户权限（普通用户即可）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过利用`AddPrinterDriverEx`函数，上传恶意驱动程序，从而以SYSTEM权限执行任意代码。搜索结果表明，该漏洞已被广泛利用，并存在公开的PoC代码。漏洞利用代码中的Dockerfile构建了包含impacket库的环境，impacket库提供了利用该漏洞的必要工具。利用方式通常涉及通过RPC调用`AddPrinterDriverEx`函数，将恶意DLL上传到目标系统，并使Print Spooler服务加载执行，从而实现RCE。

**有效性：**
PoC代码的有效性较高，因为搜索结果中存在多个PoC，并且CISA已将此漏洞添加到已知被利用的漏洞目录中。

**投毒风险：**
仓库中存在作者隐藏的投毒代码的可能性评估为10%。

*   **Dockerfile:** Dockerfile 看起来是为了构建一个包含必要依赖（例如 impacket）的攻击环境，本身不包含恶意代码。然而，`wget`命令从GitHub下载impacket，存在GitHub仓库被篡改的风险。另外，Dockerfile里的`smb.conf`和`main.py`以及`my_rprn.py`需要进一步审计，以确保没有隐藏的恶意行为。
*   **README.adoc:**  这是一个分析报告，本身不包含可执行代码，风险较低。

**利用方式：**
1.  攻击者利用具有一定权限的用户账户连接到目标系统的Print Spooler服务。
2.  通过MSRPC调用`AddPrinterDriverEx`函数，并提供指向恶意DLL的路径。
3.  Print Spooler服务尝试加载并执行该DLL。
4.  由于Print Spooler服务以SYSTEM权限运行，恶意DLL也将在SYSTEM上下文中执行，从而导致RCE。

**项目地址:** [hahaleyile/my-CVE-2021-1675](https://github.com/hahaleyile/my-CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #21

**来源**: [CVE-2021-1675-jj4152_cve-2021-1675.md](../2021/CVE-2021-1675-jj4152_cve-2021-1675.md)

## CVE-2021-1675 PrintNightmare Windows Print Spooler RCE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致远程代码执行，系统权限提升

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 目标系统启用Print Spooler服务，攻击者需要具有一定的访问权限（部分PoC可实现本地提权）。部分利用方式需要域环境。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-1675（PrintNightmare）是一个Windows Print Spooler远程代码执行漏洞。利用方式主要通过AddPrinterDriverEx函数，允许攻击者加载恶意的DLL文件到Print Spooler服务中，从而以SYSTEM权限执行任意代码。

**有效性：**

提供的POC代码（Invoke-Nightmare.ps1）看起来是有效的。它通过调用AddPrinterDriverEx函数来添加恶意打印机驱动程序，并加载指定的DLL文件。代码包含创建新用户并将其添加到本地管理员组的功能，以及执行自定义DLL的功能。搜索引擎结果也表明该漏洞存在公开的PoC。

**投毒风险：**

该POC的投毒风险较低，约为5%。代码的主要功能是利用漏洞，但存在以下潜在的投毒点：

*   **默认DLL：** POC代码使用默认的内置DLL来创建用户。虽然代码中提供了自定义DLL的选项，但用户可能直接使用默认设置，导致所有被攻击的机器上都存在相同的用户名和密码，形成后门，攻击者可以利用该后门进一步攻击。
*   **随机用户名生成：** 虽然代码试图生成随机的用户名，但是如果随机数生成器的种子存在问题，或者攻击者可以预测生成的用户名，也可能被利用。
*   **网络共享DLL：** 如果DLL是通过网络共享加载的，则可能被替换成恶意的DLL。
*   **代码混淆：** 虽然提供的代码没有明显的混淆，但是攻击者可以对PoC进行修改，增加混淆或者添加其他恶意功能。

总体来看，代码本身是漏洞利用代码，并非有意设计的投毒代码，风险较低。

**利用方式：**

1.  **加载恶意DLL：** 攻击者可以使用Invoke-Nightmare.ps1脚本，指定一个恶意的DLL文件作为打印机驱动程序。
2.  **AddPrinterDriverEx函数：** 脚本会调用AddPrinterDriverEx函数，将恶意的DLL文件加载到Print Spooler服务中。
3.  **SYSTEM权限执行：** 由于Print Spooler服务以SYSTEM权限运行，因此加载的DLL文件也会以SYSTEM权限执行，攻击者从而获得对系统的完全控制。
4.  **本地提权/远程代码执行：** 如果攻击者已经具有一定的本地权限，可以通过该漏洞提升到SYSTEM权限。如果目标系统存在其他漏洞，攻击者也可以通过远程方式触发Print Spooler服务加载恶意DLL，实现远程代码执行。
5.  **创建后门用户：** POC默认行为是创建具有已知密码的本地管理员用户，用于持久化访问。

**项目地址:** [jj4152/cve-2021-1675](https://github.com/jj4152/cve-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #22

**来源**: [CVE-2021-1675-ly4k_PrintNightmare.md](../2021/CVE-2021-1675-ly4k_PrintNightmare.md)

## CVE-2021-1675/CVE-2021-34527 PrintNightmare Windows Print Spooler RCE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许攻击者以SYSTEM权限执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10 (多个版本), Windows Server (多个版本)

**利用条件:** 目标系统开启Print Spooler服务，攻击者需要目标机器的有效用户凭据或能够进行Kerberos认证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

PrintNightmare (CVE-2021-1675/CVE-2021-34527) 是一个 Windows Print Spooler 服务中的远程代码执行漏洞。攻击者可以通过 `AddPrinterDriverEx` 函数加载恶意的驱动程序 DLL，从而在系统上以 SYSTEM 权限执行任意代码。根据搜索引擎结果和提供的漏洞利用代码，该漏洞的PoC是有效的。利用方式包括:

1.  **远程DLL注入:** 攻击者将恶意的DLL文件放置在可访问的SMB共享上，然后利用漏洞加载该DLL。
2.  **本地DLL加载:**  攻击者可以将恶意的DLL放置在目标系统的本地路径，然后利用漏洞加载它。
3.  **自定义驱动名称:** 攻击者可以指定自定义的驱动名称。

**投毒风险分析:** 提供的代码主要包含漏洞利用的脚本和license文件。虽然代码中没有明显的恶意代码，但是通过控制DLL的加载路径，攻击者可以执行任意代码，这本身就存在一定的风险。`printnightmare.py`脚本本身不属于投毒代码，它只是一个利用漏洞的工具。但用户如果使用来源不明或被篡改的`add_user.dll`等恶意payload，可能导致被植入后门或其他恶意程序。因此，在使用任何PoC代码时，都应仔细审查其来源和内容，并在隔离环境中进行测试。

由于代码的目的是为了演示漏洞利用，并且通过外部DLL来执行操作，所以不能完全排除存在投毒的可能。这里假设投毒的概率较低，评估为10%。

**项目地址:** [ly4k/PrintNightmare](https://github.com/ly4k/PrintNightmare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #23

**来源**: [CVE-2021-1675-mstxq17_CVE-2021-1675_RDL_LPE.md](../2021/CVE-2021-1675-mstxq17_CVE-2021-1675_RDL_LPE.md)

## CVE-2021-1675 PrintNightmare LPE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 本地提权（LPE）/远程代码执行（RCE）

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可提升至SYSTEM权限并可能导致远程代码执行

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, 8.1, 10, Server 2008, Server 2012, Server 2016, Server 2019, Server 2020H2, Server 21H1 等，具体版本号参考漏洞库信息

**利用条件:** 需要目标系统存在Print Spooler服务，攻击者需要能够上传DLL文件或通过网络触发漏洞（取决于利用方式）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675（PrintNightmare）是一个Windows Print Spooler服务中的本地提权（LPE）/远程代码执行（RCE）漏洞。攻击者可以利用此漏洞在受影响的系统上以SYSTEM权限执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞的PoC代码是有效的。搜索引擎结果中多个链接表明该漏洞存在公开可用的利用代码，且已被积极利用。CISA的已知被利用漏洞目录中也包含此漏洞，进一步验证了其有效性。

**投毒风险评估：**
分析提供的PoC代码（`/tmp/7e6baedcdfd18df6aba4daaa14ca5786/PrintNightMareLpe.cna`和`/tmp/7e6baedcdfd18df6aba4daaa14ca5786/README.md`）：

*   代码主要功能是利用 Cobalt Strike 框架，通过反射DLL注入的方式执行恶意代码以实现本地提权。
*   `PrintNightMareLpe.cna`脚本包含上传DLL到目标系统临时目录，然后通过`bdllspawn`函数加载DLL并执行的代码。
*   `README.md`文件描述了如何使用该插件，包括加载插件、使用`print_night_mare_lpe`命令或`elevate`模块。
*   代码中存在对目标系统架构（x86或x64）的判断，并加载相应的DLL文件。
*   **潜在的投毒风险点：**
    *   提供的PoC代码依赖于外部DLL文件（`LPE_Reflect_Elevate.x64.dll`, `CVE-2021-1675.x64.dll`, `CVE-2021-1675.x86.dll`）。如果这些DLL文件被恶意修改，则可能包含恶意代码，导致被攻击者执行非预期的操作。用户需要自行确保这些DLL文件的来源可信，且没有被篡改。虽然这个是PoC正常需要使用的组件，但是风险依然存在.
    *    PoC通过上传DLL执行恶意代码本身就是恶意行为，无法区分作者的恶意投毒行为。

综上所述，**投毒风险评估为10%**。风险主要在于外部DLL文件可能被篡改，以及使用PoC本身就是一种攻击行为。

**利用方式分析：**

1.  **环境准备：** 攻击者需要拥有一个 Cobalt Strike 环境，并获取目标系统的Beacon。
2.  **上传Payload DLL：** 攻击者使用PoC代码将包含恶意代码的DLL文件上传到目标系统的临时目录（例如：`c:\Windows\Temp\`）。
3.  **触发漏洞：** 攻击者通过`bdllspawn`函数触发Print Spooler漏洞，加载并执行上传的DLL文件。
4.  **权限提升：** 利用Print Spooler服务以SYSTEM权限执行DLL中的恶意代码，从而实现本地提权。

**搜索引擎结果补充：**

*   搜索引擎结果表明，该漏洞在野外被广泛利用，且存在针对Active Directory域控制器的利用代码。
*   修复建议包括安装Microsoft发布的补丁，以及禁用Print Spooler服务（如果不需要）。


**项目地址:** [mstxq17/CVE-2021-1675_RDL_LPE](https://github.com/mstxq17/CVE-2021-1675_RDL_LPE)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #24

**来源**: [CVE-2021-1675-peckre_PNCVE-Win10-20H2-Exploit.md](../2021/CVE-2021-1675-peckre_PNCVE-Win10-20H2-Exploit.md)

## CVE-2021-1675 PrintNightmare Windows Print Spooler 远程代码执行漏洞

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 受影响的Windows版本在漏洞库信息中已列出，通常为2021年6月之前的版本

**利用条件:** 需要目标系统开启Print Spooler服务，并且攻击者能够与目标系统进行网络通信。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，对该漏洞的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

提供的POC代码针对Windows 10 20H2版本，它通过以下步骤尝试利用漏洞：
*   下载并解压包含`PNLPE.dll`, `vlib.dll`, 和`xconsole.exe`的ZIP文件。
*   将这些文件复制到`C:\temp\testcase`目录下。
*   提示用户运行`PNLPE.dll`。

搜索引擎结果表明，CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。多个安全厂商和研究人员都发布了关于此漏洞的报告和利用代码。综合来看，提供的POC代码**可能有效**，但需要目标系统满足特定的条件（如操作系统版本、未安装补丁等）。

**2. 投毒风险：**

分析POC代码，投毒风险主要存在于以下几个方面：
*   **下载的ZIP文件：** `Win10_Exploit.zip`可能包含恶意代码。尽管`README.md`文件指向GitHubusercontent，但该链接可能被劫持或篡改。
*   **PNLPE.dll：** 这是最可能的恶意代码植入点。漏洞利用的关键在于此DLL，攻击者可以在其中嵌入后门或者其他恶意功能。
*   **运行DLL文件：** `run.bat`脚本尝试以可执行文件的方式启动`PNLPE.dll`，这通常不是DLL的正常执行方式，存在恶意行为的风险。

虽然POC本身是为了验证漏洞而编写的，但攻击者可以很容易地修改它来包含恶意代码。`run.bat` 的代码本身没有发现明显的投毒特征，但是下载的DLL存在被替换的风险,因此判断存在 **10%** 的投毒风险。

**3. 利用方式：**

PrintNightmare漏洞的利用方式通常涉及以下步骤：
*   **利用`AddPrinterDriverEx`函数：**  该函数允许在Print Spooler服务中安装打印机驱动程序。通过构造恶意的打印机驱动程序，攻击者可以将恶意DLL加载到Print Spooler服务进程中。
*   **提升权限：**  Print Spooler服务以SYSTEM权限运行，因此加载的恶意DLL也具有SYSTEM权限，攻击者可以利用此权限执行任意代码。
*   **远程代码执行：**  通过精心构造的攻击载荷，攻击者可以实现远程代码执行，从而完全控制目标系统。

总而言之，这个漏洞的利用方式通常涉及到欺骗Print Spooler服务加载恶意的DLL文件，从而获取SYSTEM权限并执行任意代码。

**项目地址:** [peckre/PNCVE-Win10-20H2-Exploit](https://github.com/peckre/PNCVE-Win10-20H2-Exploit)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #25

**来源**: [CVE-2021-1675-puckiestyle_CVE-2021-1675.md](../2021/CVE-2021-1675-puckiestyle_CVE-2021-1675.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致 SYSTEM 权限的远程代码执行

**影响版本:** 受影响的Windows版本和版本号请参考漏洞库信息

**利用条件:** 目标系统开启Print Spooler服务, 攻击者需要有权限连接到目标系统的Print Spooler服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个 Windows Print Spooler 服务中的远程代码执行漏洞。攻击者可以利用此漏洞在目标系统上以 SYSTEM 权限执行任意代码。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 Windows 版本。提供的 PowerShell 脚本 `CVE-2021-1675.ps1` 是一个利用此漏洞的 PoC 代码，它通过添加恶意的打印机驱动程序来执行代码。

**有效性：**
根据搜索结果和漏洞利用代码分析，该漏洞是有效的。多个安全厂商和研究人员已经发布了关于此漏洞的分析和利用方法。PoC 代码通过调用 `AddPrinterDriverEx` 函数来添加恶意的打印机驱动程序，从而实现代码执行。

**投毒风险：**
PoC 代码本身具有一定的投毒风险，因为它可以被修改为执行任意恶意代码。例如，攻击者可以将 `Invoke-Nightmare` 函数中的 `$DLL` 参数指向一个包含恶意代码的 DLL 文件。此外，即使使用默认的 DLL，该 DLL 的目的是创建具有已知密码的管理员帐户，这也可能被视为一种后门或投毒行为。代码中，`get_nightmare_dll` 函数返回的字节数组就是payload，此payload用于创建一个新的本地管理员用户,并添加到本地管理员组。如果攻击者在未授权的情况下使用此代码，则可以利用此漏洞来控制目标系统。`$delete_me` 变量用于决定是否删除生成的DLL文件，可以被修改为不删除DLL，方便后续利用。

**利用方式：**
1.  攻击者需要拥有目标系统的访问权限，至少需要能够连接到Print Spooler服务。
2.  攻击者运行 `CVE-2021-1675.ps1` 脚本，指定恶意 DLL 文件的路径，或者使用内置的payload创建管理员账号。
3.  脚本通过调用 `AddPrinterDriverEx` 函数来添加恶意的打印机驱动程序。
4.  当打印机驱动程序被加载时，其中的恶意代码将以 SYSTEM 权限执行。
5.  通过创建的管理员帐户或直接执行的payload，攻击者可以完全控制目标系统。

**项目地址:** [puckiestyle/CVE-2021-1675](https://github.com/puckiestyle/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #26

**来源**: [CVE-2021-1675-r1skkam_PrintNightmare.md](../2021/CVE-2021-1675-r1skkam_PrintNightmare.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统权限提升和远程代码执行

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标系统启用Print Spooler服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

PrintNightmare (CVE-2021-1675) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过该漏洞在受影响的系统上以SYSTEM权限执行任意代码。根据漏洞库信息，多个Windows版本都受到影响，需要及时安装补丁。

**有效性：**
根据搜索引擎结果和漏洞库信息，该漏洞是真实存在的，并且存在公开的PoC代码。

**投毒风险：**
提供的PoC代码主要用于检测漏洞和日志分析，风险较低。TryHackMe的介绍性文档，主要用于漏洞检测，投毒风险较低，代码中本身没有直接执行恶意操作的部分，但用户可能被诱导执行恶意操作，所以存在极低的投毒风险。

**利用方式：**
利用方式通常涉及以下步骤：
1.  利用`RpcAddPrinterDriverEx`函数安装恶意的打印机驱动程序。
2.  打印机服务会尝试加载该驱动程序，从而执行攻击者提供的代码。
3.  攻击者可以利用该代码获得SYSTEM权限。

**排序优先级:**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

搜索引擎结果表明该漏洞已被广泛利用，CISA将其列入已知被利用漏洞目录，并与 CVE-2021-34527 关联。漏洞利用代码提供了一种检测漏洞的方式，并展示了如何分析相关事件日志。漏洞库信息提供了受影响的Windows版本范围。

请注意及时应用补丁，并采取缓解措施，如禁用Print Spooler服务等，以降低风险。

**项目地址:** [r1skkam/PrintNightmare](https://github.com/r1skkam/PrintNightmare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #27

**来源**: [CVE-2021-1675-thalpius_Microsoft-CVE-2021-1675.md](../2021/CVE-2021-1675-thalpius_Microsoft-CVE-2021-1675.md)

## CVE-2021-1675-PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许攻击者在受影响的系统上执行任意代码，可能导致完全控制系统。

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 10的多个版本以及相应的服务器版本，详见漏洞库信息。

**利用条件:** 攻击者需要能够与目标系统上的Print Spooler服务通信。 某些利用方式可能需要认证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler服务中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本。提供的漏洞利用代码是一个C#项目，它通过指定driverpath和dll参数来利用该漏洞，允许攻击者上传恶意的DLL文件到目标系统并执行，从而提升权限至SYSTEM。搜索结果表明，最初发布的补丁可能未能完全修复该漏洞，导致了CVE-2021-34527的出现。该漏洞已被添加到CISA的已知被利用漏洞目录中，表明其在野外已被积极利用。由于该POC需要指定DLL路径，使用者可能会使用非官方或来源不明的DLL，存在一定的投毒风险，例如DLL中包含恶意代码，此风险估计为10%。利用方式主要为上传恶意驱动程序从而执行任意代码。

**项目地址:** [thalpius/Microsoft-CVE-2021-1675](https://github.com/thalpius/Microsoft-CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #28

**来源**: [CVE-2021-1675-whoami-chmod777_CVE-2021-1675---PrintNightmare-LPE-PowerShell-.md](../2021/CVE-2021-1675-whoami-chmod777_CVE-2021-1675---PrintNightmare-LPE-PowerShell-.md)

## CVE-2021-1675 PrintNightmare Windows Print Spooler RCE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler Service

**危害等级:** 高危，允许攻击者以SYSTEM权限执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 10的多个版本，以及Windows Server 2008到Windows Server 2019的多个版本 (参考漏洞库信息)

**利用条件:** 默认情况下，Print Spooler服务运行，且未经修补 (参考搜索引擎结果)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler服务中的远程代码执行漏洞。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断此漏洞是有效的。搜索引擎结果中多个链接表明存在公开的PoC利用代码，且该漏洞已被CISA列入已知被利用漏洞目录（KEV）。

**投毒风险：**
提供的PowerShell PoC代码的主要功能是利用PrintNightmare漏洞在目标系统上创建一个新的本地管理员用户，并将其添加到本地管理员组。此代码中存在投毒的可能性很低，因为其主要功能是添加用户，而非植入恶意代码，同时会尝试从内存加载DLL。虽然该DLL内容经过编码，但编码本身是为了方便传输和存储，并非混淆恶意行为，因此可以认为是良性的。只有在-DLL参数传递恶意dll的情况下，才有投毒风险。风险评估为1%。

**利用方式：**
此PoC利用方式：
1.  **DLL注入：** 漏洞利用的核心在于向Print Spooler服务注入恶意DLL。通过`AddPrinterDriverEx`函数添加一个恶意的打印机驱动，该驱动指向攻击者控制的DLL文件。
2.  **SYSTEM权限：** 由于Print Spooler服务以SYSTEM权限运行，注入的DLL也会以SYSTEM权限执行，从而允许攻击者完全控制受影响的系统。
3.  **用户创建：**  提供的PoC代码默认使用内置的payload（`get_nightmare_dll`函数）创建一个新的本地用户（默认用户名为`adm1n`，密码为`P@ssw0rd`），并将其添加到本地管理员组。攻击者可以自定义用户名和密码，或者指定自己的DLL执行任意代码。
4.  **远程利用：** 虽然PoC可能在本地执行，但Print Spooler服务通常也监听网络连接，这使得该漏洞可以通过网络进行远程利用。

总的来说，这是一个高危漏洞，利用起来相对简单，攻击者可以利用它获得受害者系统的完全控制权。

**项目地址:** [whoami-chmod777/CVE-2021-1675---PrintNightmare-LPE-PowerShell-](https://github.com/whoami-chmod777/CVE-2021-1675---PrintNightmare-LPE-PowerShell-)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

## POC #29

**来源**: [CVE-2021-1675-whoami-chmod777_CVE-2021-1675-CVE-2021-34527.md](../2021/CVE-2021-1675-whoami-chmod777_CVE-2021-1675-CVE-2021-34527.md)

## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许攻击者以SYSTEM权限执行任意代码

**影响版本:** 受影响的Windows版本众多，包括但不限于 Windows 7, Windows 8.1, Windows 10 (多个版本), Windows Server 2008, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2020等，具体版本号参考漏洞库信息。

**利用条件:** 目标系统需要启用Print Spooler服务，攻击者需要一定的权限（通常是域用户）或欺骗用户进行操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以利用此漏洞在目标系统上以SYSTEM权限执行任意代码。根据搜索引擎结果和漏洞库信息，此漏洞影响多个Windows版本。提供的PoC代码 `CVE-2021-1675.ps1` 是一个PowerShell脚本，旨在利用此漏洞。该脚本通过添加恶意的打印机驱动程序来执行代码。如果 `$DLL` 参数为空，PoC会创建一个默认payload，在临时目录生成恶意DLL,用于创建新的本地管理员用户。如果提供了自定义的DLL，PoC会直接使用该DLL进行攻击。PoC的有效性较高，因为该漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。存在轻微投毒风险，因为PoC可以接受用户提供的DLL，攻击者可以在提供的DLL中植入恶意代码。PoC中默认DLL部分存在恶意行为，但该行为是POC功能的一部分，用于创建用户，不应视为投毒。根据提供的PoC代码，投毒风险估计为10%，主要来自于用户可能提供的恶意DLL。

**利用方式：**
1.  攻击者需要能够访问目标系统的网络。
2.  攻击者运行PoC脚本，指定恶意DLL或使用默认payload。
3.  PoC脚本利用Print Spooler服务添加恶意的打印机驱动程序。
4.  Print Spooler服务加载恶意DLL，执行其中的代码，从而允许攻击者以SYSTEM权限在目标系统上执行任意代码。
5. 通过执行DLL创建新用户或者其他更高级的操作.

**项目地址:** [whoami-chmod777/CVE-2021-1675-CVE-2021-34527](https://github.com/whoami-chmod777/CVE-2021-1675-CVE-2021-34527)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)

---

