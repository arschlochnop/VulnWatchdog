# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md](../2021/CVE-2021-43798-MalekAlthubiany_CVE-2021-43798.md)

# CVE-2021-43798

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-0xSAZZAD_Grafana-CVE-2021-43798.md)

## CVE-2021-43798 - Grafana 目录遍历和密码解密

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/密码解密

**影响应用:** Grafana

**危害等级:** 高危，允许任意文件读取和敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，且攻击者能访问Grafana的web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞，攻击者可以通过 `grafana_host_url/public/plugins/<plugin ID>/` 路径，利用目录遍历读取服务器上的任意文件。提供的漏洞利用代码包含一个Python脚本，该脚本用于解密Grafana数据库密码。Grafana使用AES加密数据源密码，密钥存储在 `defaults.ini` 或 `grafana.ini` 配置文件中。脚本通过用户提供的密钥解密密码。虽然主要功能是密码解密，但考虑到作者可能在代码中添加恶意功能，因此存在较低的投毒风险。风险主要来自于安装的 cryptography 依赖项被供应链污染。目录遍历允许攻击者读取敏感配置文件，例如包含数据库凭据的文件。密码解密脚本允许攻击者获取数据库密码，从而进一步提升攻击影响。

**漏洞利用方式：**

1.  **目录遍历：** 利用 `grafana_host_url/public/plugins/<plugin ID>/` 路径，通过构造恶意payload，读取服务器上的任意文件。
2.  **密码解密：** 获取Grafana配置文件中的 `secret_key`，运行提供的Python脚本，解密数据库密码。

**投毒风险分析：**

提供的代码主要涉及密码的加密和解密，风险点在于对 `cryptography` 库的依赖。如果该库被恶意篡改，则可能存在投毒风险。此外，作者可能在代码中添加隐藏的恶意逻辑。但总体来看，该代码的投毒风险相对较低。

*   该POC的主要作用是解密密码，而不是执行任意代码，因此不太可能存在严重的投毒行为。
*   对用户输入进行了简单的处理，没有发现明显的漏洞。
*   依赖的 `cryptography` 库有被供应链攻击的风险。

综上，判定投毒风险为 5%。

**项目地址:** [0xSAZZAD/Grafana-CVE-2021-43798](https://github.com/0xSAZZAD/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #2

**来源**: [CVE-2021-43798-A-D-Team_grafanaExp.md](../2021/CVE-2021-43798-A-D-Team_grafanaExp.md)

## CVE-2021-43798 Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana服务可访问，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 8.0.0-beta1 到 8.3.0 版本（不包括已修复的版本）中的一个目录遍历漏洞。该漏洞允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>/` 路径读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响多个 Grafana 版本，并且存在公开的 PoC 代码。

**有效性：**
提供的 PoC 代码 `grafanaExp` 看起来功能完善，包括自动检测漏洞、枚举插件、提取密钥以及解密数据库文件等功能。它支持通过 HTTP(S) 协议进行攻击，并能绕过一些 Nginx 配置。该 PoC 代码的存在证明了该漏洞的可利用性。

**投毒风险：**
在评估投毒风险时，需要考虑以下几点：
*   **代码功能：** 该 PoC 代码主要用于读取文件和提取配置信息。虽然具有一定的攻击性，但主要集中在信息泄露方面，没有直接执行恶意代码的功能。
*   **作者声明：** 代码包含“本程序应仅用于授权的安全测试与研究目的”的声明，这表明作者可能不希望该代码被用于恶意目的。
*   **潜在风险：** 攻击者可能会利用该 PoC 代码读取敏感信息（如数据库凭据）并进一步攻击系统。因此，使用该 PoC 代码需要谨慎，并确保在授权环境下进行。

综合来看，该 PoC 代码的投毒风险较低，但仍然存在被滥用的可能性。主要集中在信息泄露，进而导致更严重的安全问题。我给出的投毒风险概率为5%，主要是考虑到被用于非授权环境的可能性。

**利用方式：**
1.  **确定目标 Grafana 版本：** 通过访问 Grafana 实例或查看其版本信息，确定其是否在受影响的范围内。
2.  **枚举插件：** 使用 PoC 代码或手动构造 URL (`<grafana_host_url>/public/plugins/<plugin_id>/`)，尝试访问不同的插件目录，以确认哪些插件已安装。
3.  **读取任意文件：** 利用目录遍历漏洞，构造包含 `../` 的 URL，读取服务器上的任意文件。例如，读取 `/etc/passwd` 或 Grafana 的配置文件。
4.  **提取密钥：** 从 Grafana 的配置文件中提取 `secret_key`，用于解密数据库。
5.  **解密数据库：** 使用提取的 `secret_key` 和 PoC 代码，解密 Grafana 的数据库文件，获取数据源信息（如数据库连接字符串）。
6.  **横向渗透：** 利用获取的数据库连接信息，尝试访问其他系统或数据库，进行横向渗透。

总而言之，该漏洞利用简单，危害较大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [A-D-Team/grafanaExp](https://github.com/A-D-Team/grafanaExp)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #3

**来源**: [CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md](../2021/CVE-2021-43798-Bouquets-ai_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，Grafana实例存在漏洞且安装了插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中存在的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历字符的URL，读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径，其中`<plugin_id>`是已安装插件的ID。提供的Go语言POC代码通过读取`url.txt`中的URL列表，并针对每个URL，尝试拼接不同的插件路径和目录遍历payload，以读取`/etc/passwd`文件来验证漏洞是否存在。如果`/etc/passwd`包含"root:"字符串，则认为存在漏洞，并将URL写入`test.txt`文件中。根据提供的代码，没有发现明显的投毒风险。

**有效性评估：**

该POC代码看起来是有效的，因为它实现了漏洞描述中提到的攻击向量，并尝试读取一个已知文件（`/etc/passwd`）来验证漏洞的存在。搜索结果也表明该漏洞存在可利用的POC。

**利用方式：**

1.  **确定目标Grafana实例的版本：**  漏洞影响Grafana 8.0.0-beta1 to 8.3.0版本。
2.  **确定是否存在易受攻击的插件：**  利用漏洞需要知道目标实例上已安装的插件ID。
3.  **构造恶意URL：**  将插件ID和目录遍历payload拼接到`/public/plugins/<plugin_id>/`路径中，例如：`/public/plugins/alertlist/../../../../../../../../../../../../../../etc/passwd`。
4.  **发送请求：**  向构造的URL发送HTTP GET请求。
5.  **读取文件：**  如果漏洞存在，服务器将返回被请求文件的内容。
6.  **利用步骤（参考README.md）：** 验证存在后访问 `var/lib/grafana/grafana.db` 即可下载这个数据库文件打开 user 的表，发现 login 为 admin 的一般密码也为 admin，登录进去即可。

**投毒风险评估：**

提供的Go语言POC代码主要用于验证漏洞是否存在，其目的是读取`/etc/passwd`文件。虽然该代码本身没有明显的投毒行为，但需要注意以下几点：

*   **url.txt：**  `url.txt` 文件包含要测试的 Grafana 实例的URL列表，这些URL可能指向恶意服务器，从而导致信息泄露或受到进一步攻击。需要确保此列表中的URL是可信的。
*   **test.txt：**  `test.txt` 文件包含确认存在漏洞的Grafana实例的URL，这些URL如果被泄露，可能会被恶意攻击者利用。
*   **供应链风险：**  虽然直接的代码没有投毒，但是需要确认下载该代码的来源是可信的，防止被中间人攻击。

**总体评估：**

该POC代码在验证漏洞方面是有效的，但需要注意相关的安全风险，例如确保`url.txt`中的URL是可信的，以及妥善保管`test.txt`文件。直接的代码分析未发现直接的投毒风险。综合评估投毒风险为0%。

**项目地址:** [Bouquets-ai/CVE-2021-43798](https://github.com/Bouquets-ai/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #4

**来源**: [CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md](../2021/CVE-2021-43798-FAOG99_GrafanaDirectoryScanner.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0（除已修补版本外）

**利用条件:** 需要网络访问，Grafana实例运行在受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于处理插件路径的逻辑中。攻击者可以通过构造包含目录遍历序列（例如 `../`）的 URL，访问 `/public/plugins/<plugin_id>/` 之外的文件。

**有效性分析：**

提供的 Python 脚本 `GrafanaDirectoryScanner.py` 旨在利用此漏洞。它通过尝试一系列包含目录遍历序列的 URL 来扫描目标 Grafana 实例，以查找指定的文件（默认为 `/etc/passwd`）。如果脚本成功地从目标服务器检索到文件，它将打印响应的状态、标头和内容。根据漏洞描述和提供的代码，此PoC应该是有效的。

**投毒风险分析：**

查看提供的 `GrafanaDirectoryScanner.py` 脚本和 `README.md` 文件，没有发现任何可疑或恶意代码。脚本仅发送 HTTP 请求并打印响应。`README.md` 文件仅包含漏洞描述和脚本的使用说明。因此，投毒风险评估为 0%。

**漏洞利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，不包括已修补版本）。
2.  找到目标 Grafana 实例上已安装的插件 ID。任何插件 ID 都适用，因为漏洞不在于特定插件，而在于通用的路径处理逻辑。
3.  构造包含目录遍历序列和目标文件路径的 URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。
4.  发送构造的 URL 到目标 Grafana 实例。
5.  如果漏洞存在且利用成功，服务器将返回目标文件的内容。

**POC利用:**
1. 运行脚本 `python GrafanaDirectoryScanner.py -d <grafana_host_ip> -p <grafana_host_port> -f /etc/passwd` 
2. 替换 `<grafana_host_ip>` 和 `<grafana_host_port>`为目标 grafana 实例的ip和端口

**项目地址:** [FAOG99/GrafanaDirectoryScanner](https://github.com/FAOG99/GrafanaDirectoryScanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #5

**来源**: [CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md](../2021/CVE-2021-43798-G01d3nW01f_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且目标 Grafana 实例存在受影响版本的插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造特殊的 URL，利用`/public/plugins/<plugin_id>/`路径绕过访问限制，读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1 到 8.3.0版本（已修复版本除外）。

**利用方式：**

1.  **确定目标 Grafana 版本：** 通过服务器 banner 信息或 API 接口判断目标 Grafana 版本是否在受影响范围内。
2.  **选择一个已安装的插件：**  利用提供的 `plugin_list` 或者其他方式获取 Grafana 实例中已安装的插件 ID。
3.  **构造恶意 URL：**  使用以下格式构造包含目录遍历的 URL：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../<想要读取的文件路径>`
4.  **发送请求：**  向构造的 URL 发送 GET 请求，如果漏洞存在，服务器将返回目标文件的内容。

**POC 代码分析：**

提供的 Python 脚本 `grafana-exploit.py` 实现了上述利用过程：

*   **指定目标主机：** 使用 `-H` 或 `--host` 参数指定目标 Grafana 实例的 URL。
*   **选择插件：** 脚本从 `plugin_list` 列表中随机选择一个插件 ID。
*   **构造 URL：** 脚本构造包含目录遍历的 URL，并允许用户指定要读取的文件路径。
*   **发送请求：** 脚本发送 HTTP GET 请求，读取指定文件。
*   **输出结果：** 如果成功读取文件，脚本会将文件内容输出到控制台，同时输出可用的 curl 命令。

**投毒风险分析：**

*   分析了提供的脚本，没有发现恶意代码或后门，该脚本的主要功能是发送 HTTP 请求并读取文件内容，不具备持久化或控制目标系统的能力。
*   `readme.md` 文件仅包含脚本的使用说明，没有发现任何可疑内容。

因此，认为此仓库中不存在作者隐藏的投毒代码。

**项目地址:** [G01d3nW01f/CVE-2021-43798](https://github.com/G01d3nW01f/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #6

**来源**: [CVE-2021-43798-Iris288_CVE-2021-43798.md](../2021/CVE-2021-43798-Iris288_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #7

**来源**: [CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md](../2021/CVE-2021-43798-Jroo1053_GrafanaDirInclusion.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未修补版本)

**利用条件:** 目标Grafana实例存在于受影响版本，并且可通过网络访问，至少安装一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（未修补版本）。攻击者可以利用该漏洞读取 Grafana 服务器上的任意文件。

**有效性：**
提供的 POC 代码 `exploit.py` 看起来是有效的。它通过构造包含目录遍历序列（`../`）的 URL，尝试访问 Grafana 服务器上的文件。代码逻辑比较清晰，首先选择一个存在漏洞的插件，然后利用`/public/plugins/<plugin_id>/../` 构造payload,再发送GET请求，接收服务器返回的内容。

**投毒风险：**
通过查看提供的POC代码，没有发现任何明显的恶意或投毒代码。 该脚本的主要功能是读取文件，并没有发现任何尝试修改系统配置、安装后门或执行其他恶意操作的迹象。因此，投毒风险评估为 0%。测试代码也主要关注验证漏洞的读取文件功能。

**利用方式：**
利用方式如下：
1.  确定目标 Grafana 服务器的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0，未修补版本）。
2.  找到一个已安装的插件ID。POC代码中包含一个插件列表`VULN_PLUGINS`，可以从中选择一个。
3.  构造包含目录遍历序列的 URL：`https://<grafana_host>/public/plugins/<plugin_id>/../../../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回所请求文件的内容（例如 `/etc/passwd`）。

综上所述，该漏洞利用的有效性较高，并且没有明显的投毒风险。攻击者可以利用该漏洞读取服务器上的敏感文件，例如配置文件、密钥等，从而可能导致更严重的后果。

**项目地址:** [Jroo1053/GrafanaDirInclusion](https://github.com/Jroo1053/GrafanaDirInclusion)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #8

**来源**: [CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md](../2021/CVE-2021-43798-K3ysTr0K3R_CVE-2021-43798-EXPLOIT.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除了已修复的版本)

**利用条件:** 需要能够访问 Grafana 实例的网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798 存在于 Grafana 的目录遍历漏洞，允许未经身份验证的攻击者通过 `public/plugins/<plugin_id>` 路径读取服务器上的任意文件。PoC 代码通过构造包含目录遍历序列（如 `../../..`）的 URL，尝试读取敏感文件，如 `/etc/passwd` 或 `win.ini`。利用方式是：

1.  **确定目标 Grafana 版本**：攻击者需要确定目标 Grafana 实例的版本，判断其是否属于受影响的范围（8.0.0-beta1 到 8.3.0）。
2.  **选择插件 ID**：攻击者需要选择一个已安装的插件 ID。 PoC 代码中提供了一个插件 ID 列表。
3.  **构造恶意 URL**：攻击者构造包含目录遍历序列的恶意 URL，指向目标文件。URL 格式为 `<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../../../../../../../../../<目标文件>`。
4.  **发送 HTTP 请求**：攻击者向构造的恶意 URL 发送 HTTP GET 请求。
5.  **读取文件内容**：如果漏洞存在且利用成功，服务器将返回目标文件的内容。

PoC代码中存在以下可能导致误报或利用失败的情况：

*   **插件ID不存在:** 如果提供的`plugin_ids` 列表中的任何ID 在目标服务器上不存在，利用将会失败。
*   **文件权限限制:**  即使成功绕过目录遍历，如果 Grafana 进程没有读取目标文件的权限，也无法成功读取文件内容。
*   **目标文件不存在:**  尝试读取不存在的文件会返回错误信息，导致利用失败。

代码中投毒风险较低。虽然没有明显的恶意代码，但仍然存在一些潜在的风险：

*   **信息收集:** PoC 代码会发送 HTTP 请求到目标服务器，服务器可能会记录攻击者的 IP 地址等信息。
*   **拒绝服务:** 大量并发的 PoC 请求可能会导致目标服务器的拒绝服务。

**项目地址:** [K3ysTr0K3R/CVE-2021-43798-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-43798-EXPLOIT)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #9

**来源**: [CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md](../2021/CVE-2021-43798-M0ge_CVE-2021-43798-grafana_fileread.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可读取敏感文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要Grafana实例运行在受影响版本，并且存在可利用的插件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-43798是Grafana的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于`/public/plugins/<plugin_id>/`路径下，攻击者可以通过构造包含`../`的payload来绕过目录限制，读取`/etc/passwd`等敏感文件。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码通过构造恶意URL，利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞的存在。

**投毒风险：**

PoC代码本身主要功能是漏洞验证，并未发现明显的恶意投毒代码。PoC的功能相对独立，主要涉及发送HTTP请求和分析响应。但是，需要注意以下几点：

1.  `plugins.txt` 文件：该文件包含插件列表，用于枚举可能存在的插件目录。虽然没有直接的投毒代码，但如果该文件被恶意修改，加入不存在的插件，可能会导致大量的无效请求，造成拒绝服务攻击。
2.  依赖库：PoC依赖`requests`库，如果攻击者替换或篡改了`requests`库，可能会导致恶意代码执行。但这种风险并非PoC本身带来的，而是依赖库供应链的安全问题。
3.  写入文件：PoC会将漏洞URL写入`grafana 8.x_fileread_vuln.txt`文件，如果服务器权限配置不当，可能会导致信息泄露。

总体来说，该PoC的投毒风险较低，约为1%。主要风险在于对依赖库的篡改，或者利用不当造成的其他安全问题。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（>= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0）。
2.  找到目标Grafana实例中安装的插件ID，可以通过访问`/public/plugins/`路径来枚举插件。
3.  构造包含目录遍历的URL：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../../../../etc/passwd`。
4.  发送HTTP请求，如果返回`/etc/passwd`的内容，则说明漏洞存在。
5.  可以替换`/etc/passwd`为其他文件路径，读取服务器上的其他敏感文件。

**项目地址:** [M0ge/CVE-2021-43798-grafana_fileread](https://github.com/M0ge/CVE-2021-43798-grafana_fileread)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #10

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #11

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---



---

## POC #11

**来源**: [CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md](../2021/CVE-2021-43798-Sic4rio_Grafana-Decryptor-for-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，目标Grafana实例存在漏洞且插件目录可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Grafana 的插件目录处理中，攻击者可以通过构造包含目录遍历字符的 URL，读取服务器上的任意文件。根据提供的漏洞信息，受影响的版本为 8.0.0-beta1 到 8.3.0。利用方式是通过访问 `grafana_host_url/public/plugins/<plugin_id>/`，并在 plugin_id 中包含目录遍历的payload，例如 `../../../../etc/passwd`。PoC代码提供了一个解密 Grafana 数据源密码的脚本，利用 CVE-2021-43798 读取 grafana.db 和 grafana.ini 文件，然后使用 ini 文件中的 secret_key 解密数据库中的密码。虽然主要功能是密码解密，但是利用该漏洞读取任意文件是漏洞利用的根本，因此有效性很高。

**有效性分析：**
根据漏洞描述和 PoC 代码，漏洞利用的有效性较高。PoC 脚本能够利用目录遍历漏洞读取敏感文件，进而解密数据源密码，证明了漏洞的可利用性。

**投毒风险分析：**
对 PoC 代码进行了分析，发现投毒风险较低，风险占比5%。

1.  **依赖包:** PoC代码依赖的第三方库均为常用的密码学和网络请求库(requests, questionary, termcolor, cryptography)，被植入恶意代码的可能性较低。
2.  **代码逻辑:** 代码主要实现了从 Grafana 配置文件中读取密钥并解密数据库中存储的密码。该逻辑与漏洞描述一致，没有发现额外的恶意操作。
3.  **输入输出:** 该脚本需要用户提供 grafana.db 和 grafana.ini 文件的路径，并将解密后的密码输出到控制台。没有发现将敏感信息发送到外部服务器或执行其他恶意操作的代码。

**利用方式：**
1.  **确定目标Grafana版本:** 确认目标Grafana实例的版本在受影响范围内 (8.0.0-beta1 to 8.3.0).
2.  **获取plugin ID:**  获取目标Grafana实例已安装插件的ID，可以在 Grafana 的插件管理页面找到。
3.  **构造恶意URL:** 构造包含目录遍历payload的URL，例如 `grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`。
4.  **读取敏感文件:**  通过发送构造的URL请求，尝试读取服务器上的敏感文件，例如 `/etc/passwd`、`grafana.ini`、`grafana.db` 等。
5.  **解密数据源密码 (如果成功读取grafana.ini和grafana.db):**  使用 PoC 脚本解密数据源密码。

总而言之，此漏洞的利用方式清晰且有效，攻击者可以利用目录遍历读取敏感信息，存在较高的安全风险。

**项目地址:** [Sic4rio/Grafana-Decryptor-for-CVE-2021-43798](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #12

**来源**: [CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md](../2021/CVE-2021-43798-abuyazeen_CVE-2021-43798-Grafana-path-traversal-tester.md)

## CVE-2021-43798 - Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问，并且 Grafana 实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 Grafana 8.0.0-beta1 到 8.3.0 版本中的一个目录遍历漏洞(CVE-2021-43798)。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞位于`/public/plugins/<plugin ID>/`路径下，通过构造恶意的 URL，可以绕过权限校验，读取到本不该访问的文件。

**利用方式：**

1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  找到一个可利用的插件ID。所有插件均可利用，例如 alertGroups, alertlist等。
3.  构造包含目录遍历的 URL，例如：`https://<grafana_host_url>/public/plugins/alertGroups/../../../../../../../../../../etc/passwd`，用于读取 `/etc/passwd` 文件。
4.  使用 HTTP 请求发送构造好的 URL。
5.  如果请求成功，响应体将包含被读取的文件内容。

**有效性：**

提供的 POC 代码通过读取 `paths.txt` 文件中的路径，批量测试 Grafana 实例是否存在该目录遍历漏洞。它通过 `curl` 命令发送 HTTP 请求，并使用 `--path-as-is` 参数来避免 URL 规范化。如果 HTTP 状态码为 200，则将响应体保存到文件中。该 POC 代码是有效的，可以用于检测目标 Grafana 实例是否存在该漏洞。

**投毒风险：**

分析提供的 POC 代码，脚本本身的功能是自动化检测目录遍历漏洞，没有发现任何明显的投毒代码。`paths.txt` 包含一些常见的文件路径，如 `/etc/passwd` 和 Windows 上的 `win.ini`，用于验证漏洞是否存在。因此，投毒风险评估为0%。

**项目地址:** [abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester](https://github.com/abuyazeen/CVE-2021-43798-Grafana-path-traversal-tester)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #13

**来源**: [CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md](../2021/CVE-2021-43798-aymenbouferroum_CVE-2021-43798_exploit.md)

## CVE-2021-43798 Grafana 目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 URL，访问服务器上的任意文件。漏洞存在于 URL 路径 `/public/plugins//`，其中 `<plugin id>` 是任何已安装插件的 ID。利用方式是：首先确定目标 Grafana 实例是否运行在受影响的版本范围内。然后，构造包含目录遍历序列的 URL，例如 `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../etc/passwd`。如果服务器返回 `/etc/passwd` 文件的内容，则表明漏洞存在。

**有效性分析：**

提供的POC代码 `exploit.py` 实现了漏洞的利用，包括版本检测和利用过程。代码首先检查目标Grafana实例的版本是否在受影响范围内，然后构造包含目录遍历序列的URL，发送HTTP请求，并根据响应状态码判断漏洞是否存在。因此POC代码是有效的.

**投毒风险分析：**

代码主要功能是检查Grafana版本和发送包含目录遍历的请求，风险较低。payload.txt,paths.txt文件可能存在恶意payload。代码会尝试从payload.txt文件中读取payload，并结合目录遍历路径进行利用。虽然代码本身没有明显的恶意行为，但如果 `payload.txt` 文件中包含恶意命令或脚本，则存在潜在的投毒风险。因此，不能完全排除投毒风险，但风险较低。综合评估，投毒风险为10%。

**利用方式总结：**

1.  确定目标 Grafana 实例的 IP 地址和端口。
2.  检测目标 Grafana 实例的版本。
3.  构造包含目录遍历序列的 URL：`/public/plugins/<plugin_id>/../../../../../../etc/passwd` (例如)。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果服务器返回请求的文件内容，则漏洞存在。

**项目地址:** [aymenbouferroum/CVE-2021-43798_exploit](https://github.com/aymenbouferroum/CVE-2021-43798_exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #14

**来源**: [CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md](../2021/CVE-2021-43798-davidr-io_Grafana-8.3-Directory-Traversal.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Grafana中的一个目录遍历漏洞，攻击者可以通过构造特殊的URL，读取服务器上的任意文件。根据漏洞库信息，受影响的版本包括8.0.0-beta1到8.3.0（除了已修复的版本）。漏洞利用代码提供了一个Python脚本，该脚本允许用户指定要读取的文件，并利用漏洞读取文件内容。利用方式是通过 `http://{ip}:{port}/public/plugins/alertlist/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e{file2read}` 这样的URL进行目录穿越，读取目标文件。

**有效性：**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码直接利用了漏洞描述中的URL路径进行文件读取，并提供交互式界面方便读取任意文件。搜索结果中的文章也证明了漏洞的存在和可利用性。

**投毒风险：**

分析提供的Python脚本 `readFiles.py`，该脚本主要功能是构造恶意URL来读取文件，本身不存在恶意代码，例如反弹shell，植入后门等行为。脚本只是简单地发送HTTP请求并打印响应。因此，投毒风险较低，为0%。

**利用方式：**

1.  确定目标Grafana实例的版本是否在受影响的范围内。
2.  找到安装的插件ID（此处PoC中使用的是 `alertlist`）。
3.  使用提供的Python脚本 `readFiles.py`，指定目标Grafana实例的IP地址和端口号。
4.  在脚本提示符下，输入要读取的文件路径（例如 `/etc/passwd`）。
5.  脚本将构造恶意URL并发送HTTP请求，然后打印响应内容，即目标文件的内容。
6.  可以通过多次输入不同的文件路径来读取多个文件。

**项目地址:** [davidr-io/Grafana-8.3-Directory-Traversal](https://github.com/davidr-io/Grafana-8.3-Directory-Traversal)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #15

**来源**: [CVE-2021-43798-hupe1980_CVE-2021-43798.md](../2021/CVE-2021-43798-hupe1980_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #16

**来源**: [CVE-2021-43798-hxlxmj_Grafxploit.md](../2021/CVE-2021-43798-hxlxmj_Grafxploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #17

**来源**: [CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md](../2021/CVE-2021-43798-jas502n_Grafana-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本外)

**利用条件:** 需要能够访问Grafana实例的网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的URL，例如`grafana_host_url/public/plugins/<plugin_id>/../../../../etc/passwd`，来读取服务器上的任意文件。漏洞存在于Grafana 8.0.0-beta1到8.3.0版本（除已修补版本外）。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC代码。提供的Go代码不是直接利用目录遍历漏洞的代码，而是用于解密Grafana数据源密码的工具。但是这个代码依赖从Grafana配置文件中获取的key，这个key本身可能通过目录遍历漏洞获取，所以提供的代码可以被认为是漏洞利用链的一部分。如果能够利用目录遍历漏洞读取到Grafana的配置文件，就可以利用这个Go程序解密数据库密码等敏感信息。

**投毒风险评估：**

提供的Go代码主要包含AES解密/加密的相关函数，代码逻辑相对简单，主要包含以下函数：
* `deriveEncryptionAlgorithm`: 根据payload的前缀确定加密算法（AES-CFB或者AES-GCM）。
* `decryptGCM`: 使用AES-GCM算法解密数据。
* `encryptionKeyToBytes`: 使用PBKDF2算法从密钥和salt派生出加密密钥。
* `decryptCFB`: 使用AES-CFB算法解密数据。
* `Decrypt`: 解密payload，主解密函数，先确定算法，然后解密。
* `Encrypt`: 加密payload，已弃用。
* `GetRandomString`: 生成随机字符串。
* `main`: 主函数，演示如何使用`Decrypt`函数解密Grafana数据源密码。

阅读代码后，没有发现明显的恶意代码或者后门。代码的主要功能是解密Grafana的加密数据，虽然存在被滥用的风险，但其本身不包含投毒代码。

**利用方式：**

1.  利用CVE-2021-43798目录遍历漏洞，通过构造特殊的URL读取Grafana服务器上的配置文件，例如`grafana.ini`或类似的配置文件。这个文件通常包含数据库密码等敏感信息，但通常是加密存储的。
2.  从配置文件中获取加密密钥（例如，`secret_key`）。
3.  使用提供的Go代码，将从配置文件中获取的加密密钥以及加密后的数据库密码作为输入，解密数据库密码。
4.  使用解密后的数据库密码连接到Grafana所连接的数据库，从而获取更敏感的数据，甚至可以修改数据库中的数据。

总而言之，此Go代码本身不是投毒代码，但需要配合目录遍历漏洞使用才能发挥作用。没有发现该仓库存在作者隐藏的投毒代码。

**项目地址:** [jas502n/Grafana-CVE-2021-43798](https://github.com/jas502n/Grafana-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #18

**来源**: [CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md](../2021/CVE-2021-43798-k3rwin_CVE-2021-43798-Grafana.md)

## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #19

**来源**: [CVE-2021-43798-katseyres2_CVE-2021-43798.md](../2021/CVE-2021-43798-katseyres2_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions)

**利用条件:** 需要能够访问 Grafana 服务，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

提供的Python脚本利用了 CVE-2021-43798 漏洞，该漏洞允许未经身份验证的攻击者通过目录遍历读取 Grafana 服务器上的任意文件。脚本首先检查 Grafana 的版本是否在受影响的范围内，然后构造包含目录遍历序列的 URL，尝试读取 `/etc/passwd`（在 Linux 上）或 `Windows\System32\drivers\etc\hosts`（在 Windows 上）文件。因此，提供的POC代码在目标存在漏洞的情况下，可以有效读取目标文件。

**2. 投毒风险：**

仔细分析提供的Python脚本代码，没有发现任何可疑的后门代码或恶意行为。脚本的功能完全集中在利用目录遍历漏洞读取文件上。所有操作均在预期之内，没有发现任何隐藏的恶意功能。例如，脚本没有尝试修改任何文件、建立反向shell或执行任何其他未经授权的操作。基于此，可以认为该POC代码不存在投毒风险。

**3. 利用方式：**

漏洞的利用方式如下：

1.  **确定目标 Grafana 版本：** 通过访问 `/api/health` 端点获取 Grafana 的版本信息。
2.  **构造恶意 URL：** 使用以下格式构造 URL：`grafana_host_url/public/plugins/<plugin_id>/<path_traversal>`，其中 `<plugin_id>` 可以是任意已安装插件的 ID（例如 `alertlist`），`<path_traversal>` 是包含目录遍历序列（例如 `../../../../`）和目标文件路径的字符串。
3.  **发送 HTTP 请求：** 向构造的恶意 URL 发送 HTTP GET 请求。
4.  **读取文件内容：** Grafana 将返回目标文件的内容。

**总结：**

提供的POC代码是有效的，不存在投毒风险，并且准确地实现了 CVE-2021-43798 漏洞的利用。攻击者可以通过该漏洞读取 Grafana 服务器上的任意文件，从而可能泄露敏感信息，例如数据库凭据、API 密钥和配置文件。

**项目地址:** [katseyres2/CVE-2021-43798](https://github.com/katseyres2/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #20

**来源**: [CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md](../2021/CVE-2021-43798-mauricelambert_LabAutomationCVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要目标Grafana实例运行在受影响版本，且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。攻击者可以利用该漏洞通过 `grafana_host_url/public/plugins//` 路径读取本地文件。PoC 代码首先从 `/metrics` 端点获取已安装插件的 ID，然后利用目录遍历漏洞读取目标文件（默认为 `/etc/passwd`）。PoC 还尝试读取用户的 SSH 私钥，并使用该密钥通过 SSH 连接到目标系统，并尝试提权。 

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞存在且有公开的 PoC。提供的PoC代码看起来完整且逻辑清晰，应该可以有效利用该漏洞，提取敏感文件。

**投毒风险评估：**
该PoC的代码功能比较直观，主要用于文件读取和SSH密钥的利用。其中存在少量可疑点：PoC会尝试使用读取到的SSH密钥进行SSH连接，并在目标机器上执行一些命令(sudo -l，find suid/guid文件， install awk 以及读取 user.txt和 root.txt)。这些命令本身不一定是恶意的，但可能被滥用于收集目标系统信息或尝试提权。因此，存在一定的投毒风险，约为10%。主要风险点在于脚本自动化了SSH密钥的利用和后续的命令执行，攻击者可能修改这些命令以达到恶意目的。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0, excluding patched versions)。
2.  使用 PoC 脚本，指定目标 Grafana 实例的 URL 和要读取的文件路径。
3.  脚本将利用目录遍历漏洞读取指定文件，并尝试读取用户的SSH密钥，如果成功读取到SSH密钥，会尝试使用SSH密钥登录并执行提权操作。
4.  攻击者可以根据需要修改脚本，读取其他敏感文件或执行其他操作。

**项目地址:** [mauricelambert/LabAutomationCVE-2021-43798](https://github.com/mauricelambert/LabAutomationCVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #21

**来源**: [CVE-2021-43798-monke443_CVE-2021-43798.md](../2021/CVE-2021-43798-monke443_CVE-2021-43798.md)

## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #22

**来源**: [CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md](../2021/CVE-2021-43798-ravi5hanka_CVE-2021-43798-Exploit-for-Windows-and-Linux.md)

## CVE-2021-43798 - Grafana 目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (不包括已修复版本 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 目标 Grafana 实例运行在受影响版本范围内，且可以通过网络访问 /public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞存在于 /public/plugins/<plugin_id>/ 路径，其中 <plugin_id> 是已安装插件的 ID。攻击者可以通过构造包含目录遍历序列（如 ../）的 URL 来访问受限目录之外的文件。

**有效性:** 提供的POC代码是有效的。它利用了 Grafana 的目录遍历漏洞，允许攻击者读取服务器上的任意文件。该代码可以根据目标操作系统（Linux 或 Windows）构造合适的路径，并发送 HTTP 请求以检索文件内容。

**投毒风险:**  代码本身看起来主要是为了利用漏洞。README.md 文件说明了代码的功能，即适配 Linux 和 Windows 系统。虽然存在微小的投毒风险（5%），但这主要在于代码的潜在滥用，而非恶意代码本身。例如，攻击者可能会修改代码以自动化扫描和数据提取，但原始代码的核心功能是读取文件，不包含主动植入后门等恶意行为。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  选择一个已安装的插件 ID。 提供的python代码中已内置插件ID的列表。
3.  构造包含目录遍历序列的 URL。 例如，`/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回请求的文件内容。该POC脚本通过输入文件路径，自动构造payload并发送请求。需要指定目标系统的类型。

该漏洞的修复方法是将 Grafana 升级到 8.0.7、8.1.8、8.2.7 或 8.3.1 及以上版本。

**项目地址:** [ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux](https://github.com/ravi5hanka/CVE-2021-43798-Exploit-for-Windows-and-Linux)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #23

**来源**: [CVE-2021-43798-rnsss_CVE-2021-43798-poc.md](../2021/CVE-2021-43798-rnsss_CVE-2021-43798-poc.md)

## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #24

**来源**: [CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md](../2021/CVE-2021-43798-rodpwn_CVE-2021-43798-mass_scanner.md)

## CVE-2021-43798 - Grafana Directory Traversal

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经授权的本地文件读取

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本外)

**利用条件:** 需要Grafana实例运行且版本在受影响范围内，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-43798是一个Grafana中的目录遍历漏洞。通过构造包含目录遍历序列（如`../`）的URL，攻击者可以读取Grafana服务器上的任意文件。漏洞存在于`/public/plugins/<plugin ID>/`路径下，`<plugin ID>`为已安装插件的ID。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是有效的。存在多个公开的PoC代码，可以成功利用该漏洞读取文件。

**投毒风险：**
提供的PoC代码包含`Pipfile`、`Pipfile.lock`、`README.md`、`google-dorks.txt`和`main.py`。`README.md`描述了漏洞信息、使用方法和参考链接，`google-dorks.txt`包含用于在搜索引擎上查找易受攻击实例的dork。`main.py`是利用漏洞的主要脚本。虽然`main.py`的核心功能是利用目录遍历漏洞，但存在一定的投毒风险：

*   **依赖项：** `Pipfile`声明了`requests`依赖，攻击者可能通过控制pypi镜像源植入恶意依赖，但默认的pypi源风险较低。
*   **IP范围扫描和目标列表：** 该PoC支持通过IP范围扫描或目标列表进行漏洞利用。这可能被用于大规模扫描，从而增加被恶意利用的可能性。
*   **法律声明：** `README.md`中包含了免责声明，但这并不能完全排除恶意使用的可能性。
*   **gif图片:** readme文件里面存在引用外部gif图片，如果图片被替换，可能存在引诱用户下载恶意文件的风险

综合评估，该PoC存在一定的投毒风险，主要集中在潜在的恶意依赖项、大规模扫描利用以及外部资源引用风险。因此，投毒风险评估为20%。

**利用方式：**
1.  确定目标Grafana实例的版本是否在受影响范围内 (8.0.0-beta1 to 8.3.0，除已修复版本)。
2.  找到目标Grafana实例上已安装的插件ID。
3.  构造包含目录遍历序列的URL：`/<grafana_host_url>/public/plugins/<plugin ID>/../../../../../../../../../../etc/passwd` （例如）。
4.  发送构造的HTTP请求，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
5.  根据返回的内容判断漏洞是否存在，以及是否成功读取了目标文件。


**项目地址:** [rodpwn/CVE-2021-43798-mass_scanner](https://github.com/rodpwn/CVE-2021-43798-mass_scanner)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #25

**来源**: [CVE-2021-43798-suljov_Grafana-LFI-exploit.md](../2021/CVE-2021-43798-suljov_Grafana-LFI-exploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问Grafana服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理中，攻击者可以通过构造特殊的URL，利用目录遍历漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响Grafana 8.0.0-beta1 到 8.3.0版本（除已修复版本外）。

**有效性：**
提供的POC代码 `grafana-exploit.py` 经验证是有效的。该脚本首先尝试通过目录遍历读取 `/etc/passwd` 文件来确认漏洞是否存在。如果成功读取，则继续尝试读取 `grafana.db`、`grafana.ini` 和 `proc/self/cmdline` 等敏感文件。最后，脚本会尝试解析 `grafana.ini` 文件，提取 `secret_key`。

**投毒风险：**
根据对提供的POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用目录遍历漏洞读取文件，没有执行恶意操作或植入后门的行为。

**利用方式：**
1.  攻击者首先需要确定目标Grafana服务器的版本是否在受影响范围内。
2.  攻击者构造包含目录遍历payload的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`，其中`<plugin_id>`为已安装插件的ID。
3.  如果服务器存在漏洞，攻击者可以成功读取指定文件，例如`/etc/passwd`。
4.  攻击者可以进一步利用该漏洞读取其他敏感文件，例如Grafana的配置文件`grafana.ini`，从中获取数据库密码、API密钥等信息。
5.  攻击者可以使用获得的敏感信息进行进一步的攻击，例如访问数据库、控制Grafana服务等。

**项目地址:** [suljov/Grafana-LFI-exploit](https://github.com/suljov/Grafana-LFI-exploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #26

**来源**: [CVE-2021-43798-ticofookfook_CVE-2021-43798.md](../2021/CVE-2021-43798-ticofookfook_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #27

**来源**: [CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md](../2021/CVE-2021-43798-victorhorowitz_grafana-exploit-CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (除 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要网络访问Grafana实例，且Grafana版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本中，是一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞影响 Grafana 实例，允许未经身份验证的攻击者通过构造包含目录遍历序列（如 `../../..`）的 URL，访问服务器上的敏感文件。漏洞利用代码提供了一个 bash 脚本，该脚本通过循环遍历 `plugins.txt` 文件中的插件 ID，构造恶意的 URL 并发送 HTTP 请求。如果 Grafana 实例存在漏洞，脚本将读取指定的文件内容并将其保存到 `results.txt` 文件中。 

**有效性：** 提供的POC代码有效，因为它可以利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞库信息和搜索结果也证实了该漏洞的存在和可利用性。

**投毒风险：** 分析POC代码后，未发现明显的恶意代码或后门。脚本的主要功能是构造和发送 HTTP 请求，以及读取和保存响应。脚本中使用的命令（如 `curl`，`grep`，`cat`）都是常见的 Linux 命令，没有被滥用的迹象。`timeout` 命令用于防止请求无限期地挂起。`plugins.txt` 文件包含常见的 Grafana 插件名称，用于构造目录遍历的 URL。脚本的目的是利用目录遍历漏洞读取文件，而不是执行恶意操作。因此，投毒风险为 0%。

**利用方式：** 
1.  **确定目标 Grafana 实例的版本：** 攻击者需要确定目标 Grafana 实例的版本是否在受影响的范围内（8.0.0-beta1 到 8.3.0，不包括 8.0.7、8.1.8、8.2.7 和 8.3.1）。
2.  **选择插件 ID：** 攻击者需要选择一个有效的 Grafana 插件 ID。`plugins.txt` 文件提供了一个插件 ID 列表。
3.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列的恶意 URL。URL 的格式如下：
    `http://<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../..<file_path>`
    其中，`<grafana_host_url>` 是 Grafana 实例的 URL，`<plugin_id>` 是插件 ID，`<file_path>` 是要读取的文件的路径。
4.  **发送 HTTP 请求：** 攻击者需要发送 HTTP 请求到构造的恶意 URL。
5.  **读取文件内容：** 如果 Grafana 实例存在漏洞，服务器将返回文件的内容。攻击者可以读取返回的内容来获取敏感信息。

**项目地址:** [victorhorowitz/grafana-exploit-CVE-2021-43798](https://github.com/victorhorowitz/grafana-exploit-CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #28

**来源**: [CVE-2021-43798-wagneralves_CVE-2021-43798.md](../2021/CVE-2021-43798-wagneralves_CVE-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #29

**来源**: [CVE-2021-43798-wezoomagency_GrafXploit.md](../2021/CVE-2021-43798-wezoomagency_GrafXploit.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

## POC #30

**来源**: [CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md](../2021/CVE-2021-43798-yasindce1998_grafana-cve-2021-43798.md)

## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问，且目标Grafana实例未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造包含目录遍历序列的 URL，未经授权访问服务器上的本地文件。漏洞 URL 路径为 `<grafana_host_url>/public/plugins/<plugin ID>/<path traversal>`，其中 `<plugin ID>` 是已安装插件的 ID，`<path traversal>` 包含诸如 `../../..` 这样的序列。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码提供了一个 `grafana-vuln-app.yaml` 文件，用于在 Kubernetes 集群中部署一个存在漏洞的 Grafana 实例（版本 8.2.0），从而重现该漏洞。

**投毒风险分析：**
该 YAML 文件定义了一个 Grafana deployment，service，configmap。代码本身没有明显的恶意操作，例如反弹 shell 或植入后门。但该代码将部署一个**存在漏洞的** Grafana 实例。 如果攻击者使用该 YAML 文件部署 Grafana 实例，然后未及时修补漏洞，则该 Grafana 实例可能会受到攻击。

更细致地看：
*   `grafana-vuln-app.yaml`：此文件用于在 Kubernetes 集群中部署存在漏洞的 Grafana 实例，没有发现直接的投毒代码。
*   `README.md`：此文件包含部署说明，也没有投毒代码。

总的来说，该仓库主要目的是重现 CVE-2021-43798 漏洞，没有明显的投毒代码。然而，部署一个存在已知漏洞的实例本身就具有风险，如果部署后未及时修补，则可能被恶意利用。由于部署行为本身需要用户参与，且漏洞是已知的，因此将此评定为投毒有一定的争议。

**利用方式：**
1.  找到目标 Grafana 实例，确定其版本在受影响范围内（8.0.0-beta1 到 8.3.0，除已修补版本）。
2.  确定 Grafana 实例上已安装的插件 ID。
3.  构造包含目录遍历序列的 URL：` <grafana_host_url>/public/plugins/<plugin ID>/../../../../../../etc/passwd`。
4.  发送 HTTP GET 请求到构造的 URL。如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容。

**结论：** 漏洞利用有效，但需要目标 Grafana 实例未打补丁，且攻击者需要知道已安装的插件 ID。 投毒风险较低，主要风险在于部署了存在漏洞的 Grafana 实例后未及时修补。

**项目地址:** [yasindce1998/grafana-cve-2021-43798](https://github.com/yasindce1998/grafana-cve-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)

---

