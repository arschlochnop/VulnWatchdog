# CVE-2021-30047

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md](../2021/CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-拒绝服务

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 需要网络访问目标FTP服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-30047 漏洞存在于 vsftpd 3.0.3 版本中。该漏洞允许攻击者通过创建大量连接来耗尽服务器资源，导致拒绝服务。漏洞利用方式是通过发送大量的FTP连接请求，超出服务器的最大连接限制，使得正常用户无法连接。提供的PoC 代码通过使用多线程，循环创建 `ftp` 进程连接目标服务器，模拟了连接洪水攻击。`temporizador` 函数保证攻击在 15 分钟后自动停止，并通过 `pkill ftp` 命令结束所有 `ftp` 进程。代码中调用了外部命令 `ftp` 和 `pkill`，如果系统缺少这些命令可能无法运行。投毒风险较低，主要风险在于过度使用该脚本可能对目标系统或网络造成实际损害。代码中定时结束进程的操作，有几率会结束其他用户的ftp连接，存在一定误伤概率。

**项目地址:** [AndreyFreitass/CVE-2021-30047](https://github.com/AndreyFreitass/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #2

**来源**: [CVE-2021-30047-Andreyfreis_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyfreis_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，可能导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 目标主机运行vsftpd 3.0.3版本，并且允许建立新的TCP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-30047 漏洞存在于 VSFTPD 3.0.3 版本中，由于程序允许的连接数有限，攻击者可以通过创建大量连接来耗尽服务器资源，导致拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果都明确指出 VSFTPD 3.0.3 存在 DoS 漏洞，攻击者可以通过耗尽连接数来攻击。POC 代码 `cve-2021-30047.py` 的实现方式是创建多个线程，每个线程都尝试与目标 VSFTPD 服务器建立 FTP 连接，从而达到耗尽服务器连接资源的目的。

**投毒风险分析：**

对提供的 POC 代码 `cve-2021-30047.py` 进行分析，代码的主要功能是建立大量的 FTP 连接以造成拒绝服务。代码中包含以下几个关键部分：

*   `testar_conexao()`: 测试目标端口是否开放。
*   `ataque()`: 尝试使用 `ftp` 命令连接目标服务器。关键在于使用了 `subprocess.Popen` 创建子进程执行 `ftp` 命令，并将标准输出和标准错误重定向到 `/dev/null`，这意味着连接过程中的任何交互都被屏蔽了。
*   `iniciar_ataque_loop()`: 创建多个线程并发执行 `ataque()` 函数，从而发起 DoS 攻击。
*   `temporizador()`:  定时杀死由 `subprocess.Popen` 创建的 `ftp` 进程，防止攻击无限期执行。

代码中并没有发现明显的恶意代码，例如反弹 shell、文件上传或其他任何试图在目标系统上执行任意代码的行为。 子进程执行的命令是标准的 `ftp` 命令，虽然数量庞大，但本身并不会造成安全问题（除了 DoS 之外）。因此，该 POC 代码的投毒风险为 0%。

**利用方式：**

1.  **环境准备：** 确保目标主机运行着 VSFTPD 3.0.3 版本。
2.  **运行POC：** 使用 Python 运行提供的 POC 代码 `cve-2021-30047.py`，需要指定目标 IP 地址和端口号（默认为 21），以及要创建的最大连接数（默认为 50）。
3.  **观察效果：**  POC 运行后，会创建大量的 FTP 连接，导致 VSFTPD 服务器无法响应正常的连接请求，从而达到拒绝服务的目的。

**项目地址:** [Andreyfreis/CVE-2021-30047](https://github.com/Andreyfreis/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #3

**来源**: [CVE-2021-30047-Andreyft7_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyft7_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD Denial of Service

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 目标服务器运行着 VSFTPD 3.0.3 且允许建立新的 FTP 连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，漏洞 CVE-2021-30047 是 VSFTPD 3.0.3 版本中的一个拒绝服务漏洞。该漏洞是由于 VSFTPD 允许的连接数有限，攻击者可以通过建立大量并发连接耗尽服务器资源，从而导致拒绝服务。

**有效性评估：**
提供的 Python 脚本 `cve-2021-30047.py` 旨在通过创建大量 FTP 连接来利用此漏洞。脚本首先检查目标 FTP 服务器的端口是否开放，然后启动多个线程，每个线程尝试建立一个新的 FTP 连接。通过耗尽服务器的连接资源，可以实现拒绝服务。

**投毒风险分析：**
代码主要功能是创建大量socket连接，并使用subprocess启动ftp进程。脚本包含一个简单的定时器，在15分钟后杀死所有ftp进程。主要风险在于subprocess的使用，理论上可以通过修改ftp命令或者在ftp交互过程中发送恶意指令，达到控制服务器的目的。但是原作者并未这样做，只是简单地利用ftp命令建立连接。因此认为投毒风险较低，考虑到subprocess本身的安全风险，给出10%的投毒风险评估。

**利用方式分析：**
1.  **目标确定：** 确定运行 VSFTPD 3.0.3 的目标服务器和 FTP 端口 (默认为 21)。
2.  **连接测试：** 使用 `testar_conexao` 函数验证目标端口是否开放。
3.  **并发连接：** 使用 `iniciar_ataque_loop` 函数启动多个线程，每个线程通过 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 尝试建立 FTP 连接。`subprocess.Popen` 用于在后台运行 `ftp` 命令，无需交互，仅用于建立连接。
4.  **资源耗尽：** 大量并发连接最终会耗尽服务器资源，导致拒绝服务。
5.  **定时清理：** 使用 `temporizador` 函数在 15 分钟后自动终止所有 `ftp` 进程，以避免长时间占用资源。

总而言之，漏洞利用方式是通过脚本创建大量并发的FTP连接请求，消耗目标服务器的资源，实现拒绝服务攻击。代码中的定时器用于限制攻击持续时间。

**项目地址:** [Andreyft7/CVE-2021-30047](https://github.com/Andreyft7/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #4

**来源**: [CVE-2021-30047-Freitandrei_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrei_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD 3.0.3 DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 需要网络可达性，目标FTP服务运行在3.0.3版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 VSFTPD 3.0.3 版本中，由于允许的连接数有限，攻击者可以通过建立大量的 FTP 连接来耗尽服务器资源，从而导致拒绝服务。利用方式是通过编写脚本 (如提供的 Python 脚本) 快速建立大量到目标 FTP 服务器的连接。 

**有效性评估：**

提供的PoC代码看起来是有效的。它使用 Python 编写，利用 `subprocess.Popen` 来并发创建多个 FTP 连接。代码包含测试连接可用性的函数以及超时机制，可以有效防止攻击无限进行。

**投毒风险分析：**

PoC 代码本身执行的是 DoS 攻击，其目的是使目标服务器崩溃，而不是植入后门或执行恶意代码。 脚本的主要功能集中于建立和管理 FTP 连接，没有发现明显的恶意代码或后门。 然而，由于 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 使用了 `shell=True`，这存在一定的命令注入风险，尽管实际利用难度较高。攻击者如果能够控制 `alvo` 和 `porta` 变量，理论上可能执行任意命令。但这通常需要配合其他漏洞才能实现，因此将其判定为投毒的可能性较低，约为5%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行 VSFTPD 3.0.3 版本的 FTP 服务器。
2.  **运行 PoC：** 使用提供的 Python 脚本，指定目标服务器的 IP 地址和端口，以及最大连接数。
3.  **发起攻击：** 脚本会尝试建立指定数量的 FTP 连接，耗尽服务器资源。
4.  **结果：** 目标 FTP 服务器因为无法处理大量的连接请求而变得缓慢或崩溃，从而实现拒绝服务攻击。

**项目地址:** [Freitandrei/CVE-2021-30047](https://github.com/Freitandrei/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #5

**来源**: [CVE-2021-30047-Freitandrey_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrey_CVE-2021-30047.md)

# CVE-2021-30047

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md](../2021/CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-拒绝服务

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 需要网络访问目标FTP服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-30047 漏洞存在于 vsftpd 3.0.3 版本中。该漏洞允许攻击者通过创建大量连接来耗尽服务器资源，导致拒绝服务。漏洞利用方式是通过发送大量的FTP连接请求，超出服务器的最大连接限制，使得正常用户无法连接。提供的PoC 代码通过使用多线程，循环创建 `ftp` 进程连接目标服务器，模拟了连接洪水攻击。`temporizador` 函数保证攻击在 15 分钟后自动停止，并通过 `pkill ftp` 命令结束所有 `ftp` 进程。代码中调用了外部命令 `ftp` 和 `pkill`，如果系统缺少这些命令可能无法运行。投毒风险较低，主要风险在于过度使用该脚本可能对目标系统或网络造成实际损害。代码中定时结束进程的操作，有几率会结束其他用户的ftp连接，存在一定误伤概率。

**项目地址:** [AndreyFreitass/CVE-2021-30047](https://github.com/AndreyFreitass/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #2

**来源**: [CVE-2021-30047-Andreyfreis_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyfreis_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，可能导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 目标主机运行vsftpd 3.0.3版本，并且允许建立新的TCP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-30047 漏洞存在于 VSFTPD 3.0.3 版本中，由于程序允许的连接数有限，攻击者可以通过创建大量连接来耗尽服务器资源，导致拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果都明确指出 VSFTPD 3.0.3 存在 DoS 漏洞，攻击者可以通过耗尽连接数来攻击。POC 代码 `cve-2021-30047.py` 的实现方式是创建多个线程，每个线程都尝试与目标 VSFTPD 服务器建立 FTP 连接，从而达到耗尽服务器连接资源的目的。

**投毒风险分析：**

对提供的 POC 代码 `cve-2021-30047.py` 进行分析，代码的主要功能是建立大量的 FTP 连接以造成拒绝服务。代码中包含以下几个关键部分：

*   `testar_conexao()`: 测试目标端口是否开放。
*   `ataque()`: 尝试使用 `ftp` 命令连接目标服务器。关键在于使用了 `subprocess.Popen` 创建子进程执行 `ftp` 命令，并将标准输出和标准错误重定向到 `/dev/null`，这意味着连接过程中的任何交互都被屏蔽了。
*   `iniciar_ataque_loop()`: 创建多个线程并发执行 `ataque()` 函数，从而发起 DoS 攻击。
*   `temporizador()`:  定时杀死由 `subprocess.Popen` 创建的 `ftp` 进程，防止攻击无限期执行。

代码中并没有发现明显的恶意代码，例如反弹 shell、文件上传或其他任何试图在目标系统上执行任意代码的行为。 子进程执行的命令是标准的 `ftp` 命令，虽然数量庞大，但本身并不会造成安全问题（除了 DoS 之外）。因此，该 POC 代码的投毒风险为 0%。

**利用方式：**

1.  **环境准备：** 确保目标主机运行着 VSFTPD 3.0.3 版本。
2.  **运行POC：** 使用 Python 运行提供的 POC 代码 `cve-2021-30047.py`，需要指定目标 IP 地址和端口号（默认为 21），以及要创建的最大连接数（默认为 50）。
3.  **观察效果：**  POC 运行后，会创建大量的 FTP 连接，导致 VSFTPD 服务器无法响应正常的连接请求，从而达到拒绝服务的目的。

**项目地址:** [Andreyfreis/CVE-2021-30047](https://github.com/Andreyfreis/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #3

**来源**: [CVE-2021-30047-Andreyft7_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyft7_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD Denial of Service

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 目标服务器运行着 VSFTPD 3.0.3 且允许建立新的 FTP 连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，漏洞 CVE-2021-30047 是 VSFTPD 3.0.3 版本中的一个拒绝服务漏洞。该漏洞是由于 VSFTPD 允许的连接数有限，攻击者可以通过建立大量并发连接耗尽服务器资源，从而导致拒绝服务。

**有效性评估：**
提供的 Python 脚本 `cve-2021-30047.py` 旨在通过创建大量 FTP 连接来利用此漏洞。脚本首先检查目标 FTP 服务器的端口是否开放，然后启动多个线程，每个线程尝试建立一个新的 FTP 连接。通过耗尽服务器的连接资源，可以实现拒绝服务。

**投毒风险分析：**
代码主要功能是创建大量socket连接，并使用subprocess启动ftp进程。脚本包含一个简单的定时器，在15分钟后杀死所有ftp进程。主要风险在于subprocess的使用，理论上可以通过修改ftp命令或者在ftp交互过程中发送恶意指令，达到控制服务器的目的。但是原作者并未这样做，只是简单地利用ftp命令建立连接。因此认为投毒风险较低，考虑到subprocess本身的安全风险，给出10%的投毒风险评估。

**利用方式分析：**
1.  **目标确定：** 确定运行 VSFTPD 3.0.3 的目标服务器和 FTP 端口 (默认为 21)。
2.  **连接测试：** 使用 `testar_conexao` 函数验证目标端口是否开放。
3.  **并发连接：** 使用 `iniciar_ataque_loop` 函数启动多个线程，每个线程通过 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 尝试建立 FTP 连接。`subprocess.Popen` 用于在后台运行 `ftp` 命令，无需交互，仅用于建立连接。
4.  **资源耗尽：** 大量并发连接最终会耗尽服务器资源，导致拒绝服务。
5.  **定时清理：** 使用 `temporizador` 函数在 15 分钟后自动终止所有 `ftp` 进程，以避免长时间占用资源。

总而言之，漏洞利用方式是通过脚本创建大量并发的FTP连接请求，消耗目标服务器的资源，实现拒绝服务攻击。代码中的定时器用于限制攻击持续时间。

**项目地址:** [Andreyft7/CVE-2021-30047](https://github.com/Andreyft7/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #4

**来源**: [CVE-2021-30047-Freitandrei_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrei_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD 3.0.3 DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 需要网络可达性，目标FTP服务运行在3.0.3版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 VSFTPD 3.0.3 版本中，由于允许的连接数有限，攻击者可以通过建立大量的 FTP 连接来耗尽服务器资源，从而导致拒绝服务。利用方式是通过编写脚本 (如提供的 Python 脚本) 快速建立大量到目标 FTP 服务器的连接。 

**有效性评估：**

提供的PoC代码看起来是有效的。它使用 Python 编写，利用 `subprocess.Popen` 来并发创建多个 FTP 连接。代码包含测试连接可用性的函数以及超时机制，可以有效防止攻击无限进行。

**投毒风险分析：**

PoC 代码本身执行的是 DoS 攻击，其目的是使目标服务器崩溃，而不是植入后门或执行恶意代码。 脚本的主要功能集中于建立和管理 FTP 连接，没有发现明显的恶意代码或后门。 然而，由于 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 使用了 `shell=True`，这存在一定的命令注入风险，尽管实际利用难度较高。攻击者如果能够控制 `alvo` 和 `porta` 变量，理论上可能执行任意命令。但这通常需要配合其他漏洞才能实现，因此将其判定为投毒的可能性较低，约为5%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行 VSFTPD 3.0.3 版本的 FTP 服务器。
2.  **运行 PoC：** 使用提供的 Python 脚本，指定目标服务器的 IP 地址和端口，以及最大连接数。
3.  **发起攻击：** 脚本会尝试建立指定数量的 FTP 连接，耗尽服务器资源。
4.  **结果：** 目标 FTP 服务器因为无法处理大量的连接请求而变得缓慢或崩溃，从而实现拒绝服务攻击。

**项目地址:** [Freitandrei/CVE-2021-30047](https://github.com/Freitandrei/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #5

**来源**: [CVE-2021-30047-Freitandrey_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrey_CVE-2021-30047.md)

# CVE-2021-30047

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md](../2021/CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-拒绝服务

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 需要网络访问目标FTP服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-30047 漏洞存在于 vsftpd 3.0.3 版本中。该漏洞允许攻击者通过创建大量连接来耗尽服务器资源，导致拒绝服务。漏洞利用方式是通过发送大量的FTP连接请求，超出服务器的最大连接限制，使得正常用户无法连接。提供的PoC 代码通过使用多线程，循环创建 `ftp` 进程连接目标服务器，模拟了连接洪水攻击。`temporizador` 函数保证攻击在 15 分钟后自动停止，并通过 `pkill ftp` 命令结束所有 `ftp` 进程。代码中调用了外部命令 `ftp` 和 `pkill`，如果系统缺少这些命令可能无法运行。投毒风险较低，主要风险在于过度使用该脚本可能对目标系统或网络造成实际损害。代码中定时结束进程的操作，有几率会结束其他用户的ftp连接，存在一定误伤概率。

**项目地址:** [AndreyFreitass/CVE-2021-30047](https://github.com/AndreyFreitass/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #2

**来源**: [CVE-2021-30047-Andreyfreis_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyfreis_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，可能导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 目标主机运行vsftpd 3.0.3版本，并且允许建立新的TCP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-30047 漏洞存在于 VSFTPD 3.0.3 版本中，由于程序允许的连接数有限，攻击者可以通过创建大量连接来耗尽服务器资源，导致拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果都明确指出 VSFTPD 3.0.3 存在 DoS 漏洞，攻击者可以通过耗尽连接数来攻击。POC 代码 `cve-2021-30047.py` 的实现方式是创建多个线程，每个线程都尝试与目标 VSFTPD 服务器建立 FTP 连接，从而达到耗尽服务器连接资源的目的。

**投毒风险分析：**

对提供的 POC 代码 `cve-2021-30047.py` 进行分析，代码的主要功能是建立大量的 FTP 连接以造成拒绝服务。代码中包含以下几个关键部分：

*   `testar_conexao()`: 测试目标端口是否开放。
*   `ataque()`: 尝试使用 `ftp` 命令连接目标服务器。关键在于使用了 `subprocess.Popen` 创建子进程执行 `ftp` 命令，并将标准输出和标准错误重定向到 `/dev/null`，这意味着连接过程中的任何交互都被屏蔽了。
*   `iniciar_ataque_loop()`: 创建多个线程并发执行 `ataque()` 函数，从而发起 DoS 攻击。
*   `temporizador()`:  定时杀死由 `subprocess.Popen` 创建的 `ftp` 进程，防止攻击无限期执行。

代码中并没有发现明显的恶意代码，例如反弹 shell、文件上传或其他任何试图在目标系统上执行任意代码的行为。 子进程执行的命令是标准的 `ftp` 命令，虽然数量庞大，但本身并不会造成安全问题（除了 DoS 之外）。因此，该 POC 代码的投毒风险为 0%。

**利用方式：**

1.  **环境准备：** 确保目标主机运行着 VSFTPD 3.0.3 版本。
2.  **运行POC：** 使用 Python 运行提供的 POC 代码 `cve-2021-30047.py`，需要指定目标 IP 地址和端口号（默认为 21），以及要创建的最大连接数（默认为 50）。
3.  **观察效果：**  POC 运行后，会创建大量的 FTP 连接，导致 VSFTPD 服务器无法响应正常的连接请求，从而达到拒绝服务的目的。

**项目地址:** [Andreyfreis/CVE-2021-30047](https://github.com/Andreyfreis/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #3

**来源**: [CVE-2021-30047-Andreyft7_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyft7_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD Denial of Service

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 目标服务器运行着 VSFTPD 3.0.3 且允许建立新的 FTP 连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，漏洞 CVE-2021-30047 是 VSFTPD 3.0.3 版本中的一个拒绝服务漏洞。该漏洞是由于 VSFTPD 允许的连接数有限，攻击者可以通过建立大量并发连接耗尽服务器资源，从而导致拒绝服务。

**有效性评估：**
提供的 Python 脚本 `cve-2021-30047.py` 旨在通过创建大量 FTP 连接来利用此漏洞。脚本首先检查目标 FTP 服务器的端口是否开放，然后启动多个线程，每个线程尝试建立一个新的 FTP 连接。通过耗尽服务器的连接资源，可以实现拒绝服务。

**投毒风险分析：**
代码主要功能是创建大量socket连接，并使用subprocess启动ftp进程。脚本包含一个简单的定时器，在15分钟后杀死所有ftp进程。主要风险在于subprocess的使用，理论上可以通过修改ftp命令或者在ftp交互过程中发送恶意指令，达到控制服务器的目的。但是原作者并未这样做，只是简单地利用ftp命令建立连接。因此认为投毒风险较低，考虑到subprocess本身的安全风险，给出10%的投毒风险评估。

**利用方式分析：**
1.  **目标确定：** 确定运行 VSFTPD 3.0.3 的目标服务器和 FTP 端口 (默认为 21)。
2.  **连接测试：** 使用 `testar_conexao` 函数验证目标端口是否开放。
3.  **并发连接：** 使用 `iniciar_ataque_loop` 函数启动多个线程，每个线程通过 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 尝试建立 FTP 连接。`subprocess.Popen` 用于在后台运行 `ftp` 命令，无需交互，仅用于建立连接。
4.  **资源耗尽：** 大量并发连接最终会耗尽服务器资源，导致拒绝服务。
5.  **定时清理：** 使用 `temporizador` 函数在 15 分钟后自动终止所有 `ftp` 进程，以避免长时间占用资源。

总而言之，漏洞利用方式是通过脚本创建大量并发的FTP连接请求，消耗目标服务器的资源，实现拒绝服务攻击。代码中的定时器用于限制攻击持续时间。

**项目地址:** [Andreyft7/CVE-2021-30047](https://github.com/Andreyft7/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #4

**来源**: [CVE-2021-30047-Freitandrei_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrei_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD 3.0.3 DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 需要网络可达性，目标FTP服务运行在3.0.3版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 VSFTPD 3.0.3 版本中，由于允许的连接数有限，攻击者可以通过建立大量的 FTP 连接来耗尽服务器资源，从而导致拒绝服务。利用方式是通过编写脚本 (如提供的 Python 脚本) 快速建立大量到目标 FTP 服务器的连接。 

**有效性评估：**

提供的PoC代码看起来是有效的。它使用 Python 编写，利用 `subprocess.Popen` 来并发创建多个 FTP 连接。代码包含测试连接可用性的函数以及超时机制，可以有效防止攻击无限进行。

**投毒风险分析：**

PoC 代码本身执行的是 DoS 攻击，其目的是使目标服务器崩溃，而不是植入后门或执行恶意代码。 脚本的主要功能集中于建立和管理 FTP 连接，没有发现明显的恶意代码或后门。 然而，由于 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 使用了 `shell=True`，这存在一定的命令注入风险，尽管实际利用难度较高。攻击者如果能够控制 `alvo` 和 `porta` 变量，理论上可能执行任意命令。但这通常需要配合其他漏洞才能实现，因此将其判定为投毒的可能性较低，约为5%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行 VSFTPD 3.0.3 版本的 FTP 服务器。
2.  **运行 PoC：** 使用提供的 Python 脚本，指定目标服务器的 IP 地址和端口，以及最大连接数。
3.  **发起攻击：** 脚本会尝试建立指定数量的 FTP 连接，耗尽服务器资源。
4.  **结果：** 目标 FTP 服务器因为无法处理大量的连接请求而变得缓慢或崩溃，从而实现拒绝服务攻击。

**项目地址:** [Freitandrei/CVE-2021-30047](https://github.com/Freitandrei/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #5

**来源**: [CVE-2021-30047-Freitandrey_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrey_CVE-2021-30047.md)

# CVE-2021-30047

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md](../2021/CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-拒绝服务

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 需要网络访问目标FTP服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-30047 漏洞存在于 vsftpd 3.0.3 版本中。该漏洞允许攻击者通过创建大量连接来耗尽服务器资源，导致拒绝服务。漏洞利用方式是通过发送大量的FTP连接请求，超出服务器的最大连接限制，使得正常用户无法连接。提供的PoC 代码通过使用多线程，循环创建 `ftp` 进程连接目标服务器，模拟了连接洪水攻击。`temporizador` 函数保证攻击在 15 分钟后自动停止，并通过 `pkill ftp` 命令结束所有 `ftp` 进程。代码中调用了外部命令 `ftp` 和 `pkill`，如果系统缺少这些命令可能无法运行。投毒风险较低，主要风险在于过度使用该脚本可能对目标系统或网络造成实际损害。代码中定时结束进程的操作，有几率会结束其他用户的ftp连接，存在一定误伤概率。

**项目地址:** [AndreyFreitass/CVE-2021-30047](https://github.com/AndreyFreitass/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #2

**来源**: [CVE-2021-30047-Andreyfreis_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyfreis_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，可能导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 目标主机运行vsftpd 3.0.3版本，并且允许建立新的TCP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-30047 漏洞存在于 VSFTPD 3.0.3 版本中，由于程序允许的连接数有限，攻击者可以通过创建大量连接来耗尽服务器资源，导致拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果都明确指出 VSFTPD 3.0.3 存在 DoS 漏洞，攻击者可以通过耗尽连接数来攻击。POC 代码 `cve-2021-30047.py` 的实现方式是创建多个线程，每个线程都尝试与目标 VSFTPD 服务器建立 FTP 连接，从而达到耗尽服务器连接资源的目的。

**投毒风险分析：**

对提供的 POC 代码 `cve-2021-30047.py` 进行分析，代码的主要功能是建立大量的 FTP 连接以造成拒绝服务。代码中包含以下几个关键部分：

*   `testar_conexao()`: 测试目标端口是否开放。
*   `ataque()`: 尝试使用 `ftp` 命令连接目标服务器。关键在于使用了 `subprocess.Popen` 创建子进程执行 `ftp` 命令，并将标准输出和标准错误重定向到 `/dev/null`，这意味着连接过程中的任何交互都被屏蔽了。
*   `iniciar_ataque_loop()`: 创建多个线程并发执行 `ataque()` 函数，从而发起 DoS 攻击。
*   `temporizador()`:  定时杀死由 `subprocess.Popen` 创建的 `ftp` 进程，防止攻击无限期执行。

代码中并没有发现明显的恶意代码，例如反弹 shell、文件上传或其他任何试图在目标系统上执行任意代码的行为。 子进程执行的命令是标准的 `ftp` 命令，虽然数量庞大，但本身并不会造成安全问题（除了 DoS 之外）。因此，该 POC 代码的投毒风险为 0%。

**利用方式：**

1.  **环境准备：** 确保目标主机运行着 VSFTPD 3.0.3 版本。
2.  **运行POC：** 使用 Python 运行提供的 POC 代码 `cve-2021-30047.py`，需要指定目标 IP 地址和端口号（默认为 21），以及要创建的最大连接数（默认为 50）。
3.  **观察效果：**  POC 运行后，会创建大量的 FTP 连接，导致 VSFTPD 服务器无法响应正常的连接请求，从而达到拒绝服务的目的。

**项目地址:** [Andreyfreis/CVE-2021-30047](https://github.com/Andreyfreis/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #3

**来源**: [CVE-2021-30047-Andreyft7_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyft7_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD Denial of Service

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 目标服务器运行着 VSFTPD 3.0.3 且允许建立新的 FTP 连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，漏洞 CVE-2021-30047 是 VSFTPD 3.0.3 版本中的一个拒绝服务漏洞。该漏洞是由于 VSFTPD 允许的连接数有限，攻击者可以通过建立大量并发连接耗尽服务器资源，从而导致拒绝服务。

**有效性评估：**
提供的 Python 脚本 `cve-2021-30047.py` 旨在通过创建大量 FTP 连接来利用此漏洞。脚本首先检查目标 FTP 服务器的端口是否开放，然后启动多个线程，每个线程尝试建立一个新的 FTP 连接。通过耗尽服务器的连接资源，可以实现拒绝服务。

**投毒风险分析：**
代码主要功能是创建大量socket连接，并使用subprocess启动ftp进程。脚本包含一个简单的定时器，在15分钟后杀死所有ftp进程。主要风险在于subprocess的使用，理论上可以通过修改ftp命令或者在ftp交互过程中发送恶意指令，达到控制服务器的目的。但是原作者并未这样做，只是简单地利用ftp命令建立连接。因此认为投毒风险较低，考虑到subprocess本身的安全风险，给出10%的投毒风险评估。

**利用方式分析：**
1.  **目标确定：** 确定运行 VSFTPD 3.0.3 的目标服务器和 FTP 端口 (默认为 21)。
2.  **连接测试：** 使用 `testar_conexao` 函数验证目标端口是否开放。
3.  **并发连接：** 使用 `iniciar_ataque_loop` 函数启动多个线程，每个线程通过 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 尝试建立 FTP 连接。`subprocess.Popen` 用于在后台运行 `ftp` 命令，无需交互，仅用于建立连接。
4.  **资源耗尽：** 大量并发连接最终会耗尽服务器资源，导致拒绝服务。
5.  **定时清理：** 使用 `temporizador` 函数在 15 分钟后自动终止所有 `ftp` 进程，以避免长时间占用资源。

总而言之，漏洞利用方式是通过脚本创建大量并发的FTP连接请求，消耗目标服务器的资源，实现拒绝服务攻击。代码中的定时器用于限制攻击持续时间。

**项目地址:** [Andreyft7/CVE-2021-30047](https://github.com/Andreyft7/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #4

**来源**: [CVE-2021-30047-Freitandrei_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrei_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD 3.0.3 DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 需要网络可达性，目标FTP服务运行在3.0.3版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 VSFTPD 3.0.3 版本中，由于允许的连接数有限，攻击者可以通过建立大量的 FTP 连接来耗尽服务器资源，从而导致拒绝服务。利用方式是通过编写脚本 (如提供的 Python 脚本) 快速建立大量到目标 FTP 服务器的连接。 

**有效性评估：**

提供的PoC代码看起来是有效的。它使用 Python 编写，利用 `subprocess.Popen` 来并发创建多个 FTP 连接。代码包含测试连接可用性的函数以及超时机制，可以有效防止攻击无限进行。

**投毒风险分析：**

PoC 代码本身执行的是 DoS 攻击，其目的是使目标服务器崩溃，而不是植入后门或执行恶意代码。 脚本的主要功能集中于建立和管理 FTP 连接，没有发现明显的恶意代码或后门。 然而，由于 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 使用了 `shell=True`，这存在一定的命令注入风险，尽管实际利用难度较高。攻击者如果能够控制 `alvo` 和 `porta` 变量，理论上可能执行任意命令。但这通常需要配合其他漏洞才能实现，因此将其判定为投毒的可能性较低，约为5%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行 VSFTPD 3.0.3 版本的 FTP 服务器。
2.  **运行 PoC：** 使用提供的 Python 脚本，指定目标服务器的 IP 地址和端口，以及最大连接数。
3.  **发起攻击：** 脚本会尝试建立指定数量的 FTP 连接，耗尽服务器资源。
4.  **结果：** 目标 FTP 服务器因为无法处理大量的连接请求而变得缓慢或崩溃，从而实现拒绝服务攻击。

**项目地址:** [Freitandrei/CVE-2021-30047](https://github.com/Freitandrei/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #5

**来源**: [CVE-2021-30047-Freitandrey_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrey_CVE-2021-30047.md)

# CVE-2021-30047

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md](../2021/CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-拒绝服务

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 需要网络访问目标FTP服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-30047 漏洞存在于 vsftpd 3.0.3 版本中。该漏洞允许攻击者通过创建大量连接来耗尽服务器资源，导致拒绝服务。漏洞利用方式是通过发送大量的FTP连接请求，超出服务器的最大连接限制，使得正常用户无法连接。提供的PoC 代码通过使用多线程，循环创建 `ftp` 进程连接目标服务器，模拟了连接洪水攻击。`temporizador` 函数保证攻击在 15 分钟后自动停止，并通过 `pkill ftp` 命令结束所有 `ftp` 进程。代码中调用了外部命令 `ftp` 和 `pkill`，如果系统缺少这些命令可能无法运行。投毒风险较低，主要风险在于过度使用该脚本可能对目标系统或网络造成实际损害。代码中定时结束进程的操作，有几率会结束其他用户的ftp连接，存在一定误伤概率。

**项目地址:** [AndreyFreitass/CVE-2021-30047](https://github.com/AndreyFreitass/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #2

**来源**: [CVE-2021-30047-Andreyfreis_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyfreis_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，可能导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 目标主机运行vsftpd 3.0.3版本，并且允许建立新的TCP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-30047 漏洞存在于 VSFTPD 3.0.3 版本中，由于程序允许的连接数有限，攻击者可以通过创建大量连接来耗尽服务器资源，导致拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果都明确指出 VSFTPD 3.0.3 存在 DoS 漏洞，攻击者可以通过耗尽连接数来攻击。POC 代码 `cve-2021-30047.py` 的实现方式是创建多个线程，每个线程都尝试与目标 VSFTPD 服务器建立 FTP 连接，从而达到耗尽服务器连接资源的目的。

**投毒风险分析：**

对提供的 POC 代码 `cve-2021-30047.py` 进行分析，代码的主要功能是建立大量的 FTP 连接以造成拒绝服务。代码中包含以下几个关键部分：

*   `testar_conexao()`: 测试目标端口是否开放。
*   `ataque()`: 尝试使用 `ftp` 命令连接目标服务器。关键在于使用了 `subprocess.Popen` 创建子进程执行 `ftp` 命令，并将标准输出和标准错误重定向到 `/dev/null`，这意味着连接过程中的任何交互都被屏蔽了。
*   `iniciar_ataque_loop()`: 创建多个线程并发执行 `ataque()` 函数，从而发起 DoS 攻击。
*   `temporizador()`:  定时杀死由 `subprocess.Popen` 创建的 `ftp` 进程，防止攻击无限期执行。

代码中并没有发现明显的恶意代码，例如反弹 shell、文件上传或其他任何试图在目标系统上执行任意代码的行为。 子进程执行的命令是标准的 `ftp` 命令，虽然数量庞大，但本身并不会造成安全问题（除了 DoS 之外）。因此，该 POC 代码的投毒风险为 0%。

**利用方式：**

1.  **环境准备：** 确保目标主机运行着 VSFTPD 3.0.3 版本。
2.  **运行POC：** 使用 Python 运行提供的 POC 代码 `cve-2021-30047.py`，需要指定目标 IP 地址和端口号（默认为 21），以及要创建的最大连接数（默认为 50）。
3.  **观察效果：**  POC 运行后，会创建大量的 FTP 连接，导致 VSFTPD 服务器无法响应正常的连接请求，从而达到拒绝服务的目的。

**项目地址:** [Andreyfreis/CVE-2021-30047](https://github.com/Andreyfreis/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #3

**来源**: [CVE-2021-30047-Andreyft7_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyft7_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD Denial of Service

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 目标服务器运行着 VSFTPD 3.0.3 且允许建立新的 FTP 连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，漏洞 CVE-2021-30047 是 VSFTPD 3.0.3 版本中的一个拒绝服务漏洞。该漏洞是由于 VSFTPD 允许的连接数有限，攻击者可以通过建立大量并发连接耗尽服务器资源，从而导致拒绝服务。

**有效性评估：**
提供的 Python 脚本 `cve-2021-30047.py` 旨在通过创建大量 FTP 连接来利用此漏洞。脚本首先检查目标 FTP 服务器的端口是否开放，然后启动多个线程，每个线程尝试建立一个新的 FTP 连接。通过耗尽服务器的连接资源，可以实现拒绝服务。

**投毒风险分析：**
代码主要功能是创建大量socket连接，并使用subprocess启动ftp进程。脚本包含一个简单的定时器，在15分钟后杀死所有ftp进程。主要风险在于subprocess的使用，理论上可以通过修改ftp命令或者在ftp交互过程中发送恶意指令，达到控制服务器的目的。但是原作者并未这样做，只是简单地利用ftp命令建立连接。因此认为投毒风险较低，考虑到subprocess本身的安全风险，给出10%的投毒风险评估。

**利用方式分析：**
1.  **目标确定：** 确定运行 VSFTPD 3.0.3 的目标服务器和 FTP 端口 (默认为 21)。
2.  **连接测试：** 使用 `testar_conexao` 函数验证目标端口是否开放。
3.  **并发连接：** 使用 `iniciar_ataque_loop` 函数启动多个线程，每个线程通过 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 尝试建立 FTP 连接。`subprocess.Popen` 用于在后台运行 `ftp` 命令，无需交互，仅用于建立连接。
4.  **资源耗尽：** 大量并发连接最终会耗尽服务器资源，导致拒绝服务。
5.  **定时清理：** 使用 `temporizador` 函数在 15 分钟后自动终止所有 `ftp` 进程，以避免长时间占用资源。

总而言之，漏洞利用方式是通过脚本创建大量并发的FTP连接请求，消耗目标服务器的资源，实现拒绝服务攻击。代码中的定时器用于限制攻击持续时间。

**项目地址:** [Andreyft7/CVE-2021-30047](https://github.com/Andreyft7/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #4

**来源**: [CVE-2021-30047-Freitandrei_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrei_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD 3.0.3 DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 需要网络可达性，目标FTP服务运行在3.0.3版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 VSFTPD 3.0.3 版本中，由于允许的连接数有限，攻击者可以通过建立大量的 FTP 连接来耗尽服务器资源，从而导致拒绝服务。利用方式是通过编写脚本 (如提供的 Python 脚本) 快速建立大量到目标 FTP 服务器的连接。 

**有效性评估：**

提供的PoC代码看起来是有效的。它使用 Python 编写，利用 `subprocess.Popen` 来并发创建多个 FTP 连接。代码包含测试连接可用性的函数以及超时机制，可以有效防止攻击无限进行。

**投毒风险分析：**

PoC 代码本身执行的是 DoS 攻击，其目的是使目标服务器崩溃，而不是植入后门或执行恶意代码。 脚本的主要功能集中于建立和管理 FTP 连接，没有发现明显的恶意代码或后门。 然而，由于 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 使用了 `shell=True`，这存在一定的命令注入风险，尽管实际利用难度较高。攻击者如果能够控制 `alvo` 和 `porta` 变量，理论上可能执行任意命令。但这通常需要配合其他漏洞才能实现，因此将其判定为投毒的可能性较低，约为5%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行 VSFTPD 3.0.3 版本的 FTP 服务器。
2.  **运行 PoC：** 使用提供的 Python 脚本，指定目标服务器的 IP 地址和端口，以及最大连接数。
3.  **发起攻击：** 脚本会尝试建立指定数量的 FTP 连接，耗尽服务器资源。
4.  **结果：** 目标 FTP 服务器因为无法处理大量的连接请求而变得缓慢或崩溃，从而实现拒绝服务攻击。

**项目地址:** [Freitandrei/CVE-2021-30047](https://github.com/Freitandrei/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #5

**来源**: [CVE-2021-30047-Freitandrey_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrey_CVE-2021-30047.md)

# CVE-2021-30047

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md](../2021/CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-拒绝服务

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 需要网络访问目标FTP服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-30047 漏洞存在于 vsftpd 3.0.3 版本中。该漏洞允许攻击者通过创建大量连接来耗尽服务器资源，导致拒绝服务。漏洞利用方式是通过发送大量的FTP连接请求，超出服务器的最大连接限制，使得正常用户无法连接。提供的PoC 代码通过使用多线程，循环创建 `ftp` 进程连接目标服务器，模拟了连接洪水攻击。`temporizador` 函数保证攻击在 15 分钟后自动停止，并通过 `pkill ftp` 命令结束所有 `ftp` 进程。代码中调用了外部命令 `ftp` 和 `pkill`，如果系统缺少这些命令可能无法运行。投毒风险较低，主要风险在于过度使用该脚本可能对目标系统或网络造成实际损害。代码中定时结束进程的操作，有几率会结束其他用户的ftp连接，存在一定误伤概率。

**项目地址:** [AndreyFreitass/CVE-2021-30047](https://github.com/AndreyFreitass/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #2

**来源**: [CVE-2021-30047-Andreyfreis_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyfreis_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，可能导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 目标主机运行vsftpd 3.0.3版本，并且允许建立新的TCP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-30047 漏洞存在于 VSFTPD 3.0.3 版本中，由于程序允许的连接数有限，攻击者可以通过创建大量连接来耗尽服务器资源，导致拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果都明确指出 VSFTPD 3.0.3 存在 DoS 漏洞，攻击者可以通过耗尽连接数来攻击。POC 代码 `cve-2021-30047.py` 的实现方式是创建多个线程，每个线程都尝试与目标 VSFTPD 服务器建立 FTP 连接，从而达到耗尽服务器连接资源的目的。

**投毒风险分析：**

对提供的 POC 代码 `cve-2021-30047.py` 进行分析，代码的主要功能是建立大量的 FTP 连接以造成拒绝服务。代码中包含以下几个关键部分：

*   `testar_conexao()`: 测试目标端口是否开放。
*   `ataque()`: 尝试使用 `ftp` 命令连接目标服务器。关键在于使用了 `subprocess.Popen` 创建子进程执行 `ftp` 命令，并将标准输出和标准错误重定向到 `/dev/null`，这意味着连接过程中的任何交互都被屏蔽了。
*   `iniciar_ataque_loop()`: 创建多个线程并发执行 `ataque()` 函数，从而发起 DoS 攻击。
*   `temporizador()`:  定时杀死由 `subprocess.Popen` 创建的 `ftp` 进程，防止攻击无限期执行。

代码中并没有发现明显的恶意代码，例如反弹 shell、文件上传或其他任何试图在目标系统上执行任意代码的行为。 子进程执行的命令是标准的 `ftp` 命令，虽然数量庞大，但本身并不会造成安全问题（除了 DoS 之外）。因此，该 POC 代码的投毒风险为 0%。

**利用方式：**

1.  **环境准备：** 确保目标主机运行着 VSFTPD 3.0.3 版本。
2.  **运行POC：** 使用 Python 运行提供的 POC 代码 `cve-2021-30047.py`，需要指定目标 IP 地址和端口号（默认为 21），以及要创建的最大连接数（默认为 50）。
3.  **观察效果：**  POC 运行后，会创建大量的 FTP 连接，导致 VSFTPD 服务器无法响应正常的连接请求，从而达到拒绝服务的目的。

**项目地址:** [Andreyfreis/CVE-2021-30047](https://github.com/Andreyfreis/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #3

**来源**: [CVE-2021-30047-Andreyft7_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyft7_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD Denial of Service

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 目标服务器运行着 VSFTPD 3.0.3 且允许建立新的 FTP 连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，漏洞 CVE-2021-30047 是 VSFTPD 3.0.3 版本中的一个拒绝服务漏洞。该漏洞是由于 VSFTPD 允许的连接数有限，攻击者可以通过建立大量并发连接耗尽服务器资源，从而导致拒绝服务。

**有效性评估：**
提供的 Python 脚本 `cve-2021-30047.py` 旨在通过创建大量 FTP 连接来利用此漏洞。脚本首先检查目标 FTP 服务器的端口是否开放，然后启动多个线程，每个线程尝试建立一个新的 FTP 连接。通过耗尽服务器的连接资源，可以实现拒绝服务。

**投毒风险分析：**
代码主要功能是创建大量socket连接，并使用subprocess启动ftp进程。脚本包含一个简单的定时器，在15分钟后杀死所有ftp进程。主要风险在于subprocess的使用，理论上可以通过修改ftp命令或者在ftp交互过程中发送恶意指令，达到控制服务器的目的。但是原作者并未这样做，只是简单地利用ftp命令建立连接。因此认为投毒风险较低，考虑到subprocess本身的安全风险，给出10%的投毒风险评估。

**利用方式分析：**
1.  **目标确定：** 确定运行 VSFTPD 3.0.3 的目标服务器和 FTP 端口 (默认为 21)。
2.  **连接测试：** 使用 `testar_conexao` 函数验证目标端口是否开放。
3.  **并发连接：** 使用 `iniciar_ataque_loop` 函数启动多个线程，每个线程通过 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 尝试建立 FTP 连接。`subprocess.Popen` 用于在后台运行 `ftp` 命令，无需交互，仅用于建立连接。
4.  **资源耗尽：** 大量并发连接最终会耗尽服务器资源，导致拒绝服务。
5.  **定时清理：** 使用 `temporizador` 函数在 15 分钟后自动终止所有 `ftp` 进程，以避免长时间占用资源。

总而言之，漏洞利用方式是通过脚本创建大量并发的FTP连接请求，消耗目标服务器的资源，实现拒绝服务攻击。代码中的定时器用于限制攻击持续时间。

**项目地址:** [Andreyft7/CVE-2021-30047](https://github.com/Andreyft7/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #4

**来源**: [CVE-2021-30047-Freitandrei_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrei_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD 3.0.3 DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 需要网络可达性，目标FTP服务运行在3.0.3版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 VSFTPD 3.0.3 版本中，由于允许的连接数有限，攻击者可以通过建立大量的 FTP 连接来耗尽服务器资源，从而导致拒绝服务。利用方式是通过编写脚本 (如提供的 Python 脚本) 快速建立大量到目标 FTP 服务器的连接。 

**有效性评估：**

提供的PoC代码看起来是有效的。它使用 Python 编写，利用 `subprocess.Popen` 来并发创建多个 FTP 连接。代码包含测试连接可用性的函数以及超时机制，可以有效防止攻击无限进行。

**投毒风险分析：**

PoC 代码本身执行的是 DoS 攻击，其目的是使目标服务器崩溃，而不是植入后门或执行恶意代码。 脚本的主要功能集中于建立和管理 FTP 连接，没有发现明显的恶意代码或后门。 然而，由于 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 使用了 `shell=True`，这存在一定的命令注入风险，尽管实际利用难度较高。攻击者如果能够控制 `alvo` 和 `porta` 变量，理论上可能执行任意命令。但这通常需要配合其他漏洞才能实现，因此将其判定为投毒的可能性较低，约为5%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行 VSFTPD 3.0.3 版本的 FTP 服务器。
2.  **运行 PoC：** 使用提供的 Python 脚本，指定目标服务器的 IP 地址和端口，以及最大连接数。
3.  **发起攻击：** 脚本会尝试建立指定数量的 FTP 连接，耗尽服务器资源。
4.  **结果：** 目标 FTP 服务器因为无法处理大量的连接请求而变得缓慢或崩溃，从而实现拒绝服务攻击。

**项目地址:** [Freitandrei/CVE-2021-30047](https://github.com/Freitandrei/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #5

**来源**: [CVE-2021-30047-Freitandrey_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrey_CVE-2021-30047.md)

# CVE-2021-30047

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md](../2021/CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-拒绝服务

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 需要网络访问目标FTP服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-30047 漏洞存在于 vsftpd 3.0.3 版本中。该漏洞允许攻击者通过创建大量连接来耗尽服务器资源，导致拒绝服务。漏洞利用方式是通过发送大量的FTP连接请求，超出服务器的最大连接限制，使得正常用户无法连接。提供的PoC 代码通过使用多线程，循环创建 `ftp` 进程连接目标服务器，模拟了连接洪水攻击。`temporizador` 函数保证攻击在 15 分钟后自动停止，并通过 `pkill ftp` 命令结束所有 `ftp` 进程。代码中调用了外部命令 `ftp` 和 `pkill`，如果系统缺少这些命令可能无法运行。投毒风险较低，主要风险在于过度使用该脚本可能对目标系统或网络造成实际损害。代码中定时结束进程的操作，有几率会结束其他用户的ftp连接，存在一定误伤概率。

**项目地址:** [AndreyFreitass/CVE-2021-30047](https://github.com/AndreyFreitass/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #2

**来源**: [CVE-2021-30047-Andreyfreis_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyfreis_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，可能导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 目标主机运行vsftpd 3.0.3版本，并且允许建立新的TCP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-30047 漏洞存在于 VSFTPD 3.0.3 版本中，由于程序允许的连接数有限，攻击者可以通过创建大量连接来耗尽服务器资源，导致拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果都明确指出 VSFTPD 3.0.3 存在 DoS 漏洞，攻击者可以通过耗尽连接数来攻击。POC 代码 `cve-2021-30047.py` 的实现方式是创建多个线程，每个线程都尝试与目标 VSFTPD 服务器建立 FTP 连接，从而达到耗尽服务器连接资源的目的。

**投毒风险分析：**

对提供的 POC 代码 `cve-2021-30047.py` 进行分析，代码的主要功能是建立大量的 FTP 连接以造成拒绝服务。代码中包含以下几个关键部分：

*   `testar_conexao()`: 测试目标端口是否开放。
*   `ataque()`: 尝试使用 `ftp` 命令连接目标服务器。关键在于使用了 `subprocess.Popen` 创建子进程执行 `ftp` 命令，并将标准输出和标准错误重定向到 `/dev/null`，这意味着连接过程中的任何交互都被屏蔽了。
*   `iniciar_ataque_loop()`: 创建多个线程并发执行 `ataque()` 函数，从而发起 DoS 攻击。
*   `temporizador()`:  定时杀死由 `subprocess.Popen` 创建的 `ftp` 进程，防止攻击无限期执行。

代码中并没有发现明显的恶意代码，例如反弹 shell、文件上传或其他任何试图在目标系统上执行任意代码的行为。 子进程执行的命令是标准的 `ftp` 命令，虽然数量庞大，但本身并不会造成安全问题（除了 DoS 之外）。因此，该 POC 代码的投毒风险为 0%。

**利用方式：**

1.  **环境准备：** 确保目标主机运行着 VSFTPD 3.0.3 版本。
2.  **运行POC：** 使用 Python 运行提供的 POC 代码 `cve-2021-30047.py`，需要指定目标 IP 地址和端口号（默认为 21），以及要创建的最大连接数（默认为 50）。
3.  **观察效果：**  POC 运行后，会创建大量的 FTP 连接，导致 VSFTPD 服务器无法响应正常的连接请求，从而达到拒绝服务的目的。

**项目地址:** [Andreyfreis/CVE-2021-30047](https://github.com/Andreyfreis/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #3

**来源**: [CVE-2021-30047-Andreyft7_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyft7_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD Denial of Service

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 目标服务器运行着 VSFTPD 3.0.3 且允许建立新的 FTP 连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，漏洞 CVE-2021-30047 是 VSFTPD 3.0.3 版本中的一个拒绝服务漏洞。该漏洞是由于 VSFTPD 允许的连接数有限，攻击者可以通过建立大量并发连接耗尽服务器资源，从而导致拒绝服务。

**有效性评估：**
提供的 Python 脚本 `cve-2021-30047.py` 旨在通过创建大量 FTP 连接来利用此漏洞。脚本首先检查目标 FTP 服务器的端口是否开放，然后启动多个线程，每个线程尝试建立一个新的 FTP 连接。通过耗尽服务器的连接资源，可以实现拒绝服务。

**投毒风险分析：**
代码主要功能是创建大量socket连接，并使用subprocess启动ftp进程。脚本包含一个简单的定时器，在15分钟后杀死所有ftp进程。主要风险在于subprocess的使用，理论上可以通过修改ftp命令或者在ftp交互过程中发送恶意指令，达到控制服务器的目的。但是原作者并未这样做，只是简单地利用ftp命令建立连接。因此认为投毒风险较低，考虑到subprocess本身的安全风险，给出10%的投毒风险评估。

**利用方式分析：**
1.  **目标确定：** 确定运行 VSFTPD 3.0.3 的目标服务器和 FTP 端口 (默认为 21)。
2.  **连接测试：** 使用 `testar_conexao` 函数验证目标端口是否开放。
3.  **并发连接：** 使用 `iniciar_ataque_loop` 函数启动多个线程，每个线程通过 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 尝试建立 FTP 连接。`subprocess.Popen` 用于在后台运行 `ftp` 命令，无需交互，仅用于建立连接。
4.  **资源耗尽：** 大量并发连接最终会耗尽服务器资源，导致拒绝服务。
5.  **定时清理：** 使用 `temporizador` 函数在 15 分钟后自动终止所有 `ftp` 进程，以避免长时间占用资源。

总而言之，漏洞利用方式是通过脚本创建大量并发的FTP连接请求，消耗目标服务器的资源，实现拒绝服务攻击。代码中的定时器用于限制攻击持续时间。

**项目地址:** [Andreyft7/CVE-2021-30047](https://github.com/Andreyft7/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #4

**来源**: [CVE-2021-30047-Freitandrei_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrei_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD 3.0.3 DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 需要网络可达性，目标FTP服务运行在3.0.3版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 VSFTPD 3.0.3 版本中，由于允许的连接数有限，攻击者可以通过建立大量的 FTP 连接来耗尽服务器资源，从而导致拒绝服务。利用方式是通过编写脚本 (如提供的 Python 脚本) 快速建立大量到目标 FTP 服务器的连接。 

**有效性评估：**

提供的PoC代码看起来是有效的。它使用 Python 编写，利用 `subprocess.Popen` 来并发创建多个 FTP 连接。代码包含测试连接可用性的函数以及超时机制，可以有效防止攻击无限进行。

**投毒风险分析：**

PoC 代码本身执行的是 DoS 攻击，其目的是使目标服务器崩溃，而不是植入后门或执行恶意代码。 脚本的主要功能集中于建立和管理 FTP 连接，没有发现明显的恶意代码或后门。 然而，由于 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 使用了 `shell=True`，这存在一定的命令注入风险，尽管实际利用难度较高。攻击者如果能够控制 `alvo` 和 `porta` 变量，理论上可能执行任意命令。但这通常需要配合其他漏洞才能实现，因此将其判定为投毒的可能性较低，约为5%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行 VSFTPD 3.0.3 版本的 FTP 服务器。
2.  **运行 PoC：** 使用提供的 Python 脚本，指定目标服务器的 IP 地址和端口，以及最大连接数。
3.  **发起攻击：** 脚本会尝试建立指定数量的 FTP 连接，耗尽服务器资源。
4.  **结果：** 目标 FTP 服务器因为无法处理大量的连接请求而变得缓慢或崩溃，从而实现拒绝服务攻击。

**项目地址:** [Freitandrei/CVE-2021-30047](https://github.com/Freitandrei/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #5

**来源**: [CVE-2021-30047-Freitandrey_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrey_CVE-2021-30047.md)

# CVE-2021-30047

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md](../2021/CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-拒绝服务

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 需要网络访问目标FTP服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-30047 漏洞存在于 vsftpd 3.0.3 版本中。该漏洞允许攻击者通过创建大量连接来耗尽服务器资源，导致拒绝服务。漏洞利用方式是通过发送大量的FTP连接请求，超出服务器的最大连接限制，使得正常用户无法连接。提供的PoC 代码通过使用多线程，循环创建 `ftp` 进程连接目标服务器，模拟了连接洪水攻击。`temporizador` 函数保证攻击在 15 分钟后自动停止，并通过 `pkill ftp` 命令结束所有 `ftp` 进程。代码中调用了外部命令 `ftp` 和 `pkill`，如果系统缺少这些命令可能无法运行。投毒风险较低，主要风险在于过度使用该脚本可能对目标系统或网络造成实际损害。代码中定时结束进程的操作，有几率会结束其他用户的ftp连接，存在一定误伤概率。

**项目地址:** [AndreyFreitass/CVE-2021-30047](https://github.com/AndreyFreitass/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #2

**来源**: [CVE-2021-30047-Andreyfreis_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyfreis_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，可能导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 目标主机运行vsftpd 3.0.3版本，并且允许建立新的TCP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-30047 漏洞存在于 VSFTPD 3.0.3 版本中，由于程序允许的连接数有限，攻击者可以通过创建大量连接来耗尽服务器资源，导致拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果都明确指出 VSFTPD 3.0.3 存在 DoS 漏洞，攻击者可以通过耗尽连接数来攻击。POC 代码 `cve-2021-30047.py` 的实现方式是创建多个线程，每个线程都尝试与目标 VSFTPD 服务器建立 FTP 连接，从而达到耗尽服务器连接资源的目的。

**投毒风险分析：**

对提供的 POC 代码 `cve-2021-30047.py` 进行分析，代码的主要功能是建立大量的 FTP 连接以造成拒绝服务。代码中包含以下几个关键部分：

*   `testar_conexao()`: 测试目标端口是否开放。
*   `ataque()`: 尝试使用 `ftp` 命令连接目标服务器。关键在于使用了 `subprocess.Popen` 创建子进程执行 `ftp` 命令，并将标准输出和标准错误重定向到 `/dev/null`，这意味着连接过程中的任何交互都被屏蔽了。
*   `iniciar_ataque_loop()`: 创建多个线程并发执行 `ataque()` 函数，从而发起 DoS 攻击。
*   `temporizador()`:  定时杀死由 `subprocess.Popen` 创建的 `ftp` 进程，防止攻击无限期执行。

代码中并没有发现明显的恶意代码，例如反弹 shell、文件上传或其他任何试图在目标系统上执行任意代码的行为。 子进程执行的命令是标准的 `ftp` 命令，虽然数量庞大，但本身并不会造成安全问题（除了 DoS 之外）。因此，该 POC 代码的投毒风险为 0%。

**利用方式：**

1.  **环境准备：** 确保目标主机运行着 VSFTPD 3.0.3 版本。
2.  **运行POC：** 使用 Python 运行提供的 POC 代码 `cve-2021-30047.py`，需要指定目标 IP 地址和端口号（默认为 21），以及要创建的最大连接数（默认为 50）。
3.  **观察效果：**  POC 运行后，会创建大量的 FTP 连接，导致 VSFTPD 服务器无法响应正常的连接请求，从而达到拒绝服务的目的。

**项目地址:** [Andreyfreis/CVE-2021-30047](https://github.com/Andreyfreis/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #3

**来源**: [CVE-2021-30047-Andreyft7_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyft7_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD Denial of Service

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 目标服务器运行着 VSFTPD 3.0.3 且允许建立新的 FTP 连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，漏洞 CVE-2021-30047 是 VSFTPD 3.0.3 版本中的一个拒绝服务漏洞。该漏洞是由于 VSFTPD 允许的连接数有限，攻击者可以通过建立大量并发连接耗尽服务器资源，从而导致拒绝服务。

**有效性评估：**
提供的 Python 脚本 `cve-2021-30047.py` 旨在通过创建大量 FTP 连接来利用此漏洞。脚本首先检查目标 FTP 服务器的端口是否开放，然后启动多个线程，每个线程尝试建立一个新的 FTP 连接。通过耗尽服务器的连接资源，可以实现拒绝服务。

**投毒风险分析：**
代码主要功能是创建大量socket连接，并使用subprocess启动ftp进程。脚本包含一个简单的定时器，在15分钟后杀死所有ftp进程。主要风险在于subprocess的使用，理论上可以通过修改ftp命令或者在ftp交互过程中发送恶意指令，达到控制服务器的目的。但是原作者并未这样做，只是简单地利用ftp命令建立连接。因此认为投毒风险较低，考虑到subprocess本身的安全风险，给出10%的投毒风险评估。

**利用方式分析：**
1.  **目标确定：** 确定运行 VSFTPD 3.0.3 的目标服务器和 FTP 端口 (默认为 21)。
2.  **连接测试：** 使用 `testar_conexao` 函数验证目标端口是否开放。
3.  **并发连接：** 使用 `iniciar_ataque_loop` 函数启动多个线程，每个线程通过 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 尝试建立 FTP 连接。`subprocess.Popen` 用于在后台运行 `ftp` 命令，无需交互，仅用于建立连接。
4.  **资源耗尽：** 大量并发连接最终会耗尽服务器资源，导致拒绝服务。
5.  **定时清理：** 使用 `temporizador` 函数在 15 分钟后自动终止所有 `ftp` 进程，以避免长时间占用资源。

总而言之，漏洞利用方式是通过脚本创建大量并发的FTP连接请求，消耗目标服务器的资源，实现拒绝服务攻击。代码中的定时器用于限制攻击持续时间。

**项目地址:** [Andreyft7/CVE-2021-30047](https://github.com/Andreyft7/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #4

**来源**: [CVE-2021-30047-Freitandrei_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrei_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD 3.0.3 DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 需要网络可达性，目标FTP服务运行在3.0.3版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 VSFTPD 3.0.3 版本中，由于允许的连接数有限，攻击者可以通过建立大量的 FTP 连接来耗尽服务器资源，从而导致拒绝服务。利用方式是通过编写脚本 (如提供的 Python 脚本) 快速建立大量到目标 FTP 服务器的连接。 

**有效性评估：**

提供的PoC代码看起来是有效的。它使用 Python 编写，利用 `subprocess.Popen` 来并发创建多个 FTP 连接。代码包含测试连接可用性的函数以及超时机制，可以有效防止攻击无限进行。

**投毒风险分析：**

PoC 代码本身执行的是 DoS 攻击，其目的是使目标服务器崩溃，而不是植入后门或执行恶意代码。 脚本的主要功能集中于建立和管理 FTP 连接，没有发现明显的恶意代码或后门。 然而，由于 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 使用了 `shell=True`，这存在一定的命令注入风险，尽管实际利用难度较高。攻击者如果能够控制 `alvo` 和 `porta` 变量，理论上可能执行任意命令。但这通常需要配合其他漏洞才能实现，因此将其判定为投毒的可能性较低，约为5%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行 VSFTPD 3.0.3 版本的 FTP 服务器。
2.  **运行 PoC：** 使用提供的 Python 脚本，指定目标服务器的 IP 地址和端口，以及最大连接数。
3.  **发起攻击：** 脚本会尝试建立指定数量的 FTP 连接，耗尽服务器资源。
4.  **结果：** 目标 FTP 服务器因为无法处理大量的连接请求而变得缓慢或崩溃，从而实现拒绝服务攻击。

**项目地址:** [Freitandrei/CVE-2021-30047](https://github.com/Freitandrei/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #5

**来源**: [CVE-2021-30047-Freitandrey_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrey_CVE-2021-30047.md)

# CVE-2021-30047

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md](../2021/CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-拒绝服务

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 需要网络访问目标FTP服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-30047 漏洞存在于 vsftpd 3.0.3 版本中。该漏洞允许攻击者通过创建大量连接来耗尽服务器资源，导致拒绝服务。漏洞利用方式是通过发送大量的FTP连接请求，超出服务器的最大连接限制，使得正常用户无法连接。提供的PoC 代码通过使用多线程，循环创建 `ftp` 进程连接目标服务器，模拟了连接洪水攻击。`temporizador` 函数保证攻击在 15 分钟后自动停止，并通过 `pkill ftp` 命令结束所有 `ftp` 进程。代码中调用了外部命令 `ftp` 和 `pkill`，如果系统缺少这些命令可能无法运行。投毒风险较低，主要风险在于过度使用该脚本可能对目标系统或网络造成实际损害。代码中定时结束进程的操作，有几率会结束其他用户的ftp连接，存在一定误伤概率。

**项目地址:** [AndreyFreitass/CVE-2021-30047](https://github.com/AndreyFreitass/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #2

**来源**: [CVE-2021-30047-Andreyfreis_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyfreis_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，可能导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 目标主机运行vsftpd 3.0.3版本，并且允许建立新的TCP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-30047 漏洞存在于 VSFTPD 3.0.3 版本中，由于程序允许的连接数有限，攻击者可以通过创建大量连接来耗尽服务器资源，导致拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果都明确指出 VSFTPD 3.0.3 存在 DoS 漏洞，攻击者可以通过耗尽连接数来攻击。POC 代码 `cve-2021-30047.py` 的实现方式是创建多个线程，每个线程都尝试与目标 VSFTPD 服务器建立 FTP 连接，从而达到耗尽服务器连接资源的目的。

**投毒风险分析：**

对提供的 POC 代码 `cve-2021-30047.py` 进行分析，代码的主要功能是建立大量的 FTP 连接以造成拒绝服务。代码中包含以下几个关键部分：

*   `testar_conexao()`: 测试目标端口是否开放。
*   `ataque()`: 尝试使用 `ftp` 命令连接目标服务器。关键在于使用了 `subprocess.Popen` 创建子进程执行 `ftp` 命令，并将标准输出和标准错误重定向到 `/dev/null`，这意味着连接过程中的任何交互都被屏蔽了。
*   `iniciar_ataque_loop()`: 创建多个线程并发执行 `ataque()` 函数，从而发起 DoS 攻击。
*   `temporizador()`:  定时杀死由 `subprocess.Popen` 创建的 `ftp` 进程，防止攻击无限期执行。

代码中并没有发现明显的恶意代码，例如反弹 shell、文件上传或其他任何试图在目标系统上执行任意代码的行为。 子进程执行的命令是标准的 `ftp` 命令，虽然数量庞大，但本身并不会造成安全问题（除了 DoS 之外）。因此，该 POC 代码的投毒风险为 0%。

**利用方式：**

1.  **环境准备：** 确保目标主机运行着 VSFTPD 3.0.3 版本。
2.  **运行POC：** 使用 Python 运行提供的 POC 代码 `cve-2021-30047.py`，需要指定目标 IP 地址和端口号（默认为 21），以及要创建的最大连接数（默认为 50）。
3.  **观察效果：**  POC 运行后，会创建大量的 FTP 连接，导致 VSFTPD 服务器无法响应正常的连接请求，从而达到拒绝服务的目的。

**项目地址:** [Andreyfreis/CVE-2021-30047](https://github.com/Andreyfreis/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #3

**来源**: [CVE-2021-30047-Andreyft7_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyft7_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD Denial of Service

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 目标服务器运行着 VSFTPD 3.0.3 且允许建立新的 FTP 连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，漏洞 CVE-2021-30047 是 VSFTPD 3.0.3 版本中的一个拒绝服务漏洞。该漏洞是由于 VSFTPD 允许的连接数有限，攻击者可以通过建立大量并发连接耗尽服务器资源，从而导致拒绝服务。

**有效性评估：**
提供的 Python 脚本 `cve-2021-30047.py` 旨在通过创建大量 FTP 连接来利用此漏洞。脚本首先检查目标 FTP 服务器的端口是否开放，然后启动多个线程，每个线程尝试建立一个新的 FTP 连接。通过耗尽服务器的连接资源，可以实现拒绝服务。

**投毒风险分析：**
代码主要功能是创建大量socket连接，并使用subprocess启动ftp进程。脚本包含一个简单的定时器，在15分钟后杀死所有ftp进程。主要风险在于subprocess的使用，理论上可以通过修改ftp命令或者在ftp交互过程中发送恶意指令，达到控制服务器的目的。但是原作者并未这样做，只是简单地利用ftp命令建立连接。因此认为投毒风险较低，考虑到subprocess本身的安全风险，给出10%的投毒风险评估。

**利用方式分析：**
1.  **目标确定：** 确定运行 VSFTPD 3.0.3 的目标服务器和 FTP 端口 (默认为 21)。
2.  **连接测试：** 使用 `testar_conexao` 函数验证目标端口是否开放。
3.  **并发连接：** 使用 `iniciar_ataque_loop` 函数启动多个线程，每个线程通过 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 尝试建立 FTP 连接。`subprocess.Popen` 用于在后台运行 `ftp` 命令，无需交互，仅用于建立连接。
4.  **资源耗尽：** 大量并发连接最终会耗尽服务器资源，导致拒绝服务。
5.  **定时清理：** 使用 `temporizador` 函数在 15 分钟后自动终止所有 `ftp` 进程，以避免长时间占用资源。

总而言之，漏洞利用方式是通过脚本创建大量并发的FTP连接请求，消耗目标服务器的资源，实现拒绝服务攻击。代码中的定时器用于限制攻击持续时间。

**项目地址:** [Andreyft7/CVE-2021-30047](https://github.com/Andreyft7/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #4

**来源**: [CVE-2021-30047-Freitandrei_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrei_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD 3.0.3 DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 需要网络可达性，目标FTP服务运行在3.0.3版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 VSFTPD 3.0.3 版本中，由于允许的连接数有限，攻击者可以通过建立大量的 FTP 连接来耗尽服务器资源，从而导致拒绝服务。利用方式是通过编写脚本 (如提供的 Python 脚本) 快速建立大量到目标 FTP 服务器的连接。 

**有效性评估：**

提供的PoC代码看起来是有效的。它使用 Python 编写，利用 `subprocess.Popen` 来并发创建多个 FTP 连接。代码包含测试连接可用性的函数以及超时机制，可以有效防止攻击无限进行。

**投毒风险分析：**

PoC 代码本身执行的是 DoS 攻击，其目的是使目标服务器崩溃，而不是植入后门或执行恶意代码。 脚本的主要功能集中于建立和管理 FTP 连接，没有发现明显的恶意代码或后门。 然而，由于 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 使用了 `shell=True`，这存在一定的命令注入风险，尽管实际利用难度较高。攻击者如果能够控制 `alvo` 和 `porta` 变量，理论上可能执行任意命令。但这通常需要配合其他漏洞才能实现，因此将其判定为投毒的可能性较低，约为5%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行 VSFTPD 3.0.3 版本的 FTP 服务器。
2.  **运行 PoC：** 使用提供的 Python 脚本，指定目标服务器的 IP 地址和端口，以及最大连接数。
3.  **发起攻击：** 脚本会尝试建立指定数量的 FTP 连接，耗尽服务器资源。
4.  **结果：** 目标 FTP 服务器因为无法处理大量的连接请求而变得缓慢或崩溃，从而实现拒绝服务攻击。

**项目地址:** [Freitandrei/CVE-2021-30047](https://github.com/Freitandrei/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #5

**来源**: [CVE-2021-30047-Freitandrey_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrey_CVE-2021-30047.md)

# CVE-2021-30047

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md](../2021/CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-拒绝服务

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 需要网络访问目标FTP服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-30047 漏洞存在于 vsftpd 3.0.3 版本中。该漏洞允许攻击者通过创建大量连接来耗尽服务器资源，导致拒绝服务。漏洞利用方式是通过发送大量的FTP连接请求，超出服务器的最大连接限制，使得正常用户无法连接。提供的PoC 代码通过使用多线程，循环创建 `ftp` 进程连接目标服务器，模拟了连接洪水攻击。`temporizador` 函数保证攻击在 15 分钟后自动停止，并通过 `pkill ftp` 命令结束所有 `ftp` 进程。代码中调用了外部命令 `ftp` 和 `pkill`，如果系统缺少这些命令可能无法运行。投毒风险较低，主要风险在于过度使用该脚本可能对目标系统或网络造成实际损害。代码中定时结束进程的操作，有几率会结束其他用户的ftp连接，存在一定误伤概率。

**项目地址:** [AndreyFreitass/CVE-2021-30047](https://github.com/AndreyFreitass/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #2

**来源**: [CVE-2021-30047-Andreyfreis_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyfreis_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，可能导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 目标主机运行vsftpd 3.0.3版本，并且允许建立新的TCP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-30047 漏洞存在于 VSFTPD 3.0.3 版本中，由于程序允许的连接数有限，攻击者可以通过创建大量连接来耗尽服务器资源，导致拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果都明确指出 VSFTPD 3.0.3 存在 DoS 漏洞，攻击者可以通过耗尽连接数来攻击。POC 代码 `cve-2021-30047.py` 的实现方式是创建多个线程，每个线程都尝试与目标 VSFTPD 服务器建立 FTP 连接，从而达到耗尽服务器连接资源的目的。

**投毒风险分析：**

对提供的 POC 代码 `cve-2021-30047.py` 进行分析，代码的主要功能是建立大量的 FTP 连接以造成拒绝服务。代码中包含以下几个关键部分：

*   `testar_conexao()`: 测试目标端口是否开放。
*   `ataque()`: 尝试使用 `ftp` 命令连接目标服务器。关键在于使用了 `subprocess.Popen` 创建子进程执行 `ftp` 命令，并将标准输出和标准错误重定向到 `/dev/null`，这意味着连接过程中的任何交互都被屏蔽了。
*   `iniciar_ataque_loop()`: 创建多个线程并发执行 `ataque()` 函数，从而发起 DoS 攻击。
*   `temporizador()`:  定时杀死由 `subprocess.Popen` 创建的 `ftp` 进程，防止攻击无限期执行。

代码中并没有发现明显的恶意代码，例如反弹 shell、文件上传或其他任何试图在目标系统上执行任意代码的行为。 子进程执行的命令是标准的 `ftp` 命令，虽然数量庞大，但本身并不会造成安全问题（除了 DoS 之外）。因此，该 POC 代码的投毒风险为 0%。

**利用方式：**

1.  **环境准备：** 确保目标主机运行着 VSFTPD 3.0.3 版本。
2.  **运行POC：** 使用 Python 运行提供的 POC 代码 `cve-2021-30047.py`，需要指定目标 IP 地址和端口号（默认为 21），以及要创建的最大连接数（默认为 50）。
3.  **观察效果：**  POC 运行后，会创建大量的 FTP 连接，导致 VSFTPD 服务器无法响应正常的连接请求，从而达到拒绝服务的目的。

**项目地址:** [Andreyfreis/CVE-2021-30047](https://github.com/Andreyfreis/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #3

**来源**: [CVE-2021-30047-Andreyft7_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyft7_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD Denial of Service

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 目标服务器运行着 VSFTPD 3.0.3 且允许建立新的 FTP 连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，漏洞 CVE-2021-30047 是 VSFTPD 3.0.3 版本中的一个拒绝服务漏洞。该漏洞是由于 VSFTPD 允许的连接数有限，攻击者可以通过建立大量并发连接耗尽服务器资源，从而导致拒绝服务。

**有效性评估：**
提供的 Python 脚本 `cve-2021-30047.py` 旨在通过创建大量 FTP 连接来利用此漏洞。脚本首先检查目标 FTP 服务器的端口是否开放，然后启动多个线程，每个线程尝试建立一个新的 FTP 连接。通过耗尽服务器的连接资源，可以实现拒绝服务。

**投毒风险分析：**
代码主要功能是创建大量socket连接，并使用subprocess启动ftp进程。脚本包含一个简单的定时器，在15分钟后杀死所有ftp进程。主要风险在于subprocess的使用，理论上可以通过修改ftp命令或者在ftp交互过程中发送恶意指令，达到控制服务器的目的。但是原作者并未这样做，只是简单地利用ftp命令建立连接。因此认为投毒风险较低，考虑到subprocess本身的安全风险，给出10%的投毒风险评估。

**利用方式分析：**
1.  **目标确定：** 确定运行 VSFTPD 3.0.3 的目标服务器和 FTP 端口 (默认为 21)。
2.  **连接测试：** 使用 `testar_conexao` 函数验证目标端口是否开放。
3.  **并发连接：** 使用 `iniciar_ataque_loop` 函数启动多个线程，每个线程通过 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 尝试建立 FTP 连接。`subprocess.Popen` 用于在后台运行 `ftp` 命令，无需交互，仅用于建立连接。
4.  **资源耗尽：** 大量并发连接最终会耗尽服务器资源，导致拒绝服务。
5.  **定时清理：** 使用 `temporizador` 函数在 15 分钟后自动终止所有 `ftp` 进程，以避免长时间占用资源。

总而言之，漏洞利用方式是通过脚本创建大量并发的FTP连接请求，消耗目标服务器的资源，实现拒绝服务攻击。代码中的定时器用于限制攻击持续时间。

**项目地址:** [Andreyft7/CVE-2021-30047](https://github.com/Andreyft7/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #4

**来源**: [CVE-2021-30047-Freitandrei_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrei_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD 3.0.3 DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 需要网络可达性，目标FTP服务运行在3.0.3版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 VSFTPD 3.0.3 版本中，由于允许的连接数有限，攻击者可以通过建立大量的 FTP 连接来耗尽服务器资源，从而导致拒绝服务。利用方式是通过编写脚本 (如提供的 Python 脚本) 快速建立大量到目标 FTP 服务器的连接。 

**有效性评估：**

提供的PoC代码看起来是有效的。它使用 Python 编写，利用 `subprocess.Popen` 来并发创建多个 FTP 连接。代码包含测试连接可用性的函数以及超时机制，可以有效防止攻击无限进行。

**投毒风险分析：**

PoC 代码本身执行的是 DoS 攻击，其目的是使目标服务器崩溃，而不是植入后门或执行恶意代码。 脚本的主要功能集中于建立和管理 FTP 连接，没有发现明显的恶意代码或后门。 然而，由于 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 使用了 `shell=True`，这存在一定的命令注入风险，尽管实际利用难度较高。攻击者如果能够控制 `alvo` 和 `porta` 变量，理论上可能执行任意命令。但这通常需要配合其他漏洞才能实现，因此将其判定为投毒的可能性较低，约为5%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行 VSFTPD 3.0.3 版本的 FTP 服务器。
2.  **运行 PoC：** 使用提供的 Python 脚本，指定目标服务器的 IP 地址和端口，以及最大连接数。
3.  **发起攻击：** 脚本会尝试建立指定数量的 FTP 连接，耗尽服务器资源。
4.  **结果：** 目标 FTP 服务器因为无法处理大量的连接请求而变得缓慢或崩溃，从而实现拒绝服务攻击。

**项目地址:** [Freitandrei/CVE-2021-30047](https://github.com/Freitandrei/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #5

**来源**: [CVE-2021-30047-Freitandrey_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrey_CVE-2021-30047.md)

# CVE-2021-30047

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md](../2021/CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-拒绝服务

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 需要网络访问目标FTP服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-30047 漏洞存在于 vsftpd 3.0.3 版本中。该漏洞允许攻击者通过创建大量连接来耗尽服务器资源，导致拒绝服务。漏洞利用方式是通过发送大量的FTP连接请求，超出服务器的最大连接限制，使得正常用户无法连接。提供的PoC 代码通过使用多线程，循环创建 `ftp` 进程连接目标服务器，模拟了连接洪水攻击。`temporizador` 函数保证攻击在 15 分钟后自动停止，并通过 `pkill ftp` 命令结束所有 `ftp` 进程。代码中调用了外部命令 `ftp` 和 `pkill`，如果系统缺少这些命令可能无法运行。投毒风险较低，主要风险在于过度使用该脚本可能对目标系统或网络造成实际损害。代码中定时结束进程的操作，有几率会结束其他用户的ftp连接，存在一定误伤概率。

**项目地址:** [AndreyFreitass/CVE-2021-30047](https://github.com/AndreyFreitass/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #2

**来源**: [CVE-2021-30047-Andreyfreis_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyfreis_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，可能导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 目标主机运行vsftpd 3.0.3版本，并且允许建立新的TCP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-30047 漏洞存在于 VSFTPD 3.0.3 版本中，由于程序允许的连接数有限，攻击者可以通过创建大量连接来耗尽服务器资源，导致拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果都明确指出 VSFTPD 3.0.3 存在 DoS 漏洞，攻击者可以通过耗尽连接数来攻击。POC 代码 `cve-2021-30047.py` 的实现方式是创建多个线程，每个线程都尝试与目标 VSFTPD 服务器建立 FTP 连接，从而达到耗尽服务器连接资源的目的。

**投毒风险分析：**

对提供的 POC 代码 `cve-2021-30047.py` 进行分析，代码的主要功能是建立大量的 FTP 连接以造成拒绝服务。代码中包含以下几个关键部分：

*   `testar_conexao()`: 测试目标端口是否开放。
*   `ataque()`: 尝试使用 `ftp` 命令连接目标服务器。关键在于使用了 `subprocess.Popen` 创建子进程执行 `ftp` 命令，并将标准输出和标准错误重定向到 `/dev/null`，这意味着连接过程中的任何交互都被屏蔽了。
*   `iniciar_ataque_loop()`: 创建多个线程并发执行 `ataque()` 函数，从而发起 DoS 攻击。
*   `temporizador()`:  定时杀死由 `subprocess.Popen` 创建的 `ftp` 进程，防止攻击无限期执行。

代码中并没有发现明显的恶意代码，例如反弹 shell、文件上传或其他任何试图在目标系统上执行任意代码的行为。 子进程执行的命令是标准的 `ftp` 命令，虽然数量庞大，但本身并不会造成安全问题（除了 DoS 之外）。因此，该 POC 代码的投毒风险为 0%。

**利用方式：**

1.  **环境准备：** 确保目标主机运行着 VSFTPD 3.0.3 版本。
2.  **运行POC：** 使用 Python 运行提供的 POC 代码 `cve-2021-30047.py`，需要指定目标 IP 地址和端口号（默认为 21），以及要创建的最大连接数（默认为 50）。
3.  **观察效果：**  POC 运行后，会创建大量的 FTP 连接，导致 VSFTPD 服务器无法响应正常的连接请求，从而达到拒绝服务的目的。

**项目地址:** [Andreyfreis/CVE-2021-30047](https://github.com/Andreyfreis/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #3

**来源**: [CVE-2021-30047-Andreyft7_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyft7_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD Denial of Service

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 目标服务器运行着 VSFTPD 3.0.3 且允许建立新的 FTP 连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，漏洞 CVE-2021-30047 是 VSFTPD 3.0.3 版本中的一个拒绝服务漏洞。该漏洞是由于 VSFTPD 允许的连接数有限，攻击者可以通过建立大量并发连接耗尽服务器资源，从而导致拒绝服务。

**有效性评估：**
提供的 Python 脚本 `cve-2021-30047.py` 旨在通过创建大量 FTP 连接来利用此漏洞。脚本首先检查目标 FTP 服务器的端口是否开放，然后启动多个线程，每个线程尝试建立一个新的 FTP 连接。通过耗尽服务器的连接资源，可以实现拒绝服务。

**投毒风险分析：**
代码主要功能是创建大量socket连接，并使用subprocess启动ftp进程。脚本包含一个简单的定时器，在15分钟后杀死所有ftp进程。主要风险在于subprocess的使用，理论上可以通过修改ftp命令或者在ftp交互过程中发送恶意指令，达到控制服务器的目的。但是原作者并未这样做，只是简单地利用ftp命令建立连接。因此认为投毒风险较低，考虑到subprocess本身的安全风险，给出10%的投毒风险评估。

**利用方式分析：**
1.  **目标确定：** 确定运行 VSFTPD 3.0.3 的目标服务器和 FTP 端口 (默认为 21)。
2.  **连接测试：** 使用 `testar_conexao` 函数验证目标端口是否开放。
3.  **并发连接：** 使用 `iniciar_ataque_loop` 函数启动多个线程，每个线程通过 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 尝试建立 FTP 连接。`subprocess.Popen` 用于在后台运行 `ftp` 命令，无需交互，仅用于建立连接。
4.  **资源耗尽：** 大量并发连接最终会耗尽服务器资源，导致拒绝服务。
5.  **定时清理：** 使用 `temporizador` 函数在 15 分钟后自动终止所有 `ftp` 进程，以避免长时间占用资源。

总而言之，漏洞利用方式是通过脚本创建大量并发的FTP连接请求，消耗目标服务器的资源，实现拒绝服务攻击。代码中的定时器用于限制攻击持续时间。

**项目地址:** [Andreyft7/CVE-2021-30047](https://github.com/Andreyft7/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #4

**来源**: [CVE-2021-30047-Freitandrei_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrei_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD 3.0.3 DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 需要网络可达性，目标FTP服务运行在3.0.3版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 VSFTPD 3.0.3 版本中，由于允许的连接数有限，攻击者可以通过建立大量的 FTP 连接来耗尽服务器资源，从而导致拒绝服务。利用方式是通过编写脚本 (如提供的 Python 脚本) 快速建立大量到目标 FTP 服务器的连接。 

**有效性评估：**

提供的PoC代码看起来是有效的。它使用 Python 编写，利用 `subprocess.Popen` 来并发创建多个 FTP 连接。代码包含测试连接可用性的函数以及超时机制，可以有效防止攻击无限进行。

**投毒风险分析：**

PoC 代码本身执行的是 DoS 攻击，其目的是使目标服务器崩溃，而不是植入后门或执行恶意代码。 脚本的主要功能集中于建立和管理 FTP 连接，没有发现明显的恶意代码或后门。 然而，由于 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 使用了 `shell=True`，这存在一定的命令注入风险，尽管实际利用难度较高。攻击者如果能够控制 `alvo` 和 `porta` 变量，理论上可能执行任意命令。但这通常需要配合其他漏洞才能实现，因此将其判定为投毒的可能性较低，约为5%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行 VSFTPD 3.0.3 版本的 FTP 服务器。
2.  **运行 PoC：** 使用提供的 Python 脚本，指定目标服务器的 IP 地址和端口，以及最大连接数。
3.  **发起攻击：** 脚本会尝试建立指定数量的 FTP 连接，耗尽服务器资源。
4.  **结果：** 目标 FTP 服务器因为无法处理大量的连接请求而变得缓慢或崩溃，从而实现拒绝服务攻击。

**项目地址:** [Freitandrei/CVE-2021-30047](https://github.com/Freitandrei/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #5

**来源**: [CVE-2021-30047-Freitandrey_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrey_CVE-2021-30047.md)

# CVE-2021-30047

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md](../2021/CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-拒绝服务

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 需要网络访问目标FTP服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-30047 漏洞存在于 vsftpd 3.0.3 版本中。该漏洞允许攻击者通过创建大量连接来耗尽服务器资源，导致拒绝服务。漏洞利用方式是通过发送大量的FTP连接请求，超出服务器的最大连接限制，使得正常用户无法连接。提供的PoC 代码通过使用多线程，循环创建 `ftp` 进程连接目标服务器，模拟了连接洪水攻击。`temporizador` 函数保证攻击在 15 分钟后自动停止，并通过 `pkill ftp` 命令结束所有 `ftp` 进程。代码中调用了外部命令 `ftp` 和 `pkill`，如果系统缺少这些命令可能无法运行。投毒风险较低，主要风险在于过度使用该脚本可能对目标系统或网络造成实际损害。代码中定时结束进程的操作，有几率会结束其他用户的ftp连接，存在一定误伤概率。

**项目地址:** [AndreyFreitass/CVE-2021-30047](https://github.com/AndreyFreitass/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #2

**来源**: [CVE-2021-30047-Andreyfreis_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyfreis_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，可能导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 目标主机运行vsftpd 3.0.3版本，并且允许建立新的TCP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-30047 漏洞存在于 VSFTPD 3.0.3 版本中，由于程序允许的连接数有限，攻击者可以通过创建大量连接来耗尽服务器资源，导致拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果都明确指出 VSFTPD 3.0.3 存在 DoS 漏洞，攻击者可以通过耗尽连接数来攻击。POC 代码 `cve-2021-30047.py` 的实现方式是创建多个线程，每个线程都尝试与目标 VSFTPD 服务器建立 FTP 连接，从而达到耗尽服务器连接资源的目的。

**投毒风险分析：**

对提供的 POC 代码 `cve-2021-30047.py` 进行分析，代码的主要功能是建立大量的 FTP 连接以造成拒绝服务。代码中包含以下几个关键部分：

*   `testar_conexao()`: 测试目标端口是否开放。
*   `ataque()`: 尝试使用 `ftp` 命令连接目标服务器。关键在于使用了 `subprocess.Popen` 创建子进程执行 `ftp` 命令，并将标准输出和标准错误重定向到 `/dev/null`，这意味着连接过程中的任何交互都被屏蔽了。
*   `iniciar_ataque_loop()`: 创建多个线程并发执行 `ataque()` 函数，从而发起 DoS 攻击。
*   `temporizador()`:  定时杀死由 `subprocess.Popen` 创建的 `ftp` 进程，防止攻击无限期执行。

代码中并没有发现明显的恶意代码，例如反弹 shell、文件上传或其他任何试图在目标系统上执行任意代码的行为。 子进程执行的命令是标准的 `ftp` 命令，虽然数量庞大，但本身并不会造成安全问题（除了 DoS 之外）。因此，该 POC 代码的投毒风险为 0%。

**利用方式：**

1.  **环境准备：** 确保目标主机运行着 VSFTPD 3.0.3 版本。
2.  **运行POC：** 使用 Python 运行提供的 POC 代码 `cve-2021-30047.py`，需要指定目标 IP 地址和端口号（默认为 21），以及要创建的最大连接数（默认为 50）。
3.  **观察效果：**  POC 运行后，会创建大量的 FTP 连接，导致 VSFTPD 服务器无法响应正常的连接请求，从而达到拒绝服务的目的。

**项目地址:** [Andreyfreis/CVE-2021-30047](https://github.com/Andreyfreis/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #3

**来源**: [CVE-2021-30047-Andreyft7_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyft7_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD Denial of Service

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 目标服务器运行着 VSFTPD 3.0.3 且允许建立新的 FTP 连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，漏洞 CVE-2021-30047 是 VSFTPD 3.0.3 版本中的一个拒绝服务漏洞。该漏洞是由于 VSFTPD 允许的连接数有限，攻击者可以通过建立大量并发连接耗尽服务器资源，从而导致拒绝服务。

**有效性评估：**
提供的 Python 脚本 `cve-2021-30047.py` 旨在通过创建大量 FTP 连接来利用此漏洞。脚本首先检查目标 FTP 服务器的端口是否开放，然后启动多个线程，每个线程尝试建立一个新的 FTP 连接。通过耗尽服务器的连接资源，可以实现拒绝服务。

**投毒风险分析：**
代码主要功能是创建大量socket连接，并使用subprocess启动ftp进程。脚本包含一个简单的定时器，在15分钟后杀死所有ftp进程。主要风险在于subprocess的使用，理论上可以通过修改ftp命令或者在ftp交互过程中发送恶意指令，达到控制服务器的目的。但是原作者并未这样做，只是简单地利用ftp命令建立连接。因此认为投毒风险较低，考虑到subprocess本身的安全风险，给出10%的投毒风险评估。

**利用方式分析：**
1.  **目标确定：** 确定运行 VSFTPD 3.0.3 的目标服务器和 FTP 端口 (默认为 21)。
2.  **连接测试：** 使用 `testar_conexao` 函数验证目标端口是否开放。
3.  **并发连接：** 使用 `iniciar_ataque_loop` 函数启动多个线程，每个线程通过 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 尝试建立 FTP 连接。`subprocess.Popen` 用于在后台运行 `ftp` 命令，无需交互，仅用于建立连接。
4.  **资源耗尽：** 大量并发连接最终会耗尽服务器资源，导致拒绝服务。
5.  **定时清理：** 使用 `temporizador` 函数在 15 分钟后自动终止所有 `ftp` 进程，以避免长时间占用资源。

总而言之，漏洞利用方式是通过脚本创建大量并发的FTP连接请求，消耗目标服务器的资源，实现拒绝服务攻击。代码中的定时器用于限制攻击持续时间。

**项目地址:** [Andreyft7/CVE-2021-30047](https://github.com/Andreyft7/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #4

**来源**: [CVE-2021-30047-Freitandrei_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrei_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD 3.0.3 DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 需要网络可达性，目标FTP服务运行在3.0.3版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 VSFTPD 3.0.3 版本中，由于允许的连接数有限，攻击者可以通过建立大量的 FTP 连接来耗尽服务器资源，从而导致拒绝服务。利用方式是通过编写脚本 (如提供的 Python 脚本) 快速建立大量到目标 FTP 服务器的连接。 

**有效性评估：**

提供的PoC代码看起来是有效的。它使用 Python 编写，利用 `subprocess.Popen` 来并发创建多个 FTP 连接。代码包含测试连接可用性的函数以及超时机制，可以有效防止攻击无限进行。

**投毒风险分析：**

PoC 代码本身执行的是 DoS 攻击，其目的是使目标服务器崩溃，而不是植入后门或执行恶意代码。 脚本的主要功能集中于建立和管理 FTP 连接，没有发现明显的恶意代码或后门。 然而，由于 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 使用了 `shell=True`，这存在一定的命令注入风险，尽管实际利用难度较高。攻击者如果能够控制 `alvo` 和 `porta` 变量，理论上可能执行任意命令。但这通常需要配合其他漏洞才能实现，因此将其判定为投毒的可能性较低，约为5%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行 VSFTPD 3.0.3 版本的 FTP 服务器。
2.  **运行 PoC：** 使用提供的 Python 脚本，指定目标服务器的 IP 地址和端口，以及最大连接数。
3.  **发起攻击：** 脚本会尝试建立指定数量的 FTP 连接，耗尽服务器资源。
4.  **结果：** 目标 FTP 服务器因为无法处理大量的连接请求而变得缓慢或崩溃，从而实现拒绝服务攻击。

**项目地址:** [Freitandrei/CVE-2021-30047](https://github.com/Freitandrei/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #5

**来源**: [CVE-2021-30047-Freitandrey_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrey_CVE-2021-30047.md)

# CVE-2021-30047

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md](../2021/CVE-2021-30047-AndreyFreitass_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-拒绝服务

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 需要网络访问目标FTP服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-30047 漏洞存在于 vsftpd 3.0.3 版本中。该漏洞允许攻击者通过创建大量连接来耗尽服务器资源，导致拒绝服务。漏洞利用方式是通过发送大量的FTP连接请求，超出服务器的最大连接限制，使得正常用户无法连接。提供的PoC 代码通过使用多线程，循环创建 `ftp` 进程连接目标服务器，模拟了连接洪水攻击。`temporizador` 函数保证攻击在 15 分钟后自动停止，并通过 `pkill ftp` 命令结束所有 `ftp` 进程。代码中调用了外部命令 `ftp` 和 `pkill`，如果系统缺少这些命令可能无法运行。投毒风险较低，主要风险在于过度使用该脚本可能对目标系统或网络造成实际损害。代码中定时结束进程的操作，有几率会结束其他用户的ftp连接，存在一定误伤概率。

**项目地址:** [AndreyFreitass/CVE-2021-30047](https://github.com/AndreyFreitass/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #2

**来源**: [CVE-2021-30047-Andreyfreis_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyfreis_CVE-2021-30047.md)

## CVE-2021-30047-vsftpd-DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，可能导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 目标主机运行vsftpd 3.0.3版本，并且允许建立新的TCP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-30047 漏洞存在于 VSFTPD 3.0.3 版本中，由于程序允许的连接数有限，攻击者可以通过创建大量连接来耗尽服务器资源，导致拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果都明确指出 VSFTPD 3.0.3 存在 DoS 漏洞，攻击者可以通过耗尽连接数来攻击。POC 代码 `cve-2021-30047.py` 的实现方式是创建多个线程，每个线程都尝试与目标 VSFTPD 服务器建立 FTP 连接，从而达到耗尽服务器连接资源的目的。

**投毒风险分析：**

对提供的 POC 代码 `cve-2021-30047.py` 进行分析，代码的主要功能是建立大量的 FTP 连接以造成拒绝服务。代码中包含以下几个关键部分：

*   `testar_conexao()`: 测试目标端口是否开放。
*   `ataque()`: 尝试使用 `ftp` 命令连接目标服务器。关键在于使用了 `subprocess.Popen` 创建子进程执行 `ftp` 命令，并将标准输出和标准错误重定向到 `/dev/null`，这意味着连接过程中的任何交互都被屏蔽了。
*   `iniciar_ataque_loop()`: 创建多个线程并发执行 `ataque()` 函数，从而发起 DoS 攻击。
*   `temporizador()`:  定时杀死由 `subprocess.Popen` 创建的 `ftp` 进程，防止攻击无限期执行。

代码中并没有发现明显的恶意代码，例如反弹 shell、文件上传或其他任何试图在目标系统上执行任意代码的行为。 子进程执行的命令是标准的 `ftp` 命令，虽然数量庞大，但本身并不会造成安全问题（除了 DoS 之外）。因此，该 POC 代码的投毒风险为 0%。

**利用方式：**

1.  **环境准备：** 确保目标主机运行着 VSFTPD 3.0.3 版本。
2.  **运行POC：** 使用 Python 运行提供的 POC 代码 `cve-2021-30047.py`，需要指定目标 IP 地址和端口号（默认为 21），以及要创建的最大连接数（默认为 50）。
3.  **观察效果：**  POC 运行后，会创建大量的 FTP 连接，导致 VSFTPD 服务器无法响应正常的连接请求，从而达到拒绝服务的目的。

**项目地址:** [Andreyfreis/CVE-2021-30047](https://github.com/Andreyfreis/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #3

**来源**: [CVE-2021-30047-Andreyft7_CVE-2021-30047.md](../2021/CVE-2021-30047-Andreyft7_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD Denial of Service

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 目标服务器运行着 VSFTPD 3.0.3 且允许建立新的 FTP 连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，漏洞 CVE-2021-30047 是 VSFTPD 3.0.3 版本中的一个拒绝服务漏洞。该漏洞是由于 VSFTPD 允许的连接数有限，攻击者可以通过建立大量并发连接耗尽服务器资源，从而导致拒绝服务。

**有效性评估：**
提供的 Python 脚本 `cve-2021-30047.py` 旨在通过创建大量 FTP 连接来利用此漏洞。脚本首先检查目标 FTP 服务器的端口是否开放，然后启动多个线程，每个线程尝试建立一个新的 FTP 连接。通过耗尽服务器的连接资源，可以实现拒绝服务。

**投毒风险分析：**
代码主要功能是创建大量socket连接，并使用subprocess启动ftp进程。脚本包含一个简单的定时器，在15分钟后杀死所有ftp进程。主要风险在于subprocess的使用，理论上可以通过修改ftp命令或者在ftp交互过程中发送恶意指令，达到控制服务器的目的。但是原作者并未这样做，只是简单地利用ftp命令建立连接。因此认为投毒风险较低，考虑到subprocess本身的安全风险，给出10%的投毒风险评估。

**利用方式分析：**
1.  **目标确定：** 确定运行 VSFTPD 3.0.3 的目标服务器和 FTP 端口 (默认为 21)。
2.  **连接测试：** 使用 `testar_conexao` 函数验证目标端口是否开放。
3.  **并发连接：** 使用 `iniciar_ataque_loop` 函数启动多个线程，每个线程通过 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 尝试建立 FTP 连接。`subprocess.Popen` 用于在后台运行 `ftp` 命令，无需交互，仅用于建立连接。
4.  **资源耗尽：** 大量并发连接最终会耗尽服务器资源，导致拒绝服务。
5.  **定时清理：** 使用 `temporizador` 函数在 15 分钟后自动终止所有 `ftp` 进程，以避免长时间占用资源。

总而言之，漏洞利用方式是通过脚本创建大量并发的FTP连接请求，消耗目标服务器的资源，实现拒绝服务攻击。代码中的定时器用于限制攻击持续时间。

**项目地址:** [Andreyft7/CVE-2021-30047](https://github.com/Andreyft7/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #4

**来源**: [CVE-2021-30047-Freitandrei_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrei_CVE-2021-30047.md)

## CVE-2021-30047 - VSFTPD 3.0.3 DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 需要网络可达性，目标FTP服务运行在3.0.3版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 VSFTPD 3.0.3 版本中，由于允许的连接数有限，攻击者可以通过建立大量的 FTP 连接来耗尽服务器资源，从而导致拒绝服务。利用方式是通过编写脚本 (如提供的 Python 脚本) 快速建立大量到目标 FTP 服务器的连接。 

**有效性评估：**

提供的PoC代码看起来是有效的。它使用 Python 编写，利用 `subprocess.Popen` 来并发创建多个 FTP 连接。代码包含测试连接可用性的函数以及超时机制，可以有效防止攻击无限进行。

**投毒风险分析：**

PoC 代码本身执行的是 DoS 攻击，其目的是使目标服务器崩溃，而不是植入后门或执行恶意代码。 脚本的主要功能集中于建立和管理 FTP 连接，没有发现明显的恶意代码或后门。 然而，由于 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 使用了 `shell=True`，这存在一定的命令注入风险，尽管实际利用难度较高。攻击者如果能够控制 `alvo` 和 `porta` 变量，理论上可能执行任意命令。但这通常需要配合其他漏洞才能实现，因此将其判定为投毒的可能性较低，约为5%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行 VSFTPD 3.0.3 版本的 FTP 服务器。
2.  **运行 PoC：** 使用提供的 Python 脚本，指定目标服务器的 IP 地址和端口，以及最大连接数。
3.  **发起攻击：** 脚本会尝试建立指定数量的 FTP 连接，耗尽服务器资源。
4.  **结果：** 目标 FTP 服务器因为无法处理大量的连接请求而变得缓慢或崩溃，从而实现拒绝服务攻击。

**项目地址:** [Freitandrei/CVE-2021-30047](https://github.com/Freitandrei/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---

## POC #5

**来源**: [CVE-2021-30047-Freitandrey_CVE-2021-30047.md](../2021/CVE-2021-30047-Freitandrey_CVE-2021-30047.md)

## CVE-2021-30047-VSFTPD-DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 目标FTP服务端口开放且可访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-30047是VSFTPD 3.0.3版本中的一个拒绝服务漏洞，由于服务器允许的连接数有限，攻击者可以通过建立大量并发连接耗尽服务器资源，导致服务不可用。PoC代码通过创建多个线程并使用`ftp`命令与目标FTP服务器建立连接来实现。脚本会持续尝试建立连接，直到手动停止或达到预设的15分钟超时时间。超时后，脚本会使用`pkill ftp`命令结束所有ftp进程。关于投毒风险，代码中存在`subprocess.Popen`函数，理论上存在被植入恶意命令的可能，但经过分析，相关代码主要用于启动ftp连接和结束进程，投毒可能性较低。同时`README.md`文件也声明此脚本仅用于教育目的和授权的bug bounty测试。

**项目地址:** [Freitandrey/CVE-2021-30047](https://github.com/Freitandrey/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)

---



---



---



---



---



---



---



---



---



---



---



---



---

