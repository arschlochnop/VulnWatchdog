# CVE-2021-31630

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-31630-FlojBoj_CVE-2021-31630.md](../2021/CVE-2021-31630-FlojBoj_CVE-2021-31630.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 远程命令执行

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者能够访问/hardware页面，并拥有有效的用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，OpenPLC Webserver v3 存在一个远程命令执行漏洞（CVE-2021-31630），攻击者可以通过“Hardware Layer Code Box”组件，在/hardware页面上执行任意代码。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录OpenPLC Webserver v3。
2.  **上传恶意C文件：** 攻击者将包含反向shell的恶意C代码上传到“Hardware Layer Code Box”组件。该代码会在目标系统上创建一个反向shell连接到攻击者的监听器IP地址和端口。
3.  **编译：** 攻击者通过访问/compile-program端点触发C代码的编译。
4.  **启动PLC：** 攻击者访问/start_plc端点启动PLC，这将执行编译后的恶意代码，从而建立反向shell。
5.  **停止PLC：**  攻击者访问/stop_plc端点停止PLC。停止PLC不是必须的操作，因为反向shell一旦建立，就会保持连接，即使PLC停止运行。

**有效性：**

提供的PoC代码看起来是有效的。它包含了必要的步骤，如身份验证、上传恶意C文件、编译、启动PLC和停止PLC。代码中使用的反向shell技术是一种常见的利用远程命令执行漏洞的方式。

**投毒风险：**

PoC代码本身没有明显的投毒行为。`exploit.py`脚本的主要功能是自动化漏洞利用过程，没有发现任何会损害攻击者自身或其他用户的恶意代码。恶意行为都集中在创建反向shell，利用目标机器，没有迹象表明会影响到攻击者或其他人, 投毒风险可能性为0%。

**项目地址:** [FlojBoj/CVE-2021-31630](https://github.com/FlojBoj/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #2

**来源**: [CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md](../2021/CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md)

## CVE-2021-31630 - OpenPLC Webserver v3 命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，允许远程攻击者通过“Hardware Layer Code Box”组件执行任意代码。利用方式如下：

1.  **身份验证：** 使用提供的用户名和密码登录OpenPLC Webserver。
2.  **构造恶意请求：** 构造一个包含恶意代码的multipart/form-data请求，该代码会被插入到“Hardware Layer Code Box”中。  `exploit.py` 脚本将一个反向shell的C代码注入到`custom_layer_code`字段中，该反向shell连接攻击者指定的IP地址和端口。
3.  **发送请求：** 将构造的请求发送到/hardware页面。
4.  **触发编译：** 访问/compile-program?file=blank_program.st页面触发代码编译。
5.  **代码执行：**  编译过程会执行注入的恶意代码，从而建立一个反向shell连接，允许攻击者在目标系统上执行任意命令。

**投毒风险分析：**

代码中包含`# FUCK ISRAEL`的注释，这表明作者可能存在政治倾向，但这并不构成技术上的投毒。`exploit.py`脚本本身实现了漏洞利用的功能，没有发现隐藏的恶意代码或后门。它执行的操作完全符合漏洞描述和利用目的。因此，投毒风险评估为0%。需要说明的是，利用漏洞本身就是在目标系统上植入后门，但是这属于漏洞利用的范畴，不属于投毒。

**项目地址:** [Hunt3r0x/CVE-2021-31630-HTB](https://github.com/Hunt3r0x/CVE-2021-31630-HTB)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #3

**来源**: [CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md](../2021/CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要网络访问OpenPLC Webserver的`/hardware`页面，默认用户名密码openplc/openplc

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。远程攻击者可以通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件利用此漏洞执行任意代码。

**有效性分析：**

从提供的漏洞信息、搜索引擎结果以及漏洞利用代码来看，该漏洞是真实存在的，并且存在公开的PoC利用代码。搜索引擎结果中多个链接指向了漏洞的详细信息，包括NVD、Red Hat、Mitre等权威机构的描述。提供的PoC代码是一个Python脚本，它自动化了利用该漏洞的过程，包括登录OpenPLC、构造包含反弹shell的恶意payload、上传payload以及触发漏洞，从而实现远程代码执行。

**投毒风险分析：**

对PoC代码进行分析后，虽然脚本本身是为了演示漏洞利用，但在以下几个方面存在潜在的投毒风险：

1.  **payload定制：** 脚本允许用户自定义反弹shell的IP地址和端口。虽然这本身是正常功能，但如果攻击者恶意修改脚本，例如硬编码一个恶意IP地址，然后传播该修改后的脚本，则可能导致其他用户在不知情的情况下将shell反弹到攻击者的服务器。
2.  **依赖项风险：** 脚本依赖于`requests`库。如果攻击者篡改了`requests`库，或者诱骗用户安装恶意版本，则可能在用户运行脚本时执行恶意代码。
3.  **脚本行为的混淆：** 通过仔细阅读脚本，可以理解其行为。但是，如果攻击者对脚本进行混淆或修改，使其行为更难以理解，则可能诱骗用户在不知情的情况下运行恶意代码。

尽管存在这些风险，但脚本的主要功能是实现漏洞利用，没有发现明显的恶意代码。因此，可以认为投毒风险较低，大约为1%。

**漏洞利用方式：**

1.  **身份验证：**  利用PoC提供的用户名和密码或者爆破用户名和密码，访问OpenPLC Webserver的`/hardware`页面。
2.  **构造Payload：**  构造包含恶意命令的Payload，该命令通常用于执行反弹shell，建立与攻击者控制的服务器的连接。
3.  **上传Payload：**  将构造的Payload上传到 `/hardware` 页面的 "Hardware Layer Code Box" 组件中。
4.  **触发漏洞：**  通过尝试编译上传的恶意代码，触发命令注入漏洞。这将导致服务器执行Payload中的恶意命令，从而建立反弹shell，允许攻击者远程控制OpenPLC Webserver所在的系统。

**项目地址:** [behindsecurity/htb-wifinetictwo-exploit](https://github.com/behindsecurity/htb-wifinetictwo-exploit)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #4

**来源**: [CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md](../2021/CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3 远程代码执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可被远程攻击者利用执行任意代码。

**影响版本:** v3

**利用条件:** 需要身份验证，以及访问`/hardware`页面'Hardware Layer Code Box'组件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。远程攻击者可以通过`/hardware`页面的"Hardware Layer Code Box"组件利用此漏洞执行任意代码。根据搜索引擎结果，已经存在公开的漏洞利用脚本（例如，thewhiteh4t/cve-2021-31630），表明该漏洞具有较高的可利用性。提供的POC代码是一个README.md文件，描述了漏洞利用脚本的存在，但并未提供实际的利用代码。因此，无法直接评估其有效性，需要进一步获取并分析脚本。仓库中可能存在作者隐藏的投毒代码，但根据readme文件内容，风险较小。 利用方式：攻击者首先需要通过身份验证访问OpenPLC Webserver v3的web界面，然后导航到`/hardware`页面，在"Hardware Layer Code Box"组件中输入恶意命令。由于该组件没有充分的输入验证，恶意命令会被服务器执行，导致远程代码执行。

**项目地址:** [hev0x/CVE-2021-31630-OpenPLC_RCE](https://github.com/hev0x/CVE-2021-31630-OpenPLC_RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #5

**来源**: [CVE-2021-31630-junnythemarksman_CVE-2021-31630.md](../2021/CVE-2021-31630-junnythemarksman_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要目标系统开启OpenPLC Webserver v3，攻击者需要具有有效的管理员账户密码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。攻击者可以利用"Hardware Layer Code Box"组件，通过 `/hardware` 页面执行任意代码。 

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录 OpenPLC Webserver v3。
2.  **上传恶意程序：** 使用提供的exploit.py脚本，该脚本首先尝试使用提供的凭据进行身份验证。成功登录后，它将包含反向 shell 命令的恶意 PLC 程序上传到服务器，这个PLC程序会被上传到programs目录中。
3.  **编译恶意程序：** 脚本接着会请求编译上传的程序。
4.  **运行PLC服务：** 脚本会启动 PLC 服务，从而触发命令注入。

该漏洞利用脚本通过修改 Fellipe Oliveira 提供的 PoC 代码实现，允许远程攻击者在 OpenPLC Webserver v3 上执行任意代码。

**投毒风险分析：**

该POC脚本本身存在一定的投毒风险，因为脚本的功能是上传并执行PLC程序，该程序的内容完全由攻击者控制。虽然目前的POC代码中没有明显的恶意行为，但攻击者可以很容易地修改`upload_data`变量，植入恶意的代码来执行任何操作，例如删除文件，修改配置等。由于该脚本需要身份验证才能利用，因此只有具有有效凭据的用户才能触发该漏洞，从而降低了投毒风险。但是，一旦凭据泄露，攻击者就可以完全控制系统。综合评估，投毒风险为10%。

**项目地址:** [junnythemarksman/CVE-2021-31630](https://github.com/junnythemarksman/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #6

**来源**: [CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md](../2021/CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要身份验证，且目标服务器上的OpenPLC Webserver v3运行在可访问的网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者可以通过 "Hardware Layer Code Box" 组件，在 `/hardware` 页面上，执行任意代码。该漏洞利用方式如下：

1.  **目标探测：**  首先需要确定目标OpenPLC Webserver v3服务器是否可达。
2.  **身份验证：**  使用默认凭据（openplc/openplc）或已知的有效凭据登录到OpenPLC Webserver。
3.  **Payload构建：**  利用代码构建一个包含反向shell的恶意C代码，该代码会被注入到“Hardware Layer Code Box”。反向shell连接到攻击者的机器。
4.  **Payload上传：**  将构建的payload上传到 `/hardware` 页面，覆盖 custom layer code.
5.  **程序编译：**  访问 `/compile-program?file=blank_program.st` 触发程序编译。
6.  **启动PLC：**  访问 `/start_plc` 以启动PLC，这将触发payload的执行，从而建立反向shell。
7.  **清理（可选）：**  为了避免留下痕迹，可以停止PLC并恢复自定义硬件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用POC代码的有效性高。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出攻击者可以通过特定的页面和组件执行任意代码。提供的Python POC代码实现了完整的攻击流程，包括身份验证、payload构建、上传、编译和PLC启动，从而获得反向shell。

**投毒风险分析：**

提供的POC代码的主要功能是利用命令注入漏洞，在目标系统上执行任意代码，从而获取反向shell。代码中构建了一个C语言payload，该payload的功能是创建一个反向shell连接到攻击者指定的IP地址和端口。审查代码并没有发现作者隐藏的恶意代码或者后门，例如删除文件、篡改系统配置或者进行其他未经授权的操作。因此，可以认为此仓库中不存在作者隐藏的投毒代码, 风险为0%。

**项目地址:** [machevalia/OpenPLC-CVE-2021-31630-RCE](https://github.com/machevalia/OpenPLC-CVE-2021-31630-RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #7

**来源**: [CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md](../2021/CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md)

# CVE-2021-31630

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-31630-FlojBoj_CVE-2021-31630.md](../2021/CVE-2021-31630-FlojBoj_CVE-2021-31630.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 远程命令执行

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者能够访问/hardware页面，并拥有有效的用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，OpenPLC Webserver v3 存在一个远程命令执行漏洞（CVE-2021-31630），攻击者可以通过“Hardware Layer Code Box”组件，在/hardware页面上执行任意代码。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录OpenPLC Webserver v3。
2.  **上传恶意C文件：** 攻击者将包含反向shell的恶意C代码上传到“Hardware Layer Code Box”组件。该代码会在目标系统上创建一个反向shell连接到攻击者的监听器IP地址和端口。
3.  **编译：** 攻击者通过访问/compile-program端点触发C代码的编译。
4.  **启动PLC：** 攻击者访问/start_plc端点启动PLC，这将执行编译后的恶意代码，从而建立反向shell。
5.  **停止PLC：**  攻击者访问/stop_plc端点停止PLC。停止PLC不是必须的操作，因为反向shell一旦建立，就会保持连接，即使PLC停止运行。

**有效性：**

提供的PoC代码看起来是有效的。它包含了必要的步骤，如身份验证、上传恶意C文件、编译、启动PLC和停止PLC。代码中使用的反向shell技术是一种常见的利用远程命令执行漏洞的方式。

**投毒风险：**

PoC代码本身没有明显的投毒行为。`exploit.py`脚本的主要功能是自动化漏洞利用过程，没有发现任何会损害攻击者自身或其他用户的恶意代码。恶意行为都集中在创建反向shell，利用目标机器，没有迹象表明会影响到攻击者或其他人, 投毒风险可能性为0%。

**项目地址:** [FlojBoj/CVE-2021-31630](https://github.com/FlojBoj/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #2

**来源**: [CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md](../2021/CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md)

## CVE-2021-31630 - OpenPLC Webserver v3 命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，允许远程攻击者通过“Hardware Layer Code Box”组件执行任意代码。利用方式如下：

1.  **身份验证：** 使用提供的用户名和密码登录OpenPLC Webserver。
2.  **构造恶意请求：** 构造一个包含恶意代码的multipart/form-data请求，该代码会被插入到“Hardware Layer Code Box”中。  `exploit.py` 脚本将一个反向shell的C代码注入到`custom_layer_code`字段中，该反向shell连接攻击者指定的IP地址和端口。
3.  **发送请求：** 将构造的请求发送到/hardware页面。
4.  **触发编译：** 访问/compile-program?file=blank_program.st页面触发代码编译。
5.  **代码执行：**  编译过程会执行注入的恶意代码，从而建立一个反向shell连接，允许攻击者在目标系统上执行任意命令。

**投毒风险分析：**

代码中包含`# FUCK ISRAEL`的注释，这表明作者可能存在政治倾向，但这并不构成技术上的投毒。`exploit.py`脚本本身实现了漏洞利用的功能，没有发现隐藏的恶意代码或后门。它执行的操作完全符合漏洞描述和利用目的。因此，投毒风险评估为0%。需要说明的是，利用漏洞本身就是在目标系统上植入后门，但是这属于漏洞利用的范畴，不属于投毒。

**项目地址:** [Hunt3r0x/CVE-2021-31630-HTB](https://github.com/Hunt3r0x/CVE-2021-31630-HTB)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #3

**来源**: [CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md](../2021/CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要网络访问OpenPLC Webserver的`/hardware`页面，默认用户名密码openplc/openplc

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。远程攻击者可以通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件利用此漏洞执行任意代码。

**有效性分析：**

从提供的漏洞信息、搜索引擎结果以及漏洞利用代码来看，该漏洞是真实存在的，并且存在公开的PoC利用代码。搜索引擎结果中多个链接指向了漏洞的详细信息，包括NVD、Red Hat、Mitre等权威机构的描述。提供的PoC代码是一个Python脚本，它自动化了利用该漏洞的过程，包括登录OpenPLC、构造包含反弹shell的恶意payload、上传payload以及触发漏洞，从而实现远程代码执行。

**投毒风险分析：**

对PoC代码进行分析后，虽然脚本本身是为了演示漏洞利用，但在以下几个方面存在潜在的投毒风险：

1.  **payload定制：** 脚本允许用户自定义反弹shell的IP地址和端口。虽然这本身是正常功能，但如果攻击者恶意修改脚本，例如硬编码一个恶意IP地址，然后传播该修改后的脚本，则可能导致其他用户在不知情的情况下将shell反弹到攻击者的服务器。
2.  **依赖项风险：** 脚本依赖于`requests`库。如果攻击者篡改了`requests`库，或者诱骗用户安装恶意版本，则可能在用户运行脚本时执行恶意代码。
3.  **脚本行为的混淆：** 通过仔细阅读脚本，可以理解其行为。但是，如果攻击者对脚本进行混淆或修改，使其行为更难以理解，则可能诱骗用户在不知情的情况下运行恶意代码。

尽管存在这些风险，但脚本的主要功能是实现漏洞利用，没有发现明显的恶意代码。因此，可以认为投毒风险较低，大约为1%。

**漏洞利用方式：**

1.  **身份验证：**  利用PoC提供的用户名和密码或者爆破用户名和密码，访问OpenPLC Webserver的`/hardware`页面。
2.  **构造Payload：**  构造包含恶意命令的Payload，该命令通常用于执行反弹shell，建立与攻击者控制的服务器的连接。
3.  **上传Payload：**  将构造的Payload上传到 `/hardware` 页面的 "Hardware Layer Code Box" 组件中。
4.  **触发漏洞：**  通过尝试编译上传的恶意代码，触发命令注入漏洞。这将导致服务器执行Payload中的恶意命令，从而建立反弹shell，允许攻击者远程控制OpenPLC Webserver所在的系统。

**项目地址:** [behindsecurity/htb-wifinetictwo-exploit](https://github.com/behindsecurity/htb-wifinetictwo-exploit)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #4

**来源**: [CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md](../2021/CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3 远程代码执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可被远程攻击者利用执行任意代码。

**影响版本:** v3

**利用条件:** 需要身份验证，以及访问`/hardware`页面'Hardware Layer Code Box'组件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。远程攻击者可以通过`/hardware`页面的"Hardware Layer Code Box"组件利用此漏洞执行任意代码。根据搜索引擎结果，已经存在公开的漏洞利用脚本（例如，thewhiteh4t/cve-2021-31630），表明该漏洞具有较高的可利用性。提供的POC代码是一个README.md文件，描述了漏洞利用脚本的存在，但并未提供实际的利用代码。因此，无法直接评估其有效性，需要进一步获取并分析脚本。仓库中可能存在作者隐藏的投毒代码，但根据readme文件内容，风险较小。 利用方式：攻击者首先需要通过身份验证访问OpenPLC Webserver v3的web界面，然后导航到`/hardware`页面，在"Hardware Layer Code Box"组件中输入恶意命令。由于该组件没有充分的输入验证，恶意命令会被服务器执行，导致远程代码执行。

**项目地址:** [hev0x/CVE-2021-31630-OpenPLC_RCE](https://github.com/hev0x/CVE-2021-31630-OpenPLC_RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #5

**来源**: [CVE-2021-31630-junnythemarksman_CVE-2021-31630.md](../2021/CVE-2021-31630-junnythemarksman_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要目标系统开启OpenPLC Webserver v3，攻击者需要具有有效的管理员账户密码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。攻击者可以利用"Hardware Layer Code Box"组件，通过 `/hardware` 页面执行任意代码。 

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录 OpenPLC Webserver v3。
2.  **上传恶意程序：** 使用提供的exploit.py脚本，该脚本首先尝试使用提供的凭据进行身份验证。成功登录后，它将包含反向 shell 命令的恶意 PLC 程序上传到服务器，这个PLC程序会被上传到programs目录中。
3.  **编译恶意程序：** 脚本接着会请求编译上传的程序。
4.  **运行PLC服务：** 脚本会启动 PLC 服务，从而触发命令注入。

该漏洞利用脚本通过修改 Fellipe Oliveira 提供的 PoC 代码实现，允许远程攻击者在 OpenPLC Webserver v3 上执行任意代码。

**投毒风险分析：**

该POC脚本本身存在一定的投毒风险，因为脚本的功能是上传并执行PLC程序，该程序的内容完全由攻击者控制。虽然目前的POC代码中没有明显的恶意行为，但攻击者可以很容易地修改`upload_data`变量，植入恶意的代码来执行任何操作，例如删除文件，修改配置等。由于该脚本需要身份验证才能利用，因此只有具有有效凭据的用户才能触发该漏洞，从而降低了投毒风险。但是，一旦凭据泄露，攻击者就可以完全控制系统。综合评估，投毒风险为10%。

**项目地址:** [junnythemarksman/CVE-2021-31630](https://github.com/junnythemarksman/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #6

**来源**: [CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md](../2021/CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要身份验证，且目标服务器上的OpenPLC Webserver v3运行在可访问的网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者可以通过 "Hardware Layer Code Box" 组件，在 `/hardware` 页面上，执行任意代码。该漏洞利用方式如下：

1.  **目标探测：**  首先需要确定目标OpenPLC Webserver v3服务器是否可达。
2.  **身份验证：**  使用默认凭据（openplc/openplc）或已知的有效凭据登录到OpenPLC Webserver。
3.  **Payload构建：**  利用代码构建一个包含反向shell的恶意C代码，该代码会被注入到“Hardware Layer Code Box”。反向shell连接到攻击者的机器。
4.  **Payload上传：**  将构建的payload上传到 `/hardware` 页面，覆盖 custom layer code.
5.  **程序编译：**  访问 `/compile-program?file=blank_program.st` 触发程序编译。
6.  **启动PLC：**  访问 `/start_plc` 以启动PLC，这将触发payload的执行，从而建立反向shell。
7.  **清理（可选）：**  为了避免留下痕迹，可以停止PLC并恢复自定义硬件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用POC代码的有效性高。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出攻击者可以通过特定的页面和组件执行任意代码。提供的Python POC代码实现了完整的攻击流程，包括身份验证、payload构建、上传、编译和PLC启动，从而获得反向shell。

**投毒风险分析：**

提供的POC代码的主要功能是利用命令注入漏洞，在目标系统上执行任意代码，从而获取反向shell。代码中构建了一个C语言payload，该payload的功能是创建一个反向shell连接到攻击者指定的IP地址和端口。审查代码并没有发现作者隐藏的恶意代码或者后门，例如删除文件、篡改系统配置或者进行其他未经授权的操作。因此，可以认为此仓库中不存在作者隐藏的投毒代码, 风险为0%。

**项目地址:** [machevalia/OpenPLC-CVE-2021-31630-RCE](https://github.com/machevalia/OpenPLC-CVE-2021-31630-RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #7

**来源**: [CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md](../2021/CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md)

# CVE-2021-31630

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-31630-FlojBoj_CVE-2021-31630.md](../2021/CVE-2021-31630-FlojBoj_CVE-2021-31630.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 远程命令执行

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者能够访问/hardware页面，并拥有有效的用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，OpenPLC Webserver v3 存在一个远程命令执行漏洞（CVE-2021-31630），攻击者可以通过“Hardware Layer Code Box”组件，在/hardware页面上执行任意代码。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录OpenPLC Webserver v3。
2.  **上传恶意C文件：** 攻击者将包含反向shell的恶意C代码上传到“Hardware Layer Code Box”组件。该代码会在目标系统上创建一个反向shell连接到攻击者的监听器IP地址和端口。
3.  **编译：** 攻击者通过访问/compile-program端点触发C代码的编译。
4.  **启动PLC：** 攻击者访问/start_plc端点启动PLC，这将执行编译后的恶意代码，从而建立反向shell。
5.  **停止PLC：**  攻击者访问/stop_plc端点停止PLC。停止PLC不是必须的操作，因为反向shell一旦建立，就会保持连接，即使PLC停止运行。

**有效性：**

提供的PoC代码看起来是有效的。它包含了必要的步骤，如身份验证、上传恶意C文件、编译、启动PLC和停止PLC。代码中使用的反向shell技术是一种常见的利用远程命令执行漏洞的方式。

**投毒风险：**

PoC代码本身没有明显的投毒行为。`exploit.py`脚本的主要功能是自动化漏洞利用过程，没有发现任何会损害攻击者自身或其他用户的恶意代码。恶意行为都集中在创建反向shell，利用目标机器，没有迹象表明会影响到攻击者或其他人, 投毒风险可能性为0%。

**项目地址:** [FlojBoj/CVE-2021-31630](https://github.com/FlojBoj/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #2

**来源**: [CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md](../2021/CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md)

## CVE-2021-31630 - OpenPLC Webserver v3 命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，允许远程攻击者通过“Hardware Layer Code Box”组件执行任意代码。利用方式如下：

1.  **身份验证：** 使用提供的用户名和密码登录OpenPLC Webserver。
2.  **构造恶意请求：** 构造一个包含恶意代码的multipart/form-data请求，该代码会被插入到“Hardware Layer Code Box”中。  `exploit.py` 脚本将一个反向shell的C代码注入到`custom_layer_code`字段中，该反向shell连接攻击者指定的IP地址和端口。
3.  **发送请求：** 将构造的请求发送到/hardware页面。
4.  **触发编译：** 访问/compile-program?file=blank_program.st页面触发代码编译。
5.  **代码执行：**  编译过程会执行注入的恶意代码，从而建立一个反向shell连接，允许攻击者在目标系统上执行任意命令。

**投毒风险分析：**

代码中包含`# FUCK ISRAEL`的注释，这表明作者可能存在政治倾向，但这并不构成技术上的投毒。`exploit.py`脚本本身实现了漏洞利用的功能，没有发现隐藏的恶意代码或后门。它执行的操作完全符合漏洞描述和利用目的。因此，投毒风险评估为0%。需要说明的是，利用漏洞本身就是在目标系统上植入后门，但是这属于漏洞利用的范畴，不属于投毒。

**项目地址:** [Hunt3r0x/CVE-2021-31630-HTB](https://github.com/Hunt3r0x/CVE-2021-31630-HTB)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #3

**来源**: [CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md](../2021/CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要网络访问OpenPLC Webserver的`/hardware`页面，默认用户名密码openplc/openplc

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。远程攻击者可以通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件利用此漏洞执行任意代码。

**有效性分析：**

从提供的漏洞信息、搜索引擎结果以及漏洞利用代码来看，该漏洞是真实存在的，并且存在公开的PoC利用代码。搜索引擎结果中多个链接指向了漏洞的详细信息，包括NVD、Red Hat、Mitre等权威机构的描述。提供的PoC代码是一个Python脚本，它自动化了利用该漏洞的过程，包括登录OpenPLC、构造包含反弹shell的恶意payload、上传payload以及触发漏洞，从而实现远程代码执行。

**投毒风险分析：**

对PoC代码进行分析后，虽然脚本本身是为了演示漏洞利用，但在以下几个方面存在潜在的投毒风险：

1.  **payload定制：** 脚本允许用户自定义反弹shell的IP地址和端口。虽然这本身是正常功能，但如果攻击者恶意修改脚本，例如硬编码一个恶意IP地址，然后传播该修改后的脚本，则可能导致其他用户在不知情的情况下将shell反弹到攻击者的服务器。
2.  **依赖项风险：** 脚本依赖于`requests`库。如果攻击者篡改了`requests`库，或者诱骗用户安装恶意版本，则可能在用户运行脚本时执行恶意代码。
3.  **脚本行为的混淆：** 通过仔细阅读脚本，可以理解其行为。但是，如果攻击者对脚本进行混淆或修改，使其行为更难以理解，则可能诱骗用户在不知情的情况下运行恶意代码。

尽管存在这些风险，但脚本的主要功能是实现漏洞利用，没有发现明显的恶意代码。因此，可以认为投毒风险较低，大约为1%。

**漏洞利用方式：**

1.  **身份验证：**  利用PoC提供的用户名和密码或者爆破用户名和密码，访问OpenPLC Webserver的`/hardware`页面。
2.  **构造Payload：**  构造包含恶意命令的Payload，该命令通常用于执行反弹shell，建立与攻击者控制的服务器的连接。
3.  **上传Payload：**  将构造的Payload上传到 `/hardware` 页面的 "Hardware Layer Code Box" 组件中。
4.  **触发漏洞：**  通过尝试编译上传的恶意代码，触发命令注入漏洞。这将导致服务器执行Payload中的恶意命令，从而建立反弹shell，允许攻击者远程控制OpenPLC Webserver所在的系统。

**项目地址:** [behindsecurity/htb-wifinetictwo-exploit](https://github.com/behindsecurity/htb-wifinetictwo-exploit)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #4

**来源**: [CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md](../2021/CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3 远程代码执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可被远程攻击者利用执行任意代码。

**影响版本:** v3

**利用条件:** 需要身份验证，以及访问`/hardware`页面'Hardware Layer Code Box'组件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。远程攻击者可以通过`/hardware`页面的"Hardware Layer Code Box"组件利用此漏洞执行任意代码。根据搜索引擎结果，已经存在公开的漏洞利用脚本（例如，thewhiteh4t/cve-2021-31630），表明该漏洞具有较高的可利用性。提供的POC代码是一个README.md文件，描述了漏洞利用脚本的存在，但并未提供实际的利用代码。因此，无法直接评估其有效性，需要进一步获取并分析脚本。仓库中可能存在作者隐藏的投毒代码，但根据readme文件内容，风险较小。 利用方式：攻击者首先需要通过身份验证访问OpenPLC Webserver v3的web界面，然后导航到`/hardware`页面，在"Hardware Layer Code Box"组件中输入恶意命令。由于该组件没有充分的输入验证，恶意命令会被服务器执行，导致远程代码执行。

**项目地址:** [hev0x/CVE-2021-31630-OpenPLC_RCE](https://github.com/hev0x/CVE-2021-31630-OpenPLC_RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #5

**来源**: [CVE-2021-31630-junnythemarksman_CVE-2021-31630.md](../2021/CVE-2021-31630-junnythemarksman_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要目标系统开启OpenPLC Webserver v3，攻击者需要具有有效的管理员账户密码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。攻击者可以利用"Hardware Layer Code Box"组件，通过 `/hardware` 页面执行任意代码。 

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录 OpenPLC Webserver v3。
2.  **上传恶意程序：** 使用提供的exploit.py脚本，该脚本首先尝试使用提供的凭据进行身份验证。成功登录后，它将包含反向 shell 命令的恶意 PLC 程序上传到服务器，这个PLC程序会被上传到programs目录中。
3.  **编译恶意程序：** 脚本接着会请求编译上传的程序。
4.  **运行PLC服务：** 脚本会启动 PLC 服务，从而触发命令注入。

该漏洞利用脚本通过修改 Fellipe Oliveira 提供的 PoC 代码实现，允许远程攻击者在 OpenPLC Webserver v3 上执行任意代码。

**投毒风险分析：**

该POC脚本本身存在一定的投毒风险，因为脚本的功能是上传并执行PLC程序，该程序的内容完全由攻击者控制。虽然目前的POC代码中没有明显的恶意行为，但攻击者可以很容易地修改`upload_data`变量，植入恶意的代码来执行任何操作，例如删除文件，修改配置等。由于该脚本需要身份验证才能利用，因此只有具有有效凭据的用户才能触发该漏洞，从而降低了投毒风险。但是，一旦凭据泄露，攻击者就可以完全控制系统。综合评估，投毒风险为10%。

**项目地址:** [junnythemarksman/CVE-2021-31630](https://github.com/junnythemarksman/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #6

**来源**: [CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md](../2021/CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要身份验证，且目标服务器上的OpenPLC Webserver v3运行在可访问的网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者可以通过 "Hardware Layer Code Box" 组件，在 `/hardware` 页面上，执行任意代码。该漏洞利用方式如下：

1.  **目标探测：**  首先需要确定目标OpenPLC Webserver v3服务器是否可达。
2.  **身份验证：**  使用默认凭据（openplc/openplc）或已知的有效凭据登录到OpenPLC Webserver。
3.  **Payload构建：**  利用代码构建一个包含反向shell的恶意C代码，该代码会被注入到“Hardware Layer Code Box”。反向shell连接到攻击者的机器。
4.  **Payload上传：**  将构建的payload上传到 `/hardware` 页面，覆盖 custom layer code.
5.  **程序编译：**  访问 `/compile-program?file=blank_program.st` 触发程序编译。
6.  **启动PLC：**  访问 `/start_plc` 以启动PLC，这将触发payload的执行，从而建立反向shell。
7.  **清理（可选）：**  为了避免留下痕迹，可以停止PLC并恢复自定义硬件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用POC代码的有效性高。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出攻击者可以通过特定的页面和组件执行任意代码。提供的Python POC代码实现了完整的攻击流程，包括身份验证、payload构建、上传、编译和PLC启动，从而获得反向shell。

**投毒风险分析：**

提供的POC代码的主要功能是利用命令注入漏洞，在目标系统上执行任意代码，从而获取反向shell。代码中构建了一个C语言payload，该payload的功能是创建一个反向shell连接到攻击者指定的IP地址和端口。审查代码并没有发现作者隐藏的恶意代码或者后门，例如删除文件、篡改系统配置或者进行其他未经授权的操作。因此，可以认为此仓库中不存在作者隐藏的投毒代码, 风险为0%。

**项目地址:** [machevalia/OpenPLC-CVE-2021-31630-RCE](https://github.com/machevalia/OpenPLC-CVE-2021-31630-RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #7

**来源**: [CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md](../2021/CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md)

# CVE-2021-31630

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-31630-FlojBoj_CVE-2021-31630.md](../2021/CVE-2021-31630-FlojBoj_CVE-2021-31630.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 远程命令执行

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者能够访问/hardware页面，并拥有有效的用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，OpenPLC Webserver v3 存在一个远程命令执行漏洞（CVE-2021-31630），攻击者可以通过“Hardware Layer Code Box”组件，在/hardware页面上执行任意代码。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录OpenPLC Webserver v3。
2.  **上传恶意C文件：** 攻击者将包含反向shell的恶意C代码上传到“Hardware Layer Code Box”组件。该代码会在目标系统上创建一个反向shell连接到攻击者的监听器IP地址和端口。
3.  **编译：** 攻击者通过访问/compile-program端点触发C代码的编译。
4.  **启动PLC：** 攻击者访问/start_plc端点启动PLC，这将执行编译后的恶意代码，从而建立反向shell。
5.  **停止PLC：**  攻击者访问/stop_plc端点停止PLC。停止PLC不是必须的操作，因为反向shell一旦建立，就会保持连接，即使PLC停止运行。

**有效性：**

提供的PoC代码看起来是有效的。它包含了必要的步骤，如身份验证、上传恶意C文件、编译、启动PLC和停止PLC。代码中使用的反向shell技术是一种常见的利用远程命令执行漏洞的方式。

**投毒风险：**

PoC代码本身没有明显的投毒行为。`exploit.py`脚本的主要功能是自动化漏洞利用过程，没有发现任何会损害攻击者自身或其他用户的恶意代码。恶意行为都集中在创建反向shell，利用目标机器，没有迹象表明会影响到攻击者或其他人, 投毒风险可能性为0%。

**项目地址:** [FlojBoj/CVE-2021-31630](https://github.com/FlojBoj/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #2

**来源**: [CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md](../2021/CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md)

## CVE-2021-31630 - OpenPLC Webserver v3 命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，允许远程攻击者通过“Hardware Layer Code Box”组件执行任意代码。利用方式如下：

1.  **身份验证：** 使用提供的用户名和密码登录OpenPLC Webserver。
2.  **构造恶意请求：** 构造一个包含恶意代码的multipart/form-data请求，该代码会被插入到“Hardware Layer Code Box”中。  `exploit.py` 脚本将一个反向shell的C代码注入到`custom_layer_code`字段中，该反向shell连接攻击者指定的IP地址和端口。
3.  **发送请求：** 将构造的请求发送到/hardware页面。
4.  **触发编译：** 访问/compile-program?file=blank_program.st页面触发代码编译。
5.  **代码执行：**  编译过程会执行注入的恶意代码，从而建立一个反向shell连接，允许攻击者在目标系统上执行任意命令。

**投毒风险分析：**

代码中包含`# FUCK ISRAEL`的注释，这表明作者可能存在政治倾向，但这并不构成技术上的投毒。`exploit.py`脚本本身实现了漏洞利用的功能，没有发现隐藏的恶意代码或后门。它执行的操作完全符合漏洞描述和利用目的。因此，投毒风险评估为0%。需要说明的是，利用漏洞本身就是在目标系统上植入后门，但是这属于漏洞利用的范畴，不属于投毒。

**项目地址:** [Hunt3r0x/CVE-2021-31630-HTB](https://github.com/Hunt3r0x/CVE-2021-31630-HTB)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #3

**来源**: [CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md](../2021/CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要网络访问OpenPLC Webserver的`/hardware`页面，默认用户名密码openplc/openplc

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。远程攻击者可以通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件利用此漏洞执行任意代码。

**有效性分析：**

从提供的漏洞信息、搜索引擎结果以及漏洞利用代码来看，该漏洞是真实存在的，并且存在公开的PoC利用代码。搜索引擎结果中多个链接指向了漏洞的详细信息，包括NVD、Red Hat、Mitre等权威机构的描述。提供的PoC代码是一个Python脚本，它自动化了利用该漏洞的过程，包括登录OpenPLC、构造包含反弹shell的恶意payload、上传payload以及触发漏洞，从而实现远程代码执行。

**投毒风险分析：**

对PoC代码进行分析后，虽然脚本本身是为了演示漏洞利用，但在以下几个方面存在潜在的投毒风险：

1.  **payload定制：** 脚本允许用户自定义反弹shell的IP地址和端口。虽然这本身是正常功能，但如果攻击者恶意修改脚本，例如硬编码一个恶意IP地址，然后传播该修改后的脚本，则可能导致其他用户在不知情的情况下将shell反弹到攻击者的服务器。
2.  **依赖项风险：** 脚本依赖于`requests`库。如果攻击者篡改了`requests`库，或者诱骗用户安装恶意版本，则可能在用户运行脚本时执行恶意代码。
3.  **脚本行为的混淆：** 通过仔细阅读脚本，可以理解其行为。但是，如果攻击者对脚本进行混淆或修改，使其行为更难以理解，则可能诱骗用户在不知情的情况下运行恶意代码。

尽管存在这些风险，但脚本的主要功能是实现漏洞利用，没有发现明显的恶意代码。因此，可以认为投毒风险较低，大约为1%。

**漏洞利用方式：**

1.  **身份验证：**  利用PoC提供的用户名和密码或者爆破用户名和密码，访问OpenPLC Webserver的`/hardware`页面。
2.  **构造Payload：**  构造包含恶意命令的Payload，该命令通常用于执行反弹shell，建立与攻击者控制的服务器的连接。
3.  **上传Payload：**  将构造的Payload上传到 `/hardware` 页面的 "Hardware Layer Code Box" 组件中。
4.  **触发漏洞：**  通过尝试编译上传的恶意代码，触发命令注入漏洞。这将导致服务器执行Payload中的恶意命令，从而建立反弹shell，允许攻击者远程控制OpenPLC Webserver所在的系统。

**项目地址:** [behindsecurity/htb-wifinetictwo-exploit](https://github.com/behindsecurity/htb-wifinetictwo-exploit)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #4

**来源**: [CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md](../2021/CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3 远程代码执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可被远程攻击者利用执行任意代码。

**影响版本:** v3

**利用条件:** 需要身份验证，以及访问`/hardware`页面'Hardware Layer Code Box'组件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。远程攻击者可以通过`/hardware`页面的"Hardware Layer Code Box"组件利用此漏洞执行任意代码。根据搜索引擎结果，已经存在公开的漏洞利用脚本（例如，thewhiteh4t/cve-2021-31630），表明该漏洞具有较高的可利用性。提供的POC代码是一个README.md文件，描述了漏洞利用脚本的存在，但并未提供实际的利用代码。因此，无法直接评估其有效性，需要进一步获取并分析脚本。仓库中可能存在作者隐藏的投毒代码，但根据readme文件内容，风险较小。 利用方式：攻击者首先需要通过身份验证访问OpenPLC Webserver v3的web界面，然后导航到`/hardware`页面，在"Hardware Layer Code Box"组件中输入恶意命令。由于该组件没有充分的输入验证，恶意命令会被服务器执行，导致远程代码执行。

**项目地址:** [hev0x/CVE-2021-31630-OpenPLC_RCE](https://github.com/hev0x/CVE-2021-31630-OpenPLC_RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #5

**来源**: [CVE-2021-31630-junnythemarksman_CVE-2021-31630.md](../2021/CVE-2021-31630-junnythemarksman_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要目标系统开启OpenPLC Webserver v3，攻击者需要具有有效的管理员账户密码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。攻击者可以利用"Hardware Layer Code Box"组件，通过 `/hardware` 页面执行任意代码。 

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录 OpenPLC Webserver v3。
2.  **上传恶意程序：** 使用提供的exploit.py脚本，该脚本首先尝试使用提供的凭据进行身份验证。成功登录后，它将包含反向 shell 命令的恶意 PLC 程序上传到服务器，这个PLC程序会被上传到programs目录中。
3.  **编译恶意程序：** 脚本接着会请求编译上传的程序。
4.  **运行PLC服务：** 脚本会启动 PLC 服务，从而触发命令注入。

该漏洞利用脚本通过修改 Fellipe Oliveira 提供的 PoC 代码实现，允许远程攻击者在 OpenPLC Webserver v3 上执行任意代码。

**投毒风险分析：**

该POC脚本本身存在一定的投毒风险，因为脚本的功能是上传并执行PLC程序，该程序的内容完全由攻击者控制。虽然目前的POC代码中没有明显的恶意行为，但攻击者可以很容易地修改`upload_data`变量，植入恶意的代码来执行任何操作，例如删除文件，修改配置等。由于该脚本需要身份验证才能利用，因此只有具有有效凭据的用户才能触发该漏洞，从而降低了投毒风险。但是，一旦凭据泄露，攻击者就可以完全控制系统。综合评估，投毒风险为10%。

**项目地址:** [junnythemarksman/CVE-2021-31630](https://github.com/junnythemarksman/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #6

**来源**: [CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md](../2021/CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要身份验证，且目标服务器上的OpenPLC Webserver v3运行在可访问的网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者可以通过 "Hardware Layer Code Box" 组件，在 `/hardware` 页面上，执行任意代码。该漏洞利用方式如下：

1.  **目标探测：**  首先需要确定目标OpenPLC Webserver v3服务器是否可达。
2.  **身份验证：**  使用默认凭据（openplc/openplc）或已知的有效凭据登录到OpenPLC Webserver。
3.  **Payload构建：**  利用代码构建一个包含反向shell的恶意C代码，该代码会被注入到“Hardware Layer Code Box”。反向shell连接到攻击者的机器。
4.  **Payload上传：**  将构建的payload上传到 `/hardware` 页面，覆盖 custom layer code.
5.  **程序编译：**  访问 `/compile-program?file=blank_program.st` 触发程序编译。
6.  **启动PLC：**  访问 `/start_plc` 以启动PLC，这将触发payload的执行，从而建立反向shell。
7.  **清理（可选）：**  为了避免留下痕迹，可以停止PLC并恢复自定义硬件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用POC代码的有效性高。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出攻击者可以通过特定的页面和组件执行任意代码。提供的Python POC代码实现了完整的攻击流程，包括身份验证、payload构建、上传、编译和PLC启动，从而获得反向shell。

**投毒风险分析：**

提供的POC代码的主要功能是利用命令注入漏洞，在目标系统上执行任意代码，从而获取反向shell。代码中构建了一个C语言payload，该payload的功能是创建一个反向shell连接到攻击者指定的IP地址和端口。审查代码并没有发现作者隐藏的恶意代码或者后门，例如删除文件、篡改系统配置或者进行其他未经授权的操作。因此，可以认为此仓库中不存在作者隐藏的投毒代码, 风险为0%。

**项目地址:** [machevalia/OpenPLC-CVE-2021-31630-RCE](https://github.com/machevalia/OpenPLC-CVE-2021-31630-RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #7

**来源**: [CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md](../2021/CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md)

# CVE-2021-31630

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-31630-FlojBoj_CVE-2021-31630.md](../2021/CVE-2021-31630-FlojBoj_CVE-2021-31630.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 远程命令执行

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者能够访问/hardware页面，并拥有有效的用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，OpenPLC Webserver v3 存在一个远程命令执行漏洞（CVE-2021-31630），攻击者可以通过“Hardware Layer Code Box”组件，在/hardware页面上执行任意代码。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录OpenPLC Webserver v3。
2.  **上传恶意C文件：** 攻击者将包含反向shell的恶意C代码上传到“Hardware Layer Code Box”组件。该代码会在目标系统上创建一个反向shell连接到攻击者的监听器IP地址和端口。
3.  **编译：** 攻击者通过访问/compile-program端点触发C代码的编译。
4.  **启动PLC：** 攻击者访问/start_plc端点启动PLC，这将执行编译后的恶意代码，从而建立反向shell。
5.  **停止PLC：**  攻击者访问/stop_plc端点停止PLC。停止PLC不是必须的操作，因为反向shell一旦建立，就会保持连接，即使PLC停止运行。

**有效性：**

提供的PoC代码看起来是有效的。它包含了必要的步骤，如身份验证、上传恶意C文件、编译、启动PLC和停止PLC。代码中使用的反向shell技术是一种常见的利用远程命令执行漏洞的方式。

**投毒风险：**

PoC代码本身没有明显的投毒行为。`exploit.py`脚本的主要功能是自动化漏洞利用过程，没有发现任何会损害攻击者自身或其他用户的恶意代码。恶意行为都集中在创建反向shell，利用目标机器，没有迹象表明会影响到攻击者或其他人, 投毒风险可能性为0%。

**项目地址:** [FlojBoj/CVE-2021-31630](https://github.com/FlojBoj/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #2

**来源**: [CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md](../2021/CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md)

## CVE-2021-31630 - OpenPLC Webserver v3 命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，允许远程攻击者通过“Hardware Layer Code Box”组件执行任意代码。利用方式如下：

1.  **身份验证：** 使用提供的用户名和密码登录OpenPLC Webserver。
2.  **构造恶意请求：** 构造一个包含恶意代码的multipart/form-data请求，该代码会被插入到“Hardware Layer Code Box”中。  `exploit.py` 脚本将一个反向shell的C代码注入到`custom_layer_code`字段中，该反向shell连接攻击者指定的IP地址和端口。
3.  **发送请求：** 将构造的请求发送到/hardware页面。
4.  **触发编译：** 访问/compile-program?file=blank_program.st页面触发代码编译。
5.  **代码执行：**  编译过程会执行注入的恶意代码，从而建立一个反向shell连接，允许攻击者在目标系统上执行任意命令。

**投毒风险分析：**

代码中包含`# FUCK ISRAEL`的注释，这表明作者可能存在政治倾向，但这并不构成技术上的投毒。`exploit.py`脚本本身实现了漏洞利用的功能，没有发现隐藏的恶意代码或后门。它执行的操作完全符合漏洞描述和利用目的。因此，投毒风险评估为0%。需要说明的是，利用漏洞本身就是在目标系统上植入后门，但是这属于漏洞利用的范畴，不属于投毒。

**项目地址:** [Hunt3r0x/CVE-2021-31630-HTB](https://github.com/Hunt3r0x/CVE-2021-31630-HTB)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #3

**来源**: [CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md](../2021/CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要网络访问OpenPLC Webserver的`/hardware`页面，默认用户名密码openplc/openplc

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。远程攻击者可以通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件利用此漏洞执行任意代码。

**有效性分析：**

从提供的漏洞信息、搜索引擎结果以及漏洞利用代码来看，该漏洞是真实存在的，并且存在公开的PoC利用代码。搜索引擎结果中多个链接指向了漏洞的详细信息，包括NVD、Red Hat、Mitre等权威机构的描述。提供的PoC代码是一个Python脚本，它自动化了利用该漏洞的过程，包括登录OpenPLC、构造包含反弹shell的恶意payload、上传payload以及触发漏洞，从而实现远程代码执行。

**投毒风险分析：**

对PoC代码进行分析后，虽然脚本本身是为了演示漏洞利用，但在以下几个方面存在潜在的投毒风险：

1.  **payload定制：** 脚本允许用户自定义反弹shell的IP地址和端口。虽然这本身是正常功能，但如果攻击者恶意修改脚本，例如硬编码一个恶意IP地址，然后传播该修改后的脚本，则可能导致其他用户在不知情的情况下将shell反弹到攻击者的服务器。
2.  **依赖项风险：** 脚本依赖于`requests`库。如果攻击者篡改了`requests`库，或者诱骗用户安装恶意版本，则可能在用户运行脚本时执行恶意代码。
3.  **脚本行为的混淆：** 通过仔细阅读脚本，可以理解其行为。但是，如果攻击者对脚本进行混淆或修改，使其行为更难以理解，则可能诱骗用户在不知情的情况下运行恶意代码。

尽管存在这些风险，但脚本的主要功能是实现漏洞利用，没有发现明显的恶意代码。因此，可以认为投毒风险较低，大约为1%。

**漏洞利用方式：**

1.  **身份验证：**  利用PoC提供的用户名和密码或者爆破用户名和密码，访问OpenPLC Webserver的`/hardware`页面。
2.  **构造Payload：**  构造包含恶意命令的Payload，该命令通常用于执行反弹shell，建立与攻击者控制的服务器的连接。
3.  **上传Payload：**  将构造的Payload上传到 `/hardware` 页面的 "Hardware Layer Code Box" 组件中。
4.  **触发漏洞：**  通过尝试编译上传的恶意代码，触发命令注入漏洞。这将导致服务器执行Payload中的恶意命令，从而建立反弹shell，允许攻击者远程控制OpenPLC Webserver所在的系统。

**项目地址:** [behindsecurity/htb-wifinetictwo-exploit](https://github.com/behindsecurity/htb-wifinetictwo-exploit)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #4

**来源**: [CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md](../2021/CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3 远程代码执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可被远程攻击者利用执行任意代码。

**影响版本:** v3

**利用条件:** 需要身份验证，以及访问`/hardware`页面'Hardware Layer Code Box'组件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。远程攻击者可以通过`/hardware`页面的"Hardware Layer Code Box"组件利用此漏洞执行任意代码。根据搜索引擎结果，已经存在公开的漏洞利用脚本（例如，thewhiteh4t/cve-2021-31630），表明该漏洞具有较高的可利用性。提供的POC代码是一个README.md文件，描述了漏洞利用脚本的存在，但并未提供实际的利用代码。因此，无法直接评估其有效性，需要进一步获取并分析脚本。仓库中可能存在作者隐藏的投毒代码，但根据readme文件内容，风险较小。 利用方式：攻击者首先需要通过身份验证访问OpenPLC Webserver v3的web界面，然后导航到`/hardware`页面，在"Hardware Layer Code Box"组件中输入恶意命令。由于该组件没有充分的输入验证，恶意命令会被服务器执行，导致远程代码执行。

**项目地址:** [hev0x/CVE-2021-31630-OpenPLC_RCE](https://github.com/hev0x/CVE-2021-31630-OpenPLC_RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #5

**来源**: [CVE-2021-31630-junnythemarksman_CVE-2021-31630.md](../2021/CVE-2021-31630-junnythemarksman_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要目标系统开启OpenPLC Webserver v3，攻击者需要具有有效的管理员账户密码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。攻击者可以利用"Hardware Layer Code Box"组件，通过 `/hardware` 页面执行任意代码。 

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录 OpenPLC Webserver v3。
2.  **上传恶意程序：** 使用提供的exploit.py脚本，该脚本首先尝试使用提供的凭据进行身份验证。成功登录后，它将包含反向 shell 命令的恶意 PLC 程序上传到服务器，这个PLC程序会被上传到programs目录中。
3.  **编译恶意程序：** 脚本接着会请求编译上传的程序。
4.  **运行PLC服务：** 脚本会启动 PLC 服务，从而触发命令注入。

该漏洞利用脚本通过修改 Fellipe Oliveira 提供的 PoC 代码实现，允许远程攻击者在 OpenPLC Webserver v3 上执行任意代码。

**投毒风险分析：**

该POC脚本本身存在一定的投毒风险，因为脚本的功能是上传并执行PLC程序，该程序的内容完全由攻击者控制。虽然目前的POC代码中没有明显的恶意行为，但攻击者可以很容易地修改`upload_data`变量，植入恶意的代码来执行任何操作，例如删除文件，修改配置等。由于该脚本需要身份验证才能利用，因此只有具有有效凭据的用户才能触发该漏洞，从而降低了投毒风险。但是，一旦凭据泄露，攻击者就可以完全控制系统。综合评估，投毒风险为10%。

**项目地址:** [junnythemarksman/CVE-2021-31630](https://github.com/junnythemarksman/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #6

**来源**: [CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md](../2021/CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要身份验证，且目标服务器上的OpenPLC Webserver v3运行在可访问的网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者可以通过 "Hardware Layer Code Box" 组件，在 `/hardware` 页面上，执行任意代码。该漏洞利用方式如下：

1.  **目标探测：**  首先需要确定目标OpenPLC Webserver v3服务器是否可达。
2.  **身份验证：**  使用默认凭据（openplc/openplc）或已知的有效凭据登录到OpenPLC Webserver。
3.  **Payload构建：**  利用代码构建一个包含反向shell的恶意C代码，该代码会被注入到“Hardware Layer Code Box”。反向shell连接到攻击者的机器。
4.  **Payload上传：**  将构建的payload上传到 `/hardware` 页面，覆盖 custom layer code.
5.  **程序编译：**  访问 `/compile-program?file=blank_program.st` 触发程序编译。
6.  **启动PLC：**  访问 `/start_plc` 以启动PLC，这将触发payload的执行，从而建立反向shell。
7.  **清理（可选）：**  为了避免留下痕迹，可以停止PLC并恢复自定义硬件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用POC代码的有效性高。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出攻击者可以通过特定的页面和组件执行任意代码。提供的Python POC代码实现了完整的攻击流程，包括身份验证、payload构建、上传、编译和PLC启动，从而获得反向shell。

**投毒风险分析：**

提供的POC代码的主要功能是利用命令注入漏洞，在目标系统上执行任意代码，从而获取反向shell。代码中构建了一个C语言payload，该payload的功能是创建一个反向shell连接到攻击者指定的IP地址和端口。审查代码并没有发现作者隐藏的恶意代码或者后门，例如删除文件、篡改系统配置或者进行其他未经授权的操作。因此，可以认为此仓库中不存在作者隐藏的投毒代码, 风险为0%。

**项目地址:** [machevalia/OpenPLC-CVE-2021-31630-RCE](https://github.com/machevalia/OpenPLC-CVE-2021-31630-RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #7

**来源**: [CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md](../2021/CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md)

# CVE-2021-31630

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-31630-FlojBoj_CVE-2021-31630.md](../2021/CVE-2021-31630-FlojBoj_CVE-2021-31630.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 远程命令执行

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者能够访问/hardware页面，并拥有有效的用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，OpenPLC Webserver v3 存在一个远程命令执行漏洞（CVE-2021-31630），攻击者可以通过“Hardware Layer Code Box”组件，在/hardware页面上执行任意代码。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录OpenPLC Webserver v3。
2.  **上传恶意C文件：** 攻击者将包含反向shell的恶意C代码上传到“Hardware Layer Code Box”组件。该代码会在目标系统上创建一个反向shell连接到攻击者的监听器IP地址和端口。
3.  **编译：** 攻击者通过访问/compile-program端点触发C代码的编译。
4.  **启动PLC：** 攻击者访问/start_plc端点启动PLC，这将执行编译后的恶意代码，从而建立反向shell。
5.  **停止PLC：**  攻击者访问/stop_plc端点停止PLC。停止PLC不是必须的操作，因为反向shell一旦建立，就会保持连接，即使PLC停止运行。

**有效性：**

提供的PoC代码看起来是有效的。它包含了必要的步骤，如身份验证、上传恶意C文件、编译、启动PLC和停止PLC。代码中使用的反向shell技术是一种常见的利用远程命令执行漏洞的方式。

**投毒风险：**

PoC代码本身没有明显的投毒行为。`exploit.py`脚本的主要功能是自动化漏洞利用过程，没有发现任何会损害攻击者自身或其他用户的恶意代码。恶意行为都集中在创建反向shell，利用目标机器，没有迹象表明会影响到攻击者或其他人, 投毒风险可能性为0%。

**项目地址:** [FlojBoj/CVE-2021-31630](https://github.com/FlojBoj/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #2

**来源**: [CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md](../2021/CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md)

## CVE-2021-31630 - OpenPLC Webserver v3 命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，允许远程攻击者通过“Hardware Layer Code Box”组件执行任意代码。利用方式如下：

1.  **身份验证：** 使用提供的用户名和密码登录OpenPLC Webserver。
2.  **构造恶意请求：** 构造一个包含恶意代码的multipart/form-data请求，该代码会被插入到“Hardware Layer Code Box”中。  `exploit.py` 脚本将一个反向shell的C代码注入到`custom_layer_code`字段中，该反向shell连接攻击者指定的IP地址和端口。
3.  **发送请求：** 将构造的请求发送到/hardware页面。
4.  **触发编译：** 访问/compile-program?file=blank_program.st页面触发代码编译。
5.  **代码执行：**  编译过程会执行注入的恶意代码，从而建立一个反向shell连接，允许攻击者在目标系统上执行任意命令。

**投毒风险分析：**

代码中包含`# FUCK ISRAEL`的注释，这表明作者可能存在政治倾向，但这并不构成技术上的投毒。`exploit.py`脚本本身实现了漏洞利用的功能，没有发现隐藏的恶意代码或后门。它执行的操作完全符合漏洞描述和利用目的。因此，投毒风险评估为0%。需要说明的是，利用漏洞本身就是在目标系统上植入后门，但是这属于漏洞利用的范畴，不属于投毒。

**项目地址:** [Hunt3r0x/CVE-2021-31630-HTB](https://github.com/Hunt3r0x/CVE-2021-31630-HTB)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #3

**来源**: [CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md](../2021/CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要网络访问OpenPLC Webserver的`/hardware`页面，默认用户名密码openplc/openplc

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。远程攻击者可以通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件利用此漏洞执行任意代码。

**有效性分析：**

从提供的漏洞信息、搜索引擎结果以及漏洞利用代码来看，该漏洞是真实存在的，并且存在公开的PoC利用代码。搜索引擎结果中多个链接指向了漏洞的详细信息，包括NVD、Red Hat、Mitre等权威机构的描述。提供的PoC代码是一个Python脚本，它自动化了利用该漏洞的过程，包括登录OpenPLC、构造包含反弹shell的恶意payload、上传payload以及触发漏洞，从而实现远程代码执行。

**投毒风险分析：**

对PoC代码进行分析后，虽然脚本本身是为了演示漏洞利用，但在以下几个方面存在潜在的投毒风险：

1.  **payload定制：** 脚本允许用户自定义反弹shell的IP地址和端口。虽然这本身是正常功能，但如果攻击者恶意修改脚本，例如硬编码一个恶意IP地址，然后传播该修改后的脚本，则可能导致其他用户在不知情的情况下将shell反弹到攻击者的服务器。
2.  **依赖项风险：** 脚本依赖于`requests`库。如果攻击者篡改了`requests`库，或者诱骗用户安装恶意版本，则可能在用户运行脚本时执行恶意代码。
3.  **脚本行为的混淆：** 通过仔细阅读脚本，可以理解其行为。但是，如果攻击者对脚本进行混淆或修改，使其行为更难以理解，则可能诱骗用户在不知情的情况下运行恶意代码。

尽管存在这些风险，但脚本的主要功能是实现漏洞利用，没有发现明显的恶意代码。因此，可以认为投毒风险较低，大约为1%。

**漏洞利用方式：**

1.  **身份验证：**  利用PoC提供的用户名和密码或者爆破用户名和密码，访问OpenPLC Webserver的`/hardware`页面。
2.  **构造Payload：**  构造包含恶意命令的Payload，该命令通常用于执行反弹shell，建立与攻击者控制的服务器的连接。
3.  **上传Payload：**  将构造的Payload上传到 `/hardware` 页面的 "Hardware Layer Code Box" 组件中。
4.  **触发漏洞：**  通过尝试编译上传的恶意代码，触发命令注入漏洞。这将导致服务器执行Payload中的恶意命令，从而建立反弹shell，允许攻击者远程控制OpenPLC Webserver所在的系统。

**项目地址:** [behindsecurity/htb-wifinetictwo-exploit](https://github.com/behindsecurity/htb-wifinetictwo-exploit)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #4

**来源**: [CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md](../2021/CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3 远程代码执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可被远程攻击者利用执行任意代码。

**影响版本:** v3

**利用条件:** 需要身份验证，以及访问`/hardware`页面'Hardware Layer Code Box'组件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。远程攻击者可以通过`/hardware`页面的"Hardware Layer Code Box"组件利用此漏洞执行任意代码。根据搜索引擎结果，已经存在公开的漏洞利用脚本（例如，thewhiteh4t/cve-2021-31630），表明该漏洞具有较高的可利用性。提供的POC代码是一个README.md文件，描述了漏洞利用脚本的存在，但并未提供实际的利用代码。因此，无法直接评估其有效性，需要进一步获取并分析脚本。仓库中可能存在作者隐藏的投毒代码，但根据readme文件内容，风险较小。 利用方式：攻击者首先需要通过身份验证访问OpenPLC Webserver v3的web界面，然后导航到`/hardware`页面，在"Hardware Layer Code Box"组件中输入恶意命令。由于该组件没有充分的输入验证，恶意命令会被服务器执行，导致远程代码执行。

**项目地址:** [hev0x/CVE-2021-31630-OpenPLC_RCE](https://github.com/hev0x/CVE-2021-31630-OpenPLC_RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #5

**来源**: [CVE-2021-31630-junnythemarksman_CVE-2021-31630.md](../2021/CVE-2021-31630-junnythemarksman_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要目标系统开启OpenPLC Webserver v3，攻击者需要具有有效的管理员账户密码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。攻击者可以利用"Hardware Layer Code Box"组件，通过 `/hardware` 页面执行任意代码。 

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录 OpenPLC Webserver v3。
2.  **上传恶意程序：** 使用提供的exploit.py脚本，该脚本首先尝试使用提供的凭据进行身份验证。成功登录后，它将包含反向 shell 命令的恶意 PLC 程序上传到服务器，这个PLC程序会被上传到programs目录中。
3.  **编译恶意程序：** 脚本接着会请求编译上传的程序。
4.  **运行PLC服务：** 脚本会启动 PLC 服务，从而触发命令注入。

该漏洞利用脚本通过修改 Fellipe Oliveira 提供的 PoC 代码实现，允许远程攻击者在 OpenPLC Webserver v3 上执行任意代码。

**投毒风险分析：**

该POC脚本本身存在一定的投毒风险，因为脚本的功能是上传并执行PLC程序，该程序的内容完全由攻击者控制。虽然目前的POC代码中没有明显的恶意行为，但攻击者可以很容易地修改`upload_data`变量，植入恶意的代码来执行任何操作，例如删除文件，修改配置等。由于该脚本需要身份验证才能利用，因此只有具有有效凭据的用户才能触发该漏洞，从而降低了投毒风险。但是，一旦凭据泄露，攻击者就可以完全控制系统。综合评估，投毒风险为10%。

**项目地址:** [junnythemarksman/CVE-2021-31630](https://github.com/junnythemarksman/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #6

**来源**: [CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md](../2021/CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要身份验证，且目标服务器上的OpenPLC Webserver v3运行在可访问的网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者可以通过 "Hardware Layer Code Box" 组件，在 `/hardware` 页面上，执行任意代码。该漏洞利用方式如下：

1.  **目标探测：**  首先需要确定目标OpenPLC Webserver v3服务器是否可达。
2.  **身份验证：**  使用默认凭据（openplc/openplc）或已知的有效凭据登录到OpenPLC Webserver。
3.  **Payload构建：**  利用代码构建一个包含反向shell的恶意C代码，该代码会被注入到“Hardware Layer Code Box”。反向shell连接到攻击者的机器。
4.  **Payload上传：**  将构建的payload上传到 `/hardware` 页面，覆盖 custom layer code.
5.  **程序编译：**  访问 `/compile-program?file=blank_program.st` 触发程序编译。
6.  **启动PLC：**  访问 `/start_plc` 以启动PLC，这将触发payload的执行，从而建立反向shell。
7.  **清理（可选）：**  为了避免留下痕迹，可以停止PLC并恢复自定义硬件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用POC代码的有效性高。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出攻击者可以通过特定的页面和组件执行任意代码。提供的Python POC代码实现了完整的攻击流程，包括身份验证、payload构建、上传、编译和PLC启动，从而获得反向shell。

**投毒风险分析：**

提供的POC代码的主要功能是利用命令注入漏洞，在目标系统上执行任意代码，从而获取反向shell。代码中构建了一个C语言payload，该payload的功能是创建一个反向shell连接到攻击者指定的IP地址和端口。审查代码并没有发现作者隐藏的恶意代码或者后门，例如删除文件、篡改系统配置或者进行其他未经授权的操作。因此，可以认为此仓库中不存在作者隐藏的投毒代码, 风险为0%。

**项目地址:** [machevalia/OpenPLC-CVE-2021-31630-RCE](https://github.com/machevalia/OpenPLC-CVE-2021-31630-RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #7

**来源**: [CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md](../2021/CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md)

# CVE-2021-31630

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-31630-FlojBoj_CVE-2021-31630.md](../2021/CVE-2021-31630-FlojBoj_CVE-2021-31630.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 远程命令执行

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者能够访问/hardware页面，并拥有有效的用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，OpenPLC Webserver v3 存在一个远程命令执行漏洞（CVE-2021-31630），攻击者可以通过“Hardware Layer Code Box”组件，在/hardware页面上执行任意代码。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录OpenPLC Webserver v3。
2.  **上传恶意C文件：** 攻击者将包含反向shell的恶意C代码上传到“Hardware Layer Code Box”组件。该代码会在目标系统上创建一个反向shell连接到攻击者的监听器IP地址和端口。
3.  **编译：** 攻击者通过访问/compile-program端点触发C代码的编译。
4.  **启动PLC：** 攻击者访问/start_plc端点启动PLC，这将执行编译后的恶意代码，从而建立反向shell。
5.  **停止PLC：**  攻击者访问/stop_plc端点停止PLC。停止PLC不是必须的操作，因为反向shell一旦建立，就会保持连接，即使PLC停止运行。

**有效性：**

提供的PoC代码看起来是有效的。它包含了必要的步骤，如身份验证、上传恶意C文件、编译、启动PLC和停止PLC。代码中使用的反向shell技术是一种常见的利用远程命令执行漏洞的方式。

**投毒风险：**

PoC代码本身没有明显的投毒行为。`exploit.py`脚本的主要功能是自动化漏洞利用过程，没有发现任何会损害攻击者自身或其他用户的恶意代码。恶意行为都集中在创建反向shell，利用目标机器，没有迹象表明会影响到攻击者或其他人, 投毒风险可能性为0%。

**项目地址:** [FlojBoj/CVE-2021-31630](https://github.com/FlojBoj/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #2

**来源**: [CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md](../2021/CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md)

## CVE-2021-31630 - OpenPLC Webserver v3 命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，允许远程攻击者通过“Hardware Layer Code Box”组件执行任意代码。利用方式如下：

1.  **身份验证：** 使用提供的用户名和密码登录OpenPLC Webserver。
2.  **构造恶意请求：** 构造一个包含恶意代码的multipart/form-data请求，该代码会被插入到“Hardware Layer Code Box”中。  `exploit.py` 脚本将一个反向shell的C代码注入到`custom_layer_code`字段中，该反向shell连接攻击者指定的IP地址和端口。
3.  **发送请求：** 将构造的请求发送到/hardware页面。
4.  **触发编译：** 访问/compile-program?file=blank_program.st页面触发代码编译。
5.  **代码执行：**  编译过程会执行注入的恶意代码，从而建立一个反向shell连接，允许攻击者在目标系统上执行任意命令。

**投毒风险分析：**

代码中包含`# FUCK ISRAEL`的注释，这表明作者可能存在政治倾向，但这并不构成技术上的投毒。`exploit.py`脚本本身实现了漏洞利用的功能，没有发现隐藏的恶意代码或后门。它执行的操作完全符合漏洞描述和利用目的。因此，投毒风险评估为0%。需要说明的是，利用漏洞本身就是在目标系统上植入后门，但是这属于漏洞利用的范畴，不属于投毒。

**项目地址:** [Hunt3r0x/CVE-2021-31630-HTB](https://github.com/Hunt3r0x/CVE-2021-31630-HTB)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #3

**来源**: [CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md](../2021/CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要网络访问OpenPLC Webserver的`/hardware`页面，默认用户名密码openplc/openplc

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。远程攻击者可以通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件利用此漏洞执行任意代码。

**有效性分析：**

从提供的漏洞信息、搜索引擎结果以及漏洞利用代码来看，该漏洞是真实存在的，并且存在公开的PoC利用代码。搜索引擎结果中多个链接指向了漏洞的详细信息，包括NVD、Red Hat、Mitre等权威机构的描述。提供的PoC代码是一个Python脚本，它自动化了利用该漏洞的过程，包括登录OpenPLC、构造包含反弹shell的恶意payload、上传payload以及触发漏洞，从而实现远程代码执行。

**投毒风险分析：**

对PoC代码进行分析后，虽然脚本本身是为了演示漏洞利用，但在以下几个方面存在潜在的投毒风险：

1.  **payload定制：** 脚本允许用户自定义反弹shell的IP地址和端口。虽然这本身是正常功能，但如果攻击者恶意修改脚本，例如硬编码一个恶意IP地址，然后传播该修改后的脚本，则可能导致其他用户在不知情的情况下将shell反弹到攻击者的服务器。
2.  **依赖项风险：** 脚本依赖于`requests`库。如果攻击者篡改了`requests`库，或者诱骗用户安装恶意版本，则可能在用户运行脚本时执行恶意代码。
3.  **脚本行为的混淆：** 通过仔细阅读脚本，可以理解其行为。但是，如果攻击者对脚本进行混淆或修改，使其行为更难以理解，则可能诱骗用户在不知情的情况下运行恶意代码。

尽管存在这些风险，但脚本的主要功能是实现漏洞利用，没有发现明显的恶意代码。因此，可以认为投毒风险较低，大约为1%。

**漏洞利用方式：**

1.  **身份验证：**  利用PoC提供的用户名和密码或者爆破用户名和密码，访问OpenPLC Webserver的`/hardware`页面。
2.  **构造Payload：**  构造包含恶意命令的Payload，该命令通常用于执行反弹shell，建立与攻击者控制的服务器的连接。
3.  **上传Payload：**  将构造的Payload上传到 `/hardware` 页面的 "Hardware Layer Code Box" 组件中。
4.  **触发漏洞：**  通过尝试编译上传的恶意代码，触发命令注入漏洞。这将导致服务器执行Payload中的恶意命令，从而建立反弹shell，允许攻击者远程控制OpenPLC Webserver所在的系统。

**项目地址:** [behindsecurity/htb-wifinetictwo-exploit](https://github.com/behindsecurity/htb-wifinetictwo-exploit)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #4

**来源**: [CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md](../2021/CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3 远程代码执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可被远程攻击者利用执行任意代码。

**影响版本:** v3

**利用条件:** 需要身份验证，以及访问`/hardware`页面'Hardware Layer Code Box'组件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。远程攻击者可以通过`/hardware`页面的"Hardware Layer Code Box"组件利用此漏洞执行任意代码。根据搜索引擎结果，已经存在公开的漏洞利用脚本（例如，thewhiteh4t/cve-2021-31630），表明该漏洞具有较高的可利用性。提供的POC代码是一个README.md文件，描述了漏洞利用脚本的存在，但并未提供实际的利用代码。因此，无法直接评估其有效性，需要进一步获取并分析脚本。仓库中可能存在作者隐藏的投毒代码，但根据readme文件内容，风险较小。 利用方式：攻击者首先需要通过身份验证访问OpenPLC Webserver v3的web界面，然后导航到`/hardware`页面，在"Hardware Layer Code Box"组件中输入恶意命令。由于该组件没有充分的输入验证，恶意命令会被服务器执行，导致远程代码执行。

**项目地址:** [hev0x/CVE-2021-31630-OpenPLC_RCE](https://github.com/hev0x/CVE-2021-31630-OpenPLC_RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #5

**来源**: [CVE-2021-31630-junnythemarksman_CVE-2021-31630.md](../2021/CVE-2021-31630-junnythemarksman_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要目标系统开启OpenPLC Webserver v3，攻击者需要具有有效的管理员账户密码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。攻击者可以利用"Hardware Layer Code Box"组件，通过 `/hardware` 页面执行任意代码。 

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录 OpenPLC Webserver v3。
2.  **上传恶意程序：** 使用提供的exploit.py脚本，该脚本首先尝试使用提供的凭据进行身份验证。成功登录后，它将包含反向 shell 命令的恶意 PLC 程序上传到服务器，这个PLC程序会被上传到programs目录中。
3.  **编译恶意程序：** 脚本接着会请求编译上传的程序。
4.  **运行PLC服务：** 脚本会启动 PLC 服务，从而触发命令注入。

该漏洞利用脚本通过修改 Fellipe Oliveira 提供的 PoC 代码实现，允许远程攻击者在 OpenPLC Webserver v3 上执行任意代码。

**投毒风险分析：**

该POC脚本本身存在一定的投毒风险，因为脚本的功能是上传并执行PLC程序，该程序的内容完全由攻击者控制。虽然目前的POC代码中没有明显的恶意行为，但攻击者可以很容易地修改`upload_data`变量，植入恶意的代码来执行任何操作，例如删除文件，修改配置等。由于该脚本需要身份验证才能利用，因此只有具有有效凭据的用户才能触发该漏洞，从而降低了投毒风险。但是，一旦凭据泄露，攻击者就可以完全控制系统。综合评估，投毒风险为10%。

**项目地址:** [junnythemarksman/CVE-2021-31630](https://github.com/junnythemarksman/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #6

**来源**: [CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md](../2021/CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要身份验证，且目标服务器上的OpenPLC Webserver v3运行在可访问的网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者可以通过 "Hardware Layer Code Box" 组件，在 `/hardware` 页面上，执行任意代码。该漏洞利用方式如下：

1.  **目标探测：**  首先需要确定目标OpenPLC Webserver v3服务器是否可达。
2.  **身份验证：**  使用默认凭据（openplc/openplc）或已知的有效凭据登录到OpenPLC Webserver。
3.  **Payload构建：**  利用代码构建一个包含反向shell的恶意C代码，该代码会被注入到“Hardware Layer Code Box”。反向shell连接到攻击者的机器。
4.  **Payload上传：**  将构建的payload上传到 `/hardware` 页面，覆盖 custom layer code.
5.  **程序编译：**  访问 `/compile-program?file=blank_program.st` 触发程序编译。
6.  **启动PLC：**  访问 `/start_plc` 以启动PLC，这将触发payload的执行，从而建立反向shell。
7.  **清理（可选）：**  为了避免留下痕迹，可以停止PLC并恢复自定义硬件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用POC代码的有效性高。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出攻击者可以通过特定的页面和组件执行任意代码。提供的Python POC代码实现了完整的攻击流程，包括身份验证、payload构建、上传、编译和PLC启动，从而获得反向shell。

**投毒风险分析：**

提供的POC代码的主要功能是利用命令注入漏洞，在目标系统上执行任意代码，从而获取反向shell。代码中构建了一个C语言payload，该payload的功能是创建一个反向shell连接到攻击者指定的IP地址和端口。审查代码并没有发现作者隐藏的恶意代码或者后门，例如删除文件、篡改系统配置或者进行其他未经授权的操作。因此，可以认为此仓库中不存在作者隐藏的投毒代码, 风险为0%。

**项目地址:** [machevalia/OpenPLC-CVE-2021-31630-RCE](https://github.com/machevalia/OpenPLC-CVE-2021-31630-RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #7

**来源**: [CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md](../2021/CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md)

# CVE-2021-31630

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-31630-FlojBoj_CVE-2021-31630.md](../2021/CVE-2021-31630-FlojBoj_CVE-2021-31630.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 远程命令执行

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者能够访问/hardware页面，并拥有有效的用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，OpenPLC Webserver v3 存在一个远程命令执行漏洞（CVE-2021-31630），攻击者可以通过“Hardware Layer Code Box”组件，在/hardware页面上执行任意代码。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录OpenPLC Webserver v3。
2.  **上传恶意C文件：** 攻击者将包含反向shell的恶意C代码上传到“Hardware Layer Code Box”组件。该代码会在目标系统上创建一个反向shell连接到攻击者的监听器IP地址和端口。
3.  **编译：** 攻击者通过访问/compile-program端点触发C代码的编译。
4.  **启动PLC：** 攻击者访问/start_plc端点启动PLC，这将执行编译后的恶意代码，从而建立反向shell。
5.  **停止PLC：**  攻击者访问/stop_plc端点停止PLC。停止PLC不是必须的操作，因为反向shell一旦建立，就会保持连接，即使PLC停止运行。

**有效性：**

提供的PoC代码看起来是有效的。它包含了必要的步骤，如身份验证、上传恶意C文件、编译、启动PLC和停止PLC。代码中使用的反向shell技术是一种常见的利用远程命令执行漏洞的方式。

**投毒风险：**

PoC代码本身没有明显的投毒行为。`exploit.py`脚本的主要功能是自动化漏洞利用过程，没有发现任何会损害攻击者自身或其他用户的恶意代码。恶意行为都集中在创建反向shell，利用目标机器，没有迹象表明会影响到攻击者或其他人, 投毒风险可能性为0%。

**项目地址:** [FlojBoj/CVE-2021-31630](https://github.com/FlojBoj/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #2

**来源**: [CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md](../2021/CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md)

## CVE-2021-31630 - OpenPLC Webserver v3 命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，允许远程攻击者通过“Hardware Layer Code Box”组件执行任意代码。利用方式如下：

1.  **身份验证：** 使用提供的用户名和密码登录OpenPLC Webserver。
2.  **构造恶意请求：** 构造一个包含恶意代码的multipart/form-data请求，该代码会被插入到“Hardware Layer Code Box”中。  `exploit.py` 脚本将一个反向shell的C代码注入到`custom_layer_code`字段中，该反向shell连接攻击者指定的IP地址和端口。
3.  **发送请求：** 将构造的请求发送到/hardware页面。
4.  **触发编译：** 访问/compile-program?file=blank_program.st页面触发代码编译。
5.  **代码执行：**  编译过程会执行注入的恶意代码，从而建立一个反向shell连接，允许攻击者在目标系统上执行任意命令。

**投毒风险分析：**

代码中包含`# FUCK ISRAEL`的注释，这表明作者可能存在政治倾向，但这并不构成技术上的投毒。`exploit.py`脚本本身实现了漏洞利用的功能，没有发现隐藏的恶意代码或后门。它执行的操作完全符合漏洞描述和利用目的。因此，投毒风险评估为0%。需要说明的是，利用漏洞本身就是在目标系统上植入后门，但是这属于漏洞利用的范畴，不属于投毒。

**项目地址:** [Hunt3r0x/CVE-2021-31630-HTB](https://github.com/Hunt3r0x/CVE-2021-31630-HTB)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #3

**来源**: [CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md](../2021/CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要网络访问OpenPLC Webserver的`/hardware`页面，默认用户名密码openplc/openplc

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。远程攻击者可以通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件利用此漏洞执行任意代码。

**有效性分析：**

从提供的漏洞信息、搜索引擎结果以及漏洞利用代码来看，该漏洞是真实存在的，并且存在公开的PoC利用代码。搜索引擎结果中多个链接指向了漏洞的详细信息，包括NVD、Red Hat、Mitre等权威机构的描述。提供的PoC代码是一个Python脚本，它自动化了利用该漏洞的过程，包括登录OpenPLC、构造包含反弹shell的恶意payload、上传payload以及触发漏洞，从而实现远程代码执行。

**投毒风险分析：**

对PoC代码进行分析后，虽然脚本本身是为了演示漏洞利用，但在以下几个方面存在潜在的投毒风险：

1.  **payload定制：** 脚本允许用户自定义反弹shell的IP地址和端口。虽然这本身是正常功能，但如果攻击者恶意修改脚本，例如硬编码一个恶意IP地址，然后传播该修改后的脚本，则可能导致其他用户在不知情的情况下将shell反弹到攻击者的服务器。
2.  **依赖项风险：** 脚本依赖于`requests`库。如果攻击者篡改了`requests`库，或者诱骗用户安装恶意版本，则可能在用户运行脚本时执行恶意代码。
3.  **脚本行为的混淆：** 通过仔细阅读脚本，可以理解其行为。但是，如果攻击者对脚本进行混淆或修改，使其行为更难以理解，则可能诱骗用户在不知情的情况下运行恶意代码。

尽管存在这些风险，但脚本的主要功能是实现漏洞利用，没有发现明显的恶意代码。因此，可以认为投毒风险较低，大约为1%。

**漏洞利用方式：**

1.  **身份验证：**  利用PoC提供的用户名和密码或者爆破用户名和密码，访问OpenPLC Webserver的`/hardware`页面。
2.  **构造Payload：**  构造包含恶意命令的Payload，该命令通常用于执行反弹shell，建立与攻击者控制的服务器的连接。
3.  **上传Payload：**  将构造的Payload上传到 `/hardware` 页面的 "Hardware Layer Code Box" 组件中。
4.  **触发漏洞：**  通过尝试编译上传的恶意代码，触发命令注入漏洞。这将导致服务器执行Payload中的恶意命令，从而建立反弹shell，允许攻击者远程控制OpenPLC Webserver所在的系统。

**项目地址:** [behindsecurity/htb-wifinetictwo-exploit](https://github.com/behindsecurity/htb-wifinetictwo-exploit)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #4

**来源**: [CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md](../2021/CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3 远程代码执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可被远程攻击者利用执行任意代码。

**影响版本:** v3

**利用条件:** 需要身份验证，以及访问`/hardware`页面'Hardware Layer Code Box'组件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。远程攻击者可以通过`/hardware`页面的"Hardware Layer Code Box"组件利用此漏洞执行任意代码。根据搜索引擎结果，已经存在公开的漏洞利用脚本（例如，thewhiteh4t/cve-2021-31630），表明该漏洞具有较高的可利用性。提供的POC代码是一个README.md文件，描述了漏洞利用脚本的存在，但并未提供实际的利用代码。因此，无法直接评估其有效性，需要进一步获取并分析脚本。仓库中可能存在作者隐藏的投毒代码，但根据readme文件内容，风险较小。 利用方式：攻击者首先需要通过身份验证访问OpenPLC Webserver v3的web界面，然后导航到`/hardware`页面，在"Hardware Layer Code Box"组件中输入恶意命令。由于该组件没有充分的输入验证，恶意命令会被服务器执行，导致远程代码执行。

**项目地址:** [hev0x/CVE-2021-31630-OpenPLC_RCE](https://github.com/hev0x/CVE-2021-31630-OpenPLC_RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #5

**来源**: [CVE-2021-31630-junnythemarksman_CVE-2021-31630.md](../2021/CVE-2021-31630-junnythemarksman_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要目标系统开启OpenPLC Webserver v3，攻击者需要具有有效的管理员账户密码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。攻击者可以利用"Hardware Layer Code Box"组件，通过 `/hardware` 页面执行任意代码。 

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录 OpenPLC Webserver v3。
2.  **上传恶意程序：** 使用提供的exploit.py脚本，该脚本首先尝试使用提供的凭据进行身份验证。成功登录后，它将包含反向 shell 命令的恶意 PLC 程序上传到服务器，这个PLC程序会被上传到programs目录中。
3.  **编译恶意程序：** 脚本接着会请求编译上传的程序。
4.  **运行PLC服务：** 脚本会启动 PLC 服务，从而触发命令注入。

该漏洞利用脚本通过修改 Fellipe Oliveira 提供的 PoC 代码实现，允许远程攻击者在 OpenPLC Webserver v3 上执行任意代码。

**投毒风险分析：**

该POC脚本本身存在一定的投毒风险，因为脚本的功能是上传并执行PLC程序，该程序的内容完全由攻击者控制。虽然目前的POC代码中没有明显的恶意行为，但攻击者可以很容易地修改`upload_data`变量，植入恶意的代码来执行任何操作，例如删除文件，修改配置等。由于该脚本需要身份验证才能利用，因此只有具有有效凭据的用户才能触发该漏洞，从而降低了投毒风险。但是，一旦凭据泄露，攻击者就可以完全控制系统。综合评估，投毒风险为10%。

**项目地址:** [junnythemarksman/CVE-2021-31630](https://github.com/junnythemarksman/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #6

**来源**: [CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md](../2021/CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要身份验证，且目标服务器上的OpenPLC Webserver v3运行在可访问的网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者可以通过 "Hardware Layer Code Box" 组件，在 `/hardware` 页面上，执行任意代码。该漏洞利用方式如下：

1.  **目标探测：**  首先需要确定目标OpenPLC Webserver v3服务器是否可达。
2.  **身份验证：**  使用默认凭据（openplc/openplc）或已知的有效凭据登录到OpenPLC Webserver。
3.  **Payload构建：**  利用代码构建一个包含反向shell的恶意C代码，该代码会被注入到“Hardware Layer Code Box”。反向shell连接到攻击者的机器。
4.  **Payload上传：**  将构建的payload上传到 `/hardware` 页面，覆盖 custom layer code.
5.  **程序编译：**  访问 `/compile-program?file=blank_program.st` 触发程序编译。
6.  **启动PLC：**  访问 `/start_plc` 以启动PLC，这将触发payload的执行，从而建立反向shell。
7.  **清理（可选）：**  为了避免留下痕迹，可以停止PLC并恢复自定义硬件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用POC代码的有效性高。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出攻击者可以通过特定的页面和组件执行任意代码。提供的Python POC代码实现了完整的攻击流程，包括身份验证、payload构建、上传、编译和PLC启动，从而获得反向shell。

**投毒风险分析：**

提供的POC代码的主要功能是利用命令注入漏洞，在目标系统上执行任意代码，从而获取反向shell。代码中构建了一个C语言payload，该payload的功能是创建一个反向shell连接到攻击者指定的IP地址和端口。审查代码并没有发现作者隐藏的恶意代码或者后门，例如删除文件、篡改系统配置或者进行其他未经授权的操作。因此，可以认为此仓库中不存在作者隐藏的投毒代码, 风险为0%。

**项目地址:** [machevalia/OpenPLC-CVE-2021-31630-RCE](https://github.com/machevalia/OpenPLC-CVE-2021-31630-RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #7

**来源**: [CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md](../2021/CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md)

# CVE-2021-31630

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-31630-FlojBoj_CVE-2021-31630.md](../2021/CVE-2021-31630-FlojBoj_CVE-2021-31630.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 远程命令执行

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者能够访问/hardware页面，并拥有有效的用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，OpenPLC Webserver v3 存在一个远程命令执行漏洞（CVE-2021-31630），攻击者可以通过“Hardware Layer Code Box”组件，在/hardware页面上执行任意代码。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录OpenPLC Webserver v3。
2.  **上传恶意C文件：** 攻击者将包含反向shell的恶意C代码上传到“Hardware Layer Code Box”组件。该代码会在目标系统上创建一个反向shell连接到攻击者的监听器IP地址和端口。
3.  **编译：** 攻击者通过访问/compile-program端点触发C代码的编译。
4.  **启动PLC：** 攻击者访问/start_plc端点启动PLC，这将执行编译后的恶意代码，从而建立反向shell。
5.  **停止PLC：**  攻击者访问/stop_plc端点停止PLC。停止PLC不是必须的操作，因为反向shell一旦建立，就会保持连接，即使PLC停止运行。

**有效性：**

提供的PoC代码看起来是有效的。它包含了必要的步骤，如身份验证、上传恶意C文件、编译、启动PLC和停止PLC。代码中使用的反向shell技术是一种常见的利用远程命令执行漏洞的方式。

**投毒风险：**

PoC代码本身没有明显的投毒行为。`exploit.py`脚本的主要功能是自动化漏洞利用过程，没有发现任何会损害攻击者自身或其他用户的恶意代码。恶意行为都集中在创建反向shell，利用目标机器，没有迹象表明会影响到攻击者或其他人, 投毒风险可能性为0%。

**项目地址:** [FlojBoj/CVE-2021-31630](https://github.com/FlojBoj/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #2

**来源**: [CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md](../2021/CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md)

## CVE-2021-31630 - OpenPLC Webserver v3 命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，允许远程攻击者通过“Hardware Layer Code Box”组件执行任意代码。利用方式如下：

1.  **身份验证：** 使用提供的用户名和密码登录OpenPLC Webserver。
2.  **构造恶意请求：** 构造一个包含恶意代码的multipart/form-data请求，该代码会被插入到“Hardware Layer Code Box”中。  `exploit.py` 脚本将一个反向shell的C代码注入到`custom_layer_code`字段中，该反向shell连接攻击者指定的IP地址和端口。
3.  **发送请求：** 将构造的请求发送到/hardware页面。
4.  **触发编译：** 访问/compile-program?file=blank_program.st页面触发代码编译。
5.  **代码执行：**  编译过程会执行注入的恶意代码，从而建立一个反向shell连接，允许攻击者在目标系统上执行任意命令。

**投毒风险分析：**

代码中包含`# FUCK ISRAEL`的注释，这表明作者可能存在政治倾向，但这并不构成技术上的投毒。`exploit.py`脚本本身实现了漏洞利用的功能，没有发现隐藏的恶意代码或后门。它执行的操作完全符合漏洞描述和利用目的。因此，投毒风险评估为0%。需要说明的是，利用漏洞本身就是在目标系统上植入后门，但是这属于漏洞利用的范畴，不属于投毒。

**项目地址:** [Hunt3r0x/CVE-2021-31630-HTB](https://github.com/Hunt3r0x/CVE-2021-31630-HTB)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #3

**来源**: [CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md](../2021/CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要网络访问OpenPLC Webserver的`/hardware`页面，默认用户名密码openplc/openplc

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。远程攻击者可以通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件利用此漏洞执行任意代码。

**有效性分析：**

从提供的漏洞信息、搜索引擎结果以及漏洞利用代码来看，该漏洞是真实存在的，并且存在公开的PoC利用代码。搜索引擎结果中多个链接指向了漏洞的详细信息，包括NVD、Red Hat、Mitre等权威机构的描述。提供的PoC代码是一个Python脚本，它自动化了利用该漏洞的过程，包括登录OpenPLC、构造包含反弹shell的恶意payload、上传payload以及触发漏洞，从而实现远程代码执行。

**投毒风险分析：**

对PoC代码进行分析后，虽然脚本本身是为了演示漏洞利用，但在以下几个方面存在潜在的投毒风险：

1.  **payload定制：** 脚本允许用户自定义反弹shell的IP地址和端口。虽然这本身是正常功能，但如果攻击者恶意修改脚本，例如硬编码一个恶意IP地址，然后传播该修改后的脚本，则可能导致其他用户在不知情的情况下将shell反弹到攻击者的服务器。
2.  **依赖项风险：** 脚本依赖于`requests`库。如果攻击者篡改了`requests`库，或者诱骗用户安装恶意版本，则可能在用户运行脚本时执行恶意代码。
3.  **脚本行为的混淆：** 通过仔细阅读脚本，可以理解其行为。但是，如果攻击者对脚本进行混淆或修改，使其行为更难以理解，则可能诱骗用户在不知情的情况下运行恶意代码。

尽管存在这些风险，但脚本的主要功能是实现漏洞利用，没有发现明显的恶意代码。因此，可以认为投毒风险较低，大约为1%。

**漏洞利用方式：**

1.  **身份验证：**  利用PoC提供的用户名和密码或者爆破用户名和密码，访问OpenPLC Webserver的`/hardware`页面。
2.  **构造Payload：**  构造包含恶意命令的Payload，该命令通常用于执行反弹shell，建立与攻击者控制的服务器的连接。
3.  **上传Payload：**  将构造的Payload上传到 `/hardware` 页面的 "Hardware Layer Code Box" 组件中。
4.  **触发漏洞：**  通过尝试编译上传的恶意代码，触发命令注入漏洞。这将导致服务器执行Payload中的恶意命令，从而建立反弹shell，允许攻击者远程控制OpenPLC Webserver所在的系统。

**项目地址:** [behindsecurity/htb-wifinetictwo-exploit](https://github.com/behindsecurity/htb-wifinetictwo-exploit)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #4

**来源**: [CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md](../2021/CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3 远程代码执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可被远程攻击者利用执行任意代码。

**影响版本:** v3

**利用条件:** 需要身份验证，以及访问`/hardware`页面'Hardware Layer Code Box'组件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。远程攻击者可以通过`/hardware`页面的"Hardware Layer Code Box"组件利用此漏洞执行任意代码。根据搜索引擎结果，已经存在公开的漏洞利用脚本（例如，thewhiteh4t/cve-2021-31630），表明该漏洞具有较高的可利用性。提供的POC代码是一个README.md文件，描述了漏洞利用脚本的存在，但并未提供实际的利用代码。因此，无法直接评估其有效性，需要进一步获取并分析脚本。仓库中可能存在作者隐藏的投毒代码，但根据readme文件内容，风险较小。 利用方式：攻击者首先需要通过身份验证访问OpenPLC Webserver v3的web界面，然后导航到`/hardware`页面，在"Hardware Layer Code Box"组件中输入恶意命令。由于该组件没有充分的输入验证，恶意命令会被服务器执行，导致远程代码执行。

**项目地址:** [hev0x/CVE-2021-31630-OpenPLC_RCE](https://github.com/hev0x/CVE-2021-31630-OpenPLC_RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #5

**来源**: [CVE-2021-31630-junnythemarksman_CVE-2021-31630.md](../2021/CVE-2021-31630-junnythemarksman_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要目标系统开启OpenPLC Webserver v3，攻击者需要具有有效的管理员账户密码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。攻击者可以利用"Hardware Layer Code Box"组件，通过 `/hardware` 页面执行任意代码。 

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录 OpenPLC Webserver v3。
2.  **上传恶意程序：** 使用提供的exploit.py脚本，该脚本首先尝试使用提供的凭据进行身份验证。成功登录后，它将包含反向 shell 命令的恶意 PLC 程序上传到服务器，这个PLC程序会被上传到programs目录中。
3.  **编译恶意程序：** 脚本接着会请求编译上传的程序。
4.  **运行PLC服务：** 脚本会启动 PLC 服务，从而触发命令注入。

该漏洞利用脚本通过修改 Fellipe Oliveira 提供的 PoC 代码实现，允许远程攻击者在 OpenPLC Webserver v3 上执行任意代码。

**投毒风险分析：**

该POC脚本本身存在一定的投毒风险，因为脚本的功能是上传并执行PLC程序，该程序的内容完全由攻击者控制。虽然目前的POC代码中没有明显的恶意行为，但攻击者可以很容易地修改`upload_data`变量，植入恶意的代码来执行任何操作，例如删除文件，修改配置等。由于该脚本需要身份验证才能利用，因此只有具有有效凭据的用户才能触发该漏洞，从而降低了投毒风险。但是，一旦凭据泄露，攻击者就可以完全控制系统。综合评估，投毒风险为10%。

**项目地址:** [junnythemarksman/CVE-2021-31630](https://github.com/junnythemarksman/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #6

**来源**: [CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md](../2021/CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要身份验证，且目标服务器上的OpenPLC Webserver v3运行在可访问的网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者可以通过 "Hardware Layer Code Box" 组件，在 `/hardware` 页面上，执行任意代码。该漏洞利用方式如下：

1.  **目标探测：**  首先需要确定目标OpenPLC Webserver v3服务器是否可达。
2.  **身份验证：**  使用默认凭据（openplc/openplc）或已知的有效凭据登录到OpenPLC Webserver。
3.  **Payload构建：**  利用代码构建一个包含反向shell的恶意C代码，该代码会被注入到“Hardware Layer Code Box”。反向shell连接到攻击者的机器。
4.  **Payload上传：**  将构建的payload上传到 `/hardware` 页面，覆盖 custom layer code.
5.  **程序编译：**  访问 `/compile-program?file=blank_program.st` 触发程序编译。
6.  **启动PLC：**  访问 `/start_plc` 以启动PLC，这将触发payload的执行，从而建立反向shell。
7.  **清理（可选）：**  为了避免留下痕迹，可以停止PLC并恢复自定义硬件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用POC代码的有效性高。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出攻击者可以通过特定的页面和组件执行任意代码。提供的Python POC代码实现了完整的攻击流程，包括身份验证、payload构建、上传、编译和PLC启动，从而获得反向shell。

**投毒风险分析：**

提供的POC代码的主要功能是利用命令注入漏洞，在目标系统上执行任意代码，从而获取反向shell。代码中构建了一个C语言payload，该payload的功能是创建一个反向shell连接到攻击者指定的IP地址和端口。审查代码并没有发现作者隐藏的恶意代码或者后门，例如删除文件、篡改系统配置或者进行其他未经授权的操作。因此，可以认为此仓库中不存在作者隐藏的投毒代码, 风险为0%。

**项目地址:** [machevalia/OpenPLC-CVE-2021-31630-RCE](https://github.com/machevalia/OpenPLC-CVE-2021-31630-RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #7

**来源**: [CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md](../2021/CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md)

# CVE-2021-31630

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-31630-FlojBoj_CVE-2021-31630.md](../2021/CVE-2021-31630-FlojBoj_CVE-2021-31630.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 远程命令执行

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者能够访问/hardware页面，并拥有有效的用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，OpenPLC Webserver v3 存在一个远程命令执行漏洞（CVE-2021-31630），攻击者可以通过“Hardware Layer Code Box”组件，在/hardware页面上执行任意代码。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录OpenPLC Webserver v3。
2.  **上传恶意C文件：** 攻击者将包含反向shell的恶意C代码上传到“Hardware Layer Code Box”组件。该代码会在目标系统上创建一个反向shell连接到攻击者的监听器IP地址和端口。
3.  **编译：** 攻击者通过访问/compile-program端点触发C代码的编译。
4.  **启动PLC：** 攻击者访问/start_plc端点启动PLC，这将执行编译后的恶意代码，从而建立反向shell。
5.  **停止PLC：**  攻击者访问/stop_plc端点停止PLC。停止PLC不是必须的操作，因为反向shell一旦建立，就会保持连接，即使PLC停止运行。

**有效性：**

提供的PoC代码看起来是有效的。它包含了必要的步骤，如身份验证、上传恶意C文件、编译、启动PLC和停止PLC。代码中使用的反向shell技术是一种常见的利用远程命令执行漏洞的方式。

**投毒风险：**

PoC代码本身没有明显的投毒行为。`exploit.py`脚本的主要功能是自动化漏洞利用过程，没有发现任何会损害攻击者自身或其他用户的恶意代码。恶意行为都集中在创建反向shell，利用目标机器，没有迹象表明会影响到攻击者或其他人, 投毒风险可能性为0%。

**项目地址:** [FlojBoj/CVE-2021-31630](https://github.com/FlojBoj/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #2

**来源**: [CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md](../2021/CVE-2021-31630-Hunt3r0x_CVE-2021-31630-HTB.md)

## CVE-2021-31630 - OpenPLC Webserver v3 命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，允许远程攻击者通过“Hardware Layer Code Box”组件执行任意代码。利用方式如下：

1.  **身份验证：** 使用提供的用户名和密码登录OpenPLC Webserver。
2.  **构造恶意请求：** 构造一个包含恶意代码的multipart/form-data请求，该代码会被插入到“Hardware Layer Code Box”中。  `exploit.py` 脚本将一个反向shell的C代码注入到`custom_layer_code`字段中，该反向shell连接攻击者指定的IP地址和端口。
3.  **发送请求：** 将构造的请求发送到/hardware页面。
4.  **触发编译：** 访问/compile-program?file=blank_program.st页面触发代码编译。
5.  **代码执行：**  编译过程会执行注入的恶意代码，从而建立一个反向shell连接，允许攻击者在目标系统上执行任意命令。

**投毒风险分析：**

代码中包含`# FUCK ISRAEL`的注释，这表明作者可能存在政治倾向，但这并不构成技术上的投毒。`exploit.py`脚本本身实现了漏洞利用的功能，没有发现隐藏的恶意代码或后门。它执行的操作完全符合漏洞描述和利用目的。因此，投毒风险评估为0%。需要说明的是，利用漏洞本身就是在目标系统上植入后门，但是这属于漏洞利用的范畴，不属于投毒。

**项目地址:** [Hunt3r0x/CVE-2021-31630-HTB](https://github.com/Hunt3r0x/CVE-2021-31630-HTB)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #3

**来源**: [CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md](../2021/CVE-2021-31630-behindsecurity_htb-wifinetictwo-exploit.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要网络访问OpenPLC Webserver的`/hardware`页面，默认用户名密码openplc/openplc

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。远程攻击者可以通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件利用此漏洞执行任意代码。

**有效性分析：**

从提供的漏洞信息、搜索引擎结果以及漏洞利用代码来看，该漏洞是真实存在的，并且存在公开的PoC利用代码。搜索引擎结果中多个链接指向了漏洞的详细信息，包括NVD、Red Hat、Mitre等权威机构的描述。提供的PoC代码是一个Python脚本，它自动化了利用该漏洞的过程，包括登录OpenPLC、构造包含反弹shell的恶意payload、上传payload以及触发漏洞，从而实现远程代码执行。

**投毒风险分析：**

对PoC代码进行分析后，虽然脚本本身是为了演示漏洞利用，但在以下几个方面存在潜在的投毒风险：

1.  **payload定制：** 脚本允许用户自定义反弹shell的IP地址和端口。虽然这本身是正常功能，但如果攻击者恶意修改脚本，例如硬编码一个恶意IP地址，然后传播该修改后的脚本，则可能导致其他用户在不知情的情况下将shell反弹到攻击者的服务器。
2.  **依赖项风险：** 脚本依赖于`requests`库。如果攻击者篡改了`requests`库，或者诱骗用户安装恶意版本，则可能在用户运行脚本时执行恶意代码。
3.  **脚本行为的混淆：** 通过仔细阅读脚本，可以理解其行为。但是，如果攻击者对脚本进行混淆或修改，使其行为更难以理解，则可能诱骗用户在不知情的情况下运行恶意代码。

尽管存在这些风险，但脚本的主要功能是实现漏洞利用，没有发现明显的恶意代码。因此，可以认为投毒风险较低，大约为1%。

**漏洞利用方式：**

1.  **身份验证：**  利用PoC提供的用户名和密码或者爆破用户名和密码，访问OpenPLC Webserver的`/hardware`页面。
2.  **构造Payload：**  构造包含恶意命令的Payload，该命令通常用于执行反弹shell，建立与攻击者控制的服务器的连接。
3.  **上传Payload：**  将构造的Payload上传到 `/hardware` 页面的 "Hardware Layer Code Box" 组件中。
4.  **触发漏洞：**  通过尝试编译上传的恶意代码，触发命令注入漏洞。这将导致服务器执行Payload中的恶意命令，从而建立反弹shell，允许攻击者远程控制OpenPLC Webserver所在的系统。

**项目地址:** [behindsecurity/htb-wifinetictwo-exploit](https://github.com/behindsecurity/htb-wifinetictwo-exploit)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #4

**来源**: [CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md](../2021/CVE-2021-31630-hev0x_CVE-2021-31630-OpenPLC_RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3 远程代码执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可被远程攻击者利用执行任意代码。

**影响版本:** v3

**利用条件:** 需要身份验证，以及访问`/hardware`页面'Hardware Layer Code Box'组件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。远程攻击者可以通过`/hardware`页面的"Hardware Layer Code Box"组件利用此漏洞执行任意代码。根据搜索引擎结果，已经存在公开的漏洞利用脚本（例如，thewhiteh4t/cve-2021-31630），表明该漏洞具有较高的可利用性。提供的POC代码是一个README.md文件，描述了漏洞利用脚本的存在，但并未提供实际的利用代码。因此，无法直接评估其有效性，需要进一步获取并分析脚本。仓库中可能存在作者隐藏的投毒代码，但根据readme文件内容，风险较小。 利用方式：攻击者首先需要通过身份验证访问OpenPLC Webserver v3的web界面，然后导航到`/hardware`页面，在"Hardware Layer Code Box"组件中输入恶意命令。由于该组件没有充分的输入验证，恶意命令会被服务器执行，导致远程代码执行。

**项目地址:** [hev0x/CVE-2021-31630-OpenPLC_RCE](https://github.com/hev0x/CVE-2021-31630-OpenPLC_RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #5

**来源**: [CVE-2021-31630-junnythemarksman_CVE-2021-31630.md](../2021/CVE-2021-31630-junnythemarksman_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要目标系统开启OpenPLC Webserver v3，攻击者需要具有有效的管理员账户密码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。攻击者可以利用"Hardware Layer Code Box"组件，通过 `/hardware` 页面执行任意代码。 

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录 OpenPLC Webserver v3。
2.  **上传恶意程序：** 使用提供的exploit.py脚本，该脚本首先尝试使用提供的凭据进行身份验证。成功登录后，它将包含反向 shell 命令的恶意 PLC 程序上传到服务器，这个PLC程序会被上传到programs目录中。
3.  **编译恶意程序：** 脚本接着会请求编译上传的程序。
4.  **运行PLC服务：** 脚本会启动 PLC 服务，从而触发命令注入。

该漏洞利用脚本通过修改 Fellipe Oliveira 提供的 PoC 代码实现，允许远程攻击者在 OpenPLC Webserver v3 上执行任意代码。

**投毒风险分析：**

该POC脚本本身存在一定的投毒风险，因为脚本的功能是上传并执行PLC程序，该程序的内容完全由攻击者控制。虽然目前的POC代码中没有明显的恶意行为，但攻击者可以很容易地修改`upload_data`变量，植入恶意的代码来执行任何操作，例如删除文件，修改配置等。由于该脚本需要身份验证才能利用，因此只有具有有效凭据的用户才能触发该漏洞，从而降低了投毒风险。但是，一旦凭据泄露，攻击者就可以完全控制系统。综合评估，投毒风险为10%。

**项目地址:** [junnythemarksman/CVE-2021-31630](https://github.com/junnythemarksman/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #6

**来源**: [CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md](../2021/CVE-2021-31630-machevalia_OpenPLC-CVE-2021-31630-RCE.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要身份验证，且目标服务器上的OpenPLC Webserver v3运行在可访问的网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者可以通过 "Hardware Layer Code Box" 组件，在 `/hardware` 页面上，执行任意代码。该漏洞利用方式如下：

1.  **目标探测：**  首先需要确定目标OpenPLC Webserver v3服务器是否可达。
2.  **身份验证：**  使用默认凭据（openplc/openplc）或已知的有效凭据登录到OpenPLC Webserver。
3.  **Payload构建：**  利用代码构建一个包含反向shell的恶意C代码，该代码会被注入到“Hardware Layer Code Box”。反向shell连接到攻击者的机器。
4.  **Payload上传：**  将构建的payload上传到 `/hardware` 页面，覆盖 custom layer code.
5.  **程序编译：**  访问 `/compile-program?file=blank_program.st` 触发程序编译。
6.  **启动PLC：**  访问 `/start_plc` 以启动PLC，这将触发payload的执行，从而建立反向shell。
7.  **清理（可选）：**  为了避免留下痕迹，可以停止PLC并恢复自定义硬件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用POC代码的有效性高。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出攻击者可以通过特定的页面和组件执行任意代码。提供的Python POC代码实现了完整的攻击流程，包括身份验证、payload构建、上传、编译和PLC启动，从而获得反向shell。

**投毒风险分析：**

提供的POC代码的主要功能是利用命令注入漏洞，在目标系统上执行任意代码，从而获取反向shell。代码中构建了一个C语言payload，该payload的功能是创建一个反向shell连接到攻击者指定的IP地址和端口。审查代码并没有发现作者隐藏的恶意代码或者后门，例如删除文件、篡改系统配置或者进行其他未经授权的操作。因此，可以认为此仓库中不存在作者隐藏的投毒代码, 风险为0%。

**项目地址:** [machevalia/OpenPLC-CVE-2021-31630-RCE](https://github.com/machevalia/OpenPLC-CVE-2021-31630-RCE)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #7

**来源**: [CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md](../2021/CVE-2021-31630-manuelsantosiglesias_CVE-2021-31630.md)

## CVE-2021-31630 - OpenPLC Webserver v3 远程代码执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** v3

**利用条件:** 需要目标系统运行OpenPLC Webserver v3，并且攻击者能够访问/hardware页面，并具有有效用户凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-31630 允许远程攻击者通过 "Hardware Layer Code Box" 组件在 "/hardware" 页面执行任意代码。提供的漏洞利用代码是一个 Python 脚本，它利用了 OpenPLC Webserver v3 中的命令注入漏洞。

**有效性：**

根据漏洞利用代码和描述，该 PoC 脚本的有效性较高。它首先尝试登录到 OpenPLC Webserver，然后利用硬件层代码框中的漏洞执行命令。该脚本修改自其他公开的 PoC，修复了 cookie 获取的问题，表明之前的 PoC 可能存在问题，而该脚本尝试解决这些问题，增加了其有效性。从 github 仓库描述得知，此脚本作者可能已经验证过其有效性。

**投毒风险：**

分析 PoC 代码，投毒风险较低，约为 10%。主要风险点在于：

*   **`LHOST` 和 `LPORT` 变量：** 脚本使用 `LHOST` 和 `LPORT` 变量指定反向 shell 的地址和端口。攻击者可能将这些值设置为指向恶意服务器，诱使用户执行恶意代码。但这种风险较低，因为用户通常会根据自己的环境修改这些值。
*   **依赖安装风险:** 用户在执行`pip3 install requests`时，可能会因为网络问题或者拼写错误安装了恶意包。但是这种风险较低，因为 `requests` 是一个非常常见的 Python 库。


总体来说，PoC 本身实现的逻辑是为了执行反弹shell， 属于漏洞利用的正常行为。恶意代码通常不会直接嵌入到这种类型的 PoC 中，因为这会降低其可用性和可信度。风险主要存在于用户对脚本的配置，用户在没有充分了解的情况下更改了LHOST和LPORT等信息，或者安装了恶意依赖项的情况。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录到 OpenPLC Webserver v3。
2.  **获取 Cookie：** 登录成功后，脚本会从响应头中提取 session cookie。这是利用漏洞的关键，因为后续请求需要使用该 cookie 进行身份验证。
3.  **上传恶意代码：** 脚本构造包含恶意命令的 payload，并将其发送到 "Hardware Layer Code Box" 组件。该 payload 利用命令注入漏洞执行任意代码。
4.  **执行命令：** 注入的命令通常用于建立反向 shell，从而允许攻击者远程控制受感染的系统。脚本中的代码包含建立反向 shell 的代码。
5.  **反向 Shell:** 上传的恶意代码会在目标主机上执行，并反弹shell到攻击者的LHOST和LPORT指定的地址。

该漏洞的成功利用，将导致远程代码执行，从而允许攻击者完全控制受影响的 OpenPLC Webserver 系统。

**项目地址:** [manuelsantosiglesias/CVE-2021-31630](https://github.com/manuelsantosiglesias/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #8

**来源**: [CVE-2021-31630-mind2hex_CVE-2021-31630.md](../2021/CVE-2021-31630-mind2hex_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者需要具有Web应用的登录权限，访问/hardware页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者通过利用"Hardware Layer Code Box"组件，可以在/hardware页面上执行任意代码。从搜索引擎结果来看，多个安全平台都记录了该漏洞，并确认了其严重性。提供的漏洞利用代码是一个Python脚本，它首先通过提供的用户名和密码登录到OpenPLC Web服务器。然后，它会构造一个包含反向shell命令的恶意C代码，并将其注入到“Hardware Layer Code Box”中。当OpenPLC Web服务器尝试编译和执行这段C代码时，就会执行攻击者注入的命令，从而建立一个反向shell连接到攻击者的机器上。由于该脚本的主要功能是利用命令注入漏洞建立反向shell，因此不存在明显的投毒代码。

**有效性分析：**
POC代码有效，因为代码实现了利用漏洞描述中提到的"Hardware Layer Code Box"组件在/hardware页面执行任意代码。通过修改C代码中的IP地址和端口，可以实现反向shell。

**投毒风险分析：**
提供的POC代码主要是利用漏洞建立反向shell，并未发现明显的恶意代码。脚本只是将用户提供的IP地址和端口插入到C代码中，并发送到目标服务器。因此，可以认为投毒风险较低，约为0%。

**利用方式分析：**
1.  攻击者需要拥有OpenPLC Webserver的登录凭证（默认用户名/密码通常是openplc/openplc，攻击者可能需要先进行密码爆破或者其他手段获取凭据）。
2.  攻击者使用提供的Python脚本，指定目标OpenPLC Webserver的URL、用户名、密码以及反向shell的IP地址和端口。
3.  脚本首先登录到OpenPLC Webserver。
4.  脚本构造包含恶意命令的C代码（反向shell）。
5.  脚本将恶意的C代码发送到/hardware页面的“Hardware Layer Code Box”组件。
6.  OpenPLC Webserver尝试编译并执行这段C代码，从而在服务器上执行攻击者注入的命令。
7.  攻击者在其监听端口上接收到反向shell连接，从而获得对OpenPLC Webserver服务器的控制权。

**项目地址:** [mind2hex/CVE-2021-31630](https://github.com/mind2hex/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #9

**来源**: [CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md](../2021/CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md)

## CVE-2021-31630-OpenPLC Webserver-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 漏洞存在于 OpenPLC Webserver v3 的 `/hardware` 页面，允许远程攻击者通过 "Hardware Layer Code Box" 组件执行任意代码。根据提供的PoC代码，利用方式如下：

1.  **身份验证：**  PoC脚本首先使用提供的用户名和密码登录到 OpenPLC Webserver。
2.  **构造恶意Payload：**  脚本构造一个包含反向shell的C代码，该代码被注入到 "Hardware Layer Code Box" 中。该C代码会创建一个socket连接到攻击者指定的IP地址和端口，然后将标准输入、输出和错误重定向到该socket，最后执行 `/bin/bash`，从而建立一个反向shell。
3.  **上传Payload：**  脚本将构造的包含恶意代码的请求发送到 `/hardware` 页面。
4.  **触发编译：**  脚本访问 `/compile-program?file=blank_program.st` 页面，触发 OpenPLC 编译包含恶意代码的“硬件层”。
5.  **建立反向Shell：**  一旦代码被编译和执行，目标系统会连接到攻击者的监听端口，从而允许攻击者执行任意命令。

**有效性：** 根据搜索结果和PoC代码，该漏洞的利用是有效的，可以实现远程代码执行。

**投毒风险：**
查看了README，发现sealldev修改了Hunt3r0x提交的代码，移除了政治信息并且修复了拼写错误。main.py中，baseURL 被硬编码为 "http://wifinetictwo.htb:8080"，这表明此PoC是为HackTheBox的 "WifineticTwo" 靶机设计的，存在诱导使用者在相同IP环境下执行恶意代码风险。同时，PoC中的代码本身包含一个反向shell，这在某些情况下可能被认为是具有攻击性的。但此反向shell是漏洞利用的一部分，不能简单地归类为投毒。
综上，代码的投毒风险较低，大约为 10%。这个百分比主要考虑到脚本的针对性和潜在的非预期使用情况。

**项目地址:** [sealldeveloper/CVE-2021-31630-PoC](https://github.com/sealldeveloper/CVE-2021-31630-PoC)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #10

**来源**: [CVE-2021-31630-thewhiteh4t_cve-2021-31630.md](../2021/CVE-2021-31630-thewhiteh4t_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver v3

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要身份验证和网络访问/hardware页面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，攻击者可以通过“Hardware Layer Code Box”组件注入恶意命令。漏洞利用方式如下：

1.  **漏洞描述：** CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞，允许经过身份验证的远程攻击者通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件执行任意代码。
2.  **搜索引擎结果：** 多个搜索结果表明该漏洞的描述，影响版本和利用方法。其中github链接指向了可利用的poc代码
3.  **漏洞利用代码分析：**
    *   POC 代码是一个 Python 脚本，用于利用 OpenPLC Webserver v3 中的命令注入漏洞。
    *   脚本首先登录到 OpenPLC Webserver v3，默认用户名和密码为 openplc/openplc。
    *   然后，脚本将默认程序还原，接着上传一个包含反向 shell 的特制 C 代码到`/hardware` 页面的 "Hardware Layer Code Box"。
    *   上传的C代码会被编译和执行，从而在目标系统上建立一个反向 shell 连接到攻击者的机器，IP地址和端口由脚本参数`-lh` 和 `-lp`指定。
    *   最后，脚本停止并清理PLC服务。
4.  **有效性评估：** 提供的 POC 代码有效，能够实现远程代码执行。
5.  **投毒风险评估：**
    *   该仓库的主要功能是提供漏洞利用代码，帮助研究人员验证和理解漏洞，但并不能完全排除投毒风险。
    *   `cve_2021_31630.py` 主要功能是利用漏洞，其本身没有明显的恶意代码，但使用者有可能会修改此脚本植入恶意代码
    *   `README.md`文件描述了漏洞利用过程和代码功能。
    *   综合来看，投毒风险较低，但是由于代码可能被篡改，仍存在一定的潜在风险。投毒风险估算为5%。
6. **漏洞利用方式：**
  1. 登录到OpenPLC Webserver v3。
  2. 停止当前PLC服务，清理环境。
  3. 上传包含恶意命令的C代码（通过`custom_layer_code`参数）到 `/hardware` 页面的 "Hardware Layer Code Box" 组件。
  4. 触发编译过程 (`/compile-program?file=blank_program.st`)，使恶意代码得到执行。
  5. 启动PLC服务，执行恶意代码（反向shell）
  6. 清理PLC服务。


**项目地址:** [thewhiteh4t/cve-2021-31630](https://github.com/thewhiteh4t/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #11

**来源**: [CVE-2021-31630-ttps-byte_cve-2021-31630.md](../2021/CVE-2021-31630-ttps-byte_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** v3

**利用条件:** 需要网络访问和有效的OpenPLC Webserver v3实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 存在于 OpenPLC Webserver v3 中，允许远程攻击者通过 "Hardware Layer Code Box" 组件在 "/hardware" 页面上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（breakerplc.py），此漏洞的POC代码是有效的。该代码利用命令注入漏洞，通过修改 "Hardware Layer Code Box" 中的代码来执行恶意命令，从而获得服务器的shell访问权限。

**投毒风险：**
通过分析 `breakerplc.py` 脚本，存在一定的投毒风险。具体分析如下：
*   **优点：**
    *   代码结构清晰，功能模块化，易于理解。
    *   脚本使用 `argparse` 模块处理命令行参数，方便用户自定义目标URL、用户名、密码、LHOST、LPORT等信息。
    *   脚本包含完整的漏洞利用流程，包括登录、上传payload、编译程序、触发漏洞等步骤。
*   **缺点和潜在投毒点：**
    *   脚本的安全性取决于用户的输入，如果用户输入不安全的参数（例如恶意的LHOST或LPORT），可能导致反弹shell到错误的地址或端口。
    *   脚本中使用了 `subprocess.Popen` 函数来启动 nc 监听，这部分代码可能存在安全风险，例如命令注入等。
    *  虽然脚本本身目的是利用命令注入，但仓库创建者可能通过其它方式植入后门代码，考虑到github仓库的普遍性及POC仓库的安全性，故风险较低。
*   **投毒风险评估：**
    代码主要功能是利用命令注入，虽然有潜在风险，但是并未发现明显的恶意代码或后门。因此，评估投毒风险为 **10%**。

**利用方式：**
利用此漏洞的步骤如下：
1.  使用提供的 `breakerplc.py` 脚本，并提供目标 OpenPLC Webserver v3 的 URL。
2.  提供有效的用户名和密码进行身份验证（默认是 openplc/openplc）。
3.  指定攻击者的监听 IP 地址 (LHOST) 和端口 (LPORT)，用于接收反弹 shell。
4.  脚本将构造包含反向 shell 命令的恶意代码，并通过 "Hardware Layer Code Box" 上传到目标服务器。
5.  脚本触发编译，由于存在命令注入漏洞，恶意代码将被执行，从而在攻击者机器上建立反向 shell 连接。
6.  连接后，可能需要输入命令(如whoami或者ls)来打破代码行，获取返回shell。

**项目地址:** [ttps-byte/cve-2021-31630](https://github.com/ttps-byte/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---



---

## POC #8

**来源**: [CVE-2021-31630-mind2hex_CVE-2021-31630.md](../2021/CVE-2021-31630-mind2hex_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者需要具有Web应用的登录权限，访问/hardware页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者通过利用"Hardware Layer Code Box"组件，可以在/hardware页面上执行任意代码。从搜索引擎结果来看，多个安全平台都记录了该漏洞，并确认了其严重性。提供的漏洞利用代码是一个Python脚本，它首先通过提供的用户名和密码登录到OpenPLC Web服务器。然后，它会构造一个包含反向shell命令的恶意C代码，并将其注入到“Hardware Layer Code Box”中。当OpenPLC Web服务器尝试编译和执行这段C代码时，就会执行攻击者注入的命令，从而建立一个反向shell连接到攻击者的机器上。由于该脚本的主要功能是利用命令注入漏洞建立反向shell，因此不存在明显的投毒代码。

**有效性分析：**
POC代码有效，因为代码实现了利用漏洞描述中提到的"Hardware Layer Code Box"组件在/hardware页面执行任意代码。通过修改C代码中的IP地址和端口，可以实现反向shell。

**投毒风险分析：**
提供的POC代码主要是利用漏洞建立反向shell，并未发现明显的恶意代码。脚本只是将用户提供的IP地址和端口插入到C代码中，并发送到目标服务器。因此，可以认为投毒风险较低，约为0%。

**利用方式分析：**
1.  攻击者需要拥有OpenPLC Webserver的登录凭证（默认用户名/密码通常是openplc/openplc，攻击者可能需要先进行密码爆破或者其他手段获取凭据）。
2.  攻击者使用提供的Python脚本，指定目标OpenPLC Webserver的URL、用户名、密码以及反向shell的IP地址和端口。
3.  脚本首先登录到OpenPLC Webserver。
4.  脚本构造包含恶意命令的C代码（反向shell）。
5.  脚本将恶意的C代码发送到/hardware页面的“Hardware Layer Code Box”组件。
6.  OpenPLC Webserver尝试编译并执行这段C代码，从而在服务器上执行攻击者注入的命令。
7.  攻击者在其监听端口上接收到反向shell连接，从而获得对OpenPLC Webserver服务器的控制权。

**项目地址:** [mind2hex/CVE-2021-31630](https://github.com/mind2hex/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #9

**来源**: [CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md](../2021/CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md)

## CVE-2021-31630-OpenPLC Webserver-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 漏洞存在于 OpenPLC Webserver v3 的 `/hardware` 页面，允许远程攻击者通过 "Hardware Layer Code Box" 组件执行任意代码。根据提供的PoC代码，利用方式如下：

1.  **身份验证：**  PoC脚本首先使用提供的用户名和密码登录到 OpenPLC Webserver。
2.  **构造恶意Payload：**  脚本构造一个包含反向shell的C代码，该代码被注入到 "Hardware Layer Code Box" 中。该C代码会创建一个socket连接到攻击者指定的IP地址和端口，然后将标准输入、输出和错误重定向到该socket，最后执行 `/bin/bash`，从而建立一个反向shell。
3.  **上传Payload：**  脚本将构造的包含恶意代码的请求发送到 `/hardware` 页面。
4.  **触发编译：**  脚本访问 `/compile-program?file=blank_program.st` 页面，触发 OpenPLC 编译包含恶意代码的“硬件层”。
5.  **建立反向Shell：**  一旦代码被编译和执行，目标系统会连接到攻击者的监听端口，从而允许攻击者执行任意命令。

**有效性：** 根据搜索结果和PoC代码，该漏洞的利用是有效的，可以实现远程代码执行。

**投毒风险：**
查看了README，发现sealldev修改了Hunt3r0x提交的代码，移除了政治信息并且修复了拼写错误。main.py中，baseURL 被硬编码为 "http://wifinetictwo.htb:8080"，这表明此PoC是为HackTheBox的 "WifineticTwo" 靶机设计的，存在诱导使用者在相同IP环境下执行恶意代码风险。同时，PoC中的代码本身包含一个反向shell，这在某些情况下可能被认为是具有攻击性的。但此反向shell是漏洞利用的一部分，不能简单地归类为投毒。
综上，代码的投毒风险较低，大约为 10%。这个百分比主要考虑到脚本的针对性和潜在的非预期使用情况。

**项目地址:** [sealldeveloper/CVE-2021-31630-PoC](https://github.com/sealldeveloper/CVE-2021-31630-PoC)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #10

**来源**: [CVE-2021-31630-thewhiteh4t_cve-2021-31630.md](../2021/CVE-2021-31630-thewhiteh4t_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver v3

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要身份验证和网络访问/hardware页面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，攻击者可以通过“Hardware Layer Code Box”组件注入恶意命令。漏洞利用方式如下：

1.  **漏洞描述：** CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞，允许经过身份验证的远程攻击者通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件执行任意代码。
2.  **搜索引擎结果：** 多个搜索结果表明该漏洞的描述，影响版本和利用方法。其中github链接指向了可利用的poc代码
3.  **漏洞利用代码分析：**
    *   POC 代码是一个 Python 脚本，用于利用 OpenPLC Webserver v3 中的命令注入漏洞。
    *   脚本首先登录到 OpenPLC Webserver v3，默认用户名和密码为 openplc/openplc。
    *   然后，脚本将默认程序还原，接着上传一个包含反向 shell 的特制 C 代码到`/hardware` 页面的 "Hardware Layer Code Box"。
    *   上传的C代码会被编译和执行，从而在目标系统上建立一个反向 shell 连接到攻击者的机器，IP地址和端口由脚本参数`-lh` 和 `-lp`指定。
    *   最后，脚本停止并清理PLC服务。
4.  **有效性评估：** 提供的 POC 代码有效，能够实现远程代码执行。
5.  **投毒风险评估：**
    *   该仓库的主要功能是提供漏洞利用代码，帮助研究人员验证和理解漏洞，但并不能完全排除投毒风险。
    *   `cve_2021_31630.py` 主要功能是利用漏洞，其本身没有明显的恶意代码，但使用者有可能会修改此脚本植入恶意代码
    *   `README.md`文件描述了漏洞利用过程和代码功能。
    *   综合来看，投毒风险较低，但是由于代码可能被篡改，仍存在一定的潜在风险。投毒风险估算为5%。
6. **漏洞利用方式：**
  1. 登录到OpenPLC Webserver v3。
  2. 停止当前PLC服务，清理环境。
  3. 上传包含恶意命令的C代码（通过`custom_layer_code`参数）到 `/hardware` 页面的 "Hardware Layer Code Box" 组件。
  4. 触发编译过程 (`/compile-program?file=blank_program.st`)，使恶意代码得到执行。
  5. 启动PLC服务，执行恶意代码（反向shell）
  6. 清理PLC服务。


**项目地址:** [thewhiteh4t/cve-2021-31630](https://github.com/thewhiteh4t/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #11

**来源**: [CVE-2021-31630-ttps-byte_cve-2021-31630.md](../2021/CVE-2021-31630-ttps-byte_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** v3

**利用条件:** 需要网络访问和有效的OpenPLC Webserver v3实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 存在于 OpenPLC Webserver v3 中，允许远程攻击者通过 "Hardware Layer Code Box" 组件在 "/hardware" 页面上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（breakerplc.py），此漏洞的POC代码是有效的。该代码利用命令注入漏洞，通过修改 "Hardware Layer Code Box" 中的代码来执行恶意命令，从而获得服务器的shell访问权限。

**投毒风险：**
通过分析 `breakerplc.py` 脚本，存在一定的投毒风险。具体分析如下：
*   **优点：**
    *   代码结构清晰，功能模块化，易于理解。
    *   脚本使用 `argparse` 模块处理命令行参数，方便用户自定义目标URL、用户名、密码、LHOST、LPORT等信息。
    *   脚本包含完整的漏洞利用流程，包括登录、上传payload、编译程序、触发漏洞等步骤。
*   **缺点和潜在投毒点：**
    *   脚本的安全性取决于用户的输入，如果用户输入不安全的参数（例如恶意的LHOST或LPORT），可能导致反弹shell到错误的地址或端口。
    *   脚本中使用了 `subprocess.Popen` 函数来启动 nc 监听，这部分代码可能存在安全风险，例如命令注入等。
    *  虽然脚本本身目的是利用命令注入，但仓库创建者可能通过其它方式植入后门代码，考虑到github仓库的普遍性及POC仓库的安全性，故风险较低。
*   **投毒风险评估：**
    代码主要功能是利用命令注入，虽然有潜在风险，但是并未发现明显的恶意代码或后门。因此，评估投毒风险为 **10%**。

**利用方式：**
利用此漏洞的步骤如下：
1.  使用提供的 `breakerplc.py` 脚本，并提供目标 OpenPLC Webserver v3 的 URL。
2.  提供有效的用户名和密码进行身份验证（默认是 openplc/openplc）。
3.  指定攻击者的监听 IP 地址 (LHOST) 和端口 (LPORT)，用于接收反弹 shell。
4.  脚本将构造包含反向 shell 命令的恶意代码，并通过 "Hardware Layer Code Box" 上传到目标服务器。
5.  脚本触发编译，由于存在命令注入漏洞，恶意代码将被执行，从而在攻击者机器上建立反向 shell 连接。
6.  连接后，可能需要输入命令(如whoami或者ls)来打破代码行，获取返回shell。

**项目地址:** [ttps-byte/cve-2021-31630](https://github.com/ttps-byte/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---



---

## POC #8

**来源**: [CVE-2021-31630-mind2hex_CVE-2021-31630.md](../2021/CVE-2021-31630-mind2hex_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者需要具有Web应用的登录权限，访问/hardware页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者通过利用"Hardware Layer Code Box"组件，可以在/hardware页面上执行任意代码。从搜索引擎结果来看，多个安全平台都记录了该漏洞，并确认了其严重性。提供的漏洞利用代码是一个Python脚本，它首先通过提供的用户名和密码登录到OpenPLC Web服务器。然后，它会构造一个包含反向shell命令的恶意C代码，并将其注入到“Hardware Layer Code Box”中。当OpenPLC Web服务器尝试编译和执行这段C代码时，就会执行攻击者注入的命令，从而建立一个反向shell连接到攻击者的机器上。由于该脚本的主要功能是利用命令注入漏洞建立反向shell，因此不存在明显的投毒代码。

**有效性分析：**
POC代码有效，因为代码实现了利用漏洞描述中提到的"Hardware Layer Code Box"组件在/hardware页面执行任意代码。通过修改C代码中的IP地址和端口，可以实现反向shell。

**投毒风险分析：**
提供的POC代码主要是利用漏洞建立反向shell，并未发现明显的恶意代码。脚本只是将用户提供的IP地址和端口插入到C代码中，并发送到目标服务器。因此，可以认为投毒风险较低，约为0%。

**利用方式分析：**
1.  攻击者需要拥有OpenPLC Webserver的登录凭证（默认用户名/密码通常是openplc/openplc，攻击者可能需要先进行密码爆破或者其他手段获取凭据）。
2.  攻击者使用提供的Python脚本，指定目标OpenPLC Webserver的URL、用户名、密码以及反向shell的IP地址和端口。
3.  脚本首先登录到OpenPLC Webserver。
4.  脚本构造包含恶意命令的C代码（反向shell）。
5.  脚本将恶意的C代码发送到/hardware页面的“Hardware Layer Code Box”组件。
6.  OpenPLC Webserver尝试编译并执行这段C代码，从而在服务器上执行攻击者注入的命令。
7.  攻击者在其监听端口上接收到反向shell连接，从而获得对OpenPLC Webserver服务器的控制权。

**项目地址:** [mind2hex/CVE-2021-31630](https://github.com/mind2hex/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #9

**来源**: [CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md](../2021/CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md)

## CVE-2021-31630-OpenPLC Webserver-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 漏洞存在于 OpenPLC Webserver v3 的 `/hardware` 页面，允许远程攻击者通过 "Hardware Layer Code Box" 组件执行任意代码。根据提供的PoC代码，利用方式如下：

1.  **身份验证：**  PoC脚本首先使用提供的用户名和密码登录到 OpenPLC Webserver。
2.  **构造恶意Payload：**  脚本构造一个包含反向shell的C代码，该代码被注入到 "Hardware Layer Code Box" 中。该C代码会创建一个socket连接到攻击者指定的IP地址和端口，然后将标准输入、输出和错误重定向到该socket，最后执行 `/bin/bash`，从而建立一个反向shell。
3.  **上传Payload：**  脚本将构造的包含恶意代码的请求发送到 `/hardware` 页面。
4.  **触发编译：**  脚本访问 `/compile-program?file=blank_program.st` 页面，触发 OpenPLC 编译包含恶意代码的“硬件层”。
5.  **建立反向Shell：**  一旦代码被编译和执行，目标系统会连接到攻击者的监听端口，从而允许攻击者执行任意命令。

**有效性：** 根据搜索结果和PoC代码，该漏洞的利用是有效的，可以实现远程代码执行。

**投毒风险：**
查看了README，发现sealldev修改了Hunt3r0x提交的代码，移除了政治信息并且修复了拼写错误。main.py中，baseURL 被硬编码为 "http://wifinetictwo.htb:8080"，这表明此PoC是为HackTheBox的 "WifineticTwo" 靶机设计的，存在诱导使用者在相同IP环境下执行恶意代码风险。同时，PoC中的代码本身包含一个反向shell，这在某些情况下可能被认为是具有攻击性的。但此反向shell是漏洞利用的一部分，不能简单地归类为投毒。
综上，代码的投毒风险较低，大约为 10%。这个百分比主要考虑到脚本的针对性和潜在的非预期使用情况。

**项目地址:** [sealldeveloper/CVE-2021-31630-PoC](https://github.com/sealldeveloper/CVE-2021-31630-PoC)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #10

**来源**: [CVE-2021-31630-thewhiteh4t_cve-2021-31630.md](../2021/CVE-2021-31630-thewhiteh4t_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver v3

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要身份验证和网络访问/hardware页面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，攻击者可以通过“Hardware Layer Code Box”组件注入恶意命令。漏洞利用方式如下：

1.  **漏洞描述：** CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞，允许经过身份验证的远程攻击者通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件执行任意代码。
2.  **搜索引擎结果：** 多个搜索结果表明该漏洞的描述，影响版本和利用方法。其中github链接指向了可利用的poc代码
3.  **漏洞利用代码分析：**
    *   POC 代码是一个 Python 脚本，用于利用 OpenPLC Webserver v3 中的命令注入漏洞。
    *   脚本首先登录到 OpenPLC Webserver v3，默认用户名和密码为 openplc/openplc。
    *   然后，脚本将默认程序还原，接着上传一个包含反向 shell 的特制 C 代码到`/hardware` 页面的 "Hardware Layer Code Box"。
    *   上传的C代码会被编译和执行，从而在目标系统上建立一个反向 shell 连接到攻击者的机器，IP地址和端口由脚本参数`-lh` 和 `-lp`指定。
    *   最后，脚本停止并清理PLC服务。
4.  **有效性评估：** 提供的 POC 代码有效，能够实现远程代码执行。
5.  **投毒风险评估：**
    *   该仓库的主要功能是提供漏洞利用代码，帮助研究人员验证和理解漏洞，但并不能完全排除投毒风险。
    *   `cve_2021_31630.py` 主要功能是利用漏洞，其本身没有明显的恶意代码，但使用者有可能会修改此脚本植入恶意代码
    *   `README.md`文件描述了漏洞利用过程和代码功能。
    *   综合来看，投毒风险较低，但是由于代码可能被篡改，仍存在一定的潜在风险。投毒风险估算为5%。
6. **漏洞利用方式：**
  1. 登录到OpenPLC Webserver v3。
  2. 停止当前PLC服务，清理环境。
  3. 上传包含恶意命令的C代码（通过`custom_layer_code`参数）到 `/hardware` 页面的 "Hardware Layer Code Box" 组件。
  4. 触发编译过程 (`/compile-program?file=blank_program.st`)，使恶意代码得到执行。
  5. 启动PLC服务，执行恶意代码（反向shell）
  6. 清理PLC服务。


**项目地址:** [thewhiteh4t/cve-2021-31630](https://github.com/thewhiteh4t/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #11

**来源**: [CVE-2021-31630-ttps-byte_cve-2021-31630.md](../2021/CVE-2021-31630-ttps-byte_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** v3

**利用条件:** 需要网络访问和有效的OpenPLC Webserver v3实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 存在于 OpenPLC Webserver v3 中，允许远程攻击者通过 "Hardware Layer Code Box" 组件在 "/hardware" 页面上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（breakerplc.py），此漏洞的POC代码是有效的。该代码利用命令注入漏洞，通过修改 "Hardware Layer Code Box" 中的代码来执行恶意命令，从而获得服务器的shell访问权限。

**投毒风险：**
通过分析 `breakerplc.py` 脚本，存在一定的投毒风险。具体分析如下：
*   **优点：**
    *   代码结构清晰，功能模块化，易于理解。
    *   脚本使用 `argparse` 模块处理命令行参数，方便用户自定义目标URL、用户名、密码、LHOST、LPORT等信息。
    *   脚本包含完整的漏洞利用流程，包括登录、上传payload、编译程序、触发漏洞等步骤。
*   **缺点和潜在投毒点：**
    *   脚本的安全性取决于用户的输入，如果用户输入不安全的参数（例如恶意的LHOST或LPORT），可能导致反弹shell到错误的地址或端口。
    *   脚本中使用了 `subprocess.Popen` 函数来启动 nc 监听，这部分代码可能存在安全风险，例如命令注入等。
    *  虽然脚本本身目的是利用命令注入，但仓库创建者可能通过其它方式植入后门代码，考虑到github仓库的普遍性及POC仓库的安全性，故风险较低。
*   **投毒风险评估：**
    代码主要功能是利用命令注入，虽然有潜在风险，但是并未发现明显的恶意代码或后门。因此，评估投毒风险为 **10%**。

**利用方式：**
利用此漏洞的步骤如下：
1.  使用提供的 `breakerplc.py` 脚本，并提供目标 OpenPLC Webserver v3 的 URL。
2.  提供有效的用户名和密码进行身份验证（默认是 openplc/openplc）。
3.  指定攻击者的监听 IP 地址 (LHOST) 和端口 (LPORT)，用于接收反弹 shell。
4.  脚本将构造包含反向 shell 命令的恶意代码，并通过 "Hardware Layer Code Box" 上传到目标服务器。
5.  脚本触发编译，由于存在命令注入漏洞，恶意代码将被执行，从而在攻击者机器上建立反向 shell 连接。
6.  连接后，可能需要输入命令(如whoami或者ls)来打破代码行，获取返回shell。

**项目地址:** [ttps-byte/cve-2021-31630](https://github.com/ttps-byte/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---



---

## POC #8

**来源**: [CVE-2021-31630-mind2hex_CVE-2021-31630.md](../2021/CVE-2021-31630-mind2hex_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者需要具有Web应用的登录权限，访问/hardware页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者通过利用"Hardware Layer Code Box"组件，可以在/hardware页面上执行任意代码。从搜索引擎结果来看，多个安全平台都记录了该漏洞，并确认了其严重性。提供的漏洞利用代码是一个Python脚本，它首先通过提供的用户名和密码登录到OpenPLC Web服务器。然后，它会构造一个包含反向shell命令的恶意C代码，并将其注入到“Hardware Layer Code Box”中。当OpenPLC Web服务器尝试编译和执行这段C代码时，就会执行攻击者注入的命令，从而建立一个反向shell连接到攻击者的机器上。由于该脚本的主要功能是利用命令注入漏洞建立反向shell，因此不存在明显的投毒代码。

**有效性分析：**
POC代码有效，因为代码实现了利用漏洞描述中提到的"Hardware Layer Code Box"组件在/hardware页面执行任意代码。通过修改C代码中的IP地址和端口，可以实现反向shell。

**投毒风险分析：**
提供的POC代码主要是利用漏洞建立反向shell，并未发现明显的恶意代码。脚本只是将用户提供的IP地址和端口插入到C代码中，并发送到目标服务器。因此，可以认为投毒风险较低，约为0%。

**利用方式分析：**
1.  攻击者需要拥有OpenPLC Webserver的登录凭证（默认用户名/密码通常是openplc/openplc，攻击者可能需要先进行密码爆破或者其他手段获取凭据）。
2.  攻击者使用提供的Python脚本，指定目标OpenPLC Webserver的URL、用户名、密码以及反向shell的IP地址和端口。
3.  脚本首先登录到OpenPLC Webserver。
4.  脚本构造包含恶意命令的C代码（反向shell）。
5.  脚本将恶意的C代码发送到/hardware页面的“Hardware Layer Code Box”组件。
6.  OpenPLC Webserver尝试编译并执行这段C代码，从而在服务器上执行攻击者注入的命令。
7.  攻击者在其监听端口上接收到反向shell连接，从而获得对OpenPLC Webserver服务器的控制权。

**项目地址:** [mind2hex/CVE-2021-31630](https://github.com/mind2hex/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #9

**来源**: [CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md](../2021/CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md)

## CVE-2021-31630-OpenPLC Webserver-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 漏洞存在于 OpenPLC Webserver v3 的 `/hardware` 页面，允许远程攻击者通过 "Hardware Layer Code Box" 组件执行任意代码。根据提供的PoC代码，利用方式如下：

1.  **身份验证：**  PoC脚本首先使用提供的用户名和密码登录到 OpenPLC Webserver。
2.  **构造恶意Payload：**  脚本构造一个包含反向shell的C代码，该代码被注入到 "Hardware Layer Code Box" 中。该C代码会创建一个socket连接到攻击者指定的IP地址和端口，然后将标准输入、输出和错误重定向到该socket，最后执行 `/bin/bash`，从而建立一个反向shell。
3.  **上传Payload：**  脚本将构造的包含恶意代码的请求发送到 `/hardware` 页面。
4.  **触发编译：**  脚本访问 `/compile-program?file=blank_program.st` 页面，触发 OpenPLC 编译包含恶意代码的“硬件层”。
5.  **建立反向Shell：**  一旦代码被编译和执行，目标系统会连接到攻击者的监听端口，从而允许攻击者执行任意命令。

**有效性：** 根据搜索结果和PoC代码，该漏洞的利用是有效的，可以实现远程代码执行。

**投毒风险：**
查看了README，发现sealldev修改了Hunt3r0x提交的代码，移除了政治信息并且修复了拼写错误。main.py中，baseURL 被硬编码为 "http://wifinetictwo.htb:8080"，这表明此PoC是为HackTheBox的 "WifineticTwo" 靶机设计的，存在诱导使用者在相同IP环境下执行恶意代码风险。同时，PoC中的代码本身包含一个反向shell，这在某些情况下可能被认为是具有攻击性的。但此反向shell是漏洞利用的一部分，不能简单地归类为投毒。
综上，代码的投毒风险较低，大约为 10%。这个百分比主要考虑到脚本的针对性和潜在的非预期使用情况。

**项目地址:** [sealldeveloper/CVE-2021-31630-PoC](https://github.com/sealldeveloper/CVE-2021-31630-PoC)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #10

**来源**: [CVE-2021-31630-thewhiteh4t_cve-2021-31630.md](../2021/CVE-2021-31630-thewhiteh4t_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver v3

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要身份验证和网络访问/hardware页面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，攻击者可以通过“Hardware Layer Code Box”组件注入恶意命令。漏洞利用方式如下：

1.  **漏洞描述：** CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞，允许经过身份验证的远程攻击者通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件执行任意代码。
2.  **搜索引擎结果：** 多个搜索结果表明该漏洞的描述，影响版本和利用方法。其中github链接指向了可利用的poc代码
3.  **漏洞利用代码分析：**
    *   POC 代码是一个 Python 脚本，用于利用 OpenPLC Webserver v3 中的命令注入漏洞。
    *   脚本首先登录到 OpenPLC Webserver v3，默认用户名和密码为 openplc/openplc。
    *   然后，脚本将默认程序还原，接着上传一个包含反向 shell 的特制 C 代码到`/hardware` 页面的 "Hardware Layer Code Box"。
    *   上传的C代码会被编译和执行，从而在目标系统上建立一个反向 shell 连接到攻击者的机器，IP地址和端口由脚本参数`-lh` 和 `-lp`指定。
    *   最后，脚本停止并清理PLC服务。
4.  **有效性评估：** 提供的 POC 代码有效，能够实现远程代码执行。
5.  **投毒风险评估：**
    *   该仓库的主要功能是提供漏洞利用代码，帮助研究人员验证和理解漏洞，但并不能完全排除投毒风险。
    *   `cve_2021_31630.py` 主要功能是利用漏洞，其本身没有明显的恶意代码，但使用者有可能会修改此脚本植入恶意代码
    *   `README.md`文件描述了漏洞利用过程和代码功能。
    *   综合来看，投毒风险较低，但是由于代码可能被篡改，仍存在一定的潜在风险。投毒风险估算为5%。
6. **漏洞利用方式：**
  1. 登录到OpenPLC Webserver v3。
  2. 停止当前PLC服务，清理环境。
  3. 上传包含恶意命令的C代码（通过`custom_layer_code`参数）到 `/hardware` 页面的 "Hardware Layer Code Box" 组件。
  4. 触发编译过程 (`/compile-program?file=blank_program.st`)，使恶意代码得到执行。
  5. 启动PLC服务，执行恶意代码（反向shell）
  6. 清理PLC服务。


**项目地址:** [thewhiteh4t/cve-2021-31630](https://github.com/thewhiteh4t/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #11

**来源**: [CVE-2021-31630-ttps-byte_cve-2021-31630.md](../2021/CVE-2021-31630-ttps-byte_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** v3

**利用条件:** 需要网络访问和有效的OpenPLC Webserver v3实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 存在于 OpenPLC Webserver v3 中，允许远程攻击者通过 "Hardware Layer Code Box" 组件在 "/hardware" 页面上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（breakerplc.py），此漏洞的POC代码是有效的。该代码利用命令注入漏洞，通过修改 "Hardware Layer Code Box" 中的代码来执行恶意命令，从而获得服务器的shell访问权限。

**投毒风险：**
通过分析 `breakerplc.py` 脚本，存在一定的投毒风险。具体分析如下：
*   **优点：**
    *   代码结构清晰，功能模块化，易于理解。
    *   脚本使用 `argparse` 模块处理命令行参数，方便用户自定义目标URL、用户名、密码、LHOST、LPORT等信息。
    *   脚本包含完整的漏洞利用流程，包括登录、上传payload、编译程序、触发漏洞等步骤。
*   **缺点和潜在投毒点：**
    *   脚本的安全性取决于用户的输入，如果用户输入不安全的参数（例如恶意的LHOST或LPORT），可能导致反弹shell到错误的地址或端口。
    *   脚本中使用了 `subprocess.Popen` 函数来启动 nc 监听，这部分代码可能存在安全风险，例如命令注入等。
    *  虽然脚本本身目的是利用命令注入，但仓库创建者可能通过其它方式植入后门代码，考虑到github仓库的普遍性及POC仓库的安全性，故风险较低。
*   **投毒风险评估：**
    代码主要功能是利用命令注入，虽然有潜在风险，但是并未发现明显的恶意代码或后门。因此，评估投毒风险为 **10%**。

**利用方式：**
利用此漏洞的步骤如下：
1.  使用提供的 `breakerplc.py` 脚本，并提供目标 OpenPLC Webserver v3 的 URL。
2.  提供有效的用户名和密码进行身份验证（默认是 openplc/openplc）。
3.  指定攻击者的监听 IP 地址 (LHOST) 和端口 (LPORT)，用于接收反弹 shell。
4.  脚本将构造包含反向 shell 命令的恶意代码，并通过 "Hardware Layer Code Box" 上传到目标服务器。
5.  脚本触发编译，由于存在命令注入漏洞，恶意代码将被执行，从而在攻击者机器上建立反向 shell 连接。
6.  连接后，可能需要输入命令(如whoami或者ls)来打破代码行，获取返回shell。

**项目地址:** [ttps-byte/cve-2021-31630](https://github.com/ttps-byte/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---



---

## POC #8

**来源**: [CVE-2021-31630-mind2hex_CVE-2021-31630.md](../2021/CVE-2021-31630-mind2hex_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者需要具有Web应用的登录权限，访问/hardware页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者通过利用"Hardware Layer Code Box"组件，可以在/hardware页面上执行任意代码。从搜索引擎结果来看，多个安全平台都记录了该漏洞，并确认了其严重性。提供的漏洞利用代码是一个Python脚本，它首先通过提供的用户名和密码登录到OpenPLC Web服务器。然后，它会构造一个包含反向shell命令的恶意C代码，并将其注入到“Hardware Layer Code Box”中。当OpenPLC Web服务器尝试编译和执行这段C代码时，就会执行攻击者注入的命令，从而建立一个反向shell连接到攻击者的机器上。由于该脚本的主要功能是利用命令注入漏洞建立反向shell，因此不存在明显的投毒代码。

**有效性分析：**
POC代码有效，因为代码实现了利用漏洞描述中提到的"Hardware Layer Code Box"组件在/hardware页面执行任意代码。通过修改C代码中的IP地址和端口，可以实现反向shell。

**投毒风险分析：**
提供的POC代码主要是利用漏洞建立反向shell，并未发现明显的恶意代码。脚本只是将用户提供的IP地址和端口插入到C代码中，并发送到目标服务器。因此，可以认为投毒风险较低，约为0%。

**利用方式分析：**
1.  攻击者需要拥有OpenPLC Webserver的登录凭证（默认用户名/密码通常是openplc/openplc，攻击者可能需要先进行密码爆破或者其他手段获取凭据）。
2.  攻击者使用提供的Python脚本，指定目标OpenPLC Webserver的URL、用户名、密码以及反向shell的IP地址和端口。
3.  脚本首先登录到OpenPLC Webserver。
4.  脚本构造包含恶意命令的C代码（反向shell）。
5.  脚本将恶意的C代码发送到/hardware页面的“Hardware Layer Code Box”组件。
6.  OpenPLC Webserver尝试编译并执行这段C代码，从而在服务器上执行攻击者注入的命令。
7.  攻击者在其监听端口上接收到反向shell连接，从而获得对OpenPLC Webserver服务器的控制权。

**项目地址:** [mind2hex/CVE-2021-31630](https://github.com/mind2hex/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #9

**来源**: [CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md](../2021/CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md)

## CVE-2021-31630-OpenPLC Webserver-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 漏洞存在于 OpenPLC Webserver v3 的 `/hardware` 页面，允许远程攻击者通过 "Hardware Layer Code Box" 组件执行任意代码。根据提供的PoC代码，利用方式如下：

1.  **身份验证：**  PoC脚本首先使用提供的用户名和密码登录到 OpenPLC Webserver。
2.  **构造恶意Payload：**  脚本构造一个包含反向shell的C代码，该代码被注入到 "Hardware Layer Code Box" 中。该C代码会创建一个socket连接到攻击者指定的IP地址和端口，然后将标准输入、输出和错误重定向到该socket，最后执行 `/bin/bash`，从而建立一个反向shell。
3.  **上传Payload：**  脚本将构造的包含恶意代码的请求发送到 `/hardware` 页面。
4.  **触发编译：**  脚本访问 `/compile-program?file=blank_program.st` 页面，触发 OpenPLC 编译包含恶意代码的“硬件层”。
5.  **建立反向Shell：**  一旦代码被编译和执行，目标系统会连接到攻击者的监听端口，从而允许攻击者执行任意命令。

**有效性：** 根据搜索结果和PoC代码，该漏洞的利用是有效的，可以实现远程代码执行。

**投毒风险：**
查看了README，发现sealldev修改了Hunt3r0x提交的代码，移除了政治信息并且修复了拼写错误。main.py中，baseURL 被硬编码为 "http://wifinetictwo.htb:8080"，这表明此PoC是为HackTheBox的 "WifineticTwo" 靶机设计的，存在诱导使用者在相同IP环境下执行恶意代码风险。同时，PoC中的代码本身包含一个反向shell，这在某些情况下可能被认为是具有攻击性的。但此反向shell是漏洞利用的一部分，不能简单地归类为投毒。
综上，代码的投毒风险较低，大约为 10%。这个百分比主要考虑到脚本的针对性和潜在的非预期使用情况。

**项目地址:** [sealldeveloper/CVE-2021-31630-PoC](https://github.com/sealldeveloper/CVE-2021-31630-PoC)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #10

**来源**: [CVE-2021-31630-thewhiteh4t_cve-2021-31630.md](../2021/CVE-2021-31630-thewhiteh4t_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver v3

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要身份验证和网络访问/hardware页面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，攻击者可以通过“Hardware Layer Code Box”组件注入恶意命令。漏洞利用方式如下：

1.  **漏洞描述：** CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞，允许经过身份验证的远程攻击者通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件执行任意代码。
2.  **搜索引擎结果：** 多个搜索结果表明该漏洞的描述，影响版本和利用方法。其中github链接指向了可利用的poc代码
3.  **漏洞利用代码分析：**
    *   POC 代码是一个 Python 脚本，用于利用 OpenPLC Webserver v3 中的命令注入漏洞。
    *   脚本首先登录到 OpenPLC Webserver v3，默认用户名和密码为 openplc/openplc。
    *   然后，脚本将默认程序还原，接着上传一个包含反向 shell 的特制 C 代码到`/hardware` 页面的 "Hardware Layer Code Box"。
    *   上传的C代码会被编译和执行，从而在目标系统上建立一个反向 shell 连接到攻击者的机器，IP地址和端口由脚本参数`-lh` 和 `-lp`指定。
    *   最后，脚本停止并清理PLC服务。
4.  **有效性评估：** 提供的 POC 代码有效，能够实现远程代码执行。
5.  **投毒风险评估：**
    *   该仓库的主要功能是提供漏洞利用代码，帮助研究人员验证和理解漏洞，但并不能完全排除投毒风险。
    *   `cve_2021_31630.py` 主要功能是利用漏洞，其本身没有明显的恶意代码，但使用者有可能会修改此脚本植入恶意代码
    *   `README.md`文件描述了漏洞利用过程和代码功能。
    *   综合来看，投毒风险较低，但是由于代码可能被篡改，仍存在一定的潜在风险。投毒风险估算为5%。
6. **漏洞利用方式：**
  1. 登录到OpenPLC Webserver v3。
  2. 停止当前PLC服务，清理环境。
  3. 上传包含恶意命令的C代码（通过`custom_layer_code`参数）到 `/hardware` 页面的 "Hardware Layer Code Box" 组件。
  4. 触发编译过程 (`/compile-program?file=blank_program.st`)，使恶意代码得到执行。
  5. 启动PLC服务，执行恶意代码（反向shell）
  6. 清理PLC服务。


**项目地址:** [thewhiteh4t/cve-2021-31630](https://github.com/thewhiteh4t/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #11

**来源**: [CVE-2021-31630-ttps-byte_cve-2021-31630.md](../2021/CVE-2021-31630-ttps-byte_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** v3

**利用条件:** 需要网络访问和有效的OpenPLC Webserver v3实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 存在于 OpenPLC Webserver v3 中，允许远程攻击者通过 "Hardware Layer Code Box" 组件在 "/hardware" 页面上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（breakerplc.py），此漏洞的POC代码是有效的。该代码利用命令注入漏洞，通过修改 "Hardware Layer Code Box" 中的代码来执行恶意命令，从而获得服务器的shell访问权限。

**投毒风险：**
通过分析 `breakerplc.py` 脚本，存在一定的投毒风险。具体分析如下：
*   **优点：**
    *   代码结构清晰，功能模块化，易于理解。
    *   脚本使用 `argparse` 模块处理命令行参数，方便用户自定义目标URL、用户名、密码、LHOST、LPORT等信息。
    *   脚本包含完整的漏洞利用流程，包括登录、上传payload、编译程序、触发漏洞等步骤。
*   **缺点和潜在投毒点：**
    *   脚本的安全性取决于用户的输入，如果用户输入不安全的参数（例如恶意的LHOST或LPORT），可能导致反弹shell到错误的地址或端口。
    *   脚本中使用了 `subprocess.Popen` 函数来启动 nc 监听，这部分代码可能存在安全风险，例如命令注入等。
    *  虽然脚本本身目的是利用命令注入，但仓库创建者可能通过其它方式植入后门代码，考虑到github仓库的普遍性及POC仓库的安全性，故风险较低。
*   **投毒风险评估：**
    代码主要功能是利用命令注入，虽然有潜在风险，但是并未发现明显的恶意代码或后门。因此，评估投毒风险为 **10%**。

**利用方式：**
利用此漏洞的步骤如下：
1.  使用提供的 `breakerplc.py` 脚本，并提供目标 OpenPLC Webserver v3 的 URL。
2.  提供有效的用户名和密码进行身份验证（默认是 openplc/openplc）。
3.  指定攻击者的监听 IP 地址 (LHOST) 和端口 (LPORT)，用于接收反弹 shell。
4.  脚本将构造包含反向 shell 命令的恶意代码，并通过 "Hardware Layer Code Box" 上传到目标服务器。
5.  脚本触发编译，由于存在命令注入漏洞，恶意代码将被执行，从而在攻击者机器上建立反向 shell 连接。
6.  连接后，可能需要输入命令(如whoami或者ls)来打破代码行，获取返回shell。

**项目地址:** [ttps-byte/cve-2021-31630](https://github.com/ttps-byte/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---



---

## POC #8

**来源**: [CVE-2021-31630-mind2hex_CVE-2021-31630.md](../2021/CVE-2021-31630-mind2hex_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者需要具有Web应用的登录权限，访问/hardware页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者通过利用"Hardware Layer Code Box"组件，可以在/hardware页面上执行任意代码。从搜索引擎结果来看，多个安全平台都记录了该漏洞，并确认了其严重性。提供的漏洞利用代码是一个Python脚本，它首先通过提供的用户名和密码登录到OpenPLC Web服务器。然后，它会构造一个包含反向shell命令的恶意C代码，并将其注入到“Hardware Layer Code Box”中。当OpenPLC Web服务器尝试编译和执行这段C代码时，就会执行攻击者注入的命令，从而建立一个反向shell连接到攻击者的机器上。由于该脚本的主要功能是利用命令注入漏洞建立反向shell，因此不存在明显的投毒代码。

**有效性分析：**
POC代码有效，因为代码实现了利用漏洞描述中提到的"Hardware Layer Code Box"组件在/hardware页面执行任意代码。通过修改C代码中的IP地址和端口，可以实现反向shell。

**投毒风险分析：**
提供的POC代码主要是利用漏洞建立反向shell，并未发现明显的恶意代码。脚本只是将用户提供的IP地址和端口插入到C代码中，并发送到目标服务器。因此，可以认为投毒风险较低，约为0%。

**利用方式分析：**
1.  攻击者需要拥有OpenPLC Webserver的登录凭证（默认用户名/密码通常是openplc/openplc，攻击者可能需要先进行密码爆破或者其他手段获取凭据）。
2.  攻击者使用提供的Python脚本，指定目标OpenPLC Webserver的URL、用户名、密码以及反向shell的IP地址和端口。
3.  脚本首先登录到OpenPLC Webserver。
4.  脚本构造包含恶意命令的C代码（反向shell）。
5.  脚本将恶意的C代码发送到/hardware页面的“Hardware Layer Code Box”组件。
6.  OpenPLC Webserver尝试编译并执行这段C代码，从而在服务器上执行攻击者注入的命令。
7.  攻击者在其监听端口上接收到反向shell连接，从而获得对OpenPLC Webserver服务器的控制权。

**项目地址:** [mind2hex/CVE-2021-31630](https://github.com/mind2hex/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #9

**来源**: [CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md](../2021/CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md)

## CVE-2021-31630-OpenPLC Webserver-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 漏洞存在于 OpenPLC Webserver v3 的 `/hardware` 页面，允许远程攻击者通过 "Hardware Layer Code Box" 组件执行任意代码。根据提供的PoC代码，利用方式如下：

1.  **身份验证：**  PoC脚本首先使用提供的用户名和密码登录到 OpenPLC Webserver。
2.  **构造恶意Payload：**  脚本构造一个包含反向shell的C代码，该代码被注入到 "Hardware Layer Code Box" 中。该C代码会创建一个socket连接到攻击者指定的IP地址和端口，然后将标准输入、输出和错误重定向到该socket，最后执行 `/bin/bash`，从而建立一个反向shell。
3.  **上传Payload：**  脚本将构造的包含恶意代码的请求发送到 `/hardware` 页面。
4.  **触发编译：**  脚本访问 `/compile-program?file=blank_program.st` 页面，触发 OpenPLC 编译包含恶意代码的“硬件层”。
5.  **建立反向Shell：**  一旦代码被编译和执行，目标系统会连接到攻击者的监听端口，从而允许攻击者执行任意命令。

**有效性：** 根据搜索结果和PoC代码，该漏洞的利用是有效的，可以实现远程代码执行。

**投毒风险：**
查看了README，发现sealldev修改了Hunt3r0x提交的代码，移除了政治信息并且修复了拼写错误。main.py中，baseURL 被硬编码为 "http://wifinetictwo.htb:8080"，这表明此PoC是为HackTheBox的 "WifineticTwo" 靶机设计的，存在诱导使用者在相同IP环境下执行恶意代码风险。同时，PoC中的代码本身包含一个反向shell，这在某些情况下可能被认为是具有攻击性的。但此反向shell是漏洞利用的一部分，不能简单地归类为投毒。
综上，代码的投毒风险较低，大约为 10%。这个百分比主要考虑到脚本的针对性和潜在的非预期使用情况。

**项目地址:** [sealldeveloper/CVE-2021-31630-PoC](https://github.com/sealldeveloper/CVE-2021-31630-PoC)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #10

**来源**: [CVE-2021-31630-thewhiteh4t_cve-2021-31630.md](../2021/CVE-2021-31630-thewhiteh4t_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver v3

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要身份验证和网络访问/hardware页面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，攻击者可以通过“Hardware Layer Code Box”组件注入恶意命令。漏洞利用方式如下：

1.  **漏洞描述：** CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞，允许经过身份验证的远程攻击者通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件执行任意代码。
2.  **搜索引擎结果：** 多个搜索结果表明该漏洞的描述，影响版本和利用方法。其中github链接指向了可利用的poc代码
3.  **漏洞利用代码分析：**
    *   POC 代码是一个 Python 脚本，用于利用 OpenPLC Webserver v3 中的命令注入漏洞。
    *   脚本首先登录到 OpenPLC Webserver v3，默认用户名和密码为 openplc/openplc。
    *   然后，脚本将默认程序还原，接着上传一个包含反向 shell 的特制 C 代码到`/hardware` 页面的 "Hardware Layer Code Box"。
    *   上传的C代码会被编译和执行，从而在目标系统上建立一个反向 shell 连接到攻击者的机器，IP地址和端口由脚本参数`-lh` 和 `-lp`指定。
    *   最后，脚本停止并清理PLC服务。
4.  **有效性评估：** 提供的 POC 代码有效，能够实现远程代码执行。
5.  **投毒风险评估：**
    *   该仓库的主要功能是提供漏洞利用代码，帮助研究人员验证和理解漏洞，但并不能完全排除投毒风险。
    *   `cve_2021_31630.py` 主要功能是利用漏洞，其本身没有明显的恶意代码，但使用者有可能会修改此脚本植入恶意代码
    *   `README.md`文件描述了漏洞利用过程和代码功能。
    *   综合来看，投毒风险较低，但是由于代码可能被篡改，仍存在一定的潜在风险。投毒风险估算为5%。
6. **漏洞利用方式：**
  1. 登录到OpenPLC Webserver v3。
  2. 停止当前PLC服务，清理环境。
  3. 上传包含恶意命令的C代码（通过`custom_layer_code`参数）到 `/hardware` 页面的 "Hardware Layer Code Box" 组件。
  4. 触发编译过程 (`/compile-program?file=blank_program.st`)，使恶意代码得到执行。
  5. 启动PLC服务，执行恶意代码（反向shell）
  6. 清理PLC服务。


**项目地址:** [thewhiteh4t/cve-2021-31630](https://github.com/thewhiteh4t/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #11

**来源**: [CVE-2021-31630-ttps-byte_cve-2021-31630.md](../2021/CVE-2021-31630-ttps-byte_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** v3

**利用条件:** 需要网络访问和有效的OpenPLC Webserver v3实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 存在于 OpenPLC Webserver v3 中，允许远程攻击者通过 "Hardware Layer Code Box" 组件在 "/hardware" 页面上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（breakerplc.py），此漏洞的POC代码是有效的。该代码利用命令注入漏洞，通过修改 "Hardware Layer Code Box" 中的代码来执行恶意命令，从而获得服务器的shell访问权限。

**投毒风险：**
通过分析 `breakerplc.py` 脚本，存在一定的投毒风险。具体分析如下：
*   **优点：**
    *   代码结构清晰，功能模块化，易于理解。
    *   脚本使用 `argparse` 模块处理命令行参数，方便用户自定义目标URL、用户名、密码、LHOST、LPORT等信息。
    *   脚本包含完整的漏洞利用流程，包括登录、上传payload、编译程序、触发漏洞等步骤。
*   **缺点和潜在投毒点：**
    *   脚本的安全性取决于用户的输入，如果用户输入不安全的参数（例如恶意的LHOST或LPORT），可能导致反弹shell到错误的地址或端口。
    *   脚本中使用了 `subprocess.Popen` 函数来启动 nc 监听，这部分代码可能存在安全风险，例如命令注入等。
    *  虽然脚本本身目的是利用命令注入，但仓库创建者可能通过其它方式植入后门代码，考虑到github仓库的普遍性及POC仓库的安全性，故风险较低。
*   **投毒风险评估：**
    代码主要功能是利用命令注入，虽然有潜在风险，但是并未发现明显的恶意代码或后门。因此，评估投毒风险为 **10%**。

**利用方式：**
利用此漏洞的步骤如下：
1.  使用提供的 `breakerplc.py` 脚本，并提供目标 OpenPLC Webserver v3 的 URL。
2.  提供有效的用户名和密码进行身份验证（默认是 openplc/openplc）。
3.  指定攻击者的监听 IP 地址 (LHOST) 和端口 (LPORT)，用于接收反弹 shell。
4.  脚本将构造包含反向 shell 命令的恶意代码，并通过 "Hardware Layer Code Box" 上传到目标服务器。
5.  脚本触发编译，由于存在命令注入漏洞，恶意代码将被执行，从而在攻击者机器上建立反向 shell 连接。
6.  连接后，可能需要输入命令(如whoami或者ls)来打破代码行，获取返回shell。

**项目地址:** [ttps-byte/cve-2021-31630](https://github.com/ttps-byte/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---



---

## POC #8

**来源**: [CVE-2021-31630-mind2hex_CVE-2021-31630.md](../2021/CVE-2021-31630-mind2hex_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者需要具有Web应用的登录权限，访问/hardware页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者通过利用"Hardware Layer Code Box"组件，可以在/hardware页面上执行任意代码。从搜索引擎结果来看，多个安全平台都记录了该漏洞，并确认了其严重性。提供的漏洞利用代码是一个Python脚本，它首先通过提供的用户名和密码登录到OpenPLC Web服务器。然后，它会构造一个包含反向shell命令的恶意C代码，并将其注入到“Hardware Layer Code Box”中。当OpenPLC Web服务器尝试编译和执行这段C代码时，就会执行攻击者注入的命令，从而建立一个反向shell连接到攻击者的机器上。由于该脚本的主要功能是利用命令注入漏洞建立反向shell，因此不存在明显的投毒代码。

**有效性分析：**
POC代码有效，因为代码实现了利用漏洞描述中提到的"Hardware Layer Code Box"组件在/hardware页面执行任意代码。通过修改C代码中的IP地址和端口，可以实现反向shell。

**投毒风险分析：**
提供的POC代码主要是利用漏洞建立反向shell，并未发现明显的恶意代码。脚本只是将用户提供的IP地址和端口插入到C代码中，并发送到目标服务器。因此，可以认为投毒风险较低，约为0%。

**利用方式分析：**
1.  攻击者需要拥有OpenPLC Webserver的登录凭证（默认用户名/密码通常是openplc/openplc，攻击者可能需要先进行密码爆破或者其他手段获取凭据）。
2.  攻击者使用提供的Python脚本，指定目标OpenPLC Webserver的URL、用户名、密码以及反向shell的IP地址和端口。
3.  脚本首先登录到OpenPLC Webserver。
4.  脚本构造包含恶意命令的C代码（反向shell）。
5.  脚本将恶意的C代码发送到/hardware页面的“Hardware Layer Code Box”组件。
6.  OpenPLC Webserver尝试编译并执行这段C代码，从而在服务器上执行攻击者注入的命令。
7.  攻击者在其监听端口上接收到反向shell连接，从而获得对OpenPLC Webserver服务器的控制权。

**项目地址:** [mind2hex/CVE-2021-31630](https://github.com/mind2hex/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #9

**来源**: [CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md](../2021/CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md)

## CVE-2021-31630-OpenPLC Webserver-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 漏洞存在于 OpenPLC Webserver v3 的 `/hardware` 页面，允许远程攻击者通过 "Hardware Layer Code Box" 组件执行任意代码。根据提供的PoC代码，利用方式如下：

1.  **身份验证：**  PoC脚本首先使用提供的用户名和密码登录到 OpenPLC Webserver。
2.  **构造恶意Payload：**  脚本构造一个包含反向shell的C代码，该代码被注入到 "Hardware Layer Code Box" 中。该C代码会创建一个socket连接到攻击者指定的IP地址和端口，然后将标准输入、输出和错误重定向到该socket，最后执行 `/bin/bash`，从而建立一个反向shell。
3.  **上传Payload：**  脚本将构造的包含恶意代码的请求发送到 `/hardware` 页面。
4.  **触发编译：**  脚本访问 `/compile-program?file=blank_program.st` 页面，触发 OpenPLC 编译包含恶意代码的“硬件层”。
5.  **建立反向Shell：**  一旦代码被编译和执行，目标系统会连接到攻击者的监听端口，从而允许攻击者执行任意命令。

**有效性：** 根据搜索结果和PoC代码，该漏洞的利用是有效的，可以实现远程代码执行。

**投毒风险：**
查看了README，发现sealldev修改了Hunt3r0x提交的代码，移除了政治信息并且修复了拼写错误。main.py中，baseURL 被硬编码为 "http://wifinetictwo.htb:8080"，这表明此PoC是为HackTheBox的 "WifineticTwo" 靶机设计的，存在诱导使用者在相同IP环境下执行恶意代码风险。同时，PoC中的代码本身包含一个反向shell，这在某些情况下可能被认为是具有攻击性的。但此反向shell是漏洞利用的一部分，不能简单地归类为投毒。
综上，代码的投毒风险较低，大约为 10%。这个百分比主要考虑到脚本的针对性和潜在的非预期使用情况。

**项目地址:** [sealldeveloper/CVE-2021-31630-PoC](https://github.com/sealldeveloper/CVE-2021-31630-PoC)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #10

**来源**: [CVE-2021-31630-thewhiteh4t_cve-2021-31630.md](../2021/CVE-2021-31630-thewhiteh4t_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver v3

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要身份验证和网络访问/hardware页面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，攻击者可以通过“Hardware Layer Code Box”组件注入恶意命令。漏洞利用方式如下：

1.  **漏洞描述：** CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞，允许经过身份验证的远程攻击者通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件执行任意代码。
2.  **搜索引擎结果：** 多个搜索结果表明该漏洞的描述，影响版本和利用方法。其中github链接指向了可利用的poc代码
3.  **漏洞利用代码分析：**
    *   POC 代码是一个 Python 脚本，用于利用 OpenPLC Webserver v3 中的命令注入漏洞。
    *   脚本首先登录到 OpenPLC Webserver v3，默认用户名和密码为 openplc/openplc。
    *   然后，脚本将默认程序还原，接着上传一个包含反向 shell 的特制 C 代码到`/hardware` 页面的 "Hardware Layer Code Box"。
    *   上传的C代码会被编译和执行，从而在目标系统上建立一个反向 shell 连接到攻击者的机器，IP地址和端口由脚本参数`-lh` 和 `-lp`指定。
    *   最后，脚本停止并清理PLC服务。
4.  **有效性评估：** 提供的 POC 代码有效，能够实现远程代码执行。
5.  **投毒风险评估：**
    *   该仓库的主要功能是提供漏洞利用代码，帮助研究人员验证和理解漏洞，但并不能完全排除投毒风险。
    *   `cve_2021_31630.py` 主要功能是利用漏洞，其本身没有明显的恶意代码，但使用者有可能会修改此脚本植入恶意代码
    *   `README.md`文件描述了漏洞利用过程和代码功能。
    *   综合来看，投毒风险较低，但是由于代码可能被篡改，仍存在一定的潜在风险。投毒风险估算为5%。
6. **漏洞利用方式：**
  1. 登录到OpenPLC Webserver v3。
  2. 停止当前PLC服务，清理环境。
  3. 上传包含恶意命令的C代码（通过`custom_layer_code`参数）到 `/hardware` 页面的 "Hardware Layer Code Box" 组件。
  4. 触发编译过程 (`/compile-program?file=blank_program.st`)，使恶意代码得到执行。
  5. 启动PLC服务，执行恶意代码（反向shell）
  6. 清理PLC服务。


**项目地址:** [thewhiteh4t/cve-2021-31630](https://github.com/thewhiteh4t/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #11

**来源**: [CVE-2021-31630-ttps-byte_cve-2021-31630.md](../2021/CVE-2021-31630-ttps-byte_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** v3

**利用条件:** 需要网络访问和有效的OpenPLC Webserver v3实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 存在于 OpenPLC Webserver v3 中，允许远程攻击者通过 "Hardware Layer Code Box" 组件在 "/hardware" 页面上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（breakerplc.py），此漏洞的POC代码是有效的。该代码利用命令注入漏洞，通过修改 "Hardware Layer Code Box" 中的代码来执行恶意命令，从而获得服务器的shell访问权限。

**投毒风险：**
通过分析 `breakerplc.py` 脚本，存在一定的投毒风险。具体分析如下：
*   **优点：**
    *   代码结构清晰，功能模块化，易于理解。
    *   脚本使用 `argparse` 模块处理命令行参数，方便用户自定义目标URL、用户名、密码、LHOST、LPORT等信息。
    *   脚本包含完整的漏洞利用流程，包括登录、上传payload、编译程序、触发漏洞等步骤。
*   **缺点和潜在投毒点：**
    *   脚本的安全性取决于用户的输入，如果用户输入不安全的参数（例如恶意的LHOST或LPORT），可能导致反弹shell到错误的地址或端口。
    *   脚本中使用了 `subprocess.Popen` 函数来启动 nc 监听，这部分代码可能存在安全风险，例如命令注入等。
    *  虽然脚本本身目的是利用命令注入，但仓库创建者可能通过其它方式植入后门代码，考虑到github仓库的普遍性及POC仓库的安全性，故风险较低。
*   **投毒风险评估：**
    代码主要功能是利用命令注入，虽然有潜在风险，但是并未发现明显的恶意代码或后门。因此，评估投毒风险为 **10%**。

**利用方式：**
利用此漏洞的步骤如下：
1.  使用提供的 `breakerplc.py` 脚本，并提供目标 OpenPLC Webserver v3 的 URL。
2.  提供有效的用户名和密码进行身份验证（默认是 openplc/openplc）。
3.  指定攻击者的监听 IP 地址 (LHOST) 和端口 (LPORT)，用于接收反弹 shell。
4.  脚本将构造包含反向 shell 命令的恶意代码，并通过 "Hardware Layer Code Box" 上传到目标服务器。
5.  脚本触发编译，由于存在命令注入漏洞，恶意代码将被执行，从而在攻击者机器上建立反向 shell 连接。
6.  连接后，可能需要输入命令(如whoami或者ls)来打破代码行，获取返回shell。

**项目地址:** [ttps-byte/cve-2021-31630](https://github.com/ttps-byte/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---



---

## POC #8

**来源**: [CVE-2021-31630-mind2hex_CVE-2021-31630.md](../2021/CVE-2021-31630-mind2hex_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者需要具有Web应用的登录权限，访问/hardware页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者通过利用"Hardware Layer Code Box"组件，可以在/hardware页面上执行任意代码。从搜索引擎结果来看，多个安全平台都记录了该漏洞，并确认了其严重性。提供的漏洞利用代码是一个Python脚本，它首先通过提供的用户名和密码登录到OpenPLC Web服务器。然后，它会构造一个包含反向shell命令的恶意C代码，并将其注入到“Hardware Layer Code Box”中。当OpenPLC Web服务器尝试编译和执行这段C代码时，就会执行攻击者注入的命令，从而建立一个反向shell连接到攻击者的机器上。由于该脚本的主要功能是利用命令注入漏洞建立反向shell，因此不存在明显的投毒代码。

**有效性分析：**
POC代码有效，因为代码实现了利用漏洞描述中提到的"Hardware Layer Code Box"组件在/hardware页面执行任意代码。通过修改C代码中的IP地址和端口，可以实现反向shell。

**投毒风险分析：**
提供的POC代码主要是利用漏洞建立反向shell，并未发现明显的恶意代码。脚本只是将用户提供的IP地址和端口插入到C代码中，并发送到目标服务器。因此，可以认为投毒风险较低，约为0%。

**利用方式分析：**
1.  攻击者需要拥有OpenPLC Webserver的登录凭证（默认用户名/密码通常是openplc/openplc，攻击者可能需要先进行密码爆破或者其他手段获取凭据）。
2.  攻击者使用提供的Python脚本，指定目标OpenPLC Webserver的URL、用户名、密码以及反向shell的IP地址和端口。
3.  脚本首先登录到OpenPLC Webserver。
4.  脚本构造包含恶意命令的C代码（反向shell）。
5.  脚本将恶意的C代码发送到/hardware页面的“Hardware Layer Code Box”组件。
6.  OpenPLC Webserver尝试编译并执行这段C代码，从而在服务器上执行攻击者注入的命令。
7.  攻击者在其监听端口上接收到反向shell连接，从而获得对OpenPLC Webserver服务器的控制权。

**项目地址:** [mind2hex/CVE-2021-31630](https://github.com/mind2hex/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #9

**来源**: [CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md](../2021/CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md)

## CVE-2021-31630-OpenPLC Webserver-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 漏洞存在于 OpenPLC Webserver v3 的 `/hardware` 页面，允许远程攻击者通过 "Hardware Layer Code Box" 组件执行任意代码。根据提供的PoC代码，利用方式如下：

1.  **身份验证：**  PoC脚本首先使用提供的用户名和密码登录到 OpenPLC Webserver。
2.  **构造恶意Payload：**  脚本构造一个包含反向shell的C代码，该代码被注入到 "Hardware Layer Code Box" 中。该C代码会创建一个socket连接到攻击者指定的IP地址和端口，然后将标准输入、输出和错误重定向到该socket，最后执行 `/bin/bash`，从而建立一个反向shell。
3.  **上传Payload：**  脚本将构造的包含恶意代码的请求发送到 `/hardware` 页面。
4.  **触发编译：**  脚本访问 `/compile-program?file=blank_program.st` 页面，触发 OpenPLC 编译包含恶意代码的“硬件层”。
5.  **建立反向Shell：**  一旦代码被编译和执行，目标系统会连接到攻击者的监听端口，从而允许攻击者执行任意命令。

**有效性：** 根据搜索结果和PoC代码，该漏洞的利用是有效的，可以实现远程代码执行。

**投毒风险：**
查看了README，发现sealldev修改了Hunt3r0x提交的代码，移除了政治信息并且修复了拼写错误。main.py中，baseURL 被硬编码为 "http://wifinetictwo.htb:8080"，这表明此PoC是为HackTheBox的 "WifineticTwo" 靶机设计的，存在诱导使用者在相同IP环境下执行恶意代码风险。同时，PoC中的代码本身包含一个反向shell，这在某些情况下可能被认为是具有攻击性的。但此反向shell是漏洞利用的一部分，不能简单地归类为投毒。
综上，代码的投毒风险较低，大约为 10%。这个百分比主要考虑到脚本的针对性和潜在的非预期使用情况。

**项目地址:** [sealldeveloper/CVE-2021-31630-PoC](https://github.com/sealldeveloper/CVE-2021-31630-PoC)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #10

**来源**: [CVE-2021-31630-thewhiteh4t_cve-2021-31630.md](../2021/CVE-2021-31630-thewhiteh4t_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver v3

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要身份验证和网络访问/hardware页面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，攻击者可以通过“Hardware Layer Code Box”组件注入恶意命令。漏洞利用方式如下：

1.  **漏洞描述：** CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞，允许经过身份验证的远程攻击者通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件执行任意代码。
2.  **搜索引擎结果：** 多个搜索结果表明该漏洞的描述，影响版本和利用方法。其中github链接指向了可利用的poc代码
3.  **漏洞利用代码分析：**
    *   POC 代码是一个 Python 脚本，用于利用 OpenPLC Webserver v3 中的命令注入漏洞。
    *   脚本首先登录到 OpenPLC Webserver v3，默认用户名和密码为 openplc/openplc。
    *   然后，脚本将默认程序还原，接着上传一个包含反向 shell 的特制 C 代码到`/hardware` 页面的 "Hardware Layer Code Box"。
    *   上传的C代码会被编译和执行，从而在目标系统上建立一个反向 shell 连接到攻击者的机器，IP地址和端口由脚本参数`-lh` 和 `-lp`指定。
    *   最后，脚本停止并清理PLC服务。
4.  **有效性评估：** 提供的 POC 代码有效，能够实现远程代码执行。
5.  **投毒风险评估：**
    *   该仓库的主要功能是提供漏洞利用代码，帮助研究人员验证和理解漏洞，但并不能完全排除投毒风险。
    *   `cve_2021_31630.py` 主要功能是利用漏洞，其本身没有明显的恶意代码，但使用者有可能会修改此脚本植入恶意代码
    *   `README.md`文件描述了漏洞利用过程和代码功能。
    *   综合来看，投毒风险较低，但是由于代码可能被篡改，仍存在一定的潜在风险。投毒风险估算为5%。
6. **漏洞利用方式：**
  1. 登录到OpenPLC Webserver v3。
  2. 停止当前PLC服务，清理环境。
  3. 上传包含恶意命令的C代码（通过`custom_layer_code`参数）到 `/hardware` 页面的 "Hardware Layer Code Box" 组件。
  4. 触发编译过程 (`/compile-program?file=blank_program.st`)，使恶意代码得到执行。
  5. 启动PLC服务，执行恶意代码（反向shell）
  6. 清理PLC服务。


**项目地址:** [thewhiteh4t/cve-2021-31630](https://github.com/thewhiteh4t/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #11

**来源**: [CVE-2021-31630-ttps-byte_cve-2021-31630.md](../2021/CVE-2021-31630-ttps-byte_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** v3

**利用条件:** 需要网络访问和有效的OpenPLC Webserver v3实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 存在于 OpenPLC Webserver v3 中，允许远程攻击者通过 "Hardware Layer Code Box" 组件在 "/hardware" 页面上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（breakerplc.py），此漏洞的POC代码是有效的。该代码利用命令注入漏洞，通过修改 "Hardware Layer Code Box" 中的代码来执行恶意命令，从而获得服务器的shell访问权限。

**投毒风险：**
通过分析 `breakerplc.py` 脚本，存在一定的投毒风险。具体分析如下：
*   **优点：**
    *   代码结构清晰，功能模块化，易于理解。
    *   脚本使用 `argparse` 模块处理命令行参数，方便用户自定义目标URL、用户名、密码、LHOST、LPORT等信息。
    *   脚本包含完整的漏洞利用流程，包括登录、上传payload、编译程序、触发漏洞等步骤。
*   **缺点和潜在投毒点：**
    *   脚本的安全性取决于用户的输入，如果用户输入不安全的参数（例如恶意的LHOST或LPORT），可能导致反弹shell到错误的地址或端口。
    *   脚本中使用了 `subprocess.Popen` 函数来启动 nc 监听，这部分代码可能存在安全风险，例如命令注入等。
    *  虽然脚本本身目的是利用命令注入，但仓库创建者可能通过其它方式植入后门代码，考虑到github仓库的普遍性及POC仓库的安全性，故风险较低。
*   **投毒风险评估：**
    代码主要功能是利用命令注入，虽然有潜在风险，但是并未发现明显的恶意代码或后门。因此，评估投毒风险为 **10%**。

**利用方式：**
利用此漏洞的步骤如下：
1.  使用提供的 `breakerplc.py` 脚本，并提供目标 OpenPLC Webserver v3 的 URL。
2.  提供有效的用户名和密码进行身份验证（默认是 openplc/openplc）。
3.  指定攻击者的监听 IP 地址 (LHOST) 和端口 (LPORT)，用于接收反弹 shell。
4.  脚本将构造包含反向 shell 命令的恶意代码，并通过 "Hardware Layer Code Box" 上传到目标服务器。
5.  脚本触发编译，由于存在命令注入漏洞，恶意代码将被执行，从而在攻击者机器上建立反向 shell 连接。
6.  连接后，可能需要输入命令(如whoami或者ls)来打破代码行，获取返回shell。

**项目地址:** [ttps-byte/cve-2021-31630](https://github.com/ttps-byte/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---



---

## POC #8

**来源**: [CVE-2021-31630-mind2hex_CVE-2021-31630.md](../2021/CVE-2021-31630-mind2hex_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者需要具有Web应用的登录权限，访问/hardware页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者通过利用"Hardware Layer Code Box"组件，可以在/hardware页面上执行任意代码。从搜索引擎结果来看，多个安全平台都记录了该漏洞，并确认了其严重性。提供的漏洞利用代码是一个Python脚本，它首先通过提供的用户名和密码登录到OpenPLC Web服务器。然后，它会构造一个包含反向shell命令的恶意C代码，并将其注入到“Hardware Layer Code Box”中。当OpenPLC Web服务器尝试编译和执行这段C代码时，就会执行攻击者注入的命令，从而建立一个反向shell连接到攻击者的机器上。由于该脚本的主要功能是利用命令注入漏洞建立反向shell，因此不存在明显的投毒代码。

**有效性分析：**
POC代码有效，因为代码实现了利用漏洞描述中提到的"Hardware Layer Code Box"组件在/hardware页面执行任意代码。通过修改C代码中的IP地址和端口，可以实现反向shell。

**投毒风险分析：**
提供的POC代码主要是利用漏洞建立反向shell，并未发现明显的恶意代码。脚本只是将用户提供的IP地址和端口插入到C代码中，并发送到目标服务器。因此，可以认为投毒风险较低，约为0%。

**利用方式分析：**
1.  攻击者需要拥有OpenPLC Webserver的登录凭证（默认用户名/密码通常是openplc/openplc，攻击者可能需要先进行密码爆破或者其他手段获取凭据）。
2.  攻击者使用提供的Python脚本，指定目标OpenPLC Webserver的URL、用户名、密码以及反向shell的IP地址和端口。
3.  脚本首先登录到OpenPLC Webserver。
4.  脚本构造包含恶意命令的C代码（反向shell）。
5.  脚本将恶意的C代码发送到/hardware页面的“Hardware Layer Code Box”组件。
6.  OpenPLC Webserver尝试编译并执行这段C代码，从而在服务器上执行攻击者注入的命令。
7.  攻击者在其监听端口上接收到反向shell连接，从而获得对OpenPLC Webserver服务器的控制权。

**项目地址:** [mind2hex/CVE-2021-31630](https://github.com/mind2hex/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #9

**来源**: [CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md](../2021/CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md)

## CVE-2021-31630-OpenPLC Webserver-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 漏洞存在于 OpenPLC Webserver v3 的 `/hardware` 页面，允许远程攻击者通过 "Hardware Layer Code Box" 组件执行任意代码。根据提供的PoC代码，利用方式如下：

1.  **身份验证：**  PoC脚本首先使用提供的用户名和密码登录到 OpenPLC Webserver。
2.  **构造恶意Payload：**  脚本构造一个包含反向shell的C代码，该代码被注入到 "Hardware Layer Code Box" 中。该C代码会创建一个socket连接到攻击者指定的IP地址和端口，然后将标准输入、输出和错误重定向到该socket，最后执行 `/bin/bash`，从而建立一个反向shell。
3.  **上传Payload：**  脚本将构造的包含恶意代码的请求发送到 `/hardware` 页面。
4.  **触发编译：**  脚本访问 `/compile-program?file=blank_program.st` 页面，触发 OpenPLC 编译包含恶意代码的“硬件层”。
5.  **建立反向Shell：**  一旦代码被编译和执行，目标系统会连接到攻击者的监听端口，从而允许攻击者执行任意命令。

**有效性：** 根据搜索结果和PoC代码，该漏洞的利用是有效的，可以实现远程代码执行。

**投毒风险：**
查看了README，发现sealldev修改了Hunt3r0x提交的代码，移除了政治信息并且修复了拼写错误。main.py中，baseURL 被硬编码为 "http://wifinetictwo.htb:8080"，这表明此PoC是为HackTheBox的 "WifineticTwo" 靶机设计的，存在诱导使用者在相同IP环境下执行恶意代码风险。同时，PoC中的代码本身包含一个反向shell，这在某些情况下可能被认为是具有攻击性的。但此反向shell是漏洞利用的一部分，不能简单地归类为投毒。
综上，代码的投毒风险较低，大约为 10%。这个百分比主要考虑到脚本的针对性和潜在的非预期使用情况。

**项目地址:** [sealldeveloper/CVE-2021-31630-PoC](https://github.com/sealldeveloper/CVE-2021-31630-PoC)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #10

**来源**: [CVE-2021-31630-thewhiteh4t_cve-2021-31630.md](../2021/CVE-2021-31630-thewhiteh4t_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver v3

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要身份验证和网络访问/hardware页面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，攻击者可以通过“Hardware Layer Code Box”组件注入恶意命令。漏洞利用方式如下：

1.  **漏洞描述：** CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞，允许经过身份验证的远程攻击者通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件执行任意代码。
2.  **搜索引擎结果：** 多个搜索结果表明该漏洞的描述，影响版本和利用方法。其中github链接指向了可利用的poc代码
3.  **漏洞利用代码分析：**
    *   POC 代码是一个 Python 脚本，用于利用 OpenPLC Webserver v3 中的命令注入漏洞。
    *   脚本首先登录到 OpenPLC Webserver v3，默认用户名和密码为 openplc/openplc。
    *   然后，脚本将默认程序还原，接着上传一个包含反向 shell 的特制 C 代码到`/hardware` 页面的 "Hardware Layer Code Box"。
    *   上传的C代码会被编译和执行，从而在目标系统上建立一个反向 shell 连接到攻击者的机器，IP地址和端口由脚本参数`-lh` 和 `-lp`指定。
    *   最后，脚本停止并清理PLC服务。
4.  **有效性评估：** 提供的 POC 代码有效，能够实现远程代码执行。
5.  **投毒风险评估：**
    *   该仓库的主要功能是提供漏洞利用代码，帮助研究人员验证和理解漏洞，但并不能完全排除投毒风险。
    *   `cve_2021_31630.py` 主要功能是利用漏洞，其本身没有明显的恶意代码，但使用者有可能会修改此脚本植入恶意代码
    *   `README.md`文件描述了漏洞利用过程和代码功能。
    *   综合来看，投毒风险较低，但是由于代码可能被篡改，仍存在一定的潜在风险。投毒风险估算为5%。
6. **漏洞利用方式：**
  1. 登录到OpenPLC Webserver v3。
  2. 停止当前PLC服务，清理环境。
  3. 上传包含恶意命令的C代码（通过`custom_layer_code`参数）到 `/hardware` 页面的 "Hardware Layer Code Box" 组件。
  4. 触发编译过程 (`/compile-program?file=blank_program.st`)，使恶意代码得到执行。
  5. 启动PLC服务，执行恶意代码（反向shell）
  6. 清理PLC服务。


**项目地址:** [thewhiteh4t/cve-2021-31630](https://github.com/thewhiteh4t/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #11

**来源**: [CVE-2021-31630-ttps-byte_cve-2021-31630.md](../2021/CVE-2021-31630-ttps-byte_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** v3

**利用条件:** 需要网络访问和有效的OpenPLC Webserver v3实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 存在于 OpenPLC Webserver v3 中，允许远程攻击者通过 "Hardware Layer Code Box" 组件在 "/hardware" 页面上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（breakerplc.py），此漏洞的POC代码是有效的。该代码利用命令注入漏洞，通过修改 "Hardware Layer Code Box" 中的代码来执行恶意命令，从而获得服务器的shell访问权限。

**投毒风险：**
通过分析 `breakerplc.py` 脚本，存在一定的投毒风险。具体分析如下：
*   **优点：**
    *   代码结构清晰，功能模块化，易于理解。
    *   脚本使用 `argparse` 模块处理命令行参数，方便用户自定义目标URL、用户名、密码、LHOST、LPORT等信息。
    *   脚本包含完整的漏洞利用流程，包括登录、上传payload、编译程序、触发漏洞等步骤。
*   **缺点和潜在投毒点：**
    *   脚本的安全性取决于用户的输入，如果用户输入不安全的参数（例如恶意的LHOST或LPORT），可能导致反弹shell到错误的地址或端口。
    *   脚本中使用了 `subprocess.Popen` 函数来启动 nc 监听，这部分代码可能存在安全风险，例如命令注入等。
    *  虽然脚本本身目的是利用命令注入，但仓库创建者可能通过其它方式植入后门代码，考虑到github仓库的普遍性及POC仓库的安全性，故风险较低。
*   **投毒风险评估：**
    代码主要功能是利用命令注入，虽然有潜在风险，但是并未发现明显的恶意代码或后门。因此，评估投毒风险为 **10%**。

**利用方式：**
利用此漏洞的步骤如下：
1.  使用提供的 `breakerplc.py` 脚本，并提供目标 OpenPLC Webserver v3 的 URL。
2.  提供有效的用户名和密码进行身份验证（默认是 openplc/openplc）。
3.  指定攻击者的监听 IP 地址 (LHOST) 和端口 (LPORT)，用于接收反弹 shell。
4.  脚本将构造包含反向 shell 命令的恶意代码，并通过 "Hardware Layer Code Box" 上传到目标服务器。
5.  脚本触发编译，由于存在命令注入漏洞，恶意代码将被执行，从而在攻击者机器上建立反向 shell 连接。
6.  连接后，可能需要输入命令(如whoami或者ls)来打破代码行，获取返回shell。

**项目地址:** [ttps-byte/cve-2021-31630](https://github.com/ttps-byte/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---



---

## POC #8

**来源**: [CVE-2021-31630-mind2hex_CVE-2021-31630.md](../2021/CVE-2021-31630-mind2hex_CVE-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者需要具有Web应用的登录权限，访问/hardware页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-31630是OpenPLC Webserver v3中的一个命令注入漏洞。攻击者通过利用"Hardware Layer Code Box"组件，可以在/hardware页面上执行任意代码。从搜索引擎结果来看，多个安全平台都记录了该漏洞，并确认了其严重性。提供的漏洞利用代码是一个Python脚本，它首先通过提供的用户名和密码登录到OpenPLC Web服务器。然后，它会构造一个包含反向shell命令的恶意C代码，并将其注入到“Hardware Layer Code Box”中。当OpenPLC Web服务器尝试编译和执行这段C代码时，就会执行攻击者注入的命令，从而建立一个反向shell连接到攻击者的机器上。由于该脚本的主要功能是利用命令注入漏洞建立反向shell，因此不存在明显的投毒代码。

**有效性分析：**
POC代码有效，因为代码实现了利用漏洞描述中提到的"Hardware Layer Code Box"组件在/hardware页面执行任意代码。通过修改C代码中的IP地址和端口，可以实现反向shell。

**投毒风险分析：**
提供的POC代码主要是利用漏洞建立反向shell，并未发现明显的恶意代码。脚本只是将用户提供的IP地址和端口插入到C代码中，并发送到目标服务器。因此，可以认为投毒风险较低，约为0%。

**利用方式分析：**
1.  攻击者需要拥有OpenPLC Webserver的登录凭证（默认用户名/密码通常是openplc/openplc，攻击者可能需要先进行密码爆破或者其他手段获取凭据）。
2.  攻击者使用提供的Python脚本，指定目标OpenPLC Webserver的URL、用户名、密码以及反向shell的IP地址和端口。
3.  脚本首先登录到OpenPLC Webserver。
4.  脚本构造包含恶意命令的C代码（反向shell）。
5.  脚本将恶意的C代码发送到/hardware页面的“Hardware Layer Code Box”组件。
6.  OpenPLC Webserver尝试编译并执行这段C代码，从而在服务器上执行攻击者注入的命令。
7.  攻击者在其监听端口上接收到反向shell连接，从而获得对OpenPLC Webserver服务器的控制权。

**项目地址:** [mind2hex/CVE-2021-31630](https://github.com/mind2hex/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #9

**来源**: [CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md](../2021/CVE-2021-31630-sealldeveloper_CVE-2021-31630-PoC.md)

## CVE-2021-31630-OpenPLC Webserver-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 漏洞存在于 OpenPLC Webserver v3 的 `/hardware` 页面，允许远程攻击者通过 "Hardware Layer Code Box" 组件执行任意代码。根据提供的PoC代码，利用方式如下：

1.  **身份验证：**  PoC脚本首先使用提供的用户名和密码登录到 OpenPLC Webserver。
2.  **构造恶意Payload：**  脚本构造一个包含反向shell的C代码，该代码被注入到 "Hardware Layer Code Box" 中。该C代码会创建一个socket连接到攻击者指定的IP地址和端口，然后将标准输入、输出和错误重定向到该socket，最后执行 `/bin/bash`，从而建立一个反向shell。
3.  **上传Payload：**  脚本将构造的包含恶意代码的请求发送到 `/hardware` 页面。
4.  **触发编译：**  脚本访问 `/compile-program?file=blank_program.st` 页面，触发 OpenPLC 编译包含恶意代码的“硬件层”。
5.  **建立反向Shell：**  一旦代码被编译和执行，目标系统会连接到攻击者的监听端口，从而允许攻击者执行任意命令。

**有效性：** 根据搜索结果和PoC代码，该漏洞的利用是有效的，可以实现远程代码执行。

**投毒风险：**
查看了README，发现sealldev修改了Hunt3r0x提交的代码，移除了政治信息并且修复了拼写错误。main.py中，baseURL 被硬编码为 "http://wifinetictwo.htb:8080"，这表明此PoC是为HackTheBox的 "WifineticTwo" 靶机设计的，存在诱导使用者在相同IP环境下执行恶意代码风险。同时，PoC中的代码本身包含一个反向shell，这在某些情况下可能被认为是具有攻击性的。但此反向shell是漏洞利用的一部分，不能简单地归类为投毒。
综上，代码的投毒风险较低，大约为 10%。这个百分比主要考虑到脚本的针对性和潜在的非预期使用情况。

**项目地址:** [sealldeveloper/CVE-2021-31630-PoC](https://github.com/sealldeveloper/CVE-2021-31630-PoC)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #10

**来源**: [CVE-2021-31630-thewhiteh4t_cve-2021-31630.md](../2021/CVE-2021-31630-thewhiteh4t_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver v3

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要身份验证和网络访问/hardware页面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，攻击者可以通过“Hardware Layer Code Box”组件注入恶意命令。漏洞利用方式如下：

1.  **漏洞描述：** CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞，允许经过身份验证的远程攻击者通过 `/hardware` 页面的 "Hardware Layer Code Box" 组件执行任意代码。
2.  **搜索引擎结果：** 多个搜索结果表明该漏洞的描述，影响版本和利用方法。其中github链接指向了可利用的poc代码
3.  **漏洞利用代码分析：**
    *   POC 代码是一个 Python 脚本，用于利用 OpenPLC Webserver v3 中的命令注入漏洞。
    *   脚本首先登录到 OpenPLC Webserver v3，默认用户名和密码为 openplc/openplc。
    *   然后，脚本将默认程序还原，接着上传一个包含反向 shell 的特制 C 代码到`/hardware` 页面的 "Hardware Layer Code Box"。
    *   上传的C代码会被编译和执行，从而在目标系统上建立一个反向 shell 连接到攻击者的机器，IP地址和端口由脚本参数`-lh` 和 `-lp`指定。
    *   最后，脚本停止并清理PLC服务。
4.  **有效性评估：** 提供的 POC 代码有效，能够实现远程代码执行。
5.  **投毒风险评估：**
    *   该仓库的主要功能是提供漏洞利用代码，帮助研究人员验证和理解漏洞，但并不能完全排除投毒风险。
    *   `cve_2021_31630.py` 主要功能是利用漏洞，其本身没有明显的恶意代码，但使用者有可能会修改此脚本植入恶意代码
    *   `README.md`文件描述了漏洞利用过程和代码功能。
    *   综合来看，投毒风险较低，但是由于代码可能被篡改，仍存在一定的潜在风险。投毒风险估算为5%。
6. **漏洞利用方式：**
  1. 登录到OpenPLC Webserver v3。
  2. 停止当前PLC服务，清理环境。
  3. 上传包含恶意命令的C代码（通过`custom_layer_code`参数）到 `/hardware` 页面的 "Hardware Layer Code Box" 组件。
  4. 触发编译过程 (`/compile-program?file=blank_program.st`)，使恶意代码得到执行。
  5. 启动PLC服务，执行恶意代码（反向shell）
  6. 清理PLC服务。


**项目地址:** [thewhiteh4t/cve-2021-31630](https://github.com/thewhiteh4t/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

## POC #11

**来源**: [CVE-2021-31630-ttps-byte_cve-2021-31630.md](../2021/CVE-2021-31630-ttps-byte_cve-2021-31630.md)

## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** v3

**利用条件:** 需要网络访问和有效的OpenPLC Webserver v3实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 存在于 OpenPLC Webserver v3 中，允许远程攻击者通过 "Hardware Layer Code Box" 组件在 "/hardware" 页面上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（breakerplc.py），此漏洞的POC代码是有效的。该代码利用命令注入漏洞，通过修改 "Hardware Layer Code Box" 中的代码来执行恶意命令，从而获得服务器的shell访问权限。

**投毒风险：**
通过分析 `breakerplc.py` 脚本，存在一定的投毒风险。具体分析如下：
*   **优点：**
    *   代码结构清晰，功能模块化，易于理解。
    *   脚本使用 `argparse` 模块处理命令行参数，方便用户自定义目标URL、用户名、密码、LHOST、LPORT等信息。
    *   脚本包含完整的漏洞利用流程，包括登录、上传payload、编译程序、触发漏洞等步骤。
*   **缺点和潜在投毒点：**
    *   脚本的安全性取决于用户的输入，如果用户输入不安全的参数（例如恶意的LHOST或LPORT），可能导致反弹shell到错误的地址或端口。
    *   脚本中使用了 `subprocess.Popen` 函数来启动 nc 监听，这部分代码可能存在安全风险，例如命令注入等。
    *  虽然脚本本身目的是利用命令注入，但仓库创建者可能通过其它方式植入后门代码，考虑到github仓库的普遍性及POC仓库的安全性，故风险较低。
*   **投毒风险评估：**
    代码主要功能是利用命令注入，虽然有潜在风险，但是并未发现明显的恶意代码或后门。因此，评估投毒风险为 **10%**。

**利用方式：**
利用此漏洞的步骤如下：
1.  使用提供的 `breakerplc.py` 脚本，并提供目标 OpenPLC Webserver v3 的 URL。
2.  提供有效的用户名和密码进行身份验证（默认是 openplc/openplc）。
3.  指定攻击者的监听 IP 地址 (LHOST) 和端口 (LPORT)，用于接收反弹 shell。
4.  脚本将构造包含反向 shell 命令的恶意代码，并通过 "Hardware Layer Code Box" 上传到目标服务器。
5.  脚本触发编译，由于存在命令注入漏洞，恶意代码将被执行，从而在攻击者机器上建立反向 shell 连接。
6.  连接后，可能需要输入命令(如whoami或者ls)来打破代码行，获取返回shell。

**项目地址:** [ttps-byte/cve-2021-31630](https://github.com/ttps-byte/cve-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)

---

