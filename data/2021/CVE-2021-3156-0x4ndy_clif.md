## CVE-2021-3156 - Sudo 本地提权 (LPE) / 堆缓冲区溢出

**漏洞编号:** CVE-2021-3156

**漏洞类型:** 本地提权 (LPE) / 堆缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo 1.8.2 到 1.8.31p2; Sudo 1.9.0 到 1.9.5p1

**利用条件:** 攻击者必须拥有本地受限用户账户访问权限，能够执行带有特定参数的sudo命令。

**POC 可用性:** 7/10

**POC 类型:** 工具类概念验证

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

POC有效性分析：提供的代码并非CVE-2021-3156（Baron Samedit）的直接Exp代码，而是一个名为'clif'的自动化命令行模糊测试（Fuzzer）工具，旨在重现和发现类似该CVE的漏洞。工具使用Rust语言编写，依赖clap、crossterm和shellwords库。其逻辑是通过-a参数注入FUZZ占位符，利用-w（字典）、-n（数字范围）或-s（特定长度字符串）对目标可执行文件进行参数爆破。该工具能有效发现命令行程序中的溢出崩溃点，如示例中bof.c所示。虽然它不是针对CVE-2021-3156的‘一键提权’脚本，但作为漏洞研究和验证工具，其功能完整且具备实战参考价值，能辅助研究员确定sudo等CLI程序的崩溃偏移量。利用步骤：1. 编译Rust项目（cargo build）；2. 使用-e指定受影响的sudo或测试程序；3. 通过-s或-w参数设置过长的溢出字符串，结合-a 'sudoedit -s \ FUZZ' 模拟CVE-2021-3156的触发条件；4. 观察程序是否产生段错误（Segmentation fault）从而验证溢出点。投毒风险分析：该项目投毒风险极低。首先，源代码完全透明且使用Rust语言编写，不涉及二进制黑盒组件。Cargo.toml中引用的依赖库均为社区广泛使用的成熟库，无恶意供应链风险。分析README和源码，其行为仅限于本地进程启动、标准输出交互和参数构造，不包含任何网络回连、敏感文件读取或隐蔽执行指令。代码库中包含的figlet艺术字和示例C程序属于典型的教学资源。作者信息明确（Andy <andy@andy.codes>），项目结构符合合法的开源安全研究工具特征。在防御性研究中使用此工具是安全的，只需注意在隔离环境中运行测试目标程序，以防止模糊测试过程对系统稳定性造成影响。

**项目地址:** [https://github.com/0x4ndy](https://github.com/0x4ndy)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2021-3156](https://nvd.nist.gov/vuln/detail/CVE-2021-3156)
