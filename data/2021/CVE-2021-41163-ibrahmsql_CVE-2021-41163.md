# CVE-2021-41163

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41163-ibrahmsql_CVE-2021-41163.md](../2021/CVE-2021-41163-ibrahmsql_CVE-2021-41163.md)

# CVE-2021-41163

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41163-ibrahmsql_CVE-2021-41163.md](../2021/CVE-2021-41163-ibrahmsql_CVE-2021-41163.md)

# CVE-2021-41163

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41163-ibrahmsql_CVE-2021-41163.md](../2021/CVE-2021-41163-ibrahmsql_CVE-2021-41163.md)

# CVE-2021-41163

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41163-ibrahmsql_CVE-2021-41163.md](../2021/CVE-2021-41163-ibrahmsql_CVE-2021-41163.md)

# CVE-2021-41163

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41163-ibrahmsql_CVE-2021-41163.md](../2021/CVE-2021-41163-ibrahmsql_CVE-2021-41163.md)

## CVE-2021-41163-Discourse-RCE

**漏洞编号:** CVE-2021-41163

**漏洞类型:** 远程代码执行

**影响应用:** Discourse

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 2.7.9 (stable), < 2.8.0.beta7 (beta and tests-passed)

**利用条件:** 需要用户具有导入主题的权限（通常是管理员权限，但可能存在权限配置不当的情况）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41163 存在于 Discourse 的主题导入功能中。攻击者可以创建一个包含恶意 JavaScript 和 CSS 代码的主题 ZIP 文件，通过导入该主题，利用 Discourse 对主题文件验证不足的缺陷，实现远程代码执行。该漏洞的利用方式主要包括以下步骤：

1.  **获取 CSRF Token：** 通过访问 Discourse 网站，提取 CSRF Token，用于后续的认证请求。
2.  **创建恶意主题：** 创建包含恶意 JavaScript (evil.js) 和 CSS (evil.css) 代码的主题 ZIP 文件。evil.js 中的 payload 尝试利用 Node.js 的 `child_process` 模块执行系统命令（如 `id`），读取敏感文件（如 `/etc/passwd`），获取环境变量，并将结果发送到攻击者的服务器。同时，窃取管理员 Cookie 和 CSRF Token。evil.css 尝试使用 `javascript:` URL 进行 XSS 攻击。
3.  **上传恶意主题：** 利用 Discourse 的主题导入功能，将恶意主题 ZIP 文件上传到服务器。
4.  **触发漏洞：** 上传成功后，Discourse 会解析并应用该主题，恶意 JavaScript 和 CSS 代码会被执行，从而实现远程代码执行。

**有效性：** 根据漏洞信息和漏洞利用代码来看，该POC代码是有效的。漏洞库信息表明该漏洞是由于对 `subscribe_url` 值的验证不足造成的，而POC代码利用了主题导入功能，通过上传包含恶意代码的主题来实现RCE，这与漏洞描述相符。搜索引擎结果中也提到了该漏洞的严重性和修复紧急性，进一步验证了该漏洞的有效性。

**投毒风险：** 该POC代码存在一定的投毒风险。虽然主要功能是利用 CVE-2021-41163 漏洞，但 `evil.js` 中的 payload 包含以下可能被滥用的代码：

*   尝试将执行结果（如 `id` 命令的输出、`/etc/passwd` 文件内容）发送到 `evil.com`。这可能被用于窃取敏感信息。
*   尝试窃取 Cookie 和 CSRF Token 并发送到 `evil.com`。这可能被用于冒充管理员执行操作。

虽然这些功能是为了验证漏洞，但恶意攻击者可能会修改 `evil.com` 为自己的服务器，从而利用此 POC 代码进行实际攻击。因此，存在一定程度的投毒风险，大约为 10%。（这个比例表示代码本身有作为后门使用的可能性，但主要目的还是漏洞验证。）

**利用方式总结：**

1.  攻击者首先需要获得一个有效的Discourse账号,并拥有导入主题的权限(通常为管理员)。
2.  使用POC脚本生成包含恶意代码的主题文件。
3.  利用Discourse后台主题上传功能上传恶意主题文件。
4.  成功上传后,恶意代码被执行,攻击者可以远程执行任意命令，读取服务器敏感数据，控制服务器。
5.  `evil.com` 可以被替换为攻击者自己的服务器，以便收集被攻击系统的敏感信息。


**项目地址:** [ibrahmsql/CVE-2021-41163](https://github.com/ibrahmsql/CVE-2021-41163)

**漏洞详情:** [CVE-2021-41163](https://nvd.nist.gov/vuln/detail/CVE-2021-41163)

---

## POC #2

**来源**: [CVE-2021-41163-ibrahmsql_discourse-CVE-2021-41163.md](../2021/CVE-2021-41163-ibrahmsql_discourse-CVE-2021-41163.md)

## CVE-2021-41163-Discourse-RCE

**漏洞编号:** CVE-2021-41163

**漏洞类型:** 远程代码执行

**影响应用:** Discourse

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 2.7.9 (stable), < 2.8.0.beta7 (beta/tests-passed)

**利用条件:** 需要目标Discourse实例存在漏洞，且攻击者能够发送恶意请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41163 漏洞是 Discourse 平台中的一个远程代码执行漏洞，源于对 `subscribe_url` 值的验证不足。攻击者可以通过构造恶意的 SNS 订阅请求，利用主题导入功能执行任意代码。

**漏洞利用方式：**

1.  **获取CSRF令牌：**  首先，攻击者需要从 Discourse 网站获取 CSRF 令牌，用于后续的请求。
2.  **检查管理员权限：** 检查是否可以直接访问/admin页面，如果不能直接访问，尝试使用常见的权限绕过技术。
3.  **主题上传 RCE：** 上传包含恶意代码的主题 ZIP 文件。POC 代码中包含了 JavaScript RCE、CSS with JavaScript injection、Handlebars template injection、Theme settings with RCE 等多种攻击方式。
4. **Git 仓库导入 RCE：** POC代码中提及但是不完整. 通过导入包含恶意代码的 Git 仓库来触发 RCE。
5.  **主题组件 RCE：** POC代码中提及但是不完整, 利用主题组件执行 RCE。

**有效性：**

根据漏洞库信息、搜索引擎结果（如 CISA 敦促管理员修补此漏洞）以及提供的 POC 代码，该漏洞的利用是有效的。POC 代码针对多种 RCE 场景都提供了利用方式。

**投毒风险：**

该 POC 代码主要展示了如何利用漏洞进行攻击，未发现明显的恶意或隐藏功能。`Date: 2025` 有待验证，可能存在潜在风险。总体投毒风险较低，大约为 1%。该POC的主要目的是演示和验证漏洞，而不是部署后门。但是不排除作者隐藏极小的后门的可能性。

**项目地址:** [ibrahmsql/discourse-CVE-2021-41163](https://github.com/ibrahmsql/discourse-CVE-2021-41163)

**漏洞详情:** [CVE-2021-41163](https://nvd.nist.gov/vuln/detail/CVE-2021-41163)

---



---

## POC #2

**来源**: [CVE-2021-41163-ibrahmsql_discourse-CVE-2021-41163.md](../2021/CVE-2021-41163-ibrahmsql_discourse-CVE-2021-41163.md)

## CVE-2021-41163-Discourse-RCE

**漏洞编号:** CVE-2021-41163

**漏洞类型:** 远程代码执行

**影响应用:** Discourse

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 2.7.9 (stable), < 2.8.0.beta7 (beta/tests-passed)

**利用条件:** 需要目标Discourse实例存在漏洞，且攻击者能够发送恶意请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41163 漏洞是 Discourse 平台中的一个远程代码执行漏洞，源于对 `subscribe_url` 值的验证不足。攻击者可以通过构造恶意的 SNS 订阅请求，利用主题导入功能执行任意代码。

**漏洞利用方式：**

1.  **获取CSRF令牌：**  首先，攻击者需要从 Discourse 网站获取 CSRF 令牌，用于后续的请求。
2.  **检查管理员权限：** 检查是否可以直接访问/admin页面，如果不能直接访问，尝试使用常见的权限绕过技术。
3.  **主题上传 RCE：** 上传包含恶意代码的主题 ZIP 文件。POC 代码中包含了 JavaScript RCE、CSS with JavaScript injection、Handlebars template injection、Theme settings with RCE 等多种攻击方式。
4. **Git 仓库导入 RCE：** POC代码中提及但是不完整. 通过导入包含恶意代码的 Git 仓库来触发 RCE。
5.  **主题组件 RCE：** POC代码中提及但是不完整, 利用主题组件执行 RCE。

**有效性：**

根据漏洞库信息、搜索引擎结果（如 CISA 敦促管理员修补此漏洞）以及提供的 POC 代码，该漏洞的利用是有效的。POC 代码针对多种 RCE 场景都提供了利用方式。

**投毒风险：**

该 POC 代码主要展示了如何利用漏洞进行攻击，未发现明显的恶意或隐藏功能。`Date: 2025` 有待验证，可能存在潜在风险。总体投毒风险较低，大约为 1%。该POC的主要目的是演示和验证漏洞，而不是部署后门。但是不排除作者隐藏极小的后门的可能性。

**项目地址:** [ibrahmsql/discourse-CVE-2021-41163](https://github.com/ibrahmsql/discourse-CVE-2021-41163)

**漏洞详情:** [CVE-2021-41163](https://nvd.nist.gov/vuln/detail/CVE-2021-41163)

---



---

## POC #2

**来源**: [CVE-2021-41163-ibrahmsql_discourse-CVE-2021-41163.md](../2021/CVE-2021-41163-ibrahmsql_discourse-CVE-2021-41163.md)

## CVE-2021-41163-Discourse-RCE

**漏洞编号:** CVE-2021-41163

**漏洞类型:** 远程代码执行

**影响应用:** Discourse

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 2.7.9 (stable), < 2.8.0.beta7 (beta/tests-passed)

**利用条件:** 需要目标Discourse实例存在漏洞，且攻击者能够发送恶意请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41163 漏洞是 Discourse 平台中的一个远程代码执行漏洞，源于对 `subscribe_url` 值的验证不足。攻击者可以通过构造恶意的 SNS 订阅请求，利用主题导入功能执行任意代码。

**漏洞利用方式：**

1.  **获取CSRF令牌：**  首先，攻击者需要从 Discourse 网站获取 CSRF 令牌，用于后续的请求。
2.  **检查管理员权限：** 检查是否可以直接访问/admin页面，如果不能直接访问，尝试使用常见的权限绕过技术。
3.  **主题上传 RCE：** 上传包含恶意代码的主题 ZIP 文件。POC 代码中包含了 JavaScript RCE、CSS with JavaScript injection、Handlebars template injection、Theme settings with RCE 等多种攻击方式。
4. **Git 仓库导入 RCE：** POC代码中提及但是不完整. 通过导入包含恶意代码的 Git 仓库来触发 RCE。
5.  **主题组件 RCE：** POC代码中提及但是不完整, 利用主题组件执行 RCE。

**有效性：**

根据漏洞库信息、搜索引擎结果（如 CISA 敦促管理员修补此漏洞）以及提供的 POC 代码，该漏洞的利用是有效的。POC 代码针对多种 RCE 场景都提供了利用方式。

**投毒风险：**

该 POC 代码主要展示了如何利用漏洞进行攻击，未发现明显的恶意或隐藏功能。`Date: 2025` 有待验证，可能存在潜在风险。总体投毒风险较低，大约为 1%。该POC的主要目的是演示和验证漏洞，而不是部署后门。但是不排除作者隐藏极小的后门的可能性。

**项目地址:** [ibrahmsql/discourse-CVE-2021-41163](https://github.com/ibrahmsql/discourse-CVE-2021-41163)

**漏洞详情:** [CVE-2021-41163](https://nvd.nist.gov/vuln/detail/CVE-2021-41163)

---



---

## POC #2

**来源**: [CVE-2021-41163-ibrahmsql_discourse-CVE-2021-41163.md](../2021/CVE-2021-41163-ibrahmsql_discourse-CVE-2021-41163.md)

## CVE-2021-41163-Discourse-RCE

**漏洞编号:** CVE-2021-41163

**漏洞类型:** 远程代码执行

**影响应用:** Discourse

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 2.7.9 (stable), < 2.8.0.beta7 (beta/tests-passed)

**利用条件:** 需要目标Discourse实例存在漏洞，且攻击者能够发送恶意请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41163 漏洞是 Discourse 平台中的一个远程代码执行漏洞，源于对 `subscribe_url` 值的验证不足。攻击者可以通过构造恶意的 SNS 订阅请求，利用主题导入功能执行任意代码。

**漏洞利用方式：**

1.  **获取CSRF令牌：**  首先，攻击者需要从 Discourse 网站获取 CSRF 令牌，用于后续的请求。
2.  **检查管理员权限：** 检查是否可以直接访问/admin页面，如果不能直接访问，尝试使用常见的权限绕过技术。
3.  **主题上传 RCE：** 上传包含恶意代码的主题 ZIP 文件。POC 代码中包含了 JavaScript RCE、CSS with JavaScript injection、Handlebars template injection、Theme settings with RCE 等多种攻击方式。
4. **Git 仓库导入 RCE：** POC代码中提及但是不完整. 通过导入包含恶意代码的 Git 仓库来触发 RCE。
5.  **主题组件 RCE：** POC代码中提及但是不完整, 利用主题组件执行 RCE。

**有效性：**

根据漏洞库信息、搜索引擎结果（如 CISA 敦促管理员修补此漏洞）以及提供的 POC 代码，该漏洞的利用是有效的。POC 代码针对多种 RCE 场景都提供了利用方式。

**投毒风险：**

该 POC 代码主要展示了如何利用漏洞进行攻击，未发现明显的恶意或隐藏功能。`Date: 2025` 有待验证，可能存在潜在风险。总体投毒风险较低，大约为 1%。该POC的主要目的是演示和验证漏洞，而不是部署后门。但是不排除作者隐藏极小的后门的可能性。

**项目地址:** [ibrahmsql/discourse-CVE-2021-41163](https://github.com/ibrahmsql/discourse-CVE-2021-41163)

**漏洞详情:** [CVE-2021-41163](https://nvd.nist.gov/vuln/detail/CVE-2021-41163)

---



---

## POC #2

**来源**: [CVE-2021-41163-ibrahmsql_discourse-CVE-2021-41163.md](../2021/CVE-2021-41163-ibrahmsql_discourse-CVE-2021-41163.md)

## CVE-2021-41163-Discourse-RCE

**漏洞编号:** CVE-2021-41163

**漏洞类型:** 远程代码执行

**影响应用:** Discourse

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 2.7.9 (stable), < 2.8.0.beta7 (beta/tests-passed)

**利用条件:** 需要目标Discourse实例存在漏洞，且攻击者能够发送恶意请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41163 漏洞是 Discourse 平台中的一个远程代码执行漏洞，源于对 `subscribe_url` 值的验证不足。攻击者可以通过构造恶意的 SNS 订阅请求，利用主题导入功能执行任意代码。

**漏洞利用方式：**

1.  **获取CSRF令牌：**  首先，攻击者需要从 Discourse 网站获取 CSRF 令牌，用于后续的请求。
2.  **检查管理员权限：** 检查是否可以直接访问/admin页面，如果不能直接访问，尝试使用常见的权限绕过技术。
3.  **主题上传 RCE：** 上传包含恶意代码的主题 ZIP 文件。POC 代码中包含了 JavaScript RCE、CSS with JavaScript injection、Handlebars template injection、Theme settings with RCE 等多种攻击方式。
4. **Git 仓库导入 RCE：** POC代码中提及但是不完整. 通过导入包含恶意代码的 Git 仓库来触发 RCE。
5.  **主题组件 RCE：** POC代码中提及但是不完整, 利用主题组件执行 RCE。

**有效性：**

根据漏洞库信息、搜索引擎结果（如 CISA 敦促管理员修补此漏洞）以及提供的 POC 代码，该漏洞的利用是有效的。POC 代码针对多种 RCE 场景都提供了利用方式。

**投毒风险：**

该 POC 代码主要展示了如何利用漏洞进行攻击，未发现明显的恶意或隐藏功能。`Date: 2025` 有待验证，可能存在潜在风险。总体投毒风险较低，大约为 1%。该POC的主要目的是演示和验证漏洞，而不是部署后门。但是不排除作者隐藏极小的后门的可能性。

**项目地址:** [ibrahmsql/discourse-CVE-2021-41163](https://github.com/ibrahmsql/discourse-CVE-2021-41163)

**漏洞详情:** [CVE-2021-41163](https://nvd.nist.gov/vuln/detail/CVE-2021-41163)

---

