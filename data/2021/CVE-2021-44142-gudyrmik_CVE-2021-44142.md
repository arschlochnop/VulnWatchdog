# CVE-2021-44142

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md](../2021/CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md)

## CVE-2021-44142-Samba vfs_fruit 模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出（Out-of-bounds Read/Write）

**影响应用:** Samba

**危害等级:** 高危，远程攻击者可能以 smbd 进程（通常为 root 权限）执行任意代码

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要 Samba 服务器配置了 vfs_fruit 模块，并且攻击者具有对扩展文件属性（EA, xattr）的写入权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142 漏洞存在于 Samba 的 vfs_fruit 模块中。该模块旨在提供与 Apple SMB 客户端的兼容性以及与 Netatalk 3 AFP 文件服务器的互操作性。

**漏洞利用方式：**
攻击者通过精心构造的扩展文件属性（EA, xattr）触发漏洞。具体来说，当 `vfs_fruit` 模块处理这些特制属性时，会导致越界堆读取和写入操作。由于攻击者拥有扩展属性的写入权限，他们可以控制写入的内容，从而可能覆盖内存中的关键数据结构，最终导致远程代码执行，权限提升至 `smbd` 进程的权限，通常是 root。

**POC 代码分析：**
提供的 Dockerfile 构建了一个易受攻击的 Samba 环境，并包含对 `source3/modules/vfs_fruit.c` 文件的修改，通过修改后的代码，尝试进行内存地址泄露。具体而言，它修改了 `fruit_pread_meta_stream` 和 `fruit_pread_meta_adouble` 函数，在特定条件下将伪造的 cookie 和指针复制到数据缓冲区中。此修改的目的是允许进一步利用该漏洞，从而进行代码执行。

**投毒风险分析：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大约为10%。

主要原因:
*   **代码修改目的：** Dockerfile 对 `vfs_fruit.c` 的修改主要集中于添加内存泄露的逻辑，而不是直接执行恶意代码。这些修改旨在为进一步的漏洞利用奠定基础。
*   **公开的漏洞信息：**  CVE-2021-44142 是一个公开披露的漏洞，包含博客文章，该漏洞可实现远程代码执行。
*   **Docker环境：** 该docker环境主要是为了模拟漏洞环境提供方便，降低利用难度。

然而，仍然存在一定的投毒风险，因为攻击者可能:

*   **构建依赖：** 构建过程中，可能依赖不安全的构建源，例如被篡改的第三方lib，导致最终构建的镜像中存在后门。
*   **其他配置缺陷：** Dockerfile和相关配置文件可能存在其他安全缺陷，例如不安全的默认配置、弱密码等，可被用于进一步的攻击。

**项目地址:** [WinDyAlphA/CVE-2021-44142-vulnerable-lab](https://github.com/WinDyAlphA/CVE-2021-44142-vulnerable-lab)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #2

**来源**: [CVE-2021-44142-gudyrmik_CVE-2021-44142.md](../2021/CVE-2021-44142-gudyrmik_CVE-2021-44142.md)

# CVE-2021-44142

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md](../2021/CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md)

## CVE-2021-44142-Samba vfs_fruit 模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出（Out-of-bounds Read/Write）

**影响应用:** Samba

**危害等级:** 高危，远程攻击者可能以 smbd 进程（通常为 root 权限）执行任意代码

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要 Samba 服务器配置了 vfs_fruit 模块，并且攻击者具有对扩展文件属性（EA, xattr）的写入权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142 漏洞存在于 Samba 的 vfs_fruit 模块中。该模块旨在提供与 Apple SMB 客户端的兼容性以及与 Netatalk 3 AFP 文件服务器的互操作性。

**漏洞利用方式：**
攻击者通过精心构造的扩展文件属性（EA, xattr）触发漏洞。具体来说，当 `vfs_fruit` 模块处理这些特制属性时，会导致越界堆读取和写入操作。由于攻击者拥有扩展属性的写入权限，他们可以控制写入的内容，从而可能覆盖内存中的关键数据结构，最终导致远程代码执行，权限提升至 `smbd` 进程的权限，通常是 root。

**POC 代码分析：**
提供的 Dockerfile 构建了一个易受攻击的 Samba 环境，并包含对 `source3/modules/vfs_fruit.c` 文件的修改，通过修改后的代码，尝试进行内存地址泄露。具体而言，它修改了 `fruit_pread_meta_stream` 和 `fruit_pread_meta_adouble` 函数，在特定条件下将伪造的 cookie 和指针复制到数据缓冲区中。此修改的目的是允许进一步利用该漏洞，从而进行代码执行。

**投毒风险分析：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大约为10%。

主要原因:
*   **代码修改目的：** Dockerfile 对 `vfs_fruit.c` 的修改主要集中于添加内存泄露的逻辑，而不是直接执行恶意代码。这些修改旨在为进一步的漏洞利用奠定基础。
*   **公开的漏洞信息：**  CVE-2021-44142 是一个公开披露的漏洞，包含博客文章，该漏洞可实现远程代码执行。
*   **Docker环境：** 该docker环境主要是为了模拟漏洞环境提供方便，降低利用难度。

然而，仍然存在一定的投毒风险，因为攻击者可能:

*   **构建依赖：** 构建过程中，可能依赖不安全的构建源，例如被篡改的第三方lib，导致最终构建的镜像中存在后门。
*   **其他配置缺陷：** Dockerfile和相关配置文件可能存在其他安全缺陷，例如不安全的默认配置、弱密码等，可被用于进一步的攻击。

**项目地址:** [WinDyAlphA/CVE-2021-44142-vulnerable-lab](https://github.com/WinDyAlphA/CVE-2021-44142-vulnerable-lab)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #2

**来源**: [CVE-2021-44142-gudyrmik_CVE-2021-44142.md](../2021/CVE-2021-44142-gudyrmik_CVE-2021-44142.md)

# CVE-2021-44142

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md](../2021/CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md)

## CVE-2021-44142-Samba vfs_fruit 模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出（Out-of-bounds Read/Write）

**影响应用:** Samba

**危害等级:** 高危，远程攻击者可能以 smbd 进程（通常为 root 权限）执行任意代码

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要 Samba 服务器配置了 vfs_fruit 模块，并且攻击者具有对扩展文件属性（EA, xattr）的写入权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142 漏洞存在于 Samba 的 vfs_fruit 模块中。该模块旨在提供与 Apple SMB 客户端的兼容性以及与 Netatalk 3 AFP 文件服务器的互操作性。

**漏洞利用方式：**
攻击者通过精心构造的扩展文件属性（EA, xattr）触发漏洞。具体来说，当 `vfs_fruit` 模块处理这些特制属性时，会导致越界堆读取和写入操作。由于攻击者拥有扩展属性的写入权限，他们可以控制写入的内容，从而可能覆盖内存中的关键数据结构，最终导致远程代码执行，权限提升至 `smbd` 进程的权限，通常是 root。

**POC 代码分析：**
提供的 Dockerfile 构建了一个易受攻击的 Samba 环境，并包含对 `source3/modules/vfs_fruit.c` 文件的修改，通过修改后的代码，尝试进行内存地址泄露。具体而言，它修改了 `fruit_pread_meta_stream` 和 `fruit_pread_meta_adouble` 函数，在特定条件下将伪造的 cookie 和指针复制到数据缓冲区中。此修改的目的是允许进一步利用该漏洞，从而进行代码执行。

**投毒风险分析：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大约为10%。

主要原因:
*   **代码修改目的：** Dockerfile 对 `vfs_fruit.c` 的修改主要集中于添加内存泄露的逻辑，而不是直接执行恶意代码。这些修改旨在为进一步的漏洞利用奠定基础。
*   **公开的漏洞信息：**  CVE-2021-44142 是一个公开披露的漏洞，包含博客文章，该漏洞可实现远程代码执行。
*   **Docker环境：** 该docker环境主要是为了模拟漏洞环境提供方便，降低利用难度。

然而，仍然存在一定的投毒风险，因为攻击者可能:

*   **构建依赖：** 构建过程中，可能依赖不安全的构建源，例如被篡改的第三方lib，导致最终构建的镜像中存在后门。
*   **其他配置缺陷：** Dockerfile和相关配置文件可能存在其他安全缺陷，例如不安全的默认配置、弱密码等，可被用于进一步的攻击。

**项目地址:** [WinDyAlphA/CVE-2021-44142-vulnerable-lab](https://github.com/WinDyAlphA/CVE-2021-44142-vulnerable-lab)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #2

**来源**: [CVE-2021-44142-gudyrmik_CVE-2021-44142.md](../2021/CVE-2021-44142-gudyrmik_CVE-2021-44142.md)

# CVE-2021-44142

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md](../2021/CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md)

## CVE-2021-44142-Samba vfs_fruit 模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出（Out-of-bounds Read/Write）

**影响应用:** Samba

**危害等级:** 高危，远程攻击者可能以 smbd 进程（通常为 root 权限）执行任意代码

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要 Samba 服务器配置了 vfs_fruit 模块，并且攻击者具有对扩展文件属性（EA, xattr）的写入权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142 漏洞存在于 Samba 的 vfs_fruit 模块中。该模块旨在提供与 Apple SMB 客户端的兼容性以及与 Netatalk 3 AFP 文件服务器的互操作性。

**漏洞利用方式：**
攻击者通过精心构造的扩展文件属性（EA, xattr）触发漏洞。具体来说，当 `vfs_fruit` 模块处理这些特制属性时，会导致越界堆读取和写入操作。由于攻击者拥有扩展属性的写入权限，他们可以控制写入的内容，从而可能覆盖内存中的关键数据结构，最终导致远程代码执行，权限提升至 `smbd` 进程的权限，通常是 root。

**POC 代码分析：**
提供的 Dockerfile 构建了一个易受攻击的 Samba 环境，并包含对 `source3/modules/vfs_fruit.c` 文件的修改，通过修改后的代码，尝试进行内存地址泄露。具体而言，它修改了 `fruit_pread_meta_stream` 和 `fruit_pread_meta_adouble` 函数，在特定条件下将伪造的 cookie 和指针复制到数据缓冲区中。此修改的目的是允许进一步利用该漏洞，从而进行代码执行。

**投毒风险分析：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大约为10%。

主要原因:
*   **代码修改目的：** Dockerfile 对 `vfs_fruit.c` 的修改主要集中于添加内存泄露的逻辑，而不是直接执行恶意代码。这些修改旨在为进一步的漏洞利用奠定基础。
*   **公开的漏洞信息：**  CVE-2021-44142 是一个公开披露的漏洞，包含博客文章，该漏洞可实现远程代码执行。
*   **Docker环境：** 该docker环境主要是为了模拟漏洞环境提供方便，降低利用难度。

然而，仍然存在一定的投毒风险，因为攻击者可能:

*   **构建依赖：** 构建过程中，可能依赖不安全的构建源，例如被篡改的第三方lib，导致最终构建的镜像中存在后门。
*   **其他配置缺陷：** Dockerfile和相关配置文件可能存在其他安全缺陷，例如不安全的默认配置、弱密码等，可被用于进一步的攻击。

**项目地址:** [WinDyAlphA/CVE-2021-44142-vulnerable-lab](https://github.com/WinDyAlphA/CVE-2021-44142-vulnerable-lab)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #2

**来源**: [CVE-2021-44142-gudyrmik_CVE-2021-44142.md](../2021/CVE-2021-44142-gudyrmik_CVE-2021-44142.md)

# CVE-2021-44142

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md](../2021/CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md)

## CVE-2021-44142-Samba vfs_fruit 模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出（Out-of-bounds Read/Write）

**影响应用:** Samba

**危害等级:** 高危，远程攻击者可能以 smbd 进程（通常为 root 权限）执行任意代码

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要 Samba 服务器配置了 vfs_fruit 模块，并且攻击者具有对扩展文件属性（EA, xattr）的写入权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142 漏洞存在于 Samba 的 vfs_fruit 模块中。该模块旨在提供与 Apple SMB 客户端的兼容性以及与 Netatalk 3 AFP 文件服务器的互操作性。

**漏洞利用方式：**
攻击者通过精心构造的扩展文件属性（EA, xattr）触发漏洞。具体来说，当 `vfs_fruit` 模块处理这些特制属性时，会导致越界堆读取和写入操作。由于攻击者拥有扩展属性的写入权限，他们可以控制写入的内容，从而可能覆盖内存中的关键数据结构，最终导致远程代码执行，权限提升至 `smbd` 进程的权限，通常是 root。

**POC 代码分析：**
提供的 Dockerfile 构建了一个易受攻击的 Samba 环境，并包含对 `source3/modules/vfs_fruit.c` 文件的修改，通过修改后的代码，尝试进行内存地址泄露。具体而言，它修改了 `fruit_pread_meta_stream` 和 `fruit_pread_meta_adouble` 函数，在特定条件下将伪造的 cookie 和指针复制到数据缓冲区中。此修改的目的是允许进一步利用该漏洞，从而进行代码执行。

**投毒风险分析：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大约为10%。

主要原因:
*   **代码修改目的：** Dockerfile 对 `vfs_fruit.c` 的修改主要集中于添加内存泄露的逻辑，而不是直接执行恶意代码。这些修改旨在为进一步的漏洞利用奠定基础。
*   **公开的漏洞信息：**  CVE-2021-44142 是一个公开披露的漏洞，包含博客文章，该漏洞可实现远程代码执行。
*   **Docker环境：** 该docker环境主要是为了模拟漏洞环境提供方便，降低利用难度。

然而，仍然存在一定的投毒风险，因为攻击者可能:

*   **构建依赖：** 构建过程中，可能依赖不安全的构建源，例如被篡改的第三方lib，导致最终构建的镜像中存在后门。
*   **其他配置缺陷：** Dockerfile和相关配置文件可能存在其他安全缺陷，例如不安全的默认配置、弱密码等，可被用于进一步的攻击。

**项目地址:** [WinDyAlphA/CVE-2021-44142-vulnerable-lab](https://github.com/WinDyAlphA/CVE-2021-44142-vulnerable-lab)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #2

**来源**: [CVE-2021-44142-gudyrmik_CVE-2021-44142.md](../2021/CVE-2021-44142-gudyrmik_CVE-2021-44142.md)

# CVE-2021-44142

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md](../2021/CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md)

## CVE-2021-44142-Samba vfs_fruit 模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出（Out-of-bounds Read/Write）

**影响应用:** Samba

**危害等级:** 高危，远程攻击者可能以 smbd 进程（通常为 root 权限）执行任意代码

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要 Samba 服务器配置了 vfs_fruit 模块，并且攻击者具有对扩展文件属性（EA, xattr）的写入权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142 漏洞存在于 Samba 的 vfs_fruit 模块中。该模块旨在提供与 Apple SMB 客户端的兼容性以及与 Netatalk 3 AFP 文件服务器的互操作性。

**漏洞利用方式：**
攻击者通过精心构造的扩展文件属性（EA, xattr）触发漏洞。具体来说，当 `vfs_fruit` 模块处理这些特制属性时，会导致越界堆读取和写入操作。由于攻击者拥有扩展属性的写入权限，他们可以控制写入的内容，从而可能覆盖内存中的关键数据结构，最终导致远程代码执行，权限提升至 `smbd` 进程的权限，通常是 root。

**POC 代码分析：**
提供的 Dockerfile 构建了一个易受攻击的 Samba 环境，并包含对 `source3/modules/vfs_fruit.c` 文件的修改，通过修改后的代码，尝试进行内存地址泄露。具体而言，它修改了 `fruit_pread_meta_stream` 和 `fruit_pread_meta_adouble` 函数，在特定条件下将伪造的 cookie 和指针复制到数据缓冲区中。此修改的目的是允许进一步利用该漏洞，从而进行代码执行。

**投毒风险分析：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大约为10%。

主要原因:
*   **代码修改目的：** Dockerfile 对 `vfs_fruit.c` 的修改主要集中于添加内存泄露的逻辑，而不是直接执行恶意代码。这些修改旨在为进一步的漏洞利用奠定基础。
*   **公开的漏洞信息：**  CVE-2021-44142 是一个公开披露的漏洞，包含博客文章，该漏洞可实现远程代码执行。
*   **Docker环境：** 该docker环境主要是为了模拟漏洞环境提供方便，降低利用难度。

然而，仍然存在一定的投毒风险，因为攻击者可能:

*   **构建依赖：** 构建过程中，可能依赖不安全的构建源，例如被篡改的第三方lib，导致最终构建的镜像中存在后门。
*   **其他配置缺陷：** Dockerfile和相关配置文件可能存在其他安全缺陷，例如不安全的默认配置、弱密码等，可被用于进一步的攻击。

**项目地址:** [WinDyAlphA/CVE-2021-44142-vulnerable-lab](https://github.com/WinDyAlphA/CVE-2021-44142-vulnerable-lab)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #2

**来源**: [CVE-2021-44142-gudyrmik_CVE-2021-44142.md](../2021/CVE-2021-44142-gudyrmik_CVE-2021-44142.md)

# CVE-2021-44142

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md](../2021/CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md)

## CVE-2021-44142-Samba vfs_fruit 模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出（Out-of-bounds Read/Write）

**影响应用:** Samba

**危害等级:** 高危，远程攻击者可能以 smbd 进程（通常为 root 权限）执行任意代码

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要 Samba 服务器配置了 vfs_fruit 模块，并且攻击者具有对扩展文件属性（EA, xattr）的写入权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142 漏洞存在于 Samba 的 vfs_fruit 模块中。该模块旨在提供与 Apple SMB 客户端的兼容性以及与 Netatalk 3 AFP 文件服务器的互操作性。

**漏洞利用方式：**
攻击者通过精心构造的扩展文件属性（EA, xattr）触发漏洞。具体来说，当 `vfs_fruit` 模块处理这些特制属性时，会导致越界堆读取和写入操作。由于攻击者拥有扩展属性的写入权限，他们可以控制写入的内容，从而可能覆盖内存中的关键数据结构，最终导致远程代码执行，权限提升至 `smbd` 进程的权限，通常是 root。

**POC 代码分析：**
提供的 Dockerfile 构建了一个易受攻击的 Samba 环境，并包含对 `source3/modules/vfs_fruit.c` 文件的修改，通过修改后的代码，尝试进行内存地址泄露。具体而言，它修改了 `fruit_pread_meta_stream` 和 `fruit_pread_meta_adouble` 函数，在特定条件下将伪造的 cookie 和指针复制到数据缓冲区中。此修改的目的是允许进一步利用该漏洞，从而进行代码执行。

**投毒风险分析：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大约为10%。

主要原因:
*   **代码修改目的：** Dockerfile 对 `vfs_fruit.c` 的修改主要集中于添加内存泄露的逻辑，而不是直接执行恶意代码。这些修改旨在为进一步的漏洞利用奠定基础。
*   **公开的漏洞信息：**  CVE-2021-44142 是一个公开披露的漏洞，包含博客文章，该漏洞可实现远程代码执行。
*   **Docker环境：** 该docker环境主要是为了模拟漏洞环境提供方便，降低利用难度。

然而，仍然存在一定的投毒风险，因为攻击者可能:

*   **构建依赖：** 构建过程中，可能依赖不安全的构建源，例如被篡改的第三方lib，导致最终构建的镜像中存在后门。
*   **其他配置缺陷：** Dockerfile和相关配置文件可能存在其他安全缺陷，例如不安全的默认配置、弱密码等，可被用于进一步的攻击。

**项目地址:** [WinDyAlphA/CVE-2021-44142-vulnerable-lab](https://github.com/WinDyAlphA/CVE-2021-44142-vulnerable-lab)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #2

**来源**: [CVE-2021-44142-gudyrmik_CVE-2021-44142.md](../2021/CVE-2021-44142-gudyrmik_CVE-2021-44142.md)

# CVE-2021-44142

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md](../2021/CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md)

## CVE-2021-44142-Samba vfs_fruit 模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出（Out-of-bounds Read/Write）

**影响应用:** Samba

**危害等级:** 高危，远程攻击者可能以 smbd 进程（通常为 root 权限）执行任意代码

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要 Samba 服务器配置了 vfs_fruit 模块，并且攻击者具有对扩展文件属性（EA, xattr）的写入权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142 漏洞存在于 Samba 的 vfs_fruit 模块中。该模块旨在提供与 Apple SMB 客户端的兼容性以及与 Netatalk 3 AFP 文件服务器的互操作性。

**漏洞利用方式：**
攻击者通过精心构造的扩展文件属性（EA, xattr）触发漏洞。具体来说，当 `vfs_fruit` 模块处理这些特制属性时，会导致越界堆读取和写入操作。由于攻击者拥有扩展属性的写入权限，他们可以控制写入的内容，从而可能覆盖内存中的关键数据结构，最终导致远程代码执行，权限提升至 `smbd` 进程的权限，通常是 root。

**POC 代码分析：**
提供的 Dockerfile 构建了一个易受攻击的 Samba 环境，并包含对 `source3/modules/vfs_fruit.c` 文件的修改，通过修改后的代码，尝试进行内存地址泄露。具体而言，它修改了 `fruit_pread_meta_stream` 和 `fruit_pread_meta_adouble` 函数，在特定条件下将伪造的 cookie 和指针复制到数据缓冲区中。此修改的目的是允许进一步利用该漏洞，从而进行代码执行。

**投毒风险分析：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大约为10%。

主要原因:
*   **代码修改目的：** Dockerfile 对 `vfs_fruit.c` 的修改主要集中于添加内存泄露的逻辑，而不是直接执行恶意代码。这些修改旨在为进一步的漏洞利用奠定基础。
*   **公开的漏洞信息：**  CVE-2021-44142 是一个公开披露的漏洞，包含博客文章，该漏洞可实现远程代码执行。
*   **Docker环境：** 该docker环境主要是为了模拟漏洞环境提供方便，降低利用难度。

然而，仍然存在一定的投毒风险，因为攻击者可能:

*   **构建依赖：** 构建过程中，可能依赖不安全的构建源，例如被篡改的第三方lib，导致最终构建的镜像中存在后门。
*   **其他配置缺陷：** Dockerfile和相关配置文件可能存在其他安全缺陷，例如不安全的默认配置、弱密码等，可被用于进一步的攻击。

**项目地址:** [WinDyAlphA/CVE-2021-44142-vulnerable-lab](https://github.com/WinDyAlphA/CVE-2021-44142-vulnerable-lab)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #2

**来源**: [CVE-2021-44142-gudyrmik_CVE-2021-44142.md](../2021/CVE-2021-44142-gudyrmik_CVE-2021-44142.md)

# CVE-2021-44142

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md](../2021/CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md)

## CVE-2021-44142-Samba vfs_fruit 模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出（Out-of-bounds Read/Write）

**影响应用:** Samba

**危害等级:** 高危，远程攻击者可能以 smbd 进程（通常为 root 权限）执行任意代码

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要 Samba 服务器配置了 vfs_fruit 模块，并且攻击者具有对扩展文件属性（EA, xattr）的写入权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142 漏洞存在于 Samba 的 vfs_fruit 模块中。该模块旨在提供与 Apple SMB 客户端的兼容性以及与 Netatalk 3 AFP 文件服务器的互操作性。

**漏洞利用方式：**
攻击者通过精心构造的扩展文件属性（EA, xattr）触发漏洞。具体来说，当 `vfs_fruit` 模块处理这些特制属性时，会导致越界堆读取和写入操作。由于攻击者拥有扩展属性的写入权限，他们可以控制写入的内容，从而可能覆盖内存中的关键数据结构，最终导致远程代码执行，权限提升至 `smbd` 进程的权限，通常是 root。

**POC 代码分析：**
提供的 Dockerfile 构建了一个易受攻击的 Samba 环境，并包含对 `source3/modules/vfs_fruit.c` 文件的修改，通过修改后的代码，尝试进行内存地址泄露。具体而言，它修改了 `fruit_pread_meta_stream` 和 `fruit_pread_meta_adouble` 函数，在特定条件下将伪造的 cookie 和指针复制到数据缓冲区中。此修改的目的是允许进一步利用该漏洞，从而进行代码执行。

**投毒风险分析：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大约为10%。

主要原因:
*   **代码修改目的：** Dockerfile 对 `vfs_fruit.c` 的修改主要集中于添加内存泄露的逻辑，而不是直接执行恶意代码。这些修改旨在为进一步的漏洞利用奠定基础。
*   **公开的漏洞信息：**  CVE-2021-44142 是一个公开披露的漏洞，包含博客文章，该漏洞可实现远程代码执行。
*   **Docker环境：** 该docker环境主要是为了模拟漏洞环境提供方便，降低利用难度。

然而，仍然存在一定的投毒风险，因为攻击者可能:

*   **构建依赖：** 构建过程中，可能依赖不安全的构建源，例如被篡改的第三方lib，导致最终构建的镜像中存在后门。
*   **其他配置缺陷：** Dockerfile和相关配置文件可能存在其他安全缺陷，例如不安全的默认配置、弱密码等，可被用于进一步的攻击。

**项目地址:** [WinDyAlphA/CVE-2021-44142-vulnerable-lab](https://github.com/WinDyAlphA/CVE-2021-44142-vulnerable-lab)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #2

**来源**: [CVE-2021-44142-gudyrmik_CVE-2021-44142.md](../2021/CVE-2021-44142-gudyrmik_CVE-2021-44142.md)

# CVE-2021-44142

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md](../2021/CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md)

## CVE-2021-44142-Samba vfs_fruit 模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出（Out-of-bounds Read/Write）

**影响应用:** Samba

**危害等级:** 高危，远程攻击者可能以 smbd 进程（通常为 root 权限）执行任意代码

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要 Samba 服务器配置了 vfs_fruit 模块，并且攻击者具有对扩展文件属性（EA, xattr）的写入权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142 漏洞存在于 Samba 的 vfs_fruit 模块中。该模块旨在提供与 Apple SMB 客户端的兼容性以及与 Netatalk 3 AFP 文件服务器的互操作性。

**漏洞利用方式：**
攻击者通过精心构造的扩展文件属性（EA, xattr）触发漏洞。具体来说，当 `vfs_fruit` 模块处理这些特制属性时，会导致越界堆读取和写入操作。由于攻击者拥有扩展属性的写入权限，他们可以控制写入的内容，从而可能覆盖内存中的关键数据结构，最终导致远程代码执行，权限提升至 `smbd` 进程的权限，通常是 root。

**POC 代码分析：**
提供的 Dockerfile 构建了一个易受攻击的 Samba 环境，并包含对 `source3/modules/vfs_fruit.c` 文件的修改，通过修改后的代码，尝试进行内存地址泄露。具体而言，它修改了 `fruit_pread_meta_stream` 和 `fruit_pread_meta_adouble` 函数，在特定条件下将伪造的 cookie 和指针复制到数据缓冲区中。此修改的目的是允许进一步利用该漏洞，从而进行代码执行。

**投毒风险分析：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大约为10%。

主要原因:
*   **代码修改目的：** Dockerfile 对 `vfs_fruit.c` 的修改主要集中于添加内存泄露的逻辑，而不是直接执行恶意代码。这些修改旨在为进一步的漏洞利用奠定基础。
*   **公开的漏洞信息：**  CVE-2021-44142 是一个公开披露的漏洞，包含博客文章，该漏洞可实现远程代码执行。
*   **Docker环境：** 该docker环境主要是为了模拟漏洞环境提供方便，降低利用难度。

然而，仍然存在一定的投毒风险，因为攻击者可能:

*   **构建依赖：** 构建过程中，可能依赖不安全的构建源，例如被篡改的第三方lib，导致最终构建的镜像中存在后门。
*   **其他配置缺陷：** Dockerfile和相关配置文件可能存在其他安全缺陷，例如不安全的默认配置、弱密码等，可被用于进一步的攻击。

**项目地址:** [WinDyAlphA/CVE-2021-44142-vulnerable-lab](https://github.com/WinDyAlphA/CVE-2021-44142-vulnerable-lab)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #2

**来源**: [CVE-2021-44142-gudyrmik_CVE-2021-44142.md](../2021/CVE-2021-44142-gudyrmik_CVE-2021-44142.md)

# CVE-2021-44142

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md](../2021/CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md)

## CVE-2021-44142-Samba vfs_fruit 模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出（Out-of-bounds Read/Write）

**影响应用:** Samba

**危害等级:** 高危，远程攻击者可能以 smbd 进程（通常为 root 权限）执行任意代码

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要 Samba 服务器配置了 vfs_fruit 模块，并且攻击者具有对扩展文件属性（EA, xattr）的写入权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142 漏洞存在于 Samba 的 vfs_fruit 模块中。该模块旨在提供与 Apple SMB 客户端的兼容性以及与 Netatalk 3 AFP 文件服务器的互操作性。

**漏洞利用方式：**
攻击者通过精心构造的扩展文件属性（EA, xattr）触发漏洞。具体来说，当 `vfs_fruit` 模块处理这些特制属性时，会导致越界堆读取和写入操作。由于攻击者拥有扩展属性的写入权限，他们可以控制写入的内容，从而可能覆盖内存中的关键数据结构，最终导致远程代码执行，权限提升至 `smbd` 进程的权限，通常是 root。

**POC 代码分析：**
提供的 Dockerfile 构建了一个易受攻击的 Samba 环境，并包含对 `source3/modules/vfs_fruit.c` 文件的修改，通过修改后的代码，尝试进行内存地址泄露。具体而言，它修改了 `fruit_pread_meta_stream` 和 `fruit_pread_meta_adouble` 函数，在特定条件下将伪造的 cookie 和指针复制到数据缓冲区中。此修改的目的是允许进一步利用该漏洞，从而进行代码执行。

**投毒风险分析：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大约为10%。

主要原因:
*   **代码修改目的：** Dockerfile 对 `vfs_fruit.c` 的修改主要集中于添加内存泄露的逻辑，而不是直接执行恶意代码。这些修改旨在为进一步的漏洞利用奠定基础。
*   **公开的漏洞信息：**  CVE-2021-44142 是一个公开披露的漏洞，包含博客文章，该漏洞可实现远程代码执行。
*   **Docker环境：** 该docker环境主要是为了模拟漏洞环境提供方便，降低利用难度。

然而，仍然存在一定的投毒风险，因为攻击者可能:

*   **构建依赖：** 构建过程中，可能依赖不安全的构建源，例如被篡改的第三方lib，导致最终构建的镜像中存在后门。
*   **其他配置缺陷：** Dockerfile和相关配置文件可能存在其他安全缺陷，例如不安全的默认配置、弱密码等，可被用于进一步的攻击。

**项目地址:** [WinDyAlphA/CVE-2021-44142-vulnerable-lab](https://github.com/WinDyAlphA/CVE-2021-44142-vulnerable-lab)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #2

**来源**: [CVE-2021-44142-gudyrmik_CVE-2021-44142.md](../2021/CVE-2021-44142-gudyrmik_CVE-2021-44142.md)

# CVE-2021-44142

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md](../2021/CVE-2021-44142-WinDyAlphA_CVE-2021-44142-vulnerable-lab.md)

## CVE-2021-44142-Samba vfs_fruit 模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出（Out-of-bounds Read/Write）

**影响应用:** Samba

**危害等级:** 高危，远程攻击者可能以 smbd 进程（通常为 root 权限）执行任意代码

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要 Samba 服务器配置了 vfs_fruit 模块，并且攻击者具有对扩展文件属性（EA, xattr）的写入权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142 漏洞存在于 Samba 的 vfs_fruit 模块中。该模块旨在提供与 Apple SMB 客户端的兼容性以及与 Netatalk 3 AFP 文件服务器的互操作性。

**漏洞利用方式：**
攻击者通过精心构造的扩展文件属性（EA, xattr）触发漏洞。具体来说，当 `vfs_fruit` 模块处理这些特制属性时，会导致越界堆读取和写入操作。由于攻击者拥有扩展属性的写入权限，他们可以控制写入的内容，从而可能覆盖内存中的关键数据结构，最终导致远程代码执行，权限提升至 `smbd` 进程的权限，通常是 root。

**POC 代码分析：**
提供的 Dockerfile 构建了一个易受攻击的 Samba 环境，并包含对 `source3/modules/vfs_fruit.c` 文件的修改，通过修改后的代码，尝试进行内存地址泄露。具体而言，它修改了 `fruit_pread_meta_stream` 和 `fruit_pread_meta_adouble` 函数，在特定条件下将伪造的 cookie 和指针复制到数据缓冲区中。此修改的目的是允许进一步利用该漏洞，从而进行代码执行。

**投毒风险分析：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大约为10%。

主要原因:
*   **代码修改目的：** Dockerfile 对 `vfs_fruit.c` 的修改主要集中于添加内存泄露的逻辑，而不是直接执行恶意代码。这些修改旨在为进一步的漏洞利用奠定基础。
*   **公开的漏洞信息：**  CVE-2021-44142 是一个公开披露的漏洞，包含博客文章，该漏洞可实现远程代码执行。
*   **Docker环境：** 该docker环境主要是为了模拟漏洞环境提供方便，降低利用难度。

然而，仍然存在一定的投毒风险，因为攻击者可能:

*   **构建依赖：** 构建过程中，可能依赖不安全的构建源，例如被篡改的第三方lib，导致最终构建的镜像中存在后门。
*   **其他配置缺陷：** Dockerfile和相关配置文件可能存在其他安全缺陷，例如不安全的默认配置、弱密码等，可被用于进一步的攻击。

**项目地址:** [WinDyAlphA/CVE-2021-44142-vulnerable-lab](https://github.com/WinDyAlphA/CVE-2021-44142-vulnerable-lab)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #2

**来源**: [CVE-2021-44142-gudyrmik_CVE-2021-44142.md](../2021/CVE-2021-44142-gudyrmik_CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit-堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出（Out-of-bounds Read/Write）

**影响应用:** Samba vfs_fruit

**危害等级:** 高危，允许远程攻击者以smbd（通常是root）权限执行任意代码

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要目标Samba服务器配置了vfs_fruit模块，并且攻击者需要具有对文件扩展属性的写入权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142 是 Samba vfs_fruit 模块中的一个堆溢出漏洞。该模块使用扩展文件属性（EA，xattr）来提供与 Apple SMB 客户端的增强兼容性。漏洞存在于处理特定构造的扩展文件属性时，允许远程攻击者利用该漏洞。攻击者需要对文件扩展属性具有写入权限。通过精心构造恶意的扩展文件属性，攻击者可以触发堆溢出，进而以 smbd 进程（通常以 root 权限运行）的身份执行任意代码。

提供的漏洞利用代码包含Dockerfile，用于构建存在漏洞的Samba环境，以及一个Jupyter Notebook（cve-2021-44142-poc.ipynb），其中包含利用漏洞的概念验证代码。Dockerfile安装了一个老版本存在漏洞的Samba(samba-4.5.16)，并配置了smb.conf启用了`vfs_fruit`，并允许guest账户访问`TimeMachineBackup`共享目录。这创造了漏洞可利用的环境。

Jupyter Notebook定义了AppleDouble文件的结构,可能通过构造恶意的AppleDouble文件内容，来触发堆溢出。

**利用方式：**

1.  攻击者首先需要能够访问启用了 `vfs_fruit` 的 Samba 共享，并且具有写入扩展属性的权限（通常可以通过配置允许）。
2.  攻击者构造一个包含恶意数据结构的扩展文件属性（可能涉及AppleDouble文件格式）。
3.  当 Samba 服务器尝试处理这个恶意的扩展文件属性时，`vfs_fruit` 模块中的漏洞会被触发，导致堆溢出。
4.  攻击者利用堆溢出覆盖内存，最终执行任意代码。由于 `smbd` 进程通常以 root 权限运行，攻击者也可以获得 root 权限。

**投毒风险分析:**

该代码库的主要目的是复现和验证 CVE-2021-44142 漏洞，因此包含恶意代码的可能性较低。但仍然存在一些风险：

*   **Dockerfile 修改：** 攻击者可能会修改 Dockerfile，添加额外的后门或恶意软件。例如，在构建过程中安装其他软件包或修改 Samba 的配置。
*   **漏洞利用代码修改：** 攻击者可能会修改 Jupyter Notebook 中的漏洞利用代码，使其在成功利用漏洞后执行额外的恶意操作。

因为此项目的主要目的是漏洞利用，存在修改Dockerfile，或者EXP执行恶意操作的可能性，因此判断投毒风险为10%。该数字并非绝对，是根据代码用途和可能的修改点做出的判断。

**项目地址:** [gudyrmik/CVE-2021-44142](https://github.com/gudyrmik/CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #3

**来源**: [CVE-2021-44142-horizon3ai_CVE-2021-44142.md](../2021/CVE-2021-44142-horizon3ai_CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit-堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，远程代码执行

**影响版本:** Samba versions prior to 4.13.17, 4.14.12 and 4.15.5

**利用条件:** 需要启用 vfs_fruit 模块，并且攻击者需要对共享目录有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44142 是 Samba vfs_fruit 模块中的一个堆溢出漏洞。该模块用于提供与 Apple SMB 客户端的兼容性。攻击者通过精心构造的扩展文件属性，可以进行越界堆读写，最终导致远程代码执行。POC 代码通过 SMB 协议连接到目标 Samba 服务器，并尝试利用该漏洞泄露堆 cookie 和链表指针，以此验证漏洞的存在。由于 Western Digital 的定制补丁会禁用某些 VFS 模块，因此 POC 代码伪装成来自 OSX 的连接。 该 POC 仓库包含 LICENSE, README.md, apple.py, check_vulnerable.py 文件。从代码分析来看，没有明显的投毒迹象，例如执行恶意命令或上传恶意文件。check_vulnerable.py 的功能是检查目标是否存在漏洞，apple.py 包含与 AppleDouble 结构相关的定义，用于构造特定的数据包。 整体代码功能较为清晰，主要是为了验证漏洞是否存在，不存在额外的后门代码。投毒风险极低。

**项目地址:** [horizon3ai/CVE-2021-44142](https://github.com/horizon3ai/CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #4

**来源**: [CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md](../2021/CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要启用vfs_fruit模块，且攻击者需要对共享目录具有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142是Samba vfs_fruit模块中的一个堆溢出漏洞。该模块用于提供与Apple SMB客户端的增强兼容性和与Netatalk 3 AFP文件服务器的互操作性。

**有效性：**
提供的PoC代码看起来是有效的。它包含一个用于检查Samba服务器是否存在CVE-2021-44142漏洞的Python脚本（check_vulnerable.py），以及辅助文件（apple.py，LICENSE，README.md）。脚本通过SMB协议连接到目标服务器，并利用漏洞读取堆cookie和链表指针。脚本明确说明了如果服务器配置了Western Digital定制的Samba补丁，则需要模拟来自OSX的连接。

**投毒风险：**
代码本身看起来比较简单，主要功能是验证漏洞的存在，而不是执行恶意操作。检查了LICENSE(MIT协议)和README.md，未发现明显恶意代码的迹象。但仍存在小概率(10%)的投毒风险，例如：
*   代码可能存在细微的错误，导致目标系统崩溃或不稳定。
*   利用该漏洞进行进一步攻击可能需要结合其他恶意代码。
*   代码可能收集用户信息并上传到恶意服务器（尽管目前的代码未发现此行为）。

**利用方式：**
1.  **配置vfs_fruit模块：** Samba服务器必须配置并启用vfs_fruit模块。
2.  **写入扩展属性：** 攻击者需要对共享目录具有写入扩展属性（EA, xattr）的权限。
3.  **发送特制请求：** 攻击者通过SMB协议发送特制请求，写入恶意的扩展文件属性。这些恶意属性会触发vfs_fruit模块中的堆溢出漏洞。
4.  **远程代码执行：** 成功利用该漏洞后，攻击者可以smbd的权限（通常是root权限）执行任意代码。

**总结：**
此漏洞利用过程依赖于`vfs_fruit`模块，该模块在Samba服务器中处理与Apple文件共享相关的扩展属性。通过精心构造的扩展属性，攻击者可以触发堆溢出，从而控制服务器的执行流程。由于该漏洞允许以root权限执行任意代码，因此风险非常高。

**项目地址:** [hrsman/Samba-CVE-2021-44142](https://github.com/hrsman/Samba-CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---



---

## POC #3

**来源**: [CVE-2021-44142-horizon3ai_CVE-2021-44142.md](../2021/CVE-2021-44142-horizon3ai_CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit-堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，远程代码执行

**影响版本:** Samba versions prior to 4.13.17, 4.14.12 and 4.15.5

**利用条件:** 需要启用 vfs_fruit 模块，并且攻击者需要对共享目录有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44142 是 Samba vfs_fruit 模块中的一个堆溢出漏洞。该模块用于提供与 Apple SMB 客户端的兼容性。攻击者通过精心构造的扩展文件属性，可以进行越界堆读写，最终导致远程代码执行。POC 代码通过 SMB 协议连接到目标 Samba 服务器，并尝试利用该漏洞泄露堆 cookie 和链表指针，以此验证漏洞的存在。由于 Western Digital 的定制补丁会禁用某些 VFS 模块，因此 POC 代码伪装成来自 OSX 的连接。 该 POC 仓库包含 LICENSE, README.md, apple.py, check_vulnerable.py 文件。从代码分析来看，没有明显的投毒迹象，例如执行恶意命令或上传恶意文件。check_vulnerable.py 的功能是检查目标是否存在漏洞，apple.py 包含与 AppleDouble 结构相关的定义，用于构造特定的数据包。 整体代码功能较为清晰，主要是为了验证漏洞是否存在，不存在额外的后门代码。投毒风险极低。

**项目地址:** [horizon3ai/CVE-2021-44142](https://github.com/horizon3ai/CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #4

**来源**: [CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md](../2021/CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要启用vfs_fruit模块，且攻击者需要对共享目录具有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142是Samba vfs_fruit模块中的一个堆溢出漏洞。该模块用于提供与Apple SMB客户端的增强兼容性和与Netatalk 3 AFP文件服务器的互操作性。

**有效性：**
提供的PoC代码看起来是有效的。它包含一个用于检查Samba服务器是否存在CVE-2021-44142漏洞的Python脚本（check_vulnerable.py），以及辅助文件（apple.py，LICENSE，README.md）。脚本通过SMB协议连接到目标服务器，并利用漏洞读取堆cookie和链表指针。脚本明确说明了如果服务器配置了Western Digital定制的Samba补丁，则需要模拟来自OSX的连接。

**投毒风险：**
代码本身看起来比较简单，主要功能是验证漏洞的存在，而不是执行恶意操作。检查了LICENSE(MIT协议)和README.md，未发现明显恶意代码的迹象。但仍存在小概率(10%)的投毒风险，例如：
*   代码可能存在细微的错误，导致目标系统崩溃或不稳定。
*   利用该漏洞进行进一步攻击可能需要结合其他恶意代码。
*   代码可能收集用户信息并上传到恶意服务器（尽管目前的代码未发现此行为）。

**利用方式：**
1.  **配置vfs_fruit模块：** Samba服务器必须配置并启用vfs_fruit模块。
2.  **写入扩展属性：** 攻击者需要对共享目录具有写入扩展属性（EA, xattr）的权限。
3.  **发送特制请求：** 攻击者通过SMB协议发送特制请求，写入恶意的扩展文件属性。这些恶意属性会触发vfs_fruit模块中的堆溢出漏洞。
4.  **远程代码执行：** 成功利用该漏洞后，攻击者可以smbd的权限（通常是root权限）执行任意代码。

**总结：**
此漏洞利用过程依赖于`vfs_fruit`模块，该模块在Samba服务器中处理与Apple文件共享相关的扩展属性。通过精心构造的扩展属性，攻击者可以触发堆溢出，从而控制服务器的执行流程。由于该漏洞允许以root权限执行任意代码，因此风险非常高。

**项目地址:** [hrsman/Samba-CVE-2021-44142](https://github.com/hrsman/Samba-CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---



---

## POC #3

**来源**: [CVE-2021-44142-horizon3ai_CVE-2021-44142.md](../2021/CVE-2021-44142-horizon3ai_CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit-堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，远程代码执行

**影响版本:** Samba versions prior to 4.13.17, 4.14.12 and 4.15.5

**利用条件:** 需要启用 vfs_fruit 模块，并且攻击者需要对共享目录有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44142 是 Samba vfs_fruit 模块中的一个堆溢出漏洞。该模块用于提供与 Apple SMB 客户端的兼容性。攻击者通过精心构造的扩展文件属性，可以进行越界堆读写，最终导致远程代码执行。POC 代码通过 SMB 协议连接到目标 Samba 服务器，并尝试利用该漏洞泄露堆 cookie 和链表指针，以此验证漏洞的存在。由于 Western Digital 的定制补丁会禁用某些 VFS 模块，因此 POC 代码伪装成来自 OSX 的连接。 该 POC 仓库包含 LICENSE, README.md, apple.py, check_vulnerable.py 文件。从代码分析来看，没有明显的投毒迹象，例如执行恶意命令或上传恶意文件。check_vulnerable.py 的功能是检查目标是否存在漏洞，apple.py 包含与 AppleDouble 结构相关的定义，用于构造特定的数据包。 整体代码功能较为清晰，主要是为了验证漏洞是否存在，不存在额外的后门代码。投毒风险极低。

**项目地址:** [horizon3ai/CVE-2021-44142](https://github.com/horizon3ai/CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #4

**来源**: [CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md](../2021/CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要启用vfs_fruit模块，且攻击者需要对共享目录具有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142是Samba vfs_fruit模块中的一个堆溢出漏洞。该模块用于提供与Apple SMB客户端的增强兼容性和与Netatalk 3 AFP文件服务器的互操作性。

**有效性：**
提供的PoC代码看起来是有效的。它包含一个用于检查Samba服务器是否存在CVE-2021-44142漏洞的Python脚本（check_vulnerable.py），以及辅助文件（apple.py，LICENSE，README.md）。脚本通过SMB协议连接到目标服务器，并利用漏洞读取堆cookie和链表指针。脚本明确说明了如果服务器配置了Western Digital定制的Samba补丁，则需要模拟来自OSX的连接。

**投毒风险：**
代码本身看起来比较简单，主要功能是验证漏洞的存在，而不是执行恶意操作。检查了LICENSE(MIT协议)和README.md，未发现明显恶意代码的迹象。但仍存在小概率(10%)的投毒风险，例如：
*   代码可能存在细微的错误，导致目标系统崩溃或不稳定。
*   利用该漏洞进行进一步攻击可能需要结合其他恶意代码。
*   代码可能收集用户信息并上传到恶意服务器（尽管目前的代码未发现此行为）。

**利用方式：**
1.  **配置vfs_fruit模块：** Samba服务器必须配置并启用vfs_fruit模块。
2.  **写入扩展属性：** 攻击者需要对共享目录具有写入扩展属性（EA, xattr）的权限。
3.  **发送特制请求：** 攻击者通过SMB协议发送特制请求，写入恶意的扩展文件属性。这些恶意属性会触发vfs_fruit模块中的堆溢出漏洞。
4.  **远程代码执行：** 成功利用该漏洞后，攻击者可以smbd的权限（通常是root权限）执行任意代码。

**总结：**
此漏洞利用过程依赖于`vfs_fruit`模块，该模块在Samba服务器中处理与Apple文件共享相关的扩展属性。通过精心构造的扩展属性，攻击者可以触发堆溢出，从而控制服务器的执行流程。由于该漏洞允许以root权限执行任意代码，因此风险非常高。

**项目地址:** [hrsman/Samba-CVE-2021-44142](https://github.com/hrsman/Samba-CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---



---

## POC #3

**来源**: [CVE-2021-44142-horizon3ai_CVE-2021-44142.md](../2021/CVE-2021-44142-horizon3ai_CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit-堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，远程代码执行

**影响版本:** Samba versions prior to 4.13.17, 4.14.12 and 4.15.5

**利用条件:** 需要启用 vfs_fruit 模块，并且攻击者需要对共享目录有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44142 是 Samba vfs_fruit 模块中的一个堆溢出漏洞。该模块用于提供与 Apple SMB 客户端的兼容性。攻击者通过精心构造的扩展文件属性，可以进行越界堆读写，最终导致远程代码执行。POC 代码通过 SMB 协议连接到目标 Samba 服务器，并尝试利用该漏洞泄露堆 cookie 和链表指针，以此验证漏洞的存在。由于 Western Digital 的定制补丁会禁用某些 VFS 模块，因此 POC 代码伪装成来自 OSX 的连接。 该 POC 仓库包含 LICENSE, README.md, apple.py, check_vulnerable.py 文件。从代码分析来看，没有明显的投毒迹象，例如执行恶意命令或上传恶意文件。check_vulnerable.py 的功能是检查目标是否存在漏洞，apple.py 包含与 AppleDouble 结构相关的定义，用于构造特定的数据包。 整体代码功能较为清晰，主要是为了验证漏洞是否存在，不存在额外的后门代码。投毒风险极低。

**项目地址:** [horizon3ai/CVE-2021-44142](https://github.com/horizon3ai/CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #4

**来源**: [CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md](../2021/CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要启用vfs_fruit模块，且攻击者需要对共享目录具有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142是Samba vfs_fruit模块中的一个堆溢出漏洞。该模块用于提供与Apple SMB客户端的增强兼容性和与Netatalk 3 AFP文件服务器的互操作性。

**有效性：**
提供的PoC代码看起来是有效的。它包含一个用于检查Samba服务器是否存在CVE-2021-44142漏洞的Python脚本（check_vulnerable.py），以及辅助文件（apple.py，LICENSE，README.md）。脚本通过SMB协议连接到目标服务器，并利用漏洞读取堆cookie和链表指针。脚本明确说明了如果服务器配置了Western Digital定制的Samba补丁，则需要模拟来自OSX的连接。

**投毒风险：**
代码本身看起来比较简单，主要功能是验证漏洞的存在，而不是执行恶意操作。检查了LICENSE(MIT协议)和README.md，未发现明显恶意代码的迹象。但仍存在小概率(10%)的投毒风险，例如：
*   代码可能存在细微的错误，导致目标系统崩溃或不稳定。
*   利用该漏洞进行进一步攻击可能需要结合其他恶意代码。
*   代码可能收集用户信息并上传到恶意服务器（尽管目前的代码未发现此行为）。

**利用方式：**
1.  **配置vfs_fruit模块：** Samba服务器必须配置并启用vfs_fruit模块。
2.  **写入扩展属性：** 攻击者需要对共享目录具有写入扩展属性（EA, xattr）的权限。
3.  **发送特制请求：** 攻击者通过SMB协议发送特制请求，写入恶意的扩展文件属性。这些恶意属性会触发vfs_fruit模块中的堆溢出漏洞。
4.  **远程代码执行：** 成功利用该漏洞后，攻击者可以smbd的权限（通常是root权限）执行任意代码。

**总结：**
此漏洞利用过程依赖于`vfs_fruit`模块，该模块在Samba服务器中处理与Apple文件共享相关的扩展属性。通过精心构造的扩展属性，攻击者可以触发堆溢出，从而控制服务器的执行流程。由于该漏洞允许以root权限执行任意代码，因此风险非常高。

**项目地址:** [hrsman/Samba-CVE-2021-44142](https://github.com/hrsman/Samba-CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---



---

## POC #3

**来源**: [CVE-2021-44142-horizon3ai_CVE-2021-44142.md](../2021/CVE-2021-44142-horizon3ai_CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit-堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，远程代码执行

**影响版本:** Samba versions prior to 4.13.17, 4.14.12 and 4.15.5

**利用条件:** 需要启用 vfs_fruit 模块，并且攻击者需要对共享目录有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44142 是 Samba vfs_fruit 模块中的一个堆溢出漏洞。该模块用于提供与 Apple SMB 客户端的兼容性。攻击者通过精心构造的扩展文件属性，可以进行越界堆读写，最终导致远程代码执行。POC 代码通过 SMB 协议连接到目标 Samba 服务器，并尝试利用该漏洞泄露堆 cookie 和链表指针，以此验证漏洞的存在。由于 Western Digital 的定制补丁会禁用某些 VFS 模块，因此 POC 代码伪装成来自 OSX 的连接。 该 POC 仓库包含 LICENSE, README.md, apple.py, check_vulnerable.py 文件。从代码分析来看，没有明显的投毒迹象，例如执行恶意命令或上传恶意文件。check_vulnerable.py 的功能是检查目标是否存在漏洞，apple.py 包含与 AppleDouble 结构相关的定义，用于构造特定的数据包。 整体代码功能较为清晰，主要是为了验证漏洞是否存在，不存在额外的后门代码。投毒风险极低。

**项目地址:** [horizon3ai/CVE-2021-44142](https://github.com/horizon3ai/CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #4

**来源**: [CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md](../2021/CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要启用vfs_fruit模块，且攻击者需要对共享目录具有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142是Samba vfs_fruit模块中的一个堆溢出漏洞。该模块用于提供与Apple SMB客户端的增强兼容性和与Netatalk 3 AFP文件服务器的互操作性。

**有效性：**
提供的PoC代码看起来是有效的。它包含一个用于检查Samba服务器是否存在CVE-2021-44142漏洞的Python脚本（check_vulnerable.py），以及辅助文件（apple.py，LICENSE，README.md）。脚本通过SMB协议连接到目标服务器，并利用漏洞读取堆cookie和链表指针。脚本明确说明了如果服务器配置了Western Digital定制的Samba补丁，则需要模拟来自OSX的连接。

**投毒风险：**
代码本身看起来比较简单，主要功能是验证漏洞的存在，而不是执行恶意操作。检查了LICENSE(MIT协议)和README.md，未发现明显恶意代码的迹象。但仍存在小概率(10%)的投毒风险，例如：
*   代码可能存在细微的错误，导致目标系统崩溃或不稳定。
*   利用该漏洞进行进一步攻击可能需要结合其他恶意代码。
*   代码可能收集用户信息并上传到恶意服务器（尽管目前的代码未发现此行为）。

**利用方式：**
1.  **配置vfs_fruit模块：** Samba服务器必须配置并启用vfs_fruit模块。
2.  **写入扩展属性：** 攻击者需要对共享目录具有写入扩展属性（EA, xattr）的权限。
3.  **发送特制请求：** 攻击者通过SMB协议发送特制请求，写入恶意的扩展文件属性。这些恶意属性会触发vfs_fruit模块中的堆溢出漏洞。
4.  **远程代码执行：** 成功利用该漏洞后，攻击者可以smbd的权限（通常是root权限）执行任意代码。

**总结：**
此漏洞利用过程依赖于`vfs_fruit`模块，该模块在Samba服务器中处理与Apple文件共享相关的扩展属性。通过精心构造的扩展属性，攻击者可以触发堆溢出，从而控制服务器的执行流程。由于该漏洞允许以root权限执行任意代码，因此风险非常高。

**项目地址:** [hrsman/Samba-CVE-2021-44142](https://github.com/hrsman/Samba-CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---



---

## POC #3

**来源**: [CVE-2021-44142-horizon3ai_CVE-2021-44142.md](../2021/CVE-2021-44142-horizon3ai_CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit-堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，远程代码执行

**影响版本:** Samba versions prior to 4.13.17, 4.14.12 and 4.15.5

**利用条件:** 需要启用 vfs_fruit 模块，并且攻击者需要对共享目录有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44142 是 Samba vfs_fruit 模块中的一个堆溢出漏洞。该模块用于提供与 Apple SMB 客户端的兼容性。攻击者通过精心构造的扩展文件属性，可以进行越界堆读写，最终导致远程代码执行。POC 代码通过 SMB 协议连接到目标 Samba 服务器，并尝试利用该漏洞泄露堆 cookie 和链表指针，以此验证漏洞的存在。由于 Western Digital 的定制补丁会禁用某些 VFS 模块，因此 POC 代码伪装成来自 OSX 的连接。 该 POC 仓库包含 LICENSE, README.md, apple.py, check_vulnerable.py 文件。从代码分析来看，没有明显的投毒迹象，例如执行恶意命令或上传恶意文件。check_vulnerable.py 的功能是检查目标是否存在漏洞，apple.py 包含与 AppleDouble 结构相关的定义，用于构造特定的数据包。 整体代码功能较为清晰，主要是为了验证漏洞是否存在，不存在额外的后门代码。投毒风险极低。

**项目地址:** [horizon3ai/CVE-2021-44142](https://github.com/horizon3ai/CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #4

**来源**: [CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md](../2021/CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要启用vfs_fruit模块，且攻击者需要对共享目录具有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142是Samba vfs_fruit模块中的一个堆溢出漏洞。该模块用于提供与Apple SMB客户端的增强兼容性和与Netatalk 3 AFP文件服务器的互操作性。

**有效性：**
提供的PoC代码看起来是有效的。它包含一个用于检查Samba服务器是否存在CVE-2021-44142漏洞的Python脚本（check_vulnerable.py），以及辅助文件（apple.py，LICENSE，README.md）。脚本通过SMB协议连接到目标服务器，并利用漏洞读取堆cookie和链表指针。脚本明确说明了如果服务器配置了Western Digital定制的Samba补丁，则需要模拟来自OSX的连接。

**投毒风险：**
代码本身看起来比较简单，主要功能是验证漏洞的存在，而不是执行恶意操作。检查了LICENSE(MIT协议)和README.md，未发现明显恶意代码的迹象。但仍存在小概率(10%)的投毒风险，例如：
*   代码可能存在细微的错误，导致目标系统崩溃或不稳定。
*   利用该漏洞进行进一步攻击可能需要结合其他恶意代码。
*   代码可能收集用户信息并上传到恶意服务器（尽管目前的代码未发现此行为）。

**利用方式：**
1.  **配置vfs_fruit模块：** Samba服务器必须配置并启用vfs_fruit模块。
2.  **写入扩展属性：** 攻击者需要对共享目录具有写入扩展属性（EA, xattr）的权限。
3.  **发送特制请求：** 攻击者通过SMB协议发送特制请求，写入恶意的扩展文件属性。这些恶意属性会触发vfs_fruit模块中的堆溢出漏洞。
4.  **远程代码执行：** 成功利用该漏洞后，攻击者可以smbd的权限（通常是root权限）执行任意代码。

**总结：**
此漏洞利用过程依赖于`vfs_fruit`模块，该模块在Samba服务器中处理与Apple文件共享相关的扩展属性。通过精心构造的扩展属性，攻击者可以触发堆溢出，从而控制服务器的执行流程。由于该漏洞允许以root权限执行任意代码，因此风险非常高。

**项目地址:** [hrsman/Samba-CVE-2021-44142](https://github.com/hrsman/Samba-CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---



---

## POC #3

**来源**: [CVE-2021-44142-horizon3ai_CVE-2021-44142.md](../2021/CVE-2021-44142-horizon3ai_CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit-堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，远程代码执行

**影响版本:** Samba versions prior to 4.13.17, 4.14.12 and 4.15.5

**利用条件:** 需要启用 vfs_fruit 模块，并且攻击者需要对共享目录有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44142 是 Samba vfs_fruit 模块中的一个堆溢出漏洞。该模块用于提供与 Apple SMB 客户端的兼容性。攻击者通过精心构造的扩展文件属性，可以进行越界堆读写，最终导致远程代码执行。POC 代码通过 SMB 协议连接到目标 Samba 服务器，并尝试利用该漏洞泄露堆 cookie 和链表指针，以此验证漏洞的存在。由于 Western Digital 的定制补丁会禁用某些 VFS 模块，因此 POC 代码伪装成来自 OSX 的连接。 该 POC 仓库包含 LICENSE, README.md, apple.py, check_vulnerable.py 文件。从代码分析来看，没有明显的投毒迹象，例如执行恶意命令或上传恶意文件。check_vulnerable.py 的功能是检查目标是否存在漏洞，apple.py 包含与 AppleDouble 结构相关的定义，用于构造特定的数据包。 整体代码功能较为清晰，主要是为了验证漏洞是否存在，不存在额外的后门代码。投毒风险极低。

**项目地址:** [horizon3ai/CVE-2021-44142](https://github.com/horizon3ai/CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #4

**来源**: [CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md](../2021/CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要启用vfs_fruit模块，且攻击者需要对共享目录具有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142是Samba vfs_fruit模块中的一个堆溢出漏洞。该模块用于提供与Apple SMB客户端的增强兼容性和与Netatalk 3 AFP文件服务器的互操作性。

**有效性：**
提供的PoC代码看起来是有效的。它包含一个用于检查Samba服务器是否存在CVE-2021-44142漏洞的Python脚本（check_vulnerable.py），以及辅助文件（apple.py，LICENSE，README.md）。脚本通过SMB协议连接到目标服务器，并利用漏洞读取堆cookie和链表指针。脚本明确说明了如果服务器配置了Western Digital定制的Samba补丁，则需要模拟来自OSX的连接。

**投毒风险：**
代码本身看起来比较简单，主要功能是验证漏洞的存在，而不是执行恶意操作。检查了LICENSE(MIT协议)和README.md，未发现明显恶意代码的迹象。但仍存在小概率(10%)的投毒风险，例如：
*   代码可能存在细微的错误，导致目标系统崩溃或不稳定。
*   利用该漏洞进行进一步攻击可能需要结合其他恶意代码。
*   代码可能收集用户信息并上传到恶意服务器（尽管目前的代码未发现此行为）。

**利用方式：**
1.  **配置vfs_fruit模块：** Samba服务器必须配置并启用vfs_fruit模块。
2.  **写入扩展属性：** 攻击者需要对共享目录具有写入扩展属性（EA, xattr）的权限。
3.  **发送特制请求：** 攻击者通过SMB协议发送特制请求，写入恶意的扩展文件属性。这些恶意属性会触发vfs_fruit模块中的堆溢出漏洞。
4.  **远程代码执行：** 成功利用该漏洞后，攻击者可以smbd的权限（通常是root权限）执行任意代码。

**总结：**
此漏洞利用过程依赖于`vfs_fruit`模块，该模块在Samba服务器中处理与Apple文件共享相关的扩展属性。通过精心构造的扩展属性，攻击者可以触发堆溢出，从而控制服务器的执行流程。由于该漏洞允许以root权限执行任意代码，因此风险非常高。

**项目地址:** [hrsman/Samba-CVE-2021-44142](https://github.com/hrsman/Samba-CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---



---

## POC #3

**来源**: [CVE-2021-44142-horizon3ai_CVE-2021-44142.md](../2021/CVE-2021-44142-horizon3ai_CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit-堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，远程代码执行

**影响版本:** Samba versions prior to 4.13.17, 4.14.12 and 4.15.5

**利用条件:** 需要启用 vfs_fruit 模块，并且攻击者需要对共享目录有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44142 是 Samba vfs_fruit 模块中的一个堆溢出漏洞。该模块用于提供与 Apple SMB 客户端的兼容性。攻击者通过精心构造的扩展文件属性，可以进行越界堆读写，最终导致远程代码执行。POC 代码通过 SMB 协议连接到目标 Samba 服务器，并尝试利用该漏洞泄露堆 cookie 和链表指针，以此验证漏洞的存在。由于 Western Digital 的定制补丁会禁用某些 VFS 模块，因此 POC 代码伪装成来自 OSX 的连接。 该 POC 仓库包含 LICENSE, README.md, apple.py, check_vulnerable.py 文件。从代码分析来看，没有明显的投毒迹象，例如执行恶意命令或上传恶意文件。check_vulnerable.py 的功能是检查目标是否存在漏洞，apple.py 包含与 AppleDouble 结构相关的定义，用于构造特定的数据包。 整体代码功能较为清晰，主要是为了验证漏洞是否存在，不存在额外的后门代码。投毒风险极低。

**项目地址:** [horizon3ai/CVE-2021-44142](https://github.com/horizon3ai/CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #4

**来源**: [CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md](../2021/CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要启用vfs_fruit模块，且攻击者需要对共享目录具有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142是Samba vfs_fruit模块中的一个堆溢出漏洞。该模块用于提供与Apple SMB客户端的增强兼容性和与Netatalk 3 AFP文件服务器的互操作性。

**有效性：**
提供的PoC代码看起来是有效的。它包含一个用于检查Samba服务器是否存在CVE-2021-44142漏洞的Python脚本（check_vulnerable.py），以及辅助文件（apple.py，LICENSE，README.md）。脚本通过SMB协议连接到目标服务器，并利用漏洞读取堆cookie和链表指针。脚本明确说明了如果服务器配置了Western Digital定制的Samba补丁，则需要模拟来自OSX的连接。

**投毒风险：**
代码本身看起来比较简单，主要功能是验证漏洞的存在，而不是执行恶意操作。检查了LICENSE(MIT协议)和README.md，未发现明显恶意代码的迹象。但仍存在小概率(10%)的投毒风险，例如：
*   代码可能存在细微的错误，导致目标系统崩溃或不稳定。
*   利用该漏洞进行进一步攻击可能需要结合其他恶意代码。
*   代码可能收集用户信息并上传到恶意服务器（尽管目前的代码未发现此行为）。

**利用方式：**
1.  **配置vfs_fruit模块：** Samba服务器必须配置并启用vfs_fruit模块。
2.  **写入扩展属性：** 攻击者需要对共享目录具有写入扩展属性（EA, xattr）的权限。
3.  **发送特制请求：** 攻击者通过SMB协议发送特制请求，写入恶意的扩展文件属性。这些恶意属性会触发vfs_fruit模块中的堆溢出漏洞。
4.  **远程代码执行：** 成功利用该漏洞后，攻击者可以smbd的权限（通常是root权限）执行任意代码。

**总结：**
此漏洞利用过程依赖于`vfs_fruit`模块，该模块在Samba服务器中处理与Apple文件共享相关的扩展属性。通过精心构造的扩展属性，攻击者可以触发堆溢出，从而控制服务器的执行流程。由于该漏洞允许以root权限执行任意代码，因此风险非常高。

**项目地址:** [hrsman/Samba-CVE-2021-44142](https://github.com/hrsman/Samba-CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---



---

## POC #3

**来源**: [CVE-2021-44142-horizon3ai_CVE-2021-44142.md](../2021/CVE-2021-44142-horizon3ai_CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit-堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，远程代码执行

**影响版本:** Samba versions prior to 4.13.17, 4.14.12 and 4.15.5

**利用条件:** 需要启用 vfs_fruit 模块，并且攻击者需要对共享目录有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44142 是 Samba vfs_fruit 模块中的一个堆溢出漏洞。该模块用于提供与 Apple SMB 客户端的兼容性。攻击者通过精心构造的扩展文件属性，可以进行越界堆读写，最终导致远程代码执行。POC 代码通过 SMB 协议连接到目标 Samba 服务器，并尝试利用该漏洞泄露堆 cookie 和链表指针，以此验证漏洞的存在。由于 Western Digital 的定制补丁会禁用某些 VFS 模块，因此 POC 代码伪装成来自 OSX 的连接。 该 POC 仓库包含 LICENSE, README.md, apple.py, check_vulnerable.py 文件。从代码分析来看，没有明显的投毒迹象，例如执行恶意命令或上传恶意文件。check_vulnerable.py 的功能是检查目标是否存在漏洞，apple.py 包含与 AppleDouble 结构相关的定义，用于构造特定的数据包。 整体代码功能较为清晰，主要是为了验证漏洞是否存在，不存在额外的后门代码。投毒风险极低。

**项目地址:** [horizon3ai/CVE-2021-44142](https://github.com/horizon3ai/CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #4

**来源**: [CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md](../2021/CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要启用vfs_fruit模块，且攻击者需要对共享目录具有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142是Samba vfs_fruit模块中的一个堆溢出漏洞。该模块用于提供与Apple SMB客户端的增强兼容性和与Netatalk 3 AFP文件服务器的互操作性。

**有效性：**
提供的PoC代码看起来是有效的。它包含一个用于检查Samba服务器是否存在CVE-2021-44142漏洞的Python脚本（check_vulnerable.py），以及辅助文件（apple.py，LICENSE，README.md）。脚本通过SMB协议连接到目标服务器，并利用漏洞读取堆cookie和链表指针。脚本明确说明了如果服务器配置了Western Digital定制的Samba补丁，则需要模拟来自OSX的连接。

**投毒风险：**
代码本身看起来比较简单，主要功能是验证漏洞的存在，而不是执行恶意操作。检查了LICENSE(MIT协议)和README.md，未发现明显恶意代码的迹象。但仍存在小概率(10%)的投毒风险，例如：
*   代码可能存在细微的错误，导致目标系统崩溃或不稳定。
*   利用该漏洞进行进一步攻击可能需要结合其他恶意代码。
*   代码可能收集用户信息并上传到恶意服务器（尽管目前的代码未发现此行为）。

**利用方式：**
1.  **配置vfs_fruit模块：** Samba服务器必须配置并启用vfs_fruit模块。
2.  **写入扩展属性：** 攻击者需要对共享目录具有写入扩展属性（EA, xattr）的权限。
3.  **发送特制请求：** 攻击者通过SMB协议发送特制请求，写入恶意的扩展文件属性。这些恶意属性会触发vfs_fruit模块中的堆溢出漏洞。
4.  **远程代码执行：** 成功利用该漏洞后，攻击者可以smbd的权限（通常是root权限）执行任意代码。

**总结：**
此漏洞利用过程依赖于`vfs_fruit`模块，该模块在Samba服务器中处理与Apple文件共享相关的扩展属性。通过精心构造的扩展属性，攻击者可以触发堆溢出，从而控制服务器的执行流程。由于该漏洞允许以root权限执行任意代码，因此风险非常高。

**项目地址:** [hrsman/Samba-CVE-2021-44142](https://github.com/hrsman/Samba-CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---



---

## POC #3

**来源**: [CVE-2021-44142-horizon3ai_CVE-2021-44142.md](../2021/CVE-2021-44142-horizon3ai_CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit-堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，远程代码执行

**影响版本:** Samba versions prior to 4.13.17, 4.14.12 and 4.15.5

**利用条件:** 需要启用 vfs_fruit 模块，并且攻击者需要对共享目录有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44142 是 Samba vfs_fruit 模块中的一个堆溢出漏洞。该模块用于提供与 Apple SMB 客户端的兼容性。攻击者通过精心构造的扩展文件属性，可以进行越界堆读写，最终导致远程代码执行。POC 代码通过 SMB 协议连接到目标 Samba 服务器，并尝试利用该漏洞泄露堆 cookie 和链表指针，以此验证漏洞的存在。由于 Western Digital 的定制补丁会禁用某些 VFS 模块，因此 POC 代码伪装成来自 OSX 的连接。 该 POC 仓库包含 LICENSE, README.md, apple.py, check_vulnerable.py 文件。从代码分析来看，没有明显的投毒迹象，例如执行恶意命令或上传恶意文件。check_vulnerable.py 的功能是检查目标是否存在漏洞，apple.py 包含与 AppleDouble 结构相关的定义，用于构造特定的数据包。 整体代码功能较为清晰，主要是为了验证漏洞是否存在，不存在额外的后门代码。投毒风险极低。

**项目地址:** [horizon3ai/CVE-2021-44142](https://github.com/horizon3ai/CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #4

**来源**: [CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md](../2021/CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要启用vfs_fruit模块，且攻击者需要对共享目录具有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142是Samba vfs_fruit模块中的一个堆溢出漏洞。该模块用于提供与Apple SMB客户端的增强兼容性和与Netatalk 3 AFP文件服务器的互操作性。

**有效性：**
提供的PoC代码看起来是有效的。它包含一个用于检查Samba服务器是否存在CVE-2021-44142漏洞的Python脚本（check_vulnerable.py），以及辅助文件（apple.py，LICENSE，README.md）。脚本通过SMB协议连接到目标服务器，并利用漏洞读取堆cookie和链表指针。脚本明确说明了如果服务器配置了Western Digital定制的Samba补丁，则需要模拟来自OSX的连接。

**投毒风险：**
代码本身看起来比较简单，主要功能是验证漏洞的存在，而不是执行恶意操作。检查了LICENSE(MIT协议)和README.md，未发现明显恶意代码的迹象。但仍存在小概率(10%)的投毒风险，例如：
*   代码可能存在细微的错误，导致目标系统崩溃或不稳定。
*   利用该漏洞进行进一步攻击可能需要结合其他恶意代码。
*   代码可能收集用户信息并上传到恶意服务器（尽管目前的代码未发现此行为）。

**利用方式：**
1.  **配置vfs_fruit模块：** Samba服务器必须配置并启用vfs_fruit模块。
2.  **写入扩展属性：** 攻击者需要对共享目录具有写入扩展属性（EA, xattr）的权限。
3.  **发送特制请求：** 攻击者通过SMB协议发送特制请求，写入恶意的扩展文件属性。这些恶意属性会触发vfs_fruit模块中的堆溢出漏洞。
4.  **远程代码执行：** 成功利用该漏洞后，攻击者可以smbd的权限（通常是root权限）执行任意代码。

**总结：**
此漏洞利用过程依赖于`vfs_fruit`模块，该模块在Samba服务器中处理与Apple文件共享相关的扩展属性。通过精心构造的扩展属性，攻击者可以触发堆溢出，从而控制服务器的执行流程。由于该漏洞允许以root权限执行任意代码，因此风险非常高。

**项目地址:** [hrsman/Samba-CVE-2021-44142](https://github.com/hrsman/Samba-CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---



---

## POC #3

**来源**: [CVE-2021-44142-horizon3ai_CVE-2021-44142.md](../2021/CVE-2021-44142-horizon3ai_CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit-堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，远程代码执行

**影响版本:** Samba versions prior to 4.13.17, 4.14.12 and 4.15.5

**利用条件:** 需要启用 vfs_fruit 模块，并且攻击者需要对共享目录有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44142 是 Samba vfs_fruit 模块中的一个堆溢出漏洞。该模块用于提供与 Apple SMB 客户端的兼容性。攻击者通过精心构造的扩展文件属性，可以进行越界堆读写，最终导致远程代码执行。POC 代码通过 SMB 协议连接到目标 Samba 服务器，并尝试利用该漏洞泄露堆 cookie 和链表指针，以此验证漏洞的存在。由于 Western Digital 的定制补丁会禁用某些 VFS 模块，因此 POC 代码伪装成来自 OSX 的连接。 该 POC 仓库包含 LICENSE, README.md, apple.py, check_vulnerable.py 文件。从代码分析来看，没有明显的投毒迹象，例如执行恶意命令或上传恶意文件。check_vulnerable.py 的功能是检查目标是否存在漏洞，apple.py 包含与 AppleDouble 结构相关的定义，用于构造特定的数据包。 整体代码功能较为清晰，主要是为了验证漏洞是否存在，不存在额外的后门代码。投毒风险极低。

**项目地址:** [horizon3ai/CVE-2021-44142](https://github.com/horizon3ai/CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #4

**来源**: [CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md](../2021/CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要启用vfs_fruit模块，且攻击者需要对共享目录具有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142是Samba vfs_fruit模块中的一个堆溢出漏洞。该模块用于提供与Apple SMB客户端的增强兼容性和与Netatalk 3 AFP文件服务器的互操作性。

**有效性：**
提供的PoC代码看起来是有效的。它包含一个用于检查Samba服务器是否存在CVE-2021-44142漏洞的Python脚本（check_vulnerable.py），以及辅助文件（apple.py，LICENSE，README.md）。脚本通过SMB协议连接到目标服务器，并利用漏洞读取堆cookie和链表指针。脚本明确说明了如果服务器配置了Western Digital定制的Samba补丁，则需要模拟来自OSX的连接。

**投毒风险：**
代码本身看起来比较简单，主要功能是验证漏洞的存在，而不是执行恶意操作。检查了LICENSE(MIT协议)和README.md，未发现明显恶意代码的迹象。但仍存在小概率(10%)的投毒风险，例如：
*   代码可能存在细微的错误，导致目标系统崩溃或不稳定。
*   利用该漏洞进行进一步攻击可能需要结合其他恶意代码。
*   代码可能收集用户信息并上传到恶意服务器（尽管目前的代码未发现此行为）。

**利用方式：**
1.  **配置vfs_fruit模块：** Samba服务器必须配置并启用vfs_fruit模块。
2.  **写入扩展属性：** 攻击者需要对共享目录具有写入扩展属性（EA, xattr）的权限。
3.  **发送特制请求：** 攻击者通过SMB协议发送特制请求，写入恶意的扩展文件属性。这些恶意属性会触发vfs_fruit模块中的堆溢出漏洞。
4.  **远程代码执行：** 成功利用该漏洞后，攻击者可以smbd的权限（通常是root权限）执行任意代码。

**总结：**
此漏洞利用过程依赖于`vfs_fruit`模块，该模块在Samba服务器中处理与Apple文件共享相关的扩展属性。通过精心构造的扩展属性，攻击者可以触发堆溢出，从而控制服务器的执行流程。由于该漏洞允许以root权限执行任意代码，因此风险非常高。

**项目地址:** [hrsman/Samba-CVE-2021-44142](https://github.com/hrsman/Samba-CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---



---

## POC #3

**来源**: [CVE-2021-44142-horizon3ai_CVE-2021-44142.md](../2021/CVE-2021-44142-horizon3ai_CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit-堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，远程代码执行

**影响版本:** Samba versions prior to 4.13.17, 4.14.12 and 4.15.5

**利用条件:** 需要启用 vfs_fruit 模块，并且攻击者需要对共享目录有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44142 是 Samba vfs_fruit 模块中的一个堆溢出漏洞。该模块用于提供与 Apple SMB 客户端的兼容性。攻击者通过精心构造的扩展文件属性，可以进行越界堆读写，最终导致远程代码执行。POC 代码通过 SMB 协议连接到目标 Samba 服务器，并尝试利用该漏洞泄露堆 cookie 和链表指针，以此验证漏洞的存在。由于 Western Digital 的定制补丁会禁用某些 VFS 模块，因此 POC 代码伪装成来自 OSX 的连接。 该 POC 仓库包含 LICENSE, README.md, apple.py, check_vulnerable.py 文件。从代码分析来看，没有明显的投毒迹象，例如执行恶意命令或上传恶意文件。check_vulnerable.py 的功能是检查目标是否存在漏洞，apple.py 包含与 AppleDouble 结构相关的定义，用于构造特定的数据包。 整体代码功能较为清晰，主要是为了验证漏洞是否存在，不存在额外的后门代码。投毒风险极低。

**项目地址:** [horizon3ai/CVE-2021-44142](https://github.com/horizon3ai/CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

## POC #4

**来源**: [CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md](../2021/CVE-2021-44142-hrsman_Samba-CVE-2021-44142.md)

## CVE-2021-44142-Samba-vfs_fruit模块堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 4.13.17, < 4.14.12, < 4.15.5

**利用条件:** 需要启用vfs_fruit模块，且攻击者需要对共享目录具有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44142是Samba vfs_fruit模块中的一个堆溢出漏洞。该模块用于提供与Apple SMB客户端的增强兼容性和与Netatalk 3 AFP文件服务器的互操作性。

**有效性：**
提供的PoC代码看起来是有效的。它包含一个用于检查Samba服务器是否存在CVE-2021-44142漏洞的Python脚本（check_vulnerable.py），以及辅助文件（apple.py，LICENSE，README.md）。脚本通过SMB协议连接到目标服务器，并利用漏洞读取堆cookie和链表指针。脚本明确说明了如果服务器配置了Western Digital定制的Samba补丁，则需要模拟来自OSX的连接。

**投毒风险：**
代码本身看起来比较简单，主要功能是验证漏洞的存在，而不是执行恶意操作。检查了LICENSE(MIT协议)和README.md，未发现明显恶意代码的迹象。但仍存在小概率(10%)的投毒风险，例如：
*   代码可能存在细微的错误，导致目标系统崩溃或不稳定。
*   利用该漏洞进行进一步攻击可能需要结合其他恶意代码。
*   代码可能收集用户信息并上传到恶意服务器（尽管目前的代码未发现此行为）。

**利用方式：**
1.  **配置vfs_fruit模块：** Samba服务器必须配置并启用vfs_fruit模块。
2.  **写入扩展属性：** 攻击者需要对共享目录具有写入扩展属性（EA, xattr）的权限。
3.  **发送特制请求：** 攻击者通过SMB协议发送特制请求，写入恶意的扩展文件属性。这些恶意属性会触发vfs_fruit模块中的堆溢出漏洞。
4.  **远程代码执行：** 成功利用该漏洞后，攻击者可以smbd的权限（通常是root权限）执行任意代码。

**总结：**
此漏洞利用过程依赖于`vfs_fruit`模块，该模块在Samba服务器中处理与Apple文件共享相关的扩展属性。通过精心构造的扩展属性，攻击者可以触发堆溢出，从而控制服务器的执行流程。由于该漏洞允许以root权限执行任意代码，因此风险非常高。

**项目地址:** [hrsman/Samba-CVE-2021-44142](https://github.com/hrsman/Samba-CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)

---

