# CVE-2021-33026

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-33026-Agilevatester_FlaskCache_CVE-2021-33026_POC.md](../2021/CVE-2021-33026-Agilevatester_FlaskCache_CVE-2021-33026_POC.md)

# CVE-2021-33026

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-33026-Agilevatester_FlaskCache_CVE-2021-33026_POC.md](../2021/CVE-2021-33026-Agilevatester_FlaskCache_CVE-2021-33026_POC.md)

# CVE-2021-33026

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-33026-Agilevatester_FlaskCache_CVE-2021-33026_POC.md](../2021/CVE-2021-33026-Agilevatester_FlaskCache_CVE-2021-33026_POC.md)

# CVE-2021-33026

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-33026-Agilevatester_FlaskCache_CVE-2021-33026_POC.md](../2021/CVE-2021-33026-Agilevatester_FlaskCache_CVE-2021-33026_POC.md)

# CVE-2021-33026

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-33026-Agilevatester_FlaskCache_CVE-2021-33026_POC.md](../2021/CVE-2021-33026-Agilevatester_FlaskCache_CVE-2021-33026_POC.md)

# CVE-2021-33026

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-33026-Agilevatester_FlaskCache_CVE-2021-33026_POC.md](../2021/CVE-2021-33026-Agilevatester_FlaskCache_CVE-2021-33026_POC.md)

# CVE-2021-33026

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-33026-Agilevatester_FlaskCache_CVE-2021-33026_POC.md](../2021/CVE-2021-33026-Agilevatester_FlaskCache_CVE-2021-33026_POC.md)

## CVE-2021-33026 Flask-Caching Pickle 反序列化 RCE

**漏洞编号:** CVE-2021-33026

**漏洞类型:** 反序列化漏洞

**影响应用:** Flask-Caching

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.10.1

**利用条件:** 需要能够访问缓存服务器（Redis/Memcached），例如Redis无密码访问或者存在弱密码。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-33026 存在于 Flask-Caching 扩展中，由于其使用 Pickle 序列化数据，攻击者如果能够控制缓存服务器（如 Redis 或 Memcached），就可以通过注入恶意 Pickle 对象，在 Flask 应用服务器上执行任意代码。

**有效性分析：**
提供的 PoC 代码 `cve-2021-33026_PoC.py` 针对此漏洞。 它首先序列化一个包含恶意命令的 Python 对象，然后将此对象写入缓存服务器。当 Flask 应用从缓存中读取此对象并进行反序列化时，恶意命令就会被执行。代码支持 Redis 和 Memcached 两种缓存类型。

**投毒风险分析：**
查看 `cve-2021-33026_PoC.py`，发现其主要功能是利用 Pickle 漏洞进行 RCE。代码逻辑相对清晰，旨在利用漏洞，而非引入其他恶意行为。虽然不能完全排除开发者存在隐藏后门的可能，但是基于代码本身，投毒的可能性极低。
`payload_requirements.txt` 明确列出了依赖包，可以作为审查的起点，但这些包本身都是常见的库，没有明显恶意。
综合考虑，投毒风险估计为 1%。

**利用方式：**
1.  **确定目标 Flask 应用使用的 Flask-Caching 版本低于或等于 1.10.1，并确定其使用的缓存类型（Redis 或 Memcached）。**
2.  **获取对缓存服务器的访问权限。** 这可能涉及利用 Redis 或 Memcached 的配置错误，例如 Redis 无密码访问或 Memcached 未配置身份验证。
3.  **使用 PoC 代码 `cve-2021-33026_PoC.py` 生成包含恶意命令的 Pickle 序列化对象。**
4.  **将生成的 Pickle 对象写入缓存服务器。**  PoC 代码会自动完成此步骤，通过`redis.Redis`或`pymemcache.client.base.Client`连接到目标缓存服务器并写入恶意的键值对。
5.  **触发 Flask 应用从缓存中读取被篡改的数据。**  PoC 代码通过访问 `/cache/<c_id>` 触发，其中 `<c_id>` 是被投毒的缓存键的ID。这会导致 Flask 应用反序列化恶意对象，从而执行攻击者指定的命令。

总结：利用方式依赖于能够访问缓存服务器，并且 Flask 应用使用了易受攻击的 Flask-Caching 版本。  利用流程比较直接，就是将恶意序列化的payload 写入缓存，然后强制触发 Flask 应用读取缓存。


**项目地址:** [Agilevatester/FlaskCache_CVE-2021-33026_POC](https://github.com/Agilevatester/FlaskCache_CVE-2021-33026_POC)

**漏洞详情:** [CVE-2021-33026](https://nvd.nist.gov/vuln/detail/CVE-2021-33026)

---

## POC #2

**来源**: [CVE-2021-33026-CarlosG13_CVE-2021-33026.md](../2021/CVE-2021-33026-CarlosG13_CVE-2021-33026.md)

## CVE-2021-33026 - Flask-Caching Pickle 反序列化导致远程代码执行

**漏洞编号:** CVE-2021-33026

**漏洞类型:** 反序列化漏洞

**影响应用:** Flask-Caching

**危害等级:** 高危，可能导致远程代码执行或本地提权

**影响版本:** <= 1.10.1

**利用条件:** 需要能够访问缓存存储（例如，文件系统，Memcached，Redis等），或者利用应用自身的功能将恶意数据写入缓存。PoC需要目标flask应用的session cookie，表明需要session存储在memcached中

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-33026 漏洞存在于 Flask-Caching 扩展中，版本 1.10.1 及更早版本。该漏洞是由于 Flask-Caching 依赖 Pickle 进行序列化，如果攻击者能够访问缓存存储（例如 Memcached），则可以构造恶意 payload，毒化缓存，并在服务器端执行任意 Python 代码。根据漏洞描述，利用的前提是攻击者能够写入缓存。PoC 代码利用 `pymemcache` 库连接到 Memcached 服务，并将恶意序列化 payload (包含执行任意命令的 `rce_payload` 类) 写入缓存。触发漏洞的方式是，当 Flask 应用从缓存中读取该恶意数据并进行反序列化时，`__reduce__` 方法会被调用，从而执行预设的命令。PoC 中通过发送包含特定 Session Cookie 的 HTTP 请求来触发反序列化过程。虽然漏洞描述中提到“第三方表示，除非机器已经被攻破，否则利用的可能性极小；在其他情况下，攻击者将无法将 payload 写入缓存并生成所需的冲突”，但是如果缓存服务配置不当，或者应用自身存在将用户输入写入缓存的功能，则攻击者可以利用此漏洞。检查 PoC 代码，未发现明显的投毒代码，但仍然需要仔细审计代码的安全性。可能性极小并不代表不存在。PoC 代码中的确有通过wget 下载文件的操作，如果攻击者能够控制目标执行wget从恶意地址下载文件，则的确存在风险。

利用方式总结：
1.  攻击者需要确定目标 Flask 应用使用 Flask-Caching 扩展，并且缓存后端是可以访问的（例如，Memcached）。
2.  攻击者需要获得目标 Flask 应用的 Session Cookie。
3.  攻击者构造一个恶意的 Pickle payload，该 payload 包含执行任意命令的代码。
4.  攻击者使用 Memcached 客户端（例如，`pymemcache`）将恶意 payload 写入缓存，key为Session Cookie。
5.  攻击者发送包含对应 Session Cookie 的 HTTP 请求到目标 Flask 应用，触发应用从缓存中读取恶意数据并进行反序列化。
6.  服务器端执行恶意 payload 中的命令，完成攻击。

关于投毒风险：
此仓库的投毒风险较低（约1%）。主要风险点在于PoC中可以执行任意命令，所以务必确保执行wget下载的文件来源可信。

**项目地址:** [CarlosG13/CVE-2021-33026](https://github.com/CarlosG13/CVE-2021-33026)

**漏洞详情:** [CVE-2021-33026](https://nvd.nist.gov/vuln/detail/CVE-2021-33026)

---



---

## POC #2

**来源**: [CVE-2021-33026-CarlosG13_CVE-2021-33026.md](../2021/CVE-2021-33026-CarlosG13_CVE-2021-33026.md)

## CVE-2021-33026 - Flask-Caching Pickle 反序列化导致远程代码执行

**漏洞编号:** CVE-2021-33026

**漏洞类型:** 反序列化漏洞

**影响应用:** Flask-Caching

**危害等级:** 高危，可能导致远程代码执行或本地提权

**影响版本:** <= 1.10.1

**利用条件:** 需要能够访问缓存存储（例如，文件系统，Memcached，Redis等），或者利用应用自身的功能将恶意数据写入缓存。PoC需要目标flask应用的session cookie，表明需要session存储在memcached中

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-33026 漏洞存在于 Flask-Caching 扩展中，版本 1.10.1 及更早版本。该漏洞是由于 Flask-Caching 依赖 Pickle 进行序列化，如果攻击者能够访问缓存存储（例如 Memcached），则可以构造恶意 payload，毒化缓存，并在服务器端执行任意 Python 代码。根据漏洞描述，利用的前提是攻击者能够写入缓存。PoC 代码利用 `pymemcache` 库连接到 Memcached 服务，并将恶意序列化 payload (包含执行任意命令的 `rce_payload` 类) 写入缓存。触发漏洞的方式是，当 Flask 应用从缓存中读取该恶意数据并进行反序列化时，`__reduce__` 方法会被调用，从而执行预设的命令。PoC 中通过发送包含特定 Session Cookie 的 HTTP 请求来触发反序列化过程。虽然漏洞描述中提到“第三方表示，除非机器已经被攻破，否则利用的可能性极小；在其他情况下，攻击者将无法将 payload 写入缓存并生成所需的冲突”，但是如果缓存服务配置不当，或者应用自身存在将用户输入写入缓存的功能，则攻击者可以利用此漏洞。检查 PoC 代码，未发现明显的投毒代码，但仍然需要仔细审计代码的安全性。可能性极小并不代表不存在。PoC 代码中的确有通过wget 下载文件的操作，如果攻击者能够控制目标执行wget从恶意地址下载文件，则的确存在风险。

利用方式总结：
1.  攻击者需要确定目标 Flask 应用使用 Flask-Caching 扩展，并且缓存后端是可以访问的（例如，Memcached）。
2.  攻击者需要获得目标 Flask 应用的 Session Cookie。
3.  攻击者构造一个恶意的 Pickle payload，该 payload 包含执行任意命令的代码。
4.  攻击者使用 Memcached 客户端（例如，`pymemcache`）将恶意 payload 写入缓存，key为Session Cookie。
5.  攻击者发送包含对应 Session Cookie 的 HTTP 请求到目标 Flask 应用，触发应用从缓存中读取恶意数据并进行反序列化。
6.  服务器端执行恶意 payload 中的命令，完成攻击。

关于投毒风险：
此仓库的投毒风险较低（约1%）。主要风险点在于PoC中可以执行任意命令，所以务必确保执行wget下载的文件来源可信。

**项目地址:** [CarlosG13/CVE-2021-33026](https://github.com/CarlosG13/CVE-2021-33026)

**漏洞详情:** [CVE-2021-33026](https://nvd.nist.gov/vuln/detail/CVE-2021-33026)

---



---

## POC #2

**来源**: [CVE-2021-33026-CarlosG13_CVE-2021-33026.md](../2021/CVE-2021-33026-CarlosG13_CVE-2021-33026.md)

## CVE-2021-33026 - Flask-Caching Pickle 反序列化导致远程代码执行

**漏洞编号:** CVE-2021-33026

**漏洞类型:** 反序列化漏洞

**影响应用:** Flask-Caching

**危害等级:** 高危，可能导致远程代码执行或本地提权

**影响版本:** <= 1.10.1

**利用条件:** 需要能够访问缓存存储（例如，文件系统，Memcached，Redis等），或者利用应用自身的功能将恶意数据写入缓存。PoC需要目标flask应用的session cookie，表明需要session存储在memcached中

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-33026 漏洞存在于 Flask-Caching 扩展中，版本 1.10.1 及更早版本。该漏洞是由于 Flask-Caching 依赖 Pickle 进行序列化，如果攻击者能够访问缓存存储（例如 Memcached），则可以构造恶意 payload，毒化缓存，并在服务器端执行任意 Python 代码。根据漏洞描述，利用的前提是攻击者能够写入缓存。PoC 代码利用 `pymemcache` 库连接到 Memcached 服务，并将恶意序列化 payload (包含执行任意命令的 `rce_payload` 类) 写入缓存。触发漏洞的方式是，当 Flask 应用从缓存中读取该恶意数据并进行反序列化时，`__reduce__` 方法会被调用，从而执行预设的命令。PoC 中通过发送包含特定 Session Cookie 的 HTTP 请求来触发反序列化过程。虽然漏洞描述中提到“第三方表示，除非机器已经被攻破，否则利用的可能性极小；在其他情况下，攻击者将无法将 payload 写入缓存并生成所需的冲突”，但是如果缓存服务配置不当，或者应用自身存在将用户输入写入缓存的功能，则攻击者可以利用此漏洞。检查 PoC 代码，未发现明显的投毒代码，但仍然需要仔细审计代码的安全性。可能性极小并不代表不存在。PoC 代码中的确有通过wget 下载文件的操作，如果攻击者能够控制目标执行wget从恶意地址下载文件，则的确存在风险。

利用方式总结：
1.  攻击者需要确定目标 Flask 应用使用 Flask-Caching 扩展，并且缓存后端是可以访问的（例如，Memcached）。
2.  攻击者需要获得目标 Flask 应用的 Session Cookie。
3.  攻击者构造一个恶意的 Pickle payload，该 payload 包含执行任意命令的代码。
4.  攻击者使用 Memcached 客户端（例如，`pymemcache`）将恶意 payload 写入缓存，key为Session Cookie。
5.  攻击者发送包含对应 Session Cookie 的 HTTP 请求到目标 Flask 应用，触发应用从缓存中读取恶意数据并进行反序列化。
6.  服务器端执行恶意 payload 中的命令，完成攻击。

关于投毒风险：
此仓库的投毒风险较低（约1%）。主要风险点在于PoC中可以执行任意命令，所以务必确保执行wget下载的文件来源可信。

**项目地址:** [CarlosG13/CVE-2021-33026](https://github.com/CarlosG13/CVE-2021-33026)

**漏洞详情:** [CVE-2021-33026](https://nvd.nist.gov/vuln/detail/CVE-2021-33026)

---



---

## POC #2

**来源**: [CVE-2021-33026-CarlosG13_CVE-2021-33026.md](../2021/CVE-2021-33026-CarlosG13_CVE-2021-33026.md)

## CVE-2021-33026 - Flask-Caching Pickle 反序列化导致远程代码执行

**漏洞编号:** CVE-2021-33026

**漏洞类型:** 反序列化漏洞

**影响应用:** Flask-Caching

**危害等级:** 高危，可能导致远程代码执行或本地提权

**影响版本:** <= 1.10.1

**利用条件:** 需要能够访问缓存存储（例如，文件系统，Memcached，Redis等），或者利用应用自身的功能将恶意数据写入缓存。PoC需要目标flask应用的session cookie，表明需要session存储在memcached中

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-33026 漏洞存在于 Flask-Caching 扩展中，版本 1.10.1 及更早版本。该漏洞是由于 Flask-Caching 依赖 Pickle 进行序列化，如果攻击者能够访问缓存存储（例如 Memcached），则可以构造恶意 payload，毒化缓存，并在服务器端执行任意 Python 代码。根据漏洞描述，利用的前提是攻击者能够写入缓存。PoC 代码利用 `pymemcache` 库连接到 Memcached 服务，并将恶意序列化 payload (包含执行任意命令的 `rce_payload` 类) 写入缓存。触发漏洞的方式是，当 Flask 应用从缓存中读取该恶意数据并进行反序列化时，`__reduce__` 方法会被调用，从而执行预设的命令。PoC 中通过发送包含特定 Session Cookie 的 HTTP 请求来触发反序列化过程。虽然漏洞描述中提到“第三方表示，除非机器已经被攻破，否则利用的可能性极小；在其他情况下，攻击者将无法将 payload 写入缓存并生成所需的冲突”，但是如果缓存服务配置不当，或者应用自身存在将用户输入写入缓存的功能，则攻击者可以利用此漏洞。检查 PoC 代码，未发现明显的投毒代码，但仍然需要仔细审计代码的安全性。可能性极小并不代表不存在。PoC 代码中的确有通过wget 下载文件的操作，如果攻击者能够控制目标执行wget从恶意地址下载文件，则的确存在风险。

利用方式总结：
1.  攻击者需要确定目标 Flask 应用使用 Flask-Caching 扩展，并且缓存后端是可以访问的（例如，Memcached）。
2.  攻击者需要获得目标 Flask 应用的 Session Cookie。
3.  攻击者构造一个恶意的 Pickle payload，该 payload 包含执行任意命令的代码。
4.  攻击者使用 Memcached 客户端（例如，`pymemcache`）将恶意 payload 写入缓存，key为Session Cookie。
5.  攻击者发送包含对应 Session Cookie 的 HTTP 请求到目标 Flask 应用，触发应用从缓存中读取恶意数据并进行反序列化。
6.  服务器端执行恶意 payload 中的命令，完成攻击。

关于投毒风险：
此仓库的投毒风险较低（约1%）。主要风险点在于PoC中可以执行任意命令，所以务必确保执行wget下载的文件来源可信。

**项目地址:** [CarlosG13/CVE-2021-33026](https://github.com/CarlosG13/CVE-2021-33026)

**漏洞详情:** [CVE-2021-33026](https://nvd.nist.gov/vuln/detail/CVE-2021-33026)

---



---

## POC #2

**来源**: [CVE-2021-33026-CarlosG13_CVE-2021-33026.md](../2021/CVE-2021-33026-CarlosG13_CVE-2021-33026.md)

## CVE-2021-33026 - Flask-Caching Pickle 反序列化导致远程代码执行

**漏洞编号:** CVE-2021-33026

**漏洞类型:** 反序列化漏洞

**影响应用:** Flask-Caching

**危害等级:** 高危，可能导致远程代码执行或本地提权

**影响版本:** <= 1.10.1

**利用条件:** 需要能够访问缓存存储（例如，文件系统，Memcached，Redis等），或者利用应用自身的功能将恶意数据写入缓存。PoC需要目标flask应用的session cookie，表明需要session存储在memcached中

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-33026 漏洞存在于 Flask-Caching 扩展中，版本 1.10.1 及更早版本。该漏洞是由于 Flask-Caching 依赖 Pickle 进行序列化，如果攻击者能够访问缓存存储（例如 Memcached），则可以构造恶意 payload，毒化缓存，并在服务器端执行任意 Python 代码。根据漏洞描述，利用的前提是攻击者能够写入缓存。PoC 代码利用 `pymemcache` 库连接到 Memcached 服务，并将恶意序列化 payload (包含执行任意命令的 `rce_payload` 类) 写入缓存。触发漏洞的方式是，当 Flask 应用从缓存中读取该恶意数据并进行反序列化时，`__reduce__` 方法会被调用，从而执行预设的命令。PoC 中通过发送包含特定 Session Cookie 的 HTTP 请求来触发反序列化过程。虽然漏洞描述中提到“第三方表示，除非机器已经被攻破，否则利用的可能性极小；在其他情况下，攻击者将无法将 payload 写入缓存并生成所需的冲突”，但是如果缓存服务配置不当，或者应用自身存在将用户输入写入缓存的功能，则攻击者可以利用此漏洞。检查 PoC 代码，未发现明显的投毒代码，但仍然需要仔细审计代码的安全性。可能性极小并不代表不存在。PoC 代码中的确有通过wget 下载文件的操作，如果攻击者能够控制目标执行wget从恶意地址下载文件，则的确存在风险。

利用方式总结：
1.  攻击者需要确定目标 Flask 应用使用 Flask-Caching 扩展，并且缓存后端是可以访问的（例如，Memcached）。
2.  攻击者需要获得目标 Flask 应用的 Session Cookie。
3.  攻击者构造一个恶意的 Pickle payload，该 payload 包含执行任意命令的代码。
4.  攻击者使用 Memcached 客户端（例如，`pymemcache`）将恶意 payload 写入缓存，key为Session Cookie。
5.  攻击者发送包含对应 Session Cookie 的 HTTP 请求到目标 Flask 应用，触发应用从缓存中读取恶意数据并进行反序列化。
6.  服务器端执行恶意 payload 中的命令，完成攻击。

关于投毒风险：
此仓库的投毒风险较低（约1%）。主要风险点在于PoC中可以执行任意命令，所以务必确保执行wget下载的文件来源可信。

**项目地址:** [CarlosG13/CVE-2021-33026](https://github.com/CarlosG13/CVE-2021-33026)

**漏洞详情:** [CVE-2021-33026](https://nvd.nist.gov/vuln/detail/CVE-2021-33026)

---



---

## POC #2

**来源**: [CVE-2021-33026-CarlosG13_CVE-2021-33026.md](../2021/CVE-2021-33026-CarlosG13_CVE-2021-33026.md)

## CVE-2021-33026 - Flask-Caching Pickle 反序列化导致远程代码执行

**漏洞编号:** CVE-2021-33026

**漏洞类型:** 反序列化漏洞

**影响应用:** Flask-Caching

**危害等级:** 高危，可能导致远程代码执行或本地提权

**影响版本:** <= 1.10.1

**利用条件:** 需要能够访问缓存存储（例如，文件系统，Memcached，Redis等），或者利用应用自身的功能将恶意数据写入缓存。PoC需要目标flask应用的session cookie，表明需要session存储在memcached中

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-33026 漏洞存在于 Flask-Caching 扩展中，版本 1.10.1 及更早版本。该漏洞是由于 Flask-Caching 依赖 Pickle 进行序列化，如果攻击者能够访问缓存存储（例如 Memcached），则可以构造恶意 payload，毒化缓存，并在服务器端执行任意 Python 代码。根据漏洞描述，利用的前提是攻击者能够写入缓存。PoC 代码利用 `pymemcache` 库连接到 Memcached 服务，并将恶意序列化 payload (包含执行任意命令的 `rce_payload` 类) 写入缓存。触发漏洞的方式是，当 Flask 应用从缓存中读取该恶意数据并进行反序列化时，`__reduce__` 方法会被调用，从而执行预设的命令。PoC 中通过发送包含特定 Session Cookie 的 HTTP 请求来触发反序列化过程。虽然漏洞描述中提到“第三方表示，除非机器已经被攻破，否则利用的可能性极小；在其他情况下，攻击者将无法将 payload 写入缓存并生成所需的冲突”，但是如果缓存服务配置不当，或者应用自身存在将用户输入写入缓存的功能，则攻击者可以利用此漏洞。检查 PoC 代码，未发现明显的投毒代码，但仍然需要仔细审计代码的安全性。可能性极小并不代表不存在。PoC 代码中的确有通过wget 下载文件的操作，如果攻击者能够控制目标执行wget从恶意地址下载文件，则的确存在风险。

利用方式总结：
1.  攻击者需要确定目标 Flask 应用使用 Flask-Caching 扩展，并且缓存后端是可以访问的（例如，Memcached）。
2.  攻击者需要获得目标 Flask 应用的 Session Cookie。
3.  攻击者构造一个恶意的 Pickle payload，该 payload 包含执行任意命令的代码。
4.  攻击者使用 Memcached 客户端（例如，`pymemcache`）将恶意 payload 写入缓存，key为Session Cookie。
5.  攻击者发送包含对应 Session Cookie 的 HTTP 请求到目标 Flask 应用，触发应用从缓存中读取恶意数据并进行反序列化。
6.  服务器端执行恶意 payload 中的命令，完成攻击。

关于投毒风险：
此仓库的投毒风险较低（约1%）。主要风险点在于PoC中可以执行任意命令，所以务必确保执行wget下载的文件来源可信。

**项目地址:** [CarlosG13/CVE-2021-33026](https://github.com/CarlosG13/CVE-2021-33026)

**漏洞详情:** [CVE-2021-33026](https://nvd.nist.gov/vuln/detail/CVE-2021-33026)

---



---

## POC #2

**来源**: [CVE-2021-33026-CarlosG13_CVE-2021-33026.md](../2021/CVE-2021-33026-CarlosG13_CVE-2021-33026.md)

## CVE-2021-33026 - Flask-Caching Pickle 反序列化导致远程代码执行

**漏洞编号:** CVE-2021-33026

**漏洞类型:** 反序列化漏洞

**影响应用:** Flask-Caching

**危害等级:** 高危，可能导致远程代码执行或本地提权

**影响版本:** <= 1.10.1

**利用条件:** 需要能够访问缓存存储（例如，文件系统，Memcached，Redis等），或者利用应用自身的功能将恶意数据写入缓存。PoC需要目标flask应用的session cookie，表明需要session存储在memcached中

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-33026 漏洞存在于 Flask-Caching 扩展中，版本 1.10.1 及更早版本。该漏洞是由于 Flask-Caching 依赖 Pickle 进行序列化，如果攻击者能够访问缓存存储（例如 Memcached），则可以构造恶意 payload，毒化缓存，并在服务器端执行任意 Python 代码。根据漏洞描述，利用的前提是攻击者能够写入缓存。PoC 代码利用 `pymemcache` 库连接到 Memcached 服务，并将恶意序列化 payload (包含执行任意命令的 `rce_payload` 类) 写入缓存。触发漏洞的方式是，当 Flask 应用从缓存中读取该恶意数据并进行反序列化时，`__reduce__` 方法会被调用，从而执行预设的命令。PoC 中通过发送包含特定 Session Cookie 的 HTTP 请求来触发反序列化过程。虽然漏洞描述中提到“第三方表示，除非机器已经被攻破，否则利用的可能性极小；在其他情况下，攻击者将无法将 payload 写入缓存并生成所需的冲突”，但是如果缓存服务配置不当，或者应用自身存在将用户输入写入缓存的功能，则攻击者可以利用此漏洞。检查 PoC 代码，未发现明显的投毒代码，但仍然需要仔细审计代码的安全性。可能性极小并不代表不存在。PoC 代码中的确有通过wget 下载文件的操作，如果攻击者能够控制目标执行wget从恶意地址下载文件，则的确存在风险。

利用方式总结：
1.  攻击者需要确定目标 Flask 应用使用 Flask-Caching 扩展，并且缓存后端是可以访问的（例如，Memcached）。
2.  攻击者需要获得目标 Flask 应用的 Session Cookie。
3.  攻击者构造一个恶意的 Pickle payload，该 payload 包含执行任意命令的代码。
4.  攻击者使用 Memcached 客户端（例如，`pymemcache`）将恶意 payload 写入缓存，key为Session Cookie。
5.  攻击者发送包含对应 Session Cookie 的 HTTP 请求到目标 Flask 应用，触发应用从缓存中读取恶意数据并进行反序列化。
6.  服务器端执行恶意 payload 中的命令，完成攻击。

关于投毒风险：
此仓库的投毒风险较低（约1%）。主要风险点在于PoC中可以执行任意命令，所以务必确保执行wget下载的文件来源可信。

**项目地址:** [CarlosG13/CVE-2021-33026](https://github.com/CarlosG13/CVE-2021-33026)

**漏洞详情:** [CVE-2021-33026](https://nvd.nist.gov/vuln/detail/CVE-2021-33026)

---

