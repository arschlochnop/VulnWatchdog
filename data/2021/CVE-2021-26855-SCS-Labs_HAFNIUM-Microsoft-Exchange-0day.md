# CVE-2021-26855

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-26855-1342486672_Flangvik.md](../2021/CVE-2021-26855-1342486672_Flangvik.md)

## CVE-2021-26855 - Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括但不限于 Exchange Server 2013 CU21-CU23, 2016 CU8-CU19, 2019 CU1-CU8

**利用条件:** 需要目标 Exchange Server 存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是一个 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求，并作为服务器进行身份验证。通过结合其他漏洞（如 CVE-2021-26857, CVE-2021-26858, CVE-2021-27065），可以实现未经身份验证的远程代码执行。

**利用方式：**

1.  **SSRF (CVE-2021-26855)：** 利用该漏洞绕过身份验证，向 Exchange 后端发送恶意请求。
2.  **利用其他漏洞：** 通常需要与其他漏洞结合使用，如不安全的 deserialization 或任意文件写入等，以最终实现 RCE。
3.  **执行任意代码：** 在成功利用漏洞后，攻击者可以在 Exchange 服务器上执行任意代码，获取系统权限。

**POC 有效性：**

根据搜索结果和提供的 POC 代码描述，该 POC 旨在利用 CVE-2021-26855 实现半交互式 web shell 或 shellcode 执行，表明该漏洞利用的有效性较高。

**投毒风险：**

由于仅提供了 README.md 文件内容，无法完整分析整个代码仓库。但是，考虑到以下几点：

*   POC 代码复杂性：Exchange 漏洞利用通常涉及多个步骤，可能存在隐藏的恶意代码。
*   历史攻击事件：ProxyLogon 曾被大规模利用，攻击者可能利用公开的 POC 进行二次修改和攻击。
*   缺乏代码审查：在没有进行详细代码审查的情况下，无法完全排除投毒风险。
*   C# POC代码，可能存在加载恶意dll，执行恶意操作。
因此，初步判断存在一定的投毒风险，估计为 10%。使用该 POC 之前，务必进行详细的代码审查和安全评估。

**项目地址:** [1342486672/Flangvik](https://github.com/1342486672/Flangvik)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #2

**来源**: [CVE-2021-26855-Flangvik_SharpProxyLogon.md](../2021/CVE-2021-26855-Flangvik_SharpProxyLogon.md)

## CVE-2021-26855 Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，未经身份验证的攻击者可以远程执行任意代码

**影响版本:** Microsoft Exchange Server 2013, 2016, and 2019 的多个累积更新版本（具体版本参考漏洞库信息）

**利用条件:** 目标系统必须运行受影响的 Microsoft Exchange Server 版本，且攻击者能够通过网络访问 Exchange Server 的端口（通常是 443）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855（ProxyLogon）是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者利用此漏洞可以发送任意 HTTP 请求并伪装成 Exchange Server 本身进行身份验证。结合其他漏洞（例如CVE-2021-27065），可以实现远程代码执行。 

**有效性评估：**

提供的 C# POC 代码 `SharpProxyLogon` 利用了 ProxyLogon 漏洞链。根据 README.md 中的描述和示例，此 POC 允许攻击者绕过身份验证，并最终在目标 Exchange Server 上执行代码。 POC 提供了两种利用方式：一是通过 webshell 落地执行命令，二是通过 shellcode 注入到 `svchost.exe` 进程中。从示例输出结果来看，POC 能够成功获取目标系统的 SYSTEM 权限，表明该代码在未打补丁的系统上是有效的。

**投毒风险分析：**

代码仓库的主要文件是 `SharpProxyLogon.sln` 和 `SharpProxyLogon` 目录下的 C# 代码。根据 `README.md` 文件和代码结构来看，该 POC 主要用于利用 ProxyLogon 漏洞链进行 RCE，并没有明显的投毒迹象。虽然 `SharpProxyLogon` 使用了 `TikiTorch` 代码进行 shellcode 注入，但这是一种常见的技术，本身不构成投毒。但需要注意的是，任何来源不明的代码都存在潜在风险，攻击者可能修改或添加恶意代码。

**利用方式总结：**

1.  **SSRF (CVE-2021-26855):** 利用该漏洞，攻击者可以绕过身份验证，模拟 Exchange Server 的身份发送 HTTP 请求。
2.  **后端漏洞（例如 CVE-2021-27065）：** 结合其他漏洞，例如不安全的序列化或任意文件写入，攻击者可以执行任意代码。
3.  **Webshell 落地：** POC 可以将 webshell 写入到目标服务器的 Web 目录下，从而实现命令执行。
4.  **Shellcode 注入：** POC 还可以将 shellcode 注入到 `svchost.exe` 等进程中，执行更复杂的操作。

**搜索引擎结果分析：**

搜索结果证实了 CVE-2021-26855 的严重性和被广泛利用的情况。多个来源表明该漏洞是一个 SSRF 漏洞，允许未经验证的攻击者发送任意 HTTP 请求。该漏洞常与其他 Exchange Server 漏洞一起利用，形成 ProxyLogon 漏洞链，从而实现 RCE。

**项目地址:** [Flangvik/SharpProxyLogon](https://github.com/Flangvik/SharpProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #3

**来源**: [CVE-2021-26855-Immersive-Labs-Sec_ProxyLogon.md](../2021/CVE-2021-26855-Immersive-Labs-Sec_ProxyLogon.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全控制 Exchange 服务器

**影响版本:** 受影响版本包括 Exchange Server 2013, 2016, 和 2019 的多个累积更新版本（具体版本见漏洞库信息）

**利用条件:** 需要能够访问 Exchange 服务器的 Web 接口 (OWA/ECP)。利用链中需要与其他漏洞配合（如 CVE-2021-26857）。通常不需要身份验证即可发起攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，它是 ProxyLogon 攻击链的入口点。未经身份验证的远程攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成 Exchange 服务器。通过利用此 SSRF 漏洞，攻击者可以绕过身份验证，然后利用其他漏洞（如 CVE-2021-26857，一个不安全的反序列化漏洞）来执行任意代码。 

**有效性：**
根据搜索结果和漏洞利用代码描述，此漏洞的 POC 代码是有效的。多个来源（例如 UpGuard，NVD，Microsoft 官方博客，Tenable 等）都确认了该漏洞的存在和被积极利用的情况。提供的代码文件 `proxylogon.py` 似乎是实现了 ProxyLogon 攻击链的利用程序，可以链式利用 CVE-2021-26855 和 CVE-2021-26857 来执行代码。

**投毒风险：**
代码中存在一定的投毒风险，比例估计为10%。 风险点主要在于`proxylogon.py` 中使用`eval(Request["cmd"],"unsafe")` 执行用户传入的 `cmd` 参数，具有高风险。此方法允许服务器端执行任意代码，如果攻击者恶意构造 `cmd` 的内容，则可能导致服务器被完全控制。虽然作者可能出于方便利用的目的添加此功能，但也为恶意使用者打开了方便之门。另一个风险点在于，脚本中的powershell命令（通过`revPSScriptUrl`传入）可能包含恶意代码，下载和执行来自不受信任源的powershell脚本是危险的。然而，代码中提供了免责声明，声明其用于教育和研究目的，并且给出了Immersive Labs的链接以供安全环境中使用。

**利用方式：**
1.  **SSRF (CVE-2021-26855):** 利用 SSRF 漏洞绕过身份验证，使攻击者可以冒充 Exchange 服务器。
2.  **不安全的反序列化 (CVE-2021-26857):** 通过 SSRF 漏洞获得权限后，利用不安全的反序列化漏洞在 Exchange 服务器上执行任意代码。
3.  **Web Shell 部署:** 上传并部署 Web Shell，以便攻击者可以持续访问 Exchange 服务器并执行命令。POC 代码中的 `shell_payload` 变量定义了用于部署 Web shell 的 JScript 代码。
4.  **远程代码执行:** 使用Web Shell执行系统命令，例如执行powershell脚本。

**项目地址:** [Immersive-Labs-Sec/ProxyLogon](https://github.com/Immersive-Labs-Sec/ProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #4

**来源**: [CVE-2021-26855-Nick-Yin12_106362522.md](../2021/CVE-2021-26855-Nick-Yin12_106362522.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 受影响的版本包括 Microsoft Exchange Server 2013 Cumulative Update 21/22/23, 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19, 以及 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 需要目标服务器运行受影响的 Microsoft Exchange Server 版本，且攻击者能够访问 Exchange 服务器的网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个 SSRF（服务器端请求伪造）漏洞，它是 ProxyLogon 漏洞链中的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求，并伪装成 Exchange 服务器进行身份验证。结合其他漏洞（如 CVE-2021-27065），攻击者可以在未经身份验证的情况下远程执行代码，完全控制 Exchange 服务器。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞利用的有效性很高。 搜索引擎结果明确指出该漏洞被积极利用，并且存在公开可用的PoC。

**投毒风险：**
提供的漏洞利用代码`/tmp/48fee3cb76dd8f17cfc4f0c4e5929ece/README.md` 只是一个描述漏洞的信息文件，里面主要讲述了漏洞的发现和报告过程，以及对微软安全防护的看法。并没有发现任何直接的恶意代码或后门，但鉴于此类漏洞经常被打包成复杂的利用工具，并且利用过程可能涉及多个阶段和组件，因此不能完全排除投毒的可能。如果其他文件存在恶意代码，则可能被利用进行投毒。这里给出的10%的投毒风险是基于该漏洞本身的高危性和攻击者可能利用多种方式进行攻击的综合考量。

**利用方式：**
1.  利用 CVE-2021-26855 漏洞发送特制的 HTTP 请求，绕过身份验证。
2.  结合其他漏洞（如 CVE-2021-27065，一个任意文件写入漏洞），写入恶意 Web Shell 或其他可执行文件。
3.  通过 Web Shell 或其他方式执行任意代码，获得服务器控制权。

此漏洞也被称为 ProxyLogon，是多个 Exchange 漏洞利用链中的一个关键组件，常与其他漏洞结合使用。

**项目地址:** [Nick-Yin12/106362522](https://github.com/Nick-Yin12/106362522)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #5

**来源**: [CVE-2021-26855-RickGeex_ProxyLogon.md](../2021/CVE-2021-26855-RickGeex_ProxyLogon.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞 (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的攻击者在Exchange服务器上执行任意代码

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 22, 23; 2016 Cumulative Update 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19; 2019 Cumulative Update 1, 2, 3, 4, 5, 6, 7, 8

**利用条件:** 目标Exchange服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 攻击链的一部分。攻击者可以利用此漏洞绕过身份验证，发送任意 HTTP 请求，并最终以 SYSTEM 权限执行任意代码。

**利用方式：**

1.  **SSRF (CVE-2021-26855)：** 攻击者首先利用 SSRF 漏洞，通过构造特制的 HTTP 请求，绕过身份验证。
2.  **获取 LegacyDN：**  利用autodiscover.xml获取LegacyDN信息。
3.  **获取SID：** 使用/mapi/emsmdb端点获取Security ID (SID)。
4.  **添加邮箱权限：**  使用获取的 SID，攻击者可以模拟管理员用户，并向任意邮箱添加访问权限。
5.  **写入 Webshell：**  最终，攻击者可以通过写入 Webshell 等方式在服务器上执行任意代码，控制服务器。

**有效性评估：**

提供的 POC 代码 `ProxyLogon.py` 实现了 ProxyLogon 攻击链的前几个阶段，包括 FQDN 解析、LegacyDN 获取和 SID 获取。根据漏洞库信息和搜索结果，此漏洞已被广泛利用，POC 代码的有效性较高。

**投毒风险分析：**

该POC本身目的是复现漏洞利用，如果恶意修改payload内容，比如在stage3/4中通过执行命令添加恶意账户、安装后门，的确存在投毒的风险。目前看代码本身是为了漏洞复现，没有发现明显的恶意代码。但是不能排除被修改后进行传播的可能性，因此评估投毒风险为 5%。

**项目地址:** [RickGeex/ProxyLogon](https://github.com/RickGeex/ProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #6

**来源**: [CVE-2021-26855-SCS-Labs_HAFNIUM-Microsoft-Exchange-0day.md](../2021/CVE-2021-26855-SCS-Labs_HAFNIUM-Microsoft-Exchange-0day.md)

# CVE-2021-26855

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-26855-1342486672_Flangvik.md](../2021/CVE-2021-26855-1342486672_Flangvik.md)

## CVE-2021-26855 - Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括但不限于 Exchange Server 2013 CU21-CU23, 2016 CU8-CU19, 2019 CU1-CU8

**利用条件:** 需要目标 Exchange Server 存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是一个 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求，并作为服务器进行身份验证。通过结合其他漏洞（如 CVE-2021-26857, CVE-2021-26858, CVE-2021-27065），可以实现未经身份验证的远程代码执行。

**利用方式：**

1.  **SSRF (CVE-2021-26855)：** 利用该漏洞绕过身份验证，向 Exchange 后端发送恶意请求。
2.  **利用其他漏洞：** 通常需要与其他漏洞结合使用，如不安全的 deserialization 或任意文件写入等，以最终实现 RCE。
3.  **执行任意代码：** 在成功利用漏洞后，攻击者可以在 Exchange 服务器上执行任意代码，获取系统权限。

**POC 有效性：**

根据搜索结果和提供的 POC 代码描述，该 POC 旨在利用 CVE-2021-26855 实现半交互式 web shell 或 shellcode 执行，表明该漏洞利用的有效性较高。

**投毒风险：**

由于仅提供了 README.md 文件内容，无法完整分析整个代码仓库。但是，考虑到以下几点：

*   POC 代码复杂性：Exchange 漏洞利用通常涉及多个步骤，可能存在隐藏的恶意代码。
*   历史攻击事件：ProxyLogon 曾被大规模利用，攻击者可能利用公开的 POC 进行二次修改和攻击。
*   缺乏代码审查：在没有进行详细代码审查的情况下，无法完全排除投毒风险。
*   C# POC代码，可能存在加载恶意dll，执行恶意操作。
因此，初步判断存在一定的投毒风险，估计为 10%。使用该 POC 之前，务必进行详细的代码审查和安全评估。

**项目地址:** [1342486672/Flangvik](https://github.com/1342486672/Flangvik)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #2

**来源**: [CVE-2021-26855-Flangvik_SharpProxyLogon.md](../2021/CVE-2021-26855-Flangvik_SharpProxyLogon.md)

## CVE-2021-26855 Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，未经身份验证的攻击者可以远程执行任意代码

**影响版本:** Microsoft Exchange Server 2013, 2016, and 2019 的多个累积更新版本（具体版本参考漏洞库信息）

**利用条件:** 目标系统必须运行受影响的 Microsoft Exchange Server 版本，且攻击者能够通过网络访问 Exchange Server 的端口（通常是 443）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855（ProxyLogon）是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者利用此漏洞可以发送任意 HTTP 请求并伪装成 Exchange Server 本身进行身份验证。结合其他漏洞（例如CVE-2021-27065），可以实现远程代码执行。 

**有效性评估：**

提供的 C# POC 代码 `SharpProxyLogon` 利用了 ProxyLogon 漏洞链。根据 README.md 中的描述和示例，此 POC 允许攻击者绕过身份验证，并最终在目标 Exchange Server 上执行代码。 POC 提供了两种利用方式：一是通过 webshell 落地执行命令，二是通过 shellcode 注入到 `svchost.exe` 进程中。从示例输出结果来看，POC 能够成功获取目标系统的 SYSTEM 权限，表明该代码在未打补丁的系统上是有效的。

**投毒风险分析：**

代码仓库的主要文件是 `SharpProxyLogon.sln` 和 `SharpProxyLogon` 目录下的 C# 代码。根据 `README.md` 文件和代码结构来看，该 POC 主要用于利用 ProxyLogon 漏洞链进行 RCE，并没有明显的投毒迹象。虽然 `SharpProxyLogon` 使用了 `TikiTorch` 代码进行 shellcode 注入，但这是一种常见的技术，本身不构成投毒。但需要注意的是，任何来源不明的代码都存在潜在风险，攻击者可能修改或添加恶意代码。

**利用方式总结：**

1.  **SSRF (CVE-2021-26855):** 利用该漏洞，攻击者可以绕过身份验证，模拟 Exchange Server 的身份发送 HTTP 请求。
2.  **后端漏洞（例如 CVE-2021-27065）：** 结合其他漏洞，例如不安全的序列化或任意文件写入，攻击者可以执行任意代码。
3.  **Webshell 落地：** POC 可以将 webshell 写入到目标服务器的 Web 目录下，从而实现命令执行。
4.  **Shellcode 注入：** POC 还可以将 shellcode 注入到 `svchost.exe` 等进程中，执行更复杂的操作。

**搜索引擎结果分析：**

搜索结果证实了 CVE-2021-26855 的严重性和被广泛利用的情况。多个来源表明该漏洞是一个 SSRF 漏洞，允许未经验证的攻击者发送任意 HTTP 请求。该漏洞常与其他 Exchange Server 漏洞一起利用，形成 ProxyLogon 漏洞链，从而实现 RCE。

**项目地址:** [Flangvik/SharpProxyLogon](https://github.com/Flangvik/SharpProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #3

**来源**: [CVE-2021-26855-Immersive-Labs-Sec_ProxyLogon.md](../2021/CVE-2021-26855-Immersive-Labs-Sec_ProxyLogon.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全控制 Exchange 服务器

**影响版本:** 受影响版本包括 Exchange Server 2013, 2016, 和 2019 的多个累积更新版本（具体版本见漏洞库信息）

**利用条件:** 需要能够访问 Exchange 服务器的 Web 接口 (OWA/ECP)。利用链中需要与其他漏洞配合（如 CVE-2021-26857）。通常不需要身份验证即可发起攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，它是 ProxyLogon 攻击链的入口点。未经身份验证的远程攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成 Exchange 服务器。通过利用此 SSRF 漏洞，攻击者可以绕过身份验证，然后利用其他漏洞（如 CVE-2021-26857，一个不安全的反序列化漏洞）来执行任意代码。 

**有效性：**
根据搜索结果和漏洞利用代码描述，此漏洞的 POC 代码是有效的。多个来源（例如 UpGuard，NVD，Microsoft 官方博客，Tenable 等）都确认了该漏洞的存在和被积极利用的情况。提供的代码文件 `proxylogon.py` 似乎是实现了 ProxyLogon 攻击链的利用程序，可以链式利用 CVE-2021-26855 和 CVE-2021-26857 来执行代码。

**投毒风险：**
代码中存在一定的投毒风险，比例估计为10%。 风险点主要在于`proxylogon.py` 中使用`eval(Request["cmd"],"unsafe")` 执行用户传入的 `cmd` 参数，具有高风险。此方法允许服务器端执行任意代码，如果攻击者恶意构造 `cmd` 的内容，则可能导致服务器被完全控制。虽然作者可能出于方便利用的目的添加此功能，但也为恶意使用者打开了方便之门。另一个风险点在于，脚本中的powershell命令（通过`revPSScriptUrl`传入）可能包含恶意代码，下载和执行来自不受信任源的powershell脚本是危险的。然而，代码中提供了免责声明，声明其用于教育和研究目的，并且给出了Immersive Labs的链接以供安全环境中使用。

**利用方式：**
1.  **SSRF (CVE-2021-26855):** 利用 SSRF 漏洞绕过身份验证，使攻击者可以冒充 Exchange 服务器。
2.  **不安全的反序列化 (CVE-2021-26857):** 通过 SSRF 漏洞获得权限后，利用不安全的反序列化漏洞在 Exchange 服务器上执行任意代码。
3.  **Web Shell 部署:** 上传并部署 Web Shell，以便攻击者可以持续访问 Exchange 服务器并执行命令。POC 代码中的 `shell_payload` 变量定义了用于部署 Web shell 的 JScript 代码。
4.  **远程代码执行:** 使用Web Shell执行系统命令，例如执行powershell脚本。

**项目地址:** [Immersive-Labs-Sec/ProxyLogon](https://github.com/Immersive-Labs-Sec/ProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #4

**来源**: [CVE-2021-26855-Nick-Yin12_106362522.md](../2021/CVE-2021-26855-Nick-Yin12_106362522.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 受影响的版本包括 Microsoft Exchange Server 2013 Cumulative Update 21/22/23, 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19, 以及 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 需要目标服务器运行受影响的 Microsoft Exchange Server 版本，且攻击者能够访问 Exchange 服务器的网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个 SSRF（服务器端请求伪造）漏洞，它是 ProxyLogon 漏洞链中的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求，并伪装成 Exchange 服务器进行身份验证。结合其他漏洞（如 CVE-2021-27065），攻击者可以在未经身份验证的情况下远程执行代码，完全控制 Exchange 服务器。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞利用的有效性很高。 搜索引擎结果明确指出该漏洞被积极利用，并且存在公开可用的PoC。

**投毒风险：**
提供的漏洞利用代码`/tmp/48fee3cb76dd8f17cfc4f0c4e5929ece/README.md` 只是一个描述漏洞的信息文件，里面主要讲述了漏洞的发现和报告过程，以及对微软安全防护的看法。并没有发现任何直接的恶意代码或后门，但鉴于此类漏洞经常被打包成复杂的利用工具，并且利用过程可能涉及多个阶段和组件，因此不能完全排除投毒的可能。如果其他文件存在恶意代码，则可能被利用进行投毒。这里给出的10%的投毒风险是基于该漏洞本身的高危性和攻击者可能利用多种方式进行攻击的综合考量。

**利用方式：**
1.  利用 CVE-2021-26855 漏洞发送特制的 HTTP 请求，绕过身份验证。
2.  结合其他漏洞（如 CVE-2021-27065，一个任意文件写入漏洞），写入恶意 Web Shell 或其他可执行文件。
3.  通过 Web Shell 或其他方式执行任意代码，获得服务器控制权。

此漏洞也被称为 ProxyLogon，是多个 Exchange 漏洞利用链中的一个关键组件，常与其他漏洞结合使用。

**项目地址:** [Nick-Yin12/106362522](https://github.com/Nick-Yin12/106362522)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #5

**来源**: [CVE-2021-26855-RickGeex_ProxyLogon.md](../2021/CVE-2021-26855-RickGeex_ProxyLogon.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞 (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的攻击者在Exchange服务器上执行任意代码

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 22, 23; 2016 Cumulative Update 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19; 2019 Cumulative Update 1, 2, 3, 4, 5, 6, 7, 8

**利用条件:** 目标Exchange服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 攻击链的一部分。攻击者可以利用此漏洞绕过身份验证，发送任意 HTTP 请求，并最终以 SYSTEM 权限执行任意代码。

**利用方式：**

1.  **SSRF (CVE-2021-26855)：** 攻击者首先利用 SSRF 漏洞，通过构造特制的 HTTP 请求，绕过身份验证。
2.  **获取 LegacyDN：**  利用autodiscover.xml获取LegacyDN信息。
3.  **获取SID：** 使用/mapi/emsmdb端点获取Security ID (SID)。
4.  **添加邮箱权限：**  使用获取的 SID，攻击者可以模拟管理员用户，并向任意邮箱添加访问权限。
5.  **写入 Webshell：**  最终，攻击者可以通过写入 Webshell 等方式在服务器上执行任意代码，控制服务器。

**有效性评估：**

提供的 POC 代码 `ProxyLogon.py` 实现了 ProxyLogon 攻击链的前几个阶段，包括 FQDN 解析、LegacyDN 获取和 SID 获取。根据漏洞库信息和搜索结果，此漏洞已被广泛利用，POC 代码的有效性较高。

**投毒风险分析：**

该POC本身目的是复现漏洞利用，如果恶意修改payload内容，比如在stage3/4中通过执行命令添加恶意账户、安装后门，的确存在投毒的风险。目前看代码本身是为了漏洞复现，没有发现明显的恶意代码。但是不能排除被修改后进行传播的可能性，因此评估投毒风险为 5%。

**项目地址:** [RickGeex/ProxyLogon](https://github.com/RickGeex/ProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #6

**来源**: [CVE-2021-26855-SCS-Labs_HAFNIUM-Microsoft-Exchange-0day.md](../2021/CVE-2021-26855-SCS-Labs_HAFNIUM-Microsoft-Exchange-0day.md)

# CVE-2021-26855

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-26855-1342486672_Flangvik.md](../2021/CVE-2021-26855-1342486672_Flangvik.md)

## CVE-2021-26855 - Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括但不限于 Exchange Server 2013 CU21-CU23, 2016 CU8-CU19, 2019 CU1-CU8

**利用条件:** 需要目标 Exchange Server 存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是一个 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求，并作为服务器进行身份验证。通过结合其他漏洞（如 CVE-2021-26857, CVE-2021-26858, CVE-2021-27065），可以实现未经身份验证的远程代码执行。

**利用方式：**

1.  **SSRF (CVE-2021-26855)：** 利用该漏洞绕过身份验证，向 Exchange 后端发送恶意请求。
2.  **利用其他漏洞：** 通常需要与其他漏洞结合使用，如不安全的 deserialization 或任意文件写入等，以最终实现 RCE。
3.  **执行任意代码：** 在成功利用漏洞后，攻击者可以在 Exchange 服务器上执行任意代码，获取系统权限。

**POC 有效性：**

根据搜索结果和提供的 POC 代码描述，该 POC 旨在利用 CVE-2021-26855 实现半交互式 web shell 或 shellcode 执行，表明该漏洞利用的有效性较高。

**投毒风险：**

由于仅提供了 README.md 文件内容，无法完整分析整个代码仓库。但是，考虑到以下几点：

*   POC 代码复杂性：Exchange 漏洞利用通常涉及多个步骤，可能存在隐藏的恶意代码。
*   历史攻击事件：ProxyLogon 曾被大规模利用，攻击者可能利用公开的 POC 进行二次修改和攻击。
*   缺乏代码审查：在没有进行详细代码审查的情况下，无法完全排除投毒风险。
*   C# POC代码，可能存在加载恶意dll，执行恶意操作。
因此，初步判断存在一定的投毒风险，估计为 10%。使用该 POC 之前，务必进行详细的代码审查和安全评估。

**项目地址:** [1342486672/Flangvik](https://github.com/1342486672/Flangvik)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #2

**来源**: [CVE-2021-26855-Flangvik_SharpProxyLogon.md](../2021/CVE-2021-26855-Flangvik_SharpProxyLogon.md)

## CVE-2021-26855 Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，未经身份验证的攻击者可以远程执行任意代码

**影响版本:** Microsoft Exchange Server 2013, 2016, and 2019 的多个累积更新版本（具体版本参考漏洞库信息）

**利用条件:** 目标系统必须运行受影响的 Microsoft Exchange Server 版本，且攻击者能够通过网络访问 Exchange Server 的端口（通常是 443）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855（ProxyLogon）是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者利用此漏洞可以发送任意 HTTP 请求并伪装成 Exchange Server 本身进行身份验证。结合其他漏洞（例如CVE-2021-27065），可以实现远程代码执行。 

**有效性评估：**

提供的 C# POC 代码 `SharpProxyLogon` 利用了 ProxyLogon 漏洞链。根据 README.md 中的描述和示例，此 POC 允许攻击者绕过身份验证，并最终在目标 Exchange Server 上执行代码。 POC 提供了两种利用方式：一是通过 webshell 落地执行命令，二是通过 shellcode 注入到 `svchost.exe` 进程中。从示例输出结果来看，POC 能够成功获取目标系统的 SYSTEM 权限，表明该代码在未打补丁的系统上是有效的。

**投毒风险分析：**

代码仓库的主要文件是 `SharpProxyLogon.sln` 和 `SharpProxyLogon` 目录下的 C# 代码。根据 `README.md` 文件和代码结构来看，该 POC 主要用于利用 ProxyLogon 漏洞链进行 RCE，并没有明显的投毒迹象。虽然 `SharpProxyLogon` 使用了 `TikiTorch` 代码进行 shellcode 注入，但这是一种常见的技术，本身不构成投毒。但需要注意的是，任何来源不明的代码都存在潜在风险，攻击者可能修改或添加恶意代码。

**利用方式总结：**

1.  **SSRF (CVE-2021-26855):** 利用该漏洞，攻击者可以绕过身份验证，模拟 Exchange Server 的身份发送 HTTP 请求。
2.  **后端漏洞（例如 CVE-2021-27065）：** 结合其他漏洞，例如不安全的序列化或任意文件写入，攻击者可以执行任意代码。
3.  **Webshell 落地：** POC 可以将 webshell 写入到目标服务器的 Web 目录下，从而实现命令执行。
4.  **Shellcode 注入：** POC 还可以将 shellcode 注入到 `svchost.exe` 等进程中，执行更复杂的操作。

**搜索引擎结果分析：**

搜索结果证实了 CVE-2021-26855 的严重性和被广泛利用的情况。多个来源表明该漏洞是一个 SSRF 漏洞，允许未经验证的攻击者发送任意 HTTP 请求。该漏洞常与其他 Exchange Server 漏洞一起利用，形成 ProxyLogon 漏洞链，从而实现 RCE。

**项目地址:** [Flangvik/SharpProxyLogon](https://github.com/Flangvik/SharpProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #3

**来源**: [CVE-2021-26855-Immersive-Labs-Sec_ProxyLogon.md](../2021/CVE-2021-26855-Immersive-Labs-Sec_ProxyLogon.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全控制 Exchange 服务器

**影响版本:** 受影响版本包括 Exchange Server 2013, 2016, 和 2019 的多个累积更新版本（具体版本见漏洞库信息）

**利用条件:** 需要能够访问 Exchange 服务器的 Web 接口 (OWA/ECP)。利用链中需要与其他漏洞配合（如 CVE-2021-26857）。通常不需要身份验证即可发起攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，它是 ProxyLogon 攻击链的入口点。未经身份验证的远程攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成 Exchange 服务器。通过利用此 SSRF 漏洞，攻击者可以绕过身份验证，然后利用其他漏洞（如 CVE-2021-26857，一个不安全的反序列化漏洞）来执行任意代码。 

**有效性：**
根据搜索结果和漏洞利用代码描述，此漏洞的 POC 代码是有效的。多个来源（例如 UpGuard，NVD，Microsoft 官方博客，Tenable 等）都确认了该漏洞的存在和被积极利用的情况。提供的代码文件 `proxylogon.py` 似乎是实现了 ProxyLogon 攻击链的利用程序，可以链式利用 CVE-2021-26855 和 CVE-2021-26857 来执行代码。

**投毒风险：**
代码中存在一定的投毒风险，比例估计为10%。 风险点主要在于`proxylogon.py` 中使用`eval(Request["cmd"],"unsafe")` 执行用户传入的 `cmd` 参数，具有高风险。此方法允许服务器端执行任意代码，如果攻击者恶意构造 `cmd` 的内容，则可能导致服务器被完全控制。虽然作者可能出于方便利用的目的添加此功能，但也为恶意使用者打开了方便之门。另一个风险点在于，脚本中的powershell命令（通过`revPSScriptUrl`传入）可能包含恶意代码，下载和执行来自不受信任源的powershell脚本是危险的。然而，代码中提供了免责声明，声明其用于教育和研究目的，并且给出了Immersive Labs的链接以供安全环境中使用。

**利用方式：**
1.  **SSRF (CVE-2021-26855):** 利用 SSRF 漏洞绕过身份验证，使攻击者可以冒充 Exchange 服务器。
2.  **不安全的反序列化 (CVE-2021-26857):** 通过 SSRF 漏洞获得权限后，利用不安全的反序列化漏洞在 Exchange 服务器上执行任意代码。
3.  **Web Shell 部署:** 上传并部署 Web Shell，以便攻击者可以持续访问 Exchange 服务器并执行命令。POC 代码中的 `shell_payload` 变量定义了用于部署 Web shell 的 JScript 代码。
4.  **远程代码执行:** 使用Web Shell执行系统命令，例如执行powershell脚本。

**项目地址:** [Immersive-Labs-Sec/ProxyLogon](https://github.com/Immersive-Labs-Sec/ProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #4

**来源**: [CVE-2021-26855-Nick-Yin12_106362522.md](../2021/CVE-2021-26855-Nick-Yin12_106362522.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 受影响的版本包括 Microsoft Exchange Server 2013 Cumulative Update 21/22/23, 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19, 以及 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 需要目标服务器运行受影响的 Microsoft Exchange Server 版本，且攻击者能够访问 Exchange 服务器的网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个 SSRF（服务器端请求伪造）漏洞，它是 ProxyLogon 漏洞链中的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求，并伪装成 Exchange 服务器进行身份验证。结合其他漏洞（如 CVE-2021-27065），攻击者可以在未经身份验证的情况下远程执行代码，完全控制 Exchange 服务器。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞利用的有效性很高。 搜索引擎结果明确指出该漏洞被积极利用，并且存在公开可用的PoC。

**投毒风险：**
提供的漏洞利用代码`/tmp/48fee3cb76dd8f17cfc4f0c4e5929ece/README.md` 只是一个描述漏洞的信息文件，里面主要讲述了漏洞的发现和报告过程，以及对微软安全防护的看法。并没有发现任何直接的恶意代码或后门，但鉴于此类漏洞经常被打包成复杂的利用工具，并且利用过程可能涉及多个阶段和组件，因此不能完全排除投毒的可能。如果其他文件存在恶意代码，则可能被利用进行投毒。这里给出的10%的投毒风险是基于该漏洞本身的高危性和攻击者可能利用多种方式进行攻击的综合考量。

**利用方式：**
1.  利用 CVE-2021-26855 漏洞发送特制的 HTTP 请求，绕过身份验证。
2.  结合其他漏洞（如 CVE-2021-27065，一个任意文件写入漏洞），写入恶意 Web Shell 或其他可执行文件。
3.  通过 Web Shell 或其他方式执行任意代码，获得服务器控制权。

此漏洞也被称为 ProxyLogon，是多个 Exchange 漏洞利用链中的一个关键组件，常与其他漏洞结合使用。

**项目地址:** [Nick-Yin12/106362522](https://github.com/Nick-Yin12/106362522)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #5

**来源**: [CVE-2021-26855-RickGeex_ProxyLogon.md](../2021/CVE-2021-26855-RickGeex_ProxyLogon.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞 (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的攻击者在Exchange服务器上执行任意代码

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 22, 23; 2016 Cumulative Update 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19; 2019 Cumulative Update 1, 2, 3, 4, 5, 6, 7, 8

**利用条件:** 目标Exchange服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 攻击链的一部分。攻击者可以利用此漏洞绕过身份验证，发送任意 HTTP 请求，并最终以 SYSTEM 权限执行任意代码。

**利用方式：**

1.  **SSRF (CVE-2021-26855)：** 攻击者首先利用 SSRF 漏洞，通过构造特制的 HTTP 请求，绕过身份验证。
2.  **获取 LegacyDN：**  利用autodiscover.xml获取LegacyDN信息。
3.  **获取SID：** 使用/mapi/emsmdb端点获取Security ID (SID)。
4.  **添加邮箱权限：**  使用获取的 SID，攻击者可以模拟管理员用户，并向任意邮箱添加访问权限。
5.  **写入 Webshell：**  最终，攻击者可以通过写入 Webshell 等方式在服务器上执行任意代码，控制服务器。

**有效性评估：**

提供的 POC 代码 `ProxyLogon.py` 实现了 ProxyLogon 攻击链的前几个阶段，包括 FQDN 解析、LegacyDN 获取和 SID 获取。根据漏洞库信息和搜索结果，此漏洞已被广泛利用，POC 代码的有效性较高。

**投毒风险分析：**

该POC本身目的是复现漏洞利用，如果恶意修改payload内容，比如在stage3/4中通过执行命令添加恶意账户、安装后门，的确存在投毒的风险。目前看代码本身是为了漏洞复现，没有发现明显的恶意代码。但是不能排除被修改后进行传播的可能性，因此评估投毒风险为 5%。

**项目地址:** [RickGeex/ProxyLogon](https://github.com/RickGeex/ProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #6

**来源**: [CVE-2021-26855-SCS-Labs_HAFNIUM-Microsoft-Exchange-0day.md](../2021/CVE-2021-26855-SCS-Labs_HAFNIUM-Microsoft-Exchange-0day.md)

# CVE-2021-26855

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-26855-1342486672_Flangvik.md](../2021/CVE-2021-26855-1342486672_Flangvik.md)

## CVE-2021-26855 - Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括但不限于 Exchange Server 2013 CU21-CU23, 2016 CU8-CU19, 2019 CU1-CU8

**利用条件:** 需要目标 Exchange Server 存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是一个 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求，并作为服务器进行身份验证。通过结合其他漏洞（如 CVE-2021-26857, CVE-2021-26858, CVE-2021-27065），可以实现未经身份验证的远程代码执行。

**利用方式：**

1.  **SSRF (CVE-2021-26855)：** 利用该漏洞绕过身份验证，向 Exchange 后端发送恶意请求。
2.  **利用其他漏洞：** 通常需要与其他漏洞结合使用，如不安全的 deserialization 或任意文件写入等，以最终实现 RCE。
3.  **执行任意代码：** 在成功利用漏洞后，攻击者可以在 Exchange 服务器上执行任意代码，获取系统权限。

**POC 有效性：**

根据搜索结果和提供的 POC 代码描述，该 POC 旨在利用 CVE-2021-26855 实现半交互式 web shell 或 shellcode 执行，表明该漏洞利用的有效性较高。

**投毒风险：**

由于仅提供了 README.md 文件内容，无法完整分析整个代码仓库。但是，考虑到以下几点：

*   POC 代码复杂性：Exchange 漏洞利用通常涉及多个步骤，可能存在隐藏的恶意代码。
*   历史攻击事件：ProxyLogon 曾被大规模利用，攻击者可能利用公开的 POC 进行二次修改和攻击。
*   缺乏代码审查：在没有进行详细代码审查的情况下，无法完全排除投毒风险。
*   C# POC代码，可能存在加载恶意dll，执行恶意操作。
因此，初步判断存在一定的投毒风险，估计为 10%。使用该 POC 之前，务必进行详细的代码审查和安全评估。

**项目地址:** [1342486672/Flangvik](https://github.com/1342486672/Flangvik)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #2

**来源**: [CVE-2021-26855-Flangvik_SharpProxyLogon.md](../2021/CVE-2021-26855-Flangvik_SharpProxyLogon.md)

## CVE-2021-26855 Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，未经身份验证的攻击者可以远程执行任意代码

**影响版本:** Microsoft Exchange Server 2013, 2016, and 2019 的多个累积更新版本（具体版本参考漏洞库信息）

**利用条件:** 目标系统必须运行受影响的 Microsoft Exchange Server 版本，且攻击者能够通过网络访问 Exchange Server 的端口（通常是 443）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855（ProxyLogon）是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者利用此漏洞可以发送任意 HTTP 请求并伪装成 Exchange Server 本身进行身份验证。结合其他漏洞（例如CVE-2021-27065），可以实现远程代码执行。 

**有效性评估：**

提供的 C# POC 代码 `SharpProxyLogon` 利用了 ProxyLogon 漏洞链。根据 README.md 中的描述和示例，此 POC 允许攻击者绕过身份验证，并最终在目标 Exchange Server 上执行代码。 POC 提供了两种利用方式：一是通过 webshell 落地执行命令，二是通过 shellcode 注入到 `svchost.exe` 进程中。从示例输出结果来看，POC 能够成功获取目标系统的 SYSTEM 权限，表明该代码在未打补丁的系统上是有效的。

**投毒风险分析：**

代码仓库的主要文件是 `SharpProxyLogon.sln` 和 `SharpProxyLogon` 目录下的 C# 代码。根据 `README.md` 文件和代码结构来看，该 POC 主要用于利用 ProxyLogon 漏洞链进行 RCE，并没有明显的投毒迹象。虽然 `SharpProxyLogon` 使用了 `TikiTorch` 代码进行 shellcode 注入，但这是一种常见的技术，本身不构成投毒。但需要注意的是，任何来源不明的代码都存在潜在风险，攻击者可能修改或添加恶意代码。

**利用方式总结：**

1.  **SSRF (CVE-2021-26855):** 利用该漏洞，攻击者可以绕过身份验证，模拟 Exchange Server 的身份发送 HTTP 请求。
2.  **后端漏洞（例如 CVE-2021-27065）：** 结合其他漏洞，例如不安全的序列化或任意文件写入，攻击者可以执行任意代码。
3.  **Webshell 落地：** POC 可以将 webshell 写入到目标服务器的 Web 目录下，从而实现命令执行。
4.  **Shellcode 注入：** POC 还可以将 shellcode 注入到 `svchost.exe` 等进程中，执行更复杂的操作。

**搜索引擎结果分析：**

搜索结果证实了 CVE-2021-26855 的严重性和被广泛利用的情况。多个来源表明该漏洞是一个 SSRF 漏洞，允许未经验证的攻击者发送任意 HTTP 请求。该漏洞常与其他 Exchange Server 漏洞一起利用，形成 ProxyLogon 漏洞链，从而实现 RCE。

**项目地址:** [Flangvik/SharpProxyLogon](https://github.com/Flangvik/SharpProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #3

**来源**: [CVE-2021-26855-Immersive-Labs-Sec_ProxyLogon.md](../2021/CVE-2021-26855-Immersive-Labs-Sec_ProxyLogon.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全控制 Exchange 服务器

**影响版本:** 受影响版本包括 Exchange Server 2013, 2016, 和 2019 的多个累积更新版本（具体版本见漏洞库信息）

**利用条件:** 需要能够访问 Exchange 服务器的 Web 接口 (OWA/ECP)。利用链中需要与其他漏洞配合（如 CVE-2021-26857）。通常不需要身份验证即可发起攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，它是 ProxyLogon 攻击链的入口点。未经身份验证的远程攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成 Exchange 服务器。通过利用此 SSRF 漏洞，攻击者可以绕过身份验证，然后利用其他漏洞（如 CVE-2021-26857，一个不安全的反序列化漏洞）来执行任意代码。 

**有效性：**
根据搜索结果和漏洞利用代码描述，此漏洞的 POC 代码是有效的。多个来源（例如 UpGuard，NVD，Microsoft 官方博客，Tenable 等）都确认了该漏洞的存在和被积极利用的情况。提供的代码文件 `proxylogon.py` 似乎是实现了 ProxyLogon 攻击链的利用程序，可以链式利用 CVE-2021-26855 和 CVE-2021-26857 来执行代码。

**投毒风险：**
代码中存在一定的投毒风险，比例估计为10%。 风险点主要在于`proxylogon.py` 中使用`eval(Request["cmd"],"unsafe")` 执行用户传入的 `cmd` 参数，具有高风险。此方法允许服务器端执行任意代码，如果攻击者恶意构造 `cmd` 的内容，则可能导致服务器被完全控制。虽然作者可能出于方便利用的目的添加此功能，但也为恶意使用者打开了方便之门。另一个风险点在于，脚本中的powershell命令（通过`revPSScriptUrl`传入）可能包含恶意代码，下载和执行来自不受信任源的powershell脚本是危险的。然而，代码中提供了免责声明，声明其用于教育和研究目的，并且给出了Immersive Labs的链接以供安全环境中使用。

**利用方式：**
1.  **SSRF (CVE-2021-26855):** 利用 SSRF 漏洞绕过身份验证，使攻击者可以冒充 Exchange 服务器。
2.  **不安全的反序列化 (CVE-2021-26857):** 通过 SSRF 漏洞获得权限后，利用不安全的反序列化漏洞在 Exchange 服务器上执行任意代码。
3.  **Web Shell 部署:** 上传并部署 Web Shell，以便攻击者可以持续访问 Exchange 服务器并执行命令。POC 代码中的 `shell_payload` 变量定义了用于部署 Web shell 的 JScript 代码。
4.  **远程代码执行:** 使用Web Shell执行系统命令，例如执行powershell脚本。

**项目地址:** [Immersive-Labs-Sec/ProxyLogon](https://github.com/Immersive-Labs-Sec/ProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #4

**来源**: [CVE-2021-26855-Nick-Yin12_106362522.md](../2021/CVE-2021-26855-Nick-Yin12_106362522.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 受影响的版本包括 Microsoft Exchange Server 2013 Cumulative Update 21/22/23, 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19, 以及 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 需要目标服务器运行受影响的 Microsoft Exchange Server 版本，且攻击者能够访问 Exchange 服务器的网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个 SSRF（服务器端请求伪造）漏洞，它是 ProxyLogon 漏洞链中的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求，并伪装成 Exchange 服务器进行身份验证。结合其他漏洞（如 CVE-2021-27065），攻击者可以在未经身份验证的情况下远程执行代码，完全控制 Exchange 服务器。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞利用的有效性很高。 搜索引擎结果明确指出该漏洞被积极利用，并且存在公开可用的PoC。

**投毒风险：**
提供的漏洞利用代码`/tmp/48fee3cb76dd8f17cfc4f0c4e5929ece/README.md` 只是一个描述漏洞的信息文件，里面主要讲述了漏洞的发现和报告过程，以及对微软安全防护的看法。并没有发现任何直接的恶意代码或后门，但鉴于此类漏洞经常被打包成复杂的利用工具，并且利用过程可能涉及多个阶段和组件，因此不能完全排除投毒的可能。如果其他文件存在恶意代码，则可能被利用进行投毒。这里给出的10%的投毒风险是基于该漏洞本身的高危性和攻击者可能利用多种方式进行攻击的综合考量。

**利用方式：**
1.  利用 CVE-2021-26855 漏洞发送特制的 HTTP 请求，绕过身份验证。
2.  结合其他漏洞（如 CVE-2021-27065，一个任意文件写入漏洞），写入恶意 Web Shell 或其他可执行文件。
3.  通过 Web Shell 或其他方式执行任意代码，获得服务器控制权。

此漏洞也被称为 ProxyLogon，是多个 Exchange 漏洞利用链中的一个关键组件，常与其他漏洞结合使用。

**项目地址:** [Nick-Yin12/106362522](https://github.com/Nick-Yin12/106362522)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #5

**来源**: [CVE-2021-26855-RickGeex_ProxyLogon.md](../2021/CVE-2021-26855-RickGeex_ProxyLogon.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞 (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的攻击者在Exchange服务器上执行任意代码

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 22, 23; 2016 Cumulative Update 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19; 2019 Cumulative Update 1, 2, 3, 4, 5, 6, 7, 8

**利用条件:** 目标Exchange服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 攻击链的一部分。攻击者可以利用此漏洞绕过身份验证，发送任意 HTTP 请求，并最终以 SYSTEM 权限执行任意代码。

**利用方式：**

1.  **SSRF (CVE-2021-26855)：** 攻击者首先利用 SSRF 漏洞，通过构造特制的 HTTP 请求，绕过身份验证。
2.  **获取 LegacyDN：**  利用autodiscover.xml获取LegacyDN信息。
3.  **获取SID：** 使用/mapi/emsmdb端点获取Security ID (SID)。
4.  **添加邮箱权限：**  使用获取的 SID，攻击者可以模拟管理员用户，并向任意邮箱添加访问权限。
5.  **写入 Webshell：**  最终，攻击者可以通过写入 Webshell 等方式在服务器上执行任意代码，控制服务器。

**有效性评估：**

提供的 POC 代码 `ProxyLogon.py` 实现了 ProxyLogon 攻击链的前几个阶段，包括 FQDN 解析、LegacyDN 获取和 SID 获取。根据漏洞库信息和搜索结果，此漏洞已被广泛利用，POC 代码的有效性较高。

**投毒风险分析：**

该POC本身目的是复现漏洞利用，如果恶意修改payload内容，比如在stage3/4中通过执行命令添加恶意账户、安装后门，的确存在投毒的风险。目前看代码本身是为了漏洞复现，没有发现明显的恶意代码。但是不能排除被修改后进行传播的可能性，因此评估投毒风险为 5%。

**项目地址:** [RickGeex/ProxyLogon](https://github.com/RickGeex/ProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #6

**来源**: [CVE-2021-26855-SCS-Labs_HAFNIUM-Microsoft-Exchange-0day.md](../2021/CVE-2021-26855-SCS-Labs_HAFNIUM-Microsoft-Exchange-0day.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，可导致远程代码执行

**影响版本:** 受影响的版本包括 Microsoft Exchange Server 2013 Cumulative Update 21/22/23, 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19, 和 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 需要目标 Exchange Server 存在漏洞，攻击者通常需要能够访问 Exchange Server 的网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造（SSRF）漏洞。该漏洞允许未经身份验证的远程攻击者发送任意 HTTP 请求并以 Exchange 服务器的身份进行身份验证。该漏洞通常与其他漏洞（如 CVE-2021-26857, CVE-2021-26858, CVE-2021-27065）组合利用，形成完整的攻击链（ProxyLogon）。

**有效性：**
根据漏洞库信息、搜索引擎结果（特别是微软官方博客和第三方安全公司的分析）和提供的漏洞利用代码（描述了与其他漏洞的配合），可以判断该漏洞的POC代码是有效的。许多公开报告表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码主要是关于漏洞信息的收集整理，包括受影响版本、漏洞描述、时间线等。虽然不能完全排除投毒的可能，但从代码内容来看，直接包含恶意代码的可能性较低。风险主要在于：

1.  **信息误导：** 文档中的缓解措施、检测方法可能存在偏差，导致防御效果不佳。
2.  **利用链依赖：** 该漏洞通常需要与其他漏洞配合利用，整理的利用链信息可能不完整或者存在错误引导。
3.  **后期更新：** 该文档后期可能被恶意修改，加入恶意代码或者篡改关键信息。

因此，综合判断投毒风险为 10%。

**利用方式：**
1.  **SSRF 攻击：** 攻击者利用 CVE-2021-26855 发送恶意的 HTTP 请求到 Exchange 服务器。
2.  **身份验证绕过：** 通过 SSRF 漏洞，攻击者可以绕过 Exchange Server 的身份验证机制，冒充 Exchange 服务器本身。
3.  **漏洞链利用：** 结合其他漏洞 (如 CVE-2021-26857 统一消息服务中的不安全的反序列化漏洞，以及 CVE-2021-26858 和 CVE-2021-27065 身份验证后的任意文件写入漏洞) ，最终实现远程代码执行。
4.  **写入 Webshell：** 利用文件写入漏洞，攻击者可以将恶意的 Webshell 文件写入到 Exchange 服务器的 Web 目录下。
5.  **远程代码执行：** 攻击者通过访问 Webshell 执行任意代码，控制 Exchange 服务器。

总而言之，CVE-2021-26855 是 ProxyLogon 攻击链中的关键一步，攻击者利用该漏洞实现身份验证绕过，为后续的漏洞利用铺平道路。

**项目地址:** [SCS-Labs/HAFNIUM-Microsoft-Exchange-0day](https://github.com/SCS-Labs/HAFNIUM-Microsoft-Exchange-0day)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #7

**来源**: [CVE-2021-26855-ShyTangerine_cve-2021-26855.md](../2021/CVE-2021-26855-ShyTangerine_cve-2021-26855.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Exchange Server 2013、2016 和 2019 的多个累积更新版本，详见漏洞库信息

**利用条件:** 需要能够访问 Exchange Server 的 ECP 接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。未授权的攻击者可以利用此漏洞发送任意 HTTP 请求并进行身份验证，绕过身份验证，最终导致远程代码执行。

**利用方式：**

根据提供的漏洞利用代码，利用过程大致如下：

1.  **初始请求：** 向 `/ecp/x.png` 发送 GET 请求，尝试获取 `X-BEResource` Cookie。
2.  **获取 DN 值：** 通过向 `/ecp/x.png` 发送包含特定 XML 内容的 POST 请求，利用 Autodiscover 服务获取用户的 DN (Distinguished Name)。
3.  **Mapi/Emsmdb 连接：** 使用获取的 DN 值，向 `/ecp/x.png` 发送包含 `X-BEResource`、`X-Clientinfo` 等头的 POST 请求，尝试建立 MAPI over HTTP 连接。
4.  **获取 Session 和 msExchEcpCanary：** 通过向 `/ecp/x.png` 发送包含特定 XML 内容的 POST 请求，利用 Negotiate 协议获取 ASP.NET Session ID 和 `msExchEcpCanary` 值。`msExchEcpCanary` 是一个安全令牌，用于防止跨站请求伪造 (CSRF) 攻击。
5.  **获取 OAB ID：** 发送包含`msExchEcpCanary` 和 Session ID 到`/ecp/x.png`，获取OAB id，为下一步写入恶意代码作准备

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞确实存在且已被积极利用。该 POC 代码展示了漏洞利用的关键步骤，例如如何绕过身份验证、如何获取必要的凭据信息等。该漏洞利用的有效性较高。

**投毒风险：**

评估提供的 POC 代码，存在一定投毒风险，10%。 风险点主要在于：

*   **硬编码的 IP 地址和域名：** POC 代码中包含硬编码的 IP 地址 (例如 `10.255.200.20`, `192.168.170.134`) 和域名 (`EXCHANGE01.xihongdream.com`)。如果用户直接使用这些硬编码的值，可能会将攻击流量导向作者控制的服务器，从而暴露目标服务器的信息或被用于进一步的攻击。

*   **潜在的后门植入：** 虽然 POC 代码的主要目的是演示漏洞利用过程，但作者有可能在代码中插入后门，例如，在OAB操作中，写入恶意脚本到目标服务器，长期控制目标系统。

总的来说，该 POC 代码主要演示了 SSRF 的利用方式。用户在使用时应谨慎，务必修改代码中的硬编码值，避免潜在的投毒风险。

**项目地址:** [ShyTangerine/cve-2021-26855](https://github.com/ShyTangerine/cve-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #8

**来源**: [CVE-2021-26855-TheDudeD6_ExchangeSmash.md](../2021/CVE-2021-26855-TheDudeD6_ExchangeSmash.md)

## CVE-2021-26855-Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器可访问，且未安装相关安全更新。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，是 ProxyLogon 攻击链的一部分。未经身份验证的攻击者可以利用此漏洞发送任意 HTTP 请求并冒充管理员进行身份验证，最终造成远程代码执行。

**利用方式：**

1.  **SSRF（CVE-2021-26855）：** 攻击者首先利用 SSRF 漏洞绕过身份验证，获取合法的身份。
2.  **获取SID：** 使用合法的身份，获取用户的SID
3.  **伪造管理员 SID：** 通过篡改已泄露的用户SID，伪造管理员SID
4.  **ProxyLogon：** 使用伪造的管理员 SID 通过 ProxyLogon 攻击链，获得管理员权限。
5.  **写入webshell：** 利用管理员权限，在目标服务器上写入 webshell。
6.  **远程代码执行：** 通过访问 webshell 执行任意代码。

**投毒风险：**
查看提供的POC代码，发现其功能是利用漏洞，在正常情况下，不应存在恶意代码。但是，由于代码逻辑复杂，且依赖外部库（Impacket），存在作者在代码中植入恶意逻辑的可能性。另外，通过分析发现proxylogon.py中的shell_src变量可以自定义，如果被替换成恶意payload，则存在一定风险。

综合考虑，投毒风险评估为10%，主要风险在于代码的可信度以及shell_src变量的替换。

**项目地址:** [TheDudeD6/ExchangeSmash](https://github.com/TheDudeD6/ExchangeSmash)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #9

**来源**: [CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855.md](../2021/CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF to RCE (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** SSRF (Server-Side Request Forgery) -> RCE (Remote Code Execution)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器可以从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 存在于 Microsoft Exchange Server 中，是一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞。

**利用方式：**

1.  **SSRF：** 攻击者利用SSRF漏洞，通过构造恶意的 HTTP 请求，绕过身份验证。
2.  **获取 LegacyDN：** 利用 SSRF 漏洞，向 Exchange 服务器的 autodiscover 端点发送请求，获取目标用户的 LegacyDN。
3.  **MAPI 连接：** 使用获得的 LegacyDN 建立 MAPI 连接。
4.  **获取 SID：** 从 MAPI 响应中提取用户的 SID。
5.  **ProxyLogon：** 利用 SID 伪造身份，通过 proxyLogon.ecp 端点进行身份验证绕过。
6.  **写入 Webshell：** 成功绕过身份验证后，攻击者可以将恶意的 webshell 写入到 Exchange 服务器的 OWA 目录中。
7.  **远程代码执行：** 攻击者通过访问写入的 webshell，执行任意代码。

**有效性评估：**

提供的 POC 代码 `ExchangeSheller.py` 实现了上述利用流程，能够自动化利用 CVE-2021-26855 漏洞，因此是有效的。

**投毒风险分析：**

代码本身执行的是漏洞利用流程，主要功能为利用 SSRF 漏洞并最终写入 Webshell。但需要注意以下几点：

*   **代码来源：** 代码来自 GitHub，需要验证其作者的信誉和代码的完整性。
*   **Webshell 内容：** Webshell 的内容可控，攻击者可以修改 webshell 的内容，使其执行恶意操作，如植入后门、窃取数据等。
*   **隐藏指令：** 理论上，eval 函数中可以嵌入隐蔽的恶意代码，但这需要仔细分析 `ExchangeSheller.py` 文件，当前判断该风险较低。

**结论：**

该漏洞利用的有效性高。存在一定的投毒风险，主要体现在攻击者可能会修改webshell的内容，但总体来说代码的结构和逻辑清晰，投毒风险较低，估计在5%。务必在隔离环境下进行测试，并对生成的 webshell 进行安全审计。

**项目地址:** [ZephrFish/Exch-CVE-2021-26855](https://github.com/ZephrFish/Exch-CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #10

**来源**: [CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855_Priv.md](../2021/CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855_Priv.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的 Exchange 服务器上执行任意代码。

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21/22/23, 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19, 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 目标Exchange服务器存在漏洞且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 攻击链的一部分。未经身份验证的攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成管理员进行身份验证，然后结合其他漏洞（例如 CVE-2021-27065）来写入任意文件，最终实现远程代码执行。

**漏洞利用方式：**

1.  **SSRF (CVE-2021-26855):** 攻击者利用 SSRF 漏洞，通过构造特殊的 URL 和请求头，绕过身份验证，获取 Exchange 服务器的访问权限。
2.  **获取 LegacyDN：** 利用 Autodiscover 服务获取目标用户的 LegacyDN。
3.  **MAPI 连接：** 使用获取的 LegacyDN 建立 MAPI 连接。
4.  **ProxyLogon:** 通过构造 ProxyLogon 请求，伪装成管理员身份。
5.  **写入 Webshell (CVE-2021-27065，虽然POC未直接体现，但通常会结合使用):** 在成功通过身份验证后，利用漏洞在 Exchange 服务器的 OWA 目录下写入恶意的 Webshell 文件，该文件包含可以执行任意代码的 JScript 代码。
6.  **远程代码执行：** 攻击者通过访问 Webshell 文件，执行任意代码。

**有效性：**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞利用代码是有效的，因为它再现了 ProxyLogon 攻击链的关键步骤，包括 SSRF、权限提升和 webshell 写入 (webshell 内容在代码中已经存在)。搜索引擎结果中也表明 CVE-2021-26855 被积极利用。

**投毒风险：**

分析提供的 POC 代码，未发现明显的投毒代码。代码逻辑主要集中在利用 SSRF 漏洞进行身份验证绕过，并最终部署 webshell。虽然 webshell 本身是一种恶意代码，但这是漏洞利用的必要步骤，而非作者有意添加的恶意功能。因此，判定投毒风险为0%。

**项目地址:** [ZephrFish/Exch-CVE-2021-26855_Priv](https://github.com/ZephrFish/Exch-CVE-2021-26855_Priv)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #11

**来源**: [CVE-2021-26855-dwisiswant0_proxylogscan.md](../2021/CVE-2021-26855-dwisiswant0_proxylogscan.md)

## CVE-2021-26855 Microsoft Exchange Server SSRF 漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** Exchange 2013 Versions < 15.00.1497.012, Exchange 2016 CU18 < 15.01.2106.013, Exchange 2016 CU19 < 15.01.2176.009, Exchange 2019 CU7 < 15.02.0721.013, Exchange 2019 CU8 < 15.02.0792.010

**利用条件:** 需要能够访问存在漏洞的 Exchange Server 的网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而冒充管理员身份。该漏洞是 ProxyLogon 攻击链的一部分，与 CVE-2021-27065 (身份验证后任意文件写入漏洞) 结合使用，可以实现远程代码执行。

**漏洞利用方式：**

1.  攻击者利用 CVE-2021-26855，发送特制的 HTTP 请求到 Exchange Server，绕过身份验证并获得管理员权限。
2.  利用获得的管理员权限，攻击者可以进一步利用 CVE-2021-27065 将恶意代码写入服务器。
3.  执行写入的恶意代码，最终实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码 `proxylogscan` 是一个 Go 语言编写的工具，用于大规模扫描存在 CVE-2021-26855 漏洞的 Microsoft Exchange Server。它通过发送特定的 HTTP 请求来检测目标服务器是否存在漏洞。

**投毒风险分析：**

代码主要功能是扫描漏洞，用于检测目标是否存在漏洞。 考虑到工具的用途和代码的简洁性，投毒的可能性较低，但是需要对代码进行仔细的审查，特别是涉及网络请求的部分，以确保没有隐藏的恶意逻辑。 投毒的可能性较低，但是依然存在一定的风险。代码使用go get安装，存在一定的依赖风险,需要注意.


**项目地址:** [dwisiswant0/proxylogscan](https://github.com/dwisiswant0/proxylogscan)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #12

**来源**: [CVE-2021-26855-glen-pearson_ProxyLogon-CVE-2021-26855.md](../2021/CVE-2021-26855-glen-pearson_ProxyLogon-CVE-2021-26855.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞 (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，未经验证的远程攻击者可以利用此漏洞在受影响的系统上执行任意代码

**影响版本:** 受影响版本包括 Exchange Server 2013 Cumulative Update 22 和 23, Exchange Server 2016 Cumulative Update 12-19, Exchange Server 2019 Cumulative Update 1-8

**利用条件:** 目标系统存在未修补的 Exchange Server 实例，攻击者需要能够通过网络访问 Exchange 服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成 Exchange 服务器进行身份验证，为后续利用其他漏洞（例如 CVE-2021-26857）创造条件。漏洞利用链通常涉及以下步骤：

1.  **SSRF (CVE-2021-26855):** 利用 SSRF 漏洞绕过身份验证，获取 Exchange 服务器的权限。
2.  **不安全的反序列化:** 通过 SSRF 漏洞获取的权限，进一步利用不安全的反序列化漏洞（例如 CVE-2021-26854, CVE-2021-26857, CVE-2021-27065）执行任意代码。

提供的 PoC 代码是一个修改后的 ProxyLogon 漏洞利用脚本，它利用 CVE-2021-26855 绕过身份验证，然后在服务器上创建一个后门 Web shell。具体流程如下：

1.  **自动发现 (Autodiscover):** 使用 Autodiscover 协议获取 LegacyDN。
2.  **MAPI 连接:** 使用获取的 LegacyDN 建立 MAPI 连接，模拟管理员权限。
3.  **Web Shell 写入:**  将包含反向 shell 代码的 aspx Web shell 写入到服务器的 `Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\test11.aspx` 路径。
4.  **执行 Web Shell:** 攻击者可以通过访问该 Web shell 执行任意命令。该 Web shell 执行 Powershell 命令，建立一个反向 TCP 连接到攻击者的指定 IP 地址和端口。 

**有效性：** 该 PoC 代码有效，因为它实现了 ProxyLogon 漏洞利用，并成功创建反向 shell，证明了远程代码执行。

**投毒风险：** 存在一定的投毒风险。作者在原始PoC基础上修改了代码，增加了创建用户和反向shell的功能，该行为可能被攻击者利用，如果攻击者修改了反向shell中的IP地址和端口，则使用者在不知情的情况下连接到攻击者的服务器，所以存在投毒风险。 风险大约在10%。

**利用方式：** 攻击者首先利用 CVE-2021-26855 漏洞绕过身份验证，获取 Exchange 服务器的权限，然后通过写入 Web shell 执行任意代码。这个 Web shell 会连接到攻击者控制的服务器，从而允许攻击者完全控制受感染的 Exchange 服务器。

**项目地址:** [glen-pearson/ProxyLogon-CVE-2021-26855](https://github.com/glen-pearson/ProxyLogon-CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #13

**来源**: [CVE-2021-26855-hakivvi_proxylogon.md](../2021/CVE-2021-26855-hakivvi_proxylogon.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全控制受影响的Exchange服务器

**影响版本:** 受影响版本包括 Exchange Server 2013 Cumulative Update 21/22/23, Exchange Server 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19, Exchange Server 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 需要能够访问Exchange服务器的网络，并且服务器存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。结合其他漏洞（如CVE-2021-27065），未经身份验证的远程攻击者可以利用此漏洞发送任意 HTTP 请求并以管理员身份通过身份验证，最终实现远程代码执行。 

**利用方式：**

1.  **SSRF (CVE-2021-26855):** 攻击者首先利用 SSRF 漏洞伪造 HTTP 请求，绕过身份验证。
2.  **管理员权限获取:** 利用伪造的请求，攻击者可以获得 Exchange 服务器的管理员权限。
3.  **OAB虚拟目录操作:** 修改OAB (Offline Address Book)虚拟目录的ExternalUrl参数，将shell地址写入。
4.  **Shell 写入:** 通过修改的ExternalUrl，攻击者将一个 ASPX webshell 写入到 Exchange 服务器的 web 可访问目录（通常是`C:\inetpub\wwwroot\aspnet_client\`）。 
5.  **远程代码执行:** 攻击者可以通过访问 webshell 的 URL 并发送特定的请求参数来执行任意代码。

**代码分析与投毒风险评估：**

提供的POC代码 `proxylogon.py` 实现了上述的攻击流程。代码首先利用 SSRF 获取服务器的计算机名，然后利用 NTLM 认证绕过。之后，它利用获取的管理员权限，通过修改 OAB 虚拟目录来写入 webshell。最后，代码输出 webshell 的 URL，攻击者可以通过该 URL 执行任意命令。

**投毒风险分析:**  POC代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **后门植入:** 虽然主要的目的是利用漏洞进行RCE，恶意攻击者可能会在脚本中添加额外的后门代码，例如，在写入的 webshell 中添加额外的功能，以便在将来保持对服务器的访问。
*   **信息收集:**  攻击者可以修改脚本来收集目标服务器上的敏感信息，例如，用户名、密码哈希、以及其他配置信息。
*   **恶意传播:**  如果攻击者控制了多个 Exchange 服务器，他们可以修改脚本来自动传播恶意软件到其他服务器。
*   **依赖库风险：**POC依赖Impacket库，如果Impacket库本身被篡改或包含恶意代码，那么使用此POC也会受到影响。

尽管存在这些风险，但就提供的代码片段本身而言，没有明显的恶意代码。风险主要在于该漏洞本身带来的权限和潜在的恶意修改行为。POC中生成随机字符串的部分(gen())是为了避免文件名冲突，本身不是恶意行为。利用OABVirtualDirectory修改ExternalUrl以及ResetOABVirtualDirectory修改FilePathName的行为是为了webshell的写入，这是漏洞利用的一部分。

**总结:** 该漏洞利用链的有效性较高，因为 CVE-2021-26855 是 ProxyLogon 攻击链的关键组成部分，被广泛利用。 投毒风险主要来自于利用此漏洞成功入侵后的恶意行为，而非POC代码本身。由于代码中包含webshell的部署，存在一定风险，但直接判定为投毒不严谨，结合分析结果，投毒风险预估为10%。

**项目地址:** [hakivvi/proxylogon](https://github.com/hakivvi/proxylogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #14

**来源**: [CVE-2021-26855-hictf_CVE-2021-26855-CVE-2021-27065.md](../2021/CVE-2021-26855-hictf_CVE-2021-26855-CVE-2021-27065.md)

## CVE-2021-26855 Microsoft Exchange Server SSRF 远程代码执行漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** SSRF (服务器端请求伪造) -> 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器对外开放，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个 SSRF 漏洞。根据搜索结果，攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成 Exchange 服务器进行身份验证。该漏洞是 ProxyLogon 攻击链中的一部分，攻击者利用该漏洞可以绕过身份验证，并结合其他漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者利用 CVE-2021-26855 漏洞发送恶意构造的 HTTP 请求到 Exchange 服务器。
2.  通过 SSRF 漏洞，攻击者可以伪装成 Exchange 服务器进行身份验证，绕过身份验证机制。
3.  绕过身份验证后，攻击者可以利用其他漏洞（例如 CVE-2021-27065，反序列化漏洞）在 Exchange 服务器上执行任意代码。

**POC有效性分析：**

提供的 POC 代码包含一个简单的 PHP 文件（hello world），一个 README 文件，一个简单的 Node.js 服务器 (demo.js) 和一个 package.json 文件。这些代码片段本身并不能直接利用 CVE-2021-26855。它们更像是用于搭建一个基础的web服务器环境，可能用于验证漏洞利用的某些步骤或作为最终执行的payload的一部分。因此，单独来看，提供的POC代码**无效**，它只是利用整个漏洞链中的一小部分。

**投毒风险分析：**

提供的 POC 代码较为简单，没有明显的恶意代码。`demo.js` 只是一个简单的 HTTP 服务器，`1.php` 只是输出 "hello world"。但是，考虑到这是一个 Exchange 漏洞的 POC，攻击者可能会在更复杂的利用链中利用这些文件，例如将 `1.php` 作为 Webshell 上传到服务器，或者利用 `demo.js` 搭建一个用于接收反弹 shell 的服务器。 因此，存在一定的投毒风险，但风险主要在于利用方式的组合，而非代码本身存在后门。

**投毒风险评估：**

由于代码功能简单，直接投毒的可能性较低，但作为漏洞利用链的一部分，可能被用于执行恶意操作，因此投毒风险评定为 **20%**。

**项目地址:** [hictf/CVE-2021-26855-CVE-2021-27065](https://github.com/hictf/CVE-2021-26855-CVE-2021-27065)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #15

**来源**: [CVE-2021-26855-hosch3n_ProxyVulns.md](../2021/CVE-2021-26855-hosch3n_ProxyVulns.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，无需身份验证即可远程代码执行

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 22, 23; 2016 Cumulative Update 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19; 2019 Cumulative Update 1, 2, 3, 4, 5, 6, 7, 8

**利用条件:** Exchange Server对外开放443端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造（SSRF）漏洞，它允许未经身份验证的攻击者发送任意 HTTP 请求并伪装成 Exchange 服务器的管理员。此漏洞是 ProxyLogon 攻击链的入口点，后续可以配合其他漏洞实现远程代码执行。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用是有效的。搜索引擎结果中许多链接都表明 CVE-2021-26855 已被积极利用。漏洞利用代码 `26855.py` 实现了利用该漏洞的步骤，包括：

1.  **SSRF 探测：** 通过构造特殊的 `X-BEResource` 请求头，获取 Exchange 后端服务器的计算机名和域名。
2.  **LegacyDN 获取：** 利用 Autodiscover 服务，通过提供用户邮箱地址获取 LegacyDN。
3.  **SID 欺骗：** 伪造 MAPI 请求，通过 LegacyDN 获取用户的 SID。
4.  **ProxyLogon 利用：** 利用获取到的 SID，通过 `proxyLogon.ecp` 绕过身份验证。
5.  **Webshell 部署：** 写入 Webshell 到服务器。

**投毒风险分析：**
漏洞利用代码中存在较低的投毒风险 (大约 5%)。虽然代码的目的是利用漏洞，但攻击者可能在 `webshell_content` 中植入恶意代码，或者修改 `webshell_path` 将webshell写入到不常见的位置，使得后期的权限维持或者横向移动更加隐蔽。例如，如果`webshell_content`包含下载和执行其他恶意文件的指令，这就是一种投毒行为。 目前提供的webshell代码较为简单，判定投毒的概率较低。

**利用方式总结：**
1.  攻击者首先利用 SSRF 漏洞 (CVE-2021-26855) 绕过身份验证。
2.  攻击者通过构造恶意的 HTTP 请求，欺骗 Exchange 服务器，使其认为攻击者已通过身份验证。
3.  成功绕过身份验证后，攻击者可以使用其他漏洞（例如 CVE-2021-27065，写入任意文件）在 Exchange 服务器上执行任意代码，部署 Webshell。
4.  攻击者通过 Webshell 执行系统命令，控制 Exchange 服务器。

**项目地址:** [hosch3n/ProxyVulns](https://github.com/hosch3n/ProxyVulns)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #16

**来源**: [CVE-2021-26855-kh4sh3i_ProxyLogon.md](../2021/CVE-2021-26855-kh4sh3i_ProxyLogon.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF/RCE (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，未经验证的远程攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**影响版本:** 受影响版本包括Exchange Server 2013、2016和2019的多个累积更新。

**利用条件:** 需要目标Exchange服务器存在漏洞版本，且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，它是 ProxyLogon 漏洞链中的第一个环节。攻击者可以利用此漏洞发送任意 HTTP 请求并作为 Exchange 服务器进行身份验证。根据搜索结果，此漏洞与其他漏洞（如 CVE-2021-26857、CVE-2021-26858 和 CVE-2021-27065）结合使用，可以实现未经身份验证的远程代码执行。利用方式通常涉及：

1.  **SSRF（CVE-2021-26855）：** 利用 SSRF 漏洞冒充 Exchange 服务器进行身份验证。
2.  **身份验证绕过：** 绕过身份验证后，攻击者可以访问受保护的 Exchange 后端资源。
3.  **任意文件写入/反序列化/RCE：** 利用其他漏洞（例如，通过修改虚拟目录或写入Web shell）在服务器上执行任意代码。

提供的漏洞利用代码仅包含一个 Creative Commons 许可证，本身不包含任何利用代码或恶意代码，因此不存在投毒风险。但实际利用时，攻击者需要结合其他漏洞利用工具和payload才能实现最终的远程代码执行。

**漏洞利用有效性评估：**
根据漏洞库信息和搜索结果，CVE-2021-26855 是一个已知的、被广泛利用的漏洞。存在公开可用的漏洞利用代码（虽然这里没有直接提供，但搜索结果表明存在）。此漏洞被 CISA 列入已知被利用的漏洞目录中，表明该漏洞在野外已被积极利用。

**总结：**
CVE-2021-26855 是一个高危漏洞，允许未经身份验证的攻击者利用 Exchange 服务器执行 SSRF 攻击，为后续的远程代码执行铺平道路。务必尽快应用 Microsoft 提供的安全更新。

**项目地址:** [kh4sh3i/ProxyLogon](https://github.com/kh4sh3i/ProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #17

**来源**: [CVE-2021-26855-mekhalleh_exchange_proxylogon.md](../2021/CVE-2021-26855-mekhalleh_exchange_proxylogon.md)

## CVE-2021-26855 Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** Exchange 2013 Versions < 15.00.1497.012, Exchange 2016 CU18 < 15.01.2106.013, Exchange 2016 CU19 < 15.01.2176.009, Exchange 2019 CU7 < 15.02.0721.013, Exchange 2019 CU8 < 15.02.0792.010

**利用条件:** 目标 Exchange Server 必须可从网络访问,且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 攻击链的一部分。未经身份验证的攻击者可以利用此漏洞发送任意 HTTP 请求，绕过身份验证，并冒充管理员。该漏洞本身并不能直接导致 RCE，但可以与其他漏洞（如 CVE-2021-27065，一个身份验证后的任意文件写入漏洞）结合使用，最终实现远程代码执行。

**利用方式：**

1.  **SSRF（CVE-2021-26855）：**  攻击者利用 SSRF 漏洞发送精心构造的 HTTP 请求，绕过 Exchange Server 的身份验证。
2.  **身份验证绕过：**  成功利用 SSRF 后，攻击者可以获得 Exchange Server 的管理权限，无需提供有效的用户名和密码。
3.  **任意文件写入（CVE-2021-27065 或其他）：**  获得身份验证后，攻击者利用任意文件写入漏洞，将恶意代码写入 Exchange Server 的文件系统中。
4.  **代码执行：**  通过访问写入的恶意文件，攻击者可以在 Exchange Server 上执行任意命令，实现远程代码执行。

**有效性：**

提供的 Metasploit 模块 (`exchange_proxylogon.rb`) 是一个扫描器，用于检测目标 Exchange Server 是否存在 CVE-2021-26855 漏洞。它通过发送特定的 HTTP 请求来验证漏洞是否存在。如果扫描器检测到漏洞，则表明目标服务器容易受到 ProxyLogon 攻击。

**投毒风险：**

提供的代码主要是一个漏洞验证和扫描工具，没有明显的投毒代码。但任何来自外部的代码都存在一定的风险，所以投毒风险估计为5%。主要需要关注的是Metasploit模块中使用的HTTP请求的构造，以及是否会意外地对目标系统造成破坏。此外，攻击者可能会修改此模块以达到恶意目的，但在提供的代码本身中没有发现此类行为。

**项目地址:** [mekhalleh/exchange_proxylogon](https://github.com/mekhalleh/exchange_proxylogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #18

**来源**: [CVE-2021-26855-praetorian-inc_proxylogon-exploit.md](../2021/CVE-2021-26855-praetorian-inc_proxylogon-exploit.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，未经身份验证的攻击者可远程执行任意代码，完全控制 Exchange 服务器。

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2013 Cumulative Update 21/22/23，Microsoft Exchange Server 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19，Microsoft Exchange Server 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 攻击者需要能够访问 Exchange 服务器的端口（通常是 443）。该漏洞是 ProxyLogon 攻击链的一部分，通常与其他漏洞组合利用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞发送任意 HTTP 请求，并有可能绕过身份验证。根据搜索结果和漏洞信息，该漏洞是 ProxyLogon 攻击链的关键组成部分，攻击者可以使用它与其他漏洞（如 CVE-2021-27065）结合，最终在 Exchange 服务器上执行任意代码。提供的漏洞利用代码只包含 Apache License 2.0 协议，没有发现恶意代码，因此投毒风险极低。利用方式通常涉及：

1.  **SSRF 攻击:** 利用 CVE-2021-26855 发送恶意构造的 HTTP 请求到 Exchange 服务器后端。
2.  **身份验证绕过:** 通过 SSRF 漏洞，攻击者可以模拟管理员身份进行后续操作。
3.  **任意文件写入/代码执行:** 结合其他漏洞（如 CVE-2021-27065），攻击者可以将恶意代码写入 Exchange 服务器的文件系统，并最终执行任意代码。

 该漏洞已经被 CISA 加入到已知被利用漏洞目录 (KEV)，表明其在野外被广泛利用。

**项目地址:** [praetorian-inc/proxylogon-exploit](https://github.com/praetorian-inc/proxylogon-exploit)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #19

**来源**: [CVE-2021-26855-r0xdeadbeef_CVE-2021-26855.md](../2021/CVE-2021-26855-r0xdeadbeef_CVE-2021-26855.md)

## CVE-2021-26855 Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 受影响版本包括 Exchange Server 2013、2016 和 2019 的多个累积更新版本

**利用条件:** 目标Exchange服务器未安装相关安全更新，且攻击者能够访问Exchange服务器的443端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。攻击者可以利用此漏洞绕过身份验证，并发送任意 HTTP 请求，最终通过与其他漏洞（如 CVE-2021-27065）结合，实现远程代码执行。

**利用方式：**

1.  **SSRF (CVE-2021-26855)：** 利用 Autodiscover 协议的缺陷，发送特制的 HTTP 请求到 Exchange 服务器。由于服务器信任来自自身的请求，攻击者可以伪造请求，绕过身份验证。
2.  **获取 LegacyDN：** 通过 SSRF 漏洞，攻击者可以获取目标用户的 LegacyDN。 LegacyDN 是 Exchange 服务器中用户的唯一标识符。
3.  **伪造 MAPI 请求：**  使用获取的 LegacyDN，攻击者可以构造恶意的 MAPI (Messaging Application Programming Interface) 请求，并将其发送到 Exchange 服务器。
4.  **写入 Web Shell (CVE-2021-27065):** 攻击者利用后端组件的漏洞将webshell写入服务器，从而实现远程代码执行。
5.  **远程代码执行：** 成功写入webshell后，即可通过webshell执行任意代码，控制Exchange服务器。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，CVE-2021-26855 是一个经过广泛利用的漏洞，且存在公开的 PoC 代码。提供的 PoC 代码尝试模拟 ProxyLogon 漏洞链的利用过程，包括 SSRF、获取 LegacyDN、伪造 MAPI 请求和写入 Web Shell。根据PoC代码和搜索结果的描述，此POC代码可以实现远程代码执行，有效性较高，但是需要和其它漏洞配合利用，才能达成RCE。

**投毒风险分析：**

PoC 代码本身主要功能是进行漏洞验证和利用，直接植入恶意代码的概率较低。 但仍然存在一定的风险，例如：

*   **恶意代码混淆：** 攻击者可能将恶意代码隐藏在看似无害的字符串或函数中。
*   **依赖项投毒：** PoC 代码可能依赖于外部库或模块，如果这些依赖项被篡改，则可能引入恶意代码。

基于提供的代码，经过分析，判断投毒风险较低，但是仍然不能排除。该代码尝试利用漏洞，但是执行命令的部分是通过写入webshell实现的，增加webshell写入位置的随机性有可能被用于逃避检测，因此有一定的概率(10%)被用于投毒。

**项目地址:** [r0xdeadbeef/CVE-2021-26855](https://github.com/r0xdeadbeef/CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #20

**来源**: [CVE-2021-26855-shacojx_CVE-2021-26855-exploit-Exchange.md](../2021/CVE-2021-26855-shacojx_CVE-2021-26855-exploit-Exchange.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞（ProxyLogon）

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 受影响的Exchange Server 2013, 2016, 2019 Cumulative Updates

**利用条件:** 需要能够访问 Exchange Server 的 OWA 接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，是 ProxyLogon 攻击链的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求并作为 Exchange 服务器进行身份验证。从搜索引擎结果和漏洞库信息可以得知，这是一个被广泛利用的漏洞，存在公开的PoC，并且被CISA添加到已知被利用的漏洞目录中。 

**漏洞利用方式:**

1.  **SSRF (CVE-2021-26855):** 利用 SSRF 漏洞绕过身份验证。
2.  **构造请求:** 攻击者首先发送一个包含特定 Cookie 的 GET 请求，利用 SSRF 漏洞。
3.  **NTLM 认证:** 使用 NTLM 认证绕过。
4.  **获取 FQDN:** 通过 NTLM type2 协议获取服务器的 FQDN (Fully Qualified Domain Name)。
5.  **发送恶意 XML:** 构造恶意的 XML 数据，通过 POST 请求发送到 Exchange Web Services (EWS) 端点，利用后端组件处理 XML 时存在的漏洞执行任意代码。  
6.  **用户枚举:**  PoC 代码还包含用户枚举的功能，增加了攻击面。

**有效性：**

提供的 Go 代码是一个可用的 PoC。它包含了漏洞验证、NTLM 认证和发送恶意 XML 数据的步骤。代码结构清晰，逻辑完整，可以直接用于检测和利用该漏洞。

**投毒风险：**

虽然代码看起来主要实现了漏洞利用的功能，但仍存在一定投毒风险的可能性：
* 用户枚举模块可能被滥用，用于非法收集用户信息。
* 代码中存在一些硬编码的参数和路径，可能在特定环境下不可用，需要使用者修改，可能存在被诱导修改恶意代码。
* 风险评估为 10%，因为代码的主要功能是漏洞利用，而非恶意行为，但是存在被滥用和修改的潜在风险。

**项目地址:** [shacojx/CVE-2021-26855-exploit-Exchange](https://github.com/shacojx/CVE-2021-26855-exploit-Exchange)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #21

**来源**: [CVE-2021-26855-shacojx_Scan-Vuln-CVE-2021-26855.md](../2021/CVE-2021-26855-shacojx_Scan-Vuln-CVE-2021-26855.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要能够访问Exchange Server的端口，通常是443端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞发送任意 HTTP 请求并以 Exchange 服务器的身份进行身份验证，从而绕过身份验证。

**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码判断，该漏洞利用代码的有效性较高。大量的信息表明这是一个已知的、被广泛利用的漏洞，并且CISA已知可利用漏洞目录中包含了此漏洞。

**投毒风险：**
检视提供的代码，主要包含以下几个部分：
1.  `README.md`: 包含漏洞描述和图片。
2.  `build.xml`: Ant构建脚本，用于编译Java项目。
3.  `ipVuln.txt`: 空文件，可能用于存储易受攻击的IP地址列表。
4.  `list-ip.txt`: 包含一个IP地址（`192.168.1.0`），可能用于扫描。
5.  `manifest.mf`: JAR文件的清单文件。
6.  `Tool-Build/Run.bat`: 用于运行编译后的JAR文件的批处理脚本。
7.  `Tool-Build/ipVuln.txt`: 空文件，与上面的`ipVuln.txt`相同。
8.  `Tool-Build/list-ip.txt`: 包含一个IP地址（`192.168.1.0`），可能用于扫描，与上面的`list-ip.txt`相同。
9.  `Tool-Build/Nmap/scripts/http-vuln-cve2021-26855.nse`: Nmap脚本，用于检测目标是否受CVE-2021-26855漏洞影响。这个脚本是漏洞检测的核心。

主要风险点在于`build.xml`构建脚本和`http-vuln-cve2021-26855.nse`这个Nmap脚本。构建脚本可能被修改以包含恶意代码，虽然在这个例子中看起来比较简单，但无法完全排除隐蔽的后门代码存在的可能性。Nmap脚本本身看起来是合法的漏洞检测脚本，但理论上，如果脚本被篡改，可能存在投毒风险。例如，在检测到漏洞时，植入后门或执行恶意操作。
总体评估，投毒风险较低，约为10%，因为主要的代码功能是漏洞扫描，而不是漏洞利用，且代码量不大，容易审计。

**利用方式：**
利用方式通常涉及以下步骤：
1.  **SSRF:** 攻击者利用SSRF漏洞向Exchange服务器发送精心构造的HTTP请求。
2.  **身份验证绕过：** 通过SSRF漏洞，攻击者可以绕过身份验证，模拟Exchange服务器上的其他用户。
3.  **远程代码执行：** 在成功绕过身份验证后，攻击者可以进一步利用其他漏洞（如不安全的deserialization）来执行任意代码。根据搜索引擎结果，CVE-2021-26855是ProxyLogon攻击链的初始漏洞。

综上所述，此漏洞的有效性高，利用方式较为明确，但提供的代码主要用于扫描而非直接利用，因此投毒风险较低。攻击者可以通过SSRF漏洞绕过身份验证，然后利用其他漏洞实现远程代码执行。

**项目地址:** [shacojx/Scan-Vuln-CVE-2021-26855](https://github.com/shacojx/Scan-Vuln-CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #22

**来源**: [CVE-2021-26855-ssrsec_Microsoft-Exchange-RCE.md](../2021/CVE-2021-26855-ssrsec_Microsoft-Exchange-RCE.md)

## CVE-2021-26855 & CVE-2021-27065 - Microsoft Exchange Server RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要能够访问目标 Exchange 服务器的网络端口 (通常是443)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞利用链包括 CVE-2021-26855 (SSRF) 和 CVE-2021-27065 (不安全的反序列化导致RCE)。

**利用方式：**

1.  **SSRF (CVE-2021-26855):** 利用服务器端请求伪造漏洞，攻击者可以发送任意HTTP请求并伪装成Exchange服务器进行身份验证。POC代码首先发送一个NTLM协商请求到`/rpc/`端点，利用返回的`WWW-Authenticate`头中的信息来获取目标Exchange服务器的计算机名和域名。
2.  **RCE (CVE-2021-27065):** 利用获取的计算机名，结合一个已知的邮箱地址格式，构造一个包含`LegacyDN`的请求，发送到`/ecp/baba.js`，最终通过写入webshell来实现远程代码执行。其中，`baba.js`是一个占位符，攻击者可以通过修改这个值，上传任意的webshell。

**有效性：**

根据提供的漏洞信息、搜索结果以及POC代码，可以判断此POC代码是有效的，该漏洞利用是公开的，影响范围广泛。搜索结果也表明该漏洞已被广泛利用。

**投毒风险：**

代码主要功能是利用漏洞，但存在潜在的投毒风险。风险点在于：

*   **Webshell 内容：** Webshell的内容（`<script language="JScript" runat="server">function Page_Load(){eval(Request["babanb"],"unsafe");}</script>`）是固定的，攻击者可能会修改这个内容，植入恶意代码，或者植入更加隐蔽的后门。目前是直接在ecp目录下写了baba.js的文件,比较容易被发现。
*   **依赖项风险：**虽然代码量少，但仍然可能引入有安全风险的第三方库，虽然这里没有体现。
*  **邮件用户列表:** 代码中使用了一个邮件用户列表进行尝试。这个列表可能被修改，用于针对特定目标进行攻击，或者用于搜集敏感信息。

虽然存在风险，但整体代码逻辑较为清晰，风险较低。投毒风险评估为10%。

**项目地址:** [ssrsec/Microsoft-Exchange-RCE](https://github.com/ssrsec/Microsoft-Exchange-RCE)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #23

**来源**: [CVE-2021-26855-thau0x01_poc_proxylogon.md](../2021/CVE-2021-26855-thau0x01_poc_proxylogon.md)

## CVE-2021-26855 Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 受影响的版本包括：Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange Server开放443端口，且未安装相关安全补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 (ProxyLogon) 是一种存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞。未经身份验证的远程攻击者可以通过发送精心构造的 HTTP 请求来利用此漏洞，从而能够伪造身份并执行其他恶意操作。从搜索结果来看，该漏洞被广泛利用。提供的PoC代码展示了利用该漏洞获取远程代码执行权限的过程。

**漏洞利用方式：**

1.  **SSRF (CVE-2021-26855):** 首先，利用SSRF漏洞发送任意HTTP请求，目的是绕过身份验证，获取有效的LegacyDN。
2.  **获取 LegacyDN:** 通过构造Autodiscover请求，获取目标用户的 LegacyDN。
3.  **MAPI 连接:** 使用获取的LegacyDN建立一个MAPI会话。
4.  **获取 SID:** 从MAPI响应中提取用户的安全标识符 (SID)。
5.  **ProxyLogon:** 利用ProxyLogon机制，将用户SID修改为管理员SID，从而提升权限。
6.  **写入 Webshell:** 利用提升的权限，向服务器写入webshell，实现远程代码执行。

**投毒风险分析：**

代码中存在以下潜在的投毒风险：

*   **硬编码的路径和文件名：** `shell_path`和`shell_absolute_path`以及`ahihi7.aspx`是硬编码的，这使得webshell容易被检测和移除，但如果攻击者修改了这些值，可能会将webshell写入到更隐蔽的位置。
*   **webshell 内容：** `shell_content`包含执行 `whoami` 命令的JavaScript代码，这是一个简单的测试命令。攻击者可以修改`shell_content`以执行更具破坏性的操作。虽然当前代码只是执行`whoami`，但不能排除攻击者将恶意代码注入`shell_content`的可能性。这一部分存在被恶意修改进行投毒的可能性。
*   **代理URI (`msExchProxyUri`)**: PoC代码中 `msExchProxyUri` 设置为`http://127.0.0.1:8080/`，这意味着攻击者可能尝试通过本地代理进行其他攻击，或者将流量转发到恶意服务器。虽然现在指向本地，但存在被修改指向恶意地址的可能性。

虽然这些风险存在，但整体代码看起来是为了验证漏洞，主要的目的是为了RCE，没有明显的隐藏后门或者其他恶意行为。因此，投毒风险较低, 约5%。

**项目地址:** [thau0x01/poc_proxylogon](https://github.com/thau0x01/poc_proxylogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #24

**来源**: [CVE-2021-26855-timb-machine-mirrors_testanull-CVE-2021-26855_read_poc.txt.md](../2021/CVE-2021-26855-timb-machine-mirrors_testanull-CVE-2021-26855_read_poc.txt.md)

## CVE-2021-26855-Microsoft Exchange Server-SSRF

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造（SSRF）漏洞。根据搜索结果和漏洞描述，未经验证的远程攻击者可以利用此漏洞发送任意 HTTP 请求并模拟 Exchange 服务器进行身份验证。该漏洞是 ProxyLogon 攻击链的关键组成部分。提供的POC代码尝试通过 `POST /ecp/poc-2021-26855.js HTTP/1.1` 发送 SOAP 请求，通过修改 `X-BEResource` cookie 绕过身份验证，进而执行其他操作。由于请求的目标是 EWS (Exchange Web Services)，这允许攻击者访问和操作邮箱数据。分析代码中,没有发现作者隐藏的投毒代码。

**利用方式：**

1.  **SSRF 攻击：** 利用 CVE-2021-26855，攻击者可以向 Exchange 服务器发送伪造的 HTTP 请求。
2.  **身份验证绕过：** 通过操纵 `X-BEResource` cookie，攻击者可以绕过身份验证，冒充合法用户。
3.  **邮箱访问：** 一旦成功绕过身份验证，攻击者可以使用 EWS 接口访问和操作邮箱数据，例如读取邮件、联系人等。
4.  **链式利用：** CVE-2021-26855 通常与其他 Exchange 漏洞（如 CVE-2021-26857、CVE-2021-26858、CVE-2021-27065）结合使用，形成 ProxyLogon 攻击链，最终实现远程代码执行。

**项目地址:** [timb-machine-mirrors/testanull-CVE-2021-26855_read_poc.txt](https://github.com/timb-machine-mirrors/testanull-CVE-2021-26855_read_poc.txt)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #25

**来源**: [CVE-2021-26855-yaoxiaoangry3_Flangvik.md](../2021/CVE-2021-26855-yaoxiaoangry3_Flangvik.md)

## CVE-2021-26855 Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Microsoft Exchange Server 2013、2016 和 2019 的多个累积更新版本，具体版本参见漏洞库信息

**利用条件:** 目标Exchange服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求并可能绕过身份验证。

**有效性分析：**
根据提供的漏洞库信息，此漏洞影响多个版本的 Microsoft Exchange Server，CVSS 评分为 9.1，表明其严重性。
搜索结果显示，此漏洞被广泛利用，并且有公开的 PoC 可用，参考网页标题包含"ProxyLogon"的网页信息可以知道。
提供的漏洞利用代码描述表明它是一个 C# PoC，支持半交互式的 web shell 以及 shellcode 执行。
综合来看，提供的 POC 代码是有效的。

**投毒风险分析：**
提供的代码片段 `/tmp/e24bb8b01b99c84300e1ac6fb58f9709/README.md` 只显示了关于 PoC 的简短描述，无法直接判断是否存在投毒代码。由于是 C# PoC，投毒代码可能隐藏在编译后的二进制文件中。仅仅通过 README.md 文件判断，存在误判可能性，但是根据以往经验，开源社区存在一定的投毒行为，因此给出一定百分比。

**利用方式分析：**
1.  利用 CVE-2021-26855 的 SSRF 漏洞，攻击者可以绕过身份验证。
2.  成功绕过身份验证后，攻击者可以利用后续漏洞（例如 CVE-2021-26857）写入任意文件。
3.  写入的文件可以是一个 ASPX web shell，允许攻击者执行任意代码。
4.  或者，攻击者可以使用 shellcode 直接在服务器上执行恶意代码。
该漏洞是 ProxyLogon 攻击链的初始入口点，为后续攻击铺平道路。

**项目地址:** [yaoxiaoangry3/Flangvik](https://github.com/yaoxiaoangry3/Flangvik)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---



---

## POC #7

**来源**: [CVE-2021-26855-ShyTangerine_cve-2021-26855.md](../2021/CVE-2021-26855-ShyTangerine_cve-2021-26855.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Exchange Server 2013、2016 和 2019 的多个累积更新版本，详见漏洞库信息

**利用条件:** 需要能够访问 Exchange Server 的 ECP 接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。未授权的攻击者可以利用此漏洞发送任意 HTTP 请求并进行身份验证，绕过身份验证，最终导致远程代码执行。

**利用方式：**

根据提供的漏洞利用代码，利用过程大致如下：

1.  **初始请求：** 向 `/ecp/x.png` 发送 GET 请求，尝试获取 `X-BEResource` Cookie。
2.  **获取 DN 值：** 通过向 `/ecp/x.png` 发送包含特定 XML 内容的 POST 请求，利用 Autodiscover 服务获取用户的 DN (Distinguished Name)。
3.  **Mapi/Emsmdb 连接：** 使用获取的 DN 值，向 `/ecp/x.png` 发送包含 `X-BEResource`、`X-Clientinfo` 等头的 POST 请求，尝试建立 MAPI over HTTP 连接。
4.  **获取 Session 和 msExchEcpCanary：** 通过向 `/ecp/x.png` 发送包含特定 XML 内容的 POST 请求，利用 Negotiate 协议获取 ASP.NET Session ID 和 `msExchEcpCanary` 值。`msExchEcpCanary` 是一个安全令牌，用于防止跨站请求伪造 (CSRF) 攻击。
5.  **获取 OAB ID：** 发送包含`msExchEcpCanary` 和 Session ID 到`/ecp/x.png`，获取OAB id，为下一步写入恶意代码作准备

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞确实存在且已被积极利用。该 POC 代码展示了漏洞利用的关键步骤，例如如何绕过身份验证、如何获取必要的凭据信息等。该漏洞利用的有效性较高。

**投毒风险：**

评估提供的 POC 代码，存在一定投毒风险，10%。 风险点主要在于：

*   **硬编码的 IP 地址和域名：** POC 代码中包含硬编码的 IP 地址 (例如 `10.255.200.20`, `192.168.170.134`) 和域名 (`EXCHANGE01.xihongdream.com`)。如果用户直接使用这些硬编码的值，可能会将攻击流量导向作者控制的服务器，从而暴露目标服务器的信息或被用于进一步的攻击。

*   **潜在的后门植入：** 虽然 POC 代码的主要目的是演示漏洞利用过程，但作者有可能在代码中插入后门，例如，在OAB操作中，写入恶意脚本到目标服务器，长期控制目标系统。

总的来说，该 POC 代码主要演示了 SSRF 的利用方式。用户在使用时应谨慎，务必修改代码中的硬编码值，避免潜在的投毒风险。

**项目地址:** [ShyTangerine/cve-2021-26855](https://github.com/ShyTangerine/cve-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #8

**来源**: [CVE-2021-26855-TheDudeD6_ExchangeSmash.md](../2021/CVE-2021-26855-TheDudeD6_ExchangeSmash.md)

## CVE-2021-26855-Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器可访问，且未安装相关安全更新。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，是 ProxyLogon 攻击链的一部分。未经身份验证的攻击者可以利用此漏洞发送任意 HTTP 请求并冒充管理员进行身份验证，最终造成远程代码执行。

**利用方式：**

1.  **SSRF（CVE-2021-26855）：** 攻击者首先利用 SSRF 漏洞绕过身份验证，获取合法的身份。
2.  **获取SID：** 使用合法的身份，获取用户的SID
3.  **伪造管理员 SID：** 通过篡改已泄露的用户SID，伪造管理员SID
4.  **ProxyLogon：** 使用伪造的管理员 SID 通过 ProxyLogon 攻击链，获得管理员权限。
5.  **写入webshell：** 利用管理员权限，在目标服务器上写入 webshell。
6.  **远程代码执行：** 通过访问 webshell 执行任意代码。

**投毒风险：**
查看提供的POC代码，发现其功能是利用漏洞，在正常情况下，不应存在恶意代码。但是，由于代码逻辑复杂，且依赖外部库（Impacket），存在作者在代码中植入恶意逻辑的可能性。另外，通过分析发现proxylogon.py中的shell_src变量可以自定义，如果被替换成恶意payload，则存在一定风险。

综合考虑，投毒风险评估为10%，主要风险在于代码的可信度以及shell_src变量的替换。

**项目地址:** [TheDudeD6/ExchangeSmash](https://github.com/TheDudeD6/ExchangeSmash)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #9

**来源**: [CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855.md](../2021/CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF to RCE (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** SSRF (Server-Side Request Forgery) -> RCE (Remote Code Execution)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器可以从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 存在于 Microsoft Exchange Server 中，是一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞。

**利用方式：**

1.  **SSRF：** 攻击者利用SSRF漏洞，通过构造恶意的 HTTP 请求，绕过身份验证。
2.  **获取 LegacyDN：** 利用 SSRF 漏洞，向 Exchange 服务器的 autodiscover 端点发送请求，获取目标用户的 LegacyDN。
3.  **MAPI 连接：** 使用获得的 LegacyDN 建立 MAPI 连接。
4.  **获取 SID：** 从 MAPI 响应中提取用户的 SID。
5.  **ProxyLogon：** 利用 SID 伪造身份，通过 proxyLogon.ecp 端点进行身份验证绕过。
6.  **写入 Webshell：** 成功绕过身份验证后，攻击者可以将恶意的 webshell 写入到 Exchange 服务器的 OWA 目录中。
7.  **远程代码执行：** 攻击者通过访问写入的 webshell，执行任意代码。

**有效性评估：**

提供的 POC 代码 `ExchangeSheller.py` 实现了上述利用流程，能够自动化利用 CVE-2021-26855 漏洞，因此是有效的。

**投毒风险分析：**

代码本身执行的是漏洞利用流程，主要功能为利用 SSRF 漏洞并最终写入 Webshell。但需要注意以下几点：

*   **代码来源：** 代码来自 GitHub，需要验证其作者的信誉和代码的完整性。
*   **Webshell 内容：** Webshell 的内容可控，攻击者可以修改 webshell 的内容，使其执行恶意操作，如植入后门、窃取数据等。
*   **隐藏指令：** 理论上，eval 函数中可以嵌入隐蔽的恶意代码，但这需要仔细分析 `ExchangeSheller.py` 文件，当前判断该风险较低。

**结论：**

该漏洞利用的有效性高。存在一定的投毒风险，主要体现在攻击者可能会修改webshell的内容，但总体来说代码的结构和逻辑清晰，投毒风险较低，估计在5%。务必在隔离环境下进行测试，并对生成的 webshell 进行安全审计。

**项目地址:** [ZephrFish/Exch-CVE-2021-26855](https://github.com/ZephrFish/Exch-CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #10

**来源**: [CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855_Priv.md](../2021/CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855_Priv.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的 Exchange 服务器上执行任意代码。

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21/22/23, 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19, 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 目标Exchange服务器存在漏洞且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 攻击链的一部分。未经身份验证的攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成管理员进行身份验证，然后结合其他漏洞（例如 CVE-2021-27065）来写入任意文件，最终实现远程代码执行。

**漏洞利用方式：**

1.  **SSRF (CVE-2021-26855):** 攻击者利用 SSRF 漏洞，通过构造特殊的 URL 和请求头，绕过身份验证，获取 Exchange 服务器的访问权限。
2.  **获取 LegacyDN：** 利用 Autodiscover 服务获取目标用户的 LegacyDN。
3.  **MAPI 连接：** 使用获取的 LegacyDN 建立 MAPI 连接。
4.  **ProxyLogon:** 通过构造 ProxyLogon 请求，伪装成管理员身份。
5.  **写入 Webshell (CVE-2021-27065，虽然POC未直接体现，但通常会结合使用):** 在成功通过身份验证后，利用漏洞在 Exchange 服务器的 OWA 目录下写入恶意的 Webshell 文件，该文件包含可以执行任意代码的 JScript 代码。
6.  **远程代码执行：** 攻击者通过访问 Webshell 文件，执行任意代码。

**有效性：**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞利用代码是有效的，因为它再现了 ProxyLogon 攻击链的关键步骤，包括 SSRF、权限提升和 webshell 写入 (webshell 内容在代码中已经存在)。搜索引擎结果中也表明 CVE-2021-26855 被积极利用。

**投毒风险：**

分析提供的 POC 代码，未发现明显的投毒代码。代码逻辑主要集中在利用 SSRF 漏洞进行身份验证绕过，并最终部署 webshell。虽然 webshell 本身是一种恶意代码，但这是漏洞利用的必要步骤，而非作者有意添加的恶意功能。因此，判定投毒风险为0%。

**项目地址:** [ZephrFish/Exch-CVE-2021-26855_Priv](https://github.com/ZephrFish/Exch-CVE-2021-26855_Priv)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #11

**来源**: [CVE-2021-26855-dwisiswant0_proxylogscan.md](../2021/CVE-2021-26855-dwisiswant0_proxylogscan.md)

## CVE-2021-26855 Microsoft Exchange Server SSRF 漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** Exchange 2013 Versions < 15.00.1497.012, Exchange 2016 CU18 < 15.01.2106.013, Exchange 2016 CU19 < 15.01.2176.009, Exchange 2019 CU7 < 15.02.0721.013, Exchange 2019 CU8 < 15.02.0792.010

**利用条件:** 需要能够访问存在漏洞的 Exchange Server 的网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而冒充管理员身份。该漏洞是 ProxyLogon 攻击链的一部分，与 CVE-2021-27065 (身份验证后任意文件写入漏洞) 结合使用，可以实现远程代码执行。

**漏洞利用方式：**

1.  攻击者利用 CVE-2021-26855，发送特制的 HTTP 请求到 Exchange Server，绕过身份验证并获得管理员权限。
2.  利用获得的管理员权限，攻击者可以进一步利用 CVE-2021-27065 将恶意代码写入服务器。
3.  执行写入的恶意代码，最终实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码 `proxylogscan` 是一个 Go 语言编写的工具，用于大规模扫描存在 CVE-2021-26855 漏洞的 Microsoft Exchange Server。它通过发送特定的 HTTP 请求来检测目标服务器是否存在漏洞。

**投毒风险分析：**

代码主要功能是扫描漏洞，用于检测目标是否存在漏洞。 考虑到工具的用途和代码的简洁性，投毒的可能性较低，但是需要对代码进行仔细的审查，特别是涉及网络请求的部分，以确保没有隐藏的恶意逻辑。 投毒的可能性较低，但是依然存在一定的风险。代码使用go get安装，存在一定的依赖风险,需要注意.


**项目地址:** [dwisiswant0/proxylogscan](https://github.com/dwisiswant0/proxylogscan)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #12

**来源**: [CVE-2021-26855-glen-pearson_ProxyLogon-CVE-2021-26855.md](../2021/CVE-2021-26855-glen-pearson_ProxyLogon-CVE-2021-26855.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞 (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，未经验证的远程攻击者可以利用此漏洞在受影响的系统上执行任意代码

**影响版本:** 受影响版本包括 Exchange Server 2013 Cumulative Update 22 和 23, Exchange Server 2016 Cumulative Update 12-19, Exchange Server 2019 Cumulative Update 1-8

**利用条件:** 目标系统存在未修补的 Exchange Server 实例，攻击者需要能够通过网络访问 Exchange 服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成 Exchange 服务器进行身份验证，为后续利用其他漏洞（例如 CVE-2021-26857）创造条件。漏洞利用链通常涉及以下步骤：

1.  **SSRF (CVE-2021-26855):** 利用 SSRF 漏洞绕过身份验证，获取 Exchange 服务器的权限。
2.  **不安全的反序列化:** 通过 SSRF 漏洞获取的权限，进一步利用不安全的反序列化漏洞（例如 CVE-2021-26854, CVE-2021-26857, CVE-2021-27065）执行任意代码。

提供的 PoC 代码是一个修改后的 ProxyLogon 漏洞利用脚本，它利用 CVE-2021-26855 绕过身份验证，然后在服务器上创建一个后门 Web shell。具体流程如下：

1.  **自动发现 (Autodiscover):** 使用 Autodiscover 协议获取 LegacyDN。
2.  **MAPI 连接:** 使用获取的 LegacyDN 建立 MAPI 连接，模拟管理员权限。
3.  **Web Shell 写入:**  将包含反向 shell 代码的 aspx Web shell 写入到服务器的 `Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\test11.aspx` 路径。
4.  **执行 Web Shell:** 攻击者可以通过访问该 Web shell 执行任意命令。该 Web shell 执行 Powershell 命令，建立一个反向 TCP 连接到攻击者的指定 IP 地址和端口。 

**有效性：** 该 PoC 代码有效，因为它实现了 ProxyLogon 漏洞利用，并成功创建反向 shell，证明了远程代码执行。

**投毒风险：** 存在一定的投毒风险。作者在原始PoC基础上修改了代码，增加了创建用户和反向shell的功能，该行为可能被攻击者利用，如果攻击者修改了反向shell中的IP地址和端口，则使用者在不知情的情况下连接到攻击者的服务器，所以存在投毒风险。 风险大约在10%。

**利用方式：** 攻击者首先利用 CVE-2021-26855 漏洞绕过身份验证，获取 Exchange 服务器的权限，然后通过写入 Web shell 执行任意代码。这个 Web shell 会连接到攻击者控制的服务器，从而允许攻击者完全控制受感染的 Exchange 服务器。

**项目地址:** [glen-pearson/ProxyLogon-CVE-2021-26855](https://github.com/glen-pearson/ProxyLogon-CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #13

**来源**: [CVE-2021-26855-hakivvi_proxylogon.md](../2021/CVE-2021-26855-hakivvi_proxylogon.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全控制受影响的Exchange服务器

**影响版本:** 受影响版本包括 Exchange Server 2013 Cumulative Update 21/22/23, Exchange Server 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19, Exchange Server 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 需要能够访问Exchange服务器的网络，并且服务器存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。结合其他漏洞（如CVE-2021-27065），未经身份验证的远程攻击者可以利用此漏洞发送任意 HTTP 请求并以管理员身份通过身份验证，最终实现远程代码执行。 

**利用方式：**

1.  **SSRF (CVE-2021-26855):** 攻击者首先利用 SSRF 漏洞伪造 HTTP 请求，绕过身份验证。
2.  **管理员权限获取:** 利用伪造的请求，攻击者可以获得 Exchange 服务器的管理员权限。
3.  **OAB虚拟目录操作:** 修改OAB (Offline Address Book)虚拟目录的ExternalUrl参数，将shell地址写入。
4.  **Shell 写入:** 通过修改的ExternalUrl，攻击者将一个 ASPX webshell 写入到 Exchange 服务器的 web 可访问目录（通常是`C:\inetpub\wwwroot\aspnet_client\`）。 
5.  **远程代码执行:** 攻击者可以通过访问 webshell 的 URL 并发送特定的请求参数来执行任意代码。

**代码分析与投毒风险评估：**

提供的POC代码 `proxylogon.py` 实现了上述的攻击流程。代码首先利用 SSRF 获取服务器的计算机名，然后利用 NTLM 认证绕过。之后，它利用获取的管理员权限，通过修改 OAB 虚拟目录来写入 webshell。最后，代码输出 webshell 的 URL，攻击者可以通过该 URL 执行任意命令。

**投毒风险分析:**  POC代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **后门植入:** 虽然主要的目的是利用漏洞进行RCE，恶意攻击者可能会在脚本中添加额外的后门代码，例如，在写入的 webshell 中添加额外的功能，以便在将来保持对服务器的访问。
*   **信息收集:**  攻击者可以修改脚本来收集目标服务器上的敏感信息，例如，用户名、密码哈希、以及其他配置信息。
*   **恶意传播:**  如果攻击者控制了多个 Exchange 服务器，他们可以修改脚本来自动传播恶意软件到其他服务器。
*   **依赖库风险：**POC依赖Impacket库，如果Impacket库本身被篡改或包含恶意代码，那么使用此POC也会受到影响。

尽管存在这些风险，但就提供的代码片段本身而言，没有明显的恶意代码。风险主要在于该漏洞本身带来的权限和潜在的恶意修改行为。POC中生成随机字符串的部分(gen())是为了避免文件名冲突，本身不是恶意行为。利用OABVirtualDirectory修改ExternalUrl以及ResetOABVirtualDirectory修改FilePathName的行为是为了webshell的写入，这是漏洞利用的一部分。

**总结:** 该漏洞利用链的有效性较高，因为 CVE-2021-26855 是 ProxyLogon 攻击链的关键组成部分，被广泛利用。 投毒风险主要来自于利用此漏洞成功入侵后的恶意行为，而非POC代码本身。由于代码中包含webshell的部署，存在一定风险，但直接判定为投毒不严谨，结合分析结果，投毒风险预估为10%。

**项目地址:** [hakivvi/proxylogon](https://github.com/hakivvi/proxylogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #14

**来源**: [CVE-2021-26855-hictf_CVE-2021-26855-CVE-2021-27065.md](../2021/CVE-2021-26855-hictf_CVE-2021-26855-CVE-2021-27065.md)

## CVE-2021-26855 Microsoft Exchange Server SSRF 远程代码执行漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** SSRF (服务器端请求伪造) -> 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器对外开放，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个 SSRF 漏洞。根据搜索结果，攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成 Exchange 服务器进行身份验证。该漏洞是 ProxyLogon 攻击链中的一部分，攻击者利用该漏洞可以绕过身份验证，并结合其他漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者利用 CVE-2021-26855 漏洞发送恶意构造的 HTTP 请求到 Exchange 服务器。
2.  通过 SSRF 漏洞，攻击者可以伪装成 Exchange 服务器进行身份验证，绕过身份验证机制。
3.  绕过身份验证后，攻击者可以利用其他漏洞（例如 CVE-2021-27065，反序列化漏洞）在 Exchange 服务器上执行任意代码。

**POC有效性分析：**

提供的 POC 代码包含一个简单的 PHP 文件（hello world），一个 README 文件，一个简单的 Node.js 服务器 (demo.js) 和一个 package.json 文件。这些代码片段本身并不能直接利用 CVE-2021-26855。它们更像是用于搭建一个基础的web服务器环境，可能用于验证漏洞利用的某些步骤或作为最终执行的payload的一部分。因此，单独来看，提供的POC代码**无效**，它只是利用整个漏洞链中的一小部分。

**投毒风险分析：**

提供的 POC 代码较为简单，没有明显的恶意代码。`demo.js` 只是一个简单的 HTTP 服务器，`1.php` 只是输出 "hello world"。但是，考虑到这是一个 Exchange 漏洞的 POC，攻击者可能会在更复杂的利用链中利用这些文件，例如将 `1.php` 作为 Webshell 上传到服务器，或者利用 `demo.js` 搭建一个用于接收反弹 shell 的服务器。 因此，存在一定的投毒风险，但风险主要在于利用方式的组合，而非代码本身存在后门。

**投毒风险评估：**

由于代码功能简单，直接投毒的可能性较低，但作为漏洞利用链的一部分，可能被用于执行恶意操作，因此投毒风险评定为 **20%**。

**项目地址:** [hictf/CVE-2021-26855-CVE-2021-27065](https://github.com/hictf/CVE-2021-26855-CVE-2021-27065)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #15

**来源**: [CVE-2021-26855-hosch3n_ProxyVulns.md](../2021/CVE-2021-26855-hosch3n_ProxyVulns.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，无需身份验证即可远程代码执行

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 22, 23; 2016 Cumulative Update 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19; 2019 Cumulative Update 1, 2, 3, 4, 5, 6, 7, 8

**利用条件:** Exchange Server对外开放443端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造（SSRF）漏洞，它允许未经身份验证的攻击者发送任意 HTTP 请求并伪装成 Exchange 服务器的管理员。此漏洞是 ProxyLogon 攻击链的入口点，后续可以配合其他漏洞实现远程代码执行。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用是有效的。搜索引擎结果中许多链接都表明 CVE-2021-26855 已被积极利用。漏洞利用代码 `26855.py` 实现了利用该漏洞的步骤，包括：

1.  **SSRF 探测：** 通过构造特殊的 `X-BEResource` 请求头，获取 Exchange 后端服务器的计算机名和域名。
2.  **LegacyDN 获取：** 利用 Autodiscover 服务，通过提供用户邮箱地址获取 LegacyDN。
3.  **SID 欺骗：** 伪造 MAPI 请求，通过 LegacyDN 获取用户的 SID。
4.  **ProxyLogon 利用：** 利用获取到的 SID，通过 `proxyLogon.ecp` 绕过身份验证。
5.  **Webshell 部署：** 写入 Webshell 到服务器。

**投毒风险分析：**
漏洞利用代码中存在较低的投毒风险 (大约 5%)。虽然代码的目的是利用漏洞，但攻击者可能在 `webshell_content` 中植入恶意代码，或者修改 `webshell_path` 将webshell写入到不常见的位置，使得后期的权限维持或者横向移动更加隐蔽。例如，如果`webshell_content`包含下载和执行其他恶意文件的指令，这就是一种投毒行为。 目前提供的webshell代码较为简单，判定投毒的概率较低。

**利用方式总结：**
1.  攻击者首先利用 SSRF 漏洞 (CVE-2021-26855) 绕过身份验证。
2.  攻击者通过构造恶意的 HTTP 请求，欺骗 Exchange 服务器，使其认为攻击者已通过身份验证。
3.  成功绕过身份验证后，攻击者可以使用其他漏洞（例如 CVE-2021-27065，写入任意文件）在 Exchange 服务器上执行任意代码，部署 Webshell。
4.  攻击者通过 Webshell 执行系统命令，控制 Exchange 服务器。

**项目地址:** [hosch3n/ProxyVulns](https://github.com/hosch3n/ProxyVulns)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #16

**来源**: [CVE-2021-26855-kh4sh3i_ProxyLogon.md](../2021/CVE-2021-26855-kh4sh3i_ProxyLogon.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF/RCE (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，未经验证的远程攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**影响版本:** 受影响版本包括Exchange Server 2013、2016和2019的多个累积更新。

**利用条件:** 需要目标Exchange服务器存在漏洞版本，且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，它是 ProxyLogon 漏洞链中的第一个环节。攻击者可以利用此漏洞发送任意 HTTP 请求并作为 Exchange 服务器进行身份验证。根据搜索结果，此漏洞与其他漏洞（如 CVE-2021-26857、CVE-2021-26858 和 CVE-2021-27065）结合使用，可以实现未经身份验证的远程代码执行。利用方式通常涉及：

1.  **SSRF（CVE-2021-26855）：** 利用 SSRF 漏洞冒充 Exchange 服务器进行身份验证。
2.  **身份验证绕过：** 绕过身份验证后，攻击者可以访问受保护的 Exchange 后端资源。
3.  **任意文件写入/反序列化/RCE：** 利用其他漏洞（例如，通过修改虚拟目录或写入Web shell）在服务器上执行任意代码。

提供的漏洞利用代码仅包含一个 Creative Commons 许可证，本身不包含任何利用代码或恶意代码，因此不存在投毒风险。但实际利用时，攻击者需要结合其他漏洞利用工具和payload才能实现最终的远程代码执行。

**漏洞利用有效性评估：**
根据漏洞库信息和搜索结果，CVE-2021-26855 是一个已知的、被广泛利用的漏洞。存在公开可用的漏洞利用代码（虽然这里没有直接提供，但搜索结果表明存在）。此漏洞被 CISA 列入已知被利用的漏洞目录中，表明该漏洞在野外已被积极利用。

**总结：**
CVE-2021-26855 是一个高危漏洞，允许未经身份验证的攻击者利用 Exchange 服务器执行 SSRF 攻击，为后续的远程代码执行铺平道路。务必尽快应用 Microsoft 提供的安全更新。

**项目地址:** [kh4sh3i/ProxyLogon](https://github.com/kh4sh3i/ProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #17

**来源**: [CVE-2021-26855-mekhalleh_exchange_proxylogon.md](../2021/CVE-2021-26855-mekhalleh_exchange_proxylogon.md)

## CVE-2021-26855 Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** Exchange 2013 Versions < 15.00.1497.012, Exchange 2016 CU18 < 15.01.2106.013, Exchange 2016 CU19 < 15.01.2176.009, Exchange 2019 CU7 < 15.02.0721.013, Exchange 2019 CU8 < 15.02.0792.010

**利用条件:** 目标 Exchange Server 必须可从网络访问,且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 攻击链的一部分。未经身份验证的攻击者可以利用此漏洞发送任意 HTTP 请求，绕过身份验证，并冒充管理员。该漏洞本身并不能直接导致 RCE，但可以与其他漏洞（如 CVE-2021-27065，一个身份验证后的任意文件写入漏洞）结合使用，最终实现远程代码执行。

**利用方式：**

1.  **SSRF（CVE-2021-26855）：**  攻击者利用 SSRF 漏洞发送精心构造的 HTTP 请求，绕过 Exchange Server 的身份验证。
2.  **身份验证绕过：**  成功利用 SSRF 后，攻击者可以获得 Exchange Server 的管理权限，无需提供有效的用户名和密码。
3.  **任意文件写入（CVE-2021-27065 或其他）：**  获得身份验证后，攻击者利用任意文件写入漏洞，将恶意代码写入 Exchange Server 的文件系统中。
4.  **代码执行：**  通过访问写入的恶意文件，攻击者可以在 Exchange Server 上执行任意命令，实现远程代码执行。

**有效性：**

提供的 Metasploit 模块 (`exchange_proxylogon.rb`) 是一个扫描器，用于检测目标 Exchange Server 是否存在 CVE-2021-26855 漏洞。它通过发送特定的 HTTP 请求来验证漏洞是否存在。如果扫描器检测到漏洞，则表明目标服务器容易受到 ProxyLogon 攻击。

**投毒风险：**

提供的代码主要是一个漏洞验证和扫描工具，没有明显的投毒代码。但任何来自外部的代码都存在一定的风险，所以投毒风险估计为5%。主要需要关注的是Metasploit模块中使用的HTTP请求的构造，以及是否会意外地对目标系统造成破坏。此外，攻击者可能会修改此模块以达到恶意目的，但在提供的代码本身中没有发现此类行为。

**项目地址:** [mekhalleh/exchange_proxylogon](https://github.com/mekhalleh/exchange_proxylogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #18

**来源**: [CVE-2021-26855-praetorian-inc_proxylogon-exploit.md](../2021/CVE-2021-26855-praetorian-inc_proxylogon-exploit.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，未经身份验证的攻击者可远程执行任意代码，完全控制 Exchange 服务器。

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2013 Cumulative Update 21/22/23，Microsoft Exchange Server 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19，Microsoft Exchange Server 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 攻击者需要能够访问 Exchange 服务器的端口（通常是 443）。该漏洞是 ProxyLogon 攻击链的一部分，通常与其他漏洞组合利用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞发送任意 HTTP 请求，并有可能绕过身份验证。根据搜索结果和漏洞信息，该漏洞是 ProxyLogon 攻击链的关键组成部分，攻击者可以使用它与其他漏洞（如 CVE-2021-27065）结合，最终在 Exchange 服务器上执行任意代码。提供的漏洞利用代码只包含 Apache License 2.0 协议，没有发现恶意代码，因此投毒风险极低。利用方式通常涉及：

1.  **SSRF 攻击:** 利用 CVE-2021-26855 发送恶意构造的 HTTP 请求到 Exchange 服务器后端。
2.  **身份验证绕过:** 通过 SSRF 漏洞，攻击者可以模拟管理员身份进行后续操作。
3.  **任意文件写入/代码执行:** 结合其他漏洞（如 CVE-2021-27065），攻击者可以将恶意代码写入 Exchange 服务器的文件系统，并最终执行任意代码。

 该漏洞已经被 CISA 加入到已知被利用漏洞目录 (KEV)，表明其在野外被广泛利用。

**项目地址:** [praetorian-inc/proxylogon-exploit](https://github.com/praetorian-inc/proxylogon-exploit)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #19

**来源**: [CVE-2021-26855-r0xdeadbeef_CVE-2021-26855.md](../2021/CVE-2021-26855-r0xdeadbeef_CVE-2021-26855.md)

## CVE-2021-26855 Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 受影响版本包括 Exchange Server 2013、2016 和 2019 的多个累积更新版本

**利用条件:** 目标Exchange服务器未安装相关安全更新，且攻击者能够访问Exchange服务器的443端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。攻击者可以利用此漏洞绕过身份验证，并发送任意 HTTP 请求，最终通过与其他漏洞（如 CVE-2021-27065）结合，实现远程代码执行。

**利用方式：**

1.  **SSRF (CVE-2021-26855)：** 利用 Autodiscover 协议的缺陷，发送特制的 HTTP 请求到 Exchange 服务器。由于服务器信任来自自身的请求，攻击者可以伪造请求，绕过身份验证。
2.  **获取 LegacyDN：** 通过 SSRF 漏洞，攻击者可以获取目标用户的 LegacyDN。 LegacyDN 是 Exchange 服务器中用户的唯一标识符。
3.  **伪造 MAPI 请求：**  使用获取的 LegacyDN，攻击者可以构造恶意的 MAPI (Messaging Application Programming Interface) 请求，并将其发送到 Exchange 服务器。
4.  **写入 Web Shell (CVE-2021-27065):** 攻击者利用后端组件的漏洞将webshell写入服务器，从而实现远程代码执行。
5.  **远程代码执行：** 成功写入webshell后，即可通过webshell执行任意代码，控制Exchange服务器。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，CVE-2021-26855 是一个经过广泛利用的漏洞，且存在公开的 PoC 代码。提供的 PoC 代码尝试模拟 ProxyLogon 漏洞链的利用过程，包括 SSRF、获取 LegacyDN、伪造 MAPI 请求和写入 Web Shell。根据PoC代码和搜索结果的描述，此POC代码可以实现远程代码执行，有效性较高，但是需要和其它漏洞配合利用，才能达成RCE。

**投毒风险分析：**

PoC 代码本身主要功能是进行漏洞验证和利用，直接植入恶意代码的概率较低。 但仍然存在一定的风险，例如：

*   **恶意代码混淆：** 攻击者可能将恶意代码隐藏在看似无害的字符串或函数中。
*   **依赖项投毒：** PoC 代码可能依赖于外部库或模块，如果这些依赖项被篡改，则可能引入恶意代码。

基于提供的代码，经过分析，判断投毒风险较低，但是仍然不能排除。该代码尝试利用漏洞，但是执行命令的部分是通过写入webshell实现的，增加webshell写入位置的随机性有可能被用于逃避检测，因此有一定的概率(10%)被用于投毒。

**项目地址:** [r0xdeadbeef/CVE-2021-26855](https://github.com/r0xdeadbeef/CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #20

**来源**: [CVE-2021-26855-shacojx_CVE-2021-26855-exploit-Exchange.md](../2021/CVE-2021-26855-shacojx_CVE-2021-26855-exploit-Exchange.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞（ProxyLogon）

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 受影响的Exchange Server 2013, 2016, 2019 Cumulative Updates

**利用条件:** 需要能够访问 Exchange Server 的 OWA 接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，是 ProxyLogon 攻击链的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求并作为 Exchange 服务器进行身份验证。从搜索引擎结果和漏洞库信息可以得知，这是一个被广泛利用的漏洞，存在公开的PoC，并且被CISA添加到已知被利用的漏洞目录中。 

**漏洞利用方式:**

1.  **SSRF (CVE-2021-26855):** 利用 SSRF 漏洞绕过身份验证。
2.  **构造请求:** 攻击者首先发送一个包含特定 Cookie 的 GET 请求，利用 SSRF 漏洞。
3.  **NTLM 认证:** 使用 NTLM 认证绕过。
4.  **获取 FQDN:** 通过 NTLM type2 协议获取服务器的 FQDN (Fully Qualified Domain Name)。
5.  **发送恶意 XML:** 构造恶意的 XML 数据，通过 POST 请求发送到 Exchange Web Services (EWS) 端点，利用后端组件处理 XML 时存在的漏洞执行任意代码。  
6.  **用户枚举:**  PoC 代码还包含用户枚举的功能，增加了攻击面。

**有效性：**

提供的 Go 代码是一个可用的 PoC。它包含了漏洞验证、NTLM 认证和发送恶意 XML 数据的步骤。代码结构清晰，逻辑完整，可以直接用于检测和利用该漏洞。

**投毒风险：**

虽然代码看起来主要实现了漏洞利用的功能，但仍存在一定投毒风险的可能性：
* 用户枚举模块可能被滥用，用于非法收集用户信息。
* 代码中存在一些硬编码的参数和路径，可能在特定环境下不可用，需要使用者修改，可能存在被诱导修改恶意代码。
* 风险评估为 10%，因为代码的主要功能是漏洞利用，而非恶意行为，但是存在被滥用和修改的潜在风险。

**项目地址:** [shacojx/CVE-2021-26855-exploit-Exchange](https://github.com/shacojx/CVE-2021-26855-exploit-Exchange)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #21

**来源**: [CVE-2021-26855-shacojx_Scan-Vuln-CVE-2021-26855.md](../2021/CVE-2021-26855-shacojx_Scan-Vuln-CVE-2021-26855.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要能够访问Exchange Server的端口，通常是443端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞发送任意 HTTP 请求并以 Exchange 服务器的身份进行身份验证，从而绕过身份验证。

**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码判断，该漏洞利用代码的有效性较高。大量的信息表明这是一个已知的、被广泛利用的漏洞，并且CISA已知可利用漏洞目录中包含了此漏洞。

**投毒风险：**
检视提供的代码，主要包含以下几个部分：
1.  `README.md`: 包含漏洞描述和图片。
2.  `build.xml`: Ant构建脚本，用于编译Java项目。
3.  `ipVuln.txt`: 空文件，可能用于存储易受攻击的IP地址列表。
4.  `list-ip.txt`: 包含一个IP地址（`192.168.1.0`），可能用于扫描。
5.  `manifest.mf`: JAR文件的清单文件。
6.  `Tool-Build/Run.bat`: 用于运行编译后的JAR文件的批处理脚本。
7.  `Tool-Build/ipVuln.txt`: 空文件，与上面的`ipVuln.txt`相同。
8.  `Tool-Build/list-ip.txt`: 包含一个IP地址（`192.168.1.0`），可能用于扫描，与上面的`list-ip.txt`相同。
9.  `Tool-Build/Nmap/scripts/http-vuln-cve2021-26855.nse`: Nmap脚本，用于检测目标是否受CVE-2021-26855漏洞影响。这个脚本是漏洞检测的核心。

主要风险点在于`build.xml`构建脚本和`http-vuln-cve2021-26855.nse`这个Nmap脚本。构建脚本可能被修改以包含恶意代码，虽然在这个例子中看起来比较简单，但无法完全排除隐蔽的后门代码存在的可能性。Nmap脚本本身看起来是合法的漏洞检测脚本，但理论上，如果脚本被篡改，可能存在投毒风险。例如，在检测到漏洞时，植入后门或执行恶意操作。
总体评估，投毒风险较低，约为10%，因为主要的代码功能是漏洞扫描，而不是漏洞利用，且代码量不大，容易审计。

**利用方式：**
利用方式通常涉及以下步骤：
1.  **SSRF:** 攻击者利用SSRF漏洞向Exchange服务器发送精心构造的HTTP请求。
2.  **身份验证绕过：** 通过SSRF漏洞，攻击者可以绕过身份验证，模拟Exchange服务器上的其他用户。
3.  **远程代码执行：** 在成功绕过身份验证后，攻击者可以进一步利用其他漏洞（如不安全的deserialization）来执行任意代码。根据搜索引擎结果，CVE-2021-26855是ProxyLogon攻击链的初始漏洞。

综上所述，此漏洞的有效性高，利用方式较为明确，但提供的代码主要用于扫描而非直接利用，因此投毒风险较低。攻击者可以通过SSRF漏洞绕过身份验证，然后利用其他漏洞实现远程代码执行。

**项目地址:** [shacojx/Scan-Vuln-CVE-2021-26855](https://github.com/shacojx/Scan-Vuln-CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #22

**来源**: [CVE-2021-26855-ssrsec_Microsoft-Exchange-RCE.md](../2021/CVE-2021-26855-ssrsec_Microsoft-Exchange-RCE.md)

## CVE-2021-26855 & CVE-2021-27065 - Microsoft Exchange Server RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要能够访问目标 Exchange 服务器的网络端口 (通常是443)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞利用链包括 CVE-2021-26855 (SSRF) 和 CVE-2021-27065 (不安全的反序列化导致RCE)。

**利用方式：**

1.  **SSRF (CVE-2021-26855):** 利用服务器端请求伪造漏洞，攻击者可以发送任意HTTP请求并伪装成Exchange服务器进行身份验证。POC代码首先发送一个NTLM协商请求到`/rpc/`端点，利用返回的`WWW-Authenticate`头中的信息来获取目标Exchange服务器的计算机名和域名。
2.  **RCE (CVE-2021-27065):** 利用获取的计算机名，结合一个已知的邮箱地址格式，构造一个包含`LegacyDN`的请求，发送到`/ecp/baba.js`，最终通过写入webshell来实现远程代码执行。其中，`baba.js`是一个占位符，攻击者可以通过修改这个值，上传任意的webshell。

**有效性：**

根据提供的漏洞信息、搜索结果以及POC代码，可以判断此POC代码是有效的，该漏洞利用是公开的，影响范围广泛。搜索结果也表明该漏洞已被广泛利用。

**投毒风险：**

代码主要功能是利用漏洞，但存在潜在的投毒风险。风险点在于：

*   **Webshell 内容：** Webshell的内容（`<script language="JScript" runat="server">function Page_Load(){eval(Request["babanb"],"unsafe");}</script>`）是固定的，攻击者可能会修改这个内容，植入恶意代码，或者植入更加隐蔽的后门。目前是直接在ecp目录下写了baba.js的文件,比较容易被发现。
*   **依赖项风险：**虽然代码量少，但仍然可能引入有安全风险的第三方库，虽然这里没有体现。
*  **邮件用户列表:** 代码中使用了一个邮件用户列表进行尝试。这个列表可能被修改，用于针对特定目标进行攻击，或者用于搜集敏感信息。

虽然存在风险，但整体代码逻辑较为清晰，风险较低。投毒风险评估为10%。

**项目地址:** [ssrsec/Microsoft-Exchange-RCE](https://github.com/ssrsec/Microsoft-Exchange-RCE)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #23

**来源**: [CVE-2021-26855-thau0x01_poc_proxylogon.md](../2021/CVE-2021-26855-thau0x01_poc_proxylogon.md)

## CVE-2021-26855 Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 受影响的版本包括：Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange Server开放443端口，且未安装相关安全补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 (ProxyLogon) 是一种存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞。未经身份验证的远程攻击者可以通过发送精心构造的 HTTP 请求来利用此漏洞，从而能够伪造身份并执行其他恶意操作。从搜索结果来看，该漏洞被广泛利用。提供的PoC代码展示了利用该漏洞获取远程代码执行权限的过程。

**漏洞利用方式：**

1.  **SSRF (CVE-2021-26855):** 首先，利用SSRF漏洞发送任意HTTP请求，目的是绕过身份验证，获取有效的LegacyDN。
2.  **获取 LegacyDN:** 通过构造Autodiscover请求，获取目标用户的 LegacyDN。
3.  **MAPI 连接:** 使用获取的LegacyDN建立一个MAPI会话。
4.  **获取 SID:** 从MAPI响应中提取用户的安全标识符 (SID)。
5.  **ProxyLogon:** 利用ProxyLogon机制，将用户SID修改为管理员SID，从而提升权限。
6.  **写入 Webshell:** 利用提升的权限，向服务器写入webshell，实现远程代码执行。

**投毒风险分析：**

代码中存在以下潜在的投毒风险：

*   **硬编码的路径和文件名：** `shell_path`和`shell_absolute_path`以及`ahihi7.aspx`是硬编码的，这使得webshell容易被检测和移除，但如果攻击者修改了这些值，可能会将webshell写入到更隐蔽的位置。
*   **webshell 内容：** `shell_content`包含执行 `whoami` 命令的JavaScript代码，这是一个简单的测试命令。攻击者可以修改`shell_content`以执行更具破坏性的操作。虽然当前代码只是执行`whoami`，但不能排除攻击者将恶意代码注入`shell_content`的可能性。这一部分存在被恶意修改进行投毒的可能性。
*   **代理URI (`msExchProxyUri`)**: PoC代码中 `msExchProxyUri` 设置为`http://127.0.0.1:8080/`，这意味着攻击者可能尝试通过本地代理进行其他攻击，或者将流量转发到恶意服务器。虽然现在指向本地，但存在被修改指向恶意地址的可能性。

虽然这些风险存在，但整体代码看起来是为了验证漏洞，主要的目的是为了RCE，没有明显的隐藏后门或者其他恶意行为。因此，投毒风险较低, 约5%。

**项目地址:** [thau0x01/poc_proxylogon](https://github.com/thau0x01/poc_proxylogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #24

**来源**: [CVE-2021-26855-timb-machine-mirrors_testanull-CVE-2021-26855_read_poc.txt.md](../2021/CVE-2021-26855-timb-machine-mirrors_testanull-CVE-2021-26855_read_poc.txt.md)

## CVE-2021-26855-Microsoft Exchange Server-SSRF

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造（SSRF）漏洞。根据搜索结果和漏洞描述，未经验证的远程攻击者可以利用此漏洞发送任意 HTTP 请求并模拟 Exchange 服务器进行身份验证。该漏洞是 ProxyLogon 攻击链的关键组成部分。提供的POC代码尝试通过 `POST /ecp/poc-2021-26855.js HTTP/1.1` 发送 SOAP 请求，通过修改 `X-BEResource` cookie 绕过身份验证，进而执行其他操作。由于请求的目标是 EWS (Exchange Web Services)，这允许攻击者访问和操作邮箱数据。分析代码中,没有发现作者隐藏的投毒代码。

**利用方式：**

1.  **SSRF 攻击：** 利用 CVE-2021-26855，攻击者可以向 Exchange 服务器发送伪造的 HTTP 请求。
2.  **身份验证绕过：** 通过操纵 `X-BEResource` cookie，攻击者可以绕过身份验证，冒充合法用户。
3.  **邮箱访问：** 一旦成功绕过身份验证，攻击者可以使用 EWS 接口访问和操作邮箱数据，例如读取邮件、联系人等。
4.  **链式利用：** CVE-2021-26855 通常与其他 Exchange 漏洞（如 CVE-2021-26857、CVE-2021-26858、CVE-2021-27065）结合使用，形成 ProxyLogon 攻击链，最终实现远程代码执行。

**项目地址:** [timb-machine-mirrors/testanull-CVE-2021-26855_read_poc.txt](https://github.com/timb-machine-mirrors/testanull-CVE-2021-26855_read_poc.txt)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #25

**来源**: [CVE-2021-26855-yaoxiaoangry3_Flangvik.md](../2021/CVE-2021-26855-yaoxiaoangry3_Flangvik.md)

## CVE-2021-26855 Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Microsoft Exchange Server 2013、2016 和 2019 的多个累积更新版本，具体版本参见漏洞库信息

**利用条件:** 目标Exchange服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求并可能绕过身份验证。

**有效性分析：**
根据提供的漏洞库信息，此漏洞影响多个版本的 Microsoft Exchange Server，CVSS 评分为 9.1，表明其严重性。
搜索结果显示，此漏洞被广泛利用，并且有公开的 PoC 可用，参考网页标题包含"ProxyLogon"的网页信息可以知道。
提供的漏洞利用代码描述表明它是一个 C# PoC，支持半交互式的 web shell 以及 shellcode 执行。
综合来看，提供的 POC 代码是有效的。

**投毒风险分析：**
提供的代码片段 `/tmp/e24bb8b01b99c84300e1ac6fb58f9709/README.md` 只显示了关于 PoC 的简短描述，无法直接判断是否存在投毒代码。由于是 C# PoC，投毒代码可能隐藏在编译后的二进制文件中。仅仅通过 README.md 文件判断，存在误判可能性，但是根据以往经验，开源社区存在一定的投毒行为，因此给出一定百分比。

**利用方式分析：**
1.  利用 CVE-2021-26855 的 SSRF 漏洞，攻击者可以绕过身份验证。
2.  成功绕过身份验证后，攻击者可以利用后续漏洞（例如 CVE-2021-26857）写入任意文件。
3.  写入的文件可以是一个 ASPX web shell，允许攻击者执行任意代码。
4.  或者，攻击者可以使用 shellcode 直接在服务器上执行恶意代码。
该漏洞是 ProxyLogon 攻击链的初始入口点，为后续攻击铺平道路。

**项目地址:** [yaoxiaoangry3/Flangvik](https://github.com/yaoxiaoangry3/Flangvik)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---



---

## POC #7

**来源**: [CVE-2021-26855-ShyTangerine_cve-2021-26855.md](../2021/CVE-2021-26855-ShyTangerine_cve-2021-26855.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Exchange Server 2013、2016 和 2019 的多个累积更新版本，详见漏洞库信息

**利用条件:** 需要能够访问 Exchange Server 的 ECP 接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。未授权的攻击者可以利用此漏洞发送任意 HTTP 请求并进行身份验证，绕过身份验证，最终导致远程代码执行。

**利用方式：**

根据提供的漏洞利用代码，利用过程大致如下：

1.  **初始请求：** 向 `/ecp/x.png` 发送 GET 请求，尝试获取 `X-BEResource` Cookie。
2.  **获取 DN 值：** 通过向 `/ecp/x.png` 发送包含特定 XML 内容的 POST 请求，利用 Autodiscover 服务获取用户的 DN (Distinguished Name)。
3.  **Mapi/Emsmdb 连接：** 使用获取的 DN 值，向 `/ecp/x.png` 发送包含 `X-BEResource`、`X-Clientinfo` 等头的 POST 请求，尝试建立 MAPI over HTTP 连接。
4.  **获取 Session 和 msExchEcpCanary：** 通过向 `/ecp/x.png` 发送包含特定 XML 内容的 POST 请求，利用 Negotiate 协议获取 ASP.NET Session ID 和 `msExchEcpCanary` 值。`msExchEcpCanary` 是一个安全令牌，用于防止跨站请求伪造 (CSRF) 攻击。
5.  **获取 OAB ID：** 发送包含`msExchEcpCanary` 和 Session ID 到`/ecp/x.png`，获取OAB id，为下一步写入恶意代码作准备

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞确实存在且已被积极利用。该 POC 代码展示了漏洞利用的关键步骤，例如如何绕过身份验证、如何获取必要的凭据信息等。该漏洞利用的有效性较高。

**投毒风险：**

评估提供的 POC 代码，存在一定投毒风险，10%。 风险点主要在于：

*   **硬编码的 IP 地址和域名：** POC 代码中包含硬编码的 IP 地址 (例如 `10.255.200.20`, `192.168.170.134`) 和域名 (`EXCHANGE01.xihongdream.com`)。如果用户直接使用这些硬编码的值，可能会将攻击流量导向作者控制的服务器，从而暴露目标服务器的信息或被用于进一步的攻击。

*   **潜在的后门植入：** 虽然 POC 代码的主要目的是演示漏洞利用过程，但作者有可能在代码中插入后门，例如，在OAB操作中，写入恶意脚本到目标服务器，长期控制目标系统。

总的来说，该 POC 代码主要演示了 SSRF 的利用方式。用户在使用时应谨慎，务必修改代码中的硬编码值，避免潜在的投毒风险。

**项目地址:** [ShyTangerine/cve-2021-26855](https://github.com/ShyTangerine/cve-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #8

**来源**: [CVE-2021-26855-TheDudeD6_ExchangeSmash.md](../2021/CVE-2021-26855-TheDudeD6_ExchangeSmash.md)

## CVE-2021-26855-Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器可访问，且未安装相关安全更新。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，是 ProxyLogon 攻击链的一部分。未经身份验证的攻击者可以利用此漏洞发送任意 HTTP 请求并冒充管理员进行身份验证，最终造成远程代码执行。

**利用方式：**

1.  **SSRF（CVE-2021-26855）：** 攻击者首先利用 SSRF 漏洞绕过身份验证，获取合法的身份。
2.  **获取SID：** 使用合法的身份，获取用户的SID
3.  **伪造管理员 SID：** 通过篡改已泄露的用户SID，伪造管理员SID
4.  **ProxyLogon：** 使用伪造的管理员 SID 通过 ProxyLogon 攻击链，获得管理员权限。
5.  **写入webshell：** 利用管理员权限，在目标服务器上写入 webshell。
6.  **远程代码执行：** 通过访问 webshell 执行任意代码。

**投毒风险：**
查看提供的POC代码，发现其功能是利用漏洞，在正常情况下，不应存在恶意代码。但是，由于代码逻辑复杂，且依赖外部库（Impacket），存在作者在代码中植入恶意逻辑的可能性。另外，通过分析发现proxylogon.py中的shell_src变量可以自定义，如果被替换成恶意payload，则存在一定风险。

综合考虑，投毒风险评估为10%，主要风险在于代码的可信度以及shell_src变量的替换。

**项目地址:** [TheDudeD6/ExchangeSmash](https://github.com/TheDudeD6/ExchangeSmash)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #9

**来源**: [CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855.md](../2021/CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF to RCE (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** SSRF (Server-Side Request Forgery) -> RCE (Remote Code Execution)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器可以从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 存在于 Microsoft Exchange Server 中，是一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞。

**利用方式：**

1.  **SSRF：** 攻击者利用SSRF漏洞，通过构造恶意的 HTTP 请求，绕过身份验证。
2.  **获取 LegacyDN：** 利用 SSRF 漏洞，向 Exchange 服务器的 autodiscover 端点发送请求，获取目标用户的 LegacyDN。
3.  **MAPI 连接：** 使用获得的 LegacyDN 建立 MAPI 连接。
4.  **获取 SID：** 从 MAPI 响应中提取用户的 SID。
5.  **ProxyLogon：** 利用 SID 伪造身份，通过 proxyLogon.ecp 端点进行身份验证绕过。
6.  **写入 Webshell：** 成功绕过身份验证后，攻击者可以将恶意的 webshell 写入到 Exchange 服务器的 OWA 目录中。
7.  **远程代码执行：** 攻击者通过访问写入的 webshell，执行任意代码。

**有效性评估：**

提供的 POC 代码 `ExchangeSheller.py` 实现了上述利用流程，能够自动化利用 CVE-2021-26855 漏洞，因此是有效的。

**投毒风险分析：**

代码本身执行的是漏洞利用流程，主要功能为利用 SSRF 漏洞并最终写入 Webshell。但需要注意以下几点：

*   **代码来源：** 代码来自 GitHub，需要验证其作者的信誉和代码的完整性。
*   **Webshell 内容：** Webshell 的内容可控，攻击者可以修改 webshell 的内容，使其执行恶意操作，如植入后门、窃取数据等。
*   **隐藏指令：** 理论上，eval 函数中可以嵌入隐蔽的恶意代码，但这需要仔细分析 `ExchangeSheller.py` 文件，当前判断该风险较低。

**结论：**

该漏洞利用的有效性高。存在一定的投毒风险，主要体现在攻击者可能会修改webshell的内容，但总体来说代码的结构和逻辑清晰，投毒风险较低，估计在5%。务必在隔离环境下进行测试，并对生成的 webshell 进行安全审计。

**项目地址:** [ZephrFish/Exch-CVE-2021-26855](https://github.com/ZephrFish/Exch-CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #10

**来源**: [CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855_Priv.md](../2021/CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855_Priv.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的 Exchange 服务器上执行任意代码。

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21/22/23, 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19, 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 目标Exchange服务器存在漏洞且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 攻击链的一部分。未经身份验证的攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成管理员进行身份验证，然后结合其他漏洞（例如 CVE-2021-27065）来写入任意文件，最终实现远程代码执行。

**漏洞利用方式：**

1.  **SSRF (CVE-2021-26855):** 攻击者利用 SSRF 漏洞，通过构造特殊的 URL 和请求头，绕过身份验证，获取 Exchange 服务器的访问权限。
2.  **获取 LegacyDN：** 利用 Autodiscover 服务获取目标用户的 LegacyDN。
3.  **MAPI 连接：** 使用获取的 LegacyDN 建立 MAPI 连接。
4.  **ProxyLogon:** 通过构造 ProxyLogon 请求，伪装成管理员身份。
5.  **写入 Webshell (CVE-2021-27065，虽然POC未直接体现，但通常会结合使用):** 在成功通过身份验证后，利用漏洞在 Exchange 服务器的 OWA 目录下写入恶意的 Webshell 文件，该文件包含可以执行任意代码的 JScript 代码。
6.  **远程代码执行：** 攻击者通过访问 Webshell 文件，执行任意代码。

**有效性：**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞利用代码是有效的，因为它再现了 ProxyLogon 攻击链的关键步骤，包括 SSRF、权限提升和 webshell 写入 (webshell 内容在代码中已经存在)。搜索引擎结果中也表明 CVE-2021-26855 被积极利用。

**投毒风险：**

分析提供的 POC 代码，未发现明显的投毒代码。代码逻辑主要集中在利用 SSRF 漏洞进行身份验证绕过，并最终部署 webshell。虽然 webshell 本身是一种恶意代码，但这是漏洞利用的必要步骤，而非作者有意添加的恶意功能。因此，判定投毒风险为0%。

**项目地址:** [ZephrFish/Exch-CVE-2021-26855_Priv](https://github.com/ZephrFish/Exch-CVE-2021-26855_Priv)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #11

**来源**: [CVE-2021-26855-dwisiswant0_proxylogscan.md](../2021/CVE-2021-26855-dwisiswant0_proxylogscan.md)

## CVE-2021-26855 Microsoft Exchange Server SSRF 漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** Exchange 2013 Versions < 15.00.1497.012, Exchange 2016 CU18 < 15.01.2106.013, Exchange 2016 CU19 < 15.01.2176.009, Exchange 2019 CU7 < 15.02.0721.013, Exchange 2019 CU8 < 15.02.0792.010

**利用条件:** 需要能够访问存在漏洞的 Exchange Server 的网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而冒充管理员身份。该漏洞是 ProxyLogon 攻击链的一部分，与 CVE-2021-27065 (身份验证后任意文件写入漏洞) 结合使用，可以实现远程代码执行。

**漏洞利用方式：**

1.  攻击者利用 CVE-2021-26855，发送特制的 HTTP 请求到 Exchange Server，绕过身份验证并获得管理员权限。
2.  利用获得的管理员权限，攻击者可以进一步利用 CVE-2021-27065 将恶意代码写入服务器。
3.  执行写入的恶意代码，最终实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码 `proxylogscan` 是一个 Go 语言编写的工具，用于大规模扫描存在 CVE-2021-26855 漏洞的 Microsoft Exchange Server。它通过发送特定的 HTTP 请求来检测目标服务器是否存在漏洞。

**投毒风险分析：**

代码主要功能是扫描漏洞，用于检测目标是否存在漏洞。 考虑到工具的用途和代码的简洁性，投毒的可能性较低，但是需要对代码进行仔细的审查，特别是涉及网络请求的部分，以确保没有隐藏的恶意逻辑。 投毒的可能性较低，但是依然存在一定的风险。代码使用go get安装，存在一定的依赖风险,需要注意.


**项目地址:** [dwisiswant0/proxylogscan](https://github.com/dwisiswant0/proxylogscan)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #12

**来源**: [CVE-2021-26855-glen-pearson_ProxyLogon-CVE-2021-26855.md](../2021/CVE-2021-26855-glen-pearson_ProxyLogon-CVE-2021-26855.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞 (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，未经验证的远程攻击者可以利用此漏洞在受影响的系统上执行任意代码

**影响版本:** 受影响版本包括 Exchange Server 2013 Cumulative Update 22 和 23, Exchange Server 2016 Cumulative Update 12-19, Exchange Server 2019 Cumulative Update 1-8

**利用条件:** 目标系统存在未修补的 Exchange Server 实例，攻击者需要能够通过网络访问 Exchange 服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成 Exchange 服务器进行身份验证，为后续利用其他漏洞（例如 CVE-2021-26857）创造条件。漏洞利用链通常涉及以下步骤：

1.  **SSRF (CVE-2021-26855):** 利用 SSRF 漏洞绕过身份验证，获取 Exchange 服务器的权限。
2.  **不安全的反序列化:** 通过 SSRF 漏洞获取的权限，进一步利用不安全的反序列化漏洞（例如 CVE-2021-26854, CVE-2021-26857, CVE-2021-27065）执行任意代码。

提供的 PoC 代码是一个修改后的 ProxyLogon 漏洞利用脚本，它利用 CVE-2021-26855 绕过身份验证，然后在服务器上创建一个后门 Web shell。具体流程如下：

1.  **自动发现 (Autodiscover):** 使用 Autodiscover 协议获取 LegacyDN。
2.  **MAPI 连接:** 使用获取的 LegacyDN 建立 MAPI 连接，模拟管理员权限。
3.  **Web Shell 写入:**  将包含反向 shell 代码的 aspx Web shell 写入到服务器的 `Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\test11.aspx` 路径。
4.  **执行 Web Shell:** 攻击者可以通过访问该 Web shell 执行任意命令。该 Web shell 执行 Powershell 命令，建立一个反向 TCP 连接到攻击者的指定 IP 地址和端口。 

**有效性：** 该 PoC 代码有效，因为它实现了 ProxyLogon 漏洞利用，并成功创建反向 shell，证明了远程代码执行。

**投毒风险：** 存在一定的投毒风险。作者在原始PoC基础上修改了代码，增加了创建用户和反向shell的功能，该行为可能被攻击者利用，如果攻击者修改了反向shell中的IP地址和端口，则使用者在不知情的情况下连接到攻击者的服务器，所以存在投毒风险。 风险大约在10%。

**利用方式：** 攻击者首先利用 CVE-2021-26855 漏洞绕过身份验证，获取 Exchange 服务器的权限，然后通过写入 Web shell 执行任意代码。这个 Web shell 会连接到攻击者控制的服务器，从而允许攻击者完全控制受感染的 Exchange 服务器。

**项目地址:** [glen-pearson/ProxyLogon-CVE-2021-26855](https://github.com/glen-pearson/ProxyLogon-CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #13

**来源**: [CVE-2021-26855-hakivvi_proxylogon.md](../2021/CVE-2021-26855-hakivvi_proxylogon.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全控制受影响的Exchange服务器

**影响版本:** 受影响版本包括 Exchange Server 2013 Cumulative Update 21/22/23, Exchange Server 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19, Exchange Server 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 需要能够访问Exchange服务器的网络，并且服务器存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。结合其他漏洞（如CVE-2021-27065），未经身份验证的远程攻击者可以利用此漏洞发送任意 HTTP 请求并以管理员身份通过身份验证，最终实现远程代码执行。 

**利用方式：**

1.  **SSRF (CVE-2021-26855):** 攻击者首先利用 SSRF 漏洞伪造 HTTP 请求，绕过身份验证。
2.  **管理员权限获取:** 利用伪造的请求，攻击者可以获得 Exchange 服务器的管理员权限。
3.  **OAB虚拟目录操作:** 修改OAB (Offline Address Book)虚拟目录的ExternalUrl参数，将shell地址写入。
4.  **Shell 写入:** 通过修改的ExternalUrl，攻击者将一个 ASPX webshell 写入到 Exchange 服务器的 web 可访问目录（通常是`C:\inetpub\wwwroot\aspnet_client\`）。 
5.  **远程代码执行:** 攻击者可以通过访问 webshell 的 URL 并发送特定的请求参数来执行任意代码。

**代码分析与投毒风险评估：**

提供的POC代码 `proxylogon.py` 实现了上述的攻击流程。代码首先利用 SSRF 获取服务器的计算机名，然后利用 NTLM 认证绕过。之后，它利用获取的管理员权限，通过修改 OAB 虚拟目录来写入 webshell。最后，代码输出 webshell 的 URL，攻击者可以通过该 URL 执行任意命令。

**投毒风险分析:**  POC代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **后门植入:** 虽然主要的目的是利用漏洞进行RCE，恶意攻击者可能会在脚本中添加额外的后门代码，例如，在写入的 webshell 中添加额外的功能，以便在将来保持对服务器的访问。
*   **信息收集:**  攻击者可以修改脚本来收集目标服务器上的敏感信息，例如，用户名、密码哈希、以及其他配置信息。
*   **恶意传播:**  如果攻击者控制了多个 Exchange 服务器，他们可以修改脚本来自动传播恶意软件到其他服务器。
*   **依赖库风险：**POC依赖Impacket库，如果Impacket库本身被篡改或包含恶意代码，那么使用此POC也会受到影响。

尽管存在这些风险，但就提供的代码片段本身而言，没有明显的恶意代码。风险主要在于该漏洞本身带来的权限和潜在的恶意修改行为。POC中生成随机字符串的部分(gen())是为了避免文件名冲突，本身不是恶意行为。利用OABVirtualDirectory修改ExternalUrl以及ResetOABVirtualDirectory修改FilePathName的行为是为了webshell的写入，这是漏洞利用的一部分。

**总结:** 该漏洞利用链的有效性较高，因为 CVE-2021-26855 是 ProxyLogon 攻击链的关键组成部分，被广泛利用。 投毒风险主要来自于利用此漏洞成功入侵后的恶意行为，而非POC代码本身。由于代码中包含webshell的部署，存在一定风险，但直接判定为投毒不严谨，结合分析结果，投毒风险预估为10%。

**项目地址:** [hakivvi/proxylogon](https://github.com/hakivvi/proxylogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #14

**来源**: [CVE-2021-26855-hictf_CVE-2021-26855-CVE-2021-27065.md](../2021/CVE-2021-26855-hictf_CVE-2021-26855-CVE-2021-27065.md)

## CVE-2021-26855 Microsoft Exchange Server SSRF 远程代码执行漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** SSRF (服务器端请求伪造) -> 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器对外开放，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个 SSRF 漏洞。根据搜索结果，攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成 Exchange 服务器进行身份验证。该漏洞是 ProxyLogon 攻击链中的一部分，攻击者利用该漏洞可以绕过身份验证，并结合其他漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者利用 CVE-2021-26855 漏洞发送恶意构造的 HTTP 请求到 Exchange 服务器。
2.  通过 SSRF 漏洞，攻击者可以伪装成 Exchange 服务器进行身份验证，绕过身份验证机制。
3.  绕过身份验证后，攻击者可以利用其他漏洞（例如 CVE-2021-27065，反序列化漏洞）在 Exchange 服务器上执行任意代码。

**POC有效性分析：**

提供的 POC 代码包含一个简单的 PHP 文件（hello world），一个 README 文件，一个简单的 Node.js 服务器 (demo.js) 和一个 package.json 文件。这些代码片段本身并不能直接利用 CVE-2021-26855。它们更像是用于搭建一个基础的web服务器环境，可能用于验证漏洞利用的某些步骤或作为最终执行的payload的一部分。因此，单独来看，提供的POC代码**无效**，它只是利用整个漏洞链中的一小部分。

**投毒风险分析：**

提供的 POC 代码较为简单，没有明显的恶意代码。`demo.js` 只是一个简单的 HTTP 服务器，`1.php` 只是输出 "hello world"。但是，考虑到这是一个 Exchange 漏洞的 POC，攻击者可能会在更复杂的利用链中利用这些文件，例如将 `1.php` 作为 Webshell 上传到服务器，或者利用 `demo.js` 搭建一个用于接收反弹 shell 的服务器。 因此，存在一定的投毒风险，但风险主要在于利用方式的组合，而非代码本身存在后门。

**投毒风险评估：**

由于代码功能简单，直接投毒的可能性较低，但作为漏洞利用链的一部分，可能被用于执行恶意操作，因此投毒风险评定为 **20%**。

**项目地址:** [hictf/CVE-2021-26855-CVE-2021-27065](https://github.com/hictf/CVE-2021-26855-CVE-2021-27065)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #15

**来源**: [CVE-2021-26855-hosch3n_ProxyVulns.md](../2021/CVE-2021-26855-hosch3n_ProxyVulns.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，无需身份验证即可远程代码执行

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 22, 23; 2016 Cumulative Update 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19; 2019 Cumulative Update 1, 2, 3, 4, 5, 6, 7, 8

**利用条件:** Exchange Server对外开放443端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造（SSRF）漏洞，它允许未经身份验证的攻击者发送任意 HTTP 请求并伪装成 Exchange 服务器的管理员。此漏洞是 ProxyLogon 攻击链的入口点，后续可以配合其他漏洞实现远程代码执行。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用是有效的。搜索引擎结果中许多链接都表明 CVE-2021-26855 已被积极利用。漏洞利用代码 `26855.py` 实现了利用该漏洞的步骤，包括：

1.  **SSRF 探测：** 通过构造特殊的 `X-BEResource` 请求头，获取 Exchange 后端服务器的计算机名和域名。
2.  **LegacyDN 获取：** 利用 Autodiscover 服务，通过提供用户邮箱地址获取 LegacyDN。
3.  **SID 欺骗：** 伪造 MAPI 请求，通过 LegacyDN 获取用户的 SID。
4.  **ProxyLogon 利用：** 利用获取到的 SID，通过 `proxyLogon.ecp` 绕过身份验证。
5.  **Webshell 部署：** 写入 Webshell 到服务器。

**投毒风险分析：**
漏洞利用代码中存在较低的投毒风险 (大约 5%)。虽然代码的目的是利用漏洞，但攻击者可能在 `webshell_content` 中植入恶意代码，或者修改 `webshell_path` 将webshell写入到不常见的位置，使得后期的权限维持或者横向移动更加隐蔽。例如，如果`webshell_content`包含下载和执行其他恶意文件的指令，这就是一种投毒行为。 目前提供的webshell代码较为简单，判定投毒的概率较低。

**利用方式总结：**
1.  攻击者首先利用 SSRF 漏洞 (CVE-2021-26855) 绕过身份验证。
2.  攻击者通过构造恶意的 HTTP 请求，欺骗 Exchange 服务器，使其认为攻击者已通过身份验证。
3.  成功绕过身份验证后，攻击者可以使用其他漏洞（例如 CVE-2021-27065，写入任意文件）在 Exchange 服务器上执行任意代码，部署 Webshell。
4.  攻击者通过 Webshell 执行系统命令，控制 Exchange 服务器。

**项目地址:** [hosch3n/ProxyVulns](https://github.com/hosch3n/ProxyVulns)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #16

**来源**: [CVE-2021-26855-kh4sh3i_ProxyLogon.md](../2021/CVE-2021-26855-kh4sh3i_ProxyLogon.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF/RCE (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，未经验证的远程攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**影响版本:** 受影响版本包括Exchange Server 2013、2016和2019的多个累积更新。

**利用条件:** 需要目标Exchange服务器存在漏洞版本，且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，它是 ProxyLogon 漏洞链中的第一个环节。攻击者可以利用此漏洞发送任意 HTTP 请求并作为 Exchange 服务器进行身份验证。根据搜索结果，此漏洞与其他漏洞（如 CVE-2021-26857、CVE-2021-26858 和 CVE-2021-27065）结合使用，可以实现未经身份验证的远程代码执行。利用方式通常涉及：

1.  **SSRF（CVE-2021-26855）：** 利用 SSRF 漏洞冒充 Exchange 服务器进行身份验证。
2.  **身份验证绕过：** 绕过身份验证后，攻击者可以访问受保护的 Exchange 后端资源。
3.  **任意文件写入/反序列化/RCE：** 利用其他漏洞（例如，通过修改虚拟目录或写入Web shell）在服务器上执行任意代码。

提供的漏洞利用代码仅包含一个 Creative Commons 许可证，本身不包含任何利用代码或恶意代码，因此不存在投毒风险。但实际利用时，攻击者需要结合其他漏洞利用工具和payload才能实现最终的远程代码执行。

**漏洞利用有效性评估：**
根据漏洞库信息和搜索结果，CVE-2021-26855 是一个已知的、被广泛利用的漏洞。存在公开可用的漏洞利用代码（虽然这里没有直接提供，但搜索结果表明存在）。此漏洞被 CISA 列入已知被利用的漏洞目录中，表明该漏洞在野外已被积极利用。

**总结：**
CVE-2021-26855 是一个高危漏洞，允许未经身份验证的攻击者利用 Exchange 服务器执行 SSRF 攻击，为后续的远程代码执行铺平道路。务必尽快应用 Microsoft 提供的安全更新。

**项目地址:** [kh4sh3i/ProxyLogon](https://github.com/kh4sh3i/ProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #17

**来源**: [CVE-2021-26855-mekhalleh_exchange_proxylogon.md](../2021/CVE-2021-26855-mekhalleh_exchange_proxylogon.md)

## CVE-2021-26855 Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** Exchange 2013 Versions < 15.00.1497.012, Exchange 2016 CU18 < 15.01.2106.013, Exchange 2016 CU19 < 15.01.2176.009, Exchange 2019 CU7 < 15.02.0721.013, Exchange 2019 CU8 < 15.02.0792.010

**利用条件:** 目标 Exchange Server 必须可从网络访问,且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 攻击链的一部分。未经身份验证的攻击者可以利用此漏洞发送任意 HTTP 请求，绕过身份验证，并冒充管理员。该漏洞本身并不能直接导致 RCE，但可以与其他漏洞（如 CVE-2021-27065，一个身份验证后的任意文件写入漏洞）结合使用，最终实现远程代码执行。

**利用方式：**

1.  **SSRF（CVE-2021-26855）：**  攻击者利用 SSRF 漏洞发送精心构造的 HTTP 请求，绕过 Exchange Server 的身份验证。
2.  **身份验证绕过：**  成功利用 SSRF 后，攻击者可以获得 Exchange Server 的管理权限，无需提供有效的用户名和密码。
3.  **任意文件写入（CVE-2021-27065 或其他）：**  获得身份验证后，攻击者利用任意文件写入漏洞，将恶意代码写入 Exchange Server 的文件系统中。
4.  **代码执行：**  通过访问写入的恶意文件，攻击者可以在 Exchange Server 上执行任意命令，实现远程代码执行。

**有效性：**

提供的 Metasploit 模块 (`exchange_proxylogon.rb`) 是一个扫描器，用于检测目标 Exchange Server 是否存在 CVE-2021-26855 漏洞。它通过发送特定的 HTTP 请求来验证漏洞是否存在。如果扫描器检测到漏洞，则表明目标服务器容易受到 ProxyLogon 攻击。

**投毒风险：**

提供的代码主要是一个漏洞验证和扫描工具，没有明显的投毒代码。但任何来自外部的代码都存在一定的风险，所以投毒风险估计为5%。主要需要关注的是Metasploit模块中使用的HTTP请求的构造，以及是否会意外地对目标系统造成破坏。此外，攻击者可能会修改此模块以达到恶意目的，但在提供的代码本身中没有发现此类行为。

**项目地址:** [mekhalleh/exchange_proxylogon](https://github.com/mekhalleh/exchange_proxylogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #18

**来源**: [CVE-2021-26855-praetorian-inc_proxylogon-exploit.md](../2021/CVE-2021-26855-praetorian-inc_proxylogon-exploit.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，未经身份验证的攻击者可远程执行任意代码，完全控制 Exchange 服务器。

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2013 Cumulative Update 21/22/23，Microsoft Exchange Server 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19，Microsoft Exchange Server 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 攻击者需要能够访问 Exchange 服务器的端口（通常是 443）。该漏洞是 ProxyLogon 攻击链的一部分，通常与其他漏洞组合利用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞发送任意 HTTP 请求，并有可能绕过身份验证。根据搜索结果和漏洞信息，该漏洞是 ProxyLogon 攻击链的关键组成部分，攻击者可以使用它与其他漏洞（如 CVE-2021-27065）结合，最终在 Exchange 服务器上执行任意代码。提供的漏洞利用代码只包含 Apache License 2.0 协议，没有发现恶意代码，因此投毒风险极低。利用方式通常涉及：

1.  **SSRF 攻击:** 利用 CVE-2021-26855 发送恶意构造的 HTTP 请求到 Exchange 服务器后端。
2.  **身份验证绕过:** 通过 SSRF 漏洞，攻击者可以模拟管理员身份进行后续操作。
3.  **任意文件写入/代码执行:** 结合其他漏洞（如 CVE-2021-27065），攻击者可以将恶意代码写入 Exchange 服务器的文件系统，并最终执行任意代码。

 该漏洞已经被 CISA 加入到已知被利用漏洞目录 (KEV)，表明其在野外被广泛利用。

**项目地址:** [praetorian-inc/proxylogon-exploit](https://github.com/praetorian-inc/proxylogon-exploit)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #19

**来源**: [CVE-2021-26855-r0xdeadbeef_CVE-2021-26855.md](../2021/CVE-2021-26855-r0xdeadbeef_CVE-2021-26855.md)

## CVE-2021-26855 Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 受影响版本包括 Exchange Server 2013、2016 和 2019 的多个累积更新版本

**利用条件:** 目标Exchange服务器未安装相关安全更新，且攻击者能够访问Exchange服务器的443端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。攻击者可以利用此漏洞绕过身份验证，并发送任意 HTTP 请求，最终通过与其他漏洞（如 CVE-2021-27065）结合，实现远程代码执行。

**利用方式：**

1.  **SSRF (CVE-2021-26855)：** 利用 Autodiscover 协议的缺陷，发送特制的 HTTP 请求到 Exchange 服务器。由于服务器信任来自自身的请求，攻击者可以伪造请求，绕过身份验证。
2.  **获取 LegacyDN：** 通过 SSRF 漏洞，攻击者可以获取目标用户的 LegacyDN。 LegacyDN 是 Exchange 服务器中用户的唯一标识符。
3.  **伪造 MAPI 请求：**  使用获取的 LegacyDN，攻击者可以构造恶意的 MAPI (Messaging Application Programming Interface) 请求，并将其发送到 Exchange 服务器。
4.  **写入 Web Shell (CVE-2021-27065):** 攻击者利用后端组件的漏洞将webshell写入服务器，从而实现远程代码执行。
5.  **远程代码执行：** 成功写入webshell后，即可通过webshell执行任意代码，控制Exchange服务器。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，CVE-2021-26855 是一个经过广泛利用的漏洞，且存在公开的 PoC 代码。提供的 PoC 代码尝试模拟 ProxyLogon 漏洞链的利用过程，包括 SSRF、获取 LegacyDN、伪造 MAPI 请求和写入 Web Shell。根据PoC代码和搜索结果的描述，此POC代码可以实现远程代码执行，有效性较高，但是需要和其它漏洞配合利用，才能达成RCE。

**投毒风险分析：**

PoC 代码本身主要功能是进行漏洞验证和利用，直接植入恶意代码的概率较低。 但仍然存在一定的风险，例如：

*   **恶意代码混淆：** 攻击者可能将恶意代码隐藏在看似无害的字符串或函数中。
*   **依赖项投毒：** PoC 代码可能依赖于外部库或模块，如果这些依赖项被篡改，则可能引入恶意代码。

基于提供的代码，经过分析，判断投毒风险较低，但是仍然不能排除。该代码尝试利用漏洞，但是执行命令的部分是通过写入webshell实现的，增加webshell写入位置的随机性有可能被用于逃避检测，因此有一定的概率(10%)被用于投毒。

**项目地址:** [r0xdeadbeef/CVE-2021-26855](https://github.com/r0xdeadbeef/CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #20

**来源**: [CVE-2021-26855-shacojx_CVE-2021-26855-exploit-Exchange.md](../2021/CVE-2021-26855-shacojx_CVE-2021-26855-exploit-Exchange.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞（ProxyLogon）

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 受影响的Exchange Server 2013, 2016, 2019 Cumulative Updates

**利用条件:** 需要能够访问 Exchange Server 的 OWA 接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，是 ProxyLogon 攻击链的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求并作为 Exchange 服务器进行身份验证。从搜索引擎结果和漏洞库信息可以得知，这是一个被广泛利用的漏洞，存在公开的PoC，并且被CISA添加到已知被利用的漏洞目录中。 

**漏洞利用方式:**

1.  **SSRF (CVE-2021-26855):** 利用 SSRF 漏洞绕过身份验证。
2.  **构造请求:** 攻击者首先发送一个包含特定 Cookie 的 GET 请求，利用 SSRF 漏洞。
3.  **NTLM 认证:** 使用 NTLM 认证绕过。
4.  **获取 FQDN:** 通过 NTLM type2 协议获取服务器的 FQDN (Fully Qualified Domain Name)。
5.  **发送恶意 XML:** 构造恶意的 XML 数据，通过 POST 请求发送到 Exchange Web Services (EWS) 端点，利用后端组件处理 XML 时存在的漏洞执行任意代码。  
6.  **用户枚举:**  PoC 代码还包含用户枚举的功能，增加了攻击面。

**有效性：**

提供的 Go 代码是一个可用的 PoC。它包含了漏洞验证、NTLM 认证和发送恶意 XML 数据的步骤。代码结构清晰，逻辑完整，可以直接用于检测和利用该漏洞。

**投毒风险：**

虽然代码看起来主要实现了漏洞利用的功能，但仍存在一定投毒风险的可能性：
* 用户枚举模块可能被滥用，用于非法收集用户信息。
* 代码中存在一些硬编码的参数和路径，可能在特定环境下不可用，需要使用者修改，可能存在被诱导修改恶意代码。
* 风险评估为 10%，因为代码的主要功能是漏洞利用，而非恶意行为，但是存在被滥用和修改的潜在风险。

**项目地址:** [shacojx/CVE-2021-26855-exploit-Exchange](https://github.com/shacojx/CVE-2021-26855-exploit-Exchange)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #21

**来源**: [CVE-2021-26855-shacojx_Scan-Vuln-CVE-2021-26855.md](../2021/CVE-2021-26855-shacojx_Scan-Vuln-CVE-2021-26855.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要能够访问Exchange Server的端口，通常是443端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞发送任意 HTTP 请求并以 Exchange 服务器的身份进行身份验证，从而绕过身份验证。

**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码判断，该漏洞利用代码的有效性较高。大量的信息表明这是一个已知的、被广泛利用的漏洞，并且CISA已知可利用漏洞目录中包含了此漏洞。

**投毒风险：**
检视提供的代码，主要包含以下几个部分：
1.  `README.md`: 包含漏洞描述和图片。
2.  `build.xml`: Ant构建脚本，用于编译Java项目。
3.  `ipVuln.txt`: 空文件，可能用于存储易受攻击的IP地址列表。
4.  `list-ip.txt`: 包含一个IP地址（`192.168.1.0`），可能用于扫描。
5.  `manifest.mf`: JAR文件的清单文件。
6.  `Tool-Build/Run.bat`: 用于运行编译后的JAR文件的批处理脚本。
7.  `Tool-Build/ipVuln.txt`: 空文件，与上面的`ipVuln.txt`相同。
8.  `Tool-Build/list-ip.txt`: 包含一个IP地址（`192.168.1.0`），可能用于扫描，与上面的`list-ip.txt`相同。
9.  `Tool-Build/Nmap/scripts/http-vuln-cve2021-26855.nse`: Nmap脚本，用于检测目标是否受CVE-2021-26855漏洞影响。这个脚本是漏洞检测的核心。

主要风险点在于`build.xml`构建脚本和`http-vuln-cve2021-26855.nse`这个Nmap脚本。构建脚本可能被修改以包含恶意代码，虽然在这个例子中看起来比较简单，但无法完全排除隐蔽的后门代码存在的可能性。Nmap脚本本身看起来是合法的漏洞检测脚本，但理论上，如果脚本被篡改，可能存在投毒风险。例如，在检测到漏洞时，植入后门或执行恶意操作。
总体评估，投毒风险较低，约为10%，因为主要的代码功能是漏洞扫描，而不是漏洞利用，且代码量不大，容易审计。

**利用方式：**
利用方式通常涉及以下步骤：
1.  **SSRF:** 攻击者利用SSRF漏洞向Exchange服务器发送精心构造的HTTP请求。
2.  **身份验证绕过：** 通过SSRF漏洞，攻击者可以绕过身份验证，模拟Exchange服务器上的其他用户。
3.  **远程代码执行：** 在成功绕过身份验证后，攻击者可以进一步利用其他漏洞（如不安全的deserialization）来执行任意代码。根据搜索引擎结果，CVE-2021-26855是ProxyLogon攻击链的初始漏洞。

综上所述，此漏洞的有效性高，利用方式较为明确，但提供的代码主要用于扫描而非直接利用，因此投毒风险较低。攻击者可以通过SSRF漏洞绕过身份验证，然后利用其他漏洞实现远程代码执行。

**项目地址:** [shacojx/Scan-Vuln-CVE-2021-26855](https://github.com/shacojx/Scan-Vuln-CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #22

**来源**: [CVE-2021-26855-ssrsec_Microsoft-Exchange-RCE.md](../2021/CVE-2021-26855-ssrsec_Microsoft-Exchange-RCE.md)

## CVE-2021-26855 & CVE-2021-27065 - Microsoft Exchange Server RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要能够访问目标 Exchange 服务器的网络端口 (通常是443)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞利用链包括 CVE-2021-26855 (SSRF) 和 CVE-2021-27065 (不安全的反序列化导致RCE)。

**利用方式：**

1.  **SSRF (CVE-2021-26855):** 利用服务器端请求伪造漏洞，攻击者可以发送任意HTTP请求并伪装成Exchange服务器进行身份验证。POC代码首先发送一个NTLM协商请求到`/rpc/`端点，利用返回的`WWW-Authenticate`头中的信息来获取目标Exchange服务器的计算机名和域名。
2.  **RCE (CVE-2021-27065):** 利用获取的计算机名，结合一个已知的邮箱地址格式，构造一个包含`LegacyDN`的请求，发送到`/ecp/baba.js`，最终通过写入webshell来实现远程代码执行。其中，`baba.js`是一个占位符，攻击者可以通过修改这个值，上传任意的webshell。

**有效性：**

根据提供的漏洞信息、搜索结果以及POC代码，可以判断此POC代码是有效的，该漏洞利用是公开的，影响范围广泛。搜索结果也表明该漏洞已被广泛利用。

**投毒风险：**

代码主要功能是利用漏洞，但存在潜在的投毒风险。风险点在于：

*   **Webshell 内容：** Webshell的内容（`<script language="JScript" runat="server">function Page_Load(){eval(Request["babanb"],"unsafe");}</script>`）是固定的，攻击者可能会修改这个内容，植入恶意代码，或者植入更加隐蔽的后门。目前是直接在ecp目录下写了baba.js的文件,比较容易被发现。
*   **依赖项风险：**虽然代码量少，但仍然可能引入有安全风险的第三方库，虽然这里没有体现。
*  **邮件用户列表:** 代码中使用了一个邮件用户列表进行尝试。这个列表可能被修改，用于针对特定目标进行攻击，或者用于搜集敏感信息。

虽然存在风险，但整体代码逻辑较为清晰，风险较低。投毒风险评估为10%。

**项目地址:** [ssrsec/Microsoft-Exchange-RCE](https://github.com/ssrsec/Microsoft-Exchange-RCE)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #23

**来源**: [CVE-2021-26855-thau0x01_poc_proxylogon.md](../2021/CVE-2021-26855-thau0x01_poc_proxylogon.md)

## CVE-2021-26855 Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 受影响的版本包括：Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange Server开放443端口，且未安装相关安全补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 (ProxyLogon) 是一种存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞。未经身份验证的远程攻击者可以通过发送精心构造的 HTTP 请求来利用此漏洞，从而能够伪造身份并执行其他恶意操作。从搜索结果来看，该漏洞被广泛利用。提供的PoC代码展示了利用该漏洞获取远程代码执行权限的过程。

**漏洞利用方式：**

1.  **SSRF (CVE-2021-26855):** 首先，利用SSRF漏洞发送任意HTTP请求，目的是绕过身份验证，获取有效的LegacyDN。
2.  **获取 LegacyDN:** 通过构造Autodiscover请求，获取目标用户的 LegacyDN。
3.  **MAPI 连接:** 使用获取的LegacyDN建立一个MAPI会话。
4.  **获取 SID:** 从MAPI响应中提取用户的安全标识符 (SID)。
5.  **ProxyLogon:** 利用ProxyLogon机制，将用户SID修改为管理员SID，从而提升权限。
6.  **写入 Webshell:** 利用提升的权限，向服务器写入webshell，实现远程代码执行。

**投毒风险分析：**

代码中存在以下潜在的投毒风险：

*   **硬编码的路径和文件名：** `shell_path`和`shell_absolute_path`以及`ahihi7.aspx`是硬编码的，这使得webshell容易被检测和移除，但如果攻击者修改了这些值，可能会将webshell写入到更隐蔽的位置。
*   **webshell 内容：** `shell_content`包含执行 `whoami` 命令的JavaScript代码，这是一个简单的测试命令。攻击者可以修改`shell_content`以执行更具破坏性的操作。虽然当前代码只是执行`whoami`，但不能排除攻击者将恶意代码注入`shell_content`的可能性。这一部分存在被恶意修改进行投毒的可能性。
*   **代理URI (`msExchProxyUri`)**: PoC代码中 `msExchProxyUri` 设置为`http://127.0.0.1:8080/`，这意味着攻击者可能尝试通过本地代理进行其他攻击，或者将流量转发到恶意服务器。虽然现在指向本地，但存在被修改指向恶意地址的可能性。

虽然这些风险存在，但整体代码看起来是为了验证漏洞，主要的目的是为了RCE，没有明显的隐藏后门或者其他恶意行为。因此，投毒风险较低, 约5%。

**项目地址:** [thau0x01/poc_proxylogon](https://github.com/thau0x01/poc_proxylogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #24

**来源**: [CVE-2021-26855-timb-machine-mirrors_testanull-CVE-2021-26855_read_poc.txt.md](../2021/CVE-2021-26855-timb-machine-mirrors_testanull-CVE-2021-26855_read_poc.txt.md)

## CVE-2021-26855-Microsoft Exchange Server-SSRF

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造（SSRF）漏洞。根据搜索结果和漏洞描述，未经验证的远程攻击者可以利用此漏洞发送任意 HTTP 请求并模拟 Exchange 服务器进行身份验证。该漏洞是 ProxyLogon 攻击链的关键组成部分。提供的POC代码尝试通过 `POST /ecp/poc-2021-26855.js HTTP/1.1` 发送 SOAP 请求，通过修改 `X-BEResource` cookie 绕过身份验证，进而执行其他操作。由于请求的目标是 EWS (Exchange Web Services)，这允许攻击者访问和操作邮箱数据。分析代码中,没有发现作者隐藏的投毒代码。

**利用方式：**

1.  **SSRF 攻击：** 利用 CVE-2021-26855，攻击者可以向 Exchange 服务器发送伪造的 HTTP 请求。
2.  **身份验证绕过：** 通过操纵 `X-BEResource` cookie，攻击者可以绕过身份验证，冒充合法用户。
3.  **邮箱访问：** 一旦成功绕过身份验证，攻击者可以使用 EWS 接口访问和操作邮箱数据，例如读取邮件、联系人等。
4.  **链式利用：** CVE-2021-26855 通常与其他 Exchange 漏洞（如 CVE-2021-26857、CVE-2021-26858、CVE-2021-27065）结合使用，形成 ProxyLogon 攻击链，最终实现远程代码执行。

**项目地址:** [timb-machine-mirrors/testanull-CVE-2021-26855_read_poc.txt](https://github.com/timb-machine-mirrors/testanull-CVE-2021-26855_read_poc.txt)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #25

**来源**: [CVE-2021-26855-yaoxiaoangry3_Flangvik.md](../2021/CVE-2021-26855-yaoxiaoangry3_Flangvik.md)

## CVE-2021-26855 Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Microsoft Exchange Server 2013、2016 和 2019 的多个累积更新版本，具体版本参见漏洞库信息

**利用条件:** 目标Exchange服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求并可能绕过身份验证。

**有效性分析：**
根据提供的漏洞库信息，此漏洞影响多个版本的 Microsoft Exchange Server，CVSS 评分为 9.1，表明其严重性。
搜索结果显示，此漏洞被广泛利用，并且有公开的 PoC 可用，参考网页标题包含"ProxyLogon"的网页信息可以知道。
提供的漏洞利用代码描述表明它是一个 C# PoC，支持半交互式的 web shell 以及 shellcode 执行。
综合来看，提供的 POC 代码是有效的。

**投毒风险分析：**
提供的代码片段 `/tmp/e24bb8b01b99c84300e1ac6fb58f9709/README.md` 只显示了关于 PoC 的简短描述，无法直接判断是否存在投毒代码。由于是 C# PoC，投毒代码可能隐藏在编译后的二进制文件中。仅仅通过 README.md 文件判断，存在误判可能性，但是根据以往经验，开源社区存在一定的投毒行为，因此给出一定百分比。

**利用方式分析：**
1.  利用 CVE-2021-26855 的 SSRF 漏洞，攻击者可以绕过身份验证。
2.  成功绕过身份验证后，攻击者可以利用后续漏洞（例如 CVE-2021-26857）写入任意文件。
3.  写入的文件可以是一个 ASPX web shell，允许攻击者执行任意代码。
4.  或者，攻击者可以使用 shellcode 直接在服务器上执行恶意代码。
该漏洞是 ProxyLogon 攻击链的初始入口点，为后续攻击铺平道路。

**项目地址:** [yaoxiaoangry3/Flangvik](https://github.com/yaoxiaoangry3/Flangvik)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---



---

## POC #7

**来源**: [CVE-2021-26855-ShyTangerine_cve-2021-26855.md](../2021/CVE-2021-26855-ShyTangerine_cve-2021-26855.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Exchange Server 2013、2016 和 2019 的多个累积更新版本，详见漏洞库信息

**利用条件:** 需要能够访问 Exchange Server 的 ECP 接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。未授权的攻击者可以利用此漏洞发送任意 HTTP 请求并进行身份验证，绕过身份验证，最终导致远程代码执行。

**利用方式：**

根据提供的漏洞利用代码，利用过程大致如下：

1.  **初始请求：** 向 `/ecp/x.png` 发送 GET 请求，尝试获取 `X-BEResource` Cookie。
2.  **获取 DN 值：** 通过向 `/ecp/x.png` 发送包含特定 XML 内容的 POST 请求，利用 Autodiscover 服务获取用户的 DN (Distinguished Name)。
3.  **Mapi/Emsmdb 连接：** 使用获取的 DN 值，向 `/ecp/x.png` 发送包含 `X-BEResource`、`X-Clientinfo` 等头的 POST 请求，尝试建立 MAPI over HTTP 连接。
4.  **获取 Session 和 msExchEcpCanary：** 通过向 `/ecp/x.png` 发送包含特定 XML 内容的 POST 请求，利用 Negotiate 协议获取 ASP.NET Session ID 和 `msExchEcpCanary` 值。`msExchEcpCanary` 是一个安全令牌，用于防止跨站请求伪造 (CSRF) 攻击。
5.  **获取 OAB ID：** 发送包含`msExchEcpCanary` 和 Session ID 到`/ecp/x.png`，获取OAB id，为下一步写入恶意代码作准备

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞确实存在且已被积极利用。该 POC 代码展示了漏洞利用的关键步骤，例如如何绕过身份验证、如何获取必要的凭据信息等。该漏洞利用的有效性较高。

**投毒风险：**

评估提供的 POC 代码，存在一定投毒风险，10%。 风险点主要在于：

*   **硬编码的 IP 地址和域名：** POC 代码中包含硬编码的 IP 地址 (例如 `10.255.200.20`, `192.168.170.134`) 和域名 (`EXCHANGE01.xihongdream.com`)。如果用户直接使用这些硬编码的值，可能会将攻击流量导向作者控制的服务器，从而暴露目标服务器的信息或被用于进一步的攻击。

*   **潜在的后门植入：** 虽然 POC 代码的主要目的是演示漏洞利用过程，但作者有可能在代码中插入后门，例如，在OAB操作中，写入恶意脚本到目标服务器，长期控制目标系统。

总的来说，该 POC 代码主要演示了 SSRF 的利用方式。用户在使用时应谨慎，务必修改代码中的硬编码值，避免潜在的投毒风险。

**项目地址:** [ShyTangerine/cve-2021-26855](https://github.com/ShyTangerine/cve-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #8

**来源**: [CVE-2021-26855-TheDudeD6_ExchangeSmash.md](../2021/CVE-2021-26855-TheDudeD6_ExchangeSmash.md)

## CVE-2021-26855-Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器可访问，且未安装相关安全更新。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，是 ProxyLogon 攻击链的一部分。未经身份验证的攻击者可以利用此漏洞发送任意 HTTP 请求并冒充管理员进行身份验证，最终造成远程代码执行。

**利用方式：**

1.  **SSRF（CVE-2021-26855）：** 攻击者首先利用 SSRF 漏洞绕过身份验证，获取合法的身份。
2.  **获取SID：** 使用合法的身份，获取用户的SID
3.  **伪造管理员 SID：** 通过篡改已泄露的用户SID，伪造管理员SID
4.  **ProxyLogon：** 使用伪造的管理员 SID 通过 ProxyLogon 攻击链，获得管理员权限。
5.  **写入webshell：** 利用管理员权限，在目标服务器上写入 webshell。
6.  **远程代码执行：** 通过访问 webshell 执行任意代码。

**投毒风险：**
查看提供的POC代码，发现其功能是利用漏洞，在正常情况下，不应存在恶意代码。但是，由于代码逻辑复杂，且依赖外部库（Impacket），存在作者在代码中植入恶意逻辑的可能性。另外，通过分析发现proxylogon.py中的shell_src变量可以自定义，如果被替换成恶意payload，则存在一定风险。

综合考虑，投毒风险评估为10%，主要风险在于代码的可信度以及shell_src变量的替换。

**项目地址:** [TheDudeD6/ExchangeSmash](https://github.com/TheDudeD6/ExchangeSmash)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #9

**来源**: [CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855.md](../2021/CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF to RCE (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** SSRF (Server-Side Request Forgery) -> RCE (Remote Code Execution)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器可以从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 存在于 Microsoft Exchange Server 中，是一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞。

**利用方式：**

1.  **SSRF：** 攻击者利用SSRF漏洞，通过构造恶意的 HTTP 请求，绕过身份验证。
2.  **获取 LegacyDN：** 利用 SSRF 漏洞，向 Exchange 服务器的 autodiscover 端点发送请求，获取目标用户的 LegacyDN。
3.  **MAPI 连接：** 使用获得的 LegacyDN 建立 MAPI 连接。
4.  **获取 SID：** 从 MAPI 响应中提取用户的 SID。
5.  **ProxyLogon：** 利用 SID 伪造身份，通过 proxyLogon.ecp 端点进行身份验证绕过。
6.  **写入 Webshell：** 成功绕过身份验证后，攻击者可以将恶意的 webshell 写入到 Exchange 服务器的 OWA 目录中。
7.  **远程代码执行：** 攻击者通过访问写入的 webshell，执行任意代码。

**有效性评估：**

提供的 POC 代码 `ExchangeSheller.py` 实现了上述利用流程，能够自动化利用 CVE-2021-26855 漏洞，因此是有效的。

**投毒风险分析：**

代码本身执行的是漏洞利用流程，主要功能为利用 SSRF 漏洞并最终写入 Webshell。但需要注意以下几点：

*   **代码来源：** 代码来自 GitHub，需要验证其作者的信誉和代码的完整性。
*   **Webshell 内容：** Webshell 的内容可控，攻击者可以修改 webshell 的内容，使其执行恶意操作，如植入后门、窃取数据等。
*   **隐藏指令：** 理论上，eval 函数中可以嵌入隐蔽的恶意代码，但这需要仔细分析 `ExchangeSheller.py` 文件，当前判断该风险较低。

**结论：**

该漏洞利用的有效性高。存在一定的投毒风险，主要体现在攻击者可能会修改webshell的内容，但总体来说代码的结构和逻辑清晰，投毒风险较低，估计在5%。务必在隔离环境下进行测试，并对生成的 webshell 进行安全审计。

**项目地址:** [ZephrFish/Exch-CVE-2021-26855](https://github.com/ZephrFish/Exch-CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #10

**来源**: [CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855_Priv.md](../2021/CVE-2021-26855-ZephrFish_Exch-CVE-2021-26855_Priv.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的 Exchange 服务器上执行任意代码。

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21/22/23, 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19, 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 目标Exchange服务器存在漏洞且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 攻击链的一部分。未经身份验证的攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成管理员进行身份验证，然后结合其他漏洞（例如 CVE-2021-27065）来写入任意文件，最终实现远程代码执行。

**漏洞利用方式：**

1.  **SSRF (CVE-2021-26855):** 攻击者利用 SSRF 漏洞，通过构造特殊的 URL 和请求头，绕过身份验证，获取 Exchange 服务器的访问权限。
2.  **获取 LegacyDN：** 利用 Autodiscover 服务获取目标用户的 LegacyDN。
3.  **MAPI 连接：** 使用获取的 LegacyDN 建立 MAPI 连接。
4.  **ProxyLogon:** 通过构造 ProxyLogon 请求，伪装成管理员身份。
5.  **写入 Webshell (CVE-2021-27065，虽然POC未直接体现，但通常会结合使用):** 在成功通过身份验证后，利用漏洞在 Exchange 服务器的 OWA 目录下写入恶意的 Webshell 文件，该文件包含可以执行任意代码的 JScript 代码。
6.  **远程代码执行：** 攻击者通过访问 Webshell 文件，执行任意代码。

**有效性：**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞利用代码是有效的，因为它再现了 ProxyLogon 攻击链的关键步骤，包括 SSRF、权限提升和 webshell 写入 (webshell 内容在代码中已经存在)。搜索引擎结果中也表明 CVE-2021-26855 被积极利用。

**投毒风险：**

分析提供的 POC 代码，未发现明显的投毒代码。代码逻辑主要集中在利用 SSRF 漏洞进行身份验证绕过，并最终部署 webshell。虽然 webshell 本身是一种恶意代码，但这是漏洞利用的必要步骤，而非作者有意添加的恶意功能。因此，判定投毒风险为0%。

**项目地址:** [ZephrFish/Exch-CVE-2021-26855_Priv](https://github.com/ZephrFish/Exch-CVE-2021-26855_Priv)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #11

**来源**: [CVE-2021-26855-dwisiswant0_proxylogscan.md](../2021/CVE-2021-26855-dwisiswant0_proxylogscan.md)

## CVE-2021-26855 Microsoft Exchange Server SSRF 漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** Exchange 2013 Versions < 15.00.1497.012, Exchange 2016 CU18 < 15.01.2106.013, Exchange 2016 CU19 < 15.01.2176.009, Exchange 2019 CU7 < 15.02.0721.013, Exchange 2019 CU8 < 15.02.0792.010

**利用条件:** 需要能够访问存在漏洞的 Exchange Server 的网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而冒充管理员身份。该漏洞是 ProxyLogon 攻击链的一部分，与 CVE-2021-27065 (身份验证后任意文件写入漏洞) 结合使用，可以实现远程代码执行。

**漏洞利用方式：**

1.  攻击者利用 CVE-2021-26855，发送特制的 HTTP 请求到 Exchange Server，绕过身份验证并获得管理员权限。
2.  利用获得的管理员权限，攻击者可以进一步利用 CVE-2021-27065 将恶意代码写入服务器。
3.  执行写入的恶意代码，最终实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码 `proxylogscan` 是一个 Go 语言编写的工具，用于大规模扫描存在 CVE-2021-26855 漏洞的 Microsoft Exchange Server。它通过发送特定的 HTTP 请求来检测目标服务器是否存在漏洞。

**投毒风险分析：**

代码主要功能是扫描漏洞，用于检测目标是否存在漏洞。 考虑到工具的用途和代码的简洁性，投毒的可能性较低，但是需要对代码进行仔细的审查，特别是涉及网络请求的部分，以确保没有隐藏的恶意逻辑。 投毒的可能性较低，但是依然存在一定的风险。代码使用go get安装，存在一定的依赖风险,需要注意.


**项目地址:** [dwisiswant0/proxylogscan](https://github.com/dwisiswant0/proxylogscan)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #12

**来源**: [CVE-2021-26855-glen-pearson_ProxyLogon-CVE-2021-26855.md](../2021/CVE-2021-26855-glen-pearson_ProxyLogon-CVE-2021-26855.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞 (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，未经验证的远程攻击者可以利用此漏洞在受影响的系统上执行任意代码

**影响版本:** 受影响版本包括 Exchange Server 2013 Cumulative Update 22 和 23, Exchange Server 2016 Cumulative Update 12-19, Exchange Server 2019 Cumulative Update 1-8

**利用条件:** 目标系统存在未修补的 Exchange Server 实例，攻击者需要能够通过网络访问 Exchange 服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成 Exchange 服务器进行身份验证，为后续利用其他漏洞（例如 CVE-2021-26857）创造条件。漏洞利用链通常涉及以下步骤：

1.  **SSRF (CVE-2021-26855):** 利用 SSRF 漏洞绕过身份验证，获取 Exchange 服务器的权限。
2.  **不安全的反序列化:** 通过 SSRF 漏洞获取的权限，进一步利用不安全的反序列化漏洞（例如 CVE-2021-26854, CVE-2021-26857, CVE-2021-27065）执行任意代码。

提供的 PoC 代码是一个修改后的 ProxyLogon 漏洞利用脚本，它利用 CVE-2021-26855 绕过身份验证，然后在服务器上创建一个后门 Web shell。具体流程如下：

1.  **自动发现 (Autodiscover):** 使用 Autodiscover 协议获取 LegacyDN。
2.  **MAPI 连接:** 使用获取的 LegacyDN 建立 MAPI 连接，模拟管理员权限。
3.  **Web Shell 写入:**  将包含反向 shell 代码的 aspx Web shell 写入到服务器的 `Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\test11.aspx` 路径。
4.  **执行 Web Shell:** 攻击者可以通过访问该 Web shell 执行任意命令。该 Web shell 执行 Powershell 命令，建立一个反向 TCP 连接到攻击者的指定 IP 地址和端口。 

**有效性：** 该 PoC 代码有效，因为它实现了 ProxyLogon 漏洞利用，并成功创建反向 shell，证明了远程代码执行。

**投毒风险：** 存在一定的投毒风险。作者在原始PoC基础上修改了代码，增加了创建用户和反向shell的功能，该行为可能被攻击者利用，如果攻击者修改了反向shell中的IP地址和端口，则使用者在不知情的情况下连接到攻击者的服务器，所以存在投毒风险。 风险大约在10%。

**利用方式：** 攻击者首先利用 CVE-2021-26855 漏洞绕过身份验证，获取 Exchange 服务器的权限，然后通过写入 Web shell 执行任意代码。这个 Web shell 会连接到攻击者控制的服务器，从而允许攻击者完全控制受感染的 Exchange 服务器。

**项目地址:** [glen-pearson/ProxyLogon-CVE-2021-26855](https://github.com/glen-pearson/ProxyLogon-CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #13

**来源**: [CVE-2021-26855-hakivvi_proxylogon.md](../2021/CVE-2021-26855-hakivvi_proxylogon.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全控制受影响的Exchange服务器

**影响版本:** 受影响版本包括 Exchange Server 2013 Cumulative Update 21/22/23, Exchange Server 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19, Exchange Server 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 需要能够访问Exchange服务器的网络，并且服务器存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。结合其他漏洞（如CVE-2021-27065），未经身份验证的远程攻击者可以利用此漏洞发送任意 HTTP 请求并以管理员身份通过身份验证，最终实现远程代码执行。 

**利用方式：**

1.  **SSRF (CVE-2021-26855):** 攻击者首先利用 SSRF 漏洞伪造 HTTP 请求，绕过身份验证。
2.  **管理员权限获取:** 利用伪造的请求，攻击者可以获得 Exchange 服务器的管理员权限。
3.  **OAB虚拟目录操作:** 修改OAB (Offline Address Book)虚拟目录的ExternalUrl参数，将shell地址写入。
4.  **Shell 写入:** 通过修改的ExternalUrl，攻击者将一个 ASPX webshell 写入到 Exchange 服务器的 web 可访问目录（通常是`C:\inetpub\wwwroot\aspnet_client\`）。 
5.  **远程代码执行:** 攻击者可以通过访问 webshell 的 URL 并发送特定的请求参数来执行任意代码。

**代码分析与投毒风险评估：**

提供的POC代码 `proxylogon.py` 实现了上述的攻击流程。代码首先利用 SSRF 获取服务器的计算机名，然后利用 NTLM 认证绕过。之后，它利用获取的管理员权限，通过修改 OAB 虚拟目录来写入 webshell。最后，代码输出 webshell 的 URL，攻击者可以通过该 URL 执行任意命令。

**投毒风险分析:**  POC代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **后门植入:** 虽然主要的目的是利用漏洞进行RCE，恶意攻击者可能会在脚本中添加额外的后门代码，例如，在写入的 webshell 中添加额外的功能，以便在将来保持对服务器的访问。
*   **信息收集:**  攻击者可以修改脚本来收集目标服务器上的敏感信息，例如，用户名、密码哈希、以及其他配置信息。
*   **恶意传播:**  如果攻击者控制了多个 Exchange 服务器，他们可以修改脚本来自动传播恶意软件到其他服务器。
*   **依赖库风险：**POC依赖Impacket库，如果Impacket库本身被篡改或包含恶意代码，那么使用此POC也会受到影响。

尽管存在这些风险，但就提供的代码片段本身而言，没有明显的恶意代码。风险主要在于该漏洞本身带来的权限和潜在的恶意修改行为。POC中生成随机字符串的部分(gen())是为了避免文件名冲突，本身不是恶意行为。利用OABVirtualDirectory修改ExternalUrl以及ResetOABVirtualDirectory修改FilePathName的行为是为了webshell的写入，这是漏洞利用的一部分。

**总结:** 该漏洞利用链的有效性较高，因为 CVE-2021-26855 是 ProxyLogon 攻击链的关键组成部分，被广泛利用。 投毒风险主要来自于利用此漏洞成功入侵后的恶意行为，而非POC代码本身。由于代码中包含webshell的部署，存在一定风险，但直接判定为投毒不严谨，结合分析结果，投毒风险预估为10%。

**项目地址:** [hakivvi/proxylogon](https://github.com/hakivvi/proxylogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #14

**来源**: [CVE-2021-26855-hictf_CVE-2021-26855-CVE-2021-27065.md](../2021/CVE-2021-26855-hictf_CVE-2021-26855-CVE-2021-27065.md)

## CVE-2021-26855 Microsoft Exchange Server SSRF 远程代码执行漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** SSRF (服务器端请求伪造) -> 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器对外开放，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个 SSRF 漏洞。根据搜索结果，攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成 Exchange 服务器进行身份验证。该漏洞是 ProxyLogon 攻击链中的一部分，攻击者利用该漏洞可以绕过身份验证，并结合其他漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者利用 CVE-2021-26855 漏洞发送恶意构造的 HTTP 请求到 Exchange 服务器。
2.  通过 SSRF 漏洞，攻击者可以伪装成 Exchange 服务器进行身份验证，绕过身份验证机制。
3.  绕过身份验证后，攻击者可以利用其他漏洞（例如 CVE-2021-27065，反序列化漏洞）在 Exchange 服务器上执行任意代码。

**POC有效性分析：**

提供的 POC 代码包含一个简单的 PHP 文件（hello world），一个 README 文件，一个简单的 Node.js 服务器 (demo.js) 和一个 package.json 文件。这些代码片段本身并不能直接利用 CVE-2021-26855。它们更像是用于搭建一个基础的web服务器环境，可能用于验证漏洞利用的某些步骤或作为最终执行的payload的一部分。因此，单独来看，提供的POC代码**无效**，它只是利用整个漏洞链中的一小部分。

**投毒风险分析：**

提供的 POC 代码较为简单，没有明显的恶意代码。`demo.js` 只是一个简单的 HTTP 服务器，`1.php` 只是输出 "hello world"。但是，考虑到这是一个 Exchange 漏洞的 POC，攻击者可能会在更复杂的利用链中利用这些文件，例如将 `1.php` 作为 Webshell 上传到服务器，或者利用 `demo.js` 搭建一个用于接收反弹 shell 的服务器。 因此，存在一定的投毒风险，但风险主要在于利用方式的组合，而非代码本身存在后门。

**投毒风险评估：**

由于代码功能简单，直接投毒的可能性较低，但作为漏洞利用链的一部分，可能被用于执行恶意操作，因此投毒风险评定为 **20%**。

**项目地址:** [hictf/CVE-2021-26855-CVE-2021-27065](https://github.com/hictf/CVE-2021-26855-CVE-2021-27065)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #15

**来源**: [CVE-2021-26855-hosch3n_ProxyVulns.md](../2021/CVE-2021-26855-hosch3n_ProxyVulns.md)

## CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，无需身份验证即可远程代码执行

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 22, 23; 2016 Cumulative Update 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19; 2019 Cumulative Update 1, 2, 3, 4, 5, 6, 7, 8

**利用条件:** Exchange Server对外开放443端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造（SSRF）漏洞，它允许未经身份验证的攻击者发送任意 HTTP 请求并伪装成 Exchange 服务器的管理员。此漏洞是 ProxyLogon 攻击链的入口点，后续可以配合其他漏洞实现远程代码执行。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用是有效的。搜索引擎结果中许多链接都表明 CVE-2021-26855 已被积极利用。漏洞利用代码 `26855.py` 实现了利用该漏洞的步骤，包括：

1.  **SSRF 探测：** 通过构造特殊的 `X-BEResource` 请求头，获取 Exchange 后端服务器的计算机名和域名。
2.  **LegacyDN 获取：** 利用 Autodiscover 服务，通过提供用户邮箱地址获取 LegacyDN。
3.  **SID 欺骗：** 伪造 MAPI 请求，通过 LegacyDN 获取用户的 SID。
4.  **ProxyLogon 利用：** 利用获取到的 SID，通过 `proxyLogon.ecp` 绕过身份验证。
5.  **Webshell 部署：** 写入 Webshell 到服务器。

**投毒风险分析：**
漏洞利用代码中存在较低的投毒风险 (大约 5%)。虽然代码的目的是利用漏洞，但攻击者可能在 `webshell_content` 中植入恶意代码，或者修改 `webshell_path` 将webshell写入到不常见的位置，使得后期的权限维持或者横向移动更加隐蔽。例如，如果`webshell_content`包含下载和执行其他恶意文件的指令，这就是一种投毒行为。 目前提供的webshell代码较为简单，判定投毒的概率较低。

**利用方式总结：**
1.  攻击者首先利用 SSRF 漏洞 (CVE-2021-26855) 绕过身份验证。
2.  攻击者通过构造恶意的 HTTP 请求，欺骗 Exchange 服务器，使其认为攻击者已通过身份验证。
3.  成功绕过身份验证后，攻击者可以使用其他漏洞（例如 CVE-2021-27065，写入任意文件）在 Exchange 服务器上执行任意代码，部署 Webshell。
4.  攻击者通过 Webshell 执行系统命令，控制 Exchange 服务器。

**项目地址:** [hosch3n/ProxyVulns](https://github.com/hosch3n/ProxyVulns)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #16

**来源**: [CVE-2021-26855-kh4sh3i_ProxyLogon.md](../2021/CVE-2021-26855-kh4sh3i_ProxyLogon.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF/RCE (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，未经验证的远程攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**影响版本:** 受影响版本包括Exchange Server 2013、2016和2019的多个累积更新。

**利用条件:** 需要目标Exchange服务器存在漏洞版本，且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，它是 ProxyLogon 漏洞链中的第一个环节。攻击者可以利用此漏洞发送任意 HTTP 请求并作为 Exchange 服务器进行身份验证。根据搜索结果，此漏洞与其他漏洞（如 CVE-2021-26857、CVE-2021-26858 和 CVE-2021-27065）结合使用，可以实现未经身份验证的远程代码执行。利用方式通常涉及：

1.  **SSRF（CVE-2021-26855）：** 利用 SSRF 漏洞冒充 Exchange 服务器进行身份验证。
2.  **身份验证绕过：** 绕过身份验证后，攻击者可以访问受保护的 Exchange 后端资源。
3.  **任意文件写入/反序列化/RCE：** 利用其他漏洞（例如，通过修改虚拟目录或写入Web shell）在服务器上执行任意代码。

提供的漏洞利用代码仅包含一个 Creative Commons 许可证，本身不包含任何利用代码或恶意代码，因此不存在投毒风险。但实际利用时，攻击者需要结合其他漏洞利用工具和payload才能实现最终的远程代码执行。

**漏洞利用有效性评估：**
根据漏洞库信息和搜索结果，CVE-2021-26855 是一个已知的、被广泛利用的漏洞。存在公开可用的漏洞利用代码（虽然这里没有直接提供，但搜索结果表明存在）。此漏洞被 CISA 列入已知被利用的漏洞目录中，表明该漏洞在野外已被积极利用。

**总结：**
CVE-2021-26855 是一个高危漏洞，允许未经身份验证的攻击者利用 Exchange 服务器执行 SSRF 攻击，为后续的远程代码执行铺平道路。务必尽快应用 Microsoft 提供的安全更新。

**项目地址:** [kh4sh3i/ProxyLogon](https://github.com/kh4sh3i/ProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #17

**来源**: [CVE-2021-26855-mekhalleh_exchange_proxylogon.md](../2021/CVE-2021-26855-mekhalleh_exchange_proxylogon.md)

## CVE-2021-26855 Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** Exchange 2013 Versions < 15.00.1497.012, Exchange 2016 CU18 < 15.01.2106.013, Exchange 2016 CU19 < 15.01.2176.009, Exchange 2019 CU7 < 15.02.0721.013, Exchange 2019 CU8 < 15.02.0792.010

**利用条件:** 目标 Exchange Server 必须可从网络访问,且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 攻击链的一部分。未经身份验证的攻击者可以利用此漏洞发送任意 HTTP 请求，绕过身份验证，并冒充管理员。该漏洞本身并不能直接导致 RCE，但可以与其他漏洞（如 CVE-2021-27065，一个身份验证后的任意文件写入漏洞）结合使用，最终实现远程代码执行。

**利用方式：**

1.  **SSRF（CVE-2021-26855）：**  攻击者利用 SSRF 漏洞发送精心构造的 HTTP 请求，绕过 Exchange Server 的身份验证。
2.  **身份验证绕过：**  成功利用 SSRF 后，攻击者可以获得 Exchange Server 的管理权限，无需提供有效的用户名和密码。
3.  **任意文件写入（CVE-2021-27065 或其他）：**  获得身份验证后，攻击者利用任意文件写入漏洞，将恶意代码写入 Exchange Server 的文件系统中。
4.  **代码执行：**  通过访问写入的恶意文件，攻击者可以在 Exchange Server 上执行任意命令，实现远程代码执行。

**有效性：**

提供的 Metasploit 模块 (`exchange_proxylogon.rb`) 是一个扫描器，用于检测目标 Exchange Server 是否存在 CVE-2021-26855 漏洞。它通过发送特定的 HTTP 请求来验证漏洞是否存在。如果扫描器检测到漏洞，则表明目标服务器容易受到 ProxyLogon 攻击。

**投毒风险：**

提供的代码主要是一个漏洞验证和扫描工具，没有明显的投毒代码。但任何来自外部的代码都存在一定的风险，所以投毒风险估计为5%。主要需要关注的是Metasploit模块中使用的HTTP请求的构造，以及是否会意外地对目标系统造成破坏。此外，攻击者可能会修改此模块以达到恶意目的，但在提供的代码本身中没有发现此类行为。

**项目地址:** [mekhalleh/exchange_proxylogon](https://github.com/mekhalleh/exchange_proxylogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #18

**来源**: [CVE-2021-26855-praetorian-inc_proxylogon-exploit.md](../2021/CVE-2021-26855-praetorian-inc_proxylogon-exploit.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，未经身份验证的攻击者可远程执行任意代码，完全控制 Exchange 服务器。

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2013 Cumulative Update 21/22/23，Microsoft Exchange Server 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19，Microsoft Exchange Server 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 攻击者需要能够访问 Exchange 服务器的端口（通常是 443）。该漏洞是 ProxyLogon 攻击链的一部分，通常与其他漏洞组合利用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞发送任意 HTTP 请求，并有可能绕过身份验证。根据搜索结果和漏洞信息，该漏洞是 ProxyLogon 攻击链的关键组成部分，攻击者可以使用它与其他漏洞（如 CVE-2021-27065）结合，最终在 Exchange 服务器上执行任意代码。提供的漏洞利用代码只包含 Apache License 2.0 协议，没有发现恶意代码，因此投毒风险极低。利用方式通常涉及：

1.  **SSRF 攻击:** 利用 CVE-2021-26855 发送恶意构造的 HTTP 请求到 Exchange 服务器后端。
2.  **身份验证绕过:** 通过 SSRF 漏洞，攻击者可以模拟管理员身份进行后续操作。
3.  **任意文件写入/代码执行:** 结合其他漏洞（如 CVE-2021-27065），攻击者可以将恶意代码写入 Exchange 服务器的文件系统，并最终执行任意代码。

 该漏洞已经被 CISA 加入到已知被利用漏洞目录 (KEV)，表明其在野外被广泛利用。

**项目地址:** [praetorian-inc/proxylogon-exploit](https://github.com/praetorian-inc/proxylogon-exploit)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #19

**来源**: [CVE-2021-26855-r0xdeadbeef_CVE-2021-26855.md](../2021/CVE-2021-26855-r0xdeadbeef_CVE-2021-26855.md)

## CVE-2021-26855 Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 受影响版本包括 Exchange Server 2013、2016 和 2019 的多个累积更新版本

**利用条件:** 目标Exchange服务器未安装相关安全更新，且攻击者能够访问Exchange服务器的443端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。攻击者可以利用此漏洞绕过身份验证，并发送任意 HTTP 请求，最终通过与其他漏洞（如 CVE-2021-27065）结合，实现远程代码执行。

**利用方式：**

1.  **SSRF (CVE-2021-26855)：** 利用 Autodiscover 协议的缺陷，发送特制的 HTTP 请求到 Exchange 服务器。由于服务器信任来自自身的请求，攻击者可以伪造请求，绕过身份验证。
2.  **获取 LegacyDN：** 通过 SSRF 漏洞，攻击者可以获取目标用户的 LegacyDN。 LegacyDN 是 Exchange 服务器中用户的唯一标识符。
3.  **伪造 MAPI 请求：**  使用获取的 LegacyDN，攻击者可以构造恶意的 MAPI (Messaging Application Programming Interface) 请求，并将其发送到 Exchange 服务器。
4.  **写入 Web Shell (CVE-2021-27065):** 攻击者利用后端组件的漏洞将webshell写入服务器，从而实现远程代码执行。
5.  **远程代码执行：** 成功写入webshell后，即可通过webshell执行任意代码，控制Exchange服务器。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，CVE-2021-26855 是一个经过广泛利用的漏洞，且存在公开的 PoC 代码。提供的 PoC 代码尝试模拟 ProxyLogon 漏洞链的利用过程，包括 SSRF、获取 LegacyDN、伪造 MAPI 请求和写入 Web Shell。根据PoC代码和搜索结果的描述，此POC代码可以实现远程代码执行，有效性较高，但是需要和其它漏洞配合利用，才能达成RCE。

**投毒风险分析：**

PoC 代码本身主要功能是进行漏洞验证和利用，直接植入恶意代码的概率较低。 但仍然存在一定的风险，例如：

*   **恶意代码混淆：** 攻击者可能将恶意代码隐藏在看似无害的字符串或函数中。
*   **依赖项投毒：** PoC 代码可能依赖于外部库或模块，如果这些依赖项被篡改，则可能引入恶意代码。

基于提供的代码，经过分析，判断投毒风险较低，但是仍然不能排除。该代码尝试利用漏洞，但是执行命令的部分是通过写入webshell实现的，增加webshell写入位置的随机性有可能被用于逃避检测，因此有一定的概率(10%)被用于投毒。

**项目地址:** [r0xdeadbeef/CVE-2021-26855](https://github.com/r0xdeadbeef/CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #20

**来源**: [CVE-2021-26855-shacojx_CVE-2021-26855-exploit-Exchange.md](../2021/CVE-2021-26855-shacojx_CVE-2021-26855-exploit-Exchange.md)

## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞（ProxyLogon）

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 受影响的Exchange Server 2013, 2016, 2019 Cumulative Updates

**利用条件:** 需要能够访问 Exchange Server 的 OWA 接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，是 ProxyLogon 攻击链的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求并作为 Exchange 服务器进行身份验证。从搜索引擎结果和漏洞库信息可以得知，这是一个被广泛利用的漏洞，存在公开的PoC，并且被CISA添加到已知被利用的漏洞目录中。 

**漏洞利用方式:**

1.  **SSRF (CVE-2021-26855):** 利用 SSRF 漏洞绕过身份验证。
2.  **构造请求:** 攻击者首先发送一个包含特定 Cookie 的 GET 请求，利用 SSRF 漏洞。
3.  **NTLM 认证:** 使用 NTLM 认证绕过。
4.  **获取 FQDN:** 通过 NTLM type2 协议获取服务器的 FQDN (Fully Qualified Domain Name)。
5.  **发送恶意 XML:** 构造恶意的 XML 数据，通过 POST 请求发送到 Exchange Web Services (EWS) 端点，利用后端组件处理 XML 时存在的漏洞执行任意代码。  
6.  **用户枚举:**  PoC 代码还包含用户枚举的功能，增加了攻击面。

**有效性：**

提供的 Go 代码是一个可用的 PoC。它包含了漏洞验证、NTLM 认证和发送恶意 XML 数据的步骤。代码结构清晰，逻辑完整，可以直接用于检测和利用该漏洞。

**投毒风险：**

虽然代码看起来主要实现了漏洞利用的功能，但仍存在一定投毒风险的可能性：
* 用户枚举模块可能被滥用，用于非法收集用户信息。
* 代码中存在一些硬编码的参数和路径，可能在特定环境下不可用，需要使用者修改，可能存在被诱导修改恶意代码。
* 风险评估为 10%，因为代码的主要功能是漏洞利用，而非恶意行为，但是存在被滥用和修改的潜在风险。

**项目地址:** [shacojx/CVE-2021-26855-exploit-Exchange](https://github.com/shacojx/CVE-2021-26855-exploit-Exchange)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #21

**来源**: [CVE-2021-26855-shacojx_Scan-Vuln-CVE-2021-26855.md](../2021/CVE-2021-26855-shacojx_Scan-Vuln-CVE-2021-26855.md)

## CVE-2021-26855 - Microsoft Exchange Server SSRF

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要能够访问Exchange Server的端口，通常是443端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞发送任意 HTTP 请求并以 Exchange 服务器的身份进行身份验证，从而绕过身份验证。

**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码判断，该漏洞利用代码的有效性较高。大量的信息表明这是一个已知的、被广泛利用的漏洞，并且CISA已知可利用漏洞目录中包含了此漏洞。

**投毒风险：**
检视提供的代码，主要包含以下几个部分：
1.  `README.md`: 包含漏洞描述和图片。
2.  `build.xml`: Ant构建脚本，用于编译Java项目。
3.  `ipVuln.txt`: 空文件，可能用于存储易受攻击的IP地址列表。
4.  `list-ip.txt`: 包含一个IP地址（`192.168.1.0`），可能用于扫描。
5.  `manifest.mf`: JAR文件的清单文件。
6.  `Tool-Build/Run.bat`: 用于运行编译后的JAR文件的批处理脚本。
7.  `Tool-Build/ipVuln.txt`: 空文件，与上面的`ipVuln.txt`相同。
8.  `Tool-Build/list-ip.txt`: 包含一个IP地址（`192.168.1.0`），可能用于扫描，与上面的`list-ip.txt`相同。
9.  `Tool-Build/Nmap/scripts/http-vuln-cve2021-26855.nse`: Nmap脚本，用于检测目标是否受CVE-2021-26855漏洞影响。这个脚本是漏洞检测的核心。

主要风险点在于`build.xml`构建脚本和`http-vuln-cve2021-26855.nse`这个Nmap脚本。构建脚本可能被修改以包含恶意代码，虽然在这个例子中看起来比较简单，但无法完全排除隐蔽的后门代码存在的可能性。Nmap脚本本身看起来是合法的漏洞检测脚本，但理论上，如果脚本被篡改，可能存在投毒风险。例如，在检测到漏洞时，植入后门或执行恶意操作。
总体评估，投毒风险较低，约为10%，因为主要的代码功能是漏洞扫描，而不是漏洞利用，且代码量不大，容易审计。

**利用方式：**
利用方式通常涉及以下步骤：
1.  **SSRF:** 攻击者利用SSRF漏洞向Exchange服务器发送精心构造的HTTP请求。
2.  **身份验证绕过：** 通过SSRF漏洞，攻击者可以绕过身份验证，模拟Exchange服务器上的其他用户。
3.  **远程代码执行：** 在成功绕过身份验证后，攻击者可以进一步利用其他漏洞（如不安全的deserialization）来执行任意代码。根据搜索引擎结果，CVE-2021-26855是ProxyLogon攻击链的初始漏洞。

综上所述，此漏洞的有效性高，利用方式较为明确，但提供的代码主要用于扫描而非直接利用，因此投毒风险较低。攻击者可以通过SSRF漏洞绕过身份验证，然后利用其他漏洞实现远程代码执行。

**项目地址:** [shacojx/Scan-Vuln-CVE-2021-26855](https://github.com/shacojx/Scan-Vuln-CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #22

**来源**: [CVE-2021-26855-ssrsec_Microsoft-Exchange-RCE.md](../2021/CVE-2021-26855-ssrsec_Microsoft-Exchange-RCE.md)

## CVE-2021-26855 & CVE-2021-27065 - Microsoft Exchange Server RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要能够访问目标 Exchange 服务器的网络端口 (通常是443)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞利用链包括 CVE-2021-26855 (SSRF) 和 CVE-2021-27065 (不安全的反序列化导致RCE)。

**利用方式：**

1.  **SSRF (CVE-2021-26855):** 利用服务器端请求伪造漏洞，攻击者可以发送任意HTTP请求并伪装成Exchange服务器进行身份验证。POC代码首先发送一个NTLM协商请求到`/rpc/`端点，利用返回的`WWW-Authenticate`头中的信息来获取目标Exchange服务器的计算机名和域名。
2.  **RCE (CVE-2021-27065):** 利用获取的计算机名，结合一个已知的邮箱地址格式，构造一个包含`LegacyDN`的请求，发送到`/ecp/baba.js`，最终通过写入webshell来实现远程代码执行。其中，`baba.js`是一个占位符，攻击者可以通过修改这个值，上传任意的webshell。

**有效性：**

根据提供的漏洞信息、搜索结果以及POC代码，可以判断此POC代码是有效的，该漏洞利用是公开的，影响范围广泛。搜索结果也表明该漏洞已被广泛利用。

**投毒风险：**

代码主要功能是利用漏洞，但存在潜在的投毒风险。风险点在于：

*   **Webshell 内容：** Webshell的内容（`<script language="JScript" runat="server">function Page_Load(){eval(Request["babanb"],"unsafe");}</script>`）是固定的，攻击者可能会修改这个内容，植入恶意代码，或者植入更加隐蔽的后门。目前是直接在ecp目录下写了baba.js的文件,比较容易被发现。
*   **依赖项风险：**虽然代码量少，但仍然可能引入有安全风险的第三方库，虽然这里没有体现。
*  **邮件用户列表:** 代码中使用了一个邮件用户列表进行尝试。这个列表可能被修改，用于针对特定目标进行攻击，或者用于搜集敏感信息。

虽然存在风险，但整体代码逻辑较为清晰，风险较低。投毒风险评估为10%。

**项目地址:** [ssrsec/Microsoft-Exchange-RCE](https://github.com/ssrsec/Microsoft-Exchange-RCE)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #23

**来源**: [CVE-2021-26855-thau0x01_poc_proxylogon.md](../2021/CVE-2021-26855-thau0x01_poc_proxylogon.md)

## CVE-2021-26855 Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 受影响的版本包括：Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange Server开放443端口，且未安装相关安全补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 (ProxyLogon) 是一种存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞。未经身份验证的远程攻击者可以通过发送精心构造的 HTTP 请求来利用此漏洞，从而能够伪造身份并执行其他恶意操作。从搜索结果来看，该漏洞被广泛利用。提供的PoC代码展示了利用该漏洞获取远程代码执行权限的过程。

**漏洞利用方式：**

1.  **SSRF (CVE-2021-26855):** 首先，利用SSRF漏洞发送任意HTTP请求，目的是绕过身份验证，获取有效的LegacyDN。
2.  **获取 LegacyDN:** 通过构造Autodiscover请求，获取目标用户的 LegacyDN。
3.  **MAPI 连接:** 使用获取的LegacyDN建立一个MAPI会话。
4.  **获取 SID:** 从MAPI响应中提取用户的安全标识符 (SID)。
5.  **ProxyLogon:** 利用ProxyLogon机制，将用户SID修改为管理员SID，从而提升权限。
6.  **写入 Webshell:** 利用提升的权限，向服务器写入webshell，实现远程代码执行。

**投毒风险分析：**

代码中存在以下潜在的投毒风险：

*   **硬编码的路径和文件名：** `shell_path`和`shell_absolute_path`以及`ahihi7.aspx`是硬编码的，这使得webshell容易被检测和移除，但如果攻击者修改了这些值，可能会将webshell写入到更隐蔽的位置。
*   **webshell 内容：** `shell_content`包含执行 `whoami` 命令的JavaScript代码，这是一个简单的测试命令。攻击者可以修改`shell_content`以执行更具破坏性的操作。虽然当前代码只是执行`whoami`，但不能排除攻击者将恶意代码注入`shell_content`的可能性。这一部分存在被恶意修改进行投毒的可能性。
*   **代理URI (`msExchProxyUri`)**: PoC代码中 `msExchProxyUri` 设置为`http://127.0.0.1:8080/`，这意味着攻击者可能尝试通过本地代理进行其他攻击，或者将流量转发到恶意服务器。虽然现在指向本地，但存在被修改指向恶意地址的可能性。

虽然这些风险存在，但整体代码看起来是为了验证漏洞，主要的目的是为了RCE，没有明显的隐藏后门或者其他恶意行为。因此，投毒风险较低, 约5%。

**项目地址:** [thau0x01/poc_proxylogon](https://github.com/thau0x01/poc_proxylogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #24

**来源**: [CVE-2021-26855-timb-machine-mirrors_testanull-CVE-2021-26855_read_poc.txt.md](../2021/CVE-2021-26855-timb-machine-mirrors_testanull-CVE-2021-26855_read_poc.txt.md)

## CVE-2021-26855-Microsoft Exchange Server-SSRF

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造（SSRF）漏洞。根据搜索结果和漏洞描述，未经验证的远程攻击者可以利用此漏洞发送任意 HTTP 请求并模拟 Exchange 服务器进行身份验证。该漏洞是 ProxyLogon 攻击链的关键组成部分。提供的POC代码尝试通过 `POST /ecp/poc-2021-26855.js HTTP/1.1` 发送 SOAP 请求，通过修改 `X-BEResource` cookie 绕过身份验证，进而执行其他操作。由于请求的目标是 EWS (Exchange Web Services)，这允许攻击者访问和操作邮箱数据。分析代码中,没有发现作者隐藏的投毒代码。

**利用方式：**

1.  **SSRF 攻击：** 利用 CVE-2021-26855，攻击者可以向 Exchange 服务器发送伪造的 HTTP 请求。
2.  **身份验证绕过：** 通过操纵 `X-BEResource` cookie，攻击者可以绕过身份验证，冒充合法用户。
3.  **邮箱访问：** 一旦成功绕过身份验证，攻击者可以使用 EWS 接口访问和操作邮箱数据，例如读取邮件、联系人等。
4.  **链式利用：** CVE-2021-26855 通常与其他 Exchange 漏洞（如 CVE-2021-26857、CVE-2021-26858、CVE-2021-27065）结合使用，形成 ProxyLogon 攻击链，最终实现远程代码执行。

**项目地址:** [timb-machine-mirrors/testanull-CVE-2021-26855_read_poc.txt](https://github.com/timb-machine-mirrors/testanull-CVE-2021-26855_read_poc.txt)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

## POC #25

**来源**: [CVE-2021-26855-yaoxiaoangry3_Flangvik.md](../2021/CVE-2021-26855-yaoxiaoangry3_Flangvik.md)

## CVE-2021-26855 Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Microsoft Exchange Server 2013、2016 和 2019 的多个累积更新版本，具体版本参见漏洞库信息

**利用条件:** 目标Exchange服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 漏洞链的一部分。攻击者可以利用此漏洞发送任意 HTTP 请求并可能绕过身份验证。

**有效性分析：**
根据提供的漏洞库信息，此漏洞影响多个版本的 Microsoft Exchange Server，CVSS 评分为 9.1，表明其严重性。
搜索结果显示，此漏洞被广泛利用，并且有公开的 PoC 可用，参考网页标题包含"ProxyLogon"的网页信息可以知道。
提供的漏洞利用代码描述表明它是一个 C# PoC，支持半交互式的 web shell 以及 shellcode 执行。
综合来看，提供的 POC 代码是有效的。

**投毒风险分析：**
提供的代码片段 `/tmp/e24bb8b01b99c84300e1ac6fb58f9709/README.md` 只显示了关于 PoC 的简短描述，无法直接判断是否存在投毒代码。由于是 C# PoC，投毒代码可能隐藏在编译后的二进制文件中。仅仅通过 README.md 文件判断，存在误判可能性，但是根据以往经验，开源社区存在一定的投毒行为，因此给出一定百分比。

**利用方式分析：**
1.  利用 CVE-2021-26855 的 SSRF 漏洞，攻击者可以绕过身份验证。
2.  成功绕过身份验证后，攻击者可以利用后续漏洞（例如 CVE-2021-26857）写入任意文件。
3.  写入的文件可以是一个 ASPX web shell，允许攻击者执行任意代码。
4.  或者，攻击者可以使用 shellcode 直接在服务器上执行恶意代码。
该漏洞是 ProxyLogon 攻击链的初始入口点，为后续攻击铺平道路。

**项目地址:** [yaoxiaoangry3/Flangvik](https://github.com/yaoxiaoangry3/Flangvik)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)

---

