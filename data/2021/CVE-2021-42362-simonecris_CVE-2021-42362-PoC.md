# CVE-2021-42362

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-42362-samiba6_CVE-2021-42362.md](../2021/CVE-2021-42362-samiba6_CVE-2021-42362.md)

## CVE-2021-42362-WordPress Popular Posts-任意文件上传

**漏洞编号:** CVE-2021-42362

**漏洞类型:** 任意文件上传

**影响应用:** WordPress Popular Posts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.3.2

**利用条件:** 需要Contributor或以上权限的WordPress用户账户，目标WordPress站点安装了WordPress Popular Posts插件且版本低于等于5.3.2，目标服务器允许HTTPS连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WordPress Popular Posts插件的图片上传功能中，由于~/src/Image.php文件对上传文件类型验证不足，具有Contributor或以上权限的攻击者可以上传恶意文件（如包含PHP代码的GIF文件），从而获得远程代码执行的能力。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要拥有一个具有Contributor或更高权限的WordPress帐户。POC代码通过`wp-login.php`端点使用提供的用户名和密码进行身份验证，并保存session。
2.  **获取`wpp-admin-token` 和 `wpp_nonce`:** 插件设置页面包含一个隐藏的`wpp-admin-token`，此token用于后续的请求。同时尝试获取`wpp_nonce`，用于进行ajax验证，如果无法获取，将使用wp_nonce。
3.  **上传恶意文件：** PoC代码首先尝试使用filebin.net服务上传包含PHP Webshell代码的GIF文件。如果成功，则获取上传文件的URL。
4.  **漏洞利用:**  PoC代码**未提供**利用上传文件漏洞的具体利用步骤，代码到获取`wpp_nonce`就结束了。可以推测，需要找到插件中调用该上传图片文件的函数，执行恶意代码。

**有效性评估：**
提供的POC代码能够完成身份验证和`wpp-admin-token` 和 `wpp_nonce`的获取，但缺少最终利用文件上传漏洞的步骤，无法直接实现RCE，但为进一步利用打下了基础。因此，该POC是**部分有效**的，需要补充文件上传后的利用步骤才能实现完整的攻击流程。

**投毒风险评估：**
检查了POC代码，没有发现明显的投毒行为。脚本的主要功能是利用漏洞，而非在目标系统上植入其他恶意代码或修改系统配置。

**结论：**
此漏洞的利用需要攻击者首先通过身份验证，然后利用文件上传漏洞执行恶意代码。提供的PoC代码简化了身份验证和`wpp-admin-token`获取的过程，提高了漏洞利用的效率。  虽然PoC并不完整，但它指出了漏洞利用的关键步骤，有助于安全研究人员理解和修复该漏洞。

**项目地址:** [samiba6/CVE-2021-42362](https://github.com/samiba6/CVE-2021-42362)

**漏洞详情:** [CVE-2021-42362](https://nvd.nist.gov/vuln/detail/CVE-2021-42362)

---

## POC #2

**来源**: [CVE-2021-42362-simonecris_CVE-2021-42362-PoC.md](../2021/CVE-2021-42362-simonecris_CVE-2021-42362-PoC.md)

# CVE-2021-42362

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-42362-samiba6_CVE-2021-42362.md](../2021/CVE-2021-42362-samiba6_CVE-2021-42362.md)

## CVE-2021-42362-WordPress Popular Posts-任意文件上传

**漏洞编号:** CVE-2021-42362

**漏洞类型:** 任意文件上传

**影响应用:** WordPress Popular Posts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.3.2

**利用条件:** 需要Contributor或以上权限的WordPress用户账户，目标WordPress站点安装了WordPress Popular Posts插件且版本低于等于5.3.2，目标服务器允许HTTPS连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WordPress Popular Posts插件的图片上传功能中，由于~/src/Image.php文件对上传文件类型验证不足，具有Contributor或以上权限的攻击者可以上传恶意文件（如包含PHP代码的GIF文件），从而获得远程代码执行的能力。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要拥有一个具有Contributor或更高权限的WordPress帐户。POC代码通过`wp-login.php`端点使用提供的用户名和密码进行身份验证，并保存session。
2.  **获取`wpp-admin-token` 和 `wpp_nonce`:** 插件设置页面包含一个隐藏的`wpp-admin-token`，此token用于后续的请求。同时尝试获取`wpp_nonce`，用于进行ajax验证，如果无法获取，将使用wp_nonce。
3.  **上传恶意文件：** PoC代码首先尝试使用filebin.net服务上传包含PHP Webshell代码的GIF文件。如果成功，则获取上传文件的URL。
4.  **漏洞利用:**  PoC代码**未提供**利用上传文件漏洞的具体利用步骤，代码到获取`wpp_nonce`就结束了。可以推测，需要找到插件中调用该上传图片文件的函数，执行恶意代码。

**有效性评估：**
提供的POC代码能够完成身份验证和`wpp-admin-token` 和 `wpp_nonce`的获取，但缺少最终利用文件上传漏洞的步骤，无法直接实现RCE，但为进一步利用打下了基础。因此，该POC是**部分有效**的，需要补充文件上传后的利用步骤才能实现完整的攻击流程。

**投毒风险评估：**
检查了POC代码，没有发现明显的投毒行为。脚本的主要功能是利用漏洞，而非在目标系统上植入其他恶意代码或修改系统配置。

**结论：**
此漏洞的利用需要攻击者首先通过身份验证，然后利用文件上传漏洞执行恶意代码。提供的PoC代码简化了身份验证和`wpp-admin-token`获取的过程，提高了漏洞利用的效率。  虽然PoC并不完整，但它指出了漏洞利用的关键步骤，有助于安全研究人员理解和修复该漏洞。

**项目地址:** [samiba6/CVE-2021-42362](https://github.com/samiba6/CVE-2021-42362)

**漏洞详情:** [CVE-2021-42362](https://nvd.nist.gov/vuln/detail/CVE-2021-42362)

---

## POC #2

**来源**: [CVE-2021-42362-simonecris_CVE-2021-42362-PoC.md](../2021/CVE-2021-42362-simonecris_CVE-2021-42362-PoC.md)

# CVE-2021-42362

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-42362-samiba6_CVE-2021-42362.md](../2021/CVE-2021-42362-samiba6_CVE-2021-42362.md)

## CVE-2021-42362-WordPress Popular Posts-任意文件上传

**漏洞编号:** CVE-2021-42362

**漏洞类型:** 任意文件上传

**影响应用:** WordPress Popular Posts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.3.2

**利用条件:** 需要Contributor或以上权限的WordPress用户账户，目标WordPress站点安装了WordPress Popular Posts插件且版本低于等于5.3.2，目标服务器允许HTTPS连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WordPress Popular Posts插件的图片上传功能中，由于~/src/Image.php文件对上传文件类型验证不足，具有Contributor或以上权限的攻击者可以上传恶意文件（如包含PHP代码的GIF文件），从而获得远程代码执行的能力。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要拥有一个具有Contributor或更高权限的WordPress帐户。POC代码通过`wp-login.php`端点使用提供的用户名和密码进行身份验证，并保存session。
2.  **获取`wpp-admin-token` 和 `wpp_nonce`:** 插件设置页面包含一个隐藏的`wpp-admin-token`，此token用于后续的请求。同时尝试获取`wpp_nonce`，用于进行ajax验证，如果无法获取，将使用wp_nonce。
3.  **上传恶意文件：** PoC代码首先尝试使用filebin.net服务上传包含PHP Webshell代码的GIF文件。如果成功，则获取上传文件的URL。
4.  **漏洞利用:**  PoC代码**未提供**利用上传文件漏洞的具体利用步骤，代码到获取`wpp_nonce`就结束了。可以推测，需要找到插件中调用该上传图片文件的函数，执行恶意代码。

**有效性评估：**
提供的POC代码能够完成身份验证和`wpp-admin-token` 和 `wpp_nonce`的获取，但缺少最终利用文件上传漏洞的步骤，无法直接实现RCE，但为进一步利用打下了基础。因此，该POC是**部分有效**的，需要补充文件上传后的利用步骤才能实现完整的攻击流程。

**投毒风险评估：**
检查了POC代码，没有发现明显的投毒行为。脚本的主要功能是利用漏洞，而非在目标系统上植入其他恶意代码或修改系统配置。

**结论：**
此漏洞的利用需要攻击者首先通过身份验证，然后利用文件上传漏洞执行恶意代码。提供的PoC代码简化了身份验证和`wpp-admin-token`获取的过程，提高了漏洞利用的效率。  虽然PoC并不完整，但它指出了漏洞利用的关键步骤，有助于安全研究人员理解和修复该漏洞。

**项目地址:** [samiba6/CVE-2021-42362](https://github.com/samiba6/CVE-2021-42362)

**漏洞详情:** [CVE-2021-42362](https://nvd.nist.gov/vuln/detail/CVE-2021-42362)

---

## POC #2

**来源**: [CVE-2021-42362-simonecris_CVE-2021-42362-PoC.md](../2021/CVE-2021-42362-simonecris_CVE-2021-42362-PoC.md)

# CVE-2021-42362

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-42362-samiba6_CVE-2021-42362.md](../2021/CVE-2021-42362-samiba6_CVE-2021-42362.md)

## CVE-2021-42362-WordPress Popular Posts-任意文件上传

**漏洞编号:** CVE-2021-42362

**漏洞类型:** 任意文件上传

**影响应用:** WordPress Popular Posts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.3.2

**利用条件:** 需要Contributor或以上权限的WordPress用户账户，目标WordPress站点安装了WordPress Popular Posts插件且版本低于等于5.3.2，目标服务器允许HTTPS连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WordPress Popular Posts插件的图片上传功能中，由于~/src/Image.php文件对上传文件类型验证不足，具有Contributor或以上权限的攻击者可以上传恶意文件（如包含PHP代码的GIF文件），从而获得远程代码执行的能力。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要拥有一个具有Contributor或更高权限的WordPress帐户。POC代码通过`wp-login.php`端点使用提供的用户名和密码进行身份验证，并保存session。
2.  **获取`wpp-admin-token` 和 `wpp_nonce`:** 插件设置页面包含一个隐藏的`wpp-admin-token`，此token用于后续的请求。同时尝试获取`wpp_nonce`，用于进行ajax验证，如果无法获取，将使用wp_nonce。
3.  **上传恶意文件：** PoC代码首先尝试使用filebin.net服务上传包含PHP Webshell代码的GIF文件。如果成功，则获取上传文件的URL。
4.  **漏洞利用:**  PoC代码**未提供**利用上传文件漏洞的具体利用步骤，代码到获取`wpp_nonce`就结束了。可以推测，需要找到插件中调用该上传图片文件的函数，执行恶意代码。

**有效性评估：**
提供的POC代码能够完成身份验证和`wpp-admin-token` 和 `wpp_nonce`的获取，但缺少最终利用文件上传漏洞的步骤，无法直接实现RCE，但为进一步利用打下了基础。因此，该POC是**部分有效**的，需要补充文件上传后的利用步骤才能实现完整的攻击流程。

**投毒风险评估：**
检查了POC代码，没有发现明显的投毒行为。脚本的主要功能是利用漏洞，而非在目标系统上植入其他恶意代码或修改系统配置。

**结论：**
此漏洞的利用需要攻击者首先通过身份验证，然后利用文件上传漏洞执行恶意代码。提供的PoC代码简化了身份验证和`wpp-admin-token`获取的过程，提高了漏洞利用的效率。  虽然PoC并不完整，但它指出了漏洞利用的关键步骤，有助于安全研究人员理解和修复该漏洞。

**项目地址:** [samiba6/CVE-2021-42362](https://github.com/samiba6/CVE-2021-42362)

**漏洞详情:** [CVE-2021-42362](https://nvd.nist.gov/vuln/detail/CVE-2021-42362)

---

## POC #2

**来源**: [CVE-2021-42362-simonecris_CVE-2021-42362-PoC.md](../2021/CVE-2021-42362-simonecris_CVE-2021-42362-PoC.md)

# CVE-2021-42362

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-42362-samiba6_CVE-2021-42362.md](../2021/CVE-2021-42362-samiba6_CVE-2021-42362.md)

## CVE-2021-42362-WordPress Popular Posts-任意文件上传

**漏洞编号:** CVE-2021-42362

**漏洞类型:** 任意文件上传

**影响应用:** WordPress Popular Posts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.3.2

**利用条件:** 需要Contributor或以上权限的WordPress用户账户，目标WordPress站点安装了WordPress Popular Posts插件且版本低于等于5.3.2，目标服务器允许HTTPS连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WordPress Popular Posts插件的图片上传功能中，由于~/src/Image.php文件对上传文件类型验证不足，具有Contributor或以上权限的攻击者可以上传恶意文件（如包含PHP代码的GIF文件），从而获得远程代码执行的能力。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要拥有一个具有Contributor或更高权限的WordPress帐户。POC代码通过`wp-login.php`端点使用提供的用户名和密码进行身份验证，并保存session。
2.  **获取`wpp-admin-token` 和 `wpp_nonce`:** 插件设置页面包含一个隐藏的`wpp-admin-token`，此token用于后续的请求。同时尝试获取`wpp_nonce`，用于进行ajax验证，如果无法获取，将使用wp_nonce。
3.  **上传恶意文件：** PoC代码首先尝试使用filebin.net服务上传包含PHP Webshell代码的GIF文件。如果成功，则获取上传文件的URL。
4.  **漏洞利用:**  PoC代码**未提供**利用上传文件漏洞的具体利用步骤，代码到获取`wpp_nonce`就结束了。可以推测，需要找到插件中调用该上传图片文件的函数，执行恶意代码。

**有效性评估：**
提供的POC代码能够完成身份验证和`wpp-admin-token` 和 `wpp_nonce`的获取，但缺少最终利用文件上传漏洞的步骤，无法直接实现RCE，但为进一步利用打下了基础。因此，该POC是**部分有效**的，需要补充文件上传后的利用步骤才能实现完整的攻击流程。

**投毒风险评估：**
检查了POC代码，没有发现明显的投毒行为。脚本的主要功能是利用漏洞，而非在目标系统上植入其他恶意代码或修改系统配置。

**结论：**
此漏洞的利用需要攻击者首先通过身份验证，然后利用文件上传漏洞执行恶意代码。提供的PoC代码简化了身份验证和`wpp-admin-token`获取的过程，提高了漏洞利用的效率。  虽然PoC并不完整，但它指出了漏洞利用的关键步骤，有助于安全研究人员理解和修复该漏洞。

**项目地址:** [samiba6/CVE-2021-42362](https://github.com/samiba6/CVE-2021-42362)

**漏洞详情:** [CVE-2021-42362](https://nvd.nist.gov/vuln/detail/CVE-2021-42362)

---

## POC #2

**来源**: [CVE-2021-42362-simonecris_CVE-2021-42362-PoC.md](../2021/CVE-2021-42362-simonecris_CVE-2021-42362-PoC.md)

# CVE-2021-42362

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-42362-samiba6_CVE-2021-42362.md](../2021/CVE-2021-42362-samiba6_CVE-2021-42362.md)

## CVE-2021-42362-WordPress Popular Posts-任意文件上传

**漏洞编号:** CVE-2021-42362

**漏洞类型:** 任意文件上传

**影响应用:** WordPress Popular Posts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.3.2

**利用条件:** 需要Contributor或以上权限的WordPress用户账户，目标WordPress站点安装了WordPress Popular Posts插件且版本低于等于5.3.2，目标服务器允许HTTPS连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WordPress Popular Posts插件的图片上传功能中，由于~/src/Image.php文件对上传文件类型验证不足，具有Contributor或以上权限的攻击者可以上传恶意文件（如包含PHP代码的GIF文件），从而获得远程代码执行的能力。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要拥有一个具有Contributor或更高权限的WordPress帐户。POC代码通过`wp-login.php`端点使用提供的用户名和密码进行身份验证，并保存session。
2.  **获取`wpp-admin-token` 和 `wpp_nonce`:** 插件设置页面包含一个隐藏的`wpp-admin-token`，此token用于后续的请求。同时尝试获取`wpp_nonce`，用于进行ajax验证，如果无法获取，将使用wp_nonce。
3.  **上传恶意文件：** PoC代码首先尝试使用filebin.net服务上传包含PHP Webshell代码的GIF文件。如果成功，则获取上传文件的URL。
4.  **漏洞利用:**  PoC代码**未提供**利用上传文件漏洞的具体利用步骤，代码到获取`wpp_nonce`就结束了。可以推测，需要找到插件中调用该上传图片文件的函数，执行恶意代码。

**有效性评估：**
提供的POC代码能够完成身份验证和`wpp-admin-token` 和 `wpp_nonce`的获取，但缺少最终利用文件上传漏洞的步骤，无法直接实现RCE，但为进一步利用打下了基础。因此，该POC是**部分有效**的，需要补充文件上传后的利用步骤才能实现完整的攻击流程。

**投毒风险评估：**
检查了POC代码，没有发现明显的投毒行为。脚本的主要功能是利用漏洞，而非在目标系统上植入其他恶意代码或修改系统配置。

**结论：**
此漏洞的利用需要攻击者首先通过身份验证，然后利用文件上传漏洞执行恶意代码。提供的PoC代码简化了身份验证和`wpp-admin-token`获取的过程，提高了漏洞利用的效率。  虽然PoC并不完整，但它指出了漏洞利用的关键步骤，有助于安全研究人员理解和修复该漏洞。

**项目地址:** [samiba6/CVE-2021-42362](https://github.com/samiba6/CVE-2021-42362)

**漏洞详情:** [CVE-2021-42362](https://nvd.nist.gov/vuln/detail/CVE-2021-42362)

---

## POC #2

**来源**: [CVE-2021-42362-simonecris_CVE-2021-42362-PoC.md](../2021/CVE-2021-42362-simonecris_CVE-2021-42362-PoC.md)

# CVE-2021-42362

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-42362-samiba6_CVE-2021-42362.md](../2021/CVE-2021-42362-samiba6_CVE-2021-42362.md)

## CVE-2021-42362-WordPress Popular Posts-任意文件上传

**漏洞编号:** CVE-2021-42362

**漏洞类型:** 任意文件上传

**影响应用:** WordPress Popular Posts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.3.2

**利用条件:** 需要Contributor或以上权限的WordPress用户账户，目标WordPress站点安装了WordPress Popular Posts插件且版本低于等于5.3.2，目标服务器允许HTTPS连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WordPress Popular Posts插件的图片上传功能中，由于~/src/Image.php文件对上传文件类型验证不足，具有Contributor或以上权限的攻击者可以上传恶意文件（如包含PHP代码的GIF文件），从而获得远程代码执行的能力。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要拥有一个具有Contributor或更高权限的WordPress帐户。POC代码通过`wp-login.php`端点使用提供的用户名和密码进行身份验证，并保存session。
2.  **获取`wpp-admin-token` 和 `wpp_nonce`:** 插件设置页面包含一个隐藏的`wpp-admin-token`，此token用于后续的请求。同时尝试获取`wpp_nonce`，用于进行ajax验证，如果无法获取，将使用wp_nonce。
3.  **上传恶意文件：** PoC代码首先尝试使用filebin.net服务上传包含PHP Webshell代码的GIF文件。如果成功，则获取上传文件的URL。
4.  **漏洞利用:**  PoC代码**未提供**利用上传文件漏洞的具体利用步骤，代码到获取`wpp_nonce`就结束了。可以推测，需要找到插件中调用该上传图片文件的函数，执行恶意代码。

**有效性评估：**
提供的POC代码能够完成身份验证和`wpp-admin-token` 和 `wpp_nonce`的获取，但缺少最终利用文件上传漏洞的步骤，无法直接实现RCE，但为进一步利用打下了基础。因此，该POC是**部分有效**的，需要补充文件上传后的利用步骤才能实现完整的攻击流程。

**投毒风险评估：**
检查了POC代码，没有发现明显的投毒行为。脚本的主要功能是利用漏洞，而非在目标系统上植入其他恶意代码或修改系统配置。

**结论：**
此漏洞的利用需要攻击者首先通过身份验证，然后利用文件上传漏洞执行恶意代码。提供的PoC代码简化了身份验证和`wpp-admin-token`获取的过程，提高了漏洞利用的效率。  虽然PoC并不完整，但它指出了漏洞利用的关键步骤，有助于安全研究人员理解和修复该漏洞。

**项目地址:** [samiba6/CVE-2021-42362](https://github.com/samiba6/CVE-2021-42362)

**漏洞详情:** [CVE-2021-42362](https://nvd.nist.gov/vuln/detail/CVE-2021-42362)

---

## POC #2

**来源**: [CVE-2021-42362-simonecris_CVE-2021-42362-PoC.md](../2021/CVE-2021-42362-simonecris_CVE-2021-42362-PoC.md)

## CVE-2021-42362 - WordPress Popular Posts <= 5.3.2 认证后的任意文件上传导致RCE

**漏洞编号:** CVE-2021-42362

**漏洞类型:** 任意文件上传

**影响应用:** WordPress Popular Posts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.3.2

**利用条件:** 需要具有Contributor或更高级别的权限的WordPress用户账户

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-42362 是一个存在于 WordPress Popular Posts 插件 5.3.2 及更早版本中的漏洞。该漏洞允许具有 Contributor 或更高级别权限的已认证用户上传任意文件，从而可能导致远程代码执行(RCE)。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞的利用是可行的。漏洞利用代码尝试通过上传包含恶意 PHP 代码的 GIF 文件来实现 RCE。通过分析漏洞利用代码, 可以发现其利用了插件中图片上传功能中存在的文件类型验证不严谨的问题。

**投毒风险分析：**

分析提供的 POC 代码，发现其中存在一定的投毒风险。虽然主要功能是利用漏洞进行 RCE，但代码中存在以下潜在的投毒点：

1.  **依赖第三方API:** 代码使用了 `https://api.bayfiles.com/upload` API来上传webshell。如果此API被劫持或恶意篡改,可能导致上传恶意代码或泄露用户隐私信息.

2.  **硬编码的 webshell 地址:** 代码在上传webshell后, 会硬编码包含此webshell的 URL地址。如果此URL地址发生变化，或者包含恶意重定向，则可能导致攻击失败或者引导用户访问恶意网站。

3.  **webshell内容:** 攻击者可以在`payload`变量中添加恶意代码,实现反向shell连接等攻击。

因此，综合考虑, 存在20%的投毒风险。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要拥有 WordPress 网站上具有 Contributor 或更高级别权限的账户。POC代码首先尝试使用提供的用户名和密码进行身份验证。
2.  **上传恶意文件：**  攻击者利用插件的图片上传功能，上传一个包含 PHP 代码的 GIF 文件。由于文件类型验证不严格，攻击者可以绕过验证。
3.  **远程代码执行：**  一旦恶意文件上传成功，攻击者就可以通过访问该文件来执行其中的 PHP 代码，从而实现 RCE。
4.  **获取 `wpp-admin-token`:**  POC代码尝试从 WordPress 设置页面提取 `wpp-admin-token`。此 token 用于绕过某些安全检查。
5.  **利用上传的文件执行代码:** 通过访问上传的恶意文件，攻击者执行预先设定的命令，从而控制服务器。


**项目地址:** [simonecris/CVE-2021-42362-PoC](https://github.com/simonecris/CVE-2021-42362-PoC)

**漏洞详情:** [CVE-2021-42362](https://nvd.nist.gov/vuln/detail/CVE-2021-42362)

---



---



---



---



---



---



---

