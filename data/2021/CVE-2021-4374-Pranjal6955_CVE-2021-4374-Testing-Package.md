# CVE-2021-4374

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md](../2021/CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md)

# CVE-2021-4374

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md](../2021/CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md)

# CVE-2021-4374

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md](../2021/CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md)

# CVE-2021-4374

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md](../2021/CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md)

# CVE-2021-4374

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md](../2021/CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md)

# CVE-2021-4374

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md](../2021/CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md)

# CVE-2021-4374

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md](../2021/CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md)

# CVE-2021-4374

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md](../2021/CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md)

# CVE-2021-4374

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md](../2021/CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md)

# CVE-2021-4374

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md](../2021/CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md)

# CVE-2021-4374

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md](../2021/CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md)

# CVE-2021-4374

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md](../2021/CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md)

# CVE-2021-4374

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md](../2021/CVE-2021-4374-Pranjal6955_CVE-2021-4374-Testing-Package.md)

## CVE-2021-4374-WordPress Automatic Plugin-ä»»æ„é€‰é¡¹æ›´æ–°

**æ¼æ´ç¼–å·:** CVE-2021-4374

**æ¼æ´ç±»å‹:** ä»»æ„é€‰é¡¹æ›´æ–°

**å½±å“åº”ç”¨:** WordPress Automatic Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç½‘ç«™è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 3.53.2

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œå¯ç›´æ¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2021-4374 å­˜åœ¨äº WordPress Automatic æ’ä»¶ä¸­ï¼Œç”±äº process_form.php æ–‡ä»¶ä¸­ç¼ºå°‘æˆæƒå’Œé€‰é¡¹éªŒè¯ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥æ›´æ–°æ’ä»¶çš„è®¾ç½®ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç½‘ç«™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

*   Docker Compose æ–‡ä»¶ï¼Œç”¨äºå¿«é€Ÿæ­å»ºåŒ…å« WordPress å’Œ MySQL çš„æµ‹è¯•ç¯å¢ƒã€‚
*   Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚
*   æµ‹è¯•è„šæœ¬ï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
*   åˆ›å»ºæ¨¡æ‹Ÿæ˜“å—æ”»å‡»ç«¯ç‚¹çš„è„šæœ¬ï¼Œç”¨äºåœ¨æ²¡æœ‰çœŸå®æ’ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•ã€‚

è¯¥æµ‹è¯•ç¯å¢ƒèƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥æ¼æ´åˆ©ç”¨ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œç”¨äºéªŒè¯ CVE-2021-4374 æ¼æ´ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›é£é™©ï¼Œä½†æ€»ä½“æŠ•æ¯’é£é™©è¾ƒä½ï¼š

*   **é£é™©ç‚¹ï¼š** `setup-mock-endpoint.sh` è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„æ˜“å—æ”»å‡»ç«¯ç‚¹ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„ä½¿ç”¨ã€‚
*   **ç¼“è§£æªæ–½ï¼š** è¯¥è„šæœ¬æ˜ç¡®æ ‡è®°ä¸ºâ€œMOCK VULNERABLE ENDPOINT - FOR TESTING ONLYâ€ï¼Œå¹¶ä¸”åªåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ç”¨æˆ·åº”ä»”ç»†é˜…è¯»è¯´æ˜æ–‡æ¡£ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥è„šæœ¬ã€‚
*   **ä»£ç å®¡è®¡ï¼š** ç”¨æˆ·å¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œä»¥ç¡®ä¿å…¶ä¸­ä¸åŒ…å«æ¶æ„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯é£é™©è¾ƒä½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»£ç å®¡è®¡å’Œéµå¾ªå®‰å…¨å»ºè®®æ¥é™ä½é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é€šè¿‡å‘é€æ¶æ„æ„é€ çš„ POST è¯·æ±‚åˆ° `wp-content/plugins/wp-automatic/process_form.php` æ–‡ä»¶ï¼Œè¯¥è¯·æ±‚åŒ…å«è¦æ›´æ–°çš„é€‰é¡¹å’Œå¯¹åº”çš„å€¼ã€‚
2.  ç”±äºç¼ºå°‘æˆæƒéªŒè¯ï¼Œæ’ä»¶ä¼šç›´æ¥æ›´æ–°é€‰é¡¹çš„å€¼ï¼Œè€Œæ— éœ€éªŒè¯è¯·æ±‚çš„æ¥æºå’Œç”¨æˆ·çš„èº«ä»½ã€‚
3.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä¿®æ”¹æ’ä»¶çš„è®¾ç½®ï¼Œä¾‹å¦‚ï¼š
    *   æ·»åŠ æ¶æ„ä»£ç åˆ°æ’ä»¶çš„æ¨¡æ¿ä¸­ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
    *   ä¿®æ”¹æ’ä»¶çš„ API å¯†é’¥ï¼Œæ§åˆ¶æ’ä»¶ä¸å…¶ä»–æœåŠ¡çš„äº¤äº’ã€‚
    *   ç¦ç”¨æ’ä»¶çš„åŠŸèƒ½ï¼Œå¯¼è‡´ç½‘ç«™æ— æ³•æ­£å¸¸è¿è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Pranjal6955/cve-2021-4374-test](https://github.com/Pranjal6955/cve-2021-4374-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-4374](https://nvd.nist.gov/vuln/detail/CVE-2021-4374)

---

## POC #2

**æ¥æº**: [CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md](../2021/CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md)

## CVE-2021-4374-WordPress Automatic Plugin-ä»»æ„é€‰é¡¹æ›´æ–°

**æ¼æ´ç¼–å·:** CVE-2021-4374

**æ¼æ´ç±»å‹:** ä»»æ„é€‰é¡¹æ›´æ–°

**å½±å“åº”ç”¨:** WordPress Automatic Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç½‘ç«™è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 3.53.2

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œå¯ç›´æ¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2021-4374 å­˜åœ¨äº WordPress Automatic æ’ä»¶ä¸­ï¼Œç”±äº process_form.php æ–‡ä»¶ä¸­ç¼ºå°‘æˆæƒå’Œé€‰é¡¹éªŒè¯ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥æ›´æ–°æ’ä»¶çš„è®¾ç½®ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç½‘ç«™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

*   Docker Compose æ–‡ä»¶ï¼Œç”¨äºå¿«é€Ÿæ­å»ºåŒ…å« WordPress å’Œ MySQL çš„æµ‹è¯•ç¯å¢ƒã€‚
*   Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚
*   æµ‹è¯•è„šæœ¬ï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
*   åˆ›å»ºæ¨¡æ‹Ÿæ˜“å—æ”»å‡»ç«¯ç‚¹çš„è„šæœ¬ï¼Œç”¨äºåœ¨æ²¡æœ‰çœŸå®æ’ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•ã€‚

è¯¥æµ‹è¯•ç¯å¢ƒèƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥æ¼æ´åˆ©ç”¨ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œç”¨äºéªŒè¯ CVE-2021-4374 æ¼æ´ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›é£é™©ï¼Œä½†æ€»ä½“æŠ•æ¯’é£é™©è¾ƒä½ï¼š

*   **é£é™©ç‚¹ï¼š** `setup-mock-endpoint.sh` è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„æ˜“å—æ”»å‡»ç«¯ç‚¹ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„ä½¿ç”¨ã€‚
*   **ç¼“è§£æªæ–½ï¼š** è¯¥è„šæœ¬æ˜ç¡®æ ‡è®°ä¸ºâ€œMOCK VULNERABLE ENDPOINT - FOR TESTING ONLYâ€ï¼Œå¹¶ä¸”åªåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ç”¨æˆ·åº”ä»”ç»†é˜…è¯»è¯´æ˜æ–‡æ¡£ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥è„šæœ¬ã€‚
*   **ä»£ç å®¡è®¡ï¼š** ç”¨æˆ·å¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œä»¥ç¡®ä¿å…¶ä¸­ä¸åŒ…å«æ¶æ„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯é£é™©è¾ƒä½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»£ç å®¡è®¡å’Œéµå¾ªå®‰å…¨å»ºè®®æ¥é™ä½é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é€šè¿‡å‘é€æ¶æ„æ„é€ çš„ POST è¯·æ±‚åˆ° `wp-content/plugins/wp-automatic/process_form.php` æ–‡ä»¶ï¼Œè¯¥è¯·æ±‚åŒ…å«è¦æ›´æ–°çš„é€‰é¡¹å’Œå¯¹åº”çš„å€¼ã€‚
2.  ç”±äºç¼ºå°‘æˆæƒéªŒè¯ï¼Œæ’ä»¶ä¼šç›´æ¥æ›´æ–°é€‰é¡¹çš„å€¼ï¼Œè€Œæ— éœ€éªŒè¯è¯·æ±‚çš„æ¥æºå’Œç”¨æˆ·çš„èº«ä»½ã€‚
3.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä¿®æ”¹æ’ä»¶çš„è®¾ç½®ï¼Œä¾‹å¦‚ï¼š
    *   æ·»åŠ æ¶æ„ä»£ç åˆ°æ’ä»¶çš„æ¨¡æ¿ä¸­ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
    *   ä¿®æ”¹æ’ä»¶çš„ API å¯†é’¥ï¼Œæ§åˆ¶æ’ä»¶ä¸å…¶ä»–æœåŠ¡çš„äº¤äº’ã€‚
    *   ç¦ç”¨æ’ä»¶çš„åŠŸèƒ½ï¼Œå¯¼è‡´ç½‘ç«™æ— æ³•æ­£å¸¸è¿è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Pranjal6955/cve-2021-4374-test](https://github.com/Pranjal6955/cve-2021-4374-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-4374](https://nvd.nist.gov/vuln/detail/CVE-2021-4374)

---



---

## POC #2

**æ¥æº**: [CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md](../2021/CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md)

## CVE-2021-4374-WordPress Automatic Plugin-ä»»æ„é€‰é¡¹æ›´æ–°

**æ¼æ´ç¼–å·:** CVE-2021-4374

**æ¼æ´ç±»å‹:** ä»»æ„é€‰é¡¹æ›´æ–°

**å½±å“åº”ç”¨:** WordPress Automatic Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç½‘ç«™è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 3.53.2

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œå¯ç›´æ¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2021-4374 å­˜åœ¨äº WordPress Automatic æ’ä»¶ä¸­ï¼Œç”±äº process_form.php æ–‡ä»¶ä¸­ç¼ºå°‘æˆæƒå’Œé€‰é¡¹éªŒè¯ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥æ›´æ–°æ’ä»¶çš„è®¾ç½®ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç½‘ç«™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

*   Docker Compose æ–‡ä»¶ï¼Œç”¨äºå¿«é€Ÿæ­å»ºåŒ…å« WordPress å’Œ MySQL çš„æµ‹è¯•ç¯å¢ƒã€‚
*   Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚
*   æµ‹è¯•è„šæœ¬ï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
*   åˆ›å»ºæ¨¡æ‹Ÿæ˜“å—æ”»å‡»ç«¯ç‚¹çš„è„šæœ¬ï¼Œç”¨äºåœ¨æ²¡æœ‰çœŸå®æ’ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•ã€‚

è¯¥æµ‹è¯•ç¯å¢ƒèƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥æ¼æ´åˆ©ç”¨ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œç”¨äºéªŒè¯ CVE-2021-4374 æ¼æ´ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›é£é™©ï¼Œä½†æ€»ä½“æŠ•æ¯’é£é™©è¾ƒä½ï¼š

*   **é£é™©ç‚¹ï¼š** `setup-mock-endpoint.sh` è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„æ˜“å—æ”»å‡»ç«¯ç‚¹ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„ä½¿ç”¨ã€‚
*   **ç¼“è§£æªæ–½ï¼š** è¯¥è„šæœ¬æ˜ç¡®æ ‡è®°ä¸ºâ€œMOCK VULNERABLE ENDPOINT - FOR TESTING ONLYâ€ï¼Œå¹¶ä¸”åªåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ç”¨æˆ·åº”ä»”ç»†é˜…è¯»è¯´æ˜æ–‡æ¡£ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥è„šæœ¬ã€‚
*   **ä»£ç å®¡è®¡ï¼š** ç”¨æˆ·å¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œä»¥ç¡®ä¿å…¶ä¸­ä¸åŒ…å«æ¶æ„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯é£é™©è¾ƒä½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»£ç å®¡è®¡å’Œéµå¾ªå®‰å…¨å»ºè®®æ¥é™ä½é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é€šè¿‡å‘é€æ¶æ„æ„é€ çš„ POST è¯·æ±‚åˆ° `wp-content/plugins/wp-automatic/process_form.php` æ–‡ä»¶ï¼Œè¯¥è¯·æ±‚åŒ…å«è¦æ›´æ–°çš„é€‰é¡¹å’Œå¯¹åº”çš„å€¼ã€‚
2.  ç”±äºç¼ºå°‘æˆæƒéªŒè¯ï¼Œæ’ä»¶ä¼šç›´æ¥æ›´æ–°é€‰é¡¹çš„å€¼ï¼Œè€Œæ— éœ€éªŒè¯è¯·æ±‚çš„æ¥æºå’Œç”¨æˆ·çš„èº«ä»½ã€‚
3.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä¿®æ”¹æ’ä»¶çš„è®¾ç½®ï¼Œä¾‹å¦‚ï¼š
    *   æ·»åŠ æ¶æ„ä»£ç åˆ°æ’ä»¶çš„æ¨¡æ¿ä¸­ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
    *   ä¿®æ”¹æ’ä»¶çš„ API å¯†é’¥ï¼Œæ§åˆ¶æ’ä»¶ä¸å…¶ä»–æœåŠ¡çš„äº¤äº’ã€‚
    *   ç¦ç”¨æ’ä»¶çš„åŠŸèƒ½ï¼Œå¯¼è‡´ç½‘ç«™æ— æ³•æ­£å¸¸è¿è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Pranjal6955/cve-2021-4374-test](https://github.com/Pranjal6955/cve-2021-4374-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-4374](https://nvd.nist.gov/vuln/detail/CVE-2021-4374)

---



---

## POC #2

**æ¥æº**: [CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md](../2021/CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md)

## CVE-2021-4374-WordPress Automatic Plugin-ä»»æ„é€‰é¡¹æ›´æ–°

**æ¼æ´ç¼–å·:** CVE-2021-4374

**æ¼æ´ç±»å‹:** ä»»æ„é€‰é¡¹æ›´æ–°

**å½±å“åº”ç”¨:** WordPress Automatic Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç½‘ç«™è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 3.53.2

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œå¯ç›´æ¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2021-4374 å­˜åœ¨äº WordPress Automatic æ’ä»¶ä¸­ï¼Œç”±äº process_form.php æ–‡ä»¶ä¸­ç¼ºå°‘æˆæƒå’Œé€‰é¡¹éªŒè¯ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥æ›´æ–°æ’ä»¶çš„è®¾ç½®ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç½‘ç«™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

*   Docker Compose æ–‡ä»¶ï¼Œç”¨äºå¿«é€Ÿæ­å»ºåŒ…å« WordPress å’Œ MySQL çš„æµ‹è¯•ç¯å¢ƒã€‚
*   Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚
*   æµ‹è¯•è„šæœ¬ï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
*   åˆ›å»ºæ¨¡æ‹Ÿæ˜“å—æ”»å‡»ç«¯ç‚¹çš„è„šæœ¬ï¼Œç”¨äºåœ¨æ²¡æœ‰çœŸå®æ’ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•ã€‚

è¯¥æµ‹è¯•ç¯å¢ƒèƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥æ¼æ´åˆ©ç”¨ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œç”¨äºéªŒè¯ CVE-2021-4374 æ¼æ´ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›é£é™©ï¼Œä½†æ€»ä½“æŠ•æ¯’é£é™©è¾ƒä½ï¼š

*   **é£é™©ç‚¹ï¼š** `setup-mock-endpoint.sh` è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„æ˜“å—æ”»å‡»ç«¯ç‚¹ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„ä½¿ç”¨ã€‚
*   **ç¼“è§£æªæ–½ï¼š** è¯¥è„šæœ¬æ˜ç¡®æ ‡è®°ä¸ºâ€œMOCK VULNERABLE ENDPOINT - FOR TESTING ONLYâ€ï¼Œå¹¶ä¸”åªåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ç”¨æˆ·åº”ä»”ç»†é˜…è¯»è¯´æ˜æ–‡æ¡£ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥è„šæœ¬ã€‚
*   **ä»£ç å®¡è®¡ï¼š** ç”¨æˆ·å¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œä»¥ç¡®ä¿å…¶ä¸­ä¸åŒ…å«æ¶æ„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯é£é™©è¾ƒä½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»£ç å®¡è®¡å’Œéµå¾ªå®‰å…¨å»ºè®®æ¥é™ä½é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é€šè¿‡å‘é€æ¶æ„æ„é€ çš„ POST è¯·æ±‚åˆ° `wp-content/plugins/wp-automatic/process_form.php` æ–‡ä»¶ï¼Œè¯¥è¯·æ±‚åŒ…å«è¦æ›´æ–°çš„é€‰é¡¹å’Œå¯¹åº”çš„å€¼ã€‚
2.  ç”±äºç¼ºå°‘æˆæƒéªŒè¯ï¼Œæ’ä»¶ä¼šç›´æ¥æ›´æ–°é€‰é¡¹çš„å€¼ï¼Œè€Œæ— éœ€éªŒè¯è¯·æ±‚çš„æ¥æºå’Œç”¨æˆ·çš„èº«ä»½ã€‚
3.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä¿®æ”¹æ’ä»¶çš„è®¾ç½®ï¼Œä¾‹å¦‚ï¼š
    *   æ·»åŠ æ¶æ„ä»£ç åˆ°æ’ä»¶çš„æ¨¡æ¿ä¸­ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
    *   ä¿®æ”¹æ’ä»¶çš„ API å¯†é’¥ï¼Œæ§åˆ¶æ’ä»¶ä¸å…¶ä»–æœåŠ¡çš„äº¤äº’ã€‚
    *   ç¦ç”¨æ’ä»¶çš„åŠŸèƒ½ï¼Œå¯¼è‡´ç½‘ç«™æ— æ³•æ­£å¸¸è¿è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Pranjal6955/cve-2021-4374-test](https://github.com/Pranjal6955/cve-2021-4374-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-4374](https://nvd.nist.gov/vuln/detail/CVE-2021-4374)

---



---

## POC #2

**æ¥æº**: [CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md](../2021/CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md)

## CVE-2021-4374-WordPress Automatic Plugin-ä»»æ„é€‰é¡¹æ›´æ–°

**æ¼æ´ç¼–å·:** CVE-2021-4374

**æ¼æ´ç±»å‹:** ä»»æ„é€‰é¡¹æ›´æ–°

**å½±å“åº”ç”¨:** WordPress Automatic Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç½‘ç«™è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 3.53.2

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œå¯ç›´æ¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2021-4374 å­˜åœ¨äº WordPress Automatic æ’ä»¶ä¸­ï¼Œç”±äº process_form.php æ–‡ä»¶ä¸­ç¼ºå°‘æˆæƒå’Œé€‰é¡¹éªŒè¯ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥æ›´æ–°æ’ä»¶çš„è®¾ç½®ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç½‘ç«™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

*   Docker Compose æ–‡ä»¶ï¼Œç”¨äºå¿«é€Ÿæ­å»ºåŒ…å« WordPress å’Œ MySQL çš„æµ‹è¯•ç¯å¢ƒã€‚
*   Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚
*   æµ‹è¯•è„šæœ¬ï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
*   åˆ›å»ºæ¨¡æ‹Ÿæ˜“å—æ”»å‡»ç«¯ç‚¹çš„è„šæœ¬ï¼Œç”¨äºåœ¨æ²¡æœ‰çœŸå®æ’ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•ã€‚

è¯¥æµ‹è¯•ç¯å¢ƒèƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥æ¼æ´åˆ©ç”¨ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œç”¨äºéªŒè¯ CVE-2021-4374 æ¼æ´ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›é£é™©ï¼Œä½†æ€»ä½“æŠ•æ¯’é£é™©è¾ƒä½ï¼š

*   **é£é™©ç‚¹ï¼š** `setup-mock-endpoint.sh` è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„æ˜“å—æ”»å‡»ç«¯ç‚¹ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„ä½¿ç”¨ã€‚
*   **ç¼“è§£æªæ–½ï¼š** è¯¥è„šæœ¬æ˜ç¡®æ ‡è®°ä¸ºâ€œMOCK VULNERABLE ENDPOINT - FOR TESTING ONLYâ€ï¼Œå¹¶ä¸”åªåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ç”¨æˆ·åº”ä»”ç»†é˜…è¯»è¯´æ˜æ–‡æ¡£ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥è„šæœ¬ã€‚
*   **ä»£ç å®¡è®¡ï¼š** ç”¨æˆ·å¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œä»¥ç¡®ä¿å…¶ä¸­ä¸åŒ…å«æ¶æ„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯é£é™©è¾ƒä½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»£ç å®¡è®¡å’Œéµå¾ªå®‰å…¨å»ºè®®æ¥é™ä½é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é€šè¿‡å‘é€æ¶æ„æ„é€ çš„ POST è¯·æ±‚åˆ° `wp-content/plugins/wp-automatic/process_form.php` æ–‡ä»¶ï¼Œè¯¥è¯·æ±‚åŒ…å«è¦æ›´æ–°çš„é€‰é¡¹å’Œå¯¹åº”çš„å€¼ã€‚
2.  ç”±äºç¼ºå°‘æˆæƒéªŒè¯ï¼Œæ’ä»¶ä¼šç›´æ¥æ›´æ–°é€‰é¡¹çš„å€¼ï¼Œè€Œæ— éœ€éªŒè¯è¯·æ±‚çš„æ¥æºå’Œç”¨æˆ·çš„èº«ä»½ã€‚
3.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä¿®æ”¹æ’ä»¶çš„è®¾ç½®ï¼Œä¾‹å¦‚ï¼š
    *   æ·»åŠ æ¶æ„ä»£ç åˆ°æ’ä»¶çš„æ¨¡æ¿ä¸­ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
    *   ä¿®æ”¹æ’ä»¶çš„ API å¯†é’¥ï¼Œæ§åˆ¶æ’ä»¶ä¸å…¶ä»–æœåŠ¡çš„äº¤äº’ã€‚
    *   ç¦ç”¨æ’ä»¶çš„åŠŸèƒ½ï¼Œå¯¼è‡´ç½‘ç«™æ— æ³•æ­£å¸¸è¿è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Pranjal6955/cve-2021-4374-test](https://github.com/Pranjal6955/cve-2021-4374-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-4374](https://nvd.nist.gov/vuln/detail/CVE-2021-4374)

---



---

## POC #2

**æ¥æº**: [CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md](../2021/CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md)

## CVE-2021-4374-WordPress Automatic Plugin-ä»»æ„é€‰é¡¹æ›´æ–°

**æ¼æ´ç¼–å·:** CVE-2021-4374

**æ¼æ´ç±»å‹:** ä»»æ„é€‰é¡¹æ›´æ–°

**å½±å“åº”ç”¨:** WordPress Automatic Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç½‘ç«™è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 3.53.2

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œå¯ç›´æ¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2021-4374 å­˜åœ¨äº WordPress Automatic æ’ä»¶ä¸­ï¼Œç”±äº process_form.php æ–‡ä»¶ä¸­ç¼ºå°‘æˆæƒå’Œé€‰é¡¹éªŒè¯ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥æ›´æ–°æ’ä»¶çš„è®¾ç½®ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç½‘ç«™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

*   Docker Compose æ–‡ä»¶ï¼Œç”¨äºå¿«é€Ÿæ­å»ºåŒ…å« WordPress å’Œ MySQL çš„æµ‹è¯•ç¯å¢ƒã€‚
*   Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚
*   æµ‹è¯•è„šæœ¬ï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
*   åˆ›å»ºæ¨¡æ‹Ÿæ˜“å—æ”»å‡»ç«¯ç‚¹çš„è„šæœ¬ï¼Œç”¨äºåœ¨æ²¡æœ‰çœŸå®æ’ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•ã€‚

è¯¥æµ‹è¯•ç¯å¢ƒèƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥æ¼æ´åˆ©ç”¨ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œç”¨äºéªŒè¯ CVE-2021-4374 æ¼æ´ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›é£é™©ï¼Œä½†æ€»ä½“æŠ•æ¯’é£é™©è¾ƒä½ï¼š

*   **é£é™©ç‚¹ï¼š** `setup-mock-endpoint.sh` è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„æ˜“å—æ”»å‡»ç«¯ç‚¹ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„ä½¿ç”¨ã€‚
*   **ç¼“è§£æªæ–½ï¼š** è¯¥è„šæœ¬æ˜ç¡®æ ‡è®°ä¸ºâ€œMOCK VULNERABLE ENDPOINT - FOR TESTING ONLYâ€ï¼Œå¹¶ä¸”åªåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ç”¨æˆ·åº”ä»”ç»†é˜…è¯»è¯´æ˜æ–‡æ¡£ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥è„šæœ¬ã€‚
*   **ä»£ç å®¡è®¡ï¼š** ç”¨æˆ·å¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œä»¥ç¡®ä¿å…¶ä¸­ä¸åŒ…å«æ¶æ„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯é£é™©è¾ƒä½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»£ç å®¡è®¡å’Œéµå¾ªå®‰å…¨å»ºè®®æ¥é™ä½é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é€šè¿‡å‘é€æ¶æ„æ„é€ çš„ POST è¯·æ±‚åˆ° `wp-content/plugins/wp-automatic/process_form.php` æ–‡ä»¶ï¼Œè¯¥è¯·æ±‚åŒ…å«è¦æ›´æ–°çš„é€‰é¡¹å’Œå¯¹åº”çš„å€¼ã€‚
2.  ç”±äºç¼ºå°‘æˆæƒéªŒè¯ï¼Œæ’ä»¶ä¼šç›´æ¥æ›´æ–°é€‰é¡¹çš„å€¼ï¼Œè€Œæ— éœ€éªŒè¯è¯·æ±‚çš„æ¥æºå’Œç”¨æˆ·çš„èº«ä»½ã€‚
3.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä¿®æ”¹æ’ä»¶çš„è®¾ç½®ï¼Œä¾‹å¦‚ï¼š
    *   æ·»åŠ æ¶æ„ä»£ç åˆ°æ’ä»¶çš„æ¨¡æ¿ä¸­ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
    *   ä¿®æ”¹æ’ä»¶çš„ API å¯†é’¥ï¼Œæ§åˆ¶æ’ä»¶ä¸å…¶ä»–æœåŠ¡çš„äº¤äº’ã€‚
    *   ç¦ç”¨æ’ä»¶çš„åŠŸèƒ½ï¼Œå¯¼è‡´ç½‘ç«™æ— æ³•æ­£å¸¸è¿è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Pranjal6955/cve-2021-4374-test](https://github.com/Pranjal6955/cve-2021-4374-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-4374](https://nvd.nist.gov/vuln/detail/CVE-2021-4374)

---



---

## POC #2

**æ¥æº**: [CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md](../2021/CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md)

## CVE-2021-4374-WordPress Automatic Plugin-ä»»æ„é€‰é¡¹æ›´æ–°

**æ¼æ´ç¼–å·:** CVE-2021-4374

**æ¼æ´ç±»å‹:** ä»»æ„é€‰é¡¹æ›´æ–°

**å½±å“åº”ç”¨:** WordPress Automatic Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç½‘ç«™è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 3.53.2

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œå¯ç›´æ¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2021-4374 å­˜åœ¨äº WordPress Automatic æ’ä»¶ä¸­ï¼Œç”±äº process_form.php æ–‡ä»¶ä¸­ç¼ºå°‘æˆæƒå’Œé€‰é¡¹éªŒè¯ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥æ›´æ–°æ’ä»¶çš„è®¾ç½®ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç½‘ç«™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

*   Docker Compose æ–‡ä»¶ï¼Œç”¨äºå¿«é€Ÿæ­å»ºåŒ…å« WordPress å’Œ MySQL çš„æµ‹è¯•ç¯å¢ƒã€‚
*   Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚
*   æµ‹è¯•è„šæœ¬ï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
*   åˆ›å»ºæ¨¡æ‹Ÿæ˜“å—æ”»å‡»ç«¯ç‚¹çš„è„šæœ¬ï¼Œç”¨äºåœ¨æ²¡æœ‰çœŸå®æ’ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•ã€‚

è¯¥æµ‹è¯•ç¯å¢ƒèƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥æ¼æ´åˆ©ç”¨ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œç”¨äºéªŒè¯ CVE-2021-4374 æ¼æ´ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›é£é™©ï¼Œä½†æ€»ä½“æŠ•æ¯’é£é™©è¾ƒä½ï¼š

*   **é£é™©ç‚¹ï¼š** `setup-mock-endpoint.sh` è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„æ˜“å—æ”»å‡»ç«¯ç‚¹ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„ä½¿ç”¨ã€‚
*   **ç¼“è§£æªæ–½ï¼š** è¯¥è„šæœ¬æ˜ç¡®æ ‡è®°ä¸ºâ€œMOCK VULNERABLE ENDPOINT - FOR TESTING ONLYâ€ï¼Œå¹¶ä¸”åªåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ç”¨æˆ·åº”ä»”ç»†é˜…è¯»è¯´æ˜æ–‡æ¡£ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥è„šæœ¬ã€‚
*   **ä»£ç å®¡è®¡ï¼š** ç”¨æˆ·å¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œä»¥ç¡®ä¿å…¶ä¸­ä¸åŒ…å«æ¶æ„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯é£é™©è¾ƒä½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»£ç å®¡è®¡å’Œéµå¾ªå®‰å…¨å»ºè®®æ¥é™ä½é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é€šè¿‡å‘é€æ¶æ„æ„é€ çš„ POST è¯·æ±‚åˆ° `wp-content/plugins/wp-automatic/process_form.php` æ–‡ä»¶ï¼Œè¯¥è¯·æ±‚åŒ…å«è¦æ›´æ–°çš„é€‰é¡¹å’Œå¯¹åº”çš„å€¼ã€‚
2.  ç”±äºç¼ºå°‘æˆæƒéªŒè¯ï¼Œæ’ä»¶ä¼šç›´æ¥æ›´æ–°é€‰é¡¹çš„å€¼ï¼Œè€Œæ— éœ€éªŒè¯è¯·æ±‚çš„æ¥æºå’Œç”¨æˆ·çš„èº«ä»½ã€‚
3.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä¿®æ”¹æ’ä»¶çš„è®¾ç½®ï¼Œä¾‹å¦‚ï¼š
    *   æ·»åŠ æ¶æ„ä»£ç åˆ°æ’ä»¶çš„æ¨¡æ¿ä¸­ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
    *   ä¿®æ”¹æ’ä»¶çš„ API å¯†é’¥ï¼Œæ§åˆ¶æ’ä»¶ä¸å…¶ä»–æœåŠ¡çš„äº¤äº’ã€‚
    *   ç¦ç”¨æ’ä»¶çš„åŠŸèƒ½ï¼Œå¯¼è‡´ç½‘ç«™æ— æ³•æ­£å¸¸è¿è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Pranjal6955/cve-2021-4374-test](https://github.com/Pranjal6955/cve-2021-4374-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-4374](https://nvd.nist.gov/vuln/detail/CVE-2021-4374)

---



---

## POC #2

**æ¥æº**: [CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md](../2021/CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md)

## CVE-2021-4374-WordPress Automatic Plugin-ä»»æ„é€‰é¡¹æ›´æ–°

**æ¼æ´ç¼–å·:** CVE-2021-4374

**æ¼æ´ç±»å‹:** ä»»æ„é€‰é¡¹æ›´æ–°

**å½±å“åº”ç”¨:** WordPress Automatic Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç½‘ç«™è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 3.53.2

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œå¯ç›´æ¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2021-4374 å­˜åœ¨äº WordPress Automatic æ’ä»¶ä¸­ï¼Œç”±äº process_form.php æ–‡ä»¶ä¸­ç¼ºå°‘æˆæƒå’Œé€‰é¡¹éªŒè¯ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥æ›´æ–°æ’ä»¶çš„è®¾ç½®ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç½‘ç«™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

*   Docker Compose æ–‡ä»¶ï¼Œç”¨äºå¿«é€Ÿæ­å»ºåŒ…å« WordPress å’Œ MySQL çš„æµ‹è¯•ç¯å¢ƒã€‚
*   Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚
*   æµ‹è¯•è„šæœ¬ï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
*   åˆ›å»ºæ¨¡æ‹Ÿæ˜“å—æ”»å‡»ç«¯ç‚¹çš„è„šæœ¬ï¼Œç”¨äºåœ¨æ²¡æœ‰çœŸå®æ’ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•ã€‚

è¯¥æµ‹è¯•ç¯å¢ƒèƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥æ¼æ´åˆ©ç”¨ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œç”¨äºéªŒè¯ CVE-2021-4374 æ¼æ´ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›é£é™©ï¼Œä½†æ€»ä½“æŠ•æ¯’é£é™©è¾ƒä½ï¼š

*   **é£é™©ç‚¹ï¼š** `setup-mock-endpoint.sh` è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„æ˜“å—æ”»å‡»ç«¯ç‚¹ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„ä½¿ç”¨ã€‚
*   **ç¼“è§£æªæ–½ï¼š** è¯¥è„šæœ¬æ˜ç¡®æ ‡è®°ä¸ºâ€œMOCK VULNERABLE ENDPOINT - FOR TESTING ONLYâ€ï¼Œå¹¶ä¸”åªåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ç”¨æˆ·åº”ä»”ç»†é˜…è¯»è¯´æ˜æ–‡æ¡£ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥è„šæœ¬ã€‚
*   **ä»£ç å®¡è®¡ï¼š** ç”¨æˆ·å¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œä»¥ç¡®ä¿å…¶ä¸­ä¸åŒ…å«æ¶æ„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯é£é™©è¾ƒä½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»£ç å®¡è®¡å’Œéµå¾ªå®‰å…¨å»ºè®®æ¥é™ä½é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é€šè¿‡å‘é€æ¶æ„æ„é€ çš„ POST è¯·æ±‚åˆ° `wp-content/plugins/wp-automatic/process_form.php` æ–‡ä»¶ï¼Œè¯¥è¯·æ±‚åŒ…å«è¦æ›´æ–°çš„é€‰é¡¹å’Œå¯¹åº”çš„å€¼ã€‚
2.  ç”±äºç¼ºå°‘æˆæƒéªŒè¯ï¼Œæ’ä»¶ä¼šç›´æ¥æ›´æ–°é€‰é¡¹çš„å€¼ï¼Œè€Œæ— éœ€éªŒè¯è¯·æ±‚çš„æ¥æºå’Œç”¨æˆ·çš„èº«ä»½ã€‚
3.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä¿®æ”¹æ’ä»¶çš„è®¾ç½®ï¼Œä¾‹å¦‚ï¼š
    *   æ·»åŠ æ¶æ„ä»£ç åˆ°æ’ä»¶çš„æ¨¡æ¿ä¸­ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
    *   ä¿®æ”¹æ’ä»¶çš„ API å¯†é’¥ï¼Œæ§åˆ¶æ’ä»¶ä¸å…¶ä»–æœåŠ¡çš„äº¤äº’ã€‚
    *   ç¦ç”¨æ’ä»¶çš„åŠŸèƒ½ï¼Œå¯¼è‡´ç½‘ç«™æ— æ³•æ­£å¸¸è¿è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Pranjal6955/cve-2021-4374-test](https://github.com/Pranjal6955/cve-2021-4374-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-4374](https://nvd.nist.gov/vuln/detail/CVE-2021-4374)

---



---

## POC #2

**æ¥æº**: [CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md](../2021/CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md)

## CVE-2021-4374-WordPress Automatic Plugin-ä»»æ„é€‰é¡¹æ›´æ–°

**æ¼æ´ç¼–å·:** CVE-2021-4374

**æ¼æ´ç±»å‹:** ä»»æ„é€‰é¡¹æ›´æ–°

**å½±å“åº”ç”¨:** WordPress Automatic Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç½‘ç«™è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 3.53.2

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œå¯ç›´æ¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2021-4374 å­˜åœ¨äº WordPress Automatic æ’ä»¶ä¸­ï¼Œç”±äº process_form.php æ–‡ä»¶ä¸­ç¼ºå°‘æˆæƒå’Œé€‰é¡¹éªŒè¯ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥æ›´æ–°æ’ä»¶çš„è®¾ç½®ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç½‘ç«™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

*   Docker Compose æ–‡ä»¶ï¼Œç”¨äºå¿«é€Ÿæ­å»ºåŒ…å« WordPress å’Œ MySQL çš„æµ‹è¯•ç¯å¢ƒã€‚
*   Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚
*   æµ‹è¯•è„šæœ¬ï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
*   åˆ›å»ºæ¨¡æ‹Ÿæ˜“å—æ”»å‡»ç«¯ç‚¹çš„è„šæœ¬ï¼Œç”¨äºåœ¨æ²¡æœ‰çœŸå®æ’ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•ã€‚

è¯¥æµ‹è¯•ç¯å¢ƒèƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥æ¼æ´åˆ©ç”¨ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œç”¨äºéªŒè¯ CVE-2021-4374 æ¼æ´ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›é£é™©ï¼Œä½†æ€»ä½“æŠ•æ¯’é£é™©è¾ƒä½ï¼š

*   **é£é™©ç‚¹ï¼š** `setup-mock-endpoint.sh` è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„æ˜“å—æ”»å‡»ç«¯ç‚¹ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„ä½¿ç”¨ã€‚
*   **ç¼“è§£æªæ–½ï¼š** è¯¥è„šæœ¬æ˜ç¡®æ ‡è®°ä¸ºâ€œMOCK VULNERABLE ENDPOINT - FOR TESTING ONLYâ€ï¼Œå¹¶ä¸”åªåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ç”¨æˆ·åº”ä»”ç»†é˜…è¯»è¯´æ˜æ–‡æ¡£ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥è„šæœ¬ã€‚
*   **ä»£ç å®¡è®¡ï¼š** ç”¨æˆ·å¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œä»¥ç¡®ä¿å…¶ä¸­ä¸åŒ…å«æ¶æ„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯é£é™©è¾ƒä½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»£ç å®¡è®¡å’Œéµå¾ªå®‰å…¨å»ºè®®æ¥é™ä½é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é€šè¿‡å‘é€æ¶æ„æ„é€ çš„ POST è¯·æ±‚åˆ° `wp-content/plugins/wp-automatic/process_form.php` æ–‡ä»¶ï¼Œè¯¥è¯·æ±‚åŒ…å«è¦æ›´æ–°çš„é€‰é¡¹å’Œå¯¹åº”çš„å€¼ã€‚
2.  ç”±äºç¼ºå°‘æˆæƒéªŒè¯ï¼Œæ’ä»¶ä¼šç›´æ¥æ›´æ–°é€‰é¡¹çš„å€¼ï¼Œè€Œæ— éœ€éªŒè¯è¯·æ±‚çš„æ¥æºå’Œç”¨æˆ·çš„èº«ä»½ã€‚
3.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä¿®æ”¹æ’ä»¶çš„è®¾ç½®ï¼Œä¾‹å¦‚ï¼š
    *   æ·»åŠ æ¶æ„ä»£ç åˆ°æ’ä»¶çš„æ¨¡æ¿ä¸­ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
    *   ä¿®æ”¹æ’ä»¶çš„ API å¯†é’¥ï¼Œæ§åˆ¶æ’ä»¶ä¸å…¶ä»–æœåŠ¡çš„äº¤äº’ã€‚
    *   ç¦ç”¨æ’ä»¶çš„åŠŸèƒ½ï¼Œå¯¼è‡´ç½‘ç«™æ— æ³•æ­£å¸¸è¿è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Pranjal6955/cve-2021-4374-test](https://github.com/Pranjal6955/cve-2021-4374-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-4374](https://nvd.nist.gov/vuln/detail/CVE-2021-4374)

---



---

## POC #2

**æ¥æº**: [CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md](../2021/CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md)

## CVE-2021-4374-WordPress Automatic Plugin-ä»»æ„é€‰é¡¹æ›´æ–°

**æ¼æ´ç¼–å·:** CVE-2021-4374

**æ¼æ´ç±»å‹:** ä»»æ„é€‰é¡¹æ›´æ–°

**å½±å“åº”ç”¨:** WordPress Automatic Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç½‘ç«™è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 3.53.2

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œå¯ç›´æ¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2021-4374 å­˜åœ¨äº WordPress Automatic æ’ä»¶ä¸­ï¼Œç”±äº process_form.php æ–‡ä»¶ä¸­ç¼ºå°‘æˆæƒå’Œé€‰é¡¹éªŒè¯ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥æ›´æ–°æ’ä»¶çš„è®¾ç½®ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç½‘ç«™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

*   Docker Compose æ–‡ä»¶ï¼Œç”¨äºå¿«é€Ÿæ­å»ºåŒ…å« WordPress å’Œ MySQL çš„æµ‹è¯•ç¯å¢ƒã€‚
*   Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚
*   æµ‹è¯•è„šæœ¬ï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
*   åˆ›å»ºæ¨¡æ‹Ÿæ˜“å—æ”»å‡»ç«¯ç‚¹çš„è„šæœ¬ï¼Œç”¨äºåœ¨æ²¡æœ‰çœŸå®æ’ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•ã€‚

è¯¥æµ‹è¯•ç¯å¢ƒèƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥æ¼æ´åˆ©ç”¨ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œç”¨äºéªŒè¯ CVE-2021-4374 æ¼æ´ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›é£é™©ï¼Œä½†æ€»ä½“æŠ•æ¯’é£é™©è¾ƒä½ï¼š

*   **é£é™©ç‚¹ï¼š** `setup-mock-endpoint.sh` è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„æ˜“å—æ”»å‡»ç«¯ç‚¹ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„ä½¿ç”¨ã€‚
*   **ç¼“è§£æªæ–½ï¼š** è¯¥è„šæœ¬æ˜ç¡®æ ‡è®°ä¸ºâ€œMOCK VULNERABLE ENDPOINT - FOR TESTING ONLYâ€ï¼Œå¹¶ä¸”åªåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ç”¨æˆ·åº”ä»”ç»†é˜…è¯»è¯´æ˜æ–‡æ¡£ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥è„šæœ¬ã€‚
*   **ä»£ç å®¡è®¡ï¼š** ç”¨æˆ·å¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œä»¥ç¡®ä¿å…¶ä¸­ä¸åŒ…å«æ¶æ„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯é£é™©è¾ƒä½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»£ç å®¡è®¡å’Œéµå¾ªå®‰å…¨å»ºè®®æ¥é™ä½é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é€šè¿‡å‘é€æ¶æ„æ„é€ çš„ POST è¯·æ±‚åˆ° `wp-content/plugins/wp-automatic/process_form.php` æ–‡ä»¶ï¼Œè¯¥è¯·æ±‚åŒ…å«è¦æ›´æ–°çš„é€‰é¡¹å’Œå¯¹åº”çš„å€¼ã€‚
2.  ç”±äºç¼ºå°‘æˆæƒéªŒè¯ï¼Œæ’ä»¶ä¼šç›´æ¥æ›´æ–°é€‰é¡¹çš„å€¼ï¼Œè€Œæ— éœ€éªŒè¯è¯·æ±‚çš„æ¥æºå’Œç”¨æˆ·çš„èº«ä»½ã€‚
3.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä¿®æ”¹æ’ä»¶çš„è®¾ç½®ï¼Œä¾‹å¦‚ï¼š
    *   æ·»åŠ æ¶æ„ä»£ç åˆ°æ’ä»¶çš„æ¨¡æ¿ä¸­ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
    *   ä¿®æ”¹æ’ä»¶çš„ API å¯†é’¥ï¼Œæ§åˆ¶æ’ä»¶ä¸å…¶ä»–æœåŠ¡çš„äº¤äº’ã€‚
    *   ç¦ç”¨æ’ä»¶çš„åŠŸèƒ½ï¼Œå¯¼è‡´ç½‘ç«™æ— æ³•æ­£å¸¸è¿è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Pranjal6955/cve-2021-4374-test](https://github.com/Pranjal6955/cve-2021-4374-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-4374](https://nvd.nist.gov/vuln/detail/CVE-2021-4374)

---



---

## POC #2

**æ¥æº**: [CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md](../2021/CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md)

## CVE-2021-4374-WordPress Automatic Plugin-ä»»æ„é€‰é¡¹æ›´æ–°

**æ¼æ´ç¼–å·:** CVE-2021-4374

**æ¼æ´ç±»å‹:** ä»»æ„é€‰é¡¹æ›´æ–°

**å½±å“åº”ç”¨:** WordPress Automatic Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç½‘ç«™è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 3.53.2

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œå¯ç›´æ¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2021-4374 å­˜åœ¨äº WordPress Automatic æ’ä»¶ä¸­ï¼Œç”±äº process_form.php æ–‡ä»¶ä¸­ç¼ºå°‘æˆæƒå’Œé€‰é¡¹éªŒè¯ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥æ›´æ–°æ’ä»¶çš„è®¾ç½®ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç½‘ç«™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

*   Docker Compose æ–‡ä»¶ï¼Œç”¨äºå¿«é€Ÿæ­å»ºåŒ…å« WordPress å’Œ MySQL çš„æµ‹è¯•ç¯å¢ƒã€‚
*   Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚
*   æµ‹è¯•è„šæœ¬ï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
*   åˆ›å»ºæ¨¡æ‹Ÿæ˜“å—æ”»å‡»ç«¯ç‚¹çš„è„šæœ¬ï¼Œç”¨äºåœ¨æ²¡æœ‰çœŸå®æ’ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•ã€‚

è¯¥æµ‹è¯•ç¯å¢ƒèƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥æ¼æ´åˆ©ç”¨ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œç”¨äºéªŒè¯ CVE-2021-4374 æ¼æ´ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›é£é™©ï¼Œä½†æ€»ä½“æŠ•æ¯’é£é™©è¾ƒä½ï¼š

*   **é£é™©ç‚¹ï¼š** `setup-mock-endpoint.sh` è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„æ˜“å—æ”»å‡»ç«¯ç‚¹ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„ä½¿ç”¨ã€‚
*   **ç¼“è§£æªæ–½ï¼š** è¯¥è„šæœ¬æ˜ç¡®æ ‡è®°ä¸ºâ€œMOCK VULNERABLE ENDPOINT - FOR TESTING ONLYâ€ï¼Œå¹¶ä¸”åªåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ç”¨æˆ·åº”ä»”ç»†é˜…è¯»è¯´æ˜æ–‡æ¡£ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥è„šæœ¬ã€‚
*   **ä»£ç å®¡è®¡ï¼š** ç”¨æˆ·å¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œä»¥ç¡®ä¿å…¶ä¸­ä¸åŒ…å«æ¶æ„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯é£é™©è¾ƒä½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»£ç å®¡è®¡å’Œéµå¾ªå®‰å…¨å»ºè®®æ¥é™ä½é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é€šè¿‡å‘é€æ¶æ„æ„é€ çš„ POST è¯·æ±‚åˆ° `wp-content/plugins/wp-automatic/process_form.php` æ–‡ä»¶ï¼Œè¯¥è¯·æ±‚åŒ…å«è¦æ›´æ–°çš„é€‰é¡¹å’Œå¯¹åº”çš„å€¼ã€‚
2.  ç”±äºç¼ºå°‘æˆæƒéªŒè¯ï¼Œæ’ä»¶ä¼šç›´æ¥æ›´æ–°é€‰é¡¹çš„å€¼ï¼Œè€Œæ— éœ€éªŒè¯è¯·æ±‚çš„æ¥æºå’Œç”¨æˆ·çš„èº«ä»½ã€‚
3.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä¿®æ”¹æ’ä»¶çš„è®¾ç½®ï¼Œä¾‹å¦‚ï¼š
    *   æ·»åŠ æ¶æ„ä»£ç åˆ°æ’ä»¶çš„æ¨¡æ¿ä¸­ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
    *   ä¿®æ”¹æ’ä»¶çš„ API å¯†é’¥ï¼Œæ§åˆ¶æ’ä»¶ä¸å…¶ä»–æœåŠ¡çš„äº¤äº’ã€‚
    *   ç¦ç”¨æ’ä»¶çš„åŠŸèƒ½ï¼Œå¯¼è‡´ç½‘ç«™æ— æ³•æ­£å¸¸è¿è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Pranjal6955/cve-2021-4374-test](https://github.com/Pranjal6955/cve-2021-4374-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-4374](https://nvd.nist.gov/vuln/detail/CVE-2021-4374)

---



---

## POC #2

**æ¥æº**: [CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md](../2021/CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md)

## CVE-2021-4374-WordPress Automatic Plugin-ä»»æ„é€‰é¡¹æ›´æ–°

**æ¼æ´ç¼–å·:** CVE-2021-4374

**æ¼æ´ç±»å‹:** ä»»æ„é€‰é¡¹æ›´æ–°

**å½±å“åº”ç”¨:** WordPress Automatic Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç½‘ç«™è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 3.53.2

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œå¯ç›´æ¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2021-4374 å­˜åœ¨äº WordPress Automatic æ’ä»¶ä¸­ï¼Œç”±äº process_form.php æ–‡ä»¶ä¸­ç¼ºå°‘æˆæƒå’Œé€‰é¡¹éªŒè¯ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥æ›´æ–°æ’ä»¶çš„è®¾ç½®ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç½‘ç«™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

*   Docker Compose æ–‡ä»¶ï¼Œç”¨äºå¿«é€Ÿæ­å»ºåŒ…å« WordPress å’Œ MySQL çš„æµ‹è¯•ç¯å¢ƒã€‚
*   Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚
*   æµ‹è¯•è„šæœ¬ï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
*   åˆ›å»ºæ¨¡æ‹Ÿæ˜“å—æ”»å‡»ç«¯ç‚¹çš„è„šæœ¬ï¼Œç”¨äºåœ¨æ²¡æœ‰çœŸå®æ’ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•ã€‚

è¯¥æµ‹è¯•ç¯å¢ƒèƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥æ¼æ´åˆ©ç”¨ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œç”¨äºéªŒè¯ CVE-2021-4374 æ¼æ´ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›é£é™©ï¼Œä½†æ€»ä½“æŠ•æ¯’é£é™©è¾ƒä½ï¼š

*   **é£é™©ç‚¹ï¼š** `setup-mock-endpoint.sh` è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„æ˜“å—æ”»å‡»ç«¯ç‚¹ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„ä½¿ç”¨ã€‚
*   **ç¼“è§£æªæ–½ï¼š** è¯¥è„šæœ¬æ˜ç¡®æ ‡è®°ä¸ºâ€œMOCK VULNERABLE ENDPOINT - FOR TESTING ONLYâ€ï¼Œå¹¶ä¸”åªåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ç”¨æˆ·åº”ä»”ç»†é˜…è¯»è¯´æ˜æ–‡æ¡£ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥è„šæœ¬ã€‚
*   **ä»£ç å®¡è®¡ï¼š** ç”¨æˆ·å¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œä»¥ç¡®ä¿å…¶ä¸­ä¸åŒ…å«æ¶æ„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯é£é™©è¾ƒä½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»£ç å®¡è®¡å’Œéµå¾ªå®‰å…¨å»ºè®®æ¥é™ä½é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é€šè¿‡å‘é€æ¶æ„æ„é€ çš„ POST è¯·æ±‚åˆ° `wp-content/plugins/wp-automatic/process_form.php` æ–‡ä»¶ï¼Œè¯¥è¯·æ±‚åŒ…å«è¦æ›´æ–°çš„é€‰é¡¹å’Œå¯¹åº”çš„å€¼ã€‚
2.  ç”±äºç¼ºå°‘æˆæƒéªŒè¯ï¼Œæ’ä»¶ä¼šç›´æ¥æ›´æ–°é€‰é¡¹çš„å€¼ï¼Œè€Œæ— éœ€éªŒè¯è¯·æ±‚çš„æ¥æºå’Œç”¨æˆ·çš„èº«ä»½ã€‚
3.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä¿®æ”¹æ’ä»¶çš„è®¾ç½®ï¼Œä¾‹å¦‚ï¼š
    *   æ·»åŠ æ¶æ„ä»£ç åˆ°æ’ä»¶çš„æ¨¡æ¿ä¸­ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
    *   ä¿®æ”¹æ’ä»¶çš„ API å¯†é’¥ï¼Œæ§åˆ¶æ’ä»¶ä¸å…¶ä»–æœåŠ¡çš„äº¤äº’ã€‚
    *   ç¦ç”¨æ’ä»¶çš„åŠŸèƒ½ï¼Œå¯¼è‡´ç½‘ç«™æ— æ³•æ­£å¸¸è¿è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Pranjal6955/cve-2021-4374-test](https://github.com/Pranjal6955/cve-2021-4374-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-4374](https://nvd.nist.gov/vuln/detail/CVE-2021-4374)

---



---

## POC #2

**æ¥æº**: [CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md](../2021/CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md)

## CVE-2021-4374-WordPress Automatic Plugin-ä»»æ„é€‰é¡¹æ›´æ–°

**æ¼æ´ç¼–å·:** CVE-2021-4374

**æ¼æ´ç±»å‹:** ä»»æ„é€‰é¡¹æ›´æ–°

**å½±å“åº”ç”¨:** WordPress Automatic Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç½‘ç«™è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 3.53.2

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œå¯ç›´æ¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2021-4374 å­˜åœ¨äº WordPress Automatic æ’ä»¶ä¸­ï¼Œç”±äº process_form.php æ–‡ä»¶ä¸­ç¼ºå°‘æˆæƒå’Œé€‰é¡¹éªŒè¯ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥æ›´æ–°æ’ä»¶çš„è®¾ç½®ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç½‘ç«™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

*   Docker Compose æ–‡ä»¶ï¼Œç”¨äºå¿«é€Ÿæ­å»ºåŒ…å« WordPress å’Œ MySQL çš„æµ‹è¯•ç¯å¢ƒã€‚
*   Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚
*   æµ‹è¯•è„šæœ¬ï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
*   åˆ›å»ºæ¨¡æ‹Ÿæ˜“å—æ”»å‡»ç«¯ç‚¹çš„è„šæœ¬ï¼Œç”¨äºåœ¨æ²¡æœ‰çœŸå®æ’ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•ã€‚

è¯¥æµ‹è¯•ç¯å¢ƒèƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥æ¼æ´åˆ©ç”¨ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œç”¨äºéªŒè¯ CVE-2021-4374 æ¼æ´ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›é£é™©ï¼Œä½†æ€»ä½“æŠ•æ¯’é£é™©è¾ƒä½ï¼š

*   **é£é™©ç‚¹ï¼š** `setup-mock-endpoint.sh` è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„æ˜“å—æ”»å‡»ç«¯ç‚¹ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„ä½¿ç”¨ã€‚
*   **ç¼“è§£æªæ–½ï¼š** è¯¥è„šæœ¬æ˜ç¡®æ ‡è®°ä¸ºâ€œMOCK VULNERABLE ENDPOINT - FOR TESTING ONLYâ€ï¼Œå¹¶ä¸”åªåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ç”¨æˆ·åº”ä»”ç»†é˜…è¯»è¯´æ˜æ–‡æ¡£ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥è„šæœ¬ã€‚
*   **ä»£ç å®¡è®¡ï¼š** ç”¨æˆ·å¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œä»¥ç¡®ä¿å…¶ä¸­ä¸åŒ…å«æ¶æ„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯é£é™©è¾ƒä½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»£ç å®¡è®¡å’Œéµå¾ªå®‰å…¨å»ºè®®æ¥é™ä½é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é€šè¿‡å‘é€æ¶æ„æ„é€ çš„ POST è¯·æ±‚åˆ° `wp-content/plugins/wp-automatic/process_form.php` æ–‡ä»¶ï¼Œè¯¥è¯·æ±‚åŒ…å«è¦æ›´æ–°çš„é€‰é¡¹å’Œå¯¹åº”çš„å€¼ã€‚
2.  ç”±äºç¼ºå°‘æˆæƒéªŒè¯ï¼Œæ’ä»¶ä¼šç›´æ¥æ›´æ–°é€‰é¡¹çš„å€¼ï¼Œè€Œæ— éœ€éªŒè¯è¯·æ±‚çš„æ¥æºå’Œç”¨æˆ·çš„èº«ä»½ã€‚
3.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä¿®æ”¹æ’ä»¶çš„è®¾ç½®ï¼Œä¾‹å¦‚ï¼š
    *   æ·»åŠ æ¶æ„ä»£ç åˆ°æ’ä»¶çš„æ¨¡æ¿ä¸­ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
    *   ä¿®æ”¹æ’ä»¶çš„ API å¯†é’¥ï¼Œæ§åˆ¶æ’ä»¶ä¸å…¶ä»–æœåŠ¡çš„äº¤äº’ã€‚
    *   ç¦ç”¨æ’ä»¶çš„åŠŸèƒ½ï¼Œå¯¼è‡´ç½‘ç«™æ— æ³•æ­£å¸¸è¿è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Pranjal6955/cve-2021-4374-test](https://github.com/Pranjal6955/cve-2021-4374-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-4374](https://nvd.nist.gov/vuln/detail/CVE-2021-4374)

---



---

## POC #2

**æ¥æº**: [CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md](../2021/CVE-2021-4374-Pranjal6955_cve-2021-4374-test.md)

## CVE-2021-4374-WordPress Automatic Plugin-ä»»æ„é€‰é¡¹æ›´æ–°

**æ¼æ´ç¼–å·:** CVE-2021-4374

**æ¼æ´ç±»å‹:** ä»»æ„é€‰é¡¹æ›´æ–°

**å½±å“åº”ç”¨:** WordPress Automatic Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç½‘ç«™è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 3.53.2

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€è®¤è¯ï¼Œå¯ç›´æ¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2021-4374 å­˜åœ¨äº WordPress Automatic æ’ä»¶ä¸­ï¼Œç”±äº process_form.php æ–‡ä»¶ä¸­ç¼ºå°‘æˆæƒå’Œé€‰é¡¹éªŒè¯ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥æ›´æ–°æ’ä»¶çš„è®¾ç½®ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç½‘ç«™ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

*   Docker Compose æ–‡ä»¶ï¼Œç”¨äºå¿«é€Ÿæ­å»ºåŒ…å« WordPress å’Œ MySQL çš„æµ‹è¯•ç¯å¢ƒã€‚
*   Nuclei æ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹æ¼æ´ã€‚
*   æµ‹è¯•è„šæœ¬ï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
*   åˆ›å»ºæ¨¡æ‹Ÿæ˜“å—æ”»å‡»ç«¯ç‚¹çš„è„šæœ¬ï¼Œç”¨äºåœ¨æ²¡æœ‰çœŸå®æ’ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•ã€‚

è¯¥æµ‹è¯•ç¯å¢ƒèƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥æ¼æ´åˆ©ç”¨ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œç”¨äºéªŒè¯ CVE-2021-4374 æ¼æ´ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›é£é™©ï¼Œä½†æ€»ä½“æŠ•æ¯’é£é™©è¾ƒä½ï¼š

*   **é£é™©ç‚¹ï¼š** `setup-mock-endpoint.sh` è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„æ˜“å—æ”»å‡»ç«¯ç‚¹ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„ä½¿ç”¨ã€‚
*   **ç¼“è§£æªæ–½ï¼š** è¯¥è„šæœ¬æ˜ç¡®æ ‡è®°ä¸ºâ€œMOCK VULNERABLE ENDPOINT - FOR TESTING ONLYâ€ï¼Œå¹¶ä¸”åªåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ç”¨æˆ·åº”ä»”ç»†é˜…è¯»è¯´æ˜æ–‡æ¡£ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥è„šæœ¬ã€‚
*   **ä»£ç å®¡è®¡ï¼š** ç”¨æˆ·å¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œä»¥ç¡®ä¿å…¶ä¸­ä¸åŒ…å«æ¶æ„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯é£é™©è¾ƒä½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»£ç å®¡è®¡å’Œéµå¾ªå®‰å…¨å»ºè®®æ¥é™ä½é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é€šè¿‡å‘é€æ¶æ„æ„é€ çš„ POST è¯·æ±‚åˆ° `wp-content/plugins/wp-automatic/process_form.php` æ–‡ä»¶ï¼Œè¯¥è¯·æ±‚åŒ…å«è¦æ›´æ–°çš„é€‰é¡¹å’Œå¯¹åº”çš„å€¼ã€‚
2.  ç”±äºç¼ºå°‘æˆæƒéªŒè¯ï¼Œæ’ä»¶ä¼šç›´æ¥æ›´æ–°é€‰é¡¹çš„å€¼ï¼Œè€Œæ— éœ€éªŒè¯è¯·æ±‚çš„æ¥æºå’Œç”¨æˆ·çš„èº«ä»½ã€‚
3.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä¿®æ”¹æ’ä»¶çš„è®¾ç½®ï¼Œä¾‹å¦‚ï¼š
    *   æ·»åŠ æ¶æ„ä»£ç åˆ°æ’ä»¶çš„æ¨¡æ¿ä¸­ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
    *   ä¿®æ”¹æ’ä»¶çš„ API å¯†é’¥ï¼Œæ§åˆ¶æ’ä»¶ä¸å…¶ä»–æœåŠ¡çš„äº¤äº’ã€‚
    *   ç¦ç”¨æ’ä»¶çš„åŠŸèƒ½ï¼Œå¯¼è‡´ç½‘ç«™æ— æ³•æ­£å¸¸è¿è¡Œã€‚

**é¡¹ç›®åœ°å€:** [Pranjal6955/cve-2021-4374-test](https://github.com/Pranjal6955/cve-2021-4374-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2021-4374](https://nvd.nist.gov/vuln/detail/CVE-2021-4374)

---

