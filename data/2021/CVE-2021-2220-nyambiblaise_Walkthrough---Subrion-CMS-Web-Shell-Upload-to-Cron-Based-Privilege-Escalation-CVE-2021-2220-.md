## CVE-2021-2220 - Subrion CMS 任意文件上传/远程代码执行(RCE)/权限提升

**漏洞编号:** CVE-2021-2220

**漏洞类型:** 任意文件上传/远程代码执行(RCE)/权限提升

**影响应用:** Subrion CMS

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 4.2.1及以下版本

**利用条件:** 需要后台管理权限进行文件上传，或利用不当配置进行未授权访问，随后结合计划任务(Cron)进行本地提权。

**POC 可用性:** 4/10

**POC 类型:** 仅说明

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：根据提供的输入数据，该POC（CVE-2021-2220）主要描述了在Subrion CMS中从Web-Shell上传到基于Cron的权限提升的完整链条。虽然README文件本身并没有包含具体的Python或二进制利用代码，但它指向了一个明确的利用路径：首先在Subrion CMS 4.2.1中利用已知的任意文件上传漏洞（通常由于对.php后缀过滤不严或由于.phtml等后缀未加入黑名单）上传一个Web-Shell。获得Web服务器权限（通常是www-data用户）后，攻击者通过分析系统内的定时任务（Cron jobs），发现存在以Root或其他高权限用户运行的脚本，且该脚本对当前低权限用户可写，从而实现权限提升。此POC属于典型的“演练指南”类型，其有效性取决于目标环境是否严格遵循OffSec Lab（Exfiltrated）的配置。在实际防御研究中，此类文档的价值在于揭示了攻击者如何组合多个低风险漏洞形成高风险链条。利用步骤如下：1. 访问Subrion CMS后台管理界面；2. 利用内容管理或面板设置中的上传功能，上传精心构造的Web-Shell文件；3. 访问该文件路径触发执行，获取交互式Shell；4. 执行枚举脚本（如linpeas.sh）发现可写的计划任务；5. 修改该计划任务脚本，注入反弹Shell代码；6. 等待Cron执行，获取Root权限。投毒风险分析：该POC项目目前主要以Markdown文档形式存在，未包含混淆的二进制文件或复杂的自动化脚本，因此直接的投毒风险较低（评估为10%）。风险点主要集中在文档中可能包含的远程下载链接或第三方Lab链接，防御人员在克隆此类仓库时需警惕 README 中诱导点击的钓鱼链接。如果后续该仓库更新了自动化Exploit脚本，风险评估需重新进行。目前分析，该代码库更多作为渗透测试的参考手册，不具备自动触发恶意负载的特征，符合标准的防御性研究参考资料。代码清晰，未发现恶意混淆或外部异常请求指令，属于低风险范畴。

**项目地址:** [https://github.com/vulnwatchdog_3c52ff47304aaaffd1eb9e4505cf01fe](https://www.google.com/search?q=https://github.com/vulnwatchdog_3c52ff47304aaaffd1eb9e4505cf01fe)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2021-2220](https://nvd.nist.gov/vuln/detail/CVE-2021-2220)
