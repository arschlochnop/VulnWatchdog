## CVE-2021-2220 - Oracle PeopleSoft Enterprise SCM eProcurement 任意文件上传/RCE

**漏洞编号:** CVE-2021-2220

**漏洞类型:** 任意文件上传/RCE

**影响应用:** Oracle PeopleSoft Enterprise SCM eProcurement

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 9.2

**利用条件:** 通常需要访问Manage Requisition Status组件，且目标系统未打补丁

**POC 可用性:** 4/10

**POC 类型:** 仅说明

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

POC有效性分析：根据提供的输入数据，该POC实际上是一篇针对OffSec Lab中‘Exfiltrated’机器的实验指南或Walkthrough文档。它详细说明了利用CVE-2021-2220在Subrion CMS中实现Web-Shell上传，并结合基于Cron的任务进行权限提升的过程。从技术有效性来看，CVE-2021-2220在Oracle PeopleSoft中表现为处理文件上传时的逻辑缺陷，允许攻击者绕过限制上传恶意脚本。此文档提供了利用思路而非直接的自动化脚本，因此其‘代码’层面的有效性较低，但在攻击路径引导上具有高度的参考价值。攻击者首先利用Subrion CMS（或该实验环境中的对应组件）的文件上传漏洞获取初始WebShell，随后利用系统内配置不当的Cron Job执行权限提升。利用步骤：1. 识别目标运行的PeopleSoft或Subrion CMS版本；2. 定位到具有上传功能的组件（如Manage Requisition Status）；3. 构造包含恶意PHP/JSP代码的WebShell文件；4. 绕过前端或后端文件类型检查进行上传；5. 通过URL访问WebShell获取基础权限命令执行；6. 扫描系统Cron任务，查找具有写权限的脚本或定时任务；7. 修改该脚本以执行反弹Shell，等待Cron执行获取Root权限。投毒风险分析：该POC目前呈现为README说明文档和PDF参考链接，并未包含复杂的二进制Payload或经过混淆的自动化脚本，因此直接的投毒风险极低。由于它属于OffSec实验环境的指南，其来源具有较高的可信度，通常用于合法的安全学习。然而，在实际威胁情报监控中，安全研究员应警惕那些声称提供此类CVE‘一键利用工具’的第三方仓库。此类工具常通过混淆后的Python脚本执行外部请求，或在反弹Shell的Payload中植入第二层后门。对于本文档，风险点仅限于引用的外部链接（如Exfiltrated.pdf）是否被篡改。在防御性研究中，应通过静态代码分析检查任何下载的脚本中是否包含未加密的Base64指令、非预期的Socket连接或对敏感系统目录（如/etc/shadow）的越权读取操作。当前POC为纯文本描述，无恶意代码植入迹象。

**项目地址:** [https://portal.offsec.com/machine/exfiltrated-17398/](https://www.google.com/search?q=https://portal.offsec.com/machine/exfiltrated-17398/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2021-2220](https://nvd.nist.gov/vuln/detail/CVE-2021-2220)
