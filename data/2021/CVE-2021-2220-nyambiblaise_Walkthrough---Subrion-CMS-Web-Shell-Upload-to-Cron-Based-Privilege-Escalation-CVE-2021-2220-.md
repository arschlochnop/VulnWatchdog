## CVE-2021-2220 - Subrion CMS 文件上传/RCE/权限提升

**漏洞编号:** CVE-2021-2220

**漏洞类型:** 文件上传/RCE/权限提升

**影响应用:** Subrion CMS

**危害等级:** 高危

**CVSS评分:** 8.8

**影响版本:** Subrion CMS 4.2.1及以下版本

**利用条件:** 需要具备后台登录权限或利用已知的文件上传漏洞，且目标系统配置有基于Cron的任务调度以便提权。

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

POC有效性分析：根据提供的输入数据，该POC关联于OffSec的‘Exfiltrated’实验机器。POC文档描述了一个从Subrion CMS Web-Shell上传到基于Cron的权限提升的完整链路。其有效性建立在两个阶段：首先是Subrion CMS中由于对上传文件后缀名校验不严（或黑名单绕过），攻击者可以上传一个包含恶意PHP代码的.phar或.phtml文件，从而获得Web-Shell。其次，在获得低权限Shell后，通过检查系统中的计划任务（Cron jobs），发现某个可由www-data修改或利用的脚本以root权限运行。虽然提供的文档仅为README描述，但其技术路径清晰，符合Subrion CMS的历史漏洞特征。然而，README本身不包含直接的可执行代码，需要研究者手动根据逻辑复现，因此在自动化利用上效率较低。该POC在防御研究中主要用于理解漏洞利用链（Vulnerability Chain），即如何从应用层漏洞延伸到操作系统层权限获取。利用步骤：1. 登录Subrion CMS后台管理界面。2. 寻找文件管理器或内容编辑功能，尝试上传伪装后的PHP Web-Shell。3. 访问上传的文件路径，确认获得低权限命令执行。4. 扫描系统/etc/crontab或使用pspy工具寻找高权限Cron任务。5. 篡改Cron调用的目标脚本或在其依赖目录下写入恶意脚本。6. 等待Cron执行，获取root权限。投毒风险分析：该POC资源主要来源于知名渗透测试平台OffSec的配套文档。代码透明度极高，README中明确指出了对应的实验环境和攻击目标，不包含任何混淆、加密或非必要的外部远程调用。其分析重点在于教学和实验复现，并非提供一键式利用工具。在防御性研究员评估时，该文档中提到的Exfiltrated.pdf等附件应从官方渠道获取以防被第三方篡改。目前分析来看，此类文档化的POC投毒风险极低，其唯一的风险点在于如果用户从非官方仓库下载所谓的‘辅助脚本’，可能会遇到包裹着恶意后门的伪装代码。在本次分析的范围中，未发现任何恶意网络行为或对本地系统的非预期破坏逻辑。代码逻辑清晰，完全符合合法安全研究的规范。由于其不包含混淆过的二进制文件或经过编码的Python Payload，该项目的投毒风险判定为5%，这5%仅属于常规的供应链安全防范范畴。

**项目地址:** [https://portal.offsec.com/machine/exfiltrated-17398/overview/details](https://portal.offsec.com/machine/exfiltrated-17398/overview/details)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2021-2220](https://nvd.nist.gov/vuln/detail/CVE-2021-2220)
