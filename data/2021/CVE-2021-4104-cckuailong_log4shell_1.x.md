# CVE-2021-4104

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-4104-cckuailong_log4shell_1.x.md](../2021/CVE-2021-4104-cckuailong_log4shell_1.x.md)

# CVE-2021-4104

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-4104-cckuailong_log4shell_1.x.md](../2021/CVE-2021-4104-cckuailong_log4shell_1.x.md)

# CVE-2021-4104

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-4104-cckuailong_log4shell_1.x.md](../2021/CVE-2021-4104-cckuailong_log4shell_1.x.md)

# CVE-2021-4104

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-4104-cckuailong_log4shell_1.x.md](../2021/CVE-2021-4104-cckuailong_log4shell_1.x.md)

# CVE-2021-4104

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-4104-cckuailong_log4shell_1.x.md](../2021/CVE-2021-4104-cckuailong_log4shell_1.x.md)

# CVE-2021-4104

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-4104-cckuailong_log4shell_1.x.md](../2021/CVE-2021-4104-cckuailong_log4shell_1.x.md)

# CVE-2021-4104

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-4104-cckuailong_log4shell_1.x.md](../2021/CVE-2021-4104-cckuailong_log4shell_1.x.md)

# CVE-2021-4104

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-4104-cckuailong_log4shell_1.x.md](../2021/CVE-2021-4104-cckuailong_log4shell_1.x.md)

# CVE-2021-4104

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-4104-cckuailong_log4shell_1.x.md](../2021/CVE-2021-4104-cckuailong_log4shell_1.x.md)

# CVE-2021-4104

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-4104-cckuailong_log4shell_1.x.md](../2021/CVE-2021-4104-cckuailong_log4shell_1.x.md)

# CVE-2021-4104

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-4104-cckuailong_log4shell_1.x.md](../2021/CVE-2021-4104-cckuailong_log4shell_1.x.md)

## CVE-2021-4104 - Apache Log4j 1.2 JMSAppender反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache Log4j 1.2.x

**利用条件:** 1. 目标系统配置了JMS环境。
2. 攻击者可以写入Log4j配置文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-4104 是 Apache Log4j 1.2 中的一个反序列化漏洞。当 Log4j 1.2 配置为使用 JMSAppender 时，攻击者如果能够修改 Log4j 的配置文件 (log4j.properties)，就可以通过指定恶意的 `TopicBindingName` 和 `TopicConnectionFactoryBindingName`，利用 JNDI 注入执行远程代码。该 POC 代码提供了一个可利用的 Web 应用，其中 `log4j.properties` 包含恶意的 JNDI 配置，指向攻击者控制的 LDAP 服务器。当 Log4j 尝试通过 JNDI 获取 Topic 和 ConnectionFactory 时，会从 LDAP 服务器加载恶意的 Java 对象，导致反序列化漏洞，最终执行任意代码。

**有效性：** 提供的 POC 代码有效，但利用条件较为苛刻，需要目标系统已配置 JMSAppender 且攻击者具有 Log4j 配置文件的写入权限。

**投毒风险：**

此仓库主要展示了 CVE-2021-4104 漏洞的利用方式，从代码来看，没有明显的投毒代码。虽然利用成功后可以执行任意代码，但这是漏洞利用本身的结果，而非仓库作者有意植入的恶意代码。

不过，需要注意的是，任何下载和使用的开源代码都存在潜在风险。即使当前代码没有恶意行为，也不能完全排除未来被篡改的可能性。因此，在使用任何第三方代码之前，都应该进行仔细审查和安全评估。

**利用方式：**

1.  **目标系统需要运行 Log4j 1.2，且配置了 JMSAppender。**
2.  **攻击者需要获得目标系统的 Log4j 配置文件（log4j.properties）的写入权限。**
3.  **攻击者修改 `log4j.properties` 文件，设置恶意的 `TopicBindingName` 和 `TopicConnectionFactoryBindingName`，指向攻击者控制的 LDAP 服务器。**
4.  **攻击者在 LDAP 服务器上部署恶意 Java 对象，该对象包含要执行的恶意代码。**
5.  **当应用程序记录日志时，Log4j 会尝试连接 JMS 服务器，并通过 JNDI 从攻击者的 LDAP 服务器加载恶意 Java 对象，从而执行任意代码。**

总的来说，该漏洞利用的有效性依赖于特定的配置和攻击者对配置文件的控制能力。投毒风险较低，但仍建议进行代码审计。

**项目地址:** [cckuailong/log4shell_1.x](https://github.com/cckuailong/log4shell_1.x)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---

## POC #2

**来源**: [CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md](../2021/CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md)

## CVE-2021-4104 - Apache Log4j 1.2 JMSAppender 反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 1.2.x

**利用条件:** 目标系统需使用Log4j 1.2，且配置了JMSAppender，攻击者需要具有修改log4j配置文件的权限，目标需要存在JMS环境

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-4104 存在于 Apache Log4j 1.2 中，当 JMSAppender 被配置使用时，攻击者可以通过修改 Log4j 配置文件，指定恶意的 TopicBindingName 和 TopicConnectionFactoryBindingName，利用 JNDI 注入，触发反序列化漏洞，从而实现远程代码执行。

**有效性分析：**
提供的POC代码看起来有效。包含了一个`Evil.java`，它会在构造函数中执行`calc`命令，模拟RCE。`log4j.properties` 配置文件指定了 JMSAppender，并设置了恶意的 JNDI URL (ldap://127.0.0.1:1389/any)。 结合`pom.xml`声明的`log4j`和`activemq-all`依赖，以及`README.md`中提及的利用条件，可以判断这是一个可行的漏洞利用链。

**投毒风险分析：**
检查POC代码，主要关注`Evil.java`和`log4j.properties`两个文件。`Evil.java` 中的 `Runtime.getRuntime().exec("calc")` 仅仅是一个演示payload，没有发现隐藏的恶意代码。虽然通过修改恶意 JNDI URL 可以指向攻击者控制的LDAP服务器，从而加载恶意的类进行RCE，但这个行为是漏洞利用的固有方式，不是作者植入的后门。代码层面投毒可能性较低，但依然需要人工审核确认。pom.xml中引入了ActiveMQ相关的依赖，如果存在ActiveMQ的历史漏洞，可能会被进一步利用，但这不属于代码投毒范畴。

**利用方式：**
1.  **前提条件:** 目标系统运行 Log4j 1.2，并且配置文件中使用了 `org.apache.log4j.net.JMSAppender`。
2.  **配置文件修改:** 攻击者需要获得修改 `log4j.properties` 文件的权限。
3.  **JNDI 注入:** 在 `log4j.properties` 中，修改 `TopicBindingName` 和 `TopicConnectionFactoryBindingName` 属性，将其指向攻击者控制的 LDAP 或 RMI 服务器。
4.  **恶意服务器:** 攻击者搭建一个恶意的 LDAP 或 RMI 服务器，当目标系统尝试从该服务器获取 JNDI 对象时，服务器返回一个包含恶意代码的 Java 对象。
5.  **反序列化执行:** 目标系统反序列化该 Java 对象，从而执行攻击者预设的恶意代码，实现远程代码执行。 

综上，此POC的有效性较高，但利用条件较为苛刻，需要满足特定的 Log4j 配置和具备修改配置文件的权限。 投毒风险极低。

**项目地址:** [cuijiung/log4j-CVE-2021-4104](https://github.com/cuijiung/log4j-CVE-2021-4104)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---

## POC #3

**来源**: [CVE-2021-4104-open-AIMS_log4j.md](../2021/CVE-2021-4104-open-AIMS_log4j.md)

## CVE-2021-4104-Apache Log4j 1.2 JMSAppender反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache Log4j 1.2.x

**利用条件:** 需要目标系统配置为使用JMSAppender，且攻击者有Log4j配置文件的写入权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-4104是Apache Log4j 1.2中的一个反序列化漏洞。当Log4j 1.2被配置为使用JMSAppender时，攻击者如果具有对Log4j配置文件的写入权限，就可以通过修改配置文件，设置恶意的TopicBindingName和TopicConnectionFactoryBindingName，导致JMSAppender发起JNDI请求。这些JNDI请求可以指向恶意的JNDI服务器，从而导致远程代码执行，类似于CVE-2021-44228。

**有效性：**
从搜索结果和漏洞描述来看，该漏洞是真实存在的，并且已经被广泛讨论和研究。利用代码的有效性依赖于目标环境是否满足利用条件，即使用了JMSAppender并且攻击者可以修改配置文件。

**投毒风险：**
提供的漏洞利用代码仅为Apache License 2.0许可文件，不包含任何可执行的代码或配置文件。因此，从这段代码本身来看，不存在投毒风险。投毒风险应该关注于实际使用的PoC代码的来源，需要分析其行为是否包含恶意操作。

**利用方式：**
1.  **前提条件：** 目标系统使用Log4j 1.2，且配置使用了JMSAppender。
2.  **配置修改：** 攻击者需要获得Log4j配置文件的写入权限，修改`log4j.xml`或`log4j.properties`文件。
3.  **JMSAppender配置：** 在配置文件中，设置`TopicBindingName`和`TopicConnectionFactoryBindingName`指向恶意的JNDI服务器。
4.  **JNDI注入：** 当Log4j尝试通过JMSAppender连接JNDI服务器时，恶意的JNDI服务器返回一个包含恶意代码的序列化对象。
5.  **反序列化执行：** Log4j反序列化该对象，导致恶意代码在目标系统上执行，从而实现远程代码执行。

总而言之，利用的关键在于控制Log4j的配置文件，并诱使其连接到恶意的JNDI服务器。

**项目地址:** [open-AIMS/log4j](https://github.com/open-AIMS/log4j)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---



---

## POC #2

**来源**: [CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md](../2021/CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md)

## CVE-2021-4104 - Apache Log4j 1.2 JMSAppender 反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 1.2.x

**利用条件:** 目标系统需使用Log4j 1.2，且配置了JMSAppender，攻击者需要具有修改log4j配置文件的权限，目标需要存在JMS环境

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-4104 存在于 Apache Log4j 1.2 中，当 JMSAppender 被配置使用时，攻击者可以通过修改 Log4j 配置文件，指定恶意的 TopicBindingName 和 TopicConnectionFactoryBindingName，利用 JNDI 注入，触发反序列化漏洞，从而实现远程代码执行。

**有效性分析：**
提供的POC代码看起来有效。包含了一个`Evil.java`，它会在构造函数中执行`calc`命令，模拟RCE。`log4j.properties` 配置文件指定了 JMSAppender，并设置了恶意的 JNDI URL (ldap://127.0.0.1:1389/any)。 结合`pom.xml`声明的`log4j`和`activemq-all`依赖，以及`README.md`中提及的利用条件，可以判断这是一个可行的漏洞利用链。

**投毒风险分析：**
检查POC代码，主要关注`Evil.java`和`log4j.properties`两个文件。`Evil.java` 中的 `Runtime.getRuntime().exec("calc")` 仅仅是一个演示payload，没有发现隐藏的恶意代码。虽然通过修改恶意 JNDI URL 可以指向攻击者控制的LDAP服务器，从而加载恶意的类进行RCE，但这个行为是漏洞利用的固有方式，不是作者植入的后门。代码层面投毒可能性较低，但依然需要人工审核确认。pom.xml中引入了ActiveMQ相关的依赖，如果存在ActiveMQ的历史漏洞，可能会被进一步利用，但这不属于代码投毒范畴。

**利用方式：**
1.  **前提条件:** 目标系统运行 Log4j 1.2，并且配置文件中使用了 `org.apache.log4j.net.JMSAppender`。
2.  **配置文件修改:** 攻击者需要获得修改 `log4j.properties` 文件的权限。
3.  **JNDI 注入:** 在 `log4j.properties` 中，修改 `TopicBindingName` 和 `TopicConnectionFactoryBindingName` 属性，将其指向攻击者控制的 LDAP 或 RMI 服务器。
4.  **恶意服务器:** 攻击者搭建一个恶意的 LDAP 或 RMI 服务器，当目标系统尝试从该服务器获取 JNDI 对象时，服务器返回一个包含恶意代码的 Java 对象。
5.  **反序列化执行:** 目标系统反序列化该 Java 对象，从而执行攻击者预设的恶意代码，实现远程代码执行。 

综上，此POC的有效性较高，但利用条件较为苛刻，需要满足特定的 Log4j 配置和具备修改配置文件的权限。 投毒风险极低。

**项目地址:** [cuijiung/log4j-CVE-2021-4104](https://github.com/cuijiung/log4j-CVE-2021-4104)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---

## POC #3

**来源**: [CVE-2021-4104-open-AIMS_log4j.md](../2021/CVE-2021-4104-open-AIMS_log4j.md)

## CVE-2021-4104-Apache Log4j 1.2 JMSAppender反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache Log4j 1.2.x

**利用条件:** 需要目标系统配置为使用JMSAppender，且攻击者有Log4j配置文件的写入权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-4104是Apache Log4j 1.2中的一个反序列化漏洞。当Log4j 1.2被配置为使用JMSAppender时，攻击者如果具有对Log4j配置文件的写入权限，就可以通过修改配置文件，设置恶意的TopicBindingName和TopicConnectionFactoryBindingName，导致JMSAppender发起JNDI请求。这些JNDI请求可以指向恶意的JNDI服务器，从而导致远程代码执行，类似于CVE-2021-44228。

**有效性：**
从搜索结果和漏洞描述来看，该漏洞是真实存在的，并且已经被广泛讨论和研究。利用代码的有效性依赖于目标环境是否满足利用条件，即使用了JMSAppender并且攻击者可以修改配置文件。

**投毒风险：**
提供的漏洞利用代码仅为Apache License 2.0许可文件，不包含任何可执行的代码或配置文件。因此，从这段代码本身来看，不存在投毒风险。投毒风险应该关注于实际使用的PoC代码的来源，需要分析其行为是否包含恶意操作。

**利用方式：**
1.  **前提条件：** 目标系统使用Log4j 1.2，且配置使用了JMSAppender。
2.  **配置修改：** 攻击者需要获得Log4j配置文件的写入权限，修改`log4j.xml`或`log4j.properties`文件。
3.  **JMSAppender配置：** 在配置文件中，设置`TopicBindingName`和`TopicConnectionFactoryBindingName`指向恶意的JNDI服务器。
4.  **JNDI注入：** 当Log4j尝试通过JMSAppender连接JNDI服务器时，恶意的JNDI服务器返回一个包含恶意代码的序列化对象。
5.  **反序列化执行：** Log4j反序列化该对象，导致恶意代码在目标系统上执行，从而实现远程代码执行。

总而言之，利用的关键在于控制Log4j的配置文件，并诱使其连接到恶意的JNDI服务器。

**项目地址:** [open-AIMS/log4j](https://github.com/open-AIMS/log4j)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---



---

## POC #2

**来源**: [CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md](../2021/CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md)

## CVE-2021-4104 - Apache Log4j 1.2 JMSAppender 反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 1.2.x

**利用条件:** 目标系统需使用Log4j 1.2，且配置了JMSAppender，攻击者需要具有修改log4j配置文件的权限，目标需要存在JMS环境

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-4104 存在于 Apache Log4j 1.2 中，当 JMSAppender 被配置使用时，攻击者可以通过修改 Log4j 配置文件，指定恶意的 TopicBindingName 和 TopicConnectionFactoryBindingName，利用 JNDI 注入，触发反序列化漏洞，从而实现远程代码执行。

**有效性分析：**
提供的POC代码看起来有效。包含了一个`Evil.java`，它会在构造函数中执行`calc`命令，模拟RCE。`log4j.properties` 配置文件指定了 JMSAppender，并设置了恶意的 JNDI URL (ldap://127.0.0.1:1389/any)。 结合`pom.xml`声明的`log4j`和`activemq-all`依赖，以及`README.md`中提及的利用条件，可以判断这是一个可行的漏洞利用链。

**投毒风险分析：**
检查POC代码，主要关注`Evil.java`和`log4j.properties`两个文件。`Evil.java` 中的 `Runtime.getRuntime().exec("calc")` 仅仅是一个演示payload，没有发现隐藏的恶意代码。虽然通过修改恶意 JNDI URL 可以指向攻击者控制的LDAP服务器，从而加载恶意的类进行RCE，但这个行为是漏洞利用的固有方式，不是作者植入的后门。代码层面投毒可能性较低，但依然需要人工审核确认。pom.xml中引入了ActiveMQ相关的依赖，如果存在ActiveMQ的历史漏洞，可能会被进一步利用，但这不属于代码投毒范畴。

**利用方式：**
1.  **前提条件:** 目标系统运行 Log4j 1.2，并且配置文件中使用了 `org.apache.log4j.net.JMSAppender`。
2.  **配置文件修改:** 攻击者需要获得修改 `log4j.properties` 文件的权限。
3.  **JNDI 注入:** 在 `log4j.properties` 中，修改 `TopicBindingName` 和 `TopicConnectionFactoryBindingName` 属性，将其指向攻击者控制的 LDAP 或 RMI 服务器。
4.  **恶意服务器:** 攻击者搭建一个恶意的 LDAP 或 RMI 服务器，当目标系统尝试从该服务器获取 JNDI 对象时，服务器返回一个包含恶意代码的 Java 对象。
5.  **反序列化执行:** 目标系统反序列化该 Java 对象，从而执行攻击者预设的恶意代码，实现远程代码执行。 

综上，此POC的有效性较高，但利用条件较为苛刻，需要满足特定的 Log4j 配置和具备修改配置文件的权限。 投毒风险极低。

**项目地址:** [cuijiung/log4j-CVE-2021-4104](https://github.com/cuijiung/log4j-CVE-2021-4104)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---

## POC #3

**来源**: [CVE-2021-4104-open-AIMS_log4j.md](../2021/CVE-2021-4104-open-AIMS_log4j.md)

## CVE-2021-4104-Apache Log4j 1.2 JMSAppender反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache Log4j 1.2.x

**利用条件:** 需要目标系统配置为使用JMSAppender，且攻击者有Log4j配置文件的写入权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-4104是Apache Log4j 1.2中的一个反序列化漏洞。当Log4j 1.2被配置为使用JMSAppender时，攻击者如果具有对Log4j配置文件的写入权限，就可以通过修改配置文件，设置恶意的TopicBindingName和TopicConnectionFactoryBindingName，导致JMSAppender发起JNDI请求。这些JNDI请求可以指向恶意的JNDI服务器，从而导致远程代码执行，类似于CVE-2021-44228。

**有效性：**
从搜索结果和漏洞描述来看，该漏洞是真实存在的，并且已经被广泛讨论和研究。利用代码的有效性依赖于目标环境是否满足利用条件，即使用了JMSAppender并且攻击者可以修改配置文件。

**投毒风险：**
提供的漏洞利用代码仅为Apache License 2.0许可文件，不包含任何可执行的代码或配置文件。因此，从这段代码本身来看，不存在投毒风险。投毒风险应该关注于实际使用的PoC代码的来源，需要分析其行为是否包含恶意操作。

**利用方式：**
1.  **前提条件：** 目标系统使用Log4j 1.2，且配置使用了JMSAppender。
2.  **配置修改：** 攻击者需要获得Log4j配置文件的写入权限，修改`log4j.xml`或`log4j.properties`文件。
3.  **JMSAppender配置：** 在配置文件中，设置`TopicBindingName`和`TopicConnectionFactoryBindingName`指向恶意的JNDI服务器。
4.  **JNDI注入：** 当Log4j尝试通过JMSAppender连接JNDI服务器时，恶意的JNDI服务器返回一个包含恶意代码的序列化对象。
5.  **反序列化执行：** Log4j反序列化该对象，导致恶意代码在目标系统上执行，从而实现远程代码执行。

总而言之，利用的关键在于控制Log4j的配置文件，并诱使其连接到恶意的JNDI服务器。

**项目地址:** [open-AIMS/log4j](https://github.com/open-AIMS/log4j)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---



---

## POC #2

**来源**: [CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md](../2021/CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md)

## CVE-2021-4104 - Apache Log4j 1.2 JMSAppender 反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 1.2.x

**利用条件:** 目标系统需使用Log4j 1.2，且配置了JMSAppender，攻击者需要具有修改log4j配置文件的权限，目标需要存在JMS环境

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-4104 存在于 Apache Log4j 1.2 中，当 JMSAppender 被配置使用时，攻击者可以通过修改 Log4j 配置文件，指定恶意的 TopicBindingName 和 TopicConnectionFactoryBindingName，利用 JNDI 注入，触发反序列化漏洞，从而实现远程代码执行。

**有效性分析：**
提供的POC代码看起来有效。包含了一个`Evil.java`，它会在构造函数中执行`calc`命令，模拟RCE。`log4j.properties` 配置文件指定了 JMSAppender，并设置了恶意的 JNDI URL (ldap://127.0.0.1:1389/any)。 结合`pom.xml`声明的`log4j`和`activemq-all`依赖，以及`README.md`中提及的利用条件，可以判断这是一个可行的漏洞利用链。

**投毒风险分析：**
检查POC代码，主要关注`Evil.java`和`log4j.properties`两个文件。`Evil.java` 中的 `Runtime.getRuntime().exec("calc")` 仅仅是一个演示payload，没有发现隐藏的恶意代码。虽然通过修改恶意 JNDI URL 可以指向攻击者控制的LDAP服务器，从而加载恶意的类进行RCE，但这个行为是漏洞利用的固有方式，不是作者植入的后门。代码层面投毒可能性较低，但依然需要人工审核确认。pom.xml中引入了ActiveMQ相关的依赖，如果存在ActiveMQ的历史漏洞，可能会被进一步利用，但这不属于代码投毒范畴。

**利用方式：**
1.  **前提条件:** 目标系统运行 Log4j 1.2，并且配置文件中使用了 `org.apache.log4j.net.JMSAppender`。
2.  **配置文件修改:** 攻击者需要获得修改 `log4j.properties` 文件的权限。
3.  **JNDI 注入:** 在 `log4j.properties` 中，修改 `TopicBindingName` 和 `TopicConnectionFactoryBindingName` 属性，将其指向攻击者控制的 LDAP 或 RMI 服务器。
4.  **恶意服务器:** 攻击者搭建一个恶意的 LDAP 或 RMI 服务器，当目标系统尝试从该服务器获取 JNDI 对象时，服务器返回一个包含恶意代码的 Java 对象。
5.  **反序列化执行:** 目标系统反序列化该 Java 对象，从而执行攻击者预设的恶意代码，实现远程代码执行。 

综上，此POC的有效性较高，但利用条件较为苛刻，需要满足特定的 Log4j 配置和具备修改配置文件的权限。 投毒风险极低。

**项目地址:** [cuijiung/log4j-CVE-2021-4104](https://github.com/cuijiung/log4j-CVE-2021-4104)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---

## POC #3

**来源**: [CVE-2021-4104-open-AIMS_log4j.md](../2021/CVE-2021-4104-open-AIMS_log4j.md)

## CVE-2021-4104-Apache Log4j 1.2 JMSAppender反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache Log4j 1.2.x

**利用条件:** 需要目标系统配置为使用JMSAppender，且攻击者有Log4j配置文件的写入权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-4104是Apache Log4j 1.2中的一个反序列化漏洞。当Log4j 1.2被配置为使用JMSAppender时，攻击者如果具有对Log4j配置文件的写入权限，就可以通过修改配置文件，设置恶意的TopicBindingName和TopicConnectionFactoryBindingName，导致JMSAppender发起JNDI请求。这些JNDI请求可以指向恶意的JNDI服务器，从而导致远程代码执行，类似于CVE-2021-44228。

**有效性：**
从搜索结果和漏洞描述来看，该漏洞是真实存在的，并且已经被广泛讨论和研究。利用代码的有效性依赖于目标环境是否满足利用条件，即使用了JMSAppender并且攻击者可以修改配置文件。

**投毒风险：**
提供的漏洞利用代码仅为Apache License 2.0许可文件，不包含任何可执行的代码或配置文件。因此，从这段代码本身来看，不存在投毒风险。投毒风险应该关注于实际使用的PoC代码的来源，需要分析其行为是否包含恶意操作。

**利用方式：**
1.  **前提条件：** 目标系统使用Log4j 1.2，且配置使用了JMSAppender。
2.  **配置修改：** 攻击者需要获得Log4j配置文件的写入权限，修改`log4j.xml`或`log4j.properties`文件。
3.  **JMSAppender配置：** 在配置文件中，设置`TopicBindingName`和`TopicConnectionFactoryBindingName`指向恶意的JNDI服务器。
4.  **JNDI注入：** 当Log4j尝试通过JMSAppender连接JNDI服务器时，恶意的JNDI服务器返回一个包含恶意代码的序列化对象。
5.  **反序列化执行：** Log4j反序列化该对象，导致恶意代码在目标系统上执行，从而实现远程代码执行。

总而言之，利用的关键在于控制Log4j的配置文件，并诱使其连接到恶意的JNDI服务器。

**项目地址:** [open-AIMS/log4j](https://github.com/open-AIMS/log4j)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---



---

## POC #2

**来源**: [CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md](../2021/CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md)

## CVE-2021-4104 - Apache Log4j 1.2 JMSAppender 反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 1.2.x

**利用条件:** 目标系统需使用Log4j 1.2，且配置了JMSAppender，攻击者需要具有修改log4j配置文件的权限，目标需要存在JMS环境

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-4104 存在于 Apache Log4j 1.2 中，当 JMSAppender 被配置使用时，攻击者可以通过修改 Log4j 配置文件，指定恶意的 TopicBindingName 和 TopicConnectionFactoryBindingName，利用 JNDI 注入，触发反序列化漏洞，从而实现远程代码执行。

**有效性分析：**
提供的POC代码看起来有效。包含了一个`Evil.java`，它会在构造函数中执行`calc`命令，模拟RCE。`log4j.properties` 配置文件指定了 JMSAppender，并设置了恶意的 JNDI URL (ldap://127.0.0.1:1389/any)。 结合`pom.xml`声明的`log4j`和`activemq-all`依赖，以及`README.md`中提及的利用条件，可以判断这是一个可行的漏洞利用链。

**投毒风险分析：**
检查POC代码，主要关注`Evil.java`和`log4j.properties`两个文件。`Evil.java` 中的 `Runtime.getRuntime().exec("calc")` 仅仅是一个演示payload，没有发现隐藏的恶意代码。虽然通过修改恶意 JNDI URL 可以指向攻击者控制的LDAP服务器，从而加载恶意的类进行RCE，但这个行为是漏洞利用的固有方式，不是作者植入的后门。代码层面投毒可能性较低，但依然需要人工审核确认。pom.xml中引入了ActiveMQ相关的依赖，如果存在ActiveMQ的历史漏洞，可能会被进一步利用，但这不属于代码投毒范畴。

**利用方式：**
1.  **前提条件:** 目标系统运行 Log4j 1.2，并且配置文件中使用了 `org.apache.log4j.net.JMSAppender`。
2.  **配置文件修改:** 攻击者需要获得修改 `log4j.properties` 文件的权限。
3.  **JNDI 注入:** 在 `log4j.properties` 中，修改 `TopicBindingName` 和 `TopicConnectionFactoryBindingName` 属性，将其指向攻击者控制的 LDAP 或 RMI 服务器。
4.  **恶意服务器:** 攻击者搭建一个恶意的 LDAP 或 RMI 服务器，当目标系统尝试从该服务器获取 JNDI 对象时，服务器返回一个包含恶意代码的 Java 对象。
5.  **反序列化执行:** 目标系统反序列化该 Java 对象，从而执行攻击者预设的恶意代码，实现远程代码执行。 

综上，此POC的有效性较高，但利用条件较为苛刻，需要满足特定的 Log4j 配置和具备修改配置文件的权限。 投毒风险极低。

**项目地址:** [cuijiung/log4j-CVE-2021-4104](https://github.com/cuijiung/log4j-CVE-2021-4104)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---

## POC #3

**来源**: [CVE-2021-4104-open-AIMS_log4j.md](../2021/CVE-2021-4104-open-AIMS_log4j.md)

## CVE-2021-4104-Apache Log4j 1.2 JMSAppender反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache Log4j 1.2.x

**利用条件:** 需要目标系统配置为使用JMSAppender，且攻击者有Log4j配置文件的写入权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-4104是Apache Log4j 1.2中的一个反序列化漏洞。当Log4j 1.2被配置为使用JMSAppender时，攻击者如果具有对Log4j配置文件的写入权限，就可以通过修改配置文件，设置恶意的TopicBindingName和TopicConnectionFactoryBindingName，导致JMSAppender发起JNDI请求。这些JNDI请求可以指向恶意的JNDI服务器，从而导致远程代码执行，类似于CVE-2021-44228。

**有效性：**
从搜索结果和漏洞描述来看，该漏洞是真实存在的，并且已经被广泛讨论和研究。利用代码的有效性依赖于目标环境是否满足利用条件，即使用了JMSAppender并且攻击者可以修改配置文件。

**投毒风险：**
提供的漏洞利用代码仅为Apache License 2.0许可文件，不包含任何可执行的代码或配置文件。因此，从这段代码本身来看，不存在投毒风险。投毒风险应该关注于实际使用的PoC代码的来源，需要分析其行为是否包含恶意操作。

**利用方式：**
1.  **前提条件：** 目标系统使用Log4j 1.2，且配置使用了JMSAppender。
2.  **配置修改：** 攻击者需要获得Log4j配置文件的写入权限，修改`log4j.xml`或`log4j.properties`文件。
3.  **JMSAppender配置：** 在配置文件中，设置`TopicBindingName`和`TopicConnectionFactoryBindingName`指向恶意的JNDI服务器。
4.  **JNDI注入：** 当Log4j尝试通过JMSAppender连接JNDI服务器时，恶意的JNDI服务器返回一个包含恶意代码的序列化对象。
5.  **反序列化执行：** Log4j反序列化该对象，导致恶意代码在目标系统上执行，从而实现远程代码执行。

总而言之，利用的关键在于控制Log4j的配置文件，并诱使其连接到恶意的JNDI服务器。

**项目地址:** [open-AIMS/log4j](https://github.com/open-AIMS/log4j)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---



---

## POC #2

**来源**: [CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md](../2021/CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md)

## CVE-2021-4104 - Apache Log4j 1.2 JMSAppender 反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 1.2.x

**利用条件:** 目标系统需使用Log4j 1.2，且配置了JMSAppender，攻击者需要具有修改log4j配置文件的权限，目标需要存在JMS环境

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-4104 存在于 Apache Log4j 1.2 中，当 JMSAppender 被配置使用时，攻击者可以通过修改 Log4j 配置文件，指定恶意的 TopicBindingName 和 TopicConnectionFactoryBindingName，利用 JNDI 注入，触发反序列化漏洞，从而实现远程代码执行。

**有效性分析：**
提供的POC代码看起来有效。包含了一个`Evil.java`，它会在构造函数中执行`calc`命令，模拟RCE。`log4j.properties` 配置文件指定了 JMSAppender，并设置了恶意的 JNDI URL (ldap://127.0.0.1:1389/any)。 结合`pom.xml`声明的`log4j`和`activemq-all`依赖，以及`README.md`中提及的利用条件，可以判断这是一个可行的漏洞利用链。

**投毒风险分析：**
检查POC代码，主要关注`Evil.java`和`log4j.properties`两个文件。`Evil.java` 中的 `Runtime.getRuntime().exec("calc")` 仅仅是一个演示payload，没有发现隐藏的恶意代码。虽然通过修改恶意 JNDI URL 可以指向攻击者控制的LDAP服务器，从而加载恶意的类进行RCE，但这个行为是漏洞利用的固有方式，不是作者植入的后门。代码层面投毒可能性较低，但依然需要人工审核确认。pom.xml中引入了ActiveMQ相关的依赖，如果存在ActiveMQ的历史漏洞，可能会被进一步利用，但这不属于代码投毒范畴。

**利用方式：**
1.  **前提条件:** 目标系统运行 Log4j 1.2，并且配置文件中使用了 `org.apache.log4j.net.JMSAppender`。
2.  **配置文件修改:** 攻击者需要获得修改 `log4j.properties` 文件的权限。
3.  **JNDI 注入:** 在 `log4j.properties` 中，修改 `TopicBindingName` 和 `TopicConnectionFactoryBindingName` 属性，将其指向攻击者控制的 LDAP 或 RMI 服务器。
4.  **恶意服务器:** 攻击者搭建一个恶意的 LDAP 或 RMI 服务器，当目标系统尝试从该服务器获取 JNDI 对象时，服务器返回一个包含恶意代码的 Java 对象。
5.  **反序列化执行:** 目标系统反序列化该 Java 对象，从而执行攻击者预设的恶意代码，实现远程代码执行。 

综上，此POC的有效性较高，但利用条件较为苛刻，需要满足特定的 Log4j 配置和具备修改配置文件的权限。 投毒风险极低。

**项目地址:** [cuijiung/log4j-CVE-2021-4104](https://github.com/cuijiung/log4j-CVE-2021-4104)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---

## POC #3

**来源**: [CVE-2021-4104-open-AIMS_log4j.md](../2021/CVE-2021-4104-open-AIMS_log4j.md)

## CVE-2021-4104-Apache Log4j 1.2 JMSAppender反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache Log4j 1.2.x

**利用条件:** 需要目标系统配置为使用JMSAppender，且攻击者有Log4j配置文件的写入权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-4104是Apache Log4j 1.2中的一个反序列化漏洞。当Log4j 1.2被配置为使用JMSAppender时，攻击者如果具有对Log4j配置文件的写入权限，就可以通过修改配置文件，设置恶意的TopicBindingName和TopicConnectionFactoryBindingName，导致JMSAppender发起JNDI请求。这些JNDI请求可以指向恶意的JNDI服务器，从而导致远程代码执行，类似于CVE-2021-44228。

**有效性：**
从搜索结果和漏洞描述来看，该漏洞是真实存在的，并且已经被广泛讨论和研究。利用代码的有效性依赖于目标环境是否满足利用条件，即使用了JMSAppender并且攻击者可以修改配置文件。

**投毒风险：**
提供的漏洞利用代码仅为Apache License 2.0许可文件，不包含任何可执行的代码或配置文件。因此，从这段代码本身来看，不存在投毒风险。投毒风险应该关注于实际使用的PoC代码的来源，需要分析其行为是否包含恶意操作。

**利用方式：**
1.  **前提条件：** 目标系统使用Log4j 1.2，且配置使用了JMSAppender。
2.  **配置修改：** 攻击者需要获得Log4j配置文件的写入权限，修改`log4j.xml`或`log4j.properties`文件。
3.  **JMSAppender配置：** 在配置文件中，设置`TopicBindingName`和`TopicConnectionFactoryBindingName`指向恶意的JNDI服务器。
4.  **JNDI注入：** 当Log4j尝试通过JMSAppender连接JNDI服务器时，恶意的JNDI服务器返回一个包含恶意代码的序列化对象。
5.  **反序列化执行：** Log4j反序列化该对象，导致恶意代码在目标系统上执行，从而实现远程代码执行。

总而言之，利用的关键在于控制Log4j的配置文件，并诱使其连接到恶意的JNDI服务器。

**项目地址:** [open-AIMS/log4j](https://github.com/open-AIMS/log4j)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---



---

## POC #2

**来源**: [CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md](../2021/CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md)

## CVE-2021-4104 - Apache Log4j 1.2 JMSAppender 反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 1.2.x

**利用条件:** 目标系统需使用Log4j 1.2，且配置了JMSAppender，攻击者需要具有修改log4j配置文件的权限，目标需要存在JMS环境

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-4104 存在于 Apache Log4j 1.2 中，当 JMSAppender 被配置使用时，攻击者可以通过修改 Log4j 配置文件，指定恶意的 TopicBindingName 和 TopicConnectionFactoryBindingName，利用 JNDI 注入，触发反序列化漏洞，从而实现远程代码执行。

**有效性分析：**
提供的POC代码看起来有效。包含了一个`Evil.java`，它会在构造函数中执行`calc`命令，模拟RCE。`log4j.properties` 配置文件指定了 JMSAppender，并设置了恶意的 JNDI URL (ldap://127.0.0.1:1389/any)。 结合`pom.xml`声明的`log4j`和`activemq-all`依赖，以及`README.md`中提及的利用条件，可以判断这是一个可行的漏洞利用链。

**投毒风险分析：**
检查POC代码，主要关注`Evil.java`和`log4j.properties`两个文件。`Evil.java` 中的 `Runtime.getRuntime().exec("calc")` 仅仅是一个演示payload，没有发现隐藏的恶意代码。虽然通过修改恶意 JNDI URL 可以指向攻击者控制的LDAP服务器，从而加载恶意的类进行RCE，但这个行为是漏洞利用的固有方式，不是作者植入的后门。代码层面投毒可能性较低，但依然需要人工审核确认。pom.xml中引入了ActiveMQ相关的依赖，如果存在ActiveMQ的历史漏洞，可能会被进一步利用，但这不属于代码投毒范畴。

**利用方式：**
1.  **前提条件:** 目标系统运行 Log4j 1.2，并且配置文件中使用了 `org.apache.log4j.net.JMSAppender`。
2.  **配置文件修改:** 攻击者需要获得修改 `log4j.properties` 文件的权限。
3.  **JNDI 注入:** 在 `log4j.properties` 中，修改 `TopicBindingName` 和 `TopicConnectionFactoryBindingName` 属性，将其指向攻击者控制的 LDAP 或 RMI 服务器。
4.  **恶意服务器:** 攻击者搭建一个恶意的 LDAP 或 RMI 服务器，当目标系统尝试从该服务器获取 JNDI 对象时，服务器返回一个包含恶意代码的 Java 对象。
5.  **反序列化执行:** 目标系统反序列化该 Java 对象，从而执行攻击者预设的恶意代码，实现远程代码执行。 

综上，此POC的有效性较高，但利用条件较为苛刻，需要满足特定的 Log4j 配置和具备修改配置文件的权限。 投毒风险极低。

**项目地址:** [cuijiung/log4j-CVE-2021-4104](https://github.com/cuijiung/log4j-CVE-2021-4104)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---

## POC #3

**来源**: [CVE-2021-4104-open-AIMS_log4j.md](../2021/CVE-2021-4104-open-AIMS_log4j.md)

## CVE-2021-4104-Apache Log4j 1.2 JMSAppender反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache Log4j 1.2.x

**利用条件:** 需要目标系统配置为使用JMSAppender，且攻击者有Log4j配置文件的写入权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-4104是Apache Log4j 1.2中的一个反序列化漏洞。当Log4j 1.2被配置为使用JMSAppender时，攻击者如果具有对Log4j配置文件的写入权限，就可以通过修改配置文件，设置恶意的TopicBindingName和TopicConnectionFactoryBindingName，导致JMSAppender发起JNDI请求。这些JNDI请求可以指向恶意的JNDI服务器，从而导致远程代码执行，类似于CVE-2021-44228。

**有效性：**
从搜索结果和漏洞描述来看，该漏洞是真实存在的，并且已经被广泛讨论和研究。利用代码的有效性依赖于目标环境是否满足利用条件，即使用了JMSAppender并且攻击者可以修改配置文件。

**投毒风险：**
提供的漏洞利用代码仅为Apache License 2.0许可文件，不包含任何可执行的代码或配置文件。因此，从这段代码本身来看，不存在投毒风险。投毒风险应该关注于实际使用的PoC代码的来源，需要分析其行为是否包含恶意操作。

**利用方式：**
1.  **前提条件：** 目标系统使用Log4j 1.2，且配置使用了JMSAppender。
2.  **配置修改：** 攻击者需要获得Log4j配置文件的写入权限，修改`log4j.xml`或`log4j.properties`文件。
3.  **JMSAppender配置：** 在配置文件中，设置`TopicBindingName`和`TopicConnectionFactoryBindingName`指向恶意的JNDI服务器。
4.  **JNDI注入：** 当Log4j尝试通过JMSAppender连接JNDI服务器时，恶意的JNDI服务器返回一个包含恶意代码的序列化对象。
5.  **反序列化执行：** Log4j反序列化该对象，导致恶意代码在目标系统上执行，从而实现远程代码执行。

总而言之，利用的关键在于控制Log4j的配置文件，并诱使其连接到恶意的JNDI服务器。

**项目地址:** [open-AIMS/log4j](https://github.com/open-AIMS/log4j)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---



---

## POC #2

**来源**: [CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md](../2021/CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md)

## CVE-2021-4104 - Apache Log4j 1.2 JMSAppender 反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 1.2.x

**利用条件:** 目标系统需使用Log4j 1.2，且配置了JMSAppender，攻击者需要具有修改log4j配置文件的权限，目标需要存在JMS环境

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-4104 存在于 Apache Log4j 1.2 中，当 JMSAppender 被配置使用时，攻击者可以通过修改 Log4j 配置文件，指定恶意的 TopicBindingName 和 TopicConnectionFactoryBindingName，利用 JNDI 注入，触发反序列化漏洞，从而实现远程代码执行。

**有效性分析：**
提供的POC代码看起来有效。包含了一个`Evil.java`，它会在构造函数中执行`calc`命令，模拟RCE。`log4j.properties` 配置文件指定了 JMSAppender，并设置了恶意的 JNDI URL (ldap://127.0.0.1:1389/any)。 结合`pom.xml`声明的`log4j`和`activemq-all`依赖，以及`README.md`中提及的利用条件，可以判断这是一个可行的漏洞利用链。

**投毒风险分析：**
检查POC代码，主要关注`Evil.java`和`log4j.properties`两个文件。`Evil.java` 中的 `Runtime.getRuntime().exec("calc")` 仅仅是一个演示payload，没有发现隐藏的恶意代码。虽然通过修改恶意 JNDI URL 可以指向攻击者控制的LDAP服务器，从而加载恶意的类进行RCE，但这个行为是漏洞利用的固有方式，不是作者植入的后门。代码层面投毒可能性较低，但依然需要人工审核确认。pom.xml中引入了ActiveMQ相关的依赖，如果存在ActiveMQ的历史漏洞，可能会被进一步利用，但这不属于代码投毒范畴。

**利用方式：**
1.  **前提条件:** 目标系统运行 Log4j 1.2，并且配置文件中使用了 `org.apache.log4j.net.JMSAppender`。
2.  **配置文件修改:** 攻击者需要获得修改 `log4j.properties` 文件的权限。
3.  **JNDI 注入:** 在 `log4j.properties` 中，修改 `TopicBindingName` 和 `TopicConnectionFactoryBindingName` 属性，将其指向攻击者控制的 LDAP 或 RMI 服务器。
4.  **恶意服务器:** 攻击者搭建一个恶意的 LDAP 或 RMI 服务器，当目标系统尝试从该服务器获取 JNDI 对象时，服务器返回一个包含恶意代码的 Java 对象。
5.  **反序列化执行:** 目标系统反序列化该 Java 对象，从而执行攻击者预设的恶意代码，实现远程代码执行。 

综上，此POC的有效性较高，但利用条件较为苛刻，需要满足特定的 Log4j 配置和具备修改配置文件的权限。 投毒风险极低。

**项目地址:** [cuijiung/log4j-CVE-2021-4104](https://github.com/cuijiung/log4j-CVE-2021-4104)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---

## POC #3

**来源**: [CVE-2021-4104-open-AIMS_log4j.md](../2021/CVE-2021-4104-open-AIMS_log4j.md)

## CVE-2021-4104-Apache Log4j 1.2 JMSAppender反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache Log4j 1.2.x

**利用条件:** 需要目标系统配置为使用JMSAppender，且攻击者有Log4j配置文件的写入权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-4104是Apache Log4j 1.2中的一个反序列化漏洞。当Log4j 1.2被配置为使用JMSAppender时，攻击者如果具有对Log4j配置文件的写入权限，就可以通过修改配置文件，设置恶意的TopicBindingName和TopicConnectionFactoryBindingName，导致JMSAppender发起JNDI请求。这些JNDI请求可以指向恶意的JNDI服务器，从而导致远程代码执行，类似于CVE-2021-44228。

**有效性：**
从搜索结果和漏洞描述来看，该漏洞是真实存在的，并且已经被广泛讨论和研究。利用代码的有效性依赖于目标环境是否满足利用条件，即使用了JMSAppender并且攻击者可以修改配置文件。

**投毒风险：**
提供的漏洞利用代码仅为Apache License 2.0许可文件，不包含任何可执行的代码或配置文件。因此，从这段代码本身来看，不存在投毒风险。投毒风险应该关注于实际使用的PoC代码的来源，需要分析其行为是否包含恶意操作。

**利用方式：**
1.  **前提条件：** 目标系统使用Log4j 1.2，且配置使用了JMSAppender。
2.  **配置修改：** 攻击者需要获得Log4j配置文件的写入权限，修改`log4j.xml`或`log4j.properties`文件。
3.  **JMSAppender配置：** 在配置文件中，设置`TopicBindingName`和`TopicConnectionFactoryBindingName`指向恶意的JNDI服务器。
4.  **JNDI注入：** 当Log4j尝试通过JMSAppender连接JNDI服务器时，恶意的JNDI服务器返回一个包含恶意代码的序列化对象。
5.  **反序列化执行：** Log4j反序列化该对象，导致恶意代码在目标系统上执行，从而实现远程代码执行。

总而言之，利用的关键在于控制Log4j的配置文件，并诱使其连接到恶意的JNDI服务器。

**项目地址:** [open-AIMS/log4j](https://github.com/open-AIMS/log4j)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---



---

## POC #2

**来源**: [CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md](../2021/CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md)

## CVE-2021-4104 - Apache Log4j 1.2 JMSAppender 反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 1.2.x

**利用条件:** 目标系统需使用Log4j 1.2，且配置了JMSAppender，攻击者需要具有修改log4j配置文件的权限，目标需要存在JMS环境

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-4104 存在于 Apache Log4j 1.2 中，当 JMSAppender 被配置使用时，攻击者可以通过修改 Log4j 配置文件，指定恶意的 TopicBindingName 和 TopicConnectionFactoryBindingName，利用 JNDI 注入，触发反序列化漏洞，从而实现远程代码执行。

**有效性分析：**
提供的POC代码看起来有效。包含了一个`Evil.java`，它会在构造函数中执行`calc`命令，模拟RCE。`log4j.properties` 配置文件指定了 JMSAppender，并设置了恶意的 JNDI URL (ldap://127.0.0.1:1389/any)。 结合`pom.xml`声明的`log4j`和`activemq-all`依赖，以及`README.md`中提及的利用条件，可以判断这是一个可行的漏洞利用链。

**投毒风险分析：**
检查POC代码，主要关注`Evil.java`和`log4j.properties`两个文件。`Evil.java` 中的 `Runtime.getRuntime().exec("calc")` 仅仅是一个演示payload，没有发现隐藏的恶意代码。虽然通过修改恶意 JNDI URL 可以指向攻击者控制的LDAP服务器，从而加载恶意的类进行RCE，但这个行为是漏洞利用的固有方式，不是作者植入的后门。代码层面投毒可能性较低，但依然需要人工审核确认。pom.xml中引入了ActiveMQ相关的依赖，如果存在ActiveMQ的历史漏洞，可能会被进一步利用，但这不属于代码投毒范畴。

**利用方式：**
1.  **前提条件:** 目标系统运行 Log4j 1.2，并且配置文件中使用了 `org.apache.log4j.net.JMSAppender`。
2.  **配置文件修改:** 攻击者需要获得修改 `log4j.properties` 文件的权限。
3.  **JNDI 注入:** 在 `log4j.properties` 中，修改 `TopicBindingName` 和 `TopicConnectionFactoryBindingName` 属性，将其指向攻击者控制的 LDAP 或 RMI 服务器。
4.  **恶意服务器:** 攻击者搭建一个恶意的 LDAP 或 RMI 服务器，当目标系统尝试从该服务器获取 JNDI 对象时，服务器返回一个包含恶意代码的 Java 对象。
5.  **反序列化执行:** 目标系统反序列化该 Java 对象，从而执行攻击者预设的恶意代码，实现远程代码执行。 

综上，此POC的有效性较高，但利用条件较为苛刻，需要满足特定的 Log4j 配置和具备修改配置文件的权限。 投毒风险极低。

**项目地址:** [cuijiung/log4j-CVE-2021-4104](https://github.com/cuijiung/log4j-CVE-2021-4104)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---

## POC #3

**来源**: [CVE-2021-4104-open-AIMS_log4j.md](../2021/CVE-2021-4104-open-AIMS_log4j.md)

## CVE-2021-4104-Apache Log4j 1.2 JMSAppender反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache Log4j 1.2.x

**利用条件:** 需要目标系统配置为使用JMSAppender，且攻击者有Log4j配置文件的写入权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-4104是Apache Log4j 1.2中的一个反序列化漏洞。当Log4j 1.2被配置为使用JMSAppender时，攻击者如果具有对Log4j配置文件的写入权限，就可以通过修改配置文件，设置恶意的TopicBindingName和TopicConnectionFactoryBindingName，导致JMSAppender发起JNDI请求。这些JNDI请求可以指向恶意的JNDI服务器，从而导致远程代码执行，类似于CVE-2021-44228。

**有效性：**
从搜索结果和漏洞描述来看，该漏洞是真实存在的，并且已经被广泛讨论和研究。利用代码的有效性依赖于目标环境是否满足利用条件，即使用了JMSAppender并且攻击者可以修改配置文件。

**投毒风险：**
提供的漏洞利用代码仅为Apache License 2.0许可文件，不包含任何可执行的代码或配置文件。因此，从这段代码本身来看，不存在投毒风险。投毒风险应该关注于实际使用的PoC代码的来源，需要分析其行为是否包含恶意操作。

**利用方式：**
1.  **前提条件：** 目标系统使用Log4j 1.2，且配置使用了JMSAppender。
2.  **配置修改：** 攻击者需要获得Log4j配置文件的写入权限，修改`log4j.xml`或`log4j.properties`文件。
3.  **JMSAppender配置：** 在配置文件中，设置`TopicBindingName`和`TopicConnectionFactoryBindingName`指向恶意的JNDI服务器。
4.  **JNDI注入：** 当Log4j尝试通过JMSAppender连接JNDI服务器时，恶意的JNDI服务器返回一个包含恶意代码的序列化对象。
5.  **反序列化执行：** Log4j反序列化该对象，导致恶意代码在目标系统上执行，从而实现远程代码执行。

总而言之，利用的关键在于控制Log4j的配置文件，并诱使其连接到恶意的JNDI服务器。

**项目地址:** [open-AIMS/log4j](https://github.com/open-AIMS/log4j)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---



---

## POC #2

**来源**: [CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md](../2021/CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md)

## CVE-2021-4104 - Apache Log4j 1.2 JMSAppender 反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 1.2.x

**利用条件:** 目标系统需使用Log4j 1.2，且配置了JMSAppender，攻击者需要具有修改log4j配置文件的权限，目标需要存在JMS环境

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-4104 存在于 Apache Log4j 1.2 中，当 JMSAppender 被配置使用时，攻击者可以通过修改 Log4j 配置文件，指定恶意的 TopicBindingName 和 TopicConnectionFactoryBindingName，利用 JNDI 注入，触发反序列化漏洞，从而实现远程代码执行。

**有效性分析：**
提供的POC代码看起来有效。包含了一个`Evil.java`，它会在构造函数中执行`calc`命令，模拟RCE。`log4j.properties` 配置文件指定了 JMSAppender，并设置了恶意的 JNDI URL (ldap://127.0.0.1:1389/any)。 结合`pom.xml`声明的`log4j`和`activemq-all`依赖，以及`README.md`中提及的利用条件，可以判断这是一个可行的漏洞利用链。

**投毒风险分析：**
检查POC代码，主要关注`Evil.java`和`log4j.properties`两个文件。`Evil.java` 中的 `Runtime.getRuntime().exec("calc")` 仅仅是一个演示payload，没有发现隐藏的恶意代码。虽然通过修改恶意 JNDI URL 可以指向攻击者控制的LDAP服务器，从而加载恶意的类进行RCE，但这个行为是漏洞利用的固有方式，不是作者植入的后门。代码层面投毒可能性较低，但依然需要人工审核确认。pom.xml中引入了ActiveMQ相关的依赖，如果存在ActiveMQ的历史漏洞，可能会被进一步利用，但这不属于代码投毒范畴。

**利用方式：**
1.  **前提条件:** 目标系统运行 Log4j 1.2，并且配置文件中使用了 `org.apache.log4j.net.JMSAppender`。
2.  **配置文件修改:** 攻击者需要获得修改 `log4j.properties` 文件的权限。
3.  **JNDI 注入:** 在 `log4j.properties` 中，修改 `TopicBindingName` 和 `TopicConnectionFactoryBindingName` 属性，将其指向攻击者控制的 LDAP 或 RMI 服务器。
4.  **恶意服务器:** 攻击者搭建一个恶意的 LDAP 或 RMI 服务器，当目标系统尝试从该服务器获取 JNDI 对象时，服务器返回一个包含恶意代码的 Java 对象。
5.  **反序列化执行:** 目标系统反序列化该 Java 对象，从而执行攻击者预设的恶意代码，实现远程代码执行。 

综上，此POC的有效性较高，但利用条件较为苛刻，需要满足特定的 Log4j 配置和具备修改配置文件的权限。 投毒风险极低。

**项目地址:** [cuijiung/log4j-CVE-2021-4104](https://github.com/cuijiung/log4j-CVE-2021-4104)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---

## POC #3

**来源**: [CVE-2021-4104-open-AIMS_log4j.md](../2021/CVE-2021-4104-open-AIMS_log4j.md)

## CVE-2021-4104-Apache Log4j 1.2 JMSAppender反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache Log4j 1.2.x

**利用条件:** 需要目标系统配置为使用JMSAppender，且攻击者有Log4j配置文件的写入权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-4104是Apache Log4j 1.2中的一个反序列化漏洞。当Log4j 1.2被配置为使用JMSAppender时，攻击者如果具有对Log4j配置文件的写入权限，就可以通过修改配置文件，设置恶意的TopicBindingName和TopicConnectionFactoryBindingName，导致JMSAppender发起JNDI请求。这些JNDI请求可以指向恶意的JNDI服务器，从而导致远程代码执行，类似于CVE-2021-44228。

**有效性：**
从搜索结果和漏洞描述来看，该漏洞是真实存在的，并且已经被广泛讨论和研究。利用代码的有效性依赖于目标环境是否满足利用条件，即使用了JMSAppender并且攻击者可以修改配置文件。

**投毒风险：**
提供的漏洞利用代码仅为Apache License 2.0许可文件，不包含任何可执行的代码或配置文件。因此，从这段代码本身来看，不存在投毒风险。投毒风险应该关注于实际使用的PoC代码的来源，需要分析其行为是否包含恶意操作。

**利用方式：**
1.  **前提条件：** 目标系统使用Log4j 1.2，且配置使用了JMSAppender。
2.  **配置修改：** 攻击者需要获得Log4j配置文件的写入权限，修改`log4j.xml`或`log4j.properties`文件。
3.  **JMSAppender配置：** 在配置文件中，设置`TopicBindingName`和`TopicConnectionFactoryBindingName`指向恶意的JNDI服务器。
4.  **JNDI注入：** 当Log4j尝试通过JMSAppender连接JNDI服务器时，恶意的JNDI服务器返回一个包含恶意代码的序列化对象。
5.  **反序列化执行：** Log4j反序列化该对象，导致恶意代码在目标系统上执行，从而实现远程代码执行。

总而言之，利用的关键在于控制Log4j的配置文件，并诱使其连接到恶意的JNDI服务器。

**项目地址:** [open-AIMS/log4j](https://github.com/open-AIMS/log4j)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---



---

## POC #2

**来源**: [CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md](../2021/CVE-2021-4104-cuijiung_log4j-CVE-2021-4104.md)

## CVE-2021-4104 - Apache Log4j 1.2 JMSAppender 反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 1.2.x

**利用条件:** 目标系统需使用Log4j 1.2，且配置了JMSAppender，攻击者需要具有修改log4j配置文件的权限，目标需要存在JMS环境

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-4104 存在于 Apache Log4j 1.2 中，当 JMSAppender 被配置使用时，攻击者可以通过修改 Log4j 配置文件，指定恶意的 TopicBindingName 和 TopicConnectionFactoryBindingName，利用 JNDI 注入，触发反序列化漏洞，从而实现远程代码执行。

**有效性分析：**
提供的POC代码看起来有效。包含了一个`Evil.java`，它会在构造函数中执行`calc`命令，模拟RCE。`log4j.properties` 配置文件指定了 JMSAppender，并设置了恶意的 JNDI URL (ldap://127.0.0.1:1389/any)。 结合`pom.xml`声明的`log4j`和`activemq-all`依赖，以及`README.md`中提及的利用条件，可以判断这是一个可行的漏洞利用链。

**投毒风险分析：**
检查POC代码，主要关注`Evil.java`和`log4j.properties`两个文件。`Evil.java` 中的 `Runtime.getRuntime().exec("calc")` 仅仅是一个演示payload，没有发现隐藏的恶意代码。虽然通过修改恶意 JNDI URL 可以指向攻击者控制的LDAP服务器，从而加载恶意的类进行RCE，但这个行为是漏洞利用的固有方式，不是作者植入的后门。代码层面投毒可能性较低，但依然需要人工审核确认。pom.xml中引入了ActiveMQ相关的依赖，如果存在ActiveMQ的历史漏洞，可能会被进一步利用，但这不属于代码投毒范畴。

**利用方式：**
1.  **前提条件:** 目标系统运行 Log4j 1.2，并且配置文件中使用了 `org.apache.log4j.net.JMSAppender`。
2.  **配置文件修改:** 攻击者需要获得修改 `log4j.properties` 文件的权限。
3.  **JNDI 注入:** 在 `log4j.properties` 中，修改 `TopicBindingName` 和 `TopicConnectionFactoryBindingName` 属性，将其指向攻击者控制的 LDAP 或 RMI 服务器。
4.  **恶意服务器:** 攻击者搭建一个恶意的 LDAP 或 RMI 服务器，当目标系统尝试从该服务器获取 JNDI 对象时，服务器返回一个包含恶意代码的 Java 对象。
5.  **反序列化执行:** 目标系统反序列化该 Java 对象，从而执行攻击者预设的恶意代码，实现远程代码执行。 

综上，此POC的有效性较高，但利用条件较为苛刻，需要满足特定的 Log4j 配置和具备修改配置文件的权限。 投毒风险极低。

**项目地址:** [cuijiung/log4j-CVE-2021-4104](https://github.com/cuijiung/log4j-CVE-2021-4104)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---

## POC #3

**来源**: [CVE-2021-4104-open-AIMS_log4j.md](../2021/CVE-2021-4104-open-AIMS_log4j.md)

## CVE-2021-4104-Apache Log4j 1.2 JMSAppender反序列化漏洞

**漏洞编号:** CVE-2021-4104

**漏洞类型:** 反序列化

**影响应用:** Apache Log4j 1.2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache Log4j 1.2.x

**利用条件:** 需要目标系统配置为使用JMSAppender，且攻击者有Log4j配置文件的写入权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-4104是Apache Log4j 1.2中的一个反序列化漏洞。当Log4j 1.2被配置为使用JMSAppender时，攻击者如果具有对Log4j配置文件的写入权限，就可以通过修改配置文件，设置恶意的TopicBindingName和TopicConnectionFactoryBindingName，导致JMSAppender发起JNDI请求。这些JNDI请求可以指向恶意的JNDI服务器，从而导致远程代码执行，类似于CVE-2021-44228。

**有效性：**
从搜索结果和漏洞描述来看，该漏洞是真实存在的，并且已经被广泛讨论和研究。利用代码的有效性依赖于目标环境是否满足利用条件，即使用了JMSAppender并且攻击者可以修改配置文件。

**投毒风险：**
提供的漏洞利用代码仅为Apache License 2.0许可文件，不包含任何可执行的代码或配置文件。因此，从这段代码本身来看，不存在投毒风险。投毒风险应该关注于实际使用的PoC代码的来源，需要分析其行为是否包含恶意操作。

**利用方式：**
1.  **前提条件：** 目标系统使用Log4j 1.2，且配置使用了JMSAppender。
2.  **配置修改：** 攻击者需要获得Log4j配置文件的写入权限，修改`log4j.xml`或`log4j.properties`文件。
3.  **JMSAppender配置：** 在配置文件中，设置`TopicBindingName`和`TopicConnectionFactoryBindingName`指向恶意的JNDI服务器。
4.  **JNDI注入：** 当Log4j尝试通过JMSAppender连接JNDI服务器时，恶意的JNDI服务器返回一个包含恶意代码的序列化对象。
5.  **反序列化执行：** Log4j反序列化该对象，导致恶意代码在目标系统上执行，从而实现远程代码执行。

总而言之，利用的关键在于控制Log4j的配置文件，并诱使其连接到恶意的JNDI服务器。

**项目地址:** [open-AIMS/log4j](https://github.com/open-AIMS/log4j)

**漏洞详情:** [CVE-2021-4104](https://nvd.nist.gov/vuln/detail/CVE-2021-4104)

---

