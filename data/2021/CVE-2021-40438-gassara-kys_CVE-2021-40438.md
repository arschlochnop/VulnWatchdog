# CVE-2021-40438

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-40438-BabyTeam1024_CVE-2021-40438.md](../2021/CVE-2021-40438-BabyTeam1024_CVE-2021-40438.md)

## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内网信息泄露、攻击内网服务、甚至远程代码执行（取决于内网服务）。

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了 mod_proxy 模块，并且存在不当的配置允许通过URI进行代理。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是一个存在于 Apache HTTP Server 2.4.48 及更早版本的 mod_proxy 模块中的 SSRF 漏洞。攻击者可以通过构造特定的 URI 路径，使受害服务器将请求转发到攻击者控制的服务器。提供的 Dockerfile 文件旨在构建一个易受攻击的 Apache HTTP Server 环境进行漏洞验证。 Dockerfile 下载并编译了 httpd-2.4.49，但漏洞描述中指明影响版本为 <=2.4.48，因此构建的环境实际应当是存在漏洞的环境。docker-compose.yml 文件用于启动该容器，并将其 80 端口映射到主机的 8787 端口。利用方式是构造恶意的请求 URI，利用 `mod_proxy` 将请求代理到任意外部或内部服务器。投毒风险评估：虽然Dockerfile文件本身包含了从apache.org下载源码并编译的过程，相对来说比较安全，但是考虑到攻击者完全可能替换其中的源码为恶意版本，或者在编译过程中加入恶意代码。考虑到这种可能性，判定存在一定的投毒风险，但因为需要替换源码，相对比较复杂，且dockerfile本身不包含恶意后门，因此投毒风险定为10%。主要风险在于构建环境依赖的外部资源可能被篡改，但是直接在Dockerfile中包含恶意代码的可能性较低。

**项目地址:** [BabyTeam1024/CVE-2021-40438](https://github.com/BabyTeam1024/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #2

**来源**: [CVE-2021-40438-Cappricio-Securities_CVE-2021-40438.md](../2021/CVE-2021-40438-Cappricio-Securities_CVE-2021-40438.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server (mod_proxy)

**危害等级:** 高危，可能导致内部服务访问、敏感信息泄露、甚至远程代码执行

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了mod_proxy模块且存在不安全的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 存在于 Apache HTTP Server 2.4.48 及更早版本中，是由于 `mod_proxy` 模块处理请求 URI 路径不当导致的 SSRF 漏洞。攻击者可以通过构造恶意的 URI 路径，使 `mod_proxy` 将请求转发到攻击者选择的源服务器，从而绕过防火墙、访问内部服务或泄露敏感信息。

**漏洞利用方式：**

1.  **确定目标：** 确定运行 Apache HTTP Server 2.4.48 或更早版本且启用了 `mod_proxy` 模块的服务器。
2.  **构造恶意 URI：** 构造包含目标内部地址或外部恶意地址的 URI 路径。例如： `/proxy/http://internal-service/` 或 `/proxy/http://attacker-controlled-server/`
3.  **发送请求：** 将构造的 URI 路径作为请求发送到目标服务器。
4.  **利用结果：** 如果配置不当，`mod_proxy` 会将请求转发到指定的服务器，攻击者从而可以:
    *   访问内部服务，例如数据库、管理接口等。
    *   读取内部文件。
    *   扫描内部网络。
    *   将请求转发到外部恶意服务器，进行进一步的攻击。

**有效性分析：**

根据漏洞库信息，这是一个已知的、已修复的漏洞。提供的漏洞利用代码（README.md中的描述）是一个Python脚本，该脚本旨在扫描目标URL是否存在 CVE-2021-40438 漏洞。从描述来看，它通过发送特制的请求来尝试触发 SSRF。因此，如果目标存在漏洞，利用代码应该能够检测到。

**投毒风险分析：**

代码中存在通过Telegram API发送通知的功能，初步判断可能存在隐私泄露风险。例如:目标URL，服务器IP等信息。

仔细查看提供的漏洞利用代码（LICENSE和README.md），该代码仓库来自 Cappriciosec。代码本身的功能看起来是漏洞扫描器，用于检查是否存在CVE-2021-40438漏洞。从代码本身来看，直接投毒的可能性较低。然而，存在以下潜在风险：

*   **依赖项风险：** 该工具通过`pip install` 安装，存在依赖包被替换或植入恶意代码的风险。但此风险较低。
*   **Telegram API 密钥泄露：** 如果Telegram Bot 的API密钥被泄露，可能被用于发送钓鱼信息或恶意内容。
*   **数据收集：** 尽管声明是漏洞扫描器，但作者可能暗中收集用户扫描的目标URL等信息。

综合来看，此仓库中存在作者隐藏的投毒代码的可能性较低，预估在10%左右。主要风险在于使用者对代码不熟悉，盲目使用带来的潜在风险，以及Telegram API密钥可能存在的风险。

**项目地址:** [Cappricio-Securities/CVE-2021-40438](https://github.com/Cappricio-Securities/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #3

**来源**: [CVE-2021-40438-Kashkovsky_CVE-2021-40438.md](../2021/CVE-2021-40438-Kashkovsky_CVE-2021-40438.md)

## CVE-2021-40438-Apache mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部网络探测、敏感信息泄露，甚至远程代码执行（取决于内部网络配置）

**影响版本:** <= 2.4.48

**利用条件:** 启用mod_proxy模块且配置不当

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 允许攻击者构造恶意的URI路径，使得 Apache 的 mod_proxy 模块将请求转发到攻击者选择的源服务器。这本质上是一个 SSRF 漏洞。

**有效性：**

提供的POC代码（curl 命令）通过 `unix:` 协议指定了一个目标地址，试图将请求转发到 Unix 域套接字。大量重复的 'A' 字符可能用于绕过某些验证或缓冲区大小限制。此方法如果服务器存在相关配置问题，能够成功利用，使服务器向任意地址发起请求。

**投毒风险：**

该仓库主要提供了一个测试此漏洞的PoC，本身并不能直接确定其中是否存在恶意代码。风险点在于仓库可能包含其他隐蔽的、未记录的Payload或脚本，这些Payload会在用户下载和使用时执行恶意操作。经过代码分析，可以判断该仓库存在投毒代码的可能性较低，约为10%，因为主要内容集中在漏洞的演示和利用上，但仍需保持警惕。

**利用方式：**

1.  **确定目标：** 找到运行着 Apache HTTP Server 2.4.48 或更早版本，且启用了 `mod_proxy` 模块的服务器。
2.  **构造恶意请求：** 使用类似于提供的 `curl` 命令，将目标 URL 设置为内部服务、本地文件系统或其他攻击者想要访问的资源。
3.  **发送请求：** 将构造的请求发送到易受攻击的 Apache 服务器。
4.  **利用结果：** 根据攻击目标的不同，可能的攻击结果包括：
    *   **内部网络探测：** 扫描内部网络，查找其他服务。
    *   **敏感信息泄露：** 读取内部服务返回的敏感数据。
    *   **DoS攻击：** 将流量导向内部服务，造成拒绝服务。
    *   **RCE（如果内部服务存在漏洞）：** 如果攻击者可以访问的内部服务存在漏洞（例如，命令注入），则可能实现远程代码执行。

**项目地址:** [Kashkovsky/CVE-2021-40438](https://github.com/Kashkovsky/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #4

**来源**: [CVE-2021-40438-ericmann_apache-cve-poc.md](../2021/CVE-2021-40438-ericmann_apache-cve-poc.md)

## CVE-2021-40438 - Apache mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF (Server Side Request Forgery)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露、内部网络探测、甚至远程代码执行（取决于内部系统的配置）

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了mod_proxy模块，且存在不当配置允许用户控制请求URI路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是 Apache HTTP Server 2.4.48 及之前版本中 mod_proxy 模块的一个 SSRF 漏洞。攻击者可以通过构造恶意的 URI 路径，使 Apache 服务器将请求转发到由攻击者控制的任意服务器。提供的 POC 代码是一个 Dockerized 的环境，用于演示该漏洞。 

**有效性:**
从漏洞库信息和 POC 代码来看，此漏洞是真实存在的，并且已经有公开的利用方式。POC代码提供了一个可复现的环境，有助于验证漏洞。根据CISA的公告，该漏洞已被积极利用。

**投毒风险:**
提供的 POC 代码主要由以下文件组成：
*   `LICENSE`: MIT 许可证，表明作者允许自由使用和修改代码。
*   `README.md`: 简要介绍了 POC 的用途。
*   `docker-compose.yml`: 定义了 PHP 和 Apache 两个服务，通过 Docker 容器来搭建测试环境。
*   `php/Dockerfile`: 定义了 PHP 服务的构建过程，使用 PHP 8.0-cli 镜像，并运行一个简单的 phpinfo() 服务。
*   `php/server.php`: 一个简单的 PHP 文件，用于显示 phpinfo() 信息。
*   `apache/Dockerfile`: 定义了 Apache 服务的构建过程，使用 httpd:2.4.48 镜像，并配置了 httpd.conf 和 vhost.conf 文件。
*   `apache/httpd.conf`: Apache 的主配置文件，用于配置服务器的基本参数。
*   `apache/vhost.conf`: 虚拟主机配置文件，用于配置反向代理规则。

代码中没有明显的恶意代码或后门，但存在一定的风险：
1.  `docker-compose.yml` 文件可能会从 Docker Hub 拉取镜像。如果 Docker Hub 上的官方镜像被篡改，则可能引入恶意代码。
2.  `apache/vhost.conf` 文件的配置决定了反向代理规则。不正确的配置可能会导致其他安全问题，例如开放不必要的端口或暴露敏感信息。 

因此，虽然 POC 代码本身没有明显的投毒，但使用时仍需谨慎，特别是从不受信任的来源获取时。由于代码主要用于演示和复现漏洞，不太可能有隐藏的恶意后门。但是，在实际环境中部署和使用这些代码之前，务必进行代码审计和安全评估。

**利用方式:**
利用方式主要是通过精心构造包含目标服务器地址的URI路径，发送给存在漏洞的Apache服务器。该服务器如果配置了反向代理，会将请求转发到攻击者指定的目标服务器上，从而实现SSRF攻击。具体来说，攻击者可以控制反向代理的目标地址，进而读取内部服务或向内部服务发送恶意请求。


**项目地址:** [ericmann/apache-cve-poc](https://github.com/ericmann/apache-cve-poc)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #5

**来源**: [CVE-2021-40438-gassara-kys_CVE-2021-40438.md](../2021/CVE-2021-40438-gassara-kys_CVE-2021-40438.md)

# CVE-2021-40438

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-40438-BabyTeam1024_CVE-2021-40438.md](../2021/CVE-2021-40438-BabyTeam1024_CVE-2021-40438.md)

## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内网信息泄露、攻击内网服务、甚至远程代码执行（取决于内网服务）。

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了 mod_proxy 模块，并且存在不当的配置允许通过URI进行代理。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是一个存在于 Apache HTTP Server 2.4.48 及更早版本的 mod_proxy 模块中的 SSRF 漏洞。攻击者可以通过构造特定的 URI 路径，使受害服务器将请求转发到攻击者控制的服务器。提供的 Dockerfile 文件旨在构建一个易受攻击的 Apache HTTP Server 环境进行漏洞验证。 Dockerfile 下载并编译了 httpd-2.4.49，但漏洞描述中指明影响版本为 <=2.4.48，因此构建的环境实际应当是存在漏洞的环境。docker-compose.yml 文件用于启动该容器，并将其 80 端口映射到主机的 8787 端口。利用方式是构造恶意的请求 URI，利用 `mod_proxy` 将请求代理到任意外部或内部服务器。投毒风险评估：虽然Dockerfile文件本身包含了从apache.org下载源码并编译的过程，相对来说比较安全，但是考虑到攻击者完全可能替换其中的源码为恶意版本，或者在编译过程中加入恶意代码。考虑到这种可能性，判定存在一定的投毒风险，但因为需要替换源码，相对比较复杂，且dockerfile本身不包含恶意后门，因此投毒风险定为10%。主要风险在于构建环境依赖的外部资源可能被篡改，但是直接在Dockerfile中包含恶意代码的可能性较低。

**项目地址:** [BabyTeam1024/CVE-2021-40438](https://github.com/BabyTeam1024/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #2

**来源**: [CVE-2021-40438-Cappricio-Securities_CVE-2021-40438.md](../2021/CVE-2021-40438-Cappricio-Securities_CVE-2021-40438.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server (mod_proxy)

**危害等级:** 高危，可能导致内部服务访问、敏感信息泄露、甚至远程代码执行

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了mod_proxy模块且存在不安全的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 存在于 Apache HTTP Server 2.4.48 及更早版本中，是由于 `mod_proxy` 模块处理请求 URI 路径不当导致的 SSRF 漏洞。攻击者可以通过构造恶意的 URI 路径，使 `mod_proxy` 将请求转发到攻击者选择的源服务器，从而绕过防火墙、访问内部服务或泄露敏感信息。

**漏洞利用方式：**

1.  **确定目标：** 确定运行 Apache HTTP Server 2.4.48 或更早版本且启用了 `mod_proxy` 模块的服务器。
2.  **构造恶意 URI：** 构造包含目标内部地址或外部恶意地址的 URI 路径。例如： `/proxy/http://internal-service/` 或 `/proxy/http://attacker-controlled-server/`
3.  **发送请求：** 将构造的 URI 路径作为请求发送到目标服务器。
4.  **利用结果：** 如果配置不当，`mod_proxy` 会将请求转发到指定的服务器，攻击者从而可以:
    *   访问内部服务，例如数据库、管理接口等。
    *   读取内部文件。
    *   扫描内部网络。
    *   将请求转发到外部恶意服务器，进行进一步的攻击。

**有效性分析：**

根据漏洞库信息，这是一个已知的、已修复的漏洞。提供的漏洞利用代码（README.md中的描述）是一个Python脚本，该脚本旨在扫描目标URL是否存在 CVE-2021-40438 漏洞。从描述来看，它通过发送特制的请求来尝试触发 SSRF。因此，如果目标存在漏洞，利用代码应该能够检测到。

**投毒风险分析：**

代码中存在通过Telegram API发送通知的功能，初步判断可能存在隐私泄露风险。例如:目标URL，服务器IP等信息。

仔细查看提供的漏洞利用代码（LICENSE和README.md），该代码仓库来自 Cappriciosec。代码本身的功能看起来是漏洞扫描器，用于检查是否存在CVE-2021-40438漏洞。从代码本身来看，直接投毒的可能性较低。然而，存在以下潜在风险：

*   **依赖项风险：** 该工具通过`pip install` 安装，存在依赖包被替换或植入恶意代码的风险。但此风险较低。
*   **Telegram API 密钥泄露：** 如果Telegram Bot 的API密钥被泄露，可能被用于发送钓鱼信息或恶意内容。
*   **数据收集：** 尽管声明是漏洞扫描器，但作者可能暗中收集用户扫描的目标URL等信息。

综合来看，此仓库中存在作者隐藏的投毒代码的可能性较低，预估在10%左右。主要风险在于使用者对代码不熟悉，盲目使用带来的潜在风险，以及Telegram API密钥可能存在的风险。

**项目地址:** [Cappricio-Securities/CVE-2021-40438](https://github.com/Cappricio-Securities/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #3

**来源**: [CVE-2021-40438-Kashkovsky_CVE-2021-40438.md](../2021/CVE-2021-40438-Kashkovsky_CVE-2021-40438.md)

## CVE-2021-40438-Apache mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部网络探测、敏感信息泄露，甚至远程代码执行（取决于内部网络配置）

**影响版本:** <= 2.4.48

**利用条件:** 启用mod_proxy模块且配置不当

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 允许攻击者构造恶意的URI路径，使得 Apache 的 mod_proxy 模块将请求转发到攻击者选择的源服务器。这本质上是一个 SSRF 漏洞。

**有效性：**

提供的POC代码（curl 命令）通过 `unix:` 协议指定了一个目标地址，试图将请求转发到 Unix 域套接字。大量重复的 'A' 字符可能用于绕过某些验证或缓冲区大小限制。此方法如果服务器存在相关配置问题，能够成功利用，使服务器向任意地址发起请求。

**投毒风险：**

该仓库主要提供了一个测试此漏洞的PoC，本身并不能直接确定其中是否存在恶意代码。风险点在于仓库可能包含其他隐蔽的、未记录的Payload或脚本，这些Payload会在用户下载和使用时执行恶意操作。经过代码分析，可以判断该仓库存在投毒代码的可能性较低，约为10%，因为主要内容集中在漏洞的演示和利用上，但仍需保持警惕。

**利用方式：**

1.  **确定目标：** 找到运行着 Apache HTTP Server 2.4.48 或更早版本，且启用了 `mod_proxy` 模块的服务器。
2.  **构造恶意请求：** 使用类似于提供的 `curl` 命令，将目标 URL 设置为内部服务、本地文件系统或其他攻击者想要访问的资源。
3.  **发送请求：** 将构造的请求发送到易受攻击的 Apache 服务器。
4.  **利用结果：** 根据攻击目标的不同，可能的攻击结果包括：
    *   **内部网络探测：** 扫描内部网络，查找其他服务。
    *   **敏感信息泄露：** 读取内部服务返回的敏感数据。
    *   **DoS攻击：** 将流量导向内部服务，造成拒绝服务。
    *   **RCE（如果内部服务存在漏洞）：** 如果攻击者可以访问的内部服务存在漏洞（例如，命令注入），则可能实现远程代码执行。

**项目地址:** [Kashkovsky/CVE-2021-40438](https://github.com/Kashkovsky/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #4

**来源**: [CVE-2021-40438-ericmann_apache-cve-poc.md](../2021/CVE-2021-40438-ericmann_apache-cve-poc.md)

## CVE-2021-40438 - Apache mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF (Server Side Request Forgery)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露、内部网络探测、甚至远程代码执行（取决于内部系统的配置）

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了mod_proxy模块，且存在不当配置允许用户控制请求URI路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是 Apache HTTP Server 2.4.48 及之前版本中 mod_proxy 模块的一个 SSRF 漏洞。攻击者可以通过构造恶意的 URI 路径，使 Apache 服务器将请求转发到由攻击者控制的任意服务器。提供的 POC 代码是一个 Dockerized 的环境，用于演示该漏洞。 

**有效性:**
从漏洞库信息和 POC 代码来看，此漏洞是真实存在的，并且已经有公开的利用方式。POC代码提供了一个可复现的环境，有助于验证漏洞。根据CISA的公告，该漏洞已被积极利用。

**投毒风险:**
提供的 POC 代码主要由以下文件组成：
*   `LICENSE`: MIT 许可证，表明作者允许自由使用和修改代码。
*   `README.md`: 简要介绍了 POC 的用途。
*   `docker-compose.yml`: 定义了 PHP 和 Apache 两个服务，通过 Docker 容器来搭建测试环境。
*   `php/Dockerfile`: 定义了 PHP 服务的构建过程，使用 PHP 8.0-cli 镜像，并运行一个简单的 phpinfo() 服务。
*   `php/server.php`: 一个简单的 PHP 文件，用于显示 phpinfo() 信息。
*   `apache/Dockerfile`: 定义了 Apache 服务的构建过程，使用 httpd:2.4.48 镜像，并配置了 httpd.conf 和 vhost.conf 文件。
*   `apache/httpd.conf`: Apache 的主配置文件，用于配置服务器的基本参数。
*   `apache/vhost.conf`: 虚拟主机配置文件，用于配置反向代理规则。

代码中没有明显的恶意代码或后门，但存在一定的风险：
1.  `docker-compose.yml` 文件可能会从 Docker Hub 拉取镜像。如果 Docker Hub 上的官方镜像被篡改，则可能引入恶意代码。
2.  `apache/vhost.conf` 文件的配置决定了反向代理规则。不正确的配置可能会导致其他安全问题，例如开放不必要的端口或暴露敏感信息。 

因此，虽然 POC 代码本身没有明显的投毒，但使用时仍需谨慎，特别是从不受信任的来源获取时。由于代码主要用于演示和复现漏洞，不太可能有隐藏的恶意后门。但是，在实际环境中部署和使用这些代码之前，务必进行代码审计和安全评估。

**利用方式:**
利用方式主要是通过精心构造包含目标服务器地址的URI路径，发送给存在漏洞的Apache服务器。该服务器如果配置了反向代理，会将请求转发到攻击者指定的目标服务器上，从而实现SSRF攻击。具体来说，攻击者可以控制反向代理的目标地址，进而读取内部服务或向内部服务发送恶意请求。


**项目地址:** [ericmann/apache-cve-poc](https://github.com/ericmann/apache-cve-poc)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #5

**来源**: [CVE-2021-40438-gassara-kys_CVE-2021-40438.md](../2021/CVE-2021-40438-gassara-kys_CVE-2021-40438.md)

# CVE-2021-40438

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-40438-BabyTeam1024_CVE-2021-40438.md](../2021/CVE-2021-40438-BabyTeam1024_CVE-2021-40438.md)

## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内网信息泄露、攻击内网服务、甚至远程代码执行（取决于内网服务）。

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了 mod_proxy 模块，并且存在不当的配置允许通过URI进行代理。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是一个存在于 Apache HTTP Server 2.4.48 及更早版本的 mod_proxy 模块中的 SSRF 漏洞。攻击者可以通过构造特定的 URI 路径，使受害服务器将请求转发到攻击者控制的服务器。提供的 Dockerfile 文件旨在构建一个易受攻击的 Apache HTTP Server 环境进行漏洞验证。 Dockerfile 下载并编译了 httpd-2.4.49，但漏洞描述中指明影响版本为 <=2.4.48，因此构建的环境实际应当是存在漏洞的环境。docker-compose.yml 文件用于启动该容器，并将其 80 端口映射到主机的 8787 端口。利用方式是构造恶意的请求 URI，利用 `mod_proxy` 将请求代理到任意外部或内部服务器。投毒风险评估：虽然Dockerfile文件本身包含了从apache.org下载源码并编译的过程，相对来说比较安全，但是考虑到攻击者完全可能替换其中的源码为恶意版本，或者在编译过程中加入恶意代码。考虑到这种可能性，判定存在一定的投毒风险，但因为需要替换源码，相对比较复杂，且dockerfile本身不包含恶意后门，因此投毒风险定为10%。主要风险在于构建环境依赖的外部资源可能被篡改，但是直接在Dockerfile中包含恶意代码的可能性较低。

**项目地址:** [BabyTeam1024/CVE-2021-40438](https://github.com/BabyTeam1024/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #2

**来源**: [CVE-2021-40438-Cappricio-Securities_CVE-2021-40438.md](../2021/CVE-2021-40438-Cappricio-Securities_CVE-2021-40438.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server (mod_proxy)

**危害等级:** 高危，可能导致内部服务访问、敏感信息泄露、甚至远程代码执行

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了mod_proxy模块且存在不安全的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 存在于 Apache HTTP Server 2.4.48 及更早版本中，是由于 `mod_proxy` 模块处理请求 URI 路径不当导致的 SSRF 漏洞。攻击者可以通过构造恶意的 URI 路径，使 `mod_proxy` 将请求转发到攻击者选择的源服务器，从而绕过防火墙、访问内部服务或泄露敏感信息。

**漏洞利用方式：**

1.  **确定目标：** 确定运行 Apache HTTP Server 2.4.48 或更早版本且启用了 `mod_proxy` 模块的服务器。
2.  **构造恶意 URI：** 构造包含目标内部地址或外部恶意地址的 URI 路径。例如： `/proxy/http://internal-service/` 或 `/proxy/http://attacker-controlled-server/`
3.  **发送请求：** 将构造的 URI 路径作为请求发送到目标服务器。
4.  **利用结果：** 如果配置不当，`mod_proxy` 会将请求转发到指定的服务器，攻击者从而可以:
    *   访问内部服务，例如数据库、管理接口等。
    *   读取内部文件。
    *   扫描内部网络。
    *   将请求转发到外部恶意服务器，进行进一步的攻击。

**有效性分析：**

根据漏洞库信息，这是一个已知的、已修复的漏洞。提供的漏洞利用代码（README.md中的描述）是一个Python脚本，该脚本旨在扫描目标URL是否存在 CVE-2021-40438 漏洞。从描述来看，它通过发送特制的请求来尝试触发 SSRF。因此，如果目标存在漏洞，利用代码应该能够检测到。

**投毒风险分析：**

代码中存在通过Telegram API发送通知的功能，初步判断可能存在隐私泄露风险。例如:目标URL，服务器IP等信息。

仔细查看提供的漏洞利用代码（LICENSE和README.md），该代码仓库来自 Cappriciosec。代码本身的功能看起来是漏洞扫描器，用于检查是否存在CVE-2021-40438漏洞。从代码本身来看，直接投毒的可能性较低。然而，存在以下潜在风险：

*   **依赖项风险：** 该工具通过`pip install` 安装，存在依赖包被替换或植入恶意代码的风险。但此风险较低。
*   **Telegram API 密钥泄露：** 如果Telegram Bot 的API密钥被泄露，可能被用于发送钓鱼信息或恶意内容。
*   **数据收集：** 尽管声明是漏洞扫描器，但作者可能暗中收集用户扫描的目标URL等信息。

综合来看，此仓库中存在作者隐藏的投毒代码的可能性较低，预估在10%左右。主要风险在于使用者对代码不熟悉，盲目使用带来的潜在风险，以及Telegram API密钥可能存在的风险。

**项目地址:** [Cappricio-Securities/CVE-2021-40438](https://github.com/Cappricio-Securities/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #3

**来源**: [CVE-2021-40438-Kashkovsky_CVE-2021-40438.md](../2021/CVE-2021-40438-Kashkovsky_CVE-2021-40438.md)

## CVE-2021-40438-Apache mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部网络探测、敏感信息泄露，甚至远程代码执行（取决于内部网络配置）

**影响版本:** <= 2.4.48

**利用条件:** 启用mod_proxy模块且配置不当

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 允许攻击者构造恶意的URI路径，使得 Apache 的 mod_proxy 模块将请求转发到攻击者选择的源服务器。这本质上是一个 SSRF 漏洞。

**有效性：**

提供的POC代码（curl 命令）通过 `unix:` 协议指定了一个目标地址，试图将请求转发到 Unix 域套接字。大量重复的 'A' 字符可能用于绕过某些验证或缓冲区大小限制。此方法如果服务器存在相关配置问题，能够成功利用，使服务器向任意地址发起请求。

**投毒风险：**

该仓库主要提供了一个测试此漏洞的PoC，本身并不能直接确定其中是否存在恶意代码。风险点在于仓库可能包含其他隐蔽的、未记录的Payload或脚本，这些Payload会在用户下载和使用时执行恶意操作。经过代码分析，可以判断该仓库存在投毒代码的可能性较低，约为10%，因为主要内容集中在漏洞的演示和利用上，但仍需保持警惕。

**利用方式：**

1.  **确定目标：** 找到运行着 Apache HTTP Server 2.4.48 或更早版本，且启用了 `mod_proxy` 模块的服务器。
2.  **构造恶意请求：** 使用类似于提供的 `curl` 命令，将目标 URL 设置为内部服务、本地文件系统或其他攻击者想要访问的资源。
3.  **发送请求：** 将构造的请求发送到易受攻击的 Apache 服务器。
4.  **利用结果：** 根据攻击目标的不同，可能的攻击结果包括：
    *   **内部网络探测：** 扫描内部网络，查找其他服务。
    *   **敏感信息泄露：** 读取内部服务返回的敏感数据。
    *   **DoS攻击：** 将流量导向内部服务，造成拒绝服务。
    *   **RCE（如果内部服务存在漏洞）：** 如果攻击者可以访问的内部服务存在漏洞（例如，命令注入），则可能实现远程代码执行。

**项目地址:** [Kashkovsky/CVE-2021-40438](https://github.com/Kashkovsky/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #4

**来源**: [CVE-2021-40438-ericmann_apache-cve-poc.md](../2021/CVE-2021-40438-ericmann_apache-cve-poc.md)

## CVE-2021-40438 - Apache mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF (Server Side Request Forgery)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露、内部网络探测、甚至远程代码执行（取决于内部系统的配置）

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了mod_proxy模块，且存在不当配置允许用户控制请求URI路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是 Apache HTTP Server 2.4.48 及之前版本中 mod_proxy 模块的一个 SSRF 漏洞。攻击者可以通过构造恶意的 URI 路径，使 Apache 服务器将请求转发到由攻击者控制的任意服务器。提供的 POC 代码是一个 Dockerized 的环境，用于演示该漏洞。 

**有效性:**
从漏洞库信息和 POC 代码来看，此漏洞是真实存在的，并且已经有公开的利用方式。POC代码提供了一个可复现的环境，有助于验证漏洞。根据CISA的公告，该漏洞已被积极利用。

**投毒风险:**
提供的 POC 代码主要由以下文件组成：
*   `LICENSE`: MIT 许可证，表明作者允许自由使用和修改代码。
*   `README.md`: 简要介绍了 POC 的用途。
*   `docker-compose.yml`: 定义了 PHP 和 Apache 两个服务，通过 Docker 容器来搭建测试环境。
*   `php/Dockerfile`: 定义了 PHP 服务的构建过程，使用 PHP 8.0-cli 镜像，并运行一个简单的 phpinfo() 服务。
*   `php/server.php`: 一个简单的 PHP 文件，用于显示 phpinfo() 信息。
*   `apache/Dockerfile`: 定义了 Apache 服务的构建过程，使用 httpd:2.4.48 镜像，并配置了 httpd.conf 和 vhost.conf 文件。
*   `apache/httpd.conf`: Apache 的主配置文件，用于配置服务器的基本参数。
*   `apache/vhost.conf`: 虚拟主机配置文件，用于配置反向代理规则。

代码中没有明显的恶意代码或后门，但存在一定的风险：
1.  `docker-compose.yml` 文件可能会从 Docker Hub 拉取镜像。如果 Docker Hub 上的官方镜像被篡改，则可能引入恶意代码。
2.  `apache/vhost.conf` 文件的配置决定了反向代理规则。不正确的配置可能会导致其他安全问题，例如开放不必要的端口或暴露敏感信息。 

因此，虽然 POC 代码本身没有明显的投毒，但使用时仍需谨慎，特别是从不受信任的来源获取时。由于代码主要用于演示和复现漏洞，不太可能有隐藏的恶意后门。但是，在实际环境中部署和使用这些代码之前，务必进行代码审计和安全评估。

**利用方式:**
利用方式主要是通过精心构造包含目标服务器地址的URI路径，发送给存在漏洞的Apache服务器。该服务器如果配置了反向代理，会将请求转发到攻击者指定的目标服务器上，从而实现SSRF攻击。具体来说，攻击者可以控制反向代理的目标地址，进而读取内部服务或向内部服务发送恶意请求。


**项目地址:** [ericmann/apache-cve-poc](https://github.com/ericmann/apache-cve-poc)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #5

**来源**: [CVE-2021-40438-gassara-kys_CVE-2021-40438.md](../2021/CVE-2021-40438-gassara-kys_CVE-2021-40438.md)

# CVE-2021-40438

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-40438-BabyTeam1024_CVE-2021-40438.md](../2021/CVE-2021-40438-BabyTeam1024_CVE-2021-40438.md)

## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内网信息泄露、攻击内网服务、甚至远程代码执行（取决于内网服务）。

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了 mod_proxy 模块，并且存在不当的配置允许通过URI进行代理。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是一个存在于 Apache HTTP Server 2.4.48 及更早版本的 mod_proxy 模块中的 SSRF 漏洞。攻击者可以通过构造特定的 URI 路径，使受害服务器将请求转发到攻击者控制的服务器。提供的 Dockerfile 文件旨在构建一个易受攻击的 Apache HTTP Server 环境进行漏洞验证。 Dockerfile 下载并编译了 httpd-2.4.49，但漏洞描述中指明影响版本为 <=2.4.48，因此构建的环境实际应当是存在漏洞的环境。docker-compose.yml 文件用于启动该容器，并将其 80 端口映射到主机的 8787 端口。利用方式是构造恶意的请求 URI，利用 `mod_proxy` 将请求代理到任意外部或内部服务器。投毒风险评估：虽然Dockerfile文件本身包含了从apache.org下载源码并编译的过程，相对来说比较安全，但是考虑到攻击者完全可能替换其中的源码为恶意版本，或者在编译过程中加入恶意代码。考虑到这种可能性，判定存在一定的投毒风险，但因为需要替换源码，相对比较复杂，且dockerfile本身不包含恶意后门，因此投毒风险定为10%。主要风险在于构建环境依赖的外部资源可能被篡改，但是直接在Dockerfile中包含恶意代码的可能性较低。

**项目地址:** [BabyTeam1024/CVE-2021-40438](https://github.com/BabyTeam1024/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #2

**来源**: [CVE-2021-40438-Cappricio-Securities_CVE-2021-40438.md](../2021/CVE-2021-40438-Cappricio-Securities_CVE-2021-40438.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server (mod_proxy)

**危害等级:** 高危，可能导致内部服务访问、敏感信息泄露、甚至远程代码执行

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了mod_proxy模块且存在不安全的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 存在于 Apache HTTP Server 2.4.48 及更早版本中，是由于 `mod_proxy` 模块处理请求 URI 路径不当导致的 SSRF 漏洞。攻击者可以通过构造恶意的 URI 路径，使 `mod_proxy` 将请求转发到攻击者选择的源服务器，从而绕过防火墙、访问内部服务或泄露敏感信息。

**漏洞利用方式：**

1.  **确定目标：** 确定运行 Apache HTTP Server 2.4.48 或更早版本且启用了 `mod_proxy` 模块的服务器。
2.  **构造恶意 URI：** 构造包含目标内部地址或外部恶意地址的 URI 路径。例如： `/proxy/http://internal-service/` 或 `/proxy/http://attacker-controlled-server/`
3.  **发送请求：** 将构造的 URI 路径作为请求发送到目标服务器。
4.  **利用结果：** 如果配置不当，`mod_proxy` 会将请求转发到指定的服务器，攻击者从而可以:
    *   访问内部服务，例如数据库、管理接口等。
    *   读取内部文件。
    *   扫描内部网络。
    *   将请求转发到外部恶意服务器，进行进一步的攻击。

**有效性分析：**

根据漏洞库信息，这是一个已知的、已修复的漏洞。提供的漏洞利用代码（README.md中的描述）是一个Python脚本，该脚本旨在扫描目标URL是否存在 CVE-2021-40438 漏洞。从描述来看，它通过发送特制的请求来尝试触发 SSRF。因此，如果目标存在漏洞，利用代码应该能够检测到。

**投毒风险分析：**

代码中存在通过Telegram API发送通知的功能，初步判断可能存在隐私泄露风险。例如:目标URL，服务器IP等信息。

仔细查看提供的漏洞利用代码（LICENSE和README.md），该代码仓库来自 Cappriciosec。代码本身的功能看起来是漏洞扫描器，用于检查是否存在CVE-2021-40438漏洞。从代码本身来看，直接投毒的可能性较低。然而，存在以下潜在风险：

*   **依赖项风险：** 该工具通过`pip install` 安装，存在依赖包被替换或植入恶意代码的风险。但此风险较低。
*   **Telegram API 密钥泄露：** 如果Telegram Bot 的API密钥被泄露，可能被用于发送钓鱼信息或恶意内容。
*   **数据收集：** 尽管声明是漏洞扫描器，但作者可能暗中收集用户扫描的目标URL等信息。

综合来看，此仓库中存在作者隐藏的投毒代码的可能性较低，预估在10%左右。主要风险在于使用者对代码不熟悉，盲目使用带来的潜在风险，以及Telegram API密钥可能存在的风险。

**项目地址:** [Cappricio-Securities/CVE-2021-40438](https://github.com/Cappricio-Securities/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #3

**来源**: [CVE-2021-40438-Kashkovsky_CVE-2021-40438.md](../2021/CVE-2021-40438-Kashkovsky_CVE-2021-40438.md)

## CVE-2021-40438-Apache mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部网络探测、敏感信息泄露，甚至远程代码执行（取决于内部网络配置）

**影响版本:** <= 2.4.48

**利用条件:** 启用mod_proxy模块且配置不当

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 允许攻击者构造恶意的URI路径，使得 Apache 的 mod_proxy 模块将请求转发到攻击者选择的源服务器。这本质上是一个 SSRF 漏洞。

**有效性：**

提供的POC代码（curl 命令）通过 `unix:` 协议指定了一个目标地址，试图将请求转发到 Unix 域套接字。大量重复的 'A' 字符可能用于绕过某些验证或缓冲区大小限制。此方法如果服务器存在相关配置问题，能够成功利用，使服务器向任意地址发起请求。

**投毒风险：**

该仓库主要提供了一个测试此漏洞的PoC，本身并不能直接确定其中是否存在恶意代码。风险点在于仓库可能包含其他隐蔽的、未记录的Payload或脚本，这些Payload会在用户下载和使用时执行恶意操作。经过代码分析，可以判断该仓库存在投毒代码的可能性较低，约为10%，因为主要内容集中在漏洞的演示和利用上，但仍需保持警惕。

**利用方式：**

1.  **确定目标：** 找到运行着 Apache HTTP Server 2.4.48 或更早版本，且启用了 `mod_proxy` 模块的服务器。
2.  **构造恶意请求：** 使用类似于提供的 `curl` 命令，将目标 URL 设置为内部服务、本地文件系统或其他攻击者想要访问的资源。
3.  **发送请求：** 将构造的请求发送到易受攻击的 Apache 服务器。
4.  **利用结果：** 根据攻击目标的不同，可能的攻击结果包括：
    *   **内部网络探测：** 扫描内部网络，查找其他服务。
    *   **敏感信息泄露：** 读取内部服务返回的敏感数据。
    *   **DoS攻击：** 将流量导向内部服务，造成拒绝服务。
    *   **RCE（如果内部服务存在漏洞）：** 如果攻击者可以访问的内部服务存在漏洞（例如，命令注入），则可能实现远程代码执行。

**项目地址:** [Kashkovsky/CVE-2021-40438](https://github.com/Kashkovsky/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #4

**来源**: [CVE-2021-40438-ericmann_apache-cve-poc.md](../2021/CVE-2021-40438-ericmann_apache-cve-poc.md)

## CVE-2021-40438 - Apache mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF (Server Side Request Forgery)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露、内部网络探测、甚至远程代码执行（取决于内部系统的配置）

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了mod_proxy模块，且存在不当配置允许用户控制请求URI路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是 Apache HTTP Server 2.4.48 及之前版本中 mod_proxy 模块的一个 SSRF 漏洞。攻击者可以通过构造恶意的 URI 路径，使 Apache 服务器将请求转发到由攻击者控制的任意服务器。提供的 POC 代码是一个 Dockerized 的环境，用于演示该漏洞。 

**有效性:**
从漏洞库信息和 POC 代码来看，此漏洞是真实存在的，并且已经有公开的利用方式。POC代码提供了一个可复现的环境，有助于验证漏洞。根据CISA的公告，该漏洞已被积极利用。

**投毒风险:**
提供的 POC 代码主要由以下文件组成：
*   `LICENSE`: MIT 许可证，表明作者允许自由使用和修改代码。
*   `README.md`: 简要介绍了 POC 的用途。
*   `docker-compose.yml`: 定义了 PHP 和 Apache 两个服务，通过 Docker 容器来搭建测试环境。
*   `php/Dockerfile`: 定义了 PHP 服务的构建过程，使用 PHP 8.0-cli 镜像，并运行一个简单的 phpinfo() 服务。
*   `php/server.php`: 一个简单的 PHP 文件，用于显示 phpinfo() 信息。
*   `apache/Dockerfile`: 定义了 Apache 服务的构建过程，使用 httpd:2.4.48 镜像，并配置了 httpd.conf 和 vhost.conf 文件。
*   `apache/httpd.conf`: Apache 的主配置文件，用于配置服务器的基本参数。
*   `apache/vhost.conf`: 虚拟主机配置文件，用于配置反向代理规则。

代码中没有明显的恶意代码或后门，但存在一定的风险：
1.  `docker-compose.yml` 文件可能会从 Docker Hub 拉取镜像。如果 Docker Hub 上的官方镜像被篡改，则可能引入恶意代码。
2.  `apache/vhost.conf` 文件的配置决定了反向代理规则。不正确的配置可能会导致其他安全问题，例如开放不必要的端口或暴露敏感信息。 

因此，虽然 POC 代码本身没有明显的投毒，但使用时仍需谨慎，特别是从不受信任的来源获取时。由于代码主要用于演示和复现漏洞，不太可能有隐藏的恶意后门。但是，在实际环境中部署和使用这些代码之前，务必进行代码审计和安全评估。

**利用方式:**
利用方式主要是通过精心构造包含目标服务器地址的URI路径，发送给存在漏洞的Apache服务器。该服务器如果配置了反向代理，会将请求转发到攻击者指定的目标服务器上，从而实现SSRF攻击。具体来说，攻击者可以控制反向代理的目标地址，进而读取内部服务或向内部服务发送恶意请求。


**项目地址:** [ericmann/apache-cve-poc](https://github.com/ericmann/apache-cve-poc)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #5

**来源**: [CVE-2021-40438-gassara-kys_CVE-2021-40438.md](../2021/CVE-2021-40438-gassara-kys_CVE-2021-40438.md)

# CVE-2021-40438

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-40438-BabyTeam1024_CVE-2021-40438.md](../2021/CVE-2021-40438-BabyTeam1024_CVE-2021-40438.md)

## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内网信息泄露、攻击内网服务、甚至远程代码执行（取决于内网服务）。

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了 mod_proxy 模块，并且存在不当的配置允许通过URI进行代理。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是一个存在于 Apache HTTP Server 2.4.48 及更早版本的 mod_proxy 模块中的 SSRF 漏洞。攻击者可以通过构造特定的 URI 路径，使受害服务器将请求转发到攻击者控制的服务器。提供的 Dockerfile 文件旨在构建一个易受攻击的 Apache HTTP Server 环境进行漏洞验证。 Dockerfile 下载并编译了 httpd-2.4.49，但漏洞描述中指明影响版本为 <=2.4.48，因此构建的环境实际应当是存在漏洞的环境。docker-compose.yml 文件用于启动该容器，并将其 80 端口映射到主机的 8787 端口。利用方式是构造恶意的请求 URI，利用 `mod_proxy` 将请求代理到任意外部或内部服务器。投毒风险评估：虽然Dockerfile文件本身包含了从apache.org下载源码并编译的过程，相对来说比较安全，但是考虑到攻击者完全可能替换其中的源码为恶意版本，或者在编译过程中加入恶意代码。考虑到这种可能性，判定存在一定的投毒风险，但因为需要替换源码，相对比较复杂，且dockerfile本身不包含恶意后门，因此投毒风险定为10%。主要风险在于构建环境依赖的外部资源可能被篡改，但是直接在Dockerfile中包含恶意代码的可能性较低。

**项目地址:** [BabyTeam1024/CVE-2021-40438](https://github.com/BabyTeam1024/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #2

**来源**: [CVE-2021-40438-Cappricio-Securities_CVE-2021-40438.md](../2021/CVE-2021-40438-Cappricio-Securities_CVE-2021-40438.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server (mod_proxy)

**危害等级:** 高危，可能导致内部服务访问、敏感信息泄露、甚至远程代码执行

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了mod_proxy模块且存在不安全的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 存在于 Apache HTTP Server 2.4.48 及更早版本中，是由于 `mod_proxy` 模块处理请求 URI 路径不当导致的 SSRF 漏洞。攻击者可以通过构造恶意的 URI 路径，使 `mod_proxy` 将请求转发到攻击者选择的源服务器，从而绕过防火墙、访问内部服务或泄露敏感信息。

**漏洞利用方式：**

1.  **确定目标：** 确定运行 Apache HTTP Server 2.4.48 或更早版本且启用了 `mod_proxy` 模块的服务器。
2.  **构造恶意 URI：** 构造包含目标内部地址或外部恶意地址的 URI 路径。例如： `/proxy/http://internal-service/` 或 `/proxy/http://attacker-controlled-server/`
3.  **发送请求：** 将构造的 URI 路径作为请求发送到目标服务器。
4.  **利用结果：** 如果配置不当，`mod_proxy` 会将请求转发到指定的服务器，攻击者从而可以:
    *   访问内部服务，例如数据库、管理接口等。
    *   读取内部文件。
    *   扫描内部网络。
    *   将请求转发到外部恶意服务器，进行进一步的攻击。

**有效性分析：**

根据漏洞库信息，这是一个已知的、已修复的漏洞。提供的漏洞利用代码（README.md中的描述）是一个Python脚本，该脚本旨在扫描目标URL是否存在 CVE-2021-40438 漏洞。从描述来看，它通过发送特制的请求来尝试触发 SSRF。因此，如果目标存在漏洞，利用代码应该能够检测到。

**投毒风险分析：**

代码中存在通过Telegram API发送通知的功能，初步判断可能存在隐私泄露风险。例如:目标URL，服务器IP等信息。

仔细查看提供的漏洞利用代码（LICENSE和README.md），该代码仓库来自 Cappriciosec。代码本身的功能看起来是漏洞扫描器，用于检查是否存在CVE-2021-40438漏洞。从代码本身来看，直接投毒的可能性较低。然而，存在以下潜在风险：

*   **依赖项风险：** 该工具通过`pip install` 安装，存在依赖包被替换或植入恶意代码的风险。但此风险较低。
*   **Telegram API 密钥泄露：** 如果Telegram Bot 的API密钥被泄露，可能被用于发送钓鱼信息或恶意内容。
*   **数据收集：** 尽管声明是漏洞扫描器，但作者可能暗中收集用户扫描的目标URL等信息。

综合来看，此仓库中存在作者隐藏的投毒代码的可能性较低，预估在10%左右。主要风险在于使用者对代码不熟悉，盲目使用带来的潜在风险，以及Telegram API密钥可能存在的风险。

**项目地址:** [Cappricio-Securities/CVE-2021-40438](https://github.com/Cappricio-Securities/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #3

**来源**: [CVE-2021-40438-Kashkovsky_CVE-2021-40438.md](../2021/CVE-2021-40438-Kashkovsky_CVE-2021-40438.md)

## CVE-2021-40438-Apache mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部网络探测、敏感信息泄露，甚至远程代码执行（取决于内部网络配置）

**影响版本:** <= 2.4.48

**利用条件:** 启用mod_proxy模块且配置不当

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 允许攻击者构造恶意的URI路径，使得 Apache 的 mod_proxy 模块将请求转发到攻击者选择的源服务器。这本质上是一个 SSRF 漏洞。

**有效性：**

提供的POC代码（curl 命令）通过 `unix:` 协议指定了一个目标地址，试图将请求转发到 Unix 域套接字。大量重复的 'A' 字符可能用于绕过某些验证或缓冲区大小限制。此方法如果服务器存在相关配置问题，能够成功利用，使服务器向任意地址发起请求。

**投毒风险：**

该仓库主要提供了一个测试此漏洞的PoC，本身并不能直接确定其中是否存在恶意代码。风险点在于仓库可能包含其他隐蔽的、未记录的Payload或脚本，这些Payload会在用户下载和使用时执行恶意操作。经过代码分析，可以判断该仓库存在投毒代码的可能性较低，约为10%，因为主要内容集中在漏洞的演示和利用上，但仍需保持警惕。

**利用方式：**

1.  **确定目标：** 找到运行着 Apache HTTP Server 2.4.48 或更早版本，且启用了 `mod_proxy` 模块的服务器。
2.  **构造恶意请求：** 使用类似于提供的 `curl` 命令，将目标 URL 设置为内部服务、本地文件系统或其他攻击者想要访问的资源。
3.  **发送请求：** 将构造的请求发送到易受攻击的 Apache 服务器。
4.  **利用结果：** 根据攻击目标的不同，可能的攻击结果包括：
    *   **内部网络探测：** 扫描内部网络，查找其他服务。
    *   **敏感信息泄露：** 读取内部服务返回的敏感数据。
    *   **DoS攻击：** 将流量导向内部服务，造成拒绝服务。
    *   **RCE（如果内部服务存在漏洞）：** 如果攻击者可以访问的内部服务存在漏洞（例如，命令注入），则可能实现远程代码执行。

**项目地址:** [Kashkovsky/CVE-2021-40438](https://github.com/Kashkovsky/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #4

**来源**: [CVE-2021-40438-ericmann_apache-cve-poc.md](../2021/CVE-2021-40438-ericmann_apache-cve-poc.md)

## CVE-2021-40438 - Apache mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF (Server Side Request Forgery)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露、内部网络探测、甚至远程代码执行（取决于内部系统的配置）

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了mod_proxy模块，且存在不当配置允许用户控制请求URI路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是 Apache HTTP Server 2.4.48 及之前版本中 mod_proxy 模块的一个 SSRF 漏洞。攻击者可以通过构造恶意的 URI 路径，使 Apache 服务器将请求转发到由攻击者控制的任意服务器。提供的 POC 代码是一个 Dockerized 的环境，用于演示该漏洞。 

**有效性:**
从漏洞库信息和 POC 代码来看，此漏洞是真实存在的，并且已经有公开的利用方式。POC代码提供了一个可复现的环境，有助于验证漏洞。根据CISA的公告，该漏洞已被积极利用。

**投毒风险:**
提供的 POC 代码主要由以下文件组成：
*   `LICENSE`: MIT 许可证，表明作者允许自由使用和修改代码。
*   `README.md`: 简要介绍了 POC 的用途。
*   `docker-compose.yml`: 定义了 PHP 和 Apache 两个服务，通过 Docker 容器来搭建测试环境。
*   `php/Dockerfile`: 定义了 PHP 服务的构建过程，使用 PHP 8.0-cli 镜像，并运行一个简单的 phpinfo() 服务。
*   `php/server.php`: 一个简单的 PHP 文件，用于显示 phpinfo() 信息。
*   `apache/Dockerfile`: 定义了 Apache 服务的构建过程，使用 httpd:2.4.48 镜像，并配置了 httpd.conf 和 vhost.conf 文件。
*   `apache/httpd.conf`: Apache 的主配置文件，用于配置服务器的基本参数。
*   `apache/vhost.conf`: 虚拟主机配置文件，用于配置反向代理规则。

代码中没有明显的恶意代码或后门，但存在一定的风险：
1.  `docker-compose.yml` 文件可能会从 Docker Hub 拉取镜像。如果 Docker Hub 上的官方镜像被篡改，则可能引入恶意代码。
2.  `apache/vhost.conf` 文件的配置决定了反向代理规则。不正确的配置可能会导致其他安全问题，例如开放不必要的端口或暴露敏感信息。 

因此，虽然 POC 代码本身没有明显的投毒，但使用时仍需谨慎，特别是从不受信任的来源获取时。由于代码主要用于演示和复现漏洞，不太可能有隐藏的恶意后门。但是，在实际环境中部署和使用这些代码之前，务必进行代码审计和安全评估。

**利用方式:**
利用方式主要是通过精心构造包含目标服务器地址的URI路径，发送给存在漏洞的Apache服务器。该服务器如果配置了反向代理，会将请求转发到攻击者指定的目标服务器上，从而实现SSRF攻击。具体来说，攻击者可以控制反向代理的目标地址，进而读取内部服务或向内部服务发送恶意请求。


**项目地址:** [ericmann/apache-cve-poc](https://github.com/ericmann/apache-cve-poc)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #5

**来源**: [CVE-2021-40438-gassara-kys_CVE-2021-40438.md](../2021/CVE-2021-40438-gassara-kys_CVE-2021-40438.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部信息泄露、远程命令执行（取决于内部网络配置）

**影响版本:** <= 2.4.48

**利用条件:** mod_proxy 模块启用且存在不安全的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是 Apache HTTP Server 中 mod_proxy 模块的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造特制的 URI 路径，使 mod_proxy 将请求转发到由攻击者控制的源服务器。这允许攻击者访问内部服务、读取敏感数据，或者在某些情况下执行远程代码。

**漏洞利用分析：**

提供的 Dockerfile 使用了 `httpd:2.4.48` 镜像，该版本受此漏洞影响。 `exploit.conf.txt` 文件配置了 Apache 的 `mod_proxy` 模块，并将所有请求代理到 `http://altoromutual.com/`。  关键在于，如果存在配置错误，例如代理规则过于宽松，攻击者可以通过构造包含目标地址的 URI 来绕过代理，从而利用 SSRF 漏洞。`main.sh` 文件通过 `curl` 命令发送包含 `unix:`协议的请求到本地的 Apache 服务器。该漏洞可以通过控制URI路径，让代理将请求转发到任意目标。

**有效性：**

POC代码有效，可以复现该漏洞。如果Apache服务器存在mod_proxy模块并且配置不当，攻击者可以利用该漏洞进行SSRF攻击。

**投毒风险：**

存在一定的投毒风险。虽然主要代码是用于复现 SSRF 漏洞，但 `exploit.conf.txt` 文件中，攻击者可以添加恶意的配置，例如将某些特定请求代理到攻击者的恶意服务器。`main.sh` 文件中可能包含下载和执行恶意脚本的命令，尽管目前提供的文件没有，但存在潜在风险。Dockerfile使用了固定的httpd版本，并COPY了本地文件，相对安全。由于Dockerfile使用官方镜像并且配置相对简单，投毒风险较低。可以增加对altoromutual.com的恶意利用，进行进一步攻击。

**利用方式：**

1.  目标系统必须运行受影响版本的 Apache HTTP Server，且启用了 `mod_proxy` 模块。
2.  需要存在一个不安全的代理配置，允许通过 URI 路径控制请求的目标地址。
3.  攻击者构造包含恶意目标地址的 URI，发送到 Apache 服务器。
4.  Apache 服务器的 `mod_proxy` 模块会将请求转发到攻击者指定的目标地址，从而实现 SSRF。

通过利用此漏洞，攻击者可以扫描内部网络，访问内部服务，或者获取敏感信息。具体能做什么取决于内部网络的配置以及目标服务的安全性。

**项目地址:** [gassara-kys/CVE-2021-40438](https://github.com/gassara-kys/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #6

**来源**: [CVE-2021-40438-n0m-d_CVE-2021-40438-POC.md](../2021/CVE-2021-40438-n0m-d_CVE-2021-40438-POC.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部服务信息泄露、内网扫描甚至远程代码执行 (取决于内部服务的配置)

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用 `mod_proxy` 模块，且配置不当。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-40438 是一个 Apache HTTP Server 2.4.48 及之前版本中 `mod_proxy` 模块的服务器端请求伪造 (SSRF) 漏洞。精心构造的 URI 路径可能导致 `mod_proxy` 将请求转发到由远程用户选择的源服务器。此漏洞允许攻击者强制服务器代表他们向任意内部或外部主机发出请求。  

**漏洞利用方式:**  

提供的 exploit.py 脚本通过构造包含 `unix:{'A'*7000}|{ssrf}` 的恶意 URI 路径来利用该漏洞。  `{'A'*7000}` 可能是为了绕过某些长度检查或缓冲区限制。`{ssrf}` 部分是攻击者想要请求的内部服务的 URL。当 Apache HTTP Server 收到包含此恶意路径的请求时，如果 `mod_proxy` 配置不当，它会将请求转发到攻击者指定的 URL (`ssrf`)，从而导致 SSRF。

**有效性评估:**  

根据漏洞描述和提供的PoC代码，利用的有效性较高，因为CVE已经被CISA收录在Known Exploited Vulnerabilities catalog中。如果目标服务器运行的是受影响的 Apache HTTP Server 版本，并且 `mod_proxy` 模块已启用但配置不当，则此 PoC 可能会成功利用该漏洞。

**投毒风险评估:**  

阅读了提供的exploit.py和README.md文件后,PoC代码本身看起来是直接的 SSRF 漏洞利用，没有发现明显的恶意代码或后门。 该脚本构造一个 HTTP 请求，该请求尝试利用 `mod_proxy` 中的 SSRF 漏洞。没有明显的尝试来安装后门、泄露凭据或执行任何其他恶意活动。

投毒风险评估：0%。

**项目地址:** [n0m-d/CVE-2021-40438-POC](https://github.com/n0m-d/CVE-2021-40438-POC)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #7

**来源**: [CVE-2021-40438-pisut4152_Sigma-Rule-for-CVE-2021-40438-exploitation-attempt.md](../2021/CVE-2021-40438-pisut4152_Sigma-Rule-for-CVE-2021-40438-exploitation-attempt.md)

## CVE-2021-40438 - Apache mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许攻击者控制代理服务器请求的目标，可能导致内部信息泄露、内网服务攻击。

**影响版本:** <= 2.4.48

**利用条件:** 需要启用mod_proxy模块且存在不安全的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-40438 是 Apache HTTP Server 2.4.48 及更早版本中 mod_proxy 模块存在的一个服务器端请求伪造 (SSRF) 漏洞。一个构造好的请求 URI 路径可以导致 mod_proxy 将请求转发到由远程用户选择的源服务器。

**有效性：**
根据漏洞描述，该漏洞允许攻击者指定代理请求的目标地址，因此提供的检测规则基于 `c-uri|contains: '?unix:'` 是合理的。`?unix:` 是一种可能的利用方式，攻击者可以使用 `unix:` 协议访问本地 Unix 域套接字，从而与内部服务进行交互。该检测规则还检测了 `sc-status: 200` 状态码，表示请求已成功转发到目标服务器，并收到了响应。因此，提供的POC代码初步判断有效。

**投毒风险：**
提供的POC代码（YAML格式的Sigma规则）主要用于检测漏洞利用，本身不包含恶意代码或后门。规则定义了检测包含特定字符串（`?unix:`）的URI，用于检测SSRF攻击。虽然规则本身可能存在误报或漏报的风险，但不存在直接的投毒风险。

**利用方式：**
1.  **利用前提：** Apache服务器启用 `mod_proxy` 模块，并且配置不当允许用户控制代理目标。
2.  **构造恶意请求：** 攻击者构造包含目标服务器地址的特殊 URI 路径。例如，使用 `?unix:` 协议访问本地 Unix 域套接字，或者使用 `http://internal-server`访问内部服务器。
3.  **服务器转发请求：** 受影响的 Apache 服务器接收到恶意请求后，`mod_proxy` 模块会将该请求转发到攻击者指定的目标服务器。
4.  **攻击目标：** 攻击者可以利用此漏洞访问内部服务、获取敏感信息或执行其他恶意操作。

**利用示例：**
```
GET /?unix:/path/to/socket|HTTP|1.1
Host: vulnerable-server.com
```
上述请求将尝试通过 Unix 域套接字 `/path/to/socket` 进行连接。

**修复建议：**
*   升级到 Apache HTTP Server 2.4.49 或更高版本。
*   配置 `mod_proxy` 模块，限制允许代理的目标地址。
*   使用防火墙或其他安全措施来保护内部服务。

**项目地址:** [pisut4152/Sigma-Rule-for-CVE-2021-40438-exploitation-attempt](https://github.com/pisut4152/Sigma-Rule-for-CVE-2021-40438-exploitation-attempt)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #8

**来源**: [CVE-2021-40438-sergiovks_CVE-2021-40438-Apache-2.4.48-SSRF-exploit.md](../2021/CVE-2021-40438-sergiovks_CVE-2021-40438-Apache-2.4.48-SSRF-exploit.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server (mod_proxy)

**危害等级:** 高危，可能导致敏感信息泄露、内部服务访问和远程代码执行 (取决于内部服务的配置)

**影响版本:** <= 2.4.48

**利用条件:** Apache HTTP Server启用了mod_proxy模块且配置不当

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是一个存在于 Apache HTTP Server 2.4.48 及更早版本中的 mod_proxy 模块的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过构造特殊的 URI 路径，使得 mod_proxy 将请求转发到由攻击者控制的服务器。 

**有效性：**

根据漏洞信息和漏洞利用代码，该漏洞利用的有效性较高。CISA已将其加入已知被利用的漏洞目录，证明其真实存在且已被实际利用。

**投毒风险：**

提供的漏洞利用代码 `CVE-2021-40438.py` 存在轻微的投毒风险。 代码本身结构简单，主要功能是发送带有特定构造的URL的HTTP请求,尝试利用SSRF漏洞。风险主要在于webhook_url变量, 如果代码的使用者不审查代码，可能将目标服务器的流量引入恶意或受控的webhook。 但代码本身并没有恶意代码,只是参数可以被滥用。因此，投毒风险评估为 10%。

**利用方式：**

1.  **攻击者构造恶意 URI 路径:**  攻击者构建包含目标服务器地址的 URI 路径，例如：`target_url?unix:AAAAAAAAAAAAAAAA...`，其中 `target_url` 是受影响的 Apache 服务器地址，`unix:`  后的字符串用于触发漏洞。
2.  **mod_proxy 转发请求:**  当 Apache 服务器收到包含恶意 URI 路径的请求时，`mod_proxy` 模块会错误地将请求转发到攻击者指定的服务器。
3.  **SSRF 实现:** 通过控制转发的目标服务器，攻击者可以实现 SSRF，从而访问内部服务、读取敏感信息或执行其他恶意操作。例如，攻击者可以将请求转发到内部的 metadata 服务，获取云服务器的凭据。

总体来说，CVE-2021-40438是一个严重的安全漏洞，需要及时进行修复。该漏洞的利用方式相对简单，攻击者可以通过构造恶意URI路径实现SSRF，进而可能造成严重的安全威胁。

**项目地址:** [sergiovks/CVE-2021-40438-Apache-2.4.48-SSRF-exploit](https://github.com/sergiovks/CVE-2021-40438-Apache-2.4.48-SSRF-exploit)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #9

**来源**: [CVE-2021-40438-sixpacksecurity_CVE-2021-40438.md](../2021/CVE-2021-40438-sixpacksecurity_CVE-2021-40438.md)

## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内网信息泄露和任意请求伪造

**影响版本:** <= 2.4.48

**利用条件:** mod_proxy模块启用，且存在不安全的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438是一个存在于Apache HTTP Server 2.4.48及更早版本中的服务器端请求伪造(SSRF)漏洞。攻击者可以通过精心构造的URI路径，使mod_proxy模块将请求转发到由远程用户选择的源服务器，从而实现SSRF攻击。

**有效性：** 根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC是有效的。漏洞库信息明确指出，攻击者可以控制请求转发的目标服务器。提供的Dockerfile和README.md描述了如何使用Docker搭建一个存在漏洞的环境，并使用curl命令发送包含恶意URI的请求，从而触发SSRF。

**投毒风险：** 提供的POC代码主要包含Dockerfile和README.md，以及一个配置文件`exploit.conf.txt`（未提供内容）。Dockerfile用于构建一个包含漏洞的Apache HTTP Server镜像，README.md提供漏洞利用的说明。目前无法得知`exploit.conf.txt`的具体内容，因此不能排除其中包含恶意配置的可能，但是从提供的代码来看投毒的可能性相对较低。考虑到未提供的配置文件的存在，投毒风险评估为10%。

**利用方式：** 该漏洞的利用方式如下：

1.  攻击者构建一个包含恶意URI的HTTP请求。该URI的目标服务器由攻击者控制。例如，`http://localhost:4444/?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...`
2.  攻击者将该请求发送到存在漏洞的Apache HTTP Server。
3.  Apache HTTP Server的mod_proxy模块解析该URI，由于漏洞的存在，它会将请求转发到攻击者指定的服务器。
4.  攻击者可以利用该SSRF漏洞访问内部网络资源，或者发起其他恶意请求。

提供的POC中使用`unix:` 协议，目的是访问Unix域套接字。这表明该漏洞可能被用于攻击本地服务，例如Docker守护程序或其他监听Unix套接字的服务。

**项目地址:** [sixpacksecurity/CVE-2021-40438](https://github.com/sixpacksecurity/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #10

**来源**: [CVE-2021-40438-xiaojiangxl_CVE-2021-40438.md](../2021/CVE-2021-40438-xiaojiangxl_CVE-2021-40438.md)

## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部信息泄露、敏感操作或利用内部服务进行攻击

**影响版本:** <= 2.4.48

**利用条件:** 服务器启用 mod_proxy 模块且配置不当

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-40438 存在于 Apache HTTP Server 的 mod_proxy 模块中。通过构造特制的 URI 路径，攻击者可以欺骗服务器将请求转发到由攻击者控制的源服务器，导致 SSRF 攻击。 

**有效性:** 提供的 POC 代码尝试通过 `unix:` 协议进行 SSRF 攻击。 该 URI 包含大量 'A' 字符，意图可能是触发缓冲区溢出或其他异常情况，以便将请求转发到非预期目标（可能为 Unix Socket）。如果 mod_proxy 没有正确处理 `unix:` 协议或长度限制，则可能成功利用此漏洞。

**投毒风险:** 此 POC 代码的主要功能是尝试利用 SSRF 漏洞，没有发现任何明显的恶意代码或后门植入行为。因此，投毒风险评估为 0%。

**利用方式:**
1.  攻击者发送包含恶意 URI 路径的 HTTP 请求。该 URI 路径以 `unix:` 开头，后跟一个长字符串。
2.  Apache HTTP Server 的 mod_proxy 模块尝试将此请求转发到由 URI 指定的目标。
3.  由于 URI 格式或长度异常，mod_proxy 模块处理出错，导致请求被转发到攻击者指定的服务器，从而触发 SSRF。
4. 攻击者可以利用此 SSRF 漏洞访问内部服务、读取敏感数据或执行其他恶意操作。

**项目地址:** [xiaojiangxl/CVE-2021-40438](https://github.com/xiaojiangxl/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #11

**来源**: [CVE-2021-40438-yakir2b_check-point-gateways-rce.md](../2021/CVE-2021-40438-yakir2b_check-point-gateways-rce.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许攻击者将请求转发到由远程用户选择的源服务器，可能导致敏感信息泄露，内部服务访问，甚至远程代码执行（如果内部服务存在其他漏洞）。

**影响版本:** <= 2.4.48

**利用条件:** 需要目标服务器启用mod_proxy模块且存在ProxyPass配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-40438 是 Apache HTTP Server 中 mod_proxy 模块的一个服务器端请求伪造 (SSRF) 漏洞。通过构造恶意的 URI 路径，攻击者可以诱使服务器将请求转发到攻击者控制的或内部的源服务器。 

**利用方式：**

漏洞利用的关键在于精心构造请求的 URI 路径。攻击者可以利用 `unix:/tmp/xdumps|http://.` 这样的URI，指示`mod_proxy`转发请求到指定URL，造成SSRF。

提供的漏洞利用代码 `check_point_gateways_rce.py` 专门针对 Check Point Security Gateways，利用该 SSRF 漏洞进行远程代码执行。它包含两种利用模式：

1.  `dump`: 尝试从目标服务器转储敏感信息，例如 `expertpwd` (专家模式密码) 或 `installer:last_update_time`。
2.  `reset`: 尝试重置 `admin` 用户的密码。这个模式会生成一个包含新密码哈希值的 payload，并将其发送到目标服务器。该代码中使用了`md5crypt`进行密码hash。
    利用步骤如下：
    *   构造包含重置密码的Payload。
    *   设置请求头 `Content-Type: application/octet-stream` 以绕过某些限制。
    *   将构造的Payload作为请求体发送到目标网关，触发密码重置。
    *   使用新密码通过API接口登录。
    *   执行任意API命令。
    例如，利用 `run-script` API执行任意命令。

**有效性：**

根据漏洞信息和提供的POC代码来看，该漏洞利用是有效的。POC 代码针对特定场景 (Check Point Security Gateways) 进行了优化，利用了该 SSRF 漏洞重置管理员密码，然后通过 API 执行任意命令。

**投毒风险：**

该代码主要利用了`requests`库发送HTTP请求。虽然代码中包含一些自定义函数如`monkey_patch`, `md5crypt`, `randstr`，但它们的实现相对简单，且没有明显的恶意行为。潜在的风险可能在于以下几个方面：

*   `monkey_patch()`：虽然文档中没有具体说明其作用，但猴子补丁可能会修改 `requests` 库的默认行为，如果补丁代码不正确，可能会导致意外的行为或安全问题。需要仔细审查其具体实现，但根据代码推测, 只是为了忽略SSL证书验证问题, 方便测试。
*   依赖项风险：如果依赖的第三方库 (例如 `requests`, `urllib3`) 存在安全漏洞，可能会引入安全风险。

总体来说，直接投毒风险较低，可能存在一些隐蔽性较低的漏洞，概率评估为 **5%**。重点在于审查 `monkey_patch` 函数的具体实现，并确保使用的第三方库是最新版本，以避免潜在的依赖项风险。

**项目地址:** [yakir2b/check-point-gateways-rce](https://github.com/yakir2b/check-point-gateways-rce)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---



---

## POC #6

**来源**: [CVE-2021-40438-n0m-d_CVE-2021-40438-POC.md](../2021/CVE-2021-40438-n0m-d_CVE-2021-40438-POC.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部服务信息泄露、内网扫描甚至远程代码执行 (取决于内部服务的配置)

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用 `mod_proxy` 模块，且配置不当。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-40438 是一个 Apache HTTP Server 2.4.48 及之前版本中 `mod_proxy` 模块的服务器端请求伪造 (SSRF) 漏洞。精心构造的 URI 路径可能导致 `mod_proxy` 将请求转发到由远程用户选择的源服务器。此漏洞允许攻击者强制服务器代表他们向任意内部或外部主机发出请求。  

**漏洞利用方式:**  

提供的 exploit.py 脚本通过构造包含 `unix:{'A'*7000}|{ssrf}` 的恶意 URI 路径来利用该漏洞。  `{'A'*7000}` 可能是为了绕过某些长度检查或缓冲区限制。`{ssrf}` 部分是攻击者想要请求的内部服务的 URL。当 Apache HTTP Server 收到包含此恶意路径的请求时，如果 `mod_proxy` 配置不当，它会将请求转发到攻击者指定的 URL (`ssrf`)，从而导致 SSRF。

**有效性评估:**  

根据漏洞描述和提供的PoC代码，利用的有效性较高，因为CVE已经被CISA收录在Known Exploited Vulnerabilities catalog中。如果目标服务器运行的是受影响的 Apache HTTP Server 版本，并且 `mod_proxy` 模块已启用但配置不当，则此 PoC 可能会成功利用该漏洞。

**投毒风险评估:**  

阅读了提供的exploit.py和README.md文件后,PoC代码本身看起来是直接的 SSRF 漏洞利用，没有发现明显的恶意代码或后门。 该脚本构造一个 HTTP 请求，该请求尝试利用 `mod_proxy` 中的 SSRF 漏洞。没有明显的尝试来安装后门、泄露凭据或执行任何其他恶意活动。

投毒风险评估：0%。

**项目地址:** [n0m-d/CVE-2021-40438-POC](https://github.com/n0m-d/CVE-2021-40438-POC)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #7

**来源**: [CVE-2021-40438-pisut4152_Sigma-Rule-for-CVE-2021-40438-exploitation-attempt.md](../2021/CVE-2021-40438-pisut4152_Sigma-Rule-for-CVE-2021-40438-exploitation-attempt.md)

## CVE-2021-40438 - Apache mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许攻击者控制代理服务器请求的目标，可能导致内部信息泄露、内网服务攻击。

**影响版本:** <= 2.4.48

**利用条件:** 需要启用mod_proxy模块且存在不安全的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-40438 是 Apache HTTP Server 2.4.48 及更早版本中 mod_proxy 模块存在的一个服务器端请求伪造 (SSRF) 漏洞。一个构造好的请求 URI 路径可以导致 mod_proxy 将请求转发到由远程用户选择的源服务器。

**有效性：**
根据漏洞描述，该漏洞允许攻击者指定代理请求的目标地址，因此提供的检测规则基于 `c-uri|contains: '?unix:'` 是合理的。`?unix:` 是一种可能的利用方式，攻击者可以使用 `unix:` 协议访问本地 Unix 域套接字，从而与内部服务进行交互。该检测规则还检测了 `sc-status: 200` 状态码，表示请求已成功转发到目标服务器，并收到了响应。因此，提供的POC代码初步判断有效。

**投毒风险：**
提供的POC代码（YAML格式的Sigma规则）主要用于检测漏洞利用，本身不包含恶意代码或后门。规则定义了检测包含特定字符串（`?unix:`）的URI，用于检测SSRF攻击。虽然规则本身可能存在误报或漏报的风险，但不存在直接的投毒风险。

**利用方式：**
1.  **利用前提：** Apache服务器启用 `mod_proxy` 模块，并且配置不当允许用户控制代理目标。
2.  **构造恶意请求：** 攻击者构造包含目标服务器地址的特殊 URI 路径。例如，使用 `?unix:` 协议访问本地 Unix 域套接字，或者使用 `http://internal-server`访问内部服务器。
3.  **服务器转发请求：** 受影响的 Apache 服务器接收到恶意请求后，`mod_proxy` 模块会将该请求转发到攻击者指定的目标服务器。
4.  **攻击目标：** 攻击者可以利用此漏洞访问内部服务、获取敏感信息或执行其他恶意操作。

**利用示例：**
```
GET /?unix:/path/to/socket|HTTP|1.1
Host: vulnerable-server.com
```
上述请求将尝试通过 Unix 域套接字 `/path/to/socket` 进行连接。

**修复建议：**
*   升级到 Apache HTTP Server 2.4.49 或更高版本。
*   配置 `mod_proxy` 模块，限制允许代理的目标地址。
*   使用防火墙或其他安全措施来保护内部服务。

**项目地址:** [pisut4152/Sigma-Rule-for-CVE-2021-40438-exploitation-attempt](https://github.com/pisut4152/Sigma-Rule-for-CVE-2021-40438-exploitation-attempt)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #8

**来源**: [CVE-2021-40438-sergiovks_CVE-2021-40438-Apache-2.4.48-SSRF-exploit.md](../2021/CVE-2021-40438-sergiovks_CVE-2021-40438-Apache-2.4.48-SSRF-exploit.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server (mod_proxy)

**危害等级:** 高危，可能导致敏感信息泄露、内部服务访问和远程代码执行 (取决于内部服务的配置)

**影响版本:** <= 2.4.48

**利用条件:** Apache HTTP Server启用了mod_proxy模块且配置不当

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是一个存在于 Apache HTTP Server 2.4.48 及更早版本中的 mod_proxy 模块的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过构造特殊的 URI 路径，使得 mod_proxy 将请求转发到由攻击者控制的服务器。 

**有效性：**

根据漏洞信息和漏洞利用代码，该漏洞利用的有效性较高。CISA已将其加入已知被利用的漏洞目录，证明其真实存在且已被实际利用。

**投毒风险：**

提供的漏洞利用代码 `CVE-2021-40438.py` 存在轻微的投毒风险。 代码本身结构简单，主要功能是发送带有特定构造的URL的HTTP请求,尝试利用SSRF漏洞。风险主要在于webhook_url变量, 如果代码的使用者不审查代码，可能将目标服务器的流量引入恶意或受控的webhook。 但代码本身并没有恶意代码,只是参数可以被滥用。因此，投毒风险评估为 10%。

**利用方式：**

1.  **攻击者构造恶意 URI 路径:**  攻击者构建包含目标服务器地址的 URI 路径，例如：`target_url?unix:AAAAAAAAAAAAAAAA...`，其中 `target_url` 是受影响的 Apache 服务器地址，`unix:`  后的字符串用于触发漏洞。
2.  **mod_proxy 转发请求:**  当 Apache 服务器收到包含恶意 URI 路径的请求时，`mod_proxy` 模块会错误地将请求转发到攻击者指定的服务器。
3.  **SSRF 实现:** 通过控制转发的目标服务器，攻击者可以实现 SSRF，从而访问内部服务、读取敏感信息或执行其他恶意操作。例如，攻击者可以将请求转发到内部的 metadata 服务，获取云服务器的凭据。

总体来说，CVE-2021-40438是一个严重的安全漏洞，需要及时进行修复。该漏洞的利用方式相对简单，攻击者可以通过构造恶意URI路径实现SSRF，进而可能造成严重的安全威胁。

**项目地址:** [sergiovks/CVE-2021-40438-Apache-2.4.48-SSRF-exploit](https://github.com/sergiovks/CVE-2021-40438-Apache-2.4.48-SSRF-exploit)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #9

**来源**: [CVE-2021-40438-sixpacksecurity_CVE-2021-40438.md](../2021/CVE-2021-40438-sixpacksecurity_CVE-2021-40438.md)

## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内网信息泄露和任意请求伪造

**影响版本:** <= 2.4.48

**利用条件:** mod_proxy模块启用，且存在不安全的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438是一个存在于Apache HTTP Server 2.4.48及更早版本中的服务器端请求伪造(SSRF)漏洞。攻击者可以通过精心构造的URI路径，使mod_proxy模块将请求转发到由远程用户选择的源服务器，从而实现SSRF攻击。

**有效性：** 根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC是有效的。漏洞库信息明确指出，攻击者可以控制请求转发的目标服务器。提供的Dockerfile和README.md描述了如何使用Docker搭建一个存在漏洞的环境，并使用curl命令发送包含恶意URI的请求，从而触发SSRF。

**投毒风险：** 提供的POC代码主要包含Dockerfile和README.md，以及一个配置文件`exploit.conf.txt`（未提供内容）。Dockerfile用于构建一个包含漏洞的Apache HTTP Server镜像，README.md提供漏洞利用的说明。目前无法得知`exploit.conf.txt`的具体内容，因此不能排除其中包含恶意配置的可能，但是从提供的代码来看投毒的可能性相对较低。考虑到未提供的配置文件的存在，投毒风险评估为10%。

**利用方式：** 该漏洞的利用方式如下：

1.  攻击者构建一个包含恶意URI的HTTP请求。该URI的目标服务器由攻击者控制。例如，`http://localhost:4444/?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...`
2.  攻击者将该请求发送到存在漏洞的Apache HTTP Server。
3.  Apache HTTP Server的mod_proxy模块解析该URI，由于漏洞的存在，它会将请求转发到攻击者指定的服务器。
4.  攻击者可以利用该SSRF漏洞访问内部网络资源，或者发起其他恶意请求。

提供的POC中使用`unix:` 协议，目的是访问Unix域套接字。这表明该漏洞可能被用于攻击本地服务，例如Docker守护程序或其他监听Unix套接字的服务。

**项目地址:** [sixpacksecurity/CVE-2021-40438](https://github.com/sixpacksecurity/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #10

**来源**: [CVE-2021-40438-xiaojiangxl_CVE-2021-40438.md](../2021/CVE-2021-40438-xiaojiangxl_CVE-2021-40438.md)

## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部信息泄露、敏感操作或利用内部服务进行攻击

**影响版本:** <= 2.4.48

**利用条件:** 服务器启用 mod_proxy 模块且配置不当

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-40438 存在于 Apache HTTP Server 的 mod_proxy 模块中。通过构造特制的 URI 路径，攻击者可以欺骗服务器将请求转发到由攻击者控制的源服务器，导致 SSRF 攻击。 

**有效性:** 提供的 POC 代码尝试通过 `unix:` 协议进行 SSRF 攻击。 该 URI 包含大量 'A' 字符，意图可能是触发缓冲区溢出或其他异常情况，以便将请求转发到非预期目标（可能为 Unix Socket）。如果 mod_proxy 没有正确处理 `unix:` 协议或长度限制，则可能成功利用此漏洞。

**投毒风险:** 此 POC 代码的主要功能是尝试利用 SSRF 漏洞，没有发现任何明显的恶意代码或后门植入行为。因此，投毒风险评估为 0%。

**利用方式:**
1.  攻击者发送包含恶意 URI 路径的 HTTP 请求。该 URI 路径以 `unix:` 开头，后跟一个长字符串。
2.  Apache HTTP Server 的 mod_proxy 模块尝试将此请求转发到由 URI 指定的目标。
3.  由于 URI 格式或长度异常，mod_proxy 模块处理出错，导致请求被转发到攻击者指定的服务器，从而触发 SSRF。
4. 攻击者可以利用此 SSRF 漏洞访问内部服务、读取敏感数据或执行其他恶意操作。

**项目地址:** [xiaojiangxl/CVE-2021-40438](https://github.com/xiaojiangxl/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #11

**来源**: [CVE-2021-40438-yakir2b_check-point-gateways-rce.md](../2021/CVE-2021-40438-yakir2b_check-point-gateways-rce.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许攻击者将请求转发到由远程用户选择的源服务器，可能导致敏感信息泄露，内部服务访问，甚至远程代码执行（如果内部服务存在其他漏洞）。

**影响版本:** <= 2.4.48

**利用条件:** 需要目标服务器启用mod_proxy模块且存在ProxyPass配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-40438 是 Apache HTTP Server 中 mod_proxy 模块的一个服务器端请求伪造 (SSRF) 漏洞。通过构造恶意的 URI 路径，攻击者可以诱使服务器将请求转发到攻击者控制的或内部的源服务器。 

**利用方式：**

漏洞利用的关键在于精心构造请求的 URI 路径。攻击者可以利用 `unix:/tmp/xdumps|http://.` 这样的URI，指示`mod_proxy`转发请求到指定URL，造成SSRF。

提供的漏洞利用代码 `check_point_gateways_rce.py` 专门针对 Check Point Security Gateways，利用该 SSRF 漏洞进行远程代码执行。它包含两种利用模式：

1.  `dump`: 尝试从目标服务器转储敏感信息，例如 `expertpwd` (专家模式密码) 或 `installer:last_update_time`。
2.  `reset`: 尝试重置 `admin` 用户的密码。这个模式会生成一个包含新密码哈希值的 payload，并将其发送到目标服务器。该代码中使用了`md5crypt`进行密码hash。
    利用步骤如下：
    *   构造包含重置密码的Payload。
    *   设置请求头 `Content-Type: application/octet-stream` 以绕过某些限制。
    *   将构造的Payload作为请求体发送到目标网关，触发密码重置。
    *   使用新密码通过API接口登录。
    *   执行任意API命令。
    例如，利用 `run-script` API执行任意命令。

**有效性：**

根据漏洞信息和提供的POC代码来看，该漏洞利用是有效的。POC 代码针对特定场景 (Check Point Security Gateways) 进行了优化，利用了该 SSRF 漏洞重置管理员密码，然后通过 API 执行任意命令。

**投毒风险：**

该代码主要利用了`requests`库发送HTTP请求。虽然代码中包含一些自定义函数如`monkey_patch`, `md5crypt`, `randstr`，但它们的实现相对简单，且没有明显的恶意行为。潜在的风险可能在于以下几个方面：

*   `monkey_patch()`：虽然文档中没有具体说明其作用，但猴子补丁可能会修改 `requests` 库的默认行为，如果补丁代码不正确，可能会导致意外的行为或安全问题。需要仔细审查其具体实现，但根据代码推测, 只是为了忽略SSL证书验证问题, 方便测试。
*   依赖项风险：如果依赖的第三方库 (例如 `requests`, `urllib3`) 存在安全漏洞，可能会引入安全风险。

总体来说，直接投毒风险较低，可能存在一些隐蔽性较低的漏洞，概率评估为 **5%**。重点在于审查 `monkey_patch` 函数的具体实现，并确保使用的第三方库是最新版本，以避免潜在的依赖项风险。

**项目地址:** [yakir2b/check-point-gateways-rce](https://github.com/yakir2b/check-point-gateways-rce)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---



---

## POC #6

**来源**: [CVE-2021-40438-n0m-d_CVE-2021-40438-POC.md](../2021/CVE-2021-40438-n0m-d_CVE-2021-40438-POC.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部服务信息泄露、内网扫描甚至远程代码执行 (取决于内部服务的配置)

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用 `mod_proxy` 模块，且配置不当。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-40438 是一个 Apache HTTP Server 2.4.48 及之前版本中 `mod_proxy` 模块的服务器端请求伪造 (SSRF) 漏洞。精心构造的 URI 路径可能导致 `mod_proxy` 将请求转发到由远程用户选择的源服务器。此漏洞允许攻击者强制服务器代表他们向任意内部或外部主机发出请求。  

**漏洞利用方式:**  

提供的 exploit.py 脚本通过构造包含 `unix:{'A'*7000}|{ssrf}` 的恶意 URI 路径来利用该漏洞。  `{'A'*7000}` 可能是为了绕过某些长度检查或缓冲区限制。`{ssrf}` 部分是攻击者想要请求的内部服务的 URL。当 Apache HTTP Server 收到包含此恶意路径的请求时，如果 `mod_proxy` 配置不当，它会将请求转发到攻击者指定的 URL (`ssrf`)，从而导致 SSRF。

**有效性评估:**  

根据漏洞描述和提供的PoC代码，利用的有效性较高，因为CVE已经被CISA收录在Known Exploited Vulnerabilities catalog中。如果目标服务器运行的是受影响的 Apache HTTP Server 版本，并且 `mod_proxy` 模块已启用但配置不当，则此 PoC 可能会成功利用该漏洞。

**投毒风险评估:**  

阅读了提供的exploit.py和README.md文件后,PoC代码本身看起来是直接的 SSRF 漏洞利用，没有发现明显的恶意代码或后门。 该脚本构造一个 HTTP 请求，该请求尝试利用 `mod_proxy` 中的 SSRF 漏洞。没有明显的尝试来安装后门、泄露凭据或执行任何其他恶意活动。

投毒风险评估：0%。

**项目地址:** [n0m-d/CVE-2021-40438-POC](https://github.com/n0m-d/CVE-2021-40438-POC)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #7

**来源**: [CVE-2021-40438-pisut4152_Sigma-Rule-for-CVE-2021-40438-exploitation-attempt.md](../2021/CVE-2021-40438-pisut4152_Sigma-Rule-for-CVE-2021-40438-exploitation-attempt.md)

## CVE-2021-40438 - Apache mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许攻击者控制代理服务器请求的目标，可能导致内部信息泄露、内网服务攻击。

**影响版本:** <= 2.4.48

**利用条件:** 需要启用mod_proxy模块且存在不安全的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-40438 是 Apache HTTP Server 2.4.48 及更早版本中 mod_proxy 模块存在的一个服务器端请求伪造 (SSRF) 漏洞。一个构造好的请求 URI 路径可以导致 mod_proxy 将请求转发到由远程用户选择的源服务器。

**有效性：**
根据漏洞描述，该漏洞允许攻击者指定代理请求的目标地址，因此提供的检测规则基于 `c-uri|contains: '?unix:'` 是合理的。`?unix:` 是一种可能的利用方式，攻击者可以使用 `unix:` 协议访问本地 Unix 域套接字，从而与内部服务进行交互。该检测规则还检测了 `sc-status: 200` 状态码，表示请求已成功转发到目标服务器，并收到了响应。因此，提供的POC代码初步判断有效。

**投毒风险：**
提供的POC代码（YAML格式的Sigma规则）主要用于检测漏洞利用，本身不包含恶意代码或后门。规则定义了检测包含特定字符串（`?unix:`）的URI，用于检测SSRF攻击。虽然规则本身可能存在误报或漏报的风险，但不存在直接的投毒风险。

**利用方式：**
1.  **利用前提：** Apache服务器启用 `mod_proxy` 模块，并且配置不当允许用户控制代理目标。
2.  **构造恶意请求：** 攻击者构造包含目标服务器地址的特殊 URI 路径。例如，使用 `?unix:` 协议访问本地 Unix 域套接字，或者使用 `http://internal-server`访问内部服务器。
3.  **服务器转发请求：** 受影响的 Apache 服务器接收到恶意请求后，`mod_proxy` 模块会将该请求转发到攻击者指定的目标服务器。
4.  **攻击目标：** 攻击者可以利用此漏洞访问内部服务、获取敏感信息或执行其他恶意操作。

**利用示例：**
```
GET /?unix:/path/to/socket|HTTP|1.1
Host: vulnerable-server.com
```
上述请求将尝试通过 Unix 域套接字 `/path/to/socket` 进行连接。

**修复建议：**
*   升级到 Apache HTTP Server 2.4.49 或更高版本。
*   配置 `mod_proxy` 模块，限制允许代理的目标地址。
*   使用防火墙或其他安全措施来保护内部服务。

**项目地址:** [pisut4152/Sigma-Rule-for-CVE-2021-40438-exploitation-attempt](https://github.com/pisut4152/Sigma-Rule-for-CVE-2021-40438-exploitation-attempt)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #8

**来源**: [CVE-2021-40438-sergiovks_CVE-2021-40438-Apache-2.4.48-SSRF-exploit.md](../2021/CVE-2021-40438-sergiovks_CVE-2021-40438-Apache-2.4.48-SSRF-exploit.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server (mod_proxy)

**危害等级:** 高危，可能导致敏感信息泄露、内部服务访问和远程代码执行 (取决于内部服务的配置)

**影响版本:** <= 2.4.48

**利用条件:** Apache HTTP Server启用了mod_proxy模块且配置不当

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是一个存在于 Apache HTTP Server 2.4.48 及更早版本中的 mod_proxy 模块的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过构造特殊的 URI 路径，使得 mod_proxy 将请求转发到由攻击者控制的服务器。 

**有效性：**

根据漏洞信息和漏洞利用代码，该漏洞利用的有效性较高。CISA已将其加入已知被利用的漏洞目录，证明其真实存在且已被实际利用。

**投毒风险：**

提供的漏洞利用代码 `CVE-2021-40438.py` 存在轻微的投毒风险。 代码本身结构简单，主要功能是发送带有特定构造的URL的HTTP请求,尝试利用SSRF漏洞。风险主要在于webhook_url变量, 如果代码的使用者不审查代码，可能将目标服务器的流量引入恶意或受控的webhook。 但代码本身并没有恶意代码,只是参数可以被滥用。因此，投毒风险评估为 10%。

**利用方式：**

1.  **攻击者构造恶意 URI 路径:**  攻击者构建包含目标服务器地址的 URI 路径，例如：`target_url?unix:AAAAAAAAAAAAAAAA...`，其中 `target_url` 是受影响的 Apache 服务器地址，`unix:`  后的字符串用于触发漏洞。
2.  **mod_proxy 转发请求:**  当 Apache 服务器收到包含恶意 URI 路径的请求时，`mod_proxy` 模块会错误地将请求转发到攻击者指定的服务器。
3.  **SSRF 实现:** 通过控制转发的目标服务器，攻击者可以实现 SSRF，从而访问内部服务、读取敏感信息或执行其他恶意操作。例如，攻击者可以将请求转发到内部的 metadata 服务，获取云服务器的凭据。

总体来说，CVE-2021-40438是一个严重的安全漏洞，需要及时进行修复。该漏洞的利用方式相对简单，攻击者可以通过构造恶意URI路径实现SSRF，进而可能造成严重的安全威胁。

**项目地址:** [sergiovks/CVE-2021-40438-Apache-2.4.48-SSRF-exploit](https://github.com/sergiovks/CVE-2021-40438-Apache-2.4.48-SSRF-exploit)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #9

**来源**: [CVE-2021-40438-sixpacksecurity_CVE-2021-40438.md](../2021/CVE-2021-40438-sixpacksecurity_CVE-2021-40438.md)

## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内网信息泄露和任意请求伪造

**影响版本:** <= 2.4.48

**利用条件:** mod_proxy模块启用，且存在不安全的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438是一个存在于Apache HTTP Server 2.4.48及更早版本中的服务器端请求伪造(SSRF)漏洞。攻击者可以通过精心构造的URI路径，使mod_proxy模块将请求转发到由远程用户选择的源服务器，从而实现SSRF攻击。

**有效性：** 根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC是有效的。漏洞库信息明确指出，攻击者可以控制请求转发的目标服务器。提供的Dockerfile和README.md描述了如何使用Docker搭建一个存在漏洞的环境，并使用curl命令发送包含恶意URI的请求，从而触发SSRF。

**投毒风险：** 提供的POC代码主要包含Dockerfile和README.md，以及一个配置文件`exploit.conf.txt`（未提供内容）。Dockerfile用于构建一个包含漏洞的Apache HTTP Server镜像，README.md提供漏洞利用的说明。目前无法得知`exploit.conf.txt`的具体内容，因此不能排除其中包含恶意配置的可能，但是从提供的代码来看投毒的可能性相对较低。考虑到未提供的配置文件的存在，投毒风险评估为10%。

**利用方式：** 该漏洞的利用方式如下：

1.  攻击者构建一个包含恶意URI的HTTP请求。该URI的目标服务器由攻击者控制。例如，`http://localhost:4444/?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...`
2.  攻击者将该请求发送到存在漏洞的Apache HTTP Server。
3.  Apache HTTP Server的mod_proxy模块解析该URI，由于漏洞的存在，它会将请求转发到攻击者指定的服务器。
4.  攻击者可以利用该SSRF漏洞访问内部网络资源，或者发起其他恶意请求。

提供的POC中使用`unix:` 协议，目的是访问Unix域套接字。这表明该漏洞可能被用于攻击本地服务，例如Docker守护程序或其他监听Unix套接字的服务。

**项目地址:** [sixpacksecurity/CVE-2021-40438](https://github.com/sixpacksecurity/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #10

**来源**: [CVE-2021-40438-xiaojiangxl_CVE-2021-40438.md](../2021/CVE-2021-40438-xiaojiangxl_CVE-2021-40438.md)

## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部信息泄露、敏感操作或利用内部服务进行攻击

**影响版本:** <= 2.4.48

**利用条件:** 服务器启用 mod_proxy 模块且配置不当

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-40438 存在于 Apache HTTP Server 的 mod_proxy 模块中。通过构造特制的 URI 路径，攻击者可以欺骗服务器将请求转发到由攻击者控制的源服务器，导致 SSRF 攻击。 

**有效性:** 提供的 POC 代码尝试通过 `unix:` 协议进行 SSRF 攻击。 该 URI 包含大量 'A' 字符，意图可能是触发缓冲区溢出或其他异常情况，以便将请求转发到非预期目标（可能为 Unix Socket）。如果 mod_proxy 没有正确处理 `unix:` 协议或长度限制，则可能成功利用此漏洞。

**投毒风险:** 此 POC 代码的主要功能是尝试利用 SSRF 漏洞，没有发现任何明显的恶意代码或后门植入行为。因此，投毒风险评估为 0%。

**利用方式:**
1.  攻击者发送包含恶意 URI 路径的 HTTP 请求。该 URI 路径以 `unix:` 开头，后跟一个长字符串。
2.  Apache HTTP Server 的 mod_proxy 模块尝试将此请求转发到由 URI 指定的目标。
3.  由于 URI 格式或长度异常，mod_proxy 模块处理出错，导致请求被转发到攻击者指定的服务器，从而触发 SSRF。
4. 攻击者可以利用此 SSRF 漏洞访问内部服务、读取敏感数据或执行其他恶意操作。

**项目地址:** [xiaojiangxl/CVE-2021-40438](https://github.com/xiaojiangxl/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #11

**来源**: [CVE-2021-40438-yakir2b_check-point-gateways-rce.md](../2021/CVE-2021-40438-yakir2b_check-point-gateways-rce.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许攻击者将请求转发到由远程用户选择的源服务器，可能导致敏感信息泄露，内部服务访问，甚至远程代码执行（如果内部服务存在其他漏洞）。

**影响版本:** <= 2.4.48

**利用条件:** 需要目标服务器启用mod_proxy模块且存在ProxyPass配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-40438 是 Apache HTTP Server 中 mod_proxy 模块的一个服务器端请求伪造 (SSRF) 漏洞。通过构造恶意的 URI 路径，攻击者可以诱使服务器将请求转发到攻击者控制的或内部的源服务器。 

**利用方式：**

漏洞利用的关键在于精心构造请求的 URI 路径。攻击者可以利用 `unix:/tmp/xdumps|http://.` 这样的URI，指示`mod_proxy`转发请求到指定URL，造成SSRF。

提供的漏洞利用代码 `check_point_gateways_rce.py` 专门针对 Check Point Security Gateways，利用该 SSRF 漏洞进行远程代码执行。它包含两种利用模式：

1.  `dump`: 尝试从目标服务器转储敏感信息，例如 `expertpwd` (专家模式密码) 或 `installer:last_update_time`。
2.  `reset`: 尝试重置 `admin` 用户的密码。这个模式会生成一个包含新密码哈希值的 payload，并将其发送到目标服务器。该代码中使用了`md5crypt`进行密码hash。
    利用步骤如下：
    *   构造包含重置密码的Payload。
    *   设置请求头 `Content-Type: application/octet-stream` 以绕过某些限制。
    *   将构造的Payload作为请求体发送到目标网关，触发密码重置。
    *   使用新密码通过API接口登录。
    *   执行任意API命令。
    例如，利用 `run-script` API执行任意命令。

**有效性：**

根据漏洞信息和提供的POC代码来看，该漏洞利用是有效的。POC 代码针对特定场景 (Check Point Security Gateways) 进行了优化，利用了该 SSRF 漏洞重置管理员密码，然后通过 API 执行任意命令。

**投毒风险：**

该代码主要利用了`requests`库发送HTTP请求。虽然代码中包含一些自定义函数如`monkey_patch`, `md5crypt`, `randstr`，但它们的实现相对简单，且没有明显的恶意行为。潜在的风险可能在于以下几个方面：

*   `monkey_patch()`：虽然文档中没有具体说明其作用，但猴子补丁可能会修改 `requests` 库的默认行为，如果补丁代码不正确，可能会导致意外的行为或安全问题。需要仔细审查其具体实现，但根据代码推测, 只是为了忽略SSL证书验证问题, 方便测试。
*   依赖项风险：如果依赖的第三方库 (例如 `requests`, `urllib3`) 存在安全漏洞，可能会引入安全风险。

总体来说，直接投毒风险较低，可能存在一些隐蔽性较低的漏洞，概率评估为 **5%**。重点在于审查 `monkey_patch` 函数的具体实现，并确保使用的第三方库是最新版本，以避免潜在的依赖项风险。

**项目地址:** [yakir2b/check-point-gateways-rce](https://github.com/yakir2b/check-point-gateways-rce)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---



---

## POC #6

**来源**: [CVE-2021-40438-n0m-d_CVE-2021-40438-POC.md](../2021/CVE-2021-40438-n0m-d_CVE-2021-40438-POC.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部服务信息泄露、内网扫描甚至远程代码执行 (取决于内部服务的配置)

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用 `mod_proxy` 模块，且配置不当。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-40438 是一个 Apache HTTP Server 2.4.48 及之前版本中 `mod_proxy` 模块的服务器端请求伪造 (SSRF) 漏洞。精心构造的 URI 路径可能导致 `mod_proxy` 将请求转发到由远程用户选择的源服务器。此漏洞允许攻击者强制服务器代表他们向任意内部或外部主机发出请求。  

**漏洞利用方式:**  

提供的 exploit.py 脚本通过构造包含 `unix:{'A'*7000}|{ssrf}` 的恶意 URI 路径来利用该漏洞。  `{'A'*7000}` 可能是为了绕过某些长度检查或缓冲区限制。`{ssrf}` 部分是攻击者想要请求的内部服务的 URL。当 Apache HTTP Server 收到包含此恶意路径的请求时，如果 `mod_proxy` 配置不当，它会将请求转发到攻击者指定的 URL (`ssrf`)，从而导致 SSRF。

**有效性评估:**  

根据漏洞描述和提供的PoC代码，利用的有效性较高，因为CVE已经被CISA收录在Known Exploited Vulnerabilities catalog中。如果目标服务器运行的是受影响的 Apache HTTP Server 版本，并且 `mod_proxy` 模块已启用但配置不当，则此 PoC 可能会成功利用该漏洞。

**投毒风险评估:**  

阅读了提供的exploit.py和README.md文件后,PoC代码本身看起来是直接的 SSRF 漏洞利用，没有发现明显的恶意代码或后门。 该脚本构造一个 HTTP 请求，该请求尝试利用 `mod_proxy` 中的 SSRF 漏洞。没有明显的尝试来安装后门、泄露凭据或执行任何其他恶意活动。

投毒风险评估：0%。

**项目地址:** [n0m-d/CVE-2021-40438-POC](https://github.com/n0m-d/CVE-2021-40438-POC)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #7

**来源**: [CVE-2021-40438-pisut4152_Sigma-Rule-for-CVE-2021-40438-exploitation-attempt.md](../2021/CVE-2021-40438-pisut4152_Sigma-Rule-for-CVE-2021-40438-exploitation-attempt.md)

## CVE-2021-40438 - Apache mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许攻击者控制代理服务器请求的目标，可能导致内部信息泄露、内网服务攻击。

**影响版本:** <= 2.4.48

**利用条件:** 需要启用mod_proxy模块且存在不安全的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-40438 是 Apache HTTP Server 2.4.48 及更早版本中 mod_proxy 模块存在的一个服务器端请求伪造 (SSRF) 漏洞。一个构造好的请求 URI 路径可以导致 mod_proxy 将请求转发到由远程用户选择的源服务器。

**有效性：**
根据漏洞描述，该漏洞允许攻击者指定代理请求的目标地址，因此提供的检测规则基于 `c-uri|contains: '?unix:'` 是合理的。`?unix:` 是一种可能的利用方式，攻击者可以使用 `unix:` 协议访问本地 Unix 域套接字，从而与内部服务进行交互。该检测规则还检测了 `sc-status: 200` 状态码，表示请求已成功转发到目标服务器，并收到了响应。因此，提供的POC代码初步判断有效。

**投毒风险：**
提供的POC代码（YAML格式的Sigma规则）主要用于检测漏洞利用，本身不包含恶意代码或后门。规则定义了检测包含特定字符串（`?unix:`）的URI，用于检测SSRF攻击。虽然规则本身可能存在误报或漏报的风险，但不存在直接的投毒风险。

**利用方式：**
1.  **利用前提：** Apache服务器启用 `mod_proxy` 模块，并且配置不当允许用户控制代理目标。
2.  **构造恶意请求：** 攻击者构造包含目标服务器地址的特殊 URI 路径。例如，使用 `?unix:` 协议访问本地 Unix 域套接字，或者使用 `http://internal-server`访问内部服务器。
3.  **服务器转发请求：** 受影响的 Apache 服务器接收到恶意请求后，`mod_proxy` 模块会将该请求转发到攻击者指定的目标服务器。
4.  **攻击目标：** 攻击者可以利用此漏洞访问内部服务、获取敏感信息或执行其他恶意操作。

**利用示例：**
```
GET /?unix:/path/to/socket|HTTP|1.1
Host: vulnerable-server.com
```
上述请求将尝试通过 Unix 域套接字 `/path/to/socket` 进行连接。

**修复建议：**
*   升级到 Apache HTTP Server 2.4.49 或更高版本。
*   配置 `mod_proxy` 模块，限制允许代理的目标地址。
*   使用防火墙或其他安全措施来保护内部服务。

**项目地址:** [pisut4152/Sigma-Rule-for-CVE-2021-40438-exploitation-attempt](https://github.com/pisut4152/Sigma-Rule-for-CVE-2021-40438-exploitation-attempt)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #8

**来源**: [CVE-2021-40438-sergiovks_CVE-2021-40438-Apache-2.4.48-SSRF-exploit.md](../2021/CVE-2021-40438-sergiovks_CVE-2021-40438-Apache-2.4.48-SSRF-exploit.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server (mod_proxy)

**危害等级:** 高危，可能导致敏感信息泄露、内部服务访问和远程代码执行 (取决于内部服务的配置)

**影响版本:** <= 2.4.48

**利用条件:** Apache HTTP Server启用了mod_proxy模块且配置不当

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是一个存在于 Apache HTTP Server 2.4.48 及更早版本中的 mod_proxy 模块的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过构造特殊的 URI 路径，使得 mod_proxy 将请求转发到由攻击者控制的服务器。 

**有效性：**

根据漏洞信息和漏洞利用代码，该漏洞利用的有效性较高。CISA已将其加入已知被利用的漏洞目录，证明其真实存在且已被实际利用。

**投毒风险：**

提供的漏洞利用代码 `CVE-2021-40438.py` 存在轻微的投毒风险。 代码本身结构简单，主要功能是发送带有特定构造的URL的HTTP请求,尝试利用SSRF漏洞。风险主要在于webhook_url变量, 如果代码的使用者不审查代码，可能将目标服务器的流量引入恶意或受控的webhook。 但代码本身并没有恶意代码,只是参数可以被滥用。因此，投毒风险评估为 10%。

**利用方式：**

1.  **攻击者构造恶意 URI 路径:**  攻击者构建包含目标服务器地址的 URI 路径，例如：`target_url?unix:AAAAAAAAAAAAAAAA...`，其中 `target_url` 是受影响的 Apache 服务器地址，`unix:`  后的字符串用于触发漏洞。
2.  **mod_proxy 转发请求:**  当 Apache 服务器收到包含恶意 URI 路径的请求时，`mod_proxy` 模块会错误地将请求转发到攻击者指定的服务器。
3.  **SSRF 实现:** 通过控制转发的目标服务器，攻击者可以实现 SSRF，从而访问内部服务、读取敏感信息或执行其他恶意操作。例如，攻击者可以将请求转发到内部的 metadata 服务，获取云服务器的凭据。

总体来说，CVE-2021-40438是一个严重的安全漏洞，需要及时进行修复。该漏洞的利用方式相对简单，攻击者可以通过构造恶意URI路径实现SSRF，进而可能造成严重的安全威胁。

**项目地址:** [sergiovks/CVE-2021-40438-Apache-2.4.48-SSRF-exploit](https://github.com/sergiovks/CVE-2021-40438-Apache-2.4.48-SSRF-exploit)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #9

**来源**: [CVE-2021-40438-sixpacksecurity_CVE-2021-40438.md](../2021/CVE-2021-40438-sixpacksecurity_CVE-2021-40438.md)

## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内网信息泄露和任意请求伪造

**影响版本:** <= 2.4.48

**利用条件:** mod_proxy模块启用，且存在不安全的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438是一个存在于Apache HTTP Server 2.4.48及更早版本中的服务器端请求伪造(SSRF)漏洞。攻击者可以通过精心构造的URI路径，使mod_proxy模块将请求转发到由远程用户选择的源服务器，从而实现SSRF攻击。

**有效性：** 根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC是有效的。漏洞库信息明确指出，攻击者可以控制请求转发的目标服务器。提供的Dockerfile和README.md描述了如何使用Docker搭建一个存在漏洞的环境，并使用curl命令发送包含恶意URI的请求，从而触发SSRF。

**投毒风险：** 提供的POC代码主要包含Dockerfile和README.md，以及一个配置文件`exploit.conf.txt`（未提供内容）。Dockerfile用于构建一个包含漏洞的Apache HTTP Server镜像，README.md提供漏洞利用的说明。目前无法得知`exploit.conf.txt`的具体内容，因此不能排除其中包含恶意配置的可能，但是从提供的代码来看投毒的可能性相对较低。考虑到未提供的配置文件的存在，投毒风险评估为10%。

**利用方式：** 该漏洞的利用方式如下：

1.  攻击者构建一个包含恶意URI的HTTP请求。该URI的目标服务器由攻击者控制。例如，`http://localhost:4444/?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...`
2.  攻击者将该请求发送到存在漏洞的Apache HTTP Server。
3.  Apache HTTP Server的mod_proxy模块解析该URI，由于漏洞的存在，它会将请求转发到攻击者指定的服务器。
4.  攻击者可以利用该SSRF漏洞访问内部网络资源，或者发起其他恶意请求。

提供的POC中使用`unix:` 协议，目的是访问Unix域套接字。这表明该漏洞可能被用于攻击本地服务，例如Docker守护程序或其他监听Unix套接字的服务。

**项目地址:** [sixpacksecurity/CVE-2021-40438](https://github.com/sixpacksecurity/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #10

**来源**: [CVE-2021-40438-xiaojiangxl_CVE-2021-40438.md](../2021/CVE-2021-40438-xiaojiangxl_CVE-2021-40438.md)

## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部信息泄露、敏感操作或利用内部服务进行攻击

**影响版本:** <= 2.4.48

**利用条件:** 服务器启用 mod_proxy 模块且配置不当

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-40438 存在于 Apache HTTP Server 的 mod_proxy 模块中。通过构造特制的 URI 路径，攻击者可以欺骗服务器将请求转发到由攻击者控制的源服务器，导致 SSRF 攻击。 

**有效性:** 提供的 POC 代码尝试通过 `unix:` 协议进行 SSRF 攻击。 该 URI 包含大量 'A' 字符，意图可能是触发缓冲区溢出或其他异常情况，以便将请求转发到非预期目标（可能为 Unix Socket）。如果 mod_proxy 没有正确处理 `unix:` 协议或长度限制，则可能成功利用此漏洞。

**投毒风险:** 此 POC 代码的主要功能是尝试利用 SSRF 漏洞，没有发现任何明显的恶意代码或后门植入行为。因此，投毒风险评估为 0%。

**利用方式:**
1.  攻击者发送包含恶意 URI 路径的 HTTP 请求。该 URI 路径以 `unix:` 开头，后跟一个长字符串。
2.  Apache HTTP Server 的 mod_proxy 模块尝试将此请求转发到由 URI 指定的目标。
3.  由于 URI 格式或长度异常，mod_proxy 模块处理出错，导致请求被转发到攻击者指定的服务器，从而触发 SSRF。
4. 攻击者可以利用此 SSRF 漏洞访问内部服务、读取敏感数据或执行其他恶意操作。

**项目地址:** [xiaojiangxl/CVE-2021-40438](https://github.com/xiaojiangxl/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #11

**来源**: [CVE-2021-40438-yakir2b_check-point-gateways-rce.md](../2021/CVE-2021-40438-yakir2b_check-point-gateways-rce.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许攻击者将请求转发到由远程用户选择的源服务器，可能导致敏感信息泄露，内部服务访问，甚至远程代码执行（如果内部服务存在其他漏洞）。

**影响版本:** <= 2.4.48

**利用条件:** 需要目标服务器启用mod_proxy模块且存在ProxyPass配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-40438 是 Apache HTTP Server 中 mod_proxy 模块的一个服务器端请求伪造 (SSRF) 漏洞。通过构造恶意的 URI 路径，攻击者可以诱使服务器将请求转发到攻击者控制的或内部的源服务器。 

**利用方式：**

漏洞利用的关键在于精心构造请求的 URI 路径。攻击者可以利用 `unix:/tmp/xdumps|http://.` 这样的URI，指示`mod_proxy`转发请求到指定URL，造成SSRF。

提供的漏洞利用代码 `check_point_gateways_rce.py` 专门针对 Check Point Security Gateways，利用该 SSRF 漏洞进行远程代码执行。它包含两种利用模式：

1.  `dump`: 尝试从目标服务器转储敏感信息，例如 `expertpwd` (专家模式密码) 或 `installer:last_update_time`。
2.  `reset`: 尝试重置 `admin` 用户的密码。这个模式会生成一个包含新密码哈希值的 payload，并将其发送到目标服务器。该代码中使用了`md5crypt`进行密码hash。
    利用步骤如下：
    *   构造包含重置密码的Payload。
    *   设置请求头 `Content-Type: application/octet-stream` 以绕过某些限制。
    *   将构造的Payload作为请求体发送到目标网关，触发密码重置。
    *   使用新密码通过API接口登录。
    *   执行任意API命令。
    例如，利用 `run-script` API执行任意命令。

**有效性：**

根据漏洞信息和提供的POC代码来看，该漏洞利用是有效的。POC 代码针对特定场景 (Check Point Security Gateways) 进行了优化，利用了该 SSRF 漏洞重置管理员密码，然后通过 API 执行任意命令。

**投毒风险：**

该代码主要利用了`requests`库发送HTTP请求。虽然代码中包含一些自定义函数如`monkey_patch`, `md5crypt`, `randstr`，但它们的实现相对简单，且没有明显的恶意行为。潜在的风险可能在于以下几个方面：

*   `monkey_patch()`：虽然文档中没有具体说明其作用，但猴子补丁可能会修改 `requests` 库的默认行为，如果补丁代码不正确，可能会导致意外的行为或安全问题。需要仔细审查其具体实现，但根据代码推测, 只是为了忽略SSL证书验证问题, 方便测试。
*   依赖项风险：如果依赖的第三方库 (例如 `requests`, `urllib3`) 存在安全漏洞，可能会引入安全风险。

总体来说，直接投毒风险较低，可能存在一些隐蔽性较低的漏洞，概率评估为 **5%**。重点在于审查 `monkey_patch` 函数的具体实现，并确保使用的第三方库是最新版本，以避免潜在的依赖项风险。

**项目地址:** [yakir2b/check-point-gateways-rce](https://github.com/yakir2b/check-point-gateways-rce)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---



---

## POC #6

**来源**: [CVE-2021-40438-n0m-d_CVE-2021-40438-POC.md](../2021/CVE-2021-40438-n0m-d_CVE-2021-40438-POC.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部服务信息泄露、内网扫描甚至远程代码执行 (取决于内部服务的配置)

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用 `mod_proxy` 模块，且配置不当。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-40438 是一个 Apache HTTP Server 2.4.48 及之前版本中 `mod_proxy` 模块的服务器端请求伪造 (SSRF) 漏洞。精心构造的 URI 路径可能导致 `mod_proxy` 将请求转发到由远程用户选择的源服务器。此漏洞允许攻击者强制服务器代表他们向任意内部或外部主机发出请求。  

**漏洞利用方式:**  

提供的 exploit.py 脚本通过构造包含 `unix:{'A'*7000}|{ssrf}` 的恶意 URI 路径来利用该漏洞。  `{'A'*7000}` 可能是为了绕过某些长度检查或缓冲区限制。`{ssrf}` 部分是攻击者想要请求的内部服务的 URL。当 Apache HTTP Server 收到包含此恶意路径的请求时，如果 `mod_proxy` 配置不当，它会将请求转发到攻击者指定的 URL (`ssrf`)，从而导致 SSRF。

**有效性评估:**  

根据漏洞描述和提供的PoC代码，利用的有效性较高，因为CVE已经被CISA收录在Known Exploited Vulnerabilities catalog中。如果目标服务器运行的是受影响的 Apache HTTP Server 版本，并且 `mod_proxy` 模块已启用但配置不当，则此 PoC 可能会成功利用该漏洞。

**投毒风险评估:**  

阅读了提供的exploit.py和README.md文件后,PoC代码本身看起来是直接的 SSRF 漏洞利用，没有发现明显的恶意代码或后门。 该脚本构造一个 HTTP 请求，该请求尝试利用 `mod_proxy` 中的 SSRF 漏洞。没有明显的尝试来安装后门、泄露凭据或执行任何其他恶意活动。

投毒风险评估：0%。

**项目地址:** [n0m-d/CVE-2021-40438-POC](https://github.com/n0m-d/CVE-2021-40438-POC)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #7

**来源**: [CVE-2021-40438-pisut4152_Sigma-Rule-for-CVE-2021-40438-exploitation-attempt.md](../2021/CVE-2021-40438-pisut4152_Sigma-Rule-for-CVE-2021-40438-exploitation-attempt.md)

## CVE-2021-40438 - Apache mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许攻击者控制代理服务器请求的目标，可能导致内部信息泄露、内网服务攻击。

**影响版本:** <= 2.4.48

**利用条件:** 需要启用mod_proxy模块且存在不安全的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-40438 是 Apache HTTP Server 2.4.48 及更早版本中 mod_proxy 模块存在的一个服务器端请求伪造 (SSRF) 漏洞。一个构造好的请求 URI 路径可以导致 mod_proxy 将请求转发到由远程用户选择的源服务器。

**有效性：**
根据漏洞描述，该漏洞允许攻击者指定代理请求的目标地址，因此提供的检测规则基于 `c-uri|contains: '?unix:'` 是合理的。`?unix:` 是一种可能的利用方式，攻击者可以使用 `unix:` 协议访问本地 Unix 域套接字，从而与内部服务进行交互。该检测规则还检测了 `sc-status: 200` 状态码，表示请求已成功转发到目标服务器，并收到了响应。因此，提供的POC代码初步判断有效。

**投毒风险：**
提供的POC代码（YAML格式的Sigma规则）主要用于检测漏洞利用，本身不包含恶意代码或后门。规则定义了检测包含特定字符串（`?unix:`）的URI，用于检测SSRF攻击。虽然规则本身可能存在误报或漏报的风险，但不存在直接的投毒风险。

**利用方式：**
1.  **利用前提：** Apache服务器启用 `mod_proxy` 模块，并且配置不当允许用户控制代理目标。
2.  **构造恶意请求：** 攻击者构造包含目标服务器地址的特殊 URI 路径。例如，使用 `?unix:` 协议访问本地 Unix 域套接字，或者使用 `http://internal-server`访问内部服务器。
3.  **服务器转发请求：** 受影响的 Apache 服务器接收到恶意请求后，`mod_proxy` 模块会将该请求转发到攻击者指定的目标服务器。
4.  **攻击目标：** 攻击者可以利用此漏洞访问内部服务、获取敏感信息或执行其他恶意操作。

**利用示例：**
```
GET /?unix:/path/to/socket|HTTP|1.1
Host: vulnerable-server.com
```
上述请求将尝试通过 Unix 域套接字 `/path/to/socket` 进行连接。

**修复建议：**
*   升级到 Apache HTTP Server 2.4.49 或更高版本。
*   配置 `mod_proxy` 模块，限制允许代理的目标地址。
*   使用防火墙或其他安全措施来保护内部服务。

**项目地址:** [pisut4152/Sigma-Rule-for-CVE-2021-40438-exploitation-attempt](https://github.com/pisut4152/Sigma-Rule-for-CVE-2021-40438-exploitation-attempt)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #8

**来源**: [CVE-2021-40438-sergiovks_CVE-2021-40438-Apache-2.4.48-SSRF-exploit.md](../2021/CVE-2021-40438-sergiovks_CVE-2021-40438-Apache-2.4.48-SSRF-exploit.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server (mod_proxy)

**危害等级:** 高危，可能导致敏感信息泄露、内部服务访问和远程代码执行 (取决于内部服务的配置)

**影响版本:** <= 2.4.48

**利用条件:** Apache HTTP Server启用了mod_proxy模块且配置不当

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是一个存在于 Apache HTTP Server 2.4.48 及更早版本中的 mod_proxy 模块的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过构造特殊的 URI 路径，使得 mod_proxy 将请求转发到由攻击者控制的服务器。 

**有效性：**

根据漏洞信息和漏洞利用代码，该漏洞利用的有效性较高。CISA已将其加入已知被利用的漏洞目录，证明其真实存在且已被实际利用。

**投毒风险：**

提供的漏洞利用代码 `CVE-2021-40438.py` 存在轻微的投毒风险。 代码本身结构简单，主要功能是发送带有特定构造的URL的HTTP请求,尝试利用SSRF漏洞。风险主要在于webhook_url变量, 如果代码的使用者不审查代码，可能将目标服务器的流量引入恶意或受控的webhook。 但代码本身并没有恶意代码,只是参数可以被滥用。因此，投毒风险评估为 10%。

**利用方式：**

1.  **攻击者构造恶意 URI 路径:**  攻击者构建包含目标服务器地址的 URI 路径，例如：`target_url?unix:AAAAAAAAAAAAAAAA...`，其中 `target_url` 是受影响的 Apache 服务器地址，`unix:`  后的字符串用于触发漏洞。
2.  **mod_proxy 转发请求:**  当 Apache 服务器收到包含恶意 URI 路径的请求时，`mod_proxy` 模块会错误地将请求转发到攻击者指定的服务器。
3.  **SSRF 实现:** 通过控制转发的目标服务器，攻击者可以实现 SSRF，从而访问内部服务、读取敏感信息或执行其他恶意操作。例如，攻击者可以将请求转发到内部的 metadata 服务，获取云服务器的凭据。

总体来说，CVE-2021-40438是一个严重的安全漏洞，需要及时进行修复。该漏洞的利用方式相对简单，攻击者可以通过构造恶意URI路径实现SSRF，进而可能造成严重的安全威胁。

**项目地址:** [sergiovks/CVE-2021-40438-Apache-2.4.48-SSRF-exploit](https://github.com/sergiovks/CVE-2021-40438-Apache-2.4.48-SSRF-exploit)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #9

**来源**: [CVE-2021-40438-sixpacksecurity_CVE-2021-40438.md](../2021/CVE-2021-40438-sixpacksecurity_CVE-2021-40438.md)

## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内网信息泄露和任意请求伪造

**影响版本:** <= 2.4.48

**利用条件:** mod_proxy模块启用，且存在不安全的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438是一个存在于Apache HTTP Server 2.4.48及更早版本中的服务器端请求伪造(SSRF)漏洞。攻击者可以通过精心构造的URI路径，使mod_proxy模块将请求转发到由远程用户选择的源服务器，从而实现SSRF攻击。

**有效性：** 根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC是有效的。漏洞库信息明确指出，攻击者可以控制请求转发的目标服务器。提供的Dockerfile和README.md描述了如何使用Docker搭建一个存在漏洞的环境，并使用curl命令发送包含恶意URI的请求，从而触发SSRF。

**投毒风险：** 提供的POC代码主要包含Dockerfile和README.md，以及一个配置文件`exploit.conf.txt`（未提供内容）。Dockerfile用于构建一个包含漏洞的Apache HTTP Server镜像，README.md提供漏洞利用的说明。目前无法得知`exploit.conf.txt`的具体内容，因此不能排除其中包含恶意配置的可能，但是从提供的代码来看投毒的可能性相对较低。考虑到未提供的配置文件的存在，投毒风险评估为10%。

**利用方式：** 该漏洞的利用方式如下：

1.  攻击者构建一个包含恶意URI的HTTP请求。该URI的目标服务器由攻击者控制。例如，`http://localhost:4444/?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...`
2.  攻击者将该请求发送到存在漏洞的Apache HTTP Server。
3.  Apache HTTP Server的mod_proxy模块解析该URI，由于漏洞的存在，它会将请求转发到攻击者指定的服务器。
4.  攻击者可以利用该SSRF漏洞访问内部网络资源，或者发起其他恶意请求。

提供的POC中使用`unix:` 协议，目的是访问Unix域套接字。这表明该漏洞可能被用于攻击本地服务，例如Docker守护程序或其他监听Unix套接字的服务。

**项目地址:** [sixpacksecurity/CVE-2021-40438](https://github.com/sixpacksecurity/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #10

**来源**: [CVE-2021-40438-xiaojiangxl_CVE-2021-40438.md](../2021/CVE-2021-40438-xiaojiangxl_CVE-2021-40438.md)

## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部信息泄露、敏感操作或利用内部服务进行攻击

**影响版本:** <= 2.4.48

**利用条件:** 服务器启用 mod_proxy 模块且配置不当

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-40438 存在于 Apache HTTP Server 的 mod_proxy 模块中。通过构造特制的 URI 路径，攻击者可以欺骗服务器将请求转发到由攻击者控制的源服务器，导致 SSRF 攻击。 

**有效性:** 提供的 POC 代码尝试通过 `unix:` 协议进行 SSRF 攻击。 该 URI 包含大量 'A' 字符，意图可能是触发缓冲区溢出或其他异常情况，以便将请求转发到非预期目标（可能为 Unix Socket）。如果 mod_proxy 没有正确处理 `unix:` 协议或长度限制，则可能成功利用此漏洞。

**投毒风险:** 此 POC 代码的主要功能是尝试利用 SSRF 漏洞，没有发现任何明显的恶意代码或后门植入行为。因此，投毒风险评估为 0%。

**利用方式:**
1.  攻击者发送包含恶意 URI 路径的 HTTP 请求。该 URI 路径以 `unix:` 开头，后跟一个长字符串。
2.  Apache HTTP Server 的 mod_proxy 模块尝试将此请求转发到由 URI 指定的目标。
3.  由于 URI 格式或长度异常，mod_proxy 模块处理出错，导致请求被转发到攻击者指定的服务器，从而触发 SSRF。
4. 攻击者可以利用此 SSRF 漏洞访问内部服务、读取敏感数据或执行其他恶意操作。

**项目地址:** [xiaojiangxl/CVE-2021-40438](https://github.com/xiaojiangxl/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

## POC #11

**来源**: [CVE-2021-40438-yakir2b_check-point-gateways-rce.md](../2021/CVE-2021-40438-yakir2b_check-point-gateways-rce.md)

## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许攻击者将请求转发到由远程用户选择的源服务器，可能导致敏感信息泄露，内部服务访问，甚至远程代码执行（如果内部服务存在其他漏洞）。

**影响版本:** <= 2.4.48

**利用条件:** 需要目标服务器启用mod_proxy模块且存在ProxyPass配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-40438 是 Apache HTTP Server 中 mod_proxy 模块的一个服务器端请求伪造 (SSRF) 漏洞。通过构造恶意的 URI 路径，攻击者可以诱使服务器将请求转发到攻击者控制的或内部的源服务器。 

**利用方式：**

漏洞利用的关键在于精心构造请求的 URI 路径。攻击者可以利用 `unix:/tmp/xdumps|http://.` 这样的URI，指示`mod_proxy`转发请求到指定URL，造成SSRF。

提供的漏洞利用代码 `check_point_gateways_rce.py` 专门针对 Check Point Security Gateways，利用该 SSRF 漏洞进行远程代码执行。它包含两种利用模式：

1.  `dump`: 尝试从目标服务器转储敏感信息，例如 `expertpwd` (专家模式密码) 或 `installer:last_update_time`。
2.  `reset`: 尝试重置 `admin` 用户的密码。这个模式会生成一个包含新密码哈希值的 payload，并将其发送到目标服务器。该代码中使用了`md5crypt`进行密码hash。
    利用步骤如下：
    *   构造包含重置密码的Payload。
    *   设置请求头 `Content-Type: application/octet-stream` 以绕过某些限制。
    *   将构造的Payload作为请求体发送到目标网关，触发密码重置。
    *   使用新密码通过API接口登录。
    *   执行任意API命令。
    例如，利用 `run-script` API执行任意命令。

**有效性：**

根据漏洞信息和提供的POC代码来看，该漏洞利用是有效的。POC 代码针对特定场景 (Check Point Security Gateways) 进行了优化，利用了该 SSRF 漏洞重置管理员密码，然后通过 API 执行任意命令。

**投毒风险：**

该代码主要利用了`requests`库发送HTTP请求。虽然代码中包含一些自定义函数如`monkey_patch`, `md5crypt`, `randstr`，但它们的实现相对简单，且没有明显的恶意行为。潜在的风险可能在于以下几个方面：

*   `monkey_patch()`：虽然文档中没有具体说明其作用，但猴子补丁可能会修改 `requests` 库的默认行为，如果补丁代码不正确，可能会导致意外的行为或安全问题。需要仔细审查其具体实现，但根据代码推测, 只是为了忽略SSL证书验证问题, 方便测试。
*   依赖项风险：如果依赖的第三方库 (例如 `requests`, `urllib3`) 存在安全漏洞，可能会引入安全风险。

总体来说，直接投毒风险较低，可能存在一些隐蔽性较低的漏洞，概率评估为 **5%**。重点在于审查 `monkey_patch` 函数的具体实现，并确保使用的第三方库是最新版本，以避免潜在的依赖项风险。

**项目地址:** [yakir2b/check-point-gateways-rce](https://github.com/yakir2b/check-point-gateways-rce)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)

---

