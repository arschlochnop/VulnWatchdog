# CVE-2021-3560

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-3560-0dayNinja_CVE-2021-3560.md](../2021/CVE-2021-3560-0dayNinja_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit D-Bus 认证绕过

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户提升至root权限，导致数据泄露、完整性破坏和系统不可用。

**影响版本:** Polkit 0.119

**利用条件:** 需要本地访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许本地未授权用户通过 D-Bus 消息绕过认证检查，从而获得 root 权限。

**有效性:**

根据漏洞信息、搜索结果和提供的 Metasploit 模块代码，该漏洞的利用是有效的。漏洞库信息和搜索结果都表明这是一个已知的、可被利用的权限提升漏洞。Metasploit 模块的存在进一步证实了这一点。

**投毒风险:**

分析 Metasploit 模块代码，投毒风险较低，约为 10%。主要风险在于：

*   **选项参数修改:**  攻击者可能会修改`USERNAME`和`PASSWORD`选项，添加一个后门账户，但这种行为容易被发现。
*   **模块逻辑篡改:**  攻击者可能修改模块的核心逻辑，例如在提权后执行恶意代码，或修改/etc/sudoers文件，但是由于metasploit-framework的开源特性，所以容易被检测出来
*   **依赖风险:**  模块依赖于 ruby 环境和 dbus-send 命令。攻击者可能会利用这些依赖项的漏洞进行投毒。

**利用方式:**

1.  **D-Bus 消息发送:**  利用 `dbus-send` 命令向 Polkit 发送特定的 D-Bus 消息。
2.  **竞争条件触发:**  在发送 D-Bus 消息的同时，通过 `kill` 命令终止客户端进程，从而触发竞争条件。
3.  **认证绕过:**  竞争条件导致 Polkit 绕过认证检查。
4.  **权限提升:**  成功绕过认证后，执行特权操作，例如添加具有 sudo 权限的新用户，或直接执行 payload。
5.  **Payload 执行:** 使用新增的账户执行payload，获取root权限

总而言之，该漏洞利用的有效性较高，但投毒风险相对较低。利用方式涉及发送恶意的 D-Bus 消息并利用竞争条件绕过认证检查，最终提升权限。

**项目地址:** [0dayNinja/CVE-2021-3560](https://github.com/0dayNinja/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #2

**来源**: [CVE-2021-3560-Almorabea_Polkit-exploit.md](../2021/CVE-2021-3560-Almorabea_Polkit-exploit.md)

## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，允许本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，目标系统安装了受影响版本的polkit，且使用systemd。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞允许本地未经授权的用户通过绕过 D-Bus 请求的凭据检查，将权限提升为 root 用户。从提供的漏洞库信息和搜索结果来看，该漏洞影响 polkit 0.119 版本。提供的漏洞利用代码 `CVE-2021-3560.py` 利用了 accountsservice 提供的 D-Bus 接口的 `CreateUser` 和 `SetPassword` 方法，通过竞争条件（race condition）绕过 polkit 的权限验证，创建一个具有 root 权限的新用户（ahmed），然后设置该用户的密码，并通过 `su ahmed -c 'sudo su'` 命令切换到该用户，最终获得 root 权限。

**有效性：**
根据提供的 README 和代码中的注释以及搜索结果，该PoC代码是有效的，能够在受影响的系统上成功提权。

**投毒风险：**
分析提供的 PoC 代码，未发现明显的恶意或隐藏代码，该代码的目的是利用漏洞实现权限提升，该利用方式与漏洞描述相符，没有发现其他恶意行为，投毒风险为 0%。

**利用方式：**
1.  利用竞争条件尝试创建用户'ahmed'，绕过polkit的认证。
2.  成功创建用户后，设置用户'ahmed'的密码，同样利用竞争条件绕过polkit的认证。
3.  使用新创建的用户登录，并尝试使用`sudo su`命令提升到root权限。

**项目地址:** [Almorabea/Polkit-exploit](https://github.com/Almorabea/Polkit-exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #3

**来源**: [CVE-2021-3560-Antoine-MANTIS_POC-Bash-CVE-2021-3560.md](../2021/CVE-2021-3560-Antoine-MANTIS_POC-Bash-CVE-2021-3560.md)

## CVE-2021-3560-Polkit本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** <= 0.119

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560是一个Polkit的本地提权漏洞。根据漏洞库信息、搜索结果以及提供的POC代码，可以得出以下结论：

**有效性：**

POC代码的有效性很高。漏洞描述表明，未授权的本地用户可以通过利用D-Bus请求中的凭据检查绕过，从而获得root权限。 提供的PoC脚本正是通过D-Bus接口来创建用户并设置密码，利用竞态条件来绕过权限验证。

**投毒风险：**

POC代码的投毒风险很低，为0%。 代码主要完成以下操作：

1.  **创建用户：** 使用`dbus-send`命令尝试创建新用户。利用竞态条件，在polkit正确验证权限之前完成用户创建。
2.  **设置密码：** 创建用户后，脚本尝试设置新用户的密码。同样利用竞态条件，尝试绕过权限验证。
3. **循环尝试:** 脚本使用循环尝试创建用户和设置密码，直到成功或达到最大尝试次数。

代码中没有发现任何恶意或隐藏的代码。虽然脚本的目的是利用漏洞进行提权，但它本身不包含任何超出漏洞利用范围的恶意功能，如安装后门、删除文件或传播恶意软件。

**利用方式：**

利用方式如下：

1.  **竞态条件：** 该漏洞的核心在于竞态条件。攻击者通过快速、重复地发送D-Bus请求，尝试在Polkit完成权限验证之前执行操作。
2.  **创建用户：** POC通过`org.freedesktop.Accounts.CreateUser`接口尝试创建一个新用户，目标是绕过权限验证直接创建具有管理权限的用户。
3.  **设置密码：** 创建用户后，PoC尝试通过`org.freedesktop.Accounts.User.SetPassword`接口设置密码，使得创建的用户可以使用该密码登录。
4.  **本地提权：** 成功利用该漏洞后，攻击者可以使用新创建的用户登录，并利用`sudo`命令执行需要root权限的操作，从而实现本地提权。

**排序优先级说明：**

按照任务要求，排序优先级为：搜索引擎结果 > 漏洞利用代码 > 漏洞库信息。 虽然漏洞库信息提供了漏洞的基本描述，但搜索引擎结果提供了更全面的信息，包括漏洞的发现者、利用方法和缓解措施。 漏洞利用代码则直接展示了漏洞的利用方式。


**项目地址:** [Antoine-MANTIS/POC-Bash-CVE-2021-3560](https://github.com/Antoine-MANTIS/POC-Bash-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #4

**来源**: [CVE-2021-3560-AssassinUKG_Polkit-CVE-2021-3560.md](../2021/CVE-2021-3560-AssassinUKG_Polkit-CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可导致本地普通用户获取Root权限，造成数据泄露、完整性破坏和系统不可用

**影响版本:** polkit 0.119及受影响版本，如Ubuntu 20.04 (policykit-1 0.105-26ubuntu1)

**利用条件:** 本地用户，目标系统安装了受影响版本的Polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地未授权用户通过利用Polkit中的D-Bus消息处理缺陷，绕过身份验证并获得Root权限。攻击者首先构造一个D-Bus消息请求创建具有sudo权限的新账户或者设置密码，然后中断（kill）该消息，导致Polkit在尝试获取消息发送者用户ID时发生错误。由于Polkit错误地处理了此错误，会将用户ID替换为0（Root用户ID），从而允许未授权请求以Root权限执行。

**有效性评估：**

根据漏洞信息、搜索结果和POC代码，该漏洞利用方法是有效的。漏洞库信息明确指出该漏洞允许权限提升，搜索结果中多个链接指向了漏洞详情、利用方法以及受影响的Linux发行版。POC代码提供了详细的利用步骤，包括发送D-Bus消息、中断消息以及相关的命令示例。

**投毒风险评估：**

POC代码主要包含利用漏洞的脚本和说明文档。虽然该代码本身是用于权限提升，存在一定的滥用风险，但并**没有发现**明显的、作者额外添加的恶意后门或代码。例如，自动植入SSH密钥、创建隐藏账户等。因此，投毒风险较低。但是，由于利用该漏洞可以获得Root权限，攻击者获得Root权限后可进行任何恶意操作，不能排除利用漏洞进行投毒的可能性。作者提供的是漏洞利用的证明和方法，其目的在于重现和理解漏洞，而非植入后门，因此投毒概率较低，估计为10%。

**利用方式：**

1.  **发送D-Bus消息：** 使用`dbus-send`命令向`org.freedesktop.Accounts`发送消息，请求创建具有sudo权限的新用户，或者设置密码。示例：
    ```bash
    dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:attacker string:"Pentester Account" int32:1
    ```
2.  **中断D-Bus消息：** 在Polkit处理消息之前，使用`kill`命令中断消息。这会删除消息的唯一ID。
3.  **Polkit错误处理：** Polkit在尝试使用已删除的消息ID获取消息发送者用户ID时，会遇到错误。Polkit会错误地将用户ID替换为0（Root用户ID）。
4.  **权限提升：** Polkit认为Root用户发起了请求，因此允许未授权请求以Root权限执行，从而实现权限提升。

**项目地址:** [AssassinUKG/Polkit-CVE-2021-3560](https://github.com/AssassinUKG/Polkit-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #5

**来源**: [CVE-2021-3560-BizarreLove_CVE-2021-3560.md](../2021/CVE-2021-3560-BizarreLove_CVE-2021-3560.md)

## CVE-2021-3560-Polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致提权至root权限，控制系统

**影响版本:** polkit 0.119 及受影响的 Linux 发行版

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许未经授权的本地攻击者通过绕过 D-Bus 请求的凭据检查，将其权限提升到 root 用户。根据漏洞库信息和搜索引擎结果，该漏洞影响 polkit 0.119 版本，并且已被广泛利用。提供的 POC 代码通过 D-Bus 与 Polkit 交互，利用漏洞提升权限。利用过程大致如下：

1.  **连接 D-Bus：** POC 代码首先连接到系统 D-Bus。
2.  **构造恶意消息：** 构造一个特定的 D-Bus 消息，目标是 org.freedesktop.Accounts 服务，利用漏洞绕过权限验证。
3.  **利用漏洞：** 成功发送消息后，攻击者可以执行特权操作，例如创建新的管理员用户或修改系统配置。
4. **投毒风险分析:** POC代码包含了一些常规操作，如连接D-Bus、构造和发送消息，并未发现明显恶意代码或后门，但仍存在一定风险。check函数中存在检测操作系统版本及policykit版本的操作，如果check函数被篡改，可能导致未受到漏洞影响的系统被判定为存在漏洞，从而诱导用户执行提权操作。 另外，`cve-2021-3560_poc.c` 编译需要链接 `libdbus-1.so` 和 `libz.so`库，攻击者可能诱导用户链接恶意库文件实现代码注入。

**有效性：** 根据漏洞信息和公开的利用代码，该漏洞利用是有效的，并且已被CISA列入已知被利用漏洞目录。

**利用方式：** 攻击者可以利用此漏洞获取 root 权限，从而完全控制受影响的系统。


**项目地址:** [BizarreLove/CVE-2021-3560](https://github.com/BizarreLove/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #6

**来源**: [CVE-2021-3560-Kyyomaa_CVE-2021-3560-EXPLOIT.md](../2021/CVE-2021-3560-Kyyomaa_CVE-2021-3560-EXPLOIT.md)

# CVE-2021-3560

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-3560-0dayNinja_CVE-2021-3560.md](../2021/CVE-2021-3560-0dayNinja_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit D-Bus 认证绕过

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户提升至root权限，导致数据泄露、完整性破坏和系统不可用。

**影响版本:** Polkit 0.119

**利用条件:** 需要本地访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许本地未授权用户通过 D-Bus 消息绕过认证检查，从而获得 root 权限。

**有效性:**

根据漏洞信息、搜索结果和提供的 Metasploit 模块代码，该漏洞的利用是有效的。漏洞库信息和搜索结果都表明这是一个已知的、可被利用的权限提升漏洞。Metasploit 模块的存在进一步证实了这一点。

**投毒风险:**

分析 Metasploit 模块代码，投毒风险较低，约为 10%。主要风险在于：

*   **选项参数修改:**  攻击者可能会修改`USERNAME`和`PASSWORD`选项，添加一个后门账户，但这种行为容易被发现。
*   **模块逻辑篡改:**  攻击者可能修改模块的核心逻辑，例如在提权后执行恶意代码，或修改/etc/sudoers文件，但是由于metasploit-framework的开源特性，所以容易被检测出来
*   **依赖风险:**  模块依赖于 ruby 环境和 dbus-send 命令。攻击者可能会利用这些依赖项的漏洞进行投毒。

**利用方式:**

1.  **D-Bus 消息发送:**  利用 `dbus-send` 命令向 Polkit 发送特定的 D-Bus 消息。
2.  **竞争条件触发:**  在发送 D-Bus 消息的同时，通过 `kill` 命令终止客户端进程，从而触发竞争条件。
3.  **认证绕过:**  竞争条件导致 Polkit 绕过认证检查。
4.  **权限提升:**  成功绕过认证后，执行特权操作，例如添加具有 sudo 权限的新用户，或直接执行 payload。
5.  **Payload 执行:** 使用新增的账户执行payload，获取root权限

总而言之，该漏洞利用的有效性较高，但投毒风险相对较低。利用方式涉及发送恶意的 D-Bus 消息并利用竞争条件绕过认证检查，最终提升权限。

**项目地址:** [0dayNinja/CVE-2021-3560](https://github.com/0dayNinja/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #2

**来源**: [CVE-2021-3560-Almorabea_Polkit-exploit.md](../2021/CVE-2021-3560-Almorabea_Polkit-exploit.md)

## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，允许本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，目标系统安装了受影响版本的polkit，且使用systemd。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞允许本地未经授权的用户通过绕过 D-Bus 请求的凭据检查，将权限提升为 root 用户。从提供的漏洞库信息和搜索结果来看，该漏洞影响 polkit 0.119 版本。提供的漏洞利用代码 `CVE-2021-3560.py` 利用了 accountsservice 提供的 D-Bus 接口的 `CreateUser` 和 `SetPassword` 方法，通过竞争条件（race condition）绕过 polkit 的权限验证，创建一个具有 root 权限的新用户（ahmed），然后设置该用户的密码，并通过 `su ahmed -c 'sudo su'` 命令切换到该用户，最终获得 root 权限。

**有效性：**
根据提供的 README 和代码中的注释以及搜索结果，该PoC代码是有效的，能够在受影响的系统上成功提权。

**投毒风险：**
分析提供的 PoC 代码，未发现明显的恶意或隐藏代码，该代码的目的是利用漏洞实现权限提升，该利用方式与漏洞描述相符，没有发现其他恶意行为，投毒风险为 0%。

**利用方式：**
1.  利用竞争条件尝试创建用户'ahmed'，绕过polkit的认证。
2.  成功创建用户后，设置用户'ahmed'的密码，同样利用竞争条件绕过polkit的认证。
3.  使用新创建的用户登录，并尝试使用`sudo su`命令提升到root权限。

**项目地址:** [Almorabea/Polkit-exploit](https://github.com/Almorabea/Polkit-exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #3

**来源**: [CVE-2021-3560-Antoine-MANTIS_POC-Bash-CVE-2021-3560.md](../2021/CVE-2021-3560-Antoine-MANTIS_POC-Bash-CVE-2021-3560.md)

## CVE-2021-3560-Polkit本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** <= 0.119

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560是一个Polkit的本地提权漏洞。根据漏洞库信息、搜索结果以及提供的POC代码，可以得出以下结论：

**有效性：**

POC代码的有效性很高。漏洞描述表明，未授权的本地用户可以通过利用D-Bus请求中的凭据检查绕过，从而获得root权限。 提供的PoC脚本正是通过D-Bus接口来创建用户并设置密码，利用竞态条件来绕过权限验证。

**投毒风险：**

POC代码的投毒风险很低，为0%。 代码主要完成以下操作：

1.  **创建用户：** 使用`dbus-send`命令尝试创建新用户。利用竞态条件，在polkit正确验证权限之前完成用户创建。
2.  **设置密码：** 创建用户后，脚本尝试设置新用户的密码。同样利用竞态条件，尝试绕过权限验证。
3. **循环尝试:** 脚本使用循环尝试创建用户和设置密码，直到成功或达到最大尝试次数。

代码中没有发现任何恶意或隐藏的代码。虽然脚本的目的是利用漏洞进行提权，但它本身不包含任何超出漏洞利用范围的恶意功能，如安装后门、删除文件或传播恶意软件。

**利用方式：**

利用方式如下：

1.  **竞态条件：** 该漏洞的核心在于竞态条件。攻击者通过快速、重复地发送D-Bus请求，尝试在Polkit完成权限验证之前执行操作。
2.  **创建用户：** POC通过`org.freedesktop.Accounts.CreateUser`接口尝试创建一个新用户，目标是绕过权限验证直接创建具有管理权限的用户。
3.  **设置密码：** 创建用户后，PoC尝试通过`org.freedesktop.Accounts.User.SetPassword`接口设置密码，使得创建的用户可以使用该密码登录。
4.  **本地提权：** 成功利用该漏洞后，攻击者可以使用新创建的用户登录，并利用`sudo`命令执行需要root权限的操作，从而实现本地提权。

**排序优先级说明：**

按照任务要求，排序优先级为：搜索引擎结果 > 漏洞利用代码 > 漏洞库信息。 虽然漏洞库信息提供了漏洞的基本描述，但搜索引擎结果提供了更全面的信息，包括漏洞的发现者、利用方法和缓解措施。 漏洞利用代码则直接展示了漏洞的利用方式。


**项目地址:** [Antoine-MANTIS/POC-Bash-CVE-2021-3560](https://github.com/Antoine-MANTIS/POC-Bash-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #4

**来源**: [CVE-2021-3560-AssassinUKG_Polkit-CVE-2021-3560.md](../2021/CVE-2021-3560-AssassinUKG_Polkit-CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可导致本地普通用户获取Root权限，造成数据泄露、完整性破坏和系统不可用

**影响版本:** polkit 0.119及受影响版本，如Ubuntu 20.04 (policykit-1 0.105-26ubuntu1)

**利用条件:** 本地用户，目标系统安装了受影响版本的Polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地未授权用户通过利用Polkit中的D-Bus消息处理缺陷，绕过身份验证并获得Root权限。攻击者首先构造一个D-Bus消息请求创建具有sudo权限的新账户或者设置密码，然后中断（kill）该消息，导致Polkit在尝试获取消息发送者用户ID时发生错误。由于Polkit错误地处理了此错误，会将用户ID替换为0（Root用户ID），从而允许未授权请求以Root权限执行。

**有效性评估：**

根据漏洞信息、搜索结果和POC代码，该漏洞利用方法是有效的。漏洞库信息明确指出该漏洞允许权限提升，搜索结果中多个链接指向了漏洞详情、利用方法以及受影响的Linux发行版。POC代码提供了详细的利用步骤，包括发送D-Bus消息、中断消息以及相关的命令示例。

**投毒风险评估：**

POC代码主要包含利用漏洞的脚本和说明文档。虽然该代码本身是用于权限提升，存在一定的滥用风险，但并**没有发现**明显的、作者额外添加的恶意后门或代码。例如，自动植入SSH密钥、创建隐藏账户等。因此，投毒风险较低。但是，由于利用该漏洞可以获得Root权限，攻击者获得Root权限后可进行任何恶意操作，不能排除利用漏洞进行投毒的可能性。作者提供的是漏洞利用的证明和方法，其目的在于重现和理解漏洞，而非植入后门，因此投毒概率较低，估计为10%。

**利用方式：**

1.  **发送D-Bus消息：** 使用`dbus-send`命令向`org.freedesktop.Accounts`发送消息，请求创建具有sudo权限的新用户，或者设置密码。示例：
    ```bash
    dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:attacker string:"Pentester Account" int32:1
    ```
2.  **中断D-Bus消息：** 在Polkit处理消息之前，使用`kill`命令中断消息。这会删除消息的唯一ID。
3.  **Polkit错误处理：** Polkit在尝试使用已删除的消息ID获取消息发送者用户ID时，会遇到错误。Polkit会错误地将用户ID替换为0（Root用户ID）。
4.  **权限提升：** Polkit认为Root用户发起了请求，因此允许未授权请求以Root权限执行，从而实现权限提升。

**项目地址:** [AssassinUKG/Polkit-CVE-2021-3560](https://github.com/AssassinUKG/Polkit-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #5

**来源**: [CVE-2021-3560-BizarreLove_CVE-2021-3560.md](../2021/CVE-2021-3560-BizarreLove_CVE-2021-3560.md)

## CVE-2021-3560-Polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致提权至root权限，控制系统

**影响版本:** polkit 0.119 及受影响的 Linux 发行版

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许未经授权的本地攻击者通过绕过 D-Bus 请求的凭据检查，将其权限提升到 root 用户。根据漏洞库信息和搜索引擎结果，该漏洞影响 polkit 0.119 版本，并且已被广泛利用。提供的 POC 代码通过 D-Bus 与 Polkit 交互，利用漏洞提升权限。利用过程大致如下：

1.  **连接 D-Bus：** POC 代码首先连接到系统 D-Bus。
2.  **构造恶意消息：** 构造一个特定的 D-Bus 消息，目标是 org.freedesktop.Accounts 服务，利用漏洞绕过权限验证。
3.  **利用漏洞：** 成功发送消息后，攻击者可以执行特权操作，例如创建新的管理员用户或修改系统配置。
4. **投毒风险分析:** POC代码包含了一些常规操作，如连接D-Bus、构造和发送消息，并未发现明显恶意代码或后门，但仍存在一定风险。check函数中存在检测操作系统版本及policykit版本的操作，如果check函数被篡改，可能导致未受到漏洞影响的系统被判定为存在漏洞，从而诱导用户执行提权操作。 另外，`cve-2021-3560_poc.c` 编译需要链接 `libdbus-1.so` 和 `libz.so`库，攻击者可能诱导用户链接恶意库文件实现代码注入。

**有效性：** 根据漏洞信息和公开的利用代码，该漏洞利用是有效的，并且已被CISA列入已知被利用漏洞目录。

**利用方式：** 攻击者可以利用此漏洞获取 root 权限，从而完全控制受影响的系统。


**项目地址:** [BizarreLove/CVE-2021-3560](https://github.com/BizarreLove/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #6

**来源**: [CVE-2021-3560-Kyyomaa_CVE-2021-3560-EXPLOIT.md](../2021/CVE-2021-3560-Kyyomaa_CVE-2021-3560-EXPLOIT.md)

# CVE-2021-3560

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-3560-0dayNinja_CVE-2021-3560.md](../2021/CVE-2021-3560-0dayNinja_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit D-Bus 认证绕过

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户提升至root权限，导致数据泄露、完整性破坏和系统不可用。

**影响版本:** Polkit 0.119

**利用条件:** 需要本地访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许本地未授权用户通过 D-Bus 消息绕过认证检查，从而获得 root 权限。

**有效性:**

根据漏洞信息、搜索结果和提供的 Metasploit 模块代码，该漏洞的利用是有效的。漏洞库信息和搜索结果都表明这是一个已知的、可被利用的权限提升漏洞。Metasploit 模块的存在进一步证实了这一点。

**投毒风险:**

分析 Metasploit 模块代码，投毒风险较低，约为 10%。主要风险在于：

*   **选项参数修改:**  攻击者可能会修改`USERNAME`和`PASSWORD`选项，添加一个后门账户，但这种行为容易被发现。
*   **模块逻辑篡改:**  攻击者可能修改模块的核心逻辑，例如在提权后执行恶意代码，或修改/etc/sudoers文件，但是由于metasploit-framework的开源特性，所以容易被检测出来
*   **依赖风险:**  模块依赖于 ruby 环境和 dbus-send 命令。攻击者可能会利用这些依赖项的漏洞进行投毒。

**利用方式:**

1.  **D-Bus 消息发送:**  利用 `dbus-send` 命令向 Polkit 发送特定的 D-Bus 消息。
2.  **竞争条件触发:**  在发送 D-Bus 消息的同时，通过 `kill` 命令终止客户端进程，从而触发竞争条件。
3.  **认证绕过:**  竞争条件导致 Polkit 绕过认证检查。
4.  **权限提升:**  成功绕过认证后，执行特权操作，例如添加具有 sudo 权限的新用户，或直接执行 payload。
5.  **Payload 执行:** 使用新增的账户执行payload，获取root权限

总而言之，该漏洞利用的有效性较高，但投毒风险相对较低。利用方式涉及发送恶意的 D-Bus 消息并利用竞争条件绕过认证检查，最终提升权限。

**项目地址:** [0dayNinja/CVE-2021-3560](https://github.com/0dayNinja/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #2

**来源**: [CVE-2021-3560-Almorabea_Polkit-exploit.md](../2021/CVE-2021-3560-Almorabea_Polkit-exploit.md)

## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，允许本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，目标系统安装了受影响版本的polkit，且使用systemd。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞允许本地未经授权的用户通过绕过 D-Bus 请求的凭据检查，将权限提升为 root 用户。从提供的漏洞库信息和搜索结果来看，该漏洞影响 polkit 0.119 版本。提供的漏洞利用代码 `CVE-2021-3560.py` 利用了 accountsservice 提供的 D-Bus 接口的 `CreateUser` 和 `SetPassword` 方法，通过竞争条件（race condition）绕过 polkit 的权限验证，创建一个具有 root 权限的新用户（ahmed），然后设置该用户的密码，并通过 `su ahmed -c 'sudo su'` 命令切换到该用户，最终获得 root 权限。

**有效性：**
根据提供的 README 和代码中的注释以及搜索结果，该PoC代码是有效的，能够在受影响的系统上成功提权。

**投毒风险：**
分析提供的 PoC 代码，未发现明显的恶意或隐藏代码，该代码的目的是利用漏洞实现权限提升，该利用方式与漏洞描述相符，没有发现其他恶意行为，投毒风险为 0%。

**利用方式：**
1.  利用竞争条件尝试创建用户'ahmed'，绕过polkit的认证。
2.  成功创建用户后，设置用户'ahmed'的密码，同样利用竞争条件绕过polkit的认证。
3.  使用新创建的用户登录，并尝试使用`sudo su`命令提升到root权限。

**项目地址:** [Almorabea/Polkit-exploit](https://github.com/Almorabea/Polkit-exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #3

**来源**: [CVE-2021-3560-Antoine-MANTIS_POC-Bash-CVE-2021-3560.md](../2021/CVE-2021-3560-Antoine-MANTIS_POC-Bash-CVE-2021-3560.md)

## CVE-2021-3560-Polkit本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** <= 0.119

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560是一个Polkit的本地提权漏洞。根据漏洞库信息、搜索结果以及提供的POC代码，可以得出以下结论：

**有效性：**

POC代码的有效性很高。漏洞描述表明，未授权的本地用户可以通过利用D-Bus请求中的凭据检查绕过，从而获得root权限。 提供的PoC脚本正是通过D-Bus接口来创建用户并设置密码，利用竞态条件来绕过权限验证。

**投毒风险：**

POC代码的投毒风险很低，为0%。 代码主要完成以下操作：

1.  **创建用户：** 使用`dbus-send`命令尝试创建新用户。利用竞态条件，在polkit正确验证权限之前完成用户创建。
2.  **设置密码：** 创建用户后，脚本尝试设置新用户的密码。同样利用竞态条件，尝试绕过权限验证。
3. **循环尝试:** 脚本使用循环尝试创建用户和设置密码，直到成功或达到最大尝试次数。

代码中没有发现任何恶意或隐藏的代码。虽然脚本的目的是利用漏洞进行提权，但它本身不包含任何超出漏洞利用范围的恶意功能，如安装后门、删除文件或传播恶意软件。

**利用方式：**

利用方式如下：

1.  **竞态条件：** 该漏洞的核心在于竞态条件。攻击者通过快速、重复地发送D-Bus请求，尝试在Polkit完成权限验证之前执行操作。
2.  **创建用户：** POC通过`org.freedesktop.Accounts.CreateUser`接口尝试创建一个新用户，目标是绕过权限验证直接创建具有管理权限的用户。
3.  **设置密码：** 创建用户后，PoC尝试通过`org.freedesktop.Accounts.User.SetPassword`接口设置密码，使得创建的用户可以使用该密码登录。
4.  **本地提权：** 成功利用该漏洞后，攻击者可以使用新创建的用户登录，并利用`sudo`命令执行需要root权限的操作，从而实现本地提权。

**排序优先级说明：**

按照任务要求，排序优先级为：搜索引擎结果 > 漏洞利用代码 > 漏洞库信息。 虽然漏洞库信息提供了漏洞的基本描述，但搜索引擎结果提供了更全面的信息，包括漏洞的发现者、利用方法和缓解措施。 漏洞利用代码则直接展示了漏洞的利用方式。


**项目地址:** [Antoine-MANTIS/POC-Bash-CVE-2021-3560](https://github.com/Antoine-MANTIS/POC-Bash-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #4

**来源**: [CVE-2021-3560-AssassinUKG_Polkit-CVE-2021-3560.md](../2021/CVE-2021-3560-AssassinUKG_Polkit-CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可导致本地普通用户获取Root权限，造成数据泄露、完整性破坏和系统不可用

**影响版本:** polkit 0.119及受影响版本，如Ubuntu 20.04 (policykit-1 0.105-26ubuntu1)

**利用条件:** 本地用户，目标系统安装了受影响版本的Polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地未授权用户通过利用Polkit中的D-Bus消息处理缺陷，绕过身份验证并获得Root权限。攻击者首先构造一个D-Bus消息请求创建具有sudo权限的新账户或者设置密码，然后中断（kill）该消息，导致Polkit在尝试获取消息发送者用户ID时发生错误。由于Polkit错误地处理了此错误，会将用户ID替换为0（Root用户ID），从而允许未授权请求以Root权限执行。

**有效性评估：**

根据漏洞信息、搜索结果和POC代码，该漏洞利用方法是有效的。漏洞库信息明确指出该漏洞允许权限提升，搜索结果中多个链接指向了漏洞详情、利用方法以及受影响的Linux发行版。POC代码提供了详细的利用步骤，包括发送D-Bus消息、中断消息以及相关的命令示例。

**投毒风险评估：**

POC代码主要包含利用漏洞的脚本和说明文档。虽然该代码本身是用于权限提升，存在一定的滥用风险，但并**没有发现**明显的、作者额外添加的恶意后门或代码。例如，自动植入SSH密钥、创建隐藏账户等。因此，投毒风险较低。但是，由于利用该漏洞可以获得Root权限，攻击者获得Root权限后可进行任何恶意操作，不能排除利用漏洞进行投毒的可能性。作者提供的是漏洞利用的证明和方法，其目的在于重现和理解漏洞，而非植入后门，因此投毒概率较低，估计为10%。

**利用方式：**

1.  **发送D-Bus消息：** 使用`dbus-send`命令向`org.freedesktop.Accounts`发送消息，请求创建具有sudo权限的新用户，或者设置密码。示例：
    ```bash
    dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:attacker string:"Pentester Account" int32:1
    ```
2.  **中断D-Bus消息：** 在Polkit处理消息之前，使用`kill`命令中断消息。这会删除消息的唯一ID。
3.  **Polkit错误处理：** Polkit在尝试使用已删除的消息ID获取消息发送者用户ID时，会遇到错误。Polkit会错误地将用户ID替换为0（Root用户ID）。
4.  **权限提升：** Polkit认为Root用户发起了请求，因此允许未授权请求以Root权限执行，从而实现权限提升。

**项目地址:** [AssassinUKG/Polkit-CVE-2021-3560](https://github.com/AssassinUKG/Polkit-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #5

**来源**: [CVE-2021-3560-BizarreLove_CVE-2021-3560.md](../2021/CVE-2021-3560-BizarreLove_CVE-2021-3560.md)

## CVE-2021-3560-Polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致提权至root权限，控制系统

**影响版本:** polkit 0.119 及受影响的 Linux 发行版

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许未经授权的本地攻击者通过绕过 D-Bus 请求的凭据检查，将其权限提升到 root 用户。根据漏洞库信息和搜索引擎结果，该漏洞影响 polkit 0.119 版本，并且已被广泛利用。提供的 POC 代码通过 D-Bus 与 Polkit 交互，利用漏洞提升权限。利用过程大致如下：

1.  **连接 D-Bus：** POC 代码首先连接到系统 D-Bus。
2.  **构造恶意消息：** 构造一个特定的 D-Bus 消息，目标是 org.freedesktop.Accounts 服务，利用漏洞绕过权限验证。
3.  **利用漏洞：** 成功发送消息后，攻击者可以执行特权操作，例如创建新的管理员用户或修改系统配置。
4. **投毒风险分析:** POC代码包含了一些常规操作，如连接D-Bus、构造和发送消息，并未发现明显恶意代码或后门，但仍存在一定风险。check函数中存在检测操作系统版本及policykit版本的操作，如果check函数被篡改，可能导致未受到漏洞影响的系统被判定为存在漏洞，从而诱导用户执行提权操作。 另外，`cve-2021-3560_poc.c` 编译需要链接 `libdbus-1.so` 和 `libz.so`库，攻击者可能诱导用户链接恶意库文件实现代码注入。

**有效性：** 根据漏洞信息和公开的利用代码，该漏洞利用是有效的，并且已被CISA列入已知被利用漏洞目录。

**利用方式：** 攻击者可以利用此漏洞获取 root 权限，从而完全控制受影响的系统。


**项目地址:** [BizarreLove/CVE-2021-3560](https://github.com/BizarreLove/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #6

**来源**: [CVE-2021-3560-Kyyomaa_CVE-2021-3560-EXPLOIT.md](../2021/CVE-2021-3560-Kyyomaa_CVE-2021-3560-EXPLOIT.md)

# CVE-2021-3560

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-3560-0dayNinja_CVE-2021-3560.md](../2021/CVE-2021-3560-0dayNinja_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit D-Bus 认证绕过

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户提升至root权限，导致数据泄露、完整性破坏和系统不可用。

**影响版本:** Polkit 0.119

**利用条件:** 需要本地访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许本地未授权用户通过 D-Bus 消息绕过认证检查，从而获得 root 权限。

**有效性:**

根据漏洞信息、搜索结果和提供的 Metasploit 模块代码，该漏洞的利用是有效的。漏洞库信息和搜索结果都表明这是一个已知的、可被利用的权限提升漏洞。Metasploit 模块的存在进一步证实了这一点。

**投毒风险:**

分析 Metasploit 模块代码，投毒风险较低，约为 10%。主要风险在于：

*   **选项参数修改:**  攻击者可能会修改`USERNAME`和`PASSWORD`选项，添加一个后门账户，但这种行为容易被发现。
*   **模块逻辑篡改:**  攻击者可能修改模块的核心逻辑，例如在提权后执行恶意代码，或修改/etc/sudoers文件，但是由于metasploit-framework的开源特性，所以容易被检测出来
*   **依赖风险:**  模块依赖于 ruby 环境和 dbus-send 命令。攻击者可能会利用这些依赖项的漏洞进行投毒。

**利用方式:**

1.  **D-Bus 消息发送:**  利用 `dbus-send` 命令向 Polkit 发送特定的 D-Bus 消息。
2.  **竞争条件触发:**  在发送 D-Bus 消息的同时，通过 `kill` 命令终止客户端进程，从而触发竞争条件。
3.  **认证绕过:**  竞争条件导致 Polkit 绕过认证检查。
4.  **权限提升:**  成功绕过认证后，执行特权操作，例如添加具有 sudo 权限的新用户，或直接执行 payload。
5.  **Payload 执行:** 使用新增的账户执行payload，获取root权限

总而言之，该漏洞利用的有效性较高，但投毒风险相对较低。利用方式涉及发送恶意的 D-Bus 消息并利用竞争条件绕过认证检查，最终提升权限。

**项目地址:** [0dayNinja/CVE-2021-3560](https://github.com/0dayNinja/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #2

**来源**: [CVE-2021-3560-Almorabea_Polkit-exploit.md](../2021/CVE-2021-3560-Almorabea_Polkit-exploit.md)

## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，允许本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，目标系统安装了受影响版本的polkit，且使用systemd。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞允许本地未经授权的用户通过绕过 D-Bus 请求的凭据检查，将权限提升为 root 用户。从提供的漏洞库信息和搜索结果来看，该漏洞影响 polkit 0.119 版本。提供的漏洞利用代码 `CVE-2021-3560.py` 利用了 accountsservice 提供的 D-Bus 接口的 `CreateUser` 和 `SetPassword` 方法，通过竞争条件（race condition）绕过 polkit 的权限验证，创建一个具有 root 权限的新用户（ahmed），然后设置该用户的密码，并通过 `su ahmed -c 'sudo su'` 命令切换到该用户，最终获得 root 权限。

**有效性：**
根据提供的 README 和代码中的注释以及搜索结果，该PoC代码是有效的，能够在受影响的系统上成功提权。

**投毒风险：**
分析提供的 PoC 代码，未发现明显的恶意或隐藏代码，该代码的目的是利用漏洞实现权限提升，该利用方式与漏洞描述相符，没有发现其他恶意行为，投毒风险为 0%。

**利用方式：**
1.  利用竞争条件尝试创建用户'ahmed'，绕过polkit的认证。
2.  成功创建用户后，设置用户'ahmed'的密码，同样利用竞争条件绕过polkit的认证。
3.  使用新创建的用户登录，并尝试使用`sudo su`命令提升到root权限。

**项目地址:** [Almorabea/Polkit-exploit](https://github.com/Almorabea/Polkit-exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #3

**来源**: [CVE-2021-3560-Antoine-MANTIS_POC-Bash-CVE-2021-3560.md](../2021/CVE-2021-3560-Antoine-MANTIS_POC-Bash-CVE-2021-3560.md)

## CVE-2021-3560-Polkit本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** <= 0.119

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560是一个Polkit的本地提权漏洞。根据漏洞库信息、搜索结果以及提供的POC代码，可以得出以下结论：

**有效性：**

POC代码的有效性很高。漏洞描述表明，未授权的本地用户可以通过利用D-Bus请求中的凭据检查绕过，从而获得root权限。 提供的PoC脚本正是通过D-Bus接口来创建用户并设置密码，利用竞态条件来绕过权限验证。

**投毒风险：**

POC代码的投毒风险很低，为0%。 代码主要完成以下操作：

1.  **创建用户：** 使用`dbus-send`命令尝试创建新用户。利用竞态条件，在polkit正确验证权限之前完成用户创建。
2.  **设置密码：** 创建用户后，脚本尝试设置新用户的密码。同样利用竞态条件，尝试绕过权限验证。
3. **循环尝试:** 脚本使用循环尝试创建用户和设置密码，直到成功或达到最大尝试次数。

代码中没有发现任何恶意或隐藏的代码。虽然脚本的目的是利用漏洞进行提权，但它本身不包含任何超出漏洞利用范围的恶意功能，如安装后门、删除文件或传播恶意软件。

**利用方式：**

利用方式如下：

1.  **竞态条件：** 该漏洞的核心在于竞态条件。攻击者通过快速、重复地发送D-Bus请求，尝试在Polkit完成权限验证之前执行操作。
2.  **创建用户：** POC通过`org.freedesktop.Accounts.CreateUser`接口尝试创建一个新用户，目标是绕过权限验证直接创建具有管理权限的用户。
3.  **设置密码：** 创建用户后，PoC尝试通过`org.freedesktop.Accounts.User.SetPassword`接口设置密码，使得创建的用户可以使用该密码登录。
4.  **本地提权：** 成功利用该漏洞后，攻击者可以使用新创建的用户登录，并利用`sudo`命令执行需要root权限的操作，从而实现本地提权。

**排序优先级说明：**

按照任务要求，排序优先级为：搜索引擎结果 > 漏洞利用代码 > 漏洞库信息。 虽然漏洞库信息提供了漏洞的基本描述，但搜索引擎结果提供了更全面的信息，包括漏洞的发现者、利用方法和缓解措施。 漏洞利用代码则直接展示了漏洞的利用方式。


**项目地址:** [Antoine-MANTIS/POC-Bash-CVE-2021-3560](https://github.com/Antoine-MANTIS/POC-Bash-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #4

**来源**: [CVE-2021-3560-AssassinUKG_Polkit-CVE-2021-3560.md](../2021/CVE-2021-3560-AssassinUKG_Polkit-CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可导致本地普通用户获取Root权限，造成数据泄露、完整性破坏和系统不可用

**影响版本:** polkit 0.119及受影响版本，如Ubuntu 20.04 (policykit-1 0.105-26ubuntu1)

**利用条件:** 本地用户，目标系统安装了受影响版本的Polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地未授权用户通过利用Polkit中的D-Bus消息处理缺陷，绕过身份验证并获得Root权限。攻击者首先构造一个D-Bus消息请求创建具有sudo权限的新账户或者设置密码，然后中断（kill）该消息，导致Polkit在尝试获取消息发送者用户ID时发生错误。由于Polkit错误地处理了此错误，会将用户ID替换为0（Root用户ID），从而允许未授权请求以Root权限执行。

**有效性评估：**

根据漏洞信息、搜索结果和POC代码，该漏洞利用方法是有效的。漏洞库信息明确指出该漏洞允许权限提升，搜索结果中多个链接指向了漏洞详情、利用方法以及受影响的Linux发行版。POC代码提供了详细的利用步骤，包括发送D-Bus消息、中断消息以及相关的命令示例。

**投毒风险评估：**

POC代码主要包含利用漏洞的脚本和说明文档。虽然该代码本身是用于权限提升，存在一定的滥用风险，但并**没有发现**明显的、作者额外添加的恶意后门或代码。例如，自动植入SSH密钥、创建隐藏账户等。因此，投毒风险较低。但是，由于利用该漏洞可以获得Root权限，攻击者获得Root权限后可进行任何恶意操作，不能排除利用漏洞进行投毒的可能性。作者提供的是漏洞利用的证明和方法，其目的在于重现和理解漏洞，而非植入后门，因此投毒概率较低，估计为10%。

**利用方式：**

1.  **发送D-Bus消息：** 使用`dbus-send`命令向`org.freedesktop.Accounts`发送消息，请求创建具有sudo权限的新用户，或者设置密码。示例：
    ```bash
    dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:attacker string:"Pentester Account" int32:1
    ```
2.  **中断D-Bus消息：** 在Polkit处理消息之前，使用`kill`命令中断消息。这会删除消息的唯一ID。
3.  **Polkit错误处理：** Polkit在尝试使用已删除的消息ID获取消息发送者用户ID时，会遇到错误。Polkit会错误地将用户ID替换为0（Root用户ID）。
4.  **权限提升：** Polkit认为Root用户发起了请求，因此允许未授权请求以Root权限执行，从而实现权限提升。

**项目地址:** [AssassinUKG/Polkit-CVE-2021-3560](https://github.com/AssassinUKG/Polkit-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #5

**来源**: [CVE-2021-3560-BizarreLove_CVE-2021-3560.md](../2021/CVE-2021-3560-BizarreLove_CVE-2021-3560.md)

## CVE-2021-3560-Polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致提权至root权限，控制系统

**影响版本:** polkit 0.119 及受影响的 Linux 发行版

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许未经授权的本地攻击者通过绕过 D-Bus 请求的凭据检查，将其权限提升到 root 用户。根据漏洞库信息和搜索引擎结果，该漏洞影响 polkit 0.119 版本，并且已被广泛利用。提供的 POC 代码通过 D-Bus 与 Polkit 交互，利用漏洞提升权限。利用过程大致如下：

1.  **连接 D-Bus：** POC 代码首先连接到系统 D-Bus。
2.  **构造恶意消息：** 构造一个特定的 D-Bus 消息，目标是 org.freedesktop.Accounts 服务，利用漏洞绕过权限验证。
3.  **利用漏洞：** 成功发送消息后，攻击者可以执行特权操作，例如创建新的管理员用户或修改系统配置。
4. **投毒风险分析:** POC代码包含了一些常规操作，如连接D-Bus、构造和发送消息，并未发现明显恶意代码或后门，但仍存在一定风险。check函数中存在检测操作系统版本及policykit版本的操作，如果check函数被篡改，可能导致未受到漏洞影响的系统被判定为存在漏洞，从而诱导用户执行提权操作。 另外，`cve-2021-3560_poc.c` 编译需要链接 `libdbus-1.so` 和 `libz.so`库，攻击者可能诱导用户链接恶意库文件实现代码注入。

**有效性：** 根据漏洞信息和公开的利用代码，该漏洞利用是有效的，并且已被CISA列入已知被利用漏洞目录。

**利用方式：** 攻击者可以利用此漏洞获取 root 权限，从而完全控制受影响的系统。


**项目地址:** [BizarreLove/CVE-2021-3560](https://github.com/BizarreLove/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #6

**来源**: [CVE-2021-3560-Kyyomaa_CVE-2021-3560-EXPLOIT.md](../2021/CVE-2021-3560-Kyyomaa_CVE-2021-3560-EXPLOIT.md)

# CVE-2021-3560

> 📦 该CVE有 **27** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-3560-0dayNinja_CVE-2021-3560.md](../2021/CVE-2021-3560-0dayNinja_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit D-Bus 认证绕过

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户提升至root权限，导致数据泄露、完整性破坏和系统不可用。

**影响版本:** Polkit 0.119

**利用条件:** 需要本地访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许本地未授权用户通过 D-Bus 消息绕过认证检查，从而获得 root 权限。

**有效性:**

根据漏洞信息、搜索结果和提供的 Metasploit 模块代码，该漏洞的利用是有效的。漏洞库信息和搜索结果都表明这是一个已知的、可被利用的权限提升漏洞。Metasploit 模块的存在进一步证实了这一点。

**投毒风险:**

分析 Metasploit 模块代码，投毒风险较低，约为 10%。主要风险在于：

*   **选项参数修改:**  攻击者可能会修改`USERNAME`和`PASSWORD`选项，添加一个后门账户，但这种行为容易被发现。
*   **模块逻辑篡改:**  攻击者可能修改模块的核心逻辑，例如在提权后执行恶意代码，或修改/etc/sudoers文件，但是由于metasploit-framework的开源特性，所以容易被检测出来
*   **依赖风险:**  模块依赖于 ruby 环境和 dbus-send 命令。攻击者可能会利用这些依赖项的漏洞进行投毒。

**利用方式:**

1.  **D-Bus 消息发送:**  利用 `dbus-send` 命令向 Polkit 发送特定的 D-Bus 消息。
2.  **竞争条件触发:**  在发送 D-Bus 消息的同时，通过 `kill` 命令终止客户端进程，从而触发竞争条件。
3.  **认证绕过:**  竞争条件导致 Polkit 绕过认证检查。
4.  **权限提升:**  成功绕过认证后，执行特权操作，例如添加具有 sudo 权限的新用户，或直接执行 payload。
5.  **Payload 执行:** 使用新增的账户执行payload，获取root权限

总而言之，该漏洞利用的有效性较高，但投毒风险相对较低。利用方式涉及发送恶意的 D-Bus 消息并利用竞争条件绕过认证检查，最终提升权限。

**项目地址:** [0dayNinja/CVE-2021-3560](https://github.com/0dayNinja/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #2

**来源**: [CVE-2021-3560-Almorabea_Polkit-exploit.md](../2021/CVE-2021-3560-Almorabea_Polkit-exploit.md)

## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，允许本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，目标系统安装了受影响版本的polkit，且使用systemd。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞允许本地未经授权的用户通过绕过 D-Bus 请求的凭据检查，将权限提升为 root 用户。从提供的漏洞库信息和搜索结果来看，该漏洞影响 polkit 0.119 版本。提供的漏洞利用代码 `CVE-2021-3560.py` 利用了 accountsservice 提供的 D-Bus 接口的 `CreateUser` 和 `SetPassword` 方法，通过竞争条件（race condition）绕过 polkit 的权限验证，创建一个具有 root 权限的新用户（ahmed），然后设置该用户的密码，并通过 `su ahmed -c 'sudo su'` 命令切换到该用户，最终获得 root 权限。

**有效性：**
根据提供的 README 和代码中的注释以及搜索结果，该PoC代码是有效的，能够在受影响的系统上成功提权。

**投毒风险：**
分析提供的 PoC 代码，未发现明显的恶意或隐藏代码，该代码的目的是利用漏洞实现权限提升，该利用方式与漏洞描述相符，没有发现其他恶意行为，投毒风险为 0%。

**利用方式：**
1.  利用竞争条件尝试创建用户'ahmed'，绕过polkit的认证。
2.  成功创建用户后，设置用户'ahmed'的密码，同样利用竞争条件绕过polkit的认证。
3.  使用新创建的用户登录，并尝试使用`sudo su`命令提升到root权限。

**项目地址:** [Almorabea/Polkit-exploit](https://github.com/Almorabea/Polkit-exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #3

**来源**: [CVE-2021-3560-Antoine-MANTIS_POC-Bash-CVE-2021-3560.md](../2021/CVE-2021-3560-Antoine-MANTIS_POC-Bash-CVE-2021-3560.md)

## CVE-2021-3560-Polkit本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** <= 0.119

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560是一个Polkit的本地提权漏洞。根据漏洞库信息、搜索结果以及提供的POC代码，可以得出以下结论：

**有效性：**

POC代码的有效性很高。漏洞描述表明，未授权的本地用户可以通过利用D-Bus请求中的凭据检查绕过，从而获得root权限。 提供的PoC脚本正是通过D-Bus接口来创建用户并设置密码，利用竞态条件来绕过权限验证。

**投毒风险：**

POC代码的投毒风险很低，为0%。 代码主要完成以下操作：

1.  **创建用户：** 使用`dbus-send`命令尝试创建新用户。利用竞态条件，在polkit正确验证权限之前完成用户创建。
2.  **设置密码：** 创建用户后，脚本尝试设置新用户的密码。同样利用竞态条件，尝试绕过权限验证。
3. **循环尝试:** 脚本使用循环尝试创建用户和设置密码，直到成功或达到最大尝试次数。

代码中没有发现任何恶意或隐藏的代码。虽然脚本的目的是利用漏洞进行提权，但它本身不包含任何超出漏洞利用范围的恶意功能，如安装后门、删除文件或传播恶意软件。

**利用方式：**

利用方式如下：

1.  **竞态条件：** 该漏洞的核心在于竞态条件。攻击者通过快速、重复地发送D-Bus请求，尝试在Polkit完成权限验证之前执行操作。
2.  **创建用户：** POC通过`org.freedesktop.Accounts.CreateUser`接口尝试创建一个新用户，目标是绕过权限验证直接创建具有管理权限的用户。
3.  **设置密码：** 创建用户后，PoC尝试通过`org.freedesktop.Accounts.User.SetPassword`接口设置密码，使得创建的用户可以使用该密码登录。
4.  **本地提权：** 成功利用该漏洞后，攻击者可以使用新创建的用户登录，并利用`sudo`命令执行需要root权限的操作，从而实现本地提权。

**排序优先级说明：**

按照任务要求，排序优先级为：搜索引擎结果 > 漏洞利用代码 > 漏洞库信息。 虽然漏洞库信息提供了漏洞的基本描述，但搜索引擎结果提供了更全面的信息，包括漏洞的发现者、利用方法和缓解措施。 漏洞利用代码则直接展示了漏洞的利用方式。


**项目地址:** [Antoine-MANTIS/POC-Bash-CVE-2021-3560](https://github.com/Antoine-MANTIS/POC-Bash-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #4

**来源**: [CVE-2021-3560-AssassinUKG_Polkit-CVE-2021-3560.md](../2021/CVE-2021-3560-AssassinUKG_Polkit-CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可导致本地普通用户获取Root权限，造成数据泄露、完整性破坏和系统不可用

**影响版本:** polkit 0.119及受影响版本，如Ubuntu 20.04 (policykit-1 0.105-26ubuntu1)

**利用条件:** 本地用户，目标系统安装了受影响版本的Polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地未授权用户通过利用Polkit中的D-Bus消息处理缺陷，绕过身份验证并获得Root权限。攻击者首先构造一个D-Bus消息请求创建具有sudo权限的新账户或者设置密码，然后中断（kill）该消息，导致Polkit在尝试获取消息发送者用户ID时发生错误。由于Polkit错误地处理了此错误，会将用户ID替换为0（Root用户ID），从而允许未授权请求以Root权限执行。

**有效性评估：**

根据漏洞信息、搜索结果和POC代码，该漏洞利用方法是有效的。漏洞库信息明确指出该漏洞允许权限提升，搜索结果中多个链接指向了漏洞详情、利用方法以及受影响的Linux发行版。POC代码提供了详细的利用步骤，包括发送D-Bus消息、中断消息以及相关的命令示例。

**投毒风险评估：**

POC代码主要包含利用漏洞的脚本和说明文档。虽然该代码本身是用于权限提升，存在一定的滥用风险，但并**没有发现**明显的、作者额外添加的恶意后门或代码。例如，自动植入SSH密钥、创建隐藏账户等。因此，投毒风险较低。但是，由于利用该漏洞可以获得Root权限，攻击者获得Root权限后可进行任何恶意操作，不能排除利用漏洞进行投毒的可能性。作者提供的是漏洞利用的证明和方法，其目的在于重现和理解漏洞，而非植入后门，因此投毒概率较低，估计为10%。

**利用方式：**

1.  **发送D-Bus消息：** 使用`dbus-send`命令向`org.freedesktop.Accounts`发送消息，请求创建具有sudo权限的新用户，或者设置密码。示例：
    ```bash
    dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:attacker string:"Pentester Account" int32:1
    ```
2.  **中断D-Bus消息：** 在Polkit处理消息之前，使用`kill`命令中断消息。这会删除消息的唯一ID。
3.  **Polkit错误处理：** Polkit在尝试使用已删除的消息ID获取消息发送者用户ID时，会遇到错误。Polkit会错误地将用户ID替换为0（Root用户ID）。
4.  **权限提升：** Polkit认为Root用户发起了请求，因此允许未授权请求以Root权限执行，从而实现权限提升。

**项目地址:** [AssassinUKG/Polkit-CVE-2021-3560](https://github.com/AssassinUKG/Polkit-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #5

**来源**: [CVE-2021-3560-BizarreLove_CVE-2021-3560.md](../2021/CVE-2021-3560-BizarreLove_CVE-2021-3560.md)

## CVE-2021-3560-Polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致提权至root权限，控制系统

**影响版本:** polkit 0.119 及受影响的 Linux 发行版

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许未经授权的本地攻击者通过绕过 D-Bus 请求的凭据检查，将其权限提升到 root 用户。根据漏洞库信息和搜索引擎结果，该漏洞影响 polkit 0.119 版本，并且已被广泛利用。提供的 POC 代码通过 D-Bus 与 Polkit 交互，利用漏洞提升权限。利用过程大致如下：

1.  **连接 D-Bus：** POC 代码首先连接到系统 D-Bus。
2.  **构造恶意消息：** 构造一个特定的 D-Bus 消息，目标是 org.freedesktop.Accounts 服务，利用漏洞绕过权限验证。
3.  **利用漏洞：** 成功发送消息后，攻击者可以执行特权操作，例如创建新的管理员用户或修改系统配置。
4. **投毒风险分析:** POC代码包含了一些常规操作，如连接D-Bus、构造和发送消息，并未发现明显恶意代码或后门，但仍存在一定风险。check函数中存在检测操作系统版本及policykit版本的操作，如果check函数被篡改，可能导致未受到漏洞影响的系统被判定为存在漏洞，从而诱导用户执行提权操作。 另外，`cve-2021-3560_poc.c` 编译需要链接 `libdbus-1.so` 和 `libz.so`库，攻击者可能诱导用户链接恶意库文件实现代码注入。

**有效性：** 根据漏洞信息和公开的利用代码，该漏洞利用是有效的，并且已被CISA列入已知被利用漏洞目录。

**利用方式：** 攻击者可以利用此漏洞获取 root 权限，从而完全控制受影响的系统。


**项目地址:** [BizarreLove/CVE-2021-3560](https://github.com/BizarreLove/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #6

**来源**: [CVE-2021-3560-LucasPDiniz_CVE-2021-3560.md](../2021/CVE-2021-3560-LucasPDiniz_CVE-2021-3560.md)

## CVE-2021-3560 - polkit 权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可能导致本地用户获取root权限，造成数据泄露、完整性破坏和系统不可用

**影响版本:** polkit 0.113 及以后版本，部分Linux发行版（如RHEL 8, Ubuntu 20.04）

**利用条件:** 需要本地用户权限，目标系统运行存在漏洞的polkit版本，并且使用systemd和dbus

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过欺骗 polkit 绕过 D-Bus 请求的凭据检查，从而将请求者的权限提升到 root 用户。利用方式主要包括以下步骤：

1.  攻击者发送一个创建新用户或修改用户属性（例如，添加sudo权限）的D-Bus消息给 accounts-daemon。
2.  在 polkit 处理该消息之前，攻击者立即终止（kill）该 D-Bus 消息，销毁其唯一的 message ID。
3.  polkit 尝试从 dbus-daemon 获取发送消息的用户 ID，但由于 message ID 已被删除，dbus-daemon 返回错误。
4.  polkit 错误地将用户 ID 视为 0 (root 用户)，导致请求被以 root 权限执行。

**有效性：**

提供的 POC 代码描述了利用此漏洞的方法，通过手动发送 D-Bus 消息并在 polkit 验证之前终止消息，可以实现权限提升。漏洞库信息和搜索结果也证实了该漏洞的存在和利用方式，表明提供的 POC 代码具有有效性。

**投毒风险：**

虽然提供的 `README.md` 文件本身看起来是无害的，用于解释漏洞和提供利用示例，但是存在作者在其他地方（例如，在实际的攻击脚本中，如果存在）包含恶意代码的可能性。因为仅仅是一个描述文件，直接包含恶意代码可能性较低，但不能完全排除。因此，投毒风险评估为10%。如果存在配套的攻击脚本，则需要进一步审查，提高投毒风险评估。

**利用方式：**

该漏洞的利用方式是基于竞争条件，攻击者需要精确地控制 D-Bus 消息的发送和终止时机，才能成功欺骗 polkit。具体步骤如下：

1.  使用 `dbus-send` 命令构造一个需要 root 权限的操作请求（例如，创建新用户）。
2.  使用 `time` 命令测量该请求执行所需的时间。
3.  同时发送该请求和终止该请求的命令，并根据步骤2中测量的时间调整终止命令的延迟，以确保在 polkit 验证之前终止消息。
4.  如果利用成功，该操作将以 root 权限执行，从而实现权限提升。

**项目地址:** [LucasPDiniz/CVE-2021-3560](https://github.com/LucasPDiniz/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #7

**来源**: [CVE-2021-3560-MandipJoshi_CVE-2021-3560.md](../2021/CVE-2021-3560-MandipJoshi_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit 本地提权漏洞

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，可能导致任意用户提升至root权限

**影响版本:** polkit 0.119 (可能包括其他版本，需进一步验证)

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者通过操纵 D-Bus 请求绕过 Polkit 的凭据检查，从而获得 root 权限。提供的漏洞利用代码（polkit.py）通过以下步骤利用该漏洞：

1.  **检查环境:** 首先检查是否存在SSH连接，避免身份验证提示，同时检查polkit版本，确认是否为易受攻击的版本。
2.  **创建用户:** 脚本尝试通过 `dbus-send` 命令调用 `org.freedesktop.Accounts.CreateUser` 方法，快速重复创建用户，利用Polkit的竞争条件漏洞，绕过权限验证。
3.  **设置密码:** 成功创建用户后，脚本尝试使用 `org.freedesktop.Accounts.User.SetPassword` 方法为用户设置密码，同样利用竞争条件漏洞。

**有效性评估：**

根据漏洞信息和搜索结果，以及提供的POC代码，可以判断此漏洞利用是有效的。许多文章都提及了该漏洞的利用方式，并提供了POC代码。该漏洞已存在于 CISA 的已知可利用漏洞目录中，表明其已被广泛利用。

**投毒风险评估：**

代码中存在一定的投毒风险，但可能性较低(10%)。投毒代码可能存在于以下几个方面：

*   **随机数范围：** `random.uniform(0.006, 0.009)` 用于模拟竞争条件，如果这个范围被精心设计，可能会降低利用成功率或造成系统不稳定。
*   **循环次数：** 创建用户和设置密码的循环次数 (2000 和 200) 可能被修改为消耗大量资源或造成拒绝服务。
*   **错误处理：** 代码中的错误处理部分可能被修改为在特定条件下执行恶意代码。
*  **依赖注入:** 该脚本依赖于`dbus-send`工具和`apt`包管理器, 运行环境必须存在这些工具, 如果在没有这些工具的环境运行,脚本将直接退出.

总的来说，代码主要利用竞争条件，相对简单，隐藏恶意代码的空间有限，但仍需谨慎评估，在测试前进行代码审查。

**利用方式总结：**

该漏洞利用的核心在于通过竞争条件绕过 Polkit 的身份验证机制，从而执行需要 root 权限的操作。攻击者通过高频率地发送 D-Bus 请求，利用 Polkit 处理请求时的漏洞窗口，在未通过正确身份验证的情况下成功创建用户并设置密码，最终达到提权的目的。

**项目地址:** [MandipJoshi/CVE-2021-3560](https://github.com/MandipJoshi/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #8

**来源**: [CVE-2021-3560-NeonWhiteRabbit_CVE-2021-3560.md](../2021/CVE-2021-3560-NeonWhiteRabbit_CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，目标系统安装了存在漏洞的Polkit版本，并且运行了D-Bus服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者通过 D-Bus 请求绕过 Polkit 的凭据检查，从而将权限提升到 root 用户。

**有效性：**
提供的POC代码看起来是有效的。它通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户并设置密码。利用了Polkit在处理D-Bus请求时存在的缺陷，达到了提权的目的。

**投毒风险：**
虽然脚本的主要目的是利用漏洞进行提权，但仍存在一定的投毒风险。

1.  **用户创建行为：** 脚本会尝试创建一个名为`n3on`的用户。如果攻击者在受害者系统上成功执行此脚本，将会留下一个具有潜在后门的账户。虽设置密码为空，但攻击者也可以利用该账户进行进一步的渗透或破坏。
2.  **sudo -s 调用：** 脚本在最后调用了 `sudo -s`，强制切换到root用户。虽然看起来是为了方便用户在使用漏洞后立即获得root权限，但也可能被用于执行其他恶意命令。虽然whoami只是验证代码有效性
3.  **sleep 函数：** 脚本里存在 `sleep` 函数，会延迟脚本运行时间。如果攻击者恶意延长 `sleep` 的时间，可能会对系统造成拒绝服务攻击。

因此，虽然脚本的主要功能是漏洞利用，但其创建用户、执行 `sudo -s` 操作和存在sleep函数，都增加了潜在的风险。

**利用方式：**

1.  **D-Bus 交互：** 漏洞利用的核心在于通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务通信。`dbus-send` 用于发送方法调用到D-Bus总线上的服务。
2.  **用户创建：** 脚本多次尝试创建用户`n3on`。重复尝试结合kill来绕过 polkit 的某些安全检查。
3.  **密码设置：** 通过D-Bus调用`/org/freedesktop/Accounts/User1000`（假设User1000代表当前用户）的`SetPassword`方法，将密码设置为空字符串。这可能会导致用户账户安全风险。
4.  **提权：** 在成功创建用户后，脚本尝试通过`su n3on`切换到新创建的用户，然后使用 `sudo -s` 命令尝试获取 root 权限。

该漏洞利用方式的本质是利用Polkit对D-Bus消息处理的缺陷，绕过认证并执行特权操作。该漏洞利用的成功依赖于目标系统存在漏洞版本的Polkit，并且D-Bus服务正常运行。


**项目地址:** [NeonWhiteRabbit/CVE-2021-3560](https://github.com/NeonWhiteRabbit/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #9

**来源**: [CVE-2021-3560-RicterZ_CVE-2021-3560-Authentication-Agent.md](../2021/CVE-2021-3560-RicterZ_CVE-2021-3560-Authentication-Agent.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户可访问D-Bus

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞存在于 polkit 中，允许未经授权的本地攻击者通过绕过 D-Bus 请求的凭据检查，将权限提升为 root 用户。根据漏洞库信息，该漏洞的影响包括数据保密性、完整性和系统可用性。搜索结果表明，该漏洞已广泛公开，并且存在可利用的 POC。漏洞利用代码只包含Apache协议,没有发现任何有危害的代码。

**有效性：**
根据CISA已利用漏洞目录，该漏洞已被积极利用。从搜索结果来看，存在公开的利用代码，表明该漏洞可以有效利用。

**投毒风险：**
提供的漏洞利用代码仅包含 Apache 许可协议，没有发现任何可疑的恶意代码。因此，可以认为不存在投毒风险。

**利用方式：**
根据漏洞描述和搜索结果，漏洞利用方式主要涉及以下步骤：
1.  利用D-Bus与Polkit进行通信。
2.  构造特定的D-Bus请求，触发Polkit的漏洞，绕过身份验证。
3.  成功绕过身份验证后，以root权限执行任意命令。

**项目地址:** [RicterZ/CVE-2021-3560-Authentication-Agent](https://github.com/RicterZ/CVE-2021-3560-Authentication-Agent)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #10

**来源**: [CVE-2021-3560-SeimuPVE_CVE-2021-3560_Polkit.md](../2021/CVE-2021-3560-SeimuPVE_CVE-2021-3560_Polkit.md)

## CVE-2021-3560 Polkit 本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，本地用户可获得Root权限

**影响版本:** polkit 0.119 及之前版本（部分已打补丁）

**利用条件:** 本地用户权限，目标系统存在未修复的Polkit漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过操纵 D-Bus 请求绕过 Polkit 的身份验证检查，从而获得 Root 权限。提供的 Python 脚本通过检测目标系统 Polkit 版本，如果确认存在漏洞，则尝试利用该漏洞。该脚本首先检查当前用户是否为 Root 用户，然后检测操作系统信息和 Polkit 版本。根据版本信息判断是否存在漏洞。如果存在，则可以利用此漏洞获得root权限。

**有效性：**
提供的PoC代码看起来是有效的，它包含检测 Polkit 版本，检查是否为易受攻击的版本，以及进行利用的代码框架。参考链接（github.blog）也证实了该漏洞的存在以及利用方法。

**投毒风险：**
PoC代码本身逻辑清晰，主要用于检测和利用漏洞，未发现明显的恶意代码。可能的风险在于，脚本在执行某些命令时可能会受到环境变量的影响，导致执行意外的代码。脚本的目的是提升权限，因此在执行后可能留下后门或者修改系统设置，需要谨慎使用。

**利用方式：**
1.  脚本首先检测目标系统 Polkit 版本。
2.  如果版本属于易受攻击的范围，则利用漏洞绕过身份验证。
3.  利用成功后，攻击者可以执行需要 Root 权限的操作，例如创建新的管理员帐户或修改系统文件。

**项目地址:** [SeimuPVE/CVE-2021-3560_Polkit](https://github.com/SeimuPVE/CVE-2021-3560_Polkit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #11

**来源**: [CVE-2021-3560-TieuLong21Prosper_CVE-2021-3560.md](../2021/CVE-2021-3560-TieuLong21Prosper_CVE-2021-3560.md)

## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问，目标系统安装了存在漏洞的polkit版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者利用 polkit 中的缺陷绕过凭据检查，从而将权限提升为 root 用户。根据漏洞库信息和搜索结果，该漏洞已被广泛公开，并且存在可用的利用代码。提供的 Python POC 代码尝试通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户并设置密码。其利用方式是利用 polkit 对 D-Bus 请求处理的缺陷，绕过正常的身份验证流程。由于该POC代码目的明确，且没有发现任何尝试执行恶意操作，连接外部网络或者添加后门的迹象，因此，投毒风险评估为0%。

**利用方式：**

1.  利用 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户。 
2.  利用 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试设置用户密码。
3.  利用`su` 命令切换到创建的用户，然后使用 `sudo su`命令提升到 root 权限。

**有效性：**

该POC代码尝试创建用户并设置密码，如果成功，则可以利用新创建的用户登录并尝试提升权限，但是该POC 代码使用的创建用户的用户名是写死的，如果存在同名用户，则会利用失败，需要手动修改用户名，根据搜索结果，确认该漏洞已被积极利用,故该POC的有效性高。


**项目地址:** [TieuLong21Prosper/CVE-2021-3560](https://github.com/TieuLong21Prosper/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #12

**来源**: [CVE-2021-3560-UNICORDev_exploit-CVE-2021-3560.md](../2021/CVE-2021-3560-UNICORDev_exploit-CVE-2021-3560.md)

## CVE-2021-3560-polkit-本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户提权至root

**影响版本:** 0.0 - 0.118

**利用条件:** 本地用户权限，目标系统安装了存在漏洞的polkit版本，需要accountsservice, gnome-control-center, openssl, sudo

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 漏洞允许本地未经授权的攻击者通过绕过 D-Bus 请求的凭据检查来提升权限至 root 用户。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息表明该漏洞已被积极利用（KEV），并且存在公开可用的利用代码。

**投毒风险：**
代码中存在轻微的投毒风险，主要集中在以下几个方面：

1.  **依赖项安装：** Dockerfile中`apt install -y accountsservice gnome-control-center sudo openssl`命令确保了利用程序所需的依赖项已安装，但如果这些软件包的源被篡改，则可能引入恶意软件。虽然概率较低，但不能完全排除。
2.  **脚本执行：** exploit-CVE-2021-3560.py脚本从GitHub下载，如果GitHub仓库被攻陷，脚本可能被替换为恶意版本。用户应该审查下载的脚本，并验证其哈希值。

总体而言，直接的、明显的恶意代码（如反向shell或数据窃取）不存在。但是，由于脚本执行敏感操作（创建用户、修改密码、提升权限），即使是细微的偏差也可能导致安全问题，因此存在较低的投毒风险，这里评估为5%。

**利用方式：**

1.  **漏洞原理：** polkit在处理D-Bus请求时，由于未正确验证凭据，导致攻击者可以伪造请求，从而绕过身份验证。
2.  **利用步骤：**
    *   攻击者使用提供的exploit-CVE-2021-3560.py脚本，指定用户名和密码（可选）。
    *   脚本利用漏洞，在系统中创建一个具有sudo权限的新用户。
    *   攻击者可以使用新创建的用户通过`su`命令切换到该用户，然后使用`sudo su`命令获得root权限。
3.  **缓解措施：**
    *   将polkit升级到已修复的版本。
    *   限制对D-Bus的访问。
    *   监控系统中的异常用户创建和提权行为。

**项目地址:** [UNICORDev/exploit-CVE-2021-3560](https://github.com/UNICORDev/exploit-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #13

**来源**: [CVE-2021-3560-WinMin_CVE-2021-3560.md](../2021/CVE-2021-3560-WinMin_CVE-2021-3560.md)

## CVE-2021-3560-Polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** polkit 0.119

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 允许本地非特权用户通过欺骗 polkit 绕过 D-Bus 请求的凭据检查，从而将权限提升为 root 用户。漏洞利用方式如下：

1.  **漏洞原理：** Polkit 在处理 D-Bus 请求时，由于某些逻辑错误，未正确验证请求者的身份，导致可以伪造身份进行操作。
2.  **利用方式：** PoC 代码通过创建一个恶意的身份验证代理（Authentication Agent），并将其注册到 Polkit。该代理在接收到来自 Polkit 的身份验证请求时，会始终返回成功，从而允许攻击者执行需要 root 权限的操作。
3.  **代码分析：**
    *   `Makefile`：编译 `exploit.c`，链接必要的库 (`dbus-1`, `dbus-glib-1`, `gio-2.0`)。
    *   `README.md`：提供了漏洞的简要描述和使用方法。
    *   `agent.c`：实现了 D-Bus 接口 `org.freedesktop.PolicyKit1.AuthenticationAgent`，用于注册和处理来自 Polkit 的身份验证请求。关键函数 `auth_agent_handle_method_call` 接收来自 Polkit 的认证请求并发送认证通过的消息。
4.  **有效性：** PoC 代码有效，可以成功利用该漏洞。
5.  **投毒风险：** PoC 代码本身是直接利用漏洞，**潜在投毒点** 可能存在于以下方面：
    *   `agent.c`中，攻击者可能会在身份验证代理中添加额外的恶意代码，例如，在成功获得 root 权限后，执行某些恶意操作（例如安装后门、窃取数据等）。但根据目前的分析， `agent.c` 代码中没有明显的恶意行为，只是简单地模拟了认证过程。
    *   `Makefile`中，攻击者可能会修改编译选项，例如添加 `-fplugin=...` 引入恶意编译插件，或者链接额外的恶意库。当前`Makefile`没有发现异常。
    因此，认为存在小概率投毒风险，可能性为5%。主要是因为攻击者可能会在 PoC 代码中添加额外的恶意行为。
6.  **漏洞修复：** 升级 Polkit 到修复版本。

**项目地址:** [WinMin/CVE-2021-3560](https://github.com/WinMin/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #14

**来源**: [CVE-2021-3560-aancw_polkit-auto-exploit.md](../2021/CVE-2021-3560-aancw_polkit-auto-exploit.md)

## CVE-2021-3560-polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地普通用户获取root权限

**影响版本:** polkit 0.119及更早版本，受影响发行版包括RHEL 8、Ubuntu 20.04等

**利用条件:** 本地用户可以访问D-Bus

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过绕过 polkit 的身份验证检查来提升权限，最终获得 root 权限。根据提供的漏洞信息和搜索引擎结果，此漏洞影响多个 Linux 发行版。利用方式是攻击者通过 D-Bus 向 polkit 发送特权操作请求，利用 polkit 验证逻辑中的缺陷，绕过身份验证，从而执行特权操作。

**漏洞利用的有效性：**

根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以确认该漏洞利用是有效的。搜索引擎结果中包含大量关于该漏洞的分析、利用方法和受影响的发行版的信息，表明该漏洞具有实际可利用性。提供的 PoC 代码也证实了这一点。

**投毒风险：**

提供的 PoC 代码包含以下文件：LICENSE, README.md, go.mod 和一个可执行文件。 README.md 文件描述了漏洞的利用方法，并提供了示例用法。代码使用 `accountsservice` 的两个特权方法 `CreateUser` 和 `SetPassword` 来创建一个具有 sudo 权限的新用户，然后使用新用户登录并获得 root 权限。代码逻辑本身并没有明显的恶意行为。然而，仍存在一定的投毒风险：

1.  **隐藏的后门：** 虽然快速浏览代码没有发现明显后门，但由于 PoC 代码是用 Go 语言编写的，且未提供完整的源代码，无法完全排除在编译后的二进制文件中植入后门的可能。后门可能会在用户不知情的情况下执行恶意操作，例如收集系统信息、安装恶意软件等。
2.  **依赖风险：** `go.mod` 文件表明代码使用了 Go 语言的模块管理系统。如果 PoC 代码依赖了不安全的第三方模块，攻击者可能会通过篡改这些模块来引入恶意代码。
3. **延时触发:** 可能存在一些延时触发的恶意代码，这些代码可能需要满足特定条件才会执行。

因此，虽然直接证据不多，但考虑到安全风险，仍然认为此 PoC 存在一定比例的投毒风险。更完整的代码分析和代码审计才能对此做出更准确的评估。

**漏洞利用方式：**

1.  **利用 D-Bus 接口：** 攻击者利用 polkit 提供的 D-Bus 接口发送特权操作请求。
2.  **绕过身份验证：** 通过某种手段绕过 polkit 的身份验证检查。
3.  **执行特权操作：** 成功绕过身份验证后，攻击者可以执行原本需要授权才能执行的特权操作，例如创建用户、修改密码等。
4.  **提升权限：** 通过创建具有 sudo 权限的用户，或者修改现有用户的权限，最终获得 root 权限。

**项目地址:** [aancw/polkit-auto-exploit](https://github.com/aancw/polkit-auto-exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #15

**来源**: [CVE-2021-3560-admin-079_CVE-2021-3560.md](../2021/CVE-2021-3560-admin-079_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit 本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致未经授权的本地用户获取 root 权限，影响数据机密性、完整性和系统可用性。

**影响版本:** polkit 0.119 及更早版本 (根据漏洞库信息，POC 针对 0.113 及更高版本)

**利用条件:** 本地用户访问受影响的 Polkit 服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 是 Polkit 中的一个权限提升漏洞，攻击者可以通过绕过 D-Bus 请求的凭据检查，将请求者的权限提升到 root 用户。提供的 POC 代码利用了此漏洞，通过 dbus-send 命令与 Polkit 服务进行交互，创建用户并修改密码，从而获得 root 权限。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个已知的且被积极利用的漏洞。提供的 POC 代码旨在利用此漏洞。github blog的搜索结果也佐证了这一点，github上也有相关的复现仓库，快速利用可以获得系统ROOT权限.

**投毒风险：**
分析 POC 代码，代码主要功能是利用 dbus-send 命令创建用户并修改密码。代码中没有发现任何明显的恶意代码或后门。该脚本的功能就是创建一个新用户并通过漏洞提权，并不存在植入恶意程序或者其他恶意行为。因此，投毒风险较低，估计为 0%。代码的作者署名信息明确，并且提供了参考链接，可以追溯漏洞的来源和原理，进一步降低了投毒的可能性。

**利用方式：**
1.  **创建用户：** 使用 `dbus-send` 命令，通过 `org.freedesktop.Accounts.CreateUser` 方法创建一个新用户（默认为 flash）。
2.  **设置密码：** 获取新创建用户的 UID，然后使用 `dbus-send` 命令，通过 `org.freedesktop.Accounts.User.SetPassword` 方法设置用户的密码。由于漏洞的存在，可以绕过身份验证，直接设置密码。
3.  **提权：** 多次运行密码修改的命令，利用竞争条件，可以利用polkit缺陷将用户权限提升为ROOT。
4.  **登录：** 使用新创建的用户和设置的密码登录系统，此时该用户拥有 root 权限。

**优先级排序依据：**
按照题目要求，搜索引擎结果的优先级最高，漏洞利用代码次之，漏洞库信息最低。
搜索结果中，GitHub 博客文章详细描述了漏洞的原理和利用方法。漏洞利用代码展示了具体的利用步骤。漏洞库信息提供了漏洞的基本信息和影响。


**项目地址:** [admin-079/CVE-2021-3560](https://github.com/admin-079/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #16

**来源**: [CVE-2021-3560-arcslash_exploit_CVE-2021-3560.md](../2021/CVE-2021-3560-arcslash_exploit_CVE-2021-3560.md)

## CVE-2021-3560-polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地普通用户提升至root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户，目标系统安装受影响版本的polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地未经授权的用户通过利用 polkit 中的缺陷，获得 root 权限。漏洞原理是利用了 polkit 在处理 D-Bus 请求时对凭据检查的绕过。

**漏洞利用有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞确实存在并且有公开的利用方式。该漏洞已被CISA列入已知被利用的漏洞目录(KEV)。提供的POC代码利用了竞态条件，通过在 `org.freedesktop.Accounts.CreateUser` 方法执行期间的特定时间点终止 `dbus-send` 进程来绕过权限检查，从而创建具有 root 权限的用户。

**投毒风险分析：**
虽然脚本主要功能是实现权限提升，但也存在一定的投毒风险。

*   **用户创建和密码设置：** 脚本会尝试创建一个名为 john 的用户，并设置密码 john@123。如果攻击者在不知情的情况下直接使用该脚本，可能导致系统上存在一个已知的后门账号。
*   **定时炸弹风险：** 理论上，攻击者可以在脚本中添加延时执行的恶意代码，或者根据特定条件触发恶意行为，但当前的脚本并没有发现这种行为。

综合来看，投毒风险较低，但使用者需要谨慎，避免在生产环境直接使用，应进行代码审计。

**漏洞利用方式：**

1.  **竞态条件利用：** 漏洞利用的核心是利用竞态条件。脚本首先测量 `dbus-send` 命令创建用户所需的时间。
2.  **进程中断：** 脚本随后并行执行 `dbus-send` 命令，并在大约一半的测量时间后终止 `dbus-send` 进程。
3.  **绕过权限检查：** 通过在特定时刻中断进程，可以绕过 polkit 的权限检查，从而允许创建具有管理员权限的用户。
4.  **密码设置：** 如果用户创建成功，脚本会尝试使用 `openssl` 生成密码哈希，并通过 `dbus-send` 设置用户密码。
5.  **多次尝试：** 由于竞态条件的不确定性，脚本会多次尝试该过程，以增加漏洞利用的成功率。

**项目地址:** [arcslash/exploit_CVE-2021-3560](https://github.com/arcslash/exploit_CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #17

**来源**: [CVE-2021-3560-asepsaepdin_CVE-2021-3560.md](../2021/CVE-2021-3560-asepsaepdin_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit Local Privilege Escalation

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地非特权用户获取root权限，导致数据泄露、完整性破坏和系统不可用。

**影响版本:** Polkit 0.0 - 0.118

**利用条件:** 本地访问，目标系统安装了存在漏洞的Polkit版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许本地非特权用户通过绕过D-Bus请求的凭据检查来提升权限至root。提供的PoC代码通过利用此漏洞，创建一个具有指定用户名和密码的新的本地管理员。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出 Polkit 可以被欺骗绕过凭据检查，从而提升权限。搜索引擎结果也证实了该漏洞的存在，并提供了相关的利用文章和修复方案。提供的 PoC 代码也展示了如何利用该漏洞创建一个新的本地管理员。

**投毒风险：**

评估PoC代码，风险主要体现在以下几个方面：

*   **依赖安装风险：** PoC代码需要安装一些依赖，例如`gnome-control-center`, `openssl`, `sudo`，而这些依赖的安装过程可能存在风险。
*   **脚本执行风险：**  直接执行未经验证的PoC脚本始终存在潜在风险。攻击者可能在脚本中添加恶意代码，例如，删除系统关键文件、安装后门程序等。尽管目前代码没有发现恶意行为，但需要保持警惕。
*   **github仓库风险：** git clone仓库时，如果github仓库被攻陷，可能下载到被投毒的代码。

综合考虑，投毒风险评定为10%。这个百分比反应的是执行未经审查的第三方PoC代码的固有风险，而不是代码中存在明显恶意行为的确定性。

**利用方式：**

1.  **克隆PoC代码：** 从GitHub仓库克隆漏洞利用代码。
2.  **安装依赖：**  安装脚本所需的依赖项，例如 `gnome-control-center`、`openssl` 和 `sudo`。
3.  **执行漏洞利用脚本：** 运行 `exploit-CVE-2021-3560.py` 脚本，并指定要创建的用户名和密码。脚本将利用 Polkit 的漏洞绕过权限验证，创建一个新的具有 root 权限的用户。
4.  **验证：**  使用新创建的用户登录系统，并验证是否具有 root 权限。

**项目地址:** [asepsaepdin/CVE-2021-3560](https://github.com/asepsaepdin/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #18

**来源**: [CVE-2021-3560-chenaotian_CVE-2021-3560.md](../2021/CVE-2021-3560-chenaotian_CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，存在D-Bus总线和polkitd服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560是一个Polkit中的权限提升漏洞。该漏洞允许未经授权的本地用户通过欺骗Polkit绕过D-Bus请求的凭据检查，从而将权限提升为root用户。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的利用代码。CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞在野外被积极利用。提供的利用代码分析显示，利用方式是利用Polkit在处理D-Bus请求时的一个条件竞争漏洞，当D-Bus总线调用异常时，Polkit没有正确处理错误，导致将请求者的UID错误地设置为0（root用户），从而绕过权限验证。

**投毒风险：**

评估提供的POC代码是否存在投毒风险需要仔细审查代码实现。考虑到代码主要关注利用条件竞争绕过权限验证，直接植入恶意后门的概率较低。但是，仍然存在一些潜在的投毒方式，例如：

*   **微妙的修改：** 作者可能在利用代码中添加了看似无害但实际上会执行恶意操作的代码片段。例如，在权限提升后执行某些系统命令，或者修改某些配置文件。
*   **依赖项：** 作者可能引入了包含恶意代码的第三方库。
*   **触发条件：** 恶意代码可能只在特定条件下才会触发，从而避免被轻易检测到。

由于无法直接运行和调试代码，因此只能进行静态分析。根据目前的信息，评估投毒风险为10%，主要考虑的是潜在的隐蔽后门或恶意修改。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造一个特定的D-Bus请求，该请求会被Polkit处理。
2.  **竞争条件：** 攻击者需要利用条件竞争，使D-Bus总线调用失败并返回错误。
3.  **权限提升：** 由于Polkit未能正确处理错误，导致将请求者的UID错误地设置为0（root用户）。
4.  **执行恶意操作：** 攻击者现在拥有root权限，可以执行任何操作，例如创建新的管理员帐户，修改系统文件，或者安装恶意软件。

总而言之，CVE-2021-3560是一个严重的安全漏洞，应该尽快修补。在使用任何公开的利用代码之前，都应该仔细审查代码，以确保其安全性。

**项目地址:** [chenaotian/CVE-2021-3560](https://github.com/chenaotian/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #19

**来源**: [CVE-2021-3560-cpu0x00_CVE-2021-3560.md](../2021/CVE-2021-3560-cpu0x00_CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可使本地低权限用户获得root权限

**影响版本:** Polkit 0.119

**利用条件:** 本地用户，目标系统安装并运行存在漏洞的Polkit版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 允许攻击者通过绕过 D-Bus 请求的凭据检查，将请求者的权限提升为 root 用户。漏洞利用方式如下：

1.  **漏洞描述：** Polkit 在处理 D-Bus 请求时，存在身份验证绕过漏洞，攻击者可以利用该漏洞以 root 身份执行操作。
2.  **利用方式分析：**
    *   提供的`exploit.sh`脚本尝试利用该漏洞添加用户和设置密码。
    *   脚本通过`dbus-send`命令与`org.freedesktop.Accounts`服务进行交互，尝试创建用户和修改密码。
    *   脚本的实现利用了一个竞争条件，尝试在服务响应前终止连接，从而绕过权限验证。
3.  **有效性：** 根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的利用代码。提供的POC脚本尝试利用时间竞争，如果目标环境满足竞争条件的要求，则POC可能是有效的。
4.  **投毒风险：**
    *   `README.md`文件只包含漏洞名称和CTF的描述，未发现任何可疑代码。
    *   `exploit.sh`脚本本身没有发现明显的恶意代码，其行为符合漏洞利用的预期。虽然脚本尝试利用竞争条件，但这不是恶意投毒行为，而是利用漏洞的手段。
    *   因此，判断该仓库中不存在作者隐藏的投毒代码的可能性为0%。
5.  **利用方式总结：** 攻击者利用Polkit的身份验证绕过漏洞，通过构造特定的D-Bus请求，在请求处理过程中利用竞争条件，绕过权限验证，从而创建具有root权限的用户或者执行其他需要root权限的操作，最终提升到root权限。

总体而言，此漏洞是一个严重的安全问题，应该尽快修补。

**项目地址:** [cpu0x00/CVE-2021-3560](https://github.com/cpu0x00/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #20

**来源**: [CVE-2021-3560-f4T1H21_CVE-2021-3560-Polkit-DBus.md](../2021/CVE-2021-3560-f4T1H21_CVE-2021-3560-Polkit-DBus.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 允许本地未经授权的用户通过欺骗 polkit 的 D-Bus 请求凭据检查来提升权限至 root 用户。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞已被证实存在，并有公开的利用代码。

**投毒风险：**
提供的漏洞利用代码是 GNU GPL 许可证文本，并非实际的漏洞利用程序。因此，无法从中判断是否存在投毒代码。实际的利用代码可能包含恶意行为，需要进一步分析。

**利用方式：**
该漏洞利用方式为：利用Polkit的缺陷，通过精心构造的D-Bus请求绕过认证，从而以root权限执行操作。攻击者可以利用这个漏洞创建新的本地管理员或执行其他特权操作。

**总结：**
漏洞本身有效，但提供的代码片段仅为许可证，无法直接评估其安全性。实际利用时需要警惕可能存在的恶意代码。

**项目地址:** [f4T1H21/CVE-2021-3560-Polkit-DBus](https://github.com/f4T1H21/CVE-2021-3560-Polkit-DBus)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #21

**来源**: [CVE-2021-3560-hakivvi_CVE-2021-3560.md](../2021/CVE-2021-3560-hakivvi_CVE-2021-3560.md)

## CVE-2021-3560 - polkit 权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，允许本地非特权用户获得root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问，目标系统安装受影响版本的polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 是 polkit 中的一个认证绕过漏洞。该漏洞源于 `polkit_system_bus_name_get_creds_sync` 函数在获取调用者的 UID 和 PID 时存在缺陷。当调用 `GetConnectionUnixUser` 和 `GetConnectionUnixProcessID` 方法时，即使发生错误，`data.uid` 和 `data.pid` 仍然可能保持为初始化的零值。由于 polkit 认为 UID 为 0 的用户是 root 用户，因此可以绕过权限检查，从而允许非特权用户执行特权操作。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用是有效的。漏洞库信息明确指出该漏洞允许权限提升，并且CISA已将其添加到已知被利用的漏洞目录中。搜索引擎结果中也存在大量关于此漏洞的描述和利用方法。提供的POC代码描述了利用此漏洞的详细过程，包括利用D-Bus调用`CreateUser`和`SetPassword`等特权方法创建具有root权限的用户。

**投毒风险分析：**
提供的POC代码主要是C代码的解释和利用方法的描述，以及一些调用D-Bus的命令示例。从readme文件来看，它旨在通过accountsservice创建和设置密码来提升权限。虽然没有发现明显的恶意代码，但任何下载和编译的第三方代码都存在一定的风险。此外，攻击者可能修改漏洞利用代码，例如更改创建的用户名，使其更具隐蔽性或恶意性。例如，可以将用户名设置成和系统服务名称类似，以此来混淆管理员的视线。

**利用方式分析：**
1.  利用 D-Bus 向 polkit 发送特权方法调用请求（如 accountsservice 提供的 `CreateUser` 和 `SetPassword`）。
2.  利用漏洞绕过 polkit 的认证检查。
3.  polkit 错误地将非特权用户识别为 root 用户，从而允许执行特权方法。
4.  攻击者通过创建具有 root 权限的用户或修改现有用户的密码来获得系统控制权。

**投毒风险评估百分比：**
虽然README.md中提供的代码片段本身没有明显的恶意代码，但考虑到任何第三方提供的未经验证的代码都存在潜在风险，因此投毒风险评估为10%。 这个数值表示作者可能在完整代码或编译过程中隐藏恶意行为，但目前的代码片段本身看起来是合法的漏洞利用。

**项目地址:** [hakivvi/CVE-2021-3560](https://github.com/hakivvi/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #22

**来源**: [CVE-2021-3560-iSTAR-Lab_CVE-2021-3560_PoC.md](../2021/CVE-2021-3560-iSTAR-Lab_CVE-2021-3560_PoC.md)

## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** polkit 0.119

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地非特权用户通过欺骗 polkit 的 D-Bus 请求的凭据检查，从而将权限提升为 root 用户。该漏洞的利用方式是：

1.  **漏洞原理：** polkit 在处理 D-Bus 请求时，存在认证绕过缺陷，导致可以绕过授权检查。
2.  **利用方式：** PoC 脚本通过 D-Bus 接口尝试创建用户 `polkitroot`，并设置密码。利用时间竞争漏洞，在创建用户的过程中，尝试设置密码，从而绕过权限验证，最终成功创建一个具有 root 权限的用户。
3.  **有效性：** 从漏洞描述和搜索引擎结果来看，该漏洞存在且危害较大。提供的 PoC 代码针对特定版本（如 Ubuntu 20.04）有效，但可能需要在其他 Linux 发行版上进行调整。
4.  **投毒风险：** 脚本本身尝试创建一个名为 `polkitroot` 的用户并赋予其 root 权限。这本身就是利用漏洞的目的，但也可以被认为是后门。潜在的投毒风险在于脚本中的睡眠时间 (`sleep 0${half}s`) 和创建用户的重试机制。虽然脚本试图通过这些机制来提高利用成功率，但恶意攻击者可能会修改这些参数，使其在特定环境下执行恶意操作。例如，修改睡眠时间可能会导致拒绝服务攻击。脚本中的错误处理可能存在缺陷，导致在利用失败的情况下留下未清理的临时文件或异常状态，为后续攻击提供便利。

综合考虑，PoC 脚本主要用于演示漏洞，但存在一定的投毒风险，需要谨慎使用。

*投毒风险估算依据：*
*   90%代码是利用漏洞的代码，功能明确。
*   10%的代码可能存在隐藏风险，例如时间竞争相关的参数调整，可能被用于特定环境下的恶意行为。

**项目地址:** [iSTAR-Lab/CVE-2021-3560_PoC](https://github.com/iSTAR-Lab/CVE-2021-3560_PoC)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #23

**来源**: [CVE-2021-3560-innxrmxst_CVE-2021-3560.md](../2021/CVE-2021-3560-innxrmxst_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可导致本地普通用户提升为root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问权限，目标系统安装了受影响版本的Polkit

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过欺骗Polkit绕过凭据检查，从而将权限提升为root。该漏洞利用方式涉及使用dbus-send命令与org.freedesktop.Accounts服务进行交互，尝试快速创建用户，并在创建用户成功后，尝试通过类似的dbus调用来设置密码。攻击利用了Polkit在处理D-Bus请求时的漏洞，通过竞态条件或超时机制绕过权限验证。漏洞利用代码尝试创建用户'ahmed'，然后尝试设置其密码，最后尝试以该用户身份执行'sudo su'来获得root权限。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的PoC代码试图通过高频率的dbus调用来触发Polkit的漏洞，从而提升权限，该PoC代码是有效的，如果目标系统满足漏洞存在的条件。

**投毒风险：**
PoC代码主要由dbus-send命令组成，用于与systemd交互。虽然代码本身的目的在于利用漏洞，但潜在的投毒风险较低。风险点在于循环体中进程的创建和销毁，如果利用代码本身存在恶意修改，例如，在成功创建用户之后执行其他恶意操作，或者修改密码设置的逻辑以植入后门，则存在一定的投毒风险。从代码内容本身判断，投毒风险为1%，因为其行为模式符合漏洞利用的预期，且未发现明显的恶意代码。

**利用方式：**
1.  利用dbus-send命令与org.freedesktop.Accounts服务通信。
2.  尝试通过竞争条件或超时绕过身份验证。
3.  创建具有已知用户名的用户（例如 'ahmed'）。
4.  尝试为该用户设置密码。
5.  使用新创建的用户和sudo提升权限到root用户。

**项目地址:** [innxrmxst/CVE-2021-3560](https://github.com/innxrmxst/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #24

**来源**: [CVE-2021-3560-markyu0401_CVE-2021-3560-Polkit-Privilege-Escalation.md](../2021/CVE-2021-3560-markyu0401_CVE-2021-3560-Polkit-Privilege-Escalation.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可导致本地用户获取root权限，影响数据保密性、完整性和系统可用性

**影响版本:** polkit 0.119 (受影响版本)

**利用条件:** 需要本地访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许未经授权的本地用户通过利用 Polkit 中的缺陷绕过 D-Bus 请求的凭证检查，从而提升至 root 权限。漏洞利用代码通过发送精心构造的 D-Bus 消息，诱导 Polkit 产生竞争条件，从而错误地发出授权消息，绕过正常的身份验证过程。该漏洞利用依赖于精确的时间控制和多次尝试。 

**利用方式：**

1.  **竞争条件：** 利用 `dbus-send` 命令向 `org.freedesktop.Accounts` 发送 `CreateUser` 方法调用，同时使用 `sleep` 和 `kill` 命令模拟中断，创建竞争条件。
2.  **用户创建：** 通过重复发送带有中断的 `CreateUser` 请求，尝试在 Polkit 内部状态不一致时创建用户。
3.  **密码设置：** 成功创建用户后，使用 `openssl passwd` 生成密码哈希，并通过类似的竞争条件方式，利用 `dbus-send` 和 `SetPassword` 方法设置新用户的密码。
4.  **权限切换：** 使用 `su` 命令切换到新创建的用户，并使用 `sudo` 命令验证权限提升。

**有效性：**

提供的漏洞利用代码基于时间竞争，因此需要多次尝试才能成功。考虑到CISA的KEV条目以及大量公开可用的利用程序和漏洞分析，该PoC代码被认为是有效的。

**投毒风险：**

风险评估是基于以下因素：

1.  **代码复杂性：**  脚本相对简单，主要依赖于标准的 `dbus-send` 命令和 shell 脚本。
2.  **作者意图：**  作者提供了构建和运行容器的说明，这似乎是为了方便漏洞测试，而不是隐藏恶意代码。
3.  **可疑行为：**  在 `README.md` 中有执行时间的提示以及需要多次执行的步骤，这符合竞争条件漏洞利用的特征。
4. **潜在的投毒点:** PoC的有效性依赖于`sleep`命令的参数，即X.XXX的取值。如果该值被篡改为非常大的值，可能导致拒绝服务攻击。但是，这更像是可用性问题，而不是后门或者提权。另一种可能的攻击是替换`openssl passwd`为恶意程序。最后，构建容器的Dockerfile可能包含后门（例如，安装恶意软件包）。

基于以上分析，虽然存在一定的投毒风险（例如，替换 `openssl passwd` 命令），但主要风险在于利用过程的复杂性和对环境的依赖性。假设容器构建过程可信，没有发现明显的恶意代码。因此，投毒风险被评估为 10%。

**项目地址:** [markyu0401/CVE-2021-3560-Polkit-Privilege-Escalation](https://github.com/markyu0401/CVE-2021-3560-Polkit-Privilege-Escalation)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #25

**来源**: [CVE-2021-3560-pashayogi_ROOT-CVE-2021-3560.md](../2021/CVE-2021-3560-pashayogi_ROOT-CVE-2021-3560.md)

## CVE-2021-3560-Polkit-本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户提升权限至root

**影响版本:** polkit 0.105-26, polkit 0.117-2 和 polkit 0.119

**利用条件:** 本地用户需要SSH登录，而不是直接在桌面终端运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许本地未经授权的攻击者通过绕过 D-Bus 请求的凭据检查来提升权限至 root 用户。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC。
根据提供的PoC代码，该脚本尝试创建一个新用户，并设置密码。利用了Polkit在处理D-Bus请求时的漏洞，通过竞争条件来修改`/etc/shadow`文件，从而为新用户设置密码，并将其加入管理员组。

**投毒风险分析：**
查看 root.sh 脚本，该脚本主要功能是创建用户并修改 /etc/shadow 文件，逻辑较为清晰。
*   **用户创建:** 脚本首先检测是否存在目标用户，如果不存在则通过 `dbus-send` 创建用户。这里使用了竞争条件，通过并发的 `dbus-send` 请求和 `kill` 命令，试图绕过 Polkit 的权限验证。
*   **密码设置:** 脚本获取 `/etc/shadow` 文件的修改时间戳，然后循环尝试使用 `dbus-send` 修改用户的密码，同样利用了竞争条件。
*   **依赖:** 脚本依赖 `dbus-send`，`systemctl`, `stat`, `id`, `grep`, `cut`, `bc`, `sleep` 等常见的系统命令。
脚本中没有发现任何明显的恶意代码，例如反弹 shell，删除文件，或植入后门等操作。没有发现任何可以被判定为投毒的代码。
因此，投毒风险评估为 0%。

**利用方式：**
1.  **漏洞触发：**利用 Polkit 在处理 D-Bus 请求时的缺陷，绕过权限验证。
2.  **用户创建：**使用 `dbus-send` 命令尝试创建一个具有管理员权限的新用户。
3.  **密码设置：**通过竞争条件修改 `/etc/shadow` 文件，为新创建的用户设置密码。
4.  **权限提升：** 使用新创建的用户登录，并通过 `sudo su` 命令获得 root 权限。

**总结：** 提供的 PoC 代码是有效的，并且经过分析，没有发现明显的投毒风险。该漏洞允许本地普通用户提升权限至 root。

**项目地址:** [pashayogi/ROOT-CVE-2021-3560](https://github.com/pashayogi/ROOT-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #26

**来源**: [CVE-2021-3560-secnigma_CVE-2021-3560-Polkit-Privilege-Esclation.md](../2021/CVE-2021-3560-secnigma_CVE-2021-3560-Polkit-Privilege-Esclation.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.113及更高版本，或Debian fork的0-105-26

**利用条件:** 需要安装accountsservice和gnome-control-center，且在不支持图形登录的环境下运行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560是一个polkit中的权限提升漏洞。攻击者可以通过利用D-Bus请求中的凭据检查绕过，从而将请求者的权限提升为root用户。

**有效性评估：**
根据提供的漏洞库信息、搜索引擎结果和PoC代码，此漏洞的PoC代码是有效的。漏洞信息表明该漏洞已在野外被利用 (CISA KEV目录)，并且存在公开可用的PoC。

**投毒风险评估：**
PoC代码本身是一个bash脚本，主要用于自动化漏洞利用过程。虽然脚本会尝试注入一个新的sudo用户，但这种行为是漏洞利用的必要步骤，而非隐藏的恶意代码。然而，下载和运行任何来自不可信来源的脚本始终存在风险。因此，谨慎对待脚本，在受控环境中检查代码，是降低风险的措施。
仔细分析README.md的内容，投毒风险主要来自以下几个方面：
1.  **依赖性：** 脚本依赖于`accountsservice`和`gnome-control-center`的存在。虽然这些通常是标准组件，但如果环境缺少这些组件，脚本可能无法正常工作，或者产生意想不到的错误。
2.  **Timing依赖：** 漏洞利用依赖于精确的Timing。如果Timing不正确，漏洞利用会失败，并且可能需要多次尝试。
3.  **环境限制：** 脚本警告不要在图形登录环境运行，否则会导致polkit认证循环弹出。虽然这不是恶意行为，但可能造成拒绝服务。
4. **新增用户风险:** 脚本会在sudo组添加用户,如果该用户被攻击者控制,会导致系统被远程控制,存在风险.

**利用方式：**
1.  **漏洞触发：** 攻击者发送一个D-Bus消息来触发polkit。
2.  **连接中断：** 在polkit处理请求时，攻击者突然中断连接。
3.  **权限提升：** 攻击者使用之前的bus标识符发送第二个请求，由于polkit将断开连接的UID视为0，因此第二个请求会以root权限执行。
4. **添加sudo用户:** 攻击者利用root权限添加拥有sudo权限的用户。

总而言之，该PoC的目的是为了利用CVE-2021-3560漏洞，添加sudo用户以实现权限提升。尽管PoC本身的代码没有明显的恶意行为，但依旧存在一定的投毒风险，下载和使用需谨慎。


**项目地址:** [secnigma/CVE-2021-3560-Polkit-Privilege-Esclation](https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #27

**来源**: [CVE-2021-3560-titusG85_SideWinder-Exploit.md](../2021/CVE-2021-3560-titusG85_SideWinder-Exploit.md)

## CVE-2021-3560 Polkit 权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，本地权限提升至 root

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 存在于 polkit 中，允许未经授权的本地用户通过利用 D-Bus 请求的凭据检查绕过漏洞，从而将权限提升至 root 用户。漏洞利用涉及利用 polkit 中存在的竞态条件。给定的漏洞利用代码仓库包含了一个 README.md 文件，描述了如何利用该漏洞进行权限提升练习。虽然该练习着重于教育目的，但它仍然可能被滥用，风险系数较低，只有5%。投毒风险评估基于代码仓库中是否存在隐藏的恶意代码，或对原始漏洞利用代码的修改，目的是在目标系统上执行恶意操作，如安装后门或收集敏感信息。这里主要作为教育演示，因此投毒概率较低。

**利用方式：**

1.  **竞态条件：** 利用 polkit 处理 D-Bus 请求时的竞态条件。
2.  **权限提升：** 通过精心构造的 D-Bus 请求绕过权限验证，从而以 root 权限执行操作。
3.  **本地利用：** 漏洞利用通常发生在本地，攻击者需要具有本地用户访问权限。

**项目地址:** [titusG85/SideWinder-Exploit](https://github.com/titusG85/SideWinder-Exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---



---

## POC #7

**来源**: [CVE-2021-3560-LucasPDiniz_CVE-2021-3560.md](../2021/CVE-2021-3560-LucasPDiniz_CVE-2021-3560.md)

## CVE-2021-3560 - polkit 权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可能导致本地用户获取root权限，造成数据泄露、完整性破坏和系统不可用

**影响版本:** polkit 0.113 及以后版本，部分Linux发行版（如RHEL 8, Ubuntu 20.04）

**利用条件:** 需要本地用户权限，目标系统运行存在漏洞的polkit版本，并且使用systemd和dbus

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过欺骗 polkit 绕过 D-Bus 请求的凭据检查，从而将请求者的权限提升到 root 用户。利用方式主要包括以下步骤：

1.  攻击者发送一个创建新用户或修改用户属性（例如，添加sudo权限）的D-Bus消息给 accounts-daemon。
2.  在 polkit 处理该消息之前，攻击者立即终止（kill）该 D-Bus 消息，销毁其唯一的 message ID。
3.  polkit 尝试从 dbus-daemon 获取发送消息的用户 ID，但由于 message ID 已被删除，dbus-daemon 返回错误。
4.  polkit 错误地将用户 ID 视为 0 (root 用户)，导致请求被以 root 权限执行。

**有效性：**

提供的 POC 代码描述了利用此漏洞的方法，通过手动发送 D-Bus 消息并在 polkit 验证之前终止消息，可以实现权限提升。漏洞库信息和搜索结果也证实了该漏洞的存在和利用方式，表明提供的 POC 代码具有有效性。

**投毒风险：**

虽然提供的 `README.md` 文件本身看起来是无害的，用于解释漏洞和提供利用示例，但是存在作者在其他地方（例如，在实际的攻击脚本中，如果存在）包含恶意代码的可能性。因为仅仅是一个描述文件，直接包含恶意代码可能性较低，但不能完全排除。因此，投毒风险评估为10%。如果存在配套的攻击脚本，则需要进一步审查，提高投毒风险评估。

**利用方式：**

该漏洞的利用方式是基于竞争条件，攻击者需要精确地控制 D-Bus 消息的发送和终止时机，才能成功欺骗 polkit。具体步骤如下：

1.  使用 `dbus-send` 命令构造一个需要 root 权限的操作请求（例如，创建新用户）。
2.  使用 `time` 命令测量该请求执行所需的时间。
3.  同时发送该请求和终止该请求的命令，并根据步骤2中测量的时间调整终止命令的延迟，以确保在 polkit 验证之前终止消息。
4.  如果利用成功，该操作将以 root 权限执行，从而实现权限提升。

**项目地址:** [LucasPDiniz/CVE-2021-3560](https://github.com/LucasPDiniz/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #8

**来源**: [CVE-2021-3560-MandipJoshi_CVE-2021-3560.md](../2021/CVE-2021-3560-MandipJoshi_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit 本地提权漏洞

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，可能导致任意用户提升至root权限

**影响版本:** polkit 0.119 (可能包括其他版本，需进一步验证)

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者通过操纵 D-Bus 请求绕过 Polkit 的凭据检查，从而获得 root 权限。提供的漏洞利用代码（polkit.py）通过以下步骤利用该漏洞：

1.  **检查环境:** 首先检查是否存在SSH连接，避免身份验证提示，同时检查polkit版本，确认是否为易受攻击的版本。
2.  **创建用户:** 脚本尝试通过 `dbus-send` 命令调用 `org.freedesktop.Accounts.CreateUser` 方法，快速重复创建用户，利用Polkit的竞争条件漏洞，绕过权限验证。
3.  **设置密码:** 成功创建用户后，脚本尝试使用 `org.freedesktop.Accounts.User.SetPassword` 方法为用户设置密码，同样利用竞争条件漏洞。

**有效性评估：**

根据漏洞信息和搜索结果，以及提供的POC代码，可以判断此漏洞利用是有效的。许多文章都提及了该漏洞的利用方式，并提供了POC代码。该漏洞已存在于 CISA 的已知可利用漏洞目录中，表明其已被广泛利用。

**投毒风险评估：**

代码中存在一定的投毒风险，但可能性较低(10%)。投毒代码可能存在于以下几个方面：

*   **随机数范围：** `random.uniform(0.006, 0.009)` 用于模拟竞争条件，如果这个范围被精心设计，可能会降低利用成功率或造成系统不稳定。
*   **循环次数：** 创建用户和设置密码的循环次数 (2000 和 200) 可能被修改为消耗大量资源或造成拒绝服务。
*   **错误处理：** 代码中的错误处理部分可能被修改为在特定条件下执行恶意代码。
*  **依赖注入:** 该脚本依赖于`dbus-send`工具和`apt`包管理器, 运行环境必须存在这些工具, 如果在没有这些工具的环境运行,脚本将直接退出.

总的来说，代码主要利用竞争条件，相对简单，隐藏恶意代码的空间有限，但仍需谨慎评估，在测试前进行代码审查。

**利用方式总结：**

该漏洞利用的核心在于通过竞争条件绕过 Polkit 的身份验证机制，从而执行需要 root 权限的操作。攻击者通过高频率地发送 D-Bus 请求，利用 Polkit 处理请求时的漏洞窗口，在未通过正确身份验证的情况下成功创建用户并设置密码，最终达到提权的目的。

**项目地址:** [MandipJoshi/CVE-2021-3560](https://github.com/MandipJoshi/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #9

**来源**: [CVE-2021-3560-NeonWhiteRabbit_CVE-2021-3560.md](../2021/CVE-2021-3560-NeonWhiteRabbit_CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，目标系统安装了存在漏洞的Polkit版本，并且运行了D-Bus服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者通过 D-Bus 请求绕过 Polkit 的凭据检查，从而将权限提升到 root 用户。

**有效性：**
提供的POC代码看起来是有效的。它通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户并设置密码。利用了Polkit在处理D-Bus请求时存在的缺陷，达到了提权的目的。

**投毒风险：**
虽然脚本的主要目的是利用漏洞进行提权，但仍存在一定的投毒风险。

1.  **用户创建行为：** 脚本会尝试创建一个名为`n3on`的用户。如果攻击者在受害者系统上成功执行此脚本，将会留下一个具有潜在后门的账户。虽设置密码为空，但攻击者也可以利用该账户进行进一步的渗透或破坏。
2.  **sudo -s 调用：** 脚本在最后调用了 `sudo -s`，强制切换到root用户。虽然看起来是为了方便用户在使用漏洞后立即获得root权限，但也可能被用于执行其他恶意命令。虽然whoami只是验证代码有效性
3.  **sleep 函数：** 脚本里存在 `sleep` 函数，会延迟脚本运行时间。如果攻击者恶意延长 `sleep` 的时间，可能会对系统造成拒绝服务攻击。

因此，虽然脚本的主要功能是漏洞利用，但其创建用户、执行 `sudo -s` 操作和存在sleep函数，都增加了潜在的风险。

**利用方式：**

1.  **D-Bus 交互：** 漏洞利用的核心在于通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务通信。`dbus-send` 用于发送方法调用到D-Bus总线上的服务。
2.  **用户创建：** 脚本多次尝试创建用户`n3on`。重复尝试结合kill来绕过 polkit 的某些安全检查。
3.  **密码设置：** 通过D-Bus调用`/org/freedesktop/Accounts/User1000`（假设User1000代表当前用户）的`SetPassword`方法，将密码设置为空字符串。这可能会导致用户账户安全风险。
4.  **提权：** 在成功创建用户后，脚本尝试通过`su n3on`切换到新创建的用户，然后使用 `sudo -s` 命令尝试获取 root 权限。

该漏洞利用方式的本质是利用Polkit对D-Bus消息处理的缺陷，绕过认证并执行特权操作。该漏洞利用的成功依赖于目标系统存在漏洞版本的Polkit，并且D-Bus服务正常运行。


**项目地址:** [NeonWhiteRabbit/CVE-2021-3560](https://github.com/NeonWhiteRabbit/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #10

**来源**: [CVE-2021-3560-RicterZ_CVE-2021-3560-Authentication-Agent.md](../2021/CVE-2021-3560-RicterZ_CVE-2021-3560-Authentication-Agent.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户可访问D-Bus

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞存在于 polkit 中，允许未经授权的本地攻击者通过绕过 D-Bus 请求的凭据检查，将权限提升为 root 用户。根据漏洞库信息，该漏洞的影响包括数据保密性、完整性和系统可用性。搜索结果表明，该漏洞已广泛公开，并且存在可利用的 POC。漏洞利用代码只包含Apache协议,没有发现任何有危害的代码。

**有效性：**
根据CISA已利用漏洞目录，该漏洞已被积极利用。从搜索结果来看，存在公开的利用代码，表明该漏洞可以有效利用。

**投毒风险：**
提供的漏洞利用代码仅包含 Apache 许可协议，没有发现任何可疑的恶意代码。因此，可以认为不存在投毒风险。

**利用方式：**
根据漏洞描述和搜索结果，漏洞利用方式主要涉及以下步骤：
1.  利用D-Bus与Polkit进行通信。
2.  构造特定的D-Bus请求，触发Polkit的漏洞，绕过身份验证。
3.  成功绕过身份验证后，以root权限执行任意命令。

**项目地址:** [RicterZ/CVE-2021-3560-Authentication-Agent](https://github.com/RicterZ/CVE-2021-3560-Authentication-Agent)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #11

**来源**: [CVE-2021-3560-SeimuPVE_CVE-2021-3560_Polkit.md](../2021/CVE-2021-3560-SeimuPVE_CVE-2021-3560_Polkit.md)

## CVE-2021-3560 Polkit 本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，本地用户可获得Root权限

**影响版本:** polkit 0.119 及之前版本（部分已打补丁）

**利用条件:** 本地用户权限，目标系统存在未修复的Polkit漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过操纵 D-Bus 请求绕过 Polkit 的身份验证检查，从而获得 Root 权限。提供的 Python 脚本通过检测目标系统 Polkit 版本，如果确认存在漏洞，则尝试利用该漏洞。该脚本首先检查当前用户是否为 Root 用户，然后检测操作系统信息和 Polkit 版本。根据版本信息判断是否存在漏洞。如果存在，则可以利用此漏洞获得root权限。

**有效性：**
提供的PoC代码看起来是有效的，它包含检测 Polkit 版本，检查是否为易受攻击的版本，以及进行利用的代码框架。参考链接（github.blog）也证实了该漏洞的存在以及利用方法。

**投毒风险：**
PoC代码本身逻辑清晰，主要用于检测和利用漏洞，未发现明显的恶意代码。可能的风险在于，脚本在执行某些命令时可能会受到环境变量的影响，导致执行意外的代码。脚本的目的是提升权限，因此在执行后可能留下后门或者修改系统设置，需要谨慎使用。

**利用方式：**
1.  脚本首先检测目标系统 Polkit 版本。
2.  如果版本属于易受攻击的范围，则利用漏洞绕过身份验证。
3.  利用成功后，攻击者可以执行需要 Root 权限的操作，例如创建新的管理员帐户或修改系统文件。

**项目地址:** [SeimuPVE/CVE-2021-3560_Polkit](https://github.com/SeimuPVE/CVE-2021-3560_Polkit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #12

**来源**: [CVE-2021-3560-TieuLong21Prosper_CVE-2021-3560.md](../2021/CVE-2021-3560-TieuLong21Prosper_CVE-2021-3560.md)

## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问，目标系统安装了存在漏洞的polkit版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者利用 polkit 中的缺陷绕过凭据检查，从而将权限提升为 root 用户。根据漏洞库信息和搜索结果，该漏洞已被广泛公开，并且存在可用的利用代码。提供的 Python POC 代码尝试通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户并设置密码。其利用方式是利用 polkit 对 D-Bus 请求处理的缺陷，绕过正常的身份验证流程。由于该POC代码目的明确，且没有发现任何尝试执行恶意操作，连接外部网络或者添加后门的迹象，因此，投毒风险评估为0%。

**利用方式：**

1.  利用 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户。 
2.  利用 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试设置用户密码。
3.  利用`su` 命令切换到创建的用户，然后使用 `sudo su`命令提升到 root 权限。

**有效性：**

该POC代码尝试创建用户并设置密码，如果成功，则可以利用新创建的用户登录并尝试提升权限，但是该POC 代码使用的创建用户的用户名是写死的，如果存在同名用户，则会利用失败，需要手动修改用户名，根据搜索结果，确认该漏洞已被积极利用,故该POC的有效性高。


**项目地址:** [TieuLong21Prosper/CVE-2021-3560](https://github.com/TieuLong21Prosper/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #13

**来源**: [CVE-2021-3560-UNICORDev_exploit-CVE-2021-3560.md](../2021/CVE-2021-3560-UNICORDev_exploit-CVE-2021-3560.md)

## CVE-2021-3560-polkit-本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户提权至root

**影响版本:** 0.0 - 0.118

**利用条件:** 本地用户权限，目标系统安装了存在漏洞的polkit版本，需要accountsservice, gnome-control-center, openssl, sudo

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 漏洞允许本地未经授权的攻击者通过绕过 D-Bus 请求的凭据检查来提升权限至 root 用户。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息表明该漏洞已被积极利用（KEV），并且存在公开可用的利用代码。

**投毒风险：**
代码中存在轻微的投毒风险，主要集中在以下几个方面：

1.  **依赖项安装：** Dockerfile中`apt install -y accountsservice gnome-control-center sudo openssl`命令确保了利用程序所需的依赖项已安装，但如果这些软件包的源被篡改，则可能引入恶意软件。虽然概率较低，但不能完全排除。
2.  **脚本执行：** exploit-CVE-2021-3560.py脚本从GitHub下载，如果GitHub仓库被攻陷，脚本可能被替换为恶意版本。用户应该审查下载的脚本，并验证其哈希值。

总体而言，直接的、明显的恶意代码（如反向shell或数据窃取）不存在。但是，由于脚本执行敏感操作（创建用户、修改密码、提升权限），即使是细微的偏差也可能导致安全问题，因此存在较低的投毒风险，这里评估为5%。

**利用方式：**

1.  **漏洞原理：** polkit在处理D-Bus请求时，由于未正确验证凭据，导致攻击者可以伪造请求，从而绕过身份验证。
2.  **利用步骤：**
    *   攻击者使用提供的exploit-CVE-2021-3560.py脚本，指定用户名和密码（可选）。
    *   脚本利用漏洞，在系统中创建一个具有sudo权限的新用户。
    *   攻击者可以使用新创建的用户通过`su`命令切换到该用户，然后使用`sudo su`命令获得root权限。
3.  **缓解措施：**
    *   将polkit升级到已修复的版本。
    *   限制对D-Bus的访问。
    *   监控系统中的异常用户创建和提权行为。

**项目地址:** [UNICORDev/exploit-CVE-2021-3560](https://github.com/UNICORDev/exploit-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #14

**来源**: [CVE-2021-3560-WinMin_CVE-2021-3560.md](../2021/CVE-2021-3560-WinMin_CVE-2021-3560.md)

## CVE-2021-3560-Polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** polkit 0.119

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 允许本地非特权用户通过欺骗 polkit 绕过 D-Bus 请求的凭据检查，从而将权限提升为 root 用户。漏洞利用方式如下：

1.  **漏洞原理：** Polkit 在处理 D-Bus 请求时，由于某些逻辑错误，未正确验证请求者的身份，导致可以伪造身份进行操作。
2.  **利用方式：** PoC 代码通过创建一个恶意的身份验证代理（Authentication Agent），并将其注册到 Polkit。该代理在接收到来自 Polkit 的身份验证请求时，会始终返回成功，从而允许攻击者执行需要 root 权限的操作。
3.  **代码分析：**
    *   `Makefile`：编译 `exploit.c`，链接必要的库 (`dbus-1`, `dbus-glib-1`, `gio-2.0`)。
    *   `README.md`：提供了漏洞的简要描述和使用方法。
    *   `agent.c`：实现了 D-Bus 接口 `org.freedesktop.PolicyKit1.AuthenticationAgent`，用于注册和处理来自 Polkit 的身份验证请求。关键函数 `auth_agent_handle_method_call` 接收来自 Polkit 的认证请求并发送认证通过的消息。
4.  **有效性：** PoC 代码有效，可以成功利用该漏洞。
5.  **投毒风险：** PoC 代码本身是直接利用漏洞，**潜在投毒点** 可能存在于以下方面：
    *   `agent.c`中，攻击者可能会在身份验证代理中添加额外的恶意代码，例如，在成功获得 root 权限后，执行某些恶意操作（例如安装后门、窃取数据等）。但根据目前的分析， `agent.c` 代码中没有明显的恶意行为，只是简单地模拟了认证过程。
    *   `Makefile`中，攻击者可能会修改编译选项，例如添加 `-fplugin=...` 引入恶意编译插件，或者链接额外的恶意库。当前`Makefile`没有发现异常。
    因此，认为存在小概率投毒风险，可能性为5%。主要是因为攻击者可能会在 PoC 代码中添加额外的恶意行为。
6.  **漏洞修复：** 升级 Polkit 到修复版本。

**项目地址:** [WinMin/CVE-2021-3560](https://github.com/WinMin/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #15

**来源**: [CVE-2021-3560-aancw_polkit-auto-exploit.md](../2021/CVE-2021-3560-aancw_polkit-auto-exploit.md)

## CVE-2021-3560-polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地普通用户获取root权限

**影响版本:** polkit 0.119及更早版本，受影响发行版包括RHEL 8、Ubuntu 20.04等

**利用条件:** 本地用户可以访问D-Bus

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过绕过 polkit 的身份验证检查来提升权限，最终获得 root 权限。根据提供的漏洞信息和搜索引擎结果，此漏洞影响多个 Linux 发行版。利用方式是攻击者通过 D-Bus 向 polkit 发送特权操作请求，利用 polkit 验证逻辑中的缺陷，绕过身份验证，从而执行特权操作。

**漏洞利用的有效性：**

根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以确认该漏洞利用是有效的。搜索引擎结果中包含大量关于该漏洞的分析、利用方法和受影响的发行版的信息，表明该漏洞具有实际可利用性。提供的 PoC 代码也证实了这一点。

**投毒风险：**

提供的 PoC 代码包含以下文件：LICENSE, README.md, go.mod 和一个可执行文件。 README.md 文件描述了漏洞的利用方法，并提供了示例用法。代码使用 `accountsservice` 的两个特权方法 `CreateUser` 和 `SetPassword` 来创建一个具有 sudo 权限的新用户，然后使用新用户登录并获得 root 权限。代码逻辑本身并没有明显的恶意行为。然而，仍存在一定的投毒风险：

1.  **隐藏的后门：** 虽然快速浏览代码没有发现明显后门，但由于 PoC 代码是用 Go 语言编写的，且未提供完整的源代码，无法完全排除在编译后的二进制文件中植入后门的可能。后门可能会在用户不知情的情况下执行恶意操作，例如收集系统信息、安装恶意软件等。
2.  **依赖风险：** `go.mod` 文件表明代码使用了 Go 语言的模块管理系统。如果 PoC 代码依赖了不安全的第三方模块，攻击者可能会通过篡改这些模块来引入恶意代码。
3. **延时触发:** 可能存在一些延时触发的恶意代码，这些代码可能需要满足特定条件才会执行。

因此，虽然直接证据不多，但考虑到安全风险，仍然认为此 PoC 存在一定比例的投毒风险。更完整的代码分析和代码审计才能对此做出更准确的评估。

**漏洞利用方式：**

1.  **利用 D-Bus 接口：** 攻击者利用 polkit 提供的 D-Bus 接口发送特权操作请求。
2.  **绕过身份验证：** 通过某种手段绕过 polkit 的身份验证检查。
3.  **执行特权操作：** 成功绕过身份验证后，攻击者可以执行原本需要授权才能执行的特权操作，例如创建用户、修改密码等。
4.  **提升权限：** 通过创建具有 sudo 权限的用户，或者修改现有用户的权限，最终获得 root 权限。

**项目地址:** [aancw/polkit-auto-exploit](https://github.com/aancw/polkit-auto-exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #16

**来源**: [CVE-2021-3560-admin-079_CVE-2021-3560.md](../2021/CVE-2021-3560-admin-079_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit 本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致未经授权的本地用户获取 root 权限，影响数据机密性、完整性和系统可用性。

**影响版本:** polkit 0.119 及更早版本 (根据漏洞库信息，POC 针对 0.113 及更高版本)

**利用条件:** 本地用户访问受影响的 Polkit 服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 是 Polkit 中的一个权限提升漏洞，攻击者可以通过绕过 D-Bus 请求的凭据检查，将请求者的权限提升到 root 用户。提供的 POC 代码利用了此漏洞，通过 dbus-send 命令与 Polkit 服务进行交互，创建用户并修改密码，从而获得 root 权限。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个已知的且被积极利用的漏洞。提供的 POC 代码旨在利用此漏洞。github blog的搜索结果也佐证了这一点，github上也有相关的复现仓库，快速利用可以获得系统ROOT权限.

**投毒风险：**
分析 POC 代码，代码主要功能是利用 dbus-send 命令创建用户并修改密码。代码中没有发现任何明显的恶意代码或后门。该脚本的功能就是创建一个新用户并通过漏洞提权，并不存在植入恶意程序或者其他恶意行为。因此，投毒风险较低，估计为 0%。代码的作者署名信息明确，并且提供了参考链接，可以追溯漏洞的来源和原理，进一步降低了投毒的可能性。

**利用方式：**
1.  **创建用户：** 使用 `dbus-send` 命令，通过 `org.freedesktop.Accounts.CreateUser` 方法创建一个新用户（默认为 flash）。
2.  **设置密码：** 获取新创建用户的 UID，然后使用 `dbus-send` 命令，通过 `org.freedesktop.Accounts.User.SetPassword` 方法设置用户的密码。由于漏洞的存在，可以绕过身份验证，直接设置密码。
3.  **提权：** 多次运行密码修改的命令，利用竞争条件，可以利用polkit缺陷将用户权限提升为ROOT。
4.  **登录：** 使用新创建的用户和设置的密码登录系统，此时该用户拥有 root 权限。

**优先级排序依据：**
按照题目要求，搜索引擎结果的优先级最高，漏洞利用代码次之，漏洞库信息最低。
搜索结果中，GitHub 博客文章详细描述了漏洞的原理和利用方法。漏洞利用代码展示了具体的利用步骤。漏洞库信息提供了漏洞的基本信息和影响。


**项目地址:** [admin-079/CVE-2021-3560](https://github.com/admin-079/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #17

**来源**: [CVE-2021-3560-arcslash_exploit_CVE-2021-3560.md](../2021/CVE-2021-3560-arcslash_exploit_CVE-2021-3560.md)

## CVE-2021-3560-polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地普通用户提升至root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户，目标系统安装受影响版本的polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地未经授权的用户通过利用 polkit 中的缺陷，获得 root 权限。漏洞原理是利用了 polkit 在处理 D-Bus 请求时对凭据检查的绕过。

**漏洞利用有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞确实存在并且有公开的利用方式。该漏洞已被CISA列入已知被利用的漏洞目录(KEV)。提供的POC代码利用了竞态条件，通过在 `org.freedesktop.Accounts.CreateUser` 方法执行期间的特定时间点终止 `dbus-send` 进程来绕过权限检查，从而创建具有 root 权限的用户。

**投毒风险分析：**
虽然脚本主要功能是实现权限提升，但也存在一定的投毒风险。

*   **用户创建和密码设置：** 脚本会尝试创建一个名为 john 的用户，并设置密码 john@123。如果攻击者在不知情的情况下直接使用该脚本，可能导致系统上存在一个已知的后门账号。
*   **定时炸弹风险：** 理论上，攻击者可以在脚本中添加延时执行的恶意代码，或者根据特定条件触发恶意行为，但当前的脚本并没有发现这种行为。

综合来看，投毒风险较低，但使用者需要谨慎，避免在生产环境直接使用，应进行代码审计。

**漏洞利用方式：**

1.  **竞态条件利用：** 漏洞利用的核心是利用竞态条件。脚本首先测量 `dbus-send` 命令创建用户所需的时间。
2.  **进程中断：** 脚本随后并行执行 `dbus-send` 命令，并在大约一半的测量时间后终止 `dbus-send` 进程。
3.  **绕过权限检查：** 通过在特定时刻中断进程，可以绕过 polkit 的权限检查，从而允许创建具有管理员权限的用户。
4.  **密码设置：** 如果用户创建成功，脚本会尝试使用 `openssl` 生成密码哈希，并通过 `dbus-send` 设置用户密码。
5.  **多次尝试：** 由于竞态条件的不确定性，脚本会多次尝试该过程，以增加漏洞利用的成功率。

**项目地址:** [arcslash/exploit_CVE-2021-3560](https://github.com/arcslash/exploit_CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #18

**来源**: [CVE-2021-3560-asepsaepdin_CVE-2021-3560.md](../2021/CVE-2021-3560-asepsaepdin_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit Local Privilege Escalation

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地非特权用户获取root权限，导致数据泄露、完整性破坏和系统不可用。

**影响版本:** Polkit 0.0 - 0.118

**利用条件:** 本地访问，目标系统安装了存在漏洞的Polkit版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许本地非特权用户通过绕过D-Bus请求的凭据检查来提升权限至root。提供的PoC代码通过利用此漏洞，创建一个具有指定用户名和密码的新的本地管理员。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出 Polkit 可以被欺骗绕过凭据检查，从而提升权限。搜索引擎结果也证实了该漏洞的存在，并提供了相关的利用文章和修复方案。提供的 PoC 代码也展示了如何利用该漏洞创建一个新的本地管理员。

**投毒风险：**

评估PoC代码，风险主要体现在以下几个方面：

*   **依赖安装风险：** PoC代码需要安装一些依赖，例如`gnome-control-center`, `openssl`, `sudo`，而这些依赖的安装过程可能存在风险。
*   **脚本执行风险：**  直接执行未经验证的PoC脚本始终存在潜在风险。攻击者可能在脚本中添加恶意代码，例如，删除系统关键文件、安装后门程序等。尽管目前代码没有发现恶意行为，但需要保持警惕。
*   **github仓库风险：** git clone仓库时，如果github仓库被攻陷，可能下载到被投毒的代码。

综合考虑，投毒风险评定为10%。这个百分比反应的是执行未经审查的第三方PoC代码的固有风险，而不是代码中存在明显恶意行为的确定性。

**利用方式：**

1.  **克隆PoC代码：** 从GitHub仓库克隆漏洞利用代码。
2.  **安装依赖：**  安装脚本所需的依赖项，例如 `gnome-control-center`、`openssl` 和 `sudo`。
3.  **执行漏洞利用脚本：** 运行 `exploit-CVE-2021-3560.py` 脚本，并指定要创建的用户名和密码。脚本将利用 Polkit 的漏洞绕过权限验证，创建一个新的具有 root 权限的用户。
4.  **验证：**  使用新创建的用户登录系统，并验证是否具有 root 权限。

**项目地址:** [asepsaepdin/CVE-2021-3560](https://github.com/asepsaepdin/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #19

**来源**: [CVE-2021-3560-chenaotian_CVE-2021-3560.md](../2021/CVE-2021-3560-chenaotian_CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，存在D-Bus总线和polkitd服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560是一个Polkit中的权限提升漏洞。该漏洞允许未经授权的本地用户通过欺骗Polkit绕过D-Bus请求的凭据检查，从而将权限提升为root用户。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的利用代码。CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞在野外被积极利用。提供的利用代码分析显示，利用方式是利用Polkit在处理D-Bus请求时的一个条件竞争漏洞，当D-Bus总线调用异常时，Polkit没有正确处理错误，导致将请求者的UID错误地设置为0（root用户），从而绕过权限验证。

**投毒风险：**

评估提供的POC代码是否存在投毒风险需要仔细审查代码实现。考虑到代码主要关注利用条件竞争绕过权限验证，直接植入恶意后门的概率较低。但是，仍然存在一些潜在的投毒方式，例如：

*   **微妙的修改：** 作者可能在利用代码中添加了看似无害但实际上会执行恶意操作的代码片段。例如，在权限提升后执行某些系统命令，或者修改某些配置文件。
*   **依赖项：** 作者可能引入了包含恶意代码的第三方库。
*   **触发条件：** 恶意代码可能只在特定条件下才会触发，从而避免被轻易检测到。

由于无法直接运行和调试代码，因此只能进行静态分析。根据目前的信息，评估投毒风险为10%，主要考虑的是潜在的隐蔽后门或恶意修改。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造一个特定的D-Bus请求，该请求会被Polkit处理。
2.  **竞争条件：** 攻击者需要利用条件竞争，使D-Bus总线调用失败并返回错误。
3.  **权限提升：** 由于Polkit未能正确处理错误，导致将请求者的UID错误地设置为0（root用户）。
4.  **执行恶意操作：** 攻击者现在拥有root权限，可以执行任何操作，例如创建新的管理员帐户，修改系统文件，或者安装恶意软件。

总而言之，CVE-2021-3560是一个严重的安全漏洞，应该尽快修补。在使用任何公开的利用代码之前，都应该仔细审查代码，以确保其安全性。

**项目地址:** [chenaotian/CVE-2021-3560](https://github.com/chenaotian/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #20

**来源**: [CVE-2021-3560-cpu0x00_CVE-2021-3560.md](../2021/CVE-2021-3560-cpu0x00_CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可使本地低权限用户获得root权限

**影响版本:** Polkit 0.119

**利用条件:** 本地用户，目标系统安装并运行存在漏洞的Polkit版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 允许攻击者通过绕过 D-Bus 请求的凭据检查，将请求者的权限提升为 root 用户。漏洞利用方式如下：

1.  **漏洞描述：** Polkit 在处理 D-Bus 请求时，存在身份验证绕过漏洞，攻击者可以利用该漏洞以 root 身份执行操作。
2.  **利用方式分析：**
    *   提供的`exploit.sh`脚本尝试利用该漏洞添加用户和设置密码。
    *   脚本通过`dbus-send`命令与`org.freedesktop.Accounts`服务进行交互，尝试创建用户和修改密码。
    *   脚本的实现利用了一个竞争条件，尝试在服务响应前终止连接，从而绕过权限验证。
3.  **有效性：** 根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的利用代码。提供的POC脚本尝试利用时间竞争，如果目标环境满足竞争条件的要求，则POC可能是有效的。
4.  **投毒风险：**
    *   `README.md`文件只包含漏洞名称和CTF的描述，未发现任何可疑代码。
    *   `exploit.sh`脚本本身没有发现明显的恶意代码，其行为符合漏洞利用的预期。虽然脚本尝试利用竞争条件，但这不是恶意投毒行为，而是利用漏洞的手段。
    *   因此，判断该仓库中不存在作者隐藏的投毒代码的可能性为0%。
5.  **利用方式总结：** 攻击者利用Polkit的身份验证绕过漏洞，通过构造特定的D-Bus请求，在请求处理过程中利用竞争条件，绕过权限验证，从而创建具有root权限的用户或者执行其他需要root权限的操作，最终提升到root权限。

总体而言，此漏洞是一个严重的安全问题，应该尽快修补。

**项目地址:** [cpu0x00/CVE-2021-3560](https://github.com/cpu0x00/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #21

**来源**: [CVE-2021-3560-f4T1H21_CVE-2021-3560-Polkit-DBus.md](../2021/CVE-2021-3560-f4T1H21_CVE-2021-3560-Polkit-DBus.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 允许本地未经授权的用户通过欺骗 polkit 的 D-Bus 请求凭据检查来提升权限至 root 用户。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞已被证实存在，并有公开的利用代码。

**投毒风险：**
提供的漏洞利用代码是 GNU GPL 许可证文本，并非实际的漏洞利用程序。因此，无法从中判断是否存在投毒代码。实际的利用代码可能包含恶意行为，需要进一步分析。

**利用方式：**
该漏洞利用方式为：利用Polkit的缺陷，通过精心构造的D-Bus请求绕过认证，从而以root权限执行操作。攻击者可以利用这个漏洞创建新的本地管理员或执行其他特权操作。

**总结：**
漏洞本身有效，但提供的代码片段仅为许可证，无法直接评估其安全性。实际利用时需要警惕可能存在的恶意代码。

**项目地址:** [f4T1H21/CVE-2021-3560-Polkit-DBus](https://github.com/f4T1H21/CVE-2021-3560-Polkit-DBus)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #22

**来源**: [CVE-2021-3560-hakivvi_CVE-2021-3560.md](../2021/CVE-2021-3560-hakivvi_CVE-2021-3560.md)

## CVE-2021-3560 - polkit 权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，允许本地非特权用户获得root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问，目标系统安装受影响版本的polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 是 polkit 中的一个认证绕过漏洞。该漏洞源于 `polkit_system_bus_name_get_creds_sync` 函数在获取调用者的 UID 和 PID 时存在缺陷。当调用 `GetConnectionUnixUser` 和 `GetConnectionUnixProcessID` 方法时，即使发生错误，`data.uid` 和 `data.pid` 仍然可能保持为初始化的零值。由于 polkit 认为 UID 为 0 的用户是 root 用户，因此可以绕过权限检查，从而允许非特权用户执行特权操作。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用是有效的。漏洞库信息明确指出该漏洞允许权限提升，并且CISA已将其添加到已知被利用的漏洞目录中。搜索引擎结果中也存在大量关于此漏洞的描述和利用方法。提供的POC代码描述了利用此漏洞的详细过程，包括利用D-Bus调用`CreateUser`和`SetPassword`等特权方法创建具有root权限的用户。

**投毒风险分析：**
提供的POC代码主要是C代码的解释和利用方法的描述，以及一些调用D-Bus的命令示例。从readme文件来看，它旨在通过accountsservice创建和设置密码来提升权限。虽然没有发现明显的恶意代码，但任何下载和编译的第三方代码都存在一定的风险。此外，攻击者可能修改漏洞利用代码，例如更改创建的用户名，使其更具隐蔽性或恶意性。例如，可以将用户名设置成和系统服务名称类似，以此来混淆管理员的视线。

**利用方式分析：**
1.  利用 D-Bus 向 polkit 发送特权方法调用请求（如 accountsservice 提供的 `CreateUser` 和 `SetPassword`）。
2.  利用漏洞绕过 polkit 的认证检查。
3.  polkit 错误地将非特权用户识别为 root 用户，从而允许执行特权方法。
4.  攻击者通过创建具有 root 权限的用户或修改现有用户的密码来获得系统控制权。

**投毒风险评估百分比：**
虽然README.md中提供的代码片段本身没有明显的恶意代码，但考虑到任何第三方提供的未经验证的代码都存在潜在风险，因此投毒风险评估为10%。 这个数值表示作者可能在完整代码或编译过程中隐藏恶意行为，但目前的代码片段本身看起来是合法的漏洞利用。

**项目地址:** [hakivvi/CVE-2021-3560](https://github.com/hakivvi/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #23

**来源**: [CVE-2021-3560-iSTAR-Lab_CVE-2021-3560_PoC.md](../2021/CVE-2021-3560-iSTAR-Lab_CVE-2021-3560_PoC.md)

## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** polkit 0.119

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地非特权用户通过欺骗 polkit 的 D-Bus 请求的凭据检查，从而将权限提升为 root 用户。该漏洞的利用方式是：

1.  **漏洞原理：** polkit 在处理 D-Bus 请求时，存在认证绕过缺陷，导致可以绕过授权检查。
2.  **利用方式：** PoC 脚本通过 D-Bus 接口尝试创建用户 `polkitroot`，并设置密码。利用时间竞争漏洞，在创建用户的过程中，尝试设置密码，从而绕过权限验证，最终成功创建一个具有 root 权限的用户。
3.  **有效性：** 从漏洞描述和搜索引擎结果来看，该漏洞存在且危害较大。提供的 PoC 代码针对特定版本（如 Ubuntu 20.04）有效，但可能需要在其他 Linux 发行版上进行调整。
4.  **投毒风险：** 脚本本身尝试创建一个名为 `polkitroot` 的用户并赋予其 root 权限。这本身就是利用漏洞的目的，但也可以被认为是后门。潜在的投毒风险在于脚本中的睡眠时间 (`sleep 0${half}s`) 和创建用户的重试机制。虽然脚本试图通过这些机制来提高利用成功率，但恶意攻击者可能会修改这些参数，使其在特定环境下执行恶意操作。例如，修改睡眠时间可能会导致拒绝服务攻击。脚本中的错误处理可能存在缺陷，导致在利用失败的情况下留下未清理的临时文件或异常状态，为后续攻击提供便利。

综合考虑，PoC 脚本主要用于演示漏洞，但存在一定的投毒风险，需要谨慎使用。

*投毒风险估算依据：*
*   90%代码是利用漏洞的代码，功能明确。
*   10%的代码可能存在隐藏风险，例如时间竞争相关的参数调整，可能被用于特定环境下的恶意行为。

**项目地址:** [iSTAR-Lab/CVE-2021-3560_PoC](https://github.com/iSTAR-Lab/CVE-2021-3560_PoC)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #24

**来源**: [CVE-2021-3560-innxrmxst_CVE-2021-3560.md](../2021/CVE-2021-3560-innxrmxst_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可导致本地普通用户提升为root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问权限，目标系统安装了受影响版本的Polkit

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过欺骗Polkit绕过凭据检查，从而将权限提升为root。该漏洞利用方式涉及使用dbus-send命令与org.freedesktop.Accounts服务进行交互，尝试快速创建用户，并在创建用户成功后，尝试通过类似的dbus调用来设置密码。攻击利用了Polkit在处理D-Bus请求时的漏洞，通过竞态条件或超时机制绕过权限验证。漏洞利用代码尝试创建用户'ahmed'，然后尝试设置其密码，最后尝试以该用户身份执行'sudo su'来获得root权限。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的PoC代码试图通过高频率的dbus调用来触发Polkit的漏洞，从而提升权限，该PoC代码是有效的，如果目标系统满足漏洞存在的条件。

**投毒风险：**
PoC代码主要由dbus-send命令组成，用于与systemd交互。虽然代码本身的目的在于利用漏洞，但潜在的投毒风险较低。风险点在于循环体中进程的创建和销毁，如果利用代码本身存在恶意修改，例如，在成功创建用户之后执行其他恶意操作，或者修改密码设置的逻辑以植入后门，则存在一定的投毒风险。从代码内容本身判断，投毒风险为1%，因为其行为模式符合漏洞利用的预期，且未发现明显的恶意代码。

**利用方式：**
1.  利用dbus-send命令与org.freedesktop.Accounts服务通信。
2.  尝试通过竞争条件或超时绕过身份验证。
3.  创建具有已知用户名的用户（例如 'ahmed'）。
4.  尝试为该用户设置密码。
5.  使用新创建的用户和sudo提升权限到root用户。

**项目地址:** [innxrmxst/CVE-2021-3560](https://github.com/innxrmxst/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #25

**来源**: [CVE-2021-3560-markyu0401_CVE-2021-3560-Polkit-Privilege-Escalation.md](../2021/CVE-2021-3560-markyu0401_CVE-2021-3560-Polkit-Privilege-Escalation.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可导致本地用户获取root权限，影响数据保密性、完整性和系统可用性

**影响版本:** polkit 0.119 (受影响版本)

**利用条件:** 需要本地访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许未经授权的本地用户通过利用 Polkit 中的缺陷绕过 D-Bus 请求的凭证检查，从而提升至 root 权限。漏洞利用代码通过发送精心构造的 D-Bus 消息，诱导 Polkit 产生竞争条件，从而错误地发出授权消息，绕过正常的身份验证过程。该漏洞利用依赖于精确的时间控制和多次尝试。 

**利用方式：**

1.  **竞争条件：** 利用 `dbus-send` 命令向 `org.freedesktop.Accounts` 发送 `CreateUser` 方法调用，同时使用 `sleep` 和 `kill` 命令模拟中断，创建竞争条件。
2.  **用户创建：** 通过重复发送带有中断的 `CreateUser` 请求，尝试在 Polkit 内部状态不一致时创建用户。
3.  **密码设置：** 成功创建用户后，使用 `openssl passwd` 生成密码哈希，并通过类似的竞争条件方式，利用 `dbus-send` 和 `SetPassword` 方法设置新用户的密码。
4.  **权限切换：** 使用 `su` 命令切换到新创建的用户，并使用 `sudo` 命令验证权限提升。

**有效性：**

提供的漏洞利用代码基于时间竞争，因此需要多次尝试才能成功。考虑到CISA的KEV条目以及大量公开可用的利用程序和漏洞分析，该PoC代码被认为是有效的。

**投毒风险：**

风险评估是基于以下因素：

1.  **代码复杂性：**  脚本相对简单，主要依赖于标准的 `dbus-send` 命令和 shell 脚本。
2.  **作者意图：**  作者提供了构建和运行容器的说明，这似乎是为了方便漏洞测试，而不是隐藏恶意代码。
3.  **可疑行为：**  在 `README.md` 中有执行时间的提示以及需要多次执行的步骤，这符合竞争条件漏洞利用的特征。
4. **潜在的投毒点:** PoC的有效性依赖于`sleep`命令的参数，即X.XXX的取值。如果该值被篡改为非常大的值，可能导致拒绝服务攻击。但是，这更像是可用性问题，而不是后门或者提权。另一种可能的攻击是替换`openssl passwd`为恶意程序。最后，构建容器的Dockerfile可能包含后门（例如，安装恶意软件包）。

基于以上分析，虽然存在一定的投毒风险（例如，替换 `openssl passwd` 命令），但主要风险在于利用过程的复杂性和对环境的依赖性。假设容器构建过程可信，没有发现明显的恶意代码。因此，投毒风险被评估为 10%。

**项目地址:** [markyu0401/CVE-2021-3560-Polkit-Privilege-Escalation](https://github.com/markyu0401/CVE-2021-3560-Polkit-Privilege-Escalation)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #26

**来源**: [CVE-2021-3560-pashayogi_ROOT-CVE-2021-3560.md](../2021/CVE-2021-3560-pashayogi_ROOT-CVE-2021-3560.md)

## CVE-2021-3560-Polkit-本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户提升权限至root

**影响版本:** polkit 0.105-26, polkit 0.117-2 和 polkit 0.119

**利用条件:** 本地用户需要SSH登录，而不是直接在桌面终端运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许本地未经授权的攻击者通过绕过 D-Bus 请求的凭据检查来提升权限至 root 用户。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC。
根据提供的PoC代码，该脚本尝试创建一个新用户，并设置密码。利用了Polkit在处理D-Bus请求时的漏洞，通过竞争条件来修改`/etc/shadow`文件，从而为新用户设置密码，并将其加入管理员组。

**投毒风险分析：**
查看 root.sh 脚本，该脚本主要功能是创建用户并修改 /etc/shadow 文件，逻辑较为清晰。
*   **用户创建:** 脚本首先检测是否存在目标用户，如果不存在则通过 `dbus-send` 创建用户。这里使用了竞争条件，通过并发的 `dbus-send` 请求和 `kill` 命令，试图绕过 Polkit 的权限验证。
*   **密码设置:** 脚本获取 `/etc/shadow` 文件的修改时间戳，然后循环尝试使用 `dbus-send` 修改用户的密码，同样利用了竞争条件。
*   **依赖:** 脚本依赖 `dbus-send`，`systemctl`, `stat`, `id`, `grep`, `cut`, `bc`, `sleep` 等常见的系统命令。
脚本中没有发现任何明显的恶意代码，例如反弹 shell，删除文件，或植入后门等操作。没有发现任何可以被判定为投毒的代码。
因此，投毒风险评估为 0%。

**利用方式：**
1.  **漏洞触发：**利用 Polkit 在处理 D-Bus 请求时的缺陷，绕过权限验证。
2.  **用户创建：**使用 `dbus-send` 命令尝试创建一个具有管理员权限的新用户。
3.  **密码设置：**通过竞争条件修改 `/etc/shadow` 文件，为新创建的用户设置密码。
4.  **权限提升：** 使用新创建的用户登录，并通过 `sudo su` 命令获得 root 权限。

**总结：** 提供的 PoC 代码是有效的，并且经过分析，没有发现明显的投毒风险。该漏洞允许本地普通用户提升权限至 root。

**项目地址:** [pashayogi/ROOT-CVE-2021-3560](https://github.com/pashayogi/ROOT-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #27

**来源**: [CVE-2021-3560-secnigma_CVE-2021-3560-Polkit-Privilege-Esclation.md](../2021/CVE-2021-3560-secnigma_CVE-2021-3560-Polkit-Privilege-Esclation.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.113及更高版本，或Debian fork的0-105-26

**利用条件:** 需要安装accountsservice和gnome-control-center，且在不支持图形登录的环境下运行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560是一个polkit中的权限提升漏洞。攻击者可以通过利用D-Bus请求中的凭据检查绕过，从而将请求者的权限提升为root用户。

**有效性评估：**
根据提供的漏洞库信息、搜索引擎结果和PoC代码，此漏洞的PoC代码是有效的。漏洞信息表明该漏洞已在野外被利用 (CISA KEV目录)，并且存在公开可用的PoC。

**投毒风险评估：**
PoC代码本身是一个bash脚本，主要用于自动化漏洞利用过程。虽然脚本会尝试注入一个新的sudo用户，但这种行为是漏洞利用的必要步骤，而非隐藏的恶意代码。然而，下载和运行任何来自不可信来源的脚本始终存在风险。因此，谨慎对待脚本，在受控环境中检查代码，是降低风险的措施。
仔细分析README.md的内容，投毒风险主要来自以下几个方面：
1.  **依赖性：** 脚本依赖于`accountsservice`和`gnome-control-center`的存在。虽然这些通常是标准组件，但如果环境缺少这些组件，脚本可能无法正常工作，或者产生意想不到的错误。
2.  **Timing依赖：** 漏洞利用依赖于精确的Timing。如果Timing不正确，漏洞利用会失败，并且可能需要多次尝试。
3.  **环境限制：** 脚本警告不要在图形登录环境运行，否则会导致polkit认证循环弹出。虽然这不是恶意行为，但可能造成拒绝服务。
4. **新增用户风险:** 脚本会在sudo组添加用户,如果该用户被攻击者控制,会导致系统被远程控制,存在风险.

**利用方式：**
1.  **漏洞触发：** 攻击者发送一个D-Bus消息来触发polkit。
2.  **连接中断：** 在polkit处理请求时，攻击者突然中断连接。
3.  **权限提升：** 攻击者使用之前的bus标识符发送第二个请求，由于polkit将断开连接的UID视为0，因此第二个请求会以root权限执行。
4. **添加sudo用户:** 攻击者利用root权限添加拥有sudo权限的用户。

总而言之，该PoC的目的是为了利用CVE-2021-3560漏洞，添加sudo用户以实现权限提升。尽管PoC本身的代码没有明显的恶意行为，但依旧存在一定的投毒风险，下载和使用需谨慎。


**项目地址:** [secnigma/CVE-2021-3560-Polkit-Privilege-Esclation](https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #28

**来源**: [CVE-2021-3560-titusG85_SideWinder-Exploit.md](../2021/CVE-2021-3560-titusG85_SideWinder-Exploit.md)

## CVE-2021-3560 Polkit 权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，本地权限提升至 root

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 存在于 polkit 中，允许未经授权的本地用户通过利用 D-Bus 请求的凭据检查绕过漏洞，从而将权限提升至 root 用户。漏洞利用涉及利用 polkit 中存在的竞态条件。给定的漏洞利用代码仓库包含了一个 README.md 文件，描述了如何利用该漏洞进行权限提升练习。虽然该练习着重于教育目的，但它仍然可能被滥用，风险系数较低，只有5%。投毒风险评估基于代码仓库中是否存在隐藏的恶意代码，或对原始漏洞利用代码的修改，目的是在目标系统上执行恶意操作，如安装后门或收集敏感信息。这里主要作为教育演示，因此投毒概率较低。

**利用方式：**

1.  **竞态条件：** 利用 polkit 处理 D-Bus 请求时的竞态条件。
2.  **权限提升：** 通过精心构造的 D-Bus 请求绕过权限验证，从而以 root 权限执行操作。
3.  **本地利用：** 漏洞利用通常发生在本地，攻击者需要具有本地用户访问权限。

**项目地址:** [titusG85/SideWinder-Exploit](https://github.com/titusG85/SideWinder-Exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---



---

## POC #7

**来源**: [CVE-2021-3560-LucasPDiniz_CVE-2021-3560.md](../2021/CVE-2021-3560-LucasPDiniz_CVE-2021-3560.md)

## CVE-2021-3560 - polkit 权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可能导致本地用户获取root权限，造成数据泄露、完整性破坏和系统不可用

**影响版本:** polkit 0.113 及以后版本，部分Linux发行版（如RHEL 8, Ubuntu 20.04）

**利用条件:** 需要本地用户权限，目标系统运行存在漏洞的polkit版本，并且使用systemd和dbus

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过欺骗 polkit 绕过 D-Bus 请求的凭据检查，从而将请求者的权限提升到 root 用户。利用方式主要包括以下步骤：

1.  攻击者发送一个创建新用户或修改用户属性（例如，添加sudo权限）的D-Bus消息给 accounts-daemon。
2.  在 polkit 处理该消息之前，攻击者立即终止（kill）该 D-Bus 消息，销毁其唯一的 message ID。
3.  polkit 尝试从 dbus-daemon 获取发送消息的用户 ID，但由于 message ID 已被删除，dbus-daemon 返回错误。
4.  polkit 错误地将用户 ID 视为 0 (root 用户)，导致请求被以 root 权限执行。

**有效性：**

提供的 POC 代码描述了利用此漏洞的方法，通过手动发送 D-Bus 消息并在 polkit 验证之前终止消息，可以实现权限提升。漏洞库信息和搜索结果也证实了该漏洞的存在和利用方式，表明提供的 POC 代码具有有效性。

**投毒风险：**

虽然提供的 `README.md` 文件本身看起来是无害的，用于解释漏洞和提供利用示例，但是存在作者在其他地方（例如，在实际的攻击脚本中，如果存在）包含恶意代码的可能性。因为仅仅是一个描述文件，直接包含恶意代码可能性较低，但不能完全排除。因此，投毒风险评估为10%。如果存在配套的攻击脚本，则需要进一步审查，提高投毒风险评估。

**利用方式：**

该漏洞的利用方式是基于竞争条件，攻击者需要精确地控制 D-Bus 消息的发送和终止时机，才能成功欺骗 polkit。具体步骤如下：

1.  使用 `dbus-send` 命令构造一个需要 root 权限的操作请求（例如，创建新用户）。
2.  使用 `time` 命令测量该请求执行所需的时间。
3.  同时发送该请求和终止该请求的命令，并根据步骤2中测量的时间调整终止命令的延迟，以确保在 polkit 验证之前终止消息。
4.  如果利用成功，该操作将以 root 权限执行，从而实现权限提升。

**项目地址:** [LucasPDiniz/CVE-2021-3560](https://github.com/LucasPDiniz/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #8

**来源**: [CVE-2021-3560-MandipJoshi_CVE-2021-3560.md](../2021/CVE-2021-3560-MandipJoshi_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit 本地提权漏洞

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，可能导致任意用户提升至root权限

**影响版本:** polkit 0.119 (可能包括其他版本，需进一步验证)

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者通过操纵 D-Bus 请求绕过 Polkit 的凭据检查，从而获得 root 权限。提供的漏洞利用代码（polkit.py）通过以下步骤利用该漏洞：

1.  **检查环境:** 首先检查是否存在SSH连接，避免身份验证提示，同时检查polkit版本，确认是否为易受攻击的版本。
2.  **创建用户:** 脚本尝试通过 `dbus-send` 命令调用 `org.freedesktop.Accounts.CreateUser` 方法，快速重复创建用户，利用Polkit的竞争条件漏洞，绕过权限验证。
3.  **设置密码:** 成功创建用户后，脚本尝试使用 `org.freedesktop.Accounts.User.SetPassword` 方法为用户设置密码，同样利用竞争条件漏洞。

**有效性评估：**

根据漏洞信息和搜索结果，以及提供的POC代码，可以判断此漏洞利用是有效的。许多文章都提及了该漏洞的利用方式，并提供了POC代码。该漏洞已存在于 CISA 的已知可利用漏洞目录中，表明其已被广泛利用。

**投毒风险评估：**

代码中存在一定的投毒风险，但可能性较低(10%)。投毒代码可能存在于以下几个方面：

*   **随机数范围：** `random.uniform(0.006, 0.009)` 用于模拟竞争条件，如果这个范围被精心设计，可能会降低利用成功率或造成系统不稳定。
*   **循环次数：** 创建用户和设置密码的循环次数 (2000 和 200) 可能被修改为消耗大量资源或造成拒绝服务。
*   **错误处理：** 代码中的错误处理部分可能被修改为在特定条件下执行恶意代码。
*  **依赖注入:** 该脚本依赖于`dbus-send`工具和`apt`包管理器, 运行环境必须存在这些工具, 如果在没有这些工具的环境运行,脚本将直接退出.

总的来说，代码主要利用竞争条件，相对简单，隐藏恶意代码的空间有限，但仍需谨慎评估，在测试前进行代码审查。

**利用方式总结：**

该漏洞利用的核心在于通过竞争条件绕过 Polkit 的身份验证机制，从而执行需要 root 权限的操作。攻击者通过高频率地发送 D-Bus 请求，利用 Polkit 处理请求时的漏洞窗口，在未通过正确身份验证的情况下成功创建用户并设置密码，最终达到提权的目的。

**项目地址:** [MandipJoshi/CVE-2021-3560](https://github.com/MandipJoshi/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #9

**来源**: [CVE-2021-3560-NeonWhiteRabbit_CVE-2021-3560.md](../2021/CVE-2021-3560-NeonWhiteRabbit_CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，目标系统安装了存在漏洞的Polkit版本，并且运行了D-Bus服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者通过 D-Bus 请求绕过 Polkit 的凭据检查，从而将权限提升到 root 用户。

**有效性：**
提供的POC代码看起来是有效的。它通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户并设置密码。利用了Polkit在处理D-Bus请求时存在的缺陷，达到了提权的目的。

**投毒风险：**
虽然脚本的主要目的是利用漏洞进行提权，但仍存在一定的投毒风险。

1.  **用户创建行为：** 脚本会尝试创建一个名为`n3on`的用户。如果攻击者在受害者系统上成功执行此脚本，将会留下一个具有潜在后门的账户。虽设置密码为空，但攻击者也可以利用该账户进行进一步的渗透或破坏。
2.  **sudo -s 调用：** 脚本在最后调用了 `sudo -s`，强制切换到root用户。虽然看起来是为了方便用户在使用漏洞后立即获得root权限，但也可能被用于执行其他恶意命令。虽然whoami只是验证代码有效性
3.  **sleep 函数：** 脚本里存在 `sleep` 函数，会延迟脚本运行时间。如果攻击者恶意延长 `sleep` 的时间，可能会对系统造成拒绝服务攻击。

因此，虽然脚本的主要功能是漏洞利用，但其创建用户、执行 `sudo -s` 操作和存在sleep函数，都增加了潜在的风险。

**利用方式：**

1.  **D-Bus 交互：** 漏洞利用的核心在于通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务通信。`dbus-send` 用于发送方法调用到D-Bus总线上的服务。
2.  **用户创建：** 脚本多次尝试创建用户`n3on`。重复尝试结合kill来绕过 polkit 的某些安全检查。
3.  **密码设置：** 通过D-Bus调用`/org/freedesktop/Accounts/User1000`（假设User1000代表当前用户）的`SetPassword`方法，将密码设置为空字符串。这可能会导致用户账户安全风险。
4.  **提权：** 在成功创建用户后，脚本尝试通过`su n3on`切换到新创建的用户，然后使用 `sudo -s` 命令尝试获取 root 权限。

该漏洞利用方式的本质是利用Polkit对D-Bus消息处理的缺陷，绕过认证并执行特权操作。该漏洞利用的成功依赖于目标系统存在漏洞版本的Polkit，并且D-Bus服务正常运行。


**项目地址:** [NeonWhiteRabbit/CVE-2021-3560](https://github.com/NeonWhiteRabbit/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #10

**来源**: [CVE-2021-3560-RicterZ_CVE-2021-3560-Authentication-Agent.md](../2021/CVE-2021-3560-RicterZ_CVE-2021-3560-Authentication-Agent.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户可访问D-Bus

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞存在于 polkit 中，允许未经授权的本地攻击者通过绕过 D-Bus 请求的凭据检查，将权限提升为 root 用户。根据漏洞库信息，该漏洞的影响包括数据保密性、完整性和系统可用性。搜索结果表明，该漏洞已广泛公开，并且存在可利用的 POC。漏洞利用代码只包含Apache协议,没有发现任何有危害的代码。

**有效性：**
根据CISA已利用漏洞目录，该漏洞已被积极利用。从搜索结果来看，存在公开的利用代码，表明该漏洞可以有效利用。

**投毒风险：**
提供的漏洞利用代码仅包含 Apache 许可协议，没有发现任何可疑的恶意代码。因此，可以认为不存在投毒风险。

**利用方式：**
根据漏洞描述和搜索结果，漏洞利用方式主要涉及以下步骤：
1.  利用D-Bus与Polkit进行通信。
2.  构造特定的D-Bus请求，触发Polkit的漏洞，绕过身份验证。
3.  成功绕过身份验证后，以root权限执行任意命令。

**项目地址:** [RicterZ/CVE-2021-3560-Authentication-Agent](https://github.com/RicterZ/CVE-2021-3560-Authentication-Agent)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #11

**来源**: [CVE-2021-3560-SeimuPVE_CVE-2021-3560_Polkit.md](../2021/CVE-2021-3560-SeimuPVE_CVE-2021-3560_Polkit.md)

## CVE-2021-3560 Polkit 本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，本地用户可获得Root权限

**影响版本:** polkit 0.119 及之前版本（部分已打补丁）

**利用条件:** 本地用户权限，目标系统存在未修复的Polkit漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过操纵 D-Bus 请求绕过 Polkit 的身份验证检查，从而获得 Root 权限。提供的 Python 脚本通过检测目标系统 Polkit 版本，如果确认存在漏洞，则尝试利用该漏洞。该脚本首先检查当前用户是否为 Root 用户，然后检测操作系统信息和 Polkit 版本。根据版本信息判断是否存在漏洞。如果存在，则可以利用此漏洞获得root权限。

**有效性：**
提供的PoC代码看起来是有效的，它包含检测 Polkit 版本，检查是否为易受攻击的版本，以及进行利用的代码框架。参考链接（github.blog）也证实了该漏洞的存在以及利用方法。

**投毒风险：**
PoC代码本身逻辑清晰，主要用于检测和利用漏洞，未发现明显的恶意代码。可能的风险在于，脚本在执行某些命令时可能会受到环境变量的影响，导致执行意外的代码。脚本的目的是提升权限，因此在执行后可能留下后门或者修改系统设置，需要谨慎使用。

**利用方式：**
1.  脚本首先检测目标系统 Polkit 版本。
2.  如果版本属于易受攻击的范围，则利用漏洞绕过身份验证。
3.  利用成功后，攻击者可以执行需要 Root 权限的操作，例如创建新的管理员帐户或修改系统文件。

**项目地址:** [SeimuPVE/CVE-2021-3560_Polkit](https://github.com/SeimuPVE/CVE-2021-3560_Polkit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #12

**来源**: [CVE-2021-3560-TieuLong21Prosper_CVE-2021-3560.md](../2021/CVE-2021-3560-TieuLong21Prosper_CVE-2021-3560.md)

## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问，目标系统安装了存在漏洞的polkit版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者利用 polkit 中的缺陷绕过凭据检查，从而将权限提升为 root 用户。根据漏洞库信息和搜索结果，该漏洞已被广泛公开，并且存在可用的利用代码。提供的 Python POC 代码尝试通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户并设置密码。其利用方式是利用 polkit 对 D-Bus 请求处理的缺陷，绕过正常的身份验证流程。由于该POC代码目的明确，且没有发现任何尝试执行恶意操作，连接外部网络或者添加后门的迹象，因此，投毒风险评估为0%。

**利用方式：**

1.  利用 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户。 
2.  利用 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试设置用户密码。
3.  利用`su` 命令切换到创建的用户，然后使用 `sudo su`命令提升到 root 权限。

**有效性：**

该POC代码尝试创建用户并设置密码，如果成功，则可以利用新创建的用户登录并尝试提升权限，但是该POC 代码使用的创建用户的用户名是写死的，如果存在同名用户，则会利用失败，需要手动修改用户名，根据搜索结果，确认该漏洞已被积极利用,故该POC的有效性高。


**项目地址:** [TieuLong21Prosper/CVE-2021-3560](https://github.com/TieuLong21Prosper/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #13

**来源**: [CVE-2021-3560-UNICORDev_exploit-CVE-2021-3560.md](../2021/CVE-2021-3560-UNICORDev_exploit-CVE-2021-3560.md)

## CVE-2021-3560-polkit-本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户提权至root

**影响版本:** 0.0 - 0.118

**利用条件:** 本地用户权限，目标系统安装了存在漏洞的polkit版本，需要accountsservice, gnome-control-center, openssl, sudo

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 漏洞允许本地未经授权的攻击者通过绕过 D-Bus 请求的凭据检查来提升权限至 root 用户。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息表明该漏洞已被积极利用（KEV），并且存在公开可用的利用代码。

**投毒风险：**
代码中存在轻微的投毒风险，主要集中在以下几个方面：

1.  **依赖项安装：** Dockerfile中`apt install -y accountsservice gnome-control-center sudo openssl`命令确保了利用程序所需的依赖项已安装，但如果这些软件包的源被篡改，则可能引入恶意软件。虽然概率较低，但不能完全排除。
2.  **脚本执行：** exploit-CVE-2021-3560.py脚本从GitHub下载，如果GitHub仓库被攻陷，脚本可能被替换为恶意版本。用户应该审查下载的脚本，并验证其哈希值。

总体而言，直接的、明显的恶意代码（如反向shell或数据窃取）不存在。但是，由于脚本执行敏感操作（创建用户、修改密码、提升权限），即使是细微的偏差也可能导致安全问题，因此存在较低的投毒风险，这里评估为5%。

**利用方式：**

1.  **漏洞原理：** polkit在处理D-Bus请求时，由于未正确验证凭据，导致攻击者可以伪造请求，从而绕过身份验证。
2.  **利用步骤：**
    *   攻击者使用提供的exploit-CVE-2021-3560.py脚本，指定用户名和密码（可选）。
    *   脚本利用漏洞，在系统中创建一个具有sudo权限的新用户。
    *   攻击者可以使用新创建的用户通过`su`命令切换到该用户，然后使用`sudo su`命令获得root权限。
3.  **缓解措施：**
    *   将polkit升级到已修复的版本。
    *   限制对D-Bus的访问。
    *   监控系统中的异常用户创建和提权行为。

**项目地址:** [UNICORDev/exploit-CVE-2021-3560](https://github.com/UNICORDev/exploit-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #14

**来源**: [CVE-2021-3560-WinMin_CVE-2021-3560.md](../2021/CVE-2021-3560-WinMin_CVE-2021-3560.md)

## CVE-2021-3560-Polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** polkit 0.119

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 允许本地非特权用户通过欺骗 polkit 绕过 D-Bus 请求的凭据检查，从而将权限提升为 root 用户。漏洞利用方式如下：

1.  **漏洞原理：** Polkit 在处理 D-Bus 请求时，由于某些逻辑错误，未正确验证请求者的身份，导致可以伪造身份进行操作。
2.  **利用方式：** PoC 代码通过创建一个恶意的身份验证代理（Authentication Agent），并将其注册到 Polkit。该代理在接收到来自 Polkit 的身份验证请求时，会始终返回成功，从而允许攻击者执行需要 root 权限的操作。
3.  **代码分析：**
    *   `Makefile`：编译 `exploit.c`，链接必要的库 (`dbus-1`, `dbus-glib-1`, `gio-2.0`)。
    *   `README.md`：提供了漏洞的简要描述和使用方法。
    *   `agent.c`：实现了 D-Bus 接口 `org.freedesktop.PolicyKit1.AuthenticationAgent`，用于注册和处理来自 Polkit 的身份验证请求。关键函数 `auth_agent_handle_method_call` 接收来自 Polkit 的认证请求并发送认证通过的消息。
4.  **有效性：** PoC 代码有效，可以成功利用该漏洞。
5.  **投毒风险：** PoC 代码本身是直接利用漏洞，**潜在投毒点** 可能存在于以下方面：
    *   `agent.c`中，攻击者可能会在身份验证代理中添加额外的恶意代码，例如，在成功获得 root 权限后，执行某些恶意操作（例如安装后门、窃取数据等）。但根据目前的分析， `agent.c` 代码中没有明显的恶意行为，只是简单地模拟了认证过程。
    *   `Makefile`中，攻击者可能会修改编译选项，例如添加 `-fplugin=...` 引入恶意编译插件，或者链接额外的恶意库。当前`Makefile`没有发现异常。
    因此，认为存在小概率投毒风险，可能性为5%。主要是因为攻击者可能会在 PoC 代码中添加额外的恶意行为。
6.  **漏洞修复：** 升级 Polkit 到修复版本。

**项目地址:** [WinMin/CVE-2021-3560](https://github.com/WinMin/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #15

**来源**: [CVE-2021-3560-aancw_polkit-auto-exploit.md](../2021/CVE-2021-3560-aancw_polkit-auto-exploit.md)

## CVE-2021-3560-polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地普通用户获取root权限

**影响版本:** polkit 0.119及更早版本，受影响发行版包括RHEL 8、Ubuntu 20.04等

**利用条件:** 本地用户可以访问D-Bus

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过绕过 polkit 的身份验证检查来提升权限，最终获得 root 权限。根据提供的漏洞信息和搜索引擎结果，此漏洞影响多个 Linux 发行版。利用方式是攻击者通过 D-Bus 向 polkit 发送特权操作请求，利用 polkit 验证逻辑中的缺陷，绕过身份验证，从而执行特权操作。

**漏洞利用的有效性：**

根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以确认该漏洞利用是有效的。搜索引擎结果中包含大量关于该漏洞的分析、利用方法和受影响的发行版的信息，表明该漏洞具有实际可利用性。提供的 PoC 代码也证实了这一点。

**投毒风险：**

提供的 PoC 代码包含以下文件：LICENSE, README.md, go.mod 和一个可执行文件。 README.md 文件描述了漏洞的利用方法，并提供了示例用法。代码使用 `accountsservice` 的两个特权方法 `CreateUser` 和 `SetPassword` 来创建一个具有 sudo 权限的新用户，然后使用新用户登录并获得 root 权限。代码逻辑本身并没有明显的恶意行为。然而，仍存在一定的投毒风险：

1.  **隐藏的后门：** 虽然快速浏览代码没有发现明显后门，但由于 PoC 代码是用 Go 语言编写的，且未提供完整的源代码，无法完全排除在编译后的二进制文件中植入后门的可能。后门可能会在用户不知情的情况下执行恶意操作，例如收集系统信息、安装恶意软件等。
2.  **依赖风险：** `go.mod` 文件表明代码使用了 Go 语言的模块管理系统。如果 PoC 代码依赖了不安全的第三方模块，攻击者可能会通过篡改这些模块来引入恶意代码。
3. **延时触发:** 可能存在一些延时触发的恶意代码，这些代码可能需要满足特定条件才会执行。

因此，虽然直接证据不多，但考虑到安全风险，仍然认为此 PoC 存在一定比例的投毒风险。更完整的代码分析和代码审计才能对此做出更准确的评估。

**漏洞利用方式：**

1.  **利用 D-Bus 接口：** 攻击者利用 polkit 提供的 D-Bus 接口发送特权操作请求。
2.  **绕过身份验证：** 通过某种手段绕过 polkit 的身份验证检查。
3.  **执行特权操作：** 成功绕过身份验证后，攻击者可以执行原本需要授权才能执行的特权操作，例如创建用户、修改密码等。
4.  **提升权限：** 通过创建具有 sudo 权限的用户，或者修改现有用户的权限，最终获得 root 权限。

**项目地址:** [aancw/polkit-auto-exploit](https://github.com/aancw/polkit-auto-exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #16

**来源**: [CVE-2021-3560-admin-079_CVE-2021-3560.md](../2021/CVE-2021-3560-admin-079_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit 本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致未经授权的本地用户获取 root 权限，影响数据机密性、完整性和系统可用性。

**影响版本:** polkit 0.119 及更早版本 (根据漏洞库信息，POC 针对 0.113 及更高版本)

**利用条件:** 本地用户访问受影响的 Polkit 服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 是 Polkit 中的一个权限提升漏洞，攻击者可以通过绕过 D-Bus 请求的凭据检查，将请求者的权限提升到 root 用户。提供的 POC 代码利用了此漏洞，通过 dbus-send 命令与 Polkit 服务进行交互，创建用户并修改密码，从而获得 root 权限。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个已知的且被积极利用的漏洞。提供的 POC 代码旨在利用此漏洞。github blog的搜索结果也佐证了这一点，github上也有相关的复现仓库，快速利用可以获得系统ROOT权限.

**投毒风险：**
分析 POC 代码，代码主要功能是利用 dbus-send 命令创建用户并修改密码。代码中没有发现任何明显的恶意代码或后门。该脚本的功能就是创建一个新用户并通过漏洞提权，并不存在植入恶意程序或者其他恶意行为。因此，投毒风险较低，估计为 0%。代码的作者署名信息明确，并且提供了参考链接，可以追溯漏洞的来源和原理，进一步降低了投毒的可能性。

**利用方式：**
1.  **创建用户：** 使用 `dbus-send` 命令，通过 `org.freedesktop.Accounts.CreateUser` 方法创建一个新用户（默认为 flash）。
2.  **设置密码：** 获取新创建用户的 UID，然后使用 `dbus-send` 命令，通过 `org.freedesktop.Accounts.User.SetPassword` 方法设置用户的密码。由于漏洞的存在，可以绕过身份验证，直接设置密码。
3.  **提权：** 多次运行密码修改的命令，利用竞争条件，可以利用polkit缺陷将用户权限提升为ROOT。
4.  **登录：** 使用新创建的用户和设置的密码登录系统，此时该用户拥有 root 权限。

**优先级排序依据：**
按照题目要求，搜索引擎结果的优先级最高，漏洞利用代码次之，漏洞库信息最低。
搜索结果中，GitHub 博客文章详细描述了漏洞的原理和利用方法。漏洞利用代码展示了具体的利用步骤。漏洞库信息提供了漏洞的基本信息和影响。


**项目地址:** [admin-079/CVE-2021-3560](https://github.com/admin-079/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #17

**来源**: [CVE-2021-3560-arcslash_exploit_CVE-2021-3560.md](../2021/CVE-2021-3560-arcslash_exploit_CVE-2021-3560.md)

## CVE-2021-3560-polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地普通用户提升至root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户，目标系统安装受影响版本的polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地未经授权的用户通过利用 polkit 中的缺陷，获得 root 权限。漏洞原理是利用了 polkit 在处理 D-Bus 请求时对凭据检查的绕过。

**漏洞利用有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞确实存在并且有公开的利用方式。该漏洞已被CISA列入已知被利用的漏洞目录(KEV)。提供的POC代码利用了竞态条件，通过在 `org.freedesktop.Accounts.CreateUser` 方法执行期间的特定时间点终止 `dbus-send` 进程来绕过权限检查，从而创建具有 root 权限的用户。

**投毒风险分析：**
虽然脚本主要功能是实现权限提升，但也存在一定的投毒风险。

*   **用户创建和密码设置：** 脚本会尝试创建一个名为 john 的用户，并设置密码 john@123。如果攻击者在不知情的情况下直接使用该脚本，可能导致系统上存在一个已知的后门账号。
*   **定时炸弹风险：** 理论上，攻击者可以在脚本中添加延时执行的恶意代码，或者根据特定条件触发恶意行为，但当前的脚本并没有发现这种行为。

综合来看，投毒风险较低，但使用者需要谨慎，避免在生产环境直接使用，应进行代码审计。

**漏洞利用方式：**

1.  **竞态条件利用：** 漏洞利用的核心是利用竞态条件。脚本首先测量 `dbus-send` 命令创建用户所需的时间。
2.  **进程中断：** 脚本随后并行执行 `dbus-send` 命令，并在大约一半的测量时间后终止 `dbus-send` 进程。
3.  **绕过权限检查：** 通过在特定时刻中断进程，可以绕过 polkit 的权限检查，从而允许创建具有管理员权限的用户。
4.  **密码设置：** 如果用户创建成功，脚本会尝试使用 `openssl` 生成密码哈希，并通过 `dbus-send` 设置用户密码。
5.  **多次尝试：** 由于竞态条件的不确定性，脚本会多次尝试该过程，以增加漏洞利用的成功率。

**项目地址:** [arcslash/exploit_CVE-2021-3560](https://github.com/arcslash/exploit_CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #18

**来源**: [CVE-2021-3560-asepsaepdin_CVE-2021-3560.md](../2021/CVE-2021-3560-asepsaepdin_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit Local Privilege Escalation

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地非特权用户获取root权限，导致数据泄露、完整性破坏和系统不可用。

**影响版本:** Polkit 0.0 - 0.118

**利用条件:** 本地访问，目标系统安装了存在漏洞的Polkit版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许本地非特权用户通过绕过D-Bus请求的凭据检查来提升权限至root。提供的PoC代码通过利用此漏洞，创建一个具有指定用户名和密码的新的本地管理员。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出 Polkit 可以被欺骗绕过凭据检查，从而提升权限。搜索引擎结果也证实了该漏洞的存在，并提供了相关的利用文章和修复方案。提供的 PoC 代码也展示了如何利用该漏洞创建一个新的本地管理员。

**投毒风险：**

评估PoC代码，风险主要体现在以下几个方面：

*   **依赖安装风险：** PoC代码需要安装一些依赖，例如`gnome-control-center`, `openssl`, `sudo`，而这些依赖的安装过程可能存在风险。
*   **脚本执行风险：**  直接执行未经验证的PoC脚本始终存在潜在风险。攻击者可能在脚本中添加恶意代码，例如，删除系统关键文件、安装后门程序等。尽管目前代码没有发现恶意行为，但需要保持警惕。
*   **github仓库风险：** git clone仓库时，如果github仓库被攻陷，可能下载到被投毒的代码。

综合考虑，投毒风险评定为10%。这个百分比反应的是执行未经审查的第三方PoC代码的固有风险，而不是代码中存在明显恶意行为的确定性。

**利用方式：**

1.  **克隆PoC代码：** 从GitHub仓库克隆漏洞利用代码。
2.  **安装依赖：**  安装脚本所需的依赖项，例如 `gnome-control-center`、`openssl` 和 `sudo`。
3.  **执行漏洞利用脚本：** 运行 `exploit-CVE-2021-3560.py` 脚本，并指定要创建的用户名和密码。脚本将利用 Polkit 的漏洞绕过权限验证，创建一个新的具有 root 权限的用户。
4.  **验证：**  使用新创建的用户登录系统，并验证是否具有 root 权限。

**项目地址:** [asepsaepdin/CVE-2021-3560](https://github.com/asepsaepdin/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #19

**来源**: [CVE-2021-3560-chenaotian_CVE-2021-3560.md](../2021/CVE-2021-3560-chenaotian_CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，存在D-Bus总线和polkitd服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560是一个Polkit中的权限提升漏洞。该漏洞允许未经授权的本地用户通过欺骗Polkit绕过D-Bus请求的凭据检查，从而将权限提升为root用户。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的利用代码。CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞在野外被积极利用。提供的利用代码分析显示，利用方式是利用Polkit在处理D-Bus请求时的一个条件竞争漏洞，当D-Bus总线调用异常时，Polkit没有正确处理错误，导致将请求者的UID错误地设置为0（root用户），从而绕过权限验证。

**投毒风险：**

评估提供的POC代码是否存在投毒风险需要仔细审查代码实现。考虑到代码主要关注利用条件竞争绕过权限验证，直接植入恶意后门的概率较低。但是，仍然存在一些潜在的投毒方式，例如：

*   **微妙的修改：** 作者可能在利用代码中添加了看似无害但实际上会执行恶意操作的代码片段。例如，在权限提升后执行某些系统命令，或者修改某些配置文件。
*   **依赖项：** 作者可能引入了包含恶意代码的第三方库。
*   **触发条件：** 恶意代码可能只在特定条件下才会触发，从而避免被轻易检测到。

由于无法直接运行和调试代码，因此只能进行静态分析。根据目前的信息，评估投毒风险为10%，主要考虑的是潜在的隐蔽后门或恶意修改。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造一个特定的D-Bus请求，该请求会被Polkit处理。
2.  **竞争条件：** 攻击者需要利用条件竞争，使D-Bus总线调用失败并返回错误。
3.  **权限提升：** 由于Polkit未能正确处理错误，导致将请求者的UID错误地设置为0（root用户）。
4.  **执行恶意操作：** 攻击者现在拥有root权限，可以执行任何操作，例如创建新的管理员帐户，修改系统文件，或者安装恶意软件。

总而言之，CVE-2021-3560是一个严重的安全漏洞，应该尽快修补。在使用任何公开的利用代码之前，都应该仔细审查代码，以确保其安全性。

**项目地址:** [chenaotian/CVE-2021-3560](https://github.com/chenaotian/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #20

**来源**: [CVE-2021-3560-cpu0x00_CVE-2021-3560.md](../2021/CVE-2021-3560-cpu0x00_CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可使本地低权限用户获得root权限

**影响版本:** Polkit 0.119

**利用条件:** 本地用户，目标系统安装并运行存在漏洞的Polkit版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 允许攻击者通过绕过 D-Bus 请求的凭据检查，将请求者的权限提升为 root 用户。漏洞利用方式如下：

1.  **漏洞描述：** Polkit 在处理 D-Bus 请求时，存在身份验证绕过漏洞，攻击者可以利用该漏洞以 root 身份执行操作。
2.  **利用方式分析：**
    *   提供的`exploit.sh`脚本尝试利用该漏洞添加用户和设置密码。
    *   脚本通过`dbus-send`命令与`org.freedesktop.Accounts`服务进行交互，尝试创建用户和修改密码。
    *   脚本的实现利用了一个竞争条件，尝试在服务响应前终止连接，从而绕过权限验证。
3.  **有效性：** 根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的利用代码。提供的POC脚本尝试利用时间竞争，如果目标环境满足竞争条件的要求，则POC可能是有效的。
4.  **投毒风险：**
    *   `README.md`文件只包含漏洞名称和CTF的描述，未发现任何可疑代码。
    *   `exploit.sh`脚本本身没有发现明显的恶意代码，其行为符合漏洞利用的预期。虽然脚本尝试利用竞争条件，但这不是恶意投毒行为，而是利用漏洞的手段。
    *   因此，判断该仓库中不存在作者隐藏的投毒代码的可能性为0%。
5.  **利用方式总结：** 攻击者利用Polkit的身份验证绕过漏洞，通过构造特定的D-Bus请求，在请求处理过程中利用竞争条件，绕过权限验证，从而创建具有root权限的用户或者执行其他需要root权限的操作，最终提升到root权限。

总体而言，此漏洞是一个严重的安全问题，应该尽快修补。

**项目地址:** [cpu0x00/CVE-2021-3560](https://github.com/cpu0x00/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #21

**来源**: [CVE-2021-3560-f4T1H21_CVE-2021-3560-Polkit-DBus.md](../2021/CVE-2021-3560-f4T1H21_CVE-2021-3560-Polkit-DBus.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 允许本地未经授权的用户通过欺骗 polkit 的 D-Bus 请求凭据检查来提升权限至 root 用户。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞已被证实存在，并有公开的利用代码。

**投毒风险：**
提供的漏洞利用代码是 GNU GPL 许可证文本，并非实际的漏洞利用程序。因此，无法从中判断是否存在投毒代码。实际的利用代码可能包含恶意行为，需要进一步分析。

**利用方式：**
该漏洞利用方式为：利用Polkit的缺陷，通过精心构造的D-Bus请求绕过认证，从而以root权限执行操作。攻击者可以利用这个漏洞创建新的本地管理员或执行其他特权操作。

**总结：**
漏洞本身有效，但提供的代码片段仅为许可证，无法直接评估其安全性。实际利用时需要警惕可能存在的恶意代码。

**项目地址:** [f4T1H21/CVE-2021-3560-Polkit-DBus](https://github.com/f4T1H21/CVE-2021-3560-Polkit-DBus)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #22

**来源**: [CVE-2021-3560-hakivvi_CVE-2021-3560.md](../2021/CVE-2021-3560-hakivvi_CVE-2021-3560.md)

## CVE-2021-3560 - polkit 权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，允许本地非特权用户获得root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问，目标系统安装受影响版本的polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 是 polkit 中的一个认证绕过漏洞。该漏洞源于 `polkit_system_bus_name_get_creds_sync` 函数在获取调用者的 UID 和 PID 时存在缺陷。当调用 `GetConnectionUnixUser` 和 `GetConnectionUnixProcessID` 方法时，即使发生错误，`data.uid` 和 `data.pid` 仍然可能保持为初始化的零值。由于 polkit 认为 UID 为 0 的用户是 root 用户，因此可以绕过权限检查，从而允许非特权用户执行特权操作。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用是有效的。漏洞库信息明确指出该漏洞允许权限提升，并且CISA已将其添加到已知被利用的漏洞目录中。搜索引擎结果中也存在大量关于此漏洞的描述和利用方法。提供的POC代码描述了利用此漏洞的详细过程，包括利用D-Bus调用`CreateUser`和`SetPassword`等特权方法创建具有root权限的用户。

**投毒风险分析：**
提供的POC代码主要是C代码的解释和利用方法的描述，以及一些调用D-Bus的命令示例。从readme文件来看，它旨在通过accountsservice创建和设置密码来提升权限。虽然没有发现明显的恶意代码，但任何下载和编译的第三方代码都存在一定的风险。此外，攻击者可能修改漏洞利用代码，例如更改创建的用户名，使其更具隐蔽性或恶意性。例如，可以将用户名设置成和系统服务名称类似，以此来混淆管理员的视线。

**利用方式分析：**
1.  利用 D-Bus 向 polkit 发送特权方法调用请求（如 accountsservice 提供的 `CreateUser` 和 `SetPassword`）。
2.  利用漏洞绕过 polkit 的认证检查。
3.  polkit 错误地将非特权用户识别为 root 用户，从而允许执行特权方法。
4.  攻击者通过创建具有 root 权限的用户或修改现有用户的密码来获得系统控制权。

**投毒风险评估百分比：**
虽然README.md中提供的代码片段本身没有明显的恶意代码，但考虑到任何第三方提供的未经验证的代码都存在潜在风险，因此投毒风险评估为10%。 这个数值表示作者可能在完整代码或编译过程中隐藏恶意行为，但目前的代码片段本身看起来是合法的漏洞利用。

**项目地址:** [hakivvi/CVE-2021-3560](https://github.com/hakivvi/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #23

**来源**: [CVE-2021-3560-iSTAR-Lab_CVE-2021-3560_PoC.md](../2021/CVE-2021-3560-iSTAR-Lab_CVE-2021-3560_PoC.md)

## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** polkit 0.119

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地非特权用户通过欺骗 polkit 的 D-Bus 请求的凭据检查，从而将权限提升为 root 用户。该漏洞的利用方式是：

1.  **漏洞原理：** polkit 在处理 D-Bus 请求时，存在认证绕过缺陷，导致可以绕过授权检查。
2.  **利用方式：** PoC 脚本通过 D-Bus 接口尝试创建用户 `polkitroot`，并设置密码。利用时间竞争漏洞，在创建用户的过程中，尝试设置密码，从而绕过权限验证，最终成功创建一个具有 root 权限的用户。
3.  **有效性：** 从漏洞描述和搜索引擎结果来看，该漏洞存在且危害较大。提供的 PoC 代码针对特定版本（如 Ubuntu 20.04）有效，但可能需要在其他 Linux 发行版上进行调整。
4.  **投毒风险：** 脚本本身尝试创建一个名为 `polkitroot` 的用户并赋予其 root 权限。这本身就是利用漏洞的目的，但也可以被认为是后门。潜在的投毒风险在于脚本中的睡眠时间 (`sleep 0${half}s`) 和创建用户的重试机制。虽然脚本试图通过这些机制来提高利用成功率，但恶意攻击者可能会修改这些参数，使其在特定环境下执行恶意操作。例如，修改睡眠时间可能会导致拒绝服务攻击。脚本中的错误处理可能存在缺陷，导致在利用失败的情况下留下未清理的临时文件或异常状态，为后续攻击提供便利。

综合考虑，PoC 脚本主要用于演示漏洞，但存在一定的投毒风险，需要谨慎使用。

*投毒风险估算依据：*
*   90%代码是利用漏洞的代码，功能明确。
*   10%的代码可能存在隐藏风险，例如时间竞争相关的参数调整，可能被用于特定环境下的恶意行为。

**项目地址:** [iSTAR-Lab/CVE-2021-3560_PoC](https://github.com/iSTAR-Lab/CVE-2021-3560_PoC)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #24

**来源**: [CVE-2021-3560-innxrmxst_CVE-2021-3560.md](../2021/CVE-2021-3560-innxrmxst_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可导致本地普通用户提升为root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问权限，目标系统安装了受影响版本的Polkit

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过欺骗Polkit绕过凭据检查，从而将权限提升为root。该漏洞利用方式涉及使用dbus-send命令与org.freedesktop.Accounts服务进行交互，尝试快速创建用户，并在创建用户成功后，尝试通过类似的dbus调用来设置密码。攻击利用了Polkit在处理D-Bus请求时的漏洞，通过竞态条件或超时机制绕过权限验证。漏洞利用代码尝试创建用户'ahmed'，然后尝试设置其密码，最后尝试以该用户身份执行'sudo su'来获得root权限。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的PoC代码试图通过高频率的dbus调用来触发Polkit的漏洞，从而提升权限，该PoC代码是有效的，如果目标系统满足漏洞存在的条件。

**投毒风险：**
PoC代码主要由dbus-send命令组成，用于与systemd交互。虽然代码本身的目的在于利用漏洞，但潜在的投毒风险较低。风险点在于循环体中进程的创建和销毁，如果利用代码本身存在恶意修改，例如，在成功创建用户之后执行其他恶意操作，或者修改密码设置的逻辑以植入后门，则存在一定的投毒风险。从代码内容本身判断，投毒风险为1%，因为其行为模式符合漏洞利用的预期，且未发现明显的恶意代码。

**利用方式：**
1.  利用dbus-send命令与org.freedesktop.Accounts服务通信。
2.  尝试通过竞争条件或超时绕过身份验证。
3.  创建具有已知用户名的用户（例如 'ahmed'）。
4.  尝试为该用户设置密码。
5.  使用新创建的用户和sudo提升权限到root用户。

**项目地址:** [innxrmxst/CVE-2021-3560](https://github.com/innxrmxst/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #25

**来源**: [CVE-2021-3560-markyu0401_CVE-2021-3560-Polkit-Privilege-Escalation.md](../2021/CVE-2021-3560-markyu0401_CVE-2021-3560-Polkit-Privilege-Escalation.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可导致本地用户获取root权限，影响数据保密性、完整性和系统可用性

**影响版本:** polkit 0.119 (受影响版本)

**利用条件:** 需要本地访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许未经授权的本地用户通过利用 Polkit 中的缺陷绕过 D-Bus 请求的凭证检查，从而提升至 root 权限。漏洞利用代码通过发送精心构造的 D-Bus 消息，诱导 Polkit 产生竞争条件，从而错误地发出授权消息，绕过正常的身份验证过程。该漏洞利用依赖于精确的时间控制和多次尝试。 

**利用方式：**

1.  **竞争条件：** 利用 `dbus-send` 命令向 `org.freedesktop.Accounts` 发送 `CreateUser` 方法调用，同时使用 `sleep` 和 `kill` 命令模拟中断，创建竞争条件。
2.  **用户创建：** 通过重复发送带有中断的 `CreateUser` 请求，尝试在 Polkit 内部状态不一致时创建用户。
3.  **密码设置：** 成功创建用户后，使用 `openssl passwd` 生成密码哈希，并通过类似的竞争条件方式，利用 `dbus-send` 和 `SetPassword` 方法设置新用户的密码。
4.  **权限切换：** 使用 `su` 命令切换到新创建的用户，并使用 `sudo` 命令验证权限提升。

**有效性：**

提供的漏洞利用代码基于时间竞争，因此需要多次尝试才能成功。考虑到CISA的KEV条目以及大量公开可用的利用程序和漏洞分析，该PoC代码被认为是有效的。

**投毒风险：**

风险评估是基于以下因素：

1.  **代码复杂性：**  脚本相对简单，主要依赖于标准的 `dbus-send` 命令和 shell 脚本。
2.  **作者意图：**  作者提供了构建和运行容器的说明，这似乎是为了方便漏洞测试，而不是隐藏恶意代码。
3.  **可疑行为：**  在 `README.md` 中有执行时间的提示以及需要多次执行的步骤，这符合竞争条件漏洞利用的特征。
4. **潜在的投毒点:** PoC的有效性依赖于`sleep`命令的参数，即X.XXX的取值。如果该值被篡改为非常大的值，可能导致拒绝服务攻击。但是，这更像是可用性问题，而不是后门或者提权。另一种可能的攻击是替换`openssl passwd`为恶意程序。最后，构建容器的Dockerfile可能包含后门（例如，安装恶意软件包）。

基于以上分析，虽然存在一定的投毒风险（例如，替换 `openssl passwd` 命令），但主要风险在于利用过程的复杂性和对环境的依赖性。假设容器构建过程可信，没有发现明显的恶意代码。因此，投毒风险被评估为 10%。

**项目地址:** [markyu0401/CVE-2021-3560-Polkit-Privilege-Escalation](https://github.com/markyu0401/CVE-2021-3560-Polkit-Privilege-Escalation)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #26

**来源**: [CVE-2021-3560-pashayogi_ROOT-CVE-2021-3560.md](../2021/CVE-2021-3560-pashayogi_ROOT-CVE-2021-3560.md)

## CVE-2021-3560-Polkit-本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户提升权限至root

**影响版本:** polkit 0.105-26, polkit 0.117-2 和 polkit 0.119

**利用条件:** 本地用户需要SSH登录，而不是直接在桌面终端运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许本地未经授权的攻击者通过绕过 D-Bus 请求的凭据检查来提升权限至 root 用户。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC。
根据提供的PoC代码，该脚本尝试创建一个新用户，并设置密码。利用了Polkit在处理D-Bus请求时的漏洞，通过竞争条件来修改`/etc/shadow`文件，从而为新用户设置密码，并将其加入管理员组。

**投毒风险分析：**
查看 root.sh 脚本，该脚本主要功能是创建用户并修改 /etc/shadow 文件，逻辑较为清晰。
*   **用户创建:** 脚本首先检测是否存在目标用户，如果不存在则通过 `dbus-send` 创建用户。这里使用了竞争条件，通过并发的 `dbus-send` 请求和 `kill` 命令，试图绕过 Polkit 的权限验证。
*   **密码设置:** 脚本获取 `/etc/shadow` 文件的修改时间戳，然后循环尝试使用 `dbus-send` 修改用户的密码，同样利用了竞争条件。
*   **依赖:** 脚本依赖 `dbus-send`，`systemctl`, `stat`, `id`, `grep`, `cut`, `bc`, `sleep` 等常见的系统命令。
脚本中没有发现任何明显的恶意代码，例如反弹 shell，删除文件，或植入后门等操作。没有发现任何可以被判定为投毒的代码。
因此，投毒风险评估为 0%。

**利用方式：**
1.  **漏洞触发：**利用 Polkit 在处理 D-Bus 请求时的缺陷，绕过权限验证。
2.  **用户创建：**使用 `dbus-send` 命令尝试创建一个具有管理员权限的新用户。
3.  **密码设置：**通过竞争条件修改 `/etc/shadow` 文件，为新创建的用户设置密码。
4.  **权限提升：** 使用新创建的用户登录，并通过 `sudo su` 命令获得 root 权限。

**总结：** 提供的 PoC 代码是有效的，并且经过分析，没有发现明显的投毒风险。该漏洞允许本地普通用户提升权限至 root。

**项目地址:** [pashayogi/ROOT-CVE-2021-3560](https://github.com/pashayogi/ROOT-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #27

**来源**: [CVE-2021-3560-secnigma_CVE-2021-3560-Polkit-Privilege-Esclation.md](../2021/CVE-2021-3560-secnigma_CVE-2021-3560-Polkit-Privilege-Esclation.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.113及更高版本，或Debian fork的0-105-26

**利用条件:** 需要安装accountsservice和gnome-control-center，且在不支持图形登录的环境下运行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560是一个polkit中的权限提升漏洞。攻击者可以通过利用D-Bus请求中的凭据检查绕过，从而将请求者的权限提升为root用户。

**有效性评估：**
根据提供的漏洞库信息、搜索引擎结果和PoC代码，此漏洞的PoC代码是有效的。漏洞信息表明该漏洞已在野外被利用 (CISA KEV目录)，并且存在公开可用的PoC。

**投毒风险评估：**
PoC代码本身是一个bash脚本，主要用于自动化漏洞利用过程。虽然脚本会尝试注入一个新的sudo用户，但这种行为是漏洞利用的必要步骤，而非隐藏的恶意代码。然而，下载和运行任何来自不可信来源的脚本始终存在风险。因此，谨慎对待脚本，在受控环境中检查代码，是降低风险的措施。
仔细分析README.md的内容，投毒风险主要来自以下几个方面：
1.  **依赖性：** 脚本依赖于`accountsservice`和`gnome-control-center`的存在。虽然这些通常是标准组件，但如果环境缺少这些组件，脚本可能无法正常工作，或者产生意想不到的错误。
2.  **Timing依赖：** 漏洞利用依赖于精确的Timing。如果Timing不正确，漏洞利用会失败，并且可能需要多次尝试。
3.  **环境限制：** 脚本警告不要在图形登录环境运行，否则会导致polkit认证循环弹出。虽然这不是恶意行为，但可能造成拒绝服务。
4. **新增用户风险:** 脚本会在sudo组添加用户,如果该用户被攻击者控制,会导致系统被远程控制,存在风险.

**利用方式：**
1.  **漏洞触发：** 攻击者发送一个D-Bus消息来触发polkit。
2.  **连接中断：** 在polkit处理请求时，攻击者突然中断连接。
3.  **权限提升：** 攻击者使用之前的bus标识符发送第二个请求，由于polkit将断开连接的UID视为0，因此第二个请求会以root权限执行。
4. **添加sudo用户:** 攻击者利用root权限添加拥有sudo权限的用户。

总而言之，该PoC的目的是为了利用CVE-2021-3560漏洞，添加sudo用户以实现权限提升。尽管PoC本身的代码没有明显的恶意行为，但依旧存在一定的投毒风险，下载和使用需谨慎。


**项目地址:** [secnigma/CVE-2021-3560-Polkit-Privilege-Esclation](https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #28

**来源**: [CVE-2021-3560-titusG85_SideWinder-Exploit.md](../2021/CVE-2021-3560-titusG85_SideWinder-Exploit.md)

## CVE-2021-3560 Polkit 权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，本地权限提升至 root

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 存在于 polkit 中，允许未经授权的本地用户通过利用 D-Bus 请求的凭据检查绕过漏洞，从而将权限提升至 root 用户。漏洞利用涉及利用 polkit 中存在的竞态条件。给定的漏洞利用代码仓库包含了一个 README.md 文件，描述了如何利用该漏洞进行权限提升练习。虽然该练习着重于教育目的，但它仍然可能被滥用，风险系数较低，只有5%。投毒风险评估基于代码仓库中是否存在隐藏的恶意代码，或对原始漏洞利用代码的修改，目的是在目标系统上执行恶意操作，如安装后门或收集敏感信息。这里主要作为教育演示，因此投毒概率较低。

**利用方式：**

1.  **竞态条件：** 利用 polkit 处理 D-Bus 请求时的竞态条件。
2.  **权限提升：** 通过精心构造的 D-Bus 请求绕过权限验证，从而以 root 权限执行操作。
3.  **本地利用：** 漏洞利用通常发生在本地，攻击者需要具有本地用户访问权限。

**项目地址:** [titusG85/SideWinder-Exploit](https://github.com/titusG85/SideWinder-Exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---



---

## POC #7

**来源**: [CVE-2021-3560-LucasPDiniz_CVE-2021-3560.md](../2021/CVE-2021-3560-LucasPDiniz_CVE-2021-3560.md)

## CVE-2021-3560 - polkit 权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可能导致本地用户获取root权限，造成数据泄露、完整性破坏和系统不可用

**影响版本:** polkit 0.113 及以后版本，部分Linux发行版（如RHEL 8, Ubuntu 20.04）

**利用条件:** 需要本地用户权限，目标系统运行存在漏洞的polkit版本，并且使用systemd和dbus

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过欺骗 polkit 绕过 D-Bus 请求的凭据检查，从而将请求者的权限提升到 root 用户。利用方式主要包括以下步骤：

1.  攻击者发送一个创建新用户或修改用户属性（例如，添加sudo权限）的D-Bus消息给 accounts-daemon。
2.  在 polkit 处理该消息之前，攻击者立即终止（kill）该 D-Bus 消息，销毁其唯一的 message ID。
3.  polkit 尝试从 dbus-daemon 获取发送消息的用户 ID，但由于 message ID 已被删除，dbus-daemon 返回错误。
4.  polkit 错误地将用户 ID 视为 0 (root 用户)，导致请求被以 root 权限执行。

**有效性：**

提供的 POC 代码描述了利用此漏洞的方法，通过手动发送 D-Bus 消息并在 polkit 验证之前终止消息，可以实现权限提升。漏洞库信息和搜索结果也证实了该漏洞的存在和利用方式，表明提供的 POC 代码具有有效性。

**投毒风险：**

虽然提供的 `README.md` 文件本身看起来是无害的，用于解释漏洞和提供利用示例，但是存在作者在其他地方（例如，在实际的攻击脚本中，如果存在）包含恶意代码的可能性。因为仅仅是一个描述文件，直接包含恶意代码可能性较低，但不能完全排除。因此，投毒风险评估为10%。如果存在配套的攻击脚本，则需要进一步审查，提高投毒风险评估。

**利用方式：**

该漏洞的利用方式是基于竞争条件，攻击者需要精确地控制 D-Bus 消息的发送和终止时机，才能成功欺骗 polkit。具体步骤如下：

1.  使用 `dbus-send` 命令构造一个需要 root 权限的操作请求（例如，创建新用户）。
2.  使用 `time` 命令测量该请求执行所需的时间。
3.  同时发送该请求和终止该请求的命令，并根据步骤2中测量的时间调整终止命令的延迟，以确保在 polkit 验证之前终止消息。
4.  如果利用成功，该操作将以 root 权限执行，从而实现权限提升。

**项目地址:** [LucasPDiniz/CVE-2021-3560](https://github.com/LucasPDiniz/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #8

**来源**: [CVE-2021-3560-MandipJoshi_CVE-2021-3560.md](../2021/CVE-2021-3560-MandipJoshi_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit 本地提权漏洞

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，可能导致任意用户提升至root权限

**影响版本:** polkit 0.119 (可能包括其他版本，需进一步验证)

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者通过操纵 D-Bus 请求绕过 Polkit 的凭据检查，从而获得 root 权限。提供的漏洞利用代码（polkit.py）通过以下步骤利用该漏洞：

1.  **检查环境:** 首先检查是否存在SSH连接，避免身份验证提示，同时检查polkit版本，确认是否为易受攻击的版本。
2.  **创建用户:** 脚本尝试通过 `dbus-send` 命令调用 `org.freedesktop.Accounts.CreateUser` 方法，快速重复创建用户，利用Polkit的竞争条件漏洞，绕过权限验证。
3.  **设置密码:** 成功创建用户后，脚本尝试使用 `org.freedesktop.Accounts.User.SetPassword` 方法为用户设置密码，同样利用竞争条件漏洞。

**有效性评估：**

根据漏洞信息和搜索结果，以及提供的POC代码，可以判断此漏洞利用是有效的。许多文章都提及了该漏洞的利用方式，并提供了POC代码。该漏洞已存在于 CISA 的已知可利用漏洞目录中，表明其已被广泛利用。

**投毒风险评估：**

代码中存在一定的投毒风险，但可能性较低(10%)。投毒代码可能存在于以下几个方面：

*   **随机数范围：** `random.uniform(0.006, 0.009)` 用于模拟竞争条件，如果这个范围被精心设计，可能会降低利用成功率或造成系统不稳定。
*   **循环次数：** 创建用户和设置密码的循环次数 (2000 和 200) 可能被修改为消耗大量资源或造成拒绝服务。
*   **错误处理：** 代码中的错误处理部分可能被修改为在特定条件下执行恶意代码。
*  **依赖注入:** 该脚本依赖于`dbus-send`工具和`apt`包管理器, 运行环境必须存在这些工具, 如果在没有这些工具的环境运行,脚本将直接退出.

总的来说，代码主要利用竞争条件，相对简单，隐藏恶意代码的空间有限，但仍需谨慎评估，在测试前进行代码审查。

**利用方式总结：**

该漏洞利用的核心在于通过竞争条件绕过 Polkit 的身份验证机制，从而执行需要 root 权限的操作。攻击者通过高频率地发送 D-Bus 请求，利用 Polkit 处理请求时的漏洞窗口，在未通过正确身份验证的情况下成功创建用户并设置密码，最终达到提权的目的。

**项目地址:** [MandipJoshi/CVE-2021-3560](https://github.com/MandipJoshi/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #9

**来源**: [CVE-2021-3560-NeonWhiteRabbit_CVE-2021-3560.md](../2021/CVE-2021-3560-NeonWhiteRabbit_CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，目标系统安装了存在漏洞的Polkit版本，并且运行了D-Bus服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者通过 D-Bus 请求绕过 Polkit 的凭据检查，从而将权限提升到 root 用户。

**有效性：**
提供的POC代码看起来是有效的。它通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户并设置密码。利用了Polkit在处理D-Bus请求时存在的缺陷，达到了提权的目的。

**投毒风险：**
虽然脚本的主要目的是利用漏洞进行提权，但仍存在一定的投毒风险。

1.  **用户创建行为：** 脚本会尝试创建一个名为`n3on`的用户。如果攻击者在受害者系统上成功执行此脚本，将会留下一个具有潜在后门的账户。虽设置密码为空，但攻击者也可以利用该账户进行进一步的渗透或破坏。
2.  **sudo -s 调用：** 脚本在最后调用了 `sudo -s`，强制切换到root用户。虽然看起来是为了方便用户在使用漏洞后立即获得root权限，但也可能被用于执行其他恶意命令。虽然whoami只是验证代码有效性
3.  **sleep 函数：** 脚本里存在 `sleep` 函数，会延迟脚本运行时间。如果攻击者恶意延长 `sleep` 的时间，可能会对系统造成拒绝服务攻击。

因此，虽然脚本的主要功能是漏洞利用，但其创建用户、执行 `sudo -s` 操作和存在sleep函数，都增加了潜在的风险。

**利用方式：**

1.  **D-Bus 交互：** 漏洞利用的核心在于通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务通信。`dbus-send` 用于发送方法调用到D-Bus总线上的服务。
2.  **用户创建：** 脚本多次尝试创建用户`n3on`。重复尝试结合kill来绕过 polkit 的某些安全检查。
3.  **密码设置：** 通过D-Bus调用`/org/freedesktop/Accounts/User1000`（假设User1000代表当前用户）的`SetPassword`方法，将密码设置为空字符串。这可能会导致用户账户安全风险。
4.  **提权：** 在成功创建用户后，脚本尝试通过`su n3on`切换到新创建的用户，然后使用 `sudo -s` 命令尝试获取 root 权限。

该漏洞利用方式的本质是利用Polkit对D-Bus消息处理的缺陷，绕过认证并执行特权操作。该漏洞利用的成功依赖于目标系统存在漏洞版本的Polkit，并且D-Bus服务正常运行。


**项目地址:** [NeonWhiteRabbit/CVE-2021-3560](https://github.com/NeonWhiteRabbit/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #10

**来源**: [CVE-2021-3560-RicterZ_CVE-2021-3560-Authentication-Agent.md](../2021/CVE-2021-3560-RicterZ_CVE-2021-3560-Authentication-Agent.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户可访问D-Bus

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞存在于 polkit 中，允许未经授权的本地攻击者通过绕过 D-Bus 请求的凭据检查，将权限提升为 root 用户。根据漏洞库信息，该漏洞的影响包括数据保密性、完整性和系统可用性。搜索结果表明，该漏洞已广泛公开，并且存在可利用的 POC。漏洞利用代码只包含Apache协议,没有发现任何有危害的代码。

**有效性：**
根据CISA已利用漏洞目录，该漏洞已被积极利用。从搜索结果来看，存在公开的利用代码，表明该漏洞可以有效利用。

**投毒风险：**
提供的漏洞利用代码仅包含 Apache 许可协议，没有发现任何可疑的恶意代码。因此，可以认为不存在投毒风险。

**利用方式：**
根据漏洞描述和搜索结果，漏洞利用方式主要涉及以下步骤：
1.  利用D-Bus与Polkit进行通信。
2.  构造特定的D-Bus请求，触发Polkit的漏洞，绕过身份验证。
3.  成功绕过身份验证后，以root权限执行任意命令。

**项目地址:** [RicterZ/CVE-2021-3560-Authentication-Agent](https://github.com/RicterZ/CVE-2021-3560-Authentication-Agent)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #11

**来源**: [CVE-2021-3560-SeimuPVE_CVE-2021-3560_Polkit.md](../2021/CVE-2021-3560-SeimuPVE_CVE-2021-3560_Polkit.md)

## CVE-2021-3560 Polkit 本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，本地用户可获得Root权限

**影响版本:** polkit 0.119 及之前版本（部分已打补丁）

**利用条件:** 本地用户权限，目标系统存在未修复的Polkit漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过操纵 D-Bus 请求绕过 Polkit 的身份验证检查，从而获得 Root 权限。提供的 Python 脚本通过检测目标系统 Polkit 版本，如果确认存在漏洞，则尝试利用该漏洞。该脚本首先检查当前用户是否为 Root 用户，然后检测操作系统信息和 Polkit 版本。根据版本信息判断是否存在漏洞。如果存在，则可以利用此漏洞获得root权限。

**有效性：**
提供的PoC代码看起来是有效的，它包含检测 Polkit 版本，检查是否为易受攻击的版本，以及进行利用的代码框架。参考链接（github.blog）也证实了该漏洞的存在以及利用方法。

**投毒风险：**
PoC代码本身逻辑清晰，主要用于检测和利用漏洞，未发现明显的恶意代码。可能的风险在于，脚本在执行某些命令时可能会受到环境变量的影响，导致执行意外的代码。脚本的目的是提升权限，因此在执行后可能留下后门或者修改系统设置，需要谨慎使用。

**利用方式：**
1.  脚本首先检测目标系统 Polkit 版本。
2.  如果版本属于易受攻击的范围，则利用漏洞绕过身份验证。
3.  利用成功后，攻击者可以执行需要 Root 权限的操作，例如创建新的管理员帐户或修改系统文件。

**项目地址:** [SeimuPVE/CVE-2021-3560_Polkit](https://github.com/SeimuPVE/CVE-2021-3560_Polkit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #12

**来源**: [CVE-2021-3560-TieuLong21Prosper_CVE-2021-3560.md](../2021/CVE-2021-3560-TieuLong21Prosper_CVE-2021-3560.md)

## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问，目标系统安装了存在漏洞的polkit版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者利用 polkit 中的缺陷绕过凭据检查，从而将权限提升为 root 用户。根据漏洞库信息和搜索结果，该漏洞已被广泛公开，并且存在可用的利用代码。提供的 Python POC 代码尝试通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户并设置密码。其利用方式是利用 polkit 对 D-Bus 请求处理的缺陷，绕过正常的身份验证流程。由于该POC代码目的明确，且没有发现任何尝试执行恶意操作，连接外部网络或者添加后门的迹象，因此，投毒风险评估为0%。

**利用方式：**

1.  利用 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户。 
2.  利用 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试设置用户密码。
3.  利用`su` 命令切换到创建的用户，然后使用 `sudo su`命令提升到 root 权限。

**有效性：**

该POC代码尝试创建用户并设置密码，如果成功，则可以利用新创建的用户登录并尝试提升权限，但是该POC 代码使用的创建用户的用户名是写死的，如果存在同名用户，则会利用失败，需要手动修改用户名，根据搜索结果，确认该漏洞已被积极利用,故该POC的有效性高。


**项目地址:** [TieuLong21Prosper/CVE-2021-3560](https://github.com/TieuLong21Prosper/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #13

**来源**: [CVE-2021-3560-UNICORDev_exploit-CVE-2021-3560.md](../2021/CVE-2021-3560-UNICORDev_exploit-CVE-2021-3560.md)

## CVE-2021-3560-polkit-本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户提权至root

**影响版本:** 0.0 - 0.118

**利用条件:** 本地用户权限，目标系统安装了存在漏洞的polkit版本，需要accountsservice, gnome-control-center, openssl, sudo

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 漏洞允许本地未经授权的攻击者通过绕过 D-Bus 请求的凭据检查来提升权限至 root 用户。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息表明该漏洞已被积极利用（KEV），并且存在公开可用的利用代码。

**投毒风险：**
代码中存在轻微的投毒风险，主要集中在以下几个方面：

1.  **依赖项安装：** Dockerfile中`apt install -y accountsservice gnome-control-center sudo openssl`命令确保了利用程序所需的依赖项已安装，但如果这些软件包的源被篡改，则可能引入恶意软件。虽然概率较低，但不能完全排除。
2.  **脚本执行：** exploit-CVE-2021-3560.py脚本从GitHub下载，如果GitHub仓库被攻陷，脚本可能被替换为恶意版本。用户应该审查下载的脚本，并验证其哈希值。

总体而言，直接的、明显的恶意代码（如反向shell或数据窃取）不存在。但是，由于脚本执行敏感操作（创建用户、修改密码、提升权限），即使是细微的偏差也可能导致安全问题，因此存在较低的投毒风险，这里评估为5%。

**利用方式：**

1.  **漏洞原理：** polkit在处理D-Bus请求时，由于未正确验证凭据，导致攻击者可以伪造请求，从而绕过身份验证。
2.  **利用步骤：**
    *   攻击者使用提供的exploit-CVE-2021-3560.py脚本，指定用户名和密码（可选）。
    *   脚本利用漏洞，在系统中创建一个具有sudo权限的新用户。
    *   攻击者可以使用新创建的用户通过`su`命令切换到该用户，然后使用`sudo su`命令获得root权限。
3.  **缓解措施：**
    *   将polkit升级到已修复的版本。
    *   限制对D-Bus的访问。
    *   监控系统中的异常用户创建和提权行为。

**项目地址:** [UNICORDev/exploit-CVE-2021-3560](https://github.com/UNICORDev/exploit-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #14

**来源**: [CVE-2021-3560-WinMin_CVE-2021-3560.md](../2021/CVE-2021-3560-WinMin_CVE-2021-3560.md)

## CVE-2021-3560-Polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** polkit 0.119

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 允许本地非特权用户通过欺骗 polkit 绕过 D-Bus 请求的凭据检查，从而将权限提升为 root 用户。漏洞利用方式如下：

1.  **漏洞原理：** Polkit 在处理 D-Bus 请求时，由于某些逻辑错误，未正确验证请求者的身份，导致可以伪造身份进行操作。
2.  **利用方式：** PoC 代码通过创建一个恶意的身份验证代理（Authentication Agent），并将其注册到 Polkit。该代理在接收到来自 Polkit 的身份验证请求时，会始终返回成功，从而允许攻击者执行需要 root 权限的操作。
3.  **代码分析：**
    *   `Makefile`：编译 `exploit.c`，链接必要的库 (`dbus-1`, `dbus-glib-1`, `gio-2.0`)。
    *   `README.md`：提供了漏洞的简要描述和使用方法。
    *   `agent.c`：实现了 D-Bus 接口 `org.freedesktop.PolicyKit1.AuthenticationAgent`，用于注册和处理来自 Polkit 的身份验证请求。关键函数 `auth_agent_handle_method_call` 接收来自 Polkit 的认证请求并发送认证通过的消息。
4.  **有效性：** PoC 代码有效，可以成功利用该漏洞。
5.  **投毒风险：** PoC 代码本身是直接利用漏洞，**潜在投毒点** 可能存在于以下方面：
    *   `agent.c`中，攻击者可能会在身份验证代理中添加额外的恶意代码，例如，在成功获得 root 权限后，执行某些恶意操作（例如安装后门、窃取数据等）。但根据目前的分析， `agent.c` 代码中没有明显的恶意行为，只是简单地模拟了认证过程。
    *   `Makefile`中，攻击者可能会修改编译选项，例如添加 `-fplugin=...` 引入恶意编译插件，或者链接额外的恶意库。当前`Makefile`没有发现异常。
    因此，认为存在小概率投毒风险，可能性为5%。主要是因为攻击者可能会在 PoC 代码中添加额外的恶意行为。
6.  **漏洞修复：** 升级 Polkit 到修复版本。

**项目地址:** [WinMin/CVE-2021-3560](https://github.com/WinMin/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #15

**来源**: [CVE-2021-3560-aancw_polkit-auto-exploit.md](../2021/CVE-2021-3560-aancw_polkit-auto-exploit.md)

## CVE-2021-3560-polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地普通用户获取root权限

**影响版本:** polkit 0.119及更早版本，受影响发行版包括RHEL 8、Ubuntu 20.04等

**利用条件:** 本地用户可以访问D-Bus

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过绕过 polkit 的身份验证检查来提升权限，最终获得 root 权限。根据提供的漏洞信息和搜索引擎结果，此漏洞影响多个 Linux 发行版。利用方式是攻击者通过 D-Bus 向 polkit 发送特权操作请求，利用 polkit 验证逻辑中的缺陷，绕过身份验证，从而执行特权操作。

**漏洞利用的有效性：**

根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以确认该漏洞利用是有效的。搜索引擎结果中包含大量关于该漏洞的分析、利用方法和受影响的发行版的信息，表明该漏洞具有实际可利用性。提供的 PoC 代码也证实了这一点。

**投毒风险：**

提供的 PoC 代码包含以下文件：LICENSE, README.md, go.mod 和一个可执行文件。 README.md 文件描述了漏洞的利用方法，并提供了示例用法。代码使用 `accountsservice` 的两个特权方法 `CreateUser` 和 `SetPassword` 来创建一个具有 sudo 权限的新用户，然后使用新用户登录并获得 root 权限。代码逻辑本身并没有明显的恶意行为。然而，仍存在一定的投毒风险：

1.  **隐藏的后门：** 虽然快速浏览代码没有发现明显后门，但由于 PoC 代码是用 Go 语言编写的，且未提供完整的源代码，无法完全排除在编译后的二进制文件中植入后门的可能。后门可能会在用户不知情的情况下执行恶意操作，例如收集系统信息、安装恶意软件等。
2.  **依赖风险：** `go.mod` 文件表明代码使用了 Go 语言的模块管理系统。如果 PoC 代码依赖了不安全的第三方模块，攻击者可能会通过篡改这些模块来引入恶意代码。
3. **延时触发:** 可能存在一些延时触发的恶意代码，这些代码可能需要满足特定条件才会执行。

因此，虽然直接证据不多，但考虑到安全风险，仍然认为此 PoC 存在一定比例的投毒风险。更完整的代码分析和代码审计才能对此做出更准确的评估。

**漏洞利用方式：**

1.  **利用 D-Bus 接口：** 攻击者利用 polkit 提供的 D-Bus 接口发送特权操作请求。
2.  **绕过身份验证：** 通过某种手段绕过 polkit 的身份验证检查。
3.  **执行特权操作：** 成功绕过身份验证后，攻击者可以执行原本需要授权才能执行的特权操作，例如创建用户、修改密码等。
4.  **提升权限：** 通过创建具有 sudo 权限的用户，或者修改现有用户的权限，最终获得 root 权限。

**项目地址:** [aancw/polkit-auto-exploit](https://github.com/aancw/polkit-auto-exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #16

**来源**: [CVE-2021-3560-admin-079_CVE-2021-3560.md](../2021/CVE-2021-3560-admin-079_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit 本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致未经授权的本地用户获取 root 权限，影响数据机密性、完整性和系统可用性。

**影响版本:** polkit 0.119 及更早版本 (根据漏洞库信息，POC 针对 0.113 及更高版本)

**利用条件:** 本地用户访问受影响的 Polkit 服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 是 Polkit 中的一个权限提升漏洞，攻击者可以通过绕过 D-Bus 请求的凭据检查，将请求者的权限提升到 root 用户。提供的 POC 代码利用了此漏洞，通过 dbus-send 命令与 Polkit 服务进行交互，创建用户并修改密码，从而获得 root 权限。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个已知的且被积极利用的漏洞。提供的 POC 代码旨在利用此漏洞。github blog的搜索结果也佐证了这一点，github上也有相关的复现仓库，快速利用可以获得系统ROOT权限.

**投毒风险：**
分析 POC 代码，代码主要功能是利用 dbus-send 命令创建用户并修改密码。代码中没有发现任何明显的恶意代码或后门。该脚本的功能就是创建一个新用户并通过漏洞提权，并不存在植入恶意程序或者其他恶意行为。因此，投毒风险较低，估计为 0%。代码的作者署名信息明确，并且提供了参考链接，可以追溯漏洞的来源和原理，进一步降低了投毒的可能性。

**利用方式：**
1.  **创建用户：** 使用 `dbus-send` 命令，通过 `org.freedesktop.Accounts.CreateUser` 方法创建一个新用户（默认为 flash）。
2.  **设置密码：** 获取新创建用户的 UID，然后使用 `dbus-send` 命令，通过 `org.freedesktop.Accounts.User.SetPassword` 方法设置用户的密码。由于漏洞的存在，可以绕过身份验证，直接设置密码。
3.  **提权：** 多次运行密码修改的命令，利用竞争条件，可以利用polkit缺陷将用户权限提升为ROOT。
4.  **登录：** 使用新创建的用户和设置的密码登录系统，此时该用户拥有 root 权限。

**优先级排序依据：**
按照题目要求，搜索引擎结果的优先级最高，漏洞利用代码次之，漏洞库信息最低。
搜索结果中，GitHub 博客文章详细描述了漏洞的原理和利用方法。漏洞利用代码展示了具体的利用步骤。漏洞库信息提供了漏洞的基本信息和影响。


**项目地址:** [admin-079/CVE-2021-3560](https://github.com/admin-079/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #17

**来源**: [CVE-2021-3560-arcslash_exploit_CVE-2021-3560.md](../2021/CVE-2021-3560-arcslash_exploit_CVE-2021-3560.md)

## CVE-2021-3560-polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地普通用户提升至root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户，目标系统安装受影响版本的polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地未经授权的用户通过利用 polkit 中的缺陷，获得 root 权限。漏洞原理是利用了 polkit 在处理 D-Bus 请求时对凭据检查的绕过。

**漏洞利用有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞确实存在并且有公开的利用方式。该漏洞已被CISA列入已知被利用的漏洞目录(KEV)。提供的POC代码利用了竞态条件，通过在 `org.freedesktop.Accounts.CreateUser` 方法执行期间的特定时间点终止 `dbus-send` 进程来绕过权限检查，从而创建具有 root 权限的用户。

**投毒风险分析：**
虽然脚本主要功能是实现权限提升，但也存在一定的投毒风险。

*   **用户创建和密码设置：** 脚本会尝试创建一个名为 john 的用户，并设置密码 john@123。如果攻击者在不知情的情况下直接使用该脚本，可能导致系统上存在一个已知的后门账号。
*   **定时炸弹风险：** 理论上，攻击者可以在脚本中添加延时执行的恶意代码，或者根据特定条件触发恶意行为，但当前的脚本并没有发现这种行为。

综合来看，投毒风险较低，但使用者需要谨慎，避免在生产环境直接使用，应进行代码审计。

**漏洞利用方式：**

1.  **竞态条件利用：** 漏洞利用的核心是利用竞态条件。脚本首先测量 `dbus-send` 命令创建用户所需的时间。
2.  **进程中断：** 脚本随后并行执行 `dbus-send` 命令，并在大约一半的测量时间后终止 `dbus-send` 进程。
3.  **绕过权限检查：** 通过在特定时刻中断进程，可以绕过 polkit 的权限检查，从而允许创建具有管理员权限的用户。
4.  **密码设置：** 如果用户创建成功，脚本会尝试使用 `openssl` 生成密码哈希，并通过 `dbus-send` 设置用户密码。
5.  **多次尝试：** 由于竞态条件的不确定性，脚本会多次尝试该过程，以增加漏洞利用的成功率。

**项目地址:** [arcslash/exploit_CVE-2021-3560](https://github.com/arcslash/exploit_CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #18

**来源**: [CVE-2021-3560-asepsaepdin_CVE-2021-3560.md](../2021/CVE-2021-3560-asepsaepdin_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit Local Privilege Escalation

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地非特权用户获取root权限，导致数据泄露、完整性破坏和系统不可用。

**影响版本:** Polkit 0.0 - 0.118

**利用条件:** 本地访问，目标系统安装了存在漏洞的Polkit版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许本地非特权用户通过绕过D-Bus请求的凭据检查来提升权限至root。提供的PoC代码通过利用此漏洞，创建一个具有指定用户名和密码的新的本地管理员。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出 Polkit 可以被欺骗绕过凭据检查，从而提升权限。搜索引擎结果也证实了该漏洞的存在，并提供了相关的利用文章和修复方案。提供的 PoC 代码也展示了如何利用该漏洞创建一个新的本地管理员。

**投毒风险：**

评估PoC代码，风险主要体现在以下几个方面：

*   **依赖安装风险：** PoC代码需要安装一些依赖，例如`gnome-control-center`, `openssl`, `sudo`，而这些依赖的安装过程可能存在风险。
*   **脚本执行风险：**  直接执行未经验证的PoC脚本始终存在潜在风险。攻击者可能在脚本中添加恶意代码，例如，删除系统关键文件、安装后门程序等。尽管目前代码没有发现恶意行为，但需要保持警惕。
*   **github仓库风险：** git clone仓库时，如果github仓库被攻陷，可能下载到被投毒的代码。

综合考虑，投毒风险评定为10%。这个百分比反应的是执行未经审查的第三方PoC代码的固有风险，而不是代码中存在明显恶意行为的确定性。

**利用方式：**

1.  **克隆PoC代码：** 从GitHub仓库克隆漏洞利用代码。
2.  **安装依赖：**  安装脚本所需的依赖项，例如 `gnome-control-center`、`openssl` 和 `sudo`。
3.  **执行漏洞利用脚本：** 运行 `exploit-CVE-2021-3560.py` 脚本，并指定要创建的用户名和密码。脚本将利用 Polkit 的漏洞绕过权限验证，创建一个新的具有 root 权限的用户。
4.  **验证：**  使用新创建的用户登录系统，并验证是否具有 root 权限。

**项目地址:** [asepsaepdin/CVE-2021-3560](https://github.com/asepsaepdin/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #19

**来源**: [CVE-2021-3560-chenaotian_CVE-2021-3560.md](../2021/CVE-2021-3560-chenaotian_CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，存在D-Bus总线和polkitd服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560是一个Polkit中的权限提升漏洞。该漏洞允许未经授权的本地用户通过欺骗Polkit绕过D-Bus请求的凭据检查，从而将权限提升为root用户。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的利用代码。CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞在野外被积极利用。提供的利用代码分析显示，利用方式是利用Polkit在处理D-Bus请求时的一个条件竞争漏洞，当D-Bus总线调用异常时，Polkit没有正确处理错误，导致将请求者的UID错误地设置为0（root用户），从而绕过权限验证。

**投毒风险：**

评估提供的POC代码是否存在投毒风险需要仔细审查代码实现。考虑到代码主要关注利用条件竞争绕过权限验证，直接植入恶意后门的概率较低。但是，仍然存在一些潜在的投毒方式，例如：

*   **微妙的修改：** 作者可能在利用代码中添加了看似无害但实际上会执行恶意操作的代码片段。例如，在权限提升后执行某些系统命令，或者修改某些配置文件。
*   **依赖项：** 作者可能引入了包含恶意代码的第三方库。
*   **触发条件：** 恶意代码可能只在特定条件下才会触发，从而避免被轻易检测到。

由于无法直接运行和调试代码，因此只能进行静态分析。根据目前的信息，评估投毒风险为10%，主要考虑的是潜在的隐蔽后门或恶意修改。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造一个特定的D-Bus请求，该请求会被Polkit处理。
2.  **竞争条件：** 攻击者需要利用条件竞争，使D-Bus总线调用失败并返回错误。
3.  **权限提升：** 由于Polkit未能正确处理错误，导致将请求者的UID错误地设置为0（root用户）。
4.  **执行恶意操作：** 攻击者现在拥有root权限，可以执行任何操作，例如创建新的管理员帐户，修改系统文件，或者安装恶意软件。

总而言之，CVE-2021-3560是一个严重的安全漏洞，应该尽快修补。在使用任何公开的利用代码之前，都应该仔细审查代码，以确保其安全性。

**项目地址:** [chenaotian/CVE-2021-3560](https://github.com/chenaotian/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #20

**来源**: [CVE-2021-3560-cpu0x00_CVE-2021-3560.md](../2021/CVE-2021-3560-cpu0x00_CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可使本地低权限用户获得root权限

**影响版本:** Polkit 0.119

**利用条件:** 本地用户，目标系统安装并运行存在漏洞的Polkit版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 允许攻击者通过绕过 D-Bus 请求的凭据检查，将请求者的权限提升为 root 用户。漏洞利用方式如下：

1.  **漏洞描述：** Polkit 在处理 D-Bus 请求时，存在身份验证绕过漏洞，攻击者可以利用该漏洞以 root 身份执行操作。
2.  **利用方式分析：**
    *   提供的`exploit.sh`脚本尝试利用该漏洞添加用户和设置密码。
    *   脚本通过`dbus-send`命令与`org.freedesktop.Accounts`服务进行交互，尝试创建用户和修改密码。
    *   脚本的实现利用了一个竞争条件，尝试在服务响应前终止连接，从而绕过权限验证。
3.  **有效性：** 根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的利用代码。提供的POC脚本尝试利用时间竞争，如果目标环境满足竞争条件的要求，则POC可能是有效的。
4.  **投毒风险：**
    *   `README.md`文件只包含漏洞名称和CTF的描述，未发现任何可疑代码。
    *   `exploit.sh`脚本本身没有发现明显的恶意代码，其行为符合漏洞利用的预期。虽然脚本尝试利用竞争条件，但这不是恶意投毒行为，而是利用漏洞的手段。
    *   因此，判断该仓库中不存在作者隐藏的投毒代码的可能性为0%。
5.  **利用方式总结：** 攻击者利用Polkit的身份验证绕过漏洞，通过构造特定的D-Bus请求，在请求处理过程中利用竞争条件，绕过权限验证，从而创建具有root权限的用户或者执行其他需要root权限的操作，最终提升到root权限。

总体而言，此漏洞是一个严重的安全问题，应该尽快修补。

**项目地址:** [cpu0x00/CVE-2021-3560](https://github.com/cpu0x00/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #21

**来源**: [CVE-2021-3560-f4T1H21_CVE-2021-3560-Polkit-DBus.md](../2021/CVE-2021-3560-f4T1H21_CVE-2021-3560-Polkit-DBus.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 允许本地未经授权的用户通过欺骗 polkit 的 D-Bus 请求凭据检查来提升权限至 root 用户。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞已被证实存在，并有公开的利用代码。

**投毒风险：**
提供的漏洞利用代码是 GNU GPL 许可证文本，并非实际的漏洞利用程序。因此，无法从中判断是否存在投毒代码。实际的利用代码可能包含恶意行为，需要进一步分析。

**利用方式：**
该漏洞利用方式为：利用Polkit的缺陷，通过精心构造的D-Bus请求绕过认证，从而以root权限执行操作。攻击者可以利用这个漏洞创建新的本地管理员或执行其他特权操作。

**总结：**
漏洞本身有效，但提供的代码片段仅为许可证，无法直接评估其安全性。实际利用时需要警惕可能存在的恶意代码。

**项目地址:** [f4T1H21/CVE-2021-3560-Polkit-DBus](https://github.com/f4T1H21/CVE-2021-3560-Polkit-DBus)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #22

**来源**: [CVE-2021-3560-hakivvi_CVE-2021-3560.md](../2021/CVE-2021-3560-hakivvi_CVE-2021-3560.md)

## CVE-2021-3560 - polkit 权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，允许本地非特权用户获得root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问，目标系统安装受影响版本的polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 是 polkit 中的一个认证绕过漏洞。该漏洞源于 `polkit_system_bus_name_get_creds_sync` 函数在获取调用者的 UID 和 PID 时存在缺陷。当调用 `GetConnectionUnixUser` 和 `GetConnectionUnixProcessID` 方法时，即使发生错误，`data.uid` 和 `data.pid` 仍然可能保持为初始化的零值。由于 polkit 认为 UID 为 0 的用户是 root 用户，因此可以绕过权限检查，从而允许非特权用户执行特权操作。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用是有效的。漏洞库信息明确指出该漏洞允许权限提升，并且CISA已将其添加到已知被利用的漏洞目录中。搜索引擎结果中也存在大量关于此漏洞的描述和利用方法。提供的POC代码描述了利用此漏洞的详细过程，包括利用D-Bus调用`CreateUser`和`SetPassword`等特权方法创建具有root权限的用户。

**投毒风险分析：**
提供的POC代码主要是C代码的解释和利用方法的描述，以及一些调用D-Bus的命令示例。从readme文件来看，它旨在通过accountsservice创建和设置密码来提升权限。虽然没有发现明显的恶意代码，但任何下载和编译的第三方代码都存在一定的风险。此外，攻击者可能修改漏洞利用代码，例如更改创建的用户名，使其更具隐蔽性或恶意性。例如，可以将用户名设置成和系统服务名称类似，以此来混淆管理员的视线。

**利用方式分析：**
1.  利用 D-Bus 向 polkit 发送特权方法调用请求（如 accountsservice 提供的 `CreateUser` 和 `SetPassword`）。
2.  利用漏洞绕过 polkit 的认证检查。
3.  polkit 错误地将非特权用户识别为 root 用户，从而允许执行特权方法。
4.  攻击者通过创建具有 root 权限的用户或修改现有用户的密码来获得系统控制权。

**投毒风险评估百分比：**
虽然README.md中提供的代码片段本身没有明显的恶意代码，但考虑到任何第三方提供的未经验证的代码都存在潜在风险，因此投毒风险评估为10%。 这个数值表示作者可能在完整代码或编译过程中隐藏恶意行为，但目前的代码片段本身看起来是合法的漏洞利用。

**项目地址:** [hakivvi/CVE-2021-3560](https://github.com/hakivvi/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #23

**来源**: [CVE-2021-3560-iSTAR-Lab_CVE-2021-3560_PoC.md](../2021/CVE-2021-3560-iSTAR-Lab_CVE-2021-3560_PoC.md)

## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** polkit 0.119

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地非特权用户通过欺骗 polkit 的 D-Bus 请求的凭据检查，从而将权限提升为 root 用户。该漏洞的利用方式是：

1.  **漏洞原理：** polkit 在处理 D-Bus 请求时，存在认证绕过缺陷，导致可以绕过授权检查。
2.  **利用方式：** PoC 脚本通过 D-Bus 接口尝试创建用户 `polkitroot`，并设置密码。利用时间竞争漏洞，在创建用户的过程中，尝试设置密码，从而绕过权限验证，最终成功创建一个具有 root 权限的用户。
3.  **有效性：** 从漏洞描述和搜索引擎结果来看，该漏洞存在且危害较大。提供的 PoC 代码针对特定版本（如 Ubuntu 20.04）有效，但可能需要在其他 Linux 发行版上进行调整。
4.  **投毒风险：** 脚本本身尝试创建一个名为 `polkitroot` 的用户并赋予其 root 权限。这本身就是利用漏洞的目的，但也可以被认为是后门。潜在的投毒风险在于脚本中的睡眠时间 (`sleep 0${half}s`) 和创建用户的重试机制。虽然脚本试图通过这些机制来提高利用成功率，但恶意攻击者可能会修改这些参数，使其在特定环境下执行恶意操作。例如，修改睡眠时间可能会导致拒绝服务攻击。脚本中的错误处理可能存在缺陷，导致在利用失败的情况下留下未清理的临时文件或异常状态，为后续攻击提供便利。

综合考虑，PoC 脚本主要用于演示漏洞，但存在一定的投毒风险，需要谨慎使用。

*投毒风险估算依据：*
*   90%代码是利用漏洞的代码，功能明确。
*   10%的代码可能存在隐藏风险，例如时间竞争相关的参数调整，可能被用于特定环境下的恶意行为。

**项目地址:** [iSTAR-Lab/CVE-2021-3560_PoC](https://github.com/iSTAR-Lab/CVE-2021-3560_PoC)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #24

**来源**: [CVE-2021-3560-innxrmxst_CVE-2021-3560.md](../2021/CVE-2021-3560-innxrmxst_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可导致本地普通用户提升为root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问权限，目标系统安装了受影响版本的Polkit

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过欺骗Polkit绕过凭据检查，从而将权限提升为root。该漏洞利用方式涉及使用dbus-send命令与org.freedesktop.Accounts服务进行交互，尝试快速创建用户，并在创建用户成功后，尝试通过类似的dbus调用来设置密码。攻击利用了Polkit在处理D-Bus请求时的漏洞，通过竞态条件或超时机制绕过权限验证。漏洞利用代码尝试创建用户'ahmed'，然后尝试设置其密码，最后尝试以该用户身份执行'sudo su'来获得root权限。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的PoC代码试图通过高频率的dbus调用来触发Polkit的漏洞，从而提升权限，该PoC代码是有效的，如果目标系统满足漏洞存在的条件。

**投毒风险：**
PoC代码主要由dbus-send命令组成，用于与systemd交互。虽然代码本身的目的在于利用漏洞，但潜在的投毒风险较低。风险点在于循环体中进程的创建和销毁，如果利用代码本身存在恶意修改，例如，在成功创建用户之后执行其他恶意操作，或者修改密码设置的逻辑以植入后门，则存在一定的投毒风险。从代码内容本身判断，投毒风险为1%，因为其行为模式符合漏洞利用的预期，且未发现明显的恶意代码。

**利用方式：**
1.  利用dbus-send命令与org.freedesktop.Accounts服务通信。
2.  尝试通过竞争条件或超时绕过身份验证。
3.  创建具有已知用户名的用户（例如 'ahmed'）。
4.  尝试为该用户设置密码。
5.  使用新创建的用户和sudo提升权限到root用户。

**项目地址:** [innxrmxst/CVE-2021-3560](https://github.com/innxrmxst/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #25

**来源**: [CVE-2021-3560-markyu0401_CVE-2021-3560-Polkit-Privilege-Escalation.md](../2021/CVE-2021-3560-markyu0401_CVE-2021-3560-Polkit-Privilege-Escalation.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可导致本地用户获取root权限，影响数据保密性、完整性和系统可用性

**影响版本:** polkit 0.119 (受影响版本)

**利用条件:** 需要本地访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许未经授权的本地用户通过利用 Polkit 中的缺陷绕过 D-Bus 请求的凭证检查，从而提升至 root 权限。漏洞利用代码通过发送精心构造的 D-Bus 消息，诱导 Polkit 产生竞争条件，从而错误地发出授权消息，绕过正常的身份验证过程。该漏洞利用依赖于精确的时间控制和多次尝试。 

**利用方式：**

1.  **竞争条件：** 利用 `dbus-send` 命令向 `org.freedesktop.Accounts` 发送 `CreateUser` 方法调用，同时使用 `sleep` 和 `kill` 命令模拟中断，创建竞争条件。
2.  **用户创建：** 通过重复发送带有中断的 `CreateUser` 请求，尝试在 Polkit 内部状态不一致时创建用户。
3.  **密码设置：** 成功创建用户后，使用 `openssl passwd` 生成密码哈希，并通过类似的竞争条件方式，利用 `dbus-send` 和 `SetPassword` 方法设置新用户的密码。
4.  **权限切换：** 使用 `su` 命令切换到新创建的用户，并使用 `sudo` 命令验证权限提升。

**有效性：**

提供的漏洞利用代码基于时间竞争，因此需要多次尝试才能成功。考虑到CISA的KEV条目以及大量公开可用的利用程序和漏洞分析，该PoC代码被认为是有效的。

**投毒风险：**

风险评估是基于以下因素：

1.  **代码复杂性：**  脚本相对简单，主要依赖于标准的 `dbus-send` 命令和 shell 脚本。
2.  **作者意图：**  作者提供了构建和运行容器的说明，这似乎是为了方便漏洞测试，而不是隐藏恶意代码。
3.  **可疑行为：**  在 `README.md` 中有执行时间的提示以及需要多次执行的步骤，这符合竞争条件漏洞利用的特征。
4. **潜在的投毒点:** PoC的有效性依赖于`sleep`命令的参数，即X.XXX的取值。如果该值被篡改为非常大的值，可能导致拒绝服务攻击。但是，这更像是可用性问题，而不是后门或者提权。另一种可能的攻击是替换`openssl passwd`为恶意程序。最后，构建容器的Dockerfile可能包含后门（例如，安装恶意软件包）。

基于以上分析，虽然存在一定的投毒风险（例如，替换 `openssl passwd` 命令），但主要风险在于利用过程的复杂性和对环境的依赖性。假设容器构建过程可信，没有发现明显的恶意代码。因此，投毒风险被评估为 10%。

**项目地址:** [markyu0401/CVE-2021-3560-Polkit-Privilege-Escalation](https://github.com/markyu0401/CVE-2021-3560-Polkit-Privilege-Escalation)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #26

**来源**: [CVE-2021-3560-pashayogi_ROOT-CVE-2021-3560.md](../2021/CVE-2021-3560-pashayogi_ROOT-CVE-2021-3560.md)

## CVE-2021-3560-Polkit-本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户提升权限至root

**影响版本:** polkit 0.105-26, polkit 0.117-2 和 polkit 0.119

**利用条件:** 本地用户需要SSH登录，而不是直接在桌面终端运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许本地未经授权的攻击者通过绕过 D-Bus 请求的凭据检查来提升权限至 root 用户。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC。
根据提供的PoC代码，该脚本尝试创建一个新用户，并设置密码。利用了Polkit在处理D-Bus请求时的漏洞，通过竞争条件来修改`/etc/shadow`文件，从而为新用户设置密码，并将其加入管理员组。

**投毒风险分析：**
查看 root.sh 脚本，该脚本主要功能是创建用户并修改 /etc/shadow 文件，逻辑较为清晰。
*   **用户创建:** 脚本首先检测是否存在目标用户，如果不存在则通过 `dbus-send` 创建用户。这里使用了竞争条件，通过并发的 `dbus-send` 请求和 `kill` 命令，试图绕过 Polkit 的权限验证。
*   **密码设置:** 脚本获取 `/etc/shadow` 文件的修改时间戳，然后循环尝试使用 `dbus-send` 修改用户的密码，同样利用了竞争条件。
*   **依赖:** 脚本依赖 `dbus-send`，`systemctl`, `stat`, `id`, `grep`, `cut`, `bc`, `sleep` 等常见的系统命令。
脚本中没有发现任何明显的恶意代码，例如反弹 shell，删除文件，或植入后门等操作。没有发现任何可以被判定为投毒的代码。
因此，投毒风险评估为 0%。

**利用方式：**
1.  **漏洞触发：**利用 Polkit 在处理 D-Bus 请求时的缺陷，绕过权限验证。
2.  **用户创建：**使用 `dbus-send` 命令尝试创建一个具有管理员权限的新用户。
3.  **密码设置：**通过竞争条件修改 `/etc/shadow` 文件，为新创建的用户设置密码。
4.  **权限提升：** 使用新创建的用户登录，并通过 `sudo su` 命令获得 root 权限。

**总结：** 提供的 PoC 代码是有效的，并且经过分析，没有发现明显的投毒风险。该漏洞允许本地普通用户提升权限至 root。

**项目地址:** [pashayogi/ROOT-CVE-2021-3560](https://github.com/pashayogi/ROOT-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #27

**来源**: [CVE-2021-3560-secnigma_CVE-2021-3560-Polkit-Privilege-Esclation.md](../2021/CVE-2021-3560-secnigma_CVE-2021-3560-Polkit-Privilege-Esclation.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.113及更高版本，或Debian fork的0-105-26

**利用条件:** 需要安装accountsservice和gnome-control-center，且在不支持图形登录的环境下运行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560是一个polkit中的权限提升漏洞。攻击者可以通过利用D-Bus请求中的凭据检查绕过，从而将请求者的权限提升为root用户。

**有效性评估：**
根据提供的漏洞库信息、搜索引擎结果和PoC代码，此漏洞的PoC代码是有效的。漏洞信息表明该漏洞已在野外被利用 (CISA KEV目录)，并且存在公开可用的PoC。

**投毒风险评估：**
PoC代码本身是一个bash脚本，主要用于自动化漏洞利用过程。虽然脚本会尝试注入一个新的sudo用户，但这种行为是漏洞利用的必要步骤，而非隐藏的恶意代码。然而，下载和运行任何来自不可信来源的脚本始终存在风险。因此，谨慎对待脚本，在受控环境中检查代码，是降低风险的措施。
仔细分析README.md的内容，投毒风险主要来自以下几个方面：
1.  **依赖性：** 脚本依赖于`accountsservice`和`gnome-control-center`的存在。虽然这些通常是标准组件，但如果环境缺少这些组件，脚本可能无法正常工作，或者产生意想不到的错误。
2.  **Timing依赖：** 漏洞利用依赖于精确的Timing。如果Timing不正确，漏洞利用会失败，并且可能需要多次尝试。
3.  **环境限制：** 脚本警告不要在图形登录环境运行，否则会导致polkit认证循环弹出。虽然这不是恶意行为，但可能造成拒绝服务。
4. **新增用户风险:** 脚本会在sudo组添加用户,如果该用户被攻击者控制,会导致系统被远程控制,存在风险.

**利用方式：**
1.  **漏洞触发：** 攻击者发送一个D-Bus消息来触发polkit。
2.  **连接中断：** 在polkit处理请求时，攻击者突然中断连接。
3.  **权限提升：** 攻击者使用之前的bus标识符发送第二个请求，由于polkit将断开连接的UID视为0，因此第二个请求会以root权限执行。
4. **添加sudo用户:** 攻击者利用root权限添加拥有sudo权限的用户。

总而言之，该PoC的目的是为了利用CVE-2021-3560漏洞，添加sudo用户以实现权限提升。尽管PoC本身的代码没有明显的恶意行为，但依旧存在一定的投毒风险，下载和使用需谨慎。


**项目地址:** [secnigma/CVE-2021-3560-Polkit-Privilege-Esclation](https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #28

**来源**: [CVE-2021-3560-titusG85_SideWinder-Exploit.md](../2021/CVE-2021-3560-titusG85_SideWinder-Exploit.md)

## CVE-2021-3560 Polkit 权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，本地权限提升至 root

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 存在于 polkit 中，允许未经授权的本地用户通过利用 D-Bus 请求的凭据检查绕过漏洞，从而将权限提升至 root 用户。漏洞利用涉及利用 polkit 中存在的竞态条件。给定的漏洞利用代码仓库包含了一个 README.md 文件，描述了如何利用该漏洞进行权限提升练习。虽然该练习着重于教育目的，但它仍然可能被滥用，风险系数较低，只有5%。投毒风险评估基于代码仓库中是否存在隐藏的恶意代码，或对原始漏洞利用代码的修改，目的是在目标系统上执行恶意操作，如安装后门或收集敏感信息。这里主要作为教育演示，因此投毒概率较低。

**利用方式：**

1.  **竞态条件：** 利用 polkit 处理 D-Bus 请求时的竞态条件。
2.  **权限提升：** 通过精心构造的 D-Bus 请求绕过权限验证，从而以 root 权限执行操作。
3.  **本地利用：** 漏洞利用通常发生在本地，攻击者需要具有本地用户访问权限。

**项目地址:** [titusG85/SideWinder-Exploit](https://github.com/titusG85/SideWinder-Exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---



---

## POC #7

**来源**: [CVE-2021-3560-LucasPDiniz_CVE-2021-3560.md](../2021/CVE-2021-3560-LucasPDiniz_CVE-2021-3560.md)

## CVE-2021-3560 - polkit 权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可能导致本地用户获取root权限，造成数据泄露、完整性破坏和系统不可用

**影响版本:** polkit 0.113 及以后版本，部分Linux发行版（如RHEL 8, Ubuntu 20.04）

**利用条件:** 需要本地用户权限，目标系统运行存在漏洞的polkit版本，并且使用systemd和dbus

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过欺骗 polkit 绕过 D-Bus 请求的凭据检查，从而将请求者的权限提升到 root 用户。利用方式主要包括以下步骤：

1.  攻击者发送一个创建新用户或修改用户属性（例如，添加sudo权限）的D-Bus消息给 accounts-daemon。
2.  在 polkit 处理该消息之前，攻击者立即终止（kill）该 D-Bus 消息，销毁其唯一的 message ID。
3.  polkit 尝试从 dbus-daemon 获取发送消息的用户 ID，但由于 message ID 已被删除，dbus-daemon 返回错误。
4.  polkit 错误地将用户 ID 视为 0 (root 用户)，导致请求被以 root 权限执行。

**有效性：**

提供的 POC 代码描述了利用此漏洞的方法，通过手动发送 D-Bus 消息并在 polkit 验证之前终止消息，可以实现权限提升。漏洞库信息和搜索结果也证实了该漏洞的存在和利用方式，表明提供的 POC 代码具有有效性。

**投毒风险：**

虽然提供的 `README.md` 文件本身看起来是无害的，用于解释漏洞和提供利用示例，但是存在作者在其他地方（例如，在实际的攻击脚本中，如果存在）包含恶意代码的可能性。因为仅仅是一个描述文件，直接包含恶意代码可能性较低，但不能完全排除。因此，投毒风险评估为10%。如果存在配套的攻击脚本，则需要进一步审查，提高投毒风险评估。

**利用方式：**

该漏洞的利用方式是基于竞争条件，攻击者需要精确地控制 D-Bus 消息的发送和终止时机，才能成功欺骗 polkit。具体步骤如下：

1.  使用 `dbus-send` 命令构造一个需要 root 权限的操作请求（例如，创建新用户）。
2.  使用 `time` 命令测量该请求执行所需的时间。
3.  同时发送该请求和终止该请求的命令，并根据步骤2中测量的时间调整终止命令的延迟，以确保在 polkit 验证之前终止消息。
4.  如果利用成功，该操作将以 root 权限执行，从而实现权限提升。

**项目地址:** [LucasPDiniz/CVE-2021-3560](https://github.com/LucasPDiniz/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #8

**来源**: [CVE-2021-3560-MandipJoshi_CVE-2021-3560.md](../2021/CVE-2021-3560-MandipJoshi_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit 本地提权漏洞

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，可能导致任意用户提升至root权限

**影响版本:** polkit 0.119 (可能包括其他版本，需进一步验证)

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者通过操纵 D-Bus 请求绕过 Polkit 的凭据检查，从而获得 root 权限。提供的漏洞利用代码（polkit.py）通过以下步骤利用该漏洞：

1.  **检查环境:** 首先检查是否存在SSH连接，避免身份验证提示，同时检查polkit版本，确认是否为易受攻击的版本。
2.  **创建用户:** 脚本尝试通过 `dbus-send` 命令调用 `org.freedesktop.Accounts.CreateUser` 方法，快速重复创建用户，利用Polkit的竞争条件漏洞，绕过权限验证。
3.  **设置密码:** 成功创建用户后，脚本尝试使用 `org.freedesktop.Accounts.User.SetPassword` 方法为用户设置密码，同样利用竞争条件漏洞。

**有效性评估：**

根据漏洞信息和搜索结果，以及提供的POC代码，可以判断此漏洞利用是有效的。许多文章都提及了该漏洞的利用方式，并提供了POC代码。该漏洞已存在于 CISA 的已知可利用漏洞目录中，表明其已被广泛利用。

**投毒风险评估：**

代码中存在一定的投毒风险，但可能性较低(10%)。投毒代码可能存在于以下几个方面：

*   **随机数范围：** `random.uniform(0.006, 0.009)` 用于模拟竞争条件，如果这个范围被精心设计，可能会降低利用成功率或造成系统不稳定。
*   **循环次数：** 创建用户和设置密码的循环次数 (2000 和 200) 可能被修改为消耗大量资源或造成拒绝服务。
*   **错误处理：** 代码中的错误处理部分可能被修改为在特定条件下执行恶意代码。
*  **依赖注入:** 该脚本依赖于`dbus-send`工具和`apt`包管理器, 运行环境必须存在这些工具, 如果在没有这些工具的环境运行,脚本将直接退出.

总的来说，代码主要利用竞争条件，相对简单，隐藏恶意代码的空间有限，但仍需谨慎评估，在测试前进行代码审查。

**利用方式总结：**

该漏洞利用的核心在于通过竞争条件绕过 Polkit 的身份验证机制，从而执行需要 root 权限的操作。攻击者通过高频率地发送 D-Bus 请求，利用 Polkit 处理请求时的漏洞窗口，在未通过正确身份验证的情况下成功创建用户并设置密码，最终达到提权的目的。

**项目地址:** [MandipJoshi/CVE-2021-3560](https://github.com/MandipJoshi/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #9

**来源**: [CVE-2021-3560-NeonWhiteRabbit_CVE-2021-3560.md](../2021/CVE-2021-3560-NeonWhiteRabbit_CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，目标系统安装了存在漏洞的Polkit版本，并且运行了D-Bus服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者通过 D-Bus 请求绕过 Polkit 的凭据检查，从而将权限提升到 root 用户。

**有效性：**
提供的POC代码看起来是有效的。它通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户并设置密码。利用了Polkit在处理D-Bus请求时存在的缺陷，达到了提权的目的。

**投毒风险：**
虽然脚本的主要目的是利用漏洞进行提权，但仍存在一定的投毒风险。

1.  **用户创建行为：** 脚本会尝试创建一个名为`n3on`的用户。如果攻击者在受害者系统上成功执行此脚本，将会留下一个具有潜在后门的账户。虽设置密码为空，但攻击者也可以利用该账户进行进一步的渗透或破坏。
2.  **sudo -s 调用：** 脚本在最后调用了 `sudo -s`，强制切换到root用户。虽然看起来是为了方便用户在使用漏洞后立即获得root权限，但也可能被用于执行其他恶意命令。虽然whoami只是验证代码有效性
3.  **sleep 函数：** 脚本里存在 `sleep` 函数，会延迟脚本运行时间。如果攻击者恶意延长 `sleep` 的时间，可能会对系统造成拒绝服务攻击。

因此，虽然脚本的主要功能是漏洞利用，但其创建用户、执行 `sudo -s` 操作和存在sleep函数，都增加了潜在的风险。

**利用方式：**

1.  **D-Bus 交互：** 漏洞利用的核心在于通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务通信。`dbus-send` 用于发送方法调用到D-Bus总线上的服务。
2.  **用户创建：** 脚本多次尝试创建用户`n3on`。重复尝试结合kill来绕过 polkit 的某些安全检查。
3.  **密码设置：** 通过D-Bus调用`/org/freedesktop/Accounts/User1000`（假设User1000代表当前用户）的`SetPassword`方法，将密码设置为空字符串。这可能会导致用户账户安全风险。
4.  **提权：** 在成功创建用户后，脚本尝试通过`su n3on`切换到新创建的用户，然后使用 `sudo -s` 命令尝试获取 root 权限。

该漏洞利用方式的本质是利用Polkit对D-Bus消息处理的缺陷，绕过认证并执行特权操作。该漏洞利用的成功依赖于目标系统存在漏洞版本的Polkit，并且D-Bus服务正常运行。


**项目地址:** [NeonWhiteRabbit/CVE-2021-3560](https://github.com/NeonWhiteRabbit/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #10

**来源**: [CVE-2021-3560-RicterZ_CVE-2021-3560-Authentication-Agent.md](../2021/CVE-2021-3560-RicterZ_CVE-2021-3560-Authentication-Agent.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户可访问D-Bus

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞存在于 polkit 中，允许未经授权的本地攻击者通过绕过 D-Bus 请求的凭据检查，将权限提升为 root 用户。根据漏洞库信息，该漏洞的影响包括数据保密性、完整性和系统可用性。搜索结果表明，该漏洞已广泛公开，并且存在可利用的 POC。漏洞利用代码只包含Apache协议,没有发现任何有危害的代码。

**有效性：**
根据CISA已利用漏洞目录，该漏洞已被积极利用。从搜索结果来看，存在公开的利用代码，表明该漏洞可以有效利用。

**投毒风险：**
提供的漏洞利用代码仅包含 Apache 许可协议，没有发现任何可疑的恶意代码。因此，可以认为不存在投毒风险。

**利用方式：**
根据漏洞描述和搜索结果，漏洞利用方式主要涉及以下步骤：
1.  利用D-Bus与Polkit进行通信。
2.  构造特定的D-Bus请求，触发Polkit的漏洞，绕过身份验证。
3.  成功绕过身份验证后，以root权限执行任意命令。

**项目地址:** [RicterZ/CVE-2021-3560-Authentication-Agent](https://github.com/RicterZ/CVE-2021-3560-Authentication-Agent)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #11

**来源**: [CVE-2021-3560-SeimuPVE_CVE-2021-3560_Polkit.md](../2021/CVE-2021-3560-SeimuPVE_CVE-2021-3560_Polkit.md)

## CVE-2021-3560 Polkit 本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，本地用户可获得Root权限

**影响版本:** polkit 0.119 及之前版本（部分已打补丁）

**利用条件:** 本地用户权限，目标系统存在未修复的Polkit漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过操纵 D-Bus 请求绕过 Polkit 的身份验证检查，从而获得 Root 权限。提供的 Python 脚本通过检测目标系统 Polkit 版本，如果确认存在漏洞，则尝试利用该漏洞。该脚本首先检查当前用户是否为 Root 用户，然后检测操作系统信息和 Polkit 版本。根据版本信息判断是否存在漏洞。如果存在，则可以利用此漏洞获得root权限。

**有效性：**
提供的PoC代码看起来是有效的，它包含检测 Polkit 版本，检查是否为易受攻击的版本，以及进行利用的代码框架。参考链接（github.blog）也证实了该漏洞的存在以及利用方法。

**投毒风险：**
PoC代码本身逻辑清晰，主要用于检测和利用漏洞，未发现明显的恶意代码。可能的风险在于，脚本在执行某些命令时可能会受到环境变量的影响，导致执行意外的代码。脚本的目的是提升权限，因此在执行后可能留下后门或者修改系统设置，需要谨慎使用。

**利用方式：**
1.  脚本首先检测目标系统 Polkit 版本。
2.  如果版本属于易受攻击的范围，则利用漏洞绕过身份验证。
3.  利用成功后，攻击者可以执行需要 Root 权限的操作，例如创建新的管理员帐户或修改系统文件。

**项目地址:** [SeimuPVE/CVE-2021-3560_Polkit](https://github.com/SeimuPVE/CVE-2021-3560_Polkit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #12

**来源**: [CVE-2021-3560-TieuLong21Prosper_CVE-2021-3560.md](../2021/CVE-2021-3560-TieuLong21Prosper_CVE-2021-3560.md)

## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问，目标系统安装了存在漏洞的polkit版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者利用 polkit 中的缺陷绕过凭据检查，从而将权限提升为 root 用户。根据漏洞库信息和搜索结果，该漏洞已被广泛公开，并且存在可用的利用代码。提供的 Python POC 代码尝试通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户并设置密码。其利用方式是利用 polkit 对 D-Bus 请求处理的缺陷，绕过正常的身份验证流程。由于该POC代码目的明确，且没有发现任何尝试执行恶意操作，连接外部网络或者添加后门的迹象，因此，投毒风险评估为0%。

**利用方式：**

1.  利用 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户。 
2.  利用 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试设置用户密码。
3.  利用`su` 命令切换到创建的用户，然后使用 `sudo su`命令提升到 root 权限。

**有效性：**

该POC代码尝试创建用户并设置密码，如果成功，则可以利用新创建的用户登录并尝试提升权限，但是该POC 代码使用的创建用户的用户名是写死的，如果存在同名用户，则会利用失败，需要手动修改用户名，根据搜索结果，确认该漏洞已被积极利用,故该POC的有效性高。


**项目地址:** [TieuLong21Prosper/CVE-2021-3560](https://github.com/TieuLong21Prosper/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #13

**来源**: [CVE-2021-3560-UNICORDev_exploit-CVE-2021-3560.md](../2021/CVE-2021-3560-UNICORDev_exploit-CVE-2021-3560.md)

## CVE-2021-3560-polkit-本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户提权至root

**影响版本:** 0.0 - 0.118

**利用条件:** 本地用户权限，目标系统安装了存在漏洞的polkit版本，需要accountsservice, gnome-control-center, openssl, sudo

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 漏洞允许本地未经授权的攻击者通过绕过 D-Bus 请求的凭据检查来提升权限至 root 用户。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息表明该漏洞已被积极利用（KEV），并且存在公开可用的利用代码。

**投毒风险：**
代码中存在轻微的投毒风险，主要集中在以下几个方面：

1.  **依赖项安装：** Dockerfile中`apt install -y accountsservice gnome-control-center sudo openssl`命令确保了利用程序所需的依赖项已安装，但如果这些软件包的源被篡改，则可能引入恶意软件。虽然概率较低，但不能完全排除。
2.  **脚本执行：** exploit-CVE-2021-3560.py脚本从GitHub下载，如果GitHub仓库被攻陷，脚本可能被替换为恶意版本。用户应该审查下载的脚本，并验证其哈希值。

总体而言，直接的、明显的恶意代码（如反向shell或数据窃取）不存在。但是，由于脚本执行敏感操作（创建用户、修改密码、提升权限），即使是细微的偏差也可能导致安全问题，因此存在较低的投毒风险，这里评估为5%。

**利用方式：**

1.  **漏洞原理：** polkit在处理D-Bus请求时，由于未正确验证凭据，导致攻击者可以伪造请求，从而绕过身份验证。
2.  **利用步骤：**
    *   攻击者使用提供的exploit-CVE-2021-3560.py脚本，指定用户名和密码（可选）。
    *   脚本利用漏洞，在系统中创建一个具有sudo权限的新用户。
    *   攻击者可以使用新创建的用户通过`su`命令切换到该用户，然后使用`sudo su`命令获得root权限。
3.  **缓解措施：**
    *   将polkit升级到已修复的版本。
    *   限制对D-Bus的访问。
    *   监控系统中的异常用户创建和提权行为。

**项目地址:** [UNICORDev/exploit-CVE-2021-3560](https://github.com/UNICORDev/exploit-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #14

**来源**: [CVE-2021-3560-WinMin_CVE-2021-3560.md](../2021/CVE-2021-3560-WinMin_CVE-2021-3560.md)

## CVE-2021-3560-Polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** polkit 0.119

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 允许本地非特权用户通过欺骗 polkit 绕过 D-Bus 请求的凭据检查，从而将权限提升为 root 用户。漏洞利用方式如下：

1.  **漏洞原理：** Polkit 在处理 D-Bus 请求时，由于某些逻辑错误，未正确验证请求者的身份，导致可以伪造身份进行操作。
2.  **利用方式：** PoC 代码通过创建一个恶意的身份验证代理（Authentication Agent），并将其注册到 Polkit。该代理在接收到来自 Polkit 的身份验证请求时，会始终返回成功，从而允许攻击者执行需要 root 权限的操作。
3.  **代码分析：**
    *   `Makefile`：编译 `exploit.c`，链接必要的库 (`dbus-1`, `dbus-glib-1`, `gio-2.0`)。
    *   `README.md`：提供了漏洞的简要描述和使用方法。
    *   `agent.c`：实现了 D-Bus 接口 `org.freedesktop.PolicyKit1.AuthenticationAgent`，用于注册和处理来自 Polkit 的身份验证请求。关键函数 `auth_agent_handle_method_call` 接收来自 Polkit 的认证请求并发送认证通过的消息。
4.  **有效性：** PoC 代码有效，可以成功利用该漏洞。
5.  **投毒风险：** PoC 代码本身是直接利用漏洞，**潜在投毒点** 可能存在于以下方面：
    *   `agent.c`中，攻击者可能会在身份验证代理中添加额外的恶意代码，例如，在成功获得 root 权限后，执行某些恶意操作（例如安装后门、窃取数据等）。但根据目前的分析， `agent.c` 代码中没有明显的恶意行为，只是简单地模拟了认证过程。
    *   `Makefile`中，攻击者可能会修改编译选项，例如添加 `-fplugin=...` 引入恶意编译插件，或者链接额外的恶意库。当前`Makefile`没有发现异常。
    因此，认为存在小概率投毒风险，可能性为5%。主要是因为攻击者可能会在 PoC 代码中添加额外的恶意行为。
6.  **漏洞修复：** 升级 Polkit 到修复版本。

**项目地址:** [WinMin/CVE-2021-3560](https://github.com/WinMin/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #15

**来源**: [CVE-2021-3560-aancw_polkit-auto-exploit.md](../2021/CVE-2021-3560-aancw_polkit-auto-exploit.md)

## CVE-2021-3560-polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地普通用户获取root权限

**影响版本:** polkit 0.119及更早版本，受影响发行版包括RHEL 8、Ubuntu 20.04等

**利用条件:** 本地用户可以访问D-Bus

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过绕过 polkit 的身份验证检查来提升权限，最终获得 root 权限。根据提供的漏洞信息和搜索引擎结果，此漏洞影响多个 Linux 发行版。利用方式是攻击者通过 D-Bus 向 polkit 发送特权操作请求，利用 polkit 验证逻辑中的缺陷，绕过身份验证，从而执行特权操作。

**漏洞利用的有效性：**

根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以确认该漏洞利用是有效的。搜索引擎结果中包含大量关于该漏洞的分析、利用方法和受影响的发行版的信息，表明该漏洞具有实际可利用性。提供的 PoC 代码也证实了这一点。

**投毒风险：**

提供的 PoC 代码包含以下文件：LICENSE, README.md, go.mod 和一个可执行文件。 README.md 文件描述了漏洞的利用方法，并提供了示例用法。代码使用 `accountsservice` 的两个特权方法 `CreateUser` 和 `SetPassword` 来创建一个具有 sudo 权限的新用户，然后使用新用户登录并获得 root 权限。代码逻辑本身并没有明显的恶意行为。然而，仍存在一定的投毒风险：

1.  **隐藏的后门：** 虽然快速浏览代码没有发现明显后门，但由于 PoC 代码是用 Go 语言编写的，且未提供完整的源代码，无法完全排除在编译后的二进制文件中植入后门的可能。后门可能会在用户不知情的情况下执行恶意操作，例如收集系统信息、安装恶意软件等。
2.  **依赖风险：** `go.mod` 文件表明代码使用了 Go 语言的模块管理系统。如果 PoC 代码依赖了不安全的第三方模块，攻击者可能会通过篡改这些模块来引入恶意代码。
3. **延时触发:** 可能存在一些延时触发的恶意代码，这些代码可能需要满足特定条件才会执行。

因此，虽然直接证据不多，但考虑到安全风险，仍然认为此 PoC 存在一定比例的投毒风险。更完整的代码分析和代码审计才能对此做出更准确的评估。

**漏洞利用方式：**

1.  **利用 D-Bus 接口：** 攻击者利用 polkit 提供的 D-Bus 接口发送特权操作请求。
2.  **绕过身份验证：** 通过某种手段绕过 polkit 的身份验证检查。
3.  **执行特权操作：** 成功绕过身份验证后，攻击者可以执行原本需要授权才能执行的特权操作，例如创建用户、修改密码等。
4.  **提升权限：** 通过创建具有 sudo 权限的用户，或者修改现有用户的权限，最终获得 root 权限。

**项目地址:** [aancw/polkit-auto-exploit](https://github.com/aancw/polkit-auto-exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #16

**来源**: [CVE-2021-3560-admin-079_CVE-2021-3560.md](../2021/CVE-2021-3560-admin-079_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit 本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致未经授权的本地用户获取 root 权限，影响数据机密性、完整性和系统可用性。

**影响版本:** polkit 0.119 及更早版本 (根据漏洞库信息，POC 针对 0.113 及更高版本)

**利用条件:** 本地用户访问受影响的 Polkit 服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 是 Polkit 中的一个权限提升漏洞，攻击者可以通过绕过 D-Bus 请求的凭据检查，将请求者的权限提升到 root 用户。提供的 POC 代码利用了此漏洞，通过 dbus-send 命令与 Polkit 服务进行交互，创建用户并修改密码，从而获得 root 权限。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个已知的且被积极利用的漏洞。提供的 POC 代码旨在利用此漏洞。github blog的搜索结果也佐证了这一点，github上也有相关的复现仓库，快速利用可以获得系统ROOT权限.

**投毒风险：**
分析 POC 代码，代码主要功能是利用 dbus-send 命令创建用户并修改密码。代码中没有发现任何明显的恶意代码或后门。该脚本的功能就是创建一个新用户并通过漏洞提权，并不存在植入恶意程序或者其他恶意行为。因此，投毒风险较低，估计为 0%。代码的作者署名信息明确，并且提供了参考链接，可以追溯漏洞的来源和原理，进一步降低了投毒的可能性。

**利用方式：**
1.  **创建用户：** 使用 `dbus-send` 命令，通过 `org.freedesktop.Accounts.CreateUser` 方法创建一个新用户（默认为 flash）。
2.  **设置密码：** 获取新创建用户的 UID，然后使用 `dbus-send` 命令，通过 `org.freedesktop.Accounts.User.SetPassword` 方法设置用户的密码。由于漏洞的存在，可以绕过身份验证，直接设置密码。
3.  **提权：** 多次运行密码修改的命令，利用竞争条件，可以利用polkit缺陷将用户权限提升为ROOT。
4.  **登录：** 使用新创建的用户和设置的密码登录系统，此时该用户拥有 root 权限。

**优先级排序依据：**
按照题目要求，搜索引擎结果的优先级最高，漏洞利用代码次之，漏洞库信息最低。
搜索结果中，GitHub 博客文章详细描述了漏洞的原理和利用方法。漏洞利用代码展示了具体的利用步骤。漏洞库信息提供了漏洞的基本信息和影响。


**项目地址:** [admin-079/CVE-2021-3560](https://github.com/admin-079/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #17

**来源**: [CVE-2021-3560-arcslash_exploit_CVE-2021-3560.md](../2021/CVE-2021-3560-arcslash_exploit_CVE-2021-3560.md)

## CVE-2021-3560-polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地普通用户提升至root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户，目标系统安装受影响版本的polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地未经授权的用户通过利用 polkit 中的缺陷，获得 root 权限。漏洞原理是利用了 polkit 在处理 D-Bus 请求时对凭据检查的绕过。

**漏洞利用有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞确实存在并且有公开的利用方式。该漏洞已被CISA列入已知被利用的漏洞目录(KEV)。提供的POC代码利用了竞态条件，通过在 `org.freedesktop.Accounts.CreateUser` 方法执行期间的特定时间点终止 `dbus-send` 进程来绕过权限检查，从而创建具有 root 权限的用户。

**投毒风险分析：**
虽然脚本主要功能是实现权限提升，但也存在一定的投毒风险。

*   **用户创建和密码设置：** 脚本会尝试创建一个名为 john 的用户，并设置密码 john@123。如果攻击者在不知情的情况下直接使用该脚本，可能导致系统上存在一个已知的后门账号。
*   **定时炸弹风险：** 理论上，攻击者可以在脚本中添加延时执行的恶意代码，或者根据特定条件触发恶意行为，但当前的脚本并没有发现这种行为。

综合来看，投毒风险较低，但使用者需要谨慎，避免在生产环境直接使用，应进行代码审计。

**漏洞利用方式：**

1.  **竞态条件利用：** 漏洞利用的核心是利用竞态条件。脚本首先测量 `dbus-send` 命令创建用户所需的时间。
2.  **进程中断：** 脚本随后并行执行 `dbus-send` 命令，并在大约一半的测量时间后终止 `dbus-send` 进程。
3.  **绕过权限检查：** 通过在特定时刻中断进程，可以绕过 polkit 的权限检查，从而允许创建具有管理员权限的用户。
4.  **密码设置：** 如果用户创建成功，脚本会尝试使用 `openssl` 生成密码哈希，并通过 `dbus-send` 设置用户密码。
5.  **多次尝试：** 由于竞态条件的不确定性，脚本会多次尝试该过程，以增加漏洞利用的成功率。

**项目地址:** [arcslash/exploit_CVE-2021-3560](https://github.com/arcslash/exploit_CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #18

**来源**: [CVE-2021-3560-asepsaepdin_CVE-2021-3560.md](../2021/CVE-2021-3560-asepsaepdin_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit Local Privilege Escalation

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地非特权用户获取root权限，导致数据泄露、完整性破坏和系统不可用。

**影响版本:** Polkit 0.0 - 0.118

**利用条件:** 本地访问，目标系统安装了存在漏洞的Polkit版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许本地非特权用户通过绕过D-Bus请求的凭据检查来提升权限至root。提供的PoC代码通过利用此漏洞，创建一个具有指定用户名和密码的新的本地管理员。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出 Polkit 可以被欺骗绕过凭据检查，从而提升权限。搜索引擎结果也证实了该漏洞的存在，并提供了相关的利用文章和修复方案。提供的 PoC 代码也展示了如何利用该漏洞创建一个新的本地管理员。

**投毒风险：**

评估PoC代码，风险主要体现在以下几个方面：

*   **依赖安装风险：** PoC代码需要安装一些依赖，例如`gnome-control-center`, `openssl`, `sudo`，而这些依赖的安装过程可能存在风险。
*   **脚本执行风险：**  直接执行未经验证的PoC脚本始终存在潜在风险。攻击者可能在脚本中添加恶意代码，例如，删除系统关键文件、安装后门程序等。尽管目前代码没有发现恶意行为，但需要保持警惕。
*   **github仓库风险：** git clone仓库时，如果github仓库被攻陷，可能下载到被投毒的代码。

综合考虑，投毒风险评定为10%。这个百分比反应的是执行未经审查的第三方PoC代码的固有风险，而不是代码中存在明显恶意行为的确定性。

**利用方式：**

1.  **克隆PoC代码：** 从GitHub仓库克隆漏洞利用代码。
2.  **安装依赖：**  安装脚本所需的依赖项，例如 `gnome-control-center`、`openssl` 和 `sudo`。
3.  **执行漏洞利用脚本：** 运行 `exploit-CVE-2021-3560.py` 脚本，并指定要创建的用户名和密码。脚本将利用 Polkit 的漏洞绕过权限验证，创建一个新的具有 root 权限的用户。
4.  **验证：**  使用新创建的用户登录系统，并验证是否具有 root 权限。

**项目地址:** [asepsaepdin/CVE-2021-3560](https://github.com/asepsaepdin/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #19

**来源**: [CVE-2021-3560-chenaotian_CVE-2021-3560.md](../2021/CVE-2021-3560-chenaotian_CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，存在D-Bus总线和polkitd服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560是一个Polkit中的权限提升漏洞。该漏洞允许未经授权的本地用户通过欺骗Polkit绕过D-Bus请求的凭据检查，从而将权限提升为root用户。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的利用代码。CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞在野外被积极利用。提供的利用代码分析显示，利用方式是利用Polkit在处理D-Bus请求时的一个条件竞争漏洞，当D-Bus总线调用异常时，Polkit没有正确处理错误，导致将请求者的UID错误地设置为0（root用户），从而绕过权限验证。

**投毒风险：**

评估提供的POC代码是否存在投毒风险需要仔细审查代码实现。考虑到代码主要关注利用条件竞争绕过权限验证，直接植入恶意后门的概率较低。但是，仍然存在一些潜在的投毒方式，例如：

*   **微妙的修改：** 作者可能在利用代码中添加了看似无害但实际上会执行恶意操作的代码片段。例如，在权限提升后执行某些系统命令，或者修改某些配置文件。
*   **依赖项：** 作者可能引入了包含恶意代码的第三方库。
*   **触发条件：** 恶意代码可能只在特定条件下才会触发，从而避免被轻易检测到。

由于无法直接运行和调试代码，因此只能进行静态分析。根据目前的信息，评估投毒风险为10%，主要考虑的是潜在的隐蔽后门或恶意修改。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造一个特定的D-Bus请求，该请求会被Polkit处理。
2.  **竞争条件：** 攻击者需要利用条件竞争，使D-Bus总线调用失败并返回错误。
3.  **权限提升：** 由于Polkit未能正确处理错误，导致将请求者的UID错误地设置为0（root用户）。
4.  **执行恶意操作：** 攻击者现在拥有root权限，可以执行任何操作，例如创建新的管理员帐户，修改系统文件，或者安装恶意软件。

总而言之，CVE-2021-3560是一个严重的安全漏洞，应该尽快修补。在使用任何公开的利用代码之前，都应该仔细审查代码，以确保其安全性。

**项目地址:** [chenaotian/CVE-2021-3560](https://github.com/chenaotian/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #20

**来源**: [CVE-2021-3560-cpu0x00_CVE-2021-3560.md](../2021/CVE-2021-3560-cpu0x00_CVE-2021-3560.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可使本地低权限用户获得root权限

**影响版本:** Polkit 0.119

**利用条件:** 本地用户，目标系统安装并运行存在漏洞的Polkit版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 允许攻击者通过绕过 D-Bus 请求的凭据检查，将请求者的权限提升为 root 用户。漏洞利用方式如下：

1.  **漏洞描述：** Polkit 在处理 D-Bus 请求时，存在身份验证绕过漏洞，攻击者可以利用该漏洞以 root 身份执行操作。
2.  **利用方式分析：**
    *   提供的`exploit.sh`脚本尝试利用该漏洞添加用户和设置密码。
    *   脚本通过`dbus-send`命令与`org.freedesktop.Accounts`服务进行交互，尝试创建用户和修改密码。
    *   脚本的实现利用了一个竞争条件，尝试在服务响应前终止连接，从而绕过权限验证。
3.  **有效性：** 根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的利用代码。提供的POC脚本尝试利用时间竞争，如果目标环境满足竞争条件的要求，则POC可能是有效的。
4.  **投毒风险：**
    *   `README.md`文件只包含漏洞名称和CTF的描述，未发现任何可疑代码。
    *   `exploit.sh`脚本本身没有发现明显的恶意代码，其行为符合漏洞利用的预期。虽然脚本尝试利用竞争条件，但这不是恶意投毒行为，而是利用漏洞的手段。
    *   因此，判断该仓库中不存在作者隐藏的投毒代码的可能性为0%。
5.  **利用方式总结：** 攻击者利用Polkit的身份验证绕过漏洞，通过构造特定的D-Bus请求，在请求处理过程中利用竞争条件，绕过权限验证，从而创建具有root权限的用户或者执行其他需要root权限的操作，最终提升到root权限。

总体而言，此漏洞是一个严重的安全问题，应该尽快修补。

**项目地址:** [cpu0x00/CVE-2021-3560](https://github.com/cpu0x00/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #21

**来源**: [CVE-2021-3560-f4T1H21_CVE-2021-3560-Polkit-DBus.md](../2021/CVE-2021-3560-f4T1H21_CVE-2021-3560-Polkit-DBus.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 允许本地未经授权的用户通过欺骗 polkit 的 D-Bus 请求凭据检查来提升权限至 root 用户。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞已被证实存在，并有公开的利用代码。

**投毒风险：**
提供的漏洞利用代码是 GNU GPL 许可证文本，并非实际的漏洞利用程序。因此，无法从中判断是否存在投毒代码。实际的利用代码可能包含恶意行为，需要进一步分析。

**利用方式：**
该漏洞利用方式为：利用Polkit的缺陷，通过精心构造的D-Bus请求绕过认证，从而以root权限执行操作。攻击者可以利用这个漏洞创建新的本地管理员或执行其他特权操作。

**总结：**
漏洞本身有效，但提供的代码片段仅为许可证，无法直接评估其安全性。实际利用时需要警惕可能存在的恶意代码。

**项目地址:** [f4T1H21/CVE-2021-3560-Polkit-DBus](https://github.com/f4T1H21/CVE-2021-3560-Polkit-DBus)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #22

**来源**: [CVE-2021-3560-hakivvi_CVE-2021-3560.md](../2021/CVE-2021-3560-hakivvi_CVE-2021-3560.md)

## CVE-2021-3560 - polkit 权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，允许本地非特权用户获得root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问，目标系统安装受影响版本的polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 是 polkit 中的一个认证绕过漏洞。该漏洞源于 `polkit_system_bus_name_get_creds_sync` 函数在获取调用者的 UID 和 PID 时存在缺陷。当调用 `GetConnectionUnixUser` 和 `GetConnectionUnixProcessID` 方法时，即使发生错误，`data.uid` 和 `data.pid` 仍然可能保持为初始化的零值。由于 polkit 认为 UID 为 0 的用户是 root 用户，因此可以绕过权限检查，从而允许非特权用户执行特权操作。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用是有效的。漏洞库信息明确指出该漏洞允许权限提升，并且CISA已将其添加到已知被利用的漏洞目录中。搜索引擎结果中也存在大量关于此漏洞的描述和利用方法。提供的POC代码描述了利用此漏洞的详细过程，包括利用D-Bus调用`CreateUser`和`SetPassword`等特权方法创建具有root权限的用户。

**投毒风险分析：**
提供的POC代码主要是C代码的解释和利用方法的描述，以及一些调用D-Bus的命令示例。从readme文件来看，它旨在通过accountsservice创建和设置密码来提升权限。虽然没有发现明显的恶意代码，但任何下载和编译的第三方代码都存在一定的风险。此外，攻击者可能修改漏洞利用代码，例如更改创建的用户名，使其更具隐蔽性或恶意性。例如，可以将用户名设置成和系统服务名称类似，以此来混淆管理员的视线。

**利用方式分析：**
1.  利用 D-Bus 向 polkit 发送特权方法调用请求（如 accountsservice 提供的 `CreateUser` 和 `SetPassword`）。
2.  利用漏洞绕过 polkit 的认证检查。
3.  polkit 错误地将非特权用户识别为 root 用户，从而允许执行特权方法。
4.  攻击者通过创建具有 root 权限的用户或修改现有用户的密码来获得系统控制权。

**投毒风险评估百分比：**
虽然README.md中提供的代码片段本身没有明显的恶意代码，但考虑到任何第三方提供的未经验证的代码都存在潜在风险，因此投毒风险评估为10%。 这个数值表示作者可能在完整代码或编译过程中隐藏恶意行为，但目前的代码片段本身看起来是合法的漏洞利用。

**项目地址:** [hakivvi/CVE-2021-3560](https://github.com/hakivvi/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #23

**来源**: [CVE-2021-3560-iSTAR-Lab_CVE-2021-3560_PoC.md](../2021/CVE-2021-3560-iSTAR-Lab_CVE-2021-3560_PoC.md)

## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** polkit 0.119

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地非特权用户通过欺骗 polkit 的 D-Bus 请求的凭据检查，从而将权限提升为 root 用户。该漏洞的利用方式是：

1.  **漏洞原理：** polkit 在处理 D-Bus 请求时，存在认证绕过缺陷，导致可以绕过授权检查。
2.  **利用方式：** PoC 脚本通过 D-Bus 接口尝试创建用户 `polkitroot`，并设置密码。利用时间竞争漏洞，在创建用户的过程中，尝试设置密码，从而绕过权限验证，最终成功创建一个具有 root 权限的用户。
3.  **有效性：** 从漏洞描述和搜索引擎结果来看，该漏洞存在且危害较大。提供的 PoC 代码针对特定版本（如 Ubuntu 20.04）有效，但可能需要在其他 Linux 发行版上进行调整。
4.  **投毒风险：** 脚本本身尝试创建一个名为 `polkitroot` 的用户并赋予其 root 权限。这本身就是利用漏洞的目的，但也可以被认为是后门。潜在的投毒风险在于脚本中的睡眠时间 (`sleep 0${half}s`) 和创建用户的重试机制。虽然脚本试图通过这些机制来提高利用成功率，但恶意攻击者可能会修改这些参数，使其在特定环境下执行恶意操作。例如，修改睡眠时间可能会导致拒绝服务攻击。脚本中的错误处理可能存在缺陷，导致在利用失败的情况下留下未清理的临时文件或异常状态，为后续攻击提供便利。

综合考虑，PoC 脚本主要用于演示漏洞，但存在一定的投毒风险，需要谨慎使用。

*投毒风险估算依据：*
*   90%代码是利用漏洞的代码，功能明确。
*   10%的代码可能存在隐藏风险，例如时间竞争相关的参数调整，可能被用于特定环境下的恶意行为。

**项目地址:** [iSTAR-Lab/CVE-2021-3560_PoC](https://github.com/iSTAR-Lab/CVE-2021-3560_PoC)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #24

**来源**: [CVE-2021-3560-innxrmxst_CVE-2021-3560.md](../2021/CVE-2021-3560-innxrmxst_CVE-2021-3560.md)

## CVE-2021-3560 - Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可导致本地普通用户提升为root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问权限，目标系统安装了受影响版本的Polkit

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过欺骗Polkit绕过凭据检查，从而将权限提升为root。该漏洞利用方式涉及使用dbus-send命令与org.freedesktop.Accounts服务进行交互，尝试快速创建用户，并在创建用户成功后，尝试通过类似的dbus调用来设置密码。攻击利用了Polkit在处理D-Bus请求时的漏洞，通过竞态条件或超时机制绕过权限验证。漏洞利用代码尝试创建用户'ahmed'，然后尝试设置其密码，最后尝试以该用户身份执行'sudo su'来获得root权限。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的PoC代码试图通过高频率的dbus调用来触发Polkit的漏洞，从而提升权限，该PoC代码是有效的，如果目标系统满足漏洞存在的条件。

**投毒风险：**
PoC代码主要由dbus-send命令组成，用于与systemd交互。虽然代码本身的目的在于利用漏洞，但潜在的投毒风险较低。风险点在于循环体中进程的创建和销毁，如果利用代码本身存在恶意修改，例如，在成功创建用户之后执行其他恶意操作，或者修改密码设置的逻辑以植入后门，则存在一定的投毒风险。从代码内容本身判断，投毒风险为1%，因为其行为模式符合漏洞利用的预期，且未发现明显的恶意代码。

**利用方式：**
1.  利用dbus-send命令与org.freedesktop.Accounts服务通信。
2.  尝试通过竞争条件或超时绕过身份验证。
3.  创建具有已知用户名的用户（例如 'ahmed'）。
4.  尝试为该用户设置密码。
5.  使用新创建的用户和sudo提升权限到root用户。

**项目地址:** [innxrmxst/CVE-2021-3560](https://github.com/innxrmxst/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #25

**来源**: [CVE-2021-3560-markyu0401_CVE-2021-3560-Polkit-Privilege-Escalation.md](../2021/CVE-2021-3560-markyu0401_CVE-2021-3560-Polkit-Privilege-Escalation.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可导致本地用户获取root权限，影响数据保密性、完整性和系统可用性

**影响版本:** polkit 0.119 (受影响版本)

**利用条件:** 需要本地访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许未经授权的本地用户通过利用 Polkit 中的缺陷绕过 D-Bus 请求的凭证检查，从而提升至 root 权限。漏洞利用代码通过发送精心构造的 D-Bus 消息，诱导 Polkit 产生竞争条件，从而错误地发出授权消息，绕过正常的身份验证过程。该漏洞利用依赖于精确的时间控制和多次尝试。 

**利用方式：**

1.  **竞争条件：** 利用 `dbus-send` 命令向 `org.freedesktop.Accounts` 发送 `CreateUser` 方法调用，同时使用 `sleep` 和 `kill` 命令模拟中断，创建竞争条件。
2.  **用户创建：** 通过重复发送带有中断的 `CreateUser` 请求，尝试在 Polkit 内部状态不一致时创建用户。
3.  **密码设置：** 成功创建用户后，使用 `openssl passwd` 生成密码哈希，并通过类似的竞争条件方式，利用 `dbus-send` 和 `SetPassword` 方法设置新用户的密码。
4.  **权限切换：** 使用 `su` 命令切换到新创建的用户，并使用 `sudo` 命令验证权限提升。

**有效性：**

提供的漏洞利用代码基于时间竞争，因此需要多次尝试才能成功。考虑到CISA的KEV条目以及大量公开可用的利用程序和漏洞分析，该PoC代码被认为是有效的。

**投毒风险：**

风险评估是基于以下因素：

1.  **代码复杂性：**  脚本相对简单，主要依赖于标准的 `dbus-send` 命令和 shell 脚本。
2.  **作者意图：**  作者提供了构建和运行容器的说明，这似乎是为了方便漏洞测试，而不是隐藏恶意代码。
3.  **可疑行为：**  在 `README.md` 中有执行时间的提示以及需要多次执行的步骤，这符合竞争条件漏洞利用的特征。
4. **潜在的投毒点:** PoC的有效性依赖于`sleep`命令的参数，即X.XXX的取值。如果该值被篡改为非常大的值，可能导致拒绝服务攻击。但是，这更像是可用性问题，而不是后门或者提权。另一种可能的攻击是替换`openssl passwd`为恶意程序。最后，构建容器的Dockerfile可能包含后门（例如，安装恶意软件包）。

基于以上分析，虽然存在一定的投毒风险（例如，替换 `openssl passwd` 命令），但主要风险在于利用过程的复杂性和对环境的依赖性。假设容器构建过程可信，没有发现明显的恶意代码。因此，投毒风险被评估为 10%。

**项目地址:** [markyu0401/CVE-2021-3560-Polkit-Privilege-Escalation](https://github.com/markyu0401/CVE-2021-3560-Polkit-Privilege-Escalation)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #26

**来源**: [CVE-2021-3560-pashayogi_ROOT-CVE-2021-3560.md](../2021/CVE-2021-3560-pashayogi_ROOT-CVE-2021-3560.md)

## CVE-2021-3560-Polkit-本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户提升权限至root

**影响版本:** polkit 0.105-26, polkit 0.117-2 和 polkit 0.119

**利用条件:** 本地用户需要SSH登录，而不是直接在桌面终端运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许本地未经授权的攻击者通过绕过 D-Bus 请求的凭据检查来提升权限至 root 用户。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC。
根据提供的PoC代码，该脚本尝试创建一个新用户，并设置密码。利用了Polkit在处理D-Bus请求时的漏洞，通过竞争条件来修改`/etc/shadow`文件，从而为新用户设置密码，并将其加入管理员组。

**投毒风险分析：**
查看 root.sh 脚本，该脚本主要功能是创建用户并修改 /etc/shadow 文件，逻辑较为清晰。
*   **用户创建:** 脚本首先检测是否存在目标用户，如果不存在则通过 `dbus-send` 创建用户。这里使用了竞争条件，通过并发的 `dbus-send` 请求和 `kill` 命令，试图绕过 Polkit 的权限验证。
*   **密码设置:** 脚本获取 `/etc/shadow` 文件的修改时间戳，然后循环尝试使用 `dbus-send` 修改用户的密码，同样利用了竞争条件。
*   **依赖:** 脚本依赖 `dbus-send`，`systemctl`, `stat`, `id`, `grep`, `cut`, `bc`, `sleep` 等常见的系统命令。
脚本中没有发现任何明显的恶意代码，例如反弹 shell，删除文件，或植入后门等操作。没有发现任何可以被判定为投毒的代码。
因此，投毒风险评估为 0%。

**利用方式：**
1.  **漏洞触发：**利用 Polkit 在处理 D-Bus 请求时的缺陷，绕过权限验证。
2.  **用户创建：**使用 `dbus-send` 命令尝试创建一个具有管理员权限的新用户。
3.  **密码设置：**通过竞争条件修改 `/etc/shadow` 文件，为新创建的用户设置密码。
4.  **权限提升：** 使用新创建的用户登录，并通过 `sudo su` 命令获得 root 权限。

**总结：** 提供的 PoC 代码是有效的，并且经过分析，没有发现明显的投毒风险。该漏洞允许本地普通用户提升权限至 root。

**项目地址:** [pashayogi/ROOT-CVE-2021-3560](https://github.com/pashayogi/ROOT-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #27

**来源**: [CVE-2021-3560-secnigma_CVE-2021-3560-Polkit-Privilege-Esclation.md](../2021/CVE-2021-3560-secnigma_CVE-2021-3560-Polkit-Privilege-Esclation.md)

## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.113及更高版本，或Debian fork的0-105-26

**利用条件:** 需要安装accountsservice和gnome-control-center，且在不支持图形登录的环境下运行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560是一个polkit中的权限提升漏洞。攻击者可以通过利用D-Bus请求中的凭据检查绕过，从而将请求者的权限提升为root用户。

**有效性评估：**
根据提供的漏洞库信息、搜索引擎结果和PoC代码，此漏洞的PoC代码是有效的。漏洞信息表明该漏洞已在野外被利用 (CISA KEV目录)，并且存在公开可用的PoC。

**投毒风险评估：**
PoC代码本身是一个bash脚本，主要用于自动化漏洞利用过程。虽然脚本会尝试注入一个新的sudo用户，但这种行为是漏洞利用的必要步骤，而非隐藏的恶意代码。然而，下载和运行任何来自不可信来源的脚本始终存在风险。因此，谨慎对待脚本，在受控环境中检查代码，是降低风险的措施。
仔细分析README.md的内容，投毒风险主要来自以下几个方面：
1.  **依赖性：** 脚本依赖于`accountsservice`和`gnome-control-center`的存在。虽然这些通常是标准组件，但如果环境缺少这些组件，脚本可能无法正常工作，或者产生意想不到的错误。
2.  **Timing依赖：** 漏洞利用依赖于精确的Timing。如果Timing不正确，漏洞利用会失败，并且可能需要多次尝试。
3.  **环境限制：** 脚本警告不要在图形登录环境运行，否则会导致polkit认证循环弹出。虽然这不是恶意行为，但可能造成拒绝服务。
4. **新增用户风险:** 脚本会在sudo组添加用户,如果该用户被攻击者控制,会导致系统被远程控制,存在风险.

**利用方式：**
1.  **漏洞触发：** 攻击者发送一个D-Bus消息来触发polkit。
2.  **连接中断：** 在polkit处理请求时，攻击者突然中断连接。
3.  **权限提升：** 攻击者使用之前的bus标识符发送第二个请求，由于polkit将断开连接的UID视为0，因此第二个请求会以root权限执行。
4. **添加sudo用户:** 攻击者利用root权限添加拥有sudo权限的用户。

总而言之，该PoC的目的是为了利用CVE-2021-3560漏洞，添加sudo用户以实现权限提升。尽管PoC本身的代码没有明显的恶意行为，但依旧存在一定的投毒风险，下载和使用需谨慎。


**项目地址:** [secnigma/CVE-2021-3560-Polkit-Privilege-Esclation](https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

## POC #28

**来源**: [CVE-2021-3560-titusG85_SideWinder-Exploit.md](../2021/CVE-2021-3560-titusG85_SideWinder-Exploit.md)

## CVE-2021-3560 Polkit 权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，本地权限提升至 root

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 存在于 polkit 中，允许未经授权的本地用户通过利用 D-Bus 请求的凭据检查绕过漏洞，从而将权限提升至 root 用户。漏洞利用涉及利用 polkit 中存在的竞态条件。给定的漏洞利用代码仓库包含了一个 README.md 文件，描述了如何利用该漏洞进行权限提升练习。虽然该练习着重于教育目的，但它仍然可能被滥用，风险系数较低，只有5%。投毒风险评估基于代码仓库中是否存在隐藏的恶意代码，或对原始漏洞利用代码的修改，目的是在目标系统上执行恶意操作，如安装后门或收集敏感信息。这里主要作为教育演示，因此投毒概率较低。

**利用方式：**

1.  **竞态条件：** 利用 polkit 处理 D-Bus 请求时的竞态条件。
2.  **权限提升：** 通过精心构造的 D-Bus 请求绕过权限验证，从而以 root 权限执行操作。
3.  **本地利用：** 漏洞利用通常发生在本地，攻击者需要具有本地用户访问权限。

**项目地址:** [titusG85/SideWinder-Exploit](https://github.com/titusG85/SideWinder-Exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)

---

