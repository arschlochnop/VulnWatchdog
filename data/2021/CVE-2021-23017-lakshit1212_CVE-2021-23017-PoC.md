# CVE-2021-23017

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-23017-6lj_EVIL-CVE-2021-23017-Update-2025.md](../2021/CVE-2021-23017-6lj_EVIL-CVE-2021-23017-Update-2025.md)

## CVE-2021-23017-Nginx Resolver 内存覆盖

**漏洞编号:** CVE-2021-23017

**漏洞类型:** 内存覆盖

**影响应用:** Nginx

**危害等级:** 高危，可能导致worker进程崩溃或潜在的其他影响

**影响版本:** Nginx Web Server versions 0.6.18 thru 1.20.0 before 1.20.1, Nginx plus versions R13 thru R23 before R23 P1. Nginx plus version R24 before R24 P1

**利用条件:** 需要能够伪造来自DNS服务器的UDP数据包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-23017是Nginx resolver中的一个安全问题，允许攻击者通过伪造来自DNS服务器的UDP数据包，导致1字节的内存覆盖。这可能导致worker进程崩溃或其他潜在的影响。

**有效性：** 根据漏洞信息和搜索引擎结果，POC代码针对CVE-2021-23017是有效的。多个资源确认了该漏洞的存在和利用方式。

**利用方式：**

1.  **设置恶意DNS服务器：** 攻击者需要设置一个能够发送伪造DNS响应的恶意DNS服务器。`dnsmasq` 被用作搭建恶意 DNS 服务器。
2.  **发送恶意DNS响应：** 攻击者发送包含超长域名（超过Nginx resolver的预期长度）的恶意DNS响应。该响应会覆盖Nginx worker进程的内存。
3.  **触发DNS查询：** 攻击者使用`curl`或`dig`等工具触发目标Nginx服务器的DNS查询。Nginx服务器会向攻击者的恶意DNS服务器发送请求，并接收包含恶意payload的响应。
4.  **造成拒绝服务：** 成功的利用会导致Nginx worker进程崩溃，从而造成拒绝服务攻击。
5.  **绕过防火墙:** 攻击者使用并行进程，同时执行嗅探、DNS发送和查询触发，并通过高频率的数据包和查询绕过防火墙过滤器。

**投毒风险：**

虽然该漏洞利用代码主要目的是造成拒绝服务，但仍然存在一定的投毒风险。风险点分析如下：

*   **依赖安装：**  `README.md`文件中建议用户安装`dnsmasq`和`scapy`等依赖。虽然这些依赖本身是合法的，但如果攻击者篡改了安装源，可能会引入恶意软件包。
*   **自定义DNS服务器：**  攻击者诱导用户配置自己的DNS服务器，这本身就具有一定的风险，因为所有DNS查询都会经过攻击者的服务器，攻击者可以进行中间人攻击或收集敏感信息。
*   **Payload修改：** 攻击者在构造恶意payload时，可能会在超长域名中嵌入恶意代码，虽然1字节内存覆盖的利用方式限制了恶意代码的执行，但仍然不能排除攻击者利用其他方式扩大攻击面的可能性。

综合以上分析，虽然该PoC的主要目的是拒绝服务，但不能完全排除攻击者通过修改PoC代码或利用用户配置不当等方式进行投毒攻击的可能性。**因此，投毒风险评估为10%。** 风险主要集中在依赖项安装和目标系统的配置上，而不是PoC代码本身包含恶意后门。用户需要仔细检查和验证脚本以及相关配置，以降低潜在风险。

**项目地址:** [6lj/EVIL-CVE-2021-23017-Update-2025](https://github.com/6lj/EVIL-CVE-2021-23017-Update-2025)

**漏洞详情:** [CVE-2021-23017](https://nvd.nist.gov/vuln/detail/CVE-2021-23017)

---

## POC #2

**来源**: [CVE-2021-23017-Cybervixy_Vulnerability-Management.md](../2021/CVE-2021-23017-Cybervixy_Vulnerability-Management.md)

## CVE-2021-23017-Nginx Resolver 内存覆盖

**漏洞编号:** CVE-2021-23017

**漏洞类型:** 内存覆盖

**影响应用:** Nginx

**危害等级:** 高危，可能导致worker进程崩溃或潜在的其他影响，如DoS

**影响版本:** Nginx Web Server versions 0.6.18 thru 1.20.0 before 1.20.1, Nginx plus versions R13 thru R23 before R23 P1. Nginx plus version R24 before R24 P1

**利用条件:** 需要能够伪造来自DNS服务器的UDP数据包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-23017是Nginx resolver中的一个安全问题，允许攻击者通过伪造来自DNS服务器的UDP数据包来导致1字节的内存覆盖。从提供的漏洞利用代码来看，它展示了一个利用Nginx漏洞的例子，但并未直接包含利用CVE-2021-23017的明确exp代码，所以有效性需要根据实际的利用代码判断。提供的漏洞利用代码主要描述了使用Nessus进行漏洞扫描和使用Ansible进行补丁管理的流程，以及扫描结果中发现的CVE-2021-23017漏洞。利用方式是通过发送特制的UDP数据包，触发Nginx resolver的内存覆盖漏洞，进而导致worker进程崩溃或执行恶意代码。

**有效性评估：**  根据搜索结果和漏洞库信息，可以确认该漏洞存在且影响特定版本的Nginx。但是，提供的漏洞利用代码并没有直接展示exp的编写，需要进一步验证。

**投毒风险评估：**  虽然此仓库展示了通过nessus进行漏洞扫描，但依然存在一定的投毒风险。此报告目的是记录漏洞管理，但是不排除作者隐藏其他恶意代码的可能，因此存在**10%**的投毒风险。主要关注点是：

1.  **自动化脚本：** 查看Ansible脚本等自动化配置管理脚本，确认其内容是否符合预期，是否存在未知的操作。
2.  **第三方依赖：**  检查是否存在不必要的第三方依赖，以及这些依赖的来源是否可信。
3. **后门验证代码:** 务必不要把POC验证的后门代码判定为投毒代码。

**利用方式：**

1.  **伪造DNS响应：** 攻击者需要能够拦截或伪造DNS服务器的响应数据包。
2.  **构造恶意数据包：** 构造包含恶意负载的UDP数据包，该负载能够触发Nginx resolver中的内存覆盖漏洞。
3.  **发送数据包：**  将伪造的DNS响应数据包发送给Nginx服务器，触发漏洞。
4.  **结果：** 成功利用后，可能导致Nginx worker进程崩溃，从而造成拒绝服务攻击。如果能精确控制覆盖的内存区域，则可能实现远程代码执行。

**项目地址:** [Cybervixy/Vulnerability-Management](https://github.com/Cybervixy/Vulnerability-Management)

**漏洞详情:** [CVE-2021-23017](https://nvd.nist.gov/vuln/detail/CVE-2021-23017)

---

## POC #3

**来源**: [CVE-2021-23017-M507_CVE-2021-23017-PoC.md](../2021/CVE-2021-23017-M507_CVE-2021-23017-PoC.md)

## CVE-2021-23017-Nginx Resolver 内存覆盖漏洞

**漏洞编号:** CVE-2021-23017

**漏洞类型:** 内存覆盖

**影响应用:** Nginx

**危害等级:** 高危，可能导致worker进程崩溃或潜在其他影响

**影响版本:** Nginx Web Server versions 0.6.18 thru 1.20.0 before 1.20.1, Nginx plus versions R13 thru R23 before R23 P1. Nginx plus version R24 before R24 P1

**利用条件:** 目标启用了DNS解析器，且攻击者可以伪造来自DNS服务器的UDP数据包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-23017是Nginx解析器中的一个安全问题，允许攻击者通过伪造来自DNS服务器的UDP数据包，造成1字节的内存覆盖，导致worker进程崩溃或潜在的其他影响。

**漏洞利用分析：**

1.  **漏洞原理：** 该漏洞是由于Nginx解析器在处理DNS响应时，没有充分验证响应的长度，导致可以写入超出缓冲区边界的数据。
2.  **利用方式：**
    *   攻击者首先需要能够拦截或伪造目标服务器的DNS查询请求的响应。
    *   攻击者构造一个恶意的DNS响应，该响应包含的数据长度超过了Nginx解析器分配的缓冲区大小。
    *   当Nginx解析器处理这个恶意的DNS响应时，会发生1字节的内存覆盖。
    *   内存覆盖可能导致worker进程崩溃，或者如果覆盖了关键的数据结构，可能会导致更严重的后果。
3.  **POC 分析:**
    *   POC代码使用Scapy库来构建和发送恶意UDP数据包。
    *   代码首先设置网络接口，启用IP转发，并阻止正常的DNS流量(iptables -A FORWARD -p UDP --dport 53 -j DROP)。
    *   然后，它通过ARP欺骗来劫持目标和DNS服务器之间的流量。
    *   当目标发起DNS查询时，PoC会拦截该请求并构建一个包含恶意payload的DNS响应。
    *   恶意的DNS响应被发送给目标，从而触发漏洞。

**投毒风险评估：**

尽管POC本身的功能是演示漏洞利用，但存在一定的投毒风险。风险点在于:

*   代码包含`os.system`调用，可以执行任意系统命令。虽然目前用于设置网络环境（例如开启IP转发，阻断正常的DNS查询），但理论上可以修改为执行其他恶意操作。
*   ARP欺骗本身是一种中间人攻击手段，可能被滥用以进行流量嗅探或数据篡改。
*   虽然代码声明仅用于学术研究和防御目的，但实际使用取决于使用者，存在被恶意利用的可能。
*  PoC存在一定的依赖性，依赖`requirements.txt` 中的第三方库。

**有效性评估：**

根据漏洞信息和POC代码，可以判断该漏洞利用的有效性较高，前提是满足利用条件（目标启用了DNS解析器，攻击者可以伪造DNS响应）。 提供的POC代码具有一定的可行性，根据github上开源信息具有一定的有效性。


**项目地址:** [M507/CVE-2021-23017-PoC](https://github.com/M507/CVE-2021-23017-PoC)

**漏洞详情:** [CVE-2021-23017](https://nvd.nist.gov/vuln/detail/CVE-2021-23017)

---

## POC #4

**来源**: [CVE-2021-23017-ShivamDey_CVE-2021-23017.md](../2021/CVE-2021-23017-ShivamDey_CVE-2021-23017.md)

## CVE-2021-23017-Nginx Resolver 内存覆盖

**漏洞编号:** CVE-2021-23017

**漏洞类型:** 内存覆盖

**影响应用:** Nginx

**危害等级:** 高危，可能导致worker进程崩溃或潜在的其他影响

**影响版本:** Nginx Web Server versions 0.6.18 thru 1.20.0 before 1.20.1, Nginx plus versions R13 thru R23 before R23 P1. Nginx plus version R24 before R24 P1

**利用条件:** 目标服务器开启resolver并且允许DNS请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-23017是Nginx resolver模块中的一个安全问题，允许攻击者通过伪造来自DNS服务器的UDP数据包，导致1字节的内存覆盖，可能导致worker进程崩溃或其他潜在影响。

**有效性：**
提供的PoC代码尝试利用此漏洞。它通过监听目标服务器的DNS请求，然后构造恶意的DNS响应数据包，包含内存覆盖的payload，并将其发送给目标服务器。如果目标服务器正在使用受影响版本的Nginx，并且resolver配置不当，则此PoC可能有效。

**投毒风险：**
PoC代码的分析表明，该代码主要用于漏洞验证和概念验证。虽然代码中包含ARP欺骗部分，用于劫持目标流量，但代码本身并**没有发现**明显的后门或恶意行为，也没有发现与外部C&C服务器通信的行为。

**利用方式：**
1.  **环境准备：** 攻击者需要能够监听到目标Nginx服务器发送的DNS请求，或者通过ARP欺骗等手段劫持DNS流量。
2.  **DNS请求监听：** PoC代码通过`sniff`函数监听目标服务器发出的DNS请求。
3.  **恶意DNS响应构造：** 当监听到目标服务器的DNS请求后，PoC代码会构造一个恶意的DNS响应包。关键部分在于`payload`的构造，它会在响应中插入精心设计的payload，目的是覆盖目标服务器内存中的某个字节。
4.  **发送恶意响应：** PoC代码使用`sendp`函数将构造好的恶意DNS响应包发送给目标服务器。由于是伪造的DNS响应，其源IP地址和端口伪造成合法的DNS服务器。
5.  **触发漏洞：** 如果构造的payload成功覆盖了目标服务器内存中的关键数据，则可能导致worker进程崩溃或其他攻击效果。

**PoC分析补充说明：**
* `device_setup()`函数尝试启用IP转发并阻止转发到53端口的UDP数据包。这可能是为了方便测试，但实际利用中可能不需要。
* `ARPP()`函数进行ARP欺骗，将目标服务器和DNS服务器的MAC地址指向攻击者，从而劫持流量。这部分是攻击成功的关键。需要注意的是ARP欺骗可能在某些网络环境下无效，或者容易被检测。
* `process_received_packet()`是核心函数，负责处理接收到的DNS请求并构造恶意响应。`null_pointer_index`变量的计算用于定位DNS请求中的域名结束位置，并在此之后插入恶意数据。
* `payload`的构造是利用成功的关键，需要根据目标Nginx服务器的具体环境和内存布局进行调整。

**项目地址:** [ShivamDey/CVE-2021-23017](https://github.com/ShivamDey/CVE-2021-23017)

**漏洞详情:** [CVE-2021-23017](https://nvd.nist.gov/vuln/detail/CVE-2021-23017)

---

## POC #5

**来源**: [CVE-2021-23017-lukwagoasuman_-home-lukewago-Downloads-CVE-2021-23017-Nginx-1.14.md](../2021/CVE-2021-23017-lukwagoasuman_-home-lukewago-Downloads-CVE-2021-23017-Nginx-1.14.md)

## CVE-2021-23017-Nginx Resolver 1-byte内存覆盖

**漏洞编号:** CVE-2021-23017

**漏洞类型:** 内存覆盖

**影响应用:** Nginx

**危害等级:** 中危，可能导致worker进程崩溃或潜在的其他影响

**影响版本:** Nginx Web Server versions 0.6.18 thru 1.20.0 before 1.20.1, Nginx plus versions R13 thru R23 before R23 P1. Nginx plus version R24 before R24 P1

**利用条件:** 需要能够伪造来自DNS服务器的UDP数据包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-23017是Nginx resolver中的一个安全问题，允许攻击者通过伪造来自DNS服务器的UDP数据包来导致1字节内存覆盖，从而导致worker进程崩溃或潜在的其他影响。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是存在的，并且有一个公开的POC代码（[https://github.com/M507/CVE-2021-23017-PoC](https://github.com/M507/CVE-2021-23017-PoC)）。提供的Python脚本尝试模拟DNS服务器并发送特制的响应来触发漏洞。

**投毒风险：**
提供的PoC代码看起来像是利用了DNS响应中的CNAME记录来触发内存覆盖。代码逻辑相对简单，主要作用是监听UDP端口1053，解析收到的DNS请求，然后构造包含特定CNAME记录的恶意响应，并将其发送回请求方。其中 `unhexlify('c00c0005000100000e10000b18414141414141414141414141414141414141414141414141c004')` 这段十六进制数据包含了精心构造的CNAME记录，旨在覆盖目标内存。风险在于，虽然这段代码本身的目的在于重现漏洞，但恶意行为者可能修改此代码以产生更严重的后果，例如覆盖更敏感的内存区域以实现代码执行。由于代码功能相对明确，且专注于漏洞复现，因此评估其存在作者隐藏的投毒代码的风险较低，约为10%。

**利用方式：**
1.  **Nginx配置：**  Nginx需要配置使用resolver，并且允许从攻击者控制的DNS服务器解析域名。
2.  **DNS欺骗：**  攻击者需要能够拦截或欺骗Nginx服务器发送的DNS请求，并返回特制的恶意响应。
3.  **内存覆盖：**  恶意DNS响应中的CNAME记录被设计为覆盖Nginx进程中的特定内存区域，导致进程崩溃或潜在的恶意代码执行。

**总结：**
该漏洞的利用需要一定的条件，包括Nginx的配置和攻击者对DNS流量的控制。虽然利用难度相对较高，但如果成功利用，可能会导致Nginx服务不可用，甚至可能导致更严重的安全问题。

**项目地址:** [lukwagoasuman/-home-lukewago-Downloads-CVE-2021-23017-Nginx-1.14](https://github.com/lukwagoasuman/-home-lukewago-Downloads-CVE-2021-23017-Nginx-1.14)

**漏洞详情:** [CVE-2021-23017](https://nvd.nist.gov/vuln/detail/CVE-2021-23017)

---

## POC #6

**来源**: [CVE-2021-23017-moften_CVE-2021-23017.md](../2021/CVE-2021-23017-moften_CVE-2021-23017.md)

## CVE-2021-23017-Nginx Resolver 内存覆盖

**漏洞编号:** CVE-2021-23017

**漏洞类型:** 内存覆盖

**影响应用:** Nginx

**危害等级:** 中危，可能导致worker进程崩溃或潜在的其他影响。

**影响版本:** Nginx Web Server versions 0.6.18 thru 1.20.0 before 1.20.1, Nginx plus versions R13 thru R23 before R23 P1. Nginx plus version R24 before R24 P1

**利用条件:** Nginx需要配置resolver，并且攻击者能够伪造来自DNS服务器的UDP数据包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-23017是Nginx resolver中的一个安全问题，允许攻击者通过伪造来自DNS服务器的UDP数据包，造成1字节的内存覆盖，导致worker进程崩溃或者其他潜在影响。

**有效性：**
提供的PoC代码尝试通过发送一个包含超长Host头的HTTP请求来触发该漏洞。如果Nginx配置了resolver并且存在漏洞，超长的Host头可能导致缓冲区溢出，从而触发内存覆盖。
根据搜索引擎结果，存在公开的PoC，表明该漏洞可以被利用。

**投毒风险：**
PoC 代码非常简单，主要功能是发送一个恶意的HTTP请求。README文件也声明这是一个被动的检测工具，不会执行恶意代码。尽管如此，仍然存在很小的投毒风险，例如作者可能在代码中隐藏了某些不易察觉的后门或恶意行为。鉴于代码的简洁性以及安全研究的声明，投毒风险较低，大约为10%。

**利用方式：**
1.  **配置Nginx resolver:**  Nginx需要配置resolver，并且在配置中需要使用到受影响的DNS服务器。
2.  **伪造DNS数据包:**  攻击者需要能够伪造来自DNS服务器的UDP数据包。
3.  **发送恶意Host头:**  攻击者发送一个包含超长Host头的HTTP请求。如果Nginx resolver处理不当，超长的Host头会导致缓冲区溢出，覆盖内存中的某个字节。
4.  **触发崩溃或进一步利用:**  内存覆盖可能导致worker进程崩溃，造成拒绝服务。在某些情况下，攻击者可能能够精心构造数据包，覆盖关键数据，实现更高级的利用，例如代码执行。

根据漏洞信息，利用该漏洞需要满足一定条件，并且只能造成1字节的内存覆盖，因此利用难度较高，影响相对有限。

**项目地址:** [moften/CVE-2021-23017](https://github.com/moften/CVE-2021-23017)

**漏洞详情:** [CVE-2021-23017](https://nvd.nist.gov/vuln/detail/CVE-2021-23017)

---

## POC #7

**来源**: [CVE-2021-23017-niandy_nginx-patch.md](../2021/CVE-2021-23017-niandy_nginx-patch.md)

## CVE-2021-23017-Nginx Resolver Memory Overwrite

**漏洞编号:** CVE-2021-23017

**漏洞类型:** 内存覆盖

**影响应用:** Nginx

**危害等级:** 高危，可能导致worker进程崩溃或潜在的其他影响

**影响版本:** Nginx Web Server versions 0.6.18 thru 1.20.0 before 1.20.1, Nginx plus versions R13 thru R23 before R23 P1. Nginx plus version R24 before R24 P1

**利用条件:** 需要能够伪造来自DNS服务器的UDP数据包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2021-23017是Nginx resolver中的一个安全问题，允许攻击者通过伪造来自DNS服务器的UDP数据包，导致1字节的内存覆盖。这种覆盖可能导致worker进程崩溃或者产生其他潜在影响。

分析提供的漏洞利用代码（Makefile、README.md、rc.yaml）：

*   **有效性：** 提供的代码是一个用于构建Nginx镜像的Dockerfile和相关配置，而不是直接利用CVE-2021-23017的PoC。虽然它构建了一个Nginx镜像，但它本身并没有包含任何能够触发或验证该漏洞的代码。提供的github链接（https://github.com/M507/CVE-2021-23017-PoC）包含专门针对该漏洞的POC，可以更准确地验证漏洞利用。

*   **投毒风险：**  该代码的主要目的是构建一个自定义的Nginx镜像。虽然直接利用CVE-2021-23017的代码没有包含在此仓库中，但是此`Makefile`文件可以执行任意命令，以及`Dockerfile`如果被篡改，有可能引入恶意代码。`rc.yaml`文件用于在Kubernetes中部署Nginx，如果被篡改也可能导致恶意行为。总体而言，该仓库存在一定的投毒风险，但风险较低。估计为10%。

*   **利用方式：**  利用方式需要攻击者能够伪造来自DNS服务器的UDP数据包。攻击者需要找到一个使用Nginx resolver的配置，并构造恶意的UDP数据包来触发内存覆盖。由于只有1字节的覆盖，精确控制覆盖内容比较困难，可能需要多次尝试才能达到利用效果。通常利用该漏洞会导致DoS（拒绝服务），但也可能在特定情况下实现更高级的攻击。

总之，提供的代码本身不包含漏洞利用代码，而是一个构建Nginx镜像的配置。真正的漏洞利用需要伪造DNS响应包，并且精准控制覆盖的内存地址。

**项目地址:** [niandy/nginx-patch](https://github.com/niandy/nginx-patch)

**漏洞详情:** [CVE-2021-23017](https://nvd.nist.gov/vuln/detail/CVE-2021-23017)

---

## POC #8

**来源**: [CVE-2021-23017-z3usx01_CVE-2021-23017-POC.md](../2021/CVE-2021-23017-z3usx01_CVE-2021-23017-POC.md)

## CVE-2021-23017-Nginx Resolver 1-byte内存覆盖

**漏洞编号:** CVE-2021-23017

**漏洞类型:** 内存覆盖

**影响应用:** Nginx

**危害等级:** 中危，可能导致worker进程崩溃或潜在的其他影响

**影响版本:** Nginx Web Server versions 0.6.18 thru 1.20.0 before 1.20.1, Nginx plus versions R13 thru R23 before R23 P1. Nginx plus version R24 before R24 P1

**利用条件:** 需要Nginx配置中使用了"resolver"指令，并且攻击者能够伪造来自DNS服务器的UDP数据包。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-23017是Nginx resolver中的一个安全问题，允许攻击者通过伪造来自DNS服务器的UDP数据包，导致1字节的内存覆盖，从而导致worker进程崩溃或潜在的其他影响。

**漏洞利用方式：**

1.  **环境准备：** 目标Nginx服务器需要启用resolver指令，并且攻击者需要位于可以拦截和伪造DNS响应的网络位置。
2.  **ARP欺骗（可选）：**  PoC代码包含ARP欺骗功能，用于将目标服务器的DNS流量重定向到攻击者机器。这依赖于`scapy`库。这部分代码并非必须，如果攻击者已经可以拦截DNS流量，则可以省略。
3.  **DNS请求监听：** 使用`scapy`监听目标服务器发送的DNS请求。
4.  **构造恶意DNS响应：** 当监听到DNS请求时，PoC代码会解析该请求，并构造一个恶意的DNS响应。该响应包含一个精心设计的payload，旨在覆盖目标服务器resolver中的内存。Payload的构造过程如下：
    *   复制原始DNS请求的头部信息。
    *   修改ANCOUNT字段为1，表示响应包含一个answer。
    *   构造answer部分，其中包含指向恶意数据的指针。
    *   恶意数据本身包含一系列'A'字符，以及一个指向原始请求的指针(C0 04)，造成内存覆盖。
5.  **发送恶意DNS响应：** 将构造好的恶意DNS响应发送给目标服务器。由于攻击者已经可以伪造DNS响应，因此该响应将被目标服务器接受。
6.  **内存覆盖：**  恶意DNS响应被解析后，将导致目标服务器resolver中的内存被覆盖，从而可能导致worker进程崩溃或其他影响。

**投毒风险分析：**

代码中存在`os.system`调用，执行了`iptables`命令，阻止了转发到53端口的UDP数据包。这实际上是为了方便利用，防止真实的DNS响应干扰攻击。总体来看，该POC代码的主要目的是验证漏洞，虽然使用了`os.system`,但目的是为poc本身服务，并不能判断为恶意投毒。但是代码编写风格不利于阅读，可读性较差，存在很低的潜在投毒风险，约为1%。


**项目地址:** [z3usx01/CVE-2021-23017-POC](https://github.com/z3usx01/CVE-2021-23017-POC)

**漏洞详情:** [CVE-2021-23017](https://nvd.nist.gov/vuln/detail/CVE-2021-23017)

---

