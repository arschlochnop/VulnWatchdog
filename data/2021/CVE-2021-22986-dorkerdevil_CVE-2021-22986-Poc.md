# CVE-2021-22986

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-22986-Al1ex_CVE-2021-22986.md](../2021/CVE-2021-22986-Al1ex_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经验证的远程命令执行漏洞。攻击者可以发送特制的 HTTP 请求到 `/mgmt/tm/util/bash` 接口，在目标系统上执行任意命令。

**有效性:**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开可用的PoC代码。提供的PoC代码通过构造包含命令的JSON数据，发送POST请求到目标URL的`/mgmt/tm/util/bash`接口，从而执行命令。代码中包含了验证模式、攻击模式、批量检测模式和反弹shell模式，验证了其有效性。

**投毒风险:**
PoC代码本身主要功能是利用漏洞执行命令，投毒风险较低。但依旧存在一定投毒风险：
1.  **默认认证信息:** 代码中硬编码了 `Authorization: Basic YWRtaW46QVNhc1M=` 默认认证信息（admin:ASasS），若目标系统仍使用此默认密码，则漏洞利用成功概率更高，但这也可能被攻击者利用，如果攻击者修改了目标系统的配置,可能会影响正常的业务.
2.  **反弹shell风险:**  反弹shell功能如果被恶意利用，可能在受害者不知情的情况下建立连接。
3.  **脚本作者风险:**  作者 Al1ex@Heptagram 的真实意图未知，可能在未来版本中添加恶意代码. 总体投毒风险预估为10%。

**利用方式:**
1.  确定目标F5 BIG-IP/BIG-IQ设备的版本在受影响范围内。
2.  使用PoC脚本，指定目标URL，并选择验证模式或攻击模式。
3.  在攻击模式下，指定要执行的命令。反弹shell模式可用于建立反向shell连接。
4.  对于批量检测，提供包含目标URL的文件。
5.  运行PoC脚本，利用漏洞执行命令。

**项目地址:** [Al1ex/CVE-2021-22986](https://github.com/Al1ex/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #2

**来源**: [CVE-2021-22986-DDestinys_CVE-2021-22986.md](../2021/CVE-2021-22986-DDestinys_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可以访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ中iControl REST接口的一个未经身份验证的远程命令执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。该漏洞允许未经身份验证的攻击者通过向iControl REST API发送特制的请求来执行任意命令。

**有效性：**

提供的POC代码看起来是有效的。它通过构造一个包含要执行的命令的JSON payload，并将其POST到`/mgmt/tm/util/bash`端点来利用此漏洞。代码首先尝试读取一个url列表，遍历这些url，并且发送post请求，验证是否成功执行。由于`CVE-2021-22986` 是一个被广泛研究的漏洞，有很多公开可用的利用代码，此POC代码是符合漏洞描述的。

**投毒风险：**

POC代码的投毒风险较低，约为10%。 代码本身的功能看起来是正常的漏洞利用，但是存在以下潜在的风险点：

1.  代码中存在一个`proxies`变量,如果使用者不注意修改，可能会将流量转发到攻击者控制的代理服务器。
2.  使用了`requests.packages.urllib3.disable_warnings()`，虽然这通常用于避免SSL证书验证问题，但可能会隐藏其他潜在的安全问题。
3.  代码尝试读取`url.txt`文件，并执行POST请求，如果`url.txt`文件被篡改，可能会导致意外的漏洞利用。
4. 代码中包含一个硬编码的 Basic 认证头 `Authorization: Basic YWRtaW46YWRtaW4=`, 虽然在漏洞利用中不太可能被直接使用，但如果使用者不清楚其含义，可能会在其他场景中错误使用。

这些潜在的风险点使得代码存在一定的投毒风险，但总体而言，代码的主要目的是利用漏洞，而非进行恶意行为。

**利用方式：**

利用方式如下：

1.  攻击者需要找到存在漏洞的F5 BIG-IP或BIG-IQ实例。
2.  攻击者构造一个包含恶意命令的JSON payload，例如`{'command': 'run', 'utilCmdArgs': '-c id'}`，其中`id`命令可以替换为任意系统命令。
3.  攻击者使用POST请求将该payload发送到目标的`/mgmt/tm/util/bash`端点，无需身份验证。
4.  服务器执行该命令，并将结果返回给攻击者。

此外，搜索引擎结果中提到，该漏洞已被Mirai僵尸网络利用，攻击者可以使用此漏洞来感染目标系统，并将其纳入僵尸网络。

**排序优先级：**

搜索引擎结果显示该漏洞已经被广泛利用，并且存在公开的POC，因此优先级最高。漏洞利用代码验证了漏洞的可利用性，并且有助于理解利用方式。漏洞库信息提供了漏洞的官方描述和受影响的版本范围，是重要的参考信息。

**项目地址:** [DDestinys/CVE-2021-22986](https://github.com/DDestinys/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #3

**来源**: [CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md](../2021/CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md)

## CVE-2021-22986-F5 BIG-IP iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未授权远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统开启并暴露iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经身份验证的远程命令执行漏洞。漏洞存在于受影响版本的 iControl REST 接口中，允许未经身份验证的攻击者通过发送特制的 HTTP 请求执行任意系统命令。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被积极利用，并且存在公开的 PoC。虽然提供的漏洞利用代码 `/tmp/787246e6ce6e87a4ad488e0e4cce542c/README.md` 看起来只是一个扫描器或者一个占位符，但它表明已经有人在研究并分享关于这个漏洞的利用方法。

**投毒风险：**
提供的代码片段 `README.md` 文件本身不包含可执行代码，因此直接投毒的可能性较低。 但是，考虑到漏洞已经被公开，攻击者可能会创建恶意模块或脚本，伪装成漏洞利用工具，但实际上执行恶意操作。例如，某些PoC中可能包含下载恶意payload执行的操作。因为缺乏代码分析，这里假设有10%的可能性是作者隐藏了投毒代码。

**利用方式：**
1.  **未授权访问:** 攻击者无需身份验证即可访问 iControl REST 接口。
2.  **构造恶意请求:**  攻击者构造包含恶意命令的 HTTP 请求，通常利用 Server-Side Request Forgery (SSRF) 或直接命令注入绕过认证执行命令。
3.  **命令执行:**  BIG-IP/BIG-IQ 系统在收到恶意请求后，执行其中的命令，导致远程代码执行。

**总结：**
CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意代码。由于存在公开的 PoC 并且漏洞已被积极利用，受影响的用户应尽快升级到受支持的版本，或采取缓解措施。

**项目地址:** [Osyanina/westone-CVE-2021-22986-scanner](https://github.com/Osyanina/westone-CVE-2021-22986-scanner)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #4

**来源**: [CVE-2021-22986-S1xHcL_f5_rce_poc.md](../2021/CVE-2021-22986-S1xHcL_f5_rce_poc.md)

## CVE-2021-22986-F5-BIG-IP-iControl-REST-RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，可导致完全控制受影响的系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经验证的远程命令执行漏洞。攻击者无需身份验证即可通过构造恶意请求在目标系统上执行任意命令。

**利用方式：**

1.  **直接RCE (poc_1):** 利用PoC代码中的 `poc_1` 函数，通过构造包含恶意命令的 JSON 数据包，发送到目标设备的 `/mgmt/tm/util/bash` 接口。由于漏洞未授权，攻击者可以绕过身份验证，直接执行命令。

2.  **SSRF + RCE (ssrf_poc):** 利用PoC代码中的 `ssrf_poc` 函数，首先利用漏洞存在的SSRF漏洞，通过 `/mgmt/shared/authn/login` 接口获取一个有效的 Token。然后，使用该 Token，结合 `poc_1` 类似的 RCE 方法，在目标设备上执行任意命令。这种方式更隐蔽，也可能绕过一些简单的防御机制。

**投毒风险分析：**

该代码整体结构清晰，主要是实现了漏洞的复现和利用，代码的可读性较强。经过分析，PoC代码中并没有明显的恶意投毒行为。例如，没有发现反弹shell，持续驻留，或者信息搜集等恶意代码。但是该代码存在一定的风险，如果被恶意使用者修改，可能会被植入恶意代码，例如添加反弹shell等功能。因此，判定该仓库存在10%的投毒风险。

**搜索引擎结果印证：**

*   多个来源表明该漏洞在野外被积极利用（例如，Arctic Wolf 的报告）。
*   NCC Group 指出，存在不需要 SSRF 的 PoC，说明该漏洞的利用方式多样。
*   Imperva 的文章提到攻击活动在漏洞披露后激增。

综上所述，该漏洞利用代码有效，风险极高，攻击者可通过多种方式远程控制受影响的F5设备。

**项目地址:** [S1xHcL/f5_rce_poc](https://github.com/S1xHcL/f5_rce_poc)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #5

**来源**: [CVE-2021-22986-Tas9er_CVE-2021-22986.md](../2021/CVE-2021-22986-Tas9er_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP iControl RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中存在的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
根据漏洞信息、搜索结果（特别是NCC Group的分析）和漏洞利用代码，该漏洞是有效的。搜索引擎结果显示该漏洞已被积极利用。

**投毒风险：**
提供的POC代码包括一个 `README.md` 文件，其中包含免责声明，声明该工具仅用于授权安全测试。漏洞利用代码本身似乎是一个简单的利用程序，从 `url.txt` 读取目标 URL。但是，也存在潜在的风险，比如`CVE-2021-22986.jar`包含恶意代码，但因为没有jar包文件无法判断，结合免责声明，判定存在少量投毒风险。

**利用方式：**
利用方式涉及以下步骤：
1.  准备包含目标 URL 的 `url.txt` 文件。
2.  运行 `java -jar CVE-2021-22986.jar` 命令。

该工具通过未授权访问 iControl REST 接口，然后发送包含恶意命令的请求来利用漏洞。成功利用后，攻击者可以在受影响的 BIG-IP 或 BIG-IQ 设备上执行任意命令。

**优先级排序：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

搜索引擎结果表明该漏洞已被积极利用，漏洞利用代码提供了一个简单的利用方法，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Tas9er/CVE-2021-22986](https://github.com/Tas9er/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #6

**来源**: [CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md](../2021/CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST API-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统运行受影响的F5 BIG-IP或BIG-IQ版本，且iControl REST API接口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程命令执行。根据漏洞库信息和搜索结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。漏洞利用代码（Checker.py）通过构造包含恶意命令的JSON数据，并将其以POST请求发送到`/mgmt/tm/util/bash`端点来利用此漏洞。请求头包含`Content-Type: application/json`，并且尝试使用`X-F5-Auth-Token`（尽管为空）以及一个Base64编码的`Authorization`头（`admin:ASasasM`）。

有效性分析：提供的POC代码通过发送精心构造的POST请求到目标设备的iControl REST API来执行命令。如果目标设备存在漏洞且未打补丁，则可以成功执行命令。代码通过检查响应状态码是否为200以及响应文本中是否存在"commandResult"来判断是否成功利用漏洞。

投毒风险分析：查看提供的文件列表，包含`CODEOWNERS`、`Checker.py`、`README.md`。`CODEOWNERS`只包含一个github用户，没有发现可疑之处。`README.md`仅仅是描述如何使用脚本。`Checker.py`中，请求的URL和请求方式都是根据漏洞信息构造的，用于验证漏洞是否存在，并没有发现可以投毒的地方。`Authorization`头虽然存在，但其用户名和密码应该是用于某些情况下的身份验证，不属于恶意代码或后门。所以，此仓库中不存在明显的投毒代码。因此，投毒风险评估为0%。

利用方式：攻击者构造恶意的JSON数据，其中包含要在目标系统上执行的命令。然后，通过HTTP POST请求将此数据发送到目标设备的iControl REST API的特定端点（`/mgmt/tm/util/bash`）。由于漏洞存在于身份验证绕过，因此无需提供有效的身份验证信息即可执行命令。成功利用漏洞后，攻击者可以在目标系统上执行任意命令。

**项目地址:** [ZephrFish/CVE-2021-22986_Check](https://github.com/ZephrFish/CVE-2021-22986_Check)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #7

**来源**: [CVE-2021-22986-amitlttwo_CVE-2021-22986.md](../2021/CVE-2021-22986-amitlttwo_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 需要网络访问 iControl REST 接口 (通常通过管理界面或 Self IP 地址)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的攻击者执行任意系统命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 BIG-IP 和 BIG-IQ。搜索结果表明，该漏洞在野外已被积极利用，甚至被 Mirai 僵尸网络利用。提供的漏洞利用代码 `cve-2021-22986.py` 提供验证漏洞、执行命令、批量扫描和反弹 shell 的功能。它通过向 `/mgmt/tm/util/bash` 接口发送包含命令的 POST 请求来利用漏洞。其中Authorization header的Base64字符串 `YWRtaW46QVNhc1M=` 解码后为 `admin:ASasS`。利用方式是构造包含要执行的命令的 JSON 数据，并将其发送到易受攻击的 iControl REST 端点。由于代码中使用的header值是固定的,存在被记录的风险。关于投毒风险，快速浏览代码没有发现明显的恶意代码，但无法保证代码没有隐藏的后门或恶意行为，考虑到项目协作和网络安全风险，将投毒风险评估为10%，主要来自作者的不可信和payload的风险

**项目地址:** [amitlttwo/CVE-2021-22986](https://github.com/amitlttwo/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #8

**来源**: [CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md](../2021/CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md)

# CVE-2021-22986

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-22986-Al1ex_CVE-2021-22986.md](../2021/CVE-2021-22986-Al1ex_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经验证的远程命令执行漏洞。攻击者可以发送特制的 HTTP 请求到 `/mgmt/tm/util/bash` 接口，在目标系统上执行任意命令。

**有效性:**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开可用的PoC代码。提供的PoC代码通过构造包含命令的JSON数据，发送POST请求到目标URL的`/mgmt/tm/util/bash`接口，从而执行命令。代码中包含了验证模式、攻击模式、批量检测模式和反弹shell模式，验证了其有效性。

**投毒风险:**
PoC代码本身主要功能是利用漏洞执行命令，投毒风险较低。但依旧存在一定投毒风险：
1.  **默认认证信息:** 代码中硬编码了 `Authorization: Basic YWRtaW46QVNhc1M=` 默认认证信息（admin:ASasS），若目标系统仍使用此默认密码，则漏洞利用成功概率更高，但这也可能被攻击者利用，如果攻击者修改了目标系统的配置,可能会影响正常的业务.
2.  **反弹shell风险:**  反弹shell功能如果被恶意利用，可能在受害者不知情的情况下建立连接。
3.  **脚本作者风险:**  作者 Al1ex@Heptagram 的真实意图未知，可能在未来版本中添加恶意代码. 总体投毒风险预估为10%。

**利用方式:**
1.  确定目标F5 BIG-IP/BIG-IQ设备的版本在受影响范围内。
2.  使用PoC脚本，指定目标URL，并选择验证模式或攻击模式。
3.  在攻击模式下，指定要执行的命令。反弹shell模式可用于建立反向shell连接。
4.  对于批量检测，提供包含目标URL的文件。
5.  运行PoC脚本，利用漏洞执行命令。

**项目地址:** [Al1ex/CVE-2021-22986](https://github.com/Al1ex/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #2

**来源**: [CVE-2021-22986-DDestinys_CVE-2021-22986.md](../2021/CVE-2021-22986-DDestinys_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可以访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ中iControl REST接口的一个未经身份验证的远程命令执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。该漏洞允许未经身份验证的攻击者通过向iControl REST API发送特制的请求来执行任意命令。

**有效性：**

提供的POC代码看起来是有效的。它通过构造一个包含要执行的命令的JSON payload，并将其POST到`/mgmt/tm/util/bash`端点来利用此漏洞。代码首先尝试读取一个url列表，遍历这些url，并且发送post请求，验证是否成功执行。由于`CVE-2021-22986` 是一个被广泛研究的漏洞，有很多公开可用的利用代码，此POC代码是符合漏洞描述的。

**投毒风险：**

POC代码的投毒风险较低，约为10%。 代码本身的功能看起来是正常的漏洞利用，但是存在以下潜在的风险点：

1.  代码中存在一个`proxies`变量,如果使用者不注意修改，可能会将流量转发到攻击者控制的代理服务器。
2.  使用了`requests.packages.urllib3.disable_warnings()`，虽然这通常用于避免SSL证书验证问题，但可能会隐藏其他潜在的安全问题。
3.  代码尝试读取`url.txt`文件，并执行POST请求，如果`url.txt`文件被篡改，可能会导致意外的漏洞利用。
4. 代码中包含一个硬编码的 Basic 认证头 `Authorization: Basic YWRtaW46YWRtaW4=`, 虽然在漏洞利用中不太可能被直接使用，但如果使用者不清楚其含义，可能会在其他场景中错误使用。

这些潜在的风险点使得代码存在一定的投毒风险，但总体而言，代码的主要目的是利用漏洞，而非进行恶意行为。

**利用方式：**

利用方式如下：

1.  攻击者需要找到存在漏洞的F5 BIG-IP或BIG-IQ实例。
2.  攻击者构造一个包含恶意命令的JSON payload，例如`{'command': 'run', 'utilCmdArgs': '-c id'}`，其中`id`命令可以替换为任意系统命令。
3.  攻击者使用POST请求将该payload发送到目标的`/mgmt/tm/util/bash`端点，无需身份验证。
4.  服务器执行该命令，并将结果返回给攻击者。

此外，搜索引擎结果中提到，该漏洞已被Mirai僵尸网络利用，攻击者可以使用此漏洞来感染目标系统，并将其纳入僵尸网络。

**排序优先级：**

搜索引擎结果显示该漏洞已经被广泛利用，并且存在公开的POC，因此优先级最高。漏洞利用代码验证了漏洞的可利用性，并且有助于理解利用方式。漏洞库信息提供了漏洞的官方描述和受影响的版本范围，是重要的参考信息。

**项目地址:** [DDestinys/CVE-2021-22986](https://github.com/DDestinys/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #3

**来源**: [CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md](../2021/CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md)

## CVE-2021-22986-F5 BIG-IP iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未授权远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统开启并暴露iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经身份验证的远程命令执行漏洞。漏洞存在于受影响版本的 iControl REST 接口中，允许未经身份验证的攻击者通过发送特制的 HTTP 请求执行任意系统命令。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被积极利用，并且存在公开的 PoC。虽然提供的漏洞利用代码 `/tmp/787246e6ce6e87a4ad488e0e4cce542c/README.md` 看起来只是一个扫描器或者一个占位符，但它表明已经有人在研究并分享关于这个漏洞的利用方法。

**投毒风险：**
提供的代码片段 `README.md` 文件本身不包含可执行代码，因此直接投毒的可能性较低。 但是，考虑到漏洞已经被公开，攻击者可能会创建恶意模块或脚本，伪装成漏洞利用工具，但实际上执行恶意操作。例如，某些PoC中可能包含下载恶意payload执行的操作。因为缺乏代码分析，这里假设有10%的可能性是作者隐藏了投毒代码。

**利用方式：**
1.  **未授权访问:** 攻击者无需身份验证即可访问 iControl REST 接口。
2.  **构造恶意请求:**  攻击者构造包含恶意命令的 HTTP 请求，通常利用 Server-Side Request Forgery (SSRF) 或直接命令注入绕过认证执行命令。
3.  **命令执行:**  BIG-IP/BIG-IQ 系统在收到恶意请求后，执行其中的命令，导致远程代码执行。

**总结：**
CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意代码。由于存在公开的 PoC 并且漏洞已被积极利用，受影响的用户应尽快升级到受支持的版本，或采取缓解措施。

**项目地址:** [Osyanina/westone-CVE-2021-22986-scanner](https://github.com/Osyanina/westone-CVE-2021-22986-scanner)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #4

**来源**: [CVE-2021-22986-S1xHcL_f5_rce_poc.md](../2021/CVE-2021-22986-S1xHcL_f5_rce_poc.md)

## CVE-2021-22986-F5-BIG-IP-iControl-REST-RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，可导致完全控制受影响的系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经验证的远程命令执行漏洞。攻击者无需身份验证即可通过构造恶意请求在目标系统上执行任意命令。

**利用方式：**

1.  **直接RCE (poc_1):** 利用PoC代码中的 `poc_1` 函数，通过构造包含恶意命令的 JSON 数据包，发送到目标设备的 `/mgmt/tm/util/bash` 接口。由于漏洞未授权，攻击者可以绕过身份验证，直接执行命令。

2.  **SSRF + RCE (ssrf_poc):** 利用PoC代码中的 `ssrf_poc` 函数，首先利用漏洞存在的SSRF漏洞，通过 `/mgmt/shared/authn/login` 接口获取一个有效的 Token。然后，使用该 Token，结合 `poc_1` 类似的 RCE 方法，在目标设备上执行任意命令。这种方式更隐蔽，也可能绕过一些简单的防御机制。

**投毒风险分析：**

该代码整体结构清晰，主要是实现了漏洞的复现和利用，代码的可读性较强。经过分析，PoC代码中并没有明显的恶意投毒行为。例如，没有发现反弹shell，持续驻留，或者信息搜集等恶意代码。但是该代码存在一定的风险，如果被恶意使用者修改，可能会被植入恶意代码，例如添加反弹shell等功能。因此，判定该仓库存在10%的投毒风险。

**搜索引擎结果印证：**

*   多个来源表明该漏洞在野外被积极利用（例如，Arctic Wolf 的报告）。
*   NCC Group 指出，存在不需要 SSRF 的 PoC，说明该漏洞的利用方式多样。
*   Imperva 的文章提到攻击活动在漏洞披露后激增。

综上所述，该漏洞利用代码有效，风险极高，攻击者可通过多种方式远程控制受影响的F5设备。

**项目地址:** [S1xHcL/f5_rce_poc](https://github.com/S1xHcL/f5_rce_poc)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #5

**来源**: [CVE-2021-22986-Tas9er_CVE-2021-22986.md](../2021/CVE-2021-22986-Tas9er_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP iControl RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中存在的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
根据漏洞信息、搜索结果（特别是NCC Group的分析）和漏洞利用代码，该漏洞是有效的。搜索引擎结果显示该漏洞已被积极利用。

**投毒风险：**
提供的POC代码包括一个 `README.md` 文件，其中包含免责声明，声明该工具仅用于授权安全测试。漏洞利用代码本身似乎是一个简单的利用程序，从 `url.txt` 读取目标 URL。但是，也存在潜在的风险，比如`CVE-2021-22986.jar`包含恶意代码，但因为没有jar包文件无法判断，结合免责声明，判定存在少量投毒风险。

**利用方式：**
利用方式涉及以下步骤：
1.  准备包含目标 URL 的 `url.txt` 文件。
2.  运行 `java -jar CVE-2021-22986.jar` 命令。

该工具通过未授权访问 iControl REST 接口，然后发送包含恶意命令的请求来利用漏洞。成功利用后，攻击者可以在受影响的 BIG-IP 或 BIG-IQ 设备上执行任意命令。

**优先级排序：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

搜索引擎结果表明该漏洞已被积极利用，漏洞利用代码提供了一个简单的利用方法，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Tas9er/CVE-2021-22986](https://github.com/Tas9er/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #6

**来源**: [CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md](../2021/CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST API-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统运行受影响的F5 BIG-IP或BIG-IQ版本，且iControl REST API接口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程命令执行。根据漏洞库信息和搜索结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。漏洞利用代码（Checker.py）通过构造包含恶意命令的JSON数据，并将其以POST请求发送到`/mgmt/tm/util/bash`端点来利用此漏洞。请求头包含`Content-Type: application/json`，并且尝试使用`X-F5-Auth-Token`（尽管为空）以及一个Base64编码的`Authorization`头（`admin:ASasasM`）。

有效性分析：提供的POC代码通过发送精心构造的POST请求到目标设备的iControl REST API来执行命令。如果目标设备存在漏洞且未打补丁，则可以成功执行命令。代码通过检查响应状态码是否为200以及响应文本中是否存在"commandResult"来判断是否成功利用漏洞。

投毒风险分析：查看提供的文件列表，包含`CODEOWNERS`、`Checker.py`、`README.md`。`CODEOWNERS`只包含一个github用户，没有发现可疑之处。`README.md`仅仅是描述如何使用脚本。`Checker.py`中，请求的URL和请求方式都是根据漏洞信息构造的，用于验证漏洞是否存在，并没有发现可以投毒的地方。`Authorization`头虽然存在，但其用户名和密码应该是用于某些情况下的身份验证，不属于恶意代码或后门。所以，此仓库中不存在明显的投毒代码。因此，投毒风险评估为0%。

利用方式：攻击者构造恶意的JSON数据，其中包含要在目标系统上执行的命令。然后，通过HTTP POST请求将此数据发送到目标设备的iControl REST API的特定端点（`/mgmt/tm/util/bash`）。由于漏洞存在于身份验证绕过，因此无需提供有效的身份验证信息即可执行命令。成功利用漏洞后，攻击者可以在目标系统上执行任意命令。

**项目地址:** [ZephrFish/CVE-2021-22986_Check](https://github.com/ZephrFish/CVE-2021-22986_Check)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #7

**来源**: [CVE-2021-22986-amitlttwo_CVE-2021-22986.md](../2021/CVE-2021-22986-amitlttwo_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 需要网络访问 iControl REST 接口 (通常通过管理界面或 Self IP 地址)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的攻击者执行任意系统命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 BIG-IP 和 BIG-IQ。搜索结果表明，该漏洞在野外已被积极利用，甚至被 Mirai 僵尸网络利用。提供的漏洞利用代码 `cve-2021-22986.py` 提供验证漏洞、执行命令、批量扫描和反弹 shell 的功能。它通过向 `/mgmt/tm/util/bash` 接口发送包含命令的 POST 请求来利用漏洞。其中Authorization header的Base64字符串 `YWRtaW46QVNhc1M=` 解码后为 `admin:ASasS`。利用方式是构造包含要执行的命令的 JSON 数据，并将其发送到易受攻击的 iControl REST 端点。由于代码中使用的header值是固定的,存在被记录的风险。关于投毒风险，快速浏览代码没有发现明显的恶意代码，但无法保证代码没有隐藏的后门或恶意行为，考虑到项目协作和网络安全风险，将投毒风险评估为10%，主要来自作者的不可信和payload的风险

**项目地址:** [amitlttwo/CVE-2021-22986](https://github.com/amitlttwo/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #8

**来源**: [CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md](../2021/CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md)

# CVE-2021-22986

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-22986-Al1ex_CVE-2021-22986.md](../2021/CVE-2021-22986-Al1ex_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经验证的远程命令执行漏洞。攻击者可以发送特制的 HTTP 请求到 `/mgmt/tm/util/bash` 接口，在目标系统上执行任意命令。

**有效性:**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开可用的PoC代码。提供的PoC代码通过构造包含命令的JSON数据，发送POST请求到目标URL的`/mgmt/tm/util/bash`接口，从而执行命令。代码中包含了验证模式、攻击模式、批量检测模式和反弹shell模式，验证了其有效性。

**投毒风险:**
PoC代码本身主要功能是利用漏洞执行命令，投毒风险较低。但依旧存在一定投毒风险：
1.  **默认认证信息:** 代码中硬编码了 `Authorization: Basic YWRtaW46QVNhc1M=` 默认认证信息（admin:ASasS），若目标系统仍使用此默认密码，则漏洞利用成功概率更高，但这也可能被攻击者利用，如果攻击者修改了目标系统的配置,可能会影响正常的业务.
2.  **反弹shell风险:**  反弹shell功能如果被恶意利用，可能在受害者不知情的情况下建立连接。
3.  **脚本作者风险:**  作者 Al1ex@Heptagram 的真实意图未知，可能在未来版本中添加恶意代码. 总体投毒风险预估为10%。

**利用方式:**
1.  确定目标F5 BIG-IP/BIG-IQ设备的版本在受影响范围内。
2.  使用PoC脚本，指定目标URL，并选择验证模式或攻击模式。
3.  在攻击模式下，指定要执行的命令。反弹shell模式可用于建立反向shell连接。
4.  对于批量检测，提供包含目标URL的文件。
5.  运行PoC脚本，利用漏洞执行命令。

**项目地址:** [Al1ex/CVE-2021-22986](https://github.com/Al1ex/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #2

**来源**: [CVE-2021-22986-DDestinys_CVE-2021-22986.md](../2021/CVE-2021-22986-DDestinys_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可以访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ中iControl REST接口的一个未经身份验证的远程命令执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。该漏洞允许未经身份验证的攻击者通过向iControl REST API发送特制的请求来执行任意命令。

**有效性：**

提供的POC代码看起来是有效的。它通过构造一个包含要执行的命令的JSON payload，并将其POST到`/mgmt/tm/util/bash`端点来利用此漏洞。代码首先尝试读取一个url列表，遍历这些url，并且发送post请求，验证是否成功执行。由于`CVE-2021-22986` 是一个被广泛研究的漏洞，有很多公开可用的利用代码，此POC代码是符合漏洞描述的。

**投毒风险：**

POC代码的投毒风险较低，约为10%。 代码本身的功能看起来是正常的漏洞利用，但是存在以下潜在的风险点：

1.  代码中存在一个`proxies`变量,如果使用者不注意修改，可能会将流量转发到攻击者控制的代理服务器。
2.  使用了`requests.packages.urllib3.disable_warnings()`，虽然这通常用于避免SSL证书验证问题，但可能会隐藏其他潜在的安全问题。
3.  代码尝试读取`url.txt`文件，并执行POST请求，如果`url.txt`文件被篡改，可能会导致意外的漏洞利用。
4. 代码中包含一个硬编码的 Basic 认证头 `Authorization: Basic YWRtaW46YWRtaW4=`, 虽然在漏洞利用中不太可能被直接使用，但如果使用者不清楚其含义，可能会在其他场景中错误使用。

这些潜在的风险点使得代码存在一定的投毒风险，但总体而言，代码的主要目的是利用漏洞，而非进行恶意行为。

**利用方式：**

利用方式如下：

1.  攻击者需要找到存在漏洞的F5 BIG-IP或BIG-IQ实例。
2.  攻击者构造一个包含恶意命令的JSON payload，例如`{'command': 'run', 'utilCmdArgs': '-c id'}`，其中`id`命令可以替换为任意系统命令。
3.  攻击者使用POST请求将该payload发送到目标的`/mgmt/tm/util/bash`端点，无需身份验证。
4.  服务器执行该命令，并将结果返回给攻击者。

此外，搜索引擎结果中提到，该漏洞已被Mirai僵尸网络利用，攻击者可以使用此漏洞来感染目标系统，并将其纳入僵尸网络。

**排序优先级：**

搜索引擎结果显示该漏洞已经被广泛利用，并且存在公开的POC，因此优先级最高。漏洞利用代码验证了漏洞的可利用性，并且有助于理解利用方式。漏洞库信息提供了漏洞的官方描述和受影响的版本范围，是重要的参考信息。

**项目地址:** [DDestinys/CVE-2021-22986](https://github.com/DDestinys/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #3

**来源**: [CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md](../2021/CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md)

## CVE-2021-22986-F5 BIG-IP iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未授权远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统开启并暴露iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经身份验证的远程命令执行漏洞。漏洞存在于受影响版本的 iControl REST 接口中，允许未经身份验证的攻击者通过发送特制的 HTTP 请求执行任意系统命令。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被积极利用，并且存在公开的 PoC。虽然提供的漏洞利用代码 `/tmp/787246e6ce6e87a4ad488e0e4cce542c/README.md` 看起来只是一个扫描器或者一个占位符，但它表明已经有人在研究并分享关于这个漏洞的利用方法。

**投毒风险：**
提供的代码片段 `README.md` 文件本身不包含可执行代码，因此直接投毒的可能性较低。 但是，考虑到漏洞已经被公开，攻击者可能会创建恶意模块或脚本，伪装成漏洞利用工具，但实际上执行恶意操作。例如，某些PoC中可能包含下载恶意payload执行的操作。因为缺乏代码分析，这里假设有10%的可能性是作者隐藏了投毒代码。

**利用方式：**
1.  **未授权访问:** 攻击者无需身份验证即可访问 iControl REST 接口。
2.  **构造恶意请求:**  攻击者构造包含恶意命令的 HTTP 请求，通常利用 Server-Side Request Forgery (SSRF) 或直接命令注入绕过认证执行命令。
3.  **命令执行:**  BIG-IP/BIG-IQ 系统在收到恶意请求后，执行其中的命令，导致远程代码执行。

**总结：**
CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意代码。由于存在公开的 PoC 并且漏洞已被积极利用，受影响的用户应尽快升级到受支持的版本，或采取缓解措施。

**项目地址:** [Osyanina/westone-CVE-2021-22986-scanner](https://github.com/Osyanina/westone-CVE-2021-22986-scanner)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #4

**来源**: [CVE-2021-22986-S1xHcL_f5_rce_poc.md](../2021/CVE-2021-22986-S1xHcL_f5_rce_poc.md)

## CVE-2021-22986-F5-BIG-IP-iControl-REST-RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，可导致完全控制受影响的系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经验证的远程命令执行漏洞。攻击者无需身份验证即可通过构造恶意请求在目标系统上执行任意命令。

**利用方式：**

1.  **直接RCE (poc_1):** 利用PoC代码中的 `poc_1` 函数，通过构造包含恶意命令的 JSON 数据包，发送到目标设备的 `/mgmt/tm/util/bash` 接口。由于漏洞未授权，攻击者可以绕过身份验证，直接执行命令。

2.  **SSRF + RCE (ssrf_poc):** 利用PoC代码中的 `ssrf_poc` 函数，首先利用漏洞存在的SSRF漏洞，通过 `/mgmt/shared/authn/login` 接口获取一个有效的 Token。然后，使用该 Token，结合 `poc_1` 类似的 RCE 方法，在目标设备上执行任意命令。这种方式更隐蔽，也可能绕过一些简单的防御机制。

**投毒风险分析：**

该代码整体结构清晰，主要是实现了漏洞的复现和利用，代码的可读性较强。经过分析，PoC代码中并没有明显的恶意投毒行为。例如，没有发现反弹shell，持续驻留，或者信息搜集等恶意代码。但是该代码存在一定的风险，如果被恶意使用者修改，可能会被植入恶意代码，例如添加反弹shell等功能。因此，判定该仓库存在10%的投毒风险。

**搜索引擎结果印证：**

*   多个来源表明该漏洞在野外被积极利用（例如，Arctic Wolf 的报告）。
*   NCC Group 指出，存在不需要 SSRF 的 PoC，说明该漏洞的利用方式多样。
*   Imperva 的文章提到攻击活动在漏洞披露后激增。

综上所述，该漏洞利用代码有效，风险极高，攻击者可通过多种方式远程控制受影响的F5设备。

**项目地址:** [S1xHcL/f5_rce_poc](https://github.com/S1xHcL/f5_rce_poc)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #5

**来源**: [CVE-2021-22986-Tas9er_CVE-2021-22986.md](../2021/CVE-2021-22986-Tas9er_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP iControl RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中存在的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
根据漏洞信息、搜索结果（特别是NCC Group的分析）和漏洞利用代码，该漏洞是有效的。搜索引擎结果显示该漏洞已被积极利用。

**投毒风险：**
提供的POC代码包括一个 `README.md` 文件，其中包含免责声明，声明该工具仅用于授权安全测试。漏洞利用代码本身似乎是一个简单的利用程序，从 `url.txt` 读取目标 URL。但是，也存在潜在的风险，比如`CVE-2021-22986.jar`包含恶意代码，但因为没有jar包文件无法判断，结合免责声明，判定存在少量投毒风险。

**利用方式：**
利用方式涉及以下步骤：
1.  准备包含目标 URL 的 `url.txt` 文件。
2.  运行 `java -jar CVE-2021-22986.jar` 命令。

该工具通过未授权访问 iControl REST 接口，然后发送包含恶意命令的请求来利用漏洞。成功利用后，攻击者可以在受影响的 BIG-IP 或 BIG-IQ 设备上执行任意命令。

**优先级排序：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

搜索引擎结果表明该漏洞已被积极利用，漏洞利用代码提供了一个简单的利用方法，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Tas9er/CVE-2021-22986](https://github.com/Tas9er/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #6

**来源**: [CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md](../2021/CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST API-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统运行受影响的F5 BIG-IP或BIG-IQ版本，且iControl REST API接口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程命令执行。根据漏洞库信息和搜索结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。漏洞利用代码（Checker.py）通过构造包含恶意命令的JSON数据，并将其以POST请求发送到`/mgmt/tm/util/bash`端点来利用此漏洞。请求头包含`Content-Type: application/json`，并且尝试使用`X-F5-Auth-Token`（尽管为空）以及一个Base64编码的`Authorization`头（`admin:ASasasM`）。

有效性分析：提供的POC代码通过发送精心构造的POST请求到目标设备的iControl REST API来执行命令。如果目标设备存在漏洞且未打补丁，则可以成功执行命令。代码通过检查响应状态码是否为200以及响应文本中是否存在"commandResult"来判断是否成功利用漏洞。

投毒风险分析：查看提供的文件列表，包含`CODEOWNERS`、`Checker.py`、`README.md`。`CODEOWNERS`只包含一个github用户，没有发现可疑之处。`README.md`仅仅是描述如何使用脚本。`Checker.py`中，请求的URL和请求方式都是根据漏洞信息构造的，用于验证漏洞是否存在，并没有发现可以投毒的地方。`Authorization`头虽然存在，但其用户名和密码应该是用于某些情况下的身份验证，不属于恶意代码或后门。所以，此仓库中不存在明显的投毒代码。因此，投毒风险评估为0%。

利用方式：攻击者构造恶意的JSON数据，其中包含要在目标系统上执行的命令。然后，通过HTTP POST请求将此数据发送到目标设备的iControl REST API的特定端点（`/mgmt/tm/util/bash`）。由于漏洞存在于身份验证绕过，因此无需提供有效的身份验证信息即可执行命令。成功利用漏洞后，攻击者可以在目标系统上执行任意命令。

**项目地址:** [ZephrFish/CVE-2021-22986_Check](https://github.com/ZephrFish/CVE-2021-22986_Check)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #7

**来源**: [CVE-2021-22986-amitlttwo_CVE-2021-22986.md](../2021/CVE-2021-22986-amitlttwo_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 需要网络访问 iControl REST 接口 (通常通过管理界面或 Self IP 地址)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的攻击者执行任意系统命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 BIG-IP 和 BIG-IQ。搜索结果表明，该漏洞在野外已被积极利用，甚至被 Mirai 僵尸网络利用。提供的漏洞利用代码 `cve-2021-22986.py` 提供验证漏洞、执行命令、批量扫描和反弹 shell 的功能。它通过向 `/mgmt/tm/util/bash` 接口发送包含命令的 POST 请求来利用漏洞。其中Authorization header的Base64字符串 `YWRtaW46QVNhc1M=` 解码后为 `admin:ASasS`。利用方式是构造包含要执行的命令的 JSON 数据，并将其发送到易受攻击的 iControl REST 端点。由于代码中使用的header值是固定的,存在被记录的风险。关于投毒风险，快速浏览代码没有发现明显的恶意代码，但无法保证代码没有隐藏的后门或恶意行为，考虑到项目协作和网络安全风险，将投毒风险评估为10%，主要来自作者的不可信和payload的风险

**项目地址:** [amitlttwo/CVE-2021-22986](https://github.com/amitlttwo/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #8

**来源**: [CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md](../2021/CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md)

# CVE-2021-22986

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-22986-Al1ex_CVE-2021-22986.md](../2021/CVE-2021-22986-Al1ex_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经验证的远程命令执行漏洞。攻击者可以发送特制的 HTTP 请求到 `/mgmt/tm/util/bash` 接口，在目标系统上执行任意命令。

**有效性:**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开可用的PoC代码。提供的PoC代码通过构造包含命令的JSON数据，发送POST请求到目标URL的`/mgmt/tm/util/bash`接口，从而执行命令。代码中包含了验证模式、攻击模式、批量检测模式和反弹shell模式，验证了其有效性。

**投毒风险:**
PoC代码本身主要功能是利用漏洞执行命令，投毒风险较低。但依旧存在一定投毒风险：
1.  **默认认证信息:** 代码中硬编码了 `Authorization: Basic YWRtaW46QVNhc1M=` 默认认证信息（admin:ASasS），若目标系统仍使用此默认密码，则漏洞利用成功概率更高，但这也可能被攻击者利用，如果攻击者修改了目标系统的配置,可能会影响正常的业务.
2.  **反弹shell风险:**  反弹shell功能如果被恶意利用，可能在受害者不知情的情况下建立连接。
3.  **脚本作者风险:**  作者 Al1ex@Heptagram 的真实意图未知，可能在未来版本中添加恶意代码. 总体投毒风险预估为10%。

**利用方式:**
1.  确定目标F5 BIG-IP/BIG-IQ设备的版本在受影响范围内。
2.  使用PoC脚本，指定目标URL，并选择验证模式或攻击模式。
3.  在攻击模式下，指定要执行的命令。反弹shell模式可用于建立反向shell连接。
4.  对于批量检测，提供包含目标URL的文件。
5.  运行PoC脚本，利用漏洞执行命令。

**项目地址:** [Al1ex/CVE-2021-22986](https://github.com/Al1ex/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #2

**来源**: [CVE-2021-22986-DDestinys_CVE-2021-22986.md](../2021/CVE-2021-22986-DDestinys_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可以访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ中iControl REST接口的一个未经身份验证的远程命令执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。该漏洞允许未经身份验证的攻击者通过向iControl REST API发送特制的请求来执行任意命令。

**有效性：**

提供的POC代码看起来是有效的。它通过构造一个包含要执行的命令的JSON payload，并将其POST到`/mgmt/tm/util/bash`端点来利用此漏洞。代码首先尝试读取一个url列表，遍历这些url，并且发送post请求，验证是否成功执行。由于`CVE-2021-22986` 是一个被广泛研究的漏洞，有很多公开可用的利用代码，此POC代码是符合漏洞描述的。

**投毒风险：**

POC代码的投毒风险较低，约为10%。 代码本身的功能看起来是正常的漏洞利用，但是存在以下潜在的风险点：

1.  代码中存在一个`proxies`变量,如果使用者不注意修改，可能会将流量转发到攻击者控制的代理服务器。
2.  使用了`requests.packages.urllib3.disable_warnings()`，虽然这通常用于避免SSL证书验证问题，但可能会隐藏其他潜在的安全问题。
3.  代码尝试读取`url.txt`文件，并执行POST请求，如果`url.txt`文件被篡改，可能会导致意外的漏洞利用。
4. 代码中包含一个硬编码的 Basic 认证头 `Authorization: Basic YWRtaW46YWRtaW4=`, 虽然在漏洞利用中不太可能被直接使用，但如果使用者不清楚其含义，可能会在其他场景中错误使用。

这些潜在的风险点使得代码存在一定的投毒风险，但总体而言，代码的主要目的是利用漏洞，而非进行恶意行为。

**利用方式：**

利用方式如下：

1.  攻击者需要找到存在漏洞的F5 BIG-IP或BIG-IQ实例。
2.  攻击者构造一个包含恶意命令的JSON payload，例如`{'command': 'run', 'utilCmdArgs': '-c id'}`，其中`id`命令可以替换为任意系统命令。
3.  攻击者使用POST请求将该payload发送到目标的`/mgmt/tm/util/bash`端点，无需身份验证。
4.  服务器执行该命令，并将结果返回给攻击者。

此外，搜索引擎结果中提到，该漏洞已被Mirai僵尸网络利用，攻击者可以使用此漏洞来感染目标系统，并将其纳入僵尸网络。

**排序优先级：**

搜索引擎结果显示该漏洞已经被广泛利用，并且存在公开的POC，因此优先级最高。漏洞利用代码验证了漏洞的可利用性，并且有助于理解利用方式。漏洞库信息提供了漏洞的官方描述和受影响的版本范围，是重要的参考信息。

**项目地址:** [DDestinys/CVE-2021-22986](https://github.com/DDestinys/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #3

**来源**: [CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md](../2021/CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md)

## CVE-2021-22986-F5 BIG-IP iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未授权远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统开启并暴露iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经身份验证的远程命令执行漏洞。漏洞存在于受影响版本的 iControl REST 接口中，允许未经身份验证的攻击者通过发送特制的 HTTP 请求执行任意系统命令。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被积极利用，并且存在公开的 PoC。虽然提供的漏洞利用代码 `/tmp/787246e6ce6e87a4ad488e0e4cce542c/README.md` 看起来只是一个扫描器或者一个占位符，但它表明已经有人在研究并分享关于这个漏洞的利用方法。

**投毒风险：**
提供的代码片段 `README.md` 文件本身不包含可执行代码，因此直接投毒的可能性较低。 但是，考虑到漏洞已经被公开，攻击者可能会创建恶意模块或脚本，伪装成漏洞利用工具，但实际上执行恶意操作。例如，某些PoC中可能包含下载恶意payload执行的操作。因为缺乏代码分析，这里假设有10%的可能性是作者隐藏了投毒代码。

**利用方式：**
1.  **未授权访问:** 攻击者无需身份验证即可访问 iControl REST 接口。
2.  **构造恶意请求:**  攻击者构造包含恶意命令的 HTTP 请求，通常利用 Server-Side Request Forgery (SSRF) 或直接命令注入绕过认证执行命令。
3.  **命令执行:**  BIG-IP/BIG-IQ 系统在收到恶意请求后，执行其中的命令，导致远程代码执行。

**总结：**
CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意代码。由于存在公开的 PoC 并且漏洞已被积极利用，受影响的用户应尽快升级到受支持的版本，或采取缓解措施。

**项目地址:** [Osyanina/westone-CVE-2021-22986-scanner](https://github.com/Osyanina/westone-CVE-2021-22986-scanner)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #4

**来源**: [CVE-2021-22986-S1xHcL_f5_rce_poc.md](../2021/CVE-2021-22986-S1xHcL_f5_rce_poc.md)

## CVE-2021-22986-F5-BIG-IP-iControl-REST-RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，可导致完全控制受影响的系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经验证的远程命令执行漏洞。攻击者无需身份验证即可通过构造恶意请求在目标系统上执行任意命令。

**利用方式：**

1.  **直接RCE (poc_1):** 利用PoC代码中的 `poc_1` 函数，通过构造包含恶意命令的 JSON 数据包，发送到目标设备的 `/mgmt/tm/util/bash` 接口。由于漏洞未授权，攻击者可以绕过身份验证，直接执行命令。

2.  **SSRF + RCE (ssrf_poc):** 利用PoC代码中的 `ssrf_poc` 函数，首先利用漏洞存在的SSRF漏洞，通过 `/mgmt/shared/authn/login` 接口获取一个有效的 Token。然后，使用该 Token，结合 `poc_1` 类似的 RCE 方法，在目标设备上执行任意命令。这种方式更隐蔽，也可能绕过一些简单的防御机制。

**投毒风险分析：**

该代码整体结构清晰，主要是实现了漏洞的复现和利用，代码的可读性较强。经过分析，PoC代码中并没有明显的恶意投毒行为。例如，没有发现反弹shell，持续驻留，或者信息搜集等恶意代码。但是该代码存在一定的风险，如果被恶意使用者修改，可能会被植入恶意代码，例如添加反弹shell等功能。因此，判定该仓库存在10%的投毒风险。

**搜索引擎结果印证：**

*   多个来源表明该漏洞在野外被积极利用（例如，Arctic Wolf 的报告）。
*   NCC Group 指出，存在不需要 SSRF 的 PoC，说明该漏洞的利用方式多样。
*   Imperva 的文章提到攻击活动在漏洞披露后激增。

综上所述，该漏洞利用代码有效，风险极高，攻击者可通过多种方式远程控制受影响的F5设备。

**项目地址:** [S1xHcL/f5_rce_poc](https://github.com/S1xHcL/f5_rce_poc)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #5

**来源**: [CVE-2021-22986-Tas9er_CVE-2021-22986.md](../2021/CVE-2021-22986-Tas9er_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP iControl RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中存在的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
根据漏洞信息、搜索结果（特别是NCC Group的分析）和漏洞利用代码，该漏洞是有效的。搜索引擎结果显示该漏洞已被积极利用。

**投毒风险：**
提供的POC代码包括一个 `README.md` 文件，其中包含免责声明，声明该工具仅用于授权安全测试。漏洞利用代码本身似乎是一个简单的利用程序，从 `url.txt` 读取目标 URL。但是，也存在潜在的风险，比如`CVE-2021-22986.jar`包含恶意代码，但因为没有jar包文件无法判断，结合免责声明，判定存在少量投毒风险。

**利用方式：**
利用方式涉及以下步骤：
1.  准备包含目标 URL 的 `url.txt` 文件。
2.  运行 `java -jar CVE-2021-22986.jar` 命令。

该工具通过未授权访问 iControl REST 接口，然后发送包含恶意命令的请求来利用漏洞。成功利用后，攻击者可以在受影响的 BIG-IP 或 BIG-IQ 设备上执行任意命令。

**优先级排序：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

搜索引擎结果表明该漏洞已被积极利用，漏洞利用代码提供了一个简单的利用方法，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Tas9er/CVE-2021-22986](https://github.com/Tas9er/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #6

**来源**: [CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md](../2021/CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST API-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统运行受影响的F5 BIG-IP或BIG-IQ版本，且iControl REST API接口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程命令执行。根据漏洞库信息和搜索结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。漏洞利用代码（Checker.py）通过构造包含恶意命令的JSON数据，并将其以POST请求发送到`/mgmt/tm/util/bash`端点来利用此漏洞。请求头包含`Content-Type: application/json`，并且尝试使用`X-F5-Auth-Token`（尽管为空）以及一个Base64编码的`Authorization`头（`admin:ASasasM`）。

有效性分析：提供的POC代码通过发送精心构造的POST请求到目标设备的iControl REST API来执行命令。如果目标设备存在漏洞且未打补丁，则可以成功执行命令。代码通过检查响应状态码是否为200以及响应文本中是否存在"commandResult"来判断是否成功利用漏洞。

投毒风险分析：查看提供的文件列表，包含`CODEOWNERS`、`Checker.py`、`README.md`。`CODEOWNERS`只包含一个github用户，没有发现可疑之处。`README.md`仅仅是描述如何使用脚本。`Checker.py`中，请求的URL和请求方式都是根据漏洞信息构造的，用于验证漏洞是否存在，并没有发现可以投毒的地方。`Authorization`头虽然存在，但其用户名和密码应该是用于某些情况下的身份验证，不属于恶意代码或后门。所以，此仓库中不存在明显的投毒代码。因此，投毒风险评估为0%。

利用方式：攻击者构造恶意的JSON数据，其中包含要在目标系统上执行的命令。然后，通过HTTP POST请求将此数据发送到目标设备的iControl REST API的特定端点（`/mgmt/tm/util/bash`）。由于漏洞存在于身份验证绕过，因此无需提供有效的身份验证信息即可执行命令。成功利用漏洞后，攻击者可以在目标系统上执行任意命令。

**项目地址:** [ZephrFish/CVE-2021-22986_Check](https://github.com/ZephrFish/CVE-2021-22986_Check)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #7

**来源**: [CVE-2021-22986-amitlttwo_CVE-2021-22986.md](../2021/CVE-2021-22986-amitlttwo_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 需要网络访问 iControl REST 接口 (通常通过管理界面或 Self IP 地址)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的攻击者执行任意系统命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 BIG-IP 和 BIG-IQ。搜索结果表明，该漏洞在野外已被积极利用，甚至被 Mirai 僵尸网络利用。提供的漏洞利用代码 `cve-2021-22986.py` 提供验证漏洞、执行命令、批量扫描和反弹 shell 的功能。它通过向 `/mgmt/tm/util/bash` 接口发送包含命令的 POST 请求来利用漏洞。其中Authorization header的Base64字符串 `YWRtaW46QVNhc1M=` 解码后为 `admin:ASasS`。利用方式是构造包含要执行的命令的 JSON 数据，并将其发送到易受攻击的 iControl REST 端点。由于代码中使用的header值是固定的,存在被记录的风险。关于投毒风险，快速浏览代码没有发现明显的恶意代码，但无法保证代码没有隐藏的后门或恶意行为，考虑到项目协作和网络安全风险，将投毒风险评估为10%，主要来自作者的不可信和payload的风险

**项目地址:** [amitlttwo/CVE-2021-22986](https://github.com/amitlttwo/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #8

**来源**: [CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md](../2021/CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md)

# CVE-2021-22986

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-22986-Al1ex_CVE-2021-22986.md](../2021/CVE-2021-22986-Al1ex_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经验证的远程命令执行漏洞。攻击者可以发送特制的 HTTP 请求到 `/mgmt/tm/util/bash` 接口，在目标系统上执行任意命令。

**有效性:**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开可用的PoC代码。提供的PoC代码通过构造包含命令的JSON数据，发送POST请求到目标URL的`/mgmt/tm/util/bash`接口，从而执行命令。代码中包含了验证模式、攻击模式、批量检测模式和反弹shell模式，验证了其有效性。

**投毒风险:**
PoC代码本身主要功能是利用漏洞执行命令，投毒风险较低。但依旧存在一定投毒风险：
1.  **默认认证信息:** 代码中硬编码了 `Authorization: Basic YWRtaW46QVNhc1M=` 默认认证信息（admin:ASasS），若目标系统仍使用此默认密码，则漏洞利用成功概率更高，但这也可能被攻击者利用，如果攻击者修改了目标系统的配置,可能会影响正常的业务.
2.  **反弹shell风险:**  反弹shell功能如果被恶意利用，可能在受害者不知情的情况下建立连接。
3.  **脚本作者风险:**  作者 Al1ex@Heptagram 的真实意图未知，可能在未来版本中添加恶意代码. 总体投毒风险预估为10%。

**利用方式:**
1.  确定目标F5 BIG-IP/BIG-IQ设备的版本在受影响范围内。
2.  使用PoC脚本，指定目标URL，并选择验证模式或攻击模式。
3.  在攻击模式下，指定要执行的命令。反弹shell模式可用于建立反向shell连接。
4.  对于批量检测，提供包含目标URL的文件。
5.  运行PoC脚本，利用漏洞执行命令。

**项目地址:** [Al1ex/CVE-2021-22986](https://github.com/Al1ex/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #2

**来源**: [CVE-2021-22986-DDestinys_CVE-2021-22986.md](../2021/CVE-2021-22986-DDestinys_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可以访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ中iControl REST接口的一个未经身份验证的远程命令执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。该漏洞允许未经身份验证的攻击者通过向iControl REST API发送特制的请求来执行任意命令。

**有效性：**

提供的POC代码看起来是有效的。它通过构造一个包含要执行的命令的JSON payload，并将其POST到`/mgmt/tm/util/bash`端点来利用此漏洞。代码首先尝试读取一个url列表，遍历这些url，并且发送post请求，验证是否成功执行。由于`CVE-2021-22986` 是一个被广泛研究的漏洞，有很多公开可用的利用代码，此POC代码是符合漏洞描述的。

**投毒风险：**

POC代码的投毒风险较低，约为10%。 代码本身的功能看起来是正常的漏洞利用，但是存在以下潜在的风险点：

1.  代码中存在一个`proxies`变量,如果使用者不注意修改，可能会将流量转发到攻击者控制的代理服务器。
2.  使用了`requests.packages.urllib3.disable_warnings()`，虽然这通常用于避免SSL证书验证问题，但可能会隐藏其他潜在的安全问题。
3.  代码尝试读取`url.txt`文件，并执行POST请求，如果`url.txt`文件被篡改，可能会导致意外的漏洞利用。
4. 代码中包含一个硬编码的 Basic 认证头 `Authorization: Basic YWRtaW46YWRtaW4=`, 虽然在漏洞利用中不太可能被直接使用，但如果使用者不清楚其含义，可能会在其他场景中错误使用。

这些潜在的风险点使得代码存在一定的投毒风险，但总体而言，代码的主要目的是利用漏洞，而非进行恶意行为。

**利用方式：**

利用方式如下：

1.  攻击者需要找到存在漏洞的F5 BIG-IP或BIG-IQ实例。
2.  攻击者构造一个包含恶意命令的JSON payload，例如`{'command': 'run', 'utilCmdArgs': '-c id'}`，其中`id`命令可以替换为任意系统命令。
3.  攻击者使用POST请求将该payload发送到目标的`/mgmt/tm/util/bash`端点，无需身份验证。
4.  服务器执行该命令，并将结果返回给攻击者。

此外，搜索引擎结果中提到，该漏洞已被Mirai僵尸网络利用，攻击者可以使用此漏洞来感染目标系统，并将其纳入僵尸网络。

**排序优先级：**

搜索引擎结果显示该漏洞已经被广泛利用，并且存在公开的POC，因此优先级最高。漏洞利用代码验证了漏洞的可利用性，并且有助于理解利用方式。漏洞库信息提供了漏洞的官方描述和受影响的版本范围，是重要的参考信息。

**项目地址:** [DDestinys/CVE-2021-22986](https://github.com/DDestinys/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #3

**来源**: [CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md](../2021/CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md)

## CVE-2021-22986-F5 BIG-IP iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未授权远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统开启并暴露iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经身份验证的远程命令执行漏洞。漏洞存在于受影响版本的 iControl REST 接口中，允许未经身份验证的攻击者通过发送特制的 HTTP 请求执行任意系统命令。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被积极利用，并且存在公开的 PoC。虽然提供的漏洞利用代码 `/tmp/787246e6ce6e87a4ad488e0e4cce542c/README.md` 看起来只是一个扫描器或者一个占位符，但它表明已经有人在研究并分享关于这个漏洞的利用方法。

**投毒风险：**
提供的代码片段 `README.md` 文件本身不包含可执行代码，因此直接投毒的可能性较低。 但是，考虑到漏洞已经被公开，攻击者可能会创建恶意模块或脚本，伪装成漏洞利用工具，但实际上执行恶意操作。例如，某些PoC中可能包含下载恶意payload执行的操作。因为缺乏代码分析，这里假设有10%的可能性是作者隐藏了投毒代码。

**利用方式：**
1.  **未授权访问:** 攻击者无需身份验证即可访问 iControl REST 接口。
2.  **构造恶意请求:**  攻击者构造包含恶意命令的 HTTP 请求，通常利用 Server-Side Request Forgery (SSRF) 或直接命令注入绕过认证执行命令。
3.  **命令执行:**  BIG-IP/BIG-IQ 系统在收到恶意请求后，执行其中的命令，导致远程代码执行。

**总结：**
CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意代码。由于存在公开的 PoC 并且漏洞已被积极利用，受影响的用户应尽快升级到受支持的版本，或采取缓解措施。

**项目地址:** [Osyanina/westone-CVE-2021-22986-scanner](https://github.com/Osyanina/westone-CVE-2021-22986-scanner)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #4

**来源**: [CVE-2021-22986-S1xHcL_f5_rce_poc.md](../2021/CVE-2021-22986-S1xHcL_f5_rce_poc.md)

## CVE-2021-22986-F5-BIG-IP-iControl-REST-RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，可导致完全控制受影响的系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经验证的远程命令执行漏洞。攻击者无需身份验证即可通过构造恶意请求在目标系统上执行任意命令。

**利用方式：**

1.  **直接RCE (poc_1):** 利用PoC代码中的 `poc_1` 函数，通过构造包含恶意命令的 JSON 数据包，发送到目标设备的 `/mgmt/tm/util/bash` 接口。由于漏洞未授权，攻击者可以绕过身份验证，直接执行命令。

2.  **SSRF + RCE (ssrf_poc):** 利用PoC代码中的 `ssrf_poc` 函数，首先利用漏洞存在的SSRF漏洞，通过 `/mgmt/shared/authn/login` 接口获取一个有效的 Token。然后，使用该 Token，结合 `poc_1` 类似的 RCE 方法，在目标设备上执行任意命令。这种方式更隐蔽，也可能绕过一些简单的防御机制。

**投毒风险分析：**

该代码整体结构清晰，主要是实现了漏洞的复现和利用，代码的可读性较强。经过分析，PoC代码中并没有明显的恶意投毒行为。例如，没有发现反弹shell，持续驻留，或者信息搜集等恶意代码。但是该代码存在一定的风险，如果被恶意使用者修改，可能会被植入恶意代码，例如添加反弹shell等功能。因此，判定该仓库存在10%的投毒风险。

**搜索引擎结果印证：**

*   多个来源表明该漏洞在野外被积极利用（例如，Arctic Wolf 的报告）。
*   NCC Group 指出，存在不需要 SSRF 的 PoC，说明该漏洞的利用方式多样。
*   Imperva 的文章提到攻击活动在漏洞披露后激增。

综上所述，该漏洞利用代码有效，风险极高，攻击者可通过多种方式远程控制受影响的F5设备。

**项目地址:** [S1xHcL/f5_rce_poc](https://github.com/S1xHcL/f5_rce_poc)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #5

**来源**: [CVE-2021-22986-Tas9er_CVE-2021-22986.md](../2021/CVE-2021-22986-Tas9er_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP iControl RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中存在的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
根据漏洞信息、搜索结果（特别是NCC Group的分析）和漏洞利用代码，该漏洞是有效的。搜索引擎结果显示该漏洞已被积极利用。

**投毒风险：**
提供的POC代码包括一个 `README.md` 文件，其中包含免责声明，声明该工具仅用于授权安全测试。漏洞利用代码本身似乎是一个简单的利用程序，从 `url.txt` 读取目标 URL。但是，也存在潜在的风险，比如`CVE-2021-22986.jar`包含恶意代码，但因为没有jar包文件无法判断，结合免责声明，判定存在少量投毒风险。

**利用方式：**
利用方式涉及以下步骤：
1.  准备包含目标 URL 的 `url.txt` 文件。
2.  运行 `java -jar CVE-2021-22986.jar` 命令。

该工具通过未授权访问 iControl REST 接口，然后发送包含恶意命令的请求来利用漏洞。成功利用后，攻击者可以在受影响的 BIG-IP 或 BIG-IQ 设备上执行任意命令。

**优先级排序：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

搜索引擎结果表明该漏洞已被积极利用，漏洞利用代码提供了一个简单的利用方法，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Tas9er/CVE-2021-22986](https://github.com/Tas9er/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #6

**来源**: [CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md](../2021/CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST API-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统运行受影响的F5 BIG-IP或BIG-IQ版本，且iControl REST API接口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程命令执行。根据漏洞库信息和搜索结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。漏洞利用代码（Checker.py）通过构造包含恶意命令的JSON数据，并将其以POST请求发送到`/mgmt/tm/util/bash`端点来利用此漏洞。请求头包含`Content-Type: application/json`，并且尝试使用`X-F5-Auth-Token`（尽管为空）以及一个Base64编码的`Authorization`头（`admin:ASasasM`）。

有效性分析：提供的POC代码通过发送精心构造的POST请求到目标设备的iControl REST API来执行命令。如果目标设备存在漏洞且未打补丁，则可以成功执行命令。代码通过检查响应状态码是否为200以及响应文本中是否存在"commandResult"来判断是否成功利用漏洞。

投毒风险分析：查看提供的文件列表，包含`CODEOWNERS`、`Checker.py`、`README.md`。`CODEOWNERS`只包含一个github用户，没有发现可疑之处。`README.md`仅仅是描述如何使用脚本。`Checker.py`中，请求的URL和请求方式都是根据漏洞信息构造的，用于验证漏洞是否存在，并没有发现可以投毒的地方。`Authorization`头虽然存在，但其用户名和密码应该是用于某些情况下的身份验证，不属于恶意代码或后门。所以，此仓库中不存在明显的投毒代码。因此，投毒风险评估为0%。

利用方式：攻击者构造恶意的JSON数据，其中包含要在目标系统上执行的命令。然后，通过HTTP POST请求将此数据发送到目标设备的iControl REST API的特定端点（`/mgmt/tm/util/bash`）。由于漏洞存在于身份验证绕过，因此无需提供有效的身份验证信息即可执行命令。成功利用漏洞后，攻击者可以在目标系统上执行任意命令。

**项目地址:** [ZephrFish/CVE-2021-22986_Check](https://github.com/ZephrFish/CVE-2021-22986_Check)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #7

**来源**: [CVE-2021-22986-amitlttwo_CVE-2021-22986.md](../2021/CVE-2021-22986-amitlttwo_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 需要网络访问 iControl REST 接口 (通常通过管理界面或 Self IP 地址)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的攻击者执行任意系统命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 BIG-IP 和 BIG-IQ。搜索结果表明，该漏洞在野外已被积极利用，甚至被 Mirai 僵尸网络利用。提供的漏洞利用代码 `cve-2021-22986.py` 提供验证漏洞、执行命令、批量扫描和反弹 shell 的功能。它通过向 `/mgmt/tm/util/bash` 接口发送包含命令的 POST 请求来利用漏洞。其中Authorization header的Base64字符串 `YWRtaW46QVNhc1M=` 解码后为 `admin:ASasS`。利用方式是构造包含要执行的命令的 JSON 数据，并将其发送到易受攻击的 iControl REST 端点。由于代码中使用的header值是固定的,存在被记录的风险。关于投毒风险，快速浏览代码没有发现明显的恶意代码，但无法保证代码没有隐藏的后门或恶意行为，考虑到项目协作和网络安全风险，将投毒风险评估为10%，主要来自作者的不可信和payload的风险

**项目地址:** [amitlttwo/CVE-2021-22986](https://github.com/amitlttwo/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #8

**来源**: [CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md](../2021/CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md)

# CVE-2021-22986

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-22986-Al1ex_CVE-2021-22986.md](../2021/CVE-2021-22986-Al1ex_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经验证的远程命令执行漏洞。攻击者可以发送特制的 HTTP 请求到 `/mgmt/tm/util/bash` 接口，在目标系统上执行任意命令。

**有效性:**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开可用的PoC代码。提供的PoC代码通过构造包含命令的JSON数据，发送POST请求到目标URL的`/mgmt/tm/util/bash`接口，从而执行命令。代码中包含了验证模式、攻击模式、批量检测模式和反弹shell模式，验证了其有效性。

**投毒风险:**
PoC代码本身主要功能是利用漏洞执行命令，投毒风险较低。但依旧存在一定投毒风险：
1.  **默认认证信息:** 代码中硬编码了 `Authorization: Basic YWRtaW46QVNhc1M=` 默认认证信息（admin:ASasS），若目标系统仍使用此默认密码，则漏洞利用成功概率更高，但这也可能被攻击者利用，如果攻击者修改了目标系统的配置,可能会影响正常的业务.
2.  **反弹shell风险:**  反弹shell功能如果被恶意利用，可能在受害者不知情的情况下建立连接。
3.  **脚本作者风险:**  作者 Al1ex@Heptagram 的真实意图未知，可能在未来版本中添加恶意代码. 总体投毒风险预估为10%。

**利用方式:**
1.  确定目标F5 BIG-IP/BIG-IQ设备的版本在受影响范围内。
2.  使用PoC脚本，指定目标URL，并选择验证模式或攻击模式。
3.  在攻击模式下，指定要执行的命令。反弹shell模式可用于建立反向shell连接。
4.  对于批量检测，提供包含目标URL的文件。
5.  运行PoC脚本，利用漏洞执行命令。

**项目地址:** [Al1ex/CVE-2021-22986](https://github.com/Al1ex/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #2

**来源**: [CVE-2021-22986-DDestinys_CVE-2021-22986.md](../2021/CVE-2021-22986-DDestinys_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可以访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ中iControl REST接口的一个未经身份验证的远程命令执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。该漏洞允许未经身份验证的攻击者通过向iControl REST API发送特制的请求来执行任意命令。

**有效性：**

提供的POC代码看起来是有效的。它通过构造一个包含要执行的命令的JSON payload，并将其POST到`/mgmt/tm/util/bash`端点来利用此漏洞。代码首先尝试读取一个url列表，遍历这些url，并且发送post请求，验证是否成功执行。由于`CVE-2021-22986` 是一个被广泛研究的漏洞，有很多公开可用的利用代码，此POC代码是符合漏洞描述的。

**投毒风险：**

POC代码的投毒风险较低，约为10%。 代码本身的功能看起来是正常的漏洞利用，但是存在以下潜在的风险点：

1.  代码中存在一个`proxies`变量,如果使用者不注意修改，可能会将流量转发到攻击者控制的代理服务器。
2.  使用了`requests.packages.urllib3.disable_warnings()`，虽然这通常用于避免SSL证书验证问题，但可能会隐藏其他潜在的安全问题。
3.  代码尝试读取`url.txt`文件，并执行POST请求，如果`url.txt`文件被篡改，可能会导致意外的漏洞利用。
4. 代码中包含一个硬编码的 Basic 认证头 `Authorization: Basic YWRtaW46YWRtaW4=`, 虽然在漏洞利用中不太可能被直接使用，但如果使用者不清楚其含义，可能会在其他场景中错误使用。

这些潜在的风险点使得代码存在一定的投毒风险，但总体而言，代码的主要目的是利用漏洞，而非进行恶意行为。

**利用方式：**

利用方式如下：

1.  攻击者需要找到存在漏洞的F5 BIG-IP或BIG-IQ实例。
2.  攻击者构造一个包含恶意命令的JSON payload，例如`{'command': 'run', 'utilCmdArgs': '-c id'}`，其中`id`命令可以替换为任意系统命令。
3.  攻击者使用POST请求将该payload发送到目标的`/mgmt/tm/util/bash`端点，无需身份验证。
4.  服务器执行该命令，并将结果返回给攻击者。

此外，搜索引擎结果中提到，该漏洞已被Mirai僵尸网络利用，攻击者可以使用此漏洞来感染目标系统，并将其纳入僵尸网络。

**排序优先级：**

搜索引擎结果显示该漏洞已经被广泛利用，并且存在公开的POC，因此优先级最高。漏洞利用代码验证了漏洞的可利用性，并且有助于理解利用方式。漏洞库信息提供了漏洞的官方描述和受影响的版本范围，是重要的参考信息。

**项目地址:** [DDestinys/CVE-2021-22986](https://github.com/DDestinys/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #3

**来源**: [CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md](../2021/CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md)

## CVE-2021-22986-F5 BIG-IP iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未授权远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统开启并暴露iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经身份验证的远程命令执行漏洞。漏洞存在于受影响版本的 iControl REST 接口中，允许未经身份验证的攻击者通过发送特制的 HTTP 请求执行任意系统命令。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被积极利用，并且存在公开的 PoC。虽然提供的漏洞利用代码 `/tmp/787246e6ce6e87a4ad488e0e4cce542c/README.md` 看起来只是一个扫描器或者一个占位符，但它表明已经有人在研究并分享关于这个漏洞的利用方法。

**投毒风险：**
提供的代码片段 `README.md` 文件本身不包含可执行代码，因此直接投毒的可能性较低。 但是，考虑到漏洞已经被公开，攻击者可能会创建恶意模块或脚本，伪装成漏洞利用工具，但实际上执行恶意操作。例如，某些PoC中可能包含下载恶意payload执行的操作。因为缺乏代码分析，这里假设有10%的可能性是作者隐藏了投毒代码。

**利用方式：**
1.  **未授权访问:** 攻击者无需身份验证即可访问 iControl REST 接口。
2.  **构造恶意请求:**  攻击者构造包含恶意命令的 HTTP 请求，通常利用 Server-Side Request Forgery (SSRF) 或直接命令注入绕过认证执行命令。
3.  **命令执行:**  BIG-IP/BIG-IQ 系统在收到恶意请求后，执行其中的命令，导致远程代码执行。

**总结：**
CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意代码。由于存在公开的 PoC 并且漏洞已被积极利用，受影响的用户应尽快升级到受支持的版本，或采取缓解措施。

**项目地址:** [Osyanina/westone-CVE-2021-22986-scanner](https://github.com/Osyanina/westone-CVE-2021-22986-scanner)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #4

**来源**: [CVE-2021-22986-S1xHcL_f5_rce_poc.md](../2021/CVE-2021-22986-S1xHcL_f5_rce_poc.md)

## CVE-2021-22986-F5-BIG-IP-iControl-REST-RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，可导致完全控制受影响的系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经验证的远程命令执行漏洞。攻击者无需身份验证即可通过构造恶意请求在目标系统上执行任意命令。

**利用方式：**

1.  **直接RCE (poc_1):** 利用PoC代码中的 `poc_1` 函数，通过构造包含恶意命令的 JSON 数据包，发送到目标设备的 `/mgmt/tm/util/bash` 接口。由于漏洞未授权，攻击者可以绕过身份验证，直接执行命令。

2.  **SSRF + RCE (ssrf_poc):** 利用PoC代码中的 `ssrf_poc` 函数，首先利用漏洞存在的SSRF漏洞，通过 `/mgmt/shared/authn/login` 接口获取一个有效的 Token。然后，使用该 Token，结合 `poc_1` 类似的 RCE 方法，在目标设备上执行任意命令。这种方式更隐蔽，也可能绕过一些简单的防御机制。

**投毒风险分析：**

该代码整体结构清晰，主要是实现了漏洞的复现和利用，代码的可读性较强。经过分析，PoC代码中并没有明显的恶意投毒行为。例如，没有发现反弹shell，持续驻留，或者信息搜集等恶意代码。但是该代码存在一定的风险，如果被恶意使用者修改，可能会被植入恶意代码，例如添加反弹shell等功能。因此，判定该仓库存在10%的投毒风险。

**搜索引擎结果印证：**

*   多个来源表明该漏洞在野外被积极利用（例如，Arctic Wolf 的报告）。
*   NCC Group 指出，存在不需要 SSRF 的 PoC，说明该漏洞的利用方式多样。
*   Imperva 的文章提到攻击活动在漏洞披露后激增。

综上所述，该漏洞利用代码有效，风险极高，攻击者可通过多种方式远程控制受影响的F5设备。

**项目地址:** [S1xHcL/f5_rce_poc](https://github.com/S1xHcL/f5_rce_poc)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #5

**来源**: [CVE-2021-22986-Tas9er_CVE-2021-22986.md](../2021/CVE-2021-22986-Tas9er_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP iControl RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中存在的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
根据漏洞信息、搜索结果（特别是NCC Group的分析）和漏洞利用代码，该漏洞是有效的。搜索引擎结果显示该漏洞已被积极利用。

**投毒风险：**
提供的POC代码包括一个 `README.md` 文件，其中包含免责声明，声明该工具仅用于授权安全测试。漏洞利用代码本身似乎是一个简单的利用程序，从 `url.txt` 读取目标 URL。但是，也存在潜在的风险，比如`CVE-2021-22986.jar`包含恶意代码，但因为没有jar包文件无法判断，结合免责声明，判定存在少量投毒风险。

**利用方式：**
利用方式涉及以下步骤：
1.  准备包含目标 URL 的 `url.txt` 文件。
2.  运行 `java -jar CVE-2021-22986.jar` 命令。

该工具通过未授权访问 iControl REST 接口，然后发送包含恶意命令的请求来利用漏洞。成功利用后，攻击者可以在受影响的 BIG-IP 或 BIG-IQ 设备上执行任意命令。

**优先级排序：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

搜索引擎结果表明该漏洞已被积极利用，漏洞利用代码提供了一个简单的利用方法，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Tas9er/CVE-2021-22986](https://github.com/Tas9er/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #6

**来源**: [CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md](../2021/CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST API-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统运行受影响的F5 BIG-IP或BIG-IQ版本，且iControl REST API接口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程命令执行。根据漏洞库信息和搜索结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。漏洞利用代码（Checker.py）通过构造包含恶意命令的JSON数据，并将其以POST请求发送到`/mgmt/tm/util/bash`端点来利用此漏洞。请求头包含`Content-Type: application/json`，并且尝试使用`X-F5-Auth-Token`（尽管为空）以及一个Base64编码的`Authorization`头（`admin:ASasasM`）。

有效性分析：提供的POC代码通过发送精心构造的POST请求到目标设备的iControl REST API来执行命令。如果目标设备存在漏洞且未打补丁，则可以成功执行命令。代码通过检查响应状态码是否为200以及响应文本中是否存在"commandResult"来判断是否成功利用漏洞。

投毒风险分析：查看提供的文件列表，包含`CODEOWNERS`、`Checker.py`、`README.md`。`CODEOWNERS`只包含一个github用户，没有发现可疑之处。`README.md`仅仅是描述如何使用脚本。`Checker.py`中，请求的URL和请求方式都是根据漏洞信息构造的，用于验证漏洞是否存在，并没有发现可以投毒的地方。`Authorization`头虽然存在，但其用户名和密码应该是用于某些情况下的身份验证，不属于恶意代码或后门。所以，此仓库中不存在明显的投毒代码。因此，投毒风险评估为0%。

利用方式：攻击者构造恶意的JSON数据，其中包含要在目标系统上执行的命令。然后，通过HTTP POST请求将此数据发送到目标设备的iControl REST API的特定端点（`/mgmt/tm/util/bash`）。由于漏洞存在于身份验证绕过，因此无需提供有效的身份验证信息即可执行命令。成功利用漏洞后，攻击者可以在目标系统上执行任意命令。

**项目地址:** [ZephrFish/CVE-2021-22986_Check](https://github.com/ZephrFish/CVE-2021-22986_Check)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #7

**来源**: [CVE-2021-22986-amitlttwo_CVE-2021-22986.md](../2021/CVE-2021-22986-amitlttwo_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 需要网络访问 iControl REST 接口 (通常通过管理界面或 Self IP 地址)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的攻击者执行任意系统命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 BIG-IP 和 BIG-IQ。搜索结果表明，该漏洞在野外已被积极利用，甚至被 Mirai 僵尸网络利用。提供的漏洞利用代码 `cve-2021-22986.py` 提供验证漏洞、执行命令、批量扫描和反弹 shell 的功能。它通过向 `/mgmt/tm/util/bash` 接口发送包含命令的 POST 请求来利用漏洞。其中Authorization header的Base64字符串 `YWRtaW46QVNhc1M=` 解码后为 `admin:ASasS`。利用方式是构造包含要执行的命令的 JSON 数据，并将其发送到易受攻击的 iControl REST 端点。由于代码中使用的header值是固定的,存在被记录的风险。关于投毒风险，快速浏览代码没有发现明显的恶意代码，但无法保证代码没有隐藏的后门或恶意行为，考虑到项目协作和网络安全风险，将投毒风险评估为10%，主要来自作者的不可信和payload的风险

**项目地址:** [amitlttwo/CVE-2021-22986](https://github.com/amitlttwo/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #8

**来源**: [CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md](../2021/CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md)

# CVE-2021-22986

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-22986-Al1ex_CVE-2021-22986.md](../2021/CVE-2021-22986-Al1ex_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经验证的远程命令执行漏洞。攻击者可以发送特制的 HTTP 请求到 `/mgmt/tm/util/bash` 接口，在目标系统上执行任意命令。

**有效性:**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开可用的PoC代码。提供的PoC代码通过构造包含命令的JSON数据，发送POST请求到目标URL的`/mgmt/tm/util/bash`接口，从而执行命令。代码中包含了验证模式、攻击模式、批量检测模式和反弹shell模式，验证了其有效性。

**投毒风险:**
PoC代码本身主要功能是利用漏洞执行命令，投毒风险较低。但依旧存在一定投毒风险：
1.  **默认认证信息:** 代码中硬编码了 `Authorization: Basic YWRtaW46QVNhc1M=` 默认认证信息（admin:ASasS），若目标系统仍使用此默认密码，则漏洞利用成功概率更高，但这也可能被攻击者利用，如果攻击者修改了目标系统的配置,可能会影响正常的业务.
2.  **反弹shell风险:**  反弹shell功能如果被恶意利用，可能在受害者不知情的情况下建立连接。
3.  **脚本作者风险:**  作者 Al1ex@Heptagram 的真实意图未知，可能在未来版本中添加恶意代码. 总体投毒风险预估为10%。

**利用方式:**
1.  确定目标F5 BIG-IP/BIG-IQ设备的版本在受影响范围内。
2.  使用PoC脚本，指定目标URL，并选择验证模式或攻击模式。
3.  在攻击模式下，指定要执行的命令。反弹shell模式可用于建立反向shell连接。
4.  对于批量检测，提供包含目标URL的文件。
5.  运行PoC脚本，利用漏洞执行命令。

**项目地址:** [Al1ex/CVE-2021-22986](https://github.com/Al1ex/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #2

**来源**: [CVE-2021-22986-DDestinys_CVE-2021-22986.md](../2021/CVE-2021-22986-DDestinys_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可以访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ中iControl REST接口的一个未经身份验证的远程命令执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。该漏洞允许未经身份验证的攻击者通过向iControl REST API发送特制的请求来执行任意命令。

**有效性：**

提供的POC代码看起来是有效的。它通过构造一个包含要执行的命令的JSON payload，并将其POST到`/mgmt/tm/util/bash`端点来利用此漏洞。代码首先尝试读取一个url列表，遍历这些url，并且发送post请求，验证是否成功执行。由于`CVE-2021-22986` 是一个被广泛研究的漏洞，有很多公开可用的利用代码，此POC代码是符合漏洞描述的。

**投毒风险：**

POC代码的投毒风险较低，约为10%。 代码本身的功能看起来是正常的漏洞利用，但是存在以下潜在的风险点：

1.  代码中存在一个`proxies`变量,如果使用者不注意修改，可能会将流量转发到攻击者控制的代理服务器。
2.  使用了`requests.packages.urllib3.disable_warnings()`，虽然这通常用于避免SSL证书验证问题，但可能会隐藏其他潜在的安全问题。
3.  代码尝试读取`url.txt`文件，并执行POST请求，如果`url.txt`文件被篡改，可能会导致意外的漏洞利用。
4. 代码中包含一个硬编码的 Basic 认证头 `Authorization: Basic YWRtaW46YWRtaW4=`, 虽然在漏洞利用中不太可能被直接使用，但如果使用者不清楚其含义，可能会在其他场景中错误使用。

这些潜在的风险点使得代码存在一定的投毒风险，但总体而言，代码的主要目的是利用漏洞，而非进行恶意行为。

**利用方式：**

利用方式如下：

1.  攻击者需要找到存在漏洞的F5 BIG-IP或BIG-IQ实例。
2.  攻击者构造一个包含恶意命令的JSON payload，例如`{'command': 'run', 'utilCmdArgs': '-c id'}`，其中`id`命令可以替换为任意系统命令。
3.  攻击者使用POST请求将该payload发送到目标的`/mgmt/tm/util/bash`端点，无需身份验证。
4.  服务器执行该命令，并将结果返回给攻击者。

此外，搜索引擎结果中提到，该漏洞已被Mirai僵尸网络利用，攻击者可以使用此漏洞来感染目标系统，并将其纳入僵尸网络。

**排序优先级：**

搜索引擎结果显示该漏洞已经被广泛利用，并且存在公开的POC，因此优先级最高。漏洞利用代码验证了漏洞的可利用性，并且有助于理解利用方式。漏洞库信息提供了漏洞的官方描述和受影响的版本范围，是重要的参考信息。

**项目地址:** [DDestinys/CVE-2021-22986](https://github.com/DDestinys/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #3

**来源**: [CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md](../2021/CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md)

## CVE-2021-22986-F5 BIG-IP iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未授权远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统开启并暴露iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经身份验证的远程命令执行漏洞。漏洞存在于受影响版本的 iControl REST 接口中，允许未经身份验证的攻击者通过发送特制的 HTTP 请求执行任意系统命令。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被积极利用，并且存在公开的 PoC。虽然提供的漏洞利用代码 `/tmp/787246e6ce6e87a4ad488e0e4cce542c/README.md` 看起来只是一个扫描器或者一个占位符，但它表明已经有人在研究并分享关于这个漏洞的利用方法。

**投毒风险：**
提供的代码片段 `README.md` 文件本身不包含可执行代码，因此直接投毒的可能性较低。 但是，考虑到漏洞已经被公开，攻击者可能会创建恶意模块或脚本，伪装成漏洞利用工具，但实际上执行恶意操作。例如，某些PoC中可能包含下载恶意payload执行的操作。因为缺乏代码分析，这里假设有10%的可能性是作者隐藏了投毒代码。

**利用方式：**
1.  **未授权访问:** 攻击者无需身份验证即可访问 iControl REST 接口。
2.  **构造恶意请求:**  攻击者构造包含恶意命令的 HTTP 请求，通常利用 Server-Side Request Forgery (SSRF) 或直接命令注入绕过认证执行命令。
3.  **命令执行:**  BIG-IP/BIG-IQ 系统在收到恶意请求后，执行其中的命令，导致远程代码执行。

**总结：**
CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意代码。由于存在公开的 PoC 并且漏洞已被积极利用，受影响的用户应尽快升级到受支持的版本，或采取缓解措施。

**项目地址:** [Osyanina/westone-CVE-2021-22986-scanner](https://github.com/Osyanina/westone-CVE-2021-22986-scanner)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #4

**来源**: [CVE-2021-22986-S1xHcL_f5_rce_poc.md](../2021/CVE-2021-22986-S1xHcL_f5_rce_poc.md)

## CVE-2021-22986-F5-BIG-IP-iControl-REST-RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，可导致完全控制受影响的系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经验证的远程命令执行漏洞。攻击者无需身份验证即可通过构造恶意请求在目标系统上执行任意命令。

**利用方式：**

1.  **直接RCE (poc_1):** 利用PoC代码中的 `poc_1` 函数，通过构造包含恶意命令的 JSON 数据包，发送到目标设备的 `/mgmt/tm/util/bash` 接口。由于漏洞未授权，攻击者可以绕过身份验证，直接执行命令。

2.  **SSRF + RCE (ssrf_poc):** 利用PoC代码中的 `ssrf_poc` 函数，首先利用漏洞存在的SSRF漏洞，通过 `/mgmt/shared/authn/login` 接口获取一个有效的 Token。然后，使用该 Token，结合 `poc_1` 类似的 RCE 方法，在目标设备上执行任意命令。这种方式更隐蔽，也可能绕过一些简单的防御机制。

**投毒风险分析：**

该代码整体结构清晰，主要是实现了漏洞的复现和利用，代码的可读性较强。经过分析，PoC代码中并没有明显的恶意投毒行为。例如，没有发现反弹shell，持续驻留，或者信息搜集等恶意代码。但是该代码存在一定的风险，如果被恶意使用者修改，可能会被植入恶意代码，例如添加反弹shell等功能。因此，判定该仓库存在10%的投毒风险。

**搜索引擎结果印证：**

*   多个来源表明该漏洞在野外被积极利用（例如，Arctic Wolf 的报告）。
*   NCC Group 指出，存在不需要 SSRF 的 PoC，说明该漏洞的利用方式多样。
*   Imperva 的文章提到攻击活动在漏洞披露后激增。

综上所述，该漏洞利用代码有效，风险极高，攻击者可通过多种方式远程控制受影响的F5设备。

**项目地址:** [S1xHcL/f5_rce_poc](https://github.com/S1xHcL/f5_rce_poc)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #5

**来源**: [CVE-2021-22986-Tas9er_CVE-2021-22986.md](../2021/CVE-2021-22986-Tas9er_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP iControl RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中存在的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
根据漏洞信息、搜索结果（特别是NCC Group的分析）和漏洞利用代码，该漏洞是有效的。搜索引擎结果显示该漏洞已被积极利用。

**投毒风险：**
提供的POC代码包括一个 `README.md` 文件，其中包含免责声明，声明该工具仅用于授权安全测试。漏洞利用代码本身似乎是一个简单的利用程序，从 `url.txt` 读取目标 URL。但是，也存在潜在的风险，比如`CVE-2021-22986.jar`包含恶意代码，但因为没有jar包文件无法判断，结合免责声明，判定存在少量投毒风险。

**利用方式：**
利用方式涉及以下步骤：
1.  准备包含目标 URL 的 `url.txt` 文件。
2.  运行 `java -jar CVE-2021-22986.jar` 命令。

该工具通过未授权访问 iControl REST 接口，然后发送包含恶意命令的请求来利用漏洞。成功利用后，攻击者可以在受影响的 BIG-IP 或 BIG-IQ 设备上执行任意命令。

**优先级排序：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

搜索引擎结果表明该漏洞已被积极利用，漏洞利用代码提供了一个简单的利用方法，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Tas9er/CVE-2021-22986](https://github.com/Tas9er/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #6

**来源**: [CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md](../2021/CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST API-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统运行受影响的F5 BIG-IP或BIG-IQ版本，且iControl REST API接口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程命令执行。根据漏洞库信息和搜索结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。漏洞利用代码（Checker.py）通过构造包含恶意命令的JSON数据，并将其以POST请求发送到`/mgmt/tm/util/bash`端点来利用此漏洞。请求头包含`Content-Type: application/json`，并且尝试使用`X-F5-Auth-Token`（尽管为空）以及一个Base64编码的`Authorization`头（`admin:ASasasM`）。

有效性分析：提供的POC代码通过发送精心构造的POST请求到目标设备的iControl REST API来执行命令。如果目标设备存在漏洞且未打补丁，则可以成功执行命令。代码通过检查响应状态码是否为200以及响应文本中是否存在"commandResult"来判断是否成功利用漏洞。

投毒风险分析：查看提供的文件列表，包含`CODEOWNERS`、`Checker.py`、`README.md`。`CODEOWNERS`只包含一个github用户，没有发现可疑之处。`README.md`仅仅是描述如何使用脚本。`Checker.py`中，请求的URL和请求方式都是根据漏洞信息构造的，用于验证漏洞是否存在，并没有发现可以投毒的地方。`Authorization`头虽然存在，但其用户名和密码应该是用于某些情况下的身份验证，不属于恶意代码或后门。所以，此仓库中不存在明显的投毒代码。因此，投毒风险评估为0%。

利用方式：攻击者构造恶意的JSON数据，其中包含要在目标系统上执行的命令。然后，通过HTTP POST请求将此数据发送到目标设备的iControl REST API的特定端点（`/mgmt/tm/util/bash`）。由于漏洞存在于身份验证绕过，因此无需提供有效的身份验证信息即可执行命令。成功利用漏洞后，攻击者可以在目标系统上执行任意命令。

**项目地址:** [ZephrFish/CVE-2021-22986_Check](https://github.com/ZephrFish/CVE-2021-22986_Check)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #7

**来源**: [CVE-2021-22986-amitlttwo_CVE-2021-22986.md](../2021/CVE-2021-22986-amitlttwo_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 需要网络访问 iControl REST 接口 (通常通过管理界面或 Self IP 地址)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的攻击者执行任意系统命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 BIG-IP 和 BIG-IQ。搜索结果表明，该漏洞在野外已被积极利用，甚至被 Mirai 僵尸网络利用。提供的漏洞利用代码 `cve-2021-22986.py` 提供验证漏洞、执行命令、批量扫描和反弹 shell 的功能。它通过向 `/mgmt/tm/util/bash` 接口发送包含命令的 POST 请求来利用漏洞。其中Authorization header的Base64字符串 `YWRtaW46QVNhc1M=` 解码后为 `admin:ASasS`。利用方式是构造包含要执行的命令的 JSON 数据，并将其发送到易受攻击的 iControl REST 端点。由于代码中使用的header值是固定的,存在被记录的风险。关于投毒风险，快速浏览代码没有发现明显的恶意代码，但无法保证代码没有隐藏的后门或恶意行为，考虑到项目协作和网络安全风险，将投毒风险评估为10%，主要来自作者的不可信和payload的风险

**项目地址:** [amitlttwo/CVE-2021-22986](https://github.com/amitlttwo/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #8

**来源**: [CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md](../2021/CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md)

# CVE-2021-22986

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-22986-Al1ex_CVE-2021-22986.md](../2021/CVE-2021-22986-Al1ex_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经验证的远程命令执行漏洞。攻击者可以发送特制的 HTTP 请求到 `/mgmt/tm/util/bash` 接口，在目标系统上执行任意命令。

**有效性:**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开可用的PoC代码。提供的PoC代码通过构造包含命令的JSON数据，发送POST请求到目标URL的`/mgmt/tm/util/bash`接口，从而执行命令。代码中包含了验证模式、攻击模式、批量检测模式和反弹shell模式，验证了其有效性。

**投毒风险:**
PoC代码本身主要功能是利用漏洞执行命令，投毒风险较低。但依旧存在一定投毒风险：
1.  **默认认证信息:** 代码中硬编码了 `Authorization: Basic YWRtaW46QVNhc1M=` 默认认证信息（admin:ASasS），若目标系统仍使用此默认密码，则漏洞利用成功概率更高，但这也可能被攻击者利用，如果攻击者修改了目标系统的配置,可能会影响正常的业务.
2.  **反弹shell风险:**  反弹shell功能如果被恶意利用，可能在受害者不知情的情况下建立连接。
3.  **脚本作者风险:**  作者 Al1ex@Heptagram 的真实意图未知，可能在未来版本中添加恶意代码. 总体投毒风险预估为10%。

**利用方式:**
1.  确定目标F5 BIG-IP/BIG-IQ设备的版本在受影响范围内。
2.  使用PoC脚本，指定目标URL，并选择验证模式或攻击模式。
3.  在攻击模式下，指定要执行的命令。反弹shell模式可用于建立反向shell连接。
4.  对于批量检测，提供包含目标URL的文件。
5.  运行PoC脚本，利用漏洞执行命令。

**项目地址:** [Al1ex/CVE-2021-22986](https://github.com/Al1ex/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #2

**来源**: [CVE-2021-22986-DDestinys_CVE-2021-22986.md](../2021/CVE-2021-22986-DDestinys_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可以访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ中iControl REST接口的一个未经身份验证的远程命令执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。该漏洞允许未经身份验证的攻击者通过向iControl REST API发送特制的请求来执行任意命令。

**有效性：**

提供的POC代码看起来是有效的。它通过构造一个包含要执行的命令的JSON payload，并将其POST到`/mgmt/tm/util/bash`端点来利用此漏洞。代码首先尝试读取一个url列表，遍历这些url，并且发送post请求，验证是否成功执行。由于`CVE-2021-22986` 是一个被广泛研究的漏洞，有很多公开可用的利用代码，此POC代码是符合漏洞描述的。

**投毒风险：**

POC代码的投毒风险较低，约为10%。 代码本身的功能看起来是正常的漏洞利用，但是存在以下潜在的风险点：

1.  代码中存在一个`proxies`变量,如果使用者不注意修改，可能会将流量转发到攻击者控制的代理服务器。
2.  使用了`requests.packages.urllib3.disable_warnings()`，虽然这通常用于避免SSL证书验证问题，但可能会隐藏其他潜在的安全问题。
3.  代码尝试读取`url.txt`文件，并执行POST请求，如果`url.txt`文件被篡改，可能会导致意外的漏洞利用。
4. 代码中包含一个硬编码的 Basic 认证头 `Authorization: Basic YWRtaW46YWRtaW4=`, 虽然在漏洞利用中不太可能被直接使用，但如果使用者不清楚其含义，可能会在其他场景中错误使用。

这些潜在的风险点使得代码存在一定的投毒风险，但总体而言，代码的主要目的是利用漏洞，而非进行恶意行为。

**利用方式：**

利用方式如下：

1.  攻击者需要找到存在漏洞的F5 BIG-IP或BIG-IQ实例。
2.  攻击者构造一个包含恶意命令的JSON payload，例如`{'command': 'run', 'utilCmdArgs': '-c id'}`，其中`id`命令可以替换为任意系统命令。
3.  攻击者使用POST请求将该payload发送到目标的`/mgmt/tm/util/bash`端点，无需身份验证。
4.  服务器执行该命令，并将结果返回给攻击者。

此外，搜索引擎结果中提到，该漏洞已被Mirai僵尸网络利用，攻击者可以使用此漏洞来感染目标系统，并将其纳入僵尸网络。

**排序优先级：**

搜索引擎结果显示该漏洞已经被广泛利用，并且存在公开的POC，因此优先级最高。漏洞利用代码验证了漏洞的可利用性，并且有助于理解利用方式。漏洞库信息提供了漏洞的官方描述和受影响的版本范围，是重要的参考信息。

**项目地址:** [DDestinys/CVE-2021-22986](https://github.com/DDestinys/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #3

**来源**: [CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md](../2021/CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md)

## CVE-2021-22986-F5 BIG-IP iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未授权远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统开启并暴露iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经身份验证的远程命令执行漏洞。漏洞存在于受影响版本的 iControl REST 接口中，允许未经身份验证的攻击者通过发送特制的 HTTP 请求执行任意系统命令。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被积极利用，并且存在公开的 PoC。虽然提供的漏洞利用代码 `/tmp/787246e6ce6e87a4ad488e0e4cce542c/README.md` 看起来只是一个扫描器或者一个占位符，但它表明已经有人在研究并分享关于这个漏洞的利用方法。

**投毒风险：**
提供的代码片段 `README.md` 文件本身不包含可执行代码，因此直接投毒的可能性较低。 但是，考虑到漏洞已经被公开，攻击者可能会创建恶意模块或脚本，伪装成漏洞利用工具，但实际上执行恶意操作。例如，某些PoC中可能包含下载恶意payload执行的操作。因为缺乏代码分析，这里假设有10%的可能性是作者隐藏了投毒代码。

**利用方式：**
1.  **未授权访问:** 攻击者无需身份验证即可访问 iControl REST 接口。
2.  **构造恶意请求:**  攻击者构造包含恶意命令的 HTTP 请求，通常利用 Server-Side Request Forgery (SSRF) 或直接命令注入绕过认证执行命令。
3.  **命令执行:**  BIG-IP/BIG-IQ 系统在收到恶意请求后，执行其中的命令，导致远程代码执行。

**总结：**
CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意代码。由于存在公开的 PoC 并且漏洞已被积极利用，受影响的用户应尽快升级到受支持的版本，或采取缓解措施。

**项目地址:** [Osyanina/westone-CVE-2021-22986-scanner](https://github.com/Osyanina/westone-CVE-2021-22986-scanner)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #4

**来源**: [CVE-2021-22986-S1xHcL_f5_rce_poc.md](../2021/CVE-2021-22986-S1xHcL_f5_rce_poc.md)

## CVE-2021-22986-F5-BIG-IP-iControl-REST-RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，可导致完全控制受影响的系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经验证的远程命令执行漏洞。攻击者无需身份验证即可通过构造恶意请求在目标系统上执行任意命令。

**利用方式：**

1.  **直接RCE (poc_1):** 利用PoC代码中的 `poc_1` 函数，通过构造包含恶意命令的 JSON 数据包，发送到目标设备的 `/mgmt/tm/util/bash` 接口。由于漏洞未授权，攻击者可以绕过身份验证，直接执行命令。

2.  **SSRF + RCE (ssrf_poc):** 利用PoC代码中的 `ssrf_poc` 函数，首先利用漏洞存在的SSRF漏洞，通过 `/mgmt/shared/authn/login` 接口获取一个有效的 Token。然后，使用该 Token，结合 `poc_1` 类似的 RCE 方法，在目标设备上执行任意命令。这种方式更隐蔽，也可能绕过一些简单的防御机制。

**投毒风险分析：**

该代码整体结构清晰，主要是实现了漏洞的复现和利用，代码的可读性较强。经过分析，PoC代码中并没有明显的恶意投毒行为。例如，没有发现反弹shell，持续驻留，或者信息搜集等恶意代码。但是该代码存在一定的风险，如果被恶意使用者修改，可能会被植入恶意代码，例如添加反弹shell等功能。因此，判定该仓库存在10%的投毒风险。

**搜索引擎结果印证：**

*   多个来源表明该漏洞在野外被积极利用（例如，Arctic Wolf 的报告）。
*   NCC Group 指出，存在不需要 SSRF 的 PoC，说明该漏洞的利用方式多样。
*   Imperva 的文章提到攻击活动在漏洞披露后激增。

综上所述，该漏洞利用代码有效，风险极高，攻击者可通过多种方式远程控制受影响的F5设备。

**项目地址:** [S1xHcL/f5_rce_poc](https://github.com/S1xHcL/f5_rce_poc)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #5

**来源**: [CVE-2021-22986-Tas9er_CVE-2021-22986.md](../2021/CVE-2021-22986-Tas9er_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP iControl RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中存在的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
根据漏洞信息、搜索结果（特别是NCC Group的分析）和漏洞利用代码，该漏洞是有效的。搜索引擎结果显示该漏洞已被积极利用。

**投毒风险：**
提供的POC代码包括一个 `README.md` 文件，其中包含免责声明，声明该工具仅用于授权安全测试。漏洞利用代码本身似乎是一个简单的利用程序，从 `url.txt` 读取目标 URL。但是，也存在潜在的风险，比如`CVE-2021-22986.jar`包含恶意代码，但因为没有jar包文件无法判断，结合免责声明，判定存在少量投毒风险。

**利用方式：**
利用方式涉及以下步骤：
1.  准备包含目标 URL 的 `url.txt` 文件。
2.  运行 `java -jar CVE-2021-22986.jar` 命令。

该工具通过未授权访问 iControl REST 接口，然后发送包含恶意命令的请求来利用漏洞。成功利用后，攻击者可以在受影响的 BIG-IP 或 BIG-IQ 设备上执行任意命令。

**优先级排序：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

搜索引擎结果表明该漏洞已被积极利用，漏洞利用代码提供了一个简单的利用方法，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Tas9er/CVE-2021-22986](https://github.com/Tas9er/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #6

**来源**: [CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md](../2021/CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST API-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统运行受影响的F5 BIG-IP或BIG-IQ版本，且iControl REST API接口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程命令执行。根据漏洞库信息和搜索结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。漏洞利用代码（Checker.py）通过构造包含恶意命令的JSON数据，并将其以POST请求发送到`/mgmt/tm/util/bash`端点来利用此漏洞。请求头包含`Content-Type: application/json`，并且尝试使用`X-F5-Auth-Token`（尽管为空）以及一个Base64编码的`Authorization`头（`admin:ASasasM`）。

有效性分析：提供的POC代码通过发送精心构造的POST请求到目标设备的iControl REST API来执行命令。如果目标设备存在漏洞且未打补丁，则可以成功执行命令。代码通过检查响应状态码是否为200以及响应文本中是否存在"commandResult"来判断是否成功利用漏洞。

投毒风险分析：查看提供的文件列表，包含`CODEOWNERS`、`Checker.py`、`README.md`。`CODEOWNERS`只包含一个github用户，没有发现可疑之处。`README.md`仅仅是描述如何使用脚本。`Checker.py`中，请求的URL和请求方式都是根据漏洞信息构造的，用于验证漏洞是否存在，并没有发现可以投毒的地方。`Authorization`头虽然存在，但其用户名和密码应该是用于某些情况下的身份验证，不属于恶意代码或后门。所以，此仓库中不存在明显的投毒代码。因此，投毒风险评估为0%。

利用方式：攻击者构造恶意的JSON数据，其中包含要在目标系统上执行的命令。然后，通过HTTP POST请求将此数据发送到目标设备的iControl REST API的特定端点（`/mgmt/tm/util/bash`）。由于漏洞存在于身份验证绕过，因此无需提供有效的身份验证信息即可执行命令。成功利用漏洞后，攻击者可以在目标系统上执行任意命令。

**项目地址:** [ZephrFish/CVE-2021-22986_Check](https://github.com/ZephrFish/CVE-2021-22986_Check)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #7

**来源**: [CVE-2021-22986-amitlttwo_CVE-2021-22986.md](../2021/CVE-2021-22986-amitlttwo_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 需要网络访问 iControl REST 接口 (通常通过管理界面或 Self IP 地址)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的攻击者执行任意系统命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 BIG-IP 和 BIG-IQ。搜索结果表明，该漏洞在野外已被积极利用，甚至被 Mirai 僵尸网络利用。提供的漏洞利用代码 `cve-2021-22986.py` 提供验证漏洞、执行命令、批量扫描和反弹 shell 的功能。它通过向 `/mgmt/tm/util/bash` 接口发送包含命令的 POST 请求来利用漏洞。其中Authorization header的Base64字符串 `YWRtaW46QVNhc1M=` 解码后为 `admin:ASasS`。利用方式是构造包含要执行的命令的 JSON 数据，并将其发送到易受攻击的 iControl REST 端点。由于代码中使用的header值是固定的,存在被记录的风险。关于投毒风险，快速浏览代码没有发现明显的恶意代码，但无法保证代码没有隐藏的后门或恶意行为，考虑到项目协作和网络安全风险，将投毒风险评估为10%，主要来自作者的不可信和payload的风险

**项目地址:** [amitlttwo/CVE-2021-22986](https://github.com/amitlttwo/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #8

**来源**: [CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md](../2021/CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md)

# CVE-2021-22986

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-22986-Al1ex_CVE-2021-22986.md](../2021/CVE-2021-22986-Al1ex_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经验证的远程命令执行漏洞。攻击者可以发送特制的 HTTP 请求到 `/mgmt/tm/util/bash` 接口，在目标系统上执行任意命令。

**有效性:**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开可用的PoC代码。提供的PoC代码通过构造包含命令的JSON数据，发送POST请求到目标URL的`/mgmt/tm/util/bash`接口，从而执行命令。代码中包含了验证模式、攻击模式、批量检测模式和反弹shell模式，验证了其有效性。

**投毒风险:**
PoC代码本身主要功能是利用漏洞执行命令，投毒风险较低。但依旧存在一定投毒风险：
1.  **默认认证信息:** 代码中硬编码了 `Authorization: Basic YWRtaW46QVNhc1M=` 默认认证信息（admin:ASasS），若目标系统仍使用此默认密码，则漏洞利用成功概率更高，但这也可能被攻击者利用，如果攻击者修改了目标系统的配置,可能会影响正常的业务.
2.  **反弹shell风险:**  反弹shell功能如果被恶意利用，可能在受害者不知情的情况下建立连接。
3.  **脚本作者风险:**  作者 Al1ex@Heptagram 的真实意图未知，可能在未来版本中添加恶意代码. 总体投毒风险预估为10%。

**利用方式:**
1.  确定目标F5 BIG-IP/BIG-IQ设备的版本在受影响范围内。
2.  使用PoC脚本，指定目标URL，并选择验证模式或攻击模式。
3.  在攻击模式下，指定要执行的命令。反弹shell模式可用于建立反向shell连接。
4.  对于批量检测，提供包含目标URL的文件。
5.  运行PoC脚本，利用漏洞执行命令。

**项目地址:** [Al1ex/CVE-2021-22986](https://github.com/Al1ex/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #2

**来源**: [CVE-2021-22986-DDestinys_CVE-2021-22986.md](../2021/CVE-2021-22986-DDestinys_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可以访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ中iControl REST接口的一个未经身份验证的远程命令执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。该漏洞允许未经身份验证的攻击者通过向iControl REST API发送特制的请求来执行任意命令。

**有效性：**

提供的POC代码看起来是有效的。它通过构造一个包含要执行的命令的JSON payload，并将其POST到`/mgmt/tm/util/bash`端点来利用此漏洞。代码首先尝试读取一个url列表，遍历这些url，并且发送post请求，验证是否成功执行。由于`CVE-2021-22986` 是一个被广泛研究的漏洞，有很多公开可用的利用代码，此POC代码是符合漏洞描述的。

**投毒风险：**

POC代码的投毒风险较低，约为10%。 代码本身的功能看起来是正常的漏洞利用，但是存在以下潜在的风险点：

1.  代码中存在一个`proxies`变量,如果使用者不注意修改，可能会将流量转发到攻击者控制的代理服务器。
2.  使用了`requests.packages.urllib3.disable_warnings()`，虽然这通常用于避免SSL证书验证问题，但可能会隐藏其他潜在的安全问题。
3.  代码尝试读取`url.txt`文件，并执行POST请求，如果`url.txt`文件被篡改，可能会导致意外的漏洞利用。
4. 代码中包含一个硬编码的 Basic 认证头 `Authorization: Basic YWRtaW46YWRtaW4=`, 虽然在漏洞利用中不太可能被直接使用，但如果使用者不清楚其含义，可能会在其他场景中错误使用。

这些潜在的风险点使得代码存在一定的投毒风险，但总体而言，代码的主要目的是利用漏洞，而非进行恶意行为。

**利用方式：**

利用方式如下：

1.  攻击者需要找到存在漏洞的F5 BIG-IP或BIG-IQ实例。
2.  攻击者构造一个包含恶意命令的JSON payload，例如`{'command': 'run', 'utilCmdArgs': '-c id'}`，其中`id`命令可以替换为任意系统命令。
3.  攻击者使用POST请求将该payload发送到目标的`/mgmt/tm/util/bash`端点，无需身份验证。
4.  服务器执行该命令，并将结果返回给攻击者。

此外，搜索引擎结果中提到，该漏洞已被Mirai僵尸网络利用，攻击者可以使用此漏洞来感染目标系统，并将其纳入僵尸网络。

**排序优先级：**

搜索引擎结果显示该漏洞已经被广泛利用，并且存在公开的POC，因此优先级最高。漏洞利用代码验证了漏洞的可利用性，并且有助于理解利用方式。漏洞库信息提供了漏洞的官方描述和受影响的版本范围，是重要的参考信息。

**项目地址:** [DDestinys/CVE-2021-22986](https://github.com/DDestinys/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #3

**来源**: [CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md](../2021/CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md)

## CVE-2021-22986-F5 BIG-IP iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未授权远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统开启并暴露iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经身份验证的远程命令执行漏洞。漏洞存在于受影响版本的 iControl REST 接口中，允许未经身份验证的攻击者通过发送特制的 HTTP 请求执行任意系统命令。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被积极利用，并且存在公开的 PoC。虽然提供的漏洞利用代码 `/tmp/787246e6ce6e87a4ad488e0e4cce542c/README.md` 看起来只是一个扫描器或者一个占位符，但它表明已经有人在研究并分享关于这个漏洞的利用方法。

**投毒风险：**
提供的代码片段 `README.md` 文件本身不包含可执行代码，因此直接投毒的可能性较低。 但是，考虑到漏洞已经被公开，攻击者可能会创建恶意模块或脚本，伪装成漏洞利用工具，但实际上执行恶意操作。例如，某些PoC中可能包含下载恶意payload执行的操作。因为缺乏代码分析，这里假设有10%的可能性是作者隐藏了投毒代码。

**利用方式：**
1.  **未授权访问:** 攻击者无需身份验证即可访问 iControl REST 接口。
2.  **构造恶意请求:**  攻击者构造包含恶意命令的 HTTP 请求，通常利用 Server-Side Request Forgery (SSRF) 或直接命令注入绕过认证执行命令。
3.  **命令执行:**  BIG-IP/BIG-IQ 系统在收到恶意请求后，执行其中的命令，导致远程代码执行。

**总结：**
CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意代码。由于存在公开的 PoC 并且漏洞已被积极利用，受影响的用户应尽快升级到受支持的版本，或采取缓解措施。

**项目地址:** [Osyanina/westone-CVE-2021-22986-scanner](https://github.com/Osyanina/westone-CVE-2021-22986-scanner)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #4

**来源**: [CVE-2021-22986-S1xHcL_f5_rce_poc.md](../2021/CVE-2021-22986-S1xHcL_f5_rce_poc.md)

## CVE-2021-22986-F5-BIG-IP-iControl-REST-RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，可导致完全控制受影响的系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经验证的远程命令执行漏洞。攻击者无需身份验证即可通过构造恶意请求在目标系统上执行任意命令。

**利用方式：**

1.  **直接RCE (poc_1):** 利用PoC代码中的 `poc_1` 函数，通过构造包含恶意命令的 JSON 数据包，发送到目标设备的 `/mgmt/tm/util/bash` 接口。由于漏洞未授权，攻击者可以绕过身份验证，直接执行命令。

2.  **SSRF + RCE (ssrf_poc):** 利用PoC代码中的 `ssrf_poc` 函数，首先利用漏洞存在的SSRF漏洞，通过 `/mgmt/shared/authn/login` 接口获取一个有效的 Token。然后，使用该 Token，结合 `poc_1` 类似的 RCE 方法，在目标设备上执行任意命令。这种方式更隐蔽，也可能绕过一些简单的防御机制。

**投毒风险分析：**

该代码整体结构清晰，主要是实现了漏洞的复现和利用，代码的可读性较强。经过分析，PoC代码中并没有明显的恶意投毒行为。例如，没有发现反弹shell，持续驻留，或者信息搜集等恶意代码。但是该代码存在一定的风险，如果被恶意使用者修改，可能会被植入恶意代码，例如添加反弹shell等功能。因此，判定该仓库存在10%的投毒风险。

**搜索引擎结果印证：**

*   多个来源表明该漏洞在野外被积极利用（例如，Arctic Wolf 的报告）。
*   NCC Group 指出，存在不需要 SSRF 的 PoC，说明该漏洞的利用方式多样。
*   Imperva 的文章提到攻击活动在漏洞披露后激增。

综上所述，该漏洞利用代码有效，风险极高，攻击者可通过多种方式远程控制受影响的F5设备。

**项目地址:** [S1xHcL/f5_rce_poc](https://github.com/S1xHcL/f5_rce_poc)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #5

**来源**: [CVE-2021-22986-Tas9er_CVE-2021-22986.md](../2021/CVE-2021-22986-Tas9er_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP iControl RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中存在的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
根据漏洞信息、搜索结果（特别是NCC Group的分析）和漏洞利用代码，该漏洞是有效的。搜索引擎结果显示该漏洞已被积极利用。

**投毒风险：**
提供的POC代码包括一个 `README.md` 文件，其中包含免责声明，声明该工具仅用于授权安全测试。漏洞利用代码本身似乎是一个简单的利用程序，从 `url.txt` 读取目标 URL。但是，也存在潜在的风险，比如`CVE-2021-22986.jar`包含恶意代码，但因为没有jar包文件无法判断，结合免责声明，判定存在少量投毒风险。

**利用方式：**
利用方式涉及以下步骤：
1.  准备包含目标 URL 的 `url.txt` 文件。
2.  运行 `java -jar CVE-2021-22986.jar` 命令。

该工具通过未授权访问 iControl REST 接口，然后发送包含恶意命令的请求来利用漏洞。成功利用后，攻击者可以在受影响的 BIG-IP 或 BIG-IQ 设备上执行任意命令。

**优先级排序：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

搜索引擎结果表明该漏洞已被积极利用，漏洞利用代码提供了一个简单的利用方法，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Tas9er/CVE-2021-22986](https://github.com/Tas9er/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #6

**来源**: [CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md](../2021/CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST API-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统运行受影响的F5 BIG-IP或BIG-IQ版本，且iControl REST API接口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程命令执行。根据漏洞库信息和搜索结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。漏洞利用代码（Checker.py）通过构造包含恶意命令的JSON数据，并将其以POST请求发送到`/mgmt/tm/util/bash`端点来利用此漏洞。请求头包含`Content-Type: application/json`，并且尝试使用`X-F5-Auth-Token`（尽管为空）以及一个Base64编码的`Authorization`头（`admin:ASasasM`）。

有效性分析：提供的POC代码通过发送精心构造的POST请求到目标设备的iControl REST API来执行命令。如果目标设备存在漏洞且未打补丁，则可以成功执行命令。代码通过检查响应状态码是否为200以及响应文本中是否存在"commandResult"来判断是否成功利用漏洞。

投毒风险分析：查看提供的文件列表，包含`CODEOWNERS`、`Checker.py`、`README.md`。`CODEOWNERS`只包含一个github用户，没有发现可疑之处。`README.md`仅仅是描述如何使用脚本。`Checker.py`中，请求的URL和请求方式都是根据漏洞信息构造的，用于验证漏洞是否存在，并没有发现可以投毒的地方。`Authorization`头虽然存在，但其用户名和密码应该是用于某些情况下的身份验证，不属于恶意代码或后门。所以，此仓库中不存在明显的投毒代码。因此，投毒风险评估为0%。

利用方式：攻击者构造恶意的JSON数据，其中包含要在目标系统上执行的命令。然后，通过HTTP POST请求将此数据发送到目标设备的iControl REST API的特定端点（`/mgmt/tm/util/bash`）。由于漏洞存在于身份验证绕过，因此无需提供有效的身份验证信息即可执行命令。成功利用漏洞后，攻击者可以在目标系统上执行任意命令。

**项目地址:** [ZephrFish/CVE-2021-22986_Check](https://github.com/ZephrFish/CVE-2021-22986_Check)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #7

**来源**: [CVE-2021-22986-amitlttwo_CVE-2021-22986.md](../2021/CVE-2021-22986-amitlttwo_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 需要网络访问 iControl REST 接口 (通常通过管理界面或 Self IP 地址)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的攻击者执行任意系统命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 BIG-IP 和 BIG-IQ。搜索结果表明，该漏洞在野外已被积极利用，甚至被 Mirai 僵尸网络利用。提供的漏洞利用代码 `cve-2021-22986.py` 提供验证漏洞、执行命令、批量扫描和反弹 shell 的功能。它通过向 `/mgmt/tm/util/bash` 接口发送包含命令的 POST 请求来利用漏洞。其中Authorization header的Base64字符串 `YWRtaW46QVNhc1M=` 解码后为 `admin:ASasS`。利用方式是构造包含要执行的命令的 JSON 数据，并将其发送到易受攻击的 iControl REST 端点。由于代码中使用的header值是固定的,存在被记录的风险。关于投毒风险，快速浏览代码没有发现明显的恶意代码，但无法保证代码没有隐藏的后门或恶意行为，考虑到项目协作和网络安全风险，将投毒风险评估为10%，主要来自作者的不可信和payload的风险

**项目地址:** [amitlttwo/CVE-2021-22986](https://github.com/amitlttwo/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #8

**来源**: [CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md](../2021/CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md)

# CVE-2021-22986

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2021-22986-Al1ex_CVE-2021-22986.md](../2021/CVE-2021-22986-Al1ex_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经验证的远程命令执行漏洞。攻击者可以发送特制的 HTTP 请求到 `/mgmt/tm/util/bash` 接口，在目标系统上执行任意命令。

**有效性:**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开可用的PoC代码。提供的PoC代码通过构造包含命令的JSON数据，发送POST请求到目标URL的`/mgmt/tm/util/bash`接口，从而执行命令。代码中包含了验证模式、攻击模式、批量检测模式和反弹shell模式，验证了其有效性。

**投毒风险:**
PoC代码本身主要功能是利用漏洞执行命令，投毒风险较低。但依旧存在一定投毒风险：
1.  **默认认证信息:** 代码中硬编码了 `Authorization: Basic YWRtaW46QVNhc1M=` 默认认证信息（admin:ASasS），若目标系统仍使用此默认密码，则漏洞利用成功概率更高，但这也可能被攻击者利用，如果攻击者修改了目标系统的配置,可能会影响正常的业务.
2.  **反弹shell风险:**  反弹shell功能如果被恶意利用，可能在受害者不知情的情况下建立连接。
3.  **脚本作者风险:**  作者 Al1ex@Heptagram 的真实意图未知，可能在未来版本中添加恶意代码. 总体投毒风险预估为10%。

**利用方式:**
1.  确定目标F5 BIG-IP/BIG-IQ设备的版本在受影响范围内。
2.  使用PoC脚本，指定目标URL，并选择验证模式或攻击模式。
3.  在攻击模式下，指定要执行的命令。反弹shell模式可用于建立反向shell连接。
4.  对于批量检测，提供包含目标URL的文件。
5.  运行PoC脚本，利用漏洞执行命令。

**项目地址:** [Al1ex/CVE-2021-22986](https://github.com/Al1ex/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #2

**来源**: [CVE-2021-22986-DDestinys_CVE-2021-22986.md](../2021/CVE-2021-22986-DDestinys_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可以访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ中iControl REST接口的一个未经身份验证的远程命令执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。该漏洞允许未经身份验证的攻击者通过向iControl REST API发送特制的请求来执行任意命令。

**有效性：**

提供的POC代码看起来是有效的。它通过构造一个包含要执行的命令的JSON payload，并将其POST到`/mgmt/tm/util/bash`端点来利用此漏洞。代码首先尝试读取一个url列表，遍历这些url，并且发送post请求，验证是否成功执行。由于`CVE-2021-22986` 是一个被广泛研究的漏洞，有很多公开可用的利用代码，此POC代码是符合漏洞描述的。

**投毒风险：**

POC代码的投毒风险较低，约为10%。 代码本身的功能看起来是正常的漏洞利用，但是存在以下潜在的风险点：

1.  代码中存在一个`proxies`变量,如果使用者不注意修改，可能会将流量转发到攻击者控制的代理服务器。
2.  使用了`requests.packages.urllib3.disable_warnings()`，虽然这通常用于避免SSL证书验证问题，但可能会隐藏其他潜在的安全问题。
3.  代码尝试读取`url.txt`文件，并执行POST请求，如果`url.txt`文件被篡改，可能会导致意外的漏洞利用。
4. 代码中包含一个硬编码的 Basic 认证头 `Authorization: Basic YWRtaW46YWRtaW4=`, 虽然在漏洞利用中不太可能被直接使用，但如果使用者不清楚其含义，可能会在其他场景中错误使用。

这些潜在的风险点使得代码存在一定的投毒风险，但总体而言，代码的主要目的是利用漏洞，而非进行恶意行为。

**利用方式：**

利用方式如下：

1.  攻击者需要找到存在漏洞的F5 BIG-IP或BIG-IQ实例。
2.  攻击者构造一个包含恶意命令的JSON payload，例如`{'command': 'run', 'utilCmdArgs': '-c id'}`，其中`id`命令可以替换为任意系统命令。
3.  攻击者使用POST请求将该payload发送到目标的`/mgmt/tm/util/bash`端点，无需身份验证。
4.  服务器执行该命令，并将结果返回给攻击者。

此外，搜索引擎结果中提到，该漏洞已被Mirai僵尸网络利用，攻击者可以使用此漏洞来感染目标系统，并将其纳入僵尸网络。

**排序优先级：**

搜索引擎结果显示该漏洞已经被广泛利用，并且存在公开的POC，因此优先级最高。漏洞利用代码验证了漏洞的可利用性，并且有助于理解利用方式。漏洞库信息提供了漏洞的官方描述和受影响的版本范围，是重要的参考信息。

**项目地址:** [DDestinys/CVE-2021-22986](https://github.com/DDestinys/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #3

**来源**: [CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md](../2021/CVE-2021-22986-Osyanina_westone-CVE-2021-22986-scanner.md)

## CVE-2021-22986-F5 BIG-IP iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未授权远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统开启并暴露iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经身份验证的远程命令执行漏洞。漏洞存在于受影响版本的 iControl REST 接口中，允许未经身份验证的攻击者通过发送特制的 HTTP 请求执行任意系统命令。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被积极利用，并且存在公开的 PoC。虽然提供的漏洞利用代码 `/tmp/787246e6ce6e87a4ad488e0e4cce542c/README.md` 看起来只是一个扫描器或者一个占位符，但它表明已经有人在研究并分享关于这个漏洞的利用方法。

**投毒风险：**
提供的代码片段 `README.md` 文件本身不包含可执行代码，因此直接投毒的可能性较低。 但是，考虑到漏洞已经被公开，攻击者可能会创建恶意模块或脚本，伪装成漏洞利用工具，但实际上执行恶意操作。例如，某些PoC中可能包含下载恶意payload执行的操作。因为缺乏代码分析，这里假设有10%的可能性是作者隐藏了投毒代码。

**利用方式：**
1.  **未授权访问:** 攻击者无需身份验证即可访问 iControl REST 接口。
2.  **构造恶意请求:**  攻击者构造包含恶意命令的 HTTP 请求，通常利用 Server-Side Request Forgery (SSRF) 或直接命令注入绕过认证执行命令。
3.  **命令执行:**  BIG-IP/BIG-IQ 系统在收到恶意请求后，执行其中的命令，导致远程代码执行。

**总结：**
CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意代码。由于存在公开的 PoC 并且漏洞已被积极利用，受影响的用户应尽快升级到受支持的版本，或采取缓解措施。

**项目地址:** [Osyanina/westone-CVE-2021-22986-scanner](https://github.com/Osyanina/westone-CVE-2021-22986-scanner)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #4

**来源**: [CVE-2021-22986-S1xHcL_f5_rce_poc.md](../2021/CVE-2021-22986-S1xHcL_f5_rce_poc.md)

## CVE-2021-22986-F5-BIG-IP-iControl-REST-RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，可导致完全控制受影响的系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经验证的远程命令执行漏洞。攻击者无需身份验证即可通过构造恶意请求在目标系统上执行任意命令。

**利用方式：**

1.  **直接RCE (poc_1):** 利用PoC代码中的 `poc_1` 函数，通过构造包含恶意命令的 JSON 数据包，发送到目标设备的 `/mgmt/tm/util/bash` 接口。由于漏洞未授权，攻击者可以绕过身份验证，直接执行命令。

2.  **SSRF + RCE (ssrf_poc):** 利用PoC代码中的 `ssrf_poc` 函数，首先利用漏洞存在的SSRF漏洞，通过 `/mgmt/shared/authn/login` 接口获取一个有效的 Token。然后，使用该 Token，结合 `poc_1` 类似的 RCE 方法，在目标设备上执行任意命令。这种方式更隐蔽，也可能绕过一些简单的防御机制。

**投毒风险分析：**

该代码整体结构清晰，主要是实现了漏洞的复现和利用，代码的可读性较强。经过分析，PoC代码中并没有明显的恶意投毒行为。例如，没有发现反弹shell，持续驻留，或者信息搜集等恶意代码。但是该代码存在一定的风险，如果被恶意使用者修改，可能会被植入恶意代码，例如添加反弹shell等功能。因此，判定该仓库存在10%的投毒风险。

**搜索引擎结果印证：**

*   多个来源表明该漏洞在野外被积极利用（例如，Arctic Wolf 的报告）。
*   NCC Group 指出，存在不需要 SSRF 的 PoC，说明该漏洞的利用方式多样。
*   Imperva 的文章提到攻击活动在漏洞披露后激增。

综上所述，该漏洞利用代码有效，风险极高，攻击者可通过多种方式远程控制受影响的F5设备。

**项目地址:** [S1xHcL/f5_rce_poc](https://github.com/S1xHcL/f5_rce_poc)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #5

**来源**: [CVE-2021-22986-Tas9er_CVE-2021-22986.md](../2021/CVE-2021-22986-Tas9er_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP iControl RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中存在的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
根据漏洞信息、搜索结果（特别是NCC Group的分析）和漏洞利用代码，该漏洞是有效的。搜索引擎结果显示该漏洞已被积极利用。

**投毒风险：**
提供的POC代码包括一个 `README.md` 文件，其中包含免责声明，声明该工具仅用于授权安全测试。漏洞利用代码本身似乎是一个简单的利用程序，从 `url.txt` 读取目标 URL。但是，也存在潜在的风险，比如`CVE-2021-22986.jar`包含恶意代码，但因为没有jar包文件无法判断，结合免责声明，判定存在少量投毒风险。

**利用方式：**
利用方式涉及以下步骤：
1.  准备包含目标 URL 的 `url.txt` 文件。
2.  运行 `java -jar CVE-2021-22986.jar` 命令。

该工具通过未授权访问 iControl REST 接口，然后发送包含恶意命令的请求来利用漏洞。成功利用后，攻击者可以在受影响的 BIG-IP 或 BIG-IQ 设备上执行任意命令。

**优先级排序：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

搜索引擎结果表明该漏洞已被积极利用，漏洞利用代码提供了一个简单的利用方法，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Tas9er/CVE-2021-22986](https://github.com/Tas9er/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #6

**来源**: [CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md](../2021/CVE-2021-22986-ZephrFish_CVE-2021-22986_Check.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST API-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统运行受影响的F5 BIG-IP或BIG-IQ版本，且iControl REST API接口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程命令执行。根据漏洞库信息和搜索结果，该漏洞影响多个版本的BIG-IP和BIG-IQ。漏洞利用代码（Checker.py）通过构造包含恶意命令的JSON数据，并将其以POST请求发送到`/mgmt/tm/util/bash`端点来利用此漏洞。请求头包含`Content-Type: application/json`，并且尝试使用`X-F5-Auth-Token`（尽管为空）以及一个Base64编码的`Authorization`头（`admin:ASasasM`）。

有效性分析：提供的POC代码通过发送精心构造的POST请求到目标设备的iControl REST API来执行命令。如果目标设备存在漏洞且未打补丁，则可以成功执行命令。代码通过检查响应状态码是否为200以及响应文本中是否存在"commandResult"来判断是否成功利用漏洞。

投毒风险分析：查看提供的文件列表，包含`CODEOWNERS`、`Checker.py`、`README.md`。`CODEOWNERS`只包含一个github用户，没有发现可疑之处。`README.md`仅仅是描述如何使用脚本。`Checker.py`中，请求的URL和请求方式都是根据漏洞信息构造的，用于验证漏洞是否存在，并没有发现可以投毒的地方。`Authorization`头虽然存在，但其用户名和密码应该是用于某些情况下的身份验证，不属于恶意代码或后门。所以，此仓库中不存在明显的投毒代码。因此，投毒风险评估为0%。

利用方式：攻击者构造恶意的JSON数据，其中包含要在目标系统上执行的命令。然后，通过HTTP POST请求将此数据发送到目标设备的iControl REST API的特定端点（`/mgmt/tm/util/bash`）。由于漏洞存在于身份验证绕过，因此无需提供有效的身份验证信息即可执行命令。成功利用漏洞后，攻击者可以在目标系统上执行任意命令。

**项目地址:** [ZephrFish/CVE-2021-22986_Check](https://github.com/ZephrFish/CVE-2021-22986_Check)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #7

**来源**: [CVE-2021-22986-amitlttwo_CVE-2021-22986.md](../2021/CVE-2021-22986-amitlttwo_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 需要网络访问 iControl REST 接口 (通常通过管理界面或 Self IP 地址)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的攻击者执行任意系统命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 BIG-IP 和 BIG-IQ。搜索结果表明，该漏洞在野外已被积极利用，甚至被 Mirai 僵尸网络利用。提供的漏洞利用代码 `cve-2021-22986.py` 提供验证漏洞、执行命令、批量扫描和反弹 shell 的功能。它通过向 `/mgmt/tm/util/bash` 接口发送包含命令的 POST 请求来利用漏洞。其中Authorization header的Base64字符串 `YWRtaW46QVNhc1M=` 解码后为 `admin:ASasS`。利用方式是构造包含要执行的命令的 JSON 数据，并将其发送到易受攻击的 iControl REST 端点。由于代码中使用的header值是固定的,存在被记录的风险。关于投毒风险，快速浏览代码没有发现明显的恶意代码，但无法保证代码没有隐藏的后门或恶意行为，考虑到项目协作和网络安全风险，将投毒风险评估为10%，主要来自作者的不可信和payload的风险

**项目地址:** [amitlttwo/CVE-2021-22986](https://github.com/amitlttwo/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #8

**来源**: [CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md](../2021/CVE-2021-22986-dorkerdevil_CVE-2021-22986-Poc.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可导致完全控制受影响的系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3；BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP/BIG-IQ版本，且允许通过网络访问iControl REST接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-22986 漏洞存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中。攻击者可以利用此漏洞在未经身份验证的情况下远程执行命令。根据漏洞库信息，受影响的版本包括 BIG-IP 的 16.0.x 之前版本 16.0.1.1，15.1.x 之前版本 15.1.2.1，14.1.x 之前版本 14.1.4，13.1.x 之前版本 13.1.3.6，以及 12.1.x 之前版本 12.1.5.3，以及 BIG-IQ 的 7.1.0.x 之前版本 7.1.0.3 和 7.0.0.x 之前版本 7.0.0.2。搜索引擎结果表明该漏洞已被积极利用。提供的 POC 代码包含多个 curl 命令，用于利用该漏洞。其中一种利用方式是利用`filePath`参数执行命令，另一种是利用`/mgmt/tm/util/bash` 接口。目前没有明显的投毒代码的迹象，该仓库中的代码主要为了验证漏洞的存在。

**利用方式分析:**

1.  **利用filePath参数:**
    *   攻击者发送包含恶意 `filePath` 参数的请求到 `/mgmt/tm/access/bundle-install-tasks` 接口。
    *   由于未授权的访问控制缺陷，系统将执行 `filePath` 参数中包含的命令。
    *   `id` 命令被用作示例，但攻击者可以执行任何其他命令。

2.  **利用 /mgmt/tm/util/bash 接口:**
    *   攻击者发送包含 `command` 和 `utilCmdArgs` 参数的 JSON 数据到 `/mgmt/tm/util/bash` 接口。
    *   `command` 设置为 "run"，`utilCmdArgs` 包含要执行的命令（例如，`-c id`）。
    *   系统执行 `utilCmdArgs` 中指定的命令。

**有效性:**
根据漏洞信息、搜索结果以及 POC 代码，该漏洞的利用是有效的。搜索结果也表明此漏洞在野外已被积极利用。


**项目地址:** [dorkerdevil/CVE-2021-22986-Poc](https://github.com/dorkerdevil/CVE-2021-22986-Poc)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #9

**来源**: [CVE-2021-22986-dotslashed_CVE-2021-22986.md](../2021/CVE-2021-22986-dotslashed_CVE-2021-22986.md)

## CVE-2021-22986 F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问 iControl REST API 接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**根据漏洞库信息、搜索引擎结果（特别是NCC Group的分析）和已知的利用情况，此漏洞利用的有效性很高。有报告表明该漏洞已被积极利用于Mirai僵尸网络攻击。

**投毒风险：**提供的POC代码（README.md）本身只是一个使用说明，用于检测批量IP地址是否受到此漏洞影响。因此，它本身不包含任何恶意代码，因此投毒的风险较低，但是如果使用者下载了其他的POC代码，则需要对代码进行分析，以保证没有投毒代码。 这里给出的投毒风险百分比是根据POC代码本身进行评估的，考虑到使用者可能会从其他来源获取恶意POC，这里给出的投毒概率为10%。

**利用方式：**

1.  确定目标F5 BIG-IP/BIG-IQ设备的IP地址和端口。
2.  向 iControl REST API 发送特制的HTTP请求，其中包含要执行的命令。由于漏洞未经身份验证，因此攻击者不需要提供任何凭据。
3.  服务器执行请求中包含的命令，并将结果返回给攻击者。 

漏洞利用的关键是构造恶意的HTTP请求，该请求能够绕过任何现有的安全检查，并在服务器上执行任意命令。Packet Storm Security提供了相关的漏洞利用细节，可用于构造此类请求。

**总结：**该漏洞非常危险，因为它允许未经身份验证的攻击者在受影响的F5设备上执行任意命令。由于该漏洞已经被积极利用，因此强烈建议受影响的用户尽快升级到修补后的版本。

**项目地址:** [dotslashed/CVE-2021-22986](https://github.com/dotslashed/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #10

**来源**: [CVE-2021-22986-huydung26_CVE-2021-22986.md](../2021/CVE-2021-22986-huydung26_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST未授权远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 漏洞是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口存在的一个未授权远程命令执行漏洞。攻击者可以通过发送特制的请求到 iControl REST 接口，从而在目标系统上执行任意命令。根据提供的POC代码，利用方式主要分两步：

1.  **获取Token（方法一）:**
    *   首先，向`/mgmt/shared/authn/login`接口发送POST请求，尝试获取一个身份验证Token。这个请求中包含一个默认的用户名（admin）以及一些特定的参数。
    *   如果成功获取到Token，POC代码会提取该Token，并将其用于后续的命令执行。

2.  **执行命令:**
    *   利用获取到的Token，向`/mgmt/tm/util/bash`接口发送POST请求，并在请求体中包含要执行的命令。命令的结果会从响应中提取并显示。

**方法二（备选方案）：**
    *   如果获取Token失败，POC代码会尝试使用一个硬编码的Basic Auth头（`Authorization: Basic YWRtaW46QVNhc1M=`，对应admin:ASasS）。
    *   同样，通过向`/mgmt/tm/util/bash`接口发送POST请求来执行命令。

**有效性：**
根据提供的漏洞信息和POC代码，此漏洞利用代码是有效的，因为
*   漏洞库信息明确指出存在未授权的远程命令执行漏洞
*   搜索引擎结果表明该漏洞已被积极利用
*   POC代码尝试通过REST API执行系统命令

**投毒风险：**
存在较低的投毒风险（10%），主要基于以下几点考虑：
*   **代理配置：** POC代码包含使用代理的配置`proxy_url = "http://127.0.0.1:8080"`，如果用户没有意识到这一点，可能会将流量通过攻击者控制的代理服务器，从而泄露敏感信息或被中间人攻击。
*   **硬编码凭据：** 虽然提供了默认的用户名（admin）和密码`Authorization: Basic YWRtaW46QVNhc1M=`，但这只是为了方便POC的执行，并非恶意的后门植入。
*   **异常处理：** 在连接失败时，代码会尝试绕过代理。这看起来像是为了保证POC的可用性，但如果目标环境必须通过代理才能访问，这可能导致信息泄露。
总而言之，POC的主要目的是演示漏洞的利用，但使用代理和硬编码凭据可能会带来一定的安全风险，因此存在一定投毒风险, 建议用户在使用时仔细检查和修改代理设置，并避免在生产环境中使用默认凭据。

**项目地址:** [huydung26/CVE-2021-22986](https://github.com/huydung26/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #11

**来源**: [CVE-2021-22986-kiri-48_CVE-2021-22986.md](../2021/CVE-2021-22986-kiri-48_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标存在未授权访问的iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 中 iControl REST 接口的一个未授权远程命令执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过向 iControl REST API 发送特制的请求来执行任意系统命令。POC代码通过两个阶段进行利用。第一阶段尝试利用`/mgmt/shared/authn/login`接口泄露一个token，如果失败，则尝试使用固定的Basic认证头绕过认证。获取token后，使用`/mgmt/tm/util/bash`接口执行命令。由于代码逻辑稍显复杂, 存在一小部分投毒的可能性, 主要风险在于代码的容错部分，即第一阶段尝试利用失败后，可能由于环境差异，导致硬编码的header认证失效，从而利用失败。

**有效性：**
根据公开信息，该漏洞被广泛利用，POC代码有效。

**投毒风险：**
该POC代码主要利用漏洞实现远程命令执行，并未发现明显的恶意代码。但其中包含连接目标URL的操作，存在一定风险。如果攻击者控制了代码托管平台或参与了代码的修改，理论上可以植入恶意代码，例如收集目标信息、传播恶意软件等。但是从代码本身来看，直接投毒的概率较低，因此评估为10%。

**利用方式：**
1.  **利用 iControl REST 接口：** 漏洞存在于 iControl REST 接口，攻击者需要能够访问该接口。
2.  **绕过身份验证：**  攻击者通过构造特殊的请求绕过身份验证。
3.  **执行命令：**  攻击者在绕过身份验证后，可以通过 `/mgmt/tm/util/bash` 接口执行任意系统命令。

**排序优先级依据：**
1.  **搜索引擎结果：** 提供了漏洞被实际利用的信息，表明漏洞具有现实危害。
2.  **漏洞利用代码：**  POC 代码展示了漏洞的利用方法，验证了漏洞的可行性。
3.  **漏洞库信息：**  提供了漏洞的基本信息和受影响的版本范围。

**项目地址:** [kiri-48/CVE-2021-22986](https://github.com/kiri-48/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #12

**来源**: [CVE-2021-22986-microvorld_CVE-2021-22986.md](../2021/CVE-2021-22986-microvorld_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ 且 iControl REST 接口开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-22986 漏洞存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程攻击者执行任意命令。

**漏洞利用方式：**

1.  **获取 Token (Method 1):**  首先，POC尝试利用 `/mgmt/shared/authn/login` 接口泄漏认证 Token。它发送一个包含特定 `username` 和 `loginReference` 的 POST 请求，期望服务器返回一个有效的 Token。
2.  **执行命令:**  如果成功获取 Token，则使用该 Token 在 `/mgmt/tm/util/bash` 接口上执行命令。它构造一个包含 `command: run` 和 `utilCmdArgs` 的 JSON 数据，并将要执行的命令嵌入到 `utilCmdArgs` 中。
3. **另一种方式 (Method 2):** 如果无法通过Method 1获取Token,POC会尝试使用硬编码的Authorization头 'Authorization': 'Basic YWRtaW46QVNhc1M=' 结合X-F5-Auth-Token为空的方式，尝试在 `/mgmt/tm/util/bash` 接口上执行命令。

**有效性：**

根据漏洞描述、搜索结果（特别是 NCC Group 的报告指出无需 SSRF 即可利用）以及提供的 PoC 代码，该漏洞利用的有效性很高。存在多个公开的 PoC，并且该漏洞已被积极利用。

**投毒风险：**

该PoC主要功能为漏洞验证和利用，未发现明显的恶意行为。`README.md` 文件仅包含基本的使用说明。代码结构清晰，主要操作为发送 HTTP 请求和处理响应。该POC代码中的投毒风险较低，为1%。考虑到公开的 PoC 旨在利用漏洞，而非进行恶意活动，因此投毒的可能性较小。硬编码的Basic认证 `admin:ASasS=`也比较常见。

**总结：**

CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意命令。提供的 PoC 代码通过两种方式，首先是尝试泄漏Token，如果失败则尝试通过Basic认证结合X-F5-Auth-Token为空的方式，利用 `/mgmt/tm/util/bash` 接口执行命令。
根据现有信息，该漏洞利用的有效性很高，并且该漏洞在野外已被利用。PoC代码本身似乎没有明显的投毒行为，但使用者应始终注意从不受信任的来源获取代码的风险。

**项目地址:** [microvorld/CVE-2021-22986](https://github.com/microvorld/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #13

**来源**: [CVE-2021-22986-safesword_F5_RCE.md](../2021/CVE-2021-22986-safesword_F5_RCE.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ，并且可以访问 iControl REST 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以通过向易受攻击的 iControl REST 端点发送特制的 POST 请求来利用此漏洞，从而在目标系统上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明，该漏洞已被积极利用，并且有公开可用的 POC 代码。

**投毒风险：**

分析提供的 POC 代码 `f5_rce.py`，没有发现明显的恶意代码。该脚本使用 `requests` 库发送 HTTP 请求，并根据响应判断漏洞是否存在。`README.md` 文件描述了脚本的使用方法，并指出了该 POC 可能存在的局限性。但是，仍然存在细微的投毒风险，例如：

*   **依赖风险：** 脚本依赖 `requests` 库。如果攻击者控制了该库的安装源，可能会植入恶意代码。
*   **命令注入：** 脚本使用 `format` 函数格式化命令，可能存在命令注入的风险，但可能性较低，因为参数 `--command` 的执行，需要用户进行主动设置。
*   **输出文件：** `save_file` 函数会将目标 URL 保存到文件中，可能造成信息泄露。该文件默认保存在攻击者机器上，影响较小。

因此，投毒风险较低，约为 5%。

**利用方式：**

1.  攻击者向目标 F5 BIG-IP/BIG-IQ 设备的 iControl REST 接口发送特制的 POST 请求。
2.  请求的 payload 包含要执行的命令。
3.  由于漏洞存在于身份验证绕过中，因此攻击者无需提供有效的身份验证凭据即可发送此请求。
4.  目标设备执行命令，并将结果返回给攻击者。

提供的 POC 代码 `f5_rce.py` 实现了此利用方式。该脚本接受目标 URL 和要执行的命令作为参数，并发送相应的 POST 请求。

**项目地址:** [safesword/F5_RCE](https://github.com/safesword/F5_RCE)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #14

**来源**: [CVE-2021-22986-yaunsky_CVE-202122986-EXP.md](../2021/CVE-2021-22986-yaunsky_CVE-202122986-EXP.md)

## CVE-2021-22986-F5 BIG-IP iControl REST 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ设备中iControl REST接口存在的一个未经身份验证的远程命令执行漏洞。攻击者可以通过发送特制的HTTP请求到/mgmt/tm/util/bash端点来执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果显示，该漏洞在野外被积极利用，并且存在公开的PoC代码。提供的Python脚本`CVE202122986.py`实现了该漏洞的利用，通过向目标URL的`/mgmt/tm/util/bash`端点发送包含恶意命令的POST请求，从而实现远程命令执行。

**投毒风险：**

经过对提供的Python脚本`CVE202122986.py`的分析，发现以下几点可能存在的风险：

1.  **硬编码的认证信息：** 脚本中使用了硬编码的`Authorization: Basic YWRtaW46QVNhc1M=`头，虽然是默认的用户名密码，但如果被恶意修改，可能会导致利用失败，或者留下后门。
2.  **命令执行方式：** 脚本使用了`base64`编码来绕过某些检测，虽然增加了命令执行的灵活性，但也可能被用于执行更复杂的恶意命令。
3.  **错误处理：** 脚本中的错误处理比较简单，可能会在出现异常时直接退出，无法进行更深入的利用。

综合评估，该脚本本身存在一定的风险，例如使用硬编码的认证信息，以及潜在的命令执行风险。考虑到脚本的目的是执行任意命令，所以将payload隐藏在命令中具有一定的隐蔽性。因此，存在投毒风险的可能性较高，大约为10%。

**利用方式：**

1.  **发送POST请求：** 攻击者构造一个恶意的POST请求，目标URL为存在漏洞的F5 BIG-IP或BIG-IQ设备的`/mgmt/tm/util/bash`端点。
2.  **设置请求头：** 设置必要的请求头，包括`Authorization`（包含Base64编码的用户名密码），`X-F5-Auth-Token`（可能为空），以及`Content-Type: application/json`。
3.  **构造JSON数据：** 在POST请求的body中，构造一个JSON数据，包含`command`和`utilCmdArgs`字段。`command`字段设置为`run`，`utilCmdArgs`字段包含要执行的命令，例如`'-c id'`。
4.  **发送请求并执行命令：** 将构造好的POST请求发送到目标URL，目标设备将执行`utilCmdArgs`中指定的命令，并将结果返回在响应的`commandResult`字段中。
5.  **命令执行：** 使用`-c`参数执行单条命令，或者利用`base64`编码执行更复杂的命令，例如反弹shell等。


**项目地址:** [yaunsky/CVE-202122986-EXP](https://github.com/yaunsky/CVE-202122986-EXP)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---



---

## POC #9

**来源**: [CVE-2021-22986-dotslashed_CVE-2021-22986.md](../2021/CVE-2021-22986-dotslashed_CVE-2021-22986.md)

## CVE-2021-22986 F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问 iControl REST API 接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**根据漏洞库信息、搜索引擎结果（特别是NCC Group的分析）和已知的利用情况，此漏洞利用的有效性很高。有报告表明该漏洞已被积极利用于Mirai僵尸网络攻击。

**投毒风险：**提供的POC代码（README.md）本身只是一个使用说明，用于检测批量IP地址是否受到此漏洞影响。因此，它本身不包含任何恶意代码，因此投毒的风险较低，但是如果使用者下载了其他的POC代码，则需要对代码进行分析，以保证没有投毒代码。 这里给出的投毒风险百分比是根据POC代码本身进行评估的，考虑到使用者可能会从其他来源获取恶意POC，这里给出的投毒概率为10%。

**利用方式：**

1.  确定目标F5 BIG-IP/BIG-IQ设备的IP地址和端口。
2.  向 iControl REST API 发送特制的HTTP请求，其中包含要执行的命令。由于漏洞未经身份验证，因此攻击者不需要提供任何凭据。
3.  服务器执行请求中包含的命令，并将结果返回给攻击者。 

漏洞利用的关键是构造恶意的HTTP请求，该请求能够绕过任何现有的安全检查，并在服务器上执行任意命令。Packet Storm Security提供了相关的漏洞利用细节，可用于构造此类请求。

**总结：**该漏洞非常危险，因为它允许未经身份验证的攻击者在受影响的F5设备上执行任意命令。由于该漏洞已经被积极利用，因此强烈建议受影响的用户尽快升级到修补后的版本。

**项目地址:** [dotslashed/CVE-2021-22986](https://github.com/dotslashed/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #10

**来源**: [CVE-2021-22986-huydung26_CVE-2021-22986.md](../2021/CVE-2021-22986-huydung26_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST未授权远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 漏洞是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口存在的一个未授权远程命令执行漏洞。攻击者可以通过发送特制的请求到 iControl REST 接口，从而在目标系统上执行任意命令。根据提供的POC代码，利用方式主要分两步：

1.  **获取Token（方法一）:**
    *   首先，向`/mgmt/shared/authn/login`接口发送POST请求，尝试获取一个身份验证Token。这个请求中包含一个默认的用户名（admin）以及一些特定的参数。
    *   如果成功获取到Token，POC代码会提取该Token，并将其用于后续的命令执行。

2.  **执行命令:**
    *   利用获取到的Token，向`/mgmt/tm/util/bash`接口发送POST请求，并在请求体中包含要执行的命令。命令的结果会从响应中提取并显示。

**方法二（备选方案）：**
    *   如果获取Token失败，POC代码会尝试使用一个硬编码的Basic Auth头（`Authorization: Basic YWRtaW46QVNhc1M=`，对应admin:ASasS）。
    *   同样，通过向`/mgmt/tm/util/bash`接口发送POST请求来执行命令。

**有效性：**
根据提供的漏洞信息和POC代码，此漏洞利用代码是有效的，因为
*   漏洞库信息明确指出存在未授权的远程命令执行漏洞
*   搜索引擎结果表明该漏洞已被积极利用
*   POC代码尝试通过REST API执行系统命令

**投毒风险：**
存在较低的投毒风险（10%），主要基于以下几点考虑：
*   **代理配置：** POC代码包含使用代理的配置`proxy_url = "http://127.0.0.1:8080"`，如果用户没有意识到这一点，可能会将流量通过攻击者控制的代理服务器，从而泄露敏感信息或被中间人攻击。
*   **硬编码凭据：** 虽然提供了默认的用户名（admin）和密码`Authorization: Basic YWRtaW46QVNhc1M=`，但这只是为了方便POC的执行，并非恶意的后门植入。
*   **异常处理：** 在连接失败时，代码会尝试绕过代理。这看起来像是为了保证POC的可用性，但如果目标环境必须通过代理才能访问，这可能导致信息泄露。
总而言之，POC的主要目的是演示漏洞的利用，但使用代理和硬编码凭据可能会带来一定的安全风险，因此存在一定投毒风险, 建议用户在使用时仔细检查和修改代理设置，并避免在生产环境中使用默认凭据。

**项目地址:** [huydung26/CVE-2021-22986](https://github.com/huydung26/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #11

**来源**: [CVE-2021-22986-kiri-48_CVE-2021-22986.md](../2021/CVE-2021-22986-kiri-48_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标存在未授权访问的iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 中 iControl REST 接口的一个未授权远程命令执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过向 iControl REST API 发送特制的请求来执行任意系统命令。POC代码通过两个阶段进行利用。第一阶段尝试利用`/mgmt/shared/authn/login`接口泄露一个token，如果失败，则尝试使用固定的Basic认证头绕过认证。获取token后，使用`/mgmt/tm/util/bash`接口执行命令。由于代码逻辑稍显复杂, 存在一小部分投毒的可能性, 主要风险在于代码的容错部分，即第一阶段尝试利用失败后，可能由于环境差异，导致硬编码的header认证失效，从而利用失败。

**有效性：**
根据公开信息，该漏洞被广泛利用，POC代码有效。

**投毒风险：**
该POC代码主要利用漏洞实现远程命令执行，并未发现明显的恶意代码。但其中包含连接目标URL的操作，存在一定风险。如果攻击者控制了代码托管平台或参与了代码的修改，理论上可以植入恶意代码，例如收集目标信息、传播恶意软件等。但是从代码本身来看，直接投毒的概率较低，因此评估为10%。

**利用方式：**
1.  **利用 iControl REST 接口：** 漏洞存在于 iControl REST 接口，攻击者需要能够访问该接口。
2.  **绕过身份验证：**  攻击者通过构造特殊的请求绕过身份验证。
3.  **执行命令：**  攻击者在绕过身份验证后，可以通过 `/mgmt/tm/util/bash` 接口执行任意系统命令。

**排序优先级依据：**
1.  **搜索引擎结果：** 提供了漏洞被实际利用的信息，表明漏洞具有现实危害。
2.  **漏洞利用代码：**  POC 代码展示了漏洞的利用方法，验证了漏洞的可行性。
3.  **漏洞库信息：**  提供了漏洞的基本信息和受影响的版本范围。

**项目地址:** [kiri-48/CVE-2021-22986](https://github.com/kiri-48/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #12

**来源**: [CVE-2021-22986-microvorld_CVE-2021-22986.md](../2021/CVE-2021-22986-microvorld_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ 且 iControl REST 接口开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-22986 漏洞存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程攻击者执行任意命令。

**漏洞利用方式：**

1.  **获取 Token (Method 1):**  首先，POC尝试利用 `/mgmt/shared/authn/login` 接口泄漏认证 Token。它发送一个包含特定 `username` 和 `loginReference` 的 POST 请求，期望服务器返回一个有效的 Token。
2.  **执行命令:**  如果成功获取 Token，则使用该 Token 在 `/mgmt/tm/util/bash` 接口上执行命令。它构造一个包含 `command: run` 和 `utilCmdArgs` 的 JSON 数据，并将要执行的命令嵌入到 `utilCmdArgs` 中。
3. **另一种方式 (Method 2):** 如果无法通过Method 1获取Token,POC会尝试使用硬编码的Authorization头 'Authorization': 'Basic YWRtaW46QVNhc1M=' 结合X-F5-Auth-Token为空的方式，尝试在 `/mgmt/tm/util/bash` 接口上执行命令。

**有效性：**

根据漏洞描述、搜索结果（特别是 NCC Group 的报告指出无需 SSRF 即可利用）以及提供的 PoC 代码，该漏洞利用的有效性很高。存在多个公开的 PoC，并且该漏洞已被积极利用。

**投毒风险：**

该PoC主要功能为漏洞验证和利用，未发现明显的恶意行为。`README.md` 文件仅包含基本的使用说明。代码结构清晰，主要操作为发送 HTTP 请求和处理响应。该POC代码中的投毒风险较低，为1%。考虑到公开的 PoC 旨在利用漏洞，而非进行恶意活动，因此投毒的可能性较小。硬编码的Basic认证 `admin:ASasS=`也比较常见。

**总结：**

CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意命令。提供的 PoC 代码通过两种方式，首先是尝试泄漏Token，如果失败则尝试通过Basic认证结合X-F5-Auth-Token为空的方式，利用 `/mgmt/tm/util/bash` 接口执行命令。
根据现有信息，该漏洞利用的有效性很高，并且该漏洞在野外已被利用。PoC代码本身似乎没有明显的投毒行为，但使用者应始终注意从不受信任的来源获取代码的风险。

**项目地址:** [microvorld/CVE-2021-22986](https://github.com/microvorld/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #13

**来源**: [CVE-2021-22986-safesword_F5_RCE.md](../2021/CVE-2021-22986-safesword_F5_RCE.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ，并且可以访问 iControl REST 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以通过向易受攻击的 iControl REST 端点发送特制的 POST 请求来利用此漏洞，从而在目标系统上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明，该漏洞已被积极利用，并且有公开可用的 POC 代码。

**投毒风险：**

分析提供的 POC 代码 `f5_rce.py`，没有发现明显的恶意代码。该脚本使用 `requests` 库发送 HTTP 请求，并根据响应判断漏洞是否存在。`README.md` 文件描述了脚本的使用方法，并指出了该 POC 可能存在的局限性。但是，仍然存在细微的投毒风险，例如：

*   **依赖风险：** 脚本依赖 `requests` 库。如果攻击者控制了该库的安装源，可能会植入恶意代码。
*   **命令注入：** 脚本使用 `format` 函数格式化命令，可能存在命令注入的风险，但可能性较低，因为参数 `--command` 的执行，需要用户进行主动设置。
*   **输出文件：** `save_file` 函数会将目标 URL 保存到文件中，可能造成信息泄露。该文件默认保存在攻击者机器上，影响较小。

因此，投毒风险较低，约为 5%。

**利用方式：**

1.  攻击者向目标 F5 BIG-IP/BIG-IQ 设备的 iControl REST 接口发送特制的 POST 请求。
2.  请求的 payload 包含要执行的命令。
3.  由于漏洞存在于身份验证绕过中，因此攻击者无需提供有效的身份验证凭据即可发送此请求。
4.  目标设备执行命令，并将结果返回给攻击者。

提供的 POC 代码 `f5_rce.py` 实现了此利用方式。该脚本接受目标 URL 和要执行的命令作为参数，并发送相应的 POST 请求。

**项目地址:** [safesword/F5_RCE](https://github.com/safesword/F5_RCE)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #14

**来源**: [CVE-2021-22986-yaunsky_CVE-202122986-EXP.md](../2021/CVE-2021-22986-yaunsky_CVE-202122986-EXP.md)

## CVE-2021-22986-F5 BIG-IP iControl REST 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ设备中iControl REST接口存在的一个未经身份验证的远程命令执行漏洞。攻击者可以通过发送特制的HTTP请求到/mgmt/tm/util/bash端点来执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果显示，该漏洞在野外被积极利用，并且存在公开的PoC代码。提供的Python脚本`CVE202122986.py`实现了该漏洞的利用，通过向目标URL的`/mgmt/tm/util/bash`端点发送包含恶意命令的POST请求，从而实现远程命令执行。

**投毒风险：**

经过对提供的Python脚本`CVE202122986.py`的分析，发现以下几点可能存在的风险：

1.  **硬编码的认证信息：** 脚本中使用了硬编码的`Authorization: Basic YWRtaW46QVNhc1M=`头，虽然是默认的用户名密码，但如果被恶意修改，可能会导致利用失败，或者留下后门。
2.  **命令执行方式：** 脚本使用了`base64`编码来绕过某些检测，虽然增加了命令执行的灵活性，但也可能被用于执行更复杂的恶意命令。
3.  **错误处理：** 脚本中的错误处理比较简单，可能会在出现异常时直接退出，无法进行更深入的利用。

综合评估，该脚本本身存在一定的风险，例如使用硬编码的认证信息，以及潜在的命令执行风险。考虑到脚本的目的是执行任意命令，所以将payload隐藏在命令中具有一定的隐蔽性。因此，存在投毒风险的可能性较高，大约为10%。

**利用方式：**

1.  **发送POST请求：** 攻击者构造一个恶意的POST请求，目标URL为存在漏洞的F5 BIG-IP或BIG-IQ设备的`/mgmt/tm/util/bash`端点。
2.  **设置请求头：** 设置必要的请求头，包括`Authorization`（包含Base64编码的用户名密码），`X-F5-Auth-Token`（可能为空），以及`Content-Type: application/json`。
3.  **构造JSON数据：** 在POST请求的body中，构造一个JSON数据，包含`command`和`utilCmdArgs`字段。`command`字段设置为`run`，`utilCmdArgs`字段包含要执行的命令，例如`'-c id'`。
4.  **发送请求并执行命令：** 将构造好的POST请求发送到目标URL，目标设备将执行`utilCmdArgs`中指定的命令，并将结果返回在响应的`commandResult`字段中。
5.  **命令执行：** 使用`-c`参数执行单条命令，或者利用`base64`编码执行更复杂的命令，例如反弹shell等。


**项目地址:** [yaunsky/CVE-202122986-EXP](https://github.com/yaunsky/CVE-202122986-EXP)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---



---

## POC #9

**来源**: [CVE-2021-22986-dotslashed_CVE-2021-22986.md](../2021/CVE-2021-22986-dotslashed_CVE-2021-22986.md)

## CVE-2021-22986 F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问 iControl REST API 接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**根据漏洞库信息、搜索引擎结果（特别是NCC Group的分析）和已知的利用情况，此漏洞利用的有效性很高。有报告表明该漏洞已被积极利用于Mirai僵尸网络攻击。

**投毒风险：**提供的POC代码（README.md）本身只是一个使用说明，用于检测批量IP地址是否受到此漏洞影响。因此，它本身不包含任何恶意代码，因此投毒的风险较低，但是如果使用者下载了其他的POC代码，则需要对代码进行分析，以保证没有投毒代码。 这里给出的投毒风险百分比是根据POC代码本身进行评估的，考虑到使用者可能会从其他来源获取恶意POC，这里给出的投毒概率为10%。

**利用方式：**

1.  确定目标F5 BIG-IP/BIG-IQ设备的IP地址和端口。
2.  向 iControl REST API 发送特制的HTTP请求，其中包含要执行的命令。由于漏洞未经身份验证，因此攻击者不需要提供任何凭据。
3.  服务器执行请求中包含的命令，并将结果返回给攻击者。 

漏洞利用的关键是构造恶意的HTTP请求，该请求能够绕过任何现有的安全检查，并在服务器上执行任意命令。Packet Storm Security提供了相关的漏洞利用细节，可用于构造此类请求。

**总结：**该漏洞非常危险，因为它允许未经身份验证的攻击者在受影响的F5设备上执行任意命令。由于该漏洞已经被积极利用，因此强烈建议受影响的用户尽快升级到修补后的版本。

**项目地址:** [dotslashed/CVE-2021-22986](https://github.com/dotslashed/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #10

**来源**: [CVE-2021-22986-huydung26_CVE-2021-22986.md](../2021/CVE-2021-22986-huydung26_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST未授权远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 漏洞是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口存在的一个未授权远程命令执行漏洞。攻击者可以通过发送特制的请求到 iControl REST 接口，从而在目标系统上执行任意命令。根据提供的POC代码，利用方式主要分两步：

1.  **获取Token（方法一）:**
    *   首先，向`/mgmt/shared/authn/login`接口发送POST请求，尝试获取一个身份验证Token。这个请求中包含一个默认的用户名（admin）以及一些特定的参数。
    *   如果成功获取到Token，POC代码会提取该Token，并将其用于后续的命令执行。

2.  **执行命令:**
    *   利用获取到的Token，向`/mgmt/tm/util/bash`接口发送POST请求，并在请求体中包含要执行的命令。命令的结果会从响应中提取并显示。

**方法二（备选方案）：**
    *   如果获取Token失败，POC代码会尝试使用一个硬编码的Basic Auth头（`Authorization: Basic YWRtaW46QVNhc1M=`，对应admin:ASasS）。
    *   同样，通过向`/mgmt/tm/util/bash`接口发送POST请求来执行命令。

**有效性：**
根据提供的漏洞信息和POC代码，此漏洞利用代码是有效的，因为
*   漏洞库信息明确指出存在未授权的远程命令执行漏洞
*   搜索引擎结果表明该漏洞已被积极利用
*   POC代码尝试通过REST API执行系统命令

**投毒风险：**
存在较低的投毒风险（10%），主要基于以下几点考虑：
*   **代理配置：** POC代码包含使用代理的配置`proxy_url = "http://127.0.0.1:8080"`，如果用户没有意识到这一点，可能会将流量通过攻击者控制的代理服务器，从而泄露敏感信息或被中间人攻击。
*   **硬编码凭据：** 虽然提供了默认的用户名（admin）和密码`Authorization: Basic YWRtaW46QVNhc1M=`，但这只是为了方便POC的执行，并非恶意的后门植入。
*   **异常处理：** 在连接失败时，代码会尝试绕过代理。这看起来像是为了保证POC的可用性，但如果目标环境必须通过代理才能访问，这可能导致信息泄露。
总而言之，POC的主要目的是演示漏洞的利用，但使用代理和硬编码凭据可能会带来一定的安全风险，因此存在一定投毒风险, 建议用户在使用时仔细检查和修改代理设置，并避免在生产环境中使用默认凭据。

**项目地址:** [huydung26/CVE-2021-22986](https://github.com/huydung26/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #11

**来源**: [CVE-2021-22986-kiri-48_CVE-2021-22986.md](../2021/CVE-2021-22986-kiri-48_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标存在未授权访问的iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 中 iControl REST 接口的一个未授权远程命令执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过向 iControl REST API 发送特制的请求来执行任意系统命令。POC代码通过两个阶段进行利用。第一阶段尝试利用`/mgmt/shared/authn/login`接口泄露一个token，如果失败，则尝试使用固定的Basic认证头绕过认证。获取token后，使用`/mgmt/tm/util/bash`接口执行命令。由于代码逻辑稍显复杂, 存在一小部分投毒的可能性, 主要风险在于代码的容错部分，即第一阶段尝试利用失败后，可能由于环境差异，导致硬编码的header认证失效，从而利用失败。

**有效性：**
根据公开信息，该漏洞被广泛利用，POC代码有效。

**投毒风险：**
该POC代码主要利用漏洞实现远程命令执行，并未发现明显的恶意代码。但其中包含连接目标URL的操作，存在一定风险。如果攻击者控制了代码托管平台或参与了代码的修改，理论上可以植入恶意代码，例如收集目标信息、传播恶意软件等。但是从代码本身来看，直接投毒的概率较低，因此评估为10%。

**利用方式：**
1.  **利用 iControl REST 接口：** 漏洞存在于 iControl REST 接口，攻击者需要能够访问该接口。
2.  **绕过身份验证：**  攻击者通过构造特殊的请求绕过身份验证。
3.  **执行命令：**  攻击者在绕过身份验证后，可以通过 `/mgmt/tm/util/bash` 接口执行任意系统命令。

**排序优先级依据：**
1.  **搜索引擎结果：** 提供了漏洞被实际利用的信息，表明漏洞具有现实危害。
2.  **漏洞利用代码：**  POC 代码展示了漏洞的利用方法，验证了漏洞的可行性。
3.  **漏洞库信息：**  提供了漏洞的基本信息和受影响的版本范围。

**项目地址:** [kiri-48/CVE-2021-22986](https://github.com/kiri-48/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #12

**来源**: [CVE-2021-22986-microvorld_CVE-2021-22986.md](../2021/CVE-2021-22986-microvorld_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ 且 iControl REST 接口开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-22986 漏洞存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程攻击者执行任意命令。

**漏洞利用方式：**

1.  **获取 Token (Method 1):**  首先，POC尝试利用 `/mgmt/shared/authn/login` 接口泄漏认证 Token。它发送一个包含特定 `username` 和 `loginReference` 的 POST 请求，期望服务器返回一个有效的 Token。
2.  **执行命令:**  如果成功获取 Token，则使用该 Token 在 `/mgmt/tm/util/bash` 接口上执行命令。它构造一个包含 `command: run` 和 `utilCmdArgs` 的 JSON 数据，并将要执行的命令嵌入到 `utilCmdArgs` 中。
3. **另一种方式 (Method 2):** 如果无法通过Method 1获取Token,POC会尝试使用硬编码的Authorization头 'Authorization': 'Basic YWRtaW46QVNhc1M=' 结合X-F5-Auth-Token为空的方式，尝试在 `/mgmt/tm/util/bash` 接口上执行命令。

**有效性：**

根据漏洞描述、搜索结果（特别是 NCC Group 的报告指出无需 SSRF 即可利用）以及提供的 PoC 代码，该漏洞利用的有效性很高。存在多个公开的 PoC，并且该漏洞已被积极利用。

**投毒风险：**

该PoC主要功能为漏洞验证和利用，未发现明显的恶意行为。`README.md` 文件仅包含基本的使用说明。代码结构清晰，主要操作为发送 HTTP 请求和处理响应。该POC代码中的投毒风险较低，为1%。考虑到公开的 PoC 旨在利用漏洞，而非进行恶意活动，因此投毒的可能性较小。硬编码的Basic认证 `admin:ASasS=`也比较常见。

**总结：**

CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意命令。提供的 PoC 代码通过两种方式，首先是尝试泄漏Token，如果失败则尝试通过Basic认证结合X-F5-Auth-Token为空的方式，利用 `/mgmt/tm/util/bash` 接口执行命令。
根据现有信息，该漏洞利用的有效性很高，并且该漏洞在野外已被利用。PoC代码本身似乎没有明显的投毒行为，但使用者应始终注意从不受信任的来源获取代码的风险。

**项目地址:** [microvorld/CVE-2021-22986](https://github.com/microvorld/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #13

**来源**: [CVE-2021-22986-safesword_F5_RCE.md](../2021/CVE-2021-22986-safesword_F5_RCE.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ，并且可以访问 iControl REST 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以通过向易受攻击的 iControl REST 端点发送特制的 POST 请求来利用此漏洞，从而在目标系统上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明，该漏洞已被积极利用，并且有公开可用的 POC 代码。

**投毒风险：**

分析提供的 POC 代码 `f5_rce.py`，没有发现明显的恶意代码。该脚本使用 `requests` 库发送 HTTP 请求，并根据响应判断漏洞是否存在。`README.md` 文件描述了脚本的使用方法，并指出了该 POC 可能存在的局限性。但是，仍然存在细微的投毒风险，例如：

*   **依赖风险：** 脚本依赖 `requests` 库。如果攻击者控制了该库的安装源，可能会植入恶意代码。
*   **命令注入：** 脚本使用 `format` 函数格式化命令，可能存在命令注入的风险，但可能性较低，因为参数 `--command` 的执行，需要用户进行主动设置。
*   **输出文件：** `save_file` 函数会将目标 URL 保存到文件中，可能造成信息泄露。该文件默认保存在攻击者机器上，影响较小。

因此，投毒风险较低，约为 5%。

**利用方式：**

1.  攻击者向目标 F5 BIG-IP/BIG-IQ 设备的 iControl REST 接口发送特制的 POST 请求。
2.  请求的 payload 包含要执行的命令。
3.  由于漏洞存在于身份验证绕过中，因此攻击者无需提供有效的身份验证凭据即可发送此请求。
4.  目标设备执行命令，并将结果返回给攻击者。

提供的 POC 代码 `f5_rce.py` 实现了此利用方式。该脚本接受目标 URL 和要执行的命令作为参数，并发送相应的 POST 请求。

**项目地址:** [safesword/F5_RCE](https://github.com/safesword/F5_RCE)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #14

**来源**: [CVE-2021-22986-yaunsky_CVE-202122986-EXP.md](../2021/CVE-2021-22986-yaunsky_CVE-202122986-EXP.md)

## CVE-2021-22986-F5 BIG-IP iControl REST 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ设备中iControl REST接口存在的一个未经身份验证的远程命令执行漏洞。攻击者可以通过发送特制的HTTP请求到/mgmt/tm/util/bash端点来执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果显示，该漏洞在野外被积极利用，并且存在公开的PoC代码。提供的Python脚本`CVE202122986.py`实现了该漏洞的利用，通过向目标URL的`/mgmt/tm/util/bash`端点发送包含恶意命令的POST请求，从而实现远程命令执行。

**投毒风险：**

经过对提供的Python脚本`CVE202122986.py`的分析，发现以下几点可能存在的风险：

1.  **硬编码的认证信息：** 脚本中使用了硬编码的`Authorization: Basic YWRtaW46QVNhc1M=`头，虽然是默认的用户名密码，但如果被恶意修改，可能会导致利用失败，或者留下后门。
2.  **命令执行方式：** 脚本使用了`base64`编码来绕过某些检测，虽然增加了命令执行的灵活性，但也可能被用于执行更复杂的恶意命令。
3.  **错误处理：** 脚本中的错误处理比较简单，可能会在出现异常时直接退出，无法进行更深入的利用。

综合评估，该脚本本身存在一定的风险，例如使用硬编码的认证信息，以及潜在的命令执行风险。考虑到脚本的目的是执行任意命令，所以将payload隐藏在命令中具有一定的隐蔽性。因此，存在投毒风险的可能性较高，大约为10%。

**利用方式：**

1.  **发送POST请求：** 攻击者构造一个恶意的POST请求，目标URL为存在漏洞的F5 BIG-IP或BIG-IQ设备的`/mgmt/tm/util/bash`端点。
2.  **设置请求头：** 设置必要的请求头，包括`Authorization`（包含Base64编码的用户名密码），`X-F5-Auth-Token`（可能为空），以及`Content-Type: application/json`。
3.  **构造JSON数据：** 在POST请求的body中，构造一个JSON数据，包含`command`和`utilCmdArgs`字段。`command`字段设置为`run`，`utilCmdArgs`字段包含要执行的命令，例如`'-c id'`。
4.  **发送请求并执行命令：** 将构造好的POST请求发送到目标URL，目标设备将执行`utilCmdArgs`中指定的命令，并将结果返回在响应的`commandResult`字段中。
5.  **命令执行：** 使用`-c`参数执行单条命令，或者利用`base64`编码执行更复杂的命令，例如反弹shell等。


**项目地址:** [yaunsky/CVE-202122986-EXP](https://github.com/yaunsky/CVE-202122986-EXP)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---



---

## POC #9

**来源**: [CVE-2021-22986-dotslashed_CVE-2021-22986.md](../2021/CVE-2021-22986-dotslashed_CVE-2021-22986.md)

## CVE-2021-22986 F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问 iControl REST API 接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**根据漏洞库信息、搜索引擎结果（特别是NCC Group的分析）和已知的利用情况，此漏洞利用的有效性很高。有报告表明该漏洞已被积极利用于Mirai僵尸网络攻击。

**投毒风险：**提供的POC代码（README.md）本身只是一个使用说明，用于检测批量IP地址是否受到此漏洞影响。因此，它本身不包含任何恶意代码，因此投毒的风险较低，但是如果使用者下载了其他的POC代码，则需要对代码进行分析，以保证没有投毒代码。 这里给出的投毒风险百分比是根据POC代码本身进行评估的，考虑到使用者可能会从其他来源获取恶意POC，这里给出的投毒概率为10%。

**利用方式：**

1.  确定目标F5 BIG-IP/BIG-IQ设备的IP地址和端口。
2.  向 iControl REST API 发送特制的HTTP请求，其中包含要执行的命令。由于漏洞未经身份验证，因此攻击者不需要提供任何凭据。
3.  服务器执行请求中包含的命令，并将结果返回给攻击者。 

漏洞利用的关键是构造恶意的HTTP请求，该请求能够绕过任何现有的安全检查，并在服务器上执行任意命令。Packet Storm Security提供了相关的漏洞利用细节，可用于构造此类请求。

**总结：**该漏洞非常危险，因为它允许未经身份验证的攻击者在受影响的F5设备上执行任意命令。由于该漏洞已经被积极利用，因此强烈建议受影响的用户尽快升级到修补后的版本。

**项目地址:** [dotslashed/CVE-2021-22986](https://github.com/dotslashed/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #10

**来源**: [CVE-2021-22986-huydung26_CVE-2021-22986.md](../2021/CVE-2021-22986-huydung26_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST未授权远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 漏洞是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口存在的一个未授权远程命令执行漏洞。攻击者可以通过发送特制的请求到 iControl REST 接口，从而在目标系统上执行任意命令。根据提供的POC代码，利用方式主要分两步：

1.  **获取Token（方法一）:**
    *   首先，向`/mgmt/shared/authn/login`接口发送POST请求，尝试获取一个身份验证Token。这个请求中包含一个默认的用户名（admin）以及一些特定的参数。
    *   如果成功获取到Token，POC代码会提取该Token，并将其用于后续的命令执行。

2.  **执行命令:**
    *   利用获取到的Token，向`/mgmt/tm/util/bash`接口发送POST请求，并在请求体中包含要执行的命令。命令的结果会从响应中提取并显示。

**方法二（备选方案）：**
    *   如果获取Token失败，POC代码会尝试使用一个硬编码的Basic Auth头（`Authorization: Basic YWRtaW46QVNhc1M=`，对应admin:ASasS）。
    *   同样，通过向`/mgmt/tm/util/bash`接口发送POST请求来执行命令。

**有效性：**
根据提供的漏洞信息和POC代码，此漏洞利用代码是有效的，因为
*   漏洞库信息明确指出存在未授权的远程命令执行漏洞
*   搜索引擎结果表明该漏洞已被积极利用
*   POC代码尝试通过REST API执行系统命令

**投毒风险：**
存在较低的投毒风险（10%），主要基于以下几点考虑：
*   **代理配置：** POC代码包含使用代理的配置`proxy_url = "http://127.0.0.1:8080"`，如果用户没有意识到这一点，可能会将流量通过攻击者控制的代理服务器，从而泄露敏感信息或被中间人攻击。
*   **硬编码凭据：** 虽然提供了默认的用户名（admin）和密码`Authorization: Basic YWRtaW46QVNhc1M=`，但这只是为了方便POC的执行，并非恶意的后门植入。
*   **异常处理：** 在连接失败时，代码会尝试绕过代理。这看起来像是为了保证POC的可用性，但如果目标环境必须通过代理才能访问，这可能导致信息泄露。
总而言之，POC的主要目的是演示漏洞的利用，但使用代理和硬编码凭据可能会带来一定的安全风险，因此存在一定投毒风险, 建议用户在使用时仔细检查和修改代理设置，并避免在生产环境中使用默认凭据。

**项目地址:** [huydung26/CVE-2021-22986](https://github.com/huydung26/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #11

**来源**: [CVE-2021-22986-kiri-48_CVE-2021-22986.md](../2021/CVE-2021-22986-kiri-48_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标存在未授权访问的iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 中 iControl REST 接口的一个未授权远程命令执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过向 iControl REST API 发送特制的请求来执行任意系统命令。POC代码通过两个阶段进行利用。第一阶段尝试利用`/mgmt/shared/authn/login`接口泄露一个token，如果失败，则尝试使用固定的Basic认证头绕过认证。获取token后，使用`/mgmt/tm/util/bash`接口执行命令。由于代码逻辑稍显复杂, 存在一小部分投毒的可能性, 主要风险在于代码的容错部分，即第一阶段尝试利用失败后，可能由于环境差异，导致硬编码的header认证失效，从而利用失败。

**有效性：**
根据公开信息，该漏洞被广泛利用，POC代码有效。

**投毒风险：**
该POC代码主要利用漏洞实现远程命令执行，并未发现明显的恶意代码。但其中包含连接目标URL的操作，存在一定风险。如果攻击者控制了代码托管平台或参与了代码的修改，理论上可以植入恶意代码，例如收集目标信息、传播恶意软件等。但是从代码本身来看，直接投毒的概率较低，因此评估为10%。

**利用方式：**
1.  **利用 iControl REST 接口：** 漏洞存在于 iControl REST 接口，攻击者需要能够访问该接口。
2.  **绕过身份验证：**  攻击者通过构造特殊的请求绕过身份验证。
3.  **执行命令：**  攻击者在绕过身份验证后，可以通过 `/mgmt/tm/util/bash` 接口执行任意系统命令。

**排序优先级依据：**
1.  **搜索引擎结果：** 提供了漏洞被实际利用的信息，表明漏洞具有现实危害。
2.  **漏洞利用代码：**  POC 代码展示了漏洞的利用方法，验证了漏洞的可行性。
3.  **漏洞库信息：**  提供了漏洞的基本信息和受影响的版本范围。

**项目地址:** [kiri-48/CVE-2021-22986](https://github.com/kiri-48/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #12

**来源**: [CVE-2021-22986-microvorld_CVE-2021-22986.md](../2021/CVE-2021-22986-microvorld_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ 且 iControl REST 接口开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-22986 漏洞存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程攻击者执行任意命令。

**漏洞利用方式：**

1.  **获取 Token (Method 1):**  首先，POC尝试利用 `/mgmt/shared/authn/login` 接口泄漏认证 Token。它发送一个包含特定 `username` 和 `loginReference` 的 POST 请求，期望服务器返回一个有效的 Token。
2.  **执行命令:**  如果成功获取 Token，则使用该 Token 在 `/mgmt/tm/util/bash` 接口上执行命令。它构造一个包含 `command: run` 和 `utilCmdArgs` 的 JSON 数据，并将要执行的命令嵌入到 `utilCmdArgs` 中。
3. **另一种方式 (Method 2):** 如果无法通过Method 1获取Token,POC会尝试使用硬编码的Authorization头 'Authorization': 'Basic YWRtaW46QVNhc1M=' 结合X-F5-Auth-Token为空的方式，尝试在 `/mgmt/tm/util/bash` 接口上执行命令。

**有效性：**

根据漏洞描述、搜索结果（特别是 NCC Group 的报告指出无需 SSRF 即可利用）以及提供的 PoC 代码，该漏洞利用的有效性很高。存在多个公开的 PoC，并且该漏洞已被积极利用。

**投毒风险：**

该PoC主要功能为漏洞验证和利用，未发现明显的恶意行为。`README.md` 文件仅包含基本的使用说明。代码结构清晰，主要操作为发送 HTTP 请求和处理响应。该POC代码中的投毒风险较低，为1%。考虑到公开的 PoC 旨在利用漏洞，而非进行恶意活动，因此投毒的可能性较小。硬编码的Basic认证 `admin:ASasS=`也比较常见。

**总结：**

CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意命令。提供的 PoC 代码通过两种方式，首先是尝试泄漏Token，如果失败则尝试通过Basic认证结合X-F5-Auth-Token为空的方式，利用 `/mgmt/tm/util/bash` 接口执行命令。
根据现有信息，该漏洞利用的有效性很高，并且该漏洞在野外已被利用。PoC代码本身似乎没有明显的投毒行为，但使用者应始终注意从不受信任的来源获取代码的风险。

**项目地址:** [microvorld/CVE-2021-22986](https://github.com/microvorld/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #13

**来源**: [CVE-2021-22986-safesword_F5_RCE.md](../2021/CVE-2021-22986-safesword_F5_RCE.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ，并且可以访问 iControl REST 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以通过向易受攻击的 iControl REST 端点发送特制的 POST 请求来利用此漏洞，从而在目标系统上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明，该漏洞已被积极利用，并且有公开可用的 POC 代码。

**投毒风险：**

分析提供的 POC 代码 `f5_rce.py`，没有发现明显的恶意代码。该脚本使用 `requests` 库发送 HTTP 请求，并根据响应判断漏洞是否存在。`README.md` 文件描述了脚本的使用方法，并指出了该 POC 可能存在的局限性。但是，仍然存在细微的投毒风险，例如：

*   **依赖风险：** 脚本依赖 `requests` 库。如果攻击者控制了该库的安装源，可能会植入恶意代码。
*   **命令注入：** 脚本使用 `format` 函数格式化命令，可能存在命令注入的风险，但可能性较低，因为参数 `--command` 的执行，需要用户进行主动设置。
*   **输出文件：** `save_file` 函数会将目标 URL 保存到文件中，可能造成信息泄露。该文件默认保存在攻击者机器上，影响较小。

因此，投毒风险较低，约为 5%。

**利用方式：**

1.  攻击者向目标 F5 BIG-IP/BIG-IQ 设备的 iControl REST 接口发送特制的 POST 请求。
2.  请求的 payload 包含要执行的命令。
3.  由于漏洞存在于身份验证绕过中，因此攻击者无需提供有效的身份验证凭据即可发送此请求。
4.  目标设备执行命令，并将结果返回给攻击者。

提供的 POC 代码 `f5_rce.py` 实现了此利用方式。该脚本接受目标 URL 和要执行的命令作为参数，并发送相应的 POST 请求。

**项目地址:** [safesword/F5_RCE](https://github.com/safesword/F5_RCE)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #14

**来源**: [CVE-2021-22986-yaunsky_CVE-202122986-EXP.md](../2021/CVE-2021-22986-yaunsky_CVE-202122986-EXP.md)

## CVE-2021-22986-F5 BIG-IP iControl REST 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ设备中iControl REST接口存在的一个未经身份验证的远程命令执行漏洞。攻击者可以通过发送特制的HTTP请求到/mgmt/tm/util/bash端点来执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果显示，该漏洞在野外被积极利用，并且存在公开的PoC代码。提供的Python脚本`CVE202122986.py`实现了该漏洞的利用，通过向目标URL的`/mgmt/tm/util/bash`端点发送包含恶意命令的POST请求，从而实现远程命令执行。

**投毒风险：**

经过对提供的Python脚本`CVE202122986.py`的分析，发现以下几点可能存在的风险：

1.  **硬编码的认证信息：** 脚本中使用了硬编码的`Authorization: Basic YWRtaW46QVNhc1M=`头，虽然是默认的用户名密码，但如果被恶意修改，可能会导致利用失败，或者留下后门。
2.  **命令执行方式：** 脚本使用了`base64`编码来绕过某些检测，虽然增加了命令执行的灵活性，但也可能被用于执行更复杂的恶意命令。
3.  **错误处理：** 脚本中的错误处理比较简单，可能会在出现异常时直接退出，无法进行更深入的利用。

综合评估，该脚本本身存在一定的风险，例如使用硬编码的认证信息，以及潜在的命令执行风险。考虑到脚本的目的是执行任意命令，所以将payload隐藏在命令中具有一定的隐蔽性。因此，存在投毒风险的可能性较高，大约为10%。

**利用方式：**

1.  **发送POST请求：** 攻击者构造一个恶意的POST请求，目标URL为存在漏洞的F5 BIG-IP或BIG-IQ设备的`/mgmt/tm/util/bash`端点。
2.  **设置请求头：** 设置必要的请求头，包括`Authorization`（包含Base64编码的用户名密码），`X-F5-Auth-Token`（可能为空），以及`Content-Type: application/json`。
3.  **构造JSON数据：** 在POST请求的body中，构造一个JSON数据，包含`command`和`utilCmdArgs`字段。`command`字段设置为`run`，`utilCmdArgs`字段包含要执行的命令，例如`'-c id'`。
4.  **发送请求并执行命令：** 将构造好的POST请求发送到目标URL，目标设备将执行`utilCmdArgs`中指定的命令，并将结果返回在响应的`commandResult`字段中。
5.  **命令执行：** 使用`-c`参数执行单条命令，或者利用`base64`编码执行更复杂的命令，例如反弹shell等。


**项目地址:** [yaunsky/CVE-202122986-EXP](https://github.com/yaunsky/CVE-202122986-EXP)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---



---

## POC #9

**来源**: [CVE-2021-22986-dotslashed_CVE-2021-22986.md](../2021/CVE-2021-22986-dotslashed_CVE-2021-22986.md)

## CVE-2021-22986 F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问 iControl REST API 接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**根据漏洞库信息、搜索引擎结果（特别是NCC Group的分析）和已知的利用情况，此漏洞利用的有效性很高。有报告表明该漏洞已被积极利用于Mirai僵尸网络攻击。

**投毒风险：**提供的POC代码（README.md）本身只是一个使用说明，用于检测批量IP地址是否受到此漏洞影响。因此，它本身不包含任何恶意代码，因此投毒的风险较低，但是如果使用者下载了其他的POC代码，则需要对代码进行分析，以保证没有投毒代码。 这里给出的投毒风险百分比是根据POC代码本身进行评估的，考虑到使用者可能会从其他来源获取恶意POC，这里给出的投毒概率为10%。

**利用方式：**

1.  确定目标F5 BIG-IP/BIG-IQ设备的IP地址和端口。
2.  向 iControl REST API 发送特制的HTTP请求，其中包含要执行的命令。由于漏洞未经身份验证，因此攻击者不需要提供任何凭据。
3.  服务器执行请求中包含的命令，并将结果返回给攻击者。 

漏洞利用的关键是构造恶意的HTTP请求，该请求能够绕过任何现有的安全检查，并在服务器上执行任意命令。Packet Storm Security提供了相关的漏洞利用细节，可用于构造此类请求。

**总结：**该漏洞非常危险，因为它允许未经身份验证的攻击者在受影响的F5设备上执行任意命令。由于该漏洞已经被积极利用，因此强烈建议受影响的用户尽快升级到修补后的版本。

**项目地址:** [dotslashed/CVE-2021-22986](https://github.com/dotslashed/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #10

**来源**: [CVE-2021-22986-huydung26_CVE-2021-22986.md](../2021/CVE-2021-22986-huydung26_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST未授权远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 漏洞是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口存在的一个未授权远程命令执行漏洞。攻击者可以通过发送特制的请求到 iControl REST 接口，从而在目标系统上执行任意命令。根据提供的POC代码，利用方式主要分两步：

1.  **获取Token（方法一）:**
    *   首先，向`/mgmt/shared/authn/login`接口发送POST请求，尝试获取一个身份验证Token。这个请求中包含一个默认的用户名（admin）以及一些特定的参数。
    *   如果成功获取到Token，POC代码会提取该Token，并将其用于后续的命令执行。

2.  **执行命令:**
    *   利用获取到的Token，向`/mgmt/tm/util/bash`接口发送POST请求，并在请求体中包含要执行的命令。命令的结果会从响应中提取并显示。

**方法二（备选方案）：**
    *   如果获取Token失败，POC代码会尝试使用一个硬编码的Basic Auth头（`Authorization: Basic YWRtaW46QVNhc1M=`，对应admin:ASasS）。
    *   同样，通过向`/mgmt/tm/util/bash`接口发送POST请求来执行命令。

**有效性：**
根据提供的漏洞信息和POC代码，此漏洞利用代码是有效的，因为
*   漏洞库信息明确指出存在未授权的远程命令执行漏洞
*   搜索引擎结果表明该漏洞已被积极利用
*   POC代码尝试通过REST API执行系统命令

**投毒风险：**
存在较低的投毒风险（10%），主要基于以下几点考虑：
*   **代理配置：** POC代码包含使用代理的配置`proxy_url = "http://127.0.0.1:8080"`，如果用户没有意识到这一点，可能会将流量通过攻击者控制的代理服务器，从而泄露敏感信息或被中间人攻击。
*   **硬编码凭据：** 虽然提供了默认的用户名（admin）和密码`Authorization: Basic YWRtaW46QVNhc1M=`，但这只是为了方便POC的执行，并非恶意的后门植入。
*   **异常处理：** 在连接失败时，代码会尝试绕过代理。这看起来像是为了保证POC的可用性，但如果目标环境必须通过代理才能访问，这可能导致信息泄露。
总而言之，POC的主要目的是演示漏洞的利用，但使用代理和硬编码凭据可能会带来一定的安全风险，因此存在一定投毒风险, 建议用户在使用时仔细检查和修改代理设置，并避免在生产环境中使用默认凭据。

**项目地址:** [huydung26/CVE-2021-22986](https://github.com/huydung26/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #11

**来源**: [CVE-2021-22986-kiri-48_CVE-2021-22986.md](../2021/CVE-2021-22986-kiri-48_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标存在未授权访问的iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 中 iControl REST 接口的一个未授权远程命令执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过向 iControl REST API 发送特制的请求来执行任意系统命令。POC代码通过两个阶段进行利用。第一阶段尝试利用`/mgmt/shared/authn/login`接口泄露一个token，如果失败，则尝试使用固定的Basic认证头绕过认证。获取token后，使用`/mgmt/tm/util/bash`接口执行命令。由于代码逻辑稍显复杂, 存在一小部分投毒的可能性, 主要风险在于代码的容错部分，即第一阶段尝试利用失败后，可能由于环境差异，导致硬编码的header认证失效，从而利用失败。

**有效性：**
根据公开信息，该漏洞被广泛利用，POC代码有效。

**投毒风险：**
该POC代码主要利用漏洞实现远程命令执行，并未发现明显的恶意代码。但其中包含连接目标URL的操作，存在一定风险。如果攻击者控制了代码托管平台或参与了代码的修改，理论上可以植入恶意代码，例如收集目标信息、传播恶意软件等。但是从代码本身来看，直接投毒的概率较低，因此评估为10%。

**利用方式：**
1.  **利用 iControl REST 接口：** 漏洞存在于 iControl REST 接口，攻击者需要能够访问该接口。
2.  **绕过身份验证：**  攻击者通过构造特殊的请求绕过身份验证。
3.  **执行命令：**  攻击者在绕过身份验证后，可以通过 `/mgmt/tm/util/bash` 接口执行任意系统命令。

**排序优先级依据：**
1.  **搜索引擎结果：** 提供了漏洞被实际利用的信息，表明漏洞具有现实危害。
2.  **漏洞利用代码：**  POC 代码展示了漏洞的利用方法，验证了漏洞的可行性。
3.  **漏洞库信息：**  提供了漏洞的基本信息和受影响的版本范围。

**项目地址:** [kiri-48/CVE-2021-22986](https://github.com/kiri-48/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #12

**来源**: [CVE-2021-22986-microvorld_CVE-2021-22986.md](../2021/CVE-2021-22986-microvorld_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ 且 iControl REST 接口开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-22986 漏洞存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程攻击者执行任意命令。

**漏洞利用方式：**

1.  **获取 Token (Method 1):**  首先，POC尝试利用 `/mgmt/shared/authn/login` 接口泄漏认证 Token。它发送一个包含特定 `username` 和 `loginReference` 的 POST 请求，期望服务器返回一个有效的 Token。
2.  **执行命令:**  如果成功获取 Token，则使用该 Token 在 `/mgmt/tm/util/bash` 接口上执行命令。它构造一个包含 `command: run` 和 `utilCmdArgs` 的 JSON 数据，并将要执行的命令嵌入到 `utilCmdArgs` 中。
3. **另一种方式 (Method 2):** 如果无法通过Method 1获取Token,POC会尝试使用硬编码的Authorization头 'Authorization': 'Basic YWRtaW46QVNhc1M=' 结合X-F5-Auth-Token为空的方式，尝试在 `/mgmt/tm/util/bash` 接口上执行命令。

**有效性：**

根据漏洞描述、搜索结果（特别是 NCC Group 的报告指出无需 SSRF 即可利用）以及提供的 PoC 代码，该漏洞利用的有效性很高。存在多个公开的 PoC，并且该漏洞已被积极利用。

**投毒风险：**

该PoC主要功能为漏洞验证和利用，未发现明显的恶意行为。`README.md` 文件仅包含基本的使用说明。代码结构清晰，主要操作为发送 HTTP 请求和处理响应。该POC代码中的投毒风险较低，为1%。考虑到公开的 PoC 旨在利用漏洞，而非进行恶意活动，因此投毒的可能性较小。硬编码的Basic认证 `admin:ASasS=`也比较常见。

**总结：**

CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意命令。提供的 PoC 代码通过两种方式，首先是尝试泄漏Token，如果失败则尝试通过Basic认证结合X-F5-Auth-Token为空的方式，利用 `/mgmt/tm/util/bash` 接口执行命令。
根据现有信息，该漏洞利用的有效性很高，并且该漏洞在野外已被利用。PoC代码本身似乎没有明显的投毒行为，但使用者应始终注意从不受信任的来源获取代码的风险。

**项目地址:** [microvorld/CVE-2021-22986](https://github.com/microvorld/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #13

**来源**: [CVE-2021-22986-safesword_F5_RCE.md](../2021/CVE-2021-22986-safesword_F5_RCE.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ，并且可以访问 iControl REST 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以通过向易受攻击的 iControl REST 端点发送特制的 POST 请求来利用此漏洞，从而在目标系统上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明，该漏洞已被积极利用，并且有公开可用的 POC 代码。

**投毒风险：**

分析提供的 POC 代码 `f5_rce.py`，没有发现明显的恶意代码。该脚本使用 `requests` 库发送 HTTP 请求，并根据响应判断漏洞是否存在。`README.md` 文件描述了脚本的使用方法，并指出了该 POC 可能存在的局限性。但是，仍然存在细微的投毒风险，例如：

*   **依赖风险：** 脚本依赖 `requests` 库。如果攻击者控制了该库的安装源，可能会植入恶意代码。
*   **命令注入：** 脚本使用 `format` 函数格式化命令，可能存在命令注入的风险，但可能性较低，因为参数 `--command` 的执行，需要用户进行主动设置。
*   **输出文件：** `save_file` 函数会将目标 URL 保存到文件中，可能造成信息泄露。该文件默认保存在攻击者机器上，影响较小。

因此，投毒风险较低，约为 5%。

**利用方式：**

1.  攻击者向目标 F5 BIG-IP/BIG-IQ 设备的 iControl REST 接口发送特制的 POST 请求。
2.  请求的 payload 包含要执行的命令。
3.  由于漏洞存在于身份验证绕过中，因此攻击者无需提供有效的身份验证凭据即可发送此请求。
4.  目标设备执行命令，并将结果返回给攻击者。

提供的 POC 代码 `f5_rce.py` 实现了此利用方式。该脚本接受目标 URL 和要执行的命令作为参数，并发送相应的 POST 请求。

**项目地址:** [safesword/F5_RCE](https://github.com/safesword/F5_RCE)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #14

**来源**: [CVE-2021-22986-yaunsky_CVE-202122986-EXP.md](../2021/CVE-2021-22986-yaunsky_CVE-202122986-EXP.md)

## CVE-2021-22986-F5 BIG-IP iControl REST 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ设备中iControl REST接口存在的一个未经身份验证的远程命令执行漏洞。攻击者可以通过发送特制的HTTP请求到/mgmt/tm/util/bash端点来执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果显示，该漏洞在野外被积极利用，并且存在公开的PoC代码。提供的Python脚本`CVE202122986.py`实现了该漏洞的利用，通过向目标URL的`/mgmt/tm/util/bash`端点发送包含恶意命令的POST请求，从而实现远程命令执行。

**投毒风险：**

经过对提供的Python脚本`CVE202122986.py`的分析，发现以下几点可能存在的风险：

1.  **硬编码的认证信息：** 脚本中使用了硬编码的`Authorization: Basic YWRtaW46QVNhc1M=`头，虽然是默认的用户名密码，但如果被恶意修改，可能会导致利用失败，或者留下后门。
2.  **命令执行方式：** 脚本使用了`base64`编码来绕过某些检测，虽然增加了命令执行的灵活性，但也可能被用于执行更复杂的恶意命令。
3.  **错误处理：** 脚本中的错误处理比较简单，可能会在出现异常时直接退出，无法进行更深入的利用。

综合评估，该脚本本身存在一定的风险，例如使用硬编码的认证信息，以及潜在的命令执行风险。考虑到脚本的目的是执行任意命令，所以将payload隐藏在命令中具有一定的隐蔽性。因此，存在投毒风险的可能性较高，大约为10%。

**利用方式：**

1.  **发送POST请求：** 攻击者构造一个恶意的POST请求，目标URL为存在漏洞的F5 BIG-IP或BIG-IQ设备的`/mgmt/tm/util/bash`端点。
2.  **设置请求头：** 设置必要的请求头，包括`Authorization`（包含Base64编码的用户名密码），`X-F5-Auth-Token`（可能为空），以及`Content-Type: application/json`。
3.  **构造JSON数据：** 在POST请求的body中，构造一个JSON数据，包含`command`和`utilCmdArgs`字段。`command`字段设置为`run`，`utilCmdArgs`字段包含要执行的命令，例如`'-c id'`。
4.  **发送请求并执行命令：** 将构造好的POST请求发送到目标URL，目标设备将执行`utilCmdArgs`中指定的命令，并将结果返回在响应的`commandResult`字段中。
5.  **命令执行：** 使用`-c`参数执行单条命令，或者利用`base64`编码执行更复杂的命令，例如反弹shell等。


**项目地址:** [yaunsky/CVE-202122986-EXP](https://github.com/yaunsky/CVE-202122986-EXP)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---



---

## POC #9

**来源**: [CVE-2021-22986-dotslashed_CVE-2021-22986.md](../2021/CVE-2021-22986-dotslashed_CVE-2021-22986.md)

## CVE-2021-22986 F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问 iControl REST API 接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**根据漏洞库信息、搜索引擎结果（特别是NCC Group的分析）和已知的利用情况，此漏洞利用的有效性很高。有报告表明该漏洞已被积极利用于Mirai僵尸网络攻击。

**投毒风险：**提供的POC代码（README.md）本身只是一个使用说明，用于检测批量IP地址是否受到此漏洞影响。因此，它本身不包含任何恶意代码，因此投毒的风险较低，但是如果使用者下载了其他的POC代码，则需要对代码进行分析，以保证没有投毒代码。 这里给出的投毒风险百分比是根据POC代码本身进行评估的，考虑到使用者可能会从其他来源获取恶意POC，这里给出的投毒概率为10%。

**利用方式：**

1.  确定目标F5 BIG-IP/BIG-IQ设备的IP地址和端口。
2.  向 iControl REST API 发送特制的HTTP请求，其中包含要执行的命令。由于漏洞未经身份验证，因此攻击者不需要提供任何凭据。
3.  服务器执行请求中包含的命令，并将结果返回给攻击者。 

漏洞利用的关键是构造恶意的HTTP请求，该请求能够绕过任何现有的安全检查，并在服务器上执行任意命令。Packet Storm Security提供了相关的漏洞利用细节，可用于构造此类请求。

**总结：**该漏洞非常危险，因为它允许未经身份验证的攻击者在受影响的F5设备上执行任意命令。由于该漏洞已经被积极利用，因此强烈建议受影响的用户尽快升级到修补后的版本。

**项目地址:** [dotslashed/CVE-2021-22986](https://github.com/dotslashed/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #10

**来源**: [CVE-2021-22986-huydung26_CVE-2021-22986.md](../2021/CVE-2021-22986-huydung26_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST未授权远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 漏洞是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口存在的一个未授权远程命令执行漏洞。攻击者可以通过发送特制的请求到 iControl REST 接口，从而在目标系统上执行任意命令。根据提供的POC代码，利用方式主要分两步：

1.  **获取Token（方法一）:**
    *   首先，向`/mgmt/shared/authn/login`接口发送POST请求，尝试获取一个身份验证Token。这个请求中包含一个默认的用户名（admin）以及一些特定的参数。
    *   如果成功获取到Token，POC代码会提取该Token，并将其用于后续的命令执行。

2.  **执行命令:**
    *   利用获取到的Token，向`/mgmt/tm/util/bash`接口发送POST请求，并在请求体中包含要执行的命令。命令的结果会从响应中提取并显示。

**方法二（备选方案）：**
    *   如果获取Token失败，POC代码会尝试使用一个硬编码的Basic Auth头（`Authorization: Basic YWRtaW46QVNhc1M=`，对应admin:ASasS）。
    *   同样，通过向`/mgmt/tm/util/bash`接口发送POST请求来执行命令。

**有效性：**
根据提供的漏洞信息和POC代码，此漏洞利用代码是有效的，因为
*   漏洞库信息明确指出存在未授权的远程命令执行漏洞
*   搜索引擎结果表明该漏洞已被积极利用
*   POC代码尝试通过REST API执行系统命令

**投毒风险：**
存在较低的投毒风险（10%），主要基于以下几点考虑：
*   **代理配置：** POC代码包含使用代理的配置`proxy_url = "http://127.0.0.1:8080"`，如果用户没有意识到这一点，可能会将流量通过攻击者控制的代理服务器，从而泄露敏感信息或被中间人攻击。
*   **硬编码凭据：** 虽然提供了默认的用户名（admin）和密码`Authorization: Basic YWRtaW46QVNhc1M=`，但这只是为了方便POC的执行，并非恶意的后门植入。
*   **异常处理：** 在连接失败时，代码会尝试绕过代理。这看起来像是为了保证POC的可用性，但如果目标环境必须通过代理才能访问，这可能导致信息泄露。
总而言之，POC的主要目的是演示漏洞的利用，但使用代理和硬编码凭据可能会带来一定的安全风险，因此存在一定投毒风险, 建议用户在使用时仔细检查和修改代理设置，并避免在生产环境中使用默认凭据。

**项目地址:** [huydung26/CVE-2021-22986](https://github.com/huydung26/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #11

**来源**: [CVE-2021-22986-kiri-48_CVE-2021-22986.md](../2021/CVE-2021-22986-kiri-48_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标存在未授权访问的iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 中 iControl REST 接口的一个未授权远程命令执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过向 iControl REST API 发送特制的请求来执行任意系统命令。POC代码通过两个阶段进行利用。第一阶段尝试利用`/mgmt/shared/authn/login`接口泄露一个token，如果失败，则尝试使用固定的Basic认证头绕过认证。获取token后，使用`/mgmt/tm/util/bash`接口执行命令。由于代码逻辑稍显复杂, 存在一小部分投毒的可能性, 主要风险在于代码的容错部分，即第一阶段尝试利用失败后，可能由于环境差异，导致硬编码的header认证失效，从而利用失败。

**有效性：**
根据公开信息，该漏洞被广泛利用，POC代码有效。

**投毒风险：**
该POC代码主要利用漏洞实现远程命令执行，并未发现明显的恶意代码。但其中包含连接目标URL的操作，存在一定风险。如果攻击者控制了代码托管平台或参与了代码的修改，理论上可以植入恶意代码，例如收集目标信息、传播恶意软件等。但是从代码本身来看，直接投毒的概率较低，因此评估为10%。

**利用方式：**
1.  **利用 iControl REST 接口：** 漏洞存在于 iControl REST 接口，攻击者需要能够访问该接口。
2.  **绕过身份验证：**  攻击者通过构造特殊的请求绕过身份验证。
3.  **执行命令：**  攻击者在绕过身份验证后，可以通过 `/mgmt/tm/util/bash` 接口执行任意系统命令。

**排序优先级依据：**
1.  **搜索引擎结果：** 提供了漏洞被实际利用的信息，表明漏洞具有现实危害。
2.  **漏洞利用代码：**  POC 代码展示了漏洞的利用方法，验证了漏洞的可行性。
3.  **漏洞库信息：**  提供了漏洞的基本信息和受影响的版本范围。

**项目地址:** [kiri-48/CVE-2021-22986](https://github.com/kiri-48/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #12

**来源**: [CVE-2021-22986-microvorld_CVE-2021-22986.md](../2021/CVE-2021-22986-microvorld_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ 且 iControl REST 接口开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-22986 漏洞存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程攻击者执行任意命令。

**漏洞利用方式：**

1.  **获取 Token (Method 1):**  首先，POC尝试利用 `/mgmt/shared/authn/login` 接口泄漏认证 Token。它发送一个包含特定 `username` 和 `loginReference` 的 POST 请求，期望服务器返回一个有效的 Token。
2.  **执行命令:**  如果成功获取 Token，则使用该 Token 在 `/mgmt/tm/util/bash` 接口上执行命令。它构造一个包含 `command: run` 和 `utilCmdArgs` 的 JSON 数据，并将要执行的命令嵌入到 `utilCmdArgs` 中。
3. **另一种方式 (Method 2):** 如果无法通过Method 1获取Token,POC会尝试使用硬编码的Authorization头 'Authorization': 'Basic YWRtaW46QVNhc1M=' 结合X-F5-Auth-Token为空的方式，尝试在 `/mgmt/tm/util/bash` 接口上执行命令。

**有效性：**

根据漏洞描述、搜索结果（特别是 NCC Group 的报告指出无需 SSRF 即可利用）以及提供的 PoC 代码，该漏洞利用的有效性很高。存在多个公开的 PoC，并且该漏洞已被积极利用。

**投毒风险：**

该PoC主要功能为漏洞验证和利用，未发现明显的恶意行为。`README.md` 文件仅包含基本的使用说明。代码结构清晰，主要操作为发送 HTTP 请求和处理响应。该POC代码中的投毒风险较低，为1%。考虑到公开的 PoC 旨在利用漏洞，而非进行恶意活动，因此投毒的可能性较小。硬编码的Basic认证 `admin:ASasS=`也比较常见。

**总结：**

CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意命令。提供的 PoC 代码通过两种方式，首先是尝试泄漏Token，如果失败则尝试通过Basic认证结合X-F5-Auth-Token为空的方式，利用 `/mgmt/tm/util/bash` 接口执行命令。
根据现有信息，该漏洞利用的有效性很高，并且该漏洞在野外已被利用。PoC代码本身似乎没有明显的投毒行为，但使用者应始终注意从不受信任的来源获取代码的风险。

**项目地址:** [microvorld/CVE-2021-22986](https://github.com/microvorld/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #13

**来源**: [CVE-2021-22986-safesword_F5_RCE.md](../2021/CVE-2021-22986-safesword_F5_RCE.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ，并且可以访问 iControl REST 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以通过向易受攻击的 iControl REST 端点发送特制的 POST 请求来利用此漏洞，从而在目标系统上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明，该漏洞已被积极利用，并且有公开可用的 POC 代码。

**投毒风险：**

分析提供的 POC 代码 `f5_rce.py`，没有发现明显的恶意代码。该脚本使用 `requests` 库发送 HTTP 请求，并根据响应判断漏洞是否存在。`README.md` 文件描述了脚本的使用方法，并指出了该 POC 可能存在的局限性。但是，仍然存在细微的投毒风险，例如：

*   **依赖风险：** 脚本依赖 `requests` 库。如果攻击者控制了该库的安装源，可能会植入恶意代码。
*   **命令注入：** 脚本使用 `format` 函数格式化命令，可能存在命令注入的风险，但可能性较低，因为参数 `--command` 的执行，需要用户进行主动设置。
*   **输出文件：** `save_file` 函数会将目标 URL 保存到文件中，可能造成信息泄露。该文件默认保存在攻击者机器上，影响较小。

因此，投毒风险较低，约为 5%。

**利用方式：**

1.  攻击者向目标 F5 BIG-IP/BIG-IQ 设备的 iControl REST 接口发送特制的 POST 请求。
2.  请求的 payload 包含要执行的命令。
3.  由于漏洞存在于身份验证绕过中，因此攻击者无需提供有效的身份验证凭据即可发送此请求。
4.  目标设备执行命令，并将结果返回给攻击者。

提供的 POC 代码 `f5_rce.py` 实现了此利用方式。该脚本接受目标 URL 和要执行的命令作为参数，并发送相应的 POST 请求。

**项目地址:** [safesword/F5_RCE](https://github.com/safesword/F5_RCE)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #14

**来源**: [CVE-2021-22986-yaunsky_CVE-202122986-EXP.md](../2021/CVE-2021-22986-yaunsky_CVE-202122986-EXP.md)

## CVE-2021-22986-F5 BIG-IP iControl REST 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ设备中iControl REST接口存在的一个未经身份验证的远程命令执行漏洞。攻击者可以通过发送特制的HTTP请求到/mgmt/tm/util/bash端点来执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果显示，该漏洞在野外被积极利用，并且存在公开的PoC代码。提供的Python脚本`CVE202122986.py`实现了该漏洞的利用，通过向目标URL的`/mgmt/tm/util/bash`端点发送包含恶意命令的POST请求，从而实现远程命令执行。

**投毒风险：**

经过对提供的Python脚本`CVE202122986.py`的分析，发现以下几点可能存在的风险：

1.  **硬编码的认证信息：** 脚本中使用了硬编码的`Authorization: Basic YWRtaW46QVNhc1M=`头，虽然是默认的用户名密码，但如果被恶意修改，可能会导致利用失败，或者留下后门。
2.  **命令执行方式：** 脚本使用了`base64`编码来绕过某些检测，虽然增加了命令执行的灵活性，但也可能被用于执行更复杂的恶意命令。
3.  **错误处理：** 脚本中的错误处理比较简单，可能会在出现异常时直接退出，无法进行更深入的利用。

综合评估，该脚本本身存在一定的风险，例如使用硬编码的认证信息，以及潜在的命令执行风险。考虑到脚本的目的是执行任意命令，所以将payload隐藏在命令中具有一定的隐蔽性。因此，存在投毒风险的可能性较高，大约为10%。

**利用方式：**

1.  **发送POST请求：** 攻击者构造一个恶意的POST请求，目标URL为存在漏洞的F5 BIG-IP或BIG-IQ设备的`/mgmt/tm/util/bash`端点。
2.  **设置请求头：** 设置必要的请求头，包括`Authorization`（包含Base64编码的用户名密码），`X-F5-Auth-Token`（可能为空），以及`Content-Type: application/json`。
3.  **构造JSON数据：** 在POST请求的body中，构造一个JSON数据，包含`command`和`utilCmdArgs`字段。`command`字段设置为`run`，`utilCmdArgs`字段包含要执行的命令，例如`'-c id'`。
4.  **发送请求并执行命令：** 将构造好的POST请求发送到目标URL，目标设备将执行`utilCmdArgs`中指定的命令，并将结果返回在响应的`commandResult`字段中。
5.  **命令执行：** 使用`-c`参数执行单条命令，或者利用`base64`编码执行更复杂的命令，例如反弹shell等。


**项目地址:** [yaunsky/CVE-202122986-EXP](https://github.com/yaunsky/CVE-202122986-EXP)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---



---

## POC #9

**来源**: [CVE-2021-22986-dotslashed_CVE-2021-22986.md](../2021/CVE-2021-22986-dotslashed_CVE-2021-22986.md)

## CVE-2021-22986 F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问 iControl REST API 接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**根据漏洞库信息、搜索引擎结果（特别是NCC Group的分析）和已知的利用情况，此漏洞利用的有效性很高。有报告表明该漏洞已被积极利用于Mirai僵尸网络攻击。

**投毒风险：**提供的POC代码（README.md）本身只是一个使用说明，用于检测批量IP地址是否受到此漏洞影响。因此，它本身不包含任何恶意代码，因此投毒的风险较低，但是如果使用者下载了其他的POC代码，则需要对代码进行分析，以保证没有投毒代码。 这里给出的投毒风险百分比是根据POC代码本身进行评估的，考虑到使用者可能会从其他来源获取恶意POC，这里给出的投毒概率为10%。

**利用方式：**

1.  确定目标F5 BIG-IP/BIG-IQ设备的IP地址和端口。
2.  向 iControl REST API 发送特制的HTTP请求，其中包含要执行的命令。由于漏洞未经身份验证，因此攻击者不需要提供任何凭据。
3.  服务器执行请求中包含的命令，并将结果返回给攻击者。 

漏洞利用的关键是构造恶意的HTTP请求，该请求能够绕过任何现有的安全检查，并在服务器上执行任意命令。Packet Storm Security提供了相关的漏洞利用细节，可用于构造此类请求。

**总结：**该漏洞非常危险，因为它允许未经身份验证的攻击者在受影响的F5设备上执行任意命令。由于该漏洞已经被积极利用，因此强烈建议受影响的用户尽快升级到修补后的版本。

**项目地址:** [dotslashed/CVE-2021-22986](https://github.com/dotslashed/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #10

**来源**: [CVE-2021-22986-huydung26_CVE-2021-22986.md](../2021/CVE-2021-22986-huydung26_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST未授权远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 漏洞是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口存在的一个未授权远程命令执行漏洞。攻击者可以通过发送特制的请求到 iControl REST 接口，从而在目标系统上执行任意命令。根据提供的POC代码，利用方式主要分两步：

1.  **获取Token（方法一）:**
    *   首先，向`/mgmt/shared/authn/login`接口发送POST请求，尝试获取一个身份验证Token。这个请求中包含一个默认的用户名（admin）以及一些特定的参数。
    *   如果成功获取到Token，POC代码会提取该Token，并将其用于后续的命令执行。

2.  **执行命令:**
    *   利用获取到的Token，向`/mgmt/tm/util/bash`接口发送POST请求，并在请求体中包含要执行的命令。命令的结果会从响应中提取并显示。

**方法二（备选方案）：**
    *   如果获取Token失败，POC代码会尝试使用一个硬编码的Basic Auth头（`Authorization: Basic YWRtaW46QVNhc1M=`，对应admin:ASasS）。
    *   同样，通过向`/mgmt/tm/util/bash`接口发送POST请求来执行命令。

**有效性：**
根据提供的漏洞信息和POC代码，此漏洞利用代码是有效的，因为
*   漏洞库信息明确指出存在未授权的远程命令执行漏洞
*   搜索引擎结果表明该漏洞已被积极利用
*   POC代码尝试通过REST API执行系统命令

**投毒风险：**
存在较低的投毒风险（10%），主要基于以下几点考虑：
*   **代理配置：** POC代码包含使用代理的配置`proxy_url = "http://127.0.0.1:8080"`，如果用户没有意识到这一点，可能会将流量通过攻击者控制的代理服务器，从而泄露敏感信息或被中间人攻击。
*   **硬编码凭据：** 虽然提供了默认的用户名（admin）和密码`Authorization: Basic YWRtaW46QVNhc1M=`，但这只是为了方便POC的执行，并非恶意的后门植入。
*   **异常处理：** 在连接失败时，代码会尝试绕过代理。这看起来像是为了保证POC的可用性，但如果目标环境必须通过代理才能访问，这可能导致信息泄露。
总而言之，POC的主要目的是演示漏洞的利用，但使用代理和硬编码凭据可能会带来一定的安全风险，因此存在一定投毒风险, 建议用户在使用时仔细检查和修改代理设置，并避免在生产环境中使用默认凭据。

**项目地址:** [huydung26/CVE-2021-22986](https://github.com/huydung26/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #11

**来源**: [CVE-2021-22986-kiri-48_CVE-2021-22986.md](../2021/CVE-2021-22986-kiri-48_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标存在未授权访问的iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 中 iControl REST 接口的一个未授权远程命令执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过向 iControl REST API 发送特制的请求来执行任意系统命令。POC代码通过两个阶段进行利用。第一阶段尝试利用`/mgmt/shared/authn/login`接口泄露一个token，如果失败，则尝试使用固定的Basic认证头绕过认证。获取token后，使用`/mgmt/tm/util/bash`接口执行命令。由于代码逻辑稍显复杂, 存在一小部分投毒的可能性, 主要风险在于代码的容错部分，即第一阶段尝试利用失败后，可能由于环境差异，导致硬编码的header认证失效，从而利用失败。

**有效性：**
根据公开信息，该漏洞被广泛利用，POC代码有效。

**投毒风险：**
该POC代码主要利用漏洞实现远程命令执行，并未发现明显的恶意代码。但其中包含连接目标URL的操作，存在一定风险。如果攻击者控制了代码托管平台或参与了代码的修改，理论上可以植入恶意代码，例如收集目标信息、传播恶意软件等。但是从代码本身来看，直接投毒的概率较低，因此评估为10%。

**利用方式：**
1.  **利用 iControl REST 接口：** 漏洞存在于 iControl REST 接口，攻击者需要能够访问该接口。
2.  **绕过身份验证：**  攻击者通过构造特殊的请求绕过身份验证。
3.  **执行命令：**  攻击者在绕过身份验证后，可以通过 `/mgmt/tm/util/bash` 接口执行任意系统命令。

**排序优先级依据：**
1.  **搜索引擎结果：** 提供了漏洞被实际利用的信息，表明漏洞具有现实危害。
2.  **漏洞利用代码：**  POC 代码展示了漏洞的利用方法，验证了漏洞的可行性。
3.  **漏洞库信息：**  提供了漏洞的基本信息和受影响的版本范围。

**项目地址:** [kiri-48/CVE-2021-22986](https://github.com/kiri-48/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #12

**来源**: [CVE-2021-22986-microvorld_CVE-2021-22986.md](../2021/CVE-2021-22986-microvorld_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ 且 iControl REST 接口开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-22986 漏洞存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程攻击者执行任意命令。

**漏洞利用方式：**

1.  **获取 Token (Method 1):**  首先，POC尝试利用 `/mgmt/shared/authn/login` 接口泄漏认证 Token。它发送一个包含特定 `username` 和 `loginReference` 的 POST 请求，期望服务器返回一个有效的 Token。
2.  **执行命令:**  如果成功获取 Token，则使用该 Token 在 `/mgmt/tm/util/bash` 接口上执行命令。它构造一个包含 `command: run` 和 `utilCmdArgs` 的 JSON 数据，并将要执行的命令嵌入到 `utilCmdArgs` 中。
3. **另一种方式 (Method 2):** 如果无法通过Method 1获取Token,POC会尝试使用硬编码的Authorization头 'Authorization': 'Basic YWRtaW46QVNhc1M=' 结合X-F5-Auth-Token为空的方式，尝试在 `/mgmt/tm/util/bash` 接口上执行命令。

**有效性：**

根据漏洞描述、搜索结果（特别是 NCC Group 的报告指出无需 SSRF 即可利用）以及提供的 PoC 代码，该漏洞利用的有效性很高。存在多个公开的 PoC，并且该漏洞已被积极利用。

**投毒风险：**

该PoC主要功能为漏洞验证和利用，未发现明显的恶意行为。`README.md` 文件仅包含基本的使用说明。代码结构清晰，主要操作为发送 HTTP 请求和处理响应。该POC代码中的投毒风险较低，为1%。考虑到公开的 PoC 旨在利用漏洞，而非进行恶意活动，因此投毒的可能性较小。硬编码的Basic认证 `admin:ASasS=`也比较常见。

**总结：**

CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意命令。提供的 PoC 代码通过两种方式，首先是尝试泄漏Token，如果失败则尝试通过Basic认证结合X-F5-Auth-Token为空的方式，利用 `/mgmt/tm/util/bash` 接口执行命令。
根据现有信息，该漏洞利用的有效性很高，并且该漏洞在野外已被利用。PoC代码本身似乎没有明显的投毒行为，但使用者应始终注意从不受信任的来源获取代码的风险。

**项目地址:** [microvorld/CVE-2021-22986](https://github.com/microvorld/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #13

**来源**: [CVE-2021-22986-safesword_F5_RCE.md](../2021/CVE-2021-22986-safesword_F5_RCE.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ，并且可以访问 iControl REST 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以通过向易受攻击的 iControl REST 端点发送特制的 POST 请求来利用此漏洞，从而在目标系统上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明，该漏洞已被积极利用，并且有公开可用的 POC 代码。

**投毒风险：**

分析提供的 POC 代码 `f5_rce.py`，没有发现明显的恶意代码。该脚本使用 `requests` 库发送 HTTP 请求，并根据响应判断漏洞是否存在。`README.md` 文件描述了脚本的使用方法，并指出了该 POC 可能存在的局限性。但是，仍然存在细微的投毒风险，例如：

*   **依赖风险：** 脚本依赖 `requests` 库。如果攻击者控制了该库的安装源，可能会植入恶意代码。
*   **命令注入：** 脚本使用 `format` 函数格式化命令，可能存在命令注入的风险，但可能性较低，因为参数 `--command` 的执行，需要用户进行主动设置。
*   **输出文件：** `save_file` 函数会将目标 URL 保存到文件中，可能造成信息泄露。该文件默认保存在攻击者机器上，影响较小。

因此，投毒风险较低，约为 5%。

**利用方式：**

1.  攻击者向目标 F5 BIG-IP/BIG-IQ 设备的 iControl REST 接口发送特制的 POST 请求。
2.  请求的 payload 包含要执行的命令。
3.  由于漏洞存在于身份验证绕过中，因此攻击者无需提供有效的身份验证凭据即可发送此请求。
4.  目标设备执行命令，并将结果返回给攻击者。

提供的 POC 代码 `f5_rce.py` 实现了此利用方式。该脚本接受目标 URL 和要执行的命令作为参数，并发送相应的 POST 请求。

**项目地址:** [safesword/F5_RCE](https://github.com/safesword/F5_RCE)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #14

**来源**: [CVE-2021-22986-yaunsky_CVE-202122986-EXP.md](../2021/CVE-2021-22986-yaunsky_CVE-202122986-EXP.md)

## CVE-2021-22986-F5 BIG-IP iControl REST 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ设备中iControl REST接口存在的一个未经身份验证的远程命令执行漏洞。攻击者可以通过发送特制的HTTP请求到/mgmt/tm/util/bash端点来执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果显示，该漏洞在野外被积极利用，并且存在公开的PoC代码。提供的Python脚本`CVE202122986.py`实现了该漏洞的利用，通过向目标URL的`/mgmt/tm/util/bash`端点发送包含恶意命令的POST请求，从而实现远程命令执行。

**投毒风险：**

经过对提供的Python脚本`CVE202122986.py`的分析，发现以下几点可能存在的风险：

1.  **硬编码的认证信息：** 脚本中使用了硬编码的`Authorization: Basic YWRtaW46QVNhc1M=`头，虽然是默认的用户名密码，但如果被恶意修改，可能会导致利用失败，或者留下后门。
2.  **命令执行方式：** 脚本使用了`base64`编码来绕过某些检测，虽然增加了命令执行的灵活性，但也可能被用于执行更复杂的恶意命令。
3.  **错误处理：** 脚本中的错误处理比较简单，可能会在出现异常时直接退出，无法进行更深入的利用。

综合评估，该脚本本身存在一定的风险，例如使用硬编码的认证信息，以及潜在的命令执行风险。考虑到脚本的目的是执行任意命令，所以将payload隐藏在命令中具有一定的隐蔽性。因此，存在投毒风险的可能性较高，大约为10%。

**利用方式：**

1.  **发送POST请求：** 攻击者构造一个恶意的POST请求，目标URL为存在漏洞的F5 BIG-IP或BIG-IQ设备的`/mgmt/tm/util/bash`端点。
2.  **设置请求头：** 设置必要的请求头，包括`Authorization`（包含Base64编码的用户名密码），`X-F5-Auth-Token`（可能为空），以及`Content-Type: application/json`。
3.  **构造JSON数据：** 在POST请求的body中，构造一个JSON数据，包含`command`和`utilCmdArgs`字段。`command`字段设置为`run`，`utilCmdArgs`字段包含要执行的命令，例如`'-c id'`。
4.  **发送请求并执行命令：** 将构造好的POST请求发送到目标URL，目标设备将执行`utilCmdArgs`中指定的命令，并将结果返回在响应的`commandResult`字段中。
5.  **命令执行：** 使用`-c`参数执行单条命令，或者利用`base64`编码执行更复杂的命令，例如反弹shell等。


**项目地址:** [yaunsky/CVE-202122986-EXP](https://github.com/yaunsky/CVE-202122986-EXP)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---



---

## POC #9

**来源**: [CVE-2021-22986-dotslashed_CVE-2021-22986.md](../2021/CVE-2021-22986-dotslashed_CVE-2021-22986.md)

## CVE-2021-22986 F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问 iControl REST API 接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**根据漏洞库信息、搜索引擎结果（特别是NCC Group的分析）和已知的利用情况，此漏洞利用的有效性很高。有报告表明该漏洞已被积极利用于Mirai僵尸网络攻击。

**投毒风险：**提供的POC代码（README.md）本身只是一个使用说明，用于检测批量IP地址是否受到此漏洞影响。因此，它本身不包含任何恶意代码，因此投毒的风险较低，但是如果使用者下载了其他的POC代码，则需要对代码进行分析，以保证没有投毒代码。 这里给出的投毒风险百分比是根据POC代码本身进行评估的，考虑到使用者可能会从其他来源获取恶意POC，这里给出的投毒概率为10%。

**利用方式：**

1.  确定目标F5 BIG-IP/BIG-IQ设备的IP地址和端口。
2.  向 iControl REST API 发送特制的HTTP请求，其中包含要执行的命令。由于漏洞未经身份验证，因此攻击者不需要提供任何凭据。
3.  服务器执行请求中包含的命令，并将结果返回给攻击者。 

漏洞利用的关键是构造恶意的HTTP请求，该请求能够绕过任何现有的安全检查，并在服务器上执行任意命令。Packet Storm Security提供了相关的漏洞利用细节，可用于构造此类请求。

**总结：**该漏洞非常危险，因为它允许未经身份验证的攻击者在受影响的F5设备上执行任意命令。由于该漏洞已经被积极利用，因此强烈建议受影响的用户尽快升级到修补后的版本。

**项目地址:** [dotslashed/CVE-2021-22986](https://github.com/dotslashed/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #10

**来源**: [CVE-2021-22986-huydung26_CVE-2021-22986.md](../2021/CVE-2021-22986-huydung26_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST未授权远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 漏洞是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口存在的一个未授权远程命令执行漏洞。攻击者可以通过发送特制的请求到 iControl REST 接口，从而在目标系统上执行任意命令。根据提供的POC代码，利用方式主要分两步：

1.  **获取Token（方法一）:**
    *   首先，向`/mgmt/shared/authn/login`接口发送POST请求，尝试获取一个身份验证Token。这个请求中包含一个默认的用户名（admin）以及一些特定的参数。
    *   如果成功获取到Token，POC代码会提取该Token，并将其用于后续的命令执行。

2.  **执行命令:**
    *   利用获取到的Token，向`/mgmt/tm/util/bash`接口发送POST请求，并在请求体中包含要执行的命令。命令的结果会从响应中提取并显示。

**方法二（备选方案）：**
    *   如果获取Token失败，POC代码会尝试使用一个硬编码的Basic Auth头（`Authorization: Basic YWRtaW46QVNhc1M=`，对应admin:ASasS）。
    *   同样，通过向`/mgmt/tm/util/bash`接口发送POST请求来执行命令。

**有效性：**
根据提供的漏洞信息和POC代码，此漏洞利用代码是有效的，因为
*   漏洞库信息明确指出存在未授权的远程命令执行漏洞
*   搜索引擎结果表明该漏洞已被积极利用
*   POC代码尝试通过REST API执行系统命令

**投毒风险：**
存在较低的投毒风险（10%），主要基于以下几点考虑：
*   **代理配置：** POC代码包含使用代理的配置`proxy_url = "http://127.0.0.1:8080"`，如果用户没有意识到这一点，可能会将流量通过攻击者控制的代理服务器，从而泄露敏感信息或被中间人攻击。
*   **硬编码凭据：** 虽然提供了默认的用户名（admin）和密码`Authorization: Basic YWRtaW46QVNhc1M=`，但这只是为了方便POC的执行，并非恶意的后门植入。
*   **异常处理：** 在连接失败时，代码会尝试绕过代理。这看起来像是为了保证POC的可用性，但如果目标环境必须通过代理才能访问，这可能导致信息泄露。
总而言之，POC的主要目的是演示漏洞的利用，但使用代理和硬编码凭据可能会带来一定的安全风险，因此存在一定投毒风险, 建议用户在使用时仔细检查和修改代理设置，并避免在生产环境中使用默认凭据。

**项目地址:** [huydung26/CVE-2021-22986](https://github.com/huydung26/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #11

**来源**: [CVE-2021-22986-kiri-48_CVE-2021-22986.md](../2021/CVE-2021-22986-kiri-48_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标存在未授权访问的iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 中 iControl REST 接口的一个未授权远程命令执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过向 iControl REST API 发送特制的请求来执行任意系统命令。POC代码通过两个阶段进行利用。第一阶段尝试利用`/mgmt/shared/authn/login`接口泄露一个token，如果失败，则尝试使用固定的Basic认证头绕过认证。获取token后，使用`/mgmt/tm/util/bash`接口执行命令。由于代码逻辑稍显复杂, 存在一小部分投毒的可能性, 主要风险在于代码的容错部分，即第一阶段尝试利用失败后，可能由于环境差异，导致硬编码的header认证失效，从而利用失败。

**有效性：**
根据公开信息，该漏洞被广泛利用，POC代码有效。

**投毒风险：**
该POC代码主要利用漏洞实现远程命令执行，并未发现明显的恶意代码。但其中包含连接目标URL的操作，存在一定风险。如果攻击者控制了代码托管平台或参与了代码的修改，理论上可以植入恶意代码，例如收集目标信息、传播恶意软件等。但是从代码本身来看，直接投毒的概率较低，因此评估为10%。

**利用方式：**
1.  **利用 iControl REST 接口：** 漏洞存在于 iControl REST 接口，攻击者需要能够访问该接口。
2.  **绕过身份验证：**  攻击者通过构造特殊的请求绕过身份验证。
3.  **执行命令：**  攻击者在绕过身份验证后，可以通过 `/mgmt/tm/util/bash` 接口执行任意系统命令。

**排序优先级依据：**
1.  **搜索引擎结果：** 提供了漏洞被实际利用的信息，表明漏洞具有现实危害。
2.  **漏洞利用代码：**  POC 代码展示了漏洞的利用方法，验证了漏洞的可行性。
3.  **漏洞库信息：**  提供了漏洞的基本信息和受影响的版本范围。

**项目地址:** [kiri-48/CVE-2021-22986](https://github.com/kiri-48/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #12

**来源**: [CVE-2021-22986-microvorld_CVE-2021-22986.md](../2021/CVE-2021-22986-microvorld_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ 且 iControl REST 接口开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-22986 漏洞存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程攻击者执行任意命令。

**漏洞利用方式：**

1.  **获取 Token (Method 1):**  首先，POC尝试利用 `/mgmt/shared/authn/login` 接口泄漏认证 Token。它发送一个包含特定 `username` 和 `loginReference` 的 POST 请求，期望服务器返回一个有效的 Token。
2.  **执行命令:**  如果成功获取 Token，则使用该 Token 在 `/mgmt/tm/util/bash` 接口上执行命令。它构造一个包含 `command: run` 和 `utilCmdArgs` 的 JSON 数据，并将要执行的命令嵌入到 `utilCmdArgs` 中。
3. **另一种方式 (Method 2):** 如果无法通过Method 1获取Token,POC会尝试使用硬编码的Authorization头 'Authorization': 'Basic YWRtaW46QVNhc1M=' 结合X-F5-Auth-Token为空的方式，尝试在 `/mgmt/tm/util/bash` 接口上执行命令。

**有效性：**

根据漏洞描述、搜索结果（特别是 NCC Group 的报告指出无需 SSRF 即可利用）以及提供的 PoC 代码，该漏洞利用的有效性很高。存在多个公开的 PoC，并且该漏洞已被积极利用。

**投毒风险：**

该PoC主要功能为漏洞验证和利用，未发现明显的恶意行为。`README.md` 文件仅包含基本的使用说明。代码结构清晰，主要操作为发送 HTTP 请求和处理响应。该POC代码中的投毒风险较低，为1%。考虑到公开的 PoC 旨在利用漏洞，而非进行恶意活动，因此投毒的可能性较小。硬编码的Basic认证 `admin:ASasS=`也比较常见。

**总结：**

CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意命令。提供的 PoC 代码通过两种方式，首先是尝试泄漏Token，如果失败则尝试通过Basic认证结合X-F5-Auth-Token为空的方式，利用 `/mgmt/tm/util/bash` 接口执行命令。
根据现有信息，该漏洞利用的有效性很高，并且该漏洞在野外已被利用。PoC代码本身似乎没有明显的投毒行为，但使用者应始终注意从不受信任的来源获取代码的风险。

**项目地址:** [microvorld/CVE-2021-22986](https://github.com/microvorld/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #13

**来源**: [CVE-2021-22986-safesword_F5_RCE.md](../2021/CVE-2021-22986-safesword_F5_RCE.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ，并且可以访问 iControl REST 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以通过向易受攻击的 iControl REST 端点发送特制的 POST 请求来利用此漏洞，从而在目标系统上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明，该漏洞已被积极利用，并且有公开可用的 POC 代码。

**投毒风险：**

分析提供的 POC 代码 `f5_rce.py`，没有发现明显的恶意代码。该脚本使用 `requests` 库发送 HTTP 请求，并根据响应判断漏洞是否存在。`README.md` 文件描述了脚本的使用方法，并指出了该 POC 可能存在的局限性。但是，仍然存在细微的投毒风险，例如：

*   **依赖风险：** 脚本依赖 `requests` 库。如果攻击者控制了该库的安装源，可能会植入恶意代码。
*   **命令注入：** 脚本使用 `format` 函数格式化命令，可能存在命令注入的风险，但可能性较低，因为参数 `--command` 的执行，需要用户进行主动设置。
*   **输出文件：** `save_file` 函数会将目标 URL 保存到文件中，可能造成信息泄露。该文件默认保存在攻击者机器上，影响较小。

因此，投毒风险较低，约为 5%。

**利用方式：**

1.  攻击者向目标 F5 BIG-IP/BIG-IQ 设备的 iControl REST 接口发送特制的 POST 请求。
2.  请求的 payload 包含要执行的命令。
3.  由于漏洞存在于身份验证绕过中，因此攻击者无需提供有效的身份验证凭据即可发送此请求。
4.  目标设备执行命令，并将结果返回给攻击者。

提供的 POC 代码 `f5_rce.py` 实现了此利用方式。该脚本接受目标 URL 和要执行的命令作为参数，并发送相应的 POST 请求。

**项目地址:** [safesword/F5_RCE](https://github.com/safesword/F5_RCE)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #14

**来源**: [CVE-2021-22986-yaunsky_CVE-202122986-EXP.md](../2021/CVE-2021-22986-yaunsky_CVE-202122986-EXP.md)

## CVE-2021-22986-F5 BIG-IP iControl REST 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ设备中iControl REST接口存在的一个未经身份验证的远程命令执行漏洞。攻击者可以通过发送特制的HTTP请求到/mgmt/tm/util/bash端点来执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果显示，该漏洞在野外被积极利用，并且存在公开的PoC代码。提供的Python脚本`CVE202122986.py`实现了该漏洞的利用，通过向目标URL的`/mgmt/tm/util/bash`端点发送包含恶意命令的POST请求，从而实现远程命令执行。

**投毒风险：**

经过对提供的Python脚本`CVE202122986.py`的分析，发现以下几点可能存在的风险：

1.  **硬编码的认证信息：** 脚本中使用了硬编码的`Authorization: Basic YWRtaW46QVNhc1M=`头，虽然是默认的用户名密码，但如果被恶意修改，可能会导致利用失败，或者留下后门。
2.  **命令执行方式：** 脚本使用了`base64`编码来绕过某些检测，虽然增加了命令执行的灵活性，但也可能被用于执行更复杂的恶意命令。
3.  **错误处理：** 脚本中的错误处理比较简单，可能会在出现异常时直接退出，无法进行更深入的利用。

综合评估，该脚本本身存在一定的风险，例如使用硬编码的认证信息，以及潜在的命令执行风险。考虑到脚本的目的是执行任意命令，所以将payload隐藏在命令中具有一定的隐蔽性。因此，存在投毒风险的可能性较高，大约为10%。

**利用方式：**

1.  **发送POST请求：** 攻击者构造一个恶意的POST请求，目标URL为存在漏洞的F5 BIG-IP或BIG-IQ设备的`/mgmt/tm/util/bash`端点。
2.  **设置请求头：** 设置必要的请求头，包括`Authorization`（包含Base64编码的用户名密码），`X-F5-Auth-Token`（可能为空），以及`Content-Type: application/json`。
3.  **构造JSON数据：** 在POST请求的body中，构造一个JSON数据，包含`command`和`utilCmdArgs`字段。`command`字段设置为`run`，`utilCmdArgs`字段包含要执行的命令，例如`'-c id'`。
4.  **发送请求并执行命令：** 将构造好的POST请求发送到目标URL，目标设备将执行`utilCmdArgs`中指定的命令，并将结果返回在响应的`commandResult`字段中。
5.  **命令执行：** 使用`-c`参数执行单条命令，或者利用`base64`编码执行更复杂的命令，例如反弹shell等。


**项目地址:** [yaunsky/CVE-202122986-EXP](https://github.com/yaunsky/CVE-202122986-EXP)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---



---

## POC #9

**来源**: [CVE-2021-22986-dotslashed_CVE-2021-22986.md](../2021/CVE-2021-22986-dotslashed_CVE-2021-22986.md)

## CVE-2021-22986 F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问 iControl REST API 接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**根据漏洞库信息、搜索引擎结果（特别是NCC Group的分析）和已知的利用情况，此漏洞利用的有效性很高。有报告表明该漏洞已被积极利用于Mirai僵尸网络攻击。

**投毒风险：**提供的POC代码（README.md）本身只是一个使用说明，用于检测批量IP地址是否受到此漏洞影响。因此，它本身不包含任何恶意代码，因此投毒的风险较低，但是如果使用者下载了其他的POC代码，则需要对代码进行分析，以保证没有投毒代码。 这里给出的投毒风险百分比是根据POC代码本身进行评估的，考虑到使用者可能会从其他来源获取恶意POC，这里给出的投毒概率为10%。

**利用方式：**

1.  确定目标F5 BIG-IP/BIG-IQ设备的IP地址和端口。
2.  向 iControl REST API 发送特制的HTTP请求，其中包含要执行的命令。由于漏洞未经身份验证，因此攻击者不需要提供任何凭据。
3.  服务器执行请求中包含的命令，并将结果返回给攻击者。 

漏洞利用的关键是构造恶意的HTTP请求，该请求能够绕过任何现有的安全检查，并在服务器上执行任意命令。Packet Storm Security提供了相关的漏洞利用细节，可用于构造此类请求。

**总结：**该漏洞非常危险，因为它允许未经身份验证的攻击者在受影响的F5设备上执行任意命令。由于该漏洞已经被积极利用，因此强烈建议受影响的用户尽快升级到修补后的版本。

**项目地址:** [dotslashed/CVE-2021-22986](https://github.com/dotslashed/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #10

**来源**: [CVE-2021-22986-huydung26_CVE-2021-22986.md](../2021/CVE-2021-22986-huydung26_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST未授权远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 漏洞是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口存在的一个未授权远程命令执行漏洞。攻击者可以通过发送特制的请求到 iControl REST 接口，从而在目标系统上执行任意命令。根据提供的POC代码，利用方式主要分两步：

1.  **获取Token（方法一）:**
    *   首先，向`/mgmt/shared/authn/login`接口发送POST请求，尝试获取一个身份验证Token。这个请求中包含一个默认的用户名（admin）以及一些特定的参数。
    *   如果成功获取到Token，POC代码会提取该Token，并将其用于后续的命令执行。

2.  **执行命令:**
    *   利用获取到的Token，向`/mgmt/tm/util/bash`接口发送POST请求，并在请求体中包含要执行的命令。命令的结果会从响应中提取并显示。

**方法二（备选方案）：**
    *   如果获取Token失败，POC代码会尝试使用一个硬编码的Basic Auth头（`Authorization: Basic YWRtaW46QVNhc1M=`，对应admin:ASasS）。
    *   同样，通过向`/mgmt/tm/util/bash`接口发送POST请求来执行命令。

**有效性：**
根据提供的漏洞信息和POC代码，此漏洞利用代码是有效的，因为
*   漏洞库信息明确指出存在未授权的远程命令执行漏洞
*   搜索引擎结果表明该漏洞已被积极利用
*   POC代码尝试通过REST API执行系统命令

**投毒风险：**
存在较低的投毒风险（10%），主要基于以下几点考虑：
*   **代理配置：** POC代码包含使用代理的配置`proxy_url = "http://127.0.0.1:8080"`，如果用户没有意识到这一点，可能会将流量通过攻击者控制的代理服务器，从而泄露敏感信息或被中间人攻击。
*   **硬编码凭据：** 虽然提供了默认的用户名（admin）和密码`Authorization: Basic YWRtaW46QVNhc1M=`，但这只是为了方便POC的执行，并非恶意的后门植入。
*   **异常处理：** 在连接失败时，代码会尝试绕过代理。这看起来像是为了保证POC的可用性，但如果目标环境必须通过代理才能访问，这可能导致信息泄露。
总而言之，POC的主要目的是演示漏洞的利用，但使用代理和硬编码凭据可能会带来一定的安全风险，因此存在一定投毒风险, 建议用户在使用时仔细检查和修改代理设置，并避免在生产环境中使用默认凭据。

**项目地址:** [huydung26/CVE-2021-22986](https://github.com/huydung26/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #11

**来源**: [CVE-2021-22986-kiri-48_CVE-2021-22986.md](../2021/CVE-2021-22986-kiri-48_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标存在未授权访问的iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 中 iControl REST 接口的一个未授权远程命令执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过向 iControl REST API 发送特制的请求来执行任意系统命令。POC代码通过两个阶段进行利用。第一阶段尝试利用`/mgmt/shared/authn/login`接口泄露一个token，如果失败，则尝试使用固定的Basic认证头绕过认证。获取token后，使用`/mgmt/tm/util/bash`接口执行命令。由于代码逻辑稍显复杂, 存在一小部分投毒的可能性, 主要风险在于代码的容错部分，即第一阶段尝试利用失败后，可能由于环境差异，导致硬编码的header认证失效，从而利用失败。

**有效性：**
根据公开信息，该漏洞被广泛利用，POC代码有效。

**投毒风险：**
该POC代码主要利用漏洞实现远程命令执行，并未发现明显的恶意代码。但其中包含连接目标URL的操作，存在一定风险。如果攻击者控制了代码托管平台或参与了代码的修改，理论上可以植入恶意代码，例如收集目标信息、传播恶意软件等。但是从代码本身来看，直接投毒的概率较低，因此评估为10%。

**利用方式：**
1.  **利用 iControl REST 接口：** 漏洞存在于 iControl REST 接口，攻击者需要能够访问该接口。
2.  **绕过身份验证：**  攻击者通过构造特殊的请求绕过身份验证。
3.  **执行命令：**  攻击者在绕过身份验证后，可以通过 `/mgmt/tm/util/bash` 接口执行任意系统命令。

**排序优先级依据：**
1.  **搜索引擎结果：** 提供了漏洞被实际利用的信息，表明漏洞具有现实危害。
2.  **漏洞利用代码：**  POC 代码展示了漏洞的利用方法，验证了漏洞的可行性。
3.  **漏洞库信息：**  提供了漏洞的基本信息和受影响的版本范围。

**项目地址:** [kiri-48/CVE-2021-22986](https://github.com/kiri-48/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #12

**来源**: [CVE-2021-22986-microvorld_CVE-2021-22986.md](../2021/CVE-2021-22986-microvorld_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ 且 iControl REST 接口开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-22986 漏洞存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程攻击者执行任意命令。

**漏洞利用方式：**

1.  **获取 Token (Method 1):**  首先，POC尝试利用 `/mgmt/shared/authn/login` 接口泄漏认证 Token。它发送一个包含特定 `username` 和 `loginReference` 的 POST 请求，期望服务器返回一个有效的 Token。
2.  **执行命令:**  如果成功获取 Token，则使用该 Token 在 `/mgmt/tm/util/bash` 接口上执行命令。它构造一个包含 `command: run` 和 `utilCmdArgs` 的 JSON 数据，并将要执行的命令嵌入到 `utilCmdArgs` 中。
3. **另一种方式 (Method 2):** 如果无法通过Method 1获取Token,POC会尝试使用硬编码的Authorization头 'Authorization': 'Basic YWRtaW46QVNhc1M=' 结合X-F5-Auth-Token为空的方式，尝试在 `/mgmt/tm/util/bash` 接口上执行命令。

**有效性：**

根据漏洞描述、搜索结果（特别是 NCC Group 的报告指出无需 SSRF 即可利用）以及提供的 PoC 代码，该漏洞利用的有效性很高。存在多个公开的 PoC，并且该漏洞已被积极利用。

**投毒风险：**

该PoC主要功能为漏洞验证和利用，未发现明显的恶意行为。`README.md` 文件仅包含基本的使用说明。代码结构清晰，主要操作为发送 HTTP 请求和处理响应。该POC代码中的投毒风险较低，为1%。考虑到公开的 PoC 旨在利用漏洞，而非进行恶意活动，因此投毒的可能性较小。硬编码的Basic认证 `admin:ASasS=`也比较常见。

**总结：**

CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意命令。提供的 PoC 代码通过两种方式，首先是尝试泄漏Token，如果失败则尝试通过Basic认证结合X-F5-Auth-Token为空的方式，利用 `/mgmt/tm/util/bash` 接口执行命令。
根据现有信息，该漏洞利用的有效性很高，并且该漏洞在野外已被利用。PoC代码本身似乎没有明显的投毒行为，但使用者应始终注意从不受信任的来源获取代码的风险。

**项目地址:** [microvorld/CVE-2021-22986](https://github.com/microvorld/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #13

**来源**: [CVE-2021-22986-safesword_F5_RCE.md](../2021/CVE-2021-22986-safesword_F5_RCE.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ，并且可以访问 iControl REST 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以通过向易受攻击的 iControl REST 端点发送特制的 POST 请求来利用此漏洞，从而在目标系统上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明，该漏洞已被积极利用，并且有公开可用的 POC 代码。

**投毒风险：**

分析提供的 POC 代码 `f5_rce.py`，没有发现明显的恶意代码。该脚本使用 `requests` 库发送 HTTP 请求，并根据响应判断漏洞是否存在。`README.md` 文件描述了脚本的使用方法，并指出了该 POC 可能存在的局限性。但是，仍然存在细微的投毒风险，例如：

*   **依赖风险：** 脚本依赖 `requests` 库。如果攻击者控制了该库的安装源，可能会植入恶意代码。
*   **命令注入：** 脚本使用 `format` 函数格式化命令，可能存在命令注入的风险，但可能性较低，因为参数 `--command` 的执行，需要用户进行主动设置。
*   **输出文件：** `save_file` 函数会将目标 URL 保存到文件中，可能造成信息泄露。该文件默认保存在攻击者机器上，影响较小。

因此，投毒风险较低，约为 5%。

**利用方式：**

1.  攻击者向目标 F5 BIG-IP/BIG-IQ 设备的 iControl REST 接口发送特制的 POST 请求。
2.  请求的 payload 包含要执行的命令。
3.  由于漏洞存在于身份验证绕过中，因此攻击者无需提供有效的身份验证凭据即可发送此请求。
4.  目标设备执行命令，并将结果返回给攻击者。

提供的 POC 代码 `f5_rce.py` 实现了此利用方式。该脚本接受目标 URL 和要执行的命令作为参数，并发送相应的 POST 请求。

**项目地址:** [safesword/F5_RCE](https://github.com/safesword/F5_RCE)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #14

**来源**: [CVE-2021-22986-yaunsky_CVE-202122986-EXP.md](../2021/CVE-2021-22986-yaunsky_CVE-202122986-EXP.md)

## CVE-2021-22986-F5 BIG-IP iControl REST 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ设备中iControl REST接口存在的一个未经身份验证的远程命令执行漏洞。攻击者可以通过发送特制的HTTP请求到/mgmt/tm/util/bash端点来执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果显示，该漏洞在野外被积极利用，并且存在公开的PoC代码。提供的Python脚本`CVE202122986.py`实现了该漏洞的利用，通过向目标URL的`/mgmt/tm/util/bash`端点发送包含恶意命令的POST请求，从而实现远程命令执行。

**投毒风险：**

经过对提供的Python脚本`CVE202122986.py`的分析，发现以下几点可能存在的风险：

1.  **硬编码的认证信息：** 脚本中使用了硬编码的`Authorization: Basic YWRtaW46QVNhc1M=`头，虽然是默认的用户名密码，但如果被恶意修改，可能会导致利用失败，或者留下后门。
2.  **命令执行方式：** 脚本使用了`base64`编码来绕过某些检测，虽然增加了命令执行的灵活性，但也可能被用于执行更复杂的恶意命令。
3.  **错误处理：** 脚本中的错误处理比较简单，可能会在出现异常时直接退出，无法进行更深入的利用。

综合评估，该脚本本身存在一定的风险，例如使用硬编码的认证信息，以及潜在的命令执行风险。考虑到脚本的目的是执行任意命令，所以将payload隐藏在命令中具有一定的隐蔽性。因此，存在投毒风险的可能性较高，大约为10%。

**利用方式：**

1.  **发送POST请求：** 攻击者构造一个恶意的POST请求，目标URL为存在漏洞的F5 BIG-IP或BIG-IQ设备的`/mgmt/tm/util/bash`端点。
2.  **设置请求头：** 设置必要的请求头，包括`Authorization`（包含Base64编码的用户名密码），`X-F5-Auth-Token`（可能为空），以及`Content-Type: application/json`。
3.  **构造JSON数据：** 在POST请求的body中，构造一个JSON数据，包含`command`和`utilCmdArgs`字段。`command`字段设置为`run`，`utilCmdArgs`字段包含要执行的命令，例如`'-c id'`。
4.  **发送请求并执行命令：** 将构造好的POST请求发送到目标URL，目标设备将执行`utilCmdArgs`中指定的命令，并将结果返回在响应的`commandResult`字段中。
5.  **命令执行：** 使用`-c`参数执行单条命令，或者利用`base64`编码执行更复杂的命令，例如反弹shell等。


**项目地址:** [yaunsky/CVE-202122986-EXP](https://github.com/yaunsky/CVE-202122986-EXP)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---



---

## POC #9

**来源**: [CVE-2021-22986-dotslashed_CVE-2021-22986.md](../2021/CVE-2021-22986-dotslashed_CVE-2021-22986.md)

## CVE-2021-22986 F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问 iControl REST API 接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**根据漏洞库信息、搜索引擎结果（特别是NCC Group的分析）和已知的利用情况，此漏洞利用的有效性很高。有报告表明该漏洞已被积极利用于Mirai僵尸网络攻击。

**投毒风险：**提供的POC代码（README.md）本身只是一个使用说明，用于检测批量IP地址是否受到此漏洞影响。因此，它本身不包含任何恶意代码，因此投毒的风险较低，但是如果使用者下载了其他的POC代码，则需要对代码进行分析，以保证没有投毒代码。 这里给出的投毒风险百分比是根据POC代码本身进行评估的，考虑到使用者可能会从其他来源获取恶意POC，这里给出的投毒概率为10%。

**利用方式：**

1.  确定目标F5 BIG-IP/BIG-IQ设备的IP地址和端口。
2.  向 iControl REST API 发送特制的HTTP请求，其中包含要执行的命令。由于漏洞未经身份验证，因此攻击者不需要提供任何凭据。
3.  服务器执行请求中包含的命令，并将结果返回给攻击者。 

漏洞利用的关键是构造恶意的HTTP请求，该请求能够绕过任何现有的安全检查，并在服务器上执行任意命令。Packet Storm Security提供了相关的漏洞利用细节，可用于构造此类请求。

**总结：**该漏洞非常危险，因为它允许未经身份验证的攻击者在受影响的F5设备上执行任意命令。由于该漏洞已经被积极利用，因此强烈建议受影响的用户尽快升级到修补后的版本。

**项目地址:** [dotslashed/CVE-2021-22986](https://github.com/dotslashed/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #10

**来源**: [CVE-2021-22986-huydung26_CVE-2021-22986.md](../2021/CVE-2021-22986-huydung26_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST未授权远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 漏洞是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口存在的一个未授权远程命令执行漏洞。攻击者可以通过发送特制的请求到 iControl REST 接口，从而在目标系统上执行任意命令。根据提供的POC代码，利用方式主要分两步：

1.  **获取Token（方法一）:**
    *   首先，向`/mgmt/shared/authn/login`接口发送POST请求，尝试获取一个身份验证Token。这个请求中包含一个默认的用户名（admin）以及一些特定的参数。
    *   如果成功获取到Token，POC代码会提取该Token，并将其用于后续的命令执行。

2.  **执行命令:**
    *   利用获取到的Token，向`/mgmt/tm/util/bash`接口发送POST请求，并在请求体中包含要执行的命令。命令的结果会从响应中提取并显示。

**方法二（备选方案）：**
    *   如果获取Token失败，POC代码会尝试使用一个硬编码的Basic Auth头（`Authorization: Basic YWRtaW46QVNhc1M=`，对应admin:ASasS）。
    *   同样，通过向`/mgmt/tm/util/bash`接口发送POST请求来执行命令。

**有效性：**
根据提供的漏洞信息和POC代码，此漏洞利用代码是有效的，因为
*   漏洞库信息明确指出存在未授权的远程命令执行漏洞
*   搜索引擎结果表明该漏洞已被积极利用
*   POC代码尝试通过REST API执行系统命令

**投毒风险：**
存在较低的投毒风险（10%），主要基于以下几点考虑：
*   **代理配置：** POC代码包含使用代理的配置`proxy_url = "http://127.0.0.1:8080"`，如果用户没有意识到这一点，可能会将流量通过攻击者控制的代理服务器，从而泄露敏感信息或被中间人攻击。
*   **硬编码凭据：** 虽然提供了默认的用户名（admin）和密码`Authorization: Basic YWRtaW46QVNhc1M=`，但这只是为了方便POC的执行，并非恶意的后门植入。
*   **异常处理：** 在连接失败时，代码会尝试绕过代理。这看起来像是为了保证POC的可用性，但如果目标环境必须通过代理才能访问，这可能导致信息泄露。
总而言之，POC的主要目的是演示漏洞的利用，但使用代理和硬编码凭据可能会带来一定的安全风险，因此存在一定投毒风险, 建议用户在使用时仔细检查和修改代理设置，并避免在生产环境中使用默认凭据。

**项目地址:** [huydung26/CVE-2021-22986](https://github.com/huydung26/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #11

**来源**: [CVE-2021-22986-kiri-48_CVE-2021-22986.md](../2021/CVE-2021-22986-kiri-48_CVE-2021-22986.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标存在未授权访问的iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 中 iControl REST 接口的一个未授权远程命令执行漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过向 iControl REST API 发送特制的请求来执行任意系统命令。POC代码通过两个阶段进行利用。第一阶段尝试利用`/mgmt/shared/authn/login`接口泄露一个token，如果失败，则尝试使用固定的Basic认证头绕过认证。获取token后，使用`/mgmt/tm/util/bash`接口执行命令。由于代码逻辑稍显复杂, 存在一小部分投毒的可能性, 主要风险在于代码的容错部分，即第一阶段尝试利用失败后，可能由于环境差异，导致硬编码的header认证失效，从而利用失败。

**有效性：**
根据公开信息，该漏洞被广泛利用，POC代码有效。

**投毒风险：**
该POC代码主要利用漏洞实现远程命令执行，并未发现明显的恶意代码。但其中包含连接目标URL的操作，存在一定风险。如果攻击者控制了代码托管平台或参与了代码的修改，理论上可以植入恶意代码，例如收集目标信息、传播恶意软件等。但是从代码本身来看，直接投毒的概率较低，因此评估为10%。

**利用方式：**
1.  **利用 iControl REST 接口：** 漏洞存在于 iControl REST 接口，攻击者需要能够访问该接口。
2.  **绕过身份验证：**  攻击者通过构造特殊的请求绕过身份验证。
3.  **执行命令：**  攻击者在绕过身份验证后，可以通过 `/mgmt/tm/util/bash` 接口执行任意系统命令。

**排序优先级依据：**
1.  **搜索引擎结果：** 提供了漏洞被实际利用的信息，表明漏洞具有现实危害。
2.  **漏洞利用代码：**  POC 代码展示了漏洞的利用方法，验证了漏洞的可行性。
3.  **漏洞库信息：**  提供了漏洞的基本信息和受影响的版本范围。

**项目地址:** [kiri-48/CVE-2021-22986](https://github.com/kiri-48/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #12

**来源**: [CVE-2021-22986-microvorld_CVE-2021-22986.md](../2021/CVE-2021-22986-microvorld_CVE-2021-22986.md)

## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ 且 iControl REST 接口开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-22986 漏洞存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的远程攻击者执行任意命令。

**漏洞利用方式：**

1.  **获取 Token (Method 1):**  首先，POC尝试利用 `/mgmt/shared/authn/login` 接口泄漏认证 Token。它发送一个包含特定 `username` 和 `loginReference` 的 POST 请求，期望服务器返回一个有效的 Token。
2.  **执行命令:**  如果成功获取 Token，则使用该 Token 在 `/mgmt/tm/util/bash` 接口上执行命令。它构造一个包含 `command: run` 和 `utilCmdArgs` 的 JSON 数据，并将要执行的命令嵌入到 `utilCmdArgs` 中。
3. **另一种方式 (Method 2):** 如果无法通过Method 1获取Token,POC会尝试使用硬编码的Authorization头 'Authorization': 'Basic YWRtaW46QVNhc1M=' 结合X-F5-Auth-Token为空的方式，尝试在 `/mgmt/tm/util/bash` 接口上执行命令。

**有效性：**

根据漏洞描述、搜索结果（特别是 NCC Group 的报告指出无需 SSRF 即可利用）以及提供的 PoC 代码，该漏洞利用的有效性很高。存在多个公开的 PoC，并且该漏洞已被积极利用。

**投毒风险：**

该PoC主要功能为漏洞验证和利用，未发现明显的恶意行为。`README.md` 文件仅包含基本的使用说明。代码结构清晰，主要操作为发送 HTTP 请求和处理响应。该POC代码中的投毒风险较低，为1%。考虑到公开的 PoC 旨在利用漏洞，而非进行恶意活动，因此投毒的可能性较小。硬编码的Basic认证 `admin:ASasS=`也比较常见。

**总结：**

CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意命令。提供的 PoC 代码通过两种方式，首先是尝试泄漏Token，如果失败则尝试通过Basic认证结合X-F5-Auth-Token为空的方式，利用 `/mgmt/tm/util/bash` 接口执行命令。
根据现有信息，该漏洞利用的有效性很高，并且该漏洞在野外已被利用。PoC代码本身似乎没有明显的投毒行为，但使用者应始终注意从不受信任的来源获取代码的风险。

**项目地址:** [microvorld/CVE-2021-22986](https://github.com/microvorld/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #13

**来源**: [CVE-2021-22986-safesword_F5_RCE.md](../2021/CVE-2021-22986-safesword_F5_RCE.md)

## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ，并且可以访问 iControl REST 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以通过向易受攻击的 iControl REST 端点发送特制的 POST 请求来利用此漏洞，从而在目标系统上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明，该漏洞已被积极利用，并且有公开可用的 POC 代码。

**投毒风险：**

分析提供的 POC 代码 `f5_rce.py`，没有发现明显的恶意代码。该脚本使用 `requests` 库发送 HTTP 请求，并根据响应判断漏洞是否存在。`README.md` 文件描述了脚本的使用方法，并指出了该 POC 可能存在的局限性。但是，仍然存在细微的投毒风险，例如：

*   **依赖风险：** 脚本依赖 `requests` 库。如果攻击者控制了该库的安装源，可能会植入恶意代码。
*   **命令注入：** 脚本使用 `format` 函数格式化命令，可能存在命令注入的风险，但可能性较低，因为参数 `--command` 的执行，需要用户进行主动设置。
*   **输出文件：** `save_file` 函数会将目标 URL 保存到文件中，可能造成信息泄露。该文件默认保存在攻击者机器上，影响较小。

因此，投毒风险较低，约为 5%。

**利用方式：**

1.  攻击者向目标 F5 BIG-IP/BIG-IQ 设备的 iControl REST 接口发送特制的 POST 请求。
2.  请求的 payload 包含要执行的命令。
3.  由于漏洞存在于身份验证绕过中，因此攻击者无需提供有效的身份验证凭据即可发送此请求。
4.  目标设备执行命令，并将结果返回给攻击者。

提供的 POC 代码 `f5_rce.py` 实现了此利用方式。该脚本接受目标 URL 和要执行的命令作为参数，并发送相应的 POST 请求。

**项目地址:** [safesword/F5_RCE](https://github.com/safesword/F5_RCE)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

## POC #14

**来源**: [CVE-2021-22986-yaunsky_CVE-202122986-EXP.md](../2021/CVE-2021-22986-yaunsky_CVE-202122986-EXP.md)

## CVE-2021-22986-F5 BIG-IP iControl REST 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986是F5 BIG-IP和BIG-IQ设备中iControl REST接口存在的一个未经身份验证的远程命令执行漏洞。攻击者可以通过发送特制的HTTP请求到/mgmt/tm/util/bash端点来执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果显示，该漏洞在野外被积极利用，并且存在公开的PoC代码。提供的Python脚本`CVE202122986.py`实现了该漏洞的利用，通过向目标URL的`/mgmt/tm/util/bash`端点发送包含恶意命令的POST请求，从而实现远程命令执行。

**投毒风险：**

经过对提供的Python脚本`CVE202122986.py`的分析，发现以下几点可能存在的风险：

1.  **硬编码的认证信息：** 脚本中使用了硬编码的`Authorization: Basic YWRtaW46QVNhc1M=`头，虽然是默认的用户名密码，但如果被恶意修改，可能会导致利用失败，或者留下后门。
2.  **命令执行方式：** 脚本使用了`base64`编码来绕过某些检测，虽然增加了命令执行的灵活性，但也可能被用于执行更复杂的恶意命令。
3.  **错误处理：** 脚本中的错误处理比较简单，可能会在出现异常时直接退出，无法进行更深入的利用。

综合评估，该脚本本身存在一定的风险，例如使用硬编码的认证信息，以及潜在的命令执行风险。考虑到脚本的目的是执行任意命令，所以将payload隐藏在命令中具有一定的隐蔽性。因此，存在投毒风险的可能性较高，大约为10%。

**利用方式：**

1.  **发送POST请求：** 攻击者构造一个恶意的POST请求，目标URL为存在漏洞的F5 BIG-IP或BIG-IQ设备的`/mgmt/tm/util/bash`端点。
2.  **设置请求头：** 设置必要的请求头，包括`Authorization`（包含Base64编码的用户名密码），`X-F5-Auth-Token`（可能为空），以及`Content-Type: application/json`。
3.  **构造JSON数据：** 在POST请求的body中，构造一个JSON数据，包含`command`和`utilCmdArgs`字段。`command`字段设置为`run`，`utilCmdArgs`字段包含要执行的命令，例如`'-c id'`。
4.  **发送请求并执行命令：** 将构造好的POST请求发送到目标URL，目标设备将执行`utilCmdArgs`中指定的命令，并将结果返回在响应的`commandResult`字段中。
5.  **命令执行：** 使用`-c`参数执行单条命令，或者利用`base64`编码执行更复杂的命令，例如反弹shell等。


**项目地址:** [yaunsky/CVE-202122986-EXP](https://github.com/yaunsky/CVE-202122986-EXP)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)

---

